{"id": "http://arxiv.org/abs/1009.4835v2", "guidislink": true, "updated": "2011-01-30T13:46:19Z", "updated_parsed": [2011, 1, 30, 13, 46, 19, 6, 30, 0], "published": "2010-09-24T13:31:02Z", "published_parsed": [2010, 9, 24, 13, 31, 2, 4, 267, 0], "title": "Financial LPPL Bubbles with Mean-Reverting Noise in the Frequency Domain", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.4606%2C1009.0173%2C1009.0548%2C1009.0492%2C1009.3182%2C1009.5522%2C1009.3191%2C1009.3974%2C1009.3785%2C1009.0766%2C1009.4589%2C1009.3868%2C1009.0082%2C1009.1208%2C1009.3890%2C1009.5994%2C1009.5509%2C1009.3127%2C1009.0793%2C1009.1456%2C1009.4526%2C1009.0604%2C1009.0323%2C1009.4742%2C1009.2411%2C1009.4880%2C1009.0249%2C1009.4001%2C1009.2724%2C1009.1468%2C1009.0831%2C1009.1061%2C1009.2418%2C1009.4591%2C1009.4251%2C1009.0446%2C1009.0068%2C1009.5721%2C1009.4615%2C1009.0005%2C1009.0451%2C1009.4556%2C1009.3137%2C1009.5475%2C1009.0304%2C1009.3509%2C1009.4317%2C1009.1397%2C1009.1337%2C1009.3581%2C1009.4632%2C1009.4264%2C1009.4862%2C1009.4771%2C1009.5801%2C1009.2828%2C1009.2244%2C1009.2359%2C1009.1776%2C1009.3869%2C1009.5598%2C1009.3954%2C1009.4531%2C1009.3067%2C1009.4835%2C1009.5708%2C1009.4271%2C1009.3231%2C1009.4731%2C1009.1866%2C1009.3619%2C1009.0607%2C1009.3329%2C1009.4630%2C1009.0780%2C1009.2373%2C1009.0160%2C1009.4942%2C1009.1511%2C1009.4460%2C1009.5125%2C1009.1609%2C1009.3822%2C1009.1568%2C1009.0401%2C1009.3948%2C1009.5344%2C1009.4401%2C1009.1024%2C1009.5769%2C1009.3600%2C1009.2530%2C1009.2136%2C1009.2019%2C1009.4613%2C1009.3646%2C1009.1404%2C1009.0043%2C1009.1700%2C1009.3407%2C1009.2965&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Financial LPPL Bubbles with Mean-Reverting Noise in the Frequency Domain"}, "summary": "The log-periodic power law (LPPL) is a model of asset prices during\nendogenous bubbles. A major open issue is to verify the presence of LPPL in\nprice sequences and to estimate the LPPL parameters. Estimation is complicated\nby the fact that daily LPPL returns are typically orders of magnitude smaller\nthan measured price returns, suggesting that noise obscures the underlying LPPL\ndynamics. However, if noise is mean-reverting, it would quickly cancel out over\nsubsequent measurements. In this paper, we attempt to reject mean-reverting\nnoise from price sequences by exploiting frequency-domain properties of LPPL\nand of mean reversion. First, we calculate the spectrum of mean-reverting \\ou\nnoise and devise estimators for the noise's parameters. Then, we derive the\nLPPL spectrum by breaking it down into its two main characteristics of power\nlaw and of log-periodicity. We compare price spectra with noise spectra during\nhistorical bubbles. In general, noise was strong also at low frequencies and,\neven if LPPL underlied price dynamics, LPPL would be obscured by noise.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.4606%2C1009.0173%2C1009.0548%2C1009.0492%2C1009.3182%2C1009.5522%2C1009.3191%2C1009.3974%2C1009.3785%2C1009.0766%2C1009.4589%2C1009.3868%2C1009.0082%2C1009.1208%2C1009.3890%2C1009.5994%2C1009.5509%2C1009.3127%2C1009.0793%2C1009.1456%2C1009.4526%2C1009.0604%2C1009.0323%2C1009.4742%2C1009.2411%2C1009.4880%2C1009.0249%2C1009.4001%2C1009.2724%2C1009.1468%2C1009.0831%2C1009.1061%2C1009.2418%2C1009.4591%2C1009.4251%2C1009.0446%2C1009.0068%2C1009.5721%2C1009.4615%2C1009.0005%2C1009.0451%2C1009.4556%2C1009.3137%2C1009.5475%2C1009.0304%2C1009.3509%2C1009.4317%2C1009.1397%2C1009.1337%2C1009.3581%2C1009.4632%2C1009.4264%2C1009.4862%2C1009.4771%2C1009.5801%2C1009.2828%2C1009.2244%2C1009.2359%2C1009.1776%2C1009.3869%2C1009.5598%2C1009.3954%2C1009.4531%2C1009.3067%2C1009.4835%2C1009.5708%2C1009.4271%2C1009.3231%2C1009.4731%2C1009.1866%2C1009.3619%2C1009.0607%2C1009.3329%2C1009.4630%2C1009.0780%2C1009.2373%2C1009.0160%2C1009.4942%2C1009.1511%2C1009.4460%2C1009.5125%2C1009.1609%2C1009.3822%2C1009.1568%2C1009.0401%2C1009.3948%2C1009.5344%2C1009.4401%2C1009.1024%2C1009.5769%2C1009.3600%2C1009.2530%2C1009.2136%2C1009.2019%2C1009.4613%2C1009.3646%2C1009.1404%2C1009.0043%2C1009.1700%2C1009.3407%2C1009.2965&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The log-periodic power law (LPPL) is a model of asset prices during\nendogenous bubbles. A major open issue is to verify the presence of LPPL in\nprice sequences and to estimate the LPPL parameters. Estimation is complicated\nby the fact that daily LPPL returns are typically orders of magnitude smaller\nthan measured price returns, suggesting that noise obscures the underlying LPPL\ndynamics. However, if noise is mean-reverting, it would quickly cancel out over\nsubsequent measurements. In this paper, we attempt to reject mean-reverting\nnoise from price sequences by exploiting frequency-domain properties of LPPL\nand of mean reversion. First, we calculate the spectrum of mean-reverting \\ou\nnoise and devise estimators for the noise's parameters. Then, we derive the\nLPPL spectrum by breaking it down into its two main characteristics of power\nlaw and of log-periodicity. We compare price spectra with noise spectra during\nhistorical bubbles. In general, noise was strong also at low frequencies and,\neven if LPPL underlied price dynamics, LPPL would be obscured by noise."}, "authors": ["Vincenzo Liberatore"], "author_detail": {"name": "Vincenzo Liberatore"}, "author": "Vincenzo Liberatore", "links": [{"href": "http://arxiv.org/abs/1009.4835v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1009.4835v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-fin.ST", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-fin.ST", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "J.4", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1009.4835v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1009.4835v2", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "Financial LPPL Bubbles with Mean-Reverting Noise in the\nFrequency Domain\nVincenzo Liberatore\n\n\u2217\n\narXiv:1009.4835v2 [q-fin.ST] 30 Jan 2011\n\nOctober 9, 2018\n\nAbstract\nThe log-periodic power law (LPPL) is a model of asset prices during endogenous bubbles.\nA major open issue is to verify the presence of LPPL in price sequences and to estimate the\nLPPL parameters. Estimation is complicated by the fact that daily LPPL returns are typically\norders of magnitude smaller than measured price returns, suggesting that noise obscures the\nunderlying LPPL dynamics. However, if noise is mean-reverting, it would quickly cancel out\nover subsequent measurements. In this paper, we attempt to reject mean-reverting noise from\nprice sequences by exploiting frequency-domain properties of LPPL and of mean reversion. First,\nwe calculate the spectrum of mean-reverting Ornstein-Uhlenbeck noise and devise estimators for\nthe noise's parameters. Then, we derive the LPPL spectrum by breaking it down into its two\nmain characteristics of power law and of log-periodicity. We compare price spectra with noise\nspectra during historical bubbles. In general, noise was strong also at low frequencies and, even\nif LPPL underlied price dynamics, LPPL would be obscured by noise.\n\n1\n\nIntroduction\n\nFinancial bubbles and busts have devastating effect on the economy and on markets. However,\nthe existence and characteristics of bubbles are notoriously hard to ascertain if not with hindsight. This paper contributes to the investigation of financial bubbles within the LPPL framework [Sornette, 2004], and specifically it examines its frequency-domain properties under a meanreverting noise model.\nEndogenous financial bubbles have been modeled as a log-periodic power law (LPPL) [Sornette, 2004].\nThe LPPL model has two main characteristics:\n\u2022 Super-exponential growth, leading to a critical time at which the asset price will burst (power\nlaw ), and\n\u2022 Oscillations that become progressively faster as the critical time approaches (log-periodicity).\nSuper-exponential growth is a sign that price growth is unsustainable. The oscillatory behavior\nindicates an incipient system failure, and is often associated with increasingly more rapid and\npronounced swings in investor sentiment [Stauffer and Sornette, 1998].\n\u2217\n\nDivision of Computer Science, Case Western Reserve University, 10900 Euclid Avenue, Cleveland, Ohio 441067071, USA. E-mail: vl@case.edu. URL: http://vincenzo.liberatore.org/.\n\n1\n\n\fPrevious work has paid considerable attention to fitting the LPPL law to historical time series\nof financial bubbles, and a recent summary reviews the state of the art [Jiang et al., 2010]. Current\nmethods for LPPL bubble detection have been tested in an on-line experiment [Sornette et al., 2009].\nPrevious work mostly focus on the two related issues of statistical significance and of noise in the\ndata. The LPPL model parameters can be fit to the price sequences via non-linear least-squares\n[Jiang et al., 2010], and we have previously proposed efficient parallel algorithms for least-square\nfitting [Liberatore, 2010]. The least-square algorithm returns an estimate for the LPPL parameters\nas well as a residual error. However, least squares always estimate parameters for the LPPL model,\nregardless of whether LPPL underlies actual price dynamics or not. The least square residual error gives a sense of the presence of LPPL: if the final mean squared error is significantly smaller\nthan the error at the beginning of the numerical fit, then there is some evidence for an underlying\nLPPL process. However, reliance on mean squared errors can produce spuriously high goodness\nof fit [Granger and Newbold, 1974, Phillips, 1986]. Although LPPL is often visible intuitively in\nprice series and non-linear least squares substantially reduce the mean squared error over an initial\nexponential fit, the log-periodic component of the S&P 500 is not statistically significant prior\nto the 1987 crash if the last year of data is removed [Feigenbaum, 2001]. Furthermore, Bayesian\nmethods fundamentally reject the hypothesis that LPPL underlies price dynamics during a bubble\n[Chang and Feigenbaum, 2006]. An alternative approach is to verify the non-linear least squares\nusing unrelated tests, such as bounding the range of acceptable LPPL parameters or using a Lomb\ntransform [Jiang et al., 2010]. However, log-periodic variations prior to large drawdowns fail to\nsatisfy the parameter restrictions in the LPPL model [Chang and Feigenbaum, 2008].\nIn fitting LPPL to prices, the fundamental problem is that the daily LPPL returns are typically\norders of magnitude smaller than the measured price returns. In other words, a hypothetical LPPL\nsignal would be swamped by overwhelming noise, and thus it is difficult to ascertain its presence\nand its parameter values. Furthermore, it is also possible that the noise variance increases over\ntime, in which case the observed prices tend to progressively differ more significantly from an\nunderlying deterministic LPPL. When noise variance increases, the noise effectively becomes the\nsignal. As such, LPPL estimation is plagued by a low signal-to-noise ratio, which additionally\nmay be decreasing over time. However, an LPPL model with mean-reverting noise (e.g., OrnsteinUhlenbeck) has been recently proposed [Lin et al., 2009]. If noise is mean-reverting, it has bounded\nvariance, and thus the measured prices fits more tightly around the underlying LPPL. Furthermore,\nalthough a mean-reverting process may be characterized by large daily return, the daily gyrations\nwill rapidly cancel each other out. In other words, mean-reverting noise is characterized by relatively\nlow power at low frequencies. Thus, mean-reversion would make it possible to reconstruct the\nunderlying LPPL by focusing on the lower frequency components of measured prices.\nIn this paper, we examine LPPL with mean-reverting Ornstein-Uhlenbeck noise in the frequency\ndomain. The paper investigates the mean-reverting properties of the noise, and whether the denoised power spectrum shows a deterministic LPPL signature. Section 2 describes the LPPL model.\nSection 3 gives the necessary background on Ornstein-Uhlenbeck processes, analyzes its spectrum,\nand discusses two methods for estimating its parameters. Section 4 gives our methodology for\ncalculating spectra of finite price sequences. Section 5 discusses the LPPL spectrum by breaking\nit down into its two main features of power law and log-periodicity. Section 6 discusses noise\nrejection in noisy LPPL price sequences. Section 7 evaluates the approach on major historical\nbubbles. Section 8 concludes the paper and outlines possible future work.\n\n2\n\n\f1000\n\nS&P 500\nLPPL\n0\n\n200\n\n400\n600\ntime (day)\n\n800\n\n1000\n\nFigure 1: Log-scale S&P 500 and an LPPL fit from July 2003 to June 2007.\n\n2\n\nLPPL\n\nThe log-periodic power law is a function:\n`(t) = A \u2212 B(T \u2212 t)m (1 + C cos(\u03c9 ln(T \u2212 t) + \u03c6)) ,\n\n(1)\n\nwhere B > 0 and 0 < m \u2264 1. The LPPL function is a model for a sequence of price logarithms\np(0), p(1), . . . , p(n \u2212 1) in the sense that p(i) = `(i) + \u03bd(i), where \u03bd(i) is random noise independent\nof `. If we assume that `(T ) = A, the LPPL function ` is defined for t \u2264 T . In particular, since `\nis a model for a finite sequence of prices, we will also restrict ` over t \u2265 0. As matter of notational\nconvention, we remark that we call price sequence and denote as p(0), p(1), . . . , p(n \u2212 1) what in\nreality is the natural logarithm of prices. The convention makes our notation more compact, but it\nshould be kept in mind that, for example, our daily price returns are basically price ratios. Figure\n1 shows the S&P 500 daily closing prices and a least squares LPPL fit for the four years between\nJuly 2003 and June 2007. If m = 1, C = 0, LPPL reduces to an exponential model of the price\nsequence. If m < 1, then LPPL grows super-exponentially until the critical time T . If C, \u03c9 > 0,\nthen LPPL exhibits oscillations that become progressively more frequent as t approaches the critical\ntime. Since ` is a deterministic signal and \u03bd is a wide-sense stationary process independent of `,\nmost properties of stationary signals can be applied [Pollock, 2001]. Since \u03bd is independent of `,\n|P (f )|2 = |L(f )|2 + S(f ), where L(f ) is the transform of `, P (f ) is the transform of p, and S(f ) is\nthe noise power.\n\n3\n3.1\n\nOrnstein-Uhlenbeck Noise\nBackground\n\nThe Ornstein-Uhlenbeck process \u03bd(t) is the solution of the stochastic differential equation:\n\u03bd 0 (t) = \u2212\n\n\u03bd(t)\n+ \u03c3\u0393(t) ,\n\u03c4\n\n3\n\n\fwhere \u0393(t) is Gaussian white noise, \u03c4 \u2265 0 is called the relaxation time, and \u03c3 \u2265 0 is called the\ndiffusion constant [Bibbona et al., 2008]. The Ornstein-Uhlenbeck process can be interpreted as\nwhite noise that has been filtered by a first-order system with cut-off frequency fc = 1/(2\u03c0\u03c4 ). When\n\u03c4 \u2192 \u221e, the Ornstein-Uhlenbeck process reduces to a Weiner process. As t \u2192 \u221e, Var[\u03bd(t)] = \u03c3 2 \u03c4 /2\nand Cov[\u03bd(t + h), \u03bd(t)] = \u03c3 2 \u03c4 e\u2212|h|/\u03c4 /2 [Bibbona et al., 2008]. A Ornstein-Uhlenbeck process can\nbe simulated by means of:\nr\n\u03c32\u03c4\n\u22121/\u03c4\n\u03bd(t + 1) = \u03bd(t)e\n+\n(1 \u2212 e\u22122/\u03c4 )ut ,\n(2)\n2\nwhere ut is a sample value of a normal random variable [Gillespie, 1991]. The stationary OrnsteinUhlenbeck process can be simulated by using recurrence (2) starting from \u03bd(0) being the sample of\na Gaussian random variable with variance equal to limt\u2192\u221e Var[\u03bd(t)] = \u03c3 2 \u03c4 /2.\n\n3.2\n\nSpectrum\n\nThe two-sided power spectrum is defined for t \u2192 \u221e, is equal to [Wang and Uhlenbeck, 1945]:\n\u0012\n\u0013\n\u03c32\u03c4 2\n1\nT (f ) =\n0\u2264f \u2264\n1 + 4\u03c0 2 \u03c4 2 f 2\n2\nand it is the same as that of a first-order low-pass filter with cut-off frequency fc . Since we will be\ndealing with sampled Ornstein-Uhlenbeck processes, it is also useful to derive the spectrum of the\ndiscrete-time Fourier transform. The transform of the auto-correlation function is\n\u221e\nX\n\u03c3 2 \u03c4 \u2212|h|/\u03c4 \u2212j\u03c9h\nS(\u03c9) =\ne\ne\n2\nh=\u2212\u221e\n!\n\u221e\nX\n\u03c32\u03c4\ne\u2212h/\u03c4 (e\u2212j\u03c9h + ej\u03c9h )\n\u22121 +\n=\n2\n= \u2212\n\n\u03c32\u03c4\n2\n\nh=0\n\u221e\nX\n\n+ \u03c32\u03c4\n\nah cos(\u03c9h) ,\n\nh=0\n\nwhere a = e\u22121/\u03c4 . Since, it is known that for |r| < 1 [R\u00e5de and Westergren, 1999, eq. 13.2(29)]\n\u221e\nX\n\nrh cos(hk) =\n\nh=0\n\n1 \u2212 r cos k\n,\n1 \u2212 2r cos k + r2\n\nwe have that\n\u03c32\u03c4\nS(\u03c9) =\n2\n\n\u0012\n\n1 \u2212 a cos \u03c9\n\u22121 + 2\n1 \u2212 2a cos \u03c9 + a2\n\n\u0013\n=\n\n\u03c32\u03c4\n1 \u2212 a2\n.\n2 1 \u2212 2a cos \u03c9 + a2\n\nIn terms of frequency f = \u03c9/(2\u03c0),\nS(f ) =\n\n1 \u2212 a2\n\u03c32\u03c4\n.\n2 1 \u2212 2a cos(2\u03c0f ) + a2\n\nFigure 2 shows the power of the discrete-time Fourier transform S(f ) and of the continuous Fourier\ntransform T (f ) for \u03c4 = 5 and \u03c3 = 1/5. The power spectra are similar except at the highest\nfrequencies. At low frequencies, since a ' 1 \u2212 1/\u03c4 and a2 ' 1 \u2212 2/\u03c4 , T (f ) ' S(f ) ' \u03c3 2 /(1 \u2212 a)2 '\n\u03c32\u03c4 2.\n4\n\n\f10\n\n1\n\nS(f)\n0.1\n\n0.01\n1e-05\n\nT(f)\n\nS(f) (DTFT)\nT(f)\n0.0001\n\n0.001\n\n0.01\n\n0.1\n\nf\n\nFigure 2: Power spectrum of the Fourier and discrete-time Fourier transform for \u03c4 = 5, \u03c3 = 1/5.\n\n3.3\n\nOrnstein-Uhlenbeck Estimation\n\nWe now turn to the estimation of the parameters \u03c3 and \u03c4 in the Ornstein-Uhlenbeck noise. We will\nfollow two approaches for parameter estimation. The first approach is based on the intuition that\non short time frames the noise dominates the LPPL signal (e.g., [Chang and Feigenbaum, 2006]).\nTherefore, the noise parameters could be determined with high accuracy by looking at diffusion and\nmean reversal over short intervals, possibly corrected by a first-order trend estimate. The second\napproach is pessimistic: it assumes \u03c4 \u2192 \u221e and finds the largest value of \u03c3 that is consistent with\nthe observed signal. In other words, the pessimistic approach attempts to explain the observed\nsignal as much as possible as Weiner noise.\n3.3.1\n\nMaximum Likelihood\n\nHigh-frequency estimation is based on the assumption that over short time scales the signal is\ncompletely dominated by noise. In this case, `(t + 1) ' `(t), and since p(t) = `(t) + \u03bd(t), we have\nthat \u03bd(t + 1) \u2212 \u03bd(t) ' p(t + 1) \u2212 p(t).\nGiven a sequence of observations \u03bd(0), \u03bd(1), . . . , \u03bd(n \u2212 1) of an Ornstein-Uhlenbeck process, the\nmaximum likelihood estimates of \u03c4 and \u03c3 2 are\n\u03c4\u0302 = ln\n\nSxx\n,\nSxy\n\n2\u03c4\u0302\n1\n(Syy \u2212 2\u00e2Sxy + \u00e22 Sxx ) ,\n2\n1 \u2212 \u00e2 n \u2212 1\nPn\u22121 2\nPn\u22121\nPn\u22121 2\nwhere \u00e2 = e\u22121/\u03c4\u0302 , Sxx =\ni=1 \u03bd (i \u2212 1), Sxy =\ni=1 \u03bd(i \u2212 1)\u03bd(i), and Syy =\ni=1 \u03bd (i)\n[van den Berg, 2007]. Maximum likelihood estimation is an estimation technique that operates\nexclusively in the time-domain.\nHowever, the \u03bd values are only known indirectly through the differences \u03bd(t + 1) \u2212 \u03bd(t). Define\n\u03b1\n=\nPt t\u22121 \u03bd(t) \u2212 \u03bd(0) and observe that \u03b1t is known via the telescoping summation \u03bd(t) = \u03bd(0) +\ni=0 (\u03bd(i + 1) \u2212 \u03bd(i)). Since the Ornstein-Uhlenbeck process has no drift, Sx Sxy = Sy Sxx , where\n\u03c3\u0302 2 =\n\n5\n\n\f10000\n\n\u03c4 (estimate)\n\n1000\n100\n10\n1\n0.1\n1\n\n10\n\n100\n\n1000\n\n\u03c4\n\nFigure 3: Estimate \u03c4\u0302 versus its underlying value \u03c4 . For each value of \u03c4 , 30 Monte Carlo simulations\nwere executed over intervals of length n = 25000.\nSx =\n\nPn\u22121\ni=1\n\n0 =\n\n=\n\n\u03bd(i \u2212 1) and Sy =\n\nPn\u22121\ni=1\n\n\u03bd(i) [van den Berg, 2007]. Therefore,\n\nn\u22121\nX\n\nn\u22121\nX\n\nn\u22121\nX\n\nn\u22121\nX\n\ni=1\n\nj=1\n\ni=1\n\nj=1\n\n(\u03bd(0) + \u03b1i\u22121 )\n\n(\u03bd(0) + \u03b1j\u22121 )(\u03bd(0) + \u03b1j ) \u2212\n\n(\u03bd(0) + \u03b1i )\n\n(\u03bd(0) + \u03b1j\u22121 )2\n\nn\u22121\nX n\u22121\nX\n\n(\u03bd(0)3 + \u03bd(0)2 (\u03b1j + \u03b1j\u22121 + \u03b1i\u22121 ) + \u03bd(0)(\u03b1j \u03b1j\u22121 + \u03b1i\u22121 \u03b1j + \u03b1i\u22121 \u03b1j\u22121 )\n\ni=1 j=1\n\n+\u03b1i\u22121 \u03b1j \u03b1j\u22121 )\n\u2212\n\nn\u22121\nX n\u22121\nX\n\n2\n2\n\u03bd(0)3 + \u03bd(0)2 (2\u03b1j\u22121 + \u03b1i ) + \u03bd(0)(\u03b1j\u22121\n+ 2\u03b1i \u03b1j\u22121 ) + \u03b1i \u03b1j\u22121\n\ni=1 j=1\n\n= (n \u2212 1)\u03bd(0)Axy + \u03bd(0)A2x + Ax Axy \u2212 (n \u2212 1)\u03bd(0)Axx \u2212 \u03bd(0)Ax Ay \u2212 Ay Axx ,\nP\nPn\u22121\nPn\u22121\nPn\u22121\nwhere Ax = n\u22121\ni=1 \u03b1i\u22121 , Ay =\ni=1 \u03b1i , Axy =\ni=1 \u03b1i \u03b1i\u22121 , and Ayy =\ni=1 \u03b1i \u03b1i , Solving for\n\u03bd(0) now gives\nAy Axx \u2212 Ax Axy\n.\n\u03bd(0) =\n(n \u2212 1)Axy \u2212 (n \u2212 1)Axx + A2x \u2212 Ay Ax\nGiven the estimate for \u03bd(0) and the \u03b1i 's, the \u03bd(i)'s can be estimated, and thus \u03c4 and \u03c3 2 .\nTo increase the estimate accuracy in the presence of an underlying deterministic trend `, we\nestimate a linear fit to the log-prices p and subtract it from p(t).\nMonte Carlo simulations were conducted to ascertain the accuracy of the maximum likelihood\nestimation. The estimation was quite accurate when the underlying LPPL trend gave negligible\ncontributions to the \u03b1i 's, but less accurate otherwise. Additionally, even in the complete absence of\nan underlying trend, the estimate \u03c4\u0302 of \u03c4 became progressively less accurate as \u03c4 gets larger (Figure\n3). An intuitive explanation is that when \u03c4 is large, then mean reversion affects only slightly the\n\u03b1i 's, making it hard to obtain an accurate fix on \u03c4 . In principle, the problem could be obviated by\nformulating an estimate with returns over longer periods of time (i.e., \u03bd\u0303(i) = \u03bd(ki), k > 1). However,\nthe problem is compounded if an underlying trend ` has relatively large power at frequencies smaller\n6\n\n\fthan the critical frequency fc = 1/(2\u03c0\u03c4 ). In this case, the underlying trend ` affects the signal at\nthe same frequencies at which the relaxation term does, thus obscuring the exact contribution of\nthe relaxation constant. The case when \u03c4 is large will be addressed by pessimistic estimation.\n\n3.4\n\nPessimistic Estimation\n\nIn pessimistic estimation, we assume that the noise is generated by a Weiner process (i.e., \u03c4 \u2192 \u221e)\nand estimate \u03c3 using the constraint |P |2 = |L|2 + S \u2265 S that the noise power should not exceed\nthe observed signal power. The estimate is pessimistic in that it assumes no mean reversion and\nthus strong noise even at low frequencies.\nLet S\u03c4 (f ) be the power spectrum of an Ornstein-Uhlenbeck process when the relaxation constant\nis \u03c4 and define S\u221e (f ) = lim\u03c4 \u2192\u221e S\u03c4 (f ). Then, if f > 0,\nS\u221e (f ) = lim S\u03c4 (f ) =\n\u03c4 \u2192\u221e\n\n\u0010\n\u0011\n\u03c32\n\u03c32\nlim \u03c4 1 \u2212 e\u22122/\u03c4 =\n,\n4(1 \u2212 cos(2\u03c0f )) \u03c4 \u2192\u221e\n2(1 \u2212 cos(2\u03c0f ))\n\nand\n\n\u03c3 2 \u03c4 1 \u2212 a2\n= \u03c32 .\n\u03c4 \u2192\u221e 2 (1 \u2212 a)2\n\nS\u221e (0) = lim\n\nIt should be the case that P (f ) \u2264 S\u221e (f ) for all f 's. In practice, however, the observed signal is the\nrealization of a stochastic signal, and so P (f ) may or may not exceed S\u221e (f ) [Lo\u00e8ve, 1978]. Hence,\nwe only impose integral constraints of the form\nZ f+\nZ f+\nS\u221e (f )df \u2264\nP (f )df ,\nf\u2212\n\nf\u2212\n\nwhere f \u2212 and f + are parameters to be determined with 0 < f \u2212 < f + \u2264 1/2. Furthermore, the\nspectrum P is calculated only at the discrete points fi = i/n, so the constraint becomes\nk\nX\n\nS\u221e (fi ) \u2264\n\ni=h\n\nP (fi ) ,\n\ni=h\n\nwhich then leads to\n2\n\nk\nX\n\n\u03c3 \u2264 Pk\n\n2\n\nPk\n\ni=h P (fi )\n\ni=h 1/(1\n\n\u2212 cos(2\u03c0fi ))\n\n.\n\n(3)\n\nA pessimistic estimate can be obtained by calculating the bounds for h0 = 1, kj = hj+1 = (1 + \u03b1)hj\n(for some constant \u03b1 > 0, e.g., \u03b1 = 1) and then taking the most conservative bound.\nThe numerical calculation of the bounds is complicated by the fact that the summations in (3)\ninvolve terms whose value can differ by orders of magnitude. In this case, if the largest terms are\nadded first, due to the finite representation precision, the smallest terms are likely to be truncated.\nIn an extreme scenario, many small terms could collectively dominate the value of the summation\nbut since they are added individually to a larger partial sum, their contribution would be lost.\nIn general, a summation is numerically more accurate when it always adds terms of comparable\nmagnitude. Since S\u221e is a decreasing function (and the same holds in the expectation for P ), the\nnumerical calculation should always start from the largest frequency fk and proceed backward to\nfh . (As an aside, however, the numerical calculation is only needed for the numerator, since the\ndenominator could be replaced by an integral that is solvable analytically.)\n7\n\n\f3\n\n10\n102\n101\n100\n10-1\n10-2\n10-3\n10-4\n10-5\n10-6\n10-7\n10-8 -5\n10\n\nsqrt(P(f))\nsqrt(S(f))\nsqrt(S\u221e(f))\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 4: DFT amplitude of a log-periodic function, (A = 10, B = 0.008, T = 26000, m = 0.7, n =\n25000, C = 0.4, \u03c9 = 2\u03c0, \u03c6 = \u03c0), underlying Ornstein-Uhlenbeck noise (\u03c3 2 = .000015, \u03c4 = 2000, fc =\n7.96 * 10\u22125 ), and pessimistic estimate (\u03b1 = 1, \u03c3 2 = .0000145).\nFigure 4 shows an example of pessimistic estimate in a case when \u03c4 = 2000 is relatively large\nand difficult to estimate because P (fc ) is dominated by the power of the underlying signal `. The\npessimistic estimate was quite accurate, and S\u221e differs from the underlying S(f ) only for the\nsmallest frequency values. Similar conclusions were supported by several additional Monte Carlo\nsimulations.\n\n4\n\nReflection\n\nThe Ornstein-Uhlenbeck process describes an infinitely long signal. On the contrary, p(0), p(1), . . . , p(n\u2212\n1) is a finite sequence. Similarly, ` is defined in the finite interval [0, T ]. In the calculation of the\nspectrum, an ambiguity arises regarding the behavior of p and ` outside of their definition interval.\nIn many applications, finite sequences are multiplied by a window function, or they are implicitly\nassumed to be periodic. Implicit periodization matches directly the discrete Fourier transform\n(DFT), in the sense that, given the sequence p(0), p(1), . . . , p(n \u2212 1), the DFT assumes that the\nsignal is infinite, periodic, with period n, and that p(i) = p(i \u2212 n) for i = 0, \u00b11, \u00b12, . . . . In typical\nlog-periodic sequences, p(n \u2212 1) \u001d p(0), and if the signal were viewed as periodic, then there would\nbe a large step between p(n \u2212 1) and p(n) = p(0). The step is primarily an artifact of the implicit\nDFT assumption of periodicity, but the large artificial step could dominate the behavior of the\npower spectrum. As for windowing, typical window functions either leave a large boundary step\n(e.g., rectangular window) or disregard the fact that the LPPL behavior becomes more pronounced\nat the boundaries of the observation window (e.g., Hann).\nIn this paper, the discontinuity is obviated by reflection: given a sequence p(0), p(1), . . . , p(n\u22121),\na new sequence is constructed by juxtaposing the original sequence and a reverse version of the\nsame sequence: p(n \u2212 1), . . . , p(1), p(0), p(1), . . . , p(n \u2212 2), and assuming that the new sequence is\nperiodic with period 2(n \u2212 1). The reflected sequence has no abrupt discontinuity between the\nfirst and last element, and thus no such step is visible in its spectrum. We also tried alternative\napproaches, such as appending after p(n \u2212 1) values that smoothly interpolate between p(n \u2212 1) and\n8\n\n\f1\n\n10\n\n100\n-1\n\n10\n\n10-2\n10-3\n10-4\n10-5\n10-6 -5\n10\n\nreflected\noriginal\nsqrt(S(f)) (DTFT)\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nf\n\nFigure 5: DFT p\namplitude of a realization (\u03c3 = .2, \u03c4 = 5) of the Ornstein-Uhlenbeck process, of its\nreflection, and S(f ).\np(0) over a long time frame, but we did not find significant differences between these alternatives\nand reflection.\nTo reiterate, given a finite sequence or a function defined over a finite interval, the Fourier\ntransform always requires an assumption of some sort on the sequence behavior outside the given\ninterval. For example, if the sequence is left unchanged, the DFT implicitly assumes that the\nsequence is periodic. In this light, reflection is a natural choice because, unlike implicit periodization\nor windowing, it eliminates abrupt discontinuities at the boundaries. Reflection also lead to a\nsymmetrical analysis of bubbles and anti-bubbles (i.e., a bubble-like behavior in reverse with rapidly\ndecreasing prices [Sornette, 2004]).\nIf reflection is applied to a sequence p = ` + \u03bd that is the sum of a log-periodic component\nand a noise component, reflection will apply indiscriminately to both components. Thus, it is\npossible in principle that reflection would alter the power spectrum of noise. However, several\nMonte Carlo simulations showed that reflection leaves the power spectrum of Ornstein-Uhlenbeck\nnoise practically unaffected. For example, Figure 5 gives the DFT amplitude of a realization\np of an\nOrnstein-Uhlenbeck process, the DFT amplitude of the reflection of the same process, and S(f ).\nReflection leaves the same general spectral behavior because, intuitively, the autocorrelation of\nstochastic signals is invariant to time reversal and the autocorrelation of an Ornstein-Uhlenbeck\nprocess decays exponentially.\n\n5\n\nLog-Periodic Spectra\n\nTo derive the LPPL spectrum, we will break down the LPPL model into its two main components of\npower law (without oscillations) and log-periodicity (without super-exponential growth). Then, we\nwill return to the general case with the insight gained from the special cases, and verify numerically\nits spectral behavior.\n\n9\n\n\f-2\n\n10\n\n-3\n\n10\n\n10-4\n-5\n\n10\n\n10-6\n10-7\n10-8\n10-9\n10-10\n10-11\n10-12 -5\n10\n\nm=1\nm = 1/4\nm = 1/10\nm = 1/256\nm = 1/1024\nm = 1/8192\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 6: DFT amplitude of the power law `m .\n\n5.1\n\nPower Law\n\nConsider first the case when C = 0, i.e., the LPPL function is completely determined by its power\nlaw behavior. If m = C = 0 (or if B = 0), ` reduces to a constant, and its transform L(f ) = 0 for\nf 6= 0. If C = 0, m = 1, the reflected LPPL reduces to a triangular wave, for which it is known\nthat |L(fi )| \u221d 1/fi2 when i is odd and L(fi ) = 0 when i > 0 is even.\nThe super-exponential behavior is the most pronounced when m \u2192 0+ , and A, B change as a\nfunction of m so that ` is not a constant. First, suppose for the time being that T = n (the same\nresult will hold for T > n except for changes in the normalization constants). If A is multiplied by\na factor independent of t, L(f ) remains unchanged (f 6= 0). Similarly, if B is multiplied by a factor\nindependent of t, L(f ) is multiplied by the same factor (f 6= 0). In other words, a normalization of\nthe constants A and B renormalizes L(f ) but does not alter its qualitative behavior. Assume that\nRT\nA and B are renormalized so that `(0) = 0 and 0 `(t)dt = 1/2. Thus, A = \u00c2(m) = (1+1/m)/(2T )\nand B = B\u0302(m) = A/T m . Let `m (t) = \u00c2(m) \u2212 B\u0302(m)(T \u2212 t)m . Note that limm\u21920+ \u00c2(m) = \u221e and\nthat we take the transform of reflected signals. Hence, limm\u21920+ `m (t) is the delta function, and its\nspectrum is a constant (specifically, 1/2T with the common conventions on the DFT normalization\nfactor). Figure 6 depicts the convergence of `m to the delta function in the frequency domain.\nWhen m 6= 0 is small, a flat spectrum characterizes the higher frequencies. As m \u2192 0+ , a constant\nspectrum is found in a progressively larger frequency interval. Meanwhile, the spectrum at low\nfrequencies has an increasingly flatter slope: |L(f )| \u221d 1/f 2 at m = 1, |L(f )| \u221d 1/f at m ' 0.1,\nand so on. The amplitude |L(f )| decreases faster than 1/f for the range m \u2265 0.1 that defines the\n\"stylized features of LPPL\" [Lin et al., 2009].\nThe same behavior holds also when n < T by appropriately scaling the normalization constants\nof A and B. The same results hold qualitatively for A, B constant: the spectrum is flat although\nthe absolute values do change depending on the normalization factor (see, for example, Figure 7).\n\n5.2\n\nLog-Periodicity\n\nIf m = 0, then `(t) = A\u2212B(1+C cos(\u03c9 ln(T \u2212t)+\u03c6)) (see Figure 8 for an example). By discounting\n \u0303 = cos(\u03c9 ln(T \u2212 t) + \u03c6). The signal `(t)\n \u0303 includes a\nthe constant terms, the resulting signal is `(t)\n10\n\n\f105\n\nm=1\nm = .7\nm = .5\nm = .1\nslope = -1\nm = 1/80\nm = 1/5120\n\n104\n103\n102\n101\n100\n10-1\n10-2\n10-3\n10-4\n-5\n\n10\n\n-5\n\n10\n\n-4\n\n10\n\n-3\n\n10\n\n-2\n\n10\n\n-1\n\n10\n\nFigure 7: DFT amplitude of an LPPL function for various values of m (A = 10, B = 0.01, T = n =\n25000, C = 0).\n\n1\n\n0.5\n\n0\n\n-0.5\n\n-1\n0\n\n5000\n\n10000\n\n15000\n\n20000\n\n25000\n\nFigure 8: An LPPL function that highlights the oscillatory term as a function of non-linear time\nscaling (A = 1, B = 1, C = \u22121, m = 0, \u03c9 = 3\u03c0, n = 25000, T = n/(1\u2212e\u221211\u03c0/\u03c9 ), \u03c6 = \u2212\u03c9 ln(T \u2212n)).\n\n11\n\n\f2\n\n10\n\n1\n\n10\n\n100\n-1\n\n10\n\n10-2\n10-3\n10-4\n10-5\n10-6\n10-7\n10-8 -5\n10\n\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 9: The DFT amplitude of the LPPL function in Figure 8, with arrows pointing to the\nminimum and maximum frequencies of the log-periodic spectrum.\nnon-linear time scaling, which can be interpreted as the frequency modulation of a carrier signal\nsin(2\u03c0f (t)t + \u03b1) with some underlying signal f (t). Given a frequency modulated signal, such as\n \u0303\n`(t),\nits power spectrum resides almost entirely in the band between the maximum and minimum\nvalue of the modulating signal [Carson, 1922]. In practice, the differential frequency at time t is\ngiven by the derivative of phase \u03c9 ln(T \u2212t)+\u03c6 normalized by 2\u03c0, and is thus equal to \u03c9/(2\u03c0(T \u2212t)).\nHence, the minimum frequency is \u03c9/(2\u03c0T ) and the maximum frequency is \u03c9/(2\u03c0(T \u2212 n)). Figure\n9 shows an example along with the predicted frequency bounds.\nFrequency-modulated signals are known to be resilient to changes in signal amplitude. In\nparticular, the spectrum of ` \u0303m (t) = (T \u2212 t)m cos(\u03c9 ln(T \u2212 t) + \u03c6) should be qualitatively close\nto the spectrum of ` \u03030 (t). For example, Figure 10 shows the spectrum of Figure 9 except that\nnow m = 0.3. The maximum and minimum frequencies still delimit the area where the frequency\nmodulated signal has predominant power.\nIncidentally, the critical time T is in a special position in that it affects both power law (due to\n(T \u2212 t)m term) and log-periodicity (due to the ln(T \u2212 t) term). Correspondingly, T determines both\nthe maximum frequency \u03c9/(2\u03c0(T \u2212n)) in the frequency modulated spectrum and the normalization\nconstants \u00c2(m), B\u0302(m) in the power law spectrum. In both cases, the effect of T is similar in that,\nwhen T approaches n, the maximum frequency and the normalization constants both increase.\nFrequency modulation analysis could be regarded as the dual of the Lomb transform of the detrended signal [Jiang et al., 2010] in that the frequency bounds are useful to estimate log-periodicity,\nwhereas Lomb analysis is useful to confirm it after the LPPL parameters have already been estimated.\n\n5.3\n\nCombined LPPL\n\nThe two LPPL hallmarks are power law and log-periodicity. Each translates directly into the\nfrequency domain. The power law implies a flat spectrum at high frequencies and moderate slope\nat low frequencies. Log-periodicity implies a bounded spectrum similar to that of a frequency\nmodulated signal. Given the spectrum |P |2 of prices during a bubble, we would expect to find\neither (or both) signatures of LPPL in the frequency domain.\n12\n\n\f4\n\n10\n\nC=-1\n2\n\n10\n\n0\n\n10\n\nC=0\n\n10-2\n10-4\n10-6\n10-8 -5\n10\n\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 10: The DFT amplitude of the LPPL function in Figure 8 but with m = 0.3, with arrows\npointing to the minimum and maximum frequencies of the log-periodic spectrum.\nThe general LPPL spectrum is analytically intractable, and it was estimated numerically. Sequences were generated for hundreds of different LPPL parameter sets, the respective spectra\nwere calculated numerically and plotted. In general, to make sense of the spectrum, it is helpful\nto interpret it qualitatively in terms of the two main features of power law and log-periodicity.\nSpecifically, a LPPL spectrum can be thought as the superposition of a power law spectrum and\na log-periodic spectrum, where the superposition is weighted by the parameter C. For example,\nFigure 10 compares an LPPL spectrum with that of a pure power law with the same parameter\nvalues (but C = 0). As another example, Figure 11 shows the spectrum for a pure power law function (m = 0.7, C = 0), a pure log-periodic function (m = 0, C = 0.5), and two intermediate cases\n(m = 0.7, C = 0.01, 0.05). The intermediate cases have a spectrum that is visually the superposition of the two extreme spectra. Furthermore, higher values of C make the log-periodic component\nmore visible. If C is small, the frequency modulation lobes are typically visible around the trend\nrather than above it (e.g., Figure 12). Results were similar for all other combinations of parameters,\nand omitted. Although it is helpful to comprehend a general LPPL spectrum as a superposition\nof feature, the intuition can seldom be translated into a closed expression. However, it is always\nuseful to think the LPPL spectrum as the combination of two broad features. In particular, given\na noisy LPPL, we would expect to find the two LPPL signatures in the frequency domain.\n\n6\n\nDe-Noising\n\nWe now turn to discuss the extent to which it is possible to extract an underlying LPPL signal\nfrom noisy price measurements. The expectation would intuitively be that the mean-reverting\nnoise smooths out relatively quickly so that the underlying LPPL behavior should be visible at the\nlower frequencies. More precisely, the potential for de-noising depends on achieving high values\nof the signal-to-noise ratio R(f ) = |L(f )|2 /S(f ). The signal-to-noise ratio R(f ) is related to the\nnon-causal Weiner filter\nK(f ) = 1/(1 + 1/R(f )). The Weiner filter K hasP\nthe property that the\n\u02c6 = P\u221e\n\u02c6 2 among\nfiltered signal `(i)\nk(j)p(i\n\u2212\nj)\nminimizes\nthe\nmean\nsquare\nerror\n(`(i) \u2212 `(i))\nj=\u2212\u221e\nall linear filters, where the k's are the inverse transform of K and p is the reflected and periodicized\n13\n\n\f104\n\nC=0 (power law)\nC=0.01\nC=0.5\nm=0 (log-periodicity)\n\n102\n\n100\nC=0.5\n\n10-2\n\nC=0\n\n10-4\n\nm=0\n\n10-6\n\n10-8\n10-5\n\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 11: |L(f )| for A = 100, B = 0.01, T = 26000, n = 25000, \u03c9 = 2\u03c0, \u03c6 = 0 in the cases of pure\npower law (m = 0.7, C = 0), pure log-periodicity (m = 0, C = 0.5), and two intermediate cases\n(m = 0.7, C = 0.01, 0.5).\n\n4\n\n10\n\nLPPL\nC=0 (power law)\nm=0 (log periodicity)\n\n102\n100\n-2\n\n10\n\n10-4\n10-6\n10-8\n10-10 -5\n10\n\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 12: |L(f )| for A = 100, B = 0.01, T = 26000, n = 25000, \u03c9 = 2\u03c0, \u03c6 = 0 in the cases of\npure power law (m = 0.7, C = 0), pure log-periodicity (m = 0, C = 0.05), and combined case\n(m = 0.7, C = 0.05).\n\n14\n\n\f10-2\n10-3\n10-4\n10-5\n10-6\n10-7\n10-8\n10-9\n10-10\n-11\n\n10\n\n10-5\n\nLPPL with noise\nPessimistic noise estimate\nLPPL (no noise)\n10-4\n\n10-3\n\n10-2\n\n10-1\n\nFigure 13: Spectrum |L(f )| of `0.1 with and without noise, and pessimistic noise estimate.\ntime series of prices. If R(f ) decreases with f , then K(f ) is a low pass filter and, intuitively, the\nfilter replace each price p(i) with a smoothed combination of its neighbors so as to reject the noise.\nThe signal-to-noise ratio is a function of frequency and can take various shapes depending on the\nparameters of the underlying LPPL ` and Ornstein-Uhlenbeck noise.\nIn the stylized LPPL, m \u2265 0.1, and, with a pure power law (C = 0), |L|2 always decreases\nfaster than the slope of S. Hence, the power law contributes to de-noising only if |L(f )|2 > S(f )\nat low frequencies. In pure log-periodicity (m = 0), |L(f )| is significant only for frequencies\nf \u2264 \u03c9/(2\u03c0(T \u2212 n)). Again, log-periodicity contributes to de-noising only if |L(f )|2 > S(f ) at low\nfrequencies.\nIt is useful to examine the special case when |L(f )| \u221d 1/f at low frequencies since |L|'s slope\nmatches exactly the slope of S\u221e . In this case, it may be hard to ascertain the presence of a signal\n` if Weiner noise is also present since the LPPL spectrum almost perfectly overlaps with the noise\nspectrum. Figure 13 shows the amplitude |L| of an LPPL `0.1 without noise. Then, Gaussian white\nnoise was generated with variance \u03c3 2 chosen so that the corresponding spectrum S\u221e matches closely\n|L|2 at low frequencies. The amplitude of the resulting price transform is shown in Figure 13 along\nwith the pessimistic estimate defined in Section 3.4. The pessimistic estimate overlapped almost\nexactly the true noise spectrum (whereas the maximum likelihood estimate did not produce finite\nparameter estimates). The spectra |L|2 , |P |2 , and S\u221e were practically identical at low frequencies,\nbut at high frequencies |P | followed the larger |L|. We conclude that even in the special case when\nthe LPPL is hidden under the noise because m makes |L(f )| \u221d 1/f and \u03c3 2 makes |L(f )|2 ' S\u221e at\nlow frequencies, LPPL and noise can be distinguished by extracting a pessimistic noise estimate.\nHowever, in this case, the difference is noticeable at high frequencies.\nIn summary, the intuition was that LPPL should be visible at the low frequencies, and it is\ncorrect in most cases. Then, de-noising should be possible when the spectrum looks qualitatively\nas in Figure 4, with the price spectrum clearly above the noise estimate for a significant range of\nfrequencies at the low end of the spectrum. However, we found special combinations of parameters\n(e.g., Figure 13) where the presence of LPPL is visible only from the highest frequencies.\nIf the time horizon n approaches the critical time T , intuition would suggest that it should\nbe easier to detect an LPPL trend. Indeed, if the critical time T is approaching, then the max-\n\n15\n\n\fSeries\nDow Jones Industrial Average\nS&P 500\nNASDAQ Composite\nS&P 500\nGLD\n\nPeriod\nJune 1921-July 1929\nJuly 1985\u2013July 1987\nJanuary 1994\u2013February 2000\nJuly 2003\u2013June 2007\nMarch 2009\u2013October 2009\n\nData Points\n2440\n527\n1555\n1000\n171\n\nTable 1: Price time series used in the evaluation.\nimum log-periodic frequency is higher resulting into a wider frequency modulated spectrum, and\nthe normalization constant B\u0302 is larger, shifting the spectrum upward. In other words, when the\ncritical time approaches, the LPPL function resembles more closely an impulse and additionally its\noscillations are wilder, so that it is hard for mean-reverting noise to disguise the underlying LPPL\ntrend.\n\n7\n\nEvaluation\n\nData sets are daily closing values of the major indexes and securities shown in Table 1. The first\nfour data sets are associated with major historical bubbles in the U.S. stock market. The last data\nset is a recent bubble in gold prices that burst in November 2009 [Sornette et al., 2009]. These\nprices sequences stop closely before the time at which the price reached its maximum level during\nthe bubble episode. Therefore, the detection of an underlying LPPL trend should be relatively\neasy. We have additionally considered individual stocks. For example, we have investigated various\ntech stocks during the 1998-2000 bubble and the Netflix stock in the 2005-10 period. The results\nare qualitatively similar to those reported here, and omitted.\nThe maximum likelihood and pessimistic noise estimates were close to each other, providing\nevidence that mean reversion is weak. Both estimates fit well the price spectrum, a sign that\nprices can be explained primarily as a Weiner process. In most cases, the spectrum deviates from\nthe pessimistic estimate only at f = 0, 1/(2n), which is consistent with adding Weiner noise to\ndeterministic exponential price trajectory.\nAs for the maximum likelihood estimate, the diffusion constant is relatively large. The maximum\nlikelihood estimate was slightly but consistently smaller at low frequencies than the price spectrum\nin two cases: Dow Jones 1929 and gold 2009. The discrepancy was investigated with a filter to\nremove the maximum likelihood noise. The filter is non-causal and produces a signal ` \u0303 with the\nproperty that L\u0303(f ) = L(f ) if f < f \u0303 and L\u0303(f ) = 0 otherwise, where f \u0303 is the smallest frequency\nf at which |L(f )|2 < S(f ). The intuition is that the underlying LPPL spectrum |L|2 decreases\nfaster than the noise spectrum S, so if one takes the smallest frequency f at which |L(f )|2 \u2265 S(f ),\nthe resulting low-pass filter approximates a Weiner filter. Figures 19 and 20 show the original and\nfiltered series. Both filtered series show significant oscillations at the beginning and slight superexponential growth throughout. However, the oscillations are absent toward the end of the filtered\nsequence. Since log-periodic oscillations become progressively more rapid toward the critical time,\neven if log-periodicity were present in these price sequences, oscillations would be blocked by the\nfilter at the highest log-periodic frequencies. However, the filter only blocks frequencies when noise\ndominate the signal, and so we conclude that log-periodicity, if at all present, has been disrupted by\n16\n\n\f2\n\n10\n\n101\n100\n10-1\n10-2\n10-3\n10-4\n10-5\n10-6 -4\n10\n\nDow Jones 1929\nMax Likelihood\nPessimistic\n10-3\n\n10-2\n\n10-1\n\nFigure 14: Spectrum of the Dow Jones 1929 price sequence.\n101\n100\n10-1\n10-2\n10-3\n10-4\nS&P 500 1987\nMax Likelihood\nPessimistic\n\n10-5\n-6\n\n10\n\n-4\n\n10\n\n-3\n\n-2\n\n10\n\n10\n\n-1\n\n10\n\nFigure 15: Spectrum of the S&P 500 1987 price sequence.\nnoise. Similarly, super-exponential growth is visually unclear both in the time and in the frequency\ndomain.\nIn summary, noise had at best weak mean reversion and relatively high variance, so that, even\nif LPPL underlied price dynamics, it was obscured by noise.\n\n8\n\nConclusions\n\nThe estimators show that mean reversion is weak, and Ornstein-Uhlenbeck noise is close to a\nnon-mean-reverting Weiner process. Furthermore, the signal-to-noise ratio R(f ) is low, and it\nmostly makes it possible to reconstruct an underlying exponential trend. Even in those cases\nwhere R(f ) > 0 for a range of low frequencies, noise makes it impossible to reconstruct either\nlog-periodicity or a power law. In short, due to noise, there is no trace of LPPL during bubbles.\nHowever, it is possible in principle that LPPL underlies price dynamics, but that it cannot\nbe isolated with pure frequency methods. Future work will investigate different transforms, such\n17\n\n\f2\n\n10\n\n101\n100\n10-1\n10-2\n10-3\n10-4\n10-5\n10-6 -4\n10\n\nNasdaq 1994-2000\nMax Likelihood\nPessimistic\n10-3\n\n10-2\n\n10-1\n\nFigure 16: Spectrum of the NASDAQ Composite 1994-2000 price sequence.\n1\n\n10\n\n100\n10-1\n10-2\n10-3\n10-4\nS&P 500 2003-7\nMax Likelihood\nPessimistic\n\n10-5\n-6\n\n10\n\n-4\n\n10\n\n-3\n\n-2\n\n10\n\n10\n\n-1\n\n10\n\nFigure 17: Spectrum of the S&P 500 2003-07 price sequence.\n100\n10-1\n10-2\n10-3\n10-4\n10-5\n10-6 -3\n10\n\nGLD 2009\nMax Likelihood\nPessimistic\n10-2\n\n10-1\n\nFigure 18: Spectrum of the GLD (gold) 2009 price sequence.\n18\n\n\fDJIA (filtered)\nDJIA\n\n100\n\n0\n\n500\n\n1000\n\n1500\n\n2000\n\n2500\n\nFigure 19: Dow Jones 1929 with filtered price sequence (f \u0303 = f9 ).\n\nGLD (filtered)\nGLD\n100\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100 120 140 160 180\n\nFigure 20: Gold 2009 with filtered price sequence (f \u0303 = f6 ).\n\n19\n\n\fas wavelets, that may make it possible to discern explosive bubble growth. Furthermore, if the\nunderlying LPPL were expressed as a dynamic system with known parameters, it would be possible\nto use the additional information in de-noising filters that extend a pure frequency approach.\n\nReferences\n[Bibbona et al., 2008] Bibbona, E., Panfilo, G., and Tavella, P. (2008). The Ornstein-Uhlenbeck\nprocess as a model of a low pass filtered white noise. Metrologia, 45:S117\u2013S126.\n[Br\u00e8e et al., 2010] Br\u00e8e, D., Challet, D., and Peirano, P. (2010). Prediction accuracy and sloppiness\nof log-periodic functions. Technical Report 1006:2010v1, arXiv.\n[Carson, 1922] Carson, J. R. (1922). Notes on the theory of modulation. Proc. IRE, 10(1):57\u201364.\n[Chang and Feigenbaum, 2006] Chang, G. and Feigenbaum, J. (2006). A Bayesian analysis of logperiodic precursors to financial crashes. Quantitative Finance, 6(1):15\u201336.\n[Chang and Feigenbaum, 2008] Chang, G. and Feigenbaum, J. (2008). Detecting log-periodicity in\na regime-switching model of stock returns. Quantitative Finance, 8:723\u2013738.\n[Feigenbaum, 2001] Feigenbaum, J. A. (2001). A statistical analysis of log-periodic precursors to\nfinancial crashes. Quantitative Finance, 1:346\u2013360.\n[Gillespie, 1991] Gillespie, D. (1991). Markov processes: An introduction for physical scientists.\nAcademic Pr.\n[Granger and Newbold, 1974] Granger, C. W. J. and Newbold, P. (1974). Spurious regressions in\neconometrics. Journal of Econometrics, 2:111\u2013120.\n[Jiang et al., 2010] Jiang, Z.-Q., Zhou, W.-X., Sornette, D., Woodard, R., Bastiaensen, K., and\nCauwels, P. (2010). Bubble diagnosis and prediction of the 2005-2007 and 2008-2009 Chinese\nstock market bubbles. Economic Behavior and Organization, 74:149\u2013162.\n[Liberatore, 2010] Liberatore, V. (2010). Computational LPPL fit to financial bubbles. Technical\nReport 1003.2920, ArXiv.\n[Lin et al., 2009] Lin, L., E, R. R., and Sornette, D. (2009). A Consistent Model of 'Explosive'\nFinancial Bubbles With Mean-Reversing Residuals. ArXiv e-prints.\n[Lo\u00e8ve, 1978] Lo\u00e8ve, M. (1978). Probability theory II, volume 46 of Graduate Texts in Mathematics.\nSpringer-Verlag, 4 edition.\n[Phillips, 1986] Phillips, P. (1986). Understanding spurious regressions in econometrics. Journal\nof Econometrics, 31:311\u2013340.\n[Pollock, 2001] Pollock, D. S. G. (2001). Methodology for trend estimation. Economic Modelling,\n18(1):75 \u2013 96.\n[R\u00e5de and Westergren, 1999] R\u00e5de, L. and Westergren, B. (1999). Mathematics Handbook for Science and Engineering. Springer, Berlin.\n20\n\n\f[Sornette, 2004] Sornette, D. (2004). Critical phenomena in natural sciences: chaos, fractals, selforganization, and disorder: concepts and tools. Springer.\n[Sornette et al., 2009] Sornette, D., Woodard, R., Fedorovsky, M., Reimann, S., Woodard, H., and\nZhou, W.-X. (2009). The financial bubble experiment: advanced diagnostics and forecasts of\nbubble terminations.\n[Stauffer and Sornette, 1998] Stauffer, D. and Sornette, D. (1998). Log-periodic oscillations for\nbiased diffusion on random lattice. Physica A, 252:271\u2013277.\n[van den Berg, 2007] van den Berg, M. (2007). Calibrating the Ornstein-Uhlenbeck model.\n[Wang and Uhlenbeck, 1945] Wang, M. C. and Uhlenbeck, G. E. (1945). On the theory of Brownian\nmotion II. Rev. Mod. Phys., 17:323\u2013342.\n\n21\n\n\f"}