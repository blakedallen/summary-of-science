{"id": "http://arxiv.org/abs/math/0209227v1", "guidislink": true, "updated": "2002-09-18T16:59:43Z", "updated_parsed": [2002, 9, 18, 16, 59, 43, 2, 261, 0], "published": "2002-09-18T16:59:43Z", "published_parsed": [2002, 9, 18, 16, 59, 43, 2, 261, 0], "title": "On the diagram of Schroeder permutations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0209083%2Cmath%2F0209127%2Cmath%2F0209075%2Cmath%2F0209118%2Cmath%2F0209317%2Cmath%2F0209044%2Cmath%2F0209402%2Cmath%2F0209288%2Cmath%2F0209197%2Cmath%2F0209061%2Cmath%2F0209176%2Cmath%2F0209279%2Cmath%2F0209059%2Cmath%2F0209092%2Cmath%2F0209123%2Cmath%2F0209237%2Cmath%2F0209381%2Cmath%2F0209099%2Cmath%2F0209354%2Cmath%2F0209250%2Cmath%2F0209012%2Cmath%2F0209124%2Cmath%2F0209034%2Cmath%2F0209299%2Cmath%2F0209357%2Cmath%2F0209095%2Cmath%2F0209121%2Cmath%2F0209208%2Cmath%2F0209319%2Cmath%2F0209271%2Cmath%2F0209218%2Cmath%2F0209294%2Cmath%2F0209156%2Cmath%2F0209023%2Cmath%2F0209045%2Cmath%2F0209084%2Cmath%2F0209122%2Cmath%2F0209292%2Cmath%2F0209331%2Cmath%2F0209316%2Cmath%2F0209347%2Cmath%2F0209322%2Cmath%2F0209138%2Cmath%2F0209282%2Cmath%2F0209046%2Cmath%2F0209015%2Cmath%2F0209193%2Cmath%2F0209035%2Cmath%2F0209363%2Cmath%2F0209048%2Cmath%2F0209340%2Cmath%2F0209054%2Cmath%2F0209246%2Cmath%2F0209051%2Cmath%2F0209191%2Cmath%2F0209038%2Cmath%2F0209334%2Cmath%2F0209385%2Cmath%2F0209353%2Cmath%2F0209074%2Cmath%2F0209069%2Cmath%2F0209309%2Cmath%2F0209072%2Cmath%2F0209379%2Cmath%2F0209243%2Cmath%2F0209172%2Cmath%2F0209100%2Cmath%2F0209063%2Cmath%2F0209086%2Cmath%2F0209130%2Cmath%2F0209384%2Cmath%2F0209153%2Cmath%2F0209196%2Cmath%2F0209401%2Cmath%2F0209323%2Cmath%2F0209166%2Cmath%2F0209031%2Cmath%2F0209090%2Cmath%2F0209389%2Cmath%2F0209364%2Cmath%2F0209253%2Cmath%2F0209033%2Cmath%2F0209161%2Cmath%2F0209081%2Cmath%2F0209039%2Cmath%2F0209242%2Cmath%2F0209016%2Cmath%2F0209267%2Cmath%2F0209027%2Cmath%2F0209228%2Cmath%2F0209010%2Cmath%2F0209096%2Cmath%2F0209227%2Cmath%2F0209183%2Cmath%2F0209050%2Cmath%2F0209057%2Cmath%2F0209022%2Cmath%2F0209249%2Cmath%2F0209257%2Cmath%2F0209094%2Cmath%2F0209148&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the diagram of Schroeder permutations"}, "summary": "Egge and Mansour have recently studied permutations which avoid 1243 and 2143\nregarding the occurrence of certain additional patterns. Some of the open\nquestions related to their work can easily be answered by using permutation\ndiagrams. Like for 132-avoiding permutations the diagram approach gives\ninsights into the structure of {1243,2143}-avoiding permutations that yield\nsimple proofs for some enumerative results concerning forbidden patterns in\nsuch permutations.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0209083%2Cmath%2F0209127%2Cmath%2F0209075%2Cmath%2F0209118%2Cmath%2F0209317%2Cmath%2F0209044%2Cmath%2F0209402%2Cmath%2F0209288%2Cmath%2F0209197%2Cmath%2F0209061%2Cmath%2F0209176%2Cmath%2F0209279%2Cmath%2F0209059%2Cmath%2F0209092%2Cmath%2F0209123%2Cmath%2F0209237%2Cmath%2F0209381%2Cmath%2F0209099%2Cmath%2F0209354%2Cmath%2F0209250%2Cmath%2F0209012%2Cmath%2F0209124%2Cmath%2F0209034%2Cmath%2F0209299%2Cmath%2F0209357%2Cmath%2F0209095%2Cmath%2F0209121%2Cmath%2F0209208%2Cmath%2F0209319%2Cmath%2F0209271%2Cmath%2F0209218%2Cmath%2F0209294%2Cmath%2F0209156%2Cmath%2F0209023%2Cmath%2F0209045%2Cmath%2F0209084%2Cmath%2F0209122%2Cmath%2F0209292%2Cmath%2F0209331%2Cmath%2F0209316%2Cmath%2F0209347%2Cmath%2F0209322%2Cmath%2F0209138%2Cmath%2F0209282%2Cmath%2F0209046%2Cmath%2F0209015%2Cmath%2F0209193%2Cmath%2F0209035%2Cmath%2F0209363%2Cmath%2F0209048%2Cmath%2F0209340%2Cmath%2F0209054%2Cmath%2F0209246%2Cmath%2F0209051%2Cmath%2F0209191%2Cmath%2F0209038%2Cmath%2F0209334%2Cmath%2F0209385%2Cmath%2F0209353%2Cmath%2F0209074%2Cmath%2F0209069%2Cmath%2F0209309%2Cmath%2F0209072%2Cmath%2F0209379%2Cmath%2F0209243%2Cmath%2F0209172%2Cmath%2F0209100%2Cmath%2F0209063%2Cmath%2F0209086%2Cmath%2F0209130%2Cmath%2F0209384%2Cmath%2F0209153%2Cmath%2F0209196%2Cmath%2F0209401%2Cmath%2F0209323%2Cmath%2F0209166%2Cmath%2F0209031%2Cmath%2F0209090%2Cmath%2F0209389%2Cmath%2F0209364%2Cmath%2F0209253%2Cmath%2F0209033%2Cmath%2F0209161%2Cmath%2F0209081%2Cmath%2F0209039%2Cmath%2F0209242%2Cmath%2F0209016%2Cmath%2F0209267%2Cmath%2F0209027%2Cmath%2F0209228%2Cmath%2F0209010%2Cmath%2F0209096%2Cmath%2F0209227%2Cmath%2F0209183%2Cmath%2F0209050%2Cmath%2F0209057%2Cmath%2F0209022%2Cmath%2F0209249%2Cmath%2F0209257%2Cmath%2F0209094%2Cmath%2F0209148&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Egge and Mansour have recently studied permutations which avoid 1243 and 2143\nregarding the occurrence of certain additional patterns. Some of the open\nquestions related to their work can easily be answered by using permutation\ndiagrams. Like for 132-avoiding permutations the diagram approach gives\ninsights into the structure of {1243,2143}-avoiding permutations that yield\nsimple proofs for some enumerative results concerning forbidden patterns in\nsuch permutations."}, "authors": ["Astrid Reifegerste"], "author_detail": {"name": "Astrid Reifegerste"}, "author": "Astrid Reifegerste", "arxiv_comment": "22 pages", "links": [{"href": "http://arxiv.org/abs/math/0209227v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0209227v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05A05; 05A15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0209227v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0209227v1", "journal_reference": null, "doi": null, "fulltext": "ON THE DIAGRAM OF SCHR\u00d6DER PERMUTATIONS\n\narXiv:math/0209227v1 [math.CO] 18 Sep 2002\n\nAstrid Reifegerste\nInstitut f\u00fcr Algebra und Geometrie\nOtto-von-Guericke-Universit\u00e4t Magdeburg\nPostfach 4120, D-39016 Magdeburg, Germany\nastrid.reifegerste@mathematik.uni-magdeburg.de\nSeptember 17, 2002\nAbstract. Egge and Mansour have recently studied permutations which avoid 1243 and 2143 regarding the\noccurrence of certain additional patterns. Some of the open questions related to their work can easily be answered\nby using permutation diagrams. Like for 132-avoiding permutations the diagram approach gives insights into the\nstructure of {1243, 2143}-avoiding permutations that yield simple proofs for some enumerative results concerning\nforbidden patterns in such permutations.\n\n1 Introduction\nLet Sn be the set of all permutations of {1, . . . , n}. Given a permutation \u03c0 = \u03c01 * * * \u03c0n \u2208 Sn\nand a permutation \u03c4 = \u03c41 * * * \u03c4k \u2208 Sk , we say that \u03c0 contains the pattern \u03c4 if there is a sequence\n1 \u2264 i1 < i2 < . . . < ik \u2264 n such that the elements \u03c0i1 \u03c0i2 * * * \u03c0ik are in the same relative order\nas \u03c41 \u03c42 * * * \u03c4k . Otherwise, \u03c0 avoids the pattern \u03c4 , or alternatively, \u03c0 is \u03c4 -avoiding. The set of \u03c4 avoiding permutations in Sn is denoted by Sn (\u03c4 ). For an arbitrary finite collection T of patterns\nwe write Sn (T ) to denote the permutations of {1, . . . , n} which avoid each pattern in T .\nEgge and Mansour [3] studied permutations which avoid both 1243 and 2143. This work was\nmotivated by the parallels to 132-avoiding permutations. In [7, Lem. 2 and Cor. 9] was shown\nthat the number of elements of Sn (1243, 2143) is counted by the (n \u2212 1)st Schr\u00f6der number rn\u22121 .\nThe (large) Schr\u00f6der numbers may be defined by\nr0 := 1,\n\nrn := rn\u22121 +\n\nn\u22121\nX\n\nri rn\u22121\u2212i\n\nfor n \u2265 1.\n\ni=0\n\nFor this reason the authors of [3] called the permutations which avoid 1243 and 2143 Schr\u00f6der\npermutations; we will do this as well. (The reference to Schr\u00f6der numbers may be somewhat\ninexact because there are ten inequivalent pairs (\u03c41 , \u03c42 ) \u2208 S42 for which |Sn (\u03c41 , \u03c42 )| = rn\u22121 , see\n[7, Theo. 3]. However, it is sufficient for our purposes.)\n1\n\n\fSchr\u00f6der permutations are known to have a lot of properties which are analogous to properties\nof 132-avoiding permutations. Why it needs to be so, a look at their diagrams shows.\nGiven a permutation \u03c0 \u2208 Sn , we obtain its diagram D(\u03c0) as follows: first let \u03c0 be represented\nby an n \u00d7 n-array with a dot in each of the squares (i, \u03c0i ). Shadow all squares due south or\ndue east of some dot and the dotted cell itself. The diagram D(\u03c0) is defined as the region left\nunshaded after this procedure. A square that belongs to D(\u03c0) we call a diagram square; a row\n(column) of the array that contains a diagram square is called a diagram row (diagram column).\n(The diagram is an important tool in the theory on the Schubert polynomial of a permutation.\nSchubert polynomials were extensively developed by Lascoux and Sch\u00fctzenberger. See [8] for a\ntreatment of this work.)\nBy the construction, each of the connected components of D(\u03c0) is a Young diagram. Their\ncorners are defined to be the elements of the essential set E(\u03c0) of the permutation \u03c0. In [5],\nFulton introduced this set which together with a rank function was used as a tool for algebraic\ntreatment of Schubert polynomials. For any element (i, j) \u2208 E(\u03c0), its rank is defined to be the\nnumber of dots northwest of (i, j), and is denoted by \u03c1(i, j). Furthermore, by Er (\u03c0) we denote\nthe set of all elements of E(\u03c0) whose rank equals r.\nIt is clear from the construction that the number of dots in the northwest is the same for all\ndiagram squares which are connected. Consequently, we can extend the rank function on the\ndiagram squares. It is a fundamental property of the ranked essential set of a permutation \u03c0,\nthat it uniquely determines \u03c0. (This result was first proved by Fulton, see [5, Lem. 3.10b];\nalternatively, an algorithm for retrieving the permutation from its ranked essential set was\nprovided in [4].)\nAnswering a question of Fulton, Eriksson and Linusson gave in [4] a characterization of all ranked\nsets of squares that arise as ranked essential set of a permutation.\nTo recover a permutation from its diagram is trivial: row by row, put a dot in the leftmost\nshaded square such that there is exactly one dot in each column.\nThe concept should be clear from Figure 1.\n0\n\ns\n\ns\ns\n0\n0\n\n1\n\ns\n\ns\n\ns\n3\n1\n\n3\n\ns\n\ns\n\ns\ns\nFigure 1 Diagram and ranked essential set of \u03c0 = 9 4 8 10 3 1 7 6 2 5 \u2208 S10 .\n\n2\n\n\fIn [9], we used permutation diagrams to give combinatorial proofs for some enumerative results\nconcerning forbidden subsequences in 132-avoiding permutations. Now we develop analogues of\nthese bijections. In particular, we will discuss some open problems which have been raised in\n[3].\nThe following section begins with a characterization of Schr\u00f6der permutation diagrams. Then\nwe will give a surjection that takes any Schr\u00f6der permutation to a 132-avoiding permutation of\nthe same inversion number. On the other hand, a simple way to generate all Schr\u00f6der permutation diagrams from those corresponding to 132-avoiding permutations is described.\nSection 3 deals with additional restrictions of Schr\u00f6der permutations. As it was done for 132avoiding permutations we will characterize from the diagram the occurrence of increasing and\ndecreasing subsequences of prescribed length, as well as of some modifications. This yields simple combinatorial proofs for some results appearing in [3].\nIn the same reference a bijection between Schr\u00f6der permutations and lattice paths was given.\nSection 4 shows how the path can immediately be obtained from the diagram of the corresponding permutation.\nThe paper ends with some remarks about potential generalizations of its results.\n\n2 A description of Schr\u00f6der permutation diagrams\nBy [9, Theo. 2.2], 132-avoiding permutations are precisely those permutations for which the\ndiagram corresponds to a partition, or equivalently, for which the rank of every element of the\nessential set equals 0. Analogously, we can characterize the elements of Sn (1243, 2143).\nTheorem 2.1 A permutation \u03c0 \u2208 Sn is a Schr\u00f6der permutation if and only if every element of\nits essential set is of rank at most 1.\nProof. If there exists an element (i, j) \u2208 E(\u03c0) (or equivalently, any diagram square (i, j)) with\n\u03c1(i, j) \u2265 2 then, by definition, at least two dots appear in the northwest of (i, j), say in the rows\ni1 < i2 . Obviously, the subsequence \u03c0i1 \u03c0i2 \u03c0i \u03c0i3 is of type 1243 (represented in the following\nfigure) or 2143 where \u03c0i3 = j:\ni1\n\ns\n\ni2\n\ns\ns\ns\nj\n\n3\n\ni\n\ni3\n\n\fOn the other hand, it is clear from the construction that the occurrence of a pattern 1243 or\n2143 in a permutation yields a diagram corner of rank at least 2.\n\n\u2737\n\nWe wish to describe the diagrams more precisely that arise as diagram of a Schr\u00f6der permutation.\nFirst we state two elementary properties of each permutation diagram.\nLemma 2.2 Let \u03c0 \u2208 Sn be an arbitrary permutation.\na) We have i + j \u2264 n + r for each (i, j) \u2208 Er (\u03c0).\nb) Let (i, j) be a diagram square of rank 1 for which (i \u2212 1, j) and (i, j \u2212 1) do not belong\nto D(\u03c0). Then \u03c0i\u22121 = j \u2212 1. Furthermore, for any element (i, j) \u2208 E1 (\u03c0) there exists no\nsquare (i\u2032 , j \u2032 ) \u2208 E(\u03c0) with i\u2032 < i and j \u2032 < j.\nProof. a) Let (i, j) \u2208 E(\u03c0) be of rank r. Then exactly r indices k < i satisfy \u03c0k < j. By\nconstruction, we have \u03c0i > j and i < \u03c0j\u22121 . Thus there exist i \u2212 r integers k \u2264 i with \u03c0k > j.\nClearly, the number of all elements \u03c0k > j in \u03c0 equals n \u2212 j. This yields the restriction.\nb) By definition, there is exactly one dot (representing a pair (i\u2032 , j \u2032 ) where \u03c0i\u2032 = j \u2032 ) northwest of\n(i, j). From the condition that (i, j) forms the upper left-hand corner of a connected component\n\u22121\nof diagram squares follows \u03c0i\u22121 < j and \u03c0j\u22121\n< i. Thus we have i\u2032 = i \u2212 1 and j \u2032 = j \u2212 1.\n\nFor the second assertion let (i, j) \u2208 E1 (\u03c0). Suppose that there exists a diagram corner (i\u2032 , j \u2032 )\nwith i\u2032 < i and j \u2032 < j. Obviously, (i\u2032 , j \u2032 ) must be of rank 0, and by the first part, it is different\nfrom (i \u2212 1, j \u2212 1). Thus (i\u2032 , j \u2032 ) is a corner of the Young diagram formed from the diagram\n\u2032\n\u2032\nsquares that are connected with (1, 1). Hence \u03c0i\u2032 +1 \u2264 j \u2032 and \u03c0j\u22121\n\u2032 +1 \u2264 i . (Note that i + 1 < i\n\nand j \u2032 + 1 < j; otherwise (i, j) is not a diagram square.) Consequently, there are two dots\nnorthwest of (i, j), contradicting to (i, j) \u2208 E1 (\u03c0).\n\n\u2737\n\nRemark 2.3 Condition a) is a part of Eriksson's and Linusson's characterization of ranked\nessential sets, see [4, Theo. 4.1].\nIn case of Schr\u00f6der permutations, the second claim of b) means: there are no diagram corners\n(i, j) and (i\u2032 , j \u2032 ) such that i\u2032 < i and j \u2032 < j. By [5, Prop. 9.6], just this property characterizes\nvexillary permutations. Fulton's description is an important example of characterization classes\nof permutations by the shape of their essential set. He gave a set of sufficient conditions that\nall except for one are also necessary. Later, Eriksson and Linusson strengthened that condition\nto obtain a set of necessary and sufficient conditions. Note that vexillary permutations can\nalternatively be characterized as 2143-avoiding ones, see [8, (1.27)]. Of course, every Schr\u00f6der\npermutation is vexillary.\n\n4\n\n\fConsequently, we can answer the question when a subset of the n2 squares of {1, . . . , n}2 is the\nessential set of a Schr\u00f6der permutation in Sn . In particular, this yields a further combinatorial\ninterpretation of Schr\u00f6der numbers.\nProposition 2.4 For s \u2265 0 let i1 \u2265 i2 \u2265 . . . \u2265 is and j1 \u2264 j2 \u2264 . . . \u2264 js be positive integers,\nand let r1 , r2 , . . . , rs be 0 or 1 such that\ni1 \u2212 r1 > i2 \u2212 r2 > . . . > is \u2212 rs > 0\n\n0 < j1 \u2212 r1 < j2 \u2212 r2 < . . . < js \u2212 rs .\n\nand\n\n(1)\n\nFor any n \u2265 i1 + js there is a unique permutation \u03c0 \u2208 Sn with E(\u03c0) = {(i1 , j1 ), . . . , (is , js )}\nand \u03c1(ik , jk ) = rk for k = 1, . . . , s. In particular, \u03c0 avoids 1243 and 2143, and every Schr\u00f6der\npermutation arises from a unique collection of such integers.\nProof. See Fulton's [5, Prop. 9.6]. The condition rk \u2208 {0, 1} follows from Therorem 2.1.\n\n\u2737\n\nIn [4, Prop. 2.2], the condition n \u2265 i1 + js has been replaced by ik + jk \u2264 n + rk for k = 1, . . . , s.\nCorollary 2.5\na) The (n \u2212 1)st Schr\u00f6der number rn\u22121 counts the number of tripels of the integer sequences\ni1 \u2265 i2 \u2265 . . . \u2265 is > 0 and 0 < j1 \u2264 j2 \u2264 . . . \u2264 js , and the binary sequence r1 , . . . , rs\nsatisfying (1) and ik + jk \u2264 n + rk for all k.\nb) The nth Catalan number Cn counts the number of pairs of integer sequences i1 > i2 >\n. . . > is > 0 and 0 < j1 < j2 < . . . < js such that ik + jk \u2264 n for all k. In particular,\nthe number of such pairs of sequences of length s is counted by the Narayana number\nN (n, s + 1).\nProof. The special case of 132-avoiding permutations (\u03c1(i, j) = 0 for each element (i, j) of the\n2n\u0001\n1\nessential set) in 2.4 yields part b). It is well known that |Sn (132)| = Cn = n+1\nn for all n.\n\u0001 n \u0001\n1 n\nThe second result of b) where N (n, s + 1) = n s s+1 appeared in [9, Rem. 2.6c].\n\u2737\n\nSome of the results of this paper are given in terms of essential sets. Therefore we will describe\nfirst how one can retrieve a Schr\u00f6der permutation from its ranked essential set. In the special\ncase of Schr\u00f6der permutations the retrieval algorithm due to Eriksson and Linusson is an evident\nprocedure; that's why we will do this without any technical notation used in [4].\nLet \u03c0 \u2208 Sn be a Schr\u00f6der permutation, and E := E(\u03c0) its essential set. Hence E is a subset of\nlabeled squares in {1, 2, . . . , n}2 satisfying Proposition 2.4. Let the elements of E be represented\nas white labeled squares in an n \u00d7 n-array. (All squares that do not belong to E are shaded.)\n\n5\n\n\f1\n0\n1\n0\n\nFigure 2a Ranked essential set of \u03c0 = 4 7 5 2 6 3 1 \u2208 S7 (1243, 2143).\n\n(1) Colour white all squares (i\u2032 , j \u2032 ) with i\u2032 \u2264 i and j \u2032 \u2264 j where (i, j) \u2208 E is a square labeled\nwith 0. In this way we obtain the connected component of all diagram squares which are of rank\n0. (Note that the rank function can be extended on the set of diagram squares.)\n0 0 0\n0 0 0\n0 0 0\n0\n0\n1\n0\n\n1\n\nFigure 2b All diagram squares of rank 0 are known.\n\n(2) Put a dot in each shaded square (i, j) for which every square (i\u2032 , j \u2032 ) with i\u2032 \u2264 i and j \u2032 \u2264 j,\ndifferent from (i, j), is a diagram square of rank 0. Obviously, these dots just represent the\nleft-to-right minima of the permutation. (A left-to-right minimum of a permutation \u03c0 is an\nelement \u03c0i which is smaller than all elements to its left, i.e., \u03c0i < \u03c0j for every j < i.)\n0 0 0\n0 0 0\n0 0 0\n0\n0\n1\n0\n\ns\n1\n\ns\n\ns\nFigure 2c All dotted squares connected with a diagram square of rank 0 are known.\n\n(3) For each dot contained in a square (i, j), colour white all squares (i\u2032\u2032 , j \u2032\u2032 ) with i < i\u2032\u2032 \u2264 i\u2032\nand j < j \u2032\u2032 \u2264 j \u2032 where (i\u2032 , j \u2032 ) \u2208 E is a square labeled with 1. By this step, all diagram squares of\nrank 1 are obtained. (Note that all squares which are situated in the southeast area of a given\ndot belong to the same connected component.)\n0 0 0\n0 0 0\n0 0 0\n0\n0\n1\n0\n\ns\n1 1\n\ns\n\ns\nFigure 2d The diagram is completed.\n\n(4) Row by row, if no dot exists in the row, put such a one in the leftmost shaded square such\nthat there is exactly one dot in each column. Now the permutation can read off from the array.\n\n6\n\n\f0 0 0\n0 0 0\n0 0 0\n0\n0\n1\n0\n\ns\n1 1\n\ns\n\ns\n\ns\n\ns\n\ns\n\ns\nFigure 2e The permutation \u03c0 = 4 7 5 2 6 3 1 is recovered.\n\nThe following transformation explains the close connection between 132-avoiding permutations\nand Schr\u00f6der permutations.\nProposition 2.6 Let \u03c0 \u2208 Sn be a Schr\u00f6der permutation. Let E \u2217 (\u03c0) be the set which we obtain\nfrom E(\u03c0) by replacing every element (i, j) \u2208 E1 (\u03c0) by (i \u2212 1, j \u2212 1) and defining it to be of rank\n0. Then E \u2217 (\u03c0) is an essential set. (In particular, E \u2217 (\u03c0) is the essential set of a 132-avoiding\npermutation.)\nProof. Let E(\u03c0) = {(i1 , j1 ), . . . , (is , js )}. We may assume that \u03c1(ik , jk ) = 1 for any k, otherwise\nthe assertion is trivial. Set i\u2032k := ik \u2212 1, jk\u2032 := jk \u2212 1, rk\u2032 := rk \u2212 1 = 0, and check Proposition\n2.4 for E = E(\u03c0) \u222a {(i\u2032k , jk\u2032 )} \\ {(ik , jk )}. Evidently, all the conditions are satisfied (we have\nik \u2212 rk = i\u2032k \u2212 rk\u2032 , jk \u2212 rk = jk\u2032 \u2212 rk\u2032 ).\n\n\u2737\n\nExample 2.7 Let \u03c0 = 4 7 5 2 6 3 1 \u2208 S7 (1243, 2143). Then the transformation E(\u03c0) 7\u2192 E \u2217 (\u03c0)\nyields the essential set of \u03c3 = 6 4 5 3 2 7 1 \u2208 S7 (132):\n0\n1\n0\n\n0\n\n\u2212\u2192\n\n0\n\n1\n0\n\n0\n\nFigure 3 On the left the diagram of \u03c0; on the right the diagram of \u03c3.\n\nLet \u03c6 : Sn (1243, 2143) \u2192 Sn be the map which takes any Schr\u00f6der permutation \u03c0 to the\npermutation whose essential set equals E \u2217 (\u03c0). Obviously, \u03c6 is a surjection to Sn (132).\nIt follows from Lemma 2.2b and the retrieval procedure that D(\u03c0) and D(\u03c6(\u03c0)) have the same\nnumber of squares. By [8, (1.21)], for any permutation \u03c0 \u2208 Sn the number of diagram squares\nis equal to the number of inversions inv(\u03c0) of \u03c0. Thus we have inv(\u03c0) = inv(\u03c6(\u03c0)) for every\n\u03c0 \u2208 Sn (1243, 2143). Furthermore, Fulton observed in [5] that a permutation \u03c0 \u2208 Sn has a\ndescent at position i if and only if there exists a diagram corner in the ith row of the n \u00d7 n-array\nrepresenting \u03c0. (An integer i \u2208 {1, . . . , n \u2212 1} for which \u03c0i > \u03c0i+1 is called a descent of \u03c0 \u2208 Sn .\nThe number of descents of \u03c0 is denoted by des(\u03c0).) Lemma 2.2b implies that des(\u03c0) \u2264 des(\u03c6(\u03c0))\nfor each \u03c0 \u2208 Sn (1243, 2143).\n7\n\n\fThe left-to-right minima of a permutation \u03c0 \u2208 Sn are represented by such dots (i, j) for which\n(i\u22121, j) or (i, j\u22121) are diagram squares of rank 0. To master the case \u03c01 = 1 we assume that (0, 1)\nis a diagram square of rank 0. Consequently, every left-to-right minimum of \u03c0 \u2208 Sn (1243, 2143)\nis also such a one for \u03c6(\u03c0).\nIn [9, Theo. 5.1] we have shown that the number of subsequences of type 132 in an arbitrary\npermutation is equal to the sum of ranks of all diagram squares. For Schr\u00f6der permutations this\nvalue is just the number of all diagram squares of rank 1.\nThe conversion of the above transformation is a simple way to construct Schr\u00f6der permutations\nwhich contain a prescribed number of occurrences of the pattern 132.\nGiven the essential set of a 132-avoiding permutation \u03c3 \u2208 Sn (132) (recall that E(\u03c3) is the corner\nset of a Young diagram fitting in (n \u2212 1, n \u2212 2, . . . , 1); all elements are of rank 0), we replace some\nelements (i, j) \u2208 E(\u03c3) by (i + 1, j + 1) and increase their label by 1. It follows from Proposition\n2.4 and Lemma 2.2a that the resulting set is an essential set of a Schr\u00f6der permutation in Sn if\nand only if we have i + j < n for all replaced elements (i, j).\nFor instance, from \u03c3 = 6 4 5 3 2 7 1 \u2208 S7 (132) we obtain:\n0\n\n0\n\n0\n\n0\n\n1\n\n1\n\n0\n\n0\n0\n\n0\n\n1\n\n0\n0\n\n1\n\n0\n\n1\n\n1\n\n1\n0\n\n0\n\u03c01 = \u03c3\n\n0\n\n\u03c02 = 4753261\n\n\u03c03 = 6357241\n\n1\n\n0\n1\n\n0\n\n0\n\n\u03c04 = 6452731\n\n\u03c05 = 3756241\n\n0\n\u03c06 = 4752631\n\n1\n\n1\n0\n\u03c07 = 6257431\n\n1\n0\n\u03c08 = 2756431\n\nFigure 4 (All the) Schr\u00f6der permutations obtained from \u03c3.\n\nObviously, these are all the Schr\u00f6der permutations which can be constructed in this way, that\nis, whose image with respect to \u03c6 equals \u03c3. Note that inv(\u03c3) = 15 = inv(\u03c0i ) for i = 1, . . . , 8.\nProposition 2.8 Let \u03c3 \u2208 Sn (132), and let s be the number of elements (i, j) \u2208 E(\u03c3) satisfying\ni + j < n. Then there exist 2s Schr\u00f6der permutations \u03c0 \u2208 Sn for which \u03c6(\u03c0) = \u03c3.\nProof. This follows from the preceding discussion.\n\n\u2737\n\nIn [9, Cor. 3.7], we have enumerated the Young diagrams fitting in (n \u2212 1, n \u2212 2, . . . , 1) according\nto the number of their corners in the diagonal i + j = n. The number of such diagrams with\n\u0001\n2n\u22121\u2212k\nk+1\nk \u2265 0 corners (i, n \u2212 i) equals the ballot number b(n \u2212 1, n \u2212 1 \u2212 k) = 2n\u22121\u2212k\n.\nn\n\nNow we are interested in the distribution of corners outside that diagonal.\n\nProposition 2.9 Let c(n \u2212 1, k) be the number of Young diagrams fitting in the shape (n \u2212\n1, n \u2212 2, . . . , 1) with k \u2265 1 corners satisfying i + j < n. Then we have\n\u0012\n\u0013\u0012\n\u0013\nn\u22121\u2212k\nX\nn\u2212i n\u22121\ni\nc(n \u2212 1, k) =\n.\nn\u2212i\nk\nk+i\ni=1\n\n8\n\n\fFurthermore, there are 2n\u22121 such diagrams with no corner outside the diagonal i + j = n.\nProof. Consider the Young diagram as being contained in an n \u00d7 n-rectangle, and consider\nthe lattice path from the upper right-hand to the lower left-hand corners of the rectangle that\ntravels along the boundary of the diagram. Defining the rectangle diagonal to be the x-axis with\norigin in the lower left-hand corner, we obtain a Dyck path of length 2n, that is, a lattice path\nfrom (0, 0) to (2n, 0) which never falls below the x-axis. (In [9], we have noted that the lattice\npath resulting from the diagram of a 132-avoiding permutation \u03c0 \u2208 Sn in this way is just the\nDyck path corresponding to \u03c0 according a bijection proposed by Krattenthaler in [6].) In terms\nof Dyck paths, a diagram corner satisfying i + j < n means a valley at a level greater than 0\n(where the x-axis marks the 0-level). The distribution of the number of these valleys was given\nin [2, Sect. 6.11].\n\n\u2737\n\nThe previous both propositions immediately yield an explicit description for the Schr\u00f6der numbers.\nCorollary 2.10 For n \u2265 0 we have rn = 2n +\nRemark 2.11 Another one is rn =\n\nPn\n\nk=0\n\nPn\u22121\nk=1\n\n2k c(n, k).\n\n2n\u2212k \u0001\nCn\u2212k\nk\n\nwhere Cn =\n\n2n\u0001\n1\nn+1 n\n\ndenotes the nth\n\nCatalan number. This formula follows directly from an interpretation in terms of lattice paths,\nsee [11, Exc. 6.19 and 6.39].\n\n3 Forbidden subsequences in Schr\u00f6der permutations\nIn this section we will demonstrate that diagrams can be used to obtain simple proofs for\nenumerative results concerning certain restrictions of Schr\u00f6der permutations. Most of numbers\n|Sn (1243, 2143, \u03c4 )| appearing below are known from their analytical derivation in [3].\nFor the following investigation, only one case is really of interest: the essential set of \u03c0 \u2208\nSn (1243, 2143) contains both elements of rank 0 and 1. If E1 (\u03c0) = \u2205 then \u03c0 avoids 132, and all\nhas been done in [9]. If there is no diagram corner of rank 0 then we have \u03c01 = 1, and \u03c02 * * * \u03c0n\ncan be identified with a permutation in Sn\u22121 (132). In particular, these permutations contain as\nmany subsequences of type 21 (inversions) as of type 132. (Note that the number of the first\nones equals the number of all diagram squares, and the number of the latter counts all diagram\nsquares of rank 1).\nLet us start with the consideration of increasing subsequences. In [9, Theo. 4.1b] we proved\n9\n\n\fthat a permutation \u03c0 \u2208 Sn (132) avoids the pattern 12 * * * k if and only if its diagram contains\n(n+1\u2212k, n\u2212k, . . . , 1). (Recall that in case of 132-avoiding permutations the diagram corresponds\nto a Young diagram fitting in the shape (n \u2212 1, n \u2212 2, . . . , 1).) This condition will be useful for\nSchr\u00f6der permutations as well.\nTheorem 3.1 Let \u03c0 \u2208 Sn (1243, 2143) be a Schr\u00f6der permutation. Then \u03c0 avoids 12 * * * k for\nany k \u2265 1 if and only if \u03c6(\u03c0) avoids 12 * * * k.\nProof. We may assume that the essential set E(\u03c0) contains at least one element, say (i, j),\nof rank 1; otherwise the assertion is trivial. The proof of 2.6 implies that the set E \u2032 (\u03c0) :=\nE(\u03c0) \u222a {(i \u2212 1, j \u2212 1)} \\ {(i, j)} is the essential set of a Schr\u00f6der permutation again. The rank of\n(i \u2212 1, j \u2212 1) is defined as 0. (Successive determining yields the set E \u2217 (\u03c0) stated in Proposition\n2.6.) Now we consider which consequences for the corresponding permutation result from this\ntransformation.\nLet \u03c3 \u2208 Sn (1243, 2143) such that E(\u03c3) = E \u2032 (\u03c0). Then \u03c3 differs from \u03c0 at exactly three positions.\nLet \u03c0i1 be the element represented by the only dot in the northwest of (i, j). Furthermore let\n\u03c0i2 = j. Then we have \u03c3i = \u03c0i1 , \u03c3i2 = \u03c0i , \u03c3i1 = \u03c0i2 , and \u03c3k = \u03c0k for all k, different from\ni, i1 , i2 . The proof for this fact, we find in the retrieval procedure given in Section 2. (For a\nbetter understanding it is helpful to consider simultaneously the example following the proof.)\n1) The element \u03c0i1 is a left-to-right minimum of \u03c0. All the squares due north or due west\nof the dot (i1 , \u03c0i1 ) are diagram squares of rank 0. Let i\u2032 be the smallest integer greater\nthan i1 such that a corner of rank 0 appears in row i\u2032 . (If such a corner does not exist,\nset i\u2032 = \u221e.) By Lemma 2.2b, we have i \u2264 i\u2032 . In the array representing \u03c3, the square\n(i \u2212 1, j \u2212 1) forms a corner of the 0-component, and the next one appears in row i\u2032 . Thus\nthe dot representing \u03c3i is contained in column \u03c0i1 .\n2) By the transformation, all squares (i\u2032\u2032 , j \u2032\u2032 ) for which i1 < i\u2032\u2032 \u2264 i and \u03c0i1 < j \u2032\u2032 \u2264 j are\nmoved northwestwards. Let j \u2032 be the column index of the corner of rank 0 which appears\nin row i1 \u2212 1. (Note that for i1 > 1 such a one has to exist since \u03c0i1 is a left-to-right\nminimum. For i1 = 1 set j \u2032 = \u221e.) By Lemma 2.2b again, we have j \u2264 j \u2032 . Hence in the\narray of \u03c3 the square (i1 , j) is dotted.\n3) Now all dots (i\u2032 , \u03c3i\u2032 ) with i\u2032 \u2264 i are fixed. It follows from the construction that these dots\nare just (i\u2032 , \u03c0i\u2032 ) if i\u2032 6= i1 , i. Since all diagram squares south of row i appear at the same\nposition in D(\u03c3), the only possible position for the missing dot in row i2 is (i2 , \u03c0i ). For\nall other indices k we have \u03c3k = \u03c0k . (Note that \u03c0i > \u03c0i1 and \u03c0i > \u03c0i2 .)\n\n10\n\n\fConsequently, if \u03c0 contains any increasing subsequence of length k, the permutation \u03c3 contains\nsuch a sequence as well, and vice versa: by definition and step 2), the elements \u03c0i1 and \u03c3i1 are\nleft-to-right minima of \u03c0 and \u03c3, respectively. If these elements occur in an increasing subsequence\nthen as the first term. Obviously, all the elements \u03c0i1 +1 , . . . , \u03c0i\u22121 are greater than \u03c0i2 (= \u03c3i1 ).\nFurthermore we have \u03c0k < \u03c0i2 for k = i+1, . . . , i2 \u22121. (Note that there exists no diagram square\nin the southeast area of (i, j).) Thus, and since \u03c0i1 < \u03c0i2 < \u03c0i each increasing subsequence in\n\u03c0i1 \u03c0i1 +1 * * * \u03c0i2 corresponds to an increasing subsequence of the same length in \u03c3i1 \u03c3i1 +1 * * * \u03c3i2 .\nUsing the arguments successively (until the permutation \u03c6(\u03c0) is obtained) proves the assertion\nof the theorem.\n\n\u2737\n\nExample 3.2 For \u03c0 = 5 9 8 10 4 2 6 7 3 1 \u2208 S10 (1243, 2143) we obtain the essential set E(\u03c0) =\n{(9, 1), (8, 3), (5, 3), (4, 4), (4, 7), (2, 8)} where (4, 7) is of rank 1. Replacing this element yields\nthe essential set of \u03c3 = 7 9 8 5 4 2 6 10 3 1 \u2208 S10 (1243, 2143):\ns\n\ns\n1\n\n1\n0\n\n1\n\n0\n\n0\n\ns\n\n\u2212\u2192\n\n0\n\n1\n\ns\n\n0\n\n1\n\ns\n\n0\n\ns\n\n0\n\nFigure 5 On the left the diagram of \u03c0; on the right the diagram of \u03c3. Only the given dots\nchange their position.\n\nThe pattern considered now is closely related to the increasing subsequences. In special case of\n132-avoiding permutations the following characterization is identical with [9, Theo. 4.1c].\nTheorem 3.3 Let \u03c0 \u2208 Sn (1243, 2143) be a Schr\u00f6der permutation. Then \u03c0 avoids 213 * * * k if\nand only if every element (i, j) \u2208 E(\u03c0) satisfies i + j \u2265 n + 3 \u2212 k + \u03c1(i, j).\nProof. Let (i, j) \u2208 E(\u03c0). The n dots representing \u03c0 are arranged as follows (the labels are the\nnumbers of dots contained in the certain regions where r := \u03c1(i, j)):\nr\n\ni\u2212r\n\nr\nj\u2212r\n\n0\n\n\u2737\n\nor\nj\n\n0\n\ni\n\nr\n0\n\nIf there is no corner (i, j \u2032 ) such that j < j \u2032 (see the left-hand picture) then for all elements \u03c0k\nwith k > i and \u03c0k > j we have \u03c0k > \u03c0i . Clearly, \u03c0i+1 < \u03c0i . On the other hand, if there exists\nsuch a corner (i, j \u2032 ) (see the right-hand picture; necessarily, \u03c1(i, j) = 0 and \u03c1(i, j \u2032 ) = 1) then the\n11\n\n\fdot northwest of (i, j \u2032 ) is contained in column j + 1, otherwise Lemma 2.2b fails to hold. (Note\nthat this dot marks an inner corner of the 0-component.) In this case, all elements \u03c0k with\nk > i and \u03c0k > j satisfy \u03c0k > j + 1. Clearly, \u03c0i+1 \u2264 j. In both cases the elements representing\nby dots in the lower right-hand region appear in increasing order since \u03c0 is 2143-avoiding. If\ni + j < n + 3 \u2212 k + \u03c1(i, j) then their number n \u2212 (i + j) + \u03c1(i, j) is at least k \u2212 2.\nTo prove the converse, suppose that every element of the essential set satisfies the above condition. Then we have \u03c0i + i > n + 3 \u2212 k for all i \u2208 D(\u03c0). Hence for each descent i of \u03c0 there exist\nat most k \u2212 3 elements \u03c0j with j > i and \u03c0j > \u03c0i . Since \u03c0 is 2143-avoiding these elements form\nan increasing sequence. Thus there is no pattern 2134 * * * k in \u03c0.\n\n\u2737\n\nNow we are in the position to answer the first of a collection of open problems given in\n[3]. Theorem 6.5 of this reference implies the Wilf-equivalence of {1243, 2143, 12 * * * k} and\n{1243, 2143, 213 * * * k}, that is, |Sn (1243, 2143, 12 * * * k)| = |Sn (1243, 2143, 213 * * * k)| for all n and\nk. The authors asked for a combinatorial proof of this fact. There is a simple bijection in terms of\ndiagrams whose essence was already used to prove the analogue for 132-avoiding permutations.\nCorollary 3.4 There is a bijection \u03c9 : Sn (1243, 2143) \u2192 Sn (1243, 2143) such that for all k \u2265 1\nand any permutation \u03c0 \u2208 Sn (1243, 2143), we have that \u03c0 avoids 12 * * * k if and only if \u03c9(\u03c0)\navoids 213 * * * k.\nProof. Let \u03c0 \u2208 Sn (1243, 2143) be a Schr\u00f6der permutation which avoids 12 * * * k. By Theorem\n3.1 and [9, Theo. 4.1b], the diagram of \u03c6(\u03c0) \u2208 Sn (132) contains (n + 1 \u2212 k, n \u2212 k, . . . , 1). Since\nall the corners of (n + 1 \u2212 k, n \u2212 k, . . . , 1) are in the diagonal i + j = n + 2 \u2212 k we have i + j \u2265\nn + 2 \u2212 k + 2\u03c1(i, j) for all (i, j) \u2208 E(\u03c0). Hence the diagram corners of rank 1 satisfy the condition\nof Theorem 3.3 anyway. Thus every diagram corresponding to a 12 * * * k-avoiding Schr\u00f6der\npermutation is uniquely determined by its corners outside the shape (n + 1 \u2212 k, n \u2212 k, . . . , 1),\nthat is, by all corners except for those satisfying i + j = n + 2 \u2212 k. Consequently, the diagram\nof \u03c9(\u03c0) we define to be this one whose corners are the corners of D(\u03c0) which are not contained\nin (n + 1 \u2212 k, n \u2212 k, . . . , 1). Ranks are kept up.\nConversely, given any Schr\u00f6der permutation \u03c3 \u2208 Sn (1243, 2143) whose all diagram corners satisfy\ni + j \u2265 n + 3 \u2212 k + \u03c1(i, j) we construct the permutation \u03c9 \u22121 (\u03c3) as follows: let E be the corner\nset of the diagram obtained as union of D(\u03c6(\u03c3)) and (n + 1 \u2212 k, n \u2212 k, . . . , 1). (Note that this is\na Young diagram since D(\u03c6(\u03c0)) is such a one.) Then we form the essential set of \u03c9 \u22121 (\u03c3) from\nthe pairs (i, j) \u2208 E for which (i + 1, j + 1) \u2208\n/ E1 (\u03c3), and all elements of E1 (\u03c3). The first ones\nare defined to be of rank 0, the rank of the latter should be 1. Obviously, the resulting set is an\nessential set of a 12 * * * k-avoiding Schr\u00f6der permutation.\n12\n\n\u2737\n\n\fExample 3.5 The maximum length of an increasing subsequence in the Schr\u00f6der permutation\n\u03c0 = 4 6 3 1 5 7 2 \u2208 S7 (1243, 2143) equals 3. Taking k = 4, we obtain \u03c9(\u03c0) = 1 6 3 4 5 7 2:\n0\n0\n\n1\n\n1\n\n\u2190\u2192\n\n1\n\n1\n\nFigure 6 Construction of \u03c9(\u03c0): the corners crossed out satisfy i + j = n + 2 \u2212 k.\n\nRemarks 3.6\na) Since E1 (\u03c0) = E1 (\u03c9(\u03c0)) for all \u03c0 \u2208 S(1243, 2143, 12 * * * k) the map \u03c9 takes any 132-avoiding permutation to a permutation which avoids 132 as well. Indeed, the restriction of\n\u03c9 on S(132, 12 * * * k) is precisely the bijection given in [9, Cor. 4.4] that proves the Wilfequivalence of {132, 12 * * * k} and {132, 213 * * * k}.\nb) It is clear from the construction that a 12 * * * k-avoiding Schr\u00f6der permutation also avoids\n213 * * * k if and only if it is a fixed point of \u03c9. The essential set of such a permutation\ncan be constructed as follows: consider the corner set of a Young diagram which contains\n(n + 1 \u2212 k, n \u2212 k, . . . , 1), and fits in (n \u2212 1, n \u2212 2, . . . , 1). Now replace at least all elements\n(i, j) by (i + 1, j + 1) for which i + j = n + 2 \u2212 k. Some further corners can be replaced if\nthese satisfy i + j < n. The rank of all new corners is set as 1; let the others be of rank 0.\nWe will discuss the enumerative consequence only for k = 3.\nCorollary 3.7 |Sn (1243, 2143, 123, 213)| = 2n\u22121 for all n \u2265 1.\nProof. Taking up again the idea of the previous remark, the diagram of a Schr\u00f6der permutation\n\u03c0 \u2208 Sn (1243, 2143) which avoids both 123 as 213 arises from a Young diagram that contains\n(n \u2212 2, n \u2212 3, . . . , 1), and fits in (n \u2212 1, n \u2212 2, . . . , 1). Clearly, each such Young diagram is uniquely\ndetermined by its corners in the diagonal i + j = n. In particular, there are 2n\u22121 diagrams of\nthis kind. (This implies |Sn (132, 123)| = 2n\u22121 ; see [10, Prop. 7] for another proof.)\nFrom the corner set of each Young diagram the essential set of only one permutation \u03c0 \u2208\nSn (1243, 2143, 123, 213) can be generated because all the corners (i, n \u2212 1 \u2212 i) must be replaced,\nbut all the corners (i, n \u2212 i) must not be replaced.\n\n\u2737\n\nRemark 3.8 To obtain a {132, 123, 213}-avoiding permutation in the way described in the\nproof, the Young diagram must not have any corner in the diagonal i + j = n \u2212 1. We can\nidentify such a diagram by a binary sequence of length n \u2212 1 whose ith element is defined as 1\n13\n\n\f(or 0) if (i, n \u2212 i) is a corner (or not). The condition that there is no diagram corner outside\nthe diagonal i + j = n means that the corresponding sequence contains no consecutive zeros.\nThe number of such sequences is known to be equal the (n + 1)st Fibonacci number Fn+1 . (The\nFibonacci numbers are defined by F1 = F2 = 1 and Fn = Fn\u22121 + Fn\u22122 for n \u2265 3.) The result\n|Sn (132, 123, 213)| = Fn+1 already appears in [10, Prop. 15].\nThe next result deals with the occurrence of a decreasing subsequence of length k in Schr\u00f6der\npermutations. The analogue for 132-avoiding permutations is simple: a permutation \u03c0 \u2208 Sn (132)\navoids k(k \u2212 1) * * * 1 if and only if |E(\u03c0)| \u2264 k \u2212 2, see [9, Theo. 4.1a]. Now the condition is some\nmore difficult.\nTo state it, we first set some notation. For a permutation \u03c0 \u2208 Sn we denote by r(\u03c0) and c(\u03c0)\nthe number of rows and columns, respectively, that contain a diagram corner. As mentioned\nabove, we have r(\u03c0) = des(\u03c0), and c(\u03c0) = des(\u03c0 \u22121 ). (Note that the transpose of D(\u03c0) is just\nthe diagram of \u03c0 \u22121 .) It follows from Proposition 2.4 that any diagram row (column) contains\nat most two corners (necessarily of different rank) if \u03c0 \u2208 Sn (1243, 2143). Let r2 (\u03c0) and c2 (\u03c0) be\nthe number of diagram rows and diagram columns, respectively, containing two corners.\nTheorem 3.9 Let \u03c0 \u2208 Sn (1243, 2143) be a Schr\u00f6der permutation. Then \u03c0 avoids k(k \u2212 1) * * * 1\nif and only if one of the following conditions holds:\n(i) r(\u03c0) \u2264 k \u2212 2 or c(\u03c0) \u2264 k \u2212 2;\n(ii) r(\u03c0) = k \u2212 1, r2 (\u03c0) = c2 (\u03c0) = 1, and there is no element (i, j) \u2208 E(\u03c0) that such both row\ni and column j contain another corner.\nProof. Suppose that \u03c0 contains a decreasing subsequence of length k. Obviously, its inverse\ncontains such a sequence as well. Consequently, both \u03c0 and \u03c0 \u22121 must have at least k \u2212 1\ndescents, that is, r(\u03c0) \u2265 k \u2212 1 and c(\u03c0) \u2265 k \u2212 1. Now let r(\u03c0) = k \u2212 1 and r2 (\u03c0) = c2 (\u03c0) = 1.\n(Then we also have c(\u03c0) = k \u2212 1.)\nIf the essential corners are arrange as in the picture opposite (where i2 6= i3 ) we\n0\n\nr\n\ni1\n\nr\n1\n\nr\n0\n\n1\n\nhave \u03c0i1 > \u03c0i1 +1 , \u03c0i2 > \u03c0i2 +1 (corners correspond to descents) but \u03c0i1 < \u03c0i2 ,\n\nr i2\ni3\n\nand \u03c0i1 +1 < \u03c0i2 +1 . The last relation follows from the fact that (i2 , \u03c0i2 + 1) is\na diagram square by the construction. If its rank would be equal to 0 then\n\nr2 > 1. Since des(\u03c0) = k\u22121 there is no decreasing subsequence of length k in \u03c0 which contradicts\nthe assumption. In the second case (corners (i1 , j2 ), (i2 , j1 ) of rank 0, corners (i1 , j3 ), (i3 , j1 ) of\nrank 1 where i1 < i2 < i3 and j1 < j2 < j3 ) use the same arguments.\nOn the other hand, if condition (i) holds then des(\u03c0) \u2264 k \u2212 2 or des(\u03c0 \u22121 ) \u2264 k \u2212 2 and hence\n\n14\n\n\f\u03c0 \u2208 Sn (k * * * 1). If (ii) is satisfied then (as shown in the first part of the proof) \u03c0 cannot contain\nany decreasing subsequence of length k.\n\n\u2737\n\nHere we will enumerate the permutations described in Theorem 3.9 only for k = 3. To satisfy\ncondition (ii) is impossible in this case. Thus a Schr\u00f6der permutation is 321-avoiding if and only if\nall its diagram corners are either in the same row or in the same column. This characterization\nwas already given in [4, Prop. 5.4] for 321-avoiding vexillary permutations. (Note that the\nessential set of a vexillary permutation can contain elements of rank greater than 1; for example,\n1243 is such a permutation.)\nEgge and Mansour have shown (derived from the generating function in [3, Prop. 7.4]) that\n\u0012\n\u0013 \u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\nn\u22121\nn\u22121\nn\u22121\nn\u22121\n|Sn (1243, 2143, 321)| =\n+\n+2\n+2\nfor all n \u2265 1.\n0\n1\n2\n3\nTheir fourth problem asked for a combinatorial proof. Here it is.\nCorollary 3.10 |Sn (1243, 2143, 321)| = n + 2\n\nn\u0001\n3\n\nfor all n \u2265 1.\n\nProof. Let \u03c0 be a Schr\u00f6der permutation avoiding 321. We distinguish the three cases mentioned\nat the begin of the section.\nIf \u03c0 \u2208 Sn (132), different from the identity, then its diagram is a rectangle whose lower right-hand\ncorner (i, j) satisfies i + j \u2264 n. There are\nn\u22121\nX\n\n(n \u2212 i) =\n\ni=1\n\n\u0012 \u0013\nn\n2\n\nsuch diagrams. (The enumeration of {132, 321}-avoiding permutations was first done in [10,\nProp. 11].) If there exists no element of rank 0 in E(\u03c0), the permutation \u03c02 \u2212 1 * * * \u03c0n \u2212 1\nbelongs to Sn\u22121 (132, 321).\nIt remains to consider the case that D(\u03c0) has corners of rank 0 and 1. Since these squares are\nin the same row or column there is exactly one corner of each rank. Without loss of generality,\nwe may assume that the both elements of E(\u03c0) are in the same row. (For the result in terms\nof columns consider the transpose that corresponds to the inverse of \u03c0.) Let (i, j) \u2208 E0 (\u03c0) and\n(i, j \u2032 ) \u2208 E1 (\u03c0). From Proposition 2.4 the conditions 1 < i, j + 1 < j \u2032 , and i + j \u2032 \u2264 n + 1 results.\nGiven the pair (i, j), the integer j \u2032 can be chosen in n \u2212 i \u2212 j ways where i \u2208 {2, . . . , n \u2212 2}, and\nj \u2208 {1, . . . , n \u2212 1 \u2212 i}. Clearly,\nn\u22122\nX n\u22121\u2212i\nX\ni=2\n\nj=1\n\nn\u22123\n\n1X\ni(i + 1) =\n(n \u2212 i \u2212 j) =\n2\ni=1\n\n15\n\n\u0012\n\n\u0013\nn\u22121\n.\n3\n\n\fSummarized, we obtain |Sn (1243, 2143, 321)| = 1 +\n\n\u0001\nn\u0001\nn\u22121\u0001\n+ 2 n\u22121\n2 +\n2\n3 .\n\n(Note that the term 1\n\nstands for the identity; the factor 2 regards rows and columns in the third case.)\n\n\u2737\n\nThe last pattern we will discuss is a special case of an important class as well. In [9, Theo.\n4.5], we characterized 132-avoiding permutations which avoid the additional pattern s(s +\n1) * * * k12 * * * (s \u2212 1) where s \u2208 {2, . . . , k}, and k \u2265 3. The condition given there was of technical\nnature but for s = 2 and k = 3 it is equivalent to the following simple one: a permutation\n\u03c0 \u2208 Sn (132) avoids 231 if and only if all its diagram rows are of distinct length, that means, all\ndiagram rows contain a corner. Analogously to that, 231-avoiding Schr\u00f6der permutations can\nbe described.\nProposition 3.11 A Schr\u00f6der permutation \u03c0 \u2208 Sn (1243, 2143) avoids 231 if and only if\n(i) every diagram row contains a (namely, exactly one) element of the essential set,\n(ii) and every diagram column contains at most an element of the essential set.\nProof. Suppose that \u03c0 \u2208 Sn (1243, 2143) contains a 231-pattern: let i1 < i2 < i3 such that\n\u03c0i3 < \u03c0i1 < \u03c0i2 . Since diagram corners and permutation descents corresponds to each other,\nthere is an integer i with i1 \u2264 i < i2 such that row i contains no corner. We assume that this\nrow does not belong to the diagram, otherwise condition (i) fails to hold. Since (i2 , \u03c0i3 ) \u2208 D(\u03c0)\nwe have \u03c0i = 1, and all diagram squares appearing below the ith row are of rank 1. By the\nconstruction, (i + 1, 2) is the upper left-hand corner of the component which contains (i2 , \u03c0i3 )\n(and all the other diagram squares of rank 1). By Lemma 2.2b there is no corner in the strict\nnorthwest of another one. Therefore, and since \u03c0i1 < \u03c0i2 , the diagram corners containing in row\ni \u2212 1 and i + 1, respectively, have to be in the same column.\nFor the other direction, we suppose that there are a diagram square (i1 , j) for which (i1 , j + 1) \u2208\n/\nD(\u03c0), and a square (i2 , j) \u2208 E(\u03c0) with i1 < i2 . (Then one of the conditions (i) and (ii) is not\nsatisfied.) It is easy to see that \u03c0i1 \u03c0i2 \u03c0i3 where \u03c0i3 = j is a subsequence of type 231.\n\n\u2737\n\nFrom the first part of the proof, it is clear how the diagram of a 231-avoiding Schr\u00f6der permutation has to look.\nCorollary 3.12 The diagram of a Schr\u00f6der permutation satisfies the conditions of Proposition\n3.11 if and only if it is of the following shape:\nE0\n\ns\nE1\n\n*\n\n16\n\n\fwhere the diagram components E0 and E1 are Young diagrams whose row lengths are each\ndistinct. (It may be that E0 and/or E1 are empty.)\nAs an immediate consequence we can characterize 231-avoiding Schr\u00f6der permutations from\ntheir descent set.\nCorollary 3.13 Let \u03c0 \u2208 Sn be a permutation, and D(\u03c0) the set of its descents. Then \u03c0 avoids\nthe patterns 1243, 2143, and 231 if and only if one of the following conditions is satisfied:\n(i) s > d and D(\u03c0) = {1, 2, . . . , d};\n(ii) s \u2264 d and D(\u03c0) = {1, 2, . . . , s \u2212 1, s + 1, s + 2, . . . , d + 1}, and \u03c0s\u22121 > \u03c0s+1 if 1 < s < n\nwhere \u03c0s = 1 and d = des(\u03c0).\nRemark 3.14 We can decide by the conditions whether a 231-avoiding Schr\u00f6der permutation\navoids the pattern 132 in addition or not. The first condition describes all permutations in\nSn (132, 231).\nCorollary 3.12 yields the answer to the third question of the Egge-Mansour list.\nCorollary 3.15 For n \u2265 2 we have |Sn (1243, 2143, 231)| = (n + 2)2n\u22123 .\nProof. Let \u03c0 \u2208 Sn (1243, 2143, 231). Consider the partition \u03bb(\u03c0) whose parts are just the lengths\nof the diagram rows where the length of the first row containing squares of rank 1 is listed\ntwice. (By this information D(\u03c0) and hence \u03c0 is completely described.) Adding some zeros (if\nnecessary), we may assume that \u03bb = (\u03bb1 , . . . , \u03bbn\u22121 ) is of length n\u22121. By the previous discussion,\nwe have\nn > \u03bb1 > \u03bb2 > . . . > \u03bbi\u22121 \u2265 \u03bbi > \u03bbi+1 > . . . > \u03bbl > \u03bbl+1 = \u03bbl+2 = . . . = \u03bbn\u22121 = 0\nwith l \u2208 {0, . . . , n \u2212 1}, and \u03bb \u2286 (n \u2212 1, n \u2212 1, n \u2212 2, . . . , 2) (where \u2286 means the containment of\nthe corresponding diagrams). Furthermore we have \u03bbj 6= 1 for all j if any positive part exists\ntwice.\nTo set \u03bb such that all the positive parts of \u03bb are distinct, there are\n\nPn\u22121\nl=0\n\n(This case corresponds to 132-avoiding permutations; hence |Sn (132, 231)|\n\nn\u22121\u0001\n= 2n\u22121 ways.\nl\n= 2n\u22121 , see also [10,\n\nProp. 9].) If there exists a positive part twice then the number of partitions be considered\nequals\nn\u22122\nX\u0012\nl=1\n\n\u0013\u0012 \u0013\nn\u22123\nX \u0012n \u2212 3\u0013\nn\u22122\nl\n= (n \u2212 2)\n= (n \u2212 2)2n\u22123 .\nl\n1\nl\nl=0\n\n17\n\n\fNote that 1 must not a part of \u03bb now. Consequently, there are 2n\u22121 + (n \u2212 2)2n\u22123 = (n + 2)2n\u22123\nSchr\u00f6der permutations in Sn which avoid 231.\n\n\u2737\n\n4 A correspondence to lattice paths\nIt is well known that the nth Schr\u00f6der number rn counts the number of all lattice paths from the\norigin to (n, n), with steps [1, 0] (called East steps), [0, 1] (called North steps), and [1, 1] (called\nDiagonal steps), that never pass below the line y = x. Such paths we call Schr\u00f6der paths. (See\n[11, Exc. 6.39] for further combinatorial interpretations of the Schr\u00f6der numbers.)\nEgge and Mansour have given a bijection \u03a8EM between these paths and Schr\u00f6der permutations\nin Sn+1 , see [3, Sect. 4]. Its essential property is: the number of subsequences 12 * * * k occuring\nin \u03c0 \u2208 Sn+1 (1243, 2143) can read off (more or less) directly from the path \u03a8EM (\u03c0).\nThis bijection can be unterstood as analogue of Krattenthaler's correspondence \u03a8K between\n132-avoiding permutations in Sn and lattice paths from (0, 0) to (n, n) without diagonal steps,\nnever passing below the line y = x. The map \u03a8K encodes the number of increasing subsequences\nof prescribed length in the same way, see [6, (3.2)].\nWe pointed out in [9] that the path \u03a8K (\u03c0) and the diagram of a 132-avoiding permutation \u03c0\nare closely related to each other. Considering the diagram of \u03c0 \u2208 Sn (132) as being contained in\nan n \u00d7 n-rectangle, \u03a8K (\u03c0) is the lattice path which goes from the upper right-hand to the lower\nleft-hand corners of the rectangle, and travels along the diagram boundary.\nFor \u03c0 = 6 4 5 3 2 7 1 \u2208 S7 (132), for example, \u03a8K (\u03c0) equals the lattice path printed in bold:\n\nFigure 7 Lattice path \u03a8K (6453271).\n\nWe can construct the path \u03a8EM just as simple from the permutation diagram.\nNote again that each (Schr\u00f6der) permutation is uniquely determined by its ranked essential\nset. Consequently, position and rank of the diagram corners are all that we have to transfer\nto a path corresponding to the permutation. Since a permutation \u03c0 \u2208 Sn+1 (1243, 2143) should\ncorrespond to a Schr\u00f6der path from (0, 0) to (n, n), we cannot use D(\u03c0) itself but the diagram\nof \u03c6(\u03c0) is fitting. Recall that the diagram of \u03c6(\u03c0) is obtained from that one of \u03c0 by \"moving\"\neach diagram square of rank 1 northwestwards. Hence it is a Young diagram which is contained\n18\n\n\fin (n \u2212 1, n \u2212 2, . . . , 1). Labeling all corners with their original rank we have all information\nneeded to recover \u03c0.\nNow the Schr\u00f6der path corresponding to \u03c0 is constructed as follows: let D(\u03c6(\u03c0)) be embeded\nin an (n \u2212 1) \u00d7 (n \u2212 1)-rectangle. Analogously to the construction of \u03a8K , the lattice path is\ndefined to go from the upper right-hand to the lower left-hand corners of the rectangle, along\nthe diagram boundary, where every step sequence NE representing a corner labeled with 0 is\nreplaced by a step D. Last we convert the path into the form used in [3]. To this end, the\nrectangle is reflected such that the origin is placed at the bottom left instead at the top right.\nExample 4.1 Let \u03c0 = 4 7 5 2 6 3 1 \u2208 S7 (1243, 2143). Using the diagram of \u03c6(\u03c0) we can\nimmediately determine the Schr\u00f6der path corresponding to \u03c0 (printed in bold again):\n(0, 0)\n1\n0\n\n(6, 6)\n\n1\n\n\u2212\u2192\n\n\u2212\u2192\n\n1\n\n1\n0\n(6, 6)\n\n(0, 0)\n\nFigure 8 Construction of the path \u03a8EM (\u03c0): On the left the diagram of \u03c0; in the centre the\ndiagram of \u03c6(\u03c0) with plotted path; on the right the converted path.\n\nBy Lemma 2.2a, each element (i, j) \u2208 E1 (\u03c0) satisfies i + j \u2264 n + 1. Thus, for every corner (i\u2032 , j \u2032 )\nof D(\u03c6(\u03c0)) labeled with 1 we have i\u2032 + j \u2032 \u2264 n \u2212 1. Therefore, and since D(\u03c6(\u03c0)) is contained in\n(n \u2212 1, n \u2212 2, . . . , 1), this construction indeed yields a Schr\u00f6der path.\nIt is not difficult to see that the path obtained in this way is just \u03a8EM (\u03c0) for \u03c0 \u2208 Sn (1243, 2143)\nbut the construction via diagram requires less effort.\nIn [3], the path statistic \u03c4k corresponding to the number of subsequences of type 12 * * * k in\n\u03c0 \u2208 Sn (1243, 2143) is defined for k \u2265 2 by\nX \u0012 h(s) \u0013\nk\u22121\ns\u2208{E,D}\n\nwhere h(s) denotes the height of the starting point of step s. (The height of a point (x, y) in the\nplane we define to be the difference y \u2212 x.)\nExample 4.2 Consider the Schr\u00f6der path NENNEDENED appearing in the previous example.\nFor each east and diagonal step the height is given in the picture.\n1 0\n\nq q\n\n1\n\nq\n\n2 1\n\nq q\n\n1\n\nq\n\nFigure 9 Schr\u00f6der path with step heights.\n\n19\n\n\fThus there occur six subsequences of type 12 (noninversions), one of type 123, and no one of\ntype 12 * * * k for k \u2265 4 in the corresponding permutation \u03c0 = 4 7 5 2 6 3 1 \u2208 S7 (1243, 2143)\nRemarks 4.3\na) In particular, a permutation \u03c0 \u2208 Sn (1243, 2143) avoids 12 * * * k if and only if the path\n\u03a8EM (\u03c0) has no step of height at least k \u2212 1. This result is equivalent to Theorem 3.1.\nb) Combining \u03a8EM : Sn (1243, 2143) \u2192 Sn\u22121 with the bijection \u03c9 stated in Corollary 3.4\nyields the answer to the first part of the first problem raised in [3]. (By Sn\u22121 the set of\nSchr\u00f6der paths from (0, 0) to (n \u2212 1, n \u2212 1) is denoted.) The map \u03c9 \u25e6 \u03a8\u22121\nEM : Sn\u22121 \u2192\nSn (1243, 2143) takes every Schr\u00f6der path whose maximum step height is at most k \u2212 2 to\na 213 * * * k-avoiding Schr\u00f6der permutation, and is bijective, of course.\nc) Obviously, the path \u03a8EM (\u03c0) contains no diagonal step if and only if E0 (\u03c0) = \u2205. As\nalready noted, then \u03c01 = 1 and \u03c0 \u2032 := (\u03c02 \u2212 1)(\u03c03 \u2212 1) * * * (\u03c0n \u2212 1) belongs to Sn\u22121 (132).\nIn particular, we have \u03a8EM (\u03c0) = \u03a8K (\u03c0 \u2032 ) in this case.\n\n5 Perspectives\nAs already observed by Egge and Mansour in [3], the investigation of 132-avoiding permutations\nand {1243, 2143}-avoiding ones, respectively, can be continued in a canonical way. For m \u2265 3\nlet Tm be the set of permutations in Sm for which \u03c0m\u22121 = m and \u03c0m = m \u2212 1. For example,\nT3 = {132} and T4 = {1243, 2143}. (The integer sequences counting the permutations in Sn (Tm )\nwere determined in [1].) Some of what we have done for 132-avoiding permutations in [9], and\nfor T4 -avoiding permutations in this paper can be generalized for an arbitrary integer m.\nTheorem 5.1 A permutation \u03c0 \u2208 Sn avoids each pattern in Tm if and only if every element of\nits essential set is of rank at most m \u2212 3.\nProof. If there exists an element (i, j) \u2208 E(\u03c0) with \u03c1(i, j) \u2265 m \u2212 2 then at least m \u2212 2 dots\nappear northwest of (i, j). Consequently, there are integers i1 < i2 < . . . < im\u22122 < i for which\n\u03c0i1 , . . . , \u03c0im\u22122 < j. Furthermore, we have i < im\u22121 and \u03c0i > j where \u03c0im\u22121 = j. Thus the\nsubsequence \u03c0i1 * * * \u03c0im\u22122 \u03c0i \u03c0im\u22121 forms a pattern belonging to Tm . (For a better understanding\ndraw a picture similar that one in the proof of Theorem 2.1.)\nOn the other hand, it is clear from the diagram construction that the occurrence of a pattern\nof Tm in a permutation yields a diagram corner of rank at least m \u2212 2.\n\n\u2737\n\nIn order to study increasing subsequences in permutations which belong to Sn (Tm ) it would be\nnice to have a surjection Sn (Tm ) \u2192 Sn (Tm\u22121 ) similar the map \u03c6 stated in Section 2. Thus the\n20\n\n\fproblem could successively put down to the case m = 3.\nBy reasoning similar to the proof of Theorem 3.3, one can show that this theorem holds for each\nm \u2265 3 if k = 3. In case k \u2265 4 and m \u2265 5, the condition i + j \u2265 n + 3 \u2212 k + \u03c1(i, j) for all diagram\ncorners (i, j) is only sufficient for avoiding 213 * * * k and all the patterns of Tm .\nFor example, the permutation \u03c0 = 5 4 7 1 3 2 6 \u2208 S7 (T5 ) avoids 2134 but the square (1, 4) is a\ndiagram corner of rank 0.\nConfirmed by computer tests, we believe in the Wilf-equivalence of Tm \u222a {12 * * * k} and Tm \u222a\n{213 * * * k} for all k \u2265 1 and m \u2265 3.\nConjecture 5.2 For m \u2265 3, and all n and k we have\n|Sn (Tm \u222a {12 * * * k})| = |Sn (Tm \u222a {213 * * * k})|.\n\n21\n\n\fReferences\n\n1. E. Barcucci, A. Del Lungo, E. Pergola, and R. Pinzani, Permutations avoiding an increasing number of length-increasing forbidden subsequences, Discrete Math. Theor. Comput.\nSci. 4 (2000), 31-44.\n2. E. Deutsch, Dyck path enumeration, Discrete Math. 204 (1999), 167-202.\n3. E. S. Egge and T. Mansour, Permutations which avoid 1243 and 2143, continued fractions,\nand Chebyshev polynomials, preprint, 2002.\n4. K. Eriksson and S. Linusson, Combinatorics of Fulton's essential set, Duke Math. J. 85\n(1996), 61-80.\n5. W. Fulton, Flags, Schubert polynomials, degeneracy loci, and determinantal formulas,\nDuke Math. J. 65 (1992), 381-420.\n6. C. Krattenthaler, Permutations with restricted patterns and Dyck paths, Adv. Appl.\nMath. 27 (2001), 510-530.\n7. D. Kremer, Permutations with forbidden subsequences and a generalized Schr\u00f6der number,\nDiscrete Math. 218 (2000), 121-130.\n8. I. G. Macdonald, Notes on Schubert Polynomials, LaCIM, Universit\u00e9 du Qu\u00e9bec \u00e0 Montr\u00e9al,\n1991.\n9. A. Reifegerste, On the diagram of 132-avoiding permutations, preprint, 2002.\n10. R. Simion and F. W. Schmidt, Restricted Permutations, Europ. J. Combinatorics 6 (1985),\n383-406.\n11. R. P. Stanley, Enumerative Combinatorics Volume II, Cambridge University Press, 1999.\n\n22\n\n\f"}