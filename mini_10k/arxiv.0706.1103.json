{"id": "http://arxiv.org/abs/0706.1103v1", "guidislink": true, "updated": "2007-06-08T01:18:32Z", "updated_parsed": [2007, 6, 8, 1, 18, 32, 4, 159, 0], "published": "2007-06-08T01:18:32Z", "published_parsed": [2007, 6, 8, 1, 18, 32, 4, 159, 0], "title": "On the threshold for k-regular subgraphs of random graphs", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0706.4443%2C0706.2700%2C0706.3646%2C0706.4388%2C0706.2131%2C0706.2584%2C0706.1615%2C0706.2787%2C0706.2791%2C0706.2910%2C0706.0502%2C0706.2356%2C0706.0265%2C0706.1017%2C0706.0118%2C0706.1432%2C0706.0254%2C0706.2507%2C0706.4146%2C0706.1436%2C0706.3492%2C0706.3367%2C0706.1542%2C0706.2734%2C0706.0237%2C0706.0385%2C0706.2781%2C0706.4210%2C0706.3677%2C0706.4417%2C0706.2442%2C0706.0101%2C0706.1912%2C0706.0190%2C0706.4178%2C0706.2156%2C0706.3557%2C0706.2429%2C0706.1624%2C0706.0743%2C0706.4278%2C0706.2657%2C0706.4240%2C0706.4053%2C0706.3856%2C0706.0748%2C0706.3656%2C0706.3911%2C0706.2253%2C0706.3936%2C0706.1608%2C0706.2499%2C0706.1456%2C0706.3599%2C0706.3246%2C0706.4407%2C0706.2922%2C0706.1008%2C0706.4045%2C0706.1752%2C0706.1384%2C0706.1498%2C0706.0500%2C0706.2025%2C0706.2396%2C0706.0273%2C0706.4204%2C0706.2645%2C0706.2416%2C0706.3335%2C0706.0427%2C0706.3729%2C0706.3990%2C0706.1103%2C0706.1889%2C0706.2832%2C0706.1073%2C0706.2856%2C0706.0216%2C0706.2340%2C0706.0650%2C0706.1055%2C0706.1056%2C0706.3248%2C0706.3189%2C0706.1695%2C0706.2844%2C0706.3482%2C0706.0991%2C0706.2031%2C0706.3640%2C0706.1871%2C0706.0161%2C0706.2581%2C0706.2228%2C0706.0715%2C0706.1032%2C0706.1844%2C0706.2729%2C0706.2237%2C0706.3015&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the threshold for k-regular subgraphs of random graphs"}, "summary": "The $k$-core of a graph is the largest subgraph of minimum degree at least\n$k$. We show that for $k$ sufficiently large, the $(k + 2)$-core of a random\ngraph $\\G(n,p)$ asymptotically almost surely has a spanning $k$-regular\nsubgraph. Thus the threshold for the appearance of a $k$-regular subgraph of a\nrandom graph is at most the threshold for the $(k+2)$-core. In particular, this\npins down the point of appearance of a $k$-regular subgraph in $\\G(n,p)$ to a\nwindow for $p$ of width roughly $2/n$ for large $n$ and moderately large $k$.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0706.4443%2C0706.2700%2C0706.3646%2C0706.4388%2C0706.2131%2C0706.2584%2C0706.1615%2C0706.2787%2C0706.2791%2C0706.2910%2C0706.0502%2C0706.2356%2C0706.0265%2C0706.1017%2C0706.0118%2C0706.1432%2C0706.0254%2C0706.2507%2C0706.4146%2C0706.1436%2C0706.3492%2C0706.3367%2C0706.1542%2C0706.2734%2C0706.0237%2C0706.0385%2C0706.2781%2C0706.4210%2C0706.3677%2C0706.4417%2C0706.2442%2C0706.0101%2C0706.1912%2C0706.0190%2C0706.4178%2C0706.2156%2C0706.3557%2C0706.2429%2C0706.1624%2C0706.0743%2C0706.4278%2C0706.2657%2C0706.4240%2C0706.4053%2C0706.3856%2C0706.0748%2C0706.3656%2C0706.3911%2C0706.2253%2C0706.3936%2C0706.1608%2C0706.2499%2C0706.1456%2C0706.3599%2C0706.3246%2C0706.4407%2C0706.2922%2C0706.1008%2C0706.4045%2C0706.1752%2C0706.1384%2C0706.1498%2C0706.0500%2C0706.2025%2C0706.2396%2C0706.0273%2C0706.4204%2C0706.2645%2C0706.2416%2C0706.3335%2C0706.0427%2C0706.3729%2C0706.3990%2C0706.1103%2C0706.1889%2C0706.2832%2C0706.1073%2C0706.2856%2C0706.0216%2C0706.2340%2C0706.0650%2C0706.1055%2C0706.1056%2C0706.3248%2C0706.3189%2C0706.1695%2C0706.2844%2C0706.3482%2C0706.0991%2C0706.2031%2C0706.3640%2C0706.1871%2C0706.0161%2C0706.2581%2C0706.2228%2C0706.0715%2C0706.1032%2C0706.1844%2C0706.2729%2C0706.2237%2C0706.3015&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The $k$-core of a graph is the largest subgraph of minimum degree at least\n$k$. We show that for $k$ sufficiently large, the $(k + 2)$-core of a random\ngraph $\\G(n,p)$ asymptotically almost surely has a spanning $k$-regular\nsubgraph. Thus the threshold for the appearance of a $k$-regular subgraph of a\nrandom graph is at most the threshold for the $(k+2)$-core. In particular, this\npins down the point of appearance of a $k$-regular subgraph in $\\G(n,p)$ to a\nwindow for $p$ of width roughly $2/n$ for large $n$ and moderately large $k$."}, "authors": ["Pawel Pralat", "Jacques Verstraete", "Nicholas Wormald"], "author_detail": {"name": "Nicholas Wormald"}, "author": "Nicholas Wormald", "links": [{"href": "http://arxiv.org/abs/0706.1103v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0706.1103v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0706.1103v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0706.1103v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0706.1103v1 [math.CO] 8 Jun 2007\n\nOn the threshold for k-regular subgraphs\nof\nrandom graphs.\nPawel Pralat\n\nJacques Verstra\u00ebte\n\nDepartment of Mathematics and Statistics\n\nDepartment of Mathematics and Statistics\n\nDalhousie University\n\nMcGill University\n\nHalifax NS, Canada\n\nMontreal QC, Canada\n\nNicholas Wormald\n\n\u2217\n\nDepartment of Combinatorics and Optimization\nUniversity of Waterloo\nWaterloo ON, Canada\n\nAbstract\nThe k-core of a graph is the largest subgraph of minimum degree at least k. We show\nthat for k sufficiently large, the (k + 2)-core of a random graph G(n, p) asymptotically\nalmost surely has a spanning k-regular subgraph. Thus the threshold for the appearance\nof a k-regular subgraph of a random graph is at most the threshold for the (k + 2)-core.\nIn particular, this pins down the point of appearance of a k-regular subgraph in G(n, p) to\na window for p of width roughly 2/n for large n and moderately large k.\n\n1\n\nIntroduction\n\nIn this paper, we study the appearance of k-regular subgraphs of random graphs. The k-core\nof a graph G is the unique largest subgraph of G of minimum degree at least k (note that the\nk-core may be empty). Evidently, the k-core of a graph can be found be repeatedly deleting\nvertices of degree less than k from the graph. In the case k = 2, this corresponds to the\nappearance of cycles in G(n, p), which is well-researched, and precise results concerning the\ndistribution of cycles may be found in Janson [6] and Flajolet, Knuth and Pittel [5]. By\nanalysing the vertex deletion algorithm for the Erd\u0151s-R\u00e9nyi model G(n, p) of random graphs,\nPittel, Spencer and Wormald [12] proved that for fixed k \u2265 3, there exists a constant ck such\nthat ck /n is a sharp threshold for a k-core in G(n, p). (When discussing thresholds of k-cores\nand k-regular subgraphs, we mean thresholds for nonempty k-cores and nonempty k-regular\nsubgraphs.) Here\n\u03bbk\nck =\n,\n(1)\n\u03c0k (\u03bbk )\n\u2217\n\nSupported by the Canada Research Chairs Program and NSERC\n\n1\n\n\fwhere \u03c0k (\u03bb) is defined by\n\u03c0k (\u03bb) =\n\nX e\u2212\u03bb \u03bbj\n,\nj!\n\n(2)\n\nj\u2265k\u22121\n\nand \u03bbk is the positive number minimising the right hand side of (1). Recently, a number of\nsimpler proofs establishing the threshold ck /n for the k-core have been published (see Kim [9],\nCain and Wormald [4], and Janson and Luczak [7]).\nIn what follows, we write a.a.s. to denote an event which occurs with probability tending\nto one as n \u2192 \u221e. In comparison to studying the k-core in random graphs, it appears to be\nsubstantially more difficult to analyse the appearance of k-regular subgraphs when k \u2265 3. One\nreason is that it is NP-hard to determine whether a graph contains such a subgraph, and there\nis no analogue of the simple vertex deletion algorithm which produces the k-core. As every\nk-regular subgraph is contained in the k-core, we deduce that G(n, p) a.a.s. does not contain\na k-regular subgraph whenever p is below the threshold for the k-core described in (1) and\n(2). Bollob\u00e1s, Kim and Verstra\u00ebte [2] showed that G(n, p) a.a.s. contains a k-regular subgraph\nwhen p is, roughly, larger than 4ck /n, and conjectured a sharp threshold for the appearance\nof k-regular subgraphs in G(n, p). In the same paper it was shown that for some c > c3 , the\n3-core of G(n, c/n) has no 3-regular subgraph a.a.s., whereas for c \u2265 c4 , the 4-core of G(n, c/n)\ncontains a 3-regular subgraph a.a.s. In support of the conjecture of a sharp threshold, Pretti\nand Weigt [13] numerically analysed equations arising from the cavity method of statistical\nphysics to conclude empirically that indeed, there is a sharp threshold for the appearance of\na k-regular subgraph of a random graph. For k > 3 they concluded that it is the same as the\nthreshold for the k-core, which is at odds with [2, Conjecture 1.3]. For k = 3, these thresholds\ndiffer, as shown using the first moment method in [2].\nIn this paper, we improve the window of the threshold for k-regular subgraphs in G(n, p)\nby proving Theorem 1 below. A k-factor of a graph is a spanning k-regular subgraph, and a\ngraph is k-factor critical if, whenever we delete a vertex from the graph, we obtain a graph\nwhich has a k-factor.\nTheorem 1. There exists an absolute constant k0 such that for k \u2265 k0 , the (k + 2)-core of a\nrandom graph G(n, p) is nonempty and contains a k-factor or is k-factor-critical a.a.s.\nTheorem 1 will be proved in Section 4. We remark that the first nonempty k-core of the\nrandom graph process a.a.s. contains many vertices of degree k + 1 adjacent to k + 1 vertices\nof degree k, so the k-core cannot contain a k-factor and cannot be k-factor critical a.a.s.\nBollob\u00e1s, Cooper, Fenner and Frieze [1] conjectured that the (k + 1)-core contains \u230ak/2\u230b edge\ndisjoint hamiltonian cycles a.a.s., so Theorem 1 supports this conjecture.\nThe value of ck can be determined approximately for large k as follows. This corrects, and\nsharpens, the error term of the formula given in [12]. All logarithms in this paper are natural,\nand N is the set of positive integers.\n\n2\n\n\fLemma 1. For any k \u2208 N, let qk = log k \u2212 log(2\u03c0). Then\nck = k + (kqk )1/2 +\n\n\u0010 k \u00111/2\nqk\n\n+\n\n\u0010 1 \u0011\nqk \u2212 1\n+O\n3\nlog k\n\nas k \u2192 \u221e.\n\nLemma 1 is proved in Section 5. It follows immediately from this lemma that\n\u0010 1 \u0011\nck+2 = ck + 2 + O\n.\nlog k\nHence, combining the lemma and Theorem 1, we have pinned down the threshold for the\nappearance of k-regular subgraphs in G(n, p) to a window for p of width 2/n + O(1/n log k).\nThe following questions remain: (1) to determine whether there is a sharp threshold for the\nappearance of a k-regular subgraph, and (2) whether the (k + 1)-core of a random graph, when\nit is a.a.s. nonempty, contains a k-factor or is k-factor critical a.a.s.\nThroughout the paper, we denote by G(n, p) the Erd\u0151s-R\u00e9nyi model of random graphs. If\nG is a graph with vertex set V (G), then \u03bb(S, T ) denotes the number of edges of G with one\nendpoint in S and one endpoint in T , where S, T \u2286 V (G). If S = T , we write \u03bb(S) instead.\nThe number of components of a graph G is denoted by \u03c9(G).\n\n2\n\nFactors of Graphs\n\nIn this section, we allow graphs to contain multiple edges. Let G be a graph and let k \u2208 N.\nRecall that a k-factor of G is a spanning subgraph of G all of whose vertices have degree k. A\ngraph is k-factor-critical if the deletion of any vertex of G results in a graph with a k-factor.\nIn particular, a 1-factor of G is a perfect matching of G. Tutte's 1-Factor Theorem gives the\nfollowing necessary and sufficient condition for a graph G to have a 1-factor.\nTheorem 2. Let G be a graph, and let o(G) denote the number of components of G with an\nodd number of vertices. Then G has a 1-factor if and only if\no(G \u2212 X) \u2264 |X|\n\n(3)\n\nfor every set X \u2286 V (G).\nUsing Tutte's 1-Factor Theorem applied to a new graph, \u03c6(G), a necessary and sufficient\ncondition can be found for a graph to have a k-factor (this is a special case of Tutte's f factor theorem; see Lov\u00e1sz and Plummer [10] for details). To construct \u03c6(G), let V (G) =\n{v1 , v2 , . . . , vn }, and let V (\u03c6(G)) = U \u222a V , where U and V are disjoint sets and V is partitioned into independent sets (V1 , V2 , . . . , Vn ) with |Vi | = d(vi ) and U is partitioned into sets\n(U1 , U2 , . . . , Un ) such that |Ui | = k. Then \u03c6(G) consists of all edges between Ui and Vi for\ni \u2208 {1, 2, . . . , n}, together with a matching on V such that when we contract all the independent sets Vi in \u03c6(G) \u2212 U to single vertices, we obtain G. An example is shown below in Figure\n1, where G is a quadrilateral, k = 2, and a 1-factor in \u03c6(G) corresponds to a 2-factor in G.\n\n3\n\n\fFigure 1 : 2-factor in G and corresponding 1-factor in \u03c6(G).\n\nIt is not hard to see that G has a k-factor if and only if \u03c6(G) has a 1-factor. We will show\nthat the following condition on G is enough to guarantee a k-factor in G. It is convenient to\ndefine\n(\n0 if k|V (G)| is even\n\u03b4k (G) =\n1 if k|V (G)| is odd.\nLemma 2. Let k \u2208 N, and let G be a connected graph such that for every pair of disjoint sets\nS, T \u2286 V (G) for which S \u222a T 6= \u2205,\nX\n\u0001\nd(v) + k|S| \u2265 \u03c9 G \u2212 (S \u222a T ) + k|T | + \u03bb(S, T ) + \u03b4k (G) .\n(4)\nv\u2208T\n\nThen G has a k-factor or is k-factor critical according as \u03b4k (G) = 0 or \u03b4k (G) = 1.\nProof. We first consider the case \u03b4k (G) = 0. Let H = \u03c6(G). To show that G has a k-factor,\nit is sufficient to show that for all X \u2286 V (H), o(H \u2212 X) \u2264 |X|, by (3). If X = \u2205, then this\nfollows from the fact that H is connected and\n|V (H)| = k|V (G)| +\n\nn\nX\ni=1\n\nd(vi ) \u2261 k|V (G)| \u2261 0 mod 2.\n\nIn what remains, we verify (3) for X 6= \u2205. Suppose that for some i, 0 < |X \u2229 Ui | < |Ui |. Since\nUi and Vi form a complete bipartite graph, we may delete one of the vertices of Ui from X,\nand the number of components of H \u2212X does not change. Then the right side of (3) decreases,\nand the left side decreases by at most 1. Hence we assume X \u2229 Ui = \u2205 or X \u2229 Ui = Ui for all i.\nDefine the following sets of vertices of G:\nS = {vi \u2208 V (G) : X \u2229 Ui = Ui },\n\nT = {vi \u2208 V (G) : X \u2229 Vi = Vi },\n\nand the following sets of vertices of H:\nY =\n\nn\n[\n\ni=1\n\n{Vi \u2212 X : vi \u2208 S},\n\nX0 =\n\nn\n[\n\ni=1\n\n{X \u2229 Vi : vi 6\u2208 T },\n\n4\n\nX1 =\n\nn\n[\n\ni=1\n\n{Vi : vi \u2208 T }.\n\n\fSuppose that for some i, vi \u2208 S \u2229 T (that is, X \u2229 Ui = Ui and X \u2229 Vi = Vi ). But then we may\ndelete all the vertices of Ui from X, and both the left side and the right side of (3) decreases\nby k. Hence we assume S \u2229 T = \u2205.\nFor convenience, given a subgraph F of \u03c6(G), we write \u03c6\u22121 (F ) for the subgraph of G\nobtained from F by deleting all vertices of U and contracting all the sets Vi \u2229 V (F ). For each\nS\ncomponent F of H \u2212 X containing a vertex of U = i\u2264n Ui , either F is an isolated vertex in\n\u0001\nU , or \u03c6\u22121 (F ) \u2212 S is a component of G \u2212 (S \u222a T ). So at most k|T | + \u03c9 G \u2212 (S \u222a T ) components\nof H \u2212 X contain a vertex of U . Now let F be a component of H \u2212 X containing no vertices\nof U . Then |V (F )| \u2264 2, so the only components of H \u2212 X containing no vertices of U and\ncontributing to o(H \u2212 X) are isolated vertices \u2013 and these are vertices of Y which are adjacent\nto a vertex of X = X0 \u222a X1 . So the number of these isolated vertices is:\n\u03bbH (Y, X0 \u222a X1 ) = \u03bbH (Y, X0 ) + \u03bbH (Y, X1 ) = \u03bbH (Y, X0 ) + \u03bb(S, T ) \u2264 |X0 | + \u03bb(S, T )\nwhere \u03bbH (Y, X) is the number of edges between X and Y in H. It now follows using (4) that\no(H \u2212 X) \u2264 \u03c9(G \u2212 (S \u222a T )) + k|T | + \u03bb(S, T ) + |X0 |\nX\n\u2264\nd(v) + k|S| + |X0 | = |X1 | + k|S| + |X0 | = |X|.\nv\u2208T\n\nSo we have shown |X| \u2265 o(H \u2212 X) for every set X \u2286 V (H), as required. This completes the\nproof for \u03b4k (G) = 0.\nFinally, suppose \u03b4k (G) = 1 and let v \u2208 V (G). We show that G \u2212 {v} has a k-factor. Let\nG\u2032 be the graph obtained by adding a vertex v \u2032 to G and joining v to v \u2032 with k parallel edges.\nThen G\u2032 is connected, and \u03b4k (G\u2032 ) = 0. Furthermore, it is straightforward to check that (4) is\nsatisfied in G\u2032 . By the first part of the proof, G\u2032 has a k-factor. Deleting both v and v \u2032 from\nthis k-factor of G\u2032 , we get a k-factor in G \u2212 {v}, as required.\n\n3\n\nStructure of the k-core\n\nIn this section we describe the structure of the k-core in G(n, p); this material will be used\nthroughout the proof of Theorem 1. We will assume throughout that p = c/n where c > ck ,\nso that the k-core of G(n, p) is a.a.s. nonempty. We let K denote this nonempty k-core.\nIn the first lemma, \u2202X denotes the set of edges of K with exactly one endpoint in a set\nX \u2282 V (K). The lemma seems to be well known, and follows, for example, from Benjamini,\nKozma and Wormald [3, Lemma 5.3]. (That lemma concerns graphs with a given degree\nsequence, all degrees between 3 and n0.02 . See the proof of [3, Theorem 4.2] to find the\nconnection with the following.)\nLemma 3. There is a positive constant \u03b3 such that the following holds. Fix k \u2265 3. Then\na.a.s. every set X \u2282 V (K) of at most 12 |V (K)| vertices satisfies\n|\u2202X| \u2265 \u03b3k|X|.\n5\n\n\fThroughout the rest of the paper, \u03b3 denotes the constant appearing in Lemma 3.\nLemma 4. Let k > 2/\u03b3. Then a.a.s. for every set Y \u2282 V (K) of size at most s(n) =\nlog n/2ec log log n, K \u2212 Y contains a component with more than |V (K)| \u2212 2s(n) vertices.\nProof. We first show that a.a.s. there are no sets of 2y, y \u2264 s(n) vertices in G(n, p) inducing\nat least 2y + 1 edges: the expected number of subgraphs of 2y vertices with at least 2y + 1\nedges, for some y \u2264 s(n), is at most\n\u0001\nX (log n)2y+1\nX \u0012 n \u0013\u0012 2y \u0013\n2\np2y+1 <\n2y + 1\n2y\nn\ny\u2264s(n)\n\ny\u2264s(n)\n\n< n\u22121/2 .\n\nSo the claim follows from Markov's inequality. Thus, we may assume that all sets of 2y \u2264 2s(n)\nvertices in K induce at most 2y edges. We may also assume that a.a.s. the property in Lemma 3\nholds.\nIt suffices to show that if X is the vertex set of a union of components of K \u2212 Y and\n|X| \u2264 12 |V (K)|, then |X| < s(n). Suppose |X| \u2265 s(n). From the property in Lemma 3,\n|\u2202X| \u2265 \u03b3k|X|.\nSuppose |Y | = y. By averaging, some Z \u2282 X of size |Y | \u2264 s(n) satisfies\n\u03bb(Y \u222a Z) \u2265 \u03b3ky > 2y.\nHowever |Y \u222a Z| = 2|Y | = 2y, which is a contradiction.\nIn fact Luczak [11] showed that the k-core is k-connected a.a.s., as stated in the next\nlemma.\nLemma 5. For k \u2265 3 and c > ck , the k-core of G(n, c/n) is k-connected a.a.s.\nOur final lemma is a large deviation result for the degrees of the vertices of the k-core.\nEssentially, the degree of a vertex in K has (asymptotically) a truncated Poisson distribution,\nwhich gives a precise bound on the number of vertices which deviate from degree c in K.\nLemma 6. For all \u03b5 > 0 there exists k\u03b5 such that for k > k\u03b5 and ck < c < 2k, it is a.a.s. true\nthat\np\n|d(v) \u2212 c| \u2265 \u03b5 k log k\nfor at most \u03b5|K| vertices v of K.\n\nProof. Let \u03b5 > 0, and fix k, and j \u2265 k + 2. From [4, Corollary 3 and Erratum], if nj denotes\nthe number of vertices of degree j in K, then a.a.s.\nnj =\n\ne\u2212\u03bc \u03bcj\nn + o(n),\nj!\n6\n\n(5)\n\n\fwhere \u03bc = \u03bck,c is the larger of the two positive solutions of the equation\nX \u03bci\n\u03bc\n= e\u2212\u03bc\n.\nc\ni!\n\n(6)\n\ni\u2265k\u22121\n\n(The fact that there are two such solutions is known to be guaranteed by the fact that c > ck .)\nLet \u03b51 > 0, and suppose that \u03bc = \u0398(k). Then, since the Poisson distribution is asymptotically\nnormal with variance equal to its mean, we have for sufficiently large k\nX\n\ne\u2212\u03bc\n\n\u221a\n\n|i\u2212\u03bc|\u2265\u03b51 k log k\n\n\u03bci\n< \u03b51 .\ni!\n\n(7)\n\n\u221a\nAlso, by Lemma 1, we may assume that c > k + 12 k log k. Suppose that c \u2212 2 is substituted\nfor \u03bc in (6). It is then elementary to obtain that the right hand side of (6) is greater than\n1 \u2212 1/k. Recalling also that c < 2k, this is greater than the left hand side of (6). On the other\nhand, if anthing larger than c is substituted for \u03bc in (6) then the left hand side is greater\nthan the right, since the right is equal to a probability strictly less then 1. So by continuity,\nc \u2212 2 < \u03bck,c < c. Taking \u03b51 slightly smaller than \u03b5, the lemma follows from (7) and (5).\n\n4\n\nProof of Theorem 1\n\nIn this section, we denote by K the (k + 2)-core of G(n, p) where pn = c and ck+2 < c, for\nk \u2265 3. To prove Theorem 1, we show that there exists k0 such that for k \u2265 k0 , (4) holds in\nK a.a.s. The value of k0 will not be optimized in the proof to follow. To prove the theorem,\nwe consider a number of cases according to the sizes of the sets S and T in the lemma, where\nS \u222a T 6= \u2205. It is convenient throughout to let s(n) = log n/2ec log log n.\nCase 1 |S| + |T | < s(n).\nLet Y = S \u222a T . By Lemma 4, K \u2212 Y contains a component with more than |V (K)| \u2212 2s(n)\nvertices a.a.s. Let \u03c9s (K \u2212 Y ) denote the number of components of K \u2212 Y of size less than\ns(n), and let X be the set of vertices in these components. As in the proof of Lemma 4,\n\u03bb(X) \u2264 |X| and \u03bb(X \u222a Y ) \u2264 |X| + |Y | a.a.s. However, every vertex of X has degree at least\nk + 2, by definition of K, so \u03bb(X) + \u03bb(X, Y ) \u2265 (k + 1)|X| a.a.s. since \u03bb(X) \u2264 |X| holds a.a.s.\nIt follows that\n|X| + |Y | \u2265 \u03bb(X \u222a Y ) = \u03bb(X) + \u03bb(X, Y ) + \u03bb(Y )\n\u2265 k|X| + |X| + \u03bb(S, T )\n\n\u2265 k * \u03c9s (K \u2212 Y ) + |X| + \u03bb(S, T ).\n\nTherefore, since \u03c9s (K \u2212 Y ) = \u03c9(K \u2212 Y ) \u2212 1,\n\u0001\nk * \u03c9 K \u2212 (S \u222a T ) \u2212 k + \u03bb(S, T ) + k|T | \u2264 |S| + (k + 2)|T | \u2212 |T | .\n7\n\n\f\u0001\nSince k \u2265 3, and \u03c9 G \u2212 (S \u222a T ) \u2265 1,\n\n\u0001\n\u0001\n\u03c9 K \u2212 (S \u222a T ) + \u03bb(S, T ) + k|T | \u2264 k * \u03c9 K \u2212 (S \u222a T ) \u2212 k + 1 + \u03bb(S, T ) + k|T |\n\u2264 |S| + (k + 2)|T | \u2212 |T |\n\u2264 k|S| +\n\u2264 k|S| +\n\nX\n\nd(v) \u2212 (k \u2212 1)|S| \u2212 |T | + 1\n\nX\n\nd(v) \u2212 2|S| \u2212 |T | + 1 .\n\nv\u2208T\n\nv\u2208T\n\nP\n\nIf S 6= \u2205 or |T | > 1, then this is less than k|S| + v\u2208T d(v), as required. If S = \u2205 and |T | = 1,\nthen \u03c9(K \u2212 T ) = 1 a.a.s. (see Lemma 5), which implies\nX\n\u03c9(K \u2212 T ) + k|T | = 1 + k < 2 + k \u2264\nd(v).\nv\u2208T\n\nTherefore (4) holds a.a.s. in K, so K has a k-factor or is k-factor critical, by Lemma 2.\nFor the rest of the proof, \u03b50 is an absolute constant; we will take \u03b50 = e\u22129 for definiteness.\nCase 2 |S| + |T | \u2265 s(n), |T | < \u03b50 n, and |S| < 4\u03b50 n.\nLet Y = S \u222a T . In this case we estimate \u03c9(K \u2212 Y ) and \u03bb(S, T ) separately. First we show\nthat \u03c9(K \u2212 Y ) \u2264 |Y |/2 a.a.s. provided that k is large enough to ensure that \u03b3(k + 2) \u2265 4 (so\nthis tells us k0 \u2265 4/(\u03b3 \u2212 2) is required in our proof). It suffices to show that if X is the vertex\nset of any union of components of K \u2212 Y , then a.a.s. |X| < |Y |/2 or |X| > n/2. Suppose that\n|Y |/2 \u2264 |X| \u2264 n/2. Then Lemma 3 shows \u03bb(X, Y ) \u2265 \u03b3(k + 2)|X|. Let\nn\ny\nno\nI = {y : s(n) \u2264 y \u2264 5\u03b50 n} and Iy = x : \u2264 x \u2264\n.\n2\n2\n\n8\n\n\fThe expected number of pairs of sets (X, Y ) in G(n, p) satisfying the above requirements is\n\u0013\n\u0010 n \u00113x \u0010 y \u0011\u03b3(k+2)x\nX \u0012 n \u0013\u0012x + y \u0013\u0012\nX\nxy\np\u03b3(k+2)x <\ne3x+\u03b3(k+2)x 2x+y\nx+y\nx\n\u03b3(k + 2)x\nx\nn\nIy \u00d7I\n\nIy \u00d7I\n\n<\n\ne3\u03b3(k+2)x/2 23x\n\nX\n\ne\u2212\u03b3(k+2)x e3x\n\n(since y \u2264 5\u03b50 n)\n\nX\n\ne\u2212x\n\n(since \u03b3(k + 2) \u2265 4)\n\nIy \u00d7I\n\n<\n\nIy \u00d7I\n\n\u2264\n\n\u0010 y 2 \u0011\u03b3(k+2)x/2\n\nX\n\nIy \u00d7I\n\n<\n\nZ\n\n<\n\nZ\n\nxn\n\ne\u2212(x\u22121) dxdy\n\nIy \u00d7I\n\ne\u2212(y\u22122)/2 dy\n\nI\n\n< e\u2212(s(n)\u22122)/2 = o(1) ,\nwhere the sums are over (x, y) \u2208 Iy \u00d7 I. So in fact the expected number of sets X and Y as\ndescribed above is o(1). By Markov's Inequality, we conclude that \u03c9(K \u2212 Y ) \u2264 |Y |/2 a.a.s.\nTo finish verifying inequality (4) in case 2, it remains to show that a.a.s.\n\u0010\n3\n1\u0011\n\u03bb(S, T ) < |T | + k \u2212\n|S|.\n2\n2\n\n(8)\n\nLet |S| = \u03c3n and |T | = \u03c4 n and let \u03c1 = (k \u2212 12 )\u03c3 + 23 \u03c4 (here \u03c3 and \u03c4 are allowed to depend on\nn). Then the number of ways of choosing the sets S and T is bounded above by\n\u0012 \u0013\u0012 \u0013 \u0010 \u0011\nn\nn\n\u03c3 \u2212\u03c3n \u0010 e \u0011\u2212\u03c4 n\n<\n.\n\u03c3n \u03c4 n\ne\n\u03c4\n\nThe probability that there are at least \u03c1n edges between S and T is at most\n\u0012\n\u0013\n\u0013\n\u0012\ne\u03c3\u03c4 c \u03c1n\n\u03c3\u03c4 n2 \u0010 c \u0011\u03c1n\n\u2264\nn\n\u03c1\n\u03c1n\n\u0012\n\u0013(k\u22121/2)\u03c3n+3\u03c4 n/2\nec\n=\n.\n(k \u2212 1/2)/\u03c4 + 3/2\u03c3\n\nMultiplying by the bound on the number of choices of S and T , the bound (8) is true a.a.s. if\n\u0013(k\u22121/2)\u03c3n+3\u03c4 n/2 \u0010 \u0011 \u0010 \u0011\n\u0012\n\u03c3 \u03c3 \u03c4 \u03c4\nec\n<\n(k \u2212 1/2)/\u03c4 + 3/2\u03c3\ne\ne\nfor which it suffices that\n\nn\u0010 \u03c3 \u00111/(k\u22121/2) \u0010 \u03c4 \u00112/3 o\nec\n.\n,\n< min\n(k \u2212 1/2)/\u03c4 + 3/2\u03c3\ne\ne\n9\n\n(9)\n\n\fSince \u03c4 < e\u22129 and c < 2k \u2212 1 for large enough k,\n\u0010 \u03c4 \u00112/3\nec\ne\u03c4 c\n.\n<\n< 2e\u03c4 <\n(k \u2212 1/2)/\u03c4 + 3/2\u03c3\nk \u2212 1/2\ne\nTo prove that the expression on the left in (9) is less than (\u03c3/e)1/(k\u22121/2) , we can assume\n\u0010 \u03c3 \u00111/(k\u22121/2)\ne\n\n<\n\n\u0010\n\ne\u03c4 c \u0011\n< e\u22127 .\nk \u2212 1/2\n\nIt follows that \u03c3 < e\u22124k and therefore, since 2k \u2212 1 \u2265 2,\n\nec\n< e\u03c3c < e\u22122k c\u03c3 1/2 < \u03c3 1/2 \u2264 \u03c3 1/(k\u22121/2) .\n(k \u2212 1/2)/\u03c4 + 3/2\u03c3\n\nCase 3 |S| + |T | \u2265 s(n) and |T | < \u03b50 n and |S| \u2265 4\u03b50 n.\nTo prove that the requirements of Lemma 2 are satisfied a.a.s. for k sufficiently large, it is\nenough to show that a.a.s. for every pair of sets (S, T ) under consideration, \u03bb(S, T ) \u2264 43 k|S|.\n\u0001\nThis is because the sum of vertex degrees in T is at least k|T |, and also \u03c9 G \u2212 (S \u222a T ) \u2264 n <\n1\n4 k|S| for large enough k (as \u03b50 is fixed). We may assume that c \u223c ck , and so if k is sufficiently\nlarge, Lemma 1 shows that c < 32 k. Thus it suffices to show \u03bb(S, T ) \u2264 2c\u03b50 n, since this is at\nmost 21 c|S|. This follows immediately once we show that a.a.s. all sets of at most \u03b50 n vertices\n(in particular, T ) have total degree at most 2c\u03b50 n.\nIt is well known that in the random graph G(n, c/n), the vertex degrees are have asymptotically Poisson distribution with mean c: the number of vertices of degree j is a.a.s. asymptotic\nto e\u2212c cj /j!. It follows that the sum of the degrees of those vertices of degree less than 3c/2 is\na.a.s. asymptotic to\nX e\u2212c cj\nn\nj\n.\nj!\nj<3c/2\n\nSince the Poisson distribution is asymptotically normal with mean c, for large enough c (i.e.\nlarge enough k) we have\nX e\u2212c cj\nj\n> c \u2212 \u03b50 .\nj!\nj<3c/2\n\nSince the sum of vertex degrees is a.a.s. asymptotic to cn, the ones of degree at least 3c/2\na.a.s. have total degree less than \u03b50 n. Assuming this is true, there are at most 2\u03b50 n/3c such\nvertices, and any set of at most \u03b50 n vertices thus has total degree at most\n\u03b50 n +\n\n3c\n\u03b50 n < 2c\u03b50 n\n2\n\nas required.\nCase 4 |T | \u2265 \u03b50 n.\n\n10\n\n\fBy Lemmas 1 and 6, for all \u03b5 > 0, if k is sufficiently large, then a.a.s.\nX\np\n\u0001\nd(v) > k + (1 \u2212 \u03b5) k log k |T |.\nv\u2208T\n\nSo by Lemma 2 and the fact that n = O(|T |), it is enough to show, for some \u03b5 > 0, that a.a.s.\np\n(1 \u2212 \u03b5) k log k |T | + k|S| \u2265 \u03bb(S, T ).\n(10)\n\nWe will prove this by considering the cases |S| < \u03b7n and |S| \u2265 \u03b7n separately, where \u03b7 = 14 \u03b50 .\nFor |S| < \u03b7n, we will use\nX\n\u03bb(S, T ) \u2264\nd(v).\nv\u2208S\n\nFor this, we may assume that if |S| = \u03c3n then S contains the \u03c3n vertices of largest degree\nin G (and that they have the same degrees in K). Using the argument about the degrees of\nG \u2208 G(n, p) as in Case 3, it is straightforward to show that a.a.s. these vertices have total\ndegree at most\np\n\u221a\n\u0001\n\u221a\nc\u03c3n + O( c n) < k + 2 k log k |S| + O( k n)\np\n< k|S| + 3 k log k |S|\nfor k sufficiently large, which is at most\n\np\n(1 \u2212 \u03b5) k log k |T | + k|S|\n\nsince |S| < \u03b7n \u2264 14 |T |. This gives (10).\nIt only remains to treat those sets S for which |S| \u2265 \u03b7n. Then using the same argument as\n\u0001\n\u221a\nwith T in Case 3, the sum of degrees of vertices in S is a.a.s. at most k + (1 + \u03b7) k log k |S|.\nFor a set S of this size in G(n, p), the expected value of \u03bb(S) is\n\u0012 \u0013\n\u03b7n c\n1\n1\n\u223c cn\u03b7 2 > kn\u03b7 2\n2 n\n2\n2\nsince c > k. Moreover, \u03bb(S) is binomially distributed. So by Chernoff's inequality (see for\nexample [8, Theorem 2.1]),\n\u0010\nkn\u03b7 2 \u0011\n2\nP \u03bb(S) \u2264\n\u2264 e\u2212kn\u03b7 /16 = o(2\u2212n )\n4\nfor sufficiently large k (recall that \u03b7 is an absolute constant). Hence, a.a.s. every set S that\nis this large induces a subgraph of at least 14 kn\u03b7 2 \u2265 14 |S|k\u03b7 2 edges. Provided S \u2286 V (K), it\ncontains exactly the same number of edges in K as in G(n, p). Hence we have that a.a.s. for\nall such S and T ,\nX\n1\n\u03bb(S, T ) \u2264\nd(v) \u2212 |S|k\u03b7 2\n2\nv\u2208S\n\n\u2264\n\np\n\u0001\n1\nk + (1 + \u03b7) k log k |S| \u2212 |S|k\u03b7 2\n2\n\n\u2264 k|S|\nfor large enough k. This gives (10), as required.\n11\n\n\f5\n\nProof of Lemma 1\n\nA weakened version of the main result in Pittel, Spencer and Wormald [12] is that if c is fixed,\nG(n, c/n) a.a.s. has no k-core if c < ck , a.a.s. has one if c > ck , where ck is defined in (1). A\nlittle calculation shows that ck and \u03bbk (\u03bbk is also defined in (1)) satisfy\nck \u03c0k (\u03bbk ) = \u03bbk\nck = (k \u2212\n\n(11)\n\u2212(k\u22122)\n2)!e\u03bbk \u03bbk\n\n(12)\n\nwith \u03c0k defined in (2). Substituting (12) and (2) into (11) gives\n\u03bbk =\n\nX\nj\u22650\n\n\u03bbk j+1\n[k + j \u2212 1]j+1\n\n(where square brackets denote falling factorials) and so, multiplying by (k \u2212 1)/\u03bbk , we obtain\nk\u22121 =\n\nX\nj\u22651\n\n\u03bbk j\n.\n[k + j \u2212 1]j\n\nSince the right hand side is an increasing function of \u03bbk , the value of \u03bbk is uniquely determined.\nMoreover, since (k+j)/\u03bbk is exactly the ratio of the jth to the (j+1)th term in the summation,\nthe largest term in the summation occurs for k + j \u2248 \u03bbk and from elementary considerations\n\u221a\nit is easy to see that \u03bbk = k + O( k log k). Thus, putting\n\u03bbk = (k \u2212 2)(1 + t),\n\n(13)\n\nwe know that t = o(1). In addition, rewriting (2) as\n\u03c0k = 1 \u2212\n\nX e\u2212\u03bb \u03bbj\n,\nj!\n\n(14)\n\nj\u2264k\u22122\n\nwe now see that \u03c0k = 1 \u2212 o(1), and hence also ck \u223c k.\nTo get a slightly better bound on t straight away, substitute (12) into (11), use Stirling's\n\u221a\nformula with its correction term due to Robbins: j! = (j/e)j 2\u03c0j(1 + O(1/j)), and take\nlogarithms to give\n\u00101\u0011\n\u0010k \u2212 2\u0011\n1\n+ (k \u2212 1) log(1 + t) \u2212 (k \u2212 2)t + O\n.\n(15)\nlog \u03c0k = log\n2\n2\u03c0\nk\n\nRecalling from above that log \u03c0k = o(1) and t = o(1), we may expand log(1 + t) to show that\n\u0010 q \u00111/2\nk\nt\u223c\n(16)\nk\n\nwhere qk = log k \u2212 log(2\u03c0).\nTaking out a factor of 1/ck from the terms in the summation in (14), using (12) we obtain\n\u0012\n\u0013m Y\n\u0013\nk\u22122\nm \u0012\n1 X\nj\n\u2212m k \u2212 1\n\u03c0k = 1 \u2212\n(1 + t)\n.\n1\u2212\nck m=0\nk\u22122\nk\u22122\nj=1\n\n12\n\n\fThe terms in the summation are monotonically decreasing. Since (1+t)\u2212m = exp(\u2212mt + O(mt2 )),\nwe see that, for any \u03b5 > 0, the terms for m > k1/2+\u03b5 sum to o(1/k). For m = O(k1/2+\u03b5 ), we\nsee after expanding that the product over j is\n\u0010 m2 m3 \u0011\n2\n3\n2\ne\u2212m /2k+O(m/k+m /k ) = 1 + O\n+ 2 .\nk\nk\nPutting r = log(1 + t) and recalling c \u223c k, we now have\n1/2+\u03b5\n\n\u03c0k\n\nk\n\u0010 m2 m3 \u0011\u0011\n1 X \u2212mr \u0010\n1+O\ne\n+ 2\n= 1 \u2212\nck\nk\nk\n\n+\n\nm=0\n\no\n\n\u00101\u0011\n.\nk2\n\nTo estimate the first error term we approximate the summation by an integral, so that term\nbecomes\nO(1) *\n\nk 1/2+\u03b5\nX\nm=0\n\n\u2212mr m\n\ne\n\n2\n\nk\n\n= O(k\n\n\u22121\n\n)\n\nZ\n\n\u221e\n\ne\u2212rx x2 dx\n\n0\n\n= O(r \u22122 k\u22121 )\n= O(t\u22122 k\u22121 )\n= O\n\n\u0010 1 \u0011\nlog k\n\nusing (16). The other error term is similarly O(1/ log k). The main term in the summation is\na truncated geometric series with the truncated terms negligible, so we have\n!\n\u221e\nX\n1\n\u2212mr\ne\n\u03c0k = 1 \u2212\no(1) +\nck\nm=0\n\u0010 1 \u0011\n1\n= 1\u2212\n+\nO\nck (1 \u2212 e\u2212r )\nk log k\n\u0010 1 \u0011\n1\n= 1\u2212\n+\nO\nck (1 \u2212 (t + 1)\u22121 )\nk log k\n\u0010 1 \u0011\nt+1\n.\n+O\n= 1\u2212\nck t\nk log k\nUsing this with (11) shows that\n\nck = \u03bbk + t\u22121 + 1 + O\nSo we may continue with\n\n\u0010 1 \u0011\n.\nlog k\n\n\u0010 1 \u0011\nt+1\n+O\n\u03bbk t\nk log k\n\u0010\n1\n1 \u0011\n= 1\u2212\n.\n+O\nkt\nk log k\n\n\u03c0k = 1 \u2212\n\n13\n\n(17)\n\n\fHence\nlog \u03c0k = \u2212\n\n\u0010 1 \u0011\n1\n.\n+O\nkt\nk log k\n\nNext, substitute this in the left side of (15), and t = (1 + x)(qk /k)1/2 into the right side. We\nknow that x = o(1) from (16), and we may expand log(1 + t) as t \u2212 12 t2 + 31 t3 + O(t4 ). The\nupshot is that\n\u0010 q \u00111/2 q + 3\n\u0010 1 \u0011\nk\nk\nt=\n.\n+\n+O\nk\n3k\nk log k\nThis determines t, and since \u03bbk \u223c k, we have from (13) that \u03bbk = k + kt \u2212 2 + O(1/ log k).\nNow using (17) and the formula for t immediately above (which in particular gives 1/t =\n(qk /k)1/2 \u2212 1/3), we obtain Lemma 1.\n\nReferences\n[1] B. Bollob\u00e1s, C. Cooper, T. Fenner, and A. Frieze, Edge disjoint Hamilton cycles in sparse\nrandom graphs of minimum degree at least k. J. Graph Theory 34 (2000), no. 1, 42\u201359.\n[2] B. Bollob\u00e1s, J. H. Kim, and J. Verstra\u00ebte, Regular subgraphs of random graphs, Random\nStructures & Algorithms, 29 (2006), 1-13.\n[3] I. Benjamini, G. Kozma, and N. Wormald, The mixing time of the giant component of a\nrandom graph, Preprint.\n[4] J. Cain and N. Wormald, Encores on cores, Electronic Journal of Combinatorics 13\n(2006), RP 81.\n[5] P. Flajolet, D. Knuth, and B. Pittel, The first cycles in an evolving graph. Graph theory\nand combinatorics (Cambridge, 1988). Discrete Math. 75 (1989), no. 1-3, 167\u2013215.\n[6] S. Janson, Cycles and unicyclic components in random graphs. Combin. Probab. Comput.\n12 (2003), no. 1, 27\u201352.\n[7] S. Janson and M. Luczak, A simple solution to the k-core problem. Tech. Report 2005:31,\nUppsala.\n[8] S. Janson, T. Luczak, and A. Ruci\u0144ski, Random Graphs, Wiley, New York, 2000.\n[9] J. H. Kim, Poisson cloning model for random graphs. Preprint.\n[10] L. Lov\u00e1sz and M.D. Plummer, Matching theory. North-Holland Mathematics Studies,\n121. Annals of Discrete Mathematics, 29. Budapest, 1986, xxvii+544 pp.\n[11] T. Luczak, Size and connectivity of the k-core of a random graph. Discrete Math. 91\n(1991), no. 1, 61\u201368.\n\n14\n\n\f[12] B. Pittel, J. Spencer, and N. Wormald, Sudden emergence of a giant k-core in a random\ngraph, J. Combinatorial Theory, Series B 67 (1996), 111\u2013151.\n[13] M. Pretti and M. Weigt, Sudden emergence of q-regular subgraphs in random graphs,\nEurophys. Lett. 75, 8 (2006).\n\n15\n\n\f"}