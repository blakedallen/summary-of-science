{"id": "http://arxiv.org/abs/1011.0107v2", "guidislink": true, "updated": "2012-12-03T17:47:14Z", "updated_parsed": [2012, 12, 3, 17, 47, 14, 0, 338, 0], "published": "2010-10-30T21:01:35Z", "published_parsed": [2010, 10, 30, 21, 1, 35, 5, 303, 0], "title": "On the Bogolyubov-Ruzsa lemma", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.2701%2C1011.5872%2C1011.4065%2C1011.6634%2C1011.2747%2C1011.4027%2C1011.2217%2C1011.0843%2C1011.5466%2C1011.5213%2C1011.3853%2C1011.1269%2C1011.0677%2C1011.4417%2C1011.3280%2C1011.5442%2C1011.0282%2C1011.4024%2C1011.4894%2C1011.5740%2C1011.4134%2C1011.4868%2C1011.3502%2C1011.0107%2C1011.5847%2C1011.3557%2C1011.0070%2C1011.0645%2C1011.3998%2C1011.3237%2C1011.4538%2C1011.0755%2C1011.4040%2C1011.2776%2C1011.2576%2C1011.3031%2C1011.1263%2C1011.5636%2C1011.1407%2C1011.3634%2C1011.2376%2C1011.5819%2C1011.4144%2C1011.6156%2C1011.2358%2C1011.6161%2C1011.2969%2C1011.5657%2C1011.2222%2C1011.6114%2C1011.3798%2C1011.0828%2C1011.2398%2C1011.0717%2C1011.2107%2C1011.6425%2C1011.4339%2C1011.6395%2C1011.5080%2C1011.3741%2C1011.5088%2C1011.1004%2C1011.0303%2C1011.3035%2C1011.6391%2C1011.3675%2C1011.1971%2C1011.0567%2C1011.0775%2C1011.6512%2C1011.0780%2C1011.1692%2C1011.1152%2C1011.2059%2C1011.6117%2C1011.0507%2C1011.2547%2C1011.2305%2C1011.0682%2C1011.2311%2C1011.4922%2C1011.4395%2C1011.3314%2C1011.3952%2C1011.5490%2C1011.6039%2C1011.2866%2C1011.0813%2C1011.0396%2C1011.3025%2C1011.5982%2C1011.0190%2C1011.5909%2C1011.0207%2C1011.4239%2C1011.5929%2C1011.1815%2C1011.4595%2C1011.4214%2C1011.2881%2C1011.2375&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the Bogolyubov-Ruzsa lemma"}, "summary": "Our main result is that if A is a finite subset of an abelian group with\n|A+A| < K|A|, then 2A-2A contains an O(log^{O(1)} K)-dimensional coset\nprogression M of size at least exp(-O(log^{O(1)} K))|A|.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.2701%2C1011.5872%2C1011.4065%2C1011.6634%2C1011.2747%2C1011.4027%2C1011.2217%2C1011.0843%2C1011.5466%2C1011.5213%2C1011.3853%2C1011.1269%2C1011.0677%2C1011.4417%2C1011.3280%2C1011.5442%2C1011.0282%2C1011.4024%2C1011.4894%2C1011.5740%2C1011.4134%2C1011.4868%2C1011.3502%2C1011.0107%2C1011.5847%2C1011.3557%2C1011.0070%2C1011.0645%2C1011.3998%2C1011.3237%2C1011.4538%2C1011.0755%2C1011.4040%2C1011.2776%2C1011.2576%2C1011.3031%2C1011.1263%2C1011.5636%2C1011.1407%2C1011.3634%2C1011.2376%2C1011.5819%2C1011.4144%2C1011.6156%2C1011.2358%2C1011.6161%2C1011.2969%2C1011.5657%2C1011.2222%2C1011.6114%2C1011.3798%2C1011.0828%2C1011.2398%2C1011.0717%2C1011.2107%2C1011.6425%2C1011.4339%2C1011.6395%2C1011.5080%2C1011.3741%2C1011.5088%2C1011.1004%2C1011.0303%2C1011.3035%2C1011.6391%2C1011.3675%2C1011.1971%2C1011.0567%2C1011.0775%2C1011.6512%2C1011.0780%2C1011.1692%2C1011.1152%2C1011.2059%2C1011.6117%2C1011.0507%2C1011.2547%2C1011.2305%2C1011.0682%2C1011.2311%2C1011.4922%2C1011.4395%2C1011.3314%2C1011.3952%2C1011.5490%2C1011.6039%2C1011.2866%2C1011.0813%2C1011.0396%2C1011.3025%2C1011.5982%2C1011.0190%2C1011.5909%2C1011.0207%2C1011.4239%2C1011.5929%2C1011.1815%2C1011.4595%2C1011.4214%2C1011.2881%2C1011.2375&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Our main result is that if A is a finite subset of an abelian group with\n|A+A| < K|A|, then 2A-2A contains an O(log^{O(1)} K)-dimensional coset\nprogression M of size at least exp(-O(log^{O(1)} K))|A|."}, "authors": ["Tom Sanders"], "author_detail": {"name": "Tom Sanders"}, "author": "Tom Sanders", "links": [{"title": "doi", "href": "http://dx.doi.org/10.2140/apde.2012.5.627", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1011.0107v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1011.0107v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "28 pp. Corrected typos. Added appendix on model setting", "arxiv_primary_category": {"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1011.0107v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1011.0107v2", "journal_reference": "Anal. PDE 5 (2012), no. 3, 627-655", "doi": "10.2140/apde.2012.5.627", "fulltext": "ON THE BOGOLYUBOV-RUZSA LEMMA\n\narXiv:1011.0107v2 [math.CA] 3 Dec 2012\n\nTOM SANDERS\nAbstract. Our main result is that if A is a finite subset of an Abelian group with\n|A ` A| \u010f K|A|, then 2A  \u0301 2A contains an OplogOp1q 2Kq-dimensional coset progression\nM of size at least expp \u0301OplogOp1q 2Kqq|A|.\n\n1. Introduction\nIn the recent paper [CS10a], Croot and Sisask introduced a fundamental new method\nto additive combinatorics and, although they have already given a number of applications,\nour present purpose is to give another. Specifically, we shall prove the following.\nTheorem 1.1 (Bogolyubov-Ruzsa lemma for Abelian groups). Suppose that G is an\n(discrete) Abelian group and A, S \u0102 G are finite non-empty sets such that |A ` S| \u010f\nK mint|A|, |S|u. Then pA  \u0301 Aq ` pS  \u0301 Sq contains a proper symmetric dpKq-dimensional\ncoset progression M of size expp \u0301hpKqq|A`S|. Moreover, we may take dpKq \" Oplog6 2Kq\nand hpKq \" Oplog6 2K log 2 log 2Kq.\nWe should take a moment to justify the name, which is slightly non-standard. Bogolyubov's lemma (the idea for which originates in [Bog39]) is usually stated for sets of\nlarge density in the ambient group, rather than small doubling, and asserts that the fourfold sumset of a thick set contains a large Bohr set.\nRuzsa, on his way to proving Fre\u0131\u0306man's theorem in [Ruz94], showed that a set with\nsmall doubling could be sensibly embedded into a group where it is thick. He then applied\nBogolyubov's lemma and proceeded to show that a Bohr set contains a large generalised\narithmetic progression which could then be pulled back. In doing all this he implicitly\nproved the first version of Theorem 1.1 in Z \u2013 although, with different bounds \u2013 and this\nmotivates the name.\nThis result has many variants (although the form given above seems to be a fairly useful\none) and in light of this the history is not completely transparent. Certainly most proofs of\nFre\u0131\u0306man's theorem broadly following the model of [Ruz94] will implicitly prove a result of\nthis shape. With this in mind the extension from Z to arbitrary Abelian groups is due to\nGreen and Ruzsa [GR07], and the first good bounds to Schoen [Sch11] for certain classes\nof groups.\nThere are many applications of results of this type, particularly since their popularisation\nby Gowers [Gow98], and we shall deal with a number of these in \u00a711 at the end of the paper.\nTo help explain the main ideas we include a discursive sketch of the paper after the next\nsection, which simply sets some notation.\n1\n\n\f2\n\nTOM SANDERS\n\n2. Notation\nThe main tool used in the paper is Fourier analysis on groups for which the classic\nreference is Rudin [Rud90]. We deal almost exclusively with finite groups in the paper,\nbut to be complete we shall need slightly more generality.\nSuppose that G is a locally compact topological group. We write CpGq for the space of\ncontinuous complex-valued functions on G. More generally if R \u0102 C we write CpG, Rq for\nthe continuous R-valued functions on G.\nThe group structure on G induces an action of G on CpGq called translation. In particular if x P G and f P CpGq then we write\n(2.1)\n\n\u03c1x pf qpyq :\" f pyxq for all y P G.\n\nWe also write MpGq for the space of regular Borel measures on G and can extend \u03c1 to\nthese in the natural way: for x P G and \u03bc P MpGq, \u03c1x p\u03bcq is the measure induced by\n\u017c\nCpGq \u00d1 CpGq; f \u00de\u00d1 f pxqd\u03bcpyxq.\nThe group structure on G is reflected in MpGq in a fairly natural way and we define the\nconvolution of two measures \u03bc, \u03bd P MpGq to be the measure \u03bc  \u030a \u03bd induced by\n\u017c\nCpGq \u00d1 CpGq; f \u00de\u00d1 f pxyqd\u03bcpxqd\u03bdpyq.\n\nThere is a family of privileged measures on G called Haar measures. These are the translation invariant measures on G: \u03bc P MpGq is a Haar measure on G if \u03c1x p\u03bcq \" \u03bc for all\nx P G.\nGiven a Haar measure \u03bc on G we can extend \u03c1 in the obvious way from (2.1) to define\nthe right regular representation \u03c1 : G \u00d1 AutpL2 p\u03bcqq. More than this we can define the\nconvolution of two functions f, g P L1 p\u03bcq by\n\u017c\nf  \u030a gpxq :\" f pyqgpy  \u03011xqd\u03bcpyq for all x P G.\n\nThere are two particularly useful instances of Haar measure depending on the topology\non G: if G is compact we write \u03bcG for the Haar probability measure on G, while if G\nis discrete we write \u03b4G for the Haar counting measure on G and assigns mass 1 to each\nelement of G.\nOf course, if G is finite it is both discrete and compact so one has both probability\nmeasure and counting measure to choose from. The measures are multiples of each other\nas \u03bcG is just the measure assigning mass |G| \u03011 to each element of G. More generally given\na finite set X we write \u03bcX for the measure assigning mass |X| \u03011 to each x P X.\nWhen it is relevant we shall indicate whether we are taking a finite group G to be\ncompact or discrete by declaring the group either compact, so that \u03bcG is to be used, or\ndiscrete so that \u03b4G is to be used. The reader should be aware that this has the effect of\nchanging the normalisations in convolutions.\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n3\n\nThe above all works for general finite groups G, but when G is also Abelian convolution\noperators can be written in a particularly simple form with respect to the Fourier basis\nwhich we now recall.\np for the dual group, that is the finite Abelian group of homomorphisms\nWe write G\np by\n\u03b3 : G \u00d1 S 1 , where S 1 :\" tz P C : |z| \" 1u. Given \u03bc P MpGq we define \u03bc\np P l8 pGq\n\u017c\np\n\u03bc\npp\u03b3q :\" \u03b3d\u03bc for all \u03b3 P G,\n\nand extend this to f P L1 p\u03bcG q by fp :\" fz\nd\u03bcG . It is easy to check that \u03bc\nz\n \u030a\u03bd \" \u03bc\np  \u0308 \u03bdp for all\n1\nz\np\n\u03bc, \u03bd P MpGq and f  \u030a g \" f  \u0308 p\ng for all f, g P L p\u03bcG q.\n3. A sketch of the argument\n\nAssuming the hypotheses of Theorem 1.1 our objective will be to show that there is a\nlarge, low-dimensional coset progression M correlated with A ` S, meaning such that\n}1A`S  \u030a \u03bcM }l8 pGq \u0105 1  \u0301 op1q.\n\nThis is essentially the statement of Theorem 10.1 later, and Theorem 1.1 can be derived\nfrom it by a simple pigeonholing argument.\nA simplified argument: the case of good modelling. We shall assume that we have\ngood modelling in the sense of [GR07], meaning that we shall assume that the sets A and\nS have density K  \u0301Op1q in the ambient group. This can actually be arranged in the two\ncases of greatest interest: Fn2 and Z and facilitates considerable simplifications.\nA very useful observation in L\u00f3pez and Ross [LR75] is that because the support of \u03bcA  \u030a\u03bcS\nis contained in A ` S we have the identity\nx1A`S  \u030a \u03bc \u0301S , \u03bcA y \" 1.\n\nNow, suppose we had a coset progression M over which 1A`S  \u030a \u03bc \u0301S was in some sense\ninvariant, meaning\n(3.1)\n\n}1A`S  \u030a \u03bc \u0301S  \u030a \u03bcM  \u0301 1A`S  \u030a \u03bc \u0301S }lp pGq \u010f \u01eb}1A`S }lp pGq .\n\nThen H\u00f6lder's inequality and the L\u00f3pez-Ross identity tell us that\n\n|x1A`S  \u030a \u03bc \u0301S  \u030a \u03bcM , \u03bcA y  \u0301 1| \u010f \u01eb}1A`S }lp pGq }\u03bcA }lp{pp \u03011q pGq \u010f \u01ebK 1{p ,\n\nand it follows by averaging that A ` S is correlated with M provided that \u01eb \u201e K  \u03011{p .\nThe traditional Fourier analytic approach to finding an M such that (3.1) holds is not\nparticularly efficient, but recently Croot and Sisask showed that there is, at least, a set Z\nsuch that we have (3.1) with Z in place of M and\n\u03bcG pZq \u011b expp \u0301Op\u01eb \u03012 p log Kqq\u03bcG pAq.\n\nMoreover, they noted by the triangle inequality that one can endow Z with the structure\nof a k-fold sumset, so that we have (3.1) with kX in place of M and\n(3.2)\n\n\u03bcG pXq \u011b expp \u0301Opk 2\u01eb \u03012 p log Kqq\u03bcG pAq \" expp \u0301Opk 2 log2 Kqq\u03bcG pAq,\n\n\f4\n\nTOM SANDERS\n\nwhere the third term is by optimising the choice of p \u201e log K given that \u01eb \u201e K  \u03011{p .\nWhat we actually end up with after all this is a set X with density as described in (3.2)\nsuch that\n(3.3)\n\npkq\n\nx1A`S  \u030a \u03bc \u0301S  \u030a \u03bcX , \u03bcA y \u0105 1  \u0301 op1q.\n\nNow, by the usual sorts of applications of Plancherel's theorem and Cauchy-Schwarz we\nfind that most of the Fourier mass of the inner product is concentrated on those characters\nin Spec1{2 p1X q provided 2k \u201e K, and so we choose k \u201e log K.\nWith most of the Fourier mass supported on Spec1{2 p1X q, it follows that the integrand\nin (3.3) correlates with any set which approximately annihilates Spec1{2 p1X q. It remains\nto show that the approximate annihilator of Spec1{2 p1X q \u2013 that is the Bohr set B with\nSpec1{2 p1X q as its frequency set \u2013 contains a large coset progression.\nWe can now apply Chang's theorem to get that B is low dimensional and then the usual\ngeometry of numbers argument tells us that this Bohr set contains a large coset progression,\nand the result is proved.\nExtending the argument: the case of bad modelling. We now drop the assumption\nof good modelling, and the argument proceeds in essentially the same way up until the\napplication of Chang's theorem above.\nIn this case Chang's theorem does not provide good bounds. Instead what we do is note\nthat the set X satisfies a relative polynomial growth condition\n|nX| \u010f nOplog\n\n4\n\nKq\n\n|X| for all n \u011b 1.\n\nThis lets us produce a Bohr set containing X which behaves enough like a group for a\nrelative version of Chang's theorem to hold, whilst at the same time X is much denser in\nthe Bohr set than it would be in the modelling group.\nSince we are not using modelling what we have just done does not actually give us a\nBohr set of low dimension, but rather a Bohr set of size comparable to X which has a\nlower order of polynomial growth on a certain range. It turns out that the usual argument\nthat shows a low dimensional Bohr set contains a large coset progression can be adapted\nrelatively easily to this more general setting and this gives us our final ingredient.\nThese arguments are spread over the paper as follows. The simplified argument up to\n(3.3) is essentially contained in \u00a74. Then, in \u00a75, we record the basic properties of Bohr sets\nwe need before \u00a76, which has the relative version of Chang's theorem, and \u00a77, which puts\nthe material together to take a set satisfying a relative polynomial growth condition and\nproduce a large Bohr superset.\nAfter the material on Bohr sets we have \u00a78 which records some standard covering lemmas\nand then \u00a79 where we show how to find a large coset progression in a Bohr set with relative\npolynomial growth. Finally the argument is all put together in \u00a710.\n4. Fre\u0131\u0306man-type theorems in arbitrary groups\nIn this section we are interested in Fre\u0131\u0306man-type theorems in arbitrary, possibly nonAbelian, groups. There has been considerable work towards such results, although often\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n5\n\nwith restrictions on the type of non-Abelian groups considered, or rather weak bounds. We\ndirect the reader to [Gre09] for a survey, but our interest is narrower, lying with a crucial\nresult of Tao [Tao10, Proposition C.3] which inspires the following.\nProposition 4.1. Suppose that G is a (discrete) group, A, S \u0102 G are finite non-empty sets\nsuch that |AS| \u010f K mint|A|, |S|u, and k P N is a parameter. Then A \u03011 ASS  \u03011 contains X k\nwhere X is a symmetric neighbourhood of the identity with size \u03b4pk, Kq|AS|. Moreover, we\nmay take \u03b4pk, Kq \u011b expp \u0301Opk 2 log2 2Kqq.\nNote that this result is a very weak version of Theorem 1.1 but for any group, not just\nAbelian groups, and despite its weaknesses, its generality makes it useful in some situations.\nCroot and Sisask essentially prove the above result in [CS10a, Theorem 1.6] with weaker\nK-dependence in the bound, by using the p \" 2 version of their Lemma 4.3 below. It turns\nout that we shall be able to show the above bound by coupling the large p case of their\nresult with the L\u00f3pez-Ross identity.\nThe key proposition of this section then, is the following.\nProposition 4.2. Suppose that G is (discrete) a group, A, S, T \u0102 G are finite non-empty\nsets such that |AS| \u010f K|A| and |T S| \u010f L|S|, and k P N and \u01eb P p0, 1s are a pair of\nparameters. Then there is a symmetric neighbourhood of the identity X \u0102 G with\n|X| \u011b expp \u0301Op\u01eb \u03012 k 2 log 2K log 2Lqq|T |\nsuch that\n|\u03bcA \u03011  \u030a 1AS  \u030a \u03bcS  \u03011 pxq  \u0301 1| \u010f \u01eb for all x P X k .\nThe main ingredient in the proof of this is the following result which is essentially\n[CS10a, Proposition 3.3]. To prove it Croot and Sisask introduced the idea of sampling\nfrom physical space rather than Fourier space \u2013 sampling in Fourier space can be seen as\nthe main idea in Chang's theorem. Not only does this work in settings where the Fourier\ntransform is less well behaved, but it also runs much more efficiently, which leads to the\nsuperior bounds.\nWe include the proof since it is the pivotal ingredient of this paper, and we frame it in\nsuch a way as to emphasise the parallels with Chang's theorem.\nLemma 4.3 (Croot-Sisask). Suppose that G is a (discrete) group, f P lp pGq for p \u011b 2 and\nS, T \u0102 G are non-empty with |ST | \u010f K|S|. Then there is a t P T and a set X \u0102 T t \u03011\n \u03012\nwith |X| \u011b p2Kq \u0301Op\u01eb pq |T | such that\n}\u03c1x pf  \u030a \u03bcS q  \u0301 f  \u030a \u03bcS }lp pGq \u010f \u01eb}f }lp pGq for all x P X.\nProof. Let z1 , . . . , zk be independent uniformly distributed S-valued random variables, and\nfor each y P G define Zi pyq :\" \u03c1z  \u03011 pf qpyq  \u0301 f  \u030a \u03bcS pyq. For fixed y, the variables Zi pyq are\ni\nindependent and have mean zero, so it follows by the Marcinkiewicz-Zygmund inequality\n\n\f6\n\nTOM SANDERS\n\nand H\u00f6lder's inequality that\n}\n\nk\n\u00ff\n\ni\"1\n\nZi pyq}pLp p\u03bck q \u010f Oppqp{2\nS\n\n\u010f Oppq\n\n\u017c  \u0303\u00ff\nk\n\ni\"1\n\np{2 p{2 \u03011\n\nk\n\n|Zi pyq|2\n\nk \u017c\n\u00ff\n\ni\"1\n\n \u0327p{2\n\nd\u03bckS\n\n|Zi pyq|p d\u03bckS .\n\nSumming over y and interchanging the order of summation we get\n\u017c \u00ff\nk \u00ff\nk\n\u00ff \u00ff\np\np{2 p{2 \u03011\n|Zi pyq|pd\u03bckS .\n(4.1)\n} Zi pyq}Lp p\u03bck q \u010f Oppq k\nyPG\n\ni\"1\n\nS\n\ni\"1 yPG\n\nOn the other hand,\n \u0303\n \u03271{p\n\u00ff\n|Zi pyq|p\n\" }Zi }lp pGq \u010f }\u03c1zi \u03011 pf q}lp pGq ` }f  \u030a \u03bcS }lp pGq \u010f 2}f }lppGq\nyPG\n\nby the triangle inequality. Dividing (4.1) by k p and inserting the above and the expression\nfor the Zi s we get that\n\u02c7p\n\u017c \u00ff \u02c7\u02c7 \u00ff\nk\n\u02c7\n\u02c71\n\u02c7\n\u03c1z  \u03011 pf qpyq  \u0301 f  \u030a \u03bcS pyq\u02c7 d\u03bckS pzq \" Oppk  \u03011}f }2lp pGq qp{2 .\n\u02c7\ni\n\u02c7 k i\"1\n\u02c7\nyPG\n\nPick k \" Op\u01eb \u03012 pq such that the right hand side is at most p\u01eb}f }lp pGq {4qp and write L for\nthe set of x P S \u02c6  \u0308  \u0308  \u0308 \u02c6 S (where the Cartesian product is k-fold) for which the integrand\nabove is at most p\u01eb}f }lp pGq {2qp ; by averaging \u03bckS pLc q \u010f 2 \u0301p and so \u03bckS pLq \u011b 1  \u0301 2 \u0301p \u011b 1{2.\nNow, \u2206 :\" tpt, . . . , tq : t P T u has L\u2206 \u0102 ST \u02c6  \u0308  \u0308  \u0308 \u02c6 ST , whence |L\u2206| \u010f 2K k |L| and so\nx1\u2206  \u030a 1\u2206 \u03011 , 1L \u03011  \u030a 1L yl2 pG\u02c6 \u0308 \u0308 \u0308\u02c6Gq \" }1L  \u030a 1\u2206 }2l2 pG\u02c6 \u0308 \u0308 \u0308\u02c6Gq \u011b |\u2206|2 |L|{2K k ,\nby the Cauchy-Schwarz inequality since the adjoint of g \u00de\u00d1 1L  \u030a g is g \u00de\u00d1 1L \u03011  \u030a g and\nsimilarly for g \u00de\u00d1 g  \u030a 1\u2206 .\nBy averaging it follows that at least |\u2206|2 {2K k pairs pz, yq P \u2206\u02c6\u2206 have 1L \u03011  \u030a1L pzy  \u03011 q \u0105\n0, and hence there is some t P T such that there is a set X \u0102 T t \u03011 of size at least |T |{2K k\nelements with 1L \u03011  \u030a 1L px, . . . , xq \u0105 0 for all x P X.\nThus for each x P X there is some zpxq P L and ypxq P L such that ypxqi \" zpxqi x. But\nthen by the triangle inequality we get that\n \u0303\n \u0327\nk\n1\u00ff\n}\u03c1x \u03011 pf  \u030a \u03bcS q  \u0301 f  \u030a \u03bcS }lp pGq \u010f }\u03c1x \u03011\n\u03c1  \u03011 pf q  \u0301 f  \u030a \u03bcS }lp pGq\nk i\"1 zpxqi\n \u0327\n \u0303\nk\n1\u00ff\n\u03c1  \u03011 pf q  \u0301 f  \u030a \u03bcS }lp pGq .\n`}\u03c1x \u03011\nk i\"1 zpxqi\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n7\n\nHowever, since \u03c1x is isometric on lp pGq we see that\n}\u03c1x pf  \u030a \u03bcS q  \u0301 f  \u030a \u03bcS }lp pGq \u010f }\n\nk\n1\u00ff\n\u03c1  \u03011 pf q  \u0301 f  \u030a \u03bcS }lp pGq\nk i\"1 ypxqi\n\n`}\n\nk\n1\u00ff\n\u03c1  \u03011 pf q  \u0301 f  \u030a \u03bcS }lp pGq ,\nk i\"1 zpxqi\n\nand we are done since zpxq, ypxq P L.\n\n\u0003\n\nThe important thing to note about the Croot-Sisask lemma is that the p-dependence of\nthe size of the set X is very good. The natural Fourier analytic analogue (essentially given\nin [Bou90], and clearly exposited in [Sis09]) gives an exponentially worse bound. To make\nuse of this strength we use the aforementioned L\u00f3pez-Ross identity.\nProof of Proposition 4.2. We apply Lemma 4.3 to the function f :\" 1AS and with the set\n \u03012 2\nS  \u03011 (so that |S  \u03011 T  \u03011 | \u010f L|S  \u03011 |) to get a set X with |X| \u011b p2LqOp\u01eb k pq |T | such that\n}\u03c1x p1AS  \u030a \u03bcS  \u03011 q  \u0301 1AS  \u030a \u03bcS  \u03011 }lp pGq \u010f\n\n\u01eb}1AS }lp pGq\nfor all x P X.\nek\n\nSince \u03c1 is isometric on lp pGq and \u03c11G is the identity we may certainly assume that X is a\nsymmetric neighbourhood of the identity. Furthermore, by the triangle inequality we have\n}\u03c1x p1AS  \u030a \u03bcS  \u03011 q  \u0301 1AS  \u030a \u03bcS  \u03011 }lp pGq \u010f \u01ebe \u03011 }1AS }lp pGq for all x P X k .\nNow for any (real) function g we have\n\u03bcA \u03011  \u030a gpxq  \u0301 \u03bcA \u03011  \u030a gp1G q \" \u03bcA \u03011  \u030a p\u03c1x pgq  \u0301 gqp1G q \" x\u03bcA , \u03c1x pgq  \u0301 gy.\nThus by H\u00f6lder's inequality we have\n|\u03bcA \u03011  \u030a gpxq  \u0301 \u03bcA \u03011  \u030a gp1G q| \u010f }\u03bcA }lp1 pGq }\u03c1x pgq  \u0301 g}lp pGq .\nPutting g \" 1AS  \u030a \u03bcS  \u03011 we conclude that\n|\u03bcA \u03011  \u030a 1AS  \u030a \u03bcS  \u03011 pxq  \u0301 \u03bcA \u03011  \u030a 1AS  \u030a \u03bcS  \u03011 p1G q| \u010f\n\n\u01eb}\u03bcA }lp1 pGq }1AS }lp pGq\n\ne\n1\n\u01eb|A|1{p |AS|1{p\n\u01ebK 1{p\n\u010f\n\u010f\ne|A|\ne\n\nfor all x P X k . Putting p :\" 2 ` log K we get the conclusion.\n\n\u0003\n\nProof of Proposition 4.1. We simply take T \" A, L \" K and \u01eb \" 1{2 in Proposition\n4.2.\n\u0003\n\n\f8\n\nTOM SANDERS\n\n5. Basic properties of Bohr sets\nFollowing [Bou08] we use a slight generalization of the traditional notion of Bohr set, letting the width parameter vary according to the character. The advantage of this definition\nis that the meet of two Bohr sets in the lattice of Bohr sets is then just their intersection.\nThroughout the section we let G be a finite (compact) Abelian group. A set B is called\na Bohr set if there is a frequency set \u0393 of characters on G, and a width function \u03b4 P p0, 2s\u0393\nsuch that\nB \" tx P G : |1  \u0301 \u03b3pxq| \u010f \u03b4\u03b3 for all \u03b3 P \u0393u.\nTechnically the same Bohr set can be defined by different frequency sets and width functions; we make the standard abuse that when we introduce a Bohr set we are implicitly\nfixing a frequency set and width function.\nThere is a natural way of dilating Bohr sets which will be of particular use to us. For\na Bohr set B and \u03c1 P R` we denote by B\u03c1 the Bohr set with frequency set \u0393 and width\nfunction1 \u03c1\u03b4 so that, in particular, B \" B1 and more generally pB\u03c1 q\u03c11 \" B\u03c1\u03c11 .\nGiven two Bohr sets B and B 1 we define their intersection to be the Bohr set with\nfrequency set \u0393 Y \u03931 and width function \u03b4 ^ \u03b4 1 . A simple averaging argument (c.f. [TV06,\nLemma 4.20] but also the end of Lemma 4.3) can be used to see that the intersection of\nseveral Bohr sets is large.\nLemma 5.1 (Intersections of Bohr sets). Suppose that pB piq qki\"1 is a sequence of Bohr sets.\nThen\nk\nk\n\u013e\n\u017a\npiq\npiq\n\u03bcG p\nB q\u011b\n\u03bcG pB1{2 q.\ni\"1\n\ni\"1\n\np1q\n\npkq\n\nProof. Let \u2206 :\" tpx, . . . , xq P Gk : x P Gu and S :\" B1{2 \u02c6  \u0308  \u0308  \u0308 \u02c6 B1{2 . Then\n\u017c\n\u017c\n(5.1)\n1\u2206  \u030a 1 \u0301\u2206 1S  \u030a 1 \u0301S d\u03bcGk \" p1\u2206  \u030a 1S q2 d\u03bcGk \u011b \u03bcGk p\u2206q2 \u03bcGk pSq2\n\nby Cauchy-Schwarz. The integrand on the left hand side is at most \u03bcGk p\u2206q\u03bcGk pSq and it is\nsupported on the set of x P \u2206 \u0301\u2206 \" \u2206 such that 1S  \u030a1 \u0301S pxq \u0105 0. But if 1S  \u030a1 \u0301S py, . . . , yq \u0105\n0 then\nk\nk\nk\n\u010d\n\u010d\n\u013e\npiq\npiq\npiq\nyP\npB1{2  \u0301 B1{2 q \u0102\nB1 \" p\nB piq q1 .\ni\"1\n\ni\"1\n\nHence\n\n\u03bcGk psupp 1\u2206  \u030a 1 \u0301\u2206 1S  \u030a 1 \u0301S q \u010f \u03bcG pp\nand inserting this in (5.1) we get that\n\u03bcG pp\n1Technically\n\nk\n\u013e\ni\"1\n\ni\"1\n\nk\n\u013e\ni\"1\n\nB piq q1 q\u03bcGk p\u2206q,\n\nB piq q1 q\u03bcGk p\u2206q2 \u03bcGk pSq \u011b \u03bcGk p\u2206q2 \u03bcGk pSq2 .\n\nwidth function \u03b3 \u00de\u00d1 mint\u03c1\u03b4\u03b3 , 2u.\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n9\n\nThe result follows after some cancelation and noting that \u03bcGk pSq is just the right hand\nside of the inequality in the statement of the lemma.\n\u0003\nNote that if B is a Bohr set whose frequency set has one element, and whose width\nfunction is the constant function 2 then there is an easy lower bound for \u03bcG pB\u03b7 q as the\nlength of a certain arc on a circle:\n1\n1\narccosp1  \u0301 2\u03b7 2 q \u011b mint\u03b7, 2u.\n\u03c0\n\u03c0\nFrom this we immediately recover the usual lower bound on the size of a Bohr set with a\nlarger frequency set from this and the preceding lemma.2\nIn [Bou99] developed the idea of Bohr sets as approximate substitutes for groups, and\nsince then his techniques have become an essential tool in additive combinatorics. To begin\nwith we define the entropy of a Bohr set B to be\n\n(5.2)\n\n\u03bcG pB\u03b7 q \u011b\n\nhpBq :\" log\n\n\u03bcG pB2 q\n.\n\u03bcG pB1{2 q\n\nA trivial covering argument shows that B2 can be covered by expphpBqq translates of B,\nand if B is actually a subgroup then hpBq \" 0. It is often desirable to have a uniform\nbound on hpB\u03b4 q for all \u03b4 P p0, 2s, and such a bound is called the dimension of B in other\nwork. Here, however, it is crucial that we do not insist on this.\nWe shall be particularly interested in Bohr sets which grow in a reasonably regular way\nbecause they will function well as approximate groups. In light of the definition of entropy\n(which encodes growth over a fixed range) we say that a Bohr set B is C-regular if\n1\n\u03bcG pB1`\u03b7 q\n\u010f\n\u010f 1 ` ChpBq|\u03b7|\n1 ` ChpBq|\u03b7|\n\u03bcG pBq\n\nfor all \u03b7 with |\u03b7| \u010f 1{ChpBq. Crucially such Bohr sets are commonplace.\nLemma 5.2. There is an absolute constant CR such that if B is a Bohr set then there is\nsome \u03bb P r1, 2s such that B\u03bb is CR -regular.\nThe proof is by a covering argument and follows, for example, [TV06, Lemma 4.24].\nFrom now on we say that a Bohr set B is regular if it is CR -regular.\nFinally, we write \u03b2\u03c1 for the probability measure induced on B\u03c1 by \u03bcG , and \u03b2 for \u03b21 .\nThese measures function as approximate analogues for Haar measure, and the following\nuseful lemma of Green and Konyagin [GK09] shows how they can used to describe a sensible\nversion of the annihilator of a Bohr set.\nLemma 5.3. Suppose that B is a regular Bohr set. Then\n\n2To\n\np\nt\u03b3 : |\u03b2p\u03b3q|\n\u011b \u03bau \u0102 t\u03b3 : |1  \u0301 \u03b3pxq| \" OphpBq\u03ba \u03011 \u03c1q for all x P B\u03c1 u.\n\nrecover the bound in [TV06, Lemma 4.20] some adjustments need to be made as our definition of\na Bohr set is in terms of \u03b3pxq being close to 1 rather than arg \u03b3pxq being close to 0.\n\n\f10\n\nTOM SANDERS\n\np\nProof. First, suppose that |\u03b2p\u03b3q|\n\u011b \u03ba and y P B\u03c1 . Then\n\u017c\n\u017c\n\u03bcG pB1`\u03c1 zB1 \u0301\u03c1 q\n|1  \u0301 \u03b3pyq|\u03ba \u010f | \u03b3pxqd\u03b2pxq  \u0301 \u03b3px ` yqd\u03b2pxq| \u010f\n\" OphpBq\u03c1q\n\u03bcG pB1 q\n\nprovided \u03c1 \u010f 1{CR hpBq. The result is proved.\n\n\u0003\n\n6. The large spectrum and Chang's theorem\nGiven a probability measure \u03bc, a function f P L1 p\u03bcq and a parameter \u01eb P p0, 1s we define\nthe \u01eb-spectrum of f w.r.t. \u03bc to be the set\np : |pf d\u03bcq^ p\u03b3q| \u011b \u01eb}f }L1 p\u03bcq u.\nSpec\u01eb pf, \u03bcq :\" t\u03b3 P G\n\nThis definition extends the usual one from the case \u03bc \" \u03bcG . We shall need a local version of\na result of Chang [Cha02] for estimating the 'complexity' or 'entropy' of the large spectrum.\nGiven a set of characters \u039b and a function \u03c9 : \u039b \u00d1 D :\" tz P C : |z| \u010f 1u we define\n\u017a\np1 ` Re \u03c9p\u03bbq\u03bbq,\np\u03c9,\u039b :\"\n\u03bbP\u039b\n\nand call such a function a Riesz product for \u039b. It is easy to see that all Riesz products are\nreal non-negative functions. They are at their most useful when they also have mass close\nto 1: the set \u039b is said to be K-dissociated w.r.t. \u03bc if\n\u017c\np\u03c9,\u039b d\u03bc \u010f exppKq for all \u03c9 : \u039b \u00d1 D.\n\nIn particular, being 0-dissociated w.r.t. \u03bcG is the usual definition of being dissociated.\nThis relativised version of dissociativity has a useful monotonicity property.\n\nLemma 6.1 (Monotonicity of dissociativity). Suppose that \u03bc1 is another probability measure, \u039b is K-dissociated w.r.t. \u03bc, \u039b1 \u0102 \u039b and K 1 \u011b K. Then \u039b1 is K 1 -dissociated w.r.t.\n\u03bc1  \u030a \u03bc.\nConceptually the next definition is inspired by the discussion of quadratic rank Gowers\nand Wolf give in [GW10]. The pK, \u03bcq-relative entropy of a set \u0393 is the size of the largest\nsubset \u039b \u0102 \u0393 such that \u039b is K-dissociated w.r.t. \u03bc.\n\nLemma 6.2 (The Chang bound, [San10, Lemma 4.6]). Suppose that 0 \u0131 f P L2 p\u03bcq\nand write Lf :\" }f }L2p\u03bcq }f } \u03011\nL1 p\u03bcq . Then the set Spec\u01eb pf, \u03bcq has p1, \u03bcq-relative entropy\n \u03012\nOp\u01eb log 2Lf q.\nThe proof of this goes by a Chernoff-type estimate, the argument for which follows\n[GR07, Proposition 3.4], and then the usual argument of Chang from [Cha02].\nAlthough Chang's theorem cannot be significantly improved (see [Gre03], and [Gre04]\nfor a discussion), there are some small refinements and discussions of their limitations in\nthe work [Shk06, Shk07] and [Shk08] of Shkredov.\nLow entropy sets of characters are majorised by large Bohr sets, a fact encoded in the\nfollowing lemma. The proof is a minor variant of [San10, Lemma 6.3].\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n11\n\nLemma 6.3 (Annihilating dissociated sets). Suppose that B is a regular Bohr set and \u2206\nis a set of characters with p\u03b7, \u03b2q-relative entropy k. Then there is a set \u039b of size at most\nk and a \u03c1 \" \u03a9p\u03b7{p1 ` hpBqqpk ` log 2\u03b7  \u03011 qq, such that for all \u03b3 P \u2206 we have\n|1  \u0301 \u03b3pxq| \" Opk\u03bd ` \u03c11 \u03c1 \u03011 hpB\u03c1 qq for all x P B\u03c11 ^ B\u03bd1 , \u03c11 , \u03bd P R`\n\nwhere B 1 is the Bohr set with constant width function 2 and frequency set \u039b.\nProof. Let L :\" rlog2 3k 2pk ` 1q\u03b7  \u03011 s, the reason for which choice will become apparent,\nand define\n\u03b2 ` :\" \u03b21`L\u03c1  \u030a \u03b2\u03c1  \u030a  \u0308  \u0308  \u0308  \u030a \u03b2\u03c1 ,\n\nwhere \u03b2\u03c1 occurs L times in the expression. By regularity (of B) we can pick some \u03c1 P\np\u03a9p\u03b7{p1 ` hpBqqLq, 1s such that B\u03c1 is regular and we have the point-wise inequality\n\u03b2\u010f\n\n\u03bcG pB1`L\u03c1 q `\n\u03b2 \u010f p1 ` \u03b7{3q\u03b2 ` .\n\u03bcG pBq\n\nIt follows that if \u039b is \u03b7{2-dissociated w.r.t. \u03b2 ` then \u039b is \u03b7-dissociated w.r.t. \u03b2, and hence\n\u039b has size at most k. From now on all dissociativity will be w.r.t. \u03b2 ` .\nWe put \u03b7i :\" i\u03b7{2pk ` 1q and begin by defining a sequence of sets \u039b0 , \u039b1 , . . . iteratively\nsuch that \u039bi is \u03b7i -dissociated. We let \u039b0 :\" H which is easily seen to be 0-dissociated.\nNow, suppose that we have defined \u039bi as required. If there is some \u03b3 P \u2206z\u039bi such that\n\u039bi Y t\u03b3u is \u03b7i`1 -dissociated then let \u039bi`1 :\" \u039bi Y t\u03b3u. Otherwise, terminate the iteration.\nNote that for all i \u010f k ` 1, if the set \u039bi is defined then it is certainly \u03b7{2-dissociated\nand so |\u039bi | \u010f k. However, if the iteration had continued for k ` 1 steps then |\u039bk`1| \u0105 k.\nThis contradiction means that there is some i \u010f k such that \u039b :\" \u039bi is \u03b7i -dissociated and\n\u039bi Y t\u03b3u is not \u03b7i`1 -dissociated for any \u03b3 P \u2206z\u039bi .\nIt follows that we have a set \u039b of at most k characters such that for all \u03b3 P \u2206z\u039b there\nis a function \u03c9 : \u039b \u00d1 D and \u03bd P D such that\n\u017c\np\u03c9,\u039b p1 ` Re \u03bd\u03b3qd\u03b2 ` \u0105 expp\u03b7i`1 q.\nNow, suppose that \u03b3 P \u2206. If \u03b3 P \u039b then the conclusion is immediate, so we may assume\nthat \u03b3 P \u2206z\u039b. Then, since \u039b is \u03b7i -dissociated, we see that\n\u017c\n\u03b7\n| p\u03c9,\u039b \u03b3d\u03b2 ` | \u0105 expp\u03b7i`1 q  \u0301 expp\u03b7i q \u011b\n.\n2pk ` 1q\n\nApplying Plancherel's theorem we get that\n\u02c7\n\u02c7\n\u02c7\n\u02c7 \u00ff\n\u02c7\n\u02c7\n\u03b7\nk\n`\nx\n\u02c7\n\u02c7\nsup |\u03b2p\u03c1 p\u03b3  \u0301 \u03bbq|L .\npy\n\u010f\u02c7\n\u03c9,\u039b p\u03bbq\u03b2 p\u03b3  \u0301 \u03bbq\u02c7 \u010f 3\n2pk ` 1q \u02c7\u03bbPSpanp\u039bq\n\u03bbPSpanp\u039bq\n\u02c7\n\nGiven the choice of L there is some \u03bb P Spanp\u039bq such that |\u03b2p\u03c1 p\u03b3  \u0301 \u03bbq| \u011b 1{2. By Lemma\n5.3 we see that\n\u03b3  \u0301 \u03bb P t\u03b3 1 : |1  \u0301 \u03b3 1 pxq| \" Op\u03c12 hpB\u03c1 qq for all x P pB\u03c1 q\u03c12 u.\n\n\f12\n\nTOM SANDERS\n\nOn the other hand, by the triangle inequality if \u03bb P Spanp\u039bq then\n\u03bb P t\u03b3 1 : |1  \u0301 \u03b3 1 pxq| \u010f k\u03bd for all x P B\u03bd1 u,\n\nand the result follows from a final application of the triangle inequality.\n\n\u0003\n\n7. Containment in a Bohr set\nThe object of this section is to show the following result.\nProposition 7.1. Suppose that G is a finite (compact) Abelian group, d \u011b 1 and X is a\nfinite subset of G with \u03bcG pnXq \u010f nd \u03bcG pXq for all n \u011b 1 and \u03ba P p0, 1s is a parameter.\nThen there is a regular Bohr set B such that\nX  \u0301 X \u0102 B\u03ba and \u03bcG pB2 q \u010f exppOpd log 2d\u03ba \u03011 qq\u03bcG pXq.\nWhat is important here is that given a set of relative polynomial growth we have produced a Bohr set which contains the original set, and which has controlled growth over\na fixed range of dilations. Extending this range down to zero can be done but involves\nconsiderable additional work as well as being unnecessary for our arguments.\nThe next lemma is the key ingredient which provides us with an appropriate Bohr set.\nThe idea originates with Green and Ruzsa in [GR07, Lemma 2.3], but the lemma we record\nis more obviously related to [TV06, Proposition 4.39].\nLemma 7.2. Suppose that G is a finite (compact) Abelian group, A, S \u0102 G have\n\u03bcG pA ` Sq \u010f K\u03bcG pAq and |1z\nA`S p\u03b3q| \u011b p1  \u0301 \u01ebq\u03bcG pA ` Sq.\n?\nThen |1  \u0301 \u03b3psq| \u010f 23 K\u01eb for all s P S  \u0301 S.\n\nProof. By hypothesis there is a phase \u03c9 P S 1 such that\n\u017c\n1A`S \u03c9\u03b3d\u03bcG \" |1z\nA`S p\u03b3q| \u011b p1  \u0301 \u01ebq\u03bcG pA ` Sq.\nIt follows that\n\n\u017c\n\n2\n\n1A`S |1  \u0301 \u03c9\u03b3| d\u03bcG \" 2\n\n\u017c\n\n1A`S p1  \u0301 \u03c9\u03b3qd\u03bcG \u010f 2\u01eb\u03bcG pA ` Sq,\n\nand so if y0 , y1 P S then\n\u017c\n\u017c\n2\n1A |1  \u0301 \u03c9\u03b3pyi q\u03b3| d\u03bcG \u010f 1A`S |1  \u0301 \u03c9\u03b3|2 d\u03bcG \u010f 2\u01eb\u03bcG pA ` Sq.\nHowever, the Cauchy-Schwarz inequality tells us that\n\n|1  \u0301 \u03b3py0  \u0301 y1 q|2 \u010f 2p|1  \u0301 \u03c9\u03b3py0q\u03b3pxq|2 ` |1  \u0301 \u03c9\u03b3py1q\u03b3pxq|2 q\n\nfor all x P G, whence\n\nand the result follows.\n\n\u017c\n\n1A |1  \u0301 \u03b3py0  \u0301 y1 q|2 d\u03bcG \u010f 23 \u01eb\u03bcG pA ` Sq,\n\u0003\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n13\n\nTo prove the proposition we use an idea of Schoen from [Sch03], first introduced to\nFre\u0131\u0306man-type problems by Green and Ruzsa in [GR07]. The essence is that if we have\nsub-exponential growth of a set then we can apply the Cauchy-Schwarz inequality and\nParseval's theorem in a standard way to get a Fourier coefficient of very close to maximal\nvalue.\nProof of Proposition 7.1. By the pigeonhole principle there is some l \" Opd log 2dq such\nthat \u03bcG plXq \u010f 2\u03bcG ppl  \u0301 1qXq. We let B 1 be the Bohr set with width function the constant\nfunction 1{2 and frequency set \u0393 :\" Spec1 \u0301\u01eb p1lX q where we pick \u01eb :\" 2 \u030110 \u03ba2 .\nIt follows by Lemma 7.2 applied to A \" pl  \u0301 1qX and S \" X that\n?\n|1  \u0301 \u03b3pxq| \u010f 23 .2.\u01eb \" \u03ba{8 for all x P X  \u0301 X and \u03b3 P Spec1 \u0301\u01eb p1lX q,\n1\nand hence that X  \u0301 X \u0102 B\u03ba{4\n.\nIt remains to show that the Bohr set is not too large. Begin by noting that\n\u02c6\u017c\n \u03072\n\u017c\n\u03bcG plXq2k \u03011\n1\npkq\npkq 2\n,\n1lX d\u03bcG \u011b\n(7.1)\np1lX q d\u03bcG \u011b\n\u03bcG pkplXqq\npklqd\npkq\n\nwhere 1lX denotes the k-fold convolution of 1lX with itself, and the inequality is CauchySchwarz and then the hypothesis. On the other hand, by Parseval's theorem\n\u00ff\n\u00ff\n2k\n2\n|1x\n\u010f pp1  \u0301 \u01ebq\u03bcG plXqq2k \u03012\n|1x\nlX p\u03b3q|\nlX p\u03b3q|\np\n\u03b3PG\n\n\u03b3RSpec1 \u0301\u01eb p1lX q\n\n\u010f expp \u0301\u03a9pk\u03baqq\u03bcG plXq2k \u03011 \u010f\n\n\u03bcG plXq2k \u03011\n2pklqd\n\nfor some k \" Opd\u03ba \u03011 log 2d\u03ba \u03011 q. In particular, from (7.1) we have that\n\u017c\n\u00ff\n1\npkq\n2k\nx\np1lX q2 d\u03bcG .\n|1lX p\u03b3q| \u010f\n2\n\u03b3RSpec\np1 q\n1 \u0301\u01eb\n\nlX\n\nIt then follows from Parseval's theorem and the triangle inequality that\n\u00ff\n\u00ff\n\u00ff\n2k\n2k\n2k\n|1x\n\"\n|1x\n \u0301\n|1x\nlX p\u03b3q|\nlX p\u03b3q|\nlX p\u03b3q|\n\u03b3PSpec1 \u0301\u01eb p1lX q\n\n\u011b\n\np\n\u03b3PG\n\n\u017c\n\n\u03b3RSpec1 \u0301\u01eb p1lX q\n\npkq\np1lX q2 d\u03bcG\n\n1\n \u0301\n2\n\n\u017c\n\npkq\np1lX q2 d\u03bcG\n\n1\n\"\n2\n\n\u017c\n\npkq\n\np1lX q2 d\u03bcG .\n\nOn the other hand by the triangle inequality |\u03b2p1 p\u03b3q| \u011b 1{2 if \u03b3 P \u0393 since \u03b4 \u010f 1{2, whence\n\u00ff\n\np\n\u03b3PG\n\n2k p1\n2\n|1x\nlX p\u03b3q| |\u03b2 p\u03b3q| \u011b\n\n\u00ff\n1\n4 \u03b3PSpec p1\n1 \u0301\u01eb\n\nlX q\n\n2k\n|1x\n\u011b\nlX p\u03b3q|\n\n\u03bcG plXq2k \u03011\n.\n8pklqd\n\n\f14\n\nTOM SANDERS\n\nBut, by Parseval's theorem and H\u00f6lder's inequality we have that\n\u017c\n\u00ff\npkq\n2k p1\n2\nx\n|1lX p\u03b3q| |\u03b2 p\u03b3q| \"\np1lX  \u030a \u03b2 1 q2 d\u03bcG\npkq\n\npkq\n\n\u010f }1lX  \u030a 1 \u0301lX }L1 pGq }\u03b2 1  \u030a \u03b2 1 }L8 pGq \"\n\nand so\n\n\u03bcG plXq2k\n,\n\u03bcG pB 1 q\n\n\u03bcG pB 1 q \u010f pklqd \u03bcG plXq \u010f exppOpd log 2d\u03ba \u03011 qq\u03bcG pXq.\n1\nFinally we apply Lemma 5.2 to get a regular Bohr set B with B2 \u0102 B11 and B\u03ba \u0104 B\u03ba{4\nso\nthe result is proved.\n\u0003\n8. Covering and growth in Abelian groups\nCovering lemmas are a major tool in additive combinatorics and have been since their\ndevelopment by Ruzsa in [Ruz99]. This was further extended by Green and Ruzsa in\n[GR06], and they play a pivotal role in the non-Abelian theory as was highlighted by Tao\nin [Tao08a] which we do not have many other techniques.\nWhile the most basic form of covering lemmas do work in the non-Abelian setting there\nis a refined argument due to Chang [Cha02] which does not port over so easily.\nLemma 8.1 (Chang's covering lemma, [TV06, Lemma 5.31]). Suppose that G is an (discrete) Abelian group and A, S \u0102 G are finite sets with |nA| \u010f K n |A| for all n \u011b 1 and\n|A ` S| \u010f L|S|. Then there is a set T with |T | \" OpK log 2KLq such that3\nA \u0102 SpanpT q ` S  \u0301 S.\n\nWe shall also need the following slight variant which provides a way in Abelian groups\nto pass from relative polynomial growth on one scale to all scales.\nLemma 8.2 (A variant of Chang's covering lemma). Suppose that G is an (discrete)\nAbelian group and A, S \u0102 G are finite sets with |kA ` S| \u0103 2k |S|. Then there is a set\nT \u0102 A with |T | \u0103 k such that A \u0102 SpanpT q ` S  \u0301 S.\n\nProof. Let T be a maximal S-dissociated subset of A, that is a maximal subset of A such\nthat\np\u03c3.T ` Sq X p\u03c3 1 .T ` Sq \" H for all \u03c3 \u2030 \u03c3 1 P t0, 1uT .\nNow suppose that x1 P AzT and write T 1 :\" T Y tx1 u. By maximality of T there are\n1\nelements \u03c3, \u03c3 1 P t0, 1uT such that p\u03c3.T 1 ` Sq X p\u03c3 1 .T 1 ` Sq \u2030 H. Now if \u03c3x1 \" \u03c3x1 1 then\np\u03c3|T .T ` Sq X p\u03c3 1 |T .T ` Aq \u2030 H contradicting the fact that T is S-dissociated. Hence,\nwithout loss of generality, \u03c3x1 \" 1 and \u03c3x1 1 \" 0, whence\nx1 P \u03c3 1 |T .T  \u0301 \u03c3|T .T ` S  \u0301 S \u0102 SpanpT q ` S  \u0301 S.\n\nWe are done unless |T | \u011b k; assume it is and let T 1 \u0102 T be a set of size k. Denote\n1\nt\u03c3.T 1 : \u03c3 P t0, 1uT u by P and note that P \u0102 kA, whence\n3Recall\n\nthat SpanpT q :\" t\n\n\u0159\n\n2k |S| \" |P ` S| \u010f |kA ` S| \u0103 2k |S|.\n\ntPT\n\n\u03c3t .t : \u03c3 P t \u03011, 0, 1utu.\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\nThis contradiction completes the proof.\n\n15\n\n\u0003\n\nAlthough this is a result in Abelian groups, it has many parallels with Milnor's proof in\n[Mil68] establishing the dichotomy between polynomial growth and exponential growth in\nsolvable groups.\nThe above lemma is particularly useful for controlling the order of relative polynomial\ngrowth through the next result, an idea which was introduced by Green and Ruzsa in\n[GR06].\nLemma 8.3. Suppose that G is an (discrete) Abelian group, X \u0102 G and 2X  \u0301 X \u0102\nSpanpT q ` X  \u0301 X for some set T of size k. Then\n|pn ` 1qX  \u0301 X| \u010f p2n ` 1qk |X  \u0301 X| for all n \u011b 1.\n\nProof. By induction it is immediate that\npn ` 1qX  \u0301 X \u0102 n SpanpT q ` X  \u0301 X,\n\nand it is easy to see that |n SpanpT q| \u010f p2n ` 1qk from which the result follows.\n\n\u0003\n\n9. Lattices and coset progressions\nThe geometry of numbers seems to play a pivotal role in proofs of Fre\u0131\u0306man-type theorems,\nand we direct the reader to [TV06, Chapter 3.5] or the notes [Gre02b] for a much more\ncomprehensive discussion.\nRecall that \u039b is a lattice in Rk if there are linearly independent vectors v1 , . . . , vk such\nthat \u039b \" v1 Z `  \u0308  \u0308  \u0308 ` vk Z; we call v1 , . . . , vk a basis for \u039b. Furthermore, a set K in Rk is\ncalled a convex body if it is convex, open, non-empty and bounded.\nWe require the following application of John's theorem and Minkowski's second theorem\nwhich provides us with a way of producing a generalised arithmetic progression from some\nsort of 'convex progression'4.\nLemma 9.1 ([TV06, Lemma 3.33]). Suppose that K is a symmetric convex body and \u039b is\na lattice, both in Rd . Then there is a proper d-dimensional progression P in K X \u039b such\nthat |P | \u011b expp \u0301Opd log 2dqq|K X \u039b|.\nThe expp \u0301Opd log dqq factor should not come as a surprise: consider packing a ddimensional cube (playing the role of the generalised progression) inside a d-dimensional\nsphere.\nThe question remains of how to find a 'convex progression', and to do this Ruzsa [Ruz94]\nintroduced an important embedding. Suppose that G is a (discrete) finite Abelian group\np Then we define a map\nand \u0393 \u0102 G.\nR\u0393 : G \u00d1 Cp\u0393, Rq\n\nx \u00de\u00d1 R\u0393 pxq : \u0393 \u00d1 R; \u03b3 \u00de\u00d1\n4A\n\n1\nargp\u03b3pxqq,\n2\u03c0\n\nmore formal notion of convex progression is introduced by Green in [Gre02b], where a detailed\ndiscussion and literature survey may be found.\n\n\f16\n\nTOM SANDERS\n\nwhere the argument is taken to lie in p \u0301\u03c0, \u03c0s. Note that R\u0393 preserves inverses, meaning\nthat R\u0393 p \u0301xq \"  \u0301R\u0393 pxq, and furthermore if5\n}R\u0393 px1 q}Cp\u0393,Rq `  \u0308  \u0308  \u0308 ` }R\u0393 pxd q}Cp\u0393,Rq \u0103 1{2\n\nthen\n\nR\u0393 px1 `  \u0308  \u0308  \u0308 ` xd q \" R\u0393 px1 q `  \u0308  \u0308  \u0308 ` R\u0393 pxd q.\nThis essentially encodes the idea that R\u0393 behaves like a Fre\u0131\u0306man morphism6. We shall use\nthis embedding to establish the following proposition.\nProposition 9.2. Suppose that G is a finite Abelian group, d P N and B is a Bohr set\nsuch that\n\u03bcG pBp3d`1q\u03b4 q \u0103 2d \u03bcG pB\u03b4 q for some \u03b4 \u0103 1{4p3d ` 1q.\nThen B\u03b4 contains a proper coset progression M of dimension at most d satisfying the\nestimate \u03b2\u03b4 pMq \" expp \u0301Opd log 2dqq.\nProof.\nWe write \u0393 for the frequency set of B and note that we may assume that L :\"\n\u015e\ntker \u03b3 : \u03b3 P \u0393u is trivial. Indeed, if it is non-trivial we may quotient out by it without\nimpacting the hypotheses of the proposition; we call the quotiented Bohr set B 1 and note\nthat B\u03b4 \" B\u03b41 ` L from which the result follows.\nTo start with note that if x P B\u03b7 then\n\n1\narccosp1  \u0301 \u03b7 2 {2q \u010f 2\u03b7,\n2\u03c0\nand so since 2p3d ` 1q\u03b4 \u0103 1{2 we have that if x1 , . . . , x3d`1 P B\u03b4 then\n}R\u0393 pxq}Cp\u0393,Rq \u010f\n\nR\u0393 px1 `  \u0308  \u0308  \u0308 ` x3d`1 q \" R\u0393 px1 q `  \u0308  \u0308  \u0308 ` R\u0393 px3d`1 q.\n\n(9.1)\n\nBy hypothesis we then have that\n\n|p3d ` 1qR\u0393 pB\u03b4 q| \" |R\u0393 pp3d ` 1qB\u03b4 q| \u010f |p3d ` 1qB\u03b4 |\n\n\u010f |Bp3d`1q\u03b4 | \u0103 2d |B\u03b4 | \" 2d |R\u0393 pB\u03b4 q|.\n\nApply the variant of Chang's covering lemma in Lemma 8.2 to the set R\u0393 pB\u03b4 q (which is\nsymmetric since R\u0393 preserves inverses and B\u03b4 is symmetric) to get a set X \u0102 R\u0393 pB\u03b4 q with\n|X| \u010f d such that\n3R\u0393 pB\u03b4 q \u0102 SpanpXq ` 2R\u0393 pB\u03b4 q.\nWriting V for the real subspace of Cp\u0393, Rq generated by X we see that dim V \u010f d and (by\ninduction) that\nnR\u0393 pB\u03b4 q \u0102 V ` 2R\u0393 pB\u03b4 q\nfor all n. Now, suppose that v P 2R\u0393 pB\u03b4 q. It follows that\nn.v P 2nR\u0393 pB\u03b4 q \u0102 V ` 2R\u0393 pB\u03b4 q.\n\n5Recall\n\nthat if X is a normed space then }  \u0308 }X denotes the norm on that space, so that }f }Cp\u0393,Rq \"\n}f }L8p\u0393q .\n6We direct the unfamiliar reader to [TV06, Chapter 5.3].\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n17\n\nfor all naturals n. Since 2R\u0393 pB\u03b4 q is finite we see that there are two distinct naturals n and\nn1 and some element w P 2R\u0393 pB\u03b4 q such that n.v, n1 .v P V ` w. It follows that pn \u0301 n1 q.v P V\nwhence v P V since V is a vector space and n \u2030 n1 . We conclude that R\u0393 pB\u03b4 q \u0102 V .\nLet E be the group generated by B\u03b4 which is finite, and note that H :\" R\u0393 pEq ` Cp\u0393, Zq\nis a closed discrete subgroup of Cp\u0393, Rq, where Cp\u0393, Zq is the group of Z-valued functions\non \u0393. Since H is a closed discrete subgroup of Cp\u0393, Rq contained in V , it is also a closed\ndiscrete subgroup of V . Since V is certainly generated by R\u0393 pB\u03b4 q and H \u0104 R\u0393 pB\u03b4 q we see\nthat \u039b :\" H X V has finite co-volume and so is a lattice in V .\nLet \u03c1 be the unique solution to |1  \u0301 expp2\u03c0i\u03c1q| \" \u03b7 in the range r0, 1{2s, and write Q\u03c1 for\nthe \u03c1-cube in Cp\u0393, Rq, which is a symmetric convex body in Cp\u0393, Rq, and so K :\" V X Q\u03c1\nis a symmetric convex body in V . Now, by Lemma 9.1 the set K X \u039b contains a proper\nd-dimensional progression P of size expp \u0301Opd log 2dqq|K X \u039b|.\nTo see this note that by (9.1), R\u0393 |B\u03b4 is a Fre\u0131\u0306man 2-homomorphism. Now, if the elements\nx1 , x2 , x3 , x4 P B\u03b4 have\nthen\n\nR\u0393 px1 q ` R\u0393 px2 q \" R\u0393 px3 q ` R\u0393 px4 q\n\nR\u0393 px1 ` x2  \u0301 x3  \u0301 x4 q \" R\u0393 px1 q ` R\u0393 px2 q ` R\u0393 p \u0301x3 q ` R\u0393 p \u0301x4 q \" 0.\nHowever, R\u0393 pxq \" 0 if and only if \u03b3pxq \" 1 for all \u03b3 P \u0393, which is to say if and only if\nx P L. Since L is trivial we conclude that x1 ` x2 \" x3 ` x4 and hence that R\u0393 is injective\non B\u03b4 , and R\u0393 \u03011 : R\u0393 pB\u03b4 q \u00d1 B\u03b4 is a Fre\u0131\u0306man 2-homomorphism.\nOn the other hand, by (9.1) R\u0393 : B\u03b4 \u00d1 R\u0393 pB\u03b4 q is a Fre\u0131\u0306man 2-homomorphism, and so\nR\u0393 : B\u03b4 \u00d1 R\u0393 pB\u03b4 q is a Fre\u0131\u0306man 2-isomorphism, and hence so is its inverse R\u0393 \u03011 : R\u0393 pB\u03b4 q \u00d1\nB\u03b4\nSince B\u03b4 \" R\u0393 \u03011 pK X \u039bq, we are done by, for example, [TV06, Proposition 5.24], which\nsimply says that the image of a proper coset progression under a Fre\u0131\u0306man isomorphism of\norder at least 2 is a proper coset progression of the same size and dimension; in particular\nR\u0393 \u03011 pP q is a proper coset progression of size expp \u0301Opd log 2dqq|B\u03b4 | and dimension at most\nd.\n\u0003\n10. Proof of the main theorem\nThe result driving Theorem 1.1 is the following which brings together all the ingredients\nof the paper.\nTheorem 10.1. Suppose that G is a finite Abelian group, A, S \u0102 G have |A ` S| \u010f\nK mint|A|, |S|u, and \u01eb P p0, 1s is a parameter. Then there is a proper coset progression M\nwith\n\u02c6\n \u0307Op\u01eb \u03012 log6 2\u01eb \u03011 Kq\n\u01eb\n6\n \u03012\n \u03011\ndim M \" Op\u01eb log 2\u01eb Kq and |M| \u011b\n|A ` S|,\n2 log K\nsuch that for any probability measure \u03bc supported on M we have\n|A|\n.\n}1A`S  \u030a \u03bc}l8 pGq \u011b 1  \u0301 \u01eb and }1A  \u030a \u03bc}l8 pGq \u011b p1  \u0301 \u01ebq\n|A ` S|\n\n\f18\n\nTOM SANDERS\n\nProof. We start by thinking of G as discrete and using counting measure. By Pl\u00fcnnecke's\ninequality [TV06, Corollary 6.28] there is a non-empty set S 1 \u0102 S such that\n\u02c6\n \u03072\nK mint|A|, |S|u\n|A||S 1 |\n1\n|A ` A ` S | \u010f\n\u010f K 2 |A|.\n|S 1 | \u010f K 2\n|S|\n|S|\n\nNote, in particular, that since |A ` A ` S 1 | \u011b |A| we have |S 1 | \u011b |S|{K 2 from the second\ninequality. Applying the inequality again we get a non-empty set A1 \u0102 A such that\nand it follows that\n(10.1)\n\n|A1 ` pA ` S 1 q ` pA ` S 1 q| \u010f K 4 |A1 |,\n|pA ` S 1 q ` pA ` S 1 q| \u010f K 4 |A ` S 1 |.\n\nNow we apply Proposition 4.2 with T \" A to get a symmetric neighbourhood of the\nidentity X such that\n|X| \u011b expp \u0301Op\u01eb \u03012k 2 log2 2Kqq|A ` S|\nsince |A| \u011b |A ` S|{K, and\n(10.2)\n\n|\u03bc \u0301A  \u030a 1A`S 1  \u030a \u03bc \u0301S 1 pxq  \u0301 1| \u010f \u01eb{4 for all x P kX.\n\nIn the first instance it follows that kX \u0102 pA ` S 1 q  \u0301 pA ` S 1 q. On the other hand, by the\nPl\u00fcnnecke-Ruzsa estimates [TV06, Corollary 6.29] applied to (10.1) we have that\n\nand hence\n\n|4lppA ` S 1 q  \u0301 pA ` S 1 qq| \u010f K 32l |A ` S 1 |\n\" exppOpl log K ` \u01eb \u03012 k 2 log2 Kqq|X|,\n\n|4lkX| \u010f exppOpl log 2K ` \u01eb \u03012 k 2 log2 2Kqq|X|.\nWe put l \" r\u01eb \u03012 k 2 log 2Ks so that\n|p3kl ` 1qX| \u010f |4klX| \u010f 2kl.Opk\n\nHence we can pick k such that\n\n \u03011 log 2Kq\n\n|X|.\n\n1 ` log \u01eb \u03011 K \u010f k \" Oplog 2\u01eb \u03011 Kq and |p3kl ` 1qX| \u0103 2kl |X|.\n\nBy the variant of Chang's covering lemma in Lemma 8.2 there is some set T of size at most\nkl \" Op\u01eb \u03012 log4 2\u01eb \u03011 Kq such that 3X \u0102 SpanpT q ` 2X, and hence (by Lemma 8.3)\n|pn ` 2qXq| \u010f nOp\u01eb\n\n \u03012 log4\n\n2\u01eb \u03011 Kq\n\n|2X| for all n \u011b 1.\n\nOn the other hand |2X| \u010f 2kl |X|, and so (re-scaling the measure to think of G as compact)\nwe have\n4\n \u03012\n \u03011\n\u03bcG pnXq \u010f nOp\u01eb log 2\u01eb Kq\u03bcG pXq for all n \u011b 1.\nNow, by Proposition 7.1 applied to the set X there is a d \" Opkl log 2kl\u03ba \u03011 q (which we\nmay also assume is at least 1) and a regular Bohr set B such that\nX  \u0301 X \u0102 B\u03ba{2 and \u03bcG pB2 q \u010f exppdq\u03bcG pXq.\n\nLet c be the absolute constant in the following technical lemma and note that since X is\na neighbourhood of the identity, X \u0102 B and \u03b2pXq \u011b expp \u0301dq.\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n19\n\nWe apply Chang's theorem relative to B to get that Specc p1X , \u03b2q \" Specc p\u03bcX q has\np1, \u03b2q-relative entropy\nr \" Opc \u03012 log 2}1X }L2 p\u03b2q }1X } \u03011\nL1 p\u03b2q q \" Opdq.\n\nIt follows from Lemma 6.3 that there is a set of characters \u039b of size r and a \u03c1 \" \u03a9p1{p1 `\nhpBqqrq such that for all \u03b3 P Specc p\u03bcX q we have\n|1  \u0301 \u03b3pxq| \" Op\u03bdr ` \u03c11 rhpBqhpB\u03c1 qq for all x P B\u03c11 ^ B\u03bd1 ,\n\nwhere B 1 is the Bohr set with width function the constant function 2 and frequency set \u039b.\nProvided \u03c1 \u011b \u03ba we see that\n\u03bcG pXq \u010f \u03bcG pB\u03c1{2 q \u010f \u03bcG pB1{2 q and \u03bcG pB2\u03c1 q \u010f \u03bcG pB2 q \u010f exppdq\u03bcG pXq,\n\nand so it follows that hpBq, hpB\u03c1 q \u010f d. It follows that \u03c1 \" \u03a9p1{d2 q and\n\n|1  \u0301 \u03b3pxq| \" Op\u03bdd ` \u03c11 d3 q for all x P B\u03c11 ^ B\u03bd1 and \u03b3 P Specc p\u03bcX q.\n\nPick \u03c11 \" \u03a9p\u01eb{d3 K 2 q and \u03bd \" \u03a9p\u01eb{K 2 dq such that B 2 :\" B\u03c11 ^ B\u03bd1 has\nIn particular\n\n|1  \u0301 \u03b3pxq| \u010f \u01eb{4K 2 for all x P B 2 and \u03b3 P Specc p\u03bcX q.\n\n\u03c11 , \u03bd \" \u03a9p1{K 2 dOp1q q.\nFor each \u03bb P \u039b write B p\u03bbq for the Bohr set with frequency set t\u03bbu and width function the\n\u0179\np\u03bbq\nconstant function 2, thus B\u03bd1 \" \u03bbP\u039b B\u03bd . By Lemma 5.1 we see that\n\u017a\np\u03bbq\n\u03bcG pB\u03b72 q \u011b \u03bcG pB\u03b7\u03c11 {2 q\n\u03bcG pB\u03b7\u03bd{2 q.\n\u03bbP\u039b\n\nOn the other hand since B p\u03bbq has a frequency set of size 1 we see (from (5.2)) that\n1\np\u03bbq\n\u03bcG pB\u03b71 q \u011b mint\u03b7 1 , 2u.\n\u03c0\n1\nNow, if \u03b7\u03c1 {2 \u011b \u03ba then we have that\n\u03bcG pB\u03b72 q \u011b p\u03b7\u03bd{2\u03c0qr \u03bcG pXq,\n\nand on the other we have that \u03bcG pBq \u010f exppdq\u03bcG pXq. Let t \u011b 1 be a natural such that\np16\u03c0p3t ` 1q\u03bd  \u03011 qr exppdq \u0103 2t and t \" Opd log 2dKq.\n\nThen if \u03b7 P r1{8p3t ` 1q, 1{4p3t ` 1qq we have\n\n2\n\u03bcG pBp3t`1q\u03b7\nq \u0103 2t \u03bcG pB\u03b72 q.\n\nWe now apply Proposition 9.2 to get that B\u03b72 contains a proper coset progression M of\ndimension at most t and size p2tq \u0301Optq \u03bcG pXq. The result is proved on an application of the\nnext lemma provided such a choice of \u03b7 is possible. This can be done if \u03ba can be chosen\nsuch that\n\u03c11\n\u0105 \u03ba,\n8p3t ` 1q\n\n\f20\n\nTOM SANDERS\n\nwhich can be done with \u03ba \" \u03a9p\u01ebOp1q K  \u0301Op1q q, and working this back gives that t \"\nOp\u01eb \u03012 log6 2\u01eb \u03011 Kq and the result.\n\u0003\nThe next lemma is here simply to avoid interrupting the flow of the previous argument,\nand the hypotheses are set up purely for that setting. The proof is simply a series of\nstandard Fourier manipulations.\nLemma 10.2. There is an absolute constant c \u0105 0 such that if G is a finite Abelian group,\nA, S, X \u0102 G have |A ` S| \u010f K mint|A|, |S|u, S 1 \u0102 S has |S 1 | \u011b |S|{K 2 , k \u011b log \u01eb \u03011 K is a\nnatural number such that\n|\u03bc \u0301A  \u030a 1A`S 1  \u030a \u03bc \u0301S 1 pxq  \u0301 1| \u010f \u01eb{4 for all x P kX,\nand M is a set such that\n|1  \u0301 \u03b3pxq| \u010f \u01eb{4K 2 for all x P M and \u03b3 P Specc p\u03bcX q,\n\n(10.3)\n\nthen for any probability measure \u03bc supported on M we have\n}1A`S  \u030a \u03bc}l8 pGq \u011b 1  \u0301 \u01eb and }1A  \u030a \u03bc}l8 pGq \u011b p1  \u0301 \u01ebq\nProof. Integrating the first hypothesis we get that\n\n|A|\n.\n|A ` S|\n\npkq\n\n|x\u03bc \u0301A  \u030a 1A`S 1  \u030a \u03bc \u0301S 1 , \u03bcX y  \u0301 1| \u010f \u01eb{4,\n\npkq\n\nwhere \u03bcX denotes the k-fold convolution of \u03bcX with itself. By Fourier inversion we have\nthat\n\u02c7\n\u02c7\n\u02c7\n\u02c7\n\u02c7\n\u02c7\u00ff\nk  \u0301 1\u02c7 \u010f \u01eb{4.\n\u02c7 1z\n1 p\u03b3q\u03bc\n1 p\u03b3qx\nx\np\u03b3q\n\u03bc\np\u03b3q\n\u03bc\nx\n(10.4)\nX\nA\nS\nA`S\n\u02c7\n\u02c7\n\u02c7\n\u02c7\u03b3PGp\n\nThe triangle inequality, Cauchy-Schwarz and Parseval's theorem in the usual way tell us\nthat\n\u00ff\n1\n\u03bcA }l2 pGq\nx\n\u03bcA p\u03b3q\u03bcx\n|1z\np\np }\u03bc\nS 1 }l2 pGq\nS 1 p\u03b3q| \u010f \u03bcG pA ` S q}x\nA`S 1 p\u03b3qx\n\n(10.5)\n\np\n\u03b3PG\n\n\u03bcG pA ` S 1 q\n\" a\n\u010f K 2.\n\u03bcG pAq\u03bcG pS 1 q\n\nThen, by the triangle inequality for any probability measure \u03bc supported on M we have\nthat\n|p\n\u03bcp\u03b3q  \u0301 1| \u010f \u01eb{4K 2 for all \u03b3 P Specc p\u03bcX q.\n\n(10.6)\nWe conclude that\nE :\" |x1A`S 1\n\n\u02c7\n\u02c7\n\u02c7\n\u02c7\n\u00ff\n\u02c7\n\u02c7\npkq\nk\n \u030a \u03bc, \u03bcA  \u030a \u03bcS 1  \u030a \u03bcX  \u030a \u03bcy  \u0301 1| \" \u02c7\u02c7 1z\n\u03bcp\u03b3qx\nx\npp\u03b3q  \u0301 1\u02c7\u02c7\n\u03bcA p\u03b3q\u03bcx\nA`S 1 p\u03b3qp\nX p\u03b3q \u03bc\nS 1 p\u03b3q\u03bc\n\u02c7\u03b3PGp\n\u02c7\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n21\n\nis at most S1 ` S2 ` S3 where\n\u02c7\n\u02c7\n\u02c7\n\u02c7 \u00ff\n\u02c7\n\u02c7\n2\nk\n\u02c7\nz\nx\n\u03bcp\u03b3q|  \u0301 1q\u02c7\u02c7 ,\nS1 :\" \u02c7\n1A`S 1 p\u03b3qx\n\u03bcA p\u03b3q\u03bcx\nX p\u03b3q p|p\nS 1 p\u03b3q\u03bc\n\u02c7\n\u02c7\u03b3RSpecc p\u03bcX q\n\u02c7\n\u02c7\n\u02c7\n\u02c7\n\u00ff\n\u02c7\n\u02c7\n2\nk\nx\n\u03bcp\u03b3q|  \u0301 1q\u02c7\u02c7 ,\n\u03bcA p\u03b3q\u03bcx\n1z\nS2 :\" \u02c7\u02c7\nX p\u03b3q p|p\nS 1 p\u03b3q\u03bc\nA`S 1 p\u03b3qx\n\u02c7\n\u02c7\u03b3PSpecc p\u03bcX q\n\nand\n\n\u02c7\n\u02c7\n\u02c7\n\u02c7\n\u00ff\n\u02c7\n\u02c7\nk\n\u02c7\nS3 :\" \u02c7\u02c7 1z\nx\n\u03bcA p\u03b3q\u03bcx\nA`S 1 p\u03b3qx\nX p\u03b3q  \u0301 1\u02c7 .\nS 1 p\u03b3q\u03bc\n\u02c7\u03b3PGp\n\u02c7\n\nBy the triangle inequality and (10.5) we see that\n\u00ff\nk 2\nk\n\u03bcA p\u03b3q\u03bcx\nS1 \u010f\nsup |\u03bcx\np\u03b3q|\n.\n|1z\nS 1 p\u03b3q| \u010f c K \u010f \u01eb{4\nX\nA`S 1 p\u03b3qx\n\u03b3RSpecc p\u03bcX q\n\np\n\u03b3PG\n\nfor a suitable choice of c \" \u03a9p1q since k \u011b log \u01eb \u03011 K; by (10.5) and (10.6) we see that\n\u00ff\n2\n2\n\u03bcA p\u03b3q\u03bcx\n|1z\nS2 \u010f 2 sup |p\n\u03bcp\u03b3q  \u0301 1|.\nS 1 p\u03b3q| \u010f 2p\u01eb{4K q.K \u010f \u01eb{2;\nA`S 1 p\u03b3qx\n\u03b3PSpecc p\u03bcX q\n\np\n\u03b3PG\n\nand finally by (10.4) we see that S3 \u010f \u01eb{4, so that E \u010f \u01eb. It follows from this that\npkq\n\nx1A`S 1  \u030a \u03bc, \u03bcA  \u030a \u03bcS 1  \u030a \u03bcX  \u030a \u03bcy \u011b 1  \u0301 \u01eb,\nand hence by averaging that\n}1A`S 1  \u030a \u03bc}L8 pGq \u011b 1  \u0301 \u01eb and }1A  \u030a \u03bc}L8 pGq \u011b p1  \u0301 \u01ebq\nThe lemma is proved.\n\n\u03bcG pAq\n.\n\u03bcG pA ` S 1 q\n\n\u0003\n\nIt is worth making a couple of remarks before continuing. First, Theorem 10.1 can be\nextended to infinite Abelian groups by embedding the sets there in a finite group via a\nsufficiently large Fre\u0131\u0306man isomorphism. This is the finite modelling argument of Green and\nRuzsa [GR07, Lemma 2.1], but we shall not pursue it here.\nThe expected \u01eb-dependence in Theorem 10.1 may be less clear than the K-dependence.\nThe argument we have given works equally well for the so-called popular difference set in\nplace of 1A`S , that is the set\nDpA, Sq :\" tx P G : 1A  \u030a 1S pxq \u011b c\u01eb{Ku\nfor sufficiently small c. On the other hand Wolf, in [Wol10], develops the Niveau set\nconstruction of Ruzsa [Ruz87, Ruz91], to show that even finding a large sumset in such\npopular difference sets is hard, and it seems likely that her arguments can be adapted to\ncover the case of DpA, Sq containing a proportion 1  \u0301 \u01eb of a sumset.\n\n\f22\n\nTOM SANDERS\n\nUnderstanding this, even in the model setting of G \" Fn2 , would be of great interest\nsince a better \u01eb-dependence would probably yield better analysis of inner products of the\nform x1A  \u030a 1S , 1T y which are of importance in, for example, Roth's theorem [Rot53, Rot52].\nWe are now in a position to prove Theorem 1.1 by an easy pigeonhole argument.\nProof of Theorem 1.1. Fre\u0131\u0306man 2-embed the sets A and S into a finite group (via, for\nexample, the method of [GR07, Lemma 2.1]); if we can prove the result there then it\nimmediately pulls back.\n?\nApply Theorem 10.1 with \u01eb \" 1{2p1` 2q to get a proper d-dimensional coset progression\nM. Note that we may assume the progression is symmetric by translating it and possibly\nshrinking it by a factor of exppdq; this has no impact on the bounds. Thus we put\nM \" H ` tx1 .l1 `  \u0308  \u0308  \u0308 ` xd .ld : |li | \u010f Li for all 1 \u010f i \u010f du\n\nwhere L1 , . . . , Ld P N, H \u010f G and x1 , . . . , xd P G. Write\n\nM\u03b7 :\" H ` tx1 .l1 `  \u0308  \u0308  \u0308 ` xd .ld : |li | \u010f \u03b7Li for all 1 \u010f i \u010f du,\n\nand note that |M1 | \u010f exppOpdqq|M1{2 |. On the other hand if j\u03b7 \u010f 1{2 then we have\nM1{2 \u0102 M1{2`\u03b7 \u0102  \u0308  \u0308  \u0308 \u0102 M1{2`j\u03b7 \" M1 ,\n\nand so it follows that there is some \u03b7 \" \u03a9p1{dq and i \u010f j \" Opdq such that\n|M1{2`i\u03b7 | \u010f 21{2 |M1{2`pi \u03011q\u03b7 |.\n\nSince \u03b7 \" \u03a9p1{dq we easily have that |M\u03b7 | \" expp \u0301Opd log dqq|M1 |. On the other hand if\nwe apply the conclusion of Theorem 10.1 with\n1M1{2`i\u03b7 ` 1M1{2`pi \u03011q\u03b7\n\u03bc\"\n|M1{2`i\u03b7 | ` |M1{2`pi \u03011q\u03b7 |\nwe get an element x such that\nis at least\n\n|px ` A ` Sq X M1{2`i\u03b7 | ` |px ` A ` Sq X M1{2`pi \u03011q\u03b7 |\np1  \u0301 \u01ebqp|M1{2`i\u03b7 | ` |M1{2`pi \u03011q\u03b7 |q.\n\nBut then if z P M\u03b7 we get that\n\n1A`S  \u030a 1 \u0301pA`Sq pzq \" 1x`A`S  \u030a 1 \u0301px`A`Sq pzq\n\u011b 1px`A`SqXM1{2`i\u03b7  \u030a 1 \u0301px`A`SqXM1{2`pi \u03011q\u03b7 pzq\n\n\u011b |px ` A ` Sq X M1{2`i\u03b7 | ` |z ` ppx ` A ` Sq X M1{2`pi \u03011q\u03b7 q|\n \u0301|ppx ` A ` Sq X M1{2`i\u03b7 q Y pz ` ppx ` A ` Sq X M1{2`pi \u03011q\u03b7 qq|\n\u011b |px ` A ` Sq X M1{2`i\u03b7 | ` |px ` A ` Sq X M1{2`pi \u03011q\u03b7 |  \u0301 |M1{2`i\u03b7 |\n?\n\u011b p1  \u0301 p1 ` 2q\u01ebq|M1{2`pi \u03011q\u03b7 | \u0105 0,\n\nand it follows that pA  \u0301 Aq ` pS  \u0301 Sq contains M\u03b7 . Tracking through the bounds we get\nthe result.\n\u0003\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n23\n\n11. Concluding remarks and applications\nTo begin with we should remark that in the case when G has bounded exponent or is\ntorsion-free, we can get slightly better bounds and the argument is much simpler because\nof the presence of a good modelling lemmas. In the first case we get the following result,\na proof of which (in the case G \" Fn2 ) is contained in the appendix as it is so short.\nTheorem 11.1 (Bogolyubov-Ruzsa Lemma for bounded exponent Abelian groups). Suppose G is an Abelian group of exponent r and A, S \u0102 G are finite non-empty sets such\nthat |A ` S| \u010f K mint|A|, |S|u. Then pA  \u0301 Aq ` pS  \u0301 Sq contains a subspace V of size\nexpp \u0301Or plog4 2Kqq|A ` S|.\nIn the second, the material of \u00a7\u00a75\u20139 can be replaced similar but more standard arguments\nbecause of the following modelling lemma.\nLemma 11.2 (Modelling for torsion-free Abelian groups, [Ruz09, Theorem 3.5]). Suppose\nthat G is a torsion-free Abelian group, A \u0102 G is a finite non-empty set and k \u011b 2 is a\nnatural. Then for every q \u011b |kA  \u0301 kA| there is a set A1 \u0102 A with |A1 | \u011b |A|{k such that\nA1 is Fre\u0131\u0306man k-isomorphic to a subset of Z{qZ.\nTheorem 11.3 (Bogolyubov-Ruzsa lemma for torsion-free Abelian groups). Suppose that\nG is a torsion-free Abelian group and A, S \u0102 G are finite non-empty sets such that |A`S| \u010f\nK mint|A|, |S|u. Then pA  \u0301 Aq ` pS  \u0301 Sq contains a proper symmetric dpKq-dimensional\ncoset progression M of size expp \u0301hpKqq|A`S|. Moreover, we may take dpKq \" Oplog4 2Kq\nand hpKq \" Oplog4 2K log 2 log 2Kq.\nReturning to Theorem\n? hpKq \" \u03a9plog Kq by\n? 1.1 it is easy to see that we must have dpKq,\nconsidering a union of K coset progressions of dimension log2 K, and even achieving\nthis bound may be hard without refining the definition of a coset progression. (See the\ncomments of Green in [Tao08b] for a discussion of this.)\nThe paper [Sch11] was a major breakthrough in proving the first good bounds for (a\nslight variant of) Theorem 1.1; it was essentially shown that one could take\na\ndpKq, hpKq \" OpexppOp log Kqqq\n\nfor torsion-free or bounded-exponent Abelian groups.\nIndeed, it should be clear that while we do not use [Sch11] directly in the proof of\nTheorem 1.1, it has had a considerable influence on the present work and the applications\nwhich now follow are from the end of that paper as well.\nFre\u0131\u0306man's theorem. As an immediate corollary of Theorem 1.1 and Chang's covering\nlemma we have the following.\n\nTheorem 11.4 (Fre\u0131\u0306man's theorem for Abelian groups). Suppose that G is an (discrete)\nAbelian group and A \u0102 G is finite with |A  \u0306 A| \u010f K|A|. Then A is contained in a dpKqdimensional coset progression M of size at most expphpKqq|A|. Moreover, we may take\ndpKq, hpKq \" OpK logOp1q 2Kq.\n\n\f24\n\nTOM SANDERS\n\nBy considering a union of K dissociated translates of a coset progression it is easy to\nsee that we must have dpKq, hpKq \" \u03a9pKq, so the result is close to best possible.\nGreen and Ruzsa in [GR07] provided the first bounds of dpKq, hpKq \" OpK 4`op1q q, and\nthe peppering of their work throughout this paper should indicate the importance of their\nideas.\nSchoen in [Sch11] improved the bounds to OpK 3`op1q q and to OpK 1`op1q q for certain\nclasses of groups, and in [CS10b] the structure is further elucidated with particular emphasis on getting good control on the dimension.\nThe U 3 -inverse theorem. Theorem 1.1 can be inserted into the various U 3 -inverse theorems of Tao and Green [GT08] for finite Abelian groups of odd order, and Samorodnitsky\n[Sam07] (see also [Wol09]) for Fn2 to improve the bounds there. In particular one gets the\nfollowing.\nTheorem 11.5 (U 3 pFn2 q-inverse theorem). Suppose that f P L8 pFn2 q has }f }U 3 pFn2 q \u011b\n\u03b4}f }L8pFn2 q . Then there is a quadratic polynomial q : Fn2 \u00d1 F2 such that\n|xf, p \u03011qq yL2 pFn2 q | \u011b expp \u0301OplogOp1q 2\u03b4  \u03011 qq}f }L8 pFn2 q .\n\nIn fact the connection between good bounds in results of this type and good bounds in\nFre\u0131\u0306man-type theorems is quite clearly developed by Green and Tao in [GT10] and Lovett\nin [Lov10].\nLong arithmetic progressions in sumsets. The question of finding long arithmetic\nprogressions in sets of integers is one of central interest in additive combinatorics. The\nbasic question has the following form: suppose that A1 , . . . , Ak \u0102 t1, . . . , Nu all have\ndensity at least \u03b1. How long an arithmetic progression can we guarantee that A1 `  \u0308  \u0308  \u0308 ` Ak\ncontain?\nFor one set this is addressed by the notoriously difficult Szemer\u00e9di's theorem [Sze69,\nSze75] where the best quantitative work is that of Gowers [Gow98, Gow01]; for two sets\nthe longest progression is much longer with the state of the art due to Green [Gre02a];\nfor three sets or more the results get even stronger with the work of Fre\u0131\u0306man, Halberstam\nand Ruzsa [FHR92]; and finally for eight sets or more, longer again by the recent work of\nSchoen [Sch11].\nTheorem 1.1 yields an immediate improvement for the case of four sets or more.\nTheorem 11.6. Suppose that A1 , . . . , A4 \u0102 t1, . . . , Nu all have density at least \u03b1. Then\n \u0301Op1q\n2\u03b1 \u03011 q\nA1 `  \u0308  \u0308  \u0308 ` A4 contains an arithmetic progression of length N Oplog\n.\n\nProof. Since |Ai `Aj | \u010f 2\u03b1 \u03011 |Ai | for all i, j we have, by averaging, that there is a symmetric\nset A of density \u03b1Op1q such that A1 , . . . , A4 each contains a translate of A. In particular,\nthe longest progression in A  \u0301 A ` A  \u0301 A is contained in a translate of A1 ` A2 ` A3 ` A4 .\nNow, by Theorem 1.1 the set A  \u0301 A ` A  \u0301 A contains an OplogOp1q \u03b1 \u03011 q-dimensional\ncoset progression M of size expp \u0301OplogOp1q \u03b1 \u03011 qqN. Since Z is torsion-free the progression\nis just a generalised progression which certainly contains a 1-dimensional progression of\nlength |M|1{ dim M . The result is proved.\n\u0003\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n25\n\nIt is not clear that this result gives the best possible conclusion for k sets as k tends\nto infinity, although if one were interested in this no doubt some improvement could be\nsqueezed out by delving into the main proof.\n\u039bp4q-estimate for the squares. Inserting Theorem 1.1 into the work of [Cha04] (itself\ndeveloped from an argument of Bourgain in [JL01]) yields the following \u039bp4q-estimate for\nthe squares.\nTheorem 11.7. Suppose that n1 , . . . , nk are naturals. Then\n\u02c74\n\u017c \u02c7\u02c7\u00ff\nk\n\u02c7\n\u02c7\n2 \u02c7\n\u02c7 expp2\u03c0ini \u03b8q\u02c7 d\u03b8 \" Opk 3 expp \u0301\u03a9plog\u03a9p1q 2kqqq.\n\u02c7\n\u02c7i\"1\n\nThis is essentially equivalent to inserting Theorem 1.1 into the proof of [Sch11, Theorem\n8] and Gowers' [Gow98] version of the Balog-Szemer\u00e9di Lemma [BS94]. In any case a\nconjecture of Rudin [Rud60] suggests that the bound Opk 2`op1q q is likely to be true, and\nthe above is not even a power-type improvement on the trivial upper bound of k 3 .\n\nThe Konyagin-Laba theorem. Theorem 1.1 inserted into the argument at the end of\n[Sch11] yields the following quantitative improvement to a result from [KL06].\nTheorem 11.8 (Konyagin-Laba theorem). Suppose that A is a set of reals and \u03b1 P R is\ntranscendental. Then\n|A ` \u03b1.A| \" expp\u03a9plog\u03a9p1q 2|A|qq|A|.\nWhat is particularly interesting here is that there is a simplea\nconstruction which shows\nthat there are arbitrarily large sets A with |A ` \u03b1.A| \" exppOp log |A|qq|A|.\nAcknowledgement\n\nThe author should like to thank Julia Wolf for useful discussions surrounding the U 3 pFn2 qinverse theorem, and an anonymous referee for a thorough reading of the paper and numerous useful suggestions.\nAppendix A. Proof of Theorem 11.1\nOur objective in this appendix is to prove the following result.\nTheorem A.1. Suppose that G :\" Fn2 , and A \u0102 G has density \u03b1 \u0105 0. Then there is a\nsubspace V \u010f G with cod V \" Oplog4 2\u03b1 \u03011 q such that V \u0102 4A.\nWe have distilled this argument out because it is short and just uses the two ingredients\nof the Croot-Sisask lemma and Chang's theorem. For the reader interested in a little more\nmotivation the sketch after the introduction may be of more interest.\nIn the rather special setting of Fn2 it is known from work of Green and Ruzsa [GR07,\nProposition 6.1] that if |A ` A| \u010f K|A| then A is Fre\u0131\u0306man 8-isomorphic to a set A1 of\ndensity K  \u0301Op1q in some Fm\n2 , from which we get the following corollary of Theorem A.1.\n\n\f26\n\nTOM SANDERS\n\nCorollary A.2. Suppose that G :\" Fn2 , and A \u0102 G has |A ` A| \u010f K|A|. Then there is a\nsubspace V \u010f G with |V | \u011b expp \u0301Oplog4 2Kqq|A| such that V \u0102 4A.\nIn this setting the Croot-Sisask lemma is the following.\nLemma A.3 (Croot-Sisask). Suppose that G :\" Fn2 , f P Lp pGq and A \u0102 G has density\n \u03012\n\u03b1 \u0105 0. Then there is an a P A and a set T with \u03bcG pT q \u011b p\u03b1{2qOp\u01eb pq such that\n}\u03c1t pf  \u030a \u03bcA q  \u0301 f  \u030a \u03bcA }Lp pGq \u010f \u01eb}f }Lp pGq for all t P T.\n\nAdditionally Chang's theorem is as follows.\nLemma A.4 (Chang's theorem). Suppose that G :\" Fn2 and A \u0102 G has density \u03b1 \u0105 0.\nThen\ncod Spec\u01eb p\u03bcA qK \" Op\u01eb \u03012 log 2\u03b1 \u03011q.\nProof of Theorem A.1. We begin by noting that\n(A.1)\n\nx12A  \u030a 1A , 1A y \" x12A , 1A  \u030a 1A y \" \u03b12 .\n\nBy the Croot-Sisask lemma applied with f :\" 12A we get a set T \u0102 G with \u03bcG pT q \u011b\n2\np\u03b1{2qOpk pq such that\n}\u03c1t p12A  \u030a 1A q  \u0301 12A  \u030a 1A }Lp pGq \u010f \u03b1{4ke for all t P T.\n\nBy the triangle inequality this gives\n\n}\u03c1t p12A  \u030a 1A q  \u0301 12A  \u030a 1A }Lp pGq \u010f \u03b1{4e for all t P kT,\n\nand so on integrating (and applying the triangle inequality again) we have\npkq\n\n}12A  \u030a 1A  \u030a \u03bcT  \u0301 12A  \u030a 1A }Lp pGq \u010f \u03b1{4e.\n\nBy H\u00f6lder's inequality we get that\npkq\n\n|x12A  \u030a 1A  \u030a \u03bcT , 1A y  \u0301 x12A  \u030a 1A , 1A y| \u010f \u03b1\u03b11`1{pp \u03011q {4e.\n\nChoosing p \" 1 ` log \u03b1 \u03011 and inserting (A.1) we have that\npkq\n\n|x12A  \u030a 1A  \u030a \u03bcT , 1A y  \u0301 \u03b12 | \u010f \u03b12 {4,\n\nand so by the triangle inequality\n\npkq\n\nx12A  \u030a 1A  \u030a \u03bcT , 1A yLp pGq \u011b 3\u03b12 {4.\npkq\n\nNow, put V :\" Spec1{2 p\u03bcT qK and g :\" 12A  \u030a 1A  \u030a \u03bcT , so that\n\u02c7\n\u02c7\n\u02c7\n\u02c7\n\u02c7\u00ff\n\u02c7\n2\nk\nx\n|xg, 1Ay  \u0301 xg  \u030a \u03bcV , 1A y| \" \u02c7\u02c7\n1x\nxT p\u03b3q \u02c7\u02c7 \u010f \u03b12 \u0301k \u010f \u03b12 {8,\n2A p\u03b3q|1A p\u03b3q| \u03bc\n\u02c7\u03b3RV K\n\u02c7\n\nby Parseval's theorem, the definition of V and by taking k \" Oplog 2\u03b1 \u03011 q a sufficiently\nlarge natural. It follows by the triangle inequality that\npkq\n\nx12A  \u030a 1A  \u030a \u03bcT  \u030a \u03bcV , 1A y \u0105 \u03b12 {2,\n\n\fON THE BOGOLYUBOV-RUZSA LEMMA\n\n27\n\nand so, by averaging, that }12A  \u030a \u03bcV }L8 pGq \u0105 1{2. We conclude that 4A contains V by the\npigeon-hole principle and the result is proved on applying Chang's theorem to see that\ncod V \" Oplog 2\u03bcG pT q \u03011 q \" Oplog4 2\u03b1 \u03011q.\n\n\u0003\n\nReferences\n[Bog39] N. Bogolio\u00f9boff. Sur quelques propri\u00e9t\u00e9s arithm\u00e9tiques des presque-p\u00e9riodes. Ann. Chaire Phys.\nMath. Kiev, 4:185\u2013205, 1939.\n[Bou90] J. Bourgain. On arithmetic progressions in sums of sets of integers. In A tribute to Paul Erd\u0151s,\npages 105\u2013109. Cambridge Univ. Press, Cambridge, 1990.\n[Bou99] J. Bourgain. On triples in arithmetic progression. Geom. Funct. Anal., 9(5):968\u2013984, 1999.\n[Bou08] J. Bourgain. Roth's theorem on progressions revisited. J. Anal. Math., 104:155\u2013192, 2008.\n[BS94] A. Balog and E. Szemer\u00e9di. A statistical theorem of set addition. Combinatorica, 14(3):263\u2013268,\n1994.\n[Cha02] M.-C. Chang. A polynomial bound in Fre\u0131\u0306man's theorem. Duke Math. J., 113(3):399\u2013419, 2002.\n[Cha04] M.-C. Chang. On problems of Erd\u0151s and Rudin. J. Funct. Anal., 207(2):444\u2013460, 2004.\n[CS10a] E. S. Croot and O. Sisask. A probabilistic technique for finding almost-periods of convolutions.\nGeom. Funct. Anal., 20(6):1367\u20131396, 2010.\n[CS10b] K. Cwalina and T. Schoen. A linear bound on the dimension in Green-Ruzsa's theorem. Preprint,\n2010.\n[FHR92] G. A. Freiman, H. Halberstam, and I. Z. Ruzsa. Integer sum sets containing long arithmetic\nprogressions. J. London Math. Soc. (2), 46(2):193\u2013201, 1992.\n[GK09] B. J. Green and S. V. Konyagin. On the Littlewood problem modulo a prime. Canad. J. Math.,\n61(1):141\u2013164, 2009.\n[Gow98] W. T. Gowers. A new proof of Szemer\u00e9di's theorem for arithmetic progressions of length four.\nGeom. Funct. Anal., 8(3):529\u2013551, 1998.\n[Gow01] W. T. Gowers. A new proof of Szemer\u00e9di's theorem. Geom. Funct. Anal., 11(3):465\u2013588, 2001.\n[GR06] B. J. Green and I. Z. Ruzsa. Sets with small sumset and rectification. Bull. London Math. Soc.,\n38(1):43\u201352, 2006.\n[GR07] B. J. Green and I. Z. Ruzsa. Fre\u0131\u0306man's theorem in an arbitrary abelian group. J. Lond. Math.\nSoc. (2), 75(1):163\u2013175, 2007.\n[Gre02a] B. J. Green. Arithmetic progressions in sumsets. Geom. Funct. Anal., 12(3):584\u2013597, 2002.\n[Gre02b] B. J. Green. Edinburgh-MIT lecture notes on Fre\u0131\u0306man's theorem. Available at\nwww.dpmms.cam.ac.uk/~bjg23, 2002.\n[Gre03] B. J. Green. Some constructions in the inverse spectral theory of cyclic groups. Combin. Probab.\nComput., 12(2):127\u2013138, 2003.\n[Gre04] B. J. Green. Spectral structure of sets of integers. In Fourier analysis and convexity, Appl.\nNumer. Harmon. Anal., pages 83\u201396. Birkh\u00e4user Boston, Boston, MA, 2004.\n[Gre09] B. J. Green. Approximate groups and their applications: work of Bourgain, Gamburd, Helfgott\nand Sarnak. 2009, arXiv:0911.3354.\n[GT08] B. J. Green and T. C. Tao. An inverse theorem for the Gowers U 3 pGq norm. Proc. Edinb. Math.\nSoc. (2), 51(1):73\u2013153, 2008.\n[GT10] B. J. Green and T. C. Tao. An equivalence between inverse sumset theorems and inverse conjectures for the U 3 norm. Math. Proc. Cambridge Philos. Soc., 149(1):1\u201319, 2010.\n[GW10] W. T. Gowers and J. Wolf. Linear forms and quadratic uniformity for functions on ZN . 2010,\narXiv:1002.2210.\n[JL01]\nW. B. Johnson and J. Lindenstrauss, editors. Handbook of the geometry of Banach spaces. Vol.\nI. North-Holland Publishing Co., Amsterdam, 2001.\n\n\f28\n\n[KL06]\n[Lov10]\n[LR75]\n[Mil68]\n[Rot52]\n[Rot53]\n[Rud60]\n[Rud90]\n[Ruz87]\n[Ruz91]\n[Ruz94]\n[Ruz99]\n[Ruz09]\n[Sam07]\n[San10]\n[Sch03]\n[Sch11]\n[Shk06]\n[Shk07]\n[Shk08]\n[Sis09]\n[Sze69]\n[Sze75]\n[Tao08a]\n[Tao08b]\n[Tao10]\n[TV06]\n[Wol09]\n[Wol10]\n\nTOM SANDERS\n\nS. V. Konyagin and I. Laba. Distance sets of well-distributed planar sets for polygonal norms.\nIsrael J. Math., 152:157\u2013179, 2006.\nS. Lovett. Equivalence of polynomial conjectures in additive combinatorics. 2010,\narXiv:1001.3356.\nJ. M. L\u00f3pez and K. A. Ross. Sidon sets. Marcel Dekker Inc., New York, 1975. Lecture Notes in\nPure and Applied Mathematics, Vol. 13.\nJ. Milnor. Growth of finitely generated solvable groups. J. Differential Geometry, 2:447\u2013449,\n1968.\nK. F. Roth. Sur quelques ensembles d'entiers. C. R. Acad. Sci. Paris, 234:388\u2013390, 1952.\nK. F. Roth. On certain sets of integers. J. London Math. Soc., 28:104\u2013109, 1953.\nW. Rudin. Trigonometric series with gaps. J. Math. Mech., 9:203\u2013227, 1960.\nW. Rudin. Fourier analysis on groups. Wiley Classics Library. John Wiley & Sons Inc., New\nYork, 1990. Reprint of the 1962 original, A Wiley-Interscience Publication.\nI. Z. Ruzsa. Essential components. Proc. London Math. Soc. (3), 54(1):38\u201356, 1987.\nI. Z. Ruzsa. Arithmetic progressions in sumsets. Acta Arith., 60(2):191\u2013202, 1991.\nI. Z. Ruzsa. Generalized arithmetical progressions and sumsets. Acta Math. Hungar., 65(4):379\u2013\n388, 1994.\nI. Z. Ruzsa. An analog of Fre\u0131\u0306man's theorem in groups. Ast\u00e9risque, (258):xv, 323\u2013326, 1999.\nStructure theory of set addition.\nI. Z. Ruzsa. Sumsets and structure. In Combinatorial number theory and additive group theory,\nAdv. Courses Math. CRM Barcelona, pages 87\u2013210. Birkh\u00e4user Verlag, Basel, 2009.\nA. Samorodnitsky. Low-degree tests at large distances. In STOC'07-Proceedings of the 39th\nAnnual ACM Symposium on Theory of Computing, pages 506\u2013515. ACM, New York, 2007.\nT. Sanders. On certain other sets of integers. J. Anal. Math., to appear, 2010, arXiv:1007.5444.\nT. Schoen. Multiple set addition in Zp . Integers, 3:A17, 6 pp. (electronic), 2003.\nT. Schoen. Near optimal bounds in Fre\u0131\u0306man's theorem. Duke Math. J., 158:1\u201312, 2011.\nI. D. Shkredov. On sets of large trigonometric sums. Dokl. Akad. Nauk, 411(4):455\u2013459, 2006.\nI. D. Shkredov. Some examples of sets of large trigonometric sums. Mat. Sb., 198(12):105\u2013140,\n2007.\nI. D. Shkredov. On sets of large trigonometric sums. Izv. Ross. Akad. Nauk Ser. Mat., 72(1):161\u2013\n182, 2008.\nO. Sisask. Bourgain's proof of the existence of long arithmetic progressions in A ` B. Available\nat www.maths.qmul.ac.uk/~olof, 2009.\nE. Szemer\u00e9di. On sets of integers containing no four elements in arithmetic progression. Acta\nMath. Acad. Sci. Hungar., 20:89\u2013104, 1969.\nE. Szemer\u00e9di. On sets of integers containing no k elements in arithmetic progression. Acta Arith.,\n27:199\u2013245, 1975. Collection of articles in memory of Juri\u0131\u0306 Vladimirovi\u010d Linnik.\nT. C. Tao. Product set estimates for non-commutative groups. Combinatorica, 28(5):547\u2013594,\n2008.\nT. C. Tao. Structure and randomness. American Mathematical Society, Providence, RI, 2008.\nPages from year one of a mathematical blog.\nT. C. Tao. Fre\u0131\u0306man's theorem for solvable groups. Contrib. Disc. Math., 5(2):137\u2013184, 2010.\nT. C. Tao and H. V. Vu. Additive combinatorics, volume 105 of Cambridge Studies in Advanced\nMathematics. Cambridge University Press, Cambridge, 2006.\nJ. Wolf. A local inverse theorem in Fn2 . Preprint, 2009.\nJ. Wolf. The structure of popular difference sets. Israel J. Math., 179:253\u2013278, 2010.\n\nMathematical Institute, University of Oxford, 24-29 St.\nEngland\nE-mail address: tom.sanders@maths.ox.ac.uk\n\nGiles', Oxford OX1 3LB,\n\n\f"}