{"id": "http://arxiv.org/abs/0801.0124v1", "guidislink": true, "updated": "2007-12-30T11:15:44Z", "updated_parsed": [2007, 12, 30, 11, 15, 44, 6, 364, 0], "published": "2007-12-30T11:15:44Z", "published_parsed": [2007, 12, 30, 11, 15, 44, 6, 364, 0], "title": "Simulating Genomes and Populations in the Mutation Space: An example\n  with the evolution of HIV drug resistance", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.1650%2C0801.1687%2C0801.1517%2C0801.4124%2C0801.3723%2C0801.3429%2C0801.1069%2C0801.0951%2C0801.3383%2C0801.1377%2C0801.2448%2C0801.2721%2C0801.0141%2C0801.2346%2C0801.3753%2C0801.1280%2C0801.0140%2C0801.2073%2C0801.2629%2C0801.2535%2C0801.3686%2C0801.3986%2C0801.0777%2C0801.3528%2C0801.2766%2C0801.4879%2C0801.4341%2C0801.4340%2C0801.3968%2C0801.3553%2C0801.2650%2C0801.2534%2C0801.2642%2C0801.0343%2C0801.3288%2C0801.0563%2C0801.3824%2C0801.3561%2C0801.1673%2C0801.3700%2C0801.4081%2C0801.3745%2C0801.1174%2C0801.2508%2C0801.4572%2C0801.0743%2C0801.0128%2C0801.3488%2C0801.2857%2C0801.2987%2C0801.2197%2C0801.4700%2C0801.2916%2C0801.3599%2C0801.4841%2C0801.0298%2C0801.0018%2C0801.2982%2C0801.4435%2C0801.2130%2C0801.3739%2C0801.0005%2C0801.0570%2C0801.1629%2C0801.0611%2C0801.2083%2C0801.0715%2C0801.4378%2C0801.0124%2C0801.1730%2C0801.4036%2C0801.4709%2C0801.2992%2C0801.4671%2C0801.0655%2C0801.3903%2C0801.2050%2C0801.2929%2C0801.3681%2C0801.1574%2C0801.4403%2C0801.4271%2C0801.4586%2C0801.4219%2C0801.2387%2C0801.4763%2C0801.1921%2C0801.3316%2C0801.3248%2C0801.3214%2C0801.0979%2C0801.4908%2C0801.1279%2C0801.4892%2C0801.1215%2C0801.3434%2C0801.3907%2C0801.0420%2C0801.2306%2C0801.1958%2C0801.3473&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Simulating Genomes and Populations in the Mutation Space: An example\n  with the evolution of HIV drug resistance"}, "summary": "When simulating biological populations under different evolutionary genetic\nmodels, backward or forward strategies can be followed. Backward simulations,\nalso called coalescent-based simulations, are computationally very efficient.\nHowever, this framework imposes several limitations that forward simulation\ndoes not. In this work, a new simple and efficient model to perform forward\nsimulation of populations and/or genomes is proposed. The basic idea considers\nan individual as the differences (mutations) between this individual and a\nreference or consensus genotype. Thus, this individual is no longer represented\nby its complete sequence or genotype. An example of the efficiency of the new\nmodel with respect to a more classical forward one is demonstrated. This\nexample models the evolution of HIV resistance using the B_FR.HXB2 reference\nsequence to study the emergence of known resistance mutants to Zidovudine and\nDidanosine drugs", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.1650%2C0801.1687%2C0801.1517%2C0801.4124%2C0801.3723%2C0801.3429%2C0801.1069%2C0801.0951%2C0801.3383%2C0801.1377%2C0801.2448%2C0801.2721%2C0801.0141%2C0801.2346%2C0801.3753%2C0801.1280%2C0801.0140%2C0801.2073%2C0801.2629%2C0801.2535%2C0801.3686%2C0801.3986%2C0801.0777%2C0801.3528%2C0801.2766%2C0801.4879%2C0801.4341%2C0801.4340%2C0801.3968%2C0801.3553%2C0801.2650%2C0801.2534%2C0801.2642%2C0801.0343%2C0801.3288%2C0801.0563%2C0801.3824%2C0801.3561%2C0801.1673%2C0801.3700%2C0801.4081%2C0801.3745%2C0801.1174%2C0801.2508%2C0801.4572%2C0801.0743%2C0801.0128%2C0801.3488%2C0801.2857%2C0801.2987%2C0801.2197%2C0801.4700%2C0801.2916%2C0801.3599%2C0801.4841%2C0801.0298%2C0801.0018%2C0801.2982%2C0801.4435%2C0801.2130%2C0801.3739%2C0801.0005%2C0801.0570%2C0801.1629%2C0801.0611%2C0801.2083%2C0801.0715%2C0801.4378%2C0801.0124%2C0801.1730%2C0801.4036%2C0801.4709%2C0801.2992%2C0801.4671%2C0801.0655%2C0801.3903%2C0801.2050%2C0801.2929%2C0801.3681%2C0801.1574%2C0801.4403%2C0801.4271%2C0801.4586%2C0801.4219%2C0801.2387%2C0801.4763%2C0801.1921%2C0801.3316%2C0801.3248%2C0801.3214%2C0801.0979%2C0801.4908%2C0801.1279%2C0801.4892%2C0801.1215%2C0801.3434%2C0801.3907%2C0801.0420%2C0801.2306%2C0801.1958%2C0801.3473&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "When simulating biological populations under different evolutionary genetic\nmodels, backward or forward strategies can be followed. Backward simulations,\nalso called coalescent-based simulations, are computationally very efficient.\nHowever, this framework imposes several limitations that forward simulation\ndoes not. In this work, a new simple and efficient model to perform forward\nsimulation of populations and/or genomes is proposed. The basic idea considers\nan individual as the differences (mutations) between this individual and a\nreference or consensus genotype. Thus, this individual is no longer represented\nby its complete sequence or genotype. An example of the efficiency of the new\nmodel with respect to a more classical forward one is demonstrated. This\nexample models the evolution of HIV resistance using the B_FR.HXB2 reference\nsequence to study the emergence of known resistance mutants to Zidovudine and\nDidanosine drugs"}, "authors": ["Antonio Carvajal-Rodriguez"], "author_detail": {"name": "Antonio Carvajal-Rodriguez"}, "author": "Antonio Carvajal-Rodriguez", "arxiv_comment": "17 pages, 3 figures", "links": [{"href": "http://arxiv.org/abs/0801.0124v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0801.0124v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-bio.GN", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-bio.OT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0801.0124v1", "affiliation": "Departamento de Bioquimica, Genetica e Inmunologia. Universidad de Vigo, Spain", "arxiv_url": "http://arxiv.org/abs/0801.0124v1", "journal_reference": null, "doi": null, "fulltext": "Simulating Genomes and Populations in the Mutation\nSpace: An example with the evolution of HIV drug\nresistance.\nAntonio Carvajal-Rodr\u00edguez\nDepartamento de Bioqu\u00edmica, Gen\u00e9tica e Inmunolog\u00eda. Universidad de Vigo, 36310\nVigo, Spain\nE-mail address:\nAC-R: acraaj@uvigo.es\n\n-1-\n\n\fAbstract\nBackground\n\nWhen simulating biological populations under different evolutionary genetic models,\nbackward or forward strategies can be followed. Backward simulations, also called\ncoalescent-based simulations, are computationally very efficient. However, this\nframework imposes several limitations that forward simulation does not. In this work,\na new simple and efficient model to perform forward simulation of populations and/or\ngenomes is proposed. The basic idea considers an individual as the differences\n(mutations) between this individual and a reference or consensus genotype. Thus, this\nindividual is no longer represented by its complete sequence or genotype. An example\nof the efficiency of the new model with respect to a more classical forward one is\ndemonstrated. This example models the evolution of HIV resistance using the\nB_FR.HXB2 reference sequence to study the emergence of known resistance mutants\nto Zidovudine and Didanosine drugs.\nResults\n\nWhen representing individuals as mutations with respect to a wild genotype we obtain\nan improvement of several orders of magnitude in both computation space and time.\nThis is due to the great amount of redundant information present in the genomes\nwithin populations. We depict the basic algorithms, mutation, recombination and\nfitness, needed to implement this kind of model. This sort of representation is\nappropriate to investigate properties of the viral quasispecieces theory. We\ndemonstrate the model efficiency with an example of the evolution of drug resistance\nin HIV-1. The result obtained seems to corroborate that the evolution of resistance is\nextremely dependent on the population size and the progeny number of the virus. In\naddition this seems also to agree with the recently proposed idea that there is no\nuniversally applicable unique value of effective population size for HIV-1 but this\nwill depend on the specific process of interest under study. In the case of the evolution\nof resistance in a short time period, it seems that no low or medium effective\npopulation sizes as 103 \u2013 105 should be assumed though in other situations it could.\nConclusions\n\nWe propose a forward simulation framework to represent individuals just as the\nmutations they carry with respect to the wild genotype. The new framework seems to\nbe an efficient way for forward modeling genomes and/or populations in the\ncomputer. Taking advantage of the new modeling, we also show the importance of\npopulation sizes being large enough for HIV-1 to get resistance phenotypes faster in\ntime.\n\n-2-\n\n\fBackground\nThere are many different situations in current population biology research where\nsimulating populations at a genetic and/or ecological level is very useful. Some\nexamples include exploring complex situations such as molecular clock-like evolution\n[1], the evolution of drug-resistance in HIV-1 [2], human impacts onto genetic\ndiversity under different demographic scenarios [3], human populations undergoing\ncomplex diseases [4, 5], speciation processes [6], etc.\nSimulation of populations also allows modeling spatially explicit situations as\nepidemiological ones [7] and different ecological and evolutionary scenarios with\ninterest in conservation and management of populations [8, 9]. In addition, population\nsimulation of genetic datasets allows getting expectations of parameters which are\notherwise difficult to obtain such as genome-wide mutation rates [10] or the effect of\ndeleterious mutational load on populations [11].\nWhen simulating biological populations under different evolutionary genetic models,\nbackward or forward strategies can be followed. Backward simulations, also called\ncoalescent-based simulations, are computationally very efficient because they are\nbackward based on the history of lineages with survived offspring in the current\npopulation ignoring, however, all those lineages whose offspring did not arrive to the\npresent [12]. Hence, coalescence is a sample-based theory relevant to the study of\npopulation samples and DNA sequence data. Due to its efficiency, it has also been\nused to derive several algorithms to estimate parameter values that maximize the\nprobability of the given data [13]. From its beginnings, the basic coalescence has been\nextended in several useful ways to include structured population models [14, 15] [1618], changes in population size [19-21], recombination [22, 23] and selection [24-29].\nBy contrast, forward simulations are less efficient because the whole history of the\nsample is followed from past to present. However, the coalescent framework imposes\nsome limitations not present in the forward simulation. The first of all is the same that\ncauses its efficiency, namely, the coalescence does not keep track of the complete\nancestral information. Thus, if the interest is focused on the evolutionary process\nitself, rather than on its outcome, forward simulations should be preferred [30].\nSecond, coalescent simulations are complicated by simple genetic forces such as\nselection, and although different evolutionary scenarios have been incorporated (see\nabove) it is still difficult to implement models incorporating complex evolutionary\nsituations with selection, variable population size, recombination, complex mating\nschemes, and so on. Similarly, coalescent methods cannot yet simulate realistic\nsamples of complex human diseases [4]. Moreover, the coalescent model is based on\nspecific limiting values and relationships between some important parameters [31].\nFinally, no spatial explicit modelling is allowed within the coalescent framework.\nIn this work, I propose a new simple and efficient model to perform forward\nsimulation of populations. The basic idea considers an individual as the differences\n(mutations) between this individual and a reference or consensus genotype. Thus, this\nindividual is no longer represented by its complete genotype. An example of the\nefficiency of the new forward model with respect to a more classical forward one is\n-3-\n\n\fdemonstrated. This example models the evolution of HIV resistance using the\nB_FR.HXB2 reference sequence to study the appearance of known resistance mutants\nto Zidovudine and Didanosine drugs.\n\nResults\nAlgorithm\n\nConsider a forward simulation model of haploid organisms, e.g. proviruses, consisting\nof DNA or RNA sequences, with variable population size, constant selection and\ndiscrete generations. Let these organisms to reproduce inside host cells from which\nthey are released as virions (diploids) that survive depending on their fitnesses values.\nThese virions will enter the cells as proviruses (haploids) and will mutate and, if more\nthan one provirus infected the cell, they will recombine to produce the next generation\nof released virions. This is a typical genetic population model of HIV life cycle [3234].\nLet the genome size to be of 104 nucleotides and begin with one infected cell with one\nprovirus. Then allow mutation with a rate \u03bc per site per generation and release an N\nnumber of virions that will survive according to their fitnesses. This process will be\nrepeated infecting cells as proviruses, mutating, recombining and so on (see Methods\nfor more details of the genetic population model).\nIn a classical forward simulator, the N \u00d7 104 nucleotides corresponding to the sum of\ngenome sizes in the population will be stored in the computer while they are evolving,\nmutating, surviving and reproducing during a number of generations. This is done at\nthe cost of a lot of computation space and time. As the process starts with just one\nprovirus, by storing all the genomes a great amount of redundant information will be\nstored. In contrast, it could be possible to keep the sequence information just once\nbecause all individuals except mutants will be identical. That is, if one mutation\nappears, this individual will be stored as a mutation position in the original sequence\nplus just the new mutant nucleotide or codon, depending on the genetic model being\nused, instead of the whole genome. Thus, the dimensionality of the problem will be\nreduced almost by a four\u2013fold factor. If higher size genomes are considered with\nequal or lower mutation rate, the reduction of dimensionality will be increased. This\nway of representing individuals as mutant deviations from a reference sequence is\ncalled a representation in the mutation space (MS), compared to the classical one\nwhere individuals are represented by their full sequence (sequence space, SS). By\nusing the MS representation, efficiency is gained in both computation space and time.\nHowever, there is also a necessity to redefine the implementation of some processes\nsuch as mutation, recombination and fitness evaluation to adjust to the new way of\nstoring genomes in this less-redundant manner.\nIn what follows we will describe the implementation of the MS representation applied\nto the genetic population model above exposed. We will briefly describe the\nimplementation of mutation, recombination, fitness evaluation and some possible\nextensions of the model. The C++ source code is available upon request from the\nauthor, and a new forward simulator using the MS representation will be soon freely\n-4-\n\n\favailable. Afterwards, we will perform an experiment as a test case, using a sequence\nDNA fragment (3012 bp) corresponding to the coding region of the subunit p51 of the\nreverse transcriptase from the consensus B_FR.HXB2 HIV-1 sequence, to study the\nevolution of resistance to Zidovudine and Didanosine drugs in a number N of virions\nthrough 250 generations under therapeutic conditions (see Methods section for\ndetails). The study will be performed by implementing the same model using two\ndifferent forward simulators: 1) The conventional SS representation, and 2) The MS\nrepresentation. The increase of fitness due to the emergence of resistant mutants and\nthe mutation distribution will be evaluated at different population sizes, from 103 up\nto 107. We will compare the results and the average computation time needed using\nthe SS and MS representations.\nImplementation of the SS and MS models\n\nBoth implementations were performed from an object oriented perspective in the C++\nprogramming language. Under the classical SS model each individual stores a DNA\nsequence of a given, fixed, length. Mutation, recombination and fitness evaluation are\nmodeled as in previous models [1, 35] for a model incorporating recombination). The\nSS model used here is just an extension of the above two models to incorporate\nvariable population size and the specific progression, i.e. infection, mutation,\nrecombination and surviving of the new generation, of the biological model depicted\nin the algorithm section.\nUnder the MS model, we first store the initial sequence as an string called 'Master'\nand then each individual is defined as an object of the class Subject. Each non-empty\nobject of this class will just store a fitness value and a vector of positions and codons.\nIf the individual has no mutations then the object is empty and has the fitness\ncorresponding to the Master sequence. In any other case, each individual stores a\nvector of starting codon positions. These positions are stored because the codons they\ncapture have a mutation with respect to the original codon. The corresponding new\nmutant codon must also be stored for each position in the vector. We will briefly\nexplain how to implement specific evolutionary features using this MS representation.\nMutation: For each individual, a number of mutants are randomly generated from a\nPoisson distribution with parameter L \u00d7 \u03bc, where L is the sequence length and \u03bc is the\nmutation rate per site and generation. These mutants will be distributed by randomly\nchoosing different positions along the sequence. For each new mutant position mp, it\nmust be checked if it affects to any previously stored start codon position in the\nsubject. This is easily done just by checking if the value mp \u2013 mp %3, where % stands\nfor the module of integer division, is already present in the vector of positions. If it is\nnot, then just add the mutant position (mp \u2013 mp %3) and the new codon to this\nsubject. Else, if it is already in the vector, this is a recurrent mutation and we must recompute the new codon. Then, if it reverts to wild, delete this position from the\nvector; if not, keep the position and substitute the old codon with the new one.\nRecombination: The MS model provides an intuitive and efficient way to perform\nrecombination. First, given two different proviruses in the same cell, we only must\nconsider mutant positions, i.e. position values that are in any of the two parental\nindividual vectors. As with mutation, we get the number of recombinant points from a\n\n-5-\n\n\fPoisson random generator with parameter L \u00d7 r and distribute these points randomly\nalong the sequence. Now consider the production of one of the two possible\nrecombinant proviruses. For individual one, we just need to count, for each start\ncodon position in its vector, the number of recombination points before such position.\nOnly if the number is even, including zero, we do include the mutant position in a\nnew offspring vector (see Figure 1). Now we repeat the operation for individual two\nbut only including the positions with an odd number of recombinant points below\neach position in the vector. We get in this way one of the putative recombinants, the\nother will be simply the inverse one including odd and even positions, instead of even\nand odd, for individual one and two, respectively. The only problem with this\nalgorithm is that a recombinant point could fall just within the codon, i.e. given the\nposition p, the recombinant point could have a value of p that will break the codon\nchanging from the second position or a value of p+1 that will break changing the third\ncodon position. If any of these situations occur we must check if the codon is also a\nmutant in individual 2 or not, and re-compute the new recombinant codon in\nconsequence. For example, imagine that in individual one, the starting codon position\nX, which is not included in the vector of individual two, is broken changing from the\nsecond nucleotide. In this case, we need just to substitute the values X[2] =\nMaster[X][2] and X[3] = Master[X][3] where X[i] refers to the i position of codon X\nand Master[X][i] stands for the i position of codon X in the Master sequence.\nFitness evaluation: For each individual, the initial fitness is set to one. Then, for each\nselective codon, we check if its position appears in the vector of mutations. If it does\nnot appear then multiply fitness by 1 \u2013 s, else check if the codon is the favored one, if\nnot, then multiply fitness by 1 \u2013 s.\nModel Extensions: The above model can be easily extended to deal with more\ncomplex situations. The extension to diploids is straightforward; we just need to keep\ntwo vectors instead of one for each individual. The computation of homozygous or\nheterozygous states does not pose major problems. We can also consider several\nindividuals instead of one at the initial population. In this case, we must compute a\nconsensus sequence and then representing each original sequence as mutant\ndeviations from the consensus one. We also can consider different populations with\ndifferent migration rate between them. In this case, we must compute a consensus\nsequence for each population and recompute each migrant individual as mutant\ndeviations from the consensus of the receiver population. Alternatively, we can\ncompute a metapopulation consensus and then deviate every individual from that.\nTesting\n\nWe study the emergence of HIV drug resistance under therapy conditions. Thus, we\nevolve a virion population during 250 generations studying the mutant distribution\nand the increase of average population fitness due to the appearance of known\nmutations contributing to resistance. We run the simulations in a computer cluster\nwith 13 processors and in a personal computer with Pentium processor. For any case\nstudied it is guaranteed that the processes dispose of 100% of processor time.\nConcerning the evolution of resistance and the corresponding fitness increase, there\nwere no significant differences between SS and MS models. With population sizes\n\n-6-\n\n\ffrom N = 103 to 105, we do not observe an increase of fitness or this was very slight.\nWith population size equal to 106, one or two resistance mutations, varying by\nreplicate, were fixed with the corresponding increase of fitness. Full resistance only\nappears with population size of 107 and only in 20% of the replicates. The population\naverage fitness by replicate in this later case was 0.6 (see continuous line in Figure 2).\nWith this population size we only performed simulations under the MS model due to\nthe high computation cost of this case with the SS model. In the time interval assayed\n(250 generations) the results did not vary with the different recombination values\nused. In addition, we obtained the average distribution of the frequency of selective\nmutations in the population. As expected, with low and medium population sizes,\nalmost all individuals carried no mutations, and a few ones carried just one or two\nmutations at most. With population sizes higher than 105, i.e. progeny numbers of 106\nor higher, the shape of the mutant distribution changes drastically and all viruses\ncarried one or more mutations in the p51 coding region (see bars in Figure 2).\nIn Figure 3 we can observe the average time by replicate for SS and MS models at the\ndifferent population sizes. Clearly, the same result is always obtained equal or faster\nin the MS model than in the SS one, the differences increasing as we increased the\npopulation size, implying more than two orders of magnitude with 106 or higher\npopulation sizes. The time estimated for the SS model with population size of 107 is a\nminimum estimate taking into account a linear increase with respect of the 106 case.\nHowever, because of memory overflow we were not able to run the SS model with a\npopulation size of 107 neither in a personal computer nor in the cluster.\n\nDiscussion\nThe ms representation\n\nWe have developed a simple framework that allows the efficient and flexible\ncomputer modeling of complex evolutionary situations. The MS methodology used to\nperform the forward simulations produces the same results than the SS one, but more\nthan two orders of magnitude faster. We have illustrated this with an example that is\nfar from being the optimal situation for the MS model, that is, we have considered a\nshort fragment of DNA, just 3Kb, with a high mutation rate and, even in such\nsituation, the MS model has demonstrated its higher efficiency. Indeed, we have also\nbeen able to run the MS model with a population size of 107 both in a cluster and in a\npersonal computer with a Pentium processor in just a few hours. However, optimal\nmodeling situations will be those with high sequence or genome sizes and mediumlow mutation rates. In such situations, the MS model should overcome by several\norders of magnitude the more classical forward ones. For example, we have been able\nto evolve in a few seconds on a personal computer ten thousand individuals during\n100 generations with diploid genome size of 107 nucleotides with a mutation rate per\nhaploid genome and generation of U = 0.5 using the same MS model developed here\n(not shown). This genome size could be considered a valid approximation to the\nDrosophila genome discarding the third codon nucleotides. In this context of genome\nsimulation we can predict the substitution rate [36] and when a number of mutations\nhas been fixed, we can compute a second consensus to store the fixed mutations. In\nthis way we should maintain the efficiency of the MS model during a large number of\ngenerations. For example, with a gamete mutation rate U = 0.5 we expect a\n-7-\n\n\fsubstitution rate of 0.5 per diploid genome per generation for neutral or quasi-neutral\nmutations, which implies about 50 mutants fixed after 100 generations. Therefore, we\ncan decide to update the individual vectors each 100 generations to deal with the\nredundant information that is being generated due to the evolutionary process.\nThe simulation experiment\n\nConcerning the test case studied, we have used a real sequence and real codon\npositions and mutations, to see how resistance could evolve in HIV. The mutation\nspace representation is particularly suited to simulate HIV in the framework of the\nquasispecies theory. This is due to its structure, i.e. a master sequence and a\npopulation of individuals represented as deviations from it, and efficiency, allowing\nfor simulating large progeny numbers in the computer. It is in this context where the\nvirus ability to increase its fitness is a direct consequence of the large number of\nmutant progeny that allows an efficient exploration of the sequence space. The result\nwe have obtained fits perfectly with this quasispecies vision. The larger the\npopulation the larger the fitness gain, which coincides with the experimental\nobservation in RNA viruses [37-39].\nOf course the model we have used is a simplification, as every model is. We have\nassumed just one infection rate and one cell type but infection rates could varie\ndepending on the cell type, and there are different cell types with\ndifferent half-lives that should affect the results of the model. However, double\ninfection rates seem not to be very important here since recombination had no impact\nonto the fitness increase.\nSomewhat different to a previous study [34] we do not detect any recombination\neffect favoring fixation time. This is due to the time limit imposed of only 250\ngenerations of evolution and the major number of resistant mutants needed. Thus, if\nwe do not impose a time limit or reduce the number of alleles or the mutations\nnecessary for achieving resistance we observe (not shown), as expected, that\nrecombination favors resistance fixation. However, for multiple resistance appearing\nin short periods of time the key factor seems to be the population size. If this is not\nlarge enough, the sequence space cannot be explored sufficiently for the necessary\nmutations to appear and recombination has nothing to do. Therefore, this is concerned\nwith the current discussion about effective population size (Ne) in HIV-1 [40]. Our\nresult seems to corroborate the argument that there is no universally applicable unique\nvalue of effective population size for HIV-1 but this will depend on the specific\nprocess of interest under study. In the case of the evolution of resistance in a short\ntime period, it seems that no low or medium effective population sizes as 103 \u2013 105\nshould be assumed though in other situations it could [41].\nWe have taken advantage of the MS representation under a specific forward\nMontecarlo simulation. The MS could be applied, however, to other kind of forward\nsimulations as, for example, the direct method of Gillespie [42] in the framework of\nthe stochastic time-evolution equation. This method uses Montecarlo simulation to\nsolve numerically the stochastic equation. The MS representation could be used\nprovided that the objects under study could be represented as a deviations from a\n\n-8-\n\n\fmaster or consensus one which do not seems to be the case when simulating chemical\nreactions [43] but may be possible in the case of viral dynamics [44].\n\nConclusions\nWe propose a forward simulation framework to represent individuals just as the\nmutations they carry with respect to the wild genotype. The idea is straightforward.\nHowever, it has not been used in previous forward simulation models [45-48]. Hence,\nwe demonstrate the efficiency of the MS model by comparing its lower cost in\ncomputation space and time with respect to a typical forward implementation. It is\nconcluded that the MS seems to be an efficient way for forward modeling of genomes\nand populations in the computer.\n\nMethods\nModel for the simulation experiment\n\nThe HIV evolution model used in the simulation experiment to test the MS method is\nan adaptation of a previous one [32] and modified in [34]. Thus, we further adjust this\nmodel to manage real or simulated DNA sequences. Each DNA sequence of length L\nis a provirus. From the distribution of proviruses we get distributions of two different\nkinds of cells i.e. single and double infected cells with probabilities 1 - f and f\nrespectively. The life cycle takes place as explained in the algorithm section. HIV\nvirions are released from cells and selection acts to allow or not the virions survival. If\nthe cell was double infected, the fitness is evaluated as the average of the two\nproviruses. At each generation the process of generating new virions from the\ninfecting provirus is repeated N times, so that the population has a variable size with a\nmaximum of N virions.\nThe fitness of a provirus depends on the selective(s) site(s) defined in the original\nsequence and on the selective coefficient acting against the virion survival, namely,\nunder therapy conditions the fitness will be 1 only if some specific amino acids are\npresent at given sites of the sequence. Therefore, this extended model includes the\ncalculation of the corresponding amino acids from specific nucleotide positions.\nZidovudine resistance is conferred by the presence of subsets of four or five amino\nacid substitutions in the HIV-1 reverse transcriptase. However, the dominant\nresistance phenotype for Zidovudine seems to be Leu 41 and Tyr or Phe 215 [49]. In\naddition, Val 74 contributes to resistance to Abacavir and Didanosine [50, 51]. To test\nthe two implementations of the model above we will use the coding region of the\nsubunit p51 of the reverse transcriptase from the consensus B_FR.HXB2 HIV-1\nsequence to evolve in the computer with mutation and recombination. Fitness will be\n1 if and only if a virion has Leu-41, Tyr/Phe-215 and Val-74. On the contrary, fitness\nwill be computed under a multiplicative model multiplying by 1- s for each allele\nwithout resistance mutations. Thus, the initial population, without resistance\n\n-9-\n\n\fmutations have fitness (1-s)3 which implies a value of 0.125 with the parameter value\nused of s = 0.5.\nComputer simulations\n\nWe used the following parameters in the simulations: Generation time in HIV-1 is\nconsidered to be of 1.8 days [52] but see [53]. Therefore, we run 250 generations,\nwhich in any case implies more than one year of HIV evolution. With the MS model\nwe run 100 replicates except for population size 107 that run only 10 replicates. With\nthe SS model we run only 10 replicates because of the larger computation time\nneeded. Population size (N) was {103, 104, 105, 106, 107}; mutation rate per nucleotide\nsite and generation (\u03bc) was 3 10-5 [54]; recombination rate per site and generation\n(r) was {3 10-4, 3 10-5, 3 10-6} [55]; double infection rate (f) was 0.8 [56] and\nselection coefficient (s) was 0.5.\n\nAuthors' contributions\nAC-R had the original idea for the work, designed and implemented the algorithms\nand wrote the manuscript.\n\nAcknowledgements\nI wish to thank A. Caballero, E. Rol\u00e1n-\u00c1lvarez, S.T. Rodr\u00edguez-Ramilo and H.\nQuesada and two anonymous reviewers for valuable comments on the manuscript. I\nam currently funded by an Isidro Parga Pondal research fellowship from Xunta de\nGalicia (Spain).\n\nReferences\n1.\n2.\n3.\n4.\n5.\n\nLiu Y, Nickle DC, Shriner D, Jensen MA, Gerald H, Learn J, Mittler JE,\nMullins JI: Molecular clock-like evolution of human immunodeficiency\nvirus type 1. Virology 2004, 329:101-108.\nLiu Y, Mullins JI, Mittler JE: Waiting times for the appearance of cytotoxic\nT-lymphocyte escape mutants in chronic HIV-1 infection. Virology 2006,\n347:140-146.\nCarvajal-Rodriguez A, Rolan-Alvarez E, Caballero A: Quantitative variation\nas a tool for detecting human-induced impacts on genetic diversity.\nBiological Conservation 2005, 124:1-13.\nPeng B, Amos CI, Kimmel M: Forward-Time Simulations of Human\nPopulations with Complex Diseases. PLoS Genet 2007, 3:e47.\nPeng B, Kimmel M: Simulations provide support for the common diseasecommon variant hypothesis. Genetics 2007, 175:763-776.\n\n- 10 -\n\n\f6.\n7.\n8.\n9.\n10.\n11.\n12.\n13.\n14.\n15.\n16.\n\n17.\n18.\n19.\n20.\n21.\n22.\n23.\n24.\n25.\n\nChurch SA, Taylor DR: The evolution of reproductive isolation in spatially\nstructured populations. Evolution 2002, 56:1859-1862.\nCaraco T, Glavanakov S, Li SG, Maniatty W, Szymanski BK: Spatially\nstructured superinfection and the evolution of disease virulence. Theor\nPopul Biol 2006, 69:367-384.\nDunning JB, Stewart DJ, Danielson BJ, Noon BR, Root TL, Lamberson RH,\nStevens EE: Spatially Explicit Population-Models - Current Forms and\nFuture Uses. Ecological Applications 1995, 5:3-11.\nWu JG, David JL: A spatially explicit hierarchical approach to modeling\ncomplex ecological systems: theory and applications. Ecological Modelling\n2002, 153:7-26.\nKeightley PD: Inference of genome-wide mutation rates and distributions\nof mutation effects for fitness traits: a simulation study. Genetics 1998,\n150:1283-1293.\nCaballero A, Cusi E, Garcia C, Garcia-Dorado A: Accumulation of\ndeleterious mutations: Additional Drosophila melanogaster estimates and\na simulation of the effects of selection. Evolution 2002, 56:1150-1159.\nRosenberg NA, Nordborg M: Genealogical trees, coalescent theory and the\nanalysis of genetic polymorphisms. Nat Rev Genet 2002, 3:380-390.\nFu Y-X, Li W-H: Coalescing into the 21st century: An overview and\nprospects of coalescent theory. Theor Popul Biol 1999, 56:1-10.\nBahlo M, Griffiths RC: Coalescence time for two genes from a subdivided\npopulation. J Math Biol 2001, 43:397-410.\nBahlo M, Griffiths RC: Inference from gene trees in a subdivided\npopulation. Theor Popul Biol 2000, 57:79-95.\nBeerli P, Felsenstein J: Maximum likelihood estimation of a migration\nmatrix and efective population sizes in n subpopulations by using a\ncoalescent approach. Proceedings of the National Academy of Sciences, USA\n2001, 98:4563-4568.\nNotohara M: The coalescent and the genealogical process in geographically\nstructured population. J Math Biol 1990, 29:59-75.\nWilkinson-Herbots HM: Genealogy and subpopulation differentiation\nunder various models of population structure. J Math Biol 1998, 37:535585.\nGriffiths RC, Tavare S: Sampling theory for neutral alleles in a varying\nenvironment. Philosophical Transactions of the Royal Society of London,\nSeries B 1994, 344:403-410.\nMohle M, Sagitov S: A classification of coalescent processes for haploid\nexchangeable population models. Annals of Probability 2001, 29:15471562.\nTajima F: The effect of change in population size on DNA polymorphism.\nGenetics 1989, 123:597-601.\nHey J, Wakeley J: A coalescent estimator of the population recombination\nrate. Genetics 1997, 145:833-846.\nHudson RR, Kaplan NL: The coalescent process in models with selection\nand recombination. Genetics 1988, 120:831-840.\nKaplan NL, Darden T, Hudson RR: The coalescent process in models with\nselection. Genetics 1988, 120:819-829.\nKrone SM, Neuhauser C: Ancestral processes with selection. Theor Popul\nBiol 1997, 51:210-237.\n\n- 11 -\n\n\f26.\n27.\n28.\n29.\n30.\n31.\n32.\n33.\n34.\n35.\n36.\n37.\n38.\n39.\n40.\n41.\n42.\n43.\n44.\n\nNeuhauser C, Krone SM: The genealogy of samples in models with\nselection. Genetics 1997, 145:519-534.\nDonnelly P, Nordborg M, Joyce P: Likelihoods and simulation methods for\na class of nonneutral population genetics models. Genetics 2001, 159:853867.\nBarton NH, Etheridge AM, Sturm AK: Coalescence in a random\nbackground. Annals of Applied Probability 2004, 14:754-785.\nFearnhead P: Perfect simulation from nonneutral population genetic\nmodels: Variable population size and population subdivision. Genetics\n2006, 174:1397-1406.\nCalafell F, Grigorenko EL, Chikanian AA, Kidd KK: Haplotype evolution\nand linkage disequilibrium: A simulation study. Hum Hered 2001, 51:8596.\nWakeley J: The limits of theoretical population genetics. Genetics 2005,\n169:1-7.\nBretscher MT, Althaus CL, Muller V, Bonhoeffer S: Recombination in HIV\nand the evolution of drug resistance: for better or for worse? Bioessays\n2004, 26:180-188.\nAlthaus CL, Bonhoeffer S: Stochastic interplay between mutation and\nrecombination during the acquisition of drug resistance mutations in\nhuman immunodeficiency virus type 1. J Virol 2005, 79:13572-13578.\nCarvajal-Rodriguez A, Crandall KA, Posada D: Recombination favors the\nevolution of drug resistance in HIV-1 during antiretroviral therapy. Infect\nGenet Evol 2007, 7:476-483.\nCarvajal-Rodriguez A, Crandall KA, Posada D: Recombination Estimation\nunder Complex Evolutionary Models with the Coalescent Composite\nLikelihood Method. Mol Biol Evol 2006, 23:817-827.\nKimura M: The Neutral Theory of Molecular Evolution. Cambridge:\nCambridge University Press; 1983.\nNovella IS, Duarte EA, Elena SF, Moya A, Domingo E, Holland JJ:\nExponential Increases of Rna Virus Fitness during Large Population\nTransmissions. Proc Natl Acad Sci U S A 1995, 92:5841-5844.\nNovella IS, Quer J, Domingo E, Holland JJ: Exponential fitness gains of\nRNA virus populations are limited by bottleneck effects. J Virol 1999,\n73:1668-1671.\nDomingo E, Holland JJ: RNA virus mutations and fitness for survival.\nAnnu Rev Microbiol 1997, 51:151-178.\nKouyos RD, Althaus CL, Bonhoeffer S: Stochastic or deterministic: what is\nthe effective population size of HIV-1? Trends Microbiol 2006, 14:507-511.\nLeigh Brown AJ: Analysis of HIV-1 env gene sequences reveals evidence\nfor a low effective number in the viral population. Proceedings of the\nNational Academy of Sciences, USA 1997, 94:1862-1865.\nGillespie D: Approximate accelerated stochastic simulation of chemically\nreacting systems. The Journal of Chemical Physics 2001, 115:1733.\nCao Y, Gillespie DT, Petzold LR: Accelerated stochastic simulation of the\nstiff enzyme-substrate reaction. J Chem Phys 2005, 123:144917.\nRouzine IM, Rodrigo A, Coffin JM: Transition between stochastic evolution\nand deterministic evolution in the presence of selection: General theory\nand application to virology. Microbiol Mol Biol Rev 2001, 65:151-184.\n\n- 12 -\n\n\f45.\n46.\n47.\n48.\n49.\n50.\n\n51.\n\n52.\n53.\n\n54.\n55.\n56.\n\nConery J, Lynch M: Genetic Simulation Library. Bioinformatics 1999,\n15:85-86.\nBalloux F: EASYPOP (version 1.7): a computer program for population\ngenetics simulations. J Hered 2001, 92:301-302.\nPeng B, Kimmel M: simuPOP: a forward-time population genetics\nsimulation environment. Bioinformatics 2005, 21:3686-3687.\nGuillaume F, Rougemont J: Nemo: an evolutionary and population genetics\nprogramming framework. Bioinformatics 2006, 22:2556-2557.\nKellam P, Larder BA: Retroviral recombination can lead to linkage of\nreverse transcriptase mutations that confer increased zidovudine\nresistance. J Virol 1995, 69:669-674.\nTisdale M, Alnadaf T, Cousens D: Combination of mutations in human\nimmunodeficiency virus type 1 reverse transcriptase required for\nresistance to the carbocyclic nucleoside 1592U89. Antimicrob Agents\nChemother 1997, 41:1094-1098.\nEron JJ, Chow YK, Caliendo AM, Videler J, Devore KM, Cooley TP,\nLiebman HA, Kaplan JC, Hirsch MS, D'Aquila RT: pol mutations conferring\nzidovudine and didanosine resistance with different effects in vitro yield\nmultiply resistant human immunodeficiency virus type 1 isolates in vivo.\nAntimicrob Agents Chemother 1993, 37:1480-1487.\nFu Y-X: Estimating mutation rate and generation time from longitudinal\nsamples of DNA sequences. Mol Biol Evol 2001, 18:620-626.\nLemey P, Kosakovsky Pond SL, Drummond AJ, Pybus OG, Shapiro B,\nBarroso H, Taveira N, Rambaut A: Synonymous Substitution Rates Predict\nHIV Disease Progression as a Result of Underlying Replication Dynamics.\nPLoS Comput Biol 2007, 3:e29.\nMansky LM, Temin HM: Lower in vivo mutation rate of human\nimmunodeficiency virus type 1 than that predicted from the fidelity of\npurified reverse transcriptase. J Virol 1995, 69:5087-5094.\nShriner D, Rodrigo AG, Nickle DC, Mullins JI: Pervasive genomic\nrecombination of HIV-1 in vivo. Genetics 2004, 167:1573-1583.\nJung A, Maier R, Vartanian JP, Bocharov G, Jung V, Fischer U, Meese E,\nWain-Hobson S, Meyerhans A: Multiply infected spleen cells in HIV\npatients. Nature 2002, 418:144.\n\nFigures\nFigure 1 - How the algorithm produces one recombinant type after\nrecombination with two break points, one parental provirus having 3 mutants\nand the other having no mutants (it does not appear in the figure). The number\nof recombination break points before each mutant position appears between\nbrackets. See text for details.\n\n- 13 -\n\n\fFigure 2 - Selective mutation frequency distribution and fitness gain after 250\ngenerations for different population sizes.\n\nLogN: Logarithm of population size; Continuous line: represent the fitness gain after\n250 generations for each population size. Bars: The frequency of individuals carrying\na number of selective mutations (classes from 0 to 3 selective mutations). From left to\nright, empty bars represent class of 0 selective mutations, bars with vertical lines: 1\nselective mutant, hatched lines: 2 selective mutants, filled: 3 selective mutants.\nFigure 3 - Computation time in minutes needed to simulate 250 generations\nunder different population sizes using the SS and MS models.\n\nLogN: Logarithm of population size; Continuous line: MS model; dashed line: SS\nmodel. Estimated: The result for one replicate with the SS model was not yet obtained\nafter 4 days of computation in a 13-processor cluster and finally the process died due\nto memory overflow.\n\n- 14 -\n\n\fBreak point 1\n\nMutant 1\n(0)\n\nBreak point 1\n\nMutant 1\n\nFigure 1\n\nBreak point 2\n\nMutant 2\n(1)\n\nMutant 3\n(2)\n\nBreak point 2\n\nMutant 3\n\n\f1\n\n0.75\n\n0.5\n\n0.25\n\n0\n3\n\n4\n\n5\nLogN\n\nFigure 2\n\n6\n\n7\n\n\f> 4 days\nes\n1000\n\nt ed\na\ntim\n\n16 hours\n\nMinutes\n\n800\n600\n\n3 hours\n400\n\n8 minutes\n\n200\n0\n3\n\n4\n\n5\nLogN\n\nFigure 3\n\n6\n\n7\n\n\f"}