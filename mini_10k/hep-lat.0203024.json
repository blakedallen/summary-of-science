{"id": "http://arxiv.org/abs/hep-lat/0203024v2", "guidislink": true, "updated": "2002-08-02T18:05:44Z", "updated_parsed": [2002, 8, 2, 18, 5, 44, 4, 214, 0], "published": "2002-03-23T00:58:13Z", "published_parsed": [2002, 3, 23, 0, 58, 13, 5, 82, 0], "title": "Higher Order Hybrid Monte Carlo at Finite Temperature", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=hep-lat%2F0108003%2Chep-lat%2F0108024%2Chep-lat%2F0211033%2Chep-lat%2F0211029%2Chep-lat%2F0211024%2Chep-lat%2F0211014%2Chep-lat%2F0211009%2Chep-lat%2F0211013%2Chep-lat%2F0211002%2Chep-lat%2F0211015%2Chep-lat%2F0211034%2Chep-lat%2F0211038%2Chep-lat%2F0211005%2Chep-lat%2F0211018%2Chep-lat%2F0211039%2Chep-lat%2F0211012%2Chep-lat%2F0211032%2Chep-lat%2F0211016%2Chep-lat%2F0211026%2Chep-lat%2F0211042%2Chep-lat%2F0211031%2Chep-lat%2F0211011%2Chep-lat%2F0211020%2Chep-lat%2F0211037%2Chep-lat%2F0211043%2Chep-lat%2F0211028%2Chep-lat%2F0211035%2Chep-lat%2F0211001%2Chep-lat%2F0211017%2Chep-lat%2F0211021%2Chep-lat%2F0211041%2Chep-lat%2F0211040%2Chep-lat%2F0211008%2Chep-lat%2F0211003%2Chep-lat%2F0211023%2Chep-lat%2F0211010%2Chep-lat%2F0211019%2Chep-lat%2F0211025%2Chep-lat%2F0211004%2Chep-lat%2F0211022%2Chep-lat%2F0211006%2Chep-lat%2F0211027%2Chep-lat%2F0211036%2Chep-lat%2F0211007%2Chep-lat%2F0211030%2Chep-lat%2F0203029%2Chep-lat%2F0203011%2Chep-lat%2F0203006%2Chep-lat%2F0203016%2Chep-lat%2F0203024%2Chep-lat%2F0203030%2Chep-lat%2F0203027%2Chep-lat%2F0203017%2Chep-lat%2F0203009%2Chep-lat%2F0203025%2Chep-lat%2F0203023%2Chep-lat%2F0203013%2Chep-lat%2F0203010%2Chep-lat%2F0203005%2Chep-lat%2F0203028%2Chep-lat%2F0203002%2Chep-lat%2F0203019%2Chep-lat%2F0203015%2Chep-lat%2F0203018%2Chep-lat%2F0203026%2Chep-lat%2F0203014%2Chep-lat%2F0203007%2Chep-lat%2F0203020%2Chep-lat%2F0203022%2Chep-lat%2F0203021%2Chep-lat%2F0203012%2Chep-lat%2F0203008%2Chep-lat%2F0203003%2Chep-lat%2F0203001%2Chep-lat%2F0606002%2Chep-lat%2F0606022%2Chep-lat%2F0606009%2Chep-lat%2F0606006%2Chep-lat%2F0606001%2Chep-lat%2F0606003%2Chep-lat%2F0606014%2Chep-lat%2F0606020%2Chep-lat%2F0606019%2Chep-lat%2F0606012%2Chep-lat%2F0606018%2Chep-lat%2F0606007%2Chep-lat%2F0606010%2Chep-lat%2F0606005%2Chep-lat%2F0606004%2Chep-lat%2F0606016%2Chep-lat%2F0606008%2Chep-lat%2F0606013%2Chep-lat%2F0606021%2Chep-lat%2F0606017%2Chep-lat%2F0606023%2Chep-lat%2F0606011%2Chep-lat%2F0606015%2Chep-lat%2F0205018%2Chep-lat%2F0205003%2Chep-lat%2F0205002%2Chep-lat%2F0205023&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Higher Order Hybrid Monte Carlo at Finite Temperature"}, "summary": "The standard hybrid Monte Carlo algorithm uses the second order integrator at\nthe molecular dynamics step. This choice of the integrator is not always the\nbest. Using the Wilson fermion action, we study the performance of the hybrid\nMonte Carlo algorithm for lattice QCD with higher order integrators in both\nzero and finite temperature phases and find that in the finite temperature\nphase the performance of the algorithm can be raised by use of the 4th order\nintegrator.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=hep-lat%2F0108003%2Chep-lat%2F0108024%2Chep-lat%2F0211033%2Chep-lat%2F0211029%2Chep-lat%2F0211024%2Chep-lat%2F0211014%2Chep-lat%2F0211009%2Chep-lat%2F0211013%2Chep-lat%2F0211002%2Chep-lat%2F0211015%2Chep-lat%2F0211034%2Chep-lat%2F0211038%2Chep-lat%2F0211005%2Chep-lat%2F0211018%2Chep-lat%2F0211039%2Chep-lat%2F0211012%2Chep-lat%2F0211032%2Chep-lat%2F0211016%2Chep-lat%2F0211026%2Chep-lat%2F0211042%2Chep-lat%2F0211031%2Chep-lat%2F0211011%2Chep-lat%2F0211020%2Chep-lat%2F0211037%2Chep-lat%2F0211043%2Chep-lat%2F0211028%2Chep-lat%2F0211035%2Chep-lat%2F0211001%2Chep-lat%2F0211017%2Chep-lat%2F0211021%2Chep-lat%2F0211041%2Chep-lat%2F0211040%2Chep-lat%2F0211008%2Chep-lat%2F0211003%2Chep-lat%2F0211023%2Chep-lat%2F0211010%2Chep-lat%2F0211019%2Chep-lat%2F0211025%2Chep-lat%2F0211004%2Chep-lat%2F0211022%2Chep-lat%2F0211006%2Chep-lat%2F0211027%2Chep-lat%2F0211036%2Chep-lat%2F0211007%2Chep-lat%2F0211030%2Chep-lat%2F0203029%2Chep-lat%2F0203011%2Chep-lat%2F0203006%2Chep-lat%2F0203016%2Chep-lat%2F0203024%2Chep-lat%2F0203030%2Chep-lat%2F0203027%2Chep-lat%2F0203017%2Chep-lat%2F0203009%2Chep-lat%2F0203025%2Chep-lat%2F0203023%2Chep-lat%2F0203013%2Chep-lat%2F0203010%2Chep-lat%2F0203005%2Chep-lat%2F0203028%2Chep-lat%2F0203002%2Chep-lat%2F0203019%2Chep-lat%2F0203015%2Chep-lat%2F0203018%2Chep-lat%2F0203026%2Chep-lat%2F0203014%2Chep-lat%2F0203007%2Chep-lat%2F0203020%2Chep-lat%2F0203022%2Chep-lat%2F0203021%2Chep-lat%2F0203012%2Chep-lat%2F0203008%2Chep-lat%2F0203003%2Chep-lat%2F0203001%2Chep-lat%2F0606002%2Chep-lat%2F0606022%2Chep-lat%2F0606009%2Chep-lat%2F0606006%2Chep-lat%2F0606001%2Chep-lat%2F0606003%2Chep-lat%2F0606014%2Chep-lat%2F0606020%2Chep-lat%2F0606019%2Chep-lat%2F0606012%2Chep-lat%2F0606018%2Chep-lat%2F0606007%2Chep-lat%2F0606010%2Chep-lat%2F0606005%2Chep-lat%2F0606004%2Chep-lat%2F0606016%2Chep-lat%2F0606008%2Chep-lat%2F0606013%2Chep-lat%2F0606021%2Chep-lat%2F0606017%2Chep-lat%2F0606023%2Chep-lat%2F0606011%2Chep-lat%2F0606015%2Chep-lat%2F0205018%2Chep-lat%2F0205003%2Chep-lat%2F0205002%2Chep-lat%2F0205023&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The standard hybrid Monte Carlo algorithm uses the second order integrator at\nthe molecular dynamics step. This choice of the integrator is not always the\nbest. Using the Wilson fermion action, we study the performance of the hybrid\nMonte Carlo algorithm for lattice QCD with higher order integrators in both\nzero and finite temperature phases and find that in the finite temperature\nphase the performance of the algorithm can be raised by use of the 4th order\nintegrator."}, "authors": ["Tetsuya Takaishi"], "author_detail": {"name": "Tetsuya Takaishi"}, "author": "Tetsuya Takaishi", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/S0370-2693(02)02139-1", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/hep-lat/0203024v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/hep-lat/0203024v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "13 pages, 6 figures", "arxiv_primary_category": {"term": "hep-lat", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "hep-lat", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/hep-lat/0203024v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/hep-lat/0203024v2", "journal_reference": "Phys.Lett. B540 (2002) 159-165", "doi": "10.1016/S0370-2693(02)02139-1", "fulltext": "arXiv:hep-lat/0203024v2 2 Aug 2002\n\nHigher Order Hybrid Monte Carlo at Finite\nTemperature\nTetsuya Takaishi\nHiroshima University of Economics, Hiroshima 731-0192, Japan\n\nAbstract\nThe standard hybrid Monte Carlo algorithm uses the second order integrator at\nthe molecular dynamics step. This choice of the integrator is not always the best.\nUsing the Wilson fermion action, we study the performance of the hybrid Monte\nCarlo algorithm for lattice QCD with higher order integrators in both zero and finite\ntemperature phases and find that in the finite temperature phase the performance of\nthe algorithm can be raised by use of the 4th order integrator.\nPACS numbers: 12.38.Gc, 11.15.Ha\nKeywords: Lattice QCD, Hybrid Monte Carlo Algorithm\n\n1\n\n\f1\n\nIntroduction\n\nIn lattice QCD the hybrid Monte Carlo (HMC) algorithm [1] is widely used for\nsimulations of even-flavor of quarks1 . These simulations are usually difficult tasks,\nespecially at small quark masses where the computational cost of the matrix solver\nwhich is the most time consuming part of the HMC algorithm grows. In order to\nobtain reliable results within limited computer resources it is important to find an\nefficient way to implement the HMC algorithm so that the total computational cost\nof the algorithm is minimized [3].\nThe basic idea of the HMC is a combination of 1) molecular dynamics and 2)\nMetropolis test. Usually the second order leapfrog integrator is used at the molecular\ndynamics (MD) step. The integrator causes O(\u2206t3 ) integration errors, where \u2206t\ndenotes the step-size. Due to the integration errors the Hamiltonian is not conserved.\nThe errors introduced by this integrator have to be removed by the Metropolis test,\ni.e. accept the new configuration with a probability \u223c min(1, exp(\u2212\u2206H)) where\n\u2206H = Hnew \u2212 Hold is an energy difference between the starting Hamiltonian Hold\nand the new Hamiltonian Hnew at the end of the trajectory.\nThe acceptance at the Metropolis step depends on the magnitude of the energy\ndifference induced by the integration errors. If a higher order integrator is used at the\nMD step, the integration errors can be reduced. Therefore one may easily imagine\nthat the performance of the HMC increases with the higher order integrator. However\nthis is not always true since the higher order integrator has more arithmetic operations\nthan the lower one and this might decrease the performance. The total performance\nshould be measured by taking account of two effects: acceptance and the number of\narithmetic operations. In Ref.[4] the performance of the higher order integrator at\nzero temperature (\u03b2 = 0) was studied systematically and it turned out that for the\nsimulation parameters used for the current large-scale simulations with the Wilson\nfermion action the 2nd order integrator is the best one. The main reason why the\nhigher order integrators are not so effective is that the energy difference caused by\nthe errors of the higher order integrator increases more rapidly than that of the lower\none as the quark mass decreases. In Ref.[5] it is shown that at finite temperature\nthe quark mass dependence of the energy difference is small. If so, the conclusion\nof Ref.[4] might change at finite temperature. In this letter we test higher order\nintegrators at finite temperature and demonstrate that they can actually perform\nbetter than the lower order.\n1\n\nOdd-flavor simulations of the HMC algorithm are also possible by modifying the Hamiltonian [2].\n\n2\n\n\f2\n\nHigher order integrator\n\nIn this section we define higher order integrators studied here. Our definition is\nparallel to that of Ref.[4]. Let H be a Hamiltonian given by\n1\nH = p2 + S(q)\n2\n\n(1)\n\nwhere q = (q1 , q2 , ...) and p = (p1 , p2 , ...) are coordinate variables and conjugate\nmomenta respectively. S(q) is a potential term of the system considered. For the\nlattice QCD, q correspond to link variables and S(q) consists of gauge and fermion\nactions.\nIn the MD step we solve Hamilton's equations of motion,\n\uf8f1\ndqi\n\uf8f4\n\uf8f4\n\uf8f2\n\n\u2202H\n\u2202pi\n\u2202H\n=\u2212\n.\n\u2202qi\n=\n\ndt\n\ndpi\n\uf8f4\n\uf8f4\n\uf8f3\ndt\n\n(2)\n\nIn general these equations are not solvable analytically. Introducing a step-size \u2206t, the\ndiscretized version of the equations are solved. In the conventional HMC simulations\nthe 2nd order leapfrog scheme, which causes O(\u2206t3 ) step-size error, is used to solve\nthe equations. This scheme is written as\n\uf8f1\n\uf8f4\nq(t +\n\uf8f4\n\uf8f4\n\uf8f2\n\n\u2206t\n2 )\n\n= q(t) +\n\n\u2206t\n2 p(t)\n\n\u2202S(q(t + \u2206t\n2 ))\np(t\n+\n\u2206t)\n=\np(t)\n\u2212\n\u2206t\n\uf8f4\n\u2202q\n\uf8f4\n\uf8f4\n\uf8f3\n\u2206t\n)\n+\np(t\n+ \u2206t).\nq(t + \u2206t) = q(t + \u2206t\n2\n2\n\n(3)\n\nEq.(3) forms an elementary MD step. This elementary MD step is performed repeatedly N times. The trajectory length \u03c4 is given by \u03c4 = N \u00d7 \u2206t.\nAny integrator which satisfies two conditions: 1)time reversible and 2)area preserving can be used for the MD step of the HMC. These conditions are needed to\nsatisfy the detailed balance. When we use the Lie algebraic formalism [6, 7, 8, 9] we\ncan easily construct higher order integrators which satisfy the above conditions. From\nthe Lie algebraic formalism we find that higher order integrators can be constructed\nby combining lower order integrators. Let G2nd (\u2206t) be an elementary MD step of\nthe 2nd order integrator with a step-size \u2206t. The 4th order integrator G4th (\u2206t) is\nconstructed from a product of three 2nd order integrators as [6, 7, 8, 9, 10]\nG4th (\u2206t) = G2nd (a1 \u2206t)G2nd (a2 \u2206t)G2nd (a1 \u2206t),\n\n(4)\n\nwhere the coefficients ai are given by\na1 =\n\n1\n,\n2 \u2212 21/3\n\na2 = \u2212\n\n21/3\n.\n2 \u2212 21/3\n\n3\n\n(5)\n(6)\n\n\fEq.(4) means that there are three elementary MD steps: (i) first we integrate the\nequations by eq.(3) with a step-size of a1 \u2206t, (ii) then proceed the 2nd order integration with a step-size of a2 \u2206t, (iii) finally integrate the equations with a step-size of\na1 \u2206t. After performing these three elementary MD steps sequentially we obtain the\n4th order integrator with the step-size \u2206t. This construction scheme can be generalized to the higher even-order integrators. The (2k + 2)-th order integrator is given\nrecursively by\nG2k+2 (\u2206t) = G2k (b1 \u2206t)G2k (b2 \u2206t)G2k (b1 \u2206t),\n(7)\nwhere the coefficient bi are\nb1 =\n\n1\n2 \u2212 21/(2k+1)\n\n(8)\n\n21/(2k+1)\n.\n(9)\n2 \u2212 21/(2k+1)\nCompared with the 2nd order integrator, the computational cost of the n-th order\none constructed from eq.(7) grows as 3n/2\u22121 . For instance the 6th order integrator\nhas 9 times more arithmetic operations than those of the 2nd order one. Yoshida [8]\nfound three parameter sets of 6th order integrators with less arithmetic operations\n(Table.1). Yoshida's 6th order integrators consist of seven G2nd 's as\nb2 = \u2212\n\nG6th (\u2206t) = G2nd (w3 \u2206t)G2nd (w2 \u2206t)G2nd (w1 \u2206t)G2nd (w0 \u2206t)\n\u00d7G2nd (w1 \u2206t)G2nd (w2 \u2206t)G2nd (w3 \u2206t).\n\n(10)\n\nIn Ref.[4] these 6th order integrators were examined and one of three parameter sets,\ndenoted by Y 1, was found to give smaller integration errors than those of others. In\nthis study the parameter set Y 1 ( see Table.1 ) is used for the 6th order integrator.\n\nw1\nw2\nw3\n\nY1\n-0.117767998417887e-1\n0.235573213359357e+0\n0.784513610477560e+0\n\nY2\n-0.213228522200144e+1\n0.426068187079180e-2\n0.143984816797678e+1\n\nY3\n0.152886228424922e-2\n-0.214403531630539e+1\n0.144778256239930e+1\n\nTable 1: Parameter sets (Y1-Y3) of the 6th order integrators by Yoshida [8]. w0 is given by\nw0 = 1 \u2212 w1 \u2212 w2 \u2212 w3 .\n\n3\n\nEfficiency of the HMC algorithm\n\nIn order to compare among various integrators one needs a criterion which ranks\nintegrators. Following Ref.[4] we utilize the efficiency function Ef f constructed from\na product of acceptance Pacc and step-size \u2206t:\nEf f = Pacc \u2206t.\n\n4\n\n(11)\n\n\fThis function has one maximum at a certain step-size which we denote \u2206topt . Using\nthe energy difference \u2206H the acceptance is expressed by [5]\n1\nhPacc i = erfc( h\u2206Hi1/2 ),\n2\n\n(12)\n\nwhere erfc is the complementary error function. In stead of using eq.(12), when h\u2206Hi\nis small, we may use\n2 1\n(13)\nhPacc i = exp(\u2212 \u221a h \u2206H 2 i1/2 ).\n\u03c0 8\nAlthough mathematically speaking eq.(13) is valid only for h\u2206H 2 i1/2 \u226a 1, the\nnumerical study [4] shows that eq.(13) approximates the acceptance quit well for\nh\u2206H 2 i1/2 \u2264 3 which corresponds to hPacc i \u2265 20%. This is enough for our purpose\nsince typically the acceptance of the HMC is taken to be hPacc i \u2265 50%.\nIn the lowest order of \u2206t, h\u2206H 2 i1/2 of the n-th order integrator is expressed as\n[4, 5]\nh\u2206H 2 i1/2 = Cn V 1/2 \u2206tn + O(\u2206tn+1 ),\n(14)\nwhere V is volume of the system and Cn is a Hamiltonian dependent coefficient.\nSubstituting eq.(14) into eq.(13) one obtains\n1\n\nhPacc i = exp(\u2212Cen V 2 \u2206tn ),\n\n(15)\n\n\u221a\nwhere Cen \u2261 Cn / 2\u03c0. If one uses eq.(15) for eq.(11) one can easily obtain the optimal\nstep-size which gives the maximum efficiency:\n\u2206topt =\n\ns\nn\n\n1\nnCen V\n\n1\n2\n\n.\n\n(16)\n\nFurthermore substituting \u2206topt to eq.(15) one obtains the optimal acceptance2 as [4]\n1\nhPacc iopt = exp(\u2212 )\nn\n\uf8f1\n\uf8f4\n\uf8f2 0.61 2nd\n0.78 4th\n=\n\uf8f4\n\uf8f3 0.85 6th.\n\n(17)\n(18)\n\nNote that the above result does not depend on the specific Hamiltonian and can be\napplied for any model.\nUsing eq.(16) and (17) we obtain the optimal efficiency of the n-th order integrator:\nn\u2212th\n(Ef f )opt\n\ns\n\n1\n1\n= exp(\u2212 ) n\n1 ,\ne\nn\nn Cn V 2\n\n(19)\n\n2\nA recent study [11] shows that if one considers higher order effects of \u2206t the optimal acceptance might\nbe slightly changed. In the current study we omit this small effect.\n\n5\n\n\fWe use eq.(19) to compare among integrators. Eq.(19) is easy to handle because\neq.(19) has one unknown parameter Cen and the value of Cen can be estimated easily\nfrom a single simulation on a rather small lattice.\nNow let us compare n-th and m-th order integrators (n > m). If one obtains a\ngain G for the n-th order integrator over the m-th order one, the following condition\nmust be satisfied:\nn\u2212th\n(Ef f )opt\n= Gknm (Ef f )m\u2212th\n(20)\nopt ,\nwhere knm is a relative cost factor needed to implement the n-th order integrator\nagainst the m-th one and G is defined so that both n-th and m-th order integrators\nare equally effective with G = 1. In our case, k42 = 3 and k64 = 7/3. Substituting\neq.(19) to eq.(20) and rewriting the equation one obtains the lattice volume needed\nto have the gain G:\nV\n\nn m\n\u22122\n2\n\n1\n1\n= (Gknm exp(\u2212 + ))nm\nm n\n\n1\nmCem\n\n!n\n\n(nCen )m .\n\n(21)\n\nOur formulas are based on the assumption that h\u2206H 2 i1/2 satisfies eq.(14). The\nvalidity of eq.(14) depends on the action we take and simulation parameters. In\ngeneral it is expected that the contribution of the higher order terms to eq.(14)\nbecomes small as the lattice size increases. Let us rewrite eq.(14) as\nh\u2206H 2 i1/2 = Cn V 1/2 \u2206tn + Cn+1 V 1/2 \u2206tn+1 ,\n\n(22)\n\nwhere Cn+1 V 1/2 \u2206tn+1 stands for the first relevant higher order term. We measure\nthe contribution of the higher order term by the ratio:\nCn+1\nCn+1 V 1/2 \u2206tn+1\n\u2206t.\n=\n1/2\nn\nCn\nCn V \u2206t\n\n(23)\n\nIn order to keep the constant acceptance, \u2206t must be taken to be small as the lattice\nsize increases. Thus eq.(23), ie. the contribution of the higher order term, becomes\nsmall for larger lattices.\nFig.1 shows a typical example of Cn on a 163 \u00d7 4 lattice as a function of \u2206t.\nh\u2206H 2 i1/2 are well expressed by the functions proportional to \u2206tn except for large\n\u2206t. We are only interested in the acceptance region indicated by eq.(18): Pacc \u2265 60%\nwhich corresponds to h\u2206H 2 i1/2 \u2264 13 . It seems that for h\u2206H 2 i1/2 \u2264 1 the effect of\nthe higher order terms is small.\n\n4\n\nSimulation results\n\nWe use the plaquette gauge action and standard Wilson fermion action with two\nflavors of degenerate quarks (nf = 2). We first determine the coefficients Cn at zero\n3\n\nSee Fig.1 in [4].\n\n6\n\n\fand finite temperature. This can be done by measuring h\u2206H 2 i1/2 at a small step-size\nand substituting the results into eq.(14). The trajectory length \u03c4 is set to 1. We\nchoose \u03b2 = 5.75 and make simulations on both 124 and 123 \u00d7 4 lattices. The critical\nkappa \u03bac of nf = 2 at this \u03b2 is around 0.1574 . We use several \u03ba's in a range of\n0.1 \u2264 \u03ba \u2264 0.155. In this range we maintain the confinement phase on the 124 lattice\nand the deconfinement phase on the 123 \u00d7 4 lattice. In this study we refer to the\nresults on the 124 (123 \u00d7 4) lattice as those at zero(finite) temperature.\nFigs.2-4 show Cn as a function of mq a. Here mq a is defined by mq a = (1/\u03ba \u2212\n1/\u03bac )/2. At large quark masses where the fermionic effects are negligible, values of\nCn at zero and finite temperature coincide each other. This may indicate that the\ncontribution to Cn from the gauge sector is almost same at zero and finite temperature. At small quark masses Cn at zero temperature increases more rapidly than\nthose at finite temperature as mq a decreases. The quark mass dependence of Cn at\nfinite temperature, compared to that at zero temperature, is small for all the integrators studied here. This behavior is consistent with the result of Ref.[5]. Substituting\nvalues of Cn at finite temperature into eq.(21) with G = 1, we calculate the lattice\nsize Le ( here V = L3e \u00d7 Nt ). This lattice size Le is the one with which the higher\norder integrator and the lower order one perform equally. For a lattice size L > Le\nthe higher order integrator is more effective than the lower one. Fig.5 shows Le from\ncomparison between the 2nd and 4th order integrators (2nd vs. 4th) and between\nthe 4th and 6th order ones (4th vs. 6th). For the case of 4th vs. 6th, Le increases\nas mq a decreases, which we do not appreciate. On the other hand for the 2nd vs.\n4th, Le remains less than 20 even at small mq a. This result is contrast to that obtained at zero temperature where Le increases as mq a decreases [4]. The above result\nencourages us to use the 4th order integrator at finite temperature.\nThe results in Fig.5, however, just show the lattice on which the both integrators\nare equally effective. To use the higher order integrator in simulations one must\nobtain some gain over the lower order one. In Fig.6, using eq.(21), we show the\nexpected gain ( the region between the solid lines ) at \u03ba = 0.1525(mq a \u2248 0.094) as a\nfunction of lattice size L. To have G = 2 gain ( which means 2 times faster ) a lattice\nsize L \u2248 100 is required. This huge lattice size is still not accessible in the current\nlarge-scale simulations. Probably the maximum lattice size accessible at the moment\nis L \u2264 50. Therefore we can not expect a large gain from the 4th order integrator\neven if it is used now. If we use a lattice with L \u2248 50, G \u2248 1.5 can be achieved. Thus\nat the level of the current large-scale simulations, we expect to obtain G \u2264 1.5.\nWe also make simulations at \u03ba = 0.1525 to confirm that we can actually obtain\nsome gain for the 4th order integrator over the 2nd one. At \u03ba = 0.1525, Le is\nestimated to be 17.5(9). We choose 183 \u00d7 4 and 283 \u00d7 4 lattices. On the 183 \u00d7 4 lattice\nwe expect G \u2248 1 and on the 283 \u00d7 4 lattice, G > 1. The step-size is adjusted so that\n4\n\nThis value is estimated from Figure 5 in Ref.[12]\n\n7\n\n\f\u03ba = 0.1525\n\u2206t\nAcceptance\n\n183 \u00d7 4\n2nd\n4th\n1/24\n1/10\n0.57(2) 0.81(2)\n\n283 \u00d7 4\n2nd\n4th\n1/36\n1/12\n0.60(3) 0.81(3)\n\nTable 2: Step-size and acceptance at \u03ba = 0.1525.\n\nthe acceptance gives a similar value with eq.(18). The gain G is calculated by\nG=\n\n(Pacc \u00d7 \u2206t)4th\n,\n3(Pacc \u00d7 \u2206t)2nd\n\n(24)\n\nwhere a factor of 3 in the denominator comes from the relative cost factor k42 = 3.\nTable 2 shows the simulation results. Using these results, we obtain G = 1.08(3) on\nthe 183 \u00d7 4 lattice and G = 1.35(8) on the 283 \u00d7 4 lattice (see also Fig.6). As expected\nthe gain increases with L. The result on the 283 \u00d7 4 lattice is an example showing\nthat the 4th order integrator is more effective than the 2nd order one.\n\n5\n\nConclusions\n\nWe have studied higher order integrators for the HMC algorithm with the Wilson\nfermion action at finite temperature. Contrast to the zero temperature case, the 4th\norder integrator at finite temperature can be more effective than the 2nd order one.\nThis was demonstrated by the simulations at \u03b2 = 5.75 on L3 \u00d7 4 lattices. The gain\nis dependent of the lattice size. It was shown that on the 283 \u00d7 4 lattice at \u03b2 = 5.75\nand \u03ba = 0.1525 the 4th order integrator is about 35% faster than the 2nd order one.\nWhen large-scale simulations at finite temperature are planned, it is recommended\nto check which integrator is effective for the lattice considered. This check can be done\neasily. First we measure C2 and C4 . This first step does not take much computational\ntime since they can be measured on a small lattice. Then substituting values of C2\nand C4 to eq.(21), we obtain a relation between G and L. If we obtain G > 1 on the\nlattice planned for the simulations, we should consider to use the 4th order integrator.\nEq.(21) is obtained by using the approximation at small \u2206t. There might exist\nthe systematic errors caused by the approximation. Although for the present study\nwe considered the errors to be small, for other actions and simulation parameters\nthey might contribute largely. We have to keep in mind that there might exist such\ncontributions depending on the simulation details.\n\nAcknowledgments\nThe simulations were done on the NEC SX-5 at INSAM Hiroshima University and\nat Yukawa Institute. The author would like to thank Atsushi Nakamura for use-\n\n8\n\n\fful discussion and comments. This work was supported by the Grant in Aid for\nScientific Research by the Ministry of Education, Culture, Sports, Science and Technology(No.13740164).\n\nReferences\n[1] S.Duane, A.D.Kennedy, B.J.Pendleton and D.Roweth, Phys. Lett. B195 (1987)\n216; S.Gottlieb, W.Liu, D.Toussaint, R.L.Renken and R.L.Sugar, Phys. Rev. D 35\n(1987) 2531\n[2] T. Takaishi and Ph. de Forcrand, Int. J. Mod. Phys. C13 (2002) 343; heplat/0108012\n[3] For recent studies on this subject see e.g., M. Peardon, Nucl. Phys. B (Proc.\nSuppl.) 106 (2002) 3\n[4] T. Takaishi, Comput. Phys. Commun. 133 (2000) 6\n[5] S.Gupta, A.Irb\u00e4ck, F.Karch and B.Petersson, Phys. Lett. B242 (1990) 437\n[6] J.C.Sexton and D.H.Weingarten, Nucl. Phys. B380 (1992) 665\n[7] M.Creutz and A.Gocksch, Phys. Rev. Lett. 63 (1989) 9\n[8] H.Yoshida, Phys. Lett. A150 (1990) 262\n[9] M.Suzuki, Phys. Lett. A146 (1990) 319\n[10] M.Campostrini and P.Rossi, Nucl. Phys. B329 (1990) 753\n[11] JLQCD Collaboration: S. Aoki et. al, Phys.Rev. D65 (2002) 094507\n[12] Y. Iwasaki, K. Kanaya, S. Kaya, S. Sakai and T. Yoshie, Phys. Rev. D 54 (1996)\n7010\n\n9\n\n\f10\n\n<\u2206\u0397 >\n\n2 1/2\n\n10\n\n2nd\n4th\n6th\n2\n\u2206t\n4\n\u2206t\n6\n\u2206t\n\n2\n\n0\n\n-2\n\n10\n\n-4\n\n10\n\n0.01\n\n0.1\n\n\u2206t\n\nFigure 1: h\u2206H 2 i1/2 on a 163 \u00d7 4 lattice at \u03b2 = 5.75 and \u03ba = 0.155 as a function of \u2206t.\nThe lines proportional to \u2206tn are also drawn. The simulations were done with the Wilson\nfermion action.\n\n3\n4\n\n12\n3\n12 \u00d74\n\n2\n\nC2/(2\u03c0)\n\n1/2\n\n2nd\n\n1\n0.01\n\n0.1\n\nmqa\n\n1\n\n10\n\nFigure 2: C2 as a function of the quark mass mq a. In the figure, C2 is normalized as\nC2 /(2\u03c0)1/2 \u2261 C\u03032 .\n10\n\n\f10\n\n3\n\n10\n\n4\n\n12\n3\n12 \u00d74\n\n2\n\nC4/(2\u03c0)\n\n1/2\n\n4th\n\n10\n\n1\n\n0\n\n10 0.01\n\n0.1\n\nmqa\n\n1\n\n10\n\nFigure 3: Same as in Fig.2 but for C4 .\n\n10\n\n4\n\n6th\n3\n\nC6/(2\u03c0)\n\n1/2\n\n10\n\n4\n\n12\n3\n12 \u00d74\n\n10\n\n2\n\n10\n10\n\n1\n\n0\n\n0.01\n\n0.1\n\nmqa\n\n1\n\nFigure 4: Same as in Fig.2 but for C6 .\n\n11\n\n10\n\n\f60\n2nd vs 4th\n4th vs 6th\n\n50\n\nLe\n\n40\n30\n20\n10\n0.01\n\n0.1 m a\nq\n\n1\n\nFigure 5: Le as a function of the quark mass mq a. Le stands for the lattice size for\nwhich the higher order integrator and the lower order one are equally effective. Circles are\nfrom comparison between the 2nd order integrator and the 4th order one, and squares are\ncomparison between the 4th order integrator and the 6th order one.\n\n12\n\n\f2\n\n\u03ba=0.1525\n\nG\n\n1.5\n\n1\n0\n\n100\n\n50\nL\n\nFigure 6: The gain G as a function of L ( here V = L3 \u00d7 4 ) at \u03ba = 0.1525. The solid\nlines are calculated from eq.(21). Circles are from Monte Carlo simulations.\n\n13\n\n\f"}