{"id": "http://arxiv.org/abs/0912.1710v1", "guidislink": true, "updated": "2009-12-09T11:26:21Z", "updated_parsed": [2009, 12, 9, 11, 26, 21, 2, 343, 0], "published": "2009-12-09T11:26:21Z", "published_parsed": [2009, 12, 9, 11, 26, 21, 2, 343, 0], "title": "Deterministic Partial Differential Equation Model for Dose Calculation\n  in Electron Radiotherapy", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0912.0037%2C0912.3352%2C0912.2390%2C0912.4039%2C0912.0567%2C0912.4260%2C0912.2549%2C0912.4721%2C0912.5093%2C0912.2925%2C0912.2362%2C0912.4959%2C0912.2456%2C0912.4049%2C0912.5242%2C0912.4618%2C0912.1920%2C0912.3624%2C0912.3953%2C0912.0763%2C0912.2851%2C0912.2313%2C0912.0302%2C0912.2308%2C0912.4175%2C0912.1875%2C0912.3622%2C0912.0367%2C0912.2873%2C0912.4373%2C0912.4656%2C0912.3999%2C0912.4040%2C0912.1079%2C0912.3543%2C0912.0598%2C0912.4828%2C0912.5352%2C0912.0071%2C0912.2363%2C0912.2902%2C0912.4449%2C0912.1718%2C0912.1077%2C0912.4603%2C0912.0483%2C0912.0898%2C0912.2036%2C0912.0116%2C0912.1710%2C0912.3715%2C0912.2347%2C0912.0348%2C0912.0031%2C0912.1291%2C0912.3163%2C0912.4577%2C0912.2451%2C0912.5193%2C0912.3645%2C0912.3997%2C0912.1564%2C0912.1404%2C0912.2557%2C0912.0448%2C0912.2950%2C0912.0983%2C0912.3024%2C0912.0154%2C0912.4842%2C0912.2610%2C0912.3934%2C0912.5381%2C0912.2294%2C0912.0712%2C0912.3067%2C0912.3395%2C0912.1439%2C0912.1821%2C0912.2751%2C0912.1885%2C0912.0090%2C0912.3596%2C0912.5099%2C0912.4713%2C0912.0569%2C0912.0543%2C0912.5208%2C0912.3946%2C0912.3358%2C0912.3223%2C0912.1787%2C0912.5059%2C0912.4184%2C0912.3087%2C0912.4079%2C0912.5519%2C0912.2563%2C0912.0691%2C0912.0409%2C0912.2055&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Deterministic Partial Differential Equation Model for Dose Calculation\n  in Electron Radiotherapy"}, "summary": "Treatment with high energy ionizing radiation is one of the main methods in\nmodern cancer therapy that is in clinical use. During the last decades, two\nmain approaches to dose calculation were used, Monte Carlo simulations and\nsemi-empirical models based on Fermi-Eyges theory. A third way to dose\ncalculation has only recently attracted attention in the medical physics\ncommunity. This approach is based on the deterministic kinetic equations of\nradiative transfer. Starting from these, we derive a macroscopic partial\ndifferential equation model for electron transport in tissue. This model\ninvolves an angular closure in the phase space. It is exact for the\nfree-streaming and the isotropic regime. We solve it numerically by a newly\ndeveloped HLLC scheme based on [BerCharDub], that exactly preserves key\nproperties of the analytical solution on the discrete level. Several numerical\nresults for test cases from the medical physics literature are presented.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0912.0037%2C0912.3352%2C0912.2390%2C0912.4039%2C0912.0567%2C0912.4260%2C0912.2549%2C0912.4721%2C0912.5093%2C0912.2925%2C0912.2362%2C0912.4959%2C0912.2456%2C0912.4049%2C0912.5242%2C0912.4618%2C0912.1920%2C0912.3624%2C0912.3953%2C0912.0763%2C0912.2851%2C0912.2313%2C0912.0302%2C0912.2308%2C0912.4175%2C0912.1875%2C0912.3622%2C0912.0367%2C0912.2873%2C0912.4373%2C0912.4656%2C0912.3999%2C0912.4040%2C0912.1079%2C0912.3543%2C0912.0598%2C0912.4828%2C0912.5352%2C0912.0071%2C0912.2363%2C0912.2902%2C0912.4449%2C0912.1718%2C0912.1077%2C0912.4603%2C0912.0483%2C0912.0898%2C0912.2036%2C0912.0116%2C0912.1710%2C0912.3715%2C0912.2347%2C0912.0348%2C0912.0031%2C0912.1291%2C0912.3163%2C0912.4577%2C0912.2451%2C0912.5193%2C0912.3645%2C0912.3997%2C0912.1564%2C0912.1404%2C0912.2557%2C0912.0448%2C0912.2950%2C0912.0983%2C0912.3024%2C0912.0154%2C0912.4842%2C0912.2610%2C0912.3934%2C0912.5381%2C0912.2294%2C0912.0712%2C0912.3067%2C0912.3395%2C0912.1439%2C0912.1821%2C0912.2751%2C0912.1885%2C0912.0090%2C0912.3596%2C0912.5099%2C0912.4713%2C0912.0569%2C0912.0543%2C0912.5208%2C0912.3946%2C0912.3358%2C0912.3223%2C0912.1787%2C0912.5059%2C0912.4184%2C0912.3087%2C0912.4079%2C0912.5519%2C0912.2563%2C0912.0691%2C0912.0409%2C0912.2055&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Treatment with high energy ionizing radiation is one of the main methods in\nmodern cancer therapy that is in clinical use. During the last decades, two\nmain approaches to dose calculation were used, Monte Carlo simulations and\nsemi-empirical models based on Fermi-Eyges theory. A third way to dose\ncalculation has only recently attracted attention in the medical physics\ncommunity. This approach is based on the deterministic kinetic equations of\nradiative transfer. Starting from these, we derive a macroscopic partial\ndifferential equation model for electron transport in tissue. This model\ninvolves an angular closure in the phase space. It is exact for the\nfree-streaming and the isotropic regime. We solve it numerically by a newly\ndeveloped HLLC scheme based on [BerCharDub], that exactly preserves key\nproperties of the analytical solution on the discrete level. Several numerical\nresults for test cases from the medical physics literature are presented."}, "authors": ["Roland Duclous", "Bruno Dubroca", "Martin Frank"], "author_detail": {"name": "Martin Frank"}, "author": "Martin Frank", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1088/0031-9155/55/13/018", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0912.1710v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0912.1710v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "20 pages, 7 figures", "arxiv_primary_category": {"term": "physics.med-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.med-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0912.1710v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0912.1710v1", "journal_reference": "Phys. Med. Biol. 55 (2010) 3843-3857", "doi": "10.1088/0031-9155/55/13/018", "fulltext": "arXiv:0912.1710v1 [physics.med-ph] 9 Dec 2009\n\nDeterministic Partial Differential Equation Model for\nDose Calculation in Electron Radiotherapy\nRoland Duclous\u2217\n\nBruno Dubroca\u2020\n\nMartin Frank\u2021\n\nOctober 24, 2018\n\nAbstract\nTreatment with high energy ionizing radiation is one of the main methods in modern\ncancer therapy that is in clinical use. During the last decades, two main approaches to dose\ncalculation were used, Monte Carlo simulations and semi-empirical models based on FermiEyges theory. A third way to dose calculation has only recently attracted attention in the\nmedical physics community. This approach is based on the deterministic kinetic equations of\nradiative transfer. Starting from these, we derive a macroscopic partial differential equation\nmodel for electron transport in tissue. This model involves an angular closure in the phase\nspace. It is exact for the free-streaming and the isotropic regime. We solve it numerically\nby a newly developed HLLC scheme based on [8], that exactly preserves key properties of\nthe analytical solution on the discrete level. Several numerical results for test cases from the\nmedical physics literature are presented.\n\n1 Introduction\nMathematical methods play an increasing role in medicine, especially in radiation therapy. Several special journal issues have been devoted to cancer modeling and treatment, cf. [4, 5, 6, 12]\namong others.\nTogether with surgery and chemotherapy, the use of ionizing radiation is one of the main\ntools in the therapy of cancer. The aim of radiation treatment is to deposit enough energy in\ncancer cells so that they are destroyed. On the other hand, healthy tissue around the cancer cells\nshould be harmed as little as possible. Furthermore, some regions at risk, like the spinal chord,\nshould receive a dose below a certain threshold.\n\u2217\n\nCELIA\n&\nIMB\nLaboratories,\nBordeaux\nUniversity,\n33405\nTalence,\nFrance,\nduclous@celia.u-bordeaux1.fr\n\u2020 CELIA & IMB Laboratories, Bordeaux University, 33405 Talence, France, dubroca@math.u-bordeaux1.fr\n\u2021 RWTH Aachen University, Department of Mathematics & Center for Computational Engineering Science\nSchinkelstr. 2, 52062 Aachen, Germany, frank@mathcces.rwth-aachen.de\n\n1\n\n\fMost dose calculation algorithms in clinical use rely on the Fermi\u2013Eyges theory of radiation\nwhich is insufficient at inhomogenities, e.g. the lung. This work, on the other hand, starts with a\nBoltzmann transport model for the radiation which accurately describes all physical interactions.\nUntil recently, dose calculation using a Boltzmann transport equation has not attracted much\nattention in the medical physics community. This access is based on deterministic transport\nequations of radiative transfer. Similar to Monte Carlo simulations it relies on a rigorous model\nof the physical interactions in human tissue that can in principle be solved exactly. Monte Carlo\nsimulations are widely used, but it has been argued that a grid-based Boltzmann solution should\nhave the same computational complexity [9]. Electron and combined photon and electron radiation were studied in the context of inverse therapy planning, cf. [35, 34] and most recently [36].\nA consistent model of combined photon and electron radiation was developed [22] that includes\nthe most important physical interactions. Furthermore, several neutral particle codes have been\napplied to the dose calculation problem, see [19] for a review and most recently [38].\nIn this paper, we want to study a macroscopic approximation to the mesoscopic transport\nequation. After the problem formulation in section 2, we derive the approximation of the macroscopic model in section 3. This approximation consists of a system of nonlinear hyperbolic partial differential equations, whose properties we briefly discuss. Due to the possibility of shock\nsolutions, hyperbolic PDEs have to be solved with great care. In section 5, we introduce a scheme\nwhich is adapted to the problem at hand. Numerical results for tests from the medical physics\nliterature are presented in section 6.\n\n2 A deterministic model for dose calculation\nA ray of high energy electrons that interacts with human tissue is subject to elastic scattering\nprocesses and inelastic ones. It is this latter process that leads to energy deposition in the tissue\ni.e. to absorbed dose.\nTo formulate a transport equation for electrons we study their fluence in phase space. Let\n\u03c8 (r, \u03b5 , \u03a9) cos \u0398dAd\u03a9d \u03b5 dt be the number of electrons at position r -r being a vector in 2D or 3D\nspace- that move in time dt through area dA into the element of solid angle d\u03a9 around \u03a9 with\nan energy in the interval (\u03b5 , \u03b5 + d \u03b5 ). The angle between direction \u03a9 and the outer normal of dA\nis denoted by \u0398. The kinetic energy \u03b5 of the electrons is measured in units of me c2 , where me is\nthe electron mass and c is the speed of light.\n\n2\n\n\f2.1 Boltzmann transport equation\nThe transport equation can generally be formulated as [14]\n\u03a9 * \u2207\u03c8 (r, \u03b5 , \u03a9) = \u03c1in(r)\n+ \u03c1el (r)\n\u2212\n\u2212\n\nZ\u221e Z\n\n\u03c3in (\u03b5 \u2032 , \u03b5 , \u03a9\u2032 * \u03a9)\u03c8 (r, \u03b5 \u2032, \u03a9\u2032 )d\u03a9\u2032 d \u03b5 \u2032\n\n\u03b5 S2\n\nZ\n\n\u03c3el (r, \u03b5 , \u03a9\u2032 * \u03a9)\u03c8 (r, \u03b5 , \u03a9\u2032)d\u03a9\u2032\n\nS2\n\u03c1in(r)\u03c3intot (\u03b5 )\u03c8 (r, \u03b5 , \u03a9)\n\u03c1el (r)\u03c3eltot (r, \u03b5 )\u03c8 (r, \u03b5 , \u03a9),\n\n(1)\n\nfor inelastic scattering,\nand \u03c3el the difwith \u03c3in being the differential scattering cross section\nR\nR\nferential cross section for elastic scattering; \u03c3intot = S2 \u03c3in d\u03a9 and \u03c3eltot = S2 \u03c3el d\u03a9 are the total\ncross sections for inelastic and elastic scattering, respectively; \u03c1in and \u03c1el are the densities of the\nrespective scattering centers.\nExplicit formulas for the cross sections that we used in this model can be found in section\n2.3. They are based on the model developed in [22]. The energy integration is performed over\n(\u03b5 , \u221e) since the electrons lose energy in every scattering event. Also, we consider only electron\nradiation. Equation (1) could also be used to model electrons which are generated by the interactions of photons with matter, as in [22]. In this case we would have an additional source term\non the right hand side for the generated electrons.\nBesides the transport equation one needs an equation for the absorbed dose. It was derived\nin [22] as an asymptotic limit of a model with a finite lower energy bound \u03b5s > 0. The formula\nis exact if one chooses the lower energy limit \u03b5s = 0, as we do here.\nT\nD(r) =\n\u03c1 (r)\n\nZ \u221e\n0\n\nwith\n\n\u03c8\n\n(0)\n\n(r, \u03b5 ) :=\n\nS(r, \u03b5 \u2032)\u03c8 (0) (r, \u03b5 \u2032 )d \u03b5 \u2032\n\nZ\n\n(2)\n\n\u03c8 (r, \u03b5 , \u03a9\u2032 )d\u03a9\u2032 ,\n\nS2\n\nT being the duration of the irradiation of the patient and \u03c1 the mass density of the irradiated\ntissue. If all quantities are calculated in SI units, equation (2) leads to SI units J/kg or Gray (Gy)\nfor the dose.\nS is the stopping power related to the inelastic cross section. It is defined as\nS(r, \u03b5 ) = \u03c1in (r)\n\nZ\u03b5\n\n\u03b5 \u2032 \u03c3in (\u03b5 , \u03b5 \u2032 )d \u03b5 \u2032 .\n\n0\n\n2.2 Continuous slowing-down approximation\nElectron transport in tissue has very distinctive properties. The soft collision differential scattering cross sections have a pronounced maximum for small scattering angles and small energy loss.\n3\n\n\fThis allows for a simplification of the scattering terms in the Boltzmann equation. The FokkerPlanck equation is the result of an asymptotic analysis for both small energy loss and small\ndeflections. It has been rigorously derived in [31] and has been applied to the above Boltzmann\nmodel in [22]. However, some electrons will also experience hard collisions with large changes\nin direction and energy losses which have to be described by Boltzmann integral terms. Thus\nwe only use an asymptotic analysis to describe energy loss, called continuous slowing-down\napproximation. This approximation has a greater domain of validity than the Fokker-Planck approximation. The Boltzmann equation in continuous slowing-down approximation (BCSD) is\n[25]\n\u03a9 * \u2207\u03c8 (r, \u03b5 , \u03a9) = \u03c1in (r)\n\nZ\n\n\u03c3inCSD (\u03b5 , \u03a9\u2032 * \u03a9)\u03c8 (r, \u03b5 , \u03a9\u2032)d\u03a9\u2032\n\n+ \u03c1el (r)\n\nZ\n\n\u03c3el (r, \u03b5 , \u03a9\u2032 * \u03a9)\u03c8 (r, \u03b5 , \u03a9\u2032)d\u03a9\u2032\n\nS2\n\nS2\n\n\u2212 \u03c1in (r)\u03c3in,tot (\u03b5 )\u03c8 (r, \u03b5 , \u03a9)\n\u2212 \u03c1el (r)\u03c3el,tot (r, \u03b5 )\u03c8 (r, \u03b5 , \u03a9)\n\u2202\n+\n(S(r, \u03b5 )\u03c8 (r, \u03b5 , \u03a9))\n\u2202\u03b5\nwith\n\n\u03c3inCSD =\n\nZ \u221e\n0\n\n(3)\n\n\u03c3in (\u03b5 , \u03b5 \u2032 , \u03bc )d \u03b5 \u2032 .\n\nA truncation in the energy space is introduced, that does not allow particles with arbitrary high\nenergy,\nlim \u03c8 (r, \u03b5 , \u03a9) = 0.\n(4)\n\u03b5 \u2192\u221e\n\nIn the numerical simulations, we use a sufficiently large cutoff energy. Furthermore, we prescribe\nthe ingoing radiation at the spatial boundary,\n\n\u03c8 (r, \u03b5 , \u03a9) = \u03c8b (r, \u03b5 , \u03a9) for n * \u03a9 < 0,\n\n(5)\n\nwhere n is the unit outward normal vector.\n\n2.3 Modeling of Scattering Cross Sections\n2.3.1 Henyey-Greenstein Scattering Theory\nThe detailed interactions of electrons with atoms give rise to complicated explicit formulas for\nthe scattering coefficients. Because of this, many studies use the simplified Henyey-Greenstein\nscattering kernel for elastic scattering [2],\n1 \u2212 g2\n.\n(6)\n4\u03c0 (1 + g2 \u2212 2g\u03bc )3/2\nThe parameter g, which can depend on r, is the average cosine of the scattering angle and is\na measure for the anisotropy of the scattering. The case where g \u2264 1 matches an anisotropic\nscattering configuration.\n\n\u03c3HG,g (\u03bc ) =\n\n4\n\n\f2.3.2 Mott and M\u00f8ller Scattering\nA more realistic model for elastic and inelastic scattering of electrons in tissue has been developed in [22]. This model introduces material parameters (namely densities \u03c1e and \u03c1c , ionization\nenergy \u03b5B and effective atomic charge Z). The energy integration for inelastic scattering is cut-off\nat \u03b5B .\nThe model uses the Mott scattering formula for elastic scattering of an electron by an ion\n[29, 26]\n\u0015\n\u0014\n\u03b5 (\u03b5 + 2) 2 \u03b8\nZ 2 (r)re2 (1 + \u03b5 )2\n\u2032\n,\n1\u2212\nsin\n\u03c3Mott (r, \u03b5 , \u03a9 * \u03a9) =\n4[\u03b5 (\u03b5 + 2)]2 (1 + 2\u03b7 (r, \u03b5 ) \u2212 cos \u03b8 )2\n(1 + \u03b5 )2\n2\nwith \u03b8 = arccos(\u03a9\u2032 * \u03a9), and \u03b5 is the outcoming electron energy in me c2 units. Here, \u03b1 \u2248 1/137\nis the fine structure constant, Z is the atomic number of the irradiated medium, re is the classical\nelectron radius. Z depends on r to account for heterogeneous media. To avoid an otherwise\noccurring singularity at \u03b8 = 0 a screening parameter\n\n\u03b7 (r, \u03b5 ) =\n\n\u03c0 2 \u03b1 2 Z 2/3 (r)\n,\n\u03b5 (\u03b5 + 2)\n\ncan be introduced [39] that models the screening effect of the electrons of the atomic shell,\ndenoted by a.\nThe inelastic scattering process is M\u00f8ller scattering, where an electron impinges an atom that\nreleases itself an additional electron\ne\u2212 + a \u2192 a+ + 2 e\u2212\nFor this process, the electrons can be considered indistinguishable. The electron which has the\nhigher energy after the collision is called primary electron, the other electron secondary. Due\nto kinematical reasons of the scattering processes the range of solid angles in M\u00f8ller scattering\nis restricted. After the collision, the angle between the directions of the electrons is at most\n\u03c0 /2. For an angle in [0, \u03c0 /4], the electron with energy \u03b5 is the primary electron, for an angle in\n[\u03c0 /4, \u03c0 /2], it is the secondary electron. Therefore the M\u00f8ller cross section can be written as\n\n\u03c3M = \u03c3\u0303M \u03c7{0<\u03a9*\u03a9\u2032 <\u221a2/2} + \u03c3\u0303M,\u03b4 \u03c7{\u221a2/2<\u03a9*\u03a9\u2032 <1} ,\nwhere \u03c7 denotes the characteristic function of a set,\n\n\u03c3\u0303M (\u03b5 \u2032 , \u03b5 , \u03a9\u2032 * \u03a9) = \u03c3M (\u03b5 \u2032 , \u03b5 )\u03b4M (\u03bc , \u03bc p )\n\n1\n,\n2\u03c0\n\n\u03bc = \u03a9\u2032 * \u03a9,\n\nis the M\u00f8ller differential cross section of primary electrons and\n\n\u03c3\u0303M,\u03b4 (\u03b5 \u2032 , \u03b5 , \u03a9\u2032 * \u03a9) = \u03c3M (\u03b5 \u2032 , \u03b5 )\u03b4M,\u03b4 (\u03bc , \u03bc\u03b4 )\n5\n\n1\n,\n2\u03c0\n\n\u03bc = \u03a9\u2032 * \u03a9,\n\n\fis the M\u00f8ller differential cross section of secondary electrons. Here,\n\u0015\n\u0014\n1\n2\u03c0 re2 (\u03b5 \u2032 + 1)2 1\n1\n2\u03b5 \u2032 + 1\n\u2032\n,\n+\n\u03c3M (\u03b5 , \u03b5 ) =\n+\n\u2212\n\u03b5 \u2032 (\u03b5 \u2032 + 2)\n\u03b5 2 (\u03b5 \u2032 \u2212 \u03b5 )2 (\u03b5 \u2032 + 1)2 (\u03b5 \u2032 + 1)2 \u03b5 (\u03b5 \u2032 \u2212 \u03b5 )\nand\n\n\u03b4M (\u03bce , \u03bc p ) = \u03b4\n\u03b4M,\u03b4 (\u03bce , \u03bc\u03b4 ) = \u03b4\n\n!\n\u03b5 \u03b5\u2032 + 2\n( \u03b5 \u2032 \u2212 \u03b5B )\n,\nfor\n,\n\u03bce \u2212\n\u03b5\n>\n\u03b5\u2032 \u03b5 + 2\n2\n!\nr\n\u03b5 \u03b5\u2032 + 2\n( \u03b5 \u2032 \u2212 \u03b5B )\n,\n.\n\u03bce \u2212\n\u03b5\n<\n\u03b5\u2032 \u03b5 + 2\n2\nr\n\nIn the simulations the model parameters \u03c1el , \u03c1in , \u03b5B and Z are fitted to tabulated values taken\nfrom the database of the PENELOPE Monte Carlo code [32].\n\n3 Partial Differential Equation Model\nWe will try to reduce the cost of solving system (1) by assuming a minimum entropy principle\nfor the angle distribution of particles. This principle has been first proposed by Jaynes [24] as\na method to select the most likely state of a thermodynamical system having only incomplete\ninformation. It has subsequently been developed in [28], [27], [1] and [15], among others, and\nhas become the main concept of rational extended thermodynamics [30]. A full account and an\nexhaustive list of references on the historical development can be found in [21].\nWe define the first three moments in angle:\n\n\u03c8\n\n(0)\n\n(r, \u03b5 ) =\n\n\u03c8 (1) (r, \u03b5 ) =\n\u03c8 (2) (r, \u03b5 ) =\n\nZ\n\nZS\nZS\n\n2\n\n2\n\nS2\n\n\u03c8 (r, \u03b5 , \u03a9)d\u03a9,\n\n(7)\n\n\u03a9\u03c8 (r, \u03b5 , \u03a9)d\u03a9,\n\n(8)\n\n(\u03a9 \u2297 \u03a9)\u03c8 (r, \u03b5 , \u03a9)d\u03a9,\n\n(9)\n\nwhere we note that \u03c8 (0) is a scalar, \u03c8 (1) is a vector and \u03c8 (2) is a tensor.\nIf we integrate the system (3) over \u03a9, we can derive the following equations,\n\u2207x \u03c8 (1) =\n\n\u2202\n(S\u03c8 (0) ),\n\u2202\u03b5\n\n(10a)\n\n\u2202\n(S\u03c8 (1) ).\n\u2202\u03b5\n\n(10b)\n\n(1 \u2212 \u03bc )\u03c3in (\u03b5 , \u03b5 \u2032 , \u03bc )d \u03bc d \u03b5 \u2032 ,\n\n(11)\n\n\u2207x \u03c8 (2) = \u2212(TM + TMott )\u03c8 (1) +\nWe have introduced the transport coefficients\nTin (r, \u03b5 ) = \u03c0\u03c1in (r)\nTel (r, \u03b5 ) = \u03c0\u03c1el (r)\n\nZ (\u03b5 \u2212\u03b5B )/2 Z 1\n\n\u03b5B\nZ 1\n\n\u22121\n\n\u22121\n\n(1 \u2212 \u03bc )\u03c3el (\u03b5 , \u03bc )d \u03bc .\n6\n\n(12)\n\n\f1\n\n1\n0.9\n0.8\n\n0.5\nEigenvalues\n\nEddington factor\n\n0.7\n0.6\n0.5\n0.4\n\n0\n\n0.3\n\n\u22120.5\n0.2\n0.1\n0\n\u22121\n\n\u22120.5\n\n0\nAnisotropy parameter\n\n0.5\n\n\u22121\n\u22121\n\n1\n\n(a) Eddington factor.\n\n\u22120.5\n\n0\n0.5\nAnisotropy parameter\n\n1\n\n(b) Eigenvalues.\n\nFigure 1: Eddington factor \u03c7 and system eigenvalues versus anisotropy parameter |\u03b1 |.\nThese coefficients and the stopping power can be computed for both Henyey-Greenstein and\nMott/M\u00f8ller scattering. Explicit expressions can be found in [22, 17].\nThe remaining problem is the computation of moment \u03c8 (2) as a function of \u03c8 (0) and \u03c8 (1) .\nThe Minimum Entropy M1 closure for electrons [10] can be derived in the following way. To\nclose the system we determine a distribution function \u03c8ME that minimizes the entropy of the\nelectrons,\nZ\n\u2217\n(13)\nHR (\u03c8 ) = \u2212 \u03c8 log \u03c8 d\u03a9,\nS2\n\nunder the constraint that it reproduces the lower order moments,\nZ\n\nS2\n\n\u03c8ME d\u03a9 = \u03c8\n\n(0)\n\nand\n\nZ\n\nS2\n\n\u03a9\u03c8ME d\u03a9 = \u03c8 (1) .\n\n(14)\n\nBy using this entropy, we have implicitly assumed that the electrons obey classical MaxwellBoltzmann statistics. This is justified, since here quantum effects can be neglected.\nAnalogous to the calculations in [27] we can show that the entropy minimizer has the following form,\n\u03c8ME = a0 exp(\u2212\u03a9 * a1 ),\n(15)\n\nwhere a0 is a non-negative scalar, and a1 is a three component real valued vector. This is a\nMaxwell-Boltzmann type distribution and a0 , a1 are (scaled) Lagrange multipliers enforcing the\nconstraints. An important parameter is the anisotropy parameter \u03b1 ,\n\n\u03b1=\n\n\u03c8 (1)\n,\n\u03c8 (0)\n\nwhose norm is by construction less than or equal to one. If we compute the different moments\nof the distribution function given by (15) we obtain,\n\n\u03c8 (0) = 4\u03c0 a0\n\nsinh(|a1 |) (1)\nsinh(|a1 |)(1 \u2212 |a1| coth(|a1 |))\n, \u03c8 = 4\u03c0 a0\na1 .\n|a1 |\n|a1 |3\n7\n\n(16)\n\n\fIn fact, these relations can be combined to give,\n\n\u03b1=\n\n1 \u2212 |a1 | coth(|a1 |)\na1 ,\n|a1 |2\n\n(17)\n\n|a1 | coth(|a1|) \u2212 1\n.\n|a1 |\n\n(18)\n\nor by taking the modulus,\n|\u03b1 | =\n\nThe relation (18) cannot be inverted explicitly by hand, i.e. we cannot express |a1 | as a function of \u03b1 in a closed form. However, this relation determines a unique solution which can in\nprinciple be computed. If we assume that we know a1 , \u03c8 (2) can be computed as\n\u0012\n\u0013\n3 \u03c7 (\u03b1 ) \u2212 1\n(2)\n(0) 1 \u2212 \u03c7 (\u03b1 )\nI+\n\u03c8 =\u03c8\n\u03b1 \u2297\u03b1 ,\n(19)\n2\n2\nwhere\n\n\u03c7=\n\n|a1 |2 \u2212 2|a1 | coth(|a1|) + 2\n|a1 |2\n\n(20)\n\nis a function of \u03b1 by means of (18).\nFor its efficient numerical evaluation, the Eddington factor has to be approximated. Several\npossibilities exist:\n\u2022 One could solve the closure relation (18) for |a1 | e.g. by a Newton iteration in each step\nduring the simulation.\n\u2022 One could precompute a table that gives the Eddington factor \u03c7 as a function of \u03b1 .\n\u2022 One could approximate \u03c7 (\u03b1 ) by a suitable special function.\nThe second approach has been followed in [17]. It is advantageous only if the space in which\none interpolates is low-dimensional. For more moments, this approach becomes more expensive,\nand the first approach appears to be more advantageous.\nIn some cases, an ansatz for \u03c7 can provide a good approximation. This is the approach we are\nfollowing here. The Eddington factor \u03c7 can be approximated by a very simple rational function,\n\n\u03c7 (\u03b1 ) \u2248\n\na6 \u03b1 6 + a4 \u03b1 4 + a2 \u03b1 2 + a0\n\u03b1 4 + b2 \u03b1 2 + b0 .\n\n(21)\n\nThis approximation is very accurate (the difference with exact curve is about 10\u221215 ). The coefficients are given by\na0 = 0.762066949972264, b0 = 2.28620084991677,\na2 = 0.219172080193380, b2 = \u22122.10758208969840,\na4 = \u22120.259725400168378,\na6 = 0.457105130221120.\n8\n\n(22)\n\n\f4 Properties of the System\nIn the literature, the system that has been thoroughly investigated (both analytically and numerically) is system (10) restricted to its conservative terms, without external sources, but with\ntime-dependence.\nIn the present work, we adapt a pseudo-time technique. We focus on the spatial discretization\nand use a standard discretization for the terms on the right-hand side. Thus we consider\n\n\u2202 (0)\n\u03c8 + \u2207x \u03c8 (1) = 0,\n\u2202t\n\u0010\n\u0011\n\u2202 (1)\n\u03c8 + \u2207x \u03c8 (2) \u03c8 (0) , \u03c8 (1) = 0,\n\u2202t\n\n(23a)\n(23b)\n\nwith the closure (18).\nThe Eddington factor \u03c7 is shown in Figure 1. Furthermore, we show the system eigenvalues\nin two dimensions. In the isotropic regime (anisotropy parameter zero), they coincide with the P1\neigenvalues. On the other hand, in the case of free-streaming (|\u03b1 | = 1), they coincide and have\nabsolute value one. Thus the system (10) is hyperbolic and the speed of propagation is limited\nby one. Moreover the system is hyperbolic symmetrisable [15].\nSystem (23) closed by the relation (19) has been analyzed thoroughly in [23]. There, solutions to Riemann problems are constructed and invariant regions are computed. Since the\nreconstruction (15) of the kinetic distribution \u03c8 is always positive, it can be expected that system\n(19) - (23) must admit a positive solution \u03c8 (0) and a limited flux k\u03b1 k < 1. To our knowledge,\nhowever, there exists no proof of this fact. The invariant regions computed in [23] only cover a\nsubset of all admissible values. For a related model [18], bounds were proved, but only in 1D\nand steady state. Nevertheless, we construct a scheme which preserves exactly the positivity of\n\u03c8 (0) and the flux limitation, i.e. the convex set of the admissible states of the system (23) is [8]\nn\u0010\n\u0011\no\nA = \u03c8 (0) , \u03c8 (1) : \u03c8 (0) \u2265 0, |\u03c8 (1) | \u2264 \u03c8 (0) .\n\nIn the absence of sources or boundaries, the total mass, momentum and energy are conserved.\nIn addition, the minimum entropy system recovers the equilibrium diffusion regime as a\nrelaxation limit for large absorption coefficients [13].\nIn a two- or three-dimensional geometry, we have in addition [8]: Let n be the unit normal\nvector to an interface; then the system exhibits two acoustic waves, with velocities \u03bbL (n) and\n\u03bbR (n), supplemented by a contact wave with velocity \u03b2 (n). The quantity \u03b2 * n satisfies the following inequality \u03bbL (n) \u2264 \u03b2 (n) * n \u2264 \u03bbR (n). The Riemann invariants associated with the contact\nwave are {\u03b2 , \u03a0}. They are defined by the relations\n\n\u03c81 = (\u03a0 + \u03c80 ) \u03b2 ,\n\u03c82 = (\u03c80 + \u03a0) \u03b2 \u2297 \u03b2 + \u03a0Id .\n\n9\n\n(24a)\n(24b)\n\n\f5 Numerical Method\nThe properties of the continuous model should be reproduced by the numerical scheme. In\nparticular the positivity and flux limitation constraints are fundamental. An HLL scheme [20]\ncan be constructed [3, 11, 8], that satisfies the required properties. However such an approach\ncannot capture the contact discontinuity. To prevent this failure, an HLLC scheme [3] has been\nderived, that resolves the contact discontinuity and satisfies the physical constraints.\nTo complete this presentation of the numerical approximation, we mention that a suitable\nhigh order extension that preserves both the positivity and the flux limitation can be derived,\nrelying on an appropriate limitation procedure.\n\n5.1 An HLL scheme for the free transport M1 angular moment system\nIn this section, we derive a Finite Volume method, issued from the HLL method [20] to discretize\nthe free transport equation (23). Put in other words, we omit the source terms and we consider\nthe one dimensional generic conservative system\n\n\u2202\n\u2202\nU+\n[F (U )] = 0 ,\n\u2202t\n\u2202x\nwhere\nU =\n\n\u0012\n\n\u03c80\n\u03c81\n\n(25)\n\n\u0013\n\nand F stands for the flux of the M1 system in the x space direction. \u0002\n\u0001\nWe consider a structured mesh of size \u2206xi , defined by the cells Ii = xi\u22121/2 , xi+1/2 , where we\nhave set xi+1/2 = xi + \u2206x/2 , i \u2208 Z, at time t n . As usual, we consider known a piecewise contant\napproximation U h (x,t n), defined by U h (x,t n) = Uin, x \u2208 Ii , \u2200i \u2208 Z.\nAt initial time t = 0, we impose\nUi0 =\n\nZ x\ni+1/2\nxi\u22121/2\n\nU0 (x)dx,\n\nwhere U0 is the initial data. This approximation evolves in time, involving a suitable approximate\nRiemann solver. In the HLL approach, the exact Riemann solver solution is substituted by a\nsingle approximate state (see Figure 2). Here bL and bR are relevant approximations of \u03bbL and\n\u03bbR , respectively. Let us introduce the proposed approximate solution:\n\uf8f1\n\u0013\n\u0012\nif xt < bL ,\n\uf8f2 UL\n\u03c80 (x,t)\nU\u2217\nif bL \u2264 xt \u2264 bR ,\n(26)\n=\nUHLL (x,t) \u2261\n\u03c81 (x,t) HLL \uf8f3\nx\nUR\nif bR < t .\nMoreover, the search of weak solutions leads to the Rankine-Hugoniot jump conditions\n\u0002\n\u0003\n\u2212bL [U \u2217 \u2212 UL ] + F\u0303 \u2212 F (UL ) = 0,\n\u0002\n\u0003\n\u2212bR [UR \u2212 U \u2217 ] + F (UR ) \u2212 F\u0303 = 0.\n10\n\n(27a)\n(27b)\n\n\fFigure 2: Structure of the approximate HLL Riemann Solver\nThese relations provide us with an explicit expression for the intermediate state and flux of the\nnumerical scheme\nbR UR \u2212 bL UL \u2212 (F (UR) \u2212 F (UL ))\n,\nbR \u2212 bL\nbR F (UL ) \u2212 bL F (UR ) \u2212 bL bR (UR \u2212 UL )\n,\nF\u0303(UL , UR ) =\nbR \u2212 bL\nU\u2217 =\n\n(28a)\n(28b)\n\nAt each interface xi+1/2 , we impose the above HLL approximate Riemann solver, assuming the\nCFL like condition (29) ensuring that the Riemann solvers do not interact in the case where\nbL,i+1/2 < 0 and bR,i\u22121/2 > 0 :\nbL,i+1/2 bR,i\u22121/2\n\u2206t\n\u2264\n.\n\u2206x bL,i+1/2 \u2212 bR,i\u22121/2\n\n(29)\n\nWe set U h (x,t + \u2206t), at time t n + \u2206t, the superposition of the non-interacting Riemann solutions.\nWe define the updated approximation at time t n+1 by\nUi\n\nn+1\n\n1\n=\n\u2206x\n\nZ x\ni+1/2\nxi\u22121/2\n\nU h (x,t n + \u2206t).\n\nAn easy computation gives\nUi n+1 = Ui n \u2212\n\n\u2206t n\nn\n(F\n\u2212 Fi\u22121/2\n),\n\u2206x i+1/2\n\n(30)\n\nwhere\n\uf8f1\n\uf8f2\n\nn\nn\nFi+1/2\n(Ui n , Ui+1\n)=\n\uf8f3\n\nF (Ui n )\n\u0001\nn\nF\u0303i+1/2 Ui n , U\u0001i+1\nn\nF Ui+1\n\nif 0 < bL,i+1/2\nif bL,i+1/2 \u2264 0 \u2264 bR,i+1/2\nif bR,i+1/2 < 0\n\nThe robustness of the scheme, namely the positivity, the flux limitation, the total mass preservation, has been established for the HLL scheme (see [8] for further details).\nFinally, concerning the high order extension, we adopt a van Leer MUSCL technique [37], supplemented by a suitable slope limitation preserving these expected physical properties [7].\n11\n\n\f5.2 An accurate HLLC scheme\nThe HLL scheme has proved to be robust, however, its 2D extension fails when approximating\ncontact waves. Several works [3, 8] introduce a more accurate scheme, the HLLC scheme, based\non a two state approximation, denoted by UL\u2217 and UR\u2217.\nFirst, let us recall the relevant linearization that permits us to define an approximation with\ntwo intermediate states: on the one hand, the Rankine-Hugoniot conditions (27) are considered;\non the other hand, they are supplemented by the continuity of the Riemann invariants accross the\ncontact wave:\n(\u03b2x )\u2217L = (\u03b2x )\u2217R = \u03b2x\u2217\n\n,\n\n\u03a0\u2217L = \u03a0\u2217R = \u03a0\u2217 ,\n\n(31)\n\nwhere \u03b2x and \u03a0 are defined by the relation (24). The combination of both the Rankine-Hugoniot\ncondition (27) and the relation (31) standing as the continuity of the Riemann invariants accross\nthe contact wave, is sufficient to determine uniquely [3, 8] the two approximate states UL\u2217 and\nUR\u2217 , together with their associated fluxes F\u0303L and F\u0303R . The proposed HLLC approximate solution\ncan be written as\n\uf8f1\nif xt < bL ,\n\uf8f4\n\uf8f4 UL\u2217\n\u0012\n\u0013\n\uf8f2\nUL\nif bL \u2264 xt \u2264 \u03b2x\u2217 ,\n\u03c80 (x,t)\nUHLLC (x,t) \u2261\n(32)\n=\n\u03c81 (x,t) HLLC \uf8f4\nUR\u2217\nif \u03b2x\u2217 \u2264 xt \u2264 bR ,\n\uf8f4\n\uf8f3\nUR\nif bR < xt .\nSimilar to the derivation of the HLL scheme, we integrate over a cell Ii the juxtaposition of the\nnon-interacting HLLC Riemann approximate solvers at each interface (projection step), in order\nto obtain the updated quantity\nUi\n\nn+1\n\n1\n=\n\u2206x\n\nZ x\ni+1/2\nxi\u22121/2\n\nU h (x,t n + \u2206t).\n\nThis brief description of the HLLC scheme is now completed. It is able to capture exactly the\ncontact wave, and satisfies the positivity, the flux limitation, and the total mass preservation.\n\n6 Numerical Results\n6.1 Central Void\nThe first test case is taken from the medical physics literature [2]. We consider only elastic\nscattering, which is modeled by the Henyey-Greenstein kernel. Thus S = 0 and Tin = 0. We\ncompare the particle flux \u03c8 (0) (x) obtained with the minimum entropy model (labeled M1) with\na discrete ordinates solution of the transport equation (labeled SN) with sufficiently many angles\n(128). The method has been described in [16].\nThe test case consists of a one-dimensional geometry with three layers: optically thick, followed by optically thin followed again by optically thick. The layers have an equal depth of 40\n12\n\n\fmm. The scattering and absorption coefficients are \u03c3s = 0.5 mm\u22121, \u03c3a = 0.005 mm\u22121 for the\noptically thick region, and \u03c3s = 0.01 mm\u22121 , \u03c3a = 0.0001 mm\u22121 for the optically thin region.\nMoreover, g = 0. Figure 3 shows the particle flux \u03c8 (0) as a functon of space. Compared to the\nbenchmark solution, the minimum entropy model slightly overestimates but nevertheless quite\naccurately describes the particle flux. In Figure 3 we also show the partice distribution function\n\u03c8 (x, \u03a9), where \u03a9 = (0, 0, \u03bc ) in 1D. The main difference is that for M1 , the forward-peak of the\nincoming particles reaches further into the medium.\n\n6.2 Two-dimensional Void-like Layer\nOur second test case, again taken from [2], is a two-dimensional quadratic domain which contains a void-like layer, shown in gray in Figure 4(a). Again, we consider only elastic scattering\nmodeled by the Henyey-Greenstein kernel.\nWe take \u03c3s = 0.5 mm\u22121 and \u03c3a = 0.005 mm\u22121 inside the square, and \u03c3s = 0.01 mm\u22121\nand \u03c3a = 0.0001 mm\u22121 in the void-like ring. In both regions, g = 0. An isotropic source of\nparticles is placed on the left boundary. In a 2D contour plot (Figure 4), the fluxes \u03c8 0 from the\ndiscrete ordinate method and from the minimum entropy method are virtually indistinguishable.\nThe propagation into the medium, as well as the void-like layer are equally well resolved. A\ndifference between the models only becomes apparent in a logarithmic plot of a cut through the\ncenter of the square at y = 50 mm. Figure 4 shows the particle flux along this line. The difference\nbetween both solutions is again of the order of one percent.\n\n6.3 Electrons on Water Phantom\nAs a first test case that includes energy loss, we consider a 10 MeV electron beam impinging onto\na slab of water. In Figure 5 we compare the results computed with our code to the dose computed by the state-of-the-art Monte Carlo code PENELOPE [32]. This code has been extensively\nvalidated against experimental results.\nTo obtain a good fit with the tabulated scattering data, we have fixed our model parameters\nfor water as \u03b5B = 16.0 eV, Z = 9.40, \u03c1el = 0.256 \u00d7 1023 g/cm3 , \u03c1in = 6.21 \u00d7 1023 g/cm3 . These\nparameters are directly inserted into the model (3), and subsequent derived models issued from\n(3). As boundary conditions, we have taken a very narrow Gaussian in energy, and a \u03b4 pulse in\nangle\n\u03c8b = \u03c80 exp(\u2212200(\u03b5 \u2212 \u03b5beam )2 )\u03b4 (\u03bc \u2212 1),\nand computed the angular moments. PENELOPE was set up in a pseudo-1D setting with a large\nbeam size perpendicular to the beam direction.\nIn order to compare the different formulations of the models, both depth-dose curves in Figure 5 have been normalized to dose maximum one. The penetration depth computed with the M1\nmodel agrees very well with the Monte Carlo result. In fact this deviation is within the margin\nof differences between different Monte Carlo codes [33]. The only major difference occurs near\nthe boundary, where the M1 model overestimates the dose. This might be due to the simplified\nphysics (possibly neglection of Bremsstrahlung effects) or an oversimplification of the angular\n13\n\n\f6000\nSN\nM1\n\n5500\n5000\n\nflux\n\n4500\n4000\n3500\n3000\n2500\n2000\n1500\n20\n\n30\n\n40\n\n50\n\n60\nx\n\n70\n\n80\n\n90\n\n100\n\n(a) Particle flux.\n\n(b) Comparison of M1 and benchmark distribution functions. Logarithmic scale.\n\nFigure 3: Geometry with central void.\n\n14\n\n\f4 mm\n\n4 mm\n0\n\n10\n\nSN\nM1\n\n\u22121\n\n10\n\n\u22122\n\n10\n\n\u22123\n\nFlux\n\nSource\n\n10\n\n\u22124\n\n10\n\n\u22125\n\n10\n\n\u22126\n\n10\n\n\u22127\n\n10\n\n84 mm\n\n8 mm\n\n0\n\n20\n\n40\n\n\u22122\n\n80\n\n80\n\n\u22122\n\n90\n80\n\n\u22124\n\n70\n\n\u22124\n\n70\n\u22126\n\n\u22126\n\n60\n\n60\n\u22128\n\n50\n40\n\ny\n\ny\n\n100\n\n(b) Cut along y = 50 mm.\n\n(a) Geometry containing void layer.\n\n90\n\n60\nx\n\n8 mm\n\n\u22128\n\n50\n40\n\n\u221210\n\n30\n\n\u221210\n\n30\n\u221212\n\n\u221212\n\n20\n\n20\n\u221214\n\n10\n20\n\n40\n\n60\n\n\u221214\n\n10\n\n80\n\n20\n\nx\n\n40\n\n60\n\n80\n\nx\n\n(c) Transport solution.\n\n(d) Minimum entropy model.\n\nFigure 4: Transport versus minimum entropy for void-like layer.\n\n15\n\n\fNormalized Dose\n1\nM1\nMC\n\nD/D\n\nmax\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0\n0\n\n2\n\n4\n\n6\n\n8\n\nx\n\nFigure 5: Dose for 10 MeV electron beam on water.\ndependence of \u03c8 in the M1 model. Both possibilities will be investigated further. However,\nwe believe that this result can serve as a proof of concept of a PDE based modeling of dose\ncomputation.\n\n6.4 CT Data\nIn our final test case, we compare our method with Monte Carlo results from PENELOPE using\nreal patient CT data showing the hip bone. We took a two-dimensional slice of 6 \u00d7 6 cm from the\nthree-dimensional CT data. A square region is split into 64\u00d764 squares. In each of the squares,\nthe material is described by its Hounsfield grey value G (x, y). The grey values can be translated\ninto physical parameters as follows,\n\u0013\n\u0012\nG (x, y)\n+ 1 \u03c1Water ,\n\u03c1 (x, y) =\n1000\n\ni.e. the densities \u03c1el and \u03c1in for water are multiplied by a specified factor. The region shows the\nhip bone and the density varies between 86% and 226% of the value of water. The boundary\nconditions were set up similar to the previous case, with three beams of width 2 cm, each consisting of 10 MeV electrons, impinging from the centers of three sides of the domain. Contour\nplots of the dose distribution are shown in Figure 7. There, we also show two cuts through the\ndose distribution. looking at the 2D dose distribution, the contour lines agree very well. Note\nthat, although we have used 3 \u00d7 1010 particles, there still is significant noise in the Monte Carlo\nresults. The two cuts through the beam centers show that also quantitatively the independently\ncomputed dose distributions agree very well.\n16\n\n\fFigure 6: CT data of hip bone.\n\n(a) Monte Carlo solution.\n\n(b) Minimum entropy solution.\n\n1\n\n1\nMC\nM1\n\nMC\nM1\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n\n0\n0\n\n1\n\n2\n\n3\ny (cm)\n\n4\n\n5\n\n0\n0\n\n6\n\n(c) Cut along x = 3 cm.\n\n1\n\n2\n\n3\nx (cm)\n\n4\n\n(d) Cut along y = 3 cm.\n\nFigure 7: Dose distribution for three beams impinging on hip bone.\n17\n\n5\n\n6\n\n\fThe computation time for the 3D Monte Carlo dose was 3 \u00d7 29 hours for 3 \u00d7 1010 particles\non a 3GHz Pentium 4 with 1 GB RAM. In 1D, the minimum entropy model took about 1 second,\nin 2D 4 seconds. Thus we expect a computation time of several seconds in a full 3D dose\ncomputation.\nAgain, this result shows that if our model is developed further, it may serve as an alternative\nto existing dose computation methods.\n\nAcknowledgements\nWe thank Edgar Olbrant for performing the PENELOPE computations. The CT data has been\nprovided by the German Cancer Research Center DKFZ and the Optimization Department at\nFraunhofer ITWM, Kaiserslautern. This work was supported by the German Research Foundation DFG under grant KL 1105/14/2, by the French Ministry of Foreign Affairs under EGIDE\ncontract 17852SD and by German Academic Exchange Service DAAD under grant D/0707534.\n\nReferences\n[1] A. M. Anile, S. Pennisi, and M. Sammartino, A thermodynamical approach to Eddington\nfactors, J. Math. Phys. 32 (1991), 544\u2013550.\n[2] E. D. Aydin, C. R. E. Oliveira, and A. J. H. Goddard, A comparison between transport and\ndiffusion calculations using finite element-spherical harmonics radiation transport method,\nMed. Phys. 29 (2002), 2013\u20132023.\n[3] P. Batten, N. Clarke, C. Lambert, and D. M. Causon, On the choice of wavespeeds for the\nHLLC riemann solver, SIAM J. Sci. Comput. 18 (1997), 1553\u20131570.\n[4] N. Bellomo and P. K. Maini, Preface (special issue on cancer modelling), Math. Mod.\nMath. Appl. Sci. 15 (2005), iii\u2013viii.\n[5]\n\n, Preface (special issue on cancer modelling), Math. Mod. Math. Appl. Sci. 16\n(2006), iii\u2013vii.\n\n[6]\n\n, Preface (special issue on cancer modelling), Math. Mod. Math. Appl. Sci. 17\n(2007), iii\u2013vii.\n\n[7] C. Berthon, Stability of the MUSCL schemes for the Euler equations, Comm. Math. Sci. 3\n(2005), 133\u2013157.\n[8] C. Berthon, P. Charrier, and B. Dubroca, An HLLC scheme to solve the M1 model of radiative transfer in two space dimensions, J. Sci. Comput. 31 (2007), 347\u2013389.\n[9] C. B\u00f6rgers, Complexity of Monte Carlo and deterministic dose-calculation methods, Phys.\nMed. Biol. 43 (1998), 517\u2013528.\n18\n\n\f[10] T. A. Brunner and J. P. Holloway, One-dimensional Riemann solvers and the maximum\nentropy closure, J. Quant. Spectrosc. Radiat. Transfer 69 (2001), 543\u2013566.\n[11] C. Buet and B. Depr\u00e9s, Asymptotic preserving and positive schemes for radiation hydrodynamics, J. Comput. Phys. 215 (2006), 717\u2013740.\n[12] Y. Censor, Preface: Linear and nonlinear models and algorithms in intensity-modulated\nradiation therapy (IMRT), Lin. Alg. Appl. 428 (2008), 1203\u20131205.\n[13] J.-F. Coulombel, F. Golse, and T. Goudon, Diffusion approximation and entropy-based\nmoment closure for kinetic equations, Asymptotic Analysis 45 (2005), 1\u201339.\n[14] B. Davison, Neutron transport theory, Oxford University Press, 1958.\n[15] B. Dubroca and J. L. Feugeas, Entropic moment closure hierarchy for the radiative transfer\nequation, C. R. Acad. Sci. Paris Ser. I 329 (1999), 915\u2013920.\n[16] B. Dubroca and M. Frank, An iterative method for transport equations in radiotherapy, to\nappear in Proceedings of ECMI 08, 2009.\n[17] M. Frank, H. Hensel, and A. Klar, A fast and accurate moment method for dose calculation\nin electron radiotherapy, SIAM J. Appl. Math. 67 (2007), 582\u2013603.\n[18] M. Frank and R. Pinnau, Existence, uniqueness and bounds for the half moment minimum\nentropy approximation to rediative heat transfer, Appl. Math. Lett. 20 (2007), 189\u2013193.\n[19] K. A. Gifford, J. L. Horton Jr., T. A. Wareing, G. Failla, and F. Mourtada, Comparioson\nof a finite-element multigroup discrete-ordinates code with Monte Carlo for radiotherapy\ncalculations, Phys. Med. Biol. 51 (2006), 2253\u20132265.\n[20] A. Harten, P.D. Lax, and B. van Leer, On upstream differencing and Godunov-type schemes\nfor hyperbolic conservation laws, SIAM Rev. 25 (1983), 35\u201361.\n[21] C.D. Hauck, C.D. Levermore, and A.L. Tits, Convex duality in entropy-based moment closures: Characterizing degenerate densities, SIAM J. Control Optim. 47 (2008), 1977\u2013\n2015.\n[22] H. Hensel, R. Iza-Teran, and N. Siedow, Deterministic model for dose calculation in photon\nradiotherapy, Phys. Med. Biol. 51 (2006), 675\u2013693.\n[23] T. Goudon J.-F. Coulombel, Entropy-based moment closure for kinetic equations: Riemann\nproblem and invariant regions, J. Hyperbolic Diff. Eq. 3 (2006), 649\u2013672.\n[24] E. T. Jaynes, Information theory and statistical mechanics, Phys. Rev. 106 (1957), 620\u2013630.\n[25] E. W. Larsen, M. M. Miften, B. A. Fraass, and I. A. D. Bruinvis, Electron dose calculations\nusing the method of moments, Med. Phys. 24 (1997), 111\u2013125.\n19\n\n\f[26] C. Lehmann, Interaction of radiation with solids and elementary defect production, North\nHolland, 1977.\n[27] C. D. Levermore, Relating Eddington factors to flux limiters, J. Quant. Spectrosc. Radiat.\nTransfer 31 (1984), 149\u2013160.\n[28] G. N. Minerbo, Maximum entropy Eddington factors, J. Quant. Spectrosc. Radiat. Transfer\n20 (1978), 541\u2013545.\n[29] N. F. Mott and H. S. W. Massey, The theory of atomic collisions, Clarendon Press, 1965.\n[30] I. M\u00fcller and T. Ruggeri, Rational extended thermodynamics, 2nd ed., Springer-Verlag,\nNew York, 1993.\n[31] G. C. Pomraning, The Fokker-Planck operator as an asymptotic limit, Math. Mod. Meth.\nAppl. Sci. 2 (1992), 21\u201336.\n[32] F. Salvat, J.M. Fernandez-Varea, and J.Sempau, PENELOPE-2008, a code system for monte\ncarlo simulation of electron and photon transport, OECD, 2008, ISBN 978-92-64-99066-1.\n[33] J. Sempau, S.J. Wilderman, and A.F. Bielajew, DPM - a fast, accurate Monte Carlo code\noptimized for photon and electron radiotherapy treatment planning dose computations,\nPhys. Med. Biol. 45 (2000), 2262\u20132291.\n[34] J. Tervo and P. Kolmonen, Inverse radiotherapy treatment planning model applying\nboltzmann-transport equation, Math. Models. Methods. Appl. Sci. 12 (2002), 109\u2013141.\n[35] J. Tervo, P. Kolmonen, M. Vauhkonen, L. M. Heikkinen, and J. P. Kaipio, A finite-element\nmodel of electron transport in radiation therapy and related inverse problem, Inv. Probl. 15\n(1999), 1345\u20131361.\n[36] J. Tervo, M. Vauhkonen, and E. Boman, Optimal control model for radiation therapy inverse planning applying the Boltzmann transport equation, Lin. Alg. Appl. 428 (2008),\n1230\u20131249.\n[37] B. van Leer, Towards the ultimate conservative difference scheme V: A second-order sequel\nto Godunov's method, J. Comput. Phys. 32 (1979), 101\u2013136.\n[38] O.N. Vassiliev, T.A. Wareing, I.M. Davis, et al., Feasibility of a multigroup deterministic\nsolution method for 3d radiotherapy dose calculations, Int. J. Radiat. Oncol. Biol. Phys. 72\n(2009), 220\u2013227.\n[39] C. D. Zerby and F. L. Keller, Electron transport theory, calculations and experiments, Nucl.\nSci. Eng. 27 (1967), 190\u2013218.\n\n20\n\n\f"}