{"id": "http://arxiv.org/abs/cond-mat/0204111v2", "guidislink": true, "updated": "2002-12-29T21:20:59Z", "updated_parsed": [2002, 12, 29, 21, 20, 59, 6, 363, 0], "published": "2002-04-04T14:51:42Z", "published_parsed": [2002, 4, 4, 14, 51, 42, 3, 94, 0], "title": "Principles of statistical mechanics of random networks", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cond-mat%2F0204385%2Ccond-mat%2F0204006%2Ccond-mat%2F0204442%2Ccond-mat%2F0204089%2Ccond-mat%2F0204058%2Ccond-mat%2F0204593%2Ccond-mat%2F0204282%2Ccond-mat%2F0204617%2Ccond-mat%2F0204019%2Ccond-mat%2F0204046%2Ccond-mat%2F0204571%2Ccond-mat%2F0204470%2Ccond-mat%2F0204440%2Ccond-mat%2F0204041%2Ccond-mat%2F0204263%2Ccond-mat%2F0204504%2Ccond-mat%2F0204535%2Ccond-mat%2F0204284%2Ccond-mat%2F0204192%2Ccond-mat%2F0204060%2Ccond-mat%2F0204261%2Ccond-mat%2F0204290%2Ccond-mat%2F0204178%2Ccond-mat%2F0204117%2Ccond-mat%2F0204585%2Ccond-mat%2F0204307%2Ccond-mat%2F0204374%2Ccond-mat%2F0204255%2Ccond-mat%2F0204052%2Ccond-mat%2F0204022%2Ccond-mat%2F0204331%2Ccond-mat%2F0204187%2Ccond-mat%2F0204396%2Ccond-mat%2F0204577%2Ccond-mat%2F0204544%2Ccond-mat%2F0204520%2Ccond-mat%2F0204111%2Ccond-mat%2F0204415%2Ccond-mat%2F0204347%2Ccond-mat%2F0204350%2Ccond-mat%2F0204120%2Ccond-mat%2F0204045%2Ccond-mat%2F0204574%2Ccond-mat%2F0204236%2Ccond-mat%2F0204324%2Ccond-mat%2F0204084%2Ccond-mat%2F0204243%2Ccond-mat%2F0204480%2Ccond-mat%2F0204308%2Ccond-mat%2F0204097%2Ccond-mat%2F0204013%2Ccond-mat%2F0204492%2Ccond-mat%2F0204501%2Ccond-mat%2F0204419%2Ccond-mat%2F0204534%2Ccond-mat%2F0204540%2Ccond-mat%2F0204627%2Ccond-mat%2F0204430%2Ccond-mat%2F0204329%2Ccond-mat%2F0204167%2Ccond-mat%2F0204532%2Ccond-mat%2F0204279%2Ccond-mat%2F0204418%2Ccond-mat%2F0204351%2Ccond-mat%2F0204224%2Ccond-mat%2F0204005%2Ccond-mat%2F0204466%2Ccond-mat%2F0204322%2Ccond-mat%2F0204054%2Ccond-mat%2F0204155%2Ccond-mat%2F0204451%2Ccond-mat%2F0204196%2Ccond-mat%2F0204444%2Ccond-mat%2F0204618%2Ccond-mat%2F0204628%2Ccond-mat%2F0204496%2Ccond-mat%2F0204389%2Ccond-mat%2F0204034%2Ccond-mat%2F0204578%2Ccond-mat%2F0204296%2Ccond-mat%2F0204300%2Ccond-mat%2F0204185%2Ccond-mat%2F0204357%2Ccond-mat%2F0204049%2Ccond-mat%2F0204424%2Ccond-mat%2F0204030%2Ccond-mat%2F0204164%2Ccond-mat%2F0204144%2Ccond-mat%2F0204099%2Ccond-mat%2F0204253%2Ccond-mat%2F0204608%2Ccond-mat%2F0204587%2Ccond-mat%2F0204511%2Ccond-mat%2F0204240%2Ccond-mat%2F0204080%2Ccond-mat%2F0204412%2Ccond-mat%2F0204632%2Ccond-mat%2F0204355%2Ccond-mat%2F0204267%2Ccond-mat%2F0204621%2Ccond-mat%2F0204276&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Principles of statistical mechanics of random networks"}, "summary": "We develop a statistical mechanics approach for random networks with\nuncorrelated vertices. We construct equilibrium statistical ensembles of such\nnetworks and obtain their partition functions and main characteristics. We find\nsimple dynamical construction procedures that produce equilibrium uncorrelated\nrandom graphs with an arbitrary degree distribution. In particular, we show\nthat in equilibrium uncorrelated networks, fat-tailed degree distributions may\nexist only starting from some critical average number of connections of a\nvertex, in a phase with a condensate of edges.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cond-mat%2F0204385%2Ccond-mat%2F0204006%2Ccond-mat%2F0204442%2Ccond-mat%2F0204089%2Ccond-mat%2F0204058%2Ccond-mat%2F0204593%2Ccond-mat%2F0204282%2Ccond-mat%2F0204617%2Ccond-mat%2F0204019%2Ccond-mat%2F0204046%2Ccond-mat%2F0204571%2Ccond-mat%2F0204470%2Ccond-mat%2F0204440%2Ccond-mat%2F0204041%2Ccond-mat%2F0204263%2Ccond-mat%2F0204504%2Ccond-mat%2F0204535%2Ccond-mat%2F0204284%2Ccond-mat%2F0204192%2Ccond-mat%2F0204060%2Ccond-mat%2F0204261%2Ccond-mat%2F0204290%2Ccond-mat%2F0204178%2Ccond-mat%2F0204117%2Ccond-mat%2F0204585%2Ccond-mat%2F0204307%2Ccond-mat%2F0204374%2Ccond-mat%2F0204255%2Ccond-mat%2F0204052%2Ccond-mat%2F0204022%2Ccond-mat%2F0204331%2Ccond-mat%2F0204187%2Ccond-mat%2F0204396%2Ccond-mat%2F0204577%2Ccond-mat%2F0204544%2Ccond-mat%2F0204520%2Ccond-mat%2F0204111%2Ccond-mat%2F0204415%2Ccond-mat%2F0204347%2Ccond-mat%2F0204350%2Ccond-mat%2F0204120%2Ccond-mat%2F0204045%2Ccond-mat%2F0204574%2Ccond-mat%2F0204236%2Ccond-mat%2F0204324%2Ccond-mat%2F0204084%2Ccond-mat%2F0204243%2Ccond-mat%2F0204480%2Ccond-mat%2F0204308%2Ccond-mat%2F0204097%2Ccond-mat%2F0204013%2Ccond-mat%2F0204492%2Ccond-mat%2F0204501%2Ccond-mat%2F0204419%2Ccond-mat%2F0204534%2Ccond-mat%2F0204540%2Ccond-mat%2F0204627%2Ccond-mat%2F0204430%2Ccond-mat%2F0204329%2Ccond-mat%2F0204167%2Ccond-mat%2F0204532%2Ccond-mat%2F0204279%2Ccond-mat%2F0204418%2Ccond-mat%2F0204351%2Ccond-mat%2F0204224%2Ccond-mat%2F0204005%2Ccond-mat%2F0204466%2Ccond-mat%2F0204322%2Ccond-mat%2F0204054%2Ccond-mat%2F0204155%2Ccond-mat%2F0204451%2Ccond-mat%2F0204196%2Ccond-mat%2F0204444%2Ccond-mat%2F0204618%2Ccond-mat%2F0204628%2Ccond-mat%2F0204496%2Ccond-mat%2F0204389%2Ccond-mat%2F0204034%2Ccond-mat%2F0204578%2Ccond-mat%2F0204296%2Ccond-mat%2F0204300%2Ccond-mat%2F0204185%2Ccond-mat%2F0204357%2Ccond-mat%2F0204049%2Ccond-mat%2F0204424%2Ccond-mat%2F0204030%2Ccond-mat%2F0204164%2Ccond-mat%2F0204144%2Ccond-mat%2F0204099%2Ccond-mat%2F0204253%2Ccond-mat%2F0204608%2Ccond-mat%2F0204587%2Ccond-mat%2F0204511%2Ccond-mat%2F0204240%2Ccond-mat%2F0204080%2Ccond-mat%2F0204412%2Ccond-mat%2F0204632%2Ccond-mat%2F0204355%2Ccond-mat%2F0204267%2Ccond-mat%2F0204621%2Ccond-mat%2F0204276&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We develop a statistical mechanics approach for random networks with\nuncorrelated vertices. We construct equilibrium statistical ensembles of such\nnetworks and obtain their partition functions and main characteristics. We find\nsimple dynamical construction procedures that produce equilibrium uncorrelated\nrandom graphs with an arbitrary degree distribution. In particular, we show\nthat in equilibrium uncorrelated networks, fat-tailed degree distributions may\nexist only starting from some critical average number of connections of a\nvertex, in a phase with a condensate of edges."}, "authors": ["S. N. Dorogovtsev", "J. F. F. Mendes", "A. N. Samukhin"], "author_detail": {"name": "A. N. Samukhin"}, "author": "A. N. Samukhin", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/S0550-3213(03)00504-2", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/cond-mat/0204111v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/cond-mat/0204111v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "14 pages, an extended version", "arxiv_primary_category": {"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.NI", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "hep-lat", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "hep-th", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "nlin.AO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/cond-mat/0204111v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/cond-mat/0204111v2", "journal_reference": "Nucl.Phys. B666 (2003) 396-416", "doi": "10.1016/S0550-3213(03)00504-2", "fulltext": "Principles of statistical mechanics of random networks\nS.N. Dorogovtseva,b,\u2217, J.F.F. Mendesc,\u2020 , and A.N. Samukhina,b,\u2021\n\narXiv:cond-mat/0204111v2 [cond-mat.stat-mech] 29 Dec 2002\n\na\n\nDepartamento de F\u0131\u0301sica and Centro de F\u0131\u0301sica do Porto, Faculdade Ci\u00eancias, Universidade do Porto,\nRua do Campo Alegre 687, 4169-007 Porto, Portugal\nb\nA.F. Ioffe Physico-Technical Institute, 194021 St. Petersburg, Russia\nc\nDepartamento de F\u0131\u0301sica, Universidade de Aveiro, Campus Universit\u00e1rio de Santiago, 3810-193 Aveiro, Portugal\nWe develop a statistical mechanics approach for random networks with uncorrelated vertices. We\nconstruct equilibrium statistical ensembles of such networks and obtain their partition functions and\nmain characteristics. We find simple dynamical construction procedures that produce equilibrium\nuncorrelated random graphs with an arbitrary degree distribution. In particular, we show that in\nequilibrium uncorrelated networks, fat-tailed degree distributions may exist only starting from some\ncritical average number of connections of a vertex, in a phase with a condensate of edges.\nPACS: 05.10.-a, 05.40.-a, 05.50.+q, 87.18.Sn\nKey words: Random graphs, Statistical ensembles, Zero-dimensional field theory, Backgammon model\n\nI. INTRODUCTION\n\nQuite recently, it has been realized that the study of the structure of networks, which was formerly \"a private\ndomain\" of mathematical graph theory [1,2,3], is actually a field of statistical physics [4,5,6,7,8,9]. Most achievements\nof physicists in the field of random networks [10] (structural and topological aspects) are empirical findings and simple\nideas, which were demonstrated by using very particular models. One of main questions that arise is: What is the\nnature of complex, non-Poisson degree distributions, which were observed in many real networks? (Degree of a vertex\nis the total number of its connections.) However, few efforts were made to develop a general statistical theory of\nnetworks (see Refs. [11,12,13,14]). Without such a theory, the above question cannot be answered. Furthermore, the\nstructure of the statistical theory of random networks can be related to a zero-dimensional field theory and to a meanfield description of simplicial gravity [15]. A condensation phase transition, which occurs in equilibrium networks, is\nclose to that which occurs in branched polymers [16,17].\nIn this paper we focus on equilibrium network ensembles, which are less studied. We construct statistical ensembles\nof random uncorrelated networks in a natural way and establish a one-to-one correspondence between them and\nknown construction procedures. One of conclusions is that, in equilibrium networks, fat-tailed degree distributions (in\nparticular, power-law ones) are possible only starting from some critical value of the average degree. Above this critical\npoint, a finite fraction of edges are in a \"condensed state\", i.e. are attached to an infinitely small fraction of vertices.\nThis situation for equilibrium networks contrasts with that for growing ones, were fat-tailed degree distributions are\nrealized over a wide range of a control parameter without any condensate.\nThe keystone of network science are construction procedures. Erd\u00f6s and R\u00e9nyi constructed ensembles of random\ngraphs with a Poisson degree distribution by adding edges at random to a fixed number of vertices [1]. When the\ntotal number of edges L is fixed, this provides a canonical ensemble. When one fixes the probability that two vertices\nare connected, the procedure produces a grand canonical ensemble.\nTo obtain equilibrium random graphs with an arbitrary degree distribution \u03a0 (q), a different statistical ensemble\nwas introduced [3] (see also Ref. [18]). Roughly speaking, these are graphs, maximally random under the restriction\nthat their degree distribution is equal to a given \u03a0 (q) (see below). Here we demonstrate that this \"static\" construction\nproduces a microcanonical ensemble, and construct equivalent (in the thermodynamic limit, i.e. N \u2192 \u221e) canonical\nand grand canonical ensembles as limiting equilibrium states of simple dynamical processes.\nIn statistical mechanics, equilibrium ensembles arise as infinite-time limiting distributions of some ergodic dynamics.\nHere we present naturally looking graph evolution models, using the generalization of the concept of \"preferential\nlinking\", which was introduced in [4]. We consider two kinds of a random network evolving under the mechanism\nof preferential linking and displaying ergodic behavior. The latter means that an evolving ensemble finally becomes\nequilibrium, and final statistical weights for the complete set of graphs of the ensemble are independent of time\nand initial state. The specific rule of preferential linking that we use allows us to construct equilibrium statistical\nensembles with an arbitrary \u03a0 (q).\nThe paper is organized as follows. In Section II we introduce the main notions of random graph theory. The next\nSection III is a key one: we establish a connection between ergodic evolution and statistical ensembles for undirected\ngraphs. In Section IV these results are generalized to the case of directed graphs. Section V is devoted to networks\n\n1\n\n\fwith a fat-tailed degree distribution, decaying slower than exponential. The results are discussed in the last Section\nVI. Technical details are described in three Appendices.\nII. DEFINITIONS AND MAIN NOTIONS\n\nA graph g is a set of N vertices connected by L edges, directed or undirected. It may be displayed as a set of points,\nwith some pairs connected by one or more lines, with or without arrows. For analytic purposes, a graph is represented\nby an N \u00d7 N adjacency matrix b\ng, whose elements gij are numbers of edges connecting vertices i and j.\nAn undirected graph (with undirected edges), is represented by a symmetric adjacency matrix, gij = gji . In this\ncase it is convenient to set diagonal elements gii to be equal to twice the number of unit-length loops. Then, the\nadjacency matrix gb(1) of an undirected graph G1 , obtained from a directed graph G with an adjacency matrix b\ng by\n(1)\nreplacing all directed edges with undirected ones, is simply gij = gij + gji .\nMayer's graphs are the ones without multiple connections and one-vertex loops. Their adjacency matrix elements\n2\nsatisfy the conditions: gij\n= gij , gii = 0.\nP\nVertex in-degree ri of a vertex i in a directed graph is a number of incoming edges of the vertex i, ri = j gij .\nP\nSimilarly, out-degree si is a number of edges, outgoing from the vertex i, si = j gji . Vertex degree for undirected\nP\nP\ngraph is qi = j gij = j gji .\nA statistical ensemble of graphs is defined by choosing of a set G of graphs and a rule that associates some statistical\nweight (unnormalized measure) P (g) > 0 with any\nPA (g) that\nPgraph g \u2208 G. Then the ensemble average of any quantity\ndepends on properties of a graph is hAi = Z \u22121 g\u2208G A (g) P (g), where Z is a partition function, Z \u2261 g\u2208G P (g).\nFor instance, let A (g) be the total number of vertices of in-degree r and out-degree s:\nN (r, s; g) =\n\nN\nX\ni=1\n\n\u03b4 [ri (g) \u2212 r] \u03b4 [si (g) \u2212 s] .\n\n(1)\n\nHere N is the total number of vertices in the graph g (we consider only ensembles with a fixed number of vertices).\nThe probability that a randomly chosen vertex has in-degree r and out-degree s (a degree distribution) is\n+\n*N\nhN (r, s)i\n1 X\n\u03a0 (r, s) \u2261\n\u03b4 [ri (g) \u2212 r] \u03b4 [si (g) \u2212 s] .\n(2)\n=\nN\nN i=1\nFor an undirected graph, one can define the number of vertices with a given degree q\nN (q) =\n\nN\nX\ni=1\n\n\u03b4 [qi (g) \u2212 q] ,\n\n(3)\n\nand a degree distribution\n1\nhN (q)i\n=\n\u03a0 (q) =\nN\nN\n\n*\n\nN\nX\ni=1\n\n\u03b4 [qi (g) \u2212 q]\n\n+\n\n.\n\n(4)\n\nIn this paper we consider statistical ensembles with non-Mayer's graphs allowed. The advantage of this assumption\nis that one can associate a statistical weight with a graph by using the same rules, as for the contribution of the\ncorresponding Feynman diagram in an appropriately chosen zero-dimensional field theory (see [11,12]).\nNote that we consider labeled graphs. That is, two graphs, g and g \u2032 , which differ only by numeration of vertices,\nare treated as different ones.\nIII. EVOLUTION OF GRAPHS AND STATISTICAL ENSEMBLES: UNDIRECTED GRAPHS\n\nIn this section we discuss how ensembles of undirected graphs arise as a result of the network evolution. For\nsimplicity, we restrict ourselves to undirected graphs-generalization to the case of directed ones is presented in the\nnext section. We define the statistical weights of the canonical and grand canonical ensembles of random networks as\na limiting equilibrium distribution of a process, during which one graph g \u2208 G of the ensemble transforms to another\ngraph g \u2032 \u2208 G with probability W (g \u2032 , g) dt. The statistical weights P (g, t) evolve according to the master equation\n2\n\n\f\u2202t P (g, t) =\n\nX\n\ng\u2032 \u2208G\n\n[W (g, g \u2032 ) P (g \u2032 , t) \u2212 W (g \u2032 , g) P (g, t)] .\n\n(5)\n\nAn equilibrium ensemble is a stationary one. P (g, t) = P (g) is independent of t, where statistical weights are\ndetermined by the detailed balance condition (absence of \"currents\"):\nW (g, g \u2032 )P (g \u2032 ) = W (g \u2032 , g)P (g) .\n\n(6)\n\nThis equilibrium ensemble exists if and only if the set of \"hopping rates\" W (g, g \u2032 ) satisfies two conditions: (i) For any\npair of graphs g, g \u2032 \u2208 G, there exists a sequence of graphs g1 , g2 , . . . gn \u2208 G such that\nW (g \u2032 , gn )W (gn , gn\u22121 ) . . . W (g2 , g1 )W (g1 , g) 6= 0 .\n\n(7)\n\n(ii) For any sequence of graphs g1 , g2 , . . . gn \u2208 G, the equality:\nW (g1 , g2 )W (g2 , g3 ) . . . W (gn\u22121 , gn )W (gn , g1 ) = W (g1 , gn )W (gn , gn\u22121 ) . . . W (g3 , g2 )W (g2 , g1 ) ,\n\n(8)\n\nis valid.\nThese conditions ensure that (a) ascribing an arbitrary statistical weight to some graph, one can obtain statistical\nweights of all other graphs up to a constant multiple, and (b) this definition is unambiguous: the weights are independent of the ways connecting initial graph with all the other ones. To satisfy condition (ii), it is sufficient to assume\nthe factorization:\nW (g \u2032 , g) = Vf (g \u2032 )Vi (g) .\n\n(9)\n\nOur dynamical constructions, which are presented below, satisfy this condition. We use simple natural assumptions\nabout the evolution rates W (g \u2032 , g), but our choice is not unique (e.g., see a \"Metropolis algorithm\" from Refs. [11,12]).\nWe consider the following equilibrium statistical ensembles of graphs with a fixed total number of vertices N . A\nstatistical ensemble is a set of graphs G plus rules that determine statistical weighs P (g) for all graphs g \u2208 G.\n1. A microcanonical ensemble [3].\nP\n(set) Let N (q) be a sequence of non-negative integers such that 0 < q N (q) = N < \u221e. GMC is the set of all\ngraphs of size N , for which number of vertices of degree q is equal to N (q).\n(rule) To each graph g \u2208 GMC ascribe the weight\nPMC (g) = N \u2212L\n\nN\nN\nY\nqi ! Y 1\n.\ng !!\ngjk !\ni=1 ii\n\n(10)\n\nj<k=1\n\nThis is a \"static\" construction. These statistical weights follow from pure combinatorics. They are just the number\nof possible ways to obtain a given graph g \u2208 GMC by connecting together N vertices with degrees q1 , q2 , . . . qN (see\nproof in Appendix A). The multiple N \u2212L is introduced to ensure the extensiveness of the \"free energy\", ln ZMC . Eq.\n(10) implies, that edges in the graph are distinguishable. Note that if only Mayer graphs are allowed, all graphs in\nthis ensemble have equal weights. In the thermodynamic limit [19], the microcanonical ensemble is described by a\nsequence of values {\u03a0 (q)} or, which is the same, {N (q)} (in particular, this includes the mean degree q\u0304 \u2190 2L/N ).\nTo construct canonical and grand canonical ensembles we use the processes of rewiring [20] or of deletion/creation\nof edges [21], and the idea of preferential linking [4,22,23]. We assume that the probability that an edge becomes\nattached to a vertex i depends only on the degree qi of this vertex. This probability is determined by some preference\nfunction f (q).\n2. A canonical ensemble.\n(set) The set GC consists of all graphs with N vertices and L edges.\n(rule) At each step of the evolution, one of the ends of a randomly chosen edge is rewired to a preferentially chosen\nvertex k. Let the rate of this process be f (qk ) [24]. The limiting stationary statistical weights give PC (g).\nIn the thermodynamic limit, the canonical ensemble is described by {f (q)} and q\u0304 \u2190 2L/N . Note that the\nmultiplication of f (q) by a constant, f (q) \u2192 Cf (q), is simply the rescaling of time, t \u2192 t/C. It does not\ninfluence equilibrium properties.\n\n3\n\n\f3. A grand canonical ensemble.\n(set) The set GGC consists of all graphs with any number of edges and a fixed number of vertices, N .\n(rule) There are two parallel processes in this case: edges are deleted and emerge permanently. Randomly chosen edges\nare deleted at a rate \u03bbN (\u03bb is the inverse lifetime of an edge, \u03bb is fixed as N \u2192 \u221e, i.e., in the thermodynamic\nlimit). Edges between vertices i and j emerge at a rate f (qi ) f (qj ). To ensure the correspondence with the\ncanonical ensemble, let the deletion rate of tadpoles be 2\u03bbN .\nIn the thermodynamic limit, the grand canonical ensemble is described by {f (q)} and \u03bb.\nLet us obtain, for example, statistical weights for the canonical ensemble. Let an edge (i, j) of a graph g be rewired\nto (i, k) in a graph g \u2032 . We have the following balance equation for the statistical weights of these two graphs:\n\u0001\n\u2032\n(11)\ngik\nf qj\u2032 PC (g \u2032 ) = gij f (qk ) PC (g) .\n\n\u2032\nHere quantities with a prime mark are referred to the graph g \u2032 , qj\u2032 = qj \u2212 1, gik\n= gik + 1 + \u03b4ik (adding a tadpole\nincreases gii by two). The multiple gij is present, because rewiring any of (i, j) edges gives the same result. One can\nlook for the solution in the form:\n\nPC (g) = N \u2212L\n\nN\nY\n\np (qi ) \u03c7d (gii )\n\ni=1\n\nN\nY\n\n\u03c7 (gjk ) ,\n\n(12)\n\nj<k=1\n\nwhere p, \u03c7 and \u03c7d are some functions of an integer argument. Substituting Eq. (12) into Eq. (11), we obtain at i 6= j,\ni 6= k: p (q + 1) = f (q) p (q), \u03c7 (g + 1) = \u03c7 (g) / (g + 1). Setting i = j or i = k, we get: \u03c7d (g + 2) = \u03c7d (g) / (g + 2).\nThe constant multiple N \u2212L is introduced to ensure the \"free energy\" to be extensive variable, ln ZC \u223c N . Thus we\nobtain:\np (q) =\n\nq\u22121\nY\n\nf (r) for q > 0 ,\n\np (0) = 1 ,\n\nr=0\n\n\u03c7 (g) =\n\n1\n1\n, \u03c7d (g) =\n.\ng!\ng!!\n\n(13)\n\nThen we have\nPC (g) = N \u2212L\n\nN\nN\nY\np (qi ) Y\n\ni=1\n\ngii !!\n\nj<k=1\n\n1\ngjk !\n\n.\n\n(14)\n\nComparing Eq. (14) with Eq. (10), one can see that\nPC (g) = PMC (g)\n\nN\nY\np (qi )\n\ni=1\n\nqi !\n\n.\n\n(15)\n\nAnalogously, for the grand canonical ensemble we have\nPGC (g) = (\u03bbN )\u2212L(g)\n\nN\nY\np (qi ) Y\n\ni=1\n\ngii !!\n\nj<k=1\n\n1\n= \u03bb\u2212L(g) PC (g) ,\ngjk !\n\nwhere p (q) is again given by Eq. (13). Here L(g) is the number of edges in a graph g.\nOne can present the statistical weights in a different form. For the canonical ensemble, one can write\n\"\u221e\n#\nN\nY\nX\n1 Y 1\nPC (g) =\nexp\nN (q, g) ln p (q) ,\ng !!\ngjk !\nq=0\ni=1 ii\n\n(16)\n\n(17)\n\nj<k=1\n\nThe corresponding form for the grand canonical ensemble includes the additional term \u2212L (g) ln (\u03bbN ) in the exponential:\n\n4\n\n\f\"\n#\n\u221e\nN\nX\nY\n1 Y 1\nexp \u2212L (g) ln (\u03bbN ) +\nN (q, g) ln p (q) .\nPGC (g) =\ng !!\ngjk !\nq=0\ni=1 ii\n\n(18)\n\nj<k=1\n\nThe above constructions are reasonable only if these ensembles are equivalent in the thermodynamic limit. Here\nwe show that this is the case. One can see from Eq. (17) that statistical weights of graphs with the same\nsequences {N (q, g) , q = 0, 1, 2, . . .} are equal. Then the canonical ensemble is equivalent to the microcanonical\none\nwith the same \u03a0(q)\n= hN (q)i /N if fluctuations of N (q) are negligibly small in the thermodynamic limit:\nh\ni\n2\n\nN 2 (q) \u2212 hN (q)i\nrelations:\n\n2\n\n/ hN (q)i \u2192 0 as N \u2192 \u221e. To study these fluctuations, one may use the following standard\n\u03b4 ln Z ({p (q\u0303)})\n= hN (q)i ,\n\u03b4 ln p (q)\n\u03b4 2 ln Z ({p (q\u0303)})\n= hN (q) N (q \u2032 )i \u2212 hN (q)i hN (q \u2032 )i ,\n\u03b4 ln p (q) \u03b4 ln p (q \u2032 )\n\n(19)\n\nwhich follows from Eq. (17) and the definition of the partition function. Equation (19) holds both for the canonical\nand the grand canonical ensembles.\nNotice that the transition from a microcanonical ensemble to canonical one is basically the Legendre transform [25],\nwhere some thermodynamically conjugated fields are used. In our case, the microcanonical ensemble is characterized\nby a sequence of {N (q)}, and the conjugated fields are {ln p (q)}. In the grand canonical ensemble, \u2212 ln (\u03bbN ) is\nanalogous to a standard chemical potential or, more precisely, to \u03bc/kT .\nThe partition function of the grand canonical ensemble is\n\u221e\nX\n\nZGC (N, \u03bb, {p (q)}) =\n\nL=0\n\n\u03bb\u2212L ZC (N, L, {p (q)}) .\n\n(20)\n\nLet us introduce a zero-dimensional theory of real scalar field x with the action [11,12]\n\u039b\nS (x) = \u2212 x2 \u2212 \u03ba\u03a6 (x) ,\n2\n\n(21)\n\nwhere\n\u03a6 (x) =\n\nX p (q)\nq!\n\nq\n\nxq .\n\n(22)\n\nThen the generating functional of this theory can be expanded in the series of all possible Feynman diagrams, whose\ncontributions coincide with statistical weights:\nr\nZ\n\u221e\nN\nX\n(\u2212\u03ba)\n\u039b +\u221e\nZ (\u039b, \u03ba, {p (q)}) =\nZGC (N, \u039b/N, {p (q)}) .\n(23)\ndx exp S (x) =\n2\u03c0 \u2212\u221e\nN!\nN =0\n\nThen we come to the expression\nZGC (N, \u03bb, {p (q)}) =\n\nr\n\nN\u03bb\n2\u03c0\n\nZ\n\n+\u221e\n\n\u2212\u221e\n\n\u0013\n\u0012\nN\u03bb 2\nN\nx [\u03a6 (x)] .\ndx exp \u2212\n2\n\n(24)\n\nFrom Eq. (20) it follows that\nZC (N, L, {p (q)}) =\n\nI\n\nC\n\nd\u03bb L\u22121\n\u03bb\nZGC (N, \u03bb) ,\n2\u03c0i\n\n(25)\n\nwhere the integration contour C has no singularities outside of it. Substituting Eq. (24) into Eq. (25), changing the\norder of integration, and calculating the integral over \u03bb, we have\nI\ndx \u22122L\u22121\nN\nZC (N, L, {p (q)}) = N \u2212L (2L \u2212 1)!!\nx\n[\u03a6 (x)] .\n(26)\nc 2\u03c0i\n5\n\n\fwhere the contour c encircles the point x = 0. This derivation is rather formal, because convergence of the integrals\nfor the generating functional Z, Eq. (23), and for the grand canonical partition functions, Eq. (24), depends on the\nproperties of \u03a6 (x). These integrals are well defined and converge if the diagrammatic series for the corresponding\npartition functions, or for the generating functional, converge. Note that the partition function of the grand canonical\nensemble does not exist if either ln \u03a6 (x) is growing faster than x2 at x \u2192 \u221e, or \u03a6 (x) has singularities at the real\naxis (series (22) has a finite radius of convergence). But for the canonical ensemble, the partition function does exist\nfor every \u03a6 (x), which is analytic at x = 0. Indeed, for the canonical ensemble, the partition function is a sum over a\nfinite set of graphs, while for the grand canonical ensemble, it is an infinite series, which may diverge. More detailed\nderivation of Eqs. (24) and (26) is presented in Appendix B. Note also that the expression (26) coincides with that\nfor the partition function of the backgammon (\"balls in boxes\") model [15].\nAs N \u2192 \u221e, one can use the saddle point expression:\n\u0013L\n\u0012\nq\u0304\nN\nZC (N, L, {p (q)}) \u2192\n[\u03a6 (xs )] ,\n(27)\nex2s\nwhere q\u0304 = 2L/N is the average vertex degree and the saddle point xs is given by the equation\nq\u0304 = xs\n\n\u03a6\u2032 (xs )\n.\n\u03a6 (xs )\n\n(28)\n\nWe omitted a preexponential saddle-point multiple in Eq. (27) as insignificant in the thermodynamic limit. For grand\ncanonical ensemble we have:\n\u0012\n\u0013\nN\u03bb 2\nZGC (N, \u03bb, {p (q)}) = exp \u2212\n(29)\nx [\u03a6 (xs )]N ,\n2 s\n\u03bbxs =\n\n\u03a6\u2032 (xs )\n.\n\u03a6 (xs )\n\n(30)\n\nFrom the fact that the logarithm of the partition function of the canonical ensemble is extensive, ln ZGC \u223c N (see\nEqs. (19) and (27)), it follows that hN (q) N (q \u2032 )i \u2212 hN (q)i hN (q \u2032 )i = O (N ), so that the canonical ensemble is indeed\nequivalent to the microcanonical one. Analogously, using the relations\nhLi = \u2212\n\n\u2202 ln ZGC\n,\n\u2202 ln \u03bb\n2\n\nL2 \u2212 hLi =\n\n\u2202 2 ln ZGC\n= O (N ) ,\n\u2202(ln \u03bb)2\n\n(31)\n\none finds that the fluctuations of the number of edges L in the grand canonical ensemble disappear in the thermodynamic limit. This demonstrates the equivalence of the grand canonical and canonical ensembles, if f (q) grows\nnot very fast with q, which allows the existence of the grand canonical ensemble. Their parameters are related as:\n\u03bb = Lx2s /N = q\u0304x2s .\nFrom Eqs. (19), (22) and (27)\u2013(30), one sees that\n\u03a0 (q) =\n\nhN (q)i\np (q) xqs\n=\n.\nN\nq!\u03a6 (xs )\n\n(32)\n\nThis is valid for both the canonical and grand canonical ensembles. Note that Eq. (32) may be also derived directly\nfrom the evolution equation for the degree distribution (see Appendix C). Equations (28) or (30), and (32) fix the\none-to-one correspondence between the degree distribution \u03a0 (q), which determines the microcanonical ensemble, and\nthe set of parameters (q\u0304, {f (q)}) or, equivalently, (q\u0304, {p (q)}) (see Eq. (13)). From Eqs. (13) and (32), it follows\n\u03a0 (q + 1) /\u03a0 (q) = f (q) xs / (q + 1). Then one can correspond the microcanonical ensemble which is described by a\ndegree distribution \u03a0 (q) with the canonical and grand canonical ensembles characterized by (i)\n\u03a0 (q + 1)\n,\n(33)\n\u03a0 (q)\nP\n(f (q) is defined up to an arbitrary multiple), and (ii) by q\u0304 = q q\u03a0 (q) for the canonical ensemble, or \u03bb = q\u0304 for the\ngrand canonical one.\nf (q) = (q + 1)\n\n6\n\n\fIV. GENERALIZATION TO THE CASE OF DIRECTED GRAPHS\n\nA microcanonical ensemble of directed graphs is characterized by a distribution function \u03a0 (r, s), which is the probability that a randomly chosen vertex has in-degree r andP\nout-degree s. More precisely, one must define non-negative\nintegers Nn (r, s) with the following properties: 0 < Nn = r,s Nn (r, s) < \u221e, Nn \u2192 \u221e and Nn (r, s) /Nn \u2192 \u03a0 (r, s) as\nP\nn \u2192 \u221e. For a directed graph, we also must require, that total in- and out-degrees are equal: r,s (r \u2212 s) Nn (r, s) = 0.\nThen for each n, we introduce the ensemble of directed graphs with Nn (r, s) vertices of in-degree r and out-degree s,\nNn vertices in total, connected in all possible ways. To each this graph g, we ascribe for a statistical weight equal to\nthe number of possible ways to construct the graph g:\nPMC (g) =\n\nN\nY\n\nri !si !\n\ni=1\n\nN\nY\n\nj,k=1\n\n1\n.\ngjk !\n\n(34)\n\nThe limit of such a sequence at n \u2192 \u221e would be the microcanonical ensemble with a given degree distribution \u03a0 (r, s).\nCanonical and grand canonical ensembles may be introduced quite analogously to what it had been done for\nundirected graphs. For example, the canonical ensemble may be introduced by using the process of rewiring one\nend of an edge. There are two differences from the undirected graph constructions: (i) we introduce two generalized\npreferential attachment functions, f1 for rewiring the outgoing end of an edge, and f2 for rewiring the incoming end,\nand (ii) in general, these function depend on both the in- and out-degrees of the destination vertex. Applying detailed\nbalance conditions for transitions between graphs g1 and g2 (edge i \u2192 j rewires to i \u2192 k), and between graphs g3\nand g4 (edge i \u2190 j rewires to i \u2190 k), we obtain the relations:\n\u0010\n\u0011\n\u0011\n\u0010\n(1) (1)\n(1)\n(2) (2)\n(2)\nPC (g2 ) = gij f1 rk , sk PC (g1 ) ,\ngik f1 rj , sj\n(2)\n\n(1)\n\n(2)\n\n(1)\n\n(4)\n\n(3)\n\n(4)\n\n(3)\n\n(2)\n\n(1)\n\n(2)\n\n(1)\n\n(2)\n\n(1)\n\n(2)\n\n(1)\n\ngij = gij \u2212 1 , gik = gik + 1 , rj = rj \u2212 1 , sj = sj , rk = rk + 1 , sk = sk ;\n\u0010\n\u0011\n\u0011\n\u0010\n(3) (3)\n(3)\n(4) (4)\n(4)\nPC (g4 ) = gji f2 rk , sk PC (g3 ) ,\ngki f2 rj , sj\n(4)\n\ngki = gki + 1 , gji = gji \u2212 1 , rj\n\n(3)\n\n(4)\n\n= rj , sj\n\n(3)\n\n(4)\n\n(3)\n\n(2)\n\n(1)\n\n= sj \u2212 1 , rk = rk , sk = sk + 1 .\n\n(35)\n\n(36)\n\nOne can look for the solution of the above equations in the form:\nPC (g) =\n\nN\nY\n\np (ri , si )\n\ni=1\n\nN\nY\n\n\u03c7 (gjk ) .\n\n(37)\n\nj,k=1\n\nThen we have:\np (r + 1, s) = f1 (r, s) p (r, s) , p (r, s + 1) = f2 (r, s) p (r, s) ;\n\u03c7 (g)\n\u03c7 (g + 1) =\n.\ng+1\n\n(38)\n(39)\n\nApplying subsequently Eqs. (38) in different order, we have:\np (r + 1, s + 1) = f1 (r, s + 1) f2 (r, s) p (r, s) = f2 (r + 1, s) f1 (r, s) p (r, s) .\nThis means that the preferential linking functions f1 and f2 cannot be chosen arbitrary but must satisfy the condition\nf1 (r, s) f2 (r, s + 1) = f1 (r + 1, s) f2 (r, s) ,\n\n(40)\n\nwhich is actually a consequence of the detailed balance condition (8).\nThe solution of Eqs. (38) is constructed in the following way. Let us consider a 2D square lattice. We associate\nf1 (r, s) with each horizontal bond connecting sites (r, s) and (r + 1, s), and associate f2 (r, s) with the vertical bond,\nconnecting sites (r, s) and (r, s + 1). Let L be some path connecting points (0, 0) with (r, s). Then,\nY\np (r, s) = p (0, 0)\n(41)\nf\u03b1d (\u03c1, \u03c3) .\nL\n\nHere (\u03c1, \u03c3) are coordinates of points along the path L, \u03b1 = 1 (2) for the horizontal (vertical) direction, and d = +1 (\u22121)\nif the bond is passed in its positive (negative) direction. The condition (40) ensures the independence of the product\n7\n\n\fin Eq. (41) of the path L. In fact, this is the condition of the potentiality (zero vorticity) of the vector field ln f\u03b1\ndefined on the square lattice. Then ln p is a potential for this field, that is ln f\u03b1 is a lattice gradient of ln p (see Eq.\n(38)). The arbitrary multiple p (0, 0) may be set, e.g., to 1. Solution of Eq. (39) is simple:\n\u03c7 (g) =\n\n1\n.\ng!\n\n(42)\n\nThe grand canonical ensemble may be constructed quite analogously to what it had been done for undirected graphs.\nTwo opposite processes are introduced: one is of edge creation, at a rate f2 (ri , si ) f1 (rj , sj ) for the edge, going from\nthe vertex i to j, the other is of the edge removal, at a rate \u03bbN . Again, f1 and f2 must satisfy the condition (40) to\nensure the equilibrium character of a stationary state. The statistical weight of a graph is given by the expression\nPGC (g) = e\u2212\u03bbL(g)\n\nN\nY\n\np (ri , si )\n\ni=1\n\nN\nY\n\nj,k=1\n\n1\n.\ngjk !\n\n(43)\n\nThe derivation of the integral representation of the partition function is quite similar to that for undirected graphs,\nbut Feynman's diagrams with directed lines now are generated by complex fields. We introduce a complex scalar field\nx, and write the action:\n2\n\nS (x, x\u2217 ) = \u2212\u039b |x| \u2212 \u03ba\u03a6 (x, x\u2217 ) ,\n\u221e\nX\np (r, s) r \u2217 s\n\u03a6 (x, x\u2217 ) =\nx (x ) .\nr!s!\nr,s=0\n\n(44)\n(45)\n\nThen the following generating functional of this field theory will produce all possible graphs with any number of\nvertices as its Feynman diagrams. Their contributions are the same as statistical weights of graphs in the grand\nN\ncanonical ensemble (43) with \u03bb = \u039b/N , except the additional multiples (\u2212\u03ba) /N !. Therefore, one can write:\nZ (\u03ba, \u039b, {p (r, s)}) =\n\n\u039b\n\u03c0\n\nZ\n\ndxdx\u2217 exp S (x, x\u2217 ) =\n\n\u221e\nX\n(\u2212\u03ba)N\nZGC (N, \u039b/N, {p (r, s)}) ,\nN!\n\n(46)\n\nN =0\n\nwhere the integration is over the entire complex plane (compare with Eq. (23)). Therefore,\nZ\n\u0011\n\u0010\nN\u03bb\ndxdx\u2217 exp \u2212N \u03bb |x|2 [\u03a6 (x, x\u2217 )]N .\nZGC (N, \u03bb, {p (r, s)}) =\n\u03c0\n\n(47)\n\nIn Eqs. (46), (47) one should treat x and x\u2217 as independent integration variables when actually calculating the\nintegrals. The partition function of the canonical ensemble is given by\nI\nI\nL!\ndy\ndx\n\u2212L\u22121\nN\nZC (N, L, {p (r, s)}) = L\n(xy)\n[\u03a6 (x, y)] ,\n(48)\nN\n2\u03c0i\n2\u03c0i\nC2\nC1\nwhere the integration contours C1,2 encircle points x = 0, y = 0, respectively. The derivation of Eq. (48) is quite\nsimilar to that of Eq. (26) for undirected graphs.\nAgain, in the thermodynamic limit, N \u2192 \u221e, L \u2192 \u221e, 2L/N \u2192 q\u0304, one can use a saddle point approximation, which\ngives\n\u0012\n\u0013L\nq\u0304\nN\nZC (N, L, {p (r, s)}) \u2192\n[\u03a6 (xs , ys )] ,\n(49)\nexs ys\nwhere xs and ys are defined from the stationary point equations:\nq\u0304 = xs\n\n\u2202 ln \u03a6 (xs , ys )\n\u2202 ln \u03a6 (xs , ys )\n= ys\n.\n\u2202xs\n\u2202ys\n\n(50)\n\nFor the grand canonical ensemble, we have\nZGC (N, \u03bb, {p (r, s)}) \u2192 exp (\u2212N \u03bbxs ys ) [\u03a6 (xs , ys )]\n\nN\n\nwhere the saddle point coordinates xs and ys are determined from the equations:\n8\n\n,\n\n(51)\n\n\f\u03bbys =\n\n\u2202 ln \u03a6 (xs , ys )\n\u2202 ln \u03a6 (xs , ys )\n, \u03bbxs =\n.\n\u2202xs\n\u2202ys\n\n(52)\n\nThe degree distribution both for the canonical and grand canonical ensembles is defined by\n\u03a0 (r, s) =\n\n\u03b4 ln Z ({p (u, v)})\np (r, s) r s\nhN (r, s)i\n=\n\u2192\nx y ,\nN\nN \u03b4 ln p (r, s)\nr!s! s s\n\n(53)\n\nwhere the last relation is valid in the thermodynamic limit. Eqs. (53), (50) and (41) establish correspondence\nbetween the microcanonical ensemble with the degree distribution \u03a0 (r, s) and the canonical one, characterized by the\npreferential linking functions f1,2 and the mean vertex degree q\u0304. The parameters of the canonical and grand canonical\nensembles with the same degree distribution are related as\nq\u0304 = \u03bbxs ys .\n\n(54)\n\nThis relation follows from Eqs. (50) and (52).\nAgain, as it was for undirected graphs, the canonical ensemble does exist for every p (r, s), provided that power\nseries (45) has finite radii of convergence on both x and y. Conditions for the existence of the grand canonical ensemble\nare essentially more strict: the integral in Eq. (47) must be well defined and convergent.\nV. FAT-TAILED DEGREE DISTRIBUTIONS\n\nIn this section we shall consider in detail properties of the canonical ensembles of graphs, which arise if a preference\nfunction f (q) grows rapidly enough.\nFor brevity, we focus on the undirected graphs. The generalization to the ensembles of directed graphs is straightforward.\nAs one can see from Eq. (24), the grand canonical ensemble does not exist in two cases. In the first case the\nintegral, representing the partition function, diverges, since the function \u03a6 (x) grows fast enough at x \u2192 \u00b1\u221e. In the\nsecond case, the integral is not determined, because \u03a6 (x) has a singularity on the real axis. In both the situations\nwe have degree distributions, which decay relatively slowly as q \u2192 \u221e. Let us begin with the case, when \u03a6 (x) has no\nsingularities, but ln \u03a6 (x) grows faster than x2 as |x| \u2192 \u221e.\nUsing Eqs. (22) and (32), one can write the following relation:\n\u221e\n\nX\n\u03a6 (x)\n=\n\u03a0 (q)\n\u03a6 (xs ) q=0\n\n\u0012\n\nx\nxs\n\n\u0013q\n\n,\n\n(55)\n\nthat is \u03a6 (x) is expressed in terms of the Z-transform of \u03a0 (q). Using the formula for the inverse of Z-transform, we\nobtain\nI\ndx \u0010 xs \u0011q \u03a6 (x)\n\u03a0 (q) =\n.\n(56)\n2\u03c0ix x\n\u03a6 (xs )\nFor finding the relation between the asymptotic behaviours of \u03a6 (x) and \u03a0 (q), let us use a saddle point approximation\nin Eq. (56). It is convenient to set \u03a6 (x) = exp \u03c6 (x). The equation for the saddle point xa is q = xa \u03c6\u2032 (xa ). Then the\nasymptotic expression for \u03a0 (q) is\n\u0012 \u0013q\nxs\n\u22121/2\n\u03a0 (q) \u2192 {2\u03c0xa [xa \u03c6\u2032\u2032 (xa ) \u2212 \u03c6\u2032 (xa )]}\nexp [\u03c6 (xa ) \u2212 \u03c6 (xs )]\n(57)\nxa\nThe integral for the grand canonical partition function in Eq. (24) is divergent, if \u03c6 (x) grows as x2 or faster at\n1/\u03bc\nx \u2192 \u221e. Assume that \u03c6 (x) \u2192 Ax\u03bc as x \u2192 \u221e. Then the saddle point equation is q = A\u03bcx\u03bc , and xa \u2192 (q/A\u03bc) .\nOmitting irrelevant multiples, we have from Eq. (57):\n\u22121/2\n\n\u03a0 (q) \u223c (2\u03c0q)\n\n\u0012\n\nq\u0304\ne\nq\n\n\u0013q/\u03bc\n\n\u223c [\u0393 (q)]\n\nThus, if the degree distribution \u03a0 (q) decays slower than [\u0393 (q)]\ncorresponding grand canonical ensemble diverges.\n9\n\n\u22121/2\n\n\u22121/\u03bc\n\n.\n\n(58)\n\nas q \u2192 \u221e, then the partition function of the\n\n\fThe reason for this divergence is that we have admitted the existence of non-Mayer's graphs. Indeed, let us choose\nsome pair of vertices in a graph. Let us add more and more edges connecting this pair. The statistical weight of the\ngraph with \u03bd edges between this pair contains multiple p (qi ) p (qj ) /\u03bdij !, where qi = \u03bdij + const, qj\u221a= \u03bdij + const. One\ncan easily conclude that the statistical weights approach 0 as \u03bd \u2192 \u221e only if p2 (q) /q! \u2192 0, or q!\u03a0 (q) \u2192 0. The\nsame result may be attained if we consider a sequence of graphs obtained by subsequent addition of closed loops to a\nchosen vertex. This result may also be presented in the different way: if the preference function f (q) = p (q + 1) /p (q)\n\u221a\ngrows faster than q at large q, then the partition function of the grand canonical ensemble diverges.\nThe radius of convergence of the series expansion (22) is\nRc = lim\n\nq\u2192\u221e\n\nq+1\n(q + 1) p (q)\n= lim\n.\nq\u2192\u221e f (q)\np (q + 1)\n\n(59)\n\nIf f (q) grows as q \u2192 \u221e slower than a linear function, then Rc = \u221e. In this case \u03a6 (x) has no singularities at all.\nThis means that (i) the partition function of the canonical ensemble may be expressed in the form (26), and (ii) in\nthe thermodynamic limit, one can use for this function its saddle point expression, Eqs. (27) and (28). If f (q) grows\nfaster than a linear function, then Rc = 0. This means that although the canonical ensemble exists (the canonical\nensemble always exists, because it is represented by a finite set of graphs at any finite N and L), its partition function\ncan not be written in the form of the integral representation (26). Actually, this means the absence of any meaningful\nthermodynamic limit.\nThe interesting case is 0 < Rc < \u221e. In this case, the partition function of the canonical ensemble can be expressed\nas an integral, but the saddle point expression for this integral may not be longer valid. The saddle point expression\nis not valid at a large enough number of edges in the network, when the saddle point approaches the position of\nsingularity. We show that in this situation, \"fat-tailed\" degree distributions, i.e. ones decreasing slower than an\nexponent, may arise.\nWithout any lack of generality, one can set Rc = 1 in this case. This is equivalent to f (q) = q + o (q) as q \u2192 \u221e.\nIn Eq. (28) its right hand side is a monotonously increasing function of xs . This means that as q\u0304 = 2L/N grows,\nxs grows too. As xs < Rc = 1, the degree distribution contains exponentially decaying multiple xqs . There are two\npossibilities depending on the character of the singularity of \u03a6 (x) at x = 1: either \u03a6\u2032 (xs ) \u2192 \u221e, or it approaches\nsome finite value as xs \u2192 \u221e. In the former case, again there are two possibilities: either limx\u21921 \u03a6 (x) is finite, or this\nlimit is infinite. If \u03a6 (1) is finite (but \u03a6\u2032 (1) is infinite), then the degree distribution approaches some limiting form as\nq\u0304 \u2192 \u221e, and the first moment of this limiting distribution diverges. This means that such a degree distribution can\nnot be realized in any canonical ensemble with a finite number of edges per vertex. To construct networks with such\na distribution, one has to change the conditions of the thermodynamic limit transition in the canonical ensemble,\nassuming N \u2192 \u221e, L \u2192 \u221e and q\u0304 = 2L/N \u2192 \u221e, instead of keeping q\u0304 fixed. Another way is to use a microcanonical\nensemble. If \u03a6 (1) is infinite, no normalizable degree distribution without an exponential cut-off is possible.\nNow, let us consider the case \u03a6\u2032 (1) < \u221e. The degree distribution becomes \"fat-tailed\" when xs = 1, which takes\nplace when q\u0304 = q\u0304c = \u03a6\u2032 (1) /\u03a6 (1). If q\u0304 > qc , the saddle point equation (28) has no solution 0 < xs < 1. In this case,\nin the thermodynamic limit, the partition function remains the same up to a preexponential factor as for q\u0304 = qc .\nIndeed, let us rewrite Eq. (26) as\nI\n\u0003N\ndx \u0002 \u2212q\u0304\nZC (N, L, {p (q)}) = N \u2212L (2L \u2212 1)!!\nx \u03a6 (x) .\n(60)\nc 2\u03c0ix\n\nTo calculate a large N asymptotics one has to deform the integration contour into the steepest descent one, intercepting\nthe real axis at the point, where x\u2212q\u0304 \u03a6 (x) is minimal within the interval (0, 1), and going along the line of the constant\n(i.e. zero) imaginary part. If q\u0304 < qc , this is a usual saddle-point contour, crossing the real axis perpendicularly at\nsome point xs < 1. If q\u0304 > qc , this contour consists of two complex conjugate parts meeting always at x = 1.\nAs q\u0304 grows, the point, where the integrand is maximal, xs = 1, does not move. The only change is that the two\nbranches of the contour become closer and closer to the real axis in the vicinity of x = 1 at x > 1. But it is xs\nand \u03a6 (xs ) that determine the value of the main (extensive) contribution to the logarithm of the partition function:\nln ZC = \u2212L ln (q\u0304xs ) + N ln \u03a6 (xs ) + o (N ). The extensive part of the \"free energy\" \u2212 ln Z does not depend on q\u0304 as\nq\u0304 > qc . So, the degree distribution N \u22121 \u03b4 ln Z/\u03b4 ln p (q) (see Eqs. (4) and (19)) remains equal to its critical point\nvalue \u03a0c (q). Consequently, the finite fraction of edges, q\u0304/q\u0304c \u2212 1, is attached to an infinitely small fraction of vertices,\nforming a \"condensate\", quite analogous to the one in the backgammon model [15,26].\nA specific form of the degree distribution at the critical point depends on the behaviour of this difference f (q) \u2212 q =\no (q) as q \u2192 \u221e. For example, for the so called \"scale-free\" distributions, \u03a0 (q) \u221d q \u2212\u03b3 as q \u2192 \u221e (\u03b3 > 2), we obtain\nfrom Eq. (33):\n\u0001\n(61)\nf (q) = q + 1 \u2212 \u03b3 + O q \u22121\n10\n\n\f\u2212\u03b3\nat the critical point. For the same f (q) but for lower average degrees q\u0304 < q\u0304c , we have \u03a0 (q) \u221d x\u2212q\nat large q.\ns q\nSo, the state with a power-law degree distribution is marginal for the phase without the condensate of edges [27].\n(A \"scale-free\" state as a line between \"generic\" and \"crumpled\" phases on the phase diagram of trees was found\nin Ref. [11], see also the condensation transition in the backgammon model [15].) Our analysis has shown that the\ncondensation takes place above q\u0304c [28]. Furthermore, the fat-tailed degree distribution is present also in the condensed\nphase. The problem of the condensed phase is more complex for the ensembles of Mayer's graphs, that is the ones\nwithout tadpoles and melons. The nature of condensation transition in such ensembles will be discussed elsewhere.\n\nVI. CONCLUSIONS\n\nThus, we have developed the consistent description of random networks in the framework of classical statistical\nmechanics. Using the traditional formalism of statistical mechanics, we have constructed a set of equilibrium statistical\nensembles of uncorrelated random networks and have found their partition functions and main characteristics. We\nhave proposed a set of natural dynamical procedures, which generate equilibrium networks as a limiting state of the\nevolution, and have established a one-to-one correspondence between rules of these ergodic procedures and equilibrium\nensembles of networks. This program has been realized both for directed and undirected networks.\nWe have shown that a \"scale-free\" state (and fat-tailed degree distributions) in equilibrium uncorrelated networks\nwithout condensation of edges on vertices may exist only in a single marginal point. So, it is rather an exception\n[29]. This differs crucially from the situation for growing networks. The latter, while growing, may self-organize into\nscale-free structures in a wide range of parameters without any condensation. In summary, we have developed a\nstatistical physics approach to equilibrium random networks.\nS.N.D. thanks PRAXIS XXI (Portugal) for a research grant PRAXIS XXI/BCC/16418/98. S.N.D. and J.F.F.M.\nwere partially supported by the project POCTI/99/FIS/33141. A.N.S. acknowledges the NATO program OUTREACH for support. We also thank V.V. Bryksin, A.V. Goltsev, A. Krzywicki, and F. Slanina for useful discussions.\nAPPENDIX A: STATISTICAL WEIGHTS FOR THE MICROCANONICAL ENSEMBLE\n\nInitially, we have N vertices (\"hedgehogs\") with qi edges (\"halves\" of edges, speaking more precisely) protruding\nfrom an i-th one. Here we count the number of ways of connecting them in pairs to obtain a given graph with a given\nnumber of edges gij between vertices i and j. For vertices with unit-length loops (\"tadpoles\") we set gii to be equal\nto twice the number of such loops. The number of ways to choose gi1 , gi2 , . . . giN edges from qi = gi1 + gi2 + * * * + giN\nones, attached to the i-th vertex is\nqi !\n.\ngi1 !gi2 ! * * * giN !\n\n(A1)\n\nThen we have to connect in pairs gij dangling edges, attached to the i-th vertex, and gji = gij edges attached to\nthe j 6= i vertex. This can be done by gij ! different ways. Also, the number of ways to join gii dangling edges in\npairs to form gii /2 closed loops is (gii \u2212 1) (gii \u2212 3) * * * 1 = (gii \u2212 1)!!. Finally, combining together N multiples (A1)\nfor each vertex, N (N \u2212 1) /2 multiples gij ! for each pair of vertices, multiples (gii \u2212 1)!! for each vertex, containing\nunit-length loops, and taking into account that (gii \u2212 1)!!/gii ! = 1/gii !!, we arrive at Eq. (10).\nAPPENDIX B: INTEGRAL REPRESENTATION OF THE PARTITION FUNCTION FOR CANONICAL\nENSEMBLE\n\nThe partition function of the canonical ensemble is\nZC (N, L) = N \u2212L\n\nX\n\ng\u2208\u03a9(N,L)\n\nN\nN\nY\np (qi ) Y 1\n,\ngii !!\ngjk !\ni=1\n\n(B1)\n\nj<k=1\n\nwhere the set \u03a9 (N, L) is a set of N 2 non-negative integers gij \u2265 0 with the following properties: (i) gii are even, (ii)\ngij = gji , and (iii)\n\n11\n\n\fN\nN\nN\nX\nX\ngii\n1 X\ngij = L .\ngij =\n+\n2 i,j=1\n2\ni=1\ni>j=1\n\n(B2)\n\nSo, N (N + 1) /2 variables gij , i \u2265 j, are subjected to the restriction (B2). Introducing\n\u221e\nX\np (q)\n\n\u03a6 (x) =\n\nq!\n\nq=0\n\nxq ,\n\n(B3)\n\none can write Eq. (B1) as\nZC (N, L)\nX\n\n= N \u2212L\n\n{g}\u2208\u03a9(N,L)\n\n\u2212L\n\n(2N )\n=\nL!\n\n\u2212L\n\n(2N )\n=\nL!\n\n\u0012\n\u0013gii /2 Y\nN\nN\nN h\u0010\nY\ngii \u0011 gii /2 i\u22121 \u2202 2\n\u22022 Y\n\u22121\n!2\n(g\n!)\n\u03a6 (xl )\njk\n2\n\u2202x2i\n\u2202xj \u2202xk\ni=1\nj<k=1\n\n\uf8eb\n\n\uf8f6L\nN\nN\nN\n2\n2\nX\nX\nY\n\u2202\n\u2202\n\uf8ed\n\uf8f8\n+2\n\u03a6 (xl )\n\u2202x2i\n\u2202xi \u2202xj\ni>j=1\ni=1\nl=1\n\nN\nX\n\u2202\n\u2202xi\ni=1\n\n!2L\n\nN\nY\n\nx1 =***=xN =0\n\nx1 =***=xN =0\n\n,\n\n\u03a6 (xl )\n\nl=1\n\nl=1\n\n(B4)\n\nx1 =***=xN =0\n\nwhere the relation (B2) was used. If we pass from x1 , . . . , xN to a new set of variables: x = (x1 + * * * + xN ) /N , and\ndifference variables yi = xi \u2212 xi+1 , i = 1, . . . , N \u2212 1, we have\nN\nN\nX\nX\n\u2202\n\u2202xi \u2202\n\u2202\n=\n.\n=\n\u2202x\n\u2202x\n\u2202x\n\u2202x\ni\ni\ni=1\ni=1\n\nThen\n\u2212L\n\n(2N )\nL!\n\nZC (N, L) =\n\n\u2202 2L\nN\n[\u03a6 (x)]\n\u2202x2L\n\n.\n\n(B5)\n\nx=0\n\nFinally, one can write\n\u2212L\n\nZC (N, L) =\n\n(2N )\nL!\n\n(2L)!\n\nI\n\nc\n\ndx \u22122L\u22121\nN\nx\n[\u03a6 (x)] ,\n2\u03c0i\n\n(B6)\n\nwhich is exactly Eq. (26). The contour c encircles the point x = 0.\nAPPENDIX C: EVOLUTION EQUATION FOR THE DEGREE DISTRIBUTION\n\nHere we present a simplified derivation of the evolution equation for the degree distribution \u03a0 (q, t). For example,\nwe consider a network with the rewiring of edges according to the rules formulated in Section III for the canonical\nensemble (for the grand canonical ensemble, the procedure is essentially the same). The total number of vertices, N ,\nand of edges, L, are fixed. With some probability n per unit time, a randomly chosen end of a randomly chosen edge\nis rewired to some vertex of the graph. This vertex is chosen from vertices of the graph with probability proportional\nto a given function f (qi ) of the degree qi of the vertex.\nThen, the probability that a vertex i receives a new edge per time dt is\nnf (qi )\nf (qi ) n dt\nP\n\u2192\n.\nN f (q)\nj f (qj )\n12\n\n(C1)\n\n\fIn Eq. (C1) its left-hand side may be replaced with the right-hand side in the thermodynamic limit N \u2192 \u221e (selfaveraging) if the fluctuations of N (q) can be neglected. This is true for the equilibrium state (see Eq. (19)), and so\nhere we restrict ourselves to the nonequilibrium states that fulfill this condition. Then, the infinitesimal change of the\ndegree distribution due to the rewiring of edges to a chosen vertex is\n[d\u03a0 (q, t)]to =\n\nn\nN f (q)\n\n[f (q \u2212 1) \u03a0 (q \u2212 1, t) \u2212 f (q) \u03a0 (q, t)] dt .\n\n(C2)\n\nAlso, we must take into account that the vertex may loose one of its qi edges, which will be rewired to another\nvertex. The probability nqi dt/L that one of these edges is chosen for rewiring per time dt, must be multiplied by 1/2.\nThis is the probability that of the two ends of the edge, the one attached to the i-th vertex, is chosen. Thus, the\nchange of the degree distribution due to rewiring of edges from a vertex is\n[d\u03a0 (q, t)]from =\n\nn\n[(q + 1) \u03a0 (q + 1, t) \u2212 q\u03a0 (q, t)] ,\nNq\n\n(C3)\n\nwhere q\u0304 = 2L/N is the average vertex degree. Combining Eqs. (C2) and (C3) we arrive at the evolution equation\nN \u2202\u03a0 (q, t)\n1\n1\n[f (q \u2212 1) \u03a0 (q \u2212 1, t) \u2212 f (q) \u03a0 (q, t)] + [(q + 1) \u03a0 (q + 1, t) \u2212 q\u03a0 (q, t)] .\n=\nn\n\u2202t\nq\u0304\nf (q)\n\n(C4)\n\nLooking for the stationary solution of Eq. (C4), one can easily find its first integral:\nf (q)\nq+1\n\u03a0 (q + 1) \u2212\n\u03a0 (q) = const .\nq\u0304\nf (q)\n\n(C5)\n\nOne must set const = 0 in Eq. (C5), because \u03a0 (q) = 0 at q < 0. Then we have\n\u03a0 (q + 1) = xs\n\nf (q)\n\u03a0 (q) ,\nq+1\n\n(C6)\n\nwhere we have introduced xs = q\u0304/f (q). The solution of Eq. (C6) is\n\u03a0 (q) = C\n\np (q) q\nx .\nq! s\n\n(C7)\n\nHere C and xs must be determined from the normalization condition and from the equality of the mean degree to a\ngiven value q\u0304 = 2L/N :\n\u221e\nX\nq=0\n\n\u2217\n\u2020\n\u2021\n\n\u03a0 (q) = 1 ,\n\n\u221e\nX\n\nq\u03a0 (q) = q\u0304 .\n\n(C8)\n\nq=0\n\nE-mail address: sdorogov@fc.up.pt\nE-mail address: jfmendes@fis.ua.pt\nE-mail address: samukhin@fc.up.pt\n\n[1] P. Erd\u00f6s and A. R\u00e9nyi, Publ. Math. Debrecen 6 (1959) 290; Publ. Math. Inst. Hung. Acad. Sci. 5 (1960) 17.\n[2] B. Ballob\u00e1s, Random Graphs, Academic Press, New York, 1985.\n[3] A. Bekessy, P. Bekessy, and J. Komlos, Stud. Sci. Math. Hungar. 7 (1972) 343; E.A. Bender and E.R. Canfield, J. Combinatorial Theory A 24 (1978) 296; B. Ballob\u00e1s, Eur. J. Comb. 1 (1980) 311; N.C. Wormald, J. Combinatorial Theory B 31\n(1981) 156,168; M. Molloy and B. Reed, Random Structures and Algorithms 6 (1995) 161.\n[4] A.-L. Barab\u00e1si and R. Albert, Science 286 (1999) 509.\n[5] D.J. Watts, Small Worlds: The Dynamics of Networks between Order and Randomness, Princeton Univ. Press, Princeton,\nNJ, 1999.\n[6] S.H. Strogatz, Nature 401 (2001) 268.\n\n13\n\n\f[7] R. Albert and A.-L. Barab\u00e1si, Rev. Mod. Phys. 47 (2002) 74.\n[8] S.N. Dorogovtsev and J.F.F. Mendes, Adv. Phys. 51 (2002) 1079.\n[9] S.N. Dorogovtsev and J.F.F. Mendes, Evolution of Networks: From Biological Nets to the Internet and WWW, Oxford\nUniv. Press, Oxford, 2003, in press.\n[10] Notice that in graph theory, \"random graphs\" are usually networks with a Poisson distribution of connections.\n[11] Z. Burda, J. D. Correia, and A. Krzywicki, Phys. Rev. E 64 (2001) 046118.\n[12] A. Krzywicki, cond-mat/0110574.\n[13] J. Berg and M. L\u00e1ssig, cond-mat/0205589.\n[14] Z. Burda and A. Krzywicki, cond-mat/0207020.\n[15] P. Bialas, Z. Burda, and D. Johnston, Nucl. Phys. B 493 (1997) 505; Nucl. Phys. B 542 (1999) 413.\n[16] J. Ambj\u00f8rn, B. Durhuus, and T. J\u00f3nsson, Phys. Lett. B 244 (1990) 403.\n[17] J. Ambj\u00f8rn and J. Jurkiewicz, Nucl. Phys. B 451 (1995) 643.\n[18] M.E.J. Newman, S.H. Strogatz, and D.J. Watts, Phys. Rev. E 64 (2001) 026118.\n[19] P\nTo approach thermodynamic limit of the microcanonical ensemble, one may consider a sequence of microcanonical ensembles:\nNn (q) = Nn \u2192 \u221e, Nn (q) /Nn \u2192 \u03a0 (q) as n \u2192 \u221e. Here \u03a0(q) is the degree distribution.\nq\n[20] R. Albert and A.-L. Barab\u00e1si, Phys. Rev. Lett. 85 (2000) 5234.\n[21] S.N. Dorogovtsev and J.F.F. Mendes, Europhys. Lett. 52 (2000) 33.\n[22] P.L. Krapivsky, S. Redner, and F. Leyvraz, Phys. Rev. Lett. 85 (2000) 4629; P.L. Krapivsky and S. Redner, Phys. Rev. E\n63 (2001) 066123.\n[23] S.N. Dorogovtsev, J.F.F. Mendes, and A.N. Samukhin, Phys. Rev. Lett. 85 (2000) 4633.\n[24] In the thermodynamic limit, this is equivalent to rewiring both the ends of a randomly chosen edge to vertices i and k at\nthe rate f (qi ) f (qk ).\n[25] A.N. Vasiliev, Functional Methods in Quantum Field Theory and Statistical Physics, Gordon & Breach, Amsterdam, 1998.\n[26] Z. Burda, D. Johnston, J. Jurkiewicz, M. Kaminski, M.A. Nowak, G. Papp, and I. Zahed, Phys. Rev. E 65 (2002) 026102.\n[27] In contrast, in growing networks, power-law degree distributions are realized in the case of any linear preference function\nf (q). In growing networks, if f (q) \u223c q \u03b4 , \u03b4 < 1, the distribution has a size-independent cutoff; if \u03b4 > 1, a finite fraction of\nedges are attached to a single vertex [22].\n[28] For such a condensation we do not need inhomogeneity of vertices unlike a condensation in inhomogeneous growing networks\ndue to G. Bianconi and A.-L. Barab\u00e1si, Phys. Rev. Lett. 86 (2001) 5632.\n[29] Main analytical results on percolation and disease spread on scale-free networks were obtained just for these exceptional\nequilibrium uncorrelated scale-free nets without condensate.\n\n14\n\n\f"}