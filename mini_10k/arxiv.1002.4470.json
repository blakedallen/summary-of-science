{"id": "http://arxiv.org/abs/1002.4470v2", "guidislink": true, "updated": "2011-04-20T11:27:20Z", "updated_parsed": [2011, 4, 20, 11, 27, 20, 2, 110, 0], "published": "2010-02-24T05:50:07Z", "published_parsed": [2010, 2, 24, 5, 50, 7, 2, 55, 0], "title": "Large-System Analysis of Joint Channel and Data Estimation for MIMO\n  DS-CDMA Systems", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1002.2383%2C1002.4348%2C1002.2571%2C1002.4814%2C1002.2691%2C1002.1069%2C1002.0384%2C1002.1504%2C1002.4934%2C1002.0736%2C1002.2459%2C1002.4352%2C1002.3926%2C1002.4119%2C1002.3830%2C1002.0540%2C1002.1154%2C1002.2918%2C1002.1917%2C1002.4470%2C1002.1092%2C1002.1343%2C1002.2415%2C1002.2890%2C1002.2160%2C1002.3741%2C1002.1921%2C1002.1401%2C1002.4778%2C1002.1957%2C1002.3012%2C1002.4985%2C1002.3353%2C1002.3290%2C1002.2049%2C1002.2359%2C1002.0163%2C1002.3232%2C1002.2562%2C1002.2328%2C1002.4512%2C1002.2064%2C1002.2117%2C1002.0904%2C1002.2028%2C1002.3977%2C1002.4827%2C1002.2257%2C1002.0391%2C1002.0992%2C1002.4128%2C1002.4507%2C1002.0396%2C1002.1486%2C1002.3018%2C1002.0787%2C1002.2060%2C1002.0072%2C1002.1903%2C1002.3563%2C1002.2187%2C1002.4435%2C1002.1072%2C1002.3105%2C1002.3037%2C1002.4674%2C1002.1560%2C1002.3557%2C1002.3013%2C1002.2436%2C1002.0893%2C1002.5035%2C1002.0760%2C1002.3647%2C1002.4788%2C1002.3415%2C1002.2077%2C1002.0575%2C1002.4497%2C1002.2073%2C1002.5045%2C1002.0054%2C1002.0307%2C1002.3595%2C1002.3324%2C1002.4881%2C1002.3213%2C1002.4307%2C1002.3065%2C1002.2289%2C1002.0907%2C1002.0983%2C1002.0670%2C1002.4042%2C1002.4803%2C1002.3795%2C1002.0158%2C1002.1117%2C1002.1909%2C1002.0148%2C1002.3410&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Large-System Analysis of Joint Channel and Data Estimation for MIMO\n  DS-CDMA Systems"}, "summary": "This paper presents a large-system analysis of the performance of joint\nchannel estimation, multiuser detection, and per-user decoding (CE-MUDD) for\nrandomly-spread multiple-input multiple-output (MIMO) direct-sequence\ncode-division multiple-access (DS-CDMA) systems. A suboptimal receiver based on\nsuccessive decoding in conjunction with linear minimum mean-squared error\n(LMMSE) channel estimation is investigated. The replica method, developed in\nstatistical mechanics, is used to evaluate the performance in the large-system\nlimit, where the number of users and the spreading factor tend to infinity\nwhile their ratio and the number of transmit and receive antennas are kept\nconstant. The performance of the joint CE-MUDD based on LMMSE channel\nestimation is compared to the spectral efficiencies of several receivers based\non one-shot LMMSE channel estimation, in which the decoded data symbols are not\nutilized to refine the initial channel estimates. The results imply that the\nuse of joint CE-MUDD significantly reduces rate loss due to transmission of\npilot signals, especially for multiple-antenna systems. As a result, joint\nCE-MUDD can provide significant performance gains, compared to the receivers\nbased on one-shot channel estimation.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1002.2383%2C1002.4348%2C1002.2571%2C1002.4814%2C1002.2691%2C1002.1069%2C1002.0384%2C1002.1504%2C1002.4934%2C1002.0736%2C1002.2459%2C1002.4352%2C1002.3926%2C1002.4119%2C1002.3830%2C1002.0540%2C1002.1154%2C1002.2918%2C1002.1917%2C1002.4470%2C1002.1092%2C1002.1343%2C1002.2415%2C1002.2890%2C1002.2160%2C1002.3741%2C1002.1921%2C1002.1401%2C1002.4778%2C1002.1957%2C1002.3012%2C1002.4985%2C1002.3353%2C1002.3290%2C1002.2049%2C1002.2359%2C1002.0163%2C1002.3232%2C1002.2562%2C1002.2328%2C1002.4512%2C1002.2064%2C1002.2117%2C1002.0904%2C1002.2028%2C1002.3977%2C1002.4827%2C1002.2257%2C1002.0391%2C1002.0992%2C1002.4128%2C1002.4507%2C1002.0396%2C1002.1486%2C1002.3018%2C1002.0787%2C1002.2060%2C1002.0072%2C1002.1903%2C1002.3563%2C1002.2187%2C1002.4435%2C1002.1072%2C1002.3105%2C1002.3037%2C1002.4674%2C1002.1560%2C1002.3557%2C1002.3013%2C1002.2436%2C1002.0893%2C1002.5035%2C1002.0760%2C1002.3647%2C1002.4788%2C1002.3415%2C1002.2077%2C1002.0575%2C1002.4497%2C1002.2073%2C1002.5045%2C1002.0054%2C1002.0307%2C1002.3595%2C1002.3324%2C1002.4881%2C1002.3213%2C1002.4307%2C1002.3065%2C1002.2289%2C1002.0907%2C1002.0983%2C1002.0670%2C1002.4042%2C1002.4803%2C1002.3795%2C1002.0158%2C1002.1117%2C1002.1909%2C1002.0148%2C1002.3410&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "This paper presents a large-system analysis of the performance of joint\nchannel estimation, multiuser detection, and per-user decoding (CE-MUDD) for\nrandomly-spread multiple-input multiple-output (MIMO) direct-sequence\ncode-division multiple-access (DS-CDMA) systems. A suboptimal receiver based on\nsuccessive decoding in conjunction with linear minimum mean-squared error\n(LMMSE) channel estimation is investigated. The replica method, developed in\nstatistical mechanics, is used to evaluate the performance in the large-system\nlimit, where the number of users and the spreading factor tend to infinity\nwhile their ratio and the number of transmit and receive antennas are kept\nconstant. The performance of the joint CE-MUDD based on LMMSE channel\nestimation is compared to the spectral efficiencies of several receivers based\non one-shot LMMSE channel estimation, in which the decoded data symbols are not\nutilized to refine the initial channel estimates. The results imply that the\nuse of joint CE-MUDD significantly reduces rate loss due to transmission of\npilot signals, especially for multiple-antenna systems. As a result, joint\nCE-MUDD can provide significant performance gains, compared to the receivers\nbased on one-shot channel estimation."}, "authors": ["Keigo Takeuchi", "Mikko Vehkaperae", "Toshiyuki Tanaka", "Ralf R. Mueller"], "author_detail": {"name": "Ralf R. Mueller"}, "author": "Ralf R. Mueller", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1109/TIT.2011.2177757", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1002.4470v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1002.4470v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "The paper was resubmitted to IEEE Trans. Inf. Theory", "arxiv_primary_category": {"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1002.4470v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1002.4470v2", "journal_reference": null, "doi": "10.1109/TIT.2011.2177757", "fulltext": "IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n1\n\nLarge-System Analysis of Joint Channel and\nData Estimation for MIMO DS-CDMA\nSystems\narXiv:1002.4470v2 [cs.IT] 20 Apr 2011\n\nKeigo Takeuchi, Member, IEEE, Mikko Vehkaper\u00e4, Member, IEEE, Toshiyuki Tanaka, Member, IEEE,\nand Ralf R. M\u00fcller, Senior Member, IEEE\n\nAbstract\nThis paper presents a large-system analysis of the performance of joint channel estimation, multiuser detection, and\nper-user decoding (CE-MUDD) for randomly-spread multiple-input multiple-output (MIMO) direct-sequence codedivision multiple-access (DS-CDMA) systems. A suboptimal receiver based on successive decoding in conjunction\nwith linear minimum mean-squared error (LMMSE) channel estimation is investigated. The replica method, developed\nin statistical mechanics, is used to evaluate the performance in the large-system limit, where the number of users\nand the spreading factor tend to infinity while their ratio and the number of transmit and receive antennas are kept\nconstant. The performance of the joint CE-MUDD based on LMMSE channel estimation is compared to the spectral\nefficiencies of several receivers based on one-shot LMMSE channel estimation, in which the decoded data symbols\nare not utilized to refine the initial channel estimates. The results imply that the use of joint CE-MUDD significantly\nreduces rate loss due to transmission of pilot signals, especially for multiple-antenna systems. As a result, joint CEMUDD can provide significant performance gains, compared to the receivers based on one-shot channel estimation.\n\nManuscript received February 24, 2010; revised March , 2011. The work of K. Takeuchi was in part supported by the Grant-in-Aid for Young\nScientists (Start-up) (No. 21860035) from MEXT, Japan and by the Grant-in-Aid for Scientific Research on Priority Areas (No. 18079010) from\nMEXT, Japan. The work of M. Vehkaper\u00e4 was supported by the Norwegian Research Council under grant 171133/V30. The work of T. Tanaka\nwas in part supported by the Grant-in-Aid for Scientific Research on Priority Areas (No. 18079010) from MEXT, Japan. The material in this\npaper was presented in part at the 2008 IEEE International Symposium on Information Theory, Toronto, Canada, July 2008 and at the 2nd\nWorkshop on Physics-Inspired Paradigms in Wireless Communications and Networks, Seoul, Korea, June 2009.\nK. Takeuchi is with the Department of Communication Engineering and Informatics, the University of Electro-Communications, Tokyo\n182-8585, Japan (e-mail: takeuchi@ice.uec.ac.jp).\nM. Vehkaper\u00e4 was with the Department of Electronics and Telecommunications, the Norwegian University of Science and Technology (NTNU),\nNO\u20137491 Trondheim, Norway. He is currently with the School of Electrical Engineering, Royal Institute of Technology (KTH), SE\u2013100 44\nStockholm, Sweden (e-mail: mikkok@kth.se).\nT. Tanaka is with the Department of Systems Science, Graduate School of Informatics, Kyoto University, Kyoto, 606-8501, Japan (e-mail:\ntt@i.kyoto-u.ac.jp).\nR. R. M\u00fcller is with the Department of Electronics and Telecommunications, the Norwegian University of Science and Technology (NTNU),\nNO\u20137491 Trondheim, Norway (e-mail: ralf@iet.ntnu.no).\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n2\n\nIndex Terms\nMultiple-input multiple-output (MIMO) systems, direct-sequence code-division multiple-access (DS-CDMA) schemes,\nchannel estimation, multiuser detection (MUD), linear minimum mean-squared error (LMMSE) estimation, iterative\nreceivers, successive decoding, large-system analysis, replica method, statistical mechanics.\n\nI. I NTRODUCTION\nDirect-sequence code-division multiple-access (DS-CDMA) schemes are used in the air interface of third-generation\n(3G) mobile communication systems [1]\u2013[3]. In order to improve the spectral efficiency of DS-CDMA systems,\nthe extension to multiple-input multiple-output (MIMO) DS-CDMA systems has been actively considered [4]\u2013\n[13]. As a drawback of using multiple antennas at the transmitters, the receiver structure of MIMO DS-CDMA\nsystems becomes more complex than that of conventional DS-CDMA systems. Therefore, it is important in MIMO\nDS-CDMA systems to construct receivers achieving an acceptable tradeoff between performance and complexity.\nA goal in this research area is to construct receivers which achieve near-optimal performance by using acceptable\ncomputational costs, since optimal joint decoding is infeasible in terms of complexity. Separation of detection and\ndecoding significantly reduces the complexity of the receiver, although it is suboptimal in terms of performance. In\nmultiuser detection (MUD) [14], certain statistical properties of multiple-access interference (MAI) are used to detect\ndata symbols. Large-system analysis is a powerful approach for evaluating the performance of MUD followed by\nper-user decoding for randomly-spread DS-CDMA systems. In this analysis an asymptotic limit is assumed, referred\nto as the large-system limit, in which the number of users and the spreading factor tend to infinity while their ratio is\nkept constant. A series of large-system analyses [15]\u2013[20] have revealed that the linear minimum mean-squared error\n(LMMSE) detection followed by per-user decoding achieves near-optimal performance for lightly-loaded systems\nwith perfect channel state information (CSI) at the receiver. Furthermore, it has been shown numerically [21]\u2013[24]\nand analytically [25], [26] that iterative LMMSE-based multiuser detection and per-user decoding (MUDD) can\nachieve near-optimal performance even for highly-loaded systems with perfect CSI at the receiver. See [4], [12],\n[13] for the extension of these results to MIMO DS-CDMA systems with perfect CSI at the receiver. In the largesystem analysis for MIMO DS-CDMA systems the numbers of transmit and receive antennas are commonly fixed,\nwhile the number of users and the spreading factor tend to infinity with their ratio fixed. Note that a many-antenna\nlimit, in which the numbers of transmit and receive antennas tend to infinity, may be taken after this large-system\nlimit [27]. In this paper, the numbers of transmit and receive antennas are kept finite.\nIt is worth considering the no-CSI case since CSI is unknown in advance for practical MIMO DS-CDMA systems.\nIterative MUDD was extended to iterative channel estimation (CE) and MUDD (CE-MUDD) in [28]. In this scheme,\nthe channel estimator utilizes soft feedback from the per-user decoders for refining the initial channel estimates. In\nterms of complexity, iterative CE-MUDD requires updating the filter coefficients of the channel estimator and the\ndetector in every iteration. This implies that the computational complexity of iterative CE-MUDD is higher than\nthat for receivers based on one-shot channel estimation, in which data estimation is performed without refining the\ninitial channel estimates. In order to reduce the complexity of iterative CE-MUDD, linear channel estimators, such\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n3\n\nas the LMMSE channel estimator, have been commonly used. Linear channel estimators use known pilot symbols\nto obtain the initial channel estimates, while the optimal channel estimator can attain the initial channel estimates\nwith no pilot symbols. Numerical simulations [28]\u2013[30] demonstrated that iterative LMMSE-based CE-MUDD\ncan provide significant performance gains for highly-loaded systems, compared to receivers based on one-shot\nchannel estimation. However, these works did not discuss how to design the length of symbol periods assigned\nfor transmission of pilot symbols, called training phase. Increasing the length of the training phase improves the\naccuracy of channel estimation, while transmission of pilot symbols reduces the transmission rate. Thus, how to\ndesign the length of the training phase should provide a great impact on achievable spectral efficiency for the no-CSI\ncase. The goal of this paper is to optimize the length of the training phase on the basis of information-theoretical\ncapacities.\nSimple modulation schemes, such as quadrature phase shift keying (QPSK) or quadrature amplitude modulation\n(QAM), are commonly used for coherent receivers that estimate CSI explicitly. Thus, the channel capacity for a\nfixed modulation scheme, called constrained capacity, corresponds to a performance bound1 for iterative receivers,\nwhile the true capacity might be achieved by using complicated modulation [31]. It is a challenging issue to derive\nanalytical formulas for the constrained capacities of wireless communication systems with no CSI, since the optimal\nchannel estimator is nonlinear. Lower bounds for the constrained capacities have been derived instead [32], [33].\nThe basic idea in these works for obtaining lower bounds is to replace the noise due to channel estimation errors by\nadditive white Gaussian noise (AWGN). This replacement reduces optimal nonlinear channel estimation to LMMSE\nchannel estimation. In this paper, this type of a lower bound is referred to as a lower bound based on LMMSE\nchannel estimation.\nWe derive a lower bound for the constrained capacity of randomly-spread MIMO DS-CDMA systems with\nno CSI, on the basis of LMMSE channel estimation. The lower bound can be regarded as a performance index\nfor iterative CE-MUDD based on LMMSE channel estimation. In an information-theoretical point of view, both\nLMMSE channel estimates and covariances of the estimation errors should be used in MUD [34], while the use\nof the covariances is uncommon in practice. In this paper, we consider suboptimal LMMSE channel estimation in\nwhich only a part of the covariances for the LMMSE estimation errors are used, while all covariances are used\nin the true LMMSE channel estimation. The use of suboptimal LMMSE channel estimation allows us to evaluate\na lower bound for the constrained capacity. We refer to this lower bound as the performance of the joint CEMUDD based on suboptimal LMMSE channel estimation, or simply as the performance of the joint CE-MUDD. In\norder to investigate the benefits obtained by using iterative CE-MUDD, we also analyze the performance of three\nreceivers based on one-shot LMMSE channel estimation: one-shot CE-MUDD, an optimum separated receiver, and\nan LMMSE receiver. Table I lists the four receivers considered in this paper. The one-shot CE-MUDD performs\njoint MUDD based on one-shot LMMSE channel estimation. Intuitively, the performance of the one-shot CE1\n\nIntuitively, one may expect that the optimal CE-MUDD can be implemented with iterative CE-MUDD. However, it is unclear whether the\n\nsolution of the iterative CE-MUDD converges to the global optimal solution. Therefore, the constrained capacity might be a loose bound for\nthe performance of iterative CE-MUDD.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n4\n\nTABLE I\nF OUR RECEIVERS CONSIDERED IN THIS PAPER .\n\nfeedback\nchannel estimation(CE)\n\nMUD\n\nto CE\n\nto detector\n\navailable\n\navailable\n\njoint CE-MUDD\n\nsuboptimal LMMSE\n\noptimal\n\none-shot CE-MUDD\n\nsuboptimal LMMSE\n\noptimal\n\noptimum separated receiver\n\nsuboptimal LMMSE\n\noptimal\n\nLMMSE receiver\n\nsuboptimal LMMSE\n\nLMMSE\n\navailable\n\nMUDD corresponds to a performance bound for an iterative receiver obtained by eliminating the feedback from\nthe per-user decoders to the channel estimator in iterative CE-MUDD. The optimum separated receiver performs\nseparated optimal detection and decoding on the basis of one-shot LMMSE channel estimation. The performance\nof the optimum separated receiver corresponds to a performance bound for a non-iterative receiver obtained by\neliminating the feedback from the per-user decoders to the channel estimator and to the detector. The LMMSE\nreceiver is obtained by replacing the optimal detector in the optimum separated receiver by the LMMSE detector.\nTo the best of our knowledge, no analytical results for joint CE-MUDD are obtained, except for non-iterative linear\nreceivers [34] and iterative CE-MUDD based on hard decision feedback [35]. The methodology developed in this\npaper is applicable to the analysis of iterative LMMSE-based CE-MUDD. See [36] for details.\nOur large-system analysis is based on the replica method [37]\u2013[39], which is a powerful method for analyzing\nrandomly-spread DS-CDMA systems [11], [18]\u2013[20], [40] and MIMO systems [41]\u2013[44]. The replica method is\nbased on several non-rigorous procedures at present time. In this paper, we assume that results obtained by using\nthese procedures are correct since their proof is beyond the scope of this paper. See [45]\u2013[47] for recent progress\nwith respect to the assumptions of the replica method.\nThis paper is organized as follows: After summarizing the notation used in this paper, in Section II we introduce\na discrete-time model of MIMO DS-CDMA systems. In Section III, the joint CE-MUDD based on suboptimal\nLMMSE channel estimation is defined. In Section IV, we define the three receivers based on one-shot LMMSE\nchannel estimation. Section V presents the main results of this paper. In Section VI, we compare the performance\nof the joint CE-MUDD with that of the three receivers based on one-shot LMMSE channel estimation. Numerical\nsimulations for finite-sized systems are also performed to demonstrate the usefulness of our large-system analysis.\nIn Section VII, we conclude this paper. The derivations of the main results are summarized in the appendices.\nA. Notation\nFor a complex number z \u2208 C and a real number x \u2208 R, Re(z), Im(z), i, z \u2217 , log x, and ln x denote the real\npart, imaginary part, imaginary unit, complex conjugate, log2 x, and loge x, respectively. |A| stands for the number\n\nof elements of a set A. For a matrix A, AT , AH , Tr(A), and det(A) denote the transpose, conjugate transpose,\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n5\n\ntrace, and the determinant, respectively. I N stands for the N \u00d7 N identity matrix. 1N denotes the N -dimensional\n(n)\n\nvector whose elements are all one. eN represents the N -dimensional vector in which the nth element is one and\nthe other elements are all zero. M+\nn denotes the set of all positive definite n \u00d7 n Hermitian matrices. \u2297 denotes the\nKronecker product operator between two matrices. \u03b4(*) represents the Dirac delta function, while \u03b4i,j denotes the\nKronecker delta. p(x) and p(y|x) stand for the probability density function (pdf) of a continuous random variable x\nand the conditional pdf of a continuous random variable y given x, respectively. We use the same symbol p(x) for\nthe probability mass function (pmf) of a discrete random variable x. a \u223c P (a) indicates that the distribution of a\nrandom variable a equals a distribution P (a). If the pdf p(a) of a exists, we use the notation a \u223c p(a) to represent\nthat a follows the distribution whose pdf is given by p(a). CN (m, \u03a3) denotes a proper n-dimensional complex\n\nGaussian distribution with mean m \u2208 CN and a covariance matrix \u03a3 \u2208 M+\nn [48]. The pdf of the n-dimensional\ncomplex Gaussian random vector x \u223c CN (m, \u03a3) is defined as p(x) = gn (x \u2212 m; \u03a3), given by\ngn (y; \u03a3) =\n\nH \u22121\n1\ne\u2212y \u03a3 y .\n\u03c0 n det \u03a3\n\n(1)\n\nD(AkB) stands for the Kullback-Leibler divergence with the logarithm to base 2 between CN (0, A) and CN (0, B).\nI(x; y|z) denotes the conditional mutual information with the logarithm to base 2 between a random variable x\nand a random variable y conditioned on a random variable z.\nThe indices of chips, symbol periods, users, transmit antennas, and replicas are denoted by l, t, k, m, and a,\nrespectively. In this paper, indices themselves have meanings, like the argument of distributions. Symbols with\nseveral superscripts or subscripts are used in this paper. We write sets of the symbols as follows: For a symbol aki,j\nand a subset J of indices {j}, the set Aki,J denotes a subset {aki,j : for j \u2208 J } for fixed i and k. When J equals\n\nthe set of all indices {j}, Aki,J is also written as Aki . The sets Ai , A, and so on are defined in the same manner. The\ntwo sets Aki and Akj should not be confused with each other. The set J \\{j} = {j \u2032 \u2208 J : j \u2032 6= j} denotes the set\n\nobtained by eliminating the element j from J . When J equals the set of all indices {j}, J \\{j} is simply written\nas \\{j}. As notational convenience for subsets of the natural numbers N, we use [a, b) = {i \u2208 N : a \u2264 i < b}\nfor integers a and b(> a), which is always used as subscripts or superscripts for discrete sets. The other sets\n[a, b], (a, b), and so on are defined in the same manner. As exceptions, the two sets {t\u2032 \u2208 N : 1 \u2264 t\u2032 \u2264 t} and\n{t\u2032 \u2208 N : t \u2264 t\u2032 \u2264 Tc } for coherence time Tc are denoted by Tt and Ct , respectively, instead of [1, t] and [t, Tc ].\n\nWe use symbols with tildes and hats to represent random variables for postulated channels and estimates of\nrandom variables, respectively. Underlined symbols are used to represent random variables for decoupled single-user\nchannels. Note that there are several exceptions in the replica analyses presented in Appendix C and Appendix D.\nII. MIMO DS-CDMA C HANNEL\nWe consider the uplink of a synchronous K-user frequency-flat fading MIMO DS-CDMA system with spreading\nfactor L, in which each user and the receiver have M transmit antennas and N receive antennas, respectively. A perantenna spreading scheme is investigated in this paper: Different spreading sequences are used for different transmit\nantennas of each user. See [49] for a generalization of spreading schemes. We assume block-fading channels with\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n6\n\ncoherence time Tc , i.e., fading coefficients do not change during Tc symbol periods, and they are independently\nsampled from a distribution at the beginning of the next coherent interval.\nThe input symbol ut,k,m \u2208 C for the mth transmit antenna of user k in symbol period t is spread with a\n\nspreading sequence {sl,t,k,m : l = 1, . . . , L}. The chip-sampled received vectors {y l,t \u2208 CN : l = 1, . . . , L} in\nsymbol periods t = 1, . . . , Tc are given by\nK M\n1 XX\ny l,t = \u221a\nhk,m sl,t,k,m ut,k,m + nl,t .\nL k=1 m=1\n\n(2)\n\nIn (2), nl,t \u223c CN (0, N0 I N ) represents the AWGN vector with variance N0 . Furthermore, hk,m \u2208 CN denotes the\nchannel vector between transmit antenna m of the kth user and the receiver. Note that the channel vectors are fixed\nduring Tc symbol periods.\nThe assumption of frequency-flat fading channels might be an unrealistic assumption since practical MIMO DSCDMA systems commonly operate over frequency-selective fading channels. For the sake of simplicity, however,\nwe consider frequency-flat fading channels. An extension to frequency-selective fading channels is possible by\nconsidering the assumption of independent spreading sequences across different resolvable paths [4], [34]. For\ndetails, see [50].\nThe receiver does not have CSI in advance, which is information about all realizations of the channel vectors\n{hk,m : for all k, m}, while it knows all spreading sequences, the variance N0 of the AWGN, and the statistical\nproperties of all channel vectors and input symbols. In order for the receiver to estimate the channel vectors, consider\nthat the first \u03c4 symbol periods T\u03c4 = {1, . . . , \u03c4 } in each coherent interval are assigned to a training phase, and that\n\nthe remaining \u03c4 \u2032 = Tc \u2212 \u03c4 symbol periods C\u03c4 +1 = {\u03c4 + 1, . . . , Tc } are assigned to a communication phase. The\nlength of the training phase \u03c4 is a design parameter, which will be optimized on the basis of large-system results.\n\nUser k transmits pilot symbols {xt,k,m \u2208 C} known to the receiver from the mth transmit antenna in the training\nphase t \u2208 T\u03c4 , and subsequently sends data symbols {bt,k,m \u2208 C} in the communication phase t \u2208 C\u03c4 +1 . Therefore,\nthe input symbol ut,k,m is given by\nut,k,m\n\n\uf8f1\n\uf8f2 x\nt,k,m\n=\n\uf8f3 b\nt,k,m\n\nfor t \u2208 T\u03c4 ,\n\n(3)\n\nfor t \u2208 C\u03c4 +1 .\n\nThroughout this paper, we assume that the input symbols {ut,k,m } are mutually independent for all t, k, m,\n\nand that each ut,k,m is a zero-mean random variable satisfying |ut,k,m |2 = P/M . In numerical results, unbiased\nQPSK input symbols with |ut,k,m |2 = P/M are used. Furthermore, it is straightforward to extend the results to\n\nthe unequal power case. Next, we assume that the channel vectors {hk,m } are mutually independent for all k,\nm, and that each hk,m has independent and identically distributed (i.i.d.) circularly symmetric complex Gaussian\n(CSCG) elements with unit variance. Finally, we assume that the spreading sequences {sl,t,k,m : for all l, t, k, m}\nare i.i.d. for all l, t, k, m, and that each sl,t,k,m is a CSCG random variable with unit variance. We have made the\nCSCG assumption of each chip for the sake of simplicity in analysis. We believe that the main results presented in\nthis paper hold for a general distribution of sl,t,k,m with zero mean and finite moments, as shown numerically in\nSection VI.\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n7\n\nWe shall present several sets used in this paper: The set Yt = {yl,t \u2208 CN : l = 1, . . . , L} denotes the received\nvectors in symbol period t. The set St = {sl,t,k,m : for all l, k, m} represents the spreading sequences in symbol\nperiod t. The sets Bt,k = {bt,k,m : for all m} and Xt,k = {xt,k,m : for all m} represent the data and pilot\nsymbols for user k in symbol period t, respectively. All data and pilot symbols in symbol period t are denoted\nby Bt = {Bt,k : for all k} and Xt = {Xt,k : for all k}. The set Ut = {ut,k,m : for all k, m} represents the\ninput symbols in symbol period t. The channel vectors for user k are denoted by Hk = {hk,m : for all m}. The\nset It = {Yt , St , Ut } denotes the information about the received vectors Yt , the spreading sequences St , and\nthe input symbols Ut in symbol period t. The set I t = {Yt , St } is obtained by eliminating the input symbols\nUt from It . The training phase in stage t of successive decoding, introduced in the next section, is denoted by\nTt\u22121 = {1, . . . , t \u2212 1}, while the following stages are denoted by Ct+1 = {t + 1, . . . , Tc }. The set C\u03c4 +1 is also used\nto represent the communication phase. Note that the same index t as for symbol periods is used for the indices of\nstages in successive decoding. A list for several sets used in this paper is summarized in Appendix G.\nIII. J OINT CE-MUDD\nA. Joint CE-MUDD Based on LMMSE Channel Estimation\nIn order to define joint CE-MUDD based on LMMSE channel estimation, we shall derive a lower bound of the\nconstrained capacity based on LMMSE channel estimation. The definition of joint CE-MUDD considered in this\npaper will be presented in the next subsection.\nWe start by the constrained capacity of the MIMO DS-CDMA channel (2) with no CSI. Let YT\u03c4 = {Yt : t \u2208 T\u03c4 }\nand YC\u03c4 +1 = {Yt : t \u2208 C\u03c4 +1 } denote the received vectors in the training and communication phases, respectively.\nFurthermore, we write all data symbols B and all pilot symbols X as B = {Bt : for all t \u2208 C\u03c4 +1 } and X = {Xt :\nfor all t \u2208 T\u03c4 }. The constrained capacity for the no-CSI case is given by the mutual information per chip between\nall data symbols B and {YC\u03c4 +1 , YT\u03c4 , S, X } known to the receiver [51], with S = {St : for all t} denoting all\nspreading sequences,\nCopt =\n\n1\nI(B; YC\u03c4 +1 , YT\u03c4 , S, X ).\nLTc\n\n(4)\n\nUsing the chain rule for mutual information, we obtain\n1\n1\nI(B; YC\u03c4 +1 |YT\u03c4 , S, X ) +\nI(B; YT\u03c4 , S, X )\nLTc\nLTc\n1\n=\nI(B; YC\u03c4 +1 |YT\u03c4 , S, X ),\nLTc\n\nCopt =\n\n(5)\n\nwhere the last equality holds since the data symbols B are independent of {YT\u03c4 , S, X }. For notational convenience,\nwe hereafter omit conditioning with respect to YT\u03c4 , S, and X .\nIt is well known that the constrained capacity can be achieved by successive decoding. In order to obtain a\nlower bound for the constrained capacity, a successive decoding strategy has been considered in [52], [53]. In\nthis strategy, channel estimation and MUD in successive decoding are replaced by suboptimal ones that allow\nus to evaluate the performance analytically. We present joint CE-MUDD based on LMMSE channel estimation,\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n8\n\nfollowing the successive decoding strategy. In successive decoding with \u03c4 \u2032 = Tc \u2212 \u03c4 stages, the data symbols {Bt }\nare decoded in the order t = \u03c4 + 1, . . . , Tc . Stage t \u2208 C\u03c4 +1 consists of K substages, in which the data symbols\n{Bt,k } in symbol period t are decoded in the order k = 1, . . . , K. We focus on substage k within stage t. Let\n\nB(\u03c4,t) = {Bt\u2032 : t\u2032 = \u03c4 + 1, . . . , t \u2212 1} and YC\u03c4 +1 \\{t} = {Yt\u2032 : t\u2032 \u2208 C\u03c4 +1 , t\u2032 6= t} denote the data symbols decoded\nsuccessfully in the preceding stages and the received vectors in the communication phase except for Yt , respectively.\nThe independency of {Bt } for all t implies that Bt is independent of the received vectors {Yt\u2032 } in different symbol\nperiods t\u2032 6= t. By using the chain rule for mutual information repeatedly, (5) yields\nI(B; YC\u03c4 +1 ) =\n\nTc\nX\n\nt=\u03c4 +1\n\n=\n\nI(Bt ; YC\u03c4 +1 |B(\u03c4,t) )\n\nTc\nX\n\u0002\n\u0003\nI(Bt ; YC\u03c4 +1 \\{t} |B(\u03c4,t) ) + I(Bt ; Yt |B(\u03c4,t) , YC\u03c4 +1 \\{t} )\n\nt=\u03c4 +1\n\n=\n\nTc\nX\n\nt=\u03c4 +1\n\nI(Bt ; Yt |B(\u03c4,t) , YC\u03c4 +1 \\{t} ),\n\n(6)\n\nwhere the last equality holds since Bt is independent of YC\u03c4 +1 \\{t} . If there were dependencies between the data\nsymbols in different symbol periods, the equality would not hold. Applying the chain rule for mutual information\nto (6) gives\nCopt =\n\nTc X\nK\n1 X\nopt\nCt,k\n,\nLTc t=\u03c4 +1\n\n(7)\n\nk=1\n\nwith\n\nopt\nCt,k\n= I(Bt,k ; Yt |Bt,[1,k) , B(\u03c4,t) , YC\u03c4 +1 \\{t} ),\n\n(8)\n\nwhere Bt,[1,k) = {Bt,k\u2032 : k \u2032 = 1, . . . , k \u2212 1} denotes the data symbols decoded in the preceding substages.\nWe focus on each mutual information (8). In estimating Bt,k , the data symbols B(\u03c4,t) decoded in the preceding\nstages are available for channel estimation, while the data symbols Bt,[1,k) decoded in the preceding substages are\nused in MUD. The optimal receiver achieving the mutual information (8) consists of the optimal channel estimator,\nthe optimal detector, and per-user decoders. The optimal channel estimator uses the information ITt\u22121 = {It\u2032 : t\u2032 \u2208\n\nTt\u22121 } in the preceding stages and the information I Ct+1 = {I t\u2032 : t\u2032 \u2208 Ct+1 } in the following stages to construct the\n\nposterior pdf p(H|ITt\u22121 , I Ct+1 ) of all channel vectors H = {Hk : for all k}, which is sent to the optimal detector.\nNote that p(H|ITt\u22121 , I Ct+1 ) is non-Gaussian, since I Ct+1 = {Yt\u2032 , St\u2032 : t\u2032 \u2208 Ct+1 } is an incomplete data set, i.e, it\n\ndoes not contain the data symbols {Bt\u2032 }. Consequently, the optimal channel estimator is nonlinear. In the optimal\ndetector, the posterior pdf p(Bt,k |Yt , St , Bt,[1,k) , ITt\u22121 , I Ct+1 ) is constructed and fed to the corresponding decoder,\nby utilizing the information about the received vector Yt , the spreading sequences St , the data symbols Bt,[1,k) in\nthe preceding substages, and the posterior pdf p(H|ITt\u22121 , I Ct+1 ) provided by the channel estimator.\nIt is difficult to obtain an analytical expression for the constrained capacity (7), since the optimal channel estimator\nis nonlinear. In order to obtain a lower bound based on LMMSE channel estimation, we consider a lower bound\nfor (8),\nopt\nCt,k\n\u2265 I(Bt,k ; Yt |Bt,[1,k) , B(\u03c4,t) , Y(\u03c4,t) ),\nOctober 26, 2018\n\n(9)\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n9\n\nwith Y(\u03c4,t) = {Yt\u2032 : t\u2032 = \u03c4 + 1, . . . , t \u2212 1} denoting the received vectors in the preceding stages. In the derivation\nof (9), we have used the assumption of independent data symbols and the fact that conditioning does not increase\n(differential) entropy. Recall that conditioning with respect to YT\u03c4 , S, and X in the mutual information is omitted.\nSubstituting (9) to (7) yields the lower bound Copt > C, with\nC=\n\nTc X\nK\n1 X\nI(Bt,k ; Yt |Bt,[1,k) , ITt\u22121 , St ),\nLTc t=\u03c4 +1\n\n(10)\n\nk=1\n\nwhere we have re-written the conditioning random variables as {Bt,[1,k) , ITt\u22121 , St }, using the fact that the lower\n\nbound (9) is independent of the spreading sequences SCt+1 = {St\u2032 : t\u2032 \u2208 Ct+1 } in the following stages anymore.\n\nThe receiver achieving the lower bound (10) is obtained by replacing the optimal channel estimator by a channel\nestimator that sends the posterior pdf p(H|ITt\u22121 ), instead of p(H|ITt\u22121 , I Ct+1 ). It is straightforward to find that this\nchannel estimator is equivalent to the LMMSE channel estimator, as shown in the following remark. Thus, we refer\nto the lower bound (10) as the spectral efficiency of the joint CE-MUDD based on LMMSE channel estimation.\nRemark 1. We shall show that the channel estimator corresponding to the lower bound (9) is the LMMSE channel\nestimator. We first confirm that the channel estimator is linear. The information ITt\u22121 in the training phase is a\ncomplete data set for estimating the channel vectors H, i.e., ITt\u22121 contains the received vectors, the spreading\nsequences, and the input symbols in each symbol period. The Gaussian assumption of the channel vectors hk \u223c\nCN (0, I N ) implies that the posterior pdf p(H|ITt\u22121 ) is a proper complex Gaussian pdf whose mean is given by\na linear transform of the received vectors. Thus, the channel estimator based on the posterior mean estimator is\nlinear.\nWe next show that the channel estimator is equal to the LMMSE channel estimator. See Appendix A for derivations\nof the LMMSE estimator. Following [32], [33], we replace the term hk,m sl,t\u2032 ,k,m bt\u2032 ,k,m in (2) for the following\nstages t\u2032 = t + 1, . . . , Tc by a proper complex Gaussian random vector whose mean and covariance are given\nby hk,m sl,t\u2032 ,k,m E[bt\u2032 ,k,m ] and |sl,t\u2032 ,k,m |2 E[hk,m bt\u2032 ,k,m (hk,m bt\u2032 ,k,m )H ], respectively. However, the mean is equal\nto zero, because of E[bt\u2032 ,k,m ] = 0. As a result, the received vectors in the following stages is independent of\nthe channel vectors anymore. In other words, the LMMSE channel estimator does not utilize the information\nYCt+1 = {Yt\u2032 : t\u2032 \u2208 Ct+1 } in the following stages, since the LMMSE channel estimator postulates that the received\n\nvector y l,t\u2032 in (2) is independent of the channel vectors for t\u2032 \u2208 Ct+1 . Therefore, the lower bound (9) corresponds\nto the spectral efficiency of the receiver based on the LMMSE channel estimation.\nB. Joint CE-MUDD Based on Suboptimal LMMSE Channel Estimation\nIt is still hard to evaluate the spectral efficiency (10) of the joint CE-MUDD based on LMMSE channel estimation,\nsince the posterior pdf p(H|ITt\u22121 ) sent by the LMMSE channel estimator is not factorized into the product of\nQK\nthe marginal posterior pdfs k=1 p(Hk |ITt\u22121 ). Instead, we consider a suboptimal receiver in which the LMMSE\nQK\nchannel estimator is replaced by a suboptimal LMMSE channel estimator that sends the product k=1 p(Hk |ITt\u22121 ).\n\nThe spectral efficiency for the suboptimal receiver provides a lower bound for the spectral efficiency (10) based\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n10\n\nreceived vectors in the training phase\nand in the preceding stages\nsuboptimal LMMSE\nchannel estimator\n\ninformation about Bt, 1\n\ndecoder 1\n\noptimal detector\ninformation about Bt, K\n\ndecoder K\n\nreceived vectors\nin symbol period t\n\nFig. 1.\n\nJoint CE-MUDD based on suboptimal LMMSE channel estimation.\n\non LMMSE channel estimation. Since the LMMSE detector uses no covariances of the channel estimation errors\nbetween different users [34], as noted in Section IV-D, no performance loss due to this replacement occurs for\nthe LMMSE receiver. On the other hand, the optimal detector utilizes all information about the channel vectors,\ni.e., the joint posterior pdf p(H|ITt\u22121 ). It is unclear whether the performance loss caused by using the suboptimal\nLMMSE channel estimator is negligible in the large-system limit for the optimal detector.\nLet us focus on substage k within stage t. The suboptimal receiver consists of a suboptimal LMMSE channel\nestimator, the optimal detector, and the per-user decoders (See Fig. 1). The channel estimator uses the pilot symbols\nand the data symbols decoded in the preceding stages to estimate the channel vectors. More precisely, the channel\nestimator constructs the posterior pdf p(Hk |ITt\u22121 ) of the channel vectors Hk for each user by utilizing the known\n\ninformation ITt\u22121 = {Yt\u2032 , St\u2032 , Ut\u2032 : t\u2032 \u2208 Tt\u22121 },\nR Qt\u22121\np(Hk |ITt\u22121 ) =\n\n\u2032\n\u2032\n\u2032\nt\u2032 =1 p(Yt |H, St , Ut )p(H)dH\\{k}\n,\nRQ\nt\u22121\nt\u2032 =1 p(Yt\u2032 |H, St\u2032 , Ut\u2032 )p(H)dH\n\n(11)\n\nwith H\\{k} = {Hk\u2032 : for all k \u2032 6= k} denoting the channel vectors except for Hk . In (11), the pdf p(Yt\u2032 |H, St\u2032 , Ut\u2032 )\nrepresents the MIMO DS-CDMA channel (2) in symbol period t\u2032 . Then, the marginal posterior pdfs {p(Hk |ITt\u22121 ) :\n\nfor all k} are sent towards the optimal detector. Sending p(Hk |ITt\u22121 ) is equivalent to feeding the LMMSE estimates\nR\nTt\u22121\nTt\u22121\nTt\u22121\n= hk,m \u2212 \u0125k,m for all m,\n\u0125k,m = hk,m p(Hk |ITt\u22121 )dHk and the covariances of the estimation errors \u2206hk,m\nsince the posterior pdf p(Hk |ITt\u22121 ) is CSCG.\n\nThe optimal detector uses the information about the received vectors Yt , the data symbols Bt,[1,k) decoded in the\npreceding substages, the spreading sequences St , and the posterior pdfs {p(Hk |ITt\u22121 )} provided by the channel\nestimator to detect the data symbols Bt,k . The term \"optimal detector\" indicates that the detector is optimal among\nQK\nall detectors that regard the product k=1 p(Hk |ITt\u22121 ) of the marginal posterior pdfs as the true joint posterior\npdf. The optimal detector constructs a posterior pdf p(B\u0303t,k |Yt , Bt,[1,k) , St , ITt\u22121 ) and subsequently forwards it to\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n11\n\nthe corresponding per-user decoder. In the posterior pdf, the data symbols B\u0303t,k = {b\u0303t,k,m \u2208 C : for all m} \u223c\nQM\nm=1 p(bt,k,m ) denotes the data symbols in the MIMO DS-CDMA channel postulated by the optimal detector\nK M\n1 XX\n\u1ef9 l,t = \u221a\nh\u0303k,m sl,t,k,m b\u0303t,k,m + \u00f1l,t ,\nL k=1 m=1\n\n(12)\n\nwith \u00f1l,t \u223c CN (0, N0 I N ). In (12), H\u0303k = {h\u0303k,m \u2208 CN : for all m} denotes random vectors representing the\ninformation about Hk provided by the channel estimator. The joint posterior pdf of H\u0303 = {H\u0303k : for all k} satisfies\np(H\u0303|ITt\u22121 ) =\n\nK\nY\n\nk=1\n\np(Hk = H\u0303k |ITt\u22121 ).\n\n(13)\n\nNote that p(H\u0303|ITt\u22121 ) 6= p(H|ITt\u22121 ) since p(H|ITt\u22121 ) is not decomposed into the product of the marginal pdfs.\nThe posterior pdf p(B\u0303t,k |Yt , Bt,[1,k) , St , ITt\u22121 ) is an abbreviation of p(B\u0303t,k |\u1ef8t = Yt , B\u0303t,[1,k) = Bt,[1,k) , St , ITt\u22121 ),\n\nwith \u1ef8t = {\u1ef9 l,t \u2208 CN : for all l} and B\u0303t,[1,k) = {B\u0303t,k\u2032 : k \u2032 = 1, . . . , k \u2212 1} denoting the received vectors in (12)\nand the postulated data symbols in the preceding substages, respectively, given by\nR\np(\u1ef8t |B\u0303t , St , ITt\u22121 )p(B\u0303t )dB\u0303t,(k,K]\np(B\u0303t,k |\u1ef8t , B\u0303t,[1,k) , St , ITt\u22121 ) = R\n,\np(\u1ef8t |B\u0303t , St , ITt\u22121 )p(B\u0303t )dB\u0303t,[k,K]\n\n(14)\n\nwith B\u0303t,(k,K] = {B\u0303t,k\u2032 : k \u2032 = k + 1, . . . , K} and B\u0303t,[k,K] = {B\u0303t,k\u2032 : k \u2032 = k, . . . , K}. In (14), p(\u1ef8t |B\u0303t , St , ITt\u22121 ) is\n\ngiven by\np(\u1ef8t |B\u0303t , St , ITt\u22121 ) =\n\nZ\n\np(\u1ef8t |H\u0303, St , B\u0303t )p(H\u0303|ITt\u22121 )dH\u0303,\n\n(15)\n\nwhere p(\u1ef8t |H\u0303, St , B\u0303t ) represents the MIMO DS-CDMA channel (12) postulated by the optimal detector in symbol\nperiod t. The marginal posterior pdf (14) would reduce to the true one p(Bt,k |Yt , Bt,[1,k) , St , ITt\u22121 ) if the channel\nestimator sent the joint posterior pdf p(H|ITt\u22121 ).\nThe spectral efficiency Cjoint of the joint CE-MUDD based on the suboptimal LMMSE channel estimation is\ngiven by,\nCjoint =\n\nTc X\nK\n1 X\nCt,k ,\nLTc t=\u03c4 +1\n\n(16)\n\nk=1\n\nwith\nCt,k = I(Bt,k ; B\u0303t,k |Bt,[1,k) , ITt\u22121 , St ).\n\n(17)\n\nThe conditional mutual information (17) is characterized by the equivalent channel between user k and the corresponding decoder, given by\np(B\u0303t,k |Bt,k , Bt,[1,k) , ITt\u22121 , St ) =\n\nZ\n\np(B\u0303t,k |Yt , Bt,[1,k) , St , ITt\u22121 )p(Yt |Bt,[1,k] , St , ITt\u22121 )dYt ,\n\n(18)\n\nwhere\np(Yt |Bt,[1,k] , St , ITt\u22121 ) =\n\nZ\n\np(Yt |H, St , Bt )p(Bt,(k,K] )p(H|ITt\u22121 )dHdBt,(k,K] ,\n\n(19)\n\nwith Bt,[1,k] = {Bt,k\u2032 : k \u2032 = 1, . . . , k} and Bt,(k,K] = {Bt,k\u2032 : k \u2032 = k + 1, . . . , K}. In (19), p(Yt |H, St , Bt )\nrepresents the MIMO DS-CDMA channel (2) in symbol period t. Note that B\u0303t,k in (17) plays the role of random\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\nsuboptimal LMMSE\nchannel estimator\n\n12\n\nreceived vectors\nin the training phase\n\ninformation about Bt, 1\n\ndecoder 1\n\noptimal detector\ninformation about Bt, K\n\ndecoder K\n\nreceived vectors\nin symbol period t\n\nFig. 2.\n\nOne-shot CE-MUDD based on suboptimal LMMSE channel estimation.\n\nvariables representing the information about Bt,k provided to the per-user decoder, although we have introduced\nB\u0303t,k as random variables representing the data symbols postulated by the optimal detector in (12).\nThe spectral efficiency (16) of the joint CE-MUDD based on the suboptimal LMMSE channel estimation is\na lower bound for the spectral efficiency (10) based on the LMMSE channel estimation. We hereafter focus on\nthe lower bound (16). Thus, the joint CE-MUDD based on the suboptimal LMMSE channel estimation is simply\nreferred to as the joint CE-MUDD. The spectral efficiency (16) of the joint CE-MUDD should not be confused\nwith the spectral efficiency (10) based on the LMMSE channel estimation or with the constraint capacity (6).\nIV. R ECEIVERS BASED\n\nON\n\nO NE -S HOT C HANNEL E STIMATION\n\nA. One-Shot Channel Estimation\nFor comparison with the joint CE-MUDD, we consider three receivers based on one-shot channel estimation,\nin which the decoded data symbols are not used to refine the channel estimates. A first receiver performs joint\nMUDD based on one-shot LMMSE channel estimation, called one-shot CE-MUDD. This receiver is obtained by\neliminating the feedback from the per-user decoders to the suboptimal LMMSE channel estimator in Fig. 1. A\nsecond receiver performs separated decoding based on one-shot LMMSE channel estimation, called the optimum\nseparated receiver. The receiver is obtained by eliminating the feedback from the per-user decoders to the channel\nestimator and to the optimal detector. The last receiver is an LMMSE receiver in which the detector in the optimum\nseparated receiver is replaced by an LMMSE detector. The four receivers considered in this paper are listed in\nTable I.\nB. One-Shot CE-MUDD\nWe define the one-shot CE-MUDD based on the suboptimal LMMSE channel estimation (See Fig. 2). In stage t\nof the joint CE-MUDD, the channel estimator has used the information ITt\u22121 = {Yt\u2032 , St\u2032 , Ut\u2032 : t\u2032 \u2208 Tt\u22121 }\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\nsuboptimal LMMSE\nchannel estimator\n\n13\n\nreceived vectors\nin the training phase\n\ninformation about channel vectors\ninformation about Bt, 1\n\ndecoder 1\n\noptimal detector\ninformation about Bt, K\n\ndecoder K\n\nreceived vectors\nin symbol period t\n\nFig. 3.\n\nOptimum separated receiver based on suboptimal LMMSE channel estimation.\n\nabout the received vectors {Yt\u2032 }, the spreading sequences {St\u2032 }, and the transmitted symbols Ut\u2032 in symbol periods\nt\u2032 \u2208 Tt\u22121 . On the other hand, the LMMSE channel estimation in the one-shot CE-MUDD cannot utilize the data\n\nsymbols {Bt\u2032 : t\u2032 = \u03c4 + 1, . . . , t \u2212 1} decoded in the preceding stages. This restriction is equivalent to assuming\n\nthat the information I(\u03c4,t) = {Yt\u2032 , St\u2032 , Ut\u2032 : t\u2032 = \u03c4 + 1, . . . , t \u2212 1} in the preceding stages is not used for channel\n\nestimation, as discussed in Remark 1. In other words, the information IT\u03c4 = {Yt\u2032 , St\u2032 , Xt\u2032 : for all t\u2032 \u2208 T\u03c4 } in the\n\ntraining phase is utilized for channel estimation. Thus, the suboptimal LMMSE channel estimator in the one-shot\nCE-MUDD provides the marginal posterior pdfs {p(Hk |IT\u03c4 )} to the optimal detector. Note that sending the joint\nposterior pdf p(H|IT\u03c4 ) is of course optimal. Strictly speaking, the one-shot CE-MUDD should be referred to as the\none-shot CE-MUDD based on the suboptimal LMMSE channel estimation. However, we simply call it the one-shot\nCE-MUDD, since the true LMMSE channel estimator is not analyzed in this paper.\nThe marginal posterior pdf p(Hk |IT\u03c4 ) is equal to the one constructed in the first stage of the joint CE-MUDD.\nThus, the spectral efficiency of the one-shot CE-MUDD is given by\n\u0013\n\u0012\nK\nX\n\u03c4\nL\u22121\nC\u03c4 +1,k ,\nCone = 1 \u2212\nTc\n\n(20)\n\nk=1\n\nwhere the mutual information C\u03c4 +1,k is defined as (17).\nC. Optimum Separated Receiver\n\nWe define the optimum separate receiver based on the suboptimal LMMSE channel estimation (See Fig. 3).\nIn substage k of the joint CE-MUDD, the optimal detector has used the data symbols Bt,[1,k) in the preceding\nsubstages to mitigate MAI. In the optimum separated receiver, on the other hand, the information Bt,[1,k) is not\nutilized for MUD. The posterior pdf p(B\u0303t,k |Yt , St , IT\u03c4 ) is constructed and sent to the corresponding per-user\ndecoder. The posterior pdf is equal to the one constructed in the first substage of the joint CE-MUDD. Thus, the\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n14\n\nspectral efficiency of the optimum separated receiver is given by\n\u0012\n\u0013\nK\n\u03c4\nCsep =\n1\u2212\nC\u03c4 +1,1 ,\nL\nTc\n\n(21)\n\nwhere the mutual information C\u03c4 +1,1 is defined as (17).\nD. LMMSE Receiver\nThe LMMSE receiver is obtained by replacing the optimal detector in the optimum separated receiver by the\nLMMSE detector. We first derive the LMMSE estimator of the data symbols Bt,k , after which we define the\ninformation about Bt,k provided from the LMMSE detector to the corresponding decoder. The LMMSE estimator\n(L)\n\n(L)\n\nof Bt,k would be obtained by regarding Bt,k as CSCG random variables B\u0303t,k = {b\u0303t,k,m \u2208 C : for all m} with\n(L)\n\n(L)\n\n(L)\n\nE[b\u0303t,k,m (b\u0303t,k,m\u2032 )\u2217 ] = (P/M )\u03b4m,m\u2032 if the receiver had perfect CSI [20]. However, the posterior mean of B\u0303t,k is\nnonlinear in the received vectors Yt since the channel model (12) includes multiplicative noise due to the influence\nof channel estimation errors. We approximate the channel model (12) by a channel model without multiplicative\nnoise. We extract the term including channel estimation errors from the first term on the right-hand side of (12), and\nsubsequently approximate the extracted one by an AWGN term with the same covariance. Therefore, the MIMO\nDS-CDMA channel in symbol period t postulated by the LMMSE detector is given as\n(L)\n\u1ef9 l,t\n\nK M\n\u0010 I\u03c4\n\u0011\n1 XX\n(L)\n(L)\n(L)\nsl,t,k,m \u0125k,m b\u0303t,k,m + w\u0303 t,k,m + \u00f1l,t ,\n=\u221a\nL k=1 m=1\n\nI\u03c4\n\nI\u03c4\n\n(L)\n\nwith \u00f1l,t \u223c CN (0, N0 I N ). In (22), \u0125k,m denotes the LMMSE channel estimates \u0125k,m =\n(L)\n\n(22)\nR\n\nhk,m p(Hk |I\u03c4 )dHk .\n\nThe vectors {w\u0303t,k,m \u2208 CN } are independent CSCG random vectors with the covariance matrix (P/M )\u03a3k,m for all\nI\u03c4\n\n\u03c4\nt, k, and m, in which \u03a3k,m denotes the covariance matrix of the channel estimation errors \u2206hIk,m\n= hk,m \u2212 \u0125k,m ,\n\n\u03c4\n\u03c4\n\u03c4\ni.e., \u03a3k,m = E[\u2206hIk,m\n(\u2206hIk,m\n)H |IT\u03c4 ]. Note that E[\u2206hIk,m\nbt,k,m (\u2206hIk\u2032\u03c4,m bt,k\u2032 ,m )H |I\u03c4 ] = O for k 6= k \u2032 , since the\n\ndata symbols {bt,k,m } are independent unbiased random variables. Thus, the same detector would be obtained even\nif the true LMMSE channel estimator was used instead of the suboptimal one.\n(L)\n\nLet \u1ef8t\n\n(L)\n\n= {\u1ef9 l,t \u2208 CN : for all l} denote the received vectors postulated by the LMMSE detector in symbol\n\nperiod t. Furthermore, we write the postulated data symbols in symbol period t and the postulated data symbols\n(L)\n\nexcept for B\u0303t,k as B\u0303t\n\n(L)\n\n(L)\n\n(L)\n\n= {B\u0303t,k : for all k} and B\u0303t,\\{k} = {B\u0303t,k\u2032 : for all k \u2032 6= k}, respectively. The linear estimator\n(L)\n\nof Bt,k is given by the mean of B\u0303t,k with respect to the posterior pdf\nR\n(L)\n(L)\n(L)\n(L)\np(\u1ef8t = Yt |B\u0303t , St , IT\u03c4 )p(B\u0303t )dB\u0303t,\\{k}\n(L)\n(L)\np(B\u0303t,k |\u1ef8t = Yt , St , IT\u03c4 ) = R\n,\n(L)\n(L)\n(L)\n(L)\np(\u1ef8t = Yt |B\u0303t , St , I\u03c4 )p(B\u0303t )dB\u0303t\n\nwith\n\n(L) (L)\np(\u1ef8t |B\u0303t , St , Itr )\n(L)\n\n(L)\n\n=\n\nZ\n\nI\u03c4\n(L) (L)\n(L)\np(\u1ef8t |B\u0303t , St , {w\u0303t,k,m }, {\u0125k,m })\n\n(L)\n\nK Y\nM n\no\nY\n(L)\n(L)\np(w\u0303 t,k,m )dw\u0303 t,k,m ,\n\n(23)\n\n(24)\n\nk=1 m=1\n\nwhere p(\u1ef8t |B\u0303t , St , {w\u0303t,k,m }, {\u0125k,m }) represents the MIMO DS-CDMA channel (22) in the t(> \u03c4 )th symbol\nperiod postulated by the LMMSE detector.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n15\n\nThe LMMSE detector provides the posterior pdf (23) to the decoder of the kth user. The transfer of (23) is\nequivalent to feeding the LMMSE estimate of Bt,k and the covariance matrix of its estimation errors. We remark\nthat our LMMSE receiver is equivalent to the one proposed by Evans and Tse [34] for N = M = 1.\nThe spectral efficiency of the LMMSE receiver is given by\n\u0012\n\u0013 K\nK\n\u03c4 X\n(L)\n1\u2212\nCL =\nI(Bt,k ; B\u0303t,k |I\u03c4 , St ).\nL\nTc\n\n(25)\n\nk=1\n\n(L)\n\nIn (25), the mutual information I(Bt,k ; B\u0303t,k |I\u03c4 , St ) is characterized by the equivalent channel between user k and\nthe corresponding decoder for the LMMSE receiver,\nZ\n(L)\n(L)\n(L)\np(B\u0303t,k |Bt,k , St , IT\u03c4 ) = p(B\u0303t,k |\u1ef8t = Yt , St , IT\u03c4 )p(Yt |Bt,k , St , IT\u03c4 )dYt ,\n\n(26)\n\nwhere p(Yt |Bt,k , St , IT\u03c4 ) is defined in the same manner as in (19).\nV. M AIN R ESULTS\nA. Large-System Analysis\nIn order to evaluate the spectral efficiencies of the four receivers listed in Table I, we consider the large-system\nlimit, in which the number of users K and the spreading factor L tend to infinity while the system load \u03b2 = K/L and\nthe number of transmit and receive antennas are kept constant. More precisely, we evaluate the spectral efficiencies\nby analyzing asymptotic properties of the equivalent channel between a finite number of users and their decoders.\nWe write a finite number of users as K, which is a finite subset of {1, . . . , K}, and consider the large-system limit\nlimK,L\u2192\u221e in which K and L tend to infinity with \u03b2 and K fixed.\nWe focus on substage k within stage t of the joint CE-MUDD. A finite subset of users K is chosen from\nthe set {k, . . . , K} of users decoded in the current and following substages, i.e., K \u2229 {1, . . . , k \u2212 1} = \u2205. Let\nBt,K = {Bt,k : k \u2208 K} and B\u0303t,K = {B\u0303t,k : k \u2208 K} denote the data symbols and the postulated data symbols for a\nfinite subset K of users in symbol period t, respectively. The equivalent channel p(B\u0303t,K |Bt,K , Bt,[1,k) , ITt\u22121 , St , H)\nbetween the users in K and their decoders, defined in the same manner as in (18), is expected to be self-averaging\nwith respect to the spreading sequences St in the large-system limit: The equivalent channel converges to the one\naveraged over the spreading sequences for almost all realizations of the data symbols Bt,K , the data symbols Bt,[1,k)\n\ndecoded in the preceding substages, the known information ITt\u22121 in symbol periods t\u2032 \u2208 Tt\u22121 , and the channel\nvectors H in the large-system limit. The self-averaging property has been proved for linear receivers [15], [34]\nand for the constrained capacity of CDMA systems with perfect CSI at the receiver [47], [54]. However, it is an\nopen challenging problem to show whether the self-averaging property holds for general receivers. Therefore, we\npostulate the self-averaging property.\nAssumption 1. The conditional distribution of B\u0303t,K given Bt,K , Bt,[1,k) , ITt\u22121 , St , and H converges in law to a\n\nconditional distribution that is independent of St in the large-system limit.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n16\n\nAnother crucial assumption is replica symmetry (RS) [18]. See Appendix C for a formal definition of the RS\nassumption. In order to present an intuitive understanding of the RS assumption, let us consider an iterative MUD\nalgorithm based on belief propagation (BP) [55]. Roughly speaking, the algorithm iteratively calculates a local\nminimum solution of an object function, called free energy, in the large-system limit. The global minimum solution\nof the free energy corresponds to the optimal one. The RS assumption implies that the free energy has the unique\nstable solution or at most two stable solutions. If the free energy has many stable solutions, replica-symmetry\nbreaking (RSB) should be assumed [39].\nTwo necessary conditions for checking the RS assumption are known: de Almeida-Thouless (AT) stability [56] and\nthe non-negative-entropy condition [39]. The AT condition is a necessary condition for the stability of RS solutions.\nThe non-negative-entropy condition is a necessary condition under which the entropy for the posterior distribution\nof replicated random variables is non-negative when the random variables are discrete. Note that the non-negativeentropy condition is not defined for the no-CSI case, since the channel vectors are not discrete. See Appendix D\nfor details. The RS solution for the individually-optimal (IO) receiver with perfect CSI, which corresponds to\nthe optimum separated receiver in this paper, has been proved to satisfy the AT stability condition [18], [57].\nFurthermore, that solution satisfies the non-negative-entropy condition derived in [18, Equation (69)] for CDMA\nsystems with perfect CSI2 . These results may imply that the RS assumption is valid for the IO receiver. In fact,\nseveral rigorous studies have shown that this statement is partially correct: Nishimori [57] has used a gauge theory\nto show that the free energy has no complicated structure for the IO receiver. See Appendix C for the precise\nstatement. Korada and Montanari [47] have proved that the RS assumption is correct if the free energy under the\nRS assumption has the unique stable solution. Thus, we postulate the RS assumption in this paper.\nWe show under these assumptions that the randomly-spread MIMO DS-CDMA channel with no CSI is decoupled\ninto a bank of single-user single-input multiple-output (SIMO) channels with no CSI\ny t,k,m = hk,m ut,k,m + nt,k,m ,\n\n(27)\n\nwhere nt,k,m \u223c CN (0, \u03c3t2 I N ) denotes AWGN with variance \u03c3t2 . The equivalent channel between the users in K and\ntheir decoders looks like a bundle of the single-user SIMO channels (27) with the original channel estimator (11).\nFurthermore, MAI to the users in K converges towards MAI from the single-user SIMO channels (27) with no\nCSI in the large-system limit. Our result is an extension of the decoupling results for randomly-spread MIMO\nDS-CDMA channels with perfect CSI at the receiver [11], [20] to the no-CSI case at the receiver. The difference\nfrom the previous decoupling results appears in the receiver structure for the SIMO channel (27), which depends\non the receiver structure of the original MIMO DS-CDMA systems.\nThe equivalent channel between the users in K and the corresponding decoders is characterized by two receivers\nfor the decoupled SIMO channels (27), i.e., a receiver for the users in K and another receiver for the users who\ninterfere to the users in K. In the former receiver joint decoding of all data streams for each user is performed. The\n2\n\nIt is straightforward to prove that the non-negative-entropy condition [18, Equation (69)] is satisfied for the IO receiver, although the proof\n\nwas not presented in [18].\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\noriginal\nchannel estimator\n\n17\n\nreceived vectors of the MIMO\nDS-CDMA channel\n\ninformation about channel vectors\ninformation about bt,k,1\noptimal detector\n\ndecoder k\ninformation about bt,k,M\n\nreceived vectors of the SIMO channels\nin symbol period t\n\nFig. 4.\n\nReceiver for the users in K.\n\nreceiver consists of the original LMMSE channel estimator providing the marginal posterior pdfs (11), an optimal\ndetector, and the decoder of user k (See Fig. 4). The latter receiver performs per-stream decoding, and is to be used\nin the decoupled expression for quantifying the strength of MAI from outside K. The receiver consists of another\nLMMSE channel estimator, the optimal detector, and the per-stream decoders (See Fig. 5). Note that the information\nBt,[1,k) in the preceding substages does not appear explicitly in the two receivers. It affects the decoupling results\nvia the noise variance \u03c3t2 .\n\nDefinition 1 (Receiver for the users in K). In symbol period t(> \u03c4 ), the optimal detector uses the information\nabout the received vectors Y t,k = {y t,k,m : for all m} of the single-user SIMO channel (27) in symbol period t\nand about the posterior pdf (11) provided by the original channel estimator to construct the posterior pdf\nQM\nm=1 p(y t,k,m |hk,m , bt,k,m )p(Hk |ITt\u22121 )p(Bt,k )\np(Bt,k |Y t,k , ITt\u22121 ) = R QM\n,\nm=1 p(y t,k,m |hk,m , bt,k,m )p(Hk |ITt\u22121 )p(Bt,k )dHk dBt,k\n\n(28)\n\nwhere p(y t,k,m |hk,m , bt,k,m ) represents the single-user SIMO channel (27). Subsequently, the optimal detector\n\nsends the posterior pdf (28) towards the decoder of user k.\nDefinition 2 (Receiver for the interfering users). The LMMSE channel estimator constructs the posterior pdf\np(hk,m |I Tt\u22121 ,k,m ) of hk,m by utilizing the information I Tt\u22121 ,k,m = {I t\u2032 ,k,m : t\u2032 \u2208 Tt\u22121 } in the preceding stages,\nin which I t\u2032 ,k,m = {ut\u2032 ,k,m , y t\u2032 ,k,m } denotes the information about the input symbol ut\u2032 ,k,m and the received\nvector y t\u2032 ,k,m in the single-user SIMO channel (27). Subsequently, the posterior pdf p(hk,m |I Tt\u22121 ,k,m ) is sent\ntowards the optimal detector.\nIn symbol period t(> \u03c4 ), the optimal detector utilizes the information about the received vector y t,k,m and\np(hk,m |I Tt\u22121 ,k,m ) provided by the channel estimator for the SIMO channel (27), and constructs the posterior pdf\nZ\np(bt,k,m |y t,k,m , I Tt\u22121 ,k,m ) = p(bt,k,m , hk,m |y t,k,m , I Tt\u22121 ,k,m )dhk,m ,\n(29)\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\nLMMSE\nchannel estimator\n\n18\n\nreceived vectors of the SIMO channel\n\ninformation about hk,m\ninformation about bt,k,1\ndecoder\noptimal detector\ninformation about bt,k,M\ndecoder\nreceived vector of the SIMO channel\nin symbol period t\n\nFig. 5.\n\nReceiver for the users interfering to the users in K.\n\nwith\np(bt,k,m , hk,m |y t,k,m , I Tt\u22121 ,k,m ) = R\n\np(y t,k,m |hk,m , bt,k,m )p(bt,k,m )p(hk,m |I Tt\u22121 ,k,m )\n\np(y t,k,m |hk,m , bt,k,m )p(bt,k,m )p(hk,m |I Tt\u22121 ,k,m )dbt,k,m dhk,m\n\n.\n\n(30)\n\nSubsequently, the optimal detector sends the posterior pdf (29) towards the corresponding per-stream decoder.\nWe summarize several symbols used for claiming the main results. The LMMSE estimate of hk,m for the\nsingle-user SIMO channel (27) is denoted by\nZ\nTt\u22121\n\u0125k,m = hk,m p(hk,m |I Tt\u22121 ,k,m )dhk,m .\n\n(31)\nT\n\nTt\u22121\n\nt\u22121\n2\nWhen \u03c3t2\u2032 = \u03c3tr\nfor t\u2032 \u2208 Tt\u22121 , the covariance matrix of the LMMSE estimation error \u2206hk,m\n= hk,m \u2212 \u0125k,m is\n\n2\ngiven by \u03be 2 (\u03c3tr\n, t \u2212 1)I N [58], with\n\n2\n\u03be 2 (\u03c3tr\n, t \u2212 1) =\n\n2\n\u03c3tr\n2 ,\n(t \u2212 1)(P/M ) + \u03c3tr\n\n(32)\nTt\u22121\n\nwhere (t \u2212 1) corresponds to the length of the training phase in stage t. The estimate \u0125k,m is a CSCG random\nTt\u22121\n\nT\n\nt\u22121\n2\nare uncorrelated. Furthermore,\nvector with the covariance matrix (1 \u2212 \u03be 2 (\u03c3tr\n, t \u2212 1))I N , since \u0125k,m and \u2206hk,m\n\nwe write the posterior mean of bt,k,m given y t,k,m and I Tt\u22121 ,k,m as\nZ\nhbt,k,m i = bt,k,m p(bt,k,m , hk,m |y t,k,m , I Tt\u22121 ,k,m )dbt,k,m dhk,m .\n\n(33)\n\n2\nFinally, let C t (\u03c3tr\n(t \u2212 1), \u03c3t2 ) denote the conditional mutual information between the data symbol bt,1,1 and the\n\nreceived vector y t,1,1 for the SIMO channel (27) given the information I Tt\u22121 ,1,1 , i.e.,\n2\n(t \u2212 1), \u03c3t2 ) = I(bt,1,1 ; y t,1,1 |I Tt\u22121 ,1,1 ),\nC t (\u03c3tr\n\n(34)\n\n2\nwith \u03c3t2\u2032 = \u03c3tr\n(t \u2212 1) for t\u2032 \u2208 Tt\u22121 . The conditional mutual information corresponds to the spectral efficiency of\n\nthe receiver defined in Definition 2 for the single-user SIMO channel (27).\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n19\n\nRemark 2. We shall discuss the relationship between the RSB assumption and the decoupling result. Under the RSB\nassumption, the equivalent channel would still be decoupled into single-user channels. However, the noise in the\nSIMO channel (27) would be non-Gaussian. This implies that if the RS assumption is not correct a naive intuition\nis wrong: MAI should converge to Gaussian noise due to the central limit theorem. In fact, the RSB assumption\nshould be considered if the jointly-optimal (JO) receiver is used [18], [59].\nB. Optimum Separated Receiver\nIt is the main part in our derivation to analyze the spectral efficiency (21) of the optimum separated receiver\nin the large-system limit. The spectral efficiencies of the one-shot CE-MUDD and the joint CE-MUDD can be\nstraightforwardly derived from the result for the optimum separated receiver. Thus, we first present an analytical\nexpression for the spectral efficiency of the optimum separated receiver. Analytical formulas for the spectral\nefficiencies of the one-shot CE-MUDD and the joint CE-MUDD will be presented in Section V-C and Section V-D.\nLet B\u0303 t,k = {b\u0303t,k,m \u2208 C : for all m} \u223c p(Bt,k |Y t,k , IT\u03c4 ), defined by (28), denote random variables representing\nthe information about Bt,k , provided by the optimal detector. The equivalent channel between user k and the\ncorresponding decoder is given by\np(B\u0303 t,k |Bt,k , Hk , IT\u03c4 ) =\n\nZ\n\np(Bt,k = B\u0303 t,k |Y t,k , IT\u03c4 )\n\nM n\nY\n\nm=1\n\no\np(y t,k,m |hk,m , bt,k,m )dy t,k,m .\n\n(35)\n\nProposition 1. Assume that Assumption 1 and the RS assumption hold. Then,\nlim p(B\u0303t,K |Bt,K , IT\u03c4 , St , H) =\n\nK,L\u2192\u221e\n\nY\n\nk\u2208K\n\np(B\u0303 t,k = B\u0303t,k |Bt,k , Hk , IT\u03c4 ) in law,\n\nwhere \u03c3t2 = \u03c3c2 for t \u2208 C\u03c4 +1 is given by a solution to the fixed-point equation\n(\n)\n\u0012\n\u00132 h\ni\nT\u03c4 2\n\u03b2 X\nP \u03be 2 \u03c3c2\n\u03c3c2\nM\n2\n2\n\u03c3c = N0 + lim\n+\nE k\u0125k,1 k |bt,k,1 \u2212 hbt,k,1 i|\n,\nK\u2192\u221e K\n(P/M )\u03be 2 + \u03c3c2\nN (P/M )\u03be 2 + \u03c3c2\n\n(36)\n\n(37)\n\nk\u2208K\n/\n\nT\u03c4\n\n2\n2\nwith \u0125k,1 and \u03be 2 = \u03be 2 (\u03c3tr\n(\u03c4 ), \u03c4 ) give by (31) and (32), respectively. In evaluating (37), \u03c3t2\u2032 = \u03c3tr\n(\u03c4 ) for t\u2032 \u2208 T\u03c4\n\nis given as the unique solution to the fixed-point equation\n2\n2\n\u03c3tr\n(\u03c4 ) = N0 + \u03b2P \u03be 2 (\u03c3tr\n(\u03c4 ), \u03c4 ).\n\n(38)\n\nIf (37) has multiple solutions, one should choose the solution minimizing the following quantity\n\u03b2M X\nI(bt,k,1 , hk,1 ; y t,k,1 |I T\u03c4 ,k,1 ) + N D(N0 k\u03c3c2 ).\nK\u2192\u221e K\nlim\n\n(39)\n\nk\u2208K\n/\n\nThe derivation of Proposition 1 is deferred to the end of this section. The fixed-point equation (38) was originally\nderived in [34] by using rigorous random matrix theory, while we have used the replica method. The second term\nof the right-hand side of (37) corresponds to MAI from the users who do not belong to the users in K. This\nexpression implies that the asymptotic MAI becomes the sum of interference from (K \u2212 |K|)M independent SIMO\nchannels (27). Furthermore, each interference is represented by two effects: The first term within the curly brackets\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n20\n\nin (37) corresponds to contribution from channel estimation errors, and the second term corresponds to MAI from\nthe single-user SIMO channel with perfect CSI at the receiver,\nT\u03c4\n\nz t,k,m = \u0125k,m bt,k,m + v t,k,m ,\n\n(40)\n\nwith v t,k,m \u223c CN (0, [(P/M )\u03be 2 + \u03c3c2 ]I N ). The received vector z t,k,m conditioned on I T\u03c4 ,k,m and bt,k,m is\n\nstatistically equivalent to y t,k,m in (27) under the same conditions, due to |bt,k,m |2 = P/M with probability one.\nWe remark that this interpretation holds only for phase-shift keying modulations.\nThe fixed-point equation (37) can have multiple solutions. The criterion (39) to select the correct solution\ncorresponds to the conditional mutual information L\u22121 I(Bt , H; Yt |St , IT\u03c4 ) in the large-system limit, although\nits proof is omitted. This phenomenon is related to the so-called phase coexistence in statistical mechanics. For\nthe details in the context of wireless communications, see [18], [20]. The existence of multiple solutions implies\nthat the asymptotic performance discontinuously changes at a critical point. This asymptotic result predicts that the\nperformance sharply changes in the neighborhood of the critical point for finite-sized systems.\nProposition 1 implies that the equivalent channel between the users in K and their decoders is not fully decoupled\ninto single-user channels, since the channel estimator in Definition 1 utilizes the information IT\u03c4 depending on\nall users. This is the main difference between the cases of perfect CSI and of no CSI. The following proposition\nindicates that the equivalent channel is decomposed in terms of the spectral efficiency.\nProposition 2. Assume that Assumption 1 and the RS assumption hold. Then, the spectral efficiency (21) of the\noptimum separated receiver converges to the spectral efficiency of the optimum separated receiver for the single-user\nSIMO channel (27) in the large-system limit,\nlim Csep = \u03b2M\n\nK,L\u2192\u221e\n\n\u0012\n\u0013\n\u03c4\n2\n1\u2212\n(\u03c4 ), \u03c3c2 ),\nC \u03c4 +1 (\u03c3tr\nTc\n\n(41)\n\n2\n2\n(\u03c4 ), \u03c3c2 ) is given by (34). In evaluating the right-hand side, \u03c3tr\n(\u03c4 ) is given as the solution to the\nwhere C \u03c4 +1 (\u03c3tr\n\nfixed-point equation (38). On the other hand, \u03c3c2 is given as a solution to the fixed-point equation (37). If (37) has\nmultiple solutions, the solution minimizing (39) should be chosen.\nProof of Proposition 2: We use a technical lemma, presented in the end of this section, to prove Proposition 2.\nSee Appendix F for the details.\nThis result implies that the asymptotic equivalent channel between user k and the associated decoder looks like\nthe SIMO channel (27) in terms of the spectral efficiency. In other words, the performance loss caused by coding\nthe data streams for each user separately vanishes in the large-system limit, as shown in [11] for the perfect-CSI\ncase. We remark that it is relatively easy to evaluate (41) numerically, by using y t,k,m \u223c z t,k,m in (40) conditioned\non I T\u03c4 ,k,m and bt,k,m .\nThe prefactor (1 \u2212 \u03c4 /Tc ) corresponds to the rate loss due to the transmission of pilot symbols. The spectral\n\n2\nefficiency C \u03c4 +1 (\u03c3tr\n(\u03c4 ), \u03c3c2 ) grows with the increase of \u03c4 since the channel estimation improves, while the prefactor\n\ndecreases. Thus, there is the optimal length of the training phase to maximize the spectral efficiency of the optimum\nseparated receiver, as shown in Section VI.\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n21\n\nWe shall present a sketch of the derivation of Proposition 1. The derivation of Proposition 1 consists of two\nparts: the analysis of the channel estimator and the analysis of the optimal detector. The goal in the analysis of the\nchannel estimator is to prove the following lemma.\n{a}\n\nLemma 1. Let Hk\n\n{a}\n\n= {hk,m : for all m} be replicas of the channel vectors Hk for a \u2208 {1, . . . , n}, with a\n\n{a}\n\nnatural number n: {Hk } are independently drawn from p(Hk ) for all k. Suppose that {Ak } are mutually disjoint\n{1}\n\nsubsets of {2, 3, . . . , n} for all k \u2208 K. We define a random variable Xk (Hk , IT\u03c4 ; \u0398) \u2208 R with a set \u0398 of fixed\nparameters as\n{1}\n\nXk (Hk , IT\u03c4 ; \u0398) =\n{a}\n\nwith HkAk = {Hk\n{1}\n\nZ\n\n{1}\n\nfk (Hk , HkAk ; \u0398)\n\no\nY n\n{a}\n{a}\n,\np(Hk |IT\u03c4 )dHk\n\n(42)\n\na\u2208Ak\n\n: a \u2208 Ak } denoting the set of the replicated channel vectors associated with indices Ak . In\n{1}\n\n(42), fk (Hk , HkAk ; \u0398) \u2208 R is a deterministic function of Hk , HkAk , and \u0398. Suppose that the joint moment\n{1}\n\ngenerating function of {Xk (Hk , IT\u03c4 ; \u0398) : k \u2208 K} exists in the neighborhood of the origin. Then,\nY\nlim p({Xk : k \u2208 K}) =\np(X k = Xk ),\nK,L\u2192\u221e\n\n(43)\n\nk\u2208K\n\nin which\n\n{1}\n\nX k (Hk , I T\u03c4 ,k ; \u0398) =\n\nZ\n\n{1}\n\nfk (Hk , HkAk ; \u0398)\n\nM n\nY Y\n\na\u2208Ak m=1\n\no\n{a}\n{a}\np(hk,m = hk,m |I T\u03c4 ,k,m )dhk,m ,\n\n(44)\n\nwith I T\u03c4 ,k = {I T\u03c4 ,k,m : for all m}. In (43), Xk and X k are abbreviations of (42) and (44). In evaluating (44),\n2\n\u03c3t2 = \u03c3tr\n(\u03c4 ) for t \u2208 T\u03c4 is given by the solution to the fixed-point equation (38).\n\nProof of Lemma 1: See Appendix B.\nLemma 1 is used to prove that MAI to the users in K is self-averaging with respect to IT\u03c4 under Assumption 1.\nThe natural number n corresponds to the number of replicas introduced in the analysis of the optimal detector. The\ndetails of the derivation of Proposition 1 are summarized in Appendix D.\nC. One-Shot CE-MUDD\nWe present an analytical expression for the spectral efficiency (20) of the one-shot CE-MUDD. The expression\nis straightforwardly obtained from Proposition 2.\nProposition 3. Suppose that Assumption 1 and the RS assumption hold. Then, the spectral efficiency (20) of the\none-shot CE-MUDD is given by\nlim\n\nK,L\u2192\u221e\n\nCone = \u03b2M\n\n\u0012\n\u0013Z 1\n\u03c4\n2\n1\u2212\n(\u03c4 ), \u03c3c2 (\u03ba))d\u03ba,\nC \u03c4 +1 (\u03c3tr\nTc\n0\n\n(45)\n\n2\n2\nin the large-system limit, in which C \u03c4 +1 (\u03c3tr\n(\u03c4 ), \u03c3c2 (\u03ba)) is defined as (34). In evaluating the integrand, \u03c3t2 = \u03c3tr\n(\u03c4 )\n\nfor t \u2208 T\u03c4 is given as the solution to the fixed-point equation (38). On the other hand, \u03c3c2 (\u03ba) satisfies the fixed-point\nequation\n\u03c3c2 (\u03ba)\n\n\u03b2P \u03be 2 \u03c3c2 (\u03ba)\n\u03b2(1 \u2212 \u03ba)M\n= N0 +\n+\n2\n2\n(P/M )\u03be + \u03c3c (\u03ba)\nN\n\nOctober 26, 2018\n\n\u0012\n\n\u03c3c2 (\u03ba)\n(P/M )\u03be 2 + \u03c3c2 (\u03ba)\n\n\u00132\n\ni\nh\nE k\u01251,1 k2 |b\u03c4 +1,1,1 \u2212 hb\u03c4 +1,1,1 i|2 ,\n\n(46)\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n22\n\nT\u03c4\n\n2\nwith \u01251,1 = \u01251,1 and \u03be 2 = \u03be 2 (\u03c3tr\n(\u03c4 ), \u03c4 ) given by (31) and (32), respectively. If the fixed-point equation (46) has\n\nmultiple solutions, one should choose the solution minimizing the following quantity\ni\nh\n\u03b2M \u03baI(h1,1 ; y \u03c4 +1,1,1 |b\u03c4 +1,1,1 , I T\u03c4 ,1,1 ) + (1 \u2212 \u03ba)I(b\u03c4 +1,1,1 , h1,1 ; y \u03c4 +1,1,1 |I T\u03c4 ,1,1 ) + N D(N0 k\u03c3c2 (\u03ba)).\n\n(47)\n\nThe integrand in (45) is equal to the asymptotic spectral efficiency of the optimum separated receiver for a\nMIMO DS-CDMA system in which (1 \u2212 \u03ba)K users send data symbols and \u03baK users transmit symbols known to\nthe receiver in symbol period \u03c4 + 1. The symbols known to the receiver corresponds to the data symbols decoded\nsuccessfully in the preceding substages. The factor 1 \u2212 \u03ba appears in the last term of the right-hand side of (46),\nsince the system load decreases effectively as successive decoding proceeds.\nProof of Proposition 3: The quantity C\u03c4 +1,k in the spectral efficiency (20) of the one-shot CE-MUDD\ncorresponds to the spectral efficiency of the optimum separated receiver for a MIMO DS-CDMA system in which\nthe first (k \u2212 1) users transmit known symbols {pt,k\u2032 ,m } for k \u2032 = 1, . . . , k \u2212 1 in symbol period t(> \u03c4 ). We have\nalready evaluated the spectral efficiency in Proposition 2 when all users transmit data symbols in symbol period t.\nWe do not use the statistical property of each data symbol bt,k,m in the derivation of Proposition 2. Furthermore, the\nderivation still holds even if the noise variance \u03c3t2 for the single-user SIMO channel (27) depends on k. For some\nnatural number K0 , consider the large-system limit in which K, L, and K0 tend to infinity while \u03b2 = K/L and\n\u03ba0 = K0 /K are kept constant. Replacing the prior of bt,k\u2032 ,m for k \u2032 = 1, . . . , k \u2212 1 by Prob(bt,k\u2032 ,m = pt,k\u2032 ,m ) = 1\nand Prob(bt,k\u2032 ,m 6= pt,k\u2032 ,m ) = 0 in substage k \u2265 K0 , we find that the fixed-point equation (37) reduces to (46)\n\nwith \u03ba = k/K, since E[khTk\u2032\u03c4,1 k2 |bt,k\u2032 ,1 \u2212 hbt,k\u2032 ,1 i|2 ] = 0 for k \u2032 = 1, . . . , k \u2212 1. Similarly, the quantity (39) for\n\nt = \u03c4 + 1 reduces to (47). These results imply\n#\n\u0013 \" KX\n\u0012\n\u22121\nK\n1 0\nM X\n\u03c4\n2\n2\nC \u03c4 +1 (\u03c3tr (\u03c4 ), \u03c3c (\u03ba)) ,\nCt,k +\nCone = \u03b2 1 \u2212\nTc\nK\nK\nk=1\n\n(48)\n\nk=K0\n\n2\nin the large-system limit. In evaluating the second term, \u03c3tr\n(\u03c4 ) is given as the solution to the fixed-point equa-\n\ntion (38). On the other hand, \u03c3c2 (\u03ba) satisfies the fixed-point equation (46). If the latter fixed-point equation has\nmultiple solutions, the solution minimizing (47) should be chosen.\nR1\nP\nThe definition of the Riemann integral implies that K \u22121 K\nk=K0 in the second term of (48) becomes \u03ba0 d\u03ba in\n\nthe large-system limit. Therefore, we arrive at Proposition 3 by taking \u03ba0 \u2192 0, since the first term in (48) vanishes\nin that limit.\nD. Joint CE-MUDD\nWe evaluate the spectral efficiency (16) of the joint CE-MUDD in the large-system limit. An analytical expression\nof the spectral efficiency (16) is immediately obtained from Proposition 3.\nProposition 4. Suppose that Assumption 1 and the RS assumption hold. Then, the spectral efficiency (16) of the\njoint CE-MUDD is given by\nlim Cjoint =\n\nK,L\u2192\u221e\n\nOctober 26, 2018\n\nTc Z 1\n\u03b2M X\nC (\u03c3 2 (t \u2212 1), \u03c3c2 (\u03ba))d\u03ba,\nTc t=\u03c4 +1 0 t tr\n\n(49)\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n23\n\n2\n2\nin the large-system limit, in which C t (\u03c3tr\n(t \u2212 1), \u03c3c2 (\u03ba)) is defined as (34). In evaluating the integrand, \u03c3tr\n(t \u2212 1)\n\nis given as the solution to the fixed point equation (38) with \u03c4 = t \u2212 1. On the other hand, \u03c3c2 (\u03ba) satisfies the\nTt\u22121\n\nfixed-point equation (46) with \u01251,1 = \u01251,1\n\n2\n(t \u2212 1), t \u2212 1) given by (31) and (32), respectively. If\nand \u03be 2 = \u03be 2 (\u03c3tr\n\nthe fixed-point equation (46) has multiple solutions, the solution minimizing (47) should be chosen.\nDerivation of Proposition 4: The quantity Ct,k in (16) corresponds to the spectral efficiency of the one-shot\nCE-MUDD for the MIMO DS-CDMA channel (2) with the first t \u2212 1 symbol periods as a training phase. Applying\nProposition 3 with \u03c4 = t \u2212 1 to (16), we obtain (49).\nThe spectral efficiency (49) does not decrease with each increase of \u03c4 . Furthermore, the integral in (49) is equal\nto zero for t = 1, since t = 1 implies no pilots. Therefore, the spectral efficiency (49) is maximized at \u03c4 = 0 and\n\u03c4 = 1 if the integral in (49) is strictly positive for t \u2265 2. This observation implies that the joint CE-MUDD can\nreduce the training overhead significantly.\nRemark 3. We have so far considered the equal power case. One interesting issue would be temporal power\nallocation. It is straightforward to extend Proposition 4 to the temporally unequal power case. Intuitively, allocating\nmuch power to around the beginning of one fading block improves the accuracy of the channel estimates, while\npower used for transmission of data symbols around the end decreases. Thus, it is not straightforward to find the\ntemporally optimal power allocation. This power allocation issue is left as future work.\nRemark 4. It is possible in principle to evaluate the spectral efficiency of joint CE-MUDD based on nonlinear\nchannel estimation in the large-system limit, in which the channel estimator sends the marginal posterior pdfs\n{p(Hk |ITt\u22121 , I Ct+1 )} to the optimal detector in stage t, instead of (11). The spectral efficiency would be given as\nthat of a receiver with the optimal nonlinear channel estimator for the single-user SIMO channel (27). However,\nthe obtained spectral efficiency is difficult to calculate in terms of the computational complexity. In this sense, the\nbound based on nonlinear channel estimation is not an analytical one, while the formula itself is simple.\nE. LMMSE Receiver\nThe LMMSE receiver for M = N = 1 has been analyzed rigorously in [34] by using random matrix theory. In\nthis section, we show that the replica method can derive the same result as the rigorous one.\nThe spectral efficiency (25) of the LMMSE receiver is given via the spectral efficiency of a bank of the single-user\nSIMO channels (27) with an LMMSE receiver. We first define the LMMSE receiver for the SIMO channel (27),\nafter which we present an analytical expression for the spectral efficiency (25) of the LMMSE receiver in the\nlarge-system limit. The LMMSE receiver is obtained by replacing the optimal detector in Fig. 5 by the LMMSE\ndetector.\nDefinition 3. The LMMSE detector estimates the data symbol bt,k,m from the received vector y t,k,m for the singleuser SIMO channel (27) in the same symbol period t and the information about hk,m provided by the LMMSE\nchannel estimator defined in Definition 2, and feeds the information about bt,k,m to the per-stream decoders. In\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n24\n\norder to define the information about bt,k,m , we consider the single-user SIMO channel in the tth symbol period\npostulated by the LMMSE detector,\nT\u03c4\n\n(L)\n\n(L)\n\n(L)\n\n= \u0125k,m b\u0303t,k,m + w\u0303t,k,m + \u00f1t,k,m ,\n\u1ef9 (L)\nt,k,m\n\n(50)\n\nT\u03c4\n\n(L)\n\nwith \u00f1t,k,m \u223c CN (0, \u03c3t2 I N ). In (50), \u0125k,m denotes the LMMSE channel estimate (31) for the single-user SIMO\n(L)\n\nchannel (27). The vector w\u0303t,k,m \u2208 CN conditioned on I T\u03c4 ,k,m is a CSCG random vector with the covariance\n\u03c4\nmatrix (P/M )\u03a3t,k,m , in which \u03a3t,k,m denotes the covariance matrix of the channel estimation errors \u2206hTk,m\n=\n\nT\u03c4\n\nT\u03c4\n\nT\u03c4\n\nhk,m \u2212 \u0125k,m , i.e., \u03a3t,k,m = E[\u2206\u0125k,m (\u2206\u0125k,m )H |I T\u03c4 ,k,m ]. The information about bt,k,m is defined as\nZ\n(L)\n(L)\n(L)\n(L)\np(b\u0303t,k,m |y (L)\n,\nI\n=\ny\n= y t,k,m , I T\u03c4 ,k,m )dw\u0303 t,k,m ,\n)\n=\np(b\u0303t,k,m , w\u0303t,k,m |y (L)\nT\u03c4 ,k,m\nt,k,m\nt,k,m\nt,k,m\n\n(51)\n\nwith\n(L)\n\n(L)\n(L)\np(b\u0303t,k,m , w\u0303t,k,m |y (L)\n, I T\u03c4 ,k,m )\nt,k,m\n(L)\n\n(L)\n\n(L)\n\nT\u03c4\n\n=R\n\n(L)\n\n(L)\n\n(L)\n\nT\u03c4\n\n(L)\n\n(L)\n\np(y t,k,m |b\u0303t,k,m , w\u0303t,k,m , \u0125k,m )p(w\u0303t,k,m )p(b\u0303t,k,m )\n(L)\n\n(L)\n\nT\u03c4\n\n(L)\n\n(L)\n\n(L)\n\n(L)\n\n,\n\n(52)\n\np(y t,k,m |b\u0303t,k,m , w\u0303t,k,m , \u0125k,m )p(w\u0303 t,k,m )p(b\u0303t,k,m )dw\u0303 t,k,m db\u0303t,k,m\n\nwhere p(y t,k,m |b\u0303t,k,m , w\u0303t,k,m , \u0125k,m ) denotes the single-user SIMO channel (50) postulated by the LMMSE detector.\nProposition 5. Under the RS assumption, the spectral efficiency (25) of the LMMSE receiver converges to the\nspectral efficiency of the LMMSE receiver for the single-user SIMO channel (27) with in the large-system limit:\n\u0013\n\u0012\n\u03c4\n2\n(\u03c4 ), \u03c3L2 ),\n(53)\nC \u03c4 +1 (\u03c3tr\nlim CL = \u03b2M 1 \u2212\nK,L\u2192\u221e\nTc\n\n2\n2\nwhere C \u03c4 +1 (\u03c3tr\n(\u03c4 ), \u03c3L2 ) is given by (34). In evaluating (53), \u03c3tr\n(\u03c4 ) for t \u2208 T\u03c4 is given as the solution to the\n\nfixed-point equation (38). On the other hand, \u03c3L2 satisfies the fixed-point equation\n\u00132 h\n\u0012\ni\nT\u03c4\n\u03c3L2\n\u03b2M\n\u03b2P \u03be 2 \u03c3L2\n(L)\nE k\u0125k,m k2 |bt,k,m \u2212 hb\u0303t,k,m iL |2 ,\n+\n\u03c3L2 = N0 +\n2\n2\n2\n2\n(P/M )\u03be + \u03c3L\nN\n(P/M )\u03be + \u03c3L\nR\n(L)\n(L)\n(L)\n(L)\n2\nwith \u03be 2 = \u03be 2 (\u03c3tr\n(\u03c4 ), \u03c4 ) and h* * * iL = * * * p(b\u0303t,k,m , w\u0303t,k,m |\u1ef9 (L)\n= y t,k,m , I T\u03c4 ,k,m )db\u0303t,k,m dw\u0303t,k,m .\nt,k,m\n\n(54)\n\nNote that the LMMSE receiver can achieve the constrained capacity of the single-user SIMO channel (27). The\n\nfixed-point equation (54) coincides with that in [34] for M = N = 1. This implies that the result obtained by\nusing the replica method is correct for the LMMSE receiver. The difference between the fixed-point equations (37)\nand (54) appears in the last terms of their respective right-hand sides. The last term of the right-hand side of (54)\ncorresponds to the mean-squared error (MSE) of the linear MMSE estimate of bt,k,m for the single-user SIMO\nchannel (40) with perfect CSI at the receiver, whereas the last term of the right-hand side of (37) corresponds to\nthe MSE of the minimum mean-squared error (MMSE) estimate of bt,k,m for the same SIMO channel.\nVI. N UMERICAL R ESULTS\nThe spectral efficiency of the joint CE-MUDD is compared to the spectral efficiencies of the one-shot CE-MUDD,\nthe optimum separated receiver, and the LMMSE receiver, on the basis of Propositions 2\u20135. See Table I for the\ndifferences between the four receivers. The performance gap between the joint CE-MUDD and the one-shot CEMUDD corresponds to the gains obtained by using the decoded data symbols to refine the channel estimates. The\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n25\n\n1\n\nSymbol Error Probability\n\n\u03b2=2.0\n\n0.1\n\u03b2=1.0\n\u03b2=0.5\n\n0.01\n\nK=8\nK=16\n\n0.001\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nP/N0 (dB)\n\nFig. 6.\n\nSymbol error probability of b1,t,1 versus P/N0 for the LMMSE receiver. From top to bottom, {+} denote the symbol error\n\nprobabilities of the LMMSE receiver for (K, L) = (8, 4), (8, 8), (8, 16). {\u0003} represent the symbol error probabilities of the LMMSE receiver\nfor (K, L) = (16, 8), (16, 16), (16, 32) from top to bottom. The solid lines represent the symbol error probabilities of the LMMSE receiver\nin the large-system limit for \u03b2 = 2.0, 1.0, 0.5 from top to bottom. \u03c4 = 4 and M = N = 1.\n\ngap between the one-shot CE-MUDD and the optimum separated receiver is related to the gains obtained by using\nthe decoded data symbols to mitigate MAI. The performance gap between the optimum separated receiver and\nthe LMMSE receiver corresponds to the gains obtained by performing the optimal MUD, instead of the LMMSE\nMUD. The spectral efficiencies of the three receivers based on the one-shot channel estimation are well-defined for\n\u03c4 \u2265 0. For clarity, these spectral efficiencies are calculated for \u03c4 \u2265 0, while the spectral efficiency (49) of the joint\nCE-MUDD is evaluated for \u03c4 = 0, 1, . . . , Tc . In all numerical results, unbiased QPSK input symbols are used.\nWe first present Monte Carlo simulation results for finite-sized systems and compare them with the analytical\npredictions derived in the large-system limit. In the Monte Carlo simulations we assume QPSK spreading, which\nis performed by using two mutually independent binary-antipodal random spreading sequences for in-phase and\nquadrature-phase channels. We only consider the LMMSE receiver since the computational complexity of the\noptimal detector is high. Figure 6 plots the symbol error probability of b1,t,1 for M = N = 1 and \u03c4 = 4. The\nsolid lines represent the symbol error probability of the LMMSE receiver for the single-user SIMO channel (27)\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n26\n\n2\nperfect CSI bound\n1.8\n\njoint CE-MUDD\none-shot CE-MUDD\n\nSpectral Efficiency (bits/chip)\n\n1.6\n\noptimum separated\nLMMSE\n\n1.4\n1.2\n\u03b2=1.5\n1\n0.8\n\u03b2=0.5\n\n0.6\n0.4\n0.2\n0\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n\u03c4/Tc\n\nFig. 7.\n\nSpectral efficiency versus \u03c4 /Tc in the large-system limit. The pluses connected by straight lines display the spectral efficiency of\n\nthe joint CE-MUDD. The dashed lines, the solid lines, and the dotted lines represent the spectral efficiencies of the one-shot CE-MUDD, the\noptimum separated receiver, and the LMMSE receiver, respectively. The fine dotted straight lines shows an upper bound of the constrained\ncapacity (5) based on the optimal receiver with perfect CSI. P/N0 = 6 dB, M = N = 1, and Tc = 20.\n\nin which \u03c3t2\u2032 for t\u2032 \u2208 T\u03c4 is given by the solution to the fixed-point equation (38) and in which \u03c3t2 is given as the\nsolution to the fixed-point equation (54). We find that the analytical predictions are in agreement with the Monte\nCarlo simulation results for K = 16, while they are slightly different from the simulation results for K = 8.\nThis result has two consequences: One is that the asymptotic results for the LMMSE receiver are applicable to a\nnon-Gaussian distribution of sl,t,k,m , as noted in [34]. The other is that the convergence of spectral efficiency to\nits asymptotic value is so fast that our analytical results, especially for the LMMSE receiver, provide reasonably\ngood approximations of the true spectral efficiencies even for small-sized systems. The latter observation has also\nbeen made in [42], [60].\nWe next focus on the asymptotic spectral efficiencies for single-antenna systems. Figure 7 displays the spectral\n(per)\n\nefficiencies of the four receivers for P/N0 = 6 dB. An upper bound (1\u2212\u03c4 /Tc )Copt\n(per)\n\nis also shown, which is based on the asymptotic spectral efficiency Copt\n\nof the constrained capacity (5)\n\nof the optimal receiver with perfect CSI\n\n[11]. We find that the spectral efficiencies of the one-shot CE-MUDD and the two separated receivers are maximized\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n27\n\n5.5\nperfect CSI bound\n\n5\n\njoint CE-MUDD\none-shot CE-MUDD\n\n4.5\n\noptimum separated\nSpectral Efficiency (bits/chip)\n\n4\n\nLMMSE\n\n3.5\n3\n2.5\n2\n1.5\n1\n0.5\n0\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n\u03c4/Tc\n\nFig. 8.\n\nSpectral efficiency versus \u03c4 /Tc in the large-system limit. The pluses connected by straight lines display the spectral efficiency of\n\nthe joint CE-MUDD. The dashed lines, the solid lines, and the dotted lines represent the spectral efficiencies of the one-shot CE-MUDD, the\noptimum separated receiver, and the LMMSE receiver, respectively. The fine dotted straight lines shows an upper bound of the constrained\ncapacity (5) based on the optimal receiver with perfect CSI. The widely-spaced dotted lines denotes solutions for the optimum separated receivers\nwhich are not selected by the criterion (39). \u03b2 = 2.75, P/N0 = 15 dB, M = N = 1, and Tc = 20.\n\nat optimal \u03c4 = \u03c4opt . This observation results from two effects: the improvement of the accuracy of the channel\nestimation and the decrease of the number of transmitted data symbols, both caused by the increase of \u03c4 . The\nspectral efficiency (49) of the joint CE-MUDD is maximized at \u03c4 = 0 and \u03c4 = 1. These results imply that the\ntraining overhead can be significantly reduced by using joint CE-MUDD.\nThe performance gaps between the one-shot CE-MUDD and the two separated receivers are negligibly small for\n\u03b2 = 0.5, while there is a noticeable gap between the spectral efficiencies of the joint CE-MUDD and the one-shot\nCE-MUDD. We found by numerical evaluation that P/N0 \u2248 8.2 dB is required for \u03b2 = 0.5 in order for the\none-shot CE-MUDD to achieve the same spectral efficiency as that of the joint CE-MUDD for P/N0 = 6 dB.\nIn other words, the joint CE-MUDD provides a performance gain of 2.2 dB. For \u03b2 = 1.5, the performance gaps\nbetween the optimal one-shot CE-MUDD, the optimum separated receiver, and the LMMSE receiver are large.\nThis result implies that performance gains can be obtained by using an MUDD scheme with higher performance\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n28\n\nthan the LMMSE receiver. Furthermore, there is a large performance gap between the joint CE-MUDD and the\none-shot CE-MUDD. More precisely, we found that P/N0 \u2248 8.5 dB is needed for \u03b2 = 1.5 in order for the oneshot CE-MUDD to achieve the same spectral efficiency as that of the joint CE-MUDD for P/N0 = 6 dB. These\nobservations indicate that joint CE-MUDD can provide significant performance gains regardless of \u03b2, compared to\none-shot CE-MUDD.\nFigure 8 shows the spectral efficiencies of the four receivers for P/N0 = 15 dB and \u03b2 = 2.75. The upper bound\n(per)\n\n(1 \u2212 \u03c4 /Tc )Copt\n\nis also shown. One interesting observation is that the spectral efficiency of the optimum separated\n\nreceiver is discontinuous. This result predicts that the spectral efficiency of the optimum separated receiver exhibits\na waterfall behavior: The spectral efficiency rapidly degrades in the neighborhood of the discontinuous point \u03c4 = \u03c4c ,\nshown by the arrow, which corresponds to the threshold between interference-limited and non-limited regions. The\nsystem is not interference-limited for \u03c4 > \u03c4c , i.e., the asymptotic multiuser efficiency N0 /\u03c3c2 is close to one. On\nthe other hand, the system is interference-limited for \u03c4 < \u03c4c , i.e., the asymptotic multiuser efficiency is small.\nThe spectral efficiency of the one-shot CE-MUDD seems to be continuous. This observation is explained as\nfollows: Users decoded in the initial substages of successive decoding are interference-limited, while the remaining\nusers are not interference-limited. Therefore, the achievable rate of each user changes discontinuously for the oneshot CE-MUDD. However, the achievable sum rate of the one-shot CE-MUDD changes continuously since the\nthreshold \u03bac between the two groups of interference-limited users and non-limited users should move continuously\nwith the change of \u03c4 . We remark that it might be possible to cancel out MAI successfully by optimizing the power\nallocation and the rate of each user, as discussed in [26].\nFinally, we investigate multiple-antenna systems. Figure 9 shows the spectral efficiencies of the four receivers\n(per)\n\nfor M = N = 8. The upper bound (1 \u2212 \u03c4 /Tc )Copt\n\nis also shown. We find that the optimal number \u03c4opt of\n\npilot symbols is larger than that for M = N = 1 (Compare Figs. 7 and 9), since the number of unknown channel\ncoefficients increases. On the other hand, the spectral efficiency of the joint CE-MUDD is maximized at \u03c4 = 0 and\n\u03c4 = 1 even for M = N = 8. Consequently, the performance gap between the joint CE-MUDD and the one-shot\nCE-MUDD becomes larger than that for single-antenna systems. When \u03b2 = 0.5, the performance gap between the\njoint CE-MUDD and the one-shot CE-MUDD is approximately 1.47 bits/chip for M = N = 8 (0.18 bits/chip per\nthe number of antennas), while the performance gap is approximately 0.10 bits/chip for M = N = 1. We found\nby numerical evaluation that a performance gain of 1.47 bits/chip corresponds to that of approximately 3.4 dB. For\n\u03b2 = 1.5, the performance gain increases up to approximately 2.88 bits/chip for M = N = 8 (0.36 bits/chip per the\nnumber of antennas), while it is 0.35 bits/chip for M = N = 1. Interestingly, a performance gain of 2.88 bits/chip\ncorresponds to a gain of 7.2 dB. These results imply that joint CE-MUDD can provide a significant performance\ngain for multiple-antenna systems.\nFigure 10 shows the optimal training overhead \u03c4opt /Tc for M = N , maximizing the spectral efficiencies of the\none-shot CE-MUDD and the two separated receivers. Note that the optimal training overhead for the joint CEMUDD corresponds to 1/Tc = 0.05. We find that the optimal training overheads increase logarithmically with the\nincrease of the number of antennas for small M , while they tend towards around 0.5 for large M . This observation\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n29\n\n7\nperfect CSI bound\njoint CE-MUDD\n6\n\none-shot CE-MUDD\noptimum separated\nLMMSE\n\nSpectral Efficiency (bits/chip)\n\n5\n\n4\n\u03b2=1.5\n3\n\n2\n\n\u03b2=0.5\n\n1\n\n0\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n\u03c4/Tc\n\nFig. 9.\n\nSpectral efficiency versus \u03c4 /Tc in the large-system limit. The pluses connected by straight lines display the spectral efficiency of\n\nthe joint CE-MUDD. The dashed lines, the solid lines, and the dotted lines represent the spectral efficiencies of the one-shot CE-MUDD, the\noptimum separated receiver, and the LMMSE receiver, respectively. The fine dotted straight lines shows an upper bound of the constrained\ncapacity (5) based on the optimal receiver with perfect CSI. P/N0 = 6 dB, M = N = 8, and Tc = 20.\n\nimplies that the performance gains obtained by using joint CE-MUDD increase as the number of antennas grows.\nVII. C ONCLUSIONS\nWe have analyzed the asymptotic performance of joint CE-MUDD for randomly-spread MIMO DS-CDMA\nsystems with no CSI. The main contribution of this paper from a theoretical point of view is to derive a lower\nbound for the spectral efficiency of the optimal joint CE-MUDD on the basis of successive decoding with suboptimal\nLMMSE channel estimation, along with the spectral efficiencies of the one-shot CE-MUDD and the optimum\nseparated receiver. The asymptotic performance of MIMO DS-CDMA systems with no CSI is characterized via\nthe performance of a bank of single-user SIMO channels with no CSI. This decoupling result is an extension of\nprevious studies [11], [20] for the case of perfect CSI at the receiver to the no-CSI case.\nThe main contribution of this paper from a practical point of view is to demonstrate that joint CE-MUDD can\nsignificantly reduce the training overhead due to transmission of pilot signals, compared to receivers based on\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n30\n\n0.55\n\n0.5\n\n0.45\n\u03b2=1.5\n\n\u03c4opt/Tc\n\n0.4\n\n0.35\n\n0.3\n\u03b2=0.5\n0.25\n\n0.2\none-shot CE-MUDD\noptimum separated\n\n0.15\n\nLMMSE\n0.1\n1\n\nFig. 10.\n\n10\nM(=N)\n\n100\n\n\u03c4opt /Tc versus M (= N ) in the large-system limit. The dashed lines, the solid lines, and the dotted lines represent the optimal\n\ntraining overhead of the one-shot CE-MUDD, the optimum separated receiver, and the LMMSE receiver, respectively. P/N0 = 6 dB and\nTc = 20.\n\none-shot channel estimation. The results imply that joint CE-MUDD can provide significant performance gains for\nsystems which require large training overhead for attaining accurate CSI. We conclude that the iterative refinement\nof channel estimates by utilizing soft feedback from per-user decoders may lead to substantial reduction of the rate\nloss due to transmission of pilot signals for MIMO DS-CDMA systems.\nA PPENDIX A\nD ERIVATIONS\n\nOF\n\nLMMSE E STIMATORS\n\nA. Perfect-CSI Case\nWe shall present two derivations of the LMMSE estimator for vector channels with perfect CSI. One is based\non the minimization of the MSE, and the other on Bayesian inference. Let us consider the N \u00d7 K vector channel\nwith perfect CSI\ny = Hx + n \u2208 CN .\n\nOctober 26, 2018\n\n(55)\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n31\n\nIn (55), x \u2208 CK denotes a zero-mean transmitted vector with covariance matrix E[xxH ] = P I K . The noise vector\n\nn \u2208 CN is a zero-mean random vector with covariance matrix \u03a3. Furthermore, H \u2208 CN \u00d7K denotes a random\nchannel matrix with mean H\u0304 \u2208 CN \u00d7K . The three random variables H, x, and n are independent of each other.\n\nThe goal is to find the LMMSE estimator, i.e., a linear estimator x\u0302 = F H\nper y of the transmitted vector that\n\n2\nminimizes the MSE E[kx \u2212 x\u0302k2 |H]. Substituting x\u0302 = F H\nper y into the MSE E[kx \u2212 x\u0302k |H] yields\n\u0011\n\u0010\nH\n2\nE[kx \u2212 x\u0302k2 |H] = P kI K \u2212 F H\nHk\n+\nTr\nF\n\u03a3F\nper .\nper\nper\n\n(56)\n\nIt is well known that F per to minimize the MSE (56) is given by\n\nF per = \u03a3\u22121 H(P \u22121 I K + H H \u03a3\u22121 H)\u22121 .\n\n(57)\n\nIn the derivation of (57), we have minimized the MSE (56) among all possible linear estimators x\u0302 = F H\nper y.\nThe MSE (56) for the LMMSE estimator is larger than the MMSE in general, which is the minimum of the MSE\nfor all possible estimators. However, it is known that the two MSEs coincides with each other when the transmitted\nvector x and the noise vector n are CSCG. This observation implies that the LMMSE estimator can be derived\nas the posterior mean estimator for a Gaussian vector channel. Let us define the vector channel postulated by the\nreceiver as\n\u1ef9 per = H x\u0303per + \u00f1per ,\n\n(58)\n\nwith x\u0303per \u223c CN (0, P I K ) and \u00f1per \u223c CN (0, \u03a3). It is straightforward to confirm that the posterior mean estimator\nE[x\u0303per |\u1ef9 per = y, H] for the postulated vector channel is equal to the LMMSE estimator.\nB. No-CSI Case\nWe consider the no-CSI case: The channel matrix H is assumed to be unknown to the receiver, while the\nstatistical properties of x, H, and n are known. The LMMSE estimator is defined as the linear estimator x\u0302 = F H y\nto minimize the MSE E[kx \u2212 x\u0302k2 ] averaged over the channel matrix H. Substituting x\u0302 = F H y into this MSE\ngives\n\u0011 o\n\u0010\nn\nE[kx \u2212 x\u0302k2 ] = P kI K \u2212 F H H\u0304k2 + Tr F H P E[\u2206H\u2206H H ] + \u03a3 F ,\n\n(59)\n\nwith \u2206H = H \u2212 H\u0304. Comparing this expression with (56), we find that the optimal filter F is given by\nH\n\n\u22121\n\u22121\nH\u0304(P \u22121 I K + H\u0304 \u03a3\u22121\n,\nF = \u03a3ef\nef H\u0304)\n\n(60)\n\nwith \u03a3ef = P E[\u2206H\u2206H H ] + \u03a3.\nIn order to interpret the meaning of the effective covariance matrix \u03a3ef , we re-write the vector channel (55) as\ny = H\u0304x + \u2206Hx + n.\n\n(61)\n\nThe effective covariance matrix \u03a3ef is equal to the covariance matrix of the channel estimator error plus the noise\nvector, i.e., \u2206Hx + n. This observation implies that the LMMSE estimator is equal to the posterior mean estimator\nE[x\u0303|\u1ef9 = y] for the postulated vector channel,\n\u1ef9 = H\u0304 x\u0303 + w\u0303 + \u00f1,\nOctober 26, 2018\n\n(62)\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n32\n\nwhere x\u0303 \u2208 CK , w\u0303 \u2208 CN , and \u00f1 \u2208 CN are independent CSCG random vectors with covariance matrices P I K ,\n\nP E[\u2206H\u2206H H ], and \u03a3, respectively. If H\u0304 = O, the LMMSE estimator is obviously independent of the received\nvector y.\nA PPENDIX B\nP ROOF\n\nOF\n\nL EMMA 1\n\nIn order to prove Lemma 1 we need the following lemma, which is derived by extending the replica analysis in\n[11].\nLemma 2. Suppose that {Ak } are mutually disjoint subsets of {2, 3, . . . , n} for k \u2208 K. Then,\n\uf8ee\n\uf8f9\n#\n\"\nM\nY Y\nY Y\nY\n{a}\n{1}\n{a}\np(Hk |IT\u03c4 ) =\nEI T\u03c4 ,k,m \uf8f0\nlim EIT\u03c4 p(HK |IT\u03c4 )\np(hk,m = hk,m |I T\u03c4 ,k,m )\uf8fb ,\nK,L\u2192\u221e\n\nk\u2208K m=1\n\nk\u2208K a\u2208Ak\n\na\u2208{1}\u222aAk\n\n(63)\n\nwith\n\n{a}\nHK\n\n=\n\n{a}\n{Hk\n\n: k \u2208 K} denoting the ath replicas of the channel vectors for the users in K. In evaluating the\n\n2\nright-hand side of (63), \u03c3t2 = \u03c3tr\n(\u03c4 ) for t \u2208 T\u03c4 is given by the solution to the fixed-point equation (38).\n\nDerivation of Lemma 2: See Appendix C.\nLemma 2 implies that the information about {hk,m } obtained by utilizing the information IT\u03c4 is mutually\nindependent in the large-system limit for all k \u2208 K and m, and that the information about each hk,m looks like that\nprovided by the LMMSE channel estimator for the single-user SIMO channel (27). A result equivalent to Lemma 2\nwas proved in [34] for M = N = 1, by using random matrix theory. Lemma 2 is used to evaluate the joint moment\nsequence of {Xk : k \u2208 K}, defined by (42), in the following proof of Lemma 1.\nProof of Lemma 1: It is sufficient to prove that the joint moment sequence of {Xk : k \u2208 K} converges to\nthat for the distribution defined by the right-hand side of (43) in the large-system limit, since we have assumed the\nexistence of the joint moment generating function.\nFor non-negative integers {\u00f1k }, a joint moment of {Xk : k \u2208 K} is given by\n\uf8ee\n\uf8f9\n\"\n#\n\u00f1k Z\no\nn\nY \u00f1\nY\nY\n(i)\nY\nA\n\uf8ef\n{a} \uf8fa\n{a}\n{1}\nE\nXk k = E \uf8f0\np(Hk |IT\u03c4 )dHk\nfk (Hk , Hk k ; \u0398)\n\uf8fb,\nk\u2208K i=1\n\nk\u2208K\n\n(64)\n\n(i)\na\u2208Ak\n\n(i)\n\n(i)\n\nwhere {Ak : for all k \u2208 K, i} are mutually disjoint subsets of {2, 3, . . . , n} satisfying |Ak | = |Ak |. The right(i)\nQ\nQ\u00f1k\nA\n{1}\nhand side of (64) is defined as the integration of k\u2208K i=1\nfk (Hk , Hk k ; \u0398) with respect to the measure\n\uf8ee\n\uf8f9\nY\nY\nY Y\n{a}\n{1}\n{a}\n{1}\np(Hk |IT\u03c4 )\uf8fb dHK\nEIT\u03c4 \uf8f0p(HK |IT\u03c4 )\ndHk ,\n(65)\nk\u2208K a\u2208\u00c3k\n\nk\u2208K a\u2208\u00c3k\n\n(i)\n\nk\nwith \u00c3k = \u222a\u00f1i=1\nAk . Applying Lemma 2 to (65), we obtain\n\uf8f9\n\uf8ee\n\"\n#\nZ\n\u00f1\nM\nk\no\nn\n(i)\nY \u00f1\nY \uf8efY\nY Y\nA\n{a} \uf8fa\n{a}\n{1}\nlim E\np(hk,m = hk,m |I T\u03c4 ,k,m )dhk,m \uf8fb , (66)\nXk k =\nE\uf8f0\nfk (Hk , Hk k ; \u0398)\n\nK,L\u2192\u221e\n\nOctober 26, 2018\n\nk\u2208K\n\nk\u2208K\n\ni=1\n\nm=1 a\u2208A(i)\nk\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n33\n\nQ\n\nin the large-system limit, which is equal to the corresponding joint moment\n\nk\u2208K\n\ndefined as the right-hand side of (43).\n\nE[X \u00f1k k ] for the distribution\n\nA PPENDIX C\nD ERIVATION\n\nL EMMA 2\n\nOF\n\nA. Replica Method\nWe present a brief introduction of the replica method. For details of the replica method, see [37]\u2013[39]. Let\nf (X, Y ; N ) > 0 denote a deterministic function of two random variables X and Y with a parameter N . Our goal\nis to evaluate the expectation EY [Z(Y ; N )\u22121 ] for the so-called partition function Z(Y ; N ) = EX [f (X, Y ; N )] in\nthe limit N \u2192 \u221e. For that purpose, we first evaluate limN \u2192\u221e EY [Z(Y ; N )\u00f1\u22121 ] for any natural number \u00f1 \u2208 N,\nby utilizing the following expression\n\u00f1\u22121\n\n\u0002\n\nEY Z(Y ; N )\n\n\u0003\n\n\"\u00f1\u22121\nY\n\n=E\n\n#\n\nf (Xa , Y ; N ) ,\n\na=1\n\n(67)\n\nwhere {Xa : a = 1, . . . , \u00f1 \u2212 1} are i.i.d. replicated random variables following p(X). Suppose that the analytical\nexpression obtained via (67) is well-defined even for \u00f1 \u2208 R. We take \u00f1 \u2192 +0 to obtain an analytical expression of\n\nlimN \u2192\u221e EY [Z(Y ; N )\u22121 ], assuming that the obtained expression coincides with the correct one. It is a challenging\nproblem to prove whether this assumption holds.\nB. Formulation\nIn order to show Lemma 2 by using the replica method, we transform the left-hand side of (63) into a formula\n{a}\n\ncorresponding to EY [Z(Y ; N )\u00f1\u22121 ]. The posterior pdf of the replicated channel vectors HK\ndefined in the same manner as in (11), is given by\nR Q\u03c4\n{a}\n\np(HK |IT\u03c4 ) =\n\n{a}\n\nwith H{a} = {Hk\n\n{a}\n\nfor the users in K,\n\n{a}\n\np(Yt |H{a} , St , Ut )p(H{a} )dH\\K\nR Q\u03c4\n,\nt=1 p(Yt |H, St , Ut )p(H)dH\n\nt=1\n\n{a}\n\n: for all k} and H\\K = {Hk\n\n(68)\n\n: for all k \u2208\n/ K}. In (68), the pdf p(Yt |H{a} , St , Ut ) is an\n\nA\nabbreviation of p(Yt |H = H{a} , St , Ut ). Let HK\n= {HkAk : k \u2208 K} denote the replicas of the channel vectors\n{a}\n\nfor A = \u222ak\u2208K Ak , with HkAk = {Hk\n\n: a \u2208 Ak }. Applying (68) to the left-hand side of (63) and subsequently\n\nintroducing a real number \u00f1 \u2208 R, we obtain\n#\n\"\nY Y\n{a}\n{1}\np(Hk |IT\u03c4 ) =\nlim EIT\u03c4 p(HK |IT\u03c4 )\nK,L\u2192\u221e\n\nk\u2208K a\u2208Ak\n\nlim\n\n{1}\n\nA\n),\nlim \u039e\u00f1 (HK , HK\n\nK,L\u2192\u221e \u00f1\u2192+0\n\n(69)\n\n{1}\n\nA\n) is given by\nwhere \u039e\u00f1 (HK , HK\n\n\uf8ee (\n)\u00f1\u22121\u2212|A|\nZ Z Y\n\u03c4\n{1}\nA\n\u039e\u00f1 (HK , HK ) = E \uf8f0\np(Yt |H, St , Ut )p(H)dH\nt=1\n\n\u00d7\n\nOctober 26, 2018\n\nY\n\na\u2208{0,1}\u222aA\n\n(\n\n\u03c4\nY\n\nt=1\n\n)\n\np(Yt |H{a} , St , Ut )p(H{a} )\n\n\u03c4\nY\n\nt=1\n\n{1}\nA\ndYt dH{0} dH\\K d\\HK\n\n\uf8f9\n\n{1}\nA\uf8fb\nHK , HK\n.\n\n(70)\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n34\n\nA\nIn (70), we have written H as H{0} . Furthermore, the set \\HK\ndenotes all replicas of the channel vectors for a \u2265 2\nQ\n\u03c4\nA\nexcept for HK . The expression (70) implies that t=1 p(Yt |H, St , Ut ) corresponds to the function f (X, Y ; N ) with\n\nX = H.\n\nC. Average over Quenched Randomness\nWe evaluate (70) up to O(1) in the large-system limit for any natural number \u00f1, satisfying A \u2282 {1, 2, . . . , \u00f1}.\nWe first calculate the expectations in (70) with respect to {Yt } and {St }. For \u00f1 \u2208 N, we have a special expression\nof (70)\n{1}\nA\n\u039e\u00f1 (HK , HK\n)\n\n=E\n\n\"Z\n\n\u00f1\nY\n\na=0\n\n(\n\n\u03c4\nY\n\nt=1\n\n)\n\np(Yt |H{a} , St , Ut )p(H{a} )\n\n\u03c4\nY\n\nt=1\n\n{1}\nA\ndYt dH{0} dH\\K d\\HK\n\n{1}\nA\nHK , HK\n\n#\n\n.\n\n(71)\n\nLet us re-write the MIMO DS-CDMA channel (2) in the training phase as\nK\n\u03c4\nM\n1 X X X (t)\nyl = \u221a\n(e\u03c4 \u2297 hk,m )sl,t,k,m xt,k,m + nl ,\nL k=1 t=1 m=1\n\n(72)\n\nwith y l = (y Tl,1 , . . . , y Tl,\u03c4 )T \u2208 CN \u03c4 and nl = (nTl,1 , . . . , nTl,\u03c4 )T \u2208 CN \u03c4 . By evaluating the expectation in (71) with\nrespect to {St }, from the independency of {sl,t,k,m } for all l, (71) yields\n\uf8f9\n\uf8ee( \"\n\u001b#)L\nZ Y\n\u00f1 \u001a\n\u221a {a} 2\n1\n1\n{1}\n{1}\n{1}\nA\uf8fb\nA\nA\ne\u2212 N0 ky1 \u2212 \u03b2v k dy 1\nHK , HK\n,\n\u039e\u00f1 (HK , HK\n) = p(HK )p(HK\n)E \uf8f0 E\nN\u03c4\n(\u03c0N\n)\n0\na=0\n\n(73)\n\nwhere the inner expectation is taken over {s1,t,k,m : for all t, k, m}. In (73), v {a} \u2208 CN \u03c4 is defined as\n\n{a}\n\nK\n\u03c4\nM\n1 XX X\n{a}\ns1,t,k,m \u03c9t,k,m ,\nv {a} = \u221a\nK k=1 t=1 m=1\n\nwhere \u03c9 t,k,m \u2208 CN \u03c4 is given by\n\n{a}\n\n{a}\n\n\u03c9t,k,m = (e(t)\n\u03c4 \u2297 hk,m )xt,k,m ,\n\n(74)\n\n(75)\n\n{0}\n\nwith hk,m = hk,m . Let us define v \u2208 C(\u00f1+1)N \u03c4 as v = ((v {0} )T , . . . , (v {\u00f1} )T )T . We perform the Gaussian\nintegration in (73) with respect to y 1 to obtain\n\nwith\n\n\uf8ee\uf8f1\n\uf8f9\ni \uf8fcL\nh\nH\n\uf8f2 E e\u2212v A\u03c4 (\u00f1)v\n\uf8fd\n\uf8ef\n{1}\n{1}\n{1}\nA\nA\nA\uf8fa\n\u039e\u00f1 (HK , HK\n) = p(HK )p(HK\n)E \uf8f0\nHK , HK\n\uf8fb,\n\uf8f3 (\u03c0N0 )\u00f1N \u03c4 (1 + \u00f1)N \u03c4 \uf8fe\n\uf8eb\n\u00f1\n\u03b2\n\uf8ed\nA\u03c4 (\u00f1) =\nN0 + \u00f1N0 \u22121\u00f1\n\n\u22121T\u00f1\n\n(1 + \u00f1)I \u00f1 \u2212 1\u00f1 1T\u00f1\n\n\uf8f6\n\n\uf8f8 \u2297 IN\u03c4 .\n\n(76)\n\n(77)\n\nThe CSCG assumption of {sl,t,k,m } implies that v in (76) conditioned on {H{a} : for all a} and X is a CSCG\nrandom vector with the covariance matrix\nQ=\n\nK\n\u03c4\nM\n1 XX X\n\u03c9k,t,m \u03c9 H\nk,t,m ,\nK\nt=1 m=1\n\n(78)\n\nk=1\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n{0}\n\n35\n\n{\u00f1}\n\nwith \u03c9k,t,m = ((\u03c9 k,t,m )T , . . . , (\u03c9 k,t,m )T )T . Let us assume that Q is non-singular. Then, (76) yields\ni\nh\n{1}\n{1}\n{1}\nA\nA\nA\n,\n\u039e\u00f1 (HK , HK\n) = p(HK )p(HK\n)E eLG\u03c4 (Q;\u00f1) HK , HK\n\n(79)\n\nwith\n\nG\u03c4 (Q; \u00f1) = \u2212 ln det(I + A\u03c4 (\u00f1)Q) \u2212 \u00f1N \u03c4 ln(\u03c0N0 ) \u2212 N \u03c4 ln (1 + \u00f1) .\n\n(80)\n\nNote that (79) holds for any K and L. Without the assumption of sl,t,k,m \u223c CN (0, 1), it would be necessary to\n\nevaluate ln E[exp(\u2212v H A\u03c4 (\u00f1)v)] up to O(K \u22121 ) in the large-system limit by using the Edgeworth expansion, since\n(63) is a quantity of O(1). The vector v conditioned on {H{a} : for all a} and X converges in law to a CSCG random\nvector with the covariance matrix (78) in the large-system limit if one assumes that {Re[sl,t,k,m ], Im[sl,t,k,m ]}\nare i.i.d. zero-mean random variables with variance 1/2 and finite moments for all l, t, k, and m. Therefore, the\nexpansion coefficient for O(1) should coincide with (80). Furthermore, it was shown that the expansion coefficient\nfor O(K \u22121 ) does not affect the result in the large-system limit for conventional DS-CDMA channels [61]. Therefore,\nit is expected that the results in this paper holds for a general distribution of sl,t,k,m .\nD. Average over Replicated Randomness\nThe conditional expectation in (79) is given as the integration of exp[LG\u03c4 (Q; \u00f1)] with respect to the measure\n\u03bcK (Q; \u00f1)dQ on the space M+\n(\u00f1+1)N \u03c4 of all (\u00f1 + 1)N \u03c4 \u00d7 (\u00f1 + 1)N \u03c4 positive definite Hermitian matrices:\nZ\n{1}\n{1}\nA\nA\neLG\u03c4 (Q;\u00f1) \u03bcK (Q; \u00f1)dQ,\n(81)\n\u039e\u00f1 (HK , HK\n) = p(HK )p(HK\n)\nM+\n(\u00f1+1)N \u03c4\n{1}\n\nwhere \u03bcK (Q; \u00f1) denotes the pdf of Q conditioned on HK\n\nA\nand HK\n, induced from (78). We shall calculate\n\n\u03bcK (Q; \u00f1) up to O(1) since our goal is to evaluate (70) up to O(1) in the large-system limit.\nWe first evaluate the the moment generating function of (78), defined as\ni\nh\n{1}\nA\n,\nMK (Q\u0303; \u00f1) = E eKTr(QQ\u0303) HK , HK\n\n(82)\n\nwhere an (\u00f1 + 1)N \u03c4 \u00d7 (\u00f1 + 1)N \u03c4 non-singular Hermitian matrix Q\u0303 is given by\n\uf8eb\n\uf8f6\n1\n1\nQ\u03030,0\n***\n2 Q\u03030,1\n2 Q\u03030,\u00f1\n\uf8ec\n\uf8f7\n..\n..\n..\n\uf8ec1 H\n\uf8f7\n.\n.\n\uf8ec 2 Q\u03030,1\n\uf8f7\n.\n\uf8f7,\nQ\u0303 = \uf8ec\n\uf8ec .\n\uf8f7\n..\n..\n1\n\uf8ec ..\n\uf8f7\n.\n.\nQ\u0303\n\uf8ed\n2 \u00f1\u22121,\u00f1 \uf8f8\n1 H\n2 Q\u03030,\u00f1\n\n***\n\n1 H\n2 Q\u0303\u00f1\u22121,\u00f1\n\n(83)\n\nQ\u0303\u00f1,\u00f1\n\nwith N \u03c4 \u00d7 N \u03c4 complex matrices {Q\u0303a,b : 0 \u2264 a < b \u2264 \u00f1}, in which the (j, k)-element of Q\u0303a,b is given as\n\nj,k\nq\u0303a,b\n\u2208 C, and with N \u03c4 \u00d7 N \u03c4 Hermitian matrices\n\uf8eb\n1 1,2\n1,1\nq\u0303a,a\n2 q\u0303a,a\n\uf8ec\n..\n\uf8ec 1 1,2 \u2217\n.\n\uf8ec 2 (q\u0303a,a )\nQ\u0303a,a = \uf8ec\n\uf8ec\n..\n..\n\uf8ec\n.\n.\n\uf8ed\n1 1,N \u03c4 \u2217\n***\n2 (q\u0303a,a )\nOctober 26, 2018\n\n***\n..\n.\n..\n.\n1 N \u03c4 \u22121,N \u03c4 \u2217\n)\n2 (q\u0303a,a\n\n1 1,N \u03c4\n2 q\u0303a,a\n\n..\n.\n\n\uf8f6\n\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n1 N \u03c4 \u22121,N \u03c4 \uf8f7\n\uf8f8\n2 q\u0303a,a\nN \u03c4,N \u03c4\nq\u0303a,a\n\nfor all a.\n\n(84)\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n{a}\n\nSince {Xk = {xt,k,m : for all t, m}} and {Hk\n\n36\n\n: a = 0, . . . , \u00f1} are mutually independent for all k, substituting\n\n(78) into (82) implies that (82) is decomposed into the product of K terms:\ni\nY\nY h\nE e\u039bk (Q\u0303;\u00f1) ,\nMK (Q\u0303; \u00f1) =\nMk (Q\u0303; \u00f1)\nk\u2208K\n\n(85)\n\nk\u2208K\n/\n\nwith\nh\ni\n{1}\nMk (Q\u0303; \u00f1) = E e\u039bk (Q\u0303;\u00f1) Hk , HkAk .\n\n(86)\n\nIn these expressions, \u039bk (Q\u0303; \u00f1) is given by\n\n\u039bk (Q\u0303; \u00f1) =\n\n\u03c4 X\nM\nX\n\nTr(\u03c9 t,k,m \u03c9H\nt,k,m Q\u0303).\n\n(87)\n\nt=1 m=1\n\nIt will be shown later that the moment generating function (86) for the users in K reduces to the right-hand side\nof (63).\nWe next calculate the pdf \u03bcK (Q; \u00f1) up to O(1). The inversion formula of the moment generating function (85)\nimplies\n\u03bcK (Q; \u00f1) =\n\n\u0012\n\nK\n2\u03c0i\n\n\u0013[(\u00f1+1)N \u03c4 ]2 Z ( Y\n\n)\n\nMk (Q\u0303; \u00f1) e\u2212KIK (Q,Q\u0303;\u00f1) dQ\u0303,\n\nk\u2208K\n\n(88)\n\nj,k\nj,k\nj,j\nwhere the integrations with respect to dRe[q\u0303a,b\n], dIm[q\u0303a,b\n], and dq\u0303a,a\nare taken along imaginary axes, respectively.\n\nIn (88), IK (Q, Q\u0303; \u00f1) is defined as\nIK (Q, Q\u0303; \u00f1) = Tr(QQ\u0303) \u2212\n\ni\nh\n1 X\nln E e\u039bk (Q\u0303;\u00f1) ,\nK\n\n(89)\n\nk\u2208K\n/\n\nwhere \u039bk (Q\u0303; \u00f1) is given by (87). Note that the limit limK\u2192\u221e IK (Q, Q\u0303; \u00f1) \u2261 I(Q, Q\u0303; \u00f1) exists obviously.\nApplying the saddle-point method to (88) in the large-system limit, we obtain\n(\n)\u0012 \u0013\n[(\u00f1+1)N \u03c4 ]2 /2\nY\n\u22121/2\nK\n\u03bcK (Q; \u00f1) =\nMk (Q\u0303s ; \u00f1)\ndet \u22072Q\u0303 I(Q, Q\u0303s ; \u00f1)\ne\u2212KI(Q,Q\u0303s ;\u00f1) [1 + o(K)],\n2\u03c0\n\n(90)\n\nwhere Q\u0303s is implicitly given as the solution to the fixed-point equation\ni\uf8fc\n\uf8f1 h\nH\n\u039bk (Q\u0303;\u00f1) \uf8fd\n\u03c4 X\nM\n\uf8f2\nE\n\u03c9\n\u03c9\ne\nX\nX\nk,t,m\nk,t,m\n1\ni\nh\nQ = lim\n.\nE\nK\u2192\u221e K\n\uf8fe\n\uf8f3\n\u039b\nE e k (Q\u0303;\u00f1)\n\n(91)\n\nk\u2208K\n\nk\u2208K\n/ t=1 m=1\n\nIn (90), \u22072Q\u0303 I(Q, Q\u0303s ; \u00f1) denotes the Hesse matrix of I(Q, Q\u0303; \u00f1) with respect to Q\u0303 at the saddle point Q\u0303s . In\n\nthe derivation of (90), we have used the fact that the Hesse matrix \u22072Q\u0303 I(Q, Q\u0303s ; \u00f1) is negative definite, due to the\nassumption of the non-singularity of Q. Note that the concavity of (89) with respect to Q\u0303 at Q\u0303 = Q\u0303s is required\nfor the use of the saddle-point method, since the integration in (88) is taken over imaginary axes.\nFinally, we evaluate (81) up to O(1) in the large-system limit. Substituting (90) into (81) and subsequently using\nthe saddle-point method, we obtain\n{1}\n\n{1}\n\nA\nA\n)\n) = D\u00f1 p(HK )p(HK\n\u039e\u00f1 (HK , HK\n\nOctober 26, 2018\n\nY\n\nMk (Q\u0303s ; \u00f1)e\u2212K\u03a6(Qs ;\u00f1) [1 + o(K)],\n\n(92)\n\nk\u2208K\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n37\n\nwhere Qs is a solution to satisfy\nQs =\n\narginf\n\n\u03a6(Q; \u00f1),\n\n(93)\n\nQ\u2208M+\n(\u00f1+1)N \u03c4\n\nwith\n\u03a6(Q; \u00f1) = I(Q, Q\u0303s ; \u00f1) \u2212 \u03b2 \u22121 G\u03c4 (Q; \u00f1).\n\n(94)\n\nIn (92), D\u00f1 = [det \u22072Q \u03a6(Qs ; \u00f1)]\u22121/2 | det \u22072Q\u0303 I(Qs , Q\u0303s ; \u00f1)|\u22121/2 , with \u22072Q \u03a6(Qs ; \u00f1) denoting the Hesse matrix of\n\n\u03a6(Q; \u00f1) with respect to Q at the saddle-point Qs . We have assumed that the Hesse matrix \u22072Q \u03a6(Qs ; \u00f1) is positive\ndefinite. Calculating the solution (93) with (80) and (89), we find that Qs satisfies the stationarity condition\nQ\u0303 = \u2212\u03b2 \u22121 (I + A\u03c4 (\u00f1)Q)\u22121 A\u03c4 (\u00f1).\n\n(95)\n\nE. Evaluation of Fixed-Point Equations\nIt is generally difficult to solve the coupled fixed-point equations (91) and (95). At this point, we assume that\nthe solution (Qs , Q\u0303s ) satisfies RS. Note that it depends on models whether the RS assumption holds. Fortunately,\nIt is empirically known that the RS assumption is correct when replicated random variables are CSCG.\nAssumption 2 (Replica Symmetry). (Qs , Q\u0303s ) is invariant under all permutations of replica indices:\n\uf8eb\n\uf8f6\nQ0\n1\u00f1T \u2297 M\n\uf8f8,\nQs = \uf8ed\n1\u00f1 \u2297 M H I \u00f1 \u2297 (Q1 \u2212 Q) + 1\u00f1 1\u00f1T \u2297 Q\n\uf8eb\n\uf8f6\nQ\u03030\n1\u00f1T \u2297 M\u0303\n\uf8f8,\nQ\u0303s = \uf8ed\nH\n1\u00f1 \u2297 M\u0303\nI \u00f1 \u2297 (Q\u03031 \u2212 Q\u0303) + 1\u00f1 1\u00f1T \u2297 Q\u0303\n\n(96)\n\n(97)\n\nwith M , M\u0303 \u2208 CN \u03c4 \u00d7N \u03c4 , and with N \u03c4 \u00d7 N \u03c4 Hermitian matrices Q0 , Q\u03030 , Q1 , Q\u03031 , Q, and Q\u0303.\n\nWe first solve the fixed-point equation (95) under Assumption 2. Evaluating the right-hand side of (95) with (77)\nand subsequently comparing both sides, we obtain\nQ\u03030 = \u2212\u00f1(\u03a3 + \u00f1\u03a30 )\u22121 ,\n\nM\u0303 = (\u03a3 + \u00f1\u03a30 )\u22121 ,\n\nQ\u0303 = (\u03a3 + \u00f1\u03a30 )\u22121 \u03a30 \u03a3\u22121 ,\n\nQ\u03031 = Q\u0303 \u2212 \u03a3\u22121 ,\n\n(98)\n\nwhere \u03a30 and \u03a3 are given by\n\u03a30 = N0 I N \u03c4 + \u03b2(Q0 \u2212 M \u2212 M H + Q),\n\n(99)\n\n\u03a3 = N0 I N \u03c4 + \u03b2(Q1 \u2212 Q).\n\n(100)\n\nNote that \u03a3 and \u03a3 + \u00f1\u03a30 must be invertible since (I + A\u03c4 (\u00f1)Qs )\u22121 exists due to the assumption of the positive\ndefiniteness of Q. Nishimori [57] proved \u03a30 = \u03a3 for unfaded CDMA systems. The condition \u03a30 = \u03a3 implies\n\u22121 \u22121\nthat \u03a30 must be invertible, since \u03a3\u22121 exists. In this case we can re-write Q\u0303 as Q\u0303 = \u03a3\u22121 (\u00f1\u03a3\u22121 + \u03a3\u22121\n\u03a3 .\n0 )\n\nWe next evaluate e\u039bk (Q\u0303s ;\u00f1) , assuming that \u03a30 is invertible. Substituting (87) and (98) into e\u039bk (Q\u0303s ;\u00f1) yields\ne\u039bk (Q\u0303s ;\u00f1) =\n\n\u03c4 Y\nM\nY\n\nH\n\neat,k,m \u03a3\u03030 at,k,m \u2212\n\nP\u00f1\n\n{a}\nH \u22121 {a}\na=0 (\u03c9 t,k,m ) \u03a3a \u03c9 t,k,m\n\n,\n\n(101)\n\nt=1 m=1\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n38\n\n\u22121\nwith \u03a3\u03030 = (\u00f1\u03a3\u22121 + \u03a3\u22121\nand \u03a3a = \u03a3 for a = 1, . . . , \u00f1. In (101), at,k,m \u2208 CN \u03c4 is defined as at,k,m =\n0 )\nP\u00f1\n\u22121 {a}\nH\na=0 \u03a3a \u03c9 t,k,m . In order to linearize the quadratic form at,k,m \u03a3\u03030 at,k,m in (101), we apply the identity\nZ\n\u22121\nH\n1\n~\ny\ny\n\u03a3\u0303 ~\n+aH\n+~\nyH\na\n\u2212~\nyH\neat,k,m \u03a3\u03030 at,k,m =\n(102)\ne t,k,m 0 t,k,m t,k,m t,k,m t,k,m t,k,m d~y t,k,m ,\nN\n\u03c4\n\u03c0 det \u03a3\u03030\n\nto (101), with ~y t,k,m \u2208 CN \u03c4 . Then, we obtain\n\ne\u039bk (Q\u0303s ;\u00f1) = C\u00f1\u03c4 M\n\nZ Y\n\u00f1\n\na=0\n\nwith\n\n{a}\n\n~ ,\n~ |\u03a9 )dY\nq(Y\nk\nk\nk\n\n(103)\n\n\u0002\n\u0003\nC\u00f1 = \u03c0 \u00f1N \u03c4 det{\u03a3\u00f1\u22121 (\u03a3 + \u00f1\u03a30 )} .\n\n(104)\n\n{a}\n{a}\n~ |\u03a9{a} ), with Y\n~ = {~y\nIn (103), q(Y\n: for all t \u2208 T\u03c4 , m} and \u03a9k = {\u03c9 t,k,m : for all t \u2208 T\u03c4 , m}, is defined\nk\nk\nk\nt,k,m\n\nas\n{a}\n\n~ |\u03a9 ) =\nq(Y\nk\nk\n{a}\n\n\u03c4 Y\nM\nY\n\nt=1 m=1\n\n\u0010\n\u0011\n{a}\ng\u03c4 N ~y t,k,m \u2212 \u03c9t,k,m ; \u03a3a ,\n\n(105)\n\n{a}\n\nwhere g\u03c4 N (~y t,k,m \u2212 \u03c9 t,k,m ; \u03a3a ) is given by (1), with \u03c9 t,k,m defined as (75).\n\nWe solve the fixed-point equation (91) by substituting (103) into (91). It is sufficient to evaluate Q0 \u2212M \u2212M H +Q\n\nand Q1 \u2212 Q owing to the fact that \u03a30 and \u03a3 depend on Qs only through them. Comparing both sides of (91),\nwe have\nQ0 \u2212 M \u2212 M H\n\n\uf8ee\nZ\n\u03c4\nM\n1 XXX \uf8f0\nC\u03c4M\n{1}\no (\u03c9 {0}\nn \u00f1\n+ Q = lim\nE\nt,k,m \u2212 h\u03c9 t,k,m i)\nK\u2192\u221e K\n\u039b\n(\nQ\u0303\n;\u00f1)\nk\ns\nE e\nk\u2208K\n/ t=1 m=1\n#\nn\nio\u00f1\nh\n{0}\n{1}\n{0}\n{1}\n~ ,\n~ |\u03a9 ) Xk\n~ |\u03a9 ) E {1} q(Y\ndY\n\u00d7(\u03c9\n\u2212 h\u03c9\ni)H q(Y\nt,k,m\n\nt,k,m\n\nk\n\nk\n\nk\n\nHk\n\nk\n\nk\n\n\uf8ee\nZ\n\u03c4 X\nM\nX\nX\n1\nC\u03c4M\n{1}\no h(\u03c9 {1}\nQ1 \u2212 Q = lim\nE \uf8f0 n \u00f1\nt,k,m \u2212 h\u03c9 t,k,m i)\nK\u2192\u221e K\n\u039b\n(\nQ\u0303\n;\u00f1)\nk\ns\nE e\nk\u2208K\n/ t=1 m=1\n#\nn\nh\nio\u00f1\n{0}\n{1}\n{1}\n{1}\nH\n~\n~\n~\ndY ,\n\u00d7(\u03c9\n\u2212 h\u03c9\ni) iq(Y |\u03a9 ) E {1} q(Y |\u03a9 ) Xk\nt,k,m\n\nt,k,m\n\nk\n\nk\n\nk\n\nHk\n\nk\n\nk\n\nIn (106) and (107), E[exp{\u039bk (Q\u0303s ; \u00f1)}] is explicitly given as\n\u0014Z\n\u0015\ni\nh\nio\u00f1\nh\nn\n~ |\u03a9{0} ) E {1} q(Y\n~ |\u03a9{1} ) Xk\n~ .\nE e\u039bk (Q\u0303s ;\u00f1) = C\u00f1\u03c4 M E\nq(Y\nd\nY\nk\nk\nk\nk\nk\nH\n\n(106)\n\n(107)\n\n(108)\n\nk\n\n{1}\n\n{1}\n\n{1}\n\nFurthermore, hf (\u03c9t,k,m )i for a function f (\u03c9 t,k,m ) of (75) denotes the mean of f (\u03c9t,k,m ) with respect to the\n{1}\n\n{1}\n\n~ , Xk )dH , defined as\nposterior measure q(Hk |Y\nk\nk\n{a}\n\n{a}\n\n~ , Xk ) = R\nq(Hk |Y\nk\n\n{a}\n\n{a}\n\n~ |\u03a9 )p(H )\nq(Y\nk\nk\nk\n,\n{a}\n{a}\n{a}\n~\nq(Y |\u03a9 )p(H )dH\nk\n\nk\n\nk\n\n(109)\n\nk\n\n~ |\u03a9 ) is given by (105). Equations (99), (100), (106), and (107) form closed equations for \u03a30 and \u03a3,\nwhere q(Y\nk\nk\nand are well-defined for \u00f1 \u2208 R. Regarding \u00f1 in these equations as a real number and taking \u00f1 \u2192 +0, we obtain\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n39\n\nthe coupled fixed-point equations\n\u03c4\nM\ni\n\u03b2 X X X h {0}\n{1}\n{0}\n{1}\nE (\u03c9 t,k,m \u2212 h\u03c9 t,k,m i)(\u03c9 t,k,m \u2212 h\u03c9 t,k,m i)H ,\nK\u2192\u221e K\nt=1 m=1\n\n\u03a30 = N0 I N \u03c4 + lim\n\n(110)\n\nk\u2208K\n/\n\n\u03c4\nM\nEi\n\u03b2 X X X hD {1}\n{1}\n{1}\n{1}\nE (\u03c9 t,k,m \u2212 h\u03c9 t,k,m i)(\u03c9 t,k,m \u2212 h\u03c9 t,k,m i)H ,\nK\u2192\u221e K\nt=1 m=1\n\n\u03a3 = N0 I N \u03c4 + lim\n\n(111)\n\nk\u2208K\n/\n\n~\n~ |\u03a9{0} )p(H{0} )p(Xk )dY\nwhere the expectations in (110) and (111) are taken with respect to the measure q(Y\nk\nk\nk\nk\n{0}\n\ndHk dXk . Note that (110) and (111) are coupled since their second terms depend on both \u03a30 and \u03a3.\nLet us assume \u03a30 = \u03a3. Then, it is straightforward to show that the coupled fixed-point equations (110) and (111)\nreduce to the single fixed-point equation\n\u03c4\nM\ni\n\u03b2 X X X h {0}\n{0}\n{0}\n{0}\nE (\u03c9 t,k,m \u2212 h\u03c9 t,k,m i)(\u03c9 t,k,m \u2212 h\u03c9 t,k,m i)H .\nK\u2192\u221e K\nt=1 m=1\n\n\u03a30 = N0 I N \u03c4 + lim\n\n(112)\n\nk\u2208K\n/\n\n~ dH{0} dXk . Furthermore, h\u03c9 {0} i\n~ |\u03a9{0} )p(H{0} )p(Xk )dY\nIn (112), the expectation is taken with respect to q(Y\nk\nk\nk\nt,k,m\nk\nk\n{0}\n\n{0}\n\n({0}\n\n~ , Xk )dH\ndenotes the mean of \u03c9 t,k,m with respect to the posterior measure q(Hk |Y\nk\nk\n\n, given by (109). Substi-\n\n2\ntuting (75) into (112) after assuming \u03a30 = \u03c3tr\n(\u03c4 )I N \u03c4 , we find that (112) reduces to (38).\n\nF. Replica Continuity\nWe evaluate (80), (86), and (89) under Assumption 2. Substituting (77) and (96) into (80) and subsequently using\n(99) and (100), we obtain\nG\u03c4 (Qs ; \u00f1) = \u2212(\u00f1 \u2212 1) ln det \u03a3 \u2212 ln det(\u03a3 + \u00f1\u03a30 ) \u2212 \u00f1N \u03c4 ln \u03c0.\n\n(113)\n\nNext, from (103), the moment generating function (86) for the users in K reduces to\n\uf8ee\n\uf8f9\nZ\nn\nh\nio\n\u03c4M\nY\n\u00f1\nC\u00f1\n{a} ~\n~ \uf8fb,\n~ |\u03a9{0} )\n~ |\u03a9{1} ) Xk\nMk (Q\u0303s ; \u00f1) =\nE \uf8f0 q(Y\nq(Hk |Y\ndY\nq(Y\nk\nk\nk\nk , Xk ) EH{1}\nk\nk\n{1}\u222aAk\nk\np(Hk\n)\na\u2208{1}\u222aAk\n(114)\n{a}\n\n~ , Xk ) id given by (109). Finally, calculating the first term on the right-hand side of (89), we have\nwhere q(Hk |Y\nk\n\u0003\n\u00f1 \u0002\nI(Qs , Q\u0303s ; \u00f1)=\u2212 Tr I N \u03c4 \u2212 N0 (\u03a3 + \u00f1\u03a30 )\u22121 \u2212 N0 \u03a3\u22121 + N0 (\u03a3 + \u00f1\u03a30 )\u22121 \u03a30 \u03a3\u22121\n\u03b2\no\nn\n1 X\nln E e\u039bk (Q\u0303s ;\u00f1) ,\n\u2212 lim\nK\u2192\u221e K\n\n(115)\n\nk\u2208K\n/\n\nin the limit K \u2192 \u221e, in which E[exp{\u039bk (Q\u0303s ; \u00f1)}] is given by (108).\nEquations (113), (114), and (115) are well-defined for \u00f1 \u2208 R. Let us assume that they coincide with the true\nones for \u00f1 \u2208 [0, nc ) with some nc > 0. Then, substituting (113), (114), and (115) into (92) and taking \u00f1 \u2192 +0,\nwe arrive at\n{1}\nA\nlim \u039e\u00f1 (HK , HK\n)\n\u00f1\u2192+0\n\nOctober 26, 2018\n\n=\n\n\u0012\n\nlim D\u00f1\n\n\u00f1\u2192+0\n\n\u0013Y\n\nk\u2208K\n\nE\n\n\"\n\n{1} ~\nq(Hk |Y\nk , Xk )\n\nY\n\na\u2208Ak\n\n#\n\n{a} ~\nq(Hk |Y\nk , Xk )\n\n+ o(K),\n\n(116)\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n40\n\n{0}\n\n{0}\n\n{0}\n\n~ dH dXk . We apply\n~ |\u03a9 )p(H )p(Xk )dY\nwhere the expectation is taken with respect to the measure q(Y\nk\nk\nk\nk\nk\n(116) to (69) to obtain\n\"\nlim\n\nK,L\u2192\u221e\n\nEIT\u03c4\n\n{1}\np(HK |IT\u03c4 )\n\n{a}\n\nY Y\n\nk\u2208K a\u2208Ak\n\n#\n\n{a}\np(Hk |IT\u03c4 )\n\n=\n\nY\n\nE\n\nk\u2208K\n\n\"\n\n{1} ~\nq(Hk |Y\nk , Xk )\n\nY\n\na\u2208Ak\n\n#\n\n{a} ~\nq(Hk |Y\nk , Xk )\n\n,\n\n(117)\n\n~ , Xk ) is given by (109). It is straightforward to find that the right-hand side of (117) is equal to\nwhere q(Hk |Y\nk\nthat of (63). In the derivation of (117), we have used the fact that lim\u00f1\u2192+0 D\u00f1 should be equal to 1 due to the\nnormalization of the pdf (117). We omit the proof of lim\u00f1\u2192+0 D\u00f1 = 1 since it requires complicated calculations\nand is beyond the scope of this paper. Furthermore, the proof of the convexity of (94) at the saddle point is also\nomitted for the same reason. For details, see [18].\nA PPENDIX D\nD ERIVATION\n\nOF\n\nP ROPOSITION 1\n\nA. Formulation\nWe analyze the equivalent channel between the users in K and their decoders in symbol period t(> \u03c4 ) to derive\nProposition 1. Our analysis is based on the replica method, which is basically the same as that for Lemma 2,\npresented in Appendix C. However, there are two differences between the two replica analyses. One is that we\nreplicate not only the channel vectors but also the data symbols. The other is that the self-averaging property of\nMAI with respect to IT\u03c4 is shown by using Lemma 1.\nIt is sufficient from Assumption 1 to show that the distribution of B\u0303t,K conditioned on Bt,K , H, and IT\u03c4 converges\nin law to the right-hand side of (36) in the large-system limit. We first transform p(B\u0303t,K |Bt,K , H, IT\u03c4 ) into a formula\ncorresponding to (70). The posterior pdf of B\u0303t,K postulated by the optimal detector, defined in the same manner as\nin (14), is given by\np(B\u0303t,K |Yt , St , IT\u03c4 ) =\n\nR\n\np(\u1ef8t = Yt |B\u0303t , St , IT\u03c4 )p(B\u0303t )dB\u0303t,\\K\n,\nR\np(\u1ef8t = Yt |B\u0303t , St , IT\u03c4 )p(B\u0303t )dB\u0303t\n\n(118)\n\nwith B\u0303t,\\K = {B\u0303t,k : for all k \u2208\n/ K}. In (118), the pdf p(\u1ef8t |B\u0303t , St , IT\u03c4 ) is given by (15) with It\u22121 = I\u03c4 . The\nequivalent channel between the users in K and their decoders is represented as\n\u0014Z\n\u0015\np(B\u0303t,K |Bt,K , H, IT\u03c4 ) = ESt\np(B\u0303t,K |Yt , St , IT\u03c4 )p(Yt |H, St , Bt )p(Bt,\\K )dYt dBt,\\K ,\n\n(119)\n\nwith Bt,\\K = {Bt,k : for all k \u2208\n/ K}. In (119), the pdf p(Yt |H, St , Bt ) represents the true MIMO DS-CDMA\n\nchannel (2). Introducing a real number n, we obtain\nlim p(B\u0303t,K |Bt,K , H, IT\u03c4 ) =\n\nK,L\u2192\u221e\n\nlim\n\nlim \u039en (B\u0303t,K , Bt,K , H, IT\u03c4 ),\n\n(120)\n\nK,L\u2192\u221e n\u2192+0\n\nwith\n\u039en (B\u0303t,K , Bt,K , H, IT\u03c4 ) = ESt\n\n\"Z \u001aZ\n\np(\u1ef8t = Yt |H\u0303, St , B\u0303t )p(B\u0303t )dB\u0303t p(H\u0303|IT\u03c4 )dH\u0303\n\n\u001bn\u22121\n#\n\n\u00d7p(\u1ef8t = Yt |H\u0303, St , B\u0303t )p(H\u0303|IT\u03c4 )dH\u0303p(B\u0303t )dB\u0303t,\\K p(Yt |H, St , Bt )p(Bt,\\K )dYt dBt,\\K ,\n\n(121)\n\nwhere the posterior pdf p(H\u0303|IT\u03c4 ) is given by (13) with It\u22121 = I\u03c4 .\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n41\n\nB. Average over Quenched Randomness\n{a}\n\n{a}\n\n{a}\n\nWe evaluate (121) only for n \u2208 N in the large-system limit. Let Bt,k = {bt,k,m \u2208 C : for all m} and H\u0303k\n\n{a}\n{h\u0303k,m\n\n\u2208C\n\nN\n\n: for all m} denote replicas of B\u0303t,k and H\u0303k for a = 2, 3, . . ., respectively:\n\ndrawn from p(Bt,k ) for all k and a, and\n\n{a}\n{H\u0303k }\n\n{a}\n{Bt,k }\n\n=\n\nare independently\n\nconditioned on IT\u03c4 are mutually independent random vectors\n{0}\n\nfollowing p(H\u0303k |IT\u03c4 ), defined by (11), for all k and a. For notational convenience, we introduce Bt,k = Bt,k ,\n{1}\n\n{0}\n\nBt,k = B\u0303t,k , H\u0303k\nwith each other.\n\n{1}\n\n= Hk , and H\u0303k\n\n{a}\n{H\u0303k }\n\n{a}\n\n= H\u0303k . Note that H\u0303k\n\n{a}\n\nand Hk\n\nfor a = 1, . . . , n should not be confused\n{a}\n\nconditioned on IT\u03c4 are mutually independent for all k, while {Hk } conditioned on IT\u03c4\n\nhave dependencies for all k. Taking the averages in (121) over Yt and St in the same manner as in the derivation\nof (79), we have\ni\nh\n\u039en (B\u0303t,K , Bt,K , H, IT\u03c4 ) = p(B\u0303t,K )E eLG1 (Qt ;n) B\u0303t,K , Bt,K , H, IT\u03c4 ,\n\n(122)\n\nwhere G1 (Qt , n) is given by (80). In (122), the positive definite Hermitian matrix Qt \u2208 M+\n(n+1)N is given by\nQt =\n\nK M\n1 X X (c)\n(c)\n\u03c9t,k,m (\u03c9 t,k,m )H ,\nK\nm=1\n\n(123)\n\nk=1\n\n(c)\n\n(c),{0}\n\n(c),{n}\n\n(c),{a}\n\nwith \u03c9t,k,m = ((\u03c9 t,k,m )T , . . . , (\u03c9 t,k,m )T )T , in which \u03c9 t,k,m \u2208 CN is given by\n{a} {a}\n\n(c),{a}\n\n\u03c9t,k,m = h\u0303k,m bt,k,m .\n\n(124)\n\nC. Average over Replicated Randomness\nWe next evaluate the expectation in (122) with respect to Qt . In the same manner as in the derivation of (88),\nthe pdf of Qt conditioned on B\u0303t,K , Bt,K , H, and IT\u03c4 is evaluated as\n)\n\u0012\n\u0013[(n+1)N ]2 Z ( Y\n(c)\nK\n(c)\n(c)\n\u03bcK (Qt ; n) =\nMk (Q\u0303t ; n) e\u2212KIK (Qt ,Q\u0303t ;n) dQ\u0303t ,\n2\u03c0i\n\n(125)\n\nk\u2208K\n\n{a}\n\nwhere we have used the fact that {H\u0303k\n\n: a = 1, . . . , n} conditioned on IT\u03c4 are mutually independent for all k.\n\nIn (125), Q\u0303t denotes an (n + 1)N \u00d7 (n + 1)N non-singular Hermitian matrix, defined in the same manner as in\n(83). The integration in (125) with respect to each element of Q\u0303t is taken along an imaginary axis. The moment\n(c)\n\ngenerating function Mk (Q\u0303t ; n) for the users in K is defined as\ni\nh (c)\n(c)\nMk (Q\u0303t ; n) = E e\u039bk (Q\u0303t ;n) Bt,k , B\u0303t,k , Hk , IT\u03c4 ,\nwith\n\n(c)\n\n\u039bk (Q\u0303t ; n) =\n\nM\nX\n\n(c)\n\n(c)\n\nTr[\u03c9 t,k,m (\u03c9 t,k,m )H Q\u0303t ].\n\n(126)\n\n(127)\n\nm=1\n(c)\n\nFurthermore, the function IK (Qt , Q\u0303t ; n) is given by\n(c)\n\nIK (Qt , Q\u0303t ; n) = Tr(Qt Q\u0303t ) \u2212\n\ni\nh (c)\n1 X\nln E e\u039bk (Q\u0303t ;n) Hk , IT\u03c4 .\nK\n\n(128)\n\nk\u2208K\n/\n\nNote that the second term of the right-hand side of (128) depends on H and IT\u03c4 , whereas that of (89) is a\ndeterministic value. We use Lemma 1 to show that the second term on the right-hand side of (128) converges\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n42\n\n(c)\n\nin probability to a deterministic value in the large-system limit. We re-write E[exp{\u039bk (Q\u0303t ; n)}|Hk , IT\u03c4 ] as\nXk (Hk , IT\u03c4 ), given by\nXk (Hk , IT\u03c4 ) =\n\nZ\n\n{a}\n\nfk (Hk , {H\u0303k })\n\nwith\n\n{a}\n\n{a}\n\nwhere {H\u0303k } = {H\u0303k\n\nn n\nY\n\na=1\n\n{a}\n\n{a}\n\np(H\u0303k |IT\u03c4 )dH\u0303k\n\no\n\n,\n\n(129)\n\nh (c)\ni\n{a}\n{a}\nfk (Hk , {H\u0303k }) = E e\u039bk (Q\u0303t ;n) Hk , {H\u0303k } ,\n{a}\n\n: a = 1, . . . , n} denotes all replicas of H\u0303k\n\n(130)\n\nfor user k. Lemma 1 implies that\n\n{Xk (Hk , IT\u03c4 ) : for all k} converges in law to uncorrelated random variables X k (Hk , I T\u03c4 ,k ) in the large-system\nlimit, given by\nX k (Hk , I T\u03c4 ,k ) =\n\nZ\n\n{a}\n\nfk (Hk , {H\u0303k })\n\nn Y\nM n\nY\n\na=1 m=1\n\no\n{a}\n{a}\np(hk,m = h\u0303k,m |I T\u03c4 ,k,m )dh\u0303k,m ,\n\n(131)\n\nwith I T\u03c4 ,k = {I T\u03c4 ,k,m : for all m}. From the weak law of large numbers, we find that (128) converges in probability\nto\noi\nn (c)\n1 X h\nE ln E e\u039bk (Q\u0303t ;n) Hk , I T\u03c4 ,k ,\nK\u2192\u221e K\n\nI (c) (Qt , Q\u0303t ; n) = Tr(Qt Q\u0303t ) \u2212 lim\n\n(132)\n\nk\u2208K\n/\n\nin the large-system limit. The convergence in probability of (128) to (132) allows us to use the same method as in\nthe derivation of (92). Consequently, (122) yields\n(\n\u039en (B\u0303t,K , Bt,K , H, IT\u03c4 ) =\n\nDn(c) p(B\u0303t,K )\n\nY\n\n)\n\n(s)\n(c)\nMk (Q\u0303t ; n)\n\nk\u2208K\n\n(c)\n\ne\u2212K\u03a6\n\n(s)\n\n(s)\n\n(Qt ,Q\u0303t ;n)\n\n[1 + o(K)],\n\n(133)\n\nwith\n\u03a6(c) (Qt , Q\u0303t ; n) = I (c) (Qt , Q\u0303t ; n) \u2212 \u03b2 \u22121 G1 (Qt ; n).\n(c)\n\nIn (133), Dn\n\n(c)\n\nis given by Dn\n(s)\n\n(s)\n\n(s)\n\n(134)\n(s)\n\n(s)\n\n= [det \u22072Qt \u03a6(c) (Qt , Q\u0303t ; n)]\u22121/2 | det \u22072Q\u0303 I (c) (Qt , Q\u0303t ; n)|\u22121/2 , with the\n\n(s)\n\n(s)\n\n(s)\n\nt\n\nHesse matrices \u22072Qt \u03a6(c) (Qt , Q\u0303t ; n) and \u22072Q\u0303 I (c) (Qt , Q\u0303t ; n) of (134) and (132) with respect to Qt and Q\u0303t\n(s)\n\n(s)\n\nt\n\nat the saddle-point (Qt , Q\u0303t ) = (Qt , Q\u0303t ), respectively, which is a solution to the coupled fixed-point equations\no\uf8f9\n\uf8ee n (c)\n(c)\n(c)\nH \u039b (Q\u0303t ;n)\nM\nHk , I T\u03c4 ,k\n1 X X \uf8f0 E \u03c9 t,k,m (\u03c9 t,k,m ) e k\n\uf8fb,\nn (c)\no\nQt = lim\n(135)\nE\nK\u2192\u221e K\nE e\u039bk (Q\u0303t ;n) Hk , I T\u03c4 ,k\nk\u2208K\n/ m=1\nQ\u0303t = \u2212\u03b2 \u22121 (I + A1 (n)Qt )\u22121 A1 (n).\n\n(136)\n\nIf the coupled fixed-point equations (135) and (136) have multiple solutions, the solution to minimize (134) is\nchosen.\nRemark 5. A non-negative-entropy condition would be defined via the entropy of (125) if (123) is discrete or if\nthe data symbols and the channel vectors were discrete random variables [18]. However, it is unrealistic to assume\nthat the channel vectors are discrete. Thus, the conventional non-negative-entropy condition is not defined for the\nno-CSI case. A non-negative-entropy condition might be defined via the entropy for the pdf of Qt marginalized\nover the channel vectors. However, its calculation is not straightforward.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n43\n\nD. Replica Continuity\nThe evaluation of (133), (135), and (136) under the RS assumption is almost the same as in the derivations of\n(117), (110), and (111). Therefore, we omit the details and only present the results:\nM n\n\u0010\no\n\u0011\nY\nYZ\n(t)\ngN y t,k,m \u2212 hk,m bt,k,m ; \u03a30 dy t,k,m , (137)\nlim p(B\u0303t,K |Bt,K , H, IT\u03c4 ) =\nq(B\u0303t,k |Y t,k , IT\u03c4 )\nK,L\u2192\u221e\n\nm=1\n\nk\u2208K\n\nfor y t,k,m \u2208 CN . In (137), gN (y t,k,m \u2212\n\n(t)\nhk,m bt,k,m ; \u03a30 )\n\nY t,k = {yt,k,m : for all m}, is given by\nR QM\nq(B\u0303t,k |Y t,k , IT\u03c4 ) = R QM\n\nm=1 gN (y t,k,m\n\nm=1 gn (y t,k,m\n\nis defined as (1). Furthermore, q(B\u0303t,k |Y t,k , IT\u03c4 ), with\n\n\u2212 h\u0303k,m b\u0303t,k,m ; \u03a3(t) )p(B\u0303t,k )p(H\u0303k |IT\u03c4 )dH\u0303k\n\n\u2212 h\u0303k,m b\u0303t,k,m ; \u03a3(t) )p(B\u0303t,k )p(H\u0303k |IT\u03c4 )dB\u0303t,k dH\u0303k\n\n.\n\n(138)\n\n(t)\n\nIn these expressions, (\u03a30 , \u03a3(t) ) is a solution to the coupled fixed-point equations\nM\ni\n{1} {1}\n{0} {0}\n{1} {1}\n\u03b2 X X h {0} {0}\nE (h\u0303k,m bt,k,m \u2212 hh\u0303k,m bt,k,m i)(h\u0303k,m bt,k,m \u2212 hh\u0303k,m bt,k,m i)H ,\nK\u2192\u221e K\nm=1\n\n(t)\n\n\u03a30 = N0 I N + lim\n\n(139)\n\nk\u2208K\n/\n\nM\nEi\n{1} {1}\n{1} {1}\n{1} {1}\n\u03b2 X X hD {1} {1}\nE (h\u0303k,m bt,k,m \u2212 hh\u0303k,m bt,k,m i)(h\u0303k,m bt,k,m \u2212 hh\u0303k,m bt,k,m i)H ,\nK\u2192\u221e K\nm=1\n\n\u03a3(t) = N0 I N + lim\n\n(140)\n\nk\u2208K\n/\n\n{a} {a}\n\n{a} {a}\n\n{a}\n\n{a}\n\nwhere hh\u0303k,m bt,k,m i denotes the mean of h\u0303k,m bt,k,m with respect to q(bt,k,m , h\u0303k,m |y t,k,m , I T\u03c4 ,k,m )db\u0303t,k,m dh\u0303k,m ,\ngiven by\n{a} {a}\n\n{a}\n{a}\nq(bt,k,m , h\u0303k,m |y t,k,m , I T\u03c4 ,k,m )\n\n=R\n\n(t)\n\n{a}\n\n{a}\n\ngN (y t,k,m \u2212 h\u0303k,m bt,k,m ; \u03a3(t)\na )p(bt,k,m )p(h\u0303k,m |I T\u03c4 ,k,m )\n\n,\n{a} {a}\n{a}\n{a}\n{a}\n{a}\ngN (y t,k,m \u2212 h\u0303k,m bt,k,m ; \u03a3(t)\na )p(bt,k,m )p(h\u0303k,m |I T\u03c4 ,k,m )dbt,k,m dh\u0303k,m\n(141)\n\nwith \u03a31 = \u03a3(t) . In the right-hand sides of (139) and (140), the expectations are taken with respect to the measure\n(t)\n\ngN (y t,k,m \u2212 hk,m bt,k,m ; \u03a30 )dy t,k,m p(bt,k,m )dbt,k,m p(hk,m |I T\u03c4 ,k,m )p(I T\u03c4 ,k,m )dhk,m dI T\u03c4 ,k,m .\n(t)\n\nLet us assume \u03a30 = \u03a3(t) . Then, the coupled fixed-point equations (139) and (140) reduce to the single fixed-\n\npoint equation\n(t)\n\u03a30\n\n= N0 I N\n\nM\n\u0003\n\u03b2 XX \u0002\n+ lim\nE (hk,m bt,k,m \u2212 hhk,m bt,k,m i)(hk,m bt,k,m \u2212 hhk,m bt,k,m i)H .\nK\u2192\u221e K\nm=1\n\n(142)\n\nk\u2208K\n/\n\nIn (142), hhk,m bt,k,m i denotes the mean of hk,m bt,k,m with respect to the posterior pdf (30). Furthermore, the\nexpectation is taken with respect to the same measure as that for (139). It is shown in Appendix E that (142) reduces\n(t)\n\nto (37) under the assumption of \u03a30 = \u03c3c2 I N . Furthermore, it is straightforward to find that (137) is equivalent to\n(36) under Assumption 1.\nE. Multiple Solutions\nWe consider the case in which the coupled fixed-point equations (139) and (140) have multiple solutions. In this\ncase, we should choose the solution minimizing (134) under the RS assumption for n \u2208 [0, \u01eb), with a sufficiently\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n(s)\n\n44\n\n(s)\n\nsmall \u01eb > 0. Since limn\u2192+0 \u03a6(c) (Qt , Q\u0303t ; n) = 0, that solution is given as the solution minimizing the derivative\nof (134) with respect to n in the limit n \u2192 +0:\n\u2202 (c) (s) (s)\n\u2202 (c) \u0010 (s) (s) \u0011\n\u03a6 (Qt , Q\u0303t ; n) = lim\n\u03a6\nQt , Q\u0303t ; n ,\nn\u2192+0 \u2202n\nn\u2192+0 \u2202n\n\nFrs \u2261 lim\n(s)\n\nwith Q(s)\nt = limn\u2192+0 Qt\n\n(143)\n\n(s)\n\n(s)\n\nand Q\u0303t = limn\u2192+0 Q\u0303t , in which we have used the stationarity condition (136) to\n\nobtain the last expression.\nWe calculate (80) and (132) in (134) under the RS assumption in the same manner as in the derivations of (113)\nand (115) and subsequently differentiate the obtained formula with respect to n in n \u2192 +0, to have\ni\nh\n\u2202G1 \u0010 (s) \u0011\n(t)\nlim\nQt ; n = \u2212 ln det \u03a3(t) \u2212 Tr (\u03a3(t) )\u22121 \u03a30 \u2212 N ln \u03c0,\nn\u2192+0 \u2202n\n\n(144)\n\n\u2202I \u0010 (s) (s) \u0011\nQt , Q\u0303t ; n\nn\u2192+0 \u2202n\nM\ni\n1 h\n1 XX\n(t)\nE[C\u0303k,m ] ln 2 \u2212 Tr I N \u2212 2N0 (\u03a3(t) )\u22121 + N0 (\u03a3(t) )\u22121 \u03a30 (\u03a3(t) )\u22121 ,\n= lim\nK\u2192\u221e K\n\u03b2\nm=1\nlim\n\n(145)\n\nk\u2208K\n/\n\nwith\nC\u0303k,m =\n\nZ\n\ngN (y t,k,m \u2212 hk,m bt,k,m ; \u03a3(t) )\n\n(t)\n\ngN (y t,k,m \u2212hk,m bt,k,m ; \u03a30 )p(bt,k,m ) log\n\nh\n\nE gN (y t,k,m \u2212 hk,m bt,k,m ; \u03a3(t) ) I T\u03c4 ,k,m\n\ni dy\n\nt,k,m\n\ndbt,k,m ,\n(146)\n\nwhere the conditional expectation is taken with respect to hk,m and bt,k,m . Substituting (144) and (145) into (143),\nwe obtain\nM\n\u03b2 XX\n\u03b2\n(t)\n(t)\nFrs = lim\nE[C\u0303k,m ] + 2D(N0 I N k\u03a3(t) ) + D(\u03a30 k\u03a3(t) ) \u2212 D(N0 I N k\u03a3(t) (\u03a30 )\u22121 \u03a3(t) )\nK\u2192\u221e K\nln 2\nm=1\nk\u2208K\n/\n\n+N log(\u03c0eN0 ).\n\n(147)\n\nIt is straightforward to find that (147) reduces to (39) with the exception of the constant N log(\u03c0eN0 ), by substituting\n(t)\n\n\u03a30 = \u03a3(t) = \u03c3c2 I N into (147).\nA PPENDIX E\nD ERIVATION\n\nOF\n\n(37)\n\n(t)\n\nWe assume \u03a30 = \u03c3c2 I N . Taking the traces for both sides of (142) divided by N , we obtain\nM\n\u03b2 XX\nMMSEt,k,m ,\nK\u2192\u221e N K\nm=1\n\n\u03c3c2 = N0 + lim\n\n(148)\n\nk\u2208K\n/\n\nwith\n\u0002\n\u0003\nMMSEt,k,m = E khk,m bt,k,m \u2212 hhk,m bt,k,m ik2 .\n\n(149)\n\nIn (149), hhk,m bt,k,m i denotes the mean of hk,m bt,k,m with respect to the posterior pdf (30).\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n45\n\nWe first calculate the conditional joint pdf p(y t,k,m , hk,m |bt,k,m , I T\u03c4 ,k,m ) to evaluate the posterior mean of\nT\u03c4\n\nT\u03c4\n\nhk,m bt,k,m . The channel vector hk,m conditioned on I T\u03c4 ,k,m follows CN (\u0125k,m , \u03be 2 I N ), with \u0125k,m and \u03be 2 =\n2\n\u03be 2 (\u03c3tr\n(\u03c4 ), \u03c4 ) given by (31) and (32), respectively. On the other hand, (27) yields\n\nkyt,k,m \u2212 hk,m bt,k,m k\n1\nexp \u2212\np(y t,k,m |hk,m , bt,k,m ) =\n2\nN\n(\u03c0\u03c3c )\n\u03c3c2\n\n2\n\n!\n\n.\n\n(150)\n\nCalculating p(y t,k,m , hk,m |bt,k,m , I T\u03c4 ,k,m ) = p(y t,k,m |hk,m , bt,k,m )p(hk,m |I T\u03c4 ,k,m ), we obtain\np(y t,k,m , hk,m |bt,k,m , I T\u03c4 ,k,m ) = p(hk,m |y t,k,m , bt,k,m , I T\u03c4 ,k,m )p(y t,k,m |bt,k,m , I T\u03c4 ,k,m ),\n\n(151)\n\nwith\n\u001a\n(P/M )\u03be 2 + \u03c3c2\n(P/M )\u03be 2 + \u03c3c2\nexp\n\u2212\n2\n2\n\u03c0\u03be \u03c3c\n\u03be 2 \u03c3c2\n)\n2\nT\u03c4\n\u03be2\n\u03c3c2\n\u2217\n,\n\u00d7 hk,m \u2212\n\u0125\n(bt,k,m ) y t,k,m \u2212\n(P/M )\u03be 2 + \u03c3c2\n(P/M )\u03be 2 + \u03c3c2 k,m\n\np(hk,m |y t,k,m , bt,k,m , I T\u03c4 ,k,m ) =\n\n(152)\n\nwhere we have used the fact that |bt,k,m |2 equals P/M with probability one. By definition, the posterior mean of\nhk,m bt,k,m is given by\nhhk,m bt,k,m i =\n\nT\u03c4\n(P/M )\u03be 2\n\u03c3c2\n\u0125 hbt,k,m i.\n+\ny\n(P/M )\u03be 2 + \u03c3c2 t,k,m (P/M )\u03be 2 + \u03c3c2 k,m\n\nWe next evaluate (149). Substituting (27) and (153) into (149) yields\n\"\nT\u03c4\n\u03c3c2\n\u0125 (bt,k,m \u2212 hbt,k,m i)\nMMSEt,k,m = E ct,k,m +\n(P/M )\u03be 2 + \u03c3c2 k,m\n\n2\n\n#\n\n(153)\n\n,\n\n(154)\n\nwhere ct,k,m is defined as\nct,k,m =\n\nT\u03c4\n(P/M )\u03be 2\n\u03c3c2\n)b\n\u2212\n.\n(h\n\u2212\n\u0125\nn\nt,k,m\nk,m\nk,m\n(P/M )\u03be 2 + \u03c3c2\n(P/M )\u03be 2 + \u03c3c2 t,k,m\n\n(155)\n\nThe fact that ct,k,m and y t,k,m conditioned on bt,k,m and I T\u03c4 ,k,m are jointly CSCG is useful for showing\nthat the two terms on the right-hand side of (154) are mutually independent under the same conditions. The\nT\u03c4\n\nmeans of ct,k,m and y t,k,m conditioned on bt,k,m and I T\u03c4 ,k,m are zero and \u0125k,m bt,k,m , respectively. Also, the\ncovariance matrix of (cTt,k,m , y Tt,k,m )T conditioned on bt,k,m and I T\u03c4 ,k,m is evaluated as the diagonal matrix\ndiag{(P/M )\u03be 2 \u03c3c2 /{(P/M )\u03be 2 + \u03c3c2 }I N , {(P/M )\u03be 2 + \u03c3c2 }I N }. Therefore, ct,k,m and y t,k,m conditioned on bt,k,m\n\nand I T\u03c4 ,k,m are mutually independent. This fact indicates that the two terms on the right-hand side of (154)\nconditioned on bt,k,m and I T\u03c4 ,k,m are independent of each other, since the second term on the right-hand side of\n(154) conditioned on bt,k,m and I T\u03c4 ,k,m is a function of y t,k,m . Hence, from (154), we have\nMMSEt,k,m\n\nN (P/M )\u03be 2 \u03c3c2\n=\n+\n(P/M )\u03be 2 + \u03c3c2\n\n\u0012\n\n\u03c3c2\n(P/M )\u03be 2 + \u03c3c2\n\n\u00132\n\ni\nh T\u03c4\nE k\u0125k,m k2 |bt,k,m \u2212 hbt,k,m i|2 .\n\n(156)\n\nWe substitute (156) into the fixed-point equation (148) to obtain (37).\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n46\n\nA PPENDIX F\nP ROOF\n\nOF\n\nP ROPOSITION 2\n\nWe take the expectation of (36) for K = {k} with respect to p(Hk |IT\u03c4 ) to obtain\nlim p(B\u0303t,k |Bt,k , IT\u03c4 , St ) = p(B\u0303 t,k = B\u0303t,k |Bt,k , IT\u03c4 )\n\nK,L\u2192\u221e\n\nin law.\n\n(157)\n\nApplying this expression to (21), we have\nlim Csep\n\nK,L\u2192\u221e\n\n\u0013\n\u0012\n\u03c4\nlim I(B\u03c4 +1,1 , Y \u03c4 +1,1 |IT\u03c4 ),\n=\u03b2 1\u2212\nTc K,L\u2192\u221e\n\n(158)\n\nwhere we have used the fact that B\u0303 t,k contains all information about the received vectors Y t,k in the single-user\nSIMO channel (27) for the estimation of Bt,k .\nIn order to show that the right-hand side of (158) is equal to (41), we regard the conditional pdf p(Y t,k |Bt,k , IT\u03c4 )\nas a random variable and write it as Xk (IT\u03c4 ; \u0398) \u2265 0, with \u0398 = {Bt,k , {nt,k,m : for all m}}, given by\nZ\nXk (IT\u03c4 ; \u0398) = fk (Hk ; \u0398)p(Hk |IT\u03c4 )dHk ,\nwith\nfk (Hk ; \u0398) =\n\nM\nY\n\nm=1\n\np(y t,k,m = hk,m bt,k,m + nt,k,m |hk,m , bt,k,m ),\n\n(159)\n\n(160)\n\nwhere p(y t,k,m |hk,m , bt,k,m ) represents the single-user SIMO channel (27). There exists the moment generating\nQM\nfunction of (159) since (159) is bounded. Then, Lemma 1 implies that Xk \u223c m=1 X k,m (I T\u03c4 ,k,m ; \u0398) given \u0398,\ndefined as\n\nX k,m (I T\u03c4 ,k,m ; \u0398) =\n\nZ\n\np(y t,k,m = hk,m bt,k,m + nt,k,m |hk,m , bt,k,m )p(hk,m |I T\u03c4 ,k,m )dhk,m .\n\n(161)\n\n2\nIn evaluating (161), \u03c3t2 = \u03c3tr\n(\u03c4 ) for t \u2208 T\u03c4 is given by the solution to the fixed-point equation (38). Applying this\n\nresult to (158), we find that the right-hand side of (158) is equal to (41).\nA PPENDIX G\nL IST\n\nOF\n\nS EVERAL S ETS\n\nTable II lists several sets used in this paper. The other sets, such as Y, ITt , and so on, are defined according\nto the rule described in Section I-A. The indices of chips, symbol periods, users, transmit antennas, and replicas\nare denoted by l, t, k, m, and a, respectively. The indices l, t, k, and m move from 1 to the spreading factor L,\nthe coherence time Tc , the number of users K, and the number of transmit antennas M , respectively. The index a\nruns from 0 to \u00f1 (n) for Appendix C (Appendix D), which denotes the number of replicas. In this paper, indices\nthemselves have meanings, as noted in Section I-A. For example, Xt should not be confused with Xk . The former\ndenotes the pilot symbols in symbol period t, while the latter represents all pilot symbols for user k.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n47\n\nTABLE II\nL IST OF SEVERAL SETS .\n\nSets\n\nDefinitions\n\nEqs\n\nK\n\nfinite subset of {1, . . . , K}\n\n\u2013\n\nTt\n\n{1, . . . , t}\n\n\u2013\n\nCt\n\n{t, . . . , Tc }\n\n\u2013\n\n{Ak }\n\ndisjoint subsets of {2, . . . , n}\n\n(42)\n\nCN\n\nYt\n\n{y l,t \u2208\n\n: for all l}\n\n(2)\n\n\u1ef8t\n\n{\u1ef9 l,t \u2208 CN : for all l}\n\n(12)\n\nSt\n\n{sl,t,k,m \u2208 C : for all t, k, m}\n\n(2)\n\nHk\n\n{hk,m \u2208 CN : for all m}\n\n(2)\n\n{a}\nHk\n{0}\nHk\n\nreplica of Hk\n\n\u2013\n\nHk\n\n\u2013\n\nH\u0303k\n\n{h\u0303k,m \u2208 CN : for all m}\n\n(13)\n\n{a}\n\nreplica of H\u0303k\n\n\u2013\n\n{0}\n\nHk\n\n\u2013\n\nXt,k\n\n{xt,k,m \u2208 C : for all m}\n\n(3)\n\nBt,k\n\n{bt,k,m \u2208 C : for all m}\n\n(3)\n\nB\u0303t,k\n\n{b\u0303t,k,m \u2208 C : for all m}\n\n(12)\n\nreplica of B\u0303t,k\n\n\u2013\n\nH\u0303k\n\nH\u0303k\n\n{a}\n\nBt,k\n\n{0}\nBt,k\n\nBt,k\n\n\u2013\n\nUt\n\n{ut,k,m \u2208 C : for all k, m}\n\n(2)\n\nIt\n\n{Yt , St , Ut }\n\n\u2013\n\nIt\n\n{Yt , St }\n\n\u2013\n\nY t,k\n\nCN\n\n(27)\n\nI t,k,m\n\n{y t,k,m \u2208\n\n: for all m}\n\n{ut,k,m , y t,k,m }\n\n(27)\n\nR EFERENCES\n[1] F. Adachi, M. Sawahashi, and H. Suda, \"Wideband DS-CDMA for next-generation mobile communications systems,\" IEEE Commun.\nMag., vol. 36, no. 9, pp. 56\u201369, Sep. 1998.\n[2] E. Dahlman, B. Gudmundson, M. Nilsson, and J. Sk\u00f6ld, \"UMTS/IMT-2000 based on wideband CDMA,\" IEEE Commun. Mag., vol. 36,\nno. 9, pp. 70\u201380, Sep. 1998.\n[3] T. Ojanper\u00e4 and R. Prasad, \"An overview of air interface multiple access for IMT-2000/UMTS,\" IEEE Commun. Mag., vol. 36, no. 9, pp.\n82\u201395, Sep. 1998.\n[4] A. Mantravadi, V. V. Veeravalli, and H. Viswanathan, \"Spectral efficiency of MIMO multiaccess systems with single-user decoding,\" IEEE\nJ. Sel. Areas Commun., vol. 21, no. 3, pp. 382\u2013394, Apr. 2003.\n[5] Z. Ni and D. Li, \"Spectral efficiency of distributed MIMO code division multiple access systems over multipath fading channels,\" Wirel.\nCommun. Mob. Comput., vol. 5, pp. 35\u201343, 2005.\n[6] M. Juntti, M. Vehkaper\u00e4, J. Leinonen, Z. Li, D. Tujkovic, S. Tsumura, and S. Hara, \"MIMO MC-CDMA communications for future\ncellular systems,\" IEEE Commun. Mag., vol. 43, no. 2, pp. 118\u2013124, Feb. 2005.\n[7] H. Li and H. V. Poor, \"Spectral efficiency of equal-rate DS-CDMA systems with multiple transmit antennas,\" IEEE Trans. Wireless\nCommun., vol. 5, no. 12, pp. 3680\u20133688, Dec. 2006.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n48\n\n[8] A. Nordio and G. Taricco, \"Linear receivers for the multiple-input multiple-output multiple-access channel,\" IEEE Trans. Commun., vol. 54,\nno. 8, pp. 1446\u20131456, Aug. 2006.\n[9] S. Buzzi, \"Multipass channel estimation and joint multiuser detection and equalization for MIMO long-code DS/CDMA systems,\" EURASIP\nJ. Wirel. Commun. Netw., vol. 2006, pp. 1\u201313, 2006, article ID 24132.\n[10] W. Choi and J. G. Andrews, \"Spatial multiplexing in cellular MIMO-CDMA systems with linear receivers: Outage probability and capacity,\"\nIEEE Trans. Wireless Commun., vol. 6, no. 7, pp. 2612\u20132621, Jul. 2007.\n[11] K. Takeuchi, T. Tanaka, and T. Yano, \"Asymptotic analysis of general multiuser detectors in MIMO DS-CDMA channels,\" IEEE J. Sel.\nAreas Commun., vol. 26, no. 3, pp. 486\u2013496, Apr. 2008.\n[12] S. V. Hanly and D. N. C. Tse, \"Resource pooling and effective bandwidths in CDMA networks with multiuser receivers and spatial\ndiversity,\" IEEE Trans. Inf. Theory, vol. 47, no. 4, pp. 1328\u20131351, May 2001.\n[13] L. Cottatellucci and R. R. M\u00fcller, \"CDMA systems with correlated spatial diversity: A generalized resource pooling result,\" IEEE Trans.\nInf. Theory, vol. 53, no. 3, pp. 1116\u20131136, Mar. 2007.\n[14] S. Verd\u00fa, Multiuser Detection.\n\nNew York: Cambridge University Press, 1998.\n\n[15] D. N. C. Tse and S. V. Hanly, \"Linear multiuser receivers: effective interference, effective bandwidth and user capacity,\" IEEE Trans. Inf.\nTheory, vol. 45, no. 2, pp. 641\u2013657, Mar. 1999.\n[16] S. Verd\u00fa and S. Shamai (Shitz), \"Spectral efficiency of CDMA with random spreading,\" IEEE Trans. Inf. Theory, vol. 45, no. 2, pp.\n622\u2013640, Mar. 1999.\n[17] S. Shamai (Shitz) and S. Verd\u00fa, \"The impact of frequency-flat fading on the spectral efficiency of CDMA,\" IEEE Trans. Inf. Theory,\nvol. 47, no. 4, pp. 1302\u20131327, May 2001.\n[18] T. Tanaka, \"A statistical-mechanics approach to large-system analysis of CDMA multiuser detectors,\" IEEE Trans. Inf. Theory, vol. 48,\nno. 11, pp. 2888\u20132910, Nov. 2002.\n[19] R. R. M\u00fcller and W. H. Gerstacker, \"On the capacity loss due to separation of detection and decoding,\" IEEE Trans. Inf. Theory, vol. 50,\nno. 8, pp. 1769\u20131778, Aug. 2004.\n[20] D. Guo and S. Verd\u00fa, \"Randomly spread CDMA: Asymptotics via statistical physics,\" IEEE Trans. Inf. Theory, vol. 51, no. 6, pp.\n1983\u20132010, Jun. 2005.\n[21] P. D. Alexander, A. J. Grant, and M. C. Reed, \"Iterative detection in code-division multiple-access with error control coding,\" Euro. Trans.\nTelecommun., vol. 9, no. 5, pp. 419\u2013425, Sep.\u2013Oct. 1998.\n[22] M. C. Reed, C. B. Schlegel, P. D. Alexander, and J. A. Asenstorfer, \"Iterative multiuser detection for CDMA with FEC: near-single-user\nperformance,\" IEEE Trans. Commun., vol. 46, no. 12, pp. 1693\u20131699, Dec. 1998.\n[23] M. Moher, \"An iterative multiuser decoder for near-capacity communications,\" IEEE Trans. Commun., vol. 46, no. 7, pp. 870\u2013880, Jul.\n1998.\n[24] X. Wang and H. V. Poor, \"Iterative (turbo) soft interference cancellation and decoding for coded CDMA,\" IEEE Trans. Commun., vol. 47,\nno. 7, pp. 1046\u20131061, Jul. 1999.\n[25] J. Boutros and G. Caire, \"Iterative multiuser joint decoding: Unified framework and asymptotic analysis,\" IEEE Trans. Inf. Theory, vol. 48,\nno. 7, pp. 1772\u20131793, Jul. 2002.\n[26] G. Caire, R. R. M\u00fcller, and T. Tanaka, \"Iterative multiuser joint decoding: Optimal power allocation and low-complexity implementation,\"\nIEEE Trans. Inf. Theory, vol. 50, no. 9, pp. 1950\u20131973, Sep. 2004.\n[27] K. Takeuchi and T. Tanaka, \"Hierarchical decoupling principle of a MIMO-CDMA channel in asymptotic limits,\" in Proc. 2007 IEEE Int.\nSymp. Inf. Theory, Nice, France, Jun. 2007, pp. 1271\u20131275.\n[28] P. D. Alexander and A. J. Grant, \"Iterative channel and information sequence estimation in CDMA,\" in Proc. IEEE 6th Int. Symp.\nSpread-Spectrum Tech. & Appl., vol. 2, New Jersey, USA, Sep. 2000, pp. 593\u2013597.\n[29] H. E. Gamal and E. Geraniotis, \"Iterative multiuser detection for coded CDMA signals in AWGN and fading channels,\" IEEE J. Sel. Areas\nCommun., vol. 18, no. 1, pp. 30\u201341, Jan. 2000.\n[30] A. Lampe, \"Iterative multiuser detection with integrated channel estimation for coded DS-CDMA,\" IEEE Trans. Commun., vol. 50, no. 8,\npp. 1217\u20131223, Aug. 2002.\n[31] T. L. Marzetta and B. M. Hochwald, \"Capacity of a mobile multiple-antenna communication link in Rayleigh flat fading,\" IEEE Trans.\nInf. Theory, vol. 45, no. 1, pp. 139\u2013157, Jan. 1999.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n49\n\n[32] M. M\u00e9dard, \"The effect upon channel capacity in wireless communications of perfect and imperfect knowledge of the channel,\" IEEE\nTrans. Inf. Theory, vol. 46, no. 3, pp. 933\u2013946, May 2000.\n[33] B. Hassibi and B. M. Hochwald, \"How much training is needed in multiple-antenna wireless link?\" IEEE Trans. Inf. Theory, vol. 49,\nno. 4, pp. 951\u2013963, Apr. 2003.\n[34] J. Evans and D. N. C. Tse, \"Large system performance of linear multiuser receivers in multipath fading channels,\" IEEE Trans. Inf. Theory,\nvol. 46, no. 6, pp. 2059\u20132078, Sep. 2000.\n[35] H. Li, S. M. Betz, and H. V. Poor, \"Performance analysis of iterative channel estimation and multiuser detection in multipath DS-CDMA\nchannels,\" IEEE Trans. Signal Process., vol. 55, no. 5, pp. 1981\u20131993, May 2007.\n[36] M. Vehkaper\u00e4, K. Takeuchi, R. R. M\u00fcller, and T. Tanaka, \"Iterative channel and data estimation: Framework and analysis via replica\nmethod,\" in Proc. 2009 IEEE Int. Symp. Inf. Theory, Seoul, Korea, Jun. 2009, pp. 2689\u20132693.\n[37] H. Nishimori, Statistical Physics of Spin Glasses and Information Processing.\n[38] K. H. Fischer and J. A. Hertz, Spin Glasses.\n\nNew York: Oxford University Press, 2001.\n\nCambridge, UK: Cambridge University Press, 1991.\n\n[39] M\u00e9zard, G. Parisi, and M. A. Virasoro, Spin Glass Theory and Beyond.\n\nSingapore: World Scientific, 1987.\n\n[40] K. Takeda, S. Uda, and Y. Kabashima, \"Analysis of CDMA systems that are characterized by eigenvalue spectrum,\" Europhys. Lett.,\nvol. 76, no. 6, pp. 1193\u20131199, 2006.\n[41] A. L. Moustakas, S. H. Simon, and A. M. Sengupta, \"MIMO capacity through correlated channels in the presence of correlated interferers\nand noise: A (not so) large N analysis,\" IEEE Trans. Inf. Theory, vol. 49, no. 10, pp. 2545\u20132561, Oct. 2003.\n[42] C. K. Wen and K. K. Wong, \"Asymptotic analysis of spatially correlated MIMO multiple-access channels with arbitrary signaling inputs\nfor joint and separate decoding,\" IEEE Trans. Inf. Theory, vol. 53, no. 1, pp. 252\u2013268, Jan. 2007.\n[43] R. R. M\u00fcller, D. Guo, and A. L. Moustakas, \"Vector precoding for wireless MIMO systems and its replica analysis,\" IEEE J. Sel. Areas\nCommun., vol. 26, no. 3, pp. 530\u2013540, Apr. 2008.\n[44] B. M. Zaidel, R. R. M\u00fcller, A. L. Moustakas, and R. de Miguel, \"Vector precoding for Gaussian MIMO broadcast channels: Impact of\nreplica symmetry breaking,\" submitted to IEEE Trans. Inf. Theory, 2010, [Online]. Available: http://arxiv.org/abs/1001.3790.\n[45] F. Guerra, \"Broken replica symmetry bounds in the mean field spin glass model,\" Commun. Math. Phys., vol. 233, pp. 1\u201312, 2003.\n[46] M. Talagrand, \"The Parisi formula,\" Annals of Mathematics, vol. 163, pp. 221\u2013263, 2006.\n[47] S. B. Korada and A. Montanari, \"Applications of the Lindeberg principle in communicaitons and statistical learning,\" IEEE Trans. Inf.\nTheory, vol. 57, no. 4, pp. 2440\u20132450, Apr. 2011.\n[48] F. D. Neeser and J. L. Massey, \"Proper complex random processes with applications to information theory,\" IEEE Trans. Inf. Theory,\nvol. 39, no. 4, pp. 1293\u20131302, Jul. 1993.\n[49] K. Takeuchi and T. Tanaka, \"Statistical-mechanics-based analysis of multiuser MIMO channels with linear dispersion codes,\" J. Phys.:\nConf. Ser., vol. 95, pp. 012 008\u20131\u201311, Jan. 2008.\n[50] K. Takeuchi, M. Vehkaper\u00e4, T. Tanaka, and R. R. M\u00fcller, \"Asymptotic performance bounds of joint channel estimation and multiuser\ndetection in frequency-selective fading DS-CDMA channels,\" in Proc. 2008 Int. Symp. Inf. Theory and its Appl., Auckland, New Zealand,\nDec. 2008, pp. 359\u2013364.\n[51] T. M. Cover and J. A. Thomas, Elements of Information Theory, 2nd ed. New Jersey: Wiley, 2006.\n[52] T. Li and O. M. Collins, \"A successive decoding strategy for channels with memory,\" IEEE Trans. Inf. Theory, vol. 53, no. 2, pp. 628\u2013646,\nFeb. 2007.\n[53] K. Padmanabhan, S. Venkatraman, and O. M. Collins, \"Tight upper and lower bounds on the constrained capacity of non-coherent multiantenna channels,\" in Proc. 2008 IEEE Int. Symp. Inf. Theory, Toronto, Canada, Jul. 2008, pp. 2588\u20132592.\n[54] S. B. Korada and N. Macris, \"Tight bounds on the capacity of binary input random CDMA systems,\" IEEE Trans. Inf. Theory, vol. 56,\nno. 11, pp. 5590\u20135613, Nov. 2010.\n[55] Y. Kabashima, \"A CDMA multiuser detection algorithm on the basis of belief propagation,\" J. Phys. A: Math. Gen., vol. 36, no. 43, pp.\n11 111\u201311 121, Oct. 2003.\n[56] J. R. L. de Almeida and D. J. Thouless, \"Stability of the Sherrington-Kirkpatrick solution od a spin glass model,\" J. Phys. A: Math. Gen.,\nvol. 11, no. 5, pp. 983\u2013990, 1978.\n[57] H. Nishimori, \"Comment on \"statistical mechanics of CDMA multiuser demodulation\" by Tanaka,\" Europhys. Lett., vol. 57, no. 2, pp.\n302\u2013303, Jan. 2002.\n\nOctober 26, 2018\n\nDRAFT\n\n\fIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. , NO. , 2010\n\n[58] D. N. C. Tse and P. Viswanath, Fundamentals of Wireless Communication.\n\n50\n\nCambridge, UK: Cambridge University Press, 2005.\n\n[59] M. Yoshida, T. Uezu, T. Tanaka, and M. Okada, \"Statistical mechanical study of code-division multiple-access multiuser detectors,\" J.\nPhys. Soc. Jpn., vol. 76, pp. 054 003\u20131\u201310, 2007.\n[60] E. Biglieri, G. Taricco, and A. Tulino, \"How far aways is infinity? using asymptotic analyses in multiple-antenna systems,\" in Proc. IEEE\n7th Int. Symp. Spread-Spectrum Tech. & Appl., vol. 1, Prague, Czech Republic, Sep. 2002, pp. 1\u20136.\n[61] K. Nakamura and T. Tanaka, \"Microscopic analysis for decoupling principle of linear vector channel,\" in Proc. 2008 IEEE Int. Symp. Inf.\nTheory, Toronto, Canada, Jul. 2008, pp. 519\u2013523.\n\nOctober 26, 2018\n\nDRAFT\n\n\f"}