{"id": "http://arxiv.org/abs/astro-ph/0506414v2", "guidislink": true, "updated": "2005-08-31T10:04:39Z", "updated_parsed": [2005, 8, 31, 10, 4, 39, 2, 243, 0], "published": "2005-06-17T14:34:37Z", "published_parsed": [2005, 6, 17, 14, 34, 37, 4, 168, 0], "title": "An HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0506256%2Castro-ph%2F0506146%2Castro-ph%2F0506334%2Castro-ph%2F0506664%2Castro-ph%2F0506558%2Castro-ph%2F0506309%2Castro-ph%2F0506352%2Castro-ph%2F0506002%2Castro-ph%2F0506586%2Castro-ph%2F0506119%2Castro-ph%2F0506175%2Castro-ph%2F0506424%2Castro-ph%2F0506116%2Castro-ph%2F0506731%2Castro-ph%2F0506667%2Castro-ph%2F0506576%2Castro-ph%2F0506546%2Castro-ph%2F0506112%2Castro-ph%2F0506036%2Castro-ph%2F0506212%2Castro-ph%2F0506198%2Castro-ph%2F0506471%2Castro-ph%2F0506509%2Castro-ph%2F0506602%2Castro-ph%2F0506555%2Castro-ph%2F0506202%2Castro-ph%2F0506619%2Castro-ph%2F0506739%2Castro-ph%2F0506610%2Castro-ph%2F0506099%2Castro-ph%2F0506329%2Castro-ph%2F0506104%2Castro-ph%2F0506027%2Castro-ph%2F0506063%2Castro-ph%2F0506755%2Castro-ph%2F0506034%2Castro-ph%2F0506108%2Castro-ph%2F0506315%2Castro-ph%2F0506414%2Castro-ph%2F0506322%2Castro-ph%2F0506710%2Castro-ph%2F0506492%2Castro-ph%2F0506249%2Castro-ph%2F0506313%2Castro-ph%2F0506085%2Castro-ph%2F0506079%2Castro-ph%2F0506201%2Castro-ph%2F0506403%2Castro-ph%2F0506676%2Castro-ph%2F0506259%2Castro-ph%2F0506196%2Castro-ph%2F0506550%2Castro-ph%2F0506109%2Castro-ph%2F0506269%2Castro-ph%2F0506371%2Castro-ph%2F0506210%2Castro-ph%2F0506132%2Castro-ph%2F0506176%2Castro-ph%2F0506128%2Castro-ph%2F0506571%2Castro-ph%2F0506472%2Castro-ph%2F0506033%2Castro-ph%2F0506393%2Castro-ph%2F0506157%2Castro-ph%2F0506035%2Castro-ph%2F0506333%2Castro-ph%2F0506452%2Castro-ph%2F0506469%2Castro-ph%2F0506311%2Castro-ph%2F0506627%2Castro-ph%2F0506762%2Castro-ph%2F0506686%2Castro-ph%2F0506681%2Castro-ph%2F0506025%2Castro-ph%2F0506747%2Castro-ph%2F0506512%2Castro-ph%2F0506010%2Castro-ph%2F0506050%2Castro-ph%2F0506683%2Castro-ph%2F0506518%2Castro-ph%2F0506257%2Castro-ph%2F0506707%2Castro-ph%2F0506341%2Castro-ph%2F0506383%2Castro-ph%2F0506527%2Castro-ph%2F0506606%2Castro-ph%2F0506359%2Castro-ph%2F0506068%2Castro-ph%2F0506700%2Castro-ph%2F0506211%2Castro-ph%2F0506570%2Castro-ph%2F0506673%2Castro-ph%2F0506126%2Castro-ph%2F0506485%2Castro-ph%2F0506347%2Castro-ph%2F0506553%2Castro-ph%2F0506432%2Castro-ph%2F0506624%2Castro-ph%2F0506193%2Castro-ph%2F0506072%2Castro-ph%2F0506443&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "An HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics"}, "summary": "We present an extension of the HLLC approximate Riemann solver by Toro,\nSpruce and Speares to the relativistic equations of fluid dynamics. The solver\nretains the simplicity of the original two-wave formulation proposed by Harten,\nLax and van Leer (HLL) but it restores the missing contact wave in the solution\nof the Riemann problem. The resulting numerical scheme is computationally\nefficient, robust and positively conservative. The performance of the new\nsolver is evaluated through numerical testing in one and two dimensions.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0506256%2Castro-ph%2F0506146%2Castro-ph%2F0506334%2Castro-ph%2F0506664%2Castro-ph%2F0506558%2Castro-ph%2F0506309%2Castro-ph%2F0506352%2Castro-ph%2F0506002%2Castro-ph%2F0506586%2Castro-ph%2F0506119%2Castro-ph%2F0506175%2Castro-ph%2F0506424%2Castro-ph%2F0506116%2Castro-ph%2F0506731%2Castro-ph%2F0506667%2Castro-ph%2F0506576%2Castro-ph%2F0506546%2Castro-ph%2F0506112%2Castro-ph%2F0506036%2Castro-ph%2F0506212%2Castro-ph%2F0506198%2Castro-ph%2F0506471%2Castro-ph%2F0506509%2Castro-ph%2F0506602%2Castro-ph%2F0506555%2Castro-ph%2F0506202%2Castro-ph%2F0506619%2Castro-ph%2F0506739%2Castro-ph%2F0506610%2Castro-ph%2F0506099%2Castro-ph%2F0506329%2Castro-ph%2F0506104%2Castro-ph%2F0506027%2Castro-ph%2F0506063%2Castro-ph%2F0506755%2Castro-ph%2F0506034%2Castro-ph%2F0506108%2Castro-ph%2F0506315%2Castro-ph%2F0506414%2Castro-ph%2F0506322%2Castro-ph%2F0506710%2Castro-ph%2F0506492%2Castro-ph%2F0506249%2Castro-ph%2F0506313%2Castro-ph%2F0506085%2Castro-ph%2F0506079%2Castro-ph%2F0506201%2Castro-ph%2F0506403%2Castro-ph%2F0506676%2Castro-ph%2F0506259%2Castro-ph%2F0506196%2Castro-ph%2F0506550%2Castro-ph%2F0506109%2Castro-ph%2F0506269%2Castro-ph%2F0506371%2Castro-ph%2F0506210%2Castro-ph%2F0506132%2Castro-ph%2F0506176%2Castro-ph%2F0506128%2Castro-ph%2F0506571%2Castro-ph%2F0506472%2Castro-ph%2F0506033%2Castro-ph%2F0506393%2Castro-ph%2F0506157%2Castro-ph%2F0506035%2Castro-ph%2F0506333%2Castro-ph%2F0506452%2Castro-ph%2F0506469%2Castro-ph%2F0506311%2Castro-ph%2F0506627%2Castro-ph%2F0506762%2Castro-ph%2F0506686%2Castro-ph%2F0506681%2Castro-ph%2F0506025%2Castro-ph%2F0506747%2Castro-ph%2F0506512%2Castro-ph%2F0506010%2Castro-ph%2F0506050%2Castro-ph%2F0506683%2Castro-ph%2F0506518%2Castro-ph%2F0506257%2Castro-ph%2F0506707%2Castro-ph%2F0506341%2Castro-ph%2F0506383%2Castro-ph%2F0506527%2Castro-ph%2F0506606%2Castro-ph%2F0506359%2Castro-ph%2F0506068%2Castro-ph%2F0506700%2Castro-ph%2F0506211%2Castro-ph%2F0506570%2Castro-ph%2F0506673%2Castro-ph%2F0506126%2Castro-ph%2F0506485%2Castro-ph%2F0506347%2Castro-ph%2F0506553%2Castro-ph%2F0506432%2Castro-ph%2F0506624%2Castro-ph%2F0506193%2Castro-ph%2F0506072%2Castro-ph%2F0506443&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present an extension of the HLLC approximate Riemann solver by Toro,\nSpruce and Speares to the relativistic equations of fluid dynamics. The solver\nretains the simplicity of the original two-wave formulation proposed by Harten,\nLax and van Leer (HLL) but it restores the missing contact wave in the solution\nof the Riemann problem. The resulting numerical scheme is computationally\nefficient, robust and positively conservative. The performance of the new\nsolver is evaluated through numerical testing in one and two dimensions."}, "authors": ["A. Mignone", "G. Bodo"], "author_detail": {"name": "G. Bodo"}, "author": "G. Bodo", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1111/j.1365-2966.2005.09546.x", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/astro-ph/0506414v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/astro-ph/0506414v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "12 pages, 12 figures", "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/astro-ph/0506414v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/astro-ph/0506414v2", "journal_reference": null, "doi": "10.1111/j.1365-2966.2005.09546.x", "fulltext": "Mon. Not. R. Astron. Soc. 000, 1\u201313 (2005)\n\nPrinted 2 February 2008\n\n(MN LATEX style file v2.2)\n\narXiv:astro-ph/0506414v2 31 Aug 2005\n\nAn HLLC Riemann Solver for Relativistic Flows: I.\nHydrodynamics\nA.\nMignone1\u22c6 and G. Bodo1\n1\n\nINAF Osservatorio Astronomico di Torino, 10025 Pino Torinese\n\nAccepted ??. Received ??; in original form ??\n\nABSTRACT\n\nWe present an extension of the HLLC approximate Riemann solver by Toro, Spruce\nand Speares to the relativistic equations of fluid dynamics. The solver retains the\nsimplicity of the original two-wave formulation proposed by Harten, Lax and van Leer\n(HLL) but it restores the missing contact wave in the solution of the Riemann problem.\nThe resulting numerical scheme is computationally efficient, robust and positively\nconservative. The performance of the new solver is evaluated through numerical testing\nin one and two dimensions.\nKey words: hydrodynamics - methods: numerical - relativity - shock waves\n\n1\n\nINTRODUCTION\n\nHigh energy astrophysical phenomena involve, in many\ncases, relativistic flows, typical examples are superluminal\nmotion of relativistic jets in extragalactic radio sources, accretion flows around massive compact objects, pulsar winds\nand Gamma Ray Bursts. The modeling of such phenomena\nhas prompted the search for efficient and accurate numerical formulations of the special relativistic fluid equations\n(for an excellent review see Mart\u0131\u0301 & M\u00fcller 2003). There is\nnow a strong consensus that the so-called \"high-resolution\nshock-capturing\" schemes provide the necessary tools in developing stable and robust relativistic fluid dynamical codes.\nOne of the fundamental ingredients of such schemes is the\nexact or approximate solution to the Riemann problem.\nThe solution to the Riemann problem in relativistic hydrodynamics (RHD henceforth) has been extensively\nstudied in literature, and an exact solution can be found\nwithin high degree of accuracy by iterative techniques, see\nMart\u0131\u0301 & M\u00fcller (1994), Pons et al. (2000), Rezzolla et al.\n(2003) and references therein. One of the major differences\nwith the classical counterpart is the velocity coupling introduced by the Lorentz factor and the coupling of the latter\nwith the specific enthalpy. This considerably adds to the\ncomputational cost, making the use of an exact solver code\nprohibitive in a multidimensional Godunov-type code.\nFrom this perspective, approximate solvers based on\nalternative strategies have been devised: local linearization\n(Eulderink & Mellema 1995; Falle & Komissarov 1996),\ntwo-shock approximation (Balsara 1994; Dai & Woodward\n1997; Mignone et al. 2005), flux-splitting methods\n(Donat et al. 1998), and so forth, see Mart\u0131\u0301 & M\u00fcller\n\n\u22c6\n\nE-mail: mignone@to.astro.it\n\n(2003) for a comprehensive review. Most of these solvers,\nhowever, rely on rather expensive characteristic decompositions of the Jacobian matrix or involve iterative techniques\nto solve highly nonlinear equations. Although they usually\nattain better resolution at discontinuities, some of these\nmethods may produce unphysical states with negative densities or pressures, as it has been shown by Einfeldt et al.\n(1991) for linearized Riemann solvers in the context of\nclassical hydrodynamics.\nThe HLL method devised by Harten et al. (1983) for\nclassical gasdynamics belongs to a different class of approximate Riemann solvers and has gained increasing popularity\namong researchers in the last decade. It has been implemented in the context of the relativistic fluid equations by\nSchneider et al. (1993) and Duncan & Hughes (1994). The\nHLL approach does not require a full characteristic decomposition of the equations and is straightforward to implement in a Godunov-type code. Besides the computational\nefficiency, this class of solvers has the attractive feature of\nbeing positively conservative in the sense that preserve initially positive densities, energy and pressures.\nThe HLL formulation, however, lacks the ability to resolve isolated contact discontinuity and for this reason has a\nmore diffusive character than other more sophisticated algorithms. To compensate for this, Toro et al. (1994) developed\nan extension of the HLL solver for the Euler equations introducing a two-state HLL-type solver called HLLC (where\n\"C\" stands for contact) that improves the treatment of the\ncontact discontinuity, see also Batten et al. (1997). Recently\nthis approach has been generalized to the magnetohydrodynamic equations (Gurski 2004; Li 2005).\nIn the present work, we extend this approach to the\nrelativistic equation of fluid dynamics. The paper is structured as follows: in \u00a72 the relevant equations are given, in\n\n\f2\n\nA. Mignone and G. Bodo\n\n\u00a73 we describe the new approximate Riemann solver and in\n\u00a74 we asses the strength of the new method with one and\ntwo dimensional tests.\n\nt\n\n\u03bbL\n\nU *L\n2\n\nTHE RHD EQUATIONS\n\nThe motion of an ideal relativistic fluid is governed by conservation of mass, momentum and energy. The pertaining\nequations are cast as a hyperbolic system of conservation\nlaws (Landau & Lifshitz 1959) which, in two dimensions,\nreads\n\u2202U\n\u2202F x (U )\n\u2202F y (U )\n+\n+\n= 0,\n\u2202t\n\u2202x\n\u2202y\n\n(1)\n\nwhere U = (D, mx , my , E) is the unknown vector of conservative variables, whereas F x and F y are, respectively, the\nfluxes along the x and y directions:\n\n\uf8eb\n\nDvx\n\n\uf8ec\n\uf8ec mx vx + p\n\uf8ec\nx\nF (U ) = \uf8ec\n\uf8ec my vx\n\uf8ed\nmx\n\n\uf8f6\n\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7,\n\uf8f7\n\uf8f8\n\n\uf8eb\n\nDvy\n\n\uf8ec\n\uf8ec mx vy\n\uf8ec\ny\nF (U ) = \uf8ec\n\uf8ec my vy + p\n\uf8ed\nmy\n\n\uf8f6\n\nGeneralization to three dimensions is straightforward.\nIn equations (2), p is the thermal pressure, whereas D,\nm \u2261 (mx , my ) and E are, respectively, the mass, momentum\nand energy densities relative to the lab frame, where the fluid\nhas velocity v \u2261 (vx , vy ). Units are conveniently normalized\nso that the speed of light is c = 1.\nThe relation between conserved\nvariables U and physi\u0001\ncal quantities V = \u03c1, vx , vy , p is\nD = \u03b3\u03c1 ,\n\nm = Dh\u03b3v ,\n\nE = Dh\u03b3 \u2212 p ,\n\n(3)\n1\n\nwhere \u03c1 is the proper rest mass density, \u03b3 = (1 \u2212 v * v)\u2212 2\nis the Lorentz factor and h is the specific enthalpy. Proper\nclosure is provided by specifying an equation of state in the\nform h = h(p, \u03c1).\nFor an ideal gas, the enthalpy has the form \u03c1h = \u03c1 +\np\u0393/(\u0393 \u2212 1) and the sound speed is defined by\ncs =\n\nr\n\n\u0393p\n.\n\u03c1h\n\n(4)\n\nwith \u0393 being the (constant) specific heat ratio. By letting\np/\u03c1 \u2192 \u221e, we see that the square of the sound speed has\nthe limiting value c2s \u2192 \u0393 \u2212 1. Since it can be shown (Taub\n1948; Anile 1989; Mignone et al. 2005) that the specific heat\nratio \u0393 cannot exceed 2, one always has c2s < 1. This is an\nimportant result for the positivity of the HLL and HLLC\nschemes and will be used in a later section.\nEquation (3) gives U in terms of the primitive state\nvector V . The inverse relation involves the solution of a\nnonlinear equation for the pressure p:\nE + p = D\u03b3 +\n\n\u0002\n\n\u0393\np\u03b3 2\n\u0393\u22121\n\n(5)\n\n\u0003\u2212 1\n\nwhere \u03b3 = 1 \u2212 |m|2 /(E + p)2 2 . Equation (5) can be\nsolved by any standard root finding algorithm.\n\n*\n\n\u03bbR\n\n*\n\nUR\n\nUL\n\nUR\nx\n\nFigure 1. Graphical representation of the Riemann fan in the\nx \u2212 t plane. The two initial states U L and U R decay into two\nnonlinear waves (with speeds \u03bbL and \u03bbR ) and a linear contact\nwave with velocity \u03bb\u2217 . The resulting wave pattern divides the\nx \u2212 t plane into four regions each defining a constant state: U L ,\nU \u2217L , U \u2217R and U R .\n\n2.1\n\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7 .(2)\n\uf8f7\n\uf8f8\n\n\u03bb\n\nThe Riemann Problem in RHD\n\nConsider a conservative discretization of (1) along the xdirection:\nn+1\nn\nf i+ 1 \u2212 f i\u2212 1\n\u016a i\n\u2212 \u016a i\n2\n2\n.\n(6)\n=\nn\n\u2206t\n\u2206xi\nThe numerical flux functions f i+ 1 follow from the so2\nlution of Riemann problems with initial data:\nU (x, 0) =\n\n\uf8f1\n\uf8f2 U L,i+ 12\n\n\uf8f3 U R,i+ 21\n\nif\n\nx < xi+ 1 ,\n\nif\n\nx > xi+ 1 ,\n\n2\n\n(7)\n\n2\n\nwhere U L,i+ 1 and U R,i+ 1 are the left and right edge values\n2\n2\nat zone interfaces.\nThe solution of the Riemann problem for the special relativistic fluid equations has been investigated by\nMart\u0131\u0301 & M\u00fcller (1994), Pons et al. (2000), Rezzolla et al.\n(2003). It consists of a self-similar three-wave pattern generated by the decay of the initial discontinuity (7). The resulting Riemann fan (Fig. 1) is bounded by two nonlinear waves\n(representing either shocks or rarefactions) separated by a\ncontact discontinuity moving at the fluid velocity. Across\nthe contact discontinuity, pressure and normal velocity are\ncontinuous whereas density and tangential velocities experience jumps. The same holds also in the non-relativistic\nlimit. Contrary to the Newtonian counterpart, however, all\nvariables are discontinuous across a shock wave or change\nsmoothly through a rarefaction fan (Pons et al. 2000). This\nis a consequence of the velocity coupling introduced by the\nLorentz factor \u03b3 and by the coupling of the latter with the\nspecific enthalpy h.\nThe resulting wave pattern can be solved to a high degree of precision by iterative techniques and has been implemented for the first time in the one-dimensional Godunovtype code by Mart\u0131\u0301 & M\u00fcller (1996). Nevertheless, when\ntangential velocities are included, the computational effort\nincreases considerably, and the use of an exact solver in\na multidimensional Godunov-type code can become prohibitive.\nHere we consider a different approach, based on the\noriginal prescription given by Harten et al. (1983) (HLL) for\n\n\fAn HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics\nthe classical Euler equations and subsequently extended by\nToro et al. (1994) (HLLC). Both the HLL and HLLC formulations do not require a field by field decomposition of the\nrelativistic equations, a feature which makes them particularly attractive, specially in multi-dimensional applications.\n\n3\n\nHLLC Solver\n\nThe HLLC scheme restores the full wave structure inside the\nRiemann fan by replacing the single averaged state defined\nby (9) with two approximate states, U \u2217L and U \u2217R . These\ntwo states are separated by a middle contact wave which is\nassumed to have constant speed \u03bb\u2217 , so that the full solution\nto the Riemann problem now reads\n\nTHE HLL FRAMEWORK\n\nHarten, Lax and van Leer (Harten et al. 1983) proposed an\napproximate solution to the Riemann problem where the\ntwo states bounded by the two acoustic waves are averaged\ninto a single constant state. In other words, the solution to\nthe Riemann problem on the x/t = 0 axis consists of the\nthree possible constant states:\n\nU (0, t) =\n\nif\n\n\u03bbL > 0 ,\n\nU hll\n\nif\n\n\u03bbL 6 0 6 \u03bbR ,\n\n\uf8f4\n\uf8f4\n\uf8f3 UR\n\nif\n\n\u03bbR 6 0 ,\n\n\uf8f1\nUL\n\uf8f4\n\uf8f4\n\uf8f2\n\n(8)\n\nwhere we dropped, for simplicity, the half integer notation\ni + 21 . Harten et al. (1983) noted that the single state U hll\ncould be constructed from an a priori estimate of the fastest\nand slowest signal velocities \u03bbL and \u03bbR :\nU hll\n\n\u03bbR U R \u2212 \u03bbL U L + F L \u2212 F R\n,\n=\n\u03bbR \u2212 \u03bbL\n\n(9)\n\nwhere F L = F x (U L ), F R = F x (U R ). Notice that equation\n(9) represents the integral average of the solution of the\nRiemann problem over the wave fan (Toro 1997).\nThe corresponding interface numerical flux is defined\nas:\n\nf =\n\n3.1\n\nif\n\n\u03bbL > 0 ,\n\nF\n\nif\n\n\u03bbL 6 0 6 \u03bbR ,\n\n\uf8f4\n\uf8f4\n\uf8f3 FR\n\nif\n\n\u03bbR 6 0 ,\n\n\uf8f1\nFL\n\uf8f4\n\uf8f4\n\uf8f2 hll\n\n(10)\n\nwhere\n\nF hll =\n\n\u03bbR F L \u2212 \u03bbL F R + \u03bbR \u03bbL (U R \u2212 U L )\n.\n\u03bbR \u2212 \u03bbL\n\n(11)\n\nThus, given a wave speed estimate for the fastest and\nslowest speeds \u03bbR and \u03bbL (see \u00a73.1.1), an approximate solution to the Riemann problem can be constructed and the\nintercell numerical fluxes for the conservative update (6) are\ncomputed using (10).\nThis approach has been applied for the first time to the\none-dimensional relativistic equations by Schneider et al.\n(1993) and later by Duncan & Hughes (1994) for the multidimensional case.\nAlthough the HLL prescription is computationally inexpensive and straightforward to implement, a major drawback is its inability to resolve contact or tangential waves.\nOn the contrary the HLLC scheme, originally introduced by\nToro et al. (1994) in the context of the Euler equations of\nclassical gasdynamics, does not suffer from this loss. In the\nnext section we generalize this approach to the equations of\nrelativistic hydrodynamics.\n\n3\n\nU (0, t) =\n\n\uf8f1\nUL\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 U \u2217L\n\nU \u2217R\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 UR\n\nif\n\n\u03bbL > 0 ,\n\nif\n\n\u03bbL 6 0 6 \u03bb\u2217 ,\n\nif\n\n\u03bb\u2217 6 0 6 \u03bbR ,\n\nif\n\n\u03bbR 6 0 ,\n\n(12)\n\nand the corresponding intercell numerical fluxes are:\n\nf =\n\n\uf8f1\nFL\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 F \u2217L\n\nF \u2217R\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 FR\n\nif\n\n\u03bbL > 0 ,\n\nif\n\n\u03bbL 6 0 6 \u03bb\u2217 ,\n\nif\n\n\u03bb\u2217 6 0 6 \u03bbR ,\n\nif\n\n\u03bbR 6 0 .\n\n(13)\n\nThe intermediate state fluxes F \u2217L and F \u2217R may be expressed in terms of U \u2217L and U \u2217R from the Rankine-Hugoniot\njump conditions:\n\u03bb (U \u2217 \u2212 U ) = F \u2217 \u2212 F ,\n\n(14)\n\nwhere here and throughout the following, quantities without\na suffix L or R refer indifferently to the left (L) or right\n(R) states. Notice that, in general, F = F x (U ) but F \u2217 6=\nF x (U \u2217 ).\nWe remind the reader that the HLL and HLLC solvers\ndiffer in the representation of the intermediate states. In the\ncase of supersonic flows (\u03bbL > 0 or \u03bbR < 0), in fact, the two\nsolvers become equivalent. The same result also holds for an\nexact Riemann solver.\nIf \u03bbL and \u03bbR are given (see \u00a73.1.1), equation (14) represent a system of 2n equations (where n is the number of\ncomponents of U ) for the 4n+1 unknowns U \u2217L , U \u2217R , F \u2217L , F \u2217R\nand \u03bb\u2217 . Three additional constraints come from the requirements that both pressure and normal velocity be continuous\n\u2217\n\u2217\nacross the contact wave (i.e. vx,R\n= vx,L\n, p\u2217R = p\u2217L ) and that\n\u2217\n\u2217\n\u2217\n\u03bb = vx,L = vx,R . This, however, yields a total of only 2n+3\nequations, still not sufficient to solve the system. In order\nto reduce the number of unknowns and have a well-posed\nproblem, further assumptions have to be made on the form\nof the fluxes F \u2217 . Here we assume that the two-dimensional\nfluxes can be written as\n\n\uf8eb\n\nD\u2217 vx\u2217\n\n\uf8ec \u2217 \u2217\n\uf8ec mx vx + p\u2217\nF =\uf8ec\n\uf8ec\nm\u2217y vx\u2217\n\uf8ed\n\u2217\n\nm\u2217x\n\n\uf8f6\n\n\uf8f7\n\uf8f7\n\uf8f7.\n\uf8f7\n\uf8f8\n\n(15)\n\nIn such a way, both U \u2217 and F \u2217 are expressed in terms of\nthe five unknowns D\u2217 , vx\u2217 , m\u2217y , E \u2217 and p\u2217 . The normal components of momentum in the star region, m\u2217x,L and m\u2217x,R , are\nnot independent variables since, for consistency, we require\nthat m\u2217x = (E \u2217 +p\u2217 )vx\u2217 . In the classical case, this assumption\nbecomes equivalent to m\u2217x = \u03c1\u2217 \u03bb\u2217 . This yields a total of 11\nequations in 11 unknowns.\n\n\f4\n\nA. Mignone and G. Bodo\n\nWriting explicitly equation (14) for the left or the right\nstate yields\nD\u2217 (\u03bb \u2212 \u03bb\u2217 )\n\n=\n\nD(\u03bb \u2212 vx ) ,\n\nm\u2217x (\u03bb\n\n=\n\nmx (\u03bb \u2212 vx ) + p\u2217 \u2212 p ,\n\n\u2217\n\n\u2212\u03bb )\n\nm\u2217y (\u03bb \u2212 \u03bb\u2217 )\n\n=\n\nmy (\u03bb \u2212 vx ) ,\n\nE \u2217 (\u03bb \u2212 \u03bb\u2217 )\n\n=\n\nE(\u03bb \u2212 vx ) + p\u2217 \u03bb\u2217 \u2212 pvx .\n\n(\u03bb \u2212 vx )2 = \u03c3s (1 \u2212 \u03bb2 ) ,\n(16)\n\nIf one combines the last of (16) together with the second\none, the following expression giving \u03bb\u2217 in terms of p\u2217 may\nbe obtained:\n(A \u2212 \u03bbp\u2217 )vx\u2217 = B + p\u2217 ,\n\n(17)\n\nwhere A = \u03bbE \u2212 mx , B = mx (\u03bb \u2212 vx ) \u2212 p.\nBy imposing p\u2217x,L = p\u2217x,R across the contact discontinuity we find the following quadratic equation for \u03bb\u2217 :\n2\n\nhll\nFEhll (\u03bb\u2217 ) \u2212 (E hll + Fm\n)\u03bb\u2217 + mhll\nx = 0.\nx\n\n(18)\n\nhll\nIn equation (18), FEhll and Fm\nare the energy and mox\nmentum components of the HLL flux given by equation (11),\nwhereas E hll and mhll\nx are the energy and normal momentum components of the HLL state vector, equation (9). Of\nthe two roots of equation (18) only the one with the minus sign is physically acceptable, since it lies in the range\n(\u22121, 1) and, according to the wave-speed estimate presented\nin \u00a73.1.1, can be interpreted as an average velocity between\n\u03bbL and \u03bbR . The mathematical proof of this statement is\ngiven in the appendix (A). Besides, the same root has the\nhll\nas v/c \u2192 0\ncorrect classical limit, that is \u03bb\u2217 \u2192 mhll\nx /\u03c1\nand h \u2192 1. This wave speed is the same one proposed by\nToro (1997) and further discussed in Batten et al. (1997).\nOnce \u03bb\u2217 is known, p\u2217 is computed from (17) and the\ncomponents of U \u2217 are readily obtained from (16).\nFinally we notice that the method is consistent, in that\nthe integral average over the Riemann fan automatically satisfies the consistency condition by construction (Toro 1997):\n\n(\u03bb\u2217 \u2212 \u03bbL )U \u2217L + (\u03bbR \u2212 \u03bb\u2217 )U \u2217R\n= U hll ,\n\u03bbR \u2212 \u03bbL\n\n(19)\n\nor, alternatively,\nF \u2217L \u03bbR (\u03bb\u2217 \u2212 \u03bbL ) + F \u2217R \u03bbL (\u03bbR \u2212 \u03bb\u2217 )\n= \u03bb\u2217 F hll .\n\u03bbR \u2212 \u03bbL\n\n(20)\n\nIncidentally, we notice that equation (18) could have been\nobtained by algebraic manipulations of equations (19) and\n(20).\n3.1.1\n\nWave Speed Estimate\n\nThe wave speeds needed in our formulation are estimates\nfor the lower and upper bounds of the signal velocities in\nthe solution to the Riemann problem (Toro 1997). Here we\nconsider the relativistic generalization of the estimates given\nby Davis (1988) for the Euler equation of gasdynamics. The\nsame choice has been initially adopted by Schneider et al.\n(1993), Duncan & Hughes (1994) in their relativistic HLL\nsolver and is commonly used by other authors, see, for example, Del Zanna & Bucciantini (2002). Specifically we set:\n\u03bbL = min(\u03bb\u2212 (V R ), \u03bb\u2212 (V L )) ,\n\u03bbR = max(\u03bb+ (V R ), \u03bb+ (V L )) ,\n\nwhere \u03bb+ and \u03bb\u2212 are the maximum and minimum eigenvalues of the Jacobian matrix \u2202F /\u2202U . They are the roots of\nthe quadratic equation\n\n(21)\n\n(22)\n\n\u0001\n\nwith \u03c3s = c2s / \u03b3 2 (1 \u2212 c2s ) , and hence\n\u03bb\u00b1 (V ) =\n\nvx \u00b1\n\np\n\n\u03c3s (1 \u2212 vx2 + \u03c3s )\n.\n1 + \u03c3s\n\n(23)\n\nIt should be mentioned that the wave speed estimate\n(21) is not the only possible one and different choices (such\nas the Roe average) may be considered.\n\n3.1.2\n\nPositivity of the HLLC scheme\n\nAdopting the same notations as in Batten et al. (1997), we\ndenote with G the set of physically admissible conservative\nstates:\n\n\uf8f1\uf8eb\n\uf8f6\nD\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f7\n\uf8f2\uf8ec\n\uf8ec mx \uf8f7\n\uf8ec\n\uf8f7,\nG= \uf8ec\n\uf8f7\n\uf8f4\nm\ny \uf8f8\n\uf8f4\n\uf8ed\n\uf8f4\n\uf8f4\n\uf8f3\nE\n\nD>0\nE>\n\np\n\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fd\n\n\uf8f4\nm2x + m2y + D2 \uf8f4\n\uf8f4\n\uf8f4\n\uf8fe\n\n,\n\n(24)\n\nwhere the second inequality simultaneously guarantees pressure positivity and that the total velocity never exceeds the\nspeed of light.\nWe remind the reader that the pressure p(U \u2217 ) computed from the conservative state U \u2217 using (5) should not\nbe confused with p\u2217 appearing in the flux definition (15).\nThe two pressures are, in fact, different and the positivity argument should apply to p(U \u2217 ) rather than p\u2217 , which\ncan take negative values under certain circumstances. Similar considerations hold for the velocity \u03bb\u2217 of the contact\ndiscontinuity for which, in general, we have \u03bb\u2217 6= vx (U \u2217 ).\nThus p\u2217 and \u03bb\u2217 may be more conveniently considered as\nauxiliary variables.\nThis is one of the fundamental differences between our\nrelativistic solver and the classical HLLC scheme, for which\nhll\n\u03bb\u2217 = mhll\nand thus only p\u2217 plays the role of an auxilx /\u03c1\niary parameter. This behavior is a direct consequence of the\nrelativistic coupling between thermodynamical and kinetical\nterms, a feature absent in the Newtonian formulation.\nThe positivity of the HLLC scheme is preserved if each\nof the two intermediate states U \u2217L and U \u2217R are contained in\nG.\nFor the density, the proof is trivial and follows from the\ninequalities \u03bbL 6 \u03bb\u2217 6 \u03bbR and \u03bbL 6 vx (L, R) 6 \u03bbR , see\nAppendix \u00a7A.\nUnfortunately the analytical proof of the second statement presents some algebraic difficulties, since the second\nof (24) reduces to an inequality for a quartic equation in\n\u03bb\u2217 . However, extensive numerical testing, part of which is\npresented in \u00a74, has shown that the second of (24) is always satisfied for all pair of states U L and U R whose wave\nspeeds are computed according to (21) and for which an exact analytical solution to the Riemann problem exists (i.e.\nno vacuum is created).\n\n\fAn HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics\n4\n\n5\n\nALGORITHM VALIDATION\n\nWe now provide some numerical examples to test our new\nHLLC solver. For the test problems considered in this section we closely follow Lucas-Serrano et al. (2004).\n\n4.1\n\nImplementation Details\n\nThe numerical integration of the relativistic equations (1)\nproceeds via the conservative update (6). For the first-order\nHLLC scheme, we compute the inter-cell numerical fluxes\nf i+ 1 using (10) with left and right states given, respectively,\n2\nby U i and U i+1 .\nFor the second order scheme, the input to the Riemann\nproblem are the states\n1\nn+ 2\n\nn+ 1\n\nV i+ 12,L = V i\n\n+\n\n2\n\n1\nn+ 2\n\nV i+ 1 ,R = V\n2\n\n1\nn+ 2\n\nwhere V i\nn+ 1\n2\n\nUi\n\n1\nn+ 2\ni+1\n\n\u03b4V n\ni\n,\n2\n(25)\n\n\u03b4V n\ni+1\n,\n\u2212\n2\n\nfollows from a simple Hancock predictor step,\n\n= Un\ni \u2212\n\n\u2206tn\nF\n2\u2206xi\n\nh \u0010\n\n\u0011\n\nVn\ni+ 1 ,L \u2212 F\n2\n\n\u0010\n\nVn\ni\u2212 1 ,R\n2\n\n\u0011i\n\n, (26)\n\nFigure 2. Comparison between the HLL (dotted line) and HLLC\n(dashed line) Riemann solvers for problem 1 at t = 0.4. Only the\ndensity profiles are shown. Computations were performed with\nthe first-order scheme on 100 computational zones with CFL =\n0.8. The solid line gives the analytical solution. The major difference between the two approaches is the resolution of the contact\nwave.\n\nwith V n\nand V n\ncomputed from (25) by replacing\ni+ 1 ,L\ni\u2212 1 ,R\n1\n\n2\n\n2\n\nV n+ 2 with V n .\nThe \u03b4V 's appearing in equation (25) are computed at\nthe beginning of the time step using the fourth-order limited\nslopes (Colella 1985; Saltzman 1994):\n\u03b4V i = si min\n\n\u0012\n\n4\n\u03b4\u0304V i+1 + \u03b4\u0304V i\u22121\n, \u2206l V i\n\u22060 V i \u2212\n3\n6\n\n\u0013\n\n, (27)\n\nwhere\n\u2206l V i = \u03b1 min (|\u2206V i |, |\u2206V i\u22121 |) ,\n\n(28)\n\n4.2\n\n(29)\n\nThe first test consists in a Riemann problem with initial\ndata\n\nand \u03b4\u0304V i are the second-order slopes\n\u03b4\u0304V i = si min (\u2206l V i , |\u22060 V i |) ,\n\u2206V i = V i+1 \u2212 V i ,\nsi =\n\nV i+1 \u2212 V i\u22121\n\u22060 V i =\n,\n2\n\nsign(\u2206V i ) + sign(\u2206V i\u22121 )\n.\n2\n\nMultidimensional integration is achieved via Strang directional splitting (Strang 1968), that is, by successively applying one-dimensional operators in reverse order from one\ntime step to the next one, i.e. U n+2 = Lx Ly U n+1 and\nU n+1 = Ly Lx U n . Here Lx is the operator corresponding\nto the conservative update (6) (and similarly for Ly ). The\nsame time increment \u2206t should be used for two consecutive\ntime steps.\n\n(30)\n(31)\n\nThe parameter \u03b1 \u2208 [1, 2] adjusts the limiter compression,\nwith \u03b1 = 2 (\u03b1 = 1) yielding a more (less) compressive limiter. Notice that, although the use of fourth-order slopes attains sharper representations of discontinuities, the scheme\nretains global second-order spatial accuracy.\nWe do not make use of any artificial steepening algorithm to enhance resolution across a contact\nwave (Mart\u0131\u0301 & M\u00fcller 1996; Lucas-Serrano et al. 2004;\nMignone et al. 2005) in order to highlight the intrinsic capabilities of our new HLLC solver. In the one-dimensional\ntests, the computational domain is the interval [0, 1] and the\ncompression parameter is \u03b1 = 2. In two dimensions we set\n\u03b1 = 2, \u03b1 = 1.25 and \u03b1 = 1 for density, velocities and pressure, respectively. Additional shock flattening, computed as\nin (Mart\u0131\u0301 & M\u00fcller 1996), is used in \u00a74.2 and \u00a74.6 to prevent spurious numerical oscillations. Outflow boundary conditions are set in problem 1\u20134.\n\nProblem 1\n\n\u0001\n\n\u03c1, vx , p =\n\n(\n\n\u0001\n\n1, 0.9, 1\n\n\u0001\n\n1, 0, 10\n\nfor\n\nx < 0.5 ,\n\nfor\n\nx > 0.5 .\n\n(32)\n\nIntegration is carried with CF L = 0.8 until t = 0.4 and an\nideal equation of state with \u0393 = 4/3 is used. The breakup of\nthe discontinuity results in the formation of two shock waves\nseparated by a contact discontinuity.\nIn Fig. 2 we plot the analytical solution for the rest\nmass density together with the profiles obtained with the\nfirst-order HLLC and HLL schemes on 100 uniform computational zones. The two integrations behave similarly near\nthe shock waves, but differ in the ability to resolve the contact discontinuity. As expected, the HLLC scheme yields a\nsharper representation of the latter, whereas the HLL solver\nretains a more diffusive character.\nThe L1 norm errors of density are shown in the topleft panel of Fig. 8 for different resolutions. For the sake of\ncomparison, computations have also been performed using\nthe more sophisticated exact Riemann solver described in\nthe one-dimensional code by Mart\u0131\u0301 & M\u00fcller (1996). The\nerrors obtained with the present HLLC scheme and the exact\nRiemann solver are comparable at low resolution (\u223c 15.3%\n\n\f6\n\nA. Mignone and G. Bodo\n\nFigure 3. Numerical solutions obtained with the second-order\nHLLC scheme applied to problem 1. The solid line represents the\nanalytical solution, while computed profiles of density (crosses),\npressure (plus signs) and velocity (filled circles) are shown on 400\ncomputational zones at t = 0.4. A CFL number of 0.8 was used.\n\nand \u223c 13.6% respectively on 100 points) and become nearly\nidentical as the number of points increases. Conversely, the\nerrors computed with the relativistic HLL scheme are bigger\n(\u223c 22.2% on 100 points) and show that almost twice the\nresolution is needed to achieve the same accuracy obtained\nwith the HLLC or the exact solver.\nFig. 3 shows the results computed with the second-order\nHLLC scheme on 400 zones, at the same time. The exact\nprofiles for density, velocity and pressure are plotted as solid\nlines. Additional slope flattening (Mart\u0131\u0301 & M\u00fcller 1996) has\nbeen used to reduce the spurious numerical oscillations observed behind the shock front. All discontinuities are adequately captured and resolved on few computational cells,\n\u223c 3 for the shocks and \u223c 4 \u2212 5 for the contact discontinuity\n(contrary to \u223c 7 when the HLL solver is employed).\nThe error in L1 norm is \u223c 2.3% for 400 grid zones and it\nhas been computed at different resolutions using the HLL,\nHLLC and exact Riemann solver, see Fig. 9. Not surprisingly, the second-order interpolation considerably reduces\nthe errors and higher convergence rates are expected for all\nschemes. Nevertheless, the three solvers mostly differ in the\nresolution at the contact discontinuity and, for n > 800 grid\npoints, the HLLC and exact Riemann are practically indistinguishable, while at the maximum resolution employed\n(3200 zones), the error computed with the HLL scheme is\nstill \u223c 20% bigger.\n\n4.3\n\nProblem 2\n\nIn the second test, we prescribe the initial condition\n\n\u0001\n\n\u03c1, vx , p =\n\n(\n\n\u0001\n\n1, \u22120.6, 10\n\n\u0001\n\n10, 0.5, 20\n\nfor\n\nx < 0.5 ,\n\nfor\n\nx > 0.5 ,\n\n(33)\n\nwith an ideal equation of state with \u0393 = 5/3. Integration\nstops at t = 0.4 and CFL = 0.8 has been used in the inte-\n\nFigure 4. Computed density profiles for the first-order HLL\n(dotted line) and HLLC (dashed line) schemes for problem 2 at\nt = 0.4. We used 100 grid points and CFL number of 0.8. The analytical solution is plotted as a solid line. As expected, the HLLC\nsolver behaves quantitatively better than the HLL scheme across\nthe contact wave.\n\nFigure 5. Second-order HLLC scheme applied to problem 2 at\nt = 0.4 on 400 computational zones with CFL = 0.8. As in Fig. 3,\nprofiles for density, pressure and velocity are plotted using crosses,\nplus signs and filled circles. The contact wave is the only discontinuity in the solution and is clearly visible at x \u2248 0.4.\n\ngration. The initial discontinuity evolves into left-going and\nright-going rarefaction waves with a contact discontinuity in\nthe middle.\nResults for the first-order HLL and HLLC schemes on\na 100-point uniform grid are shown in Fig. 4. Again, notice\nthe sharper resolution of the HLLC scheme in proximity of\nthe contact wave. The smooth rarefaction waves are equally\nresolved by both schemes.\nThe behavior of the solution under grid resolution effects is described in the top-right panel of Fig. 8. Since the\n\n\fAn HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics\n\nFigure 6. Results of the second-order HLLC scheme applied to\nshock tube problem 3 at t = 0.4 on 400 computational zones.\nIntegration has been carried with CFL = 0.8. The solution is\ncomprised of a left-going rarefaction wave, a right-going contact\nand shock wave moving close to each other.\n\n7\n\nFigure 7. Computed profiles of density, pressure and velocity for\nthe second-order HLLC scheme applied to blast wave problem\n(problem 4). Integration has been carried with CF L = 0.8 on\n400 uniform zones until t = 0.4. The configuration is similar to\nthat of problem 3, but the shock and the contact waves are now\nmuch closer to each other.\n\nonly discontinuity in the problem is the contact wave, the L1\nnorm reflects mostly the different resolution across the discontinuity. The HLLC and the exact solver perform nearly\nidentically, while the HLL exhibits a slightly slower convergence rate. At the maximum resolution, the error in the HLL\nscheme is \u223c 4.3% to be compared to the \u223c 3.0% and 3.1%\nerrors obtained from the other two Riemann solvers.\nThese differences are again reduced in the second-order\nHLLC scheme, Fig. 5, for which the convergence rates are\nsimilar, as shown in the top-right panel of Fig. 9.\n\nfind strong differences between our HLLC method and the\nHLL scheme. Resolution effects are given in the bottom left\npanels of Fig. 8 and 9 for the first-order and second order\nschemes, respectively. As one can see, the solutions computed with the HLL, HLLC and exact solvers behave nearly\nin the same way, with the L1 norm errors being different by\nless than 1% at low resolution and becoming identical for\nn > 800 grid points. We believe that this might be due to\nthe proximity of the contact and shock waves. The quality\nof our results is, however, similar and comparable to those\nobtained in previous studies.\n\n4.4\n\n4.5\n\nProblem 3\n\nThe initial condition for this test is\n\n\u0001\n\n\u03c1, vx , p =\n\n(\n\n\u0001\n\n10, 0, 40/3\n\n\u0001\n\n1, 0, 0\n\nfor\n\nProblem 4\n\nIn the fourth shock-tube, we prescribe the following initial\ndiscontinuity\n\nx < 0.5 ,\n(34)\n\nfor\n\nx > 0.5 ,\n\nwith \u0393 = 5/3. For numerical reasons, the pressure in the\nleft state has been set equal to a small value, p = 2/3 * 10\u22126 .\nIntegration is carried with CFL = 0.8 on 400 grid points;\nthe final integration time is t = 0.4. The initial configuration\nresults in a mildly relativistic blast wave, with a maximum\nLorentz factor \u03b3max \u223c 1.4. The Riemann fan consists of a\nrarefaction wave moving to the left, a shock wave adjacent\nto a contact discontinuity, both moving to the right, see Fig.\n6.\nOur HLLC scheme is able to capture discontinuities\nproperly; in particular, the shock is resolved within 2-3 zones\nand the contact discontinuity smears out over 4-5 zones. We\nremind again that the interpolation algorithm does not make\nuse of additional artificial compression to enhance resolution across the contact wave, as in Mart\u0131\u0301 & M\u00fcller (1996).\nMoreover, we repeated the test also with the exact Riemann\nsolver and did not find any noticeable difference. In addition\nand contrary to the previous two test problems, we did not\n\n\u0001\n\n\u03c1, vx , p =\n\n(\n\n1, 0, 103\n\n\u0001\n\n\u0001\n\u22122\n\n1, 0, 10\n\nfor\n\nx < 0.5 ,\n\nfor\n\nx > 0.5 .\n\n(35)\n\nAgain we adopt an ideal equation of state with \u0393 = 5/3.\nThe resulting pattern is similar to that of problem 3, but\nthe specific enthalpy in the left state is much greater than\nunity, thus resulting in a more thermodynamically relativistic configuration. The solution computed with the secondorder scheme at t = 0.4 is shown in Fig. 7 on 400 computational zones and CFL=0.8.\nThe high pressure jump produces a strong shock wave\nand a contact discontinuity very close to each other, moving\nto the right at almost the same speeds. The higher compression in the shell is due to a more pronounced relativistic\nlength-contraction effect caused by a higher Lorentz factor,\n\u03b3max \u223c 3.7. The smaller thickness of the shell between the\nshock and the contact wave makes this test numerically challenging and particularly demanding in terms of resolution.\nOur relativistic HLLC scheme is able to reproduce the\nsolution within a satisfactory agreement, even without us-\n\n\f8\n\nA. Mignone and G. Bodo\n\nFigure 8. Grid resolution studies for the first-order schemes using the HLL (filled circles), HLLC (crosses) and exact Riemann\nsolvers (triangles). Results are shown for problem 1 (P1, top left),\nproblem 2 (P2 top right), problem 3 (P3, bottom left) and problem 4 (P4, bottom right). Computations have been performed on\n50, 100, 200, 400, 800, 1600 and 3200 grid zones with the same\nCFL number (0.8) for all runs. Notice that both the HLLC and\nexact solvers perform better than the HLL scheme in problem 1\nand 2, while all schemes yield nearly identical results in problem\n3 and 4.\n\nFigure 9. Grid resolution studies for the second-order schemes.\nThe notations are the same ones used in Fig. 8. Computations\nwere obtained using the same CFL number (0.8) for all cases.\n\ning a contact steepening algorithm. The absolute global error in density is 6.5% and the density peak in the thin shell\nachieves \u223c 81.6% of the exact value. Our results are therefore similar to previous ones proposed in literature.\nIt should also be pointed out that, similarly to problem 3, we did not find any improvement in the solution by\nswitching to the exact Riemann solver or using the relativistic HLL scheme. This is confirmed by the resolution study\ncarried for the first and second-order schemes (bottom right\npanels in Fig. 8 and 9). Again, we suggest that the ability to\ncapture the discontinuities relies on the interpolation properties of the algorithm and has a weaker dependence on the\nRiemann solver for this particular class of problems.\n4.6\n\nRelativistic Planar Shock Reflection\n\nThe initial configuration for this test problem consists in a\ncold (p = 0), uniform (\u03c1 = 1) flow impinging on a wall located at x = 0. The flow has constant inflow velocity vin and\nthe reflection results in the formation of a strong shock wave.\nFor t > 0 the shock propagates upstream and the solution\nhas an analytic form given by (Mart\u0131\u0301 & M\u00fcller 1996):\n\u03c1(r, t) =\n\n(\n\n1\n\nfor\n\nr > vs t ,\n\n\u03c3\n\nfor\n\nr < vs t ,\n\n(36)\n\nwhere\n\u03c3=\n\n\u0393 + 1 + \u0393 (\u03b3in \u2212 1)\n,\n\u0393\u22121\n\nvs = (\u0393 \u2212 1)\n\n\u03b3in |vin |\n,\n\u03b3in + 1\n\n(37)\n\nare the compression ratio and the shock velocity, respectively. Behind the shock wave (r < vs t), the gas is at\n\nFigure 10. Relativistic planar shock reflection test with CFL =\n0.4 and 100 grid points. Results are shown at t = 1.5 for the\nsecond-order HLLC scheme. The cold supersonic flow enters at\nx = 1 and a reflective boundary condition is imposed on the left,\nat x = 0. The reflected shock is located at x = 0.5.\n\nrest (i.e. v = 0) and the pressure has the constant value\n\u03c1(r, t)(\u03b3in \u2212 1)(\u0393 \u2212 1). Conversely, in front of the shock all\nof the energy is kinetic and thus p = 0, v = vin .\nFor numerical reasons, pressure has been initialized to a\nsmall finite value, p = \u01eb(\u0393 \u2212 1), with \u01eb = 10\u221210 and \u0393 = 4/3.\nThe computational domain is covered with 100 computational zones and the initial inflow velocity is vin = \u22120.99999\ncorresponding to a Lorentz factor \u03b3in \u223c 224. Integration is\ncarried with CFL =0.4.\nFig. 10 shows the solution at t = 1.5, after the shock\nhas propagated \u2206xs \u2248 0.5 fromPthe wall. The relative\nglobal errors (defined as \u01eb(L1 )/ i \u03c1ex (xi )\u2206xi ) for den-\n\n\fAn HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics\n\n9\n\nsity, velocity and pressure are, respectively, 1.8%, 1.4%\nand 1.4%. This result is in excellent quantitative agreement with the numerical solutions obtained by other authors (Marquina et al. 1992; Mart\u0131\u0301 et al. 1997; Aloy et al.\n1999; Del Zanna & Bucciantini 2002). In this test, similarly\nto problem 1, shock flattening was employed to prevent numerical oscillations.\nAlso, from the same figure, we notice that our solver suffers from the wall-heating phenomenon, a common pathology in modern Godunov-type schemes. The degree of this\npathology is higher than the HLL scheme but less than the\nexact Riemann solver. We also point out that the problem\nmay be partially mitigated by a proper fine-tunings of the\nparameters involved in the reconstruction and steepening algorithms. However, we did not follow that approach in the\npresent work.\n\n4.7\n\nTwo-Dimensional Riemann Problem\n\nTwo dimensional Riemann problems involve the interactions\nof four elementary waves (either shocks, rarefactions, and\ncontact discontinuities) initially separating four constant\nstates. They have been formulated by Schulz et al. (1993),\nLax & Liu (1998) in the context of classical hydrodynamics.\nHere we consider a relativistic extension, initially proposed\nby Del Zanna & Bucciantini (2002), where the initial configuration involves two shocks and two tangential discontinuities.\nThe domain is the square [\u22121, 1] \u00d7 [\u22121, 1] covered with\n4002 computational zones. The four quadrants N E (x, y >\n0), N W (x < 0 < y), SW (x, y < 0), SE (y < 0 < x) divide\nthe square into four constant-state regions:\n\n\uf8f1\n\u0001\n0.1, 0, 0, 0.01\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u0001\n\uf8f4\n\uf8f4\n\u0001 \uf8f2 0.1, 0.99, 0, 1\n\u0001\n\u03c1, vx , vy , p =\n0.5, 0, 0, 1\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u0001\n\uf8f4\n\uf8f4\n\uf8f3 0.1, 0, 0.99, 1\n\nfor\n\nx, y > 0 ,\n\nfor\n\nx < 0 < y,\n\nfor\n\nx, y < 0 ,\n\nfor\n\ny < 0 < x.\n\n(38)\n\nWe use an ideal equation of state with \u0393 = 5/3. The integration is carried out with CFL=0.4 till t = 0.8.\nNotice that the initial condition (38) does not exactly\nprescribe two simple shock waves at the N W \u2212 N E and\nSE \u2212 N E interface. The correct version of this problem has\nbeen considered by Mignone et al. (2005). For the sake of\ncomparison, however, we chose to adopt the same initial\ncondition as in Del Zanna & Bucciantini (2002).\nThe top and bottom panels in Fig. 11 show, respectively,\nthe solutions computed with the HLLC and HLL solvers.\nThe breakup of the initial discontinuity results in two equalstrength curved shock fronts propagating from regions N W\nand SE into the upper right portion of the domain (N E),\ntop panel of Fig. 11. Region SW is bounded by two tangential discontinuities and a jet-like structure emerges along\nthe main diagonal.\nThe initial steady tangential discontinuities, located at\nthe W and S interfaces, remain automatically sharp in the\nHLLC formulation, since they are exactly captured by the\napproximate Riemann solver. The same results has also been\nshown by Mignone et al. (2005) who used a two-shock iterative nonlinear solver. We emphasize that this is property per-\n\nFigure 11. Density logarithms for the two-dimensional Riemann\nproblem on 4002 zones at t = 0.8; the top (bottom) panel shows\nthe results obtained with the second-order HLLC (HLL) scheme.\nThirty equally spaced contours are shown. Integration has been\nperformed with CFL = 0.4. Curved transmitted shocks are visible in the upper right portion of the domain. The drop-shaped\nregion in the lower left portion is bounded by two tangential discontinuities. The HLL (bottom panel) shows additional numerical\ndiffusion which degenerate into spurious waves propagating along\nthe main axis.\n\ntains to the Riemann solver itself and does not depend on the\ninterpolation algorithm. Indeed the same result holds when\nthe first-order scheme is employed. This feature is absent\nfrom the HLL formulation, where tangential discontinuities\nspread along the cartesian axis due to extra numerical diffusion. This behavior is manifestly evident in the grid-aligned\nspurious waves visible in the bottom panel of Fig. 11, see\nalso Del Zanna & Bucciantini (2002); Lucas-Serrano et al.\n(2004).\n\n\f10\n\nA. Mignone and G. Bodo\n\n4.8\n\nAxisymmetric Relativistic Jet\n\nFinally, as an example of an astrophysical application,\nwe consider the propagation of a light, axisymmetric relativistic jet in 2-D cylindrical geometry. For the sake\nof comparison, the parameters of the simulation are the\nsame used by Del Zanna & Bucciantini (2002) and by\nLucas-Serrano et al. (2004). The initial condition is prescribed as\n\n\uf8f1\n\u0001\n\uf8f2 0.1, 0, 0.99, 10\u22122\n\u0001\n\u03c1, vr , vz , p =\n\uf8f3 10, 0, 0, 10\u22122\n\u0001\n\nfor\n\nr, z < 1 ,\n\notherwise .\n\n(39)\n\nThe jet is pressure matched and its internal relativistic Mach\nnumber is 17.1. We use an ideal equation of state with\n\u0393 = 5/3 both for the jet and the ambient medium. The computational domain covers the region 0 6 r 6 12, 0 6 z 6 35,\nwith 240 \u00d7 700 grid points, so that we have 20 cells per jet\nradius. At the symmetry axis, r = 0, we impose reflecting\nboundary conditions; outflow boundary conditions are set\neverywhere else, except at the inlet region where we keep\nthe beam constant. The CFL number is 0.5 and the jet evolution is followed until t = 80.\nFor the sake of comparison, we have also carried the\nsimulation using the relativistic HLL solver. Figure 12 shows\ntwo snapshots of the rest mass density at times t = 40 and\nt = 80. The upper-half of each panel refers to the HLLC\nintegration, whereas the lower portion displays the result\nobtained with the HLL scheme. We see that all the structural features characteristic of jet propagation can be clearly\nidentified, with good resolution of shock waves and contact\ndiscontinuities. It is clear from the figures that the HLLC integration shows a significantly greater amount of small scale\nstructure, that is not visible in the HLL results. This is due\nto the larger numerical diffusion introduced by the latter in\nsubsonic regions which prevent sharp resolution of shear and\ntangential waves.\nThe average advance speed of the jet head is \u223c 0.39\n(to be compared with a onedimensional theoretical estimate\nof 0.44; Mart\u0131\u0301 et al. (1997)). Moreover, we can observe the\nabsence of the carbuncle problem, that usually appears as an\nextended nose in front of the jet, on the axis (Quirk 1994).\n\n5\n\nEFFICIENCY COMPARISON\n\nPrevious numerical tests have shown that the quality of\nsolution achieved with the HLLC scheme can be competitive with more complex exact or iterative non-linear\nRiemann solvers, see for example Mart\u0131\u0301 & M\u00fcller (1996),\nMignone et al. (2005). Another aspect which plays in favour\nof the HLLC formalism is the computational efficiency, particularly crucial in long-term simulations in two and three\ndimensions.\nTable 1 gives the normalized CPU time required by the\nHLL, HLLC and approximate two-shock nonlinear Riemann\nsolvers (for the latter see Mignone et al. 2005). All three\nsolvers are available in the C author's code and have been\nwritten performing similar degree of optimizations. On the\ncontrary, the FORTRAN code for the exact solution to the\nRiemann problem, available from Mart\u0131\u0301 & M\u00fcller (2003),\nwas found to be more than a factor of 7 slower than the HLL\n\nFigure 12. Gray scale images of the rest-mass density logarithm\nfor the relativistic jet simulation at t = 40 (top panel) and t = 80\n(bottom panel). In each panel, the HLLC (HLL) solver has been\nused for the upper (lower) portion of the image. The resolution is\n20 points per jet radius, corresponding to grid size of 240 \u00d7 700\ncomputational zones. Integration has been carried with CFL =\n0.5\n\nsolver. We believe that this might be due to a lower degree of\noptimization and by the time consuming numerical integration across the rarefaction fan (Pons et al. 2000). For illustrative purposes, we consider the first four one-dimensional\ntests and the two-dimensional Riemann problem. Integrations have been carried using the first-order scheme on 4000\nand 4002 zones, respectively. No optimization flags were used\nduring the compilation.\nFrom the table, one can easily conclude that the HLLC\nscheme requires little additional costs with respect to the\nHLL approach (between 4% and 7% in one dimension), while\nthe iterative nonlinear solver is certainly more expensive,\nbeing by a factor of more than 30% slower.\nIn making the comparison, however, one should keep\nin mind that HLL-type solvers are iteration-free since the\nunderlying algorithms always require a fixed number of operations, regardless of the initial condition. On the contrary,\niterative nonlinear Riemann solvers have a certain degree of\nadaptability since the number of iterations to achieve convergence depends on the strength of the discontinuity at the\nzone interface. In smooth regions of the flow, for example,\nfewer iterations are usually needed. This explains why the\n\n\fAn HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics\nTest\n\n# zones\n\nHLL\n\nHLLC\n\nRiemann\n\n#1\n\n4000\n\n1\n\n1.05\n\n1.37\n\n#2\n\n4000\n\n1\n\n1.07\n\n1.34\n\n#3\n\n4000\n\n1\n\n1.06\n\n1.30\n\n#4\n\n4000\n\n1\n\n1.04\n\n1.44\n\nR2-D\n\n4002\n\n1\n\n1.03\n\n1.30\n\nTable 1. Normalized CPU time per integration step for the first\nfour one-dimensional shock tubes and the 2-D Riemann problem\n(R2-D) considered in \u00a74.7. The two rightmost columns give the\naverage computing time for the HLLC and two-shock nonlinear\nRiemann solvers normalized to the HLL time (third column). All\nruns were produced using the first-order scheme with CF L = 0.8.\n\nfourth test problems is particularly time consuming, since a\nstronger discontinuity is involved.\nIn this respect, a direct comparison between different\nRiemann solvers becomes problem-dependent and can be\nused only as an order-of-magnitude estimate. Conversely,\nwe do not expect the HLLC/HLL efficiency ratio to change\nwith increasing complexity of the flow patterns. For this reason, we believe that for problems involving rich and complex\nstructures the trade-off between computational efficiency\nand quality of results is certainly worth the effort.\n\n6\n\nCONCLUSIONS\n\nWe have presented, for the first time, an extension of the\nHLLC scheme by Toro et al. (1994) to relativistic gas dynamics. The solver is robust, computationally efficient and\ncomplete, in that it considers the full wave structure in the\nsolution to the Riemann problem. The solver retains the attractive feature of being positively conservative, typical of\nthe HLL scheme family.\nThe major improvement over the simple single-state\nHLL solver is the ability to resolve contact and tangential\ndiscontinuities. This property has been demonstrated by direct comparisons in several one- and two-dimensional test\nproblems, where differences are strongly evident. The results\nindicate that the new HLLC solver attains sharper representation of discontinuities, quantitatively similar to the exact\nbut algebraically and computationally more intensive Riemann solver.\nThe additional computational cost over the traditional\nHLL approach is less than 8% and we believe that the improved quality of results largely justifies the trade-off between the two approximate Riemann solvers.\nExtension to relativistic magnetized flows will be considered in a forthcoming paper. We notice, however, that\nthe HLLC formalism presented in this work can be easily\ngeneralized to the case of vanishing normal component of\nmagnetic field. When this degeneracy occurs (as in the propagation of jets with toroidal magnetic field, see for example\nLeismann et al. 2005), in fact, the solution to the Riemann\nproblem is entirely analogous to the non-magnetized case,\nsince only three waves are actually involved. This extension\nwill be presented in Mignone et al. (2005).\n\n11\n\nFinally, we mention that the relativistic HLLC scheme\ndoes not make any assumption on the equation of state, and\nefforts to incorporate different equations of state should be\nminimal.\n\nREFERENCES\nAloy, M. A., Ib\u00e1\u00f1ez, J. M. & Mart\u0131\u0301, J. M. 1999, ApJS, 122,\n151\nAnile, A. M. 1989, Relativistic Fluids and Magneto-fluids\n(Cambridge: Cambridge University Press), 55\nBalsara, D. S. 1994, J. Comput. Phys., 114, 284\nBatten, P., Clarke, N., Lambert, C., and Causon, D.M.\n1997, SIAM J. Sci. Comput, 18, 1553\nColella, P. 1985, SIAM J. Sci. Stat. Comput., 6, 104\nCourant, R., Friedrichs, K. O. & Lewy, H. 1928, Math.\nAnn., 100, 32\nDai, W. & Woodward, P. R. 1997, SIAM J. Sci. Comput.,\n18, 982\nDavis, S.F. 1988, SIAM J. Sci. Statist. Comput., 9, 445\nDel Zanna, L. & Bucciantini, N. 2002, aap, 390, 1177\nDonat, R., Font, J. A., Ib\u00e1\u00f1ez, J. M. & Marquina, A. 1998,\nJ. Comput. Phys., 146, 58\nDuncan, G. C., & Hughes, P. A. 1994, apjl, 436, L119\nEinfeldt, B., Munz, C.D., Roe, P.L., and Sj\u00f6green, B. 1991,\nJ. Comput. Phys., 92, 273\nEulderink, F., & Mellema, G. 1995, aaps, 110, 587\nFalle, S. A. E. G & Komissarov, S. S. 1996, mnras, 278,\n586\nGurski, K.F. 2004, SIAM J. Sci. Comput, 25, 2165\nHarten, A., Lax, P.D., and van Leer, B. 1983, SIAM Review, 25(1):35,61\nLax, P. D. & Liu, X.-D. 1998, SIAM J. Sci. Comput., 19,\n319\nLandau, L. D. & Lifshitz, E. M. 1959, Fluid Mechanics\n(New York: Pergamon)\nLeismann, T., Ant\u00f3n, L., Aloy, M. A., M\u00fcller, E., Mart\u0131\u0301,\nJ. M., Miralles, J. A., & Ib\u00e1\u00f1ez, J. M. 2005, aap, 436, 503\nShengtai Li, 2005, J. Comput. Phys., 344-357\nMarquina, A., Mart\u0131\u0301, J.M., Ib\u00e1\u00f1ez, J. M., Miralles, J. A. &\nDonat, R. 1992, aap, 258, 566\nMart\u0131\u0301, J. M. & M\u00fcller, E. 1994, J. Fluid Mech., 258, 317\nMart\u0131\u0301, J. M. & M\u00fcller, E. 1996, J. Comput. Phys., 123, 1\nMart\u0131\u0301, J. M., M\u00fcller, E., Font, J. A., Ibanez, J. M. A. &\nMarquina, A. 1997, apj, 479, 151\nMart\u0131\u0301, J. M. & M\u00fcller, E. 2003, Living Reviews in Relativity, 6, 7\nMignone, A., Plewa, T., and Bodo, G. 2005, ApJS, accepted\nMignone, A., Massaglia, B., and Bodo, G. 2005, in preparation\nPons, J.A., Mart\u0131\u0301, J.M. & M\u00fcller, E. 2000, J. Fluid Mech.,\n42, 125\nQuirk, J. 1994, Int. J. Numer. Methods Fluids, 18, 555\nRezzolla, L., Zanotti, O., Pons, J.A., 2003, J. Fluid Mech.,\n479, 199\nSaltzman, J. 1994, J. Comput. Phys., 115, 153\nLucas-Serrano, A., Font, J. A., Ib\u00e1\u00f1ez, J. M., & Mart\u0131\u0301,\nJ. M. 2004, aap, 428, 703\nSchneider, V., Katscher, U., Rischke, D.H, Waldhauser, B.,\nMaruhn, J.A, and Munz, C.-D, 1993, J. Comput. Phys,\n105, 92\n\n\f12\n\nA. Mignone and G. Bodo\n\nSchulz-Rinne, C. W., Collins, J. P. & Glaz, H. M. 1993,\nSIAM J. Sci. Comp., 14, 1394\nStrang, G., 1968, SIAM J. Num. Anal., 5, 506\nTaub, A. H. 1948, Physical Review, 74, 328\nToro, E. F. 1997, Riemann Solvers and Numerical Methods\nfor Fluid Dynamics, Springer-Verlag, Berlin\nToro, E. F., Spruce, M., and Speares, W. 1994, Shock\nWaves, 4, 25\n\n\u03bb0 =\n\nvx \u03b3 2 \u0393(vx + 1) + c2s\n.\n\u03b3 2 \u0393(vx + 1) \u2212 c2s\n\n(A5)\n\nHowever, direct substitution of \u03bb0 in (A3) shows, after extensive manipulations, that\n\nh\n\ni\n\nf (\u03bb0 ) = \u2212K2 c4s \u2212 (1 + 2\u0393)c2s + \u03b3 2 \u03932 (1 \u2212 vx2 ) ,\n\n(A6)\n\nwhere K2 is always a positive quantity. It can be easily verified that the function in square brackets is always positive if c2s \u2208 [0, \u0393 \u2212 1] and 1 < \u0393 < 2. Thus we must have\nBR /AR > \u22121.\n\nAPPENDIX A: PROOF OF \u03bbL 6 \u03bb\u2217 6 \u039bR\n\nProposition A.3. \u03bbL AR \u2212 AR < 0, \u03bbR AL \u2212 BL > 0.\n\nIn what follows we prove some important results concerning the positivity of the our relativistic HLLC scheme. The\nproof is given below in A.4. Propositions A.1 through A.3\ndemonstrate some preliminary results.\nWe assume that the fastest and slowest signal velocities\nare computed according to the prescription given in \u00a73.1.1,\nand that \u03bbR > 0 and \u03bbL < 0, which is the case of applicability for the intermediate fluxes (13). Obviously, the initial\nleft and right states are supposed to be physically admissible, i.e. they belong to the set G defined in \u00a73.1.2.\n\nProof For the right state we have that\n\u03bbL A \u2212 B 6 \u03bb\u2212 A \u2212 B 6\n\n\u0010\n\n2v\n\u2212\u03bb A\u2212B,\n1 + \u03c3s\n\n\u0011\n\n(A7)\n\nwhere the last inequality follows from the fact that the two\nroots of equation (A3) satisfy\n\u03bb\u2212 =\n\n2v\n\u2212 \u03bb+ ,\n1 + \u03c3s\n\nand\n\n\u03bb+ 6 \u03bb .\n\n(A8)\n\nProposition A.1. AR > 0, AL < 0\n\nUsing the fact that \u03bb2 (1 + \u03c3s ) > 2\u03bbv \u2212 v 2 + \u03c3s and that\nA > 0, the last expression in equation (A7) can be shown to\nobey the following\n\nProof We will only prove AR > 0, since the proof for AL\nis similar. For the sake of clarity, we omit the subscript R.\nUsing the definition of A given after equation (17) one has\n\n\u0010\n\n\u03c3\nA = (E + p) \u03bb 1 \u2212\n\u0393\n\nh \u0010\n\n\u0011\n\ni\n\n\u2212 vx ,\n\n(A1)\n\nwhere \u03c3 = c2s /\u03b3 2 is always positive numbers. Equation (A1)\nis always positive for \u03bb > \u03bb0 , where\n\u03bb0 \u2261\n\n\u0393vx\n.\n\u0393\u2212\u03c3\n\n(A2)\n\nHowever, according to the choice given in \u00a73.1.1, \u03bb must\nsatify\n\u03c3\nf (\u03bb) = (\u03bb \u2212 vx )2 \u2212\n(1 \u2212 \u03bb2 ) > 0 .\n(A3)\n1 \u2212 c2s\nwith \u03c3s = \u03c3/(1 \u2212 c2s ). Equation (A3) simply states that \u03bb\nmust be greater than the root with the positive sign \u03bb+\n(for the left state, \u03bbL is always less than the root with the\nnegative sign \u03bb\u2212 ). Direct substitution of \u03bb0 from (A2) into\n(A3) shows, after some algebra, that\nf (\u03bb0 ) 6 K1 \u2212c4s + (vx2 + 2\u0393)c2s \u2212 \u03932 ,\n\n\u0002\n\n\u0003\n\n(A4)\n\nwhere the equality occurs in the limit of zero tangential velocities and K1 is always a positive quantity. Since 1 < \u0393 < 2\nand c2s has the limiting value (\u0393\u22121) the expression in square\nbracket is always negative, which means that \u03bb > \u03bb+ > \u03bb0 .\nThis implies that A \u2261 AR is always positive with our choice\nof \u03bb \u2261 \u03bbR .\nSince one can prove, in a similar way, that AL < 0, we\nhave the important results that UEhll = AR \u2212 AL > 0.\nProposition A.2. BR + AR > 0, BL \u2212 AL > 0.\nProof Again we only give the proof for the right state, the\nother case being similar. The function A + B (the subscript\nR is omitted), with A and B defined after equation (17)\nincreases linearly with \u03bb and is positive for \u03bb > \u03bb0 , where\n\n2v\n\u2212\u03bb A\u2212B 6 g,\n1 + \u03c3s\n\n\u0011\n\nwhere\n\n(A9)\n\ni\n\nh\n\ng = K3 v 2 (\u0393 \u2212 c2s \u2212 1) + 1 \u2212 \u0393 + c2s \u2212 2c2s vt2 ,\n\n(A10)\n\nwith K3 being a positive quantity. The expression in square\nbracket in equation (A10) is always negative under the same\nassumptions used previously. Thus we have \u03bbL < BR /AR\nand, similarly, one can prove that \u03bbR > BL /AL .\nProposition A.4. \u03bbL 6 \u03bb\u2217 6 \u03bbR .\nProof We now show that the choice of eigenvalues given in\n\u00a73.1.1 always guarantees \u03bbL 6 \u03bb\u2217 6 \u03bbR .\nThe starting point is to note that the quadratic equation\n(18) can be more conveniently written as\n(AL \u03bb\u2217 \u2212 BL )(1 \u2212 \u03bbR \u03bb\u2217 ) = (AR \u03bb\u2217 \u2212 BR )(1 \u2212 \u03bbL \u03bb\u2217 ) , (A11)\nwhich defines the intersection of two quadratic functions.\nThe parabola on the left hand side vanishes in \u03bb\u2217 = 1/\u03bbR >\n1 and \u03bb\u2217 = BL /AL < 1, whereas the parabola on the right\nhand side in \u03bb\u2217 = 1/\u03bbL < \u22121 and \u03bb\u2217 = BR /AR > \u22121.\nMoreover the two quadratics have the same concavity, since\nsign(AL \u03bbR ) = sign(AR \u03bbL ) = \u22121. Thus the intersection\nmust necessarily satisfy\nmin\n\n\u0010B\n\nR\n\nAR\n\n,\n\nBL\nAL\n\n\u0011\n\n6 \u03bb\u2217 6 max\n\n\u0010B\n\nR\n\nAR\n\n,\n\nBL\nAL\n\nHowever, for any \u03bb \u2208 (\u22121, 1) one has\n\n\u0011\n\n.\n\n\u03bbA \u2212 B = (\u03bb \u2212 vx )2 (E + p) + p(1 \u2212 \u03bb2 ) > 0 ,\n\n(A12)\n\n(A13)\n\nwhich, together with the results previously shown, implies\nthat\n\u0010\n\u0011\nBR BL\n1 > \u03bbR > max\n,\n,\nAR AL\n(A14)\n\u0011\n\u0010\nBR BL\n.\n,\n\u22121 < \u03bbL < min\nAR AL\n\n\fAn HLLC Riemann Solver for Relativistic Flows: I. Hydrodynamics\nand hence\n\u03bbL 6 \u03bb\u2217 6 \u03bbR .\n\n(A15)\n\n13\n\n\f"}