{"id": "http://arxiv.org/abs/1010.5403v1", "guidislink": true, "updated": "2010-10-26T14:14:00Z", "updated_parsed": [2010, 10, 26, 14, 14, 0, 1, 299, 0], "published": "2010-10-26T14:14:00Z", "published_parsed": [2010, 10, 26, 14, 14, 0, 1, 299, 0], "title": "On the Duality Theory for the Monge-Kantorovich Transport Problem", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1010.4787%2C1010.3312%2C1010.1702%2C1010.2054%2C1010.6015%2C1010.3890%2C1010.2793%2C1010.5250%2C1010.5863%2C1010.0216%2C1010.5991%2C1010.2413%2C1010.3060%2C1010.3665%2C1010.3969%2C1010.4027%2C1010.1035%2C1010.1913%2C1010.1793%2C1010.2547%2C1010.0085%2C1010.1406%2C1010.1394%2C1010.1261%2C1010.0101%2C1010.3994%2C1010.0848%2C1010.4281%2C1010.0718%2C1010.5619%2C1010.4210%2C1010.4932%2C1010.3466%2C1010.4410%2C1010.4104%2C1010.1605%2C1010.0104%2C1010.6175%2C1010.3035%2C1010.5714%2C1010.5542%2C1010.3714%2C1010.4656%2C1010.5302%2C1010.0250%2C1010.1560%2C1010.0303%2C1010.4622%2C1010.5692%2C1010.4477%2C1010.1823%2C1010.4457%2C1010.3986%2C1010.4933%2C1010.5944%2C1010.4171%2C1010.5000%2C1010.2523%2C1010.4684%2C1010.0859%2C1010.1631%2C1010.0768%2C1010.3644%2C1010.3978%2C1010.2757%2C1010.4480%2C1010.0818%2C1010.3951%2C1010.5895%2C1010.5286%2C1010.2382%2C1010.3097%2C1010.4759%2C1010.0078%2C1010.3015%2C1010.6027%2C1010.3416%2C1010.4459%2C1010.5526%2C1010.2521%2C1010.3218%2C1010.3369%2C1010.1711%2C1010.2113%2C1010.3542%2C1010.0296%2C1010.2179%2C1010.0503%2C1010.3189%2C1010.4708%2C1010.1089%2C1010.2830%2C1010.5403%2C1010.4894%2C1010.2087%2C1010.3701%2C1010.0655%2C1010.1398%2C1010.5385%2C1010.2667%2C1010.2496&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the Duality Theory for the Monge-Kantorovich Transport Problem"}, "summary": "The paper is accompanying \"A general Duality Theorem for the\nMonge-Kantorovich Transport Problem\". We explain the methods used in this\narticle in an elementary setting and present two examples complementing the\nresults obtained therein.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1010.4787%2C1010.3312%2C1010.1702%2C1010.2054%2C1010.6015%2C1010.3890%2C1010.2793%2C1010.5250%2C1010.5863%2C1010.0216%2C1010.5991%2C1010.2413%2C1010.3060%2C1010.3665%2C1010.3969%2C1010.4027%2C1010.1035%2C1010.1913%2C1010.1793%2C1010.2547%2C1010.0085%2C1010.1406%2C1010.1394%2C1010.1261%2C1010.0101%2C1010.3994%2C1010.0848%2C1010.4281%2C1010.0718%2C1010.5619%2C1010.4210%2C1010.4932%2C1010.3466%2C1010.4410%2C1010.4104%2C1010.1605%2C1010.0104%2C1010.6175%2C1010.3035%2C1010.5714%2C1010.5542%2C1010.3714%2C1010.4656%2C1010.5302%2C1010.0250%2C1010.1560%2C1010.0303%2C1010.4622%2C1010.5692%2C1010.4477%2C1010.1823%2C1010.4457%2C1010.3986%2C1010.4933%2C1010.5944%2C1010.4171%2C1010.5000%2C1010.2523%2C1010.4684%2C1010.0859%2C1010.1631%2C1010.0768%2C1010.3644%2C1010.3978%2C1010.2757%2C1010.4480%2C1010.0818%2C1010.3951%2C1010.5895%2C1010.5286%2C1010.2382%2C1010.3097%2C1010.4759%2C1010.0078%2C1010.3015%2C1010.6027%2C1010.3416%2C1010.4459%2C1010.5526%2C1010.2521%2C1010.3218%2C1010.3369%2C1010.1711%2C1010.2113%2C1010.3542%2C1010.0296%2C1010.2179%2C1010.0503%2C1010.3189%2C1010.4708%2C1010.1089%2C1010.2830%2C1010.5403%2C1010.4894%2C1010.2087%2C1010.3701%2C1010.0655%2C1010.1398%2C1010.5385%2C1010.2667%2C1010.2496&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The paper is accompanying \"A general Duality Theorem for the\nMonge-Kantorovich Transport Problem\". We explain the methods used in this\narticle in an elementary setting and present two examples complementing the\nresults obtained therein."}, "authors": ["Mathias Beiglb\u00f6ck", "Christian L\u00e9onard", "Walter Schachermayer"], "author_detail": {"name": "Walter Schachermayer"}, "author": "Walter Schachermayer", "links": [{"href": "http://arxiv.org/abs/1010.5403v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1010.5403v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1010.5403v1", "affiliation": "VUT", "arxiv_url": "http://arxiv.org/abs/1010.5403v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:1010.5403v1 [math.CA] 26 Oct 2010\n\nOn the Duality Theory for the Monge\u2013Kantorovich\nTransport Problem\nMathias Beiglb\u00f6ck, Christian L\u00e9onard, Walter Schachermayer\u2217\n\n1\n\nIntroduction\n\nThis article, which is an accompanying paper to [BLS09], consists of two parts: In section 2\nwe present a version of Fenchel's perturbation method for the duality theory of the Monge\u2013\nKantorovich problem of optimal transport. The treatment is elementary as we suppose that\nthe spaces (X, \u03bc), (Y, \u03bd), on which the optimal transport problem [Vil03, Vil09] is defined,\nsimply equal the finite set {1, . . . , N } equipped with uniform measure. In this setting the\noptimal transport problem reduces to a finite-dimensional linear programming problem.\nThe purpose of this first part of the paper is rather didactic: it should stress some\nfeatures of the linear programming nature of the optimal transport problem, which carry\nover also to the case of general polish spaces X, Y equipped with Borel probability measures\n\u03bc, \u03bd, and general Borel measurable cost functions c : X \u00d7 Y \u2192 [0, \u221e]. This general setting is\nanalyzed in detail in [BLS09]; section 2 below may serve as a motivation for the arguments\nin the proof of Theorems 1.2 and 1.7 of [BLS09] which pertain to the general duality theory.\nThe second - and longer - part of the paper, consisting of sections 3 and 4 is of a quite\ndifferent nature.\nSection 3 is devoted to illustrate a technical feature of [BLS09, Theorem 4.2] by an\nexplicit example. The technical feature is the appearance of the singular part b\nhs of the dual\n1\n\u2217\u2217\noptimizer b\nh \u2208 L (X \u00d7 Y, \u03c0) obtained in ([BLS09, Theorem 4.2]). In Example 3.1 below we\nshow that, in general, the dual optimizer b\nh does indeed contain a non-trivial singular part.\nIn addition, this example allows to observe in a rather explicit way how this singular part\n1\nb\n\"builds up\", for an optimizing sequence (\u03c6n \u2295 \u03c8n )\u221e\nn=1 \u2208 L (X \u00d7 Y, \u03c0) which converges to h\nwith respect to the weak-star topology. The construction of this example, which is a variant\nof an example due to L. Ambrosio and A. Pratelli [AP03], is rather longish and technical.\nSome motivation for this construction will be given at the end of Section 2.\nSection 4 pertains to a modified version of the duality relation in the Monge-Kantorovich\ntransport problem. Trivial counterexamples such as [BLS09, Example 1.1] show that in the\ncase of a measurable cost function c : X \u00d7 Y \u2192 [0, \u221e] there may be a duality gap. The main\nresult (Theorem 1.2) of [BLS09] asserts that one may avoid this difficulty by considering a\nsuitable relaxed form of the primal problem; if one does so, duality holds true in complete\ngenerality. In a different vein, one may leave the primal problem unchanged, and overcome\nthe difficulties encountered in the above mentioned simple example by considering a slightly\nmodified dual problem (cf. [BLS09, Remark 3.4]). In the last part of the article we consider\n\u2217 The first author acknowledges financial support from the Austrian Science Fund (FWF) under grant\nP21209. The third author acknowledges support from the Austrian Science Fund (FWF) under grant P19456,\nfrom the Vienna Science and Technology Fund (WWTF) under grant MA13 and by the Christian Doppler\nResearch Association (CDG). All authors thank A. Pratelli for helpful discussions on the topic of this paper.\nWe also thank L. Summerer for his advice.\n\n1\n\n\fa certain twist of the construction given in section 3, which allows us to prove that this dual\nrelaxation does not lead to a general duality result.\n\n2\n\nThe finite case\n\nIn this section we present the duality theory of optimal transport for the finite case: Let\nX = Y = {1, . . . , N } and let \u03bc = \u03bd assign probability N \u22121 to each of the points 1, . . . , N .\nLet c = (c(i, j))N\ni,j=1 be an R + -valued N \u00d7 N matrix.\nThe problem of optimal transport then becomes the subsequent linear optimization problem\nhc, \u03c0i :=\n\nN X\nN\nX\n\n2\n\n\u03c0 \u2208 RN ,\n\n\u03c0(i, j) c(i, j) \u2192 min,\n\n(1)\n\ni=1 j=1\n\nunder the constraints\nN\nX\n\n\u03c0(i, j) = N \u22121 ,\n\ni = 1, . . . , N,\n\n\u03c0(i, j) = N \u22121 ,\n\nj = 1, . . . , N,\n\nj=1\n\nN\nX\ni=1\n\n\u03c0(i, j) \u2265 0,\n\ni, j = 1, . . . , N.\n\nOf course, this is an easy and standard problem of linear optimization; yet we want\nto treat it in some detail in order to develop intuition and concepts for the general case\nconsidered in [BLS09] as well as in section 3 .\nFor the two sets of equality constraints we introduce 2N Lagrange multipliers (\u03c6(i))N\ni=1\nand (\u03c8(j))N\nj=1 taking values in R, and for the inequality constraints (4) we introduce Lagrange multipliers (\u033aij )N\ni,j=1 taking values in R+ . The Lagrangian functional L(\u03c0, \u03c6, \u03c8, \u033a)\nthen is given by\nL(\u03c0, \u03c6, \u03c8, \u033a) =\n\nN X\nN\nX\n\nc(i, j) \u03c0(i, j)\n\ni=1 j=1\n\n\u2212\n\nN\nX\ni=1\n\n\u2212\n\nN\nX\n\n\uf8eb\n\n\u03c6(i) \uf8ed\n\u03c8(j)\n\nj=1\n\nN\nX\n\n\uf8f6\n\n\u03c0(i, j) \u2212 N \u22121 \uf8f8\n\u03c0(i, j) \u2212 N\n\ni=1\n\nj=1\n\n\u2212\n\nN\nX\n\nN X\nN\nX\n\n\u22121\n\n!\n\n\u033a(i, j)\u03c0(i, j),\n\ni=1 j=1\n\nwhere the \u03c0(i, j), \u03c6(i) and \u03c8(j) range in R, while the \u033a(i, j) range in R+ .\nIt is designed in such a way that\nC(\u03c0) := sup L(\u03c0, \u03c6, \u03c8, \u033a) = hc, \u03c0i + \u03c7\u03a0(\u03bc,\u03bd) (\u03c0),\n\u03c6,\u03c8,\u033a\n\nwhere \u03a0(\u03bc, \u03bd) denotes the admissible set of \u03c0's, i.e., the probability measures on X \u00d7 Y\nwith marginals \u03bc and \u03bd, and \u03c7A ( . ) denotes the indicator function of a set A in the sense\nof convex function theory, i.e., taking the value 0 on A, and the value +\u221e outside of A.\n2\n\n\fIn particular, we have\nP := inf 2 C(\u03c0) = inf\n\nsup L(\u03c0, \u03c6, \u03c8, \u033a),\n\n\u03c0\u2208RN 2 \u03c6,\u03c8,\u033a\n\n\u03c0\u2208RN\n\nwhere P is the optimal value of the primal optimization problem (1).\nTo develop the duality theory of the primal problem (1) we pass from inf sup L to sup\ninf L. Denote by D(\u03c6, \u03c8, \u033a) the dual function\nD(\u03c6, \u03c8, \u033a) = inf 2 L(\u03c0, \u03c6, \u03c8, \u033a)\n\u03c0\u2208RN\n\n= inf\n\nN X\nN\nX\n\n\u03c0\u2208RN 2 i=1 j=1\n\n\u03c0(i, j)[c(i, j) \u2212 \u03c6(i) \u2212 \u03c8(j) \u2212 \u033a(i, j)]\n\n\uf8ee\n\uf8f9\nN\nN\nX\nX\n+N \u22121 \uf8f0\n\u03c6(i) +\n\u03c8(j)\uf8fb .\ni=1\n\nj=1\n\nHence we obtain as the optimal value of the dual problem\n\nD := sup D(\u03c6, \u03c8, \u033a) = (E\u03bc [\u03c6] + E\u03bd [\u03c8]) \u2212 \u03c7\u03a8 (\u03c6, \u03c8)\n\n(2)\n\n\u03c6,\u03c8,\u033a\n\nwhere \u03a8 denotes the admissible set of \u03c6, \u03c8, i.e. satisfying\n\u03c6(i) + \u03c8(j) + \u033a(i, j) = c(i, j),\n\n1 \u2264 i, j \u2264 N,\n\nfor some non-negative \"slack variables\" \u033a(i, j).\nLet us show that there is no duality gap, i.e., the values of P and D coincide. Of course, in\nthe present finite dimensional case, this equality as well as the fact that the inf sup (resp. sup\ninf) above is a min max (resp. a max min) easily follows from general compactness arguments.\nYet we want to verify things directly using the idea of \"complementary slackness\" of the\nprimal and the dual constraints (good references are, e.g. [PSU88, ET99, AE06]).\nWe apply \"Fenchel's perturbation map\" to explicitly show the equality P = D. Let\n2\nT : RN \u2192 RN \u00d7 RN be the linear map defined as\n\uf8eb\uf8eb\n\uf8f6\n\uf8f6N\n!N\nN\nN\n\u0010\n\u0011\nX\nX\n\u0001\n\uf8ec\n\uf8f7\n\u03c0(i, j)\uf8f8\nT \u03c0(i, j) 1\u2264i,j\u2264N = \uf8ed\uf8ed\n\u03c0(i, j)\n,\n\uf8f8\nj=1\n\ni=1\n\ni=1\n\nj=1\n\nso that the problem (1) now can be phrased as\nhc, \u03c0i =\n\nN X\nN\nX\n\nc(i, j) \u03c0(i, j) \u2192 min,\n\n2\n\n\u03c0 \u2208 RN+ ,\n\ni=1 j=1\n\nunder the constraint\n\u0001\nT (\u03c0) = (N \u22121 , . . . , N \u22121 ), (N \u22121 , . . . , N \u22121 ) .\n\nThe range of the linear map T is the subspace E \u2286 RN \u00d7 RN , of codimension 1, formed by\nN\nN\nP\nP\ng(j), in other words E\u03bc [f ] = E\u03bd [g]. We consider T\nf (i) =\nthe pairs (f, g) such that\ni=1\n\nas a map from R\n\nN2\n\nj=1\n\nto E and denote by E+ the positive orthant of E.\n\n3\n\n\fLet \u03a6 : E+ \u2192 [0, \u221e] be the map\nn\no\n2\n\u03a6(f, g) = inf hc, \u03c0i, \u03c0 \u2208 RN+ , T (\u03c0) = (f, g) .\n\nWe shall verify explicitly that \u03a6 is an R+ -valued, convex, lower semi-continuous, positively\nhomogeneous map on E+ .\nThe finiteness and positivity of \u03a6 follow from the fact that, for (f, g) \u2208 E+ , the set of\n2\n\u03c0 \u2208 RN\n+ with T (\u03c0) = (f, g) is non-empty and from the non-negativity of c. As regards\n2\nthe convexity of \u03a6, let (f1 , g1 ), (f2 , g2 ) \u2208 E+ and find \u03c01 , \u03c02 \u2208 RN+ such that T (\u03c01 ) =\n(f1 , g1 ), T (\u03c02 ) = (f2 , g2 ) and hc, \u03c01 i < \u03a6(f1 , g1 ) + \u03b5 as well as hc, \u03c02 i < \u03a6(f2 , g2 ) + \u03b5. Then\n\u0012\n\u0013 \u001c\n\u001d\n\u03c01 + \u03c02\n\u03a6(f1 , g1 ) + \u03a6(f2 , g2 )\n(f1 , g1 ) + (f2 , g2 )\n\u03a6\n\u2264 c,\n<\n+ \u03b5,\n2\n2\n2\nwhich proves the convexity of \u03a6.\n\u221e\nN2\nIf ((fn , gn ))\u221e\nn=1 \u2208 E+ converges to (f, g) find (\u03c0n )n=1 in R+ such that T (\u03c0n ) = (fn , gn )\nN2\nand hc, \u03c0n i < \u03a6(fn , gn ) + n\u22121 . Note that (\u03c0n )\u221e\nn=1 is bounded in R+ , so that there is a sub2\nN\nsequence (\u03c0nk )\u221e\nk=1 converging to \u03c0 \u2208 R + . Hence \u03a6(f, g, ) \u2264 hc, \u03c0i showing the lower semicontinuity of \u03a6. Finally note that \u03a6 is positively homogeneous, i.e., \u03a6(\u03bbf, \u03bbg) = \u03bb\u03a6(f, g),\nfor \u03bb \u2265 0.\nThe point (f0 , g0 ) with f0 = g0 = (N \u22121 , . . . , N \u22121 ) is in E+ and \u03a6 is bounded in a\nneighbourhood V of (f0 , g0 ). Indeed, fixing any 0 < a < N \u22121 the subsequent set V does the\njob\nV = {(f, g) \u2208 E : |f (i) \u2212 N \u22121 | < a, |g(j) \u2212 N \u22121 | < a, for 1 \u2264 i, j \u2264 N }.\nThe boundedness of the lower semi-continuous convex function \u03a6 on V implies that the\nsubdifferential of \u03a6 at (f0 , g0 ) is non-empty. Considering \u03a6 as a function on R2N (by\nb \u2208 RN \u00d7 RN in this\ndefining it to equal +\u221e on R2N \\E+ ) we may find an element (\u03c6,\nb \u03c8)\nsubdifferential. By the positive homogeneity of \u03a6 we have\nand\n\nb (f, g)i = h\u03c6,\nb gi,\n\u03a6(f, g) \u2265 h(\u03c6,\nb \u03c8),\nb f i + h\u03c8,\n\nfor (f, g) \u2208 RN \u00d7 RN ,\n\nb g0 i.\nb f0 i + h\u03c8,\nP = \u03a6(f0 , g0 ) = h\u03c6,\n2\n\nBy the definition of \u03a6 we therefore have, for each \u03c0 \u2208 RN\n+ ,\n\nhc, \u03c0i \u2265 inf 2 {hc, \u03c0\u0303i : T (\u03c0) = T (\u03c0\u0303)}\n\u03c0\u0303\u2208RN\n+\n\n= \u03a6(T (\u03c0))\n\u2265 hT (\u03c0), (\u03c6\u0302, \u03c8\u0302)i\n=\n\nN X\nN\nX\ni=1 j=1\n\nso that\n\nb\n\u03c0(i, j) [\u03c6(i)\nb + \u03c8(j)]\n\nb\nc(i, j) \u2265 \u03c6(i)\nb + \u03c8(j),\n\nfor 1 \u2264 i, j \u2264 n.\n\n(3)\n2\n\nBy compactness, there is \u03c0\nb \u2208 \u03a0(\u03bc, \u03bd), i.e., there is an element \u03c0\nb \u2208 RN\n\u03c0) =\n+ verifying T (b\n(f0 , g0 ) such that\nb\u03c0\nhc, \u03c0\nbi = h\u03c6\nb + \u03c8,\nbi.\n(4)\n4\n\n\fb are primal and dual optimizers and that\nSumming up, we have shown that \u03c0\nb and (\u03c6,\nb \u03c8)\nb\u03c0\nthe value of the primal problem equals the value of the dual problem, namely h\u03c6\nb + \u03c8,\nb i.\nTo finish this elementary treatment of the finite case, let us consider the case when we\nallow the cost function c to take values in [0, \u221e] rather than in [0, \u221e[. In this case the\nprimal problem simply loses some dimensions: for the (i, j)'s where c(i, j) = \u221e we must\nhave \u03c0(i, j) = 0 so that we consider\nhc, \u03c0i :=\n\nN X\nN\nX\n\n\u03c0(i, j) c(i, j) \u2192 min,\n\n2\n\n\u03c0 \u2208 RN+ ,\n\ni=1 j=1\n\n2\n\nwhere we now optimize over \u03c0 \u2208 RN\n+ with \u03c0(i, j) = 0 if c(i, j) = \u221e. For the problem to\nmake sense we clearly must have that there is at least one \u03c0 \u2208 \u03a0(\u03bc, \u03bd) with hc, \u03c0i < \u221e. If this\nnon-triviality condition is satisfied, the above arguments carry over without any non-trivial\nmodification.\nWe now analyze explicitly the well-known \"complementary slackness conditions\" and\nb of primal and dual optimizers\ninterpret them in the present context. For a pair \u03c0\nb and (\u03c6,\nb \u03c8)\nwe have\nb\nc(i, j) > \u03c6(i)\nb + \u03c8(j)\n\u21d2 \u03c0\nb (i, j) = 0,\nand\n\nb\n\u03c0\nb(i, j) > 0 \u21d2 c(i, j) = \u03c6(i)\nb + \u03c8(j).\n\nIndeed, these relations follow from the admissibility condition c \u2265 \u03c6\u0302 + \u03c8\u0302 and the duality\nb = 0.\nrelation hb\n\u03c0 , c \u2212 (\u03c6\nb + \u03c8)i\nThis motivates the following definitions in the theory of optimal transport (see, e.g.,\n[RR96] for (a) and [ST08] for (b).)\nDefinition 2.1. Let X = Y = {1, . . . , N } and \u03bc = \u03bd the uniform distribution on X and Y\nrespectively, and let c : X \u00d7 Y \u2192 R + be given.\n(a) A subset \u0393 \u2286 X \u00d7 Y is called \"cyclically c-monotone\" if, for (i1 , j1 ), . . . , (in , jn ) \u2208 \u0393 we\nhave\nn\nX\n\nc(ik , jk ) \u2264\n\nk=1\n\nn\nX\n\nc(ik , jk+1 ),\n\n(5)\n\nk=1\n\nwhere jn+1 = j1 .\n(b) A subset \u0393 \u2286 X \u00d7 Y is called \"strongly cyclically c-monotone\" if there are functions\n\u03c6, \u03c8 such that \u03c6(i) + \u03c8(j) \u2264 c(i, j), for all (i, j) \u2208 X \u00d7 Y , with equality holding true\nfor (i, j) \u2208 \u0393.\nIn the present finite setting, the following facts are rather obvious (assertion (iii) following\nfrom the above discussion):\n(i) The support of each primal optimizer \u03c0\nb is cyclically c-monotone.\n\n(ii) Every \u03c0 \u2208 \u03a0(\u03bc, \u03bd) which is supported by a cyclically c-monotone set \u0393, is a primal\noptimizer.\n\n(iii) A set \u0393 \u2286 X \u00d7 Y is cyclically c-monotone iff it is strongly cyclically c-monotone.\n\n5\n\n\fIn general, one may ask, for a given Monge\u2013Kantorivich transport optimization problem,\ndefined on polish spaces X, Y , equipped with Borel probability measures \u03bc, \u03bd, and a Borel\nmeasurable cost function c : X \u00d7 Y \u2192 [0, \u221e], the following natural questions:\n(P) Does there exist a primal optimizer to (1), i.e. a Borel measure \u03c0\nb \u2208 \u03a0(\u03bc, \u03bd) with\nmarginals \u03bc, \u03bd, such that\nZ\nZ\nc db\n\u03c0 = inf\nc d\u03c0 =: P\nX\u00d7Y\n\n\u03c0\u2208\u03a0(\u03bc,\u03bd)\nX\u00d7Y\n\nholds true?\nb in \u03a8(\u03bc, \u03bd) such that\n(D) Do there exist dual optimizers to (2), i.e. Borel functions (\u03c6,\nb \u03c8)\n\uf8eb\n\uf8f6\nZ\nZ\nZ\nZ\n\uf8ed \u03c6 d\u03bc + \u03c8 d\u03bd \uf8f8 =: D,\n\u03c6\nb d\u03bc + \u03c8b d\u03bd =\nsup\n(6)\nX\n\nY\n\n(\u03c6,\u03c8)\u2208\u03a8(\u03bc,\u03bd)\n\nX\n\nY\n\nwhere \u03a8(\u03bc, \u03bd) denotes the set of all pairs of [\u2212\u221e, +\u221e[-valued integrable Borel functions\n(\u03c6, \u03c8) on X, Y such that \u03c6(x) + \u03c8(y) \u2264 c(x, y), for all (x, y) \u2208 X \u00d7 Y ?\n\n(DG) Is there a duality gap, or do we have P = D, as it should \u2013 morally speaking \u2013\nhold true?\nThese are three natural questions which arise in every convex optimization problem. In\naddition, one may ask the following two questions pertaining to the special features of the\nMonge\u2013Kantorovich transport problem.\n(CC) Is every cyclically c-monotone transport plan \u03c0 \u2208 \u03a0(\u03bc, \u03bd) optimal, where we call\n\u03c0 \u2208 \u03a0(\u03bc, \u03bd) cyclically c-monotone if there is a Borel subset \u0393 \u2286 X \u00d7 Y of full support\n\u03c0(\u0393) = 1, verifying condition (5), for any (x1 , y1 ), . . . , (xn , yn ) \u2208 \u0393?\n(SCC) Is every strongly cyclically c-monotone transport plan \u03c0 \u2208 \u03a0(\u03bc, \u03bd) optimal, where\nwe call \u03c0 \u2208 \u03a0(\u03bc, \u03bd) strongly cyclically c-monotone if there are Borel functions \u03c6 : X \u2192\n[\u2212\u221e, +\u221e[ and \u03c8 : Y \u2192 [\u2212\u221e, +\u221e[, satisfying \u03c6(x) + \u03c8(y) \u2264 c(x, y), for all (x, y) \u2208 X \u00d7 Y ,\nand \u03c0{\u03c6 + \u03c8 = c} = 1?\nMuch effort has been made over the past decades to provide increasingly general answers\nto the questions above. We mention the work of R\u00fcschendorf [R\u00fcs96] who adapted the\nnotion of cyclical monotonicity from Rockafellar [Roc66]. Rockafellar's work pertains to\nthe case c(x, y) = \u2212hx, yi, for x, y \u2208 Rn , while R\u00fcschendorf's work pertains to the present\nsetting of general cost functions c, thus arriving at the notion of cyclical c-monotonicity.\nIntimately related is the notion of the c-conjugate \u03c6c of a function \u03c6.\nWe also mention G. Kellerer's fundamental work on the duality theory; in [Kel84] he\nestablished that P = D provided that c : X \u00d7 Y \u2192 [0, \u221e] is lower semi-continous, or merely\nBorel-measurable and uniformly bounded.\nThe seminal paper [GM96] proves (among many other results) that we have a positive answer to question (CC) above in the following situation: every cyclically c-monotone\ntransport plan is optimal provided that the cost function c is continuous and X, Y are compact subsets of Rn . In [Vil03, Problem 2.25] it is asked whether this extends to the case\nX = Y = Rn with the squared euclidian distance as cost function. This was answered independently in [Pra08] and [ST08]: the answer to (CC) is positive for general polish spaces X\nand Y , provided that the cost function c : X \u00d7 Y \u2192 [0, \u221e] is continuous ([Pra08]) or lower\n6\n\n\fsemi-continuous and finitely valued ([ST08]). Indeed, in the latter case, a transport plan is\noptimal if and only if it is strongly c-monotone.\nLet us briefly resume the state of the art pertaining to the five questions above.\nAs regards the most basic issue, namely (DG) pertaining to the question whether duality\nmakes sense at all, this is analyzed in detail - building on a lot of previous literature - in\nsection 2 of the accompanying paper [BLS09]: it is shown there that, for a properly relaxed\nversion of the primal problem, question (DG) has an affirmative answer in a perfectly general\nsetting, i.e. for arbitrary Borel-measurable cost functions c : X \u00d7 Y \u2192 [0, \u221e] defined on the\nproduct of two polish spaces X, Y , equipped with Borel probability measures \u03bc, \u03bd.\nAs regards question (P) we find the following situation: if the cost function c : X \u00d7 Y \u2192\n[0, \u221e] is lower semi-continuous, the answer to question (P) is always positive. Indeed, for\nan optimizing sequence (\u03c0n )\u221e\nn=1 in \u03a0(\u03bc, \u03bd), one may apply Prokhorov's theorem to find a\nweak limit \u03c0\nb = limk\u2192\u221e \u03c0nk . If c is lower semi-continuous, we get\nZ\nZ\nc db\n\u03c0 \u2264 lim\nc d\u03c0nk ,\nk\u2192\u221e\nX\u00d7Y\n\nX\u00d7Y\n\nwhich yields the optimality of \u03c0\nb.\nOn the other hand, if c fails to be lower semi-continuous, there is little reason why a\nprimal optimizer should exist (see, e.g., [Kel84, Example 2.20]).\nAs regards (D), the question of the existence of a dual optimizer is more delicate than\nfor the primal case (P): it was shown in [AP03, Theorem 3.2] that, for c : X \u00d7 Y \u2192 R+ ,\nsatisfying a certain moment condition, one may assert the existence of integrable optimizers\nb However, if one drops this moment condition, there is little reason why, for an\n(\u03c6,\nb \u03c8).\n1\noptimizing sequence (\u03c6n , \u03c8n )\u221e\nn=1 in (D) above, the L -norms should remain bounded. Hence\nb as shown by\nthere is little reason why one should be able to find integrable optimizers (\u03c6,\nb \u03c8)\neasy examples (e.g. [BS09, Examples 4.4, 4.5]), arising in rather regular situations.\nb whether these functions\nYet one would like to be able to pass to some kind of limit (\u03c6,\nb \u03c8),\nb\nare integrable or not. In the case when \u03c6\nb and/or \u03c8 fail to be integrable, special care then\nhas to be taken to give a proper sense to (6).\nThis situation was the motivation for the introduction of the notion of strong cyclical\nc-monotonicity in [ST08]: this notion (see (SCC) above) characterizes the optimality of\na given \u03c0 \u2208 \u03a0(\u03bc, \u03bd) in terms of a \"complementary slackness condition\", involving some\nb The crucial feature is that\n(\u03c6, \u03c8) \u2208 \u03a8(\u03bc, \u03bd), playing the role of a dual optimizer (\u03c6,\nb \u03c8).\nwe do not need any integrability of the functions \u03c6 and \u03c8 for this notion to make sense. It\nb\nwas shown in [BS09] that, also in situations where there are no integrable optimizers (\u03c6,\nb \u03c8),\none may find Borel measurables functions (\u03c6, \u03c8), taking their roles in the setting of (SCC)\nabove.\nThis theme was further developed in [BS09], where it was shown that, for \u03bc\u2297\u03bd-a.s. finite,\nBorel measurable c : X \u00d7 Y \u2192 [0, \u221e], one may find Borel functions \u03c6\nb : X \u2192 [\u2212\u221e, +\u221e)\nb\nand \u03c8 : Y \u2192 [\u2212\u221e, \u221e), which are dual optimizers if we interpret (6) properly: instead of\nconsidering\nZ\nZ\n\u03c6\nb d\u03bc + \u03c8b d\u03bd,\n(7)\nX\n\nY\n\nwhich needs integrability of \u03c8b and \u03c8b in order to make sense, we consider\nZ\nb\n(\u03c6(x)\nb\n+ \u03c8(y))\nd\u03c0(x, y),\nX\u00d7Y\n\n7\n\n(8)\n\n\fR\nwhere the transport plan \u03c0 \u2208 \u03a0(\u03bc, \u03bd) is assumed to have finite transport cost X\u00d7Y c(x, y)d\u03c0(x, y) <\n\u221e. If (7) makes sense, then its value coincides with the value of (8); the crucial feature\nis that, (8) also makes sense in cases when (7) does not make sense any more as shown in\n[BS09, Lemma 1.1]. In particular, the value of (8) does not depend\non the choice of the\nR\ntransport plan \u03c0 \u2208 \u03a0(\u03bc, \u03bd), provided \u03c0 has finite transport cost X\u00d7Y c(x, y)d\u03c0(x, y) < \u221e.\n\nb\nSumming up the preceding discussion on the existence (D) of a dual optimizer (\u03c6,\nb \u03c8):\nthis question has a \u2013 properly interpreted \u2013 positive answer provided that the cost function\nc : X \u00d7 Y \u2192 [0, \u221e] is \u03bc \u2297 \u03bd-a.s. finite ([BS09, Theorem 2]).\nBut things become much more complicated if we pass to cost functions c : X \u00d7Y \u2192 [0, \u221e]\nassuming the value +\u221e on possibly \"large\" subsets of X \u00d7 Y .\nIn [BLS09, Example 4.1] we exhibit an example, which is a variant of an example due to\nG. Ambrosio and A. Pratelli [AP03, Example 3.5], of a lower semicontinuous cost function c :\n[0, 1) \u00d7 [0, 1) \u2192 [0, \u221e], where (X, \u03bc) = (Y, \u03bd) equals [0, 1) equipped with Lebesgue measure,\nb\nfor which there are no Borel measurable functions \u03c6,\nb \u03c8b verifying \u03c6(x)\nb\n+ \u03c8(y)\n\u2264 c(x, y),\nmaximizing (8) above.\nIn this example, the cost function c equals the value +\u221e on \"many\" points of X \u00d7 Y =\n[0, 1) \u00d7 [0, 1). In fact, for each x \u2208 [0, 1[, there are precisely two points y1 , y2 \u2208 [0, 1[ such\nthat c(x, y1 ) < \u221e and c(x, y2 ) < \u221e, while for all other y \u2208 [0, 1[, we have c(x, y) = \u221e.\nIn addition, there is an optimal transport plan \u03c0\nb \u2208 \u03a0(\u03bc, \u03bd) whose support equals the set\n{(x, y) \u2208 [0, 1) \u00d7 [0, 1) : c(x, y) < \u221e}.\nIn this example one may observe the following phenomenon: while there do not exist\nBorel measurable functions \u03c6\nb : [0, 1) \u2192 [\u2212\u221e, +\u221e) and \u03c8b : [0, 1) \u2192 [\u2212\u221e, \u221e) such that\nb\n\u03c6(x)\nb\n+ \u03c8(y)\n= c(x, y) on {c(x, y) < \u221e}, there does exist a Borel function b\nh : [0, 1) \u00d7\nb\n[0, 1) \u2192 [\u2212\u221e, \u221e) such that h(x, y) = c(x, y) on {c(x, y) < \u221e} and such that b\nh(x, y) =\nlimn\u2192\u221e (\u03c6n (x) + \u03c8n (y)) where (\u03c6n , \u03c8n )\u221e\nn=1 are properly chosen, bounded Borel functions.\nThe point is that the limit holds true (only) in the norm of L1 ([0, 1[\u00d7[0, 1[, b\n\u03c0) as well as\n\u03c0\nb -a.s.\nIn other words, in this example we are able to identify some kind of dual optimizer\nb\nb\nh \u2208 L1 ([0, 1) \u00d7 [0, 1), \u03c0\nb ) which, however, is not of the form b\nh(x, y) = \u03c6(x)\nb\n+ \u03c8(y)\nfor some\nb\nBorel functions (\u03c6,\nb \u03c8), but only a \u03c0\nb-a.s. limit of such functions (\u03c6n (x) + \u03c8n (y))\u221e\nn=1 .\nIn [BLS09, Theorem 4.2] we established a result which shows that much of the positive\naspect of this phenomenon, i.e. the existence of an optimal b\nh \u2208 L1 (b\n\u03c0 ), encountered in the\ncontext of the above example, can be carried over to a general setting. For the convenience\nof the reader we restate this theorem and the notations\nrequired to formulate oit.\nn\nR\nFix a finite transport plan \u03c00 \u2208 \u03a0(\u03bc, \u03bd, c) := \u03c0 \u2208 \u03a0(\u03bc, \u03bd) : X\u00d7Y c d\u03c0 < \u221e . We denote\nby \u03a0(\u03c00 ) (\u03bc, \u03bd) the set of elements \u03c0 \u2208 \u03a0(\u03bc, \u03bd) such that \u03c0 \u226a \u03c00 and\n(\u03c00 )\n\nd\u03c0\nd\u03c00\n\nL\u221e (\u03c00 )\n\n< \u221e.\n\n\u221e\n\nNote that \u03a0\n(\u03bc, \u03bd) = \u03a0(\u03bc, \u03bd) \u2229 L (\u03c00 ) \u2286 \u03a0(\u03bc, \u03bd, c). We shall replace the usual Kantorovich optimization problem over the set \u03a0(\u03bc, \u03bd, c) by the optimization over the smaller\nset \u03a0(\u03c00 ) (\u03bc, \u03bd). Its value is\nR\nP (\u03c00 ) = inf{hc, \u03c0i = c d\u03c0 : \u03c0 \u2208 \u03a0(\u03c00 ) (\u03bc, \u03bd)}.\n(9)\n\nAs regards the dual problem, we define, for \u03b5 > 0,\nZ\nnZ\nD(\u03c00 ,\u03b5) = sup\n\u03c6 d\u03bc + \u03c8 d\u03bd : \u03c6 \u2208 L1 (\u03bc), \u03c8 \u2208 L1 (\u03bd),\nZ\no\n(\u03c6(x) + \u03c8(y) \u2212 c(x, y))+ d\u03c00 \u2264 \u03b5\nand\nX\u00d7Y\n\nD\n\n(\u03c00 )\n\n=\n\nlim D\n\n\u03b5\u21920\n\n(\u03c00 ,\u03b5)\n\n.\n\n8\n\n(10)\n\n\fDefine the \"summing\" map S by\nS : L1 (X, \u03bc) \u00d7 L1 (Y, \u03bd) \u2192 L1 (X \u00d7 Y, \u03c00 )\n(\u03c6, \u03c8) 7\u2192 \u03c6 \u2295 \u03c8,\nwhere \u03c6 \u2295 \u03c8 denotes the function \u03c6(x) + \u03c8(y) on X \u00d7 Y . Denote by L1S (X \u00d7 Y, \u03c00 ) the\nk.k1 -closed linear subspace of L1 (X \u00d7 Y, \u03c00 ) spanned by S(L1 (X, \u03bc) \u00d7 L1 (Y, \u03bd)). Clearly\nL1S (X \u00d7 Y, \u03c00 ) is a Banach space under the norm k.k1 induced by L1 (X \u00d7 Y, \u03c00 ).\nWe shall also need the bi-dual L1S (X \u00d7 Y, \u03c00 )\u2217\u2217 which may be identified with a subspace\nof L1 (X \u00d7 Y, \u03c00 )\u2217\u2217 . In particular, an element h \u2208 L1S (X \u00d7 Y, \u03c00 )\u2217\u2217 can be decomposed into\nh = hr + hs , where hr \u2208 L1 (X \u00d7 Y, \u03c00 ) is the regular part of the finitely additive measure h\nand hs its purely singular part.\nTheorem 2.2. Let c : X \u00d7 Y \u2192 [0, \u221e] be Borel measurable, and let \u03c00 \u2208 \u03a0(\u03bc, \u03bd, c) be a\nfinite transport plan. We have\nP (\u03c00 ) = D(\u03c00 ) .\n\n(11)\n\nThere is an element \u0125 \u2208 L1S (X \u00d7 Y, \u03c00 )\u2217\u2217 such that \u0125 \u2264 c and\nD(\u03c00 ) = h\u0125, \u03c00 i.\nR\nd\u03c0\n)\nsatisfies\nc d\u03c0 \u2264 P (\u03c00 ) + \u03b1 for some \u03b1 \u2265 0, then\nIf \u03c0 \u2208 \u03a0(\u03c00 ) (\u03bc, \u03bd) (identifying \u03c0 with d\u03c0\n0\n|h\u0125s , \u03c0i| \u2264 \u03b1.\n\n(12)\n\nd\u03c0\nIn particular, if \u03c0 is an optimizer of (9), then \u0125s vanishes on the set { d\u03c0\n> 0}.\n0\n1\n1\nIn addition, we may find a sequence of elements (\u03c6n , \u03c8n ) \u2208 L (\u03bc) \u00d7 L (\u03bd) such that\n\n\u03c6n \u2295 \u03c8n \u2192 \u0125r , \u03c00 -a.s.,\n\nk(\u03c6n \u2295 \u03c8n \u2212 \u0125r )+ kL1 (\u03c00 ) \u2192 0\n\nand\nlim\n\nsup\n\nlim \u2212h(\u03c6n \u2295 \u03c8n )1A , \u03c00 i = k\u0125s kL1 (\u03c00 )\u2217\u2217 .\n\n\u03b4\u21920 A\u2286X\u00d7Y,\u03c00 (A)<\u03b4 n\u2192\u221e\n\n(13)\n\nThe assertion of the theorem extends the phenomenon of [BLS09, Example 4.1] to a\ngeneral setting. There is, however, one additional complication, as compared to the situation\nof this specific example: in the above theorem we only can assert that we find the optimizer\nb\nh in L1 (b\n\u03c0 )\u2217\u2217 rather than in L1 (b\n\u03c0 ). The question arises whether this complication is indeed\nunavoidable. The purpose of the subsequent section is to construct an example showing\nthat the phenomenon of a non-vanishing singular part b\nhs of b\nh=b\nhr + b\nhs may indeed arise\nin the above setting. In addition, the example gives a good illustration of the subtleties of\nthe situation described by the theorem above.\n\n3\n\nThe singular part of the dual optimizer\n\nIn this section we refine the construction of Examples 4.1 and 4.3 in [BLS09] (which in turn\nare variants of an example due to G. Ambrosio and A. Pratelli [AP03, Example 3.2]). We\nassume that the reader is familiar with these examples and freely use the notation from this\npaper.\nIn particular, for an irrational \u03b1 \u2208 [0, 1) we write, for k \u2208 Z, 1\n\u033ak (x) = 1 + #{0 \u2264 i < k : x \u2295 i\u03b1 \u2208 [0, 12 )}\n\u2212 #{0 \u2264 i < k : x \u2295 i\u03b1 \u2208 [ 21 , 1)},\n\n(14)\n\n1 In [BLS09] the constructions are carried out for N instead of Z, but for our purposes the latter choice\nturns out to be better suited.\n\n9\n\n\fwhere, for k < 0, we mean by 0 \u2264 i < k the set {k + 1, k + 2, . . . , 0} and \u2295 denotes addition\nmodulo 1. We also recall that the function h : [0, 1) \u00d7 [0, 1) \u2192 Z is defined in [BLS09,\nExample 4.3] as\n(\n\u033ak (x), k \u2208 Z and y = x \u2295 k\u03b1\nh(x, y) =\n(15)\n\u221e,\notherwise.\nIn [BLS09, Example 4.3] we considered the [0, \u221e]-valued cost function c(x, y) := h+ (x, y),\nthe positive part of the function h. We now construct an example restricting h+ (x, y) to a\ncertain subset of [0, 1) \u00d7 [0, 1).\nExample 3.1. Consider X = Y = [0, 1) and denote by \u03bc resp. \u03bd the Lebesgue measure on\nX, resp. Y . There is an irrational \u03b1 \u2208 [0, 1) and a map \u03c4 : [0, 1) \u2192 Z such that, for\n\u03930 = {(x, x), x \u2208 [0, 1)},\n\u03931 = {(x, x \u2295 \u03b1) : x \u2208 [0, 1)},\n\u0393\u03c4 = {(x, x \u2295 \u03c4 (x)\u03b1) : x \u2208 [0, 1)}\nand letting\nc(x, y) =\n\n(\n\nh+ (x, y),\n\u221e,\n\nfor x \u2208 \u03930 \u222a \u03931 \u222a \u0393\u03c4\notherwise\n\nthe following properties are satisfied.\n(i) The maps\nT\u03b10 (x) = x,\n\nT\u03b11 (x) = x \u2295 \u03b1,\n\nT\u03b1(\u03c4 )(x) = x \u2295 (\u03c4 (x) \u03b1)\n\nare measure preserving bijections from [0, 1) to [0, 1) with respect to the Lebesgue measure (\u03bc in the present setting). Denote by \u03c00 , \u03c01 , \u03c0\u03c4 the corresponding transport plans\nin \u03a0(\u03bc, \u03bc), i.e.\n\u03c00 = (id, id)# \u03bc,\n\n\u03c01 = (id, T\u03b1 )# \u03bc,\n\n\u03c0\u03c4 = (id, T\u03b1(\u03c4 ))# \u03bc,\n\nand let \u03c0 = (\u03c00 + \u03c01 + \u03c0\u03c4 )/3.\n(ii) The transport plans \u03c00 and \u03c01 are optimal while \u03c0\u03c4 is not. In fact, we have\nhc, \u03c00 i = hc, \u03c01 i = 1 while hc, \u03c0\u03c4 i \u2265 hh, \u03c0\u03c4 i > 1.\n\n(16)\n\n(iii) There is a sequence (\u03c6n , \u03c8n )\u221e\nn=1 of bounded Borel functions such that\n(a) \u03c6n (x) + \u03c8n (y) \u2264 c(x, y), for x \u2208 X, y \u2208 Y,\nZ\n\u0010Z\n\u0011\n(b) lim\n\u03c8n (y), d\u03bd(y) = 1,\n\u03c6n (x) d\u03bc(x) +\nn\u2192\u221e\n\n(17)\n(18)\n\nY\n\nX\n\n(c) lim (\u03c6n (x) + \u03c8n (y)) = h(x, y), \u03c0-almost surely.\nn\u2192\u221e\n\n(19)\n\n(iv) Using the notation of [BLS09, Theorem 4.2] we find that for each dual optimizer\nb\nh \u2208 L1 (\u03c0)\u2217\u2217 , which decomposes as b\nh=b\nhr + b\nhs into its regular part b\nhr \u2208 L1 (\u03c0) and its\npurely singular part b\nhs \u2208 L1 (\u03c0)\u2217\u2217 , we have\nb\nhr = h, \u03c0-a.s.,\n\n(20)\n\nand the singular part b\nhs satisfies kb\nhs kL1 (\u03c0)\u2217\u2217 = hh, \u03c0\u03c4 i \u2212 1 > 0. In particular, the\nsingular part b\nhs of b\nh does not vanish. The finitely additive measure b\nhs is supported by\n\u0393\u03c4 , i.e. hb\nhs , 1\u03930 + 1\u03931 i = 0.\n10\n\n\fWe shall use a special irrational \u03b1 \u2208 [0, 1), namely\n\u221e\nX\n1\n\u03b1=\n,\nM\nj\nj=1\n\nwhere Mj = m1 m2 . . . mj = Mj\u22121 mj , and (mj )\u221e\nj=1 is a sequence of prime numbers mj \u2265 5\ntending sufficiently fast to infinity, to be specified below. We let\n\u03b1n :=\n\nn\nX\n1\n,\nMj\nj=1\n\nwhich, of course, is a rational number.\nWe will need the following lemma. We thank Leonhard Summerer for showing us the\nproof of Lemma 3.2.\nLemma 3.2. It is possible to choose a sequence m1 , m2 , . . . of primes growing arbitrarily\nfast to infinity, such that with M1 = m1 , M2 = m1 * m2 , . . . , Mn = m1 * * * mn , . . . we have,\nfor each n \u2208 N,\nn\nX\n1\nPn\n=\n,\nM\nM\nj\nn\nj=1\nwith Pn and Mn relatively prime.\nProof. We have\n\nn\nX\nm2 . . . mn + . . . + mn + 1\nPn\n1\n=\n=:\n,\nM\nM\nM\nj\nn\nn\nj=1\n\nthus Pn and Mn are relatively prime, if and only if\nm1 \u2224\n\nm2 * * * mn + m3 * * * mn + . . . +\n\nmn + 1\n\n(21)\n\nm2 \u2224\n..\n.\nmn\u22121 \u2224\n\nm3 * * * mn + . . . +\n\nmn + 1\n..\n.\nmn + 1.\n\n(22)\n(23)\n(24)\n\nWe claim that these conditions are, e.g., satisfied provided that we choose m1 , m2 , . . . such\nthat mi \u2265 3 and\nmi+1 \u2261 +1 (mi )\n\n(25)\n\nmi+j \u2261 \u22121 (mi ) if j \u2265 2.\n\n(26)\n\nfor all i \u2265 1. Indeed (25), (26) imply that for k \u2208 {1, . . . , n \u2212 1} we have modulo (mk )\nmk+1 * * * mn +\n\nmk+2 * * * mn +\n\nmk+3 * * * mn +\n\n. . .+\n\nmn +\n\n(\u00b11)+\n\n(\u00b11)+\n\n(\u22131)+\n\n. . .+\n\n(\u22121)+\n\n1\u2261\n(+1),\n\nwhere in the second line the (n \u2212 k + 1) summands start to alternate after the second term.\nThus, for even n \u2212 k, this amounts to\nmk+1 * * * mn +\n(\u22121)+\n\nmk+2 * * * mn +\n(\u22121)+\n\nmk+3 * * * mn +\n(+1)+\n\n11\n\n. . .+\n. . .+\n\nmn +\n(\u22121)+\n\n1\u2261\n(+1) \u2261 \u22121,\n\n\fwhile we obtain, for odd n \u2212 k,\nmk+1 * * * mn +\n\nmk+2 * * * mn +\n\nmk+3 * * * mn +\n\n. . .+\n\nmn +\n\n(+1)+\n\n(+1)+\n\n(\u22121)+\n\n. . .+\n\n(\u22121)+\n\n1\u2261\n(+1) \u2261 +2\n\nHence (21)-(24) are satisfied as the mn where chosen such that mn > 2.\nWe use induction to construct a sequence of primes satisfying (25) and (26). Assume that\nm1 , . . . , mi have been defined. By the chinese remainder theorem the system of congruences\nx \u2261 \u22121 (m1 ), . . . ,\n\nx \u2261 \u22121 (mi\u22121 ),\n\nx \u2261 +1 (mi )\n\nhas a solution x0 \u2208 {1, . . . , m1 . . . mi }. By Dirichlet's theorem, the arithmetic progression\nx0 + km1 . . . mi , k \u2208 N contains infinitely many primes, so we may pick one which is as large\nas we please. The induction continues.\nFor \u03b2 \u2208 [0, 1), denote by T\u03b2 : [0, 1) \u2192 [0, 1), T\u03b2 (x) := x \u2295 \u03b2 the addition of \u03b2 modulo 1.\nWith this notation we have T\u03b1Mnn = id and, by Lemma 3.2, it is possible to choose m1 , . . . , mn\nin such a way that Mn is the smallest such number in N. Our aim is to construct a function\n\u03c4 : [0, 1) \u2192 Z such that the map\n\u001a\n[0, 1) \u2192 [0, 1)\n(\u03c4 )\n,\nT\u03b1 :\n(\u03c4 )\n\u03c4 (x)\nx 7\u2192 T\u03b1 (x) = T\u03b1 (x)\ndefines, up to a \u03bc-null set, a measure preserving bijection on [0, 1), and such that the\n(\u03c4 )\ncorresponding transport plan \u03c0\u03c4 \u2208 \u03a0(\u03bc, \u03bd), given by \u03c0\u03c4 = (id, T\u03b1 )# \u03bc, has the properties\nlisted above with respect to the cost function c(x, y) which is the restriction of the function\nh+ (x, y) to \u03930 \u222a \u03931 \u222a \u0393\u03c4 . We shall do so by an inductive procedure, defining bounded Z(\u03c4 )\nvalued functions \u03c4n on [0, 1) such that the maps T\u03b1nn are measure preserving bijections on\n(\u03c4 )\n(\u03c4 )\n[0, 1). The map T\u03b1 then will be the limit of these T\u03b1nn .\nStep n=1: Fix a prime M1 = m1 \u2265 5, so that \u03b11 =\nIk1 :=\n\nh\n\nk1 \u22121 k1\nM1 , M1\n\n\u0011\n\n1\nM1 .\n\nDefine\n\n, k1 = 1, . . . , M1 ,\n\n1\nso that (Ik1 )M\nk1 =1 forms a partition of [0, 1) and T\u03b11 maps Ik1 to Ik1 +1 , with the convention\nIM1 +1 = I1 . We also introduce the notations\n\nL1 := [0, 21 \u2212\n\n1\n2M1 )\n\nand R1 := [ 21 +\n\n1\n2M1 , 1)\n\nfor the segments left and right of the middle interval\n1\nImiddle\n:= I(M1 +1)/2 = [ 12 \u2212\n\n1\n1\n2M1 , 2\n\n+\n\n1\n2M1 ).\n\nWe define the functions \u03c61 , \u03c8 1 on [0, 1) such that \u03c61 (x) + \u03c8 1 (x) \u2261 1 and\n\uf8f1\n1\n\uf8f4\n\uf8f20 x \u2208 L\n1\n1\n1\n\u03c6 (x) + \u03c8 (T\u03b11 (x)) = 1 x \u2208 Imiddle\n\uf8f4\n\uf8f3\n2 x \u2208 R1\n\nwhich leads to the relation\n\n\uf8f1\n\uf8f4\nx \u2208 L1 ,\n\uf8f21,\n1\n1\n1\n\u03c6 (T\u03b11 (x)) = \u03c6 (x) + 0,\nx \u2208 Imiddle\n,\n\uf8f4\n\uf8f3\n1\n\u22121, x \u2208 R .\n12\n\n\fMaking the choice \u03c61 \u2261 0 on I1 this leads to\n(\nk1 \u2212 1,\nx \u2208 Ik1 , k1 \u2208 {1, . . . , (M1 + 1)/2},\n1\n\u03c6 (x) =\nM1 + 1 \u2212 k1 , x \u2208 Ik1 , k1 \u2208 {(M1 + 3)/2, M1 },\n\n(27)\n\n\u03c8 1 (x) = 1 \u2212 \u03c61 (x).\nThe function \u03c61 starts at 0, increases until the middle interval, stays constant when stepping\nto the interval right of the middle, and then decreases, reaching 1 on the final interval IM1 .\nThe idea is to define the map \u03c41 : [0, 1) \u2192 Z in such a way that the map\n\u001a\n[0, 1) \u2192 [0, 1)\nT\u03b1(\u03c411 ) :\n,\n\u03c4 (x)\nx 7\u2192 T\u03b111 (x)\nis a measure preserving bijection enjoying the following property: the map\nx 7\u2192 \u03c61 (x) + \u03c8 1 (T\u03b1(\u03c411 ) (x)),\nequals the value two on a large set while it has concentrated a negative mass which is close\nto \u22121 on a small set.\nThis can be done, e.g., by shifting the first interval I1 to the interval I(M1 \u22121)/2 , which is left\nof the middle one, while we shift the intervals I2 , . . . , I(M1 \u22121)/2 by one interval to the left.\nOn the right hand side of [0, 1) we proceed symmetrically while the middle interval simply\nis not moved.\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n0\n\n|\n\n|\n\n|\n\n|\n\n|\n\n1\n\n1\nImiddle\n\nL1\nI1\n\nI2\n\nR1\nI M1 \u22121\n\nI M1\n\n2\n\nFig. 1. Representations of \u03c61 and \u03c4 1 .\n(\u03c4 )\n\nThe step function is \u03c61 and the arrows indicate the action of T\u03b111 . This figure corresponds\nto the value M1 = 11.\nMore precisely, we set\n\uf8f1\nM1 \u22123\n\uf8f4\n\uf8f4 2 ,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\u22121,\n\u03c41 (x) = 0,\n\uf8f4\n\uf8f4\n\uf8f4\n1,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\u2212 M1 \u22123 ,\n2\n\nx \u2208 I1 ,\nx \u2208 Ik1 , k1 \u2208 {2, . . . , (M1 \u2212 1)/2},\nx \u2208 I(M1 +1)/2 ,\nx \u2208 Ik1 , k1 \u2208 {(M1 + 3)/2, . . . , M1 },\nx \u2208 IM1 .\n13\n\n(28)\n\n\f(\u03c4 )\n\nThen T\u03b111 induces a permutation of the intervals (Ik1 )kM11=1 and a short calculation shows\nthat\n\uf8f1\n2,\nx \u2208 Ik1 , k1 \u2208 {2, . . . , (M1 \u2212 1)/2,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n(M1 + 3)/2, . . . , M1 \u2212 1},\n\u03c61 (x) + \u03c8 1 (T\u03b1(\u03c411 ) (x)) =\n(29)\nM\n\u22125\n1\n\uf8f4\n\u2212 2 , x \u2208 Ik1 , k1 = 1, M1 ,\n\uf8f4\n\uf8f4\n\uf8f3\n1,\nx \u2208 I(M1 +1)/2 .\n\nNext figure is a representation of this \"quasi-cost\" at level n = 1, with the same value\nM1 = 11 as in Figure 1.\n\n2\n1\n\n+\n\n0\n\n+ |\n\n+\n\n|\n\n0\n\n\u2212 M12\u22125\n\n|\n\n|\n\n1\nImiddle\n\n1\n\n+\n\nFig. 2.\n\n(\u03c4 )\n\nRepresentation of \u03c61 + \u03c8 1 \u25e6 T\u03b111 .\n\nAssessment of Step n = 1. Let us resume what we have achieved in the first induction step.\nFor later use we formulate things only in terms of \u03c61 (*) rather than \u03c8 1 (*) = 1 \u2212 \u03c61 (*).\nM+3\n2\nFor the set J1g = {2, . . . , M\u22121\n2 } \u222a { 2 , . . . , M1 \u2212 1} of \"good indices\" we have\n\u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411 ) (x)) = 1,\n\nx \u2208 Ik1 , k1 \u2208 J1g ,\n\n(30)\n\nwhile for the set J1s = {1, M1 } of \"singular indices\" we have\n\u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411 ) (x)) = \u2212\nso that\n\nX Z\n\nM1 \u2212 3\n,\n2\n\n[\u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411 ) (x))] dx = \u2212\n\nk1 \u2208J1s I\nk1\n\nx \u2208 Ik1 , k1 \u2208 J s ,\n\n(31)\n\n3\nM1 \u2212 3 2\n= \u22121 +\n.\n2\nM1\nM1\n\n1\nFor the middle interval Imiddle\n= I(M1 +1)/2 we have \u03c61 (x) \u2212 \u03c61 (T\u03b1\u03c411 (x)) = 0.\n\u03c41 (x)\n1\nnever visits Imiddle\n. Here\nWe also note for later use that, for x \u2208 [0, 1), the orbit (T\u03b1i 1 (x))i=1\nwe mean that i runs through {\u03c41 (x), \u03c41 (x) + 1, . . . , \u22121} when \u03c41 (x) < 0 and runs through\nthe empty set when \u03c41 (x) = 0.\n\nStep n=2: We now pass from \u03b11 = M11 to \u03b12 = M11 + M12 , where M2 = M1 m2 = m1 m2 and\nwhere m2 , to be specified below, satisfies the relations of Lemma 3.2 and is large compared\nto M1 . For 1 \u2264 k1 \u2264 M1 and 1 \u2264 k2 \u2264 m2 we denote by Ik1 ,k2 the interval\n\u0011\nh\nk2 \u22121 k1 \u22121\nk2\n1 \u22121\n+\n,\n+\nIk1 ,k2 = kM\nM2\nM1\nM2 .\n1\n2 We\n\nuse the term \"good\" rather than \"regular\" as the abbreviation r is already taken by the word \"right\".\n\n14\n\n\f1\n), R2 = [ 21 +\nSimilarly as above we will also use the notations L2 = [0, 12 \u2212 2M\n2\n1\n1\n2\nImiddle\n= I(M1 +1)/2,(m2 +1)/2 = [ 21 \u2212 2M\n, 1 + 2M\n).\n2 2\n2\n2\n2\n2\nWe now define functions \u03c6 , \u03c8 such that \u03c6 (x) + \u03c8 2 (x) \u2261 1 and\n\uf8f1\n2\n\uf8f4\n\uf8f20, x \u2208 L ,\n2\n2\n2\n\u03c6 (x) + \u03c8 (T\u03b12 (x)) = 1, x \u2208 Imiddle\n,\n\uf8f4\n\uf8f3\n2\n2, x \u2208 R .\n\n1\n2M2 , 1),\n\nThis is achieved if we set, e.g., \u03c62 \u2261 0 on I1,1 , and\n\uf8f1\n\uf8f4\nx \u2208 L2 ,\n\uf8f21\n2\n\u03c62 (T\u03b12 (x)) = \u03c62 (x) + 0\nx \u2208 Imiddle\n,\n\uf8f4\n\uf8f3\n\u22121 x \u2208 R2 ,\n\nand\n\n(32)\n\n\u03c8 2 (x) = 1 \u2212 \u03c62 (x).\n\nYet another way to express this is to say that for j \u2208 {0, . . . , M2 \u2212 1} we have\n\u03c62 (T\u03b1j 2 (x)) = #{i \u2208 {0, . . . , j \u2212 1} : T\u03b1i 2 (x) \u2208 L2 }\n\u2212 #{i \u2208 {0, . . . , j \u2212 1} : T\u03b1i 2 (x) \u2208 R2 }\n\n,\n\nx \u2208 I1,1 ,\n\n(33)\n\nin analogy to (14).\nWhile the function \u03c61 (x) in the first induction step was increasing from I1 to I(M1 +1)/2\nand then decreasing from I(M1 +3)/2 to IM1 , the function \u03c62 (x) displays a similar feature on\neach of the intervals Ik1 : roughly speaking, i.e. up to terms controlled by M1 , it increases\non the left half of each such interval and then decreases again on the right half. The next\nlemma makes this fact precise. We keep in mind, of course, that m2 will be much bigger\nthan M1 .\nLemma 3.3 (Oscillations of \u03c62 ). The function \u03c62 defined in (32) has the following properties.\n(i) |\u03c62 (x) \u2212 \u03c62 (x \u2295\n\n1\nM2 )|\n\n\u2264 4M12 ,\n\nx \u2208 [0, 1).\n\n\u2032\u2032\n\n(ii) For each 1 \u2264 k1\u2032 , k1 \u2264 M1 we have\n\u03c62 |Ik\u2032 ,(m\n1\n\n2 +1)/2\n\n\u2212 \u03c62 |Ik\u2032\u2032 ,1 \u2265\n1\n\nm2\n2M1\n\n\u2212 10M13 .\n\nProof. Let us begin with the proof of (i).\n\u2022 Proof of (i). While T\u03b1M1 1 = id holds true, we have that T\u03b1M2 1 is only close to the identity\n2 +1\nmap. In fact, as T\u03b12 (x) = x \u2295 mM\n, we have\n2\nT\u03b1M2 1 (x) = x \u2295\n\nM1\nM2 .\n\n(34)\n\nSomewhat less obvious is the fact that T\u03b1m22 \u22122 also is close to the identity map. In fact\nT\u03b1m22 \u22122 (x) = x \u2296\n\n2\nM2 .\n\nIndeed, by (25) applied to i = 1, there is c \u2208 N such that m2 = cM1 + 1. Hence\nm2 + 1\nM2\nm2 + 1\n= x \u2295 (cM1 \u2212 1)\nM2\ncM2 \u2212 m2 + (m2 \u2212 2)\n2\n= x\u2295\n= x\u2296\n.\nM2\nM2\n\nT\u03b1m22 \u22122 (x) = x \u2295 (m2 \u2212 2)\n\n15\n\n(35)\n\n\fHere is one more remarkable feature of the map T\u03b1m22 \u22122 .\n1\n2 \u22122\nClaim: For x \u2208 [0, 1) the orbit (T\u03b1i (x))m\nvisits the intervals L2 = [0, 21 \u2212 2M\n) and\ni=1\n2\n1\n1\n2\nR = [ 2 + 2M2 , 1) approximately equally often. More precisely, the difference of the visits of\nthese two intervals is bounded in absolute value by 4M1 .\n2\nIndeed, by Lemma 3.2, the orbit (T\u03b1i 2 (x))M\ni=1 visits each of the intervals Ik1 ,k2 exactly one\n2\n2\ntime so that it visits L and R equally often, namely M22\u22121 times. The M1 many disjoint\n\u0010\n\u0001m2 \u22122 \u0011M1\nj(m \u22122)\nof this orbit are obtained by shifting them successively\nT\u03b1i 2 (x) i=1\nsubsets T\u03b12 2\nj=1\n\u0010\n\u0001m2 \u22122 \u0011M1\nj(m2 \u22122)\ni\n2\n(x)\nT\n\\\nT\nby 2/M2 to the left (35). As the difference (T\u03b1i 2 (x))M\nconsists\n\u03b1\n2\n\u03b12\ni=1\ni=1\nj=1\n\u0010\n\u0001m2 \u22122 \u0011M1\nj(m \u22122)\nT\u03b1i 2 (x) i=1\nonly of 2M1 many points we have that the difference of the visits of T\u03b12 2\n\nj=1\n\nm2 \u22122\nto L2 and R2 is bounded by 4M1 . This implies that the difference of the visits of (T\u03b1i 2 (x))i=1\nto L2 and R2 can be estimated by 4M1 too: indeed, if this orbit visits 4M1 + k many times\n2 \u22122\nvisits L2 at\nL2 more often then R2 (or vice versa) for some k \u2265 0, then (T\u03b1m22 \u22122 (T\u03b1i 2 (x)))m\ni=1\nM1 (m2 \u22122)\ni\n2\n2 \u22122\n(T\u03b12 (x)))m\nleast 4M1 + k \u2212 4 many times more often than R etc. and finally (T\u03b12\ni=1\n2\n2\nvisits L at least k many times more often than R which yields a contradiction. Hence we\nhave proved the claim.\nTo prove assertion (i) note that by (34) and (35)\nM1 \u22121\n\nT\u03b12 2\n\n(m2 \u22122)\n\n\u25e6 T\u03b1M2 1 (x) = x \u2295\n\n1\nM2\n\n(36)\nM1 \u22121\n\n(m2 \u22122)+M1\n\nWe deduce from the claim that the difference of the visits of the orbit (T\u03b1i 2 )i=02\nto L2 and R2 is bounded in absolute value by M12\u22121 (4M1 ) + M1 which proves (i).\n\n\u2022 Proof of (ii). As regards (ii) suppose first k1\u2032 = k1\u2032\u2032 =: k1 . Note that, for x \u2208 Ikleft\n:=\n1\nM1 \u22121\nk1 \u22121 k1 \u22121\n2M1 +1\n1\ni\n2\n[ M1 , M1 + 2M1 \u2212 2M2 ), we have that the orbit (T\u03b12 (x))x=0 visits L one time more\noften than R2 , namely M12+1 versus M12\u22121 times. If we start with x \u2208 Ik1 ,1 then, for\nm2\n\n(\u230a\n\n\u230b\u22121)M1\n\nm2\n1\n1 \u2264 j < 2M\n,\n\u2212 1 we have that T\u03b1jM\n(x) \u2208 Ikleft\n. Hence, for the orbit (T\u03b1i 2 )i=02M1\n2\n1\n1\nm2\n2\n2\nthe difference of the visits to the interval L and R equals \u230a 2M1 \u230b \u2212 1, the integer part of\nm2\nthis estimate with the estimate (i) as well as the fact that the distance\n2M1 \u2212 1. Combining\n\u0010\n\u0011\nm2\nm2 \u22121\n2M1 \u22121\n1\nbetween x \u2295 \u230a 2M1 \u230b \u2212 1 M\nM2 and x \u2295 2M2 is bounded by\nM2 , we obtain, for x \u2208 Ik1 ,1\nand y \u2208 I m2 +1 , that\nk1 ,\n\n2\n\n(\u230a\n\nm2\n\n\u03c62 (y) \u2212 \u03c62 (x) \u2265 \u03c62 (T\u03b12 2M1\n\n\u230b\u22121)M1\n\n(\u230a\n\nm2\n\n(x)) \u2212 \u03c62 (x) \u2212 \u03c62 (y) \u2212 \u03c62 (T\u03b12 2M1\n\n\u230b\u22121)M1\n\n(x))\n\nm2\n\u230b \u2212 1) \u2212 (2M1 \u2212 1)(4M12 )\n\u2265 (\u230a 2M\n1\n\n\u2265\n\nm2\n2M1\n\n\u2212 8M13 .\nk\u2032\u2032 \u2212k1\u2032\n\nPassing to the general case 1 \u2264 k1\u2032 , k1\u2032\u2032 \u2264 M1 observe that T\u03b121\nI\n\nk1\u2032\u2032 ,\n\n.\nm2 +1\n\u2032\u2032\n\u2032\n2 +k1 \u2212k1\n\nUsing again (i) we obtain estimate (ii).\n\nmaps I\n\nk1\u2032 ,\n\nm2 +1\n2\n\nto\n\nWe now are ready to do the inductive construction for n = 2. For m2 satisfying\nthe conditions of Lemma 3.1 and to be specified below, we shall define \u03c42 : [0, 1) \u2192\n{\u2212 M22\u22121 , . . . , 0, . . . , M22\u22121 }, where M2 = m2 m1 , such that the map\n\u001a\n[0, 1) \u2192 [0, 1)\nT\u03b1(\u03c422 ) :\n\u03c4 (x)\n(\u03c4 )\nx 7\u2192 T\u03b122 (x) := T\u03b122 (x)\n16\n\n\fhas the following properties.\n(\u03c4 )\n\n(i) The measure-preserving bijection T\u03b122 : [0, 1) \u2192 [0, 1) maps each interval Ik1 onto\n(\u03c4 )\nT\u03b111 (Ik1 ). It induces a permutation of the intervals Ik1 ,k2 , where 1 \u2264 k1 \u2264 M1 , 1 \u2264\nk2 \u2264 m2 .\n(ii) When \u03c42 (x) > 0, we have\n2\n/ Imiddle\n,\nT\u03b1i 2 (x) \u2208\n\ni = 0, . . . , \u03c42 (x),\n\n(37)\n\ni = \u03c42 (x), . . . , 0.\n\n(38)\n\nand, when \u03c42 (x) < 0, we have\n2\n/ Imiddle\n,\nT\u03b1i 2 (x) \u2208\n\n(iii) On the \"good\" intervals Ik1 , where k1 \u2208 J1g = {2, . . . , M12\u22121 } \u222a { M12+3 , . . . , M1 \u2212 1}, for\nwhich we have, by (30),\n\u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411 ) (x)) = 1,\nthe function \u03c42 will satisfy the estimates\n\u03bc[Ik1 \u2229 {\u03c42 6= \u03c41 }] \u2264\n\nM1\nm2 \u03bc[Ik1 ],\n\n(39)\n\nand\nX\n\nk1 \u2208J1g\n\nZ\n\nIk1\n\n|1 \u2212 \u03c62 (x) + \u03c62 (T\u03b1(\u03c422 ) (x))| dx <\n\n4M12\n.\nm2\n\n(40)\n\n(iv) On the \"singular\" intervals Ik1 , where k1 \u2208 J1s = {1, M1 }, for which we have , by (31),\n\u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411 ) (x)) = \u2212\n\nM1 \u2212 3\n,\n2\n\nwe split {1, . . . , m2 } into a set J k1 ,g of \"good\" indices, and a set J k1 ,s of \"singular\"\nindices, such that\n\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)) = 0,\n\nfor x \u2208 Ik1 ,k2 , k2 \u2208 J k1 ,g ,\n\nwhile\nm2\n+ 20M13\n\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)) < \u2212 2M\n1\n\nfor x \u2208 Ik1 ,k2 , k2 \u2208 J k1 ,s\n\nwhere J k1 ,s consists of M1 (M1 \u2212 3) many elements of {1, . . . , m2 }.\nHence we have a total \"singular mass\" of\nX\nX Z\n[\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x))] dx < \u22121 + M31 +\nk1 \u2208J1s\n\nk2 \u2208J k1 ,s\n\nIk1 ,k2\n\nc(M1 )\nm2 ,\n\n(41)\n\nwhere c(M1 ) is a constant depending only on M1 .\n1\n(v) On the middle interval Imiddle\n= I M1 +1 we simply let \u03c42 = \u03c41 = 0.\n2\n\nLet us illustrate graphically an interesting property of this construction, namely the\n(\u03c4 )\nshape of the quasi-cost function \u03c62 + \u03c8 2 \u25e6 T\u03b122 .\n\n17\n\n\f2\n1\n\n+\n\n0\n\n+ |\n\n+\n\n0\n\n|\n\n|\n\n1\nM1\n\n|\n\nM1 \u22121\nM1\n\n1\nImiddle\n\n|\n\n|\n\n1\n\nM2\n\u221d \u2212M\n2 +\n1\n\nFig. 3.\n\n(\u03c4 )\n\nShape of the quasi-cost \u03c62 + \u03c8 2 \u25e6 T\u03b122 .\n\nThe strips in this graphic representation symbolize the oscillations of the function \u03c62 + \u03c8 2 \u25e6\n(\u03c4 )\nT\u03b122 . On the\"singular\" set, it achieves values of order \u2212M2 /M12 .\nIt will sometimes be more convenient to specify to which interval Il1 ,l2 the interval Ik1 ,k2\n(\u03c4 )\nis mapped under T\u03b122 , instead of spelling out the value of \u03c42 on the interval Ik1 ,k2 . Note\nthat by Lemma 3.2, for each map associating to (k1 , k2 ) a pair (l1 , l2 ), there corresponds\nprecisely one value \u03c42 |Ik1 ,k2 : Ik1 ,k2 \u2192 {\u2212M2 + 1, . . . , 0, . . . , M2 \u2212 1} such that (37) (resp.\n(\u03c4 )\n\n(38)) is satisfied and T\u03b122 (Ik1 ,k2 ) = Il1 ,l2 .\nLet us start with a \"good\" interval Ik1 , with k1 \u2208 J1g as in (iii) above, say k1 \u2208\n{2, . . . , M12\u22121 }, for which we have \u03c41 (x) = \u22121. Then the intervals Ik1 ,2 , . . . , Ik1 ,m2 are\n\u03c4 (x)\n(x) onto the intervals Ik1 \u22121,1 , . . . , Ik1 \u22121,m2 \u22121 . Defining\nmapped under T\u03b121 (x) = T\u03b1\u22121\n2\n\u03c42 (x) = \u03c41 (x) on these intervals we get for x \u2208 Ik1 ,k2 , where 2 \u2264 k1 \u2264 M\u22121\n2 , 2 \u2264 k2 \u2264 m2 ,\n1 = \u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411 ) (x)) = \u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)).\n\n(42)\n(\u03c4 )\n\nWe still have to define the value of \u03c42 (x), for x \u2208 Ik1 ,1 . The map T\u03b122 has to map Ik1 ,1\nto the remaining gap Ik1 \u22121,m2 , which happens to be its left neighbour. We do not explicitly\ncalculate the unique number \u03c42 |Ik1 ,1 \u2208 {\u2212M2 + 1, . . . , M2 \u2212 1}, satisfying (37) (resp. (38)),\nwhich does the job, but only use the conclusion of Lemma 3.3 to find that, for x \u2208 Ik1 ,1 such\n(\u03c4 )\nthat T\u03b122 (x) \u2208 Ik1 \u22121,m2 ,\n|1 \u2212 [\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x))]| \u2264 4M12 + 1.\nThis takes care of the \"good\" intervals Ik1 , where k1 \u2208 {2, . . . , M12\u22121 }.\n\n18\n\n(43)\n\n\f1\nM2\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\nI(k1 \u22121)\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\nI k1\n\nFig. 4-a. k1 \u2208\n\nJ1g\n\non the left side.3\n\nFor the \"good\" intervals Ik1 , where k1 \u2208 { M12+3 , . . . , M1 \u2212 1} we have \u03c41 (x) = 1 so\n(\u03c4 )\nthat T\u03b121 maps the intervals Ik1 ,1 , . . . , Ik1 ,m2 \u22121 to Ik1 +1,2 , . . . , Ik1 +1,m2 . Again we define\n\u03c42 (x) = \u03c41 (x) = 1, for x in these intervals so that we obtain the identity (42), for M12+3 \u2264\n(\u03c4 )\nk1 \u2264 M1 \u2212 1 and 1 \u2264 k2 \u2264 m2 \u2212 1. Finally, T\u03b122 has to map Ik1 ,m2 to the interval Ik1 +1,1\nso that again we derive an estimate as in (43).\n1\nM1\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\nI k1\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\n|\n\nI(k1 +1)\n\nFig. 4-b. k1 \u2208 J1g on the right side.\nThis finishes item (iii) i.e. the definition of \u03c42 on the \"good\" intervals Ik1 . Noting that on\nthis set we have \u03c41 6= \u03c42 only on M1 \u2212 3 many intervals of length M12 we obtain the estimate\n(40).\nTo show (iv) let us first consider the \"singular\" interval I1 , on which we have \u03c41 (x) =\n(\u03c4 )\n(\u03c4 )\nand \u03c61 (T\u03b111 (x)) = \u03c61 (T\u03b111 (x)) \u2212 \u03c61 (x) = M12\u22123 . For the subintervals I1,k2 of I1 ,\ndefine the set of good indices as J 1,g = J 1,g,l \u222a J 1,g,r where\nM1 \u22123\n2\n\n1 \u22121)\nJ 1,g,l = { (M1 \u22123)(M\n+ 1, . . . , m22\u22121 },\n2\n\nJ 1,g,r = { m22+1 , . . . , m2 \u2212\n\n(M1 \u22123)(M1 +1)\n}.\n2\n\nLet us start by considering k2 \u2208 J 1,g,r . We define\n\u03c42 (x) = \u03c41 (x) +\n\n(M1 \u2212 3)(M1 + 1)\nM1 \u2212 3\nM1 =\n,\n2\n2\n\nx \u2208 I1,k2 , k2 \u2208 J 1,g,r .\n\n(\u03c4 )\n\nFirst note that T\u03b122 then maps the intervals I1,k2 , for k2 \u2208 J 1,g,r , to the intervals\nI M1 \u22121 , m2 +1 + (M1 \u22123)(M1 +1) , . . . , I M1 \u22121 ,m2 .\n2\n\n2\n\n2\n\n2\n\n\u03c4 (x)\u22121\n\n2\nalways lies in the right halfs of the\nObserve that, for x as above, the orbit (T\u03b1i 2 (x))i=0\nrespective intervals Ik1 .\n\u03c42 (x)\u22121\nvisits L2 and R2 respectively, for x \u2208\nLet us count how often the orbit (T\u03b1i 2 (x))i=0\nM1 \u22123\n1,g,r\n. The first \u03c41 (x) = 2 elements of this orbit are all in L2 which\nI1,k2 and k2 \u2208 J\nyields, similarly as in the induction step n = 1,\n\n\u03c62 (T\u03b1(\u03c421 ) (x)) \u2212 \u03c62 (x) = \u03c61 (T\u03b1(\u03c411 ) (x)) \u2212 \u03c61 (x) =\n\nM1 \u2212 3\n.\n2\n\n3 Figure 3 is built with the small value m = 7 for the sake of clarity of the drawing. But this value is\n2\nnot feasible since with the lowest m1 = 5, (25) implies that m2 is at least equal to 11; other requirements of\nthe construction imply that it has to be even larger.\n\n19\n\n\fBut the next M1 many elements of this orbit, namely\n\u03c4 (x)+M1 \u22121\n\n1\n(T\u03b1i 2 (x))i=\u03c4\n1 (x)\n\n1\nvisit R2 one time more often than L2 as the unique element of this orbit which lies in Imiddle\n1\nbelongs to the right half of Imiddle .\n\u03c41 (x)+\n\nThis phenomenon repeats on the orbit (T\u03b1i 2 (x))i=0\nthat\n\nM1 \u22123\n2 M1 \u22121\n\nM1 \u22123\n2\n\nfor\n\nmany times so\n\n\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)) = \u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c421 ) (x))) + \u03c62 (T\u03b1(\u03c421 ) (x)) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)\nM1 \u2212 3 M1 \u2212 3\n=\u2212\n+\n2\n2\n= 0, for x \u2208 I1,k2 and k2 \u2208 J 1,g,r .\n\n(44)\n\nThis takes care of I1,k2 with k2 \u2208 J 1,g,r .\nFor x \u2208 I1,k2 with k2 \u2208 J 1,g,l , the left half of the \"good\" intervals, we define symmetrically\n\u03c42 (x) = \u03c41 (x) \u2212\n\nM1 \u22123\n2 M1\n\n1 \u22121)\n= \u2212 (M1 \u22123)(M\n.\n2\n\n(\u03c4 )\n\nA similar analysis as above shows that T\u03b122 maps the intervals I1,k2 , where k2 \u2208 J 1,g,l , to\nthe intervals I M1 \u22121 , . . . , I M1 \u22121 m2 \u22121 (M1 \u22123)(M1 \u22121) . Hence by a symmetric reasoning we\n,1\n\n2\n\n,\n\n2\n\n2\n\n\u2212\n\n2\n\nagain obtain equality (44) for x in the intervals I1,k2 , and for k2 \u2208 J 1,g,r too.\nNow we have to deal with the \"singular\" subintervals I1,k2 , where k2 \u2208 J 1,s , and the\nsingular indices are given by\nJ 1,s\n\n= {1, . . . , m2 } \\ J 1,g\n1 \u22121)\n} \u222a {m2 \u2212\n= {1, . . . , (M1 \u22123)(M\n2\n\n(M1 \u22123)(M1 +1)\n2\n\n+ 1, . . . , m2 },\n\nwhich consists of M1 (M1 \u2212 3) many indices.\n(\u03c4 )\nThe map T\u03b122 has to map these intervals I1,k2 , where k2 \u2208 J 1,s , to the \"remaining gaps\"\n1 \u22121)\n1 +1)\nI M1 \u22121 in the interval I M1 \u22121 , where l2 \u2208 { m22+1 \u2212 (M1 \u22123)(M\n, . . . , m22+1 + (M1 \u22123)(M\n\u2212\n2\n2\n2\n\n,l2\n\n2\n\n1}. Note that the corresponding intervals I M1 \u22121\n2\n\nare \u2013 roughly speaking \u2013 in the middle\n\n,l2\n\nof the interval I M1 \u22121 , while the intervals I1,k2 , with k2 \u2208 J 1,s , are at the boundary of I1 .\n2\n\nTo define \u03c42 on I1,k2 , for k2 \u2208 J 1,s , choose any function \u03c42 taking values in {\u2212M2 +\n1, . . . , M2 \u2212 1}, satisfying (37) (resp. (38)) as above, which induces a bijection between\nthe intervals (I1,k2 )k2 \u2208J 1,s and the intervals I M1 \u22121 considered above.\n2\n\n| |\n0\nI 1,g,l\n|\n\n||\n\n|\n\n,l2\n\n|\n\n1\nM1\n\n|\n\n||\n\n|\n\nI 1,g,r\n\n|\n\n|\n\n|\n\n|\n\nI 1,s\n\n||\n\nI M1 \u22121\n\nI1\n\n2\n\nFig. 5. \u03c42 for the \"singular\" indices on the left side.\n\n20\n\n1\nImiddle\n\n\fIn this drawing, the interval I 1,g,l is the union of the intervals I1,k2 with k2 \u2208 J 1,g,l . A\nsimilar convention holds for I 1,g,r and I 1,s (which is not an interval anymore).\nFor each such \u03c42 we obtain, for x \u2208 I1,k2 , k2 \u2208 J 1,s , from Lemma 3.3\n(M1 \u2212 3)(M1 \u2212 1)\nm2\n+ 10M13 + 2\n4M12\n2M1\n2\nm2\n+ 20M14 .\n\u2264\u2212\n2M1\n\n\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)) \u2264 \u2212\n\n(45)\n\n3\n2\nIndeed, the leading term \u2212m\n2M1 and the first error term 10M1 in the first line above come\nfrom Lemma 3.3-(ii) when comparing the difference of the value of \u03c62 on the interval I1,1\nto that of I M1 \u22121 m2 +1 . For the difference of the value of \u03c62 on I1,k2 and I M1 \u22121 , for\n2\n\n,\n\n2\n\n1 \u22121)\n1 \u22121)\n, . . . , m22+1 + (M1 \u22123)(M\n}\narbitrary k2 \u2208 J and l2 \u2208 { m22+1 \u2212 (M1 \u22123)(M\n2\n2\n1 +1)\nboth cases at most (M1 \u22123)(M\ntimes\nestimate\n(i)\nof\nLemma\n3.3\nwhich\ngives\n2\nIn particular, for m2 > 40M15 , which of course we shall assume, we have that\n\n1,s\n\n2\n\n,l2\n\nwe apply for\n(45).\n\nfor x \u2208 I1,k2 , k2 \u2208 J 1,s .\n\n\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x)) \u2264 0,\n\nThere are M1 (M1 \u2212 3) = M12 \u2212 3M1 many intervals I1,k2 with k2 \u2208 J 1,s each of length 1/M2 .\nHence we may estimate the \"singular mass\" on the interval I1 by\nX Z\n\u0001\n1\nm2\n+ 20M14 (M12 \u2212 3M1 )\n[\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c422 ) (x))] dx \u2264 \u2212\n2M1\nM2\nk2 \u2208J 1,s I1,k2\n(46)\nc(M1 )\n3\n1\n+\n.\n\u2264\u2212 +\n2 2M1\n2m2\nwhere c(M1 ) is a constant depending on M1 only.4\nWe still have another \"singular\" interval at the present induction step n = 2, namely IM1 .\nThe analysis for this case is symmetric to the analysis of I1 and \u2013 after properly defining\n\u03c42 on this interval IM1 \u2013 we arrive at the same estimate (46). In total, the thus obtain (41)\nby doubling the right hand side of (46), showing that the \"singular mass\" essentially equals\n\u22121.\nFinally define the sets J2g (resp. J2s ) of \"good\" (resp. \"singular\") indices at level 2 as\nJ2g = {(k1 , k2 ) : (k1 \u2208 J1g and 1 \u2264 k2 \u2264 m2 ), or (k1 \u2208 J1s and k2 \u2208 J k1 ,g )},\nJ2s = {(k1 , k2 ) : k1 \u2208 J1s and k2 \u2208 J k1 ,2 }.\nThis finishes the inductive step for n = 2.\nGeneral inductive step. Suppose that the prime numbers m1 , . . . , mn\u22121 have been de1\nfined. We use the notation \u03b1n\u22121 = M11 + * * * + Mn\u22121\n, where Mn\u22121 = m1 * m2 * . . . * mn\u22121 .\nFor a prime mn satisfying the condition of Lemma 3.2, and to be specified below, let\nMn = m1 * . . . * mn and\n\u0014\n\u0013\n\u0014\n\u0013\n\u0013\n\u0014\n1\n1\n1\n1 1\n1\n1\n1\nn\nLn = 0, \u2212\n, Rn =\n.\n, 1 , Imiddle\n=\n, +\n+\n\u2212\n2 2Mn\n2 2Mn\n2 2Mn 2 2Mn\n4 We shall find it convenient in the sequel to write c(M , M , . . . , M ) for constants depending only on\n1\n2\ni\nthe choice of the numbers M1 , M2 , . . . , Mi . The concrete numerical value of this expression may change,\ni.e. become bigger, from one line of reasoning to the next one, but at every stage it will be clear that\nan explicit bound for the respective meaning of the constant c(M1 , M2 , . . . , Mi ) could be given, at least\nin principle. In fact, we shall always have that the constants c(M1 , M2 , . . . , Mi ) used in the sequel are\ndominated by a polynomial in the variables M1 , M2 , . . . , Mi .\n\n21\n\n\fFor 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kn \u2264 mn , let\n1 \u22121\nIk1 ,...,kn = [ kM\n+\n1\n\nk2 \u22121\nM2\n\n+ *** +\n\nkn \u22121\nMn\n\n1 \u22121\n, kM\n+\n1\n\nk2 \u22121\nM2\n\n+ *** +\n\nkn\nMn ).\n\nFor x \u2208 I1,...,1 and j \u2208 {0, . . . , Mn } we define, similarly as in (33), \u03c6n (x) = 0 and\n#{i \u2208 {0, . . . , j \u2212 1} : T\u03b1i 2 (x) \u2208 Ln }\n\n\u03c6n (T\u03b1j n (x)) =\n\n\u2212#{i \u2208 {0, . . . , j \u2212 1} : T\u03b1i 2 (x) \u2208 Rn },\nwhere \u03b1n = \u03b1n\u22121 +\n\n1\nMn\n\n(47)\n\nand Mn = Mn\u22121 mn . We also let \u03c8 n (x) = 1 \u2212 \u03c6n (x), for x \u2208 [0, 1).\n\nLemma 3.4 (Oscillations of \u03c6n ). For given M1 , . . . , Mn\u22121 there is a constant c(M1 , . . . , Mn\u22121 )\ndepending only on M1 , . . . , Mn\u22121 , such that for all mn as above we have\n(i) |\u03c6n (x) \u2212 \u03c6n (x \u2295\n\n1\nMn )|\n\n\u2264 c(M1 , . . . , Mn\u22121 ),\n\n\u2032\n\u2032\u2032\n(ii) for each 1 \u2264 k1\u2032 , k1\u2032\u2032 \u2264 M1 , . . . , 1 \u2264 kn\u22121\n, kn\u22121\n\u2264 mn\u22121 ,\n\n\u03c6n |Ik\u2032 ,...,k\u2032\n1\n\nn\u22121\n\n,(mn +1)/2\n\n\u2212 \u03c6n |I\n\n\u2032\u2032 ,...,k\u2032\u2032\nk1\n,1\nn\u22121\n\n\u2265\n\nmn\n2Mn\u22121\n\n\u2212 c(M1 , . . . , Mn\u22121 ),\n\n\u2032\n\u2032\u2032\n(iii) for each 1 \u2264 k1\u2032 , k1\u2032\u2032 \u2264 M1 , . . . , 1 \u2264 kn\u22121\n, kn\u22121\n\u2264 mn\u22121 , and 1 \u2264 kn\u2032 , kn\u2032\u2032 \u2264 mn , with\n\u2032\n\u2032\n\u2032\u2032\nmin{kn , mn \u2212 kn } < Mn\u22121 and min{kn , mn \u2212 kn\u2032\u2032 } < Mn\u22121 we have\n\n\u03c6n |I\n\nk\u2032 ,...,k\u2032\n,k\u2032\n1\nn\u22121 n\n\n\u2212 \u03c6n |I\n\nk\u2032\u2032 ,...,k\u2032\u2032\n,k\u2032\u2032\n1\nn\u22121 n\n\n\u2264 c(M1 , . . . , Mn\u22121 ).\n\n(48)\n\nProof. We may and do assume that mn \u2265 5Mn\u22121 .\n\u2022 Proof of (i). We have T\u03b1n (x) = T\u03b1n\u22121 (T1/Mn (x)) so that\nT\u03b1Mnn\u22121 (x) = x \u2295\n\nMn\u22121\nMn\n\n=x\u2295\n\n1\nmn ,\n\n(49)\n\nin perfect analogy to (34). As regards the analogue to (35) things now are somewhat more\ncomplicated. First note that there is a unique number 1 \u2264 qn\u22121 \u2264 Mn\u22121 \u2212 1 such that\n(x) = x \u2296\nT\u03b1qn\u22121\nn\u22121\n\n1\nMn\u22121\n\n,\n\nx \u2208 [0, 1).\n\n(50)\n\nIndeed, by Lemma 3.2, when qn\u22121 runs through {1, . . . , Mn\u22121 \u22121}, the left hand side assumes\nln\u22121\n, where ln\u22121 also runs through {1, . . . , Mn\u22121 \u2212 1}.\nthe values x \u2296 M\nn\u22121\nn\nClaim: Letting rn = \u230a Mmn\u22121\n\u230b, the integer part of\n\nmn\nMn\u22121 ,\n\nT\u03b1rnnMn\u22121 +qn\u22121 (x) = x \u2295\n\nand taking qn\u22121 as in (50), we have\ndn\u22121\n,\nMn\n\nwhere |dn\u22121 | < Mn\u22121 .\nIndeed, write mn as mn = rn Mn\u22121 + en\u22121 , for some 1 \u2264 en\u22121 \u2264 Mn\u22121 to obtain\n\u25e6T\nT\u03b1rnn Mn\u22121 +qn\u22121 (x) = (T\u03b1Mnn\u22121 )rn \u25e6 T\u03b1qn\u22121\nn\u22121\n\nqn\u22121\n1 (x)\nMn\n\nMn\u22121\n1\nqn\u22121\n\u2296\n\u2295\nMn\nMn\u22121\nMn\nen\u22121\n1\nqn\u22121\nmn\n\u2296\n\u2296\n\u2295\n= x\u2295\nMn\nMn\nMn\u22121\nMn\nqn\u22121 \u2212 en\u22121\ndn\u22121\n= x\u2295\n=: x \u2295\nMn\nMn\n\n= x \u2295 rn\n\n22\n\n\fwhich proves the claim.\n(1)\n(1)\nDefine sn\u22121 = qn\u22121 if dn\u22121 = qn\u22121 \u2212 en\u22121 > 0 and sn\u22121 = qn\u22121 + Mn\u22121 otherwise, to obtain\nby (49) and (50) that\n(1)\n\nrn Mn\u22121 +sn\u22121\n\nT\u03b1n\n\n(1)\n\n(x) = x \u2295\n\nln\u22121\nMn ,\n\n(1)\n\n(1)\n\nfor some ln\u22121 \u2208 {1, . . . , Mn\u22121 }. We also deduce from (49) that ln\u22121 must actually be in\n{1, . . . , Mn\u22121 \u2212 1}.\n(2)\n(2)\nRepeat the above argument to find sn\u22121 with \u22122Mn\u22121 < sn\u22121 < 2Mn\u22121 such that\n(2)\n\n2rn Mn\u22121 +sn\u22121\n\nT\u03b1n\n\n(2)\n\n(x) = x \u2295\n\nln\u22121\nMn ,\n\n(2)\n\n(j)\n\nfor some ln\u22121 \u2208 {1, . . . , Mn\u22121 \u2212 1}. Continuing in the same way, we find numbers sn\u22121 , for\n(j)\nj = 1, 2, . . . , Mn\u22121 \u2212 1 verifying \u2212jMn\u22121 < sn\u22121 < jMn\u22121 such that\n(j)\n\njrn Mn\u22121 +sn\u22121\n\nT\u03b1n\n\n(j)\n\n(x) = x \u2295\n\nln\u22121\nMn ,\n\n(51)\n\n(j)\n\nfor some ln\u22121 \u2208 {1, . . . , Mn\u22121 \u2212 1}. Note that, under the assumption mn \u226b Mn\u22121 so that\n(j) Mn\u22121 \u22121\nruns through all\nrn \u226b Mn\u22121 , the elements in (51) are all different. Therefore (ln\u22121 )j=1\nelements of {1, . . . , Mn\u22121 \u2212 1} when j runs through {1, . . . , Mn\u22121 \u2212 1}; in particular there\nmust be some j0 such that\n(j )\n\n0\nj0 rn Mn\u22121 +sn\u22121\n\nT\u03b1n\n\n(x) = x \u2295\n\n1\nMn ,\n\nin analogy to (36).\nNow observe that there is a constant c(M1 , . . . , Mn\u22121 ), depending only on M1 , . . . , Mn\u22121 ,\nrn Mn\u22121 +qn\u22121\nsuch that, for x \u2208 [0, 1), the difference of the number of visits of the orbit (T\u03b1i n (x))i=0\nto Ln and Rn is bounded in absolute value by the constant c(M1 , . . . , Mn\u22121 ). The argument\nis analogous to the corresponding one in the proof of the claim which is part of the proof of\nLemma 3.3-(i), and therefore skipped.\n(j0 )\n2\nThe numbers j0 as well as sn\u22121\nare bounded in absolute value by Mn\u22121\nso that the differ(j0 )\n\nj0 rn Mn\u22121 +s\n\nn\u22121\nto Ln and Rn are bounded in absolute\nence of the visits of the orbits (T\u03b1i n (x))i=0\nvalue by some constant c(M1 , . . . , Mn\u22121 ). This finishes the proof of assertion (i).\n\n\u2032\n\u2022 Proof of (ii). Suppose first, as in the proof of Lemma 3.3-(ii), that (k1\u2032 , . . . , kn\u22121\n) =\n\u2032\u2032\n\u2032\u2032\n(k1 , . . . , kn\u22121 ) =: (k1 , . . . , kn\u22121 ). For x \u2208 Ik1 ,...,kn\u22121 ,1 we have that each of the orbits\nMn\u22121 \u22121\njM\n+i\nn\n\u230b \u2212 1 visits Ln one time more often than Rn .\n, for j = 0, . . . , \u230a 2Mmn\u22121\n(T\u03b1n n\u22121 (x))i=0\nHence\nmn\n\u230a 2M\n\n\u03c6n (T\u03b1n\nNoting that\n\nn\u22121\n\n\u230bMn\u22121\n\nm\n\u230a 2M n\n\nT\u03b1n\n\nn\u22121\n\nn\n(x)) \u2212 \u03c6n (x) = \u230a 2Mmn\u22121\n\u230b>\n\n\u230bMn\u22121\n\nand\nmn +1\n2Mn\n\nmn\n2Mn\u22121\n\n\u2212 1.\n\nn\n\u230b MMn\u22121\n(x) = x \u2295 \u230a 2Mmn\u22121\nn\n\nn\n\u2212 \u230a 2Mmn\u22121\n\u230b MMn\u22121\n\u2264\nn\n\nMn\u22121\nMn ,\n\nwe obtain (ii) by using assertion (i), and possibly passing to a bigger constant c(M1 , . . . , Mn\u22121 ).\n\u2032\n\u2032\u2032\nFinally the passage to general (k1\u2032 , . . . , kn\u22121\n) and (k1\u2032\u2032 , . . . , kn\u22121\n) is done again, similarly as\nin the proof of Lemma 3.3, by repeated application of (i) and by passing once more to a\nbigger constant c(M1 , . . . , Mn\u22121 ).\n\n23\n\n\f\u2032\n\u2032\u2032\n\u2022 Proof of (iii). Fix 1 \u2264 k1\u2032 , k1\u2032\u2032 \u2264 M1 , . . . , 1 \u2264 kn\u22121\n, kn\u22121\n\u2264 mn\u22121 and 1 \u2264 kn\u2032 , kn\u2032\u2032 \u2264 mn\n\u2032\n\u2032\u2032\nas above. Suppose, e.g., kn \u2264 Mn\u22121 and mn \u2212 kn \u2264 Mn\u22121 , the other three cases be\u2032\u2032\u2032\n\u2032\u2032\u2032\n\u2032\u2032\n\u2032\u2032 \u2295\ning similar. Denote by (k1\u2032\u2032\u2032 , . . . , kn\u22121\n) the index so that Ik1\u2032\u2032\u2032 ,...,kn\u22121\n= Ik1\u2032\u2032 ,...,kn\u22121\n,kn\n1\n\u2032\u2032\u2032\n\u2032\u2032\u2032\n\u2032\u2032\n\u2032\u2032\nMn\u22121 , i.e. Ik1 ,...,kn\u22121 is the right neighbour of Ik1 ,...,kn\u22121 . Now find 0 \u2264 qn\u22121 < Mn\u22121\nq\nq\n\u2032\n\u2032\n\u2032\n\u2032\u2032\u2032\n\u2032\u2032\u2032\n\u2032\nmaps Ik1\u2032 ,...,kn\u22121\nHence T\u03b1n\u22121\nonto\nsuch that T\u03b1n\u22121\n,kn\nn\nn\u22121 maps Ik1 ,...,kn\u22121 onto Ik1 ,...,kn\u22121 .\n\u2032\u2032\u2032 ,k\u2032 +q\nIk1\u2032\u2032\u2032 ,...,kn\u22121\n.\nn\u22121\nn\n\u2032\u2032\n\u2032\u2032 is bounded by\nFinally note that the distance from the latter interval to Ik1\u2032\u2032 ,...,kn\u22121\n,kn\n1\n(2Mn\u22121 + Mn\u22121 ) Mn . Hence we obtain (48) by applying 2Mn\u22121 + Mn\u22121 times assertion\n(i) and using 0 \u2264 qn\u22121 < Mn\u22121 .\n\nAfter this preparation we are ready for the inductive step from n \u2212 1 to n. Suppose that\nthe following inductive hypotheses are satisfied, for 1 \u2264 l \u2264 n \u2212 1, functions \u03c4l : [0, 1) \u2192\n{\u2212Ml +1, . . . , Ml \u22121} and index sets Jlg , Jls contained in {(k1 , . . . , kl ) : 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264\nkl \u2264 ml }.\n(\u03c4\n\n)\n\nn\u22121\n: [0, 1) \u2192 [0, 1) maps the intervals Ik1 ,...,kl ,\n(i) The measure preserving bijection T\u03b1n\u22121\n(\u03c4 )\nfor 1 \u2264 l < n \u2212 1, and 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kl \u2264 ml , onto the intervals T\u03b1l l (Ik1 ,...,kl ).\nIt induces a permutation of the intervals Ik1 ,...,kn\u22121 , where 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264\nkn\u22121 \u2264 mn\u22121 .\n\n(ii) When \u03c4n\u22121 (x) > 0, we have\nn\u22121\n/ Imiddle\n,\nT\u03b1i n\u22121 (x) \u2208\n\ni = 0, . . . , \u03c4n\u22121 (x),\n\n(52)\n\ni = \u03c4n\u22121 (x), . . . , 0.\n\n(53)\n\nand, when \u03c4n\u22121 (x) < 0, we have\nn\u22121\n/ Imiddle\n,\nT\u03b1i n\u22121 (x) \u2208\n\ng\n(iii) There is a set of \"good\" indices Jn\u22121\n\u2286 {1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kn\u22121 \u2264 mn\u22121 }. For\ng\ng\n(k1 , . . . , kn\u22122 ) \u2208 Jn\u22122 we have that (k1 , . . . , kn\u22122 , kn\u22121 ) \u2208 Jn\u22121\nas well as\n\n\u03bc[Ik1 ,...,kn\u22122 \u2229 {\u03c4n\u22122 6= \u03c4n\u22121 }] \u2264\nand\nX\n\ng\n(k1 ,...,kn\u22122 )\u2208Jn\u22122\n\nZ\n\nIk1 ,...,kn\u22122\n\nMn\u22122\nmn\u22121 \u03bc[Ik1 ,...,kn\u22122 ],\n\nn\u22122 )\n(x))]\n[\u03c6n\u22122 (x) \u2212 \u03c6n\u22122 (T\u03b1(\u03c4n\u22122\n\nn\u22121 )\n(x))] dx\n\u2212 [\u03c6n\u22121 (x) \u2212 \u03c6n\u22121 (T\u03b1(\u03c4n\u22121\n\n\u2264\n\n(54)\n\n(55)\n\nc(M1 ,...,Mn\u22122 )\n.\nmn\u22121\n\ns\n(iv) There is a set of \"singular\" indices Jn\u22121\n\u2286 {(k1 , . . . , kn\u22121 ) : 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264\ng\ns\n2\nkn\u22121 \u2264 mn\u22121 }, disjoint from Jn\u22121 , such that Jn\u22121\nconsists of less than 2Mn\u22121\nmany\nelements and such that\nn\u22121 )\n(x)) \u2264 0,\n\u03c6n\u22121 (x) \u2212 \u03c6n\u22121 (T\u03b1(\u03c4n\u22121\n\nfor x \u2208 Ik1 ,...,kn\u22121\ns\nand (k1 , . . . , kn\u22121 ) \u2208 Jn\u22121\n,\n\nand\nX\n\ns\n(k1 ,...,kn\u22121 )\u2208Jn\u22121\n\nZ\n\n(56)\n\nn\u22121 )\n(x))] dx\n[\u03c6n\u22121 (x) \u2212 \u03c6n\u22121 (T\u03b1(\u03c4n\u22121\n\n(57)\n\nIk1 ,...,kn\u22121\n\n\u2264 \u22121 +\n\n3\nm1\n\nwhere c(*) are constants depending only on (*).\n24\n\n+\n\nc(M1 )\nm2\n\n+ ***+\n\nc(M1 ,...,Mn\u22122 )\n,\nmn\u22121\n\n\f1\n1\n(v) On the middle interval Imiddle\n= I 1M1 +1 we have \u03c41 = \u03c42 = * * * = \u03c4n\u22121 = 0 and Imiddle\n2\n\ng\ns\nform a partition of [0, 1).\ntogether with the intervals (Ik1 ,...,kn\u22121 )(k1 ,...,kn\u22121 )\u2208Jn\u22121\n\u222aJn\u22121\n\nWe have to define \u03c4n as well as Jng and Jns so that the above list is satisfied with n \u2212 1\nreplaced by n.\nLet us illustrate graphically some features of this construction. Namely, the fractal\nstructure of the singular set and the resulting quasi-cost.\nI M1\n\n1\nImiddle\n\nI1\nn=1\nn=2\nn=3\nn=4\n..\n.\n\nFig. 6. The fractal structure of the \"singular\" set.\nFor the sake of simplicity of the drawing, the red area which represents the singular set is\nthicker than it should be. Note also that the effective singular set is not perfectly balanced.\n\n2\n1\n\n+\n\n0\n\n+ |\n\n+\n\n|\n\n|\n\n|\n\n0\n\n1\nM1\n\nFig. 7.\n\nShape of the quasi-cost \u03c6n + \u03c8 n \u25e6 T\u03b1nn .\n\nM1 \u22121\nM1\n\n1\nImiddle\n\n|\n\n2\n+\n\u221d \u2212Mn /Mn\u22121\n\n(\u03c4 )\n\nThe strips on this graphic representation symbolize the oscillations of the function \u03c6n + \u03c8 n \u25e6\n(\u03c4 )\n2\n. Of course,\nT\u03b1nn . On the\"singular\" set, this finction achieves values of order \u2212Mn /Mn\u22121\nthe effective singular set is much more fragmented than it appears on this figure.\ng\nand simply write \u03c4\nWe start with a \"good\" interval Ik1 ,...,kn\u22121 , i.e. (k1 , . . . , kn\u22121 ) \u2208 Jn\u22121\nfor \u03c4n\u22121 |Ik1 ,...,kn\u22121 . If \u03c4 > 0, define J k1 ,...,kn\u22121 ,c , where c stands for \"change\", as {mn \u2212 \u03c4 + 1,\n. . . , mn }. This set consists of those indices kn such that the interval Ik1 ,...,kn is not mapped\n(\u03c4\n)\n(\u03c4n\u22121 )\n(Ik1 ,...,kn\u22121 ) under T\u03b1nn\u22121 . If \u03c4 < 0, we define J k1 ,...,kn\u22121 ,c as {1, . . . , |\u03c4 |}.\ninto T\u03b1n\u22121\n\n25\n\n|\n\n1\n\n\fThe complement {1, . . . , mn }\\J k1 ,...,kn\u22121 ,c is denoted by J k1 ,...,kn\u22121 ,u , where u stands for\n\"unchanged\".\nDefine \u03c4n := \u03c4n\u22121 = \u03c4 on the intervals Ik1 ,...,kn\u22121 ,kn , for kn \u2208 J k1 ,...,kn\u22121 ,u . For x in one\nof those intervals we have by (52), (53) and (47) that\nn\u22121 )\n(x)),\n\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn ) (x)) = \u03c6n\u22121 (x) \u2212 \u03c6n\u22121 (T\u03b1(\u03c4n\u22121\n\nwhich yields (54) with n \u2212 1 replaced by n.\nOn the remaining intervals Ik1 ,...,kn with kn \u2208 J k1 ,...,kn\u22121 ,c we define \u03c4n such that it takes\nconstant values in {\u2212Mn +1, . . . , Mn \u22121} on each of these intervals, such that (52) (resp. (53))\nis satisfied, and such that these intervals Ik1 ,...,kn are mapped onto the \"remaining gaps\" in\n(\u03c4n\u22121 )\nT\u03b1n\u22121\n(Ik1 ,...,kn\u22121 ).\nThe crucial observation is that the intervals Ik1 ,...,kn\u22121 ,kn where we have \u03c4n 6= \u03c4n\u22121 ,\ni.e. where kn \u2208 J k1 ,...,kn\u22121 ,c , are all on the \"boundary\" of Ik1 ,...,kn\u22121 : they are the |\u03c4 | many\nintervals on the left or right end of Ik1 ,...,kn\u22121 , depending on the sign of \u03c4. Similarly, the\n(\u03c4n\u22121 )\n(Ik1 ,...,kn\u22121 ) are the |\u03c4 | many intervals on the opposite end of\n\"remaining gaps\" in T\u03b1n\u22121\n(\u03c4n\u22121 )\nT\u03b1n\u22121 (Ik1 ,...,kn\u22121 ). Hence we may apply assertion (iii) of Lemma 3.4 to conclude that\n|\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn ) (x))| \u2264 c(M1 , . . . , Mn\u22121 ),\nfor those x \u2208 Ik1 ,...,kn\u22121 where \u03c4n (x) 6= \u03c4n\u22121 (x). Summing over all \"good intervals\" Ik1 ,...,kn\u22121 ,\ng\nwhere (k1 , . . . , kn\u22121 ) \u2208 Jn\u22121\n, we conclude that the contribution to (55), with n \u2212 1 replaced\nby n, is controlled by the following factors: Mn\u22121 , which is a bound for the number of\ng\nelements in Jn\u22121\n, times Mn\u22121 , which is a bound for |\u03c4 |, times M1n , which is the length of the\nintervals Ik1 ,...,kn , times the above found constant c(M1 , . . . , Mn\u22121 ). In total, this implies\nthe estimate (55), with n \u2212 1 replaced by n.\ns\nWe now turn to item (iv), i.e. to the \"singular\" indices: fix k1 , . . . , kn\u22121 \u2208 Jn\u22121\nand let\n\u2206\u03c6 denote the constant\nn\u22121 )\n(x)) \u2212 \u03c6n\u22121 (x),\n\u2206\u03c6 := \u03c6n\u22121 (T\u03b1(\u03c4n\u22121\n\nx \u2208 Ik1 ,...,kn\u22121 ,\n\nand again \u03c4 the constant \u03c4n\u22121 |Ik ,...,k , so that 0 \u2264 \u2206\u03c6 \u2264 |\u03c4 | < Mn\u22121 .\n1\nn\u22121\nSimilarly as for the case n = 2 define\nJ k1 ,...,kn\u22121 ,g,l = {knl , knl + 1 . . . , mn2\u22121 }, J k1 ,...,kn\u22121 ,g,r = { mn2+1 , . . . , knr }.\n\u03c4 +\u2206\u03c6M\n\n\u22121\n\nn\u22121\nand for x \u2208\nHere knr is the largest number such that, for the orbit (T\u03b1i n (x))i=\u03c4\n\u2032\nIk1 ,...,kn\u22121 ,knr , all its members lie in the right half of the respective intervals Ik1\u2032 ,...,kn\u22121\n. In\nfact, we get as in the step n = 2 that knr = mn \u2212 (\u03c4 + \u2206\u03c6Mn\u22121 ).\n\u03c4 \u2212\u2206\u03c6Mn\u22121 +1\nand for\nSimilarly knl is the smallest number such that, for the orbit (T\u03b1i n (x))i=\u03c4\n\u2032\nx \u2208 Ik1 ,...,kn\u22121 ,knl , all its members are in the left half of the respective intervals Ik1\u2032 ,...,kn\u22121\n.\nl\nWe get kn = \u03c4 \u2212 \u2206\u03c6Mn\u22121 + 1.\nNow we define \u03c4n as\n\n\u03c4n (x) = \u03c4 + \u2206\u03c6Mn\u22121 ,\n\nfor x \u2208 Ik1 ,...,kn\u22121 ,kn , kn \u2208 J k1 ,...,kn\u22121 ,g,r ,\n\n\u03c4n (x) = \u03c4 \u2212 \u2206\u03c6Mn\u22121 ,\n\nfor x \u2208 Ik1 ,...,kn\u22121 ,kn , kn \u2208 J k1 ,...,kn\u22121 ,g,l .\n\nand\nSimilarly as in (44) at step n = 2, we get for kn \u2208 J k1 ,...,kn\u22121 ,g := J k1 ,...,kn\u22121 ,g,l \u222aJ k1 ,...,kn\u22121 ,g,r ,\n\n26\n\n\fand x \u2208 Ik1 ,...,kn\u22121 ,kn that\n\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn ) (x))\n= [\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn\u22121 ) (x))] + [\u03c6n (T\u03b1(\u03c4nn\u22121 ) (x)) \u2212 \u03c6n (T\u03b1(\u03c4nn) (x))]\nn\u22121 )\n(x))] + [\u03c6n (T\u03b1(\u03c4nn\u22121) (x)) \u2212 \u03c6n (T\u03b1(\u03c4nn) (x))]\n= [\u03c6n\u22121 (x) \u2212 \u03c6n\u22121 (T\u03b1(\u03c4n\u22121\n\n= \u2212\u2206\u03c6 + \u2206\u03c6 = 0.\nWe still have to deal with the \"singular\" indices\nJ k1 ,...,kn\u22121 ,s := {1, . . . , mn } \\ J k1 ,...,kn\u22121 ,g = {1, . . . , knl \u2212 1} \u222a {knr + 1, . . . , mn },\n2\nwhich consists of 2\u2206\u03c6Mn\u22121 many indices. This number is bounded by 2Mn\u22121\nas \u2206\u03c6 \u2264\n|\u03c4 | < Mn\u22121 . These intervals have to be mapped onto the \"remaining gaps\" in the interval\n(\u03c4n\u22121 )\n(Ik1 ,...,kn\u22121 ). Make the crucial observation that, while the intervals Ik1 ,...,kn\u22121 ,kn , for\nT\u03b1n\u22121\nkn \u2208 J k1 ,...,kn\u22121 ,s , are at the boundary of Ik1 ,...,kn\u22121 , the \"remaining gaps\" are in the middle\n(\u03c4n\u22121 )\n(Ik1 ,...,kn\u22121 ). This fact is analogous to the situation for n = 1 and\nof the interval T\u03b1n\u22121\nn = 2.\nNow define \u03c4n on the intervals Ik1 ,...,kn\u22121 ,kn for kn \u2208 J k1 ,...,kn\u22121 ,s , in such a way that\n(\u03c4n )\n(\u03c4n\u22121 )\nT\u03b1n maps these intervals onto the \"remaining gaps\" in T\u03b1n\u22121\n(Ik1 ,...,kn\u22121 ) and such that\n\u03c4n is constant on each of these intervals, takes values in {\u2212Mn + 1, . . . , Mn \u2212 1} and such\nthat (52) (resp. (53)) is satisfied with n \u2212 1 replaced by n. Applying Lemma 3.4, assertion\n(ii) as well as 2(Mn\u22121 + 1)|\u03c4 | many times assertion (i) we obtain, for x \u2208 Ik1 ,...,kn\u22121 ,kn and\nkn \u2208 J k1 ,...,kn\u22121 ,s ,\nn\n\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn ) (x)) \u2264 \u2212 2Mmn\u22121\n+ c(M1 , . . . , Mn\u22121 ).\n\nAssuming that mn is sufficiently large as compared to Mn\u22121 we have that the right hand\nside is negative.\nKeeping in mind that there are 2\u2206\u03c6Mn\u22121 many indices in J k1 ,...,kn\u22121 ,s , we may estimate\nthe \"singular mass\" on the interval Ik1 ,...,kn\u22121 by\nZ\nX\n[\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn) (x))] dx\nkn \u2208J k1 ,...,kn\u22121 ,s\n\nIk1 ,...,kn\u22121 ,kn\n\nn\n+ c(M1 , . . . , Mn\u22121 )]\n\u2264 2\u2206\u03c6Mn\u22121 [\u2212 2Mmn\u22121\n\n= \u2212 M\u2206\u03c6\n[1 \u2212\nn\u22121\nWe have by the inductive hypothesis that\nZ\nX\ns\nk1 ,...,kn\u22121 \u2208Jn\u22121\n\n\u2264 \u22121 +\n\nIk1 ,...,kn\u22121\n3\nm1\n\n+\n\n1\nMn\n\nc(M1 ,...,Mn\u22121 )\n].\nmn\n\n[\u03c6n\u22121 (x) \u2212 \u03c6n\u22121 (T\u03b1(\u03c4nn\u22121) (x))] dx\n\nc(M1 )\nm2\n\n+ ***+\n\nc(M1 ,...,Mn\u22122 )\n,\nmn\u22121\n\nor, writing now \u2206\u03c6k1 ,...,kn\u22121 for the above value of \u2206\u03c6 on the interval Ik1 ,...,kn\u22121 ,\n1\nMn\u22121\n\nX\n\n\u2206\u03c6k1 ,...,kn\u22121 \u2264 \u22121 +\n\ns\nk1 ,...,kn\u22121 \u2208Jn\u22121\n\n27\n\n3\nm1\n\n+\n\nc(M1 )\nm2\n\n+ ***+\n\nc(M1 ,...,Mn\u22122 )\n.\nmn\u22121\n\n(58)\n\n\fLetting Jns :=\n\nS\n\ns\nk1 ,...,kn\u22121 \u2208Jn\u22121\n\nX\n\ns\nk1 ,...,kn \u2208Jn\n\nZ\n\nIk1 ,...,kn\n\n{(k1 , . . . , kn\u22121 , kn ) : kn \u2208 J k1 ,...,kn\u22121 ,s } we obtain from (58)\n\n[\u03c6n (x) \u2212 \u03c6n (T\u03b1(\u03c4nn ) (x))] dx\n\u2264 (\u22121 +\n= \u22121 +\n\n3\nm\u22121\n\n3\nm1\n\n+ ... +\n\n+ *** +\n\nc(M1 ,...,Mn\u22122 )\n)(1\nmn\u22121\n\nc(M1 ,...,Mn\u22122 )\nmn\u22121\n\n+\n\n\u2212\n\nc(M1 ,...,Mn\u22121 )\n)\nmn\n\nc(M1 ,...,Mn\u22121 )\n.\nmn\n\nwhere we may have increased the constant c(1, . . . , Mn\u22121 ) in the last line. This concludes\nthe inductive step.\nConstruction of the Example: Let \u03b1 = limn\u2192\u221e \u03b1n so that T\u03b1 = limn\u2192\u221e T\u03b1n is the shift by\nthe irrational number \u03b1.\nThe sequence (\u03c4n )\u221e\nn=1 of functions \u03c4n : [0, 1) \u2192 Z converges, by (54), almost surely to a\n(\u03c4 )\nZ-valued function \u03c4 = limn\u2192\u221e \u03c4n . Hence the maps (T\u03b1nn )\u221e\nn=1 converge almost surely to a\nmap\n\u001a\n[0, 1) \u2192 [0, 1)\n(\u03c4 )\nT\u03b1 :\n(\u03c4 )\n\u03c4 (x)\nx 7\u2192 T\u03b1 (x) = T\u03b1 (x).\n(\u03c4 )\n\nUsing the fact that each T\u03b1nn is a measure preserving almost sure bijection on [0, 1), it is\n(\u03c4 )\nstraightforward to check that T\u03b1 is so too.\n(\u03c4 )\nLetting \u0393\u03c4 = {(x, T\u03b1 (x)), x \u2208 [0, 1)} in analogy to the notations \u03930 = {(x, x), x \u2208\n[0, 1)} and \u03931 = {(x, T\u03b1 (x)), x \u2208 [0, 1)}, we define\n(\nh+ (x, y), if (x, y) \u2208 \u03930 \u222a \u03931 \u222a \u0393\u03c4 ,\nc(x, y) =\n\u221e\notherwise,\nwhere h is defined in (15) above. From this definition we deduce the almost sure identity,\nfor \u03c4 (x) > 0,\nh(x, T\u03b1(\u03c4 ) (x)) = #{i \u2208 {0, . . . , \u03c4 (x) \u2212 1} : T\u03b1i (x) \u2208 [0, 21 )}\n\u2212 #{i \u2208 {0, . . . , \u03c4 (x) \u2212 1} : T\u03b1i (x) \u2208 [ 12 , 1)} + 1\nn\n\nn\n\n= lim [\u03c6 (x) \u2212 \u03c6\nn\u2192\u221e\n\n(T\u03b1(\u03c4nn ) (x))]\n\n(59)\n\n+ 1,\n\na similar formula holding true for \u03c4 (x) < 0.\nAs regards the Borel functions (\u03c6n , \u03c8n )\u221e\nn=1 announced in (17), (18) and (19) above, we\nneed to slightly modify the functions (\u03c6n , \u03c8 n )\u221e\nn=1 constructed in the above induction to\nmake sure that they satisfy the inequality\n\u03c6n (x) + \u03c8n (y) \u2264 c(x, y),\n\nfor x \u2208 X, y \u2208 Y.\n\n(60)\n\nAs c = \u221e outside of \u03930 \u222a \u03931 \u222a \u0393\u03c4 it is sufficient to make sure that the following inequalities\nhold true almost surely, for x \u2208 [0, 1) :\n(0) \u03c6n (x) + \u03c8n (x) \u2264 c(x, x) = 1,\n(1) \u03c6n (x) + \u03c8n (T\u03b1 (x)) \u2264 c(x, T\u03b1 (x)) =\n(\u03c4 )\n\n(\n\n\u03c6n (x) + \u03c8n (T\u03b1(\u03c4 )(x)) \u2264 c(x, T\u03b1(\u03c4 ) (x)).\n28\n\n2, for x \u2208 [0, 12 ),\n0, for x \u2208 [ 21 , 1),\n\n\fn\nThe above constructed (\u03c6n , \u03c8 n )\u221e\nn=1 only satisfy condition (0). We still have to pass from \u03c6\nn\nto a smaller function \u03c6n \u2013 while leaving \u03c8n := \u03c8 unchanged \u2013 to satisfy (1) and (\u03c4 ) too.\nLet\n\n\u03c6n (x) := \u03c6n (x) \u2212 [\u03c6n (x) + \u03c8 n (T\u03b1 (x)) \u2212 c(x, T\u03b1 (x))]+\n\n(61)\n\n\u2212 [\u03c6n (x) + \u03c8 n (T\u03b1(\u03c4 )(x)) \u2212 c(x, T\u03b1(\u03c4 ) (x)]+ .\nClearly \u03c6n \u2264 \u03c6n and the functions (\u03c6n , \u03c8n ) satisfy the inequality (60).\n\nWe have to show that the functions \u03c6n defined in (61) satisfy that \u03c6n \u2212 \u03c6n is small in the\nnorm of L1 (\u03bc), as n \u2192 \u221e, that is\nZ\n(\u03c6n (x) \u2212 \u03c6n (x)) dx = 0,\n(62)\nlim\nn\u2192\u221e\n\n[0,1)\n\nprovided that (mn )\u221e\nn=1 increases sufficiently fast to infinity.\nWe may estimate the first correction term in (61) by\n[\u03c6n (x) + \u03c8 n (T\u03b1 (x)) \u2212 c(x, T\u03b1 (x))]+\n\u2264 [\u03c8 n (T\u03b1 (x)) \u2212 \u03c8 n (T\u03b1n (x))]+ + [\u03c6n (x) + \u03c8 n (T\u03b1n (x)) \u2212 c(x, T\u03b1 (x))]+ .\nn\nn\nThe second term above is dominated by 1Imiddle\nwhich is harmless as k1Imiddle\nkL1 (\u03bc) = M1n .\nP\u221e\nAs regards the first term, note that T\u03b1 (x) \u2296 T\u03b1n (x) = \u03b1 \u2212 \u03b1n = j=n+1 M1j which we may\n2\nn\nby assuming that (mn )\u221e\nbound by Mn+1\nn=1 increases sufficiently fast to infinity. As \u03c8 is\nconstant on each of the Mn many intervals Ik1 ,...,kn we get\n\n\u03bc{x \u2208 [0, 1) : \u03c8 n (T\u03b1 (x)) 6= \u03c8 n (T\u03b1n (x)} \u2264 Mn (\u03b1 \u2212 \u03b1n ) <\n\n2\nmn+1 .\n\nOn this set we may estimate, using only the obvious bound |\u03c8n (x)| < Mn , that\n|\u03c8 n (T\u03b1 (x)) \u2212 \u03c8 n (T\u03b1n (x))| \u2264 2Mn ,\n\nx \u2208 [0, 1),\n\nto obtain\nk\u03c8 n (T\u03b1 (x)) \u2212 \u03c8 n (T\u03b1n (x))kL1 (\u03bc) <\n\n4Mn\nmn+1 .\n\nHence for (mn )\u221e\nn=1 growing sufficiently fast to infinity, the first correction term in (61) is\nalso small in L1 -norm.\nTo estimate the second correction term in (61) note that\n\u03c6n (x) + \u03c8 n (T\u03b1(\u03c4 ) (x)) = \u03c6n (x) + \u03c8 n (T\u03b1(\u03c4nn ) (x)),\n\nfor x \u2208 [0, 1).\n\n(63)\n\n(\u03c4 )\n\nIndeed, T\u03b1nn induces a permutation between the intervals Ik1 ,...,kn and, by assertion (i) pre(\u03c4n+j )\nmaps the intervals Ik1 ,...,kn onto the intervals\nceding the formula (52), we have that T\u03b1n+j\n(\u03c4n )\nn\nT\u03b1n (Ik1 ,...,kn ), for each j \u2265 0. Noting that \u03c8 is constant on each of the intervals Ik1 ,...,kn\nwe obtain (63), by letting j tend to infinity.\n(\u03c4 )\nBy (47), \u03c6n (x) + \u03c8 n (T\u03b1nn (x)) is the number of visits to Ln minus the number of visits to\n\u03c4 (x)\n\u03c4n (x)\u22121\n. Similarly, by (15), h(x, T\u03b1 (x)) is the number of\nRn plus one, of the orbit (T\u03b1j n )j=0\n\u03c4 (x)\u22121\n\nvisits to L minus the number of visits to R plus one, of the orbit (T\u03b1j )j=0\nshow that the positive part of the difference\nfn (x) := [\u03c6n (x) + \u03c8 n (T\u03b1(\u03c4nn) (x)) \u2212 h+ (x, T\u03b1(\u03c4 ) (x))]+ ,\n\nx \u2208 [0, 1),\n\n. We have to\n(64)\n\n1\n1\n1\nis small in L1 -norm, as n \u2192 \u221e. To do so, we argue separately\non Imiddle\n= [ 21 \u2212 2M\n, 1 + 2M\n],\n1 2\n1\nS\non the union of the \"good\" intervals at level n : Gn = (k1 ,...,kn )\u2208Jng Ik1 ,...,kn , and the union\nS\nof the \"singular\" intervals at level n, Sn = (k1 ,...,kn )\u2208J s Ik1 ,...,kn .\nn\n\n29\n\n\f1\n- For x \u2208 Imiddle\n, the correction term fn (x) in (64) simply equals zero as \u03c4n (x) = \u03c4 (x) =\n0.\n\u03c4 (x)\n\n- For x \u2208 Sn , we have by (56) that \u03c6n (x) + \u03c8 n (T\u03b1nn\nhence limn\u2192\u221e kfn 1Sn kL1 (\u03bc) = 0.\n\n(x)) \u2264 1 so that fn (x) \u2264 1 too;\n\n- For x \u2208 Gn , we use\nfn (x) \u2264 [\u03c6n (x) + \u03c8 n (T\u03b1(\u03c4nn ) (x)) \u2212 h(x, T\u03b1\u03c4 (x)(x))]+\n\u221e\nX\nk\u22121 )\n\u2264\n[(\u03c6k\u22121 (x) + \u03c8 k\u22121 (T\u03b1(\u03c4k\u22121\n(x))) \u2212 (\u03c6k (x) + \u03c8 k (T\u03b1(\u03c4kk ) (x)))]+\nk=n+1\n\nand (55) to conclude that\nlim kfn 1Gn kL1 (\u03bc) \u2264 lim\n\nn\u2192\u221e\n\nn\u2192\u221e\n\n\u221e\nX\n\nc(M1 ,...,Mk\u22121 )\nmk\n\n= 0.\n\nk=n+1\n\nThis proves (62).\nHence (17), (18) and (19) are satisfied.\nAs regards assertion (16), let us verify that \u03c00 and \u03c01 are optimal transport plans.\nIndeed, it follows from (17) and (18) that the dual value of the present transport problem\nis greater than or equal to one which implies that hc, \u03c00 i = hc, \u03c01 i = 1 is the optimal primal\nvalue.\nThe fact that hc, \u03c0\u03c4 i > 1 should be rather obvious to a reader who has made it up to\nthis point of the construction. It follows from rough estimates. The set {[0, 21 ) \u2229 {\u03c4 =\nP\u221e\ni\u22121 )\n, which is\n\u22121}} \u222a {[ 21 , 1) \u2229 {\u03c4 = 1}} has measure bigger than 1 \u2212 M31 + i=2 c(M1 ,...,M\nmi\n(\u03c4 )\n\nbigger than, say, 43 , for (mn )\u221e\nn=1 tending sufficiently quick to infinity. As c(x, T\u03b1 (x)) equals\n2 on this set we get\nhc, \u03c0\u03c4 i \u2265 32 > 1.\n\nA slightly more involved argument, whose verification is left to the energetic reader, shows\nthat, for \u03b5 > 0, we may choose (mn )\u221e\nn=1 such that\nhh, \u03c0\u03c4 i \u2265 2 \u2212 \u03b5.\n\n(65)\n\nFinally, we show assertion (iv) at the beginning of this section (see (20)). Let b\nh \u2208 L1 (\u03c0)\u2217\u2217\nbe a dual optimizer in the sense of [BLS09, Theorem 4.2]. We know from this theorem that\n5\nthere is a sequence (\u03c6n , \u03c8n )\u221e\nn=1 of bounded Borel functions such that\n(\u03b1) lim k[\u03c6n \u2295 \u03c8n \u2212 c]+ kL1 (\u03c0) = 0\nn\u2192\u221e\nZ\nZ\n(\u03b2) lim ( \u03c6n (x) d\u03bc(x) +\n\u03c8n (y) d\u03bd(y)) = 1,\nn\u2192\u221e\n\nX\n\nY\n\n(\u03b3) lim \u03c6n \u2295 \u03c8n = b\nhr ,\n\n\u03c0-a.s.,\n\nn\u2192\u221e\n\n(\u03b4) \u0125 is a \u03c3(L1 (\u03c0)\u2217\u2217 , L\u221e (\u03c0)) cluster point of (\u03c6n \u2295 \u03c8n )\u221e\nn=1 .\n\n(66)\n(67)\n(68)\n(69)\n\nHere b\nh=b\nhr + b\nhs is the decomposition of b\nh \u2208 L1 (\u03c0)\u2217\u2217 into its regular part b\nhr \u2208 L1 (\u03c0) and\ns\n1\n\u2217\u2217\nb\ninto its purely singular part h \u2208 L (\u03c0) .\n\n5 The (\u03c6 , \u03c8 ) need not be the same as the special sequence constructed above; still we find it convenient\nn\nn\nto use the same notation.\n\n30\n\n\fWe shall show that b\nhr equals h, \u03c0-almost surely. Indeed by assertions (66) and (67) above\nwe have that, for x \u2208 [0, 1),\nlim (\u03c6n (x) + \u03c8n (x)) = c(x, x) = h(x, x) = 1,\n\nn\u2192\u221e\n\nand\nlim (\u03c6n (x) + \u03c8n (T\u03b1 (x))) = c(x, T\u03b1 (x)) = h(x, T\u03b1 (x)) =\n\nn\u2192\u221e\n\n(\n\n2, for x \u2208 [0, 12 ),\n0, for x \u2208 [ 12 , 1),\n\nthe limit holding true in L1 ([0, 1], \u03bc) as well as for \u03bc-a.e. x \u2208 [0, 1), possibly after passing to\na subsequence. As in the discussion following [BLS09, Theorem 4.2] this implies that, for\neach fixed i \u2208 Z,\nlim (\u03c6n (x) + \u03c8n (T\u03b1i (x))) = h(x, T\u03b1i (x)), i \u2208 Z,\nn\u2192\u221e\n\nthe limit again holding true in L1 (\u03bc) and \u03bc-a.s., after possibly passing to a diagonal subsequence. Whence, we obtain with (68) that\nhr (x, T\u03b1(\u03c4 ) (x)),\nlim (\u03c6n (x) + \u03c8n (T\u03b1(\u03c4 )(x))) = h(x, T\u03b1(\u03c4 ) (x)) = b\n\nn\u2192\u221e\n\nconvergence now holding true for \u03bc-a.e. x \u2208 [0, 1].\n(\u03c4 )\nAs x \u2192 T\u03b1 (x) is a measure preserving bijection we get\nZ\nZ\n(\u03c4 )\n(\u03c6n (x) + \u03c8n (x)) dx = 1,\n[\u03c6n (x) + \u03c8n (T\u03b1 (x))] dx =\n[0,1)\n\n[0,1)\n\nso that, using (65) we get\nZ\nlim\n[\u03c6n (x) + \u03c8n (T\u03b1(\u03c4 )(x))]1{\u03c6n (x)+\u03c8n (T (\u03c4 ) (x))<h(x,T (\u03c4 ) (x))} (x) dx\n\u03b1\n\u03b1\nn\u2192\u221e [0,1)\nZ\n[\u03c6n (x) + \u03c8n (T\u03b1(\u03c4 )(x))]1{\u03c6n (x)+\u03c8n (T (\u03c4 ) (x))\u2265h(x,T (\u03c4 ) (x))} (x) dx\n= 1 \u2212 lim\nn\u2192\u221e\n\n\u03b1\n\n[0,1)\n\n\u03b1\n\n= 1 \u2212 hh, \u03c0\u03c4 i\n< 0.\n\b\n(\u03c4 )\n(\u03c4 )\nFrom limn\u2192\u221e \u03bc x : \u03c6n (x) + \u03c8n (T\u03b1 (x)) < h(x, T\u03b1 (x)) = 0 we conclude that each \u03c3 \u2217 (\u03c4 )\n1\n\u2217\u2217\nof norm\ncluster point of ([\u03c6n (*) + \u03c8n (T\u03b1 (*))]\u2212 )\u221e\nn=1 is a purely singular element of L (\u03c0)\nequal to hh, \u03c0\u03c4 i \u2212 1.\nFinally, we still have to specify the prime numbers (mn )\u221e\nn=1 in the above induction.\nIt is now clear what we need: apart from satisfying the conditions of Lemma 3.1 as well\nas the requirements whenever we wrote \"for mn tending sufficiently fast to infinity\", we\nMn\u22122\n\u2212n\nchoose the (mn )\u221e\n, that in (55) we have\nn=1 inductively such that in (54) we have mn\u22121 < 2\nc(M1 ,...,Mn\u22122 )\nmn\u22121\n\n,...,Mn\u22122 )\n< 2\u2212n and in (57) we have m31 < 14 as well as again c(M1m\n< 2\u2212n .\nn\u22121\nHence we have shown all the assertions (i)-(iv) of Example 3.1 and the construction of\nthe example is complete.\n\n4\n\nA Relaxation of the Dual Problem\n\nAs in [BLS09, Remark 3.4], for a given cost function c : X \u00d7 Y \u2192 [0, \u221e], we consider the\nfamily of pairs of functions\n\uf8fc\n\uf8f1\n\uf8fd\n\uf8f2 (\u03c6, \u03c8) : \u03c6, \u03c8 Borel, integrable and\n\u03c6(x) + \u03c8(y) \u2264 c(x, y), \u03c0-a.s,\n\u03a8rel (\u03bc, \u03bd) =\n\uf8fe\n\uf8f3\nfor each finite transport plan \u03c0 \u2208 \u03a0(\u03bc, \u03bd, c)\n31\n\n\fand define the relaxed value of the dual problem as\nZ\nnZ\no\nDrel = sup\n\u03c8 d\u03bd : (\u03c6, \u03c8) \u2208 \u03a8rel (\u03bc, \u03bd) .\n\u03c6 d\u03bc +\n\n(70)\n\nY\n\nX\n\nUsing the notation of [BLS09] it is obvious that D \u2264 Drel and it is straightforward to verify\nthat the trivial duality inequality Drel \u2264 P still is satisfied. One might conjecture \u2013 and the\npresent authors did so for some time \u2013 that Drel = P holds true in full generality, i.e. for\narbitrary Borel measurable cost functions c : X \u00d7 Y \u2192 [0, \u221e], defined on the product of two\npolish spaces X and Y . In this section we construct a counterexample showing that this is\nnot the case, i.e. it may happen that we have a duality gap P \u2212 Drel > 0. The example will\nbe a variant of the example in the previous section, i.e. the (n + 1)'th variation of [AP03,\nExample 3.2].\n(\u03c4 )\nIn section 3 we constructed a measure preserving bijection T\u03b1 : [0, 1) \u2192 [0, 1) having\n(\u03c4n ) \u221e\ncertain properties; we now shall construct a sequence (T\u03b1 )n=0 of such maps and consider\nas cost function the restriction of h+ , where h is defined in (15) to the graphs (\u0393n )\u221e\nn=0 of\n(\u03c4 )\n.\nThis\nsequence\nalso\n\"builds\nup\na\nsingular\nmass\",\nwhich\nnow\nis\npositive\nthe maps (T\u03b1 n )\u221e\nn=0\nas opposed to the negative singular mass in the previous section, but it does so in a different\nway. We resume the properties of these maps which we shall construct in the following\nproposition.\nProposition 4.1. With the notation of section 3 there is an irrational \u03b1 \u2208 [0, 1) and a\nsequence (\u03c4n )\u221e\nn=0 of maps \u03c4n : [0, 1) \u2192 Z, with \u03c40 = 0 and \u03c41 = 1, such that the transforma(\u03c4n )\ntions T\u03b1 : [0, 1) \u2192 [0, 1), defined by\nT\u03b1(\u03c4n ) (x) = T\u03b1\u03c4n (x) (x),\n\nx \u2208 [0, 1),\n\nhave the following properties.\n(i) Each \u03c4n is constant on a countable collection of disjoint, half open intervals in [0, 1)\n(\u03c4 )\nwhose union has full measure. For n \u2265 0, the map T\u03b1 n defines a measure preserving\nalmost sure bijection of ([0, 1), \u03bc) onto itself, where \u03bc = \u03bd denotes Lebesgue measure\non [0, 1). We have, for each n \u2265 0,\nZ\nh(x, T\u03b1(\u03c4n ) (x)) dx = 1.\n(71)\n[0,1)\n\n(ii) The function\nfn (x) := h(x, T\u03b1(\u03c4n ) (x)),\n\nx \u2208 [0, 1),\n\nwhere h is defined in (15), satisfies\nkfn \u2212 gn kL1 (\u03bc) < 2\u2212n\n\n(72)\n\nwhere gn is a Borel function on [0, 1) such that\n\u03bc{gn = 0} = 1 \u2212 \u03b7n ,\n\n\u03bc{gn =\n\n1\u2212\u03b7n\n\u03b7n }\n\n= \u03b7n\n\n(73)\n\nfor some sequence (\u03b7n )\u221e\nn=1 tending to zero.\n(iii) There is a sequence (\u03c6n , \u03c8n )\u221e\nn=1 of bounded Borel functions such that, for every fixed\nn \u2208 N,\nlim kh(x, T\u03b1(\u03c4n) (x)) \u2212 [\u03c6m (x) + \u03c8m (T\u03b1(\u03c4n ) (x))]kL1 (\u03bc) = 0,\nm\u2192\u221e\n\nand\nlim\n\nn\u2192\u221e\n\nhZ\n\n\u03c6n (x) dx +\n\nZ\n\n[0,1)\n\n[0,1)\n\n32\n\ni\n\u03c8n (y) dy = 1.\n\n\f(\u03c4n ) \u221e\n)n=1\n\n(iv) The sequence (T\u03b1\n\nconverges to the identity map in the following sense:\n\n\u03b4(x, T\u03b1(\u03c4n ) (x)) < 2\u2212n ,\n\nx \u2208 [0, 1), n \u2265 1,\n\n(74)\n\nwhere \u03b4(*, *) denotes the Riemannian metric on T = [0, 1).\nWe postpone the proof of the proposition and first draw some consequences. Suppose\n(\u03c4 )\nthat \u03b1 as well as (T\u03b1 n )\u221e\nn=0 have been defined and satisfy the assertions of Proposition 4.1.\nProposition 4.2. Fix M \u2265 2 and define the cost function cM : [0, 1) \u00d7 [0, 1) \u2192 [0, \u221e] by\n(\n(\u03c4 )\n(\u03c4 )\n(\u03c4 )\nh+ (x, y), for (x, y) in the graph of T\u03b10 , T\u03b11 , T\u03b1 2 , T\u03b1 3 , . . . , T\u03b1 M ,\ncM (x, y) =\n\u221e,\notherwise.\nFor this cost function cM we find that the primal value, denoted by P M , as well as the dual\nvalue, denoted by DM , of the Monge\u2013Kantorovich problem both are equal to 1.\nIn addition, there is \u03b2 = \u03b2(M ) > 0, such that, for every partial transport\n\u03c3 \u2208 \u03a0part (\u03bc, \u03bd) := {\u03c3 : M(X \u00d7 Y ) : pX (\u03c0) \u2264 \u03bc, pY (\u03c0) \u2264 \u03bd}\nwith\nk\u03c3k \u2265\n\n2\n3\n\nand\n\nZ\n\nX\u00d7Y\n\ncM (x, y) d\u03c3(x, y) \u2264 21 ,\n\nthere is no partial transport \u033a \u2208 \u03a0part (\u03bc, \u03bd) with\nk\u03c3 + \u033ak = 1 and \u03c3 + \u033a \u2208 \u03a0(\u03bc, \u03bd)\nwith the property that \u033a is supported by\n\u2206\u03b2 = {(x, y) \u2208 [0, 1)2 : \u03b4(x, y) < \u03b2}.\nProof. First note that there is an open and dense subset G \u2286 [0, 1) of full measure \u03bc(G) = 1\nsuch that cM , restricted to G \u00d7 G is lower semi-continuous. This follows from assertion (i) of\nProposition 4.1 by replacing the half open intervals by their open interior. Noting that G is\npolish we may apply the general duality theory [Kel84] to the cost function cM restricted to\nG \u00d7 G to conclude that there is no duality gap for the cost function cM |G\u00d7G . It follows that\nthere is also no duality gap for the original setting of cM , defined on [0, 1) \u00d7 [0, 1), either.\nWe claim that, for every M \u2265 0, the value DM of the dual problem equals 1. Indeed, let\n(\u03c6n , \u03c8n )\u221e\nn=1 be a sequence as in Proposition 4.1 (iii). Defining\n\u03c6\u0303n := \u03c6n \u2212\n\nM\nX\n\n[\u03c6n (x) + \u03c8n (T\u03b1(\u03c4j ) (x)) \u2212 h(x, T\u03b1(\u03c4j ) (x))]+\n\nj=0\n\nand \u03c8\u0303n = \u03c8n , we have that\n\u03c6\u0303n (x) + \u03c8\u0303n (y) \u2264 h(x, y) \u2264 h+ (x, y),\n(\u03c4 )\n\n(\u03c4\n\n)\n\nfor all (x, y) in the graph of T\u03b10 , T\u03b11 , T\u03b1 2 , . . . , T\u03b1 M , and\nZ\ni\nhZ\n\u03c8\u0303n (y) dy = 1,\nlim\n\u03c6\u0303n (x) dx +\nn\u2192\u221e\n\nY\n\nX\n\nshowing that DM \u2265 1. It follows that DM = P M = 1.\n\n33\n\n\fNow suppose that the final assertionR of the proposition is wrong to find a sequence\npart\n(\u03c3n )\u221e\n(\u03bc, \u03bd) with k\u03c3n k \u2265 23 and X\u00d7Y cM (x, y) d\u03c3n (x, y) \u2264 21 , as well as a sequence\nn=1 \u2208 \u03a0\n\u221e\npart\n(\u033an )n=1 \u2208 \u03a0\n(\u03bc, \u03bd) with k\u03c0n + \u033an k = 1 and \u03c0n + \u033an \u2208 \u03a0(\u03bc, \u03bd) such that \u033an is supported\nby\n\u22061/n = {(x, y) \u2208 [0, 1)2 : \u03b4(x, y) <\n\n1\nn }.\n\n(75)\n\nConsidering (\u03c3n )\u221e\nn=1 as measures on the product G\u00d7G of the polish space G, we then can\nfind by Prokhorov's theorem a subsequence (\u03c3nkR)\u221e\nk=1 converging weakly on G \u00d7 G to some\n\u03c3 \u2208 \u03a0part (\u03bc, \u03bd), for which we find k\u03c3k \u2265 32 and X\u00d7Y c(x, y) d\u03c3(x, y) \u2264 21 . By passing once\nmore to a subsequence, we may also suppose that (\u033ank )\u221e\nk=1 weakly converges (as measures\non G \u00d7 G or [0, 1) \u00d7 [0, 1); here it does not matter) to some \u033a \u2208 \u03a0part (\u03bc, \u03bd) for which we get\nk\u03c3 + \u033ak = 1 and \u03c3 + \u033a \u2208 \u03a0(\u03bc, \u03bd). By (75) we conclude that \u033a induces the identity transport\nfrom its marginal\npX (\u033a) onto its marginal pY (\u033a) = pX (\u033a). As cM (x, x) = 1, for x \u2208 [0, 1) we\nR\nfind that X\u00d7Y cM (x, y) d\u033a(x, y) = k\u033ak \u2264 13 , which implies that\nZ\ncM (x, y) d(\u03c0 + \u033a)(x, y) \u2264 12 + 31 ,\na contradiction to the fact that P M = 1 which finishes the proof.\nWe now can proceed to the construction of the example.\nProposition 4.3. Assume the setting of Proposition 4.1. For a subsequence (ij )\u221e\nj=2 of\n{2, 3, . . .} we define the cost function c : [0, 1) \u00d7 [0, 1) \u2192 [0, \u221e] by\n(\n(\u03c4i )\n(\u03c4 )\n(\u03c4 )\nh+ (x, y), for (x, y) in the support of T\u03b10 , T\u03b11 , T\u03b1 i2 , T\u03b1 i3 , . . . , T\u03b1 j , . . .\nc(x, y) =\n(76)\n\u221e,\notherwise.\nIf (ij )\u221e\nj=2 tends sufficiently fast to infinity we have that, for this cost function c, the primal\nvalue P is strictly positive, while the relaxed primal value P rel (see [BLS09, Example 4.3])\nas well as the dual value D and the relaxed dual value Drel (see (70)) all are equal to 0.\nIn particular there is a duality gap P \u2212 Drel > 0, disproving the conjecture mentioned at\nthe beginning of this section.\nProof. We proceed inductively: let j \u2265 2 and suppose that i0 = 0, i1 = 1, i2 , . . . , ij have\nbeen defined. Apply Proposition 4.2 to\n(\n(\u03c4i )\n(\u03c4i )\n(\u03c4i )\nh+ (x, y), for (x, y) in the support of T\u03b10 , T\u03b11 , T\u03b1 2 , T\u03b1 3 , . . . , T\u03b1 j ,\ncj (x, y) =\n\u221e,\notherwise,\nto find \u03b2j > 0 satisfying the conclusion of Proposition 4.2. We may and do assume that\n\u03b2j \u2264 min(\u03b21 , . . . , \u03b2j\u22121 ). Now choose ij+1 such that\n(\u03c4ij+1 )\n\n\u03b4(x, T\u03b1\n\n(x)) < \u03b2j ,\n\nx \u2208 [0, 1).\n\n(77)\n\nThis finishes the inductive step and well-defines the cost function c(x, y) in (76).\n(\u03c4ij )\n\nBy (71) each T\u03b1\n\nZ\n\ninduces a Monge transport \u03c0ij \u2208 \u03a0(\u03bc, \u03bd) which satisfies\nZ\n(\u03c4i )\nh(x, T\u03b1 j ) dx = 1.\nh(x, y) d\u03c0ij (x, y) =\nX\n\nX\u00d7Y\n\nThe fact that the relaxed primal value P rel for the cost function c equals zero, directly\nfollows from the definition of P rel [BLS09, Section 1.1], (72) and (73) by transporting the\n34\n\n\fmeasure \u03bc1{gn =0} , which has mass 1 \u2212 \u03b7n , via the Monge transport map T\u03b1 n where n is a\nlarge element of the sequence (ij )\u221e\nj=1 . Hence we conclude from [BLS09, Theorem 1.2] that\nthe dual value D of the Monge\u2013Kantorovich problem for the cost function c defined in (76)\nalso equals zero.\nFinally observe that we have D = Drel in the present example: indeed, the set {(x, y) \u2208\n[0, 1)2 : c(x, y) < \u221e} is the countable union of the supports of the finite cost Monge transport\n(\u03c4 )\n\n(\u03c4 )\n\n(\u03c4 )\n\n(\u03c4i )\n\nplans T\u03b10 , T\u03b11 , T\u03b1 i1 , T\u03b1 i2 , . . . , T\u03b1 j , . . . , so that the requirements \u03c6(x) + \u03c8(y) \u2264 c(x, y),\nfor all (x, y) \u2208 [0, 1)2 , and \u03c6(x) + \u03c8(y) \u2264 c(x, y), \u03c0-a.s., for each finite transport plan\n\u03c0 \u2208 \u03a0(\u03bc, \u03bd), coincide (after possibly modifying \u03c6(x) on a \u03bc-null set).\nWhat remains to prove is that the primal value\nR P satisfies P > 0. We shall show that,\nfor every transport plan \u03c0 \u2208 \u03a0(\u03bc, \u03bd), we have X\u00d7Y c(x, y) d\u03c0(x, y) \u2265 21 . Assume to the\ncontrary that there is \u03c0 \u2208 \u03a0(\u03bc, \u03bd) such that\nZ\nc(x, y) d\u03c0(x, y) < 21 .\nX\u00d7Y\n\n(\u03c4i1 )\n\nDenoting by \u03c3j the restriction of \u03c0 to the union of the graphs of the maps T\u03b10 , T\u03b11 , T\u03b1\n(\u03c4 )\nT\u03b1 i2 ,\n\n(\u03c4i )\n. . . , T\u03b1 j ,\n\npart\n\neach \u03c3j is a partial transport in \u03a0\nincrease to one. Choose j such that\nk\u03c3j k > 32 .\n\n(\u03bc, \u03bd) and the norms\n\n,\n\n(k\u03c3j k)\u221e\nj=1\n\nWe apply Proposition 4.2 to conclude that there is no partial transport plan \u033aj such that\n\u03c0j + \u033aj \u2208 \u03a0(\u03bc, \u03bd), and such that \u033aj is supported by \u2206\u03b2j . But this is a contradiction as\n\u033aj = \u03c0 \u2212 \u03c3j has precisely these properties by (77).\nProof of Proposition 4.1: The construction of the example described by Proposition 4.1 will\nbe an extension of the construction in the previous section from which we freely use the\nnotation.\nWe shall proceed by induction on j \u2208 N and define a double-indexed family of maps\n\u03c4n,j : [0, 1) \u2192 Z, where 1 \u2264 n \u2264 j.\nStep j = 1: Define\n\u03c41,1 : [0, 1) \u2192 Z\nas\n\u03c41,1 = \u2212\u03c41 ,\nwhere we have m1 = M1 , \u03b11 = M11 and \u03c41 as in (28) above. At this stage the only difference\nto the previous section is that we change the sign of \u03c41 as we now shall build up a \"positive\nsingular mass\", as opposed to the \"negative singular mass\" which we constructed in the\nprevious section. More precisely, defining \u03c61 , \u03c8 1 as in (27), we obtain, similarly as in (29)\n\uf8f1\n0,\nfor x \u2208 Ik1 , k1 \u2208 {2, . . . , (M1 \u2212 1)/2,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n(M1 + 3)/2, . . . , M1 \u2212 1},\n\u03c61 (x) + \u03c8 1 (T\u03b1(\u03c411,1 ) (x)) =\n\uf8f4\n(M\n\u2212\n1)/2,\nfor\nx\n\u2208\nIk1 , k1 = 1, M1 ,\n1\n\uf8f4\n\uf8f4\n\uf8f3\n1,\nfor x \u2208 I(M1 +1)/2 .\nThis finishes the inductive step for j = 1.\nStep j = 2: Let m2 and M2 = M1 m2 be as in section 3, where m2 satisfies the\nrequirements of Lemma 3.1, and still is free to be eventually specified. To define \u03c41,2 :\n(\u03c4 )\n[0, 1) \u2192 Z we want to make sure that the map T\u03b121,2 maps the intervals Ik1 bijectively onto\n(\u03c41,1 )\nT\u03b11 (Ik1 ). Using the notation of the previous section, we consider all the intervals Ik1 as\n\"good\" intervals so that we do not have to take extra care of some \"singular\" intervals.\n35\n\n\fMore precisely, fix 1 \u2264 k1 \u2264 M1 , and write \u03c4 for \u03c41,1 |Ik1 . If \u03c4 > 0, define J k1 ,c as\n{m2 \u2212 \u03c4 + 1, . . . , m2 }, i.e. the set of those indices k2 such that the interval Ik1 ,k2 is not\n(\u03c4 )\n(\u03c4 )\nmapped into T\u03b111,1 (Ik1 ) under T\u03b121,1 . If \u03c4 < 0, we define J k1 ,c as {1, . . . , |\u03c4 |}, and if \u03c4 = 0,\nwe define J k1 ,c as the empty set. The complement {1, . . . , m2 }\\J k1 ,c is denoted by J k1 ,u .\nDefine \u03c41,2 := \u03c41,1 = \u03c4 on the intervals Ik1 ,k2 , for k2 \u2208 J k1 ,u . On the remaining intervals\nIk1 ,k2 with k2 \u2208 J k1 ,c we define \u03c41,2 such that it takes constant values in {\u2212M2 + 1, . . . , M2 \u2212\n1} on each of these intervals, such that (37) (resp. (38) is satisfied, and such that these\n(\u03c4 )\nintervals Ik1 ,k2 are mapped onto the \"remaining gaps\" in T\u03b111,1 (Ik1 ).\n(\u03c4 )\nUsing again Lemma 3.3 we resume the properties of the thus constructed map T\u03b121,2 :\n[0, 1) \u2192 [0, 1).\n(\u03c4\n\n)\n\n(\u03c4\n\n)\n\n(i) The measure-preserving bijection T\u03b121,2 maps each interval Ik1 onto T\u03b111,1 (Ik1 ). It\ninduces a permutation of the intervals Ik1 ,k2 , where 1 \u2264 k1 \u2264 M1 , 1 \u2264 k2 \u2264 m2 .\n(ii) Defining \u03c62 , \u03c8 2 as in (32) we get, for each 1 \u2264 k1 \u2264 M1 , similarly as in (39) and (40)\n\u03bc[Ik1 \u2229 {\u03c41,2 6= \u03c41,1 }] \u2264\n\nM1\nm2 \u03bc[Ik1 ],\n\nas well as\nM1 Z\nX\n\nk1 =1\n\nIk1\n\n|(\u03c61 (x) \u2212 \u03c61 (T\u03b1(\u03c411,1 ) (x)) \u2212 (\u03c62 (x) \u2212 \u03c62 (T\u03b1(\u03c421,2 ) (x))|dx <\n\n4M12\n.\nm2\n\n1\n(iii) On the middle interval Imiddle\n= I M1 +1 we have \u03c41,2 = \u03c41,1 = 0.\n2\n\nWe now pass to the construction of the map \u03c42,2 : [0, 1) \u2192 Z. We define, for each\n1 \u2264 k1 \u2264 M1 , and x \u2208 Ik1 ,k2 ,\n\uf8f1\n\uf8f4\n\uf8f4a2 (k2 ), for k2 \u2208 {1, . . . , M1 }\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nfor k2 \u2208 {M1 + 1, . . . , (m2 \u2212 1)/2},\n\uf8f2\u2212M1 ,\n\u03c42,2 (x) = 0,\nfor k2 = (m2 + 1)/2,\n\uf8f4\n\uf8f4\n\uf8f4\nM1 ,\nfor k2 \u2208 {(m2 + 3)/2, . . . , m2 \u2212 M1 },\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3a (k ), for k \u2208 {m \u2212 M + 1, . . . , m }.\n2 2\n2\n2\n1\n2\n\nThe definition of the function a2 on the \"singular\" intervals Ik1 ,k2 , where k2 \u2208 {1, . . . , M1 }\u222a\n(\u03c4 )\n{m2 \u2212 M1 + 1, . . . , m2 } is done such that T\u03b122,2 maps these intervals onto \"remaining gaps\"\nIk1 ,l2 , where l2 runs through the set\n{(m2 \u2212 1)/2 \u2212 M1 + 1, . . . , (m2 \u2212 1)/2} \u222a {(m2 + 3)/2, . . . , (m2 + 3)/2 + M1 \u2212 1}\nin the middle region of the interval Ik1 . As above we require in addition that a2 on each\nIk1 ,k2 takes constant values in {\u2212M2 + 1, . . . , M2 \u2212 1} and that (37) (resp. (38)) is satisfied.\nThe function \u03c42,2 mimics the construction of \u03c41,1 above, with the role of [0, 1) replaced\nby each of the intervals Ik1 , for 1 \u2264 k1 \u2264 M1 . The idea is that, T\u03b1M1 1 being the identity map,\nM1\n1\n1\nwe have that T\u03b1M2 1 satisfies T\u03b1M2 1 (x) = x \u2295 M\nM2 and M2 = m2 is small. Hence the role of T\u03b11\nin the previous section now is taken by T\u03b1M2 1 .\nMore precisely, we have, for each k1 = 1, . . . , M1 , and x \u2208 Ik1 ,k2\n\u03c62 (x)+\u03c8 2 (T\u03b1(\u03c422,2 ) (x)) =\n\uf8f1\n0,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n=\nm2\n\uf8f4\n+ \u03b3(M1 ),\n\uf8f4\n\uf8f4\n\uf8f3 2M1\n1,\n\nfor k2 \u2208 {M1 + 1, . . . , (m2 \u2212 1)/2,\n(m2 + 3)/2, . . . , m2 \u2212 M1 },\nfor k2 \u2208 {1, . . . , M1 } \u222a {m2 \u2212 M1 + 1, . . . , m2 },\nfor k2 = (m2 + 1)/2.\n36\n\n(78)\n\n\fThe notation \u03b3(M1 ) denotes a quantity verifying |\u03b3(M1 )| \u2264 c(M1 ) for some constant c(M1 ),\ndepending only on M1 . The verification of (78) uses Lemma 3.3 and is analogous as in\nsection 3.\n(\u03c4\n\n)\n\nAs T\u03b122,2 defines a measure preserving bijection on [0, 1), we get\nZ\n\n1\n2\n\n(\u03c6 (x) + \u03c8\n\n2\n\n0\n\n(T\u03b1(\u03c422,2 ) (x))\n\ndx =\n\nZ\n\n1\n\n(\u03c62 (x) + \u03c8 2 (x)) dx = 1.\n\n(79)\n\n0\n\nThis finishes the inductive step for j = 2.\nGeneral Inductive step: For prime numbers m1 , . . . , mj\u22121 as in the previous section\nsuppose that we have defined, for 1 \u2264 n \u2264 j \u22121 maps \u03c4n,j : [0, 1) \u2192 Z such that the following\ninductive hypotheses are satisfied.\n(\u03c4\n\n)\n\n(i) For 1 \u2264 n \u2264 j \u2212 1, the measure preserving bijection T\u03b1i n,j\u22121 : [0, 1) \u2192 [0, 1) maps\nthe intervals Ik1 ,...,kn\u22121 onto themselves. It induces a permutation of the intervals\nIk1 ,...,kj\u22121 , where 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kj\u22121 \u2264 mj\u22121 .\n(ii) For 1 \u2264 n < j \u2212 1 we have, for 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kj\u22122 \u2264 mj\u22122 ,\n\u03bc[Ik1 ,...,kj\u22122 \u2229 {\u03c4n,j\u22122 6= \u03c4n,j\u22121 }] \u2264\n\nMj\u22122\nmj\u22121 \u03bc[Ik1 ,...,kj\u22122 ],\n\n(80)\n\nand\nX\n\n1\u2264k1 \u2264m1 ,...,1\u2264kj\u22122 \u2264mj\u22122\n\n\u0010\n\nj\u22121\n\n\u2212 \u03c6\n\nj\u22121\n\n(x) \u2212 \u03c6\n\nZ\n\nIk1 ,...,kj\u22122\n\n\u0011\n\nn,j\u22121 )\n(x))\n(T\u03b1(\u03c4j\u22121\n\n\u0010\n\n\u0011\nn,j\u22122 )\n(x))\n\u03c6j\u22122 (x) \u2212 \u03c6j\u22122 (T\u03b1(\u03c4j\u22122\n\ndx <\n\n(81)\n\nc(M1 ,...,Mj\u22122 )\n.\nmj\u22121\n\nWe now shall define \u03c4n,j : [0, 1) \u2192 Z, for 1 \u2264 n \u2264 j and \u03c4j,j : [0, 1) \u2192 Z.\nFix 1 \u2264 n \u2264 j \u2212 1 as well as 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kj\u22121 \u2264 mj\u22121 . Denote by \u03c4\nthe constant value \u03c4n,j\u22121 |Ik1 ,...,kj\u22121 . If \u03c4 > 0 define J k1 ,...,kj\u22121 ,c as {mj \u2212 \u03c4 + 1, . . . , mj },\nsimilarly as for the case j = 2 above. If \u03c4 \u2264 0 define J k1 ,...,kj\u22121 ,c as {1, . . . , |\u03c4 |} which, for\n\u03c4 = 0, equals the empty set. On the intervals Ik1 ,...,kj\u22121 ,kj where kj lies in the complement\nJ k1 ,...,kj\u22121 ,u = {1, . . . , mj }\\J k1 ,...,kj\u22121 ,c we define \u03c4n,j := \u03c4n,j\u22121 . On the remaining intervals\nIk1 ,...,kj\u22121 ,kj , where kj \u2208 J k1 ,...,kj\u22121 ,c , we define \u03c4n,j in such a way that it takes constant\nvalues in {\u2212Mj + 1, . . . , Mj \u2212 1} on each of these intervals, such that (37) (resp. (38)) is\nsatisfied, and such that these intervals Ik1 ,...,kj\u22121 ,kj are mapped onto the \"remaining gaps\"\n(\u03c4\n\n)\n\nn,j\u22121\nin T\u03b1j\u22121\n(Ik1 ,...,kj\u22121 ).\nSimilarly as in the previous section we thus well-define the function \u03c4n,j which then\nverifies (80) and (81), with j \u2212 1 replaced by j.\n\nWe still have to define \u03c4j,j : [0, 1) \u2192 Z. For 1 \u2264 k1 \u2264 m1 , . . . , 1 \u2264 kj\u22121 \u2264 mj\u22121 , we\ndefine \u03c4j,j (x) on the intervals Ik1 ,...,kj\u22121 ,kj by\n\uf8f1\n\uf8f4\naj (kj ), for kj \u2208 {1, . . . , Mj\u22121 }\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\u2212Mj , for kj \u2208 {Mj\u22121 + 1, . . . , (mj \u2212 1)/2},\n\u03c4j,j (x) = 0,\nfor kj = (mj + 1)/2,\n\uf8f4\n\uf8f4\n\uf8f4\nMj ,\nfor kj \u2208 {(mj + 3)/2, . . . , mj \u2212 Mj\u22121 },\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3a (k ), for k \u2208 {m \u2212 M\nj j\nj\nj\nj\u22121 + 1, . . . , mj }.\n\n37\n\n\fSimilarly as in step j = 2 the {\u2212Mj + 1, . . . , Mj \u2212 1}-valued function aj (kj ) is defined\n(\u03c4 )\nin such a way that T\u03b1jj maps the intervals Ik1 ,...,kj\u22121 ,kj with kj \u2208 {1, . . . , Mj\u22121 } \u222a {mj \u2212\nMj\u22121 + 1, . . . , mj } to the intervals Ik1 ,...,kj\u22121 ,kj , where kj runs through the \"middle region\"\n{(mj \u2212 1)/2 \u2212 Mj\u22121 + 1, . . . , (mj \u2212 1)/2} \u222a {(mj + 3)/2, . . . , (mj + 3)/2 + Mj\u22121 \u2212 1}.\nWe now deduce from Lemma 3.3 that, for x \u2208 Ik1 ,...,kj\u22121 ,kj\n\u03c6j (x) + \u03c6j (T\u03b1(\u03c4jj,j ) (x)) =\n\uf8f1\n0,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n=\nmj\n\uf8f4\n+ \u03b3(M1 , . . . , Mj\u22121 ),\n\uf8f4\n\uf8f4 2Mj\u22121\n\uf8f3\n1,\n\nfor kj \u2208 {Mj\u22121 + 1, . . . , (mj \u2212 1)/2}\n\u222a {(mj + 3)/2, . . . , mj \u2212 Mj\u22121 },\nfor kj \u2208 {1, . . . , Mj\u22121 } \u222a {mj \u2212 Mj\u22121 + 1, . . . , mj },\nfor kj = (mj + 1)/2,\n\nwhere \u03b3(M1 , . . . , Mj\u22121 ) denotes a quantity which is bounded in absolute value by a constant\nc(M1 , . . . , Mj\u22121 ) depending only on M1 , . . . , Mj\u22121 .\nThis completes the inductive step.\nWe now define \u03c40 = 0, \u03c41 = 1 and, for n \u2265 2\n\u03c4n = lim \u03c4n\u22121,j .\nj\u2192\u221e\n\n(82)\n\nIt follows from (80) that, for each n \u2265 2, the limit (82) exists almost surely provided the\nsequence (mn )\u221e\nn=1 converges sufficiently fast to infinity, similarly as in section 3 above. The\n\u221e\n(\u03c4n )\u221e\nn=0 and the above constructed functions (\u03c6n , \u03c8n )n=1 satisfy the assertions of Proposition\n4.1. The verification of items (i), (ii), and (iii) is analogous to the arguments of section 3 and\n(\u03c4 )\ntherefore skipped. As regards assertions (iv) note that, for 1 \u2264 n \u2264 j the function T\u03b1jn,j\n(\u03c4 )\nmaps the intervals Ik1 ,...,kn\u22121 onto themselves. It follows that T\u03b1 n does so too, whence\n\u03b4(x, T\u03b1(\u03c4n ) (x)) < Mn\u22121 ,\nwhich readily shows (74).\n\nReferences\n[AE06]\n\nJ.-P. Aubin and I. Ekeland. Applied nonlinear analysis. Dover Publications Inc.,\nMineola, NY, 2006. Reprint of the 1984 original.\n\n[AP03]\n\nL. Ambrosio and A. Pratelli. Existence and stability results in the L1 theory\nof optimal transportation. In Optimal transportation and applications (Martina\nFranca, 2001), volume 1813 of Lecture Notes in Math., pages 123\u2013160. Springer,\nBerlin, 2003.\n\n[BLS09] M. Beiglb\u00f6ck, C. L\u00e9onard, and W. Schachermayer. A general duality theorem\nfor the monge\u2013kantorovich transport problem. submitted, preprint available on\nwww.arxiv.org, 2009.\n[BS09]\n\nM. Beiglb\u00f6ck and W. Schachermayer. Duality for Borel measurable cost functions.\nTrans. Amer. Math. Soc., to appear, 2009.\n\n[ET99]\n\nI. Ekeland and R. T\u00e9mam. Convex analysis and variational problems, volume 28 of\nClassics in Applied Mathematics. Society for Industrial and Applied Mathematics\n(SIAM), Philadelphia, PA, english edition, 1999. Translated from the French.\n38\n\n\f[GM96] W. Gangbo and R.J. McCann. The geometry of optimal transportation. Acta\nMath., 177(2):113\u2013161, 1996.\n[Kel84] H.G. Kellerer. Duality theorems for marginal problems. Z. Wahrsch. Verw. Gebiete, 67(4):399\u2013432, 1984.\n[Pra08] A. Pratelli. On the sufficiency of c-cyclical monotonicity for optimality of transport\nplans. Math. Z., 2008. in press.\n[PSU88] A.L. Peressini, F.E. Sullivan, and J.J. Uhl, Jr. The mathematics of nonlinear\nprogramming. Undergraduate Texts in Mathematics. Springer-Verlag, New York,\n1988.\n[Roc66] Ralph T. Rockafellar. Characterization of the subdifferentials of convex functions.\nPacific J. Math., 17:497\u2013510, 1966.\n[RR96]\n\nD. Ramachandran and L. R\u00fcschendorf. Duality and perfect probability spaces.\nProc. Amer. Math. Soc., 124(7):2223\u20132228, 1996.\n\n[R\u00fcs96] L. R\u00fcschendorf. On c-optimal random variables. Statist. Probab. Lett., 27(3):267\u2013\n270, 1996.\n[ST08]\n\nW. Schachermayer and J. Teichmann. Characterization of optimal transport plans\nfor the Monge-Kantorovich problem. Proceedings of the A.M.S., 2008. in press.\n\n[Vil03]\n\nC. Villani. Topics in optimal transportation, volume 58 of Graduate Studies in\nMathematics. American Mathematical Society, Providence, RI, 2003.\n\n[Vil09]\n\nC. Villani. Optimal Transport. Old and New, volume 338 of Grundlehren der\nmathematischen Wissenschaften. Springer, 2009.\n\n39\n\n\f"}