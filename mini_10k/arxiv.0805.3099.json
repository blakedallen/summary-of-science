{"id": "http://arxiv.org/abs/0805.3099v2", "guidislink": true, "updated": "2008-08-20T22:14:26Z", "updated_parsed": [2008, 8, 20, 22, 14, 26, 2, 233, 0], "published": "2008-05-20T15:09:30Z", "published_parsed": [2008, 5, 20, 15, 9, 30, 1, 141, 0], "title": "NADA: A new code for studying self-gravitating tori around black holes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0805.3207%2C0805.3373%2C0805.2443%2C0805.2527%2C0805.4325%2C0805.3188%2C0805.0856%2C0805.3976%2C0805.0831%2C0805.3539%2C0805.3903%2C0805.4161%2C0805.2792%2C0805.3511%2C0805.1897%2C0805.2392%2C0805.0188%2C0805.2467%2C0805.4586%2C0805.2201%2C0805.0045%2C0805.3504%2C0805.3524%2C0805.2676%2C0805.3231%2C0805.0575%2C0805.2872%2C0805.3303%2C0805.2448%2C0805.4627%2C0805.0286%2C0805.4814%2C0805.1791%2C0805.4098%2C0805.2434%2C0805.3401%2C0805.2010%2C0805.2669%2C0805.3597%2C0805.4348%2C0805.3753%2C0805.2236%2C0805.3615%2C0805.1567%2C0805.1150%2C0805.4113%2C0805.1060%2C0805.0417%2C0805.2889%2C0805.1747%2C0805.0159%2C0805.2480%2C0805.0548%2C0805.2774%2C0805.4329%2C0805.3535%2C0805.3099%2C0805.3690%2C0805.1140%2C0805.0233%2C0805.3662%2C0805.0552%2C0805.0708%2C0805.0257%2C0805.1907%2C0805.2883%2C0805.1058%2C0805.1878%2C0805.3421%2C0805.4070%2C0805.3928%2C0805.4063%2C0805.3911%2C0805.2966%2C0805.1962%2C0805.2466%2C0805.1549%2C0805.1805%2C0805.0056%2C0805.0404%2C0805.4168%2C0805.2432%2C0805.3232%2C0805.1966%2C0805.0430%2C0805.3150%2C0805.1334%2C0805.0084%2C0805.2473%2C0805.2505%2C0805.1870%2C0805.4214%2C0805.2637%2C0805.2771%2C0805.3882%2C0805.0403%2C0805.3185%2C0805.3128%2C0805.1249%2C0805.1988%2C0805.2181&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "NADA: A new code for studying self-gravitating tori around black holes"}, "summary": "We present a new two-dimensional numerical code called Nada designed to solve\nthe full Einstein equations coupled to the general relativistic hydrodynamics\nequations. The code is mainly intended for studies of self-gravitating\naccretion disks (or tori) around black holes, although it is also suitable for\nregular spacetimes. Concerning technical aspects the Einstein equations are\nformulated and solved in the code using a formulation of the standard 3+1 (ADM)\nsystem, the so-called BSSN approach. A key feature of the code is that\nderivative terms in the spacetime evolution equations are computed using a\nfourth-order centered finite difference approximation in conjunction with the\nCartoon method to impose the axisymmetry condition under Cartesian coordinates\n(the choice in Nada), and the puncture/moving puncture approach to carry out\nblack hole evolutions. Correspondingly, the general relativistic hydrodynamics\nequations are written in flux-conservative form and solved with\nhigh-resolution, shock-capturing schemes. We perform and discuss a number of\ntests to assess the accuracy and expected convergence of the code, namely\n(single) black hole evolutions, shock tubes, and evolutions of both spherical\nand rotating relativistic stars in equilibrium, the gravitational collapse of a\nspherical relativistic star leading to the formation of a black hole. In\naddition, paving the way for specific applications of the code, we also present\nresults from fully general relativistic numerical simulations of a system\nformed by a black hole surrounded by a self-gravitating torus in equilibrium.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0805.3207%2C0805.3373%2C0805.2443%2C0805.2527%2C0805.4325%2C0805.3188%2C0805.0856%2C0805.3976%2C0805.0831%2C0805.3539%2C0805.3903%2C0805.4161%2C0805.2792%2C0805.3511%2C0805.1897%2C0805.2392%2C0805.0188%2C0805.2467%2C0805.4586%2C0805.2201%2C0805.0045%2C0805.3504%2C0805.3524%2C0805.2676%2C0805.3231%2C0805.0575%2C0805.2872%2C0805.3303%2C0805.2448%2C0805.4627%2C0805.0286%2C0805.4814%2C0805.1791%2C0805.4098%2C0805.2434%2C0805.3401%2C0805.2010%2C0805.2669%2C0805.3597%2C0805.4348%2C0805.3753%2C0805.2236%2C0805.3615%2C0805.1567%2C0805.1150%2C0805.4113%2C0805.1060%2C0805.0417%2C0805.2889%2C0805.1747%2C0805.0159%2C0805.2480%2C0805.0548%2C0805.2774%2C0805.4329%2C0805.3535%2C0805.3099%2C0805.3690%2C0805.1140%2C0805.0233%2C0805.3662%2C0805.0552%2C0805.0708%2C0805.0257%2C0805.1907%2C0805.2883%2C0805.1058%2C0805.1878%2C0805.3421%2C0805.4070%2C0805.3928%2C0805.4063%2C0805.3911%2C0805.2966%2C0805.1962%2C0805.2466%2C0805.1549%2C0805.1805%2C0805.0056%2C0805.0404%2C0805.4168%2C0805.2432%2C0805.3232%2C0805.1966%2C0805.0430%2C0805.3150%2C0805.1334%2C0805.0084%2C0805.2473%2C0805.2505%2C0805.1870%2C0805.4214%2C0805.2637%2C0805.2771%2C0805.3882%2C0805.0403%2C0805.3185%2C0805.3128%2C0805.1249%2C0805.1988%2C0805.2181&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a new two-dimensional numerical code called Nada designed to solve\nthe full Einstein equations coupled to the general relativistic hydrodynamics\nequations. The code is mainly intended for studies of self-gravitating\naccretion disks (or tori) around black holes, although it is also suitable for\nregular spacetimes. Concerning technical aspects the Einstein equations are\nformulated and solved in the code using a formulation of the standard 3+1 (ADM)\nsystem, the so-called BSSN approach. A key feature of the code is that\nderivative terms in the spacetime evolution equations are computed using a\nfourth-order centered finite difference approximation in conjunction with the\nCartoon method to impose the axisymmetry condition under Cartesian coordinates\n(the choice in Nada), and the puncture/moving puncture approach to carry out\nblack hole evolutions. Correspondingly, the general relativistic hydrodynamics\nequations are written in flux-conservative form and solved with\nhigh-resolution, shock-capturing schemes. We perform and discuss a number of\ntests to assess the accuracy and expected convergence of the code, namely\n(single) black hole evolutions, shock tubes, and evolutions of both spherical\nand rotating relativistic stars in equilibrium, the gravitational collapse of a\nspherical relativistic star leading to the formation of a black hole. In\naddition, paving the way for specific applications of the code, we also present\nresults from fully general relativistic numerical simulations of a system\nformed by a black hole surrounded by a self-gravitating torus in equilibrium."}, "authors": ["Pedro J. Montero", "Jose A. Font", "Masaru Shibata"], "author_detail": {"name": "Masaru Shibata"}, "author": "Masaru Shibata", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevD.78.064037", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0805.3099v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0805.3099v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "18 pages, 14 figures, accepted for publication in Phys. Rev. D", "arxiv_primary_category": {"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0805.3099v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0805.3099v2", "journal_reference": "Phys.Rev.D78:064037,2008", "doi": "10.1103/PhysRevD.78.064037", "fulltext": "NADA: A new code for studying self-gravitating tori around black holes\nPedro J. Montero,1 Jos\u00e9 A. Font,1 and Masaru Shibata2\n\narXiv:0805.3099v2 [gr-qc] 20 Aug 2008\n\n1\n\nDepartamento de Astronom\u0131\u0301a y Astrof\u0131\u0301sica, Universidad de Valencia, Dr. Moliner 50, 46100 Burjassot, Spain\n2\nGraduate School of Arts and Sciences, University of Tokyo, Komaba, Meguro, Tokyo 153-8902, Japan\n(Dated: October 26, 2018)\nWe present a new two-dimensional numerical code called Nada designed to solve the full Einstein equations coupled to the general relativistic hydrodynamics equations. The code is mainly\nintended for studies of self-gravitating accretion disks (or tori) around black holes, although it is\nalso suitable for regular spacetimes. Concerning technical aspects the Einstein equations are formulated and solved in the code using a formulation of the standard 3+1 (ADM) system, the so-called\nBSSN approach. A key feature of the code is that derivative terms in the spacetime evolution\nequations are computed using a fourth-order centered finite difference approximation in conjunction\nwith the Cartoon method to impose the axisymmetry condition under Cartesian coordinates (the\nchoice in Nada), and the puncture/moving puncture approach to carry out black hole evolutions.\nCorrespondingly, the general relativistic hydrodynamics equations are written in flux-conservative\nform and solved with high-resolution, shock-capturing schemes. We perform and discuss a number\nof tests to assess the accuracy and expected convergence of the code, namely (single) black hole\nevolutions, shock tubes, and evolutions of both spherical and rotating relativistic stars in equilibrium, the gravitational collapse of a spherical relativistic star leading to the formation of a black\nhole. In addition, paving the way for specific applications of the code, we also present results from\nfully general relativistic numerical simulations of a system formed by a black hole surrounded by a\nself-gravitating torus in equilibrium.\nPACS numbers: 04.25.Dm, 04.40.Dg, 04.70.Bw, 95.30.Lz, 97.60.Jd\n\nI.\n\nINTRODUCTION\n\nSelf-gravitating tori (or thick accretion disks) orbiting black holes (BHs) are common end-products in a\nnumber of scenarios of relativistic astrophysics. Theoretical evolutionary paths predict that they may form\nafter the merger of a binary system formed by a BH\nand a neutron star (NS) or the system formed by two\nNS (see e.g.[1] and references therein). In addition, they\nmay also be the result of the gravitational collapse of\nthe rotating core of massive stars [2, 3]. State-of-the-art\nnumerical simulations have started to provide quantitative estimates of the viability of such systems to form\n[1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]. Furthermore, such\na thick disk plus BH system is thought to be the central\nengine for gamma-ray bursts [15, 16, 17, 18]. Therefore,\nunderstanding the formation and dynamics of such systems is a highly relevant enterprise, along with discerning\nits stability properties. Namely, whether they may be\nsubject to axisymmetric and non-axisymmetric instabilities which could also lead to the emission of a significant\namount of gravitational radiation.\nIn particular, the so-called runaway instability, first\nfound by Abramowicz, Calvani and Nobili [19], is an axisymmetric instability that could destroy the torus on\ndynamical timescales. The numerical study of the runaway instability in general relativity has so far been investigated under different assumptions and approximations (see e.g. [20, 21] and references therein). Despite\nsome progress has been made the existing works are not\nstill conclusive on the likelihood of the instability, mainly\ndue to the absence of important physics in the modeling.\n\nThe complexity of handling the presence of a spacetime\nsingularity in addition to the (magneto-)hydrodynamics\nand the self-gravity of the (possibly magnetized) accretion torus, turn very challenging the task of carrying out\nfull general relativistic simulations of BH surrounded by\na self-gravitating torus. The code we present in this paper is built with this mid-term goal in mind.\nNumerical studies of the dynamics of matter around\nBHs are abundant in the literature (see e.g. the references reported in [22]). For the kind of specific work we\ndiscuss in this paper we note, in particular, that [23, 24]\nalready focused on the numerical evolution of matter in\ndynamical axisymmetric BH spacetimes. Recent developments in numerical relativity associated with the puncture method for evolving BHs [25, 26] have proved essential to perform accurate and long-term stable evolutions\nof spacetimes containing BHs, and the first successful\nsimulations of BH/BH binaries have only been possible\nvery recently (see [27] and references therein). Shibata\n[13, 14] used the puncture method to investigate the\nmerger of BH/NS binary system in full general relativity,\nand Faber et al. [28] considered relativistic spherical accretion onto a BH. In addition, Baiotti and Rezzolla [29]\nwere also able to handle the accretion of matter onto a\nnewly formed BH resulting from the collapse of a rotating\nNS without needing to excise the singularity.\nIn order to take advantage of this approach, Shibata [30] presented a formulation for computing equilibrium configurations of a BH and a self-gravitating\ntorus in the puncture framework. Previous computations of this system by Nishida and Eriguchi [31], and\nalso by Ansorg and Petroff [32] were not done in the\npuncture framework. In this paper we use the initial\n\n\f2\ndata in the formalism presented in [30] to carry out\nthe first dynamical simulations of a self-gravitating torus\nin equilibrium around a BH as a first step towards a\nsystematic investigation of the runaway instability in\nfull general relativity. Such initial data are evolved using a new two-dimensional, general relativistic hydrodynamics code called Nada which is presented and thoroughly tested in this paper. As we explain in detail below our code solves the 3+1 Einstein equations using\nthe formulation originally proposed by Nakamura [33]\nand subsequently modified by Shibata-Nakamura [34]\nand Baumgarte-Shapiro [35], which is usually known as\nthe BSSN formulation. On the other hand, the general relativistic hydrodynamics equations are written in\nflux-conservative form and solved with a high-resolution\nshock-capturing scheme (HRSC) [22, 36, 37]. In addition, the Nada code implements the Cartoon method [38]\nwhich allows to impose the axisymmetry condition while\nstill admitting the use of Cartesian coordinates, the puncture/moving puncture approach to deal with the BH singularity and derivative terms in the spacetime evolution\nequations are computed using a fourth-order centered finite difference approximation.\nThe code is written in FORTRAN 90, requires approximately 8 bytes of memory per grid point, and it takes\nabout 200 microseconds per grid point per time step using a five stages Runge-Kutta (see section III) for the\ntime integration on a 2.0 GHz AMD Opteron Dual Core\n270.\nThe organization of the paper is as follows: the formulation of the Einstein equations, including the implementation of the puncture approach and gauge conditions, along with the formulation of the general relativistic equations is briefly presented in Section II. Section\nIII gives a short description of the boundary conditions\nand numerical methods employed for the time evolutions.\nSection IV and V are devoted to present results from tests\nthe code has passed, for vacuum and non-vacuum spacetimes, respectively. Section VI discusses numerical simulations of self-gravitating equilibrium tori, in preparation\nfor subsequent work. A summary of our conclusions is\ngiven in Section VII. We use units in which c = G = 1,\nand in sections V. C to V. F we also use M\u2299 = 1. Greek\nindices run from 0 to 3, Latin indices from 1 to 3, and we\nadopt the standard convention for the summation over\nrepeated indices.\n\nII.\n\nBASIC EQUATIONS\n\nWe give next a brief overview of the formulation for\nthe system of Einstein and hydrodynamic equations as\nhave been implemented in the code.\n\nA.\n\nFormulation of Einstein equations\n1.\n\nBSSN formulation\n\nWe follow the 3+1 formulation in which the spacetime\nis foliated into a set of non-intersecting spacelike hypersurfaces. In this approach, the line element is written in\nthe following form\nds2 = \u2212(\u03b12 \u2212 \u03b2i \u03b2 i )dt2 + 2\u03b2i dxi dt + \u03b3ij dxi dxj ,\n\n(2.1)\n\nwhere \u03b1, \u03b2 i and \u03b3ij are the lapse function, the shift threevector, and the three-metric, respectively. The latter is\ndefined by\n\u03b3\u03bc\u03bd = g\u03bc\u03bd + n\u03bc n\u03bd ,\n\n(2.2)\n\nwhere n\u03bc is a timelike unit-normal vector orthogonal to\na spacelike hypersurface.\nA reformulation of the ADM system, the BSSN formulation [33, 34, 35], has been implemented to solve the\nEinstein equations. Initially, a conformal factor is introduced, and the conformally related metric is written as\n\u03b3\u0303ij = e\u22124\u03c6 \u03b3ij ,\n\n(2.3)\n\nsuch that the determinant of the conformal metric, \u03b3\u0303ij , is\nunity and \u03c6 = ln(\u03b3)/12, where \u03b3 = det(\u03b3ij ). We also define the conformally related traceless part of the extrinsic\ncurvature Kij ,\n\u0013\n\u0012\n1\n(2.4)\n\u00c3ij = e\u22124\u03c6 Aij = e\u22124\u03c6 Kij \u2212 \u03b3ij K ,\n3\nwhere K is the trace of the extrinsic curvature. After\nintroducing these new variables, the evolution equations\ncan be expressed as\n1\n(\u2202t \u2212 L\u03b2 ) \u03c6 = \u2212 \u03b1K,\n6\n(\u2202t \u2212 L\u03b2 ) K = \u2212\u03b3 ij Dj Di \u03b1 + \u03b1\u00c3ij \u00c3ij\n1\n+ \u03b1K 2 + 4\u03c0\u03b1 (E + S) ,\n3\n(\u2202t \u2212 L\u03b2 ) \u03b3\u0303ij = \u22122\u03b1\u00c3ij ,\n\n(2.5)\n\n(2.6)\n(2.7)\nTF\n\n(\u2202t \u2212 L\u03b2 ) \u00c3ij = e\u22124\u03c6 (\u2212Di Dj \u03b1 + \u03b1 (Rij \u2212 8\u03c0Sij ))\n\u0011\n\u0010\n(2.8)\n+ \u03b1 K \u00c3ij \u2212 2\u00c3il \u00c3lj ,\n\u0012\n2\n\u2202t \u0393\u0303i = \u22122\u00c3ij \u2202j \u03b1 + 2\u03b1 \u0393\u0303ijk \u00c3jk \u2212 \u03b3\u0303 ij \u2202j K\n3\n\u0011\n\u22128\u03c0\u03b3\u0303 ij Sj + 6\u00c3ij \u2202j \u03c6 + \u03b2 j \u2202j \u0393\u0303i \u2212 \u0393\u0303j \u2202j \u03b2 i\n1\n2\n+ \u0393\u0303i \u2202j \u03b2 j + \u03b3\u0303 li \u2202jl \u03b2 j + \u03b3\u0303 lj \u2202lj \u03b2 i , (2.9)\n3\n3\n\nwhere \u0393\u0303i jk are the connection coefficients associated\nwith \u03b3\u0303ij , L\u03b2 refers to the Lie derivative along the shift\nvector (see e.g. [43] for the tensor weights necessary to\nevaluate the Lie derivatives), and Di and Rij are the\n\n\f3\ncovariant derivative operator and the three-dimensional\nRicci tensor associated with the three-metric \u03b3ij , respectively. The object \u0393\u0303i , known as the conformal connection\nfunctions, is defined as\n\u0393\u0303i \u2261 \u03b3\u0303 jk \u0393\u0303i jk = \u2212\u2202j \u03b3\u0303 ij .\n\n(2.10)\n\nThe Ricci tensor Rij that appears in the source term\nof the evolution equation (2.8) is split into two parts as\nfollows\n\u03c6\nRij = Rij\n+ R\u0303ij ,\n\n(2.11)\n\n\u03c6\nwhere Rij\nis given by\n\u03c6\nRij\n= \u22122D\u0303i D\u0303j \u03c6 \u2212 2\u03b3\u0303ij D\u0303k D\u0303k \u03c6\n\n+ 4D\u0303i \u03c6D\u0303j \u03c6 \u2212 4\u03b3\u0303ij D\u0303k \u03c6D\u0303k \u03c6,\n\n(2.12)\n\nwhere D\u0303i is the covariant derivative with respect to the\nconformal metric \u03b3\u0303ij . The conformal Ricci tensor, R\u0303ij ,\nis expressed as\n1\nR\u0303ij = \u2212 \u03b3\u0303 mn \u2202mn \u03b3\u0303ij + \u03b3\u0303k(i \u2202j) \u0393\u0303k + \u0393\u0303k \u0393\u0303(ij)k\n2 \u0010\n\u0011\n(2.13)\n+ \u03b3\u0303 mn 2\u0393\u0303km(i \u0393\u0303j)kn + \u0393\u0303kin \u0393\u0303kmj .\nDuring the evolution we also enforce the constraints\nTr(\u00c3ij ) = 0 and det(\u03b3\u0303ij ) = 1 at every time step by using\nthe following substitutions\n\u00c3ij \u2192 \u00c3ij \u2212\n\nTr(\u00c3ij )\n\u03b3\u0303ij ,\n3\n\n\u03b3\u0303ij \u2192 \u03b3\u0303ij /\u03b3\u0303 1/3 .\n\n(2.14)\n(2.15)\n\nThe matter source terms, E, Si , and Sij appearing in the\nEinstein equations are projections of the stress-energy\ntensor T \u03bc\u03bd on the hypersurface with respect to the unit\nnormal n\u03bc\nE = n\u03bc n\u03bd T \u03bc\u03bd ,\nSi = \u2212\u03b3i\u03bc n\u03bd T \u03bc\u03bd ,\nSij = \u03b3i\u03bc \u03b3j\u03bd T \u03bc\u03bd ,\n\n(2.16)\n\nwith S = Sij \u03b3 ij .\nIn addition to the evolution equations there are three\nconstraint equations, the Hamiltonian, the momentum\nand the Gamma constraints, which are only used as diagnostics of the accuracy of the numerical evolutions\nH \u2261 \u03b3\u0303 ij D\u0303i D\u0303j e\u03c6 \u2212\n\ne\u03c6\ne5\u03c6\nR\u0303 +\n\u00c3ij \u00c3ij\n8\n8\n\ne5\u03c6 2\nK + 2\u03c0e5\u03c6 E = 0,\n(2.17)\n12\n2\nMi \u2261 D\u0303j (e6\u03c6 \u00c3ij ) \u2212 e6\u03c6 D\u0303i K \u2212 8\u03c0e6\u03c6 \u03b3\u0303 ij Sj = 0,\n3\n(2.18)\n\u2212\n\nG i \u2261 \u0393\u0303i + \u2202j \u03b3\u0303 ij = 0.\n\n(2.19)\n\n2.\n\nPuncture approach\n\nRecent breakthroughs in numerical relativity have finally made possible accurate and long-term stable 3+1\nevolutions of singular spacetimes, including the challenging cases of the collision of compact binaries formed by\neither two BHs or a BH and a NS (see [27] and references\ntherein). One of the key ingredients for such success has\nbeen the so-called \"puncture approach\" [39], in which BH\ninitial data are modeled by the Brill-Lindquist topology\n[40], where a \"throat\" at the BH horizon connects two\nasymptotically flat regions. One of the asymptotically\nflat ends is compactified to a single point known as the\npuncture, leading to a coordinate singularity.\nThe puncture approach has the advantage that its numerical implementation within the BSSN formalism is\nrather simple. The original proposal only considered the\nfixed puncture approach [41, 42, 43], where the conformal factor is split into a regular part and a singular part.\nAlthough this method does not lead to long-term stable evolutions of spacetimes containing BHs, it allows for\na number of code tests. However, two different groups\n[25, 26] developed recently the moving puncture approach\nin which no singular term of the conformal factor is factored out, and the punctures are allowed to move through\nthe grid. The difference between these two methods is\nhow the conformal factor is evolved. In the so-called\n\u03c6-method [26], the original BSSN variable \u03c6 is evolved\nthrough the usual BSSN evolution Eq. (2.5). On the\nother hand, the so-called \u03c7-method [25] introduces a new\nconformal factor defined as \u03c7 \u2261 e\u22124\u03c6 , and the following\nevolution equation, that replaces Eq. (2.5),\n2\n\u03c7(\u03b1K \u2212 \u2202j \u03b2 j ).\n(2.20)\n3\nThis moving puncture approach, together with the socalled puncture gauge (see Sec. II A.3), has led to major success in simulations of binary BHs [44, 45, 46, 47,\n48, 49, 50]. Motivated by this, we have implemented\nboth methods in our 2D code, the \u03c6-method and the \u03c7method, for the moving puncture approach to investigate\nthe dynamics of matter around BHs.\n(\u2202t \u2212 L\u03b2 ) \u03c7 =\n\n3.\n\nGauge choices\n\nIn addition to the BSSN spacetime variables\n(\u03b3\u0303ij , \u00c3ij , K, \u03c6 or \u03c7, \u0393\u0303i ), there are two more variables\nleft undetermined, the lapse, \u03b1 and the shift vector, \u03b2 i .\nThe code can handle arbitrary gauge conditions, however\nlong-term BH evolutions in the moving puncture framework have been successful with some combination of the\nso called \"1+log\" condition [51] for the lapse, and the\n\"Gamma-freezing\" condition for the shift vector [43].\nThe form of this slicing condition most commonly used\nfor moving puncture evolutions contains the advective\nterm \u03b2 i \u2202i \u03b1 and is expressed as\n\u2202t \u03b1 \u2212 \u03b2 i \u2202i \u03b1 = \u22122\u03b1K.\n\n(2.21)\n\n\f4\nSeveral authors (see, e.g. [28, 52, 53]) have used the socalled \"non-advective 1+log\", by dropping the advective\nterm in Eq. (2.21), for single BH evolutions. In this case,\nthe slicing condition takes the form\n\u2202t \u03b1 = \u22122\u03b1K.\n\n3 i\nB,\n4\n\n\u2202t B i = \u2202t \u0393\u0303i \u2212 \u03b7B i ,\n\nui\n\u00fbj\n= \u2212\u03b2 i + \u03b1\u03b3 ij\n,\nut\nhW\n\u00fbi \u2261 hui ,\n\n(2.22)\n\nIt was shown by [52], that the evolution of a single puncture using the condition given by Eq. (2.22) settles down\ninto a time-independent and maximally sliced solution.\nFor the simulations of a BH surrounded by a selfgravitating torus presented in this paper, we choose the\nslicing given by Eq. (2.22) as the BH does not move\nthrough the grid, and therefore the advective term \u03b2 i \u2202i \u03b1\ndoes not play an important role.\nFor the shift vector, we choose the Gamma-freezing\ncondition, written as\n\u2202t \u03b2 i =\n\nvi \u2261\n\n\u00ea \u2261\n\nP\ne6\u03c6\nT\u03bc\u03bd n\u03bc n\u03bd = hW \u2212\n,\n\u03c1\u2217\n\u03c1W\nW \u2261 \u03b1ut ,\n\n(2.28)\n(2.29)\n(2.30)\n\nwhere W and h are the Lorentz factor and the specific\nfluid enthalpy respectively, and P is the pressure.\nBy defining the vector of unknowns, U, and fluxes Fx\nand Fz along the x and z directions as\nU = (\u03c1\u2217 , Jx , Jy , Jz , E\u2217 ),\n\n(2.31)\n\n(2.23)\n\n\u221a\nFx = [\u03c1\u2217 v x , Jx v x + P \u03b1 \u03b3, Jy v x , Jz v x ,\n\u221a\nE\u2217 v x + P \u03b1 \u03b3(v x + \u03b2 x )],\n\n(2.32)\n\n(2.24)\n\n\u221a\nFz = [\u03c1\u2217 v z , Jx v z , Jy v z , Jz v z + P \u03b1 \u03b3,\n\u221a\nE\u2217 v z + P \u03b1 \u03b3(v z + \u03b2 z )],\n\n(2.33)\n\nwhere \u03b7 is a constant that acts as a damping term, introduced both to prevent long term drift of the metric\nfunctions and to prevent oscillations of the shift vector\n[43]. This parameter also has an effect on the coordinates of the final spacelike hypersurface. In Ref. [53] it\nwas shown that increasing the value of \u03b7 increases the coordinate size of the BH, which allows for better numerical\nresolution across the BH. On the other hand, larger values of the damping parameter introduce a higher drift in\nthe location of the horizon in time, as well as in the deformation of the metric during the evolution, caused by\nthe larger values reached by the connection functions \u0393\u0303i\n[28, 54]. Bearing this in mind, we use \u03b7 = 0.3/M , where\nM is the ADM mass of the system, for the evolutions of\nspacetimes containing a BH presented in this paper.\n\nwith Ji \u2261 \u03c1\u2217 \u00fbi and E\u2217 \u2261 \u03c1\u2217 \u00ea, the set of hydrodynamic\nequations (2.25) can be written in conservative form as\n\u2202t U + \u2202x Fx + \u2202z Fz = S,\n\n(2.34)\n\nwhere S is the vector of sources. We refer to [37] for\nfurther details on these equations, in particular regarding\nthe form of the source terms.\nTo close the system of equations, we choose two possible equations of state, the so-called \u0393-law equation of\nstate (ideal fluid) given by\nP = (\u0393 \u2212 1) \u03c1\u01eb,\n\n(2.35)\n\nwhere \u01eb is the specific internal energy, and a polytropic\nequation of state\nP = \u03ba\u03c1\u0393 .\n\nB.\n\n(2.27)\n\n(2.36)\n\nFormulation of the hydrodynamics equations\n\nThe general relativistic hydrodynamics equations, expressed through the conservation equations for the stressenergy tensor T \u03bc\u03bd and the continuity equation are\n\u2207\u03bc T \u03bc\u03bd = 0 ,\n\n\u2207\u03bc (\u03c1u\u03bc ) = 0,\n\n(2.25)\n\nwhere \u03c1 is the rest-mass density, u\u03bc is the fluid fourvelocity and \u2207 is the covariant derivative with respect to\nthe spacetime metric. Following [37] the general relativistic hydrodynamic equations are written in a conservative\nform in cylindrical coordinates. Since the Einstein equations are solved only in the y = 0 plane with Cartesian\ncoordinates, the hydrodynamic equations are rewritten\nin the Cartesian coordinates for y = 0. The following\ndefinitions for the hydrodynamical variables are used\n\u03c1\u2217 \u2261 \u03c1W e6\u03c6 ,\n\n(2.26)\n\nHere \u03ba is the polytropic constant, \u0393 = 1 + 1/N and\nN is the polytropic index. In those simulations where\nthe system evolves adiabatically, such that no shocks are\npresent, we use the polytropic equation of state during\nthe evolution.\nAfter each time iteration the conserved variables\n(i.e. \u03c1\u2217 , Jx , Jy , Jz , E\u2217 ) are updated and the primitive hydrodynamical variables (i.e. \u03c1, v x , v y , v z , \u01eb) have to be recovered at the corresponding step. This is done by solving the following equation for the Lorentz factor, W , derived from the normalization of the 4-velocity of the fluid\n\u0012\n\u0013\u22122\n\u00ea\nP\n2\nij\nij\nW = 1 + \u03b3 ui uj = 1 + \u03b3 \u00fbi \u00fbj\n.\n+\nW\n\u03c1W 2\n(2.37)\nOnce solved for W , the other variables, \u03c1, v i , P, \u01eb and h\nare computed from Eqs. (2.26)-(2.30) and the equation\nof state.\n\n\f5\nIII.\n\nNUMERICS\n\nThere are two schemes implemented for the update of\nthe numerical solution with time: an iterative CrankNicholson (ICN) scheme taking two corrector steps [55],\nand an optimal strong stability-preserving (SSP) RungeKutta of fourth-order algorithm with 5 stages [56] (RK4).\nThe RK4 scheme is used for simulations of spacetimes\ncontaining a singularity, where a high-order of accuracy\nis an important issue.\nWe use second-order slope limiter reconstruction\nschemes (both minmod and MC are implemented in the\ncode) to obtain the left and right states of the primitive variables (i.e. \u03c1, v x , v y , v z , \u01eb) at each cell interface,\nand these reconstructed variables are then used to compute the left and right states of the evolved quantities\n(\u03c1\u2217 , Jx , Jy , Jz , E\u2217 ). Next, we use HLLE or Roe approximate solvers to compute the numerical fluxes in the x\nand z directions. Details on such high-resolution shockcapturing schemes are available elsewhere (see e.g. [22]\nand references therein).\nDerivative terms in the spacetime evolution equations\nare represented by second or fourth order centered finite difference approximation [57] in a uniform Cartesian\ngrid except for the advection terms (terms formally like\n\u03b2 i \u2202i u), for which an upwind scheme is used.\nA.\n\nDiscretization of Axisymmetric Systems:\n\"Cartoon\" Method\n\nAs pointed out by [38] any given system of equations\nin 3D possessing a rotation symmetry with respect to\nthe z-axis can be finite differenced and solved in the\nx \u2212 z (y = 0) plane alone because of the symmetry condition. When the system of equations is expressed in\nCartesian coordinates, partial derivative terms with respect to the y-coordinate will appear and these need to\nbe computed using the computational domain. For instance, in a second-order centered difference approximation, the values of the derivative in the y-direction of a\nquantity f (x, 0, z), are computed using the values of f at\nthe nearest two grid points i.e. f (x, \u2212\u2206y, z), f (x, \u2206y, z).\nThen, because of axisymmetry, the y-derivatives can be\ndetermined in the x\u2212z plane from information contained\nin this same plane. The Cartoon method obtains the\nboundary conditions at y = \u00b1\u2206y that are necessary to\nevaluate the derivatives in the y-direction by means of a\nrotation about the symmetry axis of the different tensor\nquantities. On the other hand, in a fourth-order centered\ndifference approximation, the values of the derivative in\nthe y-direction of a quantity f (x, 0, z), are computed using the values of f at the grid points f (x, \u00b12\u2206y, z) and\nf (x, \u00b1\u2206y, z).\npThe values of the pvariables at the positions\n( x2 + \u2206y 2 , 0, z) and ( x2 + 4\u2206y 2 , 0, z) are interpolated from the neighboring grid points using Lagrange\npolynomial interpolation (see e.g. [58]) with interpolat-\n\ning polynomials of degree 2 and 4, depending on the order\nof the finite difference approximation.\n\nB.\n\nBoundary Conditions\n\nThe computational domain is defined as 0 \u2264 x \u2264 L and\n0 \u2264 z \u2264 L, where L refers to the location of the outer\nboundaries. For simulations with the puncture method\nwe used a staggered Cartesian grid to avoid that the location of the puncture at the origin coincides with a grid\npoint. A number of different boundary conditions are implemented in the code. These are imposed for the spacetime variables or the hydrodynamical primitive variables\nat the inner and outer boundaries as follows: for both\nthe spacetime and hydrodynamical variables, \u03c0-rotation\nsymmetry is imposed around the z-axis, and equatorial\nplane symmetry with respect to the z = 0 plane. At\nthe outer boundaries we impose radiative boundary conditions [43]. Note that we do not apply this boundary\ncondition to the conformal connection functions, \u0393\u0303i , for\nwhich we used static boundary conditions.\n\nC.\n\nAtmosphere treatment\n\nAn important ingredient in numerical simulations\nbased on finite difference schemes to solve the hydrodynamic equations is the treatment of vacuum regions.\nThe standard approach is to add an atmosphere of very\nlow density filling these regions [59]. We follow this approach and treat the atmosphere as a perfect fluid with\na rest-mass density several orders of magnitude smaller\nthan that of the bulk matter. The hydrodynamic equations are solved in the atmosphere region in the same\nway that is done for the region of the bulk matter. If\nthe conservative variables \u03c1\u2217 or E\u2217 fall below some minimum value then the values of the conserved quantities\nare set to the atmosphere value. Similarly in the routine that converts primitive variables from conservatives,\nif the rest-mass density \u03c1 or specific internal energy \u01eb\nfall below the value set for the atmosphere, this point is\nreset to have the atmosphere value of the primitive variables. In particular for simulations of relativistic stars,\nand systems composed of a BH plus a self-gravitating\ntorus system, the atmosphere density is usually taken to\nbe about 6-8 orders of magnitude smaller than the initial\nmaximum rest-mass density.\n\nD.\n\nDiagnostics\n\nTo check the accuracy of the numerical simulations we\nmonitor the violation of the Hamiltonian constraint, and\nthe conservation of the total rest-mass M\u2217 , the ADM\nmass M , and the angular momentum J. We compute\nthese various quantities in the y = 0 plane as\n\n\f6\n\nL\n\nZ\n\nM\u2217 = 4\u03c0\n\nxdx\n\n0\n\nM = \u22122\n\nZ\n\nL\n\nJ = 4\u03c0\n\nL\n\n\u03c1\u2217 dz,\n\nZ\n\nZ\n\n0\n\nL\n\n(3.1)\n\n0\n\ne\u03c6\ndz \u22122\u03c0Ee5\u03c6 + R\u0303\n8\n0\n\u0012\n\u0013\u0015\n2\ne5\u03c6\n\u00c3ij \u00c3ij \u2212 K 2 ,\n\u2212\n8\n3\n\nxdx\n\n0\n\nL\n\nZ\n\n\u0014\n\n2\n\nx dx\n\nZ\n\n(3.2)\n\nL\n\n\u03c1\u2217 \u0169y dz.\n\n(3.3)\n\n0\n\nIn axisymmetry the apparent horizon (AH hereafter)\nequation becomes a nonlinear ordinary differential equation (ODE) for the AH shape function, h = h(\u03b8) [60, 61].\nWe have implemented an AH finder that solves this ODE\nby a shooting method using that \u2202\u03b8 h(\u03b8 = 0) = 0 and\n\u2202\u03b8 h(\u03b8 = \u03c0/2) = 0 as boundary conditions. We define the\nmass of the AH as\nr\nA\n,\n(3.4)\nMAH =\n16\u03c0\n\nVACUUM TESTS: SINGLE BH\nEVOLUTIONS\n\n(4.1)\n\nwhere the conformal factor is \u03c8 = (1 + M/2r), M being\nthe mass of the BH. Here r is the isotropic radius, r2 =\nx2 + y 2 + z 2 . Thus, the spatial metric takes the form\n\u03b3ij = \u03c8 4 \u03b3\u0303ij , where the conformal metric is the flat metric.\nInitially the extrinsic curvature is Kij = 0.\nA.\n\nSchwarzschild BH with 1 + log slicing\n\n\u2202t \u03b1 = \u22122\u03b1\u03c8 4 K.\n\nThe Schwarzschild metric in isotropic coordinates is\nused as initial data to test the ability of the code to evolve\nBH spacetimes within the fixed and moving puncture approaches. These initial data are such that the 3-metric\nis written in Cartesian coordinates as\nd\u03c3 2 = \u03c8 4 (dx2 + dy 2 + dz 2 ),\n\nB.\n\nNext, we use a zero shift and a modified 1 + log slicing\ncondition that permits the increase of the life of the simulation up to about 30\u201340M . The slicing condition used\nfor this simulation is [63],\n\nwhere A is the area of the AH.\nIV.\n\nCartesian metric functions, along the diagonal for different resolutions together with the analytic solution at several time steps, performed with second-order finite differences in space. The convergence of the code can already\nbe seen in this panel, but this is better appreciated in the\nbottom-left panel, in which the Hamiltonian constraint\nis plotted at t = 2M for the three different resolutions.\nViolations of the Hamiltonian constraint are a measure of\nthe numerical error, and this figure shows that this error\nscales at the expected rate for second-order convergence.\nResults obtained with a fourth-order finite differencing\nare shown in the upper and lower right panels, where\nthe same quantities are plotted using this higher order\ndifferencing. Clearly, using fourth-order finite differencing increases the accuracy of the numerical evolutions,\nalthough the convergence rate for the highest resolution\nis not exactly fourth-order in the whole computational\ndomain. We note that in addition to the numerical error\ndue to the finite difference approximations for the spatial\nderivatives, there is another source of numerical error due\nto the interpolation needed with the Cartoon method.\n\nSchwarzschild BH with geodesic slicing\n\nFollowing the fixed puncture approach, we first evolve\nthese initial data with geodesic slicing, that is setting\n\u03b1 = 1 and \u03b2 i = 0. Although, in these coordinates, the\nnumerical evolution is known to last very short time and\nis expected to crash at t = \u03c0M when the spacelike hypersurface reaches the physical singularity, there is an\nanalytic solution for the evolution of the spacetime which\ncan be used to compare to the numerical solution.\nThe top-left panel in Fig. 1 shows the evolution of the\nradial metric component \u03b3\u0303rr , that is obtained from the\n\n(4.2)\n\nFigure 2 displays the time evolution of one of the components of the conformal three metric and the lapse function, and it proves how the new gauge condition enables\nfor longer simulations. For this simulation we consider a\ngrid resolution of \u2206x = 0.05M with Nx \u00d7 Nz = 200 \u00d7 200\ngrid points. As expected, the metric function \u03b3\u0303xx grows\ndue to the grid stretching related to the collapse of the\nlapse. In order to increase further the length of the simulations of a single BH spacetime, we have implemented\nthe moving puncture method, and its test is shown next.\nC.\n\nSchwarzschild BH and the moving puncture\napproach\n\nIt has been pointed out [52, 53, 64], that using the\n\"moving puncture method\" the numerical slices of a\nSchwarzchild BH spacetime reach a stationary state after\nabout 40M of evolution. [52] computed numerically this\ntime-independent puncture data for the Schwarzschild\nspacetime and showed that, as the evolution proceeds,\nthe initial slice settles down to a maximal slice with\nK = 0. This time-independent data has recently been\nobtained analytically by Baumgarte and Naculich [62].\nWith the aim of testing the ability of our code to perform long-term, stable and accurate, evolutions of a single BH, we first check the evolution of the BH punc-\n\n\f7\n\n5.2\n5\n4.8\n4.6\n0.2\n\n5.2\n5\n4.8\n4.6\n0.4\n\n0.6\n\n0.8\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nFIG. 1: Top-left panel: evolution of the conformal metric component \u03b3\u0303rr along the diagonal of the grid. Different lines refer\nto the numerical solution with resolutions of 100, 200, and 400 grid points in each direction. The analytical solution is also\nshown. Bottom-left panel: Hamiltonian constraints along the diagonal at time t = 2M for three different resolutions showing\nthe expected second-order convergence. The right panels show the same quantities and the expected convergence rate when\nusing fourth-order finite differencing.\n\nFIG. 2: Time evolution of the conformal metric component\n\u03b3\u0303xx and the lapse \u03b1 along the x-axis using 1 + log slicing.\n\nture analytical data given by [62], with the gauge conditions given by Eqs. (2.22)\u2013(2.24), and with two different\nmethods for the evolution of the conformal factor, the \u03c6-\n\nmethod, which uses Eq. (2.5), and the \u03c7-method which,\ninstead uses the evolution Eq. (2.20). For the damping\nparameter in the evolution equation for the shift, we set\n\u03b7 = 0.3/M .\nIn the upper panel of Fig. 3, we plot the absolute deviations for the conformal factor between our numerical solution and the exact solution at t = 9M obtained\nwith the \u03c6-method, for three runs with different resolutions (\u2206x = 0.12M, 0.06M, 0.03M , with Nx \u00d7 Nz =\n150 \u00d7 150, 300 \u00d7 300, 600 \u00d7 600). Deviations for the conformal factor are shown in the inner region of the grid,\nwhich at t = 9M is not affected by the outer boundary\nconditions. The inset, shows these deviations from the\nexact solution, but rescaled assuming fourth-order convergence. We note approximate fourth-order convergence\nfor the two lower resolutions runs (\u2206x = 0.12M, 0.06M ),\nbut, although still converging, the convergence rate decreases from fourth-order for the highest resolution run\n(\u2206x = 0.03M ) particularly in the region outside the AH.\nFor this resolution the error between the numerical and\nthe analytical solution in the region outside the AH is\nof the order of 10\u22125 \u201310\u22126 , and we find that increasing\nfurther the resolution does not reduce significantly this\nerror.\nIn the bottom panel of Fig. 3 we plot again the deviations for the conformal factor, however these are now\ncomputed using the \u03c7-method as well as the \u03c6-method,\nand obtained with the same resolution, \u2206x = 0.06M , at\nt = 9M . Clearly, the deviations from the exact solution\n\n\f8\n\nFIG. 3: In the top panel we consider as initial data the analytical solution proposed by Baumgarte and Naculich [62] and\nshow the deviations for the conformal factor from the exact\nsolution for different resolutions using the \u03c6-method. In the\ninset, we show deviations rescaled to show the convergence.\nIn the bottom panel, we show the deviations of the conformal factor using the same resolution, \u2206x = 0.06M , with the\n\u03c6-method as well as the \u03c7-method.\n\nFIG. 4: We show, with a solid line, the conformal factor given\nby Baumgarte and Naculich [62], and with solid circles the\nnumerical solution for the conformal factor at t = 200M of\nSchwarzschild spacetime in isotropic coordinates initial data\nwith the \u03c7-method and with empty circles the same quantity\nbut computed using the \u03c6-method.\n\nobtained with the \u03c7-method are smaller than with the\n\u03c6-method. In fact, these results are to be expected, as\n\u03c6 diverges like log r near the puncture, while \u03c7 behaves\nlike r2 near the puncture.\nWe next perform a comparison between the timeindependent analytical data [62] and the late time numerical solution of a Schwarzschild spacetime time, in\nisotropic coordinates, choosing initially \u03b1 = \u03c8 \u22122 . For\nthis comparison we use the same gauge conditions as\nabove, grid spacing \u2206x = \u2206z = 0.1M and a grid with\nNx \u00d7 Nz = 300 \u00d7 300 points to cover the computational\ndomain. In Fig. 4, we plot with a solid line the timeindependent analytical solution for the conformal factor,\nwhile solid circles indicate the numerical solution for the\nconformal factor of the Schwarzschild spacetime initial\ndata at t = 200M , computed using the \u03c7-method and\nempty circles correspond to the same quantity but using the \u03c6-method. Both simulations are compared at a\nsufficiently late time to allow us to evaluate the effect\nof the outer boundary conditions on the late time evolution. Clearly, the numerical solution agrees well with\nthe analytical solution, both for the \u03c7 and \u03c6 methods.\nHowever, again the \u03c7-method gives better results in the\nregion near the puncture. In addition, we observe that\nthe outer boundary conditions do not affect the long-term\nstability and accuracy of these simulations.\n\nV.\n\nHYDRODYNAMIC TESTS\n\nA.\n\nRelativistic shock tube test\n\nAs a first test of the solution of the relativistic hydrodynamic equations we perform a standard one dimensional\nshock-tube problem (a Riemann problem) in flat spacetime. This is a common test to assess hydrodynamical\ncodes (see e.g. [66]). In this test, two uniform and different fluid states are initially separated by an interface\nwhich is then instantaneously removed. The initial data\nfor the left state is PL = 13.33, \u03c1L = 10.00, vL = 0.00\nand for the right state PR = 0.66 \u00d7 10\u22126, \u03c1R = 1.00, vR =\n0.00, with the initial interface located at z = 0.5. The\nfluid is assumed to be an ideal fluid with \u0393 = 5/3.\nThe results of the numerical evolution are shown in\nthe left panels of Fig. 5, where we plot the profiles at\ntime t = 0.3 of the pressure, density and z-component\nof the fluid velocity for a shock-tube test along the zdirection. The solid line represents the exact solution\nof the shock-tube problem computed using the public\ndomain code RIEMANN developed by J.M. Mart\u0131\u0301 and E.\nM\u00fcller [67]. The numerical solution is represented by\ncrosses. We use 400 grid points in the z-direction and a\ngrid spacing of \u2206z = 1/400. The particular combination\nof schemes used for this hydrodynamical test comprise\nthe Roe solver, MC cell-reconstruction, and ICN for the\ntime update.\n\n\f9\n\nFIG. 5: Left panel: comparison of the numerical profiles of density, pressure and velocity with the analytical solutions for the\nsolution of a one dimensional shock tube problem at time t = 0.3. Right panel: wall shock problem with v = 0.9 at time\nt = 1.6. The exact solution is represented by the solid line and numerical solution by crosses.\n\nB.\n\nRelativistic planar shock reflection test\n\nIn our second test in Minkowski spacetime we carry out\na relativistic planar shock reflection problem along the zdirection with the following initial conditions P = 10\u22126 ,\n\u03c1 = 1.0 in the entire domain, while v = 0.9 for z < 0.5,\nand v = \u22120.9 for z > 0.5. We use an ideal fluid equation\nof state with \u0393 = 4/3. We show results of the evolution\nin the right panels of Fig. 5, where we plot the profiles of\nthe solution at time t = 1.6 for the pressure, density and\nz-component of the fluid velocity. Again, the solid lines\nrefer to the analytic solution while the numerical solution\nis represented by crosses. The schemes used for this simulation are the HLLE solver, minmod cell-reconstruction,\nand ICN for the time update.\n\nC.\n\nRelativistic spherical shock reflection test\n\nThe initial configuration for this test problem consists\nof a medium with uniform density (\u03c1 = 1) and pressure\n(P = 2.29 \u00d7 10\u22125 (\u0393 \u2212 1)) where \u0393 = 4/3, with constant\nspherical inflow velocity vin = \u22120.9 and Lorentz factor\nWin . Initially, at t = 0, the gas collides at the center of\nsymmetry which forms a strong shock wave that propagates upstream. The analytic solution for this test has\nthe following form [68]\n\n\uf8f1 \u0010\n\u00112\n\uf8f4\n\uf8f2 1 + |vin |t , r > vs t,\nr\n\u00112\n\u03c1(r, t) = \u0010\n\uf8f4\n\uf8f3 1 + |vin | \u03c3, r < vs t,\nvs\n\n(5.1)\n\nwith the compression ratio given by\n\u03c3=\n\n\u0393\n\u0393+1\n+\n(Win \u2212 1),\n\u0393\u22121 \u0393\u22121\n\n(5.2)\n\n\u0393\u22121\nWin |vin |.\nWin + 1\n\n(5.3)\n\nand the shock velocity by\nvs =\n\nThis test problem has been proposed by [69] to test\nthe ability of a three-dimensional special relativistic hydrodynamics code in Cartesian coordinates to keep the\nspherical symmetry of the solution. For our axisymmetric hydrodynamics code in Cartesian coordinates, this is\na two-dimensional test problem, which allow us to evaluate the solution of the hydrodynamic equations both in\nthe x and z directions. We use Nx \u00d7 Nz = 400 \u00d7 400 grid\npoints with \u2206x = \u2206z = 1/400 to cover the computational domain. The schemes used for this simulation are\nthe HLLE solver, minmod cell-reconstruction, and ICN\nfor the time update.\nWe show results of the evolution in Fig. 6, where we\nplot the profiles of the solution at time t = 3 for the\ndensity, pressure and fluid velocity along the diagonal.\nThe solid line represents the analytic solution while the\nnumerical solution is represented by crosses.\n\n\f10\n\nFIG. 6: Comparison of the numerical profiles of density, pressure and velocity with the analytical solutions for the solution\nof a relativistic spherical shock reflection test at time t = 3\n\nTo quantify the error we computed the relative global\nerror between the numerical P\nand the analytical solution defined by \u01ebrel = \u01ebabs /[ i,k |w(xi , zk , tn )|\u2206x\u2206z],\nP\nn\nwhere the absolute global error is \u01ebabs =\ni,k |wi,k \u2212\nn\nw(xi , zk , tn )|\u2206x\u2206z, wi,k\nis the numerical solution and\nw(xi , zk , tn ) is the analytical solution. We find that the\nrelative global errors for the density, pressure and velocity\nare 2.1%, 1.1% and 0.6% respectively. As for the previous shock-tube test and planar shock reflection test, the\nagreement achieved between the analytic and numerical\nsolution is remarkable.\n\nD.\n\nSpherical relativistic stars in a fixed spacetime\n\nFor the next test we use the solution of the TolmanOppenheimer-Volkoff equations to assess the capability\nof the code to perform long-term stable numerical simulation of a NS in equilibrium. In order to check the\nhydrodynamical evolution independently from the spacetime evolution we follow the common approach of keeping\nthe spacetime fixed during the numerical evolution. This\nis known as the Cowling approximation [70], in analogy\nwith the corresponding approximation in perturbative\nstudies of stellar oscillations in which the metric components (or the gravitational potential in the Newtonian\nframework) are kept constant.\nIt has been shown [59] that the truncation errors of the\nfinite difference representation of the PDEs are enough\nto excite small periodic radial oscillations which manifest\nthemselves as periodic variations of the hydrodynamical\n(and spacetime) quantities. The power spectrum of the\n\nevolution of the central density provides the frequencies\nof the fundamental mode of oscillation and of its overtones, which can be compared with the corresponding\nfrequencies computed by perturbative techniques. Although the excited oscillations are purely numerical in\norigin (i.e. their amplitude converges to zero as the resolution increases) they still represent the oscillation modes\nof the relativistic star and their frequencies should agree\nwith the eigenfrequencies computed by linear perturbation analysis. For the purposes of further testing the\ncode and compare with independent results we focus on\nan initial TOV model that has been extensively investigated numerically by [59, 65]. This model is a relativistic star with N = 1, polytropic constant \u03ba = 100 and\ncentral rest-mass density \u03c1c = 1.28 \u00d7 10\u22123 so that its\nmass is M = 1.4, its baryon rest-mass M\u2217 = 1.5 and\nits radius R = 9.59. We evolve these initial data with\nour non-linear code and compute the power spectrum of\nthe evolution of the central rest-mass density. We note\nthat in the simulations of spherical stars in equilibrium\npresented below, we use the polytropic equation of state\nduring the evolution.\nIn the upper-left panel of Fig. 7 we plot the time evolution of the central rest-mass density for a simulation\nwith \u2206x = 0.15. We observed that the truncation errors at this resolution are enough to excite small periodic radial oscillations, visible in this plot as periodic\nvariations of the central density. We see that the damping of the periodic oscillations of the central rest-mass\ndensity is very small during the whole evolution, which\nhighlights the low numerical viscosity of the schemes implemented. By computing the Fourier transform of the\ntime evolution of the central rest-mass density we obtain\nthe power spectrum, which is shown with a solid line in\nthe lower-left panel of the figure, while the dashed vertical lines indicate the fundamental frequency and the\nfirst five overtones computed by [65] with a non-linear\nhydrodynamics code using spherical polar coordinates.\nThe agreement found for the fundamental frequency and\novertones is very good, with the relative error between\nthe fundamental frequencies being less than 1%.\n\nE.\n\nSpherical relativistic stars in a dynamical\nspacetime\n\nFor our first test of the coupling of the Einstein equations and the general relativistic hydrodynamic equations\nwe again use the TOV solution. In analogy to what happens in the Cowling approximation, truncation errors excite small oscillations in the star. Now, however, the\ntruncation errors come not only from the hydrodynamic\npart of the code but also from the spacetime part solving\nthe full set of Einstein equations.\nWe computed the eigenfrequencies of the coupled evolution of the same TOV star with \u03ba = 100, N = 1 and\ncentral rest-mass density \u03c1c = 1.28\u00d710\u22123 which has been\ndiscussed above under the assumption of a fixed back-\n\n\f11\n\nFIG. 7: Top panels show the time evolution of the normalized central density, in the Cowling approximation (left panel), and\nin a dynamical spacetime evolution (right panel). Power spectrum of the evolution of the central rest-mass density for an\nM = 1.4, \u03ba = 100, N = 1 polytrope in the Cowling approximation (bottom-left panel). F represents the frequency of the\nfundamental mode and H1-H6 are the first six overtones computed by [65]. Correspondingly, the bottom-right panel shows the\nsame quantities in a dynamical spacetime evolution of the same TOV star. The frequencies computed by [59] are displayed\nwith dashed vertical lines.\n\nground spacetime. Again, the radial oscillations excited\nby truncation errors manifest in the time evolution of the\ncentral rest-mass density. The coupling to the spacetime\nincreases the amplitude of the oscillations, and also shifts\nthe frequencies of the modes towards lower frequencies.\nThis is shown in the lower-right panel of Fig. 7 which displays the power spectrum of the evolution of the central\nrest-mass density (solid line), and the eigenfrequencies\ncomputed by [59] (dashed lines). We note that the locations of the frequency peaks for the fundamental mode\nand the two overtones is in very good agreement, with\nthe relative error in the fundamental frequencies being\nless than 1%.\n\nF.\n\nGravitational collapse of marginally stable\nspherical relativistic stars\n\nWe next test the capability of the code to follow BH\nformation with the gravitational collapse to a BH of a\nmarginally stable spherical relativistic star. For this test,\nwe consider a \u03ba = 100, N = 1 polytropic star with central\nrest-mass density \u03c1c = 3.15 \u00d7 10\u22123 , its mass is M = 1.64\nand its baryon rest-mass M\u2217 = 1.79. In order to induce\nthe collapse of the star we initially increase the rest-mass\ndensity by 0.5%.\nWe present numerical results for the simulation of\nthe gravitational collapse of a marginally stable spher-\n\nFIG. 8: Time evolution of the normalized central density,\nthe central lapse function, and mass of the AH in units of\nthe ADM mass of the system for the collapse of a marginally\nstable spherical star to a BH. Dotted lines represent results\nobtained with the lowest resolution, dashed lines with the\nmedium resolution while solid lines with the highest resolution.\n\n\f12\nical relativistic star performed with \u2206x = \u2206z =\n0.1M, 0.075M, 0.05M to show the convergence of the\ncode. With these resolutions the star is initially covered\nby approximately 60, 80 and 120 points. The hydrodynamics equations are solved using the Roe solver and MC\nreconstruction, while the Einstein equations are solved\nwith fourth-order finite differencing and the gauge conditions given in Eqs. (2.22)\u2013(2.24), with \u03b7 = 0.5. Time\nintegration is done with RK4. We plot in Fig. 8 the time\nevolution of the normalized central density (top panel),\nof the lapse function at the center (middle panel), and\nof the mass of the AH (Eq. 3.4) in units of the ADM\nmass of the system (bottom panel). Dotted lines represent results obtained with the lowest resolution, dashed\nlines with the medium resolution while solid lines with\nthe highest resolution. Overall, as the collapse proceeds\nthe star increases its compactness, and is reflected in the\nincrease of the central density as shown in the top panel.\nThe middle panel shows the characteristic collapse of the\nlapse function at the center of the star indicating the formation of a BH. The most unambiguous signature of the\nformation of a BH during the simulation is the formation of an AH. Once an AH is found by the AH finder,\nwe monitor the evolution of the AH area, and also of\nits mass which is plotted, in the bottom panel of Fig. 8.\nThis panel shows that the formation of the BH delays\nwith decreasing resolution, since the increase of the central density slows down because numerical dissipation is\nlarger for the lower resolution runs. An AH is first found\nat approximately at t = 180M (t = 0.88 ms) for the simulation with \u2206x = \u2206z = 0.05M . This figure also shows\nthat the mass of the AH relaxes to the ADM mass of the\nsystem. The difference in the ADM mass and the mass of\nthe AH when we stop the evolution at t = 300M , about\n120M after the AH is first found, is less than 1%.\nThis test shows that the code is able to follow BH formation and its subsequent evolution for many timescales.\nWe note that, unlike the results discussed in [29], we do\nnot need to add any numerical dissipation to the evolution equations for the spacetime variables and gauge\nquantities to perform this simulation. Instead, we rely\nonly on the gauge choice used here to follow the formation and evolution of the BH formed as a result of the\ngravitational collapse.\n\nG.\n\nRapidly rotating relativistic stars\n\nThe evolution of stable rapidly rotating relativistic\nstars is a more demanding test than all previous ones, as\nthis involves testing parts of the code that are now used\nsince there is a non-zero y-component of the shift vector.\nThe initial data used for this test are the numerical solution of a stationary and axisymmetric equilibrium model\nof a rapidly and uniformly rotating relativistic star with\nangular velocity \u03a9, which has been computed using the\nWhisky code [29, 71]. The initial data for this equilibrium\nrotating star are initially computed in spherical polar co-\n\nFIG. 9: Profile of the y-component of the velocity of a rapidly\nrotating relativistic star along the x-axis, at the initial time\n(solid line) and at time t = 2.46 ms, which corresponds to 2\nrotational periods.\n\nordinates and then transformed to Cartesian coordinates\nusing the standard coordinate transformation.\nHere, we consider a uniformly rotating polytropic star\nwith \u0393 = 2, \u03c1c = 1.28 \u00d7 10\u22123 , and rotating at 92% of\nthe allowed mass-shedding limit for a star with the same\ncentral rest-mass density. The ratio of the polar to equatorial coordinate radii for this model is 0.7, its mass is\nM = 1.57 and its baryon rest-mass M\u2217 = 1.69. For this\nsimulation we use the \"1+log\" condition for the lapse,\nand the \"Gamma-freezing\" condition for the shift vector, with \u03b7 = 3.0. We use the so-called \u0393-law equation of\nstate during the evolution.\nFor this test, the outer boundary of the grid is placed\nabout three times the equatorial radius. We check that\nduring the evolution, the profiles of the different variables are kept very close to their initial value for several\nrotational periods, which is shown in Fig. 9. Here we\ndisplay the profile of the y-component of the velocity, v y ,\nalong the x-axis at the initial time, t = 0 (solid line)\nand at t = 2.46 ms (dashed line), with the latter corresponding to two rotational periods. As has been shown\nby [59, 72], the small difference originating at the surface\nof the star after two rotational periods is expected since\nwe used a second order reconstruction method with the\nMC limiter. Nevertheless, it shows that deviations of the\nnumerical solution from the initial profile are very small.\n\n\f13\n\nFIG. 10: Isocontours of the logarithm of the rest-mass density of the torus. The left panel shows the configuration at the initial\ntime and the right panel the corresponding distribution after 5 dynamical timescales (approximately 1000M ). The equilibrium\nsolution is preserved to high accuracy.\n\nVI. SIMULATIONS OF SELF-GRAVITATING\nTORUS IN EQUILIBRIUM AROUND A BH\nA.\n\nInitial data for BH and self-gravitating torus\nsystem\n\nThe initial data for the numerical simulations of the\nsystem formed by a BH and a self-gravitating torus in\naxisymmetric equilibrium have been recently computed\nby [30]. The basic equations for the metric functions\nare derived assuming the 3+1 formalism, and the line\nelement is written in the quasi-isotropic form as\nds2 = \u2212\u03b12 dt2 +\u03c8 4 [e2q (dr2 +r2 d\u03b82 )+r2 sin2 \u03b8(\u03b2dt+d\u03c6)2 ].\n(6.1)\nWhere e2q denotes the conformal metric for the rr and \u03b8\u03b8\nparts. The equations for the metric functions are solved\nin the BH puncture framework, and it is assumed that\nthe puncture is located at the origin.\nThe equilibrium configurations for the matter are obtained by assuming a perfect fluid stress-energy tensor,\nand adopting a polytropic equation of state. The only\nnonzero components of the fluid four-velocity are ut and\nu\u03c6 , and initial configurations can be constructed with\neither constant or non-constant specific angular momentum distributions, defined as j \u2261 hu\u03c6 . We refer to [30]\nfor a full explanation of the construction of the initial\nmodel. For the simulations reported in this paper, we\nhave considered a torus around a Schwarzschild BH (of\nmass MBH = 1). The adiabatic index is \u0393 = 4/3 to\nmimic a degenerate relativistic electron gas, and the polytropic constant \u03ba is fixed to \u03ba = 0.0301262 such that the\ntorus-to-BH mass ratio, Mt /MBH , is roughly 0.1.\nThe initial model is computed on a spherical grid.\nTherefore, in order to use it as initial data for our evolution code, we transform into Cartesian coordinates and\ninterpolate the values of the metric functions and hydro-\n\ndynamic variables onto a cell-centered Cartesian uniform\ngrid, retaining data for the y = 0 plane.\nThe chosen torus has a constant distribution of specific angular momentum such that its inner and outer\nedges on the equatorial plane are located at rin = 7.1M\nand rout = 14.0M , where M is ADM mass of system.\nThus, such torus is initially covered with approximately\n140 points along the x-axis. The center of the torus is\ndefined as the location at which the rest-mass density\nreaches its maximum and it is located at rmax = 9.8M .\nThe dynamical timescale, which we choose as the orbital\nperiod at the center of the torus, is torb = 223M , that\ncorresponds to about 1.1ms for the case that M = M\u2299 .\nFor these simulations we use an equally spaced uniform\ngrid with a grid spacing \u2206x = \u2206z = 0.05M and a grid\nwith Nx \u00d7Nz = 600\u00d7600 points to cover a computational\ndomain, 0 \u2264 x \u2264 L and 0 \u2264 z \u2264 L, with L = 30M . We\nuse 4th-order finite differencing for the spacetime evolution, and Roe solver with MC reconstruction for the\nhydrodynamic evolution. The time integration is done\nwith RK4.\n\nB.\n\nDynamics in a fixed spacetime\n\nWe have first investigated the equilibrium of the torus\nby performing numerical evolutions in a fixed spacetime,\nwhich nevertheless has the contribution coming from the\nself-gravity of the torus itself. This permits for one more\ntest of the ability of the code to keep the stationarity of a\nfluid configuration initially in equilibrium. The accuracy\ncheck of the evolution is performed by comparing the\nstationarity and conservation of different local and global\nfluid quantities over a timescale which is several times the\ndynamical one.\nWe show in Fig. 10 the isocontours of the logarithm\nof the rest-mass density of the torus as computed at\n\n\f14\n\nFIG. 11: Time evolution of the total rest-mass, central restmass density and total angular momentum, each of them\nnormalized to its initial value, for the evolution of a selfgravitating torus on a fixed spacetime.\n\nthe initial time t = 0 (left panel) and at t = 1100M\n(right panel), the later corresponding to 5 dynamical\ntimescales, when the code was stopped after approximately 3 \u00d7 104 iterations, with no sign of the presence of\nnumerical instabilities. These snapshots of the rest-mass\ndensity distribution clearly show the stationarity of the\ninitial model for a sufficiently long period of time, and\nthat the morphology of the torus remains unchanged for\nthe duration of the simulation. In addition, they reflect\nthat the treatment of the atmosphere in the vacuum region does not perturb the equilibrium, and does not affect\nthe dynamics during the evolution.\nOther quantities that provide a more precise measure\nof the stationarity of the torus are displayed in Fig. 11,\nin which we plot the time evolution of three fluid quantities normalized to their initial values. On the top panel,\nwe plot the time evolution of the total rest-mass of the\ntorus, normalized to its initial value. At the end of the\nsimulation, the difference between the final total restmass with respect to the initial value is less than 10\u22123 .\nThis decrease of 0.1% of the total rest-mass is due to\nnumerical error during the evolution, as the rest-mass\nis not conserved exactly. However, this error does not\naffect significantly the stability of the torus for the duration of our simulation. Similar results are obtained for\nthe time evolution of the other two quantities, the central rest-mass density and the total angular momentum,\nwhich are displayed in the lower two panels of Fig. 11,\nrespectively. The central rest-mass density, after a short\ninitial transient phase, settles down to a stationary value\n\nFIG. 12: The upper panel shows the time evolution of the normalized central rest-mass density of a perturbed torus model,\nwhile the lower panel displays the power spectrum obtained\nafter Fourier transforming the time evolution of the central\nrest-mass density. The fundamental mode and first overtone\nfrequencies are denoted by f and o1 . The mass of the BH is\ntaken to be 1M\u2299 .\n\nwhich only differs after t = 1000M by 1% from the initial one. This provides a strong evidence of the ability\nof the code to keep the torus in equilibrium for evolutions longer than the characteristic dynamical timescales\nof these objects.\nNotwithstanding the use of Cowling approximation, we\ncan nevertheless extract some information about the oscillating behavior of these type of self-gravitating tori.\nWe note that in a series of recent papers, [73, 74, 75,\n76, 77], it was shown that upon the introduction of perturbations, non self-gravitating relativistic tori in equilibrium manifest a long-term oscillatory behavior lasting\nfor tens of orbital periods. An important feature of these\naxisymmetric p-mode oscillations of accretion tori is that\nthe lowest-order eigenfrequencies appear in the harmonic\nsequence 2 : 3. Overall, it was found that the 2 : 3 harmonic sequence was present with a variance of \u223c 10%\nfor tori with a constant distribution of specific angular\nmomentum and with a variance of \u223c 20% for tori with\na power-law distribution of specific angular momentum.\nThe departure from the 2 : 3 harmonic sequence depends\non a number of different elements that contribute to small\ndeviations, such as the vertical size of the tori, the BH\nspin, the distribution of specific angular momentum, the\nEOS considered, and the presence of a small but nonzero\nmass-loss, which can all influence this departure.\nIn order to trigger the phase of small oscillations of the\n\n\f15\n\nFIG. 13: Isocontours of the logarithm of the rest-mass density\nof the torus during the evolution on a dynamical spacetime\nat t = 600M .(Compare with the left panel of Fig. 10.)\n\nself-gravitating torus in our simulations, we perturb the\nequilibrium solution by adding a small perturbation in\nthe x-component of the velocity (we recall that in equilibrium the x and z-components of the velocity are zero).\nThe oscillations reflect in the time evolution of the different fluid quantities, for instance, the central rest-mass\ndensity, which we Fourier-transform to obtain the resulting power spectra. This shows distinctive peaks at the\nfrequencies that can be identified with the quasi-normal\nmodes of oscillation of the disk. In Fig. 12 we present,\nin the upper panel, the time evolution of the normalized\ncentral rest-mass density of the perturbed model. Due\nto the initial perturbation, the torus shows a persistent\noscillating phase around its equilibrium position. We follow the evolution for about 13 dynamical timescales, and\ncompute the power spectrum obtained from the normalized central rest-mass density, which is shown in the lower\npanel. A rapid look at this figure reveals that the torus\npower spectrum shows features which are very similar to\nthose mentioned above for non self-gravitating tori (see\ne.g. Fig. 4 of [76]). Namely, it can be clearly identified in the spectrum a fundamental mode f , and a first\novertone o1 . Interestingly, the ratio of the fundamental\nmode and the first overtone also show approximately the\n2 : 3 harmonic relation with o1 /f \u223c 1.4. In addition,\nthe power spectrum reveals a series of higher frequency\npeaks, which roughly coincide with linear combinations\nof the f mode and first overtones. However, simulations\nlasting for longer timescales are needed to unambiguously\nidentify these peaks.\nC.\n\nEvolutions on a dynamical spacetime\n\nNext, we evolve the same torus and BH initial data in\na fully dynamic way, solving the Einstein equations coupled to the general relativistic hydrodynamics equations.\n\nFIG. 14: Time evolution of the total rest-mass density, central rest-mass density and total angular momentum, each of\nthem normalized to its initial value, for the evolution on a\ndynamical spacetime.\n\nFor such simulations we use the gauge conditions given\nin Eqs. (2.22)\u2013(2.24) together with the \u03c7-method, which\nallow for long-term and stable evolutions of the puncture.\nIn our simulations of the system formed by a BH plus\na self-gravitating torus, the spacetime evolution is highly\ndynamical until t \u2243 30M due to the initial adjustment\nof the gauge, which produces a small pulse in the metric\nfunctions that propagates outwards. Outgoing radiative\nboundary conditions for the spacetime variables at the\nouter boundaries, permit this initial pulse to leave the\ngrid. Despite this initial transient phase, the torus remains in equilibrium during the evolution, and its morphology is kept very close to the initial profile even several hundred M beyond the first orbit when we stopped\nour simulation. In Fig. 13, we plot the isocontours of\nthe logarithm of the rest-mass density of the torus at\ntime t = 600M , which is close to 3 dynamical timescales.\nThis figure clearly demonstrates that the configuration\nremains in equilibrium. Other quantities also exhibit this\nbehavior. In particular, in Fig. 14, we plot the time evolution of the total rest-mass of the torus (top panel), the\ncentral rest-mass density (middle panel), and the total\nangular momentum (lower panel), each normalized to its\ninitial value, for the duration of the simulation. At the\nend of the simulation, the difference between the final total rest mass with respect to the initial value is less than\n0.1%. Although it is due to accumulated numerical error\nduring the evolution, this violation of the rest mass does\nnot affect significantly the stability of the torus for the\nduration of our simulation. Similar results are obtained\n\n\f16\nfor the time evolution of the other two quantities, the\ncentral rest-mass density and the total angular momentum. We note that, truncation errors at the resolution\nemployed seem to be enough to trigger small oscillations\nof the torus around its equilibrium as shown in the evolution of the central rest-mass density.\nIt is worth to mention, that in order to maintain the\ntorus in equilibrium for several hundred M , we find crucial not to replace the \u0393\u0303i by \u2212\u2202j \u03b3\u0303 ij on the right hand side\nof the evolution Eq. (2.9) whenever is not differentiated.\nReplacing \u0393\u0303i by \u2212\u2202j \u03b3\u0303 ij excites larger amplitude oscillations of the torus, which can be more than 10% larger\nthan in the case where \u0393\u0303i is not replaced by its definition. We note also that, as observed for single puncture\nsimulations in vacuum, numerical errors in the spacetime\nevolution, especially near the puncture, are smaller with\nthe \u03c7-method than with the \u03c6-method. We find that\nan additional ingredient that helps to maintain the torus\nequilibrium for the duration of the simulations is the use\nof the \u03c7-method for the evolution of the conformal factor (we refer to Fig. 3 and Fig. 4 for a comparison of the\n\u03c7-method and \u03c6-method). We find numerical indications\nthat, at least in conjunction with the Cartoon method,\nthese two procedures help to decrease the error in the\nviolation of the Hamiltonian constraint.\n\nVII.\n\nCONCLUSION\n\nIn this paper we have presented a new two-dimensional\nnumerical code designed to solve the full Einstein equations coupled to the general relativistic hydrodynamics\nequations. The code is mainly intended for studies of\nself-gravitating accretion disks around BHs, although it\nis also suitable for regular spacetimes.\nConcerning technical aspects, the Einstein equations\nare formulated and solved in the code using a reformulation of the standard 3+1 (ADM) system, the so-called\nBSSN approach, in conjunction with the Cartoon method\nto impose the axisymmetry condition under Cartesian coordinates, and the puncture/moving puncture approach\nto carry out BH evolutions. We note that a key and\nnovel feature of the code is that combines a fourth-order\nfinite difference approximation for derivative terms in the\nspacetime evolution with the Cartoon method. Correspondingly, the general relativistic hydrodynamics equations are written in flux-conservative form and solved\nwith high-resolution, shock-capturing schemes.\nWe have performed and discussed a number of tests to\nassess the accuracy and expected convergence of the code,\nnamely (single) BH evolutions, shock tubes, and evolutions of both spherical and rotating relativistic stars. We\nhave also presented a simulation of the gravitational collapse to a BH of a marginally stable spherical star. We\nhave shown that the code is able to handle the formation of a BH, and to follow the BH evolution until we\nthe simulation is stopped after several hundred M . We\nremark that we did not add any numerical dissipation to\n\nthe evolution equations for the spacetime variables and\ngauge quantities to perform this simulation; and exclusively relied on the gauge choice to follow the BH formation and its long-term evolution. Overall, the code has\npassed those tests with remarkable accuracy.\nIn addition, paving the way for specific applications of\nthe code, we have also presented results from fully general relativistic numerical simulations of a system formed\nby a BH surrounded by a self-gravitating torus in equilibrium. First, simulations using a fixed spacetime evolution, have shown that the torus remains in equilibrium\naround its initial configuration for more than 5 dynamical\ntimescales, when the simulation was stopped. Furthermore, after adding a small perturbation on the torus in\nequilibrium, we have followed the evolution of the torus\nthrough a phase of small oscillations for more than 13\ndynamical timescales. The computation of the frequencies of the fundamental mode of oscillation and the first\novertone revealed that these two frequencies appear close\nto the 2:3 harmonic relation observed for the case of non\nself-gravitating relativistic tori.\nOur simulation of the same model in a dynamical\nspacetime, showed that the code is able to keep the torus\nin equilibrium for the several hundred M that lasted the\nsimulation. We have found numerically, that using the \u03c7method and not to replace the \u0393\u0303i by \u2212\u2202j \u03b3\u0303 ij on the right\nhand side of the evolution for the \u0393i are two important\nissues that reduce the numerical error in the spacetime\nevolution, and therefore, help to maintain the torus in\nequilibrium.\nOverall, the simulations performed indicate that the\ncode is able to perform such simulations accurately and\nfor the sufficient duration needed to produce scientific results for one of the specific applications for which it has\nbeen designed, the investigation of the runaway instability of thick accretion disks around BHs. We point out\nthat the last simulation presented in the paper is the first\n2D axisymmetric simulation of the system formed by selfgravitating torus around a BH in a dynamical spacetime\nthat has been ever carried out. In a follow up paper, we\naim to present results from an expanded range of initial\nmodels, and to investigate in detail the dynamics of such\nsystems, focusing on the development on the runaway instability, and the evolution of the BH due to the transfer\nof mass and angular momentum from the torus.\n\nAcknowledgments\n\nIt is a pleasure to thank K. Uryu for many useful discussions, as well as to L. Rezzolla and J.C. Miller for\nmany valuable comments, and J.M. Ib\u00e1\u00f1ez also for carefully reading this manuscript. We also thank L. Baiotti\nfor computing the initial data for the rotating relativistic star discussed in Section VF, computed with the\nRNSID thorn by N. Stergioulas. P.M. has benefited from\na VESF fellowship of the European Gravitational Observatory (EGO-DIR-126-2005). This research has been\n\n\f17\npartially supported by the Spanish Ministerio de Educaci\u00f3n y Ciencia (grant AYA2007-67626-C03-01). M.S.\nacknowledges support from Japanese Monbukagaku-sho\nGrant Nos. 19540263 and 20041004. The computations\n\nhave been performed on the computer \"CERCA2\" of the\nDepartment of Astronomy and Astrophysics of the University of Valencia.\n\n[1] L. Baiotti, B. Giacomazzo and L. Rezzolla (2008),\narXiv:0804.0594.\n[2] S. E. Woosley, Astrophys. J. 405, 273 (1993).\n[3] B. Paczynski, Astrophys. J. Lett. 494, L45 (1998).\n[4] Y. Sekiguchi and M. Shibata, Phys. Rev. D 70, 084005\n(2004).\n[5] Y. Sekiguchi and M. Shibata, Prog. Theor. Phys. 117,\n1029 (2007).\n[6] B. C. Stephens, M. D. Duez, Y. T. Liu, S. L. Shapiro and\nM. Shibata, Class. Quantum Grav. 24, S207 (2007).\n[7] M. Shibata, M. D. Duez, Y. T. Liu, S. L. Shapiro and B.\nC. Stephens, Phys. Rev. Lett. 96, 031102 (2006).\n[8] M. Shibata and K. Uryu, Phys. Rev. D 61, 064001 (2000).\n[9] M. Shibata, K. Taniguchi and K. Uryu, Phys. Rev. D 68,\n084020 (2003).\n[10] P. Marronetti, M. D. Duez, S. L. Shapiro and T. W.\nBaumgarte, Phys. Rev. Lett. 92, 141101 (2004).\n[11] M. Shibata, K. Taniguchi and K. Uryu, Phys. Rev. D 71,\n084021 (2005).\n[12] M. Shibata and K. Taniguchi, Phys. Rev. D 73, 064027\n(2006).\n[13] M. Shibata and K. Uryu, Phys. Rev. D 74, 121503 (2006).\n[14] M. Shibata and K. Uryu, Class. Quantum Grav. 24, 125\n(2007).\n[15] T. Piran, Phys. Rept. 314, 575 (1999).\n[16] M. A. Aloy, E. M\u00fcller, J. Ma . Ib\u00e1nez, J. Ma . Mart\u0131\u0301 and\nA. MacFadyen, Astrophys. J. 531, L119 (2000).\n[17] M. A. Aloy and H. T. Janka and E. M\u00fcller, Astron. Astrophys. 436, 273 (2005).\n[18] P. Meszaros, Rep. Prog. Phys. 69, 2259 (2006).\n[19] M. A. Abramowicz, M. Calvani and L. Nobili, Nature\n302, 597 (1983).\n[20] J. A. Font and F. Daigne, MNRAS 334, 383 (2002).\n[21] F. Daigne and J. A. Font, MNRAS 349, 841 (2004).\n[22] J. A. Font, Living Rev. Relativity 6, 4 (2003).\n[23] S. Brandt and J. A. Font, Proceedings of the 8th Marcel\nGrossmann Meeting on General Relativity, edited by T.\nPiran (World Scientific, Singapore), pp. 744-746.\n[24] S. Brandt, J. A. Font, J. M. Ib\u00e1\u00f1ez, J. Mass\u00f3 and E.\nSeidel, Comp. Phys. Comm. 124, 169 (2000).\n[25] M. Campanelli, C. O. Lousto, P. Marronetti and Y. Zlochower, Phys. Rev. Lett. 96, 111101 (2006).\n[26] J. G. Baker, J. Centrella, D. I. Choi, M. Koppitz and J.\nvan Meter, Phys. Rev. Lett. 96, 111102 (2006).\n[27] F. Pretorius (2007) arXiv:0710.1338.\n[28] J. A. Faber, T. W. Baumgarte, Z. B. Etienne, S. L.\nShapiro and K. Taniguchi, Phys. Rev. D 76, 104021\n(2007).\n[29] L. Baiotti and L. Rezzolla, Phys. Rev. Lett. 97, 141101\n(2006).\n[30] M. Shibata, Phys. Rev. D 76, 064035 (2007).\n[31] S. Nishida and Y. Eriguchi, Astrophys. J. 427, 429\n(1994).\n[32] M. Ansorg and D. Petroff, Phys. Rev. D 72, 024019\n(2005).\n\n[33] T. Nakamura, K. Oohara and Y. Kojima, Prog. Theor.\nPhys. Suppl. 90, 1 (1987).\n[34] M. Shibata and T. Nakamura, Phys. Rev. D 52, 5428\n(1995).\n[35] T. W. Baumgarte and S. L. Shapiro, Phys. Rev. D 59,\n024007 (1999).\n[36] F. Banyuls, J. A. Font, J. M. Ib\u00e1nez, J. M. Mart\u0131\u0301 and\nJ. A. Miralles,Astrophys. J. 476, 221 (1997).\n[37] M. Shibata, Phys. Rev. D 67, 024033 (2003).\n[38] M. Alcubierre, S. Brandt, B. Br\u00fcgmann, D. Holz, E. Seidel, R. Takahashi and J. Thornburg, Int. J. Mod. Phys.\nD 10, 273 (2001).\n[39] S. Brandt and B. Br\u00fcgmann, Phys. Rev. Lett. 78, 3606\n(1997).\n[40] D. Brill and R. Lindquist, Phys. Rev. 131, 471 (1963).\n[41] B. Br\u00fcgmann, Int. J. Mod. Phys. D 8, 85 (1999).\n[42] M. Alcubierre, W. Benger, B. Br\u00fcgmann, G. Lanfermann, L. Nerger, E. Seidel and R. Takahashi, Phys. Rev.\nLett. 87, 271103 (2001).\n[43] M. Alcubierre, B. Br\u00fcgmann, P. Diener, M. Koppitz, D.\nPollney, E. Seidel and R. Takahashi, Phys. Rev. D 67,\n084023 (2003).\n[44] M. Campanelli, C. O. Lousto, Y. Zlochower, B. Krishnan\nand D. Merritt, Phys. Rev. D 75, 064030 (2007).\n[45] J. G. Baker, S. T. McWilliams, J. van Meter, J. Centrella,\nD. I. Choi, B. J. Kelly and M. Koppitz, Phys. Rev. D 75,\n124024 (2007).\n[46] J. A. Gonz\u00e1lez, M. Hannam, U. Sperhake, B. Br\u00fcgmann,\nand S. Husa, Phys. Rev. Lett. 98, 231101 (2008).\n[47] P. Marronetti, W. Tichy, B. Br\u00fcgmann, J. Gonz\u00e1lez and\nU. Sperhake, Phys. Rev. D 77, 064010 (2008).\n[48] L. Rezzolla, P. Diener, E. N. Dorband, D. Pollney, C.\nReisswig, E. Schnetter and J. Seiler, Astrophys. J. 674,\nL29 (2008).\n[49] D. Pollney, C. Reisswig, L. Rezzolla, B. Szil\u00e1gyi, M. Ansorg, B. Deris, P. Diener, E. N. Dorband, M. Koppitz, A.\nNagar and Schnetter, Phys. Rev. D 76, 124002 (2007).\n[50] F. Herrmann, I. Hinder, D. M. Shoemaker, P. Laguna,\nR. A. Matzner, Phys. Rev. D 76, 084032 (2007).\n[51] C. Bona, J. Mass\u00f3, E. Seidel and J. Stela, Phys. Rev. D\n56, 3405 (1997).\n[52] M. Hannam, S. Husa, B. Brgmann, J. A. Gonzlez, U.\nSperhake and N. OMurchadha, Journal of Physics: Conference Series 66, 012047 (2007).\n[53] B. Br\u00fcgmann, J. A. Gonzalez, M. Hannam, S. Husa, U.\nSperhake and W. Tichy (2006), ArXiv:gr-qc/0610128\n[54] J. van Meter, J. G. Baker, M. Koppitz and D. I. Choi,\nPhys. Rev. D 73, 124011 (2006).\n[55] S. A. Teukolsky, Phys. Rev. D 61, 087501 (2000).\n[56] R. J. Spiteri and S. J. Ruuth, SIAM J. Num. Analysis,\n40, 2, 469 (2002).\n[57] Y. Zlochower, J. G. Baker, M. Campanelli and C. O.\nLousto, Phys. Rev. D 72, 024021 (2005).\n[58] W. H. Press, B. P. Flannery, S. A. Teukolsky and W.\nT. Vetterling,Numerical Recipes (Cambridge University\n\n\f18\nPress, New York, 1992)\n[59] J. A. Font, T. Goodale, S. Iyer, M. Miller, L. Rezzolla, E.\nSeidel, N. Stergioulas, W. M. Suen and M. Tobias, Phys.\nRev. D 65, 084024 (2002).\n[60] M. Shibata, Phys. Rev. D 55, 2002 (1997).\n[61] J. Thornburg, Living Rev. Relativity 10, 743 (2007)\n[62] T. W. Baumgarte and S. G. Naculich, Phys. Rev. D 75,\n067502 (2007).\n[63] B. Imbiriba, J. Baker, D. Choi, J. Centrella, D. R. Fiske,\nJ. D. Brown, J. R. van Meter and K. Olson, Phys. Rev.\nD 70, 124025 (2004).\n[64] M. Hannam, S. Husa, D. Pollney, B. Brgmann and N.\nOMurchadha, Phys. Rev. Lett. 99, 241102 (2007).\n[65] J. A. Font, N. Stergioulas and K. D. Kokkotas, MNRAS\n313, 678 (2000).\n[66] J. M. Mart\u0131\u0301 and E. M\u00fcller, J. Comput. Phys. 123, 1\n(1996).\n[67] J. M. Mart\u0131\u0301 and E. M\u00fcller, Living Rev. Relativity (2003).\n[68] J. M. Mart\u0131\u0301 and E. M\u00fcller and J. A. Font and J. M.\nIb\u00e1\u00f1ez and A. Marquina, Astrophys. J., 479, 151, (1997).\n\n[69] M. A. Aloy and J. M. Ib\u00e1\u00f1ez and J. M. Mart\u0131\u0301 and E.\nM\u00fcller, ApJS, 122, 151, (1999).\n[70] T. G. Cowling, MNRAS 101, 367 (1941).\n[71] L. Baiotti, I. Hawke, P. Montero and L. Rezzolla, in Mem.\nSoc. Astron. It., edited by R. Capuzzo-Dolcetta (2003),\nvol. 1, p.327.\n[72] N. Stergioulas and J.A. Font, Phys. Rev. Lett. 86, 1148\n(2001).\n[73] O. Zanotti, L. Rezzolla and J. A. Font, MNRAS 341, 832\n(2003).\n[74] L. Rezzolla, S. Yoshida and O. Zanotti, MNRAS 344,\n978 (2003).\n[75] P. J. Montero, L. Rezzolla and S. Yoshida, MNRAS 354,\n1040 (2004).\n[76] O. Zanotti, L. Rezzolla, J. A. Font and P. J. Montero,\nMNRAS 356, 1371 (2005).\n[77] P. J. Montero, O. Zanotti, J. A. Font and L. Rezzolla,\nMNRAS 378, 1101 (2007).\n\n\f"}