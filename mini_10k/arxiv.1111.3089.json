{"id": "http://arxiv.org/abs/1111.3089v1", "guidislink": true, "updated": "2011-11-14T02:28:49Z", "updated_parsed": [2011, 11, 14, 2, 28, 49, 0, 318, 0], "published": "2011-11-14T02:28:49Z", "published_parsed": [2011, 11, 14, 2, 28, 49, 0, 318, 0], "title": "Dusty gas with SPH - II. Implicit timestepping and astrophysical drag\n  regimes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1111.3095%2C1111.6852%2C1111.2206%2C1111.6855%2C1111.6839%2C1111.4881%2C1111.5360%2C1111.1913%2C1111.2093%2C1111.3357%2C1111.5245%2C1111.6919%2C1111.0610%2C1111.1702%2C1111.3204%2C1111.1956%2C1111.6551%2C1111.0396%2C1111.6918%2C1111.1354%2C1111.2774%2C1111.6646%2C1111.6077%2C1111.2297%2C1111.3415%2C1111.0652%2C1111.6520%2C1111.0361%2C1111.3975%2C1111.0991%2C1111.5179%2C1111.5418%2C1111.5655%2C1111.0930%2C1111.5643%2C1111.6471%2C1111.4735%2C1111.0220%2C1111.4937%2C1111.3582%2C1111.1823%2C1111.5657%2C1111.2931%2C1111.4511%2C1111.6239%2C1111.0423%2C1111.3923%2C1111.4222%2C1111.5364%2C1111.3683%2C1111.3643%2C1111.0995%2C1111.7140%2C1111.5255%2C1111.6696%2C1111.1125%2C1111.2829%2C1111.1991%2C1111.3089%2C1111.0570%2C1111.6567%2C1111.2040%2C1111.2481%2C1111.3084%2C1111.5866%2C1111.0489%2C1111.1060%2C1111.2511%2C1111.3909%2C1111.1331%2C1111.0487%2C1111.3309%2C1111.4998%2C1111.2065%2C1111.6387%2C1111.3676%2C1111.3915%2C1111.0143%2C1111.0593%2C1111.6346%2C1111.5939%2C1111.7129%2C1111.1648%2C1111.5727%2C1111.5763%2C1111.4330%2C1111.0590%2C1111.0963%2C1111.3283%2C1111.0703%2C1111.6863%2C1111.1129%2C1111.1329%2C1111.5777%2C1111.4505%2C1111.1870%2C1111.6425%2C1111.2667%2C1111.3159%2C1111.5746%2C1111.3486&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Dusty gas with SPH - II. Implicit timestepping and astrophysical drag\n  regimes"}, "summary": "In a companion paper (Laibe & Price 2011b), we have presented an algorithm\nfor simulating two-fluid gas and dust mixtures in Smoothed Particle\nHydrodynamics (SPH). In this paper, we develop an implicit timestepping method\nthat preserves the exact conservation of the both linear and angular momentum\nin the underlying SPH algorithm, but unlike previous schemes, allows the\niterations to converge to arbitrary accuracy and is suited to the treatment of\nnon- linear drag regimes. The algorithm presented in Paper I is also extended\nto deal with realistic astrophysical drag regimes, including both linear and\nnon-linear Epstein and Stokes drag. The scheme is benchmarked against the test\nsuite presented in Paper I, including i) the analytic solutions of the dustybox\nproblem and ii) solutions of the dustywave, dustyshock, dustysedov and\ndustydisc obtained with explicit timestepping. We find that the implicit method\nis 1- 10 times faster than the explicit temporal integration when the ratio r\nbetween the the timestep and the drag stopping time is 1 < r < 1000.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1111.3095%2C1111.6852%2C1111.2206%2C1111.6855%2C1111.6839%2C1111.4881%2C1111.5360%2C1111.1913%2C1111.2093%2C1111.3357%2C1111.5245%2C1111.6919%2C1111.0610%2C1111.1702%2C1111.3204%2C1111.1956%2C1111.6551%2C1111.0396%2C1111.6918%2C1111.1354%2C1111.2774%2C1111.6646%2C1111.6077%2C1111.2297%2C1111.3415%2C1111.0652%2C1111.6520%2C1111.0361%2C1111.3975%2C1111.0991%2C1111.5179%2C1111.5418%2C1111.5655%2C1111.0930%2C1111.5643%2C1111.6471%2C1111.4735%2C1111.0220%2C1111.4937%2C1111.3582%2C1111.1823%2C1111.5657%2C1111.2931%2C1111.4511%2C1111.6239%2C1111.0423%2C1111.3923%2C1111.4222%2C1111.5364%2C1111.3683%2C1111.3643%2C1111.0995%2C1111.7140%2C1111.5255%2C1111.6696%2C1111.1125%2C1111.2829%2C1111.1991%2C1111.3089%2C1111.0570%2C1111.6567%2C1111.2040%2C1111.2481%2C1111.3084%2C1111.5866%2C1111.0489%2C1111.1060%2C1111.2511%2C1111.3909%2C1111.1331%2C1111.0487%2C1111.3309%2C1111.4998%2C1111.2065%2C1111.6387%2C1111.3676%2C1111.3915%2C1111.0143%2C1111.0593%2C1111.6346%2C1111.5939%2C1111.7129%2C1111.1648%2C1111.5727%2C1111.5763%2C1111.4330%2C1111.0590%2C1111.0963%2C1111.3283%2C1111.0703%2C1111.6863%2C1111.1129%2C1111.1329%2C1111.5777%2C1111.4505%2C1111.1870%2C1111.6425%2C1111.2667%2C1111.3159%2C1111.5746%2C1111.3486&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In a companion paper (Laibe & Price 2011b), we have presented an algorithm\nfor simulating two-fluid gas and dust mixtures in Smoothed Particle\nHydrodynamics (SPH). In this paper, we develop an implicit timestepping method\nthat preserves the exact conservation of the both linear and angular momentum\nin the underlying SPH algorithm, but unlike previous schemes, allows the\niterations to converge to arbitrary accuracy and is suited to the treatment of\nnon- linear drag regimes. The algorithm presented in Paper I is also extended\nto deal with realistic astrophysical drag regimes, including both linear and\nnon-linear Epstein and Stokes drag. The scheme is benchmarked against the test\nsuite presented in Paper I, including i) the analytic solutions of the dustybox\nproblem and ii) solutions of the dustywave, dustyshock, dustysedov and\ndustydisc obtained with explicit timestepping. We find that the implicit method\nis 1- 10 times faster than the explicit temporal integration when the ratio r\nbetween the the timestep and the drag stopping time is 1 < r < 1000."}, "authors": ["Guillaume Laibe", "Daniel J. Price"], "author_detail": {"name": "Daniel J. Price"}, "author": "Daniel J. Price", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1111/j.1365-2966.2011.20201.x", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1111.3089v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1111.3089v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "Accepted for publication in MNRAS", "arxiv_primary_category": {"term": "astro-ph.IM", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph.IM", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1111.3089v1", "affiliation": "Monash", "arxiv_url": "http://arxiv.org/abs/1111.3089v1", "journal_reference": null, "doi": "10.1111/j.1365-2966.2011.20201.x", "fulltext": "Mon. Not. R. Astron. Soc. 000, 1\u201312 (2011)\n\nPrinted 21 August 2018\n\n(MN LATEX style file v2.2)\n\narXiv:1111.3089v1 [astro-ph.IM] 14 Nov 2011\n\nDusty gas with SPH - II. Implicit timestepping and astrophysical\ndrag regimes\nGuillaume Laibe, Daniel J. Price\nCentre for Stellar and Planetary Astrophysics and School of Mathematical Sciences, Monash University, Clayton, Vic 3800, Australia\n\n21 August 2018\n\nABSTRACT\n\nIn a companion paper (Laibe & Price 2011b), we have presented an algorithm for simulating\ntwo-fluid gas and dust mixtures in Smoothed Particle Hydrodynamics (SPH). In this paper,\nwe develop an implicit timestepping method that preserves the exact conservation of the both\nlinear and angular momentum in the underlying SPH algorithm, but unlike previous schemes,\nallows the iterations to converge to arbitrary accuracy and is suited to the treatment of nonlinear drag regimes. The algorithm presented in Paper I is also extended to deal with realistic\nastrophysical drag regimes, including both linear and non-linear Epstein and Stokes drag. The\nscheme is benchmarked against the test suite presented in Paper I, including i) the analytic\nsolutions of the dustybox problem and ii) solutions of the dustywave, dustyshock, dustysedov\nand dustydisc obtained with explicit timestepping. We find that the implicit method is 1\u201310\ntimes faster than the explicit temporal integration when the ratio r between the the timestep\nand the drag stopping time is 1 . r . 1000.\nKey words: hydrodynamics - methods: numerical - ISM: dust, extinction - protoplanetary discs - planets and satellites: formation\n\n1\n\nINTRODUCTION\n\nDust in cold astrophysical systems spans a huge range of sizes\nfrom sub-micron sized grains in the interstellar medium to kilometre sized planetesimals involved in planet formation. Moreover,\nthe ratio of dust to gas as well as the density and temperature of\nthe gaseous environment in which dust is embedded can also vary\nstrongly. Handling this full range of physical parameters presents\na challenge to numerical schemes designed to simulate dusty gas\nin astrophysics. The main challenges are i) that at high drag (e.g.\nsmall grains), the small timestep required means that purely explicit\ntimestepping methods become prohibitive and ii) that a wide range\nof physical drag prescriptions, including non-linear drag regimes,\nneed to be handled by the code.\nTwo main prescriptions for drag between gas and solid particles are applicable to astrophysics: The Epstein regime - where\nthe gas surrounding a grain can be treated as a dilute medium -\nand the Stokes regime - where the grains can be treated as solid\nbodies surrounded by a fluid -(see e.g. Baines et al. 1965; Stepinski & Valageas 1996). The dependance of the drag term on local\nparameters of the gas (density, temperature) and the dust (typical\ngrain size, mass) differ between the two regimes, in turn implying\nvery different dynamics for the dust grains. For example, in a protoplanetary disc, both of these regimes may be applicable in different\nregions of the disc.\nIn a companion paper (Laibe & Price 2011b, hereafter Paper I), we have developed a new algorithm for treating two-fluid\ngas-dust astrophysical mixtures in Smoothed Particle Hydrody-\n\nnamics (SPH). Benchmarking of the method demonstrated that the\nalgorithm gives accurate solutions on a range of test problems relevant to astrophysics and substantially improve previous algorithms\n(Monaghan & Kocharyan 1995). However, in Paper I, we used only\na simple explicit time stepping and considered only linear drag\nregimes with a constant drag coefficient. In this paper, we present\nan implicit timestepping method that can be applied to both linear and non-linear drag regimes, which is both more accurate and\nmore general than the scheme proposed by Monaghan (1997). We\nalso discuss the SPH implementation of both the Epstein and the\nStokes regimes in their full generality.\n\nThe paper is organised as follows: The equations of motion\nand the characteristics of the different astrophysical drag regimes\nfor gas and dust mixtures are given in Sec. 2. We summarise the\nSPH formalism used for integrating these equations (derived in detail in Paper I) in Sec. 3 and extend it to deal with the drag regimes\nencountered in astrophysics. Particular attention is paid in Sec. 4\nto improving the Monaghan (1997) implicit timestepping scheme,\nincluding its generalisation for non-linear drag regimes. Finally,\nthe algorithm for non-linear drag regimes is tested against the analytic solutions of the dustybox problem, as well as the dustywave,\ndustysedov, dustyshock and dustydisc tests, in Sec. 5.\n\n\fLaibe & Price\n\n2\n2\n2.1\n\nGAS AND DUST EVOLUTION IN ASTROPHYSICAL\nSYSTEMS\nEvolution equations\n\nThe equations describing the evolution of astrophysical gas and\ndust mixtures, where dust is treated as a pressureless, inviscid, continuous fluid have been described in detail in Paper I. The equations\nin the continuum limit are given by:\n\u0010\n\u0011\n\u2202\u03c1\u0302g\n+ \u2207. \u03c1\u0302g vg\n\u2202t\n\u2202\u03c1\u0302d\n+ \u2207. (\u03c1\u0302d vd )\n\u2202t\n!\n\u2202vg\n+ vg .\u2207vg\n\u03c1\u0302g\n\u2202t\n!\n\u2202vd\n+ vd .\u2207vd\n\u03c1\u0302d\n\u2202t\ndug\ndt\n\n=\n\n0,\n\n=\n\n0,\n\n(2)\n\n=\n\nV\n\u2212\u03b8 \u2207Pg + \u03c1\u0302g f \u2212 Fdrag\n,\n\n(3)\n\n=\n\nV\n,\n\u2212 (1 \u2212 \u03b8) \u2207Pg + \u03c1\u0302d f + Fdrag\n\n(4)\n\n=\n\n\u2212\n\n(1)\nRd =\n\ni\nPg h\n\u03b8\u2207 * vg + (1 \u2212 \u03b8)\u2207 * vd + \u039bdrag . (5)\n\u03c1\u0302g\n\nwhere the subscripts g and d refer to the gas and dust, respectively\nsuch that Pg is the gas pressure, vg and vd are the fluid velocities and\nu is the specific internal energy of gas. The volume densities of gas\nand dust (\u03c1\u0302g and \u03c1\u0302d , respectively) are related to the corresponding\nintrinsic densities (\u03c1g and \u03c1d , respectively) according to\n\u03c1\u0302d\n\n=\n\n(1 \u2212 \u03b8)\u03c1d ,\n\n(6)\n\n\u03c1\u0302g\n\n=\n\n\u03b8\u03c1g ,\n\n(7)\n\nwhere \u03b8 is the volume filling fraction of the dust. Finally, the drag\nforce and heating terms are given by:\n= K(vg \u2212 vd ),\n\n(8)\n\n\u039bdrag = K(vg \u2212 vd )2 .\n\n(9)\n\nV\nFdrag\n\nand\n\nThe drag coefficient K has dimensions of mass per unit volume per\nunit time and is generally a function of the relative velocity between\nthe two fluids \u2206v \u2261 |vg \u2212vd |, implying a non-linear drag regime with\nrespect to the differential velocity between the gas and the dust. In\nmost of the astrophysical systems, the dust is diluted enough into\nthe gas so that the gas filling fraction is \u03b8 ' 1 to a very good level\nof approximation, such that the dust buoyancy term (1 \u2212 \u03b8) \u2207Pg is\nnegligible.\n\n2.2\n\nbe porous and have fractal structures (Blum & Wurm 2008) (thus\nbreaking the assumptions of the Epstein prescription).\nFor grain sizes larger than the collisional mean free path\n(s \u001d \u03bbg ), grains experience a local differential velocity with respect to a uniform viscous flow and should be treated using the\nStokes drag prescription (Fan & Zhu 1998). In this case, the momentum is diffused by viscosity into the fluid, which implies that\nthe drag expression strongly depends on the local Reynolds number\ndefined according to\n\nAstrophysical drag regimes\n\nMicroscopic collisions of gas molecules on a single dust grain result in a net exchange of momentum which is equivalent to a drag\nforce Fdrag between the two phases. Two limiting cases occur when\ncomparing the typical geometrical size s of a dust grain to the mean\nfree path \u03bbg of the gas.\nWhen the typical grain size is negligible compared to the collisional mean free path of the gas particles (s \u001c \u03bbg ), the grains\nare surrounded by a dilute gas phase and may be treated using\nthe Epstein drag prescription. In this limit, the analytic expression\nof the resulting drag force has been derived, assuming spherical,\ncompact grains with homogeneous composition, for both specular\nand diffuse reflections on the grain surface (see Baines et al. 1965\nfor the complete derivation). These expressions have been widely\nused in astrophysical studies (see e.g. Chiang & Youdin 2010 for\nreferences), sometimes incorrectly where the grains are known to\n\n2s vd \u2212 vg\n\n,\n(10)\n\u03bd\nwhere \u03bd is the kinematic viscosity of the gas. Analytic expressions\nfor the drag force can be derived at small Reynolds numbers. At\nhigher Reynolds number, the drag law is inferred from experiments.\nRigorously, additional contributions to the drag should arise from\nthe grain acceleration (carried mass and Basset contribution), grain\nrotation (Magnus) and in the presence of strong local shear, pressure and temperature gradients (e.g. Fan & Zhu 1998). These corrections are negligible in nearly all astrophysical contexts.\nNo current analytic theory describes how both the gas and\nthe dust fluid exchange momentum in the intermediate regime (i.e.\ns ' \u03bbg ). Generally, an asymptotic continuous interpolation between\nthe two limiting Epstein and Stokes regimes is used. Stepinski &\nValageas (1996) suggest adopting s = 49 \u03bbg as a means of obtaining\na smooth transition. It should be noted that although this approach\nis convenient, there is no clear measure of the physical accuracy of\nthis assumption.\n2.2.1\n\nEpstein regime for dilute media\n\nIn a dilute medium (\u03bbg > 4s/9), grains are small enough not to\ndisturb the Maxwellian distribution of the gas velocity. Assuming\ngrains are spherical, that the mass of a gas molecule is negligible\ncompared to the mass of a dust grain and that the reflection of gas\nparticles from collisions with dust grains are specular, the expression of the drag force on a single grain Fdrag (which differs from the\nV\nvolume force Fdrag\nby a factor \u03c1\u0302d /md , see Paper I) for the Epstein\nregime is given by\n!\n(\n\"\n1\n1\n1\n2\n+ 3 e\u2212\u03c8 +\n(11)\nFdrag = \u22122\u03c0s2 \u03c1g \u2206v2 \u221a\n2 \u03c0 \u03c8 2\u03c8\n!\n)#\n1\n1 \u221a\n1+ 2 \u2212 4\n\u03c0 erf (\u03c8) x,\n\u03c8\n4\u03c8\nwhere s corresponds to the grain radius and m, \u03c1g , T denote the\nmass of the gas molecules, the intrinsic gas density and the local\ntemperature of the mixture (the gas and the dust are supposed to\nhave the samep temperature). The thermal sound speed of the gas\nis thus cs = \u03b3kB T/m and the mean thermal velocity of the gas,\np\ncs 8/\u03c0\u03b3. The dimensionless quantity \u03c8 is defined according to\nr\n\u03b3 \u2206v\n\u03c8\u2261\n,\n(12)\n2 cs\nwhere \u2206v = vd \u2212vg = \u2206v x is the differential velocity (x being a unit\nvector). However, depending on the characteristics of the problem\n(i.e. low or high Mach numbers, or both), simpler and computationally less expensive approximations may be used. For \u03c8 \u001c 1,\ni.e. low Mach numbers, Eq. 11 can be expanded to third order in \u03c8,\ngiving\ns\n\"\n\u0010 \u0011#\n4\u03c0 2\n8\n\u03c82\ncs \u2206v 1 +\n+ O \u03c84 x,\nFdrag = \u2212 \u03c1g s\n(13)\n3\n\u03c0\u03b3\n5\n\n\f3\n\nDusty gas with SPH - II.\nwhich is usually simplified to its linear term,\ns\n4\u03c0 2\n8\nFdrag = \u2212 \u03c1g s\ncs \u2206v.\n3\n\u03c0\u03b3\n\nand\n\nFor \u03c8 \u001d 1, i.e. high Mach numbers, the Taylor expansion in 1/\u03c8\nof Eq. 11 gives\n!\n\"\n\u0010 2 \u0011#\n1\n1\n(15)\nFdrag = \u2212 \u03c0\u03c1g s2 \u2206v2 1 + 2 \u2212 4 + O e\u2212\u03c8 x,\n\u03c8\n4\u03c8\nwhich is usually reduced to its quadratic term,\nFdrag = \u2212\u03c0\u03c1g s2 \u2206v\u2206v.\n\n\u03bd=\n\n(14)\n\n(16)\n\nA convenient way to handle Epstein drag at both low and high\nMach numbers is to use an interpolation between the two asymptotic regimes given by Eqs. 14 and 16 as derived in Kwok (1975)\n(cf. Paardekooper & Mellema 2006), giving\ns\ns\n4\u03c0 2\n8\n9\u03c0 \u2206v2\nFdrag = \u2212 \u03c1g s\ncs 1 +\n\u2206v.\n(17)\n3\n\u03c0\u03b3\n128 c2s\nThe deviation of Eq. 17 from the full expression (Eq. 11) is . 1%\n(Kwok 1975). Thus, in general, we adopt Eq. 17 for the Epstein\nregime. We compare the differences between the various Epstein\nexpressions in Sec. 5.\n\n3\n3.1\n\n\u03bc\n.\n\u03c1g\n\nASYTROPHYSICAL DUST AND GAS MIXTURES IN\nSPH\nSPH evolution equations\n\nThe SPH version of the continuity equations Eqs. 1 \u2013 2 are given\nby the density summations for both the gas and the dust phase,\ncomputed according to:\n!1/\u03bd\nX\nma\n\u03c1\u0302a =\n,\n(23)\nmb Wab (ha );\nha = \u03b7\n\u03c1\u0302a\nb\n!\nX\nm j 1/\u03bd\nm j Wi j (hi );\nhi = \u03b7\n,\n(24)\n\u03c1\u0302i =\n\u03c1\u0302i\nj\nwhere as in Paper I, the indices a, b, c refer to quantities computed\non gas particles and i, j, k refer to quantities computed on dust particles. The volume filling fraction \u03b8, is defined on a gas particle, a,\naccording to\n\u03b8a = 1 \u2212\n\n2.2.2\n\nStokes regime for dense media\n\nIn a dense medium (\u03bbg > 4s/9), grains should be treated with the\nStokes drag regime, for which the expression of the drag force Fdrag\nis:\n1\nFdrag = \u2212 CD \u03c0s2 \u03c1g \u2206v\u2206v,\n(18)\n2\nwhere the coefficient CD is a piecewise function of the local\nReynolds number:\n\uf8f1\n\uf8f4\n\uf8f4\n24R\u22121\nRd < 1;\n\uf8f4\nd ,\n\uf8f4\n\uf8f4\n\uf8f2\n\u22120.6\n(19)\nCD = \uf8f4\n24R\n,\n1 < Rd < 800;\n\uf8f4\nd\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f30.44,\n800 < Rd ,\nwhere Rd is defined in Eq. 10. Equation 19 indicates that at small\nReynolds numbers (Rd < 1), the drag force is linear with respect\nto the local differential velocity between the grain and the gas. The\nrelation transitions to a power-law regime (Fdrag \u221d \u2206v0.4 \u2206v) at intermediate Reynolds numbers (1 < Rd < 800) and becomes quadratic\nat large Reynolds numbers (Rd > 800). When the local concentration of dust grains becomes very large (i.e., average distance between the particles comparable to the grain size), the coefficient CD\nshould also depend on the local concentration of particles. However, this extreme situation is not encountered in astrophysical situations.\nAssuming gas molecules interact as hard spheres, the dynamic\nviscosity of the gas can be computed according to (Chapman &\nCowling 1970):\nr\n5m\n\u03c0\n\u03bc=\ncs ,\n(20)\n64\u03c3s \u03b3\nwhere m = 2mH and \u03c3s is the geometric cross section of the\nmolecule (\u03c3s = 2.367 \u00d7 10\u221215 cm2 for H2 ). The gas mean free\npath \u03bbg and the kinematic viscosity \u03bd of the gas are deduced from\n\u03bc using\nr\n\u03c0\u03b3 \u03bc\n\u03bbg =\n,\n(21)\n2 \u03c1g cs\n\n(22)\n\n\u03c1\u0302d,a\n,\n\u03c1d\n\n(25)\n\nwhere \u03c1\u0302d,a is the density of dust at the gas particle location, calculated using\nNneigh,dust\n\n\u03c1\u0302d,a =\n\nX\n\nm j Wa j (ha ),\n\n(26)\n\nj=1\n\nwhere ha is the smoothing length of the gas particle computed using\ngas neighbours. The local density of dust at the gas location can\nthus be zero (giving \u03b8 = 1) if no dust particles are found within the\nkernel radius computed with the gas smoothing length. Importantly,\nas \u03c1\u0302 and h are mutually dependent, they have to be simultaneously\ncalculated for each type of particle, e.g. by the iterative procedure\ndescribed in Price & Monaghan (2007).\nThe SPH equations of motion for the gas and the dust particles,\ncorresponding to the SPH translation of Eqs. 3 and 4, are given by\n#\nX \" Pa \u03b8\u0303a\nPb \u03b8\u0303b\ndva\n(h\n)\n)\n(h\n=\u2212\nmb\n\u2207\nW\n+\n\u2207\nW\na\nab\na\na\nab\nb\ndt\n\u03a9a \u03c1\u03022a\n\u03a9b \u03c1\u03022b\nb\nX Pa (1 \u2212 \u03b8a )\n\u2212\nmj\n\u2207a Wa j (ha )\n\u03c1\u0302a \u03c1\u0302d,a\nj\nX\n\u0011\nKa j \u0010\n+\u03bd\nmj\nva j * r\u0302a j r\u0302a j Da j (ha ),\n(27)\n\u03c1\u0302\n\u03c1\u0302\na j\nj\nfor an SPH gas particle and\ndvi X Pb (1 \u2212 \u03b8b )\n=\nmb\n\u2207i Wbi (hb )\ndt\n\u03c1\u0302b \u03c1\u0302d,b\nb\nX\nKbi\n(vbi * r\u0302bi ) r\u0302bi Dib (hi ),\n\u2212\u03bd\nmb\n\u03c1\u0302\nb \u03c1\u0302i\nb\n\n(28)\n\nfor an SPH dust particle. \u03a9 is the usual variable smoothing length\nterm\n\u2202hb X \u2202Wbc (hb )\n\u03a9b \u2261 1 \u2212\nmc\n.\n(29)\n\u2202\u03c1\u0302b c\n\u2202hb\nIt should be noted that \u03a9d is computed only using dust particle\n\n\f4\n\nLaibe & Price\n\nneighbours according to:\n\u03a9d,b\n\n\u2202hb X \u2202Wb j (hb )\nmj\n.\n=1\u2212\n\u2202\u03c1\u0302d,b j\n\u2202hb\n\n3.3.2\n(30)\n\n\u03b8\u0303 is defined according to\n\u03c1\u0302g\n(1 \u2212 \u03b8)(1 \u2212 \u03a9d ).\n(31)\n\u03c1\u0302d\nAt this stage, no assumptions are made with respect to the functional form of the drag coefficient K. The evolution of the internal\nenergy for an SPH gas particle is given by\ndua\n\u03b8\u0303a Pa X\n=\nmb (va \u2212 vb ) * \u2207a Wab (ha )\n(32)\ndt\n\u03a9a \u03c1\u03022a b\n\u03b8\u0303 \u2261 \u03b8 +\n\nNneigh,dust\n\u0010\n\u0011\n(1 \u2212 \u03b8a )Pa X\nm j va \u2212 v j * \u2207a Wa j (ha )\n\u03c1\u0302a \u03c1\u0302d,a\nj=1\nX\nKak\n(vak * r\u0302ak )2 Dak (ha ).\n+\u03bd\nmk\n\u03c1\u0302\n\u03c1\u0302\na\nk\nk\n\n+\n\nIn Paper I, we showed that the total linear and angular momentum\nas well as the total energy are exactly conserved. Thermal coupling\nterms have been neglected in this paper.\n3.2\n\nKernel functions\n\nTwo different kernels are employed to perform the SPH interpolations. First, a standard bell-shaped kernel W:\n\u03c3\n(33)\nW (r, h) = \u03bd f (q) ,\nh\nwhere h denotes the smoothing lengths of each phases, \u03bd the number of spatial dimensions and q \u2261 |r \u2212 r0 |/h is the dimensionless\nvariable used to calculate the densities and the buoyancy terms. The\nfunction f is usually the M4 cubic spline kernel (Monaghan 2005).\nThe drag interpolation is performed using a second kernel D. As\nshown in Paper I, double-hump shaped kernels given by\n\u03c3\u0303\nD (r, h) = \u03bd q2 f (q),\n(34)\nh\nsignificantly improve the accuracy of the drag interpolation - for\nthe same computational cost - compared to bell-shaped kernels.\nThe normalisation constants \u03c3\u0303 for various double hump kernels are\ngiven in Paper I. We adopt the double hump cubic for the drag terms\nin this paper.\n3.3\n3.3.1\n\nAstrophysical drag regimes in SPH\nGas viscosity and mean free path\n\nThe drag coefficients Kak involved in Eqs. 27 \u2013 28 and 32 are computed independently for each pair of any gas particle a and dust\nparticle k. We first use the sound speed cs,a to estimate the viscosity\n\u03bca on the gas particle a using (see Eq. 20)\nr\n5m\n\u03c0\n\u03bca =\ncs,a .\n(35)\n64\u03c3s \u03b3\nThe mean free path is then computed according to Eq. 21, giving\nr\n\u03c0\u03b3 \u03bca\n\u03bbg,a =\n.\n(36)\n2 \u03c1\u0302a cs,a\nFinally, \u03bbg,a is compared to the quantity 4sk /9 - sk being the grain\nsize of the dust particle - to determine whether the drag coefficient\nof the SPH pair Kak is calculated using the Epstein or the Stokes\ndrag regimes.\n\nEpstein regime\n\nIf 4sk /9 \u2264 \u03bbg,a , the drag coefficient Kak is calculated using the Epstein prescription. Introducing the SPH quantity \u03c8ak calculated on\na pair of gas and dust SPH particles and defined by\nr\n\u03b3 |vak |\n\u03c8ak \u2261\n,\n(37)\n2 cs,a\nEq. 11 can be straightforwardly translated to get the drag coefficient\nKak involved in the SPH drag force\n\"\n(\n!\n\u221a\n\u03c1\u0302d\n1\n1\n1\n2\nKak = \u2212 \u03c0s2 \u03c1g |vak | \u221a\n+ 3 e\u2212\u03c8ak +\n(38)\nmd\n2 \u03c0 \u03c8ak 2\u03c8ak\n!\n)#\n\u221a\n1\n1\n1+ 2 \u2212 4\n\u03c0 erf (\u03c8ak ) x,\n\u03c8ak 4\u03c8ak\nwhere s is the grain radius, md is the grain mass and \u03b3 is the adiabatic index. Eq. 38 is computationally expensive as it involves exponential and error functions. The SPH equivalent of Eq.17 is given\nby\ns\ns\n8 \u03c1\u0302k \u03c1\u0302a 2\n9\u03c0 v2ak\n4\n.\n(39)\ns cs,a 1 +\nKak = \u03c0\n3\n\u03c0\u03b3 md \u03b8a\n128 c2s,a\nBoth Eqs. 38 and 39 reduce to the linear Epstein regime at low\nMach numbers (equivalent of Eq. 14) for which the coefficient Kak\nis\ns\n4\n8 \u03c1\u0302k \u03c1\u0302a 2\nKak = \u03c0\ns cs,a ,\n(40)\n3\n\u03c0\u03b3 md \u03b8a\nand to the quadratic drag regime at high Mach numbers (equivalent\nof Eq. 16), for which the coefficient Kak is\nKak = \u03c0\u03c1g s2\n\n3.3.3\n\n\u03c1\u0302d\n|vak |.\nmd\n\n(41)\n\nStokes regime\n\nIf 4sk /9 > \u03bbg,a , the drag coefficient Kak is calculated using the\nStokes prescription (see Eqs. 18\u201319). The local Reynolds number\nRd,ak is computed for each pair of gas and dust particles using\nRd,ak \u2261\n\n2s\u03c1\u0302a |vak |\n,\n\u03bca \u03b8a\n\n(42)\n\nsuch that the drag coefficient Kak can be computed according to\n\uf8f1 \u03c1\u0302\n\uf8f4\nk\n\uf8f4\n\uf8f4\n6\u03c0 \u03bca s\nRd,ak < 1,\n\uf8f4\n\uf8f4\n\uf8f4\nmd\n\uf8f4\n\uf8f4\n\uf8f4\n0.6\n\uf8f4\n\uf8f2 12\u03c0 \u03c1\u0302k \u03bca\nKak = \uf8f4\n(43)\ns1.4 |vak |0.4 1 < Rd,ak < 800,\n\uf8f4\n0.6 m \u03b80.4 \u03c1\u03020.6\n\uf8f4\n2\n\uf8f4\nd\na\na\n\uf8f4\n\uf8f4\n\uf8f4\n\u03c1\u0302k \u03c1\u0302a 2\n\uf8f4\n\uf8f4\n\uf8f4\ns |vak |\nRd,ak > 800.\n\uf8f30.22\u03c0\nmd \u03b8 a\nThese expressions have been used by Ayliffe et al. (2011) to compute the drag on planetesimals in a protoplanetary disc.\n\n4\n4.1\n\nTIMESTEPING\nExplicit timesteping\n\nThe simplest method to evolve the evolution equations for the SPH\nparticles is to use an explicit integrator (e.g. the standard Leapfrog).\nThe stability of the system is guaranteed provided the timestep remains smaller than a critical value \u2206tc . In Paper I, we performed\n\n\fDusty gas with SPH - II.\n\n5\n\na Von Neumann analysis of the continuous equations, deriving the\nexplicit timestepping criterion\n\"\n#\n#\n\"\n\u03c1\u0302a \u03c1\u0302k\n\u03c1\u0302b \u03c1\u0302i\n\u2206tc,a = min\n;\n\u2206tc,i = min\n; (44)\nk\nb\nKak (\u03c1\u0302a + \u03c1\u0302k )\nKbi (\u03c1\u0302b + \u03c1\u0302i )\n\nSPH particles provides an approximate solution for the velocities\nvn+1 , i.e.\nX\nvn+1\n\u2212 vna\nKak\na\n(\u1e7dak * r\u0302ak ) r\u0302ak Dak ,\n' \u2212\u03bd\n(50)\nmk\n\u2206t\n\u03c1\u0302\na \u03c1\u0302k\nk\n\nfor gas and dust particles, respectively, with the minimum being\ntaken over all the particle's neighbours. Although this criterion was\nderived in Paper I for linear drag regimes only, it remains valid even\nfor non-linear drag regimes where the drag coefficients depend on\nthe differential velocity between the particles, i.e. Kak = Kak (|vak |).\n\nvn+1\n\u2212 vni\ni\n\u2206t\n\n4.2\n\nImplicit timestepping\n\nWhen the drag timescale becomes smaller than other time scales in\nthe system (e.g. the Courant condition or the orbital timescale), the\ntimestep restriction of the explicit methods may become prohibitive\nand implicit methods are required. Monaghan (1997) considered\nthe application of two implicit schemes (the first-order BackwardEuler and second-order Tischer scheme) to SPH dust-gas mixtures.\nBoth schemes are unconditionally stable, but a higher accuracy is\nachieved with second-order schemes.\n\n4.2.1\n\nThe Backward-Euler scheme applied to the drag interaction between SPH dust and gas particles is given by\nvn+1\n\u2212 vna\na\n\u2206t\n\n=\n\nvn+1\n\u2212 vni\ni\n\u2206t\n\n=\n\n\u2212\u03bd\n\nX\nk\n\n+\u03bd\n\nX\n\n\u0011\nK n+1 \u0010\nmk ak vn+1\nak * r\u0302ak r\u0302ak Dak ,\n\u03c1\u0302a \u03c1\u0302k\nmb\n\nb\n\n\u0011\nKbin+1 \u0010 n+1\nvbi * r\u0302bi r\u0302bi Dbi .\n\u03c1\u0302b \u03c1\u0302i\n\nAlthough the scheme is unconditionally stable, the implicit equation with respect to the velocities vn+1 must be solved at each time\nstep. Direct numerical inversion of this linear system would be prohibitive given the typical number of neighbour interactions for each\nSPH particle. Thus, approximate or iterative solutions to Eqs. 45 \u2013\n46 are required.\n\n4.2.2\n\nMonaghan (1997) scheme\n\nMonaghan (1997) suggested approximating the velocities vn+1 of\nEqs. 45 \u2013 46 using a pairwise treatment in order to preserve the exact conservation of linear and angular momentum in the SPH formalism. Considering the interaction between the SPH gas particle a\nthe dust particle i, Monaghan (1997) introduced pairwise auxiliary\nvelocities \u1e7d defined by:\n\u1e7da\n\n=\n\n\u1e7di\n\n=\n\n\u03bdKai Dai\n(\u1e7dai * r\u0302ai ) r\u0302ai ,\n\u03c1\u0302a \u03c1\u0302i\n\u03bdKai Dai\n(\u1e7dai * r\u0302ai ) r\u0302ai ,\nvni + ma \u2206t\n\u03c1\u0302a \u03c1\u0302i\nvna \u2212 mi \u2206t\n\nvnai * r\u0302ai\n1 + \u2206t \u03bdK\u03c1\u0302aia \u03c1\u0302Di ai (ma + mi )\n\nX\nb\n\nmb\n\nKbi\n(\u1e7dbi * r\u0302bi ) r\u0302bi Dbi .\n\u03c1\u0302b \u03c1\u0302i\n\n(51)\n\nAlternative pairwise treatment for linear drag regimes\n\nWe propose a more consistent method for solving Eqs. 45\u201346 on a\ngiven gas or dust particle (a and i, respectively) by sweeping over\nall particle pairs and updating the velocities iteratively according to\n=\n\u2212\nv\u2217\u2217\ni\n\n=\n+\n\nvna + \u2206tF\u2217a,drag\n\u0001\n\u0003\n\u03bdKai Dai \u0002 \u2217\u2217\nvai \u2212 v\u2217ai * r\u0302ai r\u0302ai ,\n\u03c1\u0302a \u03c1\u0302i\nvni + \u2206tF\u2217i,drag\n\u0001\n\u0003\n\u03bdKai Dai \u0002 \u2217\u2217\nvai \u2212 v\u2217ai * r\u0302ai r\u0302ai ,\nma \u2206t\n\u03c1\u0302a \u03c1\u0302i\nmi \u2206t\n\n(52)\n\n(53)\n\nwhere v\u2217\u2217 refers to the improved approximation to vn+1 obtained\nafter updating each pair and v\u2217 to the previous iteration value of v\u2217\u2217 .\nEqs. 52 and 53 are solved for each pair of particles by taking the\ndot product of r\u0302ai with the difference of the two equations, giving\n\u0011\n\u0010\nvnai + \u2206tF\u2217ai,drag + \u2206t \u03bdK\u03c1\u0302aia \u03c1\u0302Di ai (ma + mi ) v\u2217ai * r\u0302ai\n\u2217\u2217\n(vai * r\u0302ai ) =\n. (54)\n1 + \u2206t \u03bdK\u03c1\u0302aia \u03c1\u0302Di ai (ma + mi )\nSubstituting Eq. 54 in Eqs. 52 and 53 gives the updated velocities\nfor the pair. Note that during the global sweep over particle pairs\nv\u2217 begins as vn at the first iteration but is updated as soon as new\nvalues become available.\nThis pairwise correction ensures that i) both the linear and the\nangular momentum are exactly conserved and ii) the velocities converge to the correct solution of the implicit scheme given by Eqs. 45\nand 46, since the last term of Eqs. 52 and 53 tends to zero as the\nnumber of iterations increases. We thus refine our approximation\nto the solution by performing as many successive iterations as are\nrequired to reach a suitable convergence criterion.\n\n(47)\n4.2.4\n(48)\n\nEqs. 47 and 48 are solved, for a given pair of particles, by taking the\nscalar product by r\u0302ai of the difference of the two equations, giving\n\u1e7dai * r\u0302ai =\n\n4.2.3\n\n(45)\n(46)\n\n+\u03bd\n\nThe main drawback of this method is that the approximation given\nby Eqs. 50 and 51 is inexact \u2013 that is, it provides only an approximate solution to Eqs. 45 and 46. Furthermore the accuracy of the\napproximation is not known a priori and there is no possibility of\nperforming repeated sweeps in order to converge to a more accurate solution. In practice, we find that the velocities obtained by this\nscheme (for example on the dustybox test) can be significantly in\nerror, with no possibility of improving the convergence (for example, by doing several iterations/sweeps).\n\nv\u2217\u2217\na\n\nBackward-Euler method\n\n'\n\n.\n\n(49)\n\nSubstituting this expression into Eq. 47 and 48 gives expressions\nfor \u1e7da and \u1e7di . Iterating this pairwise process by looping over all the\n\nConvergence criterion\n\nWe consider that the approximation we obtain from the implicit\nscheme described above is accurate enough when\n|vk+1 \u2212 vk |\n< \u03b5,\nmin cs\n\n(55)\n\nis satisfied for each particle. Typically, we adopt \u03b5 = 10\u22124 , which\nensures that the approximation we make on the time stepping is\nnegligible compared to the O(h2 ) truncation error of the underlying\nSPH scheme.\n\n\fLaibe & Price\n\n6\n4.2.5\n\nImplementation into Leapfrog\n\n4.2.6\n\nThe Leapfrog scheme is well suited to the evolution of particle\nmethods because, for position-dependant forces, it preserves geometric properties of particle orbits and requires only one evaluation\nper timestep to give second order accuracy. In the standard formulation, the evolution is computed according to\n\u2206t 0\nf\n2\n\n\u0010\n\u0011\nx0 , v0 ,\n\nKick\n\n[\n\nv1/2\n\n=\n\nv0 +\n\nDrift\n\n[\n\nx1\n\n=\n\nKick\n\n[\n\nv1\n\n=\n\nx0 + \u2206tv1/2 ,\n\u0010\n\u0011\nv1/2 + \u2206t2 f 1 x1 , v1 ,\n\n]\n]\n\n(56)\n\n]\n\ncorresponding to Kick, Drift and Kick steps respectively. Adapting\nLeapfrog to deal with velocity dependent forces (e.g. drag) is a priori more difficult since for velocity-dependent forces, the last Kick\nis implicit in v1 . For our present purposes, this does not present a\nmajor problem since the drag is already computed implicitly. Splitting the forces into position-dependent (fSPH ) and drag (fdrag ) contributions, the scheme becomes\nKick\nDrift\n\n[\n\n\u1e7d1/2\n\n=\n\n\u0010 \u0011\n0\nv0 + \u2206t2 fSPH\nx0 ,\n\n[\n\n1/2\n\n=\n\nx +\n\n1/2\n\n=\n\n1/2\n\n\u1e7d\n\n1\n\n[\n\nDrag\n\nx\n\nv\n\n0\n\n]\n\n\u2206t 1/2\n\u1e7d ,\n2\n\n]\n\n+\n\n\u2206t 1/2\nf\n2 drag\n\nDrift\n\n[\n\nx\n\n=\n\nx + \u2206tv\n\nKick\n\n[\n\n\u1e7d1\n\n=\n\nv1/2 +\n\n[\n\n1\n\n=\n\nDrag\n\nv\n\n0\n\n1/2\n\n\u0010\n\u0011\nx1/2 , v1/2\n\n,\n\n\u2206t 1\nf\n2 SPH\n\n\u0010 \u0011\nx1 ,\n\u0010\n\u0011\n1\nx1 , v1\n\u1e7d1 + \u2206t2 fdrag\n\n]\n(57)\n\n]\n]\n\nTo extend this alternative pairwise treatment to any non-linear drag\nregime, two additional points have to be considered. Firstly, although in principle six quantities (v x,y,z for each particle) have to be\ndetermined for each pair, this can be reduced to a single unknown\nquantity since the drag coefficient depends only on the modulus of\nthe differential velocity and the exchange of momentum is directed\nalong the line of sight joining the particles. The system of equations\nfor a single pair thus reduces to\nv\u2217\u2217\na\n\nv\u2217\u2217\ni\n\nv1/2\n\nDrift\n\n\u0002\n\nx1\n\n=\n\n\uf8f1 3/2\n\uf8f4\n\u1e7d\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 3/2\nv\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\nf\u0303\n\nDrag\n\nKick\n\n=\n\n\u0002\n\nv1\n\n=\n\nv0 +\n\n\u2206t0\nf\u0303,\n2\n\nx0 + \u2206t0 v1/2 ,\n=\n=\n=\n\n\u0003\n\u0003\n\n\u2206t0 +\u2206t1 1\nfSPH\n2\n\n\u0010 \u0011\nx1 ,\n\u0010\n\u0011\n1 1\n\u1e7d3/2 + \u2206t0 +\u2206t\nfdrag x1 , v3/2 ,\n2\n\u0010\n\u0011\n2 \u1e7d3/2 \u2212 \u1e7d1/2 / (\u2206t0 + \u2206t1 ) ,\n\nv1/2 +\n\nv1/2 +\n\n\u2206t0\nf\u0303.\n2\n\nvna + \u2206tF\u2217a,drag\n\n\u2212\n\nmi \u2206t\n\n=\n+\n\n\u03bdDai\nKai\n\u03c1\u0302a \u03c1\u0302i\nvni + \u2206tF\u2217i,drag\n\nr\nh\u0010\n\n\u03bdDai\nma \u2206t\nKai\n\u03c1\u0302a \u03c1\u0302i\n\nr\n\n\u0011\ni2\n2,n\n\u2217\n+ Vorth\nv\u2217\u2217\n,\nai \u2212 vai * r\u0302ai\n\n(59)\n\nh\u0010\n\u0011\ni2\n2,n\n\u2217\nv\u2217\u2217\n+ Vorth\n,\nai \u2212 vai * r\u0302ai\n\n(60)\n\nwhere\n\u0001\n2,n\nVorth\n= vnai * vnai \u2212 vnai * r\u0302ai 2 .\n\n(61)\n\nSecondly, taking the dot product of r\u0302ai with the difference of the\ntwo equations Eqns. 59 and 60 does not lead in general to an equation which can be solved analytically. The values of vai * r\u0302ai must\ntherefore be determined using a numerical rootfinding procedure\n(we use a Newton-Raphson scheme) before being substituted in\nEqns. 59 and 60 to determine the velocities for both the gas and the\ndust particles.\n4.2.7\n\n\u0002\n\n=\n\n]\n\nwhere the Drag steps represent the implicit updates computed as\ndescribed in Sec. 4.2.3. The disadvantage of Eq. 57 is that two drag\nforce evaluations are required, removing one of the advantages of\nthe Leapfrog integrator. Inspection of 57 reveals that an alternative\nversion that requires only one Drag step can be constructed according to\nKick\n\nGeneralisation to non-linear drag regimes\n\n\u0003\n\n(58)\nwhere we have combined the drag steps by predicting the velocity\nv3/2 . Note that strictly, the Drag step in this method is semi-implicit\nsince the force is evaluated using x1 rather than x3/2 . However, we\nexpect this approximation to be reasonable as at high drag (for\nwhich the implicit method is designed), the drag mainly changes\nthe differential velocity between the fluids and has less of an effect\non the positions. Care is also required when the timestep changes\nbetween the steps. We have indicated the correct procedure by specifying \u2206t0 and \u2206t1 where \u2206t1 is the timestep computed based on x1 .\nFinally, Eq. 58 requires that f\u0303 is known at the beginning of the integration. This can be easily achieved by performing the Drag step\nin Eq. 58 with v1/2 = v0 , \u2206t0 = 0 and \u2206t1 equal to the timestep\ncalculated using the initial particle positions.\n\nPerformance of the implicit scheme\n\nThe computational cost of a timestep with the implicit pairwise\ntreatment is more expensive than an explicit timestep since at least\ntwo iterations have to be performed to ensure that the scheme is\nconverged. However, the implicit pairwise treatment will be more\nefficient provided that the number of iterations is much smaller than\nthe number of explicit timesteps that would otherwise be required.\nWe find in practice that the efficiency of the pairwise treatment\nis mainly determined by the number of iterations required to satisfy Eq. 55 (this aspect was not addressed in the Monaghan (1997)\nscheme where only one iteration is ever taken in the hope that the\napproximation is sufficiently accurate). The rapidity of the convergence depends primarily on the ratio r = \u2206t/ts of the timestep\nover the drag stopping time (defined in Eq. (96) of Paper I) and\non the value of \u03b5. Empirically, we have found that, for \u03b5 = 10\u22124\nand 1 . r . 10, the implicit pairwise treatment converges efficiently, the ratio |vk+1 \u2212 vk |/(min cs ) decreasing by \u223c two orders\nof magnitude at each iterations. Thus, the implicit pairwise treatment improves the computational time by a factor of \u223c 1\u201310. However, this rapidity of convergence decreases as r increases. At very\nhigh drag (r & 1000), we find that the implicit scheme becomes\nless efficient than explicit timestepping due to the large number\nof iterations required. A similar behaviour has been found using\nthe Gauss-Seidel iterative scheme developed by Whitehouse et al.\n(2005) to treat SPH radiative transfer in the flux-limited diffusion\napproximation (Bate 2011, private communication), so this issue is\nnot specific to the pairwise treatment.\nIt is important to note that the computational gain obtained\nwith the pairwise scheme does not solve the resolution issue at high\ndrag extensively discussed in Paper I. Both of these problems suggest that a more efficient method for handling high drag regimes is\nrequired. Such a method is beyond the scope of the present paper.\n\n\fDusty gas with SPH - II.\n4.2.8\n\n1\n\nHigher order implicit schemes\n\nHigher temporal accuracy may be achieved by using second instead of first order implicit schemes. The gain in accuracy is obtained by dividing the drag timestep \u2206t into two half timesteps.\nMonaghan (1997) suggested the 'Tischer' scheme, where the two\nhalf timesteps are given by\n\u2212 vna\n\u2206t/2\n\n=\n\n\u22120.6\u03bd\n\nX\n\n\u22120.4\u03bd\n\nX\n\nmk\n\n\u0013\nKak \u0012 n+ 12\nvak * r\u0302ak r\u0302ak Dak ,\n\u03c1\u0302a \u03c1\u0302k\n\nmk\n\n\u0001\nKak n\nv * r\u0302ak r\u0302ak Dak ,\n\u03c1\u0302a \u03c1\u0302k ak\n\nmb\n\nKbi n+ 12\nv\n* r\u0302bi r\u0302bi Dbi ,\n\u03c1\u0302b \u03c1\u0302i bi\n\nmb\n\n\u0001\nKbi n\nv * r\u0302bi r\u0302bi Dbi ,\n\u03c1\u0302b \u03c1\u0302i bi\n\nk\n\nk\nn+ 1\nvi 2\n\n\u2212\n\u2206t/2\n\nvni\n\n=\n\n+0.6\u03bd\n\nX\n\n+0.4\u03bd\n\nX\n\n\u0012\n\nb\n\nb\n\nand then\n\u0015\n\u0014\nn+ 21\nn\n\u2212\n0.4v\nvn+1\n\u2212\n1.4v\na\na\na\n\u2206t/2\n\n0.8\n\n(62)\n\n\u2206t/2\n\n0.6\n(63)\n\n0.5\n=\n\n\u22120.6\u03bd\n\nX\nk\n\n\u0011\nKak \u0010 n+1\nmk\nv * r\u0302ak r\u0302ak Dak ,\n\u03c1\u0302a \u03c1\u0302k ak\n\n=\n\n+0.6\u03bd\n\nX\nb\n\nmb\n\n\u0011\nKbi \u0010 n+1\nv * r\u0302bi r\u0302bi Dbi .\n\u03c1\u0302b \u03c1\u0302i bi\n(65)\n\nThe last terms of Eqs. 62\u201363 correspond to the explicit drag force\ninvolved in the Forward-Euler scheme. These quantities are computed form the velocities at the timestep n at the beginning of\nthe scheme, as described in Sec. 4.1. Then, the successive deter1\nmination of vn+ 2 and vn as given by Eqs. 64\u201365 consists of two\nBackward-Euler steps with step size \u2206t2 . They are therefore computed using our alternative pairwise scheme, until the iterations for\neach half time step have converged. Eqs. 62 and 63 concerns the\nspecific case of a linear drag regime, but this scheme can easily be\nextended to non-linear drag regimes as in Sec. 4.2.6.\n\n5\n\n0.7\n\n\u0013\n\n(64)\n\u0015\n\u0014\nn+ 1\nvn+1\n\u2212 1.4vi 2 \u2212 0.4vni\ni\n\n0.9\n\nvd\n\nn+ 12\n\nva\n\n7\n\n0\n\n0.5\n\n1\nt\n\n1.5\n\n2\n\nFigure 1. Dust velocity (solid lines) as a function of time in the dustybox\ntest, using 2 \u00d7 203 particles, a dust-to-gas ratio of unity and five different\nlinear and non-linear drag regimes - quadratic, power-law, linear, third\norder expansion and mixed, from top to bottom - compared to the exact\nsolution for each case (long dashed/red lines). The initial velocities are set\nto vd,i = 1, vg,i = 0 and the time integration is performed using using the\npairwise implicit treatment described in Sec. 4. The accuracy (. 0.1%) of\nthe SPH treatment for dust-gas mixtures is obtained by using the doublehump cubic kernel.\n\nunits and no artificial viscosity is applied. The intrinsic dust volume\nis neglected by assuming \u03b8 = 1.\nSimulations have been performed using both the explicit\ntimestepping presented in Paper I and the implicit pairwise\ntimestepping described in Sec. 4. For the latter, we verified that\nboth the total linear and angular momentum are exactly conserved\nas expected.\n\nNUMERICAL TESTS\n\n5.1 dustybox: Two fluid drag in a periodic box\nThe dustybox problem presented by Laibe & Price (2011a) and described in detail in Paper I consists of two fluids in a periodic box\nmoving with a differential velocity (\u2206v0 = vd,0 \u2212 vg,0 ). This is the\nonly test where analytic solutions are known for several functional\nforms corresponding to non-linear drag regimes (see Laibe & Price\n2011a). These represent the functional forms of the Epstein and\nStokes prescription. We thus use the dustybox problem to benchmark the accuracy of our algorithm for non-linear drag regimes\nusing both explicit and implicit timestepping.\n5.1.1 dustybox: setup\nWe set up constant densities \u03c1\u0302g and \u03c1\u0302d and gas pressure Pg in a 3D\nperiodic domain x, y, z \u2208 [0, 1] filled by 203 gas particles set up on\na regular cubic lattice and 203 dust particles shifted by half of the\nlattice spacing in each direction (as in Paper I, we verified that the\nresults are independent of the offset of the dust lattice). The gas\nsound speed, the gas and the dust densities are set to unity in code\n\n5.1.2 dustybox: different drag regimes\nFig. 1 shows the results of the dustybox test for the five different\nregimes given in Table 1 of Laibe & Price (2011a): linear (K = K0 ),\nquadratic (K = K0 |\u2206v|), power-law (K = K0 |\u2206v|a , with a = 0.4),\nthird order expansion\n(K = K0 [1 + a3 |\u2206v|2 ], with a3 = 0.5) and\np\nmixed (K = K0 1 + a2 |\u2206v|2 , with a2 = 5) where we have used\nK0 = 1 in each case. The analytic solutions are reproduced within\nan accuracy comprised between 0.1% and 1% in every case - both\nlinear and non-linear. The implicit scheme was find to converge\nquickly for this problem, requiring no more than two iterations at\nevery stage of the evolution in each case.\nThe efficiency of the damping for the dustybox problem decreases when the exponent of the drag regime increases, since\n||\u2206v|| < 1. On the contrary, additional non-linear terms give an additional contribution to the drag for the mixed and third order drag\nregimes, leading to a differential velocity that is more efficiently\ndamped compared to the linear case.\n\n\fLaibe & Price\n\nThe exact solution for linear waves propagating in a dust-gas mixture (dustywave) was derived in Laibe & Price (2011a) assuming\na linear drag regime. Unfortunately, exact solutions prove difficult\nto obtain for the case of non-linear drag. Instead, we have verified simply that our simulations of the dustywave problem for nonlinear drag regimes are converged in both space and time with an\nexplicit timestepping scheme. We have then used these results to\nbenchmark our simulations using implicit timestepping.\nWe run the dustyywave problem for the same five non-linear\ndrag regimes used above. Strictly speaking, It should be noted that\nassuming K0 is constant (which we assume for this test problem)\ncorresponds to Epstein and Stokes drag only to first order for the\ndustywave problem.\n\n1\u00d710-4\n\nt=5\n\n5\u00d710-5\nvx\n\n5.2 dustywave: Sound waves in a dust-gas mixture\n\n0\n\n-5\u00d710-5\n-1\u00d710-4\n1\u00d710-4\n\nt=5\n\n5\u00d710-5\nvx\n\n8\n\n0\n\n-5\u00d710-5\n-1\u00d710-4\n\nThe dustywave test is performed in a 1D periodic box, placing\nequally spaced particles in the periodic domain x \u2208 [0, 1] such that\nthe gas and dust densities are unity in code units. We do not apply\nany form of viscosity and the gas sound speed is set to unity. To\nremain in the linear acoustic regime, the relative amplitude of the\nperturbation of both velocity and density are set to 10\u22124 .\n\n1\u00d710-4\n\nt=5\n\n5\u00d710-5\nvx\n\n5.2.1 dustywave: Setup\n\n0\n\n-5\u00d710-5\n-1\u00d710-4\n0\n\n5.2.2 dustywave: Different drag regimes\nFig. 2 shows the velocity profiles after 5 periods for three drag\nregimes - linear, power law and quadratic - in the 1D dustywave problem using K0 = 1 and a dust-to-gas ratio of unity. The\nsolution obtained for the linear drag regime shows an efficiently\ndamped perturbation at t = 5, consistent with a stopping time of order unity. By comparison, the perturbation is only weakly damped\nfor the case of the power-law drag regime at the same time. The\ndrag is weaker still in the quadratic regime, for which both the dust\nand the gas are mostly decoupled. Indeed, since the drag stopping\ntime is a decreasing function of the differential velocity for nonlinear drag, and the differential velocity is small with respect to the\nsound speed, the damping is inefficient.\nWe have also performed dustywave simulations using the third\norder expansion and mixed drag regimes. However, for these cases,\nnon-linear terms represent only negligible corrections compared to\nthe linear term, thus giving the same results as for the linear case.\n\n0.5\nx\n\n1\n\nFigure 2. Solution of the 1D dustywave problem showing the SPH gas\n(solid black lines) and dust (dashed black) velocities using three different\ndrag regimes: linear (top panel), power-law with an exponent of 0.4 (center\npanel) and quadratic (bottom panel). The damping is strongly reduced for\nnon-linear drag regimes compared to the linear case. Results are shown after 5 wave periods and the linear case (top panel) may be compared to the\nexact analytic solution (red lines). The dust to gas ratio and K0 are set to 1\nin code units.\n\n5.3.1 dustyshock: Setup\nEqual mass particles are placed in the 1D domain x \u2208 [\u22120.5, 0.5],\nwhere for x < 0 we use \u03c1g = \u03c1d = 1, vg = vd = 0 and Pg = 1,\nwhile for x > 0 \u03c1g = \u03c1d = 0.125, vg = vd = 0 and Pg = 0.1. We use\nan ideal gas equation of state P = (\u03b3 \u2212 1)\u03c1u with \u03b3 = 5/3. Initial\nparticle spacing to the left of the shock in both fluids is \u2206x = 0.001\nwhile to the right it is \u2206x = 0.008, giving 569 equal mass particles\nin each phase. Standard SPH artificial viscosity and conductivity\nterms are applied as in Paper I.\n\n5.3 dustyshock: Two fluid dust-gas shocks\nThe dustyshock problem (Paper I) is a two fluid version of the\nstandard Sod (1978) shock tube problem. Results were presented\nin Paper I using a constant drag coefficient K and no heat transfer between the gas and the dust phase. Here we extend the test to\nnon-linear drag regimes. While the evolution during the transient\nstage is dependent on the drag regime, the solution during the stationary stage remains unchanged, being a fixed function of the gas\nsound speed and the dust-to-gas ratio. To facilitate the comparison\nbetween a physical Epstein drag and the case of a constant drag\ncoefficient (Paper I), we fix the ratio s2 /md - s being the grain\nsize and md the grain mass- to unity in code units, such that the\nEpstein drag coefficient is unity in regions where \u03c1\u0302g = 1.\n\n5.3.2 dustyshock: Different drag regimes\nFig. 3 illustrates how the transient regime of the dustyshock is affected when treating the drag with an astrophysical prescription\nwhere the drag coefficient depends on the local density and the\ngas sound speed (right panel) rather than a constant coefficient\n(left panel). Specifically, we use the non-linear Epstein drag regime\ngiven by Eq. 39. In this dustyshock test, the non-linear terms constitute a small correction to the linear Epstein drag regime given\nby Eq. 40. Fig. 3 shows that in the case of the Epstein regime, the\ndrag is less efficient than for the constant coefficient case, leading\nto a larger (\u223c by a factor 7) differential velocity between the gas\n\n\f9\n\nDusty gas with SPH - II.\n1\n\n0.8 t=0.2\n\n0.6\n\n0.5\n\n0.2\n\n0.4\n\n\u03c1\n\n\u03c1\n\n0.4\n\nvx\n\n0.6\nvx\n\n1\n\n0.8 t=0.2\n\n0.2\n\n0\n\n0\n-0.5\n\n0\n\n0.5\n\n-0.5\n\n0\n\n0.5\n\n-0.5\n\n0\n\n0.5\n\n1\n\n-0.5\n\n0\n\n0.5\n\n-0.5\n\n0\nx\n\n0.5\n\n1\n2\n\nu\n\nP\n\n1.5\n\n0.5\n\n1\n\n1.5\n\nP\n\n2\n\nu\n\n0.5\n\n0.5\n\n1\n-0.5\n\n0\nx\n\n0.5\n\n-0.5\n\n0\nx\n\n0.5\n\n-0.5\n\n0\nx\n\n0.5\n\nFigure 3. Results of the dustyshock problem with a linear constant drag coefficient (K = 1) (left panel) and a non-linear Epstein drag (right panel) where the\ndrag coefficients are initially the same ahead of the shock. The dust-to-gas ratio is set to unity. At t = 0.2, the solutions are in the transient stage where the\nanalytic solution is not known. As an indication, the solution for the later stationary stage is shown by the dotted/red lines. The profiles differ as the damping\nis less efficient using the non-linear Epstein regime.\n\nand the dust after t = 0.2 in code units. The dust velocity profile is\nalso smoother than in the constant coefficient case. As a result, the\nkinetic energy is less efficiently dissipated by the drag, leading to a\nless sharp peak in the internal energy of the gas. The density profile\nof the dust is also closer to its initial profile behind and ahead of the\nshock.\n\n5.4 dustysedov: Two fluid dust-gas blast wave\nThe dustysedov problem (Paper I) involves the propagation of a\nblast wave in an astrophysical mixture of dust and gas. We adopt\nphysical units for this problem, assuming a box size of 1 pc, an ambient sound speed of 2\u00d7104 cm/s and a gas density of \u03c10 = 6\u00d710\u221223\ng/cm3 the energy of the blast is 2 \u00d7 1051 erg and time is measured\nin units of 100 years, roughly corresponding to a supernova blast\nwave propagating into the interstellar medium. We these units, we\nchoose the grain size, 0.1\u03bcm and the dust-to-gas ratio, 0.01, to be\ntypical of the interstellar medium. In code units, this corresponds to\nan initial drag coefficient of K = 1 outside the blast radius. As for\nthe dustyshock, we compare the results using a non-linear Epstein\ndrag prescription with with the constant coefficient case described\nin Paper I.\n\n5.4.1 dustysedov: Setup\nThe problem is set up in a 3D periodic box (x, y, z \u2208 [\u22120.5, 0.5]),\nfilled by 503 particles for both the gas and the dust. Gas particles\nare set up on a regular cubic lattice, with the dust particles also on a\ncubic lattice but shifted by half of the lattice step in each direction.\nFor shock-capturing, we set \u03b1SPH = 1 and \u03b2SPH = 2 for the artificial\nviscosity terms and \u03b1u = 1 for the artificial conductivity term. An\nideal gas equation of state P = (\u03b3 \u2212 1)\u03c1u is adopted with \u03b3 = 5/3.\nThe internal energy is distributed of the gas over the particles\nlocated inside a radius r < rb where rb is set to 2h (i.e., the radius of\nthe smoothing kernel which for 503 particles and \u03b7 = 1.2 is 0.048).\nIn code units the total blast energy is E = 1, with \u03c1\u0302g = 1 and\n\u03c1\u0302d = 0.01. For r > rb , the gas sound speed is set to be 2 \u00d7 10\u22125 in\ncode units.\n5.4.2 dustysedov: Different drag regimes\nFigs. 4 and 5 show the evolution of the gas and dust mixture where\na constant drag coefficient is used (top panels of Fig. 4) compared\nto a drag prescribed by the Epstein regime (bottom panels of Fig. 4,\nFig. 5). The gas profiles are similar in both cases since the gas is\npoorly affected by the dust given the low dust-to-gas ratio. However, the dust density profiles differ, essentially due to the fact that\nthe drag coefficient scales with the sound speed and is thus higher\nin the inner blast region for the Epstein case. Thus, the dust is efficiently piled up and accumulates in the gas over-density. As a\n\n\f10\n\nLaibe & Price\n\u0003\n\n\u0003\n\u0010\u0011\u0005\u0006\n\n\u0005\u0006\u0007\n\n\u0005\u0006\b\n\n\u0005\u0006\b\n\n\u0005\n\n\u0005\n\n\u0002\n\n\u0002\n\n\u0005\u0006\u0007\n\n\u0004\u0005\u0006\b\n\n\u0004\u0005\u0006\b\n\n\u0004\u0005\u0006\u0007\n\n\u0004\u0005\u0006\u0007\n\u0004\u0005\u0006\u0007\n\n\u0004\u0005\u0006\b\n\n\u0005\u0006\n\n\u0005\n\u0001\n\n\u0005\u0006\b\n\n\u000e\u000f\u0010\u0002\n\n\u0006\n\n\u0005\u0006\u0007\n\n\u0004\u0005\u0006\u0007\n\n\u0004\u0005\u0006\b\n\n\u0012 \u0005\u0004\u0013\n\n\b\n\n\u0005\n\u0001\n\u0005\u0006\u0005\n\n\u000e\u000f\u0010\u0002\n\n\u0005\u0006\b\n\n\u0005\u0006\u0005\n\n\u0005\u0006\u0007\n\n\u0005\u0006\u0005\b\n\nFigure 5. Cross-section slice showing density in the midplane in the 3D dustysedov problem, for both the gas (left panel) and the dust (right panel) at t = 0.1.\nInitially, the dust-to-gas ratio is 0.01 and the drag coefficient is given by the Epstein regime for grains of 0.1\u03bcm in size. 503 SPH particles have been used in\neach phase.\n\n\u0004\n\u000f\n\n\u0005\n\n\u0012\u0010\n\n\u0010 \u0011\n\n\u0010\u000e\u000f\n\n\u0004\u000e \u000f\n\n\u0001\u0002\u0003\u0004\u0005\u0006\u0007\u0003\b\n\n\u0001\u0002\u0003\u0004\u0005\u0001\u0006\u0007\u0003\b\u0004\n\n\u000e\n\n5.5 dustydisc\n\n\u0004\n\u000f\n\n\u0005\n\n\u0015\u0016\u0003 \u0006\b\u0007\n\n\u0010 \u0011\n\n\u0013\u0014\u0003\u0004\u0006\b\u0007\n\n\u0004\u000e \u000f\n\n\u0001\u0002\u0003\u0004\u0005\u0006\u0007\u0003\b\n\n\u0001\u0002\u0003\u0004\u0005\u0001\u0006\u0007\u0003\b\u0004\n\n\u000e\n\n\u0011\n\n\u0013\n\n\u0011\u000f\n\n\u0011\u0014\n\nfound to be indistinguishable. For the Epstein case, we found that\nroughly ten iterations were required for the implicit scheme to converge on this problem.\n\nThe dustydisc problem concerns the evolution of a dusty gas mixture in a protoplanetary disc (see Paper I for details). For our test\ncase, we study how the dust distribution is affected when considering a general non-linear Epstein drag instead of the standard linear\nregime. The results obtained when implicitly integrating the nonlinear drag regime have been found to be similar to benchmark tests\nperformed with explicit integration.\n5.5.1 dustydisc: Setup\n\n\u0011\n\n\u0012\n\nFigure 4. Results of the 3D dustysedov test, showing the density in the gas\n(left figure) and dust (right figure) from a Sedov blast wave propagating\nin an astrophysical (1% dust-to-gas ratio) mixture of gas and 0.1\u03bcm dust\ngrains in a 1 pc box. The drag coefficient is constant (K = 1, top panels)\nor given by the Epstein regime (bottom panels). The low dust-to-gas ratio\nmeans that the gas is only weakly affected by the drag from the dust, and is\nthus close to the self-similar Sedov solution (dotted/red line). In the Epstein\ncase, the drag is much higher inside the blast radius and the dust particles\nare efficiently piled up by the passage of the gas over-density.\n\nresult, the dust is cleaned up by the gas in the inner regions of the\nblast, but is more concentrated (by \u223c 10%) close to the gas overdensity than for the constant drag coefficient case.\nThe results using either explicit or implicit timestepping were\n\nWe setup 105 gas particles and 105 dust particles in a 0.01M gas\ndisc (with 0.0001M of dust) surrounding a 1M star. The disc extends from 10 to 400 AU. Both gas and dust particles are placed\nusing a Monte-Carlo setup such that the surface density profiles of\nboth phases are \u03a3 (r) \u221d r\u22121 . The radial profile of the gas temperature is taken to be T (r) \u221d r\u22120.6 with a flaring H/r = 0.05 at 100\nAU. One code unit of time corresponds to 103 yrs.\n5.5.2 dustydisc: Evolution of the particles\nFig. 6 shows a face-on view of a protoplanetary disc, integrating the\nlinear Epstein regime (left panel) and the full non-linear Epstein\ndrag (right panel). The dust distributions are not found to exhibit\nsignificant discrepancies. In the non-linear drag regime case however, the dust distribution is slightly smoother since the drag (and\nthus, the coupling with the gas phase) is more efficient.\nFig. 7 compares the vertical motion of a dust grain initially located at z = z0 using the linear (explicit integration) and the full non\n\n\f14330 yrs\n\n14330 yrs\n\n-1\n\n-2\n\n11\n\nlog column density [g/cm2]\n\nDusty gas with SPH - II.\n\n-3\n\n-4\nFigure 6. Rendering of the density for the dust of a typical T-Tauri Star protoplanerary disc using 2 \u00d7 105 SPH particles, using an explicit time integration in\nthe linear Epstein regime (left panel) and an implicit integrator in the full non-linear Epstein drag regimes (right panel).\n\n0.02\n\nz\n\n0.01\n\n0\n\n-0.01\n\n-0.02\n0\n\n20\n\n40\nt\n\nFigure 7. Vertical settling of a dust grain (1cm in size) initially located at\nr0 = 100 AU and z0 = 2 AU (solid/black), integrating implicitly the nonlinear Epstein regime. SPH results are compared to the explicit integration\nof the linear Epstein regime (dashed/red) and the estimation given by the\ndamped harmonic oscillator approximation (pointed/red). In the full nonlinear drag regime, the settling is more efficient than for the linear case\nsince the vertical oscillations in the dust motion reaches a fraction z0 /H of\nthe sound speed.\n\nlinear (implicit integration) Epstein regimes. In the full non-linear\ncase, the settling is more efficient since the vertical differential velocity between the dust grains and the gas in the mid plane of the\ndisc reaches a fraction z0 /H of the sound speed, meaning that the\nnon-linear terms are no longer negligible.\n\n6\n\nwith respect to the differential velocity between the gas and the\ndust.\nParticular attention has been paid to developing an implicit\ntimestepping scheme to efficiently simulate the case of high drag,\nextending the scheme proposed by Monaghan (1997) which we\nfound to be unsatisfactory. We have presented a new pairwise implicit scheme that, like the Monaghan (1997) scheme, preserves the\nexact conservation of linear and angular momentum but, unlike the\nMonaghan (1997) scheme, i) provides control over the accuracy of\nthe iterative procedure and ii) can incorporate non-linear terms for\nboth Epstein and Stokes drag. We found that when the ratio r between the the timestep and the drag stopping time is 1 . r . 1000,\nthe implicit timestepping is faster than a standard explicit integration. However, at higher values of r, the algorithm is less efficient.\nThe accuracy of the generalised algorithm is benchmarked\nagainst the suite of test problems presented in Paper I. In particular,\nthe solutions obtained for the dustybox problem are compared to\ntheir known analytic solutions for a large range of non-linear drag\nregimes and the solutions of the dustywave, dustyshock, dustysedov and dustydisc problems are benchmarked against converged\nresults obtained with explicit timestepping.\nThe two key issues addressed in this paper complete the study\nof our algorithm developed in Paper I. Our intention is to apply it\nto various astrophysical problems involving gas and dust mixtures\nin star and planet formation. A first application is given in Ayliffe\net al. (2011).\n\nCONCLUSIONS\n\nWe have extended the SPH formalism for two-fluid dust and gas\nmixtures developed in Paper I to handle the drag regimes usually\nencountered in a large range of astrophysical contexts. Specifically,\nour algorithm is now designed to treat the dynamics of grains surrounded by a dilute medium (Epstein regime) or dense fluid (Stokes\nregime), for which the drag force can be either linear or non-linear\n\nACKNOWLEDGMENTS\nWe thank Ben Ayliffe and Matthew Bate and Joe Monaghan for\nuseful discussions and comments. Figures have been produced using splash (Price 2007) with the new giza backend by DP and\nJames Wetter. We are grateful to the Australian Research Council\nfor funding via Discovery project grant DP1094585.\n\n\f12\n\nLaibe & Price\n\nREFERENCES\nAyliffe B., Laibe G., Price D. J., Bate M. R., 2011, MNRAS, submitted\nBaines M. J., Williams I. P., Asebiomo A. S., 1965, MNRAS, 130,\n63\nBlum J., Wurm G., 2008, ARA&A, 46, 21\nChapman C., Cowling T., 1970, The mathematical theory of nonuniform gases. Cambridge at the university press\nChiang E., Youdin A. N., 2010, Annual Review of Earth and Planetary Sciences, 38, 493\nFan L.-S., Zhu C., 1998, Principles of Gas-Solid Flows. Cambridge University Press\nKwok S., 1975, ApJ, 198, 583\nLaibe G., Price D. J., 2011b, MNRAS, submitted\nLaibe G., Price D. J., 2011a, MNRAS, in press\nMonaghan J. J., 1997, Journal of Computational Physics, 138, 801\nMonaghan J. J., 2005, Reports on Progress in Physics, 68, 1703\nMonaghan J. J., Kocharyan A., 1995, Computer Physics Communications, 87, 225\nPaardekooper S.-J., Mellema G., 2006, A&A, 453, 1129\nPrice D. J., 2007, Publications of the Astronomical Society of\nAustralia, 24, 159\nPrice D. J., Monaghan J. J., 2007, MNRAS, 374, 1347\nSod G. A., 1978, Journal of Computational Physics, 27, 1\nStepinski T. F., Valageas P., 1996, A&A, 309, 301\nWhitehouse S. C., Bate M. R., Monaghan J. J., 2005, MNRAS,\n364, 1367\n\n\f"}