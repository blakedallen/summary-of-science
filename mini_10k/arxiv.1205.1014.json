{"id": "http://arxiv.org/abs/1205.1014v1", "guidislink": true, "updated": "2012-05-04T17:25:10Z", "updated_parsed": [2012, 5, 4, 17, 25, 10, 4, 125, 0], "published": "2012-05-04T17:25:10Z", "published_parsed": [2012, 5, 4, 17, 25, 10, 4, 125, 0], "title": "Descent polynomials for k bubble-sortable permutations of type B", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1205.1207%2C1205.0361%2C1205.3642%2C1205.2778%2C1205.0063%2C1205.1507%2C1205.1110%2C1205.0257%2C1205.3477%2C1205.3576%2C1205.1324%2C1205.3582%2C1205.3475%2C1205.4462%2C1205.4484%2C1205.3332%2C1205.2352%2C1205.1064%2C1205.2330%2C1205.3741%2C1205.0612%2C1205.1180%2C1205.0326%2C1205.1014%2C1205.0158%2C1205.2882%2C1205.3875%2C1205.3004%2C1205.1437%2C1205.1025%2C1205.1919%2C1205.2176%2C1205.0939%2C1205.2808%2C1205.0046%2C1205.2503%2C1205.3554%2C1205.0122%2C1205.0327%2C1205.2914%2C1205.1837%2C1205.1960%2C1205.0972%2C1205.3381%2C1205.0401%2C1205.4117%2C1205.3112%2C1205.1015%2C1205.2865%2C1205.0561%2C1205.1364%2C1205.0449%2C1205.1213%2C1205.1904%2C1205.2149%2C1205.4293%2C1205.1606%2C1205.4098%2C1205.1515%2C1205.0916%2C1205.1047%2C1205.2899%2C1205.2045%2C1205.1192%2C1205.1013%2C1205.0919%2C1205.3916%2C1205.2247%2C1205.3220%2C1205.1812%2C1205.1307%2C1205.0206%2C1205.3119%2C1205.1555%2C1205.0335%2C1205.2236%2C1205.1581%2C1205.0598%2C1205.0359%2C1205.0175%2C1205.0679%2C1205.2792%2C1205.2416%2C1205.3664%2C1205.0413%2C1205.3733%2C1205.3819%2C1205.1945%2C1205.1367%2C1205.0864%2C1205.1145%2C1205.2925%2C1205.2750%2C1205.1485%2C1205.1165%2C1205.4229%2C1205.4254%2C1205.2736%2C1205.0337%2C1205.0207%2C1205.1010&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Descent polynomials for k bubble-sortable permutations of type B"}, "summary": "Motivated by the work of Chung, Claesson, Dukes, and Graham, we define a\nnatural type B analog of the classic bubble sort, and use it to define a type B\nanalog of the maximum drop statistic. We enumerate (by explicit, recursive, and\ngenerating function formulas) signed permutations with r type B descents and\ntype B maximum drop at most k. We also find a connection between these signed\npermutations and certain 2-colored juggling sequences.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1205.1207%2C1205.0361%2C1205.3642%2C1205.2778%2C1205.0063%2C1205.1507%2C1205.1110%2C1205.0257%2C1205.3477%2C1205.3576%2C1205.1324%2C1205.3582%2C1205.3475%2C1205.4462%2C1205.4484%2C1205.3332%2C1205.2352%2C1205.1064%2C1205.2330%2C1205.3741%2C1205.0612%2C1205.1180%2C1205.0326%2C1205.1014%2C1205.0158%2C1205.2882%2C1205.3875%2C1205.3004%2C1205.1437%2C1205.1025%2C1205.1919%2C1205.2176%2C1205.0939%2C1205.2808%2C1205.0046%2C1205.2503%2C1205.3554%2C1205.0122%2C1205.0327%2C1205.2914%2C1205.1837%2C1205.1960%2C1205.0972%2C1205.3381%2C1205.0401%2C1205.4117%2C1205.3112%2C1205.1015%2C1205.2865%2C1205.0561%2C1205.1364%2C1205.0449%2C1205.1213%2C1205.1904%2C1205.2149%2C1205.4293%2C1205.1606%2C1205.4098%2C1205.1515%2C1205.0916%2C1205.1047%2C1205.2899%2C1205.2045%2C1205.1192%2C1205.1013%2C1205.0919%2C1205.3916%2C1205.2247%2C1205.3220%2C1205.1812%2C1205.1307%2C1205.0206%2C1205.3119%2C1205.1555%2C1205.0335%2C1205.2236%2C1205.1581%2C1205.0598%2C1205.0359%2C1205.0175%2C1205.0679%2C1205.2792%2C1205.2416%2C1205.3664%2C1205.0413%2C1205.3733%2C1205.3819%2C1205.1945%2C1205.1367%2C1205.0864%2C1205.1145%2C1205.2925%2C1205.2750%2C1205.1485%2C1205.1165%2C1205.4229%2C1205.4254%2C1205.2736%2C1205.0337%2C1205.0207%2C1205.1010&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Motivated by the work of Chung, Claesson, Dukes, and Graham, we define a\nnatural type B analog of the classic bubble sort, and use it to define a type B\nanalog of the maximum drop statistic. We enumerate (by explicit, recursive, and\ngenerating function formulas) signed permutations with r type B descents and\ntype B maximum drop at most k. We also find a connection between these signed\npermutations and certain 2-colored juggling sequences."}, "authors": ["Matthew Hyatt"], "author_detail": {"name": "Matthew Hyatt"}, "author": "Matthew Hyatt", "links": [{"href": "http://arxiv.org/abs/1205.1014v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1205.1014v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1205.1014v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1205.1014v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:1205.1014v1 [math.CO] 4 May 2012\n\nDESCENT POLYNOMIALS FOR k BUBBLE-SORTABLE\nPERMUTATIONS OF TYPE B\nMATTHEW HYATT\nAbstract. Motivated by the work of Chung, Claesson, Dukes, and\nGraham in [5], we define a natural type B analog of the classic bubble\nsort, and use it to define a type B analog of the maximum drop statistic.\nWe enumerate (by explicit, recursive, and generating function formulas)\nsigned permutations with r type B descents and type B maximum drop\nat most k. We also find a connection between these signed permutations\nand certain 2-colored juggling sequences.\n\nContents\n1. Introduction\n2. The type B maxdrop statistic\n3. Type B maxdrop-restricted descent polynomials\n4. Juggling sequences\n5. Acknowledgments\nReferences\n\n1\n7\n9\n16\n19\n19\n\n1. Introduction\nLet Sn denote the group of permutations on the set [n] := {1, 2, ..., n}.\nAn adjacent transposition \u03c4i \u2208 Sn , is the permutation (i, i + 1) written in\ncycle notation. Given any permutation \u03c0 \u2208 Sn written in one-line notation,\ni.e. \u03c0 = \u03c0(1), \u03c0(2), . . . , \u03c0(n), multiplying \u03c0 by \u03c4i on the right has the effect\nof switching \u03c0(i) and \u03c0(i + 1). For example if\n\u03c0 = 3, 4, 1, 5, 2, then \u03c0\u03c42 = 3, 1, 4, 5, 2.\nAny permutation can be expressed as a product of adjacent transpositions,\nso the set {\u03c41 , \u03c42 , . . . , \u03c4n\u22121 } generates Sn . Moreover, Sn is a Coxeter group\nand is also called the type A Coxeter group (see also [2]). Given \u03c0 \u2208 Sn ,\nif \u03c0 = \u03c4i1 \u03c4i2 * * * \u03c4ik and k is minimal among all such expressions, then k is\ncalled the Coxeter length of \u03c0 and we write l(\u03c0) = k.\nDate: May 3, 2012.\nKey words and phrases. Type B Coxeter group, Signed permutations, Bubble sort,\nPermutation statistics, Descent number, Maximum drop, Eulerian polynomials, Juggling\nsequences.\n1\n\n\f2\n\nM. HYATT\n\nThe (right) descent set of \u03c0 \u2208 Sn , denoted DESA (\u03c0), is defined by\nDESA (\u03c0) := {i \u2208 [n \u2212 1] : l(\u03c0\u03c4i ) < l(\u03c0)} .\nIt is well known that the descent set is also given by\nDESA (\u03c0) = {i \u2208 [n \u2212 1] : \u03c0(i) > \u03c0(i + 1)} .\nThe type A descent number of a permutation \u03c0 \u2208 Sn , denoted desA (\u03c0), is\nthe cardinality of the descent set of \u03c0, i.e.\ndesA (\u03c0) := | {i \u2208 [n \u2212 1] : \u03c0(i) > \u03c0(i + 1)} |.\n\n(1)\nFor example if\n\n\u03c0 = 4, 1, 3, 5, 2, then DESA (\u03c0) = {1, 4}, and desA (\u03c0) = 2.\nThe classic bubble sort, which we will denote by bubbleA , can be described\ncompletely in terms of generators (adjacent transpositions) and descents.\nBasically, one reads a permutation from left to right, and applies an adjacent\ntransposition at each step where there is a descent. More precisely, for\ni \u2208 [n \u2212 1] define a map si : Sn \u2192 Sn by si (\u03c0) = \u03c0\u03c4i if i \u2208 DESA (\u03c0), and\nsi (\u03c0) = \u03c0 otherwise. Then\n(2)\n\nbubbleA (\u03c0) = sn\u22121 \u25e6 sn\u22122 \u25e6 * * * \u25e6 s1 (\u03c0)\n\nFor example if \u03c0 = 3, 1, 4, 5, 2 then we can find bubbleA (\u03c0) in 4 steps\nStep\nStep\nStep\nStep\n\n1\n2\n3\n4\n\n3, 1, 4, 5, 2\n1, 3, 4, 5, 2\n1, 3, 4, 5, 2\n1, 3, 4, 5, 2\n\n7\u2192 1, 3, 4, 5, 2\n7\u2192 1, 3, 4, 5, 2\n7\u2192 1, 3, 4, 5, 2\n7\u2192 1, 3, 4, 2, 5\n\nthus bubbleA (\u03c0) = 1, 3, 4, 2, 5.\nThere is a natural way to extend this sorting algorithm to other Coxeter\ngroups, in particular the type B Coxeter group (see also [1], [8], [10]). We\nuse the convention that the type B Coxeter group Bn consists of signed\npermutations (see also [2]). A signed permutation \u03c0 is a bijection on the\nintegers [\u2212n, n], with the condition that \u03c0(\u2212i) = \u2212\u03c0(i). This forces \u03c0(0) =\n0, so \u03c0 is determined by its image on [n], and we write signed permutations\nin one-line notation as \u03c0 = \u03c0(1), \u03c0(2), . . . , \u03c0(n). Given \u03c0 \u2208 Bn , we use |\u03c0| to\ndenote the permutation |\u03c0| := |\u03c0(1)|, |\u03c0(2)|, . . . , |\u03c0(n)|. Note that |\u03c0| \u2208 Sn ,\nand Sn is a subgroup of Bn .\nTo realize Bn as a Coxeter group, we need a generating set. Let \u03c40 denote\nthe signed permutation \u03c40 := \u22121, 2, 3, ..., n. Given any \u03c0 \u2208 Bn , \u03c0\u03c40 is\nobtained from \u03c0 by simply changing the sign of \u03c0(1). Then Bn is generated\nby the set {\u03c40 , \u03c41 , . . . , \u03c4n\u22121 }, where each \u03c4i for i \u2208 [n \u2212 1] is the adjacent\ntransposition as defined above in the type A case. Define the Coxeter length\nin the same way as above, which one uses to define the (right) descent set\nof \u03c0 \u2208 Bn , denoted DESB (\u03c0), by\nDESB (\u03c0) := {i \u2208 [0, n \u2212 1] : l(\u03c0\u03c4i ) < l(\u03c0)} .\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n3\n\nAnd it turns out that\nDESB (\u03c0) = {i \u2208 [0, n \u2212 1] : \u03c0(i) > \u03c0(i + 1)},\nrecalling that \u03c0(0) = 0. The type B descent number of \u03c0 \u2208 Bn , denoted\ndesB (\u03c0), is the cardinality of the descent set of \u03c0, i.e.\ndesB (\u03c0) := | {i \u2208 [0, n \u2212 1] : \u03c0(i) > \u03c0(i + 1)} |.\n\n(3)\nFor example if\n\n\u03c0 = \u22123, 4, \u22121, \u22125, 2, then DESB (\u03c0) = {0, 2, 3}, and desB (\u03c0) = 3.\nSince the definition of the classic bubble sort, bubbleA , was given in terms\nof generators and descents, one can extend the definition in a very natural\nway to other Coxeter groups. This paper treats the case of extending the\ndefinition to the type B Coxeter group.\nDefinition 1.1. For i \u2208 [0, n \u2212 1] define a map si : Bn \u2192 Bn by si (\u03c0) = \u03c0\u03c4i\nif i \u2208 DESB (\u03c0), and si (\u03c0) = \u03c0 otherwise. We define the type B bubble sort,\ndenoted bubbleB , by\n(4)\n\nbubbleB (\u03c0) = sn\u22121 \u25e6 sn\u22122 \u25e6 * * * \u25e6 s0 (\u03c0).\n\nAs before, one can think of this as reading a signed permutation from left\nto right, and applying a generator at each step where there is a descent.\nFor example if \u03c0 = \u22123, 1, 4, \u22125, 2, then we find bubbleB (\u03c0) in 5 steps\nStep\nStep\nStep\nStep\nStep\n\n0 \u22123, 1, 4, \u22125, 2 7\u2192 3, 1, 4, \u22125, 2\n3, 1, 4, \u22125, 2 7\u2192 1, 3, 4, \u22125, 2\n1\n2\n1, 3, 4, \u22125, 2 7\u2192 1, 3, 4, \u22125, 2\n1, 3, 4, \u22125, 2 7\u2192 1, 3, \u22125, 4, 2\n3\n4\n1, 3, \u22125, 4, 2 7\u2192 1, 3, \u22125, 2, 4\n\nthus bubbleB (\u03c0) = 1, 3, \u22125, 2, 4.\nRemark 1.2. Note that we can extend this definition in the obvious way\nto words \u03c0 over Z, provided that |\u03c0| is a permutation on some subset of\npositive integers.\nBy successively applying bubbleA to a permutation, or bubbleB to a signed\npermutation, one eventually obtains the identity permutation id. Define the\ntype A bubble sort complexity of \u03c0 \u2208 Sn by\n(5)\n\nbscA (\u03c0) := min{k : bubbleA k (\u03c0) = id}.\n\nDefine the type B bubble sort complexity of \u03c0 \u2208 Bn by\n(6)\n\nbscB (\u03c0) := min{k : bubbleB k (\u03c0) = id}.\n\nGiven \u03c0 \u2208 Sn , one can quickly compute type A bubble sort complexity using a statistic called the maximum drop, which we denote by maxdropA (\u03c0).\n\n\f4\n\nM. HYATT\n\nIn [5], Chung, Claesson, Dukes, and Graham give the distribution of descents in Sn with respect to maximum drop. Much of the work in this paper\nis inspired by, and relies on, results from their work. Define\n(7)\n\nmaxdropA (\u03c0) := max{i \u2212 \u03c0(i) : 1 \u2264 i \u2264 n}.\n\nBy induction, one can prove that for all \u03c0 \u2208 Sn we have\n(8)\n\nbscA (\u03c0) = maxdropA (\u03c0).\n\nOur motivation is to find a type B analog of the maximum drop statistic.\nDefinition 1.3. For \u03c0 \u2208 Bn , we say \u03c0 has a drop at position i if \u03c0(i) < i.\nIf \u03c0 has a drop at position i, then we say the drop size at position i is\nmin{i \u2212 \u03c0(i), i}. The type B maximum drop of \u03c0, denoted maxdropB (\u03c0), is\nthe maximum of all drop sizes occuring in \u03c0. In other words\nn\no\nmaxdropB (\u03c0) := max max{i \u2212 \u03c0(i) : \u03c0(i) > 0}, max{i : \u03c0(i) < 0} .\n\nFor example maxdropB (\u22123, 4, \u22121, \u22125, 2) = 4 since there is a drop of size 4\nat position 4. Note there are drops of size 3 at positions 3 and 5, and a drop\nof size 1 at position 1.\nIn Proposition 2.3, we show that type B maximum drop has the analogous\nproperty to (8), that is for all \u03c0 \u2208 Bn we have\n(9)\n\nbscB (\u03c0) = maxdropB (\u03c0).\n\nSince our work is motivated by the results appearing in [5], we state some\nof their results below. First define\nAn,k := {\u03c0 \u2208 Sn : maxdropA (\u03c0) \u2264 k},\nand\nan,k (r) := |{\u03c0 \u2208 An,k : des(\u03c0) = r}|,\nthen define a k-maxdropA -restricted descent polynomial\nX\nX\nAn,k (x) :=\nxdesA (\u03c0) =\nan,k (r)xr .\n\u03c0\u2208An,k\n\nr\u22650\n\nNote that for k \u2265 n\u22121, An,k = Sn and An,k (x) becomes the type A Eulerian\npolynomial, denoted An (x), defined by\nn\u22121\nX \u001cn\u001d\nX\ndesA (\u03c0)\nx\n=\nAn (x) =\nxk .\nk\n\u03c0\u2208Sn\nk=0\n\u001c \u001d\nn\nThe coefficient\nis called an Eulerian number. It is the number of\nk\npermutation in Sn with exactly k descents, and is given explicitly by\n\u0012\n\u0013\n\u001c \u001d X\nk\nn+1\nn\n(\u22121)i\n(k + 1 \u2212 i)n .\n=\nk\ni\ni=0\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n5\n\nThe k-maxdropA -restricted descent polynomials An,k satisfy the following\nrecurrence, which is equivalent to a generating function formula.\nTheorem 1.4 ([5, Theorem 1]). For n \u2265 0,\n\u0013\nk+1 \u0012\nX\nk+1\nAn+k+1,k (x) =\n(x \u2212 1)i\u22121 An+k+1\u2212i,k (x),\ni\ni=1\n\nwith initial conditions Ai,k (x) = Ai (x) for 0 \u2264 i \u2264 k.\nConsequently,\n\u0011\nPk \u0010\nPt\nk+1\u0001\ni\u22121 A\n1\n+\n(x\n\u2212\n1)\n(x)\nzt\nA\n(x)\n\u2212\nX\nt\u2212i\nt\nt=1\ni=1\ni\nn\n.\nAn,k (x)z =\n\u0001\nP\nk+1 i\ni\u22121\n1 \u2212 k+1\ni=1\ni z (x \u2212 1)\nn\u22650\n\nThe following theorem gives an explicit formula for an,k (r).\nP\nTheorem 1.5 ([5, Theorem 2]). We have An,k (x) = d \u03b2k ((k + 1)d)xd ,\nwhere\n\u0013n\u2212k\n\u0012\nX\n1 \u2212 uk+1\nj\n,\n\u03b2k (j)u = Pk (u)\n1\u2212u\nj\n\nwith\n\nPk (u) =\n\nk\nX\n\nk+1\n\nAk\u2212j (u\n\nk+1\n\n)(u\n\nj\n\n\u2212 1)\n\nk \u0012 \u0013\nX\ni\ni=j\n\nj=0\n\nj\n\nu\u2212i .\n\nIn other words, the coefficients an,k (r) of the polynomial An,k (x), have\nthe remarkable property that they are given by every (k + 1)st coefficient in\nthe polynomial\nPk (u)(1 + u + u2 + * * * + uk )n\u2212k .\nFor example setting n = 4 and k = 2 we have\nP2 (u)(1 + u + u2 )4\u22122 = (1 + u + 2u2 + u3 + u4 )(1 + u + u2 )2\n= 1 + 3u + 7u2 + 10u3 + 12u4 + 10u5 + 7u6 + 3u7 + u8 .\nSo the coefficients of A4,2 (x) are given by every third coefficient in the above\npolynomial, that is\nA4,2 (x) = 1 + 10x + 7x2 .\nWe provide analogous enumerations for signed permutations in Bn with\nr descents and maximum drop size less than or equal to k. First we define\nBn,k := {\u03c0 \u2208 Bn : maxdropB (\u03c0) \u2264 k},\nand\nbn,k (r) := |{\u03c0 \u2208 Bn,k : desB (\u03c0) = r}|,\nthen define a k-maxdropB -restricted descent polynomial\nX\nX\nBn,k (x) :=\nxdesB (\u03c0) =\nbn,k (r)xr .\n\u03c0\u2208Bn,k\n\nr\u22650\n\n\f6\n\nM. HYATT\n\nNote that for k \u2265 n, Bn,k = Bn and Bn,k (x) becomes the type B Eulerian\npolynomial, denoted Bn (x), defined by\nn\u22121\nX \u001cn\u001d\nX\ndesB (\u03c0)\nx\n=\nxk .\nBn (x) =\nk B\nk=0\n\u03c0\u2208Bn\n\u001c \u001d\nn\nThe coefficient\nis called a type B Eulerian number. It is the number\nk B\nof signed permutations in Bn with exactly k type B descents, and is given\nexplicitly by\n\u001c \u001d\n\u0012\n\u0013\nk\nX\nn\ni n+1\n(\u22121)\n=\n(2k + 1 \u2212 2i)n .\nk B\ni\ni=0\n\nIt turns out that the k-maxdropB -restricted descent polynomials Bn,k (x),\nsatisfy the same recurrence as their type A counterparts (compare with\nTheorem 1.4).\nTheorem 1.6. For n \u2265 0,\nBn+k+1,k (x) =\n\n\u0013\nk+1 \u0012\nX\nk+1\ni=1\n\ni\n\n(x \u2212 1)i\u22121 Bn+k+1\u2212i,k (x),\n\nwith initial conditions Bi,k (x) = Bi (x) for 0 \u2264 i \u2264 k.\nConsequently,\n\u0011\n\u0001\nP\nP \u0010\ni\u22121 B\n(x\n\u2212\n1)\n(x)\nzt\n1 + kt=1 Bt (x) \u2212 ti=1 k+1\nX\nt\u2212i\ni\n.\nBn,k (x)z n =\nPk+1 k+1\u0001 i\ni\u22121\n1\n\u2212\nz\n(x\n\u2212\n1)\ni=1\ni\nn\u22650\n\nSimilar to the polynomial Pk (u) defined above (see Theorem 1.5), we\ndefine\nk \u0012 \u0013\nk\nX\nX\ni \u2212i\nk+1\nk+1\nj\nBk\u2212j (u )(u\n\u2212 1)\nQk (u) =\nu .\nj\nj=0\n\ni=j\n\nIt also turns out that the coefficients bn,k (r) of the polynomial Bn,k (x), have\nthe analogous remarkable property that they are given by every (k + 1)st\ncoefficient in the expression\nQk (u)(1 + u + u2 + * * * + uk )n\u2212k .\nFor example setting n = 4 and k = 2 we have\n\nQ2 (u)(1 + u + u2 )4\u22122 = (1 + 4u + 6u2 + 6u3 + 4u4 + 2u5 + u6 )(1 + u + u2 )2\n= 1 + 6u + 17u2 + 32u3 + 43u4 + 44u5 + 35u6 + 22u7 + 11u8 + 4u9 + u10 .\nThe coefficients of B4,2 (x) are in fact given by every third coefficient above,\nthat is\nB4,2 (x) = 1 + 32x + 35x2 + 4x3 .\nWe state this precisely this in the following theorem.\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\nP\n\n7\n\n+ 1)d)xd , where\n\u0013n\u2212k\n\u0012\nX\n1 \u2212 uk+1\n,\n\u03b3k (j)uj = Qk (u)\n1\u2212u\n\nTheorem 1.7. We have Bn,k (x) =\n\nd \u03b3k ((k\n\nj\n\nwith\nQk (u) =\n\nk\nX\n\nBk\u2212j (u\n\nj=0\n\nk+1\n\n)(u\n\nk+1\n\nj\n\n\u2212 1)\n\nk \u0012 \u0013\nX\ni\ni=j\n\nj\n\nu\u2212i .\n\nWhile our work here is motivated by the work of Chung, Claesson, Dukes,\nand Graham in [5], that paper was motivated by its connection to a paper\nof Chung and Graham [6] that deals with juggling sequences. We explain\nthis connection in section 4, and show how our work can also be interpreted\nin terms of certain juggling sequences.\n2. The type B maxdrop statistic\nWe introduced the type B maxdrop statistic in Definition 1.3, and claimed\nthat it is equal to our type B bubble sort complexity (see (9)). Here we prove\nthis claim. The first step is to derive an alternate description of the type B\nbubble sort.\nDefinition 2.1. Given any signed permutation \u03c0 = \u03c0(1), \u03c0(2), . . . , \u03c0(n), let\n\u03c3 := |\u03c0(1)|, \u03c0(2), \u03c0(3), . . . , \u03c0(n) \u2208 Bn . There exists a unique index j such\nthat \u03c3(j) \u2265 \u03c3(i) for i \u2208 [n]. Split \u03c0 into blocks L and R to the left and right\nof \u03c0(j), i.e. \u03c0 = L\u03c0(j)R. Define an operator O which acts recursively by\nO(L\u03c0(j)R) = O(L)R|\u03c0(j)|,\nwhere O(\u2205) = \u2205.\nProposition 2.2. For any signed permutation \u03c0, we have O(\u03c0) = bubbleB (\u03c0).\nConsequently, if \u03c0 = L\u03c0(j)R as in Definition 2.1, then\n(10)\n\nbubbleB (L\u03c0(j)R) = bubbleB (L)R|\u03c0(j)|.\n\nProof. Let \u03c0 \u2208 Bn , and induct on n. The base case is obvious.\nNow let n \u2265 2 and assume O(\u03b1) = bubbleB (\u03b1) whenever \u03b1 is a word over\nZ with length less than n (assume |\u03b1| is a permutation on some subset of\npositive integers, see also Remark 1.2) . Let \u03c0 \u2208 Bn and let \u03c0 = L\u03c0(j)R as\nin Definition 2.1. Then\nO(\u03c0) = O(L)R|\u03c0(j)| = bubbleB (L)R|\u03c0(j)|.\nIf j = 1, then L = \u2205 and\nbubbleB (\u03c0) = bubbleB (\u03c0(1)R) = R|\u03c0(1)| = O(\u03c0).\nThis is because bubbleB will make \u03c0(1) positive (if its not already) in the 0th\nstep. Then |\u03c0(1)| > \u03c0(i) for 2 \u2264 i \u2264 n and each successive step in bubbleB\nwill apply an adjacent transposition, moving |\u03c0(1)| to the last position.\n\n\f8\n\nM. HYATT\n\nIf j > 1, then \u03c0(j) must be positive, and it is also the largest letter in \u03c0.\nAlso, L will be a word of length less than n. It is clear then that\nbubbleB (\u03c0) = bubbleB (L\u03c0(j)R) = bubbleB (L)R|\u03c0(j)| = O(L)R|\u03c0(j)| = O(\u03c0).\n\u0003\nNext we use this alternate description of bubbleB to show that maxdropB\nhas the desired property of being equal to bscB .\nProposition 2.3. For all signed permutations \u03c0 other than id we have\n(11)\n\nmaxdropB (bubbleB (\u03c0)) = maxdropB (\u03c0) \u2212 1.\n\nFor all signed permutations \u03c0 we have\n(12)\n\nmaxdropB (\u03c0) = bscB (\u03c0).\n\nProof. First note that (12) follows easily from (11), since id is the only signed\npermutation whose type B maximum drop is equal to zero. To prove (11),\ninduct on the length of \u03c0. The base case n = 1 is trivial. Now assume\n\u03c0 \u2208 Bn and\n(13)\n\nmaxdropB (bubbleB (\u03c3)) = maxdropB (\u03c3) \u2212 1\n\nfor all signed permutations \u03c3 of length less than n. As in Proposition 2.2,\nlet\nbubbleB (\u03c0) = bubbleB (L\u03c0(j)R) = bubbleB (L)R|\u03c0(j)|.\nFirst we show that maxdropB (bubbleB (\u03c0)) \u2264 maxdropB (\u03c0) \u2212 1. Using\n(13) on bubbleB (L) and the fact that R has been shifted to the left, we\nsee that the largest drop size of bubbleB (\u03c0) among letters from L or R, is\nexactly one less than the largest drop size of \u03c0 among letters from L or\nR. It remains to check that the drop size at position n in bubbleB (\u03c0) is no\nbigger than maxdropB (\u03c0) \u2212 1. Indeed, the description of bubbleB given in\nProposition 2.2 implies that the n \u2212 |\u03c0(j)| letters in \u03c0 which have absolute\nvalue larger that |\u03c0(j)|, must be negative and cannot appear in position\n1. We obtain a lower bound on maxdropB (\u03c0) by assuming these negative\nletters must occur as far to the left as possible in \u03c0, so\n(14)\n\nmaxdropB (\u03c0) \u2265 n \u2212 |\u03c0(j)| + 1.\n\nBut the drop size at position n in bubbleB (\u03c0) is precisely n \u2212 |\u03c0(j)|, which\nis less than or equal to maxdropB (\u03c0) \u2212 1 as desired.\nNext we show that maxdropB (bubbleB (\u03c0)) \u2265 maxdropB (\u03c0) \u2212 1. If the\nmaximum drop size of \u03c0 does not occur at position j, then the maximum\ndrop size is contributed by a letter from L or R. Again using (13) on\nbubbleB (L) and the fact that R has been shifted to the left, this implies\nmaxdropB (bubbleB (\u03c0)) = maxdropB (\u03c0) \u2212 1. If \u03c0 does have a maximum\ndrop size at position j, then we claim that maxdropB (\u03c0) = 1, in which case\nwe are done. Indeed suppose \u03c0 has a drop of maximum size at position j\nand 2 \u2264 j \u2264 n. Then |\u03c0(j)| = \u03c0(j) and\nmaxdropB (\u03c0) = j \u2212 \u03c0(j).\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n9\n\nBut then we have a contradiction since\nmaxdropB (\u03c0) = j \u2212 \u03c0j \u2264 n \u2212 |\u03c0(j)| < maxdropB (\u03c0),\nwhere the last inequality follows from (14). On the other hand, if j = 1 and\n\u03c0 has a maximum drop at position j, then maxdropB (\u03c0) = 1.\n\u0003\n3. Type B maxdrop-restricted descent polynomials\nIn this section we provide the proofs of Theorem 1.6 and Theorem 1.7.\nIn particular, we prove Theorem 1.6 by modifying the proof of Theorem 1.4\nfound in [5]. We then explain how Theorem 1.7 is a consequence of Theorem\n1.6 and Theorem 1.5 from [5].\nSuppose we have a finite set C = {c1 , c2 , . . . , cn } \u2282 N with c1 < c2 <\n* * * < cn , and a permutation \u03c0 on C. The standardization of \u03c0, denoted\nst(\u03c0), is the permutation in Sn obtained from \u03c0 by replacing ci with i. For\nexample st(4, 5, 2, 9, 7) = 2, 3, 1, 5, 4. We will call \u03c0 a signed permutation on\nthe set C, if \u03c0 is a word over Z and |\u03c0| is permutation on C. We define the\nsigned standardization of a signed permutation, denoted sst(\u03c0), by\n(\nst(|\u03c0|)(i)\nif \u03c0(i) > 0\nsst(\u03c0)(i) =\n\u2212st(|\u03c0|)(i) if \u03c0(i) < 0\nIn other words, sst(\u03c0) is the standardization of |\u03c0| = |\u03c0(1)|, |\u03c0(2)|, . . . , |\u03c0(n)|,\nbut then put the minus signs back in the same positions. For example\nsst(\u22125, 4, \u22122, 9, 7) = \u22123, 2, \u22121, 5, 4. If the set C is fixed, then the inverse\nof sst, denoted sst\u22121\nC , is well-defined. For example if C = {2, 4, 5, 7, 9} and\n\u03c0 = \u22123, 2, \u22121, 5, 4, then sst\u22121\nC (\u03c0) = \u22125, 4, \u22122, 9, 7. If we use (3) to define\nthe type B descent set for any word over Z, then it is clear that sst and sst\u22121\nC\npreserve type B descent set. For example DESB (\u22125, 4, \u22122, 9, 7) = {0, 2, 4} =\nDESB (\u22123, 2, \u22121, 5, 4).\nFor any S \u2286 [0, n \u2212 1], define\nBn,k (S) := {\u03c0 \u2208 Bn,k : DESB (\u03c0) \u2287 S},\ntn (S) := max{i \u2208 N : [n \u2212 i, n \u2212 1] \u2286 S},\nwith tn (S) = 0 if n \u2212 1 \u2208\n/ S. Given any \u03c0 \u2208 Bn,k (S) where k < n, define a\nmap f by\n(15)\n\nf (\u03c0) = (\u03b1, X), where\n\n\u03b1 = sst(\u03c0(1), \u03c0(2), . . . , \u03c0(n \u2212 i \u2212 1)), X = {\u03c0(n \u2212 i), \u03c0(n \u2212 i + 1), . . . , \u03c0(n)}\nwith i = tn (S). Note that since k < n, \u03c0(n) must be positive. Moreover,\nsince [n \u2212 i, n \u2212 1] \u2286 S \u2286 DESB (\u03c0), we know that X is a set of positive\nintegers.\nFor example, let S = {0, 2, 6, 7} and choose \u03c0 = \u22126, 2, \u22121, \u22123, 8, 7, 5, 4 \u2208\nB8,5 (S). Note that DESB (\u03c0) = {0, 2, 3, 5, 6, 7} \u2283 S, and maxdropB (\u03c0) =\n4 \u2264 k = 5. Since i = t8 (S) = 2, we have f (\u03c0) = (\u03b1, X) where \u03b1 =\nsst(\u22126, 2, \u22121, \u22123, 8) = \u22124, 2, \u22121, \u22123, 5 and X = {4, 5, 7}.\n\n\f10\n\nM. HYATT\n\nLemma 3.1. For 0 \u2264 k \u2264 n \u2212 1 we have\n\u0012\n\u0013\n[n \u2212 k, n]\nf : Bn,k (S) \u2192 Bn\u2212i\u22121,k (S \u2229 [0, n \u2212 i \u2212 2]) \u00d7\n.\ni+1\n\u0001\nwhere i = tn (S), and X\nm denotes the set of m-element subsets of X.\n\nProof. Let \u03c0 \u2208 Bn,k (S), and let f (\u03c0) = (\u03b1, X). Let i = tn (S), thus [n \u2212\ni, n \u2212 1] \u2286 DESB (\u03c0), and\n\u03c0(n \u2212 i) > \u03c0(n \u2212 i + 1) > * * * > \u03c0(n).\n\nSince maxdropB (\u03c0) \u2264 k < n, we must have that \u03c0(n) is a positive integer,\nand \u03c0(n) \u2265 n \u2212 k. Therefore X is an (i + 1)-element subset of [n \u2212 k, n].\nClearly \u03b1 \u2208 Bn\u2212i\u22121 , and we also need to show that maxdropB (\u03b1) \u2264 k.\nLet j be an index such that 1 \u2264 j \u2264 n \u2212 i \u2212 1. If \u03c0(j) is negative, then \u03c0\nhas a drop of size j at position j. After applying signed standardization to\n\u03c0, we see that \u03b1(j) is also negative, so \u03b1 has a drop of size j at position j.\nSince the drop size is unchanged, it must be less than or equal to k.\nIf 0 < \u03c0(j) < \u03c0(n), then \u03b1(j) = \u03c0(j) and again the drop size is unchanged.\nIf \u03c0(j) > \u03c0(n), then \u03b1(j) will be a smaller than \u03c0(j), but no smaller than\n\u03c0(n). Since \u03c0 \u2208 Bn,k , we have \u03b1(j) \u2265 \u03c0(n) \u2265 n \u2212 k. The corresponding\ndrop size in \u03b1 must satisfy\nj \u2212 \u03b1(j) \u2264 n \u2212 (n \u2212 k) = k.\nIn all three cases, we have maxdropB (\u03b1) \u2264 k.\nSince signed standardization preserves type B descent sets, the type B\ndescent set of \u03b1 still contains the part of S that is between 0 and n \u2212 i \u2212 2,\ni.e. \u03b1 \u2208 Bn\u2212i\u22121,k (S \u2229 [0, n \u2212 i \u2212 2]).\n\u0003\nOur goal is to show that f is a bijection. To accomplish this, we describe\nthe inverse map of f . Let \u03c0 \u2208 Bn\u2212i\u22121,k (T ) where T \u2286 [0, n \u2212 i \u2212 2]. Let\nX = {x1 , . . . , xi+1 } be an (i + 1)-element subset of [n \u2212 k, n], where x1 \u2264\nx2 \u2264 * * * \u2264 xi+1 . Define a map g (which we will show is the inverse of f ) by\ng(\u03c0, X) = sst\u22121\nC (\u03c0) \u2217 (xi+1 , xi , . . . , x1 )\nwhere C = [n] \\ X, and \u2217 denotes concatenation.\nFor example, let T = {2} and let \u03c0 = \u22123, 1, \u22124, 2, 5 \u2208 B5,4 (T ). Note that\nmaxdropB (\u03c0) = 3 \u2264 k = 4 and DESB (\u03c0) = {0, 2} \u2283 T . Chose i = 2, then\n5 = n \u2212 i \u2212 1 implies that n = 8, and let X = {4, 5, 7} \u2208 [n \u2212 k, n] = [4, 8].\nThen C = [n] \\ X = {1, 2, 3, 6, 8}, and\ng(\u03c0, X) = sst\u22121\nC (\u22123, 1, \u22124, 2, 5) \u2217 (7, 5, 4)\n= \u22123, 1, \u22126, 2, 8, 7, 5, 4 \u2208 B8,4 (T \u222a [6, 7]) .\nLemma 3.2. For 0 \u2264 k \u2264 n \u2212 1 we have\n\u0012\n\u0013\n[n \u2212 k, n]\ng : Bn\u2212i\u22121,k (T ) \u00d7\n\u2192 Bn,k (T \u222a [n \u2212 i, n \u2212 1]).\ni+1\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n11\n\nProof. Let \u03b1 = g(\u03c0, X). Clearly \u03b1 \u2208 Bn , so next we will show that\nmaxdropB (\u03b1) \u2264 k. Let j be an index such that 1 \u2264 j \u2264 n \u2212 i \u2212 1. If\n\u03b1(j) is negative, then it must be that \u03c0(j) is also negative. Thus the drop\nsize at position j of \u03b1, is the same as the drop size at position j of \u03c0, hence\nless than or equal to k. If \u03b1(j) > 0, then \u03b1(j) \u2265 \u03c0(j). If there is a drop at\nposition j of alpha, then the drop size satisfies\nj \u2212 \u03b1(j) \u2264 j \u2212 \u03c0(j) \u2264 k.\nNow let j be an index such that n \u2212 i \u2264 j \u2264 n. Since \u03b1(n \u2212 i) >\n\u03b1(n \u2212 i + 1) > * * * > \u03b1(n), the largest drop occurs at position n. But\n\u03b1(n) \u2208 [n \u2212 k, n], so\nn \u2212 \u03b1(n) \u2264 n \u2212 (n \u2212 k) = k,\nand \u03b1 \u2208 Bn,k .\n\u22121\npreserves type B descent sets, and since \u03b1(n \u2212 i) > \u03b1(n \u2212\nSince sstC\ni + 1) > * * * > \u03b1(n), it follows that desB (\u03b1) \u2283 (T \u222a [n \u2212 i, n \u2212 1]), hence\n\u03b1 \u2208 Bn,k (T \u222a [n \u2212 i, n \u2212 1]) as desired.\n\u0003\nLemma 3.3. The map f is a bijection, and its inverse is the map g.\nProof. Let\n\n\u0012\n\n\u0013\n[n \u2212 k, n]\n(\u03c0, X) \u2208 Bn\u2212i\u22121,k (T ) \u00d7\ni+1\nwhere T \u2286 [n \u2212 i \u2212 2] and X = {x1 \u2264 * * * \u2264 xi+1 }. Let \u03b1 = g(\u03c0, X) \u2208\nBn,k (T \u222a [n \u2212 i, n \u2212 1]), so\n\u03b1 = sst\u22121\nC (\u03c0) \u2217 (xi+1 , xi , . . . , x1 )\nwhere C = [n] \\ X. To find f (\u03b1), we first compute\ntn (T \u222a [n \u2212 i, n \u2212 1]) = max{j \u2208 N : [n \u2212 j, n \u2212 1] \u2286 (T \u222a [n \u2212 i, n \u2212 1])} = i.\nSo\nf (g(\u03c0, X)) = f (\u03b1) = (sst(sst\u22121\nC (\u03c0)), {xi+1 , xi , . . . , x1 }) = (\u03c0, X).\nNow given \u03c0 \u2208 Bn,k (S), let f (\u03c0) = (\u03b1, X) where\n(\u03b1, X) = (sst(\u03c0(1), \u03c0(2), . . . , \u03c0(n \u2212 i \u2212 1)), {\u03c0(n \u2212 i), \u03c0(n \u2212 i + 1), . . . , \u03c0(n)}) ,\nwhere i = tn (S). Since this means that [n \u2212 i, n \u2212 1] \u2286 S \u2286 DESB (\u03c0), we\nknow that\n\u03c0(n) < \u03c0(n \u2212 1) < * * * < \u03c0(n \u2212 i + 1).\nThus\ng(f (\u03c0)) = g(\u03b1, X)\n= sst\u22121\n[n]\\X (sst(\u03c0(1), \u03c0(2), . . . , \u03c0(n \u2212 i \u2212 1))) \u2217 \u03c0(n \u2212 i), \u03c0(n \u2212 i + 1), . . . , \u03c0(n)\n= (\u03c0(1), \u03c0(2), . . . , \u03c0(n \u2212 i \u2212 1) \u2217 \u03c0(n \u2212 i), \u03c0(n \u2212 i + 1), . . . , \u03c0(n)\n= \u03c0.\n\u0003\n\n\f12\n\nM. HYATT\n\nCorollary 3.4. Let bn,k (S) := |Bn,k (S)|. For 0 \u2264 k \u2264 n \u2212 1 we have\n\u0012\n\u0013\nk+1\nbn,k (S) = bn\u2212i\u22121,k (S \u2229 [0, n \u2212 i \u2212 2])\n,\ni+1\nwhere i = tn (S).\nTheorem 3.5. For n \u2265 0,\nBn,k (x) =\n\n\u0013\nk+1 \u0012\nX\nk+1\nj\n\nj=1\n\n(x \u2212 1)j\u22121 Bn\u2212j,k (x),\n\nwith initial conditions Bj,k (x) = Bj (x) (the type B Eulerian polynomial) for\n0 \u2264 j \u2264 k. By replacing n by n + k + 1, one obtains the recurrence in\nTheorem 1.6.\nProof. First we express Bn,k (x + 1) in terms of bn,k as follows:\nBn,k (x + 1) =\n\nX\n\n(x + 1)desB (\u03c0)\n\n\u03c0\u2208Bn,k\n\n=\n\nX\n\n\u03c0\u2208Bn,k\n\n=\n\ndesB (\u03c0) \u0012\n\nX\n\nX\nj=0\n\nX\n\n\u0013\ndesB (\u03c0) j\nx\nj\nx|S|\n\n\u03c0\u2208Bn,k S\u2286DESB (\u03c0)\n\n=\n\nX\n\nx|S|\n\nS\u2286[0,n\u22121]\n\n=\n\nX\n\nX\n\n1\n\n\u03c0\u2208Bn,k (S)\n\nbn,k (S)x|S|\n\nS\u2286[0,n\u22121]\n\nNow take Corollary 3.4, multiply both sides by x|S| and sum over all\nS \u2286 [0, n \u2212 1]:\n\u0012\n\u0013\nX\nk+1\nBn,k (x + 1) =\nx|S| bn\u2212tn (S)\u22121,k (S \u2229 [0, n \u2212 tn (S) \u2212 2])\ntn (S) + 1\nS\u2286[0,n\u22121]\n\u0012\n\u0013\nX X\nk+1\n|S|\n=\nx bn\u2212i\u22121,k (S \u2229 [0, n \u2212 i \u2212 2])\ni+1\ni\u22650 S\u2286[0,n\u22121]\ntn (S)=i\n\n=\n\nX \u0012k + 1 \u0013\ni\u22650\n\ni+1\n\nxi\n\nX\n\nx|S|\u2212i bn\u2212i\u22121,k (S \u2229 [0, n \u2212 i \u2212 2])\n\nS\u2286[0,n\u22121]\ntn (S)=i\n\nRecall that if tn (S) = i, then S \u2287 [n \u2212 i, n \u2212 1] and n \u2212 i \u2212 1 \u2208\n/ S. Therefore\neach such S can be expressed as S = T \u222a[n\u2212i, n\u22121] for some T \u2286 [0, n\u2212i\u22122].\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n13\n\nThus\nBn,k (x + 1) =\n\nX \u0012k + 1 \u0013\ni+1\n\ni\u22650\n\n=\n\nX \u0012k + 1 \u0013\ni+1\n\ni\u22650\n\n=\n\nX \u0012k + 1 \u0013\ni\n\ni\u22651\n\nxi\n\nX\n\nx|T | bn\u2212i\u22121,k (T )\n\nT \u2286[0,n\u2212i\u22122]\n\nxi Bn\u2212i\u22121,k (x + 1)\nxi\u22121 Bn\u2212i,k (x + 1)\n\nNow we simply replace x by x \u2212 1, and note that\n\n\u0001\n\nk+1\ni\n\n= 0 for i > k + 1.\n\u0003\n\nThe following corollary also appears in Theorem 1.6.\nCorollary 3.6. We have\n\u0011\nPt\nPk \u0010\nk+1\u0001\ni\u22121 B\n(x\n\u2212\n1)\n(x)\nzt\nB\n(x)\n\u2212\n1\n+\nX\nt\u2212i\nt\ni=1\nt=1\ni\nn\n.\nBn,k (x)z =\n\u0001\nP\nk+1 i\ni\u22121\n1 \u2212 k+1\ni=1\ni z (x \u2212 1)\nn\u22650\n\nProof. Let\n\nI=\n\nX\n\nBn,k (x)z n ,\n\nn\u22650\n\nthen\nI=\n\nk\nX\n\nBn (x)z n +\n\nn=0\n\n=\n\nk\nX\n\n=\n\nn\n\nBn (x)z +\n\n=\n\nn=0\n\n\u0013\nk+1 \u0012\nX X\nk+1\ni\n\nn\u2265k+1 i=1\nn\n\nBn (x)z +\n\nn=0\nk\nX\n\nBn,k (x)z n\n\nn\u2265k+1\n\nn=0\nk\nX\n\nX\n\n\u0013\nk+1 \u0012\nX\nk+1\ni\n\ni=1\n\nBn (x)z n +\n\nk+1 \u0012\nX\ni=1\n\n(x \u2212 1)i\u22121 Bn\u2212i,k (x)z n\n\n(x \u2212 1)i\u22121 z i\n\nX\n\nBn\u2212i,k (x)z n\u2212i\n\nn\u2265k+1\n\n\uf8f6\n\uf8eb\n\u0013\nk\u2212i\nX\nk+1\nBj (x)z j \uf8f8 .\n(x \u2212 1)i\u22121 z i \uf8edI \u2212\ni\nj=0\n\nNext we bring the term containing I over to the left. If we set\nD =1\u2212\n\n\u0013\nk+1 \u0012\nX\nk+1\ni=1\n\ni\n\n(x \u2212 1)i\u22121 z i ,\n\n\f14\n\nM. HYATT\n\nthen\nID =\n\nk\nX\n\nn\n\nBn (x)z \u2212\n\nn=0\n\n=1+\n\n\u0013\nk+1 \u0012\nX\nk+1\ni\n\ni=1\n\nk\nX\n\nBn (x)z n \u2212\n\nn=1\n\n=1+\n\nk\nX\n\nn\n\nBn (x)z \u2212\n\n=1+\n\nBn (x)z \u2212\n\n=1+\n\n\u0013\nk \u0012\nk+1 X\nX\nk+1\ni\n\n\u0013\nk X\nt \u0012\nX\nk+1\ni\n\nt=1 i=1\n\nn=1\nk\nX\n\nBt (x) \u2212\n\nt=1\n\n\u0013\nt \u0012\nX\nk+1\ni\n\ni=1\n\nBj (x)z j\n\n\u0013\nk+1\n(x \u2212 1)i\u22121 Bj (x)z i+j\ni\n\ni=1 t=i\n\nn\n\nk\u2212i\nX\nj=0\n\nk\u2212i \u0012\nk+1 X\nX\ni=1 j=0\n\nn=1\nk\nX\n\n(x \u2212 1)i\u22121 z i\n\n(x \u2212 1)i\u22121 Bt\u2212i (x)z t\n(x \u2212 1)i\u22121 Bt\u2212i (x)z t\ni\u22121\n\n(x \u2212 1)\n\n!\n\nBt\u2212i (x) z t .\n\nAnd now divide by D.\n\n\u0003\n\nIn comparing the recurrence found in our Theorem 1.6 with the recurrence\nfrom Theorem 1.4 from [5], we see that Bn,k (x) satisfies the same recurrence\nas An,k (x), but with different initial conditions. In [5], the authors use\nTheorem 1.4 to obtain an explicit formula for An,k (x) (see Theorem 1.5),\nbut after what they describe as a \"fierce battle\" with these polynomials.\nFortunately for us, a careful check of their proof of Theorem 1.5 shows that\nit depends only on the recurrence and the initial conditions. To be more\nspecific, we re-state Theorem 1.5 in generality as the following Lemma.\nLemma 3.7 ([5, Theorem 2]). Fix k \u2208 N. For 0 \u2264 i \u2264 k, let {Ci,k (x)} be\nany collection of polynomials. For n \u2265 0, define Cn+k+1,k (x) recursively by\n\u0013\nk+1 \u0012\nX\nk+1\n(16)\nCn+k+1,k (x) :=\n(x \u2212 1)i\u22121 Cn+k+1\u2212i,k (x).\ni\ni=1\n\nThen\n\nCn,k (x) =\n\nX\n\n\u03b2k ((k + 1)d)xd ,\n\nd\u22650\n\nwhere\nX\n\nj\n\n\u03b2k (j)u = Ok (u)\n\nj\u22650\n\nwith\n\nOk (u) =\n\nk\nX\nj=0\n\nk+1\n\nCk\u2212j,k (u\n\n\u0012\n\n1 \u2212 uk+1\n1\u2212u\n\nk+1\n\n)(u\n\nj\n\n\u2212 1)\n\n\u0013n\u2212k\n\n,\n\nk \u0012 \u0013\nX\ni\ni=j\n\nj\n\nu\u2212i .\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n15\n\nProof of Theorem 1.7. From Theorem 1.6, Bn,k (x) satisfies the recurrence\n(16) in Lemma 3.7, with initial conditions Bi,k (x) = Bi (x) for 0 \u2264 i \u2264 k.\nThe result follows immediately from this.\n\u0003\nThe polynomial Pk (u) appearing in Theorem 1.5, defined by\nPk (u) =\n\nk\nX\n\nk+1\n\nAk\u2212j (u\n\nk+1\n\n)(u\n\nj\n\n\u2212 1)\n\nk \u0012 \u0013\nX\ni\ni=j\n\nj=0\n\nj\n\nu\u2212i ,\n\nhas symmetric and unimodal coefficients ([5, Theorem 4]). Recall that any\nsequence a0 , a1 , . . . , an is called symmetric if ai = an\u2212i for 0 \u2264 i \u2264 n. A\nsequence is called unimodal if there exists an index 0 \u2264 j \u2264 n such that\na0 \u2264 a1 \u2264 * * * \u2264 aj and aj \u2265 aj+1 \u2265 * * * \u2265 an . We also say that a polynomial has a certain property, such as symmetric or unimodal, if its sequence\nof coefficients has that property. The proof that Pk (u) is symmetric and\nunimodal uses the well known generating function for the type A Eulerian\npolynomials\nX\n1\u2212u\nzn\n= (u\u22121)z\n,\nAn (u)\nn!\ne\n\u2212u\nn\u22650\nwhich goes back to Euler (see [9]).\nWe remark here that the expression Qk (u) appearing in Theorem 1.7,\ndefined by\nQk (u) =\n\nk\nX\nj=0\n\nBk\u2212j (u\n\nk+1\n\n)(u\n\nk+1\n\nj\n\n\u2212 1)\n\nk \u0012 \u0013\nX\ni\ni=j\n\nj\n\nu\u2212i ,\n\ndoes not have symmetric coefficients. However, using MAPLE we have\nchecked that for k \u2264 7, Qk (u) is a unimodal polynomial. We list the sequence\nof coefficients, starting with the constant term, for the first few Qk (u) here:\nk\n0\n1\n2\n3\n4\n\ncoefficients of Qk (u)\n1\n1, 2, 1\n1, 4, 6, 6, 4, 2, 1\n1, 8, 12, 18, 23, 32, 32, 28, 23, 8, 4, 2, 1\n1, 16, 24, 36, 54, 76, 176, 200, 220, 230, 230, 176, 152, 124, 98, 76, 16, 8, 4, 2, 1\n\nConjecture 3.8. For k \u2265 0, Qk (u) is a unimodal polynomial.\nA sequence a0 , a1 , . . . , an is called log-concave if a2i \u2265 ai\u22121 ai+1 for all\n1 \u2264 i \u2264 n \u2212 1. For a sequence with positive coefficients, log-concavity\nimplies unimodality. It is natural to ask if Qk (u) has this stronger property\nof log-concavity. However, we have checked that for 3 \u2264 k \u2264 7, Qk (u) is not\nlog-concave. For example in Q3 (u) we have 232 < 18 * 32, and 82 < 23 * 4.\n\n\f16\n\nM. HYATT\n\n4. Juggling sequences\nSince maxdropA (\u03c0) = bscA (\u03c0) for all permutations \u03c0 \u2208 Sn , we see that\nAn,k is the set of all k-bubble sortable permutations in Sn (i.e. bubbleA k (\u03c0) =\nid for all \u03c0 \u2208 An,k ). In [5], the authors also show that there is a bijective\ncorrespondence between An,k , and certain juggling sequences of period n.\nIn this section, we show that there is bijection between Bn,k and a natural\n2-colored analog of the aforementioned juggling sequences.\nFormally, an n-periodic juggling sequence, T = (t1 , t2 , . . . , tn ), is a sequence of n nonnegative integers such that the values ti + i mod n are all\ndistinct. One can interpret each ti as corresponding to a ball being thrown\nat time i which remains in the air for ti time units. If ti = 0, then no ball\nis thrown at time i. We also think of the pattern defined by T as being\nrepeated indefinitely, so that the juggling sequence is an infinite sequence of\nperiod n. The condition that the values ti +i mod n are distinct guarantees\nthat no two balls will land at the same time. Furthermore, the average of\nthe ti 's, which is an integer, is the number of balls being juggled (see also\n[3], [4], [5], [6], [7]).\nNext we define the state of a juggling sequence (see also [4], [6]). Suppose\nthe juggler, who has been repeating the n-periodic juggling pattern T infinitely many times in the past, stops juggling after the ball corresponding to\ntn is thrown. The balls that are in the air will land at various times, and\nwe record the landing schedule as a binary sequence \u03c3 = (\u03c31 , \u03c32 , ..., \u03c3h ). If\n\u03c3i = 1, then a ball landed i time units after the last ball was thrown. If\n\u03c3i = 0, then no ball landed at that time. So \u03c3i = 1 if and only if there\nis some j \u2208 {1, 2, . . . , n} and some d > 0 such that tj + j = i + dn. Since\nthe tail of the sequence \u03c3 must be all zeros, we let \u03c3 be a finite sequence\nwhere the last entry is the last 1 appearing in \u03c3. The state of a juggling\nsequence is the sequence \u03c3 determined by the landing schedule. There is\na particular state which is called the ground state. If T is an n-periodic\njuggling sequence with k balls being juggled, we say that T has the ground\nk times\nz }| {\nstate if its state is \u03c3 = (1, 1, . . . , 1).\nTheorem 4.1 ([5]). There is a bijection, \u03c6, between permutations in An,k\nand juggling sequences which are n-periodic, juggle k balls, and have the\nground state. Given \u03c0 \u2208 An,k , this map is defined by\n\u03c6(\u03c0) = (t1 , t2 , . . . , tn ), where ti = k \u2212 i + \u03c0(i).\nDefinition 4.2. We now define 2-colored (or signed) juggling sequences.\nSuppose the juggler may initially select k balls to juggle, and there are two\ncolors to choose from for each ball. We encode this as a signed juggling\nsequence T = (t1 , t2 , . . . , tn ) where each ti is now an integer. The sign of ti\nis the color of the ball being thrown at ti , and it remains in the air for |ti |\ntime units. We still do not allow more than one ball to land at the same time,\nso we require that the values |ti | + i mod n are all distinct. Furthermore,\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n17\n\nwe do not allow the juggler to change colors once the juggling has started.\nTherefore, if T has period n, we also require that\n(17)\n\nsgn(ti ) = sgn(tj ), where 1 \u2264 i \u2264 n and j = i + |ti | mod n.\n\nWe will also define |T | = (|t1 |, |t2 |, . . . , |tn |). Thus |T | is a (1-colored) juggling sequence as described above. We define the state of a 2-colored juggling\nsequence T to be the state of |T |, and we say T juggles k balls if |T | juggles\nk balls.\nNow consider the special case when T = (t1 , t2 , . . . , tn ) is a 2-colored (or\n1-colored) juggling sequence, where T has the ground state, juggles k balls,\nand k \u2264 n. The fact that T has the ground state implies that t1 , t2 , . . . , tk\nare all nonzero. Informally, we define the landing permutation of T , which\nwe will denote by \u03c4 , to be the order in which the first k balls thrown will\nland if we stop juggling at time n. More precisely, for ti 6= 0 we define the\nlanding time of i, denoted ltime(i), recursively by\n(\ni + |ti |\nif i + |ti | > n\nltime(i) :=\n.\nltime(i + |ti |) if i + |ti | \u2264 n\nThen\n\u03c4 := ltime(1), ltime(2), . . . , ltime(k).\nFor example, consider the 1-colored juggling sequence T = (4, 6, 3, 0, 2, 3, 3),\nwhich juggles 3 balls, has period 7, and has the ground state. We can visualize T with the following diagram:\n\nThe landing permutation associated to T is \u03c4 = 3, 1, 2. This is because\nfor each i = 1, 2, 3, if we follow the path of the ball thrown at time i, it\n(eventually) lands at time n + \u03c4 (i).\nTheorem 4.3. For k \u2264 n, let Jn,k be the set of 2-colored juggling sequences,\nwhere T \u2208 Jn,k if T is n(k!)-periodic, juggles k balls, has the ground state,\nand |T | is n-periodic. There is a bijection \u03c8 : Bn,k \u2192 Jn,k .\n\n\f18\n\nM. HYATT\n\nProof. First we describe \u03c8, so let \u03c0 \u2208 Bn,k . Recall that |\u03c0| = |\u03c0(1)|, . . . , |\u03c0(n)| \u2208\nSn . Moreover, we have |\u03c0| \u2208 An,k since all drop sizes decrease or stay\nthe same if we remove the signs. Define a 1-colored juggling sequence\nS = (s1 , . . . , sn(k!) ) using the map \u03c6 from Theorem 4.1:\nk! times\n\n}|\n{\nz\nS = \u03c6(|\u03c0|) \u2217 * * * \u2217 \u03c6(|\u03c0|),\n\nwhere \u2217 denotes concatenation. Note that theorem 4.1 guarantees that S\nis a juggling sequence which juggles k balls and has the ground state. We\nconstruct \u03c8(\u03c0) = T = (t1 , . . . , tn(k!) ) by assigning signs to each si for 1 \u2264\ni \u2264 n(k!), so |T | = S. First we set\n(18)\n\nsgn(ti ) = sgn(\u03c0(i)) for 1 \u2264 i \u2264 k.\n\nWe then assign signs recursively by\n(19)\n\nsgn(ti+|ti | ) = sgn(ti ) for k + 1 \u2264 i + ti \u2264 n(k!).\n\nSince |T | = S, it is clear (using Theorem 4.1) that T \u2208 Jn,k if we can\nshow that T satisfies (17). Since T has the ground state, a ball thrown at\ntime i where 1 \u2264 i \u2264 k, lands no sooner than time k + 1, thus (18) is well\ndefined. Since no two balls land at the same, the assignments from (19) are\nalso well defined. Also, the fact that T has the ground state guarantees that\neach nonzero si is assigned a sign. It remains to show that\n(20)\n\nsgn(ti ) = sgn(tj ), where 1 \u2264 i \u2264 n and j = i + |ti | > n.\n\nAgain, the fact that T has the ground state ensures that j \u2264 n + k, therefore\n(20) will be satisfied if we can show that the landing permutation associated\nto T is the identity permutation. Indeed, let \u03c4 \u2208 Sk be the landing permutation associated to \u03c6(|\u03c0|), and let \u03c4 \u2032 be the landing permutation associated\nto T . Since |T | is just k! copies of \u03c6(|\u03c0|), it follows that\n\u03c4 \u2032 (i) = \u03c4 (k!) (i) = i.\nThus \u03c4 \u2032 = id as desired, and \u03c8 is well defined.\nFor example, consider \u03c0 = 4, \u22122, 1, 3 \u2208 B4,2 . Then \u03c6(|\u03c0|) = (5, 2, 0, 1),\nand\nS = (5, 2, 0, 1, 5, 2, 0, 1).\nSince only the first k letters of \u03c0 may be negative, we essentially use the\nfirst k letters of \u03c0 to determine the colors of the balls being juggled. Thus\n\u03c8(\u03c0) = (+5, \u22122, 0, \u22121, \u22125, +2, 0, +1).\nWe can visualize this juggling sequence with the following diagram:\n\n\fDES. POLY. FOR k BUBBLE-SORTABLE PERMUTATIONS OF TYPE B\n\n19\n\nThe inverse map \u03c8 \u22121 is straightforward. Given T \u2208 Jn,k , let\n\u03c3 = \u03c6\u22121 (|t1 |, . . . , |tn |) \u2208 An,k .\nThen\n\u03c8 \u22121 (T ) = sgn(t1 )\u03c3(1), . . . , sgn(tk )\u03c3(k), \u03c3(k + 1), . . . , \u03c3(n).\nSince only the first k letters of \u03c8 \u22121 (T ) may be negative, it follows that\n\u03c8 \u22121 (T ) \u2208 Bn,k . Moreover, it is clear that \u03c8 \u22121 is in fact the inverse of \u03c8.\n\u0003\n5. Acknowledgments\nThanks to Jeff Remmel for useful discussions and comments.\nReferences\n[1] D. Armstrong, The sorting order on a Coxeter group, J. Combin. Theory Ser. A\n116 (2009), no. 8, 1285-1305.\n[2] A. Bj\u00f6rner, F. Brenti, Combinatorics of Coxeter groups, Graduate Texts in Mathematics, 231. Springer, New York, 2005.\n[3] J. Buhler, D. Eisendbud, R. Graham, C. Wright, Juggling drops and descents,\nAmer. Math. Monthly 101 (1994), no. 6, 507-519.\n[4] S. Butler, R. Graham, Enumerating (multiplex) juggling sequences, Ann. Comb. 13\n(2010), no. 4, 413-324.\n[5] F. Chung, A. Claesson, M. Dukes, R. Graham, Descent polynomials for permutation\nwith bounded drop size, European J. Combin. 31 (2010), no. 7, 1853-1867.\n[6] F. Chung, R. Graham, Primitive juggling sequences, Amer. Math. Monthly 115\n(2008), no.3, 185-194.\n[7] R. Ehrenborg, M. Readdy, Juggling and applications to q-analogues, Discrete Math.\n157 (1996), no. 1-3, 107-125.\n[8] F. Hivert, N. M. Thi\u00e9ry, The Hecke group algebra of a Coxeter group and its\nrepresentation theory, J. Algebra 321 (2009), no. 8, 2230-2258.\n[9] D. Knuth, The Art of Computer Programming, Vol. 3 Sorting and Searching,\nsecond edition, Reading, Massachusetts: Addison-Wesley, 1998.\n\n\f20\n\nM. HYATT\n\n[10] N. Reading Clusters, Coxeter-sortable elements and noncrossing partitions, Trans.\nAmer. Math. Soc. 359 (2007), no. 12, 5931-5958.\nDepartment of Mathematics, University of California, San Diego, La Jolla,\nCA 92093\nE-mail address: mdhyatt@math.ucsd.edu\n\n\f"}