{"id": "http://arxiv.org/abs/physics/0409087v2", "guidislink": true, "updated": "2005-01-13T20:50:06Z", "updated_parsed": [2005, 1, 13, 20, 50, 6, 3, 13, 0], "published": "2004-09-17T16:29:32Z", "published_parsed": [2004, 9, 17, 16, 29, 32, 4, 261, 0], "title": "Accurate, efficient and simple forces with Quantum Monte Carlo methods", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0409117%2Cphysics%2F0409150%2Cphysics%2F0409142%2Cphysics%2F0409054%2Cphysics%2F0409003%2Cphysics%2F0409026%2Cphysics%2F0409008%2Cphysics%2F0409114%2Cphysics%2F0409121%2Cphysics%2F0409101%2Cphysics%2F0409032%2Cphysics%2F0409001%2Cphysics%2F0409074%2Cphysics%2F0409143%2Cphysics%2F0409131%2Cphysics%2F0409064%2Cphysics%2F0409103%2Cphysics%2F0409042%2Cphysics%2F0409049%2Cphysics%2F0409045%2Cphysics%2F0409020%2Cphysics%2F0409082%2Cphysics%2F0409104%2Cphysics%2F0409140%2Cphysics%2F0409021%2Cphysics%2F0409146%2Cphysics%2F0409128%2Cphysics%2F0409135%2Cphysics%2F0409111%2Cphysics%2F0409119%2Cphysics%2F0409094%2Cphysics%2F0409063%2Cphysics%2F0409127%2Cphysics%2F0409007%2Cphysics%2F0409092%2Cphysics%2F0409025%2Cphysics%2F0409088%2Cphysics%2F0409115%2Cphysics%2F0409005%2Cphysics%2F0409098%2Cphysics%2F0409016%2Cphysics%2F0409077%2Cphysics%2F0409031%2Cphysics%2F0409087%2Cphysics%2F0409091%2Cphysics%2F0409079%2Cphysics%2F0409112%2Cphysics%2F0409047%2Cphysics%2F0409041%2Cphysics%2F0409154%2Cphysics%2F0409096%2Cphysics%2F0409136%2Cphysics%2F0409081%2Cphysics%2F0409023%2Cphysics%2F0409059%2Cphysics%2F0409043%2Cphysics%2F0409039%2Cphysics%2F0409080%2Cphysics%2F0409093%2Cphysics%2F0409158%2Cphysics%2F0409071%2Cphysics%2F0409056%2Cphysics%2F0409053%2Cphysics%2F0409102%2Cphysics%2F0409002%2Cphysics%2F0409044%2Cphysics%2F0409159%2Cphysics%2F0409024%2Cphysics%2F0409109%2Cphysics%2F0409152%2Cphysics%2F0409106%2Cphysics%2F0409095%2Cphysics%2F0409137%2Cphysics%2F0409153%2Cphysics%2F0409120%2Cphysics%2F0409015%2Cphysics%2F0409099%2Cphysics%2F0409133%2Cphysics%2F0409010%2Cphysics%2F0409123%2Cphysics%2F0409029%2Cphysics%2F0409075%2Cphysics%2F0409011%2Cphysics%2F0409138%2Cphysics%2F0409046%2Cphysics%2F0409051%2Cphysics%2F0409089%2Cphysics%2F0409017%2Cphysics%2F0409090%2Cphysics%2F0409151%2Cphysics%2F0409122%2Cphysics%2F0409116%2Cphysics%2F0409149%2Cphysics%2F0409062%2Cphysics%2F0409134%2Cphysics%2F0409058%2Cphysics%2F0409084%2Cphysics%2F0409100%2Cphysics%2F0409066%2Cphysics%2F0409126%2Cphysics%2F0409072&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Accurate, efficient and simple forces with Quantum Monte Carlo methods"}, "summary": "Computation of ionic forces using quantum Monte Carlo methods has long been a\nchallenge. We introduce a simple procedure, based on known properties of\nphysical electronic densities, to make the variance of the Hellmann-Feynman\nestimator finite. We obtain very accurate geometries for the molecules H$_2$,\nLiH, CH$_4$, NH$_3$, H$_2$O and HF, with a Slater-Jastrow trial wave function.\nHarmonic frequencies for diatomics are also in good agreement with experiment.\nAn antithetical sampling method is also discussed for additional reduction of\nthe variance.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0409117%2Cphysics%2F0409150%2Cphysics%2F0409142%2Cphysics%2F0409054%2Cphysics%2F0409003%2Cphysics%2F0409026%2Cphysics%2F0409008%2Cphysics%2F0409114%2Cphysics%2F0409121%2Cphysics%2F0409101%2Cphysics%2F0409032%2Cphysics%2F0409001%2Cphysics%2F0409074%2Cphysics%2F0409143%2Cphysics%2F0409131%2Cphysics%2F0409064%2Cphysics%2F0409103%2Cphysics%2F0409042%2Cphysics%2F0409049%2Cphysics%2F0409045%2Cphysics%2F0409020%2Cphysics%2F0409082%2Cphysics%2F0409104%2Cphysics%2F0409140%2Cphysics%2F0409021%2Cphysics%2F0409146%2Cphysics%2F0409128%2Cphysics%2F0409135%2Cphysics%2F0409111%2Cphysics%2F0409119%2Cphysics%2F0409094%2Cphysics%2F0409063%2Cphysics%2F0409127%2Cphysics%2F0409007%2Cphysics%2F0409092%2Cphysics%2F0409025%2Cphysics%2F0409088%2Cphysics%2F0409115%2Cphysics%2F0409005%2Cphysics%2F0409098%2Cphysics%2F0409016%2Cphysics%2F0409077%2Cphysics%2F0409031%2Cphysics%2F0409087%2Cphysics%2F0409091%2Cphysics%2F0409079%2Cphysics%2F0409112%2Cphysics%2F0409047%2Cphysics%2F0409041%2Cphysics%2F0409154%2Cphysics%2F0409096%2Cphysics%2F0409136%2Cphysics%2F0409081%2Cphysics%2F0409023%2Cphysics%2F0409059%2Cphysics%2F0409043%2Cphysics%2F0409039%2Cphysics%2F0409080%2Cphysics%2F0409093%2Cphysics%2F0409158%2Cphysics%2F0409071%2Cphysics%2F0409056%2Cphysics%2F0409053%2Cphysics%2F0409102%2Cphysics%2F0409002%2Cphysics%2F0409044%2Cphysics%2F0409159%2Cphysics%2F0409024%2Cphysics%2F0409109%2Cphysics%2F0409152%2Cphysics%2F0409106%2Cphysics%2F0409095%2Cphysics%2F0409137%2Cphysics%2F0409153%2Cphysics%2F0409120%2Cphysics%2F0409015%2Cphysics%2F0409099%2Cphysics%2F0409133%2Cphysics%2F0409010%2Cphysics%2F0409123%2Cphysics%2F0409029%2Cphysics%2F0409075%2Cphysics%2F0409011%2Cphysics%2F0409138%2Cphysics%2F0409046%2Cphysics%2F0409051%2Cphysics%2F0409089%2Cphysics%2F0409017%2Cphysics%2F0409090%2Cphysics%2F0409151%2Cphysics%2F0409122%2Cphysics%2F0409116%2Cphysics%2F0409149%2Cphysics%2F0409062%2Cphysics%2F0409134%2Cphysics%2F0409058%2Cphysics%2F0409084%2Cphysics%2F0409100%2Cphysics%2F0409066%2Cphysics%2F0409126%2Cphysics%2F0409072&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Computation of ionic forces using quantum Monte Carlo methods has long been a\nchallenge. We introduce a simple procedure, based on known properties of\nphysical electronic densities, to make the variance of the Hellmann-Feynman\nestimator finite. We obtain very accurate geometries for the molecules H$_2$,\nLiH, CH$_4$, NH$_3$, H$_2$O and HF, with a Slater-Jastrow trial wave function.\nHarmonic frequencies for diatomics are also in good agreement with experiment.\nAn antithetical sampling method is also discussed for additional reduction of\nthe variance."}, "authors": ["Simone Chiesa", "David Ceperley", "Shiwei Zhang"], "author_detail": {"name": "Shiwei Zhang"}, "author": "Shiwei Zhang", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevLett.94.036404", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/physics/0409087v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/physics/0409087v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "4 pages, 4 figures. Minor changes. Accepted for publication on PRL", "arxiv_primary_category": {"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/physics/0409087v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/physics/0409087v2", "journal_reference": "Phys. Rev. Lett. 94, 036404 (2005)", "doi": "10.1103/PhysRevLett.94.036404", "fulltext": "Accurate, efficient and simple forces with Quantum Monte Carlo methods\nSimone Chiesa\u2217 and D. M. Ceperley\u2020\nDept. of Physics, University of Illinois Urbana-Champaign, Urbana, IL 61801\n\nShiwei Zhang\u2021\nComputation of ionic forces using quantum Monte Carlo methods has long been a challenge. We\nintroduce a simple procedure, based on known properties of physical electronic densities, to make\nthe variance of the Hellmann-Feynman estimator finite. We obtain very accurate geometries for the\nmolecules H2 , LiH, CH4 , NH3 , H2 O and HF, with a Slater-Jastrow trial wave function. Harmonic\nfrequencies for diatomics are also in good agreement with experiment. An antithetical sampling\nmethod is also discussed for additional reduction of the variance.\n\nThe optimization of molecular geometries and crystal structures and ab initio molecular dynamics simulations are among the most significant achievements of single particle theories. These accomplishments were both\npossible thanks to the possibility of readily computing\nforces on the ions within the framework of the BornOppenheimer approximation. The approximate treatment of electron interactions typical of these approaches\ncan, however, lead to quantitatively, and sometimes qualitatively, wrong results. This fact, together with a favorable scaling of the computational cost with respect to\nthe number of particles, has spurred the development of\nstochastic techniques, i.e. quantum Monte Carlo (QMC)\nmethods. Despite the higher accuracy achievable for\nmany physical properties, the lack of an efficient estimator for forces has prevented, until recently[1, 2, 3], the use\nof QMC methods to predict even the simplest molecular\ngeometry. The chief problem is to have a Monte Carlo\n(MC) estimator for the force with sufficiently small variance. For example, in all-electron calculations, a straightforward application of MC sampling of the HellmannFeynman estimator has infinite variance. This can be\neasily seen from the definition of the force. For a nucleus of charge Z at the origin, the force can be written,\ntogether with its variance, as a function of the charge\ndensity \u03c1(r) as\nF=Z\n\nZ\n\nr\ndr\u03c1(r) 3 ;\nr\n\n2\n\n\u03c3 =Z\n\n2\n\nZ\n\ndr\u03c1(r)\n\n1\n\u2212 F 2 . (1)\nr4\n\nSince the electronic density is finite at the origin, the\nvariance integral diverges.\nIn this paper, we propose a modified form for the\nforce estimator which has finite variance. This estimator is then used to calculate forces and predict equilibrium geometry and vibrational frequencies for a set of\nsmall molecules. Without loss of generality we will consider only the z-component of the force on an atom at\n\n0.06\nforce density\n\narXiv:physics/0409087v2 [physics.comp-ph] 13 Jan 2005\n\nDept. of Physics, College of William and Mary, Williamsburg, VA 23187\n\n0.04\n\n0.02\n\n0\n0\n\n1\n0.5\ndistance from H (a.u.)\n\n1.5\n\nFIG. 1: Force density along the z-direction for the H atom in\nLiH. The bond is along the z-axis, with a length of 3.316 Bohr.\nThe continuous black curve is calculated from the HartreeFock orbitals. The dashed line is the estimate of fz using\nthe bare estimator. Circles are obtained in an identical QMC\nsimulation using the antithetic sampling technique outlined\nin the text.\n\nthe origin. In a QMC calculation based in configuration space, thePcharge density is a sum of delta func\u2032\ntions: \u03c1(r) \u221d\nr\u2032 \u03b4(r \u2212 r ), where the sum is over all\nNe electron positions and all MC samples. We consider\nseparately the electrons within a distance R of the atom\nand those outside. The contribution to the force from\ncharges outside, FzO , can be calculated directly with the\nHellmann-Feynman estimator in Eq. (1). The contribution from inside the sphere is responsible for the large\nvariances in the direct estimator. It is convenient to introduce a \"force density\" defined as the force arising from\nelectron charges at a distance r from the origin:\nZ\nfz (r) = Z d\u03a9 \u03c1(r, \u03b8, \u03c6) cos \u03b8\n(2)\nThen the force is given as:\n\n\u2217 Electronic\n\naddress: chiesa@uiuc.edu\naddress: ceperley@uiuc.edu\n\u2021 Electronic address: shiwei@physics.wm.edu\n\u2020 Electronic\n\nFz = FzO +\n\nZ\n\n0\n\nR\n\nfz (r)dr.\n\n(3)\n\n\f2\n\nfez (r) =\n\nM\nX\n\nak r\n\nk\n\n(4)\n\nk=1\n\nand determine the coefficients, ak , by minimizing\nZ R\nh\ni2\n2\ndr rm fz (r) \u2212 fez (r)\n\u03c7 =\n\n(5)\n\n0\n\nm\n\nwhere r is a weight factor used to balance contributions\nfrom different values of r.\nSince the relation between the force and the force density is linear, and the relation between the fitting coefficients and the electronic density is linear, we can directly\nwrite the force as averages over moments of the force density. After some manipulations we arrive at:\n*N\n+\ne\nX\nzi\nO\ng(ri ) 3\nFz = Fz + Z\n,\n(6)\nri\ni=1\nMC\n\nwhere the new estimator function is:\ng(r) = \u03b8(R \u2212 r)\n\nM\nX\n\nck rk+m .\n\n(7)\n\nk=1\n\nThe coefficients ck 's are determined by c = S\u22121 h where\nthe Hilbert matrix S and the residual vector h are\nSkj =\n\nRm+k+j+1\n,\nm+k+j +1\n\nhj =\n\nRj+1\n.\nj+1\n\n(8)\n\n0.053\n\nForce (a.u.)\n\n0.02\n\n0.052\n0.051\n\n0.00\n\n0.02\n0.01\nForce (a.u.)\n\nThe force density is a smooth function of r that tends to 0\nlinearly as r approaches the origin. The force density for\nH in a LiH molecule computed with Hartree-Fock and two\ndifferent QMC estimators is shown in Fig.1. As expected\nthe bare force estimator fluctuates wildly at small r.\nBecause the force density is a smooth function, we can\nrepresent it in the interval (0, R) with a polynomial\n\n0.00\n-0.01\n-0.02\n\n1.10 Req\n\n-0.03\n\n1.05 Req\n\n-0.04\n\n0.95 Req\n\n-0.05\n\n0.90 Req\n\n-1\n\nReq\n\n0\n\n1\n\n2 3 4 5 6 7 8\n-1\nprojection time (Hartree )\n\n-0.02\n\n0.049\n0.048\n\n-0.04\n0.047\n-0.06\n\n1\n\n2\n\n3\n\n0.046\n4\n5\n1\n2\nNumber of basis functions\n\nHydrogen\nimproved\npolynomial\n3\n\n4\n\n5\n\nFIG. 2: Dependence of the VMC force on the expansion basis,\nfor LiH with a bond length of 3.316 Bohr. The fitting radius\nR =0.6 Bohr. The definitions of the basis functions are in\nEq.'s (4) and (9). The forces on H and Li are different because\nof the lack of full optimization of the VMC wave function (see\ntext).\n\n10\n\nFIG. 3: Projection of the force in LiH using forward walking.\nThe points at negative imaginary time give the VMC values.\nValues at 0 are the mixed estimates of the DMC simulation.\n\nNote that for the bare estimator g(r) = \u03b8(R \u2212 r). Because of the restriction on the basis, the variance of the\nnew estimator is finite as long as m > \u22121/2. We have numerically found that the weighting factor m = 2, where\neach volume element is weighted equally, gives the lowest\nvariance estimate of the force.\nTo derive the estimator we have used the fact that\nfz (r) goes linearly at small r. [17] This is the crucial\nproperty that allows to filter out the s-wave component\nof the density responsible for the variance divergence.\nThe original estimator is correct for any arbitrary charge\ndensity while the new filtered one uses physical properties of the charge density to reduce the variance. The\nvariance depends on the fitting radius R and on the basis set size M . As R increases, the size of the basis must\nincrease, which increases the variance. Charge densities\ncorresponding to low energy states must be smooth and\nwe typically find that only 2 or 3 basis functions are\nneeded. The size of the basis can be reduced by using\nmore appropriate basis sets. For example, in all calculations reported below we used the expansion\n\n0.050\nLithium\n\n9\n\nfez (r) = fzSD (r)\n\nM\nX\n\nak r k ,\n\n(9)\n\nk=0\n\nwhere fzSD is the force density of a single determinant\nwave function, which can be readily computed from the\norbitals. The improved basis allows a smaller polynomial set and a reduction of the variance. In Fig. 2 the\ndependence of the bias on the basis set type and size is\nshown for the case of a variational Monte Carlo (VMC)\nsimulation on LiH at a bond length of 3.316 Bohr.\nThe trial wave functions \u03a8T used in all cases were of\nthe Slater-Jastrow form. The orbitals were obtained from\na Hartree-Fock calculation using CRYSTAL98 [4]. The\nelectron-electron and electron-proton Jastrow factors had\nthe form of exp(ar/(1 + br)), with a and b optimized\n\n\f3\nTABLE I: Equilibrium distances in \u00c5. Experimental,\nCCSD(T) and B3LYP values were taken from Ref[6]. The\nCCSD(T) and the B3LYP results were obtained using the ccpVTZ basis set with the exception of LiH where the 6-311G*\nset was used. PBE results [7] were all obtained using the\naug-cc-pVTZ basis set.\n\nH2\nLiH\nCH4\nNH3\nNH3\nH2 O\nH2 O\nHF\n\n(N-H)\n(H-H)\n(O-H)\n(H-H)\n\nQMC\n0.7419(4)\n1.592(4)\n1.091(1)\n1.009(2)\n1.624(2)\n0.959(2)\n1.519(3)\n0.919(1)\n\nExp.\n0.741\n1.596\n1.094\n1.012\n1.624\n0.956\n1.517\n0.918\n\nCCSD(T)\n0.743\n1.618\n1.089\n1.014\n1.616\n0.959\n1.508\n0.917\n\nB3LYP\n0.743\n1.595\n1.088\n1.014\n1.624\n0.961\n1.520\n0.923\n\nPBE\n0.751\n1.606\n1.096\n1.023\n1.634\n0.971\n1.531\n0.932\n\nby minimizing |Eloc \u2212 hEi| [5] over points sampled from\n|\u03a8T |2 . The time step in the diffusion Monte Carlo (DMC)\nsimulations was chosen to give an acceptance ratio of\n98%, a value for which the time step bias on forces was\nwithin the statistical error bars.\nSince the exact density is needed for the HellmannFeynman theorem, forward walking[8] or one of the variational path integral algorithms[9, 10] is needed in order to\nevaluate the force estimator. An example of the convergence of forward walking is shown in Fig. 3. The force as\na function of the forward-walking projection time quickly\nreaches a plateau corresponding to the exact value. In\nthis example, the variational forces are far from correct.\nThis discrepancy results from the lack of full optimization\nof the trial wave function made of localized basis orbitals\nand atom centered Jastrow factors, and can be reduced\nsomewhat by including Pulay terms [2]. In DMC, forward\nwalking eliminates the need for the Pulay corrections.\nThe equilibrium geometries were computed by fitting\nthe QMC forces in the proximity of the equilibrium geometry to a polynomial with the appropriate symmetry.\nFig. 4 shows the force in hydrogen fluoride in a 2% interval around the equilibrium geometry. The equilibrium geometries are reported in Table I together with\nthose given by CCSD(T), DFT using the B3LYP and\nthe PBE functional, and experiments. The differences\nbetween QMC and experimental values are in all cases\nless than 0.4% and closer to the experiment than the\nother techniques. For diatomics it is easy to provide an\nestimate of the harmonic vibrational frequencies starting\nfrom the derivative of the force curve at equilibrium geometry. The QMC frequencies, reported in Table II, are\nin good agreement with the experiment, with errors comparable to that from CCSD(T) and DFT PBE or B3LYP.\nThis suggests that forces computed within our approach\nare accurate also away from the equilibrium and could be\nused in molecular dynamics calculations or to optimize\nmolecular geometries.\nThe only source of systematic error in our calculations\n\nTABLE II: Harmonic frequencies in cm\u22121 . Experimental,\nCCSD(T) and B3LYP values were taken from Ref[6]. The\nCCSD(T) and the B3LYP results were obtained using the ccpVTZ basis set with the exception of LiH where the 6-311G*\nset was used. PBE results [14] were obtained using ad hoc\ngaussian basis sets.\n\nH2\nLiH\nHF\n\nQMC\n4464(18)\n1445(20)\n4032(266)\n\nExp.\n4410\n1369\n4181\n\nCCSD(T)\n4420\n1414\n4085\n\nB3LYP\n4401\n1405\n4138\n\nPBE\n4323\n1380\n4001\n\nthat cannot be simply addressed is the fixed-node error. In fixed-node DMC, the random walk is forbidden to\ncross the nodes of the trial wavefunction in order to prevent the loss of efficiency due to the fermion antisymmetry. If the nodes are accurate, so is the QMC energy and\nelectronic density; hence the force. For incorrect nodes,\nthe energy is an upper bound to the true energy, but such\ncan not be said for the force. It is also not necessarily the\ncase that the forces obtained from Eq. (1) are equal to\nthe gradient of the fixed-node energy[11, 12, 13]: this is\nonly guaranteed in the limit of exact nodal surfaces. The\nhigh quality of the geometries and vibrational frequencies\nsuggests that these errors, at least for the cases treated\nin this paper, are negligible. This is perhaps not surprising, since the electronic density is a 1-electron property,\nwhile the nodal error is a many-body effect.\nWe have also tested another method to further reduce\nthe variance of the Hellmann-Feynman estimator. The\nfiltered estimator performs well on the hydrogen atom\nbut for heavier nuclei the error bar grows and seems to\nscale as Z 3 . In those cases the new method can potentially be very useful, with error bars scaling between Z\nand Z 2 . The method is based on the observation that,\nwhile electrons in the core cause large fluctuations in the\nforce density, they contribute very little to it. A standard approach to reduce the variance of a Monte Carlo\nestimate is the use of antithetic variates[15]: a positive\nfluctuation is paired with a negative fluctuation. Suppose the random walk arrives at a multidimensional electronic configuration R, with p (\u2265 1) electrons inside a\nradius Rav \u2264 R of an atom located at the origin. We obtain an antithetic configuration R\u2032 by reflecting all p core\nelectrons about the origin. We then estimate the force\ncontribution due to the p electrons using both R and R\u2032 ,\nassigning a weight factor of w(R\u2032 ) = |\u03c8(R\u2032 )/\u03c8(R)|2 to\nR\u2032 . Their joint contribution to the estimator in Eq. (6)\n\u2032 P\n)\n\u22123\nwhere the sum runs over the p\nis Z 1\u2212w(R\ni g(ri )zi r\n2\ncore electrons. Since w \u2192 1 as Rav \u2192 0, fluctuations in\nthe core are much reduced.\nWithin VMC this scheme can be implemented exactly,\nleading to a dramatic reduction of the variance as can be\nnoticed from Fig. 1. However this estimator is non-local\nand, in DMC, suffers from the same problems as nonlocal pseudopotentials, making an unbiased implementa-\n\n\f4\n0.03\n\nForce (a.u.)\n\n0.02\n0.01\n0.00\n-0.01\n-0.02\n\n0\n\n1 2 3 4 5 6 7\n-1\nprojection time (Hartree )\n\n0.99\n1\n1.01\nH-F Distance (Req)\n\nFIG. 4: DMC force in hydrogen fluoride. Left panel: evolution of the force over forward-walking time. Right panel:\nfully projected forces as a function of nuclear distance. Req is\nthe experimental equilibrium distance.\n\ntion not straightforward. We postpone further discussion\nof the antithetic method to a future article.\nTwo other approaches have been introduced recently\nfor the computation of forces in QMC. Filippi and Umrigar have computed forces for diatomics by correlating\nrandom walks for interatomic separations a and a\u2032 . In\nDMC the difficulty associated with the nodal error and\nthe branching factor was overcome by neglecting some\ntypes of correlation. The main drawback of a finite difference method is the difficulty of calculating all the components of the force simultaneously; for a system of N\natoms this method would require 3N separate force calculations.\nThe other approach, introduced in Ref. [3], is closer to\nour method. It is based on a \"zero-variance\" version of\n\n[1] C. Filippi and C. J. Umrigar, Phys. Rev. B 61, R16291\n(2000).\n[2] M. Casalegno, M. Mella, and A. M. Rappe, J. Chem.\nPhys. 118, 7193 (2003).\n[3] R. Assaraf and M. Caffarel, J. Chem. Phys. 113, 4028\n(2000).\n[4] V. R. Saunders, R. Dovesi, C. Roetti, M. Causa, N. M.\nHarrison, R. Orlando, and C. M. Zicovich, CRYSTAL98\nUser's Manual, University of Torino (1998).\n[5] D. Bressanini, G. Morosi, and M. Mella, J. Chem. Phys.\n116, 5345 (2002).\n[6] Computational chemistry comparison and bechmark\ndatabase,\nhttp://srdata.nist.gov/cccbdb/ NIST\nStandard Reference Database (2004).\n[7] X. Xu and W. A. Goddard, J. Chem. Phys. 121, 4068\n(2004).\n[8] B. L. Hammond, W. A. Lester, and P. J. Reynolds, Monte\nCarlo Methods in Ab Initio Quantum Chemistry (World\nScientific, 1994).\n\nthe Hellmann-Feynman estimator and can be understood\nin the framework of this paper: one can prove that it\ncorresponds to filtering out the s-wave component of the\ndensity leaving the force density unchanged. The semilocal character of the \"zero-variance\" estimator makes its\nDMC implementation trickier. To overcome this problem\nthere have been attempts[2, 16] to use correction terms\nsimilar in nature to the Pulay terms in single-particle approaches. In practice, this scheme requires extensive optimization and, although promising, it is unclear if it will\nbe viable for more complicated cases. In addition, the\nvalue of the force is very sensitive to small errors[16] in\nthe charge density and the optimization within a stochastic technique is probably not sufficiently stable to eliminate these errors.\nIn conclusion, we have developed a simple method for\ncomputing forces within quantum Monte Carlo and used\nit to find the equilibrium geometries for small polyatomic\nmolecules. This has been the first time that a QMC\ntechnique is used to predict geometries of molecules beyond diatomics. The only overhead in the calculation is\nthe necessity of determining unbiased estimators, which\nrequires the use of either forward-walking or reptation\nMC techniques. The new method leads to very accurate forces despite errors from the fixed-node approximation and from its contribution to the energy derivatives.\nExtension of the method, including the antithetic estimator technique, to heavier atoms and to atoms with\npseudopotentials[18]is under investigation.\nThis material is based upon work supported in part by\nthe U.S Army Research Office under DAAD19-02-1-0176.\nComputational support was provided by the Materials\nComputational Center and the National Center for Supercomputing Applications at the University of Illinois.\nS.Z. acknowledges support from NSF.\n\n[9] D. Ceperley, Rev. Mod. Phys. 67, 279 (1995).\n[10] S. Baroni and S. Moroni, Phys. Rev. Lett. 82, 4745\n(1999).\n[11] F. Schautz and H. J. Flad, J. Chem. Phys. 110, 11700\n(1999).\n[12] F. Schautz and H. J. Flad, J. Chem. Phys. 112, 4421\n(2000).\n[13] K. C. Huang, R. J. Needs, and G. Rajagopal, J. Chem.\nPhys. 112, 4419 (2000).\n[14] D. C. Patton, D. V. Porezag, and M. R. Pederson, Phys.\nRev. B 55, 7454 (1997).\n[15] M. H. Kalos and P. A. Whitlock, Monte Carlo Methods.\nVolume I: Basics (John Wiley & Sons, 1986).\n[16] R. Assaraf and M. Caffarel, J. Chem. Phys. 119, 10536\n(2003).\n[17] The force density fz (r) is proportional to the pz component of the density. A non-zero value as r \u2192 0 would imply a discontinuity of \u03c1 at the origin along the z-direction.\n[18] The filtered estimator can be applied to atoms with non-\n\n\f5\nlocal pseudopotentials, where the density is replaced by\na density matrix and a corresponding force density can\n\nbe defined by summing over partial waves.\n\n\f"}