{"id": "http://arxiv.org/abs/1008.3405v1", "guidislink": true, "updated": "2010-08-19T22:24:51Z", "updated_parsed": [2010, 8, 19, 22, 24, 51, 3, 231, 0], "published": "2010-08-19T22:24:51Z", "published_parsed": [2010, 8, 19, 22, 24, 51, 3, 231, 0], "title": "Duality-based Asymptotic-Preserving method for highly anisotropic\n  diffusion equations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1008.0694%2C1008.2450%2C1008.4892%2C1008.1514%2C1008.5256%2C1008.0352%2C1008.1998%2C1008.3112%2C1008.4570%2C1008.4849%2C1008.1553%2C1008.4497%2C1008.2472%2C1008.3115%2C1008.4948%2C1008.1564%2C1008.0473%2C1008.5365%2C1008.2194%2C1008.1757%2C1008.1801%2C1008.4225%2C1008.0860%2C1008.3323%2C1008.2861%2C1008.3728%2C1008.3827%2C1008.5178%2C1008.4845%2C1008.0748%2C1008.0669%2C1008.2500%2C1008.1537%2C1008.2582%2C1008.0229%2C1008.0240%2C1008.3885%2C1008.0183%2C1008.2552%2C1008.3667%2C1008.2513%2C1008.4930%2C1008.1956%2C1008.1852%2C1008.2504%2C1008.0681%2C1008.3999%2C1008.4136%2C1008.0739%2C1008.0074%2C1008.1337%2C1008.1145%2C1008.4781%2C1008.5175%2C1008.1803%2C1008.4011%2C1008.1013%2C1008.2865%2C1008.3381%2C1008.2289%2C1008.1079%2C1008.4544%2C1008.0277%2C1008.4633%2C1008.4330%2C1008.0717%2C1008.4341%2C1008.2096%2C1008.0008%2C1008.0060%2C1008.1539%2C1008.4828%2C1008.1452%2C1008.3675%2C1008.4578%2C1008.1347%2C1008.4902%2C1008.1567%2C1008.3305%2C1008.2553%2C1008.3760%2C1008.0128%2C1008.3918%2C1008.4620%2C1008.3070%2C1008.4605%2C1008.3532%2C1008.1228%2C1008.1426%2C1008.1797%2C1008.4493%2C1008.1903%2C1008.2044%2C1008.4188%2C1008.0852%2C1008.1008%2C1008.3405%2C1008.0807%2C1008.4220%2C1008.1219%2C1008.2580&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Duality-based Asymptotic-Preserving method for highly anisotropic\n  diffusion equations"}, "summary": "The present paper introduces an efficient and accurate numerical scheme for\nthe solution of a highly anisotropic elliptic equation, the anisotropy\ndirection being given by a variable vector field. This scheme is based on an\nasymptotic preserving reformulation of the original system, permitting an\naccurate resolution independently of the anisotropy strength and without the\nneed of a mesh adapted to this anisotropy. The counterpart of this original\nprocedure is the larger system size, enlarged by adding auxiliary variables and\nLagrange multipliers. This Asymptotic-Preserving method generalizes the method\ninvestigated in a previous paper [arXiv:0903.4984v2] to the case of an\narbitrary anisotropy direction field.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1008.0694%2C1008.2450%2C1008.4892%2C1008.1514%2C1008.5256%2C1008.0352%2C1008.1998%2C1008.3112%2C1008.4570%2C1008.4849%2C1008.1553%2C1008.4497%2C1008.2472%2C1008.3115%2C1008.4948%2C1008.1564%2C1008.0473%2C1008.5365%2C1008.2194%2C1008.1757%2C1008.1801%2C1008.4225%2C1008.0860%2C1008.3323%2C1008.2861%2C1008.3728%2C1008.3827%2C1008.5178%2C1008.4845%2C1008.0748%2C1008.0669%2C1008.2500%2C1008.1537%2C1008.2582%2C1008.0229%2C1008.0240%2C1008.3885%2C1008.0183%2C1008.2552%2C1008.3667%2C1008.2513%2C1008.4930%2C1008.1956%2C1008.1852%2C1008.2504%2C1008.0681%2C1008.3999%2C1008.4136%2C1008.0739%2C1008.0074%2C1008.1337%2C1008.1145%2C1008.4781%2C1008.5175%2C1008.1803%2C1008.4011%2C1008.1013%2C1008.2865%2C1008.3381%2C1008.2289%2C1008.1079%2C1008.4544%2C1008.0277%2C1008.4633%2C1008.4330%2C1008.0717%2C1008.4341%2C1008.2096%2C1008.0008%2C1008.0060%2C1008.1539%2C1008.4828%2C1008.1452%2C1008.3675%2C1008.4578%2C1008.1347%2C1008.4902%2C1008.1567%2C1008.3305%2C1008.2553%2C1008.3760%2C1008.0128%2C1008.3918%2C1008.4620%2C1008.3070%2C1008.4605%2C1008.3532%2C1008.1228%2C1008.1426%2C1008.1797%2C1008.4493%2C1008.1903%2C1008.2044%2C1008.4188%2C1008.0852%2C1008.1008%2C1008.3405%2C1008.0807%2C1008.4220%2C1008.1219%2C1008.2580&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The present paper introduces an efficient and accurate numerical scheme for\nthe solution of a highly anisotropic elliptic equation, the anisotropy\ndirection being given by a variable vector field. This scheme is based on an\nasymptotic preserving reformulation of the original system, permitting an\naccurate resolution independently of the anisotropy strength and without the\nneed of a mesh adapted to this anisotropy. The counterpart of this original\nprocedure is the larger system size, enlarged by adding auxiliary variables and\nLagrange multipliers. This Asymptotic-Preserving method generalizes the method\ninvestigated in a previous paper [arXiv:0903.4984v2] to the case of an\narbitrary anisotropy direction field."}, "authors": ["Pierre Degond", "Fabrice Deluzet", "Alexei Lozinski", "Jacek Narski", "Claudia Negulescu"], "author_detail": {"name": "Claudia Negulescu"}, "author": "Claudia Negulescu", "links": [{"title": "doi", "href": "http://dx.doi.org/10.4310/CMS.2012.v10.n1.a2", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1008.3405v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1008.3405v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1008.3405v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1008.3405v1", "arxiv_comment": null, "journal_reference": "Communications in Mathematical Sciences, 10 (2012), pp. 1-31", "doi": "10.4310/CMS.2012.v10.n1.a2", "fulltext": "DUALITY-BASED ASYMPTOTIC-PRESERVING METHOD FOR HIGHLY\nANISOTROPIC DIFFUSION EQUATIONS\nPIERRE DEGOND\u2020 \u2021 , FABRICE DELUZET\u2020 \u2021 , ALEXEI LOZINSKI\u2020 , JACEK NARSKI\u2020 , AND CLAUDIA\n\narXiv:1008.3405v1 [math.NA] 19 Aug 2010\n\nNEGULESCU\u00a7\nAbstract. The present paper introduces an efficient and accurate numerical scheme for the solution of a highly\nanisotropic elliptic equation, the anisotropy direction being given by a variable vector field. This scheme is based on\nan asymptotic preserving reformulation of the original system, permitting an accurate resolution independently of the\nanisotropy strength and without the need of a mesh adapted to this anisotropy. The counterpart of this original procedure\nis the larger system size, enlarged by adding auxiliary variables and Lagrange multipliers. This Asymptotic-Preserving\nmethod generalizes the method investigated in a previous paper [11] to the case of an arbitrary anisotropy direction field.\n\n1. Introduction\nAnisotropic problems are common in mathematical modeling of physical problems. They occur in\nvarious fields of applications such as flows in porous media [3, 20], semiconductor modeling [29], quasineutral plasma simulations [10], image processing [37, 38], atmospheric or oceanic flows [36] and so on,\nthe list being not exhaustive. The initial motivation for this work is closely related to magnetized plasma\nsimulations such as atmospheric plasma [24, 26], internal fusion plasma [4, 12] or plasma thrusters [1].\nIn this context, the media is structured by the magnetic field, which may be strong in some regions and\nweak in others. Indeed, the gyration of the charged particles around magnetic field lines dominates the\nmotion in the plane perpendicular to magnetic field. This explains the large number of collisions in the\nperpendicular plane while the motion along the field lines is rather undisturbed. As a consequence the\nmobility of particles in different directions differs by many orders of magnitude. This ratio can be as\nhuge as 1010 . On the other hand, when the magnetic field is weak the anisotropy is much smaller. As\nthe regions with weak and strong magnetic field can coexist in the same computational domain, one\nneeds a numerical scheme which gives accurate results for a large range of anisotropy strengths. The\nrelevant boundary conditions in many fields of application are periodic (for instance in simulations of\nthe tokamak plasmas on a torus) or Neumann boundary conditions (atmospheric plasma for example\n[5]). For these reasons we propose a strongly anisotropic model problem for wich we wish to introduce\nan efficient and accurate numerical scheme. This model problem reads\n\uf8f1\n\u2212\u2207 * A\u2207\u03c6\u03b5 = f in \u03a9,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\nn * A\u2207\u03c6\u03b5 = 0\non \u2202\u03a9N ,\n(1.1)\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 \u03c6\u03b5 = 0\non \u2202\u03a9D ,\n\nwhere \u03a9 \u2282 R2 or \u03a9 \u2282 R3 is a bounded domain with boundary \u2202\u03a9 = \u2202\u03a9D \u222a \u2202\u03a9N and outward normal n.\nThe direction of the anisotropy is defined by a vector field B, where we suppose divB = 0 and B 6= 0.\nThe direction of B is given by a vector field b = B/|B|. The anisotropy matrix is then defined as\n1\nA = Ak b \u2297 b + (Id \u2212 b \u2297 b)A\u22a5 (Id \u2212 b \u2297 b)\n\u03b5\n\n(1.2)\n\nand \u2202\u03a9D = {x \u2208 \u2202\u03a9 | b(x) * n = 0}. The scalar field Ak > 0 and the symmetric positive definite matrix\nfield A\u22a5 are of order one while the parameter 0 < \u03b5 < 1 can be very small, provoking thus the high\nanisotropy of the problem. This work extends the results of [11], where the special case of a vector field\nb, aligned with the z-axis, was studied. An extension of this approach is proposed in [6] to handle more\n\u2020 Universit\u00e9\n\nde Toulouse, UPS, INSA, UT1, UTM, Institut de Math\u00e9matiques de Toulouse, F-31062 Toulouse, France\nInstitut de Math\u00e9matiques de Toulouse UMR 5219, F-31062 Toulouse, France\n\u00a7 CMI/LATP, Universit\u00e9 de Provence, 39 rue Fr\u00e9d\u00e9ric Joliot-Curie 13453 Marseille cedex 13\n\u2021 CNRS,\n\n1\n\n\frealistic anisotropy topologies. It relies on the introduction of a curvilinear coordinate system with one\ncoordinate aligned with the anisotropy direction. Adapted coordinates are widely used in the framework\nof plasma simulation (see for instance [4, 14, 31]), coordinate systems being either developped to fit\nparticular magnetic field geometry or plasma equilibrium (Euler potentials [35], toroidal and poloidal\n[18, 23], quasiballooning [15], Hamada [19] and Boozer [7] coordinates). Note that the study of certain\nplasma regions in a tokamak have motivated the use of non-orthogonal coordinates systems [21]. In\ncontrast with all these methods, we propose here a numerical scheme that uses coordinates and meshes\nindependent of the anisotropy direction, like in [33]. This feature offers the capability to easily treat time\nevolving anisotropy directions. This is very important in the context of tokamak plasma simulation,\nthe anisotropy being driven by the magnetic field which is time dependent.\nOne of the difficulties associated with the numerical solution of problem (1.1) lies in the fact that\nthis problem becomes very ill-conditioned for small 0 < \u03b5 \u226a 1. Indeed, replacing \u03b5 by zero yields an\nill-posed problem as it has an infinite number of solutions (any function constant along the b field\nsolves the problem with \u03b5 = 0). In the discrete case the problem translates into a linear system which\nis ill-conditioned, as it mixes the terms of different orders of magnitude for \u03b5 \u226a 1. As a consequence\nthe numerical algorithm for solving this linear system gives unacceptable errors (in the case of direct\nsolvers) or fails to converge in a reasonable time (in the case of iterative methods).\nThis difficulty arises when the boundary conditions supplied to the dominant O(1/\u03b5) operator\nlead to an ill-posed problem. This is the case for Neumann boundary conditions imposed on the part\nof the boundary with b * n 6= 0 as well as for periodic boundary conditions. If instead, the boundary\nconditions are such that the dominant operator gives a well-posed problem, the numerical difficulty\nvanishes. One can resort to standard methods, as the dominant operator is sufficient to determine the\nlimit solution. This is the case for Dirichlet and Robin boundary conditions. The problem addressed\nin this paper arises therefore only with specific boundary conditions. It has however a considerable\nimpact in numerous physical problems concerning plasmas, geophysical flows, plates and shells as an\nexample. In this paper, we will focus on Neumann boundary condition since they represent a larger\nrange of physical applications. The periodic boundary conditions can be addressed in a very similar\nway.\nNumerical methods for anisotropic problems have been extensively studied in the literature. Distinct methods have been developed. Domain decomposition techniques using multiple coarse grid\ncorrections are adapted to the anisotropic equations in [17, 27]. Multigrid methods have been studied\nin [16, 32]. For anisotropy aligned with one or two directions, point or plane smoothers are shown to\nbe very efficient [28]. The hp-finite element method is also known to give good results for singular perturbation problems [30]. All these methods have in common that they try to discretize the anisotropic\nPDE as it is written and then to apply purely numerical tricks to circumvent the problems related to\nlack of accuracy of the discrete solution or to the slow convergence of iterative algorithms. This leads\nto methods which are rather difficult to implement.\nThe approach that we pursue in this paper is entirely different: we reformulate first the original\nPDE in such a way that the resulting problem can be efficiently and accurately discretized by straightforward and easily implementable numerical methods for any anisotropy strength. Our scheme is related\nto the Asymptotic Preserving method introduced in [22]. These techniques are designed to give a precise\nsolution in the various regimes with no restrictions on the computational meshes and with additional\nproperty of converging to the limit solution when \u03b5 \u2192 0. The derivation of the Asymptotic Preserving\nmethod requires identification of the limit model. In the case of Singular Perturbation problems, the\noriginal problem is reformulated in such a way that the obtained set of equations contain both the limit\nmodel and the original problem with a continuous transition between them, according to the values\nof \u03b5. This reformulated system of equation sets the foundation of the AP-scheme. These Asymptotic\nPreserving techniques have been explored in previous studies, for instance quasi-neutral or gyro-fluid\nlimits [9, 12], as well as anisotropic elliptic problems of the form (1.1) with vector b aligned with a\n2\n\n\fcoordinate axis [11, 6].\nIn this paper, we present a new algorithm which extends the results of [11]. The originality of\nthis algorithm consists in the fact, that it is applicable for variable anisotropy directions b, without\nadditional work. The discretization mesh has not to be adapted to the field direction b, but is simply a\nCartesian grid, whose mesh-size is governed by the desired accuracy, independently on the anisotropy\nstrength \u03b5. All this is possible by a well-adapted mathematical framework (optimally chosen spaces,\nintroduction of Lagrange multipliers). The key idea, as in [11], is to decompose the solution \u03c6 into\ntwo parts: a mean part p which is constant along the field lines and the fluctuation part q consisting\nof a correction to the mean part needed to recover the full solution. Both parts p and q are solutions\nto well-posed problems for any \u03b5 > 0. In the limit of \u03b5 \u2192 0 the AP-reformulation reduces to the so\ncalled Limit model (L-model), whose solution is an acceptable approximation of the P-model solution\nfor \u03b5 \u226a 1 (see Theorem 2.2). In [11] the Asymptotic Preserving reformulation of the original problem\nwas obtained in two steps. Firstly, the original problem was integrated along the field lines (z-axis)\nleading to an \u03b5-independent elliptic problem for the mean part p. Secondly, the mean equation was\nsubtracted from the original problem and the \u03b5-dependent elliptic problem for the fluctuating part\nq was obtained. This approach however is not applicable if the field b is arbitrary. In this paper we\npresent a new approach. Instead of integrating the original problem along the arbitrary field lines, we\nchoose to force the mean part p to lie in the Hilbert space of functions constant along the field lines\nand the fluctuating part q to be orthogonal (in L2 sense) to this space. This is done by a Lagrange\nmultiplier technique and requires introduction of additional variables thus enlarging the linear system\nto be solved. This method allows to treat the arbitrary b field case, regardless of the field topology\nand thus eliminates the limitations of the algorithm presented in [11]. We note that an alternative\nmethod, bypassing the need in Lagrange multipliers, is proposed in [8]. It is based on a reformulation\nof the original problem as a fourth order equation.\nThe outline of this paper is the following. Section 2 introduces the original anisotropic elliptic\nproblem. The original problem will be referred to as the Singular-Perturbation model (P-model). The\nmathematical framework is introduced and the Asymptotic Preserving reformulation (AP-model) is\nthen derived. Section 3 is devoted to the numerical implementation of the AP-formulation. Numerical\nresults are presented for 2D and 3D test cases, for constant and variable fields b. Three methods are\ncompared (AP-formulation, P-model and L-model) according to their precision for different values of \u03b5.\nThe rigorous numerical analysis of this new algorithm will be the subject of a forthcoming publication.\n2. Problem definition\nWe consider a two or three dimensional anisotropic problem, given on a sufficiently smooth, bounded\ndomain \u03a9 \u2282 Rd, d = 2,3 with boundary \u2202\u03a9. The direction of the anisotropy is defined by the vector\nfield b \u2208 (C \u221e (\u03a9))d , satisfying |b(x)| = 1 for all x \u2208 \u03a9.\nGiven this vector field b, one can decompose now vectors v \u2208 Rd , gradients \u2207\u03c6, with \u03c6(x) a scalar\nfunction, and divergences \u2207 * v, with v(x) a vector field, into a part parallel to the anisotropy direction\nand a part perpendicular to it. These parts are defined as follows:\nv|| := (v * b)b,\n\nv\u22a5 := (Id \u2212 b \u2297 b)v ,\n\nsuch that v = v|| + v\u22a5 ,\n\n\u2207|| \u03c6 := (b * \u2207\u03c6)b, \u2207\u22a5 \u03c6 := (Id \u2212 b \u2297 b)\u2207\u03c6, such that \u2207\u03c6 = \u2207|| \u03c6 + \u2207\u22a5 \u03c6,\n\u2207|| * v := \u2207 * v|| ,\n\n\u2207\u22a5 * v := \u2207 * v\u22a5 ,\n\n(2.1)\n\nsuch that \u2207 * v = \u2207|| * v + \u2207\u22a5 * v ,\n\nwhere we denoted by \u2297 the vector tensor product. With these notations we can now introduce the\nmathematical problem, the so-called Singular Perturbation problem, whose numerical solution is the\nmain concern of this paper.\n3\n\n\f2.1. The Singular Perturbation problem (P-model) We consider the following Singular\nPerturbation problem\n\uf8f1 1\n\u0001\n\u2212 \u03b5 \u2207k * Ak \u2207k \u03c6\u03b5 \u2212 \u2207\u22a5 * (A\u22a5 \u2207\u22a5 \u03c6\u03b5 ) = f in \u03a9,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n\u0001\non \u2202\u03a9N ,\n(2.2)\n(P ) 1\u03b5 nk * Ak \u2207k \u03c6\u03b5 + n\u22a5 * (A\u22a5 \u2207\u22a5 \u03c6\u03b5 ) = 0\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 \u03b5\n\u03c6 =0\non \u2202\u03a9D ,\nwhere n is the outward normal to \u03a9 and the boundaries are defined by\n\u2202\u03a9D = {x \u2208 \u2202\u03a9 | b(x) * n = 0},\n\n\u2202\u03a9N = \u2202\u03a9 \\ \u2202\u03a9D .\n\n(2.3)\n\nThe parameter 0 < \u03b5 < 1 can be very small and is responsible for the high anisotropy of the problem.\nThe aim is to introduce a numerical scheme, whose computational costs (simulation time and memory),\nfor fixed precision, are independent of \u03b5.\nWe shall assume in the rest of this paper the following hypothesis on the diffusion coefficients and the\nsource terms\n\u25e6\n\nHypothesis A Let f \u2208 L2 (\u03a9) and \u2202\u03a9D 6= \u2205.\nMd\u00d7d (L\u221e (\u03a9)) are supposed to satisfy\n\nThe diffusion coefficients Ak \u2208 L\u221e (\u03a9) and A\u22a5 \u2208\n\n0 < A0 \u2264 Ak (x) \u2264 A1 ,\nA0 ||v||2 \u2264 v t A\u22a5 (x)v \u2264 A1 ||v||2 ,\n\nf.a.a. x \u2208 \u03a9,\n\u2200v \u2208 Rd and f.a.a. x \u2208 \u03a9.\n\n(2.4)\n(2.5)\n\nAs we intend to use the finite element method for the numerical solution of the P-problem, let us put\n(2.2) under variational form. For this let V be the Hilbert space\nV := {\u03c6 \u2208 H 1 (\u03a9) / \u03c6|\u2202\u03a9D = 0},\n\n(\u03c6,\u03c8)V := (\u2207|| \u03c6,\u2207|| \u03c8)L2 + \u03b5(\u2207\u22a5 \u03c6,\u2207\u22a5 \u03c8)L2 .\n\nThus, we are seaking for \u03c6\u03b5 \u2208 V, the solution of\na|| (\u03c6\u03b5 ,\u03c8) + \u03b5a\u22a5 (\u03c6\u03b5 ,\u03c8) = \u03b5(f,\u03c8),\n\n\u2200\u03c8 \u2208 V ,\n\n(2.6)\n\nwhere (*,*) stands for the standard L2 inner product and the continuous bilinear forms a|| : V \u00d7 V \u2192 R\nand a\u22a5 : V \u00d7 V \u2192 R are given by\nZ\nZ\nA|| \u2207|| \u03c6 * \u2207|| \u03c8 dx, a\u22a5 (\u03c6,\u03c8) := (A\u22a5 \u2207\u22a5 \u03c6) * \u2207\u22a5 \u03c8 dx.\na|| (\u03c6,\u03c8) :=\n(2.7)\n\u03a9\n\n\u03a9\n\nThanks to Hypothesis A and the Lax-Milgram theorem, problem (2.2) admits a unique solution \u03c6\u03b5 \u2208 V\nfor all fixed \u03b5 > 0.\n2.2. The Limit problem (L-model)\nThe direct numerical solution of (2.2) may be very\ninaccurate for \u03b5 \u226a 1. Indeed, when \u03b5 tends to zero, the system reduces to\n\uf8f1\n\u0001\n\u2212\u2207k * Ak \u2207k \u03c6 = 0 in \u03a9,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n\u0001\nnk * Ak \u2207k \u03c6 = 0\non \u2202\u03a9N ,\n(2.8)\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n\u03c6=0\non \u2202\u03a9D .\n4\n\n\fThis is an ill-posed problem as it has an infinite number of solutions \u03c6 \u2208 G, where\nG = {\u03c6 \u2208 V | \u2207k \u03c6 = 0},\n\n(2.9)\n\nis the Hilbert space of functions, which are constant along the field lines of b. This shows that the\ncondition number of the system obtained by discretizing (2.2) tends to \u221e as \u03b5 \u2192 0 so that its solution\nwill suffer from round-off errors.\nFor this reason, we should approximate (2.2) in the limit \u03b5 \u2192 0 differently. Supposing that \u03c6\u03b5 \u2192 \u03c60\nas \u03b5 \u2192 0 we identify (at first formally) the problem satisfied by \u03c60 . From the above arguments we know\nthat \u03c60 \u2208 G. Taking now test functions \u03c8 \u2208 G in (2.6), we obtain\nZ\nZ\n(2.10)\nA\u22a5 \u2207\u22a5 \u03c6\u03b5 * \u2207\u22a5 \u03c8 dx = f \u03c8 dx.\n\u03a9\n\n\u03a9\n\nPassing to the limit \u03b5 \u2192 0 into this equation yields the variational formulation of the problem satisfied\nby \u03c60 (Limit problem): find \u03c60 \u2208 G, the solution of\nZ\nZ\n0\n(2.11)\nA\u22a5 \u2207\u22a5 \u03c6 * \u2207\u22a5 \u03c8 dx = f \u03c8 dx , \u2200\u03c8 \u2208 G ,\n(L)\n\u03a9\n\n\u03a9\n\nwhich is a well posed problem. Indeed, the space G \u2282 V is a Hilbert space, associated with the inner\nproduct\n(\u03c6,\u03c8)G := (\u2207\u22a5 \u03c6,\u2207\u22a5 \u03c8)L2 ,\n\n\u2200\u03c6,\u03c8 \u2208 G ,\n\n(2.12)\n\nand the norm || * ||G is equivalent to the H 1 norm. This is due to the Poincar\u00e9 inequality, as\n||\u03c6||2L2 \u2264 C||\u2207\u03c6||2L2 = C||\u2207|| \u03c6||2L2 + C||\u2207\u22a5 \u03c6||2L2 = C||\u2207\u22a5 \u03c6||2L2 ,\n\n\u2200\u03c6 \u2208 G .\n\nHypothesis A and the Lax-Milgram lemma imply the existence and uniqueness of a solution \u03c60 \u2208 G of\nthe Limit problem (2.11).\nRemark 2.1. Let us restrict ourselves for the moment to the simple special case (considered in a previous paper [11]) of the two dimensional domain \u03a9 = (0,Lx) \u00d7 (0,Lz ) in the (x,z) plane with a constant\nb-field aligned with the Z-axis:\n\u0012 \u0013\n0\nb=\n.\n(2.13)\n1\nThe functions in the space G are independent of z so that G can be identified to H01 (0,Lx ). The limit\nproblem (2.11) now reads: Find \u03c60 in H01 (0,Lx ) verifying\nZ\n\n0\n\nLx\n\n0\n\n\u0100\u22a5 (x)\u2202x \u03c6 (x)\u2202x \u03c8(x)dx =\n\nZ\n\nLx\n\n0\n\nf \u0304(x)\u03c8(x)dx,\n\n\u2200\u03c8 \u2208 H01 (0,Lx ),\n\nRL\nRL\nwhere \u0100\u22a5 (x) = (1/Lz ) 0 z A\u22a5,11 (x,z)dz and f \u0304(x) = (1/Lz ) 0 z f (x,z)dz are the mean values of A\u22a5 and\nf along the field lines. The limit solution \u03c60 thus verifies a one-dimensional elliptic equation whose\ncoefficients are integrated along the anisotropy direction:\n\u0010\n\u0011\n\u2212 \u2202x \u0100\u22a5 (x)\u2202x \u03c60 (x) = f \u0304(x) on (0,Lx ),\n(2.14)\n\u03c60 (0) = \u03c60 (Lx ) = 0.\n5\n\n\fWe see now that \u03c60 (x) is a solution to the one dimensional elliptic problem so that it belongs to\nH (0,Lx ) provided f \u2208 L2 (\u03a9). Since \u03c60 as a function of (x,z) does not depend on z, we have also\n\u03c60 \u2208 H 2 (\u03a9). This conclusion (\u03c60 \u2208 H 2 (\u03a9)) remains valid in the case of a cylindrical three dimensional\ndomain \u03a9 = \u03a9xy \u00d7 (0,Lz ) in the (x,y,z) space with any sufficiently smooth \u03a9xy in the (x,y) plane and the\nfield b aligned with the Z-axis, b = (0,0,1)t. Indeed, it is easy to see that \u03c60 = \u03c60 (x,y) solves in this case\nan elliptic two dimensional problem in \u03a9xy similar to (2.14) so that we can apply the standard regularity\nresults for the elliptic problems. These examples show that it is reasonable to suppose \u03c60 \u2208 H 2 (\u03a9) also\nin more general geometries of \u03a9 and b. This can be indeed proved under the hypotheses in Appendix\nA by specifying the (d \u2212 1) dimensional elliptic problem for \u03c60 . The proof being rather lengthy and\ntechnical, we prefer to postpone it to a forthcoming work [13].\n2\n\n2.3. The Asymptotic Preserving approach (AP-model) In this section we introduce the\nAP-formulation, which is a reformulation of the Singular Perturbation problem (2.2), permitting a\n\"continuous\" transition from the (P)-problem (2.2) to the (L)-problem (2.11), as \u03b5 \u2192 0. For this purpose,\neach function is decomposed into its mean part along the anisotropy direction (lying in the subspace G\nof V) and a fluctuating part (cf. [11]) lying in the L2 -orthogonal complement A of G in V, defined by\nA := {\u03c6 \u2208 V |(\u03c6,\u03c8) = 0 , \u2200\u03c8 \u2208 G}.\n\n(2.15)\n\nNote that (*,*) denote here and elsewhere the inner product of L2 (\u03a9).\nIn what follows, we need the following\nHypothesis B The Hilbert-space V admits the decomposition\nV = G \u2295\u22a5 A,\n\n(2.16)\n\nwith G given by (2.9) and A given by (2.15) and where the orthogonality of the direct sum is taken with\nrespect to the L2 -norm. Denoting by P the orthogonal projection on G with respect to the L2 inner\nproduct:\nP : V \u2192 G such that (P \u03c6,\u03c8) = (\u03c6,\u03c8) \u2200\u03c6 \u2208 V, \u03c8 \u2208 G ,\n\n(2.17)\n\nwe shall suppose that this mapping is continuous and that we have the Poincar\u00e9-Wirtinger inequality\n||\u03c6 \u2212 P \u03c6||L2 (\u03a9) \u2264 C||\u2207|| \u03c6||L2 (\u03a9) ,\n\n\u2200\u03c6 \u2208 V .\n\n(2.18)\n\nApplying the projection P to a function \u03c6 is nothing but a weighted average of \u03c6 along the anisotropy\nfield lines of b. The space G is the space of averaged functions (the parallel Gradient of these averaged\nfunctions being equal to zero), whereas the space A is the space of the fluctuations (the Average of the\nfluctuations being equal to zero). Note that the decomposition (2.16) is not self evident and it may in\nfact fail on some \"pathological\" domains \u03a9. Indeed, although one can always define an L2 -orthogonal\nprojection P\u0303 \u03c6 on the space of functions constant along each field line, for any \u03c6 with square-integrable\n\u2207|| \u03c6, one cannot assure in general that P\u0303 \u03c6 belongs to V for \u03c6 \u2208 V since one may lose control of the\nperpendicular part of the gradient of P\u0303 \u03c6. Fortunately however, Hypothesis B is typically satisfied for\nthe domains of practical interest. The interested reader is referred to Appendix A for an example of a set\nof assumptions on \u03a9 and b which entail Hypothesis B and which resume essentially to the requirement\nfor the field b to intersect \u2202\u03a9N in a uniformly non-tangential manner and for the boundary components\n\u2202\u03a9N and \u2202\u03a9D to be sufficiently smooth.\nLet us also define the operator\nQ : V \u2192 A,\n\nQ = I \u2212P .\n6\n\n(2.19)\n\n\fEach function \u03c6 \u2208 V can be decomposed uniquely as \u03c6 = p + q, where p = P \u03c6 \u2208 G and q = Q\u03c6 \u2208 A. Using\nthis decomposition, we reformulate the Singular-Perturbation problem (2.2). Indeed, replacing \u03c6\u03b5 :=\np\u03b5 + q \u03b5 in problem (2.2) and taking test functions \u03b7 \u2208 G and \u03be \u2208 A leads to an asymptotic preserving\nformulation of the original problem: Find (p\u03b5 ,q \u03b5 ) \u2208 G \u00d7 A such that\n(\n\na\u22a5 (p\u03b5 ,\u03b7) + a\u22a5 (q \u03b5 ,\u03b7) = (f,\u03b7)\n\n\u2200\u03b7 \u2208 G,\n\na|| (q \u03b5 ,\u03be) + \u03b5a\u22a5 (q \u03b5 ,\u03be) + \u03b5a\u22a5 (p\u03b5 ,\u03be) = \u03b5(f,\u03be) \u2200\u03be \u2208 A.\n\n(2.20)\n\nContrary to the Singular Perturbation problem (2.2), setting formally \u03b5 = 0 in (2.20) yields the system\n(\n\na\u22a5 (p0 ,\u03b7) + a\u22a5 (q 0 ,\u03b7) = (f,\u03b7),\na|| (q 0 ,\u03be)\n\n= 0,\n\n\u2200\u03b7 \u2208 G\n(2.21)\n\n\u2200\u03be \u2208 A,\n\nwhich has a unique solution (p0 ,q 0 ) \u2208 G \u00d7 A, where p0 is the unique solution of the L-problem (2.11) and\nq 0 \u2261 0. Indeed, taking \u03be = q 0 as test function in the second equation of (2.21) yields \u2207|| q 0 = 0, which\nmeans q 0 \u2208 G. But at the same time, q 0 \u2208 A, so that q 0 \u2208 G \u2229 A = {0}. Setting then q 0 \u2261 0 in the first\nequation of (2.21), shows that p0 is the unique solution of the L-problem.\nTheorem 2.2. For every \u03b5 > 0 the Asymptotic Preserving formulation (2.20), under Hypotheses A\nand B, admits a unique solution (p\u03b5 ,q \u03b5 ) \u2208 G \u00d7 A, where \u03c6\u03b5 := p\u03b5 + q \u03b5 is the unique solution in V of the\nSingular Perturbation model (2.2).\nThese solutions satisfy the bounds\n||\u03c6\u03b5 ||H 1 (\u03a9) \u2264 C||f ||L2 (\u03a9) ,\n\n||q \u03b5 ||H 1 (\u03a9) \u2264 C||f ||L2 (\u03a9) ,\n\n||p\u03b5 ||H 1 (\u03a9) \u2264 C||f ||L2 (\u03a9) ,\n\n(2.22)\n\nwith an \u03b5-independent constant C > 0. Moreover, we have\n\u03c6\u03b5 \u2192 \u03c60 , p\u03b5 \u2192 \u03c60 and\n\nq\u03b5 \u2192 0\n\nin\n\nH 1 (\u03a9) as \u03b5 \u2192 0,\n\n(2.23)\n\nwhere \u03c60 \u2208 G is the unique solution of the Limit model (2.11).\nProof. The existence and uniqueness of a solution for the P-problem as well as L-problem are\nconsequences of the Lax-Milgram theorem. The existence and uniqueness of a solution of (2.20) is then\nimmediate by construction, remarking that the decomposition \u03c6\u03b5 = p\u03b5 + q \u03b5 is unique.\nThe bound ||\u03c6\u03b5 ||H 1 (\u03a9) \u2264 C||f ||L2 (\u03a9) is obtained by a standard elliptic argument. Furthermore, p\u03b5 = P \u03c6\u03b5\nwhere P is the L2 -orthogonal projector on G, which is a bounded operator in V by (1.4). This implies\nthe estimates for p\u03b5 and q \u03b5 in (2.22). Since p\u03b5 \u2208 G and q \u03b5 \u2208 A are bounded, there exist subsequences\np\u03b5n and q \u03b5n that weakly converge for \u03b5n \u2192 0 to some p0 \u2208 G and q 0 \u2208 A. Taking \u03b5 = \u03b5n in (2.20) and\npassing to the limit \u03b5n \u2192 0 we identify (p0 ,q 0 ) with the unique solution of (2.21), i.e. p0 = \u03c60 is the\nunique solution of (2.11) and q 0 \u2261 0. Since the limit does not depend on the choice of the subsequence,\nwe have the weak convergence as \u03b5 \u2192 0, i.e.\np\u03b5 \u21c0\u03b5\u21920 p0\n\nin H 1 (\u03a9),\n\nq \u03b5 \u21c0\u03b5\u21920 0\n\nin H 1 (\u03a9).\n\nWe shall prove now that these convergences are actually strong. Introducing e\u03b5 = p\u03b5 \u2212 p0 , we have\na\u22a5 (e\u03b5 ,\u03b7) + a\u22a5 (q \u03b5 ,\u03b7) = 0, \u2200\u03b7 \u2208 G .\nTaking now \u03b7 = e\u03b5 in this relation and adding it to the second equation in (2.20), where we put \u03be = q \u03b5 /\u03b5,\nyields\n1\na|| (q \u03b5 ,q \u03b5 ) + a\u22a5 (q \u03b5 + e\u03b5 ,q \u03b5 + e\u03b5 ) = (f,q \u03b5 ) \u2212 a\u22a5 (p0 ,q \u03b5 ).\n\u03b5\n7\n\n(2.24)\n\n\fDue to the Poincar\u00e9-Wirtinger equation (2.18), there exist a constant C > 0 such that\n||q||L2 (\u03a9) \u2264 Ca|| (q,q)1/2 ,\n\n\u2200q \u2208 A.\n\n(2.25)\n2\n\n1\na|| (q \u01eb ,q \u01eb ). UsIn combination with a Young inequality this gives (f,q \u03b5 ) \u2264 ||f ||L2 ||q \u03b5 ||L2 \u2264 \u03b5 C2 ||f ||2L2 + 2\u03b5\ning this in the right hand side of (2.24), we arrive at\n\n1\nC2\na|| (q \u03b5 ,q \u03b5 ) + a\u22a5 (q \u03b5 + e\u03b5 ,q \u03b5 + e\u03b5 ) \u2264 \u03b5 ||f ||2L2 \u2212 a\u22a5 (p0 ,q \u03b5 ).\n2\u03b5\n2\nNoting that q \u03b5 + e\u03b5 = \u03c6\u03b5 \u2212 p0 and \u2207k e\u03b5 = 0 we can rewrite this last inequality as\n1\nC2\na|| (\u03c6\u03b5 \u2212 p0 ,\u03c6\u03b5 \u2212 p0 ) + a\u22a5 (\u03c6\u03b5 \u2212 p0 ,\u03c6\u03b5 \u2212 p0 ) \u2264 \u03b5 ||f ||2L2 \u2212 a\u22a5 (p0 ,q \u03b5 ).\n2\u03b5\n2\nSince a\u22a5 (p0 ,q \u03b5 ) \u2192 0 as \u03b5 \u2192 0 (thanks to the weak convergence q \u03b5 \u21c0 0) we observe that \u03c6\u03b5 \u2192 p0 strongly\nin H 1 (\u03a9). Reminding again that p\u03b5 = P \u03c6\u03b5 and P is bounded in the norm of H 1 (\u03a9), we obtain also\np\u03b5 \u2192 P p0 = p0 , which entails q \u03b5 \u2192 0.\nRemark 2.3. Let us return to the simple special case discussed in remark 2.1, i.e. \u03a9 = (0,Lx) \u00d7 (0,Lz )\nand the b-field given by (2.13). Remind that the space G can be identified in this case with the space\nof functions constant along the Z-axis, which means G := {\u03c6 \u2208 V / \u2202z \u03c6 = 0}. The space A is orthogonal\n(with respect to the L2 -norm) to G and thus contains the functions that have zero mean value along\nRL\nthe Z-axis, i.e. A := {\u03c6 \u2208 V / 0 z \u03c6(x,z)dz = 0}. Therefore, for \u03c6\u03b5 = p\u03b5 + q \u03b5 \u2208 V, the function p\u03b5 is the\nmean value of \u03c6\u03b5 in the direction of the field b:\np\u03b5 =\n\n1\nLz\n\nZ\n\nLz\n\n\u03c6\u03b5 dz ,\n\n(2.26)\n\n0\n\nand q \u03b5 is the fluctuating part with zero mean value:\nq \u03b5 = \u03c6\u03b5 \u2212\n\n1\nLz\n\nZ\n\nLz\n\n\u03c6\u03b5 dz.\n\n(2.27)\n\n0\n\nHypothesis B is thus easily verified. The results obtained in this special case were presented in a previous\npaper [11]. In the case of an arbitrary b-field, formula (2.26) is generalized as (1.2) in Appendix A,\nwhere the length element along the b-field line is weighted by the infinitesimal cross-sectional area of\nthe field tube around the considered b-field-line. This formula can be thus interpreted as a consequence\nof the co-area formula. Note that in the special case of a uniform anisotropy direction, the limit\nproblem can easily be formulated as an elliptic problem depending on the only transverse coordinates\n(see equation (2.14)). The size of the problem is thus significantly smaller than that of the initial one.\nThis feature still occurs for non-uniform b-fields as long as adapted coordinates and meshes are used.\nIn our case, aligned and transverse coordinates are not at our disposal and the solution of the limit\nproblem must be searched as a function of the whole set of coordinates.\n2.4. Lagrange multiplier space The objective of this work is the numerical solution of system\n(2.20) and the comparison of the obtained results with those obtained by directly solving the original\nproblem (2.2). In a general case, when the field b is not necessarily constant, the discretization of\nthe subspaces G and A, is not straightforward, as in the simpler case [11]. In order to overcome this\ndifficulty a Lagrange multiplier technique will be used.\n8\n\n\f2.4.1. The A space To avoid the use of the constrained space A, we can remark that A can\nbe characterized as being the orthogonal complement (in the L2 sense) of the G-space. Thus, instead\nof (2.20), the slightly changed system will be solved: find (p\u03b5 ,q \u03b5 ,l\u03b5 ) \u2208 G \u00d7 V \u00d7 G such that\n\uf8f1\na\u22a5 (p\u03b5 ,\u03b7) + a\u22a5 (q \u03b5 ,\u03b7) = (f,\u03b7)\n\u2200\u03b7 \u2208 G,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\na|| (q \u03b5 ,\u03be) + \u03b5a\u22a5 (q \u03b5 ,\u03be) + \u03b5a\u22a5 (p\u03b5 ,\u03be) + (l\u03b5 ,\u03be) = \u03b5(f,\u03be) \u2200\u03be \u2208 V,\n(2.28)\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 (q \u03b5 ,\u03c7) = 0\n\u2200\u03c7 \u2208 G.\n\nThe constraint (q \u03b5 ,\u03c7) = 0, \u2200\u03c7 \u2208 G is forcing the solution q \u03b5 to belong to A, and this property is carried\nover to the limit \u03b5 \u2192 0. We have thus circumvented the difficulty of discretizing A by introducing a\nnew variable and enlarging the linear system.\nProposition 2.4. Problems (2.20) and (2.28) are equivalent. Indeed, (p\u03b5 ,q \u03b5 ) \u2208 G \u00d7 A is the unique\nsolution of (2.20) if and only if (p\u03b5 ,q \u03b5 ,l\u03b5 ) \u2208 G \u00d7 V \u00d7 G with l\u03b5 \u2261 0 is the unique solution of (2.28).\nProof. Let (p\u03b5 ,q \u03b5 ) \u2208 G \u00d7 A be the unique solution of (2.20). Then, it is immediate to show that\n\u03b5 \u03b5\n(p ,q ,0) solves (2.28). Let now (p\u03b5 ,q \u03b5 ,l\u03b5 ) \u2208 G \u00d7 V \u00d7 G be a solution of (2.28). Then, the last equation\nof (2.28) implies that q \u03b5 \u2208 A. Choosing in the second equation as test function \u03be \u2208 G, one gets\n\u03b5a\u22a5 (q \u03b5 ,\u03be) + \u03b5a\u22a5 (p\u03b5 ,\u03be) + (l\u03b5 ,\u03be) = \u03b5(f,\u03be),\n\n\u2200\u03be \u2208 G ,\n\nwhich because of the first equation in (2.28), yields (l\u03b5 ,\u03be) = 0 for all \u03be \u2208 G. Thus l\u03b5 \u2261 0.\n2.4.2. The G space\nIn order to eliminate the problems that arise when dealing with the\ndiscretization of G, the Lagrange multiplier method will again be used. First note that\n\uf8f1Z\n(\n\uf8f2 A \u2207 p * \u2207 \u03bbdx = a (p,\u03bb) = 0, \u2200\u03bb \u2208 L\n\u2207|| p = 0\n|| ||\n||\n||\np\u2208G \u21d4\n\u21d4\n(2.29)\n\u03a9\n\uf8f3\np\u2208V\np\u2208V,\n\nwhere L is a functional space that should be chosen large enough so that one could find for any p \u2208 V a\n\u03bb \u2208 L with \u2207|| \u03bb = \u2207|| p. On the other hand, the space L should be not too large in order to ensure the\nuniqueness of the Lagrange multipliers in the unconstrained system. A space that satisfies these two\nrequirements under some quite general assumptions to be detailed later, can be defined as\nL := {\u03bb \u2208 L2(\u03a9) / \u2207|| \u03bb \u2208 L2 (\u03a9), \u03bb|\u2202\u03a9in = 0},\n\nwith\n\n\u2202\u03a9in := {x \u2208 \u2202\u03a9 / b(x) * n < 0}.\n\n(2.30)\n\nUsing the characterization (2.29) of the constrained space G, we shall now reformulate the system\n(2.28) as follows: Find (p\u03b5 , \u03bb\u03b5 , q \u03b5 , l\u03b5 , \u03bc\u03b5 ) \u2208 V \u00d7 L \u00d7 V \u00d7 V \u00d7 L such that\n\uf8f1\na\u22a5 (p\u03b5 ,\u03b7) + a\u22a5 (q \u03b5 ,\u03b7) + a|| (\u03b7,\u03bb\u03b5 ) = (f,\u03b7) , \u2200\u03b7 \u2208 V ,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\na|| (p\u03b5 ,\u03ba) = 0, \u2200\u03ba \u2208 L,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n(AP ) a|| (q \u03b5 ,\u03be) + \u03b5a\u22a5 (q \u03b5 ,\u03be) + \u03b5a\u22a5 (p\u03b5 ,\u03be) + (l\u03b5 ,\u03be) = \u03b5(f,\u03be) ,\n\uf8f4\n\uf8f4\n\uf8f4 \u03b5\n\uf8f4\n\uf8f4\n(q ,\u03c7) + a|| (\u03c7,\u03bc\u03b5 ) = 0, \u2200\u03c7 \u2208 V ,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\na|| (l\u03b5 ,\u03c4 ) = 0, \u2200\u03c4 \u2208 L.\n\n\u2200\u03be \u2208 V ,\n\n(2.31)\n\nThe advantage of the above formulation, as compared to (2.20), is that we only have to discretize the\nspaces V and L (at the price of the introduction of three additional variables), which is much easier than\nthe discretization of the constrained spaces G and A. More importantly, the dual formulation (2.31)\ndoes not require any change of coordinates to express the fact that p\u03b5 is constant along the b-field lines\n9\n\n\fand that q \u03b5 averages to zero along these lines. Therefore this formulation is particularly well adapted\nto time-dependent b-fields, as it does not require any operation which would have to be reinitiated as\nb evolves. The system (2.31) will be called the Asymptotic-Preserving formulation in the sequel.\nTo analyse this Asymptotic-Preserving formulation, we need the following\nHypothesis B' The trace \u03bb|\u2202\u03a9in is well defined for any \u03bb \u2208 \u1e7c as an element of L2 (\u2202\u03a9in ), with continuous dependence of the trace norm in L2 (\u2202\u03a9in ) on ||\u03bb||\u1e7c . Moreover, the Hilbert space\n\u1e7c = {\u03c6 \u2208 L2(\u03a9) / \u2207|| \u03c6 \u2208 L2 (\u03a9)},\n\n(\u03c6,\u03c8)\u1e7c := (\u03c6,\u03c8) + (\u2207|| \u03c6,\u2207|| \u03c8),\n\n(2.32)\n\nadmits the decomposition\n\u1e7c = G\u0303 \u2295 L,\n\n(2.33)\n\nG\u0303 := {\u03c6 \u2208 \u1e7c / \u2207|| \u03c6 = 0},\n\n(2.34)\n\nwhere G\u0303 is given by\n\nand L\nR is given by (2.30). The spaces G\u0303 and G = G\u0303 \u2229 V are related in the following way: if g \u2208 G\u0303 is such\nthat \u2202\u03a9in \u03b7gd\u03c3 = 0 for all \u03b7 \u2208 G, then g = 0.\n\nThe decomposition (2.33) is quite natural. It tells simply that any function \u03c6 can be decomposed on\neach field line as a sum of a function that vanishes at one given point on this line and a constant (which\nis therefore the value of \u03c6 at this point). Hypothesis B' will be thus normally satisfied in cases of\npractical interest. For example, we prove in Appendix A that the set of assumptions on the domain \u03a9\nand the b-field which can be used to verify Hypothesis B, is also sufficient (but far from necessary) for\nHypothesis B'. We are now able to show the relation between systems (2.28) and (2.31).\nProposition 2.5. Assuming Hypotheses A, B and B', problem (2.31) admits a unique solution\n(p\u03b5 , \u03bb\u03b5 , q \u03b5 , l\u03b5 , \u03bc\u03b5 ) \u2208 V \u00d7 L \u00d7 V \u00d7 V \u00d7 L, where (p\u03b5 ,q \u03b5 ,l\u03b5 ) \u2208 G \u00d7 V \u00d7 G is the unique solution of (2.28).\nThe proof of Proposition 2.5 is based on the following two lemmas\nLemma 2.6. Assume Hypothesis B' and let p \u2208 \u1e7c be such that a|| (p,\u03bb) = 0, \u2200\u03bb \u2208 L. Then p \u2208 G\u0303.\nProof. Take any \u03b7 \u2208 \u1e7c and decompose \u03b7 = \u03bb + g with \u03bb \u2208 L and g \u2208 G\u0303. We have a|| (p,g) = 0, hence\na|| (p,\u03b7) = 0 for all \u03b7 \u2208 \u1e7c. This entails \u2207|| p = 0, hence p \u2208 G\u0303.\nLemma 2.7. Assume Hypothesis B' and let F \u2208 \u1e7c \u2217 be such that F (\u03b7) = 0 for all \u03b7 \u2208 G. Then the problem\nof finding \u03bb \u2208 L such that\na|| (\u03b7,\u03bb) = F (\u03b7),\n\n\u2200\u03b7 \u2208 \u1e7c ,\n\n(2.35)\n\nhas a unique solution.\nProof. Consider the bilinear form b on \u1e7c \u00d7 \u1e7c\nb(u,v) = a||(u,v) +\n\nZ\n\nuvd\u03c3\n\n\u2202\u03a9in\n\nBy Hypothesis B', this is an inner product on \u1e7c. Indeed, if b(u,u) = 0 then u \u2208 G\u0303 \u2229 L so that u = 0.\nRiesz representation theorem implies that the problem of finding \u03bc \u2208 \u1e7c such that\nb(\u03b7,\u03bc) = F (\u03b7),\n\n\u2200\u03b7 \u2208 \u1e7c ,\n\nhas a unique solution. We can now decompose \u03bc = \u03bb + g with \u03bb \u2208 L and g \u2208 G\u0303. This yields\nZ\n\u03b7gd\u03c3 = F (\u03b7), \u2200\u03b7 \u2208 \u1e7c ,\na|| (\u03b7,\u03bb) +\n\u2202\u03a9in\n\n10\n\n\fR\nso that, in particular, \u2202\u03a9in \u03b7gd\u03c3 = 0 for all \u03b7 \u2208 G which implies g = 0. We see now that \u03bb is a solution\nto (2.35). The uniqueness follows easily.\nLet us now prove Proposition 2.5.\nProof of existence in Proposition 2.5. Take (p\u03b5 ,q \u03b5 ,l\u03b5 ) \u2208 G \u00d7 V \u00d7 G as the unique solution of (2.28).\nThen, equations 2,3,5 in (2.31) are immediately satisfied. It remains to choose properly the Lagrange\nmultipliers \u03bb\u03b5 ,\u03bc\u03b5 \u2208 L to satisfy equations 1,4 in (2.31). For this, let us define F1 ,F2 \u2208 \u1e7c \u2217 by\n1\nF1 (\u03b7) := a|| (q \u03b5 ,\u03b7),\n\u03b5\n\nF2 (\u03b7) := \u2212(q \u03b5 ,\u03b7),\n\n\u2200\u03b7 \u2208 \u1e7c .\n\n(2.36)\n\nThese functionals are indeed continuous in the norm of \u1e7c since their definitions do not contain the\nderivatives in directions perpendicular to b. Since F1 (\u03b7) = F2 (\u03b7) = 0 for all \u03b7 \u2208 G, Lemma 2.7 implies\nthe existence of \u03bb\u03b5 \u2208 L and \u03bc\u03b5 \u2208 L, such that\na|| (\u03b7,\u03bb\u03b5 ) = F1 (\u03b7),\n\na|| (\u03c7,\u03bc\u03b5 ) = F2 (\u03c7),\n\n\u2200\u03b7,\u03c7 \u2208 \u1e7c .\n\n(2.37)\n\nTaking \u03b7,\u03c7 \u2208 V \u2282 \u1e7c we observe (cf. the second line in (2.28) where l\u03b5 = 0)\n1\na|| (\u03b7,\u03bb\u03b5 ) = a|| (q \u03b5 ,\u03b7) = (f,\u03b7) \u2212 a\u22a5 (p\u03b5 ,\u03b7) \u2212 a\u22a5 (q \u03b5 ,\u03b7),\n\u03b5\na|| (\u03c7,\u03bc\u03b5 ) = \u2212(q \u03b5 ,\u03c7),\n\n\u2200\u03b7 \u2208 V ,\n\n\u2200\u03c7 \u2208 V ,\n\nwhich coincides with equations 1,4 in (2.31).\nProof of uniqueness in Proposition 2.5. Consider the solution to system (2.31) with f = 0. Lemma\n2.6 implies then that p\u03b5 ,l\u03b5 \u2208 G\u0303 \u2229 V = G and (p\u03b5 ,q \u03b5 ,l\u03b5 ) \u2208 G \u00d7 V \u00d7 G verifies (2.28) with f = 0 so that p\u03b5 =\nq \u03b5 = l\u03b5 = 0 by Proposition 2.4. Equations 1,4 in (2.31) now tell us that \u03bb\u03b5 ,\u03bc\u03b5 \u2208 G\u0303, but G\u0303 \u2229 L = {0}, hence\n\u03bb\u03b5 = \u03bc\u03b5 = 0.\n\u2737\nThe presence of 1/\u03b5 in the formulas (2.36), (2.37) defining \u03bb\u03b5 indicates at a first sight that \u03bb\u03b5 may\ntend to \u221e as \u03b5 \u2192 0 which would be disastrous for an AP numerical method based on (2.31) at very\nsmall \u03b5. Fortunately \u03bb\u03b5 remains bounded uniformly in \u03b5 in the cases of practical interest. It suffices to\nsuppose that the limit solution \u03c60 is in H 2 (\u03a9) which is a reasonable assumption as discussed in Remark\n2.1.\nProposition 2.8. Assume Hypotheses A, B, B' and \u03c60 \u2208 H 2 (\u03a9) where \u03c60 is the solution to (2.11).\nThen \u03bb\u03b5 introduced in (2.31) satisfies\n||\u2207|| \u03bb\u03b5 ||L2 \u2264 C max(||f ||L2 ,||\u03c60 ||H 2 )\n\n(2.38)\n\nwith a constant C independent of \u03b5.\nProof. We will denote all the \u03b5-independent constants by C in this proof. We start from relation\n(2.24) in the proof of Theorem 2.2. Dropping the positive term a\u22a5 (q \u03b5 + e\u03b5 ,q \u03b5 + e\u03b5 ) it can be rewritten\nas\n1\na|| (q \u03b5 ,q \u03b5 ) \u2264 (f,q \u03b5 ) \u2212 a\u22a5 (\u03c60 ,q \u03b5 ).\n\u03b5\nSince \u03c60 \u2208 H 2 (\u03a9) we can integrate by parts in the integral defining a\u22a5 (\u03c60 ,q \u03b5 ):\nZ\n0 \u03b5\n\u2212a\u22a5 (\u03c6 ,q ) = \u2212 A\u22a5 \u2207\u22a5 \u03c60 * \u2207\u22a5 q \u03b5 dx\nZ\nZ\u03a9\nt\n0\n\u03b5\n(Id \u2212 bb )A\u22a5 \u2207\u22a5 \u03c6 * nq d\u03c3 + (\u2207\u22a5 * A\u22a5 \u2207\u22a5 \u03c60 )q \u03b5 dx\n=\u2212\n\u03a9\n\u2202\u03a9N\n\u0001\n\u2264 C||\u03c60 ||H 2 ||q \u03b5 ||L2 (\u2202\u03a9N ) + ||q \u03b5 ||L2 (\u03a9)\n11\n\n\fsince \u2207\u03c60 has a trace on \u2202\u03a9 and its norm in L2 (\u2202\u03a9N ) is bounded by C||\u03c60 ||H 2 . Thus,\n\u0001\n1\nC\n||\u2207|| q \u03b5 ||2L2 \u2264 a|| (q \u03b5 ,q \u03b5 ) \u2264 C||f ||L2 ||q \u03b5 ||L2 (\u03a9) + C||\u03c60 ||H 2 ||q \u03b5 ||L2 (\u2202\u03a9N ) + ||q \u03b5 ||L2 (\u03a9) .\n\u03b5\n\u03b5\n\nBy Poincar\u00e9-Wirtinger inequality (2.18) (note that P q \u03b5 = 0) and by Hypothesis B' we have\nmax(||q \u03b5 ||L2 (\u03a9) ,||q \u03b5 ||L2 (\u2202\u03a9N ) ) \u2264 C||\u2207|| q \u03b5 ||L2\nso that\n1\n||\u2207|| q \u03b5 ||L2 \u2264 C max(||f ||L2 ,||\u03c60 ||H 2 ).\n\u03b5\nThis is the same as (2.38) since \u2207|| \u03bb\u03b5 = 1\u03b5 \u2207|| q \u03b5 according to (2.36) and (2.37).\n\nRemark 2.9. The Limit model (2.11), reformulated using the Lagrange multiplier technique, now\nreads: Find (\u03c60 , \u03bb0 ) \u2208 V \u00d7 L such that\nZ\nZ\n\uf8f1Z\n\uf8f4\n0\n0\n\uf8f4\nf \u03c8 dx \u2200\u03c8 \u2208 V\nA\n\u2207\n\u03c8\n*\n\u2207\n\u03bb\ndx\n=\nA\n\u2207\n\u03c6\n*\n\u2207\n\u03c8\ndx\n+\n\u22a5 \u22a5\n\u22a5\n\uf8f2\n|| ||\n||\n\u03a9\n\u03a9\n(L\u2032 ) Z\u03a9\n(2.39)\n\uf8f4\n0\n\uf8f4\n\uf8f3 A|| \u2207|| \u03c6 * \u2207|| \u03badx = 0\n\u2200\u03ba \u2208 L.\n\u03a9\n\nProblem (2.39) is also well posed assuming Hypotheses A, B, B' and \u03c60 \u2208 H 2 (\u03a9). Indeed, the uniqueness\nof the solution to (2.39) can be proved in exactly the same manner as in the proof of Proposition 2.5\nabove. To prove the existence of a solution, it suffices to take the limit \u03b5 \u2192 0 in the first two lines of\n(2.31). Indeed, we know by Theorem 2.2 that p\u03b5 \u2192 \u03c60 , the solution to (2.11), and q \u03b5 \u2192 0 in H 1 (\u03a9).\nMoreover, the family {\u2207|| \u03bb\u03b5 } is bounded in the norm of L2 (\u03a9) by Proposition 2.8. We can take therefore\na weakly convergence subsequence {\u2207|| \u03bb\u03b5n } and identify its limit with {\u2207|| \u03bb0 } with some \u03bb0 \u2208 L (cf.\nLemma 2.7) to see that (\u03c60 ,\u03bb0 ) \u2208 V \u00d7 L solves (2.39).\n\n3. Numerical method\nThis section concerns the discretization of the Asymptotic Preserving formulation (2.31), based\non a finite element method, and the detailed study of the obtained numerical results. The numerical\nanalysis of the present scheme is investigated in a forthcoming work [13], in particular we are interested\nin the convergence of the scheme, independently of the parameter \u03b5 > 0.\nLet us denote by Vh \u2282 V and Lh \u2282 L the finite dimensional approximation spaces, constructed by\nmeans of appropriate numerical discretizations (see Section 3.1 and Appendix B). We are thus looking\nfor a discrete solution (p\u03b5h , \u03bb\u03b5h , qh\u03b5 , lh\u03b5 , \u03bc\u03b5h ) \u2208 Vh \u00d7 Lh \u00d7 Vh \u00d7 Vh \u00d7 Lh of the following system\n\uf8f1\na (p\u03b5 ,\u03b7) + a\u22a5 (qh\u03b5 ,\u03b7) + a|| (\u03b7,\u03bb\u03b5h ) = (f,\u03b7) , \u2200\u03b7 \u2208 Vh ,\n\uf8f4\n\uf8f4 \u22a5 h\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\na|| (p\u03b5h ,\u03ba) = 0, \u2200\u03ba \u2208 Lh ,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\na|| (qh\u03b5 ,\u03be) + \u03b5a\u22a5 (qh\u03b5 ,\u03be) + \u03b5a\u22a5 (p\u03b5h ,\u03be) + (lh\u03b5 ,\u03be) = \u03b5(f,\u03be) ,\n\uf8f4\n\uf8f4\n\uf8f4 \u03b5\n\uf8f4\n\u03b5\n\uf8f4\n\uf8f4\n\uf8f4 (qh ,\u03c7) + a|| (\u03c7,\u03bch ) = 0, \u2200\u03c7 \u2208 Vh ,\n\uf8f4\n\uf8f4\n\uf8f3\na|| (lh\u03b5 ,\u03c4 ) = 0, \u2200\u03c4 \u2208 Lh .\n\n\u2200\u03be \u2208 Vh ,\n\n(3.1)\n\nOur numerical experiments indicate that the spaces Vh and Lh can be always taken of the same\ntype and on the same mesh. The only difference between these two finite element spaces lies thus in\n12\n\n\fthe incorporation of boundary conditions. In general, let Xh denote the complete finite element space\n(without any restrictions on the boundary) which should be H 1 conforming but otherwise arbitrarily\nchosen. We define then\nVh = {vh \u2208 Xh /vh |\u2202\u03a9D = 0},\n\n(3.2)\n\nLh = {\u03bbh \u2208 Xh /\u03bbh |\u2202\u03a9in \u222a\u2202\u03a9D = 0}.\n\n(3.3)\n\nWhile this choice of Vh is straight forward, the boundary conditions in Lh require special attention.\nIndeed, nothing in the definition (2.30) of space L on the continuous level indicates that its elements\nshould vanish on \u2202\u03a9D . However, this liberty on \u2202\u03a9D is somewhat counter-intuitive. Indeed, the\nLagrange multiplier \u03bb\u03b5 \u2208 L serves to impose \u2207|| p\u03b5 = 0 for some function p\u03b5 taken from the space V. But,\nfor p \u2208 V the trace on \u2202\u03a9D is zero so that \u2207|| p\u03b5 = 0 there without the help of a Lagrange multiplier.\nOf course, this argument is not valid on the continuous level since the trace of functions in L does not\neven necessarily exist. However, this may become very important on the finite element level. Indeed,\nwe provide in Appendix B an example of a finite element setting without incorporating \u03bbh |\u2202\u03a9D = 0 into\nthe definition of Lh , which leads to an ill-posed system (3.1). To avoid this difficulty, we choose Lh as\nin (3.3) in all our experiments, thus obtaining well-posed problems.\n3.1. Discretization Let us present the discretization in a 2D case, the 3D case being a simple\ngeneralization. The here considered computational domain \u03a9 is a square \u03a9 = [0,1] \u00d7 [0,1]. All simulations are performed on structured meshes. Let us introduce the Cartesian, homogeneous grid\nxi = i/Nx , 0 \u2264 i \u2264 Nx ,\n\nyj = j/Ny , 0 \u2264 j \u2264 Ny ,\n\n(3.4)\n\nwhere Nx and Ny are positive even constants, corresponding to the number of discretization intervals\nin the x- resp. y-direction. The corresponding mesh-sizes are denoted by hx > 0 resp. hy > 0. Choosing\na Q2 finite element method (Q2 -FEM), based on the following quadratic base functions\n\uf8f1 (x\u2212x )(x\u2212x )\ni\u22122\ni\u22121\n\uf8f4\nx \u2208 [xi\u22122 ,xi ],\n\uf8f2\n2h2x\n\u2212x)(x\n\u2212x)\n(x\ni+2\ni+1\n\u03b8x i =\nx \u2208 [xi ,xi+2 ], ,\n2h2x\n\uf8f4\n\uf8f3\n0\nelse\n\nfor even i,j and\n(\n\u03b8x i =\n\n(xi+1 \u2212x)(x\u2212xi\u22121 )\nh2x\n\n0\n\nx \u2208 [xi\u22121 ,xi+1 ],\n,\nelse\n\n\uf8f1 (y\u2212yj\u22122 )(y\u2212yj\u22121 )\ny \u2208 [yj\u22122 ,yj ],\n\uf8f4\n\uf8f2\n2h2y\n(y\n\u2212y)(y\n\u2212y)\nj+2\nj+1\n\u03b8y j =\ny \u2208 [yj ,yj+2 ],\n2h2y\n\uf8f4\n\uf8f3\n0\nelse\n\u03b8y j =\n\n(\n\n(yj+1 \u2212y)(y\u2212yj\u22121 )\nh2y\n\n0\n\ny \u2208 [yj\u22121 ,yj+1 ],\nelse\n\n(3.5)\n\n(3.6)\n\nfor odd i,j, we define\nXh := {vh =\n\nX\n\nvij \u03b8xi (x)\u03b8yj (y)},\n\ni,j\n\nWe then search for discrete solutions (p\u03b5h , qh\u03b5 , lh\u03b5 ) \u2208 Vh \u00d7 Vh \u00d7 Vh and (\u03bb\u03b5h , \u03bc\u03b5h ) \u2208 Lh \u00d7 Lh with Vh and Lh\ndefined by (3.2) and (3.3). This leads to the inversion of a linear system, the corresponding matrix\nbeing non-symmetric and given by\n\uf8eb\n\uf8f6\nA1 A0\nA1\n0 0\n\uf8ec A0 0\n0\n0 0 \uf8f7\n\uf8ec\n\uf8f7\n\u03b5A\n0\nA\n+\n\u03b5A\nC\n0 \uf8f7\nA=\uf8ec\n(3.7)\n0\n1\n\uf8ec 1\n\uf8f7.\n\uf8ed 0 0\nC\n0 A0 \uf8f8\n0 0\n0\nA0 0\n13\n\n\f\u03b5\n10\n1\n10\u22121\n10\u22124\n10\u22126\n10\u221210\n10\u221215\n\nAP scheme\nL error\nH 1 error\n\nLimit model\nL error\nH 1 error\n\n2\n\n7.2 \u00d7 10\u22126\n7.3 \u00d7 10\u22127\n1.47 \u00d7 10\u22127\n1.28 \u00d7 10\u22127\n1.28 \u00d7 10\u22127\n1.28 \u00d7 10\u22127\n1.28 \u00d7 10\u22127\n\n2\n\n4.7 \u00d7 10\u22123\n4.7 \u00d7 10\u22124\n9.6 \u00d7 10\u22125\n8.3 \u00d7 10\u22125\n8.3 \u00d7 10\u22125\n8.3 \u00d7 10\u22125\n8.3 \u00d7 10\u22125\n\n5.0 \u00d7 100\n5.0 \u00d7 10\u22121\n5.0 \u00d7 10\u22122\n5.0 \u00d7 10\u22125\n5.2 \u00d7 10\u22127\n1.28 \u00d7 10\u22127\n1.28 \u00d7 10\u22127\n\n3.51 \u00d7 101\n3.51 \u00d7 100\n3.51 \u00d7 10\u22121\n3.61 \u00d7 10\u22124\n8.4 \u00d7 10\u22125\n8.3 \u00d7 10\u22125\n8.3 \u00d7 10\u22125\n\nSingular Perturbation scheme\nL2 error\nH 1 error\n7.2 \u00d7 10\u22126\n7.3 \u00d7 10\u22127\n1.45 \u00d7 10\u22127\n1.26 \u00d7 10\u22127\n5.9 \u00d7 10\u22127\n9.9 \u00d7 10\u22123\n7.1 \u00d7 10\u22121\n\n4.7 \u00d7 10\u22123\n4.7 \u00d7 10\u22124\n9.4 \u00d7 10\u22125\n8.2 \u00d7 10\u22125\n8.2 \u00d7 10\u22125\n3.12 \u00d7 10\u22122\n2.23 \u00d7 100\n\nTable 3.1 \u2013 Comparison between the Asymptotic Preserving scheme, the Limit model and the\nSingular Perturbation model for h = 0.005 (200 mesh points in each direction) and constant b:\nabsolute L2 -error and H 1 -error, for different \u03b5-values.\n\nThe sub-matrices A0 , A1 resp. C correspond to the bilinear forms a|| (*,*), a\u22a5 (*,*) resp. (*,*), used in\nequations (2.31) and belong to R(Nx +1)(Ny +1)\u00d7(Nx +1)(Ny +1) . The matrix elements are computed using\nthe 2D Gauss quadrature formula, with 3 points in the x and y direction:\nZ\n\n1\n\nq\n\n3\n5,\n\nZ\n\n1\n\n\u22121 \u22121\n\nwhere x0 = y0 = 0, x\u00b11 = y\u00b11 = \u00b1\n5.\n\nf (x,y) =\n\n1\nX\n\n\u03c9i \u03c9j f (xi ,yj ),\n\n(3.8)\n\ni,j=\u22121\n\n\u03c90 = 8/9 and \u03c9\u00b11 = 5/9, which is exact for polynomials of degree\n\n3.2. Numerical Results\n3.2.1. 2D test case, uniform and aligned b-field In this section we compare the numerical\nresults obtained via the Q2 -FEM, by discretizing the Singular Perturbation model (2.2), the Limit model\n(2.11) and the Asymptotic Preserving reformulation (2.31). In all numerical tests we set A\u22a5 = Id and\nAk = 1. We start with a simple test case, where the analytical solution is known. Let the source term\nf be given by\nf = (4 + \u03b5)\u03c0 2 cos(2\u03c0x)sin(\u03c0y) + \u03c0 2 sin(\u03c0y)\n\n(3.9)\n\nand the b field be aligned with the x-axis. Hence, the solution \u03c6\u03b5 of (2.2) and its decomposition\n\u03c6\u03b5 = p\u03b5 + q \u03b5 write\n\u03c6\u03b5 = sin(\u03c0y) + \u03b5cos(2\u03c0x)sin(\u03c0y),\np\u03b5 = sin(\u03c0y) , q \u03b5 = \u03b5cos(2\u03c0x)sin(\u03c0y).\n\n(3.10)\n(3.11)\n\nWe denote by \u03c6P , \u03c6L , \u03c6A the numerical solution of the Singular Perturbation model (2.2), the\nLimit model (2.11) and the Asymptotic Preserving reformulation (2.31) respectively. The comparison\nwill be done in the L2 -norm as well as the H 1 -norm. The linear systems obtained after discretization\nof the three methods are solved using the same numerical algorithm - LU decomposition implemented\nin a solver MUMPS[2].\nIn Figure 3.1 we plotted the absolute errors (in the L2 resp. H 1 -norms) between the numerical\nsolutions obtained with one of the three methods and the exact solution, and this, as a function of\n14\n\n\f10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n0.01\n0.0001\n0.001\n1e-05\n\n0.0001\n\n1e-06\n\n1e-07\n\n1e-05\n1e-15\n\n(a)\n\nL2\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n(b) H 1 error for a grid with 50 \u00d7 50 points.\n\nerror for a grid with 50 \u00d7 50 points.\n\n10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n0.01\n0.0001\n0.001\n1e-05\n\n0.0001\n\n1e-06\n\n1e-07\n\n1e-05\n1e-15\n\n(c)\n\nL2\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n(d) H 1 error for a grid with 100 \u00d7 100 points.\n\nerror for a grid with 100 \u00d7 100 points.\n\n10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n0.01\n0.0001\n0.001\n1e-05\n\n0.0001\n\n1e-06\n\n1e-07\n\n1e-05\n1e-15\n\n(e)\n\nL2\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n(f) H 1 error for a grid with 200 \u00d7 200 points.\n\nerror for a grid with 200 \u00d7 200 points.\n\nFigure 3.1 \u2013 Absolute L2 (left column) and H 1 (right column) errors between the exact solution\n\u03c6\u03b5 and the computed numerical solution \u03c6A (AP), \u03c6L (L), \u03c6P (P) for the test case with constant\nb. The error is plotted as a function of the parameter \u03b5 and for three different mesh-sizes.\n\nthe parameter \u03b5 and for several mesh-sizes. In Table 3.1, we specified the error values for one fixed\ngrid and several \u03b5-values. One observes that the Singular Perturbation finite element approximation\nis accurate only for \u03b5 bigger than some critical value \u03b5P , the Limit model gives reliable results for \u03b5\n15\n\n\fmethod\n\n# rows\n\n# non zero\n\ntime\n\nL2 -error\n\nH 1 -error\n\nAP\nL\nP\n\n50 \u00d7 103\n20 \u00d7 103\n10 \u00d7 103\n\n1563 \u00d7 103\n469 \u00d7 103\n157 \u00d7 103\n\n13.212 s\n5.227 s\n3.707 s\n\n1.02 \u00d7 10\u22126\n1.14 \u00d7 10\u22126\n1.02 \u00d7 10\u22126\n\n3.34 \u00d7 10\u22124\n3.34 \u00d7 10\u22124\n3.27 \u00d7 10\u22124\n\nTable 3.2 \u2013 Comparison between the Asymptotic Preserving scheme (AP), the Limit model (L)\nand the Singular Perturbation model (P) for h = 0.01 (100 mesh points in each direction) and\nfixed \u03b5 = 10\u22126 : matrix size, number of nonzero elements, average computational time and error\nin L2 and H 1 norms.\n\nsmaller than \u03b5L , whereas the AP-scheme is accurate independently on \u03b5. The order of convergence for\nall three methods is three in the L2 -norm and two in the H 1 -norm, which is an optimal result for Q2\nfinite elements. When designing a robust numerical method one has therefore two options. The first\none is to use an Asymptotic Preserving scheme, which is accurate independently on \u03b5, but requires the\nsolution of a bigger linear system. The second one is to design a coupling strategy that involves the\nsolution of the Singular Perturbation formulation and the Limit problem in their respective validity\ndomains. This is however a very delicate problem, since we observe that the critical values \u03b5P and \u03b5L\nare mesh dependent, namely \u03b5P inversely proportional to h and \u03b5L proportional to h. Therefore for\nsmall meshes there may exist a range of \u03b5-values, where neither the Singular Perturbation nor the Limit\nmodel finite element approximation give accurate results. For our test case, this is even the case for\nmeshes as big as 200 \u00d7 200 points, if one regards the L2 -norm. This mesh-size is generally insufficient\nin the case of real physical applications.\nAnother interesting aspect with respect to which the three methods must be compared, is the\ncomputational time and the size of the matrices involved in the linear systems. Table 3.2 shows that\nthe Asymptotic Preserving scheme is expensive in computational time and memory requirements, as\ncompared to the other methods. Indeed, the computational time required to solve the problem is almost\nfour times bigger than that of the Singular Perturbation scheme. Moreover, the Asymptotic Preserving\nmethod involves matrices that have five times more rows and ten times more nonzero elements than\nthe matrices obtained with the Singular Perturbation approximation. It is however the only scheme\nthat provides the h-convergence regardless of \u03b5. In order to reduce the computational costs, a coupling\nstrategy for problems with variable \u03b5 will be proposed in a forthcoming paper. In sub-domains where\n\u03b5 > \u03b5P the Singular Perturbation problem will be solved, in sub-domains where \u03b5 < \u03b5L the Limit problem\nwill be solved and only in the remaining part, where neither the Limit nor the Singular Perturbation\nmodel are valid, the Asymptotic Preserving formulation will be solved.\n3.2.2. 2D test case, non-uniform and non-aligned b-field We now focus our attention on\nthe original feature of the here introduced numerical method, namely its ability to treat nonuniform b\nfields. In this section we present numerical simulations performed for a variable field b.\nFirst, let us construct a numerical test case. Finding an analytical solution for an arbitrary b\npresents a considerable difficulty. We have therefore chosen a different approach. First, we choose a\nlimit solution\n\u0001\n\u03c60 = sin \u03c0y + \u03b1(y 2 \u2212 y)cos(\u03c0x) ,\n\n(3.12)\n\nwhere \u03b1 is a numerical constant aimed at controlling the variations of b. For \u03b1 = 0, the limit solution\nof the previous section is obtained. The limit solution for \u03b1 = 2 is shown in Figure 3.2. We set \u03b1 = 2\nin what follows. Since \u03c60 is a limit solution, it is constant along the b field lines. Therefore we can\n16\n\n\fFigure 3.2 \u2013 The limit solution for the test case with variable b.\n\ndetermine the b field using the following implication\n\u2207k \u03c60 = 0\n\n\u21d2\n\nbx\n\n\u2202\u03c60\n\u2202\u03c60\n+ by\n= 0,\n\u2202x\n\u2202y\n\n(3.13)\n\nwhich yields for example\nB\n,\nb=\n|B|\n\nB=\n\n\u0012\n\n\u03b1(2y \u2212 1)cos(\u03c0x) + \u03c0\n\u03c0\u03b1(y 2 \u2212 y)sin(\u03c0x)\n\n\u0013\n\n.\n\n(3.14)\n\nNote that the field B, constructed in this way, satisfies divB = 0, which is an important property in the\nframework of plasma simulation. Furthermore, we have B 6= 0 in the computational domain. Now, we\nchoose \u03c6\u03b5 to be a function that converges, as \u03b5 \u2192 0, to the limit solution \u03c60 :\n\u0001\n\u03c6\u03b5 = sin \u03c0y + \u03b1(y 2 \u2212 y)cos(\u03c0x) + \u03b5cos(2\u03c0x)sin(\u03c0y).\n(3.15)\nFinally, the force term is calculated, using the equation, i.e.\n\n1\nf = \u2212\u2207\u22a5 * (A\u22a5 \u2207\u22a5 \u03c6\u03b5 ) \u2212 \u2207k * (Ak \u2207k \u03c6\u03b5 ).\n\u03b5\nAs in the previous section, we shall compare here the numerical solution of the Singular Perturbation\nmodel (2.2), the Limit model (2.11) and the Asymptotic Preserving reformulation (2.31), i.e. \u03c6P , \u03c6L ,\n\u03c6A with the exact solution (3.15) . The L2 and H 1 -errors are reported on Figure 3.3 and Table 3.3.\nOnce again the Asymptotic Preserving scheme proves to be valid for all values of \u03b5, contrary to the\nother schemes. There is however a difference compared to the constant-b case. For a variable b , the\nthreshold value \u03b5P seems to be independent on the mesh size and is much larger than that of the\nuniform b test case. This observation limits further the possible choice of coupling strategies, since\neven for coarse meshes there exists a range of \u03b5-values, where neither the Singular Perturbation nor the\nLimit model are valid. The coupling strategy, involving all three models, remains however interesting\nto investigate.\n17\n\n\fAP scheme\nL error\nH 1 error\n\n\u03b5\n\n2\n\n7.2 \u00d7 10\u22126\n7.1 \u00d7 10\u22127\n2.05 \u00d7 10\u22127\n2.12 \u00d7 10\u22127\n2.17 \u00d7 10\u22127\n2.17 \u00d7 10\u22127\n2.17 \u00d7 10\u22127\n\n10\n1\n10\u22122\n10\u22124\n10\u22127\n10\u221210\n10\u221215\n\n4.6 \u00d7 10\u22123\n4.6 \u00d7 10\u22124\n1.33 \u00d7 10\u22124\n1.38 \u00d7 10\u22124\n1.41 \u00d7 10\u22124\n1.41 \u00d7 10\u22124\n1.41 \u00d7 10\u22124\n\nLimit model\nL error\nH 1 error\n2\n\n5.0 \u00d7 100\n5.0 \u00d7 10\u22121\n5.0 \u00d7 10\u22123\n5.0 \u00d7 10\u22125\n2.22 \u00d7 10\u22127\n2.17 \u00d7 10\u22127\n2.17 \u00d7 10\u22127\n\n3.50 \u00d7 101\n3.50 \u00d7 100\n3.50 \u00d7 10\u22122\n3.77 \u00d7 10\u22124\n1.41 \u00d7 10\u22124\n1.41 \u00d7 10\u22124\n1.41 \u00d7 10\u22124\n\nSingular Perturbation scheme\nL2 error\nH 1 error\n7.2 \u00d7 10\u22126\n7.1 \u00d7 10\u22127\n2.05 \u00d7 10\u22127\n1.74 \u00d7 10\u22126\n1.68 \u00d7 10\u22123\n3.93 \u00d7 10\u22121\n6.7 \u00d7 10\u22121\n\n4.6 \u00d7 10\u22123\n4.6 \u00d7 10\u22124\n1.33 \u00d7 10\u22124\n1.43 \u00d7 10\u22124\n1.26 \u00d7 10\u22122\n1.35 \u00d7 100\n2.32 \u00d7 100\n\nTable 3.3 \u2013 Comparison between the Asymptotic preserving scheme, the Limit model and the\nSingular Perturbation model for h = 0.005 (200 mesh points in each direction) and variable b:\nabsolute L2 -error and H 1 -error.\n\nIn the next test case we investigate the influence of the variations of the b field on the accuracy of\nthe solution. We would like to answer the following question: what is the minimal number of points per\ncharacteristic length of b variations required to obtain an acceptable solution. For this, let us modify\nthe previous test case. Let b = B/|B|, with\n\u0012\n\u0013\n\u03b1(2y \u2212 1)cos(m\u03c0x) + \u03c0\nB=\n,\n(3.16)\nm\u03c0\u03b1(y 2 \u2212 y)sin(m\u03c0x)\nm being an integer. The limit solution and \u03c6\u03b5 are chosen to be\n\n\u0001\n\u03c60 = sin \u03c0y + \u03b1(y 2 \u2212 y)cos(m\u03c0x) ,\n\u0001\n\u03c6\u03b5 = sin \u03c0y + \u03b1(y 2 \u2212 y)cos(m\u03c0x) + \u03b5cos(2\u03c0x)sin(\u03c0y).\n\n(3.17)\n(3.18)\n\nWe perform two tests: first, we fix the mesh size and vary m to find the minimal period of b for which\nthe Asymptotic Preserving method yields still acceptable results. We define a result to be acceptable\nwhen the relative error is less then 0.01. In the second test m remains fixed and the convergence of the\nscheme is studied. The results are presented on Figures 3.4 and 3.5.\nFor \u03b5 = 1 and 400 mesh points in each direction (h = 0.0025) the relative error in the L2 -norm,\ndefined as\n\u03b5\n\n||\u03c6\u03b5 \u2212\u03c6A ||L2 (\u03a9)\n||\u03c6A ||L2 (\u03a9) ,\n\nis below 0.01 for all tested values of 1 \u2264 m \u2264 50. The relative H 1 -error\n\n||\u03c6 \u2212\u03c6A ||H 1 (\u03a9)\n||\u03c6A ||H 1 (\u03a9)\n\nexceeds the critical value for m > 25. For \u03b5 = 10\u221220 the maximal m for which the error is acceptable in both norms is 20. The minimal number of mesh points per period of b variations is\n40 in the worst case, in order to obtain an 1% relative error.\nFigure 3.5 and Table 3.4 show the convergence of the Asymptotic Preserving scheme with respect\nto h for m = 10 and \u03b5 = 10\u221210. We observe that for big values of h the error does not diminish with h.\nThen, for h < 0.025 the scheme converges at a better rate then 2 for H 1 -error and 3 for L2 -error. For\nh < 0.00625 (160 points) the optimal convergence rate in the H 1 -norm is obtained (which is 32 mesh\npoints per period of b). The method is super-convergent in the whole tested range for the L2 -error.\nThese results are reassuring, as they prove that the Asymptotic Preserving scheme is precise even\nfor strongly varying fields for relatively small mesh sizes, which was not evident. Indeed, the optimal\nconvergence rate in the H 1 -norm is obtained for 32 mesh points per b period, and an 1% relative error\nfor 40 points. It shows that accurate results can be obtained in more complex simulations, such as\ntokamak plasma for example. The application of the method to bigger scale problems is the subject of\nan ongoing work.\n18\n\n\f10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n0.01\n0.0001\n0.001\n1e-05\n\n0.0001\n\n1e-06\n\n1e-07\n\n1e-05\n1e-15\n\n(a)\n\nL2\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n(b) H 1 error for a grid with 50 \u00d7 50 points.\n\nerror for a grid with 50 \u00d7 50 points.\n\n10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n0.01\n0.0001\n0.001\n1e-05\n\n0.0001\n\n1e-06\n\n1e-07\n\n1e-05\n1e-15\n\n(c)\n\nL2\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n(d) H 1 error for a grid with 100 \u00d7 100 points.\n\nerror for a grid with 100 \u00d7 100 points.\n\n10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n0.01\n0.0001\n0.001\n1e-05\n\n0.0001\n\n1e-06\n\n1e-07\n\n1e-05\n1e-15\n\n(e)\n\nL2\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n(f) H 1 error for a grid with 200 \u00d7 200 points.\n\nerror for a grid with 200 \u00d7 200 points.\n\nFigure 3.3 \u2013 Absolute L2 (left column) and H 1 (right column) errors between the exact solution\n\u03c6\u03b5 and the computed solution \u03c6A (AP), \u03c6L (L), \u03c6P (P) for the test case with variable b. Plotted\nare the errors as a function of the small parameter \u03b5, for three different meshes.\n\n19\n\n\f1\n\n1\nL2 error\nH1 error\n\nL2 error\nH1 error\n\n0.1\n\n0.1\n\n0.01\n\n0.01\n\n0.001\n\n0.001\n\n0.0001\n\n0.0001\n\n1e-05\n\n1e-05\n\n1e-06\n\n1e-06\n\n1e-07\n\n1e-07\n\n1e-08\n\n1e-08\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\n50\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\n50\n\n(b) \u03b5 = 10\u221220\n\n(a) \u03b5 = 1\n\nFigure 3.4 \u2013 Relative L2 and H 1 errors between the exact solution \u03c6\u03b5 and the computed solution\n\u03c6A (AP) for h = 0.0025 (400 points in each direction) as a function of m and for \u03b5 = 1 respectively\n10\u221220 .\n\n10\nL2 error\nH1 error\n1\n\n0.1\n\n0.01\n\n0.001\n\n0.0001\n\n1e-05\n\n1e-06\n0.001\n\n0.01\n\n0.1\n\nFigure 3.5 \u2013 Relative L2 and H 1 errors between the exact solution \u03c6\u03b5 and the computed solution\n\u03c6A (AP) for m = 10 and \u03b5 = 10\u221210 as a function of h.\n\n3.2.3. 3D test case, uniform and aligned b-field\n3D test case. Let the field b be aligned with the X-axis:\n\uf8eb \uf8f6\n1\nb = \uf8ed 0 \uf8f8.\n0\n\nFinally, we test our method on a simple\n\n(3.19)\n\nLet \u03a9 = [0,1] \u00d7 [0,1] \u00d7 [0,1], and the source term f is such that the solution is given by\n\u03c6\u03b5 = sin(\u03c0y)sin(\u03c0z) + \u03b5cos(2\u03c0x)sin(\u03c0y)sin(\u03c0z),\np\u03b5 = sin(\u03c0y)sin(\u03c0z) , q \u03b5 = \u03b5cos(2\u03c0x)sin(\u03c0y)sin(\u03c0z).\n\n(3.20)\n(3.21)\n\nNumerical simulations were performed on a 30 \u00d7 30 \u00d7 30 grid. Once again all three methods are compared. The L2 and H 1 -errors are given on Figure 3.6. The numerical results are equivalent with those\nobtained in the 2D test with constant b. Note that it is difficult to perform 3D simulations with more\n20\n\n\fh\n\n# points per period\n\nL2 -error\n\nH 1 -error\n\n0.1\n0.05\n0.025\n0.0125\n0.00625\n0.0003125\n0.0015625\n0.00078125\n\n2\n4\n8\n16\n32\n64\n128\n256\n\n4.7 \u00d7 10\u22121\n5.2 \u00d7 10\u22121\n1.82 \u00d7 10\u22121\n1.89 \u00d7 10\u22122\n1.41 \u00d7 10\u22123\n9.3 \u00d7 10\u22125\n6.1 \u00d7 10\u22126\n4.6 \u00d7 10\u22127\n\n1.05\n1.29\n4.3 \u00d7 10\u22121\n6.4 \u00d7 10\u22122\n1.00 \u00d7 10\u22122\n2.21 \u00d7 10\u22123\n5.5 \u00d7 10\u22124\n1.36 \u00d7 10\u22124\n\nTable 3.4 \u2013 Relative L2 and H 1 errors between the exact solution \u03c6\u03b5 and the computed solution\n\u03c6A (AP) for m = 10 and \u03b5 = 10\u221210 as a function of h.\n\nrefined grids, due to memory requirements on standard desktop equipment as we are doing now. Every\nrow in the matrix constructed for the Singular Perturbation model, can contain up to 125 non zero\nentries (for Q2 finite elements), while matrices associated with the Asymptotic Preserving reformulation\nhave rows with up to 375 non zero entries. Furthermore the dimension of the latter is five times bigger.\nThe memory requirements of the direct solver used in our simulations grow rapidly. The remedy could\nbe to use an iterative solver with suitable preconditioner. Finding the most efficient method to inverse\nthese matrices is however beyond the scope of this paper. In future work we will address this problem\nas well as a parallelization of this method.\n10\n\n100\n(P)\n(L)\n(AP)\n\n(P)\n(L)\n(AP)\n\n1\n10\n\n0.1\n1\n0.01\n0.1\n0.001\n\n0.01\n0.0001\n\n1e-05\n\n0.001\n1e-15\n\n1e-10\n\n1e-05\n\n1\n\n1e-15\n\n(a) L2 error for a grid with 30 \u00d7 30 \u00d7 30 points.\n\n1e-10\n\n1e-05\n\n1\n\n(b) H 1 error for a grid with 30 \u00d7 30 \u00d7 30 points.\n\nFigure 3.6 \u2013 Absolute L2 (left column) and H 1 (right column) errors between the exact solution\n\u03c6\u03b5 and the computed solution \u03c6A (AP), \u03c6L (L), \u03c6P (P) for the 3D test case. The errors are\nplotted as a function of the anisotropy ratio \u03b5.\n\n4. Conclusions\nThe asymptotic preserving method presented in this paper is shown to be very efficient for the\nsolution of highly anisotropic elliptic equations, where the anisotropy direction is given by an arbitrary,\nbut smooth vector field b with non-adapted coordinates and meshes. The results presented here generalize the procedure used in [11] and have the important advantage to permit the use of Cartesian grids,\n21\n\n\findependently on the shape of the anisotropy. Moreover, the scheme is equally accurate, independently\non the anisotropy strength, avoiding thus the use of coupling methods. The numerical study of this\nAP-scheme shall be investigated in a forthcoming paper, in particular the \u03b5-independent convergence\nresults shall be stated.\nAnother important related work consists in extending our methods to the case of anisotropy ratios\n\u03b5, which are variable in \u03a9 from moderate to very small values. This is important, for example, in plasma\nphysics simulations as already noted in the introduction. An alternative strategy to the Asymptotic\nPreserving schemes whould be to couple a standard discretization in subregions with moderate \u03b5 with\na limit (\u03b5 \u2192 0) model in subregions with small \u03b5 as suggested, for example, in [5, 25]. However, the\nlimit model is only valid for \u03b5 \u226a 1 and cannot be applied for weak anisotropies. Thus, the coupling\nstrategy requires existence of a range of anisotropy strength where both methods are valid. This is\nrather undesirable since this range may not exist at all, as illustrated by our results in Fig. 3.1.\nAppendix A. Decompositions V = G \u2295\u22a5 A, \u1e7c = G\u0303 \u2295 L and related estimates.\nWe shall show in this Appendix that all the statements in Hypotheses B and B' can be rigorously\nderived under some assumptions on the domain boundary \u2202\u03a9 and on the manner in which it is intersected by the field b. We assume essentially that b is tangential to \u2202\u03a9 on \u2202\u03a9D and that b penetrates\nthe remaining part of the boundary \u2202\u03a9N at an angle that stays away from 0 on \u2202\u03a9N . We assume also\nthat \u2202\u03a9N consists of two disjoint components for which there exist global and smooth parametrizations.\nThis last assumption can be weakened (existence of an atlas of local smooth parametrizations should be\nsufficient) at the expense of lengthening the proofs. The precise set of our assumptions is the following:\nHypothesis C The boundary of \u03a9 is the union of three components: \u2202\u03a9D where b * n = 0, \u2202\u03a9in\nwhere b * n \u2264 \u2212\u03b1 and \u2202\u03a9out where b * n \u2265 \u03b1 with some constant \u03b1 > 0. Moreover, there is a smooth\nsystem of coordinates \u03be1 ,...,\u03bed\u22121 on \u2202\u03a9in meaning that there is a bounded domain \u0393in \u2208 Rd\u22121 and\na one-to-one map hin : \u0393in \u2192 Rd such that hin \u2208 C 2 (\u0393in ) and \u2202\u03a9in is the image of hin (\u03be1 ,...,\u03bed\u22121 ) as\n(\u03be1 ,...,\u03bed\u22121 ) goes over \u0393in . The matrix formed by the vectors (\u2202hin /\u2202\u03be1 ,...,\u2202hin /\u2202\u03be1 ,n) is invertible\nfor all (\u03be1 ,...,\u03bed\u22121 ) \u2208 \u0393in . Similar assumptions hold also for \u2202\u03a9out (changing \u0393in to \u0393out and hin to hout ).\n\nUsing this hypothesis we can introduce a system of coordinates in \u03a9 such that the field lines of\nb coincide with the coordinate lines. To do this consider the initial value problem for a parametrized\nordinary differential equation (ODE):\n\u2202X \u2032\n(\u03be ,\u03bed ) = b(X(\u03be \u2032 ,\u03bed )), X(\u03be \u2032 ,0) = hin (\u03be \u2032 ).\n\u2202\u03bed\n\n(1.1)\n\nHere X(\u03be \u2032 ,\u03bed ) is Rd -valued and \u03be \u2032 stands for (\u03be1 ,...,\u03bed\u22121 ). For any fixed \u03be \u2032 \u2208 \u0393in , equation (1.1) should\nbe understood as an ODE for a function of \u03bed . Its solution X(\u03be \u2032 ,\u03bed ) goes then over the field line of b\nstarting (as \u03bed = 0) at the point on the inflow boundary \u2202\u03a9in , parametrized by \u03be \u2032 . This field line hits\nthe outflow boundary \u2202\u03a9out somewhere. In other words, for any \u03be \u2032 \u2208 \u0393in there exists L(\u03be \u2032 ) > 0 such\nthat X(\u03be \u2032 ,L(\u03be \u2032 )) \u2208 \u2202\u03a9out . The domain of definition of X is thus\nD = {(\u03be \u2032 ,\u03bed ) \u2208 Rd / \u03be \u2032 \u2208 \u0393in and 0 < \u03bed < L(\u03be \u2032 )}.\nGathering the results on parametrized ODEs, from for instance [34], we conclude that X(\u03be \u2032 ,\u03bed ) =\nX(\u03be1 ,...,\u03bed ) is a smooth function of all its d parameters, more precisely X \u2208 C 2 (D). Evidently, the\nmap X is one-to-one from D to \u03a9 and thus \u03be1 ,...,\u03bed provide a system of coordinates for \u03a9. Moreover this\nsystem is not degenerate in the sense that the vectors \u2202X/\u2202\u03be1 ,...,\u2202X/\u2202\u03bed are linearly independent at\neach point of \u03a9. Indeed, if this was not the case, then there would exist a non trivial linear combination\n22\n\n\f\u03bb1 \u2202X/\u2202\u03be + ***+ \u03bbd \u2202X/\u2202\u03bed that would vanish at some point in \u03a9. But, ODE (1.1) implies\nd\nd\nX\n\u2202X \u2032\n\u2202 X \u2202X \u2032\n\u03bbi\n\u03bbi\n(\u03be ,\u03bed ) = \u2207b(X(\u03be \u2032 ,\u03bed )) *\n(\u03be ,\u03bed )\n\u2202\u03bed i=1 \u2202\u03bei\n\u2202\u03bei\ni=1\n\nPd\nso that, the unique solution of this ODE, i.e. the linear combination i=1 \u03bbi \u2202X\n\u2202\u03bei , would vanish on the\n\u2202hin\n\u2202X\nwhole field line, in particular on the inflow. But this is impossible since \u2202\u03bei = \u2202\u03bei , i = 1,...,d \u2212 1 on the\n\u0010\n\u0011\n\u2202hin\n\u2202hin\n\u2202X\ninflow, while \u2202\u03be\n=\nb\nand\nthe\nvectors\n,b\nare linearly independent for all (\u03be1 ,...,\u03bed\u22121 ) \u2208\n,...,\n\u2202\u03be1\n\u2202\u03bed\u22121\nd\n\n\u0393in . We see thus that the Jacobian J = det(\u2202Xj /\u2202\u03bei ) does not vanish on \u03a9 so that we can assume that\nm < J < M everywhere on \u03a9 with some positive constants m and M (assuming that J is positive does\nnot prevent the generality since if J is negative in \u03a9 than one can replace \u03be1 by \u2212\u03be1 ). Since X \u2208 C 2 (\u03a9),\nwe have also that J \u2208 C 1 (\u03a9).\nOne also sees easily that the top of D is given by a smooth function L(\u03be \u2032 ). Indeed, L(\u03be \u2032 ) is\ndetermined for each \u03be \u2032 \u2208 \u0393in from the equation X(\u03be \u2032 ,L(\u03be \u2032 )) = hout (\u03b7) with some \u03b7 = (\u03b71 ,...,\u03b7d\u22121 ) \u2208 \u0393out .\nWe know already that this equation is solvable for \u03bed = L(\u03be \u2032 ), \u03b71 ,...,\u03b7d\u22121 for any \u03be \u2032 \u2208 \u0393in . To conclude\nthat the solution depends smoothly on \u03be \u2032 we can apply the implicit function theorem to the equation\nF (\u03be \u2032 ;\u03bed ,\u03b71 ,...,\u03b7d\u22121 ) = X(\u03be \u2032 ,\u03bed ) \u2212 hout (\u03b71 ,...,\u03b7d\u22121 ) = 0.\n\nIndeed, the Rd -valued function F is smooth and the matrix of its partial derivatives with respect to\n\u03bed ,\u03b71 ,...,\u03b7d\u22121 is invertible since \u2202F/\u2202\u03bed = b and \u2202F/\u2202\u03b7i = \u2212\u2202hout/\u2202\u03b7i at some point at the outflow\nand the vectors \u2202hout /\u2202\u03b7i lie in the tangent plane to \u2202\u03a9out while b is nowhere in this plane. We have\nmoreover that L \u2208 C 1 (\u0393in ). Indeed, we can prove that all the derivatives of L are bounded. In order to\ndo it, let us remark that the differential of X(\u03be \u2032 ,L(\u03be \u2032 )) represents a vector in the tangent plane at some\npoint on \u2202\u03a9out so that it is perpendicular to the outward normal n. We have thus for any i = 1,...,d \u2212 1\n\u0013\n\u0012\n\u0013\n\u0012\n\u2202X \u2032\n\u2202X \u2032\n\u2202X \u2032\n\u2032\n\u2032 \u2202L \u2032\n\u2032\n\u2032\n\u2032 \u2202L \u2032\n(\u03be ,L(\u03be )) +\n(\u03be ,L(\u03be ))\n(\u03be ) = n *\n(\u03be ,L(\u03be )) + b(\u03be ,L(\u03be ))\n(\u03be )\n0 = n*\n\u2202\u03bei\n\u2202\u03bed\n\u2202\u03bei\n\u2202\u03bei\n\u2202\u03bei\nso that\n\u2032\n\u2032\nn * \u2202X\n\u2202L \u2032\n\u2202\u03bei (\u03be ,L(\u03be ))\n(\u03be ) = \u2212\n\u2202\u03bei\nn * b(\u03be \u2032 ,L(\u03be \u2032 ))\n\nand this is bounded since X has bounded partial derivatives and n * b \u2265 \u03b1 by the hypothesis. Note also\nthat L is strictly positive.\n\u2022 We can now establish the decomposition V = G \u2295\u22a5 A. Take any \u03c6 \u2208 V \u2229C 1 (\u03a9) and introduce\np \u2208 L2 (\u03a9) by\nR L(\u03be\u2032 )\n\u03c6(\u03be \u2032 ,t)J(\u03be \u2032 ,t)dt\n\u2032\n\u2032\np(x) = p(\u03be ,\u03bed ) = p(\u03be ) = 0 R L(\u03be\u2032 )\n.\n(1.2)\nJ(\u03be \u2032 ,t)dt\n0\n(from now on we switch back and forth between the Cartesian coordinates x = (x1 ,...,xd ) and\nthe new ones (\u03be \u2032 ,\u03bed ) = (\u03be1 ,...,\u03bed )). Evidently, p is constant along each field line. Moreover, p is\nthe L2 -orthogonal projection of \u03c6 on the space of such functions. Indeed, if \u03c8 = \u03c8(\u03be \u2032 ) \u2208 L2 (\u03a9)\nis any function constant along each field line then\nZ L(\u03be\u2032 )\nZ\nZ\nZ\np(\u03be \u2032 )\u03c8(\u03be \u2032 )\nJ(\u03be \u2032 ,\u03bed )d\u03bed d\u03be \u2032\np\u03c8dx =\np\u03c8Jd\u03be =\n\u03a9\n\nD\n\n=\n\nZ\n\n\u0393in\n\n0\n\n\u0393in\n\nZ\n\nL(\u03be \u2032 )\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u03c6(\u03be ,\u03bed )\u03c8(\u03be )J(\u03be ,\u03bed )d\u03bed d\u03be =\n\n0\n\nZ\n\n\u03a9\n\n23\n\n\u03c6\u03c8dx.\n\n\fLet us prove that p \u2208 V, i.e. that its derivatives are square integrable. The change of variable\nt = L(\u03be \u2032 )s yields the function\nR1\n\u03c6(\u03be \u2032 ,L(\u03be \u2032 )s)J(\u03be \u2032 ,L(\u03be \u2032 )s)ds\n\u2032\n.\np(\u03be ) = 0\nR1\n\u2032\n\u2032\n0 J(\u03be ,L(\u03be )s)ds\nR1\nNow we have \u2202p/\u2202\u03bed = 0 and for all \u2202p/\u2202\u03bei,i=1,...,d\u22121 denoting a = a(\u03be \u2032 ) = ( 0 J(\u03be \u2032 ,L(\u03be \u2032 )s)ds)\u22121 ,\n\u03c6 = \u03c6(\u03be \u2032 ,L(\u03be \u2032 )s) and same for J we obtain\nZ 1\nZ 1\nZ\n\u2202p\n\u2202a 1\n\u2202\u03c6 \u2202L\n\u2202\u03c6\n=\nJds + a\nsJ ds\n\u03c6Jds + a\n\u2202\u03bei\n\u2202\u03bei 0\n0 \u2202\u03bed \u2202\u03bei\n0 \u2202\u03bei\n(1.3)\nZ 1\nZ 1\n\u2202J\n\u2202J \u2202L\n\u03c6\n+a\n\u03c6\nds + a\nsds\n\u2202\u03bei\n\u2202\u03bed \u2202\u03bei\n0\n0\nUsing all the previous bounds on the functions L and J and skipping the details of somewhat\ntedious calculations, we arrive at\n\u00132\n\u00132\nZ Z L(\u03be\u2032 ) \u0012\nZ \u0012\n\u2202p\n\u2202p\ndx =\nJd\u03bed d\u03be \u2032\n\u2202\u03bei\n\u0393in 0\n\u03a9 \u2202\u03bei\n\u00132 \u0012\n\u00132 !\n\u0012\nZ Z L(\u03be\u2032 )\n\u2202\u03c6\n\u2202\u03c6\n2\nJd\u03bed d\u03be \u2032\n+\n\u03c6 +\n\u2264C\n\u2202\u03bei\n\u2202\u03bed\n\u0393in 0\nimplying\n\u2202p\n\u2202\u03bei\n\n2\n\n\u2264C\nL2 (\u03a9)\n\n2\nk\u03c6kL2 (\u03a9) +\n\n\u2202\u03c6\n\u2202\u03bei\n\n2\n\n\u2202\u03c6\n+\n\u2202\u03bed\nL2 (\u03a9)\n\n2\nL2 (\u03a9)\n\n!\n\n2\n\n\u2264 C k\u03c6kH 1 (\u03a9) .\n\nThus p \u2208 H 1 (\u03a9), hence p \u2208 G and q = \u03c6 \u2212 p \u2208 A. Since the dependence of p on \u03c6 is continuous\nin the norm of H 1 (\u03a9), a density argument shows that the decomposition \u03c6 = p + q with p \u2208 G\nand q \u2208 A exists for any \u03c6 \u2208 V.\n\u2022 Let us now introduce the operator P as the L2 -orthogonal projector on G, that means\nP :V \u2192G,\n\n\u03c6 \u2208 V 7\u2212\u2192 P \u03c6 \u2208 G\n\ngiven by\n\n(1.2).\n\nThen, the estimates in the preceding paragraph show that the operator P is continuous in the\nnorm of H 1 (\u03a9):\n||\u2207\u22a5 (P \u03c6)||L2 (\u03a9) \u2264 C||\u2207\u03c6||L2 (\u03a9) ,\n\n\u2200\u03c6 \u2208 V\n\n(1.4)\n\n\u2200\u03c6 \u2208 V .\n\n(1.5)\n\n\u2022 We have also the following Poincar\u00e9-Wirtinger inequality:\n||\u03c6 \u2212 P \u03c6||L2 (\u03a9) \u2264 C||\u2207|| \u03c6||L2 (\u03a9) ,\n\nTo prove this, it is sufficient to establish that ||q||L2 (\u03a9) \u2264 C||\u2207|| q||L2 (\u03a9) for all q \u2208 A. We observe\nthat\nZ Z L(\u03be\u2032 )\n2\n||q||L2 (\u03a9) =\nq 2 (\u03be \u2032 ,\u03bed )J(\u03be \u2032 ,\u03bed )d\u03bed d\u03be \u2032\n\u0393in\n\n0\n\nand\n||\u2207|| \u03c6||2L2 (\u03a9) =\n\nZ\n\n\u0393in\n\nZ\n\n0\n\nL(\u03be \u2032 ) \u0012\n\n24\n\n\u2202q\n\u2202\u03bed\n\n\u00132\n\n(\u03be \u2032 ,\u03bed )J(\u03be \u2032 ,\u03bed )d\u03bed d\u03be \u2032 .\n\n\fThe requirement q \u2208 A is equivalent to\nZ\n\nL(\u03be \u2032 )\n\nq(\u03be \u2032 ,\u03bed )J(\u03be \u2032 ,\u03bed )d\u03bed = 0 f.a.a. \u03be \u2032 \u2208 \u0393in .\n\n(1.6)\n\n0\n\nWe have thus to prove for every \u03be \u2032\nZ\n\nL(\u03be \u2032 )\n\n2\n\n\u2032\n\n\u2032\n\nq (\u03be ,\u03bed )J(\u03be ,\u03bed )d\u03bed \u2264 C\n\n2\n\n0\n\nZ\n\n0\n\nL(\u03be \u2032 ) \u0012\n\n\u2202q\n\u2202\u03bed\n\n\u00132\n\n(\u03be \u2032 ,\u03bed )J(\u03be \u2032 ,\u03bed )d\u03bed\n\nprovided (1.6). Fixing any \u03be \u2032 , making the change of integration variable \u03bed = L(\u03be \u2032 )t and introducing the functions u(t) = q(\u03be \u2032 ,L(\u03be \u2032 )t)J(\u03be \u2032 ,L(\u03be \u2032 )t) and J(t) = J(\u03be \u2032 ,L(\u03be \u2032 )t), we rewrite the last\ninequality as\nZ\n\n0\n\nSince\n\nR1\n0\n\n1\n\nu2 (t)\nC2\ndt \u2264 2 \u2032\nJ(t)\nL (\u03be )\n\nZ 1\u0012\n0\n\n\u00132\nu(t)\nu\u2032 (t)\n\u2212 2 J \u2032 (t) J(t)dt.\nJ(t) J (t)\n\n(1.7)\n\nu(t)dt = 0 we have by the standard Poincar\u00e9 inequality\nZ\n\n0\n\n1\n\nu2 (t)dt \u2264 CP2\n\nZ\n\n1\n\n2\n\n(u\u2032 (t)) dt.\n\n(1.8)\n\n0\n\n\u2022 Let us turn to the verification of Hypothesis B'. Take any u \u2208 \u1e7c. We want to prove that one can\ndecompose u = p + q with p \u2208 G\u0303 and q \u2208 L and the trace of u on \u2202\u03a9in (denoted g) is in L2 (\u2202\u03a9in ).\nIn the \u03be-coordinates we can write a surface element of \u2202\u03a9in as d\u03c3 = S(\u03be \u2032 )d\u03be \u2032 with a function S\nsmoothly depending on \u03be \u2032 . We see now that for u suffuciently smooth\nZ\ng 2 (\u03be \u2032 )S(\u03be \u2032 )d\u03be \u2032\n||g||2L2 (\u2202\u03a9in ) =\n\u0393in\n#\n\u0012\n\u00132\nZ 1Z \"\n\u2202u\n1\n2 \u2032\n\u2032\n\u2032\n\u2032\nu (\u03be ,L(\u03be )s) +\n(\u03be ,L(\u03be )s) S(\u03be \u2032 )d\u03be \u2032 ds\n\u2264C\nL(\u03be \u2032 ) \u2202\u03bed\n0\n\u0393in\n(by a one-dimensional trace inequlity)\n\u2264 C||u||2\u1e7c\nBy density, the trace g is thus defined for any u \u2208 \u1e7c with ||g||L2 (\u2202\u03a9in ) \u2264 C||u||\u1e7c . Taking p =\np(\u03be \u2032 ) = g(\u03be \u2032 ) we observe by a similar calculation that ||p||L2 (\u03a9) \u2264 C||u||\u1e7c so that p \u2208 G\u0303. By\ndefinition q = u \u2212 p \u2208 L.\nAppendix B. On the choice of the finite element space Lh .\nLet \u03a9 be the rectangle (0,Lx ) \u00d7 (0,Ly ) and the anisotropy direction be constant and aligned with\nthe y-axis: b = (0,1). Let us use the Qk finite elements on a Cartesian grid, i.e. take some basis function\n\u03b8xi (x), i = 0,...,Nx and \u03b8yj (y), j = 0,...,Ny and define the complete finite element space Xh (without\nany restrictions on the boundary) as span{\u03b8xi (x)\u03b8yj (y) 0 \u2264 i \u2264 Nx, 0 \u2264 j \u2264 Ny }. The following subspace\nis then used for the approximation of the unknowns p,q,l \u2208 V\nVh = {vh \u2208 Xh /vh |\u2202\u03a9D = 0}.\nWe want to prove that taking for the approximation of \u03bb,\u03bc \u2208 L the space Lh under the form\nLh = {\u03bbh \u2208 Xh /\u03bbh |\u2202\u03a9in = 0},\n25\n\n(2.1)\n\n\fleads to an ill posed problem (3.1).\nClaim There exist \u03bbh \u2208 Lh , \u03bbh 6= 0, such that a|| (\u03bbh ,ph ) = 0 for all ph \u2208 Vh . In fact there are exactly\n2Ny linearly independent functions having this property.\nRemark B.1. In the continuous case, the equation\na|| (p,\u03bb) = 0,\n\n\u2200p \u2208 V ,\n\nimplies \u03bb = 0 by density arguments. These density arguments are lost when discretizing the spaces V\nresp. L.\nProof of the Claim. We can suppose that the basis functions \u03b8ij (x,y)\nP := \u03b8xi (x)\u03b8yj (y) are enumerated\nso that \u03b8ij (0,y) = 0 for all i \u2265 1 and \u03b80j (0,y) 6= 0. Hence for all ph = pij \u03b8ij \u2208 Vh , the coefficients satisfy\np0j = 0 since the part of the\nR boundary {x = 0} is in \u2202\u03a9D . Let M = (mik )0\u2264i,k\u2264Nx be the mass matrix\nin the x-direction: mik = \u03b8xi (x)\u03b8xk (x)dx. This matrix is invertible, hence there is a vector a \u2208 RNx +1\nNx +1\nt\nthat solves M a =\n, e = (1,0,...,0)\n. Take any fixed integer j, 1 \u2264 j \u2264 Ny and define\nPe with e \u2208 R\nP\n\u03bbh \u2208 Lh as \u03bbh = ai \u03b8ij . Then, for all ph = pkl \u03b8kl \u2208 Vh we have\nZ\nX\n\u2202\u03b8ij \u2202\u03b8kl\ndxdy\na|| (\u03bbh ,ph ) =\nai pkl\n\u03a9 \u2202y \u2202y\ni,k,l\nZ Ly\nZ Lx\nX\n\u03b8y\u2032 j (y)\u03b8y\u2032 l (y)dy\n=\n\u03b8xi (x)\u03b8xk (x)dx\nai pkl\n=\n\nX\nk,l\n\n0\n\n0\n\ni,k,l\n\n\u03b4k0 pkl\n\nZ\n\n0\n\nLy\n\n\u03b8y\u2032 j (y)\u03b8y\u2032 l (y)dy = 0.\n\nAs we can do this for all (i,j), i = 0, 1 \u2264 j \u2264 Ny and in the same manner for all (i,j), i = Nx, 1 \u2264 j \u2264 Ny ,\nthere are 2Ny linearly independent functions with the property a|| (\u03bbh ,ph ) = 0 for all ph \u2208 Vh .\nWe see now that the system (3.1) with zero right hand side f = 0 possesses non-zero solutions\n(p\u03b5h , \u03bb\u03b5h , qh\u03b5 , lh\u03b5 , \u03bc\u03b5h ) = (0,\u03bbjh ,0,0,0) where \u03bbjh is any of the functions constructed in the preceding paragraph. It means that (3.1) is ill posed, i.e. the corresponding matrix is singular.\nAcknowledgement. This work has been supported by the Marie Curie Actions of the European Commission under the contract DEASE (MEST-CT-2005-021122), by the French 'Commissariat\n\u00e0 l'Energie Atomique (CEA)' under contracts ELMAG (CEA-Cesta 4600156289), and GYRO-AP\n(Euratom-CEA V 3629.001), by the Agence Nationale de la Recherche (ANR) under contract IODISEE\n(ANR-09-COSI-007-02), by the 'Fondation Sciences et Technologies pour l'A\u00e9ronautique et l'Espace\n(STAE)' under contract PLASMAX (RTRA-STAE/2007/PF/002) and by the Scientific Council of the\nUniversit\u00e9 Paul Sabatier, under contract MOSITER. Support from the French magnetic fusion programme 'f\u00e9d\u00e9ration de recherche sur la fusion par confinement magn\u00e9tique' is also acknowledged. The\nauthors would like to express their gratitude to G. Gallice and C. Tessieras from CEA-Cesta for bringing their attention to this problem, to G. Falchetto, X. Garbet and M. Ottaviani from CEA-Cadarache,\nfor their constant support to this research programme.\nREFERENCES\n[1] J. Adam, J. Boeuf, N. Dubuit, M. Dudeck, L. Garrigues, D. Gresillon, A. Heron, G. Hagelaar, V. Kulaev, N. Lemoine,\net al. Physics, simulation and diagnostics of Hall effect thrusters. Plasma Physics and Controlled Fusion,\n50:124041, 2008.\n[2] P. R. Amestoy, I. S. Duff, J.-Y. L'Excellent, and J. Koster. A fully asynchronous multifrontal solver using distributed\ndynamic scheduling. SIAM J. Matrix Anal. Appl., 23(1):15\u201341, 2001.\n26\n\n\f[3] S. F. Ashby, W. J. Bosl, R. D. Falgout, S. G. Smith, A. F. Tompson, and T. J. Williams. A Numerical Simulation\nof Groundwater Flow and Contaminant Transport on the CRAY T3D and C90 Supercomputers. International\nJournal of High Performance Computing Applications, 13(1):80\u201393, 1999.\n[4] M. Beer, S. Cowley, and G. Hammett. Field-aligned coordinates for nonlinear simulations of tokamak turbulence.\nPhysics of Plasmas, 2(7):2687, 1995.\n[5] C. Besse, P. Degond, F. Deluzet, J. Claudel, G. Gallice, and C. Tessieras. A model hierarchy for ionospheric plasma\nmodeling. Math. Models Methods Appl. Sci., 14(3):393\u2013415, 2004.\n[6] C. Besse, F. Deluzet, C. Negulescu, and C. Yang. Three dimensional simulation of ionsphoric plasma disturbences.\nin preparation.\n[7] A. H. Boozer. Establishment of magnetic coordinates for a given magnetic field. Physics of Fluids, 25(3):520\u2013521,\n1982.\n[8] S. Brull, P. Degond, and F. Deluzet. Numerical degenerate elliptic problems and their applications to magnetized\nplasma simulations. in preparation.\n[9] P. Crispel, P. Degond, and M.-H. Vignal. An asymptotic preserving scheme for the two-fluid Euler-Poisson model\nin the quasineutral limit. J. Comput. Phys., 223(1):208\u2013234, 2007.\n[10] P. Degond, F. Deluzet, L. Navoret, A.-B. Sun, and M.-H. Vignal. Asymptotic-preserving particle-in-cell method for\nthe vlasov-poisson system near quasineutrality. J. Comput. Phys., 229(16):5630\u20135652, 2010.\n[11] P. Degond, F. Deluzet, and C. Negulescu. An asymptotic preserving scheme for strongly anisotropic elliptic problems.\nMultiscale Model. Simul., 8(2):645\u2013666, 2009/10.\n[12] P. Degond, F. Deluzet, A. Sangam, and M.-H. Vignal. An asymptotic preserving scheme for the Euler equations in\na strong magnetic field. J. Comput. Phys., 228(10):3540\u20133558, 2009.\n[13] F. Deluzet, A. Lozinski, J. Narski, and C. Negulescu. Error estimates for an asymptotic-preserving method for\nhighly anisotropic diffusion equations. in preparation.\n[14] W. D. D'haeseleer, W. N. G. Hitchon, J. D. Callen, and J. L. Shohet. Flux coordinates and magnetic field structure.\nA guide to a fundamental tool of plasma theory. Springer Series in Computational Physics. Springer-Verlag,\nBerlin, 1991.\n[15] A. M. Dimits. Fluid simulations of tokamak turbulence in quasiballooning coordinates. Phys. Rev. E, 48(5):4070\u2013\n4079, Nov 1993.\n[16] M. W. Gee, J. J. Hu, and R. S. Tuminaro. A new smoothed aggregation multigrid method for anisotropic problems.\nNumer. Linear Algebra Appl., 16(1):19\u201337, 2009.\n[17] L. Giraud and R. S. Tuminaro. Schur complement preconditioners for anisotropic problems. IMA J. Numer. Anal.,\n19(1):1\u201318, 1999.\n[18] V. Grandgirard, Y. Sarazin, X. Garbet, G. Dif-Pradalier, P. Ghendrih, N. Crouseilles, G. Latu, E. Sonnendr\u00fccker,\nN. Besse, and P. Bertrand. Computing ITG turbulence with a full-f semi-lagrangian code. Communications in\nNonlinear Science and Numerical Simulation, 13(1):81 \u2013 87, 2008.\n[19] S. Hamada. Hydromagnetic equilibria and their proper coordinates. Nucl. Fusion, 2:23\u201337, 1962.\n[20] T. Y. Hou and X.-H. Wu. A multiscale finite element method for elliptic problems in composite materials and\nporous media. J. Comput. Phys., 134(1):169\u2013189, 1997.\n[21] Y. Igitkhanov, M. Mikhailov, and W. Feneberg. Fluid Description of Edge Plasma Transport in a Non-Orthogonal\nCoordinate System. Contributions to Plasma Physics, 34(2-3):398\u2013403, 1994.\n[22] S. Jin. Efficient asymptotic-preserving (AP) schemes for some multiscale kinetic equations. SIAM J. Sci. Comput.,\n21(2):441\u2013454, 1999.\n[23] E. Kaveeva and V. Rozhansky. Poloidal and toroidal flows in tokamak plasma near magnetic islands. Technical\nphysics letters, 30(7):538\u2013540, 2004.\n[24] M. Kelley, W. Swartz, and J. Makela. Mid-latitude ionospheric fluctuation spectra due to secondary E\u0168B instabilities. Journal of Atmospheric and Solar-Terrestrial Physics, 66(17):1559\u20131565, 2004.\n[25] M. Keskinen. Nonlinear theory of the E\u00d7 B instability with an inhomogeneous electric field. Journal of Geophysical\nResearch, 89(A6):3913\u20133920, 1984.\n[26] M. Keskinen, S. Ossakow, and B. Fejer. Three-dimensional nonlinear evolution of equatorial ionospheric spread-F\nbubbles. Geophys. Res. Lett, 30(16):4\u20131\u20134\u20134, 2003.\n[27] B. N. Khoromskij and G. Wittum. Robust Schur complement method for strongly anisotropic elliptic equations.\nNumer. Linear Algebra Appl., 6(8):621\u2013653, 1999.\n[28] I. Llorente and N. Melson. Robust multigrid smoothers for three dimensional elliptic equations with strong\nanisotropies. ICASE Technical Report: TR-98-37, 1998.\n[29] T. Manku and A. Nathan. Electrical properties of silicon under nonuniform stress. Journal of Applied Physics,\n74(3):1832\u20131837, 1993.\n[30] J. M. Melenk. hp-finite element methods for singular perturbations, volume 1796 of Lecture Notes in Mathematics.\nSpringer-Verlag, Berlin, 2002.\n[31] K. Miyamoto. Controlled fusion and plasma physics. Chapman & Hall, 2007.\n[32] Y. Notay. An aggregation-based algebraic multigrid method. Report GANMN 08-02, Universit\u00e9 Libre de Bruxelles,\nBrussels, Belgium, 2008.\n[33] M. A. Ottaviani. An alternative approach to field-aligned coordinates for plasma turbulence simulations.\n27\n\n\farXiv:1002.0748, 2010.\n[34] L. S. Pontryagin. Ordinary differential equations. Addison-Wesley Publishing Co., Inc., Reading, Mass.-Palo Alto,\nCalif.-London, 1962.\n[35] D. Stern. Geomagnetic Euler potentials. J. geophys. Res, 72(15):3995\u20134005, 1967.\n[36] A. M. Tr\u00e9guier. Mod\u00e9lisation num\u00e9rique pour l'oc\u00e9anographie physique. Ann. Math. Blaise Pascal, 9(2):345\u2013361,\n2002.\n[37] W.-W. Wang and X.-C. Feng. Anisotropic diffusion with nonlinear structure tensor. Multiscale Model. Simul.,\n7(2):963\u2013977, 2008.\n[38] J. Weickert. Anisotropic diffusion in image processing. European Consortium for Mathematics in Industry. B. G.\nTeubner, Stuttgart, 1998.\n\n28\n\n\f"}