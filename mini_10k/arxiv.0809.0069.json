{"id": "http://arxiv.org/abs/0809.0069v5", "guidislink": true, "updated": "2010-02-11T11:30:39Z", "updated_parsed": [2010, 2, 11, 11, 30, 39, 3, 42, 0], "published": "2008-08-30T15:35:38Z", "published_parsed": [2008, 8, 30, 15, 35, 38, 5, 243, 0], "title": "Full-Potential Multiple Scattering Theory with Space-Filling Cells for\n  bound and continuum states", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0809.2918%2C0809.3711%2C0809.1044%2C0809.2886%2C0809.5093%2C0809.2912%2C0809.4336%2C0809.0709%2C0809.4225%2C0809.2734%2C0809.2562%2C0809.0918%2C0809.4734%2C0809.1901%2C0809.3391%2C0809.3855%2C0809.1518%2C0809.4017%2C0809.3958%2C0809.1262%2C0809.4286%2C0809.2502%2C0809.3576%2C0809.2338%2C0809.5181%2C0809.0222%2C0809.3737%2C0809.0069%2C0809.1934%2C0809.4447%2C0809.0159%2C0809.0951%2C0809.3122%2C0809.0587%2C0809.0536%2C0809.5246%2C0809.1057%2C0809.4861%2C0809.0784%2C0809.2637%2C0809.1110%2C0809.2855%2C0809.4599%2C0809.5116%2C0809.0128%2C0809.1043%2C0809.0739%2C0809.1301%2C0809.3612%2C0809.2778%2C0809.5014%2C0809.0038%2C0809.0917%2C0809.0550%2C0809.5126%2C0809.1906%2C0809.1652%2C0809.4218%2C0809.3014%2C0809.0337%2C0809.1357%2C0809.4376%2C0809.1601%2C0809.3537%2C0809.3325%2C0809.2239%2C0809.1496%2C0809.0922%2C0809.1565%2C0809.5271%2C0809.2672%2C0809.2696%2C0809.4483%2C0809.0934%2C0809.3730%2C0809.1351%2C0809.5154%2C0809.4127%2C0809.0042%2C0809.3154%2C0809.2091%2C0809.1804%2C0809.5244%2C0809.3996%2C0809.0048%2C0809.3810%2C0809.3284%2C0809.3015%2C0809.2476%2C0809.3440%2C0809.4695%2C0809.4328%2C0809.1341%2C0809.0648%2C0809.2424%2C0809.2263%2C0809.3089%2C0809.4201%2C0809.5035%2C0809.0470%2C0809.0981&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Full-Potential Multiple Scattering Theory with Space-Filling Cells for\n  bound and continuum states"}, "summary": "We present a rigorous derivation of a real space Full-Potential\nMultiple-Scattering-Theory (FP-MST), valid both for continuum and bound states,\nthat is free from the drawbacks that up to now have impaired its development,\nin particular the need to use cell shape functions and rectangular matrices. In\nthis connection we give a new scheme to generate local basis functions for the\ntruncated potential cells that is simple, fast, efficient, valid for any shape\nof the cell and reduces to the minimum the number of spherical harmonics in the\nexpansion of the scattering wave function. The method also avoids the need for\nsaturating 'internal sums' due to the re-expansion of the spherical Hankel\nfunctions around another point in space (usually another cell center). Thus\nthis approach, provides a straightforward extension of MST in the Muffin-Tin\n(MT) approximation, with only one truncation parameter given by the classical\nrelation $l_{\\rm max} = kR_b$, where $k$ is the excited (or ground state)\nelectron wave vector and $R_b$ the radius of the bounding sphere of the\nscattering cell. It is shown that the theory converges absolutely in the\n$l_{\\rm max} \\to \\infty$ limit. As a consequence it provides a firm ground to\nthe use of FP-MST as a viable method for electronic structure calculations and\nmakes possible the computation of x-ray spectroscopies, notably photo-electron\ndiffraction, absorption and anomalous scattering among others, with the ease\nand versatility of the corresponding MT theory. Some numerical applications of\nthe theory are presented, both for continuum and bound states.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0809.2918%2C0809.3711%2C0809.1044%2C0809.2886%2C0809.5093%2C0809.2912%2C0809.4336%2C0809.0709%2C0809.4225%2C0809.2734%2C0809.2562%2C0809.0918%2C0809.4734%2C0809.1901%2C0809.3391%2C0809.3855%2C0809.1518%2C0809.4017%2C0809.3958%2C0809.1262%2C0809.4286%2C0809.2502%2C0809.3576%2C0809.2338%2C0809.5181%2C0809.0222%2C0809.3737%2C0809.0069%2C0809.1934%2C0809.4447%2C0809.0159%2C0809.0951%2C0809.3122%2C0809.0587%2C0809.0536%2C0809.5246%2C0809.1057%2C0809.4861%2C0809.0784%2C0809.2637%2C0809.1110%2C0809.2855%2C0809.4599%2C0809.5116%2C0809.0128%2C0809.1043%2C0809.0739%2C0809.1301%2C0809.3612%2C0809.2778%2C0809.5014%2C0809.0038%2C0809.0917%2C0809.0550%2C0809.5126%2C0809.1906%2C0809.1652%2C0809.4218%2C0809.3014%2C0809.0337%2C0809.1357%2C0809.4376%2C0809.1601%2C0809.3537%2C0809.3325%2C0809.2239%2C0809.1496%2C0809.0922%2C0809.1565%2C0809.5271%2C0809.2672%2C0809.2696%2C0809.4483%2C0809.0934%2C0809.3730%2C0809.1351%2C0809.5154%2C0809.4127%2C0809.0042%2C0809.3154%2C0809.2091%2C0809.1804%2C0809.5244%2C0809.3996%2C0809.0048%2C0809.3810%2C0809.3284%2C0809.3015%2C0809.2476%2C0809.3440%2C0809.4695%2C0809.4328%2C0809.1341%2C0809.0648%2C0809.2424%2C0809.2263%2C0809.3089%2C0809.4201%2C0809.5035%2C0809.0470%2C0809.0981&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a rigorous derivation of a real space Full-Potential\nMultiple-Scattering-Theory (FP-MST), valid both for continuum and bound states,\nthat is free from the drawbacks that up to now have impaired its development,\nin particular the need to use cell shape functions and rectangular matrices. In\nthis connection we give a new scheme to generate local basis functions for the\ntruncated potential cells that is simple, fast, efficient, valid for any shape\nof the cell and reduces to the minimum the number of spherical harmonics in the\nexpansion of the scattering wave function. The method also avoids the need for\nsaturating 'internal sums' due to the re-expansion of the spherical Hankel\nfunctions around another point in space (usually another cell center). Thus\nthis approach, provides a straightforward extension of MST in the Muffin-Tin\n(MT) approximation, with only one truncation parameter given by the classical\nrelation $l_{\\rm max} = kR_b$, where $k$ is the excited (or ground state)\nelectron wave vector and $R_b$ the radius of the bounding sphere of the\nscattering cell. It is shown that the theory converges absolutely in the\n$l_{\\rm max} \\to \\infty$ limit. As a consequence it provides a firm ground to\nthe use of FP-MST as a viable method for electronic structure calculations and\nmakes possible the computation of x-ray spectroscopies, notably photo-electron\ndiffraction, absorption and anomalous scattering among others, with the ease\nand versatility of the corresponding MT theory. Some numerical applications of\nthe theory are presented, both for continuum and bound states."}, "authors": ["Keisuke Hatada", "Kuniko Hayakawa", "Maurizio Benfatto", "Calogero R. Natoli"], "author_detail": {"name": "Calogero R. Natoli"}, "author": "Calogero R. Natoli", "arxiv_comment": "48 pages, 6 figures, 2 tables", "links": [{"href": "http://arxiv.org/abs/0809.0069v5", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0809.0069v5", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cond-mat.other", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.other", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0809.0069v5", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0809.0069v5", "journal_reference": null, "doi": null, "fulltext": "arXiv:0809.0069v5 [cond-mat.other] 11 Feb 2010\n\nFull-Potential Multiple Scattering Theory with\nSpace-Filling Cells for bound and continuum states\nKeisuke Hatada1,2 , Kuniko Hayakawa2,3 , Maurizio Benfatto2 ,\nCalogero R. Natoli1,2\n1\n\nInstituto de Ciencia de Materiales de Arag\u00f3n, CSIC-Universidad de Zaragoza, 50009\nZaragoza, Spain.,\n2\nINFN Laboratori Nazionali di Frascati, Via E. Fermi 40, c.p. 13, I-00044 Frascati,\nItaly,\n3\nCentro Fermi, Compendio Viminale, Roma I-00184, Italy\nE-mail:\n\nhatada@unizar.es\n\nAbstract. We present a rigorous derivation of a real space Full-Potential MultipleScattering-Theory (FP-MST) that is free from the drawbacks that up to now have\nimpaired its development (in particular the need to expand cell shape functions in\nspherical harmonics and rectangular matrices), valid both for continuum and bound\nstates, under conditions for space-partitioning that are not excessively restrictive and\neasily implemented. In this connection we give a new scheme to generate local basis\nfunctions for the truncated potential cells that is simple, fast, efficient, valid for any\nshape of the cell and reduces to the minimum the number of spherical harmonics in\nthe expansion of the scattering wave function. The method also avoids the need for\nsaturating 'internal sums' due to the re-expansion of the spherical Hankel functions\naround another point in space (usually another cell center). Thus this approach,\nprovides a straightforward extension of MST in the Muffin-Tin (MT) approximation,\nwith only one truncation parameter given by the classical relation lmax = kRb , where\nk is the electron wave vector (either in the excited or ground state of the system\nunder consideration) and Rb the radius of the bounding sphere of the scattering cell.\nMoreover, the scattering path operator of the theory can be found in terms of an\nabsolutely convergent procedure in the lmax \u2192 \u221e limit. Consequently, this feature\nprovides a firm ground to the use of FP-MST as a viable method for electronic structure\ncalculations and makes possible the computation of x-ray spectroscopies, notably\nphoto-electron diffraction, absorption and anomalous scattering among others, with\nthe ease and versatility of the corresponding MT theory. Some numerical applications\nof the theory are presented, both for continuum and bound states.\n\nPACS numbers: 78.70Dm, 61.05.jd\n\n1.\n\nIntroduction\n\nAt its most basic, Multiple scattering Theory (MST) is a technique for solving a linear\npartial differential equation over a region of space with certain boundary conditions. It\nis implemented by dividing the space into non-overlapping domains (cells), solving the\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states2\ndifferential equation separately in each of the cells and then assembling together the\npartial solutions into a global solution that is continuous and smooth across the whole\nregion and satisfies the given boundary conditions.\nAs such MST has been applied to the solution of many problems drawn both\nfrom classic as well as quantum physics, ranging from the study of membranes and\nelectromagnetism to the quantum-mechanical wave equation. In quantum mechanics\nit has been widely used to solve the Schr\u00f6dinger equation (SE) ( or the associated\nLippmann-Schwinger equation (LSE)) both for scattering and bound states. It was\nproposed originally by Korringa and by Kohn and Rostoker (KKR) as a convenient\nmethod for calculating the electronic structure of solids [1, 2] and was later extended\nto polyatomic molecules by Slater and Johnson [3]. A characteristic feature of the\nmethod is the complete separation between the potential aspect of the material under\nstudy, embodied in the cell scattering power, from the structural aspect of the problem,\nreflecting the geometrical position of the atoms in space.\nApplications of the KKR method were first made within the so-called muffintin (MT) approximation for the potential. In this approximation the potential is\nconfined within non-overlapping spheres, where it is spherically symmetrized, and takes\na constant value in the interstitial region. Moreover, although spherical symmetry is not\nformally necessary, the condition that the bounding spheres do not overlap was thought\nto be necessary for the validity of the theory. Despite this approximation the method\nis complicated and demanding from a numerical point of view and as a band-structure\nmethod it was therefore superseded by more efficient linearized methods, such as the\nlinearized muffin-tin-orbital method (LMTO) [4] and the linearized augmented-planewave method (LAPW). [5]\nFull-potential versions of these band methods have also been introduced in recent\nyears. However, none of these methods can match the power and versatility of a fullpotential method based on the formalism of MST, either in terms of providing a complete\nsolution of the SE or in the range of problems that could be treated. In particular, none\nof these methods leads easily to the construction of the Green's Function (GF) which is\nindispensable in the study of a number of properties of many physical systems.\nDue to these reasons, in the last two decades, the KKR method has experienced\na revival in the framework of the Green's function method (KKR-GF). Indeed, due\nto the introduction of the complex energy integration, it was found that the method\nis well suited for ground-state calculations, with an efficiency comparable to typical\ndiagonalization methods. An host of problems became in this way tractable, ranging\nfrom solids with reduced symmetry (like e.g. isolated impurities in ordered crystal,\nsurfaces, interfaces, layered systems, etc..) to randomly disordered alloys in the coherent\npotential approximation (CPA).\nAt the same time it soon became clear that the MT approximation was not adequate\nto the treatment of systems with reduced symmetry or for the calculation of lattice forces\nand relaxation. In order to deal with these problems a number of groups developed a\nfull potential (FP) KKR-GF method, obtaining very good results, comparable with\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states3\nfull-potential LAPW method (FLAPW), for what concerns total energy calculations,\nlattice forces, relaxation around an impurity, ( [6, 7, 8, 9, 10] and Refs. therein).\nDue to their method of generating the single site solutions and the cell t-matrix, the\nadditional numerical effort required for the implementation of the FP-MS scheme scales\nonly linearly with the number of non-equivalent atoms and is not significantly greater\nthan in the MT case.\nIn this development the authors took an empirical attitude toward some\nfundamental problems related to the extension of MST to the full-potential case, like\nthe strongly debated question of the l-convergence of the theory or the need to converge\n\"internal\" sums arising from the re-expansion of the free Green's function around two\nsites, which entails the unwanted feature of the introduction of rectangular matrices\ninto the theory. [11] Without getting involved into ab initio questions, they just use\n0\nsquare matrices for the structural Green's Function Gnn\nLL0 (E) needed to calculate the\nGreen's Function of the system (see e.g. Eqs. (6) and (9) in Ref. [9]) and truncate the\nl-expansion to lmax = 3 or 4, obtaining in this way the same accuracy as the FLAPW\nmethod.\nSome observations are in order at this point. First, the FP method in the framework\nof MST has been initially developed only for periodic systems in two or three dimensions\nand for states below the Fermi level. To our knowledge, its extension to treat bound and\ncontinuum states of polyatomic molecules and in general real space applications of the\nmethod have progressed very slowly and have been scarce. Secondly, the generation of\nthe local solutions of the SE with truncated cells in the FP extension of the MST has up\nto now involved the expansion of the cell shape function in spherical harmonics, which\nmight create convergence problems, as discussed below. Thirdly, the FP extension of\nMST has generated a lot of controversies that have gone on for more than thirty years\n[12]. Some of the problems have found a solution and we refer the reader to the book of\nGonis and Butler [13] for a comprehensive review of the state of the art in this field (in\nparticular see their chapter 6). However, questions like the l-convergence of the theory\nor the use of square matrices are still matter of debate and some rigorous answer should\nbe given to them.\nAs mentioned above, applications to states well above the Fermi energy, as required\nin the simulations of x-ray spectroscopies, like absorption, photo-emission, anomalous\nscattering, etc..., have been scarce. In the words of Ref. [13], \"the feeling that one\nshould calculate the \"near-field-corrections\" (NFC), coupled with the need to solve a\nfairly complicated system of coupled differential equation to determine the local (cell)\nsolutions (based on the phase function method) has contributed greatly to the slow\ndevelopment of a FP method based on MST\". It was only after it was realized that\nNFC are not necessary and a new method to generate local solutions was found that\nprogress became faster, at least in the calculation of the electronic structure of solids.\n( [6, 7, 8, 9, 10] and Refs. therein) The only remaining drawback was and is the\ntruncation of the potential at the cell boundary which is still performed via a shape\nfunction expanded in spherical harmonics. Added to this there is the feeling that one\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states4\nshould still converge the \"internal\" sums leading to the use of rectangular matrices in the\nangular momentum (AM) indexes, although this last step is sometimes ignored without\njustifications. Last, but not least, the question of the l-convergence of the theory remains\nunsettled.\nFor all these reasons FP codes based on MST for the calculation of x-ray\nspectroscopies are not very numerous. We mention here the work by Huhne and Ebert\n[14] on the calculation of x-ray absorption spectra using the FP spin-polarized relativistic\nMST and that of Ankudinov and Rehr [15] in the scalar relativistic approximation.\nThese authors use the potential shape function to generate the local basis functions\nwhich are at the heart of MST. The expansion of the shape function and the cell potential\nin spherical harmonics leads to a high number of spherical components in the coupled\nradial equations that becomes progressively cumbersome to handle and time consuming\nwith increasing energy and in absence of symmetry. This feature might also be at the\norigin of another problem related with the saturation of \"internal\" sums in the MSE\n[13], as discussed later in this paper. Moreover no critical discussion is devoted in their\nwork to the l-convergence problems of MST or the use of square matrices in the theory.\nAnother code based on a version of the MST that uses non overlapping spherical\ncells and treats the interstitial potential in the Born approximation is that of Foulis et\nal. [16, 17] This method however treats in an approximate way the potential in the\ninterstitial region and moreover looses one of the major advantages of the MST, namely\nthe separation between dynamics and geometry in the solution of the scattering problem.\nFoulis [18] is now developing an exact FP-MS scheme based on distorted waves in the\ninterstitial region that seem to be promising, but its numerical implementation is still\nto come.\nThere are other codes that simulates x-ray spectroscopies and are not based on\nMST: that of Joly [19] is based on the discretization of the Laplacian in three dimensions\n(finite-difference method (FDM)), where the SE is solved in a discretized form on a threedimensional grid, the values of the scattering wave-function being the unknowns. This\nmethod is however limited to cluster sizes of the order of 20 atoms (without symmetry),\ndue to the high memory requirement when the number of mesh points increases with\nthe dimensions of the cluster. Finally a method based on the pseudo-potential theory\nto calculate x-ray absorption is worth mentioning. [20] It can easily cope with clusters\nof many atoms (300 and more) with a computational effort that scales linearly with the\nnumber of atoms. One of its drawback is its little physical transparency and the fact\nthat it has been applied only to calculate x-ray absorption spectra. Also, relaxation\naround the core hole must be taken into account by super-cell calculations and there is\nlittle flexibility to deal with energy-dependent complex potentials.\nThe purpose of the present paper is the rigorous derivation of a real space FP-MST,\nvalid both for continuum and bound states, that is free from the drawbacks hinted to\nabove, in particular the need to use cell shape functions and rectangular matrices,\nunder conditions for space-partitioning that are not excessively restrictive and easily\nimplemented (see beginning of Section 3). In connection with this we shall present a\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states5\nnew scheme to generate local basis functions for the truncated potential cells that is\nsimple, fast, efficient, valid for any shape of the cell and reduces to the minimum the\nnumber of spherical harmonics in the expansion of the scattering wave function. Finally\nwe shall also address the problem of the l-convergence of the theory, giving a positive\nanswer to this debated question.\nEven though this work is primarily motivated by applications in spectroscopy, it\nwill be clear from the context that bound states can be treated as well. Actually the\nmethod can also work for complex energy values, so that one can take advantage of the\nfact that the solution of the Schr\u00f6dinger equation is analytical in the energy plane, as\nis the associated Green's function, except for cuts and poles on the real axis. Therefore\nspectroscopy is only one regime of applications.\nSection 2 of this paper presents the new scheme to generate local basis functions and\ntests it against known solutions for potentials cells with and without shape truncation.\nSection 3 provides a new derivation of the FP-MST that allows us to work with square\nmatrices for the phase functions SLL0 and ELL0 and for the cell TLL0 matrix with only\none truncation parameter, contrary to the present accepted view. [13] Due to their\nimportance in the theory, various equivalent forms for the Green's function are presented\nin this scheme. This latter is extended to the calculation of bound states of polyatomic\nmolecules and tested against the known eigenvalues of the hydrogen molecular ion.\nSection 4 discusses the strongly debated problem of the l-convergence of the theory and\nprovides a truncation procedure that converges absolutely in the lmax \u2192 \u221e limit.\nSection 5 reports one additional application of the present FP-MS theory besides\nthose already presented in Ref.s [21] and [22], namely the calculation of the absorption\ncross section in the case of linear molecules (Br2 diatomic molecule), where the\nimprovement of over the MT approximation is quite dramatic. Moreover, with an eye\nto using the theory to study the performance of model optical potentials, Section 5 also\npresents a preliminary application of the non-MT (NMT) approach to the study of the\nrelative performance of the Hedin-Lundqvist (HL) and the Dirac-Hara (DH) potentials\nin the case of a transition metal. Finally Section 6 presents the conclusions of the present\nwork. A preliminary and partial account of this latter has been presented in Ref.s [21]\nand [22].\n2. Local Basis functions for single truncated potential cells\nA characteristic feature of MST is that it does not rely on a finite basis set for the\nexpansion of the global wave function inside each cell as all other methods of electronic\nstructure calculations do. Instead it relies on expanding the global solution in terms\nof local solutions of the Schr\u00f6dinger equation at the energy of interest, which can be\nregarded as an optimally small, energy adapted basis set [9]. Therefore it is essential\nfor the practical implementation of the theory to devise an efficient numerical method\nto generate them. We shall consider Williams and Morgan (WM) basis functions \u03a6L (r)\n[23] which inside each cell are local solutions of the SE and behave at the origin as JL (r)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states6\nfor r \u2192 0. Throughout the paper we shall use real spherical harmonics and shall put for\nshort JL (r; k) \u2261 jl (kr)YL (r\u0302), NL (r; k) \u2261 nl (kr)YL (r\u0302) and H\u0303L+ (r; k) \u2261 \u2212ikh+\nl (kr)YL (r\u0302),\nwhere jl , nl , hl denote respectively spherical Bessel, Neumann and Hankel functions of\norder l. The truncated cell potential V (r, r\u0302) is defined to coincide with the global\nsystem potential inside the cell and to be equal to zero (or to a constant) outside. As\nmentioned in the introduction we want to avoid the expansion of the truncated cell\nshape function (or equivalently of the truncated potential) in spherical harmonics due\nto convergence problems. However we observe that, even if the potential has a step,\nthe wave function and its first derivative are continuous, so that its angular momentum\nexpansion is well behaved and even converges uniformly in r\u0302. [24] Therefore we can\nP\nsafely write \u03a6L (r) = L0 RL0 L (r)YL0 (r\u0302) and this expression can be integrated term by\nterm under integral sign.\n2.1. Three-dimensional Numerov method\nIn order to generate the basis functions we write the SE in polar coordinates for the\nfunction PL (r) = r\u03a6L (r)\n\u0015\n\u0014 2\n1\nd\n+ E \u2212 V (r, r\u0302) PL (r, r\u0302) = 2 L\u03032 PL (r, r\u0302)\n(1)\n2\ndr\nr\nwhere L\u03032 is the angular momentum operator, whose action on PL (r, r\u0302) can be calculated\nas:\nX\nL\u03032 PL (r, r\u0302)=\nl0 (l0 + 1)rRL0 L (r)YL0 (r\u0302)\n(2)\nL0\n\nEquation (1) in the variable r looks like a second order equation with an\ninhomogeneous term. Accordingly we use Numerov's method to solve it. As is well\nL\n= PL (ri , r\u0302j ) and dropping for simplicity the index L, the associated\nknown, putting fi,j\nthree point recursion relation is\nAi+1,j fi+1,j \u2212 Bi,j fi,j + Ai\u22121,j fi\u22121,j = gi,j\n\nh6 vi\n\u2212\nf\n240 i,j\n\n(3)\n\nwhere,\nh2\nvi,j\n12\n5h2\n=2+\nvi,j = 12 \u2212 10Ai,j\n6\n= V (ri , r\u0302j ) \u2212 E\nh2\n= [qi+1,j + 10qi,j + qi\u22121,j ]\n12\n1 X 0 0\nl (l + 1)ri RL0 L (ri )YL0 (r\u0302j )\n= 2\nri L0\n\nAi,j = 1 \u2212\nBi,j\nvi,j\ngi,j\nqi,j\n\n(4)\n\nHere i is an index of radial mesh and j an index of angular points on a Lebedev\nP\nsurface grid. [25] Obviously ri RL0 L (ri ) =\nj wj PL (ri , r\u0302j )YL0 (r\u0302j ), where wj is the\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states7\nweight function for angular integration associated with the chosen grid. The number\nof surface points NLeb is given by NLeb \u2248 (2lmax + 1)2 /3 as a function of the maximum\nangular momentum used [26], taking into account that one integrates the product of two\nspherical harmonics. As it is, we cannot use Eq. (3) to find fi+1,j by iteration, from the\nknowledge of fi,j and fi\u22121,j at all the angular points, since the \"inhomogeneous\" term\nqi+1,j is not expressible in terms of fi+1,j due to the last line of Eq. (4) and is calculated\nat the radial mesh point i + 1.\nWe first eliminate this point from the expression of gi,j , observing that\nh2\n[qi+1,j + 10qi + qi\u22121,j ]\n12 \u0014\n\u0015\nh2 qi+1,j \u2212 2qi + qi\u22121,j 2\n=\nh + 12qi,j\n12\nh2\n\ngi,j =\n\n(5)\nThe second order central difference is given by [27]\nqi+1 \u2212 2qi + qi\u22121 = h2 qi00 +\n\nh4 iv\nh6 vi\nh8 viii\nqi +\nqi +\nq + ***\n12\n360\n20160 i\n\n(6)\n\nso that\ngi,j\n\nh2\n\u223c\n12\n\n\u0014\u0012\n\u0013\n\u0015\nh2 iv\n00\n2\nqi,j + qi,j h + 12qi,j\n12\n\n(7)\n\nomitting errors of order h6 and higher.\n00\nNow for the second derivative qi,j\nwe use the backward formula [27]\n7h2 iv\nqi,j \u2212 2qi\u22121,j + qi\u22122,j\n000\n+\nhq\n\u2212\nq .\ni,j\nh2\n12 i,j\nto avoid the contribution of the point i + 1. Inserting Eq. (8) into Eq. (7)\n00\nqi,j\n=\n\n(8)\n\nh2\nh5 000\nh6 iv\n[13qi,j \u2212 2qi\u22121,j + qi\u22122,j ] + qi,j\n\u2212 qi,j\n(9)\n12\n12\n24\nwhich is the formula we wanted to arrive at. Therefore our modified Numerov procedure\nbecomes:\nh5 000\nAi+1,j fi+1,j \u2212 Bi,j fi,j + Ai\u22121 fi\u22121,j = gi,j + qi,j\n(10)\n12\nwhere,\ngi,j \u223c\n\nh2\npi,j\n12\n5h2\nBi,j = 2 +\npi,j = 12 \u2212 10Ai,j\n6\nh2\ngi,j =\n[13qi,j \u2212 2qi\u22121,j + qi\u22122,j ]\n(11)\n12\nwhich now needs three backward points to start.\nThe appearance of the third r derivative of qi000 in Eq. (10), which is strictly infinite at the\nstep point, does not cause practical problems. Although not necessary, one can always\nAi,j = 1 \u2212\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states8\nassume a smoothing of the potential at the cell boundary \u00e0 la Becke, [28] reducing at\nthe same time the mesh h, so that the error at that particular step point is negligible.\nIn this way, at the cost of a bigger error O(h5 ) compared to the original Numerov\nformula and the introduction of a further backward point (three points i, i \u2212 1 and\ni \u2212 2 are now involved in (11)), the three-dimensional discretized equation can be solved\nalong the radial direction for all angles in an onion-like way, provided the expansion\n(2) is performed at each new radial mesh point to calculate qi,j . We use a log-linear\nmesh \u03c1 = \u03b1 r + \u03b2 ln r, to reduce numerical errors around the origin and the bounding\nsphere. [29]\n2.2. Matrix Numerov method\nIt is well known that errors in the Numerov difference equation originating from the\nunidimensional differential equation\n\u0015\n\u0014 2\nl(l + 1)\nd\n+E\u2212\n\u2212 V (r) Pl (r) = 0\n(12)\ndr2\nr2\ngrows exponentially when E \u2212 l(l + 1)/r2 \u2212 V (r) \u2264 0. Therefore near the origin and in\ngeneral for large r meshes and/or high l values the method is not suitable. This is also\ntrue for Eq. (1). To avoid this problem we use the so called Gaussian elimination for\nthe difference equation [30, 31, 32]. We notice that in the MT sphere lying inside the\ncell the AM expansion of the potential is regular and in general only few multipoles are\nappreciable. Therefore, by projecting onto YL (r\u0302) we can rewrite Eq. (1) as [33]\n\u0012\n\u0013\nZ\nd2\nl(l + 1)\n\u2212 2+\n\u2212 E XL L0 (r) + dr\u0302 YL (r\u0302) V (r)PL0 (r) = 0\n(13)\ndr\nr2\ni.e.\n\u0013\n\u0015\nX \u0014\u0012 d2\nl(l + 1)\n\u2212 E \u03b4LL00 + VLL00 (r) XL0 L00 (r)\n\u2212 2+\n2\ndr\nr\n00\nL\n= F(r)X\u0303(r) = 0\nwhere XL L0 (r) = r RL L0 (r), X\u0303 is its transposed,\nZ\nVLL0 (r) = VL0 L (r) = dr\u0302 YL (r\u0302) V (r) YL0 (r\u0302)\n\n(14)\n\n(15)\n\nand\n(F(r))LL0 = (F(r))L0 L\n\u0014\u0012\n\u0013\n\u0015\nd2\nl(l + 1)\n=\n\u2212 2+\n\u2212 E \u03b4LL0 + VLL0 (r)\ndr\nr2\n\n(16)\n\nEq. ( 14 ) is a system of coupled radial Schr\u00f6dinger equations in matrix form that\ncan be solved simultaneously for all L, L0 components with appropriate initial conditions.\nThe Numerov recursion relation for the matrix SE [33] is (notice the change of sign\nof the coefficient B for sake of later convenience)\nAi+1 X\u0303i+1 + Bi X\u0303i + Ai\u22121 X\u0303i\u22121 = 0\n\n(17)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states9\nh2\nPi\n12\n5h2\n\u2212 Bi = 2 +\nPi = 12 \u2212 10Ai\n6\n\u0014\n\u0015\nl(l + 1)\n(Pi )L L0 = VL L0 (ri ) +\n\u2212 E \u03b4L L0\nri2\n\nAi = 1 \u2212\n\nwhere i is the generic point of the radial mesh. Its explicit matrix form is,\n\uf8eb\n\uf8f6\n\uf8f6 \uf8eb\n\uf8eb\n0\n\uf8ec A0 B 1 A2\n\uf8f7 X\u03030\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8ec\nA1 B 2\nA3\n\uf8ec\n\uf8f7 \uf8ec 0\n\uf8f7 \uf8ec X\u03031\n\uf8ec\n\uf8f7 = \uf8ec ..\n\uf8f7\n\uf8ec\n.\n.\n.\n.\n..\n..\n..\n\uf8ec\n\uf8f7 \uf8ed ..\n\uf8f8 \uf8ed .\n\uf8ed\n\uf8f8\nX\u0303M +1\n0\nAM \u22121 BM AM +1\n\nO\n\nO\n\n(18)\n\n\uf8f6\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f8\n\n(19)\n\nSince the regular solution has the boundary condition, X0 = 0 we can rewrite this latter\nequation as\n\uf8f6\n\uf8eb\n\uf8eb\n\uf8f6 \uf8eb\n\uf8f6\nX\u0303\n0\nB\nA\n1\n1\n2\n\uf8f7\n\uf8ec\n\uf8f7 \uf8ec X\u03032 \uf8f7 \uf8ec\n\uf8f7\n\uf8ec A1 B 2\n0\nA3\n\uf8f7\n\uf8f7\uf8ec\n\uf8f7 \uf8ec\n\uf8ec\n=\n(20)\n\uf8f7\n\uf8ec\n\uf8ec\n\uf8f7\n\uf8f7\n\uf8ec\n.\n.\n.\n.\n.\n..\n..\n..\n..\n\uf8f7 \uf8ed .. \uf8f8 \uf8ed\n\uf8ec\n\uf8f8\n\uf8f8\n\uf8ed\nX\u0303M\n\u2212AM +1 X\u0303M +1\nA\nB\n\nO\n\nO\n\nM \u22121\n\nM\n\nThis set of equations can be solved by performing forward Gaussian elimination near\nthe origin, [30, 31, 32]\n\uf8eb\n\uf8f6\n\uf8f6\n\uf8f6 \uf8eb\n\uf8eb\n0\n\uf8ec D1 A 2\n\uf8f7 X\u03031\n\uf8f7\n\uf8f7 \uf8ec\n\uf8ec\n\uf8f7 \uf8ec X\u03032\n0\nD2 A3\n\uf8f7\n\uf8f7 \uf8ec\n\uf8ec\n\uf8f7\uf8ec\n\uf8ec\n\uf8f7\n\uf8f7\n\uf8ec\n\uf8ec\n\uf8f7\n..\n.\n...\n...\n\uf8f7 (21)\n\uf8f7=\uf8ec\n\uf8ec\n\uf8f7 \uf8ec ..\n.\n\uf8f7\n\uf8f7 \uf8ec\n\uf8ec\n\uf8f7\uf8ec\n\uf8ec\n\uf8f7 \uf8ed X\u0303M \u22121 \uf8f8 \uf8ed\n\uf8f8\n0\nD\nA\nM\n\u22121\nM\n\uf8ed\n\uf8f8\nX\u0303M\n\u2212AM +1 X\u0303M +1\nDM\n\nO\n\nO\n\nwith\nD1 = B 1 ,\nD2 = B2 \u2212 A1 D\u22121\n1 A2 ,\n...,\nDi = Bi \u2212 Ai\u22121 D\u22121\ni\u22121 Ai , (i = 1, ..., M )\n\n(22)\n\nconstituting a set of forward recurrence relations for the quantities Di . In terms of these\nlatter we finally obtain the following recurrence relations:\nX\u0303i = \u2212D\u22121\ni Ai+1 X\u0303i+1 , (i = 1, ..., M )\n\n(23)\n\nthe solution of which can be calculated backward starting from X\u0303M +1 = I, modulo a\nconstant normalization matrix. As will be clear from the following, this initial matrix\nin practice will not be needed. Summarizing, our strategy to generate the cell basis\nfunctions PL (r) = r\u03a6L (r) is the following. In a spherical domain around the origin,\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states10\ninside which there are no discontinuities of the potential, we use the matrix Numerov\nmethod with Gaussian elimination (GE), since we can expand the potential in a well\nbehaved series of spherical harmonics. We use the GE method to avoid the well\nknow instability of the Numerov recursion relation near the origin when the angular\nmomentum l is high, as mentioned above. As boundary conditions we use X\u03030 = 0 at the\norigin and X\u0303M +1 = I at the radius of the sphere, which is usually taken to coincide with\nthe MT sphere inscribed in the cell. We then take the last three points of the solution\nso obtained to start the 3-d modified Numerov procedure outward across the potential\ndiscontinuity up to the cell bounding sphere. Since the local SE we are dealing with is\nan homogeneous equation, its solution is determined up to an arbitrary normalization\nconstant (reflected in the second arbitrary condition X\u0303M +1 = I ). For the basis functions\nPL (r) we never need such a constant, since only ratios of these functions appear in MS\nTheory, as clear in the following. Instead, when we compare with a definite solution, like\nin Fig.s 1 and 2 below, we need to provide the value of this solution at another point,\nusually the radius of the sphere. This means taking a value for X\u0303M +1 appropriate for\nthis solution.\nIt is also clear that the method can also be applied to generate by inward integration\nthe irregular solutions needed to calculate the Green's function.\nThis procedure is quite efficient and was tested against analytically solvable,\nseparable model potentials, with and without shape truncation, obtaining very good\nresults. In Ref. [22] we have shown the comparison between the analytical solution and\nthe numerical one for certain directions in the special case of the truncated potential\nV (x, y, z) = a \u03b8(|x| \u2212 Rc ) + b \u03b8(|y| \u2212 Rc ) + c \u03b8(|z| \u2212 Rc ), where \u03b8 is the step function, Rc\n= 3.78 au = 2.0 \u00c5 and a = \u22120.05, b = \u22120.1, c = \u22120.15 Ryd, for an energy E = 0.3\nRyd. For this comparison we used an lmax = 7 and a number of surface points on the\nLebedev grid equal to 266.\nFig. 1 shows the same comparison in the more stringent case of a discontinuity of\nthe order of one Ryd. We took indeed a = \u22120.5, b = \u22121.0, c = \u22121.5 Ryd for E = 0.3\nRyd. In this case, along the z direction, one can even observe a kink in the curvature\nof the solution, which is well reproduced and related to the discontinuity of the second\nderivative at the truncation value of Rc = 2.0 \u00c5. As expected, for good agreement we\nhad to increase lmax up to 11 and take a number of Lebedev points equal to 1454. Notice\nhere that the numerical method to generate the solution is really three-dimensional and\ndoes not take advantage of the separability of the analytical one. For this comparison we\nused the Matrix Numerov method with GE up to Rc = 2.0 \u00c5 = 3.78 au, then switched\nto 3-d Numerov. Due to the high potential step in this case, we took a number N of\nradial mesh points given by N = 834.\nIn order to test the reliability of the method also in the case of a potential which is\nnot truncated but varies substantially in sign and magnitude inside the defining region,\nwe show in Fig. 2 the same comparison for the Mathieu functions, solution of the\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states11\n1.4\n\nRe ! : analytical\nRe ! : calculated\nIm ! : analytical\nIm ! : calculated\n\n1.2\n1\n0.8\n0.6\n0.4\n0.2\n0\n!0.2\n!0.4\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\nz!axis ( \u00c5 )\n\nFigure 1. Real and imaginary part of the numerical solution of the SE along z\ndirection for the separable truncated potential given in the text, compared to the\nanalytical one. (Color online)\n\nseparable SE with periodic boundary conditions\n\u0015\n\u0014 2\nd2\nd2\nd\n+\n+\n\u03c8(x, y, z)\ndx2 dy 2 dz 2\n= (\u2212ax \u2212 ay \u2212 az + 2qx cos 2x + 2qy cos 2y + 2qz cos 2z)\u03c8(x, y, z)\n\n(24)\n\nfor the case where\nqx = 1.0,\n\nax = \u22120.455139,\n\nparity = even, period = \u03c0\n\nqy = 0.3,\n\nay = \u22120.044566,\n\nparity = even, period = \u03c0\n\nqz = 1.0,\n\naz = +1.859110,\n\nparity = even, period = 2\u03c0\n\nThe energy eigenvalue is E = 1.359405, lmax = 20 and the number of surface points is\ngiven by 1730. For the convenience of the reader the Mathieu functions are described\nin Appendix A. The number of radial mesh points was equal to 250. Also in this case\nwe employed both methods of integration with a switch radius of 2.45 au.\nIn general the minimum number of surface points is chosen according to the rule\nR\nthat to integrate exactly d\u03a9YL (\u03a9) we need \u2248 (l + 1)2 /3 points. [25] If we want to\nintegrate the product of two Spherical Harmonics, l should be the sum of the individual\nl0 s; the same for a product three, etc... So for the 3-d Numerov we need to integrate\nonly a product of two functions whose expansions are both truncated to a certain lmax ,\ntherefore the number of points is (2lmax + 1)2 /3, whereas for the truncated separable\npotential and the Mathieu functions we have the product of three functions (one for each\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states12\n\u03b8 = 78.87 deg, \u03c6 = \u221271.45 deg\n\n\u03b8 = 28.33 deg, \u03c6 = \u2212123.80 deg\n\n6\n\n1\n\nExact\nCalc.\n\n0\n\n5\n\nr \u03a6 ( r ) ( in a. u. )\n\nr \u03a6 ( r ) ( in a. u. )\n\n\u22121\n4\n\n3\n\n2\n\n\u22122\n\u22123\n\u22124\n\n1\n\n\u22125\nExact\nCalc.\n\n0\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nr ( in a. u. )\n\n3\n\n3.5\n\n4\n\n\u22126\n4.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n\u03b8 = 115.04 deg, \u03c6 = 70.64 deg\n\n2.5\nr ( in a. u. )\n\n3\n\n3.5\n\n4\n\n4.5\n\n\u03b8 = 110.65 deg, \u03c6 = 149.43 deg\n\n2\n\n3\n\nExact\nCalc.\n\nExact\nCalc.\n\n2.5\n\n1\n\n2\nr \u03a6 ( r ) ( in a. u. )\n\n0\nr \u03a6 ( r ) ( in a. u. )\n\n2\n\n\u22121\n\u22122\n\u22123\n\n1.5\n1\n0.5\n0\n\n\u22124\n\n\u22120.5\n\n\u22125\n\n\u22121\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nr ( in a. u. )\n\n3\n\n3.5\n\n4\n\n4.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nr ( in a. u. )\n\n3\n\n3.5\n\n4\n\n4.5\n\nFigure 2. Comparison of the particular Mathieu function described in the text with\nthe one generated by matrix and 3-d Numerov method at four different angles. The\nswitch radius was at 2.45 au. (Color online)\n\nspace coordinate), so we need (3lmax + 1)2 /3 points. Moreover for the matrix Numerov\nmethod we again have (3lmax + 1)2 /3 due to the calculation of VLL0 .\n2.3. A linear-logarithmic mesh\nTo solve Eq. (1) by Numerov procedure, there are several choices for the radial mesh.\nDue to the singularity of the potential near the origin we found that the best strategy\nin our case was to take a mixed logarithmic and linear mesh, as usual in atomic physics.\n[29, 30, 32] For non-MT calculation, especially with truncated potential, this mesh is\nthe appropriate choice. In this case the new radial variable is\n\u03c1 ( r ) = \u03b1 r + \u03b2 ln r\n\n(25)\n\nwith \u03b1 and \u03b2 constant. A constant mesh size of \u03c1 can be taken in the interval\n\u03c10 \u2264 \u03c1 \u2264 \u03c1N . The initial value of \u03c10 is chosen according to the empirical formula\n\u03c10 = \u2212\u03b2 ( 10 + ln Z )\n\n(26)\n\nwhereas the final \u03c1 is defined as\n\u03c1N = \u03c10 + N h\n\n(27)\n\nso that \u03b1 is given by\n\u03b1 = (\u03c1N \u2212 \u03b2 ln rN )/rN\n\n(28)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states13\ntaking \u03b2, the mesh size h and the number of points N as input values. In the calculation\nof local basis functions we choose rN equal to the radius of the cell bounding sphere Rb ,\n\u03b2 = 1.0 and put N \u2248 100Rb . Instead for Fig.s 1 and 2 we took respectively \u03b2 = 0.67\nand \u03b2 = 0.05. The value of r = r(\u03c1) corresponding to a given value of \u03c1 can be readily\nfound by application of the Newton technique. [32]\nFollowing the change of variable in Eq. (25) the SE in Eq. (14) becomes\nF(\u03c1)Y(\u03c1) = 0 where\n\n(F(\u03c1))LL0\n\u0013\u22122\n\u0012\n\u0014(\n\u03b2\nd2\n=\n\u2212 2 + \u03b1+\nd\u03c1\nr\n\u0013\u001b\n\u0012\nl(l + 1) + \u03b2 ( \u03b1 r + \u03b2/4 )( \u03b1 r + \u03b2 )\u22122\n\u2212E\n\u03b4LL0\n\u00d7\nr2\n\u0012\n\u0013\u22122\n\u0015\n\u03b2\n+ \u03b1+\nVLL0 (r)\nr\nr\n\u03b2\nY(\u03c1) = \u03b1 + X ( r )\nr\n\n(29)\n\nwhere r = r(\u03c1). The same, mutatis mutandis, applies to Eq. (1) for the threedimensional Numerov method.\nA comment is in order at this point. Strictly speaking by changing to the loglinear mesh the Eq.s (18-23) are not valid anymore, since r = 0 cannot be realized (it\nwould correspond to \u03c1 = \u2212\u221e) and therefore not explicitly implemented as boundary\ncondition. By working out again the Gaussian elimination process when X0 is not zero,\none arrives at the same equations (22), except that in the rhs term the zero of the i-th\n\u22121\nrow is replaced by Ai\u22121 Di\u22121\nA0 Y0 , where Y0 is the value of (29) calculated at the first\npoint \u03c10 . Now\ns\np\np\n\u03b2\nYLL0 (\u03c1) = \u03b1 +\nXLL0 (r(\u03c1)) = \u03b1r(\u03c1) + \u03b2 r(\u03c1)RLL0 (r(\u03c1))\n(30)\nr(\u03c1)\nSince\nat the origin RLL0 is diagonal in l and behaves like a spherical Bessel function,\np\nr(\u03c1)RLL (r(\u03c1)) is of the order of 10\u22123 for l=0 at \u03c10 \u2248 10\u22125 , 10\u22128 for l=1 etc.. We can\ntherefore take Y0 = 0 and use the simplified Gaussian elimination formulas Eq.s (18-23).\nWe checked that this is a good approximation also for l=0.\n3.\n\nMultiple scattering method for scattering and bound states\n\n3.1. Scattering states\nWe begin by presenting the derivation of MSE for scattering states. In this case we seek\na solution of the SE continuous in the whole space with its first derivatives, satisfying\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states14\nthe asymptotic boundary condition\n\u0013 12 \u0014\n\u0015\n\u0012\neikr\nk\nik*r\ne + f (r\u0302; k)\n\u03c8(r; k) '\n16\u03c0 3\nr\n\n(31)\n\nwhere k is the photo-electron wave-vector and f (r\u0302; k) is the scattering amplitude. The\n1\nfactor (k/(16\u03c0 3 )) 2 takes into account the normalization of the scattering states to one\nstate per Ryd. In the spirit of MST we partition the space in terms of non overlapping\nspace-filling cells \u03a9j with surfaces Sj and centers at Rj . Accordingly we partition the\nP\noverall space potential V (r) into cell potentials, such that V (r) =\nj vj (rj ), where\nvj (rj ) takes the value of V (r) for r inside cell j and vanishes elsewhere. As clear from\nthe following the zero value of the potential outside the cell is not necessary and can be\nreplaced by any constant. The results will not depend on this particular value. Here and\nin the following rj = r \u2212 Rj . The partition is assumed to satisfy the requirement that\nthe shortest inter-cell vector Rij = Ri \u2212 Rj joining the origins of the nearest neighbors\ncells i and j, is larger than any intra-cell vector ri or rj , when r is inside cell i or cell j.\nIf necessary, empty cells can be introduced to satisfy this requirement. We also assume\nthat there exists a finite neighborhood around the origin of each cell lying in the domain\nof the cell. [12] We then start from the following identity involving surface integrals in\ndr\u0302 \u2261 d\u03c3\nN Z\nX\n\u0002 + 0\n\u0003\n0\nG0 (r \u2212 r; \u03ba)\u2207\u03c8(r; k) \u2212 \u03c8(r; k)\u2207G+\n0 (r \u2212 r; \u03ba) * nj d\u03c3j\nSj\n\nj=1\n\nZ\n=\n\n\u0002 + 0\n\u0003\n0\nG0 (r \u2212 r; \u03ba)\u2207\u03c8(r; k) \u2212 \u03c8(r; k)\u2207G+\n0 (r \u2212 r; \u03ba) * no d\u03c3o .\n\n(32)\n\nSo\n\nP\n0\nHere \u03a9o = j \u03a9j , with surface So , centered at the origin o and G+\n0 (r \u2212 r; \u03ba) is the\nfree Green's function with outgoing wave boundary conditions satisfying the equation\n0\n0\n2\n(\u22072 + \u03ba2 ) G+\n0 (r \u2212 r; \u03ba) = \u03b4(r \u2212 r), where \u03ba = E \u2212 V0 and V0 is an arbitrary constant\nequal to the assumed value of the cell potential outside the cell domain. The identity\n(32)is valid for all r0 lying in the neighborhood of the origin of each cell, since in this\ncase the integrands are continuous with their first derivatives.\nIn this context we shall\n\u221a\n\u221a\nuse two distinct k-vectors, defined respectively as k = E and \u03ba = E \u2212 V0 . This\n0\nletter will appear in the expansion of the Green's function G+\n0 (r \u2212 r; \u03ba) by spherical\nfunctions. [16] Obviously k = \u03ba for V0 = 0.\nEquation (32), with the choice V0 = 0, can also be derived from the LippmannSchwinger equation\nZ\n0\nik*r0\n0\n3\n\u03c8(r ; k) = e\n+\nG+\n(33)\n0 (r \u2212 r; k) V (r) \u03c8(r; k) d r\nsatisfied by the scattering state (see Appendix C ). However we prefer to start from\nthe identity Eq. (32) to take advantage of the arbitrariness of the constant V0 . For\nconvenience of the reader we recall the expansions [13]\nX\neik*r\n= 4\u03c0\nil YL (k\u0302)JL (r; k)\n(34)\nL\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states15\n0\n\n0\nG+\n0 (r\n\n1 ei\u03ba|r \u2212r|\n\u2212 r; \u03ba) = \u2212\n4\u03c0 |r0 \u2212 r|\n0\n= G+\n0 (ri \u2212 ri ; \u03ba)\nX\n=\nJL (r0i ; \u03ba)H\u0303L+ (ri ; \u03ba) (ri0 < ri )\n\n(35)\n\nL\n\n=\n\nX\n\nJL (ri ; \u03ba)H\u0303L+ (r0i ; \u03ba) (ri0 > ri )\n\n(36)\n\nL\n\nNotice for future reference that in the case \u03ba = 0 the solid spherical harmonics\nJL (r; \u03ba) and H\u0303L+ (r; \u03ba) are to be understood as J L (r) = rl YL (r\u0302)/(2l + 1) and H L (r) =\nr\u2212l\u22121 YL (r\u0302), due to the well known expansion\nX 4\u03c0 rl\n1\n<\n=\nYL (r\u0302) YL (r\u03020 )\n(37)\nl+1\n0\n|r \u2212 r |\n2l + 1 r>\nL\nwhich is the \u03ba \u2192 0 limit of Eq.s (35) and (36).\nThe heart of MST is the introduction of the functions \u03a6L (rj ; k) which inside cell j\nare local solutions of the SE with potential vj (rj ) behaving as JL (rj ; k) for rj \u2192 0. They\nform a complete set of basis functions such that the global scattering wave function can\nbe locally expanded as [12]\nX j\n\u03c8(rj ; k) =\nAL (k)\u03a6L (rj ; k)\n(38)\nL\n\nwhere we have underlined the k dependence of \u03a6L (rj ; k) through its behavior at the\norigin.\nIn order to find the asymptotic behavior in the outer region C\u03a9o we introduce the\nscattering functions in response to an exciting wave of angular momentum L:\nZ\n0\n0\n0\n3 0\n\u03c8L (ro ; k) = JL (ro ; k) +\nG+\n(39)\n0 (ro \u2212 ro ; k) V (ro ) \u03c8L (ro ; k) d ro\nThen, under the assumption of short range potentials (i.e. potentials that behave like\n1/r1+\u000f with positive \u000f at great distances), letting ro \u2192 \u221e and using expansion Eq. (36)\nin Eq. (39) we find\n\u0014\nX\no\n\u03c8(ro ; k) =\n\u00c3L (k) JL (ro ; k)\nL\n\n+\n\nX\n\nH\u0303L+0 (ro ; k)\n\nZ\n\nJL0 (r0o ; k) V\n\n(r0o ) \u03c8L (r0o ; k) d3 r0o\n\n\u0015\n(40)\n\nL0\n\n=\n\nX\nL\n\n\u0014\n\n\u00c3oL (k)\n\nJL (ro ; k) +\n\nX\n\nH\u0303L+0 (ro ; k)TLo0 L\n\n\u0015\n(41)\n\nL0\n\nwhere, in order to impose the asymptotic behavior in Eq. (31), \u00c3oL = il YL (k\u0302) (k/\u03c0)1/2\no\nand TLL\n0 is the T -matrix for the whole cluster, equal to\nZ\no\n(42)\nTL0 L = JL0 (ro ; k) V (ro ) \u03c8L (ro ; k) d3 ro\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states16\nIn general for short range potentials decaying slowly, the asymptotic behavior in Eq.\n(41) is reached only at great distance from the origin of the coordinates (usually at the\ncenter of the atomic cluster under study). In order to limit the number of cells, so that\nthe surface So just surrounds the cluster, we introduce the local solution\nX\n\u03a6L (ro ; k) =\nRLo 0 L (ro ) YL0 (r\u0302o )\n(43)\nL0\n\nin the outer region C\u03a9o , which can be obtained by inward integration of the SE starting\nfrom the appropriate asymptotic value H\u0303L+0 (ro ; k). Therefore we take here\ni\nXh\n\u03c8(ro ; k) =\n\u00c3oL (k)JL (ro ; k) + \u03a6L (ro ; k)AoL (k)\n(44)\nL\n\nNotice that the function \u03a6L (ro ; k) in Eq. (43) (and consequently RLo 0 L (ro ) ) is complex,\nunlike the functions \u03a6L (ri ; k) that can be taken real, if the potential is real. If the\npotential has a Coulomb tail, the spherical Bessel and Hankel functions should be\nreplaced by the corresponding regular and irregular solutions FL (ro ; k) and GL (ro ; k) of\nthe radial SE with a Coulomb potential. Due to the possibility that the optical potential\nused for calculating the spectroscopic response functions be complex, it should be clear\nfrom the context that the formalism works also for complex energies and/or potentials.\nThe extension to complex energies will come very handy when exploiting the analytic\nproperties of the Green function.\nInsertion of the expressions Eq.s (38) and (44) into the identity Eq. (32) provides a\nset of algebraic equations (known as MSE) that determine the expansion coefficients\nAjL (k) and the AoL (k) in such a way that the local representations are smoothly\ncontinuous across the common boundary of contiguous cells. Indeed, taking r0 in the\nneighborhood of the origin of cell i 6= o, using the expansion Eq. (35) (since r is\nconfined to lie on the cell surfaces), and putting to zero the coefficients of JL (r0i ; \u03ba) due\nto their linear independence, we readily arrive at the MST compatibility equations for\nthe amplitudes AjL (k) and AoL0 (k)\ni\nX ij j\nXh\no\nio\no\nio\n(45)\nMLL\nHLL0 AL0 (k) =\n0 \u00c3L0 (k) + NLL0 AL0 (k)\nL0\n\njL0\n\nwhere\nij\nHLL\n0\n\nZ\n\n[ H\u0303L+ (ri ; \u03ba)\u2207\u03a6L0 (rj ; k) \u2212 \u03a6L0 (rj ; k)\u2207H\u0303L+ (ri ; \u03ba) ] * nj d\u03c3j\n\n=\nSj\n\nio\nMLL\n0 =\n\nZ\n\n[ H\u0303L+ (ri ; \u03ba)\u2207JL0 (ro ; k) \u2212 JL0 (ro ; k)\u2207H\u0303L+ (ri ; \u03ba) ] * no d\u03c3o\n\nSo\nio\nNLL\n0 =\n\nZ\n\n[ H\u0303L+ (ri ; \u03ba)\u2207\u03a6L0 (ro ; k) \u2212 \u03a6L0 (ro ; k)\u2207H\u0303L+ (ri ; \u03ba) ] * no d\u03c3o\n\nSo\n\nA further set equation is obtained by taking r0 inside the outer region C\u03a9o , using\nthe expansion Eq. (36) (remembering that ro < r0o , since ro lies on So ). By putting to\nzero the coefficients of H\u0303L+ (r0o ; \u03ba) we obtain\ni\nX oj j\nXh\noo\no\noo\no\nKLL0 AL0 (k) =\nM\u0303LL\n(46)\n0 \u00c3L0 (k) + \u00d1LL0 AL0 (k)\njL0\n\nL0\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states17\nwhere\noj\nKLL\n0\n\nZ\n[ JL (ro ; \u03ba)\u2207\u03a6L0 (rj ; k) \u2212 \u03a6L0 (rj ; k)\u2207JL (ro ; \u03ba) ] * nj d\u03c3j\n\n=\nSj\n\noo\nM\u0303LL\n0\n\nZ\n[ JL (ro ; \u03ba)\u2207JL0 (ro ; k) \u2212 JL0 (ro ; k)\u2207JL (ro ; \u03ba) ] * no d\u03c3o\n\n= \u03b4LL0\nSo\n\noo\n\u00d1LL\n0\n\nZ\n[ JL (ro ; \u03ba)\u2207\u03a6L0 (ro ; k) \u2212 \u03a6L0 (ro ; k)\u2207JL (ro ; \u03ba) ] * no d\u03c3o\n\n=\nSo\n\nFrom the above derivation it is clear that the set of equations in Eq.s (45) and (46)\ndetermines the amplitudes AjL (k) and AoL (k) independently of the constant V0 , since\nthe identity Eq. (32) is valid whatever V0 . In general this will be true only if the Lexpansion is not truncated, whereas there will be a more or less pronounced dependence\naccording to the degree of convergence of the truncated expansion. In general, the lesser\nthe potential jump at the boundaries of the various cells the faster the convergence.\nNotice that these equations remain valid, with no restriction on the sums over L,\neven in the case \u03ba = 0, provided JL and H\u0303L are replaced by J L and H L , due to the\nexpansion Eq. (37) of the zero energy limit of the free Green's Function.\nThe usual derivation of the MSE now proceeds by re-expanding H\u0303L+ (ri ; \u03ba) and\nJL (ro ; \u03ba) around center j under the geometrical conditions stated at the beginning of\nthis section, by use of the equations [13, 16]\nX ij\nH\u0303L+ (ri ; \u03ba) =\nGLL0 JL0 (rj ; \u03ba) (Rij > rj )\n(47)\nL0\n\nJL (ro ; \u03ba) =\n\nX\n\noj\nJLL\n0 JL0 (rj ; \u03ba) (no cond.)\n\n(48)\n\nL0\n\nH\u0303L+ (ri ; \u03ba) =\n\nX\n\n+\nio\nJLL\n0 H\u0303L0 (ro ; \u03ba) (ro > Rio )\n\n(49)\n\nL0\n\nwhere Gij\nLL0 are the free electron propagator in the site and angular momentum basis (\nKKR real space structure factors) given by\nX\n0\n00\nGij\n=\n4\u03c0\nC(L, L0 ; L00 ) il\u2212l +l H\u0303L+00 (Rij ; \u03ba)\n(50)\n0\nLL\nL00\nij\nand JLL\n0 is the translation operator\nX\n0\n00\nij\nC(L, L0 ; L00 ) il\u2212l +l JL00 (Rij ; \u03ba)\nJLL\n0 = 4\u03c0\n\n(51)\n\nL00\n\nIn these formulas the quantities C(L, L0 ; L00 ) are the real basis Gaunt coefficients given\nby\nZ\n0\n00\nC(L, L ; L ) = YL (\u03a9)YL0 (\u03a9)YL00 (\u03a9)d\u03a9\n(52)\nIn the following we shall also need the quantity\nX\n0\n00\nij\nNLL\nC(L, L0 ; L00 ) il\u2212l +l NL00 (Rij ; \u03ba)\n0 = 4\u03c0\nL00\n\n(53)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states18\nUnfortunately the re-expansions Eq.s (47), (48) and (49) introduce further\nexpansion parameters into the theory (with related convergence problems) that are\nactually unnecessary, as shown below.\nWe in fact observe that the integrals over the surfaces of the various cells j can\nbe calculated over the surfaces of the corresponding bounding spheres (with radius Rbj )\nby application of the Green's theorem, since both H\u0303L+ (r; \u03ba) and \u03a6L (r; k) satisfy the\nHelmholtz equation (\u22072 + \u03ba2 ) F (r) = 0 outside the domain of the cell. We then use the\nfollowing relations\nZ\nj\nYL0 (r\u0302j ) H\u0303L+ (ri ; \u03ba) d\u03c3j = (Rbj )2 Gij\n(54)\nLL0 jl0 (\u03baRb )\nSj\n\nZ\n\nYL0 (r\u0302j )\u2207 H\u0303L+ (ri ) * nj d\u03c3j = (Rbj )2 Gij\nLL0\n\nSj\n\nd\nj\n0\nj jl (\u03baRb )\ndRb\n\n(55)\n\nwhich are exact for all L provided |ri \u2212 rj | = Rij > rj for r lying on the surface Sj . This\nis a consequence of the fact that under this condition the series in Eq. (47) converges\nabsolutely and uniformly in the entire angular domain, as shown in Appendix B, Eq.\n(B.7) and can therefore be integrated term by term. This property is also true for\nthe series derived with respect to r. Even though not necessary, we also checked the\nnumerical equality of both sides of Eq.s (54) and (55) for various values of L, L0 .\nSimilarly, since the series in Eq. (49) converges uniformly and absolutely, as shown\nin Appendix B, Eq. (B.8), we also find\nZ\n+\nio\no\nYL0 (r\u0302o ) H\u0303L+ (ri ; \u03ba) d\u03c3j = (Rbo )2 JLL\n(56)\n0 h\u0303l0 (\u03baRb )\nSo\n\nZ\n\nio\nYL0 (r\u0302o )\u2207 H\u0303L+ (ri ) * nj d\u03c3j = (Rbo )2 JLL\n0\n\nSo\n\nd +\nh\u0303 (\u03baRbo )\no l0\ndRb\n\n(57)\n\nprovided Rio < Rbo , where Rbo is the bounding sphere of the outer region C\u03a9o . Therefore\nRbo should be bigger than any Rio .\nFinally, due to the absolute and uniform convergence of the series in Eq. (48)\nwithout conditions, we find the following relations\nZ\nj\nij\nYL0 (r\u0302j ) JL (ri ; \u03ba) d\u03c3j = (Rbj )2 JLL\n(58)\n0 jl0 (\u03baRb )\nSj\n\nZ\n\nij\nYL0 (r\u0302j )\u2207 JL (ri ) * nj d\u03c3j = (Rbj )2 JLL\n0\n\nSj\n\nd\nj\n0\nj jl (\u03baRb )\ndRb\n\n(59)\n\nBy inserting in Eq. (45) the expression for the basis functions expanded in spherical\nharmonics (we shall suppress the site indices whenever a relation refers to both sites i\nand site o)\nX\n\u03a6L (r; k) =\nRL0 L (r)YL0 (r\u0302)\n(60)\nL0\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states19\nremembering that this expansion is uniformly convergent in the angular domain [24] and\nusing the relations Eq.s (54)-(59) we finally obtain, under the partitioning conditions\nspecified at the beginning of Section 3,\nX\n\ni\ni\nELL\n0 AL0 (k)\n\n+\n\nj6=i\nX\n\nj\nj\nGij\nLL00 SL00 L0 AL0 (k)\n\nj,L0 ,L00\n\nL0\n\n\"\n=\n\nX\n\n#\n\nio\nJLL\nMLoo0 L0 \u00c3oL0 (k) +\n0\n\nX\n\nL0\n\nELo 0 L00 AoL00 (k)\n\n(61)\n\nL00\n\noo\nwhere we have put ELo 0 L00 \u2261 NLoo0 L00 , the quantities MLL\nand NLoo0 L00 being the same as\nthose following Eq.(45), calculated with ri replaced by ro .\no\noo\nSimilarly, putting SLL\n0 \u2261 \u00d1LL0 , for Eq. (46) we find\nj6=o\nX\n\noj\nj\nj\nJLL\n00 SL00 L0 AL0 (k) =\n\nj,L0 ,L00\n\nXh\n\ni\noo\no\no\no\nM\u0303LL\n0 \u00c3L0 (k)\u03b4LL0 + SLL0 AL0 (k)\n\n(62)\n\nL0\n\nIn the above equations we have defined the quantities\nELL0 = (Rb )2 W [\u2212i\u03bah+\nl , RLL0 ]\n\n(63)\n\nSLL0 = (Rb )2 W [jl , RLL0 ]\n\n(64)\n\nfor the cells \u03a9j and for the outer region C\u03a9o . The Wronskians W [f, g] = f g 0 \u2212 gf 0 are\ncalculated at Rbj and Rbo respectively and reduce to diagonal matrices for MT potentials.\nEquations (61) and (62) look formally similar to the usual MSE. However we notice\nthat due to the relations Eq.s (54)-(59) there are only two expansion parameters in the\ntheory. They are related to the AM components of RL0 L in the expansion Eq. (60)\nin cell j and in the outer region C\u03a9o . No convergence constraints related to the reexpansion of the various spherical Bessel and Hankel functions around a different origin\nEq.s (47)-(49) are present.\nIt is interesting to note that the truncation value for both indices is the same\nand corresponds to the classical relation lmax = kRbj , where Rbj is the radius of the\nbounding sphere of the cell at site j. This is true for the index L, which reminds that\nthe basis function \u03a6L is normalized like jl (kr)YL near the origin. Due to the properties\nof the spherical Bessel functions, when l \u001d kRbj , \u03a6L becomes very small inside the cell,\ndecreasing like [(2l + 1)!!]\u22121 . Therefore his weight in the expansion Eq. (60) will be\nnegligible. The other index L0 , as will be clear from the following, measures the response\nof the truncated potential inside the cell to an incident wave JL0 of angular momentum\nL0 . Due to the same argument as above, familiar to scattering theory, the scattering\nmatrix TLj 0 L will decrease like [(2l + 1)!!(2l0 + 1)!!]\u22121 (see Eq. (B.10) in Appendix B for\nl, l0 \u001d kRbj ). As a consequence E j and S j can be considered square matrices. In the case\nof the outer sphere region C\u03a9o , the situation is inverted, the index L being related to\nthe response of the entire cluster to an incident wave of angular momentum L, whereas\nthe index L0 corresponds to the number of AM waves mixed in by the potential not\nonly inside \u03a9o but also in C\u03a9o . The two indices have the same truncation lmax = k R\u0303bo ,\nprovided we take R\u0303bo as the radius of the sphere that contains the region of space where\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states20\nthe potential is substantially different from zero. This conclusion is reinforced by the\nobservation that one can cover this same region by empty cells.\nUp to this point we have assumed that V0 6= 0 and derived consequently the MSE,\nhaving in mind the possibility to check the rate of convergence of the L-expansion.\nHowever in the continuum case one usually works under the assumption that V0 = 0.\nIn this case the Eq.s (61) and (62) simplify considerably in the case of short range\npotentials. Since now k = \u03ba, we use the relation\nZ\n[ H\u0303L+0 (ro ; k)\u2207JL (ro ; k) \u2212 JL (ro ; k)\u2207H\u0303L+0 (ro ; k) ] * nj d\u03c3o = \u2212\u03b4LL0\n(65)\nSo\noo\noo\nso that in Eq. (61) MLL\n= \u22121, and in Eq. (62) M\u0303LL\n= 0. Moreover one easily finds\nthat\nr\nX\nk\nio\nl\nik*Rio\n= ILi (k)\n(66)\n\u00c3oL0 (k)JLL\n0 = i YL (k) e\n\u03c0\nL0\n\nwhich is obtained from Eq. (51) by observing that\nX\nC(L, L0 ; L00 )YL0 (\u03a9) = YL (\u03a9)YL00 (\u03a9)\nL0\n\nThen the two sets of equations assume the simpler form\nX\n\ni\ni\nELL\n0 AL0 (k)\n\n+\n\nL0\n\nj6=i\nX\n\nj\nj\nGij\nLL00 SL00 L0 AL0 (k)\n\nj,L0 ,L00\n\n\u2212\n\nX\n\nio\no\no\ni\nJLL\n0 EL0 L00 AL00 (k) = \u2212IL (k)\n\n(67)\n\nL0 L00\nj6=o\nX\n\noj\nj\nj\nJLL\n00 SL00 L0 AL0 (k) \u2212\n\nj,L0 ,L00\n\nX\n\no\no\nSLL\n0 AL0 (k) = 0\n\n(68)\n\nL0\n\nThe fact that E and S can be taken to be square matrices leads to another interesting\nform of the MSE. Under the assumption that Det S 6= 0, we can introduce new\namplitudes\nX\nBL (k) =\nSLL0 AL0 (k)\n(69)\nL0\n\nwhich is equivalent to using new basis functions \u03a6L related to \u03a6L by the relation\nX\n\u03a6L =\n(S\u0303 \u22121 )LL0 \u03a6L0\n(70)\nL0\n\nwhere S\u0303 is the transposed of the matrix S.\nDefining the quantities\n(T i )\u22121 = \u2212E i (S i )\u22121\no\n\nT = \u2212E o (S o )\u22121\n\n(71)\n(72)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states21\n(notice the asymmetry between sites i and site o) we can write Eqs. (67) and (68) as\nj6=i\nX\nX\nj\ni \u22121\ni\nGij\n(T )LL0 BL0 (k) \u2212\nLL0 BL0 (k)\nj,L0\n\nL0\n\n\u2212\n\nX\n\no\n\ni\nio\no\nJLL\n0 T L0 L00 BL00 (k) = IL (k)\n\n(73)\n\nL0 L00\nj6=o\nX\n\noj\nj\no\nJLL\n0 BL0 (k) \u2212 BL (k) = 0\n\n(74)\n\nj,L0\n\nThe meaning of the amplitudes BL (k) is immediately found from these equations if we\no\nconsider only a single truncated potential at center i. In this case T \u2261 0, since now the\nP\no\no\no\nasymptotic behavior is given by Eq. (41), and BLo (k) \u2261 AoL (k) = L0 TLL\n0 \u00c3L0 where TLL0\ni\no\nis the T -matrix of the potential. Therefore Eqs. (73) and (74) tell us that TLL\n0 \u2261 TLL0 .\nAs a consequence BLi (k) is the scattering amplitude of angular momentum L in response\nto an exciting plane wave of wave vector k. Moreover, we find that T i = \u2212S i (E i )\u22121 is\nsymmetric in the AM indices (remember that we use a real spherical harmonics basis),\na fact already known from general scattering theory. This is a consequence of the fact\nthat SE \u22121 is a symmetric matrix. [34]\nIn the case of many cells, it is expedient to work only in terms of the cell amplitudes\ni\nBL0 (k). Inserting into Eq. (73) the expression for BLo 0 (k) given by Eq. (74) we obtain\nj6=i\nX\nX\nj\ni \u22121\ni\n(T )LL0 BL0 (k) \u2212\nGij\nLL0 BL0 (k)\nL0\n\nj,L0\n\n\u2212\n\nXX\njL0\n\no\n\nio\nT \u039b\u039b0 J\u039boj0 L0 BLj 0 (k) = ILi (k)\nJL\u039b\n\n(75)\n\n\u039b\u039b0\no\n\nIntroducing \u03c4 , the inverse of the multiple scattering matrix M \u2261 T \u22121 \u2212 G \u2212 JT J\no\n\n\u03c4 = (T \u22121 \u2212 G \u2212 JT J)\u22121\nknown as the scattering path operator [13], we derive from Eq. (75) that\nX ij j\n\u03c4LL0 IL0 (k)\nBLi (k) =\n\n(76)\n\n(77)\n\njL0\n\nIf we insert this expression in Eq. (74) and remember that by definition BLo (k) =\nP\no\no\nL0 TLL0 \u00c3L0 , we easily find for the cluster T -matrix\nXX\no\noi ij\n(78)\nTLL\nJL\u039b\n\u03c4\u039b\u039b0 J\u039bjo0 L0\n0 =\nij\n\n\u039b\u039b0\n\nSince the matrices G and J are also symmetric (see definitions Eq.s (50) and (51)), we\nfind that \u03c4 is likewise symmetric, implying the symmetry of TLo0 L , again in keeping with\nscattering theory. This quantity represents indeed for the whole cluster the scattering\namplitude into a spherical wave of angular momentum L in response to an exciting wave\nof AM L0 and is needed for example in electron molecular scattering. [33] Finally Eq.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states22\n(77) shows that the quantities BLi (k) are scattering amplitudes for the cluster, for which\nthe generalized optical theorem holds (for real potentials) [33, 16] (see Appendix D)\nZ\n\u0002\n\u0003\u2217\n1\nij\n(79)\ndk\u0302 BLi (k) BLj 0 (k) = \u2212 = \u03c4LL\n0\n\u03c0\nThis relation is very important, since it establishes the connection between the photoemission and the photo-absorption cross section, as shown in Appendix E. As it will\nii\nturn out, \u2212= \u03c4LL\nis proportional to the L-projected density of states onto site i.\nIn the case of one single cell located at site i, by construction the solutions inside\nand outside the cell are continuously smooth so that, remembering that by definition\ni\no\ni\nTLL\n0 \u2261 TLL0 , for ri = ro = Rb we have, neglecting for simplicity from now on the k\ndependence of the local solutions,\n#\n\"\nX\nX\nX\nH\u0303L+0 (ro ; k)TLi 0 L\n\u00c3oL (k) JL (ro ; k) +\n(80)\nBLi (k)\u03a6L (ri ) =\nL0\n\nL\n\nL\n\nUsing Eq. (77) for a single site and equating the coefficients of \u00c3oL (k) we find at the\nbounding sphere the relation\nX\nX\n(\u1ebc)\u22121\n\u03a6L0 (ri )TLi 0 L =\nLL0 \u03a6L0\nL0\n\nL0\n\n\u2261 \u03a6L\n= JL (ro ; k) +\n\nX\n\nH\u0303L+0 (ro ; k)TLi 0 L\n\n(81)\n\nL0\n\nimplying that the basis functions \u03a6L are scattering functions, obeying the LippmannSchwinger equation for the cell potential. Therefore, introducing new expansion\ncoefficients CL (k) such that locally\nX\nCL (k)\u03a6L (r)\n\u03c8(r; k) =\n(82)\nL\n\nand repeating the steps leading to the MSE in this new basis, we obtain\nCLi (k)\n\n\u2212\n\nj6=i\nX\n\nj\nj\nGij\nLL00 TL00 L0 CL0 (k) \u2212\n\nio\no\ni\nJLL\n0 CL0 (k) = IL (k)\n\n(83)\n\nL0\n\nj,L0 L00\nj6=o\nX\n\nX\n\noj\nj\nj\nJLL\n00 TL00 L0 CL0 (k) =\n\nX\n\no\n\no\n(T )\u22121\nLL0 CL0 (k)\n\n(84)\n\nL0\n\nj,L0 L00\n\nComparing these equations with the previous ones in Eqs. (73), (74) and (67), (68) we\nimmediately find the relations\nX j\nBLj (k) =\nTLL0 CLj 0 (k)\n(85)\nL0\n\nBLo (k)\n\n=\n\nX\n\no\n\no\n(T )\u22121\nLL0 CL0 (k)\n\n(86)\n\nELL0 AL0 (k)\n\n(87)\n\nL0\n\nCL (k) =\n\nX\nL0\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states23\nIn the present approach, the three forms of pair of equations (67)-(68), (73)-(74) and\n(83)- (84) are equivalent and lead to the same result.\nThe pair of equations (83)-(84) are quite important, since they provide the formal\njustification that in MST one can work with square matrices, provided that the only\nindexes appearing in the theory are those of the radial functions RLL0 (r). This is a\nconsequence of the relation (B.9) of Appendix B (second equation) and the fact that\nthe matrix elements TLL0 have a common truncation parameter lmax . In fact, since\nT r(T \u2020 T ) < \u221e due to the asymptotic behavior of the TLL0 matrix elements given by Eq.\n(B.10) in the same Appendix, one can safely define an inverse for the matrix TLL0 (E)\n(except at poles on the negative energy axis) and pass from one representation to the\nother. In particular one can pass from the set (83)-(84) to the set (67)-(68). In the\ntraditional derivation of MS equations, that does not rely on the relations (54)-(59) but\nhinges on the re-expansion formulas (47)-(49), this equivalence does not hold. In fact the\nneed to saturate the \"internal\" sum over L00 coming from the re-expansion introduces\na further expansion parameter and therefore rectangular matrices into the theory. This\nfeature makes it impossible to define a T -matrix and to write a closed form for the\nGF, loosing all the advantages of MST over other methods. This drawback has been\navoided in our approach, since in each step of the derivation of the MS equations we\nhave shown that the introduction of summation indices other than those present in the\nradial functions RL0 L (r) is unnecessary.\nAnother useful consequence of the fact that the theory can be cast in terms of\nsquare matrices is the possibility to exploit the point symmetry of the cluster under\nstudy. Even though many authors have treated the problem of how to symmetrize the\nMSE, this was done in the framework of the MT theory, where the cell T-matrices are\ndiagonal in the AM indices. New features appear in the more general case (in particular\nhow to calculate the symmetrized version of the TLL0 matrices) and Appendix F deals\nwith this situation. Needless to say, we checked in all applications that the symmetrized\nand unsymmetrized version of the theory gave the same results. The application of\nthe symmetrization procedure to Green's Functions or to periodic systems is rather\nstraightforward.\nAs already anticipated in the introduction, one of the major advantages of MST is\nthe direct access to the Green's Function of the system. Having explicit expressions for\nthis quantity is of the utmost importance both for writing down spectroscopic response\nfunctions (see Ref. [35]) and for the calculation of ground state properties through\ncontour integration in the complex energy plane (see e.g. Ref. [9] and references therein).\nThe GF is solution of the Schr\u00f6dinger equation with a source term\n(\u22072 + E \u2212 V (r) ) G(r, r0 ; E) = \u03b4(r \u2212 r0 ).\n\n(88)\n\nIn the framework of MST and for general (possibly complex) potentials, the solution\nof this equation in the case of a finite cluster can be written as [13, 36]\nG(ri , r0j ; E) = h \u03a6(ri ) | ( \u03c4 ij \u2212 \u03b4ij T i ) | \u03a6(r0j ) i\n+ \u03b4ij h \u03a6(r< ) | T i | \u03a8(r0> ) i\n\n(89)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states24\nwhere r< (r> ) indicates the lesser (the greater) between ri and ri0 . The function \u03a8(r) is\nthe irregular solution in cell i that matches smoothly to H\u0303L+0 (r) at Rbi . For short we have\nsaturated the sum over the angular momentum indices using a bra and ket notation (e.\ng.)\nX\nij\n0\n(90)\nh \u03a6(ri ) | \u03c4 ij | \u03a6(r0j ) i =\n\u03a6L (ri ) \u03c4LL\n0 \u03a6L0 (rj )\nLL0\n\nMoreover, for simplicity of presentation we have assumed no contribution from the outer\no\nregion potential (i.e. T \u2261 0) allowing empty cells to cover the volume \u03a9o up to the\npoint at which the asymptotic behavior in Eq. (41) starts to be valid. The modifications\no\nneeded in the case T 6= 0 are obvious. In the case of a crystal we have to work in Fourier\nspace [9].\nNow, from Eq. (81) written as\nX\n\u03a6L (ri ) =\nJL0 (ro ; k)(T \u22121 )iL0 L + H\u0303L+ (ro ; k)\n(91)\nL0\n\nby continuity we derive inside cell i the relation\nX\n\u03a6L (ri ) =\n\u039bL0 (ri ; k)(T \u22121 )iL0 L + \u03a8L (ri ; k)\n\n(92)\n\nL0\n\nwhere \u039bL0 (ri ) is the irregular function joining smoothly to JL0 (ro ; k) at Rbi . Therefore\nthe Green's function takes the form\nG(ri , r0j ; E) = h \u03a6(ri ) | \u03c4 ij | \u03a6(r0j ) i\n\u2212 \u03b4ij h \u03a6(r< ) | \u039b(r0> ) i\n\n(93)\n\nFor real potentials, both \u03a6L and \u039bL are real, so that the singular atomic term\ndoes not contribute to the imaginary part of the GF. In this case the quantity\nR\nR\nP\n2\nii\n(E) \u03a9i \u03a6L (r) d3 r is the projected density of states\n\u2212= \u03a9i G(r, r; E) d3 r = \u2212 L = \u03c4LL\non site i at energy E, expressed as a sum of the partial densities of type L. This relation\n(not r-integrated) constitutes the basis for calculating the system density by contour\nintegration in the complex energy plane.\nAlternative forms of the GF that are independent of the normalization of the local\nsolutions \u03a6L (ri ) can be easily obtained in terms of the S and E matrix. For example\nwe have\nG(ri , r0j ; E)\n= \u2212 h \u03a6(ri ) | {([ S\u0303 E + S\u0303G S ]\u22121 )ij \u2212 \u03b4ij ([ S\u0303 E ]\u22121 )ii } | \u03a6(r0j ) i\n\u2212 \u03b4ij h \u03a6(r< ) | E \u22121 | \u03a8(r0 > ) i\n\n(94)\n\nwhich is seen to reduce to the following expression, remembering the definition of | \u03a6 i,\nG(ri , r0j ; E) = h \u03a6(ri ) | ( [ I \u2212 G T ]\u22121 G )ij | \u03a6(r0j ) i\n\u2212 \u03b4ij h \u03a6(r< ) | \u03a8(r0 > ) i\n\n(95)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states25\nIndeed from the relation,\n(A + B)\u22121 \u2212 A\u22121 = (A + B)\u22121 (A \u2212 (A + B)) A\u22121\n= \u2212 (A + B)\u22121 BA\u22121\n= \u2212 (B \u22121 A + 1)\u22121 A\u22121\n= \u2212 (AB \u22121 A + A)\u22121\n\n(96)\n\nwe find\n[ S\u0303 E + S\u0303 G S ]\u22121 \u2212 [ S\u0303 E ]\u22121 = \u2212 [ S\u0303 E + S\u0303 E [ S\u0303 G S ]\u22121 S\u0303 E ]\u22121\n= \u2212 [ S\u0303 E + S\u0303 E [ G S ]\u22121 E ]\u22121\n= \u2212 E \u22121 [ S\u0303 + S\u0303 E [ G S ]\u22121 ]\u22121\n= \u2212 E \u22121 [ S\u0303 + \u1ebc S [ G S ]\u22121 ]\u22121\n= E \u22121 [ T \u2212 G\u22121 ]\u22121 \u1ebc \u22121\n= \u2212 E \u22121 [ I \u2212 G T ]\u22121 G \u1ebc \u22121\n\n(97)\n\ntaking into account that S\u0303 E = \u1ebc S and T = \u2212SE \u22121 = \u2212\u1ebc \u22121 S\u0303. All these forms are\nequivalent as long as we can treat the matrices S and E as square.\n3.2. Bound states\nEven though the essential of this section has been presented in a conference proceedings\n[22], we feel that for the sake of completeness of presentation and convenience of the\nreader it should be repeated here.\nThe MSE in the case of bound states can be derived from those for scattering\nstates, by simply eliminating the exciting plane wave in Eq. (109) and taking the\n0\nanalytical continuation to negative energies in free Green's function G+\n0 (r \u2212 r; k), in\norder to impose the boundary condition of decaying waves when r0 \u2192 \u221e. In this case\nthe Lippmann-Schwinger equation reduces to the eigenvalue equation\nZ\n0\n0\n3\n(98)\n\u03c8(r ) =\nG+\n0 (r \u2212 r; k) V (r) \u03c8(r) d r\nwhere we have dropped the label k in the wave function \u03c8(r0 ). Since the expansion\n0\n(35)\nof G+\n0 (r \u2212 r; k) in terms of spherical Bessel and Hankel functions in Eqs.\nand (36)\ncontinuation to negative energies, so that\np valid under the analytical\n\u221a remain\n0\n0\n0\nk = E = i |E| = i\u03b3, we see that \u03c8(r ) behaves like eikr /r0 = e\u2212\u03b3r /r0 for r0 \u2192 \u221e.\nWe remind that\n\u2212\n\u2212l\n1\n\u2212l\nl\n2\nh+\nl (kr) = \u2212i Kl (\u03b3r); hl (kr) = \u2212i (\u22121) Kl (\u03b3r)\n(\u22121)l+1 Kl1 + Kl2\njl (kr) = il Il (\u03b3r);\nnl (kr) = il+1\n(99)\n2\nwhere Il is the modified Bessel and Kl1 , Kl2 the modified Hankel functions of first and\nsecond kind, respectively. Not only the expansions in Eqs. (35) and (36), but also\nthe re-expansion relations in Eqs. (47), (48) and (49) remain valid under analytical\ncontinuation with the same convergence properties (see Appendix B). This fact implies\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states26\nthat we can derive the MSE for bound states following the same patterns as for scattering\nstates, except that now the behavior of the wave function in the outer region C\u03a9o is\nX\n\u03c8(ro ) =\nAoL \u03a6oL (ro )\nL\n\n=\n\nX\n\nAoL\n\nX\n\nRLo 0 L (ro ) YL0 (r\u0302o )\n\n(100)\n\nL0\n\nL\n\nThe functions \u03a6oL (ro ) are now real and can easily be found by inward integration in the\nouter region starting from an asymptotic WKB solution properly normalized, e.g. like\n[(2l + 1)!!]\u22121 .\nWorking with the BL amplitudes we easily arrive at the following condition for the\nexistence of a bound state\n)\n(\nX\nX\no\noj\nij\ni \u22121\nio\n(101)\n(T )LL0 \u03b4ij \u2212 (1 \u2212 \u03b4ij ) GLL0 \u2212\nJLL0 T L0 L00 JL00 L0 BLj 0 = 0\njL0\n\nL0 L00\n\nwhich is the same as Eq. (75), except that the exciting plane wave term ILi (k) and the\nk dependence have been dropped. Notice that we have kept the arbitrariness of V0 in\nthe free Green's function, in order to check that the eigenvalues do not depend on it. In\nthe spirit of the analytical continuation, we have a definite rule on how to calculate the\nvarious quantities as a function of \u03ba.\nWe now define\nCLL0 = (Rb )2 W [nl , RLL0 ]\n\n(102)\n\nso that, remembering Eq. (72)\n\u03ba\u22121 (T j )\u22121 = (K j )\u22121 + i = \u2212C j (S j )\u22121 + i\no\n\no\n\n\u03ba\u22121 T = K + i = \u2212C o (S o )\u22121 + i\n\n(103)\n(104)\n\nMoreover we observe that\nij\nij\n\u03ba\u22121 Gij\nLL0 = NLL0 \u2212 iJLL0\n\n(105)\n\noj\nij\nij\nio\nwhere NLL\n(53) and that\n0 is defined in Eq.\nL00 JLL00 JL00 L0 = JLL0 , since J is the\ntranslational operator. Substituting these relations into Eq. (101) and eliminating the\ncommon factor \u03ba\u22121 we finally find\n)\n(\nX\nX\no\nij\noj\nio\n(106)\n(K i )\u22121\nJLL\nBLj 0 = 0\n0 K L0 L00 JLL0\nLL0 \u03b4ij \u2212 (1 \u2212 \u03b4ij ) NLL0 \u2212\n\nP\n\nL0 L00\n\njL0\n\nThe generic (LL0 )-element of this MS matrix is either real for real \u03ba (E \u2212 V0 > 0) or\n0\nproportional to il\u2212l +1 for imaginary \u03ba (E \u2212 V0 < 0). Indeed, due to the relations Eq.\n(99), putting for short Kl = [(\u22121)l+1 Kl1 + Kl2 ]/2, we easily find that\nX\n0\n00\nNLL0\n= 4\u03c0il\u2212l +1\nC(L, L0 ; L00 ) (\u22121)l Kl00 (|\u03ba|Rij )YL00 (Rij )\nL00\n\n(K i )\u22121\nLL0\no\nK LL0\n\n= \u2212i\n\nl\u2212l0 +1\n\n\u0002\n\n= \u2212i\n\nl\u2212l0 +1\n\n\u0002\n\nC i (S i )\u22121\no\n\n\u0003\n\no \u22121\n\nC (S )\n\n0\n\n\u0003LL\n\nLL0\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states27\nwhere C and S are defined in terms of the modified spherical Bessel and Neumann\nfunctions as the corresponding quantities.\nTherefore the condition for a bound state becomes Det M = 0, where M is the MS\nmatrix in Eq. (106) after a unitary transformation that eliminates the imaginary\nfactors. In the practical numerical implementation we find the zeros of the determinant\nof Det (KM ), excluding the spurious solutions coming from the zeros of Det S. In this\nform, the procedure is equivalent to finding the poles of the GF in the form Eq. (95)\non the real negative axis, as it should be. Still numerical instabilities might come from\nthe inverse of S o present in the contribution of the outer sphere region. This unwanted\nfeature could be eliminated by working with the AL , instead of the BL amplitudes.\n\nIII\n\nI\n\nx\n\nII\n\nFigure 3. Partitioning of the space for the hydrogen molecular ion with no empty\ncells.\n\nWe applied the theory above to find the exact eigenvalues of the hydrogen molecular\nion, since this test is considered rather stringent for the validity of the theory due to\nrapid variation of the potential in the molecular region and to the awkward geometry of\nthe cells. In this case we partition the space in three regions, as illustrated in Fig. 3, two\ntruncated spheres around the protons with a radius of 1.72 a.u. corresponding to cells\n\u03a9I and \u03a9II and an external region labeled \u03a9III , corresponding to the complementary\ndomain C\u03a9o . The bounding sphere of this latter is represented by the dashed circle with\nradius 1.4 a.u., bigger than one half the distance of the protons, as discussed after Eq.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states28\nTable 1. Eigenvalues of the hydrogen molecular ion (in Ryd)\nMol.\n\nnlm\n\nExact\n\norb.\n\nSmith &\n\nFoulis [34]\n\nJohnson[37]\n\n22 EC\n\n22 EC\n\nNo EC\n\nNo EC\n\nV0 =-1.90\n\nV0 = 0\n\nV0 =-1.90\n\nV0 = 0\n\n1a1g\n\n100\n\n-2.20525\n\n-2.0716\n\n-2.18973\n\n-2.20522\n\n-2.2055\n\n-2.2050\n\n-2.2048\n\n2a1g\n\n200\n\n-0.72173\n\n-0.70738\n\n-0.72093\n\n-0.723\n\n-0.724\n\n-0.731\n\n-0.726\n\n3a1g\n\n320\n\n-0.47155\n\n-0.45574\n\n-0.47102\n\n-0.4727\n\n-0.478\n\n-0.476\n\n-0.474\n\n4a1g\n\n300\n\n-0.35536\n\n-0.34859\n\n-0.35525\n\n-0.356\n\n-0.3550\n\n-0.357\n\n-0.356\n\n1a2u\n\n210\n\n-1.33507\n\n-1.2868\n\n-1.33426\n\n-1.3348\n\n-1.3348\n\n-1.3342\n\n-1.3343\n\n2a2u\n\n310\n\n-0.51083\n\n-0.49722\n\n-0.51085\n\n-0.51072\n\n-0.5105\n\n-0.5104\n\n-0.5104\n\n3a2u\n\n410\n\n-0.27463\n\n-0.26979\n\n-0.27466\n\n-0.27469\n\n-0.2742\n\n-0.2745\n\n-0.2745\n\n4a2u\n\n430\n\n-0.25329\n\n-0.24997\n\n-0.25329\n\n-0.254\n\n-0.2536\n\n-0.2541\n\n-0.25301\n\n1e1g\n\n321\n\n-0.45340\n\n-0.44646\n\n-0.45333\n\n-0.4545\n\n-0.45332\n\n-0.455\n\n-0.455\n\n1e1u\n\n211\n\n-0.85755\n\n-0.88866\n\n-0.85585\n\n-0.85754\n\n-0.8561\n\n-0.870\n\n-0.858\n\n(57). By calling the region outside this circle C\u03a9b , the potential is taken to be zero (or\nconstant) into the intersection of this domain with cells \u03a9I and \u03a9II , and equal to the\nvalue of the true potential in the intersection with C\u03a9o . We also did a calculation with\nthe two atomic cells, 22 empty cells surrounding them, plus an external region.\nIt should be noticed that treatment of bound state is done here in analogy to the\nX-\u03b1 MST method [3], since we intend to put the theory to a severe test concerning\nthe independence of the eigenvalues from the value of the interstitial constant V0 and\nthe partitioning of the space. More modern techniques that avoid finding eigenvalues\nand eigenstates of the molecular cluster in the course of a SCF-iteration, exploit the\nanalyticity of the GF through a contour integration in the complex energy plane to find\ndirectly the molecular density, as mentioned in the introduction and in Section 3.1.\nOur findings are listed into Table (1) and compared with the exact results. The last\ntwo columns show the eigenvalues obtained with two different values of V0 , respectively\nequal to -1.90 Ryd and 0, showing the 'quasi' independence of the results from the\nconstant interstitial value V0 . The columns with the label '22 EC' refer to the calculation\nwith two atomic cells, 22 empty cells and an external region, showing the 'quasi'\nindependence of the result from the partitioning mode of the space. We attribute the\nslight dependence of the eigenvalues on V0 and the partitioning mode to the numerical\ninstabilities mentioned above and the L-truncation of the matrices.\nThe column labeled 'Smith & Johnson' refers to the calculation by Smith and\nJohnson [37] in the MT approximation, whereas the one labeled 'Foulis' quotes the\nresult by Foulis [34] obtained within the distorted wave approximation.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states29\n4. Convergence of Full Potential Multiple Scattering Theory\nThe inversion of the MS matrix becomes computationally heavy at high photoelectron\nenergies because of the large number of angular momenta involved, since lmax \u2248 kRb . A\ncommon way to circumvent this difficulty is to invert the MS matrix by series, whereby\nX\n(T \u22121 \u2212 G)\u22121 = T\n(GT )n .\n(107)\nn\n\nWhile this series is absolutely convergent for nonoverlapping MT spheres, provided the\nspectral radius of the matrix GT is less than one [38], it is known to diverge for the case\nof space-filling cells. This is easily seen by using the inequality (B.11) in Appendix B,\nputting l = l0 \u001d lmax , whereby\n\u0010 2R \u00112l+1\nb\n(108)\n|Gll Tll | \u2248 Rb\nRij\nwhich signals the divergence of the matrix element (GT )ll (for space-filling cells 2Rb >\nRij , at least for nearest neighbors).\nHowever due to the behavior shown by Eq. (108) there is a widespread belief that\nthe procedure of inverting exactly an l truncated MS matrix and then letting l go to \u221e\ndoes not converge in the case of space-filling cells. We shall show in the following that\nthis is not so, provided a slight modification of the free propagator G is adopted.\nIn order to illustrate our point, let us start by solving the Lippmann-Schwinger\nequation using the theory of the integral equations, before applying MST.\nZ\n0\nik*r0\n0\n3\n\u03c8(r ; k) = e\n+\nG+\n(109)\n0 (r \u2212 r; k) V (r) \u03c8(r; k) d r\nWe cannot use Fredholm theory, since the Kernel for this integral equation\n0\n\n1 eik*|r \u2212r|\nK(r , r) = \u2212\nV (r)\n4\u03c0 |r0 \u2212 r|\n0\n\n(110)\n\nis such that\n\u2020\n\nZ Z\n\ndrdr0 K? (r0 , r) K(r0 , r)\n\u0012 \u00132 Z Z\nV (r)2\n1\n=\ndrdr0 0\n4\u03c0\n|r \u2212 r|2\n\u0012 \u00132 Z Z\n|V (r)|2\n1\ndrdr0 0\n\u2264\n4\u03c0\n|r \u2212 r|2\n\nT r(K K) =\n\n(111)\n\nand obviously diverges.\nHowever a solution for this problem can be found by following the argument of\nsection 10.3, page 280 of Ref. 39 in the paper (Newton). We multiply the LippmannSchwinger equation Eq. (109) by |V (r0 )|1/2 and write V (r) = |V (r)|v(r), where v(r) is\na sign factor, equal to +1 where the potential is positive and to \u22121 where it is negative.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states30\nThen we obtain\n\u03c8s (r0 ; k) \u2261 |V (r0 )|1/2 \u03c8(r0 ; k)\n0\n\n= |V (r0 )|1/2 eik*r\nZ\n0 1/2\n0\n1/2\n+ |V (r )|\nG+\nv(r) \u03c8s (r; k) d3 r\n0 (r \u2212 r; k) |V (r)|\n\n(112)\n\nThe Kernel for this integral equation is given by\n0\n\nik*|r \u2212r|\n1\n0 1/2 e\n|V (r)|1/2 v(r)\nKs (r , r) = \u2212 |V (r )|\n0\n4\u03c0\n|r \u2212 r|\n0\n\n(113)\n\nwhereby\nT r(K\u2020s Ks )\n\nZ Z\n\ndrdr0 K? (r0 , r) K(r0 , r)\n\u0012 \u00132 Z Z\n1\nV (r) |V (r0 )|\n=\ndrdr0\n4\u03c0\n|r0 \u2212 r|2\n\u0012 \u00132 Z Z\n1\n|V (r)| |V (r0 )|\n\u2264\ndrdr0\n4\u03c0\n|r0 \u2212 r|2\n=\n\n(114)\n\nwhich is finite for a large class of potentials (including the molecular ones), so that the\nkernel Ks is of the Hilbert-Schmidt type and Fredholm theorem for L2 -kernels can be\napplied. Once the solution \u03c8s (r0 ; k) is found, we can obtain the solution of Eq. (109)\nsimply by dividing it by |V (r0 )|1/2 , except at points for which |V (r0 )|1/2 = 0, where it\ncan be defined by continuity.\nNow, let us apply MST to Eq. (109) using the scattering wave functions \u03a6L (r)\nin Eq. (81) as local basis functions. We transform this Lippmann-Schwinger equation\ninto a set of algebraic equations of infinite dimensions for the coefficients CL (k) in the\nexpansion (82)\nCLi (k)\n\n\u2212\n\nj6=i\nX\n\nj\nj\ni\nGij\nLL00 TL00 L0 CL0 (k) = IL (k)\n\n(115)\n\nj,L0 L00\n\nwhere, in comparison with Eq. (83), for simplicity we have neglected the outer region\nC\u03a9o , which we can always assume to be covered by a set of empty cells. In matricial\nform we have, putting K = GT and calling A the term in the rhs,\n(I \u2212 K) C = A\n\n(116)\n\nThe matrix K here is not an operator of the Hilbert-Schmidt type, since T r (K \u2020 K)\ndiverges, due to Eq. (108) and in keeping with Eq. (111). However, following the\nprocedure used above in passing from Eq. (109) to (112) and introducing new vector\ncomponents C 0 = T 1/2 C with a new inhomogeneous term A0 = T 1/2 A, we transform\nthis equation into a new one\n(I \u2212 Ks ) C 0 = A0\n\n(117)\n\nKs = T 1/2 GT 1/2\n\n(118)\n\nwhere\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states31\nThe square root of the matrix T is defined in the usual way, by first diagonalizing it\nwith a similarity transformation S, taking the square root of the diagonal elements and\nthen performing the same transformation on these letters. In formulas, if \u039b = ST S \u22121 ,\nthen T 1/2 = S\u039b1/2 S \u22121 , so that T 1/2 T 1/2 = T . There is no danger in performing these\noperations with the infinite matrix T , since T r (T \u2020 T ) < \u221e, as can be seen from the\nasymptotic behavior of its matrix element in Appendix B, Eq. (B.10). Hence the\nlimiting procedures are well defined.\nBy virtue of Eq. (114), Appendix G shows that the kernel Ks here is of the HilbertSchmidt type (i.e. T r (Ks\u2020 Ks ) is finite). As is well known [39] this letter is the condition\nfor the existence of the determinant |I \u2212 Ks | necessary to define its inverse, since by\nHadamard's inequality, for any finite Lmax , one has\n!\nL\nmax\nX\n|I \u2212 Ks |2 \u2264 \u03a0LLmax 1 +\n|(Ks )LL0 |2\n(119)\nL0\n\nP\n2\nand in the limit Lmax \u2192 \u221e the infinite product will converge if\nLL0 |(Ks )LL0 | \u2261\nT r (Ks\u2020 Ks ) \u2264 N < \u221e. [40]\nThis means that the process of truncating the matrix I \u2212 Ks to a certain lmax\nand then taking the inverse, converges absolutely in the limit lmax \u2192 \u221e. Once C 0 is\nobtained, C = T \u22121/2 C 0 , thus solving the original problem. Moreover the scattering path\noperator \u03c4 (76) is given by\n\u03c4 = T 1/2 (I \u2212 Ks )\u22121 T 1/2\n\n(120)\n\nThere is another way to solve Eq. 117, by expanding (I \u2212 Ks )\u22121 in series, i.e.\nwriting\nX\n(I \u2212 Ks )\u22121 =\n(Ks )n\n(121)\nn\n\nHowever, even if the kernel Ks is of the Hilbert-Schmidt type but T r (Ks\u2020 Ks ) \u2265 1,\nthe series diverges, whereas the process of truncating and taking the inverse always\nP\nn\nconverges. It goes without saying that the series\nis always divergent, since\nnK\n\u2020\nT r (K K) is infinite. Therefore the series expansion procedure is not always a viable\nmethod to find the inverse of a matrix of the type (I - A).\nIn practical numerical applications one does not have to worry about modifying\nthe structure constants according to Eq. (G.5) since, for the cell geometries ordinarily\nencountered in the applications (see the restrictions described at the beginning of\nSection 3), l-convergence in the l-truncation procedure of the MS matrix shows up\nmuch earlier than what predicted by the onset of divergence in Eq. (G.4), written with\nthe unmodified structure constants Gij\n\u039b\u039b0 . We already found this out in GeCl4 [21],\nwhere in the first 20 eV an lmax = 3 was sufficient to reproduce all spectral features,\nwhich did not change by increasing l up to 10. Similar results were found for other\ncompounds.\nIn this context we did a more stringent test for the Se2 diatomic molecule formed\nby two inter-penetrating nonequivalent spheres with 40% overlap, with centers on the\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states32\nz-axis. We calculated the K-edge z-polarized cross section for the \u03c3 state (m = 0) up\nto lmax = 60 in the energy range \u22124.0 \u223c 20.0 eV , using the kernel K = GT and found\na convergent behaviour for the lhs of Eq. (107) (see Fig. 4).\nThe fact that the full inversion of the MS matrix (I \u2212 GT ) is stable in this case\nup to lmax = 60 is clearly not of general validity, although indicative of the behavior\nof the theory. Going to higher values of lmax is not easy, because the lack of Lebedev\nintegration formulas for a number of surface points \u2265 6, 000 prevents us to access such\nvalues. Already the slight discrepancy of the lmax = 60 curve in Fig. 4 with the previous\nones (barely visible) is the sign that \u223c 6,000 Lebedev points are barely sufficient in this\ncase. This kind of study for other geometries and bigger clusters are under way.\n0.045\n\nlmax=2\nlmax=3\nlmax=4\nlmax=30\nlmax=50\nlmax=60\n\nAbsorption Cross Section ( Mb )\n\n0.04\n0.035\n0.03\n0.025\n0.02\n0.015\n0.01\n0.005\n0\n\u22125\n\n0\n\n5\n\n10\n\n15\n\n20\n\nE \u2212 E0 ( eV )\n\nFigure 4. K-edge z-polarized absorption cross section for the \u03c3 state of the Se2\nmolecule, for various l-values up to lmax = 60, calculated by full inversion of the MS\nmatrix (I-GT).\n\n5. Applications\nApplication of the present FP-MS theory to two cases which, according to our\nexperience, need significant non-MT corrections for a good reproduction of the\nabsorption data (i.e.\ndiatomic-linear molecules and tetrahedrally coordinated\ncompounds) have already been presented in Ref. [22] for the K-edge of Se2 and the Si\nL2,3 edge of crystalline SiO2 (\u03b1-quartz). There it was shown that a good description of\nthe anisotropies of the potential leads to a substantial improvement of the calculated\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states33\nabsorption signal in comparison with the experimental spectra.\nIn this section we present another application to the K-edge absorption of Br2 and\ndiscuss a preliminary application of the NMT approach to the study of the performance\nof two effective optical potentials, the Hedin-Lundqvist (HL) potential and the DiracHara (DH) in the case of a transition metal.\nIt should be emphasized that all potentials used here and in Ref. [22] are non-selfconsistent, since the starting charge density is obtained by mere superposition of atomic\ndensities. Therefore the agreement or disagreement with experiments might change if a\nself-consistent charge density were used, although from our experience the effect of this\nlatter has a minor impact on the spectra than the elimination of the MT approximation.\nIn any case, one of the motivations for pursuing the FP-MS method was exactly the\nstudy of the performance of the various models of optical potential together with the\neffect of the self-consistent charge density, once that the geometrical approximation of\nthe potential had been eliminated. The application of the present real space theory to\nthe generation of the self-consistent ground state density using the well known technique\nof contour integration in the complex energy plane is under way.\nIn order to obtain the absorption spectra we start from the well known expression\nof the absorption cross section in terms of the GF, given by\n\u03c3tot (\u03c9) = \u2212 8 \u03c0 \u03b1 ~ \u03c9\nX Z\n= h\u03c6cLc (r)|\u03b5\u0302 * r|G(r, r0 ; E)|\u03b5\u0302 * r0 |\u03c6cLc (r0 )idr dr0\n\u00d7\n\n(122)\n\nmc\n\nFor more details and other spectroscopies we refer the reader to Ref. [35]. We used\nall three forms of GF given by Eqs. (93), (94) and (95). While the last two are\nnumerically stable and give almost coincident spectra, the first one shows occasionally\nsmall but noticeable kinks in the calculated spectrum and sometimes small deviations\naround maxima and/or minima of the cross section compared to the other two. This\nis a known phenomenon which is now exalted compared to the MT case, where it was\nalmost unnoticeable. It is due the fact that the singularities of the S-matrix in the\ndefinition of the scattering basis functions \u03a6(r) in Eq. (70) and those of T \u22121 in the\ninverted MS matrix \u03c4 = (T \u22121 \u2212 G) do not compensate exactly. Therefore, even though\nthe three forms are formally equivalent, from a computational point of view, form Eq.\n(93) is to be avoided.\nFig. (5), shows the experimental unpolarized K-edge absorption cross section of\nthe diatomic molecule Br2 [41] in comparison with a NMT and a MT calculation as a\nfunction of the photo-electron kinetic energy E referred to E0 , the true zero of the nonself-consistent molecular potential at infinity. All spectra were normalized at a common\nenergy point between 20 and 30 eV. For the NMT case we partitioned the space with\n24 Voronoi polyhedra arranged on a BCC lattice: two of them around the physical\natoms and 22 empty cells (EC) to cover the rest of the space where the density (and the\npotential) are significantly different from zero. l max was taken equal to 4 in all polyhedra.\nWe gave a small finite imaginary part to the energy of the order of (\u223c 0.02 eV) in order\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states34\nto be able to use the same Green's function expression for the cross section Eq. (122)\nboth for bound and continuum states. To calculate the absorption spectrum, we used\nthe real part of an Hedin-Lundqvist (HL) potential and then convoluted the result with\na Lorentzian whose width is equal to the that of the core hole (2.52 eV). We see that\nthe agreement with experiment is rather good. In contrast, the MT approximation of\nthe potential turns out to be rather poor.\n\nNorm. Absorption (arb. unit)\n\n2.5\n\nBr2 Gas(300) Exp.\nNON-MT Calc.\nMT Calc.\n\n2\n\n1.5\n\n1\n\n0.5\n\n0\n\n-10\n\n0\n\n10\n\n20\n\n30\n\n40\n\nE - E0 (eV)\nFigure 5. K-edge unpolarized absorption cross section for Br2 molecule, showing the\ncomparison between the MT and FP-MS calculations against the experimental data\n\nWe then present in Fig. (6) a preliminary application of the NMT approach to\nassess the performance of the HL against a DH potential, assuming that the losses are\nsufficiently well described in both cases by the imaginary part of the HL self-energy,\nin the case of HCP Co metal. As is well known, the real part of the HL potential is\ncomposed of two terms: the static Hartree-Fock (HF) exchange, known also as DiracHara (DH) exchange, coming from the constant part of the dielectric function and the\ndynamically screened exchange-correlation contribution (HLXC), originating from the\n\u03c9-dependent part (see Appendix A of Ref. [42]).\nThis calculation (and other similar along the same line) were performed without\nany adjustable parameter. In all cases the number of atoms forming the cluster is about\n140-150, lying inside a sphere of about 7-8 \u00c5, enough to obtain spectral convergence\nin the presence of the complex part of the potential. The charge density was obtained\nby superposition of neutral atom charge densities, from which the Coulomb and the\nexchange-correlation potential are calculated. In the case of close-packed structure, this\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states35\n1.2\n\nExp.\nCalc.\n\n1\n\nNorm. Absorption (arb. unit)\n\nNorm. Absorption (arb. unit)\n\n1.2\n\n0.8\n0.6\n0.4\n0.2\n0\n-20\n\n-10\n\n0\n\n10\n\n20\n\n30\n\nE - E0 (eV)\n\n40\n\n50\n\n60\n\n70\n\nExp.\nCalc.\n\n1\n0.8\n0.6\n0.4\n0.2\n0\n-20\n\n-10\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\nE - E0 (eV)\n\nFigure 6. Comparison between Co K-edge absorption calculated with complex HL\n(left) and DH (right) potentials with experimental results. (Color online)\n\nfact should not be an handicap.\nBy contour integral of the Green's Function over the energy range of the valence\nsates, the Fermi Energy was determined to be around -10 eV with respect to E0 = 0, i.e.\nthe zero of the cluster potential at infinity. It serves to define the local momentum of the\nphoto-electron in the calculation of the HL (DH) potential, but the calculated spectra\nare rather insensitive to small variations of this quantity by 1-2 eV. No self-consistence\nloop was attempted to find a self-consistent charge. The core hole width was taken into\naccount by adding 0.7 eV to the complex part of the potential.\nSurprisingly enough, the comparison shows that the DH potential gives overall\nbetter agreement with the experiments than the HL one. A similar situation is found\nfor other transition metals and has been reported elsewhere. [43] Notice that the same\nconclusion was drawn in Ref. [44] for Cu2 M nM , where M = Al, Sn, In, although in\nthe MT approximation.\n6. Conclusions\nWe have developed a FP-MS scheme which is a straightforward generalization of the\nusual theory with MT potentials and implemented the code to calculate cross sections\nfor several spectroscopies, like absorption, photo-electron diffraction and anomalous\nscattering, as well as bound states, by a simple analytical continuation. The key point\nin this approach is the generation of the cell solutions \u03a6L ( r ) for a general truncated\npotential free of the well known convergence problems of AM expansion together with\nan alternative derivation of the MSE which allows us to treat the matrices S and E as\nsquare, with only one truncation parameter, given by the classical relation lmax \u223c k Rb .\nThe fact that the theory can work with square S and E matrices is of the utmost\nimportance, since this feature allows the definition of the cell T matrix and its inverse,\nrecuperating in such way the possibility to define the Green's function and to treat a host\nof problems, ranging from solids with reduced symmetry to randomly disordered alloys in\nthe context of the CPA, as mentioned in the introduction. In this way one can also show\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states36\nthat the wave function and the Green's function approach provide the same expression\nfor the absorption cross section for continuum states and real potentials, through the\napplication of the generalized optical theorem (see Appendix E). For transitions to\nbound states the two methods are not equivalent, due to the different normalization of\ncontinuum and bound states, unless one normalizes to one the wave function for these\nlatter. However this procedure, although feasible, is rather cumbersome (this was one\nof the reasons for abandoning the MS method in favor of the simpler linearized methods\nin band structure calculations). Instead, the Green's function expression for the cross\nsection Eq. (122) can always be used, since it gives the correct normalization in both\ncases simply by analytical continuation. We have exploited this fact when calculating\nthe cross section for the Se2 and Br2 diatomic molecules.\nMoreover, in the present paper we have been able to show that the FP-MST\nconverges absolutely in the lmax \u2192 \u221e limit (modulo a slight modification of the free\npropagator matrix G which is practically unnecessary) in the sense that the scattering\npath operator of the theory can be found in terms of an absolutely convergent procedure\nin this limit. We have thus given a firm ground to its use as a viable method for electronic\nstructure calculation and at the same time have provided a straightforward extension of\nMST in the Muffin-Tin (MT) approximation for the calculation of x-ray spectroscopies.\nAlso Quantum Chemistry calculations might benefit from this method in that it avoids\nthe use of basis functions sets.\nFinally it is worth mentioning that in giving a new scheme to generate local\nbasis functions for truncated potential cells, we have provided an efficient and fast\nmethod for solving numerically a partial differential equation of the elliptic type in\npolar coordinates, which can also be used to solve the Poisson equation in the whole\nspace by the partitioning method.\nAcknowledgements\nWe gratefully acknowledge Dr. Peter Kr\u00fcger for long and illuminating discussions. We\nalso thank Prof. Isao Tanaka and Dr. Teruyasu Mizoguchi for drawing our attention\nto the problem of \u03b1-quartz (SiO2 ). C. R. Natoli acknowledges a financial support from\nDGA (Diputaci\u00f3n General de Arag\u00f3n) in the framework of the promotion action for\nresearcher mobility. This work has been accomplished in the framework and with the\nsupport of the European Network LightNet.\nAppendix A. The Mathieu functions\nFor the convenience of the reader we give here a brief account of the Mathieu functions.\nThe solution of the 3-dimensional Mathieu's equation (24) of the text is obtained by\nseparation of variables\n\u03c8(x, y, z) = fx (x)fy (y)fz (z).\n\n(A.1)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states37\nin terms of functions f solutions of the one-dimensional Mathieu's equation [27]\nd2 f (r)\n= (\u2212a + 2q cos 2r)f (r)\ndr2\nA solution of Eq. ( A.2 ) having period \u03c0 or 2\u03c0 is of the form,\n\u221e\nX\n\nf (r) =\n\n(Am cos mr + Bm sin mr)\n\n(A.2)\n\n(A.3)\n\nm=0\n\nwhere B0 can be taken as zero. If the above expression is substituted into Eq. ( A.2 )\none obtains\n\u221e\nX\n[(a \u2212 m2 )Am \u2212 q(Am\u22122 + Am+2 )] cos mr\nm=\u22122\n\u221e\nX\n\n[(a \u2212 m2 )Bm \u2212 q(Bm\u22122 + Bm+2 )] sin mr = 0\n\n+\n\n(A.4)\n\nm=\u22121\n\nwith A\u2212m = B\u2212m = 0 if m > 0. Eq. ( A.4 ) can be reduced to one of four simpler\ntypes,\n\u221e\nX\nA2m+p cos(2m + p)r, p = 0 or 1\n(A.5)\nf0 (r) =\nf1 (r) =\n\nm=0\n\u221e\nX\n\nB2m+p sin(2m + p)r,\n\np = 0 or 1.\n\n(A.6)\n\nm=0\n\nIf p = 0, the solution is of period \u03c0; if p = 1, the solution is of period 2\u03c0. f0 is an even\nsolution, and f1 is an odd solution. The recurrence relations among the coefficients of\nthese basic solutions are easily obtained from the general relations Eq. ( A.4 ). For even\nsolutions of period \u03c0 we find\naA0 \u2212 qA2 = 0\n\n(A.7)\n\n(a \u2212 4)A2 \u2212 q(2A0 + A4 ) = 0\n\n(A.8)\n\n(a \u2212 m2 )Am \u2212 q(Am\u22122 + Am+2 ) = 0,\n\nm\u22653\n\n(A.9)\n\nand of period 2\u03c0,\n(a \u2212 1)A1 \u2212 q(A1 + A3 ) = 0\n(a \u2212 m2 )Am \u2212 q(Am\u22122 + Am+2 ) = 0,\n\n(A.10)\nm \u2265 3.\n\n(A.11)\n\nFor odd solutions of period \u03c0,\n(a \u2212 4)B2 \u2212 qA4 = 0\n2\n\n(a \u2212 m )Bm \u2212 q(Bm\u22122 + Bm+2 ) = 0,\n\n(A.12)\nm\u22653\n\n(A.13)\n\nwhereas for period 2\u03c0,\n(a \u2212 1)B1 + q(B1 \u2212 B3 ) = 0\n2\n\n(a \u2212 m )Bm \u2212 q(Bm\u22122 + Bm+2 ) = 0,\n\n(A.14)\nm\u22653\n\n(A.15)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states38\nTable A1. First few Eigenvalues of Mathieu functions for different q values\nparity\nperiod\n\neven\n\u03c0\n\nodd\n2\u03c0\n\n\u03c0\n\n2\u03c0\n\n\u22126\n\na1 = 1.00999\n\nb2 = 3.99999\n\nb1 = 0.989988\n\nq=0.02 a0 =-1.99991\u00d710\u22125\n\na1 = 1.01995\n\nb2 = 3.99997\n\nb1 = 0.97995\n\na1 = 1.02989\n\nb2 = 3.99993\n\nb1 = 0.969888\n\na1 = 1.0398\n\nb2 = 3.99987\n\nb1 = 0.959801\n\na1 = 1.04969\n\nb2 = 3.99979\n\nb1 = 0.949689\n\na1 = 1.09873\n\nb2 = 3.99917\n\nb1 = 0.898766\n\na1 = 1.19487\n\nb2 = 3.99667\n\nb1 = 0.795124\n\na1 = 1.28832\n\nb2 = 3.9925\n\nb1 = 0.689166\n\na1 = 1.85911\n\nb2 = 3.91702\n\nb1 = \u22120.110249\n\na1 = 2.3792\n\nb2 = 3.67223\n\nb1 = \u22121.39068\n\na1 = 1.85819\n\nb2 = 2.09946\n\nb1 = \u22125.79008\n\na1 = \u22122.39914\n\nb2 = \u22122.38216\n\nb1 = \u221213.9366\n\nq=0.01 a0 =-4.99995\u00d710\na2 = 4.00004\na2 = 4.00017\n\nq=0.03 a0 =-4.49956\u00d710\u22125\na2 = 4.00037\nq=0.04 a0 =-7.9986\u00d710\u22124\na2 = 4.00067\nq=0.05 a0 =-1.24966\u00d710\u22123\na2 = 4.00104\nq=0.1\n\na0 =-4.99454\u00d710\u22123\na2 = 4.00416\n\nq=0.2\n\na0 =-1.99133\u00d710\u22122\na2 = 4.01658\n\nq=0.3\n\na0 =-4.4566\u00d710\u22122\na2 = 4.03706\n\nq=1\n\na0 =-0.455139\na2 = 4.3713\n\nq=2\n\na0 =-1.51396\na2 = 5.17267\n\nq=5\n\na0 =-5.80005\na2 = 7.44911\n\nq=10\n\na0 =-13.937\na2 = 7.71737\n\nIt is convenient to separate the characteristic values a into two major subsets:\na = ar , associated with even periodic solutions\na = br , associated with odd periodic solutions\nwhere r describes the index of the eigenstate. Table A1 gives the first three eigenvalues\nassociated to even periodic solutions and the first two associated to odd periodic\nsolutions (b0 = 0), for some selected values of q. They can serve to generate the\nMathieu functions using the above recurrence relations to determine the coefficients\nin the solutions (A.5) and (A.6).\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states39\nAppendix B. Asymptotic behavior of KKR Structure Factors\nFor \u03bd \u2192 \u221e through real positive numbers (in practice for \u03bd \u001d |z|), the other variables\nbeing fixed, one has [27]\n\u0010 1 \u00111/2 \u0010 ez \u0011\u03bd\nJ\u03bd \u2248\n;\n2\u03c0\u03bd\n2\u03bd\n\u0010 2 \u00111/2 \u0010 ez \u0011\u2212\u03bd\n\u00b1\n\u2212 iH\u03bd \u2248 \u00b1\n(B.1)\n\u03c0\u03bd\n2\u03bd\nwhere e is the Neper number. Remembering that\nr\n\u03c0\njn (z) =\nJn+1/2 (z);\n2z\nr\n\u03c0 \u00b1\n\u00b1\nhn (z) =\nH\n(z)\n(B.2)\n2z n+1/2\nwe find for the asymptotic behavior of the spherical Bessel and Hankel functions\nz n n+1/2 \u0010 1 \u0011n+1\njn (z) \u2248 \u221a e\n;\n2n + 1\n2\n\u221a\n2\n1\n\u00b1\n\u2212 ihn (z) \u2248 n+1 n+1/2 (2n + 1)n\n(B.3)\nz\ne\nWe need to find un upper limit for Gij\nLL0 given by\nX\n0\n00\nGij\nil\u2212l +l C(L, L0 ; L00 ) h+\n(B.4)\nLL0 = \u22124\u03c0ik\nl00 (\u03c1) YL00 (\u03c1\u0302)\nL00\n\nwhere \u03c1 = kRij , \u03c1\u0302 = R\u02c6ij and C(L, L0 ; L00 ) are the Gaunt coefficients. To establish an\nupper limit for this expression when l is fixed and l0 \u001d \u03c1 we replace each |h+\nl00 (\u03c1)| in the\n+\nsum by its maximum value |hl+l0 (\u03c1)|, use the asymptotic value in Eq. (B.3) and the\nP\nrelation L00 C(L, L0 ; L00 ) YL00 (\u03c1\u0302) = YL (\u03c1\u0302)YL0 (\u03c1\u0302) to obtain\nX\n+\n|Gij\n|\n\u2264\n4\u03c0k|h\n|C(L, L0 ; L00 ) YL00 (\u03c1\u0302)|\n(\u03c1)|\nLL0\nl+l0\nL00\n\n\u2248 4\u03c0k|h+\nl+l0 (\u03c1)| |\n=\n\nX\n\nC(L, L0 ; L00 ) YL00 (\u03c1\u0302)|\n\nL00\n+\n4\u03c0k|hl+l0 (\u03c1)| |YL (\u03c1\u0302)YL0 (\u03c1\u0302)|\n0\n\n\u2264 [(2l + 1)(2l + 1)]\n\n1/2\n\n\u221a\n2\n\nk\n\n\u03c1l+l0 +1\n\nel+l0 +1/2\n\n[2(l + l0 ) + 1]l+l\n\n0\n\n(B.5)\n\np\nP\nsince |YL (\u03c1\u0302)| \u2264 (2l + 1)/(4\u03c0). Notice that the approximation L00 |C(L, L0 ; L00 )YL00 (\u03c1\u0302)| \u2248\nP\n| L00 C(L, L0 ; L00 ) YL00 (\u03c1\u0302)| entails only errors O(1) in all l variables, as can be verified by explicit calculation, and therefore completely negligible with respect to the\nP\npower behavior of the rest of the factors. In any case, since L00 |C(L, L0 ; L00 )YL00 (\u03c1\u0302)| \u2264\nP\n[(2l + 1)(2l0 + 1)]1/2 /(4\u03c0) L00 (2l00 + 1), at the cost of introducing a non influential extra\nfactor [2(l + l0 ) + 1]2 in Eq. (B.5) we would get a rigorous inequality. This expression is\nobviously also valid for l \u001d \u03c1.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states40\nUnder the same conditions, assuming l0 \u001d l we derive\nij\n|JLL\n0 | \u2264 4\u03c0|jl0 \u2212l (\u03c1)| |YL (\u03c1\u0302)YL0 (\u03c1\u0302)|\n0\n\u03c1l \u2212l 0\n1\n\u2264 [(2l + 1)(2l0 + 1)]1/2 \u221a el \u2212l+1/2\n(B.6)\n[2(l0 \u2212 l) + 1]l0 \u2212l+1\n2\nThe inequalities Eqs. (B.5) and (B.6) can be used to obtain other useful inequalities\nused throughout the paper. For example, for fixed l, using again Eq. (B.3), one obtains\nr\n\u0013l0\n\u0012\nk\n2l + 1 \u2212l\nrj\nij\ne\n(B.7)\n[2(l0 + l) + 1]l\n|GLL0 JL0 (rj )| \u2264\nl+1\nRij\n(kRij )\n4\u03c0\nP\nij\nimplying that the series H\u0303L+ (ri ) =\nL0 GLL0 JL0 (rj ) is absolutely and uniformly\nconvergent in the angular domain. The uniform convergence comes from the application\nof the Weierstrass criterion (see Ref. [40], sect. 3.34, pag. 49).\nSimilarly one finds\nr\n\u0013l0 +1\n\u0012\nk\nRio\n2l + 1 \u2212l\n+\nio\n0\nl\n|JLL0 H\u0303L0 (ro )| \u2264\n[2(l\n\u2212\nl)\n+\n1]\ne\n(B.8)\nro\n(kRio )l+1\n4\u03c0\nP\n+\nio\nshowing that the series H\u0303L+ (ri ; \u03ba) = L0 JLL\n0 H\u0303L0 (ro ; \u03ba) is also absolutely and uniformly\nconvergent if (ro > Rio ).\nAlong the same lines we can estimate an upper bound for the atomic T-matrix for\nl, l0 \u001d kRb . We find from Eq. (42) to first order\nZ Rb\nJL0 (r) V (r) \u03c8L (r) d3 r\nTLL0 =\n0\nZ Rb\nX\n0\n00\n000\nr2 jl0 (kr) VL000 (r) RL00 L (r) dr\n=\nC(L , L ; L )\n0\n\nL00 L000\n\n\u2248\n\nX\n\nC(L0 , L; L00 )\n\nZ\n\nRb\n\nr2 jl0 (kr) VL00 (r) jl (kr) dr\n\n(B.9)\n\n0\n\nL00\n\nwhere the last step follows from the fact that under the above assumptions RL0 L \u2248 jl \u03b4LL0 .\n\u221a\nTaking into account that C(L0 , L; L00 ) \u2248 1/ 4\u03c0 O(1) for all L-values and using again\nEq. (B.3) we obtain\nZ Rb\n0\n|TLL0 | \u2264 4ll\nr2 |jl0 (kr)| |V|l\u2212l0 | (r)| |jl (kr)| dr\n0\n0\n\n0 l+l0\n\n\u2248 4ll k\nZ\n\u00d7\n\nRb\n\nel+l +1\n(2l + 1)l+1 (2l0 + 1)l0 +1\n0\n\nrl+l +2 |V|l\u2212l0 | (r)| dr\n\n0\n0\n\n0\n\nZef f\n4ll0\n(kRb )l+l +2 el+l +1\n\u2264 2\nk l + l0 + 2 (2l + 1)l+1 (2l0 + 1)l0 +1\n\n(B.10)\n\nwith the understanding that Vl \u2261 Vl0 , assuming that |Vl (r)| \u2264 2Zef f /r in atomic units\nand that |Vl (r)| is decreasing with l.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states41\nBased on the above inequalities we easily obtain\n\u221a 1/2\n(ll0 )3/2\n0| \u2264 8\n2e\nZ\nR\n|Gij\nT\n0\nef\nf\nb\nLL\nLL\nl + l0 + 2\n\u0012\n\u0013l+l0 +1\n0\nRb\n(2l + 2l0 + 1)l+l\n\u00d7\n(B.11)\nRij\n(2l + 1)l+1 (2l0 + 1)l0 +1\nSpecializing to the case where l is fixed and l0 is running, we also find\n(ll0 )1/2 l0\n0 L0 | \u2264 4\nZef f\n|Gij\nT\n0\nL\nLL\nl0 + 1\n0\n0\n0\n(kRb )2l +2 e2l +1 (2l + 2l0 + 1)l+l\n\u00d7\n(B.12)\n(kRij )l+l0 +1 el+l0 +1/2 (2l0 + 1)2l0 +1\nwhich is useful in discussing questions related to the convergence of MST.\nFinally we note that all the above inequalities and convergence conditions remain\nvalid for complex arguments \u03c1, provided it is replaced by its module |\u03c1|.\nAppendix C. Surface identity for scattering states\nIn the case of short range potentials (i.e. potentials that behave like 1/r1+\u000f with positive\n\u000f as r \u2192 \u221e) the Lippmann-Schwinger equation for scattering states at energy E = k 2\nZ\n\u03c8(r; k) = \u03c60 (r; k) + dr0 G0 (r \u2212 r0 ; k)V (r0 )\u03c8(r0 ; k)\n(C.1)\nis a consequence of the Schr\u00f6dinger equation\n(\u22072 + E \u2212 V (r))\u03c8(r; k) = 0\n\n(C.2)\n\ntogether with the relations (\u03c60 (r; k) \u2261 eik*r )\n(\u22072 + E)\u03c60 (r; k) = 0\n\n(C.3)\n\n(\u22072 + E)G0 (r \u2212 r0 ; k) = \u03b4(r \u2212 r0 )\n\n(C.4)\n\nStarting from Eq. (C.1), we derive the identity\nZ\ndr0 [G0 (r \u2212 r0 ; k)V (r0 ) \u2212 \u03b4(r \u2212 r0 )] \u03c8(r0 ; k) = \u2212\u03c60 (r; k)\n\n(C.5)\n\n\u03a9\n\nwhere \u03a9 indicates the whole space. Using Eq. (C.4) to replace the delta function, and\nthe Schr\u00f6dinger equation (C.2) to eliminate V (r0 ) we obtain\nN\n+1 Z\nX\n{G0 (r \u2212 r0 ; k)(\u22072 + E)\u03c8(r0 ; k)\nj=1\n\n\u03a9j\n\n\u2212 \u03c8(r0 ; k)(\u22072 + E)G0 (r \u2212 r0 ; k)}dr0j = \u2212\u03c60 (r; k)\nP +1\nwhere we have decomposed the whole space as \u03a9 = N\nj=1 \u03a9j , such that \u03a9N +1 \u2261 \u03a9o =\nPN\nC j=1 \u03a9j .\nTransforming to surface integrals by application of the Green's theorem\nN\n+1 Z\nX\n[G0 (r \u2212 r0 ; k)\u2207\u03c8(r0 ; k)\nj=1\n\nSj\n\n\u2212\u03c8(r0 ; k)\u2207G0 (r \u2212 r0 ; k)] * n0j d\u03c3j0 = \u2212\u03c60 (r; k)\n\n(C.6)\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states42\nWe now observe that the surface integral over the surface SN +1 of the volume\nP\n\u03a9N +1 \u2261 \u03a9o has two contributions, one coming from the surface So of N\nj=1 \u03a9j , the other\n\u221e\none So at infinity, as the limit as R \u2192 \u221e over the surface of a sphere SoR , of radius R.\nThis latter is easily calculated on the basis of the asymptotic behavior of \u03c8(r; k) in Eq.\n(41) and the expansion (36) and gives exactly \u2212\u03c60 (r; k), canceling the rhs term in Eq.\n(C.6). Therefore we recover the identity (32) of Section 3.1\nN Z\nX\n{G0 (r \u2212 r0 , k)\u2207\u03c8(r0 ; k)\nSj\n\nj=1\n\n\u2212 \u03c8(r0 ; k)\u2207G0 (r \u2212 r0 ; k)} * n0j d\u03c3j0\nZ\n=\n\n{G0 (r \u2212 r0 , k)\u2207\u03c8(r0 ; k)\n\nSo\n0\n\u2212 \u03c8(r0 ; k)\u2207G0 (r \u2212 r0 ; k)} * n0O d\u03c3O\n\n(C.7)\n\nAppendix D. The Generalized Optical Theorem\no\n\nFor convenience of the reader we give here a proof of Eq. (79) in the case where T \u2261 0,\ni.e. when empty cells cover the volume \u03a9o up to the point at which the asymptotic\nbehavior in Eq. (41) begins to be valid. We start by observing that\nZ\n\u0002\n\u0003\u2217\nij k\ndk\u0302 ILi 0 (k) ILj (k) = JLL\n(D.1)\n0\n\u03c0\nso that, using the relation Eq. (77), we find\nZ\n\u0002\n\u0003\u2217 X im mn ni \u2217 k\ndk\u0302 BLi 0 (k) BLj (k) =\n\u03c4L\u039b0 J\u039b\u039b0 (\u03c4\u039b0 L0 )\n\u03c0\nL\u039b\n\n(D.2)\n\nwhere we have used the symmetry of \u03c4 . Based on the relations Eqs. (102), (103) and\n(105), valid at any energy, and due to the reality of the matrices K, N and J for real\npotential, we can write\n\u03c4 = k \u22121 [K \u2212 N + iJ]\u22121\n\n(D.3)\n\nso that the rhs of Eq. (D.2) becomes\nk\n1 1 \u2217\n1\nij\n{\u03c4 J \u03c4 }ij\n{\u03c4 \u2212 \u03c4 }ij\nLL0 =\nLL0 = \u2212 =\u03c4LL0\n\u03c0\n\u03c0 2i\n\u03c0\nin keeping with Eq. (79).\n\n(D.4)\n\nAppendix E. Wave function and GF equivalence for absorption cross section\nIn the independent electron approximation, the core level photoelectron diffraction\n(PED) cross-section for the ejection of a photoelectron along the direction k\u0302 and energy\nE = k 2 from an atom situated at site i is given by [35]\nX\nd\u03c3\n2\n= 8 \u03c02 \u03b1 ~ \u03c9\nh\u0398\u03c8(ri ; k)|\u03b5\u0302 * ri |\u03c6cLc (ri )i\n(E.1)\ndk\u0302\nmc\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states43\nHere \u0398 is the time-reversal operator, \u03b5\u0302 the polarization of the incident photon and\n\u03c6cLc (ri ) the initial core state of angular momentum Lc (we neglect for simplicity the\nspin-orbit coupling, which can be easily taken into account). Due to the localization of\nthe core state, we need only the expression of the continuum scattering state in the cell\nof the photoabsorber, given by\nX\n(E.2)\n\u03c8(ri ; k) =\nBLi (k)\u03a6L (ri )\nL\n\nso that\nd\u03c3\ndk\u0302\n\n2\n\n= 8 \u03c02 \u03b1 ~ \u03c9\n\nX X\nmc\n\nMLc L (E) BLi (k)\n\n(E.3)\n\nL\n\nwhere BLi (k) is given by Eq. (77) and we have defined the atomic transition matrix\nelement\nZ\nMLc L (E) =\nd r \u03c6cLc (r) \u03b5\u0302 * r \u03a6L (r)\n(E.4)\n\u03a9i\n\nThe total absorption cross-section, in the case of real potentials, is obtained by\nintegrating the PED cross-section over all directions of photoemission\n2\nZ\nXZ\nX\nd\u03c3\n2\ni\ndk\u0302\ndk\u0302\n= 8\u03c0 \u03b1~\u03c9\nMLc L (E) BL (k)\ndk\u0302\nmc\nL\nXX\nii\n= \u2212 8\u03c0\u03b1~\u03c9\nMLc L (E)=\u03c4LL\n(E.5)\n0 MLc L0\nmc LL0\n\nby application of the optical theorem (79). This is exactly the form that one would\nobtain starting from Eq. (122) and using the expression (93) for the GF.\nAppendix F. Exploitation of point symmetry\nIn a cluster (to which we shall also refer as a molecule), point symmetry can be\nused to advantage to simplify the problem and reduce the size of the MS matrix.\nSpecifically we consider the case where the cluster remains invariant under a finite\ngroup of transformations G relative to the molecular center Ro . This group has a finite\nnumber of finite-dimensional irreducible representations (irreps) \u0393j (j = 1, 2, ..., g). Due\nto the symmetry, the cluster will consist of P groups of equivalent atoms, transforming\ninto one another under the operations of the group; and for each group p = 1, 2, ...., P,\nthere are Np atoms labeled by ip . If N is the total number of atoms in the cluster, then\nP\nN = Pp=1 Np .\nUnder these assumptions there exists a unitary transformation C that blockdiagonalizes the MS matrix according to the irreps. For each value of the angular\nmomentum index l, this transformation is labeled by the angular projection m and the\nsite ip on one side, and on the other the irrep, the row \u03c1 of the irrep and a further\nindex n that distinguishes independent orthogonal symmetrized basis functions with\nthe same l. The matrix elements of C are easily obtained by applying the projection\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states44\nP\n\u0393\noperator R M\u03c1\u03c1j (R) PR to a spherical harmonic function Ylm ( r\u0302ip ) \u03b8(Rb \u2212 rip ) centered\non the site ip and defined on the surface of the bounding sphere Rb of the cell \u03a9ip Here\nPR is the generic operation belonging to the group G corresponding to the coordinate\n\u0393\ntransformation R, and M\u03c1\u03c1j (R) is the matrix element corresponding to R in the matrix\nrepresentation of irrep \u0393j of the group, \u03c1 labeling the row of the irrep. As usual in group\ntheory [45] the effect of PR on the function f (r) is given by f (R\u22121 r). In this way, if the\nresult is not zero, one generates a symmetrized spherical harmonic function given by\nX\n\u0393\u03c1 , p\n\u0393j\nKlnj ( r\u0302p ) \u2261\nM\u03c1\u03c1\n(R) PR Ylm ( r\u0302ip )\nR\n\n=\n\nX\n\n=\n\nX\n\n\u0393j\nM\u03c1\u03c1\n(R)\n\nX\n\nl\nD\u03bcm\n(R) Yl\u03bc ( r\u0302i0p )\n\n\u03bc\n\nR\n\u0393\u03c1 , i p\nCln,j m\n\nYlm ( r\u0302ip )\n\n(F.1)\n\nm,ip\nl\n(R) is the Wigner rotation matrix corresponding to the transformation R [45]\nwhere D\u03bcm\n0\nand ip = R ip . Due to the orthogonality of the basis functions\nZ\nYlm ( r\u0302ip ) Ylm0 ( r\u0302i0p ) d\u03a9\n= \u03b4mm0 \u03b4ip i0p\nZ\n0\n\u0393\u03c1j 0 , p\n\u0393\u03c1j , p\n(F.2)\nKln ( r\u0302p )Kl0 n0 ( r\u0302p ) d\u03a9 = \u03b4ll0 \u03b4nn0 \u03b4\u0393j \u0393j0 \u03b4\u03c1\u03c10\n\nwe obtain C C \u0303 = C \u0303 C = I, i.e.\nX \u0393\u03c1 , i \u03930\u03c10 , i\nCln, mp Cl0 n0 , mp\n\n= \u03b4ll0 \u03b4nn0 \u03b4\u0393\u03930 \u03b4\u03c1\u03c10\n\nm, ip\n\nXX\n\u0393\u03c1\n\n\u0393\u03c1 , i 0\n\n\u0393\u03c1 , i\n\nCln, mp Cln, mp0 = \u03b4mm0 \u03b4ip i0p\n\n(F.3)\n\nn\n\nwhere for simplicity we have dropped the index j from the symbol \u0393 of the irreps.\nij\n\u22121\nNow, if M \u2261 MLL\n\u2212G)ij\n0 \u2261 (T\nLL0 is the MS matrix in the non-symmetrized site and\n \u0303 Therefore\nangular momentum indices, its symmetrized version is given by Ms = C M C.\nfor any representation \u0393 we have, putting for short \u039b = (l, n) and remembering that\nL \u2261 (l, m),\n\u0393, p\nT\u039b,\n\u039b0\n\n=\n\nNp\nX\nX\n\n\u0393, i\n\ni\n\n\u0393, i\n\nC\u039b, Lp TL,p L0 C\u039b0 , Lp 0\n\n(F.4)\n\nip m, m0\npq\nG\u0393,\n\u039b, \u039b0\n\n=\n\nNp Nq\nX\nXX\nip\n\niq\n\n\u0393, i\n\ni i\n\n\u0393, i\n\nC\u039b, Lp GL,p Lq0 C\u039b0 , Lq 0\n\n(F.5)\n\nm, m0\n\npq\nHere Ts\u0393, p describes total scattering power of group p and G\u0393,\nis the symmetrized\ns\no\nmatrix of the KKR structure factors. The presence of an outer sphere contribution JT J\no\no\no\nis treated on the same footing and contributes C JT J C \u0303 \u2261 C J C \u0303 C T C \u0303 C J C \u0303 \u2261 Js T s Js\nfor each representation \u0393. Since the outer sphere is centered at the origin of the cluster,\nit has no partner spheres equivalent to itself.\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states45\nAll these matrices are labeled only by the groups of equivalent atoms (prototypical\natoms), the angular momentum l and possibly the index n mentioned above, realizing a\nsizable reduction in dimensions. Notice that, since the molecular hamiltonian is invariant\nunder the operations of G, the symmetrized matrix elements do not depend on the row\n\u03c1 of the representation \u0393. Moreover, in order to find the symmetrized T -matrix relative\nip\nto an equivalent group of atoms, we do not need to calculate TLL\n0 for all sites in the\ngroup, since these are related to one another by the relation\nX\ni0p\ni\nl\nl0\n(R) Tl\u03bcp l0 \u03bc0 Dm\n(F.6)\nTLL\nDm\u03bc\n0 \u03bc0 (R)\n0 =\n\u03bc\u03bc0\n\nwhere, as before, i0p = R ip . This relation is a consequence of the invariance of the\npotential and the T -matrix T ip (r\u0302, r\u03020 ) under the operations of the group G. Specifically\nZ\nip\nYL (r\u0302) V ip (r, r\u0302) YL0 (r\u0302) d r\u0302\nVLL0 =\nZ\n0\n=\nYL (r\u0302) V ip (r, R r\u0302) YL0 (r\u0302) d r\u0302\nZ\n0\n=\nYL (R\u22121 r\u0302) V ip (r, r\u0302) YL0 (R\u22121 r\u0302) d r\u0302\ni0\n\n0\n\nl\n= D\u03bcm\n(R) Vl\u03bcpl0 \u03bc0 D\u03bcl 0 m0 (R)\nR\nip\nvalid also for the matrix elements TLL\nYL (r\u0302) T ip (r\u0302, r\u03020 ) YL0 (r\u03020 ) d r\u0302 d r\u03020 . Notice that\n0 =\nthe transformation and symmetrization properties are the same for T and T \u22121 , so we\ncan act directly on this latter.\nIn the MT case the T -matrices are angular momentum diagonal and m and site\nindependent within a set of equivalent atoms, so that\n\u0393, p\nT\u039b,\n\u039b0\n\nNp\nX\nX\n\n=\n\nTlp\n\n=\n\nm\nip\np\nTl \u03b4\u039b, \u039b0\n\n\u0393, i\n\n\u0393, i\n\nC\u039b, Lp C\u039b0 , Lp\n(F.7)\n\nThe group T p -matrix can also be calculated directly from the symmetrization of the\nradial part of the basis function RLL0 (rip ), which transforms as T in Eqs. (F.4) and\n(F.6). Even though the number and type of operations to perform are exactly the\nsame as for obtaining T p , in this case there is the added advantage of generating a\nsymmetrized form of the scattering wave function, needed for example to calculate the\nabsorption or photo-emission cross-section.\nThe symmetrization of the local wave function in a group of equivalent atoms for\nan irrep \u0393 is obtained by observing that the following function \u03c8(rp ) is invariant under\nany operation of the group\nXX i i\n\u03c8(rp ) =\nALp RLp0 L (rip ) YL0 ( r\u0302ip )\nip\n\nLL0\n\n\u2261 hA|R|Y i\n \u0303 CC|Y\n \u0303\n= hA|CCR\ni\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states46\nX \u0393, p \u0393, p\n=\nA\u039b R\u039b0 \u039b (rp ) K\u039b\u0393,0 p ( r\u0302p )\n(F.8)\n\u039b\u039b0\n\nwhereby\np\nA\u0393,\n\u039b\n\n=\n\nX\n\n\u0393, i\n\ni\n\np\nC\u039b,mp Alm\n\nm ip\n\u0393, p\nR\u039b\u039b\n0 (rp )\n\n=\n\nNp\nX\nX\n\n\u0393, i\n\ni\n\n\u0393, i\n\nC\u039b, Lp RL,p L0 (rp ) C\u039b0 , Lp 0\n\nip m, m0\n\nInside the MT sphere X\u039b\u0393,0 \u039bp (rp ) \u2261 r R\u039b\u0393,0 \u039bp (rp ) is solution of the symmetrized equation\n(14)\n\u0013\n\u0015\nX \u0014\u0012 d2\nl(l + 1)\np\n+E\u2212\n\u03b4\u039b\u039b00 \u2212 V\u039b\u039b00 (r) X\u039b\u0393,00p\u039b0 (r) = 0\n2\n2\ndr\nr\n\u039b00\n\n(F.9)\n\np\nwhere we have written for simplicity r for rp and V\u039b\u039b\n00 (r) is given by\n\nV\u039b,\u03931\u039b, 0p (r)\n\n=\n\nNp\nX\nX\n\n\u0393 ,i\n\ni\n\n\u0393 ,i\n\nC\u039b,1L p VL,pL0 (r) C\u039b01, Lp0\n\n(F.10)\n\nip m, m0\n\u0393, p\n\u03931 being the identical representation of the group G. Near the origin X\u039b\u039b\n0 , (r) \u223c\n\u0393, p\nr jl (kr) K\u039b ( r\u0302p ) \u03b4\u039b\u039b0 .\nAcross the truncated boundary, we instead use the symmetrized version of Eq. (1),\np\nso that putting P\u039b\u0393, p (rp ) = r\u03a6\u0393,\n\u039b (rp ) and dropping again the index p\n\u0015\n\u0014 2\nd\n1\n+ E \u2212 V (r, r\u0302) P\u039b\u0393 (r, r\u0302) = 2 L\u03032 P\u039b\u0393 (r, r\u0302)\n(F.11)\n2\ndr\nr\n\nwhere\nL\u03032 P\u039b\u0393 (r, r\u0302) =\n\nX\n\nl0 (l0 + 1)rR\u039b\u0393 0 \u039b (r)K\u039b\u03930 ( r\u0302 )\n\n(F.12)\n\n\u039b0\n\nand we use starting values given by Eq. (F.9). Equation (F.11) is obtained from Eq.\nP\n\u0393\n(1) by applying on the left the projection operator R M\u03c1\u03c1j (R) PR , taking into account\nthat V (rip ) = V (R\u22121 ri0p ).\n\u0393\nIn terms of R\u039b\u039b\n0 (r) is then possible to define the symmetrized version of the matrices\nip\nip\nELL0 and SLL0 as\np\np 2\np\n+\nE\u039b\u039b\n0 = (Rb ) W [\u2212i\u03bahl , R\u039b\u039b0 ]\n\n(F.13)\n\np\nS\u039b\u039b\n0\n\n(F.14)\n\n=\n\np\n(Rbp )2 W [jl , R\u039b\u039b\n0]\n\nand derive the symmetrized equivalent of all the quantities introduced toward the end\nof section (3.1). In particular the amplitudes B\u039bp (k) are solutions of the symmetrized\nMSE\ni\nXh\n\u0393, p\npq\nq\np\n(T \u22121 )\u039b, \u039b0 \u03b4pq + G\u0393,\n(F.15)\n\u039b, \u039b0 B\u039b0 (k) = I\u039b (k)\nq \u039b0\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states47\nP\n\u0393, i\nip\nwhere I\u039bp (k) = m ip C\u039b,mp Ilm\n(k). Assuming that the photo-absorber is located in cell\n\u03a9o at the origin of the coordinates Ro , the symmetrized PED cross section for the final\nstate irrep \u0393 with degeneracy d(\u0393) takes the form\nX X\n2\nd\u03c3 \u0393\n(F.16)\nM\u039b\u0393cc\u039b\u0393 (E) B\u039bo (k)\n= 8 \u03c0 2 \u03b1 ~ \u03c9 d(\u0393)\ndk\u0302\nnc\nwhere the atomic dipole transition matrix element\nZ\n\u0393\n\u0393c \u0393\nM\u039bc \u039b (E) =\n\u03c6\u0393\u039bcc (r) D\u0393d (r) \u03a6\u039b (r) d r\n\n(F.17)\n\n\u03a9o\n\nobeys the selection rules of the Wigner-Eckart theorem [45] for the finite group G. We\nhave assumed that the dipole operator transforms according to the irrep \u0393d .\nAppendix G. Finiteness of T r (Ks\u2020 Ks )\nIn this appendix we show that T r (Ks\u2020 Ks ) is finite. Starting from Eq. (114), we partition\nthe space and the potential in the way described at the beginning of Section 3.1 and\ndefine a new kernel K\u0303 that coincides with the kernel Ks for r and r0 in different cells\nand vanishes identically when r and r0 happen to be in the same cell.\nFor this new kernel, T r(K\u0303 \u2020 K\u0303) is finite (\u2264 N < \u221e) for an even larger class of\npotentials than that defined by Eq. (114) so that, rewriting K\u0303(r, r0 ) in operator notation,\nwe have\nZ\nD\nE\nN\u2265\ndr r|K\u0303 \u2020 K\u0303|r\nZ Z Z\nX Z\n0\n00\n=\ndEdE dE\ndr hr|JL (E)i\n0\n\n00\n\nLL L\nD\nED\nE\n\u00d7 JL (E)|K\u0303 \u2020 |JL0 (E 0 ) JL0 (E 0 )|K\u0303|JL00 (E 00 ) hJL00 (E 00 )|ri\nZ Z\nX\n=\ndEdE 0\n|K\u0303LL0 (E, E 0 )|2\nLL0\n\n\u2265\n\nX\n\n|K\u0303LL0 (E, E)|2\n\n(G.1)\n\nLL0\n\ntaking into account that the functions JL (E)(r) = (k/\u03c0)1/2 jl (kr)YL (r\u0302), with the\nnormalization to one state per Rydberg, form a complete orthonormal set.\nNow it is easy to see that the matrix K\u0303LL0 is the asymptotic form of the kernel Ks\nin Eq. (118) for high values of the indices LL0 , since\nK\u0303LL0 (E, E)\nXZ\n=\ndri JL (E)(ri )|Vi (ri )|1/2 vi (ri )\ni6=j\n\n\u03a9i\n\nZ\n\n0\n0 1/2\ndr0j G+\nvj (r0j )JL (E)(r0j )\n0 (ri \u2212 rj + Rij ; k)|Vj (rj )|\nXXZ\n=\ndri JL (E)(ri )|Vi (ri )|1/2 vi (ri )J\u039b (E)(ri ) G\u0303ij\n\u039b\u039b0\n\n\u00d7\n\n\u03a9j\n\ni6=j \u039b\u039b0\n\n\u03a9i\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states48\nZ\n\u00d7\ndrj J\u039b (E)(r0j ) |Vj (r0j )|1/2 vj (r0j )JL (E)(r0j )\n\u03a9j\n\nXX\u0002\n\u00031/2 ij \u0002 i \u00031/2\ni\n\u223c\nTL\u039b\nG\u0303\u039b\u039b0 T\u039b0 L0\ni6=j\n\n(G.2)\n\n\u039b\u039b0\n\nthe last line following by the fact that asymptotically, when L\u039b, L0 \u039b0 \u001d kRbi (\u2200i),\nZ\n\u0002 i \u00031/2\ndri JL (E)(ri )|Vi (ri )|1/2 vi (ri )J\u039b (E)(ri )\n(G.3)\nTL\u039b\n\u223c\n\u03a9i\n\nNotice also that we have used the two center expansion for the free Green's Function\nij\n0\n0\nG+\n0 (r \u2212 r ; k) = J\u039b (E)(ri ) G\u0303\u039b\u039b0 J\u039b (E)(rj )\n\n(G.4)\n\nwhich might diverge if ri + rj > Rij , e. g. for neighboring cells. A similar problem\nis encountered when formulating the variational derivation of MST (see, for example,\nsection 6.5.3, page 140 and following of Ref. [13]). One way to solve it is to use the\ndisplaced cell approach [13], whereby one can write\nK\u0303LL0 (E, E)\n(\n)\nXX X\u0002\n\u0003\n\u0002\n\u0003\n1/2\n1/2\ni\n=\nTL\u039b\nJ\u039b\u039b (b)G\u039b\u039b0 (Rij + b) T\u039bi 0 L0\ni6=j\n\n\u039b\n\n(G.5)\n\n\u039b\u039b0\n\nprovided that |Rij + b| > Rbi + Rbj and the sums inside the curly brakets be performed\nfirst. Here J\u039b\u039b (b) is the usual translation operator in MST, given by Eq. (51) with the\nvector Rij replaced by the vector b. The tilde over the symbol Gij\n\u039b\u039b0 in Eq. (G.4) was\nmeant to be a reminder to use this procedure. Notice that the vector b depends only\non the geometry of the partition of the space in cells and is independent on l.\nIn this way the expression Eq. (G.5) is always convergent and is such that\nP\n\u2020\n2\n\u2020\nLL0 |K\u0303LL0 (E, E)| = T r(K\u0303 K\u0303) is finite. Consequently also T r (Ks Ks ) is finite.\nReferences\n[1]\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n[8]\n[9]\n[10]\n[11]\n[12]\n[13]\n[14]\n[15]\n\nKorringa J 1947 Physica 13 392\u2013400\nKohn W and Rostoker N 1954 Phys. Rev. 94 1111\u20131120\nSlater J C and Johnson K H 1972 Phys. Rev. B 5 844\u2013853\nAndersen O 1975 Phys. Rev. B 12 3060\u20133083\nKoelling D and Arbman G 1975 J. Phys. F 5 2041\nBei der Kellen S and Freeman A J 1996 Phys. Rev. B 54 11187\u201311198\nHuhne T, Zecha C, Ebert H, Dederichs P and Zeller R 1998 Phys. Rev. B 58 10236\u201310246\nAsato M, Settels A, Hoshino T, Asada T, Bl\u00fcgel S, Zeller R and Dederichs P 1999 Phys. Rev. B\n60 5202\u20135210\nPapanikolau N, Zeller R and Dederichs P 2002 J. Phys.: Condens. Matter 14 2799\u20132823\nOgura M and Akai H 2005 J. Phys.: Condens. Matter 17 5741\u20135755\nNesbet R K 1992 Phys. Rev. B 45 11491\u201311495\nButler W H, Gonis A and Zhang X G 1992 Phys. Rev. B 45 11527\u201311541\nGonis A and Butler W H 2000 Multiple Scattering in Solids (New York: Springer Verlag, Inc.)\nand references therein\nHuhne T and Ebert H 1999 Solid State Commun. 109 577\u2013582\nAnkudinov A L and Rehr J J 2005 Phys. Scr. T115 24\u201327\n\n\fFull-Potential Multiple Scattering Theory with Space-Filling Cells for bound and continuum states49\n[16] Natoli C R, Benfatto M, Brouder C, RuizL\u00f3pez M F and Foulis D L 1990 Phys. Rev. B 42\n1944\u20131968\n[17] Foulis D L, Pettifer R F, Natoli C R and Benfatto M 1990 Phys. Rev. A 41 6922\u20136927\n[18] Foulis D L Exact distorted-wave approach to multiple-scattering theory for general potentials to\nbe published\n[19] Joly Y 2001 Phys. Rev. B 63 125120:1\u201310\n[20] Taillefumier M, Cabaret D, Flank A and Mauri F 2002 Phys. Rev. B 66 195107\n[21] Hatada K, Hayakawa K, Benfatto M and Natoli C R 2007 Phys. Rev. B 76 060102R1\u20134\n[22] Hatada K, Hayakawa K, Benfatto M and Natoli C R 2009 J. Phys.: Condens. Matter 21 104206\n(12pp)\n[23] Williams A R and van W Morgan J 1974 J. Phys. C: Solid State Phys. 7 37\u201360\n[24] Kellog O D 1954 Foundations of Potential Theory (New York: Dover) pag. 259\n[25] Lebedev V I 1975 Computational Mathematics and Mathematical Physics 15 44\u201351\n[26] Wang X G and Jr T C 2003 Journal of Theoretical and Computational Chemistry 4 599\u2013608\n[27] Abramowitz M and Stegun I N (eds) 1972 Handobook of Mathematical Functions With Formulas,\nGraphs, and Mathematical Tables (Washington, D. C.: U. S. Goverment Printing Office)\n[28] Becke A D 1988 J. Chem. Phys. 88 2547\u20132553\n[29] Brastev V F 1966 Atomic Wavefunctions (Moscow: Nauka)\n[30] Fischer C F 1977 The Hartree-Fock Method for Atoms (John Wiley & Sons)\n[31] Mitchell A R and Griffiths D F 1977 The finite difference method in partial differential equations\n(John Wiley & Sons)\n[32] Amusia M Y and Chernysheva L V 1997 Computation of Atomic Processes (London: IOP\npublishing)\n[33] Natoli C R, Benfatto M and Doniach S 1986 Phys. Rev. A 34 4692\u20134694\n[34] Foulis D L 1988 The Effect of the Use of Full Potentials in the Calculation of X-Ray Absorption\nNear-Edge Structure by Multiple-Scattered-Wawe X-alpha Method Ph.D. thesis University of\nWarwick\n[35] Sebilleau D, Gunnella R, Wu Z Y, Matteo S D and Natoli C R 2006 J. Phys.: Cond. Matter 18\nR175\u2013R230\n[36] Faulkner J S and Stocks G M 1980 Phys. Rev. B 21 3222\u20133242\n[37] Smith F C and Johnson K H 1969 Phys. Rev. Lett. 22 1168\u20131171\n[38] Benfatto M, Natoli C R, Bianconi A, Garcia J, Marcelli A, Fanfoni M and Davoli I 1986 Phys.\nRev. B 34 5774\u20135781\n[39] Tricomi F G 1985 Integral Equations (New York: Courier Dover Publications)\n[40] Whittaker E and Watson G 1965 A course of modern analysis (Cambridge: Cambridge University\nPress)\n[41] Filipponi A, Ottaviano L, Passacantando M, Picozzi P and Santucci S 1993 Phys. Rev. E 48\n4575\u20134583\n[42] Natoli C R, Benfatto M, Longa S D and Hatada K 2003 J. Synchrotron Rad. 10 26\u201342\n[43] Hatada K, Hayakawa K, Chaboy J and Natoli C R 2009 J. Phys.: Conference Series 190 012010\n(4pp)\n[44] Hatada K and Chaboy J 2007 Phys. Rev. B 76 104411:1\u20136\n[45] Tinkham M 1964 Group Theory and Quantum Mechanics (New York: McGraw-Hill)\n\n\f"}