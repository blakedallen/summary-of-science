{"id": "http://arxiv.org/abs/1112.3094v2", "guidislink": true, "updated": "2012-05-29T21:41:24Z", "updated_parsed": [2012, 5, 29, 21, 41, 24, 1, 150, 0], "published": "2011-12-14T01:58:45Z", "published_parsed": [2011, 12, 14, 1, 58, 45, 2, 348, 0], "title": "Hydrodynamics in full general relativity with conservative AMR", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1112.2408%2C1112.3920%2C1112.1526%2C1112.5322%2C1112.4544%2C1112.3084%2C1112.5845%2C1112.1066%2C1112.3228%2C1112.6256%2C1112.5082%2C1112.2902%2C1112.4481%2C1112.5515%2C1112.2964%2C1112.1890%2C1112.1087%2C1112.6226%2C1112.4238%2C1112.0082%2C1112.5619%2C1112.3405%2C1112.1644%2C1112.1673%2C1112.6093%2C1112.3111%2C1112.5138%2C1112.3094%2C1112.2764%2C1112.2569%2C1112.5736%2C1112.1915%2C1112.5757%2C1112.6200%2C1112.0546%2C1112.5228%2C1112.0370%2C1112.3407%2C1112.0788%2C1112.6089%2C1112.1974%2C1112.2126%2C1112.1565%2C1112.0720%2C1112.0406%2C1112.1345%2C1112.4625%2C1112.6208%2C1112.5970%2C1112.0246%2C1112.6386%2C1112.2741%2C1112.3555%2C1112.3235%2C1112.3583%2C1112.1215%2C1112.6151%2C1112.2519%2C1112.0331%2C1112.3540%2C1112.0705%2C1112.5181%2C1112.6421%2C1112.4849%2C1112.0582%2C1112.2979%2C1112.0190%2C1112.6202%2C1112.4834%2C1112.5298%2C1112.4037%2C1112.5682%2C1112.2695%2C1112.0110%2C1112.3277%2C1112.3658%2C1112.0312%2C1112.3833%2C1112.1099%2C1112.0702%2C1112.1169%2C1112.4702%2C1112.2663%2C1112.4504%2C1112.5761%2C1112.5294%2C1112.3881%2C1112.6390%2C1112.3006%2C1112.5662%2C1112.3894%2C1112.5760%2C1112.5427%2C1112.4118%2C1112.3626%2C1112.2680%2C1112.3372%2C1112.1934%2C1112.0983%2C1112.3346%2C1112.5558&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Hydrodynamics in full general relativity with conservative AMR"}, "summary": "There is great interest in numerical relativity simulations involving matter\ndue to the likelihood that binary compact objects involving neutron stars will\nbe detected by gravitational wave observatories in the coming years, as well as\nto the possibility that binary compact object mergers could explain\nshort-duration gamma-ray bursts. We present a code designed for simulations of\nhydrodynamics coupled to the Einstein field equations targeted toward such\napplications. This code has recently been used to study eccentric mergers of\nblack hole-neutron star binaries. We evolve the fluid conservatively using\nhigh-resolution shock-capturing methods, while the field equations are solved\nin the generalized-harmonic formulation with finite differences. In order to\nresolve the various scales that may arise, we use adaptive mesh refinement\n(AMR) with grid hierarchies based on truncation error estimates. A noteworthy\nfeature of this code is the implementation of the flux correction algorithm of\nBerger and Colella to ensure that the conservative nature of fluid advection is\nrespected across AMR boundaries. We present various tests to compare the\nperformance of different limiters and flux calculation methods, as well as to\ndemonstrate the utility of AMR flux corrections.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1112.2408%2C1112.3920%2C1112.1526%2C1112.5322%2C1112.4544%2C1112.3084%2C1112.5845%2C1112.1066%2C1112.3228%2C1112.6256%2C1112.5082%2C1112.2902%2C1112.4481%2C1112.5515%2C1112.2964%2C1112.1890%2C1112.1087%2C1112.6226%2C1112.4238%2C1112.0082%2C1112.5619%2C1112.3405%2C1112.1644%2C1112.1673%2C1112.6093%2C1112.3111%2C1112.5138%2C1112.3094%2C1112.2764%2C1112.2569%2C1112.5736%2C1112.1915%2C1112.5757%2C1112.6200%2C1112.0546%2C1112.5228%2C1112.0370%2C1112.3407%2C1112.0788%2C1112.6089%2C1112.1974%2C1112.2126%2C1112.1565%2C1112.0720%2C1112.0406%2C1112.1345%2C1112.4625%2C1112.6208%2C1112.5970%2C1112.0246%2C1112.6386%2C1112.2741%2C1112.3555%2C1112.3235%2C1112.3583%2C1112.1215%2C1112.6151%2C1112.2519%2C1112.0331%2C1112.3540%2C1112.0705%2C1112.5181%2C1112.6421%2C1112.4849%2C1112.0582%2C1112.2979%2C1112.0190%2C1112.6202%2C1112.4834%2C1112.5298%2C1112.4037%2C1112.5682%2C1112.2695%2C1112.0110%2C1112.3277%2C1112.3658%2C1112.0312%2C1112.3833%2C1112.1099%2C1112.0702%2C1112.1169%2C1112.4702%2C1112.2663%2C1112.4504%2C1112.5761%2C1112.5294%2C1112.3881%2C1112.6390%2C1112.3006%2C1112.5662%2C1112.3894%2C1112.5760%2C1112.5427%2C1112.4118%2C1112.3626%2C1112.2680%2C1112.3372%2C1112.1934%2C1112.0983%2C1112.3346%2C1112.5558&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "There is great interest in numerical relativity simulations involving matter\ndue to the likelihood that binary compact objects involving neutron stars will\nbe detected by gravitational wave observatories in the coming years, as well as\nto the possibility that binary compact object mergers could explain\nshort-duration gamma-ray bursts. We present a code designed for simulations of\nhydrodynamics coupled to the Einstein field equations targeted toward such\napplications. This code has recently been used to study eccentric mergers of\nblack hole-neutron star binaries. We evolve the fluid conservatively using\nhigh-resolution shock-capturing methods, while the field equations are solved\nin the generalized-harmonic formulation with finite differences. In order to\nresolve the various scales that may arise, we use adaptive mesh refinement\n(AMR) with grid hierarchies based on truncation error estimates. A noteworthy\nfeature of this code is the implementation of the flux correction algorithm of\nBerger and Colella to ensure that the conservative nature of fluid advection is\nrespected across AMR boundaries. We present various tests to compare the\nperformance of different limiters and flux calculation methods, as well as to\ndemonstrate the utility of AMR flux corrections."}, "authors": ["William E. East", "Frans Pretorius", "Branson C. Stephens"], "author_detail": {"name": "Branson C. Stephens"}, "author": "Branson C. Stephens", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevD.85.124010", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1112.3094v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1112.3094v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "22 pages, 14 figures; revised according referee comments, PRD in\n  press", "arxiv_primary_category": {"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "astro-ph.HE", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1112.3094v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1112.3094v2", "journal_reference": "Phys. Rev. D 85, 124010 (2012)", "doi": "10.1103/PhysRevD.85.124010", "fulltext": "Hydrodynamics in full general relativity with conservative AMR\nWilliam E. East1 , Frans Pretorius1 , and Branson C. Stephens2\n1\n\narXiv:1112.3094v2 [gr-qc] 29 May 2012\n\n2\n\nDepartment of Physics, Princeton University, Princeton, New Jersey 08544, USA.\nCenter for Gravitation and Cosmology, University of Wisconsin-Milwaukee, Milwaukee, Wisconsin 53211, USA.\nThere is great interest in numerical relativity simulations involving matter due to the likelihood\nthat binary compact objects involving neutron stars will be detected by gravitational wave observatories in the coming years, as well as to the possibility that binary compact object mergers could\nexplain short-duration gamma-ray bursts. We present a code designed for simulations of hydrodynamics coupled to the Einstein field equations targeted toward such applications. This code has\nrecently been used to study eccentric mergers of black hole-neutron star binaries. We evolve the fluid\nconservatively using high-resolution shock-capturing methods, while the field equations are solved\nin the generalized-harmonic formulation with finite differences. In order to resolve the various scales\nthat may arise, we use adaptive mesh refinement (AMR) with grid hierarchies based on truncation\nerror estimates. A noteworthy feature of this code is the implementation of the flux correction algorithm of Berger and Colella to ensure that the conservative nature of fluid advection is respected\nacross AMR boundaries. We present various tests to compare the performance of different limiters\nand flux calculation methods, as well as to demonstrate the utility of AMR flux corrections.\nI.\n\nINTRODUCTION\n\nThe interface between strong field gravity and matter dynamics promises to be one of the important frontiers in the coming years. A new generation of gravitational wave detectors (LIGO [1], GEO [2],TAMA [3], and\nVIRGO [4]) are now operational, and within the next few\nyears are expected to reach sensitivities that will allow\nobservations of the Universe in gravitational radiation for\nthe first time. The prime targets of these observations\nare compact object (CO) binaries composed of combinations of black holes (BHs) and neutron stars (NSs).\nModeling of such sources is a crucial ingredient to realize the promise of gravitational wave astronomy. Even if\nan event is detected with a high signal-to-noise ratio, reconstructing the dynamics of the system that produced\nthe signal cannot be done directly but instead will require template banks of theoretical waveforms informed\nby numerical simulations.\nCompact object mergers involving NSs are expected\nto be significant sources of not only gravitational radiation, but also possible progenitors for short-gamma-ray\nbursts (SGRBs) [5\u20137] and other electromagnetic and neutrino counterparts [8]. Efforts are already underway to\nuse potential gravitational wave sources as triggers for\nsearches for electromagnetic transients [9, 10]. Observations would help constrain evolutionary models for the\nprogenitor stars and their environments. Perhaps most\nintriguingly, the observations would give clues to the\nequation of state (EOS) of matter at nuclear densities (as\nin NS interiors), which cannot be probed in laboratories\non Earth and is not fully understood at the theoretical\nlevel (for a broad discussion see for example [11]). The\nreason that the gravitational wave signature could contain information about the matter EOS (and other details\nabout the internal structure of neutron stars) is that the\nEOS in general has a significant effect on the bulk motion\nof matter, and it is this bulk motion that is the mechanism by which gravitational waves are produced. Several\n\nstudies to date have looked into this issue, suggesting the\nimprint of the EOS on the gravitational waves will be\nstrong enough to detect [12\u201323] (though, in some cases,\nthe expected frequencies are higher than the range to\nwhich the current generation of ground-based detectors\nare most sensitive, thus limiting the information which\ncan be extracted). While CO binaries containing NSs\nare a particularly interesting class of sources involving\ngeneral relativistic (GR) hydrodynamics, they are by no\nmeans the only such systems. Examples of additional\nsystems that have already been considered include BH\naccretion tori [24\u201327] and NS-white dwarf mergers [28].\nThoroughly modeling systems like those described\nabove would require evolution of the spacetime, the photon and neutrino radiation fields, and the magnetized,\nrelativistic fluid. Even a minimalistic treatment, with\nthe Einstein equations coupled to the equations of relativistic hydrodynamics, represents a complex, nonlinear\nsystem of partial differential equations. Numerical simulations are thus essential for exploring such strong field,\ndynamical systems. There is a long history of adapting\nsuccessful techniques for simulating Newtonian hydrodynamics to relativistic and general relativistic fluids which\nwe will not attempt to summarize (see [29] for a review\nof general relativistic hydrodynamics). Instead, we will\nbriefly attempt to place the code described in the present\npaper in the context of other recent codes developed for\nfluids on evolving spacetimes. 1\nSeveral of these codes [32\u201336] solve the field equations\nin the BSSN formulation [37, 38]. The remainder [39, 40]\nuse the generalized-harmonic formulation [41, 42] which\n\n1\n\nNote that our focus is restricted to codes which handle dynamically evolving gravitational fields. Such codes, however, frequently owe much to earlier, fixed-background evolution codes\n(see [29]). In addition, advancements such as GR-hydro with\nmultipatch grids [30] and with GPUs [31] have recently been\nmade with fixed-background codes.\n\n\f2\nwe also employ; unlike our code, however, these groups\nconvert to a fully first-order formulation [43]. Most\ngroups use finite-difference methods for the metric evolution and a conservative, high-resolution shock-capturing\n(HRSC) scheme for the hydro evolution; these unigrid\nalgorithms are then interfaced with some sort of adaptive mesh refinement (AMR). A notable exception for\nthe metric evolution is [39], which employs pseudospectral methods for the metric and then interpolates to a\nfinite-volume grid for the fluid.\nSome groups have implemented the MHD equations\nin full GR; since these codes all make use of conservative HRSC methods, they may be principally differentiated by how they meet the challenge of preserving the\n\u2207 * B = 0 constraint. (A straightforward finite-difference\nevolution of the magnetic field would generically lead to\nmagnetic monopoles and, hence, unphysical behavior.)\nWhiskyMHD employs constrained transport [34] for this\npurpose, which preserves the constraint to machine accuracy, whereas the code of [44] uses hyperbolic divergence cleaning. Constrained transport, however, requires\nspecial interpolation at refinement level boundaries in order to preserve the constraint. The Illinois group found\nthat a vector-potential formulation of the MHD equations works well when coupled to AMR [45]. This is because the constraint is preserved by construction with the\nvector-potential, even with the restriction and prolongation operations of AMR (see also [46] for a thorough examination of the electromagnetic gauge condition). Studies indicate that magnetic fields do not significantly affect\nthe gravitational dynamics of CO mergers (see e.g. [44]),\nbut they could be critical for understanding EM counterparts including the possible formation of a SGRB engine.\nA new method to treat the MHD equations was recently\npresented in [47], where ideal MHD is used in high matter density regions (e.g. inside a NS), while the force-free\napproximation is used elsewhere (e.g. the magnetosphere\nof a NS). The authors applied the method to study the\ncollapse of magnetized hypermassive NSs (which could\nbe formed via binary NS mergers) and suggested that\nintense EM outbursts could accompany such events.\nBesides MHD, the other major advances in the physical model for numerical relativity codes have been in\nthe arena of microphysics. While the \u0393 = 2 EOS was\nthe community standard for quite some time, most codes\nnow allow for a nuclear theory-based EOS [48, 49] and/or\nuse various parametrized, piecewise polytropic EOSs inspired by the range of plausible nuclear EOSs [50, 51].\nThese advances in EOS description primarily affect the\ncold NS structure, but the group developing the SACRA\ncode has also begun to account for neutrino transport\nvia a simplified leakage scheme [12, 52]. The same group\nhas also made available a formulation for a more accurate\ntruncated moment scheme with a variable Eddington factor closure [53], which shows much promise for numerical\nrelativity simulations with neutrino physics beyond the\nleakage approximation.\nAnother category of GR hydrodynamics codes employs\n\nthe conformal-flatness approximation, which is particularly useful when supernova simulations are the target\napplication. An example is CoCoNuT/VERTEX, which\nincorporates relativistic hydrodynamics, conformally flat\ngravity, and ray-by-ray neutrino transport [54]. The code\nof [55] employs a similar scheme for hydrodynamics and\ngravity but adds a test magnetic field; this code has been\nused to study the magnetorotational instability in supernovae.\nNewtonian (and semi-Newtonian) [56, 57], conformally\nflat [58, 59], and fixed-background [60] SPH codes represent an important, orthogonal approach to studying\nCO interactions. SPH has an advantage over Eulerian\nschemes when a large range of spatial scales is involved.\nSuch a situation may arise in CO mergers when material\nis stripped from a star in a tidal interaction and forms\nan extended tail. On the other hand, Eulerian codes are\nthe standard approach when strong shocks are present,\nas would arise in binary NS mergers or disk circularization. (Recent progress has been made, however, in applying SPH to situations with relativistic shocks [61].) In\naddition, SPH has not (to our knowledge) yet been coupled to a code which evolves the full Einstein equations.\nNonetheless, comparisons between Eulerian and SPH results could prove very useful on a problem-by-problem\nbasis to characterize the errors in both methods.\nThough current efforts in GR simulations involving\nmatter tend to focus on increasingly complex physical\nmodels, there remain many unanswered questions in the\nastrophysics of compact objects that can be addressed\nwith a code which solves the Einstein equations coupled\nto perfect fluid hydrodynamics. We have thus focused our\ncode development on hydrodynamics in full GR, while\nmaintaining a flexible infrastructure to accommodate additional physics modules in the future. We evolve the\nfield equations in the generalized-harmonic formulation\nusing finite differences. The fluid is evolved conservatively using one of several different shock-capturing techniques we test here. We have also implemented the hydrodynamical equations in a manner that is independent\nof EOS. We make use of AMR by dynamically adapting\nthe mesh refinement hierarchy based on truncation error estimates of a select number of the evolved variables.\nWe also utilize Berger and Colella [62] style flux corrections (also known as \"refluxing\") in order to make the\nuse of AMR compatible with the conservative nature of\nthe hydrodynamic equations. Though AMR flux corrections have been implemented in other astrophysical hydrodynamics codes (such as Athena [63], CASTRO [64],\nEnzo [65], and FLASH [66]), to our knowledge this algorithm has not been used previously for hydrodynamics\nsimulations in full general relativity.2 A further noteworthy feature of our implementation is that we store cor-\n\n2\n\nNote that \"flux correction\" here refers to the enforcement of conservation at AMR boundaries, not the recalculation of fluxes with\na more dissipative scheme to preserve stability as in Athena [67].\n\n\f3\nrections to the corresponding fluid quantity integrated in\nthe volume of a given cell instead of the flux, allowing\nfor easy implementation within a computational infrastructure that supports cell-centered but not face-centered\ndistributed data structures. The code described here has\nrecently been applied to studying BH-NS mergers with\neccentricity as may arise in dense stellar systems such as\ngalactic nuclear clusters and globular clusters [68, 69].\nIn the remainder of this paper we outline our computational methodology for simulating hydrodynamics coupled to the Einstein field equations and describe tests of\nthis methodology. In Sec. II we review the generalizedharmonic approach to solving the field equations and\npresent our methods for conservatively evolving a perfect fluid coupled to gravity, including our method for\ninverting the conserved quantities to obtain the primitive fluid variables and the implementation of flux corrections to enforce the conservation of fluid quantities across\nAMR boundaries. In Sec. III we present simulation results which test these methods, highlight the strengths\nand weaknesses of various shock -capturing techniques,\nand demonstrate the utility of the flux correction algorithm.\n\nII.\n\nare 28 \"fundamental\" variables {gab , Ha , \u2202t gab , \u2202t Ha },\nbut we directly discretize all first and second spatial gradients without the introduction of additional auxiliary\nvariables.\nAnalytically one can show [70] that if one begins with\ninitial data that satisfies the Hamiltonian and momentum constraints, initially set H a = \u0003xa , and then evolve\nthe metric according to (1) and the source functions according to some specified differential equations, then the\nconstraint equation H a \u2212 \u0003xa = 0 will be satisfied for\nall time. Numerically this statement will only be true to\nwithin truncation error, which can grow exponentially in\nblack hole space times; to prevent this we add constraint\ndamping terms as in [71, 72]. In practice, ensuring that\nH a \u2212\u0003xa is converging to zero for a given numerical simulation run at different resolutions provides an excellent\ncheck that the numerical solution is indeed converging to\na solution of the field equations.\nAs described in [42], the computational grid we use is\ncompactified so as to include spatial infinity. This way\nwe can impose boundary conditions on the metric simply\nby requiring that it be Minkowski. However we evolve\nthe metric of the uncompactified coordinates since the\ncompactified metric is singular at spatial infinity.\n\nCOMPUTATIONAL METHODOLOGY\nB.\n\nIn this section we begin by explaining the basic equations and variables we use to numerically evolve the Einstein equations in Sec. II A and then discuss the conservative formulation of the hydrodynamics equations that we\nuse in Sec. II B. The evolution of conserved fluid variables\nnecessitates an algorithm for inverting these quantities to\nobtain the primitive fluid variables which we present in\nSec. II C. Finally in Sec. II D we present the details of\nour algorithm for AMR with flux corrections.\n\nA.\n\nSolution of the Einstein equations\n\nWe solve the field equations in the generalizedharmonic formulation [41, 42] where we fix the coordinate degrees of freedom by specifying the evolution of\nthe source functions H a := \u0003xa . In this form the evolution equation for the metric, gab , becomes manifestly\nhyperbolic:\ng cd \u2202c \u2202d gab + \u2202b g cd \u2202c gad + \u2202a g cd \u2202c gbd\n+2H(a,b) \u2212 2Hd \u0393dab + 2\u0393cdb \u0393dca\n= \u22128\u03c0(2Tab \u2212 gab T )\n\n(1)\n\nwhere \u0393abc is the Christoffel symbol, Tab is the stressenergy tensor, and T is its trace. We evolve the metric,\nthe source functions, and their respective time derivatives\nusing fourth-order Runge-Kutta where the spatial derivatives are calculated using fourth-order accurate finitedifference techniques. In other words, we have reduced\nthe evolution equations to first order in time so that there\n\nConservative Hydrodynamics\n\nCoupled to gravity we consider a perfect fluid with\nstress-energy tensor\nT ab = \u03c1hua ub + g ab P ,\n\n(2)\n\nwhere h := 1 + P/\u03c1 + \u01eb is the specific enthalpy and ua is\nthe four-velocity of the fluid element. The intrinsic fluid\nquantities \u03c1, the rest-mass density; P , the pressure; and\n\u01eb, the specific energy are defined in the comoving frame\nof the fluid element. The equations of hydrodynamics are\nthen written in conservative form as follows [73]:\n\u2202t D + \u2202i (Dv i ) = 0\n\u0001 1\u221a\n\u221a\n\u2202t Sa + \u2202i\n\u2212gT i a =\n\u2212gT bc \u2202a gbc\n2\n\n(3)\n(4)\n\nwhere v i is the coordinate velocity, g is the determinant of\nthe metric, and the index i runs over spatial coordinates\nonly. Note that (4) explicitly contains the time derivative\nof the metric for index a = t. The conserved variables D\nand Sa are defined as follows:\n\u221a\nD := \u2212g\u03c1ut\n(5)\n\u221a\nSa := \u2212gT t a\n(6)\nwhere D is simply the time component of the matter 4current3 .\n\n3\n\nIn some implementations of the GR (magneto)hydrodynamic\nequations, see for e.g. [74], the analog of St in (6) that is evolved\n\n\f4\nIn some situations we wish to perform axisymmetric\nsimulations where we use the symmetry to reduce the\ncomputational domain to two dimensions. We do this\nusing a modification of the Cartoon method [75] as described in [42], where we take the x-axis as the axis of\nsymmetry, and only evolve the z = 0 slice of the spacetime. For the hydrodynamics this means that effectively\neach fluid cell becomes a cylindrical shell, and we use the\nfact that the Lie derivative of the fluid fields with respect\nto the axisymmetric killing vector are zero to rewrite the\ncoordinate divergences in the above equations as\n\u2202i (Dv i ) = \u2202x (Dv x ) + 2\u2202y2 (yDv y )\n(7)\n\u221a\nand similarly for \u2202i ( \u2212gT i a ) for the t and x components.\nFor the y component there is an additional source term\n\u221a\n\u221a\n\u221a\n\u2202i ( \u2212gT i y ) = \u2202x ( \u2212gT x y ) + 2\u2202y2 (y \u2212gTyy ) \u2212\n\u221a\n(Sz v z + \u2212gP/y). (8)\nBy writing the y flux contribution in terms of \u2202y2 we\nensure that when we discretize our evolution will be conservative with respect to the cylindrical shell volume element. We choose a special form for the equation for\nSz :\n\u221a\n\u221a\n2\n\u2202t Sz + \u2202x ( \u2212gT x z ) + \u2202y2 (y 2 \u2212gTzy ) = 0,\ny\n\n(9)\n\nsince in axisymmetry the quantity ySz is exactly conserved (that is, it has no source term).\nThe conservative evolution system is solved numerically using HRSC schemes. We briefly summarize the different methods we have implemented and test in this paper, though the references should be consulted for more\ncomplete details. For calculating intercell fluxes we have\nimplemented HLL [76], the Roe solver [77], and the Marquina flux [78] method. The HLL method is straightforward to implement since it does not require the spectral decomposition of the flux Jacobian and is based on\nestimates for the largest and smallest signal velocities.\nThe Roe solver works by solving the linearized Riemann\nproblem obtained using the flux Jacobian at each cell interface (using the so-called Roe average of the left and\nright states). The Marquina flux method is an extension\nof this idea that avoids the artificial intermediate state\nand switches to a more viscous local Lax-Friedrich-type\nmethod from [79] when the characteristic speeds change\n\nhas the rest-mass density D subtracted off. This could provide\nimproved results in situations where the rest-mass density is orders of magnitude larger than the internal or magnetic energy,\nand accuracy in these latter quantities is important. Though\nwe have not explored this alternative, in the scenarios studied\nhere (in particular since we are not looking at the behavior of\nmagnetic fields) the added effect of a small amount of internal\nrelative to rest energy on the dynamics of the fluid or metric\nwill be negligible, and we expect either definition of St to give\ncomparable accuracy results here.\n\nsign across the interface. Since the latter two methods\nrequire the spectral decomposition of the flux Jacobian,\nwe give it for our particular choice of conserved variables\nin the Appendix. For reconstructing fluid primitive variables at cell faces we have implemented MC and minmod [80], PPM [81] 4 , and WENO5 [83] 5 , all of which\nmay be used interchangeably with any flux method. MC\nand minmod are both slope limiter methods that reduce\nto linear reconstruction for smooth flows. Minmod is\nthe more diffusive of the two. In comparison, PPM and\nWENO5 are higher-order reconstruction methods. PPM\nis based on parabolic reconstruction with modifications\nto handle contact discontinuities, avoid spurious oscillations from shocks by reducing order, and impose monotonicity. WENO5 combines three different three-point\nstencils with weights that are determined by a measure\nof the smoothness of the quantity being reconstructed.\nThe specific fluid quantities that we reconstruct on the\ncell faces are \u03c1, u, and W U i , where u := \u03c1\u01eb, W is the\nLorentz factor between the local fluid element and an observer normal to the constant t hypersurfaces, and U i is\nthe Eulerian velocity (the explicit form of which is given\nin the following section). We choose to reconstruct W U i\ninstead of simply U i since any finite value of this quantity\ncorresponds to a subluminal velocity.\nThe fluid is evolved in time using second-order RungeKutta. Since the fluid is evolved in tandem with the\nmetric, the first and second substeps of the fluid RungeKutta time step are chosen to coincide with the first and\nthird substeps of the metric time step. Since the spatial discretization of the fluid equations that we use is\nonly second-order we choose to use second-order time\nstepping for the hydrodynamics and we have not yet\nexperimented with higher-order methods. We still use\nfourth-order Runge-Kutta for nonvacuum metric evolution (even though for evolutions with matter the overall\nconvergence rate will be no greater than second-order)\nboth for convenience and because in vacuum dominated\nregions we may expect some improvement in accuracy.\nFor general relativistic hydrodynamics we evolve the fluid\non a finite subset (though the majority) of the total grid\n(which as mentioned extends to spatial infinity through\nour use of compactified coordinates), and at the outer\nboundary for the fluid we impose an outflow condition.\nFinally, as is common practice for this method of simulating hydrodynamics, we require that the fluid density\nnever drop below a certain threshold, adding a so-called\nnumerical atmosphere. We give this numerical atmosphere a spatial dependence that makes it less dense approaching the boundaries6 and choose a maximum value\n\n4\n5\n6\n\nIn particular we use the reconstruction parameters presented\nin [82].\nSpecifically, we perform reconstruction with the stencils and\nweights presented in Section A2 of [84].\nSpecifically we let \u03c1atm (xc , yc , zv ) = \u03c1\u0304 cos2 (xc ) cos2 (yc ) cos2 (zc )\nwhere \u03c1\u0304 is a constant, and (xc , yc , zc ) are the compactified coordinates which range from -1 to 1.\n\n\f5\nthat makes it dynamically negligible (typically at least 10\norders of magnitude below the maximum density). The\natmosphere is initialized using a cold equation of state\n(e.g. a polytropic equation of state).\nC.\n\nPrimitive Inversion\n\nThe set of hydrodynamical equations is closed by an\nEOS of the form P = P (\u03c1, \u01eb). While the conserved variables Sa and D are simply expressed in terms of fluid\nprimitive variables (\u03c1, P , \u01eb, and v i ) and the metric, the\nreverse is not true. This necessitates a numerical inversion to obtain the primitive variables following each update of the conserved variables. The method we use is\nsimilar to the one used in [85] for spherical symmetry.\nFirst, we decompose the 4-dimensional metric into the\nusual ADM space plus time form\nds2 = gab dxa dxb\n= \u2212\u03b12 dt2 + \u03b3ij (dxi + \u03b2 i dt)(dxj + \u03b2 j dt) (10)\nwhere \u03b3ij is the spatial metric, \u03b1 the lapse function and\n\u03b2 i the shift vector. Then, from the metric and conserved\nvariables we construct two quantities,\nS 2 := \u03b3 ij Si Sj = \u03b3H 2 W 2 (W 2 \u2212 1)\n\u221a\nE := \u03b2 i Si \u2212 St = \u2212g(HW 2 \u2212 P ) ,\n\n(11)\n(12)\n\nwhere H := \u03c1h and \u03b3 is the determinant of the spatial\nmetric. We reduce the problem of calculating the primitive fluid variables from the metric and conserved variables to a one-dimensional root problem, where we begin\nwith a guess for H and iteratively converge to the correct\nvalue such that f (H) = 0 for some function. From (12)\nwe can choose\n\u221a\nf (H) = E/ \u2212g \u2212 HW 2 + P.\n(13)\nNote that given the metric and conserved variables, f (H)\nis only a function of H, and\u221acan be computed as follows.\nFirst, calculate W 2 = (1 + 1 + 4\u039b)/2 where\n\u039b :=\n\nS2\n= W 2 (W 2 \u2212 1) .\n\u03b3H 2\n\n(14)\n\nThen compute \u03c1 and \u01eb from\n\u221a\n\u03c1 = D/( \u03b3W ),\n\n(15)\n\n\u01eb = \u2212H(W 2 \u2212 1)/\u03c1 + W E/(D\u03b1) \u2212 1 ,\n\n(16)\n\nand\n\nrespectively. Once \u03c1 and \u01eb are known, P can be obtained\nfrom the equation of state, and then f (H) above. An\niterative procedure for solving f (H) = 0, where f (H)\nis calculated as just described, thus gives the primitive\nvariables \u03c1, P , and \u01eb. The three-velocity can then be\ncomputed from\n\u03b3 ij Sj\n,\nUi = \u221a\n\u03b3HW 2\n\n(17)\n\nwhere the Eulerian velocity U i is related to the grid\nthree-velocity through U i = (v i + \u03b2 i )/\u03b1. This inversion\nscheme is implemented so as to allow any EOS of the\nform P = P (\u03c1, \u01eb); thus, \u0393-law, piecewise polytrope, and\ntabular equations of state such as the finite-temperature\nEOS of Shen et al. [86, 87] (for a given electron fraction\nYe ) are all supported.\nIn practice we solve for f (H) = 0 numerically using\nBrent's method [88], which does not require knowledge\nof derivatives and is guaranteed to converge for any continuous equation of state as long as one begins with a\nbracket7 around the correct solution. This can be useful\nwhen dealing with equations of state interpolated from\ntabulated values. One can avoid losing accuracy in the ultrarelativistic and nonrelativistic limit by Taylor expanding the above inversion formulas (see [85]), for example,\nin 1/\u039b and \u039b, respectively. We have implemented such\nexpansions in our primitive inversion algorithm, though\nwe have not yet made any significant study of the inversion calculation in these regimes.\nIn some cases the conserved variables will, due to numerical inaccuracies, evolve to a state that does not correspond to any physical values for the primitive variables.\nThis causes the inversion procedure to fail. This can happen in very low density regions that are not dynamically\nimportant but still must be addressed. We handle such\nsituations using a method similar to that of [73] by ignoring the value of St and instead requiring the fluid to\nsatisfy a cold equation of state.\n\nD.\n\nAMR with flux corrections\n\nMany of the problems we are interested in applying\nthis code to involve a range of length scales, and in many\ncases we expect the small length scale features not to\nbe volume filling, for example the individual compact\nobjects in binary mergers. Such scenarios can be efficiently resolved with Berger and Oliger style adaptive\nmesh refinement [89]. A description of the variant of the\nalgorithm we use can be found in [90]; here we mention\nsome particulars to this implementation, and give a detailed description of the extension to ensure conservation\nacross refinement boundaries.\nThe computational domain is decomposed into a hierarchy of uniform meshes, where finer (child) meshes\nare entirely contained within coarser (parent) meshes.\nThe hierarchy is constructed using (primarily) truncation error (TE) estimates, which are computed within\n\n7\n\nThe initial bracket for the root finding is chosen by first checking\nif [H0 /(1 + \u03b4), H0 (1 + \u03b4)], where H0 is the value of H computed\nfor the primitive variables at the previous time step and \u03b4 > 0\nis a parameter we take to be 0.4, is a valid bracket around the\nzero of f (H). If it is not, as a failsafe we try successively larger\nbrackets with [H0 /(1 + \u03b4)n , H0 (1 + \u03b4)n ] for n \u2265 2.\n\n\f6\nthe Berger and Oliger time subcycling procedure by comparing the solution obtained on adjacent levels of refinement before the coarser levels are overwritten with the\nsolution from the finer level. Typically we only use the\nTE of the metric variables, since fluid variables in general\ndevelop discontinuities as well as turbulent features that\ndo not follow strict convergence. The layout of the AMR\nhierarchy is then periodically adjusted in order to keep\nthe TE below some global threshold. In some situations\nwe also require that a region where the fluid density is\nabove a certain threshold always be covered by a minimum amount of resolution. This can be used to ensure,\nfor example, that the resolution around a NS does not\ntemporarily drop below some level even if the TE of the\nmetric variables in the neighborhood of the star becomes\nsmall.\nWhen setting the values of the metric variables on the\nAMR boundary of a given child level we interpolate from\nthe parent level using third-order interpolation in time\nand fourth-order in space. For the cell-centered variables, the outer two cells in each spatial direction (for\na refinement ratio of 2) on a child level are initially set\nusing second order interpolation in time and space from\nthe parent level. Following the evolution of the child\nlevel and flux correction applied to the parent level when\nthey are in sync as described below, but before the cellcentered values on the child level are injected into the\nparent level, the values in the child boundary cells are\nreset using first-order conservative (spatial) interpolation\nfrom the parent level (i.e. the value in the child cell is\nset to be the same as that of the parent cell in which the\nchild cell is contained). This ensures that the boundary\ncells on the child level are consistent with the corresponding flux-corrected cells on the parent level but does not\naffect the order of convergence of the scheme since these\nvalues are not used in the evolution step. During a regrid\nwhen adding cells to the domain of a refined level we also\nuse first-order conservative interpolation from the overlapping parent level to initialize the values of the fluid\nvariables at new cells (fourth-order interpolation is used\nfor the metric variables). Note that the actual domain\nthat is refined is larger than the volume where the TE\nestimate is above threshold by a given buffer in any direction. The buffer size and regridding interval are chosen so\nthat if change in the region of high TE is associated with\nbulk motion of the solution (e.g. the NS moving through\nthe domain), this region will never move by more that\nthe size of the buffer between regrids. This ensures that\nnew cells (for this kind of flow) are always interpolated\nfrom regions of the parent that are below the maximum\nTE threshold. Thus, though the interpolation operation\nto initialize new cells is first-order, we find the error it\nintroduces is negligible (i.e., below the maximum desired\nTE).\nAMR boundaries require special treatment in conservative hydrodynamics codes however, since the fluxes\nacross the boundary of a fine-grid region will not exactly\nmatch the corresponding flux calculated on the coarse-\n\ngrid due to differing truncation errors. To enforce conservation, we correct the adjacent coarse grid cells using\nthe fine-grid fluxes according to the method of Berger and\nColella [62]. In the remainder of this section we review\nthe algorithm and outline our specific implementation.\nWe will concentrate on the evolution of D on a 3dimensional spatial grid, though the remaining conserved\nfluid quantities are treated the same way, and modification to different numbers of spatial dimensions is trivial.\nEquation (3) is evolved numerically at a given resolution\nas\nn+1\nn\nDi,j,k\n= Di,j,k\n\u2212\n\nx\nx\n)/\u2206x\n\u2212 Fi\u22121/2,j,k\n\u2206t[(Fi+1/2,j,k\ny\ny\n+(Fi,j+1/2,k\n\u2212 Fi,j\u22121/2,k\n)/\u2206y\n\nz\nz\n+(Fi,j,k+1/2\n\u2212 Fi,j,k\u22121/2\n)/\u2206z]\n\n(18)\n\nn\nwhere Di,j,k\nis the volume average of D over the (i, j, k)\nx\ncell at time t = n\u2206t; Fi+1/2,j,k\nis the flux F x = Dv x\nthrough the (i + 1/2, j, k) cell face; \u2206x is the x length of\neach cell and so on for the y and z direction. In practice the flux values will be calculated with some HRSC\ntechnique combined with Runge-Kutta, but the specifics\nare not relevant here. Now consider a situation with two\nsequential levels of refinement, L and L + 1, where level\nL+1 has a higher resolution with spatial refinement ratio\nof r in each direction, and its domain is a subset of level\nL. (In practice, we always take r = 2.) Here we focus\nthe discussion on a left boundary in the x direction, as\nillustrated in Fig. 1; boundaries along the right face and\nother coordinate directions are treated in a like manner.\nWhen evolving according to the Berger-Oliger algorithm, after each time step of length \u2206t is taken on level\nL, r steps of length \u2206t/r are taken on level L + 1. Then\nthe results obtained on L + 1 are injected into level L\nwhere the levels overlap i.e., the restriction operation is\nperformed conservatively by setting the value in the parent cell to the (coordinate) volume-weighted average of\nthe child cells that make up the parent cell. Now on level\nL, the change in D due to flux going through the cell face\n(iL + 1/2, jL , kL ) on a timestep will be\n\n\u03b4DL = \u2212\n\n\u2206t x\n(tn ).\nF\n\u2206x iL +1/2,jL ,kL\n\n(19)\n\nOn level L + 1, the change in D in one fine-level time step\ndue to flux passing through one of the r2 cell faces that\nmake up this same interface is\n\u2206t/r\n\u00d7\n\u2206x/r\nFixL+1 +1/2,jL+1 +j,kL+1 +k (tn + m\u2206t/r).\n\u03b4DL+1,j,k,m = \u2212\n\n(20)\n\nfor j, k, and m \u2208 {0, 1, . . . , r \u2212 1}. Now because\nof truncation error, in general the change in the net\n\"mass\" 8 \u03b4ML := \u03b4DL VL within the coarse-level cell\n\n8\n\nFor the conserved fluid variable D which we focus on for speci-\n\n\f7\n\nFIG. 1. A visualization of a refinement level boundary and its treatment in the flux correction algorithm. The top shows\ncells in the x direction on refinement level L while the bottom shows equivalent cells for the L + 1 refinement level (here the\nrefinement ratio is 2). Fluxes are symbolized by arrows. On the bottom level the blue cells (\"type B\" in the discussion in the\ntext) and those to the left on level L + 1 are boundary cells and will have their values set by interpolation from level L following\nan evolution step on level L. Because of truncation error, subsequent evolution on level L + 1 will give a flux differing from that\ncomputed on the parent level L. Consequently, when the new fine grid solution is injected back to the parent level (in cells to\nthe right of the red/dotted pattern cell), the solution about the boundary will no longer be consistent with the flux previously\ncomputed there. The correct this, the fluid quantity in the red/dotted pattern cell is adjusted to exactly compensate for the\ndifference in flux computed between the coarse and fine levels.\n\nat (iL , jL , kL ) computed with the coarse-level fluxes\nwill\nP not equal the corresponding quantity \u03b4ML+1 :=\nj,k,m \u03b4DL+1,j,k,m VL+1,j,k,m computed with the finelevel fluxes, where VL is the coordinate volume of the\ncell (iL , jL , kL ) and VL+1,j,k,m is the coordinate volume\nof the cell (iL+1 , jL+1 + j, kL+1 + k). Thus, after the values of D on level L + 1 are injected into level L (in cells\n(iL +1, jL , kL ) and to the right in this example), the solution on level L will suffer a violation of mass conservation\nproportional to \u03b4ML \u2212 \u03b4ML+1 . To restore the conservative nature of the algorithm, the idea, described in detail\nbelow, is to adjust the conservative variable D in the\ncell (iL , jL , kL ) post-injection by an amount to exactly\ncompensate for this truncation error induced difference.\nThe scheme originally proposed in [62] is to define\nan array that keeps track of a correction to the fluxes\nthrough cell faces on level L that make up the boundary\nof the evolved cells on level L + 1. Consider the case\nwhere (iL + 1/2, jL, kL ) is such a face. This face-centered\n\nficity, the value of the quantity integrated within the volume of\na cell in fact represents the rest mass in that cell. Throughout this section we will therefore use the term 'mass' to refer to\nthe value of a conserved fluid variable volume integrated within\na cell, though for other conserved fluid variables this will not\ncorrespond to a physical mass.\n\nflux correction array, \u03b4F , is initialized with the inverse\nof the flux in (19), \u03b4F = \u2212FixL +1/2,jL +j,kL +k , and then\nduring the course of taking the r time steps on level L + 1\nreceives corrections from the terms in (20)\n1 X x\n\u03b4F \u2192 \u03b4F + 3\nFiL+1 +1/2,jL+1 +j,kL+1 +k (tn +m\u2206t/r).\nr\nj,k,m\n\n(21)\nAfter the cell values on level L are overwritten by the\ninjected values on level L + 1 where they overlap, the\ncells on level L that abut level L + 1 though are not\nthemselves covered by level L + 1 cells are corrected with\nthe flux stored in \u03b4F .\nThe way we implement the flux correction algorithm\nis slightly different from this. In particular we wish to\navoid the added computational complexity of implementing face-centered grid functions, and therefore we keep\ntrack of a cell-centered correction. The correction is thus\nalso more naturally represented as a correction to the\nfluid quantity integrated within the volume of the cell\n(e.g. for D the rest-mass) rather than a flux. Again\nreferring to Fig. 1, we define the first few cells at the\nboundary of level L + 1 as buffer cells since the calculation of flux requires knowledge of the state on both sides\nof the interface. These cells will have their values set\nby interpolation from those in level L. The innermost\nbuffer cells for the boundary on level L + 1 we call type\n\n\f8\nB cells (blue cells in the lower half of the figure). These\nare the cells where the level L + 1 contribution to the\nmass correction will be stored. The cell on level L which\ncontains the type B cell we will refer to as a type A cell\n(red, dotted-pattern cell). Type A cells are the ones that\nreceive mass corrections in this algorithm. For each cell\non each refinement level we use a bitmask grid function\nthat indicates whether the cell is one of the above types\n(A or B), and if so which of the six possible faces (+x,\n\u2212x, +y, \u2212y, +z, \u2212z) abut the boundary. For simplicity\nin the implementation we do not allow grid hierarchies\nwhere a cell would be both type A and type B9 .\nIn the following we outline the additional tasks relative to the basic Berger-Oliger algorithm that need to\nbe performed with our implementation of Berger-Colella.\nFollowing the spirit of these algorithms, we break down\nthe tasks into those the AMR \"driver\" code implements,\nwhich do not require knowledge of the specific equations\nbeing evolved or what physical quantities the variables\nrepresent, and conversely the \"application\" steps that\nwould need to be implemented by a unigrid application\ncode plugging into the driver to become AMR-capable.\nThe driver tasks include the following:\n(i) For the conserved fluid density D, allocate a storage\ngrid function to keep track of the associated mass\ncorrection \u03b4M , i.e. the total correction to D within\nthe volume of a given cell.\n(ii) Upon initialization set all correction arrays \u03b4M to\nzero, and compute the bitmask for the current refinement hierarchy.\n(iii) After any regrid, recompute the bitmask array for\nthe new hierarchy.\n(iv) During the stage when buffer cells are set for variable D at interior boundaries on level L + 1 via\ninterpolation from level L, also interpolate the correction variable \u03b4M , where the latter's interpolation operator simply sets \u03b4M in a child cell to be\n1/r3 that of the parent cell (for a three-dimensional\nspatial grid).\n(v) Following injection of arrays D and \u03b4M from level\nL+1 to level L, where the injection operator for \u03b4M\nis an algebraic sum over child cells (a) zero all type\nB cells in \u03b4M on level L+1, (b) call the application\nroutine (first item in the next list) to apply the mass\ncorrections to D stored in the injected \u03b4M to type\nA cells on level L, (c) zero all type A cells in \u03b4M\non level L.\n\n9\n\nIn other words, an inner (non-physical) boundary on level L must\nbe at least one cell away from any inner boundary on level L \u2212 1.\nIf the hierarchy is generated by truncation error which is sufficiently smooth, inner boundaries will typically not be coincident.\nAlso, experience suggests it is often more challenging to get an\nAMR evolution stable if inner boundaries are too close, so in all\nthis restriction is not particularly limiting.\n\nThe following are new tasks that the unigrid application\ncode needs to implement:\n(i) A routine that will add the mass corrections stored\nin \u03b4M to D for all type A cells on a given grid (i.e.,\nset DL \u2192 DL + \u03b4M/VL )10 .\n(ii) When taking a single time step on a grid, for any\ncell marked type A, set \u03b4M to minus the change\nin mass of the cell from fluxes through cell faces\nindicated by the bitmask. For example, with the\ncase illustrated in Fig.1 and discussed above around\nEqs. (19) and (20), set \u03b4ML = \u2212VL \u03b4DL .\n(iii) When taking a single time step on a grid, for\nany cell marked type B, add to \u03b4M the change\nin mass of the cell from fluxes through cell faces\nindicated by the bitmask. For example, with the\nsame example above, set \u03b4ML+1,j,k \u2192 \u03b4ML+1,j,k +\nVL+1,j,k,m \u03b4DL+1,j,k,m .\nFor the GR-hydro equations we have five conserved\nfluid variables, D and Sa . Though the latter do have\nnonzero source terms - since gravity can be a source\n(or sink) of energy-momentum - the above algorithm\nensures there will be no artificial loss/gain in the presence of AMR boundaries due to truncation error from\nthe advection terms.\nIII.\n\nTESTS\n\nIn this section we present a number of tests of the\nmethods presented above. We begin by demonstrating\nthe fourth-order convergence of the evolution of the Einstein equations for vacuum spacetimes before moving on\nto a number of flat space, relativistic hydrodynamics tests\nthat probe the treatment of fluid discontinuities. We\nconclude with several tests of hydrodynamics in curved\nspacetimes.\nA.\n\nVacuum evolution\n\nIn [42, 91] several tests of convergence of an earlier\nversion of the code (without hydrodynamics) were presented. However, since then we have updated the evolution of the Einstein equations to fourth-order spatial\n\n10\n\nSince we consider D a density and \u03b4M a mass, this requires\nnormalization by the volume element VL , which the application\nknows. Note that in our code even though\n\u221a we have included\nthe uncompactified metric volume element \u2212g in the definition\nof the conservative variables and fluxes, compactification (and\nin axisymmetry, the cylindrical shell volume element) effectively\nmakes the grid non-uniform and so the volume scaling is nontrivial. An alternative implementation could move this correction step to the driver list of tasks, though then the application\nwould need to supply the driver with the array of local volume\nelements.\n\n\f9\ndifferencing and fourth-order Runge-Kutta time differencing, so we first show two vacuum tests: a Brill wave\nevolution [92, 93] and a boosted BH evolution.\n\n\u22128\nLow res.\nMed. res. \u00d7 (1.5)4\n\n\u22129\n\nHigh res. \u00d7 (2)4\n\n\u0010\neB y 2 + z 2 2\ndy +\nds2 = \u03c8 4 eB dx2 +\nr2\n(eB \u2212 1)yz\neB z 2 + y 2 2 \u0011\n(22)\n(dydz\n+\ndzdy)\n+\ndz\nr2\nr2\np\nwhere r = y 2 + z 2 , B = 2Ar2 exp(\u2212(r/\u03c3r )2 \u2212(x/\u03c3x )2 ),\nand the value of the conformal factor \u03a8 is determined by\nsolving the Hamiltonian constraint. We choose A = 40,\n\u03c3r = 0.16, and \u03c3x = 0.12. The initial data is chosen to be\ntime symmetric (\u03b3\u0307ij = 0) and maximally sliced (K = 0)\nwith the conformal lapse \u03b1\u0303 := \u03a8\u22126 \u03b1 = 1. The remaining\nmetric components are chosen to satisfy the harmonic\ngauge (\u0003xa = 0). This describes a gravitational wave\nthat initially collapses inward before dispersing. In Fig. 2\nwe show results from convergence tests in axisymmetry at\nthree resolutions where the medium and high runs had,\nrespectively, 1.5 and 2 times the resolution of the low\nrun. The constraint equations (Ha \u2212 \u0003xa = 0) as well as\nthe metric components show the expected fourth-order\nconvergence.\n\n2.\n\n\u221212\n\u221213\n\u221214\n\u221215\n0\n\n50\n\n100\ntime (M)\n\n150\n\n\u22120.8\n\u22121\n\ntt\n\nFor the Brill wave test we begin with initial data where\nthe spatial line element is given by\n\n\u221211\n\ng\n\nBrill wave\n\n\u22121.2\n\u22124\n\nx 10\n\n\u2206 gtt\n\n1.\n\nln(||Ca||M)\n\n\u221210\n\n4\n2\n0\n\u22122\n\u22124\n0\n\nMed\u2212Low res.\n(High\u2212Med.res)\u00d7 5.94\n\n50\n\n100\ntime (M)\n\n150\n\nBoosted BH evolution\n\nAs an additional vacuum spacetime test we evolved a\nboosted BH in three dimensions. We began with initial\ndata describing a BH in harmonic coordinates [94] with\nboost parameter v = 0.25. As described in [42], during\nthe evolution we avoid the BH singularity by searching\nfor an apparent horizon and excising a region within.\nTo demonstrate convergence we performed this simulation at three resolutions, the lowest of which has approximately 30 points covering the diameter of the BH. The\nmedium (high) resolution has 1.5 (2.0) times the number\nof points in each dimension, respectively. For all resolutions we used the same AMR hierarchy, determined\nbased on truncation error estimates at the lowest resolution, with six levels of 2:1 refinement. In Fig. 3 we\ndemonstrate that the constraint equations are converging\nto zero at fourth-order. When hydrodynamics is included\nthe theoretical limiting convergence rate of our code will\ndrop to second-order (in the absence of shocks). However\nin vacuum dominated regions, for example the gravitational wave zone, one can expect that for the finite resolutions we can practically achieve the convergence will\nbe somewhere between second- and fourth-order.\n\nFIG. 2. Top: The natural log of the L2 norm of the constraint violation, Ca :=\na Brill wave evolution\nqRHa \u2212 \u0003xa , for\nR\n2\n2\n2\n(i.e. natural log of\n|Ca | d x/ d x). The three resolutions shown are scaled assuming fourth-order convergence.\nTime is shown in units of M , the total ADM mass of the spacetime, and the constraints are multiplied by M to make them\ndimensionless. The lowest resolution has a grid spacing of\nh = 1.56M . Middle/Bottom: The value of the metric component gtt evaluated at (x, y, z) = (0, 50M, 0) (middle) and\nthe difference in this quantity between low and medium resolution, and medium and high resolution (bottom), the latter\nscaled so that the two curves should coincide for fourth-order\nconvergence.\n\nB.\n\nRelativistic hydrodynamic tests in flat\nspacetime\n\nWe have performed a number of standard tests for relativistic, inviscid hydrodynamics that probe how well a\ngiven numerical scheme handles the various discontinuities that arise. The best combination of reconstruction\nand flux calculation methods depends on the problem\n\n\f10\n\u22125\n\nx 10\n8\n\n||Ca||MBH\n\n6\n\n4\n\nLow res.\n4\nMed. res. \u00d7 1.5\n\n2\n\nHigh res. \u00d7 24\n0\n0\n\n5\n\n10\n15\ntime (MBH)\n\n20\n\n25\n\nFIG. 3.\nThe L2 -norm of the constraint violation (Ca :=\nHa \u2212 \u0003xa ) in the equatorial plane for a boosted BH simulation with v = 0.25. The three resolutions shown are scaled\nassuming fourth order convergence. Time is shown in units\nof MBH , the ADM mass of the BH in its rest frame, and the\nnorm of the constraints is multiplied by MBH so as to make\nit dimensionless.\n\nunder consideration. We have thus implemented several\noptions and maintained a modular code infrastructure\nso that they are readily interchangeable and upgradable.\nWhile strong shocks such as the ones considered here are\nnot expected to play an important dynamical role in binary BH-NS mergers, they might be important in other\npotential applications of interest (such as NS-NS grazing\nimpacts, or understanding EM emission from collisions).\nThus, the ability to tailor the reconstruction and flux\nmethods to the problem at hand may prove important\nin the future. In this section, we closely follow the sequence of tests used in the development of the RAM code\nof Zhang and MacFadyen [95], so that our results may\nbe compared with theirs. Though they focus on more sophisticated flux-reconstruction algorithms, their simpler\nmethods (labeled U-PPM and U-PLM, denoting reconstruction of the unknowns with piecewise parabolic and\nlinear reconstruction, respectively) are comparable to the\nones we employ.\n1.\n\n1D Riemann problems\n\nWe first present a series of four relativistic, onedimensional (1D) Riemann problem tests for which the\nexact solution is known (see Sections 4.1-4.4 of [95]). In\nall cases, the domain is x \u2208 [0, 1] and there are initially\ntwo fluid states, a left and a right, initially separated by\nan imaginary partition at x = 0.5. At t = 0, the partition is removed and the fluid evolves to some new state.\n\nA \u0393-law EOS is used for all the tests. In Table I we\nsummarize the initial states and adiabatic indices used\nfor the four tests, which we label as RT1 (Riemann Test\n1), RT2, RT3, and TVT (Transverse Velocity Test). We\ncompare the performance of the various combinations of\nreconstruction schemes and flux methods to the exact solution and summarize the errors and convergence rates in\nTable II. Exact solutions to these four tests were generated using a solver provided by B. Giacomazzo, which is\ndescribed in [96]. Taking HLL as our basic flux method,\nwe performed this series of Riemann problem tests with\nfour reconstruction methods: MC, minmod, WENO5,\nand PPM. For MC and WENO5, we also explored the\neffect of the flux method by running the tests with the\nRoe solver and Marquina's method. Most cases have a\nCourant-Friedrichs-Lewy (CFL) factor of 0.5. However,\nthe Roe solver, when combined with WENO5, does not\nseem to work well for problems with very strong shocks,\nsuch as RT2 and TVT. For a CFL factor of 0.5, we obtain acceptable results with Roe only by using a more\ndiffusive limiter (like MC). For RT2 and TVT, we thus\nuse Roe combined with WENO5 with a CFL factor of\n0.1.\nAll of the methods we considered perform well on RT1,\nwhich is a fairly easy test. The lowest overall error occurs\nfor WENO5 reconstruction (though the density profile\nbetween the shock and the contact discontinuity seems\nnot to be as flat as in the other cases). The overall success of WENO5 may be due to the fact that the shock is\nrelatively mild and there is an extended rarefaction that\nbenefits from the high-order reconstruction. In Fig. 4 we\ncompare the density profile obtained using HLL and various reconstruction methods to the exact solution. We\nnote that the tests which used the Roe or Marquina flux\ncalculation with WENO5 do not have the oscillation visible in the plot around x = 0.8 in the HLL-WENO5 case.\nThe second Riemann test (RT2) is more difficult than\nthe first, with the blast wave resulting in a very thin shell\nof material bounded by a shock on the right and a contact\ndiscontinuity on the left (see Fig. 5). The average convergence rates for this test show a marked difference between the piecewise-linear and higher-order reconstruction methods. WENO5 seems to perform best, but there\nis not much difference between HLL and Marquina or the\nRoe solver (with diminished CFL factor) with WENO5.\nAs in RT1, the reconstruction method seems to be more\nimportant to the solution than the flux scheme.\nRT3 is a challenging problem in which the fluid on\nthe left collides with the initially stationary fluid on the\nright, resulting in two shocks separated by a contact\ndiscontinuity. Our numerical solutions suffer from significant oscillations (particularly in the reverse shock)\nfor all reconstruction schemes except PPM, which was\nspecifically designed to suppress such post-shock oscillations (see Fig. 6). PPM also has the best convergence\nproperties (0.85-1.16), with an average rate close to the\nexpected value of unity. (Finite-volume hydrodynamic\nschemes such as this should converge at first order to a\n\n\f11\nTest \u0393a\nRT1\nRT2\nRT3\nTVT\n\nPL\n\n\u03c1L vL\n\nPR \u03c1R\n\n5/3 13.33 10.0 0.0 10\u22128\n5/3 1000.0 1.0 0.0 10\u22122\n4/3 1.0 1.0 0.9 10.0\n5/3 1000.0 1.0 0.0 1.0\n\nvR\n\n1.0\n0.0\n1.0\n0.0\n1.0\n0.0\n1.0 (0.0, 0.99)b\n\nTABLE I. The initial left and right states for the 1D Riemann problems.\na\nAdiabatic index of EOS\nb\nIn this case vx =0 but the transverse velocity vy = 0.99 is nonzero.\n\nReconstruction Flux method\n\nRT1\nRT2\nRT3\nTVT\nb\nError Convergence Error Convergence Error Convergence Error Convergence\na\n\nMC\n\nMinmod\nWENO5\n\nPPM\n\nHLL\nRoe\nMarquina\nHLL\nHLL\nRoe\nMarquina\nHLL\n\n0.034\n0.032\n0.036\n0.061\n0.033\n0.032\n0.036\n0.041\n\n0.82\n0.82\n0.82\n0.86\n0.84\n0.85\n0.85\n0.88\n\n0.110\n0.110\n0.127\n0.169\n0.093\n0.096\n0.093\n0.133\n\n0.59\n0.60\n0.59\n0.42\n0.76\n0.79\n0.76\n0.67\n\n0.062\n0.052\n0.056\n0.054\n0.039\n0.039\n0.038\n0.024\n\n0.77\n0.80\n0.79\n0.71\n0.61\n0.60\n0.66\n1.01\n\n0.238\n0.233\n0.227\n0.395\n0.191\n0.198\n0.183\n0.248\n\n0.72\n0.72\n0.76\n0.76\n0.83\n0.81\n0.82\n0.78\n\nTABLE II. 1D Riemann test results.\na\nThe L1 norm of the error for resolution N = 400.\nb\nThe average convergence rate between runs with N = 200, 400, 800, and 1600. The ideal rate is unity for problems such as\nthese containing discontinuities.\n\nweak solution of the equations when discontinuities are\npresent.)\nFor the transverse velocity test, the initial data are\nset up as in RT2, except that there is a transverse velocity v y = 0.99 on the right side of the partition. The\nstrong shock propagates into the boosted fluid, and the\nstructure of the shock is altered, since the velocities in\nall directions are coupled through the Lorentz factor [98].\nAgain, the reconstruction technique influences the result\nmore than the flux calculation. For WENO5 reconstruction, the errors for HLL, Roe, and Marquina are all very\nclose in magnitude. WENO5 and PPM yield the best\nresults overall. In Fig. 7 we show the density profile at\ndifferent resolutions for HLL combined with WENO5.\n\n2.\n\n1D Shock-heating problem\n\nWe next consider a one-dimensional shock-heating\nproblem as in [95], which tests a code's conservation of\nenergy as well as the ability to handle strong shocks.\nFor this problem, the computational domain is x \u2208 [0, 1]\nwith a reflecting boundary at x = 1. The fluid moves\ntoward this boundary with an ultrarelativistic initial velocity of v = 1 \u2212 10\u221210. The fluid has an initial density of\n\u03c1 = 1.0 and a very small amount of specific internal energy, \u01eb = 0.003. The EOS is a gamma-law with \u0393 = 4/3.\n\nWhen the relativistic fluid slams into the wall, its kinetic\nenergy is converted into internal energy behind a shock\nwhich propagates to the left. Because the fluid is initially\ncold, essentially all of the heat is generated through this\nconversion. As explained in [95], the shock speed and\nthe compression ratio of the shock (or equivalently, the\npost-shock density) is known analytically. We evaluate\nour errors by calculating the L1 norm of the density errors on the entire computational domain. The average\nrate of convergence is also calculated using this measure\nof error.\n\nWe performed this test using HLL with five different\nreconstruction methods at four different resolutions (200,\n400, 800, and 1600 zones). Results are shown in Table III. We find that, due to the extremely strong shock,\nthere is a tendency for post-shock oscillations to form\nwith less diffusive reconstruction schemes (see Fig. 8).\nThe WENO5 solution is afflicted with severe post-shock\noscillations and exhibits poor convergence to the exact\ncompression ratio. Very diffusive reconstruction schemes\n(zero slope and minmod) are comparatively quite successful and converge rapidly to the exact compression ratio.\nPPM, with its flattening step, gives the best convergence\nrate overall.\n\n\f12\nRiemann Test 3\n\nRiemann Test 1\n10\n\n8\nminmod\nMC\nWENO-5\nPPM\nexact\n\n8\n\nminmod\nMC\nWENO-5\nPPM\nexact\n\n6.8\n\n6\n\n6.4\n\n6\n\ndensity\n\ndensity\n\n6.6\n\n4\n\n6.2\n4\n\n6\n0.45\n\n6\n4\n\n0.5\n\n0.55\n\n0.6\n\n2\n\n2\n2\n0.8\n\n0.75\n0\n\n0\n\n0.85\n\n0.2\n\n0.4\n\n0.6\n\nx\n\n0\n\n0.8\n\nFIG. 4. Density at t = 0.4 for Riemann Test 1 (RT1) with\ndifferent reconstruction methods and the HLL flux scheme at\nresolution N = 400. The inset shows the shock and contact\ndiscontinuity. The exact solution was generated using the\ncode of [97].\n\n0\n\n0.2\n\n0.4\n\nx\n\n0.8\n\n0.6\n\nFIG. 6. Density at t = 0.4 for Riemann Test 3 (RT3), a\ncollision problem, for different reconstruction methods with\nHLL at resolution N = 400. The post-shock oscillations are\nlargest in the MC case and smallest for PPM.\n\nTransverse Test\n\nRiemann Test 2\n30\n10\n\n200\n400\n800\n1600\nexact\n\n10\n8\n\n20\n\ndensity\n\ndensity\n\n8\n\n6\n6\n4\n2\n\n4\n\n0\n\n24\n15\n\n10\n22\n0.88\n\n0.86\n\n0.9\n\n0.92\n\n0.94\n\n0.8 0.82 0.84 0.86 0.88 0.9\n\n5\n\n2\n\n0\n\nexact\n200\n400\n800\n1600\n\n25\n\n0\n0\n\n0.2\n\n0.4\n\nx\n\n0.6\n\n0.8\n\nFIG. 5. Density at t = 0.4 for Riemann Test 2 (RT2) at different resolutions for HLL-WENO5. The average convergence\nrate in this case is 0.76. The thin shell of material between\nthe shock and the contact is particularly difficult to resolve.\n\n3.\n\nEmery step problem\n\nNext we consider the two-dimensional (2D) Emery step\nproblem [81, 99], with the setup as in [95]. In this scenario, a fluid flows through a wind tunnel at relativistic\nspeed and hits a step, which is represented by a reflecting boundary condition. The computational domain is\n(x, y) \u2208 [0, 3] \u00d7 [0, 1] \u2212 [0.6, 3] \u00d7 [0, 0.2] where the subtracted region represents the step. At the left boundary,\n\n0\n\n0.2\n\n0.4\n\nx\n\n0.6\n\n0.8\n\nFIG. 7. Density at t = 0.4 for the transverse test (TVT) at\ndifferent resolutions for HLL-WENO5. The average convergence rate in this case is 0.83.\n\ninflow conditions are enforced (as in the initial data),\nwhile at the right, outflow conditions are enforced. All\nremaining boundaries are reflecting. The fluid is initialized with density \u03c1 = 1.4, velocity vx = 0.999, and a\n\u0393 = 1.4 EOS. The pressure is set to 0.1534, giving a\nNewtonian Mach number of 3.0.\nHigher-order reconstruction methods seem to be essential for this test problem. We find that the MC limiter\nperforms poorly, regardless of the flux method. Although\nthe MC simulation is stable, the bow shock formed as\n\n\f13\nReconstruction Errora Convergenceb\nZERO\n950\n0.94\nMinmod\n801\n0.92\nMC\n1500\n0.85\nPPM\n824\n0.96\nWENO5\n1670\n0.53\n\ntial fluid states in the lower/upper, left/right quadrants\nare\n\nTABLE III. Shock -heating test results. For this test we also\ncompare to zero slope reconstruction, labeled \"ZERO.\"\na\nThe L1 norm of the error for resolution N = 400.\nb\nThe average convergence rate between runs with N = 200,\n400, 800, and 1600.\n\n(\u03c1, P, vx , vy )UR = (0.1, 0.01, 0, 0).\n\n(\u03c1, P, vx , vy )LL = (0.5, 1, 0, 0)\n(\u03c1, P, vx , vy )LR = (0.1, 1, 0, 0.99)\n(\u03c1, P, vx , vy )UL = (0.1, 1, 0.99, 0)\n\nIn this simulation the lower-right and upper-left quadrants converge on the upper-right quadrant creating a\npair of curved shocks. We use a \u0393 = 5/3 EOS. In Fig. 10\nwe show results from simulations using HLL or the Marquina flux method combined with WENO5 or the MC\nlimiter. The first three panels are from runs with resolution of 400 \u00d7 400 and a CFL factor of 0.5 and are comparable to [95] and the references therein. Though the\nmain shock features are captured by all of the methods\nwe considered, oscillations arising from the curved shock\nfronts are evident in varying degrees. The fourth panel is\nsimilar to the first but contains a refined mesh in the center that has the same resolution as the other three panels,\nwhile the remainder of the domain has half the resolution. Though the majority of the flow is thus effectively\nderefined, the principal features remain the same. This\nis despite the fact that the shocks must travel through\nor along refinement boundaries, and the numerical shock\nspeeds differ slightly on either side of such boundaries\ndue to the different truncation errors.\n\nShock Heating Test\n4e+05\nZERO\nMINMOD\nMC\nPPM\nWENO5\n\n3e+05\n\ndensity\n\n4e+05\n\n2e+05\n\n3e+05\n\n2e+05\n1e+05\n\n1e+05\n\n0\n0.3\n0\n\n0\n\n0.2\n\n0.4\n\nx\n\n0.32\n0.6\n\n0.34\n\n0.36\n\n0.38\n\n0.8\n\nFIG. 8. Density at t = 2.0 for the shock-heating test with\ndifferent reconstruction methods and the HLL flux scheme.\nThe inset focuses on the shock front.\n\n1\n\nC.\n\nHydrodynamic tests in curved spacetime\n1.\n\nthe fluid reflects off the step is distorted by large amplitude post-shock oscillations. These propagate downstream, rolling up the boundaries between the different\nsolution regions. The higher resolution runs with MC\nalso have these features, but at shorter wavelengths and\nlower amplitude. PPM and WENO5 reconstruction performs much better, and these results are shown at two\nresolutions in Fig. 9. (This figure can be compared to\nthose of [95, 100].) The PPM results appear slightly better than WENO5 at a given resolution, likely because of\nthe deliberate oscillation suppression in the PPM algorithm.\n\n4.\n\n2D shock tube problem\n\nAs an additional test of these algorithms' ability to\npropagate strong, multidimensional shocks we consider a\n2D shock tube test. The computational domain (x, y) \u2208\n[0, 1]\u00d7[0, 1] is divided into four equal quadrants. The ini-\n\nBondi accretion\n\nAs a first test of our code's ability to simulate relativistic hydrodynamics in the strong field regime, we consider Bondi flow. We set up our initial conditions with\na stationary solution to spherical accretion onto a black\nhole [101]. We use Kerr-Schild coordinates for the black\nhole metric. In order to test our code's ability to converge\nto the correct solution we measured how the conserved\ndensity D differed from the exact solution as a function\nof time for three resolutions. The lowest resolution has\na grid spacing of h = 0.078MBH , while the medium and\nhigh resolutions have twice and 4 times the resolution respectively. As shown in Fig. 11, ||D \u2212 Dexact|| converges\nto zero at second-order. For this test we tried both the\nMC and WENO5 limiters (with HLL for the flux calculation). Though both had similar levels of error and showed\nthe expected convergence, WENO5 had larger errors at\nlow and medium resolutions. This is probably because,\nat lower resolutions, the larger WENO5 stencil extends\nfarther inside the black hole horizon where there is larger\ntruncation error.\n\n\f14\n\nFIG. 9. Density contours (30 equally spaced in the logarithm) for the Emery step problem. The upper (lower) two plots\nshow results for resolution 240 \u00d7 80 (480 \u00d7 160). For each resolution, the upper plot shows results for WENO5 reconstruction,\nand the lower for PPM. The respective minimum and maximum densities, (\u03c1min , \u03c1max ), are (1.0, 1.0 \u00d7 102 ), (0.55, 1.1 \u00d7 102 ),\n(0.82, 1.1 \u00d7 102 ), and (6.8 \u00d7 10\u22122 , 1.1 \u00d7 102 ).\n\n2.\n\nBoosted NS\n\nAs an additional test of our evolution algorithm, we\nconsidered a single TOV star with a boost of v = 0.5,\nwith astrophysically relevant EOS (the HB EOS of [14])\nand mass (1.35 M\u2299 ). We performed a convergence study\nat three resolutions, the lowest of which has approximately 50 points covering the diameter of the star. The\nmedium (high) resolution has two (three) times the number of points in each dimension, respectively. The AMR\nhierarchy is identical in all cases, with 7 levels of 2:1\nrefinement, and was determined using truncation error\nestimates from the low resolution run. Figure 12 shows\nthat the constraint violations show the expected secondorder convergence to zero. We also compared the performance of different reconstruction methods (though using\nthe HLL flux method throughout). In Fig. 13, we show\nthe maximum density of the NS as a function of time\n\nfor various reconstruction methods. Though the drifts\nand oscillations in density converge away for all methods, we find that WENO5 gives the least density drift\ncompared to MC and PPM at a given resolution. The\ndrift in maximum density with PPM has to do with the\nway this particular implementation enforces monotonicity at extrema, which results in a loss of accuracy (see for\nexample [102]). Modifying the way the algorithm handles\nsmooth extrema can reduce this effect. We implemented\none such modification (Eqs. 20-23 from [102]), the results\nof which are labeled 'PPM alt.' in Fig. 13.\n\n3.\n\nBoosted NS flux correction test\n\nAs a demonstration of the flux correction algorithm\n(outlined in Sec. II D) to enforce conservation across\nAMR boundaries, we perform an additional boosted NS\n\n\f15\n\nFIG. 10. Density contours (30 equally spaced in the logarithm) for the 2D Riemann problem with, from left to right, top\nto bottom: HLL and MC, HLL and WENO5, Marquina and MC, and HLL and MC with mesh refinement. The respective\nminimum and maximum densities, (\u03c1min , \u03c1max ), are (1.1 \u00d7 10\u22122 , 7.0), (8.2 \u00d7 10\u22123 , 8.1), (9.1 \u00d7 10\u22123 , 7.1), and (7.6 \u00d7 10\u22123 , 7.0).\nFor the first three simulations a resolution of 400 \u00d7 400 was used. For the final simulation, a refinement region (red box) was\nplaced in the middle with equivalent resolution, while the remaining grid has half the resolution (i.e. this simulation has lower\nresolution overall). A CFL factor of 0.5 was used throughout.\n\n\f16\n\u22123\n\nx 10\n\nexact\n\n2\n\n||D\u2212D\n\n||/||D\n\n3\n\nexact\n\n||\n\n4\n\nMC Low res.\n2\nMC Med. res. \u00d7 (2)\n\n1\n\nMC High res. \u00d7 (4)\n\n2\n\nWENO High res. \u00d7 (4)2\n0\n0\n\n20\n\n40\n60\ntime (M)\n\n80\n\n100\n\nFIG. 11. The L2 norm of the difference between the numerical and exact value of the fluid quantity D (divided by the\nnorm of the exact solution) for Bondi accretion with MC and\nWENO5. The low resolution was run with a grid spacing of\nh = 0.078MBH while the medium and high has twice and 4\ntimes the resolution respectively. The results are scaled for\nsecond-order convergence.\n\ntest. We use the same conditions as the low resolution\nsimulation outlined above in Sec. III C 2 but with a different AMR hierarchy. In particular, we keep the hierarchy\nfixed so that the boosted NS will move to areas of successively lower refinement. In Fig. 14, one sees that without\nflux corrections there is a \u2248 0.1% loss in fluid rest-mass\nas the NS moves off the highest refinement level, and\na \u2248 0.8% loss as the NS moves off the next to highest\nrefinement level. This change in the conserved fluid restmass comes from the fact that there is a slight mismatch\nin fluxes at the mesh refinement boundaries due to truncation error. With the flux correction routine activated,\nthis error is eliminated, and the only change in the total\nrest-mass is due to the density floor criterion (i.e., the\nnumerical atmosphere). As an indication of how the use\nof flux corrections affects energy and momentum we can\nalso compare the integrated matter energy and momentum as seen by a set of Eulerian observers. The matter\nenergy density is given by T ab na nb and the momentum\ndensity is given by pi = \u2212Tiana where na is the timelike\nunit normal to the constant t slices. These quantities involve combinations of the conserved fluid variables and\nthe metric and are subject to truncation error, especially\nsince in this simulation the NS is allowed to move to\nlower resolution. In addition, these quantities can vary\nwith time due to gauge effects (though in this case, the\nvariation due to gauge effects is subdominant to the variation mentioned below), so we use them as an indication\nof the effect of flux corrections by comparing them for the\nsimulations with and without flux corrections to a simi-\n\nlar simulation where the AMR tracks the NS and there is\ntherefore essentially no flux across AMR boundaries. At\nthe end of the simulation the run without flux corrections\nhas 0.91% less energy compared to a similar simulation\nwhere the AMR tracks the NS, while the run with flux\ncorrections has only 0.13% less energy. The run without\nflux corrections has 4.0% less momentum (in the boost direction) while with flux corrections the comparative loss\nis 2.5%.\nThis test is somewhat artificial since we have deliberately prevented the AMR algorithm from tracking the\nNS. As long as the AMR algorithm can keep the boundaries away from areas of non-negligible flux (as it does\nwhen following the boosted NS in the test described in\nSec. III C 2) the effect of the flux correction algorithm is\nsmall, at the level of the numerical atmosphere that gets\npulled along with the star. However, in astrophysical applications, situations may generically arise in which fluid\ncrosses AMR boundaries. For example, the tidal tails\nformed by the disruption of a NS by a BH will cross\nrefinement boundaries, and likewise for the subsequent\naccretion disk that forms, since it would be much too\ncostly to keep these entire structures on the finest mesh.\nOf course, the hydrodynamic solution is still subject to\ntruncation error, which could in principle affect aspects\nof the dynamics at the same order of magnitude as putative nonconservative effects. Though for certain problems, such as calculating the amount of unbound material following a BH-NS merger, or studying the late time\naccretion, it could be quite advantageous to ensure conservation within the hydrodynamic sector. It would be\nan interesting computational science problem to systematically study the efficacy of AMR boundary flux conservation in such scenarios.\nFinally, we note that additional convergence test results from this code were presented in [69] for the particular BH-NS merger simulations discussed there.\n\nIV.\n\nCONCLUSIONS\n\nNumerous scenarios that fall within the purview\nof general relativistic hydrodynamics are still mostly\nunexplored-especially CO mergers involving neutron\nstars. There is a rich parameter space, of which large\nareas remain uncharted due to uncertainty or potential\nvariability in BH and NS masses, BH spin and alignment, the NS EOS, and other aspects. Beyond the pure\nhydrodynamics problem, the roles of magnetic fields and\nneutrino physics are just beginning to be explored by\nvarious groups, and we expect to add support for such\nphysics to our code in the future. The potential applications of robust and flexible numerical algorithms for\nevolving hydrodynamics together with the Einstein field\nequations are manifold. With this in mind, we have implemented methods for conservatively evolving arbitrary\nEOSs, in particular for converting from conserved to\nprimitive variables without knowledge of derivatives; and\n\n\f17\n\u22124\n\n\u22125\n\n1.4\n\nx 10\n\n1.2\n\n5\n\nLow res.\nMed. res. \u00d7 (2)2\nHigh res. \u00d7 (3)2\n(t=0)\u22121\n\n1\n\n0.4\n\n0\n\n\u22125\n\nmax\n\n0.6\n\n/\u03c1\n\nmax\n\n0.8\n\n\u03c1\n\n||Ca||M0\n\nx 10\n\nWENO\u22125 Low res.\nWENO\u22125 Med. res.\nMC Low res.\nPPM Low res.\nPPM alt. Low res.\n\n\u221210\n\n0.2\n0\n0\n\n10\n\n20\n\n30\n40\ntime (M0)\n\n50\n\n\u221215\n0\n\n60\n\nFIG. 12. The L2 -norm of the constraint violation (Ca :=\nHa \u2212 \u0003xa ) in the equatorial plane for a boosted NS simulation with v = 0.5 (using HLL flux calculation and WENO5\nlimiter). The three resolutions shown are scaled assuming\nsecond-order convergence. Time is shown in units of M0 , the\nADM mass of the NS in its rest frame, and the norm of the\nconstraints is multiplied by M0 so as to make it dimensionless.\n\n1\n\n2\ntime (M )\n\n3\n\n4\n\n0\n\nFIG. 13.\nThe relative variation of the maximum central\ndensity from its initial value (\u03c1max /\u03c1max (t = 0) \u2212 1) during\na boosted NS simulation with v = 0.5 for various reconstruction methods and for two different resolutions in the case of\nWENO5.\n\n\u22123\n\nACKNOWLEDGMENTS\n\nWe thank Adam Burrows, Matt Choptuik, Luis\nLehner, Scott Noble, Inaki Olabarietta, and Jim Stone\nfor useful conversations. This research was supported by\n\nx 10\n2\nM\u0304 / M\u0304 (t = 0) \u20131\n\nwe have implemented numerous reconstruction and flux\ncalculation methods that can be used interchangeably to\nmeet problem specific requirements. Though accurate\ntreatment of shocks may not be crucial for BH-NS mergers (where shocks are not expected to be dynamically\nimportant), the same is not true of NS-NS binaries, especially eccentric ones where the stars may come into contact during nonmerger close encounters [103]. We have\nalso taken care to implement a flux correction algorithm\nthat preserves the conservative nature of hydrodynamical\nadvection across AMR boundaries. Though strict conservation is not, strictly speaking, essential (since any nonconservation would be at the level of truncation error), it\nis an especially appealing property when studying, for example, CO mergers as potential SGRB progenitors. After merger, material that did not fall into the black hole\n- typically on the order of a few percent of the original\nNS mass - will fill a large volume making up an accretion disk and potentially unbound material. Though\naccurately tracking this material is not important for the\ngravitational dynamics, it is critical for characterizing potential EM counterparts to the merger.\n\n0\n\u22122\n\u22124\n\u22126\n\u22128\n0\n\nNo flux correc.\nFlux correc.\n20\n\n40\ntime (M )\n\n60\n\n0\n\nFIG. 14.\nThe relative variation of the fluid rest-mass\n(M\u0304 /M\u0304 (t = 0) \u2212 1) for a boosted NS test with (dotted, red\nline) and without (solid black line) flux corrections at mesh\nrefinement boundaries. For this test, the mesh hierarchy is\nfixed so that at t \u2248 20 M0 the NS has moved from being\ncontained entirely on the finest resolution to being contained\nentirely on the second finest resolution. At t \u2248 60 M0 the NS\nhas moved from the second to the third finest resolution.\n\n\f18\nthe NSF through TeraGrid resources provided by NICS\nunder Grant No. TG-PHY100053, the Bradley Program (BCS), the NSF Graduate Research Program under\nGrant No. DGE-0646086 (WE), NSF Grants No. PHY0745779 (FP) and No. PHY-1001515 (BCS), and the\nAlfred P. Sloan Foundation (FP). Simulations were also\nrun on the Woodhen cluster at Princeton University.\n\nAppendix A: Spectral decomposition of the flux\nJacobian\n\nOur conservative formulation of the hydrodynamical\nequations (3,4) can be written in vector notation as \u2202t q+\n\u2202i (Fi ) = S where q is a five dimensional vector of the\nconserved (in the absence of sources S) fluid variables\nT\nq\nthe flux Fi = (Dv i , (St \u2212\n\u221a = (D,iSt , Sxi , Sy , iS\u221az ) and\nT\n\u2212gP )v , Sj v + \u03b4j \u2212gP ) , where the index j in the\nflux is shorthand for the 3 components (x, y, z). Some\nflux calculation methods such as the Roe solver [77] and\nthe Marquina flux [78] require the spectral decomposition\ni\nof the Jacobian \u2202F\n\u2202q which we give here. (See [104] for\n\nthe spectral decomposition for a similar formulation with\nslightly different conserved variables.) The eigenvalues\nare\n\u03bb\u00b1 = \u03b1q(a \u00b1 b) \u2212 \u03b2 i\n\n(A1)\n\n\u03bb3 = \u03b1U i \u2212 \u03b2 i\n\n(A2)\n\nand\n\n2\ni\n(with\n, b =\np multiplicity 3), where a = (1 \u2212 cs )U\n2\n2\ncs (1 \u2212 U 2 )[\u03b3 ii (1 \u2212 U 2 c2s ) \u2212 aU i ], q = (1 \u2212 U cs )\u22121 , cs\nis the sound speed, and \u03b1, \u03b2 i , \u03b3 ij are metric components\nas in (10). Here and throughout we use i \u2208 {x, y, z} to\nrefer to the direction of the\nflux in the Jacobian with\ni\nwhich we are concerned, \u2202F\n.\nIn the following equations\n\u2202q\nwe use the index j as a shorthand for the three spatial\ncomponents of the eigenvectors (that is, the components\nassociated with Sx , Sy , and Sz ). The indices l and m\nare fixed by i and the indices n and p are fixed by j as\nindicated below. The index k is the only index that is\nsummed over. A set of linearly independent right eigenvectors is given by\n\n\u0010\n\u0011T\nr\u00b1 = 1, hW [U k \u03b2k \u2212 {\u03b1(\u03b3 ii \u2212 U i U i ) + A\u03b2 i }/B], hW (Uj \u2212 \u03b4ji A/B) ,\n\nwhere A = [U i c2s (1 \u2212 U 2 ) \u2213 b]q and B = \u03b3 ii \u2212 U i (a \u00b1 b)q,\n\nwhere \u03ba =\n\n\u2202P\n\u2202\u01eb\n\n(A3)\n\n, and,\n\n\u0010\n\u0011T\nr4 = W Ul , 2hW 2 (Uk \u03b2 k \u2212\u03b1)Ul +h\u03b2l , h(\u03b3jl +2W 2 Uj Ul )\n\n\u0011T\n\u0010\nr3 = \u03ba/(HW (\u03ba/\u03c1 \u2212 c2s )), Uk \u03b2 k \u2212 \u03b1, Uj ,\n\n(A4)\n\n(A5)\nwhere for r4 , l = y, z, x for i = x, y, z respectively. The\nexpression for r5 can be obtained simply by replacing l\nwith m, where m = z, x, y for i = x, y, z respectively,\nin the above expression for r4 . H and W are as defined\nfollowing (12).\nWe also give the corresponding left eigenvectors.\nj\nD t\nComponent-wise, for l\u00b1 = (l\u00b1\n, l\u00b1 , l\u00b1\n),\n\nD\nl\u00b1\n= \u2213f hW V\u2213 \u03be\nh\ni\nt\nl\u00b1\n= \u2213f (K \u2212 1){\u2212\u03b3U i + V\u2213 (W 2 \u03be \u2212 \u0393lm )} + KW 2 V\u2213 \u03be /\u03b1\ni\nh\nj\nt\nl\u00b1\n= \u2213f (\u03b3ln \u03b3mp \u2212 \u03b3lp \u03b3mn ){1 \u2212 KAi \u2212 (2K \u2212 1)V\u2213 U i } + (2K \u2212 1)V\u2213 \u03beW 2 U j \u2212 \u03b2 j l\u00b1\n\nwhere l = y, z, x and m = z, x, y for i = x, y, z respectively, and n = y, z, x and p = z, x, y for j = x, y, z respectively and \u0393lm = \u03b3ll \u03b3mm \u2212 \u03b3lm \u03b3lm , \u03be = \u0393lm \u2212 \u03b3U i U i ,\nK = (1\u2212c2s \u03c1/\u03ba)\u22121 , \u039b\u00b1 = (a\u00b1b)q, V\u00b1 = (U i \u2212\u039b\u00b1 )/(\u03b3 ii \u2212\nU i \u039b\u00b1 ), Ai = (\u03b3 ii \u2212 U i U i )/(\u03b3 ii \u2212 U i \u039b\u2213 ), and\nf\n\n\u22121\n\nii\n\ni\n\ni\n\n= 2hW bq\u03be(K \u2212 1)(\u03b3 \u2212 U U ) \u00d7\n\n(A6)\n\n[(\u03b3 ii \u2212 U i \u039b+ )(\u03b3 ii \u2212 U i \u039b\u2212 )]\u22121 .\nFurthermore,\nl3 =\n\n\u0010\n\u0011\nW\n2\nj\nj\n(\u03ba\n\u2212\nc\n\u03c1)\nh,\nW/\u03b1,\nW\n(U\n\u2212\n\u03b2\n/\u03b1)\n,\ns\nc2s \u03c1\n\n(A7)\n\n\f19\nand the components of l4 and l5 are\nl4D = 0\nl4t = Glm (\u03b1h\u03be)\u22121\nh\nl4j = \u03b4ij U i Glm + \u03b4lj {\u03b3mm (1 \u2212 Ui U i ) + \u03b3im Um U i }\ni\nj\n\u2212\u03b4m\n{\u03b3lm (1 \u2212 Ui U i ) + \u03b3im Ul U i } (h\u03be)\u22121\n\n[1] A. Abramovici et al. Ligo: The laser interferometer\ngravitational wave observatory. Science, 256:325, 1992.\n[2] H. L\u00fcck et al. The geo-600 project. Class. and Quant.\nGrav., 15:1471, 1997.\n[3] M. Ando et al. Stable operation of a 300-m laser interferometer with sufficient sensitivity to detect gravitationalwave events within our galaxy. Phys. Rev. Lett., 86:3950,\n2001. astro-ph/0105473.\n[4] B. Caron et al. The virgo interferometer. Class. and\nQuant. Grav., 14:1461, 1997.\n[5] Ramesh Narayan, Bohdan Paczynski, and Tsvi Piran.\nGamma-ray bursts as the death throes of massive binary\nstars. Astrophys. J., 395:L83, 1992. astro-ph/9204001.\n[6] N. Gehrels et al. A short \u03b3-ray burst apparently associated with an elliptical galaxy at redshift z = 0.225.\nNature (London), 437:851\u2013854, October 2005.\n[7] W. H. Lee, E. Ramirez-Ruiz, and J. Granot. A Compact\nBinary Merger Model for the Short, Hard GRB 050509b.\nAstrophys. J. Lett., 630:L165\u2013L168, September 2005.\n[8] B. D. Metzger and E. Berger. What is the Most Promising Electromagnetic Counterpart of a Neutron Star Binary Merger? ArXiv e-prints, August 2011.\n[9] M. Branchesi, on behalf of the LIGO Scientific Collaboration, the Virgo Collaboration, A. Klotz, and M. LaasBourez. Searching for electromagnetic counterparts of\ngravitational wave transients. ArXiv e-prints, October\n2011.\n[10] The LIGO Scientific Collaboration, Virgo Collaboration: J. Abadie, B. P. Abbott, R. Abbott, T. D. Abbott,\nM. Abernathy, T. Accadia, F. Acernese, C. Adams,\nR. Adhikari, and et al. Implementation and testing\nof the first prompt search for electromagnetic counterparts to gravitational wave transients. ArXiv e-prints,\nSeptember 2011.\n[11] N.K. Glendenning. Compact Stars: : Nuclear Physics,\nParticle Physics, and General Relativity. Springer,\nBerlin, Germany, 2000.\n[12] Y. Sekiguchi, K. Kiuchi, K. Kyutoku, and M. Shibata.\nEffects of hyperons in binary neutron star mergers.\nArXiv e-prints, October 2011.\n[13] F. Pannarale, L. Rezzolla, F. Ohme, and J. S. Read.\nWill black hole-neutron star binary inspirals tell us\nabout the neutron star equation of state? ArXiv eprints, March 2011.\n[14] J. S. Read, C. Markakis, M. Shibata, K. Ury\u016b, J. D. E.\nCreighton, and J. L. Friedman. Measuring the neutron\nstar equation of state with gravitational wave observations. Phys. Rev. D, 79(12):124033, 2009.\n[15] R. Oechslin and H.-T. Janka. Gravitational Waves from\nRelativistic Neutron-Star Mergers with Microphysical\nEquations of State. Phys. Rev. Lett., 99(12):121102,\n\n\u2212\u03b2 j l4t\n\n(A8)\n\nwhere Glm = (\u03b3mm Ul \u2212\u03b3lm Um ) and for l4 , l = y, z, x and\nm = z, x, y for i = x, y, z respectively. The expression for\nl5 can be obtained from the above expression for l4 simply\nby interchanging l and m.\n\n2007.\n[16] L. K. Tsui, P. T. Leung, and J. Wu. Determination\nof the internal structure of neutron stars from gravitational wave spectra. Phys. Rev. D, 74(12):124025, 2006.\n[17] K. D. Kokkotas and N. Stergioulas. Gravitational Waves\nfrom Compact Sources. In A. M. Mour\u00e3o, M. Pimenta,\nR. Potting, & P. M. S\u00e1 , editor, New Worlds in Astroparticle Physics: Proceedings of the Fifth International Workshop, page 25, 2006.\n[18] M. Shibata. Constraining Nuclear Equations of State\nUsing Gravitational Waves from Hypermassive Neutron\nStars. Phys. Rev. Lett., 94(20):201101, 2005.\n[19] M. Shibata, K. Taniguchi, and K. Ury\u016b. Merger of binary neutron stars with realistic equations of state in full\ngeneral relativity. Phys. Rev. D, 71(8):084021, 2005.\n[20] J. Faber, P. Grandcl\u00e9ment, and F. Rasio. Relativistic\ncalculations of coalescing binary neutron stars. Pramana, 63:837, 2004.\n[21] M. Bejger, D. Gondek-Rosi\u0144ska, E. Gourgoulhon,\nP. Haensel, K. Taniguchi, and J. L. Zdunik. Impact\nof the nuclear equation of state on the last orbits of binary neutron stars. Astron. and Astrophys., 431:297,\n2005.\n[22] D. Lai and A. G. Wiseman. Innermost stable circular\norbit of inspiraling neutron-star binaries: Tidal effects,\npost-Newtonian effects, and the neutron-star equation\nof state. Phys. Rev. D, 54:3958, 1996.\n[23] X. Zhuge, J. M. Centrella, and S. L. W. McMillan. Gravitational radiation from coalescing binary neutron stars.\nPhys. Rev. D, 50:6247, 1994.\n[24] P. J. Montero, O. Zanotti, J. A. Font, and L. Rezzolla. Dynamics of magnetized relativistic tori oscillating around black holes. Mon. Not. Roy. Astron. Soc.,\n378:1101\u20131110, July 2007.\n[25] O. Korobkin, E. B. Abdikamalov, E. Schnetter, N. Stergioulas, and B. Zink. Stability of general-relativistic\naccretion disks. Phys. Rev. D, 83(4):043007, February\n2011.\n[26] B. D. Farris, Y. T. Liu, and S. L. Shapiro. Binary black\nhole mergers in gaseous disks: Simulations in general\nrelativity. Phys. Rev. D, 84(2):024024, July 2011.\n[27] T. Bode, T. Bogdanovi\u0107, R. Haas, J. Healy, P. Laguna,\nand D. Shoemaker. Mergers of Supermassive Black\nHoles in Astrophysical Environments. Astrophys. J.,\n744:45, January 2012.\n[28] V. Paschalidis, Y. T. Liu, Z. Etienne, and S. L.\nShapiro. Merger of binary white dwarf\u2013neutron stars:\nSimulations in full general relativity. Phys. Rev. D,\n84(10):104032, November 2011.\n[29] Jos A. Font. Numerical hydrodynamics and magnetohydrodynamics in general relativity. Living Reviews in\n\n\f20\nRelativity, 11(7), 2008.\n[30] B. Zink, E. Schnetter, and M. Tiglio. Multipatch\nmethods in general relativistic astrophysics: Hydrodynamical flows on fixed backgrounds. Phys. Rev. D,\n77(10):103015, May 2008.\n[31] B. Zink. HORIZON: Accelerated General Relativistic Magnetohydrodynamics. ArXiv e-prints, February\n2011.\n[32] M. D. Duez, Y. T. Liu, S. L. Shapiro, and B. C.\nStephens. Relativistic magnetohydrodynamics in dynamical spacetimes: Numerical methods and tests.\nPhys. Rev. D, 72(2):024028, 2005.\n[33] Tetsuro Yamamoto, Masaru Shibata, and Keisuke\nTaniguchi. Simulating coalescing compact binaries by\na new code (sacra). Phys. Rev. D, 78:064054, Sep 2008.\n[34] B. Giacomazzo and L. Rezzolla. WhiskyMHD: a new\nnumerical code for general relativistic magnetohydrodynamics. Class. and Quant. Grav., 24:235, 2007.\n[35] M. Thierfelder, S. Bernuzzi, and B. Br\u00fcgmann. Numerical relativity simulations of binary neutron stars. Phys.\nRev. D, 84(4):044012, August 2011.\n[36] Tanja Bode, Roland Haas, Tamara Bogdanovic, Pablo\nLaguna, and Deirdre Shoemaker. Relativistic Mergers\nof Supermassive Black Holes and their Electromagnetic\nSignatures. Astrophys.J., 715:1117\u20131131, 2010.\n[37] M. Shibata and T. Nakamura. Evolution of threedimensional gravitational waves: Harmonic slicing case.\nPhys. Rev. D, 52:5428, 1995.\n[38] T. W. Baumgarte and S. L. Shapiro. Numerical integration of Einstein's field equations. Phys. Rev. D,\n59(2):024007, 1999.\n[39] M. D. Duez, F. Foucart, L. E. Kidder, H. P. Pfeiffer,\nM. A. Scheel, and S. A. Teukolsky. Evolving black holeneutron star binaries in general relativity using pseudospectral and finite difference methods. Phys. Rev. D,\n78(10):104015, 2008.\n[40] M. Anderson, E. W. Hirschmann, S. L. Liebling, and\nD. Neilsen. Relativistic MHD with adaptive mesh refinement. Class. and Quant. Grav., 23:6503, 2006.\n[41] D. Garfinkle. Harmonic coordinate method for simulating generic singularities. Phys. Rev. D, 65(4):044029,\n2002.\n[42] F. Pretorius. Numerical relativity using a generalized\nharmonic decomposition. Class. and Quant. Grav.,\n22:425, 2005.\n[43] L. Lindblom, M. A. Scheel, L. E. Kidder, R. Owen, and\nO. Rinne. A new generalized harmonic evolution system. Class. and Quant. Grav., 23:447, 2006.\n[44] S. Chawla, M. Anderson, M. Besselman, L. Lehner,\nS. L. Liebling, P. M. Motl, and D. Neilsen. Mergers of\nMagnetized Neutron Stars with Spinning Black Holes:\nDisruption, Accretion, and Fallback. Phys. Rev. Lett.,\n105(11):111101\u2013+, September 2010.\n[45] Z. B. Etienne, Y. T. Liu, and S. L. Shapiro. Relativistic magnetohydrodynamics in dynamical spacetimes: A\nnew adaptive mesh refinement implementation. Phys.\nRev. D, 82(8):084031, October 2010.\n[46] Z. B. Etienne, V. Paschalidis, Y. T. Liu, and S. L.\nShapiro. Relativistic MHD in dynamical spacetimes:\nImproved EM gauge condition for AMR grids. ArXiv\ne-prints, October 2011.\n[47] Luis Lehner, Carlos Palenzuela, Steven L. Liebling,\nChristopher Thompson, and Chad Hanna. Intense Electromagnetic Outbursts from Collapsing Hypermassive\n\nNeutron Stars. 2011.\n[48] M. D. Duez, F. Foucart, L. E. Kidder, C. D. Ott, and\nS. A. Teukolsky. Equation of state effects in black holeneutron star mergers. Classical and Quantum Gravity,\n27(11):114106\u2013+, June 2010.\n[49] K. Kiuchi, Y. Sekiguchi, M. Shibata, and K. Taniguchi.\nExploring Binary-Neutron-Star-Merger Scenario of\nShort-Gamma-Ray Bursts by Gravitational-Wave Observation. Phys. Rev. Lett., 104(14):141101, April 2010.\n[50] K. Kyutoku, H. Okawa, M. Shibata, and K. Taniguchi.\nGravitational waves from spinning black hole-neutron\nstar binaries: dependence on black hole spins and\non neutron star equations of state. Phys. Rev. D,\n84(6):064018, September 2011.\n[51] V. Paschalidis, Z. Etienne, Y. T. Liu, and S. L. Shapiro.\nHead-on collisions of binary white dwarf-neutron stars:\nSimulations in full general relativity. Phys. Rev. D,\n83(6):064002, March 2011.\n[52] Y. Sekiguchi, K. Kiuchi, K. Kyutoku, and M. Shibata.\nGravitational Waves and Neutrino Emission from the\nMerger of Binary Neutron Stars. Phys. Rev. Lett.,\n107(5):051102, July 2011.\n[53] M. Shibata, K. Kiuchi, Y. Sekiguchi, and Y. Suwa.\nTruncated Moment Formalism for Radiation Hydrodynamics in Numerical Relativity. Prog. Theor. Phys.,\n125:1255\u20131287, June 2011.\n[54] B. M\u00fcller, H.-T. Janka, and H. Dimmelmeier. A New\nMulti-dimensional General Relativistic Neutrino Hydrodynamic Code for Core-collapse Supernovae. I. Method\nand Code Tests in Spherical Symmetry. Astrophys. J.\nSupp., 189:104\u2013133, July 2010.\n[55] P. Cerd\u00e1-Dur\u00e1n, J. A. Font, L. Ant\u00f3n, and E. M\u00fcller.\nA new general relativistic magnetohydrodynamics code\nfor dynamical spacetimes. Astron. and Astrophys.,\n492:937\u2013953, December 2008.\n[56] W. H. Lee and W. Klu\u017aniak. Newtonian Hydrodynamics\nof the Coalescence of Black Holes with Neutron Stars. I.\nTidally Locked Binaries with a Stiff Equation of State.\nAstrophys. J., 526:178\u2013199, November 1999.\n[57] S. Rosswog and D. Price.\nMAGMA: a threedimensional, Lagrangian magnetohydrodynamics code\nfor merger applications. Mon. Not. Roy. Astron. Soc.,\n379:915\u2013931, August 2007.\n[58] J. A. Faber, P. Grandcl\u00e9ment, and F. A. Rasio. Mergers\nof irrotational neutron star binaries in conformally flat\ngravity. Phys. Rev. D, 69(12):124036, June 2004.\n[59] R. Oechslin, H.-T. Janka, and A. Marek. Relativistic\nneutron star merger simulations with non-zero temperature equations of state. I. Variation of binary parameters and equation of state. Astron. and Astrophys.,\n467:395\u2013409, May 2007.\n[60] P. Laguna, W. A. Miller, and W. H. Zurek. Smoothed\nparticle hydrodynamics near a black hole. Astrophys.\nJ., 404:678\u2013685, February 1993.\n[61] S. Rosswog. Conservative, special-relativistic smoothed\nparticle hydrodynamics. Journal of Computational\nPhysics, 229:8591\u20138612, November 2010.\n[62] M.J. Berger and P. Colella. Local adaptive mesh refinement for shock hydrodynamics. Journal of Computational Physics, 82(1):64, 1989.\n[63] J. M. Stone, T. A. Gardiner, P. Teuben, J. F. Hawley,\nand J. B. Simon. Athena: A New Code for Astrophysical\nMHD. Astrophys. J. Supp., 178:137, 2008.\n\n\f21\n[64] A. S. Almgren, V. E. Beckner, J. B. Bell, M. S. Day,\nL. H. Howell, C. C. Joggerst, M. J. Lijewski, A. Nonaka,\nM. Singer, and M. Zingale. CASTRO: A New Compressible Astrophysical Solver. I. Hydrodynamics and\nSelf-gravity. Astrophys. J., 715:1221\u20131238, June 2010.\n[65] D. C. Collins, H. Xu, M. L. Norman, H. Li, and S. Li.\nCosmological Adaptive Mesh Refinement Magnetohydrodynamics with Enzo. Astrophys. J. Supp., 186:308\u2013\n333, February 2010.\n[66] B. Fryxell, K. Olson, P. Ricker, F. X. Timmes, M. Zingale, D. Q. Lamb, P. MacNeice, R. Rosner, J. W. Truran, and H. Tufo. FLASH: An Adaptive Mesh Hydrodynamics Code for Modeling Astrophysical Thermonuclear Flashes. Astrophys. J. Supp., 131:273\u2013334, November 2000.\n[67] K. Beckwith and J. M. Stone. A Second-order Godunov\nMethod for Multi-dimensional Relativistic Magnetohydrodynamics. Astrophys. J. Supp., 193:6, March 2011.\n[68] Branson C. Stephens, William E. East, and Frans Pretorius. Eccentric Black Hole-Neutron Star Mergers. Astrophys. J. Lett., 737(1):L5, 2011.\n[69] W. E. East, F. Pretorius, and B. C. Stephens. Eccentric\nblack hole-neutron star mergers: effects of black hole\nspin and equation of state. ArXiv e-prints, November\n2011.\n[70] Helmut Friedrich.\nOn the hyperbolicity of einstein's and other gauge field equations. Communications in Mathematical Physics, 100:525\u2013543, 1985.\n10.1007/BF01217728.\n[71] Carsten Gundlach, Jose M. Martin-Garcia, Gioel Calabrese, and Ian Hinder. Constraint damping in the Z4\nformulation and harmonic gauge. Class. Quant. Grav.,\n22:3767\u20133774, 2005.\n[72] F. Pretorius. Evolution of Binary Black-Hole Spacetimes. Phys. Rev. Lett., 95(12):121101, 2005.\n[73] Jos\u00e9 A. Font, Mark Miller, Wai-Mo Suen, and Malcolm\nTobias. Three-dimensional numerical general relativistic\nhydrodynamics: Formulations, methods, and code tests.\nPhys. Rev. D, 61:044011, Jan 2000.\n[74] C. F. Gammie, J. C. McKinney, and G. T\u00f3th. HARM:\nA Numerical Scheme for General Relativistic Magnetohydrodynamics. Astrophys. J., 589:444\u2013457, May 2003.\n[75] Miguel Alcubierre, Steven Brandt, Bernd Bruegmann,\nDaniel Holz, Edward Seidel, et al. Symmetry without\nsymmetry: Numerical simulation of axisymmetric systems using Cartesian grids. Int.J.Mod.Phys., D10:273\u2013\n290, 2001.\n[76] A. Harten, P.D. Lax, and B.J. van Leer. SIAM Rev.,\n25:35, 1983.\n[77] F. Eulderink and G. Mellema. General relativistic hydrodynamics with a ROE solver. Astron. and Astrophys.\nSupp., 110:587, 1995.\n[78] R. Donat and A. Marquina. Capturing shock reflections:\nAn improved flux formula. J. Comput. Phys., 125:42\u2013\n58, 1996.\n[79] Chi-Wang Shu and Stanley Osher. Efficient implementation of essentially non-oscillatory shock-capturing\nschemes, ii. Journal of Computational Physics, 83(1):32\n\u2013 78, 1989.\n[80] E.F. Toro. Riemann Solvers and Numerical Methods for\nFluid Dynamics. Springer, Berlin, Germany, 1997.\n[81] P. Colella and P. R. Woodward.\nThe Piecewise\nParabolic Method (PPM) for Gas-Dynamical Simulations. Journal of Computational Physics, 54:174, 1984.\n\n[82] Jos\u00e9 Ma Mart\u0131\u0301 and Ewald M\u00fcller. Extension of the\npiecewise parabolic method to one-dimensional relativistic hydrodynamics. Journal of Computational\nPhysics, 123(1):1 \u2013 14, 1996.\n[83] Guang-Shan Jiang and Chi-Wang Shu. Efficient implementation of weighted eno schemes. Journal of Computational Physics, 126(1):202 \u2013 228, 1996.\n[84] A. Tchekhovskoy, J. C. McKinney, and R. Narayan.\nWHAM: a WENO-based general relativistic numerical\nscheme - I. Hydrodynamics. Mon. Not. Roy. Astron.\nSoc., 379:469, 2007.\n[85] Scott C. Noble and Matthew W. Choptuik. Type ii\ncritical phenomena of neutron star collapse. Phys. Rev.\nD, 78:064059, Sep 2008.\n[86] H. Shen, H. Toki, K. Oyamatsu, and K. Sumiyoshi.\nRelativistic equation of state of nuclear matter for supernova and neutron star. Nuclear Physics A, 637:435,\n1998.\n[87] H. Shen, H. Toki, K. Oyamatsu, and K. Sumiyoshi.\nRelativistic Equation of State of Nuclear Matter for\nSupernova Explosion. Progress of Theoretical Physics,\n100:1013, 1998.\n[88] R.P. Brent. Algorithms for minimization without derivatives. Prentice-Hall, Englewood Cliffs, N.J., 1972.\n[89] Marsha J Berger and Joseph Oliger. Adaptive mesh\nrefinement for hyperbolic partial differential equations.\nJournal of Computational Physics, 53(3):484, 1984.\n[90] F. Pretorius and M. W. Choptuik. Adaptive mesh refinement for coupled elliptic-hyperbolic systems. Journal of Computational Physics, 218:246\u2013274, October\n2006.\n[91] Frans Pretorius.\nSimulation of binary black\nhole spacetimes with a harmonic evolution scheme.\nClass.Quant.Grav., 23:S529\u2013S552, 2006.\n[92] Dieter R. Brill. On the positive definite mass of\nthe bondi-weber-wheeler time-symmetric gravitational\nwaves. Annals of Physics, 7(4):466 \u2013 483, 1959.\n[93] Evgeny Sorkin. On critical collapse of gravitational\nwaves. Classical and Quantum Gravity, 28(2):025011,\n2011.\n[94] Gregory B. Cook and Mark A. Scheel. Well-behaved\nharmonic time slices of a charged, rotating, boosted\nblack hole. Phys. Rev. D, 56:4775\u20134781, Oct 1997.\n[95] W. Zhang and A. I. MacFadyen. RAM: A Relativistic\nAdaptive Mesh Refinement Hydrodynamics Code. Astrophys. J. Supp., 164:255, 2006.\n[96] B. Giacomazzo and L. Rezzolla. The exact solution\nof the Riemann problem in relativistic magnetohydrodynamics. Journal of Fluid Mechanics, 562:223\u2013259,\nSeptember 2006.\n[97] B. Giacomazzo, L. Rezzolla, and L. Baiotti. Can magnetic fields be detected during the inspiral of binary\nneutron stars? Mon. Not. Roy. Astron. Soc., 399:L164,\n2009.\n[98] Luciano Rezzolla and Olindo Zanotti. New relativistic effects in the dynamics of nonlinear hydrodynamical\nwaves. Phys. Rev. Lett., 89:114501, Aug 2002.\n[99] Ashley F. Emery. An evaluation of several differencing\nmethods for inviscid fluid flow problems. Journal of\nComputational Physics, 2(3):306 \u2013 331, 1968.\n[100] Arturo Lucas-Serrano, Jose A. Font, Jose M. Ibanez,\nand Jose M. Marti. Assessment of a high-resolution\ncentral scheme for the solution of the relativistic hydrodynamics equations. Astron. Astrophys., 428:703\u2013715,\n\n\f22\n2004.\n[101] Stuart L. Shapiro and Saul A. Teukolsky. Black holes,\nwhite dwarfs, and neutron stars : the physics of compact\nobjects. Wiley, New York, 1983.\n[102] Phillip Colella and Michael D. Sekora. A limiter for ppm\nthat preserves accuracy at smooth extrema. Journal of\nComputational Physics, 227(15):7069 \u2013 7076, 2008.\n[103] R. Gold, S. Bernuzzi, M. Thierfelder, B. Bruegmann,\nand F. Pretorius. Eccentric binary neutron star mergers.\n\nArXiv e-prints, September 2011.\n[104] J. M. Ibanez, M. A. Aloy, J. A. Font, J. M. Marti, J. A.\nMiralles, and J. A. Pons. Riemann Solvers in General Relativistic Hydrodynamics. ArXiv Astrophysics\ne-prints, November 1999.\n\n\f"}