{"id": "http://arxiv.org/abs/0710.4224v1", "guidislink": true, "updated": "2007-10-23T09:57:10Z", "updated_parsed": [2007, 10, 23, 9, 57, 10, 1, 296, 0], "published": "2007-10-23T09:57:10Z", "published_parsed": [2007, 10, 23, 9, 57, 10, 1, 296, 0], "title": "Hecke operators on Hilbert-Siegel modular forms", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0710.4224%2C0710.3851%2C0710.5279%2C0710.4206%2C0710.1198%2C0710.4375%2C0710.0373%2C0710.2152%2C0710.4345%2C0710.0216%2C0710.5628%2C0710.1539%2C0710.3668%2C0710.4248%2C0710.5195%2C0710.2395%2C0710.3397%2C0710.1417%2C0710.3852%2C0710.5140%2C0710.3599%2C0710.2779%2C0710.2752%2C0710.5815%2C0710.1671%2C0710.4033%2C0710.4314%2C0710.0327%2C0710.3349%2C0710.5518%2C0710.0130%2C0710.4690%2C0710.1873%2C0710.0111%2C0710.1122%2C0710.2173%2C0710.3409%2C0710.0454%2C0710.3626%2C0710.4031%2C0710.3150%2C0710.1578%2C0710.4152%2C0710.2806%2C0710.4669%2C0710.5778%2C0710.4952%2C0710.2226%2C0710.0227%2C0710.5544%2C0710.4294%2C0710.0680%2C0710.1453%2C0710.1358%2C0710.2298%2C0710.0165%2C0710.3039%2C0710.2624%2C0710.2799%2C0710.0632%2C0710.3728%2C0710.1982%2C0710.3200%2C0710.0806%2C0710.2382%2C0710.4578%2C0710.0455%2C0710.0002%2C0710.1532%2C0710.0250%2C0710.4297%2C0710.4924%2C0710.2862%2C0710.4397%2C0710.0406%2C0710.4685%2C0710.3657%2C0710.3242%2C0710.3976%2C0710.0175%2C0710.5359%2C0710.5385%2C0710.2796%2C0710.1652%2C0710.2389%2C0710.2566%2C0710.1163%2C0710.3435%2C0710.3821%2C0710.3906%2C0710.0188%2C0710.5311%2C0710.2971%2C0710.5943%2C0710.2204%2C0710.4407%2C0710.5504%2C0710.5256%2C0710.0517%2C0710.1120%2C0710.5464&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Hecke operators on Hilbert-Siegel modular forms"}, "summary": "We define Hilbert-Siegel modular forms and Hecke \"operators\" acting on them.\nAs with Hilbert modular forms, these linear transformations are not linear\noperators until we consider a direct product of spaces of modular forms (with\nvarying groups), modulo natural identifications we can make between certain\nspaces. With Hilbert-Siegel forms we identify several families of natural\nidentifications between certain spaces of modular forms. We associate the\nFourier coefficients of a form in our product space to even integral lattices,\nindependent of a basis and choice of coefficient rings. We then determine the\naction of the Hecke operators on these Fourier coefficients, paralleling the\nresult of Hafner and Walling for Siegel modular forms (where the number field\nis the field of rationals).", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0710.4224%2C0710.3851%2C0710.5279%2C0710.4206%2C0710.1198%2C0710.4375%2C0710.0373%2C0710.2152%2C0710.4345%2C0710.0216%2C0710.5628%2C0710.1539%2C0710.3668%2C0710.4248%2C0710.5195%2C0710.2395%2C0710.3397%2C0710.1417%2C0710.3852%2C0710.5140%2C0710.3599%2C0710.2779%2C0710.2752%2C0710.5815%2C0710.1671%2C0710.4033%2C0710.4314%2C0710.0327%2C0710.3349%2C0710.5518%2C0710.0130%2C0710.4690%2C0710.1873%2C0710.0111%2C0710.1122%2C0710.2173%2C0710.3409%2C0710.0454%2C0710.3626%2C0710.4031%2C0710.3150%2C0710.1578%2C0710.4152%2C0710.2806%2C0710.4669%2C0710.5778%2C0710.4952%2C0710.2226%2C0710.0227%2C0710.5544%2C0710.4294%2C0710.0680%2C0710.1453%2C0710.1358%2C0710.2298%2C0710.0165%2C0710.3039%2C0710.2624%2C0710.2799%2C0710.0632%2C0710.3728%2C0710.1982%2C0710.3200%2C0710.0806%2C0710.2382%2C0710.4578%2C0710.0455%2C0710.0002%2C0710.1532%2C0710.0250%2C0710.4297%2C0710.4924%2C0710.2862%2C0710.4397%2C0710.0406%2C0710.4685%2C0710.3657%2C0710.3242%2C0710.3976%2C0710.0175%2C0710.5359%2C0710.5385%2C0710.2796%2C0710.1652%2C0710.2389%2C0710.2566%2C0710.1163%2C0710.3435%2C0710.3821%2C0710.3906%2C0710.0188%2C0710.5311%2C0710.2971%2C0710.5943%2C0710.2204%2C0710.4407%2C0710.5504%2C0710.5256%2C0710.0517%2C0710.1120%2C0710.5464&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We define Hilbert-Siegel modular forms and Hecke \"operators\" acting on them.\nAs with Hilbert modular forms, these linear transformations are not linear\noperators until we consider a direct product of spaces of modular forms (with\nvarying groups), modulo natural identifications we can make between certain\nspaces. With Hilbert-Siegel forms we identify several families of natural\nidentifications between certain spaces of modular forms. We associate the\nFourier coefficients of a form in our product space to even integral lattices,\nindependent of a basis and choice of coefficient rings. We then determine the\naction of the Hecke operators on these Fourier coefficients, paralleling the\nresult of Hafner and Walling for Siegel modular forms (where the number field\nis the field of rationals)."}, "authors": ["Suzanne Caulk", "Lynne H. Walling"], "author_detail": {"name": "Lynne H. Walling"}, "author": "Lynne H. Walling", "links": [{"href": "http://arxiv.org/abs/0710.4224v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0710.4224v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11F41", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0710.4224v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0710.4224v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0710.4224v1 [math.NT] 23 Oct 2007\n\nHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\nSuzanne Caulk and Lynne H. Walling\nAbstract. We define Hilbert-Siegel modular forms and Hecke \"operators\" acting\non them. As with Hilbert modular forms (i.e. with Siegel degree 1), these linear\ntransformations are not linear operators until we consider a direct product of spaces\nof modular forms (with varying groups), modulo natural identifications we can make\nbetween certain spaces. With Hilbert-Siegel forms (i.e. with arbitrary Siegel degree)\nwe identify several families of natural identifications between certain spaces of modular forms. We associate the Fourier coefficients of a form in our product space to\neven integral lattices, independent of basis and choice of coefficient rings. We then\ndetermine the action of the Hecke operators on these Fourier coefficients, paralleling\nthe result of Hafner and Walling for Siegel modular forms (where the number field is\nthe field of rationals).\n\n1. Introduction.\nA Siegel modular form F of degree n over the rationals has a Fourier series\nsupported on even integral symmetric n \u00d7 n matrices. An even integral symmetric\nmatrix can be interpreted as the matrix for a quadratic form on an even integral\nlattice, relative to some Z-basis for that lattice. Given the transformation property\nof F under the symplectic group, the coefficient of F attached to a matrix T is\nequal to that attached to the conjugate t GT G where G is any integral change of\nbasis matrix (with determinant 1 when k, the weight of the modular form, is odd).\nConsequently we can rewrite F as a \"Fourier series\" supported on even integral\nlattices, without specifying a basis for each lattice. For each prime p there are\nn + 1 Hecke operators, T (p) and Tj (p2 ) (1 \u2264 j \u2264 n) associated to p, n of which are\nalgebraically independent. In [5] we determined the action of these operators on\nthe Fourier coefficients of F . In this paper we extend this result to Hilbert-Siegel\nmodular forms.\nWith K a totally real number field and P a prime ideal, we mimic the construction of the classical Hecke operators and construct a linear transformation T (P)\nacting on Hilbert modular forms. When P is not principally generated, T (P) maps\n1991 Mathematics Subject Classification. 11F41.\nKey words and phrases. Siegel modular forms, Hilbert modular forms, Hecke operators.\nTypeset by AMS-TEX\n\n1\n\n\f2\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nmodular forms attached to \u0393 = SL2 (O) (O the ring of integers of K), to forms\nattached to the \"psuedo-conjugate\"\n\u0012\n\nP\n0\n\n0\n1\n\n\u0013 \u0012 \u22121\nP\n\u0393\n0\n\n0\n1\n\n\u0013\n\n=\n\n\u001a\u0012\n\na b\nc d\n\n\u0013\n\n: a, d \u2208 O, b \u2208 P, c \u2208 P\n\n\u22121\n\n, ad \u2212 bc = 1\n\n\u001b\n\n.\n\nSo for T (P) to be a linear operator (meaning its domain and codomain are equal), it\nis necessary to consider a (finite) direct product of spaces of modular forms attached\nto psuedo-conjuagates of SL2 (O). In [7], Shimura defined \"Fourier coefficients\"\nattached to integral ideals of a form in this direct product, and he determined the\naction of T (P) on these Fourier coefficients.\nIn the case of Hilbert-Siegel modular forms, we need to consider a (finite) direct\nproduct of spaces of forms attached to psuedo-conjugates of Spn (O) for the maps\nT (P) and Tj (P 2 ) to be linear operators. For a form in this direct product, we define\n\"Fourier coefficients\" attached to even integral lattices, independent of basis and\nchoices of coefficient rings (note that an O-lattice is not necessarily free, and there\nare numerous ways to write it as A1 x1 \u2295 * * * \u2295 An xn with the Ai fractional ideals).\nThen we determine the action of the Hecke operators on these Fourier coefficients.\nWhen k is odd, we need to impose an orientation on \u039b. Thus\nF (\u03c4 ) =\n\nX\n\nc(\u039b)e\u2217 {\u039b\u03c4 }\n\ncls\u039b\n\nwhere cls\u039b runs over isometry classes of lattices \u039b, and e\u2217 {\u039b\u03c4\n\u0001 } =\nP\nt\nG exp (\u03c0iT r( GT G\u03c4 )); here \u039b = A1 x1 \u2295 * * * \u2295 An xn , T = B(xi , xj ) where\nB is the symmetric bilinear form associated to the quadratic form Q on \u039b so\nthat Q(x) = B(x, x), and G varies over O(\u039b)\\GLn (Z) when k is even, and over\nO + (\u039b)\\SLn (Z) when k is odd. (Two lattices \u039b, \u03a9 are in the same isometry class if\nthere is an isomorphism from one onto the other that preserves the quadratic form.\nAlso, O(\u039b) is the orthogonal group of \u039b.)\nWe begin by defining symplectic groups \u0393(I1 , . . . , In ; J ) for fractional ideals\nIi , J . We show that the spaces of modular forms associated to \u0393(I1 , . . . , In ; J ) and\n\u0393(I1\u2032 , . . . , In\u2032 ; J \u2032 ) are naturally isomorphic whenever cls(I1 * * * In ) = cls(I1\u2032 * * * In\u2032 )\nand clx+ J = clx+ J \u2032 . (Here clsI denotes the wide ideal class of I, and clx+ J\ndenotes the strict ideal complex of J . Thus clsI = clsI \u2032 if I = \u03b1I \u2032 for some \u03b1 \u2208 K,\nand clx+QJ = clx+ J \u2032 if J = \u03b1I 2 J \u2032 for some fractional ideal I and \u03b1 \u226b 0.) We set\nMk = Ii ,J Mk (\u0393(I1 , . . . , In ; J ))/ \u223c (so we identify spaces that are naturally\nisomorphic). Next we attach the Fourier coefficients of (the components of) F\nto even integral lattices, independent of the basis and the coefficient rings used\nto realize each lattice. (For a full discussion of this, see the discussion preceeding\nProposition 2.2.) In \u00a73 we introduce operators S(Q) attached to fractional ideals Q,\nand we decompose Mk as \u2295\u03c7 Mk (\u03c7) where \u03c7 varies over ideal class characters, and\nF |S(Q) = \u03c7(Q)F for F \u2208 Mk (\u03c7). Then in \u00a74 we introduce the Hecke operators\nT (P) and Tj (P 2 ), 0 \u2264 j \u2264 n, and we find coset representatives giving the action of\nthe operators. When then analyzing the action of the Hecke operators Tj (P 2 ) in\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n3\n\n\u00a75 we encounter incomplete character sums; we complete these by replacing Tj (P 2 )\nwith Tej (P 2 ), a combination of Tl (P 2 ), 0 \u2264 l \u2264 j. Finally, we show that for \u039bJ an\neven integral lattice and F \u2208 Mk (\u03c7), the \u039bJ th coefficient of F |Tej (P 2 ) is\nX\n\nN (P)Ej (\u03a9,\u039b) \u03c7(P)ej (\u03a9,\u039b) \u03b1j (\u03a9, \u039b)cF (\u03a9J )\n\nP\u039b\u2286\u03a9\u2286P \u22121 \u039b\n\nwhere Ej (\u03a9, \u039b) and ej (\u03a9, \u039b) are given by formulas in terms of the invariant factors\n{\u03a9 : \u039b}, and \u03b1j (\u03a9, \u039b) reflects some geometry of (\u03a9 \u2229 \u039b)/P(\u03a9 + \u039b). (A formula for\n\u03b1j (\u03a9, \u039b) is given at the end of \u00a75.) A similar but much simpler argument shows\nthat the \u039bJ th coefficient of F |T (P) is\nX\n\nN (P)E(\u03a9,\u039b) cF (\u03a9J P\n\n\u22121\n\n)\n\nP\u039b\u2286\u03a9\u2286\u039b\n\n(see Theorem 5.2).\nIn \u00a76 we present a lemma on completing a symmetric coprime pair to a symplectic\nmatrix. The reader is referred to [6] for basic results on lattices and quadratic forms.\nThe authors are thankful for the referee's careful reading.\n2. Definitions, isomorphisms, and Fourier\ncoefficients attached to even integral lattices.\nLet K be a totally real number field of degree d over Q, and let \u2202 denote the\ndifferent of K. Let H(n) denote degree n Siegel upper half-space; so\nH(n) = {\u03c4 = X + iY : X, Y \u2208 Rn,n are symmetric, Y > 0 } .\nFor fractional ideals I1 , . . . , In , J , let\n\u0013\nn\u0012\nA B\n\u0393(I1 , . . . , In ; J ) =\n\u2208 G2n (K) : A t B, C t D symmetric,\nC D\nA t D \u2212 B t C = uI, u \u2208 O+ , aij \u2208 Ii Ij\u22121 ,\n\nbij \u2208 Ii Ij J \u2202 \u22121 , cij \u2208 (Ii Ij J )\u22121 \u2202, dij \u2208 Ii\u22121 Ij\n\no\n\n.\n\n(Here A = ( aij ), etc.) So with \u0393 = \u0393(O, . . . , O; O), \u0393(I1 , . . . , In ; J ) corresponds\nto the formal conjugate \u03b4\u0393\u03b4 \u22121 where\n\uf8eb\n\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ec\n\u03b4=\uf8ec\n\uf8ec\n\uf8ec\n\uf8ed\n\nJ I1\n\n..\n\n\uf8f6\n\n.\nJ In\n\nI1\u22121\n\n..\n\n.\nIn\u22121\n\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7.\n\uf8f7\n\uf8f7\n\uf8f8\n\n\f4\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nAlso notice that \u0393(I1 , . . . , In ; J I 2 ) = \u0393(I1 I, . . . , In I; J ).\nDefinition. A degree n (n > 1), weight k Hilbert-Siegel modular form for\nd\n\u0393(I1 , . . . , In ; J ) is a function f : H(n)\n\u2192 C so that the following two conditions\nhold.\nd\nd\n(1) f is \"analytic on H(n)\nand at infinity,\" meaning that for \u03c4 \u2208 H(n)\n,\nf (\u03c4 ) =\n\nX\n\nc(T )e{T \u03c4 }\n\nT\n\nwhere T runs over symmetric, positive semi-definite n \u00d7 n matrices. Also,\n\u03c3(M ) denotes the trace of a matrix M , Tr denotes the trace from K to Q,\nand\ne{T \u03c4 } = exp(\u03c0i\u03c3(Tr(T \u03c4 ))).\nPd\nHere Tr(T \u03c4 ) = i=1 T (i) \u03c4i , where T (i) is the image of T under the ith embedding of K into R.\n\u0012\n\u0013\nA B\n(2) For all M \u2208 \u0393(I1 , . . . , In ; J ), f |M = f where, for any matrix\nC D\n(written in n \u00d7 n blocks), we define\nf|\n\n\u0012\n\nA\nC\n\nB\nD\n\n\u0013\n\n(\u03c4 )\n\n= det(N (A t D \u2212 B t C))k/2 det(N (C\u03c4 + D))\u2212k\nf ((A\u03c4 + B)(C\u03c4 + D)\u22121 ).\nHere N denotes the norm from K to Q, extended so that\nN (C\u03c4 + D) =\n\nd\nY\n\nC (i) \u03c4i + D(i) .\n\ni=1\n\nLet Mk (\u0393(I1 , . . . , In ; J )) denote the space of Hilbert-Siegel modular forms for\n\u0393(I1 , . . . , In ; J ), and let f be a modular form in this space. Since f (\u03c4 + B) = f (\u03c4 )\nfor all symmetric B \u2208 (Ii Ij J \u2202 \u22121 ), \u2202 the different of K, we must have e{T B} = 1\nfor all T \u2208 suppf . Note that for T = (tij ), B = (bij ) symmetric matrices,\n\u03c3(T B) =\n\nn\nX\ni=1\n\ntii bii +\n\nX\n\n2tij bij .\n\n1\u2264i<j\u2264n\n\n\u0001\nThus for T \u2208 suppf , we must have T \u2208 (Ii Ij J )\u22121 with T even, meaning tii \u2208\n2Ii\u22122 J \u22121 .\n\nDefinitions. We define families of isomorphisms between spaces of modular forms\nas follows: Fix f \u2208 Mk (\u0393(I1 , . . . , In ; J )).\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n5\n\nFirst, for \u03b1 \u2208 K\u00d7 and 1 \u2264 l \u2264 n, let\n\uf8eb\n\nIl\u22121\n\nM =\uf8ed\n\nIn\u2212l\n\nand define\nf |Ul (\u03b1) = f |\nSince\n\n\u0012\n\nM\nt\n\nM \u22121\n\n\u0013\n\n\u0393(I1\u2032 , . . .\n\n, In\u2032 ; J )\nIi\u2032\n\n\u03b1\u22121\n\n=\n\n\u001a\n\n\u0012\n\n\u0012\n\n\uf8f6\n\n\uf8f8,\n\u0013\n\nM\nt\n\nM \u22121\n\nM \u22121\n\u0013\n\nt\n\nIi\n\u03b1Il\n\n.\n\n= \u0393(I1 , . . . , In ; J ) where\n\nM\n\nif l 6= i\nif l = i,\n\nUl (\u03b1)\ndefines\nan\nisomorphism\nfrom\nMk (\u0393(I1 , . . . , In ; J ))\nonto\nMk (\u0393(I1\u2032 , . . . , In\u2032 ; J )).\nFor \u03b1 \u226b 0, define W (\u03b1) : Mk (\u0393(I1 , . . . , In ; J )) \u2192 Mk (\u0393(I1 , . . . , In ; \u03b1J )) by\nf |W (\u03b1) = f |\n\n\u0012\n\n\u03b1\u22121 In\nIn\n\n\u0013\n\n.\n\nOne easily checks (as we did above for Ul (\u03b1)) that W (\u03b1) is an isomorphism.\nFor Q a fractional ideal, 1 \u2264 l < n, choose\nA\u2208\n\n\u0012\n\nQ\u22121\nQ\u22121 Il\u22121 Il+1\n\n\u0013\n\n\u22121\nQIl Il+1\nQ\n\nso that det A = 1 (possible by Strong Approximation; see p. 42 [6]). Let\n\uf8eb\n\nM =\uf8ed\n\nIl\u22121\nA\nIn\u2212l\u22121\n\nand define\nf |Vl (Q) = f |\nSince\n\n\u0012\n\nM\nt\n\nM\n\n\u22121\n\n\u0013\n\n\u0393(I1\u2032 , . . .\n\n, In\u2032 ; J )\n\n\u0012\n\n\u0012\n\nM\nt\n\nM \u22121\n\n\uf8f1\n\uf8f4\n\uf8f2 Ii\n\u2032\nIi =\nQIl\n\uf8f4\n\uf8f3 \u22121\nQ Il+1\n\nM \u22121\n\u0013\n\nt\n\nM\n\n\uf8f6\n\n\uf8f8,\n\u0013\n\n.\n\n= \u0393(I1 , . . . , In ; J ) where\n\nif i 6= l, l + 1\nif i = l\nif i = l + 1,\n\n\f6\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nthe map Vl (\u03b1) defines an isomorphism from Mk (\u0393(I1 , . . . , In ; J )) onto\nMk (\u0393(I1\u2032 , . . . , In\u2032 ; J )).\nFor Q a fractional ideal and 1 \u2264 l < j \u2264 n, set\nVlj (Q) = Vl (Q)Vl+1 (Q) * * * Vj\u22121 (Q).\nThen Vlj (Q) defines an\nMk (\u0393(I1\u2032 , . . . , In\u2032 ; J )), where\n\nisomorphism\n\n\uf8f1\n\uf8f4\n\uf8f2 Ii\n\u2032\nIi =\nQIl\n\uf8f4\n\uf8f3 \u22121\nQ Ij+1\n\nfrom\n\nMk (I1 , . . . , In ; J ))\n\nonto\n\nif i 6= l, j\nif i = l .\nif i = j,\n\nProposition 2.1. The maps Ul (\u03b1), W (\u03b1), Vlj (Q) commute and for fixed l, j,\nthese operators are multiplicative (as functions on fractional ideals).\nProof. The tedious aspect of proving such relations among our isomorphisms is that,\nfor any of the above listed maps, the domain and codomain differ. Keeping track\nof appropriate domains and codomains, and using the matrices we used to define\nthe actions of these operators, it is then straightforward to verify the operators\ncommute, remembering that if M N \u22121 \u2208 \u0393 for any group \u0393 = \u0393(I1 , . . . , In ; J ),\nthen f |M = f |N for f \u2208 Mk (\u0393). \u0003\nDefinition. For f \u2208 Mk (\u0393(I1 , . . . , In ; J )), g \u2208 Mk (I1\u2032 , . . . , In\u2032 ; J \u2032 )), define the\nequivalence relation \u223c by f \u223c g if some composition of the maps Ui , W, Vij takes f\nto g. We define\nY\nMk =\nMk (\u0393(I1 , . . . , In ; J ))/ \u223c\nIi ,J\n\nwhere I1 , . . . , In , J vary over all fractional ideals. Note that \u223c partitions the\nspaces\nMk (\u0393(I1 , . . . , In ; J )) according to cls(I1 * * * In ), clx+ J . Thus Mk \u2248\nQ\n+\nclsI,clx+ J Mk (\u0393(O, . . . , O, I; J )), clsI runs over all ideal classes and cls J runs\nover all strict ideal class complexes. (J , J \u2032 are in the same strict ideal class complex\nif J \u2032 = \u03b1I 2 J for some fractional ideal I and \u03b1 \u226b 0.)\nGiven an element F \u2208 Mk , we can associate the Fourier coefficients of F with\nlattices equipped with positive semi-definite, even integral quadratic forms as described below.\nFirst note the following. Say f \u2208 Mk (\u0393(I1 , . . . , In ; J )) is a component\nof a\n\u0001\nchosen representative for F . So the support of f lies in (Ii Ij J )\u22121 . For T \u2208\nsuppf , consider T as defining a quadratic form Q on Ox1 \u2295 * * * \u2295 Oxn (recall that\nT is symmetric and even, meaning the ith diagonal entry of T lies in 2Ii\u22122 J \u22121 ).\nThus with \u039b = I1 x1 \u2295 * * * \u2295 In xn , Q(\u039b) \u2286 2J \u22121 . If \u03b1O = J then the scaled lattice\n\u039b\u03b1 is even integral, meaning \u03b1Q(\u039b) \u2286 2O. When J is not principal, we abuse\nnotation and language and refer to \u039bJ as an even integral lattice. We agree to\n2\nidentify \u039bI with I\u039b since locally everywhere these are identified (paralleling the\nfact that \u0393(I1 , . . . , In ; I 2 J ) = \u0393(II1 , . . . , IIn ; J )).\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n7\n\nNot every lattice is a free O-module, and given a lattice \u039b, there are many ways\nto choose fractional ideals Ij and vectors xj so that \u039b = I1 x1 \u2295 * * * \u2295 In xn . Say we\nhave\n\u039b = I1 x1 \u2295 * * * \u2295 In xn = I1\u2032 y1 \u2295 * * * \u2295 In\u2032 yn ,\nP\nyj = i aij xi . Then by 81:8 [6], I1 * * * In = I1\u2032 * * * In\u2032 * det(aij ).\nThe Invariant Factor Theorem (81:11 [6]) says that given lattices \u039b, \u03a9 on\na (non-zero) space V , there are vectors x1 , . . . , xn \u2208 V and fractional ideals\nI1 , . . . , In , A1 , . . . , An so that\n\u039b = I1 x1 \u2295 * * * \u2295 In xn ,\n\u03a9 = I1 A1 x1 \u2295 * * * \u2295 In An xn ,\nand Ai |Ai+1 (1 \u2264 i < n); the Ai are unique and called the invariant factors of \u03a9\nin \u039b. We use {\u039b : \u03a9} to refer to these invariant factors, and we write {\u039b : \u03a9} =\n(A1 , . . . , An ).\nWhen analyzing the action of Hecke operators on Fourier coefficients, we sum\nover lattices \u039b where P\u039b \u2286 \u03a9 \u2286 P \u22121 \u039b, P a prime ideal and \u039b a fixed reference\nlattice of rank n. By the Invariant Factor Theorem, we have sublattices \u039bi so that\n\u039b = \u039b0 \u2295 \u039b1 \u2295 \u039b2 ,\n\u03a9 = P\u039b0 \u2295 \u039b1 \u2295 P \u22121 \u039b2 .\nSo for instance, r0 = rank\u039b0 is the multiplicity of P among the invariant factors\n{\u039b : \u03a9}, denoted r0 = mult{\u039b:\u03a9} (P).\nJ\nWe will also need to consider (\u039bJ \u2229 \u03a9J )/P(\u039bJ + \u03a9J ) \u2248 \u039bJ\n1 /P\u039b1 . We will\nonly be considering even integral \u039bJ . Thus Q induces a quadratic form 21 \u03b1Q on\nJ\n\u039bJ\n1 /P\u039b1 defined by\n1\n1\n\u03b1Q(x + P\u039b1 ) = \u03b1Q(x) + P \u2208 O/P\n2\n2\nwhere \u03b1 \u2208 K has been fixed so that \u03b1OP = J OP . Since Q(\u039b1 ) \u2286 2J \u22121 , this gives\nJ\nus a quadratic form on the O/P-space \u039bJ\n1 /P\u039b1 . Note that the structure of the\nJ\nJ\nquadratic space \u039b1 /P\u039b1 is independent of the choice of \u03b1.\nDefinition. Let f \u2208 Mk . Given any even integral positive semi-definite lattice\n\u039bJ with \u039b = I1 x1 \u2295 * * * \u2295 In xn , we set\nc(\u039bJ ) = cF (\u039bJ ) = cf (T ) * N (I1 * * * In )k N (J )nk/2\nwhere f \u2208 Mk (\u0393(I1 , . . . , In ; J )) is a representative of the component of F corresponding to cls(I1 * * * In ), clx+ J , and T = ( B(xi , xj ) ) . If k is odd, we assume \u039b\nis also equipped with an orientation.\n\n\f8\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nProposition 2.2. The \"Fourier coefficient\" c(\u039bJ ) is well-defined.\nProof. First, suppose we also have \u039b\u2032 = I1 y1 \u2295 * * * \u2295 In yn , and \u039b = \u039b\u2032 . Take\nM = (\u03b1ij ) so that\n(y1 . . . yn ) = (x1 . . . xn )M.\nHence (B(yi , yj )) = t M T M (recall T = (B(xi , xj ))). Note that\nIj yj =\n\nX\n\n\u03b1ij Ij xi \u2286 \u039b,\n\ni\n\nso \u03b1ij \u2208 Ii Ij\u22121 . Also, since vol\u039b = vol\u039b\u2032 , it follows that det M \u2208 O\u00d7 . (Recall that\nif k is\u0012odd then \u039b\u0013has an orientation, and det M must also be totally positive.)\nM\n\u2208 \u0393(I1 , . . . , In ; J ), and so\nThus\nt\nM \u22121\nf = f|\n\n\u0012\n\nM\nt\n\nM \u22121\n\n\u0013\n\n.\n\nHence\nf (\u03c4 ) =\n\nX\n\ncf (T )e{T \u03c4 }\n\nT\n\n= N (det M )k\n=\n\nX\n\nX\n\ncf (T )e{T M \u03c4 t M }\n\nT\n\ncf (T )e{ t M T M \u03c4 }\n\nT\n\n(recall that det M is a unit, and that if k is odd, a totally positive unit). Thus\ncf ( t M T M ) = N (det M )k cf (T ) = cf (T ), and so\nc(\u039bJ ) = cf (T )N (I1 * * * In )k N (J )nk/2\n= cf ( t M T M )N (I1 * * * In )k N (J )nk/2 = c(\u039b\u2032J ).\nThus the definition of c(\u039bJ ) is independent of the choice of basis relative to the\ncoefficient ideals I1 , . . . , In and the scaling ideal J (so here I1 , . . . , In and J are\nfixed).\nNext, fix J and suppose \u039b = I1 x1 \u2295 * * * \u2295 In xn = I1\u2032 y1\u2032 \u2295 * * * \u2295 In\u2032 yn\u2032 . Then by\n81:8 of [6], I1\u2032 * * * In\u2032 \u2208 cls(I1 * * * In ). Thus, as we have seen, Mk (\u0393(I1 , . . . , In ; J )) \u2243\nMk (\u0393(I1\u2032 , . . . , In\u2032 ; J )) via an appropriate composition of the maps Ui , Vij ; the action\nof this composition is given by\n\u2032\n\nf 7\u2192 f = f |\n\n\u0012\n\nM\nt\n\nM \u22121\n\n\u0013\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n9\n\n\u0001\nwhere M \u2208 Ii Ij\u22121 and (det M )I1\u2032 * * * In\u2032 = I1 * * * In . Also,\nX\nf \u2032 (\u03c4 ) = N (det M )k f (M \u03c4 t M ) = N (det M )k\ncf (T )e{ t M T M \u03c4 },\nT\n\nso cf \u2032 (t M T M ) = N (det M )k cf (T ). Set (y1 . . . yn ) = (x1 . . . xn )M ; thus Oy1 \u2295 * * * \u2295\nOyn \u2243 t M T M. We claim that with \u039b\u2032 = I1\u2032 y1 \u2295 * * * \u2295 In\u2032 yn , \u039b\u2032 = \u039b. We know that\nwriting M as (\u03b1ij ),\nyj =\n\nn\nX\n\n\u03b1ij xi \u2208 (Ij\u2032 )\u22121 (I1 x1 \u2295 * * * \u2295 In xn )\n\ni=1\n\nand so \u039b\u2032 \u2286 \u039b. Since norm(\u039b) = (I1 * * * In )2 * det T = (I1\u2032 * * * In\u2032 )2 * det(t M T M ) =\nnorm(\u039b\u2032 ), we have \u039b\u2032 = \u039b. So\nc(\u039b\u2032J ) = cf \u2032 ( t M T M ) N (I1\u2032 * * * In\u2032 )k N (J )nk/2\n= cf (T ) N (det M )k N (I1\u2032 * * * In\u2032 )k N (J )nk/2\n= cf (T ) N (I1 * * * In )k N (J )nk/2\n= c(\u039bJ ).\nThus by our assumption, I1\u2032 y1 \u2295 * * * \u2295 In\u2032 yn = I1\u2032 y1\u2032 \u2295 * * * \u2295 In\u2032 yn\u2032 , which reduces\nthe problem to the preceeding case. Hence our definition of c(\u039bJ ) is independent\nof the choice of classes I1 , . . . , In so that cls(I1 * * * In ) is as prescribed (so here\ncls(I1 * * * In ), J are fixed).\nFinally, suppose J \u2032 \u2208 clx+ J . Thus J \u2032 = \u03b1I 2 J for some fractional ideal I and\n2\nsome \u03b1 \u226b 0. Say \u039b = I1 x1 \u2295 * * * \u2295 In xn . We have agreed previously to identify \u039bI\n2\nand I\u039b, so that cf (\u039b\u03b1I J ) = cf (I\u039b\u03b1J ), whether we think of f as associated to\n\u0393(I1 , . . . , In ; \u03b1I 2 J ) or to \u0393(II1 , . . . , IIn ; \u03b1J ) (remember, these are two names for\nthe same group). So suppose J \u2032 = \u03b1J , \u03b1 \u226b 0. We know Mk (\u0393(I1 , . . . , In ; J )) \u2243\nMk (\u0393(I1 , . . . , In ; \u03b1J )) via\n\u0012 \u22121\n\u0013\n\u03b1 I\n\u2032\nf 7\u2192 f = f |\n.\nI\nThus\nf \u2032 (\u03c4 ) = N (\u03b1)\u2212nk/2 f (\u03b1\u22121 \u03c4 ) = N (\u03b1)\u2212nk/2\n\nX\n\ncf (T )e{\u03b1\u22121 T \u03c4 }.\n\nT\n\nConsequently cf \u2032 (\u03b1\u22121 T ) = N (\u03b1)\u2212nk/2 cf (T ). Set \u039b\u2032 = I1 x1 \u2295 * * * \u2295 In xn equipped\nwith the quadratic form \u03b1\u22121 T (so (\u039b\u2032 )\u03b1J is an integral lattice). Then we have\nc(\u039bJ ) = cf (T ) N (I1 * * * In )k N (J )nk/2\n= cf \u2032 (\u03b1\u22121 T ) N (I1 * * * In )k N (\u03b1J )nk/2\n= c((\u039b\u2032 )\u03b1J ).\nThus the definition of c(\u039bJ ) is also independent of the choice of the representative\nfor clx+ J . \u0003\n\n\f10\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\n3. Eigenspaces.\nThe operators Vl (Q) are lifts of the Hilbert modular form operators that Eichler\ncalled V (Q\u22121 ) [3] and Shimura called S(Q) [7]. We now introduce another lift of\nthese operators, and following Shimura [7] (where n = 1), we decompose Mk into\neigenspaces for these new operators.\nDefinition. Let Q be a fractional ideal, and choose\n\u0012\n\na b\nc d\n\n\u0013\n\n\u2208\n\n\u0012\n\nQ\u22121 Il2 J \u2202 \u22121\nQ\u22121\n\nQ\n\u22122 \u22121\nQIl J \u2202\n\n\u0013\n\nwith ad \u2212 bc = 1. Set\n\uf8eb\n\nIl\u22121\n\n\uf8f6\n\n0l\u22121\na\n\n\uf8ec\n\uf8ec\n\uf8ec\nM =\uf8ec\n\uf8ec 0l\u22121\n\uf8ed\n\nb\nIn\u2212l\nIl\u22121\n\nc\n\nd\n0\n\n\uf8f7\n\uf8f7\n0 \uf8f7\n\uf8f7.\n\uf8f7\n\uf8f8\n\nIn\u2212l\n\nThen M \u0393(I1 , . . . , In ; J )M \u22121 = \u0393(I1\u2032 , . . . , In\u2032 ; J ) where\nIj\u2032\n\n=\n\n\u001a\n\nIj\n\nif j 6= l,\n\u22121\n\nQ\n\nIl\n\nif j = l.\n\nThus Sl (Q) : Mk (\u0393(I1 , . . . , In ; J )) \u2192 Mk (\u0393(I1\u2032 , . . . , In\u2032 ; J )) is an isomorphism\nwhere we define\nf |Sl (Q) = f |M.\nProposition 3.1. With Q, P fractional ideals and \u03b1 \u2208 K\u00d7 , Sl (Q) commutes with\nUi (\u03b1), W (\u03b1), and Vij (P). Further, Si (Q)Vij (Q) = Sj (Q) and Ui (\u03b1\u22121 )Si (Q) =\nSi (\u03b1Q).\nProof. Keeping in mind the various domains for different incarnations of our functions, it's easy to show Sl (Q) commutes with Ui (\u03b1), W (\u03b1).\nTo show Sl (Q), Vij (P) commute, it suffices to show Sl (Q), Vi (P) commute (recall\nhow Vij is defined). When l 6= i, i+1, it is easy to see the matrices giving the actions\nof Sl (Q), Vi (P) commute. As we explain below, we can reduce our attention to the\ncase n = 2.\nSuppose l = i or i + 1; for the sake of clarity, let us first look at the case where\ni = 1, l = 1 or 2. Then the action of each operator is given by a matrix of the form\n\uf8eb\n\uf8ec\n\uf8ed\n\nA\n\n\uf8f6\n\nB\nI\n\nC\n\nD\n0\n\n0\uf8f7\n\uf8f8\n\nI\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n11\n\nwhere A, B, C, D are 2 \u00d7 2 matrices. Since the product of such matrices (and their\ninverses)\n\u0012\n\u0013is again of this form, it suffices to restrict our attention to the submatrices\nA B\n.\nC D\nFirst consider n = 2, i = l = 1. Choose\n\u0012\n\u0013\n\u0013 \u0012\na b\nQ\nQP 2 I12 J \u2202 \u22121\n\u2208\nc d\n(QI12 J )\u22121 \u2202\nQ\u22121\nso that ad \u2212 bc = 1. Choose\nA\u2208\n\n\u0012\n\nP \u22121\nP \u22121 I1\u22121 I2\n\nPQI1 I2\u22121\nP\n\n\u0013\n\nso that det A = 1. (Note that these choices are possible, even when Q = P.) Then\n\uf8eb\n\ngives the action of both\n\n\uf8ec\nM =\uf8ed\n\na\n\n\uf8f6\n\nb\n1\n\nc\n\nd\n0\n\n0\uf8f7\n\uf8f8\n1\n\nS1 (Q) : Mk (\u0393(QI1 , I2 ; J )) \u2192 Mk (\u0393(I1 , I2 ; J ))\nand\nS1 (Q) : Mk (\u0393(PQI1 , P \u22121 I2 ; J )) \u2192 Mk (\u0393(PI1 , P \u22121 I2 ; J )).\n\u0013\n\u0012\nA\ngives the action of both\nSimilarly, N =\nt \u22121\nA\nV1 (Q) : Mk (\u0393(QI1 , I2 ; J )) \u2192 Mk (\u0393(PQI1 , P \u22121 I2 ; J ))\nand\nV1 (Q) : Mk (\u0393(I1 , I2 ; J )) \u2192 Mk (\u0393(PI1 , P \u22121 I2 ; J )).\nA simple (but tiresome) check shows M N M \u22121 N \u22121 \u2208 \u0393(QI1 , I2 ; J ), which\nimplies that S1 (Q), V1 (P) commute when n = 2. For general n, we have\nS1 (Q)V1 (P)S1 (Q\u22121 )V1 (P \u22121 ) represented by a matrix of the form\n\uf8eb\n\n\u0012\n\n\uf8ec\nM\u2032 = \uf8ed\n\nA\n\n\uf8f6\n\nB\nI\n\nC\n\nD\n0\n\n0\uf8f7\n\uf8f8\n\nI\n\n\u0013\nA B\nwhere\n\u2208 \u0393(QI1 , I2 ; J ). Thus M \u2032 \u2208 \u0393(QI1 , I2 , . . . , In ; J ), and\nC D\nS1 (Q), V1 (P) commute for general n. Similarly, S2 (Q), V1 (P) commute for n = 2,\nand thus for general n.\n\n\f12\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nFor general n, l, i with l = i or i+1, the matrices giving the action of Sl (Q), Vi (P)\nare of the form\n\uf8f6\n\uf8eb\nIi\u22121\n0i\u22121\nA\nB\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\nI\n0\n\uf8f7\n\uf8ec\n\uf8f7,\n\uf8ec\nIi\u22121\n\uf8f7\n\uf8ec 0i\u22121\n\uf8f8\n\uf8ed\nC\nD\n0\nI\nwhere A, B, C, D are 2 \u00d7 2 matrices. So again the problem reduces to showing\nSl (Q), Vi (P) (l = i or i + 1) commute when n = 2 (which we have done).\nTo see that Si (Q)Vij (Q) = Sj (Q), it again suffices to consider j = i + 1. First,\nfix a group \u0393 = \u0393(I1 , . . . , In ; J ). From our definitions, we have a product of three\nmatrices giving the action of Si (Q)Vi (Q)Si+1 (Q\u22121 ) on Mk (\u0393). One easily verifies\nthat the conditions on these matrices ensure the product for Si (Q)Vi (Q)Si+1 (Q\u22121 )\nlies in \u0393. Finally, one verifies Ui (\u03b1\u22121 )Si (Q) = Si (\u03b1Q) by matrix multiplication. \u0003\nThis shows that the Sl (Q) act on Mk , where, for F \u2208 Mk , F \u223c (. . . , fi , . . . ),\nF |Sl (Q) \u223c (. . . , fi |Sl (Q), . . . ). It also shows that Si (Q), Sj (Q) are equivalent on\nMk , and so we simply refer to this operator on Mk as S(Q). Furthermore, on Mk ,\nS(Q) = S(\u03b1Q) for all \u03b1 \u2208 K\u00d7 ; since we also know S(\u2217) is multiplicative, the map\nclsI 7\u2192 S(I) gives a group action of the ideal class group on Mk .\nProposition 3.2. Mk = \u2295\u03c7 Mk (\u03c7) where \u03c7 varies over all characters of the ideal\nclass group, and\nMk (\u03c7) = {F \u2208 Mk : F |S(Q) = \u03c7(Q)F for all Q }.\nProof. First notice that Mk (\u03c7) \u2229 Mk (\u03c8) = {0} if \u03c7 6= \u03c8. To prove this take\nF \u2208 Mk (\u03c7) \u2229 Mk (\u03c8). Then \u03c7(Q)F = F |S(Q) = \u03c8(Q)F for all Q. Since \u03c7 6= \u03c8\nthere is a Q such that \u03c7(Q) 6= \u03c8(Q). Therefore F = 0.\n1X\nFor \u03c8 an ideal class character, let G\u03c8 =\n\u03c8(I) F |S(I) where h is the class\nh\nclsI\nnumber of K. Note that\n\uf8eb\n\uf8f6\n\u001a\nX\nX\nX\nX\nh if clsI = clsO,\n1\n\uf8ed\nG\u03c8 =\n\u03c8(I)\uf8f8 F |S(I) = F since\n\u03c8(I) =\nh\n0 otherwise.\nclsI\n\u03c8\n\u03c8\n\u03c8\nP\nThus F = \u03c8 G\u03c8 .\nNext notice that\n1X\n\u03c8(I) F |S(I)|S(Q)\nG\u03c8 |S(Q) =\nh\nclsI\n1X\n=\n\u03c8(I) F |S(IQ)\nh\nclsI\nX\n1\n\u03c8(IQ) F |S(IQ)\n= \u03c8(Q)\nh\nclsI\n\n= \u03c8(Q) G\u03c8 .\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n13\n\nThus G\u03c8 \u2208 Mk (\u03c8), and hence F \u2208 \u2295\u03c7 Mk (\u03c7). \u0003\n4. Hecke operators.\nWe begin by defining the Hecke operators. Then we show that they act on each\nMk (\u03c7). After this, we describe how to find a set of coset representatives giving\nthe action of the operators. Finally, in the next section we analyze the action of\nthe operators on Fourier coefficients attached to even integral lattices, proving our\nmain theorem.\nDefinition.\nLet P a prime ideal; set \u0393 = \u0393(I1 , . . . , In ; J ) and \u0393\u2032 =\n\u0393(I1 , . . . , In ; PJ ). We define the Hecke operator T (P) : Mk (\u0393\u2032 ) \u2192 Mk (\u0393) by\nF |T (P) = N (P)n(k\u2212n\u22121)/2\n\nX\n\nF |\u03b3\n\n\u03b3\n\n\u2032\nwhere \u03b3 runs over a complete set of coset representatives\nfor (\u0393\n\u0012\n\u0013 \u2229 \u0393)\\\u0393. Note that\nPIn\n\u0393\u2032 is the formal conjugate of \u0393 by the matrix \u03b4 =\n. When K = Q, we\nIn\ndefine T (p) on Mk (\u0393) by\n\nf |T (p) = pn(k\u2212n\u22121)/2\n\nX\n\nf |\u03b4 \u22121 \u03b3\n\n\u03b3\n\n\u2032\n\u2032\n\u22121\nwhere\n\u0012 \u03b3 runs\u0013over a complete set of coset representatives for (\u0393 \u2229\u0393)\\\u0393, \u0393 = \u03b4\u0393\u03b4 ,\npI\n\u03b4=\n. (This normalization of T (p) is standard, and as with the standard\nI\nnormalization of the degree 1 Hecke operator T (p), the purpose of the normalization\nis to force the coefficient to be 1 on the \"lead\" term in the expression for the \u039bth\ncoefficient of F |T (p).)\nNow fix 1 \u2264 j \u2264 n; let \u0393\u2032j = \u0393(PI1 , . . . , PIj , Ij+1 , . . . , In ; J ). We define the\nHecke operators Tj (P 2 ) : Mk (\u0393\u2032j ) \u2192 Mk (\u0393) by\n\nF |Tj (P 2 ) =\n\nX\n\nF |\u03b3\n\n\u03b3\n\nwhere \u03b3 runs over a complete set of coset representatives for (\u0393\u2032j \u2229 \u0393)\\\u0393.\nNote that \u0393\u2032j is the formal conjugate of \u0393 by diag(PIj , In\u2212j , P \u22121 Ij , In\u2212j ). When\nK = Q, P = pZ, we define Tj (P 2 ) = Tj (p2 ) on Mk (\u0393) by\nf |Tj (P 2 ) =\n\nX\n\nf |\u03b4 \u22121 \u03b3\n\n\u03b3\n\nwhere \u03b4 = diag(pIj , In\u2212j , p1 Ij , In\u2212j ), \u0393\u2032 = \u03b4\u0393\u03b4 \u22121 , and \u03b3 runs over a complete set of\ncoset representatives for (\u0393\u2032 \u2229 \u0393)\\\u0393. (We introduce a normalization later.)\n\n\f14\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nProposition 4.1. The operators T (P), Tj (P 2 ) commute with Ui (\u03b1), W (\u03b2), Vil (Q),\nand Si (Q) where \u03b1, \u03b2 \u2208 K\u00d7 with \u03b2 \u226b 0, and Q is a fractional ideal. Thus T (P),\nTj (P 2 ) act on Mk (\u03c7) (as defined in Proposition 3.2).\nProof. To show Tj (P 2 ) commutes with the Vil (Q), it suffices to show it commutes\nwith Vi (Q). Take\n\u0012\n\u0013\nQ\u22121\nIi Ij\u22121 QP\nA\u2208\nIi\u22121 Ij Q\u22121 P\nQ\nwith det A = 1, and set\n\u001a\nPIi if i \u2264 j,\n\u2032\nIi =\nIi\notherwise.\nThen with\n\uf8f6\n\uf8eb\nIi\u22121\nA\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\nIn\u2212i\u22121\n\uf8f7\n\uf8ec\nM =\uf8ec\n\uf8f7,\nIi\u22121\n\uf8f7\n\uf8ec\n\uf8f8\n\uf8ed\nt \u22121\nA\nIn\u2212i\u22121\nM gives the action of Vi (Q) : Mk (\u0393) \u2192 Mk (M \u22121 \u0393M ) and of Vi (Q) : Mk (\u0393\u2032 ) \u2192\nMk (M \u22121 \u0393\u2032 M) (note that these are the appropriate codomains). Now let {\u03b3}\nbe a complete set of coset representatives for (\u0393\u2032 \u2229 \u0393)\\\u0393. Thus {M \u22121 \u03b3M } is a\ncomplete set of coset representatives for (M \u22121 \u0393\u2032 M \u2229 M \u22121 \u0393M )\\M \u22121 \u0393M . Hence\nfor f \u2208 Mk (\u0393\u2032 ),\nX\nf |Tj (P 2 )Vi (Q) =\nf |\u03b3|M\n\u03b3\n\n=\n\nX\n\nf |M |M \u22121 \u03b3M\n\n\u03b3\n\n= f |Vi (Q)Tj (P 2 ).\nSimilarly, to show Tj (P 2 ) commutes with Si (Q), choose\n\u0012\n\u0013 \u0012\n\u0013\nQ\nQ\u22121 Ii2 P 2 J \u2202 \u22121\na b\n\u2208\nc d\nQ\u22121\nQIi\u22122 J \u22121 \u2202\n\u0012\n\u0013\na b\nso that ad\u2212bc = 1. Then\nlifts to a matrix M so that M gives the action of\nc d\nSi (Q) : Mk (\u0393) \u2192 Mk (M \u22121 \u0393M ) and of Si (Q) : Mk (\u0393\u2032 ) \u2192 Mk (M \u22121 \u0393\u2032 M ). Thus\nX\nf |Tj (P 2 )Si (Q) =\nf |\u03b3|M\n\u03b3\n\n=\n\nX\n\nf |M \u22121 |M \u22121 \u03b3M\n\n\u03b3\n\n= f |Si (Q)Tj (P 2 ).\nSimilar but simpler arguments show that Tj (P 2 ) commutes with Ui (\u03b1), W (\u03b2), and\nthat T (P) commutes with Vi (Q), Si (Q), Ui (\u03b1), W (\u03b2). \u0003\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\nProposition 4.2. For f \u2032 \u2208 Mk (\u0393\u2032 ), we have\n\u0012\nX\nI\n\u2032\n2\n\u2032 (j)\nf |Tj (P ) =\nf |S (\u03a9)\n\nY\nI\n\n\u03a9,\u039b1 ,Y\n\n\u0013\u0012\n\nC \u22121\nt\n\nC\n\n\u0013\n\n15\n\n.\n\nHere \u03a9 varies over all lattices such that P\u039b \u2286 \u03a9 \u2286 P \u22121 \u039b, \u039b1 varies over all codimension n\u2212j subspaces of \u03a9\u2229\u039b/P(\u03a9+\u039b), C = C(\u03a9, \u039b1 ). With r0 = mult{\u039b:\u03a9} (P),\nm1 = mult{\u039b:\u03a9} (O), r1 = m1 \u2212 n + j, \u03bc \u2208 P \u22121 \u2212 \u03a9 fixed,\n!\n!\nj\nr0Y\n+r1\nY\nS (j) (\u03a9) =\nSi (P)\nSi (P 2 ) ,\ni=r0 +1\n\n\uf8eb\n\nW0\nt\n\uf8ec W\nY =\uf8ed 2\n0\nt\nW3\n\ni=r0 +r1 +1\n\nW2\n\u03bcW1\n\n0\n\nW3\n\n\uf8f6\n\uf8f7\n\uf8f8\n\nwith Y \u2208 (Ii Ij J \u2202 \u22121 ), W0 varying modulo P 2 , W1 , W2 , W3 varying modulo P with\nP not dividing det W1 . (Recall that \u2202 is the different of K.) Here W0 is r0 \u00d7 r0 and\nsymmetric, W1 is r1 \u00d7 r1 and symmetric, W2 is r0 \u00d7 r1 , W3 is r0 \u00d7 (n \u2212 j).\nProof. Let P be a prime ideal, and fix j, 1 \u2264 j \u2264 n. We essentially follow the\nalgorithm presented in [5] to find a set of coset representatives giving the action of\nTj (P 2 ) : Mk (\u0393(PI1 , . . . , PIj , Ij+1 , . . . , In ; J )) \u2192 Mk (\u0393(I1 , . . . , In ; J )).\nFor convenience, we will take Ii = O for 1 \u2264 i \u2264 j, Ii = O for j < i < n; also, we\ntake I = In and J \u2202 \u22121 to be integral ideals relatively prime to P (recall that the\nequivalence class of Mk (\u0393) is determined by clsI, cls+ J , and \u2202 is the different of K).\nNote that this allows us to choose \u03bc relatively prime to I1 * * * In J \u2202 \u22121 = IJ \u2202 \u22121 .\nChoose M \u2208 \u0393(O, . . . , O, I; J ), and let Mj = (A|B) denote the top j rows of\nM with A, B j \u00d7 n matrices. Let \u039b = OP x1 \u2295 * * * \u2295 OP xn be a reference lattice.\nStep 1. Let\n\u03a90 = ker(\u039b \u2192 \u039b(A) mod POP )\nwhere A = (a1 * * * an ) and \u039b \u2192 \u039b(A) mod POP denotes the map that takes xi to ai\n(which is a 1 \u00d7 j matrix with entries in OP /POP ). Note that the r0 = rankP \u039b(A)\nis at most j since A is a j \u00d7 n matrix.\n\u0013\n\u0012\nC\n\u2208 \u0393(O, . . . , O, I; J ) such that\nWe claim there is a matrix\nt \u22121\n\u0012\n\u0013\n\u0013\n\u0012C\nPIr0\nC\n\u03a90 = \u039bC0\n= (A\u2032 |B \u2032 ) with a\u20321 , . . . , a\u2032n \u2261\nand (A|B)\nt \u22121\nIn\u2212r0\nC\n0 (mod P).\nFirst, write A = (a1 . . . an ) and consider the rank modulo POP of (a1 . . . an ).\nLet E1 be an (n \u2212 1) \u00d7 (n \u2212 1) invertible matrix (i.e. a change of basis matrix) so\nthat\n(a1 . . . an )E1 = (a\u20321 . . . a\u2032n )\n\n\f16\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\n\u2032\n\u2032\nwith a\u20321 , . . . , a\u2032r0 linearly independent\nmodulo PO\n\uf8eb\n\uf8f6P and ar0 +1 \u2261 * * * \u2261 an\u22121 \u2261\nE1\nt \u22121\n\uf8ed\n\uf8f8 \u2208 \u0393(O, . . . , O, I; J ). If an is\n0 (mod POP ). Note that G1 =\nE1\n1\n\u0012\n\u0013\nI \u2217\n\u2032\n\u2032\nin the span modulo POP of a1 , . . . , ar0 , then there is a matrix E2 =\n1\n\u2032\n\u2032\n\u2032\n\u2032\n\u2032\nsuch that\n(a\n.\n.\n.\na\na\n)E\n=\n(a\n.\n.\n.\na\n)\nwhere\na\n\u2261\n0\n(mod\nPO\n);\nnote\nthat\n2\nP\n1\nn\u22121 n\n1\nn\nn\n\u0012\n\u0013\nE2\nG2 =\n\u2208 \u0393(O, . . . , O, I; J ) and we take C0 to be G1 G2 . If r0 = n \u2212 1\nt \u22121\nE2\nthen we are now done, regardless of whether an is in the span (modulo POP ) of\na\u20321 , . . . , a\u2032r0 .\nSo suppose r0 < n \u2212 1 (and thus a\u2032n\u22121 \u2261 0 (mod POP )) and an is not in the\nspan (modulo POP ) of a\u20321 , . . . , a\u2032r0 \u22121 .\nChoose \u03b7 \u2208 I \u22121 , \u03c1 \u2208 I such that \u03b7 \u2261 \u03c1 \u2261 1 (mod P) and choose \u03bd \u2208 P\nsuch that (\u03bd, \u03b7\u03c1) = 1. Thus!there are \u03b1, \u03b2 \u2208 O so that \u03b1\u03bd \u2212 \u03c1\u03b7\u03b2 = 1.\nI\n\u03b1 \u03b7\u03b2 , (a\u20321 . . . a\u2032n\u22121 an )E3 = (a\u20321 . . . a\u2032n\u22122 a\u2032\u2032n\u22121 a\u2032\u2032n ) with\nThen with E3 =\n\u03c1 \u03bd\n\u0012\n\u0013\nE3\n\u2032\u2032\n\u2032\u2032\n\u2208\nan\u22121 \u2261 an (mod P), an \u2261 0 (mod P). Note that G3 =\nt \u22121\nE3\n\u0393(O, . . . , O, I; J ). Let\u0012 E4 be the \u0013permutation matrix that permutes columns r0\nE4\nand n \u2212 1; then G4 =\n\u2208 \u0393(O, . . . , O, I; J ) and (a1 . . . an )G1 G3 G4 \u2261\nt \u22121\nE4\n(a\u20321 . . . a\u2032r0 \u22121 an 0 . . . 0) (mod P). Hence in this case we take C0 = \u0012\nG1 G3 G4 . \u0013\nC0\nThus there is a matrix C0 and integer r0 such that\n\u2208\nt \u22121\nC0\n\u0012\n\u0013\nPIr0\n\u0393(O, . . . , O, I; J ) and \u03a90 = \u039bC0\n. Then with renewed notaI\nn\u2212r\n0\n\u0012\n\u0013\nC0\ntion, Mj\nhas the form (a1 , . . . , an |b1 , . . . , bn ) = (A0 A1 |B), A1 \u2261\nt \u22121\nC0\n0 (mod P).\nNote that while C0 is not uniquely determined, \u03a90 is.\nStep 2. First note that Lemma 7.2 of [5] easily generalizes to number fields,\nwhere we \"permute\" bl and bn as we \"permuted\" a\u2032r0 and an in the preceeding\nparagraph. Thus with\n\u0012\n\u0013\nC0\nMj\n= (A|B) = (a1 , . . . , an |b1 , . . . , bn ),\nt \u22121\nC0\n\nwhere b1 , . . . , br0 are in the span mod POP of a1 , . . . , ar0 , and\n\u0012 the rank\n\u0013 mod\nI r0\nPOP of (a1 , . . . , ar0 , br0 +1 , . . . , bn ) is j. Thus for some C =\nwith\nE\n\u0013\n\u0013\n\u0012\n\u0012\nC\nC\n= (A\u2032 |B \u2032 ) with\n\u2208 \u0393(O, . . . , O, I; J ), we have (A|B)\nt \u22121\nt \u22121\nC\nC\na\u2032i = ai for i \u2264 r0 , and j the rank mod POP of (a1 , . . . , ar0 , b\u2032r0 +1 , . . . , b\u2032j ). We\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n17\n\nwant to accomplish the above rearrangement, as well as replacing b\u2032j+1 , . . . , b\u2032n with\nvectors in the span mod POP of a1 , . . . , ar0 ; we want to identify these modifications\nwith a uniquely determined lattice.\nFrom Step 1 we have \u039b = \u039b0 \u2295\u22061 , \u03a90 = P\u039b0 \u2295\u22061 with \u22061 uniquely determined\nmodulo P\u039b. This corresponds to a splitting \u039b# = \u039b\u20320 \u2295 \u039b\u20321 of the (formal) dual of\n\u039b, where \u039b\u20320 is orthogonal to \u22061 and \u039b\u20321 is orthogonal to \u039b0 . (So\n\u039b# = OP y1 \u2295 * * * \u2295 OP yn\nand the basis {y1 , . . . , yn } is dual to {x1 , . . . , xn }.)\nLet V be the OP /POP -space consisting of all j \u00d7 1 matrices, and let U be the\nsubspace spanned by a1 , . . . , ar0 . Let\n\u03a9\u20321 = ker(\u039b# \u2192 \u039b# (B) mod POP \u2192 V /U ),\nwhere \u039b# \u2192 \u039b# (B) corresponds to yi 7\u2192 bi , and the map into V /U is\u0012the canonical\n\u0013\nI r0\nprojection map. Thus as in Step 1, we can find a matrix C =\nso\nE\n\u0013\n\u0013\n\u0012\n\u0012\nC\nC\n= (A\u2032 |B \u2032 ) with\n\u2208 \u0393(O, . . . , O, I; J ) and (A|B)\nthat\nt \u22121\nt \u22121\nC\nC\nb\u20320 = b0 , . . . , b\u2032r0 = br0 , b\u2032j+1 , b\u2032n in the span mod POP of a0 , . . . , ar0 . Also, setting\nC1 = C0 C,\n\uf8eb\n\uf8f6\nI r0\n\uf8f8;\n\u03a9\u20321 = \u039b# t C1\u22121 \uf8ed\nPIj\u2212r0\nIn\u2212j\n\u039b# = \u039b# t C1\u22121 = \u039b\u20320 \u2295 \u039b\u20322 \u2295 \u039b\u20323 with rank\u039b\u20322 = j \u2212 r0 and \u039b\u20320 \u2295 \u039b\u20323 uniquely\ndetermined modulo P\u039b# . Correspondingly,\n\u03a90 = \u039bC1\n\n\u0012\n\nPIr0\nIn\u2212r0\n\n\u0013\n\n.\n\nNote that \u039b = \u039bC1 = \u039b0 \u2295 \u22062 \u2295 \u039b3 . Set\n\uf8eb\n\n\u03a91 = \u039bC1 \uf8ed\n\nPIr0\nIj\u2212r0\nPIn\u2212j\n\n\uf8f6\n\n\uf8f8 = P\u039b0 \u2295 \u22062 \u2295 P\u039b3 .\n\nSince \u039b\u20320 \u2295 \u039b\u20323 are uniquely determined modulo P\u039b# , \u22062 is uniquely determined\nmodulo P\u039b.\nStep 3. Write\nMj\n\n\u0012\n\nC1\n\nt\n\nC1\u22121\n\n\u0013\n\n= (a1 * * * an |b1 * * * bn ) = (A0 A1 A3 |B1 B2 B3 )\n\n\f18\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nwhere j is the rank modulo POP of (A0 , B1 ), A1 , A3 \u2261 0 (mod POP ), and B0 , B3\nare in the (column) span modulo POP of A0 . We want to modify A1 to be of the\nform (A\u20321 , A\u20322 ) where A\u20322 \u2261 0 (mod P 2 OP ). Recall that we have\n\u039b = \u039b0 \u2295 \u22062 \u2295 \u039b3 ,\n\n\u03a91 = P\u039b0 \u2295 \u22062 \u2295 P\u039b3 ,\n\nwith rank\u039b0 = r0 , rank\u22062 = j \u2212 r0 . Renewing our notation, let (x1 , . . . , xn ) be a\nbasis corresponding to this decompositon of \u039b.\nRecall we have fixed \u03bc \u2208 P \u22121 \u2212 O so that \u03bc is relatively prime to IJ \u2202 \u22121 ; set\nP\u03a92 = ker(\u03a91 \u2192 \u03a91 (\u03bcA) mod POP )\nwhere \u03a91 \u2192 \u03a91 (\u03bcA) denotes the map taking xi to \u03bcai , so \u03bc\u03a91 (A) mod POP\nis spanned by a1 , . . . , ar0 , \u03bcar0 +1 , . . . , \u03bcaj with a1 , . . . , ar0 linearly independent\nmodulo POP (recall ai \u2243 0 (mod POP ) for i > j). Thus\nP\u03a92 = P 2 \u039b0 \u2295 P\u039b1 \u2295 \u039b2 \u2295 P\u039b3\nwhere \u039b2 is uniquely\nP\u03a91 . As in the previous steps, we can\n\uf8eb determined modulo\n\uf8f6\n\u0013\n\u0012\nI r0\nC\n\uf8ed\n\uf8f8\nfind a matrix C =\nE\n\u2208 \u0393(O, . . . , O, I; J )\nsuch that\nt \u22121\nC\nIn\u2212j\nand\n\uf8f6\n\uf8eb 2\nP I r0\nPIr1\n\uf8f7\n\uf8ec\nP\u03a92 = \u039bC \uf8ed\n\uf8f8.\nI r2\nPIn\u2212j\n\u0012\n\u0013\nC\nCorrespondingly, (A|B)\n= (A0 A\u20321 A2 A3 |B0 B1\u2032 B2 B3 ) with A\u20321 \u2261\nt \u22121\nC\n0 (mod POP ), A2 \u2261 0 (mod P 2 OP ), and a1 , . . . , ar0 , \u03bca\u2032r0 +1 , . . . , \u03bca\u2032r0 +r1 linearly independent modulo POP where r1 = rank\u039b1 ( and so A\u20321 is j \u00d7 r1 ). Let\nC(\u03a9, \u039b1 ) = C0 C1 .\n\u0012\n\u0013\nC2\nStep 4. Write Mj\n= (A0 , A1 , A2 , A3 |B0 , B1 , B2 , B3 ). So A1 , A3 \u2261\nt \u22121\nC2\n0 (mod POP ), A2 \u2261 0 (mod P 2 OP ), and the columns of (A0 , \u03bcA1 ) are linearly\nindependent modulo POP . Also, B0 , B3 are in the column span modulo POP of\nA0 .\nSince B0 , B1 are in spanP A0 , we can solve\nA0 Y0\u2032 \u2261 \u2212B0 (mod POP ),\n\nA0 Y3 \u2261 \u2212B3 (mod POP ).\n\nNote that as B t A is symmetric and A1 , A2 , A3 \u2261 0 (mod POP ), B0 t A0 is symmetric modulo POP . Also, since A0 has\n\u0013rank modulo P, there\n\u0012 is\u2032 \u0013some ma\u0012 full\nB\nA\u2032\n, we see\n. Writing EB0 =\ntrix E \u2208 GLj (OP ) such that EA0 =\nB \u2032\u2032\n0\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n19\n\nB \u2032\u2032 \u2261 0 (mod POP ) since E(B0 t A0 ) t E is symmetric modulo POP . Thus Y0\u2032\nis the unique solution modulo P to A\u2032 Y0\u2032 \u2261 \u2212B \u2032 (mod POP ); since (A\u2032 )\u22121 B \u2032 is\nsymmetric modulo POP , we can choose Y0\u2032 to be symmetric.\nLet\n(A0 , A1 , A2 , A3 |B0\u2032 , B1 , B2 , B3\u2032 )\n\n\uf8eb\n\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ec\n= (A0 , A1 , A2 , A3 |B0 , B1 , B2 , B3 ) \uf8ec\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ed\n\nI\nI\nI\nI\n\nY0\n0\n0\nt\nY3\nI\n\n0\n\n0\n\nY3\n\nI\nI\nI\n\n\uf8f6\n\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7,\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f8\n\nB0\u2032 , B3\u2032 \u2261 0 (mod POP ). Then just as we argued about Y0\u2032 , there is a unique modulo\nPOP symmetric solution Y \u2032 to\n(A0 , \u03bcA1 )Y \u2032 \u2261 \u2212(\u03bc(B0\u2032 + A3 t Y3 ), B1 ) (mod POP ).\n\u0012 \u2032\u2032\n\u0013\nY0 Y2\n\u2032\nDecompose Y as t\n; choose \u03b4 \u2208 P so that \u03b4\u03bc \u2261 1 (mod P) and set\nY2 Y1\nY0 = Y0\u2032 + \u03b4Y0\u2032\u2032 .\nNote that since rankP (A0 , B1 ) = r0 + r1 , we have rankP (B1 + A0 Y0 ) =\n\u00d7\n.\nrankP B1 = r1 . Since \u2212\u03bcA1 Y1 \u2261 B1 +A0 Y2 (mod POP ), we must have det Y1 \u2208 OP\n\uf8f6\n\uf8eb\n\uf8eb\n\uf8f6\nW0\nW2 0 W3\nW 0 W3\nt\nW\n\u03bcW\n\uf8f7\n2\n1\n\uf8f8=\uf8ec\nTake Y = \uf8ed 0\nI\n\uf8f8 to be a symmetric ma\uf8ed\n0\nI\nt\nW3\nt\nW3\n\u0001\ntrix in Ii Ij J \u2202 \u22121 with W0 \u2261 Y0 (mod P 2 OP ) and Wi \u2261 Yi (mod POP ) for\ni = 1, 2, 3.\nThen\n\u0012\n\u0013\nI Y\n(A0 , A1 , A2 , A3 |B0 , B1 , B2 , B3 )\n= (A0 , A1 , A2 , A3 |B0\u2032\u2032 , B1\u2032 , B2\u2032 , B3\u2032 )\n0 I\nwith B0\u2032\u2032 \u2261 0 (mod P 2 OP ), B2\u2032 \u2261 B2 (mod P 2 OP ), B1\u2032 , B3\u2032 \u2261 0 (mod POP ).\nLet C = C(\u03a9, \u039b1 ). Also, identifying Si (P) with a matrix giving its action, let\n!\n!\nj\nr0Y\n+r1\nY\nS (j) (\u03a9) =\nSi (P)\nSi (P 2 ) .\ni=r0 +1\n\ni=r0 +r1 +1\n\nWe see that, with renewed notation,\n\u0012\n\u0013\u0012\n\u0013\nC\nI Y\nS \u22121 (\u03a9) = (A0 , A1 , A2 , A3 |B0 , B1 , B2 , B3 )\nMj\nt \u22121\nI\nC\n\n\f20\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nwith A3 , B3 \u2261 0 (mod POP ), B0 , B1 , B2 \u2261 0 (P 2 OP ).\nHowever, while the matrices for Si (P \u22122 ) lie in \u0393, the matrices for Si (P \u22121 ) do\nnot. We remedy this as follows.\nFor r0 < i \u2264 r0 + r1 , choose \u03b1i \u2208 P \u22121 , \u03b2i \u2208 PIi2 J \u2202 \u22121 , \u03b3i \u2208 P \u22121 Ii\u22122 J \u22121 \u2202 so\nthat \u03b1i \u03b4 \u2212 \u03b2i \u03b3i = 1 and for any prime Q =\n6 P dividing \u03b4, Q does not divide \u03b2i .\n(Recall that our choice of \u03b4 ensures \u03b4 \u2208 P \u2212 P 2 .) Set \u03b1 = diag(. . . , \u03b1i , . . . ), an\nr1 \u00d7 r1 matrix; define \u03b2, \u03b3 in an analogous fashion. So\n\uf8eb\n\ngives the action of\nNow consider\n\u0012\n\nI\n\ni=r0 +1\n\n\u0013\u0012\n\n\uf8f6\n\n0 r0\n\u03b1\n\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ec 0 r0\n\uf8ed\n\nQr0 +r1\n\n\u2212\u03bcW1\nI\n\nI r0\n\n\u03b2\n\n\uf8f7\n\uf8f7\n0\uf8f7\n\uf8f7\n\uf8f7\n\uf8f8\n\nI\nI r0\n\u03b3\n\n\u03b4I\n0\n\nI\n\nSi (P \u22121 ).\n\n\u03b2\n\u03b4I\n\n\u03b1\n\u03b3\n\n\u0013\n\n\u2261\n\n\u0012\n\n\u03b1 \u2212 \u03bcW1 \u03b3\n\u03b3\n\n\u03b2 \u2212 W1\n\u03b4I\n\n\u0013\n\n(mod P).\n\n\u0012\n\n\u0013\n\u03b2 \u2212 W1\nWe find that\nis a coprime symmetric right-hand pair for\n\u03b4I\n\u0393(Ir0 +1 , . . . , Ir0 +r1\u2032 ; J ) (2r1\u2032 \u00d7 2r1\u2032 matrices). Thus by Lemma 6.1, there exist matrices U, V so that\n\u0012\n\n\u03b2 + \u03b4W1\n\u03b4I\n\nU\nV\n\nHence\n\nX \u22121\n\n\uf8eb\n\nW1\nt\n\u2032\n\uf8ed\nW2\nand with Y =\nt\nW3\u2032\nN \u22121 =\n\n\u0012\n\n\uf8eb\n\nW2\n\nC\nC\n\n\u2208 \u0393(Ir0 +1 , . . . , Ir0 +r1\u2032 ; J ).\n\nI r0\n\n\uf8ec\n\uf8ec\n\uf8ec\n=\uf8ec\n\uf8ec 0 r0\n\uf8ed\n\nt\n\n\u0013\n\n\u22121\n\nW3\u2032\n\n\uf8f6\n\n0 r0\nU\n\n\u03b2 \u2212 W1\nI\nI r0\n\nV\n\n\u03b4I\n0\n\nI\n\n\uf8f6\n\n\uf8f8 and\n\n\u0013\u0012\n\nI\n\n\u2212Y\nI\n\n\uf8f7\n\uf8f7\n0\uf8f7\n\uf8f7 \u2208 \u0393,\n\uf8f7\n\uf8f8\n\n\u2032\n\n\u0013\n\n\uf8eb\n\nX \u22121 \uf8ed\n\nj\nY\n\ni=r0 +r1\u2032 +1\n\n\uf8f6\n\nSi (P \u22122 )\uf8f8 ,\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n21\n\nwe have Mj N \u22121 = (A0 , A1 , A2 , A3 |B0 , B1 , B2 , B3 ) with A3 , B3 \u2261 0 (mod POP ),\nB0 , B1 , B2 \u2261 0 (mod P 2 OP ). Thus by an easy generalization of Lemma 7.1 of [5],\nM N \u22121 \u2208 \u0393 \u2229 \u0393\u2032 . Also, since\n\u0013\u0012\n\u0013 \u0012\n\u0012\n\u0013\n\u03b4I \u2212\u03b2 + W1\nU \u03b2 \u2212 W1\nI 0\n=\n\u2208 \u0393(Ir\u2032 0 +1 , . . . , Ir\u2032 0 +r1\u2032 ; J ),\n\u03b1\n\u2212\u03b3\nV\n\u03b4I\nV\u2032 I\nwe have\n\n\u2032\n\n\u2032\n\nf |N = f |S(\u03a9)\n\n\u0012\n\nI\n\n\u2212Y\nI\n\n\u0013\u0012\n\nC \u22121\nt\n\nC\n\n\u0013\n\n.\u0003\n\nProposition 4.3. For f \u2032 \u2208 Mk (\u0393(I1 , . . . , In ; PJ )), we have\n\uf8f6\n\uf8eb\nI\nY0\n\u0012\nX\nI\n0 \uf8f7 C \u22121\n\uf8ec\n\u2032\nn(k\u2212n\u22121)/2\n\u2032\nf |S(\u03a9) \uf8ed\nf |T (P) = N (P)\n\uf8f8\nI\n\u03a9,Y0\nI\n\nt\n\nC\n\n\u0013\n\nand Y0 \u2208 (Ii Il J \u2202 \u22121 ) varies over symmetric r \u00d7 r matrices Q\nmodulo P and C varies\nn\nas in Proposition 4.2. Here r = mult{\u039b:\u03a9} (P) and S(\u03a9) = i=r+1 Si (P).\n\nProof. \u0012To find \u0013coset representatives for T (P), take M \u2208 \u0393(I1 , . . . , In ; J ); write\nA B\nM =\n. Let \u03a9 = ker(\u039b 7\u2192 \u039b(A) (mod P)), and choose C = C(\u03a9) so\nC D\u0012\n\u0013\nPIr\nthat \u03a9 = \u039bC\n. Thus (A|B)C = (A0 A1 |B0 B1 ), A1 \u2261 0 (mod POP ),\nIn\u2212r\nrankP A0 = r where A0 is n \u00d7r, and B0 \u2208 spanP A0 . Choose symmetric \u0012\nY0 with i,\u0013lY0\nentry in Ii Il J \u2202 \u22121 such that A0 Y0 \u2261 B0 (mod POP ). Then with Y =\n,\n\u03bcI\n\u0012\n\u0013\u0012\n\u0013\nQn\nC\nI \u2212Y\n(A|B)\nS \u22121 (\u03a9) = (A\u2032 |B \u2032 ) where S(\u03a9) = i=r+1 Si (P) and\nt \u22121\nI\nC\n\u2032\nB \u2261 0 (mod POP ). As before, choose diagonal (n \u2212 r) \u00d7 (n \u2212 r) matrices \u03b1, \u03b2, \u03b3\n\uf8f6\n\uf8ebI\n0r\nr\n\u03b2 \uf8f7\n\u03b1\n\uf8ec\nso that the action of S(\u03a9) is given by \uf8ed\n\uf8f8 . Then\n0r\nIr\n\u03b4I\n\u03b3\n\uf8eb\n\uf8f6\n\uf8eb\n\uf8f6\n\uf8f6\n\uf8ebI\nI\n0\n0\nI\n\u2212Y\n\u0012\n\u0013\n\u03b1 + \u03bc\u03b3\n\u03b1\n\u03b2 \uf8f7 \uf8ec\n\u03b2 + \u03b4I \uf8f7\nI\n0\uf8f7\uf8ec\nI \u2212Y \uf8ec\n=\uf8ed\n\uf8ed\n\uf8f8\n\uf8f8\n\uf8f8.\n\uf8ed0\nI\n0\nI\nI\nI\n\u03b4I\n\u03b4I\n\u03b3\n\u03b3\nI\n\u0012\n\u0013\n\u03b2 \u2212 \u03bc\u03b4I\nHere \u03b2 \u2261 0 (mod POP ), rankP (\u03b2 + \u03bc\u03b4I) = n \u2212 r. Thus\nis a sym\u03b4I\nmetric coprime right-hand pair for \u0393(Ir+1 , . . . , In ; J ), hence there are U, V so that\n\uf8f6\n\uf8eb\nI\n0\n\u0012\n\u0013\u0012\n\u0013\n\u03b4I \u2212\u03b2\nU \u03b2 + \u03bc\u03b4I\nU\n\u03b2 + \u03bc\u03b4I \uf8f7\n\uf8ec\n\u2208\n\uf8f8 \u2208 \u0393(I1 , . . . , In ; J ). Since\n\uf8ed\n\u2212\u03b3 \u03b1\n0\nI\nV\n\u03b4I\nV\n\u03b4I\n\u0393(Ir+1 , . . . , In ; PJ ) we get the result as claimed. \u0003\n\n\f22\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\n5. Evaluating the action of the Hecke operators.\nWhen evaluating the action of the operators Tj (P 2 ), we encounter incomplete\ncharacter sums. To complete these, we define modified operators as follows.\nDefinition. For P a prime ideal and 1 \u2264 j \u2264 n, define\nX\nTej (P 2 ) = N (P)j(k\u2212n\u22121)\n\u03b2(n \u2212 l, j \u2212 l)Sl+1 (P) * * * Sj (P)Tl (P 2 ).\n0\u2264l\u2264j\n\nWe will also need the following rather technical result.\n\nProposition 5.1. Let T1 be a symmetric r1 \u00d7 r1 matrix whose i, l-entry lies in\n(Ir0 +i Ir0 +l J )\u22121 , and whose ith diagonal entry lies in 2Ir\u22122\nJ \u22121 ; fix \u03bc \u2208 P \u22121 \u2212 O.\n0 +i\nWith W varying over all symmetric r1 \u00d7 r1 matrices modulo P with i, l-entry in\nIr0 +i Ir0 +l J \u2202 \u22121 ,\nX\nX X\ne{\u03bcT1 W } =\ne{\u03bcT\u2206 U }\nW\n\n0\u2264m\u2264r1\u2032 \u2206,U\n\nwhere for each m, \u2206 varies over dimension m subspaces of \u039b1 , \u2206 \u2243 T\u2206 (mod P),\nand U varies over all m \u00d7 m symmetric matrices modulo P.\nProof. For a moment, let's fix W . Since W is symmetric, we can view it as\nthe matrix of a quadratic form on an r1\u2032 dimensional O/P space V = L/PL,\n\u0001J \u22121 \u2202\nL = Ir\u22121\ny\n\u2295\n*\n*\n*\n\u2295\nI\ny\n. (When P is dyadic, let W define an integral\n1\nr\n+r\nr\n0\n1\n1\n+1\n0\nquadratic form on\nL = (OP Ir\u22121\ny \u2295 * * * \u2295 OP Ir\u22121\ny )J\n0 +r1 r1\n0 +1 1\n\n\u22121\n\n\u2202\n\n,\n\nand let V = L/PL, a quadratic space over OP /POP \u2248 O/P. We use \u00a793 of [6]\nto understand the structure of L and thereby of V .) The radical of this space is\nuniquely defined, so for some G \u2208 GLr1 (O),\n\u0012\n\u0013\nU\nt \u22121\n\u22121\nG WG \u2261\n(mod P)\n0\nwhere U is m \u00d7 m with rankP U = m. (So V G\u22121 = J \u2295 radV where J is a regular\nspace whose isometry class is uniquely determined by V , and J \u2243 U .)\nSo\n\u0012\n\u0013\nU\nt\ne{\u03b1T1 W } = e{\u03b1T1 G\nG}\n0\n\u0012\n\u0013\nU\nt\n= e{\u03b1(GT1 G)\n}\n0\n= e{\u03b1SU }\n\u0012\n\u0013\nS \u2217\nt\nwhere GT1 G =\n, S an m \u00d7 m matrix. Here we take \u039b to be a rank\n\u2217 \u2217\nn lattice as in the previous section, and we equip \u039b with a quadratic form such\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n23\n\nthat \u039b \u2243 T\u0012\n; thus\n\u0013 with \u039b1 as in the previous section, we have \u039b1 \u2243 T1 , and\nIm\n\u2206 = \u039b1 t G\n\u2243 S. So S corresponds to an m-dimensional subspace \u2206 of\n0\nthe O/P-space \u039b1 . Thus each W gives rise to (at least one) pair (\u2206, U ), \u2206 an\nm-dimenstional subspace of \u039b1 , U an m \u00d7 m integral symmetric matrix of rank m\nmodulo P.\nWith T1 still fixed, fix m, 0 \u2264 m \u2264 r1 . We now define a map \u03c6 from all pairs\n(\u2206, U ) as above to symmetric r1 \u00d7 r1 matrices W . Here \u2206 is an m-dimensional\nsubspace of \u039b1 , and U is an integral symmetric m \u00d7 m matrix with rank\n\u0012 P U\u0013= m.\nIm\nFor each such \u2206 we fix some G = G\u2206 \u2208 GLr1 (O) so that \u2206 = \u039b1 t G\n. We\n0\n\u0012\n\u0013\nU\nt\nG.\ndefine \u03c6(\u2206, U ) = G\n0\nWe first show that the image of \u03c6 consists of all symmetric r1 \u00d7 r1 matrices W\nmodulo P with rankP W = m. Then we show that \u03c6 is injective.\nAs shown above, given any W in the codomain of \u03c6,\nt\n\nW \u2261 G\n\n\u0012\n\nU\n0\n\n\u0013\n\nG (mod P)\n\nwhere U is m \u00d7 m, m\n\u0012 = rank\n\u0013 P U , and G \u2208 GLr1 (O).\nI\nm\n. So \u2206 is an m-dimensional subspace of \u039b1 , and thus\nTake \u2206 = \u039b1 t G\n0\n\u0012\n\u0013\n\u0012\n\u0013\nIm\nIm\nt\nG\nand t G\u2206\neach map a basis for \u039b1 to a basis for \u2206. Hence with\n0\n0\n(x1 , . . . , xr1 ) a basis for \u039b1 , (x1 , . . . , xr1 ) t G = (y1 , . . . , yr1 ), (x1 , . . . , xr1 ) t G\u2206 =\n(z1 , . . . , zr1 ), we must have (y1 , . . . , ym ) \u2261 (z1 , . . . , zm )\u0012t C (mod\u0013P) for some C \u2208\nt\nC \u2217\nGLm (O). Thus (x1 , . . . , xr1 ) t G = (x1 , . . . , xr1 ) t G\u2206\n, meaning t G =\n0\n\u2217\n\u0012 t\n\u0013\nC \u2217\nt\nG\u2206\n.\n0 \u2217\nHence modulo P,\nt\n\nW \u2261 G\n\n\u0012\n\nU\n0\n\n\u0013\n\nt\n\nG = G\u2206\n\n\u0012\n\nt\n\nC\n0\n\n\u2217\n\u2217\n\n\u0013\u0012\n\nU\n0\n\n\u0013\u0012\n\nC\n\u2217\n\n0\n\u2217\n\n\u0013\n\nG\u2206 = \u03c6(\u2206, t CU C).\n\nThus \u03c6 is surjective.\nNow we show \u03c6 is injective. Say\nW \u2261 \u03c6(\u22061 , U1 ) \u2261 \u03c6(\u22062 , U2 ) (mod P).\nThus with Gi = G\u2206i , we have\nt\n\nW \u2261 G1\n\n\u0012\n\nU1\n0\n\n\u0013\n\nt\n\nG1 \u2261 G2\n\n\u0012\n\nU2\n0\n\n\u0013\n\nG2 (mod P).\n\n\f24\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nSo with G = G2 G\u22121\n1 ,\n\u0012\n\nU1\n0\n\n\u0013\n\nt\n\n\u2261 G\n\n\u0012\n\nU2\n0\n\n\u0013\n\nG (mod P).\n\nSince the\n\u0012\n\u0013 columns of Ui are linearly independent modulo P, we must have G \u2261\nC 0\n(mod P).\n\u2217 \u2217\nNow we compare \u22061 , \u22062 ; we will find that \u22061 = \u22062 , so G1 = G2 and hence\nU1 \u2261 U2 (mod P). With notation as before, we have\n\u0012\n\u0013\nIm\nt\n(y1 , . . . , ym ) = (x1 , . . . , xr1\u2032 ) G1\n,\n0\n\u0012\n\u0013\nIm\nt\n(z1 , . . . , zm ) = (x1 , . . . , xr1\u2032 ) G2\n0\n\u0012\n\u0013\nIm\nt\nt\n= (x1 , . . . , xr1\u2032 ) G1 G\n.\n0\nThus given our knowledge of G, we see that (y1 , . . . , ym ) = (z1 , . . . , zm ) t C, and\nhence \u22061 = \u22062 . Thus G1 = G2 , and consequently U1 \u2261 U2 (mod P). Therefore \u03c6\nis injective. \u0003\nWe can now prove our main result. In the remark following the proof we demonstrate how to compute the geometric term \u03b1j (\u03a9, \u039b).\nTheorem 5.2. Let F \u2208 Mk (\u03c7) where \u03c7 is a character of the ideal class group and\nMk (\u03c7) is as defined in Proposition 3.2.\n(1) The \u039bJ th coefficient of F |Tej (P 2 ) is\nX\nN (P)Ej (\u039b,\u03a9) \u03c7(P)ej (\u039b,\u03a9) \u03b1j (\u03a9, \u039b)cF (\u03a9J )\nP\u039b\u2286\u03a9\u2286P \u22121 \u039b\n\nwhere Ej (\u039b, \u03a9) = k(r2 \u2212 r0 + j) + r0 (r0 + m1 + 1) + r1 (r1 + 1)/2 \u2212 j(n + 1),\nej (\u039b, \u03a9) = 2r2 + r1 = r2 \u2212 r0 + j, and \u03b1j (\u03a9, \u039b) is the number of totally isotropic\ncodimension n \u2212 j subspaces of \u03a9 \u2229 \u039b/P(\u03a9 + \u039b). Here r0 = mult{\u039b:\u03a9} (P),\nm1 = mult{\u039b:\u03a9} (O), r1 = m1 \u2212 n + j, and r2 = mult{\u039b:\u03a9} (P \u22121 ).\n(2) The \u039bJ th coefficient of F |T (P) is\nX\n\u22121\nN (P)E(\u03a9,\u039b) \u03c7(P)n\u2212r cF (\u03a9J P )\nP\u039b\u2286\u03a9\u2286\u039b\n\nwhere r = mult{\u039b:\u03a9} (O) and E(\u03a9, \u039b) = k(n \u2212 r) + r(r + 1)/2 \u2212 n(n + 1)/2.\nProof. Take fractional ideals I1 , . . . , In , J and f \u2032 \u2208 Mk (\u0393(I1\u2032 , . . . , In\u2032 ; J )),\n\u001a\nPIi if i \u2264 j,\n\u2032\nIi =\nIi\nif i > j.\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n25\n\nIn the preceeding proposition, consider the subsum where we fix a choice of \u03a9:\n\u0012\n\u0013 \u0012 \u22121\n\u0013\n\u0012\n\u0013 \u0012 \u22121\n\u0013\nX\nX\nI Y\nC\nI Y\nC\n\u2032\n2r2 +r1\n\u2032\u2032\nf |S(\u03a9)\n= \u03c7(P)\nf |\nt\nt\nI\nC\nI\nC\n\u039b1 ,Y\n\n\u039b1 ,Y\n\nwhere f \u2032\u2032 is the component of F corresponding to the group \u0393(I1\u2032\u2032 , . . . , In\u2032\u2032 ; J ),\n\uf8f1\nif 1 \u2264 i \u2264 r0 ,\n\uf8f4\n\uf8f2 PIi\n\u2032\u2032\n\u22121\nIi = P Ii if r0 + r1 < i \u2264 j,\n\uf8f4\n\uf8f3\nIi\notherwise.\n\nSet m1 = r1 + n \u2212 j. Expanding f \u2032\u2032 as a Fourier series supported on even T \u2208\n((Ii\u2032\u2032 Il\u2032\u2032 J )\u22121 ), we find that for fixed \u039b1 ,\nX\n\n\u2032\u2032\n\nf |\n\nY\n\n=\n\n\u0012\n\nI\n\nX\n\nY\nI\n\n\u0013\u0012\n\nC \u22121\nt\n\nC\n\n\u0013\n\n(\u03c4 )\n\ncf \u2032\u2032 (T )e{T C \u22121 \u03c4 t C \u22121 }\n\nT\n\n=\n\nX\nT\n\nX\n\ne{T Y }\n\nY\n\ncf \u2032\u2032 (T )e{T C\nX\n\n\u22121\n\nt\n\n\u03c4 C\n\n\u22121\n\n}\n\ne{T0 W0 } e{\u03bcT1 W1 } e{T2 W2 } e{T3 W3 }\n\nW0 ,W1 ,W2 ,W3\n\n\uf8f6\nT0 T2 \u2217 T3\n\uf8ec t T T1 \u2217 \u2217 \uf8f7\nwhere T = \uf8ed 2\n\uf8f8 . T0 and W0 are symmetric r0 \u00d7 r0 matrices with\n\u2217\n\u2217 \u2217 \u2217\nt\nT3 \u2217 \u2217 \u2217\nT0 even, the i, l-entry of W0 in Ii Il J \u2202 \u22121 . Thus the sum on W0 (T0 fixed) is a\ncomplete character sum, yielding N (P)r0 (r0 +1) if T0 \u2261 0 (mod P), and 0 otherwise.\nSimilarly, the sums on W2 , W3 are complete character sums. So\nP\n\u001a\nX\nN (P)r0 (r0 +m1 +1) W1 e{\u03bcT1 W1 } if T \u2208 ((Ii Il J )\u22121 ),\ne{T Y } =\n0\notherwise.\nY\n\uf8eb\n\nWith (B(xi , xl )) = t C \u22121 T C \u22121 , take \u039b = I1 x1 \u2295 * * * \u2295 In xn . Then the sum on\nW0 , W2 , W3 is nonzero if and only if \u039bJ is even integral.\nLet (y1 . . . yn ) = (x1 . . . xn )C and set \u03a9 = I1\u2032\u2032 y1 \u2295* * *\u2295In\u2032\u2032 yn . Then (B(yi , yl )) = T\nand cf \u2032\u2032 (T )N (I1\u2032\u2032 * * * In\u2032\u2032 )k N (J )nk/2 = cF (\u03a9J ).\nNote that when cf |S l (P) (T ) is contributing to the \u039bJ th coefficient of f |Tj (P 2 ) \u2208\nMk (\u0393(I1 , . . . , In ; J )), it gets normalized by N (I1 . . . In )k N (J )nk/2 ; when it is\ndetermining a coefficient of f |S l (P) \u2208 Mk (\u0393\u2032 ), \u0393\u2032 \u2243 \u0393(P \u2212l I1 , I2 , . . . , In ; J ), it\ngets normalized by N (P)\u2212lk N (I1 . . . In )k N (J )nk/2 .\n\n\f26\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nSo the contribution from f \u2032\u2032 to the \u039bJ th Fourier coefficient of f \u2032 |Tj (P 2 ) is\nX\n\u2032 X\nN (P)j(k\u2212n\u22121)+r0 (r0 +m1 +1) \u03c7(P)2r2 +r1\nN (P)k(2r2 +r1 ) cF (\u03a9J )\ne{\u03bcT\u039b1 W1 }\n\u03a9,\u039b1\n\nW1\n\nwhere \u03a9 varies subject to P\u039b \u2286 \u03a9 \u2286 P \u22121 \u039b, mult{\u039b:\u03a9} (P \u22121 ) = r0 , mult{\u039b:\u03a9} (P) =\nr2 , \u039b1 a codimension n\u2212j subspace of \u03a91 \u2243 \u03a9\u2229\u039b/P(\u03a9+\u039b), and W1 varies modulo\nP with i, l-entry in Ii Il J \u2202 \u22121 , P 6 | det W1 . Here T\u039b1 = (B(xr0 +i , xr0 +l )) is r1 \u00d7 r1\nwhere \u039b1 = Ir0 +1 xr0 +1 \u2295 * * * \u2295 Ir0 +r1 xr0 +r1 . If T1\u2032 is also a matrix associated to\n\u039b1 then there is a change of basis matrix G whose i, l-entry lies in Ii Il\u22121 so that\nt\nGT1\u2032 G = T\u039b1 . Thus e{\u03bcT1\u2032 W1 } = e{\u03bcT\u039b1 (GW1 t G)}; as W1 varies over invertible\nmatrices modulo P, so does GW1 t G. Thus the sum on W1 is independent of the\nchoice of matrix associated to \u039b1 .\nWe complete the character sum on W1 P\nby replacing Tj (P 2 ) with Tej (P 2 ), then\napply Proposition 5.1, where we consider W e{\u03b1T1 W } with W varying over all\nsymmetric r1 \u00d7 r1 integral matrices modulo P.\nNotice that for 0 \u2264 l \u2264 j,\nSl+1 (P) * * * Sj (P)Tl (P 2 ) : Mk (\u0393(I1\u2032 , . . . , In\u2032 ; J )) \u2192 Mk (\u0393(I1 , . . . , In ; J ).\nAlso notice that the number of dimension r1 = m1 \u2212n+j lattices \u039b1 containing some\ndimension m1 \u2212n+l lattice \u2206 is the number of ways to extend \u2206 to a j-dimensional\nsubspace of \u03a91 (where \u03a9 = \u03a90 \u2295 \u03a91 \u2295 \u03a92 , \u039b = P\u03a90 \u2295 \u03a91 \u2295 P \u22121 \u03a92 ). Extending\n\u2206 is equivalent to choosing a j \u2212 l dimensional subspace of an n \u2212 l space (here\ndim \u03a91 = m1 ). So the number of \u039b1 containing \u2206 is \u03b2(n\u2212l, j \u2212l) = \u03b2P (n\u2212l, j \u2212l).\nNote that the coefficient of f \u2032 |Tej (P 2 ) associated to \u039bJ = (I1 x1 \u2295 * * * \u2295\nIn xn )J carries a normalizing factor of N (I1 * * * In )k N (J )nk/2 , while the coefficient of f \u2032 |S (j) (P) associated to \u03a9J = (I1\u2032\u2032 y1 \u2295 * * * \u2295 In\u2032\u2032 yn )J carries a factor of\nN (P)k(r0 \u2212r2 ) N (I1 * * * In )k N (J )nk/2 . Hence, contributing to c(\u039bJ ) we have\nX\nN (P)k(r2 \u2212r0 +j)+r0 (r0 +m1 +1)+r1 (r1 +1)/2\u2212j(n+1) \u03c7(P)2r2 \u2212r0\nc(\u03a9J )\n\u039b1\n\nJ\nwhere \u039bJ\n1 varies over all totally isotropic codimension n \u2212 j sublattices of \u039b \u2229\n\u03a9J /P(\u039bJ + \u03a9J ). Summing over all \u03a9, P\u039b \u2286 \u03a9 \u2286 P \u22121 \u039b, yields (1).\nThe proof of (2) is quite similar to the proof of (1), but much simpler, and so\nwe leave it to the reader. \u0003\nJ\nRemark. As discussed above Proposition 2.2, \u039bJ\n1 /P\u039b1 is a quadratic space over\nO/P. By \u00a742 of [6] (for results about quadratic spaces over fields of characteristic\nJ\nJ\nJ\nt\n/P\u039bJ\n2, see, for example, \u00a75 of [9]),\n1 = R \u22a5 W \u22a5 H where R = rad\u039b1 /P\u039b1 ,\n\u0012 \u039b1 \u0013\n0 1\nW is anisotropic, and H \u2243\ndenotes a hyperbolic plane. With U = R \u22a5 W ,\n1 0\nLemma 1.6 of [8] and Lemma 4.1 of [9] tell us that the number of l-dimensional\nJ\ntotally isotropic subspaces of \u039bJ\n1 /P\u039b1 is\nX\nJ\n\u03c6l (\u039bJ\n/P\u039b\n)\n=\nq (t\u2212a)(l\u2212a) \u03b4(d + t \u2212 l + a + 1, a)\u03b2(t, a)\u03c6l\u2212a (U )\n1\n1\na\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n27\n\nQr\u22121\nQr\u22121\nwhere q = N (P), d = dim U , \u03b4(m, r) = i=0 (q m\u2212i + 1), \u03b2(m, r) = i=0 (q m\u2212i \u2212\n1)/(q r\u2212i \u2212 1), and 0 \u2264 a \u2264 l. (Note that Lemma 1.6 of [8] is proved for a quadratic space over Z/pZ, but the argument is valid over all finite fields. When the\ncharacteristic is 2, we replace Q by 12 Q; we present a full discussion of this case\nin \u00a75 of [9].) Also, since U = R \u22a5 W with R totally isotropic and W anisotropic,\nany totally isotropic subspace of U is a subspace of R. Thus \u03c6l\u2212a (U ) = \u03b2(r, l \u2212 a)\nwhere r = dim R. (So d = dim U = r + dim W , and since W is anisotropic, dim W\nis 0, 1, or 2 by 62:1b of [6] for q odd, and by, e.g., Proposition 5.1 of [9] for q even.)\nHence\nX\n\u03b1j (\u03a9, \u039b) =\nq (t\u2212a)(l\u2212a) \u03b4(d + t + a + 1, a)\u03b2(t, a)\u03b2(r, l \u2212 a)\na\n\nwhere 0 \u2264 a \u2264 l, l = r1 \u2212 n + j.\n6. Lemma on symmetric coprime pairs.\nDefinition. We say a pair of matrices (C, D) is a symmetric coprime lower pair\nfor \u0393(I1 , . . . , In ; J ) if:\n(a) C t D is symmetric; \u0001\n\u0001\n(b) C \u2208 J \u22121 \u2202 Ii\u22121 Ij\u22121 , D \u2208 Ii\u22121 Ij ;\n(c) for all prime ideals P,\n\uf8eb\n\n\u03bb1\n\n..\n\nrankP \uf8ed\n\n.\n\n\uf8eb\n\n\u03b1\u03bb1\n\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8f8 (C, D) \uf8ec\n\uf8ec\n\uf8ec\n\uf8ec\n\u03bbn\n\uf8ed\n\uf8f6\n\n..\n\n\uf8f6\n\n.\n\u03b1\u03bbn\n\n\u03b1\u03bb\u22121\n1\n\n..\n\n.\n\u03b1\u03bb\u22121\nn\n\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7=n\n\uf8f7\n\uf8f7\n\uf8f8\n\nwhere \u03b1OP = J \u2202 \u22121 OP , \u03bbi OP = Ii OP .\nSince \u0393(I1 , . . . , In ; J ) \u2248 \u0393(O, . . . , O, I; J ) when I \u2208 cls(I1 * * * In ), the following technical lemma focuses on \u0393(O, . . . , O, I; J ), but the conclusion (c) is valid\nfor \u0393(I1 , . . . , In ; J ).\nCorresponding definitions and results hold for symmetric coprime upper, righthand, and left-hand pairs for \u0393(I1 , . . . , In ; J ).\nLemma 6.1. Let I, J be fractional ideals; set\nG = {E \u2208\n\n\u22121\n\n\u0012\n\nI\n\n\u0012\n\n\u0013\n\nI\nI\nn,n\n\n\u0013\n\n\u0012\n\nO\n\nI\n\nn,n\n\n\u0012\n\nI\nI \u22121\n\n\u0013\n\n: det E = 1 }.\n\n\u0013\n\u0012\nI\n\u22121 , D \u2208\n\nO\nI\nI \u22121\nsymmetric coprime lower pair for \u0393(O, . . . , O, I; J ).\n\nSay C \u2208 J\n\n\u2202\n\nI \u22121\n\n\u0013\n\nO\n\nn,n\n\n\u0012\n\nI\nI\n\n\u0013\n\nare a\n\n\f28\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\n(a) Let Q be a prime ideal, and choose \u03bb \u2208 I, \u03b1 \u2208 J \u2202 \u22121 such\nord\nI, ordQ\u0013\u03b1 = ordQ J \u2202 \u22121 . Then there is some E \u2208 G so\n\u0012Q \u03bb =\u0013ordQ\u0012\nI\nI\n\u03b1\nCE\n\u2261 (C0 , 0) (mod Q) where C0 is n \u00d7 r with rankQ C0\n\u03bb\n\u03bb\n(b) There is a matrix M \u2208 \u0393(O, . . . , O, I; J ) so \u0001that (C|D)M = (C \u2032 |D\u2032 )\n\u2032\n\u2032\ndet C \u2032 , det D\u2032 6= 0 and (J \u2202 \u22121 )n I 2 det C\n\u0012 , det D\u0013 = 1.\nA B\n(c) There are n \u00d7 n matrices A, B so that\n\u2208 \u0393(O, . . . , O, I; J ).\nC D\n\nthat\nthat\n= r.\nwith\n\nProof. It suffices to establish the claims for \u0393(O, . . . , O, P; J ) where P is a prime\nideal in clsI. Choose \u03b1 \u2208 J \u2202 \u22121 so that ordQ \u03b1 = ordQ J \u2202 \u22121 whenever ordQ J \u2202 \u22121 6=\n0. Choose \u03bb \u2208 P\u0012\u2212 P 2 , \u0013\u03bc \u2208 \u0012P \u22121 \u2212 \u0013\nO so that \u03bb\u03bc \u2261 1 (mod P).\nI\nI\ne\ne = \u03b1\n(a) Let C\nC\n= (c1 . . . cn ) (so ci is the ith column of C).\n\u03bb\n\u03bb\nThen there is some E \u2032 \u2208 GLn\u22121 (O) so that\n(c1 . . . cn\u22121 )E \u2261 (C0\u2032 , 0) (mod P)\n\u0012 \u2032\nE\n\u2032\n\u2032\n\u2032\nwhere C0 is n \u00d7 r , r = rankP (c1 . . . cn\u22121 ). So E1 =\n\u03b1\n\n\u0012\n\nI\n\u03bb\n\n\u0013\n\nCE1\n\n\u0012\n\nI\n\u03bb\n\n\u0013\n\n1\n\n\u0013\n\n\u2208 G, and\n\ne 1 \u2261 (C0\u2032 , 0, c ) (mod P).\n= CE\nn\n\nFirst suppose cn \u2208 spanP C0\u2032 . Thus there exist \u03b31 , . . . , \u03b3r \u2208 O so that C0\u2032 \u03b3 \u2261\n\uf8eb \uf8f6\n\uf8eb\n\uf8f6\n\u03b31\nI\n\u03bc\u03b3\n\uf8ec . \uf8f7\n\uf8f8 . Then\n\u2212cn (mod P) where \u03b3 = \uf8ed .. \uf8f8 . Let E = E1 \uf8ed\nI\n1\n\u03b3r\n\u03b1\n\n\u0012\n\nI\n\u03bb\n\n\u0013\n\nCE\n\n\u0012\n\nI\n\u03bb\n\n\u0013\n\ne 1\n= CE\ne 1\n\u2261 CE\n\u2261\n\n\u0012\n\n\u0012\n\n(C0\u2032 , 0)\n\nI\n(\u03bc\u03bb)\u22121\nI\n(\u03bc\u03bb)\u22121\n(mod P),\n\n\u0013\n\n\u0013\n\n\uf8eb\n\uf8ed\n\n\uf8eb\n\uf8ed\n\nI\n\n\u03b3\n\nI\n1\nI\n\n\u03b3\nI\n1\n\n\uf8f6\n\uf8f8\n\uf8f6\n\uf8f8\n\n\u0012\n\u0012\n\nI\n\u03bc\u03bb\nI\n\u03bc\u03bb\n\n\u0013\n\u0013\n\n(mod P)\n\nproving (a) in the case cn \u2208 spanP C0\u2032 .\ne=n\nSo suppose cn 6\u2208 spanP C0\u2032 . If r \u2032 = n \u2212 1 then we are done, as then rankP C\nand we can take E = I. So let us also suppose r \u2032 < n \u2212 1. Choose \u03b4 \u2208 P so\nthat for all primes Q|\u03bc\u03bb, Q 6 |\u03b4. Thus !\n(\u03bc\u03bb, \u03b4) = 1, so there are u, v \u2208 O so that\nI\n\u03bd \u03bc\u03b7 \u2208 G, and\nv\u03b4 \u2212 u\u03bc\u03bb = 1. Thus E2 =\n\u03bb \u03b4\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\nI\nI\nI\nI\ne\n\u03b1\nCE1 E2\n\u2261 CE1 *\nE2\n(mod P)\n\u03bb\n\u03bb\n\u03bc\n\u03bb\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n29\n\nwhere c\u2032i = ci\u0012for i <\u0013n \u2212 1, c\u2032n\u22121 \u2261 cn (mod P) and c\u2032n \u2261 0 (mod P).\n\u2217\nLet E3 =\nbe a permutation matrix that interchanges columns r \u2032 and\n1\nn \u2212 1. So E = E1 E2 E3 \u2208 G, and (a) is proved.\n(b) Let A = (J \u2202 \u22121 )n * I 2 * det C \u2286 O. Take \u03bb \u2208 I, \u03b7 \u2208 I \u22121 , \u03b1 \u2208 J \u2202 \u22121 , \u03bc \u2208 J \u22121 \u2202\nso that \u03bb\u03b7 \u2261 \u03b1\u03bd \u2261 1 (mod Q).\nCase 1: Say det D 6= 0, det D 6\u2208 O\u00d7 . Part (a) says there exists some E \u2208 G so\nthat\n\u0012\n\u0013\n\u0012\n\u0013\nI\nI\n\u03b1\nCE\n\u2261 (C0 , 0) (mod Q),\n\u03bb\n\u03bb\n\u0012\n\u0013\nE\nwith C0 n \u00d7 r, rankQ C0 = r. Thus\n\u2208 \u0393(O, . . . , O, I; J ), and\nt \u22121\nE\n\u0012\n\nI\n\u03bb\n\n\u0013\n\n(C|D)\n\n\u0012\n\nE\nt\n\nE\n\n\u22121\n\n\u0013\n\n\uf8eb\n\n\uf8f6\n\n\u03b1I\n\u03b1\u03bb\n\n\uf8ec\n\uf8ed\n\nI\n\u03b7\n\n\uf8f7\n\uf8f8 \u2261 (C0 , 0)D0 , D1 ) (mod Q);\n\nhere D0 \u2286 spanQ C0 (since C t D is symmetric; see the proof of Lemma 7.2 in [5]),\nand thus rank\u0012\nQ (C0 |D\u0013\n1 )\u0012= n.\n\u0013\u0012\n\u0013\nI\n0r\nI\nSet W = \u03bc\n; hence\n\u03b7\nIn\u2212r\n\u03b7\nMQ =\n\n\u0012\n\nE\nt\n\nE \u22121\n\n\u0013\u0012\n\nI\nW\n\n0\nI\n\n\u0013\n\n\u2208 \u0393(O, . . . , O, I; J ).\n\nAlso, with (C \u2032 |D\u2032 ) = (C|D)MQ , det D\u2032\u2032 = det D and\n\u0012\n\nI\n\u03bb\n\n\u2261\n\n\u0013\n\u0012\n\n\uf8eb\n\n\u03b1\u03bb\n\n\uf8ec\n(C \u2032 |D\u2032 ) \uf8ed\nI\n\u03bb\n\n\u0013\n\nI\n\u03b7\n\n(C|D)\n\n\u0012\n\nE\nt\n\nE \u22121\n\n(mod Q).\n\u0012\n\nI\n\n\u0013\n\n\uf8f6\n\n\u03b1I\n\n\u0012\n\nI\n\n\u0013\n\n\uf8f7\n\uf8f8\n\u0013\n\n\uf8eb\n\uf8ec\n\uf8ed\n\n\uf8f6\uf8eb\n\n\u03b1I\n\u03b1\u03bb\nI\n\u03b7\n\n\uf8f7\uf8ec\n\uf8f8\uf8ed\n\n\uf8f6\n\nI\nI\n0r\n\nI\nI\n\nI\n\n\uf8f7\n\uf8f8\n\n= n, and hence Q 6 |(J \u2202 \u22121 )n I 2 det C \u2032 .\nC\n\u03bb\n\u03bb\nOnly finitely many prime ideals Q divide det D, so repeating this process for all\nsuch Q yields a pair (C \u2032 |D\u2032 ) = (C|D)M , M \u2208 \u0393(O, . . . , O, I; J ), det C \u2032 , det D\u2032 6= 0,\nand (J \u2202 \u22121 )n I 2 det C \u2032 , det D\u2032 ) = 1.\nCase 2: Say det D \u2208 O\u00d7 . If det C 6= 0 then we are done; so suppose det C = 0.\nThen let Q be any prime ideal; following the algorithm in Case 1, we produce\n\nThus rankQ \u03b1\n\n\u2032\n\n\f30\n\nSUZANNE CAULK AND LYNNE H. WALLING\n\nMQ \u2208 \u0393(O, . . . , O, I; J ) so that with (C \u2032 |D\u2032 ) = (C|D)MQ , we have det D\u2032 = det D\nand Q 6 | det C \u2032 (so det C \u2032 6= 0). This completes this case.\nCase 3: Say det D = 0. Choose a prime Q; with \u03bb, \u03b7, \u03b1, \u03bc as in Case 1, we know\nthere is some E \u2208 G so that\n\uf8f6\n\uf8eb\n\u0012\n\u0013\n\u0012\n\u0013 \u03b1I\n\u03b1\u03bb\nI\nE\n\uf8f7\n\uf8ec\n(C|D)\n\uf8f8 \u2261 (C0 , 0|D0 , D1 ) (mod Q)\n\uf8ed\nt \u22121\nI\n\u03bb\nE\n\u03b7\n\nwith rankQ (C0 |D1 ) = n, D0 \u2286 spanQ C0 . Thus for some Y \u2208 Or,r , rankQ (C0 Y +\nD0 , D1 ) = n. Note that Y is uniquely determined modulo Q, and that C0 t D0 is\nsymmetric modulo Q. Since C0 Y t C0 \u2261 \u2212D0 t C0 (mod Q), we can choose Y to be\nsymmetric in Or,r .\nSet\n\u0012\n\u0013\u0012\n\u0013\u0012\n\u0013\nI\nY\nI\n\u2032\nY =\u03b1\n;\n\u03bb\n0\n\u03bb\n\u0013\u0012\n\u0013\n\u0012\nI Y\u2032\nE\n\u2208 \u0393(O, . . . , O, I; J ). Thus with (C \u2032 |D\u2032 ) =\nhence M =\nt \u22121\nI\nE\n(C|D)M , we have\n\u0012\n\nI\n\u03bb\n\n\u0013\n\n\uf8eb\n\n\uf8ec\n(C \u2032 |D\u2032 ) \uf8ed\n\n\u0012\n\nI\n\n\u0013\n\n\uf8f6\n\n\u03b1I\n\u03b1\u03bb\nI\n\u03b7\n\u0012\n\nI\n\n\u0013\n\n\uf8f7\n\uf8f8 \u2261 (C0 , 0|C0 Y + D0 , D1 ) (mod Q).\n\n= n, so Q 6 | det D\u2032 (and thus det D\u2032 6= 0). This\nD\n\u03b7\n\u03bb\nreduces this situation to one of the previous cases.\n(c) Set \u03ba = det D; choose \u03bb \u2208 A so that (\u03ba, \u03bb) = 1, and \u03b7 \u2208 O\nso that \u03b7 \u2261 \u03ba\u22121 (mod \u03bb) \u0012\n(this is possible\nRemainder The\u0012by the Chinese\n\u0013\n\u0013\nI\nI\n, we have \u03bb t C \u22121 \u2208\norem). Since C \u2208 J \u22121 \u2202\nOn,n\n\u22121\n\u22121\nI\nI\n\u0012\n\u0012\n\u0013\n\u0013\nI\nI\n\u22121\nn,n\n. Also, \u03bb|(\u03b7\u03ba \u2212 1), so\nJ\u2202\nO\nI\nI\n\u0012\n\u0012\n\u0013\n\u0013\nI\nI\nn,n\nt \u22121\n\u22121\n.\nO\nB = (\u03b7\u03ba \u2212 1) C \u2208 J \u2202\nI\nI\n\u0012\n\u0012\n\u0013\n\u0013\nI\nI\n\u22121\n(Note that locally everywhere: C \u2208 J \u2202\nC\n, C0 \u2208 On,n ,\nI \u22121 \u0012 0 \u0013 I \u22121 \u0012\n\u0013\nI\nI\n1\n\u22121 n 2\n\u22121\n\u22121\nn,n\ndet C0 = (J \u2202 ) I det C; hence C \u2208 det C0 J \u2202\nO\n.)\nI\nI\nt \u22121\nA = \u0012\u03b7\u03ba t D\u22121\u0013. We have\n\u2208\n\u0012 \u03ba =\n\u0013 det D, \u03b7 \u2208 O, so \u03b7\u03ba D\n\u0012 Set \u0013\nA\nB\nI\nI\n. Thus\nis a candidate for \u0393(O, . . . , O, I; J ).\nOn,n\nC D\nI \u22121\nI\nHence rankQ\n\n\u2032\n\n\fHECKE OPERATORS ON HILBERT-SIEGEL MODULAR FORMS\n\n31\n\nTo see this matrix indeed lies in this group, first note that A t D \u2212 B t C = I,\nand by assumption, C t D is symmetric. Finally, substituting for A and B, we get\nA t B = \u03b7\u03ba(\u03b7\u03ba \u2212 1) t D\u22121 C \u22121 ; since t D\u22121 C \u22121 = (C t D)\u22121 is symmetric, so is A t B.\n\u0003\nReferences\n1. A.N. Andrianov, Quadratic Forms and Hecke Operators, Grundlehren Math. Wiss., Vol. 286,\nSpringer-Verlag, New York/Berlin, 1987.\n2. S. Caulk, Explicit action of Hecke operators on Hilbert-Siegel modular forms of degree 2\n(dissertation), (2002), University of Colorado, Boulder.\n3. M. Eichler, On theta functions of real algebraic number fields, Acta Arith. 33 (1977), 269-292.\n4. E. Freitag, Siegelsche Modulfunktionen, Gurndlehren Math. Wiss., Vol. 254, Springer-Verlag,\nBerline/Heidelberg/New York, 1983.\n5. J.L. Hafner, L.H. Walling, Explicit action of Hecke operators on Siegel modular forms, J.\nNumber Theory 93 (2002), 34-57.\n6. O.T. O'Meara, Introduction to Quadratic Forms, Springer-Verlag, New York, 1973.\n7. G. Shimura, The special values of the zeta functions associated with Hilbert modular forms,\nDuke Math. J. 45 (1978), 637-679.\n8. L.H. Walling, Action of Hecke operators on Siegel theta series I, International J. of Number\nTheory 2 (2006), 169-186.\n9. L.H. Walling, Action of Hecke operators on Siegel theta series II (submitted).\n10. V.G. Zhuravlev, Euler products for Hilbert-Siegel modular forms of genus two, Mat. Sb. (N.S.)\n117 (1982), 449-468.\nS. Caulk, Department of Mathematics, Regis University, Denver Colorado\nL.H. Walling, Department of Mathematics, University of Colorado, Boulder CO\n80309\n\n\f"}