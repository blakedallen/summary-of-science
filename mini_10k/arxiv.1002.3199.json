{"id": "http://arxiv.org/abs/1002.3199v2", "guidislink": true, "updated": "2010-06-14T07:02:49Z", "updated_parsed": [2010, 6, 14, 7, 2, 49, 0, 165, 0], "published": "2010-02-17T04:10:29Z", "published_parsed": [2010, 2, 17, 4, 10, 29, 2, 48, 0], "title": "Quantum circuit for security proof of quantum key distribution without\n  encryption of error syndrome and noisy processing", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1002.4921%2C1002.4312%2C1002.2766%2C1002.0549%2C1002.1542%2C1002.4852%2C1002.2495%2C1002.3211%2C1002.3854%2C1002.2807%2C1002.4775%2C1002.2321%2C1002.4812%2C1002.5040%2C1002.3560%2C1002.2538%2C1002.2041%2C1002.2829%2C1002.4854%2C1002.1910%2C1002.2502%2C1002.1356%2C1002.3237%2C1002.2203%2C1002.2392%2C1002.0145%2C1002.0281%2C1002.1681%2C1002.2015%2C1002.1949%2C1002.1956%2C1002.2350%2C1002.2082%2C1002.4839%2C1002.3847%2C1002.3223%2C1002.2546%2C1002.3449%2C1002.2446%2C1002.3466%2C1002.2711%2C1002.0275%2C1002.2304%2C1002.0923%2C1002.4200%2C1002.3194%2C1002.0863%2C1002.3058%2C1002.4259%2C1002.3360%2C1002.4371%2C1002.0473%2C1002.2694%2C1002.3387%2C1002.2376%2C1002.2712%2C1002.3199%2C1002.4072%2C1002.2984%2C1002.0671%2C1002.1053%2C1002.1590%2C1002.4708%2C1002.0569%2C1002.1725%2C1002.4095%2C1002.2961%2C1002.0619%2C1002.4309%2C1002.2804%2C1002.2086%2C1002.0076%2C1002.4798%2C1002.4971%2C1002.3419%2C1002.3131%2C1002.1126%2C1002.2521%2C1002.4065%2C1002.3555%2C1002.0700%2C1002.3911%2C1002.0780%2C1002.0651%2C1002.2972%2C1002.1651%2C1002.3967%2C1002.1076%2C1002.4515%2C1002.4727%2C1002.4891%2C1002.4148%2C1002.0775%2C1002.4855%2C1002.0137%2C1002.0191%2C1002.1158%2C1002.0101%2C1002.1985%2C1002.3042%2C1002.1275&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Quantum circuit for security proof of quantum key distribution without\n  encryption of error syndrome and noisy processing"}, "summary": "One of the simplest security proofs of quantum key distribution is based on\nthe so-called complementarity scenario, which involves the complementarity\ncontrol of an actual protocol and a virtual protocol [M. Koashi, e-print\narXiv:0704.3661 (2007)]. The existing virtual protocol has a limitation in\nclassical postprocessing, i.e., the syndrome for the error-correction step has\nto be encrypted. In this paper, we remove this limitation by constructing a\nquantum circuit for the virtual protocol. Moreover, our circuit with a shield\nsystem gives an intuitive proof of why adding noise to the sifted key increases\nthe bit error rate threshold in the general case in which one of the parties\ndoes not possess a qubit. Thus, our circuit bridges the simple proof and the\nuse of wider classes of classical postprocessing.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1002.4921%2C1002.4312%2C1002.2766%2C1002.0549%2C1002.1542%2C1002.4852%2C1002.2495%2C1002.3211%2C1002.3854%2C1002.2807%2C1002.4775%2C1002.2321%2C1002.4812%2C1002.5040%2C1002.3560%2C1002.2538%2C1002.2041%2C1002.2829%2C1002.4854%2C1002.1910%2C1002.2502%2C1002.1356%2C1002.3237%2C1002.2203%2C1002.2392%2C1002.0145%2C1002.0281%2C1002.1681%2C1002.2015%2C1002.1949%2C1002.1956%2C1002.2350%2C1002.2082%2C1002.4839%2C1002.3847%2C1002.3223%2C1002.2546%2C1002.3449%2C1002.2446%2C1002.3466%2C1002.2711%2C1002.0275%2C1002.2304%2C1002.0923%2C1002.4200%2C1002.3194%2C1002.0863%2C1002.3058%2C1002.4259%2C1002.3360%2C1002.4371%2C1002.0473%2C1002.2694%2C1002.3387%2C1002.2376%2C1002.2712%2C1002.3199%2C1002.4072%2C1002.2984%2C1002.0671%2C1002.1053%2C1002.1590%2C1002.4708%2C1002.0569%2C1002.1725%2C1002.4095%2C1002.2961%2C1002.0619%2C1002.4309%2C1002.2804%2C1002.2086%2C1002.0076%2C1002.4798%2C1002.4971%2C1002.3419%2C1002.3131%2C1002.1126%2C1002.2521%2C1002.4065%2C1002.3555%2C1002.0700%2C1002.3911%2C1002.0780%2C1002.0651%2C1002.2972%2C1002.1651%2C1002.3967%2C1002.1076%2C1002.4515%2C1002.4727%2C1002.4891%2C1002.4148%2C1002.0775%2C1002.4855%2C1002.0137%2C1002.0191%2C1002.1158%2C1002.0101%2C1002.1985%2C1002.3042%2C1002.1275&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "One of the simplest security proofs of quantum key distribution is based on\nthe so-called complementarity scenario, which involves the complementarity\ncontrol of an actual protocol and a virtual protocol [M. Koashi, e-print\narXiv:0704.3661 (2007)]. The existing virtual protocol has a limitation in\nclassical postprocessing, i.e., the syndrome for the error-correction step has\nto be encrypted. In this paper, we remove this limitation by constructing a\nquantum circuit for the virtual protocol. Moreover, our circuit with a shield\nsystem gives an intuitive proof of why adding noise to the sifted key increases\nthe bit error rate threshold in the general case in which one of the parties\ndoes not possess a qubit. Thus, our circuit bridges the simple proof and the\nuse of wider classes of classical postprocessing."}, "authors": ["Kiyoshi Tamaki", "Go Kato"], "author_detail": {"name": "Go Kato"}, "author": "Go Kato", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevA.81.022316", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1002.3199v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1002.3199v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "8 pages, 2 figures. Typo corrected", "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1002.3199v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1002.3199v2", "journal_reference": "Phys. Rev. A 81, 022316 (2010)", "doi": "10.1103/PhysRevA.81.022316", "fulltext": "Quantum circuit for security proof of quantum key distribution without encryption of\nerror syndrome and noisy processing\n1\n\nKiyoshi Tamaki1,2\u2217 and Go Kato3\n\narXiv:1002.3199v2 [quant-ph] 14 Jun 2010\n\nNTT Basic Research Laboratories, NTT Corporation,\n3-1,Morinosato Wakamiya Atsugi-Shi, Kanagawa, 243-0198, Japan\n2\nCREST, JST Agency, 4-1-8 Honcho, Kawaguchi, Saitama, 332-0012, Japan\n3\nNTT Communication Science Laboratories, NTT Corporation\n3-1,Morinosato Wakamiya Atsugi-Shi, Kanagawa, 243-0198, Japan\nOne of the simplest security proofs of quantum key distribution is based on the so-called complementarity scenario, which involves the complementarity control of an actual protocol and a virtual\nprotocol [M. Koashi, e-print arXiv:0704.3661 (2007)]. The existing virtual protocol has a limitation\nin classical postprocessing, i.e., the syndrome for the error-correction step has to be encrypted. In\nthis paper, we remove this limitation by constructing a quantum circuit for the virtual protocol.\nMoreover, our circuit with a shield system gives an intuitive proof of why adding noise to the sifted\nkey increases the bit error rate threshold in the general case in which one of the parties does not\npossess a qubit. Thus, our circuit bridges the simple proof and the use of wider classes of classical\npostprocessing.\n\nI.\n\nINTRODUCTION\n\nQuantum key distribution (QKD) is one of the most\nattractive research areas in quantum information theory,\nwhich has practical applications, and it has been intensively investigated both experimentally and theoretically.\nSo far, many experiments of QKD have been reported\n(see, for instance, [1]), and some of them have demonstrated the actual distillation of the secret key [2]. Since\nvery hard work is needed for the actual implementation\nof QKD, it would be good from an experimental viewpoint if we could implement QKD with easier setups and\neasier classical postprocessing parts.\nFrom the theoretical point of view, it is very important\nand interesting to consider a security proof in a simple\nmanner. One of the simplest approaches is to consider\na complementarity control of an actual protocol and a\nvirtual protocol [3], which the sender (Alice) and the receiver (Bob) can choose to execute, but cannot execute\nsimultaneously. In the actual protocol, the goal is to\nagree on the bit values along the computational basis,\nsay the Z basis while, in the virtual protocol, Alice and\nBob collaborate to create an eigenstate of the X basis\n(the conjugate basis of Z) in Alice's side. With these\nprotocols, Koashi proved in [3] that the necessary and\nsufficient condition for the secure key distillation is to\nsuccessfully execute these complementary tasks.\nIn this security proof, the virtual protocol has to be\nconstructed in such a way that an adversary (Eve) cannot discriminate it from the actual one, and the existing\nvirtual protocol assumes the encryption of the syndrome\nfor the error-correction step [4]. Since the classical postprocessing is very important in QKD, it is interesting\nto consider how to apply the complementarity control to\n\n\u2217 Electronic\n\naddress: tamaki@will.brl.ntt.co.jp\n\nQKD without the encryption, and even with wider classes\nof classical postprocessing. An interesting type of postprocessing is the so-called noisy processing, which was\nfirst introduced by Renner, et. al [5]. In this processing,\nby intentionally adding noise to one of the partiesfsifted\nkey, the bit error rate threshold increases, and it is interesting to consider how to explain this processing from\nthe viewpoint of the complementarity control.\nIn this paper, we remove the encryption by explicitly\nconstructing a qubit-based quantum circuit for the virtual protocol, and we employ our circuit with a shield system to give an intuitive proof of why the noisy processing\nincreases the bit error rate threshold. Thus, our circuit\nbridges the simple security proof and the use of wider\nclasses of classical postprocessing. One of the features of\nour quantum circuit is that it can output the syndrome,\napply bit-flip operations, discard any unnecessary qubit,\nand output the secret key simultaneously. Thus, the virtual protocol with our quantum circuit can be equivalently converted to the actual protocol, and our circuit\ncan accommodate the use of one-way and bi-directional\nerror-reconciliation codes.\nOur approach to noisy processing assumes that only\none of the parties has a qubit. This is one of the advantages over the original proposal [5] or private state distillation approach [6], where both of the parties have to\npossess a qubit. We note that we can apply our quantum\ncircuit to the security proof of protocols, such as BB84\n[7], six-state protocol [8, 9], and other protocols where\nthe so-called phase error rate in the code qubits can be\ntightly estimated, i.e., Bob can guess Alice's fictitious Xbasis bit value with arbitrary small failure probability as\nthe size of the sifted key increases.\nThe organization of this paper is as follows. In Sec. II,\nwe briefly review the security proof based on the complementarity scenario [3, 10], and then we construct the\nquantum circuit for a virtual protocol in Koashi's proof\nin Sec. III. Next, we apply our quantum circuit to the\nfollowing cases: (i) Alice has a fictitious qubit in Sec.\n\n\f2\nIV A, (ii) both Alice and Bob have fictitious qubits in\nSec. IV B, and (iii) noisy processing in Sec. IV C. Finally, we summarize our paper.\n\nII.\n\nREVIEW OF COMPLEMENTARITY\nSCENARIO\n\nA way to prove the security of QKD is to consider\na virtual protocol that is equivalent to the actual protocol and easy to analyze. Here, by \"equivalent\", we\nmean that the resulting secret key is the same between\ntwo protocols and that all the information available to\nEve, including classical and quantum information, is the\nsame. The former requirement is the equivalence from\nthe users' view, and the latter is the one from Eve's view.\nThus, the security proved in the virtual protocol means\nthe security of the actual protocol. One approach along\nthis line is to consider a virtual protocol that is based\non the distillation of the Bell state [11\u201313] of the form\n|\u03c6+ i \u2261 \u221a12 (|0z i|0z i + |1z i|1z i), which we call a ShorPreskill type of proof. In this approach, the final key is\ngenerated via Z-basis (spanned by {|0z i, |1z i}) measurement, and the high fidelity of the distilled state relative\nto |\u03c6+ i guarantees the security since |\u03c6+ i is decoupled\nwith Eve's system.\nThis proof can be seen from a different aspect. Since\n|\u03c6+ i has no probability of having the bit (bit in\n\u221a Z-basis)\n2, |1x i \u2261\nand phase (bit\nin\nX-basis:\n{|0\ni\n\u2261\n(|0\ni+|1\ni)\nx\nz\nz\n\u221a\n(|0z i \u2212 |1z i) 2}) errors, one may conjecture that if Bob\ncan perfectly predict Alice's measurement outcome regardless of which basis was chosen (of course, these two\ntasks cannot be performed simultaneously), Alice and\nBob can share the secret key. This is an intuitive idea behind the complementarity control [10], and in [3] Koashi\nformally introduced complementarity control of the actual protocol and the virtual protocol for the security\nproof. In the actual protocol, Alice and Bob try to share\nthe same bit values in Z-basis, and Alice tries to generate a X-basis eigenstate with the help of Bob over the\nquantum channel in the virtual protocol. From the viewpoint of the Shor-Preskill type proof, the former (latter)\nprotocol is related with the fact that Bob can guess Alice's bit value in Z-basis (X-basis) if Alice and Bob share\n|\u03c6+ i. The actual protocol and virtual protocols are exclusive of each other, and in order to prove the security\nof the actual protocol, we require in the virtual protocol\nthat Alice's and Bob's operations must commute with the\nmeasurement of the final keys, which is called nondisturbing condition. Then, Koashi proved that the task of the\nsecret key distillation is equivalent to the complementarity control of the two protocols, and the security of the\nfinal key can be analyzed by the virtual protocol only.\nAs an explicit example of the virtual protocol, Koashi\nproposed the virtual protocol with the encryption of the\nsyndrome [4]. Since the encryption gives Eve no information, Alice and Bob can behave quite differently between\nthe actual and virtual protocols. More precisely, Alice\n\nand Bob can choose any code, including nonlinear codes,\nfor the error-correction in the actual protocol while they\ncan perform any non-disturbing operations for Alice to\nprepare the X-basis eigenstate in the virtual protocol.\nThis means that we do not need to consider the measurement of the syndrome in the virtual protocol, which\nmakes the security analysis easy but limits classical postprocessing parts.\n\nIII.\n\nOUR CIRCUIT FOR THE VIRTUAL\nPROTOCOL\n\nIn order to remove the assumption of the encryption,\nwe propose a quantum circuit that outputs both the syndrome for any linear codes and the required information\nfor the distillation of the X-basis eigenstate. Since our\ncircuit assumes a possession of qubits, it can be applied\nto any party who has a fictitious qubit state, such as Alice or a party with the squashing operator [14], with the\ndetector decoy [15], with a photon number resolving detector, and with other techniques to define a qubit [16].\nFor the explanation, we assume that Alice has the fictitious qubit, and through Alice's Z-basis measurement,\nthe sifted key is determined. Moreover, we concentrate\non the sifted key, and we consider only Alice's side in\norder to show that Alice's key is independent of Eve's\nsystem. The actual protocol runs as follow.\nActual protocol:\n(Step 1) Alice conducts measurements on her (n + s)\nqubits, and she is left with (n + s) bits of a sifted key.\n(A)\n(Step 2) Alice computes s-bit syndrome Sz for the\nerror-reconciliation protocol to be sent to Bob over a public channel without encryption. Then, depending on the\nerror-correction codes and the syndrome from Bob, Alice\ndiscards appropriate s bits and applies bit-flip operations\non the remaining n bits. At this point, Alice has an n-bit\n(A)\nreconciled key \u03barec .\n(Step 3) Over a public discussion, Alice and Bob agree\non randomly chosen independent (n \u2212 m) n-bit strings\n~\n~k }k=1,...,n\u2212m. Alice takes {\u03ba(A)\n{V\nrec * Vk }k=1,...,n\u2212m as the\n(A)\nfinal key \u03bafin .\nNote that Step 3 corresponds to the privacy amplifi(A)\ncation [20]. In order to prove the security of \u03bafin we\npropose the following virtual protocol (see also Fig. 1).\nVirtual protocol:\n(Step 1v) Alice prepares the first set of CNOT quantum\ncircuits (we call it CNOT(I)) and applies it to her initial\n(n + s) qubits.\n(Step 2v) Alice conducts Z-basis measurements on s\nqubits of the output ports of CNOT(I) to obtain the\n(A)\nsyndrome Sz [26] and sends it to Bob over a public\nchannel without the encryption. She discards the s measured qubits, and depending on the syndrome from Bob,\nAlice applies bit-flip operations on some qubits among\nthe remaining n qubits.\n(Step 3v) Alice prepares the second set of CNOT quan-\n\n\f3\n\nS zB\n(\n\nB\nZ\nZ\n\nfin\n\nS xA\n(\n\n)\n\nX\nX\n\nCNOT(I)\n\nZ\n\nBit Flip\n\nA)\n\nCNOT(II)\n\nPurification\n\nZ\n(\n\n)\n\nX\n\nS zA\n(\n\n)\n\nZ\nZ\nZ\n\nPublic channel\n\nFIG. 1: Schematics of our quantum circuit for the Virtual\nprotocol. \"bit-flip\" consists of the identity and the bit-flip\noperation \u03c3\u0302x , and \"Purification\" tries to purify the (n \u2212 m)\n(A)\nqubits by using \u03bcB and Sx .\n\ntum circuits (CNOT(II)), and she applies it to her n\nqubits. Next, Alice generates m-bit syndrome in X-basis\n(A)\nSx by measuring the m qubits of the output port of\nCNOT(II) along X-basis, and after receiving an information \u03bcB from Bob, Alice obtains (n \u2212 m) almost pure\nand direct product qubit states in X-basis. The final key\n(A)\n\u03bafin is obtained by performing Z-basis measurement on\nthe (n \u2212 m) qubits.\nNote that CNOT(II) is chosen randomly among the\nset of CNOT circuits with the following property: the\nmeasurement on particular m output ports in X-basis\n~\n~ i \u2208 Fn ) of\nis the same as measuring {X Ui }i=1,2,..m (U\n2\nthe n input ports and the measurement on the remaining n \u2212 m output ports in Z-basis corresponds to the\nprivacy amplification in (Step 3) of the Actual protocol,\n~\n~k \u2208 Fn2 ) on\ni.e., the measurement of {Z Vk }k=1,2,..n\u2212m (V\nx2\n~\nx\nx1\nthe n input ports. Here, Z \u2261 Z \u2297 Z \u2297 * * * \u2297 Z xn\nwith Z 0 = 11 and Z 1 = Z and similar for X. The first\nproperty of CNOT(II) corresponds to the random hashing along X-basis [11], and we note that if we make the\nhashing random, then the privacy amplification becomes\n~ i and V\n~i are\nautomatically random and vice versa since U\nalways orthogonal [27].\nIn (Step 3v) \u03bcB represents Bob's measurement outcome on his system, which is not necessarily the system\nof qubits. We assume that \u03bcB gives Bob the estimation of\nthe n bits of Alice's fictitious X-basis measurement outcome XA with some uncertainty. The uncertainty will be\nremoved by Alice's random hashing along X-basis so that\nshe can distill a direct product of X-basis eigenstates and\ngenerate the secret key. Here, note that \u03bcB is not used for\nthe later active quantum operation such as a phase-flip\noperation. One of the important points in the Virtual\n(A)\n(A)\nprotocol is that since Sz and Sx are generated via\nmeasurements on the different systems, these measurements commute. Similarly, the final measurement along\n(A)\nZ-basis and the measurement of Sx also commute, and\n\nthe measurement of the final key in the virtual protocol\nis the same as the one of the actual protocol thanks to\nthe property of CNOT(II). Hence, the newly introduced\n(A)\nmeasurement of Sx does not disturb any measurement\noutcomes in the Actual protocol, and the Virtual protocol\nis not equivalent to the Actual protocol from Eve's view\n(A)\nwith respect to \u03bcB and the measurement of Sx , which\ncan be removed without degrading the security as we will\nsee.\nFor the security proof of the Virtual protocol, we again\nnote that since CNOT(II) is chosen randomly and inde(A)\npendently, the measurement of Sx serves as a random\nhashing [11] along X-basis, hinting that if the number of\nthe rounds of the random hashing is properly chosen, Alice can generate an almost pure and direct product state\nin X-basis. Actually, this is the idea used in the security\nproof in [4], and its sketch of the proof is summarized\nas follows. The proof starts with putting the assumption that the uncertainty of XA from Bob's view after\nobtaining \u03bcB is, say n\u03be bits. More precisely, we make\nthe following assumption [4].\n(n)\nAssumption: There exists a set T\u03bcB of n-bit sequences\n(n)\nwith cardinality |T\u03bcB | \u2264 2n\u03be for each \u03bcB , such that the\npair of measurement outcomes (\u03bcB , XA ) satisfies XA \u2208\nT\u03bcB except for an exponentially small probability \u03b7.\nBy invoking the random hashing argument in [11] and\nby setting m as slightly larger than n\u03be, we can show\nthat htx |\u03c3\u0302|tx i \u2265 1 \u2212 \u03b7 \u2032 where \u03b7 \u2032 \u2261 \u03b7 + 2\u2212n\u01eb . Here, |tx i\nis the n-qubit X-basis state that Alice thinks to have\nsuccessfully distilled and \u03c3\u0302 is the actually distilled state.\nNote that the exponentially high fidelity guarantees that\n(A)\n\u03bafin is composably secure [18].\nNext, we convert the Virtual protocol to the Actual\n(A)\nprotocol, i.e., we remove \u03bcB and Sx from the Virtual\nprotocol while we keep the final key the same. The important point is that we do not use the measurement\n(A)\noutcome of Sx and \u03bcB for any of the following active\nquantum manipulations, such as bit-flip operations or\nother quantum evolutions. Moreover, the measurement\n(A)\n(A)\nof Sx commutes with the measurement of \u03bafin . Thus,\n(A)\neven if we skip the measurement of Sx and sending \u03bcB ,\nthe final key still remains exactly the same, which ends\nthe conversion, and only the fact that Alice could have\ngenerated the almost pure state is enough to prove the\nsecurity.\n\nIV.\n\nAPPLICATIONS OF OUR CIRCUIT\n\nSo far, we have seen that the security can be proven\nby making the Assumption. In what follows, we consider\nthree particular cases to see how to confirm Assumption.\n(i) The first case, discussed in Sec. IV A, is that only\nAlice has the fictitious qubits and the syndrome is sent\nfrom Alice to Bob or bi-directionally [19]. (ii) The second\ncase, in Sec. IV B, is that both of Alice and Bob have the\n\n\f4\nqubits, and a bi-directional code is used. (iii) Finally, in\nSec. IV C, we explain, by using our circuit with a shield\nsystem, why noisy processing increases the bit error rate\nthreshold. This noisy processing was first introduced by\nRenner, et. al [5] and later explained from the viewpoint\nof \u0393-state distillation [6].\nFor the discussion, we assume that thanks to the test\nbits, Alice and Bob know the rate ep of the \"phase errors\", i.e., Alice's bit value (X\u0303A ), which could have been\nobtained via the fictitious X-basis measurement on the\n(n + s) qubits (code bits) and Bob's prediction (\u03bc\u0303B ) on\nX\u0303A differ. More precisely [20], for \u01eb > 0\n\u2212(n+s)\u01eb\nP(|ep \u2212 e(t)\np | \u2265 \u01eb) \u2264 O(n + s)2\n\n2\n\n(1)\n\n(t)\n\nholds, where ep is the phase error rate of the test bits.\nThe important point for all the cases (i)-(iii) is that Alice can in principle write down the candidate for XA as\n(n+s)\n(n)\nT\n(t) , given \u03bc\u0303B\n(t) or the candidate for X\u0303A as T\n\u03bc\u0303B ,ep\n\n\u03bc\u0303B ,ep\n(t)\nand ep .\n\nAnother point is that CNOT quantum gates,\nif we are only interested in a particular basis, can be expressed just as a linear and one-to-one function on the\nbinary bit space. For the explanation, let FCN OT (I) as\nthe linear and one-to-one function on binary (n + s)-bit\nspace, which corresponds to CNOT(I) in X-basis.\nWe remark that when one of the parties, say Bob, has\nno fictitious qubit, but Alice has, and they use a bidirectional code, we assume that Bob can simultaneously\n(B)\noutput \u03bc\u0303B and the syndrome for the bit errors Sz .\nA.\n\nOnly Alice has the fictitious qubit\n\nThanks to the estimation and Bob's measurement, Al(n+s)\nice can write down the candidate for X\u0303A as T\n(t) =\n\nsecurity of Bob's key follows from the direct application\nof the complementarity scenario [3].\nB.\n\nBoth parties have the fictitious qubits\n\nWe assume that Bob has the same quantum circuit as\nAlice, and Bob measures the first n qubits of the output port of CNOT(I) in X-basis, whose outcome is n-bit\nstring \u03bcB . Like the case in (i), we can write down the\n(n+s)\n\u22121\n\u2032\ncandidate for X\u0303A as T\n(t) = {FCN OT (I) (\u03bcB + ak ) +\n\u03bcB ,ep\n\nri }\n\n(t)\n(n+s)h(ep +\u01eb)\ni=1,2,...,2\n,k=1,2,...,2s\n\n(n + s)-bit strings with the first n bits all being zero, and\n\u03bc\u2032B is (n+s)-bit string with the first n bits being the same\nas \u03bcB and all the last s bits being zero. Next, in order to\n(n)\ncalculate the required quantity T\n(t) , we apply Alice's\nFCN OT (I) to each member of T\n{\u03bcB + Trn [FCN OT (I) (ri )]}\n\n(t)\n(n+s)h(ep +\u01eb)\ni=1,2,...,2\n\n(1 \u2212 x) log(1 \u2212 x) and {ri }\n\n. Here, h(x) \u2261 \u2212x log x \u2212\n(t)\n(n+s)h(ep )\n\ni=1,2,...,2\n\nrepresents\n\na set of independent (n + s)-bit strings that con(t)\n(n+s)\ntain at most (n + s)(ep + \u01eb) 1s.\nFrom T\n(t) ,\nwe can calculate the candidate for XA as T\n{Trn [FCN OT (I) (\u03bc\u0303B +ri )]}\n\n(t)\n(n+s)h(ep +\u01eb)\n\ni=1,2,...,2\n\n\u03bc\u0303B ,ep\n(n)\n(t)\n\n\u03bc\u0303B ,ep\n\n=\n\n, where Trn\n\nmeans that we discard the last s-bit of each (n + s)bit string. Since FCN OT (I) is an one-to-one function,\n|T\n\n(t)\n\n(n)\n(t)\n\u03bc\u0303B ,ep\n\n| \u2264 2(n+s)h(ep\n\n+\u01eb)\n\nholds, following that (n +\n\n(t)\n\ns)(h(ep +\u01eb)+\u01eb\u2032 ) rounds of the random hashing is enough\nfor Alice to distill the X-basis eigenstate. Here, \u01eb\u2032 is a\nsmall positive number. We note that the key generation\nrate G in the limit of large n can be written as\nG = (n + s)[1 \u2212 h(e(t)\np )] \u2212 (s + d) ,\n\n(2)\n\nwhere, d is the number of bits that Alice discards when\nAlice and Bob use bi-directional codes [19]. Note that the\n\n\u03bcB ,ep\n(n+s)\n(t)\n\n\u03bcB ,ep\n\nto obtain T\n\n(t)\n(n+s)h(ep +\u01eb)\n\ni=1,2,...,2\n\u22121\n\u2032\nFCN OT (I) [FCN\nOT (I) (\u03bcB\n\n(n)\n(t)\n\n\u03bcB ,ep\n\n=\n\n[21], where\n\nwe have used\n+ ak )] = \u03bcB and\nthe linearity of FCN OT (I) . Since FCN OT (I) is an oneto-one function, |T\n\n(t)\n\n(n)\n(t)\n\n\u03bcB ,ep\n\n| \u2264 2(n+s)h(ep\n\n(t)\n(n + s)(h(ep\n\n+\u01eb)\n\nholds, again\n\n\u2032\n\nfollowing that\n+ \u01eb) + \u01eb ) rounds of the random hashing is enough for Alice to distill the X-basis\neigenstate. We note that the amount of the privacy am(t)\nplification is determined by ep , which means that the\nsecurity level of Alice's and Bob's keys are the same.\nNote that the key generation rate G in the limit of large\nn can be written as\nG = (n + s)[1 \u2212 h(e(t)\np )] \u2212 (s + d) .\nC.\n\n\u03bc\u0303B ,ep\n\n{\u03bc\u0303B + ri }\n\n, where ak is arbitrary 2s\n\n(3)\n\nNoisy processing\n\nIn noisy processing [5], Alice randomly adds bit errors to her sifted key with probability 0 \u2264 q \u2264 1 \u2227 q 6=\n1/2. This process can be alternatively realized first by\n\u2297(n+s)\nwhere |\u03c6q iS \u2261\npreparing\nshields in the state |\u03c6q iS\n\u221a\n\u221a\n1 \u2212 q|0z iS + q|1z iS , and then interacting each of them\nwith Alice's code qubits via CNOT gate with the shields\nbeing the control qubit with respect to Z-basis (see also\nFig. 2) [6]. The point is that the role of the target qubit\nand the control qubit in CNOT is exchanged according\nto what basis we are working on. Suppose that the state\nof Alice's code bit before the interaction\nis a classical\nP\nmixture of a pure state, say |\u03a8iC = x~ \u2208T (n+s) \u03b1~x |e~x iC\n\u03bc\u0303B ,ep\nP\n( ~x\u2208T (n+s) |\u03b1~x |2 = 1) where ~x = (x1 , x2 , * * * , x(n+s) )\n\u03bc\u0303B ,ep\n\nis a (n + s)-bit string and |e~x i is the X-basis eigen\u2297(n+s)\nstate. Then, the CNOT transforms |\u03c6q iS\n|\u03a8iC into\nP\n\u2297(n+s)\n~\nx\n)|e~x iC , meaning that the in(n+s) \u03b1~\nx (Z |\u03c6q iS\nx\n~ \u2208T\n\u03bc\u0303B ,ep\n\nformation of Alice's code qubit in X-basis is transferredthe to the shield, and the information is encoded\n\n\f5\n\nPGM\n\nPhase Flip\n\nq S\n\nS zB\n(\n\nB\nZ\n\nA)\n\nZ\n\nfin\n\nS xA\n(\n\n)\n\nX\nX\n\n)\n\nCNOT(I)\n\nZ\n\nBit Flip\n\n(\n\nCNOT(II)\n\nPurification\n\nZ\n\nns\n\n\u00c4( + )\n\nX\n\nS zA\n(\n\n)\n\nZ\nZ\n\nIID. Actually, as we will see later, it can be shown that\nthis intuition with a generalized analysis of PGM solves\nour problem.\n(t)\n(t)\nFirst, we define \u03c1\u0302 as (1 \u2212 ep )|\u03c6q ih\u03c6q | + ep Z|\u03c6q ih\u03c6q |Z,\n(t)\nwhere ep is the phase error rate of the test bit defined\nin Eq. (1) and assume that \u03c1\u0302 is diagonalized as\n\u03c1\u0302 = \u03bb0 |0\u0303ih0\u0303| + \u03bb1 |1\u0303ih1\u0303|.\n\n(4)\n\nWe also define \u00e3 as an (n + s)-bit string with respect\nto the {|0\u0303i, |1\u0303i} basis, and thanks to the Bernoulli trial\nargument, we have for \u03c9 > 0 and (n + s) > 0 [24],\n2\n\nP(||\u00e3| \u2212 (n + s)\u03bb1 | \u2265 (n + s)\u03c9) \u2264 21\u2212(n+s)\u03c9 ,\n\n(5)\n\nZ\nPublic channel\n\nFIG. 2: Schematics of the circuit for noisy processing. A difference from the circuit in Fig. 1 is the shield part whose\n\u2297(n+s)\ninitial state is |\u03c6q iS\n. Each code qubit is connected with\neach shield via the CNOT gate, and PGM represents the\npretty good measurement.\n\nin two nonorthogonal states |\u03c6q iS and Z|\u03c6q iS . Thus, by\nusing the information that can be extracted from measuring the shield, Alice can reduce the amount of hashing\nalong X-basis, which enhances the bit error rate threshold as well as increases the key generation rate.\nIn what follows, we assume that Alice first applies m\nrounds of the random hashing to narrow down the set\n(n+s)\nof candidates T\u03bc\u0303B ,ep to a smaller set \u03a9m , and then she\nperforms the fictitious measurement on the shield to identify the phase error pattern X\u0303A . Moreover, in order for\nZ|\u03c6q iS to represent the phase error between Alice and\nBob, we apply a phase-flip operation Z \u03bc\u0303B to the shield\nbefore measuring it. For simplicity of this discussion, we\nredefine \u03bc\u0303B + ~x as ~x, \u03bc\u0303B + X\u0303A as X\u0303A , and {\u03bc\u0303B + ~x}~x\u2208\u03a9m\n\u2297(n+s)\n.\nas \u03a9m . Furthermore, we define |~xi \u2261 Z ~x |\u03c6q iS\nWhat we have to construct is a positive operator valued\nmeasure (POVM) [20] which can identify all the members\n\u2297(n+s)\n}~x\u2208\u03a9m with exponentially small failure\nin {Z ~x |\u03c6q iS\nprobability in (n + s). For the construction, we employ the idea of the so-called Pretty Good Measurement\n(PGM) [20, 22]. Originally, PGM can discriminate all\nthe states in a subset of the set stemming from an Identically and Independently Distributed (IID) source, and\nwe cannot directly apply this idea to our case where all\nthe members in the whole set have to be identified and\n{~x} is not stemming from an IID source [23]. However,\n(n+s)\nobserve that T\u03bc\u0303B ,ep is obtained via the classical random\nsampling theorem or other estimation method, and this\nset is very similar to the one stemming from an IID source\nwith the phase error rate ep , i.e., in either case the most\nlikely bit strings are those containing (n+ s)ep 1's. Thus,\n(n+s)\nwe infer that if T\u03bc\u0303B ,ep is contained in the typical space of\nthe IID source, then we can remove the limitation of the\n\nwhere |\u00e3| represents the Hamming distance of \u00e3, and\nwe call the space spanned by a set of the {|0\u0303i, |1\u0303i}-basis\neigenstates with \u00e3 satisfying ||\u00e3|\u2212(n+s)\u03bb1 | \u2264 (n+s)\u03c9 as\n\u03c9-typical subspace. For later use, we define the projector onto this subspace as P\u0302\u03bb\u03c9 , and note that the random\nsampling theorem (Eq. (1)) states that\n2\n\n\u2212(n+s)\u01eb\nP(||~x| \u2212 (n + s)e(t)\n.(6)\np | \u2265 (n + s)\u01eb) \u2264 O(n + s)2\n\nNote that if we chose \u01eb and \u03c9 such that \u01eb \u2264 \u03c9 then the\nactual phase error pattern X\u0303A is included in \u03c9-typical\nsubspace with exponentially close probability to 1. As\nwe will explain the details in the Appendix, by averaging\nover the random hashing, POVM {M\u0302~x }\nM\u0302~x\n\uf8ee\n\uf8f9\u22121/2\n\uf8ee\n\uf8f9\u22121/2\nX\nX\n= \uf8f0\nP\u0302 (P\u0302\u03bb\u03c9 |~xi)\uf8fb\nP\u0302 (P\u0302\u03bb\u03c9 |~xi) \uf8f0\nP\u0302 (P\u0302\u03bb\u03c9 |~xi)\uf8fb\n,\n~\nx\u2208\u03a9m\n\n~\nx\u2208\u03a9m\n\n(7)\n\nwhere P\u0302 (|\u03c8i) \u2261 |\u03c8ih\u03c8|, we can identify any ~x \u2208 \u03a9m with\nprobability exponentially close to 1 in (n + s), i.e.,\n\u0010\n\u0011\nE\u03a9m h~x|M\u0302~x |~xi\n\u0012\n\u0012 (t)\n\u0013\u0013\n(t)\n\u03c9 2 +\u01eb log\n\n\u2212(n+s)\n\nep \u2212\u01eb\ne\n* p (t)\n(t)\n1\u2212ep +\u01eb 1\u2212ep\n\n\u2265 1 \u2212 6(n + s)2\n(t)\n+ 2\u2212(n+s)[\u2212h(ep )+S(\u03c1\u0302)+m/(n+s)\u2212\u01eb\u2212\u03c9] ,\n\n(8)\nwhere E\u03a9m represents the averaging over the random\nhashing, and S(\u03c1\u0302) \u2261 \u2212Tr(\u03c1\u0302 log2 \u03c1\u0302). By combining Eq. (8)\nwith the failure probability of the random sampling for\nthe phase error rate from Eq. (6), the overall failure probability pfail of the identification of the correct phase error\npattern can be upper-bounded by\n\u0010\n\u0011\n2\npfail \u2264 1 \u2212 E\u03a9m h~x|M\u0302~x |~xi + O(n + s)2\u2212(n+s)\u01eb\n\u0013\u0013\n\u0012\n\u0012 (t)\n(t)\n\u2212(n+s)\n\n\u03c9 2 +\u01eb log\n\ne\nep \u2212\u01eb\n* p (t)\n(t)\n1\u2212ep +\u01eb 1\u2212ep\n\n\u2264 6(n + s) * 2\n(t)\n+ 2\u2212(n+s)[\u2212h(ep )+S(\u03c1\u0302)+m/(n+s)\u2212\u01eb\u2212\u03c9]\n2\n\n+ O(n + s)2\u2212(n+s)\u01eb .\n\n(9)\n\n\f6\nThus, in order for the failure probability to be exponentially small in (n + s), we have to choose parameters such\nthat\nv\n!\nu\n(t)\n(t)\nu\n1\n\u2212\ne\n+\n\u01eb\n1\n\u2212\ne\np\np\n+\u03b4\n*\n\u03c9 = t\u01eb log\n(t)\n(t)\nep \u2212 \u01eb\nep\n\n(10)\n\nand\n\u0011\n\u0010\nm = (n + s) h(e(t)\np ) \u2212 S(\u03c1\u0302) + \u01eb + \u03c9 + \u03b4m ,\n\n(11)\n\nwhere \u03b4 and \u03b4m are small positive numbers. Eq. (10)\nmeans that \u03c9 has to be larger than \u01eb (assuming 0 < \u03c9 \u2264\n1), which confirms our inference. With the above choice\nof the parameter sets, the fidelity F of the final state \u03c3\u0302\nwith respect to the target X-basis eigenstate |tx i, i.e.,\nhtx |\u03c3\u0302|tx i is expressed as\nF = 1 \u2212 pfail\n\u2265 1 \u2212 (n + s)6 * 2\u2212(n+s)\u03b4 \u2212 2\u2212(n+s)\u03b4m\n2\n\n\u2212 O(n + s)2\u2212(n+s)\u03c9 ,\n\n(12)\n\nand the key generation rate G in the limit of large n is\nG = (n + s)[1 \u2212 (h(e(t)\np ) \u2212 S(\u03c1\u0302))] \u2212 (s + d) .\n\n(13)\n\nAs an example, we consider BB84 and we assume that\nthe phase error rate and unprocessed bit error rates are\nthe same and we use an ideal error correcting code. It\nfollows that G is asymptotically given by\n\nwhere H(X)(= s) represents the Shannon entropy for\nthe bit error pattern, H(Z|X) represents the conditional\nShannon entropy of the phase error pattern given the\nbit error pattern, and p(X) is the probability that there\nis the bit error (X = 0) or not (X = 1). Moreover,\n\u03c1\u0302i is the density matrix conditional on X = i, and it\n(t)\nis obtained by replacing ep in \u03c1\u0302 with the phase error\nrate probability conditional on the realization of X. By\nperforming the optimization again in terms of the bit\nerror rate threshold by varying q, we obtain the improved\nbit error rate threshold 14.1% when q \u2192 1/2. We note\nthat this rate matches the one given by [5, 6].\nV.\n\nSUMMARY\n\nIn summary, we have constructed a quantum circuit\nfor the virtual protocol in the complementarity control\nto remove the encryption of the syndrome. We applied\nour circuit to the cases (i) Alice has a fictitious qubit,\n(ii) both Alice and Bob have fictitious qubits, and (iii)\nnoisy processing. In noisy processing, our proof covers\nthe case where only one party has a qubit, which is a\ngeneralization of the original proposal.\nIn the analysis of noisy processing, we have to discriminate any state in a set with exponentially small failure\nprobability, and a bit string is encoded in the state and\nthe states are nonorthogonal each other. We have formally shown that PGM can solve this problem, which is\na generalization of the original PGM idea in which some\nstates in the set have to be discarded and the states are\nstemmed from an IID source.\n\nG \u221d 1 \u2212 [h(e(t)\np ) \u2212 S(\u03c1\u0302)]\n\n(t)\n\u2212 h(e(t)\np (1 \u2212 q) + q(1 \u2212 ep ))\n\n(14)\n\nVI.\n\nACKNOWLEDGEMENT\n\n(t)\n\nwith ep being the same as the bit error rate in the test\nbits. In this case, it can be seen that the bit error rate\nthreshold is 12.4% with q \u2192 1/2. This value matches\nthe rate provided by [5, 6]. Intuitively, when q is close to\n1/2, Alice has to discriminate almost orthogonal states,\nand a negligibly small amount of privacy amplification is\nneeded.\nMoreover, our analysis can be applied to six-state protocol [8]. In order to compare the bit error rate threshold\ngiven in [5, 6], we assume that Alice and Bob possess the\nfictitious qubits. In this case, we can employ the mutual\ninformation between the bit and phase errors to reduce\nthe amount of hashing along X-basis [25, 26]. Thus, the\nphase error rate on the code bit is dependent on whether\nthere is a bit error or not, and we can apply our idea to\nthe cases with and without the bit error separately. The\nresulting key generation rate G in the limit of large n and\ns is\n#)\n(\n\"\n1\nX\np(X = i)S(\u03c1\u0302i )\nG = (n + s) 1 \u2212 H(Z|X) \u2212\ni=0\n\n\u2212 [H(X) + d] ,\n\n(15)\n\nWe thank T. Tsurumaru, M. Koashi, and H.-K. Lo\nfor very enlightening discussions. This work was in part\nsupported by National Institute of Information and Communications Technology (NICT) in Japan.\nAppendix A\n\n\u0010\n\u0011\nIn this Appendix, we show that E\u03a9m h~x|M\u0302~x |~xi is\nexponentially close to 1 in (n + s) for any ~x \u2208 \u03a9m . In the\n(t)\nanalysis, we assumed that 0 \u2264 ep \u2264 1/2, and we used\nsome techniques from [20]. First, one can show that\nX\n(A1)\nM\u0302~x = 11{P\u0302 \u03c9 |~xi}~x\u2208\u03a9 \u2264 P\u0302\u03bb\u03c9 ,\n\u03bb\n\n~\nx\u2208\u03a9m\n\nwhere 11{P\u0302 \u03c9 |~xi}~x\u2208\u03a9\n\u03bb\n\nm\n\nm\n\nis the identity operator of the space\n\n{P\u0302\u03bb\u03c9 |~xi}~x\u2208\u03a9m .\n\nspanned by\nThis means that {M\u0302~x } and\nan additional positive operator that corresponds to the\nfailure discrimination of a state on \u03c9-typical subspace\nform a POVM on \u03c9-typical subspace.\n\n\f7\nNext, a direct calculation shows that\n\u0010\n\u0011\nE\u03a9m h~x|M\u0302~x |~xi\n\u0010\n\u0011\n= E\u03a9m h~x|(P\u0302\u03bb\u03c9 M\u0302~x P\u0302\u03bb\u03c9 )|~xi\n\uf8eb\uf8ee\n\uf8f92 \uf8f6\n\uf8eb\n\uf8f6\u22121/2\nX\n\uf8ec\uf8ef\n\uf8fa \uf8f7\n= E\u03a9m \uf8ed\uf8f0h~x|P\u0302\u03bb\u03c9 \uf8ed\nP\u03bb\u03c9 |~x\u2032 ih~x\u2032 |P\u03bb\u03c9 \uf8f8\nP\u0302\u03bb\u03c9 |~xi\uf8fb \uf8f8\n~\nx\u2032 \u2208\u03a9m\n\n(A2)\n\n\u0001\n\u03c9 \u22121/2\n\n\u03c9\nxih~x|P\u03bb\n(P\u0302\u03bb\u03c9 |~x\u2032 i)\nLet us regard (h~x|P\u0302\u03bb\u03c9 )\n~\nx\u2208\u03a9m P\u03bb |~\n\u2032\n1/2\nas the (x, x ) component of the matrix \u0393 , which is\na real value, and by using y 2 \u2265 2y \u2212 1 for real y and\n\u03931/2 \u2265 3\u0393/2 \u2212 \u03932 /2 [20], we have\n\nP\n\n(\u03931/2 |x,x )2 \u2265 2\u03931/2 |x,x \u2212 1\n\n\u2265 3\u0393|x,x \u2212 \u03932 |x,x \u2212 1 .\n\n(A3)\n\nMoreover, by using\nX\n\u0393|x,x\u2032 =\n(\u03931/2 )x,y (\u03931/2 )y,x\u2032 = h~x|P\u03bb\u03c9 |~x\u2032 i,\n\n(A4)\n\ny\n\nE\u03a9m\n\n\u0011\nh~x|M\u0302~x |~xi\n\n\uf8eb\n\n\u2265 3h~x|P\u03bb\u03c9 |~xi \u2212 E\u03a9m \uf8edh~x|P\u03bb\u03c9\nh~x|P\u03bb\u03c9 |~xi\n\nIn order to evaluate\nwhich is upper-bounded as\nh~x|(11 \u2212 P\u03bb\u03c9 )|~xi\n\n= ((n+s) C|~x| )\u22121\n\u2264\n\n(t) |~\nv|\n~\nv (ep ) (1\n\nP\n\nX\n\nX\n\n~\nx\u2032 \u2208\u03a9m\n\n|~x\u2032 ih~x\u2032 |P\u03bb\u03c9 |~xi\uf8f8 \u2212 1 .\n\n(t)\n\n(t)\n\n((n+s) C|~x| )(ep )|~x| (1 \u2212 ep )(n+s)\u2212|~x|\n\n,\n(A6)\n\nh~x|(11 \u2212 P\u03bb\u03c9 )|~xi\n\n\u0001\nTr \u03c1\u0302\u2297(n+s) (11 \u2212 P\u03bb\u03c9 )\n(t)\n\n((n+s) C|~x| )(ep )|~x| (1 \u2212 ep )(n+s)\u2212|~x|\n\n|~\nx|\n(t) (n+s)\u2212|~\nx|\n((n+s) C|~x| )(e(t)\np ) (1 \u2212 ep )\n(t)\n\n\u0010\n\u0011\n2\nTr \u03c1\u0302\u2297(n+s) (11 \u2212 P\u03bb\u03c9 ) \u2264 21\u2212(n+s)\u03c9 ,\n\n(A10)\n\n1\u2212(n+s)\n\n\u2265 1 \u2212 (n + s)2\n\n\u0012\n\n\u03c9 2 +\u01eb log\n\n\u0012\n\n(t)\n(t)\nep \u2212\u01eb\ne\n* p (t)\n(t)\n1\u2212ep +\u01eb 1\u2212ep\n\n\u0013\u0013\n\n.\n(A11)\n\nNext, we evaluate the second term of Eq. (A5)\nX\n\n~\nx\u2032 \u2208\u03a9m\n\n\uf8eb\n\n\uf8ec\n= E\u03a9m \uf8edh~x|P\u03bb\u03c9\n= h~x|P\u03bb\u03c9\n\n\uf8f6\n\n|~x\u2032 ih~x\u2032 |P\u03bb\u03c9 |~xi\uf8f8\n\nX\n\n(n+s)\n\ny\n~ \u2208T\u03bcB ,ep\n\nX\n\n(n+s)\ny\n~ \u2208T\u03bcB ,ep\n\n\uf8f6\n\n\uf8f7\n\u03b8\u03a9m (~y )|~y ih~y |P\u03bb\u03c9 |~xi\uf8f8\n\n2\u2212m |~y ih~y |P\u03bb\u03c9 |~xi\n2\n\n+ (1 \u2212 2\u2212m ) |h~x|P\u03bb\u03c9 |~yi|\nX\n2\u2212m |~y ih~y |P\u03bb\u03c9 |~xi + 1 ,\n\u2264 h~x|P\u03bb\u03c9\n(n+s)\n\ny\n~ \u2208T\u03bcB ,ep\n\n(A12)\n.\n(A7)\n\nNote that\n|~\nx|\n\n+ |~x| log2 e(t)\np\n\nOn the other hand, from Eq. (5), we have\n\nE\u03a9m \uf8edh~x|P\u03bb\u03c9\n\n\u2212 ep )(n+s)\u2212|~v | h~v |(11 \u2212 P\u03bb\u03c9 )|~v i\n\n(t)\n\n\u0013\n\n+ (n + s \u2212 |~x|) log2 (1 \u2212 e(t)\np )\n\u0014 \u0012\n\u0013\n\u0015\n|~x|\n(t)\n= (n + s) h\n\u2212 h(ep )\n(n + s)\n(t)\nh\ni\nep\n\u2212 (n + s)e(t)\n\u2212\n|~\nx\n|\nlog\np\n2\n(t)\n1 \u2212 ep\n#\n\"\n(t)\n\u0010\n\u0011\nep\n(t)\n\u2032\n\u2265 (n + s)\u01eb \u2212h ep \u2212 \u01eb + log\n(t)\n1 \u2212 ep\n!\n(t)\n(t)\nep \u2212 \u01eb\nep\n= (n + s)\u01eb log\n. (A9)\n*\n(t)\n(t)\n1 \u2212 ep + \u01eb 1 \u2212 ep\n\n\uf8eb\n\nwhere the last summation is taken with respect to all\n(n + s)-bit string ~v , and 11 is the identity matrix of the\nP (t)\nspace spanned by all |~v i. Since \u03c1\u0302\u2297(n+s) = ~v (ep )|~v | (1\u2212\n(t)\nep )(n+s)\u2212|~v| |~v ih~v | holds, we have\n\u2264\n\n|~x|\n(n + s)\n\n(A5)\n\nh~x|(11 \u2212 P\u03bb\u03c9 )|~xi,\n\n~ 11 \u2212 P \u03c9 )|\u03bei\n~\nh\u03be|(\n\u03bb\n\n(t)\n\n\u0012\n\nh~x|P\u03bb\u03c9 |~xi\n\n\uf8f6\n\nwe consider\n\n\u03be~ s.t |\u03be|=|~\nx|\n\n(n + s)h\n\nfollowing that h~x|P\u03bb\u03c9 |~xi is lower-bounded by\n\nwe have\n\n\u0010\n\nand its exponent is lower-bounded as\n\n(t)\n\n2(n+s)h( (n+s) )+|~x| log2 ep +(n+s\u2212|~x|) log2 (1\u2212ep\n\u2265\n(n + s)\n\n)\n\n,\n(A8)\n\nwhere \u03b8\u03a9m (~y ) = 1 if ~y \u2208 \u03a9m , otherwise \u03b8\u03a9m (~y ) = 0. In\nthe second equality, we used the fact that the bit string\n(n+s)\ncorresponding to the actual error pattern X\u0303A \u2208 T\u03bc\u0303B ,ep\nis always selected as \u03a9m , and the probability that ~y 6=\n(n+s)\nX\u0303A \u2227 ~y \u2208 T\u03bc\u0303B ,ep is chosen as \u03a9m is 2\u2212m . Observe that\n(t)\n\n2\u2212(n+s)(h(ep\n\n)+\u01eb)\n\nX\n\n(n+s)\ny\n~ \u2208T\u03bcB ,ep\n\n|~y ih~y | \u2264 \u03c1\u0302\u2297(n+s) ,\n\n(A13)\n\n\f8\nand\n\nCombining all together, we have the final expression as\nh~x|P\u03bb\u03c9 \u03c1\u0302\u2297(n+s) P\u03bb\u03c9 |~xi\n\n\u2264 h\u03c9typ |\u03c1\u0302\u2297(n+s) |\u03c9typ i\n\n\u2264 2\n\n\u2212(n+s)[S(\u03c1\u0302)\u2212\u03c9]\n\n,\n\n(A14)\n\nwhere |\u03c9typ i is a state on the \u03c9-typical subspace. Using\nthem, we have\n\uf8eb\n\uf8f6\nX\nE\u03a9m \uf8edh~x|P\u03bb\u03c9\n|~x\u2032 ih~x\u2032 |P\u03bb\u03c9 |~xi\uf8f8\n\n\u0010\n\u0011\nE\u03a9m h~x|M\u0302~x |~xi\n\u2212(n+s)\n\n\u0012\n\n\u03c9 2 +\u01eb log\n\n\u0012\n\n(t)\n(t)\ne\nep \u2212\u01eb\n* p (t)\n(t)\n1\u2212ep +\u01eb 1\u2212ep\n\n\u2265 1 \u2212 6(n + s)2\n(t)\n+ 2\u2212(n+s)[\u2212h(ep )+S(\u03c1\u0302)+m/(n+s)\u2212\u01eb\u2212\u03c9] .\n\n\u0013\u0013\n(A16)\n\n~\nx\u2032 \u2208\u03a9m\n\n\u2264 2\u2212(n+s)[\u2212h(ep\n\n(t)\n\n)+S(\u03c1\u0302)+m/(n+s)\u2212\u01eb\u2212\u03c9 ]\n\n+ 1 . (A15)\n\n[1] D. Rosenberg, J. W. Harrington, P. R. Rice, P. A.\nHiskett, C. G. Peterson, R. J. Hughes, A. E. Lita, S.\nW. Nam, J. E. Nordholt , Phys. Rev. Lett. 98 010503\n(2007): H. Takesue, S. W. Nam, Q. Zhang, R. H. Hadfield, T. Honjo, K. Tamaki, and Y. Yamamoto, Nature\nPhotonics 1, 343 (2007).\n[2] http://www.secoqc.net/; C. Elliott, A. Colvin, D. Pearson, O. Pikalo, J. Schlafer, and Henry Yeh, e-print\narXiv:quant-ph/0503058.\n[3] M. Koashi, e-print arXiv:0704.3661 (2007).\n[4] M. Koashi, New J. Phys. 11 No 4 (April 2009) 045018\n(12pp), e-print quant-ph/0505108 (2005).\n[5] R. Renner, N. Gisin, and B. Kraus, Phys. Rev. A 72,\n012332 (2005). B. Kraus, N. Gisin, and R. Renner, Phys.\nRev. Lett. 95, 080501 (2005).\n[6] J. M. Renes, and G. Smith. Phys. Rev. Lett. 98, 020502\n(2007).\n[7] C.H. Bennett and G. Brassard, Proceedings of IEEE International Conference on Computers, Systems and Signal Processing, 175 (1984).\n[8] D. Bruss, Phys. Rev. Lett. 81, 3018 (1998).\n[9] So far, it is known that we can exploit the mutual information between the bit and phase errors when both\nparties possess a qubit state, which may be generalized\nin the future to the case where only one party possesses\na qubit.\n[10] D. Mayers, Lecture Notes in Computer Science, 1109,\nSpringer\u2013Verlag, pp. 343\u2013357 (1996).\n[11] C. H. Bennett, D. P. DiVincenzo, J. A. Smolin, and W.\nK. Wootters, Phys. Rev. A 54, 3824 (1996).\n[12] H-K. Lo and H. F. Chau, Science 283, 2050 (1999).\n[13] P. W. Shor and J. Preskill, Phys. Rev. Lett. 85, 441\n(2000).\n[14] T. Tsurumaru, and K. Tamaki, Phys. Rev. A 78, 032302\n(2008): N. J. Beaudry, T. Moroder, N. L\u00fctkenhaus, Phys.\nRev. Lett. 101, 093601 (2008): M. Koashi, Y. Adachi, T.\nYamamoto, and N. Imoto, e-pring arXiv:0804.0891.\n[15] T. Moroder, M. Curty, and N. L\u00fctkenhaus, New J. Phys.\n11, 045008 (2009).\n[16] M. Koashi, Phys. Rev. Lett. 93, 120501 (2004)\n\n[17] In other words, CNOT(I) is designed in such a way that\nthe measurement on the s qubits is equivalent to obtain\n(A)\nSz .\n[18] R. Renner and R. K\u00f6nig, Proc. of TCC 2005, LNCS,\nSpringer, vol. 3378 (2005), quant-ph/0403133.\n[19] G. Brassard, and L. Salvail, Lecture Notes in Computer\nScience 765, 410 (1993).\n[20] M. A. Nielsen and I. L. Chuang, \"Quantum Computation and Quantum Information\", Cambridge University\nPress, (2000).\n[21] If\nAlice's\nand\nBob's\nCNOT(I)\nare\ndifferent,\nputting an\nadditional assumption that\n\u22121\nTrn FCNOT \u2212A(I) [FCNOT\n(\u03bc\u2032B + ak )] is indepen\u2212B(I)\ndent of k is enough for the conclusion to hold. Here,\nCNOT-A(I) (CNOT-B(I)) represents Alice's (Bob's)\nCNOT(I).\n[22] P. Hausladen, and W. K.Wootters, J. Mod. Opt. 41, 2385\n(1994).\n[23] In [6], the authors claim that the direct application of the\noriginal PGM idea combined with the argument of type\nis enough to prove the security against coherent attacks.\n[24] K. Tamaki, N. L\u00fctkenhaus, M. Koashi, J. Batuwantudawe, Phys. Rev. A 80 032302 (2009).\n[25] H-K. Lo, Quantum Information and Computation, Vol.\n1, No. 2,81 (2001).\n[26] In the six-state protocol, the diagonal elements of the\nmarginal density matrix \u03c3\u0302 for the code qubit pair possessed by Alice and Bob is represented by (1 \u2212 3\u03be, \u03be, \u03be, \u03be),\nHere, 0 \u2264 \u03be \u2264 1/3, and each entry represents the four\npossibilities: a) no error, b) bit-flip error, but no phaseflip error, c) phase-flip error, but no bit-flip error, and\nd) both bit and phase-flip errors. The fact that \u03c3\u0302 has\nthe above form implies that there is a nontrivial mutual\ninformation between the phase and bit error pattern, as\nexplained in [25].\n[27] As we will state in the next paragraph, the measure(A)\n(A)\ncommute. This means that\nand Sx\nments of Sz\n~i\n~\nU\n{X }i=1,2,..m commutes with {Z Vk }k=1,2,..n\u2212m , follow~\n~\ning that Ui * Vk = 0.\n\n\f"}