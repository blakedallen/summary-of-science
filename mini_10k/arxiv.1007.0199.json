{"id": "http://arxiv.org/abs/1007.0199v5", "guidislink": true, "updated": "2011-08-24T22:01:22Z", "updated_parsed": [2011, 8, 24, 22, 1, 22, 2, 236, 0], "published": "2010-07-01T15:45:58Z", "published_parsed": [2010, 7, 1, 15, 45, 58, 3, 182, 0], "title": "Optimal execution strategy in the presence of permanent price impact and\n  fixed transaction cost", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1007.1054%2C1007.0534%2C1007.0076%2C1007.1326%2C1007.0470%2C1007.0513%2C1007.3867%2C1007.2915%2C1007.3753%2C1007.3751%2C1007.0825%2C1007.1186%2C1007.0199%2C1007.4635%2C1007.2577%2C1007.5016%2C1007.1962%2C1007.2054%2C1007.2241%2C1007.3408%2C1007.0341%2C1007.1021%2C1007.2229%2C1007.5289%2C1007.4383%2C1007.4005%2C1007.4307%2C1007.4400%2C1007.1610%2C1007.1158%2C1007.4609%2C1007.1031%2C1007.1647%2C1007.5142%2C1007.1873%2C1007.2201%2C1007.5049%2C1007.3637%2C1007.3992%2C1007.1135%2C1007.0571%2C1007.2499%2C1007.2021%2C1007.2913%2C1007.3012%2C1007.3253%2C1007.2826%2C1007.3150%2C1007.1398%2C1007.2615%2C1007.1177%2C1007.3115%2C1007.1495%2C1007.0444%2C1007.2120%2C1007.1726%2C1007.0578%2C1007.3645%2C1007.4843%2C1007.1625%2C1007.3144%2C1007.0017%2C1007.1089%2C1007.1741%2C1007.2406%2C1007.0219%2C1007.5165%2C1007.4680%2C1007.1289%2C1007.0654%2C1007.1470%2C1007.1713%2C1007.2429%2C1007.0322%2C1007.0504%2C1007.5466%2C1007.2498%2C1007.1758%2C1007.1433%2C1007.1447%2C1007.3433%2C1007.3647%2C1007.2792%2C1007.3299%2C1007.1646%2C1007.4569%2C1007.4218%2C1007.2414%2C1007.5024%2C1007.5148%2C1007.0551%2C1007.3555%2C1007.0084%2C1007.1864%2C1007.0863%2C1007.5068%2C1007.1167%2C1007.1511%2C1007.0843%2C1007.2828%2C1007.4778&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Optimal execution strategy in the presence of permanent price impact and\n  fixed transaction cost"}, "summary": "We study a single risky financial asset model subject to price impact and\ntransaction cost over an infinite horizon. An investor needs to execute a long\nposition in the asset affecting the price of the asset and possibly incurring\nin fixed transaction cost. The objective is to maximize the discounted revenue\nobtained by this transaction. This problem is formulated first as an impulse\ncontrol problem and we characterize the value function using the viscosity\nsolutions framework. We also analyze the case where there is no transaction\ncost and how this formulation relates with a singular control problem. A\nviscosity solution characterization is provided in this case as well. We also\nestablish a connection between both formulations with zero fixed transaction\ncost. Numerical examples with different types of price impact conclude the\ndiscussion.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1007.1054%2C1007.0534%2C1007.0076%2C1007.1326%2C1007.0470%2C1007.0513%2C1007.3867%2C1007.2915%2C1007.3753%2C1007.3751%2C1007.0825%2C1007.1186%2C1007.0199%2C1007.4635%2C1007.2577%2C1007.5016%2C1007.1962%2C1007.2054%2C1007.2241%2C1007.3408%2C1007.0341%2C1007.1021%2C1007.2229%2C1007.5289%2C1007.4383%2C1007.4005%2C1007.4307%2C1007.4400%2C1007.1610%2C1007.1158%2C1007.4609%2C1007.1031%2C1007.1647%2C1007.5142%2C1007.1873%2C1007.2201%2C1007.5049%2C1007.3637%2C1007.3992%2C1007.1135%2C1007.0571%2C1007.2499%2C1007.2021%2C1007.2913%2C1007.3012%2C1007.3253%2C1007.2826%2C1007.3150%2C1007.1398%2C1007.2615%2C1007.1177%2C1007.3115%2C1007.1495%2C1007.0444%2C1007.2120%2C1007.1726%2C1007.0578%2C1007.3645%2C1007.4843%2C1007.1625%2C1007.3144%2C1007.0017%2C1007.1089%2C1007.1741%2C1007.2406%2C1007.0219%2C1007.5165%2C1007.4680%2C1007.1289%2C1007.0654%2C1007.1470%2C1007.1713%2C1007.2429%2C1007.0322%2C1007.0504%2C1007.5466%2C1007.2498%2C1007.1758%2C1007.1433%2C1007.1447%2C1007.3433%2C1007.3647%2C1007.2792%2C1007.3299%2C1007.1646%2C1007.4569%2C1007.4218%2C1007.2414%2C1007.5024%2C1007.5148%2C1007.0551%2C1007.3555%2C1007.0084%2C1007.1864%2C1007.0863%2C1007.5068%2C1007.1167%2C1007.1511%2C1007.0843%2C1007.2828%2C1007.4778&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We study a single risky financial asset model subject to price impact and\ntransaction cost over an infinite horizon. An investor needs to execute a long\nposition in the asset affecting the price of the asset and possibly incurring\nin fixed transaction cost. The objective is to maximize the discounted revenue\nobtained by this transaction. This problem is formulated first as an impulse\ncontrol problem and we characterize the value function using the viscosity\nsolutions framework. We also analyze the case where there is no transaction\ncost and how this formulation relates with a singular control problem. A\nviscosity solution characterization is provided in this case as well. We also\nestablish a connection between both formulations with zero fixed transaction\ncost. Numerical examples with different types of price impact conclude the\ndiscussion."}, "authors": ["Mauricio Junca"], "author_detail": {"name": "Mauricio Junca"}, "author": "Mauricio Junca", "links": [{"href": "http://arxiv.org/abs/1007.0199v5", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1007.0199v5", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-fin.TR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-fin.TR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.SY", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "91G80, 93E20, 49L25", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1007.0199v5", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1007.0199v5", "arxiv_comment": null, "journal_reference": "Optim. Control Appl. and Meth. 33 (6):713-738.(2012)", "doi": null, "fulltext": "arXiv:1007.0199v5 [q-fin.TR] 24 Aug 2011\n\noptimal execution strategy in the\npresence of permanent price impact\nand fixed transaction cost\nMauricio Junca\u2217\nOctober 31, 2018\n\nAbstract\nWe study a single risky financial asset model subject to price impact\nand transaction cost over an infinite horizon. An investor needs to execute\na long position in the asset affecting the price of the asset and possibly\nincurring in fixed transaction cost. The objective is to maximize the discounted revenue obtained by this transaction. This problem is formulated\nfirst as an impulse control problem and we characterize the value function\nusing the viscosity solutions framework. We also analyze the case where\nthere is no transaction cost and how this formulation relates with a singular control problem. A viscosity solution characterization is provided in\nthis case as well. We also establish a connection between both formulations with zero fixed transaction cost. Numerical examples with different\ntypes of price impact conclude the discussion.\nKeywords: Price impact, impulse control, singular control, dynamic programming, viscosity solutions\n\n1\n\nIntroduction\n\nAn important problem for stock traders is to unwind large block orders of shares.\nMarket microstructure literature has shown (e.g. [Chan and Lakonishok, 1995,\nHolthausen et al., 1990]), both theoretically and empirically, that large trades\nmove the price of risky securities either for informational or liquidity reasons.\nSeveral papers addressed this issue and formulated a hedging and arbitrage\npricing theory for large investors under competitive markets. For example, in\n[Cvitani\u0107 and Ma, 1996] a forward-backward SDE is defined, with the price\nprocess being the forward component and the wealth process of the investor's\nportfolio being the backward component. In both cases, the drift and volatility\n\u2217 Department of Industrial Engineering and Operations Research, University of California,\nBerkeley CA 94720-1777. Email address: mjunca@berkeley.edu\n\n1\n\n\f2\n\nM. JUNCA\n\ncoefficients depend upon the price of the stocks, the wealth of the portfolio and\nthe portfolio itself. [Frey, 1998] describes the discounted stock price using a\nreaction function that depends on the position of the large trader. In [Bank\nand Baum, 2004, \u00c7etin et al., 2004] the authors, independently, described the\nprice impact by assuming a given family of continuous semi-martingales indexed\nby the number of shares held ([Bank and Baum, 2004]) and by the number of\nshares traded ([\u00c7etin et al., 2004]).\nThe optimal execution problem has been studied in [Bertsimas and Lo, 1998,\nAlmgren and Chriss, 2000] in a discrete-time framework. In both cases the\ndynamics of the price processes are arithmetic random walks affected by the\ntrading strategy. In [Bertsimas and Lo, 1998] the impact is proportional to\nthe amount of shares traded. In [Almgren and Chriss, 2000] the change in\nthe price is twofold, a temporary impact caused by temporary imbalances in\nsupply/demand dynamics and a permanent impact in the equilibrium or unperturbed price process due to the trading itself. Also, this work takes into\naccount the variance of the strategy with a mean-variance optimization procedure. Later on, nonlinear price impact functions were introduced in [Almgren,\n2003]. These ideas were adopted by more recent works under a continuous time\nframework. [Schied et al., 2010] propose the problem within a regular control\nsetting. The authors consider expected-utility maximization for CARA utility\nfunctions, that is, for exponential utility functions. The dynamics of the price\nand the market impact function are fairly general. [Schied and Sch\u00f6neborn,\n2009] is the only reference that considers an infinite horizon model based on the\noriginal model in [Almgren and Chriss, 2000]. Finally, [He and Mamaysky, 2005]\nconsider only permanent price impact but they allow continuous and discrete\ntrading (singular control setting) with a geometric Brownian motion as price\nprocess.\nOn the other hand, it is also well established that transaction costs in asset\nmarkets are an important factor in determining the trading behavior of market participants. Typically, two types of transaction costs are considered in\nthe context of optimal consumption and portfolio optimization: proportional\ntransaction costs ([Davis and Norman, 1990, \u00d8ksendal and Sulem, 2002]) using singular type controls and fixed transaction costs ([Korn, 1998, \u00d8ksendal\nand Sulem, 2002]) using impulse type controls. The market impact effect can\nbe significantly reduced by splitting the order into smaller orders but this will\nincrease the transaction cost effect. Thus, the question is to find optimal times\nand allocations for each individual placement such that the expected revenue after trading is maximized. [Ly Vath et al., 2007] include both permanent market\nprice impact and fixed transaction cost and assume that the unperturbed price\nprocess is a geometric Brownian motion process. This reference only accepts\ndiscrete trading (impulse control setting) and uses the theory of (discontinuous)\nviscosity solutions to characterize the value function. Finally, [Subramanian\nand Jarrow, 2001] propose a slightly different model which does not include\nany fixed transaction cost but includes an execution lag associated with size of\nthe discrete trades. It is important to remark that all papers referenced above\nassume a terminal date at which the investor must liquidate her position.\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n3\n\nIn this paper we study an infinite horizon price impact model that includes\nfixed transaction cost under the setting of impulse control, similar to [Ly Vath\net al., 2007]. We describe a general underlying price process and a general permanent market impact. With help of some classic results for optimal stopping\nproblems and the discontinuous viscosity solutions theory for nonlinear partial\ndifferential equations, developed in references such as [Crandall et al., 1992, Ishii\nand Lions, 1990, Ishii, 1993, Fleming and Soner, 2006], we obtain a fully characterization of the value function when the price process satisfies some technical\ncondition. Most of the processes used in financial studies satisfy this condition.\nThis characterization is not complete when the fixed transaction cost is zero.\nBy analyzing the HJB equation obtained in the previous case, we formulate a\nsingular control model to include this case. For this new formulation we are\nable to complete the characterization. We are able to show that both formulations agree in the value function even though the formulations are completely\ndifferent, when we choose the appropriate market impact functions. Finally, we\ndescribe the value function and the optimal strategy explicitly for an important\nspecial case.\nThe structure of the paper is as follows: The general impulse control model,\ngrowth condition and boundary properties of the value function which are useful\nfor the characterization of the function are exposed in Section 2. This section\ncharacterizes the value function of the problem as a viscosity solution of the\nHamilton-Jacobi-Bellman equation and shows uniqueness when the fixed transaction cost is strictly positive and the price process satisfies certain conditions.\nSection 3 proposes a singular control model to tackle the case when the transaction cost is zero. Here a viscosity solution characterization and uniqueness\nresult are proved as well under the same conditions. We present a special case\nwhere the value function of the impulse control model coincides with the value\nfunction of the singular control model and obtain the value function explicitly\nfor this case. Section 4 shows that, in fact, these two formulation produce the\nsame value function even though they consider different types of control. Section 5 presents numerical results for different underlying price processes with\nboth formulations. Finally, we state some conclusions and future work.\n\n2\n\nImpulse control model\n\nLet (\u03a9, F, (Ft )0\u2264t\u2264\u221e , P) be a probability space which satisfies the usual conditions and Bt be a one-dimensional Brownian motion adapted to the filtration.\nWe consider a continuous time process adapted to the filtration denoting the\nprice of a risky asset Pt . The unperturbed price dynamics, when the investor\nmakes no action, are given by:\ndPs = \u03bc(Ps )ds + \u03c3(Ps )dBs ,\n\n(2.1)\n\nwhere \u03bc and \u03c3 satisfy regular conditions such that there is a unique strong\nsolution of this SDE (i.e. Lipschitz continuity). We are mainly interested in\n\n\f4\n\nM. JUNCA\n\nprice processes that are always non-negative, thus we assume that P is absorbed\nas soon as it reaches 0 and that the initial price p is non-negative.\nNow, the number of shares in the asset held by the investor at time t is\ndenoted by Xt and it is up to the investor to decide how to unwind the shares.\nDifferent models and formulations will define the admissible strategies for the\ninvestor. At the beginning the investor has x \u2265 0 number of shares and we only\nallow strategies such that Xt \u2265 0 for all t \u2265 0. Since the investor's interest\nis to execute the position, we don't allow to buy shares, that is Xt is a nonincreasing process. Hence, we can see that R+ \u00d7 R+ = \u014c (with interior O)\nis the state space of the problem. The goal of the investor is to maximize the\nexpected discounted profit obtained by selling the shares. Given y = (x, p) \u2208 \u014c\nwe define V (y), the value function, as such maximum (or supremum), taken\nover all admissible trading strategies such that (X0\u2212 , P0\u2212 ) = Y0\u2212 = y. We call\n\u03b2 > 0 the discount factor and k \u2265 0 the transaction cost. Note that we can\nalways do nothing, in which case the expected revenue is 0. Therefore V \u2265 0\nfor all y.\nIn this formulation we assume that the investor can only trade discretely over\nthe time horizon. This is modeled with the impulse control \u03bd = (\u03c4n , \u03b6n )1\u2264n\u2264M ,\nwhere the random variable M < \u221e is the number of trades, (\u03c4n ) are stopping\ntimes with respect to the filtration (Ft ) such that 0 \u2264 \u03c41 \u2264 * * * \u2264 \u03c4n \u2264 * * * \u2264\n\u03c4M \u2264 \u221e that represent the times of the investor's trades, and (\u03b6n ) are realvalued F\u03c4n -measurable random variables that represent the number of shares\nsold at the intervention times. Note that any control policy \u03bd fully determines\nM . Given any strategy \u03bd, the dynamics of X are given by\nXs = X\u03c4n , for \u03c4n \u2264 s < \u03c4n+1 ,\nX\u03c4n+1 = X\u03c4n \u2212 \u03b6n+1 .\n\n(2.2)\n(2.3)\n\nWe consider price impact functions such that the price goes down when the\ninvestor sells shares. Also, the greater the volume of the trade, the grater the\nimpact in the price process. Thus, we let \u03b1(\u03b6, p) be the post-trade price when\nthe investor trades \u03b6 shares of the asset at a pre-trade price of p. We assume that\n\u03b1 is smooth, non-increasing in \u03b6, and non-decreasing in p such that \u03b1(0, p) = p\nfor all p. These conditions imply that \u03b1(\u03b6, p) \u2264 p for \u03b6 \u2265 0. Furthermore, we\nwill also assume that for all \u03b61 , \u03b62 , p \u2208 R+\n\u03b1(\u03b61 , \u03b1(\u03b62 , p)) = \u03b1(\u03b61 + \u03b62 , p).\n\n(2.4)\n\nThis assumption says that the impact in the price of trading twice at the same\nmoment in time is the same as trading the total number of shares once. This\nassumption will prevent any price manipulation from the investor. Two possible\nchoices for \u03b1 are:\n\u03b11 (\u03b6, p) = p \u2212 \u03bb\u03b6\n\u03b12 (\u03b6, p) = pe\u2212\u03bb\u03b6\nwhere \u03bb > 0. A linear impact like \u03b11 has the drawback that the post-trade price\ncan be negative. Given a price impact \u03b1 and an admissible strategy \u03bd, the price\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n5\n\ndynamics are given by:\ndPs = \u03bc(Ps )ds + \u03c3(Ps )dBs , for \u03c4n \u2264 s < \u03c4n+1 ,\n\n(2.5)\n\nP\u03c4n = \u03b1(\u03b6n , P\u03c4n\u2212 ).\n\n(2.6)\n\nWhen \u03c4n = \u03c4n+1 , then we apply the impact twice, therefore\nP\u03c4n = P\u03c4n+1 = \u03b1(\u03b6n+1 , \u03b1(\u03b6n , P\u03c4n\u2212 )).\nIf more that two actions are taken at the same time, we apply the impact\naccordingly. Now, given y = (x, p) \u2208 \u014c the value function V has the form:\n\"M\n#\nX\n\u2212\u03b2\u03c4n\nV (y) = sup E\ne\n(\u03b6n P\u03c4n \u2212 k) .\n(2.7)\n\u03bd\n\nn=1\n\nAs usual, we assume that e\u2212\u03b2\u03c4 = 0 on {\u03c4 = \u221e}.\n\n2.1\n\nHamilton-Jacobi-Bellman equation\n\nIn order to characterize the value function we will use the dynamic programming\napproach. This principle has been proved for several frameworks and types of\ncontrol. Some of the references that prove it in a fairly general context are\n[Ishikawa, 2004, Ma and Yong, 1999]. We have that the following Dynamic\nProgramming Principle (DPP) holds: For all y = (x, p) \u2208 O we have\n\uf8ee\n\uf8f9\nX\nV (y) = sup E \uf8f0\ne\u2212\u03b2\u03c4n (\u03b6n P\u03c4n \u2212 k) + e\u2212\u03b2\u03c4 V (Y\u03c4 )\uf8fb ,\n(2.8)\n\u03bd\n\n\u03c4n \u2264\u03c4\n\nwhere \u03c4 is any stopping time. Let's define the impulse transaction function as\n\u0393(y, \u03b6) = (x \u2212 \u03b6, \u03b1(\u03b6, p))\nfor all y \u2208 \u014c and \u03b6 \u2208 R. This corresponds to the change in the state variables\nwhen a trade of \u03b6 shares has taken place. We define the intervention operator\nas\nM\u03c6(y) = sup \u03c6(\u0393(y, \u03b6)) + \u03b6\u03b1(\u03b6, p) \u2212 k,\n0\u2264\u03b6\u2264x\n\nfor any measurable function \u03c6. Also, let's define the infinitesimal generator\noperator associated with the price process when no trading is done, that is\nA\u03c6 = \u03bc(p)\n\n\u22022\u03c6\n\u2202\u03c6 1\n+ \u03c3(p)2 2 ,\n\u2202p\n2\n\u2202p\n\nfor any function \u03c6 \u2208 C 2 (O). The HJB equation that follows from the DPP is\nthen ([\u00d8ksendal and Sulem, 2005])\nmin {\u03b2\u03c6 \u2212 A\u03c6, \u03c6 \u2212 M\u03c6} = 0 in O.\n\n(2.9)\n\n\f6\n\nM. JUNCA\n\nWe call the continuation region to\nC = {y \u2208 O : M\u03c6 \u2212 \u03c6 < 0}\nand the trade region to\nT = {y \u2208 O : M\u03c6 \u2212 \u03c6 = 0}.\n\n2.2\n\nGrowth Condition\n\nWe will define a particular optimal stopping problem and use some of the results in [Dayanik and Karatzas, 2003] to establish an upper bound on the value\nfunction V and therefore a growth condition. Consider the case where there is\nno price impact, that is, \u03b1(\u03b6, p) = p for all \u03b6 \u2265 0. We define\n\"M\n#\nX\n\u2212\u03b2\u03c4n\nVN I (y) = sup E\ne\n(\u03b6n P\u03c4n \u2212 k) ,\n(2.10)\n\u03bd\n\nn=1\n\nwhere Ps follows the unperturbed price process. It is clear that V \u2264 VN I . When\nthere is no price impact, the investor would need to trade only one time.\nProposition 2.1. For all y \u2208 O\nVN I (x, p) = U (x, p) := sup E[e\u2212\u03b2\u03c4 (xP\u03c4 \u2212 k)+ ]\n\n(2.11)\n\n\u03c4\n\nwhere the supremum is taken over all stopping times with respect to the filtration\n(Fs ).\nProof. Since (\u03c4, x) is an admissible strategy for any stopping time \u03c4 , then U \u2264\nVN I . Now, let \u03a5n the set of admissible strategies with at most n interventions.\nThe proof will continue by induction in n to show that for all n\n\" n\n#\nX\n\u2212\u03b2\u03c4i\nsup E\ne\n(\u03b6i P\u03c4i \u2212 k) \u2264 U (y).\n(2.12)\n\u03bd\u2208\u03a5n\n\ni=1\n\nClearly (2.12) is true for n = 1. Let \u03bd \u2208 \u03a5n . Note that xp \u2212 k \u2264 U (x, p),\ntherefore, conditioning on F\u03c41 we have\n\" n\n#\nX\n\u0002 \u0002\n\u0003\u0003\n\u2212\u03b2\u03c4i\nE\ne\n(\u03b6i P\u03c4i \u2212 k) =E E [e\u2212\u03b2\u03c41 (\u03b61 P\u03c41 \u2212 k) F\u03c41 +\ni=1\n\n\" \"\nE E e\n\n\u2212\u03b2\u03c41\n\nn\nX\n\n##\ne\n\n\u2212\u03b2(\u03c4i \u2212\u03c41 )\n\n(\u03b6i P\u03c4i \u2212 k) F\u03c41\n\ni=2\n\n\u0002 \u0002\n\u0003\u0003\n\u2264E E e\u2212\u03b2\u03c41 U (\u03b61 , P\u03c41 ) F\u03c41 +\n\u0002 \u0002\n\u0003\u0003\nE E e\u2212\u03b2\u03c41 U (x \u2212 \u03b61 , P\u03c41 ) F\u03c41\n\u0002\n\u0003\n\u2264E e\u2212\u03b2\u03c41 U (x, P\u03c41 )\n\u2264U (x, p),\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n7\n\nwhere the last inequality follows from the fact that the process e\u2212\u03b2s U (x, Ps )\nis a supermartingale ([\u00d8ksendal and Reikvam, 1998]). This proves (2.12). By\nLemma 7.1 in [\u00d8ksendal and Sulem, 2005], the left hand side of (2.12) converges\nto VN I as n \u2192 \u221e and the proof is complete.\nFrom the previous result we have the bound\n0 \u2264 V (x, p) \u2264 U (x, p) = sup E[e\u2212\u03b2\u03c4 (xP\u03c4 \u2212 k)],\n\n(2.13)\n\n\u03c4\n\nwhere the supremum is taken over all stopping times with respect to the filtration (Ft ). Following section 5 in [Dayanik and Karatzas, 2003], let \u03c8 and \u03c6 be\nthe unique, up to multiplication by a positive constant, strictly increasing and\nstrictly decreasing (respectively) solutions of the ordinary differential equation\nAu = \u03b2u and such that 0 \u2264 \u03c8(0+) and \u03c8(p) \u2192 \u221e as p \u2192 \u221e. For any x \u2265 0,\nlet\n(xp \u2212 k)+\n.\n(2.14)\n`x = lim\np\u2192\u221e\n\u03c8(p)\nThen U is finite in O if and only if `x is finite for all x \u2265 0. Furthermore, when\nU is finite we also have that for some C > 0\nU (x, p) \u2264 Cx\u03c8(p)\n\n(2.15)\n\nU (x, p)\n= `x .\n\u03c8(p)\n\n(2.16)\n\nand\nlim\n\np\u2192\u221e\n\nWe will assume that U is finite.\n\n2.3\n\nBoundary Condition\n\nSince the investor is not allowed to purchase shares of the asset we have that\nV (0, p) = 0 for all p \u2265 0. Also, the price process gets absorbed at 0, therefore V = 0 on \u2202O. If we assume that U is finite then by (2.15) we have that\nV (x, p) \u2192 0 as x \u2192 0 for all p \u2265 0, that is, V is continuous on {x = 0}. Now\nwe distinguish two cases:\n1. 0 is an absorbing boundary for the price process P . This means that for\nany p > 0, P(Pt = 0 for some t > 0|P0 = p) > 0. A simple example is the\narithmetic Brownian motion. Since the process is stopped at 0, we must\nhave that for all x \u2265 0\nU (x, 0) = 0.\nAlso, [Dayanik and Karatzas, 2003] shows that in this case U is continuous\nat {p = 0} whenever U is finite. Therefore the boundary conditions for\nthe value function V are\nV = 0 on \u2202O and lim\nV (y 0 ) = 0 for all y \u2208 \u2202O.\n0\ny \u2192y\n\n(2.17)\n\n\f8\n\nM. JUNCA\n\n2. 0 is a natural boundary for the price process P . This means that for any\np > 0, P(Pt = 0 for some t > 0|P0 = p) = 0. For example the geometric\nBrownian motion. In this case we can have different situations in V (x, p)\nas p goes to 0 depending on the price process. In particular, we can have\nthe situation where V is discontinuous on the set {p = 0}.\n\n2.4\n\nViscosity solution\n\nWe now are going to prove that the value function is a viscosity solution of the\nHJB equation (2.9) and find the appropriate conditions that make this value\nfunction unique. The appropriate notion of solution of the HJB equation (2.9)\nis the notion of discontinuous viscosity solution since we cannot know a priori\nif the value function is continuous in O. We must first state some definitions.\nDefinition 2.2. Let W be an extended real-valued function on some open set\nD \u2282 Rn .\n(i) The upper semi-continuous envelope of W is\nW \u2217 (x) = lim\nr\u21930\n\nsup\n\nW (x0 ), \u2200x \u2208 D.\n\n|x0 \u2212x|\u2264r\nx0 \u2208D\n\n(ii) The lower semi-continuous envelope of W is\nW\u2217 (x) = lim\nr\u21930\n\ninf\n\n|x0 \u2212x|\u2264r\nx0 \u2208D\n\nW (x0 ), \u2200x \u2208 D.\n\nNote that W \u2217 is the smallest upper semi-continuous function which is greater\nthan or equal to W , and similarly for W\u2217 . Now we define discontinuous viscosity\nsolutions.\nDefinition 2.3. Given an equation of the form\n\b\nmin F (x, \u03c6(x), D\u03c6(x), D2 \u03c6(x)), \u03c6 \u2212 M\u03c6 = 0 in D,\n\n(2.18)\n\na locally bounded function W on D is a:\n(i) Viscosity subsolution of (2.18) in D if for each \u03c6 \u2208 C 2 (D\u0304),\n\b\nmin F (x0 , W (x0 ), D\u03c6(x0 ), D2 \u03c6(x0 )), W \u2217 (x0 ) \u2212 MW \u2217 (x0 ) \u2264 0\nat every x0 \u2208 D which is a maximizer of W \u2217 \u2212 \u03c6 on D\u0304 with W \u2217 (x0 ) =\n\u03c6(x0 ).\n(ii) Viscosity supersolution of (2.18) in D if for each \u03c6 \u2208 C 2 (D\u0304),\n\b\nmin F (x0 , W (x0 ), D\u03c6(x0 ), D2 \u03c6(x0 )), W\u2217 (x0 ) \u2212 MW\u2217 (x0 ) \u2265 0\nat every x0 \u2208 D which is a minimizer of W\u2217 \u2212\u03c6 on D\u0304 with W\u2217 (x0 ) = \u03c6(x0 ).\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n9\n\n(iii) Viscosity solution of (2.18) in D if it is both a viscosity subsolution and\na viscosity supersolution of (2.18) in D.\nWe are now ready for the following theorem:\nTheorem 2.4. The value function V defined by (2.7) is a viscosity solution of\n(2.9) in O.\nProof. By the bounds given in the section 2.2, it is clear that V is locally\nbounded. Now we show the viscosity solution property.\nSubsolution property: Let y0 \u2208 O and \u03c6 \u2208 C 2 (O) such that y0 is a maximizer\nof V \u2217 \u2212 \u03c6 on O with V \u2217 (y0 ) = \u03c6(y0 ). Now suppose that there exists \u03b8 > 0 and\n\u03b4 > 0 such that\n\u2212 \u03b2\u03c6(y) + A\u03c6(y) \u2264 \u2212\u03b8\n(2.19)\nfor all y \u2208 O such that |y \u2212 y0 | < \u03b4. Let (yn ) be a sequence in O such that\nyn \u2192 y0 and\nlim V (yn ) = V \u2217 (y0 ).\nn\u2192\u221e\n\nBy the dynamic programming principle (2.8), for all n \u2265 1 there exist an adn\nn\n)m such that for any stopping time \u03c4 we have\n, \u03b6m\nmissible control \u03bdn = (\u03c4m\nthat\n\uf8ee\n\uf8f9\nX\nn\n1\nn n\n\u2212\u03b2\u03c4\nV (yn ) \u2264 E \uf8f0\ne\u2212\u03b2\u03c4m (\u03b6m\nP\u03c4 m\nV (Y\u03c4n )\uf8fb + ,\n(2.20)\nn \u2212 k) + e\nn\nn\n\u03c4m \u2264\u03c4\n\nwhere Ysn is the process controlled by \u03bdn for s \u2265 0. Now consider the stopping\ntime\nTn = inf{s \u2265 0 : |Ysn \u2212 y0 | \u2265 \u03b4} \u2227 \u03c41n ,\nwhere \u03c41n is the first intervation time of the impulse control \u03bdn . By (2.20) we\nhave that\nh\n\u0010\ni 1\n\u0011\n\u0003\n\u0002\nV (yn ) \u2264 E e\u2212\u03b2Tn V (YTnn )1{Tn <\u03c41n } + E e\u2212\u03b2Tn \u03b61n P\u03c4n1n \u2212 k + V (Y\u03c4n1n ) 1{Tn =\u03c41n } +\nn\n\u0002 \u2212\u03b2Tn\n\u0003\n1\nn\n\u2212\u03b2Tn\nn\n\u2264E e\nV (YTn \u2212 )1{Tn <\u03c41n } + E[e\nMV (Y\u03c41n \u2212 )1{Tn =\u03c41n } ] +\nn\n(2.21)\n\u0002 \u2212\u03b2Tn\n\u0003\n1\n(2.22)\n\u2264E e\nV (YTnn \u2212 ) +\nn\nNow, by Dynkin's formula and (2.19) we have\n\"Z\n\u2212\u03b2Tn\n\nE[e\n\nTn\n\n\u03c6(YTnn \u2212 )]\n\n= \u03c6(yn ) + E\n\ne\n\n\u2212\u03b2s\n\n#\n(\u2212\u03b2\u03c6(Ysn )\n\n0\n\n\u2264 \u03c6(yn ) \u2212\n\n\u03b8\n(1 \u2212 E[e\u2212\u03b2Tn ]).\n\u03b2\n\n+\n\nA\u03c6(Ysn )) ds\n\n\f10\n\nM. JUNCA\n\nSince V \u2264 V \u2217 \u2264 \u03c6 and Tn \u2264 \u03c41n , by (2.22)\nV (yn ) \u2264 \u03c6(yn ) \u2212\n\n\u03b8\n1\n(1 \u2212 E[e\u2212\u03b2Tn ]) + ,\n\u03b2\nn\n\nfor all n. Letting n go to infinity we have that\nlim E[e\u2212\u03b2Tn ] = 1,\n\nn\u2192\u221e\n\nwhich implies that\nlim P[\u03c41n = 0] = 1.\n\nn\u2192\u221e\n\nCombining the above with (2.21) when we let n \u2192 \u221e we get\nV \u2217 (y0 ) \u2264\n\nsup\n\nMV (y 0 ).\n\n|y 0 \u2212y0 |<\u03b4\n\nSince this is true for all \u03b4 small enough, then sending \u03b4 to 0 we have\nV \u2217 (y0 ) \u2264 (MV )\u2217 (y0 ).\nIf we show that (MV )\u2217 \u2264 MV \u2217 , then we would have proved that if \u2212\u03b2\u03c6(y0 ) +\nA\u03c6(y0 ) < 0, then MV \u2217 (y0 ) \u2212 V \u2217 (y0 ) \u2265 0 and therefore\nmin {\u03b2\u03c6(y0 ) \u2212 A\u03c6(y0 ), V \u2217 (y0 ) \u2212 MV \u2217 (y0 )} \u2264 0.\nAppendix A contains the proof of this last fact.\nSupersolution property: Let y0 \u2208 O and \u03c6 \u2208 C 2 (O) such that y0 is a\nminimizer of V\u2217 \u2212 \u03c6 on O with V\u2217 (y0 ) = \u03c6(y0 ). By definition of V and MV we\nhave that MV \u2264 V on O and therefore (MV )\u2217 \u2264 V\u2217 . Let (yn ) be a sequence\nin O such that yn \u2192 y0 and\nlim V (yn ) = V\u2217 (y0 ).\n\nn\u2192\u221e\n\nNow, since V\u2217 \u2264 V is lower semi-continuous and \u0393 is continuous we have\nMV\u2217 (y0 ) = sup V\u2217 (\u0393(y0 , \u03b6)) + \u03b6\u03b1(\u03b6, p0 ) \u2212 k\n0\u2264\u03b6\u2264x0\n\n\u2264 sup lim inf V (\u0393(yn , \u03b6)) + \u03b6\u03b1(\u03b6, pn ) \u2212 k\n0\u2264\u03b6\u2264x0 n\u2192\u221e\n\n\u2264 lim inf sup V (\u0393(yn , \u03b6)) + \u03b6\u03b1(\u03b6, pn ) \u2212 k\nn\u2192\u221e 0\u2264\u03b6\u2264xn\n\n\u2264 lim MV (yn )\nn\u2192\u221e\n\n= (MV )\u2217 (y0 ).\nHence MV\u2217 (y0 ) \u2264 (MV )\u2217 (y0 ) \u2264 V\u2217 (y0 ). Now suppose that there exists \u03b8 > 0\nand \u03b4 > 0 such that\n\u03b2\u03c6(y) \u2212 A\u03c6(y) \u2264 \u2212\u03b8\n(2.23)\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n11\n\nfor all y \u2208 O such that |y \u2212 y0 | < \u03b4. Fix n large enough such that |yn \u2212 y0 | < \u03b4\nand consider the process Ysn for s \u2265 0 with no intervention such that Y0n = yn .\nLet\nTn = inf{s \u2265 0 : |Ysn \u2212 y0 | \u2265 \u03b4}.\nNow, by Dynkin's formula and (2.23) we have\nE[e\u2212\u03b2Tn \u03c6(YTnn )] = \u03c6(yn ) + E\n\u2265 \u03c6(yn ) +\n\n\"Z\n\nTn\n\n#\ne\u2212\u03b2s (\u2212\u03b2\u03c6(Ysn ) + A\u03c6(Ysn )) ds\n\n0\n\n\u03b8\n(1 \u2212 E[e\u2212\u03b2Tn ]).\n\u03b2\n\nOn the other hand, \u03c6 \u2264 V\u2217 \u2264 V and using the dynamic programming principle\n(2.8) we have\nE[e\u2212\u03b2Tn \u03c6(YTnn )] \u2264 E[e\u2212\u03b2Tn V (YTnn )] \u2264 V (yn ).\nNotice that \u03b7 := lim E[e\u2212\u03b2Tn ] < 1 since Tn > 0 a.s by a.s continuity of the\nn\u2192\u221e\nprocesses Ysn , then by the above two inequalities and taking n \u2192 \u221e, we have\nthat\n\u03b8\nV\u2217 (y0 ) \u2265 \u03c6(y0 ) + (1 \u2212 \u03b7) > \u03c6(y0 )\n\u03b2\ncontradicting the fact that V\u2217 (y0 ) = \u03c6(y0 ). This establishes the supersolution\nproperty.\n\n2.5\n\nUniqueness\n\nLet \u03c8 be defined as before and let's assume that the function U defined in (2.13)\nis finite. Also assume that the transaction cost k > 0. Then, we want to prove\nthat V is the unique viscosity solution of the equation (2.9) that is bounded by\nU . We will need an additional assumption about the function \u03c8: For all x \u2265 0\nlim\n\np\u2192\u221e\n\nU (x, p)\n= `x = 0.\n\u03c8(p)\n\n(2.24)\n\nFollowing the ideas in [Crandall et al., 1992, Ishii, 1993] let u be an upper semicontinuous (usc) viscosity subsolution of the HJB equation (2.9) and v be a\nlower semi-continuous (lsc) viscosity supersolution of the same equation in O,\nsuch that they are bounded by U and\nlim sup u(y 0 ) \u2264 lim\ninf v(y 0 ) for all y \u2208 \u2202O.\n0\ny 0 \u2192y\n\ny \u2192y\n\nDefine\nvm (x, p) = v(x, p) +\n\n1 2\nx \u03c8(p)\nm\n\n(2.25)\n\n\f12\n\nM. JUNCA\n\nfor all m \u2265 1. Then vm is still lsc and clearly \u03b2vm \u2212 Avm \u2265 0 by definition of\n\u03c8. Now,\n1\n(x \u2212 \u03b6)2 \u03c8(\u03b1(\u03b6, p)) + \u03b6\u03b1(\u03b6, p) \u2212 k\nm\n0\u2264\u03b6\u2264x\n1\n\u2264 sup v(x \u2212 \u03b6, \u03b1(\u03b6, p)) + \u03b6\u03b1(\u03b6, p) \u2212 k + sup\n(x \u2212 \u03b6)2 \u03c8(\u03b1(\u03b6, p))\n0\u2264\u03b6\u2264x\n0\u2264\u03b6\u2264x m\n1\n= Mv(x, p) + x2 \u03c8(p)\nm\n1 2\n\u2264 v(x, p) + x \u03c8(p) = vm (x, p).\nm\n\nMvm (x, p) = sup v(x \u2212 \u03b6, \u03b1(\u03b6, p)) +\n\nTherefore vm is supersolution of (2.9). Now, by the growth condition of u and\nv and equations (2.15) and (2.24) we get\nlim (u \u2212 vm )(y) = \u2212\u221e.\n\n(2.26)\n\n|y|\u2192\u221e\n\nWe will show now that\nu \u2264 v in O.\n\n(2.27)\n\nIt is sufficient to show that sup (u \u2212 vm ) \u2264 0 for all m \u2265 1 since the result\ny\u2208\u014c\n\nis obtained by letting m \u2192 \u221e. Suppose that there exists m \u2265 1 such that\n\u03b7 = sup (u \u2212 vm ) > 0. Since u \u2212 vm is usc, by (2.26) and (2.25) there exist\ny\u2208\u014c\n\ny0 \u2208 O such that \u03b7 = (u \u2212 vm )(y0 ). Let y0 = (x0 , p0 ) be the one with minimum\nnorm over all possible maximizers of u \u2212 vm . For i \u2265 1, define\n\u03c6i (y, y 0 ) =\n\ni\n|y \u2212 y 0 |4 + |y \u2212 y0 |4 ,\n2\n\n\u03a6i (y, y 0 ) = u(y) \u2212 vm (y 0 ) \u2212 \u03c6i (y, y 0 ).\nLet\n\u03b7i =\n\nsup\n|y|,|y 0 |\u2264|y0 |\n\n\u03a6i (y, y 0 ) = \u03a6i (yi , yi0 ).\n\nClearly \u03b7i \u2265 \u03b7. Then, this inequality reads 2i |yi \u2212 yi0 |4 + |yi \u2212 y0 |4 \u2264 u(yi ) \u2212\nvm (yi0 ) \u2212 (u \u2212 vm )(y0 ). Since |yi |, |yi0 | \u2264 |y0 | and u and \u2212vm are bounded\nabove in that region, this implies that yi , yi0 \u2192 y0 and 2i |yi \u2212 yi0 |4 \u2192 0 (along\na subsequence) as i \u2192 \u221e. We also find that \u03b7i \u2192 \u03b7, u(yi ) \u2212 vm (yi0 ) \u2192 \u03b7 and\nu(yi ) \u2192 u(y0 ), vm (yi0 ) \u2192 v(y0 ). By theorem 3.2 in [Crandall et al., 1992], for all\n0\ni\ni \u2265 1, there exist symmetric matrices Mi and Mi0 such that ( \u2202\u03c6\n\u2202y (yi , yi ), Mi ) =\n(di , Mi ) \u2208 J \u03042,+ u(yi ), (\u2212 \u2202\u03c60i (yi , y 0 ), M 0 ) = (d0 , M 0 ) \u2208 J \u03042,\u2212 vm (y 0 ) and\ni\n\n\u2202y\n\n\u0012\n\nMi\n0\n\n0\nMi0\n\n\u0013\n\ni\n\ni\n\ni\n\ni\n\n1\n\u2264 D2 \u03c6i (yi , yi0 ) + (D2 \u03c6i (yi , yi0 ))2 .\ni\n\nSince u is a subsolution of (2.9) and vm is a supersolution, we have\n1\nmin{\u03b2u(yi ) \u2212 \u03bc(pi )di,2 \u2212 \u03c3(pi )2 Mi,22 , u(yi ) \u2212 Mu(yi )} \u2264 0,\n2\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n13\n\nand\n1\n0\nmin{\u03b2vm (yi0 ) \u2212 \u03bc(p0i )d0i,2 \u2212 \u03c3(p0i )2 Mi,22\n, vm (yi0 ) \u2212 Mvm (yi0 )} \u2265 0.\n2\nNow, if we show that for infinitely many i's we have that\n1\n\u03b2u(yi ) \u2212 \u03bc(pi )di,2 \u2212 \u03c3(pi )2 Mi,22 \u2264 0,\n2\n\n(2.28)\n\nand since it is always true that\n1\n0\n\u03b2vm (yi0 ) \u2212 \u03bc(p0i )d0i,2 \u2212 \u03c3(p0i )2 Mi,22\n\u2265 0,\n2\nwe have that u \u2264 vm by following the classical comparison proof in [Crandall\net al., 1992]. Suppose then, that there exists i0 such that (2.28) is not true for\nall i \u2265 i0 , then for i \u2265 i0\nu(yi ) \u2212 Mu(yi ) \u2264 0.\nSince vm is a supersolution, we must have that\nvm (yi0 ) \u2212 Mvm (yi0 ) \u2265 0.\nSince u is usc, there exist \u03b6i such that Mu(yi ) = u(xi \u2212\u03b6i , \u03b1(\u03b6i , pi ))+\u03b6i \u03b1(\u03b6i , pi )\u2212\nk. Then\nu(yi ) \u2264 u(xi \u2212 \u03b6i , \u03b1(\u03b6i , pi )) + \u03b6i \u03b1(\u03b6i , pi ) \u2212 k.\nExtracting a subsequence if necessary, we assume that \u03b6i \u2192 \u03b60 as i \u2192 \u221e.\nFirst, consider \u03b60 = 0, then by taking lim sup in the inequality above we get\nu(y0 ) \u2264 u(y0 ) \u2212 k. This is a contradiction since k > 0. Now assume that \u03b60 6= 0.\nFrom the above inequalities we have that\nu(yi )\u2212vm (yi0 ) \u2264 u(xi \u2212\u03b6i , \u03b1(\u03b6i , pi ))+\u03b6i \u03b1(\u03b6i , pi )\u2212vm (x0i \u2212\u03b6i0 , \u03b1(\u03b6i0 , p0i ))\u2212\u03b6i0 \u03b1(\u03b6i0 , p0i ),\nfor any 0 \u2264 \u03b6i0 \u2264 p0i . Since p0i \u2192 p0 , let \u03b6i0 \u2192 \u03b60 and taking lim sup in the above\ninequality we get that\n\u03b7 \u2264 (u \u2212 vm )(x0 \u2212 \u03b60 , \u03b1(\u03b60 , p0 )).\nThis is a contradiction since y0 was chosen with minimum norm among maximizers of u \u2212 vm and \u03b60 > 0. Therefore (2.28) must hold for infinitely many i's\nand (2.27) holds. As usual continuity in O and uniqueness of V follow from the\nfact that V is a viscosity solution of (2.9).\nWe have just proved the following theorem:\nTheorem 2.5. Assume condition (2.24) and that the transaction cost k > 0. If\nW is a viscosity solution of equation (2.9) that is bounded by U and satisfies the\nsame boundary conditions as V , then W = V . Furthermore, V is continuous in\nO.\nRemark 2.6. Condition (2.24) is satisfied by It\u00f4 processes like Brownian Motion, Geometric Brownian Motion, Ornstein-Uhlenbeck and Cox-Ingersoll-Ross.\n\n\f14\n\n3\n\nM. JUNCA\n\nNo transaction cost\n\nFrom the proof of the above uniqueness result, we can see that the result depends on the fact that k > 0. Let's start by pointing out that in this case the\nintervention operator becomes\nM\u03c6(y) = sup \u03c6(\u0393(y, \u03b6)) + \u03b6\u03b1(\u03b6, p) \u2265 \u03c6(\u0393(y, 0)) = \u03c6(y),\n\n(3.1)\n\n0\u2264\u03b6\u2264x\n\nfor any measurable function \u03c6. This implies in particular that any measurable\nfunction is a viscosity subsolution of (2.9). On the other hand, V \u2265 MV for\nthe value function. Then we have that\nV \u2265 MV \u2265 V.\nAssume now that V \u2208 C 1 (O). Since \u03b6 = 0 is a maximum for \u03b6 7\u2192 V (\u0393(y, \u03b6)) +\n\u03b6\u03b1(\u03b6, p), then for all y \u2208 O:\n0\u2265\n\n\u2202V\n\u2202V\n\u2202\u03b1\n\u2202\u03b1\n(\u03b6, p)\n(y) \u2212\n(y) + \u03b1(\u03b6, p) + \u03b6\n(\u03b6, p)\n\u2202\u03b6\n\u2202p\n\u2202x\n\u2202\u03b6\n\n\u03b6=0\n\n\u2202\u03b1\n\u2202V\n\u2202V\n=\n(0, p)\n(y) \u2212\n(y) + p.\n\u2202\u03b6\n\u2202p\n\u2202x\nRecall that \u03b1 is non-increasing in \u03b6, so we define\n\u03b3(p) = \u2212\n\n\u2202\u03b1\n(0, p),\n\u2202\u03b6\n\n(3.2)\n\nfor all p \u2265 0. Hence, we get the following condition for V :\n\u2212 \u03b3(p)\n\n\u2202V\n\u2202V\n(y) \u2212\n(y) + p \u2264 0.\n\u2202p\n\u2202x\n\n(3.3)\n\nThis suggests that if we assume no fixed transaction cost we should look at a\ndifferent HJB equation, that is\n\u001a\n\u001b\n\u2202\u03c6 \u2202\u03c6\nmin \u03b2\u03c6 \u2212 A\u03c6, \u03b3(p)\n+\n\u2212 p = 0.\n(3.4)\n\u2202p\n\u2202x\nOn the other hand, condition (2.4) implies that it is always better to split the\norders into smaller orders. Indeed, given (\u03b6, p) \u2208 O and 0 \u2264 \u03b6 0 \u2264 \u03b6\n\u03b6 0 \u03b1(\u03b6 0 , p) + (\u03b6 \u2212 \u03b6 0 )\u03b1(\u03b6, p) = \u03b6\u03b1(\u03b6, p) + (\u03b6 \u2212 \u03b6 0 )(\u03b1(\u03b6 0 , p) \u2212 \u03b1(\u03b6, p)) \u2265 \u03b6\u03b1(\u03b6, p),\nsince \u03b1 is non-increasing in \u03b6.\n\n3.1\n\nSingular control\n\nIn fact, the equation (3.4) is the associated equation of the following control\nproblem ([\u00d8ksendal and Sulem, 2005]): In this case our admissible controls are\nof the singular type, that is\ndXt = \u2212d\u03bet ,\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n15\n\nwhere \u03be0 = 0, \u03be is an adapted, continuous non-decreasing and non-negative\nprocess. The price process in this case follows the dynamics\ndPt = \u03bc(Pt\u2212 )dt + \u03c3(Pt\u2212 )dBt \u2212 \u03b3(Pt\u2212 )d\u03bet ,\nwhere \u03b3 (see (3.2)) is a non-negative smooth function that accounts for the price\nimpact. In order to guarantee the existence and uniqueness of the process Pt ,\nwe need to also assume that \u03b3 is a Lipschitz function ([Protter, 2004]). Now,\nthe form of the value function V0 changes to\n\u0015\n\u0014Z \u221e\n\u2212\u03b2t\ne Pt d\u03bet ,\n(3.5)\nV0 (y) = sup E\n\u03be\n\n0\n\nfor all y \u2208 \u014c. In this case the appropriate form of the DPP is\n\u0014Z \u03c4\n\u0015\n\u2212\u03b2s\n\u2212\u03b2\u03c4\nV0 (y) = sup E\ne\nPs d\u03bes + e\nV0 (Y\u03c4 ) ,\n\u03be\n\n(3.6)\n\n0\n\nfor any stopping time \u03c4 . As before, we can define the continuation region as\nC = {y \u2208 O : \u03b3(p)\n\n\u2202\u03c6 \u2202\u03c6\n+\n\u2212 p > 0}\n\u2202p\n\u2202x\n\nand the trade region as\nT = {y \u2208 O : \u03b3(p)\n\n\u2202\u03c6 \u2202\u03c6\n+\n\u2212 p = 0}.\n\u2202p\n\u2202x\n\nTypically, singular controls are allowed to be c\u00e0dl\u00e0g instead of continuous. We\ndecide to restrict our controls for two reasons: (1) Under the absence of fixed\ntransaction cost, the investor will divide the orders into very small pieces as\nshown above. (2) When the singular control is discontinuous the stochastic\nintegral may not be properly defined (see [Protter, 2004]).\n\n3.2\n\nViscosity solution\n\nAlthough we only consider continuous strategies, the value function is still a\nviscosity solution of equation (3.4) (which definition is similar to 2.3).\nTheorem 3.1. The value function V0 defined by (3.5) is a viscosity solution of\n(3.4) in O.\nProof. Since we can approach finite variation functions by simple functions, by\nproposition 2.1 we have that\nV0 \u2264 U.\n(3.7)\nTherefore, V0 is locally bounded.\nSubsolution property: Let y0 \u2208 O and \u03c6 \u2208 C 2 (O) such that y0 is a maximizer\nof V0\u2217 \u2212 \u03c6 on O with V0\u2217 (y0 ) = \u03c6(y0 ). Now suppose that there exists \u03ba > 0 and\n\u03b4 > 0 such that\n\u2212 \u03b2\u03c6(y) + A\u03c6(y) \u2264 \u2212\u03ba and p \u2212 \u03b3(p)\n\n\u2202\u03c6\n\u2202\u03c6\n(y) \u2212\n(y) \u2264 \u2212\u03ba\n\u2202p\n\u2202x\n\n(3.8)\n\n\f16\n\nM. JUNCA\n\nfor all y \u2208 O such that |y \u2212 y0 | < \u03b4. Let (yn ) be a sequence in O such that\nyn \u2192 y0 and\nlim V0 (yn ) = V0\u2217 (y0 ).\n\nn\u2192\u221e\n\nGiven any stopping time \u03c4 , by (3.6), for all n \u2265 1 there exists an admissible\ncontrol \u03be n such that\n\u03c4\n\n\u0014Z\n\n\u0015\n1\ne\u2212\u03b2s Psn d\u03besn + e\u2212\u03b2\u03c4 V0 (Y\u03c4n ) + ,\nn\n\nV0 (yn ) \u2264 E\n0\n\nwhere Ysn is the process controlled by \u03be n for s \u2265 0 starting at yn . Since V0 \u2264\nV0\u2217 \u2264 \u03c6, using Dynkin's formula for semimartingales ([Protter, 2004]) we have\nthat\n\u0014Z \u03c4\n\u0015\n\u0014Z \u03c4\n\u0015\n\u2212\u03b2s n\nn\n\u2212\u03b2s\nn\nn\nV0 (yn ) \u2264 E\ne\nPs d\u03bes + \u03c6(yn ) + E\ne\n(\u2212\u03b2\u03c6(Ys ) + A\u03c6(Ys )) ds\n0\n\u0013\n\u0015\n\u0014Z 0\u03c4\n\u0012\n\u2202\u03c6 n\n1\nn\nn\n\u2212\u03b2s\nn \u2202\u03c6\n(Ys ) d\u03bes + .\n\u2212E\ne\n\u03b3(Ps ) (Ys ) +\n\u2202p\n\u2202x\nn\n0\nConsider again the stopping time\n\u03c4n = inf{s \u2265 0 : |Ysn \u2212 y0 | \u2265 \u03b4},\nthen by (3.8)\n\u0014Z\n\n\u03c4n\n\nV0 (yn ) \u2264 \u2212\u03baE\n\ne\n\n\u2212\u03b2s\n\n(ds +\n\nd\u03besn )\n\n\u0015\n+ \u03c6(yn ) +\n\n0\n\n1\n.\nn\n\nTaking n \u2192 \u221e we obtain a contradiction since the integral inside the expectation is bounded away from 0 for any admissible control \u03be by the a.s continuity\nof the process Ysn . Hence at least one of the inequalities in (3.8) is not possible\nand this establishes the subsolution property.\nSupersolution property: Let y0 \u2208 O and \u03c6 \u2208 C 2 (O) such that y0 is a\nminimizer of V0\u2217 \u2212 \u03c6 on O with V0\u2217 (y0 ) = \u03c6(y0 ). Let (yn ) be a sequence in O\nsuch that yn \u2192 y0 and\nlim V0 (yn ) = V0\u2217 (y0 ).\n\nn\u2192\u221e\n\nFirst, suppose that there exists \u03b8 > 0 and \u03b4 > 0 such that\n\u03b2\u03c6(y) \u2212 A\u03c6(y) \u2264 \u2212\u03b8\n\n(3.9)\n\nfor all y \u2208 O such that |y \u2212 y0 | < \u03b4. Fix n large enough such that |yn \u2212 y0 | < \u03b4\nand consider the process Ysn for s \u2265 0 with no intervation, i.e. \u03be = 0, such that\nY0n = yn . Let\n\u03c4n = inf{s \u2265 0 : |Ysn \u2212 y0 | \u2265 \u03b4}.\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n17\n\nNow, by Dynkin's formula for semimartingales and (3.9) we have\n\u0015\n\u0014Z \u03c4n\n\u2212\u03b2s\nn\nn\nn\n\u2212\u03b2\u03c4n\ne\n(\u2212\u03b2\u03c6(Ys ) + A\u03c6(Ys )) ds\n\u03c6(Y\u03c4n )] = \u03c6(yn ) + E\nE[e\n0\n\u0014Z \u03c4n\n\u0012\n\u0013\n\u0015\n\u2202\u03c6 n\n\u2212\u03b2s\nn \u2202\u03c6\nn\ne\n\u2212E\n\u03b3(Ps ) (Ys ) +\n(Y ) d\u03bes\n\u2202p\n\u2202x s\n0\n\u0014Z \u03c4n\n\u0015\n\u2212\u03b2s\nn\nn\ne\n= \u03c6(yn ) + E\n(\u2212\u03b2\u03c6(Ys ) + A\u03c6(Ys )) ds\n\u0015\n\u0014Z0 \u03c4n\n\u2212\u03b2s\ne\nds .\n\u2265 \u03c6(yn ) \u2212 \u03b8E\n0\n\nAs before, from here we can draw a contradiction with V0\u2217 (y0 ) = \u03c6(y0 ) by the\na.s. continuity if the process Ysn . Now, take h > 0 and consider the process Yt\nwith control process d\u03bet = h1 1[0,h] (t)dt and Y0 = y for given y \u2208 O. Using (3.6)\nwe can show that\n\"Z\n#\nh\n\u2212\u03b2s\n\u2212\u03b2h\nV0 (y) \u2265 E\ne\nPs d\u03bes + e\nV (Yh )\n0\n\n\"Z\n\n#\n\nh\n\n\u2265E\n\ne\n\n\u2212\u03b2s\n\nPs d\u03bes + e\n\n\u2212\u03b2h\n\n\u03c6(Yh )\n\n0\n\n#\n\" Z\n1 h \u2212\u03b2s\n\u2212\u03b2h\ne\nPs ds + e\n\u03c6(Yh ) .\n=E\nh 0\nBy Dynkin's formula again,\nE[e\n\n\u2212\u03b2h\n\n\"Z\n\n#\n\nh\n\n\u03c6(Yh )] = \u03c6(y) + E\n\ne\n\n\u2212\u03b2s\n\n(\u2212\u03b2\u03c6(Ys ) + A\u03c6(Ys )) ds\n\n0\n\n\"Z\n\nh\n\n#\n\u0013\n\u0012\n\u2202\u03c6\n\u2202\u03c6\n(Ys ) d\u03bes\ne\n\u03b3(Ps ) (Ys ) +\n\u2202p\n\u2202x\n\"Z\n#\n\u2212\u03b2s\n\n\u2212E\n0\n\nh\n\ne\u2212\u03b2s (\u2212\u03b2\u03c6(Ys ) + A\u03c6(Ys )) ds\n\n= \u03c6(y) + E\n0\n\n1\n\u2212 E\nh\n\n\"Z\n\nh\n\ne\n0\n\n\u2212\u03b2s\n\n\u0012\n\u0013 #\n\u2202\u03c6\n\u2202\u03c6\n\u03b3(Ps ) (Ys ) +\n(Ys ) ds .\n\u2202p\n\u2202x\n\nLetting h \u2192 0, we have\nV0 (y) \u2265 \u03c6(y) + p \u2212 \u03b3(p)\n\n\u2202\u03c6\n\u2202\u03c6\n(y) \u2212\n(y).\n\u2202p\n\u2202x\n\nTherefore, for all n \u2265 1 we have\nV0 (yn ) \u2265 \u03c6(yn ) + pn \u2212 \u03b3(pn )\n\n\u2202\u03c6\n\u2202\u03c6\n(yn ) \u2212\n(yn ).\n\u2202p\n\u2202x\n\n\f18\n\nM. JUNCA\n\nSince \u03b3 is continuous, letting n \u2192 \u221e we get\n\u03c6(y0 ) = V0\u2217 (y0 ) \u2265 \u03c6(y0 ) + p0 \u2212 \u03b3(p0 )\n\n\u2202\u03c6\n\u2202\u03c6\n(y0 ) \u2212\n(y0 )\n\u2202p\n\u2202x\n\nas desired. This establishes the supersolution property.\n\n3.3\n\nUniqueness\n\nRecall that with the impulse formulation we do not have uniqueness in absence\nof transaction cost. This is not the case with the singular control formulation.\nTheorem 3.2. Assume that (2.24) is satisfied. If W is a viscosity solution of\nequation (3.4) that is bounded by U and satisfies the same boundary conditions\nas V0 , then W = V0 . Furthermore, V0 is continuous in O.\nProof. The proof follows the same strategy as in the impulse control case. Let\nu be an upper semi-continuous (usc) viscosity subsolution of the HJB equation\n(3.4) and v be a lower semi-continuous (lsc) viscosity supersolution of the same\nequation in O, such that they are bounded by U and condition (2.25) holds.\nDefine\n\u0013\n\u0012\n\u0001\n1\n1\nv(x, p) +\nC(x + 1)2 \u03c8(p) + 1\nvm (x, p) = 1 \u2212\nm\nm\nfor all m \u2265 1 and C as in (2.15). Recall that \u03b3 is non-negative and \u03c8 is an\nincreasing function, then (2.15) implies that\n\u0012\n\u0013\n\u2202vm\n\u2202vm\n1\n\u2202 1\n\u2202 1\n\u2212p +\n+ \u03b3(p)\n\u2265 \u2212p + 1 \u2212\np+\nC(x + 1)2 \u03c8(p) + \u03b3(p)\nC(x + 1)2 \u03c8(p)\n\u2202x\n\u2202p\nm\n\u2202x m\n\u2202p m\n1\n1\n1\n= \u2212 p + 2C(x + 1)\u03c8(p) + \u03b3(p) C(x + 1)2 \u03c8 0 (p)\nm\nm\nm\n1\n2\n1\n\u2265 \u2212 p + p(x + 1) + \u03b3(p) C(x + 1)2 \u03c8 0 (p)\nm\nm\nm\n1\n\u2265 p.\nm\n\u0001\n\u03b2\n1\nAlso (\u03b2I \u2212 A) m = m > 0, where I is the identity operator. Therefore vm is\na strict supersolution of (3.4) in O. Following the same lines and definitions as\nin the previous proof we have\n1\nmin{\u03b2u(yi ) \u2212 \u03bc(pi )di,2 \u2212 \u03c3(pi )2 Mi,22 , \u2212pi + di,1 + \u03b3(pi )di,2 } \u2264 0,\n2\nand\n1\n0\nmin{\u03b2vm (yi0 ) \u2212 \u03bc(p0i )d0i,2 \u2212 \u03c3(p0i )2 Mi,22\n, \u2212p0i + d0i,1 + \u03b3(p0i )d0i,2 } \u2265 \u03b4i ,\n2\nn 0\no\np\n\u03b2\nwhere \u03b4i = min mi , m\n. Since p0i \u2192 p0 and y0 \u2208 O, \u03b4i > 0 for large enough i.\nWe need to show now that for infinitely many i's we have that\n1\n\u03b2u(yi ) \u2212 \u03bc(pi )di,2 \u2212 \u03c3(pi )2 Mi,22 \u2264 0.\n2\n\n(3.10)\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n19\n\nSuppose then, that there exists i0 such that (3.10) is not true for all i \u2265 i0 , then\nfor i \u2265 i0\n\u2212pi + di,1 + \u03b3(pi )di,2 \u2264 0.\nSince vm is a supersolution, we must have that\n\u2212p0i + d0i,1 + \u03b3(p0i )d0i,2 \u2265 \u03b4i .\nHence,\npi \u2212 p0i \u2212 (di,1 \u2212 d0i,1 ) \u2212 (\u03b3(pi )di,2 \u2212 \u03b3(p0i )d0i,2 ) \u2265 \u03b4i .\nSincen di , d0i ogoes to 0 as i goes to \u221e, we get the contradiction 0 \u2265 \u03b40 =\n\u03b2\n> 0. Therefore (3.10) must hold for infinitely many i's and the\nmin pm0 , m\ncomparison result holds. Everything follows now as before.\n\n3.4\n\nOptimal strategy for a special case\n\nPrevious sections characterize the value function of our problem in different\nformulations. We will calculate now the explicit solution of the value function\nand describe the optimal strategy in a particular case. Let us come back to the\nimpulse control case. Since we are allowed to do multiple trades at the same\ntime, we are going to explore this strategy. Assumption (2.4) guarantees that\nthe price impact does not change by splitting the trades, but the profit obtained\nby doing so could be greater. Let's define the following function\nZ x\nW (y) =\n\u03b1(s, p)ds for y \u2208 O.\n(3.11)\n0\n\nThis is the best that we can do when we do many trades at the same time. It\nis clear that this is not attainable with any impulse control. Since \u03b1 is nonincreasing on x and positive, we have for all y \u2208 O\nZ x\nx\u03b1(x, p) \u2264\n\u03b1(s, p)ds.\n(3.12)\n0\n\nTherefore, for all 0 \u2264 \u03b6 \u2264 x\nZ\n\nx\u2212\u03b6\n\nW (\u0393(y, \u03b6)) + \u03b6\u03b1(\u03b6, p) = \u03b6\u03b1(\u03b6, p) +\n\n\u03b1(s, \u03b1(\u03b6, p))ds\n0\n\nZ\n\u2264 \u03b6\u03b1(\u03b6, p) +\n\nx\n\nZ\n\u03b1(s, p)ds \u2212\n\n0\n\n\u03b6\n\n\u03b1(s, p)ds\n0\n\nZ\n= W (y) + \u03b6\u03b1(\u03b6, p) \u2212\n\n\u03b6\n\n\u03b1(s, p)ds\n0\n\n\u2264 W (y),\nwhere the last inequality follows from (3.12). Hence MW \u2264 W and therefore\nMW = W by (3.1). On the other hand, the function W satisfies (3.3) with\n\n\f20\n\nM. JUNCA\n\nequality. Indeed, by the condition (2.4) we have that for any \u03b61 , \u03b62 and p\n\u2202\u03b1\n\u2202\u03b1\n\u2202\u03b1\n(\u03b61 + \u03b62 , p) =\n(\u03b61 , \u03b1(\u03b62 , p)) (\u03b62 , p),\n\u2202\u03b6\n\u2202p\n\u2202\u03b6\nand taking \u03b62 = 0 we obtain\n\u2202\u03b1\n\u2202\u03b1\n\u2202\u03b1\n\u2202\u03b1\n(\u03b61 , p) =\n(\u03b61 , p) (0, p) = \u2212\u03b3(p) (\u03b61 , p).\n\u2202\u03b6\n\u2202p\n\u2202\u03b6\n\u2202p\nNow, since \u03b1 is smooth we find\n\u2212\u03b3(p)\n\nZ x\nZ x\n\u2202W\n\u2202W\n\u2202\u03b1\n\u2202\n\u03b1(s, p)ds + p\n(y) \u2212\n(y) + p = \u2212\u03b3(p)\n(s, p)ds \u2212\n\u2202p\n\u2202x\n\u2202x 0\n0 \u2202p\nZ x\n\u2202\u03b1\n=\n(s, p)ds \u2212 \u03b1(x, p) + p\n0 \u2202\u03b6\n= \u03b1(x, p) \u2212 \u03b1(0, p) \u2212 \u03b1(x, p) + p = 0.\n\nIf we had also that \u03b2W \u2212 AW \u2265 0, then W would solve both equations (2.9)\nand (3.4) and T = O.\nNow, [Subramanian and Jarrow, 2001] considers impact functions of the form\n\u03b1(x, p) = pc(x), where 0 \u2264 c \u2264 1 is nonincreasing. In our case, by condition\n(2.4), c must satisfy c(x1 )c(x2 ) = c(x1 + x2 ) and therefore we end up with the\nfollowing price impact functions and W :\n\u03b1(x, p) = pe\u2212\u03bbx\n\u03b3(p) = \u03bbp\np\nW (x, p) = (1 \u2212 e\u2212\u03bbx )\n\u03bb\n\n(3.13)\n(3.14)\n(3.15)\n\nwith \u03bb > 0. This function was proposed also in [He and Mamaysky, 2005] and\n[Ly Vath et al., 2007]. Let's consider this price impact function for the moment.\nIn this case we have the following:\nTheorem 3.3. V0 = W = V if and only if U (x, p) = xp.\nProof. If V0 = W then \u03b2W \u2212 AW \u2265 0 and therefore \u03b2\u03c6 \u2212 A\u03c6 \u2265 0 for \u03c6(p) = p.\nBy the uniqueness result for optimal stopping problems (see Theorem 3.1 in\n[\u00d8ksendal and Reikvam, 1998])\np = sup E[e\u2212\u03b2\u03c4 P\u03c4 ],\n\u03c4\n\nthat is U (x, p) = xp. Suppose that\nU (x, p) = x sup E[e\u2212\u03b2\u03c4 P\u03c4 ] = xp,\n\u03c4\n\nfor y \u2208 O. This means that \u03b2\u03c6\u2212A\u03c6 \u2265 0 for \u03c6(p) = p. Therefore \u03b2W \u2212AW \u2265 0\nand W satisfies the HJB equation (3.4) with T = O. Also, W satisfies the\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n21\n\ngrowth condition and has the same boundary conditions as V0 by (2.13). By\nTheorem 3.2, we have that W = V0 . To prove the second equality we will do\ninduction in the number of trades. Note that the function \u03b6 7\u2192 \u03b6e\u2212\u03bb\u03b6 in [0, x]\nattains its maximum at x\u0302 = min{x, \u03bb1 }. Then,\nsup E[e\u2212\u03b2\u03c41 \u03b61 P\u03c41 \u2212 e\u2212\u03bb\u03b61 ] \u2264 U (x\u0302, p) = x\u0302p \u2264 W (x, p).\n\u03bd\u2208\u03a51\n\nNow, let \u03bd \u2208 \u03a5n . Hence,\n\u0002\n\u0003\nE[e\u2212\u03b2\u03c41 \u03b61 P\u03c41 ] = E e\u2212\u03b2\u03c41 E[\u03b61 P\u03c41 \u2212 e\u2212\u03bb\u03b61 |F\u03c41 ] .\nOn the other hand, by induction hypothesis we have\n##\n#\n\"\n\" n\n\"\nn\nX\nX\n\u2212\u03b2\u03c41\n\u2212\u03b2(\u03c4i \u2212\u03c41 )\n\u2212\u03b2(\u03c4i \u2212\u03c41 )\n\u2212\u03b2\u03c41\nE\ne\n\u03b6 i P\u03c4 i F \u03c4 1\ne\n\u03b6 i P\u03c4 i = E e\nE e\ni=2\n\ni=2\n\n\u0002\n\u0003\n\u2264 E e\u2212\u03b2\u03c41 E[V (x \u2212 \u03b61 , e\u2212\u03bb\u03b61 P\u03c41 \u2212 )|F\u03c41 ]\n\u0002\n\u0003\n\u2264 E e\u2212\u03b2\u03c41 E[W (x \u2212 \u03b61 , e\u2212\u03bb\u03b61 P\u03c41 \u2212 )|F\u03c41 ]\nCombining both inequalities above we have\n\" n\n#\nX\n\u2212\u03b2\u03c4i\n\u03bd\ne\nE\n\u03b6i P\u03c4i \u2264 E[e\u2212\u03b2\u03c41 W (x, P\u03c41 \u2212 )] \u2264 W (x, p).\ni=1\n\nAgain, by Lemma 7.1 in [\u00d8ksendal and Sulem, 2005], the left hand side converges\nto V as n \u2192 \u221e. Clearly the other inequality holds and the proof is complete.\nExample Consider the case where the price process is a geometric Brownian\nmotion. This is the only process that is considered in the papers [Subramanian and Jarrow, 2001, He and Mamaysky, 2005, Ly Vath et al., 2007]. The\nunperturbed price process is\ndPt = \u03bcPt dt + \u03c3Pt dBt ,\nwith \u03c3 > 0. It is easy to see that the value function U is finite if and only if\n\u03b2 > \u03bc. In this case the function \u03c8 takes the form\n\u03c8(p) = p\u03bd ,\nwhere \u03bd > 1, therefore condition (2.24) holds. Now, the condition (2.13) reads\n0 \u2264 V (x, p) \u2264 U (x, p) = xp.\nThis implies that V0 = V = W . We can see that in this case the value function\nW is not attainable with any impulse control, but we can approach it by trading\nsmaller and smaller orders. We will show now how we can approach W with\nsingular (in fact regular) controls. Let u > 0 and consider the strategy d\u03bet = udt,\n\n\f22\n\nM. JUNCA\n\nthat is, selling shares at a constant speed u until the investor executes the\nposition. Then,\n1\nPt = p exp{(\u03bc \u2212 \u03bbu \u2212 \u03c3 2 )t + \u03c3Bt }\n2\nand\n\"Z\n#\n\u0015\n\u0014Z\n\u221e\n\nx/u\n\ne\u2212\u03b2t Pt d\u03bet = uE\n\nE\n\ne\u2212\u03b2t Pt dt\n\n0\n\n0\n\nZ\n\nx/u\n\ne\u2212\u03b2t E[Pt ]dt\n\n=u\n0\n\nZ\n\nx/u\n\ne(\u03bc\u2212\u03bbu\u2212\u03b2)t dt\n0\n\u0010\n\u0011\npu\ne(\u03bc\u2212\u03bbu\u2212\u03b2)x/u \u2212 1\n=\n\u03bc \u2212 \u03bbu \u2212 \u03b2\n= up\n\nby using Fubini's theorem since the integrand is positive. Taking u \u2192 \u221e this\nexpression converges to W .\n\n4\n\nConnection between both formulation\n\nTheorem 3.3 shows that V = V0 for a special case, i.e., the value function of\ntwo different problems are the same. We are going to show that this is not a\ncoincidence. Let us start with some notation: Given k \u2265 0 and y = (x, p) \u2208 \u014c\nwe denote:\n\"M\n#\nX\n(k)\n\u2212\u03b2\u03c4n\nV (y) = sup E\ne\n(\u03b6n P\u03c4n \u2212 k)\n\u03bd\n\nn=1\n\nand\nM(k) \u03c6(y) = sup \u03c6(\u0393(y, \u03b6)) + \u03b6\u03b1(\u03b6, p) \u2212 k.\n0\u2264\u03b6\u2264x\n\nLemma 4.1. For all y \u2208 \u014c we have\nlim V (k) (y) = V (0) (y).\n\nk\u21920\n\nProof. It is clear that V (0) is an upper bound. Let \u000f > 0, then there is m \u2265 0\nand \u03bd \u2208 \u03a5m such that\n\"m\n#\nX\n(0)\n\u2212\u03b2\u03c4i\ne\n\u03b6i \u03b1(\u03b6i , P\u03c4i \u2212 ) + \u000f.\nV (y) \u2264 E\ni=1\n\nFor any k \u2264\n\n\u000f\nm\n\nwe have that\n\"m\n#\n\"m\n#\nX\nX\nV (0) (y) \u2264 E\ne\u2212\u03b2\u03c4i (\u03b6i \u03b1(\u03b6i , P\u03c4i \u2212 ) \u2212 k) + kE\ne\u2212\u03b2\u03c4i + \u000f\ni=1\n\n\u2264 V (k) (y) + 2\u000f.\n\ni=1\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n23\n\nTheorem 4.2. V (0) solves the Hamilton-Jacobi-Bellman\n\u001a\n\u001b\n\u2202\u03c6 \u2202\u03c6\nmin \u03b2\u03c6 \u2212 A\u03c6, \u03b3(p)\n+\n\u2212 p = 0,\n\u2202p\n\u2202x\n\n(3.4)\n\nwith \u03b3 as in (3.2). Therefore, by theorem 3.2, V (0) = V0 .\nProof. First, consider the case when there is no impact in the price. Then \u03b3 \u2261 0\nand by proposition 2.1 V (0) (y) = xU (0) (p), where U (0) (p) = sup\u03c4 E[e\u2212\u03b2\u03c4 P\u03c4 ].\nSince U is viscosity solution of\nmin {\u03b2\u03c6 \u2212 A\u03c6, \u03c6 \u2212 p} = 0\nThen V (0) is solution of (3.4).\nAssume now that there is price impact. We know that V (0) satisfies the\nequation\nn\no\nmin \u03b2\u03c6 \u2212 A\u03c6, \u03c6 \u2212 M(0) \u03c6 = 0.\nSupersolution property: Let y0 \u2208 O and \u03c6 \u2208 C 2 (O) such that y0 is a minimizer\n(0)\n(0)\nof V\u2217 \u2212\u03c6 on O with V\u22170 (y0 ) = \u03c6(y0 ). Hence, \u03b2V\u2217 (y0 )\u2212A\u03c6(y0 ) \u2265 0. Now, let\n0 \u2264 \u03b6 \u2217 \u2264 x0 such that M(0) \u03c6(y0 ) = \u03c6(x0 \u2212 \u03b6 \u2217 , \u03b1(\u03b6 \u2217 , p0 )) + \u03b6 \u2217 \u03b1(\u03b6 \u2217 , p0 ). Thus,\n(0)\n\n(0)\n\n0 \u2264 V\u2217 (y0 ) \u2212 M(0) V\u2217 (y0 )\n(0)\n\n(0)\n\n\u2264 V\u2217 (y0 ) \u2212 V\u2217 (x0 \u2212 \u03b6 \u2217 , \u03b1(\u03b6 \u2217 , p0 )) \u2212 \u03b6 \u2217 \u03b1(\u03b6 \u2217 , p0 )\n\u2264 \u03c6(y0 ) \u2212 \u03c6(x0 \u2212 \u03b6 \u2217 , \u03b1(\u03b6 \u2217 , p0 )) \u2212 \u03b6 \u2217 \u03b1(\u03b6 \u2217 , p0 )\n= \u03c6(y0 ) \u2212 M(0) \u03c6(y0 ).\nSince \u03c6 \u2264 M(0) \u03c6, then \u03c6(y0 ) = M(0) \u03c6(y0 ). This implies that \u03b6 = 0 is a\nmaximum for \u03b6 7\u2192 \u03c6(x0 \u2212 \u03b6, \u03b1(\u03b6, p0 )) + \u03b6\u03b1(\u03b6, p0 ), therefore\n0\u2265\n\n\u2202\u03c6\n\u2202\u03c6\n\u2202\u03b1\n\u2202\u03b1\n(\u03b6, p0 ) (y0 ) \u2212\n(y0 ) + \u03b1(\u03b6, p0 ) + \u03b6\n(\u03b6, p0 )\n\u2202\u03b6\n\u2202p\n\u2202x\n\u2202\u03b6\n\n\u03b6=0\n\n\u2202\u03c6\n\u2202\u03c6\n= \u2212\u03b3(p0 ) (y0 ) \u2212\n(y0 ) + p0 .\n\u2202p\n\u2202x\nSubsolution property: Let y0 \u2208 O and \u03c6 \u2208 C 2 (O) such that y0 is a maximizer\nof V (0)\u2217 \u2212 \u03c6 on O with V (0)\u2217 (y0 ) = \u03c6(y0 ). Without loss of generality we can\nassume that y0 is a strict local maximum, that is, there exists \u03b4 > 0 such that\ny0 is maximum of V (0)\u2217 \u2212 \u03c6 over B\u03b4 (y0 ) \u2282 O. Let (yn ) be a sequence in B\u03b4 (y0 )\nsuch that yn \u2192 y0 and\nlim V (0) (yn ) = V (0)\u2217 (y0 ).\n\nn\u2192\u221e\n\nRecall that V (k) is continuous and is the unique viscosity solution of\nn\no\nmin \u03b2\u03c6 \u2212 A\u03c6, \u03c6 \u2212 M(k) \u03c6 = 0,\n\n(4.1)\n\n\f24\n\nM. JUNCA\n\nfor all k > 0. Let yk be a maximum of V (k) \u2212 \u03c6 over B\u03b4 (y0 ) and let y 0 be a\nlimit point of (yk ) as k \u2192 0. For all k and all n we have that\nV (k) (yn ) \u2212 \u03c6(yn ) \u2264 V (k) (yk ) \u2212 \u03c6(yk ) \u2264 V (0) (yk ) \u2212 \u03c6(yk ).\nBy lemma 4.1, taking k \u2192 0 along the sequence such that yk \u2192 y 0 , we have\nthat for all n\nV (0) (yn ) \u2212 \u03c6(yn ) \u2264 V (0)\u2217 (y 0 ) \u2212 \u03c6(y 0 ).\nTaking n \u2192 \u221e we obtain that\nV (0)\u2217 (y0 ) \u2212 \u03c6(y0 ) \u2264 V (0)\u2217 (y 0 ) \u2212 \u03c6(y 0 )\nand therefore y 0 = y0 since y0 is a strict local maximum. Thus, yk \u2192 y0 as\nk \u2192 0. Let \u000f > 0 , since V (0) (yn ), \u03c6(yn ) \u2192 \u03c6(y0 ), then for a fix n large enough\n\u03c6(yn ) \u2212 V (0) (yn ) \u2264 \u000f and for k small enough V (0) (yn ) \u2212 V (k) (yn ) \u2264 \u000f. Hence\n\u03c6(yk ) \u2212 V (k) (yk ) \u2264 \u03c6(yn ) \u2212 V (k) (yn ) \u2264 2\u000f.\nThe above shows that yk is a local maximum of V (k) \u2212 \u03c6(k) over B\u03b4 (y0 ) where\nV (k) (yk ) = \u03c6(k) (yk ), \u03c6(k) = \u03c6 \u2212 \u000fk and 0 < \u000fk \u2192 0 as k \u2192 0. Since V (k) is\nsubsolution of (4.1), we can consider two cases:\n\u2022 There exists a sequence such that \u03b2\u03c6(k) (yk ) \u2212 A\u03c6(k) (yk ) = \u03b2V (k) (yk ) \u2212\nA\u03c6(k) (yk ) \u2264 0. Taking k \u2192 0 along the sequence we have that\n\u03b2V (0)\u2217 (y0 ) \u2212 A\u03c6(y0 ) = \u03b2\u03c6(y0 ) \u2212 A\u03c6(y0 ) \u2264 0\nand V (0) is subsolution.\n\u2022 For all k small enough \u03b2\u03c6(k) (yk ) \u2212 A\u03c6(k) (yk ) > 0. This implies that there\nexists 0 \u2264 \u03b6k \u2264 xk such that\nMV (k) (yk ) = V (k) (xk \u2212 \u03b6k , \u03b1(\u03b6k , pk )) + \u03b6k \u03b1(\u03b6k , pk ) \u2212 k \u2265 \u03c6(k) (yk ). (4.2)\nLet \u03b6 0 be a limit point of (\u03b6k ) as k \u2192 0. We claim that \u03b6 0 = 0: Suppose\n\u03b6 0 > 0, then for k small enough such that 0 < \u03b6 0 /2 < \u03b6k\nMV (k) (yk ) \u2265 V (k) (xk \u2212 \u03b6 0 /2, \u03b1(\u03b6 0 /2, pk )) + \u03b1(\u03b6 0 /2, pk )\u03b6 0 /2 \u2212 k\n\u2265 V (k) (xk \u2212 \u03b6k , \u03b1(\u03b6k , pk )) + \u03b1(\u03b6 0 /2, pk )\u03b6 0 /2 + \u03b1(\u03b6k , pk )(\u03b6k \u2212 \u03b6 0 /2) \u2212 2k\n= MV (k) (yk ) + \u03b6 0 /2[\u03b1(\u03b6 0 /2, pk ) \u2212 \u03b1(\u03b6k , pk )] \u2212 k.\nwhere the second inequality follows from (2.4) and the definition of V (k) .\nNow, since \u03b1 is strictly decreasing in \u03b6 (otherwise condition (2.4) cannot\nhold) we can choose k small such that \u03b6 0 /2[\u03b1(\u03b6 0 /2, pk ) \u2212 \u03b1(\u03b6k , pk )] > k\nand we get a contradiction.\nSince \u03b6k \u2192 0, for k small we have that (xk \u2212 \u03b6k , \u03b1(\u03b6k , pk )) \u2208 B\u03b4 (y0 ).\nTherefore, from (4.2) we have that \u03c6(k) (xk \u2212 \u03b6k , \u03b1(\u03b6k , pk )) + \u03b6k \u03b1(\u03b6k , pk ) \u2212\nk \u2265 \u03c6(k) (yk ), that is the same as\n\u03c6(xk \u2212\u03b6k , \u03b1(\u03b6k , pk ))+\u03b6k \u03b1(\u03b6k , pk ) > \u03c6(xk \u2212\u03b6k , \u03b1(\u03b6k , pk ))+\u03b6k \u03b1(\u03b6k , pk )\u2212k \u2265 \u03c6(yk ).\n(4.3)\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n25\n\nIf we consider, for each k, the map \u03b6 7\u2192 \u03c6(xk \u2212 \u03b6, \u03b1(\u03b6, pk )) + \u03b6\u03b1(\u03b6, pk ),\n(4.3) implies that there exists \u03b6\u0302k \u2208 (0, \u03b6k ) such that\n0\u2264\n\n\u2202\u03b1\n\u2202\u03c6\n\u2202\u03c6\n\u2202\u03b1\n(\u03b6\u0302k , pk ) (xk \u2212\u03b6\u0302k , \u03b1(\u03b6\u0302k , pk ))\u2212 (xk \u2212\u03b6\u0302k , \u03b1(\u03b6\u0302k , pk ))+\u03b1(\u03b6\u0302k , pk )+\u03b6\u0302k\n(\u03b6\u0302k , pk ).\n\u2202\u03b6\n\u2202p\n\u2202x\n\u2202\u03b6\n\nTaking k \u2192 0\n0 \u2264 \u2212\u03b3(p0 )\n\n5\n\n\u2202\u03c6\n\u2202\u03c6\n(y0 ) \u2212\n(y0 ) + p0 .\n\u2202p\n\u2202x\n\nComputational Examples\n\nWe are going to present different choices of price processes. Throughout this\nsection we will consider the price impact function:\n\u03b1(x, p) = pe\u2212\u03bbx\n\u03b3(p) = \u03bbp\nIn the following examples, analytical solutions for V do not seem easy to find,\nso we used an implicit numerical scheme following chapter 6 in [Kushner and\nDupuis, 1992]. In particular, we used the Gauss-Seidel iteration method for\napproximation in the value space. Additionally, for the impulse control case we\nfollowed the iterative procedure described in [\u00d8ksendal and Sulem, 2005].\n\n5.1\n\nImpulse control with positive fixed transaction cost\n\nConsider the price process following a geometric Brownian motion with \u03bc < \u03b2\nso that the value function is finite. Figure 1 shows the contour plot of the\noptimal number of shares the investor need to trade. The figure also shows the\noptimal strategy when the investor starts with 5 shares at a price of 2. At time\n0, the investor needs to trade three times until the state variable enters the\ncontinuation region C (i.e. when the optimal number of shares is 0).When k is\nsmaller, the number of trades at time 0 increases and the continuation region\nshrinks. When k = 0 we obtain the situation described in theorem 3.3.\n\n5.2\n\nSingular control\n\nConsider the case when the price process follows an arithmetic Brownian motion.\nThen the price dynamics are\ndPt = \u03bcdt + \u03c3dBt \u2212 \u03bbPt d\u03bet ,\nwith \u03c3 > 0. In this case the value function is always finite, regardless of \u03bc,\ndue to the exponential decay of the discount factor. Since 0 is an absorbing\n\n\f26\n\nM. JUNCA\n\nFigure 1: Optimal number of shares with parameters \u03bb = 0.5, \u03bc = 2, \u03c3 = 1,\n\u03b2 = 4 and k = 0.2.\n\nboundary for this process the boundary conditions are given by (2.17). Figure\n2(a) shows the value function obtained by the scheme.\nFirst note that the conditions of Theorem 3.3 are not satisfied, that is\nU (x, p) 6= xp, and therefore T =\n6 O, as shown in figure 2(b). Thus, in this\ncase the optimal strategy would be to trade very fast in the trading region until\nthe state variable hit the free boundary. The figure also shows how the different\nparameters affect the continuation/trade regions. Now, let's see how the change\nin the parameters of the model affect the value function V . Figure 3(a) shows\nthat the value function is very sensitive to changes in the parameter \u03bb for small\nvalues but not so much for large values. This behavior is common to both processes GBM (described by theorem 3.3) and BM. This means that the bigger\nthe investor (i.e. the larger the price impact) the less sensitive to small changes\nin the value of \u03bb. Clearly the value function decreases as the impact increases.\nIf \u03b2 = 0, the value function would not be finite for any \u03bc > 0, so small values\nof \u03b2 yield a very large value of V . As \u03b2 increases the effect in V is diminishing.\nAlso, the investor has to act greedily and therefore the trade region approaches\nto O and V approaches to W .\nFor \u03bc \u2264 0 it is not optimal to wait at all, so V = W , but as \u03bc increases\nclearly the value function increases in an almost linear fashion.\nThe effect of \u03c3 in the value function is probably the most interesting one. In\nfigure 3(d) we see that it is beneficial for the investor to have some variance in\nthe asset but not too much. An explanation for this is that when the variance\nincreases it is more likely for the price process to enter the trading region. On\nthe other hand, if the variance is too big, the process can hit 0 too fast. Clearly\nthe variance of the revenue increases with \u03c3, thus as part of future research it\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n(a) Value function in the BM case with parameters \u03bb =\n0.5, \u03bc = 4, \u03c3 = 0.5 and \u03b2 = 1.\n\n(b) Continuation-trade region in the BM case. The solid\nline shows the contour with parameters \u03bb = 0.5, \u03bc = 4,\n\u03c3 = 0.5 and \u03b2 = 1. In the other lines only the indicated\nparameter has been changed.\n\nFigure 2: Value function and continuation-trade region in the BM case.\n\n27\n\n\f28\n\nM. JUNCA\n\n(a) Change in V (5, 2) as \u03bb varies and \u03bc = 4, (b) Change in V (5, 2) as \u03b2 varies and \u03bc =\n\u03c3 = 0.5 and \u03b2 = 1.\n4, \u03c3 = 0.5 and \u03bb = 0.5.\n\n(c) Change in V (5, 2) as \u03bc varies and \u03bb = (d) Change in V (5, 2) as \u03c3 varies and \u03bc =\n0.5, \u03c3 = 0.5 and \u03b2 = 1.\n4, \u03bb = 0.5 and \u03b2 = 1.\n\nFigure 3: Change in the parameters of the model BM.\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n29\n\nwould be interesting to consider the risk aversion of the investor.\nThe second example is when the price follows the OrnsteinUhlenbeck process.\nThen the price process becomes\ndPt = \u03b1(m \u2212 Pt )dt + \u03c3dBt \u2212 \u03bbPt d\u03bet ,\nwith \u03c3, \u03b1 > 0. As in the case of arithmetic Brownian motion, the boundary\nconditions are given by (2.17), since 0 is an absorbing boundary for this process.\nFigure 4 shows the value function and the continuation-trade region. Again, this\ncase does not fit within Theorem 3.3, so the strategy is similar to the BM case.\nAlso, the sensitivity of the function to the parameters is similar to the previous\ncase. The only parameter that is exclusive to the mean-reverting process is the\nresilience factor \u03b1. As we increase \u03b1 the value function increases (Figure 5(d))\nand the continuation region grows (Figure 4(b)).\n\n6\n\nConclusions\n\nThe main goal of this work was to characterize the value function of the optimal execution strategy in the presence of price impact and fixed transaction\ncost over an infinite horizon. We formulated the problem using two different\nstochastic control settings. In the impulse control formulation we showed that\nthe value function is the unique continuous viscosity solution of the HamiltonJacobi-Bellman equation associated to the problem whenever the transaction\ncost is strictly positive. The second formulation ruled out any transaction cost\nand admitted continuous singular controls only. In this case we also proved\ncontinuity and uniqueness of the value function under the viscosity framework.\nThe next step, part of future research, would be to find the regularity of the\nvalue function. Numerical results provided in this paper, at least for the second\nformulation, suggest that the function is more than just continuous and that\nits regularity is related with the regularity of the function U defined in Section\n2. Although any impulse control is a singular control, in general the expected\nrevenue obtained when applying the same impulse control in both formulation\nis different. However, the value function may be the same. In fact, we were able\nto show that this is the case for a special type of price impact and provide the\nexplicit solution. The question if this is true in general is still unanswered. This\nis particularly challenging since the subsolution property for the HJB equation\n(2.9), when there is no transaction cost, has no information at all. Try to find\nanswers is part of future work. Another important conclusion is that the HJB\nequation for the regular control formulation, (??) has not enough information\nto characterize the solution. From an economic viewpoint, it would be important to study the effect of the price impact in hedging strategies and how they\nare different to the strategies obtained in classical models, e.g. Delta-hedging\nin Black-Scholes setting. Include utility functions to account for risk aversion\nis another important extension of this work. Finally, the finite time horizon\nnatural extension is currently in preparation.\n\n\f30\n\nM. JUNCA\n\n(a) Value function in the OU case with parameters \u03bb =\n0.5, \u03b1 = 4, \u03c3 = 0.5, m = 5 and \u03b2 = 1.\n\n(b) Continuation-trade region in the OU case. The solid\nline shows the contour with parameters \u03bb = 0.5, \u03b1 = 4,\n\u03c3 = 0.5, m = 5 and \u03b2 = 1. In the other lines only the\nindicated parameter has been changed.\n\nFigure 4: Value function and continuation-trade region in the mean-reverting\ncase.\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n(a) Change in V (5, 2) as \u03bb varies and m =\n5, \u03c3 = 0.5, \u03b1 = 4 and \u03b2 = 1.\n\n(b) Change in V (5, 2) as \u03b2 varies and m = (c) Change in V (5, 2) as m varies and \u03b1 =\n5, \u03c3 = 0.5, \u03b1 = 4 and \u03bb = 0.5.\n4, \u03c3 = 0.5, \u03b2 = 1 and \u03bb = 0.5.\n\n(d) Change in V (5, 2) as \u03b1 varies and \u03bb = (e) Change in V (5, 2) as \u03c3 varies and \u03b1 =\n0.5, \u03c3 = 0.5, m = 5 and \u03b2 = 1.\n4, \u03bb = 0.5, m = 5 and \u03b2 = 1.\n\nFigure 5: Change in the parameters of the model OU.\n\n31\n\n\f32\n\nA\n\nM. JUNCA\n\nProof of (MV )\u2217 \u2264 MV \u2217\n\nLet \u03c6 be a locally bounded function on \u014c. Let (yn ) be a sequence in O such\nthat (yn ) \u2192 y0 and\nlim M\u03c6(yn ) = (M\u03c6)\u2217 (y0 ).\nn\u2192\u221e\n\n\u2217\n\nSince \u03c6 is usc and \u0393 is continuous, for each n \u2265 1 there exists 0 \u2264 \u03b6n \u2264 xn\nsuch that\nM\u03c6\u2217 (yn ) = \u03c6\u2217 (\u0393(yn , \u03b6n )) + \u03b6n \u03b1(\u03b6n , pn ) \u2212 k.\nThe sequence (\u03b6n ) is bounded (since xn \u2192 x0 ) and therefore converges along a\nsubsequence to \u03b6 \u2208 [0, x0 ]. Hence\n(M\u03c6)\u2217 (y0 ) = lim M\u03c6(yn )\nn\u2192\u221e\n\n\u2264 lim sup M\u03c6\u2217 (yn )\nn\u2192\u221e\n\n= lim sup \u03c6\u2217 (\u0393(yn , \u03b6n )) + \u03b6n \u03b1(\u03b6n , pn ) \u2212 k\nn\u2192\u221e\n\u2217\n\n\u2264 \u03c6 (\u0393(y0 , \u03b6)) + \u03b6\u03b1(\u03b6, p0 ) \u2212 k\n\u2264 M\u03c6\u2217 (y0 ).\n\nReferences\nR. Almgren. Optimal execution with nonlinear impact functions and tradingenhanced risk. Applied Mathematical Finance, 10(1):1\u201318, January 2003.\nR. Almgren and N. Chriss. Optimal execution of portfolio transactions. Journal\nof Risk, 3:5\u201339, 2000.\nP. Bank and D. Baum. Hedging and portfolio optimization in financial markets\nwith a large trader. Math. Finance, 14(1):1\u201318, 2004.\nD. Bertsimas and A. W. Lo. Optimal control of execution costs. Journal of\nFinancial Markets, 1(1):1\u201350, April 1998.\nU. \u00c7etin, R. Jarrow, and P. Protter. Liquidity risk and arbitrage pricing theory.\nFinance Stoch., 8(3):311\u2013341, 2004.\nL.K.C. Chan and J. Lakonishok. The behavior of stock prices around institutional trades. Journal of Finance, 50(4), September 1995.\nM. G. Crandall, H. Ishii, and P. L. Lions. User's guide to viscosity solutions of\nsecond order partial differential equations. Bulletin of the American Mathematical Society, 27(12):1\u201367, July 1992.\nJ. Cvitani\u0107 and J. Ma. Hedging options for a large investor and forwardbackward SDE's. Ann. Appl. Probab., 6(2):370\u2013398, 1996.\n\n\fOPTIMAL EXECUTION WITH PRICE IMPACT\n\n33\n\nM.H.A. Davis and A.R. Norman. Portfolio selection with transaction costs.\nMath. Oper. Res., 15(4):676\u2013713, 1990.\nS. Dayanik and I. Karatzas. On the optimal stopping problem for onedimensional diffusions. Stochastic Processes and their Applications, 107(2):\n173\u2013212, October 2003.\nW.H. Fleming and H.M. Soner. Controlled Markov Processes and Viscosity\nSolutions. Springer, second edition, 2006.\nR. Frey. Perfect option hedging for a large trader. Finance and Stochastics, 2\n(2):115\u2013141, 1998.\nH. He and H. Mamaysky. Dynamic trading policies with price impact. Journal\nof Economic Dynamics and Control, 29(5):891\u2013930, 2005.\nR.W. Holthausen, R. Leftwich, and D. Mayers. Large-block transactions, the\nspeed of response, and temporary and permanent stock-price effects. Journal\nof Financial Economics, 26(1):71\u201395, July 1990.\nH. Ishii and P. L. Lions. Viscosity solutions of fully nonlinear second-order\nelliptic partial differential equations. Journal of Differential Equations, 83\n(1):26 \u2013 78, 1990.\nK. Ishii. Viscosity solutions of nonlinear second order elliptic pdes associated\nwith impulse control problems. Funkcialaj Ekvacioj, 36:123\u2013141, 1993.\nY. Ishikawa. Optimal control problem associated with jump processes. Applied\nMathematics and Optimization, 50(1):21\u201365, 2004.\nR. Korn. Portfolio optimisation with strictly positive transaction costs and\nimpulse control. Finance and Stochastics, 2(2):85\u2013114, 1998.\nH. Kushner and P. Dupuis. Numerical methods for stochastic control problems\nin continuous time. Springer-Verlag, New York, 1992.\nV. Ly Vath, M. Mnif, and H. Pham. A model of optimal portfolio selection\nunder liquidity risk and price impact. Finance Stoch., 11(1):51\u201390, 2007.\nJin Ma and Jiongmin Yong. Dynamic programming for multidimensional\nstochastic control problems. Acta Mathematica Sinica, 15:485\u2013506, 1999.\nISSN 1439-8516.\nB. \u00d8ksendal and K. Reikvam. Viscosity solutions of optimal stopping problems.\nStochastics An International Journal of Probability and Stochastic Processes:\nformerly Stochastics and Stochastics Reports, 62(3):285\u2013 301, 1998.\nB. \u00d8ksendal and A. Sulem. Optimal consumption and portfolio with both fixed\nand proportional transaction costs. SIAM Journal on Control and Optimization, 40(6):1765\u20131790, 2002.\n\n\f34\n\nM. JUNCA\n\nB. \u00d8ksendal and A. Sulem. Applied Stochastic Control of Jump Diffusions.\nSpringer, 2005.\nP. Protter. Stochastic Integration and Differential Equations. Springer-Verlag,\nBerlin, second edition, 2004.\nA. Schied and T. Sch\u00f6neborn. Risk aversion and the dynamics of optimal liquidation strategies in illiquid markets. Finance Stoch., 13(2):181\u2013204, 2009.\nA. Schied, T. Sch\u00f6neborn, and M. Tehranchi. Optimal Basket Liquidation for\nCARA Investors is Deterministic. Applied Mathematical Finance, 17:471\u2013489,\n2010.\nA. Subramanian and R. Jarrow. The liquidity discount. Mathematical Finance,\n11(4):447\u2013474, 2001.\n\n\f"}