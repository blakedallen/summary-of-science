{"id": "http://arxiv.org/abs/0906.3628v2", "guidislink": true, "updated": "2009-06-22T04:01:58Z", "updated_parsed": [2009, 6, 22, 4, 1, 58, 0, 173, 0], "published": "2009-06-19T10:14:53Z", "published_parsed": [2009, 6, 19, 10, 14, 53, 4, 170, 0], "title": "Equivariant Matlis and the local duality", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0906.2104%2C0906.3459%2C0906.4521%2C0906.3628%2C0906.0402%2C0906.1223%2C0906.5300%2C0906.0215%2C0906.3277%2C0906.1158%2C0906.5249%2C0906.4798%2C0906.0154%2C0906.3569%2C0906.0012%2C0906.4278%2C0906.4317%2C0906.5306%2C0906.0689%2C0906.0216%2C0906.3527%2C0906.0356%2C0906.1077%2C0906.4966%2C0906.4318%2C0906.0111%2C0906.3162%2C0906.2923%2C0906.0697%2C0906.3684%2C0906.3806%2C0906.2872%2C0906.3057%2C0906.1378%2C0906.3791%2C0906.1615%2C0906.1938%2C0906.1903%2C0906.2342%2C0906.0135%2C0906.5299%2C0906.0567%2C0906.2202%2C0906.5582%2C0906.3828%2C0906.0040%2C0906.0488%2C0906.0623%2C0906.3503%2C0906.1366%2C0906.0611%2C0906.1099%2C0906.0857%2C0906.1244%2C0906.2361%2C0906.0143%2C0906.2411%2C0906.1060%2C0906.0544%2C0906.2138%2C0906.4213%2C0906.0764%2C0906.3738%2C0906.2590%2C0906.0556%2C0906.3066%2C0906.0436%2C0906.3583%2C0906.4824%2C0906.2347%2C0906.3122%2C0906.0438%2C0906.3193%2C0906.1863%2C0906.2696%2C0906.1360%2C0906.5512%2C0906.3598%2C0906.2604%2C0906.0447%2C0906.2052%2C0906.4763%2C0906.0145%2C0906.2157%2C0906.1081%2C0906.0564%2C0906.3112%2C0906.3872%2C0906.2213%2C0906.3856%2C0906.5297%2C0906.2209%2C0906.2082%2C0906.0029%2C0906.0520%2C0906.0737%2C0906.5107%2C0906.3746%2C0906.4345%2C0906.5546%2C0906.3319&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Equivariant Matlis and the local duality"}, "summary": "Generalizing the known results on graded rings and modules, we formulate and\nprove the equivariant version of the local duality on schemes with a group\naction. We also prove an equivariant analogue of Matlis duality.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0906.2104%2C0906.3459%2C0906.4521%2C0906.3628%2C0906.0402%2C0906.1223%2C0906.5300%2C0906.0215%2C0906.3277%2C0906.1158%2C0906.5249%2C0906.4798%2C0906.0154%2C0906.3569%2C0906.0012%2C0906.4278%2C0906.4317%2C0906.5306%2C0906.0689%2C0906.0216%2C0906.3527%2C0906.0356%2C0906.1077%2C0906.4966%2C0906.4318%2C0906.0111%2C0906.3162%2C0906.2923%2C0906.0697%2C0906.3684%2C0906.3806%2C0906.2872%2C0906.3057%2C0906.1378%2C0906.3791%2C0906.1615%2C0906.1938%2C0906.1903%2C0906.2342%2C0906.0135%2C0906.5299%2C0906.0567%2C0906.2202%2C0906.5582%2C0906.3828%2C0906.0040%2C0906.0488%2C0906.0623%2C0906.3503%2C0906.1366%2C0906.0611%2C0906.1099%2C0906.0857%2C0906.1244%2C0906.2361%2C0906.0143%2C0906.2411%2C0906.1060%2C0906.0544%2C0906.2138%2C0906.4213%2C0906.0764%2C0906.3738%2C0906.2590%2C0906.0556%2C0906.3066%2C0906.0436%2C0906.3583%2C0906.4824%2C0906.2347%2C0906.3122%2C0906.0438%2C0906.3193%2C0906.1863%2C0906.2696%2C0906.1360%2C0906.5512%2C0906.3598%2C0906.2604%2C0906.0447%2C0906.2052%2C0906.4763%2C0906.0145%2C0906.2157%2C0906.1081%2C0906.0564%2C0906.3112%2C0906.3872%2C0906.2213%2C0906.3856%2C0906.5297%2C0906.2209%2C0906.2082%2C0906.0029%2C0906.0520%2C0906.0737%2C0906.5107%2C0906.3746%2C0906.4345%2C0906.5546%2C0906.3319&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Generalizing the known results on graded rings and modules, we formulate and\nprove the equivariant version of the local duality on schemes with a group\naction. We also prove an equivariant analogue of Matlis duality."}, "authors": ["Mitsuyasu Hashimoto", "Masahiro Ohtani"], "author_detail": {"name": "Masahiro Ohtani"}, "author": "Masahiro Ohtani", "arxiv_comment": "32pages, corrected a typo", "links": [{"href": "http://arxiv.org/abs/0906.3628v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0906.3628v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AC", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AC", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "14L30, 13D45", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0906.3628v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0906.3628v2", "journal_reference": "J. Algebra 324 (2010), 1447--1470", "doi": null, "fulltext": "arXiv:0906.3628v2 [math.AC] 22 Jun 2009\n\nEquivariant Matlis and the local duality\nMitsuyasu Hashimoto and Masahiro Ohtani\nGraduate School of Mathematics, Nagoya University\nChikusa-ku, Nagoya 464\u20138602 JAPAN\nhasimoto@math.nagoya-u.ac.jp\n\nm05011w@math.nagoya-u.ac.jp\n\nAbstract\nGeneralizing the known results on graded rings and modules, we\nformulate and prove the equivariant version of the local duality on\nschemes with a group action. We also prove an equivariant analogue\nof Matlis duality.\n\n1.\n\nIntroduction\n\nThis paper is a continuation of [9], and study equivariant local cohomology.\nIn this paper, utilizing an equivariant dualizing complex, we define the Gsheaf of matlis, an equivariant analogue of the injective hull of the residue\nfield of a local ring. Using this, we formulate and prove Matlis and the local\nduality under equivariant settings.\nLet R be a Gorenstein local ring, T = R[x1 , . . . , xs ] be the graded polynomial ring with ri := deg xi positive, I a homogeneous ideal of height h,\nand A := T /I. Assume that\nP A is Cohen\u2013Macaulay of dimension d. Set\n\u03c9T := T (\u2212r), where r = i ri , and (\u2212r) denotes the shift of degree. Set\nL\n\u2020\n\u03c9A := ExthT (A, \u03c9T ). For a graded A-module M, set M \u2228 :=\ni\u2208Z M\u2212i ,\n\u2020\nwhere (?) = HomR (?, ER ), where ER is the injective hull of the residue\nfield of R. Note that M \u2228 is a graded A-module again. Note also that\n\u2217\nHomA (M, A\u2228 ) \u223c\n= M \u2228 (see for the notation \u2217 Hom, [1, page 33]).\nFor a finite graded A-module M, we have an isomorphism of graded Amodules\ni\n\u2228\nHM\n(M) \u223c\n= Extd\u2212i\nA (M, \u03c9A ) ,\ncf. [1, Theorem 3.6.19], see also Corollary 5.5.\n1\n\n\fThe main purpose of this paper is to generalize this graded version of\nlocal duality to more general equivariant local duality. Note that a graded\nmodule over a Z-graded ring is nothing but an equivariant module under\nthe action of Gm = GL1 , see [6, (II.1.2)]. On the way, we prove some basic\nproperties on equivariant local cohomology.\nIn this introduction, let S be a noetherian scheme, G a flat S-group\nscheme of finite type, and X a noetherian G-scheme. In order to establish an\nanalogy of the local duality on X, we need to define an equivariant analogue\nof a local ring or a local scheme. This is done in [9], and it is a G-local\nG-scheme. So let X be a G-local G-scheme. That is to say, X has a unique\nminimal nonempty G-stable closed G-subscheme, say Y . Next, we need to\nhave an equivariant analogue of local cohomology. This is the main subject\nof [9]. Finally, we need to have an analogy of the Matlis duality. In other\nwords, we need to have an analogue of the injective hull of the residue field\nof a local ring. The authors do not know how to define it quite generally.\nHowever, if X has a G-equivariant dualizing complex (see for the definition,\n[7, chapter 31]) IX , then we can define it as the unique nonzero cohomology\ngroup of R \u0393Y (IX ). We call this sheaf the G-sheaf of Matlis. Thus we can formulate the equivariant local duality. The proof depends on the isomorphism\nH, see below.\nMany ideas used in this paper have already appeared in the theory of\ngraded rings [3], [4], [1], [10]. If H is a finitely generated abelian group, then\nletting G = Spec ZH, where ZH is the group algebra of H over Z, an Hgraded algebra is nothing but a G-algebra, and for a G-algebra A, a graded\nA-module is nothing but a (G, A)-module. However, we need to point out\nthat for a general G and a G-local G-algebra (A, M) with the G-dualizing\ncomplex I, the global section of the G-sheaf of Matlis EA is not necessarily\ninjective as a (G, A)-module, see Example 5.7. In particular, EA is not the\ninjective hull of A/M in the category of (G, A)-modules.\nUsing the G-sheaf of Matlis, we can prove a weak version of the Matlis\nduality, too. It is a duality from the category of coherent (G, OX )-modules\nof finite length to itself, see Theorem 4.17. Note that a better Matlis duality\nexists over a complete local ring. It is a duality from the category of noetherian modules to the category of artinian modules ([1, Theorem 3.2.13]). The\nauthors do not know a good analogue of a complete local ring, and thus\ncannot give an equivariant Matlis duality between noetherian quasi-coherent\n(G, OX )-modules and artinian modules in general. However, there is an example of graded case of that kind of duality, see Remark 5.6.\n2\n\n\fSection 2 is preliminaries. We give some basic properties of the duality\nmap in a closed category. We also give some sufficient conditions to guarantee that injective objects in the category Qch(G, X) is acyclic with respect\nto some cohomological functors. We also prove a generalization of the flat\nbase change ([9, Theorem 6.10]), see Lemma 2.14. We also describe the local cohomology over a diagram of schemes using the inductive limit of Ext\ngroups, as in the single-scheme case.\nSection 3 treats the map H. For a small category I, an I op -diagram of\nschemes X, an open subdiagram of schemes U of X, and an open subdiagram\nof schemes V of U, there is a natural map\nH : \u0393U,V HomOX (M, N ) \u2192 HomOX (M, \u0393U,V N )\nfor M, N \u2208 Mod(X). There is an obvious derived version of it, and H\nis often an isomorphism (see Lemma 3.16 and Theorem 3.26). This is the\nkey to the proof of the equivariant version of the local duality. In order\nto establish the existence and some basic properties of H, we need to prove\nvarious commutativity of diagrams. To do this, we utilize the basics on closed\ncategories as in [7, chapter 1].\nIn section 4, we formulate and prove the equivariant analogues of Matlis\nand the local duality. We start with Matijevic\u2013Roberts type theorem for\nG-local G-schemes, and prove an equivariant version of Nakayama's lemma,\nwhich is well-known for affine case.\nIn section 5, we give an example of the graded case. Note that in some\ncases, Matlis duality can be in more general form than the version described\nin section 4, see Remark 5.6.\n2.\n\nPreliminaries\n\n(2.1) We use the notation and terminology of [7], [9], and [8] freely.\n(2.2) Let X be a symmetric monoidal closed category (see [11, (3.5.1)]),\nand b, d \u2208 X. Then we denote the composite map\ntr\n\n\u03b3\n\nev\n\nb\u2212\n\u2192 [[b, d], b \u2297 [b, d]] \u2212\n\u2192 [[b, d], [b, d] \u2297 b] \u2212\n\u2192 [[b, d], d]\nby D, and we call it the duality map, where tr, \u03b3, and ev denote the trace\nmap [7, (1.30)], the twisting (symmetry) isomorphism [7, (1.28)], and the\nevaluation map [7, (1.30)], respectively.\n3\n\n\f2.3 Lemma. D is natural on b. Namely, for a morphism \u03c6 : b \u2192 b\u2032 , the\ndiagram\n\u03c6\n\nb\n\n/\n\nb\u2032\n\nD\n\nD\n\n\u000f\n\n[[b, d], d]\n\n\u03c6\n\n\u000f\n\n[[b\u2032 , d], d]\n/\n\nis commutative.\nProof. Consider the diagram\ntr\n/ [[b, d], b \u2297 [b, d]]\nkkk b\nk\nk\nk\nk\nk\n\u03c6 kk\nkk\n(a)\n\u03c6\n(b)\ntr\nkkk\nk\nk\nk\n\u000f\n\u000f\nk\n\u03c6\nu kk\nk\n/ [[b\u2032 , d], b \u2297 [b, d]]\n(c) [[b\u2032 , d], b \u2297 [b\u2032 , d]]\nb\u2032\nk\nk\nk\nkkk\n\u03c6 kkkk\nkkk\nk\nk\nk\n(d)\ntr\nk\nk\nkk ev \u03b3\nkk\n\u000f\nukkk\nukkk\n\u03c6\nev \u03b3\n\u2032\n\u2032\n\u2032\n\u2032\no\n/\n[[b , d], d]\n[[b, d], d] o\n[[b , d], b \u2297 [b , d]]\n\n.\n\nED\nev \u03b3\n\nBC\n\n(a) and (d) are commutative by [7, Lemma 1.32]. The commutativity of (b)\nand (c) are trivial.\n2.4 Lemma. For a morphism \u03c8 : d \u2192 d\u2032 , the diagram\nD\n\nb\n\n/\n\n[[b, d], d]\n\u03c8\n\nD\n\n\u000f\n\n[[b, d\u2032 ], d\u2032 ]\n\n\u03c8\n\n/\n\n\u000f\n\n[[b, d], d\u2032 ]\n\nis commutative.\nProof. Consider the diagram\ntr\n\nb\ntr\n\n\u000f\n\n[[b, d\u2032 ], b \u2297 [b, d\u2032 ]]\nev \u03b3\n\n/ [[b, d], b \u2297 [b, d]]\n(a)\n\u03c8\n\n/\n\n\u03c8\n\n\u000f\n\n(c)\n\u03c8\n\n[[b, d\u2032 ], d\u2032]\n\n/\n\n[[b, d], d] .\n\n(b)\n\n[[b, d], b \u2297 [b, d\u2032 ]]\n\n\u000f\n\nev \u03b3\n\n\u03c8\n\nPPP\nPPPev \u03b3\nPPP\nPPP\n\u000f\n(\n/ [[b, d], d\u2032 ]\n\n(a) is commutative by [7, Lemma 1.32]. (b) and (c) are obviously commutative. Hence the whole diagram is commutative.\n4\n\n\f2.5 Lemma. Let f : X \u2192 Y be a symmetric monoidal functor [11, (3.4.2)]\nbetween symmetric monoidal closed categories. For b, d \u2208 X, the diagram\nD\n\nfb\n\n/\n\nf [[b, d], d]\nH\n\nD\n\n\u000f\n\n[[f b, f d], f d]\n\nH\n\n\u000f\n\n[f [b, d], f d]\n/\n\nis commutative.\nProof. Consider the diagram\nGF\n\ntr\n\n[[f b, f d], f b \u2297 [f b, f d]] o\n(a)\n\nH\n\n\u000f\n\nH\n\n[f [b, d], f b \u2297 [f b, f d]] o\nev \u03b3\n\nev \u03b3\n\n(b)\n\n[f [b, d], f d] o\nO\n\n@A\n/\n\nH\n\nev \u03b3\n\nED\n\ntr\n\n\u000f\n\n[f [b, d], f b \u2297 f [b, d]]\n\n(c)\n\nm\n\n(d)\n\n\u000f\n\ntr\n\nfb\n\n\u000f\n\n[f [b, d], f (b \u2297 [b, d])] o\n\njUUUU\nUUUUH\nUUUU\nUUUU\nU\n\n[[f b, f d], f d]\n\nH\n(e)\n\nf [[b, d], d] o\n\nev \u03b3\n\n\u000f\n\nf [[b, d], b \u2297 [b, d]]\nBC\n\n(a) is commutative by [7, (1.32)]. The commutativity of (b) is trivial. (c)\nis [7, (1.37)] and is commutative. (d) is [7, (1.36)] and is commutative. (e)\nis commutative by the naturality of H.\n(2.6) A symmetric monoidal functor f : X \u2192 Y is said to be Lipman if it\nhas a left adjoint g : Y \u2192 X such that the natural maps \u2206 : g(b\u2297d) \u2192 gb\u2297gd\nand C : gOY \u2192 OX are isomorphisms, see [7, (1.48)]. We also say that (f, g)\nis a Lipman adjoint pair in this case.\nBy Lemma 2.5, we have:\n2.7 Lemma. Let f : X \u2192 Y and g : Y \u2192 X be a Lipman adjoint pair where\nX and Y are closed. Then the diagram\ngb\u2032\n\nD\n\n/\n\ng[[b\u2032 , d\u2032], d\u2032 ]\nP\n\nD\n\n\u000f\n\n[[gb\u2032 , gd\u2032], gd\u2032]\n\nP\n\nis commutative.\n5\n\n/\n\n\u000f\n\n[g[b\u2032 , d\u2032], gd\u2032]\n\n.\n\n\f(2.8) Let (X, OX ) be a ringed category. That is, X is a small category, and\nOX is a presheaf of commutative rings on X. Then for M, N \u2208 PM(X), the\nmap\nD : M \u2192 HomPM(X) (HomPM(X) (M, N ), N )\nis described as follows. At x \u2208 X,\nD : \u0393(x, M) \u2192 \u0393(x, HomPM(X) (HomPM(X) (M, N ), N ))\n\n= HomPM(X)/x (HomPM(X) (M, N )|x, N |x ))\n\nis given as follows. For a \u2208 \u0393(x, M), D(a) : HomPM(X) (M, N )|x \u2192 N |x is\nthe map such that for \u03c6 : y \u2192 x, D(a)\u03c6 : HomPM(X/y) (M|y , N |y ) \u2192 \u0393(y, N )\nis given by D(a)\u03c6 (h) = h(a). This is proved easily using [7, (2.42)] and [7,\n(2.41)].\n(2.9) Let (X, OX ) be a ringed site, and M, N \u2208 Mod(X). Then the map\nD : M \u2192 HomOX (HomOX (M, N ), N )\nis exactly the same map as the one described in (2.8). This follows from [7,\n(2.49)], Lemma 2.5, and (2.8).\n(2.10) In the rest of this paper, S denotes a scheme, and G an S-group\nscheme. We write diagrams of schemes as X, Y , Z, . . . (not as X\u2022 , Y\u2022 , Z\u2022 , . . .).\nSimilarly, morphisms of diagrams of schemes are expressed as f , g, h, . . ., not\nas f\u2022 , g\u2022 , h\u2022 , . . . This is a convention in [9].\n2.11 Lemma. Let I be a small category, and f : X \u2192 Y be a concentrated\n(i.e., quasi-compact quasi-separated) morphism of I op -diagrams of schemes.\nLet (C\u03b1 ) be a pseudo-filtered inductive system of complexes of OX -modules\nsuch that for each j \u2208 I, one of the following holds:\n(a) There exists some nj \u2208 Z such that for any \u03b1, \u03c4 \u2264nj \u22121 (C\u03b1 )j is exact (see\nfor the definition of \u03c4 \u2264nj \u22121 , see [7, (3.24)]);\n(b) Each point of Xj has a noetherian open neighborhood of finite Krull\ndimension.\n(c) For any \u03b1, C\u03b1,j has quasi-coherent cohomology groups.\n\n6\n\n\fSet C = lim C\u03b1 . Then the canonical map\n\u2212\u2192\n\nlim Ri f\u2217 C\u03b1 \u2192 Ri f\u2217 C\n\u2212\u2192\nis an isomorphism for i \u2208 Z. If, moreover, each C\u03b1 is f\u2217 -acyclic, then C is\nf\u2217 -acyclic.\n\n(1)\n\nProof. In view of [7, Example 8.23, 2], it is easy to see that it suffices to\nshow that\nlim Ri (fj )\u2217 C\u03b1,j \u2192 Ri (fj )\u2217 Cj\n\u2212\u2192\nis an isomorphism for each j, to prove that (1) is an isomorphism. This is\n(3.9.3.1) and (3.9.3.2) of [11].\nTo prove the last assertion, it suffices to show that each Cj is (fj )\u2217 -acyclic.\nThis is [11, (3.9.3.4)].\n2.12 Corollary. Let f : X \u2192 Y be as in Lemma 2.11. Let C be a complex of\nOX -modules such that each term of C is locally quasi-coherent and f\u2217 -acyclic.\nThen C is f\u2217 -acyclic.\nProof. Similar to [11, (3.9.3.5)].\n2.13 Lemma. Let X and Y be S-groupoid (see for the definition, [7, (12.1)])\nand f : X \u2192 Y a morphism (in the category P(\u2206M , Sch/S), see for the\nnotation, [7, Glossary]). Assume that f is cartesian, Y has affine arrows,\nand assume one of the following:\n(a) X0 is noetherian;\n(b) Y0 and f0 are quasi-compact separated.\nThen\n(i) f is concentrated and X0 is concentrated.\n(ii) A K-injective complex I in K(Qch(X)) is f\u2217 -acyclic.\n(iii) The canonical maps\nFY \u25e6 Rf\u2217Qch \u223c\n= R(f\u2217 \u25e6 FX ) \u2192 Rf\u2217 \u25e6 FX\n= R(FY \u25e6 f\u2217Qch ) \u223c\nare all isomorphisms, where FY : D(Qch(Y )) \u2192 D(Y ) and FX :\nD(Qch(X)) \u2192 D(X) are triangulated functors induced by inclusions,\nand f\u2217Qch : Qch(X) \u2192 Qch(Y ) is the restriction of f\u2217 : Mod(X) \u2192\nMod(Y ), see [7, Lemma 7.14].\n7\n\n\fProof. (i) In either case, f0 is concentrated. Since f is cartesian, each fi\n(i = 0, 1, 2) is obtained as a base change of f0 , and hence is concentrated. It\nis easy to see that X0 is concentrated in either case.\n(ii) As f is concentrated cartesian, f\u2217Qch is well-defined [7, Lemma 7.14].\nSince X0 is concentrated and X has affine arrows, Qch(X) is Grothendieck\nby [7, Lemma 12.8]. So I has a strictly injective resolution (that is, a Kinjective resolution each of whose term is injective) J [2, Proposition 3.2]. As\nthe mapping cone of I \u2192 J is null-homotopic, replacing I by J, we may assume\nthat I is strictly injective. By Corollary 2.12, it suffices to show that each\nterm of I is f\u2217 -acyclic. So we may assume that I is a single injective object\nof Qch(X). Let I0 \u2192 K be a monomorphism with K an injective object of\nQch(X0 ). This is possible, since Qch(X0 ) is Grothendieck [7, Corollary 11.7].\nNote that the restriction (?)0 : Qch(X) \u2192 Qch(X0 ) has the right adjoint\n(d0 )Qch\n\u25e6 A, see [7, Lemma 12.11]. As (?)0 is faithful exact, the composite\n\u2217\nQch\nI \u2192 (d0 )Qch\n\u2217 AI0 \u2192 (d0 )\u2217 AK\n\nis a monomorphism into an injective object. This must split, and hence we\nmay further assume that I = (d0 )Qch\n\u2217 AK.\nBy restriction, it suffices to show that Rj (fi )\u2217 Ii = 0 for i = 0, 1, 2 and\nj > 0. Since (?)i A \u223c\n= r0 (i + 1)\u2217 (see for the notation, [7, (9.1)]) and (d0 ) is\naffine,\nRj (fi )\u2217 Ii \u223c\n= Rj (fi )\u2217 d0 (i + 1)\u2217 r0 (i + 1)\u2217 K \u223c\n= Rj (fi \u25e6 d0 (i + 1))\u2217 r0 (i + 1)\u2217 K\n= Rj (d0 (i + 1) \u25e6 fi+1 )\u2217 r0 (i + 1)\u2217 K \u223c\n= d0 (i + 1)\u2217 Rj (fi+1 )\u2217 r0 (i + 1)\u2217 K\n\u223c\n= d0 (i + 1)\u2217 r0 (i + 1)\u2217 Rj (f0 )\u2217 K = 0\n\nfor j > 0 by [7, Lemma 14.6, 1] and its proof. This is what we wanted to\nprove.\n(iii) Follows immediately from (ii).\nThe following is a generalization of [9, Theorem 6.10].\n2.14 Lemma. Let I be a small category, h : X \u2032 \u2192 X a flat morphism of\nI op -diagrams of schemes. Let f : U \u0592\u2192 X be an open subdiagram of schemes,\nand g : V \u0592\u2192 U be an open subdiagram of schemes. Assume that f and g\nare quasi-compact. Let f \u2032 : U \u2032 \u0592\u2192 X \u2032 and g \u2032 : V \u2032 \u0592\u2192 U \u2032 be the base change\nof f and g, respectively. Then \u03b4\u0304 : h\u2217 R \u0393U,V \u2192 R \u0393U \u2032 ,V \u2032 h\u2217 in [9, (6.1)] is an\nisomorphism between functors from DLqc (X) to DLqc (X \u2032 ).\n8\n\n\fProof. As in the proof of [9, Corollary 6.3], we may assume that the problem\nis on single schemes. Consider the map of triangles\nh\u2217 R \u0393U,V\n/\n\nh\u2217 Rf\u2217 f \u2217\n\nR \u0393U \u2032 ,V \u2032 h\u2217\n/\n\n\u000f\n\nRf\u2217\u2032 (f \u2032 )\u2217 h\u2217\n\n/ h\u2217 R \u0393\n\nh\u2217 Rf\u2217 Rg\u2217 g \u2217f \u2217\n\nd\u03b8\n\n\u03b4\u0304\n\n\u000f\n\n/\n\nU,V [1]\n\n.\n\n/\n\ndd\u03b8\u03b8\n\n\u000f\n\nRf\u2217\u2032 Rg\u2217\u2032 (g \u2032)\u2217 (f \u2032 )\u2217 h\u2217\n/\n\n\u000f\n\nR \u0393U \u2032 ,V \u2032 h\u2217 [1]\n\nBy [11, Proposition 3.9.5], the vertical arrows d\u03b8 and dd\u03b8\u03b8 are isomorphisms.\nHence, \u03b4\u0304 is also an isomorphism.\n(2.15) Let I be a small category, X an I op -diagram of schemes, and Y a\ncartesian closed subdiagram of schemes of X defined by the quasi-coherent\nideal sheaf I of OX . Assume that X is locally noetherian with flat arrows.\nThen, the canonical map\n\u03a6Y : lim HomOX (OX /I n , M) \u2192 \u0393Y M\n\u2212\u2192\nis an isomorphism for M \u2208 Lqc(X), see [9, (3.21)]. By the way-out lemma\n[5, Proposition I.7.1], we have\n+\n2.16 Lemma. Let the notation be as in (2.15). Then for F \u2208 DLqc\n(X),\n\n\u03a6Y : R(lim HomOX (OX /I n , ?))(F) \u2192 R \u0393Y F\n\u2212\u2192\nis an isomorphism. In particular, \u03a6Y induces an isomorphism\nlim ExtiOX (OX /I n , F) \u223c\n= H iY (F).\n\u2212\u2192\n2.17 Lemma. Let X be an S-groupoid with affine arrows. Let U be a cartesian open subdiagram of X, and V a cartesian open subdiagram of Y . Assume\nthat X0 is noetherian. If I is a K-injective complex in K(Qch(X)), then I is\n\u0393U,V -acyclic.\nProof. Using [9, Corollary 6.7], it suffices to show that for an injective object\nK of Qch(X0 ), (d0 )Qch\n\u2217 AK is \u0393U,V -acyclic, as in the proof of Lemma 2.13.\nApplying restrictions, it suffices to show that H jUi ,Vi (d0 (i+1)\u2217 r0 (i+1)\u2217 K) = 0\nfor j > 0 and i = 0, 1, 2. By the independence [9, Corollary 4.17] and the flat\nbase change Lemma 2.14, this sheaf is d0 (i + 1)\u2217 r0 (i + 1)\u2217 H jU0 ,V0 K. Since\nK is also injective in Mod(X) [5, Theorem II.7.18], it is a flabby sheaf, and\nH jU0 ,V0 K = 0.\n9\n\n\f(2.18) A G-scheme X (i.e., an S-scheme with a left G-action) is said to be\nstandard if X is noetherian, and the second projection p2 : G \u00d7 X \u2192 X is\nflat of finite type.\nLet X be a standard G-scheme. We denote the category of quasi-coherent\n(resp. coherent) (G, OX )-modules by Qch(G, X) (resp. Coh(G, X)). Note\nthat the sheaf theory discussed in [7, chapters 29\u201331] and [9], where we\nassume that G is flat of finite type over S, still works under our weaker\nassumption (p2 is flat of finite type). In particular, Qch(G, X) is a locally\nnoetherian category, and M \u2208 Qch(G, X) is a noetherian object if and only\nif M \u2208 Coh(G, X), see [7, Lemma 12.8].\n(2.19) We say that a standard G-scheme X is G-artinian if there is no incidence relation between G-prime G-ideals (see for the definition, [8, (4.12)])\nof X.\n2.20 Lemma. If X is G-artinian, then X is a disjoint union of finitely many\nG-artinian G-local G-schemes.\nProof. Clearly, the set of all G-prime G-ideals SpecG (X) agrees with the\nfinite set MinG (OX ), the set of minimal G-primes of 0. Thus there are\nonly finitely many G-prime G-ideals. For P, Q \u2208 SpecG (X) with P 6= Q,\nAssG (OX /(P + Q)) = \u2205, since there is no G-prime G-ideal\ncontaining both\n`\nP and Q. Thus P + Q = OX . This shows that X = P\u2208SpecG (X) V (P). As\neach V (P) is clearly G-artinian G-local, we are done.\n3.\n\nThe map H\n\n(3.1) Let f : X \u2192 Y be a symmetric monoidal functor between symmetric\nmonoidal closed categories, and g : Y \u2192 X its right adjoint. For b \u2208 Y and\nd \u2208 X, we denote the composite map\nH\n\nu\n\nf [gb, d] \u2212\n\u2192 [f gb, f d] \u2212\n\u2192 [b, f d]\nby \u03b8.\n3.2 Lemma. Let ((?)\u2217 , (?)\u2217 ) be an adjoint pair where (?)\u2217 is a covariant\nmonoidal almost pseudofunctor on a category S and X\u2217 is a symmetric\nmonoidal closed category for X \u2208 S. Then for morphisms f : X \u2192 Y\n\n10\n\n\fand g : Y \u2192 Z of S and b, d \u2208 Z \u2217 , the diagram\n(2)\n\n\u2206\n\n(gf )\u2217(b \u2297 d)\n\n/\n\n(gf )\u2217 b \u2297 (gf )\u2217d\nd\u22121 \u2297d\u22121\n\nd\u22121\n\n\u000f\n\nf \u2217 g \u2217 (b \u2297 d)\n\n\u2206\n\n/\n\nf \u2217 (g \u2217 b \u2297 g \u2217 d)\n\nis commutative.\nProof. Consider the diagram\n\n11\n\n\u2206\n\n/\n\n\u000f\n\nf \u2217g\u2217b \u2297 f \u2217g\u2217d\n\n\f(gf )\u2217 (b \u2297 d)\n\nu\u2297u\n\n(gf )\u2217((gf )\u2217 (gf )\u2217b \u2297 (gf )\u2217(gf )\u2217 d)\n/\n\nd\u22121\nu\u2297u\n\nf \u2217 g \u2217(b \u2297 d)\nu\u2297u\n\nf \u2217 g \u2217(g\u2217 g \u2217b \u2297 g\u2217 g \u2217d)\n\n/\n\nu\u2297u\n\n/\n\nd\u22121 c\n\n(b)\n\nd\u22121 c\n\n(c)\n\n\u000f\n\nf \u2217 g \u2217 (g\u2217 f\u2217 f \u2217 g \u2217 b \u2297 g\u2217 f\u2217 f \u2217 g \u2217d)\n\nd\u22121\n\nm\n\u2217\n\nf g g\u2217 (g b \u2297 g d)\n\nu\u2297u\n\n\u000f\n\n/ f \u2217 g \u2217 g\u2217 (f\u2217 f \u2217 g \u2217 b \u2297 f\u2217 f \u2217 g \u2217 d)\n\n\u03b5\n\n12\n\n\u000f\n\n(gf )\u2217b \u2297 (gf )\u2217d .\n\nf \u2217 g \u2217 ((gf )\u2217(gf )\u2217 b \u2297 (gf )\u2217(gf )\u2217 d)\n\nm\n\u2217\n\n/\n\n\u000f\n\n(a)\n\n\u000f\n\n\u2217 \u2217\n\n\u03b5\n\n/ (gf )\u2217 (gf )\u2217 ((gf )\u2217 b \u2297 (gf )\u2217 d)\n\nd\u22121\n\n\u000f\n\n\u000f\n\nm\n\nf \u2217 (g \u2217b \u2297 g \u2217d)\n\nm\n\n\u000f\n/ f \u2217 g \u2217 g\u2217 f\u2217 (f \u2217 g \u2217 b \u2297 f \u2217 g \u2217 d)\n\n\u03b5\nu\u2297u\n\n/\n\n\u000f\n\nf \u2217 (f\u2217 f \u2217 g \u2217 b \u2297 f\u2217 f \u2217 g \u2217d)\n\n\u03b5\nm\n\n/\n\n\u000f\n\nf \u2217 f\u2217 (f \u2217 g \u2217 b \u2297 f \u2217 g \u2217 d)\n\n\u03b5\n\n/\n\n\u000f\n\nf \u2217g\u2217b \u2297 f \u2217g\u2217d\n\n\f(a) is commutative by [7, Lemma 1.13]. The commutativity of (b) is one of\nour assumptions, see [11, (3.6.7.2)]. (c) is commutative by [7, Lemma 1.14].\nCommutativity of the other squares is trivial. Thus the whole diagram is\ncommutative, and we are done.\n3.3 Lemma. Let f : X \u2192 Y be a symmetric monoidal functor between\nsymmetric monoidal categories, and g : Y \u2192 X its adjoint. For b \u2208 X and\nd \u2208 Y , the diagram\n\u2206\n\ng(f b \u2297 d)\n\n/\n\ngf b \u2297 gd\n\nu\n\n\u000f\n\ng(f b \u2297 f gd)\n\n\u03b5\nm\n\n/ gf (b \u2297 gd)\n\n\u03b5\n\n/\n\n\u000f\n\nb \u2297 gd\n\nis commutative.\nProof. Follows from the commutativity of the diagram\ng(f b \u2297 d)\n\nu\u2297u\n\n/\n\ng(f6 gf b \u2297 f gd)\n\nmm\nummmmm\nu\n\u03b5\nm\nmm\nmmm\n\u000f\n\u000f\ng(f b \u2297 f gd) id / g(f b \u2297 f gd)\n\nm\n\n/\n\n\u03b5\n\ngf (gf b \u2297 gd)\n\n/\n\ngf b \u2297 gd .\n\n\u03b5\nm\n\n/\n\n\u000f\n\ngf (b \u2297 gd)\n\n\u03b5\n\u03b5\n\n/\n\n\u000f\n\nb \u2297 gd\n\n3.4 Lemma. Viewed as a functor on ?, \u03b8 : f [gb, ?] \u2192 [b, ?]f is right conjugate to \u2206 : g(? \u2297 b) \u2192 g? \u2297 gb. In particular, if (f, g) is a Lipman symmetric\nmonoidal adjoint pair, then \u03b8 is an isomorphism.\nProof. Follows from the commutativity of the diagram\n\n13\n\n\ff [gb, d]\n\ntr\n\ntr\n\n\u000f\n\n[f gb, f [gb, d] \u2297 f gb]\n\n/\n\n[b, f [gb, d] \u2297 b]\n\n[f gb, f ([gb, d] \u2297 gb)]\n\nu\n\n/\n\n\u000f\n\n[b, f [gb, d] \u2297 f gb]\n\n[f gb, f d]\n\n[b, f g(f [gb, d] \u2297 b)]\n\nu\n\n/\n\n[b, f ([gb, d] \u2297 gb)]\n\nu\n\n/\n\n[b, f g(f [gb, d] \u2297 f gb)]\n\nu\n\n/\n\n[b, f d]\n\n14\n\n@A\n\n/\n\n[b, f (gf [gb, d] \u2297 gb)] ,\n\u03b5\n\n(b)\n\nm\nu\n\n/\n\n\u000f\n\n[b, f gf ([gb, d] \u2297 gb)]\n\nev\n\n\u000f\n\n\u2206\n\nu\n\n\u000f\n\nm\n\n\u000f\n\nev\n\n\u000f\n\n/\n\nu\n\n(a)\n\nm\n\n\u000f\n\nu\n\n\u03b5\n\n/\n\n\u000f\n\n[b, f ([gb, d] \u2297 gb)]\n\nev\nu\n\n/\n\n\u000f\n\n[b, f gf d]\nid\n\nev\n\u03b5\n\n/\n\n\u000f\n\n[b, f d]\nO\n\nBC\n\n\fwhere the commutativity of (a) and (b) follows from [7, (1.32)] and\nLemma 3.3, respectively.\nConsider that the diagram (2) is that of functors on b (consider that d is\nfixed), and then take a conjugate diagram, we immediately have:\n3.5 Lemma. Let S, ((?)\u2217 , (?)\u2217 ), f , and g be as in Lemma 3.2. Then for\nd \u2208 Z\u2217 and e \u2208 X\u2217 , the diagram\n\u03b8\n\n[d, (gf )\u2217e] o\n\n(gf )\u2217 [(gf )\u2217d, e]\n\nO\n\nO\n\nc\u22121\n\nc\u22121 d\u22121\n\u03b8\n\n[d, g\u2217 f\u2217 e] o\n\n\u03b8\n\ng\u2217 [g \u2217 d, f\u2217 e] o\n\ng\u2217 f\u2217 [f \u2217 g \u2217d, e]\n\nis commutative.\n3.6 Lemma. Let S and ((?)\u2217 , (?)\u2217 ) be as in Lemma 3.2. Let\nf\u2032\n\nX\u2032\n\n/Y\u2032\ng\n\ng\u2032\n\n\u000f\n\nf\n\nX\n\n/\n\n\u000f\n\nY\n\nbe a commutative diagram in S. Then for b \u2208 X\u2217 and d \u2208 X\u2217\u2032 , the diagram\nf\u2217 [b, g\u2217\u2032 d]\n\nH\n\ng\u2217 [f\u2217\u2032 (g \u2032 )\u2217 b, f\u2217\u2032 d]\n\n\u03b8\n\n\u03b8\n\nf\u2217 g\u2217\u2032 [(g \u2032 )\u2217 b, d]\n\n/\n\n/\n\nPPP\nPPPc\nPPP\nPPP\n(\n/ g\u2217 [g \u2217 f\u2217 b, f \u2032 d] \u03b8 / [f\u2217 b, g\u2217 f \u2032 d]\n\nc\n\n\u000f\n\nH\n\ng\u2217 f\u2217\u2032 [(g \u2032 )\u2217 b, d]\n\n/\n\n[f\u2217 b, f\u2217 g\u2217\u2032 d]\n\n\u2217\n\n\u2217\n\nis commutative.\nProof. Consider the diagram\nf\u2217 g\u2217\u2032 [(g \u2032)\u2217 b, d]\n\nH\n\nc\n\n\u000f\n\ng\u2217 f\u2217\u2032 [(g \u2032)\u2217 b, d]\ng\u2217 [f\u2217\u2032 (g \u2032 )\u2217 b, f\u2217\u2032 d]\n\u03b8\n\n\u000f\n\ng\u2217 [g \u2217 f\u2217 b, f\u2217\u2032 d]\n\n/\n\nf\u2217 [b, g\u2217\u2032 d] .\n\n(b)\n\nH\n\n\u000f\n\n(a)\n\n[f\u2217 g\u2217\u2032 (g \u2032 )\u2217 b, f\u2217 g\u2217\u2032 d]\n\nH\n\n\u000f\n\nH\nu\n\n/\n\n\u000f\n\n[f\u2217 b, f\u2217 g\u2217\u2032 d]\n\nc\n\nH\n\n\u000f\n\nu\n\nf\u2217 [g\u2217\u2032 (g \u2032 )\u2217 b, g\u2217\u2032 d]\n/\n\n/ [g\u2217 f \u2032 (g \u2032 )\u2217 b, g\u2217 f \u2032 d]\n\u2217\n\n\u2217\n\n(c)\nH\n\nc\n\n(d)\n\n/\n\n\u03b8\n\n\u000f\n\n[g\u2217 g \u2217 f\u2217 b, g\u2217 f\u2217\u2032 d]\n15\n\nu\n\n/\n\n\u000f\n\n[f\u2217 b, g\u2217 f\u2217\u2032 d]\n\n\f(a) is commutative by [7, Lemma 1.39]. The commutativity of (b) and (c) is\ntrivial. (d) is commutative by [7, Lemma 1.24].\n(3.7) Let f : X \u2192 Y be a Lipman symmetric monoidal functor between\nclosed categories, and g : Y \u2192 X its adjoint. We denote the composite\nP\n\n\u03b8\n\nf g[b, d] \u2212\n\u2192 f [gb, gd] \u2212\n\u2192 [b, f gd]\nby G.\n3.8 Lemma. Let S, ((?)\u2217 , (?)\u2217 ) and\nX\u2032\n\nf\u2032\n\n/Y\u2032\ng\n\ng\u2032\n\n\u000f\n\nX\n\nf\n\n\u000f\n\n/\n\nY\n\nbe as in Lemma 3.6. Then for b, d \u2208 X\u2217 , the diagram\nH\n\ng\u2217 g \u2217f\u2217 [b, d]\n\n/ g\u2217 g \u2217 [f\u2217 b, f\u2217 d]\n\nG\n\nf\u2217 [b, g\u2217\u2032 (g \u2032)\u2217 d]\n\nH\n\n[f\u2217 b, g\u2217 g \u2217 f\u2217 d]\n/\n\nc\u03b8\n\nc\u03b8\n\n\u000f\n\nG\n\nf\u2217 g\u2217\u2032 (g \u2032)\u2217 [b, d]\n\n/\n\n/\n\n\u000f\n\n[f\u2217 b, f\u2217 g\u2217\u2032 (g \u2032)\u2217 d]\n\nis commutative.\nProof. Left to the reader. Use [7, (1.24)], [7, (1.39)], and [7, (1.59)].\n3.9 Lemma. Let S, ((?)\u2217 , (?)\u2217 ) and\nX\u2032\n\nf\u2032\n\n/Y\u2032\ng\n\ng\u2032\n\n\u000f\n\nX\n\nf\n\n/\n\n\u000f\n\nY\n\nbe as in Lemma 3.6. Assume that ((?)\u2217 , (?)\u2217 ) is Lipman. Then for b, d \u2208 Y\u2217 ,\nthe diagram\ng \u2217f\u2217 f \u2217 [b, d]\n\nG\n\n/\n\ng \u2217 [b, f\u2217 f \u2217 d]\n\nP\n\n/\n\n[g \u2217b, g \u2217 f\u2217 f \u2217 d]\nd\u03b8\n\nd\u03b8\n\n\u000f\n\nf\u2217\u2032 (f \u2032)\u2217 g \u2217 [b, d]\n\nP\n\n/\n\nf\u2217\u2032 (f \u2032 )\u2217 [g \u2217b, g \u2217 d]\n\nis commutative.\n16\n\nG\n\n/\n\n\u000f\n\n[g \u2217 b, f\u2217\u2032 (f \u2032 )\u2217 g \u2217 d]\n\n\fProof. Left to the reader. Use [7, (1.26)], [7, (1.54)], and [7, (1.59)].\n3.10 Lemma. Let I be a small category, and f : X \u2192 Y a morphism of\nI op -diagrams of schemes. Then for M \u2208 Mod(Y ) and N \u2208 Mod(X), the\ncomposite\nH\n\nu\n\n\u03b8 : f\u2217 HomOX (f \u2217 M, N ) \u2212\n\u2192 HomOY (f\u2217 f \u2217 M, f\u2217 N ) \u2212\n\u2192 R HomOY (M, f\u2217N )\nis an isomorphism.\nProof. This is an immediate consequence of Lemma 3.4.\n3.11 Lemma. Let I be a small category, and f : U \u2192 X be an open immersion of I op -diagrams of schemes. Let M, N \u2208 Mod(X). If either\n(i) M is equivariant; or\n(ii) f is cartesian,\nThen the canonical map\nP : f \u2217 HomOX (M, N ) \u2192 HomOU (f \u2217 M, f \u2217N )\nis an isomorphism of presheaves. In particular, it is an isomorphism of\nsheaves.\nProof. (ii) Taking the section at (i, V ), where i \u2208 I and V \u2208 Zar(Ui ), it\nsuffices to show that the map induced by the restriction\n(3)\n\nHomZar(X)/(i,V ) (M|(i,V ) , N |(i,V ) ) \u2192 HomZar(U )/(i,V ) (M|(i,V ) , N |(i,V ) )\n\nis an isomorphism, see the description of P in [9, (2.8)]. But as U is cartesian,\nZar(U)/(i, V ) \u0592\u2192 Zar(X)/(i, V ) is an equivalence. Indeed, if (j, W ) \u2192 (i, V )\nis a morphism in Zar(X), it must be a morphism in Zar(U). Thus (3) is an\nisomorphism, and we are done.\n(i) Similarly to the proof of [9, (2.13)], the problem is reduced to the case\nof single schemes. Then the assertion follows from (ii) immediately.\n3.12 Lemma. Let ((?)\u2217 , (?)\u2217 ) be a Lipman monoidal adjoint pair on a category S where X\u2217 is closed for every X \u2208 S. For morphisms g : X \u2192 Y and\nf : Y \u2192 Z of S and a, b \u2208 Z \u2217 , the composite\nu\n\nG\n\nf\u2217 f \u2217 [a, b] \u2212\n\u2192 [a, f\u2217 f \u2217 b] \u2212\n\u2192 [a, f\u2217 g\u2217 g \u2217 f \u2217 b]\n17\n\n\fagrees with the composite\ndc\u22121\n\nu\n\nG\n\nf\u2217 f \u2217 [a, b] \u2212\n\u2192 f\u2217 g\u2217 g \u2217f \u2217 [a, b] \u2212\u2212\u2192 (f g)\u2217(f g)\u2217[a, b] \u2212\n\u2192\n\nd\u22121 c\n\n[a, (f g)\u2217(f g)\u2217b] \u2212\u2212\u2192 [a, f\u2217 g\u2217 g \u2217 f \u2217 b].\nProof. Left to the reader. Use [7, (1.39), (1.54), (1.56)].\n3.13 Corollary. Let ((?)\u2217 , (?)\u2217 ) and g : X \u2192 Y be as in Lemma 3.12. Then\nthe composite\nu\nG\n[a, b] \u2212\n\u2192 g\u2217 g \u2217 [a, b] \u2212\n\u2192 [a, g\u2217 g \u2217 b]\n\nis u.\n\nProof. Let f = id in Lemma 3.12.\n3.14 Lemma. Let I be a small category, X an I op -diagram of schemes,\nf : U \u0592\u2192 X an open subdiagram. Let M, N \u2208 Mod(X), and consider the\nmap\nG : f\u2217 f \u2217 HomOX (M, N ) \u2192 HomOX (M, f\u2217 f \u2217 N ).\n\nIf f is cartesian or M is equivariant, then G is an isomorphism.\nProof. Note that G is the composite\nP\n\n\u03b8\n\n\u2192 f\u2217 HomOU (f \u2217 M, f \u2217N ) \u2212\n\u2192 HomOX (M, f\u2217 f \u2217 N ).\nf\u2217 f \u2217 HomOX (M, N ) \u2212\nP is an isomorphism by Lemma 3.11. \u03b8 is an isomorphism by Lemma 3.10.\nSo G is an isomorphism.\n(3.15) Let I be a small category, X an I op -diagram of schemes, f : U \u0592\u2192\nX an open subdiagram, and g : V \u0592\u2192 U an open subdiagram. Then for\nM, N \u2208 Mod(X), the diagram\n(4)\n\n0\n\n0\n\n\u000f\n\n\u000f\n\n\u0393U,V HomOX (M, N )\n\nHomOX (M, \u0393U,V N )\n\n\u03b9\n\n\u000f\n\nf\u2217 f \u2217 HomOX (M, N )\n\n\u03b9\nG\n\n/\n\n\u000f\n\nHomOX (M, f\u2217 f \u2217 N )\n\nu\n\n\u000f\n\nf\u2217 g\u2217 g \u2217 f \u2217 HomOX (M, N )\n\nu\nd\u22121 cGdc\u22121\n\n/\n\n18\n\n\u000f\n\nHomOX (M, f\u2217g\u2217 g \u2217 f \u2217 N )\n\n\fis commutative with exact columns by Lemma 3.12. So there is a unique\nnatural map\n(5)\n\nH : \u0393U,V HomOX (M, N ) \u2192 HomOX (M, \u0393U,V N )\n\nsuch that \u03b9H = G\u03b9.\n3.16 Lemma. Let the notation be as in (3.15). If both f and g are cartesian,\nor M is equivariant, then H in (5) is an isomorphism.\nProof. Follows from Lemma 3.14 and the five lemma applied to the diagram\n(4).\n(3.17) Let I be a small category, and f : U \u2192 X be an open immersion of\nI op -diagram of schemes. Then \u0393((i, V ), f\u2665\u2217 M) = \u0393((i, V ), M) for M \u2208 \u2665(X)\nalmost by definition, where \u2665 = PM or Mod. Thus if j : Zar U \u0592\u2192 Zar X\n\u2665\n, as well as\nis the inclusion, then f\u2665\u2217 = j\u2665# . Thus f\u2665\u2217 has a left adjoint j#\n\u2217\nthe right adjoint f\u2217 . Hence f\u2665 preserves arbitrary limits as well as arbitrary\n\u2665\nby f! or f!\u2665 by an obvious reason.\ncolimits. We denote j#\nNote that \u0393((i, V ), f!PM (M)) is \u0393((i, V ), M) if V \u2282 Ui , and zero if V 6\u2282 Ui .\nIn particular, f!PM is exact.\nNote also that we have a commutative diagram\nZar(Ui )\n\nQ(U,i)\n\n/\n\nZar(U) ,\n\nj\n\n\u000f\n\nZar(Xi )\n\nj\nQ(X,i)\n\n/\n\n\u000f\n\nZar(X)\n\nwhere Q(X, i) and Q(U, i) are obvious inclusions, see [7, (4.5)]. By [7, (2.57)],\nPM\nPM\nLipman's theta [7, (1.21)] \u03b8 : j#\nQ(U, i)# \u2192 Q(X, i)# j#\n, namely, \u03b8 :\nPM\nPM\n(fi )! (?)i \u2192 (?)i f! at (i, V ) is the identity of \u0393((i, V ), M) if V \u2282 Ui , and\nzero otherwise. In particular, \u03b8 is an isomorphism.\nMod\nPM\nNote that f!Mod = j#\n= aj#\nq = af!PM q. By [7, (2.59)], \u03b8 : (?)i f!Mod \u2192\n(fi )Mod\n(?)i is an isomorphism. It is well-known that (fi )Mod\nis exact, and\n!\n!\nMod\nhence f!\nis exact.\n\u2217\nSince f\u2665 has an exact left adjoint f!\u2665 , f\u2665\u2217 preserves injectives and Kinjectives for \u2665 = PM, Mod.\n3.18 Lemma. Let the notation be as in (3.15). Then f \u2217 , (f g)\u2217 , and \u0393U,V\npreserves arbitrary limits.\n19\n\n\fProof. By the discussion in (3.17), f \u2217 and (f g)\u2217 preserves limits.\nNow let (M\u03bb ) be a system in Mod(X). Then\n0\n\n0\n\n\u0393U,V lim M\u03bb\n\u2190\u2212\n/\n\n/\n\n\u000f\n\nlim \u0393U,V M\u03bb\n\u2190\u2212\n\n\u03b9\n\n/ f\u2217 f \u2217 lim M\u03bb\n\n\u2190\u2212\n\nu\n\nf\u2217 g\u2217 g \u2217 f \u2217 lim M\u03bb\n\u2190\u2212\n/\n\n\u223c\n=\n\n\u03b9\n\n/\n\n\u000f\n\nlim f\u2217 f \u2217 M\u03bb\n\u2190\u2212\n\n\u223c\n=\n\nu\n\n/\n\n\u000f\n\nlim f\u2217 g\u2217 g \u2217 f \u2217 M\u03bb\n\u2190\u2212\n\nis a commutative diagram with exact rows. By the five lemma, \u0393U,V preserves\nlimits.\n(3.19) Let the notation be as in (3.15). For a complex F in Mod(X), a\nnatural map\nH : \u0393U,V HomOX (F, ?) \u2192 HomOX (F, ?) \u0393U,V\nbetween functors on the category of complexes in Mod(X) is defined. By\nLemma 3.18 and Lemma 3.16, it is an isomorphism if f and g are cartesian,\nor F is a complex of equivariant sheaves. Similarly,\nG : f\u2217 f \u2217 HomOX (F, ?) \u2192 HomOX (F, ?)f\u2217 f \u2217\nand\nd\u22121 cGdc\u22121 : f\u2217 g\u2217 g \u2217f \u2217 HomOX (F, ?) \u2192 HomOX (F, ?)f\u2217 g\u2217 g \u2217 f \u2217\n\nare induced.\n\n3.20 Lemma. Let (X, OX ) be a ringed site, F a complex of OX -modules,\nand G a K-injective complex of OX -modules. Then HomOX (F, G) is weakly\nK-injective.\nProof. Let H be any exact K-flat complex. Then\nHomOX (H, HomOX (F, G)) \u223c\n= HomOX (H \u2297 F, G)\nis exact, since H \u2297 F is exact [7, Lemma 3.21, 2] and G is K-injective. By\n[7, Lemma 3.25, 5], HomOX (F, G) is weakly K-injective.\n3.21 Lemma. The canonical maps\n\u03b6 : R(\u0393U,V HomOX (F, ?)) \u2192 R \u0393U,V R HomOX (F, ?),\n\u03b6 : R(f\u2217 f \u2217 HomOX (F, ?)) \u2192 Rf\u2217 f \u2217 R HomOX (F, ?),\n20\n\n\fand\n\u03b6 : R(f\u2217 g\u2217 g \u2217 f \u2217 HomOX (F, ?)) \u2192 Rf\u2217 Rg\u2217 g \u2217 f \u2217 R HomOX (F, ?)\n\nare isomorphisms.\n\nProof. For a K-injective complex G, HomOX (F, G) is weakly K-injective. So\nit is K-flabby, and \u0393U,V -acyclic [9, (4.3)]. In particular, f \u2217 HomOX (F, G) and\ng \u2217 f \u2217 HomOX (F, G) are K-limp by [9, (4.6)], and the assertion follows.\n(3.22) By the lemma, the composite\n\u03b6 \u22121\n\nH : R \u0393U,V R HomOX (F, ?) \u2212\u2212\u2192 R(\u0393U,V HomOX (F, ?))\n\u03b6\n\nRH\n\n\u2212\u2212\u2192 R(HomOX (F, ?) \u0393U,V ) \u2212\n\u2192 R HomOX (F, ?)R \u0393U,V\nis defined. Similarly,\nG : Rf\u2217 f \u2217 R HomOX (F, ?) \u2192 R HomOX (F, ?)Rf\u2217 f \u2217\nand\nd\u22121 cGdc\u22121 : Rf\u2217 Rg\u2217 g \u2217 f \u2217 R HomOX (F, ?) \u2192 R HomOX (F, ?)Rf\u2217 Rg\u2217 g \u2217f \u2217\nare induced. Note that\n(6)\n\nR \u0393U,V R HomOX (F, ?)\n\nH\n\nR HomOX (F, ?)R \u0393U,V\n/\n\n\u03b9\n\n\u03b9\n\n\u000f\n\nRf\u2217 f \u2217 R HomOX (F, ?)\n\nG\n\n/\n\n\u000f\n\nR HomOX (F, ?)Rf\u2217 f \u2217\n\nu\n\nu\n\n\u000f\n\nRf\u2217 Rg\u2217 g \u2217f \u2217 R HomOX (F, ?)\n\u000f\n\nR \u0393U,V R HomOX (F, ?)[1]\n\nd\u22121 cGdc\u22121\n/\n\n\u000f\n\nH[1]\n\n/\n\nR HomOX (F, ?)Rf\u2217 Rg\u2217 g \u2217 f \u2217\n\u000f\n\nR HomOX (F, ?)R \u0393U,V [1]\n\nis a commutative diagram with columns being triangles.\n3.23 Lemma. Let I be a small category, and f : X \u2192 Y a morphism of\nI op -diagrams of schemes. Then the composite\nH\n\n\u03b8 : Rf\u2217 R HomOX (Lf \u2217 F, G) \u2212\n\u2192 R HomOY (Rf\u2217 Lf \u2217 F, Rf\u2217 G)\nu\n\n\u2192 R HomOY (F, Rf\u2217 G)\n\u2212\n\nis an isomorphism between functors on D(Y )op \u00d7 D(X).\n21\n\n\fProof. This is an immediate consequence of [7, (1.49)] and [7, (8.23), 5].\n3.24 Corollary. Let f : U \u2192 X be a cartesian open immersion. Then\nP : f \u2217 R HomOX (F, G) \u2192 R HomOU (f \u2217 F, f \u2217 G)\nis an isomorphism for any F, G \u2208 D(X).\nProof. If G is a K-injective complex in K(X), then so is f \u2217 G by (3.17). So\nit suffices to show that\nf \u2217 HomOX (F, G) \u2192 HomOU (f \u2217 F, f \u2217 G)\nis an isomorphism of complexes, if F and G are complexes in Mod(X). This\nfollows from Lemma 3.11 and the fact that f \u2217 preserves direct product.\n3.25 Lemma. Let I be a small category, and f : X \u2192 Y a morphism of\nI op -diagrams of schemes. Let F and G be objects in D(Y ). Assume that one\nof the following holds:\n(i) f is locally an open immersion, F \u2208 DEM (Y ), and one of the following\nholds:\n(a) G \u2208 D + (Y );\n\n+\n(b) F \u2208 DEM\n(Y );\n\n(c) G \u2208 DLqc (Y ).\n\n\u2212\n(ii) f is flat, Y is locally noetherian, G \u2208 D + (Y ), and F \u2208 DCoh\n(Y ).\n\n(iii) f is flat, Y is locally noetherian, F \u2208 DCoh (Y ), and both G and f \u2217 G\nhave finite injective dimension.\nThen the canonical map\nP : f \u2217 R HomOY (F, G) \u2192 R HomOX (f \u2217 F, f \u2217 G)\nis an isomorphism.\n\n22\n\n\fProof. Similarly to [7, Lemma 1.59], using [7, Lemma 1.56], it is easy to\nprove that the diagram\n(?)i f \u2217 R HomOY (F, G)\n\nP\n\n/\n\n(?)i R HomOX (f \u2217 F, f \u2217 G)\nH\n\n\u03b8 \u22121\n\n\u000f\n\n\u000f\n\nR HomOX ((?)i f \u2217 F, (?)i f \u2217 G)\n\nfi\u2217 (?)i R HomOY (F, G)\n\ni\n\n[\u03b8,\u03b8 \u22121 ]\n\nH\n\n\u000f\n\nfi\u2217 R HomOY (Fi , Gi )\n\nP\n\n/ R HomO\n\ni\n\n\u000f\n\nXi\n\n(fi\u2217 Fi , fi\u2217 Gi )\n\nis commutative for i \u2208 I. Note that the vertical morphisms are isomorphisms\nby [7, (13.9)] and [7, (6.25)]. So in order to prove that the top P is an isomorphism for each i \u2208 I, it suffices to prove the bottom P is an isomorphism.\nSo we may assume that the problem is on single schemes.\n(i) We may assume that f is an open immersion. Then this is a special\ncase of Corollary 3.24.\n(ii) This is [5, (5.8)].\n(iii) This follows from (ii) and the way-out lemma ([5, Proposition I.7.1,\n(iii)]).\n3.26 Theorem. Let I be a small category, X an I op -diagram of schemes,\nf : U \u0592\u2192 X an open subdiagram, and g : V \u0592\u2192 U an open subdiagram. Let F\nand G be in D(X). If one of the following holds, then\nH : R \u0393U,V R HomOX (F, ?) \u2192 R HomOX (F, ?)R \u0393U,V\nis an isomorphism:\n(i) f and g are cartesian;\n(ii) F \u2208 DEM (X), and one of the following hold: (a) G \u2208 D + (X); (b)\n+\nF \u2208 DEM\n(X); (c) G \u2208 DLqc (X).\nProof. By Lemma 3.23 and Lemma 3.25, the two maps \u03b8P and d\u22121 c\u03b8P dc\u22121\nin (6) are isomorphisms. As the columns of (6) are triangles, the third\nhorizontal map H is also an isomorphism.\n\n23\n\n\f4.\n\nMatlis duality and the local duality\n\nLet S be a scheme, G an S-group scheme, (X, Y ) a standard G-local Gscheme. That is, X is a standard G-local G-scheme, and Y is its unique\nminimal closed G-subscheme. We denote the inclusion Y \u0592\u2192 X by j.\nWe denote the defining ideal sheaf of Y by I. Thus I is the unique Gmaximal G-ideal of OX . We fix the generic point of an irreducible component\nof Y and denote it by \u03b7.\n4.1 Lemma. Let C be a class of noetherian local rings. Assume that if A \u2208 C\nand B is essentially of finite type over A, then B \u2208 C. Let P(A, M) be a\nproperty of a pair (A, M) of a finitely generated module M over a noetherian\nlocal ring A such that A \u2208 C. Assume that\n(i) If A \u2208 C, P(A, M) holds, and P \u2208 Spec A, then P(AP , MP ) holds.\n(ii) If A \u2208 C, M a finite A-module, and A \u2192 B is a flat local homomorphism essentially of finite type with local complete intersection fibers\n(resp. geometrically regular fibers), then P(A, M) holds if and only if\nP(B, B \u2297A M) holds.\nAssume that the all local rings of X belong to C. For M \u2208 Coh(G, X), if\nP(OX,\u03b7 , M\u03b7 ) holds (resp. P(OX,\u03b7 , M\u03b7 ) holds and either the second projection\np2 : G \u00d7 X \u2192 X is smooth or S = Spec k with k a perfect field and G is of\nfinite type over S), then P(OX,x , Mx ) holds for any x \u2208 X.\nProof. Let Z be the unique integral closed subscheme of X whose generic\npoint is x. Let Z \u2217 be the unique minimal closed G-subscheme of X containing\nZ, see [8]. As \u03b7 \u2208 Y \u2282 Z \u2217 , there exists some irreducible component Z0 of Z\nsuch that \u03b7 \u2208 Z0 . Let \u03b6 be the generic point of Z0 . Since P(OX,\u03b7 , M\u03b7 ) holds\nand \u03b6 is a generalization of \u03b7, P(OX,\u03b6 , M\u03b6 ) holds. Then by [8, Corollary 7.6],\nP(OX,x , Mx ) holds.\n4.2 Corollary. Let m, n, and g be non-negative integers or \u221e. Then\n\n(i) Let M \u2208 Coh(G, X), and assume that M\u03b7 is maximal Cohen\u2013Macaulay\n(resp. of finite injective dimension, projective dimension m, dim \u2212 depth =\nn, torsionless, reflexive, G-dimension g, zero) as an OX,\u03b7 -module. Then\nMx is so as an OX,x -module for any x \u2208 X.\n(ii) If OX,\u03b7 is a complete intersection, then X is locally a complete intersection.\n24\n\n\f(iii) Assume that p2 : G \u00d7 X \u2192 X is smooth or S = Spec k with k a perfect\nfield and G is of finite type over S. If OX,\u03b7 is regular, then X is regular.\n(iv) In addition to the assumption of (iii), assume further that X is a locally\nexcellent Fp -scheme, where p is a prime number. If OX,\u03b7 is F -regular\n(resp. F -rational), then the all local rings of X is F -regular (resp. F rational).\nProof. (i) Let C be the class of all noetherian local rings, and P(A, M) be\n\"M is a maximal Cohen\u2013Macaulay A-module.\" We can apply Lemma 4.1.\nSimilarly for other properties.\n(ii) Let C be the class of all noetherian local rings, and P(A, M) be \"A is\na complete intersection.\" Then as P(OX,\u03b7 , 0) holds, P(OX,x , 0) holds for any\nx \u2208 X.\n(iii) Let C be the class of all noetherian local rings, and P(A, M) be \"A\nis regular.\"\n(iv) Let C be the class of all excellent noetherian local rings of characteristic p, and P(A, M) be \"A is F -regular\" (resp. \"A is F -rational\").\n4.3 Corollary. The stalk functor (?)\u03b7 : Qch(G, X) \u2192 Mod(OX,\u03b7 ) is faithfully exact.\nProof. The exactness is well-known. Let M \u2208 Qch(G, X) and assume that\nM=\n6 0. Then as Qch(G, X) is locally noetherian and its noetherian object\nis nothing but a coherent (G, OX )-module, M contains a nonzero coherent\n(G, OX )-submodule N . Then by Corollary 4.2, M\u03b7 \u2283 N\u03b7 6= 0. This shows\nthat (?)\u03b7 is faithfully exact.\nM\n4.4 Remark. Formally, (?)\u03b7 is a functor from Qch(G, X) = Qch(BG\n(X)), or\nM\nmore generally, from Mod(G, X) = Mod(BG (X)) to Mod(OX,\u03b7 ), and is the\ncomposite\n(?)0\n\nh\u2217\n\nM\nM\nMod(BG\n(X)) \u2212\u2212\u2192 Mod(BG\n(X)0 ) = Mod(X0 ) \u2212\u2192 Mod(Spec OX,\u03b7 ),\n\nwhere h : Spec OX,\u03b7 \u2192 X0 is the inclusion. Thus (?)\u03b7 is sometimes written\nas (?)\u03b7 (?)0 , where (?)\u03b7 means h\u2217 .\n4.5 Corollary (G-NAK). Let M \u2208 Coh(G, X). If j \u2217 M = 0, then M = 0,\nwhere j : Y \u0592\u2192 X is the inclusion.\nProof. Since j \u2217 M = 0, M/IM = 0. So M\u03b7 /I\u03b7 M\u03b7 = 0. By Nakayama's\nlemma, M\u03b7 = 0. By Corollary 4.3, M = 0.\n25\n\n\f4.6 Proposition. A standard G-artinian G-scheme is Cohen\u2013Macaulay.\nProof. By Lemma 2.20, we may assume that the G-scheme is G-local. So let\nX be a G-artinian\nG-local standard G-scheme. Let Y , \u03b7, and I be as above.\n\u221a\nG\nThen 0 = I, since\nI is the only G-prime ideal (for the definition and\n\u221a\nG\nbasic properties of ?, see [8, section 4]). So Y = X, set theoretically.\nThus \u03b7 is the generic point of an irreducible component of X. So OX,\u03b7\nis an artinian ring, and hence is Cohen\u2013Macaulay. By Corollary 4.2, X is\nCohen\u2013Macaulay.\n4.7 Corollary. Y is Cohen\u2013Macaulay.\nProof. Since Y is G-artinian G-local standard, the corollary follows immediately from Proposition 4.6.\n(4.8) From now on, we assume that X has a G-dualizing complex IX (see\n[7, (31.15)]). For a G-morphism f : X \u2032 \u2192 X which is separated of finite type,\nG\n(f )! (see [7,\nwe denote f ! IX by IX \u2032 , where f ! is the twisted inverse functor BM\nchapter 29]). Note that IX \u2032 is a G-dualizing complex of X \u2032 [7, Lemma 31.11].\nBy [7, Lemma 31.6], IX \u2032 , viewed as a complex of OX \u2032 -modules, is a dualizing\ncomplex of X \u2032 .\nSince OY,\u03b7 is Cohen\u2013Macaulay, there is only one i such that H i (IY )\u03b7 6= 0.\nThis is equivalent to say that H i (IY ) 6= 0. If this i is 0, then we say that IX\nis G-normalized. If X has a G-dualizing complex, then by shifting, X has a\nG-normalized G-dualizing complex.\nFrom now on, we always assume that IX is G-normalized.\n4.9 Lemma. IX,\u03b7 is a normalized dualizing complex of the local ring OX,\u03b7 .\n0\nIn particular, Hm\n(IX,\u03b7 ) is the injective hull of the residue field \u03ba(\u03b7) of OX,\u03b7 ,\n\u03b7\nwhere m\u03b7 is the maximal ideal of OX,\u03b7 .\nProof. Since IX is a dualizing complex, IX,\u03b7 is also a dualizing complex of\nOX,\u03b7 . We prove that IX,\u03b7 is normalized. Let D be a normalized dualizing\ncomplex of OX,\u03b7 , and set IX,\u03b7 \u223c\n= D[r]. We want to prove that r = 0.\nConsider the commutative diagram\nXO o\n\np\n\nSpec OX,\u03b7 .\nO\n\nj\n\nY o\n\nj\u2032\nq\n\nSpec OY,\u03b7\n26\n\n\fBy the commutativity with restrictions [7, Proposition 18.14],\nH 0 (IY )\u03b7 \u223c\n= ExtrOX,\u03b7 (OY,\u03b7 , D) 6= 0.\n= H 0 ((j \u2032 )! IX,\u03b7 ) \u223c\n= H 0 (q \u2217 j ! IX ) \u223c\n\u2212r\nThe Matlis dual of the last module is Hm\n(OY,\u03b7 ), by the local duality [5,\n\u03b7\n\u2212r\n(OY,\u03b7 ) 6= 0 implies\n(V.6.3)]. Since OY,\u03b7 is an OX,\u03b7 -module of finite length, Hm\n\u03b7\nr = 0.\n\n4.10 Lemma. H iY (IX ) = 0 for i 6= 0, and H 0Y (IX )\u03b7 is the injective hull of\nthe residue field \u03ba(\u03b7) of the local ring OX,\u03b7 .\nProof. By [9, Theorem 6.10],\ni\n(IX,\u03b7 ).\n(H iY (IX ))\u03b7 \u223c\n= H i (R \u0393I\u03b7 (?)\u03b7 IX ) \u223c\n= Hm\n= H i ((?)\u03b7 R \u0393Y IX ) \u223c\n\u03b7\n\nSince IX,\u03b7 is a normalized dualizing complex of OX,\u03b7 , the last module is zero\nif i 6= 0 and is the injective hull of the residue field \u03ba(\u03b7) of the local ring OX,\u03b7\nif i = 0. As (?)\u03b7 is faithfully exact, we are done.\n(4.11) We set E := H 0Y (IX ), and call it the G-sheaf of Matlis. Note that\nthe definition of E depends on the choice of IX . Note also that E\u03b7 is the\ninjective hull of the residue field of OX,\u03b7 .\n\n4.12 Lemma. E is of finite injective dimension as an object of Mod(G, X).\nProof. We may assume that IX is a bounded complex of injective objects. By\nLemma 4.10, E is isomorphic to \u0393Y (IX ) in D(X). On the other hand, \u0393Y (IX )\nis quasi-isomorphic to J = Cone(IX \u2192 f\u2217 f \u2217 IX )[\u22121], where f : X \\ Y \u2192 X\nis the inclusion. As f\u2217 f \u2217 has an exact left adjoint f! f \u2217 (see (3.17)), J is a\nbounded injective resolution of E.\n4.13 Lemma. ExtiOX (M, E) = 0 for i > 0 and M \u2208 Coh(G, X).\n\nProof. ExtiOX (M, E)\u03b7 \u223c\n= ExtiOX,\u03b7 (M\u03b7 , E\u03b7 ). As E\u03b7 is injective, we are done.\n4.14 Corollary. D := HomOX (?, E) is an exact functor on Coh(G, X).\n\n4.15 Lemma. For M \u2208 Qch(G, X), the following are equivalent:\n(i) M is of finite length;\n(ii) M \u2208 Coh(G, X), and I n M = 0 for some n.\n27\n\n\f(iii) M\u03b7 is an OX,\u03b7 -module of finite length;\nProof. (i)\u21d2(ii) As M is of finite length, it is a noetherian object. Hence it\nis coherent by [7, Lemma 12.8]. As M is also an artinian object, I n M =\nI n+1 M for sufficiently large n. By Corollary 4.5, I n M = 0.\n(ii)\u21d2(iii) As M is coherent, M\u03b7 is a finitely generated OX,\u03b7 -module.\nSince I\u03b7n M\u03b7 = 0, the support of M\u03b7 is one point, and hence M\u03b7 is a module\nof finite length.\n(iii)\u21d2(i) This is because (?)\u03b7 is faithfully exact.\n(4.16) We denote by F the full subcategory of those objects M \u2208 Qch(G, X)\nsuch that the equivalent conditions in the lemma are satisfied.\n4.17 Theorem (Matlis duality). Set D := HomOX (?, E). Then\n(i) D is an exact functor from F to itself.\n(ii) D2 \u223c\n= Id as functors on F . In particular, D : F \u2192 F is an antiequivalence.\nProof. (i) If M \u2208 F , then D(M) = HomOX (M, E) is in Qch(G, X), and\nHomOX (M, E)\u03b7 = HomOX,\u03b7 (M\u03b7 , E\u03b7 ) is of finite length, because this module is\nthe Matlis dual of the module M\u03b7 , which is of finite length. So the condition\n(iii) in Lemma 4.15 is satisfied, and hence D(M) \u2208 F . The exactness of D\nis already checked.\n(ii) Let D : M \u2192 DDM = HomOX (HomOX (M, E), E) be the canonical\nmap, see (2.2). Note that by Lemma 2.5 and Lemma 2.7, applying (?)\u03b7 to\nthis map, we get the duality map D : M\u03b7 \u2192 HomOX,\u03b7 (HomOX,\u03b7 (M\u03b7 , E\u03b7 ), E\u03b7 ),\nwhich is an isomorphism, since E\u03b7 is the injective hull of the residue field \u03ba(\u03b7).\nSince (?)\u03b7 is faithful, D : M \u2192 DDM is an isomorphism.\n4.18 Theorem (Local duality). For F \u2208 DCoh (G, X), the composite\nD\n\nH\n\n\u2192 R \u0393Y R HomOX (R HomOX (F, IX ), IX ) \u2212\n\u2192\nd : R \u0393Y F \u2212\nR HomOX (R HomOX (F, IX ), R \u0393Y IX ) \u223c\n= R HomOX (R HomOX (F, IX ), E)\nis an isomorphism. It induces an isomorphism\nH iY (F) \u223c\n= HomOX (Ext\u2212i\nOX (F, IX ), E)\nfor each i \u2208 Z.\n28\n\n\fProof. D in the composition is an isomorphism by [7, (31.9)]. H is an isomorphism by Theorem 3.26, (i). Thus d is an isomorphism.\nTo prove the second assertion, it suffices to show that\nExtiOX (G, E) \u223c\n= HomOX (H \u2212i (G), E),\nwhere G = R HomOX (F, IX ). Note that G \u2208 DCoh (X) by [7, (31.9)]. Let J be\na bounded injective resolution of E (it does exist, see Lemma 4.12). Consider\nthe spectral sequence\nE2p,q = H p (HomOX (H \u2212q (G), J)) \u21d2 Extp+q\nOX (G, E).\nBy Lemma 4.13, E2p,q = 0 for p 6= 0, and the spectral sequence collapses, and\nwe get the desired assertion.\n4.19 Lemma. Let F \u2208 DCoh (X). Then the diagram\nd\n\n(?)\u03b7 (?)0 R \u0393Y (F)\n\n/\n\n(?)\u03b7 (?)0 R HomOX (R HomOX (F, IX ), E)\nPH\n\n\u000f\n\nR HomOX,\u03b7 ((?)\u03b7 (?)0 R HomOX (F, IX ), E\u03b7 )\n\n\u03b4\u0304\u03b3\u0302 \u22121\n\nP \u22121 H \u22121\n\n\u000f\n\nR\u0393m\u03b7 (F\u03b7 )\n\nd\n\n/\n\n\u000f\n\nR HomOX,\u03b7 (R HomOX,\u03b7 (F\u03b7 , IX,\u03b7 ), E\u03b7 )\n\nis commutative (see for the definition of \u03b3\u0302 and \u03b4\u0304, see [9, section 4] and [9,\n(6.1)], respectively).\nProof. Note that H \u22121 in the diagram exists by [7, (13.9)]. The P \u22121 exists by Lemma 3.25, (iii). The commutativity of the diagram follows from\nLemma 2.5 and Lemma 2.7 immediately.\n5.\n\nAn example of graded rings\n\n(5.1) Let (R, m) be a noetherian local ring with a normalized dualizing\ncomplex IR . Set S = Spec R. Let H be a flat R-group scheme of finite\ntype, and G = Gm \u00d7 H. Let A be a G-algebra. So A is Z-graded and\nL each\nhomogeneous component is an H-submodule of A. Assume that A = i\u22650 Ai\nis N-graded and A0 = R. Let \u03c0 : X \u2192 S be the canonical map, where\nX := Spec A. Set IX := \u03c0 ! IR .\n29\n\n\f5.2 Lemma. Under the notation as above, X is G-local, and IX is Gnormalized.\nProof. Let I be a proper G-ideal of A. Then I is a homogeneous ideal,\nand is L\ncontained in the unique graded maximal ideal M := m + A+ , where\nA+ = i>0 Ai . Clearly, M is a G-ideal, and hence is the unique G-maximal\nG-ideal. So X is G-local.\nLet \u03c6 : S \u2192 X be the closed immersion induced by A \u2192 A/A+ = R. Let\n\u03c8 : Y \u2192 S be the closed immersion induced by R \u2192 R/m \u223c\n= A/M, where\nY = Spec A/M. Then since \u03c0\u03c6 = idS ,\nIY = (\u03c6\u03c8)! (IX ) = \u03c8 ! \u03c6! \u03c0 ! IR = \u03c8 ! IR .\ni\nSo H i (IY ) \u223c\n(R/m). This is nonzero\n= ExtiR (R/m, IR ), whose Matlis dual is Hm\nif and only if i = 0. Thus IX is G-normalized.\n\n(5.3) For a finite R-module V , set V \u2020 := HomR (V, ER ), where ER is the\ninjective hull of the residue field R/m of R. For an A-finite G-module M,\nset M \u2228 = lim HomR (M/Mn M, ER ). As each M/Mn M is an R-finite (G, A)\u2212\u2192\nmodule, each HomR (M/Mn M, ER ) is a (G, A)-module, and hence M \u2228 is also\n\u2228\na (G, A)-module. It is easy to see that M \u2228 \u223c\n= HomL\nA (M, A ). Note that the\n\u2020\n\u2020\n\u2228\n\u2228\ndegree i component of M is M\u2212i . That is, M = i\u2208Z M\u2212i\n.\n5.4 Lemma. A\u2228 is isomorphic to EA := \u0393(X, E) as a (G, A)-module.\nProof. We may assume that IR is the normalized fundamental dualizing complex. We have\n(7) E = H 0Y (IX ) = lim Ext0OX (OX /I n , IX )\n\u2212\u2192\n= lim H 0 ((\u03c8n )\u2217 \u03c8n! \u03c0 ! IS ) = lim Ext0R (A/Mn , IR )e,\n\u2212\u2192\n\u2212\u2192\n\nwhere \u03c8n : Spec A/Mn \u2192 Spec A is the canonical closed immersion, and (?)e\ndenotes the quasi-coherent sheaf associated to a module. On the other hand,\nA/Mn has finite length as an R-module, so\nExt0R (A/Mn , IR ) \u223c\n= H 0 (HomR (A/Mn , \u0393mIR ))\n= H 0 (HomR (A/Mn , IR )) \u223c\n\u223c\n= H 0 (HomR (A/Mn , ER )) = HomR (A/Mn , ER ).\nWe prove that the map HomR (A/Mm , ER ) \u2192 HomR (A/Mn , ER ) in the\ninductive system is induced by the projection A/Mn \u2192 A/Mm for n \u2265 m.\n30\n\n\fNote that Ext0OX (OX /I m , IX ) \u2192 Ext0OX (OX /I n , IX ) in (7) is induced by the\nprojection. So by the description of the twisted inverse for finite morphisms\n!\n[7, (27.7)], the map (\u03c8m )\u2217 \u03c8m\n\u2192 (\u03c8n )\u2217 \u03c8n! is induced by the counit map. That\nis, the map is the composite\n\u03b5\n! \u223c\n!\n(\u03c8m )\u2217 \u03c8m\n\u03c8n! \u2192\n\u2212 (\u03c8n )\u2217 \u03c8n! ,\n= (\u03c8n )\u2217 (\u03c8n,m )\u2217 \u03c8n,m\n\nwhere \u03c8n,m : Spec A/Mm \u2192 Spec A/Mn is the map induced by the projection. So again by [7, (27.7)], the map Ext0R (A/Mm , IR ) \u2192 Ext0R (A/Mn , IR )\nin (7) is also induced by the projection, and we are done.\nHence\nEA = lim HomR (A/Mn , ER ) = A\u2228 .\n\u2212\u2192\n5.5 Corollary. Assume that A is Cohen\u2013Macaulay and dim A = d. Set\n\u0393(X, H \u2212d (IX )) to be \u03c9A . For a A-finite (G, A)-module M, the canonical\nmap\ni\n\u2228\nd : HM\n(M) \u2192 Extd\u2212i\nA (M, \u03c9A )\n\nis an isomorphism of (G, A)-modules. That is, this isomorphism preserves\ngrading and H-action.\n5.6 Remark. Assume that R = k is a field. Let G be the full subcategory of\n(G, A)-modules consistingLof M such that Mi is finite dimensional for every\n\u2020\n\u2020\ni. Then we define M \u2228 = i\u2208Z M\u2212i\nfor M \u2208 G, where M\u2212i\n= Homk (M\u2212i , k).\n\u2217\n\u2228\n\u2228\nWe have an isomorphism \u03a6 : HomA (M, A ) \u2192 M . See for the notation\n\u2217\nHomA , [1]. Note that\n\u03a6n : \u2217 HomA (M, A\u2228 )n = \u2217 HomA (M(\u2212n), A\u2228 )0\n\u2192 Homk (M\u2212n , A\u22280 ) = Homk (M\u2212n , k)\nis given by the restriction. It is easy to see that (?)\u2228 is an anti-equivalence\nfrom G to itself. This also gives an anti-equivalence between the category of\nnoetherian (G, A)-modules to that of artinian (G, A)-modules. This is not\ncontained in Theorem 4.17, which treats only objects of finite length.\n5.7 Example. Let k be an algebraically closed field of characteristic two,\nand we set R = k and S = Spec R. Let V = k 2 , and H = GL(V ). Let\nA = SymL\nV , and X = V \u2217 = Spec A. Then A\u22172 is not injective as a G-module.\nSo EA = i\u22650 A\u2217i is not injective as a G-module either. So EA is not injective\nas a (G, A)-module either by [6, Corollary II.1.1.9]. In particular, EA is not\nthe injective hull of A/M as a (G, A)-module.\n31\n\n\fReferences\n[1] W. Bruns and J. Herzog, Cohen\u2013Macaulay Rings (first paperback edition), Cambridge (1998).\n[2] J. Franke, On the Brown representability theorem for triangulated categories, Topology 40 (2001), 667\u2013680.\n[3] S. Goto and K.-i. Watanabe, On graded rings, I, J. Math. Soc. Japan\n30 (1978), 179\u2013213.\n[4] S. Goto and K.-i. Watanabe, On graded rings, II (Zn -graded rings),\nTokyo J. Math. 1 (1978), 237\u2013261.\n[5] R. Hartshorne, Residues and Duality, Lecture Notes in Math. 20,\nSpringer, (1966).\n[6] M. Hashimoto, Auslander-Buchweitz Approximations of Equivariant\nModules, London Mathematical Society Lecture Note Series 282, Cambridge (2000).\n[7] M. Hashimoto, Equivariant Twisted Inverses, Foundations of\nGrothendieck Duality for Diagrams of Schemes (J. Lipman, M.\nHashimoto), Lecture Notes in Math. 1960, Springer (2009), pp. 261\u2013\n478.\n[8] M. Hashimoto and M. Miyazaki, G-prime and G-primary G-ideals on\nG-schemes, preprint arXiv:0906.1441v2\n[9] M. Hashimoto and M. Ohtani, Local cohomology on diagrams of\nschemes, Michigan Math. J. 57 (2008), 383\u2013425.\n[10] Y. Kamoi, Noetherian rings graded by an abelian group, Tokyo J. Math.\n18 (1995), 31\u201348.\n[11] J. Lipman, Notes on Derived Functors and Grothendieck Duality, Foundations of Grothendieck Duality for Diagrams of Schemes (J. Lipman,\nM. Hashimoto), Lecture Notes in Math. 1960, Springer (2009), pp. 1\u2013\n259.\n\n32\n\n\f"}