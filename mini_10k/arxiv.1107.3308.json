{"id": "http://arxiv.org/abs/1107.3308v4", "guidislink": true, "updated": "2014-01-22T02:58:38Z", "updated_parsed": [2014, 1, 22, 2, 58, 38, 2, 22, 0], "published": "2011-07-17T15:23:15Z", "published_parsed": [2011, 7, 17, 15, 23, 15, 6, 198, 0], "title": "Hyperbolicity of the complex of free factors", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1107.3485%2C1107.1223%2C1107.1758%2C1107.5705%2C1107.4151%2C1107.0290%2C1107.5394%2C1107.4525%2C1107.3313%2C1107.1551%2C1107.3670%2C1107.2556%2C1107.2647%2C1107.4335%2C1107.1012%2C1107.0577%2C1107.5777%2C1107.3459%2C1107.0797%2C1107.4751%2C1107.4034%2C1107.2952%2C1107.4345%2C1107.2778%2C1107.0362%2C1107.1176%2C1107.2808%2C1107.2857%2C1107.4806%2C1107.1242%2C1107.4098%2C1107.3308%2C1107.0685%2C1107.3545%2C1107.2318%2C1107.2360%2C1107.5636%2C1107.0039%2C1107.0893%2C1107.2819%2C1107.4386%2C1107.5136%2C1107.2975%2C1107.4756%2C1107.5684%2C1107.5530%2C1107.0133%2C1107.5783%2C1107.4141%2C1107.5999%2C1107.0901%2C1107.0925%2C1107.1130%2C1107.4149%2C1107.5761%2C1107.4578%2C1107.1350%2C1107.0367%2C1107.0129%2C1107.1615%2C1107.1806%2C1107.1295%2C1107.1153%2C1107.5524%2C1107.0755%2C1107.5570%2C1107.3546%2C1107.1857%2C1107.5362%2C1107.3044%2C1107.4605%2C1107.5070%2C1107.5257%2C1107.4107%2C1107.5713%2C1107.4770%2C1107.1148%2C1107.4777%2C1107.5653%2C1107.0469%2C1107.2255%2C1107.3978%2C1107.3164%2C1107.1532%2C1107.0541%2C1107.2679%2C1107.5889%2C1107.5484%2C1107.2788%2C1107.1521%2C1107.4916%2C1107.4510%2C1107.3349%2C1107.2262%2C1107.2456%2C1107.1861%2C1107.4293%2C1107.4624%2C1107.0765%2C1107.5040%2C1107.0141&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Hyperbolicity of the complex of free factors"}, "summary": "We develop the geometry of folding paths in Outer space and, as an\napplication, prove that the complex of free factors of a free group of finite\nrank is hyperbolic.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1107.3485%2C1107.1223%2C1107.1758%2C1107.5705%2C1107.4151%2C1107.0290%2C1107.5394%2C1107.4525%2C1107.3313%2C1107.1551%2C1107.3670%2C1107.2556%2C1107.2647%2C1107.4335%2C1107.1012%2C1107.0577%2C1107.5777%2C1107.3459%2C1107.0797%2C1107.4751%2C1107.4034%2C1107.2952%2C1107.4345%2C1107.2778%2C1107.0362%2C1107.1176%2C1107.2808%2C1107.2857%2C1107.4806%2C1107.1242%2C1107.4098%2C1107.3308%2C1107.0685%2C1107.3545%2C1107.2318%2C1107.2360%2C1107.5636%2C1107.0039%2C1107.0893%2C1107.2819%2C1107.4386%2C1107.5136%2C1107.2975%2C1107.4756%2C1107.5684%2C1107.5530%2C1107.0133%2C1107.5783%2C1107.4141%2C1107.5999%2C1107.0901%2C1107.0925%2C1107.1130%2C1107.4149%2C1107.5761%2C1107.4578%2C1107.1350%2C1107.0367%2C1107.0129%2C1107.1615%2C1107.1806%2C1107.1295%2C1107.1153%2C1107.5524%2C1107.0755%2C1107.5570%2C1107.3546%2C1107.1857%2C1107.5362%2C1107.3044%2C1107.4605%2C1107.5070%2C1107.5257%2C1107.4107%2C1107.5713%2C1107.4770%2C1107.1148%2C1107.4777%2C1107.5653%2C1107.0469%2C1107.2255%2C1107.3978%2C1107.3164%2C1107.1532%2C1107.0541%2C1107.2679%2C1107.5889%2C1107.5484%2C1107.2788%2C1107.1521%2C1107.4916%2C1107.4510%2C1107.3349%2C1107.2262%2C1107.2456%2C1107.1861%2C1107.4293%2C1107.4624%2C1107.0765%2C1107.5040%2C1107.0141&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We develop the geometry of folding paths in Outer space and, as an\napplication, prove that the complex of free factors of a free group of finite\nrank is hyperbolic."}, "authors": ["Mladen Bestvina", "Mark Feighn"], "author_detail": {"name": "Mark Feighn"}, "author": "Mark Feighn", "arxiv_comment": "bibliography updated, minor corrections, to appear in Advances in\n  Mathematics", "links": [{"href": "http://arxiv.org/abs/1107.3308v4", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1107.3308v4", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.GR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.GR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.GT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "20F645", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1107.3308v4", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1107.3308v4", "journal_reference": null, "doi": null, "fulltext": "arXiv:1107.3308v4 [math.GR] 22 Jan 2014\n\nHyperbolicity of the complex of free factors\nMladen Bestvina and Mark Feighn\u2217\nJanuary 21, 2014\n\nAbstract\nWe develop the geometry of folding paths in Outer space and, as\nan application, prove that the complex of free factors of a free group\nof finite rank is hyperbolic.\n\nContents\n1 Introduction\n\n2\n\n2 Review\n\n6\n\n3 Detecting boundedness in the free factor complex F\n\n13\n\n4 More on folding paths\n\n16\n\n5 Loops with long illegal segments\n\n26\n\n6 Projection to a folding path\n\n36\n\n7 Hyperbolicity\n\n53\n\n8 Fellow Travelers and Symmetry\n\n55\n\n9 Thin Triangles\n\n58\n\n\u2217\n\nBoth authors gratefully acknowledge the support by the National Science Foundation.\n\n1\n\n\f1\n\nIntroduction\n\nThe complex of free factors of a free group F of rank n is the simplicial\ncomplex F whose vertices are conjugacy classes of proper free factors A of\nF, and simplices are determined by chains A1 < A2 < * * * < Ak . The outer\nautomorphism group Out(F) acts naturally on F, which can be thought\nof as an analog of the Bruhat-Tits building associated with GLn (Z). This\ncomplex was introduced by Hatcher and Vogtmann in [20] where it is shown\nthat it has the homotopy type of the wedge of spheres of dimension n \u2212 2.\nThey defined this complex in terms of sphere systems in #n1 S 1 \u00d7 S 2 and\nused variants in their work on homological stability [19, 21, 18].\nThere is a very useful analogy between F and the curve complex C\nassociated with a compact surface (with punctures) \u03a3. The vertices of C\nare isotopy classes of essential simple closed curves in \u03a3, and simplices are\ndetermined by pairwise disjoint curves. The curve complex was introduced\nby Harvey [17] and was classically used by Harer in his work on duality and\nhomological stability of mapping class groups [15, 16]. The key result here\nis that the curve complex is homotopy equivalent to the wedge of spheres.\nMore recently, the curve complex has been used in the study of the\ngeometry of mapping class groups and of ends of hyperbolic 3-manifolds.\nThe fundamental result on which this work is based is the theorem of Masur\nand Minsky [27] that the curve complex is hyperbolic. In the low complexity\ncases when C is a discrete set one modifies the definition of C by adding an\nedge when the two curves intersect minimally. In the same way, we modify\nthe definition of F when the rank is n = 2 by adding an edge when the\ntwo free factors (necessarily of rank 1) are determined by a basis of F, i.e.\nwhenever F = ha, bi, then hai and hbi span an edge. In this way F becomes\nthe standard Farey graph. The main result in this paper is:\nMain Theorem. The complex F of free factors is hyperbolic.\nThe statement simply means that when the 1-skeleton of F is equipped\nwith the path metric in which every edge has length 1, the resulting graph\nis hyperbolic.\nThere are variants of the definition that give rise to quasi-isometric complexes. For example, one can take the complex of partial bases, where vertices are conjugacy classes of elements that are part of a basis, and simplices\ncorrespond to compatibility, i.e. subsets of a basis. The Aut(F)-version of\nthis complex was used in [10] to study the Torelli group. As another example, F is quasi-isometric to the nerve of the cover {U (A)} of the thin part\nof Outer space, where for a conjugacy class of proper free factors A, the\n2\n\n\fset U (A) consists of those marked graphs whose A-cover has core of volume\n< \u01eb, for a fixed small \u01eb > 0.\nOur proof is very much inspired by the Masur-Minsky argument, which\nuses Teichm\u00fcller theory. Bowditch [7] gave a somewhat simpler argument.\nIn the remainder of the introduction, we give an outline of the hyperbolicity\nof the curve complex which follows [27] and [7], and where we take a certain\npoetic license.\nThe proof starts by defining a coarse projection \u03c0 : T \u2192 C from Teichm\u00fcller space. To a marked Riemann surface X one associates a curve\nwith smallest extremal length. To see that this is well defined one must\nargue that short curves intersect a bounded number of times (in fact, at\nmost once), and then one uses the inequality\ndC (\u03b1, \u03b2) \u2264 i(\u03b1, \u03b2) + 1\nwhere i denotes the intersection number. Interestingly, the entire argument\nuses only this inequality to estimate distances in C (and only for bounded\nintersection numbers).\nTeichm\u00fcller space carries the Teichm\u00fcller metric, and any two points\nare joined by a unique Teichm\u00fcller geodesic. If t 7\u2192 Xt is a Teichm\u00fcller\ngeodesic, consider the (coarse) path \u03c0(Xt ) in C. One observes:\n(i) The collection of paths \u03c0(Xt ) is (coarsely) transitive, i.e. for any two\ncurves \u03b1, \u03b2 there is a path \u03c0(Xt ) that connects \u03b1 to \u03b2 (to within a\nbounded distance).\nNext, for any Teichm\u00fcller geodesic {Xt } one defines a projection C \u2192\n{Xt }. Essentially, for a curve \u03b1 the projection assigns the Riemann surface\nXt on the path in which \u03b1 has the smallest length. The key lemma is\nthe following (see [27, Lemma 5.8]), proved using the intersection number\nestimate above:\n(ii) If \u03b1, \u03b2 are adjacent in C and X\u03b1 , X\u03b2 are their projections to Xt , then\n\u03c0(X\u03b1 ) and \u03c0(X\u03b2 ) are at uniformly bounded distance in C.\nConsequently, one has a (coarse) Lipschitz retraction C \u2192 \u03c0(Xt ) for\nevery Teichm\u00fcller geodesic Xt . It quickly follows that the paths \u03c0(Xt ) are\nreparametrized quasi-geodesics (this means that they could spend a long\ntime in a bounded set, but after removing the corresponding subintervals\nthe resulting coarse path is a quasi-geodesic with uniform constants, after\npossibly reparametrizing).\nThe final step is:\n3\n\n\f(iii) Triangles formed by three projected Teichm\u00fcller geodesics are uniformly thin.\nHyperbolicity of C now follows by an argument involving an isoperimetric\ninequality (see [7, Proposition 3.1] and our Proposition 7.1).\nOur argument follows the same outline. In place of Teichm\u00fcller metric and Teichm\u00fcller geodesics we use the Lipschitz metric on Outer space\nand folding paths. There are technical complications arising from the nonsymmetry of the Lipschitz metric and the non-uniqueness of folding paths\nbetween a pair of points in Outer space. Our projection from F to a folding path comes in two flavors, left and right, and we have to work to show\nthat the two are at bounded distance from each other when projected to F.\nSimilarly, we have to prove directly that projections of folding paths fellow\ntravel, even when the two have opposite orientations. The role of simple\nclosed curves is played by simple conjugacy classes in F, i.e. nontrivial conjugacy classes contained in some proper free factor.\nThe first two hints that Outer space has some hyperbolic features was\nprovided by Yael Algom-Kfir's thesis [1] and by [5]. Algom-Kfir showed\nthat axes of fully irreducible automorphisms are strongly contracting. In\nthe course of our proof we will generalize this result (see Proposition 7.2)\nwhich states that all folding paths are contracting provided their projections\nto F travel with definite speed. In [5] a certain non-canonical hyperbolic\nOut(F) complex was constructed. It is also known that fully irreducible\nautomorphisms act on F with positive translation length [23, 5].\nBelow is a partial dictionary between Teichm\u00fcller space and Outer space\nrelevant to this work.\nSurfaces\ncurve complex C\nsimple closed curve\nintersection number\ni(\u03b1, \u03b2)\nTeichm\u00fcller space\nTeichm\u00fcller distance\nTeichm\u00fcller geodesic\nTeichm\u00fcller map\nquadratic differential\nhorizontal curve\nvertical curve\n\nFree groups\ncomplex of free factors F\nfree factor,\nor a simple conjugacy class\nnumber of times\na loop in a graph crosses an edge\nOuter space\nLipschitz distance\nfolding path\noptimal map\ntrain track structure on the tension graph\nlegal loop\nillegal loop\n4\n\n\fThe paper is organized as follows. In Section 2 we review the basic notions about Outer space, including the Lipschitz metric, train tracks, and\nfolding paths. Section 3 proves the analog of the inequality dC (\u03b1, \u03b2) \u2264\ni(\u03b1, \u03b2) + 1, using the Whitehead algorithm. Sections 4 and 5 contain some\nadditional material on folding paths, including the formula for the derivative of a length function, as well as the key fact that a simple class which is\nlargely illegal must lose a fraction of its illegal turns after a definite progress\nin F. In Section 6 we define the (left and right) projections of a free factor to a folding path and establish that images in F of folding paths are\nreparametrized quasi-geodesics. The key technical lemma in that section is\nProposition 6.10(legal and illegal) establishing that the two projections are\nat bounded distance when measured in F. We end this section with a very\nuseful method of estimating where the projections lie in Lemma 6.16. In Section 7 we recall the argument that for hyperbolicity it suffices to establish\nthe Thin Triangles condition, and we also derive the contraction property\nof folding paths, measured in F. In Section 8 we prove the Fellow Travelers\nproperty (which of course follows from the Thin Triangles property), in both\nparallel and anti-parallel setting. Finally, in Section 9 we establish the Thin\nTriangles property.\nThe proofs of the three main technical statements in the paper, namely\nProposition 5.4(surviving illegal turns), Proposition 6.10(legal and illegal),\nand Proposition 6.13(closing up to a simple class), should be omitted on the\nfirst reading.\nAcknowledgments. We thank the American Institute of Mathematics and\nthe organizers and participants of the Workshop on Outer space in October\n2010 for a fruitful exchange of ideas. We particularly thank Michael Handel\nfor telling us a proof of Lemma 6.1. We thank Saul Schleimer for an inspiring\nconversation and Yael Algom-Kfir for her comments on an earlier version of\nthis paper. We heartily thank the anonymous referee for a very careful\nreading and many suggestions we feel greatly improved the exposition. We\nalso thank the referee for pointing out an error in one of two arguments we\ngave to finish the proof of Proposition 5.4.\nSince the first version of this paper appeared on the arXiv, there have\nbeen some very interesting developments. Lee Mosher and Michael Handel\n[14] have proved that the free splitting complex S for F is hyperbolic. Ilya\nKapovich and Kasra Rafi [24] have shown that the hyperbolicity of the\ncomplex of free factors follows from the hyperbolicity of the free splitting\ncomplex. Arnaud Hilion and Camille Horbez [22] have proved that S is\n\n5\n\n\fhyperbolic from the point of view of the sphere complex. Brian Mann [25]\nshowed that another Out(F)-complex called the cyclic splitting complex is\nhyperbolic.\n\n2\n\nReview\n\nIn this section we review some definitions and collect standard facts about\nOuter space, Lipschitz metric, train tracks, and folding paths.\nOuter space. A graph is a cell complex G of dimension \u2264 1. The rose\nRn of rank n is the graph with one 0-cell (vertex) and n 1-cells (edges). A\nvertex of G not of valence 2 is topological. The closure in G of a component\nof the complement of the set of topological vertices is a topological edge.\nIn particular, a topological edge may be a circle. A marking of a graph\nG is a homotopy equivalence g : Rn \u2192 G. A metric on G is a function\nl that to each edge e assigns a positive number l(e). We often view the\ngraph G as the path metric space in which each edge e has length l(e). The\nUnprojectivized Outer space cv is the space of equivalence classes of triples\n(G, g, l) where G is a finite graph with no vertices of valence \u2264 2, g is a\nmarking of G, and l is a metric on G. Two triples (G, g, l) and (G\u2032 , g\u2032 , l\u2032 )\nare equivalent if there is a homeomorphism h : G \u2192 G\u2032 that preserves edgelengths and commutes with the markings up to homotopy. Outer space CV\nis the space of projective classes of such (equivalence classes of) triples, i.e.\nmodulo scaling the metric. Equivalently, CV is the space of triples\nP as above\nwhere the metric is normalized so that the volume vol(G) :=\nl(e) = 1.\nAssigning length 0 to an edge is interpreted as a metric on the graph with\nthat edge collapsed, and in this way CV becomes a complex of simplices\nwith missing faces (the missing faces correspond to collapsing nontrivial\nloops), which then induces the simplicial topology on CV . Outer space was\nintroduced by Culler and Vogtmann [9], who showed that CV is contractible.\nWe will usually suppress markings and metrics and talk about G \u2208 CV . It\nis sometimes convenient to pass to the universal cover and regard G \u2208 cv as\nan action of F on the tree G\u0303.\nWe find the following notation useful. If z is a nontrivial conjugacy\nclass, it can be viewed as a loop in the rose Rn , and via the marking can be\ntransported to a unique immersed loop in any marked graph G. This loop\nwill be denoted by z|G. The length of this loop, i.e. the sum of the lengths\nof edges crossed by the loop, counting multiplicities, is denoted by l(z|G).\nNote that if z is not simple, then l(z|G) \u2265 2 vol(G) and in fact z|G must\n\n6\n\n\fcross every edge at least twice.\nMorphisms between trees and train tracks. Recall that a morphism\nbetween two R-trees S, T is a map \u03c6\u0303 : S \u2192 T such that every segment\n[x, y] \u2282 S can be partitioned into finitely many subintervals on which \u03c6\u0303 is\nan isometric embedding. For simplicity, in this paper we work only with\nsimplicial metric trees. A direction at x \u2208 S is a germ of nondegenerate\nsegments [x, y] with y 6= x. The set Dx of directions at x can be thought\nof as the unit tangent space; a morphism \u03c6\u0303 : S \u2192 T determines a map\nD \u03c6\u0303x : Dx \u2192 D\u03c6\u0303(x) , thought of as the derivative. A turn at x is an unordered\npair of distinct directions at x. A turn {d, d\u2032 } at x is illegal (with respect to\n\u03c6\u0303) if D \u03c6\u0303x (d) = D \u03c6\u0303x (d\u2032 ). Otherwise the turn is legal. There is an equivalence\nrelation on Dx where d \u223c d\u2032 if and only if d = d\u2032 or {d, d\u2032 } is illegal. The\nequivalence classes are gates. The collection of equivalence classes at each\nx is called the illegal turn structure on S induced by \u03c6\u0303. If at each x \u2208 S\nthere are at least two gates, the illegal turn structure is called a train track\nstructure on S. This is equivalent to the requirement that \u03c6\u0303 embeds each\nedge of S and has at least two gates at every vertex. A path in S is legal if\nit makes only legal turns.\n\u03c6\u0303\n\nIf S \u2192 T \u2192U is a composition of morphisms then there are two illegal\nturn structures of interest on S: one induced by \u03c6\u0303 and the other induced by\nthe composition. In this situation, we will sometimes refer to the second of\nthese as the pullback illegal turn structure on S via \u03c6\u0303. Note that an illegal\nturn in the first structure is also illegal in the second. In particular, if the\nsecond structure is a train track then so is the first.\nIf S and T are equipped with abstract train track structures (equivalence\nrelation on Dx for every vertex x with at least two gates), we say that a\nmorphism \u03c6\u0303 : S \u2192 T is a train track map if on each edge \u03c6\u0303 is an embedding\nand legal turns are sent to legal turns1 . In particular, legal paths map to\nlegal paths.\nWe also extend this terminology to maps between graphs. If \u03c6 : \u2206 \u2192 \u03a3\n \u0303 \u2192 \u03a3\u0303\nis a map between connected metric graphs such that the lift \u03c6\u0303 : \u2206\nis a morphism of trees, then we also say that \u03c6 is a morphism and we can\n \u0303 which descends to \u2206. If\ndefine the notion of legal and illegal turns on \u2206,\nthere are at least two gates at each point, we have a train track structure\non \u2206. If \u2206 and \u03a3 are equipped with abstract train track structures, the\nmap \u03c6 is a train track map if it sends edges to legal paths and legal turns\n1\n\nThe standard usage of the term train track map is to self-maps of a graph, but this\nnatural extension of the terminology should not cause any confusion.\n\n7\n\n\fto legal turns. When the graphs \u2206 or \u03a3 are not connected we work with\ncomponents separately.\nLipschitz metric and optimal maps. Let G and G\u2032 be two points in\ncv. The homotopy class of maps h : G \u2192 G\u2032 such that hg \u2243 g\u2032 (with g, g\u2032\nmarkings for G, G\u2032 ) is called the difference of markings. If G and G\u2032 are in\nCV , i.e. if they have volume 1, the Lipschitz distance dCV (G, G\u2032 ) between\nG and G\u2032 is the log of the minimal Lipschitz constant over all difference of\nmarkings maps G \u2192 G\u2032 . The Lipschitz distance is an asymmetric metric\non CV inducing the correct topology. For more information, see [11, 2, 4].\nThe basic fact, that plays the role of Teichm\u00fcller's theorem in Teichm\u00fcller\ntheory, is the following statement, due to Tad White. For a proof see [11]\nor [4].\nProposition 2.1. Let G, G\u2032 \u2208 cv. There is a difference of markings map\n\u03c6 : G \u2192 G\u2032 with the following properties.\n\u2022 \u03c6 sends each edge of G to an immersed path (or a point) with constant\nspeed (called the slope of \u03c6 on that edge).\n\u2022 The union of all edges of G on which \u03c6 has the maximal slope \u03bb = \u03bb(\u03c6),\nis a subgraph of G with no vertices of valence 1. This subgraph is called\nthe tension graph, denoted \u2206 = \u2206(\u03c6).\n\u2022 \u03c6 induces a train track structure on \u2206.\nThe last bullet says that the map \u03bb\u2206 \u2192 G\u2032 induced by \u03c6 is a morphism immersing edges and each vertex has at least two gates. Note that\nthe Lipschitz constant of \u03c6 is \u03bb and so, in the case that G, G\u2032 \u2208 CV , we\nhave that dCV (G, G\u2032 ) \u2264 log \u03bb. In fact equality holds since the presence of at\nleast two gates at each vertex of \u2206 guarantees that it contains legal loops,\nwhose length gets stretched by precisely \u03bb so there can be no better map\nhomotopic to \u03c6. We call any \u03c6 satisfying Proposition 2.1 an optimal map.\nA morphism that induces a train track structure is an example of an optimal map. Unfortunately, unlike Teichm\u00fcller maps, optimal maps are not\nuniquely determined by G, G\u2032 .\nA legal loop can be constructed in \u2206 by starting with an edge and\nextending it inductively to longer legal edge paths until some oriented edge\nis repeated. In fact, this guarantees the existence of a \"short\" legal path.\nWe will say a loop in \u2206 is a candidate if it is either embedded, or it forms the\nfigure 8, or it forms a \"dumbbell\". Every candidate determines a conjugacy\n\n8\n\n\fclass that generates a free factor of rank 1. Thus graph \u2206 admits a legal\ncandidate. See [11].\nFolding at speed 1. Now assume that S, T represent points of Unprojectivized Outer space cv (i.e. they are universal covers of marked metric\ngraphs), and \u03c6\u0303 : S \u2192 T is an equivariant morphism. Equivariantly subdivide S so that \u03c6\u0303 embeds each edge and the inverse image under \u03c6\u0303 of a\nvertex of T is a vertex of S. Choose some \u01eb > 0 smaller than half of the\nlength of any edge in S. Then for t \u2208 [0, \u01eb] define the tree St as the quotient\nof S by the equivalence relation: u \u223ct v if and only if there is a vertex x\nwith d(x, u) = d(x, v) \u2264 t and \u03c6\u0303(u) = \u03c6\u0303(v). Then St represents a point in\n\u03c6\u03030t\n\n\u03c6\u0303t\u221e\n\ncv and \u03c6\u0303 factors as S \u2192 St \u2192 T for some equivariant morphism \u03c6\u0303t\u221e and\nthe quotient map \u03c6\u03030t : S \u2192 St , which is also an equivariant morphism. The\ntrees St , t \u2208 [0, \u01eb] form a path in cv, and S0 = S. We say that St is the path\nobtained from S by folding all illegal turns at speed 1 with respect to \u03c6\u0303.\nIf \u03c6\u0303 induces only one gate at some vertex v \u2208 S, then St will have a\nvalence 1 vertex for t > 0. In that case we always pass to the minimal subtree\nof St . When \u03c6\u0303 induces a train track structure on S, St is automatically\nminimal (if S is). For simplicity we state Proposition 2.2 in the train track\nsituation only.\nProposition 2.2. Let \u03c6\u0303 : S \u2192 T be an equivariant morphism between two\ntrees in cv inducing a train track structure on S. There is a (continuous)\npath St in cv, t \u2208 [0, \u221e), and there are equivariant morphisms \u03c6\u0303st : Ss \u2192 St\nfor s \u2264 t so that the following holds:\n(1) S0 = S, St = T for t large;\n(2) \u03c6\u0303tt = Id, \u03c6\u0303su = \u03c6\u0303tu \u03c6\u0303st for s \u2264 t \u2264 u;\n(3) \u03c6\u03030t = \u03c6\u0303 and \u03c6\u0303tt\u2032 = Id for large t < t\u2032 ;\n(4) each \u03c6\u0303st isometrically embeds edges and induces at least two gates at\nevery vertex of Ss ;\n(5) for s < t, t\u2032 the illegal turns at vertices of Ss with respect to \u03c6\u0303st coincide with those with respect to \u03c6\u0303st\u2032 , so Ss has a well-defined train track\nstructure; and\n(6) for every s < t there is \u01eb > 0 so that Ss+\u03c4 , \u03c4 \u2208 [0, \u01eb] is obtained from Ss\nby folding all illegal turns at speed 1 with respect to \u03c6\u0303st .\nMoreover, this path is unique.\n9\n\n\fProof. Uniqueness is clear from the definition of folding at speed 1. There\ncan be no last time s so that two paths satisfying the above conditions agree\n(including the maps \u03c6\u0303tt\u2032 ) up to Ss but no further, by item (6).\nThere are three methods to establish existence, and they will be only\nsketched.\n2.2.A. Stallings' Method. This works when S and T can be subdivided so that \u03c6\u0303 is simplicial and all edge lengths are rational (or fixed\nmultiples of rational numbers). In our applications we can arrange that this\nassumption holds. Then we may subdivide further so that all edge lengths\nare equal. The path St is then obtained exactly as in the Stallings' beautiful\npaper [30], by inductively identifying any pair of edges with a common vertex that map to the same edge in T . This operation of elementary folding\ncan be performed continuously to yield a 1-parameter family of trees, i.e.\na path, between the original tree and the folded tree. Putting these paths\ntogether gives the path St .\n2.2.B. Via the vertical thickening of the graph of \u03c6\u0303. This method\nis due to Skora [29], who built on the ideas of Steiner. Skora's preprint\nwas never published; the interested reader may find the details in [8] and\n[12]. Consider the graph of \u03c6\u0303 as a subset of S \u00d7 T and define the \"vertical\nt-thickening\" of it as\nWt = {(x, y) \u2208 S \u00d7 T | d(\u03c6\u0303(x), y) \u2264 t}\nNext, consider the decomposition Dt of Wt into the path components of the\nsets Wt \u2229 S \u00d7 {y}, y \u2208 T . Let St = Wt /Dt be the decomposition space\nwith the metric defined as follows. A path in Wt is linear if its projection\nto both S and T has constant speed (possibly speed 0). A piecewise linear\npath \u03b3 in Wt is taut if the preimages \u03b3 \u22121 (l) of leaves in Dt are connected.\nThen define the distance in St as the length of the projection to T of any\npiecewise linear taut path connecting the corresponding leaves in Wt . In this\nway St becomes a metric tree. The morphisms \u03c6\u0303st are induced by inclusion\nWs \u0592\u2192 Wt .\n2.2.C. Via integrating the speed 1 folding direction. Starting\nat S consider the path St , t \u2208 [0, \u01eb], obtained by folding all illegal turns at\nspeed 1. Now extend this path by folding all illegal turns of S\u01eb at speed 1.\nContinue in this way inductively, and show that either T is reached in finitely\nmany steps, or there is a well defined limiting tree, from which folding can\nproceed. This is the approach taken in [11], to which the reader is referred\nfor further discussion.\nOne possible approach is as follows. Say St is defined for t \u2208 [0, t0 ) with\nS0 = S. To define the limiting tree St0 , note that for each conjugacy class,\n10\n\n\fthe length along the path is nonincreasing and thus converges. The limiting\nlength function defines a tree, representing a point in compactified Outer\nspace. The lengths of conjugacy classes are bounded below by their values\nin T , so the limiting tree St0 is free simplicial and thus represents a point in\nOuter space. We may view the tree St0 as the equivariant Gromov-Hausdorff\nlimit of the path St . The maps S \u2192 St , viewed as subsets of S \u00d7 St via their\ngraphs, subconverge to a morphism S \u2192 St0 , and similarly by a diagonal\nargument one constructs morphisms St \u2192 St0 that compose correctly. To\nshow uniqueness of such morphisms, one uses Gromov-Hausdorff limits and\nthe fact that the only (equivariant) morphism St0 \u2192 St0 is the identity.\nThe path St , t \u2208 [0, \u221e) from Proposition 2.2 is the path induced by \u03c6\u0303.\nLemma 2.3 will be used in the proof of Theorem 4.2. Its proof is immediate\nfrom 2.2.B.\nLemma 2.3. Let St , t \u2208 [0, \u221e), be the path in cv induced by \u03c6\u0303 : S \u2192 T\nand [s1 , s2 ] be a path in S0 . Suppose \u03c6\u0303(s1 ) = \u03c6\u0303(s2 ) and set h equal to the\noutradius of \u03c6\u0303([s1 , s2 ]) with respect to \u03c6\u0303(s1 ), i.e.\nh = max dT (\u03c6\u0303(s1 ), \u03c6\u0303(s))\ns\u2208[s1 ,s2 ]\n\nThen s1 and s2 are identified by time h but not before, i.e. \u03c6\u03030t (s1 ) = \u03c6\u03030t (s2 )\niff t \u2265 h.\nFolding paths. Suppose S \u2192 T is an equivariant morphism between trees\nin cv that induces a train track structure on S. The induced path St ,\nt \u2208 [0, \u221e), is a folding path in cv. The projection of St to CV is a folding\npath in CV . A folding path Gt in CV can be parametrized by arclength, so\nthat dCV (Gt\u2032 , Gt ) = t \u2212 t\u2032 for t\u2032 \u2264 t.\nNotation 2.4. From now on, we switch to thinking of points of Outer space\nas finite graphs when discussing folding paths. We have several meanings\nfor folding path. To avoid confusion, we will use the following notation:\n(1) \u011ct , t \u2208 [0, \u221e), denotes a folding path in cv, i.e. a path in cv induced by\nan equivariant morphism S \u2192 T giving a train track structure on S. If\n\u03c9 \u2208 [0, \u221e) is minimal such that \u011c\u03c9 = T , we also refer to \u011ct , t \u2208 [0, \u03c9],\nas a folding path. We call t the natural parameter.\n(2) \u1e20t , t \u2208 [0, \u221e), (or \u1e20t , t \u2208 [0, \u03c9]) denotes a folding path in CV obtained\nby projecting a path \u011ct as in (1). So, \u1e20t = \u011ct /vol(\u011ct ).\n11\n\n\f(3) Gt , t \u2208 [0, L], denotes a path as in (2), but reparametrized in terms of\narclength with respect to dCV . So, Gt(s) = \u1e20s where\nt(s) = dCV (\u1e200 , \u1e20s ) = log\n\n\u0012\n\nvol(\u011c0 )\nvol(\u011cs )\n\n\u0013\n\n\u2032\n\nFor all t \u2264 t\u2032 \u2208 [0, L] there is a morphism et \u2212t Gt \u2192 Gt\u2032 .\nUnless otherwise noted, a folding path Gt without further adjectives or decorations will mean a folding path as in (3).\nProposition 2.5 ([11]). Let G, \u03a3 \u2208 CV . There is a geodesic in CV from G\nto \u03a3 which is the concatenation of two paths, the first is a (reparametrized)\nlinear path in a single simplex of CV , and the second is a folding path in\nCV parametrized by arclength.\nProof. Fix an optimal map \u03c6 : G \u2192 \u03a3 and let \u2206 = \u2206(\u03c6) \u2282 G be its tension\ngraph with maximal slope \u03bb = \u03bb(\u03c6). If \u2206 = G then the rescaled map\n\u03bb\u03c6 : \u03bbG \u2192 \u03a3 is a morphism and satisfies the requirement that it induces\na train track structure on G. Proposition 2.2 gives a folding path \u011ct in\ncv from \u03bbG to \u03a3 and morphisms \u03c6\u0302st : \u011cs \u2192 \u011ct . To see that \u011ct projects\nto a geodesic \u1e20t in CV , note that \u03c6\u0302su = \u03c6\u0302tu \u03c6\u0302st for s < t < u implies\ndCV (\u1e20s , \u1e20u ) = dCV (\u1e20s , \u1e20t ) + dCV (\u1e20t , \u1e20u ).\nNow suppose \u2206 6= G. Denote by e1 , * * * , ek the (topological) edges of\nG outside of \u2206. For each tuple x = (x1 , x2 , * * * , xk ) of lengths in the cube\n[0, l1 ] \u00d7 [0, l2 ] \u00d7 * * * \u00d7 [0, lk ], where li is the length of ei in G, denote by \u03bc(x)\nthe smallest maximal slope among maps G \u2192 \u03a3 that are homotopic to \u03c6\nrel \u2206, where G is given the metric x outside \u2206 (so \u03bc(x) = \u221e if some loop\nis assigned length 0). Among all x in the cube with \u03bc(x) = \u03bb choose one\nwith the smallest sum of the coordinates, say x0 . Denote by \u011c\u2032 \u2208 cv the\ngraph G with the metric x0 outside of \u2206. (Some edges of \u011c\u2032 may get length\n0 in which case its projection G\u2032 to CV is on the boundary of the original\nsimplex.)\nLet \u03c60 : \u011c\u2032 \u2192 \u03a3 be a map homotopic to \u03c6 rel \u2206, linear on edges,\nand with the maximal slope \u03bb(\u03c60 ) = \u03bb. We claim that \u03c60 is optimal with\n\u2206(\u03c60 ) = \u011c\u2032 . Indeed, \u2206(\u03c60 ) = \u011c\u2032 (otherwise some edge length can be\nreduced contradicting the choice of x0 ) and \u03c60 induces at least two gates\nat every vertex (otherwise \u03c60 may be perturbed so that the tension graph\nbecomes a proper subgraph, see the proof of Proposition 2.1 e.g. in [4]).\nSince we have maps G \u2192 \u011c\u2032 and \u011c\u2032 \u2192 \u03a3 with slopes 1 and \u03bb respectively,\nwe also have dCV (G, \u03a3) = dCV (G, G\u2032 ) + dCV (G\u2032 , \u03a3).\n12\n\n\f3\n\nDetecting boundedness in the free factor complex F\n\nIn this section we define a coarse projection \u03c0 : CV \u2192 F and prove an analog\nof the inequality dC (\u03b1, \u03b2) \u2264 1 + i(\u03b1, \u03b2) (see Lemma 3.2). An immediate\nconsequence is that \u03c0 is coarsely Lipschitz (see Corollary 3.5).\nRecall that a nontrivial conjugacy class x in F is simple if any (equivalently some) representative is contained in a proper free factor. If x is a\nsimple class, denote by \u1e8b the conjugacy class of a smallest free factor containing a representative of x. A proper connected subgraph P of a marked\ngraph G that contains a circle defines a vertex \u1e56 of F.\nLemma 3.1. Let G be a marked graph. If P, Q \u2282 G are proper connected\nsubgraphs defining free factors \u1e56 , Q\u0307 then dF (\u1e56 , Q\u0307) \u2264 4.\nProof. If rank(F) = 2 then dF (\u1e56 , Q\u0307) \u2264 1 (using the modified definition of\nF). Now assume rank(F) \u2265 3. Enlarge P, Q to connected graphs P \u2032 , Q\u2032\nthat contain all but one edge of G. Thus their intersection contains a circle\nR, so we have a path in F given by subgraphs P, P \u2032 , R, Q\u2032 , Q and we see\ndF (\u1e56 , Q\u0307) \u2264 4.\nIf G is a marked graph, define\n\u03c0(G) := {\u1e56 | P is a proper, connected, noncontractible subgraph of G}\nThe induced multi-valued, Out(F)-equivariant map CV \u2192 F , still called \u03c0,\ngiven by G 7\u2192 \u03c0(G) is coarsely defined in that, by Lemma 3.1, the diameter\nof each \u03c0(G) is bounded by 4. We refer to \u03c0 as the coarse projection from\nCV to F.\nLemma 3.2. Let G be a marked graph and x a simple class in F. If x|G\ncrosses an edge e k times, then the distance in F between \u1e8b and some free\nfactor represented by a subgraph of G is \u2264 6k + 9.\nProof. This proof will use the fact, due to Reiner Martin [26], that if the\nWhitehead graph of a simple class x is connected then it has a cut point.\nThe classical fact, due to Whitehead [32], is the analogous statement for\nthe special case that x is primitive2 . Stallings' paper [31] is a good modern\nreference for Whitehead's result and the reader is directed there for the\ndefinitions of Whitehead graph and Whitehead automorphism.\n2\n\nan element of some basis for F.\n\n13\n\n\fFirst assume that e is nonseparating. By collapsing a maximal tree in G\nthat does not contain e we may assume that G is a rose. Let a1 , a2 , * * * , am , c\nbe the associated basis with c corresponding to e and set A = ha1 , * * * , am i.\nThus c\u00b11 appears in the cyclic word for x k times. If the Whitehead graph\nof x is disconnected, consider a 1-edge blowup G\u0303 of G so that x realized in G\u0303\nis contained in a proper subgraph. In this case dF (\u1e8b, A) \u2264 5 by Lemma 3.1\n(4 for the distance between A and the free factor determined by the image\nof x, and 1 more to get to \u1e8b). If the Whitehead graph is connected then it\nhas a cut point [32, 26]. Let \u03c6 be the associated Whitehead automorphism.\nIf the special letter is some a\u00b11\nthen the free factor A is \u03c6-invariant. If\ni\n\u00b11\nthe special letter is c then dF (A, \u03c6(A)) \u2264 6 (dF (A, hci) \u2264 3 and hci is\nfixed by \u03c6). But there are at most k automorphisms of the latter kind in\nthe process of reducing x until its Whitehead graph is disconnected. Thus\ndF (\u1e8b, A) \u2264 6k + 5.\nNow assume e is separating. By collapsing a maximal tree on each side\nof e we may assume that G is the disjoint union of two roses RA and RB\nconnected by e. Let a1 , * * * , an and b1 , * * * , bm be the bases determined by\nRA and RB respectively. Notice that the assumption about e means that\nthere are k times when the cyclic word for x changes from the ai 's to the\nbj 's or vice versa (k is necessarily even here). If the Whitehead graph of x\nwith respect to a1 , * * * , an , b1 , * * * , bm is disconnected, we see as above that\ndF (\u1e8b, A) \u2264 5 where A = ha1 , * * * , an i. Otherwise there is a cut point and let\n\u03c6 be the associated Whitehead automorphism. If the special letter is some\na\u00b11\nthen A is \u03c6-invariant. Likewise, \u03c6(A) is conjugate to A if the special\ni\n\u00b11\nletter is b\u00b11\nj and all the ai are on one side of the cut. If they are not on one\nside of the cut, then the subgraph spanned by the a\u00b11\ni 's is disconnected and\nwe may consider the associated 1-edge blowup R\u0303A of RA . Let G\u0303 be the 1edge blowup of G obtained by attaching e\u222aRB to R\u0303A along either of the two\nvertices. The blowup edge e\u2032 can be crossed by x only if it is immediately\nfollowed or preceded by e (but not both). Thus x crosses e\u2032 at most k times.\nIf e\u2032 is nonseparating then by the first paragraph dF (\u1e8b, \u1e56 ) \u2264 6k + 5 for some\nsubgraph P \u2282 G\u0303 and so dF (\u1e8b, hb1 , * * * , bm i) \u2264 6k + 9. If e\u2032 is separating\nreplace A by a smaller free factor A\u2032 and continue.\nWe introduce the following notation. Suppose G, G\u2032 are marked graphs,\nA is a proper free factor of F, and x is a simple class in F. Then:\n\u2022 dF (G, G\u2032 ) := sup{dF (A, A\u2032 ) | A \u2208 \u03c0(G), A\u2032 \u2208 \u03c0(G\u2032 )}\n\u2022 dF (A, G\u2032 ) := sup{dF (A, A\u2032 ) | A\u2032 \u2208 \u03c0(G\u2032 )}\n\n14\n\n\f\u2022 dF (G, x) := dF (G, \u1e8b)\n\u2022 dF (A, x) := dF (A, \u1e8b)\nFor example, Lemmas 3.1 and 3.2 combine to give the following:\nLemma 3.3. Let x be a simple class in F and G a marked graph so that\nx|G crosses some edge \u2264 k times. Then dF (G, x) \u2264 6k + 13.\nRemark 3.4. Let z be a conjugacy class in F and G \u2208 CV a marked graph.\nSince vol(G) = 1, there is an edge of G that is crossed at most [l(z|G)] times\nby z|G.\nCorollary 3.5. If dCV (G, G\u2032 ) \u2264 log K then dF (G, G\u2032 ) \u2264 12K + 32.\nProof. Let z be a candidate that realizes dCV (G, G\u2032 ). Thus l(z|G) < 2, z|G\ncrosses some edge once and l(z|G\u2032 ) < 2K, so z|G\u2032 crosses some edge < 2K\ntimes. Therefore\ndF (G, G\u2032 ) \u2264 dF (G, z) + dF (z, G\u2032 ) \u2264 19 + (12K + 13) = 12K + 32\n\nIn most of the paper we will be concerned with showing that distances in\nF are bounded above. We will use the obvious terminology: In Corollary 3.5\nwe showed that the distance in F between projections of graphs from CV\nare bounded above as a function of the distance in CV .\nConvention 3.6 (Bounded distance). When we say a distance in F is bounded\nwithout any variables, we mean bounded above by a universal constant that\ndepends only on the rank n of F.\nNote that Corollary 3.5 says that \u03c0 : CV \u2192 F is coarsely Lipschitz : If\ndCV (G, G\u2032 ) \u2264 N with N an integer, then dF (G, G\u2032 ) \u2264 CN for a universal\nC > 0. Indeed, choose a geodesic from G to G\u2032 and apply Corollary 3.5 N\ntimes to pairs of points at distance \u2264 1.\nBy the injectivity radius injrad(G) of a metric graph G we mean the\nlength of a shortest embedded loop in G. If A is a finitely generated subgroup\nof F and \u011c \u2208 cv we denote by A|\u011c the core of the covering space of \u011c\ncorresponding to A. Thus there is a canonical immersion A|\u011c \u2192 \u011c. We\nadopt the following convention: Unless otherwise specified, the metric and\nillegal turn structures on A|\u011c are the ones obtained by pulling back via\nA|\u011c \u2192 \u011c.\n\n15\n\n\fCorollary 3.7. Suppose A is a proper free factor of F and G \u2208 CV . If\ninjrad(A|G) < k + 1 then dF (A, G) \u2264 6k + 14.\nProof. This follows immediately from Remark 3.2 and Lemma 3.3.\nCoarse paths in F obtained from folding paths by projecting will play a\ncrucial role.\nCorollary 3.8. The collection of projections to F of folding paths in CV\nis a coarsely transitive family: for any two proper free factors A, B of F\nthere is a folding path Gt , t \u2208 [0, L], such that A \u2208 \u03c0(G0 ) and B \u2208 \u03c0(GL ).\nThe same is true for the subcollection consisting of folding paths induced by\nmorphisms that satisfy the rationality condition from the Stallings method\nof folding in 2.2.A.\nProof. Let A, B be two free factors. Choose G, \u03a3 \u2208 CV so that some subgraph of G represents A and some subgraph of \u03a3 represents B, and so that\nG is a rose, and apply Proposition 2.5 to obtain a geodesic from G to \u03a3 that\nis the concatenation of two paths, the first a linear path from G to G\u2032 in\na single simplex, and the second a folding path from G\u2032 to G. The initial\nlinear path keeps the underlying graph a rose and its coarse projection is\nconstant. Thus, the desired folding path is the second path from G\u2032 to \u03a3.\nTo achieve rationality, choose \u03a3 to be a rose with rational edge lengths.\nLet \u03c6 : G \u2192 \u03a3 be an optimal map after adjusting the metric so that \u2206(\u03c6) =\nG. If the vertex of G maps to the vertex of \u03a3, rationality is automatic.\nOtherwise the vertex of G maps to a point in the interior of some edge.\nPerturb \u03c6 so that this point is rational, and adjust the edge lengths in G\nso that the perturbed map is optimal, with the same train track structure.\nThe new map satisfies rationality.\n\n4\n\nMore on folding paths\n\nWe now discuss folding in more detail. Let \u011ct , t \u2208 [0, \u03c9], be a folding path\nin cv (from now on we replace trees by quotient graphs) with the natural\nparametrization. (See Notation 2.4 to recall our conventions.) So for s < t\nwe have maps \u03c6\u0302st : \u011cs \u2192 \u011ct that have slope 1 on each edge, immerse each\nedge, and induce train track structures.\nUnfolding. Traversing a folding path in reverse is unfolding. The main\nresult of this subsection is Theorem 4.2 giving local and global pictures of\nboth folding and unfolding. This result will only be used for the proofs of\n16\n\n\ftechnical Propositions 5.4(surviving illegal turns) and 6.10(legal and illegal)\nwhich should be skipped in a first reading. In fact, Theorem 4.2 is obvious\nin the case of Stallings' rational paths (see 2.2.A) and so could be avoided\naltogether (see Corollary 3.8).\nDefinition 4.1. An (abstract) widget W of radius \u01eb is a metric graph that is\na cone on finitely many, but at least 2, points all the same distance \u01eb from\nthe cone point. A widget has a canonical morphism to W \u2192 [0, \u01eb] that sends\nthe cone point to \u01eb and the other vertices to 0. There is also a canonical\npath, parametrized by [0, \u01eb], of finite trees from W to [0, \u01eb] that locally folds\nall legal turns of the morphism with speed 1. See Figure 1. An (abstract)\ngadget of radius \u01eb is a union of finitely many widgets of radius \u01eb. The union\nis required to be disjoint except that widgets are allowed to meet in vertices\nand is also required to be a forest. There is a canonical path, parametrized\nby [0, \u01eb], of forests obtained by folding each widget.\n\n\u03b5\n\n0\nFigure 1: An abstract widget of radius \u01eb.\nLet \u011c \u2208 cv. A widget (resp. gadget) of radius \u01eb in \u011c, is an embedding\nin \u011c of an abstract widget (resp. abstract gadget) of radius \u01eb. There is\na natural path in cv starting with \u011c and parametrized by [0, \u01eb] given by\nfolding the gadget. See Figure 2. An (abstract) widget, resp. gadget is a\nwidget, resp. gadget, of some radius.\nTheorem 4.2. Let \u011ct , t \u2208 [0, \u03c9] be a folding path in cv with its natural\nparametrization. There is a partition 0 = t0 < t1 < * * * < tN = \u03c9 of [0, \u03c9]\nsuch that the restriction of \u011ct to each [ti , ti+1 ] is given by folding a gadget\nin \u011cti .\nIn the context of Theorem 4.2, we say that, as we traverse [ti , ti+1 ] in\nreverse, we are unfolding a gadget. The analogous result holds for the induced path Gt , t \u2208 [0, L], in CV parametrized by arclength and we use\nthe same terminology. For example, we say [0, L] has a finite partition into\nsubintervals such the restriction of Gt to each subinterval is given by folding\n(unfolding) a gadget.\nProposition 4.3 is an immediate consequence of Theorem 4.2.\n17\n\n\fProposition 4.3. Let Gt , t \u2208 [0, L], be a folding path in CV . There is a\npartition of [0, L] into finitely many subintervals so that the restriction of\nGt to each subinterval is a (reparametrized) linear path in a simplex of CV .\nIn particular, a folding path in CV changes an open simplex only at\ndiscrete times. Outside these times, illegal turns all belong to vertices with\n2 gates, and one gate is a single direction.\nThe restriction of a folding path to a simplex of CV need not be linear.\nThis can happen, for example, if an illegal turn becomes legal.\nThe rest of this subsection is devoted to proving Theorem 4.2. It is clear\nfrom our description of folding in 2.2.C that, for each t\u2217 \u2208 [0, \u03c9), there is\n\u01eb > 0 such that the restriction of \u011ct to [t\u2217 , t\u2217 + \u01eb] is given by folding a gadget\nin \u011ct\u2217 . To complete the proof of Theorem 4.2, we will show that, for each\nt\u2217 \u2208 (0, \u03c9], there is \u01eb > 0 such that the restriction of \u011ct to [t\u2217 \u2212 \u01eb, t\u2217 ] is given\nby folding a gadget in \u011ct\u2217 \u2212\u01eb .\nLet N be the closed \u01eb-neighborhood of a vertex v in \u011ct\u2217 of valence \u2265 3.\nWe will describe the preimage N\u01eb of N in \u011ct\u2217 \u2212\u01eb for small enough \u01eb > 0.\nAs long as \u01eb is small enough and N\u01eb \u2192 N is not injective, we will find\na connected gadget of radius \u01eb in N\u01eb so that N\u01eb \u2192 N folds this gadget.\nThe gadget needed to complete the proof will be the disjoint union of these\nconnected gadgets of radius \u01eb, one for each such vertex of Gt\u2217 . We will also\nequip N and N\u01eb with height functions. For convenience, set \u03c6\u0302\u01eb := \u03c6\u0302t\u2217 \u2212\u01eb,t\u2217 .\nFirst we describe the height functions. Assume that \u01eb is small enough\nso that N is a cone on a finite set with cone point v. The height function\non N is the morphism N \u2192 [\u2212\u01eb, \u01eb] given as follows. If the length in N of\n[v, w] is \u01eb and the direction at v determined by [v, w] has more than one\npreimage in N\u01eb , then map [v, w] isometrically to [0, \u01eb]; otherwise map [v, w]\nisometrically to [0, \u2212\u01eb]. The height function h on N\u01eb is the composition\nN\u01eb \u2192 N \u2192 [\u2212\u01eb, \u01eb].\nNow we describe N\u01eb for small enough \u01eb, and justify this description immediately after that. In N\u01eb , the preimage of v is the set of points of height 0.\nThe set h\u22121 ([0, \u01eb]) is a gadget with widgets the closures of the components of\nh\u22121 ((0, \u01eb]). Each of the height \u01eb vertices has a unique direction in \u011ct\u2217 \u2212\u01eb not\nin the gadget, and we draw this direction upwards. Height 0 vertices may\nhave additional directions not contained in the gadget, and we draw those\ndownwards. See Figure 2. All illegal turns in N\u01eb appear at vertices of height\n\u01eb and these vertices have two gates in \u011ct\u2217 \u2212\u01eb (all downward directions form\none gate and the single upward direction is the other gate). In particular,\nall turns at the height 0 vertices are legal. After the widgets are folded, in\n\u011ct\u2217 , the height 0 vertices get identified to v, each widget contributes an up18\n\n\fN\u03b5\n\nN\n\n\u03b5\n\nv\n\n0\n\n\u2212\u03b5\nFigure 2: An example of N\u01eb with 3 widgets, 3 vertices at height \u01eb and 5\nvertices at height 0. The union of the 3 widgets is a gadget.\n\nward direction at v, and the downward directions at v come from downward\ndirections in N\u01eb based at height 0 vertices. Some pairs of directions may be\nillegal in \u011ct\u2217 , but in that case they have to come from directions in N\u01eb that\ndon't form a turn (i.e. that are based at different vertices).\nNow we justify our description of N\u01eb . First choose \u01eb0 small enough so\nthat:\n(1) the closed \u01eb0 -neighborhood of v is a cone on a finite set with cone point\nv and\n(2) the cardinality of the preimage of v in N\u01eb and the number of directions\nbased at points in the preimage of v is independent of 0 < \u01eb \u2264 \u01eb0 ;\nNote that it is possible to choose \u01eb0 satisfying (2) because, since all \u03c6\u0302st are\nsurjective, the cardinality of \u03c6\u0302\u22121\n\u01eb (v) is non-increasing as \u01eb decreases, and\nsimilarly the number of directions based at \u03c6\u0302\u22121\n\u01eb (v) is non-increasing.\nChoose 0 < \u01eb1 < \u01eb0 so that the closed \u01eb1 -neighborhood N \u2032 in N\u01eb0 of\nthe preimage of v contains no valence \u2265 3 vertices of \u011ct0 \u2212\u01eb0 other than the\npreimages of v. We claim that, for 0 < \u01eb \u2264 \u01eb1 , N\u01eb has the description given\nabove. It is enough to consider the case \u01eb = \u01eb1 because our description of\nN\u01eb is stable under decreasing \u01eb.\nBy definition, N\u01eb1 is the preimage in \u011ct\u2217 \u2212\u01eb1 of N . It is equal to the\nclosed \u01eb1 -neighborhood of the preimage of v. (Indeed, it is clear that the\nneighborhood is in N\u01eb1 . If w \u2208 N\u01eb1 does not map to v, then since \u011ct\u2217 \u2212\u01eb1 has\na train track structure there is a direction at w whose image in N points\ntoward v and there is a legal path of length |h(w)| starting at this direction.\nThe endpoint of the path then maps to v.) Similarly, N \u2032 is the preimage in\n\u011ct\u2217 \u2212\u01eb0 of N . In particular, N \u2032 \u2192 N\u01eb1 is surjective.\n19\n\n\fN \u2032 is a disjoint union of cones on points of height \u00b1\u01eb1 with cone points\nthe preimages of v. Notice that all turns in N \u2032 are legal (or else (2) fails).\nN \u2032 \u2192 N\u01eb1 is an embedding off the points of height \u00b1\u01eb1 in N \u2032 (otherwise there\nwould be a path in N\u01eb1 between distinct directions at preimages of v whose\nimage has outradius with respect to v that is less than \u01eb1 , by Lemma 2.3\nthese distinct directions would then be identified before time t\u2217 , and we\ncontradict (2)). In fact, N \u2032 \u2192 N\u01eb1 is an embedding off points of height \u01eb\n(otherwise there would be a path \u03c3 in N\u01eb1 that is cone on a pair of distinct\npoints in the preimage of v with cone point of height \u2212\u01eb1 , contradicting the\ndefinition of h since the directions at the ends of \u03c3 are identified in \u011ct\u2217 ).\nWe see that N\u01eb1 is the obtained from N \u2032 by identifying some pairs of points\nof height \u01eb. The picture is completed with a few observations.\n\u2022 N\u01eb1 is connected: By Lemma 2.3, any two points in the the preimage of\nv in N\u01eb1 are connected by a path in N\u01eb1 (or else they aren't identified\nin \u011ct\u2217 ). So, the preimage of v is contained in a single component and\nfrom the picture we've developed so far we see that N\u01eb1 is connected.\n\u2022 N\u01eb1 is a tree: A loop \u03c3 in N\u01eb1 has homotopically trivial image in N .\nSince \u03c6\u0302\u01eb1 is a homotopy equivalence, \u03c3 is homotopically trivial.\n\u2022 Every point w in N\u01eb1 of height \u01eb1 has at least two downward directions:\nOtherwise, there is a point v \u2032 in the preimage of v and a path [v \u2032 , w]\nof increasing height with the property that the induced direction at v \u2032\nis not identified by \u03c6\u0302\u01eb1 with any other direction. This contradicts the\ndefinition of positive height.\nThis completes the proof of Theorem 4.2.\nFix \u01eb \u2264 \u01eb1 . We introduce a little more terminology for later use. By\nconstruction, every point in \u011ct\u2217 at distance \u01eb from v has a unique direction\npointing away from v. If d is a direction at v, there is then a unique corresponding direction d\u2032 pointing away from v and based at a point at distance\n\u01eb from v determined by \"d points to d\u2032 \". If the height of d\u2032 is \u01eb then we\ndenote d\u2032 by d\u01eb ; if the height of d\u2032 is \u2212\u01eb then we denote d\u2032 by d\u2212\u01eb . We say\nthat d\u01eb points up and d\u2212\u01eb points down. The direction d\u00b1\u01eb has a unique lift\nd \u0303\u00b1\u01eb to \u011ct\u2217 \u2212\u01eb . We say d \u0303\u01eb points up and d \u0303\u2212\u01eb points down . See Figure 6.\nUnfolding a path. Given an immersed path \u03b3 in \u011c\u03c9 , one may try to \"lift\"\nit along the folding path, i.e. to find immersed paths \u03b3t in \u011ct that map to\n\u03b3 (up to homotopy rel endpoints). This is always possible, since it is clearly\npossible locally. At discrete times new illegal turns may appear inside the\n20\n\n\fpath. Note that at discrete times the lifts are not unique, when an endpoint\nof the path coincides with the vertex of an illegal turn. Figure 3 illustrates\nthe nonuniqueness of lifts.\n\nv\n\nFigure 3: The figure illustrates the ambiguity in lifting paths under unfolding\nwhich we see is parametrized by the preimage of v.\nTo get uniqueness, we can remove the end of the path that lifts nonuniquely.\nThus we may have to remove segments3 at the ends whose size grows at speed\n1. Now suppose there are illegal turns in the path. As we unfold, each illegal turn makes the length of the path grow with speed 2, and the illegal\nturn closest to an end moves away from the end at speed 1. We deduce\nthat lifting is unique between the first and last illegal turns along the path\n\u03b3, including the germs of directions beyond these turns. We call this the\nunfolding principle.\nIn particular, this applies to illegal turns themselves: if a loop z|\u011c\u03c9 has\ntwo occurrences of the same illegal turn, pulling back these turns produces\ntwo occurrences of the same path (most of the time a neighborhood of a\nsingle illegal turn, but see Figure 4). But note that distinct illegal turns\nmight pull back to the same illegal turn, see Figure 5.\nIllegality. If a graph G is equipped with a track structure, by the illegality\nof G we mean\nXX\n(|\u03a9v | \u2212 1)\nm(G) =\nv\n\n\u03a9v\n\nwhere the sum is over all vertices v of G and all gates \u03a9v at v. Thus a gate\nthat contains k \u2265 1 directions contributes k \u2212 1 to the count. The right\n3\n\nWe use \"segment\" synonymously with \"immersed path\", but usually to connote a\nsmaller piece of something.\n\n21\n\n\fv\n\nFigure 4: A path unfolds to a path with two illegal turns.\n\nFigure 5: In this folding path the number of illegal turns grows from 1 to 2.\n\nderivative of the function\nt 7\u2192 vol(\u011ct )\nat t = t0 is \u2212m(\u011c0 ), the negative of the illegality of \u011ct0 . If G is marked and\nz is a conjugacy class in F then k(z|G) is by definition the number of illegal\nturns in z|G, i.e. the number of illegal turns in the illegal turn structure on\nz|G induced by z|G \u2192 G.\nFor the rest of this section, Gt , t \u2208 [0, L], is a folding path in CV\nparametrized by arclength. We will sometimes abbreviate m(Gt ) by simply\nmt , z|Gt by zt and k(zt ) by kt .\nLemma 4.4. (1) Let z be a conjugacy class in F. The the right derivative\nof the length function t 7\u2192 l(zt ) at t = 0 is\nk0\nd\nl(zt )|t=0+ = l(z0 ) \u2212 2\ndt\nm0\n\n22\n\n\f(2) Let \u03c30 be a nondegenerate immersed path in G0 whose initial and terminal directions are in illegal turns of G0 . Then, for small t, there is a\ncorresponding path \u03c3t whose initial and terminal directions are in illegal\nk0\n,\nturns of Gt . The right derivative at 0 of the length Lt of \u03c3t is L0 \u2212 2 m\n0\nwhere now k0 \u2212 1 is the number of illegal turns in the interior of \u03c30 . If\nthe initial and terminal directions of \u03c30 are in the same gate, then the\nsame is true for \u03c3t .\nProof. (1): Let \u011ct be the naturally parametrized by path in cv so that\nGs(t) = \u1e20t = \u011ct /vol(\u1e20t ) and vol(\u011c0 ) = 1 (see Notation 2.4). For small\nt \u2265 0, vol(\u011ct ) = 1 \u2212 m0 t, l(z|\u011ct ) = 1 \u2212 2k0 t, and s(t) = \u2212 log(vol(\u011ct )).\nThe proof of the derivative formula in (2) is identical.\nWe will sometimes abuse notation and write l\u2032 (zt0 ) for\n\nd\n.\ndt l(z|Gt )|t=t+\n0\n\nCorollary 4.5. Let z and w be conjugacy classes in F and suppose mt and\nkt = k(zt ) are constant for t \u2208 [0, \u01eb).\n(1) The length l(zt ) = aet + b on [0, \u01eb) where a = l(z0 ) \u2212\n\n2k0\nm0\n\nand b =\n\n2k0\nm0 .\n\n(2) If l\u2032 (z0 ) \u2265 l\u2032 (w0 ) then l(zt ) \u2212 l(wt ) is nondecreasing on [0, \u01eb).\n(3) If the average length A of a maximal legal segment in the loop z0 is\n> 2/m0 the loop grows in length on [0, \u01eb), and if it is < 2/m0 it shrinks.\nProof. (1) and (2) follow easily from Lemma 4.4. For (3), k0 A = l(z0 ) and\nso, by (1), a = l(z0 )(1 \u2212 2/m0 A).\nCorollary 4.6. Let z be a conjugacy class in F. The length l(zt ) is piecewise\nexponential on [0, L], i.e. [0, L] has a finite partition such that the restriction\nof l(zt ) to each subinterval is as in Corollary 4.5(1).\nProof. Since we may subdivide [0, L] as 0 = s0 < s1 < * * * < sk = L so that,\non each [si , si+1 ), mt and kt are constant, the corollary follows directly from\nCorollary 4.5(1) and Proposition 4.3.\nWe will say that a segment has endpoints illegal turns if the path has\nbeen infinitesimally extended at each end, i.e. directions have been specified\nat the initial and terminal endpoints, and these directions together with\nthe segment determine illegal turns. If the segment is degenerate then this\nmeans that the added directions form an illegal turn.\n\n23\n\n\fCorollary 4.7. Let \u03c3L be an immersed path in GL with endpoints illegal\nturns and, for t \u2208 [0, L], let \u03c3t be the immersed path in Gt with endpoints\nillegal turns obtained by applying the Unfolding Principle to \u03c3L . Corollaries 4.5 and 4.6 hold if l(zt ) is replaced by the length of \u03c3t .\nProof. Since the derivative formula in Lemma 4.4(2) is obtained from that\nin Lemma 4.4(1) by such a replacement, proofs of corresponding statements\nare identical.\nCorollary 4.8. A legal segment \u03c30 of length L0 \u2265 2 inside z0 gives rise to\na legal segment \u03c3t of length Lt \u2265 2 + (L0 \u2212 2)et inside zt for t \u2208 [0, L]. In\nparticular, a legal segment of length L0 \u2265 3 grows exponentially.\nProof. (Lt \u2212 2)\u2032 \u2265 Lt \u2212 2 using Lemma 4.4(2).\nSimilar considerations control the lengths of topological edges e of Gt\nthat are not involved in any illegal turn, i.e. the directions determined by\nthe ends of e aren't in any illegal turns.\nLemma 4.9. Suppose that e0 is an edge of G0 that is not involved in an\nillegal turn. Then for small t, there is a corresponding edge et of Gt not\ninvolved in an illegal turn. Further, the length Lt of et satisfies Lt = L0 et .\nProof. For small t, the morphism et G0 \u2192 Gt restricted to e0 is an isometric\nembedding with image an edge of Gt .\nLemma 4.10. Suppose z is a conjugacy class such that k(z0 ) and l(zL ) are\nbounded. Then l(zt ) is bounded for all t \u2208 [0, L].\nProof. By Corollary 4.5(3) and Corollary 4.6, if l(zt )/k(zt ) \u2265 l(zt )/k(z0 ) \u2265\n2 \u2265 2/mt , then l(zt ) grows. Therefore, l(zt ) \u2264 max{2k(z0 ), l(zL )} for all\nt \u2208 [0, L].\nBy a surface relation we mean a conjugacy class that, with respect to\nsome rose, crosses every edge twice and has a circle as its Whitehead graph\n(equivalently, attaching a 2-cell to the rose via the curve results in a surface).\nLemma 4.11. Suppose mt \u2265 m, for all t \u2208 [0, L], and let w be a conjugacy\nclass in F. Assume k(w0 ) = m. If l(wL ) \u2264 K then either\n(i) there is a simple class u such that:\n\u2022 k(u0 ) is bounded; and\n\u2022 l(ut ) is bounded by a function of K for all t \u2208 [0, L]\n24\n\n\f(in particular dF (G0 , GL ) is bounded by a function of K); or\n(ii) w is a surface relation.\nMoreover, if mt > m for all t then (i) holds.\nProof. Arguing as in Lemma 4.10, we have l(wt ) \u2264 max{2, K} (loops of\nlength > 2 with no more illegal turns than the illegality grow under folding).\nSo we may take u = w provided w is simple. See Lemma 3.3 and Remark 3.4\nfor the parenthetical remark. We now consider four cases.\nCase 1. l(w0 ) < 2. Then w is simple as w0 crosses some edge at most\nonce.\nCase 2. l(w0 ) = 2. Then either w is simple or w0 crosses every edge\nexactly twice. In the latter case, collapse a maximal tree in G0 \u2013 with respect\nto the resulting rose the Whitehead graph of w is either a circle (and then\nw is a surface relation) or the disjoint union of at least two circles (and then\nw is simple).\nCase 3. 2 < l(w0 ) < 2 + injrad(G0 ). Then either w is simple or w0\ncrosses every edge at least twice. Assume the latter. Under our assumption\nthe edges crossed more than twice form a forest. Collapse a maximal tree\nthat contains this forest and argue as in Case 2.\nCase 4. l(w0 ) \u2265 2 + injrad(G0 ). Choose a conjugacy class v with\nl(v0 ) = injrad(G0 ). We now claim that l(vt ) \u2264 l(wt ) \u2212 2 for all t. This is\nclearly true at t = 0. In fact, this condition persists in that there is no last\ntime t0 < L where it is true. Indeed, Lemma 4.4(1) shows that\nl\u2032 (vt0 ) \u2264 l(vt0 ) \u2264 l(wt0 ) \u2212 2 \u2264 l\u2032 (wt0 )\nand so the inequality continues to hold for t > t0 (see Corollary 4.5(2)).\nThus v is a simple class with both l(vt ) bounded. We may take u = v.\nm\nfor all t. Thus if\nFor the moreover part, we have l\u2032 (wt ) \u2265 l(wt ) \u2212 2 m+1\nl(w0 ) < 2 then w is simple and the statement follows with u = w. If l(w0 ) \u2265\n2, then we claim dCV (G0 , GL ) is bounded (see Corollary 3.5). Indeed, by\n2\nm\n\u2265 m+1\nCorollary 4.5 we have l(wt ) \u2265 aet + b where a = l(w0 ) \u2212 2 m+1\n2\neL + 2. We may take u = v such that\nand b \u2265 2. In particular, K \u2265 m+1\nl(v0 ) = injrad(G0 ).\nWe also have the following variant.\nLemma 4.12. Suppose in addition to the hypotheses of Lemma 4.11 that,\nfor some illegal turn in w|G0 , one of the two edges e forming the turn is\nnonseparating and has length a definite fraction p > 0 of injrad(G0 ). Then\neither:\n25\n\n\f(i \u2032 ) there is a simple class u such that:\n\u2022 k(u0 ) is bounded; and\n\u2022 l(ut ) is bounded as a function of K and p for all t \u2208 [0, L]\n(in particular dF (G0 , GL ) is bounded in terms of K and p); or\n(ii \u2032 ) w is a surface relation and any class z such that z0 contains a segment\nS = e * * * e that closes up (by identifying the two copies of e) to w0\nfails to be simple.\nProof. Referring to the proof of Lemma 4.11, in Cases 1 and 4, (i \u2032 ) holds;\nso assume we are in Cases 2 or 3. In fact we are free to assume l(w0 ) <\n2 + p injrad(G0 ), for otherwise the argument of Case 4 shows that for v\nwith l(v0 ) = injrad(G0 ) we have l(vt ) \u2264 l(wtp)\u22122 for any t and (i \u2032 ) follows\n(and this time the bound also depends on p). Now the forest consisting of\nthe edges crossed by w0 more than twice (assuming all edges are crossed\nat least twice) does not include e, and we may collapse a maximal tree\nthat contains this forest but does not contain e. Now z0 can be thought\nof as e * * * e * * * = eAeB with the subpath S = eAe giving w. Since e is\nnot collapsed, the Whitehead graph of z in the rose contains the Whitehead\ngraph of w, which is a 1-manifold. So if w is not simple, neither is z.\n\n5\n\nLoops with long illegal segments\n\nThe key result of this section is Proposition 5.4(surviving illegal turns) which\nis a generalization of [3, Lemma 2.10]. Before stating Proposition 5.4, we\nneed a bit of terminology and some preliminary lemmas to be used in the\nproof. In this section, Gt , t \u2208 [0, L], is a folding path in CV parametrized by\narclength. Consider a conjugacy class z in F and the induced path of loops\nzt := z|Gt . The illegal turns along zt are folding as t increases, but at discrete\ntimes an illegal turn may become legal, or several illegal turns may collide\nand become one (e.g. see Figure 4). We say that a consecutive collection of\nillegal turns along z survives to GL if none of them become legal nor do they\ncollide with a neighboring illegal turn in the collection, for any t \u2208 [0, L]. In\nparticular, each illegal turn in the collection in zt unfolds to a single illegal\nturn in the collection in zt\u2032 for t\u2032 \u2264 t. We will call the portion4 of zt spanned\nby our collection the good portion of zt . The turns in the collection in zt are,\nin order, \u03c4t,1 , \u03c4t,2 , . . . and have vertices pt,1 , pt,2 , . . . . In particular, if t\u2032 < t\n4\n\nusually a segment, but possibly all of zt\n\n26\n\n\fthen \u03c4t,i unfolds to \u03c4t\u2032 ,i . The image of \u03c4t,i in Gt is \u03c4\u0304t,i . In this context, the\nUnfolding Principle gives the implication \u03c4\u0304t,i = \u03c4\u0304t,j =\u21d2 \u03c4\u0304t\u2032 ,i = \u03c4\u0304t\u2032 ,j . We\nalso say that \u03c4\u0304t,i unfolds to \u03c4\u0304t\u2032 ,i .\nSuppose that a consecutive collection of illegal turns along z survives to\nGL . For each t \u2208 [0, L] denote by T\u0304t the set of turns that occur in the given\nconsecutive collection, i.e. T\u0304t = {\u03c4\u0304t,1 , \u03c4\u0304t,2 , . . . }. Let Dt denote the set of\ndirections in Gt that occur in a turn in T\u0304t . Of course, Dt is partitioned into\nequivalence classes with respect to the relation \"being in the same gate\", but\nwe consider a finer equivalence relation generated by d \u223c d\u2032 if {d, d\u2032 } \u2208 T\u0304t .\nWe will call the equivalence classes subgates. The Whitehead graph of Gt ,\ndenoted W H(Gt ) or often just W Ht, is the simple5 graph whose vertices\nare directions at vertices of Gt and edges are illegal turns in Gt . Note that\ndirections at vertices are in the same gate if and only if they are in the same\ncomponent of W Ht . Define SW (Gt ), or just SWt , to be the subgraph of\nW Ht spanned by the edges in T\u0304t , i.e. a vertex in SWt is a direction in a turn\nin T\u0304t and an edge is an element of T\u0304t . Note that directions are in the same\nsubgate if and only if they are in the same component of SWt .\nLemma 5.1. In the situation above, let d1 , d2 , * * * , dk be the vertices along\nan embedded closed curve in SWt (that is, di 6= dj for i 6= j). Then for any\nt\u2032 < t there is an induced embedded closed curve in SWt\u2032 .\nSpecifically, each turn {di , di+1 } (taken mod k, so including {dk , d1 })\nunfolds to a turn in T\u0304t\u2032 ; Lemma 5.1 says that these turns also form an\nembedded closed curve in a subgate (in particular, all are based at the same\nvertex).\nProof of Lemma 5.1. Let \u011cs(t) be the path in cv giving rise to Gt (see Notation 2.4). As combinatorial graphs, we identify Gt and \u011cs(t) (they differ\nonly by homothety). In particular, a direction in one is naturally identified\nwith a direction in the other and we will use the same names for two such\ndirections. If we set s := s(t) and s\u2032 := s(t\u2032 ), it suffices to argue in the\ncase s\u2032 = s \u2212 \u01eb for small \u01eb > 0; for the conclusion clearly holds in the limit.\nTo that end, we use the description of N\u01eb developed in Section 4. So, let\nv be the vertex in \u011cs that is the base of the directions di in our subgate,\nN be the \u01eb-neighborhood in \u011cs of v, and N\u01eb be the preimage of N in \u011cs\u2032 .\nSet d\u2217i = d\u01ebi or d\u2212\u01eb\ni depending on whether or not di points up or down and\nsimilarly for d \u0303\u2217i . For i 6= j, let [d\u2217i , d\u2217j ] denote the path in \u011cs from the base\nof d\u2217i to the base of d\u2217j extended infinitesimally by the outgoing (germs of)\n5\n\nno multiple edges, no edges that are loops\n\n27\n\n\fdirections d\u2217i and d\u2217j . Similarly, [d \u0303\u2217i , d \u0303\u2217j ] denotes the unique immersed path\nlifting [d\u2217i , d\u2217j ]. Note that if z|\u011cs contains the illegal turn {di , dj } then it\nalso contains the (infinitesimally extended) path [d\u2217i , d\u2217j ] and z|\u011cs\u2032 contains\n[d \u0303\u2217i , d \u0303\u2217j ]. If d \u0303\u2217i points down then it is supported by a widget W if d \u0303\u2217i is in the\ndownward direction from some x \u2208 W of height 0. In this case, we also say\nthat d \u0303\u2217i is supported by x. If d \u0303\u2217i points up, then it is supported by the unique\nwidget at which it is based. See Figure 6.\n\n~\u03b5\nd\n\nd\u03b5\n\n\u03b5\n\nd\n\n\u2212\u03b5\nFigure 6: An upward and a downward direction supported by the leftmost\nwidget.\nBy hypothesis, [d \u0303\u2217i , d \u0303\u2217i+1 ] contains a unique illegal turn that we abusingly\ndenote {d \u0303\u2217i , d \u0303\u2217i+1 }. Recall that all illegal turns in Gs\u2032 have height \u01eb and are\nin a widget. Note that if [d \u0303\u2217i , d \u0303\u2217i+1 ] (or indeed any path between height \u00b1\u01eb\nvertices) contains its unique illegal turn in W then it falls into one of the\nfollowing three cases:\n\u2022 d \u0303\u2217i and d \u0303\u2217i+1 point up in distinct widgets adjacent to W\n\u2022 d \u0303\u2217i and d \u0303\u2217i+1 point down and are supported by W\n\u2022 one of d \u0303\u2217i or d \u0303\u2217i+1 points down and is supported by W and the other\npoints up in a widget adjacent to W\nWe now make the following observations.\n(1) If d \u0303\u2217i points up and is supported by the widget W , then all directions\npointing upward at height 0 in W are mapped to di . If d \u0303\u2217i points down,\nthen it is in a unique downward direction from a height 0 point and this\ndirection maps to di .\n\n28\n\n\f(2) The directions d \u0303\u2217i are all distinct. Indeed, by hypothesis the di (hence\nthe d\u2217i ) are distinct, and d \u0303\u2217i is the unique lift of d\u2217i .\n(3) It is not possible for a single widget to support both an upward d \u0303\u2217i and\na downward d \u0303\u2217j . Indeed, this would force {di , dj } to be illegal and then\n[d \u0303\u2217i , d \u0303\u2217j ] would have a height 0 illegal turn. However, all illegal turns\noccur at height \u01eb.\n(4) It is not possible for adjacent widgets to both support upward d \u0303\u2217i and d \u0303\u2217j .\nThis is because this would force an illegal turn at the common height 0\nvertex formed by directions that map to di and dj .\n(5) It is not possible for downward d \u0303\u2217i and d \u0303\u2217j to be supported by the same\nheight 0 vertex. Indeed, this would then force an illegal turn based at\nthis height 0 vertex.\nRecall that we want to prove {d \u0303\u22171 , d \u0303\u22172 }, {d \u0303\u22172 , d \u0303\u22173 }, . . . , {d \u0303\u2217k , d \u0303\u22171 } gives rise to\nan embedded closed curve in SWs\u2032 . To do this we prove two things.\n\u2022 (there is a loop) The turns {d \u0303\u2217i , d \u0303\u2217i+1 } are all based at the same vertex\nw, i.e. the base of the illegal turn crossed by [d \u0303\u2217i , d \u0303\u2217i+1 ] is independent\nof i.\n\u2022 (the loop is embedded) For i 6= j, d \u0303\u2217i and d \u0303\u2217j are not in the same\ndirection from w.\nTo see there is a loop, suppose we have three consecutive directions\n\u2217\n \u0303\ndi\u22121 , d \u0303\u2217i , d \u0303\u2217i+1 that determine two illegal turns in N\u01eb not based at the same\nvertex. There are two cases. First suppose d \u0303\u2217i points down and is supported\nby some height 0 vertex x. Paths from d \u0303\u2217i to d \u0303\u2217i\u00b11 lead through two distinct\nwidgets each containing x. Since our directions d \u0303\u22171 , . . . , d \u0303\u2217k are cyclically\nordered and N\u01eb is a tree, there must be some j with j 6= i 6= j + 1 so that\n[d \u0303\u2217j , d \u0303\u2217j+1 ] passes through x. (Indeed, otherwise all d \u0303\u2217j , for j 6= i, lie in the\nsame component of N\u01eb \\{w}. Since d \u0303\u2217i\u22121 and d \u0303\u2217i+1 lie in distinct components,\nthis is a contradiction.) The path [d \u0303\u2217j , d \u0303\u2217j+1 ] cannot terminate at d \u0303\u2217i by (2),\nand by (5) it cannot terminate in any downward direction supported by\nx, but must continue to another (adjacent) widget. By (3) the widgets\ncontaining x do not support upward d \u0303\u2217j and d \u0303\u2217j+1 , so the path crosses two\nillegal turns, contradiction. The other case is that d \u0303\u2217i is upward, say based at\na height \u01eb vertex x inside a widget W . Then there are distinct widgets W+\nand W\u2212 adjacent to W so that [d \u0303\u2217i , d \u0303\u2217i\u00b11 ] crosses an illegal turn in W\u00b1 . Again\n29\n\n\fthere must be some j so that [d \u0303\u2217j , d \u0303\u2217j+1 ] either crosses x (if W+ \u2229 W\u2212 = \u2205) or\ncrosses the intersection point W+ \u2229W\u2212 (if there is one, and then this point is\nin W as well). In the latter case the path does not terminate at any direction\nsupported by this point by (3) nor at an upward direction supported by W\u00b1\nby (4). Thus this path has two illegal turns, contradiction. In the former\ncase, [d \u0303\u2217j , d \u0303\u2217j+1 ] must have at least 3 illegal turns: one at x and one on each\nside of x, by (3) and (4).\nWe have established the first item. To see that the loop is embedded,\nsuppose that there are i 6= j such that d \u0303\u2217i and d \u0303\u2217j are in the same direction\nfrom w. Each of these directions is contained in a path between height \u00b1\u01eb\nvertices with one illegal turn, that illegal turn being based at w. Considering\nthe three cases listed above for such paths, d \u0303\u2217i and d \u0303\u2217j have to either be both\ndownward and supported by the same height 0 vertex of the widget W\ncontaining w, contradicting (5), or one is downward and the other upward\nsupported in the same widget adjacent to W , contradicting (3), or they\nare upward and supported by widgets adjacent to W and to each other,\ncontradicting (4).\nGiven a finite, simple graph G, let \u223c be the equivalence relation on\nthe set of (unoriented) edges E(G) of G generated by e \u223c e\u2032 if there is\nan embedded loop containing e and e\u2032 . We also view C \u2208 E(G)/ \u223c as a\nsubgraph of G, specifically the union of the edges in C. Let V(G) denote\nthe set of vertices of G and let Vc (G) \u2282 V(G) be the set of cut vertices.\nLemma 5.2. Suppose G is a finite, simple, and connected graph.\n(1) e \u223c e\u2032 if and only if they are not separated by any cut vertex v \u2208 G, i.e.\ntheir interiors are in the same component of G \\ {v}.\n(2) |V(G)| \u2212 1 \u2265 |E(G)/ \u223c | with equality iff G is a tree.\nProof. (1): If an embedded circle contains e and e\u2032 , then e and e\u2032 are not\nseparated by a cut vertex. The same then holds if e \u223c e\u2032 . Now assume e\nand e\u2032 are separated by no cut vertex. Let e = e0 , e1 , . . . , eN = e\u2032 be an\nembedded edge path. We claim there is an embedded loop containing each\nei , ei+1 . Indeed, if v is the common vertex of ei and ei+1 , then the claim is\nclear if v is not a cut vertex, and the claim follows from our assumption if\nv is a cut vertex.\n(2): Consider the bipartite graph \u0393 whose vertex set is the disjoint union\nof E(G)/ \u223c and Vc (G) and where C \u2208 E(G)/ \u223c and v \u2208 Vc (G) span an edge\nif v \u2208 C. We claim \u0393 is a tree. Indeed, \u0393 is connected since G is connected.\nAlso, we see from the proof of (1) that the graph C is connected and so an\n30\n\n\fembedded loop in \u0393 would give rise to an embedded loop in G containing\ninequivalent edges. Note that elements of Vc (G) are not leaves of \u0393. Fix a\nleaf C0 of \u0393 and consider the function Vc \u2192 E(G)/ \u223c given by v 7\u2192 C where\nC is the vertex adjacent to v in the direction of C0 . The image is the union\nof {C0 } and complement of the set of leaves of \u0393. The inequality follows by\nnoting that, since every C contains at least one edge, every C has at least\ntwo vertices. The inequality is an equality iff C has valence one or two in \u0393\nand consists of a single edge, i.e. iff G is a tree.\nWe won't need it, but the proof also shows that the graphs C have no\ncut vertices of their own. Also, e \u223c e\u2032 iff e = e\u2032 or there is an embedded loop\nin G containing e and e\u2032 . (Hint: prove by induction on i that if e 6= e\u2032 are\nequivalent and connected by a length i embedded edge path then this path\ncan be extended to an embedded loop.)\nWe now apply this to SWt , i.e. we consider the equivalence relation on\nT\u0304t generated by \u03c4\u0304t,i \u223c \u03c4\u0304t,j if there is an embedded loop SWt containing \u03c4\u0304t,i\nand \u03c4\u0304t,j . Recall that mt = m(Gt ) is the illegality of Gt , see Page 21.\nLemma 5.3. | T\u0304t /\u223c| \u2264 mt with equality iff subgates coincide with gates and\nSWt is a forest.\nProof. We suppress the subscript t. Let W H = \u2294i W Hj and SW = \u2294i SWi\nbe decompositions into components. We have\nX\nX\n|T \u0304 / \u223c | \u2264\n(|V(SWi )| \u2212 1) \u2264\n(|V(W Hj )| \u2212 1) = m\ni\n\nj\n\nwhere the first inequality follows from Lemma 5.2(2) (with equality iff SW\nis a forest) and the second follows because SWt is a subgraph of W Ht (with\nequality iff the sets of gates and subgates coincide).\nWe are now ready for the main result of this section. Let m\u030c denote the\nmaximal possible number of illegal turns for any train track structure on\nany element of CV .\nProposition 5.4 (surviving illegal turns). Let z be a simple class and Gt ,\nt \u2208 [0, L], a folding path in CV parametrized by arclength. Assume that\nM = 2m\u030c + 1 consecutive illegal turns of z|G0 survive to GL and that the\nlegal segments between them in z|GL have bounded size. Then dF (G0 , GL )\nis bounded.\nWe saw above that two illegal turns in our consecutive collection in z|Gt\nthat give the same element of T\u0304t also give the same element of T \u0304t\u2032 for t\u2032 \u2264 t,\n31\n\n\fi.e. we saw \u03c4\u0304t,i = \u03c4\u0304t,j implies \u03c4\u0304t\u2032 ,i = \u03c4\u0304t\u2032 ,j . However, distinct illegal turns might\nunfold to the same illegal turn, i.e. \u03c4\u0304t\u2032 ,i = \u03c4\u0304t\u2032 ,j does not imply \u03c4\u0304t,i = \u03c4\u0304t,j . So\n|T \u0304t\u2032 | \u2264 |T\u0304t |. By partitioning [0, L] into a bounded number of subintervals and\nrenaming, we may assume in proving Proposition 5.4 that |T\u0304t | is constant on\n[0, L). Likewise, we may assume that | T\u0304t /\u223c| is constant (in general | T\u0304t /\u223c|\nmay decrease under unfolding when a new circle is formed). The proof of\nProposition 5.4 breaks into two cases: for small \u01eb > 0,\nCase 1: SWL\u2212\u01eb is not a forest;\nCase 2: SWL\u2212\u01eb is a forest.\nIn Lemma 5.5, resp. Lemma 5.6, we show that Proposition 5.4 holds in\nCase 1, resp. Case 2. So once we have proved these next two lemmas, we\nwill also have proved Proposition 5.4. In Lemma 5.5, we prove a little more.\nLemma 5.5. Suppose that, in addition to the hypotheses of Proposition 5.4,\n\u2022 SWL\u2212\u01eb is not a forest; and\n\u2022 |T\u0304t | and | T \u0304t /\u223c| are constant on [0, L).\nThen there is a simple class u such that l(u|Gt ) is bounded for all t \u2208 [0, L].\nIn particular, dF (G0 , GL ) is bounded (see Lemma 3.3 and Remark 3.4).\nProof. By restricting to [0, L \u2212 \u01eb], we may assume that SWL is defined and\nnot a forest, and that |T \u0304t | and | T\u0304t /\u223c | are constant on [0, L]. In light of\nLemma 4.10, we only need to prove there is a simple u such that k(u|G0 )\nand l(u|GL ) are bounded. Since SWL is not a forest, by Lemma 5.1 the\nsame is true at every t. Choose distinct illegal turns \u03c4L,i , \u03c4L,j in zL that\nare equivalent in T\u0304L so that the number of illegal turns between in the\ngood portion of zL is smaller than the number of equivalence classes. (This\nis possible because embedded circles SWL have more than one edge.) Let\n[pt,i , pt,j ] denote the resulting segment in the good portion of zt and let \u03c3t be\nthe loop obtained by closing up our segment, i.e. by identifying pt,i and pt,j .\nWe refer to \u03c3t as a monogon because it is immersed in Gt except possibly at\nthe point pt,i = pt,j . In particular, the conjugacy class w(t) in F represented\nby \u03c3t is nontrivial. Of course, w(t) is also represented by the immersed circle\nw(t)|Gt which is obtained by tightening \u03c3t . By construction and Lemma 5.3,\nk(w(t)|Gt ) \u2264 | T\u0304t /\u223c| < mt . In particular, w(L)|GL has bounded length. We\nclaim that w(0) = w(L). Once this claim is established, the last sentence of\nLemma 4.11 (with m equal to the constant | Tt /\u223c|) completes the proof of\nthis lemma.\n32\n\n\fTo prove our claim, we must show that \u03c30 and \u03c3L determine the same\nconjugacy class. In folding z0 to zL , maximal arcs in the directions of \u03c40,k\nare identified in GL , i.e. they have the same image which is an immersed arc\n\u03b1k in GL . If we tighten the image of [p0,i , p0,j ] in GL , the result is the image\nof [pL,i , pL,j ] extended at its ends by \u03b1i and \u03b1j . The claim follows since\n\u03b1i = \u03b1j . Indeed, \u03c40,i and \u03c40,j are equivalent, and so in the same subgate,\nand so in the same gate. We see \u03b1i = \u03b1j at least if L is small enough and\nthat this condition persists.\nLemma 5.6. Suppose that, in addition to the hypotheses of Proposition 5.4,\n\u2022 SWL\u2212\u01eb is a forest; and\n\u2022 |T\u0304t | and | T \u0304t /\u223c| are constant on [0, L).\nThen dF (G0 , GL ) is bounded.\nProof. As in the proof of Lemma 5.5, we restrict to [0, L \u2212 \u01eb] and so assume\nthat SWL is a forest and that |T\u0304t | and | T\u0304t /\u223c| are constant on [0, L]. In\nparticular, s := |T\u0304L | = | T \u0304L /\u223c| \u2264 mt and SWt is a forest for all t \u2208 [0, L]\n(Lemma 5.3).\nFirst assume that there are two occurrences of the same illegal turn in\nthe consecutive collection at time L that are separated by < s \u2212 1 illegal\nturns, i.e. there are \u03c4L,i and \u03c4L,j with \u03c4\u0304L,i = \u03c4\u0304L,j and 0 < j \u2212 i < s \u2212 1.\nClosing up gives a curve with < s illegal turns, so again the conclusion\nfollows by arguing as in Case 1.\nSo from now on we assume that this does not happen, i.e. all s illegal\nturns occur repeatedly in a cyclic order in the consecutive collection along\nzt . If it so happens that one of these illegal turns at t = 0 involves an edge\ne which is nonseparating and has length a definite fraction p of injrad(G0 ),\nwe argue using Lemma 4.12 as follows. Consider the loop in G0 obtained by\nclosing up the segment that starts with e and ends at the next occurrence of\nthe same illegal turn. (Such a segment exists since there are M > 2m\u030c illegal\nturns in our collection.) If the edge following this segment is e, we can appeal\nto Lemma 4.12 to deduce the conclusion of the lemma (because z is simple).\nIf the edge following the segment is not e, then the last edge \u0113 of the segment\nis e with the opposite orientation and closing up forces cancellation. If the\ntightened loop has length < 2, it is simple and its image in GL is bounded,\nso the conclusion follows (cf. the first sentence of the proof of Lemma 4.11).\nIf the tightened loop has length \u2265 2, then the original segment from e to\n\u0113 has length \u2265 2 + 2p injrad(G0 ) and the same argument as in Case 4 of\nLemma 4.11 (using Lemma 4.4(2) instead of Lemma 4.4(1); see also proof\n33\n\n\fof Lemma 4.12) shows that for l(v|G0 ) = injrad(G0 ) we must have l(v|Gt )\nbounded.\nTo summarize, the conclusion of the lemma holds whenever the following\ncondition is satisfied at t = 0:\n(\u22c6) There is a nonseparating edge e in Gt such that:\n(i) e is in the good portion of zt ;\n(ii) lGt (e) \u2265 p injrad(Gt ); and\n(iii) e is involved in some turn in our collection T\u0304t .\nSo now all that remains is to reduce to the case where (\u22c6) is satisfied at\nt = 0.\nAs a warmup, first consider the case where m(Gt ) = s for all t. In\nparticular, every direction that is involved in an illegal turn of Gt is involved\nin an illegal turn of our collection (Lemma 5.3). Let \u03b2 \u2208 [0, L] be the first\n1\ntime that a nonseparating edge of length \u2265 3n\u22123\ninjrad(G\u03b2 ) is involved\nin an illegal turn of G\u03b2 . If there is no such \u03b2 then we claim that the\nconclusion of the lemma holds. Indeed, if v is a conjugacy class with l(v0 ) =\ninjrad(G0 ) where v0 := v|G0 then there is a nonseparating edge e0 of length\n1\ninjrad(G0 ) in v0 . By Lemma 4.9, there is a corresponding edge et\n\u2265 3n\u22123\nfor small t. Note that\nl(et ) = l(e0 )et \u2265\n\nl(v0 )et\nl(vt )\n1\n\u2265\n\u2265\ninjrad(Gt )\n3n \u2212 3\n3n \u2212 3\n3n \u2212 3\n\nand so et is not involved in any illegal turns. In fact, we see that there can\n1\nbe no first time where l(et ) < 3n\u22123\ninjrad(Gt ). We have l(vt ) \u2264 et l(v0 ) \u2264\nt\n(3n \u2212 3)e l(e0 ) = (3n \u2212 3)l(et ) < 3n \u2212 3 is bounded.\nIf there is such a \u03b2, then for the same reason the conclusion holds for\nGt , t \u2208 [0, \u03b2]. Also, the conclusion holds for Gt , t \u2208 [\u03b2, L] since (\u22c6) holds at\nt = \u03b2.\nIt remains to consider the case when mt is perhaps sometimes > s. Let\nG\u2032t , t \u2208 [0, L\u2032 ] be the path in CV starting at G0 obtained as in 2.2.C by\nfolding only the s illegal turns in our collection T\u0304t (and then normalizing\nand reparametrizing by arclength). Note that by the Unfolding Principle\neach illegal turn \u03c40,i our collection at time 0 comes with a pair of legal\npaths that get identified in the folding process. Folding only these turns\namounts to identifying these paths. There are induced morphisms G0 \u2192\n\u2032\ne\u2212L G\u2032L\u2032 \u2192 e\u2212L GL . (In particular, G\u2032t is a folding path.) We can scale\nthe second of these morphisms to obtain \u03c6 : G\u2032L\u2032 \u2192 GL . By the special\n34\n\n\fcase m(G\u2032t ) = s, there are simple classes v and u and a partition of [0, L\u2032 ]\ninto two subintervals such that l(v|G\u2032t ) is bounded on the first and l(u|G\u2032t )\nis bounded on the second. Note that \u03c6 is an immersion on the segment\nspanned by our collection of turns, i.e. this segment is now legal in the\ntrain track structure induced by \u03c6. Let x be the conjugacy class obtained\nby identifying two consecutive occurrences of the same oriented element of\nour collection (possible since M > 2m\u030c). The assumption in the paragraph\nafter the statement of Proposition 5.4 guarantees that the definition of x\nis independent of t. By the construction, x|G\u2032L\u2032 is legal with respect to\nG\u2032L\u2032 \u2192 GL . Also l(x|GL ) is bounded by the hypothesis of Proposition 5.4. If\nl(x|G\u2032L\u2032 ) < 2, then x is simple and the length of x along the path from G\u2032L\u2032 to\nGL is bounded. Hence, the conclusion of the lemma holds. If l(x|G\u2032L\u2032 ) \u2265 2,\nthen dCV (G\u2032L\u2032 , GL ) = L \u2212 L\u2032 is bounded. Indeed, since\n\u2032\n\nl(x|GL ) = l(x|G\u2032L\u2032 )eL\u2212L \u2265 2eL\u2212L\n\n\u2032\n\nis bounded, so is L \u2212 L\u2032 . In particular, the length of the simple class u\n\u2032\nalong the path from G\u2032L\u2032 to GL is bounded by l(u|G\u2032L\u2032 )eL\u2212L and again the\nconclusion of the lemma holds.\nWe have completed the proof of Proposition 5.4.\nDefinition 5.7. An immersed path or a loop in a metric graph G equipped\nwith a train track structure is illegal if it does not contain a legal segment\nof length 3 (in the metric on G).\nLemma 5.8. Let z be a simple class and Gt , t \u2208 [0, L], a folding path in\nCV parametrized by arclength. Assume zt is illegal for all t. Then either\nl(zL ) < l(z0 )/2 or dF (G0 , GL ) is bounded.\nProof. There are two cases. First suppose that the average distance between\nconsecutive illegal turns in z0 is \u2265 1/m\u030c. Then, by Proposition 5.4(surviving\nillegal turns), after a bounded progress in F the loop z must lose at least\n1/M of its illegal turns. Repeating this a bounded number of times, we see\nthat, after bounded progress in F, kt \u2264 k0 /6m\u030c. Thus either the length of\nzt is less than 1/2 of the length of z0 or the average distance between illegal\nturns at time t is \u2265 3, so there is a legal segment.\nNow suppose the average distance between illegal turns in z0 is < 1/m\u030c.\nBy Lemma 4.4,\nk0\nl\u2032 (z0 ) = l(z0 ) \u2212 2\nm0\nWe are assuming that k0 /m0 > l(z0 ) so the above derivative is < \u2212l(z0 ).\nThus in this case the length of z decreases exponentially, until either half\n35\n\n\fthe length is lost after a bounded distance in CV , or the average distance\nbetween illegal turns becomes \u2265 1/m\u030c, when the above argument finishes the\nproof.\nRemark 5.9. One source of asymmetry between legality and illegality is that\na long legal segment gets predictably longer under folding, while a long illegal\nsegment may not get longer under unfolding. For example, take a surface\nrelation inside a subgraph where folding amounts to an axis of a surface\nautomorphism. But the lemma above implies that an illegal segment inside\na loop representing a simple class will get predictably longer under unfolding\nafter definite progress in F.\n\n6\n\nProjection to a folding path\n\nWe thank Michael Handel for pointing out the technique for proving the\nfollowing lemma (see [13, Proposition 8.1]).\nLemma 6.1. Let G \u2208 CV be a metric graph with a train track structure\nand A < F a free factor. Suppose A|G satisfies:\n\u2022 there is an illegal loop a in A|G (see Definition 5.7),\n\u2022 there is an immersed legal segment in A|G of length 3(2n \u2212 1), n =\nrank(F).\nThen dF (A, G) is bounded.\nProof. If the injectivity radius of A|G is \u2264 3(2n \u2212 1) the conclusion follows\nfrom Corollary 3.7.\nChoose a complementary free factor B to A and add a wedge of circles\nto A|G representing B to get a graph H. Extend A|G \u2192 G to a homotopy\nequivalence (difference of markings) H \u2192 G, which is an immersion on each\n1-cell. Pull back the metric to H and consider the folding path in cv induced\nby H \u2192 G. Let H \u2032 be the first graph on this folding path with injectivity\nradius 3(2n\u22121). Now give H \u2032 the pullback illegal turn structure via H \u2032 \u2192 G.\nSince A|G \u2192 H \u2032 is an immersion, the interior of the legal segment in A|G\nembeds in H \u2032 . Since H \u2032 has at most 2n \u2212 2 topological vertices, the interior\nof the legal segment meets at most 2n \u2212 2 topological vertices. So there is\na legal segment of length 3 inside one of the topological edges of H \u2032 . Thus\na|H \u2032 does not cross this topological edge and hence dF (a, H \u2032 ) \u2264 1 + 4 (1\nbounds the distance between \u0227 and the free factor given by the subgraph of\nH \u2032 traversed by a and 4 coming from Lemma 3.1). Since dF (a, A) \u2264 1 and\n36\n\n\fdF (H \u2032 , G) is bounded by Corollary 3.7 applied to a shortest loop in H \u2032 , the\nstatement follows.\nThe following is a slight generalization.\nLemma 6.2. Let G \u2208 CV be a metric graph with a train track structure\nand A < F a free factor. Suppose A|G satisfies:\n\u2022 there is a loop a in A|G with the maximal number of pairwise disjoint\nlegal segments of length 3 bounded by N ,\n\u2022 there is an immersed legal segment in A|G of length 3(2n \u2212 1), n =\nrank(F).\nThen dF (A, G) is bounded as a function of N .\nProof. The proof is similar. With H \u2032 defined as in the proof of Lemma 6.1,\nthere is an edge in H \u2032 which is crossed by a|H \u2032 at most N times. Hence, by\nLemma 3.3, dF (H \u2032 , a) \u2264 6N + 13.\nFor the rest of this section, let Gt , t \u2208 [0, L], be a folding path in CV\nparametrized by arclength and let A be the conjugacy class of a proper free\nfactor. A folding path has a natural orientation given by the parametrization. We will think of this orientation as going left to right.\nSet\nI := (18m\u030c(3n \u2212 3) + 6)(2n \u2212 1)\nwhere recall that m\u030c is the maximal possible number of illegal turns in any\nG \u2208 CV (so m\u030c is some linear function of the rank). The number I comes\nfrom Proposition 6.10(legal and illegal) which will say that if A|G0 has a\nlong (i.e. of length > 3) legal segment and A|GL has a long (i.e. of length\n> I) illegal segment then dF (G0 , GL ) is bounded. Recall that a segment is\nillegal if it does not contain a legal subsegment of length 3. This motivates\nthe following definitions.\nDefinition 6.3. Denote by leftGt (A) (or just left(A) if the path Gt is understood) the number\ninf{t \u2208 [0, L] | A|Gt has an immersed legal segment of length 3}\nThe left projection LeftGt (A) of A to the path Gt is Gleft(A) .\nDenote by rightGt (A) (or just right(A) if Gt is understood) the number\nsup{t \u2208 [0, L] | A|Gt has an immersed illegal segment of length I}\n37\n\n\fThe right projection RightGt (A) of A to the path is Gright(A) . If the above\nsets are empty, we interpret inf as L and sup as 0.\nFor a simple class a, we define leftGt (a) := leftGt (\u0227), LeftGt (a) :=\nLeftGt (\u0227), rightGt (a) := rightGt (\u0227), and RightGt (a) := RightGt (\u0227). In all\ncases, we may suppress subscripts if the path is understood. Note that\nthe first set displayed above is closed under the operation of increasing t.\nClearly, left(A) \u2264 right(A).\nWe also generalize these definitions from free factors to marked graphs in\nthe obvious way. If H \u2208 CV , left(H) := min left(\u03c0(H)), Left(H) := Gleft(H) ,\nright(H) := max right(\u03c0(H)), and Right(H) := Gright(H) .\nProposition 6.4. Suppose B < A are free factors. Then:\n\u2022 left(A) \u2264 left(B), right(A) \u2265 right(B); and\n\u2022 either dCV (Left(A), Left(B)) = eleft(B)\u2212left(A) is bounded or the distance in F between A and every element of {Gt | t \u2208 [left(A), left(B)]}\nis bounded.\nProof. The first bullet is clear since we are taking inf and sup over smaller\nsets. Denote by left\u2032 (A) the first time along the folding path that A|Gt has\na legal segment of length 3(2n \u2212 1). Then left(A) \u2264 left\u2032 (A), and left\u2032 (A) \u2212\nleft(A) is bounded by Corollary 4.8. If left(B) \u2264 left\u2032 (A) we are done, so\nsuppose left\u2032 (A) < left(B). It follows from Lemma 6.1 that the set of Gt 's\nfor t \u2208 [left\u2032 (A), left(B)] has a bounded projection in F, and the projection\nis close to A.\nGiven a constant K > 0, we will say that a coarse path \u03b3 : [\u03b1, \u03c9] \u2192 F is\na reparametrized quasi-geodesic if there is a subdivision \u03b1 = t0 < t1 < * * * <\ntm = \u03c9 such that diamF (\u03b3([ti , ti+1 ])) \u2264 K, m \u2264 dF (\u03b3(\u03b1), \u03b3(\u03c9)), and |i \u2212\nj| \u2264 dF (\u03b3(ti ), \u03b3(tj )) + 2 for all i, j. In particular, a map [0, m] \u2192 F given by\nmapping x \u2208 [0, m] to an element of \u03b3(t[x] ) is a quasi-geodesic with constants\ndepending only on K. A collection {\u03b3i }i\u2208I of reparametrized quasi-geodesics\nis uniform if the K appearing in the definition of \u03b3i is independent of i and\nis, in fact, a function of the rank n of F alone. A coarse Lipschitz function\nf : X \u2192 Y between metric spaces is one that satisfies dY (f (x1 ), f (x2 )) \u2264\nK dX (x1 , x2 ) + K for all x1 , x2 \u2208 X. A function f : X \u2192 A \u2286 X is a coarse\nretraction if d(a, f (a)) \u2264 K for all a \u2208 A. In all these cases, f is allowed to\nbe multivalued with the bound of K on the diameter of a point image.\nCorollary 6.5. For any folding path Gt the projection\nF \u2192 \u03c0(Gt )\n38\n\n\fA 7\u2192 \u03c0(Left(A))\nis a coarse Lipschitz retraction with constants depending only on rank(F).\nConsequently, the collection of paths {\u03c0(Gt )} is a uniform collection of reparametrized quasi-geodesics in F.\nProof. That the map is coarsely Lipschitz follows from Proposition 6.4. To\nprove that it is a coarse retraction, we need to argue that dF (Left(Gt0 ), Gt0 )\nis bounded for t0 \u2208 [0, L]. Let a be the conjugacy class of a legal candidate\nin Gt0 . In particular, hai is a rank one free factor, l(at0 ) < 2, and dF (a, Gt0 )\nis bounded. Since our map is coarsely Lipschitz, it is enough to show that\ndF (Left(a), Gt0 ) is bounded. Let t\u2032 be the smallest parameter such that\nat\u2032 is legal. We have left(a) \u2264 t\u2032 \u2264 t0 . For t \u2208 [t\u2032 , t0 ], at is legal and\nl(at0 ) < 2, and so l(at ) < 2. This has two consequences. First, dF (Gt , Gt0 )\nis bounded (Lemma 3.3 and Remark 3.4). Second, left(a) = t\u2032 (since, for\nt\u2032\u2032 < t\u2032 , a legal segment of length 3 in at\u2032\u2032 would force l(at\u2032 ) \u2265 3). Hence\ndF (Gt\u2032 = Left(a), Gt0 ) is bounded.\nThe argument for the second part is from [7]. Let Gt be a folding path\nso that \u03c0(Gt ) is a coarse path joining free factors A and B. Choose a\ngeodesic Ci , i = 0, * * * , m of free factors joining C0 = A and Cm = B in F.\nConsider the coarse projection Di of Ci to \u03c0(Gt ). By Proposition 6.4 the\ndiameter of the segment bounded by Di and Di+1 is uniformly bounded.\nNow the Di 's may not occur monotonically along \u03c0(Gt ). To fix this, let\ni1 < i2 < * * * < ik be the sequence defined inductively by i1 = 0 and ij+1 is\nthe smallest index such that Dij+1 occurs after Dij in the order on Gt given\nby t. Then by construction the interval between Dij and Dij+1 has uniformly\nbounded diameter and the number k is bounded by m = dF (A, B). Call\na subdivision satisfying these properties a admissible. To ensure the last\nproperty |i \u2212 j| \u2264 dF (\u03b3(ti ), \u03b3(tj )) + 2 take an admissible subdivision with\nminimal k.\nDefinition 6.6. Given A \u2208 F, H \u2208 CV , and a folding path Gt , \u03c0(Left(A)) is\nthe projection of A to \u03c0(Gt ) and \u03c0(Left(H)) is the projection of H to \u03c0(Gt ).\nDefinition 6.7. For \u03ba > 0, C > 0 we say a folding path Gt makes (\u03ba, C)definite progress in F if for any D > 0 and s < t, dCV (Gs , Gt ) > D\u03ba + C\nimplies dF (Gs , Gt ) > D.\nCorollary 6.8. For any folding path Gt the projection\nF \u2212 R(Gt ) \u2192 {Gt }\nA 7\u2192 Left(A)\n39\n\n\fwhere R(Gt ) is the set of free factors at a certain bounded distance from\nGt measured in F, is coarsely Lipschitz (with respect to the path metric in\nF \u2212 R(Gt )).\nMoreover, the projection is coarsely defined and coarsely Lipschitz on\nall of F provided Gt makes (\u03ba, C)-definite progress in F (with constants\ndepending on \u03ba, C).\nLemma 6.9. Let Gt , t \u2208 [0, L], be a folding path and A a free factor. The\nlength of any illegal segment contained in a topological edge of A|GL is less\nthan\n3\nm * edgelength(A|G0 ) + 6\n2\nwhere m = max{mt | t \u2208 [0, L]} and edgelength(A|G0 ) is the maximal\nlength of a topological edge in A|G0 .\nProof. Fix an illegal segment of length lL in the interior of a topological\nedge of A|GL . We will assume that the endpoints are illegal turns and argue\nlL \u2264\n\n3\nm * edgelength(A|G0 )\n2\n\n(\u22c4)\n\nAfter adding < 3 on each end we recover any illegal path. By the Unfolding\nPrinciple our path lifts to an illegal segment bounded by illegal turns inside\nsome topological edge of A|Gt , whose length will be denoted lt . In particular,\nl0 \u2264 edgelength(A|G0 ). In order to obtain a contradiction, assume (\u22c4) fails.\nLet t0 be the first time the right derivative of lt is nonnegative (if such t0 does\nnot exist then lL \u2264 l0 and (\u22c4) holds, contradiction). Thus lt0 \u2264 l0 and the\naverage length of a maximal legal segment inside the path is \u2265 2/mt0 \u2265 2/m\nby Corollaries 4.5(3) and 4.7. Since lL \u2265 32 mlt0 , the average length of a legal\nsegment of our path is guaranteed to be \u2265 3, contradicting the hypothesis\nthat our segment is illegal. Thus (\u22c4) holds and the lemma follows.\nRecall that the number I used in the next proposition was defined on\nPage 37.\nProposition 6.10 (legal and illegal). Let Gt , t \u2208 [0, L], be a folding path\nand A a free factor. Assume that A|G0 has a legal segment of length 3, and\nthat A|GL has an illegal segment of length I. Then dF (G0 , GL ) is bounded.\nProof. Since a legal segment of length 3 grows to a legal segment of length\n> 12(3n \u2212 3)(2n \u2212 1) in bounded time (Corollary 4.8), by replacing G0 with\nGt for a bounded t, we may assume that A|G0 has a legal segment of length\n12(3n \u2212 3)(2n \u2212 1). In order to obtain a contradiction, assume the distance\n40\n\n\fdF (G0 , GL ) is large. Let \u03c4 \u2208 [0, L] then be chosen so that dF (G0 , G\u03c4 ),\ndF (G\u03c4 , GL ) and dF (G\u03c4 , A) are all large.\nWedge A|G\u03c4 onto a rose representing a complementary free factor to A\nin order to obtain a graph H \u2032 \u2208 cv and a difference of markings morphism\nH \u2032 \u2192 G\u03c4 extending A|G\u03c4 \u2192 G\u03c4 and which is an isometric immersion on\nevery edge. In particular, H \u2032 \u2192 G\u03c4 induces a train track structure on H \u2032 . If\nH \u2032 has bounded injectivity radius then dF (A, G\u03c4 ) is bounded, contradicting\nthe choice of G\u03c4 . So suppose the injectivity radius of H \u2032 is large and fold\nH \u2032 \u2192 G\u03c4 until a graph H \u2032\u2032 is reached which is the last time there is an edge\nE \u2032\u2032 of length 4. Cf. [13, Proposition 8.1].\nIn particular, vol(H \u2032\u2032 ) \u2264 4(3n \u2212 3). We continue by folding with speed\n1 the subset of those illegal turns of H \u2032\u2032 \u2192 G\u03c4 that don't involve E \u2032\u2032 . Since\nH \u2032\u2032 \u2192 G\u03c4 induces a train track structure on H \u2032\u2032 , so does our subset. For\nsmall t, we obtain a graph Ht\u2032\u2032 where the image Et\u2032\u2032 of E \u2032\u2032 (perhaps no\nlonger topological) still has length 4 and a morphism Ht\u2032\u2032 \u2192 G\u03c4 inducing\na train track structure. We continue folding all illegal turns not involving\nEt\u2032\u2032 (as in 2.2.C) until we obtain morphism H \u2192 G\u03c4 inducing a train track\nstructure and isometrically immersing both the image E in H of E \u2032\u2032 and its\ncomplement. The only illegal turns of H \u2192 G\u03c4 involve E. In fact, since\nour illegal turns give a train track structure, the only illegal turns involve\nthe topological edge containing E. We will now use E for the name of this\ntopological edge. After folding from H \u2032\u2032 to H, some edge lengths may now\nbe > 4. But since vol(H) \u2264 vol(H \u2032\u2032 ), edge lengths in H are at most 4(3n\u22123)\n(and E still has length at least 4).\nWe may assume that the complement of E does not have a valence 1\nvertex. Indeed, assuming otherwise, with respect to the train track structure\ninduced by H \u2192 G\u03c4 there are two possibilities for the illegal turns (which\nrecall must involve E), see Figure 7. In the left picture, the length of E\nstays constant under folding. We continue folding until the separating edge\nfolds in with E, and this is our new H. The right picture is impossible:\nE is a \"monogon\" (of length at least 4) and the folding towards G\u03c4 stops\nbefore the loop degenerates. But this means that G\u03c4 has volume > 2, a\ncontradiction.\nWe will also assume for concreteness that the complement of E is connected, and denote by B the free factor determined by it. When the complement is disconnected, there are two free factors determined by the components. The changes are straightforward and left to the reader.\nWe have morphisms H \u2192 G\u03c4 \u2192 GL and now also bring in the pullback illegal turn structure via H \u2192 G\u03c4 . To distinguish between the two\nstructures, terms like p-legal and p-illegal will refer to this pullback, i.e. the\n41\n\n\fFigure 7: Two possibilities when E is a loop attached to a separating edge.\nThe square represents the remainder of the graph.\n\none induced by H \u2192 GL . Terms like i-legal and i-illegal will refer to the\nstructure induced by H \u2192 G\u03c4 . The same terminology will be applied to\nturns in \u0124t (resp. Ht and Kt ) with respect to \u03c8\u0302s : \u0124s \u2192 \u011cs (resp. Ht \u2192 Gt\nand Kt \u2192 Gt ) constructed below. Note that H may have p-illegal turns\nin the interior of topological edges. (Consider that perhaps H = H \u2032 .) By\nconstruction, i-illegal turns must involve E.\nThere are two cases.\nCase 1. E contains a p-legal segment of length 3. As G\u03c4 folds toward\nGL , we will use the technique of 2.2.C to fold H and produce a new path\n(though usually not a folding path) in CV . To describe this path, it is\nconvenient to view the folding path Gt as in Proposition 2.2, i.e. without\nrescaling and folding with speed 1. So, let \u011cs(t) , t \u2208 [\u03c4, L], be the folding\npath cv induced by the morphism G\u03c4 \u2192 e\u03c4 \u2212L GL with natural parameter s.\nWe claim that, for s \u2208 [s(\u03c4 ), s(L)], there is a path \u0124s in cv that starts\nat H and satisfies:\n(1) \u0124s = B|\u011cs \u222a \u00cas , where \u00cas is a topological edge containing a p-legal\nsegment of length at least 3 vol(\u011cs ),\n(2) the immersion B|\u011cs \u2192 \u011cs extends to a morphism (difference of markings) \u03c8\u0302s : \u0124s \u2192 \u011cs inducing a train track structure on \u0124s . In particular,\n\u03c8\u0302s is an isometric immersion on \u00cas ,\n(3) A|\u011cs \u2192 \u011cs factors through \u03c8\u0302s . In particular, A|\u011cs \u2192 \u0124s is an isometric\nimmersion.\nBy construction (1\u20133) hold for \u0124s(\u03c4 ) := H and \u00cas(\u03c4 ) := E. Following 2.2.C,\nassume \u0124s has been defined on a subinterval J of [s(\u03c4 ), s(L)] containing\ns(\u03c4 ). If J = [s(\u03c4 ), s0 ] with s0 6= s(L), then we can, for small time \u01eb > 0,\nfold all p-illegal turns of \u0124s0 at speed 1 (see Page 9) thereby extending the\npath to [s(\u03c4 ), s0 + \u01eb]. We see that (1\u20133) hold for s \u2208 [s0 , s0 + \u01eb]. Indeed,\n\u0124s0 \u2192 \u011cs factors through \u0124s0 \u2192 \u0124s and so \u0124s \u2192 \u011cs is a morphism. By\nLemma 4.8, \u0124s has a topological edge \u00cas containing a p-legal segment of\n42\n\n\flength at least 3 vol(\u011cs ) and whose complement has core representing B.\nSince B|\u0124s0 , A|\u0124s0 , and the interior of \u00cas0 contain no i-illegal turn, the\nsame is true at s. There must be an i-illegal turn of \u0124s0 involving both \u00cas0\nand an edge in B|\u0124s0 (or else \u0124s has a monogon as above which has been\nruled out).\nWe move to the case J = [s(\u03c4 ), s0 ). As in 2.2.C, we may define a limit\ntree \u0124s0 \u2208 cv. By Lemma 4.8, \u0124s0 has a topological edge containing a plegal segment of length at least 3 vol(Gs0 ) and whose complement has core\nrepresenting B. The limit of these morphisms is a morphism, so (2) and (3)\nalso hold. Finally, \u00cas0 can't be a loop connected to B|\u0124s0 by a separating\nedge (or else the same would have been true at smaller s).\nSet Hs := \u0124s /vol(\u011cs ) and define the image of \u00cas in Hs to be Es . Reverting to our original parametrization, we now have our original path Gt ,\nt \u2208 [\u03c4, L], in CV and a new path Ht , t \u2208 [\u03c4, L], in cv such that, for each\nt, Ht = B|Ht \u222a Et , there is a morphism \u03c8t : Ht \u2192 Gt , A|Gt isometrically\nimmerses in Ht , B|Gt isometrically embeds in Ht , and Et contains a p-legal\nsegment of length at least 3.\nWe need one more modification to control the length of Et . Define\nKt \u2208 cv as follows. If the length of Et is \u2264 4, Kt := Ht . If the length of Et\nin Ht is > 4, define Kt to be the graph obtained by folding i-illegal turns of\nHt \u2192 Gt until the length of Et is 4. Since A|Gt and B|Gt are immersed in\nHt , the only effect is to fold pieces of the end of Et into B|Gt . In particular,\nthe analogues of (1\u20133) hold for Kt , except it is possible that Et no longer\nhas a p-legal segment of length 3.\nBy keeping in mind that the length of Et in Kt is at most 4 and applying\nLemma 6.9 to Gt , t \u2208 [\u03c4, L], and B, the length of any p-illegal segment\ncontained in a topological edge of Kt is bounded by\n3\n3\nm\u030c * edgelength(B|G\u03c4 ) + 6 \u2264 m\u030c * 3 edgelength(K\u03c4 ) + 6 \u2264 18m\u030c(3n \u2212 3) + 6\n2\n2\nSince the number of topological vertices of Kt is \u2264 2n\u22122, a p-illegal segment\nin Kt of length I = (18m\u030c(3n \u2212 3) + 6)(2n \u2212 1) meets some topological vertex\nof Kt twice. We see that, for t \u2208 [\u03c4, L], either the injrad(Kt ) is bounded by\nI (in which case dF (Gt , B), and hence dF (Gt , G\u03c4 ), is bounded), or there are\nno p-illegal segments in Kt of length I and hence the same holds for A|Gt .\nApplying this to t = L (by hypothesis there is a p-illegal segment of length\nI in A|GL ) we see that dF (G\u03c4 , GL ) is bounded, contradicting the choice of\nG\u03c4 .\nCase 2. E doesn't contain a p-legal segment of length 3. In particular,\nthe interior of E crosses a p-illegal turn. Let \u011cs(t) , t \u2208 [0, \u03c4 ], be the folding\n43\n\n\fpath in cv giving rise to Gt and ending at G\u03c4 . We will produce a path\n\u0124s(t) , t \u2208 [0, \u03c4 ] (usually not a folding path) in cv ending at H and, for each\ns \u2208 [s(0), s(\u03c4 )], satisfying:\n1. \u0124s = B|\u011cs \u222a \u00cas , where \u00cas is a single edge,\n2. the immersion B|\u011cs \u2192 \u011cs extends to a morphism (difference of markings) \u03c8\u0302s : \u0124s \u2192 \u011cs which is an isometric immersion on \u00cas ,\n3. A|\u011cs \u2192 \u011cs factors through \u03c8\u0302s . In particular, A|\u011cs \u2192 \u0124s is an\nisometric immersion.\nNote that (1\u20133) hold for \u0124s(\u03c4 ) = H. Let 0 = s0 < s1 < * * * < sN = s(\u03c4 )\nbe a partition of [0, s(\u03c4 )] so that the restriction of \u011ct to each [si , si+1 ] is\ngiven by folding a gadget. Assume \u0124s has been defined for s \u2208 [si , sN ]\nsatisfying (1\u20133). We now work to extend \u0124s over [si\u22121 , sN ] still satisfying\n(1\u20133).\nWe first define \u0124s , s \u2208 (si\u22121 , si ], via the following local operations. \u0124s\nis defined as B|\u011cs with an edge \u00cas attached, and we specify the attaching\npoints. Consider first the case that a direction e of an end of \u00casi forms a\ni-illegal turn with a direction b in B|\u011csi (such a direction is then unique).\nIntuitively, as s decreases, B|\u011cs unfolds and we choose to fold b and e with\nspeed 1. A more elaborate description follows.\nLet \u03c6\u0302 = \u03c6\u0302ssi : \u011cs \u2192 \u011csi be the folding morphism. It induces a morphism\n\u03c6\u0302B : B|\u011cs \u2192 B|\u011csi . Let \u01eb = si \u2212 s and let \u00d1 be the \u01eb-neighborhood in\nB|\u0124si = B|\u011csi of the vertex v of e. N (B) is a subset of the \u01eb-neighborhood\nN of v in \u011csi . N\u01eb denotes the preimage in \u011cs of N and \u00d1\u01eb is the preimage\nof \u00d1 in B|\u011cs . Using the language of widgets, we attach the end of \u00cas\ncorresponding to e to the base of b\u0303\u2217 in \u00d1\u01eb . (To recall notation, see Figure 6.)\nTo define \u00cas delete a length \u01eb segment from the end of \u00casi . B|\u011cs \u2192 \u011cs\nnow extends to a morphism \u03c8\u0302s : \u0124s \u2192 \u011cs . Figure 8 illustrates the diagram\n\u00d1\u01eb .............................. \u00d1\n.\n.\n.\n\n...\n...\n...\n...\n..........\n.\n\n...\n...\n...\n...\n..........\n.\n\nN\u01eb ............................... N\nwith ends of \u00cas and \u00casi attached to (resp.) \u00d1\u01eb and \u00d1 .\nNow suppose that the direction e does not form an i-illegal turn with any\ndirection in B|\u011csi . Then there is a natural way to construct the attaching\npoint in \u011cs by watching \u011csi unfold to \u011cs . In terms of widgets, we attach\n44\n\n\fv\n\nFigure 8: The thickened segments represent b\u0303\u2217 and b. The curved segments\nrepresent ends of \u1ebcs and \u1ebcsi .\n\nthe end of \u1ebcs corresponding to e to the point in B|\u011cs closest to \u1ebd\u2217 . Figure 9\nillustrates the diagram\n.\n\u00d1\u01eb .............................. \u00d1\n.\n.\n...\n...\n...\n...\n.........\n.\n\n...\n...\n...\n...\n.........\n.\n\nN\u01eb ............................... N\nwith \u00cas and \u00casi attached.\nThere is a unique homotopy class of paths in \u011cs connecting the images\nof attaching points. The map \u03c8\u0302s is defined so that it isometrically immerses\n\u00cas to the immersed path in the above homotopy class.\nNow suppose \u0124s is defined for s \u2208 (si\u22121 , s(\u03c4 )] and we want to define\n\u0124si\u22121 . Let \u03c3 be a conjugacy class in F. By construction, for s \u2208 (si\u22121 , si ),\nl(\u03c3|Gs ) = l(\u03c3|Gsi ) + (2x \u2212 y)(si \u2212 s) where x is the number of p-illegal turns\ncrossed by \u03c3|Gs that are i-legal and y is the number of i-illegal turns crossed.\nNote that x and y are constant on (si\u22121 , si ). In particular, lims\u2192s+ l(\u03c3|\u0124s )\ni\u22121\n\nexists, thereby defining \u0124si\u22121 . That \u0124si\u22121 is in cv follows from the existence\nof the limiting morphism \u0124si\u22121 \u2192 \u011csi\u22121 . Finally, note that \u00cas doesn't\ndegenerate to a point in this limit. Indeed, \u00cas(\u03c4 ) crosses a p-illegal turn and\nthis property persists by the Unfolding Principle (as s decreases, p-illegal\nturns in \u00cas move away from the endpoints of \u00cas which balances any loss at\n\n45\n\n\fv\n\nFigure 9: To decide where to attach \u00cas mimic what happens in \u011cs . The\nthickened lines represent \u00cas and \u00casi .\n\nthe ends of \u00cas due to i-illegal turns).\nSet Hs = \u0124s /vol(\u011cs ) and revert to our original parametrization. We\nnow have a path Ht , t \u2208 [0, \u03c4 ]. Define Kt exactly as before, i.e. if l(Et ) > 4,\nthen fold i-illegal turns of Ht \u2192 Gt until Et has length 4.\nA p-legal segment of length > 3*4(3n\u22123) interior to an edge of Ks would\nproduce an edge in B|Gs , hence also in B|G\u03c4 , of length > 3 * 4(3n \u2212 3). We\nwould then have an edge of length > 4(3n \u2212 3) in K\u03c4 , contradiction. A plegal segment in Ks of length > 12(3n \u2212 3)(2n \u2212 1) is then forced meet least\n2n \u2212 1 topological vertices which implies injrad(Ks ) \u2264 12(3n \u2212 3)(2n \u2212 1).\nBy assumption, A|G0 , hence also K0 , has a p-legal segment of length >\n12(3n \u2212 3)(2n \u2212 1). Arguing as at the end of Case 1, we get the contradiction\nthat dCV (G0 , G\u03c4 ) is bounded.\nCorollary 6.11. The image in F of the interval [LeftGt (A), RightGt (A)]\nhas bounded diameter.\nProof. The endpoints have bounded F-distance by Proposition 6.10(legal\nand illegal), and therefore the whole interval projects to a bounded set by\nCorollary 6.5.\nCorollary 6.11 says that the projection of A \u2208 F to \u03c0(Gt ) is bounded\ndistance from \u03c0([LeftGt (A)), RightGt (A)]). (Recall Definition 6.6.) We will,\nin Lemma 6.16, see a way to estimate where the this projection lies. To\n46\n\n\fprove Lemma 6.16, we first need a simple lemma about canceling paths\nin a graph and then a general fact that in a different form appears in [1,\nProposition 5.10 and claim on p. 2218].\nIf X is an edge-path in a graph, then [X] denotes the path obtained from\nX by tightening, i.e. [X] is the immersed edge-path homotopic rel endpoints\nto X. If the endpoints of X coincide and the resulting closed path is not\nnull-homotopic, then [[X]] denotes the loop obtained from X by tightening,\ni.e. [[X]] is the immersed circle freely homotopic to X.\nLemma 6.12. Let V be an immersed edge path in a graph G. Suppose V\nrepresents an immersed circle, i.e. V begins and ends at a vertex P and has\ndistinct initial and terminal directions. Let W be a nontrivial initial edge\nsubpath of V ending at a vertex Q and let V \u2032 = [W \u22121 V W ] (so that V \u2032 also\nrepresents an immersed circle). Also, let X and Y be immersed edge paths\nin G starting at P and Q respectively. Suppose that W Y is immersed in G.\nThen:\n(1) the maximal common initial subpath of X, W Y , and W V \u2032 Y has the\nform V N W \u2032 for some N \u2265 0 and some initial subpath W \u2032 of V .\n(2) The maximal initial subpath of X and V X has the form V N W \u2032 for some\nN \u2265 0 and some initial subpath W \u2032 of V .\nThe proof of Lemma 6.12 is left to the reader. Note that (2) follows from\n(1) applied to X, V X, and V 2 X.\nIf a and b are conjugacy classes in F and G \u2208 CV then by a|G and b|G\nshare a segment of length K we mean that there is an isometric immersion\n[0, K] \u2192 G that lifts to both a|G and b|G.\nProposition 6.13 (closing up to a simple class). There is a constant Cn >\n0 so that the following holds. Suppose G, H \u2208 CV , z is any class (not\nnecessarily simple), and K > 0. If l(z|G) \u2265 Cn Kl(z|H) then there is a\nclass u in F such that:\n\u2022 l(u|H) < 2;\n\u2022 dF (H, u) is bounded; and\n\u2022 u|G and z|G share a segment of length K.\nIn particular, u is simple.\n\n47\n\n\fIf l(z|H) < 2 then u = z works, i.e. z satisfies the conclusions of the\nlemma. So, in the proof of Proposition 6.13 we assume l(z|H) \u2265 2.\nFix a map \u03c6 : H \u2192 G so that each edge is immersed (or collapsed) and\neach vertex has at least two gates (e.g. first change the metric on H as in\nProposition 2.5 so that the tension graph is all of H, but in the rest of the\nproof we use the original metric).\nIn the proof we will not keep track of exact constants, but will talk\nabout \"long segments in common with z|G\". For example, suppose an edge\npath A in H is the concatenation A = BC of two sub-edge paths, and we\nlook at [\u03c6(A)], which is the tightening of the composition [\u03c6(B)][\u03c6(C)]. If\n[\u03c6(A)] contains a long segment in common with z|G, then so does [\u03c6(B)] or\n[\u03c6(C)] (or both), but \"long\" in the conclusion means about a half of \"long\"\nin the assumption. The number of times this argument takes place will be\nbounded, and at the end the length can be taken as large as we want by\nchoosing the original length (i.e. Cn ) large.\nRepresent z|H as a composition of \u223c l(z|H) paths zi where each zi is\neither an edge, or a combinatorially long (but of length \u2264 1) path contained\nin the thin subgraph (union of immersed loops of small length). Thus the\nloop z|G is obtained by tightening the composition of the paths [\u03c6(zi )].\nIn the process of tightening, everything must cancel except for a (possibly\ndegenerate) segment \u03c3i \u2282 [\u03c6(zi )] in each path, and at least one \u03c3i must\nhave length \u2265\u223c Cn K. So we conclude that, for some zi , [\u03c6(zi )] contains a\nlong segment in common with z|G. There are now two cases, depending on\nwhether zi is contained in the thin part or is an edge. Lemmas 6.14 and\n6.15 will prove in turn that in each case the conclusions of the proposition\nhold. After proving these lemmas, we will have completed the proof of\nProposition 6.13.\nLemma 6.14. Assume that, in addition to the hypotheses of Proposition 6.13,\nthere is an edge e so that \u03c6(e) contains a segment of length \u223c Cn K in common with z|G. Then the conclusions of Proposition 6.13 hold.\nProof. Start extending e to a legal edge path until an edge is repeated.\nThere are several possibilities.\nType 0. The first repetition is e itself, i.e. we have e..e. Then identifying\nthe e's gives a legal loop u that crosses each edge at most once, and u works.\nType 1. The first repetition is either e\u22121 or another edge with reversed\norientation, i.e. e..e\u22121 or e..a..a\u22121 . Schematically we picture this as a monogon. Note that there are two ways to traverse the monogon starting with e\nand ending with e\u22121 , both legal.\n\n48\n\n\fType 2. The first repetition is an edge a different from e and with the\nsame orientation, i.e. e..a..a. We picture this as a spiral.\nA monogon or spiral has its tail and its loop. In e..e\u22121 the tail is e and\nthe loop is represented by the edge path between e and e\u22121 ; in e..a..a\u22121 , the\ntail is e..a and the loop is represented by the edge path between a and a\u22121 ;\nand in e..a..a the tail is e..a and the loop is represented by the edge path\nbetween the a's.\nWe can also extend e in the opposite direction until an edge repeats, and\nso we have three subcases.\nSubcase 1. Type 1-1, i.e. we have Type 1 on both sides. Here we have a\nmorphism to H from a graph Y as in Figure 10 whose induced illegal turns\nform a subset of those indicated.\n\nFigure 10: Type 1-1.\nIf there is an edge b (different from e) crossed by both monogons then\nby switching from one copy of b to the other we may form a legal loop u\nthat crosses e once and all other edges at most twice. Indeed, if at least one\ncopy of b is in a loop of a monogon, then there is a legal segment in Y of the\nform b..e..b that crosses e, b, and b\u22121 only as indicated. If both copies of b\nare in tails, then there is either b..e..b as above or b..e..b\u22121 ..b. In the latter\ncase, choose the first b as close as possible to e (to guarantee all edges in\nour legal loop are crossed at most twice), and this loop works. If there is no\nsuch b, the loop u that traverses both monogons once is legal, crosses each\nedge at most twice, and crosses some edge once, so u works.\nSubcase 2. Type 1-2, i.e. we have a monogon on one side and a spiral on\nthe other.\nIf some edge b different from e is crossed by both the spiral and the\nmonogon, we can form a legal loop u that crosses e once as in Subcase 1,\nand we are done. Otherwise, let u be the loop that crosses both the spiral\nand the monogon, so it has (potentially) one illegal turn. We claim that\neither the loop v of the spiral or u works. Indeed, u crosses some edge once\nand all edges at most twice. Write u as Ev \u2032 E \u22121 v \u22121 , where E is the edge-path\n49\n\n\fFigure 11: Type 1-2.\n\nformed by the two tails and v \u2032 is the loop of the monogon. Schematically, u\ncan be drawn as in Figure 12.\n\nv\n\nE\n\nE\nv\u2032\nFigure 12: u in Subcase 2.\nNow consider the image \u03c6(u). To see how much cancellation occurs,\nlet Z be the maximal common initial segment of [\u03c6(E)] and [\u03c6(vE)]. By\nLemma 6.12(2), Z has the form [\u03c6(v)]N W \u2032 for some initial segment W \u2032 of\n[\u03c6(v)]. If Z shares a long segment with z|G then v works. Otherwise, u|G\nshares a long segment with z|G, and so works.\nSubcase 3. Type 2-2, i.e. we have two spirals.\nThe first case is that the two spirals do not contain any edges in common\nexcept for e. Then the loop u that crosses both spirals can be written in the\nform u = Ev \u2032 E \u22121 v \u22121 , pictured as a bigon (see Figure 14). The argument\nis now similar to Subcase 2. Consider the maximal common initial segment\n50\n\n\fFigure 13: Type 2-2.\n\nV (resp. V \u2032 ) of \u03c6(E) and [\u03c6(vE)] (resp. \u03c6(E \u22121 ) and [\u03c6(v \u2032 E \u22121 )]). If either\nV or V \u2032 shares a long segment with z|G then v or v \u2032 works. Otherwise, u\nworks.\n\nE\nv\u2032\n\nv\nE\n\nFigure 14: u in the first case of Subcase 3.\nThe second case is that some edge b, other than e, occurs on both spirals\nand we can construct a loop that crosses e only once by jumping from one\nb to the other. If this loop is legal, we can take it for u. Otherwise, it has\none illegal turn, and there are two possibilities.\nSuppose first that b in the tail of a spiral whose loop is v. There is then\na segment of the form b..e..b\u22121 ..v..b where the only illegal turn is the initial\npoint of v. Let u be the loop obtained by identifying the first and last b's.\nExactly as in Subcase 2, either the canceling segments of [\u03c6(u)] share a long\nsegment with z|G (in which case v works) or else u|G shares a long segment\nwith z|G.\nSecondly, suppose that b appears in the loop v of a spiral. Here there\nis a segment of the form b..e..w where w is an initial segment of v ending\nwith b and the only illegal turn is the initial vertex of w. Let u be the loop\nobtained by identifying the b's in b..e..w. Let u\u2032 be the loop obtained by\nidentifying the first and last b's of b..e..vw. By Lemma 6.12(1), either the\ncanceling segments in one of \u03c6(u) and \u03c6(u\u2032 ) shares a long segment with z|G\n(in which case v works) or else one of u|G and u\u2032 |G shares a long segment\nwith z|G.\nFinally, by choosing the first b of our segment as close as possible to e,\n51\n\n\fwe guarantee that the loop we produce crosses each edge at most twice and\nsome edge once and so works.\nLemma 6.15. Suppose that, in addition to the hypotheses of Proposition 6.13,\nthere is no edge as in Lemma 6.14, but there is a path w in the thin part\nof H of length \u2264 1 such that [\u03c6(w)] contains a segment of length \u223c Cn K in\ncommon with z|G. Then the conclusions of Proposition 6.13 hold.\nProof. First, if necessary, concatenate w with a combinatorially bounded\npath in the thin part so that its endpoints coincide. After this operation\n[\u03c6(w)] still has a long piece in common with z since \u03c6-images of edges do not.\nIf taking u = w does not work, then the path [\u03c6(w)] has the form V U V \u22121\nwith V having a long piece in common with z|G. Choose a combinatorially\nshort loop a in the thin part, based at the endpoints of w. We aim to show\nthat either a or aw works.\nWrite [\u03c6(a)] = ABA\u22121 so that B = [[B]]. The loop [[\u03c6(aw)]] is obtained\nby tightening the loop ABA\u22121 U V U \u22121 which has at most two illegal turns\n(the two occurrences of {A, U }). See Figure 15.\n\nA\n\nU\nV\n\nB\nA\n\nU\n\nFigure 15: \u03c6(aw)\nThere are two cases. If the maximal common initial segment of A and\nU is a proper segment of A then our loop becomes immersed after canceling\nthe copies of this this common initial segment at the two illegal turns. Here\naw works.\nIf U = AU \u2032 , then after canceling the common A's, we are left with\nBU \u2032 V U \u2032\u22121 . Since the initial and terminal directions of B are distinct, one\nof the turns {B, U \u2032 } and {B \u22121 , U \u2032 } is legal. Using Lemma 6.12(2) again,\neither a power of B has a long segment in common with U (in which case a\nworks) or not (in which case aw works).\n\n52\n\n\fWe have completed the proof of Proposition 6.13.\nLemma 6.16. Let Gt , t \u2208 [0, L], be a folding path in CV parametrized by\narclength, H \u2208 CV , and z a class in F. For some \u03c4 \u2208 [0, L], assume that\nl(z|G\u03c4 ) \u2265 l(z|H).\n(i) If z|G\u03c4 is legal then either left(H) \u2264 \u03c4 or dF (Left(H), G\u03c4 ) is bounded.\n(Recall Definition 6.6.)\n(i \u2032 ) If z|G\u03c4 has no immersed illegal segment of length I then either left(H) \u2264\n\u03c4 or dF (Left(H), G\u03c4 ) is bounded.\n(ii) If z is simple and z|G\u03c4 is illegal then either dF (Right(H), G\u03c4 ) is\nbounded or right(H) \u2265 \u03c4 .\nProof. We first prove (i). Let Cn be the constant from Proposition 6.13(closing\nup to a simple class). Since z|G\u03c4 is legal, by replacing \u03c4 by \u03c4 + e3Cn we\nmay assume that l(z|G\u03c4 ) \u2265 3Cn l(z|H). Proposition 6.13 then provides a\nsimple class u with l(u|H) < 2 and dF (H, u) bounded so that u|G\u03c4 has a\nsegment of length 3 in common with z|G\u03c4 ; in particular u|G\u03c4 contains a\nlegal segment of length 3 and so leftGt (u) \u2264 \u03c4 . We are done by Lemma 3.3\nand Corollary 6.5.\nThe proof of (i\u2032 ) is similar. Because z|G\u03c4 has no illegal segment of length\nI, its length grows at an exponential rate under folding. Also, the property\nof not having an illegal segment of length I is stable under folding. Therefore\nwe may assume that l(z|G\u03c4 ) \u2265 Cn Il(z|H) and conclude that u|G\u03c4 produced\nby Proposition 6.13 shares a length I segment with z|G\u03c4 and so has a legal\nsegment of length 3.\nThe proof of (ii) is also analogous. Using Lemma 5.8, by moving left from\nG\u03c4 a bounded amount in F we may assume l(z|G\u03c4 ) \u2265 Cn Il(z|H). Then\nProposition 6.13 provides a simple class u with l(u|H) < 2 and dF (H, u)\nbounded so that u|G\u03c4 has a segment of length I in common with z|G\u03c4 . In\nparticular, this segment is illegal.\nWe summarize the conclusions in Lemma 6.16(i) and (i\u2032 ) [resp. (ii)] by\nsaying that the projection of H to Gt is coarsely to the left [resp. right] of\nG\u03c4 , measured in F. (Recall Corollary 6.11.)\n\n7\n\nHyperbolicity\n\nThe following proposition provides a blueprint for proving hyperbolicity of\nF. In the case of the curve complex the same blueprint was used by Bowditch\n[7].\n53\n\n\fProposition 7.1. F is hyperbolic if and only if the following holds for\nprojections of folding paths. There is C > 0 so that:\n(i) (Fellow Travel) Any two projections \u03c0(Gt ) and \u03c0(Ht ) of folding paths\nthat start and end \"at distance 1\" (coarsely interpreted) are in each\nother's Hausdorff C-neighborhood.\n(ii) (Symmetry) If \u03c0(Gt ) goes from A to B and \u03c0(Ht ) from B to A then\nthe two projections are in each other's Hausdorff C-neighborhood.\n(iii) (Thin Triangles) Any triangle formed by projections of three folding\npaths is C-thin.\nMore precisely, in (i), if G and H are the initial points of the two paths,\nthe hypothesis means that there exist adjacent free factors A and B such\nthat A \u2208 \u03c0(G) and B \u2208 \u03c0(H), and similarly for terminal points.\nProof. It is clear that (i)-(iii) are necessary for hyperbolicity, since projections of folding paths form a uniform collection of reparametrized quasigeodesics and in hyperbolic spaces quasi-geodesics stay in bounded neighborhoods of geodesics. The converse is due to Bowditch [7] (a variant was\nused earlier by Masur-Minsky [27]). Here is a sketch. We will show that\nany loop \u03b1 in F of length L bounds a disk of area \u223c L log L. (Think of\nbounded length loops as bounding disks of area 1.) Subdivide \u03b1 into 3 \u00d7 2N\nsegments of size \u223c 1 and think of it as a polygon. Subdivide it into triangles\nin a standard way: a big triangle in the middle with vertices 2N segments\napart, then iteratively bisect remaining polygonal paths. Represent each\ndiagonal by the image of a folding path \u2013 up to bounded Hausdorff distance\nthe choices are irrelevant. Using Thin Triangles, each triangle of diameter\nD can be filled with a disk of area \u223c D. Adding the areas of all the triangles\ngives \u223c N \u00d7 2N \u223c L log L.\nProposition 7.2 generalizes Algom-Kfir's result [1].\nProposition 7.2. Let H, H \u2032 \u2208 CV with dCV (H, H \u2032 ) \u2264 M and let Gt be a\nfolding path such that dCV (H, Gt ) \u2265 M for all t. Then the distance between\nthe projections of H and H \u2032 to Gt is uniformly bounded in F.\nProof. Denote by G1 the leftmost of leftGt (z) and by G2 the rightmost of\nrightGt (z) as z|H varies over candidates in H. Then the interval [G1 , G2 ] is\nbounded in F by Lemma 3.3, Proposition 6.4, and Corollary 6.11. Let z1 |H\nbe a candidate that realizes the distance to G1 , so l(z1 |G1 ) \u2265 eM l(z1 |H)\nand l(z1 |H \u2032 ) \u2264 eM l(z1 |H). Combining these inequalities gives l(z1 |G1 ) \u2265\n54\n\n\fl(z1 |H \u2032 ), so Lemma 6.16(ii) shows RightGt (H \u2032 ) is coarsely to the right of\nG1 , measured in F. In the same way one argues that LeftGt (H \u2032 ) is coarsely\nto the left of G2 , measured in F. The claim follows.\nCorollary 7.3. A folding line that makes (\u03ba, C)-definite progress in F is\nstrongly contracting in CV (with the constants depending on \u03ba and C).\nThis simply means that, in the situation of Proposition 7.2, projections\nof H and H \u2032 to Gt are at a uniformly bounded distance in CV (depending\non \u03ba and C), measured from left to right.\nNote that a folding line that makes definite progress in F is necessarily\nin a thick part of CV (i.e. the injectivity radius of Gt is bounded below by a\npositive constant). The converse does not hold (but recall that it does hold in\nTeichm\u00fcller space, and Corollary 7.3 is the direct analog of Minsky's theorem\n[28] that Teichm\u00fcller geodesics in the thick part are strongly contracting).\nRemark 7.4. One can avoid the use of the technical Proposition 5.4(surviving\nillegal turns) in the proof of Proposition 7.2.\n\n8\n\nFellow Travelers and Symmetry\n\nWe will fix constants C1 , C2 , and D from Proposition 6.4 and Proposition 7.2, so that:\n\u2022 If B < A are free factors at F-distance \u2265 C1 from a folding path Gt\nthen the CV -distance along Gt between left(A) and left(B) is bounded\nby D,\n\u2022 The F-diameter of the projection of a path of length M to any folding\npath at distance \u2265 M is always \u2264 C2 ,\n\u2022 C1 > C2 .\nProposition 8.1. Fix C sufficiently large. Suppose Gt and H\u03c4 are two\nfolding paths, dF (Gt , H\u03c4 ) \u2265 C for all t, \u03c4 , but the initial points and the\nterminal points are at F-distance \u2264 10C. Then the projections of the two\npaths to F are uniformly bounded in diameter.\nThe same holds if the initial point of Gt is 10C-close to the terminal\npoint of H\u03c4 and the terminal point of Gt is 10C-close to the initial point of\nH\u03c4 .\n\n55\n\n\fProof. Subdivide H\u03c4 into a minimal number of segments whose F-diameter\nis bounded by C1 . Say the subdivision points are s0 < s1 < s2 < * * * < sm .\nLet Gti = leftGt (Hsi ). When C > 2C1 we have that the distance, measured\nfrom left to right, between Gti and Gti+1 along Gt is \u2264 C1 D (here C > 2C1\nis needed so that interpolating free factors are also far from Gt ). The Fdistance between Gt0 and the initial point of Gt , and also between Gtm\nand the terminal point of Gt is bounded (recall Corollary 6.5). Further,\ndCV (Gt0 , Gtm ) \u2264 mC1 D as long as Gt0 is to the left of Gtm (if it is to the\nright, the whole path Gt is F-bounded). So the projection of [Gt0 , Gtm ] to\nH\u03c4 is bounded by mC2 , as long as the CV -distance between Gt and H\u03c4 is\nbounded below by C1 D (if not then the F-distance between Gt and H\u03c4 is\nbounded, contradiction when C is sufficiently large, see Corollary 3.5). So,\nmC2 + 2(const) \u2265 (m \u2212 1)C1\nand since C1 > C2 this implies that m is bounded above. The claim follows.\nThe proof is analogous in the \"anti-parallel\" case.\nFellow Traveler and Symmetry properties are now immediate.\nProposition 8.2. Let Gt and H\u03c4 be folding paths whose initial points are\nat F-distance \u2264 R and the same holds for terminal points. Then \u03c0(Gt ) \u2282 F\nand \u03c0(H\u03c4 ) \u2282 F are in each other's bounded Hausdorff neighborhoods, the\nbound depending only on R.\nThe same holds when the initial point of \u03c0(Gt ) is R-close to the terminal\npoint of \u03c0(H\u03c4 ) and the terminal point of Gt is R-close to the initial point of\nH\u03c4 .\nProof. Let C > R be a sufficiently large constant as in Proposition 8.1.\nIf \u03c0(Gt ) is not contained in the Hausdorff C-neighborhood of \u03c0(H\u03c4 ) there\nis a subpath [Gt1 , Gt2 ] such that no point of it is C-close to \u03c0(H\u03c4 ), but\nthe endpoints Gt1 , Gt2 are within 10C. Then there is a subpath [H\u03c41 , H\u03c42 ]\nof H\u03c4 whose endpoints are within 10C of the endpoints of [Gt1 , Gt2 ] (but\nnotice that we don't know in advance if the orientations are parallel or\nanti-parallel). Now by Proposition 8.1 the set \u03c0([Gt1 , Gt2 ]) is in a bounded\nHausdorff neighborhood of \u03c0(H\u03c4 ). By the same argument \u03c0(H\u03c4 ) is contained\nin a bounded Hausdorff neighborhood of \u03c0(Gt ).\nRemark 8.3. Note that, in the situation of Proposition 8.2, any Gt0 is\nbounded F-distance from its projection to H\u03c4 . Indeed, if H\u03c40 is bounded\nF-distance from Gt0 then from Corollary 6.5 it follows that the projection\nof Gt0 is bounded F-distance from H\u03c40 .\n56\n\n\fGt\n\nGt\n\nLeftGt (a)\n\nRightGt (a)\nLeftH\u03c4 (a)\nH\u03c4\n\nH\u03c4\n\nRightH\u03c4 (a)\n\nFigure 16: The \"ahead\" and the \"behind\" cases.\n\nProposition 8.4. Let Gt and H\u03c4 be folding paths whose initial points are at\nF-distance \u2264 R and the same holds for terminal points. There is a uniform\nbound, depending only on R, to dF (LeftGt (A), LeftH\u03c4 (A)) for any free factor\nA.\nThe same holds in the anti-parallel case.\nProof. For notational simplicity, we may assume that A = hai is cyclic. First\nsuppose Gt and H\u03c4 are parallel. Modulo interchanging the two paths, we can\nassume that the projection of LeftGt (a) to H\u03c4 is \"ahead\" of LeftH\u03c4 (a) (i.e.,\nwhen LeftGt (a) is projected to H\u03c4 , it is coarsely right of LeftH\u03c4 (a) measured\nin F) and the projection of LeftH\u03c4 (a) to Gt is \"behind\" (defined analogously)\nLeftGt (a). By Lemma 6.16 if l(a| LeftGt (a)) \u2264 l(a| RightH\u03c4 (a)) then the\nprojection of LeftGt (a) to H\u03c4 is behind RightH\u03c4 (a), and the claim is proved.\nIf l(a| LeftGt (a)) \u2265 l(a| RightH\u03c4 (a)) then the projection of RightH\u03c4 (a) to Gt\nis ahead of LeftGt (a), and we are done again.\nNow suppose Gt and H\u03c4 are anti-parallel. There are two subcases to\nconsider, see Figure 16. In the first case LeftGt (A) is ahead the projection to\nGt of LeftH\u03c4 (A). This is a symmetric condition with respect to interchanging\nGt and H\u03c4 (by Remark 8.3). Say l(a| LeftGt (a)) \u2264 l(a| LeftH\u03c4 (a)). Then\nthe projection of LeftGt (a) to H\u03c4 is ahead of LeftH\u03c4 (a) by Lemma 6.16, and\nthe claim follows.\nThe \"behind\" case is similar, but we consider right projections. Say\nl(a| RightGt (a)) \u2264 l(a| RightH\u03c4 (a)). Then the projection of RightGt (a) to\nH\u03c4 is behind RightH\u03c4 (a), and the claim again follows.\n\n57\n\n\f9\n\nThin Triangles\n\nProposition 9.1. Triangles in F made of images of folding paths are uniformly thin. More precisely, if A, B, C are three free factors coarsely joined\nby images of folding paths AB, AC, BC and \u0108 is the projection of C to\nAB, then A\u0108 is in a bounded Hausdorff neighborhood of AC and B \u0108 is in\na bounded Hausdorff neighborhood of BC.\nWe will consider points U, V, W \u2208 CV and folding paths Ht from V to\nW and Gt from U to W . Denote by P the rightmost of RightGt (z) as z\nranges over candidates in V . By Lemma 3.3, P has bounded F-distance\nfrom the projection of V to Gt . See Figure 17.\n\nV\n\nQ\n\nU\n\nP\n\nW\n\nFigure 17: A thin triangle.\nWe will prove that \u03c0(V P )\u222a\u03c0(P W ) and \u03c0(V W ) are contained in uniform\nHausdorff neighborhoods of each other (by V P we mean a folding path from\nV to P etc). The basic idea is that V P \u222a P W behaves like a folding path\nand the claim is an instance of the Fellow Traveler Property.\nClaim 1. dCV (V, W ) \u2265 dCV (V, P ) + dCV (P, W ) \u2212 C for a universal\nconstant C.\nTo prove the claim, let v|V be a candidate for dCV (V, P ). By definition\nof P , v|P has only bounded length illegal subsegments. It follows that after\n58\n\n\fremoving the 1-neighborhood of each illegal turn, a definite percentage of\nthe length of v|P remains, and hence\nl(v|W ) \u2265 edCV (P,W )\u01ebl(v|P ) = edCV (V,P )+dCV (P,W ) \u01ebl(v|V )\nfor a fixed \u01eb > 0. Thus\ndCV (V, W ) \u2265 log\n\nl(v|W )\n\u2265 dCV (V, P ) + dCV (P, W ) + log \u01eb\nl(v|V )\n\nBy Q denote the point on V W such that dCV (V, Q) = dCV (V, P ). From\nClaim 1 we see that dCV (Q, W ) \u2264 dCV (P, W ) \u2264 dCV (Q, W ) + C.\nClaim 2. dF (P, Q) is bounded.\nThis time let v|V be a candidate for dCV (V, W ). Thus\nl(v|Q) = edCV (V,Q) l(v|V ) = edCV (V,P ) l(v|V ) \u2265 l(v|P )\nLet Q\u2032 be the point along QW with dCV (Q, Q\u2032 ) = log(3(2n \u2212 1)Cn ) (if such\na point does not exist, both P and Q are uniformly close to W and we\nare done). Then l(v|Q\u2032 ) = 3(2n \u2212 1)Cn l(v|Q) \u2265 3(2n \u2212 1)Cn l(v|P ), so\nProposition 6.13(closing up to a simple class) implies that there is a simple\nclass p such that p|P is of length < 2 and p|Q\u2032 has a legal segment of length\n3(2n \u2212 1). Now p|Q\u2032 cannot contain many disjoint legal segments of length\n3, for otherwise p would grow to a much longer length along Q\u2032 W than along\nP W . Now Claim 2 follows from Lemma 6.2.\nProof of Proposition 9.1. By Proposition 8.2 we are free to replace a folding\npath by another whose endpoints project close to the endpoints of the original, and we are allowed to reverse orientations. By Proposition 8.4 these\nreplacements affect the projections by a bounded amount, so that the projection \u0108 of C to AB is coarsely well-defined, independently of the choice\nof a folding path whose projection coarsely connects A and B with either\norientation. In particular, we may assume that U, V, W project near A, C, B\nrespectively and we may consider folding paths U W and V W that end at\nthe same graph W . The above discussion then shows that B \u0108 is contained\nin a bounded Hausdorff neighborhood of BC. Making analogous choices of\nthe folding paths, the claim about A\u0108 follows similarly.\nThe following fact shows that for the purposes of this paper the collection\nof folding paths can be replaced by the larger collection of geodesic paths.\n\n59\n\n\fProposition 9.2. Let V, P, W \u2208 CV so that dCV (V, P ) + dCV (P, W ) =\ndCV (V, W ) and let V \u2032 \u2208 CV be such that dCV (V, V \u2032 ) + dCV (V \u2032 , W ) =\ndCV (V, W ), dF (V, V \u2032 ) is bounded, and there is a folding path Gt from V \u2032\nto W (see Proposition 2.5). Then the F-distance between P and some Gt\nis uniformly bounded. Moreover, if H\u03c4 is a geodesic in CV from V to P ,\nthen the induced correspondence \u03c4 7\u2192 t can be taken to be monotonic with\nrespect to \u03c4 . Consequently, the set of projections to F of geodesics in CV is\na uniform collection of reparametrized quasi-geodesics in F.\nThe proof is a variant of the discussion above.\nProof. Let P \u2032 be the point on Gt with dCV (V, P \u2032 ) = dCV (V, P ) (if such a\npoint does not exist we assign V \u2032 to P ). We need to argue that dF (P, P \u2032 )\nis bounded. Let v|V be a candidate realizing dF (V, W ). Thus v|Gt is legal\nfor all t and l(v|P ) = l(v|P \u2032 ). Let Q\u2032 be a point on Gt with dCV (P \u2032 , Q\u2032 ) =\nlog(3(2n \u2212 1)Cn ) (if such a point does not exist, both P and P \u2032 are close\nto W and we are done). Then l(v|Q\u2032 ) = 3(2n \u2212 1)Cn l(v|P ), so Proposition 6.13(closing up to a simple class) implies that there is a simple class\np such that l(p|P ) < 2 and with p|Q\u2032 containing a legal segment of length\n3(2n \u2212 1). Now p|Q\u2032 cannot contain many disjoint legal segments of length\n3, for otherwise p would grow to a much longer length along Q\u2032 W than\nalong P W . Lemma 6.2 implies that dF (P, Q\u2032 ), and therefore dF (P, P \u2032 ), is\nbounded.\nTheorem 9.3. F is \u03b4-hyperbolic. Images of geodesic paths in CV are in\nuniform Hausdorff neighborhoods of geodesics with the same endpoints.\nFurthermore, an element of Out(F) has positive translation length in F\nif and only if it is fully irreducible. The action of Out(F) on F satisfies\nWeak Proper Discontinuity (see [6])).\nProof. Since we have checked Conditions (i), (ii), and (iii) in Proposition 7.1,\nF is hyperbolic. The second statement is a consequence of Proposition 9.2\nand last the two statements follow from:\n\u2022 There are coarsely well-defined, Lipschitz maps from F to the hyperbolic complexes X constructed in [5, Sections 4.4.1 and 4.4.2].\n\u2022 Given a fully irreducible element f of Out(Fn ), there is an X on which\nf has positive translation length ([5, Main Theorem]).\n\u2022 Further, for every x \u2208 X and every C > 0 there is N > 0 such\nthat {g \u2208 Out(F) | dX (x, xg) \u2264 C, dX (xf N , xf N g) \u2264 C} is finite ([5,\nSection 4.5]).\n60\n\n\fReferences\n[1] Yael Algom-Kfir. Strongly contracting geodesics in outer space. Geom.\nTopol., 15(4):2181\u20132233, 2011.\n[2] Yael Algom-Kfir and Mladen Bestvina. Asymmetry of outer space.\nGeom. Dedicata, 156:81\u201392, 2012.\n[3] M. Bestvina, M. Feighn, and M. Handel. Laminations, trees, and irreducible automorphisms of free groups. Geom. Funct. Anal., 7(2):215\u2013\n244, 1997.\n[4] Mladen Bestvina. A Bers-like proof of the existence of train tracks for\nfree group automorphisms. Fund. Math., 214(1):1\u201312, 2011.\n[5] Mladen Bestvina and Mark Feighn. A hyperbolic Out(Fn )-complex.\nGroups Geom. Dyn., 4(1):31\u201358, 2010.\n[6] Mladen Bestvina and Koji Fujiwara. Bounded cohomology of subgroups\nof mapping class groups. Geom. Topol., 6:69\u201389 (electronic), 2002.\n[7] Brian H. Bowditch. Intersection numbers and the hyperbolicity of the\ncurve complex. J. Reine Angew. Math., 598:105\u2013129, 2006.\n[8] Matt Clay. Contractibility of deformation spaces of G-trees. Algebr.\nGeom. Topol., 5:1481\u20131503 (electronic), 2005.\n[9] Marc Culler and Karen Vogtmann. Moduli of graphs and automorphisms of free groups. Invent. Math., 84(1):91\u2013119, 1986.\n[10] Matthew Day and Andrew Putman. The complex of partial bases for\nFn and finite generation of the Torelli subgroup of Aut(Fn ). Geom.\nDedicata, 164:139\u2013153, 2013.\n[11] Stefano Francaviglia and Armando Martino. Metric properties of Outer\nspace. Pub. Mat., 55:433\u2013473, 2011.\n[12] Vincent Guirardel and Gilbert Levitt. Deformation spaces of trees.\nGroups Geom. Dyn., 1(2):135\u2013181, 2007.\n[13] Michael Handel and Lee Mosher. Subgroup classification in Out(Fn ).\narXiv:0908.1255.\n61\n\n\f[14] Michael Handel and Lee Mosher. The free splitting complex of a free\ngroup, I: hyperbolicity. Geom. Topol., 17(3):1581\u20131672, 2013.\n[15] John L. Harer. Stability of the homology of the mapping class groups\nof orientable surfaces. Ann. of Math. (2), 121(2):215\u2013249, 1985.\n[16] John L. Harer. The virtual cohomological dimension of the mapping\nclass group of an orientable surface. Invent. Math., 84(1):157\u2013176, 1986.\n[17] W. J. Harvey. Boundary structure of the modular group. In Riemann\nsurfaces and related topics: Proceedings of the 1978 Stony Brook Conference (State Univ. New York, Stony Brook, N.Y., 1978), volume 97 of\nAnn. of Math. Stud., pages 245\u2013251. Princeton Univ. Press, Princeton,\nN.J., 1981.\n[18] Allan Hatcher, Karen Vogtmann, and Natalie Wahl. Erratum to: \"Homology stability for outer automorphism groups of free groups [Algebr.\nGeom. Topol. 4 (2004), 1253\u20131272 (electronic) by Hatcher and Vogtmann. Algebr. Geom. Topol., 6:573\u2013579 (electronic), 2006.\n[19] Allen Hatcher and Karen Vogtmann. Cerf theory for graphs. J. London\nMath. Soc. (2), 58(3):633\u2013655, 1998.\n[20] Allen Hatcher and Karen Vogtmann. The complex of free factors of a\nfree group. Quart. J. Math. Oxford Ser. (2), 49(196):459\u2013468, 1998.\n[21] Allen Hatcher and Karen Vogtmann. Homology stability for outer automorphism groups of free groups. Algebr. Geom. Topol., 4:1253\u20131272,\n2004.\n[22] Arnaud Hilion and Camille Horbez. The hyperbolicity of the sphere\ncomplex via surgery paths. arXiv:1210.6183.\n[23] Ilya Kapovich and Martin Lustig. Geometric intersection number\nand analogues of the curve complex for free groups. Geom. Topol.,\n13(3):1805\u20131833, 2009.\n[24] Ilya Kapovich and Kasra Rafi. On hyperbolicity of free splitting and\nfree factor complexes. arXiv:1206.3626, to appear in Groups, Geometry,\nand Dynamics.\n[25] Brian Mann.\nHyperbolicity of the cyclic splitting complex.\narXiv:1212.2986, to appear in Geometria Dedicata.\n\n62\n\n\f[26] Reiner Martin. Non-uniquely ergodic foliations of thin type, measured\ncurrents, and automorphisms of free groups. PhD thesis, UCLA, 1995.\n[27] Howard A. Masur and Yair N. Minsky. Geometry of the complex of\ncurves. I. Hyperbolicity. Invent. Math., 138(1):103\u2013149, 1999.\n[28] Yair N. Minsky. Quasi-projections in Teichm\u00fcller space. J. Reine\nAngew. Math., 473:121\u2013136, 1996.\n[29] Richard K. Skora. Deformations of length functions in groups. preprint,\n1989.\n[30] John R. Stallings. Topology of finite graphs. Invent. Math., 71(3):551\u2013\n565, 1983.\n[31] John R. Stallings. Whitehead graphs on handlebodies. In Geometric\ngroup theory down under (Canberra, 1996), pages 317\u2013330. de Gruyter,\nBerlin, 1999.\n[32] J. H. C. Whitehead. On certain sets of elements in a free group. Proc.\nLondon Math. Soc., 41:48\u201356, 1936.\n\n63\n\n\f"}