{"id": "http://arxiv.org/abs/0911.5475v1", "guidislink": true, "updated": "2009-11-29T10:34:49Z", "updated_parsed": [2009, 11, 29, 10, 34, 49, 6, 333, 0], "published": "2009-11-29T10:34:49Z", "published_parsed": [2009, 11, 29, 10, 34, 49, 6, 333, 0], "title": "The chain relation in sofic subshifts", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0911.1005%2C0911.3496%2C0911.4603%2C0911.0523%2C0911.1583%2C0911.2139%2C0911.3001%2C0911.3770%2C0911.1218%2C0911.5475%2C0911.2751%2C0911.0960%2C0911.1519%2C0911.1294%2C0911.5388%2C0911.4876%2C0911.4574%2C0911.4010%2C0911.4832%2C0911.0059%2C0911.0482%2C0911.1620%2C0911.3455%2C0911.1008%2C0911.3909%2C0911.5523%2C0911.2551%2C0911.0603%2C0911.3673%2C0911.3803%2C0911.4196%2C0911.0369%2C0911.2539%2C0911.3070%2C0911.5268%2C0911.1072%2C0911.0831%2C0911.3624%2C0911.3448%2C0911.1643%2C0911.2599%2C0911.1369%2C0911.1279%2C0911.1817%2C0911.0745%2C0911.0649%2C0911.2531%2C0911.1430%2C0911.4006%2C0911.0480%2C0911.2368%2C0911.4166%2C0911.0581%2C0911.2122%2C0911.2757%2C0911.4983%2C0911.4724%2C0911.3573%2C0911.1141%2C0911.1361%2C0911.3936%2C0911.3200%2C0911.1213%2C0911.4143%2C0911.1930%2C0911.2118%2C0911.4639%2C0911.1339%2C0911.0266%2C0911.4024%2C0911.3231%2C0911.0690%2C0911.3399%2C0911.1868%2C0911.0685%2C0911.3118%2C0911.3945%2C0911.4467%2C0911.4241%2C0911.0452%2C0911.5569%2C0911.3865%2C0911.1762%2C0911.5259%2C0911.0359%2C0911.4900%2C0911.5248%2C0911.5056%2C0911.3764%2C0911.5448%2C0911.3300%2C0911.3492%2C0911.4678%2C0911.2111%2C0911.1417%2C0911.0958%2C0911.0062%2C0911.2339%2C0911.1206%2C0911.4458%2C0911.2606&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The chain relation in sofic subshifts"}, "summary": "The paper gives a characterisation of the chain relation of a sofic subshift.\nEvery sofic subshift $\\Sigma$ can be described by a labelled graph $G$.\nFactorising $G$ in a suitable way we obtain the graph $G/_\\approx$ that offers\ninsight into some properties of the original subshift. Using $G/_\\approx$ we\ndescribe first the chain relation in $\\Sigma$, then characterise\nchain-transitive sofic subshifts, chain-mixing sofic subshifts and finally the\nattractors of the subshift dynamic system. At the end we present\n(straightforward) algorithms deciding chain-transitivity and chain-mixing\nproperties of a sofic subshift and listing all the attractors of the subshift\nsystem.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0911.1005%2C0911.3496%2C0911.4603%2C0911.0523%2C0911.1583%2C0911.2139%2C0911.3001%2C0911.3770%2C0911.1218%2C0911.5475%2C0911.2751%2C0911.0960%2C0911.1519%2C0911.1294%2C0911.5388%2C0911.4876%2C0911.4574%2C0911.4010%2C0911.4832%2C0911.0059%2C0911.0482%2C0911.1620%2C0911.3455%2C0911.1008%2C0911.3909%2C0911.5523%2C0911.2551%2C0911.0603%2C0911.3673%2C0911.3803%2C0911.4196%2C0911.0369%2C0911.2539%2C0911.3070%2C0911.5268%2C0911.1072%2C0911.0831%2C0911.3624%2C0911.3448%2C0911.1643%2C0911.2599%2C0911.1369%2C0911.1279%2C0911.1817%2C0911.0745%2C0911.0649%2C0911.2531%2C0911.1430%2C0911.4006%2C0911.0480%2C0911.2368%2C0911.4166%2C0911.0581%2C0911.2122%2C0911.2757%2C0911.4983%2C0911.4724%2C0911.3573%2C0911.1141%2C0911.1361%2C0911.3936%2C0911.3200%2C0911.1213%2C0911.4143%2C0911.1930%2C0911.2118%2C0911.4639%2C0911.1339%2C0911.0266%2C0911.4024%2C0911.3231%2C0911.0690%2C0911.3399%2C0911.1868%2C0911.0685%2C0911.3118%2C0911.3945%2C0911.4467%2C0911.4241%2C0911.0452%2C0911.5569%2C0911.3865%2C0911.1762%2C0911.5259%2C0911.0359%2C0911.4900%2C0911.5248%2C0911.5056%2C0911.3764%2C0911.5448%2C0911.3300%2C0911.3492%2C0911.4678%2C0911.2111%2C0911.1417%2C0911.0958%2C0911.0062%2C0911.2339%2C0911.1206%2C0911.4458%2C0911.2606&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The paper gives a characterisation of the chain relation of a sofic subshift.\nEvery sofic subshift $\\Sigma$ can be described by a labelled graph $G$.\nFactorising $G$ in a suitable way we obtain the graph $G/_\\approx$ that offers\ninsight into some properties of the original subshift. Using $G/_\\approx$ we\ndescribe first the chain relation in $\\Sigma$, then characterise\nchain-transitive sofic subshifts, chain-mixing sofic subshifts and finally the\nattractors of the subshift dynamic system. At the end we present\n(straightforward) algorithms deciding chain-transitivity and chain-mixing\nproperties of a sofic subshift and listing all the attractors of the subshift\nsystem."}, "authors": ["Alexandr Kazda"], "author_detail": {"name": "Alexandr Kazda"}, "author": "Alexandr Kazda", "arxiv_comment": "14 pages, 9 figures, preprint (final version published in Fundamenta\n  Informaticae)", "links": [{"href": "http://arxiv.org/abs/0911.5475v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0911.5475v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "37B10; 68R15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0911.5475v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0911.5475v1", "journal_reference": "Fundamenta Informaticae. volume 84. number 3-4. pages 375-390.\n  2008", "doi": null, "fulltext": "The chain relation in sofic subshifts\n\narXiv:0911.5475v1 [math.DS] 29 Nov 2009\n\nAlexandr Kazda\u2217\n\nAbstract\nThe paper gives a characterisation of the chain relation of a sofic subshift. Every sofic\nsubshift \u03a3 can be described by a labelled graph G. Factorising G in a suitable way we obtain\nthe graph G/\u2248 that offers insight into some properties of the original subshift. Using G/\u2248 we\ndescribe first the chain relation in \u03a3, then characterise chain-transitive sofic subshifts, chainmixing sofic subshifts and finally the attractors of the subshift dynamic system. At the end we\npresent (straightforward) algorithms deciding chain-transitivity and chain-mixing properties\nof a sofic subshift and listing all the attractors of the subshift system.\nKeywords: Sofic subshift, chain relation, chain-transitivity, chain-mixing, attractor.\n\n1\n\nIntroduction\n\nThe properties of subshifts play a key role in symbolic dynamics and in the study of various dynamical systems (for example, cellular automata). The chain relation is an important characteristic of\nsubshifts as well as of dynamical systems in general.\nThis paper addresses the question how, given a sofic subshift \u03a3 (described by a labelled graph),\none can deduce certain properties of this subshift: what does its chain relation look like, whether\nthe subshift is chain-transitive or chain-mixing and what are the attractors of the system (\u03a3, \u03c3).\nWhile the answer to this question was previously known in the special case of subshifts of finite\ntype (a subshift \u03a3 is of finite type when x \u2208 \u03a3 iff x does not contain any factor from a given finite\nset F of forbidden words.), it could not be directly applied to the more general sofic subshifts.\nThe core idea of this paper is to factorise the graph G describing the sofic subshift \u03a3. By\nidentifying the pairs of vertices whose restricted follower sets have infinite intersections, we obtain\nthe linking graph of G. We can then deduce certain properties of \u03a3 from this linking graph. We shall\nformulate an explicit description of the chain relation (Theorem 14), obtaining the characterisation\nof chain-transitive sofic subshifts as a corollary (Corollary 15). Then we focus on the attractors of\n(\u03a3, \u03c3), characterising them (Theorem 19), and use the description of the chain-transitive property\nfor the explicit description of the chain-mixing property (Theorem 16). Finally, we show that we\ncan check all these properties algorithmically.\nThe properties discussed have several applications. The chain relation tells us whether we can\nget from x \u2208 \u03a3 to y \u2208 \u03a3 in a certain way. Several theorems connect this relation and the attractors\nof (\u03a3, \u03c3).\nThe chain-mixing property can be used in the study of cellular automata. In [2], it is shown\nthat each subshift attractor (an attractor that is also a subshift) of a one-dimensional cellular\nautomaton must be chain-mixing. Using the algorithms from this paper, it is now possible to\nconclude that many sofic subshifts can never be attractors of cellular automata because they are\nnot chain-mixing. Unfortunately, being chain-mixing is not a sufficient condition to be an attractor\n(see examples in [2]).\n\n2\n\nPreliminaries\n\nIn this section we shall define several key terms from symbolic dynamics.\n\u2217 The\n\nauthor would like to thank his mentor prof. Petr K\u016frka for support and valuable advice.\n\n1\n\n\fLet A be a finite alphabet. Then A\u2217 resp. AZ is the set of all finite resp. (two-sided) infinite\nwords consisting of letters from A. Given a (finite or infinite) word x denote by xi \u2208 A the i-th\nletter of x. Note that the set A\u2217 contains the empty word \u03bb.\nWe can write nonempty finite words as u = u1 u2 * * * un . Denote the length of u as |u| and define\nthe concatenation operation as uv = u1 * * * un v1 * * * vk where n is the length of u and k the length\nof v. We adopt the notation u[k,l] for the word uk uk+1 * * * ul .\nLet u, v be words (v may be finite or (one- or two-sided) infinite, u is finite) in alphabet A. We\nsay that u is a factor of v and write u \u2291 v iff there exist k, l \u2208 Z such that u = v[k,l] or if u = \u03bb.\nThe shift map is the mapping \u03c3 : AZ \u2192 AZ given by \u03c3(x)i = xi+1 .\nThe set AZ can be understood as a metric space: For x 6= y \u2208 AZ let \u03c1(x, y) = 2\u2212n , where n\nis the minimal nonnegative integer such that xn 6= yn or x\u2212n 6= y\u2212n . If x = y, set \u03c1(x, y) = 0.\nThen \u03c1 is a metric on AZ . The space AZ equipped with the topology induced by \u03c1 is sometimes\ncalled the Cantor space. Topologically, AZ is a product of compact discrete spaces A and it is thus\ncompact.\nThe set \u03a3 \u2286 AZ is called a subshift iff it is topologically closed and strongly invariant under \u03c3,\nthat is, \u03c3(\u03a3) = \u03a3.\nNotice that a subshift is a closed subspace of the compact space AZ and is thus itself compact.\nA dynamical system (X, F ) is a pair consisting of a compact metric space X and a continuous\nmap F : X \u2192 X. An example of a dynamical system is the pair (\u03a3, \u03c3) where \u03a3 \u2286 AZ is a subshift\nand \u03c3 is the shift map.\nLet \u03a3 be a subshift. The language of \u03a3, denoted by L(\u03a3), is the set of all factors of words from\n\u03a3: L(\u03a3) = {v|\u2203x \u2208 \u03a3, v \u2291 x}.\nRemark. The language L(\u03a3) is central (some authors use the term extendable), that is:\n\u2022 For every w \u2291 v \u2208 L(\u03a3) we have w \u2208 L(\u03a3).\n\u2022 For every v \u2208 L(\u03a3) there exist nonempty words u, w such that uvw \u2208 L(\u03a3).\nWe say that a language is regular if it can be recognised by some finite automaton (a machine\nwith finite memory). A subshift whose language is regular is called sofic.\nA labelled graph G over alphabet A is an oriented multidigraph (a graph where we allow multiple\nparallel edges and loops) whose edges are labelled with the letters from alphabet A. More precisely,\nthe labelled graph is a quintuple (V (G), E(G), s, t, l) where V (G) is the set of vertices, E(G) the\nset of edges and the mappings s, t : E(G) \u2192 V (G) and l : E(G) \u2192 A assign to each edge e its\nstarting and ending vertex and its label, respectively. Both V (G) and E(G) must be finite.\nA subgraph H of a labelled graph G = (V (G), E(G), s, t, l) (over alphabet A) is a labelled\ngraph (V (H), E(H), sH , tH , lH ) such that V (H) \u2286 V (G), E(H) \u2286 E(G) and the mappings sH , tH\nand lH are restrictions of s, t and l, respectively. The subgraph of G induced by the set U is the\nsubgraph H of G such that V (H) = U and the set E(H) contains all the edges e \u2208 E(G) such\nthat s(e), t(e) \u2208 V (H).\nWe call a subgraph H of G terminal if there is no edge e \u2208 E(G) starting in v \u2208 V (H) and\nending in u \u2208 V (G) \\ V (H). Similarly, we define initial subgraph H of G as a subgraph such that\nno edge e \u2208 E(G) starts in v \u2208 V (G) \\ V (H) and ends in u \u2208 V (H).\nA walk of length l in a graph G is any sequence v0 e1 v1 . . . el vl where vi \u2208 V (G), ei \u2208 E(G) are\nvertices and edges of G and the edge ei+1 leads from vi to vi+1 in G for each i = 0, 1 . . . , l \u2212 1.\nWe allow walks of length zero (a single vertex). We also define biinfinite walks as sequences\n. . . v\u22122 e\u22121 v\u22121 e0 v0 e1 v1 e2 v2 . . . such that the edge ei+1 leads from vi to vi+1 in G for each i \u2208 Z.\nA walk of length 0 < l < \u221e is closed if v0 = vl .\nAs any walk of nonzero length is uniquely determined by its sequence of edges, we shall often\nuse a shorthand description of walks, writing down just the edges.\nA labelled graph G is called connected iff for all u, v \u2208 V (G) there exists a walk from u to v.\n(To be precise, this is the definition of a strongly connected graph. However, we do not consider\nweak connectivity in the article and so we can safely omit this adjective.) We allow walks of length\nzero, so a single vertex graph is considered connected in this paper.\n2\n\n\fA labelled graph G is periodic iff V (G) can be partitioned into n > 1 disjoint sets of vertices\nV0 , V1 , . . . , Vn\u22121 such that every edge e \u2208 E(G) leads from some v \u2208 Vk to some u \u2208 Vk+1 (here\nVn = V0 ) for a suitable k. A graph is aperiodic iff it is not periodic.\nGiven a graph G, we can partition G into its maximal connected subgraphs K1 , K2 , . . . , Kn .\nThese graphs are obviously disjoint and for every vertex v \u2208 G there exists i such that v \u2208 V (Ki )\n(we allow single-vertex components). Call K1 , . . . , Kn the components of G.\nThe subshift of a labelled graph G is the set \u03a3(G) of all x \u2208 AZ such that in G there exists a\nbiinfinite walk {ei }i\u2208Z such that l(ei ) = xi . It is easy to verify that \u03a3(G) is indeed a subshift of\nAZ . Call the language of \u03a3(G) the language of the graph G and denote it by L(G).\nA vertex v of a graph G is called stranded iff it does not have at least one outgoing and at least\none ingoing edge (a loop counts as both).\nA graph G is called essential iff it does not contain stranded vertices.\nIt is easy to see that for an essential G a (finite) word u = u1 u2 . . . uk belongs to the language\nL(G) of G iff there exists a walk e1 e2 . . . ek in G such that the edge ei is labelled by the letter ui .\nCall such a walk a presentation of v in G. Because we allow empty walks, every L(G) also contains\nthe empty word \u03bb. It can be shown that forgetting all stranded vertices of G does not change the\nlanguage L(G), so we can safely limit ourselves to essential graphs. See [5, p. 37] for details.\nProposition 1. [4, p. 133] The central language L is a language of a sofic subshift iff it can be\nobtained as the language of some labelled graph.\nFor the sake of providing context we shall now briefly discuss transitivity and the mixing\nproperty.\nWe say that the subshift \u03a3 is transitive, iff for every \u03b5 > 0 and every u, v \u2208 \u03a3 there exists k and\nw \u2208 \u03a3 such that \u03c1(u, w) < \u03b5 and \u03c1(v, \u03c3 k (w)) < \u03b5. We say that \u03a3 is mixing if for every u, v \u2208 \u03a3\nand every \u03b5 > 0 there exists n such that for every k > n there exists w such that \u03c1(u, w) < \u03b5 and\n\u03c1(v, \u03c3 k (w)) < \u03b5.\nIt can be shown (see [5, p. 80\u201382, 127\u2013129], note that the authors of [5] use the term \"irreducible\" for what we call \"transitive\") that a sofic subshift \u03a3 is transitive iff there exists a\nconnected labelled graph whose subshift is \u03a3 and it is mixing iff there exists a connected aperiodic\nlabelled graph whose subshift is \u03a3.\nThe chain-transitivity and chain-mixing properties are weaker properties than transitivity and\nmixing, respectively.\nAn \u03b5-chain (in \u03a3) of length n > 0 from x0 to xn is a sequence of words x0 , x1 , . . . , xn \u2208 \u03a3 such\nthat \u03c1(\u03c3(xi ), xi+1 ) < \u03b5 for all i = 1, 2, . . . , n \u2212 1.\nLet \u03a3 be a subshift. We say that \u03a3 is chain-transitive iff for every words x, y \u2208 \u03a3 and every\n\u03b5 > 0 there exists an \u03b5-chain in \u03a3 from x to y. We say that \u03a3 is chain-mixing if for every x, y \u2208 \u03a3\nand \u03b5 > 0 there exists k \u2208 N such that for every n > k there exists an \u03b5-chain in \u03a3 of length n\nfrom x to y.\nLet \u03a3 be a subshift, x, y \u2208 \u03a3. We say that x and y (in this order) are in the chain relation,\nwriting (x, y) \u2208 C if for every \u03b5 > 0 there exists an \u03b5-chain from x to y.\nObviously, \u03a3 is chain-transitive iff C = \u03a3 \u00d7 \u03a3.\nAs we have a one-to-one correspondence between subshifts and central languages, we may\ncall a language chain-transitive or chain-mixing meaning that its subshift has this property. We\ncharacterise these properties in terms of the language L(\u03a3).\nDefinition 2. Let L be a language, u, v \u2208 L, |u| = |v| = m. The chain of length n from u\nto v in L is a word w, |w| = n + m with prefix u and suffix v (more precisely, w[1,m] = u and\nw[|w|\u2212m+1,|w|] = v) such that if z \u2291 w, |z| \u2264 m then z \u2208 L.\nNote that while \u03b5-chains can not have zero length, we do allow chains of length zero.\nProposition 3. The pair (x, y) is in C iff for every l \u2208 N there exists a chain of nonzero length\nfrom x[\u2212l,l] to y[\u2212l,l] .\n\n3\n\n\f\u2212l \u2212 1\n\nl+1\n\n0\n\na0\n\nz0\n\nu\na0 a1\na0 a1 a2\n\nz1\n\n..\n.\n\nz n\u22121\nzn\nv\n\nFigure 1: The correspondence between \u03b5-chains and chains.\n\nProof. Let first (x, y) lie in C, and let l \u2208 N. Consider u = x[\u2212l,l] , v = y[\u2212l,l] , \u03b5 = 2\u2212l\u22121 . There exists\ni\nan \u03b5-chain x = z 0 , z 1 , . . . , z n = y. Now consider the letters ai = zl+1\n. As \u03c1(\u03c3(z i ), z i+1 ) < 2\u2212l\u22121 ,\ni+1\ni\nit must be z[\u2212l\u22121,l+1] = z[\u2212l,l+2] .\ni\nLet w = ua0 a1 . . . an\u22121 . Then the word w[i+1,i+2l+1] is equal to z[\u2212l,l]\n(see Figure 1) for every\nn\ni = 0, 1, . . . , n and so all the factors of w of length 2l + 1 belong to L. Because v = z[\u2212l,l]\n, the word\nua0 a1 . . . an\u22121 is a chain from u to v. Notice that the length n > 0 of the original \u03b5-chain from x\nto y is equal to the length of the constructed chain from u to v.\nOn the other hand, let without loss of generality \u03b5 = 2\u2212l+1 for some l and assume that there\nexists a chain of nonzero length from u = x[\u2212l,l] to v = y[\u2212l,l] . We shall prove that there exists an\n\u03b5-chain from x to y.\nLet w be the chain from u to v of length n > 0. Set z 0 = x, z n = y. Denote by z i , i =\n1, 2, . . . , n \u2212 1, an arbitrary infinite extension of the word w[i+1,i+2l+1] in \u03a3 (such an extension\ni\nexists because w[i,i+2l] \u2208 L, L is central and \u03a3 is compact) with w[i+1,i+2l+1] = z[\u2212l,l]\n. Note that\n0 1\nx and y are extensions of u and v respectively. We want to check that x = z , z , . . . , z n = y is\ni+1\ni\nan 2\u2212l+1 -chain: z[\u2212l+2,l]\n= w[i+3,i+2l+1] = z[\u2212l+1,l\u22121]\nand thus \u03c1(\u03c3(z i ), z i+1 ) < 2\u2212l+1 . Again note\nthat the length of the produced \u03b5-chain is equal to the length of the chain w.\nCorollary 4. Let L = L(\u03a3).\n1. The subshift \u03a3 is chain-transitive iff for every u, v \u2208 L, |u| = |v| = m there exists a chain of\nnonzero length from u to v\n2. The subshift \u03a3 is chain-mixing iff for every u, v \u2208 L, |u| = |v| = m exists k \u2208 N such that for\nall n > k there exists a chain of length n from u to v.\nProof. The first claim directly follows from Proposition 3. To prove the second claim it is sufficient\nto notice that the length of \u03b5-chain and of the corresponding chain construed in the proof of\nProposition 3 is the same.\n\n3\n\nThe Linking Graph\n\nThe purpose of this section is to define the linking graph which provides useful tool for the study\nof the chain relation.\nDefinition 5. Let G be a labelled graph and v be a vertex in G. The follower set of v in G is the\nlanguage FG (v) of all finite words that have presentations in G that start at vertex v.\n4\n\n\fc\n\na\n\na\n\nd\n\ne\n\nd\n\nc\n\nb\n\na\nb\n\nd\nG\n\ne\n\nb\nb\n\nG/\u2248\n\nFigure 2: An example of a linking graph.\n\nIf v is a vertex of G belonging to a component K, we shall call the set FK (v) the restricted\nfollower set and denote it by F (v).\nDefinition 6. Let G be a graph and v, w \u2208 V (G). We say that the vertices v, w are linked iff\n|F (v) \u2229 F (w)| = \u221e (note that we consider restricted follower sets here) and write v \u223c w. Denote\nby \u2248 the transitive and reflexive closure of \u223c.\nLemma 7. The vertices v and w are linked iff for any positive integer n there exists a word\nz \u2208 F (v) \u2229 F (w), |z| = n.\nProof. First observe that if yz \u2208 F (v) then y \u2208 F (v) as we can simply forget the ending of the\npresentation of yz to obtain a presentation of y.\nIf now |F (v) \u2229 F (w)| = \u221e then F (v) \u2229 F (w) must contain arbitrarily large words as A is finite.\nFor a given n, consider y \u2208 F (v)\u2229F (w), |y| > n. There exist z1 , z2 such that |z1 | = n and z1 z2 = y.\nThanks to the above remark we have that z1 \u2208 F (v) \u2229 F (w) and we are done.\nOn the other hand, if F (v) \u2229 F (w) contains word z1 of length 1, z2 of length 2 and so on, then\nthere is an infinite subset {z1 , z2 , . . . } of F (v) \u2229 F (w) and thus |F (v) \u2229 F (w)| = \u221e.\nDefinition 8. Let G be a labelled graph. The graph G/\u2248 , called the linking graph of G, is a\ngraph obtained from G by joining all pairs of linked vertices. More precisely: The set V (G/\u2248 ) is\nthe set of all equivalence classes of \u2248 on V (G). An edge e (labelled by the letter a) goes from a\nvertex x to a vertex y in G/\u2248 iff there exist vertices u \u2208 x, v \u2208 y such that an edge f labelled by\na goes from u to v in G.\nIn a labelled graph, a word might have multiple presentations. Define the projection \u03c0 : V (G) \u2192\nV (G/\u2248 ) that assigns to every v \u2208 V (G) the equivalence class of v in \u2248. We want to show that, for\nv long enough, the images under \u03c0 of every pair of presentations of v intersect in a nice way.\nIn the following, let c be the number of components of G.\nLemma 9. Let t be a positive integer. Let the (nonempty) graph G consist of c components and let\nk \u2265 (t + 1)c2 + c. Let e1 , . . . , ek and f1 , . . . , fk be two walks in G. Then there exist two components\nMe , Mf of G and a positive integer r \u2264 k \u2212 t + 1 such that ei+r \u2208 Me and fi+r \u2208 Mf for every\ni \u2208 {0, 1, 2, . . . , t \u2212 1}.\nProof. To prove the lemma, we shall use the pigeonhole principle. Without loss of generality,\nassume k = (t + 1)c2 + c. Since there are c components, at most c \u2212 1 edges are spent traversing\nbetween components. Thus there exists an interval es , es+1 , . . . , es+c(t+1)\u22121 of the walk e1 , . . . , ek\nof length c(t + 1) that passes through only one component Me .\n\n5\n\n\ff\n\nMf\n\ne\nMe\n\nFigure 3: The two walks from Lemma 9. The thick arrows represent the interval r, r+1, . . . , r+t\u22121.\n\nConsider the walk fs , fs+1 , . . . , fs+c(t+1)\u22121 . This is a walk of length tc + c and thus, using\nthe above argument again, there exists an interval fr , fr+1 , . . . , fr+t\u22121 going through only one\ncomponent Mf . But then er+i \u2208 E(Me ) and fr+i \u2208 E(Mf ) for i = 0, 1, . . . , t \u2212 1.\nCorollary 10. For every (nonempty) labelled graph G there exists a length l such that if w \u2208 L(G)\n\u2032\nis of length at least l and v1 e1 v2 e2 . . . e|w| v|w|+1 and v1\u2032 e\u20321 v2\u2032 e\u20322 . . . e\u2032|w|v|w|+1\nare two presentations\n\u2032\nof w in G, then there exists r such that \u03c0(vr ) = \u03c0(vr ) (recall that \u03c0 is the projection from G to\nG/\u2248 ).\nProof. If w1 , w2 \u2208 V (G) are not linked then there exists a finite mw1 ,w2 such that |FK (w1 ) \u2229\nFL (w2 )| = mw1 ,w2 . Take m = 1 + max{mw1 ,w2 : w1 , w2 \u2208 V (G) not linked}. It is then easy to\nsee that any two vertices u, v \u2208 V (G) are linked iff the intersection of their restricted follower sets\ncontains a word of length m.\nTake l = (m + 1)c2 + c, and use Lemma 9 for the two presentations of w. We obtain that there\nexists r such that vr and vr\u2032 both contain the word w[r,r+m\u22121] in their restricted follower sets. Thus\nvr and vr\u2032 must be linked and so \u03c0(vr ) = \u03c0(vr\u2032 ).\nThe components of G/\u2248 are partially ordered by the relation \"the component K can be reached\nfrom the component L\". Denote this relation by K \u2265 L.\nDefinition 11. We call a sequence z0 , . . . , zn of vertices of G a generalised walk if there exist edges\n\u2032\ne1 , e2 , . . . , en\u22121 \u2208 E(G) such that every ei leads from zi to some zi+1\n\u2248 zi+1 .\nNotice that every walk in G/\u2248 corresponds to a generalised walk in G. Informally, a generalised\nwalk is a sequence of ordinary walks interleaved by occasional \"jumps\" to equivalent (under \u2248)\nvertices. Crucial to our proof will be the following lemma describing a way to perform these\n\"jumps\".\nLemma 12. Let u \u2248 u\u2032 be vertices of a labelled graph G. Let w be a word whose presentation ends\nin u. Then there exists a word w\u2032 whose presentation ends in u\u2032 such that |w| = |w\u2032 | and there\nexists a chain from w to w\u2032 .\nProof. As u \u2248 u\u2032 , there exists a sequence of linked vertices u = v0 \u223c v1 \u223c * * * \u223c vk = u\u2032 . Let us\nproceed by induction on k:\n1. If k = 0 then we are done, as it suffices to take w = w\u2032 .\n6\n\n\fz\ns\nw\u2032\u2032\nr\n\nw\u2032\nz\n\nt\n\nu\u2032\n\nFigure 4: Getting from w\u2032\u2032 to w\u2032 .\n\n2. Assume that the claim is true when k < n for some n. Let us have u = v0 \u223c * * * \u223c vn\u22121 \u223c\nvn = u\u2032 . By the induction hypothesis, there exists a chain q from w to some w\u2032\u2032 such that\none presentation of w\u2032\u2032 ends in the vertex s = vn\u22121 .\nIt is s \u223c u\u2032 , so there exists z \u2208 F (s) \u2229 F (u\u2032 ), |z| = |w\u2032\u2032 |. Because z \u2208 F (u\u2032 ), there exists a\npresentation of z beginning in u\u2032 that does not leave the component of u\u2032 . Call t the ending\nvertex of this presentation. There exists a walk from t back to u\u2032 which presents some word\nr (see Figure 4). Consider now the sequence w\u2032\u2032 zr. It is easy to verify that this is a chain\nfrom w\u2032\u2032 to w\u2032 = (w\u2032\u2032 zr)[|w\u2032\u2032 zr|\u2212|w\u2032\u2032 |+1,|w\u2032\u2032 zr|] and that w\u2032 has a presentation ending in u\u2032 .\nBut then qzr is a chain from w to w\u2032 , ending the proof.\n\nRemark. If x is an infinite word and p, q two presentations of x then the images \u03c0(p) and \u03c0(q)\nof p and q under the projection \u03c0 both begin in the same component \u03b1(x) and end in the same\ncomponent \u03c9(x) of G/\u2248 .\nProof. Let K, L be the components of G/\u2248 where \u03c0(p), \u03c0(q), respectively, end. These components\nare guaranteed to exist because G/\u2248 is finite; they are the maximal (under the ordering \u2264) components visited by \u03c0(p) resp. \u03c0(q). There exists n such that the intervals [n, \u221e) of \u03c0(p), \u03c0(q) both\nstay in K, L. But due to Corollary 10 there must exist some v \u2208 p[n,\u221e) and v \u2032 \u2208 q[n,\u221e) such that\n\u03c0(v) = \u03c0(v \u2032 ) and so K = L. Similar argument holds for the beginnings of p, q.\nRemark. Let G be a nonempty labelled graph. Let H be a subgraph of G/\u2248 and let K = \u03c0 \u22121 (H).\nDenote by L the subgraph of G induced by the vertices not in K (see Figure 5). Then there exists\nm such that no word of length at least m may simultaneously have a presentation in K and in L.\n\nProof. Let m be equal to the constant from Corollary 10. This Corollary tells us that if some u\nof length m had a presentation in both K and L then there would exist two vertices u \u2208 K, v \u2208 L\nsuch that \u03c0(u) = \u03c0(v). But the whole set \u03c0 \u22121 (u) must lie either in K or in L, a contradiction.\nLemma 13. Let H be a terminal subgraph of G/\u2248 , let K, L and m be as in Remark 3. Let u be\na word of length l \u2265 2m + 1 with a presentation in K and let there lead a chain from u to some v.\nThen v[m+1,l] has a presentation in K.\nProof. Take the chain w of length n from u to v. We prove this lemma by mathematical induction\non n.\n1. For n = 0 the claim is trivial.\n7\n\n\fK\n\nL\nG\n\nFigure 5: Example of the situation in Remark 3 and Lemma 13.\nt = w[n+m+1\u2212l,n+m]\nv[1,m]\n\nv[m+1,l]\n\nw\nu\n\nv\n\nFigure 6: Factors of w and v in detail.\n\n2. Let all lengths smaller than n satisfy the condition. Observe that w[1,n+m] is a chain from u\nto t = w[n+m+1\u2212l,n+m] of length n + m \u2212 l < n (because l > m). Thanks to the induction\nhypothesis we know that t[m+1,l] has a presentation in K. It is v = w[n+1,n+l] and so\nv[1,m] = w[n+1,n+m] = t[l\u2212m+1,l] has a presentation in K (here we use that l \u2212 m + 1 > m + 1).\nDenote v[1,m] by z. Because |z| = m and z has a presentation in K then z must not have a\npresentation in L. But then all presentations of z must end in some vertex of K: Any walk\nin G which enters the terminal subgraph K is not be able to leave K. (Had z a presentation\nbeginning and ending in L then the whole presentation would lie in L.)\nBecause it is v = zv[m+1,l] we see that any presentation of v must enter K after at most m\nedges. Taking any presentation of v in G then gives us a presentation of v[m+1,l] in K.\n\nNow comes the core theorem of this section that uses all the above results to describe the\nrelation C.\nTheorem 14. Let \u03a3 be a sofic subshift, G a labelled graph, \u03a3 = \u03a3(G). Let x, y \u2208 \u03a3. Then\n(x, y) \u2208 C iff \u03c9(x) \u2264 \u03b1(y) or y = \u03c3 n (x) for some n > 0.\nProof. Obviously, if y = \u03c3 n (x) for n > 0 then (x, y) \u2208 C. Assume now that \u03c9(x) \u2264 \u03b1(y). Using\nProposition 3, it suffices to prove that there exists a chain from w = x[\u2212l,l] to w\u2032 = y[\u2212l,l] for any\nl \u2208 N.\nLet u be the ending vertex of some presentation of w and u\u2032 be the starting vertex of some\npresentation of w\u2032 . As \u03c9(x) \u2264 \u03b1(y), there exists a generalised walk u = z0 , z1 , . . . , zn\u22121 , zn = u\u2032 in\nG. We want to take this walk and turn it into a chain. More precisely, we want to find a chain\nfrom w to some w\u2032\u2032 such that one presentation of w\u2032\u2032 ends in u\u2032 . As w\u2032\u2032 w\u2032 is a chain from w\u2032\u2032 to\nw\u2032 , by composing both chains we get a chain from w to w\u2032 of nonzero length (see Figure 7).\n8\n\n\fv\n\nu\n\nzn\u22121\na\n\nz\u2032\n\nw\n\nw\u2032\nw\u2032\u2032\n\nzn = u \u2032\n\nFigure 7: Turning a generalised walk to a chain.\ny[\u2212l,l]\nn\n\ny[\u2212l+n,l\u2212n] = \u03c3 n (x)[\u2212l+n,l\u2212n]\n\nx[\u2212l,l]\n\nFigure 8: Proving that \u03c1(\u03c3 n (x), y) < 2n\u2212l .\n\nTo produce the chain from w to w\u2032\u2032 , use mathematical induction on n:\n1. If n = 0 then the existence of the chain follows directly from Lemma 12.\n2. Let the theorem hold for n \u2212 1. An edge (labelled by some letter a) leads from zn\u22121 to a\nvertex z \u2032 \u2248 zn . Using the induction hypothesis, there exists a chain from w to some word v\nwhose presentation ends in zn\u22121 . But then we also have the chain va from v to v \u2032 = v[2,|v|] a.\nThe word v \u2032 has a presentation that ends in z \u2032 and, using Lemma 12 again, we get that there\nexists a chain from v \u2032 to some w\u2032\u2032 whose presentation ends in zn = u\u2032 .\nIn the other direction, let (x, y) \u2208 C. Using Proposition 3 we get that for every l > 0 there\nexists a chain of nonzero length from x[\u2212l,l] to y[\u2212l,l] . Denote by nl the minimum (nonzero) length\nof such a chain. Since a chain for l can be easily obtained from a chain for k > l by forgetting the\nprefix and suffix, {nl }\u221e\nl=1 is a nondecreasing sequence. We shall distinguish two cases:\n1. Let the sequence be bounded and let n = max{nl |l \u2208 N}. We claim that then y = \u03c3 n (x).\nIndeed, for all but finitely many values of l we have nl = n and if a chain of length n leads\nfrom x[\u2212l,l] to y[\u2212l,l] then \u03c1(\u03c3 n (x), y) < 2n\u2212l (see Figure 8). Thus \u03c1(\u03c3 n (x), y) = 0 and\ny = \u03c3 n (x).\n2. Let the sequence be unbounded. We want to prove that then \u03b1(y) \u2265 \u03c9(x).\nLet p be a presentation of x in G and let h be an index such that the walk p[h,\u221e] belongs to\nonly one component M of G. Without loss of generality assume that h > 0.\nTake an arbitrary l > 0. As the sequence {nk }\u221e\nk=1 is not bounded, there exists k \u2265 h+2l such\nthat nk > l + h. The chain from x[\u2212k,k] to y[\u2212k,k] contains as a factor the chain from x[h,h+2l]\nto y[\u2212l,l] . Here we use that k \u2265 h + 2l to ensure that x[h,h+2l] \u2291 x[\u2212k,k] and nk > l + h to\nensure that the length of the chain is positive. See Figure 9.\nFor l sufficiently large, we can use Lemma 13 with u = x[h,h+2l] , v = y[\u2212l,l] and H equal\nto the minimal terminal subgraph of G/\u2248 containing \u03c9(x), obtaining that y[m\u2212l,l] has a\npresentation in the graph K = \u03c0 \u22121 (H). Because m is a constant and \u03a3(K) is compact we\nget that the whole word y belongs to \u03a3(K).\n\n9\n\n\f\u2212k\n\nx[\u2212k,k]\n\ny[\u2212k,k]\n\nk\nnk\n\nx[h,h+2l]\n\nnk \u2212 h \u2212 l\n\ny[\u2212l,l]\n\nFigure 9: The chain from x[\u2212k,k] to y[\u2212k,k] and the chain from x[h,h+2l] to y[\u2212l,l] .\n\nNow it remains to observe that the graph \u03c0(K) = H is precisely the graph of all vertices\nreachable from \u03c9(x). That means that \u03b1(y) \u2265 \u03c9(x) as one presentation of y begins in K.\n\nCorollary 15. Let L = L(G) be a central regular language, G an essential labelled graph. Then,\nL is chain-transitive iff G/\u2248 is connected.\nProof. Using Theorem 14, we see that if G/\u2248 is connected then L must be chain-transitive.\nIn the other direction, assume by contradiction that K is a terminal component of G/\u2248 , L is\nan initial component of G/\u2248 and K 6= L. The preimages \u03c0 \u22121 (K) resp. \u03c0 \u22121 (L) must contain at\nleast one terminal resp. initial component of G. As G is essential, there must exist x \u2208 \u03a3(\u03c0 \u22121 (K))\nand y \u2208 \u03a3(\u03c0 \u22121 (L)). Were y = \u03c3 n (x) we would get a contradiction with Remark 3 and so, using\nTheorem 14, we get K \u2264 L, a contradiction. Thus K = L and G is connected.\n\n4\n\nChain-Mixing Sofic Subshifts\n\nWe have seen that (for G essential) we can translate the question of chain-transitivity to a question\nabout the structure of G/\u2248 . In this section we characterise the chain-mixing property using the\nstructure of G/\u2248 .\nTheorem 16. Let L = L(G) be a central regular language, G essential. Then, L is the language\nof a chain-mixing subshift iff G/\u2248 is connected and aperiodic.\nProof. First let us prove the necessity of the conditions. Let L be chain-mixing. Then L is also\nchain-transitive and, as follows from Corollary 15, G/\u2248 must be connected.\nLet us now assume that G/\u2248 is periodic with a period n > 1. Let w \u2208 L(G) be a word that\nis long enough to satisfy the conditions of Corollary 10. We claim that then all ending vertices\nof all presentations of w must be projected to the same partition Vi of G/\u2248 . Let v1 v2 . . . v|w|\n\u2032\nand v1\u2032 v2\u2032 . . . v|w|\nbe two walks presenting w. Then Corollary 10 tells us that there exists r such\n\u2032\n\u2032\nthat vr \u2248 vr . But then \u03c0(vr ) = \u03c0(vr\u2032 ) \u2208 Vj for some j and thus \u03c0(vr+1 ), \u03c0(vr+1\n) \u2208 Vj+1 and\n\u2032\n\u2032\n\u03c0(vr+2 ), \u03c0(vr+2 ) \u2208 Vj+2 and so on, ending with \u03c0(v|w| ), \u03c0(v|w| ) \u2208 V(j+|w|\u2212r) mod n .\nTake some w such that |w| = l + 1 where l is the constant from Corollary 10. Let z be a\nchain from w to w of length m. We claim that then n|m. This will be a contradiction to the\nchain-mixing property (via Corollary 4). Without loss of generality, let V0 contain all the end\nvertices of all presentations of w. Then z[i,i+l] and z[i+1,i+l+1] share a factor of length l and so,\ndue to the above remark, if presentations of z[i,i+l] all end in Vi then presentations of z[i+1,i+l+1]\nall end in V(i+1) mod n . But then Vm mod n = V0 and so n|m.\nIn the opposite direction, assume we have a labelled graph G such that G/\u2248 is connected and\naperiodic and L = L(G). We want to show that L is chain-mixing. We begin by showing that for\nany word w there exists a k such that we can find chains of any length n > k from w to w.\nTake the least common divisor d of the lengths of all chains from w to w. Notice that all closed\nwalks in G must have lengths divisible by d, otherwise we could easily produce chains from w to\nw of lengths not divisible by d (L is chain-transitive).\n10\n\n\fAssume that d > 1. Let v be the ending vertex of one presentation of w. As G/\u2248 is aperiodic\nand connected, there exists a generalised walk in G of some length l not divisible by d from v back\nto v. Using the same algorithm as in the first part of proof of Theorem 14, we obtain a chain from\nw to w. Each closed walk in G has length divisible by d and in the proof of Theorem 14, we have\nproduced the chain from the generalised walk by adding only words presented by closed walks.\nThis means that the length of our chain gives the same remainder when divided by d as the length\nl of the corresponding generalised walk. Thus we get a chain from w to w of length not divisible\nby d, a contradiction.\nIf d = 1 then there must exist chains from w to w of lengths l1 , l2 , . . . , lp such that the least\ncommon divisor of l1 , . . . , lp is 1.\nLemma 17. Let {l1 , . . . lp } be a set of positive integers whose greatest common divisor is 1. Then\nthere exists k such that every n > k can be written as n = r1 l1 + r2 l2 + * * * + rp lp where ri are\npositive integers or zeroes.\nProof. First notice that for some integers si it is 1 = s1 l1 + s2 l2 + * * * + sp lp because Z is a principal\nideal domain. Set m = |s1 |l1 + |s2 |l2 + * * * + |sp |lp .\nLet k = ml1 . If now n = q * l1 + t where t \u2208 {0, 1, 2, . . . , l1 \u2212 1} and q \u2265 m then it is\nn\n\n=\n\nn\n\n=\n\n(q \u2212 m)l1 + ml1 + t(s1 l1 + s2 l2 + * * * + sp lp )\np\nX\n(tsi + |si |l1 )li\n(q \u2212 m)l1 +\ni=1\n\nLetting\nPp r1 = q \u2212 m + ts1 + l1 |s1 | and ri = tsi + li |si | for i = 2, 3, . . . , p we obtain ri \u2265 0 such that\nn = i=1 ri li .\nUsing Lemma 17, we see that for any n > k we can compose the chains from w to w to obtain\na chain of length n.\nHaving found chains from w to w of any length n > k we want to find chains from w to some\narbitrary z. As L is chain-transitive, there exists a chain from w to z of length k \u2032 . By composing\nthis chain with a suitable chain from w to w of length n > k we can obtain a chain from w to z of\nany length n\u2032 = n + k \u2032 > k + k \u2032 . As we can do this (with different k, k \u2032 ) for all w, z, the language\nL must be chain-mixing.\n\n5\n\nAttractors of Sofic Subshifts\n\nIn this section we use the linking graph to characterise all the attractors of the dynamical system\n(\u03a3, \u03c3) when \u03a3 is a sofic subshift. There are several slightly different definitions of attractor. We\nshall use the following one (from [4]):\nDefinition 18. Denote by d(x, Y ) the distance of the point x \u2208 X from the set Y \u2282 X in X.\nAn attractor Y of a dynamical system (X, F ) is a nonempty closed subset of X that satisfies the\nfollowing:\n1. F (Y ) = Y\n2. \u2200\u03b5 > 0, \u2203\u03b4 > 0, \u2200x \u2208 X, d(x, Y ) < \u03b4 \u21d2 \u2200n > 0, d(F n (x), Y ) < \u03b5\n3. \u2203\u03b4 > 0, \u2200x \u2208 X, d(x, Y ) < \u03b4 \u21d2 lim d(F n (x), Y ) = 0.\nn\u2192\u221e\n\nThere are several theorems that show the correspondence between attractors and the chain\nrelation. We use the following theorem.\nTheorem 19. [4, p. 82] Let \u03a9 be an attractor. Then \u03a9 is chain-invariant, i.e. \u2200z \u2208 \u03a9, (z, y) \u2208\nC \u21d2 y \u2208 \u03a9.\n11\n\n\fTheorem 20. Let G be an essential labelled graph. Let H be a nonempty terminal subgraph of\nG/\u2248 . Then the set \u03a9 = \u03a3(\u03c0 \u22121 (H)) is an attractor of (\u03a3(G), \u03c3). Moreover, all attractors of\n(\u03a3(G), \u03c3) are of this type.\nProof. We shall first prove that \u03a9 is indeed an attractor. Obviously, it is a subshift and so it is\nshift-invariant and closed. As \u03c0 \u22121 (H) is nonempty and essential, \u03a9 is also nonempty.\nBecause H is a terminal subgraph of G/\u2248 , we can utilise Remark 3 and obtain m such that if\n|v| \u2265 m then v may not lie both in the language of \u03c0 \u22121 (H) and the language of G \\ \u03c0 \u22121 (H).\nWithout loss of generality, let \u03b5 = 2\u2212k , k \u2265 0. Let \u03b4 = 2\u2212m\u2212k . If d(x, \u03a9) < \u03b4 then x[\u2212m\u2212k,\u2212k\u22121]\ndoes not belong to the language of G \\ \u03c0 \u22121 (H). Thus all presentations of x[\u2212m\u2212k,\u2212k\u22121] end in\na vertex of \u03c0 \u22121 (H) and x[\u2212k,\u221e) has a presentation in \u03c0 \u22121 (H). Then \u03c3 n (x)[\u2212k,k] = x[\u2212k+n,k+n]\nbelongs to the language L(\u03c0 \u22121 (H)) and so d(\u03c3 n (x), \u03a9) < \u03b5 for all n > 0.\nSimilarly, letting \u03b4 = 2\u2212m yields that if d(x, \u03a9) < \u03b4 then \u03c3 n (x)[\u2212n,n] = x[0,2n] belongs to\nL(\u03c0 \u22121 (H)) and so d(\u03c3 n (x), \u03a9) < 2\u2212n for all n. As n tends to infinity then d(\u03c3 n (x), \u03a9) tends to\nzero, concluding the proof that \u03a9 is an attractor.\nLet now \u03a9 be an attractor of the subshift system. Let x \u2208 \u03a9 and take a presentation p of x\nin G. Let K be the component of G where p starts. Let H be the terminal subgraph of G/\u2248\ngenerated by \u03c0(K) (subgraph induced by all vertices that can be reached from \u03c0(K)). We claim\nthat \u03a3(\u03c0 \u22121 (H)) \u2286 \u03a9.\nTo prove this claim, we just have to prove that there exists z \u2208 \u03a3(K) \u2229 \u03a9 and use Theorem\n14 and the chain-invariance of attractors (Theorem 19). Then \u03a3(\u03c0 \u22121 (H)) is precisely the set of\nwords of \u03a3 that z is in the chain relation with and so \u03a3(\u03c0 \u22121 (H)) \u2286 \u03a9.\nAs AZ is a compact space and \u03a9 is a closed subspace of AZ , \u03a9 is a compact set. Thus any\nsequence in \u03a9 has an accumulation point. Because \u03a9 is \u03c3-invariant it contains all the words\nxn = \u03c3 \u2212n (x), n \u2208 N. This sequence has an accumulation point z \u2208 \u03a9. For any m > 0 there exists\nk > 0 such that x(\u2212\u221e,\u2212k+m] has a presentation in K and z[\u2212m,m] = x[\u2212k\u2212m,\u2212k+m] , thus z[\u2212m,m]\nhas a presentation in K for any m. This means that z \u2208 \u03a3(K). But then \u03a9 is a union of subshifts\nof the form \u03a3(\u03c0 \u22121 (Hx )) where Hx are terminal subgraphs of G/\u2248 and x \u2208 \u03a9. While it is not in\ngeneral true that \u03a3(G) \u222a \u03a3(H) = \u03a3(G \u222a H), in this special case we can use to our advantage the\nfact that allSHx are terminal and so all walks in H are contained in at least one Hx . Thus by\ntaking H = Hx we get \u03a9 = \u03a3(\u03c0 \u22121 (H)) where H is a terminal subgraph of G/\u2248 .\n\n6\n\nAlgorithmic checking of properties\n\nIn this section we describe the algorithms that, given an essential labelled graph G, construct the\ngraph G/\u2248 and check whether \u03a3(G) is chain-transitive or chain-mixing. As there is presently little\nneed for practical implementations of such algorithms, we provide only very broad descriptions.\nThe construction of G/\u2248 The proposed algorithm is quite straightforward: It first finds all\npairs of linked vertices and then joins such pairs of vertices together. We shall use the double\ndepth-first search algorithm from [1, p. 489] that finds all components of a given graph in time\nO(|V | + |E|).\nDefinition 21. Given two labelled graphs G, H we can construct their label product G \u2217 H: a\ngraph with the vertex set V (G) \u00d7 V (H) and edge set {(e, f ) : e \u2208 E(G), f \u2208 E(H), l(e) = l(f )}.\nThat is, an edge leads from (u, v) to (u\u2032 , v \u2032 ) iff the edges from u to u\u2032 and from v to v \u2032 exist and\nhave the same labels.\nAlgorithm 6.1. Given G construct G/\u2248 .\n1. Find all components C1 , . . . , Ck of G.\n2. Construct the label products Ci \u2217 Cj of all pairs of components.\n\n12\n\n\f3. For each i \u2264 j find all components of Ci \u2217 Cj that contain an oriented cycle. Paint these\ncomponents red. Let Gij be the subgraph of Ci \u2217 Cj induced by the set of vertices\nV (Gij ) = {v \u2208 V (Ci \u2217 Cj )|there exists a walk from v to some red component}.\n4. It is u \u223c v iff (u, v) \u2208 V (Gij ) for a suitable i, j.\n5. Join together all pairs of linked vertices in G to obtain G/\u2248 .\nTo prove the correctness of the algorithm, it suffices to show that (u, v) \u2208 V (Gij ) iff u \u223c v for\nu \u2208 V (Ci ), v \u2208 V (Cj ).\nProof. If u \u223c v then there exists a word w of length n = |V (G)|2 + 1 with a presentation e1 . . . en in\nCi starting in u and a presentation e\u20321 . . . e\u2032n in Cj starting in v. Then (e1 , e\u20321 )(e2 , e\u20322 ) . . . (en , e\u2032n ) is a\nwalk in Ci \u2217 Cj . Because Ci \u2217 Cj has at most |V (G)|2 vertices, this walk must return to an already\nvisited vertex at least once and that is only possible in a red component. Thus (u, v) \u2208 V (Gij ).\nOn the other hand, if (u, v) \u2208 V (Gij ) then we can find arbitrarily long walks that start at\n(u, v). Let (e1 , e\u20321 ) . . . (en , e\u2032n ) be such a walk of length n. Then it is l(ei ) = l(e\u2032i ) for all i and so\ne1 . . . en and e\u20321 . . . e\u2032n are two presentations of the same word starting in u and v. We can do this\nfor any n and so u \u223c v.\nChecking for chain transitivity\ncheck whether G/\u2248 is connected.\n\nUsing the algorithm from [1, p. 489] again we can easily\n\nChecking the chain-mixing property We need to check that G/\u2248 is connected and find the\nperiod of G/\u2248 . This can be done in linear time using breadth-first search as described in [3].\nAttractors It suffices to write down all nonempty terminal subgraphs of G/\u2248 . Since the number\nof such subgraphs may in general be exponential in the number of components of G/\u2248 , there can\nbe no fast algorithm. A backtracking algorithm can be used here.\nComplexity of the algorithms The first three algorithms run in polynomial time. The creation\nof G/\u2248 demands the most time while the checks of connectivity and aperiodicity both run in time\nO(|V | + |E|).\nUnfortunately, the number of terminal subgraphs may be exponential to the size of the input\ngraph so outputting all the attractors of the shift dynamic system is in general not very practical\nfor graphs with many components.\n\n7\n\nConclusions\n\nIn this paper, we have introduced and used the notion of linking graph to better understand sofic\nsubshifts of AZ . It turns out that we can characterise the relation C and all attractors of \u03a3 using\nthe properties of G/\u2248 .\nWe have proposed straightforward algorithms to decide in polynomial time (to the size of graph\nG describing \u03a3) whether a sofic subshift \u03a3 is chain-mixing or chain-transitive and an algorithm\nthat, given an essential graph G, lists (generally not in polynomial time) all the attractors of\n(\u03a3(G), \u03c3).\nIt is interesting that while chain-transitivity can be decided in polynomial time, deciding transitivity is co-NP hard, as was recently shown in [6]. The cause of this contrast seems to be that\nwhen deciding transitivity, we have (explicitely or implicitely) to decide wheteher for H, H \u2032 graphs\nit is \u03a3(H) \u2286 \u03a3(H \u2032 ), a hard question, while deciding chain-transitivity requies mereley that we\ndecide if \u03a3(H) \u2229 \u03a3(H \u2032 ) 6= \u2205, an easy question.\nLinking graphs have proven useful in describing the properties of \u03a3 that depend mainly on C.\nOther properties of linking graphs might be a nice subject for further research.\n13\n\n\fReferences\n[1] H. T[homas] Cormen, E. C[harles] Leiserson, and L. R[onald] Rivest. Introduction to Algorithms. The MIT Press, Cambridge, 1999.\n[2] E[nrico] Formenti and P[etr] K\u016frka. Subshift attractors of cellular automata. Nonlinearity,\n20(1):105\u2013117, 2007.\n[3] J. P. Jarvis and D. R. Shier. Applied Mathematical Modeling: A Multidisciplinary Approach,\nchapter Graph Theoretic Analysis of Finite Markov Chains. CRC Press, Boca Raton, 1999.\n[4] P[etr] K\u016frka. Topological and symbolic dynamics. Soci\u00e9t\u00e9 Math\u00e9matique de France, Paris,\n2003.\n[5] D. Lind and B. Marcus. An Introduction to Symbolic Dynamics and Coding. Cambridge\nUniversity Press, Cambridge, 1995.\n[6] Piotr Oprocha. Algorithmic approach to devaney chaos in shift spaces. Fundamenta Informaticae.\n\n14\n\n\f"}