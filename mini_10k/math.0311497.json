{"id": "http://arxiv.org/abs/math/0311497v1", "guidislink": true, "updated": "2003-11-27T04:50:37Z", "updated_parsed": [2003, 11, 27, 4, 50, 37, 3, 331, 0], "published": "2003-11-27T04:50:37Z", "published_parsed": [2003, 11, 27, 4, 50, 37, 3, 331, 0], "title": "Galois representations attached to Q-curves and the generalized Fermat\n  equation A^4 + B^2 = C^p", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0311381%2Cmath%2F0311458%2Cmath%2F0311470%2Cmath%2F0311334%2Cmath%2F0311189%2Cmath%2F0311019%2Cmath%2F0311471%2Cmath%2F0311426%2Cmath%2F0311380%2Cmath%2F0311171%2Cmath%2F0311414%2Cmath%2F0311082%2Cmath%2F0311465%2Cmath%2F0311422%2Cmath%2F0311209%2Cmath%2F0311140%2Cmath%2F0311477%2Cmath%2F0311088%2Cmath%2F0311004%2Cmath%2F0311382%2Cmath%2F0311233%2Cmath%2F0311106%2Cmath%2F0311065%2Cmath%2F0311446%2Cmath%2F0311053%2Cmath%2F0311086%2Cmath%2F0311341%2Cmath%2F0311505%2Cmath%2F0311055%2Cmath%2F0311306%2Cmath%2F0311304%2Cmath%2F0311235%2Cmath%2F0311431%2Cmath%2F0311156%2Cmath%2F0311058%2Cmath%2F0311101%2Cmath%2F0311453%2Cmath%2F0311462%2Cmath%2F0311253%2Cmath%2F0311515%2Cmath%2F0311495%2Cmath%2F0311325%2Cmath%2F0311093%2Cmath%2F0311345%2Cmath%2F0311268%2Cmath%2F0311413%2Cmath%2F0311349%2Cmath%2F0311318%2Cmath%2F0311006%2Cmath%2F0311385%2Cmath%2F0311473%2Cmath%2F0311147%2Cmath%2F0311294%2Cmath%2F0311089%2Cmath%2F0311196%2Cmath%2F0311529%2Cmath%2F0311236%2Cmath%2F0311265%2Cmath%2F0311218%2Cmath%2F0311457%2Cmath%2F0311440%2Cmath%2F0311141%2Cmath%2F0311164%2Cmath%2F0311095%2Cmath%2F0311296%2Cmath%2F0311202%2Cmath%2F0311498%2Cmath%2F0311124%2Cmath%2F0311445%2Cmath%2F0311368%2Cmath%2F0311319%2Cmath%2F0311536%2Cmath%2F0311327%2Cmath%2F0311247%2Cmath%2F0311326%2Cmath%2F0311340%2Cmath%2F0311062%2Cmath%2F0311277%2Cmath%2F0311214%2Cmath%2F0311042%2Cmath%2F0311533%2Cmath%2F0311315%2Cmath%2F0311015%2Cmath%2F0311485%2Cmath%2F0311395%2Cmath%2F0311425%2Cmath%2F0311437%2Cmath%2F0311085%2Cmath%2F0311222%2Cmath%2F0311321%2Cmath%2F0311280%2Cmath%2F0311243%2Cmath%2F0311527%2Cmath%2F0311205%2Cmath%2F0311497%2Cmath%2F0311173%2Cmath%2F0311244%2Cmath%2F0311183%2Cmath%2F0311328%2Cmath%2F0311199%2Cmath%2F0311091&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Galois representations attached to Q-curves and the generalized Fermat\n  equation A^4 + B^2 = C^p"}, "summary": "We show that the mod p Galois representations attached to a Q-curve E of\ndegree d over an imaginary quadratic number field K are surjective for all p\nlarger than some constant M_{K,d}, if E has potentially multiplicative\nreduction at any prime not dividing 6. The proof uses Mazur's formal immersion\nmethod, a result of Darmon and Merel on non-split modular curves, and an\nanalytic argument showing that Jacobians of certain twisted modular curves\nadmit quotients with Mordell-Weil rank 0. In combination with a previous\ntheorem of the author and Skinner on modularity of Q-curves, the surjectivity\nresult allows one to show that the generalized Fermat equation A^4 + B^2 = C^p\nhas no nontrivial primitive solutions for p >= 211.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0311381%2Cmath%2F0311458%2Cmath%2F0311470%2Cmath%2F0311334%2Cmath%2F0311189%2Cmath%2F0311019%2Cmath%2F0311471%2Cmath%2F0311426%2Cmath%2F0311380%2Cmath%2F0311171%2Cmath%2F0311414%2Cmath%2F0311082%2Cmath%2F0311465%2Cmath%2F0311422%2Cmath%2F0311209%2Cmath%2F0311140%2Cmath%2F0311477%2Cmath%2F0311088%2Cmath%2F0311004%2Cmath%2F0311382%2Cmath%2F0311233%2Cmath%2F0311106%2Cmath%2F0311065%2Cmath%2F0311446%2Cmath%2F0311053%2Cmath%2F0311086%2Cmath%2F0311341%2Cmath%2F0311505%2Cmath%2F0311055%2Cmath%2F0311306%2Cmath%2F0311304%2Cmath%2F0311235%2Cmath%2F0311431%2Cmath%2F0311156%2Cmath%2F0311058%2Cmath%2F0311101%2Cmath%2F0311453%2Cmath%2F0311462%2Cmath%2F0311253%2Cmath%2F0311515%2Cmath%2F0311495%2Cmath%2F0311325%2Cmath%2F0311093%2Cmath%2F0311345%2Cmath%2F0311268%2Cmath%2F0311413%2Cmath%2F0311349%2Cmath%2F0311318%2Cmath%2F0311006%2Cmath%2F0311385%2Cmath%2F0311473%2Cmath%2F0311147%2Cmath%2F0311294%2Cmath%2F0311089%2Cmath%2F0311196%2Cmath%2F0311529%2Cmath%2F0311236%2Cmath%2F0311265%2Cmath%2F0311218%2Cmath%2F0311457%2Cmath%2F0311440%2Cmath%2F0311141%2Cmath%2F0311164%2Cmath%2F0311095%2Cmath%2F0311296%2Cmath%2F0311202%2Cmath%2F0311498%2Cmath%2F0311124%2Cmath%2F0311445%2Cmath%2F0311368%2Cmath%2F0311319%2Cmath%2F0311536%2Cmath%2F0311327%2Cmath%2F0311247%2Cmath%2F0311326%2Cmath%2F0311340%2Cmath%2F0311062%2Cmath%2F0311277%2Cmath%2F0311214%2Cmath%2F0311042%2Cmath%2F0311533%2Cmath%2F0311315%2Cmath%2F0311015%2Cmath%2F0311485%2Cmath%2F0311395%2Cmath%2F0311425%2Cmath%2F0311437%2Cmath%2F0311085%2Cmath%2F0311222%2Cmath%2F0311321%2Cmath%2F0311280%2Cmath%2F0311243%2Cmath%2F0311527%2Cmath%2F0311205%2Cmath%2F0311497%2Cmath%2F0311173%2Cmath%2F0311244%2Cmath%2F0311183%2Cmath%2F0311328%2Cmath%2F0311199%2Cmath%2F0311091&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We show that the mod p Galois representations attached to a Q-curve E of\ndegree d over an imaginary quadratic number field K are surjective for all p\nlarger than some constant M_{K,d}, if E has potentially multiplicative\nreduction at any prime not dividing 6. The proof uses Mazur's formal immersion\nmethod, a result of Darmon and Merel on non-split modular curves, and an\nanalytic argument showing that Jacobians of certain twisted modular curves\nadmit quotients with Mordell-Weil rank 0. In combination with a previous\ntheorem of the author and Skinner on modularity of Q-curves, the surjectivity\nresult allows one to show that the generalized Fermat equation A^4 + B^2 = C^p\nhas no nontrivial primitive solutions for p >= 211."}, "authors": ["Jordan S. Ellenberg"], "author_detail": {"name": "Jordan S. Ellenberg"}, "author": "Jordan S. Ellenberg", "arxiv_comment": "20pp. To appear, American Journal of Mathematics", "links": [{"href": "http://arxiv.org/abs/math/0311497v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0311497v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11G18; 11D41; 11G05; 11F67", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0311497v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0311497v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0311497v1 [math.NT] 27 Nov 2003\n\nGalois representations attached to Q-curves and the\ngeneralized Fermat equation A4 + B 2 = C p\nJordan S. Ellenberg \u2217\nPrinceton University\nellenber@math.princeton.edu\n22 Jul 2003\n\nAbstract\n4\n\n2\n\nWe prove that the equation A +B = C p has no solutions in coprime positive integers when\np \u2265 211. The main step is to show that, for all sufficiently large primes p, every Q-curve over\nan imaginary quadratic field K with a prime of bad reduction greater than 6 has a surjective\nmod p Galois representation. The bound on p depends on K and the degree of the isogeny\nbetween E and its Galois conjugate, but is independent of the choice of E. The proof of this\ntheorem combines geometric arguments due to Mazur, Momose, Darmon, and Merel with an\nanalytic estimate of the average special values of certain L-functions.\n\n1\n\nIntroduction\n\nThe resolution of the Fermat problem has demonstrated a close relationship between the solutions\nof Diophantine equations and the arithmetic of abelian varieties over number fields. It remains far\nfrom clear which Diophantine equations can be productively studied along the lines developed by\nFrey, Hellegouarch, Serre, Ribet, Wiles, and Taylor.\nIn particular, one wonders whether modular abelian varieties can address the classical problem\nof describing all solutions to the generalized Fermat equation\nAp + B q = C r\n\n(1.1)\n\nin coprime integers A, B, C. Darmon and Granville [10] have proved that (1.1) has only finitely\nmany solutions for any particular p, q, r satisfying 1/p + 1/q + 1/r < 1. It is conjectured that (1.1)\nhas only finitely many solutions, excepting 1p + 23 = 32 , even if p, q, r are allowed to vary (still\nsubject to 1/p + 1/q + 1/r < 1.)\nCertain special cases of (1.1) and similar equations have been treated by Darmon, Merel, and\nRibet([7],[11],[26]) using elliptic curves over Q, and by Bruin [4] using Chabauty methods. In\n[9], Darmon discusses the relationship between more general cases of (1.1) and as-yet-unproved\nconjectures about the Galois representations attached to Hilbert-Blumenthal abelian varieties over\nnumber fields.\nOur goal in the present paper is twofold. Our main motivation (or, as Darmon and Merel put it\nin [11], our \"excuse\") is to prove the following Diophantine theorem:\n\u2217 Partially\n\nsupported by NSA Young Investigator Grant MDA905-02-1-0097.\n\n1\n\n\fTheorem (Theorem 4.1). Suppose A, B, C are coprime integers such that\nA4 + B 2 = C p\n\n(1.2)\n\nand p \u2265 211. Then AB = 0.\nWe will attach an elliptic curve E to any solution to (1.2). However, E will be defined not over\nQ, but over Q[i], and it will be isogenous to its Galois conjugate. An elliptic curve, like E, whose\nisogeny class is defined over Q is called a Q-curve. (The idea of studying (1.2) by means of Q-curves\nwas arrived at independently by Darmon in [8].)\nIn order to prove Theorem 4.1, it is necessary to bring our knowledge of the arithmetic of Qcurves more in line with our knowledge about elliptic curves defined over Q. Our second goal in\nthis paper is to prove a theorem on surjectivity of mod p representations attached to Q-curves with\nnon-integral j-invariant. If K is a quadratic number field, a Q-curve E/K of degree d is an elliptic\ncurve over K which admits a cyclic isogeny of degree d to its Galois conjugate.\nTheorem (Theorem 3.14). Let K be an imaginary quadratic field and d a square-free positive\ninteger. There exists an effective constant MK,d such that, for all primes p > MK,d and all Q-curves\nE/K of degree d, either\n\u2022 the representation\n\nP\u03c1\u0304E,p : Gal(Q\u0304/Q) \u2192 PGL2 (Fp )\n\nis surjective, or\n\u2022 E has potentially good reduction at all primes not dividing 6.\nTheorem 3.14 plays the role that Mazur's theorem [23] does in the solution of Fermat's problem.\nIt is worth remarking that the analogue of Theorem 3.14 for elliptic curves over Q is still conjectural.\nWe also need a modularity theorem for Q-curves; we have proved the result we need in an earlier\npaper with C. Skinner [15].\nMuch of the proof of Theorem 3.14 follows along the lines of work of Mazur [23] and Momose [25]\nfor elliptic curves over Q. However, at a key point we must introduce an analytic argument on\naverage special values of L-functions; it is because of the analytic step that we can prove the main\ntheorem of the paper only for p \u2265 211. It should be emphasized that the remaining cases can be\nhandled by a finite, though at present unfeasible, computation. In particular, the methods of this\npaper yield the following fact (Proposition 4.7)\nTheorem. Let p > 13 be a prime. Suppose there exists either\n\u2022 a newform in S2 (\u03930 (2p2 )) with wp f = f and w2 f = \u2212f ; or\n\u2022 a newform in S2 (\u03930 (p2 )) with wp f = f ,\nsuch that L(f \u2297 \u03c7, 1) =\n6 0, where \u03c7 is the Dirichlet character of conductor 4. Then the equation\nA4 + B 2 = C p has no primitive non-trivial solutions.\nThe author is grateful to Henri Darmon and Emmanuel Kowalski for useful discussions about\nthe theorems proved here, and to the referee for thorough and helpful remarks.\n\n2\n\n\f2\n\nTwisted modular curves and their Jacobians\n\nA main theme of the present article is the analysis of certain twisted versions of modular curves.\nWe begin with the \"untwisted\" versions. Recall that, for any prime p, the curve X split (p) is a\ncoarse moduli space parametrizing pairs (E, {A, B}) where E is an elliptic curve and {A, B} is an\nunordered pair of distinct cyclic subgroups of E[p]. Similarly, X ns (p) parametrizes pairs (E, N )\nwhere N is a pair of Galois-conjugate points in PE[p] \u2297Fp Fp2 . We call such an N a non-split\nstructure on E. Note that X split (p) and X ns (p) are known to have smooth models over Z[1/p].\nDefinition 2.1. Let p be a prime and m a positive integer prime to p. We define\nX0s (m; p) = X0 (m) \u00d7X(1) X split (p)\nand\nX0ns (m; p) = X0 (m) \u00d7X(1) X ns (p).\nThe curves X0 (mp), X0s (m; p) and X0ns (m; p) have involutory automorphisms wm arising from\nthe Fricke involution wm on X0 (m). Let K be a quadratic field. For X = X0 (mp), X0s (m; p) or\nX0ns (m; p), let X K /Q be the twisted form of X admitting an isomorphism \u03c6 : X K /K \u2192 X/K\nsuch that \u03c6\u03c3 = wm \u25e6 \u03c6. Note that X K (Q) can be described as the subset of P \u2208 X(K) such that\nP \u03c3 = wm P , for \u03c3 a generator of Gal(K/Q).\nRecall that a Q-curve E/K is an elliptic curve which is isogenous to its Galois conjugate. If\nthere exists such an isogeny of degree d, we say E/K is a Q-curve of degree d.\nIn [15, Prop. 2.3] we define a projective mod p Galois representation\nP\u03c1\u0304E,p : Gal(Q\u0304/Q) \u2192 PGL2 (Fp )\nassociated to any Q-curve.\nWe will later show that under certain circumstances, P\u03c1\u0304E,p has large image. Our main tool is\nthe following proposition.\nProposition 2.2. Let d be a square-free positive integer, and let E/K be a Q-curve of degree d\nover a quadratic number field K. Let p be a prime not dividing d.\nSuppose the image of P\u03c1\u0304E,p lies in a Borel subgroup of PGL2 (Fp ) (resp. the normalizer of a split\nCartan subgroup, normalizer of a non-split Cartan subgroup.) Then the point of X0 (dp)(K) (resp.\nX0s (d; p)(K), X0ns (d; p)(K)) corresponding to E is a point of X0 (dp)K (Q) (resp. X0s (d; p)K (Q),\nX0ns (d; p)K (Q).\nProof. We will discuss the case of X0 (dp); the other two are similar. Let Cp be the cyclic subgroup of\nE[p]/K which is fixed by Gal(K\u0304/K). Let \u03bc : E \u03c3 \u2192 E be the degree d isogeny, and let Cd = \u03bc(E \u03c3 [d]).\nNow P\u03c1E,p (\u03c3) acts on PE[p] by sending x to \u03bc(x\u03c3 ). Since, by hypothesis, P\u03c1E,p (\u03c3) fixes Cp , we\nhave that Cp\u03c3 = \u03bc\u22121 Cp . So indeed\n(E, Cd , Cp )\u03c3 = (E/Cd , E[d]/Cd , \u03bc\u22121 Cp ) = wd (E, Cd , Cp ),\nwhich proves the desired result.\n\n3\n\nGood reduction for Q-curves with rational level structures\n\nIn this section we use arguments derived from Mazur's foundational paper [23] in order to show\nthat points on twisted modular curves of large level must have good reduction at all large primes.\n3\n\n\fProposition 3.1. Let R be a finite extension of Zl with fraction field L and maximal ideal \u03bb, and\nlet X/R be a stable curve. Write X smooth for the smooth part of X. Suppose A/R is a semi-abelian\nscheme with a morphism \u03c6 : X smooth \u2192 A. Let x and y be distinct sections in X smooth (R), such\nthat \u03c6(x) = 0. Write x\u03bb and y\u03bb for the restrictions of x and y to the closed fiber of Spec R.\nThen suppose\n\u2022 The absolute ramification index el of R is less than l \u2212 1;\n\u2022 \u03c6 is a formal immersion at x\u03bb .\n\u2022 The restriction of \u03c6(y) \u2212 \u03c6(x) to A(L) is of finite order.\nThen x\u03bb and y\u03bb are distinct points of X smooth (R/\u03bb).\nProof. The proposition is essentially Corollary 4.3 of [23]. For the reader's convenience, we recount\nthe argument here. Let q \u2208 A(R) be the point \u03c6(y) \u2212 \u03c6(x).\nFirst of all, suppose that the restriction to q to A(L) is a non-zero torsion point of order m.\nThen it follows from a theorem of Raynaud [23, Prop. 1.1] that the specialization of q to the closed\npoint of Spec R also has exact order m. In particular, q does not reduce to 0 mod \u03bb. Thus, y does\nnot reduce to x mod \u03bb.\nSo we may assume that \u03c6(y) = \u03c6(x). Suppose x\u03bb = y\u03bb . The section\nx : Spec R \u2192 X\nrestricts to a map from Spec R to the spectrum of the completed local ring \u00d4X,x\u03bb . So x yields a\nmap of rings\nx\u0303 : \u00d4X,x\u03bb \u2192 R.\nLikewise, y yields a map\n\u1ef9 : \u00d4X,y\u03bb = \u00d4X,x\u03bb \u2192 R.\nSince x 6= y, the two maps x\u0303 and \u1ef9 are distinct. Let 0\u03bb be the identity in A(R/\u03bb). Then the fact\nthat \u03c6 is a formal immersion along x means precisely that the map of completed local rings\n\u03c6\u0303 : \u00d4A,0\u03bb \u2192 \u00d4X,x\u03bb\nis a surjection. But this contradicts the fact that x\u0303 \u25e6 \u03c6\u0303 = \u1ef9 \u25e6 \u03c6\u0303.\nProposition 3.2. Let K be a quadratic field, and E/K be a Q-curve of squarefree degree d. Suppose\nP\u03c1\u0304E,p is reducible for some p = 11 or p > 13 with (p, d) = 1. Then E has potentially good reduction\nat all primes of K of characteristic greater than 3.\nProof. Let C/Q be the twisted modular curve X0 (dp)K , and take J = Jac(C). By Proposition 2.2,\nE corresponds to a point P \u2208 C(Q). We will think of P as lying in C(K) = X0 (dp)(K). Let \u03bb be a\nprime of K of characteristic greater than 3. We denote by \u221e the usual cusp of X0 (dp), and by \u221ep\nthe corresponding cusp of X0 (p).\nDefine a map g : X0 (dp) \u2192 J0 (p) by the rule\ng((E, Cd , Cp )) = [E, Cp ] + [E/Cd , Cp /Cd ] \u2212 2[\u221ep ].\nLet f be a Hecke eigenform in S2 (\u03930 (p)). The map \u03c0f \u25e6 g : X0 (dp) \u2192 Af extends by the N\u00e9ron\nmapping property to a map, also denoted \u03c0f \u25e6 g, from the smooth part of X 0 (dp)/Z to the N\u00e9ron\nmodel of Af , which we also denote Af .\n4\n\n\fLemma 3.3. The map \u03c0f \u25e6 g : X0smooth (dp)/Z[1/2] \u2192 Af /Z[1/2] is a formal immersion at the\npoint \u221e \u2208 X0smooth (dp)(F\u03bb ).\nProof. First of all, \u03c0f \u25e6 g induces an isomorphism of the residue fields attached to the points \u221e \u2208\nX0smooth (dp)(F\u03bb ) and 0 \u2208 Af (F\u03bb ), both of which are F\u03bb . So it suffices to show that the map\n(\u03c0f \u25e6 g)\u2217 : Cot0 (Af /F\u03bb ) \u2192 Cot\u221e (X0 )(dp)/F\u03bb\nis a surjection [17, 17.4.4].\nLet g1 : X0smooth (dp)/Z[1/2] \u2192 J0 (p)/Z[1/2] be the morphism sending the point (E, Cd , Cp ) to\nthe divisor [(E, Cp )]\u2212[\u221e]. Likewise, let gd be the morphism sending (E, Cd , Cp ) to [(E/Cd , Cp /Cd )]\u2212\n[\u221e]. Then g = g1 + gd . Now \u03c0f \u25e6 g1 factors as\np\n\nj\n\nX0 (dp) \u2192 X0 (p) \u2192 Af ,\nwhere p, the \"forgetting of d-structure\" morphism, is unramified at \u221e and j is a formal immersion\nat the point at infinity of X0 (p)(F\u03bb ) ([23, Prop 3.1].) It follows that the composition \u03c0f \u25e6 g1 is a\nformal immersion at \u221e, whence (\u03c0f \u25e6 g1 )\u2217 is a surjection on cotangent spaces. On the other hand,\n\u03c0f \u25e6 gd factors as\np\u25e6wd\n\nj\n\nX0 (dp) \u2192 X0 (p) \u2192 Af\n\nBut p \u25e6 wd is ramified at \u221e, so the image of the map (p \u25e6 wd )\u2217 in Cot\u221e (X0 )(dp)/F\u03bb is zero.\nTherefore, (\u03c0f \u25e6 gd)\u2217 is also the zero map on cotangent spaces. So (\u03c0f \u25e6 g)\u2217 = (\u03c0f \u25e6 g1 )\u2217 is surjective,\nas desired.\nBy the hypotheses on p, we can, and do, choose an eigenform f \u2208 S2 (\u03930 (p)) such that Af (Q) is\na finite group. For instance, we may choose f so that Af lies in the Eisenstein quotient of J0 (p).\nWe now want to derive a contradiction from 3.1.\nSuppose E has potentially multiplicative reduction at \u03bb. Applying an Atkin-Lehner involution\nif necessary, we may assume that P reduces to \u221e mod \u03bb.\nWe will now apply Proposition 3.1, where L = K\u03bb , X = X0 (dp), and A = Af . Take x to be\nthe section \u221e, and y to be the section given by P . It follows from the potentially multiplicative\nreduction of E that y is a section of X0 (dp)smooth /OK\u03bb .\nFinally, take \u03c6 to be the map \u03c0f \u25e6 g. Since L is a quadratic extension of Ql , and l > 3, we have\nel < l \u2212 1. By Lemma 3.3, \u03c6 is a formal immersion at x\u03bb = \u221e\u03bb .\nLet \u03c3 be the nontrivial element of Gal(K/Q); then\ng(P )\u03c3 = [p(P \u03c3 )] + [p(wd P \u03c3 )] \u2212 2[\u221ep ] = [p(wd P )] + [p(P )] \u2212 2[\u221ep ] = g(P ).\nIn particular, \u03c6(y) = \u03c0f (g(P )) lies in Af (Q), and therefore has finite order. Note also that \u03c6(x) =\n\u03c0f (g(\u221e)) = 0.\nWe can conclude that x\u03bb 6= y\u03bb , contradicting the hypothesis that P reduces to \u221e mod \u03bb.\nProposition 3.4. Let K be a quadratic field, and E/K be a Q-curve of squarefree degree d. Suppose\nthe image of P\u03c1\u0304E,p lies in the normalizer of a split Cartan subgroup of PGL2 (Fp ), for p = 11 or\np > 13 with (p, d) = 1. Then E has good reduction at all primes of K not dividing 6.\nProof. This case is very similar to that of Proposition 3.2. Here, the key lemma on formal immersions\nis due to Momose [25].\n\n5\n\n\fLet C be the twisted modular curve X0s (d; p)K . Then E yields a point\nP \u2208 C(Q) \u2282 C(K) = X0s (d; p)(K).\nTo be more precise, P \u2208 C(K) parametrizes the triple (E, Cd0 , {A0p , Bp0 }) where Cd0 is the kernel of\nthe isogeny between E and its Galois conjugate, and {A0p , Bp0 } is the chosen pair of cyclic subgroups\nfixed by the action of Gal(K\u0304/K).\nLet X0sc (d; p) be the modular curve parametrizing quadruples (E, Cd , Ap , Bp ) where Cd is a cyclic\nsubgroup of E of order d and Ap and Bp are linearly independent cyclic subgroups of E of order\np. Similarly, let X sc (p) be the curve parametrizing triples (E, Ap , Bp ). Note that X0sc (d; p) (resp.\nX sc (p)) is naturally a double cover of X0s (d; p) (resp. X split (p)). Write wp for the involution of\nX0sc (d; p) switching Ap and Bp . A cusp of X0sc (d; p) is determined by its image in X0 (d) and X sc (p).\nWe write (c, c\u2032 ) for the cusp of X0sc (d; p) whose image in X0 (d) is c and whose image in X sc (p) is c\u2032 .\nLet\nh : X0sc (d; p)/Q \u2192 J0 (p)/Q\nbe the map defined by\nh((E, Cd , Ap , Bp )) = [(E, Ap )]\u2212[(E/Bp , E[p]/Bp )]+[(E/Cd , Ap /Cd )]\u2212[(E/(Bp +Cd ), E[p]/(Bp +Cd ))].\nThen we have a diagram of schemes over Q\nX0sc (d; p) \u2212\u2212\u2212\u2212\u2192\n\uf8e6\n\uf8e6\nhy\nJ0 (p)\n\nX0s (d; p)\n\uf8e6\n\uf8e6\nh\u2212 y\n\n\u2212\u2212\u2212\u2212\u2192 (1 \u2212 wp )J0 (p)\n\nwhere h\u2212 is defined to make the above diagram commute.\nThe moduli problem over Spec Q coarsely represented by X0sc (d; p) can be extended to a moduli\nproblem over Spec Z as in [19]; this moduli problem is coarsely represented by a curve over Spec Z,\nwhich we also denote X0sc (d; p). (Note that X0sc (d; p) is isomorphic to X0 (dp2 ).) The curve X0sc (d; p)\nis smooth away from characteristics dividing dp. In characteristics dividing d, the reduction of\nX0sc (d; p) is smooth away from supersingular points, and in particular is smooth at all cusps. In\ncharacteristic p, the reduction of X0sc (d; p) is made up of three components, parametrizing triples\n(E, Cd , Ap , Bp ) where, respectively:\n\u2022 Ap \u223c\n= \u03bcp \u00e9tale-locally;\n\n\u2022 Bp \u223c\n= \u03bcp \u00e9tale-locally;\n\u2022 neither Ap nor Bp is \u00e9tale-locally isomorphic to \u03bcp .\nThe smooth part of the special fiber at p contains the ordinary locus in the first two components.\n(See [25, \u00a71] and [19, (13.5.6)] for facts used here about the special fiber.)\nBy the N\u00e9ron mapping property, h extends to a map from X0sc;smooth (d; p)/Z to the N\u00e9ron model\nof J0 (p).\nLet f be a Hecke eigenform in S2 (\u03930 (p)) such that wp f = \u2212f . Then we have a projection map\nfrom J0 (p)/Z to Af /Z.\nWe base change this map to Z[\u03b6p ][1/2] to obtain a map\n\u03c0f : J0 (p)/Z[\u03b6p ][1/2] \u2192 Af /Z[\u03b6p ][1/2].\n6\n\n\fLemma 3.5. Let \u03bb be a prime of Q(\u03b6p ) with residue field F\u03bb . The composition \u03c0f \u25e6 h is a formal\nimmersion at every cusp (\u221e, c\u2032 ) of X0sc;smooth (d; p)F\u03bb , for all \u03bb 6 | 2p. For all \u03bb 6 | 2, the composition\n\u03c0f \u25e6 h is a formal immersion at the cusp (\u221e, \u221e) of X0sc;smooth (d; p)F\u03bb .\nProof. We proceed much as we did in Lemma 3.3. First, note that the hypotheses on l guarantee\nthat (c, c\u2032 ) lies in the smooth locus of X0sc (d; p) as in [25, \u00a71].\nEach cusp of X0sc (d; p)F\u03bb is defined over F\u03bb ([25, proof of (2.5)]), and \u03c0f \u25e6 h is defined over F\u03bb\nby definition; it follows that for each cusp c, the residue field of c and the residue field of \u03c0f \u25e6 h(c)\nare both F\u03bb . So in order to prove the lemma, it suffices to show that the map\n(\u03c0f \u25e6 h)\u2217 : Cot0 (Af /F\u03bb ) \u2192 Cot(\u221e,c\u2032 ) X0sc (d; p)/F\u03bb\nis a surjection.\nWe now write h = h1 + hd , where\nh1 ((E, Cd , Ap , Bp )) = [(E, Ap )] \u2212 [(E/Bp , E[p]/Bp )]\nand hd = h1 \u25e6 wd . Now \u03c0f \u25e6 h1 factors as\n\u03c0f \u25e6g\n\na\n\nX0sc;smooth (d; p) \u2192 X sc;smooth (p) \u2192 Af .\nHere g is the morphism from X sc;smooth (p) to J0 (p) defined by Momose [25, \u00a72], and a is the\n\"forgetting of d-structure\" morphism. Again, a is unramified at (\u221e, c\u2032 ), and \u03c0f \u25e6 g is a formal\nimmersion at the cusp c\u2032 of X sc;smooth (p), by [25, (2.5)]. So (\u03c0f \u25e6 h1 )\u2217 is a surjection on cotangent\nspaces.\nOn the other hand, wd \u25e6 a is ramified at (\u221e, c\u2032 ), so (\u03c0f \u25e6 hd )\u2217 is the zero map on cotangent\nspaces. So (\u03c0f \u25e6 h)\u2217 is surjective, as desired.\nWe now make the further stipulation on f that Af (Q) is a finite group. (Again, we may choose\nf such that Af is a quotient of the Eisenstein quotient of J0 (p).) Let \u03c3 be the nontrivial element\nof Gal(K/Q). We have\n(E, Cd0 , {A0p , Bp0 })\u03c3 = (E/Cd0 , E[d]/Cd0 , {A0p /Cd0 , Bp0 /Cd0 }).\nIt follows immediately that h\u2212 (P \u03c3 ) = h\u2212 (P ). Let Q \u2208 X0sc (d; p)(Q\u0304) be a point lying over P . Then\nh(Q) = h\u2212 (P ) \u2208 [(1 \u2212 wp )J0 (p)](Q), so \u03c0f (h(Q)) lies in Af (Q), and is thus of finite order.\nLet M be the field of definition of Q. Let G be the group of automorphisms of X0sc (d; p) generated\nby wd and wp ; then G \u223c\n= (Z/2Z)2 and Q lies over a Q-point of X0sc (d; p)/G, whence M is a subfield\nof a biquadratic field over Q. Suppose \u03bb is a prime of M such that E has potentially multiplicative\nreduction at \u03bb. Write (c, c\u2032 ) \u2208 X0sc (d; p)(Q\u0304) for the cusp to which Q reduces mod \u03bb. Applying wd\nif necessary, we may assume that c = \u221e.\nIf \u03bb 6 | p, the map \u03c0f \u25e6 h is a formal immersion at (c, c\u2032 )\u03bb by Lemma 3.5. Suppose \u03bb|p. Since E\nhas potentially multiplicative reduction, it acquires semistable reduction after a quadratic extension\nM \u2032 of M ; since M is biquadratic, the absolute ramification index of M \u2032 at p is at most 4. If Q\nreduces to a cusp other than 0 and \u221e, the group schemes A0p and Bp0 are both \u00e9tale over OM \u2032 ([25,\nproof of (2.5)] whence, by Weil pairing, \u03bcp is \u00e9tale over OM \u2032 ; this makes the absolute ramification\nindex of M \u2032 over p at least p \u2212 1, a contradiction. If Q reduces to 0, we can act on Q by wp to make\nc\u2032 = \u221e. Now, by Lemma 3.5, the map \u03c0f \u25e6 h is a formal immersion at (c, c\u2032 )\u03bb .\nWe will now apply Proposition 3.1, using L = M\u03bb , X = X0sc (d; p), and A = Af . Take x to be\nthe cuspidal section (c, c\u2032 ), and y to be the section given by Q. Finally, take \u03c6 to be the map \u03c0f \u25e6 h.\n7\n\n\fSince M is a subfield of a biquadratic extension of Q, its ramification degree is at most 2 over any\nodd prime. So we have el < l \u2212 1. Now the conclusion of Proposition 3.1 contradicts the hypothesis\nthat Q and (c, c\u2032 ) reduce to the same point of X0sc (d; p)(M/\u03bb).\nWe now turn to the case of Q-curves E whose mod p Galois representations have image in the\nnormalizer of a non-split Cartan subgroup. This case is more difficult, due to the absence of rank\n0 quotients of J ns (p). However, we show below by analytic means that the Jacobian of the twisted\nmodular curve X0ns (d; p)K does have rank 0 quotients; we then obtain a good reduction theorem on\nE using a formal immersion result of Darmon and Merel [11].\nProposition 3.6. Let K be an imaginary quadratic field, and E/K be a Q-curve of squarefree\ndegree d. There exists a constant Md,K with the following property.\nSuppose the image of P\u03c1\u0304E,p lies in the normalizer of a non-split Cartan subgroup of PGL2 (Fp ),\nfor p > Md,K . Then E has potentially good reduction at all primes of K.\nRemark 3.7. All is not lost if K is a real quadratic field. We will see below that when K is imaginary,\nthere exists a newform f on level p2 satisfying the conditions of Proposition 3.9. When K is real,\nthere still may be newforms f on other levels satisfying those conditions. However, the methods\ndescribed here cannot treat the case of arbitrary K and d. For instance, suppose d is prime, and\nK is a real quadratic field in which d is inert. Then if f is either a newform in S2 (\u03930 (p2 )) with\nwp f = f , or a newform in S2 (\u03930 (dp2 )) with wp f = f and wd f = \u2212f , we have by a theorem of Weil\n[21, Th. 6] that f \u2297 \u03c7K has negative functional equation, so that L(f \u2297 \u03c7K , 1) = 0. This leaves us\nin much the same position as one who tries to use Mazur's method to control points on X ns (p); the\nJacobian of the curve in question, assuming Birch-Swinnerton-Dyer, has no rank 0 quotient.\nProof. Let C be the twisted modular curve X0ns (d; p)K , and write J = Jac(C). Then E yields a\npoint P \u2208 C(Q).\nWe have an isomorphism J \u00d7Q K \u223c\n= J0ns (d; p)/K; from a result of Chen and Edixhoven [6],[12]\nthere is a surjective homomorphism\n\u03b1 : J0ns (d; p) \u2192 J0\u2032 (dp2 )/wp .\nwhere J0\u2032 (dp2 ) is the p-new quotient of J0 (dp2 ).\nLet T be the algebra generated by Hecke operators of degrees prime to dp, together with the\ngroup W of Atkin-Lehner involutions of degrees dividing d. It follows from Theorem 2 of [12] that\nthe map \u03b1 is compatible with the action of T on either side (in that theorem, let C be the isogeny\ncategory of abelian varieties endowed with an action of T, and M the Jacobian of X0 (d)\u00d7X(1) X(p).)\nSuppose f is either\n\u2022 a newform in S2 (\u03930 (dp2 )) with wp f = f and wd f = \u2212f ;\n\u2022 a newform in S2 (\u03930 (d\u2032 p2 )) with d\u2032 a proper divisor of d and wp f = f .\nIn each case, we have a quotient morphism\n\u03c0f : J0 (dp2 ) \u2192 Af\nsuch that the action of wd on J0 (dp2 ) induces the involution \u22121 on Af . In case d is not prime, we can\nand do choose our \u03c0f such that the quotient Af is preserved by the whole group W of Atkin-Lehner\n\n8\n\n\finvolutions. More precisely: for each e|(d/d\u2032 ), we have a map Be : J0 (d\u2032 p2 ) \u2192 J0 (dp2 ). Choose a\ncharacter \u03c7 : (Z/(d/d\u2032 )Z)\u2217 \u2192 \u00b11. It follows from Lemma 26 of [3] that the quotient map\nX\neBe \u03c7(e) : J0 (d\u2032 p2 ) \u2192 J0 (dp2 )\nI\u03c7 :\ne|(d/d\u2032 )\n\nhas image stable under the action of W , and on which the action of wd on the quotient is wd\u2032 twisted\nby the scalar \u03c7(d). So if we choose \u03c7 such that \u03c7(d) and the eigenvalue of wd\u2032 on Af have opposite\nsigns, then the image under I\u03c7 of Af \u2282 J0 (d\u2032 p2 ) is a subvariety of J0 (dp2 ), isogenous to Af , which\nis stable under W and on which wd acts as \u22121. Now let \u03c0f be projection onto that subvariety.\nComposing with \u03b1 yields a morphism from J0ns (d; p) to Af ; replacing Af by an isogenous variety\n\u2032\nAf , we have a quotient\n\u03c0f\u2032 : J0ns (d; p) \u2192 A\u2032f\n\nwhich is compatible with the action of T and has connected kernel. In particular, \u03c0f\u2032 \u25e6 wd = \u2212\u03c0f\u2032 .\nDenote \u03c7K by \u03c7, and write Af \u2297 \u03c7 for the twist of Af by \u03c7. Let \u03c3 be the non-trivial element\nof Gal(K/Q). Then we have a commutative diagram of abelian varieties over K:\n\u03c0f\u2032\n\nJ0ns (d; p) \u2212\u2212\u2212\u2212\u2192\n\uf8e6\n\uf8e6\niy\nJ\n\nA\u2032f\n\uf8e6\n\uf8e6\njy\n\n\u2212\u2212\u2212\u2212\u2192 A\u2032f \u2297 \u03c7\n\nwhere i and j are isomorphisms such that i\u03c3 = wd \u25e6 i and j \u03c3 = \u2212j. Let\n\u03c8f : J \u2192 A\u2032f \u2297 \u03c7\nbe the composition j \u25e6 \u03c0f\u2032 \u25e6 i\u22121 . Then\n\u03c8f\u03c3 = j \u03c3 \u25e6 (\u03c0f\u2032 )\u03c3 \u25e6 (i\u22121 )\u03c3 = (\u2212j) \u25e6 \u03c0f\u2032 \u25e6 wd \u25e6 i\u22121 = (\u2212j) \u25e6 (\u2212\u03c0f\u2032 ) \u25e6 i\u22121 = \u03c8f .\nIn other words, \u03c8f is defined over Q.\nLet R0 be the ring of integers of the number field K(\u03b6p + \u03b6p\u22121 ), and let R = R0 [1/2dp]. Then\nns\nX0 (d; p) has a smooth model over R and the cusp \u221e of X0ns (d; p) is defined over R [11, \u00a75].\nWe can define a map\nh : X0ns (d; p)/R \u2192 J0ns (d; p)/R\nby setting h(P ) = [P ] \u2212 [\u221e].\nLemma 3.8. Let \u03bb be a prime of R. Then the map\n\u03c0f\u2032 \u25e6 h : X0ns (d; p)/R \u2192 A\u2032f /R\nis a formal immersion at the point \u221e\n \u0304 of X0ns (d; p)(F\u03bb ).\nProof. This fact is almost precisely Lemma 8.2 of [11].\nOne difference is that our quotient A\u2032f is not preserved by Tn for all n prime to p, but by Tn for\nprove that, as in [11], there exists a differential\nall n prime to dp and all wd\u2032 for d\u2032 |d. We need to P\nform \u03c9 on A\u2032f whose associated modular form g\u0303 = an (g\u0303)q n/p has a1 (g\u0303) 6= 0 (mod \u03bb). In fact, we\nwill prove this for any quotient A of J0ns (d; p) which is preserved by T and which is not killed by \u03b1.\n9\n\n\fWrite S(A) for the vector space of weight 2 cusp forms attached to A. Suppose that a1 (g\u0303) = 0\n(mod \u03bb) for every g\u0303 in S(A).\nChoose some g\u0303 in S(A) which is an eigenform for T, which is not in the kernel of \u03b1, and which\ndoes not reduce to 0 mod \u03bb. The form\nX\ng=\nan (g\u0303)q n\nis a form on \u03931 (dp2 ) which is also an eigenform for T. (We remark, however, that the Hecke\neigenform on \u03930 (dp2 ) associated to g\u0303 via the map \u03b1 does not necessarily have the same Hecke\neigenvalues as g.)\nLet g0 be a newform on some level dp2 /M with the same eigenvalues as g. Then we can write\nX\n\u03b1d\u2032 Bd\u2032 g0 .\ng=\nd\u2032 |M\n\nwhere Bd is the Hecke operator sending f (\u03c4 ) to f (d\u03c4 ). (In this and all other discussion of Hecke\noperators, we follow the notation of [3].)\nSuppose \u03b1e 6= 0 (mod \u03bb) for some e|M with (e, p) = 1. By [2, Prop. 1.5],\nX\nBd \u2032 h d \u2032\nwe g = c\u03b1e B1 g0 +\nd\u2032 |M,d\u2032 >1\n\nwhere c is a constant not divisible by \u03bb and the hd\u2032 are other modular forms. Since a1 (Bd\u2032 hd\u2032 ) = 0\nfor all d\u2032 > 1, we see that a1 (we g) 6= 0 (mod \u03bb), a contradiction. We conclude that \u03b1d\u2032 = 0 (mod \u03bb)\nunless p|d\u2032 ; so g is congruent (mod \u03bb) to a form in the image of Bp , which implies that an (g) = 0\n(mod \u03bb) unless p|n. This in turn implies that g\u0303 is fixed by the action not only of the normalizer of\nnonsplit Cartan in GL2 (Z/pZ), but of a Borel subgroup as well. So g\u0303 is a modular form on \u03930 (d)\nand is therefore killed by \u03b1, a contradiction.\nP\nP\nIf f has the Fourier expansion\nan q n , write f \u2297 \u03c7 for the modular form\n\u03c7(n)an q n . Then\nf \u2297 \u03c7 is a newform of some level N , and in particular there is an associated quotient Af \u2297\u03c7 of J0 (N ).\nMoreover, the abelian varieties A\u2032f \u2297 \u03c7 and Af \u2297\u03c7 are isogenous over Q.\nProposition 3.9. Suppose K is an imaginary quadratic field, and \u03c7 = \u03c7K is the associated Dirichlet\ncharacter. For all sufficiently large p, there exists a weight 2 cusp form f , which is either\n\u2022 a newform in S2 (\u03930 (dp2 )) with wp f = f and wd f = \u2212f ;\n\u2022 a newform in S2 (\u03930 (d\u2032 p2 )) with d\u2032 a proper divisor of d and wp f = f ,\nsuch that Af \u2297\u03c7 (Q) is a finite group.\nWe first explain how to finish the proof of Proposition 3.6 assuming the result of Proposition 3.9.\nSuppose E/K is a Q-curve of degree d, meeting the hypotheses of Proposition 3.6.\nFirst of all, suppose \u03bb is a prime of K dividing p. If the reduction of E at \u03bb is potentially\nmultiplicative, then the image of the decomposition group G\u03bb under P\u03c1\u0304E,p lies in a Borel subgroup.\nOn the other hand, by hypothesis this image lies in the normalizer of a non-split Cartan subgroup.\nWe conclude that the size of this image has order at most 2, which means that K\u03bb contains Q(\u03b6p +\n\u03b6p\u22121 ). This is impossible once p \u2265 7.\nNow suppose that E has potentially multiplicative reduction over a prime l not dividing p.\n\n10\n\n\fThe cusps of X0ns (d; p) have minimal field of definition Q(\u03b6p + \u03b6p\u22121 ) [11, \u00a75], and K is linearly\ndisjoint from Q(\u03b6p + \u03b6p\u22121 ); it follows that the cusps of X0ns (d; p) which lie over \u221e \u2208 X0 (d) form a\nsingle orbit under Gal(K\u0304/K). If \u03bb is a prime of K(\u03b6p +\u03b6p\u22121 ) over l, then the point P \u2208 X0ns (d; p)(K)\nparametrizing E reduces mod \u03bb to some cusp c. By applying Atkin-Lehner involutions at the primes\ndividing d, we can ensure that P reduces to a cusp which lies over \u221e in X0 (d). By the transitivity\nof the Galois action, we can choose \u03bb so that P actually reduces to the cusp \u221e mod \u03bb. Note that in\norder for a K-point of X0ns (d; p) to reduce to \u221e, the residue field OK /\u03bb must contain \u03b6p + \u03b6p\u22121 ; this\nimplies that l4 \u2261 1 mod p, and in particular l 6= 2, 3 when p \u2265 7. Moreover, if p is large enough,\nwe have (d, l) = 1.\nNow take f to be a form satisfying the conditions specified in Proposition 3.9. We have defined\nabove a map\nX0ns (d; p)K /R \u2192 A\u2032f \u2297 \u03c7,\n\nwhich is a formal immersion at \u221e\n \u0304 by Lemma 3.8. Apply Proposition 3.1 with X = X0ns (d; p)/R\u03bb , x =\n\u2032\n\u221e, y = P, and \u03c6 = \u03c0f \u25e6 h. We first apply the argument of [11, Lemma 8.3] to show that the point\n\u03c6(P ) is torsion in A\u2032f (L), where L = K(\u03b6p + \u03b6p\u22121 ). Let n be an integer which kills the subgroup of\nJ0ns (d; p) generated by cusps; such an n exists by the Drinfel'd-Manin theorem. Let \u03c3 be a generator\nfor Gal(L/K); then (\u03c3 \u2212 1)h(P ) is killed by n, so nh(P ) lies in J0ns (d; p)(K). Let \u03c4 be an element\nof Gal(L/Q) not lying in Gal(L/K). Then P \u03c4 = wd P , and\nn\u03c6(P )\u03c4 = n[P \u03c4 ] \u2212 n[\u221e\u03c4 ] = n[wd P ] \u2212 n[wd \u221e] = nwd \u03c6(P ) = \u2212n\u03c6(P ).\nSo n\u03c6(P ) lies in the subgroup of A\u2032f (K) on which \u03c4 acts as \u22121. By the hypothesis on f , this\nsubgroup is finite. We conclude that \u03c6(P ) is torsion.\nSince l > 3, the absolute ramification index of R\u03bb at l is at most 2. It now follows from\nProposition 3.1 that y and x reduce to distinct points of X, contradicting our hypothesis on E.\nIt now remains only to prove Proposition 3.9.\nWe say a form f is p-new if it is not in the space of old forms arising from S2 (\u03930 (dp)).\nBy a theorem of Kolyvagin and Logachev [20], building on results of Gross-Zagier, BumpFriedberg-Hofstein, and Murty-Murty, it suffices to show that there exists a weight 2 newform\nf on level p2 such that wp f = f and L(f \u2297 \u03c7, 1) 6= 0.\nOur method will be to show the stronger statement that the (suitably weighted) average value\nof the above L-function over a certain class of forms is nonzero.\nLet F be a Petersson-orthogonal basis for S2 (\u03930 (p2 )) such that each f \u2208 F is an eigenform for\nall Hecke operators Tl where l is prime to p, and for the Atkin-Lehner involution wp .\nWe define an average\nX\nV (p) =\na1 (f )L(f \u2297 \u03c7, 1).\nf \u2208F\n\nwp f =f\n\nFirst of all, note that if f is a form with wp f = \u2212f , then the functional equation of L(f \u2297 \u03c7, s)\nhas sign \u03c7(\u22121) = \u22121 by [21, Th. 6]. So in this case L(f \u2297 \u03c7, 1) = 0. It follows that\nX\nV (p) =\na1 (f )L(f \u2297 \u03c7, 1).\nf \u2208F\n\nWe may think of a Fourier coefficient an as a linear functional in Hom(S2 (\u03930 (p2 )), C). Likewise,\nwrite L\u03c7 for the functional sending f to L(f \u2297 \u03c7, 1). Now the Petersson inner product on S2 (\u03930 (p2 ))\ndefines an inner product on the dual space Hom(S2 (\u03930 (p2 )), C), and the average we are studying is\nV (p) = (a1 , L\u03c7 )\n11\n\n\fwith respect to this dual inner product.\nIn general, if l1 , l2 are linear functionals on the space of cuspforms for some \u03930 (N ), we write\n(l1 , l2 )N for the corresponding Petersson product. If V is a subspace of S2 (\u03930 (N )), we write (l1 , l2 )V\nfor the Petersson product restricted to V . Finally, if M |N , we write (l1 , l2 )M\nN for the contribution\nto (l1 , l2 )N of those forms which are new on level M .\nThe value of V (p) can be estimated using the Petersson formula, as in [13]. In particular, we\nwill show that, for p large enough, V (p) is nonzero, and thus that L(f \u2297 \u03c7, 1) is nonzero for some\nf in F .\nLemma 3.10. V (p) = 4\u03c0 + O(p\u22122+\u01eb ).\n\nProof. Immediate from the main theorem of [14]; to be precise, we have in general that\n(am , L\u03c7 )N = 4\u03c0\u03c7(m) + O(N \u22121+\u01eb )\n\n(3.3)\n\nwith constants depending only on m, \u03c7, and \u01eb.\nBut Lemma 3.10 is not enough for us, since we require that there be a p-new form f with\nL(f \u2297 \u03c7, 1) 6= 0. We must therefore show that the contribution of the p-old forms to V (p) is close\nto 0. We give below a general bound for the contribution of p-old forms to (am , L\u03c7 )p2 . This will\nrequire an argument somewhat more intricate, but no deeper, than the Petersson estimate for V (p).\nThe problem of bounding the contribution of oldforms is treated in [18], but only in case the level\nis square-free. We have recently learned that a paper of Akbary [1] also bounds the contribution of\noldforms in a similar situation.\nRemark 3.11. We expect that, for arbitrary fixed N , the contribution of p-old forms to (am , L\u03c7 )N p\nis o((am , L\u03c7 )N p ); proving this, when a high power of p divides N , seems rather complicated.\nThe space of p-old forms on \u03930 (p2 ) is orthogonal to the space of p-new forms. So we can\ndecompose the inner product (am , L\u03c7 ) as\n(am , L\u03c7 ) = (am , L\u03c7 )p\u2212new + (am , L\u03c7 )pp2\nWe will show that (am , L\u03c7 )pp2 approaches 0 as p grows.\nLemma 3.12. Let f be a weight 2 newform on \u03930 (p), let \u03bbp (f ) be the eigenvalue of Wp on f , and\nlet Vf be the space of forms on \u03930 (p2 ) arising from f . Let m be a positive integer prime to p. Then\n(am , L\u03c7 )Vf =\n\np\n[1 + p\u22121 \u03c7(p)\u03bbp (f )](f, f )\u22121 am (f )L\u03c7 (f ).\np2 \u2212 1\n\nProof. The space Vf is spanned by B1 f and pBp f .\nThen\n\u0014\n\u0002\n\u0003 \u22121\n(am , L\u03c7 )Vf = am (B1 f ) am (pBp f ) A\n\nL\u03c7 (B1 f )\npL\u03c7 (pBp f )\n\nwhere A is the symmetric matrix defined by Aij = (pi Bi f, pj Bj f ).\nIt follows from the definition of Petersson product that\nA11 = A22 = [\u03930 (p2 ) : \u03930 (p)](f, f ) = p(f, f ).\n\n12\n\n\u0015\n\n(3.4)\n\n\fWe will now show that\n(B1 f, pBp f ) = \u2212\u03bbp (f )(f, f ).\n\n(3.5)\n\nRecall that we can write the Petersson product of two forms f and g as\nC Ress=2 L(s, f \u00d7 g)\nwhere C is a constant independent of f and g, and L(s, f \u00d7 g) is the Rankin-Selberg L-function\ndefined by analytic continuation of the series\nL(s, f \u00d7 g) =\n\n\u221e\nX\n\nan (f )an (g)n\u2212s .\n\nn=1\n\n(see [5, \u00a71.6].)\nNow\nC \u22121 (B1 f, pBp f ) = p Ress=2\n= p Ress=2\n\n\u221e\nX\n\nn=1\n\u221e\nX\n\nan (f )an (Bp f )n\u2212s\napn (f )an (f )n\u2212s p\u2212s\n\nn=1\n\n= \u2212p\u22121 \u03bbp (f ) Ress=2\n= \u2212p\nWe now have\nA = (f, f )\n\n\u0014\n\n\u22121\n\n\u03bbp (f )C\n\n\u22121\n\n\u221e\nX\n\n[an (f )]2 n\u2212s\n\nn=1\n\n(B1 f, B1 f ).\n\np\n\u2212\u03bbp (f )\n\u2212\u03bbp (f )\np\n\n\u0015\n\n.\n\nNote that \u03bbp (f ) = \u00b11. So\n\u22121\n\nA\n\n\u22121\n\n= (f, f )\n\n2\n\n\u22121\n\n(p \u2212 1)\n\n\u0014\n\np\n\u03bbp (f )\n\u03bbp (f )\np\n\n\u0015\n\n.\n\nNote that (Bp f ) \u2297 \u03c7 = \u03c7(p)Bp (f \u2297 \u03c7). Moreover, if g is any modular form,\nZ \u221e\nZ \u221e\ng(ipy)dy = (1/p)L(g, 1).\nBp g(iy)dy =\nL(Bp g, 1) =\n0\n\n0\n\nWe conclude that L\u03c7 (pBp f ) = \u03c7(p)L\u03c7 (f ). So\n(am , L\u03c7 )Vf\n\n\u0014\n\n1\np\u22121 \u03bbp (f )\n\u22121\np \u03bbp (f )\n1\n\n=\n\np(p2 \u2212 1)\u22121 (f, f )\u22121\n\n=\n\np(p2 \u2212 1)\u22121 [1 + p\u22121 \u03c7(p)\u03bbp (f )](f, f )\u22121 am (f )L\u03c7 (f ).\n\n\u0002\n\nam (B1 f ) 0\n\n\u0003\n\n\u0015\u0014\n\nL\u03c7 (f )\n\u03c7(p)L\u03c7 (f )\n\n\u0015\n\nNow (am , L\u03c7 )pp2 is the sum over newforms f of level p of (am , L\u03c7 )Vf , which by Lemma 3.12 is\nequal to\np\np\n[1 + p\u22121 \u03c7(p)\u03bbp (f )](f, f )\u22121 am (f )L\u03c7 (f ) = 2\n[am (f ) \u2212 p\u22121 \u03c7(p)amp (f )]L\u03c7 (f )(f, f )\u22121 .\np2 \u2212 1\np \u22121\n13\n\n\fSumming the above quantity over a Petersson-orthogonal basis of newforms for \u03930 (p) yields\n(am , L\u03c7 )pp2 =\n\np\n(am \u2212 p\u22121 \u03c7(p)amp , L\u03c7 )p .\np2 \u2212 1\n\nNow (am , L\u03c7 )p is bounded as p grows by (3.3). So it suffices to show that (amp , L\u03c7 )p is o(p2 ). We\nwill prove a version of this fact with explicit constants, since these will be needed in the sequel.\nLemma 3.13. Let p be a prime, m a positive integer, \u03c7 a quadratic character of conductor q prime\nto p. Then\n\u221a\n\u221a\n(amp , L\u03c7 )p \u2264 2 3m1/2 d(m)(1 \u2212 e\u22122\u03c0/q p )\u22121 (4\u03c0 + 16\u03b6 2 (3/2)\u03c0 2 p\u22123/2 ).\nProof. Let Fp be a Petersson-orthogonal basis of weight 2 cuspforms on \u03930 (p). Suppose furthermore\nthat each f \u2208 Fp is a Hecke eigenform.\nFirst of all, note that |ap (f )| = |a1 (f )|, and |amp (f )| \u2264 m1/2 d(m)|a1 (f )| by Weil bounds. Now\nf \u2297 \u03c7 is a newform on level M = pq 2 . The functional equation for L(f \u2297 \u03c7, s) tells us that, for any\npositive real x,\nX\nX\nL(f \u2297 \u03c7, 1) =\n\u03c7(n)|an (f )|n\u22121 e\u22122\u03c0n/x +\n\u03c7(n)|an (wM (f \u2297 \u03c7))|n\u22121 e\u22122\u03c0nx/M .\nn>0\n\nn>0\n\n\u221a\nSince f \u2297 \u03c7 is a newform, we have |an (wM (f \u2297 \u03c7))| = |an (f )|. We now set x = M and obtain the\nbound\n\u221a\n\u221a\nX\nX\nn\u22121/2 d(n)e\u22122\u03c0n/ M )|a1 (f )|.\n|L(f \u2297 \u03c7, 1)| \u2264 2\nan (f )n\u22121 e\u22122\u03c0n/ M \u2264 2(\nn>0\n\nn>0\n\n\u221a\nThe sum over n is of length approximately M , and so has value of order at most M 1/4+\u01eb .\nWorking the constants\nout is slightly intricate, so we satisfy ourselves with a much cruder bound.\n\u221a\nSince d(n) \u2264 3n, we have\n\u221a\n\u221a\n|L(f \u2297 \u03c7, 1)| \u2264 2 3(1 \u2212 e\u22122\u03c0/ M )\u22121 |a1 (f )|,\n\nso\n|(am , L\u03c7 )| \u2264\n\u2264\n=\n\nX\n\nf \u2208F\n\nX\n\nf \u2208F\n\n|am (f )||L(f \u2297 \u03c7, 1)|\n\u221a\n\u221a\nm1/2 d(m)2 3(1 \u2212 e\u22122\u03c0/ M )\u22121 a1 (f )2\n\n\u221a\n\u221a\n2 3m1/2 d(m)(1 \u2212 e\u22122\u03c0/q p )\u22121 (a1 , a1 )p .\n\nNow by Lemma 4 of [14] we have\n|(a1 , a1 )p | \u2264 4\u03c0 + 16\u03b6 2 (3/2)\u03c0 2 p\u22123/2 .\nThis yields the desired result.\n\n14\n\n\fWe have now proved that (am , L\u03c7 )pp2 approaches 0 as p goes to \u221e. Therefore, (a1 , L\u03c7 )p\u2212new\napproaches V (p) as p grows; in particular,\n(a1 , L\u03c7 )p\u2212new 6= 0\nfor p sufficiently large. We have now proved Proposition 3.9, and therefore also Proposition 3.6.\nSuppose that K is a quadratic field, and E/K is a Q-curve of degree d. If P\u03c1\u0304E,p does not surject\nonto PGL2 (Fp ), then the image of P\u03c1\u0304E,p is contained in a maximal subgroup of PGL2 (Fp ); that\nis to say, the image is contained in either a Borel subgroup, the normalizer of a Cartan subgroup,\nor an exceptional subgroup isomorphic to A4 , S4 , or A5 . For any given K, there are only finitely\nmany p for which it is possible that P\u03c1\u0304E,p has image contained in an exceptional subgroup [22,\nIntroduction]. The following theorem now follows from Propositions 3.2,3.4, and 3.6.\nTheorem 3.14. Let K be an imaginary quadratic field and d a square-free positive integer. There\nexists an effective constant MK,d such that, for all primes p > MK,d and all Q-curves E/K of degree\nd, either\n\u2022 the representation\n\nP\u03c1\u0304E,p : Gal(Q\u0304/Q) \u2192 PGL2 (Fp )\n\nis surjective, or\n\u2022 E has potentially good reduction at all primes not dividing 6.\n\n4\n\nSolutions to A4 + B 2 = C p\n\nWe now use the results of the previous sections to study solutions to the generalized Fermat equation\nA4 + B 2 = C p\n\n(4.6)\n\nThe goal of this section is to prove the following theorem.\nTheorem 4.1. Suppose A, B, C are coprime integers such that\nA4 + B 2 = C p\nand p \u2265 211. Then AB = 0.\nSuppose (A, B, C) is a solution to (4.6) which is primitive (i.e., (A, B) = 1) and which is nontrivial (i.e., AB =\n6 0.) We associate to (A, B, C) a curve E = EA,B,C /Q[i] with the Weierstrass\nequation\nEA,B,C : y 2 = x3 + 2(1 + i)Ax2 + (B + iA2 )x,\n(4.7)\nwhich was first discussed by Darmon in [8] in connection with the equation A4 + B 4 = C p . We may\nthink of E as a \"generalized Frey-Hellegouarch curve\" whose relationship to (4.6) is analogous to\nthat between the usual Frey-Hellegouarch curve and Fermat's equation.\nNote that if (A, B, C) is a solution to (4.6), then so is (A, \u2212B, C). We therefore can and do\nassume that B \u2261 0, 2, 3 mod 4.\n\n15\n\n\fWrite \u03c3 for the non-trivial element of Gal(Q[i]/Q). The map\n1\n1\n\u03bc : (x, y) 7\u2192 ( i(y 2 /x2 ), \u2212 (1 \u2212 i)y(B + iA2 \u2212 x2 )/x2 ).\n2\n4\nis a degree 2 isogeny from E to its Galois conjugate E \u03c3 . Therefore, E/Q[i] is a Q-curve of degree 2.\nOne computes\nE4 (E, \u03c9) =\n\u2206(E, \u03c9) =\n\n80iA2 \u2212 48B\n\u221264i(A2 + iB)(A2 \u2212 iB)2 ,\n\nwhere \u03c9 is the Weierstrass differential dx/2y with respect to the Weierstrass equation (4.7). Because\n(A, B) = 1, we have that E/Q[i] is semistable away from 2, and has multiplicative reduction at an\nodd prime p of Q[i] precisely when p divides C.\nRemark 4.2. Suppose that A and B are chosen so that A4 + B 2 is a prime number l. Then E\nhas good reduction away from primes of Q[i] dividing 2 and l. Moreover, the restriction of scalars\nResQ[i]/Q E is an abelian surface over Q which has good reduction away from 2 and l. We know,\nby the theorem of Iwaniec and Friedlander [16], that there are infinitely many choices of A, B such\nthat A4 + B 2 is prime; it follows that there are infinitely many abelian surfaces over Q whose bad\nreduction is supported at 2 and a single odd prime. It is interesting that we know this fact for\nabelian surfaces, but not for elliptic curves over Q!\nWe now embark on an analysis of the Galois representation P\u03c1\u0304E,p . We will eventually show that,\nwhen p is large, this representation surjects onto PGL2 (Fp ).\nWe can define a lifting of P\u03c1\u0304E,p to an actual representation\u221aas follows. The abelian surface\n\u221a\nA = ResQ[i]/Q E is an abelian surface with real multiplication by 2. Let p|p be a prime of Z[ 2].\nWe define\n\u03c1\u0304E,p : Gal(Q\u0304/Q) \u2192 GL2 (F\u0304p )\nto be the mod p Galois representation attached to A. Note that P\u03c1\u0304E,p is, as the notation suggests, the\nprojectivization of \u03c1\u0304E,p , and that \u03c1\u0304E,p | Gal(Q\u0304/Q[i]) is precisely the Galois representation E[p](Q\u0304).\nWe want to show, first of all, that P\u03c1\u0304E,p is irreducible. We begin with an elementary lemma on\nsmall primes.\nLemma 4.3. There exists a prime l greater than 3 which divides C.\nProof. If A and B were both odd, then C p would be congruent to 2 mod 4, which is not possible.\nSo C is odd. Moreover, C cannot be divisible by 3, since A4 + B 2 = 0 has no nonzero solutions over\nF3 . Finally, C 6= 1, since (A, B, C) is a non-trivial solution to (4.6). We conclude that there exists\na prime l greater than 3 which divides C; it follows that E has multiplicative reduction at primes\nof Q[i] over l.\nLemma 4.4. \u03c1\u0304E,p is modular.\nProof. Since 3 does not divide C, the curve E has good reduction at 3, so P\u03c1\u0304E,p is unramified at 3.\nThe modularity of E now follows from [15, Th. 5.2].\nProposition 3.2 and Lemma 4.3 imply that \u03c1\u0304E,p is irreducible. Our next goal is to compute the\nSerre invariants N = N (\u03c1\u0304E,p ), k = k(\u03c1\u0304E,p ), and \u01eb = \u01eb(\u03c1\u0304E,p ). By Ribet's theorem and Lemma 4.4,\nwe now have\n\u03c1\u0304E,p \u223c\n= \u03c1\u0304f,p\n16\n\n\ffor some f in Sknew (N, \u01eb). Note that det \u03c1\u0304E,p is cyclotomic, which implies that \u01eb is trivial and k \u223c\n=2\nmod p \u2212 1.\nWe now use the fact that C p = A4 + B 2 is a pth power. This fact implies that every odd\nprime l dividing \u2206(E, \u03c9) satisfies p|ordl \u2206. By the theory of the Tate curve, this implies that\n\u03c1\u0304E,p | Gal(Q\u0304/Q[i]) is unramified away from 2 and p, and so \u03c1\u0304E,p is unramified away from 2 and p.\nSo N is a power of 2.\nThe fact that p|ordq \u2206 for any prime q|p of Z[i] means, again using the Tate curve, that E[p]/Q[i]\nextends to a finite flat group scheme G over the completion Z[i]q . Since Z[i]/Z is unramified at p,\nthis extension is unique. By the \u00e9taleness of Z[i]/Z at p, we can descend G \u2295 G to a a finite flat\ngroup scheme over Zp extending A[p]/Q. This means that \u03c1\u0304E,p is finite in the sense of [27, 2.8], and\nso k = 2 by [27, Prop. 4].\nIt remains to pin down N precisely, which we accomplish by means of Tate's algorithm.\nProposition 4.5. N = 32 if A is even and 256 if A is odd.\nProof. We begin by using Tate's algorithm to compute the local conductor f of the elliptic curve\nE/Q[i] at the prime \u03c0 = 1 + i. Recall that f is the multiplicity of the ideal \u03c0 in the conductor of\nE. We refer to [28, IV. \u00a79] for all facts about Tate's algorithm.\nFirst of all, we will translate x by 1, which gives us a new Weierstrass equation\ny 2 = x3 + (3 + 2(1 + i)A)x2 + (3 + 4(1 + i)A + B + iA2 )x + 2(1 + i)A + 1 + B + iA2 .\nWith respect to this equation, b2 = (8 + 8i)A + 12. If A is odd and B even, then \u03c0 2 does not divide\na6 , so E has reduction type II and f = ord\u03c0 (\u2206) = 12. (See [28, IV. \u00a79,Step 3].)\nIf A is even and B odd, we define new variables by y \u2032 = y \u2212 x and x\u2032 = x \u2212 1 \u2212 i. This change\nof variables gives rise to the Weierstrass equation\n(y \u2032 )2 + 2x\u2032 y \u2032 + 2(1 + i)y \u2032 =\n(x\u2032 )3 + (5 + 3i + 2(1 + i)A)(x\u2032 )2 + ((B + iA2 ) + (4 + 12i)A + 7 + 10i)x\u2032\n+(B + iA2 )(i + 2) + (\u22122 + 14i)A + 9i + 2.\nWe are now in the situation of [28, IV. \u00a79,Step 7], so E has reduction of type In\u2217 for some n.\nNote that \u03c0 3 |a3 . Also, \u03c0 5 divides (\u22122 + 14i)A and 8i, so we have a6 \u223c\n= (B + iA2 + 1)(i + 2) mod\n5\n\u03c0 . Recall that we've assumed B is not congruent to 1 mod 4. So B \u2212 2A \u2261 3 mod 4.\nIf B \u2212 2A is congruent to 7 mod 8, we see that \u03c0 5 |a6 . So the polynomial Y 2 + \u03c0 \u22122 a3 Y \u2212 \u03c0 \u22124 a6 Y\nhas a double root over F2 at Y = 0. Moreover, in this case\na4 \u223c\n= B + 7 + 10i \u223c\n= B \u2212 1 + 2i\nmod \u03c0 4 . So ord\u03c0 a4 = 3, which implies that the polynomial \u03c0 \u22121 a2 X 2 + \u03c0 \u22123 a4 X + \u03c0 \u22125 a6 has distinct\nroots in F2 . We conclude in this case that E has reduction type I2\u2217 and f = ord\u03c0 (\u2206) \u2212 6 = 6.\nSuppose on the other hand that B \u2212 2A is congruent to 3 mod 8. Then we change variables\nby setting y \u2032\u2032 = y \u2032 + 2. This change of variables causes a6 to become a multiple of \u03c0 5 , while the\nvaluations of a4 and a2 do not change. So once again we are in the situation of reduction type I2\u2217\nand f = 6.\nThe quantity f computed above is the Artin conductor of Tp E considered as a p-adic Galois\nrepresentation of Gal(Q\u03042 /Q2 [i]). Let \u03c1\u2217 be the the 4-dimensional representation of Gal(Q\u03042 /Q2 )\ninduced from Tp E. Then \u03c1\u2217 \u223c\n= Tp A, where A is the restriction of scalars of E described above. We\nhave from [24, \u00a71] that f (\u03c1\u2217 ) = f + 2 dim Tp E = f + 4. So f (\u03c1\u2217 ) is either 10 or 16.\n17\n\n\fBy examination of the j invariant, we see that E has potentially good reduction at \u03c0. It follows\nthat the inertia group I2 \u2282 Gal(Q\u03042 /Q2 ) acts on Tp A through a finite quotient G, whose order is not\ndivisible by any prime greater than 3. Let \u03c1E,p be the 2-dimensional representation of Gal(Q\u0304/Q)\non Tp A, and let fp be the conductor of \u03c1E,p | Gal(Q\u03042 /Q2 ). If p =\u221ap is inert, it is immediate that\nf (\u03c1\u2217 ) = 2fp . If, on the other hand, p and p\u2032 are split primes of Q( 2) lying over p, then fp and fp\u2032\nare both equal to the 2-part of the conductor of the modular abelian variety A, and again we get\nf (\u03c1\u2217 ) = fp + fp\u2032 = 2fp .\nWe conclude that fp is either 5 or 8. Moreover, the fact that |G| is prime to p implies that the\n2-part of the conductor of \u03c1\u0304E,p is identical with fp . This completes the proof.\nWe have now established that \u03c1\u0304E,p is isomorphic to \u03c1\u0304f,p , where f is a weight 2 newform of level\n32 or 256. In fact, the newforms of these levels are all associated\nto elliptic curves (not necessarily\n\u221a\ndefined over Q) with complex multiplication by Q[i] or Q[ \u22122]. In particular, the image of P\u03c1\u0304E,p\nis the normalizer of a Cartan subgroup in P GL2 (Fp ).\nSuppose the image of P\u03c1\u0304E,p lies in the normalizer of a split Cartan subgroup. Then it follows\nfrom Proposition 3.4 that E has good reduction away from 6. But this contradicts Lemma 4.3.\nWe conclude that the image of P\u03c1\u0304E,p must be the normalizer of a non-split Cartan subgroup.\nWe now use this fact to bound p.\nProposition 4.6. Let E0 /Q[i] be a Q-curve of degree 2, and suppose P\u03c1\u0304E,p has image contained\nin the normalizer of a non-split Cartan subgroup of PGL2 (Fp ), for some p \u2265 211. Then E0 has\npotentially good reduction for all primes of Q[i].\nProposition 4.6 completes the proof of Theorem 4.1. For we have shown that if (A, B, C)\nis a solution to (4.6), and E = EA,B,C , then P\u03c1\u0304E,p has as image the normalizer of a non-split\nCartan subgroup of PGL2 (Fp ). If p \u2265 211, then Proposition 4.6 shows that E has good reduction\neverywhere, contradicting Lemma 4.3.\nWe now proceed with the proof of Proposition 4.6.\nProof. The main tools are Proposition 3.6 and the estimate for average special values of L-functions\nin [14].\nProposition 3.6 tells that E0 has potentially good reduction everywhere if p is sufficiently large.\nWe now show that p \u2265 211 suffices. It is clear from the proof of Proposition 3.6 that E0 has good\nreduction away from 6p whenever there exists a newform f on S2 (\u03930 (p2 )) satisfying the conditions\nof Proposition 3.9. In turn, in order to prove the existence of such a form it suffices to show that\nthe inner product\n(a1 , L\u03c7 )p\u2212new\n= (a1 , L\u03c7 )p2 \u2212 (a1 , L\u03c7 )pp2\np2\nis non-zero. We have by Lemma 3.12 that\n(a1 , L\u03c7 )pp2 = p(p2 \u2212 1)\u22121 (a1 \u2212 p\u22121 \u03c7(p)ap , L\u03c7 )p .\nWe now use Theorem 1 of [14] to show that (a1 , L\u03c7 )p\u2212new is nonzero. The theorem shows that\n(am , L\u03c7 )N is 4\u03c0\u03c7(m) + O(N \u22121 log(N )d(N )), where d(N ) is the number of divisors of N andthe\nimplied constants are explicit functions of m, \u03c7. Precisely, we obtain that, for p \u2265 211,\n|(a1 , L\u03c7 )p2 \u2212 4\u03c0| \u2264 4.37\n18\n\n\f(In the applications here, we always take the parameter \u03c3 in [14] to be 8/\u03c0.)\nAt level p, the same theorem gives\n|(a1 , L\u03c7 )p | \u2264 786\nwhen p > 211.\nFinally, Lemma 3.13 shows that\n|(ap , L\u03c7 )p | \u2264 437.\nSo we find\n|(a1 , L\u03c7 )p\u2212new | \u2265 4\u03c0 \u2212 4.37 \u2212\nThis proves Proposition 4.6.\n\n211\n(786 + 437/211) > 4.\n2112 \u2212 1\n\nFor p smaller than 211, the argument above shows that A4 + B 2 = C p has no nontrivial solutions\nif we can prove the existence of a modular form satisfying the conditions of Proposition 3.9. To be\nprecise, we have shown\nProposition 4.7. Let p > 13 be prime, and suppose there exists either\n\u2022 a newform in S2 (\u03930 (2p2 )) with wp f = f and w2 f = \u2212f ; or\n\u2022 a newform in S2 (\u03930 (p2 )) with wp f = f ,\nsuch that L(f \u2297 \u03c7, 1) 6= 0. Then the equation A4 + B 2 = C p has no primitive non-trivial solutions.\nVerification of the existence of such a modular form is, in principle, a finite computation. In\npractice, it is beyond the reach of current computers to compute the Fourier coefficients of a newform\nof level 2p2 when p is as large as 100. It seems probable that by exploiting various tricks and carrying\nout more complicated computations, we will be able to show that Proposition 4.7 applies for all\nprimes p between 17 and 211. We will discuss this problem in a later paper.\n\nReferences\n[1] A. Akbary. Non-vanishing of weight k modular L-functions with large level. J. Ramanujan\nMath. Soc., 14(1):37\u201354, 1999.\n[2] A. O. L. Atkin and W. C. W. Li. Twists of newforms and pseudo-eigenvalues of W -operators.\nInvent. Math., 48(3):221\u2013243, 1978.\n[3] A.O.L. Atkin and J. Lehner. Hecke operators on \u03930 (m). Math. Ann., 185:134\u2013160, 1970.\n[4] N. Bruin. The Diophantine equations x2 \u00b1 y 4 = \u00b1z 6 and x2 + y 8 = z 3 . Compositio Math. 118\n(1999), no. 3, 305\u2013321.\n[5] D. Bump. Automorphic forms and representations. Cambridge University Press, 1997.\n[6] I. Chen. On relations between Jacobians of certain modular curves. J. Algebra, 231(1):414\u2013448,\n2000.\n[7] H. Darmon. The equations xn + y n = z 2 and xn + y n = z 3 . Internat. Math. Res. Notices,\n10:263\u2013274, 1993.\n19\n\n\f[8] H. Darmon. Serre's conjectures. In V. Kumar Murty, editor, Seminar on Fermat's Last Theorem, number 17 in CMS Conference Proceedings, pages 135\u2013153, 1995.\n[9] H. Darmon. Rigid local systems, Hilbert modular forms, and Fermat's last theorem. Duke\nMath. J., 102(3):413\u2013449, 2000.\n[10] H. Darmon and A. Granville. On the equations z m = F (x, y) and Axp + By q = Cz r . Bull.\nLondon Math. Soc., 27(6):513\u2013543, 1995.\n[11] H. Darmon and L. Merel. Winding quotients and some variants of Fermat's last theorem. J.\nReine Angew. Math., 490:81\u2013100, 1997.\n[12] B. DeSmit and B. Edixhoven. Sur un r\u00e9sultat d'Imin Chen. Math. Res. Lett., 7(2\u20133):147\u2013153,\n2000.\n[13] W. Duke. The critical order of vanishing of automorphic L-functions with large level. Invent.\nMath., 119(1):165\u2013174, 1995.\n[14] J. Ellenberg. On the error term in Duke's estimate for the average special value of L-functions.\nTo appear, Canad. Math. Bull.\n[15] J. Ellenberg and C. Skinner. On the modularity of Q-curves. Duke Math. J., 109(1):97\u2013122,\n2001.\n[16] J. Friedlander and H. Iwaniec. The polynomial X 2 + Y 4 captures its primes. Ann. of Math (2)\n148(3): 945\u20131040, 1998.\n[17] A. Grothendieck. Elements de geometrie algebrique, IV4 . Publ. Math. IHES, 32, 1967.\n[18] H. Iwaniec, W. Luo, and P. Sarnak. Low lying zeros of families of L-functions. Inst. Hautes\n\u00c9tudes Sci. Publ. Math, 91:55\u2013131, 2000.\n[19] N. Katz and B. Mazur. Arithmetic Moduli of Elliptic Curves. Princeton University Press, 1985.\n[20] V.A. Kolyvagin and D. Yu Logachev. Finiteness of the Shafarevich-Tate group and the group of\nrational points for some modular abelian varieties. Leningrad Math. J., 1(5):1229\u20131253, 1990.\n[21] W. C. W. Li. Newforms and functional equations. Math. Ann. 212: 285\u2013315, 1975.\n[22] B. Mazur. Modular curves and the Eisenstein ideal. Publ. Math. I.H.E.S., 47:33\u2013186, 1977.\n[23] B. Mazur. Rational isogenies of prime degree. Invent. Math., 44(2):129\u2013162, 1978.\n[24] J.S. Milne. On the arithmetic of abelian varieties. Invent. Math., 17:177\u2013190, 1972.\n[25] F. Momose. Rational points on the modular curves Xsplit (p). Compositio Math., 52(1):115\u2013137,\n1984.\n[26] K. Ribet. On the equation ap + 2bp + cp = 0. Acta Arith., 79(1):7\u201316, 1997.\n[27] J.P. Serre. Sur les repr\u00e9sentations modulaires de degr\u00e9 2 de Gal(Q\u0304/Q). Duke Math. Jour.,\n54(1):179\u2013230, 1987.\n[28] J. Silverman. Advanced topics in the arithmetic of elliptic curves. Springer-Verlag, 1994.\n\n20\n\n\f"}