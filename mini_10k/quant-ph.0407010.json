{"id": "http://arxiv.org/abs/quant-ph/0407010v1", "guidislink": true, "updated": "2004-07-01T16:27:31Z", "updated_parsed": [2004, 7, 1, 16, 27, 31, 3, 183, 0], "published": "2004-07-01T16:27:31Z", "published_parsed": [2004, 7, 1, 16, 27, 31, 3, 183, 0], "title": "Transformation of quantum states using uniformly controlled rotations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=quant-ph%2F0407002%2Cquant-ph%2F0407071%2Cquant-ph%2F0407047%2Cquant-ph%2F0407028%2Cquant-ph%2F0407188%2Cquant-ph%2F0407132%2Cquant-ph%2F0407147%2Cquant-ph%2F0407238%2Cquant-ph%2F0407138%2Cquant-ph%2F0407146%2Cquant-ph%2F0407110%2Cquant-ph%2F0407251%2Cquant-ph%2F0407244%2Cquant-ph%2F0407165%2Cquant-ph%2F0407005%2Cquant-ph%2F0407180%2Cquant-ph%2F0407099%2Cquant-ph%2F0407142%2Cquant-ph%2F0407253%2Cquant-ph%2F0407020%2Cquant-ph%2F0407173%2Cquant-ph%2F0407141%2Cquant-ph%2F0407101%2Cquant-ph%2F0407185%2Cquant-ph%2F0407010%2Cquant-ph%2F0407205%2Cquant-ph%2F0407106%2Cquant-ph%2F0407072%2Cquant-ph%2F0407048%2Cquant-ph%2F0407097%2Cquant-ph%2F0407060%2Cquant-ph%2F0407201%2Cquant-ph%2F0407167%2Cquant-ph%2F0407095%2Cquant-ph%2F0407088%2Cquant-ph%2F0407220%2Cquant-ph%2F0407011%2Cquant-ph%2F0407192%2Cquant-ph%2F0407075%2Cquant-ph%2F0407087%2Cquant-ph%2F0407024%2Cquant-ph%2F0407094%2Cquant-ph%2F0407150%2Cquant-ph%2F0407042%2Cquant-ph%2F0407175%2Cquant-ph%2F0407061%2Cquant-ph%2F0407258%2Cquant-ph%2F0407008%2Cquant-ph%2F0407158%2Cquant-ph%2F0407070%2Cquant-ph%2F0407021%2Cquant-ph%2F0407107%2Cquant-ph%2F0407121%2Cquant-ph%2F0407091%2Cquant-ph%2F0407156%2Cquant-ph%2F0407134%2Cquant-ph%2F0407181%2Cquant-ph%2F0407045%2Cquant-ph%2F0407203%2Cquant-ph%2F0407152%2Cquant-ph%2F0407154%2Cquant-ph%2F0407076%2Cquant-ph%2F0407240%2Cquant-ph%2F0407209%2Cquant-ph%2F0407067%2Cquant-ph%2F0407187%2Cquant-ph%2F0407133%2Cquant-ph%2F0407168%2Cquant-ph%2F0407153%2Cquant-ph%2F0407184%2Cquant-ph%2F0407040%2Cquant-ph%2F0407160%2Cquant-ph%2F0407243%2Cquant-ph%2F0407100%2Cquant-ph%2F0407082%2Cquant-ph%2F0407236%2Cquant-ph%2F0407112%2Cquant-ph%2F0407001%2Cquant-ph%2F0407037%2Cquant-ph%2F0407252%2Cquant-ph%2F0407092%2Cquant-ph%2F0407036%2Cquant-ph%2F0407204%2Cquant-ph%2F0407221%2Cquant-ph%2F0407057%2Cquant-ph%2F0407055%2Cquant-ph%2F0407211%2Cquant-ph%2F0407202%2Cquant-ph%2F0407262%2Cquant-ph%2F0407104%2Cquant-ph%2F0407239%2Cquant-ph%2F0407259%2Cquant-ph%2F0407003%2Cquant-ph%2F0407098%2Cquant-ph%2F0407245%2Cquant-ph%2F0407195%2Cquant-ph%2F0407009%2Cquant-ph%2F0407022%2Cquant-ph%2F0407116%2Cquant-ph%2F0407102%2Cquant-ph%2F0407080&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Transformation of quantum states using uniformly controlled rotations"}, "summary": "We consider a unitary transformation which maps any given state of an\n$n$-qubit quantum register into another one. This transformation has\napplications in the initialization of a quantum computer, and also in some\nquantum algorithms. Employing uniformly controlled rotations, we present a\nquantum circuit of $2^{n+2}-4n-4$ CNOT gates and $2^{n+2}-5$ one-qubit\nelementary rotations that effects the state transformation. The complexity of\nthe circuit is noticeably lower than the previously published results.\nMoreover, we present an analytic expression for the rotation angles needed for\nthe transformation.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=quant-ph%2F0407002%2Cquant-ph%2F0407071%2Cquant-ph%2F0407047%2Cquant-ph%2F0407028%2Cquant-ph%2F0407188%2Cquant-ph%2F0407132%2Cquant-ph%2F0407147%2Cquant-ph%2F0407238%2Cquant-ph%2F0407138%2Cquant-ph%2F0407146%2Cquant-ph%2F0407110%2Cquant-ph%2F0407251%2Cquant-ph%2F0407244%2Cquant-ph%2F0407165%2Cquant-ph%2F0407005%2Cquant-ph%2F0407180%2Cquant-ph%2F0407099%2Cquant-ph%2F0407142%2Cquant-ph%2F0407253%2Cquant-ph%2F0407020%2Cquant-ph%2F0407173%2Cquant-ph%2F0407141%2Cquant-ph%2F0407101%2Cquant-ph%2F0407185%2Cquant-ph%2F0407010%2Cquant-ph%2F0407205%2Cquant-ph%2F0407106%2Cquant-ph%2F0407072%2Cquant-ph%2F0407048%2Cquant-ph%2F0407097%2Cquant-ph%2F0407060%2Cquant-ph%2F0407201%2Cquant-ph%2F0407167%2Cquant-ph%2F0407095%2Cquant-ph%2F0407088%2Cquant-ph%2F0407220%2Cquant-ph%2F0407011%2Cquant-ph%2F0407192%2Cquant-ph%2F0407075%2Cquant-ph%2F0407087%2Cquant-ph%2F0407024%2Cquant-ph%2F0407094%2Cquant-ph%2F0407150%2Cquant-ph%2F0407042%2Cquant-ph%2F0407175%2Cquant-ph%2F0407061%2Cquant-ph%2F0407258%2Cquant-ph%2F0407008%2Cquant-ph%2F0407158%2Cquant-ph%2F0407070%2Cquant-ph%2F0407021%2Cquant-ph%2F0407107%2Cquant-ph%2F0407121%2Cquant-ph%2F0407091%2Cquant-ph%2F0407156%2Cquant-ph%2F0407134%2Cquant-ph%2F0407181%2Cquant-ph%2F0407045%2Cquant-ph%2F0407203%2Cquant-ph%2F0407152%2Cquant-ph%2F0407154%2Cquant-ph%2F0407076%2Cquant-ph%2F0407240%2Cquant-ph%2F0407209%2Cquant-ph%2F0407067%2Cquant-ph%2F0407187%2Cquant-ph%2F0407133%2Cquant-ph%2F0407168%2Cquant-ph%2F0407153%2Cquant-ph%2F0407184%2Cquant-ph%2F0407040%2Cquant-ph%2F0407160%2Cquant-ph%2F0407243%2Cquant-ph%2F0407100%2Cquant-ph%2F0407082%2Cquant-ph%2F0407236%2Cquant-ph%2F0407112%2Cquant-ph%2F0407001%2Cquant-ph%2F0407037%2Cquant-ph%2F0407252%2Cquant-ph%2F0407092%2Cquant-ph%2F0407036%2Cquant-ph%2F0407204%2Cquant-ph%2F0407221%2Cquant-ph%2F0407057%2Cquant-ph%2F0407055%2Cquant-ph%2F0407211%2Cquant-ph%2F0407202%2Cquant-ph%2F0407262%2Cquant-ph%2F0407104%2Cquant-ph%2F0407239%2Cquant-ph%2F0407259%2Cquant-ph%2F0407003%2Cquant-ph%2F0407098%2Cquant-ph%2F0407245%2Cquant-ph%2F0407195%2Cquant-ph%2F0407009%2Cquant-ph%2F0407022%2Cquant-ph%2F0407116%2Cquant-ph%2F0407102%2Cquant-ph%2F0407080&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We consider a unitary transformation which maps any given state of an\n$n$-qubit quantum register into another one. This transformation has\napplications in the initialization of a quantum computer, and also in some\nquantum algorithms. Employing uniformly controlled rotations, we present a\nquantum circuit of $2^{n+2}-4n-4$ CNOT gates and $2^{n+2}-5$ one-qubit\nelementary rotations that effects the state transformation. The complexity of\nthe circuit is noticeably lower than the previously published results.\nMoreover, we present an analytic expression for the rotation angles needed for\nthe transformation."}, "authors": ["Mikko Mottonen", "Juha J. Vartiainen", "Ville Bergholm", "Martti M. Salomaa"], "author_detail": {"name": "Martti M. Salomaa"}, "author": "Martti M. Salomaa", "arxiv_comment": "4 pages, 3 figures", "links": [{"href": "http://arxiv.org/abs/quant-ph/0407010v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/quant-ph/0407010v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/quant-ph/0407010v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/quant-ph/0407010v1", "journal_reference": "Quant. Inf. Comp. 5, 467 (2005)", "doi": null, "fulltext": "Transformation of quantum states using uniformly controlled rotations\nMikko M\u00f6tt\u00f6nen,\u2217 Juha J. Vartiainen, Ville Bergholm, and Martti M. Salomaa\nMaterials Physics Laboratory, P.O. Box 2200,\nFIN-02015 Helsinki University of Technology, Finland\n(Dated: February 1, 2008)\n\narXiv:quant-ph/0407010v1 1 Jul 2004\n\nWe consider a unitary transformation which maps any given state of an n-qubit quantum register\ninto another one. This transformation has applications in the initialization of a quantum computer,\nand also in some quantum algorithms. Employing uniformly controlled rotations, we present a\nquantum circuit of 2n+2 \u2212 4n \u2212 4 CNOT gates and 2n+2 \u2212 5 one-qubit elementary rotations that\neffects the state transformation. The complexity of the circuit is noticeably lower than the previously\npublished results. Moreover, we present an analytic expression for the rotation angles needed for\nthe transformation.\nPACS numbers: 03.67.Lx, 03.65.Fd\nKeywords: quantum computation, quantum state preparation\n\nI.\n\nINTRODUCTION\n\nQuantum algorithms are based on unitary transformations and projective measurements acting on a quantum\nregister of n qubits [1]. Successful execution of an algorithm usually requires a certain initial state as input. However,\ndepending on the physical realization of the quantum computer, available initialization procedures may only produce a\nlimited range of states which may not contain the desired initial state. This brings up the problem of state preparation,\ni.e., how to implement the transformation of an arbitrary quantum state into another one.\nThe recent progress [2, 3, 4] in implementing general n-qubit gates using elementary gates has resulted in efficient\ngate synthesis techniques including uniformly controlled rotations [3], and more recently, quantum multiplexors [4].\nThese techniques are amenable also for implementing quantum gates of certain special classes of unitary transformations, such as incompletely specified transformations. These transformations have been reacently discussed in Ref. [5],\nin which an efficient gate decomposition was given in the case of two qubits.\nThe complexity of a quantum circuit is measured by the number of elementary gates included. Generally, elementary\ngates are unitary transformations acting on one or two qubits. We take the library of elementary gates to be the\nconventional set of the controlled NOT (CNOT) gate and all one-parameter rotations acting on a single qubit. We\nomit the phase gate since the global phase of the state vector has no physical meaning.\nThe configuration space of the n-qubit quantum register is 2n -dimensional complex space. Excluding the global\nphase and state normalization, we find that the general unitary transformation transforming a given n-qubit state into\nanother must have at least 2 \u00d7 2n \u2212 2 real degrees of freedom. Hence, in the worst-case scenario, the corresponding\nquantum circuit should involve at least 2n+1 \u2212 2 elementary rotations, each carrying one degree of freedom. Since\neach of the CNOT gates can bind at most four elementary rotations [6], at least \u2308 14 (2n+1 \u2212 3n \u2212 2)\u2309 of them are\nneeded. However, no quantum circuit construction embodying the minimal complexity has been presented in the\nliterature. Previously, the upper bound for the number of gates needed for state preparation has been considered by\nKnill [7], who found that no more than O(n2n ) gates are needed for the circuit implementing the transformation.\nMore recently, a sufficient circuit of O(2n ) elementary gates was obtained as a special case of the method developed\nfor QR decomposition of a general quantum gate in Ref. [2], which was also pointed out in Ref. [5].\nIn this paper, we describe in detail how to build a quantum circuit for making a given quantum state transformation\nemploying the uniformly controlled rotations. We begin from the transformation which equalizes the phases of the\nelements of the input vector |ai and rotates it to the direction of the basis vector |e1 i. In the next phase the absolute\nvalues of elements of the target vector |bi are generated and finally the phases are adjusted to match of those of |bi.\nWe simplify the circuit by merging certain consecutive gates together. The resulting quantum circuit of 2n+2 \u2212 4n \u2212 4\nCNOT gates and 2n+2 \u2212 5 one-qubit elementary rotations gives, in principle, the exact transformation from an n-qubit\nquantum state |ai into the desired one |bi.\n\n\u2217 Electronic\n\naddress: mpmotton@focus.hut.fi\n\n\f2\n\nk\nFIG. 1: Definition of the k-fold uniformly controlled rotation Fm\n(a, \u03b1) of qubit m about the axis a. The left hand side defines\nthe gate symbol used for the uniformly controlled rotation. The enumeration of the qubits is arbitrary with the exception that\nthe target qubit is the mth one. The black control bits stand for value 1 and the white for 0. Above, M = 2k .\n\nFIG. 2: Efficient gate decomposition for the uniformly controlled rotation F43 (a, \u03b1). The relation of the angles {\u03b8j } to the\nangles {\u03b1j } is shown in Eq. (3).\n\nII.\n\nUNIFORMLY CONTROLLED ROTATIONS\n\nThe quantum state of an n-qubit register may be described by a complex vector of the form\n\uf8eb \uf8f6\na1\n\u22121\n\uf8ec a2 \uf8f7 NX\n\uf8ec \uf8f7\n|ai = \uf8ec . \uf8f7 =\nai+1 bi1 bi2 . . . biN ,\n\uf8ed .. \uf8f8\ni=0\naN\n\n(1)\n\nwhere N = 2n , bj denotes the state of the j th qubit, and the bit string bi1 bi2 . . . biN is the binary presentation of the\ninteger i. The state is taken to be normalized to unity. Furthermore, the overall phase of the state is not observable\nand thus irrelevant. This means that an n-qubit state has 2n+1 \u2212 2 real degrees of freedom. Quantum gates are linear\ntransformations on the space of these vectors and, hence, may be represented by N \u00d7 N unitary matrices.\nk\nA uniformly controlled rotation Fm\n(a, \u03b1) is a quantum gate defined by the k controlled qubits, the target qubit m,\nthe rotation axis a and the angles {\u03b1i }, see Ref. [3]. As shown in Fig. 1, the uniformly controlled rotation corresponds\nto a sequence of controlled Ra (\u03b1i ) rotations, which covers all the 2k possible control bit sequences. Here\n\u03b1i\n\u03b1i\n+ i (a * \u03c3) sin ,\n(2)\nRa (\u03b1i ) = eia*\u03c3\u03b1i /2 = I2\u00d72 cos\n2\n2\nwhere \u03c3x , \u03c3y , and \u03c3z are the Pauli matrices and the dot product a * \u03c3 = \u03c3x ax + \u03c3y ay + \u03c3z az .\nk\nFigure 2 reviews a construction for Fm\n(a, \u03b1) consisting of 2k CNOT gates and 2k one-qubit a-rotations. The case\nk = 3 is shown. In the case of a general k, the gate sequence may be constructed from the sequence for k \u2212 1 by\nreplacing the position of the control in the rightmost CNOT gate to the new controlled qubit and repeating the\nobtained sequence twice for suitable rotation angles {\u03b8j }. The operational principle of the gate sequence requires that\nax = 0. However, this limitation can be circumvented by introducing one-qubit basis changing gates on the both side\nof the gate.\nThe angles {\u03b8i } can be obtained from {\u03b1i } using the equation\n\uf8f6\n\uf8eb\n\uf8eb \uf8f6\n\u03b11\n\u03b81\n\uf8ec . \uf8f7\n\uf8ec .. \uf8f7\n(3)\nMij = 2\u2212k (\u22121)bj\u22121 *gi\u22121 ,\n\uf8ed . \uf8f8 = M \uf8ed .. \uf8f8 ,\n\u03b82k\n\n\u03b12k\n\n\f3\nwhere bm and gm stand for the binary code and binary reflected Gray code representations of the integer m, respectively. In actuality, the position of the controls of the CNOT gates in Fig. 2 may be chosen in many different\nways which results in replacing gj\u22121 in Eq. (3) by another cyclic Gray code [8]. Additionally, a horizontally mirrored\nversion of the gate sequence in Fig. 2 also qualifies to simulate the uniformly controlled rotation.\nIII.\n\nSTATE PREPARATION\n\nWe are looking for a gate sequence corresponding to a matrix U such that U |ai = |bi for given vectors |ai and\n|bi. The problem may be reduced to the problem of finding a matrix V which takes an arbitrary vector to some\nfixed vector |ri, since then we may take A and B such that A |ai = |ri = B |bi and, hence, B \u2020 A |ai = |bi, where\nthe dagger denotes the Hermitian conjugate. For convenience, we take the fixed vector to be the first basis vector\n|e1 i = |00 . . . 0i = (1, 0, 0, . . . , 0)T .\nOur algorithm for transforming |ai = (|a1 |ei\u03c91 , |a2 |ei\u03c92 , . . . , |aN |ei\u03c9N )T into |e1 i works as follows:\n\u2022 First we equalize the phases \u03c9i using a cascade of uniformly controlled z-rotations \u039ez , rendering the vector real\nup to the global phase \u03c6: \u039ez |ai = ei\u03c6 |\u00e2i.\n\u2022 Then we rotate the real state vector |\u00e2i into the direction of |e1 i using a similar sequence of uniformly controlled\ny-rotations \u039ey , thus achieving our goal.\nThe first step can be readily accomplished using a general diagonal n-qubit quantum gate first considered in Ref. [9].\nIt is efficiently produced by a sequence of uniformly controlled z-rotations as\n\u039ez =\n\nn\nY\n\nFjj\u22121 (z, \u03b1zn\u2212j+1 ) \u2297 I2n\u2212j ,\n\n(4)\n\nj=1\n\nwhere the gate Fjj\u22121 (z, \u03b1zn\u2212j+1 ) equalizes the phases of the elements connected through the qubit j. The rotation\nangles {\u03b1zj,k }j , the elements of \u03b1zk , are found to be\n\u03b1zj,k\n\n=\n\nk\u22121\n2X\n\n(\u03c9(2j\u22121)2k\u22121 +l \u2212 \u03c9(2j\u22122)2k\u22121 +l )/2k\u22121 ,\n\n(5)\n\nl=1\n\nwhere j = 1, 2, . . . , 2n\u2212k and k = 1, 2, . . . , n.\nNext\nwe\napply\na\nuniformly\ncontrolled\ny-rotation\nFnn\u22121 (y, \u03b1y )\nwith\nangles\n{\u03b1yj }\n=\n\u0010\n\u0011\np\n{2 asin |a2j |/ |a2j\u22121 |2 + |a2j |2 }. This has the effect of zeroing the elements of the vector that correspond\nto the states standing for bit value one in the qubit n:\nFnn\u22121 (y, \u03b1y ) |\u00e2i = (a1,2 , 0, a2,2 , 0, . . . , aN/2,2 , 0)T = (a1,2 , a2,2 , . . . , aN/2,2 )T \u2297 (1, 0)T\n(6)\np\nwhere {aj,2 } = { |a2j\u22121 |2 + |a2j |2 }. In effect we have zeroed the last qubit of the register. This procedure can be\nrepeated on the remaining nonzero elements, until we reach |e1 i = (1, 0)T \u2297 . . . \u2297 (1, 0)T .\nEmploying the above steps one obtains the desired decomposition\n\uf8f6\n\uf8f6\uf8eb\n\uf8eb\nn\nn\nPN\nY\nY\nFjj\u22121 (z, \u03b1zn\u2212j+1 ) \u2297 I2n\u2212j \uf8f8 |ai = ei j=1 \u03c9j /N |e1 i .\n\u039ey \u039ez |ai = \uf8ed\nFjj\u22121 (y, \u03b1yn\u2212j+1 ) \u2297 I2n\u2212j \uf8f8 \uf8ed\n(7)\nj=1\n\nj=1\n\nThe product of non-commuting matrices in Eq. (7) is to be taken from left to right. Here, to eliminate the remaining\nglobal phase one could apply a phase gate. After solving the recursion, the rotation angles in Eq. (7) are found to\nacquire the values\nv\n\uf8f6\n\uf8ebv\nu 2k\nu2k\u22121\nuX\nuX\ny\n(8)\n|a(2j\u22121)2k\u22121 +l |2 /t\n|a(j\u22121)2k +l |2 \uf8f8 ,\n\u03b1j,k = 2asin \uf8edt\nl=1\n\nl=1\n\nwhere j = 1, 2, . . . , 2n\u2212k and k = 1, 2, . . . , n. Fig. 3 shows the quantum circuit corresponding to Eq. (7). The\nresulting gate sequence is slightly simplified by noting that uniformly controlled z-rotations, being diagonal, can\n\n\f4\n\nFIG. 3: Gate sequence for state preparation using uniformly controlled rotations. The rotation angles {\u03b1qj,k } for the uniformly\ncontrolled rotations are given in Eqs. (8) and (5).\n\nalways be commuted through the control bits of another uniformly controlled gate. Hence, uniformly controlled z and\ny rotations acting on the same set of qubits can be commuted next to each other, whereby we can cancel one CNOT\nfrom each gate by mirroring the y gate.\nTo transform the state |ai to |bi we need to construct two circuits; the first one takes |ai to |e1 i and the second one\n|e1 i to |bi. Since the uniformly k-fold controlled rotation may be constructed from 2k CNOT gates and 2k one-qubit\nrotations, the entire state preparation circuit requires 2n+2 \u2212 4n \u2212 4 CNOT gates and 2n+2 \u2212 5 one-qubit rotations.\nIV.\n\nCONCLUSION\n\nIn conclusions, we have shown how to construct a general state preparation circuit using a sequence of uniformly\ncontrolled rotations. The resulting gate sequence of 2n+2 \u2212 4n \u2212 4 CNOT gates and 2n+2 \u2212 5 one-qubit elementary\nrotations establishes a new upper bound for the complexity of the transformation. By counting the degrees of freedom\nof the problem, we find a lower bound of 2n+1 \u2212 2 for the number of one-qubit elementary rotations. This implies the\nlower bound \u2308 14 (2n+1 \u2212 3n \u2212 2)\u2309 for the number of CNOT gates.\nProvided that the initial or final state coincides with some basis vector |ei i only half of the CNOT and one-qubit\nrotation gates are needed. In other special cases some simplifications to the gate sequence also occur. We have\nalso introduced a closed-form scheme for determining the rotation angles in such way that an arbitrary state of the\nquantum register transforms into desired state.\nThe gate count is small compared to the incomplete QR decomposition which takes approximately 6.3 \u00d7 2n CNOT\ngates to transform |ai \u2192 |e1 i and thus 12.6 \u00d7 2n for the whole transformation. It is still an open question if the\ntransformation could be done more directly, i.e., merging some of the consecutive gates together and finding efficient\ngate array for implementing them. This would reduce the number of elementary gates needed.\nAcknowledgments\n\nThis research is supported by the Academy of Finland through the project \"Quantum Computation\" (No. 206457).\nMM thanks the Foundation of Technology (Finland), JJV the Nokia Foundation, MM and VB the Finnish Cultural\nFoundation, and MMS the Japan Society for the Promotion of Science for financial support. Sami Virtanen is\nacknowledged for stimulating discussions.\n\n[1]\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n\nM. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, 2000).\nJ. J. Vartiainen, M. M\u00f6tt\u00f6nen, and M. M. Salomaa (2004), quant-ph/0312218.\nM. Mikko M\u00f6tt\u00f6nen, J. J. Vartiainen, V. Bergholm, and M. M. Salomaa (2004), quant-ph/0404089.\nV. V. Shende, S. S. Bullock, and I. L. Markov (2004), quant-ph/0406176.\nV. V. Shende and I. L. Markov (2004), quant-ph/0401162.\nV. V. Shende, I. L. Markov, and S. S. Bullock (2003), quant-ph/0308033.\nE. Knill (1995), quant-ph/9508006.\n\n\f5\n[8] C. Savage, SIAM Rev. 39, 605 (1997).\n[9] S. S. Bullock and I. L. Markov, Quant. Inf. and Comp. 4, 27 (2004).\n\n\f"}