{"id": "http://arxiv.org/abs/0803.1068v1", "guidislink": true, "updated": "2008-03-07T11:55:08Z", "updated_parsed": [2008, 3, 7, 11, 55, 8, 4, 67, 0], "published": "2008-03-07T11:55:08Z", "published_parsed": [2008, 3, 7, 11, 55, 8, 4, 67, 0], "title": "A Rigorous Finite-Element Domain Decomposition Method for\n  Electromagnetic Near Field Simulations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0803.1234%2C0803.1917%2C0803.3604%2C0803.2243%2C0803.4207%2C0803.3515%2C0803.0508%2C0803.4111%2C0803.3774%2C0803.1842%2C0803.3068%2C0803.0955%2C0803.1068%2C0803.2006%2C0803.1282%2C0803.4240%2C0803.3017%2C0803.3039%2C0803.4087%2C0803.2865%2C0803.3776%2C0803.3079%2C0803.1369%2C0803.1914%2C0803.1150%2C0803.1186%2C0803.1847%2C0803.4029%2C0803.0576%2C0803.3350%2C0803.3561%2C0803.4399%2C0803.1033%2C0803.2325%2C0803.0022%2C0803.1865%2C0803.2403%2C0803.2206%2C0803.1576%2C0803.1388%2C0803.3587%2C0803.1894%2C0803.4027%2C0803.3577%2C0803.4170%2C0803.3204%2C0803.2671%2C0803.2296%2C0803.2118%2C0803.3539%2C0803.4260%2C0803.2009%2C0803.0141%2C0803.3421%2C0803.3371%2C0803.2814%2C0803.3671%2C0803.4241%2C0803.1792%2C0803.1870%2C0803.1506%2C0803.0347%2C0803.2864%2C0803.2561%2C0803.0439%2C0803.1546%2C0803.3649%2C0803.2949%2C0803.4038%2C0803.1831%2C0803.0489%2C0803.1723%2C0803.2558%2C0803.0005%2C0803.1825%2C0803.3466%2C0803.0514%2C0803.0079%2C0803.0110%2C0803.4391%2C0803.0271%2C0803.0324%2C0803.2051%2C0803.2487%2C0803.1696%2C0803.3080%2C0803.1481%2C0803.3302%2C0803.1716%2C0803.2340%2C0803.2641%2C0803.2854%2C0803.1666%2C0803.3600%2C0803.2954%2C0803.3400%2C0803.2246%2C0803.4357%2C0803.0838%2C0803.0655%2C0803.1384&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Rigorous Finite-Element Domain Decomposition Method for\n  Electromagnetic Near Field Simulations"}, "summary": "Rigorous computer simulations of propagating electromagnetic fields have\nbecome an important tool for optical metrology and design of nanostructured\noptical components. A vectorial finite element method (FEM) is a good choice\nfor an accurate modeling of complicated geometrical features. However, from a\nnumerical point of view solving the arising system of linear equations is very\ndemanding even for medium sized 3D domains. In numerics, a domain decomposition\nmethod is a commonly used strategy to overcome this problem. Within this\napproach the overall computational domain is split up into smaller domains and\ninterface conditions are used to assure continuity of the electromagnetic\nfield. Unfortunately, standard implementations of the domain decomposition\nmethod as developed for electrostatic problems are not appropriate for wave\npropagation problems. In an earlier paper we therefore proposed a domain\ndecomposition method adapted to electromagnetic field wave propagation\nproblems. In this paper we apply this method to 3D mask simulation.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0803.1234%2C0803.1917%2C0803.3604%2C0803.2243%2C0803.4207%2C0803.3515%2C0803.0508%2C0803.4111%2C0803.3774%2C0803.1842%2C0803.3068%2C0803.0955%2C0803.1068%2C0803.2006%2C0803.1282%2C0803.4240%2C0803.3017%2C0803.3039%2C0803.4087%2C0803.2865%2C0803.3776%2C0803.3079%2C0803.1369%2C0803.1914%2C0803.1150%2C0803.1186%2C0803.1847%2C0803.4029%2C0803.0576%2C0803.3350%2C0803.3561%2C0803.4399%2C0803.1033%2C0803.2325%2C0803.0022%2C0803.1865%2C0803.2403%2C0803.2206%2C0803.1576%2C0803.1388%2C0803.3587%2C0803.1894%2C0803.4027%2C0803.3577%2C0803.4170%2C0803.3204%2C0803.2671%2C0803.2296%2C0803.2118%2C0803.3539%2C0803.4260%2C0803.2009%2C0803.0141%2C0803.3421%2C0803.3371%2C0803.2814%2C0803.3671%2C0803.4241%2C0803.1792%2C0803.1870%2C0803.1506%2C0803.0347%2C0803.2864%2C0803.2561%2C0803.0439%2C0803.1546%2C0803.3649%2C0803.2949%2C0803.4038%2C0803.1831%2C0803.0489%2C0803.1723%2C0803.2558%2C0803.0005%2C0803.1825%2C0803.3466%2C0803.0514%2C0803.0079%2C0803.0110%2C0803.4391%2C0803.0271%2C0803.0324%2C0803.2051%2C0803.2487%2C0803.1696%2C0803.3080%2C0803.1481%2C0803.3302%2C0803.1716%2C0803.2340%2C0803.2641%2C0803.2854%2C0803.1666%2C0803.3600%2C0803.2954%2C0803.3400%2C0803.2246%2C0803.4357%2C0803.0838%2C0803.0655%2C0803.1384&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Rigorous computer simulations of propagating electromagnetic fields have\nbecome an important tool for optical metrology and design of nanostructured\noptical components. A vectorial finite element method (FEM) is a good choice\nfor an accurate modeling of complicated geometrical features. However, from a\nnumerical point of view solving the arising system of linear equations is very\ndemanding even for medium sized 3D domains. In numerics, a domain decomposition\nmethod is a commonly used strategy to overcome this problem. Within this\napproach the overall computational domain is split up into smaller domains and\ninterface conditions are used to assure continuity of the electromagnetic\nfield. Unfortunately, standard implementations of the domain decomposition\nmethod as developed for electrostatic problems are not appropriate for wave\npropagation problems. In an earlier paper we therefore proposed a domain\ndecomposition method adapted to electromagnetic field wave propagation\nproblems. In this paper we apply this method to 3D mask simulation."}, "authors": ["L. Zschiedrich", "S. Burger", "A. Sch\u00e4dle", "F. Schmidt"], "author_detail": {"name": "F. Schmidt"}, "author": "F. Schmidt", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1117/12.771989", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0803.1068v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0803.1068v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "9 pages, 7 figures, SPIE conference Advanced Lithography / Optical\n  Microlithography XXI (2008)", "arxiv_primary_category": {"term": "physics.optics", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.optics", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0803.1068v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0803.1068v1", "journal_reference": "Proc. SPIE 6924 (2008) 692450, (Optical Microlithography XXI, H.J.\n  Levinson, M.V. Dusa, Eds.)", "doi": "10.1117/12.771989", "fulltext": "A Rigorous Finite-Element Domain Decomposition Method\nfor Electromagnetic Near Field Simulations\nLin Zschiedrich ab , Sven Burger ab , Achim Sch\u00e4dle a , Frank Schmidt ab ,\na\n\narXiv:0803.1068v1 [physics.optics] 7 Mar 2008\n\nb\n\nZuse Institute Berlin, Takustrasse 7, D \u2013 14 195 Berlin, Germany\nJCMwave GmbH, Haarer Strasse 14a, D \u2013 85 640 Putzbrunn, Germany\n\nCopyright 2008 Society of Photo-Optical Instrumentation Engineers.\nThis paper will be published in Proc. SPIE Vol. 6924 (2008), (Optical Microlithography XXI, H. J. Levinson,\nM. V. Dusa, Eds.) and is made available as an electronic preprint with permission of SPIE. One print or electronic\ncopy may be made for personal use only. Systematic or multiple reproduction, distribution to multiple locations\nvia electronic or other means, duplication of any material in this paper for a fee or for commercial purposes, or\nmodification of the content of the paper are prohibited.\n\nABSTRACT\nRigorous computer simulations of propagating electromagnetic fields have become an important tool for optical\nmetrology and design of nanostructured optical components. A vectorial finite element method (FEM) is a good\nchoice for an accurate modeling of complicated geometrical features. However, from a numerical point of view\nsolving the arising system of linear equations is very demanding even for medium sized 3D domains. In numerics,\na domain decomposition method is a commonly used strategy to overcome this problem. Within this approach\nthe overall computational domain is split up into smaller domains and interface conditions are used to assure\ncontinuity of the electromagnetic field. Unfortunately, standard implementations of the domain decomposition\nmethod as developed for electrostatic problems are not appropriate for wave propagation problems. In an earlier\npaper we therefore proposed a domain decomposition method adapted to electromagnetic field wave propagation\nproblems. In this paper we apply this method to 3D mask simulation.\nKeywords: 3D EMF simulations, microlithography, adaptive high-order finite-element method, FEM, multiple\nscattering\n\n1. INTRODUCTION\nThis paper adresses on the rigorous simulation of the electromagnetic field within a cutout of a microlithography\nmask or semiconductor wafer. It might be confusing that the notion \"domain decomposition method\" appears\nin the numerical literature about Maxwell's equations and in the mask simulation community with \u2013 at a first\nglance \u2013 different meanings. In the mask simulation community, Adam and Neureuther introduced the domain\ndecomposition method in 2001.1 As an example, in the approach by Adam and Neureuther a phase shift line\nmask is split up into two isolated lines, c.f. Figure 1. The transmission through each line is computed separately.\nAfterwards the computed fields are merged in an appropriate way. Diffraction effects of the double slit are\nneglected in a first step but can also be approximated by adding further cross talk terms. In the numerics\ncommunity the domain decomposition method denotes a strategy for solving large scale partial differential\nequation problems and goes back to Schwarz more than 100 years ago.2 This approach shares the key idea\nby Adam and Neureuther to split the computational problem into smaller, more feasible subproblems. But in\ncontrast to the method by Adam and Neureuther the synthesis step (merging the fields on the sub-domains)\nrelies on an iterative numerical method and not on physical intuition. This way the method remains rigorous:\nStarting from a rigorous discretization of Maxwell's equations in the entire domain one gets a large scale linear\nsystem of equations. The aim is to iteratively solve this large scale linear system. As long as the iterative process\nconverges this yields the rigorous solution. Although the domain decomposition method is well established and\nCorresponding author: L. Zschiedrich\nURL: http://www.zib.de/Numerik/NanoOptics/\nEmail: zschiedrich@zib.de\n\n\fg replacements\nEinc\n\nEinc\n\n\u01eb, E, H\n\nEinc\n\n\u01eb 1 , E1 , H1\n\n~\n~\n\n+\n\nEinc\n\n\u01eb 2 , E2 , H2\n\n\u01eb 3 , E3 , H3\n\nFigure 1. Domain decomposition method by Adam and Neureuther (not applied in this paper). One uses a superposition\nof the fields E1 , E2 , and E3 to approximate the field E. Although this approach yields satisfactory results for many\nPSfrag\nreplacements\napplications\nin mask design it introduces errors inversely proportional to the distance of the features.\n\nEinc\n\nEinc\n\nEinc\n(k)\n\n\u01eb, E\n\n~\n~\n\nE22,sc\n\n(k)\n\u01eb1 , E1\n\n(k)\n\n\u01eb2 , E2\n\n(k)\n\nE11,sc\n\u0393\n\n\u0393\n\n\u0393\n\nFigure 2. Domain decomposition method as discussed in this paper (horizontal setting). For each sub-domain transparent\n(0)\n(0)\nboundary conditions are imposed. Starting with the first sub-domain the field E1 and the scattered field E1,sc to the\nincoming wave Einc are computed. Afterwards the second domain is updated, where the incoming field is now the sum\n(0)\nof the originally incident field Einc and the scattered field E1,sc . This process is iteratively repeated. Observe that the\nzeroth iterate is exactly the method by Adam and Neureuther.\n\nwell analyzed for electrostatic and eddy current problems the application of domain decomposition techniques\nto high frequency Maxwell's equations is still an active research area in the numerics community. Especially,\nfor wave propagation problems it is necessary to impose proper radiation boundary conditions at the coupling\nboundary of the adjacent sub-domains.3, 4 We will detail this issue in the next section. Figure 2 and Figure 3\ngive a rough sketch of the algorithm. In both examples the computational domain is split into two isolated\n(0)\n(0)\nstructures. Starting with the first sub-domain the field E1 and the scattered field E1,sc to the incoming wave\nEinc are computed. Afterwards the second domain is updated, where the incoming field is now the sum of the\n(0)\noriginally incident field Einc and the scattered field E1,sc . This process is iteratively repeated. This approach\n5\nresembles the multiple scattering method. Also observe that the zeroth iterate is exactly the method by Adam\nand Neureuther.\nThe paper is structured as follows. Section 2 is devoted to the modeling of Maxwell's equations and of the domain\ndecomposition iteration. We further summarize various numerical issues such as the definition of transparent\nboundary conditions and casting Maxwell's equations into weak form needed for the finite element method. The\nderivation of a weak form for Maxwell's equations on structured unbounded domains was already discussed in\nour papers,6, 7 but also see the recent paper by Wei et al.8 In section 3 we apply the domain decomposition\nmethod to a medium sized cutout of a mask. The paper ends with some concluding remarks.\n\n2. MODELING\n2.1 Maxwell's equations\nStarting from Maxwell's equations in a medium without sources and free currents and assuming time-harmonic\ndependence with angular frequency \u03c9 > 0 the electric and magnetic fields\n\nmust satisfy\n\ne y, z)e\u2212i\u03c9*t , H(x, y, z, t) = H(x,\ne\nE(x, y, z, t) = E(x,\ny, z)e\u2212i\u03c9*t ,\ne =\n\u2207\u00d7E\ne =\n\u2207\u00d7H\n\ne\ne = 0,\ni\u03c9\u03bcH,\n\u2207 * \u01ebE\ne\ne = 0.\n\u2212i\u03c9\u01ebE,\n\u2207 * \u03bcH\n\n\fEinc\n\nPSfrag replacements\n\nEinc\n\u0393\n\n\u01eb 1 , E1 , H1\n\n\u01eb, E, H\n\n~\n~\n\n\u0393\n\n(k)\n\nE11,sc\n\n(k)\n\nE22,sc\n\n\u0393\n\u01eb 2 , E2 , H2\nFigure 3. Domain decomposition method as discussed in this paper (vertical setting). The notation is given in Figure 2.\n\nHere \u01eb denotes the permittivity tensor and \u03bc denotes the permeability tensor of the materials. In the following we\ne \u2192 E, H\ne \u2192 H. From the equations above we then may derive (by direct substitution)\ndrop the wiggles, so that E\nthe second order equation for the electric field\n\u2207 \u00d7 \u03bc\u22121 \u2207 \u00d7 E \u2212 \u03c9 2 \u01ebE\n\n= 0,\n\n\u2207 * \u01ebE\n\n= 0.\n\nA similar equation holds true for the magnetic field - one only need to replace E by H and interchange \u01eb and\n\u03bc. Observe that any solution to the first equation also meets the divergence condition (second equation). We\ntherefore drop the second equation in the following.\nFor the sake of a simpler and more compact notation we rewrite these equations in differential form,\nd1 \u03bc\u22121 d1 e \u2212 \u03c9 2 \u01ebe =\n\n0.\n\n(1)\n\nA reader not familiar with this calculus may replace the exterior derivatives d0 , d1 , d2 with classical differential\noperators, d0 \u2192 \u2207, d1 \u2192 \u2207\u00d7 and d2 \u2192 \u2207*. Here, the electric field appears as a differential 1-form, e =\nex dx + ey dy + ez dz, whereas the material tensors act \u2013 from a more mathematical point of view \u2013 as operators\n\u01eb, \u03bc : Alt1 \u2192 Alt2 .\nIn the following we drop the sub-indices for the exterior derivatives d0 , d1 , d2 .\n\n2.2 Scattering off an isolated structure\nWe now deal with light scattering off an isolated structure as depicted in Figure 4. The block \u03a9 = [\u2212a, a] \u00d7\n[\u2212b, b]\u00d7 [\u2212c, c] is the computational domain. For simplicity we assume that the computational domain is aligned\nalong the coordinate axes and is embedded into a layered media. The role of the hyperplane \u0393 will be explained\nlater. The incident field Einc is a solution to Maxwell's equations in the layered media. Typically Einc is a plane\nwave traveling in the z-direction scattered at the multi-layer stack. Outside the computational domain the total\nfield is a sum of the incident field and the scattered field Esc , which also is a solution to Maxwell's equations in\nthe layered media outside the computational domain. The interior and exterior fields are linked by the following\ncoupled system,\nd\u03bc\u22121 deint \u2212 \u03c9 2 \u01ebeint\nd\u03bc\u22121 desc \u2212 \u03c9 2 \u01ebesc\n\u03bc\u22121\nint deint\n\neint \u2212 esc\n\u2212 \u03bc\u22121\next desc\n\n= 0,\n= 0,\n\non \u03a9\non R3 \\ \u03a9\n\n= einc , on \u2202\u03a9\n= \u03bc\u22121\non \u2202\u03a9.\next deinc ,\n\n(2a)\n(2b)\n(2c)\n(2d)\n\nThe first two equations are Maxwell's equations for the interior and the scattered field. Equation (2c) and\nequation (2d) assure the tangential continuity of the electric field and the magnetic field respectively.\n\n\fEsc\n\n\u0393\n\nEinc\n\nx\ny\nz\nEsc\nPSfrag replacements\n\nFigure 4. Sketch of a 3D computational domain. The structure is embedded into a multi-layer stack (mask or wafer\nblank). The incoming field Einc is a solution to Maxwell's equation in the layered media. Typically a plane wave traveling\nin the z-direction and scattered at the multi-layer stack is used. Periodic problems can also be dealt with but are not\nspecially detailed in this paper. The plane \u0393 is used in the domain decomposition process. Within this context the\nsketched domain is only a sub-domain of the entire domain. \u0393 separates two regions which are merged in the domain\ndecomposition iteration.\n\n2.3 Domain decomposition iteration\nIn the domain decomposition method the entire computational domain is split into n smaller boxes \u03a9i . Initially,\none starts with one sub-domain and solves the coupled interior-exterior system (2). When updating the subsequent domains we account for the already computed scattered field of the adjacent domains.\nLet us first regard the instructive example as in Figure 5. There the entire domain is split into three sub-domains\naligned in a linear chain. Assume that initially only the scattered field on domain \u03a93 is computed. Next the\nmiddle domain \u03a92 is updated. We solve system (2) where the incident field is now the sum of the original light\nsource field and the scattered field Esc,3 from domain \u03a93 . Since the domain \u03a92 does not contain any scatterer\nthe scattered field Esc,2 from this domain is zero. To update domain \u03a91 now we have to gather all waves which\ntravel through interface \u03931,2 . Obviously, this field consists of the field scattered from domain \u03a93 travelled through\n\u03a92 and the original source light from the illumination system. The key issue here is, that it is not sufficient to\ncompute the scattered field for \u03a92 (which is zero here). We also need to compute the field travelling from one\nparallel interface to the other.\nWe now deal with light scattering off an isolated sub-domain as depicted in Figure 4. We introduce the infinite\nhyperplanes \u0393i,j which separates the two sub-domains \u03a9i and \u03a9j with normal ni,j directed from \u03a9i to \u03a9j , see\nhyperplane \u0393 in Figure 4. We define the restriction of the scattered field esc,i onto the hyperplane\nesc,\u0393i,j = (esc,i )|\u0393i,j .\n(k)\n\nThese data are stored in the domain decomposition iteration, so that in the kth iteration data esc,\u0393i,j are given.\nFor the update step\n(k+1)\n(k)\nesc,\u0393i,j \u2212\u2192 esc,\u0393i,j\n\n\fEsc,3\n\nPSfrag replacements\n\n\u03a91\n\n\u03a92\n\n\u03931,2\n\n\u03a93\n\n\u03932,3\n\nFigure 5. Domain decomposition of the entire domain in three sub-domains aligned in a line. As an instructive example,\nthe middle domain does not contain a scatterer. The field Esc,3 scattered from domain \u03a93 enters the middle domain\nacross the infinite interface \u03932,3 . In the domain decomposition process the field travels through the middle domain and\nhits domain \u03a91 across the interface \u03931,2 .\n\nwe solve the following system on \u03a9i which accounts for propagation through the sub-domains as well as scattering\nwithin the sub-domains\nd\u03bc\u22121 deint \u2212 \u03c9 2 \u01ebeint\nd\u03bc\u22121 desc \u2212 \u03c9 2 \u01ebesc\n\n=\n=\n\n0,\n0,\n\neint \u2212 esc\n\n=\n\neinc + esc,\u0393j,i ,\n\n\u22121\n\u03bc\u22121\nint deint \u2212 \u03bcext desc\n\non \u03a9\non R3 \\ (\u03a9 \u222a \u0393i,* )\n(k)\n\non \u2202\u03a9 \u2229 \u0393i,j\n\n(k)\n\u22121\n\u03bcext\ndesc,\u0393j,i ,\n\n=\n\n\u03bc\u22121\next deinc +\n\nesc,\u2212 \u2212 esc,+\n\n=\n\n(k)\nesc,\u0393j,i ,\n\n\u22121\n\u03bc\u22121\next desc,\u2212 \u2212 \u03bcext desc,+\n\n=\n\n\u03bc\u22121\next desc,\u0393j,i ,\n\n(k)\n\n(3a)\n(3b)\n\non \u2202\u03a9 \u2229 \u0393i,j\n\non \u0393i,j \\ \u2202\u03a9\n\n(3c)\n(3d)\n(3e)\n\non \u0393i,j \\ \u2202\u03a9.\n\n(3f)\n\nWith equation (3b) the so defined scattered field esc meets Maxwell's equations in the exterior domain but may\njump across the hyperplanes \u0393i,j . For each hyperplane \u0393i,j the jump is defined in equations (3c), (3e) and is\nequal to the scattered field of the corresponding adjacent domain. On \u0393i,j the quantity esc,+ is the field limit in\nthe ni,j -direction and esc,\u2212 is the field limit in the opposite direction. As the update step we now define\n(k+1)\n\nesc,\u0393i,j = (esc,+ )|\u0393i,j .\nFrom equations (3c) and (3d) one shows that under convergence of the iteration the field continuity across\n\u0393i,j \u2229 \u2202\u03a9 is satisfied. Hence the so merged field satisfies Maxwell's equations on the entire domain.\n\n2.4 Weak formulation\nTo apply the finite element method we need to transform the linear systems used in the previous section to\na so called weak form. The incorporation of the various jump conditions in system (3) is very technical, but\nfits seamless into the finite element framework. We exemplify this only for the simpler system of equations (2).\nThe treatment of the system (3) will be commented at the end of sub-section 2.5. In order to derive a weak\nformulation we define the following function space on the domain \u03a9 = R3\n\b\nHloc (curl) =\ne \u2208 Alt1 | (ex , ey , ez ) \u2208 (L2loc )3 , \u2207 \u00d7 (ex , ey , ez )T \u2208 (L2loc )3 .\n\nThe weak form of equations (1) now reads\nZ\n\u0001\n\u03bc\u22121 de \u2227 dv \u2212 \u03c9 2 (\u01ebe) \u2227 v =\nR3\n\n0\n\n(4)\n\n\ffor all v \u2208 Hloc (curl) with compact support. We now look for a variational formulation, where the incoming\nfield only appears on the right hand side. To do that let us denote the computational domain by \u03a9 and split\nMaxwell's equations (4) into an interior and exterior part,\nZ\nZ\n\u0001\n\u0001\n\u03bc\u22121 desc \u2227 dv \u2212 \u03c9 2 (\u01ebesc ) \u2227 v =\n\u03bc\u22121 deint \u2227 dv \u2212 \u03c9 2 (\u01ebeint ) \u2227 v +\n\u03a9\nR3 \\\u03a9\nZ\n\u0001\n\u2212\n\u03bc\u22121 deinc \u2227 dv \u2212 \u03c9 2 (\u01ebeinc ) \u2227 v\nR3 \\\u03a9\n\n(eint \u2212 einc )|\u2202\u03a9\nApplying a partial integration on the right hand yields\nZ\nZ\n\u0001\n\u0001\n\u03bc\u22121 desc \u2227 dv \u2212 \u03c9 2 (\u01ebesc ) \u2227 v =\n\u03bc\u22121 deint \u2227 dv \u2212 \u03c9 2 (\u01ebeint ) \u2227 v +\n\u03a9\n\nR3 \\\u03a9\n\n(eint \u2212 einc )|\u2202\u03a9\n\n=\n\n=\nZ\n\n(esc )|\u2202\u03a9 .\n\n\u03bc\u22121 deinc \u2227 v\n\n\u2202\u03a9\n\n(esc )|\u2202\u03a9 .\n\n\u0001\n\n(5a)\n(5b)\n\nOn the left hand side we find the quantities of interest we want to compute, namely the total field in the interior\neint and the scattered field esc in the exterior. The second equation (5b) merges the scattered and the interior\nfield. After introducing transparent boundary conditions we will explain how to incorporate this field data\nmatching condition (5b) into a variational formulation\n\n2.5 Transparent boundary condition (PML)\nSo far, in all considerations the various scattering problems were posed on the entire domain R3 and are therefore\nnumerically not feasible. This is overcome by using transparent boundary conditions. We use the perfectly\nmatched layer method introduced by Berenger.9 This method exploits the analytic continuation properties of\nthe scattered field in the exterior domain. In a nutshell using an appropriate complex continuation, the scattered\nfield is transformed to an exponentially decaying field without affecting the matching condition with the field in\nthe interior domain. In an earlier paper we proposed an extremely efficient adaptive PML method which also\ncopes with non cubic domains and various kinds of inhomogeneous exterior domains.6, 7 For simplicity, in this\npaper we restrict ourselves to cubic domains embedded into an layered media. Let us regard the computational\ndomain \u03a9 = [\u2212a, a] \u00d7 [\u2212b, b] \u00d7 [\u2212c, c] in Figure 4. To derive the PML equation we use different coordinate\nstretchings in each coordinate direction,10 e.g.\n\uf8f1\nx>a\n\uf8f2 a + \u03b3(x \u2212 a),\nx,\n|x| \u2264 a .\nx\u03b3 =\n\uf8f3\n\u2212a + \u03b3(x + a), x < \u2212a\n\nThe definitions for the y and z-directions are accordingly. For a complex coordinate stretching \u03b3 is a complex\nnumber with R\u03b3 = 1.0 and I\u03b3 > 0.0. But firstly we consider \u03b3 as a real number. Then stretching the coordinates\nis a simple coordinate transformation. In the differential form calculus, when switching the coordinates, the\ndifferential forms (field data) and the operators \u01eb and \u03bc are transformed accordingly. Subscribing \u03b3 to the\ntransformed quantities equation (5) yields\nZ\nZ\nZ\n\u0001\n\u0001\n\u0001\n\u22121\n2\n2\n\u22121\n\u03bc\u22121 deinc \u2227 v\n\u03bc\u03b3 desc,\u03b3 \u2227 dv\u03b3 \u2212 \u03c9 (\u01ebesc,\u03b3 ) \u2227 v\u03b3\n=\n\u03bc deint \u2227 dv \u2212 \u03c9 (\u01ebeint ) \u2227 v +\n\u03a9\n\nR3 \\\u03a9\n\n\u2202\u03a9\n\n(eint \u2212 einc )|\u2202\u03a9\n\n= (esc,\u03b3 )|\u2202\u03a9 .\n\nThis equation is identical to (5) but only the transformed quantities are used. Since the test function v is chosen\narbitrarily we can avoid using the transformed field and replace v\u03b3 by v without changing the variational form.\nNow we switch to a complex coordinate stretching. Since the equation above holds true for any real \u03b3 and due\nto the holomorphy of the scattered field esc it is a simple matter of complex function theory that the above\nequations also hold true for \u03b3 chosen complex. We now want to incorporate the matching condition on the\nboundary \u2202\u03a9 into the variational form. At the boundary \u2202\u03a9 the interior field eint and the scattered field esc,\u03b3\n\n\fdiffer by the field values of the incident field. We therefore add a field with tangential data equal to einc on the\nboundary \u2202\u03a9 and which has local support in the exterior domain R3 \\ \u03a9. Since this field interpolates the data\nof the incident field on the boundary we denote it by Ieinc . In the finite element context I is the boundary\ninterpolation operator. With the definition e\ne = eint + esc,\u03b3 + Ieinc we get the variational formulation\nZ\n\u0001\n\u03bc\u22121 de\ne \u2227 dv \u2212 \u03c9 2 (\u01ebe\ne) \u2227 v = finc [v]\n(6)\n\u03a9\n\nwith\nfinc [v] = \u2212\n\nZ\n\n\u03a9I\n\n\u0001\n\u03bc\u22121 dIeinc \u2227 dv \u2212 \u03c9 2 (\u01ebIeinc ) \u2227 v +\n\nZ\n\n\u2202\u03a9\n\n\u0001\n\u03bc\u22121 deinc \u2227 v .\n\nHere, \u03a9I denotes the finite support of Ieinc . Hence on the right hand side only data of the incident field around\nthe boundary \u2202\u03a9 of the computational domain are involved. Truncating the exterior domain this variational\nform is suitable for a finite element discretization. In the following we again drop the wiggles.\nAs we mentioned above deriving the weak form for the system used in the domain decomposition iteration (3) is\nmore tedious. In this case interior boundary conditions on the infinite hyperplanes \u0393i,j must be treated. After\ndefining the transparent boundary conditions by the PML method these jump conditions are imposed within the\nPML sponge layer. Since the effect of the artificial interior boundaries vanishes with convergence of the iterative\nprocess the transparent boundary conditions on these interfaces only require less accuracy. Even approximate\ntransparent boundary conditions can be used.\n\n3. NUMERICAL EXAMPLE: PERIODIC 3D MASK\nIn this section we apply the domain decomposition method to a 3D mask cutout given in Figure 6. The structure\nconsists of MoSi-lines of height h = 65.4nm on a glass substrate. Here, the sidewall angle of the lines is 90deg,\nbut other sidewall angle parameter can be treated without extra costs. Further material values are given in\nthe description to Figure 6. We simulated the mask with high order finite elements of order 5 and 6. Using\nfinite element degree 5 (1.6 million unknowns) it was still possible to compute the solution with the direct\nmethod PARDISO.11 A comparison of the domain decomposition method and the direct method shows a good\nagreement. After five iterations the domain decomposition method with 16 vertical sub-domains converged to\nthe exact solution up to an error of 10\u22125 in the complex amplitudes of the diffraction modes. The required\nmemory was reduced by a factor of 3 (from 71GB to 25GB). On our computer it was not possible to compute\nthe solution to finite element degree 6 by a direct sparse LU method due to limited memory resources. However,\nthe convergence rate of the domain decomposition method was not affected when increasing the finite element\ndegree from 5 to 6. This way we were able to solve the linear system with more than 3.3 million of unknowns.\nHowever with 50GB needed RAM the memory requirements are still demanding. To reduce further the memory\ndemand it seems promising to split the domains also in the horizontal direction, which will be done in future\nwork. In Figure 7 the computed near fields for an perpendicular incidence of x\u2212 and y\u2212 polarized light is plotted\nin a distance of 15nm above the structure.\n\n4. CONCLUSIONS\nWe have proposed a new rigorous domain decomposition method for Maxwell's equations. This method allows\nfor the reduction of needed computer resources. Especially it is possible to reduce significantly the amount of\nneeded memory. Is has been shown that the method converges to the exact (discrete) finite element solution\nwhich corresponds to a large scale linear system of equations. The convergence rate behaviour is currently under\ninvestigation.\n\nREFERENCES\n[1] K. Adam and A. R. Neureuther, \"Simplified models for edge transitions in rigorous mask modeling,\" in Proc.\nSPIE Vol. 4346, p. 331-344, Optical Microlithography XIV, Christopher J. Progler; Ed., C. J. Progler, ed.,\nPresented at the Society of Photo-Optical Instrumentation Engineers (SPIE) Conference 4346, pp. 331\u2013344,\nSept. 2001.\n\n\fy\n\nx\nPSfrag replacements\n\nFigure 6. Simulated mask cutout. The mask consists of MoSi-lines with refractive index nMoSi = 2.52 + 0.596i and height\nh = 65.4nm. The dimension of the computational domain is 1.3\u03bcm \u00d7 2.5\u03bcm. The refractive index of the glass substrate\nis ng = 1.5306.\n\ny\n\nPSfrag replacements\nx\nFigure 7. Near field amplitudes in a distance of 15nm above the structure. The incident field is a plane wave with a\nvacuum wavelength \u03bb = 193nm. For the left pseudo-color plot the incident field is x-polarized and for the right one the\nincident field is y \u2212 polarized.\n\n\f[2] A. Quarteroni, Domain Decomposition Methods for Partial Differential Equations, Clarendon Press, Oxford,\n1999.\n[3] L. Zschiedrich, S. Burger, A. Sch\u00e4dle, and F. Schmidt, \"Domain decomposition method for electromagnetic\nscattering problems: application to EUV lithography,\" pp. 55\u201356, Numerical Simulation of Optoelectronic\nDevices (NUSOD), 2005.\n[4] A. Sch\u00e4dle, L. Zschiedrich, S. Burger, R. Klose, and F. Schmidt, \"Domain Decomposition Method for\nMaxwells Equations: Scattering off Periodic Structures,\" J. Comput. Phys. 226, pp. 477\u2013493, 2007.\n[5] P. Martin, Multiple Scattering: Interaction of Time-Harmonic Waves with N Obstacles, Cambridge University Press, 2006.\n[6] L. Zschiedrich, S. Burger, R. Klose, A. Schdle, and F. Schmidt, \"JCMmode: an adaptive finite element\nsolver for the computation of leaky modes,\" in Integrated Optics: Devices, Materials, and Technologies IX,\nY. Sidorin and C. A. W\u00e4chter, eds., 5728, pp. 192\u2013202, Proc. SPIE, 2005.\n[7] L. Zschiedrich, S. Burger, B. Kettner, and F. Schmidt, \"Advanced finite element method for nanoresonators,\" in Physics and Simulation of Optoelectronic Devices XIV, M. Osinski et al., ed., 6115, pp. 164\u2013\n174, Proc. SPIE, 2006.\n[8] X. Wei, A. Wachters, and H. Urbach, \"Finite-element model for three-dimensional optical scattering problems,\" J. Opt. Soc. Am. A 24, 2007.\n[9] J.-P. B\u00e9renger, \"A perfectly matched layer for the absorption of electromagnetic waves,\" J. Comput.\nPhys. 114(2), pp. 185\u2013200, 1994.\n[10] W. C. Chew and W. H. Weedon, \"3D perfectly matched medium from modified Maxwells equations with\nstretched coordinates,\" Microwave Opt. Technol. Lett , 1994.\n[11] O. Schenk and K. G\u00e4rtner, \"Solving unsymmetric sparse systems of linear equations with PARDISO,\"\nJournal of Future Generation Computer Systems 20(3), pp. 475\u2013487, 2004.\n\n\f"}