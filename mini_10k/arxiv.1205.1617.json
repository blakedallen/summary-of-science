{"id": "http://arxiv.org/abs/1205.1617v1", "guidislink": true, "updated": "2012-05-08T07:55:04Z", "updated_parsed": [2012, 5, 8, 7, 55, 4, 1, 129, 0], "published": "2012-05-08T07:55:04Z", "published_parsed": [2012, 5, 8, 7, 55, 4, 1, 129, 0], "title": "A multivariate piecing-together approach with an application to\n  operational loss data", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1205.3831%2C1205.3113%2C1205.0008%2C1205.3974%2C1205.1562%2C1205.0421%2C1205.0739%2C1205.2277%2C1205.0664%2C1205.3132%2C1205.3153%2C1205.0775%2C1205.4058%2C1205.0768%2C1205.0153%2C1205.3639%2C1205.3606%2C1205.1472%2C1205.4217%2C1205.3392%2C1205.0910%2C1205.0286%2C1205.4413%2C1205.0397%2C1205.2485%2C1205.0099%2C1205.2709%2C1205.4241%2C1205.3061%2C1205.0115%2C1205.3010%2C1205.1327%2C1205.3352%2C1205.0799%2C1205.1117%2C1205.0869%2C1205.0570%2C1205.2300%2C1205.2389%2C1205.2813%2C1205.3763%2C1205.3354%2C1205.4135%2C1205.2382%2C1205.3467%2C1205.3810%2C1205.0253%2C1205.1217%2C1205.2078%2C1205.0302%2C1205.3275%2C1205.2755%2C1205.4184%2C1205.2317%2C1205.1352%2C1205.2001%2C1205.3400%2C1205.0964%2C1205.3889%2C1205.2677%2C1205.4225%2C1205.4169%2C1205.0149%2C1205.2232%2C1205.2158%2C1205.4212%2C1205.3196%2C1205.1712%2C1205.0590%2C1205.2857%2C1205.0152%2C1205.2776%2C1205.3979%2C1205.1328%2C1205.2421%2C1205.0807%2C1205.4107%2C1205.2290%2C1205.0777%2C1205.2716%2C1205.2708%2C1205.0922%2C1205.2124%2C1205.1641%2C1205.0184%2C1205.2601%2C1205.4088%2C1205.1249%2C1205.0445%2C1205.1802%2C1205.0920%2C1205.0014%2C1205.0454%2C1205.4153%2C1205.1783%2C1205.1617%2C1205.3147%2C1205.3809%2C1205.2276%2C1205.0901%2C1205.3862&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A multivariate piecing-together approach with an application to\n  operational loss data"}, "summary": "The univariate piecing-together approach (PT) fits a univariate generalized\nPareto distribution (GPD) to the upper tail of a given distribution function in\na continuous manner. We propose a multivariate extension. First it is shown\nthat an arbitrary copula is in the domain of attraction of a multivariate\nextreme value distribution if and only if its upper tail can be approximated by\nthe upper tail of a multivariate GPD with uniform margins. The multivariate PT\nthen consists of two steps: The upper tail of a given copula $C$ is cut off and\nsubstituted by a multivariate GPD copula in a continuous manner. The result is\nagain a copula. The other step consists of the transformation of each margin of\nthis new copula by a given univariate distribution function. This provides,\naltogether, a multivariate distribution function with prescribed margins whose\ncopula coincides in its central part with $C$ and in its upper tail with a GPD\ncopula. When applied to data, this approach also enables the evaluation of a\nwide range of rational scenarios for the upper tail of the underlying\ndistribution function in the multivariate case. We apply this approach to\noperational loss data in order to evaluate the range of operational risk.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1205.3831%2C1205.3113%2C1205.0008%2C1205.3974%2C1205.1562%2C1205.0421%2C1205.0739%2C1205.2277%2C1205.0664%2C1205.3132%2C1205.3153%2C1205.0775%2C1205.4058%2C1205.0768%2C1205.0153%2C1205.3639%2C1205.3606%2C1205.1472%2C1205.4217%2C1205.3392%2C1205.0910%2C1205.0286%2C1205.4413%2C1205.0397%2C1205.2485%2C1205.0099%2C1205.2709%2C1205.4241%2C1205.3061%2C1205.0115%2C1205.3010%2C1205.1327%2C1205.3352%2C1205.0799%2C1205.1117%2C1205.0869%2C1205.0570%2C1205.2300%2C1205.2389%2C1205.2813%2C1205.3763%2C1205.3354%2C1205.4135%2C1205.2382%2C1205.3467%2C1205.3810%2C1205.0253%2C1205.1217%2C1205.2078%2C1205.0302%2C1205.3275%2C1205.2755%2C1205.4184%2C1205.2317%2C1205.1352%2C1205.2001%2C1205.3400%2C1205.0964%2C1205.3889%2C1205.2677%2C1205.4225%2C1205.4169%2C1205.0149%2C1205.2232%2C1205.2158%2C1205.4212%2C1205.3196%2C1205.1712%2C1205.0590%2C1205.2857%2C1205.0152%2C1205.2776%2C1205.3979%2C1205.1328%2C1205.2421%2C1205.0807%2C1205.4107%2C1205.2290%2C1205.0777%2C1205.2716%2C1205.2708%2C1205.0922%2C1205.2124%2C1205.1641%2C1205.0184%2C1205.2601%2C1205.4088%2C1205.1249%2C1205.0445%2C1205.1802%2C1205.0920%2C1205.0014%2C1205.0454%2C1205.4153%2C1205.1783%2C1205.1617%2C1205.3147%2C1205.3809%2C1205.2276%2C1205.0901%2C1205.3862&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The univariate piecing-together approach (PT) fits a univariate generalized\nPareto distribution (GPD) to the upper tail of a given distribution function in\na continuous manner. We propose a multivariate extension. First it is shown\nthat an arbitrary copula is in the domain of attraction of a multivariate\nextreme value distribution if and only if its upper tail can be approximated by\nthe upper tail of a multivariate GPD with uniform margins. The multivariate PT\nthen consists of two steps: The upper tail of a given copula $C$ is cut off and\nsubstituted by a multivariate GPD copula in a continuous manner. The result is\nagain a copula. The other step consists of the transformation of each margin of\nthis new copula by a given univariate distribution function. This provides,\naltogether, a multivariate distribution function with prescribed margins whose\ncopula coincides in its central part with $C$ and in its upper tail with a GPD\ncopula. When applied to data, this approach also enables the evaluation of a\nwide range of rational scenarios for the upper tail of the underlying\ndistribution function in the multivariate case. We apply this approach to\noperational loss data in order to evaluate the range of operational risk."}, "authors": ["Stefan Aulbach", "Verena Bayer", "Michael Falk"], "author_detail": {"name": "Michael Falk"}, "author": "Michael Falk", "links": [{"title": "doi", "href": "http://dx.doi.org/10.3150/10-BEJ343", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1205.1617v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1205.1617v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "Published in at http://dx.doi.org/10.3150/10-BEJ343 the Bernoulli\n  (http://isi.cbs.nl/bernoulli/) by the International Statistical\n  Institute/Bernoulli Society (http://isi.cbs.nl/BS/bshome.htm)", "arxiv_primary_category": {"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-fin.RM", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "stat.TH", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1205.1617v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1205.1617v1", "journal_reference": "Bernoulli 2012, Vol. 18, No. 2, 455-475", "doi": "10.3150/10-BEJ343", "fulltext": "arXiv:1205.1617v1 [math.ST] 8 May 2012\n\nBernoulli 18(2), 2012, 455\u2013475\nDOI: 10.3150/10-BEJ343\n\nA multivariate piecing-together approach with\nan application to operational loss data\nSTEFAN AULBACH1,* , VERENA BAYER2 and MICHAEL FALK1,**\n1\n\nInstitute of Mathematics, Emil-Fischer-Str. 30, D-97074 W\u00fcrzburg, Germany.\nE-mail: * stefan.aulbach@uni-wuerzburg.de; ** michael.falk@uni-wuerzburg.de\n2\nChair of Econometrics, Sanderring 2, D-97070 W\u00fcrzburg, Germany.\nE-mail: verena.bayer@uni-wuerzburg.de\nThe univariate piecing-together approach (PT) fits a univariate generalized Pareto distribution\n(GPD) to the upper tail of a given distribution function in a continuous manner. We propose\na multivariate extension. First it is shown that an arbitrary copula is in the domain of attraction\nof a multivariate extreme value distribution if and only if its upper tail can be approximated by\nthe upper tail of a multivariate GPD with uniform margins.\nThe multivariate PT then consists of two steps: The upper tail of a given copula C is cut\noff and substituted by a multivariate GPD copula in a continuous manner. The result is again\na copula. The other step consists of the transformation of each margin of this new copula by\na given univariate distribution function.\nThis provides, altogether, a multivariate distribution function with prescribed margins whose\ncopula coincides in its central part with C and in its upper tail with a GPD copula.\nWhen applied to data, this approach also enables the evaluation of a wide range of rational\nscenarios for the upper tail of the underlying distribution function in the multivariate case. We\napply this approach to operational loss data in order to evaluate the range of operational risk.\nKeywords: copula; domain of multivariate attraction; GPD copula; multivariate extreme value\ndistribution; multivariate generalized Pareto distribution; operational loss; peaks over\nthreshold; piecing together\n\n1. Introduction\nThe peaks over threshold approach (POT) shows that the upper tail of a univariate distribution function F can reasonably be approximated only by that of a generalized Pareto\ndistribution (GPD). This result goes back to Balkema and de Haan [2] and Pickands [30].\nA univariate GPD W is derived from an extreme value distribution (EVD) G by the\nequality\nW (x) = 1 + log(G(x)),\n\n1/e \u2264 G(x),\n\nThis is an electronic reprint of the original article published by the ISI/BS in Bernoulli,\n2012, Vol. 18, No. 2, 455\u2013475. This reprint differs from the original in pagination and\ntypographic detail.\n1350-7265\n\nc\n\n2012 ISI/BS\n\n\f2\n\nS. Aulbach, V. Bayer and M. Falk\n\nwhere, with a shape parameter \u03b1 > 0, the family of standardized EVD is given by\nG1,\u03b1 (x) = exp(\u2212x\u2212\u03b1 ),\n\nx > 0,\n\n\u03b1\n\nG2,\u03b1 (x) = exp(\u2212(\u2212x) ),\nG3 (x) = exp(\u2212e\u2212x ),\n\nx \u2264 0,\n\n(1)\n\nx \u2208 R,\n\nbeing the Fr\u00e9chet, (reverse) Weibull and Gumbel case of an EVD.\nThe family of univariate standardized GPD is, consequently, given by\nW1,\u03b1 (x) = 1 \u2212 x\u2212\u03b1 ,\n\nx \u2265 1,\n\u03b1\n\nW2,\u03b1 (x) = 1 \u2212 (\u2212x) ,\nW3 (x) = 1 \u2212 exp(\u2212x),\n\n\u22121 \u2264 x \u2264 0,\nx \u2265 0,\n\nbeing the Pareto, beta and exponential case of a GPD.\nIf X is a univariate random variable with distribution function F , then the distribution\nfunction F [x0 ] of X, conditional on the event X > x0 , is given by\nF [x0 ] (x) = P (X \u2264 x | X > x0 )\n=\n\nF (x) \u2212 F (x0 )\n,\n1 \u2212 F (x0 )\n\nx \u2265 x0 ,\n\nwhere we require F (x0 ) < 1. The POT approach shows that F [x0 ] can reasonably be approximated only by a GPD with appropriate shape, location and scale parameter W\u03b3,\u03bc,\u03c3 .\nNote that\nF (x) = (1 \u2212 F (x0 ))F [x0 ] (x) + F (x0 )\n\u2248 (1 \u2212 F (x0 ))W\u03b3,\u03bc,\u03c3 (x) + F (x0 ),\n\nx \u2265 x0 .\n\nThe piecing together approach (PT) now consists in replacing the distribution function F\nby\n\u001a\nF (x),\nx < x0 ,\n\u2217\nFx0 (x) =\n(2)\n(1 \u2212 F (x0 ))W\u03b3,\u03bc,\u03c3 (x) + F (x0 ),\nx \u2265 x0 ,\nwhere the shape, location and scale parameters \u03b3, \u03bc, \u03c3 of the GPD are typically estimated\nfrom given data. This modification aims at a more precise investigation of the upper end\nof the data.\nReplacing F in (2) by the empirical distribution function F\u0302n of n independent copies\nof X offers in particular a semi-parametric approach to the estimation of high quantiles F \u22121 (q) = inf{t \u2208 R: F (t) \u2265 q} outside the range of given data; see, for example,\nSection 2.3 of Reiss and Thomas [33].\nIn this paper we propose an extension of the PT in (2) to higher dimensions. When\napplied to data, this approach also enables the evaluation of a wide range of rational\n\n\fMultivariate piecing-together\n\n3\n\nscenarios for the upper tail of the underlying distribution function in the multivariate\ncase. This will be exemplified in Section 4 for operational loss data, where we simulate\ndifferent scenarios for risk parameters such as the value at risk or the expected shortfall.\nIn Section 2 we provide the basic mathematics for our PT approach. We will show that\nan arbitrary copula can reasonably be approximated in its upper tail only by a GPD\nwith uniform margins.\nThe multivariate PT approach, which will be established in Section 3, now consists of\ntwo steps:\n(i) The upper tail of a given m-dimensional copula C is cut off and substituted by\nthe upper tail of multivariate GPD copula in a continuous manner such that the result\nis again a copula.\n(ii) The other step consists of the transformation of each margin of this new copula\nby a given univariate distribution function Fi\u2217 , 1 \u2264 i \u2264 m.\nThis provides, altogether, a multivariate distribution function with prescribed margins Fi\u2217 , whose copula coincides in its central part with C and in its upper tail with\na GPD copula. In Section 4.2 we will simulate the effects that the combination of univariate and multivariate PT has on quantile functions and mean excess functions or, in\nterms of risk analysis, on value at risk and expected shortfall. It turns out that in our\nspecific model, which will be specified in Section 4, the application of the multivariate\nPT approach leads to a rising expected shortfall while the value at risk keeps (up to\na level of 99.9%) nearly unchanged.\nInstead of fitting a GPD to the upper tail of a distribution, estimation of rare events in\nthe multivariate case can also be based on the fact that the exponent measure pertaining\nto a multivariate GPD is homogeneous; see de Haan and Sinha [11] and de Haan and\nRonde [9] for details.\nFor recent accounts of basic and advanced topics of extreme value theory and statistics,\nsee the monographs by Reiss and Thomas [33], de Haan and Ferreira [10] and Resnick [34].\n\n2. Multivariate GPD\nIn this section we provide the mathematics underlying our PT approach, which will be\nestablished in Section 3.\nLet F be an arbitrary m-dimensional distribution function that is in the domain of\nattraction of an m-dimensional EVD G; that is, there exist norming constants an > 0,\nbn \u2208 Rm such that\nF n (an x + bn ) \u2192 G(x),\nn\u2192\u221e\n\nx \u2208 Rm ,\n\n(3)\n\nwhere all operations on vectors are meant componentwise. The distribution function G\nis max stable; that is, there exist norming constants cn > 0, dn \u2208 Rm with\nGn (cn x + dn ) = G(x),\n\nx \u2208 Rm .\n\nThe one-dimensional margins Gi of G are up to scale and location parameters univariate\nEVD in (1).\n\n\f4\n\nS. Aulbach, V. Bayer and M. Falk\n\nIt is well known that (3) is equivalent with convergence of the univariate margins\ntogether with convergence of the copulas\n\u22121\nlim CFn (u1/n ) = CG (u) = G(G\u22121\n1 (u1 ), . . . , Gm (um )),\n\nn\u2192\u221e\n\nu \u2208 (0, 1)m ,\n\n(4)\n\n(Deheuvels [12, 13], Galambos [19]). For a recent account on copulas, see Nelsen [29].\nSome elementary computations as in Falk [16], Section 6, or de Haan and Ronde [9],\nSection 4.2, entail that convergence (4) is equivalent with\n1\nlim (1 \u2212 CF (1 + tx)) = lG (x) := \u2212 log(CG (exp(x))),\nt\u21930 t\n\nx \u2264 0,\n\n(5)\n\nwhere lG is known as the stable tail dependence function introduced by Huang [22]. For\na detailed discussion of the stable tail dependence function, see Beirlant et al. [3]. The\nstable tail dependence function is homogeneous tlG (x) = lG (tx), t \u2265 0, and, thus, (5)\nbecomes\n1 \u2212 CF (1 + tx) \u2212 lG (tx)\n\u2192t\u21930 0.\nt\nObserve that lG (x) = 1 \u2212 H(x), x \u2264 0, where H is a multivariate GP function with\nuniform margins Hi (x) = 1 + x, x \u2264 0, i \u2264 m; that is,\ne\nH(x) = 1 + log(G(x)),\n\nx \u2264 0,\n\nW (x) = 1 + log(G(x)),\n\nx \u2265 x0 .\n\ne is a multivariate EVD with negative exponential margins G\ne i (x) = exp(x), x \u2264 0,\nand G\ni \u2264 m.\nWe call in general an m-dimensional distribution function W a multivariate GPD if\nits upper tail coincides with a GP function; that is, there exist a multivariate EVD G\nand a vector x0 \u2208 Rm with G(x0 ) < 1 such that\n(6)\n\nNote that H(x) = 1 + log(G(x)), G(x) \u2265 1/e, does not define a distribution function\nunless m \u2208 {1, 2}; see Michel [27], Theorem 6. We, therefore, call H a GP function. It\nis, actually, a quasi-copula (Alsina et al. [1], Genest et al. [20] and Section 5.1 in Falk\net al. [17]). Lemma 5.1.5 in Falk et al. [17] implies, on the other hand, that for any GP\nfunction there exists a distribution function W satisfying (6).\nThe preceding considerations together with elementary computations entail now the\nfollowing characterization of domains of attraction in terms of a GPD. By k * k we denote\nan arbitrary norm on Rm .\nTheorem 2.1. An arbitrary distribution function F is in the domain of attraction of\na multivariate EVD G if and only if this is true for the univariate margins and if there\nexists a GPD W with ultimately uniform margins Wi (x) = 1 + x, x0 \u2264 x \u2264 0, i \u2264 m, such\nthat\nCF (y) = W (y \u2212 1) + o(ky \u2212 1k)\nuniformly for y \u2208 [0, 1]m .\n\n\fMultivariate piecing-together\n\n5\n\nWe have the following equivalences for an arbitrary copula C to lie in the domain of\nattraction of an EVD.\nCorollary 2.2. C is in the domain of attraction of an EVD G\n\u21d0\u21d2 There exists a GPD W with ultimately uniform margins such that\nC(y) = W (y \u2212 1) + o(ky \u2212 1k),\nuniformly for y \u2208 [0, 1]m . In this case W (x) = 1 + log(G(x)), x0 \u2264 x \u2264 0 \u2208 Rm .\n\u21d0\u21d2 There exists a norm k * kD on Rm such that\nC(y) = 1 \u2212 ky \u2212 1kD + o(ky \u2212 1kD ),\nuniformly for y \u2208 [0, 1]m . In this case G(x) = exp(\u2212kxkD ), x \u2264 0.\nRecall that all norms on Rm are equivalent and, thus, o(ky \u2212 1kD ) in the second\nequivalence above can be substituted by o(ky \u2212 1k) with an arbitrary norm k * k on Rm .\nThe preceding results show that the upper tail of the copula CF of a distribution\nfunction F can reasonably be approximated only by that of a GPD W with ultimately\nuniform margins. To the best of our knowledge, this provides new insight into the significance of multivariate GPD. But it is in accordance with Rootz\u00e9n and Tajvidi [35], who\nshowed that, in the multivariate case, modelling exceedances of a random variable over\na high threshold can rationally be done only by a multivariate GPD.\nProof of Corollary 2.2. It is well known that a GPD W with ultimately uniform\nmargins can be written as\nW (x) = 1 \u2212 kxkD ,\n\nx0 \u2264 x \u2264 0,\n\nwhere k * kD is a norm on Rm with particular properties, called a D-norm; see Section 4.4\nin Falk et al. [17]. In particular, G(x) = exp(\u2212kxkD ), x \u2264 0, defines an EVD on Rm . If\nC(y) = W (y \u2212 1) + o(ky \u2212 1k), y \u2208 [0, 1]m , for some norm k * k on Rm , then\n\u0012\n\u0013\n\u0012\n\u0012\n\u0013\u0013n\ny\n1\n1\nn\nC 1+\n=\n1 \u2212 kykD + o\nkyk\nn\nn\nn\n\u2192 exp(\u2212kykD ) = G(y),\n\nn\u2192\u221e\n\ny \u2264 0.\n\nTogether with Theorem 2.1 this implies Corollary 2.2.\n\n\u0003\n\nIn the final equivalence of Corollary 2.2, the norm can obviously be computed as\nkxkD = lim\nt\u21930\n\n1 \u2212 C(1 + tx)\n= l(x),\nt\n\nx \u2264 0;\n\nthat is, it is the stable tail dependence function. It turns out that any stable tail dependence function is actually a norm. This explains why it is a convex function and\nhomogeneous of order one.\n\n\f6\n\nS. Aulbach, V. Bayer and M. Falk\n\nExample 2.3. Take an arbitrary Archimedean copula\nC\u03c6 (u) = \u03c6\u22121 (\u03c6(u1 ) + * * * + \u03c6(um )),\nwhere the generator \u03c6 : (0, \u221e) \u2192 [0, \u221e) is a continuous function that is strictly decreasing\non (0, 1], \u03c6(1) = 0, limx\u21930 \u03c6(x) = \u221e and \u03c6\u22121 (t) = inf{x > 0: \u03c6(x) \u2264 t}, t \u2265 0.\nNote that C\u03c6 is not automatically a copula for each function \u03c6: (0, \u221e) \u2192 [0, \u221e) as\nabove. While, in the bivariate case m = 2, convexity of \u03c6\u22121 is a necessary and sufficient condition, this is no longer true in higher dimension m \u2265 3. Instead, C\u03c6 is,\nfor general dimension m \u2265 2, a copula if and only if \u03c6\u22121 is differentiable up to order\nm \u2212 2, the derivatives satisfy (\u22121)k (\u03c6\u22121 )(k) (x) \u2265 0, k = 0, . . . , m \u2212 2, x \u2208 (0, \u221e) and\nfurther if (\u22121)m\u22122 (\u03c6\u22121 )(m\u22122) is non-increasing and convex in (0, \u221e); see McNeil and\nNe\u0161lehov\u00e1 [24], Theorem 2.2.\nIf \u03c6 is differentiable from the left in x = 1 with left derivative \u03c6\u2032 (1\u2212) 6= 0, then\nlim\nt\u21930\n\n1 \u2212 C\u03c6 (1 + tx) X\n=\n|xi | = kxk1 ,\nt\n\nx \u2264 0;\n\ni\u2264m\n\nthat is, each Archimedean copula with a generator \u03c6 as above is in the domain of attraction of the EVD G(x) = exp(\u2212kxk1 ), x \u2264 0, with independent margins. The margins\nof C\u03c6 are, therefore, tail independent; that is, the tail dependence parameters vanish:\n\u03c7(i, j) := lim P (Ui > x | Uj > x) = 0,\nx\u21911\n\n1 \u2264 i 6= j \u2264 m,\n\nwhere the random vector (U1 , . . . , Um ) follows the distribution function C\u03c6 . For a discussion of the tail dependence parameter and further literature, see Section 6.1 in Falk\net al. [17].\nThe preceding considerations concern, for example, the Clayton and the Frank copula, which have generators \u03c6C (t) = \u03b8\u22121 (t\u2212\u03b8 \u2212 1) and \u03c6F (t) = \u2212 log((exp(\u2212\u03b8t) \u2212 1)/\n(exp(\u2212\u03b8) \u2212 1)), \u03b8 > 0, but not the Gumbel copula with parameter \u03bb > 1, which has\ngenerator \u03c6G (t) = \u2212(log(t))\u03bb , \u03bb \u2265 1, 0 < t \u2264 1.\nAny multivariate EVD G has univariate EVD margins and any multivariate GPD W\nhas univariate GPD margins in its upper tail. We can transform an arbitrary multivariate\nEVD to an EVD with negative exponential margins by just transforming the margins.\nEqually, we can transform an arbitrary W to a GPD with uniform margins by just transforming the margins. This transformation can also be done backwards; see Section 5.6\nin Falk et al. [17]. We will, therefore, consider in what follows multivariate GPD derived\nfrom an EVD G with negative exponential margins. For a recent account on multivariate\nGPD, see Michel [25].\nFrom the de Haan\u2013Resnick\u2013Pickands representation of a multivariate EVD, it is well\nknown that a function G on (\u2212\u221e, 0]m is the distribution function of an EVD with\nnegative standard exponential margins Gi (x) = exp(x), x \u2264 0, i \u2264 m, if and only if it can\nbe represented as\n\u0012Z\n\u0013\nG(x) = exp\nmin(xi ti )\u03bc(dt) ,\nx \u2264 0,\nSm i\u2264m\n\n\fMultivariate piecing-together\n\n7\n\nP\nwhere \u03bc is a finite measure on Sm := {t \u2265 0:\ni\u2264m ti = 1}, called an angular meaR\nsure, with the characteristic property Sm ti \u03bc(dt) = 1, i \u2264 m; see Section 4.2 in Falk\nR\net al. [17]. Note that this integrability condition on \u03bc implies that \u03bc(Sm ) = Sm 1 d\u03bc =\nR\nR P\nP\ni\u2264m Sm ti \u03bc(dt) = m.\ni\u2264m ti \u03bc(dt) =\nSm\nAs a consequence we obtain that a multivariate GPD W with standard uniform margins\n1 \u2212 Wi (x) = x, i \u2264 m, in a left neighborhood of 0 \u2208 Rm can be represented as\n\u0012X \u0013Z\nxj\nW (x) = 1 +\nmax(x\u0303i ti )\u03bc(dt)\nj\u2264m\n\n=: 1 +\n\n\u0012X\n\nj\u2264m\n\nSm i\u2264m\n\n(7)\n\n\u0013\n\nxj D(x\u03031 , . . . , x\u0303m\u22121 )\n\nP\nP\nfor x0 \u2264 x \u2264 0, where \u03bc is as above, x\u0303i = xi / j\u2264m xj and D: {u \u2208 [0, 1]m\u22121: j\u2264m\u22121 uj \u2264\n1} \u2192 [1/m, 1] is a Pickands dependence function (Section 4.3 in Falk et al. [17]).\nThe following result characterizes a GPD with uniform margins in terms of random\nvariables. It provides an easy way to generate a multivariate GPD, thus extending the\nbivariate approach proposed by Buishand et al. [6] to an arbitrary dimension. Recall that\nan arbitrary multivariate GPD can be obtained from a GPD with ultimately uniform\nmargins by just transforming the margins. For a recent account on simulation techniques\nof multivariate GPD, see Michel [26].\nProposition 2.4.\n(i) Let W be a multivariate GPD with standard uniform margins in a left neighborhood of 0 \u2208 Rm . Then there is a random vector Z = (Z1 , . . . , Zm ) with Zi \u2208 [0, m] and\nE(Zi ) = 1, i \u2264 m, and a vector (\u22121/m, . . . , \u22121/m) \u2264 x0 < 0 such that\n\u0012\n\u0012\n\u0013\n\u0013\n1\n1\nW (x) = P \u2212U\n\u2264x ,\nx0 \u2264 x \u2264 0,\n,...,\nZ1\nZm\nwhere the random variable U is uniformly distributed on (0, 1) and independent of Z.\n(ii) The random vector \u2212U (1/Z1 , . . . , 1/Zm ) follows a GPD with standard uniform\nmargins in a left neighborhood of 0 \u2208 Rm if U is independent of Z = (Z1 , . . . , Zm ) and\n0 \u2264 Zi \u2264 ci a.s. with E(Zi ) = 1, i \u2264 m, for some c1 , . . . , cm \u2265 1.\nNote that the case of a GPD W with arbitrary uniform margins Wi (x) = 1 \u2212 ai x in\na left neighborhood of 0 with arbitrary scaling factors ai > 0, i \u2264 m, immediately follows\nfrom the preceding result by substituting Zi by ai Zi .\nProof of Proposition 2.4. First we establish part (i). From representation (7) we\nobtain that for x in a left neighborhood of 0 \u2208 Rm\n\u0012X \u0013Z\nW (x) = 1 +\nmax(x\u0303i ti )\u03bc(dt)\nxj\nj\u2264m\n\nSm i\u2264m\n\nwith some measure \u03bc on Sm such that \u03bc(Sm ) = m and\n\nR\n\nt \u03bc(dt)\nSm i\n\n= 1, i \u2264 m.\n\n\f8\n\nS. Aulbach, V. Bayer and M. Falk\n\nNow \u03bc\u0303(*) = \u03bc(*)/m defines a probability measure on Sm . Let T = (T1 , . . . , Tm ) be\na random vector with values\nin Sm that has distribution \u03bc\u0303 and put Z := mT. Then\nR\nZ \u2208 [0, m]m and E(Zi ) = Sm ti \u03bc(dt) = 1, i \u2264 m. We have, further, for x \u2264 0 \u2208 Rm with\nxj \u2265 \u22121/m, j \u2264 m,\n\u0013\n\u0013\n\u0012\n\u0012\n1\n1\n\u2264x\n,...,\nP \u2212U\nZ1\nZm\n\u0013\n\u0013\n\u0012\n\u0012\n1\n1\n= P \u2212U\n\u2264 mx\n,...,\nT1\nTm\n\u0013\n\u0013\n\u0012\n\u0012\nZ\n1\n1\n\u2264 mx | T = t (P \u2217 T)(dt)\n,...,\nP \u2212U\n=\nt1\ntm\nSm\n\u0012\n\u0012\n\u0013\n\u0013\nZ\n1\n1\nP \u2212U\n=\n\u2264 mx \u03bc\u0303(dt)\n,...,\nt1\ntm\nSm\n\u0013\n\u0013\n\u0012\n\u0012\nZ\n1\n1\n1\n=\n\u2264 mx \u03bc(dt)\n,...,\nP \u2212U\nm Sm\nt1\ntm\nZ\n\u0010\n\u0011\n1\nP U \u2265 m max(\u2212xi ti ) \u03bc(dt)\n=\ni\u2264m\nm Sm\n\u0012\n\u0012X \u0013\n\u0013\nZ\n1\n=\nP U \u2265 \u2212m\nxj max(x\u0303i ti ) \u03bc(dt)\ni\u2264m\nm Sm\nj\u2264m\n\u0012X \u0013\nZ\n1\n=\n1+m\nxj max(x\u0303i ti )\u03bc(dt)\ni\u2264m\nm Sm\nj\u2264m\n\u0012X \u0013Z\n=1+\nmax(x\u0303i ti )\u03bc(dt).\nxj\nj\u2264m\n\nSm i\u2264m\n\nThis implies part (i) of the proposition.\nOn the other hand, we have for x \u2264 0 and large s > 0\n\u0013\n\u0013s\n\u0012\n\u0012\n1\n1\n1\n\u2264 x\n,...,\nP \u2212U\nZ1\nZm\ns\n\u0013\n\u0013s\n\u0012Z\n\u0012\n1\n=\nP U \u2265 max(\u2212xi zi ) (P \u2217 Z)(dz)\ns i\u2264m\n[0,c]\n\u0012\n\u0013s\nZ\n1\n= 1\u2212\nmax(\u2212xi zi )(P \u2217 Z)(dz)\ns [0,c] i\u2264m\n\u0013\n\u0012 Z\nmax(\u2212xi zi )(P \u2217 Z)(dz)\n\u2192 exp \u2212\ns\u2192\u221e\n\n=: G(x)\nwith c = (c1 , . . . , cm ).\n\n[0,c] i\u2264m\n\n\fMultivariate piecing-together\n\n9\n\nLemma 7.2.1 in Reiss [32] now implies that G is a distribution function that is obviously\nmax stable: Gs (s\u22121 x) = G(x), s > 0; that is, G is a multivariate EVD and has negative\nstandard exponential margins Gi (x) = exp(xE(Zi )) = exp(x), x \u2264 0. As a consequence,\n1 + log(G(x)) is a GP function with\nZ\nmax(\u2212xi zi )(P \u2217 Z)(dz)\n1 + log(G(x)) = 1 \u2212\n[0,c] i\u2264m\n\n\u0012\n\u0012\n\u0013\n\u0013\n1\n1\n= P \u2212U\n\u2264x\n,...,\nZ1\nZm\nfor x0 \u2264 x \u2264 0 and some x0 < 0.\n\n\u0003\n\nLet, for instance, C be an arbitrary m-dimensional copula; that is, C is the distribution function of a random vector S with uniform margins P (Si \u2264 s) = s, s \u2208 (0, 1), i \u2264 m,\n(Nelsen [29]). Then Z := 2S is a proper choice in part (ii) of Proposition 2.4. Proposition 2.4, therefore, maps the set of copulas in a natural way to the set of multivariate\nGPDs, thus opening a wide range of possible scenarios.\nAccording to Theorem 2.1, we call a copula CW a GPD copula on [0, 1]m or simply\na GPD copula if there exists y0 < 1 such that\nCW (y) = W (y \u2212 1),\n\ny0 \u2264 y \u2264 1,\n\nwhere W is a GPD with standard uniform margins in a left neighborhood of zero.\nFor mathematical convenience we temporarily shift a copula to the interval [\u22121, 0]m by\neW from\nshifting each univariate margin by \u22121. Thus we obtain a distribution function C\na GPD copula CW , whose marginal distribution functions are the uniform distribution\neW coincides close to zero with a GPD W as in equation (7); that is,\non [\u22121, 0], and C\nthere exists x0 < 0 such that\neW (x) = W (x1 , . . . , xm )\nC\n\u0012X \u0013Z\n=1+\nxj\nj\u2264m\n\n\u0012\nxi\nmax ti P\n\nSm i\u2264m\n\nj\u2264m xj\n\n\u0013\n\u03bc(dt),\n\nx \u2208 [x0 , 0].\n\neW inherits its properties from the original GPD copula CW , we call C\neW a GPD\nBecause C\nm\ncopula on [\u22121, 0] .\nFor later purposes we remark that a random vector V \u2208 [\u22121, 0]m following a GPD\ncopula on [\u22121, 0]m can easily be generated as follows, using Proposition 2.4. Let U be\nuniformly distributed on (0, 1) and independent of the vector S = (S1 , . . . , Sm ), which\nfollows an arbitrary copula on [0, 1]m . Then we have for i \u2264 m\n\uf8f1\n1\n\u0013 \uf8f4\n\u0012\n\uf8f2 1 + x,\nif \u2212 \u2264 x \u2264 0,\n1\n2\n\u2264x =\nP \u2212U\n1\n1\n\uf8f4\n2Si\n\uf8f3\n,\nif x < \u2212 ,\n4|x|\n2\n= : H(x),\n\nx \u2264 0,\n\n\f10\n\nS. Aulbach, V. Bayer and M. Falk\n\nand, consequently,\n\u0013\n\u0012\n\u0013\n\u0013\n\u0012 \u0012\nU\nU\n\u2212 1, . . . , H \u2212\n\u2212 1 = (V1 , . . . , Vm )\nV := H \u2212\n2S1\n2Sm\nwith\n\n\uf8f1\nU\n\uf8f4\n\uf8f2\u2212\n,\nif U \u2264 Si ,\n2Si\nVi =\n\uf8f4\n\uf8f3 Si \u2212 1,\nif U > Si ,\n2U\nfollows by Proposition 2.4 a GPD copula on [\u22121, 0]m .\n\n(8)\n\n3. Multivariate piecing together\nThe multivariate PT approach consists of two steps. In a first step, the upper tail of\na given m-dimensional copula C is cut off and substituted by the upper tail of multivariate GPD copula in a continuous manner. The result is again a copula, that is, an\nm-dimensional distribution with uniform margins. The other step consists of the transformation of each margin of this copula by a given univariate distribution function Fi\u2217 ,\n1 \u2264 i \u2264 m. This provides, altogether, a multivariate distribution function with prescribed\nmargins Fi\u2217 whose copula coincides in its central part with C and in its upper tail with\na GPD copula.\nWe start with fitting a GPD copula to the upper tail of a given copula C on [\u22121, 0]m .\nRecall that for mathematical convenience we shift any copula C\u0303(u), u \u2208 [0, 1]m , to a copula on [\u22121, 0]m by setting C(v) = C\u0303(1 + v), v \u2208 [\u22121, 0]m .\nLet V = (V1 , . . . , Vm ) follow a GPD copula on [\u22121, 0]m ; that is, P (Vi \u2264 x) = 1 + x,\n\u22121 \u2264 x \u2264 0, is for each i \u2264 m the uniform distribution on [\u22121, 0], and there exists x0 =\n(1)\n(m)\n(x0 , . . . , x0 ) < 0 such that for each x = (x1 , . . . , xm ) \u2208 [x0 , 0]\n\u0012X \u0013 \u0012\n\u0013\nx1\nxm\u22121\nP (V \u2264 x) = 1 +\nxi D P\n,\n,..., P\ni\u2264m xi\ni\u2264m xi\ni\u2264m\n\nwhere D is a Pickands dependence function.\nLet Y = (Y1 , . . . , Ym ) follow an arbitrary copula C on [\u22121, 0]m and suppose that Y is\nindependent of V. Choose a threshold y = (y1 , . . . , ym ) \u2208 [\u22121, 0]m and put\nQi := Yi 1(Yi \u2264yi ) \u2212 yi Vi 1(Yi >yi ) ,\n\ni \u2264 m.\n\n(9)\n\nThe random vector Q then follows a GPD copula on [\u22121, 0]m , which coincides with C\non \u00d7i\u2264m [\u22121, yi ]. This is the content of the main result of this section.\nProposition 3.1. Suppose that P (Y > y) > 0. Each Qi defined in (9) follows the uniform distribution on [\u22121, 0]. The random vector Q = (Q1 , . . . , Qm ) follows a GPD copula\n\n\fMultivariate piecing-together\n\n11\n\non [\u22121, 0]m , which coincides with C on \u00d7i\u2264m [\u22121, yi ]; that is,\nP (Q \u2264 x) = C(x),\n\nx \u2264 y.\n\n(i)\n\nWe have, moreover, with xi \u2208 [max(yi , x0 ), 0], i \u2264 m, for any non-empty subset K of\n{1, . . . , m}\nP (Qi \u2265 xi , i \u2208 K) = P (Vi \u2265 bi,K xi , i \u2208 K),\nwhere\nbi,K :=\n\nP (Yj > yj , j \u2208 K) P (Yj > yj , j \u2208 K)\n=\n\u2208 (0, 1],\n\u2212yi\nP (Yi > yi )\n\ni \u2208 K.\n\nProof. First we show that each Qi follows the uniform distribution on [\u22121, 0]. We have\nfor \u22121 \u2264 x \u2264 yi\nP (Qi \u2264 x) = P (Qi \u2264 x, Yi \u2264 yi ) + P (Qi \u2264 x, Yi > yi )\n= P (Yi \u2264 x)\n= 1 + x,\nwhereas for yi < x \u2264 0 we obtain\nP (Qi \u2264 x) = P (Yi \u2264 yi ) + P (\u2212yi Vi \u2264 x)P (Yi > yi )\n\u0013\n\u0012\nx\n(\u2212yi )\n= 1 + yi + P Vi \u2264 \u2212\nyi\n\u0013\n\u0012\nx\n(\u2212yi )\n= 1 + yi + 1 \u2212\nyi\n= 1 + x.\nThe random vector Q, thus, follows a copula on [\u22121, 0]m . We have, further, for x \u2264 y\nP (Q \u2264 x) = P (Q \u2264 x, Y \u2264 y) + P (Q \u2264 x, Y 6\u2264 y)\n= P (Y \u2264 x)\n= C(x).\nBy Proposition 2.1 in Falk and Michel [18] we have with xi \u2208 [max(yi , \u03c9i ), 0], i \u2264 m,\nt \u2208 [0, 1] and an arbitrary subset K \u2282 {1, . . . , m}\nP (Qj > txj , j \u2208 K) = P (Qj > txj , Yj > yj , j \u2208 K)\n= P (\u2212yj Vj > txj , j \u2208 K)P (Yj > yj , j \u2208 K)\n= tP (\u2212yj Vj > xj , j \u2208 K)P (Yj > yj , j \u2208 K)\n= tP (Qj > xj , j \u2208 K),\nwhich, again by Proposition 2.1 in Falk and Michel [18], implies that Q follows a GPD.\n\n\f12\n\nS. Aulbach, V. Bayer and M. Falk\n(i)\n\nWe have, moreover, with xi \u2208 [max(yi , x0 ), 0], i \u2264 m,\nP (Qi \u2265 xi , i \u2208 K)\n= P (Qi \u2265 xi , Yi > yi , i \u2208 K) + P (Qi \u2265 xi , i \u2208 K, Yj \u2264 yj for some j \u2208 K)\n= P (\u2212yi Vi \u2265 xi , i \u2208 K)P (Yi > yi , i \u2208 K)\n\u0013\n\u0012\nxi\n= P Vi \u2265 \u2212 , i \u2208 K P (Yi > yi , i \u2208 K)\nyi\n= P (Vi \u2265 bi,K xi , i \u2208 K).\n\n\u0003\n\nThe above approach provides an easy way to generate a random vector X \u2208 Rm with\nprescribed margins Fi\u2217 , i \u2264 m, such that X has a given copula in the central part of the\ndata, whereas in the upper tail it has a GPD copula.\ne := (Q1 + 1, . . . , Qm + 1). Then each comTake Q = (Q1 , . . . , Qm ) as in (9) and put Q\ne\ne\nponent Qi of Q is uniformly distributed on (0, 1) and thus\ne 1 ), . . . , F \u2217\u22121 (Q\ne m ))\nX := (X1 , . . . , Xm ) := (F1\u2217\u22121 (Q\nm\n\n(10)\n\nhas the desired properties.\nCombining the univariate and the multivariate PT approach now consists in choosing\na threshold u(i) \u2208 R for each dimension i \u2264 m and a univariate distribution function Fi\ntogether with an arbitrary univariate GPD W\u03b3i ,\u03bci \u03c3i , and putting for i \u2264 m\n\u001a\nFi (x),\nif x \u2264 u(i)\n\u2217\nFi (x) :=\n.\n(11)\nif x > u(i)\n(1 \u2212 Fi (u(i)))W\u03b3i ,\u03bci \u03c3i (x) + Fi (u(i)),\nThis is typically done in a way such that Fi\u2217 is a continuous function.\n\n4. An application to operational loss data\nIn this section we apply our multivariate PT approach to operational loss data. For\nan excellent introduction to operational risk and insurance analytics, see Chapter 10 of\nMcNeil et al. [23] and the literature cited there. In the sequel we give a brief summary.\nAccording to the New Basel Capital Accord (Basel II), banks are required to determine the regulatory capital charge for operational risk, defined as the risk of losses\nresulting from inadequate or failed internal processes, people and systems or from external events. The Basel Committee on Banking Supervision encourages the use and further\ndevelopment of advanced modelling techniques to quantify operational risk. The most\nrisk-sensitive methodology is the loss distribution approach using bank internal data to\nestimate probability distribution functions for each business line/event type category.\nTo provide a greater consistency of loss data collection within and between banks, operational losses are classified in eight business lines and seven event types. To calculate\nthe capital charge for each business line/event type combination, a risk measure such\n\n\fMultivariate piecing-together\n\n13\n\nas value at risk to the 99.9% confidence level over a one-year holding period is chosen.\nA conservative way to assess a bank's total capital requirement is to sum up the capital\ncharges across business line/event type classes assuming perfect dependence and disregarding diversification effects in operational risk. Actually, the fact that all severe losses\noccur in the same year is rather dubious. Therefore, the dependence structure among\nlosses of different business line/event type categories needs to be modelled explicitly. For\nsimplicity, we consider in what follows only business lines and not event types.\nThe frequency of a loss event for business line i over a one-year time horizon will be\ndenoted by N (i). The random loss associated with the kth loss event for business line i\nwill be denoted by \u03b6k (i).\nThe random loss L(i) over one year for business line i is, therefore, modelled as\nN (i)\n\nL(i) =\n\nX\n\n\u03b6k (i),\n\nk=1\n\nwhere \u03b61 (i), \u03b62 (i), . . . are assumed to be i.i.d. with distribution function Fi and they are\nindependent of their total number N (i).\nThe goal is to model the total loss distribution for operational risk; that is, the distribution of\nm\nX\nL(i),\nL :=\ni=1\n\nor parameters of it such as the value at risk VAR(\u03b1) at the probability level \u03b1 satisfying\nP (L \u2265 VAR(\u03b1)) = 1 \u2212 \u03b1\nor the expected shortfall at the probability level \u03b1\nES(\u03b1) := E(L | L \u2265 VAR(\u03b1)).\nIn order to assess the total capital charge, the traditional models for measuring operational risk determine VAR(\u03b1) and ES(\u03b1) for each of the m business lines separately and\nthen simply sum up the corresponding capital charges.\nIn contrast, Di Clemente and Romano [14] suggest modelling the dependence structure\namong L(1), . . . , L(m) by a copula function, precisely, by the copula corresponding to the\nm-dimensional t-distribution with \u03bd degrees of freedom. For a closer look at the issue of\nmodelling the dependence among components of a random vector of financial risk factors\nusing the concept of a copula, see Chapter 5 of McNeil et al. [23].\nIn our application we analyse operational losses of the external database SAS OpRisk\nGlobal Data, which contains worldwide information on publicly reported operational\nlosses over US $100 000. Since we do not know the probability of losses lying under\nUS $100 000, we neglect this cut-off limit in modelling the severity and frequency of the\ndata. We concentrate on two business lines of the financial sector, Commercial banking\nand Retail banking.\n\n\f14\n\nS. Aulbach, V. Bayer and M. Falk\n\nFirst we follow the copula extreme value theory approach for modelling operational\nloss data as outlined in Di Clemente and Romano [14], but we add the multivariate PT\napproach developed in Section 3.\n\n4.1. Estimation\nBefore applying the multivariate PT approach, we explore the characteristics of the\nempirical distributions of the two business lines and estimate the model's parameters.\nThereby the severity distribution of the random variable \u03b6k (i) and the frequency distribution of the random variable N (i), i = 1, 2, are treated separately. To obtain the\ndistribution function of the total loss L(i) of the business line i over a one-year time\nhorizon we accomplish a Monte Carlo simulation combining the severity distribution\nwith the frequency distribution.\nFirst we analyse the empirical distributions of the loss severity. The measures skewness\nand kurtosis indicate that the empirical distributions of the two business lines are skewed\nto the right and very heavy tailed.\nIn the next step, parametric distributions (i.e., Weibull, gamma and lognormal distribution) are fitted to the data. The parameters are estimated by the maximum likelihood\nmethod. With the help of graphical analysis (QQ plots, theoretical versus empirical distribution function plots) and goodness-of-fit tests (Anderson\u2013Darling test, Cramer\u2013von\nMises (CvM) test), we conclude, that none of the selected distributions provides a good\nfit to the complete data sets. (For a detailed presentation and discussion of goodness-of-fit\ntechniques, see D'Agostino and Stephens [8].) However, the lognormal distribution fits the\nbody of the data very well, while it underestimates the severity of the data in the right tail.\nTherefore, to fit the tail data accurately, the univariate POT method in the model of\nthe severity distribution of the losses \u03b6k (i) is applied: The existence of a threshold u(i) for\neach business line i is assumed such that \u03b6k (i) follows a lognormal distribution function\nbelow u(i), whereas above u(i) it follows a univariate GPD, that is,\nP (\u03b6k (i) \u2264 x)\n\u001a\nFi (x),\n=\nFi (u(i)) + (1 \u2212 Fi (u(i))) GPD\u03b2(i),\u03be(i) (x \u2212 u(i)),\n\nx \u2264 u(i),\nx \u2265 u(i),\n\n(12)\n\nwhere the GPD is given by\n\u0012\n\u0013\u22121/\u03be(i)\nz\nGPD\u03b2(i),\u03be(i) (z) := 1 \u2212 1 + \u03be(i)\n,\n\u03b2(i)\n\nz \u2265 0,\n\nwith shape and scale parameter \u03be(i) > 0, \u03b2(i) > 0. Furthermore, Fi is defined as Fi (x) :=\n\u03a6((log(x) \u2212 \u03bc(i))/\u03c3(i)), where \u03a6 is the standard normal distribution function and \u03bc(i) \u2208\nR, \u03c3(i) > 0 are location and scale parameters of the lognormal distribution.\nIn this case we obtain for x \u2265 u(i)\n\u0013\u22121/\u03be(i)\n\u0012\nx \u2212 u(i)\nP (\u03b6k (i) > x) = P (\u03b6k (i) > u(i)) 1 + \u03be(i)\n.\n\u03b2(i)\n\n\fMultivariate piecing-together\n\n15\n\nTable 1. Estimated model parameters\n\nCommercial banking\nRetail banking\n\n\u03b1(i)\n\nr(i)\n\n\u03bc(i)\n\n\u03c3(i)\n\nu(i)\n\n\u03b2(i)\n\n\u03be(i)\n\n0.74\n0.39\n\n46.10\n162.04\n\n2.19\n0.88\n\n2.23\n2.06\n\n918.02\n69.18\n\n609.84\n99.75\n\n0.82\n1.02\n\nTable 2. Estimated correlation matrix for the t copula\n\nCommercial\nRetail\n\nCommercial\n\nRetail\n\n1\n0.76\n\n0.76\n1\n\nThe threshold u(i) is chosen with the help of mean excess plots. The shape and scale\nparameters of the GPD are estimated by the maximum likelihood method. For a discussion of the parameter estimation of a GPD and optimal choice of the threshold, see\nSection 6 of Embrechts et al. [15].\nTo determine the frequency distribution of the random variable N (i), the Poisson and\nnegative binomial distribution are fitted to the total number of losses per year. The\nparameters of these distributions are estimated by the method of moments. Since the\nnegative binomial distribution has two parameters, \u03b1 and r, it is more flexible and often\nprovides a better fit to operational loss data than the Poisson distribution; see Cruz [7],\npage 89. With the help of the \u03c72 goodness-of-fit test, this expectation is confirmed.\nTherefore, the random variable N (i) is modelled by the negative binomial distribution,\nwhose probability mass function is expressed as\n\u0013\u03b1(i) \u0012\n\u0013n\n\u0012\n\u0013\u0012\nr(i)\n\u03b1(i) + n \u2212 1\n1\n,\nP (N (i) = n) =\n1 + r(i)\n1 + r(i)\nn\n\nn \u2208 N0 ,\n\nwith \u03b1(i) > 0, r(i) > 0. The resulting estimates of the model's parameters are given in\nTable 1.\nIn the following, we model the dependence structure among L(1) and L(2) by a copula function. The assumption of a normal copula has been quite popular in finance for\nmodelling the dependence between different risks, but it puts less weight on observations\nthat are large in each component; see, for example, Rachev et al. [31]. The t copula is\nmore heavily tailed and, therefore, better suited for modelling operational risk.\nIn our bivariate case the t copula is fitted to the total loss data over a one-year time\nhorizon. The parameter of the correlation matrix and the degrees of freedom \u03bd are estimated by the maximum likelihood method. For a discussion of the problem of fitting\ncopulas to data, see Section 5.5 of McNeil et al. [23].\nTable 2 contains the estimated correlation matrix for the t copula with \u03bd = 8.64 estimated degrees of freedom.\n\n\f16\n\nS. Aulbach, V. Bayer and M. Falk\nTable 3. Goodness-of-fit test for the t copula\nCvM statistic\n\np-value\n\n0.02543851\n\n0.521978\n\nTo evaluate the goodness of fit of the t copula, the CvM test is applied. For recent\nreviews of copula goodness-of-fit testing, see Berg [4] and Genest et al. [21]. In Table 3\nthe CvM test value and corresponding p-value are reported.\nSince the p-value is 0.521978, the null hypothesis that the dependence structure of the\ndata follows a t copula is not rejected.\n\n4.2. Simulation\nIn the previous section we estimated the parameters that specify a situation where only\nthe univariate PT approach is applied. This model is similar to the one described in Di\nClemente and Romano [14]. Now we show by simulations how popular risk measures such\nas value at risk or expected shortfall can be influenced by the combination of univariate\nand multivariate piecing together.\nFirst we take the t copula derived in Section 4.1and add the multivariate PT approach\ne = (Ye1 , Ye2 ) and V =\ndeveloped in Section 3. We simulate 104 independent copies of Y\n(V1 , V2 ), which follow the t copula from above and a GPD copula on [\u22121, 0]2 , respectively.\ne \u2212 1 and V are then combined with those of a random vector Q\nThe realizations of Y := Y\naccording to definition (9). The distribution of Q is then a GPD copula on [\u22121, 0]2 which\ncoincides with the previously mentioned t copula \u2013 shifted by minus one \u2013 below some\nthreshold vector y = (y1 , y2 ). The last step consists in shifting the realizations of Q to\nthe interval [0, 1]2 and transforming the margins by F1\u2217 , F2\u2217 according to equation (10).\n(F1\u2217 , F2\u2217 are derived from Monte Carlo simulations as described in Section 4.1.) Thus we\nobtain 104 realizations of a random vector X that follows a multivariate distribution\nfunction that has the marginal distribution functions F1\u2217 , F2\u2217 and the associated copula\nis a GPD copula that coincides with the original t copula in its central part. These\nrealizations of X are then taken to compute the empirical counterparts of the value at\nrisk and the expected shortfall.\nBefore we apply these steps, we remark that there are still two remaining degrees\nof freedom in our model: the GPD copula that underlies V and the copula threshold\nvector y. Our goal in this section is to give a first insight into the consequences of replacing\nthe upper tail of a given copula with a GPD copula. (Note that this procedure is justified\nby Theorem 2.1 and Corollary 2.2.) For this purpose, we assume a simple model:\n(i) We define the GPD copula underlying V indirectly by setting Z := 2S in Proposition 2.4, where S follows a bivariate normal copula.\n(ii) The copula threshold vector is obtained by y := (F1 (u(1)), F2 (u(2))) \u2212 1; that is,\nthe thresholds for the marginal distributions in the univariate PT approach (see equation (12)) are transformed and used for the multivariate PT approach, too.\n\n\fMultivariate piecing-together\n\n17\n\nThis way, we construct a parametric model that is only dependent on the correlation\nmatrix\n\u0012\n\u0013\n1 \u033a\n\u03a3=\n,\n\u033a \u2208 [0, 1),\n\u033a 1\nof the random vector S. It is typically very difficult, particularly in higher dimensions, to\nfind a good multivariate model that describes both marginal behavior and dependence\nstructure effectively. The advantage of the preceding copula model is that it depends on\njust one parameter \u033a \u2208 [0, 1), allowing dependence and independence of the margins in\na simple and continuous manner. We refer again to McNeil et al. [23].\nThe simulations as described above were now done for various values of \u033a. To attain\nmore reliable estimates for the value at risk and the expected shortfall, we simulated\nnot only once but 50 times and took the average. Additionally, these values were also\ncomputed for the case in which only the univariate PT approach is applied and the t\ncopula kept unchanged. This procedure allows us to identify the effect the multivariate\nPT approach has on the mentioned risk measures.\nIn the following we state our results from the simulation series with \u033a = 0.7, which\nmodels the case of relative high dependence but not complete dependence between the\nbusiness lines. Although a graphical analysis of the used GPD copulas suggested that the\ndegree of dependence in the upper tail was increasing with \u033a getting larger, there was no\nobservable trend in the estimates of the value at risk and the expected shortfall. Further\nresearch is necessary to derive criteria for the optimal choice of \u033a or, more generally, of\nthe GPD copula underlying V and the copula threshold y.\nWe now start with the presentation of the results. For simplicity, we identify the\nbusiness lines Commercial banking and Retail banking with the cases i = 1 and i = 2,\nrespectively. The random vector X from above models the combined random losses for\nthese two business lines over one year, that is, X = (L(1), L(2)). The value at risk and the\nexpected shortfall of L(1), L(2) and L = L(1) + L(2) were computed using their empirical\ncounterparts\n[\nVAR(\u03b1)\n= Fb \u22121 (\u03b1),\n\nwhere Fb is the empirical distribution function of L(1), L(2) or L, respectively, and\nn\n\nc\nES(\u03b1)\n=\n\nX\n1\nli 1 [\n(li ),\nn(1 \u2212 \u03b1) i=1 [VAR(\u03b1),\u221e)\n\nwhere li is the ith realization of L(1), L(2) or L, respectively. By 1B we denote the\nindicator function of a set B, that is, 1B (x) = 1 if x \u2208 B and 1B (x) = 0 otherwise.\nTable 4 gives the means of 50 independent simulations resulting from the multivariate\nPT approach, whereas Table 5 makes use of the univariate approach only. Since the\nmarginal distributions are the same in both cases, namely F1\u2217 , F2\u2217 , the value at risk\nestimates concerning L(1), L(2) nearly coincide across both tables. It is apparent that\nthe respective values for L, the total loss, are only slightly different.\nOn the other hand, the empirical expected shortfalls attain clearly higher values if the\nupper tail of the t copula is substituted by a GPD. This behavior is independent of the \u03b1\n\n\f18\n\nS. Aulbach, V. Bayer and M. Falk\n\nTable 4. Estimated value at risk and expected shortfall, GPD copula\n[\nVAR(\u03b1)\n\nc\nES(\u03b1)\n\n\u03b1\n\n95%\n\n99%\n\n99.5%\n\n99.9%\n\n95%\n\n99%\n\n99.5%\n\n99.9%\n\nL(1)\nL(2)\nL\n\n13 638\n12 586\n26 578\n\n32 899\n45 370\n75 518\n\n49 650\n84 386\n127 042\n\n159 442\n390 127\n533 701\n\n46 436\n93 365\n135 581\n\n154 758\n381 142\n512 781\n\n270 036\n702 350\n930 472\n\n1038 077\n2880 672\n3746 889\n\nTable 5. Estimated value at risk and expected shortfall, t copula\n[\nVAR(\u03b1)\n\nc\nES(\u03b1)\n\n\u03b1\n\n95%\n\n99%\n\n99.5%\n\n99.9%\n\n95%\n\n99%\n\n99.5%\n\n99.9%\n\nL(1)\nL(2)\nL\n\n13 638\n12 590\n25 428\n\n32 667\n45 601\n75 674\n\n49 196\n83 414\n131 267\n\n153 322\n392 673\n533 710\n\n37 674\n71 288\n105 122\n\n111 075\n270 821\n366 904\n\n182 956\n482 058\n637 184\n\n608 755\n1774 252\n2261 144\n\nlevel and holds for the losses in the single business lines as well as for the total loss in our\nsimulation. This is remarkable since the corresponding estimates for the value at risk are\nin both cases nearly the same, indicating that there are some extreme high losses that\noccur very rarely.\nClearly, with underlying estimated GPD shape parameters \u03be(1) = 0.82 and \u03be(2) = 1.02,\nthe theoretical expected shortfall exists only for i = 1 but not for i = 2. The significant\nc\nincreases for ES(\u03b1)\nin line L(1) and L(2) in Table 4 should, therefore, only be due to\nthe high volatility of the empirical expected shortfall, whereas the significant increase in\nline L should be caused by the substituted GPD copula as well. This example of real\noperational loss data might be considered as a warning, not to underestimate the effects\nof rare events that nevertheless might occur simultaneously.\nIn cases of no existing theoretical expected shortfall, Moscadelli [28] suggests the risk\nmeasure median shortfall (MS) that is defined regardless of the values of the shape\nparameter \u03be. If the respective distribution function is continuous, the median shortfall\nhas the representation\n\u0012\n\u0013\n1+\u03b1\nMS(\u03b1) = VAR\n,\n2\nsee Biagini and Ulmer [5], pages 749\u2013750. In addition to our previous results, Table 6\nd\n[\nstates the estimates for the median shortfall, which we computed as MS(\u03b1)\n= VAR((1\n+\n\u03b1)/2).\nUnlike the expected shortfall, the median shortfall as a robust measure is not as heavily\ninfluenced by extreme values in the upper tail. Therefore, the median shortfall estimates\nfor L(1), L(2) are closer to each other than the expected shortfall estimates if we compare\n\n\fMultivariate piecing-together\n\n19\n\nTable 6. Estimated median shortfall\nd\nMS(\u03b1),\nt copula\n\nd\nMS(\u03b1),\nGPD copula\n\n\u03b1\n\n95%\n\n99%\n\n99.5%\n\n99.9%\n\n95%\n\n99%\n\n99.5%\n\n99.9%\n\nL(1)\nL(2)\nL\n\n19 829\n21 494\n40 340\n\n49 196\n83 414\n131 267\n\n78 678\n162 438\n234 910\n\n243 938\n793 252\n962 458\n\n19 829\n21 600\n42 463\n\n49 650\n84 386\n127 042\n\n80 292\n162 866\n229 260\n\n313 246\n782 938\n1085 283\n\nFigure 1. 104 random deviates of (L(1), L(2)) based on the original t copula (left) and on the\nGPD copula (right).\n\nthe t copula case with the GPD copula case. However, the values for the median shortfall\nof L at the 99.9% level do clearly differ, indicating a small number of extreme high losses\nin the upper tail \u2013 in accordance with our considerations on the expected shortfall, see\npage 18.\nTo give visual insight into these results, Figure 1 compares the realizations of X =\n(L(1), L(2)) graphically. The graphics were taken from a single simulation that contributed to the results in Table 4 and Table 5. Although the t copula itself is already\nheavily tailed, the substitution of its upper part by a GPD puts even more weight on\nobservations that are very high in both components. (Recall Corollary 2.2.) The latter\ntype of modelling, therefore, represents a higher risk of an extraordinarily high total loss\nover a one-year time horizon. This can be seen on the point in the upper right corner in\nthe right scatterplot of Figure 1, which represents a fictive total loss of 6275 000, whereas\nthe highest total loss in the respective pure t copula scenario is 3313 000.\n\n5. Conclusions\nIn the present paper we extended the well known univariate PT approach to higher\ndimensions. This was motivated by Theorem 2.1 and Corollary 2.2, which show that it is\n\n\f20\n\nS. Aulbach, V. Bayer and M. Falk\n\nnot sufficient to apply the univariate approach to the marginal distributions of a random\nvector if the upper tail of its distribution is to be modelled adequately. It is, therefore,\nnecessary to approximate the underlying copula by a multivariate GPD.\nThe multivariate PT approach that was introduced in (9) offers a wide range of scenarios to be modelled because it depends basically only on some random vector whose\ncomponents need to be bounded and to have expectation one; see Proposition 2.4. As\na consequence we also mentioned a natural way to map the set of copulas to the set of\nmultivariate GPDs that was useful for our simulation studies to obtain a one-parametric\nmodel.\nBecause the values in a simulation are random, simulations occur that produce no\nvalues that are high in both components. (This is depending on the sample size, too.)\nFixing this disadvantage is subject to further research and could probably be achieved\nby making additional restrictions on the GPD copula random vector in (9). Furthermore,\ngoodness-of-fit testing of the compound GPD copula is required.\nNevertheless, the multivariate PT approach is a powerful and suitable tool to adequately model multivariate distributions in their upper tails. This ensures that the\nprobability of very rare events that occur simultaneously and have a high effect if they\noccur is not underestimated. The high empirical expected shortfalls in Table 4 might be\nconsidered as a warning.\n\nAcknowledgements\nThe authors are grateful to the referees for their constructive comments on an earlier\nversion of this paper. The authors are also indebted to the SAS Institute, Heidelberg, for\nproviding access to the database SAS OpRisk Global Data.\nThe first author was supported by DFG Grant FA 262/4-1.\n\nReferences\n[1] Alsina, C., Nelsen, R.B. and Schweizer, B. (1993). On the characterization of\na class of binary operations on distribution functions. Statist. Probab. Lett. 17 85\u2013\n89. MR1223530\n[2] Balkema, A.A. and de Haan, L. (1974). Residual life time at great age. Ann. Probab. 2\n792\u2013804. MR0359049\n[3] Beirlant, J., Goegebeur, Y., Teugels, J. and Segers, J. (2004). Statistics of Extremes:\nTheory and Applications. Chichester: Wiley. MR2108013\n[4] Berg, D. (2009). Copula goodness-of-fit testing: An overview and power comparison. The\nEuropean Journal of Finance 15 675\u2013701.\n[5] Biagini, F. and Ulmer, S. (2009). Asymptotics for operational risk quantified with expected shortfall. ASTIN Bulletin 39 735\u2013752.\n[6] Buishand, T.A., de Haan, L. and Zhou, C. (2008). On spatial extremes: With application\nto a rainfall problem. Ann. Appl. Statist. 2 624\u2013642. MR2524349\n[7] Cruz, M.G. (2002). Modeling, Measuring and Hedging Operational Risk. Chichester: Wiley.\n[8] D'Agostino, L. and Stephens, M.A. (1986). Goodness-of-fit Techniques. Statistics: Textbooks and Monographs 68. New York: Marcel Dekker Inc. MR0874534\n\n\fMultivariate piecing-together\n\n21\n\n[9] de Haan, L. and de Ronde, J. (1998). Sea and wind: Multivariate extremes at work.\nExtremes 1 7\u201345. MR1652944\n[10] de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. New\nYork: Springer. MR2234156\n[11] de Haan, L. and Sinha, A.K. (1999). Estimating the probability of a rare event. Ann.\nStatist. 27 732\u2013759. MR1714710\n[12] Deheuvels, P. (1978). Caract\u00e9risation compl\u00e8te des lois extr\u00eame multivari\u00e9es et de la\nconvergence des types extr\u00eames. Publ. Inst. Statist. Univ. Paris 23 1\u201336.\n[13] Deheuvels, P. (1984). Probabilistic aspects of multivariate extremes. In Statistical Extremes and Applications (Vimeiro, 1983). NATO Adv. Sci. Inst. Ser. C Math. Phys.\nSci. (J. Tiago de Oliveira, ed.) 131 117\u2013130. Dordrecht: Reidel. MR0784817\n[14] Di Clemente, A. and Romano, C. (2004). A copula-extreme value theory approach for\nmodelling operational risk. In Operational Risk Modelling and Analysis, Theory and\nPractice (M. Cruz, ed.) 189\u2013208. London: RISK Books.\n[15] Embrechts, P., Kl\u00fcppelberg, C. and Mikosch, T. (1997). Modelling Extremal Events\nfor Insurance and Finance. Applications of Mathematics (New York) 33. Berlin:\nSpringer. MR1458613\n[16] Falk, M. (2008). It was 30 years ago today when Laurens de Haan went the multivariate\nway. Extremes 11 55\u201380. MR2420197\n[17] Falk, M., H\u00fcsler, J. and Reiss, R.D. (2010). Laws of Small Numbers: Extremes and\nRare Events, 3rd ed. Basel: Birkh\u00e4user.\n[18] Falk, M. and Michel, R. (2009). Testing for a multivariate generalized Pareto distribution. Extremes 12 33\u201351. MR2480722\n[19] Galambos, J. (1987). The Asymptotic Theory of Extreme Order Statistics, 2nd ed. Melbourne, FL: Robert E. Krieger Publishing Co. Inc. MR0936631\n[20] Genest, C., Quesada Molina, J.J., Rodr\u0131\u0301guez Lallena, J.A. and Sempi, C. (1999).\nA characterization of quasi-copulas. J. Multivariate Anal. 69 193\u2013205. MR1703371\n[21] Genest, C., R\u00e9millard, B. and Beaudoin, D. (2009). Goodness-of-fit tests for copulas:\nA review and a power study. Insurance Math. Econom. 44 199\u2013213. MR2517885\n[22] Huang, X. (1992). Statistics of bivariate extreme values. Ph.D. thesis, Tinbergen Institute\nResearch Series.\n[23] McNeil, A.J., Frey, R. and Embrechts, P. (2005). Quantitative Risk Management:\nConcepts, Techniques and Tools. Princeton, NJ: Princeton Univ. Press. MR2175089\n[24] McNeil, A.J. and Ne\u0161lehov\u00e1, J. (2009). Multivariate Archimedean copulas, dmonotone functions and l1 -norm symmetric distributions. Ann. Statist. 37 3059\u20133097.\nMR2541455\n[25] Michel, R. (2006). Simulation and estimation in multivariate generalized Pareto models.\nPh.D. thesis, Univ. W\u00fcrzburg.\n[26] Michel, R. (2007). Simulation of certain multivariate generalized Pareto distributions.\nExtremes 10 83\u2013107. MR2415635\n[27] Michel, R. (2008). Some notes on multivariate generalized Pareto distributions. J. Multivariate Anal. 99 1288\u20131301. MR2432486\n[28] Moscadelli, M. (2004). The modelling of operational risk: Experience with the analysis\nof the data collected by the Basel Committee. Banca D'Italia, Termini di discussione\nNo. 517.\n[29] Nelsen, R.B. (2006). An Introduction to Copulas, 2nd ed. New York: Springer. MR2197664\n[30] Pickands, J. III (1975). Statistical inference using extreme order statistics. Ann. Statist.\n3 119\u2013131. MR0423667\n\n\f22\n\nS. Aulbach, V. Bayer and M. Falk\n\n[31] Rachev, S.T., Stein, M. and Sun, W. (2009). Copula concepts in financial markets.\nTechnical report, Karslruhe Institute of Technology (KIT).\n[32] Reiss, R.D. (1989). Approximate Distributions of Order Statistics: With Applications to\nNonparametric Statistics. New York: Springer. MR0988164\n[33] Reiss, R.D. and Thomas, M. (2007). Statistical Analysis of Extreme Values, 3rd ed. Basel:\nBirkh\u00e4user. MR1819648\n[34] Resnick, S.I. (2006). Heavy-Tail Phenomena: Probabilistic and Statistical Modeling. New\nYork: Springer. MR2271424\n[35] Rootz\u00e9n, H. and Tajvidi, N. (2006). Multivariate generalized Pareto distributions.\nBernoulli 12 917\u2013930. MR2265668\nReceived September 2009 and revised August 2010\n\n\f"}