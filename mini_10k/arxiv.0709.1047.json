{"id": "http://arxiv.org/abs/0709.1047v3", "guidislink": true, "updated": "2008-06-04T15:33:47Z", "updated_parsed": [2008, 6, 4, 15, 33, 47, 2, 156, 0], "published": "2007-09-07T19:30:39Z", "published_parsed": [2007, 9, 7, 19, 30, 39, 4, 250, 0], "title": "A Dirac type result on Hamilton cycles in oriented graphs", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0709.0485%2C0709.1624%2C0709.1924%2C0709.1874%2C0709.1447%2C0709.1061%2C0709.0647%2C0709.3087%2C0709.2466%2C0709.2212%2C0709.1705%2C0709.3215%2C0709.2820%2C0709.3674%2C0709.2960%2C0709.0636%2C0709.2458%2C0709.4592%2C0709.3120%2C0709.1665%2C0709.4675%2C0709.0428%2C0709.1700%2C0709.4555%2C0709.2103%2C0709.0712%2C0709.1047%2C0709.0273%2C0709.0537%2C0709.3964%2C0709.0957%2C0709.0874%2C0709.3035%2C0709.1855%2C0709.4594%2C0709.0162%2C0709.2506%2C0709.0375%2C0709.2914%2C0709.0841%2C0709.1367%2C0709.0508%2C0709.0726%2C0709.4352%2C0709.4512%2C0709.0466%2C0709.4497%2C0709.3716%2C0709.0112%2C0709.3278%2C0709.2838%2C0709.1069%2C0709.2193%2C0709.1245%2C0709.2377%2C0709.1945%2C0709.4330%2C0709.2981%2C0709.1559%2C0709.1003%2C0709.3502%2C0709.1457%2C0709.1125%2C0709.2104%2C0709.0135%2C0709.0260%2C0709.0049%2C0709.1587%2C0709.1445%2C0709.2726%2C0709.2339%2C0709.2186%2C0709.3073%2C0709.0947%2C0709.4419%2C0709.2457%2C0709.2058%2C0709.0827%2C0709.4347%2C0709.0430%2C0709.3203%2C0709.3963%2C0709.4008%2C0709.2871%2C0709.1099%2C0709.2012%2C0709.4043%2C0709.0110%2C0709.3101%2C0709.3526%2C0709.2997%2C0709.2639%2C0709.1670%2C0709.0477%2C0709.3761%2C0709.3994%2C0709.2292%2C0709.3621%2C0709.0749%2C0709.4581%2C0709.0243&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Dirac type result on Hamilton cycles in oriented graphs"}, "summary": "We show that for each \\alpha>0 every sufficiently large oriented graph G with\n\\delta^+(G),\\delta^-(G)\\ge 3|G|/8+ \\alpha |G| contains a Hamilton cycle. This\ngives an approximate solution to a problem of Thomassen. In fact, we prove the\nstronger result that G is still Hamiltonian if\n\\delta(G)+\\delta^+(G)+\\delta^-(G)\\geq 3|G|/2 + \\alpha |G|. Up to the term\n\\alpha |G| this confirms a conjecture of H\\\"aggkvist. We also prove an Ore-type\ntheorem for oriented graphs.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0709.0485%2C0709.1624%2C0709.1924%2C0709.1874%2C0709.1447%2C0709.1061%2C0709.0647%2C0709.3087%2C0709.2466%2C0709.2212%2C0709.1705%2C0709.3215%2C0709.2820%2C0709.3674%2C0709.2960%2C0709.0636%2C0709.2458%2C0709.4592%2C0709.3120%2C0709.1665%2C0709.4675%2C0709.0428%2C0709.1700%2C0709.4555%2C0709.2103%2C0709.0712%2C0709.1047%2C0709.0273%2C0709.0537%2C0709.3964%2C0709.0957%2C0709.0874%2C0709.3035%2C0709.1855%2C0709.4594%2C0709.0162%2C0709.2506%2C0709.0375%2C0709.2914%2C0709.0841%2C0709.1367%2C0709.0508%2C0709.0726%2C0709.4352%2C0709.4512%2C0709.0466%2C0709.4497%2C0709.3716%2C0709.0112%2C0709.3278%2C0709.2838%2C0709.1069%2C0709.2193%2C0709.1245%2C0709.2377%2C0709.1945%2C0709.4330%2C0709.2981%2C0709.1559%2C0709.1003%2C0709.3502%2C0709.1457%2C0709.1125%2C0709.2104%2C0709.0135%2C0709.0260%2C0709.0049%2C0709.1587%2C0709.1445%2C0709.2726%2C0709.2339%2C0709.2186%2C0709.3073%2C0709.0947%2C0709.4419%2C0709.2457%2C0709.2058%2C0709.0827%2C0709.4347%2C0709.0430%2C0709.3203%2C0709.3963%2C0709.4008%2C0709.2871%2C0709.1099%2C0709.2012%2C0709.4043%2C0709.0110%2C0709.3101%2C0709.3526%2C0709.2997%2C0709.2639%2C0709.1670%2C0709.0477%2C0709.3761%2C0709.3994%2C0709.2292%2C0709.3621%2C0709.0749%2C0709.4581%2C0709.0243&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We show that for each \\alpha>0 every sufficiently large oriented graph G with\n\\delta^+(G),\\delta^-(G)\\ge 3|G|/8+ \\alpha |G| contains a Hamilton cycle. This\ngives an approximate solution to a problem of Thomassen. In fact, we prove the\nstronger result that G is still Hamiltonian if\n\\delta(G)+\\delta^+(G)+\\delta^-(G)\\geq 3|G|/2 + \\alpha |G|. Up to the term\n\\alpha |G| this confirms a conjecture of H\\\"aggkvist. We also prove an Ore-type\ntheorem for oriented graphs."}, "authors": ["Luke Kelly", "Daniela K\u00fchn", "Deryk Osthus"], "author_detail": {"name": "Deryk Osthus"}, "author": "Deryk Osthus", "arxiv_comment": "Added an Ore-type result", "links": [{"href": "http://arxiv.org/abs/0709.1047v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0709.1047v3", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05C20; 05C38; 05C45; 05C35", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0709.1047v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0709.1047v3", "journal_reference": null, "doi": null, "fulltext": "arXiv:0709.1047v3 [math.CO] 4 Jun 2008\n\nA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED\nGRAPHS\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\nAbstract. We show that for each \u03b1 > 0 every sufficiently large oriented graph G with\n\u03b4 + (G), \u03b4 \u2212 (G) \u2265 3|G|/8 + \u03b1|G| contains a Hamilton cycle. This gives an approximate\nsolution to a problem of Thomassen [21]. In fact, we prove the stronger result that G is\nstill Hamiltonian if \u03b4(G) + \u03b4 + (G) + \u03b4 \u2212 (G) \u2265 3|G|/2 + \u03b1|G|. Up to the term \u03b1|G| this\nconfirms a conjecture of H\u00e4ggkvist [10]. We also prove an Ore-type theorem for oriented\ngraphs.\n\n1. Introduction\nAn oriented graph G is obtained from a (simple) graph by orienting its edges. Thus\nbetween every pair of vertices of G there exists at most one edge. The minimum semidegree \u03b40 (G) of G is the minimum of its minimum outdegree \u03b4+ (G) and its minimum indegree \u03b4\u2212 (G). When referring to paths and cycles in oriented graphs we always mean that\nthese are directed without mentioning this explicitly.\nA fundamental result of Dirac states that a minimum degree of |G|/2 guarantees a\nHamilton cycle in an undirected graph G. There is an analogue of this for digraphs due\nto Ghouila-Houri [9] which states that every digraph D with minimum semi-degree at\nleast |D|/2 contains a Hamilton cycle. The bounds on the minimum degree in both results are best possible. A natural question is to ask for the (smallest) minimum semi-degree\nwhich guarantees a Hamilton cycle in an oriented graph G. This question was p\nfirst raised\nby Thomassen [20], who [22] showed that a minimum semi-degree of |G|/2 \u2212 |G|/1000\nsuffices (see also [21]). Note that this degree requirement means that G is not far from being\na tournament. H\u00e4ggkvist [10] improved the bound further to |G|/2 \u2212 2\u221215 |G| and conjectured that the actual value lies close to 3|G|/8. The best previously known bound is due\nto H\u00e4ggkvist and Thomason [11], who showed that for each \u03b1 > 0 every sufficiently large\noriented graph G with minimum semi-degree at least (5/12 + \u03b1)|G| has a Hamilton cycle.\nOur first result implies that the actual value is indeed close to 3|G|/8.\nTheorem 1. For every \u03b1 > 0 there exists an integer N = N (\u03b1) such that every oriented\ngraph G of order |G| \u2265 N with \u03b40 (G) \u2265 (3/8 + \u03b1)|G| contains a Hamilton cycle.\nA construction of H\u00e4ggkvist [10] shows that the bound in Theorem 1 is essentially best\npossible (see Proposition 6).\nIn fact, H\u00e4ggkvist [10] formulated the following stronger conjecture. Given an oriented\ngraph G, let \u03b4(G) denote the minimum degree of G (i.e. the minimum number of edges\nincident to a vertex) and set \u03b4\u2217 (G) := \u03b4(G) + \u03b4+ (G) + \u03b4\u2212 (G).\nConjecture 2 (H\u00e4ggkvist [10]). Every oriented graph G with \u03b4\u2217 (G) > (3n \u2212 3)/2 has a\nHamilton cycle.\nD. K\u00fchn was partially supported by the EPSRC, grant no. EP/F008406/1. D. Osthus was partially\nsupported by the EPSRC, grant no. EP/E02162X/1 and EP/F008406/1.\n1\n\n\f2\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nOur next result provides an approximate confirmation of this conjecture for large oriented\ngraphs.\nTheorem 3. For every \u03b1 > 0 there exists an integer N = N (\u03b1) such that every oriented\ngraph G of order |G| \u2265 N with \u03b4\u2217 (G) \u2265 (3/2 + \u03b1)|G| contains a Hamilton cycle.\nNote that Theorem 1 is an immediate consequence of this. The proof of Theorem 3 can be\nmodified to yield the following Ore-type analogue of Theorem 1. (Ore's theorem [19] states\nthat every graph G on n \u2265 3 vertices which satisfies d(x) + d(y) \u2265 n whenever xy \u2208\n/ E(G)\nhas a Hamilton cycle.)\nTheorem 4. For every \u03b1 > 0 there exists an integer N = N (\u03b1) such that every oriented\ngraph G of order |G| \u2265 N with d+ (x) + d\u2212 (y) \u2265 (3/4 + \u03b1)|G| whenever xy \u2208\n/ E(G) contains\na Hamilton cycle.\nA version for general digraphs was proved by Woodall [23]: every strongly connected\ndigraph D on n \u2265 2 vertices which satisfies d+ (x) + d\u2212 (y) \u2265 n whenever xy \u2208\n/ E(D) has a\nHamilton cycle.\nTheorem 1 immediately implies a partial result towards a conjecture of Kelly (see e.g. [3]),\nwhich states that every regular tournament on n vertices can be partitioned into (n \u2212 1)/2\nedge-disjoint Hamilton cycles. (A regular tournament is an orientation of a complete graph\nin which the indegree of every vertex equals its outdegree.)\nCorollary 5. For every \u03b1 > 0 there exists an integer N = N (\u03b1) such that every regular\ntournament of order n \u2265 N contains at least (1/8 \u2212 \u03b1)n edge-disjoint Hamilton cycles.\nIndeed, Corollary 5 follows from Theorem 1 by successively removing Hamilton cycles until\nthe oriented graph G obtained from the tournament in this way has minimum semi-degree\nless than (3/8 + \u03b1)|G|. The best previously known bound on the number of edge-disjoint\nHamilton cycles in a regular tournament is the one which follows from the result of H\u00e4ggkvist\nand Thomason [11] mentioned above. A related result of Frieze and Krivelevich [8] states\nthat every dense \u03b5-regular digraph contains a collection of edge-disjoint Hamilton cycles\nwhich covers almost all of its edges. This immediately implies that the same holds for\nalmost every tournament. Together with a lower bound by McKay [18] on the number of\nregular tournaments, the above result in [8] also implies that almost every regular tournament\ncontains a collection of edge-disjoint Hamilton cycles which covers almost all of its edges.\nNote that Theorem 3 implies that for sufficiently large tournaments T a minimum semidegree of at least (1/4 + \u03b1)|T | already suffices to guarantee a Hamilton cycle. (However, it\nis not hard to prove this directly.) It was shown by Bollob\u00e1s and H\u00e4ggkvist [5] that this\ndegree condition even ensures the kth power of a Hamilton cycle (if T is sufficiently large\ncompared to 1/\u03b1 and k). The degree condition is essentially best possible as a minimum\nsemi-degree of |T |/4 \u2212 1 does not even guarantee a single Hamilton cycle.\nSince this paper was written, we have used some of the tools and methods to obtain an\nexact version of Theorem 1 (but not of Theorems 3 and 4) for large oriented graphs [12] as\nwell as an approximate analogue of Chv\u00e1tal's theorem on Hamiltonian degree sequences for\ndigraphs [17]. See [13] for related results about short cycles and pancyclicity for oriented\ngraphs.\nOur paper is organized as follows. In the next section we introduce some basic definitions\nand describe the extremal example which shows that Theorem 1 (and thus also Theorems 3\nand 4) is essentially best possible. Our proof of Theorem 3 relies on the Regularity lemma\nfor digraphs and on a variant (due to Csaba [6]) of the Blow-up lemma. These and other\ntools are introduced in Section 3, where we also give an overview of the proof. In Section 4\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n3\n\nwe collect some preliminary results. Theorem 3 is then proved in Section 5. In the last\nsection we discuss the modifications needed to prove Theorem 4.\n2. Notation and the extremal example\nBefore we show that Theorems 1, 3 and 4 are essentially best possible, we will introduce\nthe basic notation used throughout the paper. Given two vertices x and y of an oriented\ngraph G, we write xy for the edge directed from x to y. The order |G| of G is the number of its\n+\nvertices. We write NG+ (x) for the outneighbourhood of a vertex x and d+\nG (x) := |NG (x)| for\n\u2212\nits outdegree. Similarly, we write NG\u2212 (x) for the inneighbourhood of x and d\u2212\nG (x) := |NG (x)|\n\u2212\n+\nfor its indegree. We write NG (x) := NG (x) \u222a NG (x) for the neighbourhood of x and\nuse N + (x) etc. whenever this is unambiguous. We write \u2206(G) for the maximum of |N (x)|\nover all vertices x \u2208 G.\nGiven a set A of vertices of G, we write NG+ (A) for the set of all outneighbours of vertices\nin A. So NG+ (A) is the union of NG+ (a) over all a \u2208 A. NG\u2212 (A) is defined similarly. The\noriented subgraph of G induced by A is denoted by G[A]. Given two vertices x, y of G, an\nx-y path is a directed path which joins x to y. Given two disjoint subsets A and B of vertices\nof G, an A-B edge is an edge ab where a \u2208 A and b \u2208 B, the set of these edges is denoted\nby EG (A, B) and we put eG (A, B) := |EG (A, B)|.\nRecall that when referring to paths and cycles in oriented graphs we always mean that\nthey are directed without mentioning this explicitly. Given two vertices x and y on a directed\ncycle C, we write xCy for the subpath of C from x to y. Similarly, given two vertices x and y\non a directed path P such that x precedes y, we write xP y for the subpath of P from x to y.\nA walk in an oriented graph G is a sequence of (not necessary distinct) vertices v1 , v2 , . . . , vl\nwhere vi vi+1 is an edge for all 1 \u2264 i < l. The walk is closed if v1 = vl . A 1-factor of G is a\ncollection of disjoint cycles which cover all the vertices of G. We define things similarly for\ngraphs and for directed graphs. The underlying graph of an oriented graph G is the graph\nobtained from G by ignoring the directions of its edges.\nGiven disjoint vertex sets A and B in a graph G, we write (A, B)G for the induced bipartite\nsubgraph of G whose vertex classes are A and B. We write (A, B) where this is unambiguous.\nWe call an orientation of a complete graph a tournament and an orientation of a complete\nbipartite graph a bipartite tournament. An oriented graph G is d-regular if all vertices have\nin- and outdegree d. G is regular if it is d-regular for some d. It is easy to see (e.g. by\ninduction) that for every odd n there exists a regular tournament on n vertices. Throughout\nthe paper we omit floors and ceilings whenever this does not affect the argument.\nThe following construction by H\u00e4ggkvist [10] shows that Conjecture 2 is best possible for\ninfinitely many values of |G|. We include it here for completeness.\nProposition 6. There are infinitely many oriented graphs G with minimum semi-degree (3|G|\u2212\n5)/8 which do not contain a 1-factor and thus do not contain a Hamilton cycle.\nProof. Let n := 4m + 3 for some odd m \u2208 N. Let G be the oriented graph obtained\nfrom the disjoint union of two regular tournaments A and C on m vertices, a set B of m + 2\nvertices and a set D of m + 1 vertices by adding all edges from A to B, all edges from B\nto C, all edges from C to D as well as all edges from D to A. Finally, between B and D\nwe add edges to obtain a bipartite tournament which is as regular as possible, i.e. the inand outdegree of every vertex differ by at most 1. So in particular every vertex in B sends\nexactly (m + 1)/2 edges to D (Figure 1).\nIt is easy to check that the minimum semi-degree of G is (m \u2212 1)/2 + (m + 1) = (3n \u2212 5)/8,\nas required. Since every path which joins two vertices in B has to pass through D, it follows\n\n\f4\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nA\n\nD\n\nB\n\nC\n\nPSfrag replacements\n\nFigure 1. The oriented graph in the proof of Proposition 6.\nthat every cycle contains at least as many vertices from D as it contains from B. As\n|B| > |D| this means that one cannot cover all the vertices of G by disjoint cycles, i.e. G\ndoes not contain a 1-factor.\n\u0003\n3. The Diregularity lemma, the Blow-up lemma and other tools\n3.1. The Diregularity lemma and the Blow-up lemma. In this section we collect all\nthe information we need about the Diregularity lemma and the Blow-up lemma. See [16] for\na survey on the Regularity lemma and [14] for a survey on the Blow-up lemma. We start\nwith some more notation. The density of a bipartite graph G = (A, B) with vertex classes A\nand B is defined to be\neG (A, B)\n.\ndG (A, B) :=\n|A| |B|\nWe often write d(A, B) if this is unambiguous. Given \u03b5 > 0, we say that G is \u03b5-regular\nif for all subsets X \u2286 A and Y \u2286 B with |X| > \u03b5 |A| and |Y | > \u03b5 |B| we have that\n|d(X, Y ) \u2212 d(A, B)| < \u03b5. Given d \u2208 [0, 1] we say that G is (\u03b5, d)-super-regular if it is \u03b5regular and furthermore dG (a) \u2265 (d \u2212 \u03b5) |B| for all a \u2208 A and dG (b) \u2265 (d \u2212 \u03b5) |A| for all\nb \u2208 B. (This is a slight variation of the standard definition of (\u03b5, d)-super-regularity where\none requires dG (a) \u2265 d |B| and dG (b) \u2265 d |A|.)\nThe Diregularity lemma is a version of the Regularity lemma for digraphs due to Alon\nand Shapira [1]. Its proof is quite similar to the undirected version. We will use the degree\nform of the Diregularity lemma which can be easily derived (see e.g. [24]) from the standard\nversion, in exactly the same manner as the undirected degree form.\nLemma 7 (Degree form of the Diregularity lemma). For every \u03b5 \u2208 (0, 1) and every integer M \u2032 there are integers M and n0 such that if G is a digraph on n \u2265 n0 vertices and\nd \u2208 [0, 1] is any real number, then there is a partition of the vertices of G into V0 , V1 , . . . , Vk ,\na spanning subdigraph G\u2032 of G and a set U of ordered pairs Vi Vj (where 1 \u2264 i, j \u2264 k and\ni 6= j) such that the following holds:\n\u2022 M\u2032 \u2264 k \u2264 M,\n\u2022 |V0 | \u2264 \u03b5n,\n\u2022 |V1 | = * * * = |Vk | =: m,\n+\n\u2022 d+\nG\u2032 (x) > dG (x) \u2212 (d + \u03b5)n for all vertices x \u2208 G,\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n5\n\n\u2212\n\u2022 d\u2212\nG\u2032 (x) > dG (x) \u2212 (d + \u03b5)n for all vertices x \u2208 G,\n\u2022 |U | \u2264 \u03b5k 2 ,\n\u2022 for every ordered pair Vi Vj \u2208\n/ U with 1 \u2264 i, j \u2264 k and i 6= j the bipartite graph\n(Vi , Vj )G whose vertex classes are Vi and Vj and whose edge set is the set EG (Vi , Vj )\nof all the Vi -Vj edges in G is \u03b5-regular,\n\u2022 G\u2032 is obtained from G by deleting the following edges of G: all edges with both\nendvertices in Vi for all i \u2265 1 as well as all edges in EG (Vi , Vj ) for all Vi Vj \u2208 U and\nfor all those Vi Vj \u2208\n/ U with 1 \u2264 i, j \u2264 k and i 6= j for which the density of (Vi , Vj )G\nis less than d.\n\nV1 , . . . , Vk are called clusters, V0 is called the exceptional set and the vertices in V0 are\ncalled exceptional vertices. U is called the set of exceptional pairs of clusters. Note that the\nlast two conditions of the lemma imply that for all 1 \u2264 i, j \u2264 k with i 6= j the bipartite\ngraph (Vi , Vj )G\u2032 is \u03b5-regular and has density either 0 or density at least d. In particular, in G\u2032\nall pairs of clusters are \u03b5-regular in both directions (but possibly with different densities).\nWe call the spanning digraph G\u2032 \u2286 G given by the Diregularity lemma the pure digraph.\nGiven clusters V1 , . . . , Vk and the pure digraph G\u2032 , the reduced digraph R\u2032 is the digraph\nwhose vertices are V1 , . . . , Vk and in which Vi Vj is an edge if and only if G\u2032 contains a Vi -Vj\nedge. Note that the latter holds if and only if (Vi , Vj )G\u2032 is \u03b5-regular and has density at\nleast d. It turns out that R\u2032 inherits many properties of G, a fact that is crucial in our proof.\nHowever, R\u2032 is not necessarily oriented even if the original digraph G is, but the next lemma\nshows that by discarding edges with appropriate probabilities one can go over to a reduced\noriented graph R \u2286 R\u2032 which still inherits many of the properties of G. (d) will only be used\nin the proof of Theorem 4.\nLemma 8. For every \u03b5 \u2208 (0, 1) there exist integers M \u2032 = M \u2032 (\u03b5) and n0 = n0 (\u03b5) such that the\nfollowing holds. Let d \u2208 [0, 1] and let G be an oriented graph of order at least n0 and let R\u2032\nbe the reduced digraph and U the set of exceptional pairs of clusters obtained by applying the\nDiregularity lemma to G with parameters \u03b5, d and M \u2032 . Then R\u2032 has a spanning oriented\nsubgraph R with\n(a) \u03b4+ (R) \u2265 (\u03b4+ (G)/|G| \u2212 (3\u03b5 + d)) |R|,\n(b) \u03b4\u2212 (R) \u2265 (\u03b4\u2212 (G)/|G| \u2212 (3\u03b5 + d)) |R|,\n(c) \u03b4(R) \u2265 (\u03b4(G)/|G| \u2212 (3\u03b5 + 2d)) |R|,\n(d) if 2\u03b5 \u2264 d \u2264 1 \u2212 2\u03b5 and c \u2265 0 is such that d+ (x) + d\u2212 (y) \u2265 c|G| whenever xy \u2208\n/ E(G)\n\u2212\n(V\n)\n\u2265\n(c\n\u2212\n6\u03b5\n\u2212\n2d)|R|\nwhenever\nV\nV\n\u2208\n/\nE(R)\n\u222a\nU\n.\n(V\n)\n+\nd\nthen d+\ni j\nR j\nR i\nProof. Let us first show that every cluster Vi satisfies\n(1)\n\n|NR\u2032 (Vi )|/|R\u2032 | \u2265 \u03b4(G)/|G| \u2212 (3\u03b5 + 2d).\n\nTo see this, consider any vertex x \u2208 Vi . As G is an oriented graph, the Diregularity lemma\nimplies that |NG\u2032 (x)| \u2265 \u03b4(G)\u22122(d+\u03b5)|G|. On the other hand, |NG\u2032 (x)| \u2264 |NR\u2032 (Vi )|m+|V0 | \u2264\n|NR\u2032 (Vi )||G|/|R\u2032 | + \u03b5|G|. Altogether this proves (1).\nWe first consider the case when\n(2)\n\n\u03b4+ (G)/|G| \u2265 3\u03b5 + d and\n\n\u03b4\u2212 (G)/|G| \u2265 3\u03b5 + d and\n\nc \u2265 6\u03b5 + 2d.\n\nLet R be the spanning oriented subgraph obtained from R\u2032 by deleting edges randomly as\nfollows. For every unordered pair Vi , Vj of clusters we delete the edge Vi Vj (if it exists) with\nprobability\n(3)\n\neG\u2032 (Vj , Vi )\n.\neG\u2032 (Vi , Vj ) + eG\u2032 (Vj , Vi )\n\n\f6\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nOtherwise we delete Vj Vi (if it exists). We interpret (3) as 0 if Vi Vj , Vj Vi \u2208\n/ E(R\u2032 ). So if R\u2032\ncontains at most one of the edges Vi Vj , Vj Vi then we do nothing. We do this for all unordered\npairs of clusters independently and let Xi be the random variable which counts the number\nof outedges of the vertex Vi \u2208 R. Then\nX\nX eG\u2032 (Vi , Vj )\neG\u2032 (Vi , Vj )\nE(Xi ) =\n\u2265\neG\u2032 (Vi , Vj ) + eG\u2032 (Vj , Vi )\n|Vi | |Vj |\nj6=i\n\n\u2265\n\n(4)\n\nj6=i\n\n|R\u2032 |\n\n|G| |Vi |\n\nX\n\nx\u2208Vi\n\n(d+\nG\u2032 (x) \u2212 |V0 |)\n\n(2)\n\u2265 (\u03b4+ (G\u2032 )/|G| \u2212 \u03b5) |R| \u2265 (\u03b4+ (G)/|G| \u2212 (2\u03b5 + d)) |R| \u2265 \u03b5|R|.\n\nA Chernoff-type bound (see e.g. [2, Cor. A.14]) now implies that there exists a constant \u03b2 =\n\u03b2(\u03b5) such that\nP(Xi < (\u03b4+ (G)/|G| \u2212 (3\u03b5 + d)) |R|) \u2264 P(|Xi \u2212 E(Xi )| > \u03b5E(Xi ))\n\u2264 e\u2212\u03b2E(Xi ) \u2264 e\u2212\u03b2\u03b5|R| .\n\nWriting Yi for the random variable which counts the number of inedges of the vertex Vi in R,\nit follows similarly that\nP(Yi < (\u03b4\u2212 (G)/|G| \u2212 (3\u03b5 + d)) |R|) \u2264 e\u2212\u03b2\u03b5|R| .\n\nSuppose that c is as in (d). Consider any pair Vi Vj \u2208\n/ U of clusters such that either Vi Vj \u2208\n/\nE(R\u2032 ) or Vi Vj , Vj Vi \u2208 E(R\u2032 ). (Note that each Vi Vj \u2208\n/ E(R) \u222a U satisfies one of these\nproperties.) As before, let Xi be the random variable which counts the number of outedges\nof Vi in R and let Yj be the number of inedges of Vj in R. Similary as in (4) one can show\nthat\n\uf8f6\n\uf8eb\n\u2032\nX\nX\n|R | \uf8ed\n\uf8f8\n(d+\n(d\u2212\n(5)\nE(Xi + Yj ) \u2265\nG\u2032 (x) \u2212 |V0 |) +\nG\u2032 (y) \u2212 |V0 |) .\n|G| |Vi |\nx\u2208Vi\n\ny\u2208Vj\n\nTo estimate this, we will first show that there is a set M of at least (1 \u2212 \u03b5)|Vi | disjoint pairs\n(x, y) with x \u2208 Vi , y \u2208 Vj and such that xy \u2208\n/ E(G). Suppose first that Vi Vj , Vj Vi \u2208 E(R\u2032 ).\nBut then (Vj , Vi )G is \u03b5-regular of density at least d and thus it contains a matching of size\nat least (1 \u2212 \u03b5)|Vi |. As G is oriented this matching corresponds to a set M as required. If\nVi Vj \u2208\n/ E(R\u2032 ) then (Vi , Vj )G is \u03b5-regular of density less than d (since Vi Vj \u2208\n/ U ). Thus the\ncomplement of (Vi , Vj )G is \u03b5-regular of density at least 1 \u2212 d and so contains a matching of\nsize at least (1 \u2212 \u03b5)|Vi | which again corresponds to a set M as required. Together with (5)\nthis implies that\nX\n|R\u2032 |\n\u2212\n(d+\nE(Xi + Yj ) \u2265\nG\u2032 (x) + dG\u2032 (y) \u2212 2 |V0 |)\n|G| |Vi |\n(x,y)\u2208M\n\n\u2265\n\n(2)\n|R\u2032 |\n(c \u2212 2(\u03b5 + d) \u2212 2\u03b5)|G|(1 \u2212 \u03b5)|Vi | \u2265 (c \u2212 (5\u03b5 + 2d))|R| \u2265 \u03b5|R|.\n|G| |Vi |\n\nSimilarly as before a Chernoff-type bound implies that\n\nP(Xi + Yj < (c \u2212 (6\u03b5 + 2d)) |R|) \u2264 e\u2212\u03b2\u03b5|R| .\n\nAs 2|R|2 e\u2212\u03b2\u03b5|R| < 1 if M \u2032 is chosen to be sufficiently large compared to \u03b5, this implies that\nthere is some outcome R which satisfies (a), (b) and (d). But NR\u2032 (Vi ) = NR (Vi ) for every\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n7\n\ncluster Vi and so (1) implies that \u03b4(R) \u2265 (\u03b4(G)/|G| \u2212 (3\u03b5 + 2d))|R|. Altogether this shows\nthat R is as required in the lemma.\nIf neither of the conditions in (2) hold, then (a), (b) and (d) are trivial and one can obtain\nan oriented graph R which satisfies (c) from R\u2032 by arbitrarily deleting one edge from each\ndouble edge. If for example only the first of the conditions in (2) holds, then (b) and (d)\nare trivial. To obtain an oriented graph R which satisfies (a) we consider the Xi as before,\nbut ignore the Yi and the sums Xi + Yj . Again, NR\u2032 (Vi ) = NR (Vi ) for every cluster Vi and\nso (c) is also satisfied. The other cases are similar.\n\u0003\nThe oriented graph R given by Lemma 8 is called the reduced oriented graph. The spanning oriented subgraph G\u2217 of the pure digraph G\u2032 obtained by deleting all the Vi -Vj edges\nwhenever Vi Vj \u2208 E(R\u2032 ) \\ E(R) is called the pure oriented graph. Given an oriented subgraph\nS \u2286 R, the oriented subgraph of G\u2217 corresponding to S is the oriented subgraph obtained\nfrom G\u2217 by deleting all those vertices that lie in clusters not belonging to S as well as\ndeleting all the Vi -Vj edges for all pairs Vi , Vj with Vi Vj \u2208\n/ E(S).\nIn our proof of Theorem 3 we will also need the Blow-up lemma. Roughly speaking, it\nstates the following. Let F be a graph on r vertices, let K be a graph obtained from F by\nreplacing each vertex of F with a cluster and replacing each edge with a complete bipartite\ngraph between the corresponding clusters. Define G similarly except that the edges of F now\ncorrespond to dense \u03b5-super-regular pairs. Then every subgraph H of K which has bounded\nmaximum degree is also a subgraph in G. In the original version of Koml\u00f3s, S\u00e1rk\u00f6zy and\nSzemer\u00e9di [15] \u03b5 has to be sufficiently small compared to 1/r (and so in particular we cannot\ntake r = |R|). We will use a stronger (and more technical) version due to Csaba [6], which\nallows us to take r = |R| and does not demand super-regularity. The case when \u2206 = 3 of\nthis is implicit in [7].\nIn the statement of Lemma 9 and later on we write 0 < a1 \u226a a2 \u226a a3 to mean that we\ncan choose the constants a1 , a2 , a3 from right to left. More precisely, there are increasing\nfunctions f and g such that, given a3 , whenever we choose some a2 \u2264 f (a3 ) and a1 \u2264 g(a2 ),\nall calculations needed in the proof of Lemma 9 are valid. Hierarchies with more constants\nare defined in the obvious way.\nLemma 9 (Blow-up Lemma, Csaba [6]). For all integers \u2206, K1 , K2 , K3 and every positive\nconstant c there exists an integer N such that whenever \u03b5, \u03b5\u2032 , \u03b4\u2032 , d are positive constants with\n0 < \u03b5 \u226a \u03b5\u2032 \u226a \u03b4\u2032 \u226a d \u226a 1/\u2206, 1/K1 , 1/K2 , 1/K3 , c\n\nthe following holds. Suppose that G\u2217 is a graph of order n \u2265 N and V0 , . . . , Vk is a partition\nof V (G\u2217 ) such that the bipartite graph (Vi , Vj )G\u2217 is \u03b5-regular with density either 0 or d for\nall 1 \u2264 i < j \u2264 k. Let H be a graph on n vertices with \u2206(H) \u2264 \u2206 and let L0 \u222a L1 \u222a * * * \u222a Lk\nbe a partition of V (H) with |Li | = |Vi | =: m for every i = 1, . . . , k. Furthermore, suppose\nthat there exists a bijection \u03c6 : L0 \u2192 V0 and a set I \u2286 V (H) of vertices at distance at least 4\nfrom each other such that the following conditions hold:\n(C1)\n(C2)\n(C3)\n(C4)\n(C5)\n\n|L0 | = |V0 | \u2264 K1 dn.\nL0 \u2286 I.\nLi is independent for every i = 1, . . . , k.\n|NH (L0 ) \u2229 Li | \u2264 K2 dm for every i = 1, . . . , k.\nFor each i = 1, . . . , k there exists Di \u2286 I \u2229 Li with |Di | = \u03b4\u2032 m and such that for\nS\nD := ki=1 Di and all 1 \u2264 i < j \u2264 k\n||NH (D) \u2229 Li | \u2212 |NH (D) \u2229 Lj || < \u03b5m.\n\n\f8\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\n(C6) If xy \u2208 E(H) and x \u2208 Li , y \u2208 Lj where i, j 6= 0 then (Vi , Vj )G\u2217 is \u03b5-regular with\ndensity d.\n(C7) If xy \u2208 E(H) and x \u2208 L0 , y \u2208 Lj then |NG\u2217 (\u03c6(x)) \u2229 Vj | \u2265 cm.\n(C8) For each i = 1, . . . , k, given any Ei \u2286 Vi with |Ei | \u2264 \u03b5\u2032 m there exists a set Fi \u2286\n(Li \u2229 (I \\ D)) and a bijection \u03c6i : Ei \u2192 Fi such that |NG\u2217 (v) \u2229 Vj | \u2265 (d \u2212 \u03b5)m\nwhenever NH (\u03c6i (v)) \u2229 Lj 6= \u2205 (for all v \u2208 Ei and all j = 1, . . . , k).\nS\n(C9) Writing F := ki=1 Fi we have that |NH (F ) \u2229 Li | \u2264 K3 \u03b5\u2032 m.\nThen G\u2217 contains a copy of H such that the image of Li is Vi for all i = 1, . . . , k and the\nimage of each x \u2208 L0 is \u03c6(x) \u2208 V0 .\n\nThe additional properties of the copy of H in G\u2217 are not included in the statement of the\nlemma in [6] but are stated explicitly in the proof.\nLet us briefly motivate the conditions of the Blow-up lemma. The embedding of H into G\nguaranteed by the Blow-up lemma is found by a randomized algorithm which first embeds\neach vertex x \u2208 L0 to \u03c6(x) and then successively embeds the remaining vertices of H. So the\nimage of L0 will be the exceptional set V0 . Condition (C1) requires that there are not too\nmany exceptional vertices and (C2) ensures that we can embed the vertices in L0 without\naffecting the neighbourhood of other such vertices. As Li will be embedded into Vi we need\nto have (C3). Condition (C5) gives us a reasonably large set D of 'buffer vertices' which will\nbe embedded last by the randomized algorithm. (C6) requires that edges between vertices\nof H \u2212 L0 are embedded into \u03b5-regular pairs of density d. (C7) ensures that the exceptional\nvertices have large degree in all 'neighbouring clusters'. (C8) and (C9) allow us to embed\nthose vertices whose set of candidate images in G\u2217 has grown very small at some point of\nthe algorithm. Conditions (C6), (C8) and (C9) correspond to a substantial weakening of the\nsuper-regularity that the usual form of the Blow-up lemma requires, namely that whenever H\ncontains an edge xy with and x \u2208 Li , y \u2208 Lj then (Vi , Vj )G\u2217 is (\u03b5, d)-super-regular.\nWe would like to apply the Blow-up lemma with G\u2217 being obtained from the underlying\ngraph of the pure oriented graph by adding the exceptional vertices. It will turn out that\nin order to satisfy (C8), it suffices to ensure that all the edges of a suitable 1-factor in\nthe reduced oriented graph R correspond to (\u03b5, d)-superregular pairs of clusters. A wellknown simple fact (see the first part of the proof of Proposition 10) states that this can be\nensured by removing a small proportion of vertices from each cluster Vi , and so (C8) will\nbe satisfied. However, (C6) requires all the edges of R to correspond to \u03b5-regular pairs of\ndensity precisely d and not just at least d. (As remarked by Csaba [6], it actually suffices\nthat the densities are close to d in terms of \u03b5.) The second part of the following proposition\nshows that this too does not pose a problem.\nProposition 10. Let M \u2032 , n0 , D be integers and let \u03b5, d be positive constants such that 1/n0 \u226a\n1/M \u2032 \u226a \u03b5 \u226a d \u226a 1/D. Let G be an oriented graph of order at least n0 . Let R be the reduced\noriented graph and let G\u2217 be the pure oriented graph obtained by successively applying first\nthe Diregularity lemma with parameters \u03b5, d and M \u2032 to G and then Lemma 8. Let S be an\noriented subgraph of R with \u2206(S) \u2264 D. Let G\u2032 be the underlying graph of G\u2217 . Then one\ncan delete 2D\u03b5|Vi | vertices from each cluster Vi to obtain subclusters Vi\u2032 \u2286 Vi in such a way\nthat G\u2032 contains a subgraph G\u2032S whose vertex set is the union of all the Vi\u2032 and such that\n\u221a\n\u2022 (Vi\u2032 , Vj\u2032 )G\u2032S is ( \u03b5, d \u2212 4D\u03b5)-superregular whenever Vi Vj \u2208 E(S),\n\u221a\n\u2022 (Vi\u2032 , Vj\u2032 )G\u2032S is \u03b5-regular and has density d \u2212 4D\u03b5 whenever Vi Vj \u2208 E(R).\n\nProof. Consider any cluster Vi \u2208 V (S) and any neighbour Vj of Vi in S. Recall that\nm = |Vi |. Let dij denote the density of the bipartite subgraph (Vi , Vj )G\u2032 of G\u2032 induced by Vi\nand Vj . So dij \u2265 d and this bipartite graph is \u03b5-regular. Thus there are at most 2\u03b5m vertices\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n9\n\nv \u2208 Vi such that ||NG\u2032 (v) \u2229 Vj | \u2212 dij m| > \u03b5m. So in total there are at most 2D\u03b5m vertices\nv \u2208 Vi such that ||NG\u2032 (v) \u2229 Vj | \u2212 dij m| > \u03b5m for some neighbour Vj of Vi in S. Delete all\nthese vertices as well as some more vertices if necessary to obtain a subcluster Vi\u2032 \u2286 Vi of size\n(1 \u2212 2D\u03b5)m =: m\u2032 . Delete any 2D\u03b5m vertices from each cluster Vi \u2208 V (R) \\ V (S) to obtain\na subcluster Vi\u2032 . It is easy to check that for each edge Vi Vj \u2208 E(R) the graph (Vi\u2032 , Vj\u2032 )G\u2032 is\nstill 2\u03b5-regular and that its density d\u2032ij satisfies\nd\u2032 := d \u2212 4D\u03b5 < dij \u2212 \u03b5 \u2264 d\u2032ij \u2264 dij + \u03b5.\n\nMoreover, whenever Vi Vj \u2208 E(S) and v \u2208 Vi\u2032 we have that\n\n(dij \u2212 4D\u03b5)m\u2032 \u2264 |NG\u2032 (v) \u2229 Vj\u2032 | \u2264 (dij + 4D\u03b5)m\u2032 .\n\nFor every pair Vi , Vj of clusters with Vi Vj \u2208 E(S) we now consider a spanning random\nsubgraph G\u2032ij of (Vi\u2032 , Vj\u2032 )G\u2032 which is obtained by choosing each edge of (Vi\u2032 , Vj\u2032 )G\u2032 with probability d\u2032 /d\u2032ij , independently of the other edges. Consider any vertex v \u2208 Vi\u2032 . Then the\nexpected number of neighbours of v in Vj\u2032 (in the graph G\u2032ij ) is at least (dij \u2212 4D\u03b5)d\u2032 m\u2032 /d\u2032ij \u2265\n\u221a\n(1 \u2212 \u03b5)d\u2032 m\u2032 . So we can apply a Chernoff-type bound to see that there exists a constant\nc = c(\u03b5) such that\n\u221a\n\u2032 \u2032\nP(|NG\u2032ij (v) \u2229 Vj\u2032 | \u2264 (d\u2032 \u2212 \u03b5)m\u2032 ) \u2264 e\u2212cd m .\n\nSimilarly, whenever X \u2286 Vi\u2032 and Y \u2286 Vj\u2032 are sets of size at least 2\u03b5m\u2032 the expected number\nof X-Y edges in G\u2032ij is dG\u2032 (X, Y )d\u2032 |X||Y |/d\u2032ij . Since (Vi\u2032 , Vj\u2032 )G\u2032 is 2\u03b5-regular this expected\n\u221a\n\u221a\nnumber lies between (1\u2212 \u03b5)d\u2032 |X||Y | and (1+ \u03b5)d\u2032 |X||Y |. So again we can use a Chernofftype bound to see that\n\u221a\n\u2032\n\u2032\n\u2032 2\nP(|eG\u2032ij (X, Y ) \u2212 d\u2032 |X||Y || > \u03b5|X||Y |) \u2264 e\u2212cd |X||Y | \u2264 e\u22124cd (\u03b5m ) .\nMoreover, with probability at least 1/(3m\u2032 ) the graph G\u2032ij has its expected density d\u2032 (see\ne.g. [4, p. 6]). Altogether this shows that with probability at least\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032 2\n\n1/(3m\u2032 ) \u2212 2m\u2032 e\u2212cd m \u2212 22m e\u22124cd (\u03b5m ) > 0\n\n\u221a\nwe have that G\u2032ij is ( \u03b5, d\u2032 )-superregular and has density d\u2032 . Proceed similarly for every pair\nof clusters forming an edge of S. An analogous argument applied to a pair Vi , Vj of clusters\nwith Vi Vj \u2208 E(R) \\ E(S) shows that with non-zero probability the random subgraph G\u2032ij is\n\u221a\n\u03b5-regular and has density d\u2032 . Altogether this gives us the desired subgraph G\u2032S of G\u2032 .\n\u0003\n3.2. Overview of the proof of Theorem 3. Let G be our given oriented graph. The\nrough idea of the proof is to apply the Diregularity lemma and Lemma 8 to obtain a reduced\noriented graph R and a pure oriented graph G\u2217 . The following result of H\u00e4ggkvist implies\nthat R contains a 1-factor.\nTheorem 11 (H\u00e4ggkvist [10]). Let R be an oriented graph with \u03b4\u2217 (R) > (3|R| \u2212 3)/2.\nThen R is strongly connected and contains a 1-factor.\nSo one can apply the Blow-up lemma (together with Proposition 10) to find a 1-factor\nin G\u2217 \u2212 V0 \u2286 G \u2212 V0 . One now would like to glue the cycles of this 1-factor together and\nto incorporate the exceptional vertices to obtain a Hamilton cycle of G\u2217 and thus of G.\nHowever, we were only able to find a method which incorporates a set of vertices whose\nsize is small compared to the cluster size m. This is not necessarily the case for V0 . So we\nproceed as follows. We first choose a random partition of the vertex set of G into two sets A\nand V (G) \\ A having roughly equal size. We then apply the Diregularity lemma to G \u2212 A\nin order to obtain clusters V1 , . . . , Vk and an exceptional set V0 . We let m denote the size of\n\n\f10\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nthese clusters and set B := V1 \u222a. . . Vk . By arguing as indicated above, we can find a Hamilton\ncycle CB in G[B]. We then apply the Diregularity lemma to G \u2212 B, but with an \u03b5 which is\nsmall compared to 1/k, to obtain clusters V1\u2032 , . . . , Vl\u2032 and an exceptional set V0\u2032 . Since the\nchoice of our partition A, V (G)\\A will imply that \u03b4\u2217 (G\u2212B) \u2265 (3/2+\u03b1/2)|G\u2212B| we can again\nargue as before to obtain a cycle CA which covers precisely the vertices in A\u2032 := V1\u2032 \u222a * * * \u222a Vl\u2032 .\nSince we have chosen \u03b5 to be small compared to 1/k, the set V0\u2032 of exceptional vertices is now\nsmall enough to be incorporated into our first cycle CB . (Actually, CB is only determined\nat this point and not yet earlier on.) Moreover, by choosing CB and CA suitably we can\nensure that they can be joined together into the desired Hamilton cycle of G.\n4. Shifted Walks\nIn this section we will introduce the tools we need in order to glue certain cycles together\nand to incorporate the exceptional vertices. Let R\u2217 be a digraph and let C be a collection\nof disjoint cycles in R\u2217 . We call a closed walk W in R\u2217 balanced w.r.t. C if\n\u2022 for each cycle C \u2208 C the walk W visits all the vertices on C an equal number of\ntimes,\n\u2022 W visits every vertex of R\u2217 ,\n\u2022 every vertex not in any cycle from C is visited exactly once.\nLet us now explain why balanced walks are helpful in order to incorporate the exceptional\nvertices. Suppose that C is a 1-factor of the reduced oriented graph R and that R\u2217 is\nobtained from R by adding all the exceptional vertices v \u2208 V0 and adding an edge vVi\n(where Vi is a cluster) whenever v sends edges to a significant proportion of the vertices\nin Vi , say we add vVi whenever v sends at least cm edges to Vi . (Recall that m denotes the\nsize of the clusters.) The edges in R\u2217 of the form Vi v are defined in a similar way. Let Gc be\nthe oriented graph obtained from the pure oriented graph G\u2217 by making all the non-empty\nbipartite subgraphs between the clusters complete (and orienting all the edges between these\nclusters in the direction induced by R) and adding the vertices in V0 as well as all the edges\nof G between V0 and V (G \u2212 V0 ). Suppose that W is a balanced closed walk in R\u2217 which\nvisits all the vertices lying on a cycle C \u2208 C precisely mC \u2264 m times. Furthermore, suppose\nthat |V0 | \u2264 cm/2 and that the vertices in V0 have distance at least 3 from each other on W .\nThen by 'winding around' each cycle C \u2208 C precisely m \u2212 mC times (at the point when W\nfirst visits C) we can obtain a Hamilton cycle in Gc . Indeed, the two conditions on V0 ensure\nthat the neighbours of each v \u2208 V0 on the Hamilton cycle can be chosen amongst the at\nleast cm neighbours of v in the neighbouring clusters of v on W in such a way that they\nare distinct for different exceptional vertices. The idea then is to apply the Blow-up lemma\nto show that this Hamilton cycle corresponds to one in G. So our aim is to find such a\nbalanced closed walk in R\u2217 . However, as indicated in Section 3.2, the difficulties arising\nwhen trying to ensure that the exceptional vertices lie on this walk will force us to apply\nthe above argument to the subgraphs induced by a random partition of our given oriented\ngraph G.\nLet us now go back to the case when R\u2217 is an arbitrary digraph and C is a collection of\ndisjoint cycles in R\u2217 . Given vertices a, b \u2208 R\u2217 , a shifted a-b walk is a walk of the form\nW = aa1 C1 b1 a2 C2 b2 . . . at Ct bt b\nwhere C1 , . . . , Ct are (not necessarily distinct) cycles from C and ai is the successor of bi\non Ci for all i \u2264 t. (We might have t = 0. So an edge ab is a shifted a-b walk.) We\ncall C1 , . . . , Ct the cycles which are traversed by W . So even if the cycles C1 , . . . , Ct are\nnot distinct, we say that W traverses t cycles. Note that for every cycle C \u2208 C the walk\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n11\n\nW \u2212 {a, b} visits the vertices on C an equal number of times. Thus it will turn out that by\njoining the cycles from C suitably via shifted walks and incorporating those vertices of R\u2217\nnot covered by the cycles from C we can obtain a balanced closed walk on R\u2217 .\nOur next lemma will be used to show that if R\u2217 is oriented and \u03b4\u2217 (R\u2217 ) \u2265 (3/2 + \u03b1)|R\u2217 |\nthen any two vertices of R\u2217 can be joined by a shifted walk traversing only a small number\nof cycles from C (see Corollary 14). The lemma itself shows that the \u03b4\u2217 condition implies\nexpansion, and this will give us the 'expansion with respect to shifted neighbourhoods'\nwe need for the existence of shifted walks. The proof of Lemma 12 is similar to that of\nTheorem 11.\nLemma 12. Let R\u2217 be an oriented graph on N vertices with \u03b4\u2217 (R\u2217 ) \u2265 (3/2 + \u03b1)N for some\n\u03b1 > 0. If X \u2286 V (R\u2217 ) is nonempty and |X| \u2264 (1 \u2212 \u03b1)N then |N + (X)| \u2265 |X| + \u03b1N/2.\nProof. For simplicity, we write \u03b4 := \u03b4(R\u2217 ), \u03b4+ := \u03b4+ (R\u2217 ) and \u03b4\u2212 := \u03b4\u2212 (R\u2217 ). Suppose the\nassertion is false, i.e. there exists X \u2286 V (R\u2217 ) with |X| \u2264 (1 \u2212 \u03b1)N and\nN + (X) < |X| + \u03b1N/2.\n\n(6)\n\nWe consider the following partition of V (R\u2217 ):\nA := X \u2229 N + (X), B := N + (X)\\X, C := V (R\u2217 )\\(X \u222a N + (X)), D := X\\N + (X).\n(6) gives us\n|D| + \u03b1N/2 > |B|.\n\n(7)\n\nSuppose A 6= \u2205. Then by an averaging argument there exists x \u2208 A with |N + (x) \u2229 A| <\n|A|/2. Hence \u03b4+ \u2264 |N + (x)| < |B| + |A|/2. Combining this with (7) we get\n|A| + |B| + |D| \u2265 2\u03b4+ \u2212 \u03b1N/2.\n\n(8)\n\nIf A = \u2205 then N + (X) = B and so (7) implies |D| + \u03b1N/2 \u2265 |B| \u2265 \u03b4+ . Thus (8) again holds.\nSimilarly, if C 6= \u2205 then considering the inneighbourhood of a suitable vertex x \u2208 C gives\n|B| + |C| + |D| \u2265 2\u03b4\u2212 \u2212 \u03b1N/2.\n\n(9)\n\nIf C = \u2205 then the fact that |X| \u2264 (1 \u2212 \u03b1)N and (6) together imply that D 6= \u2205. But then\nN \u2212 (D) \u2286 B and thus |B| \u2265 \u03b4\u2212 . Together with (7) this shows that (9) holds in this case\ntoo.\nIf D = \u2205 then trivially |A| + |B| + |C| = N \u2265 \u03b4. If not, then for any x \u2208 D we have\nN (x) \u2229 D = \u2205 and hence\n|A| + |B| + |C| \u2265 |N (x)| \u2265 \u03b4.\n\n(10)\n\nCombining (8), (9) and (10) gives\n3|A| + 4|B| + 3|C| + 2|D| \u2265 2\u03b4\u2212 + 2\u03b4+ + 2\u03b4 \u2212 \u03b1N = 2\u03b4\u2217 (R\u2217 ) \u2212 \u03b1N.\nFinally, substituting (7) gives\n3N + \u03b1N/2 \u2265 2\u03b4\u2217 (R\u2217 ) \u2212 \u03b1N \u2265 3N + \u03b1N,\nwhich is a contradiction.\n\n\u0003\n\n\f12\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nAs indicated before, we will now use Lemma 12 to prove the existence of shifted walks\nin R\u2217 traversing only a small number of cycles from a given 1-factor of R\u2217 . For this (and\nlater on) the following fact will be useful.\nFact 13. Let G be an oriented graph with \u03b4\u2217 (G) \u2265 (3/2 + \u03b1)|G| for some constant \u03b1 > 0.\nThen \u03b40 (G) > \u03b1|G|.\nProof. Suppose that \u03b4\u2212 (G) \u2264 \u03b1|G|. As G is oriented we have that \u03b4+ (G) < |G|/2 and so\n\u03b4\u2217 (G) < 3n/2 + \u03b1|G|, a contradiction. The proof for \u03b4+ (G) is similar.\n\u0003\nCorollary 14. Let R\u2217 be an oriented graph on N vertices with \u03b4\u2217 (R\u2217 ) \u2265 (3/2 + \u03b1)N for\nsome \u03b1 > 0 and let C be a 1-factor in R\u2217 . Then for any distinct x, y \u2208 V (R\u2217 ) there exists a\nshifted x-y walk traversing at most 2/\u03b1 cycles from C.\nProof. Let Xi be the set of vertices v for which there is a shifted x-v walk which traverses\nat most i cycles. So X0 = N + (x) 6= \u2205 and Xi+1 = N + (Xi\u2212 ) \u222a Xi , where Xi\u2212 is the set of\nall predecessors of the vertices in Xi on the cycles from C. Suppose that |Xi | \u2264 (1 \u2212 \u03b1)N .\nThen Lemma 12 implies that\n|Xi+1 | \u2265 |N + (Xi\u2212 )| \u2265 |Xi\u2212 | + \u03b1N/2 = |Xi | + \u03b1N/2.\n\nSo for i\u2217 := \u230a2/\u03b1\u230b\u2212 1, we must have |Xi\u2212\u2217 | = |Xi\u2217 | \u2265 (1\u2212 \u03b1)N . But |N \u2212 (y)| \u2265 \u03b4\u2212 (R\u2217 ) > \u03b1N\nand so N \u2212 (y) \u2229 Xi\u2212\u2217 6= \u2205. In other words, y \u2208 N + (Xi\u2212\u2217 ) and so there is a shifted x-y walk\ntraversing at most i\u2217 + 1 cycles.\n\u0003\nCorollary 15. Let R\u2217 be an oriented graph with \u03b4\u2217 (R\u2217 ) \u2265 (3/2 + \u03b1) |R\u2217 | for some 0 < \u03b1 \u2264\n1/6 and let C be a 1-factor in R\u2217 . Then R\u2217 contains a closed walk which is balanced w.r.t. C\nand meets every vertex at most |R\u2217 |/\u03b1 times and traverses each edge lying on a cycle from C\nat least once.\nProof. Let C1 , . . . , Cs be an arbitrary ordering of the cycles in C. For each cycle Ci pick a\nvertex ci \u2208 Ci . Denote by c+\ni the successor of ci on the cycle Ci . Corollary 14 implies that\nfor all i there exists a shifted ci -c+\ni+1 walk Wi traversing at most 2/\u03b1 cycles from C, where\ncs+1 := c1 . Then the closed walk\n+\n+\n+\nW \u2032 := c+\n1 C1 c1 W1 c2 C2 c2 . . . Ws\u22121 cs Cs cs Ws c1\n\nis balanced w.r.t. C by the definition of shifted walks. Since each shifted walk Wi traverses\nat most 2/\u03b1 cycles of C, the closed walk W meets each vertex at most (|R\u2217 | /3)(2/\u03b1) + 1\ntimes. Let W denote the walk obtained from W \u2032 by 'winding around' each cycle C \u2208 C\nonce more. (That is, for each C \u2208 C pick a vertex v on C and replace one of the occurences\nof v on W \u2032 by vCv.) Then W is still balanced w.r.t. C, traverses each edge lying on a cycle\nfrom C at least once and visits each vertex of R\u2217 at most (|R\u2217 | /3)(2/\u03b1) + 2 \u2264 |R\u2217 | /\u03b1 times\nas required.\n\u0003\n5. Proof of Theorem 3\n5.1. Partitioning G and applying the Diregularity lemma. Let G be an oriented\ngraph on n vertices with \u03b4\u2217 (G) \u2265 (3/2 + \u03b1)n for some constant \u03b1 > 0. Clearly we may\nassume that \u03b1 \u226a 1. Define positive constants \u03b5, d and integers MA\u2032 , MB\u2032 such that\n1/MA\u2032 \u226a 1/MB\u2032 \u226a \u03b5 \u226a d \u226a \u03b1 \u226a 1.\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n13\n\nThroughout this section, we will assume that n is sufficiently large compared to MA\u2032 for our\nestimates to hold. Choose a subset A \u2286 V (G) with (1/2 \u2212 \u03b5)n \u2264 |A| \u2264 (1/2 + \u03b5)n and such\nthat every vertex x \u2208 G satisfies\n\u03b1\n|N + (x) \u2229 A|\nd+ (x)\n\u03b1\nd+ (x)\n\u2212\n\u2264\n\u2264\n+\nn\n10\n|A|\nn\n10\n\nand such that N \u2212 (x) \u2229 A satisfies a similar condition. (The existence of such a set A\ncan be shown by considering a random partition of V (G).) Apply the Diregularity lemma\n(Lemma 7) with parameters \u03b52 , d + 8\u03b52 and MB\u2032 to G \u2212 A to obtain a partition of the vertex\nset of G\u2212 A into k \u2265 MB\u2032 clusters V1 , . . . , Vk and an exceptional set V0 . Set B := V1 \u222a . . .\u222a Vk\nand mB := |V1 | = * * * = |Vk |. Let RB denote the reduced oriented graph obtained by an\napplication of Lemma 8 and let G\u2217B be the pure oriented graph. Since \u03b4+ (G \u2212 A)/|G \u2212 A| \u2265\n\u03b4+ (G)/n \u2212 \u03b1/9 by our choice of A, Lemma 8 implies that\n(11)\n\n\u03b4+ (RB ) \u2265 (\u03b4+ (G)/n \u2212 \u03b1/8)|RB |.\n\nSimilarly\n(12)\n\n\u03b4\u2212 (RB ) \u2265 (\u03b4\u2212 (G)/n \u2212 \u03b1/8)|RB |\n\nand \u03b4(RB ) \u2265 (\u03b4(G)/n \u2212 \u03b1/4)|RB |. Altogether this implies that\n(13)\n\n\u03b4\u2217 (RB ) \u2265 (3/2 + \u03b1/2)|RB |.\n\nSo Theorem 11 gives us a 1-factor CB of RB . We now apply Proposition 10 with CB playing\nthe role of S, \u03b52 playing the role of \u03b5 and d + 8\u03b52 playing the role of d. This shows that\nby adding at most 4\u03b52 n further vertices to the exceptional set V0 we may assume that each\nedge of RB corresponds to an \u03b5-regular\npair of density d (in the underlying graph of G\u2217B )\nS\nand that each edge in the union C\u2208CB C \u2286 RB of all the cycles from CB corresponds to\nan (\u03b5, d)-superregular pair. (More formally, this means that we replace the clusters with\nthe subclusters given by Proposition 10 and replace G\u2217B with its oriented subgraph obtained\nby deleting all edges not corresponding to edges of the graph G\u2032CB given by Proposition 10,\ni.e. the underlying graph of G\u2217B will now be G\u2032CB .) Note that the new exceptional set now\nsatisfies |V0 | \u2264 \u03b5n.\nApply Corollary 15 with R\u2217 := RB to find a closed walk WB in RB which is balanced\nw.r.t. CB , meets every cluster at most 2|RB |/\u03b1 times and traverses all the edges lying on a\ncycle from CB at least once.\nLet GcB be the oriented graph obtained from G\u2217B by adding all the Vi -Vj edges for all those\npairs Vi , Vj of clusters with Vi Vj \u2208 E(RB ). Since 2|RB |/\u03b1 \u226a mB , we could make WB into a\nHamilton cycle of GcB by 'winding around' each cycle from CB a suitable number of times.\nWe could then apply the Blow-up lemma to show that this Hamilton cycle corresponds to\none in G\u2217B . However, as indicated in Section 3.2, we will argue slightly differently as it is\nnot clear how to incorporate all the exceptional vertices by the above approach.\nSet \u03b5A := \u03b5/|RB |. Apply the Diregularity lemma with parameters \u03b52A , d + 8\u03b52A and MA\u2032\nto G[A \u222a V0 ] to obtain a partition of the vertex set of G[A \u222a V0 ] into l \u2265 MA\u2032 clusters\nV1\u2032 , . . . , Vl\u2032 and an exceptional set V0\u2032 . Let A\u2032 := V1\u2032 \u222a * * * \u222a Vl\u2032 , let RA denote the reduced\noriented graph obtained from Lemma 8 and let G\u2217A be the pure oriented graph. Similarly\nas in (13), Lemma 8 implies that \u03b4\u2217 (RA ) \u2265 (3/2 + \u03b1/2)|RA | and so, as before, we can\napply Theorem 11 to find a 1-factor CA of RA . Then as before, Proposition 10 implies\nthat by adding at most 4\u03b52A n further vertices to the exceptional set V0\u2032 we may assume that\neach edge of RA corresponds to an \u03b5A -regular pair of density d and that each edge in the\n\n\f14\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nPSfrag replacements\nC1\n\nU1\n\nC2\n\nU2\nv\nU2+\n\nU1\u2212\nWv\n\nFigure 2. Incorporating the exceptional vertex v.\nS\nunion C\u2208CA C \u2286 RA of all the cycles from CA corresponds to an (\u03b5A , d)-superregular pair.\nSo we now have that\n|V0\u2032 | \u2264 \u03b5A n = \u03b5n/|RB |.\n\n(14)\n\nSimilarly as before, Corollary 15 gives us a closed walk WA in RA which is balanced w.r.t. CA ,\nmeets every cluster at most 2|RA |/\u03b1 times and traverses all the edges lying on a cycle from CA\nat least once.\n5.2. Incorporating V0\u2032 into the walk WB . Recall that the balanced closed walk WB\nin RB corresponds to a Hamilton cycle in GcB . Our next aim is to extend this walk to one\nwhich corresponds to a Hamilton cycle which also contains the vertices in V0\u2032 . (The Blow-up\nlemma will imply that the latter Hamilton cycle corresponds to one in G[B \u222a V0\u2032 ].) We do\n\u2217 \u2287 R with vertex set\nthis by extending WB into a walk on a suitably defined digraph RB\nB\n\u2217 is obtained from\nV (RB ) \u222a V0\u2032 in such a way that the new walk is balanced w.r.t. CB . RB\nthe union of RB and the set V0\u2032 by adding an edge vVi between a vertex v \u2208 V0\u2032 and a\ncluster Vi \u2208 V (RB ) whenever NG+ (v) \u2229 Vi > \u03b1mB /10 and adding the edge Vi v whenever\nNG\u2212 (v) \u2229 Vi > \u03b1mB /10. Thus\n|NG+ (v) \u2229 B| \u2264 |NR+\u2217 (v)|mB + |RB |\u03b1mB /10.\nB\n\nHence\n|NR+\u2217 (v)| \u2265 |NG+ (v) \u2229 B|/mB \u2212 \u03b1|RB |/10 \u2265 |NG+ (v) \u2229 B||RB |/|B| \u2212 \u03b1|RB |/10\nB\n\n(15)\n\n+\n(v)| \u2212 |V0 |)|RB |/|G \u2212 A| \u2212 \u03b1|RB |/10\n\u2265 (|NG\u2212A\n\n\u2265 (\u03b4+ (G)/n \u2212 \u03b1/2)|RB | \u2265 \u03b1|RB |/2.\n\n(The penultimate inequality follows from the choice of A and the final one from Fact 13.)\nSimilarly\n|NR\u2212\u2217 (v)| \u2265 \u03b1|RB |/2.\nB\n\nGiven a vertex v \u2208 V0\u2032 pick U1 \u2208 NR+\u2217 (v), U2 \u2208 NR\u2212\u2217 (v)\\{U1 }. Let C1 and C2 denote the\nB\n\nB\n\ncycles from CB containing U1 and U2 respectively. Let U1\u2212 be the predecessor of U1 on C1 ,\nand U2+ be the successor of U2 on C2 . (15) implies that we can ensure U1\u2212 6= U2+ . (However,\nwe may have C1 = C2 .) Corollary 14 gives us a shifted walk Wv from U1\u2212 to U2+ traversing\nat most 4/\u03b1 cycles of CB . To incorporate v into the walk WB , recall that WB traverses all\nthose edges of RB which lie on cycles from CB at least once. Replace one of the occurences\nof U1\u2212 U1 on WB with the walk\nWv\u2032 := U1\u2212 Wv U2+ C2 U2 vU1 C1 U1 ,\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n15\n\ni.e. the walk that goes from U1\u2212 to U2+ along the shifted walk Wv , it then winds once\naround C2 but stops in U2 , then it goes to v and further to U1 , and finally it winds around C1 .\nThe walk obtained from WB by including v in this way is still balanced w.r.t. CB , i.e. each\nvertex in RB is visited the same number of times as every other vertex lying on the same\ncycle from CB . We add the extra loop around C1 because when applying the Blow-up lemma\nwe will need the vertices in V0\u2032 to be at a distance of at least 4 from each other. Using this\nloop, this can be ensured as follows. After we have incorporated v into WB we 'ban' all\nthe 6 edges of (the new walk) WB whose endvertices both have distance at most 3 from v.\nThe extra loop ensures that every edge in each cycle from C has at least one occurence\nin WB which is not banned. (Note that we do not have to add an extra loop around C2\nsince if C2 6= C1 then all the banned edges of C2 lie on Wv\u2032 but each edge of C2 also occurs\non the original walk WB .) Thus when incorporating the next exceptional vertex we can\nalways pick an occurence of an edge which is not banned to be replaced by a longer walk.\n(When incorporating v we picked U1\u2212 U1 .) Repeating this argument, we can incorporate all\nthe exceptional vertices in V0\u2032 into WB in such a way that all the vertices of V0\u2032 have distance\nat least 4 on the new walk WB .\nRecall that GcB denotes the oriented graph obtained from the pure oriented graph G\u2217B by\nadding all the Vi -Vj edges for all those pairs Vi , Vj of clusters with Vi Vj \u2208 E(RB ). Let GcB\u222aV \u2032\n0\ndenote the graph obtained from GcB by adding all the V0\u2032 -B edges of G as well as all the\nB-V0\u2032 edges of G. Moreover, recall that the vertices in V0\u2032 have distance at least 4 from each\nother on WB and |V0\u2032 | \u2264 \u03b5n/|RB | \u226a \u03b1mB /20 by (14). As already observed at the beginning\nof Section 4, altogether this shows that by winding around each cycle from CB , one can\nc\nc\nobtain a Hamilton cycle CB\u222aV\n\u2032 of GB\u222aV \u2032 from the walk WB , provided that WB visits any\n0\n0\ncluster Vi \u2208 RB at most mB times. To see that the latter condition holds, recall that before\nwe incorporated the exceptional vertices in V0\u2032 into WB , each cluster was visited at most\n2|RB |/\u03b1 times. When incorporating an exceptional vertex we replaced an edge of WB by a\nwalk whose interior visits every cluster at most 4/\u03b1+2 \u2264 5/\u03b1 times. Thus the final walk WB\nvisits each cluster Vi \u2208 RB at most\n(14)\n\u221a\n(16)\n2|RB |/\u03b1 + 5|V0\u2032 |/\u03b1 \u2264 6\u03b5n/(\u03b1|RB |) \u2264 \u03b5mB\nc\nc\ntimes. Hence we have the desired Hamilton cycle CB\u222aV\n\u2032 of GB\u222aV \u2032 . Note that (16) implies\n0\n0\nc\nthat we can choose CB\u222aV \u2032 in such a way that for each cycle C \u2208 CB there is subpath PC\n0\nc\nof CB\u222aV\n\u2032 which winds around C at least\n0\n\u221a\n(17)\n(1 \u2212 \u03b5)mB\n\ntimes in succession.\n\n5.3. Applying the Blow-up lemma to find a Hamilton cycle in G[B \u222a V0\u2032 ]. Our\nc\nnext aim is to use the Blow-up lemma to show that CB\u222aV\n\u2032 corresponds to a Hamilton\n0\n\u2032\ncycle in G[B \u222a V0 ]. Recall that k = |RB | and that for each exceptional vertex v \u2208 V0\u2032 the\noutneighbour U1 of v on WB is distinct from its inneighbour U2 on WB . We will apply\n\u2217\nc\nthe Blow-up lemma with H being the underlying graph of CB\u222aV\n\u2032 and G being the graph\n0\nobtained from the underlying graph of G\u2217B by adding all the vertices v \u2208 V0\u2032 and joining\neach such v to all the vertices in NG+ (v) \u2229 U1 as well as to all the vertices in NG\u2212 (v) \u2229 U2 .\nRecall that after applying the Diregularity lemma to obtain the clusters V1 , . . . , Vk we used\nProposition 10 to ensure that each edge of RB corresponds to an \u03b5-regular pair of density d\n(in the underlying graph of G\u2217B and thus also in G\u2217 ) and that each edge of the union\nS\nC\u2208CB C \u2286 RB of all the cycles from CB corresponds to an (\u03b5, d)-superregular pair.\n\n\f16\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\nV0\u2032 will play the role of V0 in the Blow-up lemma and we take L0 , L1 , . . . , Lk to be the\npartition of H induced by V0\u2032 , V1 , . . . , Vk . \u03c6 : L0 \u2192 V0\u2032 will be the obvious bijection (i.e. the\nidentity). To define the set I \u2286 V (H) of vertices of distance at least 4 from each other\nwhich is used in the Blow-up lemma, let PC\u2032 be the subpath of H corresponding to PC (for\nall C \u2208 CB ). For each i = 1, . . . , k, let Ci \u2208 CB denote the cycle containing Vi and let\nJi \u2286 Li consist of all those vertices in Li \u2229 V (PC\u2032 i ) which have distance at least 4 from the\nendvertices of PC\u2032 i . Thus in the graph H each vertex u \u2208 Ji has one of its neighbours in the\n+\nset L\u2212\ni corresponding to the predecessor of Vi on Ci and its other neighbour in the set Li\ncorresponding to the successor of Vi on Ci . Moreover, all the vertices in Ji have distance at\nleast 4 from all the vertices in L0 and (17) implies that |Ji | \u2265 9mB /10. It is easy to see that\nS\none can greedily choose a set Ii \u2286 Ji of size mB /10 such that the vertices in ki=1 Ii have\nSk\ndistance at least 4 from each other. We take I := L0 \u222a i=1 Ii .\nLet us now check conditions (C1)\u2013(C9). (C1) holds with K1 := 1 since |L0 | = |V0\u2032 | \u2264\n\u03b5A n = \u03b5n/k \u2264 d|H|. (C2) holds by definition of I. (C3) holds since H is a Hamilton cycle\nin GcB\u222aV \u2032 (c.f. the definition of the graph GcB\u222aV \u2032 ). This also implies that for every edge\n0\n0\nxy \u2208 H with x \u2208 Li , y \u2208 Lj (i, j \u2265 1) we must have that Vi Vj \u2208 E(RB ). Thus (C6) holds as\nevery edge of RB corresponds to an \u03b5-regular pair of clusters having density d. (C4) holds\nwith K2 := 1 because\n(14)\n|NH (L0 ) \u2229 Li | \u2264 2 |L0 | = 2 V0\u2032 \u2264 2\u03b5n/|RB | \u2264 5\u03b5mB \u2264 dmB .\n\nFor (C5) we need to find a set D \u2286 I of buffer vertices. Pick any set Di \u2286 Ii with |Di | = \u03b4\u2032 mB\nS\nand let D := ki=1 Di . Since Ii \u2286 Ji we have that |NH (D) \u2229 Lj | = 2\u03b4\u2032 mB for all j = 1, . . . , k.\nHence\n||NH (D) \u2229 Li | \u2212 |NH (D) \u2229 Lj || = 0\nfor all 1 \u2264 i < j \u2264 k and so (C5) holds. (C7) holds with c := \u03b1/10 by our choice U1 \u2208 NR+\u2217 (v)\nB\n\nand U2 \u2208 NR\u2212\u2217 (v) of the neighbours of each vertex v \u2208 V0\u2032 in the walk WB (c.f. the definition\nB\n\u2217 ).\nof the graph RB\n(C8) and (C9) are now the only conditions we need to check. Given a set Ei \u2286 Vi of size\nat most \u03b5\u2032 mB , we wish to find Fi \u2286 (Li \u2229 (I \\ D)) = Ii \\ D and a bijection \u03c6i : Ei \u2192 Fi\nsuch that every v \u2208 Ei has a large number of neighbours in every cluster Vj for which Lj\ncontains a neighbour of \u03c6i (v). Pick any set Fi \u2286 Ii \\ D of size |Ei |. (This can be done since\n|D \u2229 Ii | = \u03b4\u2032 mB and so |Ii \\ D| \u2265 mB /10 \u2212 \u03b4\u2032 mB \u226b \u03b5\u2032 mB .) Let \u03c6i : Ei \u2192 Fi be an arbitrary\nbijection. To see that (C8) holds with these choices, consider any vertex v \u2208 Ei \u2286 Vi and\nlet j be such that Lj contains a neighbour of \u03c6i (v) in H. Since \u03c6i (v) \u2208 Fi \u2286 Ii \u2286 Ji , this\nmeans that Vj must be a neighbour of Vi on the cycle Ci \u2208 CB containing\nVi . But this\nS\n\u2217\nimplies that |NG (v) \u2229 Vj | \u2265 (d \u2212 \u03b5)mB since each edge of the union C\u2208CB C \u2286 RB of all\nthe cycles from CB corresponds to an (\u03b5, d)-superregular pair in G\u2217 .\nS\nFinally, writing F := ki=1 Fi we have\n|NH (F ) \u2229 Li | \u2264 2\u03b5\u2032 mB\n\n(since Fj \u2286 Jj for each j = 1, . . . , k) and so (C9) is satisfied with K3 := 2. Hence (C1)\u2013(C9)\nhold and so we can apply the Blow-up lemma to obtain a Hamilton cycle in G\u2217 such that\nthe image of Li is Vi for all i = 1, . . . , k and the image of each x \u2208 L0 is \u03c6(x) \u2208 V0 . (Recall\nthat G\u2217 was obtained from the underlying graph of G\u2217B by adding all the vertices v \u2208 V0\u2032\nand joining each such v to all the vertices in NG+ (v) \u2229 U1 as well as to all the vertices in\nNG\u2212 (v) \u2229 U2 , where U1 and U2 are the neighbours of v on the walk WB .) Using the fact\nc\nthat H was obtained from the (directed) Hamilton cycle CB\u222aV\n\u2032 and since U1 6= U2 for each\n0\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n17\n\nv \u2208 V0\u2032 , it is easy to see that our Hamilton cycle in G\u2217 corresponds to a (directed) Hamilton\ncycle CB in G[B \u222a V0\u2032 ].\n5.4. Finding a Hamilton cycle in G. The last step of the proof is to find a Hamilton\ncycle in G[A\u2032 ] which can be connected with CB into a Hamilton cycle of G. Pick an arbitrary\nedge v1 v2 on CB and add an extra vertex v \u2217 to G[A\u2032 ] with outneighbourhood NG+ (v1 ) \u2229 A\u2032\nand inneighbourhood NG\u2212 (v2 ) \u2229 A\u2032 . A Hamilton cycle CA in the digraph thus obtained\nfrom G[A\u2032 ] can be extended to a Hamilton cycle of G by replacing v \u2217 with v2 CB v1 . To find\nsuch a Hamilton cycle CA , we can argue as before. This time, there is only one exceptional\nvertex, namely v \u2217 , which we incorporate into the walk WA . Note that by our choice of A\nand B the analogue of (15) is satisfied and so this can be done as before. We then use the\nBlow-up lemma to obtain the desired Hamilton cycle CA corresponding to this walk.\n6. Proof of Theorem 4\nThe following observation guarantees that every oriented graph as in Theorem 4 has large\nminimum semidegree.\nFact 16. Suppose that 0 < \u03b1 < 1 and that G is an oriented graph such that d+ (x) + d\u2212 (y) \u2265\n(3/4 + \u03b1)|G| whenever xy \u2208\n/ E(G). Then \u03b40 (G) \u2265 |G|/8 + \u03b1|G|/2.\n\nProof. Suppose not. We may assume that \u03b4+ (G) \u2264 \u03b4\u2212 (G). Pick a vertex x with d+ (x) =\n\u03b4+ (G). Let Y be the set of all those vertices y with xy \u2208\n/ E(G). Thus |Y | \u2265 7|G|/8 \u2212 \u03b1|G|/2.\n\u2212\n+\nMoreover, d (y) \u2265 (3/4 + \u03b1)|G| \u2212 d (x) \u2265 5|G|/8 + \u03b1|G|/2. Hence e(G) \u2265 |Y |(5|G|/8 +\n\u03b1|G|/2) > 35|G|2 /64, a contradiction.\n\u0003\n\nThe proof of Theorem 4 is similar to that of Theorem 3. Fact 16 and Lemma 8 together\nimply that the reduced oriented graph RA (and similarly RB ) has minimum semidegree\nat least |R|/8 and it inherits the Ore-type condition from G (i.e. it satisfies condition (d)\nof Lemma 8 with c = 3/4 + \u03b1). Together with Lemma 17 below (which is an analogue\nof Lemma 12) this implies that RA (and RB as well) is an expander in the sense that\n|N + (X)| \u2265 |X| + \u03b1|RA |/2 for all X \u2286 V (RA ) with |X| \u2264 (1 \u2212 \u03b1)|RA |. In particular, RA\n(and similarly RB ) has a 1-factor: To see this, note that the above expansion property\ntogether with Fact 16 imply that for any X \u2286 V (RA ), we have |NR+A (X)| \u2265 |X|. Together\nwith Hall's theorem, this means that the following bipartite graph H has a perfect matching:\nthe vertex classes W1 , W2 are 2 copies of V (RA ) and we have an edge in H between w1 \u2208 W1\nand w2 \u2208 W2 if there is an edge from w1 to w2 in RA . But clearly a perfect matching in H\ncorresponds to a 1-factor in RA . Using these facts, one can now argue precisely as in the\nproof of Theorem 3.\nLemma 17. Suppose that 0 < \u03b5 \u226a \u03b1 \u226a 1. Let R\u2217 be an oriented graph on N vertices and\nlet U be a set of at most \u03b5N 2 ordered pairs of vertices of R\u2217 . Suppose that d+ (x) + d\u2212 (y) \u2265\n(3/4 + \u03b1)N for all xy \u2208\n/ E(R\u2217 ) \u222a U . Then any X \u2286 V (R\u2217 ) with \u03b1N \u2264 |X| \u2264 (1 \u2212 \u03b1)N\nsatisfies |N + (X)| \u2265 |X| + \u03b1N/2.\nProof. The proof is similar to that of Lemma 12. Suppose that Lemma 17 does not hold\nand let X \u2286 V (R\u2217 ) with \u03b1N \u2264 |X| \u2264 (1 \u2212 \u03b1)N be such that\n\nN + (X) < |X| + \u03b1N/2.\n\u221a\n\u221a\nCall a vertex of R\u2217 good if it lies in at most \u03b5N pairs from U . Thus all but at most 2 \u03b5N\nvertices of R\u2217 are good. As in the proof of Lemma 12 we consider the following partition of\nV (R\u2217 ):\n(18)\n\nA := X \u2229 N + (X), B := N + (X)\\X, C := V (R\u2217 )\\(X \u222a N + (X)), D := X\\N + (X).\n\n\f18\n\nLUKE KELLY, DANIELA K\u00dcHN AND DERYK OSTHUS\n\n(18) implies\n|D| + \u03b1N/2 > |B|.\n\u221a\nSuppose first that |D| > 2 \u03b5N . It is easy to see that there are vertices x 6= y in D\nsuch that xy, yx \u2208\n/ U . Since no edge of R\u2217 lies within D we have xy, yx \u2208\n/ E(R\u2217 ) and so\nd(x) + d(y) \u2265 3N/2 + 2\u03b1N . In particular, at least one of x, y has degree at least 3N/4 + \u03b1N .\nBut then\n\n(19)\n\n|A| + |B| + |C| \u2265 3N/4 + \u03b1N.\n\u221a\nIf |D| \u2264 2 \u03b5N then |A|+|B|+|C| \u2265 N \u2212|D| and so (20) still holds with room to spare. Note\nthat (19) and (20) together imply that 2|A|+2|C| \u2265 3N/2+2\u03b1N \u22122|B| \u2265 3N/2\u2212|B|\u2212|D| \u2265\nN/2. Thus at least one of A, C must have size at least N/8. In particular, this implies that\none of the following 3 cases holds.\n\u221a\nCase 1. |A|, |C| > 2 \u03b5N .\nLet A\u2032 be the set of all good vertices in A. By an averaging argument there exists x \u2208 A\u2032\nwith |N + (x) \u2229 A\u2032 | < |A\u2032 |/2. Since N + (A) \u2286 A \u222a B this implies that |N + (x)| < |B| +\n|A \\ A\u2032 | + |A\u221a\u2032 |/2. Let C \u2032 \u2286 C be the set of all those vertices y \u2208 C with xy \u2208\n/ U . Thus\n|C \\ C \u2032 | \u2264 \u03b5N since x is good. By an averaging argument there exists y \u2208 C \u2032 with\n|N \u2212 (y) \u2229 C \u2032 | < |C \u2032 |/2. But N \u2212 (C) \u2286 B \u222a C and so |N \u2212 (y)| < |B| + |C \\ C \u2032 | + |C \u2032 |/2.\nMoreover, d+ (x) + d\u2212 (y) \u2265 3N/4 + \u03b1N since xy \u2208\n/ E(R\u2217 ) \u222a U . Altogether this shows that\n(20)\n\n|A\u2032 |/2 + |C \u2032 |/2 + 2|B| \u2265 d+ (x) + d\u2212 (y) \u2212 |A \\ A\u2032 | \u2212 |C \\ C \u2032 | \u2265 3N/4 + \u03b1N/2.\n\nTogether with (20) this implies that 3|A| + 6|B| + 3|C| \u2265 3N + 3\u03b1N , which in turn together\nwith (19) yields 3|A| + 3|B| + 3|C| + 3|D| \u2265 3N + 3\u03b1N/2, a contradiction.\n\u221a\n\u221a\nCase 2. |A| > 2 \u03b5N and |C| \u2264 2 \u03b5N .\nAs in Case 1 we let A\u2032 be the set of all good vertices in A and pick x \u2208 A\u2032 with |N + (x)|\n\u221a <\n\u2032\n\u2032\n|B| + |A \\ A | + |A |/2. Note that (19) implies that |D| > N \u2212 |X| \u2212 |C| \u2212 \u03b1N/2 \u2265 \u03b5N .\nPick any y \u2208 D such that xy \u2208\n/ U . Then xy \u2208\n/ E(R\u2217 ) since R\u2217 contains no edges from A\n+\n\u2212\nto D. Thus d (x) + d (y) \u2265 3N/4 + \u03b1N . Moreover, N \u2212 (y) \u2286 B \u222a C. Altogether this gives\n|A\u2032 |/2 + 2|B| \u2265 d+ (x) + d\u2212 (y) \u2212 |A \\ A\u2032 | \u2212 |C| \u2265 3N/4 + \u03b1N/2.\n\nAs in Case 1 one can combine this with (20) and (19) to get a contradiction.\n\u221a\n\u221a\nCase 3. |A| \u2264 2 \u03b5N and |C| > 2 \u03b5N .\nThis time we let C \u2032 be the set of all good vertices in C and pick y \u2208 C \u2032 with |N \u2212 (y) \u2229 C \u2032 | <\n|C \u2032 |/2. Hence |N \u2212 (y)| < |B| + |C \\ C \u2032 | + |C \u2032 |/2. Moreover, we must have |D| = |X| \u2212 |A| >\n\u221a\n\u03b5N . Pick any x \u2208 D such that xy \u2208\n/ U . Then xy \u2208\n/ E(R\u2217 ) since R\u2217 contains no edges\n+\n\u2212\nfrom D to C. Thus d (x) + d (y) \u2265 3N/4 + \u03b1N . Moreover, N + (x) \u2286 A \u222a B. Altogether\nthis gives\n|C \u2032 |/2 + 2|B| \u2265 d+ (x) + d\u2212 (y) \u2212 |A| \u2212 |C \\ C \u2032 | \u2265 3N/4 + \u03b1N/2,\nwhich in turn yields a contradiction as before.\n\n\u0003\n\n7. Acknowledgement\nWe are grateful to Peter Keevash for pointing out an argument for the 'shifted expansion\nproperty' which is simpler than the one presented in an earlier version of this manuscript.\n\n\fA DIRAC TYPE RESULT ON HAMILTON CYCLES IN ORIENTED GRAPHS\n\n19\n\nReferences\n[1] N. Alon and A. Shapira, Testing subgraphs in directed graphs, Journal of Computer and System Sciences 69 (2004), 354\u2013382.\n[2] N. Alon and J. Spencer, The Probabilistic Method (2nd edition), Wiley-Interscience 2000.\n[3] J. Bang-Jensen and G. Gutin, Digraphs: Theory, Algorithms and Applications, Springer 2000.\n[4] B. Bollob\u00e1s, Random Graphs (2nd edition), Cambridge University Press 2001.\n[5] B. Bollob\u00e1s and R. H\u00e4ggkvist, Powers of Hamilton cycles in tournaments, J. Combin. Theory B 50\n(1990), 309\u2013318.\n[6] B. Csaba, On the Bollob\u00e1s\u2013Eldridge conjecture for bipartite graphs, Combin. Probab. Comput. 16 (2007),\n661\u2013691.\n[7] B. Csaba, A. Shokoufandeh, and E. Szemer\u00e9di, Proof of a conjecture of Bollob\u00e1s and Eldridge for graphs\nof maximum degree three, Combinatorica 23 (2003), 35\u201372.\n[8] A. Frieze and M. Krivelevich, On packing Hamilton cycles in \u03b5-regular graphs, J. Combin. Theory B 94\n(2005), 159\u2013172.\n[9] A. Ghouila-Houri, Une condition suffisante d'existence d'un circuit hamiltonien, C.R. Acad. Sci. Paris 25\n(1960), 495\u2013497.\n[10] R. H\u00e4ggkvist, Hamilton cycles in oriented graphs, Combin. Probab. Comput. 2 (1993), 25\u201332.\n[11] R. H\u00e4ggkvist and A. Thomason, Oriented Hamilton cycles in oriented graphs, in Combinatorics, Geometry and Probability, Cambridge University Press 1997, 339\u2013353.\n[12] P. Keevash, D. K\u00fchn and D. Osthus, An exact minimum degree condition for Hamilton cycles in oriented\ngraphs, submitted.\n[13] L. Kelly, D. K\u00fchn and D. Osthus, Cycles of given length in oriented graphs, submitted.\n[14] J. Koml\u00f3s, The Blow-up lemma, Combin. Probab. Comput. 8 (1999), 161\u2013176.\n[15] J. Koml\u00f3s, G. N. S\u00e1rk\u00f6zy, and E. Szemer\u00e9di, Blow-up lemma, Combinatorica 17 (1997), 109\u2013123.\n[16] J. Koml\u00f3s and M. Simonovits, Szemer\u00e9di's Regularity Lemma and its applications in graph theory, Bolyai\nSociety Mathematical Studies 2, Combinatorics, Paul Erd\u0151s is Eighty (Vol. 2) (D. Mikl\u00f3s, V. T. S\u00f3s and\nT. Sz\u0151nyi eds.), Budapest (1996), 295\u2013352.\n[17] D. K\u00fchn, D. Osthus and A. Treglown, Hamiltonian degree sequences in digraphs, submitted.\n[18] B. McKay, The asymptotic numbers of regular tournaments, Eulerian digraphs and Eulerian oriented\ngraphs, Combinatorica 10 (1990), 367\u2013377.\n[19] O. Ore, Note on Hamilton circuits, American Math. Monthly 67 (1960), 55.\n[20] C. Thomassen, Long cycles in digraphs with constraints on the degrees, in Surveys in Combinatorics\n(B. Bollob\u00e1s ed.), London Math. Soc. Lecture Notes 38 (1979), 211\u2013228, Cambridge University Press.\n[21] C. Thomassen, Long cycles in digraphs. Proc. London Math. Soc. 42 (1981), 231\u2013251.\n[22] C. Thomassen, Edge-disjoint Hamiltonian paths and cycles in tournaments, Proc. London Math. Soc. 45\n(1982), 151\u2013168.\n[23] D. Woodall, Sufficient conditions for cycles in digraphs, Proc. London Math Soc. 24 (1972), 739\u2013755.\n[24] A. Young, Extremal problems for dense graphs and digraphs, Master's thesis, School of Mathematics,\nUniversity of Birmingham 2005.\nLuke Kelly, Daniela K\u00fchn & Deryk Osthus\nSchool of Mathematics\nUniversity of Birmingham\nEdgbaston\nBirmingham\nB15 2TT\nUK\nE-mail addresses: {kellyl,kuehn,osthus}@maths.bham.ac.uk\n\n\f"}