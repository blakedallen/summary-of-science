{"id": "http://arxiv.org/abs/math/0702800v1", "guidislink": true, "updated": "2007-02-26T21:11:32Z", "updated_parsed": [2007, 2, 26, 21, 11, 32, 0, 57, 0], "published": "2007-02-26T21:11:32Z", "published_parsed": [2007, 2, 26, 21, 11, 32, 0, 57, 0], "title": "Formal Paths, Iterated Integrals and the Center Problem for Ordinary\n  Differential Equations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0702008%2Cmath%2F0702639%2Cmath%2F0702635%2Cmath%2F0702208%2Cmath%2F0702493%2Cmath%2F0702714%2Cmath%2F0702340%2Cmath%2F0702355%2Cmath%2F0702391%2Cmath%2F0702654%2Cmath%2F0702504%2Cmath%2F0702378%2Cmath%2F0702440%2Cmath%2F0702156%2Cmath%2F0702573%2Cmath%2F0702730%2Cmath%2F0702688%2Cmath%2F0702767%2Cmath%2F0702538%2Cmath%2F0702250%2Cmath%2F0702036%2Cmath%2F0702897%2Cmath%2F0702243%2Cmath%2F0702806%2Cmath%2F0702396%2Cmath%2F0702225%2Cmath%2F0702705%2Cmath%2F0702188%2Cmath%2F0702064%2Cmath%2F0702722%2Cmath%2F0702147%2Cmath%2F0702242%2Cmath%2F0702805%2Cmath%2F0702894%2Cmath%2F0702498%2Cmath%2F0702744%2Cmath%2F0702561%2Cmath%2F0702105%2Cmath%2F0702857%2Cmath%2F0702382%2Cmath%2F0702360%2Cmath%2F0702848%2Cmath%2F0702212%2Cmath%2F0702601%2Cmath%2F0702801%2Cmath%2F0702736%2Cmath%2F0702031%2Cmath%2F0702388%2Cmath%2F0702577%2Cmath%2F0702859%2Cmath%2F0702258%2Cmath%2F0702876%2Cmath%2F0702733%2Cmath%2F0702751%2Cmath%2F0702536%2Cmath%2F0702793%2Cmath%2F0702067%2Cmath%2F0702474%2Cmath%2F0702140%2Cmath%2F0702800%2Cmath%2F0702690%2Cmath%2F0702252%2Cmath%2F0702516%2Cmath%2F0702131%2Cmath%2F0702088%2Cmath%2F0702228%2Cmath%2F0702092%2Cmath%2F0702290%2Cmath%2F0702558%2Cmath%2F0702612%2Cmath%2F0702104%2Cmath%2F0702342%2Cmath%2F0702484%2Cmath%2F0702414%2Cmath%2F0702403%2Cmath%2F0702404%2Cmath%2F0702787%2Cmath%2F0702724%2Cmath%2F0702615%2Cmath%2F0702697%2Cmath%2F0702035%2Cmath%2F0702229%2Cmath%2F0702125%2Cmath%2F0702277%2Cmath%2F0702869%2Cmath%2F0702103%2Cmath%2F0702272%2Cmath%2F0702398%2Cmath%2F0702884%2Cmath%2F0702146%2Cmath%2F0702322%2Cmath%2F0702838%2Cmath%2F0702015%2Cmath%2F0702862%2Cmath%2F0702606%2Cmath%2F0702447%2Cmath%2F0702380%2Cmath%2F0702371%2Cmath%2F0702195%2Cmath%2F0702203%2Cmath%2F0702294&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Formal Paths, Iterated Integrals and the Center Problem for Ordinary\n  Differential Equations"}, "summary": "We continue the study of the center problem for the ordinary differential\nequation $v'=\\sum_{i=1}^{\\infty}a_{i}(x)v^{i+1}$ started in our earlier papers.\nIn this paper we present the highlights of the algebraic theory of centers.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0702008%2Cmath%2F0702639%2Cmath%2F0702635%2Cmath%2F0702208%2Cmath%2F0702493%2Cmath%2F0702714%2Cmath%2F0702340%2Cmath%2F0702355%2Cmath%2F0702391%2Cmath%2F0702654%2Cmath%2F0702504%2Cmath%2F0702378%2Cmath%2F0702440%2Cmath%2F0702156%2Cmath%2F0702573%2Cmath%2F0702730%2Cmath%2F0702688%2Cmath%2F0702767%2Cmath%2F0702538%2Cmath%2F0702250%2Cmath%2F0702036%2Cmath%2F0702897%2Cmath%2F0702243%2Cmath%2F0702806%2Cmath%2F0702396%2Cmath%2F0702225%2Cmath%2F0702705%2Cmath%2F0702188%2Cmath%2F0702064%2Cmath%2F0702722%2Cmath%2F0702147%2Cmath%2F0702242%2Cmath%2F0702805%2Cmath%2F0702894%2Cmath%2F0702498%2Cmath%2F0702744%2Cmath%2F0702561%2Cmath%2F0702105%2Cmath%2F0702857%2Cmath%2F0702382%2Cmath%2F0702360%2Cmath%2F0702848%2Cmath%2F0702212%2Cmath%2F0702601%2Cmath%2F0702801%2Cmath%2F0702736%2Cmath%2F0702031%2Cmath%2F0702388%2Cmath%2F0702577%2Cmath%2F0702859%2Cmath%2F0702258%2Cmath%2F0702876%2Cmath%2F0702733%2Cmath%2F0702751%2Cmath%2F0702536%2Cmath%2F0702793%2Cmath%2F0702067%2Cmath%2F0702474%2Cmath%2F0702140%2Cmath%2F0702800%2Cmath%2F0702690%2Cmath%2F0702252%2Cmath%2F0702516%2Cmath%2F0702131%2Cmath%2F0702088%2Cmath%2F0702228%2Cmath%2F0702092%2Cmath%2F0702290%2Cmath%2F0702558%2Cmath%2F0702612%2Cmath%2F0702104%2Cmath%2F0702342%2Cmath%2F0702484%2Cmath%2F0702414%2Cmath%2F0702403%2Cmath%2F0702404%2Cmath%2F0702787%2Cmath%2F0702724%2Cmath%2F0702615%2Cmath%2F0702697%2Cmath%2F0702035%2Cmath%2F0702229%2Cmath%2F0702125%2Cmath%2F0702277%2Cmath%2F0702869%2Cmath%2F0702103%2Cmath%2F0702272%2Cmath%2F0702398%2Cmath%2F0702884%2Cmath%2F0702146%2Cmath%2F0702322%2Cmath%2F0702838%2Cmath%2F0702015%2Cmath%2F0702862%2Cmath%2F0702606%2Cmath%2F0702447%2Cmath%2F0702380%2Cmath%2F0702371%2Cmath%2F0702195%2Cmath%2F0702203%2Cmath%2F0702294&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We continue the study of the center problem for the ordinary differential\nequation $v'=\\sum_{i=1}^{\\infty}a_{i}(x)v^{i+1}$ started in our earlier papers.\nIn this paper we present the highlights of the algebraic theory of centers."}, "authors": ["Alexander Brudnyi"], "author_detail": {"name": "Alexander Brudnyi"}, "author": "Alexander Brudnyi", "arxiv_comment": "35 pages", "links": [{"href": "http://arxiv.org/abs/math/0702800v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0702800v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "32E20; 34C07", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0702800v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0702800v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0702800v1 [math.DS] 26 Feb 2007\n\nFormal Paths, Iterated Integrals and the Center\nProblem for Ordinary Differential Equations\nAlexander Brudnyi\u2217\nDepartment of Mathematics and Statistics\nUniversity of Calgary, Calgary\nCanada\n\nAbstract\nWe continue the study of the center problem for the ordinary differential\nP\ni+1 started in [Br1]-[Br5]. In this paper we present\nequation v \u2032 = \u221e\ni=1 ai (x)v\nthe highlights of the algebraic theory of centers.\n\nContents\n1 Introduction\n\n2\n\n2 Group of Formal Paths\n2.1. Definition of the Group of Paths . . . . . . . . . . . . . . . . . . .\n2.2. Structure of the Set of Universal Centers . . . . . . . . . . . . . .\n2.3. Representation of Paths by Noncommutative Formal Power Series\n2.4. Lie Algebra of the Group of Formal Paths . . . . . . . . . . . . . .\n2.5. Topological Lower Central Series of Some Groups of Paths . . . .\n2.6. Subgroups of the Group of Formal Paths . . . . . . . . . . . . . .\n\n.\n.\n.\n.\n.\n.\n\n4\n. 4\n. 5\n. 7\n. 9\n. 12\n. 17\n\n3 Center Problem for ODEs\n3.1. An Explicit Expression for the First Return\n3.2. Group of Formal Centers . . . . . . . . . .\n3.3. Properties of the Group of Formal Centers\n3.4. Group of Piecewise Linear Paths . . . . . .\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\nMap\n. . .\n. . .\n. . .\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n1991 Mathematics Subject Classification. Primary 32E20, Secondary 34C07.\nKey words and phrases. Group of formal paths, iterated integral, center, Abel equation.\n\u2217\n\n1\n\n20\n20\n21\n25\n32\n\n\f1\n\nIntroduction\n\nIn this paper we describe an algebraic approach to the center problem for the\nordinary differential equation\n\u221e\ndv X\nai (x)v i+1 ,\n=\ndx i=1\n\nx \u2208 IT := [0, T ],\n\n(1.1)\n\nwith coefficients ai from the Banach space L\u221e (IT ) of bounded measurable complexvalued functions on IT equipped with the supremum norm. Condition\nsup\nx\u2208IT , i\u2208N\n\nq\ni\n\n|ai (x)| < \u221e\n\n(1.2)\n\nguarantees that (1.1) has Lipschitz solutions on IT for all sufficiently small initial\nvalues. By X we denote the complex Fr\u00e9chet space of sequences a = (a1 , a2 , . . .)\nsatisfying (1.2). We say that equation (1.1) determines a center if every solution v of\n(1.1) with a sufficiently small initial value satisfies v(T ) = v(0). By C \u2282 X we denote\nthe set of centers of (1.1). The center problem is: given a \u2208 X to determine whether\na \u2208 C. It arises naturally in the framework of the geometric theory of ordinary\ndifferential equations created by Poincar\u00e9. In particular, there is a relation between\nthe center problem for (1.1) and the classical Poincar\u00e9 Center-Focus problem for\nplanar polynomial vector fields\ndx\n= \u2212y + F (x, y),\ndt\n\ndy\n= x + G(x, y),\ndt\n\n(1.3)\n\nwhere F and G are polynomials of a given degree without constant and linear terms.\nThis problem asks about conditions on F and G under which all trajectories of (1.3)\nsituated in a small neighbourhood of 0 \u2208 R2 are closed. Passing to polar coordinates\n(x, y) = (r cos \u03c6, r sin \u03c6) in (1.3) and expanding the right-hand side of the resulting\nequation as a series in r (for F , G with sufficiently small coefficients) we obtain an\nequation of the form (1.1) whose coefficients are trigonometric polynomials depending polynomially on the coefficients of (1.3). This reduces the Center-Focus Problem\nfor (1.3) to the center problem for (1.1) with coefficients depending polynomially on\na parameter.\nIn this paper we continue the study of the center problem for equation (1.1)\nstarted in [Br1]-[Br5]. One of the basic objects of our approach is a metrizable\ntopological group G(X) defined by the coefficients of equations (1.1) (the, so-called,\ngroup of paths in C\u221e ). Modulo the set of universal centers U \u2282 C of (1.1), described\nexplicitly in [Br2], the set of centers forms a normal subgroup Cb \u2282 G(X). By Gf (X)\nand Cbf we denote the groups of formal paths and of formal centers, respectively, i.e.,\nthe completions of G(X) and Cb with respect to the metric on G(X). In this paper\nwe study the algebraic properties of Gf (X) and Cbf . In particular, we describe\nLie algebras of these groups and prove that Gf (X) is the semidirect product of a\nnaturally defined normal subgroup of Cbf and the subgroup Gf (X 2 ) of formal paths\nin Gf (X) determined by coefficients of Abel differential equations, i.e., equations\n2\n\n\f(1.1) with ak = 0 for all k \u2265 3. Also, we show that Cbf contains a dense subgroup of\ncenters generated by certain piecewise linear paths in C\u221e .\nThe paper is organized as follows.\nSection 2 is devoted to the study of the group Gf (X) of formal paths in C\u221e .\nIn section 2.1 we introduce a natural multiplication on the set X similar to\nthe product of paths in topology. Then we define the group of paths G(X) as the\nquotient of X by an equivalence relation determined in terms of iterated integrals on\nX. We equip G(X) with a natural metric d and define the group Gf (X) of formal\npaths in C\u221e as the completion of G(X) with respect to d.\nThe equivalence class U \u2282 X corresponding to 1 \u2208 G(X) is called the set of\nuniversal centers of equation (1.1). In section 2.2 we present some results of [Br2]\non the characterization of elements from U.\nNext, in section 2.3 we will show how to embed Gf (X) in a group G of invertible\nformal power series in t whose coefficients belong to the associative algebra with unit\nI of complex noncommutative polynomials in I and free noncommutative variables\nXi , i \u2208 N.\nIdentifying Gf (X) with its image in G we describe in section 2.4 the Lie algebra\nLLie of Gf (X) as the subset of Lie elements of the Lie algebra LG of G.\nIn section 2.5 we prove some structural theorems for G(X) and Gf (X). Namely,\nwe describe the topological lower central series of these groups and their subgroups\ncorresponding to closed paths in C\u221e in terms of iterated integrals on Gf (X).\nFinally, in section 2.6 we describe some natural subgroups of Gf (X): the groups\nGf (X n ) generated by paths in Cn and G(XF ) determined over a field F \u2282 C.\nSection 3 is devoted to the study of the center problem for equation (1.1).\nIn section 3.1 we gather some results from [Br1]-[Br3] on the explicit expression\nfor the first return map of (1.1).\nUsing this we define in section 3.2 the group Cbf \u2282 Gf (X) of formal centers of\nequation (1.1).\nThen in section 3.3 we give an explicit description of the Lie algebra of Cbf and\nshow that Cbf is the closure in Gf (X) of the group of centers Cb of (1.1). We also prove\nthat Gf (X) is the semidirect product of a naturally defined normal subgroup of Cbf\nand the subgroup Gf (X 2 ) of formal paths in C2 (i.e., determined by coefficients of\nAbel differential equations). At the end of this section we briefly discuss the center\nproblem over a field F \u2282 C.\nFinally, in section 3.4 we introduce the subgroup P L \u2282 Gf (X) of piecewise linear\npaths in C\u221e . We give a characterization of centers belonging to this group and show\nthat the set of such centers is dense in Cbf .\n\n3\n\n\f2\n\nGroup of Formal Paths\n\n2.1. Definition of the Group of Paths\n2.1.1. Let us consider X as a semigroup with the operations given for a =\n(a1 , a2 , . . .) and b = (b1 , b2 , . . .) by\n\u22121\nand a\u22121 = (a\u22121\n1 , a2 , . . .) \u2208 X,\n\na \u2217 b = (a1 \u2217 b1 , a2 \u2217 b2 , . . .) \u2208 X\nwhere for i \u2208 N\n(ai \u2217 bi )(x) =\n\n(\n\n2bi (2x)\nif 0 \u2264 x \u2264 T /2,\n2ai (2x \u2212 T ) if T /2 < x \u2264 T\n\nand\na\u22121\ni (x) = \u2212ai (T \u2212 x),\n\n0 \u2264 x \u2264 T.\n\nLet C\u221e be the vector space of sequences of complex numbers (c1 , c2 , . . .) equipped\nwith the product topology. For a = (a1 , a2 , . . .) \u2208 X by ae = (ae1 , ae2 , . . .) : IT \u2192 C\u221e ,\nR\naek (x) := 0x ak (t) dt for all k \u2208 N, we denote a path in C\u221e starting at 0. The oneto-one map a 7\u2192 ae sends the product a \u2217 b to the product of paths ae \u25e6 eb, that is, the\npath obtained by translating ae so that its beginning meets the end of eb and then\n\u22121 is the path obtained by translating a\ne so\nforming the composite path. Similarly, ag\nthat its end meets 0 and then taking it with the opposite orientation.\n2.1.2. For a \u2208 X let us consider the basic iterated integrals\nIi1 ,...,ik (a) :=\n\nZ\n\n***\n\nZ\n\n0\u2264s1 \u2264***\u2264sk \u2264T\n\naik (sk ) * * * ai1 (s1 ) dsk * * * ds1\n\n(2.1)\n\n(for k = 0 we assume that this equals 1). By the Ree shuffle formula [R] the linear\nspace generated by all such functions on X is an algebra. The number k in (2.1) is\ncalled the order of the iterated integral. Also, the basic iterated integrals satisfy the\nfollowing equations (see, e.g., [H, Propositions 2.9 and 2.12]):\nIi1 ,...,ik (a \u2217 b) = Ii1 ,...,ik (a) +\n\nk\u22121\nX\n\nIi1 ,...,ij (a) * Iij+1 ,...,ik (b) + Ii1 ,...,ik (b).\n\n(2.2)\n\nj=1\n\nIi1 ,...,ik (a\u22121 ) = (\u22121)k Ii1 ,...,ik (a).\n\n(2.3)\n\nFor a, b \u2208 X we write a \u223c b if all basic iterated integrals vanish at a \u2217 b\u22121 .\nEquations (2.2) and (2.3) imply that a \u223c b if and only if Ii1 ,...,ik (a) = Ii1 ...,ik (b) for all\nbasic iterated integrals. In particular, \u223c is an equivalence relation on X. By G(X)\nwe denote the set of equivalence classes. Then G(X) is a group with the product\ninduced by the product \u2217 on X. By \u03c0 : X \u2192 G(X) we denote the map determined\nby the equivalence relation. By the definition each iterated integral I* is constant on\nfibres of \u03c0 and therefore it determines a function Ib* on G(X) such that I* = Ib* \u25e6 \u03c0.\nThe functions Ib* will be referred to as iterated integrals on G(X). These functions\nseparate the points on G(X).\n4\n\n\fNext, we equip G(X) with the weakest topology \u03c4 in which all basic iterated\nintegrals Ibi1 ,...,ik are continuous. Then (G(X), \u03c4 ) is a topological group. Moreover,\nG(X) is metrizable: for g, h \u2208 G(X) the formula\n\uf8f6\n\n\uf8eb\n\nX\n1 \uf8ed\n|Ibi1 ,...,ik (g) \u2212 Ibi1 ,...,ik (h)| \uf8f8\nd(g, h) :=\n*\nn\nb\nb\nn=1 4\ni1 +***+ik =n 1 + |Ii1 ,...,ik (g) \u2212 Ii1 ,...,ik (h)|\n\u221e\nX\n\n(2.4)\n\ndetermines a metric on G(X) compatible with topology \u03c4 (see [Br3, Theorem 2.4]).\nWe mention also that G(X) is contractible, residually torsion free nilpotent (i.e.,\nfinite dimensional unipotent representations of G(X) separate the points on G(X))\nand is the union of an increasing sequence of compact subsets (see [Br3]).\nBy Gf (X) we denote the completion of G(X) with respect to the metric d. Then\nGf (X) is a topological group which will be called the group of formal paths in C\u221e .\n\n2.2. Structure of the Set of Universal Centers\nBy U \u2282 X we denote the set of elements a \u2208 X such that all basic iterated\nintegrals vanish at a. According to (2.2), U is a sub-semigroup of X. It was shown\nin [Br2] that U \u2282 C, the set of centers of equation (1.1). We call U the set of universal\ncenters of (1.1). In this section we formulate some results on the characterization of\nelements from U established in [Br2].\nLet X k := {a = (a1 , a2 , . . .) \u2208 X : aj = 0 for all j > k}. By pk : X \u2192 X k ,\n(a1 , a2 , . . .) 7\u2192 (a1 , . . . , ak , 0, 0, . . .), we denote the natural projection. Clearly a \u2208 U\nif and only if pk (a) \u2208 U for all k \u2208 N. Therefore it suffices to characterize elements\nfrom the sets U k := U \u2229 X k .\nFor a = (a1 , . . . , ak , 0, . . .) \u2208 X k consider the Lipschitz curve Ak : IT \u2192 Ck\ndetermined by the formula\nAk (x) :=\n\n\u0012Z\n\nx\n0\n\na1 (t) dt, . . . ,\n\nZ\n\n0\n\nx\n\n\u0013\n\nak (t) dt ,\n\nx \u2208 IT .\n\n(2.5)\n\nWe set \u0393k := Ak (IT ).\nNext, we require\nc of a compact set K \u2282 Ck is the set\nDefinition 2.1 The polynomially convex hull K\nk\nof points z \u2208 C such that if p is any holomorphic polynomial in k variables\n\n|p(z)| \u2264 max |p(x)|.\nx\u2208K\n\nc is compact, and if K is connected then\nIt is well known (see, e.g., [AW]) that K\nc is connected. The following basic result was proved in [Br2, Theorem 1.10].\nK\n\nb\nTheorem 2.2 Suppose that a \u2208 U k . Then for any domain U \u2282 Ck containing \u0393\nk\nthe path Ak : IT \u2192 U is closed and represents the unit element of the fundamental\ngroup \u03c01 (U) of U.\n\n5\n\n\fSince Ak is Lipschitz, \u0393k is of a finite linear measure. Then according to the result\nb \\\u0393 is a (possibly empty) pure one-dimensional complex analytic\nof Alexander [A], \u0393\nk\nk\nsubset of Ck \\ \u0393k . In particular, since the covering dimension of \u0393k is 1, the covering\nb is 2. Therefore according to the Freudenthal expansion theorem\ndimension of \u0393\nk\nb can be presented as an inverse limit of a sequence of compact polyhedra\n[F], \u0393\nk\nb \u2192 Q be the continuous projections\n{Qkj }j\u2208N with dim Qkj \u2264 2. Let \u03c0kj : \u0393\nk\nkj\ngenerated by the inverse limit construction. It is easy to check that Theorem 2.2 is\nequivalent to the following statement: if a \u2208 U k , then for all j the continuous paths\n\u03c0kj \u25e6 Ak : IT \u2192 Qkj are closed and represent unit elements of \u03c01 (Qkj ).\nLet us formulate two corollaries of Theorem 2.2. In the first one we use the notion\nof a bordered Riemann surface. This is a compact connected set which consists of a\n(possibly singular) one-dimensional complex analytic space with a C 2 -boundary.\nb belongs\nCorollary 2.3 Suppose that a \u2208 X k is such that the corresponding set \u0393\nk\nk\nk\nto a bordered Riemann surface S \u2282 C . Then a \u2208 U if and only if the path\nAk : IT \u2192 S is closed and represents the unit element of the fundamental group\n\u03c01 (S) of S.\n\nThe proof of Corollary 2.3 repeats literally the arguments of the proofs of [Br2,\nCorollary 1.17] and [Br5, Corollary 3.7]. Using the covering homotopy theorem one\nobtains the following reformulation of the above result.\nLet \u03c0 : Se \u2192 S be the universal covering of S. Under the hypotheses of Corollary\n2.3, a \u2208 U k if and only if there is a closed Lipschitz path Aek : IT \u2192 Se such that\nAk = \u03c0 \u25e6 Aek .\n\nExample 2.4 1) Suppose that \u0393k \u2282 Ck is the image of the unit circle under a\nholomorphic embedding of its neighbourhood. Then by the result of Wermer [W],\nb is a bordered Riemann surface.\n\u0393\nk\n(2) The assumptions of Corollary 2.3 are also fulfilled if \u0393k belongs to a onedimensional complex analytic subset of a domain U \u2282 Ck such that U = \u222aj Kj\nc = K for all j \u2208 N, cf. [Br2, Corollary 1.17]. In particuwith Kj \u2282\u2282 Kj+1 and K\nj\nj\nlar, this is valid for a convex U.\n\nTo formulate the second corollary of Theorem 2.2 we recall the definition of a\nLipschitz triangulable curve, see, e.g., [Br2].\nDefinition 2.5 A compact curve C \u2282 RN is called Lipschitz triangulable if\n1. C = \u222asj=1 Cj and for i 6= j the intersection Ci \u2229 Cj consists of at most one\npoint;\n2. There are Lipschitz embeddings fj : [0, 1] \u2192 RN such that fj ([0, 1]) = Cj ;\n3. The inverse maps fj\u22121 : Cj \u2192 R are locally Lipschitz on Cj \\ {fj (0) \u222a fj (1)}.\nThe following corollary extends one of the main results of Chen [C3].\nCorollary 2.6 Suppose that a \u2208 X k is such that \u0393k is a Lipschitz triangulable\nb = \u0393 . Then a \u2208 U k if and only if the path A : I \u2192 \u0393 is closed and\ncurve and \u0393\nk\nk\nk\nT\nk\nrepresents the unit element of \u03c01 (\u0393k ).\n6\n\n\fUsing the covering homotopy theorem one reformulates this corollary as follows:\nUnder the hypotheses of Corollary 2.6, a \u2208 U k if and only if there are a Lipschitz\ntriangulable curve T homeomorphic to a finite tree, a locally bi-Lipschitz map \u03c0 :\nT \u2192 \u0393k and a closed Lipschitz path Aek : IT \u2192 T such that Ak = \u03c0 \u25e6 Aek .\n\nb = \u0393 is fulfilled if, e.g., \u0393 belongs to a compact\nExample 2.7 (1) The condition \u0393\nk\nk\nk\nc = K (for the proof\nset K in a C 1 -manifold M with no complex tangents such that K\nsee, e.g., [AW, Theorem 17.1]). For instance, one can take as such K any compact\nsubset of M = Rk .\n(2) \u0393k is a Lipschitz triangulable curve if, e.g., Ak : IT \u2192 Ck is nonconstant analytic.\n\nCorollaries 2.3 and 2.6 reveal a connection of the center problem for equation\n(1.1) with the so-called composition condition whose role and importance was studied\nin [AL], [BFY1], [BFY2], [Y] for the special case of Abel differential equations.\n\n2.3.\n\nRepresentation of Paths by Noncommutative Formal\nPower Series\n\n2.3.1. Let ChX1 , X2 , . . .i be the associative algebra with unit I of complex noncommutative polynomials in I and free noncommutative variables X1 , X2 , . . . (i.e.,\nthere are no nontrivial relations between these variables). By ChX1 , X2 , . . .i[[t]]\nwe denote the associative algebra of formal power series in t with coefficients from\nChX1 , X2 , . . .i. Also, by A \u2282 ChX1 , X2 , . . .i[[t]] we denote the subalgebra of series f\nof the form\n\uf8f6\n\uf8eb\nf = c0 I +\n\n\u221e\nX\n\nn=1\n\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\nwith c0 , ci1 ,...,ik \u2208 C for all i1 , . . . , ik , k \u2208 N.\n\nci1 ,...,ik Xi1 * * * Xik \uf8f8 tn\n\n(2.6)\n\nRemark 2.8 Let S \u2282 ChX1 , X2 , . . .i be the multiplicative semigroup generated by\nI, X1 , X2 , . . .. Consider a grading function w : S \u2192 Z+ determined by the conditions\nw(I) = 0, w(Xi ) = i,\n\ni \u2208 N,\n\nand w(x * y) := w(x) + w(y) for all x, y \u2208 S.\n\nThis splits S in a disjoint union S = \u2294\u221e\nn=0 Sn , where Sn = {s \u2208 S : w(s) = n}.\nNow, each f \u2208 A is written as\nf=\n\n\u221e\nX\n\nfn tn\n\nwhere fn \u2208 Vn := spanC (Sn ), n \u2208 Z+ .\n\n(2.7)\n\nn=0\n\nWe equip A with the weakest topology in which all coefficients ci1 ,...,ik in (2.6)\nconsidered as functions in f \u2208 A are continuous. Since the set of these functions\nis countable, A is metrizable, cf. (2.4). Moreover, if d is a metric on A compatible\nwith the topology, then (A, d) is a complete metric space. Also, by the definition\nthe multiplication * : A \u00d7 A \u2192 A is continuous in this topology.\n\n7\n\n\fP\n\nn\nRemark 2.9 A sequence {fk = \u221e\n: fnk \u2208 Vn , n \u2208 Z+ }k\u2208N converges\nn=0 fnk t\nP\u221e\nn\nto f = n=0 fn t , fn \u2208 Vn , n \u2208 Z+ , in the topology of A if and only if each\n{fkn }k\u2208N converges to fn in Vn naturally identified with the hermitian space Cd(n)\nwhere d(n) := #Sn .\n\nBy G \u2282 A we denote the closed subset of elements f of form (2.6) with c0 = 1.\nThen (G, *) is a topological group. Its Lie algebra LG \u2282 A consists of elements f\nof form (2.6) with c0 = 0. (For f, g \u2208 LG their product is defined by the formula\nP\nfn\n[f, g] := f * g \u2212 g * f .) Also, the map exp : LG \u2192 G, exp(f ) := ef = \u221e\nn=0 n! , is a\nhomeomorphism.\n2.3.2. For an element a = (a1 , a2 , . . .) \u2208 X let us consider the equation\n\u2032\n\nF (x) =\n\n\u221e\nX\n\ni\n\n!\n\nx \u2208 IT .\n\nai (x) t Xi F (x),\n\ni=1\n\n(2.8)\n\nThis can be solved by Picard iteration to obtain a solution Fa : IT \u2192 G, Fa (0) = I,\nwhose coefficients in expansion in X1 , X2 , . . . and t are Lipschitz functions on IT .\nWe set\nE(a) := Fa (T ), a \u2208 X.\n(2.9)\nBy the definition, see section 2.1.1, we have, cf. [C1, Theorem 6.1],\nE(a \u2217 b) = E(a) * E(b),\n\na, b \u2208 X.\n\n(2.10)\n\nAlso, an explicit calculation leads to the formula\nE(a) = I +\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\n\uf8f6\n\nIi1 ,...,ik (a)Xi1 * * * Xik \uf8f8 tn .\n\n(2.11)\n\nThe last formula implies that the kernel of the homomorphism E : X \u2192 G is the\nset of universal centers U. In particular, there is a homomorphism Eb : G(X) \u2192 G\nsuch that E = Eb \u25e6 \u03c0, that is,\nb\nE(g)\n=I+\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\n\uf8f6\n\nIbi1 ,...,ik (g)Xi1 * * * Xik \uf8f8 tn ,\n\ng \u2208 G(X).\n\n(2.12)\n\nFormula (2.12) shows that Eb : G(X) \u2192 G is a continuous embedding. Moreover, one can determine a metric d1 on A compatible with topology such that\nEb : (G(X), d) \u2192 (G, d1 ) is an isometric embedding, cf. (2.4). Therefore Eb is\nb\nnaturally extended to a continuous embedding Gf (X) \u2192 G (denoted also by E).\nb\nBy the definition, E : Gf (X) \u2192 G is an injective homomorphism of topological\nb\nb\ngroups and E(G\nf (X)) is the closure of E(G(X)) in the topology of G.\nb\nIn what follows we identify G(X) and Gf (X) with their images under E.\n\n8\n\n\f2.4. Lie Algebra of the Group of Formal Paths\nP\n\nn\n2.4.1. Recall that each element g \u2208 LG can be written as g = \u221e\nn=1 gn t , gn \u2208 Vn ,\nn \u2208 N. We say that such g is a Lie element if each gn belongs to the free Lie algebra\ngenerated by X1 , . . . , Xn . In this case each gn has the form\n\ngn =\n\nX\n\nci1 ,...,ik [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]].\n\n(2.13)\n\ni1 +...+ik =n\n\nwith all ci1 ,...,ik \u2208 C. (Here the term with ik = n is cn Xn .)\nLet Ln \u2282 Vn be the subspace of elements gn of form (2.13). It follows from\n[M-KO, Theorem 3.2] that\ndimC Ln =\n\n1 X n/d\n(2\n\u2212 1) * \u03bc(d)\nn d|n\n\n(2.14)\n\nwhere the sum is taken over all numbers d \u2208 N that divide n, and \u03bc : N \u2192 {\u22121, 0, 1}\nis the M\u00f6bius function defined as follows. If d has a prime factorization\nd = pn1 1 pn2 2 * * * pnq q ,\nthen\n\u03bc(d) =\n\n\uf8f1\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n\n1\n\nni > 0,\n\nfor d = 1\n\n(\u22121)q\n\nif all ni = 1\n\n0\n\notherwise.\n\nBy LLie we denote the subset of Lie elements of LG . Then LLie is a closed (in\nthe topology of A) Lie subalgebra of LG .\nTheorem 2.10 The exponential map exp : LG \u2192 G maps LLie homeomorphically\nonto Gf (X).\nThus LLie can be considered as the Lie algebra of Gf (X).\nP\n\nn\n\n(I\u2212f )\n, be\n2.4.2. Proof of Theorem 2.10. Let log : G \u2192 LG , log(f ) = \u2212 \u221e\nn=1\nn\nthe logarithmic map. By the definition it is continuous and inverse to the exponential\nmap exp. From [C2, Theorem 4.2] and [R] follow that log maps G(X) into LLie .\nSince LLie is a closed subspace of LG and log is continuous, it maps Gf (X) into LLie ,\nas well. In particular, Gf (X) \u2282 exp(LLie ). Let us prove the converse implication.\nLet J \u2282 A be the two-sided ideal of elements f of form (2.6) with c0 = 0.\nBy J l we denote the lth power of J. Let ql : A \u2192 A/J l =: Al be the quotient\nhomomorphism. We set X s = ql (Xs * ts ), 1 \u2264 s \u2264 l \u2212 1. Then for f \u2208 A of form\n(2.6) we have\n\nql (f ) := c0 I +\n\nl\u22121\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\n9\n\n\uf8f6\n\nci1 ,...,ik X i1 * * * X ik \uf8f8 .\n\n(2.15)\n\n\f(Here I is the unit of Al .) We naturally identify Al with the hermitian space Cn(k) ,\nn(k) = dimC Al , so that ql is a continuous map. Then Gl := ql (G) \u2282 Al is a complex\nnilpotent Lie group.\nFurther, let Xrect \u2282 X be the sub-semigroup of rectangular paths, i.e., elements\na \u2208 X whose first integrals ae : IT \u2192 C\u221e are paths consisting of segments each going\nin the direction of some particular coordinate. By G(Xrect ) \u2282 G(X) we denote the\nsubgroup generated by Xrect. Identifying G(X) with its image in G by Eb we obtain\nn\nfrom (2.11) that G(Xrect ) is a subgroup of G generated by elements ecn Xn t , cn \u2208 C,\nn \u2208 N. (In particular, G(Xrect) is isomorphic to the free product of countably many\ncopies of C.)\nProposition 2.11 The images of G(Xrect), G(X) and Gf (X) in Gl coincide and\nform a complex Lie subgroup of Gl .\nProof. We set for brevity\nQl := ql (G(Xrect )),\n\nQl := ql (G(X)),\n\ne := q (G (X)).\nQ\nl\nl\nf\n\n(2.16)\n\nFor any c \u2208 C, a = (a1 , a2 , . . .) \u2208 X by ca we denote the element (ca1 , c2 a2 , . . .) \u2208\nX. Suppose that S \u2282 X is a sub-semigroup such that for each s \u2208 S and any c \u2208 C\nelements s\u22121 , cs belong to S. Let Sl := (ql \u25e6 Eb \u25e6 \u03c0)(S) be the image of S in Gl . By\nthe definition Sl is a subgroup of Gl . We will use the following\nLemma 2.12 Sl is a complex Lie subgroup of Gl .\nProof. Let g \u2208 G(X) \u2282 A be the image of an element a \u2208 X. For any c \u2208 C by\nP\nn\ncg \u2208 G(X) we denote the image of ca \u2208 X. If g = \u221e\nn=0 gn t , gn \u2208 Vn , see (2.7),\nthen\nql (g) = I +\n\nl\u22121\nX\n\nqn (gn tn ) and ql (cg) := I +\n\nl\u22121\nX\n\ncn * qn (gn tn ).\n\n(2.17)\n\nn=1\n\nn=1\n\nWe will naturally identify Gl with CN where N := dimC Gl .\nLet K = {g1 , . . . , gk } \u2282 \u03c0(S) \u2282 G(X) be a finite set. We define a holomorphic\npolynomial map FK : Ck \u2192 CN by the formula\nFK (z1 , . . . , zk ) := ql ((z1 g1 ) * * * (zk gk )).\n\n(2.18)\n\nLet ZK be the Zariski closure of FK (Ck ) in CN . Then ZK is an irreducible complex\nalgebraic subvariety of CN and FK (Ck ) contains an open dense subset of ZK (see,\ne.g., the book of Mumford [M] for the basic facts of Algebraic Geometry). By the\ndefinition we have\nFK1 (C#K1 ) \u2282 FK2 (C#K2 ) and ZK1 \u2282 ZK2\n\nfor K1 \u2282 K2 .\n\n(2.19)\n\nLet Z := \u222aK ZK where K runs over all finite subsets of Gl . Since dimC ZK \u2264 N and\nall ZK are irreducible, (2.19) implies that there is a finite set K \u2282 \u03c0(S) such that\nZK = Z. Observe that by the definition the group Sl is dense in Z = ZK . Hence Z\n10\n\n\fis the Zariski closure of Sl . In particular, Z is a complex Lie subgroup of Gl . Also,\nfrom the identity Z = ZK it follows that Sl contains an open dense subset of Z.\nSince the topologies of the groups Sl and Z are induced from that of Gl , the latter\nimplies that Sl = Z completing the proof of the lemma.\n\u2737\nContinuing the proof of the proposition we choose as the S in Lemma 2.12\nsemigroups Xrect and X. Then we conclude that Ql \u2282 Ql are complex Lie subgroups\ne , see section\nof Gl (in particular, they are closed subsets of Gl ). Since Ql is dense in Q\nl\ne .\n2.1.2, the latter implies that Ql = Q\nl\nLet LGl be the Lie algebra of Gl . By the definition it consists of all elements of\nform (2.15) with c0 = 0. Let exp : LGl \u2192 Gl , exp(f ) := ef , be the corresponding\nexponential map. Clearly we have the following commutative diagram:\nexp\n\nLG \u2212\u2192\nql \u2193\nexp\nLGl \u2212\u2192\n\nG\n\u2193 ql\nGl .\n\n(2.20)\nP\n\nn\n\n(I\u2212f )\nThis implies that for each f \u2208 Ql the element log(f ) := \u2212 l\u22121\nbelongs to\nn=1\nn\nl\nthe free nilpotent Lie algebra LLie \u2282 LGl generated by elements X 1 , . . . , X l\u22121 , i.e.,\neach element g of this algebra has the form\n\ng=\n\nl\u22121\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\n\uf8f6\n\nci1 ,...,ik [X i1 , [X i2 , [ * * * , [X ik\u22121 , X ik ] * * * ]]]\uf8f8\n\n(2.21)\n\nwith all ci1 ,...,ik \u2208 C, i1 , . . . , ik \u2208 {1, . . . , l\u22121}. Thus the Lie algebra LQl := log(Ql ) of\nQl is a subset of LlLie . Next, the Lie algebra LQl := log(Ql ) of Ql is a subset of LlLie ,\nas well. Moreover, since Ql is generated by elements ecs X s , cs \u2208 C, 1 \u2264 s \u2264 l \u2212 1,\nits Lie algebra is generated by elements X s , 1 \u2264 s \u2264 l \u2212 1, and therefore coincides\nwith LlLie . This implies that LQl = LQl = LlLie , and Ql = Ql .\nThe proof of the proposition is complete.\n\u2737\nLet us finish the proof of the theorem. Let g \u2208 LLie . Consider the elements gl :=\nql (g) \u2208 LlLie , l \u2265 2. According to Proposition 2.11 there are elements fl \u2208 G(Xrect)\nsuch that ql (fl ) = egl . Now, for m > l we have\nql (fm * fl\u22121 ) = ql (fm ) * (ql (fl ))\u22121 = ql (qm (fm )) * e\u2212gl = ql (egm ) * e\u2212gl = egl * e\u2212gl = I.\nThus fm \u2212 fl \u2208 J l . By the definition of the topology of G this implies that the\nsequence {fl }l\u22652 converges in G to an element f \u2208 Gf (X), so that ql (f ) = egl ,\nl \u2265 2. Taking here the limit as l tends to \u221e we get f = eg . This shows that\nexp(LLie ) \u2282 Gf (X) and completes the proof of the theorem.\n\u2737\nRemark 2.13 We also established in the proof that G(Xrect ) is a dense subgroup\nof Gf (X).\n2.4.3. Shuffles.\nDefinition 2.14 A permutation \u03c3 of {1, 2, . . . , r + s} is a shuffle of type (r, s) if\n\u03c3 \u22121 (1) < \u03c3 \u22121 (2) < * * * < \u03c3 \u22121 (r)\n11\n\n\fand\n\u03c3 \u22121 (r + 1) < \u03c3 \u22121 (r + 2) < * * * < \u03c3 \u22121 (r + s).\n(The term \"shuffle\" is used because such permutations arise in riffle shuffling a deck\nof r + s cards cut into one pile of r cards and a second pile of s cards.)\nThe following result is a corollary of Theorem 2.10.\nTheorem 2.15 An element\nf =I+\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\nX\n\n\uf8ed\n\ni1 +...+ik =n\n\n\uf8f6\n\nci1 ,...,ik Xi1 * * * Xik \uf8f8 tn \u2208 G\n\nbelongs to Gf (X) if and only if its coefficients satisfy the system of Ree shuffle\nrelations:\nX\nci1 ,...,ir * cir+1 ,...,ir+s =\nci\u03c3(1) ,...,i\u03c3(r+s) , i1 , . . . , ir+s \u2208 N,\n(2.22)\n\u03c3\n\nwhere the sum is taken over the set of shuffles of type (r, s).\n\nProof. According to the main result of Ree [R], log(f ) \u2208 LLie for f \u2208 G if and only\nif the coefficients of f satisfy equations (2.22). This and Theorem 2.10 imply the\nrequired result.\n\u2737\n\n2.5. Topological Lower Central Series of Some Groups of\nPaths\n2.5.1. In the section we describe the topological lower central series of groups\nG(X) and Gf (X).\nLet G be a topological group. We set Gn := [G, Gn\u22121 ] and G1 = [G, G] (the\ncommutator subgroup of G). For H \u2282 G by H \u2282 G we denote the closure of H.\nDefinition 2.16 The sequence\nG \u2283 G1 \u2283 G2 \u2283 * * *\nis called the topological lower central series of G.\nNext, consider the family {Ibi1 ,...,ik } of all basic integrals on G(X), see section\n2.1.2. By the definition each function of this family admits a continuous extension\nto Gf (X). We retain the same symbols for the extended functions and call them the\nbasic iterated integrals on Gf (X). Observe that if ci1 ,...,ik : A \u2192 C is the function\nwhose value at f \u2208 A is the coefficient corresponding to the monomial Xi1 * * * Xik\nb\nin the series expansion (2.6) of f , then Ibi1 ,...,ik = ci1 ,...,ik \u25e6 E.\n\nTheorem 2.17 (1) An element g \u2208 Gf (X) belongs to Gf (X)n if and only if all\nbasic iterated integrals of order \u2264 n vanish at g.\n(2)\nG(X)n = Gf (X)n \u2229 G(X).\n12\n\n\fLet us recall that the order of a basic iterated integral is the number of its indices.\nProof. We use the notation of section 2.4.2. Since the map ql : G(X) \u2192 Ql ,\nsee (2.16), is surjective, ql (G(X)n ) = (Ql )n . Moreover, since Ql is a complex\nnilpotent Lie group, (Ql )n is a complex nilpotent Lie subgroup of Ql . In particular, ql (G(X)n ) = (Ql )n (because ql (G(X)n ) is dense in ql (G(X)n )). Similarly,\nql (Gf (X)n ) = ql (Gf (X)n ) = (Ql )n . Further, the Lie algebra LlLie of Ql is the free\nnilpotent Lie subalgebra of LGl generated by elements X 1 , . . . , X l\u22121 , see (2.21).\nThen the nth term (LlLie )n of the lower central series of LlLie consists of the elements\nof form (2.21) with all ci1 ,...,ik = 0 for k \u2264 n (i.e., the number of brackets in each\nterm of this formula must be \u2265 n). Since the exponential map exp maps (LlLie )n\nsurjectively onto (Ql )n , an explicit computation shows that (Ql )n \u2282 Ql consists of\nelements of form (2.15) with c0 = 1 and all ci1 ,...,ik = 0 for k \u2264 n.\nNow, suppose that g \u2208 Gf (X)n . Identifying Gf (X) with its image under Eb we\nhave\n\uf8f6\n\uf8eb\ng=I+\n\n\u221e\nX\n\nn=1\n\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\nci1 ,...,ik (g) Xi1 * * * Xik \uf8f8 tn .\n\n(2.23)\n\nSince ql (g) \u2208 (Ql )n for any l, formula (2.15) and the above description of (Ql )n imply\nthat ci1 ,...,ik (g) = 0 for all k \u2264 n. Equivalently, all basic iterated integrals of order\n\u2264 n vanish at g.\nConversely, assume that g \u2208 Gf (X) is of form (2.23) with ci1 ,...,ik (g) = 0 for all\nk \u2264 n. Then from the description of (Ql )n and (2.15) we obtain that ql (g) \u2208 (Ql )n\nfor any l \u2265 2. Since(Ql )n = ql (G(X)n ), there are elements gl \u2208 G(X)n , l \u2265 2,\nsuch that ql (g \u22121gl ) = I. As in the proof of Theorem 2.10 this implies that {gl }l\u22652\nconverges to g in the topology of Gf (X), that is, g \u2208 Gf (X)n . This proves (1).\nFurther, if g \u2208 Gf (X)n \u2229 G(X), then as above there is a sequence {g}l\u22652 with\ngl \u2208 G(X)n such that liml\u2192\u221e gl = g. Thus g \u2208 G(X)n . Since the implication\nG(X)n \u2282 Gf (X)n \u2229 G(X) is obvious, we obtain the proof of (2).\n\u2737\n2.5.2. By X\u2217 \u2282 X we denote the set of elements a \u2208 X such that Is (a) = 0 for\nall s \u2208 N, i.e., a \u2208 X\u2217 if and only if its first integral ae : IT \u2192 C\u221e is a closed path. We\ncall the image G(X\u2217 ) := \u03c0(X\u2217 ) \u2282 G(X) the subgroup of closed paths and its closure\nGf (X\u2217 ) in Gf (X) the subgroup of formal closed paths. According to Theorem 2.17,\nG(X\u2217 ) = G(X)1 and Gf (X\u2217 ) = Gf (X)1 . In this section we describe the topological\nlower central series of G(X\u2217 ) and Gf (X\u2217 ).\nGiven a = (a1 , a2 , . . .) \u2208 X we define\naei (x) :=\n\nZ\n\n0\n\nx\n\nai (s) ds,\n\nx \u2208 IT .\n\n(2.24)\n\nBy P(X) we denote the set of functions on X \u00d7 IT of the form\n(aei1 (x))n1 * * * (aeik (x))nk * aik+1 (x),\n\ni1 , . . . , ik+1 \u2208 N, n1 , . . . , nk \u2208 Z+ .\n\n(2.25)\n\nDefinition 2.18 A moment of order k on X is an iterated integral of the form\nm(a) :=\n\nZ\n\n***\n\nZ\n\n0\u2264s1 \u2264***\u2264sk \u2264T\n\npk (a; sk ) * * * p1 (a; s1 ) dsk * * * ds1\n13\n\n(2.26)\n\n\fwhere each pj \u2208 P(X), 1 \u2264 j \u2264 k.\nMoments of the first order play an important role in the study of the center problem for Abel differential equations (see, e.g., [AL], [BFY1], [BFY2], [Y]). Also, it\nwas proved in [Br4, Theorem 2.1] that such moments determine centers of equations\n(1.1) whose coefficients are either polynomials in e\u00b12\u03c0ix/T or in x, a result on complexity of the set of centers for these equations. (E.g., this class contains equations\nobtained from the Poincar\u00e9 Center-Focus problem, see the Introduction.)\nAccording to the Ree shuffle formula (2.22) each moment m is a linear combination with natural coefficients of some basic iterated integrals. In particular, there\nc on G(X) from the vector space generated by all basic\nis a continuous function m\nc \u25e6 \u03c0. Thus, every such m\nc admits a coniterated integrals on G(X) such that m = m\ntinuous extension (denoted by the same symbol) to Gf (X). The extended function\nc is the order of\nwill be called a moment on Gf (X). By the definition the order of m\nc.\nthe moment m on X representing m\n\nTheorem 2.19 (1) An element g \u2208 Gf (X\u2217 ) belongs to Gf (X\u2217 )n if and only if all\nmoments of order \u2264 n vanish at g.\n(2)\nG(X\u2217 )n = Gf (X\u2217 )n \u2229 G(X\u2217 ).\n\nProof. We first prove the particular case of (1) for g \u2208 G(X\u2217 ). Namely we will\nprove\nProposition 2.20 An element g \u2208 G(X\u2217 ) belongs to G(X\u2217 )n if and only if all\nmoments of order \u2264 n vanish at g.\nProof. This result was stated in [Br5, Theorem 3.2]. In its proof given in [Br5]\nsome details were omitted. Here we will give the complete proof of this fact.\nFirst, assume that g \u2208 G(X\u2217 )n . Since g represents a closed path in C\u221e all moments of order \u2264 n vanish at g (see, e.g., [H] for properties of iterated integrals over\nclosed paths). Since each moment is a continuous function on G(X\u2217 ), by continuity\nwe obtain also that for g \u2208 G(X\u2217 )n all moments of order \u2264 n vanish at g. Thus we\nmust prove a converse statement.\nSo assume that g \u2208 G(X\u2217 ) is such that all moments of order \u2264 n vanish at g.\nWe will prove that g \u2208 G(X\u2217 )n .\nFor an element p = aeni11 * * * aenikk * aik+1 \u2208 P(X) the number i1 n1 + . . . + ik nk + ik+1\nwill be called the degree of p. Next, for a moment m on X its degree deg(m) is the\nmaximum of degrees of elements pj \u2208 P(X) in its definition, see (2.26). In turn, the\nc on G(X) representing m is defined as deg(m\nc) := deg(m).\ndegree of the moment m\nWe retain the notation of section 2.4.2. Also, for Ql := ql (G(X)) \u2282 Gl we set\nRl := [Ql , Ql ]. Our proof is based on the following\nLemma 2.21 Suppose that g \u2208 G(X\u2217 ) is such that all moments of order \u2264 n and\nof degree \u2264 l \u2212 1 vanish at g. Then ql (g) \u2208 (Rl )n .\n\n14\n\n\fProof. Let a = (a1 , a2 , . . .) \u2208 X be such that \u03c0(a) = g. By the definitions of E, see\nsection 2.3.2, and of ql , see (2.15), ql (g) is the monodromy of the equation\nl\u22121\nX\n\n\u2032\n\nH (x) =\n\n!\n\nx \u2208 IT .\n\nai (x) X i H(x),\n\ni=1\n\n(2.27)\n\nThis equation can be solved by Picard iteration to obtain a solution Ha : IT \u2192 Gl ,\nHa (0) = I, whose coefficients in expansion in X 1 , . . . , X l\u22121 are Lipschitz functions\non IT . Then ql (g) := Ha (T ). We write\nHa = H1 * * * Hl\u22121 * Hl\n\nwhere Hi := eeai X i ,\n\n1 \u2264 i \u2264 l \u2212 1,\n\n(2.28)\n\nsee (2.24). Since g \u2208 G(X\u2217 ), Hi (T ) = I for 1 \u2264 i \u2264 l \u2212 1. This implies that\nql (g) = Ha (T ) = Hl (T ). From (2.28) follows that Hl satisfies the equation\nHl\u2032 = \u03c9 * Hl\n\u03c9 := F\n\n\u22121\n\nl\u22121\nX\n\n*\n\nwhere\n\n!\n\n(2.29)\n\nai X i * F \u2212 F \u22121 * F \u2032 ,\n\ni=1\n\nF := H1 * * * Hl\u22121 .\n\nClaim. \u03c9 is a function on IT with values in the Lie algebra LRl of Rl .\nIndeed, the first term in the definition of \u03c9 is the logarithm of\nF\n\n\u22121\n\n(x) * exp\n\nl\u22121\nX\n\n!\n\nai (x)X i * F (x),\n\ni=1\n\nx \u2208 IT .\n\nBy the definition of F for any x \u2208 IT each term of this product belongs to Ql (see\nsection 2.4.2 after formula (2.21)). Thus its logarithm belongs to the Lie algebra\nLQl of Ql . Next, the second term in the definition of \u03c9 is equal to\nl\u22121\nX\n\n\u22121\nHl\u22121\n(x) * * * Hs\u22121 (x)\n\ns=2\n\n!\n\n* aes\u22121 (x) X s\u22121 * Hl\u22121 (x) * * * Hs (x) + ael\u22121 (x) X l\u22121 , x \u2208 IT .\n\nBy the same reason as above, for any x \u2208 IT each term of this sum belongs to LQl .\nThus \u03c9(x) \u2208 LQl for any x \u2208 IT . Observe also that from (2.29) follows that \u03c9(x)\nconsidered as a polynomial in X i , 1 \u2264 i \u2264 l \u2212 1, does not contain linear terms. Then\nby the definition of Rl , see also the proof of Theorem 2.17, \u03c9(x) \u2208 LRl .\nThis completes the proof of the Claim.\nAn explicit computation of \u03c9 based on the Campbell-Hausdorff formula shows\nthat\n\u03c9(x) =\n\nl\u22121\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\n\uf8f6\n\nci1 ,...,ik (x) [X i1 , [X i2 , [ * * * , [X ik\u22121 , X ik ] * * * ]]]\uf8f8\n\n(2.30)\n\nwhere each ci1 ,...,ik \u2208 spanQ (P(X)). Moreover, each term of P(X) in the definition\nof ci1 ,...,ik is of degree i1 + * * * + ik .\n15\n\n\fWe set\nS := { [X i1 , [X i2 , [ * * * , [X ik\u22121 , X ik ] * * * ]]] 6= 0 : i1 + * * * + ik = n, 1 \u2264 n \u2264 l \u2212 1},\nand arrange S into a sequence {vi }1\u2264i\u2264N , N := #S. Then \u03c9 can be written as\n\u03c9(x) =\n\nN\nX\n\nfi (x) vi ,\n\nx \u2208 IT ,\n\ni=1\n\nwhere fi \u2208 spanQ (P(X)) and each term of P(X) in the definition of fi is of degree\n\u2264 l \u2212 1.\nLet C[[X1 , . . . , XN ]] be the associative algebra with unit I of noncommutative\nformal power series in free variables X1 , . . . , XN . Then there is a homomorphism\n\u03c6 : C[[X1 , . . . , XN ]] \u2192 A, where A is the associative complex subalgebra of Al (see\nsection 2.4.2) generated by I and v1 , . . . , vn , determined by \u03c6(Xi ) = vi , 1 \u2264 i \u2264 N,\n\u03c6(I) = I.\nNext, consider the equation\nN\nX\n\n\u2032\n\nG (x) =\n\n!\n\nfi (x)Xi G(x),\n\ni=1\n\nx \u2208 IT .\n\nSolving this equation by Picard iteration we get a solution G : IT \u2192 C[[X1 , . . . , XN ]],\nG(0) = I, whose coefficients in expansion in X1 , . . . , XN are Lipschitz functions on\nIT . Also, by the definition we have \u03c6(G(T )) = Hl (T ) = ql (g). Observe now that\nG(T ) = I +\n\n\u221e\nX\n\nk=1\n\n\uf8eb\n\uf8ed\n\nX\n\n1\u2264i1 ,...,ik \u2264N\n\n\uf8f6\n\nIi1 ,...,ik (f ) Xi1 * * * Xik \uf8f8 ,\n\ncf. (2.11), where f = (f1 , . . . , fN , 0, . . .) \u2208 X. By the definition, each basic iterated\nintegral Ii1 ,...,ik (f ) in this formula is a linear combination of moments of order k and of\ndegree \u2264 l \u2212 1 on X. In particular, by the hypothesis of the lemma, Ii1 ,...,ik (f ) = 0\nfor all k \u2264 n, i.e., the first sum in the definition of G(T ) can be considered for\nk \u2265 n + 1 only. Further, by the Ree theorem [R] log(G(T )) is a Lie element in\nC[[X1 , . . . , XN ]]. Since the degree of each monomial in G(T ) is greater than n,\nlog(G(T )) =\n\n\u221e\nX\n\nk=n+1\n\nThis implies that\n\n\uf8eb\n\uf8ed\n\nX\n\n1\u2264i1 ,...,ik \u2264N\n\n\uf8f6\n\ngi1 ,...,ik [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]]\uf8f8 .\n\n\u03c6(log(G(T ))) = log(\u03c6(G(T ))) = log(ql (g)) =\n\u221e\nX\n\nk=n+1\n\n\uf8eb\n\uf8ed\n\nX\n\n1\u2264i1 ,...,ik \u2264N\n\n\uf8f6\n\ngi1 ,...,ik [vi1 , [vi2 , [ * * * , [vik\u22121 , vik ] * * * ]]]\uf8f8 ,\n\nthat is, log(ql (g)) \u2208 (LRl )n . Since the exponential map exp maps (LRl )n surjectively\nonto (Rl )n , ql (g) \u2208 (Rl )n .\n16\n\n\fThe proof of the lemma is complete.\n\u2737\nLet us finish the proof of the proposition.\nFor an element g \u2208 G(X\u2217 ) such that all moments of order \u2264 n vanish at g by\nLemma 2.21 we have ql (g) \u2208 (Rl )n for all l \u2265 2. Since ql maps G(X\u2217 ) surjectively\nonto Rl (see the proof of Theorem 2.10), there are elements gl \u2208 G(X\u2217 )n , l \u2265 2,\nsuch that ql (g \u22121 * gl ) = I for all l. As in the proof of Theorem 2.17 this implies that\n\u2737\nliml\u2192\u221e gl = g. Thus g \u2208 G(X\u2217 )n . This completes the proof of the proposition.\nUsing Proposition 2.20 we prove now Theorem 2.19.\nAssume that g \u2208 Gf (X\u2217 )n . Since Gf (X\u2217 ) is the closure in Gf (X) of G(X\u2217 ),\nGf (X\u2217 )n is the closure in Gf (X) of G(X\u2217 )n . In particular, all moments of order \u2264 n\nvanish at g (see the beginning of the proof of Proposition 2.20).\nConversely, suppose that g \u2208 Gf (X\u2217 ) is such that all moments of order \u2264 n\nvanish at g. We will prove first that ql (g) \u2208 (Rl )n , for all l \u2265 2.\nc of order \u2264 n and of\nBy the Ree shuffle formula, given l \u2265 2 each moment m\ndegree \u2264 l \u2212 1 on Gf (X\u2217 ) can be presented as a linear combination with natural\ncoefficients of basic iterated integrals Ibi1 ,...,ik (on Gf (X)) of order k \u2264 l + n \u2212 1\nwith 1 \u2264 i1 , . . . , ik \u2264 l \u2212 1. We set s := (l + n \u2212 1) * (l \u2212 1) + 1 and consider\nQs := qs (G(X)) = qs (Gf (X)) (cf. the proof of Proposition 2.11). By the definitions\nof Eb and qs , see (2.12) and (2.15), we have\nqs (g) = I +\n\ns\u22121\nX\n\nm=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =m\n\n\uf8f6\n\nIbi1 ,...,ik (g) X i1 * * * X ik \uf8f8 .\n\nSince Rs := [Qs , Qs ] = qs (G(X\u2217 )) = qs (Gf (X\u2217 )) and g \u2208 Gf (X\u2217 ), there is ge \u2208 G(X\u2217 )\nsuch that qs (g) = qs (ge). In particular,\nIbi1 ,...,ik (g) = Ibi1 ,...,ik (ge) for all i1 + . . . + ik = m, 1 \u2264 m \u2264 s \u2212 1.\n\nFrom this by the above description of moments of order \u2264 n and of degree \u2264 l \u22121 we\nc on Gf (X\u2217 ), m\nc(g) = m\nc (g\ne). Since m\nc(g) = 0 by\nobtain that for each such a moment m\nc (g\ne) = 0, as well. Hence g\ne satisfies the conditions of Lemma 2.21.\nour hypothesis, m\nAccording to this lemma, ql (ge) \u2208 (Rl )n . But by our construction ql (g) = ql (ge). That\nis, ql (g) \u2208 (Rl )n . Using this and arguing as in the proof of Proposition 2.20 we find\na sequence {gl }l\u22652 \u2282 G(X\u2217 )n such that liml\u2192\u221e gl = g. In particular, g \u2208 Gf (X\u2217 )n .\nThis completes the proof of part (1) of Theorem 2.19. The second statement of this\ntheorem follows from the first one and from Proposition 2.20.\n\u2737\nIn conclusion let us mention that in [Br5, section 3.3] a topological characterization of paths representing elements of G(X\u2217 )n is given, similar to that for elements\nof the set of universal centers U, cf. section 2.2.\n\n2.6. Subgroups of the Group of Formal Paths\n2.6.1. By X k \u2282 X we denote the subset of elements a = (a1 , . . . , ak , 0, 0, . . .) \u2208 X.\nThen X k is a sub-semigroup of X. The first integrals of elements of X k are paths\nin Ck . We set G(X k ) := \u03c0(X k ) \u2282 G(X) and let Gf (X k ) be the closure of G(X k )\nin Gf (X). The group Gf (X k ) will be called the group of formal paths in Ck . Let\n17\n\n\fpk : X \u2192 X k , pk (a1 , a2 , . . .) := (a1 , . . . , ak , 0, 0, . . .), be the natural projection. It\ninduces a surjective homomorphism of topological groups pbk : Gf (X) \u2192 Gf (X k ).\nIn particular, Gf (X) is the semidirect product of groups Ker pbk and Gf (X k ). In\nturn, the homomorphism pbk determines a continuous Lie algebra homomorphism\n\u03c6k : LLie \u2192 LLie where LLie is the Lie algebra of Gf (X), see section 2.4.1. It is\ndetermined by the conditions\n\u03c6k (Xs ) :=\n\n\uf8f1\n\uf8f4\n\uf8f2\n\uf8f4\n\uf8f3\n\nXs if 1 \u2264 s \u2264 k\n0\n\nif\n\ns > k.\n\nThe image of \u03c6k is a closed Lie subalgebra LkLie of LLie consisting of Lie elements\nb see\nin variables X1 , . . . , Xk and t. Identifying Gf (X) with its image under map E,\nsection 2.3.2, we obtain the commutative diagram\nexp\n\nLLie \u2212\u2192 Gf (X)\n\u03c6k \u2193\n\u2193 pbk\nexp\nk\nLLie \u2212\u2192 Gf (X k ).\n\n(2.31)\n\nThus LkLie can be regarded as the Lie algebra of Gf (X k ).\nAlso, analogs of Theorems 2.17 and 2.19 are valid for topological lower central\nseries of Gf (X k ) and Gf (X\u2217k ) (the group of formal closed paths in Ck ) where in these\nresults we consider basic iterated integrals and moments on Gf (X k ), respectively.\n2.6.2. Let F \u2282 C be a field. By XF \u2282 X we denote the subset of elements\na \u2208 X such that I(a) \u2208 F for all basic iterated integrals on X. Formulas (2.2) and\n(2.3) imply that XF is a sub-semigroup of X. By G(XF ) := \u03c0(XF ) we denote the\nb see (2.12), embeds\nsubgroup of Gf (X) generated by XF . The homomorphism E,\nG(XF ) into the subalgebra AF of A, see section 2.3.1, of formal power series whose\ncoefficients in expansion in I, X1 , X2 , . . . and t belong to F. We will identify G(XF )\nb\nwith its image under E.\nNext, by JF \u2282 AF we denote the two-sided ideal of elements f whose series\nexpansions do not contain terms with I. By JFk we denote the k th power of JF . Let\nus introduce the JF -adic topology on AF , i.e., a sequence {fi }i\u2208N \u2282 AF converges\nin this topology to f \u2208 AF if and only if for any l \u2208 N there is a natural number\nNl such that for all n \u2265 Nl the images of fn and f in the quotient algebra AF /JFl\ncoincide. Observe that AF is complete in this topology. By Gf (XF ) \u2282 AF we denote\nthe completion of G(XF ) in the JF -adic topology. We call it the group of formal\npaths over F.\nLet [XF ]rect be a sub-semigroup of the semigroup of rectangular paths Xrect\ngenerated by elements ai = (a1i , a2i , . . .) where aki = 0 for k 6= i and aii = ci /T ,\ni\nci \u2208 F. Then G([XF ]rect ) is the subgroup of G(Xrect) generated by elements eci Xi t ,\nci \u2208 F, i \u2208 N. Based on the results of sections 2.4.1 and 2.4.2 one obtains that\nG([XF ]rect ) is dense in Gf (XF ). Moreover, the Lie algebra LLie(F) \u2282 LLie of Gf (XF )\nconsists of all Lie elements with coefficients from F.\nIn the same way one can formulate analogs of Theorems 2.17 and 2.19 for topological lower central series of G(XF ) and Gf (XF ) in terms of basic iterated integrals\n18\n\n\fand moments on Gf (XF ), respectively. (We leave the details to the reader.)\n2.6.3. In the sequel we will use the following result.\nLet R \u2282 LLie be a subset. By AR \u2282 LLie we denote the minimal closed Lie\nsubalgebra containing R. Consider the subgroup HR \u2282 Gf (X) (\u2282 G) generated by\nelements ecr for all possible r \u2208 R and c \u2208 C. By H R we denote the closure of HR\nin Gf (X).\nProposition 2.22 We have\nlog(H R ) = AR .\nMoreover, H R is a normal subgroup of Gf (X) if and only if AR is a normal Lie\nsubalgebra of LLie .\nProof. We retain the notations of section 2.4.2.\nConsider the image (HR )l := ql (HR ) \u2282 Ql := ql (Gf (X)). Then, (HR )l is a\ncomplex Lie subgroup of Ql . It can be shown similarly to the statement of Lemma\n2.12 where instead of the map FK given by (2.18) we determine now a new map\nFK : Ck \u2192 CN , N := dimC Ql , with K = {r1 , . . . , rk } \u2282 R by the formula\nFK (z1 , . . . , zk ) := ql (ez1 r1 * * * ezk rk ).\nThen, as in the proof of the lemma, FK is a holomorphic polynomial map. Applying\nnow the arguments of Lemma 2.12 to the family of such maps FK , we finally get\nthe required: (HR )l is a complex Lie subgroup of Ql . In particular, we also have\n(H R )l := ql (H R ) = (HR )l .\nFrom the above statement we obtain that log((HR )l ) \u2282 LlLie is the Lie algebra\nof (HR )l (cf. (2.21)). Since log((HR )l ) contains ql (R) and (HR )l is generated by\nelements ecql (r) for all possible r \u2208 R and c \u2208 C, the Campbell-Hausdorff formula\nimplies that\n(2.32)\nlog((H R )l ) = log((HR )l ) = ql (AR ).\nAssume now that h \u2208 log(H R ). According to (2.32) there is a sequence {hl }l\u22652 \u2282\nAR such that ql (h \u2212 hl ) = 0 for all l. This implies that liml\u2192\u221e hl = h, that is,\nlog(H R ) \u2282 AR . The inclusion AR \u2282 log(H R ) is obtained similarly using the fact\nthat log(H R ) is a closed subset of LLie .\nNow, if H R is a normal subgroup of Gf (X), then (H R )l is a normal Lie subgroup\nof Ql . This and (2.32) imply that ql (AR ) is a normal Lie subalgebra of LlLie (the\nstandard fact of the theory of finite-dimensional complex Lie groups). Thus, if\na \u2208 LLie , h \u2208 AR , then ql ([a, h)] = [ql (a), ql (h)] \u2208 ql (AR ) for all l. As above, the\nlatter implies that liml\u2192\u221e gl = [a, h] for some {gl }l\u22652 \u2282 AR , i.e., [a, h] \u2208 AR . Hence,\nAR is a normal subalgebra of LlLie . The converse statement can be obtained in the\nsame way (we leave the details to the reader).\n\u2737\nRemark 2.23 The above result can be proved by means of the Campbell-Hausdorff\nformula only. This method of the proof works also in a similar result for R \u2282 LLie(F)\nand HR \u2282 Gf (XF ) generated by elements ecr for all possible r \u2208 R and c \u2208 F.\n19\n\n\f3\n\nCenter Problem for ODEs\n\n3.1. An Explicit Expression for the First Return Map\n3.1.1. Let C[[z]] be the algebra of formal complex power series in z. By D, L :\nC[[z]] \u2192 C[[z]] we denote the differentiation and the left translation operators deP\nk\nfined on f (z) = \u221e\nk=0 ck z by\n(Df )(z) :=\n\n\u221e\nX\n\n(k + 1)ck+1 z k ,\n\n(Lf )(z) :=\n\nk=0\n\n\u221e\nX\n\nck+1 z k .\n\n(3.1)\n\nk=0\n\nLet A(D, L) be the associative algebra with unit I of complex polynomials in I,\nD and L. By A(D, L)[[t]] we denote the associative algebra of formal power series\nin t with coefficients from A(D, L). Also, by G0 (D, L)[[t]] we denote the group of\ninvertible elements of A(D, L)[[t]] consisting of elements whose expansions in t begin\nwith I.\nFurther, consider equation (1.1) corresponding to an a = (a1 , a2 , . . .) \u2208 X:\n\u221e\ndv X\nai (x)v i+1 ,\n=\ndx i=1\n\nx \u2208 IT .\n\n(3.2)\n\nUsing the linearization of (3.2) described in [Br1] we associate to this equation the\nfollowing system of ODEs:\nH \u2032 (x) =\n\n\u221e\nX\n\n!\n\nai (x)DLi\u22121 ti H(x),\n\ni=1\n\nx \u2208 IT .\n\n(3.3)\n\nSolving (3.3) by Picard iteration we obtain a solution Ha : IT \u2192 G0 (D, L)[[t]],\nHa (0) = I, whose coefficients in the series expansion in D, L and t are Lipschitz\nfunctions on IT . It was established in [Br2, Theorem 1.1] that (3.2) determines a\ncenter (i.e., a \u2208 C) if and only if Ha (T ) = I. This implies the following result (see\n[Br5, Proposition 2.1]).\nTheorem 3.1\na \u2208 C \u21d0\u21d2\n\nX\n\npi1 ,...,ik Ii1 ,...,ik (a) \u2261 0\n\nfor all\n\ni\u2208N\n\n(3.4)\n\ni1 +***+ik =i\n\nwhere pi1 ,...,ik is a polynomial of degree k defined by\npi1 ,...,ik (t) = (t \u2212 i1 + 1)(t \u2212 i1 \u2212 i2 + 1)(t \u2212 i1 \u2212 i2 \u2212 i3 + 1) * * * (t \u2212 i + 1),\n\nt \u2208 C. (3.5)\nP\n\ni+1\n3.1.2. Let G[[r]] be the set of formal complex power series f (r) = r+ \u221e\n.\ni=1 di r\nLet di : G[[r]] \u2192 C be such that di (f ) is the (i+1)st coefficient in the series expansion\nof f . We equip G[[r]] with the weakest topology in which all di are continuous\nfunctions and consider the multiplication \u25e6 on G[[r]] defined by the composition of\nseries. Then G[[r]] is a separable topological group. Moreover, it is contractible\nand residually torsion free nilpotent. By Gc [[r]] \u2282 G[[r]] we denote the subgroup of\n\n20\n\n\fpower series locally convergent near 0 equipped with the induced topology. Next,\nwe define the map P : X \u2192 G[[r]] by the formula\nP (a) := r +\n\n\u221e\nX\ni=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =i\n\n\uf8f6\n\npi1 ,...,ik (i) * Ii1 ,...,ik (a)\uf8f8 r i+1 ,\n\n(3.6)\n\nsee (3.5). It follows from [Br3] that P (a \u2217 b) = P (a) \u25e6 P (b) and P (X) = Gc [[r]].\nMoreover, let v(x; r; a), x \u2208 IT , be the Lipschitz solution of equation (3.2) with\ninitial value v(0; r; a) = r. Clearly for every x \u2208 IT we have v(x; r; a) \u2208 Gc [[r]]. It\nwas proved in [Br1] that P (a) = v(T ; *; a) (i.e., P (a) is the first return map of (3.2)).\nIn particular, we have\nX\n\na \u2208 C \u21d0\u21d2\n\npi1 ,...,ik (i) * Ii1 ,...,ik (a) \u2261 0 for all i \u2208 N.\n\n(3.7)\n\ni1 +***+ik =i\n\nAlso, (3.6) implies that there is a continuous homomorphism Pb : G(X) \u2192 G[[r]]\nsuch that P = Pb \u25e6 \u03c0 (where \u03c0 : X \u2192 G(X) is the quotient map). We extend it by\ncontinuity to Gf (X) retaining the same symbol for the extension.\n\n3.2. Group of Formal Centers\n3.2.1. Let ChX1 , X2 i be the associative algebra with unit I of complex polynomials in I and free noncommutative variables X1 , X2 . Consider a homomorphism\n\u03c6 : ChX1 , X2 i \u2192 A(D, L) defined by conditions: \u03c6(X1 ) := D, \u03c6(X2 ) := L. Then\nKer\u03c6 \u2282 ChX1 , X2 i is a two-sided ideal generated by the element X1 X2 \u2212X2 X1 +X22 ,\nsee [Br2, Proposition 2.2]. In particular, see [Br2, Lemma 2.4], each p \u2208 A(D, L) is\nuniquely presented as\np(D, L, I) = a0 I +\n\nn\nX\n\nFk (D, L) where Fk (D, L) =\n\nk\nX\n\naik\u2212i,k D i Lk\u2212i\n\n(3.8)\n\ni=0\n\nk=1\n\nwith all a0 , aij,k \u2208 C.\nWe say that such p has degree n if the polynomial p(x, y, 1) in commutative\nvariables x, y has degree n. By Pn \u2282 A(D, L) we denote the complex vector space\nof polynomials of degree \u2264 n. We naturally identify Pn with the hermitian space\nCk(n) where k(n) = dimC Pn .\nLet A\u2217 \u2282 A(D, L)[[t]] be the subalgebra of series\nf=\n\n\u221e\nX\n\nfn tn\n\nwith fn \u2208 Pn ,\n\nn \u2208 Z+ .\n\n(3.9)\n\nn=0\n\nWe equip A\u2217 with the weakest topology in which all coefficients fn in expansion (3.9)\nconsidered as functions in f are continuous maps of A\u2217 into Ck(n) , n \u2208 Z+ . Since\nthe set of such maps is countable, A\u2217 is metrizable, cf. (2.4). Moreover, if d is a\nmetric on A\u2217 compatible with topology, then (A\u2217 , d) is a complete metric space (i.e.,\nP\nn\na sequence {fk = \u221e\n}\n\u2282 A such that each {fnk }k\u2208N \u2282 Pn is a Cauchy\nn=0 fnk t\nP\u221ek\u2208N n \u2217\nsequence converges to f = n=0 fn t \u2208 A\u2217 where fn = limk\u2192\u221e fnk , n \u2208 Z+ ).\n21\n\n\fBy G\u2217 \u2282 G0 (D, L)[[t]] we denote the subgroup of elements f \u2208 A\u2217 with f0 = I\nequipped with the induced topology. Then (G\u2217 , d) is a complete metric space.\nNext, consider an algebra homomorphism \u03a8 : A \u2192 A\u2217 determined by conditions\n\u03a8(Xi ) := DLi\u22121 ,\n\ni \u2208 N.\n\n(3.10)\n\n(Recall that A \u2282 C hX1 , X2 , . . .i [[t]] is defined by (2.6).) By the definition for\nf = c0 I +\n\n\u221e\nX\n\nn=1\n\nwe have\n\u03a8(f ) := c0 I +\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\nX\n\ni1 +***+ik =n\n\n\uf8f6\n\nci1 ,...,ik Xi1 * * * Xik \uf8f8 tn \u2208 A\n\uf8f6\n\nci1 ,...,ik DLi1 \u22121 * * * DLik \u22121 \uf8f8 tn \u2208 A\u2217 .\n\nRewriting each DLi1 \u22121 * * * DLik \u22121 in the form (3.8) (using identity DL \u2212 LD =\n\u2212L2 ), we conclude that \u03a8 is a continuous homomorphism of topological algebras.\nMoreover, \u03a8|G : G \u2192 G\u2217 is a continuous homomorphism of topological groups.\n(Recall that G is the subset of elements of A whose expansions in t begin with I.)\nObserve that \u03a8 transfers equation (2.8) (determining E : X \u2192 G, see (2.9)) to\nequation (3.3). In particular, we have\n\u03a8(E(a)) = Ha ,\n\na \u2208 X.\n\nThe last identity gives rise to the formula\nb\n\u03a8(E(g))\n= I+\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\n\uf8f6\n\nIbi1 ,...,ik (g)DLi1 \u22121 * * * DLik \u22121 \uf8f8 tn , g \u2208 Gf (X). (3.11)\n\n(Here, as before, we regard the basic iterated integrals Ib* as continuous functions on\nGf (X) extending them by continuity from G(X).)\n\n3.2.2. Let us observe that the Lie algebra LG\u2217 of G\u2217 consists of elements of A\u2217\nof form (3.9) with f0 = 0. As usual, for f, g \u2208 LG\u2217 their product is defined by the\nformula [f, g] := f * g \u2212 g * f . Also, the map exp : LG\u2217 \u2192 G\u2217 , exp(f ) := ef , is a\nhomeomorphism.\nThe group homomorphism \u03a8 : G \u2192 G\u2217 determines a continuous homomorphism\nof the corresponding Lie algebras such that the following diagram is commutative:\nexp\n\nLG \u2212\u2192\n\u03a8\u2193\nexp\nLG\u2217 \u2212\u2192\n\nG\n\u2193\u03a8\nG\u2217 .\n\n(3.12)\n\nBy LS \u2282 LG\u2217 we denote the image under \u03a8 of the Lie algebra LLie of the group\nb\n\u223c\nE(G\nf (X)) (= Gf (X)), see section 2.4.1.\nIn the calculations below we will use the following result.\n22\n\n\fLemma 3.2\n[DLi , DLj ] = (i \u2212 j)DLi+j+1.\nProof. It suffices to check the identity for elements z n \u2208 C[[z]] with n \u2265 i + j + 2.\nThen we have\n(DLi DLj )(z n ) = (n \u2212 j \u2212 i \u2212 1)(n \u2212 j)z n\u2212j\u2212i\u22122 ,\n(DLj DLi )(z n ) = (n \u2212 i \u2212 j \u2212 1)(n \u2212 i)z n\u2212i\u2212j\u22122 ,\n\nand\n\n(i \u2212 j)(DLi+j+1 )(z n ) = (i \u2212 j)(n \u2212 i \u2212 j \u2212 1)z n\u2212i\u2212j\u22122 .\nThese identities imply the required result.\nNow, for an element\ng=\n\n\u221e\nX\n\nn=1\n\nwe have\n\u03a8(g) :=\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\nX\n\ni1 +...+ik =n\n\n\u2737\n\uf8f6\n\nci1 ,...,ik [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]]\uf8f8 tn \u2208 LLie\n\uf8f6\n\nci1 ,...,ik [DLi1 \u22121 , [DLi2 \u22121 , [ * * * , [DLik\u22121 \u22121 , DLik \u22121 ] * * * ]]]\uf8f8 tn .\n\nSimplifying the right-hand side by Lemma 3.2 we finally obtain\n\u03a8(g) =\n\n\u221e\nX\n\nn=1\n\nwhere \u03b3n = 1 and\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\n\uf8f6\n\nci1 ,...,ik * \u03b3i1 ,...,ik DLn\u22121 \uf8f8 tn\n\n(3.13)\n\n\u03b3i1 ,...,ik := (ik\u22121 \u2212 ik )(ik\u22121 + ik \u2212 ik\u22122 ) * * * (i2 + * * * + ik \u2212 i1 ) for k \u2265 2.\nProposition 3.3 The following is true:\n(\n\nL S = g \u2208 L G\u2217 : g =\n\n\u221e\nX\n\nn\u22121 n\n\ngn DL\n\nn=1\n\n)\n\nt , gn \u2208 C, n \u2208 N .\n\n(3.14)\n\nProof. By V we denote the vector space on the right-hand side of (3.14). According\nto Lemma 3.2, V is a closed Lie subalgebra of LG\u2217 . Moreover, by (3.13) LS \u2282 V .\nP\nn\u22121 n\nThe converse implication is obvious: for an element g = \u221e\nt \u2208V\nn=1 gn DL\nP\u221e\nn\n\u2737\nconsider ge := n=1 gn Xn t \u2208 LLie . Then \u03a8(ge) = g, i.e., g \u2208 LS .\nFrom Proposition 3.3 and diagram (3.12) we immediately obtain:\nb\nS := (\u03a8 \u25e6 E)(G\nf (X)) is a closed subgroup of G\u2217 with the Lie algebra LS .\n\nb \u2282 G (X) consists\n3.2.3. According to (3.11) the normal subgroup Ker(\u03a8 \u25e6 E)\nf\nof elements g such that\nX\n\ni1 +***+ik =n\n\nIbi1 ,...,ik (g)DLi1 \u22121 * * * DLik \u22121 = 0 for all n \u2208 N.\n23\n\n\fRepeating literally the arguments of the proof of [Br5, Proposition 2.1] we obtain\nb \u21d0\u21d2\ng \u2208 Ker(\u03a8 \u25e6 E)\n\nX\n\ni1 +***+ik =i\n\npi1 ,...,ik Ibi1 ,...,ik (g) \u2261 0 for all i \u2208 N\n\n(3.15)\n\nwhere pi1 ,...,ik is the polynomial defined in (3.5).\nNext, recall that the homomorphism Pb : Gf (X) \u2192 G[[r]] is determined by\nPb (g) := r +\n\n\u221e\nX\ni=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =i\n\n\uf8f6\n\npi1 ,...,ik (i) * Ibi1 ,...,ik (g)\uf8f8 r i+1 ,\n\n(3.16)\n\nsee section 3.1.2. Then from (3.15) we obtain that\n\nb \u2282 Ker Pb .\nKer(\u03a8 \u25e6 E)\n\nThis implies that there is a homomorphism \u03a6 : S \u2192 G[[r]] such that\nb\nPb = \u03a6 \u25e6 \u03a8 \u25e6 E.\n\n(3.17)\n\nProposition 3.4 \u03a6 : S \u2192 G[[r]] is an isomorphism of topological groups.\nProof. Suppose that\ns := exp\n\n\u221e\nX\n\n!\n\nsn DLn\u22121 tn \u2208 S.\n\nn=1\n\n(3.18)\n\nThen, from (3.16), (3.17) we obtain\n\u221e\nX\n\n\uf8eb\n\n\uf8f6\n\npi1 ,...,ik (i) * si1 * * * sik * T k \uf8f8 i+1\n\uf8ed\nr .\n\u03a6(s) = r +\nk!\ni1 +***+ik =i\ni=1\nX\n\nP\n\n(3.19)\n\ni\n\n(I\u2212f )\nSince the map log : S \u2192 LS , log(f ) := \u2212 \u221e\n, is a homeomorphism, formula\ni=1\ni\n(3.19) and the definitions of topologies on S and G[[r]] imply that \u03a6 is a continuous\nhomomorphism.\nFurther, the expression in the brackets of (3.19) can be written in the form\nsi T +pi (s1 T, . . . , si\u22121 T ) where pi is a polynomial of degree i with rational coefficients\non Ri\u22121 . In particular, for any sequence {di }i\u2208N \u2282 C one can solve consequently the\nequations\nsi T + pi (s1 T, . . . , si\u22121 T ) = di , i \u2208 N,\n\nP\n\ni+1\nto get an element s of form (3.18) such that \u03a6(s) = r + \u221e\n. Moreover,\ni=1 di r\neach si in the definition of s is a polynomial in variables d1 , . . . , di . This implies\nthat \u03a6 has a continuous inverse \u03a6\u22121 : G[[r]] \u2192 S and completes the proof of the\nproposition.\n\u2737\n\nRemark 3.5 The Lie algebra LS is isomorphic to the algebra W1 (1), the nilpotent\npart of the Witt algebra of formal vector fields on R, which is known to be the\nd\n, i \u2208 N.\nLie algebra of G[[r]]. Recall that W1 (1) has the natural basis ei := r i+1 dr\ni\u22121\nThen the isomorphism w : LS \u2192 W1 (1) is given by w(DL ) = \u2212ei , i \u2208 N.\nIdentifying LS with W1 (1) by w we can regard the map \u03a6 \u25e6 exp as an exponential\nmap W1 (1) \u2192 G[[r]].\n24\n\n\fAccording to (3.17) and Proposition 3.4 we have\nb = Ker Pb .\nKer(\u03a8 \u25e6 E)\n\nThis group is denoted by Cbf and called the group of formal centers of equation (1.1).\nBy the definition Cbf is a closed normal subgroup of Gf (X). Moreover, Cbf contains\nthe subgroup Cb := \u03c0(C) \u2282 G(X), the group of centers of equation (1.1).\n\n3.3. Properties of the Group of Formal Centers\n\nb\n3.3.1. In what follows we identify Gf (X) and G(X) with their images under E.\nFormulas (3.15), (3.16) imply, cf. section 3.1:\n\ng \u2208 Cbf\n\nX\n\n\u21d0\u21d2\n\ni1 +***+ik =i\n\nX\n\ni1 +***+ik =i\n\npi1 ,...,ik Ibi1 ,...,ik (g) \u2261 0 for all i \u2208 N\n\n\u21d0\u21d2\n\npi1 ,...,ik (i) * Ibi1 ,...,ik (g) = 0 for all i \u2208 N\n\n(3.20)\n\npi1 ,...,ik (t) = (t \u2212 i1 + 1)(t \u2212 i1 \u2212 i2 + 1) * * * (t \u2212 i + 1).\n\nwhere\n\nIn turn, (3.12) and (3.13) imply that the Lie algebra LCbf \u2282 LLie of Cbf consists\nof elements\n\u221e\nX\n\nn=1\n\nsuch that\nX\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\n\uf8f6\n\nci1 ,...,ik [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]]\uf8f8 tn\n\nci1 ,...,ik * \u03b3i1 ,...,ik = 0 for all n \u2208 N where \u03b3n = 1 and\n\ni1 +***+ik =n\n\n(3.21)\n\n\u03b3i1 ,...,ik = (ik\u22121 \u2212 ik )(ik\u22121 + ik \u2212 ik\u22122 ) * * * (i2 + * * * + ik \u2212 i1 ) for k \u2265 2.\n(In particular, the map exp : LCbf \u2192 Cbf is a homeomorphism.)\nFurther, by the definition we have\nCb = Cbf \u2229 G(X).\n\nProposition 3.6 Cb is a dense subgroup of Cbf .\n\n(3.22)\n\nProof. According to [Br3, Theorem 2.10] there exists a continuous embedding\nT : Gc [[r]] \u2192 G(X) such that Pb \u25e6 T = id. Moreover, Te : Gc [[r]] \u00d7 Cb \u2192 G(X),\nTe (s, g) := T (s) * g is a homeomorphism. We extend T by continuity to a map\nTf : G[[r]] \u2192 Gf (X). Since Pb \u25e6 T = id, similarly we have Pb \u25e6 Tf = id. In particular,\nTf is an embedding.\nb be the closure of Cb in Cb . We extend the map Te by continuity to a\nLet cl(C)\nf\ne\nb\nmap Tf : G[[r]] \u00d7 cl(C) \u2192 Gf (X). Then, Tef (s, g) := Tf (s) * g. Next, since Te is a\n25\n\n\fhomeomorphism and G(X) is dense in Gf (X), the map Tef is a homeomorphism, as\nwell (the inverse Tef\u22121 of Tef is the extension by continuity of Te \u22121 ). In particular, for\nb This implies\ng \u2208 Cbf we have g = Tf (s) * h for some s \u2208 G[[r]], h \u2208 cl(C).\n1 = Pb (g) = Pb (Tf (s) * h) = Pb (Tf (s)) * Pe (h) = s.\n\nb\nHence, g = h \u2208 cl(C).\n\n\u2737\n\nP\n\nn\n3.3.2. By L \u2282 LLie we denote the closed subspace of elements g = \u221e\nn=1 gn Xn t ,\ngn \u2208 C, n \u2208 N. Then there is a continuous linear isomorphism A : LS \u2192 L\ndetermined by A(DLn\u22121 tn ) := Xn tn , n \u2208 N. Thus, \u03a8\u25e6A = id. The map \u03a0 := A\u25e6\u03a8 :\nLLie \u2192 L is a continuous linear projection onto L. Moreover, id \u2212 \u03a0 : LLie \u2192 LCbf\nis a continuous linear projection onto LCbf . Hence \u03a0 \u2295 (id \u2212 \u03a0) : LLie \u2192 L \u2295 LCbf is\nan isomorphism. Also, every element g \u2208 LCbf is presented in the form\n\ng=\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n, k\u22652\n\n\uf8f6\n\nci1 ,...,ik vi1 ,...,ik \uf8f8 tn\n\nwhere\n\n(3.23)\n\nvi1 ,...,ik := [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]] \u2212 \u03b3i1 ,...,ik Xn .\nRecall that elements {vi1 ,...,ik : i1 +* * *+ik = n, k \u2265 2} are not linearly independent,\ncf. (2.14). The number of linearly independent elements in this set is\n\uf8eb\n\n\uf8f6\n\n1 \uf8ed X n/d\n(2 \u2212 1) * \u03bc(d)\uf8f8 \u2212 1.\nn d|n\n\nProposition 3.7 Cbf is the closure in Gf (X) of the group H generated by elements\nexp(ci1 ,...,ik vi1 ,...,ik ti1 +***+ik ) for all possible vi1 ,...,ik and ci1 ,...,ik \u2208 C.\nProof. According to Proposition 2.22, log(H) is the minimal closed Lie subalgebra\nof LLie containing all possible elements vi1 ,...,ik ti1 +***+ik . By (3.23) this subalgebra\ncoincides with LCbf . Thus, H = Cbf .\n\u2737\n\nQuestion 1. Is it true that every nontrivial element exp(ci1 ,...,ik vi1 ,...,ik ti1 +***+ik )\nbelongs to Gf (X) \\ G(X), i.e., it cannot be presented by an element from X?\n3.3.3. Let us consider a continuous homomorphism \u03c02 : LLie \u2192 LLie determined\nby the conditions\n\u03c02 (Xi ) :=\n\n\uf8f1\n\uf8f4\n\uf8f2\n\uf8f4\n\uf8f3\n\nXi\n\nfor i = 1, 2\n(3.24)\n\n1\ni\u22122\n\n* [\u03c02 (Xi\u22121 ), X1 ] for\n\ni \u2265 3.\n\nFrom this definition we get\n\u03c02 (Xi ) =\n\n(\u22121)i\n* [X1 , [X1 , [ * * * , [X1 , X2 ] * * * ]]]\n{z\n}\n(i \u2212 2)! |\n(i\u22122)\u2212brackets\n\n26\n\nfor i \u2265 3.\n\n(3.25)\n\n\fTherefore \u03c02 maps LLie surjectively onto L2Lie , the Lie algebra of the group Gf (X 2 )\nof formal paths in C2 , see section 2.6.1.\nProposition 3.8 The kernel Ker(\u03c02 ) is a subgroup of LCbf . It is the minimal normal closed Lie subalgebra N of LLie containing elements {si ti }i\u22653 where\nsi := Xi \u2212\n\n1\n* [Xi\u22121 , X1 ],\ni\u22122\n\ni \u2265 3.\n\nProof. By the definition each si ti \u2208 Ker(\u03c02 ). Since \u03c02 is continuous, N \u2282 Ker(\u03c02 ).\nNext, consider an element\ng=\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\nci1 ,...,ik [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * *\n\ni1 +...+ik =n\n\n\uf8f6\n\n]]]\uf8f8 tn\n\n=\n\n\u221e\nX\n\ngn tn \u2208 LLie .\n\nn=1\n\nUsing (3.25) one can represent each gn as fn + hn where fn tn \u2208 N \u2229 (Ln * tn ) and\nhn tn \u2208 L2Lie \u2229 (Ln * tn ) (here Ln is the complex vector space generated by all possible\ngn , see (2.14)). Then we have\ng = f + h where f :=\n\n\u221e\nX\n\nfn tn \u2208 N\n\nand h :=\n\n\u221e\nX\n\nhn tn \u2208 L2Lie .\n\nn=1\n\nn=1\n\nIn particular, \u03c02 (g) = h. Thus g \u2208 Ker(\u03c02 ) if and only if h = 0, i.e., g \u2208 N .\n\u2737\nFurther, each si ti \u2208 LCbf , see (3.21). Hence Ker(\u03c02 ) = N \u2282 LCbf .\nIn the proof we have established also the natural decomposition\nLLie = N \u2295 L2Lie .\n\n(3.26)\n\nTaking the exponential map in (3.26) we obtain the following result.\nProposition 3.9 The group Gf (X) is the semidirect product of the normal subgroup\nexp(N ) \u2282 Cbf and Gf (X 2 ). Moreover, exp(N ) is the minimal normal closed subgroup\nof Gf (X) containing elements exp(ci si ti ) for all possible si and ci \u2208 C.\nProof. From the Campbell-Hausdorff formula for elements of Gf (X) using the fact\nthat N \u2282 LLie is a closed ideal we obtain for a \u2208 N , b \u2208 L2Lie :\nea+b = ea eb ec1 = ea (eb ec1 e\u2212b )eb = (ea ec2 )eb = ec3 eb\nfor some c1 , c2 , c3 \u2208 N . This and (3.26) give the first statement of the proposition.\nThe second statement is the direct consequence of Proposition 2.22 applied to\ni\nelements of R := {log(ea esi t e\u2212a ) = ea si ti e\u2212a \u2208 N : a \u2208 LLie , i \u2208 N}.\n\u2737\ni\n\nRemark 3.10 By the definition of si each formal path eci si t , ci \u2208 C, belongs to\nthe subgroup of formal paths in the subspace Wi \u2282 C\u221e where\nWi := {(z1 , z2 , . . .) \u2208 C\u221e : zk = 0 for all k 6\u2208 {1, i \u2212 1, i} } \u223c\n= C3 .\nIn particular, there exist elements \u03b3l \u2208 X with first integrals \u03b3el : IT \u2192 Wi , l \u2208 N,\ni\nsuch that the sequence {\u03c0(\u03b3l )}l\u2208N \u2282 G(X) converges to eci si t . (Recall that we\nb\nidentify Gf (X) with E(G\nf (X)).)\n27\n\n\fLet\n\u03a82 := \u03a8|Gf (X 2 ) : Gf (X 2 ) \u2192 S (\u223c\n= G[[r]]) and Pb2 := Pb |Gf (X 2 ) : Gf (X 2 ) \u2192 G[[r]].\n\nThen we have, cf. (3.17),\n\nPb2 = \u03a6 \u25e6 \u03a82 .\n\n(3.27)\n\nNext, we extend the homomorphism \u03c02 determined by (3.24) to a continuous\nendomorphism of the associative algebra A, see (2.6). We retain the same symbol\nfor the extension. Then \u03c02 maps Gf (X) surjectively onto Gf (X 2 ). Moreover, by\nProposition 3.9, Ker(\u03c02 |Gf (X) ) = exp(N ).\nProposition 3.11 The following identity is valid:\n\u03a8(g) = (\u03a82 \u25e6 \u03c02 )(g)\n\nfor all\n\ng \u2208 Gf (X).\n\nProof. Since for h \u2208 LLie we have\n\u03a8(eh ) = e\u03a8(h)\n\nand (\u03a82 \u25e6 \u03c02 )(eh ) = e(\u03a82 \u25e6\u03c02 )(h) ,\n\nit suffices to check the identity of the proposition for elements of LLie . Moreover, it\nsuffices to check it for elements Xi , i \u2208 N (because {Xi ti }i\u2208N are generators of LLie ).\nIn this case we have by the definitions of \u03a8 and \u03c02 and by Lemma 3.2\n\u03a8(Xi ) = DLi\u22121\n(\u03a82 \u25e6 \u03c02 )(Xi ) =\n\nand (\u03a82 \u25e6 \u03c02 )(Xi ) = DLi\u22121\n\nfor i = 1, 2,\n\n(\u22121)i\n* [D, [D, [ * * * , [D, DL] * * * ]]] = DLi\u22121\n{z\n}\n(i \u2212 2)! |\n\nfor i \u2265 3.\n\n(i\u22122)\u2212brackets\n\nThis completes the proof of the proposition.\n\u2737\nFrom this proposition, (3.17) and (3.27) we obtain that\nPb = Pb2 \u25e6 \u03c02 .\n\n(3.28)\n\nIn particular, the homomorphism Pb2 : Gf (X 2 ) \u2192 G[[r]] corresponding to the first\nreturn maps of \"generalized\" Abel equations is surjective. Moreover, Proposition\n3.9 implies that Cf is the semidirect product of exp(N ) and Cbf2 := Cbf \u2229 Gf (X 2 ) (the\ngroup of formal centers of Abel differential equations).\n3.3.4. It has been shown above that there is a reduction of the center problem\nfor Gf (X) to that for Gf (X 2 ). In this part we prove some results on the structure\nof the group Cbf2 .\nFirst, observe that Cbf2 \u2282 Gf (X 2 ) is determined by systems of equations of form\n(3.20) in which all il \u2208 {1, 2}, l \u2208 N. In turn, the Lie algebra LCb2 of Cbf2 is determined\nf\n\nby the system equations of form (3.21) in which also all il \u2208 {1, 2}, l \u2208 N.\n\n28\n\n\fBy L2 \u2282 L2Lie we denote the closed subspace of elements g =\nn \u2208 N, where r1 = X1 , r2 = X2 and\nrn :=\n\n(\u22121)n\n* [X1 , [X1 , [ * * * , [X1 , X2 ] * * * ]]]\n{z\n}\n(n \u2212 2)! |\n\nP\u221e\n\nn=1\n\ngn rn tn , gn \u2208 C,\n\nfor n \u2265 3.\n\n(3.29)\n\n(n\u22122)\u2212brackets\n\nBy the definition, \u03a82 (rn ) = DLn\u22121 . Then there is a continuous linear isomorphism\nA2 : LS \u2192 L2 determined by A2 (DLn\u22121 tn ) := rn tn , n \u2208 N, such that \u03a82 \u25e6 A2 = id.\nThe map \u03a02 := A2 \u25e6 \u03a82 : L2Lie \u2192 L2 is a continuous linear projection onto L2 .\nMoreover, id \u2212 \u03a02 : L2Lie \u2192 LCb2 is a continuous linear projection onto LCb2 . Hence,\nf\n\nf\n\n\u03a02 \u2295 (id \u2212 \u03a02 ) : L2Lie \u2192 L2 \u2295 LCb2\nf\n\nis an isomorphism.\n\n(3.30)\n\nThis implies that every element g \u2208 LCb2 is presented in the form\nf\n\ng=\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n, n\u22655\n\n\uf8f6\n\nci1 ,...,ik li1 ,...,ik \uf8f8 tn\n\nwhere all is \u2208 {1, 2}, s \u2208 N,\n(3.31)\n\nand li1 ,...,ik := [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]] \u2212 \u03b3i1 ,...,ik rn .\nThe elements {li1 ,...,ik : i1 + * * * + ik = n, n \u2265 5, is \u2208 {1, 2}} are not linearly\nindependent. It follows from [M-KO, Theorem 3.1] that the number of linearly\nindependent elements in this set is\n\uf8eb\n\n\u221a\n\n\uf8f6\n\nX\n\n1\uf8ed\nn/d\nn/d\n(\u03bb1 + \u03bb2 ) * \u03bc(d)\uf8f8 \u2212 1\nn d|n\n\u221a\n\n(3.32)\n\nwhere \u03bb1 = 1+2 5 , \u03bb2 = 1\u22122 5 , \u03bc is the M\u00f6bius function, see section 2.4.1, and the\nsum ranges over all integers which divide n.\nFurther, similarly to Propositions 3.7 from (3.30) and (3.31) we get\nProposition 3.12 (1) There is a continuous map Tf2 : G[[r]] \u2192 Gf (X 2 ) such\nthat Pb2 \u25e6 Tf2 = id. Moreover, the map Tef2 : G[[r]] \u00d7 Cbf2 \u2192 Gf (X 2 ) defined by\nTef2 (s, g) = Tf2 (s) * g is a homeomorphism.\n\n(2) The group Cbf2 is the closure in Gf (X 2 ) of the group H2 generated by elements exp(ci1 ,...,ik li1 ,...,ik ti1 +***+ik ) for all possible li1 ,...,ik and ci1 ,...,ik \u2208 C with\ni1 , . . . , ik \u2208 {1, 2}.\n\nProof. (1) We define the map Tf2 by the formula\nTf2 := exp \u25e6A2 \u25e6 log \u25e6\u03a6\u22121 .\n\n(3.33)\n\nThen Tf2 : G[[r]] \u2192 Gf (X 2 ) is continuous as the composite of continuous maps.\nAlso, from (3.27) by the properties of A2 we get\nPb2 \u25e6 Tf2 = \u03a6 \u25e6 \u03a82 \u25e6 exp \u25e6A2 \u25e6 log \u25e6\u03a6\u22121 = \u03a6 \u25e6 exp \u25e6\u03a82 \u25e6 A2 \u25e6 log \u25e6\u03a6\u22121 =\n\u03a6 \u25e6 exp \u25e6 id \u25e6 log \u25e6\u03a6\u22121 = \u03a6 \u25e6 \u03a6\u22121 = id.\n29\n\n\fNow, for the map Tef2 : G[[r]] \u00d7 Cbf2 \u2192 Gf (X 2 ), Tef2 (s, g) = Tf2 (s) * g, we define the\nmap Q : Gf (X 2 ) \u2192 G[[r]] \u00d7 Cbf2 by the formula\nQ(h) := (Pb2 (h), [(Tf2 \u25e6 Pb2 )(h)]\u22121 * h).\n\n(3.34)\n\nThe second term here belongs to Cbf2 because\n\nPb2 [(Tf2 (Pb2 (h)))\u22121 * h] = [(Pb2 \u25e6 Tf2 \u25e6 Pb2 )(h)]\u22121 * Pb2 (h) = [Pb2 (h)]\u22121 * Pb2 (h) = 1.\n\nClearly, both Tef2 and Q are continuous maps. Moreover,\n\n(Q \u25e6 Tef2 )(s, g) = Q(Tf2 (s) * g) = (Pb2 (Tf2 (s) * g), [(Tf2 \u25e6 Pb2 )(Tf2 (s) * g)]\u22121 * Tf2 (s) * g) =\n(s, [Tf2 (s)]\u22121 * Tf2 (s) * g) = (s, g).\n\nThus Q is the inverse map to Tef2 , i.e., Tef2 is a homeomorphism.\n(2) This statement is proved similarly to the proof of Proposition 3.7.\n\n\u2737\n\nQuestion 2. Is it true that there is a continuous map T 2 : Gc [[r]] \u2192 G(X 2 )\nsuch that Pb2 \u25e6 T 2 = id?\n\nThe affirmative answer to this question will show that each locally convergent\nseries from Gc [[r]] can be obtained as the first return map of an Abel differential\nequation. Moreover, as in the proof of Proposition 3.6 we will get that the group\nof centers Cb 2 := Cbf2 \u2229 G(X 2 ) of Abel differential equations is dense in the group of\nformal centers Cbf2 . Also, G(X 2 ) will be homeomorphic to Gc [[r]] \u00d7 Cb 2 .\n\n3.3.5. In this section we briefly discuss the center problem over a field F \u2282 C.\nLet GF [[r]] \u2282 G[[r]] be the subgroup of formal power series with coefficients from\nF. Let IFk be the normal subgroup of GF [[r]] consisting of elements f of the form\nf (z) := z + dk+1z k+1 + dk+2z k+2 + * * *. We equip GF [[r]] with {IFk }k\u2208N-adic topology,\ni.e., a sequence {fi }i\u2208N \u2282 GF [[r]] converges to f \u2208 GF [[r]] if and only if for any k \u2208 N\nthere is a number Nk \u2208 N such that for all n \u2265 Nk the images of fn and f in the\nquotient group GF [[r]]/IFk coincide. By Gc,F [[r]] \u2282 GF [[r]] we denote the subgroup\nof locally convergent power series in GF [[r]] equipped with the induced topology.\nFurther, consider the groups G(XF ) \u2282 Gf (XF ) of paths and formal paths over\nF, see section 2.6.2. According to (3.16) the homomorphism Pb (corresponding to\nthe first return maps of equations (1.1)) maps G(XF ) and Gf (XF ) into Gc,F [[r]] and\nGF [[r]], respectively. Also, by the definition of topologies on Gf (XF ) and GF [[r]],\nPb : Gf (XF ) \u2192 GF [[r]] is a continuous homomorphism of topological groups. We set\nCbF := G(XF ) \u2229 Cb and (CbF )f := Gf (XF ) \u2229 Cbf . These groups are referred to as the\ngroups of centers and formal centers over F. Then similarly to the results of the\nprevious sections one can prove the following statements.\n(1) g \u2208 (CbF )f if and only if the element g \u2208 Gf (XF ) satisfies equations (3.20).\n30\n\n\f(2) The Lie algebra L(CbF )f \u2282 LLie(F) of (CbF )f consists of elements\n\u221e\nX\n\nn=1\n\n(3)\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\n\uf8f6\n\nci1 ,...,ik [Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]]\uf8f8 tn\n\nwith all ci1 ,...,ik \u2208 F satisfying equations (3.21). In particular the exponential\nmap exp : L(CbF )f \u2192 (CbF )f is a homeomorphism.\nCbF is a dense subgroup of (CbF )f .\n\nThe last statement is proved similarly to Proposition 3.6 using Theorem 2.12\nof [Br3]. This result asserts that there is a continuous embedding TF : Gc,F [[r]] \u2192\nG(XF ) such that Pb \u25e6 TF = id. In particular, from here we obtain that G(XF ) is\nhomeomorphic to CbF \u00d7 Gc,F [[r]] and Gf (XF ) is homeomorphic to (CbF )f \u00d7 GF [[r]].\nFurther, one can prove a version of Proposition 3.7 (see Remark 2.23):\n(4) (CbF )f is the closure in Gf (XF ) of the group HF generated by elements\nexp(ci1 ,...,ik vi1 ,...,ik ti1 +***+ik ) for all possible vi1 ,...,ik determined by (3.23) and\nci1 ,...,ik \u2208 F.\nFor the group N := Ker(\u03c02 ), see section 3.3.3, we set NF := N \u2229 LLie(F) . Then\nrepeating word-for-word the proof of Proposition 3.8 we obtain that\n(5) NF is the minimal normal closed Lie subalgebra of LLie(F) containing elements\n1\nsi ti = (Xi \u2212 i\u22122\n* [Xi\u22121 , X1 ]) ti , i \u2265 3. Moreover, NF \u2282 L(CbF )f and\nLLie(F) = NF \u2295 L2Lie(F)\n\nwhere L2Lie(F) is the Lie algebra of Gf (XF2 ) := Gf (XF ) \u2229 Gf (X 2 ).\nFrom here as in the proof of Proposition 3.9 we obtain\n(6) The group Gf (XF ) is the semidirect product of the normal subgroup exp(NF ) \u2282\n(CbF )f and Gf (XF2 ). Moreover, exp(NF ) is the minimal closed subgroup of\nGf (XF ) containing elements exp(ci si ti ) for all possible si and ci \u2208 F.\nFinally, using the methods of the proof of Proposition 3.12 one can prove similar\nstatements for the group (CbF2 )f := (CbF )f \u2229 Gf (XF2 ):\n\n(7) There is a continuous map (TF2 )f : GF [[r]] \u2192 Gf (XF2 ) such that Pb2 \u25e6(TF2 )f = id.\nThe map (TeF2 )f : GF [[r]]\u00d7(CbF2 )f \u2192 Gf (XF2 ) defined by (TeF2 )f (s, g) = (TF2 )f (s)*g\nis a homeomorphism.\n\n(8) (CbF2 )f is the closure in Gf (XF2 ) of the group (HF )2 generated by elements\nexp(ci1 ,...,ik li1 ,...,ik ti1 +***+ik ) for all possible li1 ,...,ik defined by (3.31) and ci1 ,...,ik \u2208\nF, i1 , . . . , ik \u2208 {1, 2}.\nThe main point of the proofs of (4)-(6) and (8) is that all elements vi1 ,...,ik ti1 +***+ik ,\nsi ti and li1 ,...,ik ti1 +***+ik belong to LLie(Q) (and therefore to LLie(F) for any field F \u2282 C).\n31\n\n\f3.4. Group of Piecewise Linear Paths\nConsider elements g \u2208 Gf (X) of the form\nh\n\ng=e\n\nwhere h =\n\n\u221e\nX\n\nci Xi ti ,\n\nci \u2208 C, i \u2208 N.\n\n(3.35)\n\ni=1\n\nBy P L \u2282 Gf (X) we denote the group generated by all such g. It will be called the\ngroup of piecewise linear paths in C\u221e .\nf :=\nRemark 3.13 We can naturally extend the semigroup X considering the set X\n(L\u221e (IT ))N of all possible sequences a = (a1 , a2 , . . .), ai \u2208 L\u221e (IT ), i \u2208 N, with the\nmultiplication defined in section 2.1.1. We consider each L\u221e (IT ) with the weak\u2217\nf with\ntopology defined by L1 (IT ) (recall that L\u221e (T ) = (L1 (IT ))\u2217 ) and equip X\nf Moreover,\nthe corresponding product topology. Then X is a dense subset of X.\naccording to [Br3, Lemma 3.2] the quotient map \u03c0 : X \u2192 Gf (X) is continuous and\nf \u2192 G (X) (denoted also by \u03c0). Identifying\nso is extended to a continuous map X\nf\nb see (2.21), we obtain that P L is the image under\nGf (X) with its image under E,\nf\nf\n\u03c0 of the sub-semigroup X\nP L of X generated by elements c = (c1 , c2 , . . .), ci \u2208 C,\ni \u2208 N. In turn, first integrals of elements of this sub-semigroup are piecewise linear\npaths in C\u221e . This motivates the above definition.\n\nThe group P L contains the subgroup of rectangular paths G(Xrect), see section\n2.4.2. In particular, P L is a dense subgroup of Gf (X), see also Proposition 2.22.\nOne can also show (using, e.g., Theorem 2.2) that P L is isomorphic to the free\nR-product of groups C (i.e., the set of generators of this product has the cardinality\nof the continuum).\nBy CbP L := Cbf \u2229 P L we denote the group of formal centers in P L. Then CbP L\nf\nis the image in Gf (X) of the semigroup CP L \u2282 X\nP L consisting of all elements\nf\na = (a1 , a2 , . . .) \u2208 XP L such that monodromies of the equations\nH \u2032 (x) =\n\n\u221e\nX\n\n!\n\nai (x)DLi\u22121 ti H(x),\n\ni=1\n\nx \u2208 IT ,\n\nare trivial.\nFurther, recall that there exist a continuous embedding A : LS \u2192 L,\nP\ni\nn\u22121 n\nL := {c \u2208 LLie : c = \u221e\nt ) := Xn tn ,\ni=1 ci Xi t , ci \u2208 C, i \u2208 N}, defined by A(DL\nso that \u03a8 \u25e6 A = id, see section 3.3.2. For elements a, b \u2208 L we set\ns(a, b) := (A \u25e6 \u03a8 \u25e6 log)(ea * eb ) \u2208 L.\n\n(3.36)\n\nAssume that\na=\n\n\u221e\nX\n\nai Xi ti ,\n\nb=\n\n\u221e\nX\n\nbi Xi ti ,\n\nai , bi \u2208 C, i \u2208 N.\n\ni=1\n\ni=1\n\nUsing the Campbell-Hausdorff formula we have\nlog(ea * eb ) =\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +...+ik =n\n\n\uf8f6\n\nsi1 ,...,ik (a, b)[Xi1 , [Xi2 , [ * * * , [Xik\u22121 , Xik ] * * * ]]]\uf8f8 tn\n32\n\n\fwhere each si1 ,...,ik is a universal polynomial with rational coefficients in variables\nai1 , . . . , aik , bi1 , . . . , bik such that si1 ,...,ik (aii11 , . . . , aiikk , bii11 , . . . , biikk ) is a homogeneous\npolynomial of degree i1 + * * * + ik . Then from (3.23), (3.21) we obtain\ns(a, b) =\n\n\u221e\nX\n\nn=1\n\n\uf8eb\n\uf8ed\n\nX\n\ni1 +***+ik =n\n\n\uf8f6\n\n\u03b3i1 ,...,ik * si1 ,...,ik (a, b)\uf8f8 Xn tn .\n\n(3.37)\n\nIn general, the complex vector space spanned by a, b and s(a, b) is 3-dimensional.\nNext, formula (3.17) implies that Pb (es(a,b) ) = Pb (ea ) \u25e6 Pb (eb ). In particular,\na\ne * eb * e\u2212s(a,b) \u2208 CbP L .\nLet us define a continuous embedding TP L : G[[r]] \u2192 P L by the formula\nTP L := exp \u25e6A \u25e6 log \u25e6\u03a6\u22121 ,\ncf. (3.33). Then, Pb \u25e6 TP L = id.\n\nProposition 3.14 (1) The map TeP L : G[[r]] \u00d7 CbP L \u2192 P L defined by TeP L (s, g) =\nTP L (s) * g is a homeomorphism.\n(2) CbP L is generated by elements ea * eb * e\u2212s(a,b) for all possible a, b \u2208 L.\n(3) CbP L is a dense subgroup of Cbf .\n\nProof. (1) The proof repeats literally the proof of Proposition 3.12 (1).\n(2) It follows easily from the definition of TP L and Pb , see (3.17), that\nTP L (Pb (ea * eb )) = es(a,b) ,\n\na, b \u2208 L.\n\n(3.38)\n\nSuppose that g = g1 * * * gn \u2208 CbP L where gi = eai , ai \u2208 L, 1 \u2264 i \u2264 n. We set\nfi := Pb (g1 * * * gi ),\n\n1 \u2264 i \u2264 n,\n\nwhere by the definition fn = 1. We also set for brevity\nc(h1 , h2 ) := h1 * h2 * e\u2212s(log(h1 ),log(h2 )) ,\n\nh1 , h2 \u2208 P L.\n\nThen using (3.38) we obtain\ng = c(TP L (f1 ), g2 ) * c(TP L (f2 ), g3 ) * * * c(TP L (fn\u22121 ), gn ) * TP L (fn ).\nSince TP L (fn ) = 1, this implies the required statement.\n(3) The proof repeats word-for-word the second part of the proof of Proposition\n3.6 and is based on the fact that P L is dense in Gf (X).\n\u2737\nQuestion 3. Are there nontrivial elements in the group CbPn L := Cbfn \u2229P L of piecewise\nlinear centers in Cn ? Here Cbfn := Cbf \u2229 Gf (X n ).\nWe will return to this question in a forthcoming paper.\n33\n\n\fReferences\n[A] H. Alexander, Polynomial approximation and hulls in sets of finite linear measure in Cn . Amer. J. Math. 93 (1971), 65-74.\n[AL] M. A. M. Alwash and N. G. Lloyd, Non-autonomous equations related to\npolynomial two-dimensional systems. Proc. Roy. Soc. Edinburgh Sect. A 105\n(1987), 129-152.\n[AW] H. Alexander and J. Wermer, Several Complex Variables and Banach Algebras. Springer-Verlag. New York, 1998.\n[BFY1] M. Briskin, J.-P. Francoise and Y. Yomdin, Center condition II: Parametric\nand model center problems. Israel J. Math. 118 (2000), 61-82.\n[BFY2] M. Briskin, J.-P. Francoise and Y. Yomdin, Center condition III: Parametric\nand model center problems. Israel J. Math. 118 (2000), 83-108.\n[Br1] A. Brudnyi, An explicit expression for the first return map in the center problem. J. Differential Equations 206 (2004), 306-314.\n[Br2] A. Brudnyi, On the center problem for ordinary differential equations. Amer.\nJ. Math. 128 (2006), 419-451.\n[Br3] A. Brudnyi, An algebraic model for the center problem. Bull. Sci. Math. 128\n(2004), 839-857.\n[Br4] A. Brudnyi, On center sets of ODEs determined by moments of their coefficients. Bull. Sci. Math. 130 (2006), 33-48.\n[Br5] A. Brudnyi, Vanishing of higher-order moments on Lipschitz curves. Bull. Sci.\nMath., to appear.\n[C1] K.-T. Chen, Iterated integrals and exponential homomorphisms. Proc. London\nMath. Soc. 4 (1954) (3), 502-512.\n[C2] K.-T. Chen, Integration of paths, geometric invariants and a generalized BakerHausdorff formula. Ann. of Math. 65 (1957), No. 1, 163-178.\n[C3] K.-T. Chen, Integration of paths- a faithful representation of paths by noncommutative formal power series. Trans. AMS 89 (1958), 8-36.\n[F] H. Freudenthal, \u00dcber dimensionserh\u00f6hende stetige Abbildungen. S.-B. Preuss.\nAkad. Wiss. H. 5 (1932), 34-38.\n[H] R. M. Hain, The geometry of the mixed Hodge structure on the fundamental\ngroup. Proc. of Symposia in Pure Math. 46 (1987), 247-282.\n[M] D. Mumford, Algebraic Geometry I. Complex projective varieties. SpringerVerlag. New York, 1976.\n34\n\n\f[M-KO] H. Munthe-Kaas and B. Owren, Computations in a free Lie algebra. Phil.\nTrans. Royal Soc. A 357 (1999), 957-981.\n[R] R. Ree, Lie elements and an algebra associated with shuffles. Ann. of Math. (2)\n68 (1958), 550-561.\n[W] J. Wermer, The hull of a curve in Cn . Ann. of Math. (2) 68 (1958), 550-561.\n[Y] Y. Yomdin, Center problem for the Abel equation, compositions of functions\nand moment conditions. Moscow Math. J. 3 (3) (2003), 1167-1195.\n\n35\n\n\f"}