{"id": "http://arxiv.org/abs/0708.0443v2", "guidislink": true, "updated": "2008-10-25T04:27:40Z", "updated_parsed": [2008, 10, 25, 4, 27, 40, 5, 299, 0], "published": "2007-08-03T01:08:32Z", "published_parsed": [2007, 8, 3, 1, 8, 32, 4, 215, 0], "title": "Avoiding small subgraphs in Achlioptas processes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0708.1640%2C0708.0171%2C0708.3799%2C0708.3256%2C0708.2783%2C0708.4282%2C0708.3176%2C0708.0923%2C0708.0375%2C0708.0443%2C0708.0227%2C0708.2278%2C0708.1667%2C0708.1004%2C0708.0239%2C0708.3395%2C0708.3123%2C0708.2992%2C0708.3630%2C0708.0856%2C0708.4147%2C0708.1220%2C0708.0086%2C0708.4367%2C0708.0508%2C0708.3766%2C0708.3986%2C0708.3593%2C0708.1006%2C0708.1805%2C0708.0936%2C0708.2601%2C0708.3266%2C0708.0483%2C0708.1123%2C0708.0391%2C0708.2835%2C0708.4187%2C0708.0085%2C0708.1934%2C0708.2340%2C0708.3119%2C0708.0341%2C0708.2464%2C0708.1318%2C0708.1411%2C0708.3382%2C0708.0823%2C0708.0490%2C0708.0695%2C0708.0843%2C0708.4197%2C0708.0641%2C0708.2689%2C0708.3734%2C0708.3090%2C0708.0876%2C0708.0269%2C0708.2291%2C0708.2953%2C0708.1907%2C0708.0901%2C0708.2215%2C0708.3478%2C0708.0733%2C0708.0592%2C0708.2254%2C0708.1859%2C0708.1136%2C0708.2156%2C0708.0533%2C0708.1354%2C0708.3943%2C0708.1375%2C0708.2857%2C0708.1339%2C0708.0003%2C0708.0384%2C0708.3694%2C0708.1364%2C0708.1020%2C0708.0955%2C0708.3343%2C0708.3934%2C0708.1518%2C0708.4287%2C0708.0866%2C0708.1826%2C0708.1962%2C0708.2350%2C0708.2909%2C0708.3120%2C0708.1692%2C0708.0131%2C0708.1817%2C0708.3188%2C0708.2349%2C0708.1126%2C0708.3008%2C0708.1867%2C0708.2240&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Avoiding small subgraphs in Achlioptas processes"}, "summary": "For a fixed integer r, consider the following random process. At each round,\none is presented with r random edges from the edge set of the complete graph on\nn vertices, and is asked to choose one of them. The selected edges are\ncollected into a graph, which thus grows at the rate of one edge per round.\nThis is a natural generalization of what is known in the literature as an\nAchlioptas process (the original version has r=2), which has been studied by\nmany researchers, mainly in the context of delaying or accelerating the\nappearance of the giant component.\n  In this paper, we investigate the small subgraph problem for Achlioptas\nprocesses. That is, given a fixed graph H, we study whether there is an online\nalgorithm that substantially delays or accelerates a typical appearance of H,\ncompared to its threshold of appearance in the random graph G(n, M). It is easy\nto see that one cannot accelerate the appearance of any fixed graph by more\nthan the constant factor r, so we concentrate on the task of avoiding H. We\ndetermine thresholds for the avoidance of all cycles C_t, cliques K_t, and\ncomplete bipartite graphs K_{t,t}, in every Achlioptas process with parameter r\n>= 2.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0708.1640%2C0708.0171%2C0708.3799%2C0708.3256%2C0708.2783%2C0708.4282%2C0708.3176%2C0708.0923%2C0708.0375%2C0708.0443%2C0708.0227%2C0708.2278%2C0708.1667%2C0708.1004%2C0708.0239%2C0708.3395%2C0708.3123%2C0708.2992%2C0708.3630%2C0708.0856%2C0708.4147%2C0708.1220%2C0708.0086%2C0708.4367%2C0708.0508%2C0708.3766%2C0708.3986%2C0708.3593%2C0708.1006%2C0708.1805%2C0708.0936%2C0708.2601%2C0708.3266%2C0708.0483%2C0708.1123%2C0708.0391%2C0708.2835%2C0708.4187%2C0708.0085%2C0708.1934%2C0708.2340%2C0708.3119%2C0708.0341%2C0708.2464%2C0708.1318%2C0708.1411%2C0708.3382%2C0708.0823%2C0708.0490%2C0708.0695%2C0708.0843%2C0708.4197%2C0708.0641%2C0708.2689%2C0708.3734%2C0708.3090%2C0708.0876%2C0708.0269%2C0708.2291%2C0708.2953%2C0708.1907%2C0708.0901%2C0708.2215%2C0708.3478%2C0708.0733%2C0708.0592%2C0708.2254%2C0708.1859%2C0708.1136%2C0708.2156%2C0708.0533%2C0708.1354%2C0708.3943%2C0708.1375%2C0708.2857%2C0708.1339%2C0708.0003%2C0708.0384%2C0708.3694%2C0708.1364%2C0708.1020%2C0708.0955%2C0708.3343%2C0708.3934%2C0708.1518%2C0708.4287%2C0708.0866%2C0708.1826%2C0708.1962%2C0708.2350%2C0708.2909%2C0708.3120%2C0708.1692%2C0708.0131%2C0708.1817%2C0708.3188%2C0708.2349%2C0708.1126%2C0708.3008%2C0708.1867%2C0708.2240&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "For a fixed integer r, consider the following random process. At each round,\none is presented with r random edges from the edge set of the complete graph on\nn vertices, and is asked to choose one of them. The selected edges are\ncollected into a graph, which thus grows at the rate of one edge per round.\nThis is a natural generalization of what is known in the literature as an\nAchlioptas process (the original version has r=2), which has been studied by\nmany researchers, mainly in the context of delaying or accelerating the\nappearance of the giant component.\n  In this paper, we investigate the small subgraph problem for Achlioptas\nprocesses. That is, given a fixed graph H, we study whether there is an online\nalgorithm that substantially delays or accelerates a typical appearance of H,\ncompared to its threshold of appearance in the random graph G(n, M). It is easy\nto see that one cannot accelerate the appearance of any fixed graph by more\nthan the constant factor r, so we concentrate on the task of avoiding H. We\ndetermine thresholds for the avoidance of all cycles C_t, cliques K_t, and\ncomplete bipartite graphs K_{t,t}, in every Achlioptas process with parameter r\n>= 2."}, "authors": ["Michael Krivelevich", "Po-Shen Loh", "Benny Sudakov"], "author_detail": {"name": "Benny Sudakov"}, "author": "Benny Sudakov", "arxiv_comment": "43 pages; reorganized and shortened", "links": [{"href": "http://arxiv.org/abs/0708.0443v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0708.0443v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05C80, 60C05", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0708.0443v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0708.0443v2", "journal_reference": null, "doi": null, "fulltext": "Avoiding small subgraphs in Achlioptas processes\n\narXiv:0708.0443v2 [math.CO] 25 Oct 2008\n\nMichael Krivelevich\n\n\u2217\n\nPo-Shen Loh\n\n\u2020\n\nBenny Sudakov\n\n\u2021\n\nAbstract\nFor a fixed integer r, consider the following random process. At each round, one is presented\nwith r random edges from the edge set of the complete graph on n vertices, and is asked to choose\none of them. The selected edges are collected into a graph, which thus grows at the rate of one\nedge per round. This is a natural generalization of what is known in the literature as an Achlioptas\nprocess (the original version has r = 2), which has been studied by many researchers, mainly in the\ncontext of delaying or accelerating the appearance of the giant component.\nIn this paper, we investigate the small subgraph problem for Achlioptas processes. That is,\ngiven a fixed graph H, we study whether there is an online algorithm that substantially delays\nor accelerates a typical appearance of H, compared to its threshold of appearance in the random\ngraph G(n, M ). It is easy to see that one cannot accelerate the appearance of any fixed graph\nby more than the constant factor r, so we concentrate on the task of avoiding H. We determine\nthresholds for the avoidance of all cycles Ct , cliques Kt , and complete bipartite graphs Kt,t , in\nevery Achlioptas process with parameter r \u2265 2.\n\n1\n\nIntroduction\n\nThe standard Erd\u0151s-R\u00e9nyi random graph model G(n, M ) can be described as follows. Start with the\nempty graph on n vertices, and perform M rounds, adding one random edge to the graph at each\nround. For any monotone increasing graph property (such as containment of K4 as a subgraph, say),\nit is natural to ask whether there is some value of M at which the probability of G(n, M ) satisfying\nthe property changes rapidly from nearly 0 to nearly 1. More precisely, a function M \u2217 (n) is said to be\na threshold for a property P if for any M (n) \u226a M \u2217 (n), the random graph G(n, M ) does not satisfy\nP whp, but for any M (n) \u226b M \u2217 (n), the random graph G(n, M ) satisfies P whp. Here, whp stands\nfor with high probability, that is, with probability tending to 1 as n \u2192 \u221e, and f (n) \u226a g(n) means\nthat f (n)/g(n) \u2192 0 as n \u2192 \u221e. A classical result of Bollob\u00e1s and Thomason [10] implies that every\nmonotone graph property has a threshold, and much work has been done to determine thresholds for\nvarious properties.\nRecently, there was much interest in the following natural variant of the classical model. We still\nbegin with the empty graph and perform a series of rounds, but at each round, one is now presented\n\u2217\n\nSchool of Mathematical Sciences, Raymond and Beverly Sackler Faculty of Exact Sciences, Tel Aviv University, Tel\nAviv 69978, Israel. E-mail: krivelev@post.tau.ac.il. Research supported in part by USA-Israel BSF Grants 2002-133 and\n2006-322, and by grant 526/05 from the Israel Science Foundation.\n\u2020\nDepartment of Mathematics, Princeton University, Princeton, NJ 08544. E-mail: ploh@math.princeton.edu. Research supported in part by a Fannie and John Hertz Foundation Fellowship, an NSF Graduate Research Fellowship,\nand a Princeton Centennial Fellowship.\n\u2021\nDepartment of Mathematics, UCLA, Los Angeles, CA 90095. E-mail: bsudakov@math.ucla.edu. Research supported\nin part by NSF CAREER award DMS-0812005, and a USA-Israeli BSF grant.\n\n1\n\n\fwith two independent and uniformly random edges, and is asked to choose one of them to add to the\ngraph. This is known in the literature as an Achlioptas process, after Dimitris Achlioptas, who asked\nthe question of whether there was an online algorithm which could, with high probability, substantially\ndelay the appearance of the giant component (a connected component with \u03a9(n) vertices).\nThe trivial algorithm, which arbitrarily chooses the first edge in each offered pair, essentially\nproduces the random graph G(n, M ) after M rounds, so G(n, M ) serves as the benchmark against\nwhich comparisons are made. A classical result of Erd\u0151s and R\u00e9nyi [11] states that if M = cn for\nany absolute constant c > 1/2, then the random graph G(n, M ) contains a giant component whp.\nFor the Achlioptas process, Bohman and Frieze [4] presented an algorithm which could run for 0.535n\nrounds, while keeping the size of the largest component only poly-logarithmic in n whp. Since then,\nmuch work has been done [2, 3, 5, 6, 7, 13, 16]. The current best result for this problem is due to\nSpencer and Wormald [16], who exhibit an algorithm that can run for 0.829n rounds while keeping all\ncomponent sizes bounded by O(log n) whp. In the opposite direction, Bohman, Frieze, and Wormald\n[5] have shown that no algorithm can succeed whp past 0.964n rounds. Several variants have also been\nstudied, such as the offline version, a two-player version, and the question of embracing (accelerating\nthe appearance of) the giant component.\nWhile the main focus of the research mentioned above was the giant component, it is natural\nto study other graph properties in the context of Achlioptas processes. In this paper, we study the\nproblem which in the literature is referred to as the small subgraph problem. This was one of the main\nproblems studied in the seminal paper of Erd\u0151s and R\u00e9nyi [11] from 1960, which was the starting point\nof the theory of random graphs. The original problem, stated for the random graph model G(n, M ),\nwas as follows: given a fixed graph H (a triangle or K4 , say), find the smallest value of M such that\nthe random graph G(n, M ) contains H as a (not necessarily induced) subgraph whp. The subgraph\nis called \"small\" because its size is fixed while n tends to infinity.\nIt turns out that in this problem, the relevant parameter is the maximum edge density m(G) =\nmax{e(H)/v(H) : H is a subgraph of G}. In their original paper, Erd\u0151s and R\u00e9nyi found thresholds\nfor all balanced graphs, which are the graphs whose edge density e(H)/v(H) equals the maximum\nedge density m(H). It was not until 20 years later that Bollob\u00e1s [9] solved the problem for all graphs,\n2\u2212\n\n1\n\nproving that for any H with m(H) \u2265 1, the threshold for H appearing in G(n, M ) is M \u2217 = n m(H) .\nFor further reading about the small subgraph problem in G(n, M ), we direct the interested reader to\nthe monographs by Bollob\u00e1s [8] and by Janson, Luczak, and Ruci\u0144ski [14], each of which contains an\nentire section discussing this problem.\nIn this paper, we consider the small subgraph problem in the context of Achlioptas processes,\nand investigate whether one can substantially affect thresholds by introducing this power of choice.\nActually, we study a natural generalization of the process, which we call an Achlioptas process with\nparameter r. In this process, r edges of Kn are presented at each round, and one of them is selected.\nWe will always consider r to be fixed as n tends to infinity (note that r = 2 corresponds to the original\nAchlioptas process).\nLet us now state our model precisely. At the i-th round, one is presented with r independent\n\u0001\nrandom edges, each distributed uniformly over all n2 \u2212 (i \u2212 1) remaining edges that have not yet been\nchosen for the graph. Note that this eliminates the possibility of choosing the same edge twice, so our\nfinal graph is simple. However, we do allow the possibility that edges may be offered more than once,\n\n2\n\n\fwhich simplifies our arguments. One may consider models in which all sampling is with replacement\n(which may create multigraphs), or in which every edge is offered at most once, but our results in this\npaper will still carry over because we always run the process for o(n2 ) rounds.\nNote that the graph after the k-th round of the Achlioptas process with parameter r is a subgraph\nof the random graph with rk edges. So, the question of accelerating the appearance of a fixed graph\nis immediately resolved in the negative. Clearly, the threshold cannot move forward by more than a\n(constant) factor of r.\nSo, in this paper we concentrate on the avoidance problem. We may pose it as a single player\ngame in which the player loses when he creates a (not necessarily induced) subgraph isomorphic to\na certain fixed graph H. The player's objective is to postpone losing for as long as possible. We say\nthat a function m\u2217 (n) is a threshold for avoiding H if: (i) given any function m(n) \u226a m\u2217 (n), there\nexists an online strategy by which the player survives through m rounds whp, and (ii) given any\nfunction m(n) \u226b m\u2217 (n), the player loses by the end of m rounds whp, regardless of the choice of such\na strategy.\nNote, however, that it is not obvious that thresholds necessarily exist. Furthermore, unlike the\nsituation in the small subgraph problem, there are no simple first-moment calculations that suggest\nwhat the thresholds should be. As it turned out, a substantial part of the difficulty in obtaining our\nresults was in conjecturing the correct thresholds. We were able to solve the problem for all cycles Ct ,\ncliques Kt , and complete bipartite graphs Kt,t . Let us now state our main result:\nTheorem 1.1.\n(i) For t \u2265 3, the threshold for avoiding Ct in the Achlioptas process with parameter r \u2265 2 is\n(t\u22122)r+2\n\nn\n\n2\u2212 (t\u22121)r+1\n\n.\n\n(ii) For t \u2265 4, the threshold for avoiding Kt in the Achlioptas process with parameter r \u2265 2 is n2\u2212\u03b8 ,\nwhere \u03b8 is defined as follows:\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\n\u03b8=\n\nr s (t \u2212 2) + 2\n\u0002 t\u0001\n\u0003\ns \u22121 .\nr s 2 \u2212 s + rr\u22121\n\n(iii) For t \u2265 3, the threshold for avoiding Kt,t in the Achlioptas process with parameter r \u2265 2 is n2\u2212\u03b8 ,\nwhere \u03b8 is defined as follows:\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\n\u03b8=\n\nr s (2t \u2212 2) + 2\ns \u22121 .\nr s (t2 \u2212 s) + rr\u22121\n\nRemark. In all of these cases, we provide deterministic online algorithms that achieve the thresholds\nwhp, but show that even randomized algorithms cannot survive beyond the thresholds.\nThe rest of this paper is organized as follows. In the next section, we present some tools from\nextremal combinatorics and the theory of random graphs, which we will use in our proofs. Then, we\npresent the proof of our theorem, which is divided into several sections. We begin in Section 3 with\nthe case of avoiding K4 when r = 2, which turns out to be the first nontrivial case. We treat this case\nin detail, because our argument there is the prototype for the general argument that we later use to\nprove thresholds for Kt , Kt,t , and Ct .\n3\n\n\fWe extend the argument to almost all other Kt and r in Section 4. The proof requires many\ninequalities whose somewhat tedious verifications would interfere with the exposition, so we postpone\ntheir proofs to the appendix. This also makes it easier to distill the abstract argument, which we\npresent in Section 5. Next, we apply the abstraction to prove thresholds for avoiding Ct in Section 6\nand Kt,t in Section 7. We treat the last remaining case of avoiding K4 in the Achlioptas process with\nparameter 3 in Section 8. The final section contains some concluding remarks and open problems.\n\n2\n2.1\n\nPreliminaries\nNotation and terminology\n\nThroughout our paper, we will omit floor and ceiling signs whenever they are not essential, to improve\nclarity of presentation. The following (standard) asymptotic notation will be utilized extensively. For\ntwo functions f (n) and g(n), we write f (n) = o(g(n)) or g(n) = \u03c9(f (n)) if limn\u2192\u221e f (n)/g(n) = 0,\nand f (n) = O(g(n)) or g(n) = \u03a9(f (n)) if there exists a constant M such that |f (n)| \u2264 M |g(n)| for\nall sufficiently large n. We also write f (n) = \u0398(g(n)) if both f (n) = O(g(n)) and f (n) = \u03a9(g(n)) are\nsatisfied.\nLet us introduce the following abbreviations for some phrases that we will use many times in\nour proof. As mentioned in the introduction, whp will stand for with high probability, i.e., with\nprobability 1 \u2212 o(1). It is also convenient for us to introduce the abbreviation wep, which stands\nc\u0001\nfor with exponential probability, i.e., with probability 1 \u2212 o e\u2212n for some c > 0. We will say that\na function f is a positive power of n if f = \u03a9(nc ) for some c > 0. Analogously, we will say that a\nfunction f is a negative power of n if f = O(n\u2212c ) for some c > 0.\nNext, let us discuss the graph-specific terms that we will use. We often need to consider the\ngraphs at intermediate stages of the Achlioptas process, so Gi will always denote the graph after the\ni-th round. Our main interest in Gi will be to count copies of subgraphs. Here, we define a copy of\na graph H in another graph G to be an injective map from V (H) to V (G) that preserves the edges\nof H. Note that copies are not necessarily induced subgraphs, and are labeled, i.e., we do not take\nautomorphisms into account when computing the number of copies of H in a graph.\nThe player's objective in the Achlioptas process is to avoid creating a copy of a certain fixed graph\nH, but our analysis needs to consider subgraphs of H as well. It is therefore convenient to introduce\nthe notation H \\ ke to represent any graph which can be obtained by deleting any k edges from H.\n(When k = 1, we will simply write H \\ e.) This enables us to concisely refer to all graphs of the\nform H \\ ke in the aggregate. For example, the phrase \"the number of copies of H \\ ke\" should be\nunderstood to be the total number of copies of all graphs of the form H \\ ke.\nWe keep track of the numbers of copies of these subgraphs by studying how counts are affected by\nthe addition of an edge at a pair of vertices. This motivates the following definition. Let G and H\nbe graphs, let k be an integer, and let a, b be a pair of distinct vertices of G. Let G+ be the graph\nobtained from G by adding the edge between a and b if it is not yet present, and let G\u2212 be the graph\nobtained by deleting that edge if it was present. Note that G is equal to either G+ or G\u2212 . Then, we\nsay that the pair {a, b} completes t copies of H \\ ke if t is the difference between the number of copies\nof H \\ ke in G+ and the number in G\u2212 .\nSometimes, we need to be specific about which graphs of the form H \\ (k + 1)e are completed into\n4\n\n\fgraphs of the form H \\ ke. Let H1 and H2 be graphs on the same vertex set U , with E(H1 ) \u2282 E(H2 ),\nbut differing only in exactly one edge. Let {u, v} \u2282 U be the endpoints of that edge. Let G be another\ngraph, and let a, b be a pair of distinct vertices of G. Then, we say that the pair {a, b} extends t copies\nof H1 into H2 if t is the number of injective graph homomorphisms \u03c6 : H1 \u2192 G that map {u, v} to\n{a, b}. Note that this definition is insensitive to the presence of an edge between a and b.\n\n2.2\n\nExtremal combinatorics\n\nIn this section, we present two extremal results, which are used in the proofs of the upper bounds in\nour thresholds (i.e., that no strategy can survive for too many rounds). The following lower bound on\nthe number of paths in a graph was obtained in [12] using a matrix inequality of Blackley and Roy.\nLemma 2.1. Every graph with n vertices and average degree d contains at least (1 + o(1))ndt\u22121 copies\nof the t-vertex path Pt . Here, we consider t to be fixed, while d and n tend to infinity.\nNext, we record the following well-known extremal result, which lower bounds the number of copies\nof the complete bipartite graph Ks,t that can appear in any graph with a fixed number of edges. The\nclassical proof (via two applications of convexity) is based on the ideas used by K\u00f6v\u00e1ri, S\u00f3s, and Tur\u00e1n\n[15] to bound the Tur\u00e1n number ex(n, Ks,t ).\nLemma 2.2. For fixed positive integers s \u2264 t, and any function p \u226b n\u22121/s , every graph with n vertices\n\u0001\nand n2 p edges contains at least (1 + o(1))ns+t pst copies of the complete bipartite graph Ks,t .\n\n2.3\n\nRandom graphs\n\nWe begin by recalling the Chernoff bound for exponential concentration of a binomial random variable.\nWe use the formulation from [1].\nTheorem 2.3. For any \u01eb > 0, there exists c\u01eb > 0 such that the following holds. Let X be any binomial\nrandom variable, and let \u03bc be its expectation. Then P [|X \u2212 \u03bc| > \u01eb\u03bc] < 2e\u2212c\u01eb \u03bc .\nUsing the Chernoff bound and a standard coupling argument, we prove a result that allows us to\nrelate Gm (the graph after the m-th round of the Achlioptas process) to the more familiar random\ngraph G(n, p).\nLemma 2.4. Suppose that n \u226a m \u226a n2 . Then we may couple the Achlioptas process with G(n, p =\n4rm/n2 ) in such a way that wep, Gm is a subgraph of G(n, p).\nProof. In the Achlioptas process, r random edges are presented at each round, independently and\nuniformly distributed over all potential edges that have not yet been picked for the graph. So, we\nmay couple the first m rounds of the process with the edge-uniform random graph G(n, rm) in such\na way that if we consider the graph G+\nm obtained by taking every edge that was offered (instead of\n+\nchoosing only one per round), Gm is always a subgraph of G(n, rm). Yet Gm is always a subgraph\n2\nof G+\nm , so it remains to relate G(n, rm) with G(n, p = 4rm/n ). This final part is standard and\nproceeds via coupling with the random graph process; under this coupling, G(n, rm) \u2282 G(n, p) as long\n\u0002 \u0001 \u0003\nas Bin n2 , p \u2265 rm, and the Chernoff bound shows that this event occurs wep.\n\u0003\n5\n\n\fOur analysis revolves around counting copies of fixed subgraphs in Gm . The previous lemma allows\nus to apply results from the theory of G(n, p) to assist us in this pursuit. We now record several such\ntheorems, translated in terms of Gm . The following definition is crucial for counting subgraphs in\nG(n, p).\nDefinition 2.5. A graph H is balanced if for any subgraph H \u2032 \u2286 H,\n\ne(H \u2032 )\nv(H \u2032 )\n\n\u2264\n\ne(H)\nv(H) .\n\nTheorem 2.6. Let H be a fixed balanced graph with v vertices and e edges. Suppose that n \u226a m \u226a n2 ,\nand let p = 2m/n2 . Also suppose that nv pe is a positive power of n. Then the number of copies of H\nin Gm is O(nv pe ) wep.\nProof. By Lemma 2.4, it suffices to count copies of H in G(n, 2rp). The expected number of copies\nis (1 + o(1))nv (2rp)e = \u0398(nv pe ), which is a positive power of n by assumption. This allows us to apply\nCorollary 6.3 of [17], which uses Kim-Vu polynomial concentration to prove the following result: for\nany balanced graph H such that the expected number of copies of H in the random graph is \u03bc \u226b log n,\nthe probability that the actual number of copies exceeds 2\u03bc is e\u2212\u03a9(\u03bc) . In our case, \u03bc is a positive power\nof n, so this implies that wep, the number of copies is O(nv pe ), as desired.\n\u0003\nThe previous result provides a very precise count of the number of copies of a fixed graph in the\nrandom graph G(n, p). However, the point of the Achlioptas process was to deviate from G(n, p) by\nintroducing the power of choice. So, our analysis will have to take the potential of choice into account.\nWe keep track of the numbers of copies of subgraphs by studying how counts are affected by the\naddition of an edge at a pair of vertices; this motivated the notions of a pair completing t copies of\nH \\ ke and of the pair extending t copies of H1 into H2 , which we defined at the end of Section 2.1.\nThis is essentially the problem of counting extensions, which has also been well-studied in G(n, p).\nWe refer the interested reader to Chapter 10 of [1]. As in the case of counting subgraphs in G(n, p),\na suitable definition of balanced-ness is required to count extensions.\nDefinition 2.7.\n(i) Let H1 and H2 be graphs on the same vertex set U , with E(H1 ) \u2282 E(H2 ), but differing only on the\nedge joining the vertices u, v \u2208 U . We say that the pair (H1 , H2 ) is a balanced extension pair\nif for every proper subset U \u2032 \u2282 U that still contains {u, v}, the induced subgraph H \u2032 = H1 [U \u2032 ]\ne(H \u2032 )\ne(H1 )\nhas the property that v(H\n\u2032 )\u22122 \u2264 v(H )\u22122 .\n1\n(ii) H \\ ke has the balanced extension property if every pair (H1 , H2 ) with V (H1 ) = V (H2 ) =\nV (H), E(H1 ) \u2282 E(H2 ) \u2282 E(H), e(H1 ) = e(H) \u2212 k, and e(H2 ) = e(H) \u2212 k + 1, is a balanced\nextension pair.\nTheorem 2.8. Suppose that n \u226a m \u226a n2 , and let p = 2m/n2 . Let (H1 , H2 ) be a balanced extension\npair, and let v and e be the numbers of vertices and edges in H1 , respectively. Finally, let j be an\narbitrary integer constant.\n(i) Suppose that nv\u22122 pe is a positive power of n. Then wep, every pair of distinct vertices {a, b} of\nGjm extends O(nv\u22122 pe ) copies of H1 into H2 .\n\n6\n\n\f(ii) Suppose that nv\u22122 pe is a negative power of n. Then, for any constant \u03b3 > 0, there exists a\nconstant C such that with probability 1 \u2212 o(n\u2212\u03b3 ), every pair of distinct vertices {a, b} of Gjm\nextends at most C copies of H1 into H2 .\nProof. By Lemma 2.4, it suffices to consider G(n, 2rjp) instead of Gjm in both parts of the theorem.\nFor part (i), the expected number of extensions at a pair in G(n, 2rjp) is (1 + o(1))nv\u22122 (2rjp)e =\n\u0398(nv\u22122 pe ), which is a positive power of n by assumption. This allows us to apply Corollary 6.7 of [17],\nwhich uses Kim-Vu polynomial concentration to prove the following result: for any balanced extension\npair (H1 , H2 ) such that the expected number \u03bc of copies of H1 that a fixed edge extends into H2 in the\nrandom graph is a positive power of n, the probability that the actual number of extensions exceeds\n2\u03bc is e\u2212\u03a9(\u03bc) . In our case, \u03bc is a positive power of n, so even after taking a union bound over all O(n2 )\npairs of vertices, this implies that wep, every pair of vertices extends O(nv\u22122 pe ) copies of H1 into H2 .\nThis establishes (i).\nFor part (ii), let us bound the probability that {a, b} extends C copies of H1 into H2 . Recall that\nH1 and H2 shared the same vertex set U , and differed only on the edge joining u, v \u2208 U . Consider\nany graph F which is formed by the superposition of C distinct copies of H1 , all with {u, v} mapping\nto the same pair of vertices {u\u2032 , v \u2032 } \u2208 V (F ). Let v \u2032 = v(F ) and e\u2032 = e(F ).\nThe probability that {a, b} has an extension to F (an injective map from V (F ) sending {u\u2032 , v \u2032 } 7\u2192\n\u2032\n\u2032\n\u2032\n\u2032\n\u2032\n{a, b}) in G(n, 2rjp) is at most nv \u22122 (2rjp)e = O((npe /(v \u22122) )v \u22122 ). An easy and standard induction,\n\u2032\ne\nusing the fact that (H1 , H2 ) is a balanced extension pair, implies that v\u2032e\u22122 \u2265 v\u22122\n. Hence this\nv \u2032 \u22122\n\n\u2032\n\nprobability is at most O((npe/(v\u22122) )v \u22122 ) = O((nv\u22122 pe ) v\u22122 ).\nWe assumed that nv\u22122 pe was a negative power of n. Also, since the C copies of H1 in F are\n1\ndistinct, one can trivially bound C \u2264 (v \u2032 \u2212 2)v\u22122 \u21d2 v \u2032 \u2212 2 \u2265 C v\u22122 . So, for a sufficiently large constant\nC, the probability that {a, b} has an extension to F is o(n\u2212\u03b3\u22122 ). Taking a union bound over all O(n2 )\npairs of vertices, we see that the probability that there exists any pair of vertices with an extension to\nF is o(n\u2212\u03b3 ). Since C is a constant, the number of non-isomorphic ways to form F (a superposition of\nC distinct copies of H1 , overlapping on one particular edge) is still a constant. Taking another union\nbound over all such F , we complete the proof.\n\u0003\nCorollary 2.9. Suppose that n \u226a m \u226a n2 , and let p = 2m/n2 . Let H \\ke have the balanced extension\nproperty, and let v and e be the numbers of vertices and edges in H \\ ke. Suppose that nv\u22122 pe is a\nnegative power of n. Let us consider Gjm , where j is an arbitrary integer constant. Then, for any\nconstant \u03b3 > 0, there exists a constant C such that with probability 1 \u2212 o(n\u2212\u03b3 ), every pair of distinct\nvertices {a, b} of Gjm completes at most C copies of H \\ (k \u2212 1)e.\nProof. Fix a pair {a, b}. When counting the number of copies of H \\ (k \u2212 1)e completed by that\npair, each copy arises from an extension pair (H1 , H2 ) and an extension of H1 to H2 at the pair. In\nfact, this correspondence is bijective. The balanced extension property guarantees that all such pairs\nare balanced. Since H is a fixed graph, only a constant number of non-isomorphic pairs (H1 , H2 ) can\narise in this way, so repeated application of Theorem 2.8(ii) completes the proof.\n\u0003\n\n7\n\n\f3\n\nWarm-up\n\nThe purpose of this section is to illustrate on a concrete example the main ideas and techniques that\nwe will use in our proofs. We investigate the first nontrivial case, which is the problem of avoiding K4\nin the Achlioptas process with parameter 2. This turns out to be the model for the general case.\nTheorem. The threshold for avoiding K4 in the Achlioptas process with parameter 2 is n28/19 .\nProof. Lower bound: We need to specify a strategy, and prove that it avoids K4 for many rounds.\nAt any intermediate stage in the process, consider a pair of points to be 2-dangerous if the addition\nof an edge between them will create a copy of K4 . Otherwise, if the addition of the edge will create\na copy of K4 \\ e, call the pair 1-dangerous. Every other pair is considered to be 0-dangerous (not\ndangerous). The strategy is then to make an arbitrary choice among the incoming edges that are\nminimally dangerous.\nLet m be a function of n that satisfies m \u226a n28/19 . It suffices to show that for any such m,\nthis strategy succeeds whp. We also may assume without loss of generality that m \u226b n28/19 / log n.\nThe precise form of the lower bound on m is not essential; it simplifies the argument by disposing of\nuninteresting pathological cases when m is too small. As it is easier to work with G(n, p), we will make\nall of our computations with respect to p, which we define to be 2m/n2 . Note that n\u221210/19 / log n \u226a\np \u226a n\u221210/19 . The following three claims analyze the performance of our strategy.\n(i) With probability 1 \u2212 o(n\u22124 ), Gm has O(n4 p4 ) copies of K4 \\ 2e and every pair of vertices completes\nO(1) copies of K4 \\ e.\n(ii) With probability 1 \u2212 o(n\u22122 ), Gm has O(n6 p9 ) copies of K4 \\ e.\n(iii) The probability of failure in m rounds is o(1).\nFor (i), it is easy to verify that K4 \\ 2e is a balanced graph, no matter which two edges are deleted.\nThen the number of copies of K4 \\ 2e is roughly what it should be in the random graph G(n, p)-this\nis made precise by Theorem 2.6, which bounds the number of copies of K4 \\ 2e in Gm by O(n4 p4 ) wep\nsince n4 p4 is a positive power of n. It is also easy to verify that K4 \\ 2e has the balanced extension\nproperty, so since n2 p4 is a negative power of n, Corollary 2.9 shows that there is some constant C\nsuch that with probability 1 \u2212 o(n\u22124 ), every pair of vertices in Gm completes at most C copies of\nK4 \\ e. This proves (i).\nFor (ii), fix some i < m and consider the (i + 1)-st round. In this round, the strategy will create\none or more copies of K4 \\ e only if both incoming edges span pairs that are 1- or 2-dangerous. The\nnumber of such pairs is at most O(1) times the number of copies of K4 \\ 2e. Since Gi \u2282 Gm , claim\n(i) shows that with probability 1 \u2212 o(n\u22124 ), Gi has O(n4 p4 ) copies of K4 \\ 2e and every pair of vertices\ncompletes O(1) copies of K4 \\ e. Call this event Ai , and condition on it. Even after conditioning, the\nincoming edges at the (i + 1)-st round are still independently and uniformly distributed over the \u03a9(n2 )\nunoccupied pairs of Gi , so the probability that we are forced to create a new copy of K4 \\e in this round\n4 4 \u00012 \u0001\nis O nnp2\n= O(n4 p8 ). Furthermore, each time this occurs, we only create O(1) new copies of K4 \\e\nbecause of our conditioning. Therefore, the number of new copies of K4 \\ e in the (i + 1)-st round\nis stochastically dominated by O(1) times the Bernoulli random variable with parameter O(n4 p8 ).\nP\nLetting i run through all m rounds, we see that with probability at least 1 \u2212 P [\u00acAi ] \u2265 1 \u2212 o(n\u22122 ),\n8\n\n\f\u0002\n\u0003\nthe number of copies of K4 \\e in Gm is O(1)*Bin m, O(n4 p8 ) . Since m = n2 p/2, the expectation of this\nbinomial is a positive power of n, so the Chernoff bound implies that wep, it is O(m *n4 p8 ) = O(n6 p9 ).\nThis proves (ii).\nFor (iii), fix some i and consider the probability that we lose in the (i + 1)-st round. The strategy\nfails precisely when both of the incoming edges span pairs that are 2-dangerous (completing K4 ), and\nthe number of such pairs is at most O(1) times the number of copies of K4 \\ e. Since Gi \u2282 Gm , claim\n(ii) shows that with probability 1 \u2212 o(n\u22122 ), Gi has O(n6 p9 ) copies of K4 \\ e. Call this event Bi , and\ncondition on it. Even after conditioning, the incoming edges are still independently and uniformly\ndistributed over the \u03a9(n2 ) unoccupied pairs of Gi , so the probability that both incoming edges are\n6 9 \u00012 \u0001\n2-dangerous is O nnp2\n= O(n8 p18 ). Therefore, letting i run through all m = n2 p/2 rounds, a\nunion bound shows that the probability that we are forced to complete a copy of K4 by the end of the\nP\nm-th round is P \u2264 O(n2 p * n8 p18 ) + P [\u00acBi ] = O(n10 p19 ) + o(1) = o(1).\nUpper bound: Now suppose that m \u226b n28/19 . It suffices to show that we will lose within the first 4m\nrounds whp. Again, we may assume without loss of generality that m \u226a n28/19 log n, and we will\nwork in terms of G(n, p) with p = 2m/n2 . Note that n\u221210/19 \u226a p \u226a n\u221210/19 log n. Let us specify a\nsequence of graphs such that each graph is obtained from the previous one by adding a single edge:\nlet H0 = P4 (4-vertex path), H1 = C4 (4-cycle), H2 = K4 \\ e, and H3 = K4 . It is easy to verify that\nthe corresponding pairs (H0 , H1 ), (H1 , H2 ), and (H2 , H3 ) are all balanced extension pairs. Our result\nfollows from the following four claims:\n(i) Gm always contains \u03a9(n4 p3 ) copies of H0 . Also, wep, every pair of vertices in G2m extends\nO(n2 p3 ) copies of H0 into H1 .\n(ii) G2m contains \u03a9(n4 p4 ) copies of H1 whp, and with probability 1 \u2212 o(n\u22122 ), every pair of vertices\nin G3m extends O(1) copies of H1 into H2 .\n(iii) G3m contains \u03a9(n6 p9 ) copies of H2 whp, and with probability 1 \u2212 o(n\u22122 ), every pair of vertices\nin G4m extends O(1) copies of H2 into H3 .\n(iv) The probability of survival through 4m rounds is o(1).\nProof of (i). Since the average degree in Gm is precisely 2m/n = np \u226b 1, from Lemma 2.1 we\nconclude that the number of 4-vertex paths is \u03a9(n(np)3 ). The second part of this claim follows from\nTheorem 2.8(i) since (H0 , H1 ) is a balanced extension pair and n2 p3 is a positive power of n.\n\u0003\nProof of (ii). The second part of (ii) follows from Theorem 2.8(ii) since (H1 , H2 ) is balanced and\nn2 p4 is a negative power of n. To prove the first part of (ii), consider the (i + 1)-st round, where\nm \u2264 i < 2m. Regardless of the choice of strategy, if both incoming edges span pairs that extend\n\u03a9(n2 p3 ) copies of H0 into H1 , we will be forced to create \u03a9(n2 p3 ) new copies of H1 .\nBy (i), the total number of copies of H0 in Gi \u2283 Gm is \u03a9(n4 p3 ). For a pair of vertices {a, b}, let\nna,b be the number of copies of H0 that {a, b} extends to H1 . Recall that this definition does not\ndepend on the presence of an edge between a and b. Since Gi \u2282 G2m , claim (i) shows that wep, in Gi\nevery na,b = O(n2 p3 ). Call this event Ai , and condition on it.\nLet us estimate the average value of na,b over all pairs. Since H0 differs from H1 at exactly one\nP\nedge, each copy of H0 has a pair at which it contributes +1 to the sum\nna,b . Therefore, averaging\n9\n\n\f\u0001\nover all n2 pairs of vertices, we obtain that the average number of copies of H0 that are extended to\nH1 at a pair is \u03a9(n2 p3 ). On the other hand, every pair of vertices in Gi extends O(n2 p3 ) copies of H0\ninto H1 . Therefore, at least a constant fraction \u03b3 (where \u03b3 = \u03a9(1) can be chosen to be the same for\n\u0001\nall i) of all n2 pairs have the property of extending \u03a9(n2 p3 ) copies of H0 into H1 . Let P be the set\nof all such pairs. Regardless of the choice of strategy, if both incoming edges span pairs in P , we will\nbe forced to create \u03a9(n2 p3 ) copies of H1 . Since i = o(n2 ) = o(|P |) and incoming edges are uniformly\n\u0001\n\u0001\ndistributed over the n2 \u2212 i = (1 \u2212 o(1)) n2 unoccupied pairs, we conclude that the probability that\nboth incoming edges span pairs in P is q \u2265 (1 + o(1))\u03b3 2 = \u03a9(1).\nP\nLet i run from m to 2m. Then, up to an error probability of at most\nP [\u00acAi ] = o(1), the number\nof copies of H1 in G2m is at least Bin(m, q) * \u03a9(n2 p3 ). By the Chernoff bound, the binomial factor\nexceeds mq/2 = \u03a9(n2 p) wep; thus, whp G2m has \u03a9(n2 p * n2 p3 ) = \u03a9(n4 p4 ) copies of H1 .\n\u0003\nProof of (iii). The second part of (iii) follows from Theorem 2.8(ii) since (H2 , H3 ) is balanced and\nn2 p5 is a negative power of n. For the first part of (iii), let us consider the (i + 1)-st round, with\n2m \u2264 i < 3m. Regardless of the choice of strategy, if both incoming edges span pairs that extend\ncopies of H1 into H2 , we will create a copy of H2 . Let P be the set of all such pairs. We need a lower\nbound on |P |. Condition on the event B that G2m contains \u03a9(n4 p4 ) copies of H1 , which occurs whp\nby (ii). Also by (ii), with probability 1 \u2212 o(n\u22122 ), every pair of vertices in Gi only extends O(1) copies\nof H1 into H2 , since Gi \u2282 G3m . Call this event Ci , and condition on it.\nNote that every copy of H1 contributes a pair to P which extends H1 into H2 , namely the pair at\nwhich it is missing an edge compared to H2 . On the other hand, every such pair was only counted\nO(1) times, since every pair in Gi extends O(1) copies of H1 into H2 . This implies that |P | = \u03a9(n4 p4 ).\nThe incoming edges are uniformly distributed over all unoccupied pairs. If at least half of the pairs\nin P were occupied, then we would have \u03a9(n4 p4 ) \u226b n6 p9 copies of H2 , which would already give the\nconclusion of (iii). Otherwise, the probability that both incoming edges span pairs in P (hence forcing\n4 4 \u00012 \u0001\n|/2 \u00012\nthe creation of a new copy of H2 ) is q \u2265 (1 + o(1)) |P\n= \u03a9(n4 p8 ).\n= \u03a9 nnp2\nn2 /2\nP\nLetting i run from 2m to 3m, we see that with error probability at most P [\u00acB] + P [\u00acCi ] = o(1),\neither we already obtained the conclusion of (iii), or the total number of copies of H2 is at least\nBin(m, q). The expectation of this binomial is (n2 p/2)q = \u03a9(n6 p9 ), which is a positive power of n.\nHence, by the Chernoff bound, G3m has \u03a9(n6 p9 ) copies of H2 whp.\n\u0003\nProof of (iv). Consider the (i+1)-st round, where 3m \u2264 i < 4m. Regardless of the choice of strategy,\nif both incoming edges span pairs that complete copies of H3 = K4 , we lose. We can lower bound\nthe number of such pairs by \u03a9(n6 p9 ) by conditioning on the following events. Let D be the event\nthat G3m contains \u03a9(n6 p9 ) copies of H2 , which occurs whp by (iii). Also by (iii), with probability\n1 \u2212 o(n\u22122 ), every pair of vertices in Gi extends O(1) copies of H2 into H3 ; call this event Ei .\nEven after conditioning, incoming edges in the (i + 1)-st round are independently and uniformly\n\u0001\ndistributed over the n2 \u2212 i = \u0398(n2 ) unoccupied pairs of Gi . Therefore, the probability that both\n6 9 \u00012 \u0001\npairs complete K4 , conditioned on survival through the i-th round, is pi = \u03a9 nnp2\n= \u03a9(n8 p18 ).\nLetting i run from 3m to 4m, we see that the probability that any strategy can survive for 4m rounds\nis at most\nn X o\nX\nY\nP \u2264 P [\u00acD] +\nP [\u00acEi ] + (1 \u2212 pi ) \u2264 o(1) + exp \u2212\npi\nn\no\n\u2264 o(1) + exp \u2212 \u03a9(n2 p * n8 p18 ) = o(1) + e\u2212\u03c9(1) = o(1),\n10\n\n\fwhich completes the proof.\n\n4\n\n\u0003\n\nAvoiding Kt , general case\n\nThe previous section proved the threshold for avoiding Kt in the Achlioptas process with parameter\nr, when t = 4 and r = 2. The case t = 3 will be covered in Section 6, which considers all cycles Ct . In\nthis section, we resolve all other cases, except for the special case (t, r) = (4, 3) which requires more\ndelicate analysis. We postpone this final case to Section 8.\nTheorem. For either t \u2265 5 and r \u2265 2, or t = 4 and r \u2265 4, the threshold for avoiding Kt in the\nAchlioptas process with parameter r \u2265 2 is n2\u2212\u03b8 , where \u03b8 is defined as follows:\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\n\u03b8=\n\nr s (t \u2212 2) + 2\n\u0001\n\u0001\ns \u22121 .\nr s 2t \u2212 s + rr\u22121\n\nBefore we begin the proof, let us prove an inequality that we will use in two claims in the lower\nbound, and the last claim of the upper bound.\nInequality 4.1. Let a > 2, b > 0, and r > 1, and let s be a positive integer. Define the sequences\n{xs , xs\u22121 , . . . , x0 } and {ys , ys\u22121 , . . . , y0 } as follows. Set xs = a and ys = b, and define the rest of the\nterms recursively by\nxk\u22121 = 2 + (xk \u2212 2)r,\nyk\u22121 = 1 + yk r.\nThen for any p \u226b n\u2212x0/y0 , nxk pyk is a positive power of n for every k \u2208 {s, . . . , 1}.\nProof. Fix any k \u2208 {s, . . . , 1}. One can easily solve the recursions for xk and yk to find:\nxk = r s\u2212k (a \u2212 2) + 2,\nTherefore,\n\nyk = r s\u2212k b +\n\nr s\u2212k \u2212 1\n.\nr\u22121\n\nr s\u2212k (a \u2212 2) + 2\nxk\nr s (a \u2212 2) + 2r k\n=\n=\n.\ns\u2212k\ns \u2212r k\nyk\nr s\u2212k b + r r\u22121\u22121\nr s b + r r\u22121\n\nBy the original definition via the recursions, xk and yk are\ndenominator of the final fraction above are positive. Yet as\nand the denominator increases. Therefore, xk /yk > x0 /y0 .\np \u226b n\u2212x0 /y0 , we conclude that nxk pyk is a positive power of n,\n\nboth positive, so the numerator and\nk decreases, the numerator decreases\nIn particular, since we assumed that\nas desired.\n\u0003\n\n\u0001\nNote that if we choose a = v(Kt ) = t and b = e(Kt ) \u2212 s = 2t \u2212 s, then the above recursions\nproduce x0 and y0 such that the fraction x0 /y0 is equal to our \u03b8. Let us now return to the proof of\nour thresholds for avoiding Kt .\nProof of Theorem. Lower bound: The strategy is a natural extension of the one used to avoid\nK4 . At any intermediate stage in the process, for any 1 \u2264 d \u2264 s, consider a pair of points to be\nd-dangerous if d is the maximal integer such that the addition of an edge between them will create a\ncopy of Kt \\ (s \u2212 d)e. If there is no such d, consider the pair to be 0-dangerous. The strategy is then\nto make an arbitrary choice among the incoming edges that are minimally dangerous.\n11\n\n\fLet m \u226a n2\u2212\u03b8 , and let p = 2m/n2 . Again, we assume without loss of generality that m \u226b\nn2\u2212\u03b8 / log n. Note that n\u2212\u03b8 / log n \u226a p \u226a n\u2212\u03b8 . We will analyze the performance of our strategy by\nproving three successive claims:\n\u0001\nt\n(i) With probability 1 \u2212 o(n\u22122s ), Gm has O nt p(2)\u2212s copies of Kt \\ se, and every pair of vertices\ncompletes O(1) copies of Kt \\ (s \u2212 1)e.\nx y \u0001r\n(ii) For each k \u2208 {s, s \u2212 1, . . . , 2}, and constants x and y such that (n2 p) nn2p\nis a positive power\nof n, statement (a) implies statement (b), which are defined as follows:\n(a) With probability 1 \u2212 o(n\u22122k ), Gm has O(nx py ) copies of Kt \\ ke, and every pair of vertices\ncompletes O(1) copies of Kt \\ (k \u2212 1)e.\nx y \u0001r \u0001\ncopies of Kt \\ (k \u2212 1)e, and every\n(b) With probability 1 \u2212 o(n\u22122(k\u22121) ), Gm has O (n2 p) nnp2\npair of vertices completes O(1) copies of Kt \\ (k \u2212 2)e.\n(iii) The probability of failure in m rounds is o(1).\nAgain, we separate the proofs of the claims for clarity. At several points, we require certain inequalities\nwhose rather tedious proofs would interfere with the exposition. The appendix contains the precise\nformulations and proofs of these statements.\nProof of (i). Lemma A.3 verifies that Kt \\ se is a balanced graph, and the k = s case of Inequality\nt\n4.1 shows that nt p(2)\u2212s is a positive power of n, so Theorem 2.6 implies that the number of copies of\n\u0001\nt\nKt \\ se in Gm is O nt p(2)\u2212s wep. For the second part of claim (i), Lemma A.4 verifies that Kt \\ se\nt\nhas the balanced extension property, and Inequality A.8 shows that nt\u22122 p(2)\u2212s is a negative power of\nn. So, Corollary 2.9 shows that there is some constant C such that with probability 1 \u2212 o(n\u22122s ), every\npair of vertices in Gm completes at most C copies of Kt \\ (s \u2212 1)e. This finishes claim (i).\n\u0003\n\nProof of (ii). Fix k, x, and y as specified, and let us show that (a) implies (b). First, since every\ngraph of the form Kt \\ (k \u2212 2)e always contains some graph of the form Kt \\ (k \u2212 1)e, (a) immediately\nimplies that with probability 1 \u2212 o(n\u22122k ), every pair of vertices completes O(1) copies of Kt \\ (k \u2212 2)e;\nthis implies the second part of (b).\nIt remains to show the first part of (b). Fix some i < m and consider the (i + 1)-st round. In this\nround, the strategy will create one or more copies of Kt \\ (k \u2212 1)e only if all r incoming edges span\npairs that are at least (s \u2212 k + 1)-dangerous (i.e., create copies of Kt \\ (k \u2212 1)e). The number of such\npairs is at most O(1) times the number of copies Kt \\ ke. Since Gi \u2282 Gm , statement (a) implies that\nwith probability 1 \u2212 o(n\u22122k ), Gi has O(nx py ) copies of Kt \\ ke and every pair of vertices completes\nO(1) copies of Kt \\ (k \u2212 1)e. Call this event Ai , and condition on it. Even after conditioning, incoming\nedges are still independently and uniformly distributed over the \u03a9(n2 ) unoccupied pairs of Gi , so the\nx y \u0001r \u0001\nprobability that some new copies of Kt \\ (k \u2212 1)e are created in this round is O nnp2\n. Also, by our\nconditioning, the number of newly created copies of Kt \\ (k \u2212 1)e is still O(1) even when this occurs.\nTherefore, the number of new copies of Kt \\ (k \u2212 1)e in the (i + 1)-st round is stochastically dominated\nx y \u0001r \u0001\nby O(1) times the Bernoulli random variable with parameter O nn2p\n. Letting i run through all m\nP\n\u22122(k\u22121)\nrounds, we see that with probability at least 1 \u2212 P [\u00acAi ] \u2265 1 \u2212 o(n\n), the number of copies of\n\u0002\nx y \u0001r \u0001\n2\nnx py \u0001r \u0001\u0003\n. Since this binomial has expectation n2 p * O nnp2\n,\nKt \\ (k \u2212 1)e in Gm is O(1) * Bin m, O n2\n12\n\n\fwhich is a positive power of n by the assumption on x and y, a Chernoff bound implies that it is\nx y \u0001r \u0001\nwep. This finishes (ii).\n\u0003\nO (n2 p) nnp2\n\nProof of (iii). The idea is to apply claim (i), and then to repeatedly apply claim (ii) until we obtain\na high-probability upper bound on the number of copies of Kt \\ e. Then, we complete the proof with\nessentially the same argument as in claim (iii) of the proof of the lower bound for avoiding K4 .\nTo keep track of the exponents of n and p in the successive upper bounds, define the sequences\n{xs , xs\u22121 , . . . , x0 } and {ys , ys\u22121 , . . . , y0 } as in Inequality 4.1, which then verifies that nxk pyk is a positive\npower of n for every k \u2208 {s \u2212 1, . . . , 1}. Hence we can apply claims (i) and (ii) until we conclude that\nwith probability 1 \u2212 o(n\u22122 ), Gm has O(nx1 py1 ) copies of Kt \\ e.\nNow fix some i and consider the probability that we lose in the (i + 1)-st round. The strategy\nfails precisely when all r of the incoming edges span pairs that are s-dangerous (completing Kt ),\nand the number of such pairs is at most O(1) times the number of copies of Kt \\ e. Yet since\nGi \u2282 Gm , the previous paragraph shows that with probability 1 \u2212 o(n\u22122 ), Gi has O(nx1 py1 ) copies\nof Kt \\ e. Call this event Bi , and condition on it. Even after conditioning, incoming edges are still\nindependently and uniformly distributed over the \u03a9(n2 ) unoccupied pairs of Gi , so the probability\nx1 y 1 \u0001r \u0001\nthat all incoming edges complete Kt is O n n2p\n. Therefore, letting i run through all m = n2 p/2\nrounds, a union bound shows that the probability that we are forced to complete a copy of Kt is\nP\nx1 y 1 \u0001r \u0001\nP \u2264 O (n2 p) n n2p\n+ P [\u00acBi ] = O(nx0 py0 ) + o(1). This in turn is o(1) because we assumed that\np \u226a n\u2212\u03b8 with \u03b8 = x0 /y0 . This completes the proof.\n\u0003\nUpper bound: Let m \u226b n2\u2212\u03b8 , and let p = 2m/n2 . We will show that whp, any strategy fails within\n\u0398(m) rounds, which we again break into periods of length m. We may assume that m \u226a n2\u2212\u03b8 log n\nwithout loss of generality. Note that n\u2212\u03b8 \u226a p \u226a n\u2212\u03b8 log n.\nAs in the proof of the upper bound for avoiding K4 , we will specify a sequence of graphs such that\neach graph is obtained from the previous one by adding a single edge. Let H1 = K\u230a t \u230b,\u2308 t \u2309 (the largest\n2\n2\nbipartite subgraph of Kt ), and arbitrarily choose the rest of the sequence {H2 , H3 , . . . , Hf }, where\n\u0001\nHf = Kt , by adding one missing edge at a time. So, f = 1 + 2t \u2212 \u230a 2t \u230b\u2308 2t \u2309, which is a constant because\nwe assumed t to be fixed. Our result follows from the following five claims:\n(i) Gm contains \u03a9(nt pe(H1 ) ) copies of H1 whp.\n(ii) Let k be a positive integer for which nt\u22122 pe(Hk\u22121 ) is a positive power of n. Then Gkm contains\n\u03a9(nt pe(Hk ) ) copies of Hk whp.\n(iii) G(f \u2212s)m contains \u03a9(nt pe(Hf \u2212s ) ) copies of Hf \u2212s whp. Also, nt\u22122 pe(Hf \u2212s ) is a negative power of\nn; hence with probability 1 \u2212 o(n\u22122 ), every pair of vertices in G(f \u2212s+1)m extends O(1) copies of\nHf \u2212s into Hf \u2212s+1 .\nx y \u0001r\n(iv) For each k \u2208 {s, s \u2212 1, . . . , 2}, and constants x and y such that nx py \u226a n2 and (n2 p) nnp2\nis a\npositive power of n, statement (a) implies statement (b), which are defined as follows:\n(a) G(f \u2212k)m contains \u03a9(nx py ) copies of Hf \u2212k whp, and with probability 1 \u2212 o(n\u22122 ), every pair\nof vertices in G(f \u2212k+1)m extends O(1) copies of Hf \u2212k into Hf \u2212k+1 .\nx y \u0001r \u0001\n(b) G(f \u2212k+1)m contains \u03a9 (n2 p) nn2p\ncopies of Hf \u2212k+1 whp, and with probability 1\u2212o(n\u22122 ),\nevery pair of vertices in G(f \u2212k+2)m extends O(1) copies of Hf \u2212k+1 into Hf \u2212k+2 .\n13\n\n\f(v) The probability of survival through f m = \u0398(m) rounds is o(1).\nProof of (i). We will actually prove that Gm contains \u03a9(nt pe(H1 ) ) copies of H1 with certainty, not\njust whp. However, the rest of the claims only require a whp result in claim (i), so we keep it there\nfor the purpose of generality.\n\u0004 \u0005\u22121\n, Lemma 2.2 implies\nSince we assumed that p \u226b n\u2212\u03b8 and Inequality A.6 bounds \u2212\u03b8 \u2265 \u2212 2t\nthat the number of copies of the complete bipartite graph H1 = K\u230a t \u230b,\u2308 t \u2309 in any m-edge graph is\n2\n\n\u03a9(nt pe(H1 ) ).\n\n2\n\n\u0003\n\nProof of (ii). We proceed inductively. The base case of the induction follows from claim (i). Now,\nsuppose k satisfies the property that nt\u22122 pe(Hk\u22121 ) is a positive power of n, and G(k\u22121)m contains\n\u03a9(nt pe(Hk\u22121 ) ) copies of Hk\u22121 whp. We will show that Gkm contains \u03a9(nt pe(Hk ) ) copies of Hk whp.\nLet us begin by conditioning on the high-probability event A from our inductive assumption: that\nG(k\u22121)m contains \u03a9(nt pe(Hk\u22121 ) ) copies of Hk\u22121 . Now consider the (i + 1)-st round, where (k \u2212 1)m \u2264\ni < km. Since Gi \u2283 G(k\u22121)m , the total number of copies of Hk\u22121 in Gi is \u03a9(nt pe(Hk\u22121 ) ) by our\nconditioning.\nLemma A.5 verifies that (Hk\u22121 , Hk ) is a balanced extension pair, and we assumed that nt\u22122 pe(Hk\u22121 )\nwas a positive power of n, so Theorem 2.8(i) establishes that wep, every pair of vertices in Gkm extends\nO(nt\u22122 pe(Hk\u22121 ) ) copies of Hk\u22121 into Hk . Since Gi \u2282 Gkm , the same bound holds for Gi wep; call that\nevent Bi , and condition on it.\nFor a pair of vertices {a, b}, let na,b be the number of copies of Hk\u22121 that the pair {a, b} extends\ninto Hk . Recall that this definition does not depend on the presence of an edge between a and b. Let\nus estimate the average value of na,b over all pairs. Since Hk\u22121 differs from Hk at exactly one edge,\nP\neach copy of Hk\u22121 has a pair at which it contributes +1 to the sum\nna,b . Therefore, averaging over\n\u0001\nall n2 pairs of vertices, we obtain that the average number of copies of Hk\u22121 that are extended to Hk\nat a pair is \u03a9(nt\u22122 pe(Hk\u22121 ) ).\nOn the other hand, every pair of vertices in Gi extends O(nt\u22122 pe(Hk\u22121 ) ) copies of Hk\u22121 into Hk .\n\u0001\nTherefore, at least a constant fraction \u03b3 = \u03a9(1) of all n2 pairs have the property of extending\n\u03a9(nt\u22122 pe(Hk\u22121 ) ) copies of Hk\u22121 into Hk . Let P be the set of all such pairs. Regardless of the choice\nof strategy, if all r incoming edges span pairs in P , we will be forced to create \u03a9(nt\u22122 pe(Hk\u22121 ) ) copies\n\u0001\nof Hk . Since i = o(n2 ) = o(|P |) and incoming edges are uniformly distributed over the n2 \u2212 i =\n\u0001\n(1 + o(1)) n2 unoccupied pairs, we conclude that the probability that all incoming edges span pairs in\nP is q \u2265 (1 + o(1))\u03b3 r = \u03a9(1).\nP\nLet i run from (k \u2212 1)m to km. Then, up to an error probability of at most P [\u00acA] + P [\u00acBi ] =\no(1), the number of copies of Hk in Gkm is at least Bin(m, q) * \u03a9(nt\u22122 pe(Hk\u22121 ) ). By the Chernoff\nbound, the binomial factor exceeds mq/2 = \u03a9(n2 p) wep; thus, whp Gkm has \u03a9(n2 p * nt\u22122 pe(Hk\u22121 ) ) =\n\u03a9(nt pe(Hk ) ) copies of Hk .\n\u0003\nProof of (iii). The first part follows directly from claim (ii), because Inequality A.7 verifies that\nnt\u22122 pe(H(f \u2212s)\u22121 ) is a positive power of n. For the second part, (Hf \u2212s , Hf \u2212s+1 ) is a balanced extension\npair by Lemma A.5, and nt\u22122 pe(Hf \u2212s ) is a negative power of n by Inequality A.8. Therefore, Theorem\n2.8(ii) shows that there is some constant C such that with probability 1 \u2212 o(n\u22122 ), every pair of vertices\nin G(f \u2212s+1)m extends at most C copies of Hf \u2212s into Hf \u2212s+1 . This finishes claim (iii).\n\u0003\nProof of (iv). Fix k, x, and y as specified in the statement, and assume statement (a). Let us\n14\n\n\fbegin by establishing the second part of (b). Lemma A.5 verifies that (Hf \u2212k+1 , Hf \u2212k+2 ) is a balanced\nextension pair, and Inequality A.8 shows that nt\u22122 pe(Hf \u2212k+1 ) is a negative power of n for k \u2264 s.\nTherefore, Theorem 2.8(ii) shows that there is some constant C such that with probability 1 \u2212 o(n\u22122 ),\nevery pair of vertices in G(f \u2212k+2)m extends at most C copies of Hf \u2212k+1 into Hf \u2212k+2 . This finishes\nthe second part of (b).\nIt remains to prove the first part of (b). Consider the (i + 1)-st round, with (f \u2212 k)m \u2264 i <\n(f \u2212 k + 1)m. Regardless of the choice of strategy, if all r incoming edges span pairs that extend copies\nof Hf \u2212k into Hf \u2212k+1 , we will create a copy of Hf \u2212k+1 . Let P be the set of all such pairs. We need a\nlower bound on |P |.\nCondition on the high-probability event C of (a) that G(f \u2212k)m contains \u03a9(nx py ) copies of Hf \u2212k .\nSince Gi \u2282 G(f \u2212k+1)m , (a) implies that with probability 1\u2212o(n\u22122 ), every pair of vertices in Gi extends\nO(1) copies of Hf \u2212k into Hf \u2212k+1 . Call this event Di , and condition on it.\nNote that every copy of Hf \u2212k contributes a pair to P which extends Hf \u2212k into Hf \u2212k+1 , namely\nthe pair at which it is missing an edge compared to Hf \u2212k+1 . On the other hand, every such pair\nwas counted at most a constant number of times, since every pair in Gi extends O(1) copies of Hf \u2212k\ninto Hf \u2212k+1 . This implies that |P | = \u03a9(nx py ). The incoming edges are uniformly distributed over all\nunoccupied pairs. If at least half of the pairs in P were occupied, then we would have \u03a9(nx py ) copies\nof Hf \u2212k+1 . Yet this would already give us the conclusion of (b) since:\n\u0010 n x py \u0011\n\u0010 nx py \u0011r\n2\nnx py \u226b (n2 p)\n\u226b\n(n\np)\n.\nn2\nn2\n\n(The first inequality is because p \u226a 1, and the second inequality follows from the assumption that\nnx py \u226a n2 .) Otherwise, if less than half of the pairs in P are occupied, then the probability that\nall incoming edges span pairs in P (hence forcing the creation of a copy of Hf \u2212k+1 ) is q \u2265 (1 +\nx y \u0001r \u0001\n|/2 \u0001r\n= \u03a9 nn2p\n.\no(1)) |P\nn2 /2\nLetting i run from (f \u2212 k)m to (f \u2212 k + 1)m, we see that with error probability at most P [\u00acC] +\nP\nP [\u00acDi ] = o(1), either we already obtained the conclusion of (b), or the total number of copies of\n2 \u0001\nx y \u0001r \u0001\n, which is\nHf \u2212k+1 is at least Bin(m, q). The expectation of the binomial is n2p q = \u03a9 (n2 p) nnp2\nx y \u0001r \u0001\n2\na positive power of n by assumption. Hence, by the Chernoff bound, G(f \u2212k+1)m has \u03a9 (n p) nnp2\ncopies of Hf \u2212k+1 whp.\n\u0003\nProof of (v). The result of claim (iii) plugs in directly to claim (iv), which we may iterate until it\ngives us a a lower bound on the number of copies of Hf \u22121 = Kt \\ e and an upper bound on the number\nof copies of Hf \u22121 that any pair extends into Hf = Kt .\nTo keep track of exponents in the successive lower bounds, define the sequences {xs , xs\u22121 , . . . , x0 }\nand {ys , ys\u22121 , . . . , y0 } exactly as in Inequality 4.1. To verify that we can indeed iterate claim (iv), we\nmust show that for all k \u2208 {s, s \u2212 1, . . . , 2}, we have that nxk pyk \u226a n2 , and nxk\u22121 pyk\u22121 is a positive\npower of n. The first statement follows from an easy induction: claim (iii) establishes it for k = s, and\nxk y k\nxk y k \u0001r\nif nxk pyk \u226a n2 , then n n2p \u226a 1, so combined with p \u226a 1, we see that nxk\u22121 pyk\u22121 = (n2 p) n n2p\n\u226a\nn2 . The second statement is verified by Inequality 4.1. Therefore, we arrive at the result that G(f \u22121)m\ncontains \u03a9(nx1 py1 ) copies of Hf \u22121 = Kt \\ e whp. Call this event E, and condition on it. We also\nfind that with probability 1 \u2212 o(n\u22122 ), every pair of vertices in Gf m extends O(1) copies of Hf \u22121 into\nHf (i.e., completes O(1) copies of Kt ). The same probability bound also holds in Gi for any i \u2264 f m,\nbecause Gi \u2282 Gf m ; let Fi be the corresponding event.\n15\n\n\fNow consider the (i + 1)-st round, where (f \u2212 1)m \u2264 i < f m. Regardless of the choice of strategy,\nif all r incoming edges span pairs that complete copies of Kt , we will lose. We can bound the number\nof such pairs by \u03a9(nx1 py1 ) by conditioning on the above events E and Fi . Even after conditioning,\n\u0001\nthe incoming edges in this round still independent and uniformly distributed over the n2 \u2212 i = \u0398(n2 )\nunoccupied pairs of Gi . Therefore, the probability that all r pairs complete Kt , conditioned on survival\nx1 y 1 \u0001 r \u0001\nthrough the i-th round, is pi = \u03a9 n n2p\n. Letting i run from (f \u2212 1)m to f m, we see that the\nprobability that any strategy can survive for f m rounds is at most\nn X o\nX\nY\nP \u2264 P [\u00acE] +\nP [\u00acFi ] +\n(1 \u2212 pi ) \u2264 o(1) + exp \u2212\npi\nn\n\u0010\n\u0010 nx1 py1 \u0011r \u0011o\n= o(1) + exp{\u2212\u03a9(nx0 py0 )}.\n\u2264 o(1) + exp \u2212 \u03a9 (n2 p)\nn2\nThis in turn is o(1) because we assumed that p \u226b n\u2212\u03b8 with \u03b8 = x0 /y0 . This completes the proof. \u0003\n\n5\n\nAbstraction into general argument\n\nNote that we structured our exposition of the previous section in the following manner. The arguments\ndid not directly use properties of the specific graph that we were avoiding (Kt ). Rather, they were\nlinked to lemmas and inequalities that proved certain properties (e.g., balanced-ness, etc.) about Kt .\nLet us now isolate these necessary \"ingredients\" that one can plug in to our general machinery to\nprove thresholds.\nFor the rest of this section, let H be the fixed graph which we wish to avoid. Our arguments\nallow one to prove the threshold for avoiding H in the Achlioptas process with parameter r simply\nby specifying several parameters, and then proving some lemmas and inequalities that do not need to\nrefer to the Achlioptas process at all. We first describe the parameters.\n\u2022 s: this was the number of levels of danger considered by the avoidance strategy in the proof of\nthe lower bound. At any intermediate stage in the process, for any 1 \u2264 d \u2264 s, we considered a\npair of points to be d-dangerous if d was the maximal integer such that the addition of an edge\nbetween them created a copy of H \\ (s \u2212 d)e. If there was no such d, we considered the pair to be\n0-dangerous. Recall that the strategy was then to make an arbitrary choice among the incoming\nedges that were minimally dangerous.\n\u2022 A sequence of graphs {H1 , . . . , Hf } sharing the same vertex set, with each successive graph\ncontaining exactly one more edge: this was used in the upper bound argument to iteratively\nprove lower bounds on the number of copies of Hi , proceeding from i = 1 to i = f .\nThe correct choice of s then determined \u03b8, the negative exponent in the threshold (in terms of p) for\navoidance:\nr s (v(H) \u2212 2) + 2\n\u03b8= s\ns \u22121 .\nr (e(H) \u2212 s) + rr\u22121\nAssuming that the parameters were suitably chosen, one then only needed to establish the following\nlemmas and inequalities in order to prove that the threshold for avoiding H in the Achlioptas process\nwith parameter r is n2\u2212\u03b8 .\nFor proof of lower bound. Here, n\u2212\u03b8 / log n \u226a p \u226a n\u2212\u03b8 .\n16\n\n\f1. H\\se is a balanced graph. This allowed us to prove in claim (i) that wep, Gm has O(nv(H) pe(H)\u2212s )\ncopies of H \\ se. For H = Kt , this was provided by Lemma A.3.\n2. H \\ se has the balanced extension property, and nv(H)\u22122 pe(H)\u2212s is a negative power of n. This\nallowed us to prove in claim (i) that with probability 1 \u2212 o(n\u22122s ), every pair of vertices in Gm\ncompletes O(1) copies of H \\ (s \u2212 1)e. For H = Kt , these were provided by Lemma A.4 and\nInequality A.8.\nFor proof of upper bound. Here, n\u2212\u03b8 \u226a p \u226a n\u2212\u03b8 log n.\n1. Gm contains \u03a9(nv(H1 ) pe(H1 ) ) copies of H1 whp. This was claim (i), and for H = Kt , it was\nprovided by the extremal estimate on the number of Ks,t (Lemma 2.2), along with Inequality\nA.6, which assured that p was large enough to apply the extremal result.\n2. Each consecutive pair (Hk , Hk+1 ) is a balanced extension pair. This was used throughout the\nproof of the upper bound, and for H = Kt , it was provided by Lemma A.5.\n3. nv(H)\u22122 pe(H)\u2212s\u22121 is a positive power of n. This was used in claim (iii) to show that we\ncould iterate the argument of claim (ii) enough times to conclude that G(f \u2212s)m contained\n\u03a9(nv(Hf \u2212s ) pe(Hf \u2212s ) ) copies of Hf \u2212s whp. For H = Kt , this was provided by Inequality A.7.\n4. nv(H)\u22122 pe(H)\u2212s is a negative power of n. This was used in claim (iii) to transition to the next\ninductive process, which relied on the copies of Hf \u2212s not being too concentrated on any pair of\nvertices. Note: this statement was already required above for the lower bound, so we do not\nneed to check it again.\n\n6\n\nAvoiding cycles\n\nNow we show by example how to use our machinery to prove avoidance thresholds. We start with an\neasy application which completely solves the problem for cycles Ct . In light of the previous section, we\nonly need to provide the required parameters, lemmas, and inequalities. We will specify these in the\nsame order that they were presented in the previous section. This will prove the following theorem.\nTheorem. For t \u2265 3, the threshold for avoiding Ct in the Achlioptas process with parameter r \u2265 2 is\nr(t\u22122)+2\n\nn\n\n2\u2212 r(t\u22121)+1\n\n.\n\nProof. We use the parameter s = 1, and the sequence of graphs H1 = Ct \\ e, H2 = Ct . This gives the\ns\nr(t\u22122)+2\nthreshold n2\u2212\u03b8 , where \u03b8 = sr (v(Ct )\u22122)+2\nr s \u22121 = r(t\u22121)+1 , which matches the claimed result. Now we need\nr (e(Ct )\u2212s)+\n\nr\u22121\n\nto provide the required lemmas and inequalities. For the reader's convenience, we have reproduced\nthe italicized statements from Section 5.\nFor proof of lower bound. Here, n\u2212\u03b8 / log n \u226a p \u226a n\u2212\u03b8 .\n1. Ct \\ e is a balanced graph. This is obvious.\n2. Ct \\ e has the balanced extension property, and nv(Ct )\u22122 pe(Ct )\u22121 = nt\u22122 pt\u22121 is a negative power\nof n. The first part is obvious. For the second, since p \u226a n\n17\n\nr(t\u22122)+2\n\u2212 r(t\u22121)+1\n\n, we must establish that\n\n\fr(t\u22122)+2\nt\n(t \u2212 2) \u2212 (t \u2212 1) r(t\u22121)+1\n< 0. Routine algebra shows that the left hand side equals \u2212 r(t\u22121)+1\n,\nwhich is certainly negative when t \u2265 3, r \u2265 2.\n\nFor proof of upper bound. Here, n\u2212\u03b8 \u226a p \u226a n\u2212\u03b8 log n.\n1. Gm contains \u03a9(nv(H1 ) pe(H1 ) ) copies of H1 whp. The average degree of Gm is precisely np by the\ndefinition of p = 2m/n2 . We show in item #3 below that np is a positive power of n, so it tends\nto infinity with n. Thus, we may apply Lemma 2.1, an extremal result counting the number of\npaths, to conclude that Gm contains at least (1 + o(1))n(np)t\u22121 copies of the t-vertex path H1 ,\nas desired.\n2. (H1 , H2 ) is a balanced extension pair. This is easy to see.\n3. nv(Ct )\u22122 pe(Ct )\u22121\u22121 = (np)t\u22122 is a positive power of n. It suffices to show that np is a positive\n\u2212 r(t\u22122)+2\n\nr(t\u22122)+2\n> 0. Routine algebra\npower of n. Since p \u226b n r(t\u22121)+1 , this amounts to proving that 1\u2212 r(t\u22121)+1\nr\u22121\nshows that the left hand side equals r(t\u22121)+1 , which is certainly positive when t \u2265 3, r \u2265 2.\n\nAs we have provided all of the necessary ingredients to apply our machinery, we are done.\n\n7\n\n\u0003\n\nAvoiding Kt,t\n\nNow we show a more complex application of our machinery, which completely solves the problem for\nKt,t . This will prove the following theorem.\nTheorem. Suppose that t \u2265 3 and r \u2265 2 are fixed integers. The threshold for avoiding Kt,t in the\nAchlioptas process with parameter r is n2\u2212\u03b8 , where \u03b8 is defined as follows:\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\n7.1\n\n\u03b8=\n\nr s (2t \u2212 2) + 2\ns \u22121 .\nr s (t2 \u2212 s) + rr\u22121\n\nParameters\n\nThe value of s is already specified in the statement of the theorem, so we proceed to give the sequence\nof graphs {H1 , . . . , Hf }. The sequences are quite different depending on the parity of t, so we describe\nthem separately.\nCase 1: t is even. Let H1 be the 4-partite graph with parts V1 , V2 , V3 , V4 , each of size t/2, and edges\nsuch that (V1 , V2 ), (V1 , V4 ), and (V3 , V2 ) are complete bipartite graphs. Let {H2 , . . . , H1+(t/2) } be\nobtained by successively adding single edges until H1+(t/2) has a perfect matching between V3 and\nV4 . Then, arbitrarily choose the rest of the sequence {H2+(t/2) , . . . , Hf } by adding one edge at a\ntime, until the final term is the complete bipartite graph Kt,t with bipartition (V1 \u222a V3 , V2 \u222a V4 ).\nNote that f = 1 + t2 /4.\nCase 2: t is odd. Let H1 be a 6-partite graph with parts {Vi }61 such that V3 and V4 are singletons,\nand the other four parts each have size \u230at/2\u230b. The edges are as follows: the two pairs (V1 , V2 )\nand (V5 , V6 ) are each complete bipartite graphs, the vertex in V3 is adjacent to all of V2 \u222a V4 \u222a V6 ,\nand the vertex in V4 is adjacent to all of V1 \u222a V3 \u222a V5 . There are no more edges.\n18\n\n\fLet {H2 , . . . , H1+\u230at/2\u230b } be obtained by successively adding single edges until H1+\u230at/2\u230b has a\nperfect matching between V1 and V6 . To create the next \u230at/2\u230b graphs in the sequence, we put\ndown a matching between V5 and V2 , one edge at a time. Finally, arbitrarily choose the rest of the\nsequence {H2+2\u230at/2\u230b , . . . , Hf } by adding one edge at a time, until the final term is the complete\nbipartite graph Kt,t with bipartition (V1 \u222a V3 \u222a V5 , V2 \u222a V4 \u222a V6 ). Note that f = 1 + 2\u230at/2\u230b2 .\n\n7.2\n\nLemmas and inequalities\n\nNext, we provide the required lemmas and inequalities. For the reader's convenience, we have reproduced the italicized statements from Section 5.\nFor proof of lower bound. Here, n\u2212\u03b8 / log n \u226a p \u226a n\u2212\u03b8 .\n1. Kt,t \\ se is a balanced graph. This is now provided by Lemma B.1. Actually, the graph is not\nbalanced when t = 3 and r = 2, but in that particular case, Lemma B.1 additionally proves that\nthe number of copies of Kt,t \\ se in Gm is still O(nv(H) pe(H)\u2212s ) wep, which is all we really need.\n2. Kt,t \\ se has the balanced extension property, and nv(Kt,t )\u22122 pe(Kt,t )\u2212s is a negative power of n.\nThese are now provided by Lemma B.2 and Inequality B.8.\nFor proof of upper bound. Here, n\u2212\u03b8 \u226a p \u226a n\u2212\u03b8 log n.\n1. Gm contains \u03a9(nv(H1 ) pe(H1 ) ) copies of H1 whp. This time, we use Inequality B.6 to show that\n\u2212\u03b8 > \u22122/t. Since we assume that p \u226b n\u2212\u03b8 for the upper bound argument, this provides the\ncondition required to apply either Lemma 7.1 if t is even, or Lemma 7.2 if t is odd. Both lemmas\n(presented below) lead to the required final statement.\n2. Each consecutive pair (Hk , Hk+1 ) is a balanced extension pair. This is now provided by Lemma\nB.4 if t is even, and by Lemma B.5 if t is odd.\n3. nv(Kt,t )\u22122 pe(Kt,t )\u2212s\u22121 is a positive power of n. This is provided by Inequality B.7.\n\n7.3\n\nProofs of supporting lemmas\n\nWe conclude this section by proving the two lemmas that provide the first component of the proof of\nthe upper bound. We start with the lemma that is used when t is even.\nLemma 7.1. For any fixed positive integers k and l, consider the following 4-partite graph, which we\ncall H. Let the parts be V1 , V2 , V3 , V4 , with |V1 | = |V2 | = k and |V3 | = |V4 | = l, and place edges such\nthat (V1 , V2 ), (V1 , V4 ), and (V2 , V3 ) are complete bipartite graphs. There are no more edges. Then,\n\u0001\nthere exists a constant ck such that for any p \u226b n\u22121/k , every graph with n vertices and n2 p edges\n2\ncontains at least (ck + o(1))n2k+2l pk +2kl copies of H.\n\u0001\nProof. Let us fix an ambient graph G with n vertices and n2 p edges. By Lemma 2.2, the number\n2\nof copies of Kk,k in G is at least (1 + o(1))n2k pk . Recall that the k-codegree of a set U of k distinct\nvertices is the number of vertices that are adjacent to all of U . Let us say that a copy of Kk,k is\ndeficient if either of the sides of its bipartition has k-codegree less than 12 npk in G. We claim that at\nmost 12 + o(1) of the copies of Kk,k are deficient.\n19\n\n\fTo see this, note that if an ordered k-tuple of distinct vertices has k-codegree less than 12 npk , then\n\u0001k\nit can extend to at most 21 npk copies of Kk,k . The number of such k-tuples is at most nk ; therefore,\n\u0001k\n2\nthe number of deficient copies of Kk,k is at most nk 12 npk \u2264 21 n2k pk , as claimed.\nYet each non-deficient copy of Kk,k extends to at least\n\u00121 k\n\u0013 \u00121 k\n\u0013\n2 np \u2212 2k l! * 2 np \u2212 2k \u2212 l l!\nl\nl\ncopies of H. This is because we may consider the copy of Kk,k to be V1 \u222a V2 , we choose V3 from the\ncommon neighborhood of V2 excluding the 2k vertices in V1 \u222a V2 , and finally we choose V4 from the\ncommon neighborhood of V1 excluding the 2k + l vertices in V1 \u222a V2 \u222a V3 . Since we assumed that\np \u226b n\u22121/k , the binomial coefficients are asymptotically monomials of degree l, so we conclude that\neach non-deficient copy of Kk,k extends to \u03a9((npk )l * (npk )l ) = \u03a9(n2l p2kl ) copies of H. Since there are\n\u0001\n2\nalways at least 12 + o(1) n2k pk non-deficient copies of Kk,k , we conclude that the number of copies\n2\nof H is always \u03a9(n2k+2l pk +2kl ), as claimed.\n\u0003\nUsing Lemma 7.1 as a building block, we now prove the lemma that provides the first component\nof the upper bound when t is odd. Actually, we prove a result for G2m instead of Gm , but this does\nnot matter for the purpose of the general argument.\nLemma 7.2. Let k be a positive integer. Let H be a 6-partite graph with parts {Vi }61 such that V3\nand V4 are singletons, and the other four parts each have size k. Let the edges of H be as follows: the\ntwo pairs (V1 , V2 ) and (V5 , V6 ) are each complete bipartite graphs, the vertex in V3 is adjacent to all of\nV2 \u222a V4 \u222a V6 , and the vertex in V4 is adjacent to all of V1 \u222a V3 \u222a V5 . There are no more edges.\nConsider G2m , the graph after the 2m-th round of the Achlioptas process with parameter r \u2265 2.\nLet p = 2m/n2 , and suppose that p \u226b n\u2212\u03b8 with \u2212\u03b8 > \u22121/(k + 12 ). Then G2m contains \u03a9(nv(H) pe(H) )\ncopies of H whp.\nProof. Let H1 be the subgraph of H induced by V1 \u222a V2 \u222a V3 \u222a V4 , and let H0 be the subgraph of\nH1 with the edge between V3 and V4 deleted. Observe that we can find a copy of H in a graph by\nfirst looking for a pair of vertices for the site of the edge between V3 and V4 , and then looking for two\ndisjoint copies of H0 that are extended into H1 by that pair.\nConsider the (i + 1)-st turn, for some m \u2264 i < 2m. By Lemma 7.1, Gm (and hence Gi \u2283 Gm )\n2\nalways contains \u03a9(n2k+2 pk +2k ) copies of H0 . Lemma B.3 verifies that (H0 , H1 ) is a balanced extension\n2\npair, and n2k pk +2k is a positive power of n because we assumed that p \u226b n\u2212\u03b8 with \u2212\u03b8 > \u22121/(k + 12 )\nand k \u2265 1. Thus, Theorem 2.8(i) establishes that wep, every pair of vertices in Gi \u2282 G2m extends\n2\nO(n2k pk +2k ) copies of H0 into H1 . Call this event Ai , and condition on it.\nFor a pair of vertices {a, b}, let na,b be the number of copies of H0 that the pair {a, b} extends into\nH1 . Recall that this definition does not depend on the presence of an edge between a and b. Let us\nestimate the average value of na,b over all pairs. Since H0 differs from H1 at exactly one edge, each\n\u0001\nP\ncopy of H0 has a pair at which it contributes +1 to the sum\nna,b . Therefore, averaging over all n2\npairs of vertices, we obtain that the average number of copies of H0 that are extended to H1 at any\n2\npair is \u03a9(n2k+2 pk +2k ).\n2\nOn the other hand, by our conditioning, every pair of vertices in Gi extends O(n2k pk +2k ) copies\n\u0001\nof H0 into H1 . Therefore, at least a constant fraction \u03b3 = \u03a9(1) of all n2 pairs have the property of\n20\n\n\f2\n\nextending \u03a9(n2k pk +2k ) copies of H0 into H1 . Let P be the set of all such pairs. Regardless of the\nchoice of strategy, if all r incoming edges span pairs in P , we will be forced to choose a pair in P .\n\u00012 \u0001\n2\n2\nThis will create \u03a9 n2k pk +2k\n= \u03a9(n4k p2k +4k ) pairs of copies of H0 that are extended to H1 by\nthe chosen pair. Such a pair of copies of H0 would become a new copy of H after the edge is added,\nif the pair of copies were disjoint. If the pair of copies of H0 is not disjoint, then let us say that they\ncreate a degenerate copy of H. For now, let us count degenerate copies of H along with the true copies\nof H. Later, we will show that the degenerate copies are vastly outnumbered by true copies of H.\n\u0001\nSince i = o(n2 ) = o(|P |) and incoming edges are uniformly distributed over the n2 \u2212 i = (1 +\n\u0001\no(1)) n2 unoccupied pairs, we conclude that the probability that all incoming edges span pairs in P\nis q \u2265 (1 + o(1))\u03b3 r = \u03a9(1). Let i run from m to 2m. Then wep, the number of (possibly degenerate)\n2\ncopies of H in G2m is at least Bin(m, q) * \u03a9(n4k p2k +4k ). By the Chernoff bound, the binomial factor\n2\nexceeds mq/2 = \u03a9(n2 p) wep, so we conclude that G2m has \u03a9(n2 p * n4k p2k +4k ) = \u03a9(nv(H) pe(H) )\n(possibly degenerate) copies of H whp.\nTo finish the proof of this lemma, we must show that the number of degenerate copies of H in G2m\nis o(nv(H) pe(H) ) whp. For convenience, we will work with G(n, p) instead of G2m because Lemma\n2.4 shows that we may couple G2m with G(n, 4rp), and the constant 4r disappears under the \"o(*)\"\nnotation. Note that the underlying graph of a degenerate copy of H is a superposition of two copies\nof Kk+1,k+1 , overlapping on at least 3 vertices. So, let us consider any such superposition, and call\nthe underlying graph F . Let v \u2032 = v(F ) and e\u2032 = e(F ). The copies overlap on at least 3 vertices, so\n\u2032\ne(H)\nv \u2032 < v(H). It is easy to check that since Kk+1,k+1 is a balanced graph, ve\u2032 \u2265 v(H)\n. So, the expected\nnumber of copies of F in G(n, p) is:\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\nE \u2264 nv pe = (npe /v )v \u2264 (npe(H)/v(H) )v = (nv(H) pe(H) )v /v(H) .\n1\n\nNow, we assumed that p \u226b n\u22121/(k+ 2 ) , so nv(H) pe(H) \u226b 1 because v(H) = 4k + 2 and e(H) = 2k2 +\n4k + 1. Furthermore, v \u2032 < v(H), so Markov's inequality implies that whp, G(n, p) has o(nv(H) pe(H) )\ncopies of F . Since each copy of F can account for at most a constant number (depending only on k)\nof degenerate copies of H, and there is only a constant number of non-isomorphic superpositions F ,\nwe conclude that whp, G(n, p) has o(nv(H) pe(H) ) degenerate copies of H. This completes the proof of\nthe lemma.\n\u0003\n\n8\n\nAvoiding K4 in the Achlioptas process with parameter 3\n\nTo apply the machinery of Section 5, one needs to prove that certain quantities are positive or negative\npowers of n. In our study of avoiding cycles, cliques, and complete bipartite graphs, the only case in\nwhich we encounter a key exponent that is not separated from zero is when we are avoiding K4 in the\nAchlioptas process with parameter 3.\nHowever, the separation of the exponent from zero was merely a convenience which allowed us to\nbound maxima of families of random variables (e.g., the maximum codegree in a graph) whp. When\nwe do not have this condition, we may instead bound the entire distribution of the family.\nLemma 8.1. Let n\u22121/2 \u226a p \u226a n\u22121/2 log n. Then G(n, p) satisfies the following property whp: all\ncodegrees are at most np2 log n, and for every integer 4 \u2264 k \u2264 log n, the number of pairs with codegree\nat least knp2 is at most n2 /k3 .\n21\n\n\fThis result, which we prove at the end of this section, allows us to prove our final threshold.\nTheorem. The threshold for avoiding K4 in the Achlioptas process with parameter 3 is n3/2 .\nProof. Lower bound: A shortsighted strategy works in this instance: arbitrarily select any one of\nthe incoming edges that does not create a copy of K4 . Let m \u226a n3/2 , and let p = 2m/n2 . Again, we\nassume without loss of generality that m \u226b n3/2 / log n. Note that n\u22121/2 / log n \u226a p \u226a n\u22121/2 . We will\nanalyze the performance of our strategy by proving two successive claims:\n(i) Gm has O(n4 p5 ) copies of K4 \\ e wep.\n(ii) The probability of failure in m rounds is o(1).\nThe interested reader may check that if we followed the recipe for avoiding Kt in Section 4, we\nwould start by counting copies of K4 \\ 2e instead of K4 \\ e. This is essentially the only change in the\nlower bound argument, but we provide the details below for completeness.\nFor (i), K4 \\ e is balanced and n4 p5 is a positive power of n, so Theorem 2.6 implies that the\nnumber of copies of K4 \\ e in Gm is O(n4 p5 ) wep.\nFor (ii), consider the probability that the strategy fails at the (i + 1)-st round for some i < m, i.e.,\nthat all 3 incoming edges span pairs that complete copies of K4 . The number of such pairs is upper\nbounded by the number of copies of K4 \\ e. Since Gi \u2282 Gm , claim (i) implies that Gi has O(n4 p5 )\ncopies of K4 \\ e wep. Call this event Ai , and condition on it. Then, the chance that all 3 incoming\n4 5 \u00013 \u0001\n= O(n6 p15 ). Letting i run through all m = n2 p/2 rounds, a union\nedges complete K4 is O nnp2\nbound shows that the probability that we are forced to complete a copy of K4 by the m-th round is\nP\nP \u2264 O(n2 p * n6 p15 ) + P [\u00acAi ] = O(n8 p16 ) + o(1) = o(1), as desired.\n\nUpper bound: Let m \u226b n3/2 , and let p = 2m/n2 . We will show that whp, any strategy fails within\n3m rounds, which we break into periods of length m. Again, we may assume that m \u226a n3/2 log n\nwithout loss of generality. Note that n\u22121/2 \u226a p \u226a n\u22121/2 log n. Our result follows from the following\nthree claims:\n(i) Gm contains \u03a9(n2 ) pairs of vertices with codegree at least 2 whp.\n(ii) G2m contains \u03a9(n2 p) copies of K4 \\ e whp, and with probability 1 \u2212 o(n\u22122 ), every pair of vertices\nin G3m extends O(1) copies of K4 \\ e into K4\n(iii) The probability of survival through 3m rounds is o(1).\n\nProof of (i). In the random graph, the expected codegree is roughly np2 \u226b 2, but since we do not\nknow how far p exceeds n\u22121/2 , we need a slightly more careful argument. Let S be the sum of the\nP\ncodegrees {u,v} d(u, v) over all unordered pairs {u, v}, and let us decompose S = S1 + S2 + S3 , where\nS1 is the contribution from summands with d(u, v) \u2208 {0, 1}, S2 is the contribution from summands\nwith 2 \u2264 d(u, v) \u2264 4np2 , and S3 is the remainder. We aim to show that S2 = \u03a9(n3 p2 ), which will\nimply the result.\n\u0001\nP\nBy double-counting, S = v d(v)\n2 , where d(v) is the degree of vertex v. By convexity, this is always\n\u0001\nat least n d2 , where d is the average degree. Since Gm has exactly m edges, d = 2m/n = np \u226b 1.\nTherefore, S \u2265 (0.5 + o(1))n(np)2 .\n22\n\n\fOn the other hand, Lemma 8.1 shows that whp, Gm has the property that all codegrees are at\nmost np2 log n, and for every integer 4 \u2264 k \u2264 log n, the number of pairs with codegree at least knp2\nis at most n2 /k3 . Conditioning on this, we may then bound S3 , the sum of codegrees which exceed\n4np2 , by:\nS3 \u2264\n\nlog\nXn\n\n(k + 1)np2 *\n\nk=4\nlog\nXn\n\nn2\nk3\n\nn 3 p2\nk2\nk=4\n\u0013\n\u0012 2\n1\n1\n1\n\u03c0\n3 2 5\n\u2264 n p *\n\u2212 2\u2212 2\u2212 2\n4 6\n1\n2\n3\n\u2264\n\n5\n4\n\n\u2264 0.4n3 p2 .\n\n\u0001\nAlso, S1 , the sum of codegrees which are in {0, 1}, is trivially at most n2 \u226a n3 p2 since we assumed\np \u226b n\u22121/2 . So, S2 , the sum of codegrees between 2 and 4np2 , is at least S2 = S \u2212 S1 \u2212 S3 \u2265 0.05n3 p2 .\nTherefore, whp the number of pairs with codegree at least 2 is at least 0.05n3 p2 /(4np2 ) = \u03a9(n2 ), as\nclaimed.\n\u0003\nProof of (ii). The second part follows from Theorem 2.8(ii) because (K4 \\ e, K4 ) is a balanced\nextension pair and n2 p5 is a negative power of n. Let us now concentrate on the first part. Conditioning\non the high probability event in claim (i), we may now assume that in Gm , the proportion of pairs with\ncodegree at least 2 is some \u03b3 = \u03a9(1). Consider the (i + 1)-st round, where m \u2264 i < 2m. Regardless\nof the choice of strategy, if all three incoming edges span pairs that each have codegree at least 2,\nthen we will be forced to create a new copy of K4 \\ e. Incoming edges are uniformly distributed over\nunoccupied pairs, and the number of occupied pairs in Gi is exactly i = o(n2 ). So, since Gi \u2283 Gm , the\nprobability that all three incoming edges span pairs with codegree at least 2 is q \u2265 (1+o(1))\u03b3 3 = \u03a9(1).\nLet i run from m to 2m. Then, the number of copies of K4 \\ e in G2m is at least Bin(m, q). By\nthe Chernoff bound, this exceeds mq/2 = \u03a9(n2 p) wep, so we are done.\n\u0003\nProof of (iii). Consider the (i + 1)-st round, where 2m \u2264 i < 3m. Regardless of the choice of\nstrategy, if all three incoming edges span pairs that complete copies of K4 , we will lose. We can lower\nbound the number of such pairs by \u03a9(n2 p) by conditioning on the following events. Let A be the event\nthat G2m contains \u03a9(n2 p) copies of K4 \\ e, which occurs whp by (ii). Also by (ii), with probability\n1 \u2212 o(n\u22122 ), every pair of vertices in Gi \u2282 G3m extends O(1) copies of K4 \\ e into K4 ; call this event\nBi .\nEven after conditioning, the incoming edges in this round are still independently and uniformly\n\u0001\ndistributed over the n2 \u2212 i = \u0398(n2 ) unoccupied pairs of Gi . Therefore, the probability that both pairs\n2 \u00013 \u0001\ncomplete K4 , conditioned on survival through the i-th round, is pi = \u03a9 nn2p\n= \u03a9(p3 ). Letting i\nrun from 2m to 3m, we see that the probability that any strategy can survive for 3m rounds is at\nmost\nn X o\nX\nY\nP \u2264 P [\u00acA] +\nP [\u00acBi ] +\n(1 \u2212 pi ) \u2264 o(1) + exp \u2212\npi\nn\no\n\u2264 o(1) + exp \u2212 \u03a9(n2 p * p3 ) = o(1) + e\u2212\u03c9(1) = o(1),\n23\n\n\fwhich completes the proof.\n\n\u0003\n\nIt remains to establish Lemma 8.1, which we used to control the distribution of codegrees in claim\n(i) of the upper bound.\nProof of Lemma 8.1. Each codegree is distributed as Bin(n \u2212 2, p2 ), so a union bound shows that\nthe probability that some codegree exceeds np2 log n is at most\n\u0012\n\u0013np2 log n\n\u0013\n\u0012\nn\nenp2\n2\n2 np2 log n\n2\n= o(1).\nP\u2264n *\n(p )\n\u2264n *\nnp2 log n\nnp2 log n\nNext, fix any 4 \u2264 k \u2264 log n, and let X be the number of pairs with codegree at least knp2 . Consider\nan arbitrary vertex v, and let Xv be the number of vertices u 6= v such that the codegree of {v, u} is\nP\nat least knp2 . Note that X = 12 Xv .\nSince d(v) is binomially distributed Bin[n \u2212 1, p] and np is a positive power of n, the degree d(v)\nis at most 1.1np wep by Chernoff. Condition on this, and condition further on a neighborhood N (v)\nof size d(v). For each w 6\u2208 N (v) \u222a {v}, define the indicator random variable Iw to be 1 if and only if\nthe codegree of {v, w} is at least knp2 , or equivalently, if w has at least knp2 neighbors in N (v). Note\nthat because we already fixed N (v), these Iw are independent since they are determined by disjoint\nsets of edges. Yet k \u2265 4 and np2 \u226b 1, so each Iw has probability\n\u0012\n\u0012\n\u0013\n\u0013knp2 \u0012 \u0013knp2\n1.1np knp2\n1.1enp2\n3\n1\nq = P [Iw ] \u2264\n\u2264\np\n\u2264\n\u226a 3.\n2\n2\nknp\nknp\nk\nk\nTherefore, Xv is stochastically dominated by d(v) + Bin[n \u2212 1 \u2212 d(v), q]. Since k \u2264 log n, a Chernoff\nP\nbound implies that wep, Xv \u2264 1.1np + 2nq = o(n/k3 ), which gives X = 12\nXv = o(n2 /k3 ). The\nresult follows by taking a union bound over all v and 4 \u2264 k \u2264 log n.\n\u0003\n\n9\n\nConcluding remarks\n\u2022 Although our theorems treat specific graphs (cycles, cliques, and complete bipartite graphs), we\nconjecture that the thresholds for avoiding general graphs H follow from the natural generalization of the recipe that we used.\nTo apply our machinery from Section 5, the first thing that we needed to specify was the\nparameter s. This was the number of levels of danger considered by the avoidance strategy in\nthe proof of the lower bound. The correct choice of s then determined \u03b8, the negative exponent\nin the threshold (in terms of p) for avoidance:\n\u03b8(H, r, s) =\n\nr s (v(H) \u2212 2) + 2\ns \u22121 .\nr s (e(H) \u2212 s) + rr\u22121\n\nFurthermore, it is clear that the threshold for avoiding any fixed subgraph H \u2032 \u2282 H is a lower\nbound for the threshold for avoiding H itself. This is because any strategy that avoids H \u2032 will\ncertainly avoid H as well.\nIn light of this, we conjecture that the threshold for avoiding H in the Achlioptas process\n\u2217\nwith parameter r is n2\u2212\u03b8 , where \u03b8 \u2217 is the minimum value of \u03b8(H \u2032 , r, s) when s runs over all\nnonnegative integers and H \u2032 runs over all subgraphs of H.\n24\n\n\f\u2022 Just as in the case of analyzing the Achlioptas process for giant component avoidance [6], one\ncan also consider the offline version of the fixed subgraph avoidance problem. In this offline\nversion, all random r-tuples of edges arriving during the process are accessible to an algorithm,\nand it can make its choices at each round, relying on the perfect knowledge of the past and\nthe future. The question is still how long the algorithm can typically avoid the appearance of a\ncopy of a fixed graph H. We expect that in most of the cases there will be a sizable difference\nbetween the online and the offline thresholds. Here is a sketch of the illustrative case of H = K3 ,\nr = 2. For this case we can prove that if m = o(n4/3 ), then one can whp avoid a copy of K3\nduring the first m rounds in the offline version. This should be compared to the threshold of\nm = n6/5 for the online version, given by Theorem 1.1. The argument proceeds as follows. Set\np = 2m/n2 . The offline model in this case can be approximated quite accurately by generating\na random graph G according to the distribution G(n, 2m), and then splitting the edges of G\nrandomly into m pairs: (e1 , f1 ), . . . , (em , fm ). Denote the above random matching of E(G) by\n\u03c0. We use the following strategy, while processing the pairs (ei , fi ): in each pair (ei , fi ) choose\nan arbitrary edge not participating in any triangle in G, otherwise pick an arbitrary edge. It is\nobvious that using this strategy we can only lose (i.e. create a triangle) if G contains a triangle\nwith edges x1 , x2 , x3 such that their respective pairings in \u03c0 also belong to triangles in G. The\nnumber of triangles in G is whp of order n3 p3 , and therefore the probability of having a triangle\nwhose three edges are paired in \u03c0 with edges from triangles is at most of order\n\u0012 3 3 \u00133\n3 3 n p\nn p\n= n6 p9 = o(1).\nn2 p\nIt would be very interesting to obtain tight results for the offline small subgraph avoidance\nversion of the Achlioptas process for a wide variety of graphs H and parameter r.\n\u2022 The appearances of the giant component and of a fixed graph are just two instances that have\nbeen addressed so far in the context of the Achlioptas process. Naturally, one can consider other\ngraph theoretic properties as well in this context. We hope to return to questions of this type\nin the future.\nAcknowledgment. The authors would like to thank the referee for suggestions that improved the\nexposition of this paper.\n\nReferences\n[1] N. Alon and J. Spencer, The Probabilistic Method, 2nd ed., Wiley, New York, 2000.\n[2] A. Beveridge, T. Bohman, A. Frieze, and O. Pikhurko, Product rule wins a competitive game,\nProceedings of the American Mathematical Society 135 (2007), 3061\u20133071.\n[3] A. Beveridge, T. Bohman, A. Frieze, and O. Pikhurko, Memoryless rules for Achlioptas processes,\nSIAM Journal on Discrete Mathematics, to appear.\n[4] T. Bohman and A. Frieze, Avoiding a giant component, Random Structures and Algorithms 19\n(2001), 75\u201385.\n25\n\n\f[5] T. Bohman, A. Frieze, and N. Wormald, Avoidance of a giant component in half the edge set of\na random graph, Random Structures and Algorithms 25 (2004), 432\u2013449.\n[6] T. Bohman, J. Kim, A phase transition for avoiding a giant component, Random Structures and\nAlgorithms 28 (2006), 195\u2013214.\n[7] T. Bohman and D. Kravitz, Creating a giant component, Combinatorics, Probability and Computing 15 (2006), 489\u2013511.\n[8] B. Bollob\u00e1s, Random graphs, 2nd ed., Cambridge Studies in Advanced Mathematics, 73. Cambridge University Press, Cambridge, 2001.\n[9] B. Bollob\u00e1s, Random graphs, in: Combinatorics, Proceedings Swansea 1981, London Math. Soc.\nLecture Note Ser. 52, Cambridge Univ. Press, Cambridge, 1981, 80\u2013102.\n[10] B. Bollob\u00e1s and A. Thomason, Threshold functions, Combinatorica 7 (1987), 35\u201338.\n[11] P. Erd\u0151s and A. R\u00e9nyi, On the evolution of random graphs, Publ. Math. Inst. Hungar. Acad. Sci.\n5 (1960), 17\u201361.\n[12] P. Erd\u0151s and M. Simonovits, Compactness results in extremal graph theory, Combinatorica 2\n(1982), 275\u2013288.\n[13] A. Flaxman, D. Garmanik, and G. Sorkin, Embracing the giant component, Random Structures\nand Algorithms 27 (2005), 277\u2013289.\n[14] S. Janson, T. Luczak, and A. Ruci\u0144ski, Random graphs, Wiley, New York, 2000.\n[15] T. K\u00f6v\u00e1ri, V. S\u00f3s, and P. Tur\u00e1n, On a problem of K. Zarankiewicz, Colloquium Math. 3 (1954),\n50\u201357.\n[16] J. Spencer and N. Wormald, Birth control for giants, Combinatorica 27 (2007), 587\u2013628.\n[17] V. Vu, Concentration of non-Lipschitz functions and applications, Random Structures and Algorithms 20 (2002), 262\u2013316.\n\nA\n\nSupporting results for avoiding Kt\n\nIn this section, we collect the supporting lemmas and inequalities that are used to prove thresholds for\navoiding Kt . We will make claims about properties of simple single-variable functions without proof,\nas they can be verified by routine analytical methods.\nThroughout the appendix, we will set s = \u230alogr [(r \u2212 1)t + 1]\u230b. We begin by proving some basic\nfacts about s.\nLemma A.1. For fixed t \u2265 3, the parameter s is decreasing in r in the range r \u2265 2.\n\n26\n\n\fProof. Let t be fixed, and consider the function f (r) = log[(r\u22121)t+1]\n. It suffices to show that\nlog r\nCalculation yields:\nt\n\u2212 log[(r \u2212 1)t + 1] 1r\n(log r) (r\u22121)t+1\n\u2202f\n=\n\u2202r\nlog2 r\n\n\u2202f\n\u2202r\n\n< 0.\n\nWe will show that the numerator is negative. Since t \u2265 3 and r \u2265 2, (r \u2212 1)t + 1 \u2265 3r \u2212 2 \u2265 2r, so the\nnumerator is less than\n1\n1\n\u2212 (log 2r)\nr\u0012\u2212 1\n\u0013 r\n1\n1\n1\n\u2212\n\u2212 (log 2)\n= (log r)\nr\u22121 r\nr\n\u0012\n\u0013\nlog r\n1\n=\n\u2212 log 2\n.\nr\u22121\nr\n\nnumerator < (log r)\n\nr\nNow log\nr\u22121 is a decreasing function of r when r \u2265 2, so it is at most log 2; therefore, the entire expression\nis always negative, and f is indeed decreasing in r.\n\u0003\n\nLemma A.2. If t \u2265 4 and r \u2265 2, then s \u2264 t/2. Furthermore, if t \u2265 5 and r \u2265 2, or if t = 4 and\nr \u2265 4, then s < t/2.\nProof. By Lemma A.1, if r \u2265 2, then s \u2264 \u230alog2 (t + 1)\u230b, and one may verify that this is in turn \u2264 t/2\nfor all t \u2265 4, and < t/2 for t \u2265 5. For the other range, when r \u2265 4, Lemma A.1 gives s \u2264 \u230alog4 (3t+1)\u230b,\nwhich is less than t/2 at t = 4. This finishes the lemma.\n\u0003\n\nA.1\n\nBalanced graphs and extensions\n\nLemma A.3. For any t \u2265 4 and r \u2265 2, Kt \\ se is a balanced graph.\nProof. We must show that the edge density (number of edges divided by number of vertices) of\nKt \\ se is at least as large as the edge density of any of its proper induced subgraphs. The edge density\n\u0002 \u0001\n\u0003\nof Kt \\ se is exactly 2t \u2212 s /t. Lemma A.2 established that s \u2264 t/2, so the edge density is at least\n\u0002 t\u0001 t \u0003\nt\u22121\u0001\n2 /(t \u2212 1). Yet the final quantity is precisely the edge density of Kt\u22121 , which is an\n2 \u2212 2 /t =\nupper bound on the edge density of any proper induced subgraph of any t-vertex graph, so we are\ndone.\n\u0003\nLemma A.4. For any t \u2265 4 and r \u2265 2, Kt \\ se has the balanced extension property.\nProof. Fix any graph G of the form Kt \\ se, and let u, v be any two nonadjacent vertices of G. We\nmust show that the function e(H)/(v(H) \u2212 2) is maximal at H = G, where H is allowed to range over\nall induced subgraphs of G that contain {u, v}. For any graph H with n vertices that is missing at\n\u0002 \u0001\n\u0003\nleast one edge (e.g., the edge between {u, v}), e(H)/(v(H) \u2212 2) \u2264 n2 \u2212 1 /(n \u2212 2) = (n + 1)/2. For\nany proper induced subgraph H \u2282 G, we then have e(H)/(v(H) \u2212 2) \u2264 t/2.\n\u0002 \u0001\n\u0003\nYet e(G)/(v(G) \u2212 2) = 2t \u2212 s /(t \u2212 2), and Lemma A.2 established that s \u2264 t/2. Using this\n\u0002 \u0001\n\u0003\nbound for s, we see that e(G)/(v(G) \u2212 2) \u2265 2t \u2212 2t /(t \u2212 2) = t/2, which matches our upper bound\nfor e(H)/(v(H) \u2212 2), so we are done.\n\u0003\n\n27\n\n\fLemma A.5. Suppose that t \u2265 4. Let H1 = K\u230a t \u230b,\u2308 t \u2309 , and arbitrarily choose the rest of the se2\n2\nquence {H2 , H3 , . . . , Hf }, where Hf = Kt , by adding one edge at a time. Then every consecutive pair\n(Hk , Hk+1 ) is a balanced extension pair.\nProof. Consider a consecutive pair (Hk , Hk+1 ). By the construction, Hk contains a complete bipartite\nsubgraph that was H1 ; let V1 \u222a V2 be the corresponding partition of the vertex set. Let u and v be the\nendpoints of the edge on which Hk and Hk+1 differ. Without loss of generality, suppose that u, v \u2208 V1 .\n(They must lie in the same part because Hk already contains all edges between V1 and V2 .) Now,\nconsider any subsets U1 \u2282 V1 and U2 \u2282 V2 such that u, v \u2208 U1 and U1 \u222a U2 6= V1 \u222a V2 . Let Hk\u2032 be the\nsubgraph of Hk induced by U1 \u222a U2 . It suffices to show that e(Hk )/(v(Hk ) \u2212 2) \u2265 e(Hk\u2032 )/(v(Hk\u2032 ) \u2212 2).\nLet us denote u1 = |U1 |, u2 = |U2 |, and let e1 and e2 be the respective numbers of edges of Hk\n\u0004 \u0005\u0006 \u0007 \u0004 2 \u0005\nspanned by U1 and by U2 . Since the number of edges between V1 and V2 is 2t 2t = t4 , the number\n\u0004 2\u0005\nof edges in Hk is at least e1 + e2 + t4 . On the other hand, the number of edges in Hk\u2032 is precisely\ne1 + e2 + u1 u2 . Thus, it suffices to show that:\n\u0004 2\u0005\ne1 + e2 + t4\ne1 + e2 + u1 u2\n\u2265\n.\nt\u22122\nu1 + u2 \u2212 2\nSince the quantity (e1 +e2 ) appears in both numerators but the denominators satisfy t\u22122 > u1 +u2 \u22122,\n\u0001\n\u0001\nit will only strengthen the inequality to increase (e1 +e2 ) to its maximum possible value, u21 + u22 \u22121\n(we must subtract 1 because we assumed that Hk has no edge between u, v \u2208 U1 ). Hence it suffices to\nshow\n\u0001\n\u0001\n\u0001\n\u0001\n\u0004 t2 \u0005\nu1\nu2\nu1\nu2\n2 + 2 \u2212 1 + u1 u2\n2 + 2 \u22121+ 4\n\u2265\n.\nt\u22122\nu1 + u2 \u2212 2\n\u0001\n\u0001\n\u0001 \u0004 2\u0005\nLet x = u1 + u2 . The right hand side then simplifies to (x + 1)/2. Also, u21 + u22 \u2265 x2 \u2212 x4 =\n\u0006 x2\n\u0007\nx\n4 \u2212 2 . Therefore, it suffices to show the following inequality, which is equivalent to the next two\ninequalities:\n\u0004 t2 \u0005\n\u0006 x2 x \u0007\nx+1\n4 \u2212 2 \u22121+ 4\n\u2265\nt\u22122\n2\nl x2 x m\nj t2 k\n(x + 1)(t \u2212 2)\n\u22121+\n\u2265\n\u2212\n4\n2\n4\n2\nl x2 x\nt j t2 km\n\u2265 0.\n+ (1 \u2212 t) \u2212 +\n4\n2\n2\n4\n\nThe expression under the ceiling sign is a quadratic polynomial in x, so it is minimized at x = t \u2212 1,\n\u0004 2\u0005\n2\nwhere it takes the value t4 \u2212 t4 \u2212 41 . Since only 0 and 1 are quadratic residues modulo 4, this is\nalways at least \u22121/2, so we are done.\n\u0003\n\nA.2\n\nInequalities\n\nFor the reader's convenience, we reproduce the definitions of the parameters s and \u03b8:\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\n\u03b8=\n\nr s (t \u2212 2) + 2\n\u0002 t\u0001\n\u0003\ns \u22121 .\nr s 2 \u2212 s + rr\u22121\n\nInequality A.6. Suppose that either t \u2265 5 and r \u2265 2, or t = 4 and r \u2265 4. Then \u2212\u03b8 \u2265 \u2212\n28\n\n\u0004 t \u0005\u22121\n2\n\n.\n\n\fProof. It suffices to prove the stronger inequality that \u03b8 * 2t \u2264 1. Since the denominator of \u03b8 is\npositive, this is equivalent to\n\u0015\n\u0014\nrs \u2212 1\nt s\ns t\nr (t \u2212 2) + t \u2264 r\n(t \u2212 1) \u2212 s +\n.\n2\n2\nr\u22121\nRearranging terms, this is equivalent to\nt \u2264 rs\n\n\u0012\n\n\u0013\nt\nrs \u2212 1\n\u2212s +\n.\n2\nr\u22121\n\n(1)\n\nNow by the definition of s = \u230alogr [(r \u2212 1)t + 1]\u230b, we must have r s+1 > (r \u2212 1)t + 1. Since r, s, and t\nare integers, this implies r s+1 \u2265 (r \u2212 1)t + 2, from which we deduce (using r \u2265 2):\nrs \u2265\n\n(r \u2212 1)t + 2\nt\u22122\nt\u22122\nt+2\n=t\u2212\n\u2265t\u2212\n=\n.\nr\nr\n2\n2\n\n(2)\n\nSince r and s are integers, we in fact have\n\u0019\nt+2\n.\nr \u2265\n2\n\n(3)\n\nrs \u2212 1\n\u2265 1.\nr\u22121\n\n(4)\n\ns\n\nAlso, since s is always \u2265 1 for t \u2265 1,\n\n\u0018\n\nLet us now split into several cases, depending on the (integral) values of t and r.\nCase 1: t \u2265 10. Let us bound the terms on the right hand side of inequality (1) one at a time. By\ns \u22121\n(3), r s > t/2, and by (4), rr\u22121\n> 0. Also, Lemma A.1 showed that s was decreasing in r, so for\nr \u2265 2, we have s \u2264 \u230alog2 (t + 1)\u230b. One may routinely verify that \u230alog2 (t + 1)\u230b \u2264 2t \u2212 2 for t \u2265 10.\nCombining all of these bounds, we obtain\n\u0012\n\u0013\n\u0012 \u0013\nt\nt\nrs \u2212 1\ns\nr\n\u2212s +\n>\n(2) + 0 = t,\n2\nr\u22121\n2\nas desired.\nCase 2: t \u2265 5 and r \u2265 6. We follow the same method as the previous case. If we use r \u2265 6 in the\nderivation of inequality (2), we obtain\nrs \u2265 t \u2212\n\nt\u22122\n5t + 2\n5\nt\u22122\n\u2265t\u2212\n=\n> t.\nr\n6\n6\n6\n\ns\n\n\u22121\nBy (4), rr\u22121\n> 0. Also, by Lemma A.1, if r \u2265 6, then s \u2264 \u230alog6 (5t + 1)\u230b. One may routinely\nverify that \u230alog6 (5t + 1)\u230b \u2264 2t \u2212 56 for t \u2265 5. Combining all of these bounds, we obtain\n\u0013\n\u0012 \u0013\u0012 \u0013\n\u0012\n5\n6\nrs \u2212 1\nt\ns\n\u2212s +\n>\nt\nr\n+ 0 = t,\n2\nr\u22121\n6\n5\n\nas desired.\n\n29\n\n\fCase 3: t = 4 and r \u2265 4. By Lemma A.1, if r \u2265 4, then s \u2264 \u230alog4 (3t + 1)\u230b. Since we have t = 4, this\nmeans that s \u2264 1, and in particular, 2t \u2212 s \u2265 1. Yet inequality (3) bounds r s \u2265 \u2308(t + 2)/2\u2309 = 3\ns \u22121\nand inequality (4) bounds rr\u22121\n\u2265 1, so combining all of these bounds, we obtain\nr\n\ns\n\n\u0012\n\n\u0013\nrs \u2212 1\nt\n\u2212s +\n\u2265 3(1) + 1 = 4 = t,\n2\nr\u22121\n\nas desired.\nCase 4: remainder. Only finitely many instances remain: when the integers t and r satisfy 5 \u2264 t \u2264 9\nand 2 \u2264 r \u2264 5. A routine check verifies that \u03b8 * 2t \u2264 1 in all 20 of these cases.\nThis completes the proof.\n\n\u0003\n\nt\nInequality A.7. For any t \u2265 4 and r \u2265 2, if p \u226b n\u2212\u03b8 , then nt\u22122 p(2)\u2212s\u22121 is a positive power of n.\n\nProof. Clearing the denominator of \u03b8, we see that we must establish the following inequality:\n\u0014 \u0014\u0012 \u0013\n\u0015\n\u0015 \u0014\u0012 \u0013\n\u0015\nt\nrs \u2212 1\nt\n(t \u2212 2) r s\n\u2212s +\n>\n\u2212 s \u2212 1 [r s (t \u2212 2) + 2] .\n2\nr\u22121\n2\nThe right hand side is equal to\n\u0014\u0012 \u0013\n\u0015\n\u0014\u0012 \u0013\n\u0015\n\u0014\u0012 \u0013\n\u0015\nt\nt\nt\ns\ns\n\u2212 s \u2212 1 [r (t \u2212 2) + 2] =\n\u2212 s r (t \u2212 2) +\n\u2212 s 2 \u2212 r s (t \u2212 2) \u2212 2,\n2\n2\n2\nso our initial inequality is equivalent to\nrs \u2212 1\n>\n(t \u2212 2)\nr\u22121\n\n\u0014\u0012 \u0013\n\u0015\nt\n\u2212 s 2 \u2212 r s (t \u2212 2) \u2212 2,\n2\n\nso by rearranging terms and ignoring the s term appearing in the bracket on the right hand side, it\nsuffices to establish\n\u0012 \u0013\nt\nr s+1 \u2212 1\n\u22652\n(t \u2212 2)\n\u2212 2.\nr\u22121\n2\nDividing through by t \u2212 2, we see that it suffices to show that\nr s+1 \u2212 1\n\u2265 t + 1.\nr\u22121\nSince both sides of this inequality are integers, it is equivalent to\nr s+1 \u2212 1\n> t.\nr\u22121\nYet by definition of s = \u230alogr [(r \u2212 1)t + 1]\u230b, we must have r s+1 > (r \u2212 1)t + 1 \u21d2\ncompletes the proof.\n\nr s+1 \u22121\nr\u22121\n\n> t, which\n\u0003\nt\n\nInequality A.8. Suppose that t \u2265 5 and r \u2265 2, or t = 4 and r \u2265 4. If p \u226a n\u2212\u03b8 , then nt\u22122 p(2)\u2212s is a\nnegative power of n.\n30\n\n\fProof. Clearing the denominator of \u03b8, we see that we must establish the following inequality:\n\u0014 \u0014\u0012 \u0013\n\u0015\n\u0015 \u0014\u0012 \u0013\n\u0015\nt\nt\nrs \u2212 1\ns\n(t \u2212 2) r\n\u2212s +\n<\n\u2212 s [r s (t \u2212 2) + 2] .\n2\nr\u22121\n2\nThis is equivalent to\n\nrs \u2212 1\n<\n(t \u2212 2)\nr\u22121\n\n\u0014\u0012 \u0013\n\u0015\nt\n\u2212 s 2.\n2\n\nBy definition of s = \u230alogr [(r \u2212 1)t + 1]\u230b, we must have r s \u2264 (r \u2212 1)t + 1. Therefore, the left hand side\nis at most (t \u2212 2)t, so it suffices to show that\nt2 \u2212 2t < t2 \u2212 t \u2212 2s.\nBut this final inequality is a consequence of Lemma A.2, which established that s < t/2.\n\nB\n\n\u0003\n\nSupporting results for avoiding Kt,t\n\nCoincidentally, the definition of the parameter s is exactly the same for avoiding Kt and avoiding Kt,t ,\nso we can still use Lemmas A.1 and A.2 (which prove properties of s) in this section. The specification\nof \u03b8 will be different, however. For the reader's convenience, we reproduce the definitions here.\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\nB.1\n\n\u03b8=\n\nr s (2t \u2212 2) + 2\ns \u22121 .\nr s (t2 \u2212 s) + rr\u22121\n\nBalanced graphs\n\nLemma B.1. For any t \u2265 3 and r \u2265 2, Kt,t \\ se is a balanced graph, except in the case when t = 3,\nr = 2, and the graph is K2,3 with a pendant edge. In that final case, if p \u226b n\u221218/31 / log n, the number\nof copies of that graph in Gm is still O(n6 p7 ) wep.\nProof. We must show that the edge density (number of edges divided by number of vertices) of\nKt,t \\ se is at least the edge density of any proper induced subgraph. The edge density of the complete\nbipartite graph Ka,b is ab/(a + b), which is increasing in both a and b, so the edge density of any\nproper induced subgraph of Kt,t \\ se is at most t(t \u2212 1)/(2t \u2212 1). On the other hand, the edge density\nof Kt,t \\ se is precisely (t2 \u2212 s)/(2t), so we must show that\nt(t \u2212 1)\nt2 \u2212 s\n\u2264\n.\n2t \u2212 1\n2t\nClearing the denominators, this is equivalent to\n2t3 \u2212 2t2 \u2264 2t3 \u2212 t2 \u2212 s(2t \u2212 1).\nRearranging terms, this is equivalent to\ns\u2264\n\nt2\n.\n2t \u2212 1\n\nNow if t \u2265 4, Lemma A.2 bounds s \u2264 t/2, which finishes the inequality.\n\n31\n\n\fThe only remaining case is t = 3. However, Lemma A.1 established that the dependence of\ns = \u230alogr [(r \u2212 1)t + 1]\u230b on r was decreasing, so s = 1 for r \u2265 3, and s = 2 for r = 2. One may manually\nverify that of all of the graphs of the form K3,3 \\ e and K3,3 \\ 2e, the only one which is not balanced\nis the deletion from K3,3 of two edges incident to the same vertex, which is K2,3 with a pendant edge,\nas claimed. Since that graph, which we denote K2,3 + e, arises only when s = 2, this happens only\nwhen r = 2.\nNow let us bound the number of copies of that graph in G(n, p), when p \u226b n\u2212\u03b8 / log n. In the case\n5 6\nt = 3, r = 2, we have \u03b8 = \u2212 18\n31 , and so n p , roughly the expected number of copies of K2,3 in the\nrandom graph, is a positive power of n. So, since K2,3 is balanced, Theorem 2.6 bounds the number\nof copies of K2,3 in Gm by O(n5 p6 ) wep. Also, np is a positive power of n, so we may bound all\ndegrees by 2np wep. If both situations hold, we may conclude that the number of copies of K2,3 + e\nis O(n5 p6 * np) = O(n6 p7 ), as desired.\n\u0003\nLemma B.2. For any t \u2265 3 and r \u2265 2, Kt,t \\ se has the balanced extension property.\nProof. Fix any graph G of the form Kt,t \\ se, and let u, v be any two nonadjacent vertices of G. We\nmust show that the function e(H)/(v(H) \u2212 2) is maximized at H = G, where H is allowed to range\nover all proper induced subgraphs of G that contain {u, v}. Any such H is still bipartite with respect\nto G's bipartition; suppose that it has a vertices on one side and b on the other. Since we assumed that\nH is missing at least the edge joining {u, v}, we must have e(H)/(v(H)\u22122) \u2264 (ab\u22121)/(a+b\u22122). This\nis increasing in both a and b, so its maximum over proper induced subgraphs H is [t(t\u22121)\u22121]/(2t\u22123).\nSo we must prove that\nt2 \u2212 s\nt(t \u2212 1) \u2212 1\n\u2265\n.\n2t \u2212 2\n2t \u2212 3\nClearing the denominators and expanding brackets, this is equivalent to\n2t3 \u2212 3t2 \u2212 s(2t \u2212 3) \u2265 2t3 \u2212 4t2 + 2.\nRearranging terms, this is equivalent to\nt2 \u2212 2 \u2265 s(2t \u2212 3).\nIf t \u2265 4, then Lemma A.2 implies that s \u2264 t/2, which implies the above inequality. On the other\nhand, if t = 3, then Lemma A.1 established that s \u2264 \u230alog2 (t + 1)\u230b for r \u2265 2, so we must have s \u2264 2,\nand this also implies the above inequality. Therefore, we are done.\n\u0003\nLemma B.3. For any fixed positive integer k, consider the following 4-partite graph, which we call\nH1 . Let the parts be V1 , V2 , V3 , V4 , with |V1 | = |V2 | = k and |V3 | = |V4 | = 1, and place edges such that\n(V1 , V2 ), (V1 , V4 ), and (V3 , V2 ) are complete bipartite. There are no more edges. Let H2 be obtained\nfrom H1 by adding the edge between V3 and V4 . Then (H1 , H2 ) is a balanced extension pair.\nProof. Consider any subsets U1 \u2282 V1 and U2 \u2282 V2 , and let H1\u2032 be the subgraph of H1 induced\nby U1 \u222a U2 \u222a V3 \u222a V4 . We must show that e(H1\u2032 )/(v(H1\u2032 ) \u2212 2) \u2264 e(H1 )/(v(H1 ) \u2212 2). Let a = |U1 |\ne(H1\u2032 )\nab\nand b = |U2 |. Then, v(H \u2032 )\u22122\n= ab+a+b\n= a+b\n+ 1, which is increasing in both a and b. Therefore,\na+b\ne(H1\u2032 )\nv(H1\u2032 )\u22122\n\n\u2264\n\nk 2 +k+k\nk+k\n\n1\n\n=\n\ne(H1 )\nv(H1 )\u22122 ,\n\nand we are done.\n\n\u0003\n\n32\n\n\fLemma B.4. Suppose that t is even and at least 4. Let H1 be the 4-partite graph with parts\nV1 , V2 , V3 , V4 , each of size t/2, and edges such that (V1 , V2 ), (V1 , V4 ), and (V3 , V2 ) are complete bipartite. Let {H2 , . . . , H1+(t/2) } be obtained by successively adding single edges until H1+(t/2) has a perfect\nmatching between V3 and V4 . Then, arbitrarily choose the rest of the sequence {H2+(t/2) , . . . , Hf } by\nadding one edge at a time, until the final term is the complete bipartite graph Kt,t with bipartition\n(V1 \u222a V3 , V2 \u222a V4 ). Then every consecutive pair (Hk , Hk+1 ) is a balanced extension pair.\nThe proof breaks into two cases, since there are two stages of edge addition.\nProof of Lemma B.4 for k \u2264 t/2. Consider a consecutive pair (Hk , Hk+1 ). By the construction,\nHk has the following structure. The vertex set is partitioned into V1 \u222a V2 \u222a V3 \u222a V4 , with all parts\nof size t/2. The pairs (V1 , V2 ), (V1 , V4 ), and (V3 , V2 ) are complete bipartite graphs, and there is a\n(k \u2212 1)-edge matching between V3 and V4 . There are no other edges. Also, there is a pair of vertices\nu \u2208 V3 , v \u2208 V4 , not involved in the (k \u2212 1)-edge matching, at which the addition of an edge creates\nHk+1 . Now consider any family of subsets Ui \u2282 Vi such that u \u2208 U3 and v \u2208 U4 . Let Hk\u2032 be the\nsubgraph of Hk induced by \u222aUi . We must show that e(Hk\u2032 )/(v(Hk\u2032 ) \u2212 2) \u2264 e(Hk )/(v(Hk ) \u2212 2).\nFor brevity, let a = |U1 |, b = |U2 |, c = |U3 |, and d = |U4 |. Since the edges between U3 and U4 form\na matching of at most k \u2212 1 edges which does not involve u \u2208 U3 or v \u2208 U4 , there can be at most\nmin{c \u2212 1, d \u2212 1, k \u2212 1} = min{c, d, k} \u2212 1 edges there. Therefore,\ne(Hk\u2032 )\nab + ad + cb + (min{c, d, k} \u2212 1)\n\u2264\n.\n\u2032\nv(Hk ) \u2212 2\na+b+c+d\u22122\nLet us simplify the bound by removing the variables a and b from the inequality. To do this, we show\nthat the bound is nondecreasing in both a and b; then, we may replace them with their maximum\nvalue t/2. Calculating the partial derivative of the right hand side:\n\u2202\n\u2202a\n\n=\n\n(a + b + c + d \u2212 2)(b + d) \u2212 (ab + ad + cb + (min{c, d, k} \u2212 1))\n(a + b + c + d \u2212 2)2\n\nnumerator = (b + d \u2212 1)2 + cd \u2212 min{c, d, k}\n\u2265 cd \u2212 c,\nwhich is always nonnegative because v \u2208 U4 \u21d2 d \u2265 1. An analogous result holds for\nHence we may substitute a = b = t/2 to obtain the bound\ne(Hk\u2032 )\n\u2264\nv(Hk\u2032 ) \u2212 2\n\nt2\n4\n\n\u2202\n\u2202b\n\nby symmetry.\n\n2\n\n\u2212 t + t + min{c, d, k} \u2212 1\n+ 2t (c + d) + min{c, d, k} \u2212 1\nt\n= + 4\n.\nt + (c + d) \u2212 2\n2\nt + (c + d) \u2212 2\n\n(5)\n\nWe reserve the case k = t/2 for separate treatment at the end.\nCase 1: k < t/2. Using the bound min{c, d, k} \u2264 k in (5), we obtain:\n2\n\n\u2212 t4 + t + k \u2212 1\ne(Hk\u2032 )\nt\n\u2264 +\nv(Hk\u2032 ) \u2212 2\n2\nt + (c + d) \u2212 2\nNote that if we substitute c = d = t/2 (their maximum values) in this bound, we obtain precisely\ne(Hk )/(v(Hk ) \u2212 2). Therefore, it suffices to show that the bound is nondecreasing in c and d.\nWe accomplish this by showing that the numerator of the large fraction is always \u2264 0.\n33\n\n\fWe assumed in this case that k < t/2, but in fact, since k is an integer and t is even, we actually\nhave k \u2264 2t \u2212 1. Substituting this into the numerator:\n\u0012\n\u0013\nt\nt2\n1\nt2\n\u2212 1 \u2212 1 = \u2212 [(t \u2212 3)2 \u2212 1].\n\u2212 +t+k\u22121\u2264\u2212 +t+\n4\n4\n2\n4\nSince we assumed that t \u2265 4, this is always \u2264 0, so the bound is indeed nondecreasing in c and\nd. This finishes this case.\nCase 2: k = t/2. This time, we bound min{c, d, k} \u2264 (c + d)/2 in (5). Letting x = (c + d)/2, we have\n2\n\n\u2212 t4 + t + x \u2212 1\ne(Hk\u2032 )\nt\n\u2264\n+\n.\nv(Hk\u2032 ) \u2212 2\n2\nt + 2x \u2212 2\nNote that if we substitute x = t/2 (its maximum value) in the bound, we obtain precisely\ne(Hk )/(v(Hk ) \u2212 2). Therefore, it suffices to show that the bound is increasing in x. Taking the\nnumerator of the partial derivative of the fraction involving x:\n\u0012 2\n\u0013\n\u2202\nt\nt\nnumerator of\n= (t + 2x \u2212 2) \u2212 \u2212 + t + x \u2212 1 2 = (t \u2212 2).\n\u2202x\n4\n2\nSince we assumed t \u2265 4, this is always positive, so the bound is indeed increasing in x. This\ncompletes the proof.\n\u0003\nProof of Lemma B.4 for k > t/2. Consider a consecutive pair (Hk , Hk+1 ). By construction, Hk\nhas the following structure. The vertex set is partitioned into V1 \u222a V2 \u222a V3 \u222a V4 , where each part has\nsize t/2. The pairs (V1 , V2 ), (V1 , V4 ), and (V3 , V2 ) are complete bipartite graphs, and there is a perfect\nmatching between V3 and V4 . There may be some more edges as well between V3 and V4 , but there\nare two vertices u \u2208 V3 and v \u2208 V4 such that there is no edge between u and v. There are no more\nedges in the entire graph. Also, Hk+1 is obtained by Hk by the addition of just the edge joining u and\nv. Now, consider any family of subsets Ui \u2282 Vi such that u \u2208 U3 and v \u2208 U4 . Let Hk\u2032 be the subgraph\nof Hk induced by \u222aUi . We must show that e(Hk\u2032 )/(v(Hk\u2032 ) \u2212 2) \u2264 e(Hk )/(v(Hk ) \u2212 2).\nFor brevity, let a = |U1 |, b = |U2 |, c = |U3 |, and d = |U4 |. Let E be the number of edges between\nU3 and U4 in Hk . Then\ne(Hk\u2032 )\nab + ad + cb + E\n=\n.\n\u2032\nv(Hk ) \u2212 2\na+b+c+d\u22122\nNext, recall that Hk contained a perfect (t/2)-edge matching between V3 and V4 . The maximum\nnumber of edges of this matching that are included in E (i.e., go between U3 and U4 ) is min{c, d} \u2264\n(c + d)/2. Therefore, the number of edges in Hk between V3 and V4 is at least E + 2t \u2212 c+d\n2 . Since the\nrest of Hk consists of 3 complete bipartite subgraphs Kt/2,t/2 :\n2\n\n3 t + E + 2t \u2212\ne(Hk )\n\u2265 4\nv(Hk ) \u2212 2\n2t \u2212 2\n\nc+d\n2\n\n,\n\nand so it suffices to show that\n2\n\n3 t + E + 2t \u2212\nab + ad + cb + E\n\u2264 4\na+b+c+d\u22122\n2t \u2212 2\n34\n\nc+d\n2\n\n.\n\n\fObserve that E appears in the numerator on both sides. Since the denominator on the left hand side is\nalways less than or equal to the denominator on the right hand side, we may replace E (on both sides)\nby its maximum possible value and only sharpen the inequality. This maximum is |U3 ||U4 |\u22121 = cd\u22121,\nbecause we assumed that Hk had no edge between u \u2208 U3 and v \u2208 U4 . Thus it suffices to show that\n2\n\n3 t + (cd \u2212 1) +\nab + ad + cb + (cd \u2212 1)\n\u2264 4\na+b+c+d\u22122\n2t \u2212 2\n\nt\n2\n\n\u2212\n\nc+d\n2\n\n.\n\nNote that the variables a and b appear only on the left hand side. We will show that the left hand side\nis nondecreasing in each of a and b, which will then allow us to replace each of them by their maximum\nvalue (t/2) and only sharpen the inequality. Let us verify this by taking the partial derivative of the\nleft hand side with respect to a:\nab + ad + cb + (cd \u2212 1)\n(a + c)(b + d) \u2212 1\n=\na+b+c+d\u22122\n(a + c) + (b + d) \u2212 2\n\u2202\n[(a + c) + (b + d) \u2212 2](b + d) \u2212 [(a + c)(b + d) \u2212 1]\n=\n\u2202a\n(a + b + c + d \u2212 2)2\nnumerator = (b + d)2 \u2212 2(b + d) + 1,\nwhich is a perfect square, hence always nonnegative. Thus the left hand side was indeed nondecreasing\nin a. By symmetry, the same is true for b, and so it now suffices to prove:\nt2\n4\n\n2\n\n3 t + (cd \u2212 1) +\n+ 2t (c + d) + (cd \u2212 1)\n\u2264 4\nt + (c + d) \u2212 2\n2t \u2212 2\n\nt\n2\n\n\u2212\n\nc+d\n2\n\n.\n\nNow let x = (c + d)/2. Then, cd \u2264 x2 . Observe that cd appears in both the numerator of the left\nhand side and the right hand side, but the denominator on the left is at most the denominator on the\nright. Therefore, we may increase cd to x2 on both sides, and only sharpen the inequality. Thus, it\nsuffices to show that\n2\nt2\nt\n2\n3 t + (x2 \u2212 1) + 2t \u2212 x\n4 + 2 (2x) + (x \u2212 1)\n\u2264 4\n.\nt + (2x) \u2212 2\n2t \u2212 2\nThe left hand side simplifies:\n\u00012\n\u0001\nt\nt2\nt\nt\n2\n+x \u22121\n+x +1\n4 + 2 (2x) + (x \u2212 1)\n2\n2\n\u0001\n\u0003=\n= \u0002 t\n,\nt + (2x) \u2212 2\n2\n2 2 +x \u22121\nso it suffices to show that\n\n\u0001\n2\n+x +1\n3 t4 + (x2 \u2212 1) + 2t \u2212 x\n\u2264\n.\n2\n2t \u2212 2\nClearing the denominators by multiplying by 2t \u2212 2, we see that it suffices to show that\n\u0013\n\u0012\nt2\nt\nt\n+ x + 1 (t \u2212 1) \u2264 3 + (x2 \u2212 1) + \u2212 x.\n2\n4\n2\nt\n2\n\nExpanding the brackets and collecting all remaining terms on one side, this is equivalent to\n0 \u2264 x2 \u2212 xt +\n\nt2\n.\n4\n\nRecognizing the right hand side as the perfect square (x \u2212 2t )2 , we are done.\n\n35\n\n\u0003\n\n\fLemma B.5. Suppose that t is odd and at least 3. Let H1 be a 6-partite graph with parts {Vi }61 such\nthat V3 and V4 are singletons, and the other four parts each have size \u230at/2\u230b. Let there be edges be\nsuch that the two pairs (V1 , V2 ) and (V5 , V6 ) are each complete bipartite graphs, let the vertex in V3 be\nadjacent to all of V2 \u222a V4 \u222a V6 , and let the vertex in V4 be adjacent to all of V1 \u222a V3 \u222a V5 . There are no\nmore edges.\nLet {H2 , . . . , H1+\u230at/2\u230b } be obtained by successively adding single edges until H1+\u230at/2\u230b has a perfect matching between V1 and V6 . To create the next \u230at/2\u230b graphs in the sequence, we put down a\nmatching between V5 and V2 , one edge at a time. Finally, arbitrarily choose the rest of the sequence\n{H2+2\u230at/2\u230b , . . . , Hf } by adding one edge at a time, until the final term is the complete bipartite graph\nKt,t with bipartition (V1 \u222a V3 \u222a V5 , V2 \u222a V4 \u222a V6 ).\nThen every consecutive pair (Hk , Hk+1 ) is a balanced extension pair.\nThe proof breaks into three cases, since there are three stages of edge addition.\nProof of Lemma B.5 for k \u2264 \u230at/2\u230b. Consider a consecutive pair (Hk , Hk+1 ). By the construction,\nHk has the following structure. The vertex set is partitioned into {Vi }61 , with |V3 | = |V4 | = 1 and all\nother |Vi | = \u230at/2\u230b. The pairs (V1 , V2 ) and (V5 , V6 ) are each complete bipartite graphs, the vertex in\nV3 is adjacent to all of V2 \u222a V4 \u222a V6 , the vertex in V4 is adjacent to all of V1 \u222a V3 \u222a V5 , and there is a\n(k \u2212 1)-edge matching between V1 and V6 . There are no other edges. Also, there is a pair of vertices\nu \u2208 V1 , v \u2208 V6 , not involved in the (k \u2212 1)-edge matching, at which the addition of an edge creates\nHk+1 . Now consider any family of subsets Ui \u2282 Vi such that u \u2208 U1 and v \u2208 U6 . Let Hk\u2032 be the\nsubgraph of Hk induced by \u222aUi . We must show that e(Hk\u2032 )/(v(Hk\u2032 ) \u2212 2) \u2264 e(Hk )/(v(Hk ) \u2212 2).\nFor brevity, let a = |U1 |, b = |U2 |, c = |U3 |, d = |U4 |, e = |U5 |, and f = |U6 |. Since the edges\nbetween U1 and U6 form a matching of at most k \u2212 1 edges which does not involve u \u2208 U1 or v \u2208 U6 ,\nthere can be at most min{a \u2212 1, f \u2212 1, k \u2212 1} = min{a, f, k} \u2212 1 edges there. Therefore,\ne(Hk\u2032 )\nab + ef + c(b + f ) + (a + e)d + cd + (min{a, f, k} \u2212 1)\n\u2264\n.\n\u2032\nv(Hk ) \u2212 2\na+b+c+d+e+f \u22122\nWe will show that the bound is nondecreasing in c, which will allow us to replace c with its maximum\nvalue of 1. To do this, we as usual consider the numerator of the partial derivative with respect to c:\nnumerator of\n\n\u2202\n\u2202c\n\n= (a + b + c + d + e + f \u2212 2)(b + f + d)\n=\n\n\u0002\n\n\u2212 [ab + ef + c(b + f ) + (a + e)d + cd + (min{a, f, k} \u2212 1)]\n\u0003\n(b + d + f )2 \u2212 2(b + d + f ) + 1 + eb + [af \u2212 min{a, f, k}].\n\nThe first bracket is a perfect square, and the second bracket is always nonnegative because a and f\nare nonnegative integers. Therefore, the bound is indeed nondecreasing in c. By symmetry, the same\nis true for d, so we can substitute c = d = 1 in the bound to obtain:\ne(Hk\u2032 )\nv(Hk\u2032 ) \u2212 2\n\nab + ef + (b + f ) + (a + e) + 1 + (min{a, f, k} \u2212 1)\na+b+1+1+e+f \u22122\nab + ef + min{a, f, k}\n= 1+\na+b+e+f\n\b\nab + ef + min a+f\n2 ,k\n\u2264 1+\n.\na+b+e+f\n\n\u2264\n\n36\n\n\fLet x = (a + b)/2. We apply a standard \"smoothing\" technique: note that if we replace a = b = x,\nthe denominator does not change, but the numerator increases by\n\"\u0012\n(\n)# \u0014\n\u001a\n\u001b\u0015\n\u0013\na+b\n+\nf\na+b 2\na+f\n2\n+ min\n,k\n\u2212 ab + min\n,k\n2\n2\n2\n(\n)\n\u0012\n\u001a\n\u001b\n\u0013\na+b\n+\nf\na\u2212b 2\na+f\n2\n=\n+ min\n, k \u2212 min\n,k\n2\n2\n2\n(\n)\n\u0012\n\u0013\na+b\n+\nf\na\u2212b 2\na\n+\nf\n2\n\u2265\n+ min\n\u2212\n,k \u2212 k\n2\n2\n2\n\u0012\n\u001a\n\u001b\n\u0013\na\u2212b 2\nb\u2212a\n=\n+ min\n,0 ,\n2\n4\nwhich is \u2265 0 because a and b are integers. Similarly, letting y = (e + f )/2, we have an analogous result\nfor e and f . Therefore,\n\b\nx2 + y 2 + min x+y\ne(Hk\u2032 )\n2 ,k\n\u22641+\n.\n(6)\n\u2032\nv(Hk ) \u2212 2\n2x + 2y\nThe bound is symmetric with respect to x and y, so we may assume without loss of generality that\nx \u2264 y. Our next claim is that increasing x to equal y only increases the bound further. That is, we\naim to prove the following:\n\b\nx2 + y 2 + min x+y\ny 2 + y 2 + min{y, k}\n2 ,k\n\u2264\n.\n(7)\n2x + 2y\n2y + 2y\nCross-multiplying to clear denominators, this is equivalent to\n\u001b\n\u001a\nx+y\n2\n3\n, k \u2264 4xy 2 + 4y 3 + (2x + 2y) min{y, k}.\n4x y + 4y + 4y min\n2\nRearranging terms and using the substitution min{(x + y)/2, k} \u2264 min{y, k} (we assumed x \u2264 y), it\nsuffices to show\n0 \u2264 (y \u2212 x)(4xy \u2212 2 min{y, k}).\n(8)\nYet x = (a + b)/2 and u \u2208 U1 \u21d2 a \u2265 1, so we must have x \u2265 1/2. This, along with y \u2265 x and\nmin{y, k} \u2264 y, establishes (8), and hence (7). Applying that to (6), we obtain\ne(Hk\u2032 )\n2y 2 + min{y, k}\n\u2264\n1\n+\n.\nv(Hk\u2032 ) \u2212 2\n4y\nIf y \u2264 k, then min{y, k} = y, so the bound simplifies into 1 + y2 + 41 , which is clearly increasing in y.\nHence, we may increase y up to k and only increase the bound further. Without loss of generality, we\nmay now assume that y \u2265 k.\nYet if y \u2265 k, then min{y, k} = k, so we have the bound\ne(Hk\u2032 )\n2y 2 + k\n\u2264\n1\n+\n,\nv(Hk\u2032 ) \u2212 2\n4y\nand we will show that it is increasing in y. Taking the derivative of the bound, we obtain\n1\nk\nd\n= \u2212 2,\ndy\n2 4y\n37\n\n\fwhich is \u2265 0 since we assumed that y \u2265 k, and k \u2265 1. The maximum possible value of y = (e + f )/2\nis \u230at/2\u230b, so we may increase y to this value and find\n\u0004 \u00052\n2 2t + k\ne(Hk\u2032 )\n\u0004 \u0005 .\n\u22641+\nv(Hk\u2032 ) \u2212 2\n4 2t\n\nThe final bound is precisely e(Hk )/(v(Hk ) \u2212 2), so we are done.\n\n\u0003\n\nProof of Lemma B.5 for \u230at/2\u230b < k \u2264 2\u230at/2\u230b. The proof in this regime is very similar to the\nprevious one, but we write it out for completeness. Consider a consecutive pair (Hk , Hk+1 ). Let\nl = k \u2212 \u230at/2\u230b. By the construction, Hk has the following structure. The vertex set is partitioned into\n{Vi }6i , with |V3 | = |V4 | = 1 and all other |Vi | = \u230at/2\u230b. The pairs (V1 , V2 ) and (V5 , V6 ) are each complete\nbipartite graphs, the vertex in V3 is adjacent to all of V2 \u222a V4 \u222a V6 , the vertex in V4 is adjacent to all\nof V1 \u222a V3 \u222a V5 , there is a perfect \u230at/2\u230b-edge matching between V1 and V6 , and there is an (l \u2212 1)-edge\nmatching between V5 and V2 . There are no other edges. Also, there is a pair of vertices u \u2208 V5 ,\nv \u2208 V2 , not involved in the (l \u2212 1)-edge matching, at which the addition of an edge creates Hk+1 . Now\nconsider any family of subsets Ui \u2282 Vi such that u \u2208 U5 and v \u2208 U2 . Let Hk\u2032 be the subgraph of Hk\ninduced by \u222aUi . We must show that e(Hk\u2032 )/(v(Hk\u2032 ) \u2212 2) \u2264 e(Hk )/(v(Hk ) \u2212 2).\nFor brevity, let a = |U1 |, b = |U2 |, c = |U3 |, d = |U4 |, e = |U5 |, and f = |U6 |. Since the edges\nbetween U5 and U2 form a matching of at most l \u2212 1 edges which does not involve u \u2208 U5 or v \u2208 U2 ,\nthere can be at most min{b\u22121, e\u22121, l\u22121} = min{b, e, l}\u22121 edges there. On the other hand, the edges\nbetween U1 and U6 also are a matching, and we may bound their number by min{a, f }. Therefore,\ne(Hk\u2032 )\nab + ef + c(b + f ) + (a + e)d + cd + min{a, f } + (min{b, e, l} \u2212 1)\n\u2264\n.\n\u2032\nv(Hk ) \u2212 2\na+b+c+d+e+f \u22122\nAs in the proof of this lemma for k \u2264 \u230at/2\u230b, our first step is to show that the bound is nondecreasing\nin c by calculating its partial derivative. The calculations are almost identical, and we arrive at\nnumerator of\n\n\u0002\n\u0003\n\u2202\n= (b + d + f )2 \u2212 2(b + d + f ) + 1 + [af \u2212 min{a, f }] + [eb \u2212 min{b, e, l}].\n\u2202c\n\nThe first bracket is a perfect square, and each of the other brackets is nonnegative because all variables\nare nonnegative integers. Hence we may set c = 1 (its maximum value) and increase the bound. The\nsame holds for d by symmetry. Therefore,\ne(Hk\u2032 )\nv(Hk\u2032 ) \u2212 2\n\nab + ef + (b + f ) + (a + e) + 1 + min{a, f } + (min{b, e, l} \u2212 1)\na+b+1+1+e+f \u22122\nab + ef + min{a, f } + min{b, e, l}\n= 1+\na+b+e+f\n\u2264\n\n\u2264 1+\n\nb+e\nab + ef + a+f\n2 + min{ 2 , l}\n.\na+b+e+f\n\nWe again will use a \"smoothing\" technique. Let x = (a + b)/2, and consider the effect of setting\n\n38\n\n\fa = b = x. The denominator will remain invariant, but the numerator will increase by\n\"\u0012\n(\n)# \u0012\n\u001a\n\u001b\u0013\n\u0013\na+b\n+\nf\n+\ne\nb+e\na + b 2 a+b\na+f\n2\n2\n+ min\n,l\n\u2212 ab +\n+ min\n,l\n+\n2\n2\n2\n2\n2\n\"\n(\n)\n\u0012\n\u001a\n\u001b#\n\u0013\na+b\na\u2212b 2 b\u2212a\nb+e\n2 +e\n=\n+\n+ min\n, l \u2212 min\n,l\n2\n4\n2\n2\n(\n)\n\u0013\n\u0012\na+b\nb+e\na\u2212b 2 b\u2212a\n2 +e\n+\n+ min\n\u2212\n,l \u2212 l\n\u2265\n2\n4\n2\n2\n\u0012\n\u001a\n\u001b\n\u0013\na\u2212b 2 b\u2212a\na\u2212b\n=\n+ min\n,0 ,\n+\n2\n4\n4\nwhich is always \u2265 0 since a and b are integers. A similar results holds if we let y = (e+f )/2. Therefore,\n\b x+y\nx2 + y 2 + x+y\ne(Hk\u2032 )\n2 + min\n2 ,l\n\u22641+\n.\n(9)\n\u2032\nv(Hk ) \u2212 2\n2x + 2y\nThe bound is symmetric with respect to x and y, so we may assume without loss of generality that\nx \u2264 y. Our next claim is that increasing x to equal y only increases the bound further. That is, we\naim to prove the following:\n\b x+y\nx2 + y 2 + x+y\n+\nmin\ny 2 + y 2 + y + min{y, l}\n2\n2 ,l\n\u2264\n.\n(10)\n2x + 2y\n2y + 2y\nCross-multiplying to clear denominators, this is equivalent to\n\u001a\n\u001b\nx+y\n2\n3\n4x y + 4y + 2y(x + y) + 4y min\n, l \u2264 4xy 2 + 4y 3 + (2x + 2y)y + (2x + 2y) min{y, l}.\n2\nRearranging terms and using the substitution min{(x + y)/2, l} \u2264 min{y, l} (we assumed x \u2264 y), it\nsuffices to show\n0 \u2264 (y \u2212 x)(4xy \u2212 2 min{y, l}).\n(11)\nYet x = (a + b)/2 and v \u2208 U2 \u21d2 b \u2265 1, so we must have x \u2265 1/2. This, along with y \u2265 x and\nmin{y, l} \u2264 y, establishes (11), and hence (10). Applying that to (9), we obtain\ne(Hk\u2032 )\n2y 2 + y + min{y, l}\n\u2264\n1\n+\n.\nv(Hk\u2032 ) \u2212 2\n4y\nIf y \u2264 l, then min{y, l} = y and the bound becomes 1 + y2 + 12 , which is clearly increasing in y. Hence,\nwe may increase y up to l and only increase the bound further. Without loss of generality, we may\nnow assume that y \u2265 l.\nYet if y \u2265 l, then min{y, l} = l, so we have the bound\ne(Hk\u2032 )\n2y 2 + y + l\n\u22641+\n,\n\u2032\nv(Hk ) \u2212 2\n4y\nand we will show that it is increasing in y. Taking the derivative of the bound, we obtain\n1\nl\nd\n= \u2212 2,\ndy\n2 4y\n39\n\n\fwhich is \u2265 0 since we assumed that y \u2265 l, and l \u2265 1. The maximum possible value of y = (e + f )/2\nis \u230at/2\u230b, so we may increase y to this value and find\n\u0004 \u00052 \u0004 \u0005\n2 2t + 2t + l\ne(Hk\u2032 )\n\u0004 \u0005\n.\n\u22641+\nv(Hk\u2032 ) \u2212 2\n4 2t\nThe final bound is precisely e(Hk )/(v(Hk ) \u2212 2), so we are done.\n\n\u0003\n\nProof of Lemma B.5 for k > 2\u230at/2\u230b. Consider a consecutive pair (Hk , Hk+1 ). By construction,\nHk has the following structure. The vertex set is partitioned into {Vi }61 , with |V3 | = |V4 | = 1 and all\nother |Vi | = \u230at/2\u230b. The pairs (V1 , V2 ) and (V5 , V6 ) are each complete bipartite graphs, the vertex in V3\nis adjacent to all of V2 \u222a V4 \u222a V6 , the vertex in V4 is adjacent to all of V1 \u222a V3 \u222a V5 , there is a perfect\n\u230at/2\u230b-edge matching between V1 and V6 , and another perfect matching between V5 and V2 . There\nmay be some more edges as well between V1 and V6 or between V5 and V2 , but not all such edges are\npresent: without loss of generality, let us suppose that there are two vertices u \u2208 V1 and v \u2208 V6 such\nthat there is no edge between u and v. There are no more edges in the entire graph. Also, Hk+1 is\nobtained from Hk by adding the edge joining u and v. Now, consider any family of subsets Ui \u2282 Vi\nsuch that u \u2208 U1 and v \u2208 U6 . Let Hk\u2032 be the subgraph of Hk induced by \u222aUi . We must show that\ne(Hk\u2032 )/(v(Hk\u2032 ) \u2212 2) \u2264 e(Hk )/(v(Hk ) \u2212 2).\nFor brevity, let a = |U1 |, b = |U2 |, c = |U3 |, d = |U4 |, e = |U5 |, and f = |U6 |. Let E be the number\nof edges in Hk between U1 and U6 or between U5 and U2 . Then\ne(Hk\u2032 )\nab + ef + c(b + f ) + (a + e)d + cd + E\n=\n.\nv(Hk\u2032 ) \u2212 2\na+b+c+d+e+f \u22122\n\n(12)\n\nNext, recall that Hk contained a perfect \u230at/2\u230b-edge matching between V1 and V6 , and between V5 and\nV2 . The maximum number of edges of these matchings that are included in E (i.e., go between U1\nand U6 , or between U5 and U2 ) is min{a, f } + min{b, e} \u2264 (a + f + b + e)/2. Therefore, the number of\n\u0004 \u0005\nedges in Hk between V1 and V6 or between V5 and V2 is at least E + 2 2t \u2212 a+b+e+f\n. The rest of the\n2\nedges in Hk are easy to count: (V1 , V2 ) and (V5 , V6 ) are complete bipartite subgraphs K\u230at/2\u230b,\u230at/2\u230b , the\nvertex in V3 is adjacent to all of V2 \u222a V4 \u222a V6 , and the vertex in V4 is adjacent to all of V1 \u222a V3 \u222a V5 .\nTherefore,\n\u0004 \u00052 \u0002 \u0004 \u0005\n\u0003 \u0002\n\u0004 \u0005\n\u0003\n2 2t + 4 2t + 1 + E + 2 2t \u2212 a+b+e+f\ne(Hk )\n2\n\u2265\n.\n(13)\nv(Hk ) \u2212 2\n2t \u2212 2\nIdentifying the denominator as 4\u230at/2\u230b since t is odd, we may simplify the bound:\n\u0016 \u0017\na+b+e+f\ne(Hk )\n1 t\n3 1+E\u2212\n2\n\u2265\n,\n+ +\nv(Hk ) \u2212 2\n2 2\n2\n4\u230at/2\u230b\nand so it suffices to show that\n\u0016 \u0017\na+b+e+f\n1 t\nab + ef + c(b + f ) + (a + e)d + cd + E\n3 1+E \u2212\n2\n\u2264\n.\n+ +\na+b+c+d+e+f \u22122\n2 2\n2\n4\u230at/2\u230b\nObserve that E appears in the numerator on both sides. Since the denominator on the left hand\nside is always less than or equal to the denominator on the right hand side, we may replace E\n(on both sides) by its maximum possible value and only sharpen the inequality. This maximum\n40\n\n\fis (|U1 ||U6 | \u2212 1) + (|U5 ||U2 |) = af \u2212 1 + be, because we assumed that Hk had no edge between u \u2208 U1\nand v \u2208 U6 . Thus it suffices to show that\n\u0016 \u0017\n1 t\n3 1 + (af \u2212 1 + be) \u2212\nab + ef + c(b + f ) + (a + e)d + cd + (af \u2212 1 + be)\n\u2264\n+ +\na+b+c+d+e+f \u22122\n2 2\n2\n4\u230at/2\u230b\n\na+b+e+f\n2\n\n.\n\nSimplifying the numerator on each side, this is equivalent to\n\u0016 \u0017\n(a + c + e)(b + d + f ) \u2212 1\n1 t\n3 (a + e)(b + f ) \u2212 (ab + ef ) \u2212\n\u2264\n+ +\na+b+c+d+e+f \u22122\n2 2\n2\n4\u230at/2\u230b\n\na+b+e+f\n2\n\n.\n\n(14)\n\nNote that the variables c and d appear only on the left hand side. We will show that the left hand side\nis nondecreasing in each variable, which will then allow us to replace each of them by their maximum\nvalue of 1 and only sharpen the inequality. Let us verify this by taking the partial derivative of the\nleft hand side with respect to c:\nnumerator of\n\n\u2202\n\u2202c\n\n= (a + b + c + d + e + f \u2212 2)(b + d + f ) \u2212 [(a + c + e)(b + d + f ) \u2212 1]\n= (b + d + f )2 \u2212 2(b + d + f ) + 1.\n\nThis is a perfect square, so it is \u2265 0 as claimed. By symmetry, a similar result holds for d; therefore\n(a + 1 + e)(b + 1 + f ) \u2212 1\n(a + e)(b + f )\n(a + c + e)(b + d + f ) \u2212 1\n\u2264\n=1+\n,\na+b+c+d+e+f \u22122\na+b+1+1+e+f \u22122\na+b+e+f\nand applying this to (14), we see that it suffices to show\n\u0016 \u0017\n(a + e)(b + f )\n1 t\n1 (a + e)(b + f ) \u2212 (ab + ef ) \u2212\n\u2264\n+ +\na+b+e+f\n2 2\n2\n4\u230at/2\u230b\n\na+b+e+f\n2\n\n.\n\n(15)\n\nOur next step is to apply a \"smoothing\" argument to push (a + e) and (b + f ) closer together while\npreserving their sum. We claim that this will only sharpen the inequality. By symmetry, we may\nassume without loss of generality that a + e \u2264 b + f . Let \u2206 = [(b + f ) \u2212 (a + e)]/4, and consider\nthe effect on (15) of increasing each of a and e by \u2206, while decreasing each of b and f by \u2206. This\nwill bring (a + e) and (b + f ) together to their average, which by convexity, increases their product\n(a + e)(b + f ). This product appears in the numerator on both sides, and since the denominator on the\nleft is at most the denominator on the right, this simultaneous change can only sharpen the inequality.\nThe only other term that will change is ab + ef , so it remains to verify that it increases under this\ntransformation:\n(a + \u2206)(b \u2212 \u2206) + (e + \u2206)(f \u2212 \u2206) = (ab + ef ) + (b + f \u2212 a \u2212 e)\u2206 \u2212 2\u22062 = (ab + ef ) + 2\u22062 .\nThis proves our claim that we may \"smooth\" (a + e) and (b + f ) together and only sharpen the\ninequality. Therefore, we may now assume that a + e = b + f for the remainder of the proof; let\nx = (a + e)/2.\nRewriting the right hand side of (15), it suffices to show\n\u0016 \u0017\na+b+e+f\n(a + e)(b + f )\n1 t\n1 af + be \u2212\n2\n\u2264\n.\n+ +\na+b+e+f\n2 2\n2\n4\u230at/2\u230b\n41\n\n\fSubstituting a + e = 2x = b + f into the inequality, this is equivalent to\n\u0016 \u0017\n(2x)(2x)\n1 t\n1 af + be \u2212 2x+2x\n2\n\u2264\n.\n+ +\n2x + 2x\n2 2\n2\n4\u230at/2\u230b\nSimplifying each side of the inequality, this is equivalent to\n\u0016 \u0017\n1 af + be \u2212 2x\n1 t\n,\n+ +\nx\u2264\n2 2\n2\n4\u230at/2\u230b\n\n(16)\n\n+be\u22122x\nObserve that we always have 2x \u2264 2\u230at/2\u230b because 0 \u2264 a, b, e, f \u2264 \u230at/2\u230b; hence 21 + af4\u230at/2\u230b\n\u2265 0.\n\u0004\n\u0005\n1 t\nTherefore, if x itself is already \u2264 2 2 , then we are already done.\nIt remains to consider the case when 2x > \u230at/2\u230b, which we will assume for the remainder of this\nproof. Let us replace the af + be term by a function of x, so that the entire inequality will be in terms\nof x and t only. That is, we wish to find the minimum value of af + be when a, b, e, f \u2208 [0, \u230at/2\u230b],\nsubject to the constraints a + e = 2x = b + f . Writing e = 2x \u2212 a and f = 2x \u2212 b, we aim to minimize\n\naf + be = a(2x \u2212 b) + b(2x \u2212 a) = 2x(a + b) \u2212 2ab.\nFor fixed a + b, the right hand side is minimized when a = b, so we may assume that is the case; let\nz = a = b. We are then trying to minimize 2x(2z) \u2212 2z 2 for fixed x. The variable z is constrained to\nthe interval [2x \u2212 \u230at/2\u230b, \u230at/2\u230b], because 0 \u2264 a \u2264 \u230at/2\u230b and 0 \u2264 e = 2x \u2212 a \u2264 \u230at/2\u230b and we assumed\n2x > \u230at/2\u230b. Since 2x(2z) \u2212 2z 2 is quadratic in z with negative leading coefficient, it is minimized at\none of the endpoints of z's interval. It turns out that it takes that same value 2\u230at/2\u230b(2x \u2212 \u230at/2\u230b) at\neach endpoint, so we conclude that af + be \u2265 2\u230at/2\u230b(2x \u2212 \u230at/2\u230b).\nSubstituting this into (16), it now suffices to show\n\u0016 \u0017\n1 2\u230at/2\u230b(2x \u2212 \u230at/2\u230b) \u2212 2x\n1 t\n,\n+ +\nx\u2264\n2 2\n2\n4\u230at/2\u230b\nRearranging terms, this is equivalent to\n\n2x\n1\n\u2264 ,\n4\u230at/2\u230b\n2\n\nwhich is true because x = (a + e)/2 and a, e \u2264 \u230at/2\u230b, so we are done.\n\nB.2\n\nInequalities\n\nFor the reader's convenience, we reproduce the definitions of s and \u03b8:\ns = \u230alogr [(r \u2212 1)t + 1]\u230b,\n\n\u03b8=\n\nr s (2t \u2212 2) + 2\ns \u22121 .\nr s (t2 \u2212 s) + rr\u22121\n\nInequality B.6. Suppose that t \u2265 3 and r \u2265 2. Then \u2212\u03b8 > \u2212 2t .\nProof. Clearing the denominators, this is equivalent to\nr s (2t2 \u2212 2t) + 2t < r s (2t2 \u2212 2s) + 2\n\n42\n\nrs \u2212 1\n.\nr\u22121\n\n\u0003\n\n\fRearranging terms, this is equivalent to\nrs \u2212 1\n.\nr\u22121\nSince the right hand side is always positive, it suffices to show that the left hand side is \u2264 0. Note\nthat if s \u2264 t/2, then the left hand side is indeed \u2264 t(\u2212r s + 2) \u2264 0 since r \u2265 2 and s \u2265 1. This happens\nwhenever t \u2265 4 by Lemma A.2, and whenever t = 3 and r \u2265 3 because Lemma A.1 shows that then\ns \u2264 \u230alog3 (2t + 1)\u230b = 1 \u2264 t/2. The only remaining case is t = 3, r = 2, in which case s = 2, and one\nmay manually verify that the left hand side is precisely \u22122 \u2264 0.\n\u0003\n2r s (s \u2212 t) + 2t < 2\n\n2 \u2212s\u22121\n\nInequality B.7. For any t \u2265 3 and r \u2265 2, if p \u226b n\u2212\u03b8 , then n2t\u22122 pt\n\nis a positive power of n.\n\nProof. The proof of this inequality is nearly identical to the proof of Inequality A.7. Cross-multiplying\nto clear the denominators, it suffices to show\n\u0014\n\u0015\nrs \u2212 1\n(2t \u2212 2) r s (t2 \u2212 s) +\n> (t2 \u2212 s \u2212 1) [r s (2t \u2212 2) + 2] .\n(17)\nr\u22121\nThe right hand side of (17) is equal to\n(t2 \u2212 s \u2212 1) [r s (2t \u2212 2) + 2] = (t2 \u2212 s)r s (2t \u2212 2) \u2212 r s (2t \u2212 2) + (t2 \u2212 s \u2212 1)2,\nso (17) is equivalent to\n\nrs \u2212 1\n> \u2212r s (2t \u2212 2) + (t2 \u2212 s \u2212 1)2,\nr\u22121\nand by rearranging terms and ignoring the s term appearing in the parentheses on the right hand side,\nit suffices to establish\nr s+1 \u2212 1\n(2t \u2212 2)\n\u2265 (t2 \u2212 1)2.\nr\u22121\nDividing through by 2(t \u2212 1), we see that it suffices to show that\n(2t \u2212 2)\n\nr s+1 \u2212 1\n\u2265 t + 1,\nr\u22121\nwhich was already shown at the end of the proof of Inequality A.7.\n\n\u0003\n2 \u2212s\n\nInequality B.8. For any t \u2265 3 and r \u2265 2, if p \u226a n\u2212\u03b8 , then n2t\u22122 pt\n\nis a negative power of n.\n\nProof. The proof of this inequality is nearly identical to the proof of Inequality A.8. We must\nestablish the following inequality:\n\u0014\n\u0015\nrs \u2212 1\ns 2\n(2t \u2212 2) r (t \u2212 s) +\n< (t2 \u2212 s) [r s (2t \u2212 2) + 2] .\nr\u22121\nThis is equivalent to\n\nrs \u2212 1\n< (t2 \u2212 s)2.\nr\u22121\nBy definition of s, r s \u2264 (r \u2212 1)t + 1. Therefore, the left hand side is at most (2t \u2212 2)t, and it suffices\nto show that\n2t2 \u2212 2t < 2t2 \u2212 2s,\n(2t \u2212 2)\n\ni.e., to show that s < t. But Lemma A.1 established that if r \u2265 2, then s \u2264 \u230alog2 (t + 1)\u230b, and this is\nindeed less than t for all t \u2265 3.\n\u0003\n43\n\n\f"}