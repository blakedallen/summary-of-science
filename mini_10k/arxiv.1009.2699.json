{"id": "http://arxiv.org/abs/1009.2699v2", "guidislink": true, "updated": "2011-11-16T19:38:05Z", "updated_parsed": [2011, 11, 16, 19, 38, 5, 2, 320, 0], "published": "2010-09-14T15:41:03Z", "published_parsed": [2010, 9, 14, 15, 41, 3, 1, 257, 0], "title": "Residue classes containing an unexpected number of primes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.5782%2C1009.1832%2C1009.1150%2C1009.1521%2C1009.1227%2C1009.5331%2C1009.1473%2C1009.5470%2C1009.4491%2C1009.0566%2C1009.6056%2C1009.4873%2C1009.2150%2C1009.0226%2C1009.0893%2C1009.0178%2C1009.4151%2C1009.5692%2C1009.4124%2C1009.0445%2C1009.5428%2C1009.0796%2C1009.4419%2C1009.0987%2C1009.6025%2C1009.1949%2C1009.2835%2C1009.4887%2C1009.1262%2C1009.4611%2C1009.2821%2C1009.2420%2C1009.0680%2C1009.5503%2C1009.2877%2C1009.2691%2C1009.5998%2C1009.5506%2C1009.3224%2C1009.4668%2C1009.5011%2C1009.4972%2C1009.4840%2C1009.3832%2C1009.5010%2C1009.2413%2C1009.2252%2C1009.5040%2C1009.0832%2C1009.0466%2C1009.1006%2C1009.4299%2C1009.2364%2C1009.2976%2C1009.2957%2C1009.2092%2C1009.5208%2C1009.3156%2C1009.1514%2C1009.5239%2C1009.5001%2C1009.3834%2C1009.1103%2C1009.0334%2C1009.3414%2C1009.3010%2C1009.3178%2C1009.0327%2C1009.0916%2C1009.4486%2C1009.2568%2C1009.6094%2C1009.4415%2C1009.4950%2C1009.4364%2C1009.3845%2C1009.5298%2C1009.1219%2C1009.0198%2C1009.1195%2C1009.0879%2C1009.3975%2C1009.4022%2C1009.3999%2C1009.1556%2C1009.2142%2C1009.5271%2C1009.5840%2C1009.3417%2C1009.4515%2C1009.1979%2C1009.1685%2C1009.4241%2C1009.0420%2C1009.5348%2C1009.2110%2C1009.2699%2C1009.5980%2C1009.3333%2C1009.5867%2C1009.1592&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Residue classes containing an unexpected number of primes"}, "summary": "We fix a non-zero integer $a$ and consider arithmetic progressions $a \\bmod\nq$, with $q$ varying over a given range. We show that for certain specific\nvalues of $a$, the arithmetic progressions $a \\bmod q$ contain, on average,\nsignificantly fewer primes than expected.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.5782%2C1009.1832%2C1009.1150%2C1009.1521%2C1009.1227%2C1009.5331%2C1009.1473%2C1009.5470%2C1009.4491%2C1009.0566%2C1009.6056%2C1009.4873%2C1009.2150%2C1009.0226%2C1009.0893%2C1009.0178%2C1009.4151%2C1009.5692%2C1009.4124%2C1009.0445%2C1009.5428%2C1009.0796%2C1009.4419%2C1009.0987%2C1009.6025%2C1009.1949%2C1009.2835%2C1009.4887%2C1009.1262%2C1009.4611%2C1009.2821%2C1009.2420%2C1009.0680%2C1009.5503%2C1009.2877%2C1009.2691%2C1009.5998%2C1009.5506%2C1009.3224%2C1009.4668%2C1009.5011%2C1009.4972%2C1009.4840%2C1009.3832%2C1009.5010%2C1009.2413%2C1009.2252%2C1009.5040%2C1009.0832%2C1009.0466%2C1009.1006%2C1009.4299%2C1009.2364%2C1009.2976%2C1009.2957%2C1009.2092%2C1009.5208%2C1009.3156%2C1009.1514%2C1009.5239%2C1009.5001%2C1009.3834%2C1009.1103%2C1009.0334%2C1009.3414%2C1009.3010%2C1009.3178%2C1009.0327%2C1009.0916%2C1009.4486%2C1009.2568%2C1009.6094%2C1009.4415%2C1009.4950%2C1009.4364%2C1009.3845%2C1009.5298%2C1009.1219%2C1009.0198%2C1009.1195%2C1009.0879%2C1009.3975%2C1009.4022%2C1009.3999%2C1009.1556%2C1009.2142%2C1009.5271%2C1009.5840%2C1009.3417%2C1009.4515%2C1009.1979%2C1009.1685%2C1009.4241%2C1009.0420%2C1009.5348%2C1009.2110%2C1009.2699%2C1009.5980%2C1009.3333%2C1009.5867%2C1009.1592&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We fix a non-zero integer $a$ and consider arithmetic progressions $a \\bmod\nq$, with $q$ varying over a given range. We show that for certain specific\nvalues of $a$, the arithmetic progressions $a \\bmod q$ contain, on average,\nsignificantly fewer primes than expected."}, "authors": ["Daniel Fiorilli"], "author_detail": {"name": "Daniel Fiorilli"}, "author": "Daniel Fiorilli", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1215/00127094-1902268", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1009.2699v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1009.2699v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "18 pages. Added a few remarks, changed the numbering of sections,\n  slightly improved results, and made a few corrections", "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11N13", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1009.2699v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1009.2699v2", "journal_reference": "Duke Math. J. 161, no. 15 (2012), 2923-2943", "doi": "10.1215/00127094-1902268", "fulltext": "RESIDUE CLASSES CONTAINING AN UNEXPECTED NUMBER OF\nPRIMES\n\narXiv:1009.2699v2 [math.NT] 16 Nov 2011\n\nDANIEL FIORILLI\nAbstract. We fix a non-zero integer a and consider arithmetic progressions a mod q, with\nq varying over a given range. We show that for certain specific values of a, the arithmetic\nprogressions a mod q contain, on average, significantly fewer primes than expected.\n\n1. Introduction\nThe prime number theorem for arithmetic progressions asserts that\n\u03c8(x; q, a) \u223c \u03c8(x)/\u03c6(q)\n\nfor any a and q such that (a, q) = 1. Another way to say this is that the primes are\nequidistributed in the \u03c6(q) arithmetic progressions a mod q with (a, q) = 1.\nFix an integer a 6= 0. We will be interested in the number of primes in the arithmetic\nprogressions a mod q with q varying in certain ranges, and we will show that for specific\nvalues of a, there are significantly fewer primes in these arithmetic progressions than in\ntypical arithmetic progressions. Consider the average value of \u03c8(x; q, a) \u2212 \u03c8(x)/\u03c6(q) over q.\nOne might expect that no matter what the value of a is, the cancellations in these oscillating\nterms will force the average to be very small. However it turns out that the average is highly\ndependent on the arithmetical properties of a.\nHere is the main result of the paper.\nTheorem 1.1. Fix an integer a 6= 0 and let M = M(x) \u2264 (log x)B where B > 0 is a fixed\nreal number. The average error term in the usual approximation for the number of primes\np \u2261 a mod q with p \u2264 x, p 6= a, where (q, a) = 1 and q \u2264 x/M, is\n\u0013\n\u0012\n\u0013\nX \u0012\n1\n1\n\u03c8(x)\n= \u03bc(a, M) + Oa,\u01eb,B\n(1)\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n205\n\u03c6(a) x\n\u03c6(q)\nM 538 \u2212\u01eb\nx\na\n\nwith\n\nwhere\n\nM\n\nq\u2264 M\n(q,a)=1\n\n\uf8f1\n\uf8f4\n\uf8f20\n\u03bc(a, M) := \u2212 21 log p\n\uf8f4\n\uf8f3\u2212 1 log M \u2212 C\n5\n2\n1\nC5 :=\n2\n\nlog 2\u03c0 + \u03b3 +\n\nX\np\n\nif \u03c9(a) \u2265 2\nif a = \u00b1pe\nif a = \u00b11,\n\n!\nlog p\n+1 .\np(p \u2212 1)\n\nRemark 1.2.\u0001 Assuming Lindel\u00f6f's hypothesis, we can replace the error term in (1) by\n1\n.\nOa,\u01eb,B M 1/2\u2212\u01eb\n1\n\n\fRemark 1.3. We subtracted \u039b(a) from \u03c8(x; q, a) in (1) because the arithmetic progression\na mod q contains the prime power pe for all q if a = pe .\nRemark 1.4. It may be preferable to replace \u03c8(x) by \u03c8(x, \u03c70 ) in Theorem 1.1, since the\nquantity\n\u03c8(x; q, a) \u2212 \u03c8(x, \u03c70 )/\u03c6(q)\nis the discrepancy (with signs) of the sequence of primes in the reduced residue classes mod\nq. One can do this with a negligible error term.\nAcknowledgements\nI would like to thank my supervisor Andrew Granville for many helpful comments and his\nadvice in general, as well as my colleagues Farzad Aryan, Mohammad Bardestani, Tristan\nFreiberg and Kevin Henriot for many fruitful conversations. I would also like to thank John\nFriedlander for suggesting Remark 1.4 and for other helpful comments. L'auteur est titulaire\nd'une bourse doctorale du Conseil de recherches en sciences naturelles et en g\u00e9nie du Canada.\n2. Past Results\nThe study of the discrepancy \u03c8(x; q, a) \u2212 x/\u03c6(q) on average has been a fruitful subject\nover the past decades. For example, the celebrated theorem of Bombieri-Vinogradov gives\na bound on the sum of the mean absolute value of the maximum of this discrepancy over\nall 1 \u2264 a < q with (a, q) = 1, summed over q \u2264 x1/2\u2212o(1) . The Hooley-Montgomery\nrefinement of the Barban-Davenport-Halberstam Theorem gives an estimation of the variance\nof \u03c8(x; q, a) \u2212 x/\u03c6(q), again for all values of a in the range 1 \u2264 a < q with (a, q) = 1 for\nq < x/(log x)A . The mean value of \u03c8(x; q, a) \u2212 x/\u03c6(q) was studied for fixed values of a for\nq \u2265 x1/2 (see [1],[3] or [4]), and bounds on this mean value turned out to be applicable to\nTitchmarsh's divisor problem, first solved by Linnik. The best result so far for this problem\nwas obtained by Friedlander and Granville.\nTheorem 2.1 (Friedlander, Granville). Let 0 < \u03bb < 1/4, A > 0 be given. Then uniformly\nfor 0 < |a| < x\u03bb , 2 \u2264 Q \u2264 x/3 we have\n\u0013\nX \u0012\nx\nx\n\u03c8(x; q, a) \u2212\n\u226a\u03bb,A 2\u03c9(a) Q log(x/Q) +\n+ Q log |a|.\n(2)\nA\n\u03c6(q)\n(log\nx)\nQ<q\u22642Q\n(q,a)=1\n\nRemark 2.2. If a is not a prime power the term Q log |a| may be deleted.\nTheorem 2.1 is a refinement of the deep results of Bombieri-Friedlander-Iwaniec [1] and\nof Fouvry [3], and makes use of the dispersion method combined with Fourier analysis and\ninvolved estimates on Kloosterman sums.\nThe main method used in our paper, which we will refer to as the \"divisor switching\"\ntechnique, stemmed from the work of Dirichlet on the divisor problem. Variants of his\n\"hyperbola method\" were subsequently used in many different contexts, and have become a\nvery important tool in analytic number theory. The variant which will be used in this paper\nis very similar to that of Hooley [6].\n2\n\n\f3. Main results\nWhat we will actually prove in Section 6 is a uniform version of Theorem 1.1 (which is too\n1\ntechnical to state at this point), and we will see that the proportion of integers |a| \u2264 x 4 \u2212\u01eb for\nwhich we get an error term of O(M \u2212\u03b7 ) in (1) is at least (1 \u2212 4\u03b7)e\u2212\u03b3 (here and throughout,\n\u03b3 denotes the Euler-Mascheroni constant).\nA number of constants will appear in the paper.\nDefinition 3.1. We define\n\u0012\n\u0013\n\u03b6(2)\u03b6(3) \u03c6(a) Y\n1\nC1 (a) :=\n1\u2212 2\n,\n\u03b6(6)\na\np \u2212p+1\np|a\n\n\uf8eb\n\nC3 (a) := C1 (a) \uf8ed\u03b3 \u2212 1 \u2212\n1\nC5 :=\n2\n\nX\np\n\np2\n\nlog p\n+\n\u2212p+1\n\nlog 2\u03c0 + \u03b3 +\n\nX\np\n\nX\np|a\n\n2\n\n\uf8f6\n\np log p\n\uf8f8,\n(p \u2212 1)(p2 \u2212 p + 1)\n\n!\nlog p\n+1 .\np(p \u2212 1)\n\nWe will denote by \u03c9(a) \u0010the number\nof distinct prime factors of a. Note that provided\n\u0011\nP\nx\nx \u03c6(a)\nterms in the sum over 1 \u2264 q \u2264 x/M\n0 6= |a| \u2264 x and d|a 1 = o M a , there are \u223c \u03c6(a)\na M\nwith the condition (q, a) = 1.\nThe results of Theorem 1.1 become worse as M gets smaller. The reason for this is that\nwhen M = O(1) (that is the relevant arithmetic progressions have bounded length), the\nestimates become dramatically different. This case is handled in the next Proposition.\nProposition 3.2. Fix A and \u03bb < 41 , two positive real numbers. For a in the range 0 < |a| \u2264\nx\u03bb such that \u03c9(a) \u2264 10 log log x we have\n\u0013\n\u0012\n\u0013\nX \u0012\n\u03c8(x)\n1\na\n1\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n=\nC3 (a) + OA,\u03bb\n.\n(3)\n\u03c6(a)\n\u03c6(q)\n\u03c6(a)\n(log x)A\nx q\u2264x\na\n(q,a)=1\n\nMore generally, for M \u2265 1 a fixed integer we have\n\u0013\n\u0012\n\u0013\nX \u0012\n1\n1\n\u03c8(x)\n\u2032\n= \u03bc (a, M) + OA,\u03bb\n,\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n\u03c6(a) x\n\u03c6(q)\n(log x)A\nx\na\n\nM\n\n(4)\n\nq\u2264 M\n(q,a)=1\n\nwhere\n!\n\u0011\nX 1 \u0010\nr\na\n1\u2212\n.\n\u03bc\u2032 (a, M) :=\nM C1 (a) log M + C3 (a) \u2212\n\u03c6(a)\n\u03c6(r)\nM\nr\u2264M\n(r,a)=1\n\nNote that \u03bc\u2032 (a, 1) =\n\na\nC (a).\n\u03c6(a) 3\n\nRemark 3.3. It is possible to give such an estimate for any M \u2208 R\u22651 , however the formula\nis simpler when M is an integer, so we prefered to just include the latter case.\n3\n\n\fBy inverting the order of summation in Proposition 3.2, one gets the following corollary,\nwhich is an example of application of the results of Bombieri, Fouvry, Friedlander, Granville\nand Iwaniec (see [1], [3] and [4]).\nCorollary 3.4 (Titchmarsh's divisor problem). Fix A and \u03bb < 41 , two positive real numbers.\nFor a in the range 0 < |a| \u2264 x\u03bb such that \u03c9(a) \u2264 10 log log x we have\n\u0013\n\u0012\nX\nx\n.\n(5)\n\u039b(n)\u03c4 (n \u2212 a) = C1 (a)x log x + (2C3 (a) + C1 (a))x + OA,\u03bb\n(log x)A\n|a|<n\u2264x\n\nNote that the constant 10 in Proposition 3.2 and Corollary 3.4 can be replaced by an\narbitrarily large real number.\n\n4. Notation\nDefinition 4.1. For n 6= 0 an integer (possibly negative), we define\n\u039b(n) :=\n\n(\n\nlog p\n0\n\nif n = pe\notherwise,\n\n(\nlog p\n\u03b8(n) :=\n0\n\nX\n\n\u03b8(x; q, a) :=\n\nif n = p\notherwise.\n\nDefinition 4.2.\n\u03c8(x; q, a) :=\n\n\u039b(n),\n\nn\u2264x\nn\u2261a mod q\n\nX\n\n\u03b8(n).\n\nn\u2264x\nn\u2261a mod q\n\nThe following definition is non-standard but will be useful in the proofs.\nDefinition 4.3.\n\u03c8 \u2217 (x; q, a) :=\n\nX\n\n\u039b(n),\n\n(6)\n\nX\n\n\u03b8(n).\n\n(7)\n\n|a|<n\u2264x\nn\u2261a mod q\n\n\u03b8\u2217 (x; q, a) :=\n\n|a|<n\u2264x\nn\u2261a mod q\n\nWe will need to consider the prime divisors of a which are less than M.\nDefinition 4.4. For a an integer and M > 0 a real number, we define\nY\naM :=\np.\n\n(8)\n\np|a\np\u2264M\n\nThe error term E(M, a) will be defined depending on the context, so one has to pay\nattention to its definition in every statement.\n4\n\n\f5. Lemmas\nWe begin by recalling the divisor switching technique.\nLemma 5.1. Let a be an integer such that 0 < |a| \u2264 x and let M = M(x) such that\n1 \u2264 M < x. We have\nX\nX\nX\nX\nlog p =\nlog p + O(|a| log x).\n(9)\nx\nM\n\nx\n+a<p\u2264x\nrM\n1\u2264r<(x\u2212a) M\nx\np\u2261a\nmod r\n(r,a)=1\np>|a|\n\n<q\u2264x |a|<p\u2264x\n(q,a)=1 p\u2261a mod q\n\nProof. Clearly,\nX\n\nx\nM\n\nX\n\nlog p =\n\nX\n\nx\nM\n\n<q\u2264x |a|<p\u2264x\n(q,a)=1 p\u2261a mod q\n\nX\n\nlog p.\n\n(10)\n\n<q\u2264x |a|<p\u2264x\nq\n(q,a)=1 p\u2261a mod\nx\np>a+ M\n\nWe now apply Hooley's variant of the divisor switching technique (see [6]). Setting p \u2212a =\nrq in (10), one can sum over r instead of summing over q. Now (r, a) = 1, else (p, a) > 1 so\np | a, but this is impossible since p > |a|. Taking a > 0 for now, we get that (10) is equal to\nX\nX\nX\nX\nlog p =\nlog p.\n(11)\nx\nM\n\n<q\u2264x\u2212a |a|<p\u2264x\nq\n(q,a)=1 p\u2261a mod\nx\np>a+ M\n\nx\n+a<p\u2264x\nrM\n1\u2264r<(x\u2212a) M\nx\np\u2261a\nmod r\n(r,a)=1\np>|a|\n\nIf we had a < 0, additional terms would be needed in passing from the right hand side of\n(10) to the left hand side of (11). These additional terms are\nX\n\u226a\nlog x \u226a |a| log x.\nx<q\u2264x\u2212a\n\nThe proof is complete.\n\n\u0003\nLemma 5.2. We have the following estimates:\n\u0013\n\u0012\nX 1\n\u03c9(a) log M\n,\n= C1 (a) log M + C1 (a) + C3 (a) + O 2\n\u03c6(n)\nM\nn\u2264M\n\n(12)\n\n(n,a)=1\n\nX\n\nn\u2264M\n(n,a)=1\n\n\u0001\nn\n= C1 (a)M + O 2\u03c9(a) log M .\n\u03c6(n)\n\n(13)\n\nNote that without loss of generality, we can replace a by aM on the right side of (12) and\n(13).\nProof. The proof of (12) is very similar that of Lemma 13.1 in [5]. One first has to prove\nthe following estimate:\n\uf8eb\n\uf8f6\n\u0012 \u03c9(a) \u0013\nX\nX 1\nlog p \uf8f8\n\u03c6(a) \uf8ed\n2\n.\n(14)\n=\nlog M + \u03b3 +\n+O\nn\na\np\n\u2212\n1\nM\nn\u2264M\np|a\n\n(n,a)=1\n\n5\n\n\fOne then writes\nX\n\nn\u2264M\n(n,a)=1\n\nX 1 X \u03bc2 (d)\nX \u03bc2 (d) X 1\n1\n=\n=\n\u03c6(n)\nn\n\u03c6(d)\nd\u03c6(d)\nr\nn\u2264M\nd\u2264M\n(n,a)=1\n\nd|n\n\n(15)\n\nr\u2264M/d\n(r,a)=1\n\n(d,a)=1\n\nand inserts the estimate (14) into (15). The final step is to bound the tail of the sums and\nto compute the following constants:\n\u0012\n\u0013\nX \u03bc2 (d)\n1\n\u03b6(2)\u03b6(3) Y\n1\u2212 2\n,\n=\nd\u03c6(d)\n\u03b6(6)\np \u2212p+1\np|a\n\n(d,a)=1\n\n\u0012\n\u0013X\nX \u03bc2 (d)\nlog p\n1\n\u03b6(2)\u03b6(3) Y\n1\u2212 2\nlog d =\n.\n2\nd\u03c6(d)\n\u03b6(6)\np \u2212p+1\np \u2212p+1\n\n(d,a)=1\n\np\u2224a\n\np|a\n\nThe proof of (13) goes along the same lines.\n\n\u0003\n\nThe delicacy of the analysis forces us to give some details about the \"trivial\" estimates\nfor the prime counting functions.\nLemma 5.3. For any real number \u01eb > 0 and integer a with 0 < |a| \u2264 x,\nX\n(\u03c8 \u2217 (x; q, a) \u2212 \u03b8\u2217 (x; q, a)) \u226a\u01eb x1/2+\u01eb .\n\n(16)\n\nq\u2264x\n(q,a)=1\n\nProof.\nX\n\nq\u2264x\n(q,a)=1\n\n(\u03c8 \u2217 (x; q, a) \u2212 \u03b8\u2217 (x; q, a))\n\u2264\n\nX\n\nX\n\nq\u2264x |a|<pe \u2264x\npe \u2261a mod q\ne\u22652\n\n\u2264 log x\n\nX\n\nlog p \u2264\nX\n\nx p\u2264x1/e\n2\u2264e\u2264 log\nlog 2\n\nX\n\nx\n2\u2264e\u2264 log\nlog 2\n\nX X\n\np\u2264x1/e\n\nlog p\n\nq\u2264x\nq|pe \u2212a\n\n\u03c4 (pe \u2212 a) \u226a\u01eb x\u01eb/2\n\nX\n\n\u03c0(x1/e )\n\nx\n2\u2264e\u2264 log\nlog 2\n\n\u226a\u01eb x1/2+\u01eb .\n\u0003\nLemma 5.4. Let a be an integer with 0 6= |a| \u2264 x and let 1 \u2264 Q \u2264 x. We have\nX\n\n(\u03c8(x; q, a) \u2212 \u039b(a) \u2212 \u03c8 \u2217 (x; q, a)) = O(|a|(log |a|)2 ),\n\n(17)\n\nX\n\n(\u03b8(x; q, a) \u2212 \u03b8(a) \u2212 \u03b8\u2217 (x; q, a)) = O(|a|(log |a|)2 ).\n\n(18)\n\nq\u2264Q\n(q,a)=1\n\nq\u2264Q\n(q,a)=1\n\n6\n\n\fProof. Note that as soon as q > 2|a|, there are no integers congruent to a mod q in the\ninterval [1, |a|). We then have\nX\nX\nX\n\u039b(n)\n(\u03c8(x; q, a) \u2212 \u039b(a) \u2212 \u03c8 \u2217 (x; q, a)) =\nq\u2264Q\n1\u2264n<|a|\n(q,a)=1 n\u2261a mod q\n\nq\u2264Q\n(q,a)=1\n\n\u2264\n\nX\n\nq\u22642|a|\n(q,a)=1\n\nlog |a|\n\nX\n\n1\u2264n<|a|\nn\u2261a mod q\n\n1\u226a\n\nX\n\nq\u22642|a|\n(q,a)=1\n\n\u0012\n\n|a|\nlog |a|\nq\n\n\u0013\n\n\u226a |a|(log |a|)2 .\n\nThe proof for \u03b8 and \u03b8\u2217 is similar.\n\n\u0003\n\nLemma 5.5. Let I \u2282 [1, x] \u2229 N. We have\n\u0013\nX\u0012 x\n\u221a\n\u03c8(x)\n\u226a xe\u2212C log x ,\n\u2212\n\u03c6(q)\n\u03c6(q)\nq\u2208I\n\n(19)\n\nwhere C is an absolute positive constant.\n\nProof. This follows from Lemma 5.2 and the prime number theorem.\n\n\u0003\n\nTo prove Lemma 5.9 we will need bounds on \u03b6(s).\nLemma 5.6. Define \u03b8 :=\nwhere\n\n32\n205\n\nand take any \u01eb > 0. In the region |\u03c3 + it \u2212 1| >\n\n1\n,\n10\n\nwe have\n\n\u03b6(\u03c3 + it) \u226a\u01eb (|t| + 1)\u03bc(\u03c3)+\u01eb ,\n\n\uf8f1\n1/2 \u2212 \u03c3\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f21/2 + (2\u03b8 \u2212 1)\u03c3\n\u03bc(\u03c3) =\n\uf8f4\n2\u03b8(1 \u2212 \u03c3)\n\uf8f4\n\uf8f4\n\uf8f3\n0\n\nif\nif\nif\nif\n\n\u03c3\u22640\n0 \u2264 \u03c3 \u2264 1/2\n1/2 \u2264 \u03c3 \u2264 1\n\u03c3 \u2265 1.\n\nProof. For the values outside the critical strip, see for example section II.3.4 of [8]. In the\ncritical strip, we use an estimate due to Huxley [7], which showed that \u03b6(1/2 + it) \u226a\u01eb\n32\n(|t| + 1) 205 +\u01eb . The lemma then follows by convexity of \u03bc.\n\u0003\nRemark 5.7. Under Lindel\u00f6f's hypothesis, the conclusion of Lemma 5.6 holds with \u03b8 = 0.\nLemma 5.8 (Perron's formula). Let 0 < \u03ba < 1, y > 0 and define\n(\n0\nif 0 < y < 1\nh(y) :=\n1\n1 \u2212 y if y \u2265 1.\nWe have\n\nZ\nys\n1\nds.\nh(y) =\n2\u03c0i (\u03ba) s(s + 1)\nMoreover, for T \u2265 1 and positive y 6= 1, we have the estimate\n\u0013\n\u0012\nZ \u03ba+iT\n1\nys\ny\u03ba\nh(y) =\n.\nds + O\n2\u03c0i \u03ba\u2212iT s(s + 1)\nT 2 | log y|\n7\n\n\fFinally, for y = 1,\n1\n0 = h(1) =\n2\u03c0i\n\nZ\n\n\u03ba+iT\n\n\u03ba\u2212iT\n\nds\n+O\ns(s + 1)\n\n\u0012 \u0013\n1\n.\nT\n\nProof. The first assertion is an easy application of the residue theorem.\nNow take y > 1. We have again by the residue theorem that for any large integer K \u2265 3\nand for T \u2265 1,\n1\n2\u03c0i\n\nZ\n\n\u03ba+iT\n\n\u03ba\u2212iT\n\n\u0012Z \u03ba\u2212K\u2212iT Z \u03ba\u2212K+iT Z \u03ba+iT \u0013\n1\nys\nys\nds \u2212 h(y) =\n+\nds\n+\ns(s + 1)\n2\u03c0i\ns(s + 1)\n\u03ba\u2212iT\n\u03ba\u2212K\u2212iT\n\u03ba\u2212K+iT\nZ \u03ba\nZ \u03ba\u2212K+iT\n1\ny \u03ba\u2212K\ny \u03ba\u2212K\ny\u03ba\n\u03c3\n\u226a 2\n+\nT\n.\ny d\u03c3 +\n|ds|\n\u226a\nT \u03ba\u2212K\n|\u03ba \u2212 K|2 \u03ba\u2212K\u2212iT\nT 2 | log y|\n|\u03ba \u2212 K|2\n\nWe deduce the second assertion of the lemma by letting K tend to infinity. The proof is\nsimilar in the case 0 < y < 1.\nThe last case remaining is for y = 1. We have\n1\n2\u03c0i\n\nwhich concludes the proof.\n\nZ\n\n\u03ba+iT\n\n\u03ba\u2212iT\n\nds\n1\n=\nlog\ns(s + 1)\n2\u03c0i\n\n1+\n\n1\n\u03ba\u2212iT\n1\n\u03ba+iT\n\n!\n\n1+\n\u0012\n\u0012 \u0013\u0013\n1\n1\nlog 1 + O\n=\n2\u03c0i\nT\n\u0012 \u0013\n1\n=O\n,\nT\n\u0003\n\nThe following is a crucial lemma estimating a weighted sum of the reciprocal of the totient\nfunction.\nLemma 5.9. Let a 6= 0 be an integer and M \u2265 1 be a real number.\nIf \u03c9(aM ) \u2265 1,\nX 1 \u0010\nn\u0011\n\u03c6(aM ) \u039b(aM )\n1\u2212\n= C1 (aM ) log M + C3 (aM ) +\n+ E(M, a).\n\u03c6(n)\nM\na\n2M\nM\nn\u2264M\n\n(20)\n\n(n,a)=1\n\nIf aM = 1,\nX\n\nn\u2264M\n(n,a)=1\n\nn\u0011\n1 log M\nC5\n1 \u0010\n1\u2212\n= C1 (1) log M + C3 (1) +\n+\n+ E(M, a).\n\u03c6(n)\nM\n2 M\nM\n\nThere exists \u03b4 > 0 such that the error term E(M, a) satisfies\n\u0010\n\u0011\nQ\n1\n\u0010 a \u0011 205\n1\n+\n\u2212\u01eb\np|aM\np\u03b4\nM 538\n.\nE(M, a) \u226a\u01eb\nM\nM\n8\n\n(21)\n\n(22)\n\n\fRemark 5.10. Under Lindel\u00f6f's hypothesis,\n\u0010\nQ\np|aM\n\nE(M, a) \u226a\u01eb\n\n1+\n\n1\np\u03b4\n\nM\n\n\u0011\n\n\u0010 a \u00111/2\u2212\u01eb\nM\n\nM\n\n(23)\n\n.\n\nProof. Note first that we need only to consider the prime factors of a less than or equal to\nM, since for 1 \u2264 n \u2264 M, (n, a) = 1 \u21d4 (n, aM ) = 1.\nTo calculate our sum we will write it as a contour integral and shift contours, showing\nthat the contribution of the shifted contours is negligible and obtaining the main terms from\nthe residues at the poles.\nSetting \u03ba = log1M in Lemma 5.8,\nX\n\nn\u2264M\n(n,a)=1\n\n1 \u0010\nn\u0011\n1\u2212\n=\n\u03c6(n)\nM\n=\n\nX\n\n(n,aM )=1\n\nX\n\n(n,aM )=1\n\n1 1\n\u03c6(n) 2\u03c0i\n\nZ\n\n1\nh\n\u03c6(n)\n\n\u03ba+iT\n\n\u03ba\u2212iT\n\n\u0012\n\nM\nn\n\n\u0012\n\n\u0013s\n\nM\nn\n\n\u0013\n\nds\ns(s + 1)\n\n\u0012 \u0013\u03ba\nM\nlog M\n1\n1 X\n+\n+O\n2\nT\n\u03c6(n)| log M/n| n\nTM\nn6=M\n\uf8f6\n\uf8eb\n\u0012 \u0013\nZ \u03ba+iT\ns\nX\n1\nM\n1\n1\n\uf8f8\n\uf8ed\n.\nds\n+\nO\n=\nM\n2\u03c0i \u03ba\u2212iT\nns \u03c6(n) s(s + 1)\nT\n\n!\n\n(24)\n\n(n,aM )=1\n\nIn the last step we used the elementary estimates\nX\n\nn\u2264M\n\n1\n\u226a log M\n\u03c6(n)\n\nand\n\nX\n\n1\n\nn>M\n\nn\u03ba \u03c6(n)\n\n\u226a log M.\n\nNow taking Euler products we compute that\nX\n\n(n,aM )=1\n\n1\nns \u03c6(n)\n\n= SaM (s)\u03b6(s + 1)\u03b6(s + 2)Z(s)\n\n(25)\n\n\u0013\u0012\n\u0013\u22121\n1\n1+\n1 \u2212 s+1\np\n(p \u2212 1)ps+1\n\n(26)\n\nwhere\nSaM (s) :=\n\nY\u0012\n\np|a\np\u2264M\n\n1\n\nand\nZ(s) :=\n\nY\u0012\np\n\n1\n1+\np(p \u2212 1)\n9\n\n\u0012\n\n1\nps+1\n\n\u2212\n\n1\np2s+2\n\n\u0013\u0013\n\n,\n\n(27)\n\n\fwhich converges for Rs > \u22123/2. Therefore, (24) becomes\nX\n\nn\u2264M\n(n,a)=1\n\n1 \u0010\nn\u0011\n1\n1\u2212\n=\n\u03c6(n)\nM\n2\u03c0i\n\nZ\n\n\u03ba+iT\n\nSaM (s)\u03b6(s + 1)\u03b6(s + 2)Z(s)\n\n\u03ba\u2212iT\n\nMs\nds\ns(s + 1)\n\u0012 \u0013\n1\n. (28)\n+ OM\nT\n\nThe different results for different values of \u03c9(aM ) come from the pole at s = \u22121. We see\nthat SaM (s) has a zero of order \u03c9(aM ) at s = \u22121 whereas\n\u03b6(s + 1)\u03b6(s + 2)\ns(s + 1)\nhas a pole of order two at s = \u22121. Hence the product has no pole if \u03c9(aM ) \u2265 2, a pole of\norder one if \u03c9(aM ) = 1, and a pole of order two if \u03c9(aM ) = 0. We now shift the contour of\n1\n32\nintegration to the left until the line R(s) = \u03c3, where \u22121 \u2212 2+4\u03b8\n< \u03c3 < \u22121 and \u03b8 := 205\n. The\nright hand side of (28) becomes\n1\n= PT +\n2\u03c0i\n\nZ\n\n\u03c3+iT\n\n\u03c3\u2212iT\n\nMs\nSaM (s)\u03b6(s + 1)\u03b6(s + 2)Z(s)\nds\ns(s + 1)\n\u0012\n\u0013\u0013\n\u0012\n\u0012 \u0013\n(log T )2\nT 1/2\nT 7/6\n1\n1/6\n+ Oa\n. (29)\nT + 1/2 +\n+ OM\nT\nT2\nM\nM\n\nHere, PT denotes the sum of all residues in the box \u03c3 \u2264 Rs \u2264 log1M and |Is| \u2264 T . The\nsecond error term in (29) comes from the horizontal integrals which we have bounded using\nLemma 5.6 (note that \u03b8 < 1/6). Taking T \u2192 \u221e yields\nX\n\nn\u2264M\n(n,a)=1\n\nn\u0011\n1 \u0010\n1\u2212\n= P\u221e + E(M, a),\n\u03c6(n)\nM\n\n(30)\n\nwhere\n1\nE(M, a) :=\n2\u03c0i\n\nZ\n\nSaM (s)\u03b6(s + 1)\u03b6(s + 2)Z(s)\n\n(\u03c3)\n\nMs\nds.\ns(s + 1)\n\nNow on the line Rs = \u03c3 we have the bound (note that 0 < \u22121 \u2212 \u03c3 <\nSaM (s) \u226a\n\n\u22121\u2212\u03c3\naM\n\nY\u0012\n\np|aM\n\n10\n\n1\n1+ \u03b4\np\n\n\u0013\n\n,\n\n1\n)\n2+4\u03b8\n\n\ffor some \u03b4 > 0. Combining this with Lemma 5.6 yields\n\u0013\nZ \u221e\nY\u0012\n1\nM\u03c3\n\u22121\u2212\u03c3\n1 + \u03b4 aM\nE(M, a) \u226a\u03c3\ndt\n|\u03b6(\u03c3 + 1 + it)||\u03b6(\u03c3 + 2 + it)|\np\n(|t| + 1)2\n\u2212\u221e\np|aM\n\u0010\n\u0011\nQ\n1\n\u0010 a \u0011\u22121\u2212\u03c3 Z \u221e (|t| + 1)1/2\u2212(\u03c3+1) (|t| + 1)2\u03b8(1\u2212(\u03c3+2))\n1\n+\np|aM\np\u03b4\nM\n(31)\n\u226a\ndt\n2\nM\nM\n(|t|\n+\n1)\n\u2212\u221e\n\u0010\n\u0011\nQ\n1\n\u0010 a \u0011\u22121\u2212\u03c3\np|aM 1 + p\u03b4\nM\n,\n\u226a\u03c3\nM\nM\nsince 1/2 \u2212 (\u03c3 + 1) + 2\u03b8(1 \u2212 (\u03c3 + 2)) < 1 by our choice of \u03c3. The claimed bound on E(M, a)\n1\nthen follows by taking \u03c3 := \u22121 \u2212 2+4\u03b8\n+ \u01eb in (31).\nIt remains to compute P\u221e which is the sum of the residues of SaM (s)\u03b6(s + 1)\u03b6(s +\nMs\nin the region \u03c3 \u2264 Rs \u2264 log1M . Note that SaM (s) has poles on the lines\n2)Z(s) s(s+1)\n\nRs = \u22121 \u2212 log(p\u22121)\n, however these poles are cancelled by the zeros of Z(s). Thus the\nlog p\nMs\nonly possible singularities of SaM (s)\u03b6(s + 1)\u03b6(s + 2)Z(s) s(s+1)\nin the region in question are\nat the points s = 0 and s = \u22121.\nNow a lengthy but straightfoward computation shows that we have a double pole at s = 0\nwith residue equal to C1 (aM ) log M + C3 (aM ).\nAs for s = \u22121, we have to consider three cases.\nIf \u03c9(aM ) \u2265 2, then SaM (s) = O((s + 1)2 ) around s = \u22121, so SaM (s)\u03b6(s + 1)\u03b6(s +\nMs\nis holomorphic and we don't have any residue.\n2)Z(s) s(s+1)\nIf \u03c9(aM ) = 1, then SaM (s) has a simple zero at s = \u22121 and thus SaM (s)\u03b6(s + 1)\u03b6(s +\nMs\nM ) \u039b(aM )\n2)Z(s) s(s+1)\nhas a simple pole with residue equal to \u03c6(a\n.\naM\n2M\nMs\nhas a\nFinally, if aM = 1, then SaM (s) \u2261 1 and thus SaM (s)\u03b6(s + 1)\u03b6(s + 2)Z(s) s(s+1)\ndouble pole at s = \u22121 with residue equal to\n\n1 log M\n2 M\n\n+\n\nC5\n.\nM\n\n\u0003\n\n6. Further results and proofs\nWe will start by giving the fundamental result of this paper which works for M fixed as\nwell as for M varying with x under the condition M \u2264 (log x)O(1) .\nProposition 6.1. Fix A > B > 0 and \u03bb < 14 , three positive real numbers. Let M = M(x)\nbe an integer such that 1 \u2264 M(x) \u2264 (log x)B . For a in the range 0 < |a| \u2264 x\u03bb we have that\n!\n\u0013\nX \u0012\nX 1 \u0010\n\u03c8(x)\nr \u0011\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n= x C1 (a) log M + C3 (a) \u2212\n1\u2212\n\u03c6(q)\n\u03c6(r)\nM\nx\nr\u2264M\nq\u2264 M\n(q,a)=1\n\n(r,a)=1\n\n+ OA,B,\u03bb\n\n\u0012\n\nx\n\u03c6(a) \u03c9(a)\n2\na\n(log x)A\n\n\u0013\n\n. (32)\n\nWe can remove the condition of M being an integer at the cost of adding the error term\nO(x log log M/M 2 ).\n11\n\n\fProof. We will prove that\nX \u0012\n\nx\nq\u2264 M\n(q,a)=1\n\nx\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n\u03c6(q)\n\n\u0013\n\n= x C1 (a) log M + C3 (a) \u2212\n+ OA,B,\u03bb\n\nX\n\nr\u2264M\n(r,a)=1\n\n\u0012\n\n1 \u0010\nr \u0011\n1\u2212\n\u03c6(r)\nM\n\nx\n\u03c6(a) \u03c9(a)\n2\na\n(log x)A\n\n\u0013\n\n!\n\n. (33)\n\nFrom this we can deduce the proposition since by Lemma 5.5 the difference between the left\nhand side of (32) and that of (33) is negligible.\nDefine L := (log x)A+3 . Partitioning the sum into dyadic intervals and applying Theorem\n2.1 gives\n\u0013\n\u0012\n\u0013\nX \u0012\nx\nx\n\u03c9(a)\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n= OA,\u03bb 2\n.\n(34)\n\u03c6(q)\n(log x)A+1\nx\nq\u2264 L\n(q,a)=1\n\nTherefore, we need to compute\nX \u0012\nx\nx\n<q\u2264 M\nL\n\n\u0013\nx\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n,\n\u03c6(q)\n\n(q,a)=1\n\nwhich by lemmas 5.3 and 5.4 is equal to\n\u0013\nX \u0012\nx\n\u2217\n+ O(x2/3 + |a|(log |a|)2 ).\n\u03b8 (x; q, a) \u2212\n\u03c6(q)\nx\nx\n\n(35)\n\n<q\u2264 M\n(q,a)=1\n\nL\n\nWe split the sum in (35) in three distinct sums as following:\nX\nX\nX\n1\n= I \u2212 II \u2212 III.\n\u03b8\u2217 (x; q, a) \u2212\n\u03b8\u2217 (x; q, a) \u2212 x\nx\nx\nx\nx \u03c6(q)\n<q\u2264x\nL\n(q,a)=1\n\n<q\u2264x\n(q,a)=1\n\n<q\u2264 M\n(q,a)=1\n\nM\n\nL\n\nThe third sum is easily treated using Lemma 5.2:\nIII = x\n\nX\n\nx\nx\n<q\u2264 M\nL\n\n\u0013\n\u0012\n1\n\u03c9(a) log(x/M)\n= x C1 (a) log(x/M) + C1 (a) + C3 (a) + O 2\n\u03c6(q)\nx/M\n\n(q,a)=1\n\n\u0012\n\u0013\u0013 !\nlog(x/L)\n\u2212 C1 (a) log(x/L) + C1 (a) + C3 (a) + O 2\u03c9(a)\nx/L\n\u0012\n\n\u0001\n= C1 (a)x log(L/M) + O 2\u03c9(a) L log x . (36)\n\nFor the first sum, we have\nI=\n\nX\n\n\u03b8\u2217 (x; q, a) =\n\nX\n\nx\n<q\u2264x\nL\n\nx\n<q\u2264x\nL\n\nX\n\n|a|<p\u2264x\n(q,a)=1 p\u2261a mod q\n\n(q,a)=1\n\n12\n\nlog p.\n\n\fUsing Lemma 5.1,\nX\nI=\n\nX\n\nlog p + O(|a| log x)\n\nr x +a<p\u2264x\n1\u2264r<(x\u2212a) L\nx L\np\u2261a mod r\np>|a|\n\n(r,a)=1\n\n=\n\nX\n\n1\u2264r<(x\u2212a) L\nx\n(r,a)=1\n\n=\n\nX\n\n1\u2264r<L\u2212a L\nx\n\n\u0010\n\n\u0012\n\n\u0010 x\n\u0011\u0011\n\u03b8\u2217 (x; r, a) \u2212 \u03b8\u2217 r + a; r, a + O(x1/3 )\nL\n\nx\nrx\n\u2212\n\u03c6(r) \u03c6(r)L\n\n\u0013\n\n2\n\n+ O(|a|L(log x) ) + OA\n\n\u0012\n\nx\nL\nL(log x)A+1\n\n\u0013\n\n.\n\n(r,a)=1\n\nIn the last step we used Lemma 5.4 (with |a| < x\u03bb ) combined with the Siegel-Walfisz theorem\nP\n|a|\nx\n\u226aA L(logxx)A+1 for r \u2264 2L, as well as the estimate r\u2264R \u03c6(r)\n\u226a\nin the form \u03b8(x; r, a) \u2212 \u03c6(r)\nL\n|a| log R. As a x \u2264 1 for x large enough and \u03c6(r) \u226b r/ log log r, this gives\n\u0012\n\u0013\n\u0013\n\u0012\nX 1 \u0010\nr\u0011\nx\nx log log L\n1\u2212\n+ OA\n+O\nI =x\nA+1\n\u03c6(r)\nL\n(log\nx)\nL\nr<L\n(r,a)=1\n\nX\n\n=x\n\nr<L\n(r,a)=1\n\n1 \u0010\nr\u0011\n1\u2212\n+ OA\n\u03c6(r)\nL\n\n\u0012\n\nx\n(log x)A+1\n\n\u0013\n\n.\n\nWe conclude the evaluation of I by applying Lemma 5.2:\n\u0013\u0013\n\u0012\n\u0012\n2\u03c9(a)\n.\nI = x C1 (a) log L + C3 (a) + OA\n(log x)A+1\n\n(37)\n\nNow with a similar computation using lemmas 5.1 and 5.4 as well as the Siegel-Walfisz\nx\ntheorem in the form \u03b8(x; r, a) \u2212 \u03c6(r)\n\u226aA,B M (logxx)A+1 for r \u2264 2M, we show that\n\u0010 x\n\u0010\n\u0011\u0011\nX\n\u2217\n\u2217\n\u03b8 (x; r, a) \u2212 \u03b8 r\nII =\n+ a, r, a + O(|a| log x)\nM\nM\n1\u2264r<(x\u2212a)\n(r,a)=1\n\n=\n\nX\n\nx\n\n1\u2264r<M \u2212a M\nx\n(r,a)=1\n\n=x\n\nX\n\n1\u2264r\u2264M\n(r,a)=1\n\n\u0012\n\nx\nrx\n\u2212\n\u03c6(r) \u03c6(r)M\n\n\u0013\n\n\u0012\n+ O(|a|M(log x) ) + OA,B M\n\nr \u0011\n1 \u0010\n1\u2212\n+ OA,B\n\u03c6(r)\nM\n\n2\n\n\u0012\n\nx\n(log x)A+1\n\n\u0013\n\nx\nM(log x)A+1\n\n\u0013\n\n.\n\nIn the last step we have used that M is an integer so the term for r = M in\n\u0010 the sum\n\u0011 is\n\u0001\n\u230aM \u230b\n1\nM\nx\ngiven by \u03c6(M ) 1 \u2212 M = 0. If M \u2208\n/ N, we have to add the error term \u03c6(\u230aM \u230b) 1 \u2212 M =\n\nO(x log log M/M 2 ).\nWe conclude the proof by combining our estimates for I, II and III with the bound\na\n\u226a log log x.\n\u0003\n\u03c6(a)\n13\n\n\fProof of Proposition 3.2. Follows from Proposition 6.1.\n\n\u0003\n\nFor M not necessarily fixed, we will need to use Lemma 5.9.\nTheorem 6.2. Let M = M(x) \u2264 (log x)B (not necessarily an integer) where B > 0 is a\nfixed real number. Fix \u03bb < 41 a positive real number, and let a 6= 0 be an integer such that\n|a| \u2264 x\u03bb .\nIf \u03c9(aM ) \u2265 1,\n\u0013\nX \u0012\n1\n1\n\u03c8(x)\n= \u2212 \u039b(aR ) + E(M, a).\n(38)\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n\u03c6(a) x\n\u03c6(q)\n2\nx\na\n\nM\n\nq\u2264 M\n(q,a)=1\n\nIf aM = 1,\n1\n\u03c6(a) x\na M\n\n\u0013\nX \u0012\n\u03c8(x)\n1\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n= \u2212 log M \u2212 C5 + E(M, a).\n\u03c6(q)\n2\nx\n\nq\u2264 M\n(q,a)=1\n\nUnder the assumption that\nE(M, a) \u226aa,\u01eb,B\n\n(39)\n\n1\np|a p\np>M\n\nP\n\n\u2264 1, the error term E(M, a) satisfies, for some \u03b4 > 0,\n\n\u0012\n\u0013\n205\nX log p\n\u2212\u01eb\n1 \u0010 aM \u0011 538\na Y\n1+ \u03b4\n+ M log M\n\u03c6(a)\np\nM\np\np|a\np>M\n\np|aM\n\n+\n\na log log M\n2\u03c9(a)\n+\n. (40)\n(log x)B+1 \u03c6(a)\nM\n\nRemark 6.3. If we assume Lindel\u00f6f's\nhypothesis, we can replace the first term of the right\n\u0010\n\u0011\n\u00011/2\u2212\u01eb\nQ\na\n1\nhand side of (40) by \u03c6(a) p|aM 1 + p\u03b4 aMM\n.\nProof of Theorem 6.2. Our starting point will be to set A := 2B + 1 in Proposition 6.1:\n!\n\u0013\nX 1 \u0010\nX \u0012\nr \u0011\n\u03c8(x)\n= x C1 (a) log M + C3 (a) \u2212\n1\u2212\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n\u03c6(q)\n\u03c6(r)\nM\nx\nr\u2264M\nq\u2264 M\n(q,a)=1\n\n(r,a)=1\n\n+ OB\n\n\u0012\n\n\u03c9(a)\n\n\u03c6(a) x\n2\nlog log M\n+x\nB+1\na M (log x)\nM2\n\n\u0013\n\n. (41)\n\nWe now consider three cases depending on the number of prime factors of aM .\nCase 1: \u03c9(aM ) \u2265 2, which implies \u03c9(a) \u2265 2. Applying Lemma 5.9 gives\n\u0013\n\u0010\nX \u0012\n\u03c8(x)\n\u226aB x |C1 (aM ) \u2212 C1 (a)| log M + |C3 (aM ) \u2212 C3 (a)|\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n\u03c6(q)\nx\nq\u2264 M\n(q,a)=1\n\n+\n\nQ\n\np|aM\n\n\u0010\n1+\n\nM\n\n1\np\u03b4\n\n\u0011\n\n\u0010 a \u0011 205\n\u2212\u01eb \u0011\n538\nM\n\nM\n\n14\n\n+\n\n2\u03c9(a)\nlog log M\n\u03c6(a) x\n+x\n. (42)\nB+1\na M (log x)\nM2\n\n\fIf all the prime factors of a are less than or equal to M, then |Ci (aM ) \u2212 Ci (a)| = 0. If not,\nwe need upper bounds. By the definition of C1 (a),\n!\n\u0013\u22121 \u0012\n\u0013\u22121\nY\u0012\n1\n1\n1\u2212\n|C1 (aM ) \u2212 C1 (a)| = C1 (a)\n1\u2212 2\n\u22121\np\np \u2212p+1\np|a\np>M\n\n\u226a\nas long as\n\n1\np|a p\np>M\n\nP\n\n\u03c6(a) X 1\n,\na\np\np|a\np>M\n\n\u2264 1. Moreover,\n!\n\u0010 \u03c6(a) X 1 \u0011 C (a )\n3 M\nC1 (a) + O\n\u2212 C3 (a)\na\np\nC1 (aM )\n\nC3 (aM ) \u2212 C3 (a) =\n\np|a\np>M\n\n= C1 (a)\n\nsince\n\np2 log p\np|aM (p\u22121)(p2 \u2212p+1)\n\nP\n\n\u226a\n\nP\n\np\u2264M\n\n|C3 (aM ) \u2212 C3 (a)| \u226a\n\u226a\n\n\u0012\n\nC3 (aM ) C3 (a)\n\u2212\nC1 (aM ) C1 (a)\n\nlog p\np\n\n\u0013\n\n\u03c6(a) X log M\n+O\na\np\np|a\np>M\n\n!\n\n,\n\n\u226a log M. Thus,\n\n\u03c6(a) X\np2 log p\n\u03c6(a) X log M\n+\na\n(p \u2212 1)(p2 \u2212 p + 1)\na\np\np|a\np>M\n\np|a\np>M\n\n\u03c6(a) X log p\n.\na\np\np|a\np>M\n\nx \u03c6(a)\nPutting all this together and dividing by M\ngives the claimed estimate.\na\nCase 2: \u03c9(aM ) = 1. The calculation is similar, however Lemma 5.9 gives a contribution\nof\n!\nX1\n1\n1 a \u03c6(aM )\n,\n\u039b(aM ) = \u2212 \u039b(aM ) + O log M\n\u2212\n2 \u03c6(a) aM\n2\np\np|a\np>M\n\nsince \u039b(aM ) \u2264 log M.\nCase 3: aM = 1. The contribution of\n!\n\u0012\n\u0013\nX\na\n1\n1\n1\n\u2212 log M \u2212 C5 = \u2212 log M \u2212 C5 + O log M\n\u03c6(a)\n2\n2\np\np|a\np>M\n\ncomes from Lemma 5.9.\n\u0003\nRemark 6.4. One can give an complex analytic explanation of why the main terms all\ncancel out in the proofs of Proposition 6.1 and Theorem 6.2. Indeed, it amounts to the fact\n15\n\n\fthat the Mellin transform\n\u03c8(s) :=\n\nLs \u2212 M s \u0010 x \u0011s \u0010 x \u0011s\n+\n\u2212\ns+1\nL\nM\n\nhas a double zero at s = 0 (see the proof of Proposition 5.1 of [2]).\nProof of Theorem 1.1. It is a particular case of Theorem 6.2. The theorem is trivial if M is\nbounded. For M tending to infinity with x, we have that aM = a for x large enough, since\n205\n\u0003\na is fixed. Hence, the error term in Theorem 6.2 satisfies E(M, a) \u226aa,\u01eb,B M \u2212 538 +\u01eb .\n7. Concluding remarks\nRemark 7.1. One could ask if the results of Theorem 1.1 are intrinsic to the sequence of\nprime numbers or if they are just a result of the weight \u039b(n) in the prime counting functions.\nHowever one can see that if we replace \u03c8(x; q, a) by \u03c0(x; q, a) and \u03c8(x) by \u03c0(x), the proof\nof Proposition 6.1 will go through with x replaced by Li(x) and an additional error term of\n\u0012\n\u0013\nlog log x\nO x\n.\n(log x)2\n(This is because in the evaluation of II in the proof of Proposition 6.1, we have for\n\n1\nlog x\n\n| log y|\n,\n(log x)2\n\n\u2264\n\na bound which cannot be improved for small\ny \u2264 1 + o(1) that Li(yx) \u2212 yLi(x) \u226a\nvalues of y.) One has to prove the analogue of Theorem 2.1 which can be done using the\nBombieri-Vinogradov theorem and a very delicate summation by parts. We conclude that\nan analogue\nof\u0011Theorem 1.1 holds with the natural prime counting functions in the range\n\u0010\nlog x\nM = o log log x .\nTheorem 7.2. Fix an integer a 6= 0 and \u01eb > 0. If M = M(x) is such that M = o\nthen\n1\n\u03c6(a) Li(x)\na\nM\n\n\u0010\n\nlog x\nlog log x\n\n\u0011\n,\n\n\u0013\n\u0012\n\u0013\nX \u0012\nM log log x\n\u03b8(a) \u03c0(x)\n1\n+\n\u03c0(x; q, a) \u2212\n= \u03bc(a, M) + Oa,\u01eb\n,\n\u2212\n205\nlog a \u03c6(q)\nlog x\nM 538 \u2212\u01eb\nx\n\nq\u2264 M\n(q,a)=1\n\nwhere \u03bc(a, M) is defined as in Theorem 1.1.\nRemark 7.3. Using Theorem 6.2, one can show that Theorem 1.1 holds for many (not\nnecessarily fixed) values of a:\nTheorem 7.4. Fix B, \u03bb < 14 and \u03b7 \u2264 15 , three positive real numbers. We have for M \u2264\n(log x)B that the proportion of integers a in the range 0 < |a| \u2264 x\u03bb for which\n\u0013\n\u0012\n\u0013\nX \u0012\n1\n\u03c8(x)\n1\n= OB,\u03bb\n(43)\n\u03c8(x; q, a) \u2212\n\u03c6(a) x\n\u03c6(q)\nM\u03b7\nx\na\n\nis at least\n\n1\u2212 21\n\u03b7 \u2212\u03b3\n8\ne ,\n1+\u03b7+\u03b72\n\nM\n\nq\u2264 M\n(q,a)=1\n\nwhere \u03b3 is the Euler-Mascheroni constant.\n16\n\n\fWe now sketch an argument showing that the proportion of integers a \u2264 x\u03bb for which the\nfirst term of the right hand side of (40) is \u2264 1 is not more than e\u2212\u03b3 . Setting X := x\u03bb and\nusing that M \u226a (log X)O(1) , we compute\nn\n\u0010a Y \u0011\nn\no\no\nY\nX\n# a \u2264 X : n | a,\n# a\u2264X :\np\u2264M =\np =1 ,\n,\nn p\u2264M\nn\u2264M\np|a\np\u2264M\n\n\u03bc2 (n)=1\n\np\u2224n\n\nwhich by the fundamental lemma of the combinatorial sieve is\n\u0013\nX X Y\u0012\n1\nXe\u2212\u03b3 X \u03bc2 (n)\n1\u2212\n\u223c\n\u223c\n\u223c Xe\u2212\u03b3 .\nn\np\nlog\nM\n\u03c6(n)\np\u2264M\nn\u2264M\nn\u2264M\n\u03bc2 (n)=1\n\np\u2224n\n\nTherefore, to extend the proportion of integers a for which we get an admissible error term\nin Theorem 7.4, one would need to improve the bound (40) for E(M, a).\nIt would be interesting to either extend this proportion to 1, or to show that this is\nimpossible, that is to show that that the left hand side of (43) is \u03a9(1) for a positive proportion\nof a in the range 0 < |a| \u2264 x\u03bb .\n\nx\nRemark 7.5. If we consider dyadic sums, that is we sum over the moduli 2M\n< q \u2264 Mx with\n(q, a) = 1 as in (44), then we can improve the range of a in our results to |a| \u2264 (logxx)C for\na large enough constant C, since in this case we do not need to appeal to Theorem 2.1. (It\n1\n1\nwas already remarked by the authors in [4] that if Q is not in the interval [x 2 \u2212\u01eb , x 2 +\u01eb ], then\nTheorem 2.1 holds in a much wider range of a.)\n\nRemark 7.6. If we assume GRH and we use dyadic intervals, then we can improve the\n1\nrange of M in Theorem 1.1. Indeed we can show that for M = M(x) = o(x 4 / log x) and for\nany \u01eb > 0,\n\u0013\nX \u0012\n1\n\u03c8(x)\n\u03c8(x; q, a) \u2212 \u039b(a) \u2212\n= 2\u03bc(a, M) \u2212 \u03bc(a, 2M)\n\u03c6(a) x\n\u03c6(q)\nx\nx\na\n\n2M\n\n<q\u2264 M\n(q,a)=1\n\n2M\n\n\u0013\nM2\n1\n2\n+ Oa,\u01eb \u221a (log x) + 1 \u2212\u01eb . (44)\nx\nM2\nIf we assume Montgomery's hypothesis, then we can show that the error term in (44) is o(1)\n1\nfor M \u2264 x 3 \u2212\u01eb , for any fixed \u01eb > 0.\n\u0012\n\nRemark 7.7. What the proof of Theorem 1.1 boils down to is the distribution of primes in\narithmetic progressions, rather than depending on the primes themselves. For this reason,\none can generalize Theorem 1.1 to many arithmetic sequences that are well distributed in\narithmetic progressions. This will be done in a forthcoming article [2].\nReferences\n[1] Enrico Bombieri, John B. Friedlander and Henryk Iwaniec, Primes in arithmetic progressions to large\nmoduli. Acta Math. 156 (1986), no. 3-4, 203\u2013251.\n[2] Daniel Fiorilli, The influence of the first term of an arithmetic progression, preprint.\nhttp://arxiv.org/abs/1104.2542.\n[3] \u00c9tienne Fouvry, Sur le probl\u00e8me des diviseurs de Titchmarsh. J. Reine Angew. Math. 357 (1985), 51\u201376.\n17\n\n\f[4] John B. Friedlander, Andrew Granville, Relevance of the residue class to the abundance of primes.\nProceedings of the Amalfi Conference on Analytic Number Theory (Maiori, 1989), 95\u2013103, Univ. Salerno,\nSalerno, 1992.\n[5] John B. Friedlander, Andrew Granville, Adolf Hildebrand, Helmut Maier, Oscillation theorems for\nprimes in arithmetic progressions and for sifting functions. J. Amer. Math. Soc. 4 (1991), no. 1, 25\u201386.\n[6] Christopher Hooley, On the Barban-Davenport-Halberstam theorem. I. Collection of articles dedicated\nto Helmut Hasse on his seventy-fifth birthday, III. J. Reine Angew. Math. 274/275 (1975), 206\u2013223\n[7] Martin N. Huxley, Exponential sums and the Riemann zeta function. V. Proc. London Math. Soc. (3)\n90 (2005), no. 1, 1\u201341.\n[8] G\u00e9rald Tenenbaum, Introduction \u00e0 la th\u00e9orie analytique et probabiliste des nombres. Deuxi\u00e8me \u00e9dition,\nCours Sp\u00e9cialis\u00e9s, 1. Soci\u00e9t\u00e9 Math\u00e9matique de France, Paris, 1995. xv+457 pp.\nD\u00e9partement de math\u00e9matiques et de statistique, Universit\u00e9 de Montr\u00e9al, CP 6128, succ.\nCentre-ville, Montr\u00e9al, QC, Canada H3C 3J7\nE-mail address: fiorilli@dms.umontreal.ca\n\n18\n\n\f"}