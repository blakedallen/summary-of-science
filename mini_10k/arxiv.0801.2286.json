{"id": "http://arxiv.org/abs/0801.2286v1", "guidislink": true, "updated": "2008-01-15T15:35:20Z", "updated_parsed": [2008, 1, 15, 15, 35, 20, 1, 15, 0], "published": "2008-01-15T15:35:20Z", "published_parsed": [2008, 1, 15, 15, 35, 20, 1, 15, 0], "title": "Adjoint Computation for Hypersurfaces Using Formal Desingularizations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.1119%2C0801.0652%2C0801.2652%2C0801.0152%2C0801.0585%2C0801.2463%2C0801.2834%2C0801.4360%2C0801.4874%2C0801.0950%2C0801.3116%2C0801.3694%2C0801.1337%2C0801.2357%2C0801.4508%2C0801.2984%2C0801.4575%2C0801.3916%2C0801.0928%2C0801.1410%2C0801.4905%2C0801.1882%2C0801.2141%2C0801.4598%2C0801.1684%2C0801.3484%2C0801.1772%2C0801.2410%2C0801.0704%2C0801.2215%2C0801.4272%2C0801.0065%2C0801.2286%2C0801.3831%2C0801.4565%2C0801.0772%2C0801.0016%2C0801.4201%2C0801.3619%2C0801.3659%2C0801.2227%2C0801.2003%2C0801.1028%2C0801.2688%2C0801.2785%2C0801.3872%2C0801.3419%2C0801.0479%2C0801.1045%2C0801.3765%2C0801.4812%2C0801.4241%2C0801.4580%2C0801.3727%2C0801.4520%2C0801.0165%2C0801.1273%2C0801.2295%2C0801.1877%2C0801.2478%2C0801.0223%2C0801.1795%2C0801.4760%2C0801.3002%2C0801.1332%2C0801.1695%2C0801.0736%2C0801.4055%2C0801.3588%2C0801.2565%2C0801.3426%2C0801.3225%2C0801.3090%2C0801.3574%2C0801.0679%2C0801.3041%2C0801.1931%2C0801.1338%2C0801.3135%2C0801.0262%2C0801.0171%2C0801.0402%2C0801.2461%2C0801.3543%2C0801.3628%2C0801.1447%2C0801.1027%2C0801.2944%2C0801.3532%2C0801.4456%2C0801.1617%2C0801.3366%2C0801.1009%2C0801.4395%2C0801.4806%2C0801.0381%2C0801.1011%2C0801.3432%2C0801.2991%2C0801.4095%2C0801.3712&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Adjoint Computation for Hypersurfaces Using Formal Desingularizations"}, "summary": "We show how to use formal desingularizations (defined earlier by the first\nauthor) in order to compute the global sections (also called adjoints) of\ntwisted pluricanonical sheaves. These sections define maps that play an\nimportant role in the birational classification of schemes.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.1119%2C0801.0652%2C0801.2652%2C0801.0152%2C0801.0585%2C0801.2463%2C0801.2834%2C0801.4360%2C0801.4874%2C0801.0950%2C0801.3116%2C0801.3694%2C0801.1337%2C0801.2357%2C0801.4508%2C0801.2984%2C0801.4575%2C0801.3916%2C0801.0928%2C0801.1410%2C0801.4905%2C0801.1882%2C0801.2141%2C0801.4598%2C0801.1684%2C0801.3484%2C0801.1772%2C0801.2410%2C0801.0704%2C0801.2215%2C0801.4272%2C0801.0065%2C0801.2286%2C0801.3831%2C0801.4565%2C0801.0772%2C0801.0016%2C0801.4201%2C0801.3619%2C0801.3659%2C0801.2227%2C0801.2003%2C0801.1028%2C0801.2688%2C0801.2785%2C0801.3872%2C0801.3419%2C0801.0479%2C0801.1045%2C0801.3765%2C0801.4812%2C0801.4241%2C0801.4580%2C0801.3727%2C0801.4520%2C0801.0165%2C0801.1273%2C0801.2295%2C0801.1877%2C0801.2478%2C0801.0223%2C0801.1795%2C0801.4760%2C0801.3002%2C0801.1332%2C0801.1695%2C0801.0736%2C0801.4055%2C0801.3588%2C0801.2565%2C0801.3426%2C0801.3225%2C0801.3090%2C0801.3574%2C0801.0679%2C0801.3041%2C0801.1931%2C0801.1338%2C0801.3135%2C0801.0262%2C0801.0171%2C0801.0402%2C0801.2461%2C0801.3543%2C0801.3628%2C0801.1447%2C0801.1027%2C0801.2944%2C0801.3532%2C0801.4456%2C0801.1617%2C0801.3366%2C0801.1009%2C0801.4395%2C0801.4806%2C0801.0381%2C0801.1011%2C0801.3432%2C0801.2991%2C0801.4095%2C0801.3712&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We show how to use formal desingularizations (defined earlier by the first\nauthor) in order to compute the global sections (also called adjoints) of\ntwisted pluricanonical sheaves. These sections define maps that play an\nimportant role in the birational classification of schemes."}, "authors": ["T. Beck", "J. Schicho"], "author_detail": {"name": "J. Schicho"}, "author": "J. Schicho", "arxiv_comment": "10 pages", "links": [{"href": "http://arxiv.org/abs/0801.2286v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0801.2286v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "14N30 (Primary); 14E05, 14Q10 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0801.2286v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0801.2286v1", "journal_reference": null, "doi": null, "fulltext": "ADJOINT COMPUTATION FOR HYPERSURFACES USING FORMAL\nDESINGULARIZATIONS\n\narXiv:0801.2286v1 [math.AG] 15 Jan 2008\n\nTOBIAS BECK AND JOSEF SCHICHO\nAbstract. We show how to use formal desingularizations (defined earlier by the first author)\nin order to compute the global sections (also called adjoints) of twisted pluricanonical sheaves.\nThese sections define maps that play an important role in the birational classification of schemes.\n\nContents\n1. Introduction\n2. Definition of Formal Desingularizations\n3. Adjoint Differential Forms\n4. Computing Adjoints\n5. The Algorithm\n6. Example\nReferences\n\n1\n2\n3\n5\n7\n8\n10\n\n1. Introduction\nIn [1] we have introduced formal desingularizations of schemes and shown how to compute\nthem efficiently for surfaces X \u2282 P3 . There we have already mentioned as an application the\ncomputation of invertible sheaves on Y for a certain desingularization \u03c0 : Y \u2192 X. In this report\nwe want to make this precise using the powers of the canonical sheaf on Y . More precisely we want\nto determine the coherent sheaf \u03c0\u2217 (\u03c9Y\u2297m ) which can be given by its associated graded module\nM\n\u0393\u2217 (\u03c0\u2217 (\u03c9Y\u2297m )) :=\n\u0393(X, \u03c0\u2217 (\u03c9Y\u2297m ) \u2297OX OX (n)),\nn\u2208Z\n\n\u03c0\u2217 (\u03c9Y\u2297m ) \u2297OX\n\nOX (n) are called twisted pluricanonical. Our Main Thesee [5, p. 118]. The sheaves\norem 4.6 gives a criterion for computing its homogeneous components. The theory is independent\nof the dimension and given for hypersurfaces of some projective space.\nThe importance of the components of \u0393\u2217 (\u03c0\u2217 (\u03c9Y\u2297m )) stems from the birational classification of\nschemes. For example, they provide an effective way to check Castelnuovo's Criterion and perform\nthe Enriques-Manin Reduction of rational surfaces [10].\nThis report is structured as follows: In Section 2 we start by recalling the definition of formal\ndesingularizations for the convenience of the reader. In Section 3 we define the sheaf of m-adjoints\non X by a property involving formal prime divisors and show that it is isomorphic to \u03c0\u2217 (\u03c9Y\u2297m ).\nIn particular it is independent of a special Y . In Section 4 we find a super-sheaf of \u03c0\u2217 (\u03c9Y\u2297m ) and\nshow that the defining property of the latter is easily checked using a formal desingularization of\nX. This immediately yields Algorithm 1 given in Section 5. We close with an example.\nBefore we proceed we recall and fix some notions. Let E be a field of characteristic zero and X\nand Y integral E-schemes. All (rational) maps are relative over Spec E. By E(X) and E(Y ) we\ndenote the respective function fields. A rational map \u03c0 : Y 99K X is given by a tuple (V, \u03c0) s.t.\nDate: November 7, 2018.\nThe authors were supported by the FWF (Austrian Science Fund) in the frame of the research project SFB\nF1303 (part of the Special Research Program \"Numerical and Symbolic Scientific Computing\").\n1\n\n\f2\n\nTOBIAS BECK AND JOSEF SCHICHO\n\nV \u2286 Y is open and \u03c0 : V \u2192 X is a regular morphism. Note that we do not restrict to schemes of\nfinite type here. In particular all regular morphisms are rational maps. Two tuples (V1 , \u03c01 ) and\n(V2 , \u03c02 ) are equivalent, or define the same rational map, if \u03c01 |V1 \u2229V2 = \u03c02 |V1 \u2229V2 .\nAssume that two maps send the generic point of Y to p \u2208 X (its image is always defined\nfor rational maps). Then (V1 , \u03c01 ) and (V2 , \u03c02 ) are equivalent iff the induced inclusions of fields\nOX,p /mX,p \u0592\u2192 E(Y ) are the same (where mX,p \u2282 OX,p is the maximal ideal). In particular if \u03c0 is\ndense, i.e., p is the generic point of X, we get an inclusion E(X) \u0592\u2192 E(Y ) determining \u03c0.\nNote, however, that not all such field inclusions yield rational maps under our assumption\nsince we have not yet restricted to schemes of finite type over E. E.g., let X := Spec E[x],\nY := Spec E[x]hxi and \u03c0 : Y \u2192 X be the morphism induced by localization. Then \u03c0 induces an\nisomorphism of function fields E(X) \u223c\n= E(Y ). Nevertheless \u03c0 has no rational inverse. A rational\nmap with inverse is called birational (or also a birational transformation).\nFurther it is easy to see that dense rational maps may be composed. A rational map has a\ndomain of definition, which is the maximal open set on which it can be defined (equivalently, the\nunion of all such open sets).\n2. Definition of Formal Desingularizations\nFrom now on X and Y will denote separated, integral schemes of finite type over E and they\nwill have the same dimension l. Let (A, m) be a valuation ring of E(X) over E (where m is the\nmaximal ideal). If A is discrete of rank 1 and the transcendence degree of A/m over E is n \u2212 1\nthen it is called a divisorial valuation ring of E(X) over E or a prime divisor of E(X) (see, e.g.,\n[11, Def. 2.6]). It is an essentially finite, regular, local E-algebra of Krull-dimension 1 (i.e., the\nlocalization of a finitely generated E-algebra at a prime ideal, see [12, Thm. VI.14.31]).\nLet (A, m) be a divisorial valuation ring of E(X) over E. By [5, Lem. II.4.4.] the inclusion\nA \u2282 E(X) defines a unique morphism Spec Q(A) \u2192 X and therefore a rational map Spec A 99K X\nsending generic point to generic point. Composing this with the morphism obtained by the m-adic\nb we get a rational map Spec A\nb 99K X in a natural way.\ncompletion A \u2192 A\n\nDefinition 2.1 (Formal Prime Divisor). Let (A, m) be a divisorial valuation ring of E(X) over E.\nb 99K X (as above) is actually a morphism \u03c6 : Spec A\nb\u2192X\nAssume that the rational map Spec A\n(i.e., defined also at the closed point). Then \u03c6 is a representative for a class of schemes up to\nX-isomorphism. This class (and, by abuse of notation, any representative) will be called a formal\nprime divisor on X.\nb to get another\nHence we may compose a representative \u03c6 with an isomorphism Spec B \u2192 Spec A\nrepresentative for the same formal prime divisor. By the Cohen Structure Theorem (see, e.g., [3,\nb A.\nb Therefore we will\nb\u223c\nThm. 7.7] with I = 0) we know that A\n= A/m\n= F\u03c6 JtK with F\u03c6 := A/m \u223c\nsometimes assume that \u03c6 is of the form Spec F\u03c6 JtK \u2192 X.\nFormal prime divisors provide an algorithmic way for dealing with certain valuations; A formal\nprime divisors yields an inclusion of function fields E(X) \u0592\u2192 F\u03c6 ((t)). Vice versa, by what was said\nabove, \u03c6 is determined by this inclusion. So it is this piece of information one has to compute\n(see Remark 2.7 below). Composing this inclusion with the order function ordt : F\u03c6 ((t)) \u2192 Z we\nget the corresponding divisorial valuation (see Definition 4.4 below).\nWe want to single out a special class of formal prime divisors.\nDefinition 2.2 (Realized Formal Prime Divisors). Let p \u2208 X be a regular point of codimension\n1. The formal prime divisor\n[\nSpec O\nX,p \u2192 X\n(given by composing the canonic morphism Spec OX,p \u2192 X with the morphism induced by the\n[\ncompletion OX,p \u2192 O\nX,p ) is called realized.\nIf X is normal then all generic points of closed subsets of codimension 1 are necessarily regular\n[5, Thm II.8.22A]. Therefore there is a one-one correspondence of realized formal prime divisors\nand prime Weil divisors. Another important fact is that we can match the formal prime divisors\nof birationally equivalent schemes under certain conditions.\n\n\fADJOINT COMPUTATION FOR HYPERSURFACES USING FORMAL DESINGULARIZATIONS\n\n3\n\nLemma 2.3 (Pullback along Proper Morphisms). Let \u03c0 : Y \u2192 X be a proper, birational morphism. A formal prime divisor \u03c6 : Spec F\u03c6 JtK \u2192 X lifts to a unique formal prime divisor\n\u03c0 \u2217 \u03c6 : Spec F\u03c6 JtK \u2192 Y s.t. \u03c0 \u25e6 (\u03c0 \u2217 \u03c6) = \u03c6. Vice versa, a formal prime divisor on Y extends\nto a unique formal prime divisor on X, hence \u03c0 \u2217 is a bijection.\nProof. See [1, Cor. 2.4].\n\n\u0003\n\nWe will apply the operator \u03c0 \u2217 also to sets of formal prime divisors.\nDefinition 2.4 (Center and Support). Let \u03c6 : Spec F\u03c6 JtK \u2192 X be a formal prime divisor. We\ndefine its center, in symbols center(\u03c6) \u2208 X, to be the image of the closed point. Further the\nsupport of a finite set of formal prime divisors S is defined as supp(S) := {center(\u03c6) | \u03c6 \u2208 S},\ni.e., the closure of the set of all centers.\nNow we are in the situation to define formal desingularizations.\nDefinition 2.5 (Formal Description of a Desingularization). Let \u03c0 : Y \u2192 X be a desingularization, i.e., \u03c0 is proper, birational and Y is regular. Let S be a finite set of formal prime divisors\non X. We say that S is a formal description of \u03c0 iff\n(1) all divisors in \u03c0 \u2217 S are realized,\n(2) \u03c0 \u22121 (supp(S)) = supp(\u03c0 \u2217 S) and\n(3) the restricted morphism Y \\ supp(\u03c0 \u2217 S) \u2192 X \\ supp(S) is an isomorphism.\nThe set S itself consists of formal prime divisors on X and makes no reference to the morphism\n\u03c0. By another definition we can avoid mentioning any explicit \u03c0.\nDefinition 2.6 (Formal Desingularization). Let S be a finite set of formal prime divisors on X.\nThen S is called a formal desingularization of X iff there exists some desingularization \u03c0 s.t. S\nis a formal description of it.\nIn [1, Thm. 2.9] it is shown that such \u03c0 is unique up to X-isomorphism if X is a surface. In\nthis case we also have an efficient algorithm to compute a set S. Informally speaking S makes it\npossible to work with invertible sheaves on Y , although Y is not constructed explicitely.\nRemark 2.7 (Formal Desingularizations in Higher Dimensions). This paper deals with projective\nhypersurfaces of arbitrary dimension l. Also in this case, formal desingularizations exist but are\nnot so easy to compute. We want to indicate how a formal desingularization could be obtained by\nan ad hoc method (modulo a means to represent algebraic power series).\nFirst compute a desingularization \u03c0 : Y \u2192 X, for example, by Villamayor's algorithm [4].\nLet Z \u2282 X be the singular locus of X. The algorithm will produce \u03c0 s.t. \u03c0 \u22121 (Z) \u2282 Y is a normal\ncrossing divisor and \u03c0 restricts to an isomorphism on Y \\ \u03c0 \u22121 (Z). Let {p1 , . . . , pr } \u2282 Y be the\nfinitely many generic points of the irreducible components of \u03c0 \u22121 (Z).\n[\nNext we have to compute isomorphisms O\nY,pi \u2192 Fi JtK where Fi := OY,pi /mY,pi . Therefore\nlet Ui \u223c\n= Spec E[xi,1 , . . . , xi,mi ]/hfi,1 , . . . , fi,ni i be an affine neighborhood of pi . Constructing the\nisomorphism involves finding certain \"minimal\" algebraic power series Xi,1 , . . . , Xi,mi \u2208 Fi JtK\n(compare [1, Cor. A.2]) that simultaneously solve fi,1 , . . . , fi,ni , essentially, computing a Taylor\nexpansion. These power series together with \u03c0 and the inclusions Ui \u0592\u2192 Y can be used to represent a\nformal prime divisor \u03c6i via, for example, the induced embedding of function fields E(X) \u0592\u2192 Fi ((t)).\nSet S := {\u03c61 , . . . , \u03c6r }.\nThis approach of course is not practical. It suffers from the huge computational overhead that\nthe general resolution machinery involves. Also we are not very flexible with regard to the representation of the blown up schemes, thus annihilating the benefits of formal descriptions.\n3. Adjoint Differential Forms\nWe write\n\u2297m\n\u2227l\n\u03a9m\nX,rat := (\u03a9E(X)|E )\n\n\f4\n\nTOBIAS BECK AND JOSEF SCHICHO\n\nfor the m-fold tensor power of the rational differential l-forms (which is an 1-dimensional E(X)vector space by [3, Thm. 16.14] and [8, Prop. XIX.1.1 & Cor. XVI.2.4] and can as well be considered\na constant sheaf of OX -modules).\nb \u2192 X be a formal prime divisor. We define\nLet \u03c6 : A\nem\nb \u2297A (\u03a9\u2227l )\u2297m ),\ne m := A\nb \u2297A (\u03a9\u2227l )\u2297m (canonically included in \u03a9\n:= Q(A)\n\u03a9\nb\nA|E\n\nA|E\n\nb\nQ(A)|E\n\nA|E\n\nb (see [7,\nwhich is the m-fold tensor power of the universally finite module of l-differentials of A\nb\nb\nCor. 12.5]). Note that we have a derivation d : Q(A) \u2192 Q(A) \u2297A \u03a9A|E .\nThis module is independent of the choice of a representative of \u03c6 up to X-isomorphism bee m can be defined by universal properties. So we can again substitute A\nb by F\u03c6 JtK. If\ncause \u03a9\nb\nA|E\ns\u03c6,1 , . . . , s\u03c6,l\u22121 \u2208 F\u03c6 is a transcendence basis over E then {d s\u03c6,1 , . . . , d s\u03c6,l\u22121 , d t} is a free basis of\nem\n\u03a9F\u03c6 [t]hti |E by [3, Thm. 16.14] and [9, Thm. 25.1]. Therefore also \u03a9\nF\u03c6 JtK|E is free of rank 1 generated\n\u2297m\nby (d s\u03c6,1 \u2227 . . . \u2227 d s\u03c6,l\u22121 \u2227 d t) . (Note that the module of K\u00e4hler differentials \u03a9F\u03c6 JtK|E would\nnot be finitely generated.)\nb \u2192 X induces an embedding\nWe have seen above that a formal prime divisor \u03c6 : Spec A\n#\nem\n\u03c6 : E(X) \u2192 F\u03c6 ((t)) of function fields. This again induces embeddings \u03c6# : \u03a9m\nX,rat \u2192 \u03a9F\u03c6 ((t))|E\nin the obvious way (i.e., d f 7\u2192 d \u03c6# (f )).\nDefinition 3.1 (Regularity of Forms at Formal Prime Divisors). Let \u03c6 : Spec F\u03c6 JtK \u2192 X be a\n#\nem\nformal prime divisor. We say that \u03b7 \u2208 \u03a9m\nX,rat is regular at \u03c6 iff \u03c6 (\u03b7) \u2208 \u03a9F\u03c6 JtK|E .\nThis manner of speaking is justified by Lemma 3.5 below.\n\nDefinition 3.2 (Sheaf of Adjoint Forms). The map\nU 7\u2192 {\u03b7 \u2208 \u03a9m\nX,rat | \u03b7 is regular at all formal prime divisors on X centered in U }\nfor all open subsets U \u2286 X defines a subsheaf which we call the sheaf of m-adjoint forms (or just\nm-adjoints), in symbols \u03a9m\nX,adj .\nBy what we have worked out so far we immediately find a nice property of adjoint forms.\nCorollary 3.3 (Covariance of Adjoint Forms). The sheaves of adjoints are covariants under\nproper, birational morphisms: If \u03c0 : Y \u2192 X is a proper, birational morphism then \u03c0\u2217 (\u03a9m\nY,adj ) =\nm\n\u03a9m\nas\nsubsheaves\nof\n\u03a9\n.\nX,rat\nX,adj\nm\nProof. Since \u03c0 is birational we get a vector space isomorphism \u03c0 # : \u03a9m\nX,rat \u2192 \u03a9Y,rat . With this\nm\nm\nidentification \u03c0\u2217 (\u03a9Y,adj ) becomes a subsheaf of \u03a9X,rat . The rest follows from the above definitions\nand Lemma 2.3.\n\u0003\nN\nV\nBy \u03a9m\n( OX d OX ) \u2282 \u03a9m\nX,reg :=\nX,rat we denote the subsheaf of regular forms, i.e., all\nforms locally expressible by sections of OX . More precisely, if \u03a9X|E is the usual sheaf of K\u00e4hler\n\u2297m\n\u2192 \u03a9m\ndifferentials then we mean its image under the natural map \u03b9 : (\u03a9\u2227l\nX,rat . Note that we\nX|E )\nm\n\u2297m \u223c\n\u03a9\nin\ngeneral;\nAt\nsingular\npoints\nthe\nK\u00e4hler\ndifferentials\nneed not\n)\ndo not have (\u03a9\u2227l\n= X,reg\nX|E\nm\nm\nbe torsion free (and neither their exterior and tensor products) whereas \u03a9X,reg \u2282 \u03a9X,rat always\n\u2297m\nis. At a regular point p, on the contrary, ((\u03a9\u2227l\n)p is free of rank 1 (see [5, Thm. II.8.15]).\nX|E )\nTherefore \u03b9 is locally an inclusion at p. In the next three lemmas we want to explore in detail the\nrelation between the concepts of adjointness and regularity (at points or formal prime divisors)\nfor forms in \u03a9m\nX,rat .\n\nLemma 3.4 (Adjoint Forms and Regular Forms). Let p \u2208 X be a point. Then (\u03a9m\nX,reg )p \u2286\nm\n.\n(\u03a9m\n)\nas\nsubsheaves\nof\n\u03a9\np\nX,rat\nX,adj\nNV\nm\nProof. Assume \u03b7 \u2208 (\u03a9X,reg )p or equivalently \u03b7 \u2208 ( \u0393(U, OX ) d \u0393(U, OX )) for some open neighNV\n#\nem\nborhood U of p. We have \u03b7 \u2208 \u0393(U, \u03a9m\n( F\u03c6 JtK d F\u03c6 JtK) for\nX,adj ) iff \u03c6 (\u03b7) \u2208 \u03a9F\u03c6 JtK|E =\nall formal prime divisors \u03c6 : Spec F\u03c6 JtK \u2192 X centered in U . But for such \u03c6 we must have\n\u03c6# (\u0393(U, OX )) \u2286 F\u03c6 JtK and hence this condition is trivially fulfilled. A fortiori \u03b7 \u2208 (\u03a9m\n\u0003\nX,adj )p .\n\n\fADJOINT COMPUTATION FOR HYPERSURFACES USING FORMAL DESINGULARIZATIONS\n\n5\n\nLemma 3.5 (Regularity and Realized Formal Prime Divisors). Let \u03c6 be a realized formal prime\nm\ndivisor on X, p := center(\u03c6) and \u03b7 \u2208 \u03a9m\nX,rat . Then \u03b7 \u2208 (\u03a9X,reg )p iff \u03b7 is regular at \u03c6.\nProof. By Lemma 3.4 it remains to show that regularity at \u03c6 implies \u03b7 \u2208 (\u03a9m\nX,reg )p . Since \u03c6 is\n\u2227l\n\u2297m\n[\nrealized it is of the form Spec OX,p \u2192 X. Let \u03b3 \u2208 (\u03a9OX,p |E )\nbe a generator. Write \u03b7 = a/b \u03b3\n#\nm\ne\n[\n[\nwith a, b \u2208 OX,p . Then \u03c6 (\u03b7) \u2208 \u03a9\nimplies b|a in O\nX,p , in other words a \u2208 b OX,p . But\n\\\nO\nX,p |E\n\n[\nbO\nX,p \u2229 OX,p = b OX,p by [9, Thm. 7.5(ii)] (because completion is faithfully flat [9, Thm. 7.2 &\nThm. 8.8]). Therefore b|a in OX,p and \u03b7 \u2208 (\u03a9m\n\u0003\nX,reg )p .\nLemma 3.6 (Adjoint Forms at Regular Points). Let p \u2208 X be a regular point. Then (\u03a9m\nX,reg )p =\nm\n(\u03a9m\nX,adj )p as subsheaves of \u03a9X,rat .\n\nm\nProof. By Lemma 3.4 it remains to show (\u03a9m\nX,adj )p \u2286 (\u03a9X,reg )p . Assume indirectly that \u03b7 \u2208\nm\nm\n(\u03a9m\nX,adj )p but \u03b7 6\u2208 (\u03a9X,reg )p . Regularity is an open property and \u03a9X,reg is free of rank 1 in a\nneighborhood of p. Since p is regular (in particular normal) we must have \u03b7 6\u2208 (\u03a9m\nX,reg )q for some\npoint q s.t. q is regular, of codimension 1 and p \u2208 q (see [3, Cor. 11.4]). Consider the realized\n[\nformal prime divisor \u03c6 : Spec O\nX,q \u2192 X. Lemma 3.5 above implies that \u03b7 is not regular at \u03c6.\nBut q = center(\u03c6) is contained in any open neighborhood of p contradicting \u03b7 \u2208 (\u03a9m\n\u0003\nX,adj )p .\n\u2297m \u223c\nNow assume that Y is regular. In this situation one has (\u03a9\u2227l\n= \u03a9m\nY,reg . In terms of the\nY |E )\n\u2297m \u223c\nm\nm\ncanonical sheaf this means \u03c9Y = \u03a9Y,reg = \u03a9Y,adj by the above lemmas. Finally using Corollary 3.3 we get an alternative characterization of the sheaf of m-adjoints, in fact, the usual definition\nwhen working in a category of desingularizable schemes (e.g., for our case of characteristic zero).\n\nCorollary 3.7 (Alternative Characterization of Adjoints). If \u03c0 : Y \u2192 X is any desingularization\n\u2297m\n\u223c\nthen \u03a9m\nX,adj = \u03c0\u2217 (\u03c9Y ).\n4. Computing Adjoints\nPl+1\nE\n\nNow let X \u2282\nbe a projective hypersurface with defining homogeneous equation F \u2208\nE[x0 , . . . , xl+1 ] of degree d (not equal to a coordinate hyperplane). For 0 \u2264 i \u2264 l + 1 we define the\nopen sets Ui \u2282 X obtained by intersection with the standard open covering sets xi 6= 0 of Pl+1\nE .\n0\nDefinition 4.1 (Dualizing Sheaf). By \u03c9X\n\u2286 \u03a91X,rat we denote the dualizing sheaf. It is invertible\nand generated on Ui by the form\n!\u22121\n\u2202F/\u2202xj\nx0\nd\nxi\nd\nxj\nxl+1\n\u03b3i := \u03c3i,j\nd\n\u2227 ***\u2227 d\n\u2227 ***\u2227 d\n\u2227 ***\u2227 d\nx\nx\nx\nxi\nxd\u22121\ni\ni\ni\ni\n\nfor any choice of j 6= i where\n\n\u03c3i,j :=\n\n(\n\n(\u22121)i+j\n(\u22121)i+j+1\n\nif j < i,\nif j > i.\n\n(The hats here mean that the corresponding terms in the exterior product are to be excluded.)\nUsing the rules of calculus and the fact that\nX\nF\n\u2202F/\u2202xk xk\n0=d d =\nd\nxi\nxi\nxd\u22121\ni\n0\u2264k\u2264l+1,k6=i\n\nholds in \u03a91X,rat one proves that the definition is indeed independent of the choice of j. Because of\n0 \u2297m\nlocal freeness we also have (\u03c9X\n)\n\u2286 \u03a9m\nX,rat (meaning the natural map is an embedding).\nLemma 4.2 (Properties of the Dualizing Sheaf). For the dualizing sheaf we have:\n0 \u223c\n\u2022 \u03c9X\n= OX (d \u2212 l \u2212 2)\n0\n\u2022 (\u03c9X\n)p = (\u03a91X,reg )p = (\u03a91X,adj )p at all regular points p\nm\n0 \u2297m\n\u2022 \u03a9X,adj \u2286 (\u03c9X\n)\nas subsheaves of \u03a9m\nX,rat\n\n\f6\n\nTOBIAS BECK AND JOSEF SCHICHO\n\nProof. To prove the first statement one just shows, using the rules of calculus, that \u03b3i1 =\nand xd\u2212l\u22122\n(xi1 /xi2 )d\u2212l\u22122 \u03b3i2 . The same relation is fulfilled by the local generators xd\u2212l\u22122\n.\ni1\ni2\nWe check the second statement for points p \u2208 Ui . The forms\nd\nxi\nd\nxj\nxl+1\nx0\n\u2227 ***\u2227 d\n\u2227 *** \u2227d\n\u2227 ***\u2227 d\nd\nxi\nxi\nxi\nxi\n\nwith j 6= i, which are all \u0393(Ui , OX )-multiples of \u03b3i , clearly generate \u0393(Ui , \u03a91X,reg ). Therefore we\n0\nhave (\u03a91X,reg )p \u2286 (\u03c9X\n)p at all points. Assuming moreover that p is a regular point, there must\nbe j 6= i s.t. (\u2202F/\u2202xj )/xd\u22121\n6\u2208 mX,p and therefore (\u2202F/\u2202xj )/xd\u22121\nis invertible in OX,p . Choosing\ni\ni\nthis j in Definition 4.1 one immediately sees that \u03b3i is regular at p.\nFor the last statement we consider a generic projection X \u2192 Z to a hyperplane Z \u2286 Pl+1\nE . We\nmay assume that Z is given by x0 = 0 and that F is monic in x0 . In this situation one can define\nm\na trace \u03c3X|Z : \u03a9m\nX,rat \u2192 \u03a9Z,rat obtained from the trace of the field extension E(Z) \u2286 E(X). By\n\u22121\n\u22121\n0 \u2297m\nm\n[6, Satz 2.14] and Lemma 3.6 we know that (\u03c9X\n)\n= \u03c3X|Z\n(\u03a9m\nZ,reg ) = \u03c3X|Z (\u03a9Z,adj ). It remains\nm\nm\nto show that if \u03b1 \u2208 \u03a9X,adj then \u03c3X|Z (\u03b1) \u2208 \u03a9Z,adj .\nLet R \u2282 E(Z) be a divisorial valuation ring. Further let Si \u2282 E(X) (for i in a finite index\nset) be the extensions, i.e., divisorial valuation rings dominating R. N\nUsing\nV Definition 3.2 (and the\nfact that completion\nis\nfaithfully\nflat)\nwe\nhave\nto\nshow\nthat\n\u03b1\n\u2208\n(\nSi d Si ) for all i implies\nNV\n\u03c3X|Z (\u03b1) \u2208 ( R d R). By [2, Prop. VI.8.6.6] the Si are localizations of the integral closure of R\nin E(X). Then the statement follows from [6, Satz 2.15].\n\u0003\nWe want to see that, under certain additional assumptions, checking for adjointness involves\nonly finitely many formal prime divisors.\nLemma 4.3 (Adjointness by Formal Desingularizations). Let S be a formal desingularization of\nX and U \u2282 X an open subset. For \u03b7 \u2208 \u03a9m\nX,rat the following are equivalent:\nm\n\u2022 \u03b7 \u2208 \u0393(U, \u03a9X,adj )\n\u2022 \u03b7 \u2208 \u0393(U \\ supp(S), \u03a9m\nX,adj ) and \u03b7 is regular at all \u03c6 \u2208 S with center(\u03c6) \u2208 U\nProof. The first implication is trivial, so assume that the second condition is true. Let \u03c0 : Y \u2192 X\nbe a desingularization that is described by S and set V := \u03c0 \u22121 (U ).\nm\nm\nBy Corollary 3.3 and Lemma 3.6 we have \u03c0 # (\u0393(U, \u03a9m\nX,adj )) = \u0393(V, \u03a9Y,adj ) = \u0393(V, \u03a9Y,reg ). Since\n#\n\u2217\n\u223c\n\u03c0 induces an isomorphism V \\ supp(\u03c0 (S)) = U \\ supp(S) it remains to check that \u03c0 (\u03b7) is regular\nin supp(\u03c0 \u2217 (S)) \u2229 V . Since Y is regular the locus of non-regularity of \u03c0 # (\u03b7) has pure codimension\n1. Hence, by Lemma 3.5, it is sufficient to check regularity of \u03c0 # (\u03b7) at the formal prime divisors\nin \u03c0 \u2217 (S) with center in V . Equivalently, working on X, we have to check regularity of \u03b7 at the\ncorresponding formal prime divisors in S.\n\u0003\nem\nIn the following definition we assume that we have chosen free generators \u03c9\u03c6,m \u2208 \u03a9\nF\u03c6 JtK|E (e.g.,\n\u2297m\n\u03c9\u03c6,m = (d s\u03c6,1 \u2227 * * * \u2227 d s\u03c6,l\u22121 \u2227 d t) ) for each formal prime divisor \u03c6 : Spec F\u03c6 JtK \u2192 X.\n\nDefinition 4.4 (Valuations Associated to Formal Prime Divisors). Let \u03c6 : Spec F\u03c6 JtK \u2192 X be a\nformal prime divisor. Define \u03ba\u03c6 := ordt \u25e6\u03c6# : E(X) \u2192 Z, which is a divisorial valuation. We\nm\n#\n\"extend the valuation\" to \u03a9m\nX,rat as follows: If \u03b7 \u2208 \u03a9X,rat and \u03c6 (\u03b7) = f \u03c9\u03c6,m , then \u03ba\u03c6 (\u03b7) :=\n\u03ba\u03c6 (f ). Finally we can also define \"valuations\" \u03ba\u03c6 : \u0393(X, OX (k)) \u2192 Z for k \u2208 Z by setting\n\u03ba\u03c6 (f ) := \u03ba\u03c6 (f /xki ) for any index i s.t. center(\u03c6) \u2208 Ui .\nThe map from \u03a9m\nX,rat is obviously well-defined because two free generators can differ only by a\nunit in F\u03c6 JtK which has order 0. We should also make sure that the definition for the map from\n\u0393(X, OX (k)) does not depend on the choice of the index i. Assume that j 6= i is another index with\ncenter(\u03c6) \u2208 Uj . Then f /xki = (xj /xi )k f /xkj and hence \u03ba\u03c6 (f /xki ) = k \u03ba\u03c6 (xj /xi ) + \u03ba\u03c6 (f /xkj ). Since\ncenter(\u03c6) \u2208 Ui \u2229 Uj we have that xj /xi \u2208 OX,center(\u03c6) is invertible and so is \u03c6# (xj /xi ) \u2208 F\u03c6 JtK.\nBut then again \u03ba\u03c6 (xj /xi ) = ordt (\u03c6# (xj /xi )) = 0.\nDefinition 4.5 (Adjoint Order). Let \u03c6 : Spec F\u03c6 JtK \u2192 X be a formal prime divisor and 0 \u2264 i \u2264\nl + 1 an index s.t. center(\u03c6) \u2208 Ui . We define the adjoint order at \u03c6 as \u03b1\u03c6 := \u2212\u03ba\u03c6 (\u03b3i ).\n\n\fADJOINT COMPUTATION FOR HYPERSURFACES USING FORMAL DESINGULARIZATIONS\n\n7\n\nThis definition is again independent of the index i by an analogous reasoning as above.\nTheorem 4.6 (Global Sections of Twisted Pluricanonical Sheaves). Let S be a formal desingularization of X. Then\n\u223c\n\u0393(X, OX (n) \u2297OX \u03a9m\nX,adj ) = {f \u2208 \u0393(X, OX (n + m(d \u2212 l \u2212 2))) | \u03ba\u03c6 (f ) \u2265 m \u03b1\u03c6 for all \u03c6 \u2208 S}.\n0 \u2297m \u223c\nProof. By Lemma 4.2 we can view OX (n) \u2297OX \u03a9m\n=\nX,adj as a subsheaf of OX (n) \u2297OX (\u03c9X )\nOX (n + m(d \u2212 l \u2212 2)). Let f \u2208 \u0393(X, OX (n + m(d \u2212 l \u2212 2))) be a global section and \u03b7 its preimage\n0 \u2297m\n) ) via this isomorphism. Projecting \u03b7 to the sections over Ui we find\nin \u0393(X, OX (n) \u2297OX (\u03c9X\n\n\u03b7 7\u2192 xni \u2297\n\nf\n\u03b3 \u2297m .\nn+m(d\u2212l\u22122) i\nxi\n\nn+m(d\u2212l\u22122)\n\n\u03b3i\u2297m \u2208 \u0393(Ui , \u03a9m\nWe have to check whether f /xi\nX,adj ) for all i. Again by Lemma 4.2 this\nform is adjoint at all regular points. Applying now Lemma 4.3 it is equivalent to check that\nn+m(d\u2212l\u22122) \u2297m\n\u03b3i )\n\n\u03ba\u03c6 (f /xi\n\n\u22650\n\nfor all i and any formal prime divisor \u03c6 \u2208 S with center(\u03c6) \u2208 Ui . This again is equivalent to\nn+m(d\u2212l\u22122)\n\n\u03ba\u03c6 (f /xi\n\n) \u2265 \u2212m\u03ba\u03c6 (\u03b3i ) = m \u03b1\u03c6\n\nfor all \u03c6 \u2208 S.\n\n\u0003\n5. The Algorithm\n\nConcerning the actual computation we close with a few remarks and give an explicit algorithm.\nFirst since a hypersurface X is in particular a complete intersection we know that\n\u0393(X, OX (n + m(d \u2212 l \u2212 2))) \u223c\n= (E[x0 , . . . , xl+1 ]/hF i)n+m(d\u2212l\u22122)\n(see, for example, [5, Exer. III.5.5.(a)]). If 4 is some well-ordering on exponents compatible with\nthe group structure and \u03bc0 is the leading exponent of F w.r.t. 4 then we can write\n(E[x0 , . . . , xl+1 ]/hF i)n+m(d\u2212l\u22122) = hx\u03bc | |\u03bc| = n + m(d \u2212 l \u2212 2) and \u03bc 4 \u03bc0 iE .\nSecond we want to comment on the computation of adjoint orders (see Definition 4.5). Therefore\nwe have to determine \u03ba\u03c6 (\u03b3i ). More generally let \u03b7 \u2208 \u03a91X,rat be arbitrary. Further let u1 , . . . , ul \u2208\ne1\nE(X) be a transcendence basis over E. As a generator of \u03a9\nF\u03c6 JtK we choose as before \u03c9\u03c6,1 =\nd s\u03c6,1 \u2227 * * * \u2227 d s\u03c6,l\u22121 \u2227 d t and we can write \u03b7 = f d u1 \u2227 * * * \u2227 d ul . Then by the rules of calculus\n\u03c6# (\u03b7) = \u03c6# (f )\n\n\u2202(\u03c6# (u1 ), . . . , \u03c6# (ul ))\nd s\u03c6,1 \u2227 * * * \u2227 d s\u03c6,l\u22121 \u2227 d t\n\u2202(s\u03c6,1 , . . . , s\u03c6,l\u22121 , t)\n\nand hence\n\u03ba\u03c6 (\u03b7) = \u03ba\u03c6 (f ) + ordt\n\n\u2202(\u03c6# (u1 ), . . . , \u03c6# (ul ))\n.\n\u2202(s\u03c6,1 , . . . , s\u03c6,l\u22121 , t)\n\nIn order to compute the order of the Jacobian one can use approximative methods, i.e., compute\nwith truncations of the involved power series of sufficiently high precision. In any case one has to\nbe able to compute in the universal module of differentials of the field extension F\u03c6 | E. This proves\nstill a little difficult in current computer algebra systems. It is therefore preferable to compute\nthe adjoint orders, when possible, simultaneously with the formal desingularization. This involves\nessentially repeated application of the chain rule of differential calculus.\nWith these remarks and the above notation it is now obvious how to derive an algorithm.\nCorrectness of the following is immediate by Theorem 4.6, and termination is trivial because\nformal desingularizations can be computed and consist of finitely many formal prime divisors.\n\n\f8\n\nTOBIAS BECK AND JOSEF SCHICHO\n\nAlgorithm 1 Adjoints(F : E[x0 , . . . , xl+1 ], m : N, n : N) : 2E[x0 ,...,xl+1 ]\nRequire: an irreducible, homogeneous polynomial F of degree d (not equal to xi for any 0 \u2264 i \u2264\nl + 1), defining X \u2282 Pl+1\nE\nEnsure: a basis for the space of global sections of OX (n) \u2297OX \u03c0\u2217 (\u03c9Y\u2297m ) represented by homogeneous polynomials of degree n + m(d \u2212 l \u2212 2) where \u03c0 : Y \u2192 X is any desingularization\n1:\n2:\n3:\n4:\n5:\n6:\n7:\n8:\n\nLet B \u2282 E[x0 , . . . , xl+1 ] be a set representing a basis of (E[x0 , . . . , xl+1 ]/hF i)n+m(d\u2212l\u22122) ;\nCompute a formal desingularization S of X and adjoint orders \u03b1\u03c6 for all \u03c6 \u2208 S;\nC := 0 \u2208 E\u221e\u00d7|B| ; {a matrix with an undetermined number of rows}\nfor \u03c6 \u2208 P\nS do\nP\nA := b\u2208B cb T runc(\u03c6# (b), m \u03b1\u03c6 ) = 0\u2264j<m \u03b1\u03c6 aj tj ; {with aj linear in F\u03c6 [cb | b \u2208 B]}\nC := AddConstraints(C, {aj }0\u2264j<m \u03b1\u03c6 );\nLet K \u2282 P\nE#B be a basis of ker(C);\nreturn { b\u2208B cb b | (cb )b\u2208B \u2208 K};\n\nHere T runc(\u03c6# (b), m \u03b1\u03c6 ) means the truncation of \u03c6# (b) at order m \u03b1\u03c6 . It remains to explain\nthe function AddConstraints. It is meant to stack new rows on top of the matrix C, representing\nthe linear constraints imposed by the formal prime divisor \u03c6.\nAssume E \u2282 F\u2032 \u2282 F isPa tower of field extensions where F over F\u2032 is simple (algebraic or\ntranscendental). Let a := b\u2208B yb cb \u2208 F[cb | b \u2208 B]. We want to find values cb \u2208 E s.t. the linear\nconstraint a = 0 is fulfilled. We are done if we know how to translate the constraint equivalently\nto a finite number of linear constraints over the smaller field F\u2032 . Using this step recursively and\nconsidering the factPthat F over E is finitely generated, we finally get a set of constraints with\ncoefficients in E. If b\u2208B yb cb = 0 is such a constraint, the function AddConstraints would stack\nthe row vector (yb )b\u2208B on top of the matrix C. We distinguish two cases:\n\u2022 If F over F\u2032 is algebraic, say, of degree e + 1, choose a basis {fr }0\u2264r\u2264e of F as an F\u2032 -vector\nspace. Then\n!\nX\nX\nX\nX X\n0=\ny b cb =\ncb\nyb,r fr =\nyb,r cb fr\nb\u2208B\n\nP\n\nb\u2208B\n\n0\u2264r\u2264d\n\n0\u2264r\u2264e\n\nb\u2208B\n\nholds if and only if b\u2208B yb,r cb = 0 for all 0 \u2264 r \u2264 e.\n\u2022 Now assume F = F\u2032 (s) is transcendental. W.l.o.g. we may assume that the yb are actually\npolynomials in F\u2032 [s], otherwise multiply the equation by the common denominator. Let e\nbe the maximal degree of all the yb . Then\n!\nX\nX\nX\nX X\nr\n0=\ny b cb =\ncb\nyb,r s =\nyb,r cb sr\nb\u2208B\n\nholds again if and only if\n\nb\u2208B\n\nP\n\nb\u2208B\n\n0\u2264r\u2264e\n\n0\u2264r\u2264e\n\nb\u2208B\n\nyb,r cb = 0 for all 0 \u2264 r \u2264 e.\n6. Example\n\nLet E := Q and write x := x0 , y := x1 , z := x2 , w := x3 . The homogeneous polynomial\nF := w3 y 2 z + (xz + w2 )3 \u2208 Q[x, y, z, w] of degree d = 6 defines a hypersurface X \u2282 P3Q , i.e.,\nl = dim(X) = 2. We compute a formal desingularization S using Algorithm 1 of [1]. Amongst\nothers, we get a formal prime divisor \u03c6 : Spec F\u03c6 JtK \u2192 X defined by the Q-algebra homomorphism\n\uf8f1\nx 7\u2192 1,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2y 7\u2192 \u2212 8 t3 ,\ns\n\u03c6# : Q[x, y, z, w]/hF i \u2192 F\u03c6 JtK :\n64 6\n\uf8f4\nz\n\u2192\n7\nt ,\n\uf8f4\ns\n\uf8f4\n\uf8f3\nw 7\u2192 \u2212 8s \u03b1t3 \u2212 8s t4 + s42 \u03b1t5 + s13 \u03b1t7 + 2s14 \u03b1t9 + O(t11 )\nwhere F\u03c6 = Q(s)[\u03b1] and \u03b1 has minimal polynomial \u03b12 + s.\n\n\fADJOINT COMPUTATION FOR HYPERSURFACES USING FORMAL DESINGULARIZATIONS\n\n9\n\nFirst we want to compute the adjoint order of this formal prime divisor. Therefore we consider\nthe rational differential form\nx5\nxd\u22121\nd y \u2227 d xz .\nd xy \u2227 d xz = 2 2\n\u2202F/\u2202w\n6x z w + 12xzw3 + 3y 2 zw2 + 6w5 x\nNow we apply the map induced by \u03c6# and find the differential form\n1\n6\nd \u2212 8s t3 \u2227 d 64\n786432\ns t .\n17 + 1572864 t18 \u2212 1966080 \u03b1t19 + O(t20 )\n\u03b1t\n4\n4\n5\ns\ns\ns\nAccording to Definition 4.4 we generate by d s \u2227 d t and rewrite this form again to\n1\nd s \u2227 d t.\n512\n9 + 1024 t10 \u2212 1280 \u03b1t11 + O(t12 )\n\u03b1t\ns\ns\ns2\nThe coefficient has order \u22129, so \u03ba\u03c6 = 9 as of Definition 4.5.\nAssume now, we want to compute the global sections of \u03c0\u2217 (\u03c9Y ) \u2297OX OX (1) (where \u03c0 : Y \u2192 X\nis any desingularization, not necessarily the one described by S), i.e., we have m = 1 and n = 1.\nWe compute n + m(d \u2212 l \u2212 2) = 1 + 1(6 \u2212 2 \u2212 2) = 3. Therefore we first need a set B projecting\nbijectively to the component of Q[x, y, z, w]/hF i of homogeneous degree 3. Since the defining\nequation is of degree 6 we can choose the set of all monomials of degree 3:\nB := {x3 , x2 y, xy 2 , y 3 , x2 z, xyz, y 2z, xz 2 , yz 2 , z 3 , x2 w, xyw, y 2 w, xzw, yzw, z 2 w, xw2 , yw2 , zw2 , w3 }\nApplying \u03c6# to the generic form of degree 3 we find:\nP\n\u03c6# ( b\u2208B cb b) =(cx3 )t0 + (\u2212 8s cx2 y \u2212 8s \u03b1cx2 w )t3 + (\u2212 s8 cx2 w )t4 + ( s42 \u03b1cx2 w )t5 +\n6\n64\n64\n64\n2\n2\ns cx z + s2 \u03b1cxyw \u2212 s cxw )t\n8\n9\n128\n2\n(\u2212 32\ns3 \u03b1cxyw + s2 cxw )t + O(t )\n2\n( 64\ns2 cxy +\n\n+ ( s13 \u03b1cx2 w +\n\n64\ns2 cxyw\n\n+\n\n7\n128\n2\ns2 \u03b1cxw )t +\n\nA form is adjoint iff its \u03c6# -image vanishes with order greater or equal to m\u03ba\u03c6 = 1 * 9 = 9, i.e.,\nthe coefficients of t0 , . . . , t8 have to vanish. Viewing B as an ordered basis we can write this as a\nmatrix in Q(s)[\u03b1]9\u00d720 :\n\uf8f6\n\uf8eb\n1\n0\n0 0\n0 0 0 0 0 0\n0\n0 0 0 0 0\n0 0 0 0\n\uf8ec 0\n0\n0 0\n0 0 0 0 0 0\n0\n0 0 0 0 0\n0 0 0 0 \uf8f7\n\uf8f7\n\uf8ec\n\uf8ec 0\n0\n0 0\n0 0 0 0 0 0\n0\n0 0 0 0 0\n0 0 0 0 \uf8f7\n\uf8f7\n\uf8ec\n\uf8ec 0 \u22128\n0 0\n0 0 0 0 0 0 \u2212 8s \u03b1\n0 0 0 0 0\n0 0 0 0 \uf8f7\ns\n\uf8f7\n\uf8ec\n\uf8ec 0\n0\n0 0\n0 0 0 0 0 0\n\u2212 8s\n0 0 0 0 0\n0 0 0 0 \uf8f7\n\uf8f7\n\uf8ec\n4\n\uf8ec 0\n0\n0 0\n0 0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 \uf8f7\ns2 \u03b1\n\uf8f7\n\uf8ec\n64\n\uf8ec 0\n0 0 0 0 0\n0\n0 0 0 \uf8f7\n0 64\n0 64\n\u2212 64\ns2\ns\ns2 \u03b1 0 0 0 0\ns\n\uf8f7\n\uf8ec\n1\n64\n\uf8f8\n\uf8ed 0\n0\n0 0\n0 0 0 0 0 0\n0 0 0 0 128\ns3 \u03b1\ns2\ns2 \u03b1 0 0 0\n32\n128\n0\n0\n0 0\n0 0 0 0 0 0\n0 \u2212 s3 \u03b1 0 0 0 0\n0 0 0\ns2\nThe third row from the bottom corresponds to the constraint\n64\n2\ns2 cxy\n\n+\n\n64\n2\ns cx z\n\n+\n\n64\ns2 \u03b1cxyw\n\n\u2212\n\n64\n2\ns cxw\n\n= 0.\n\nReordering this in terms of the basis \u03b10 , \u03b11 of Q(s)[\u03b1] over Q(s) we find\n2\n( 64\ns2 cxy +\n\n64\n2\ns cx z\n\n\u2212\n\n0\n64\n2\ns cxw )\u03b1\n\n\u2212\n\n64\n2\ns cxw\n\n1\n+ ( 64\ns2 cxyw )\u03b1 = 0\n\nand hence the two equivalent constraints\n64\n2\ns2 cxy\n\n+\n\n64\n2\ns cx z\n\n= 0 and\n\n64\ns2 cxyw\n\n= 0.\n\nThe second one is clearly equivalent to 64cxyw = 0 which is already a constraint over Q. The\nfirst one can be multiplied by s2 and rewritten in terms of s0 and s1 :\n(64cxy2 )s0 + (64cx2 z \u2212 64cxw2 )s1 = 0\nThis yields another two constraints\n64cxy2 = 0 and 64cx2 z \u2212 64cxw2 = 0\n\n\f10\n\nover Q. Altogether the\n\uf8eb\n0 0 64\n\uf8ed 0 0 0\n0 0 0\n\nTOBIAS BECK AND JOSEF SCHICHO\n\nthird row from the bottom corresponds to the following matrix in Q3\u00d720 :\n\uf8f6\n0\n0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0\n0 64 0 0 0 0 0 0 0 0 0 0 0 \u221264 0 0 0 \uf8f8\n0\n0 0 0 0 0 0 0 64 0 0 0 0\n0 0 0 0\n\nTreating all rows similarly,\nzero rows we obtain:\n\uf8eb\n1\n0 0 0 0\n\uf8ec 0 \u22128 0 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ec 0\n0 64 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 64\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ec 0\n0 0 0 0\n\uf8ec\n\uf8ed 0\n0 0 0 0\n0\n0 0 0 0\n\nstacking the computed matrices on top of each other and skipping\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0 \u22128\n0 \u22128\n0\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0\n0\n0\n64\n64\n0\n0\n0\n\u221232\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n0\n0 0 0\n0\n0 0 0\n0\n0 0 0\n0\n0 0 0\n0\n0 0 0\n0\n0 0 0\n0 \u221264 0 0\n0\n0 0 0\n0\n0 0 0\n0\n0 0 0\n0 128 0 0\n0 128 0 0\n0\n0 0 0\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\uf8f6\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f8\n\nDoing the same computation for all the other formal prime divisors in S one computes a huge\nmatrix which turns out to have a one-dimensional kernel spanned by\n\u0001\n0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 .\n\nThe entries of this vector are the coefficients of the form xzw + w3 . So we have\n\u0393(X, \u03c0\u2217 (\u03c9Y ) \u2297O OX (1)) \u223c\n= hxzw + w3 iQ .\nX\n\nReferences\n1. Tobias Beck, Formal Desingularization of Surfaces \u2013 The Jung Method Revisited \u2013, Tech. Report 2007-31,\nRICAM, December 2007.\n2. Nicolas Bourbaki, Commutative algebra. Chapters 1\u20137, Elements of Mathematics (Berlin), Springer-Verlag,\nBerlin, 1989, Translated from the French, Reprint of the 1972 edition.\n3. David Eisenbud, Commutative algebra, Graduate Texts in Mathematics, vol. 150, Springer-Verlag, New York,\n1995, With a view toward algebraic geometry.\n4. Santiago Encinas and Orlando Villamayor, A course on constructive desingularization and equivariance, Resolution of singularities (Obergurgl, 1997), Progr. Math., vol. 181, Birkh\u00e4user, Basel, 2000, pp. 147\u2013227.\n5. Robin Hartshorne, Algebraic geometry, Springer-Verlag, New York, 1977, Graduate Texts in Mathematics, No.\n52.\n6. Ernst Kunz, Differentialformen auf algebraischen Variet\u00e4ten mit Singularit\u00e4ten. II, Abh. Math. Sem. Univ.\nHamburg 47 (1978), 42\u201370, Special issue dedicated to the seventieth birthday of Erich K\u00e4hler.\n, K\u00e4hler differentials, Advanced Lectures in Mathematics, Friedr. Vieweg & Sohn, Braunschweig, 1986.\n7.\n8. Serge Lang, Algebra, third ed., Graduate Texts in Mathematics, vol. 211, Springer-Verlag, New York, 2002.\n9. Hideyuki Matsumura, Commutative ring theory, second ed., Cambridge Studies in Advanced Mathematics,\nvol. 8, Cambridge University Press, Cambridge, 1989, Translated from the Japanese by M. Reid.\n10. Josef Schicho, Rational parametrization of surfaces, J. Symbolic Comput. 26 (1998), no. 1, 1\u201329.\n11. Mark Spivakovsky, Valuations in function fields of surfaces, Amer. J. Math. 112 (1990), no. 1, 107\u2013156.\n12. Oscar Zariski and Pierre Samuel, Commutative algebra. Vol. II, Springer-Verlag, New York, 1975, Reprint of\nthe 1960 edition, Graduate Texts in Mathematics, No. 29.\nSymbolic Computation Group, Johann Radon Institute for Computational and Applied Mathematics,\nAustrian Academy of Sciences, Altenberger Strasse 69, A-4020 Linz, Austria\nE-mail address: Tobias.Beck@ricam.oeaw.ac.at\nE-mail address: Josef.Schicho@ricam.oeaw.ac.at\n\n\f"}