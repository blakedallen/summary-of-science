{"id": "http://arxiv.org/abs/0911.1484v1", "guidislink": true, "updated": "2009-11-08T03:29:37Z", "updated_parsed": [2009, 11, 8, 3, 29, 37, 6, 312, 0], "published": "2009-11-08T03:29:37Z", "published_parsed": [2009, 11, 8, 3, 29, 37, 6, 312, 0], "title": "Decision problems for inverse monoids presented by a single sparse\n  relator", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0911.3771%2C0911.1675%2C0911.1042%2C0911.4520%2C0911.0120%2C0911.2680%2C0911.4565%2C0911.2002%2C0911.3651%2C0911.2300%2C0911.5148%2C0911.4843%2C0911.5375%2C0911.2091%2C0911.1252%2C0911.3401%2C0911.3776%2C0911.1763%2C0911.5127%2C0911.3979%2C0911.0606%2C0911.1872%2C0911.0045%2C0911.4664%2C0911.4008%2C0911.2962%2C0911.1511%2C0911.3742%2C0911.5016%2C0911.1743%2C0911.3732%2C0911.4059%2C0911.4442%2C0911.4693%2C0911.5251%2C0911.3653%2C0911.2785%2C0911.3106%2C0911.0925%2C0911.1058%2C0911.3759%2C0911.4079%2C0911.0655%2C0911.5100%2C0911.2396%2C0911.5346%2C0911.1067%2C0911.0161%2C0911.4401%2C0911.4997%2C0911.4238%2C0911.1628%2C0911.1406%2C0911.2828%2C0911.0928%2C0911.0285%2C0911.1298%2C0911.4425%2C0911.1942%2C0911.1565%2C0911.3646%2C0911.4929%2C0911.2646%2C0911.1117%2C0911.1484%2C0911.4041%2C0911.0641%2C0911.4000%2C0911.1007%2C0911.5171%2C0911.3585%2C0911.3099%2C0911.3497%2C0911.0987%2C0911.2298%2C0911.2156%2C0911.2279%2C0911.0391%2C0911.4007%2C0911.1527%2C0911.3051%2C0911.4742%2C0911.0318%2C0911.0293%2C0911.3417%2C0911.3379%2C0911.1847%2C0911.3086%2C0911.0446%2C0911.4598%2C0911.0859%2C0911.1131%2C0911.4476%2C0911.1155%2C0911.2910%2C0911.2146%2C0911.0207%2C0911.3186%2C0911.2848%2C0911.1409%2C0911.5387&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Decision problems for inverse monoids presented by a single sparse\n  relator"}, "summary": "We study a class of inverse monoids of the form M = Inv< X | w=1 >, where the\nsingle relator w has a combinatorial property that we call sparse. For a sparse\nword w, we prove that the word problem for M is decidable. We also show that\nthe set of words in (X \\cup X^{-1})^* that represent the identity in M is a\ndeterministic context free language, and that the set of geodesics in the\nSchutzenberger graph of the identity of M is a regular language.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0911.3771%2C0911.1675%2C0911.1042%2C0911.4520%2C0911.0120%2C0911.2680%2C0911.4565%2C0911.2002%2C0911.3651%2C0911.2300%2C0911.5148%2C0911.4843%2C0911.5375%2C0911.2091%2C0911.1252%2C0911.3401%2C0911.3776%2C0911.1763%2C0911.5127%2C0911.3979%2C0911.0606%2C0911.1872%2C0911.0045%2C0911.4664%2C0911.4008%2C0911.2962%2C0911.1511%2C0911.3742%2C0911.5016%2C0911.1743%2C0911.3732%2C0911.4059%2C0911.4442%2C0911.4693%2C0911.5251%2C0911.3653%2C0911.2785%2C0911.3106%2C0911.0925%2C0911.1058%2C0911.3759%2C0911.4079%2C0911.0655%2C0911.5100%2C0911.2396%2C0911.5346%2C0911.1067%2C0911.0161%2C0911.4401%2C0911.4997%2C0911.4238%2C0911.1628%2C0911.1406%2C0911.2828%2C0911.0928%2C0911.0285%2C0911.1298%2C0911.4425%2C0911.1942%2C0911.1565%2C0911.3646%2C0911.4929%2C0911.2646%2C0911.1117%2C0911.1484%2C0911.4041%2C0911.0641%2C0911.4000%2C0911.1007%2C0911.5171%2C0911.3585%2C0911.3099%2C0911.3497%2C0911.0987%2C0911.2298%2C0911.2156%2C0911.2279%2C0911.0391%2C0911.4007%2C0911.1527%2C0911.3051%2C0911.4742%2C0911.0318%2C0911.0293%2C0911.3417%2C0911.3379%2C0911.1847%2C0911.3086%2C0911.0446%2C0911.4598%2C0911.0859%2C0911.1131%2C0911.4476%2C0911.1155%2C0911.2910%2C0911.2146%2C0911.0207%2C0911.3186%2C0911.2848%2C0911.1409%2C0911.5387&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We study a class of inverse monoids of the form M = Inv< X | w=1 >, where the\nsingle relator w has a combinatorial property that we call sparse. For a sparse\nword w, we prove that the word problem for M is decidable. We also show that\nthe set of words in (X \\cup X^{-1})^* that represent the identity in M is a\ndeterministic context free language, and that the set of geodesics in the\nSchutzenberger graph of the identity of M is a regular language."}, "authors": ["Susan Hermiller", "Steven Lindblad", "John Meakin"], "author_detail": {"name": "John Meakin"}, "author": "John Meakin", "links": [{"href": "http://arxiv.org/abs/0911.1484v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0911.1484v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.GR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.GR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "20M18; 20M05; 03D05", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0911.1484v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0911.1484v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "DECISION PROBLEMS FOR INVERSE MONOIDS PRESENTED BY\nA SINGLE SPARSE RELATOR\n\narXiv:0911.1484v1 [math.GR] 8 Nov 2009\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\nAbstract. We study a class of inverse monoids of the form M = InvhX | w = 1i,\nwhere the single relator w has a combinatorial property that we call sparse. For a\nsparse word w, we prove that the word problem for M is decidable. We also show\nthat the set of words in (X \u222a X \u22121 )\u2217 that represent the identity in M is a deterministic\ncontext free language, and that the set of geodesics in the Sch\u00fctzenberger graph of the\nidentity of M is a regular language.\n\nDedicated to the memory of Douglas Munn\n1. Introduction\nIn a seminal paper in 1974, Douglas Munn [Mun74] introduced the notion of birooted\nedge labeled trees (subsequently referred to as \"Munn trees\") to solve the word problem\nfor the free inverse monoid. Munn's work was extended by Stephen [Step90] who introduced the notion of Sch\u00fctzenberger graphs to study presentations of inverse monoids.\nThe Sch\u00fctzenberger graphs of an inverse monoid presentation are the strongly connected\ncomponents of the Cayley graph of the presentation (or equivalently the restrictions of\nthe Cayley graph to the R-classes of the monoid). From a Sch\u00fctzenberger graph for an\ninverse monoid presentation, the corresponding Sch\u00fctzenberger complex can be defined\nas the 2-complex whose 1-skeleton is the Sch\u00fctzenberger graph and whose faces have\nboundaries labeled by the sides of relations [Stei03].\nOne-relator inverse monoids of the form M = InvhX | w = 1i, where w \u2208 (X \u222a X \u22121 )\u2217 ,\nhave received some attention in the literature. Birget, Margolis, and Meakin [BMM94]\nproved that the word problem is solvable for inverse monoids of the form InvhX | e = 1i,\nwhere e is an idempotent in the free inverse monoid (i.e., reduces to 1 in the free group).\nStephen [Step93] observed that if the inverse monoid M = InvhX | w = 1i is E-unitary,\nthen the word problem for M is decidable if there is an algorithm to decide, for any\nword u \u2208 (X \u222a X \u22121 )\u2217 , whether or not u = 1 in M . Furthermore, Ivanov, Margolis,\nand Meakin [IMM01] proved that if w is cyclically reduced, then M = InvhX | w = 1i\nis E-unitary. Thus the word problem for M = InvhX | w = 1i, w cyclically reduced, is\nreduced to understanding the Sch\u00fctzenberger graph of 1 in M . This has been used to\nsolve the word problem in several special cases (see for example the paper by Margolis,\nMeakin and \u0160uni\u1e31 [MMS05]), but the problem remains open in general, even if w is a\ncyclically reduced word.\nThe present paper is concerned with a class of one-relator inverse monoids of the form\nM = InvhX | w = 1i where w \u2208 (X \u222a X \u22121 )\u2217 satisfies a combinatorial condition that\nenables us to understand the structure of the Sch\u00fctzenberger complex corresponding to\nthe identity of M .\nLet w = a0 * * * an\u22121 with each ai in X \u222aX \u22121 . A cyclic subword q = w(i, j, \u01eb) of w is a\nnonempty word in (X \u222a X \u22121 )\u2217 of length at most n \u2212 1 of the form q = ai ai+1 ai+2 * * * aj\u22121\n1\n\n\f2\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\n\u22121 \u22121\n\u22121\nif \u01eb = 1 and q = a\u22121\ni\u22121 ai\u22122 ai\u22123 * * * aj if \u01eb = \u22121, where i, j \u2208 Z/nZ. The zone of the cyclic\nsubword q = w(i, j, \u01eb) is the subset of Z/nZ given by zone(q) := {i, i + \u01eb, i + 2\u01eb, ..., j}.\n\nDefinition 1.1. A word w \u2208 (X \u222a X \u22121 )\u2217 is sparse if w is freely reduced, l(w) > 1,\nand whenever (qk , qk\u2032 ) = (w(ik , jk , \u01ebk ), w(i\u2032k , jk\u2032 , \u01eb\u2032k )) are two pairs of cyclic subwords of w\nsatisfying qk = qk\u2032 in (X \u222a X \u22121 )\u2217 , zone(qk ) 6= zone(qk\u2032 ) and 0 \u2208 zone(qk\u2032 ) for k = 1, 2,\nthen\n(sparse 1): zone(q1 ) \u2229 zone(q2\u2032 ) = \u2205 = zone(q1\u2032 ) \u2229 zone(q2 ), and\n(sparse 2): either zone(q1 ) \u2229 zone(q2 ) = \u2205 or both \u01eb1 \u01eb\u20321 = \u01eb2 \u01eb\u20322 and i1 \u2212 \u01eb1 \u01eb\u20321 i\u20321 =\ni2 \u2212 \u01eb2 \u01eb\u20322 i\u20322 mod n.\nFor example one may see easily from this definition that the word w = aba\u22121 b\u22121 cdc\u22121 d\u22121\nand all of its cyclic conjugates are sparse. However the word w = aba\u22121 b\u22121 is not\nsparse. To see this, note that if q1 = w(3, 2, \u22121), q1\u2032 = w(0, 1, 1), q2 = w(1, 2, 1) and\nq2\u2032 = w(0, 3, \u22121), then q1 = q1\u2032 = a in (X \u222aX \u22121 )\u2217 (where X = {a, b, c, d}) and q2 = q2\u2032 = b\nin (X \u222a X \u22121 )\u2217 , but 1 \u2208 zone(q1\u2032 ) \u2229 zone(q2 ).\nRoughly speaking, if w is a sparse word, then distinct occurrences of prefixes and\nsuffixes of w that occur elsewhere as cyclic subwords of w are separated by at least one\nletter. This enables us to define an appropriate notion of a dual graph in the Sch\u00fctzenberger complex of 1 and to prove that this dual graph is a tree. From this, we can encode the\ninformation contained in the Sch\u00fctzenberger complex of 1 in a pushdown automaton.\nWe can also show that the faces of this Sch\u00fctzenberger complex are of finitely many\ntypes and use this to analyze geodesics and cone types in the Sch\u00fctzenberger graph of\n1. Specifically, we can prove the following theorems.\nTheorem 1.2. If w \u2208 (X \u222aX \u22121 )\u2217 is sparse, then the word problem for M = InvhX | w =\n1i is solvable.\nTheorem 1.3. Let w be sparse and let M = InvhX | w = 1i. Then:\n(1) The language of words equal to 1 in M is deterministic context-free.\n(2) The language of words related to 1 by Green's relation R in M is deterministic\ncontext-free.\nTheorem 1.4. If w is a sparse word and M = InvhX | w = 1i, then the language of\ngeodesics in the Sch\u00fctzenberger graph of 1 for M (i.e. the language of words labeling\ngeodesic paths starting at 1 in S\u0393(1)) is a regular language. That is, the Sch\u00fctzenberger\ngraph of 1 has finitely many cone types.\nIn Section 2 of the paper we study some properties of sparse words that enable us\nto understand how n-gons whose boundaries are labeled by a sparse word may fold\ntogether. Section 3 provides information about sequences of complexes that are used to\napproximate the Sch\u00fctzenberger complex of 1 for an inverse monoid with sparse relator.\nSection 4 introduces a notion of dual graph to the Sch\u00fctzenberger complex of 1 and this\nis exploited to provide a proof of Theorem 1.2. In Section 5 we introduce a pushdown\nautomaton that encodes the information contained in the Sch\u00fctzenberger complex of 1\nfor a one-relator monoid corresponding to a sparse word, and we use this to provide\na proof of Theorem 1.3. We also make use of these results to construct a finite state\nautomaton that accepts the geodesics in the Sch\u00fctzenberger graph of 1 for our monoid,\nand thus provide a proof of Theorem 1.4.\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n3\n\nWe refer the reader to the book of Lawson [Law98] for much of the basic theory of\ninverse semigroups and to the paper by Stephen [Step90] for foundational ideas and\nnotation about presentations of inverse monoids.\n2. Sparse Words\nThroughout this section, w = a0 * * * an\u22121 will denote a fixed sparse word in (X \u222aX \u22121 )\u2217\nas defined in Definition 1.1 above.\nLemma 2.1. Every sparse word in (X \u222a X \u22121 )\u2217 is cyclically reduced.\nProof. Let w = a0 * * * an\u22121 be a sparse word and suppose that a0 = a\u22121\nn\u22121 = a. If\nwe let q1 = w(0, \u22121, \u22121), q1\u2032 = w(0, 1, 1), q2 = w(0, \u22121, \u22121) and q2\u2032 = w(0, 1, 1), then\nq1 = q1\u2032 = q2 = q2\u2032 = a, but 0 \u2208 zone(q1 ) \u2229 zone(q2\u2032 ). This contradicts condition (sparse\n1) of Definition 1.1, so w must be cyclically reduced.\n\u0003\nLemma 2.2. Every sparse word w \u2208 (X \u222a X \u22121 )\u2217 is primitive (i.e. w is not a proper\npower in (X \u222a X \u22121 )\u2217 ).\nProof. Suppose that w = um in (X \u222a X \u22121 )\u2217 for some m > 1. The word u has length\nl(u) > 0 since l(w) > 0. If we let q1 = w(0, l(u), 1) = q2\u2032 and q1\u2032 = w(\u2212l(u), 0, 1) = q2 , we\nagain immediately obtain a contradiction of (sparse 1).\n\u0003\nWe will build 2-dimensional CW-complexes using information from the sparse word w\nto define the attaching maps. To start, let P be a polygon with n sides; that is, P is a\nCW -complex with n vertices, n edges and a single 2-cell. We designate a distinguished\nvertex \u03c3(P ) of P . We orient the edges of P in a clockwise direction, and label the edges\nof P so that w is read clockwise from \u03c3(P ) to \u03c3(P ) on the boundary \u2202P . In addition,\nwe label the vertices of P by the elements of Z/nZ, starting with 0 at \u03c3(P ) and labeling\nin order also in the clockwise direction.\nWe will build finite 2-complexes iteratively from the n-gon P by successively attaching\nnew copies of P at existing vertices and applying certain edge foldings. More specifically,\ngiven a finite collection of copies F1 ,F2 ,...,Fm of P , first attach the vertex \u03c3(F2 ) to any\nvertex of F1 other than \u03c3(F1 ). At the glued vertex v, if there are two edges incident\nto v with either (1) the same orientation and edge label, or (2) opposite orientation\nand edge labels that are inverse letters in X \u222a X \u22121 , then we identify those edges to\na single 1-cell (and identify the vertices at the other ends to a single vertex). Repeat\nthis successively at all of the vertices of the complex until no further edge identification\naccording to rules (1)\u2013(2) can be done, to obtain a new CW-complex with two 2-cells.\nDenote the images of F1 and F2 in the quotient by F\u03041 and F\u03042 , respectively, and denote\nthe image of \u03c3(Fi ) by \u03c3\u0304(Fi ) for i = 1, 2. At the i-th step, we attach Fi to the complex\nF\u03041 \u222a * * * \u222a F\u0304i\u22121 by identifying \u03c3(Fi ) with a vertex v \u2032 other than one of the \u03c3\u0304(Fj ) for j < i.\nWe again glue edges according to rules (1)\u2013(2) (where the orientation and label of any\nedge incident to a face F\u0304j can be considered to be that inherited from Fj ), to obtain a\nquotient CW-complex with i faces. (Note that at each step, the complex is finite, so this\nprocess must stop.) We say that the face Fi is folded onto F\u03041 \u222a * * * \u222a F\u0304i\u22121 at v \u2032 , or that\nFi is attached at v \u2032 .\nThis process is repeated to create a CW-complex with images F\u03041 ,...,F\u0304m of the original\npolygons as faces. For any index j and vertex v in F\u0304j , let i(Fj , v) denote the index (or\nthe set of indices) of the vertex (resp. vertices) in Fj that is sent to v via the canonical\nmap Fj \u2192 F\u03041 \u222a * * * \u222a F\u0304m .\n\n\f4\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\nNote that as a consequence of Lemma 2.1, the two edges of a single face F incident to\n\u03c3(F ) cannot be identified to a single edge in this procedure. The definition of sparse also\nimplies restrictions on edge gluings in complexes built from two or three faces, as the\nfollowing lemmas demonstrate. These lemmas will be applied to determine the structure\nof the Sch\u00fctzenberger complex of 1 in Section 3.\nLemma 2.3 (The two-face lemma). Let F\u03041 \u222a F\u03042 be the CW-complex obtained by\nfolding one face F2 onto another face F1 at a vertex v 6= \u03c3(F1 ). Then \u03c3\u0304(F1 ) \u2208\n/ F \u03041 \u2229 F \u03042 .\nProof. Suppose to the contrary that \u03c3\u0304(F1 ) \u2208 F \u03041 \u2229 F \u03042 . Since F2 is folded onto the single\nface F1 , there must be a path in F \u03041 \u2229 F \u03042 from \u03c3\u0304(F1 ) to v = \u03c3\u0304(F2 ). The preimage of this\npath under the map F1 \u2192 F\u03041 \u222a F\u03042 is a path in \u2202F1 starting at the vertex \u03c3(F1 ), and\nso this path defines a cyclic subword q1 of w starting at vertex 0 when w is viewed as a\nword labeling \u2202F1 . Similarly, this path defines a cyclic subword q1\u2032 of w ending at vertex\n0 when w is viewed as a word labeling \u2202F2 . The two pairs of cyclic subwords (q1 , q1\u2032 )\nand (q2 , q2\u2032 ) := (q1\u2032 , q1 ) satisfy 0 \u2208 zone(q1 ) \u2229 zone(q2\u2032 ), contradicting Definition 1.1.\n\u0003\nLemma 2.4 (The three-face lemma). Suppose that the face F2 is folded onto the face\nF1 with at least one pair of edges glued, and suppose that face F3 is folded onto a vertex\nv \u2208 F \u03041 \u2229 F \u03042 . Then no edges are glued via the folding process for F3 ; that is, no edge of\nF3 can be glued to an edge of F \u03041 \u222a F \u03042 , and no two edges of F \u03041 \u222a F \u03042 are identified.\nProof. By construction, F\u03041 \u2229 F\u03042 is a connected non-empty edge path containing \u03c3\u0304(F2 )\nand the vertex v = \u03c3\u0304(F3 ), so there is a subpath p1 of F\u03041 \u2229 F\u03042 with endpoints \u03c3\u0304(F2 ) and\n\u03c3\u0304(F3 ). When viewed as a path in \u2202F2 , p1 determines a cyclic subword q1\u2032 = w(i\u20321 , j1\u2032 , \u01eb\u20321 )\nsuch that zone(q1\u2032 ) contains both 0 = i(F2 , \u03c3\u0304(F2 )) and the index i(F2 , v) of the vertex\ncorresponding to v. When viewed as a path in \u2202F1 , p1 determines a cyclic subword\nq1 = w(i1 , j1 , \u01eb1 ) such that zone(q1 ) contains i(F1 , \u03c3\u0304(F2 )) and i(F1 , v).\nSuppose that some edge of F3 is glued onto an edge of F\u03041 \u222a F\u03042 .\nCase 1. F3 folds onto an edge of F\u03041 . Then there is a non-trivial path p2 in F\u03041 \u2229 F\u03043 with\nendpoint v = \u03c3\u0304(F3 ). When viewed as a path in \u2202F3 , p2 determines a cyclic subword q2\u2032 =\nw(i\u20322 , j2\u2032 , \u01eb\u20322 ) with 0 \u2208 zone(q2\u2032 ). When viewed as a path in \u2202F1 , p2 determines a cyclic word\nq2 = w(i2 , j2 , \u01eb2 ) such that i(F1 , v) \u2208 zone(q2 ). Then i(F1 , v) \u2208 zone(q1 ) \u2229 zone(q2 ) 6= \u2205.\nBut i1 \u2212 \u01eb1 \u01eb\u20321 i\u20321 = i(F1 , \u03c3\u0304(F2 )) and i2 \u2212 \u01eb2 \u01eb\u20322 i\u20322 = i(F1 , v), so i1 \u2212 \u01eb1 \u01eb\u20321 i\u20321 6= i2 \u2212 \u01eb2 \u01eb\u20322 i\u20322 ,\ncontradicting condition (sparse 2) of Definition 1.1. Thus Case 1 cannot occur.\nCase 2. F3 folds onto an edge of F\u03042 . Then there is a non-trivial path p3 in F\u03042 \u2229 F\u03043 with\nendpoint v = \u03c3\u0304(F3 ). When viewed as a path in \u2202F3 , p3 determines a cyclic subword\nq3\u2032 = w(i\u20323 , j3\u2032 , \u01eb\u20323 ) with 0 \u2208 zone(q3\u2032 ). When viewed as a path in \u2202F2 , p3 determines\na cyclic subword q3 = w(i3 , j3 , \u01eb3 ) with i(F2 , v) \u2208 zone(q3 ). In this case, i(F2 , v) \u2208\nzone(q1\u2032 ) \u2229 zone(q3 ) 6= \u2205, so condition (sparse 1) fails, a contradiction.\nSince no edge of F3 is folded onto any edge of F \u03041 \u222a F \u03042 , no additional edge folding can\noccur in F \u03041 \u222a F \u03042 .\n\u0003\n3. The Sch\u00fctzenberger complex SC(1)\nThroughout this section, w will denote a fixed sparse word and M = InvhX | w = 1i.\nWe recall that the Sch\u00fctzenberger graph of 1 for this presentation is the restriction of the\nCayley graph of M to the R-class of 1. We denote this graph by S\u0393(1): its vertices are\nthe elements s \u2208 M such that ss\u22121 = 1 in M and there is an edge labeled by x \u2208 X \u222aX \u22121\nfrom s to t if ss\u22121 = tt\u22121 = 1 and sx = t in M . We denote this edge by (s, x, t). Its\ninverse edge is the edge (t, x\u22121 , s) in S\u0393(1), where we interpret (x\u22121 )\u22121 = x, and this\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n5\n\ninverse pair is interpreted as a single topological edge. The Sch\u00fctzenberger complex of 1\nis the complex SC(1) obtained from S\u0393(1) by adding a face with boundary label w for\neach closed path labeled by w in S\u0393(1). Stephen's iterative construction of a sequence\nof approximations of the Sch\u00fctzenberger graph S\u0393(1) may easily be adapted to yield\na sequence of approximations of the Sch\u00fctzenberger complex SC(1). In particular, we\nmay construct such a sequence of complexes in the following way.\nStart with a trivial complex S0 consisting of one vertex v0 and no edges or faces.\nTake a copy F1 of the n-gon P , identify its start vertex \u03c3(P ) with v0 , and denote this\ncomplex by S1 . As in Section 2, we build a sequence of complexes S1 = F\u03041 , S2 = F\u03041 \u222a F\u03042 ,\nS3 = F\u03041 \u222a F\u03042 \u222a F\u03043 , ... by successively folding faces Fi onto F\u03041 \u222a F\u03042 \u222a * * * \u222a F\u0304i\u22121 at vertices\nvi\u22121 \u2208 Si\u22121 at which no face has yet been attached, in such a way that d(v0 , vi\u22121 ) is as\nsmall as possible, where d is the path metric in Si\u22121 . Lemma 2.2 guarantees that such\na vi\u22121 exists. To see this, note that if no such vi\u22121 exists, then S\u0393(1) = Si\u22121 , so S\u0393(1)\nis finite. Thus if x is the first letter in w, since xj labels a path in S\u0393(1) for each j > 0\nwe see that x is a torsion element in M (i.e. xj = xk for some k 6= j). It follows that x\nmust be a torsion element of G = GphX|w = 1i, but G is torsion free if w is primitive.\nA sequence of complexes obtained in the above manner is referred to as a Sch\u00fctzenberger approximation sequence. Since vi = \u03c3\u0304(Fi+1 ) is chosen so as to minimize the\ndistance from v0 , we can see that every vertex of Si is the start vertex of some face in Si+j\nfor some j. From the results of Stephen [Step90], the corresponding sequence of 1-skeleta\nof a Sch\u00fctzenberger approximation sequence has a direct limit that is independent of the\nchoice of the vertices vi , and this direct limit is S\u0393(1). By an argument similar to the\nformal category theoretical argument in [Step90] used to show this, it follows that the\nSch\u00fctzenberger approximation sequence of complexes has a direct limit, and since the\napproximation sequence attaches faces whenever a closed path labeled by w is attached,\nthe limit of the Sch\u00fctzenberger approximation sequence is the Sch\u00fctzenberger complex\nSC(1).\nTheorem 3.1. Let S0 , S1 , S2 , . . . be any Sch\u00fctzenberger approximation sequence for\nSC(1) corresponding to a sparse word w. Then for all m \u2265 0 and for all distinct faces\nF\u0304i , F\u0304j , F\u0304k , F\u0304l in Sm\n(1) The natural map Fi \u2192 F\u0304i is an embedding of Fi into Sm .\n(2) If F\u0304i \u2229 F\u0304j 6= \u2205, then F\u0304i \u2229 F\u0304j is a connected path such that either \u03c3\u0304(Fi ) \u2208 F\u0304j with\n\u03c3\u0304(Fj ) \u2208\n/ F\u0304i , or \u03c3\u0304(Fj ) \u2208 F\u0304i with \u03c3\u0304(Fi ) \u2208\n/ F\u0304j .\n(3) If F\u0304i \u2229 F\u0304j \u2229 F\u0304k 6= \u2205, then there exists r \u2208 {i, j, k} with F\u0304i \u2229 F\u0304j \u2229 F\u0304k = \u03c3\u0304(Fr ) and\nF\u0304r shares no other vertices with the other two faces.\n(4) F\u0304i \u2229 F\u0304j \u2229 F\u0304k \u2229 F\u0304l = \u2205.\n(5) The natural map from Sm\u22121 to Sm is an embedding.\nProof. The proof proceeds by induction on m. The result is clear if m is 0 or 1. Suppose\nthat the result is true for approximation sequences of length m \u2212 1. Let v be the vertex\nof Sm\u22121 at which Fm is attached to Sm\u22121 . From part (4) of the induction assumption,\nat most three faces contain the point v.\nCase 1. Suppose that v is on the boundary of three faces in Sm\u22121 . Then by part\n(3) of the induction assumption, one of these faces F\u0304 satisfies v = \u03c3\u0304(F ). But then the\nalgorithm for constructing the Sch\u00fctzenberger approximation sequence would not attach\nFm at v also. Hence Case 1 cannot occur.\nCase 2. Suppose that v is on the boundary of exactly two faces F\u0304i and F\u0304j in Si\u22121 .\nBy part (2) of the induction hypothesis, we may assume without loss of generality that\n\n\f6\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\n\u03c3\u0304(Fi ) \u2208 F\u0304j and again by this induction hypothesis there is a non-trivial path in F\u0304i \u2229 F\u0304j\nfrom v to \u03c3\u0304(Fi ). Then by the three-face lemma, no edge of Fm is glued onto any edge\nof F\u0304i \u222a F\u0304j at v, and hence no edge of Fm is glued onto any edge of Sm\u22121 at all. Hence\nproperties (1)\u2013(5) of the statement of the theorem hold for Sm .\nCase 3. Suppose that v is on the boundary of exactly one face F\u0304i of Sm\u22121 . Consider\nthe complex S\u02c6m obtained from Sm\u22121 and Fm by just gluing edges of Fm and F\u0304i starting\nfrom v, and no additional edge foldings. Then F\u0304i \u2229 F\u0302m is a connected path. If there exists\na vertex v \u2032 in F\u0304i \u2229 F\u02c6m with v \u2032 6= v = \u03c3\u0302(Fm ), the two-face lemma says that v \u2032 6= \u03c3\u0304(Fi ) also.\nIn this case the three-face lemma then says that any other face incident to v \u2032 cannot\ncontain an edge that can be identified with an edge of either F\u0304i or F\u02c6m in a further folding\nprocess. Thus in any case no further edges can be glued, and S\u02c6m = Sm . Hence properties\n(1)\u2013(5) of the statement of the theorem hold for Sm .\n\u0003\nUsing part (5) of Theorem 3.1, we may consider S0 \u2282 S1 \u2282 S2 \u2282 S3 \u2282 * * * , and so\nSC(1) = \u222a\u221e\nm=0 Sm for any Sch\u00fctzenberger approximation sequence constructed as above.\nHence the corollary below follows immediately.\nCorollary 3.2. Properties (1)\u2013(5) of Theorem 3.1 hold with Sm replaced by SC(1).\nFor every Sch\u00fctzenberger approximation sequence, there is a vertex v0 which is the\nunique vertex incident to only one face in the direct limit, and so there is a unique vertex\nin SC(1), which we will also call v0 , that is incident to only one face, which we will refer\nto throughout as the face F1 . For any face A of SC(1), the sparse property of w implies\nthat there is only one vertex in \u2202A that can be the start vertex \u03c3\u0304(A), and only one\npossible orientation starting from this vertex in which the word w labels the boundary\npath.\nFor distinct faces A and B of SC(1), we define A < B if the face A must be attached\nbefore the face B in every Sch\u00fctzenberger approximation sequence. The corresponding\npartial ordering \u2264 is the face ordering on the faces of SC(1). This partial ordering is\nwell-founded, and the face F1 is a minimal element.\nCorollary 3.3 (Order Corollary). Let v be a vertex of SC(1), and let B be the face\nwith v = \u03c3\u0304(B).\n(1) If v is incident to exactly one other face A, then A < B.\n(2) If v is incident to two other faces A and C with \u03c3\u0304(C) \u2208 A, then A < B and\nA < C.\n(3) If v is incident to a face A and A \u2229 B contains at least one edge, then A < B.\nProof. Let S0 , S1 , S2 , . . . be any Sch\u00fctzenberger approximation sequence for SC(1) corresponding to a sparse word w, with face Fi attached to Si\u22121 in the construction of Si ,\nas above. In the case that v is incident only to faces A = F\u0304j and B = F\u0304k , the vertex v\nmust exist in a complex Si before B can be attached, and so we must have j < k.\nIn the case that v is also incident to a third face C = F\u0304l with \u03c3\u0304(C) \u2208 A, then Theorem\n3.1 says that A \u2229 C contains a connected non-empty edge path from \u03c3\u0304(C) to v, and so\nat the vertex \u03c3\u0304(C), an edge of C is glued to an edge of A. Again applying Theorem 3.1,\nno face other than A and C can be incident to \u03c3\u0304(C) in any of the Si . Then as in the\nparagraph above, we have j < l. Now the face Fk can be attached at v only after v has\nbeen built in the sequence, and hence only after at least one of Fj , Fl has been attached.\nTherefore j < k also.\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n7\n\nFinally, if v \u2208 A and A \u2229 B contains at least one edge, then Theorem 3.1 says that no\nother face can be incident to v, and so the first paragraph of this proof applies.\n\u0003\n4. The dual graph and the word problem\nIn this section we define a notion of a dual graph of the Sch\u00fctzenberger complex SC(1)\nfor an inverse monoid M = InvhX | w = 1i corresponding to a sparse word w. We show\nthat this dual graph is a tree and we make use of this to provide a solution to the word\nproblem for M .\nDefinition 4.1. Let w be a sparse word. The dual graph of SC(1) for M = InvhX | w =\n1i is the directed graph D with\n\u2022 vertex set V (D) given by the set of faces of SC(1), and\n\u2022 set E(D) of directed edges (A, B) (oriented from A to B) for A, B \u2208 V (D)\nsatisfying A < B in the face ordering and A \u2229 B 6= \u2205 in SC(1).\nAs a consequence of Corollaries 3.2 and 3.3, the definition of E(D) can also be phrased\npurely in terms of the combinatorial properties of SC(1), namely (A, B) is a directed\nedge in D if and only if A 6= B, \u03c3\u0304(B) \u2208 A, and whenever C \u2208 V (D) with \u03c3\u0304(B) \u2208 C then\n\u03c3\u0304(C) \u2208 A.\nProposition 4.2. Let w be a sparse word and M = InvhX | w = 1i. Then the dual graph\nD of SC(1) is a directed, rooted, infinite tree (with root F1 ) in which each vertex has at\nmost l(w) \u2212 1 children.\nProof. Recall that the face F1 is the only face of SC(1) containing the unique vertex v0\nof SC(1) incident to only one face. Let A 6= F1 be any other face in SC(1), and assume\nby Noetherian induction that for all faces B < A with respect to the well-founded face\nordering, there is a directed edge path in D from F1 to B. From Corollary 3.2, there are\neither 2 or 3 faces incident to the vertex \u03c3\u0304(A) in SC(1), including A.\nIf there is only one other face B incident to \u03c3\u0304(A), then the Order Corollary 3.3 implies\nthat B < A. Since \u03c3\u0304(B) \u2208 A \u2229 B 6= \u2205, then (B, A) \u2208 E(D). The concatenation of the\npath from F1 to B from the induction assumption with this edge (B, A) then gives a\ndirected edge path in D from F1 to A.\nOn the other hand, if there are two other faces B and C incident to \u03c3\u0304(A), then\nCorollary 3.2 says that one of these faces contains the \u03c3\u0304 vertex of the other; without loss\nof generality, suppose that \u03c3\u0304(C) \u2208 B. Then the Order Corollary 3.3 again implies that\nB < A, and as in the previous paragraph we obtain a directed path in D from F1 to A.\nHence D is connected.\nSuppose that D is not a tree. Then there is an undirected circuit in this graph.\nSuppose that two edges of this circuit have a common target; that is, suppose that\nthere are edges (A, C), (B, C) \u2208 E(D) with A 6= B. Using the combinatorial description\nof E(D) above, then \u03c3\u0304(C) \u2208 A \u2229 B. From Corollary 3.2 part (2), A \u2229 B is a path\ncontaining one of \u03c3\u0304(A) or \u03c3\u0304(B) but not both. This contradicts the existence of one of\nthe edges (A, C), (B, C), and so the circuit must also be a directed circuit.\nThe consecutive vertices A1 , A2 , ..., Ak following the directed edges in this circuit must\nthen satisfy A1 < A2 < * * * Ak < A1 in the face ordering, which is again a contradiction.\nHence D is a directed tree with root F1 .\nSince each face A of SC(1) has l(w) \u2212 1 vertices other than its vertex \u03c3\u0304(A), there are\nat most l(w) \u2212 1 directed edges in D with source vertex A. In addition, as remarked in\n\n\f8\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\nSection 3, the fact that w is primitive guarantees SC(1) is infinite. Therefore the tree D\nmust be infinite.\n\u0003\nTo simplify notation later, it will be helpful to consider a slight modification of D.\nThe augmented dual graph D \u2032 is obtained from D by adding an additional vertex v0\nto D and an additional directed edge from v0 to F1 . Then D \u2032 is a directed rooted tree\nwith root v0 . Using standard language for rooted trees, if (A, B) is a directed edge in\nD \u2032 , we call A the parent of B, and B a child of A.\nDefine a map \u03a9 : V (SC(1)) \u2192 V (D \u2032 ) as follows. For each vertex v 6= v0 in SC(1), let\n\u03a9(v) be the unique face of SC(1) that is closest to v0 in D \u2032 from among the faces that\nare incident to v, and let \u03a9(v0 ) := v0 .\nFor any face A of SC(1), then \u03a9(\u03c3\u0304(A)) is the parent of A, and so \u03a9(\u03c3\u0304(A)) < A; i.e.,\n\u03a9(\u03c3\u0304(A)) must be attached before A in any Sch\u00fctzenberger approximation. By Corollaries\n3.2 and 3.3, in the folding process edges of A can be glued to edges of \u03a9(\u03c3\u0304(A)) but not\nto edges of any other face, and the glued edges are a connected path. Recall that the\nboundary \u2202A of the polygon A is labeled by the word w, when read starting at the vertex\n\u03c3(A) in the clockwise direction. The connected set \u03b3(A) := A \u2229 \u03a9(\u03c3\u0304(A)), then, can be\nregarded as the image of a (\"gluing\") path (which we will also call \u03b3(A)) going clockwise\naround \u2202A from the (\"reverse\") vertex \u03c1(A) to the (\"forward\") vertex \u03c6(A). Note that if\nno edges are glued when A is attached to its parent \u03a9(\u03c3\u0304(A)), then \u03c1(A) = \u03c3\u0304(A) = \u03c6(A)\nand \u03b3(A) is this point.\nLemma 4.3. Let A be a face of the complex SC(1) for a sparse word w.\n(1) The lengths l(w) and l(\u03b3(A)) satisfy l(\u03b3(A)) \u2264 12 l(w) \u2212 1.\n(2) If v is a vertex in \u03b3(A), then \u03a9(v) = \u03a9(\u03c3\u0304(A)).\n(3) If v is a vertex in \u2202A \\ \u03b3(A), then \u03a9(v) = A.\nProof. The path \u03b3(A) determines a cyclic subword q \u2032 of w when viewed as a path in \u2202A,\nand determines a cyclic subword q when viewed as a path in the parent \u2202\u03a9(\u03c3\u0304(A)) of A.\nSince w is sparse we must have zone(q \u2032 ) \u2229 zone(q) = \u2205, (take (q1 , q1\u2032 ) = (q2 , q2\u2032 ) = (q, q \u2032 )\nin Definition 1.1), and so there must also be at least one edge between the endpoints of\nthese cyclic subwords on both sides. Then l(w) \u2265 2l(\u03b3(A)) + 2.\nIf v is a vertex in \u03b3(A), then by definition of the set \u03b3, the point v is also in the\nparent \u03a9(\u03c3\u0304(A)) of A. If there is a third face C incident to v in SC(1), then by the order\ncorollary and the definition of D \u2032 , the face \u03a9(\u03c3\u0304(A)) is also the parent of C.\nFor a vertex v in \u2202A \\ \u03b3(A), then v = \u03c3\u0304(B) for another face B of SC(1). If there is no\nother face incident to v, the order corollary then says A < B. If C is a third face incident\nto v, then Corollary 3.2 says that A and C must share at least one edge in common, and\neither \u03c3\u0304(A) is in C, or \u03c3\u0304(C) is in A. The order corollary then says that the face among\nA and C that contains the start vertex \u03c3\u0304 of the other is the parent of the pair. However,\nsince v \u2208\n/ \u03a9(\u03c3\u0304(A)), we must have C 6= \u03a9(\u03c3\u0304(A)), and hence \u03c3\u0304(C) \u2208 A and A is the parent\nof both B and C.\n\u0003\nLet the 1-skeleton S\u0393(1) of the 2-complex SC(1) have the path metric dS\u0393 , and let\nthe augmented dual graph have path metric dD\u2032 . The following theorem shows that\ngeodesics in these metric spaces are closely related.\nTheorem 4.4 (Geodesic Theorem). Let p be any geodesic edge path in S\u0393(1) from\nv0 to a vertex v. Let v0 , v1 , ..., vk = v be the successive vertices in the path p. Then\nfor all i, either \u03a9(vi ) = \u03a9(vi+1 ) or \u03a9(vi ) is the parent of \u03a9(vi+1 ) in D \u2032 , and the edge\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n9\n\nfrom vi to vi+1 is contained in \u03a9(vi+1 ). Moreover, whenever \u03a9(vi ) < \u03a9(vi+1 ), then\nvi \u2208 {\u03c1(\u03a9(vi+1 )), \u03c6(\u03a9(vi+1 ))}.\nProof. We prove this by induction on the length k of the edge path p. If k = 0, then p is\nthe constant path at v0 in SC(1), and there is no other vertex. If k = 1, then p follows\na single edge from v0 to v1 6= v0 . Then \u03a9(v0 ) = v0 is the parent of \u03a9(v1 ) = F1 in D \u2032 .\nSuppose that k \u2265 2. The prefix p\u0302 of the path p with vertices v0 , ..., vk\u22121 is also a\ngeodesic path in S\u0393(1), and so by induction the conditions on the pair \u03a9(vi ), \u03a9(vi+1 ) in\nthe theorem hold for all 0 \u2264 i \u2264 k \u2212 2. The vertex vk\u22121 6= v0 , so Corollary 3.2 says that\nthere are at least two faces A := \u03a9(vk\u22121 ) and B with \u03c3\u0304(B) = vk\u22121 , and possibly a third\nface C, incident to the vertex v in SC(1). By definition of \u03a9 and the Order Corollary,\nwe have A < B and A < C. The edge e from vk\u22121 to vk must be contained in at least\none of these faces.\nCase 1. Suppose that e is contained in A. If vk is in the path \u03b3(A), then Lemma 4.3\nimplies that \u03a9(vk ) = \u03a9(\u03c3\u0304(A)), but since \u03a9(vk\u22121 ) = A, the same lemma implies that vk\u22121\nis not in \u03b3(A). Then vk must be one of the endpoints \u03c1(A), \u03c6(A) of \u03b3(A). By induction,\nthe prefix p\u0302 of p traversed one of these endpoints, and since p is a geodesic, p\u0302 must have\ntraversed the endpoint v \u2032 of \u03b3(A) that is not vk . However, this implies that a suffix of\np is a geodesic in \u2202A from v \u2032 to vk that goes through the point vk\u22121 not in \u03b3(A). This\ncontradicts Lemma 4.3(1), and so vk must lie in \u2202A \\ \u03b3(A). Lemma 4.3(3) then implies\nthat \u03a9(vk ) = A = \u03a9(vk\u22121 ).\nCase 2. Suppose that e is contained in a child E of the face A, but not in A. That\nis, E is one of the faces B or C. In this case, since vk is not contained in A \u2229 E, then\nLemma 4.3(3) says that \u03a9(vk ) is E, and we have that \u03a9(vk\u22121 ) = A is the parent of\n\u03a9(vk ). Moreover, since vk\u22121 is in A \u2229 E but vk is not, we have that vk\u22121 is one of the\nendpoints \u03c1(E), \u03c6(E) of \u03b3(E).\n\u0003\nWe can now provide a solution to the word problem for M .\nProof of Theorem 1.2. As noted in Section 1, it is sufficient to prove that there is\nan algorithm that takes a word u \u2208 (X \u222a X \u22121 )\u2217 as input, and outputs whether or not\nu = 1 in M . Given a sparse word w, the following procedure is such an algorithm for\nM = InvhX | w = 1i.\nLet L := l(u) be the length of the word u. The algorithm follows the construction\nof a Sch\u00fctzenberger approximation sequence as described at the beginning of Section\n3, attaching a face at each step to a vertex whose distance to v0 in the approximation\ncomplex is minimal from among all of those vertices that are not yet the start vertex (\u03c3\u0304)\nof a face. Continue this process until the next vertex at which a face is to be attached\nhas distance L * l(w) + 1 from v0 ; the process stops at this time, with an approximation\ncomplex S. Since each complex in this sequence is locally finite, this process is finite.\nFrom Theorem 3.1 we know that S embeds in SC(1). From the Geodesic Theorem\n4.4, we have that for each vertex v in S, any geodesic path p in S\u0393(1) from v0 to v is\ncontained in the union of the the faces labeling vertices of the geodesic in D \u2032 from v0 to\n\u03a9(v). By the definition of the map \u03a9, these are the faces that must be constructed in\nthe Sch\u00fctzenberger approximation sequence before the face \u03a9(v), together with the face\n\u03a9(v) which must be the first face containing v constructed in the sequence. Hence all of\nthese faces are also in S, as is the path p. Therefore the path metric dS in the 1-skeleton\nof S is the same as the metric inherited from S\u0393(1).\n\n\f10\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\nWe claim that every face A of SC(1) with dD\u2032 (v0 , A) \u2264 L lies in S. Suppose not; that\nis, suppose that there is a face A with dD\u2032 (v0 , A) \u2264 L and A not in S, and choose A to\nhave minimal distance from v0 in D \u2032 among all such faces. Then the parent \u03a9(\u03c3\u0304(A)) of\nA satisfies dD\u2032 (v0 , \u03a9(\u03c3\u0304(A))) = dD\u2032 (v0 , A) \u2212 1, and so \u03a9(\u03c3\u0304(A)) lies in S. But the previous\nparagraph and Theorem 4.4 imply that dS (v0 , \u03c3\u0304(A)) = dS\u0393 (v0 , \u03c3\u0304(A)) < L * l(w), and so\nS has a vertex \u03c3\u0304(A) within L * l(w) of v0 that is not the start vertex of an attached face,\ngiving the required contradiction.\nNow let v \u2032 be any vertex of SC(1) with dS\u0393 (v0 , v \u2032 ) \u2264 L. It follows from Theorem 4.4\nthat dD\u2032 (v0 , \u03a9(v \u2032 )) \u2264 L also, and so by the previous paragraph, \u03a9(v \u2032 ), and hence also v \u2032 ,\nis in the finite complex S. Putting these results together, we have that u labels a path\nfrom v0 to v0 in SC(1) if and only if u labels a path from v0 to v0 in S. Since u = 1 in\nM if and only if u labels a path in SC(1) from v0 to v0 , the algorithm outputs u = 1 if\nu labels a path from v0 to v0 in S, and outputs u 6= 1 in M otherwise.\n\u0003\n5. Languages of geodesics and words representing 1\nThroughout this section, w is a sparse word and M = InvhX | w = 1i.\nLemma 5.1. Let A be any face in SC(1). There is a unique point xA in \u2202A \\ \u03b3(A)\nsatisfying dS\u0393 (v0 , xA ) \u2265 dS\u0393 (v0 , y) for all y \u2208 \u2202A.\nProof. First consider points in the set T := \u2202A \\ \u03b3(A). Lemma 4.3(3) and the Geodesic\nTheorem 4.4 imply that every geodesic from v0 to a point y in T must traverse one of the\npoints \u03c1(A), \u03c6(A), and then follow edges in the path along T to y. Let a := dS\u0393 (v0 , \u03c1(A)),\nb := dS\u0393 (v0 , \u03c6(A)), and q := l(\u03b3(A)), and let p be the length of the edge path in T from\n\u03c1(A) to \u03c6(A). The triangle inequality together with Lemma 4.3(1) give |b\u2212a| \u2264 q \u2264 p\u22121.\nLet x be the point in T that is a distance 21 (p + (b \u2212 a)) < p from the endpoint \u03c1(A);\nthen x is a distance 12 (p + (a \u2212 b)) along T from \u03c6(A). Now the concatenation of a\ngeodesic path from v0 to \u03c1(A) followed by the geodesic in T from \u03c1(A) to x has the\nsame length 21 (p + a + b) as the concatenation of a geodesic path from v0 to \u03c6(A)\nfollowed by the geodesic in T from \u03c6(A) to x, and hence both of these concatenations\nare geodesics from v0 to x. Since every other point y \u2208 T lies on one of these paths, we\nhave dS\u0393 (v0 , x) > dS\u0393 (v0 , y).\nSimilarly, let z be the point in \u03b3(A) that is a distance 21 (q + (b \u2212 a)) \u2264 q from the\nendpoint \u03c1(A) along the path \u03b3(A), and hence a distance 12 (q + (a \u2212 b)) from \u03c6(A). The\nconcatenation of a geodesic from v0 to either \u03c1(A) or \u03c6(A), together with the geodesic\nalong \u03b3(A) from that endpoint to z, has length 12 (q + a + b), and every point y in\n\u03b3(A) lies on one of these path concatenations. Hence for all y \u2208 \u03b3(A), we also have\n\u0003\ndS\u0393 (v0 , x) = 21 (p + a + b) > 21 (q + a + b) \u2265 dS\u0393 (v0 , y).\nFor a face A of SC(1), choose Z representatives \u00ee(A, \u03c1(A)) and \u00ee(A, \u03c6(A)) of the\nindices i(A, \u03c1(A)) and i(A, \u03c6(A)) from Z/nZ, respectively, satisfying 0 \u2264 \u00ee(A, \u03c6(A)) <\n\u00ee(A, \u03c1(A)) \u2264 n = l(w). Similarly, for each vertex v in \u2202A \\ \u03b3(A), let \u00ee(A, v) be the\nrepresentative of i(A, v) satisfying 0 < \u00ee(A, v) < n; from Lemma 4.3, then \u00ee(A, \u03c6(A)) <\n\u00ee(A, v) < \u00ee(A, \u03c1(A)).\nDefine kA := 21 [\u00ee(A, \u03c1(A)) + \u00ee(A, \u03c6(A)) + (dS\u0393 (v0 , \u03c1(A)) \u2212 dS\u0393 (v0 , \u03c6(A)))]. The proof\nabove shows that the point xA lies at the index i(A, xA ) = kA (mod nZ) if xA is a vertex,\notherwise xA lies at the midpoint of the edge whose endpoints y, z are the vertices with\nindices i(A, y), i(A, z) given by kA \u00b1 21 (mod nZ).\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n11\n\nDefinition 5.2. For any face A of SC(1), we define the associated triple f t(A) :=\n(\u00ee(A, \u03c1(A)), \u00ee(A, \u03c6(A)), kA ). We define an equivalence relation \u223cf t on the set of faces of\nSC(1) by A \u223cf t B if and only f t(A) = f t(B); in this case, we say that A and B have the\nsame face type. Define an equivalence relation \u223cf t on the set of vertices of SC(1) by\nu \u223cf t v if and only if \u03a9(u) \u223cf t \u03a9(v) and i(\u03a9(u), u) = i(\u03a9(v), v). Denote the equivalence\nclass of a vertex or face z relative to \u223cf t by [z].\nNote that there are only finitely many face types, and similarly only finitely many\n\u223cf t -equivalence classes of vertices. For example, it follows from this definition that if A\nis a face of SC(1) that is attached to \u03a9(\u03c3\u0304(A)) at the vertex \u03c3\u0304(A) in such a way that no\nedge of A folds onto \u03a9(\u03c3\u0304(A)), then the triple for A is (n, 0, n/2), and A \u223cf t F1 . Since\n\u03a9(v0 ) is not a face of SC(1), the \u223cf t -equivalence class [v0 ] contains only the vertex v0 .\nThe following lemma will be used in the constructions of a push-down automaton and\na finite state automaton later in this section.\nLemma 5.3. In SC(1) let u1 , u2 be vertices with u1 \u223cf t u2 and let e1 = (u1 , x, v1 ) be\nan edge. Suppose that either\n(i) \u03a9(u1 ) = \u03a9(v1 ),\n(ii) (\u03a9(u1 ), \u03a9(v1 )) \u2208 E(D \u2032 ), or\n(iii) (\u03a9(v1 ), \u03a9(u1 )) \u2208 E(D \u2032 ) and \u03c3\u0304(\u03a9(u1 )) \u223cf t \u03c3\u0304(\u03a9(u2 )).\nThen there is an edge e2 = (u2 , x, v2 ) in SC(1) with v1 \u223cf t v2 satisfying, respectively,\n(i) \u03a9(u2 ) = \u03a9(v2 ) and \u00ee(\u03a9(u1 ), v1 ) lies between \u00ee(\u03a9(u1 ), u1 ) and k\u03a9(u1 ) (inclusive) if and\nonly if \u00ee(\u03a9(u2 ), v2 ) lies between \u00ee(\u03a9(u2 ), u2 ) and k\u03a9(u2 ) .\n(ii) (\u03a9(u2 ), \u03a9(v2 )) \u2208 E(D \u2032 ) and \u03c3\u0304(\u03a9(v1 )) \u223cf t \u03c3\u0304(\u03a9(v2 )), or\n(iii) (\u03a9(v2 ), \u03a9(u2 )) \u2208 E(D \u2032 ).\nProof. Suppose first that u1 = v0 . Then u1 \u223cf t u2 implies that u2 = v0 = u1 , and the\nresult of the lemma follows. For the remainder of the proof, we assume that u1 6= v0 ,\nand as a consequence u2 6= v0 . Let Ai be the face \u03a9(ui ) for i = 1, 2. By definition of\nu1 \u223cf t u2 , then A1 \u223cf t A2 and i(A1 , u1 ) = i(A2 , u2 ).\nSuppose that (i) \u03a9(u1 ) = \u03a9(v1 ) holds. Then the edge e1 lies in the face A1 . The\nfaces A1 and A2 are copies of the same polygon with the same boundary label word\nw, and we have i(A1 , u1 ) = i(A2 , u2 ), hence there is an edge e2 = (u2 , x, v2 ) in the\nboundary of A2 with i(A1 , v1 ) = i(A2 , v2 ). From the definition of A1 \u223cf t A2 , we have\n\u00ee(A1 , \u03c6(A1 )) = \u00ee(A2 , \u03c6(A2 )) and \u00ee(A1 , \u03c1(A1 )) = \u00ee(A2 , \u03c1(A2 )). From Lemma 4.3, the\nedge e1 lies in \u2202A1 \\ \u03b3(A1 ), and so we have \u00ee(A1 , \u03c6(A1 )) < \u00ee(A1 , v1 ) < \u00ee(A1 , \u03c1(A1 )).\nThen \u00ee(A2 , \u03c6(A2 )) < \u00ee(A2 , v2 ) < \u00ee(A2 , \u03c1(A2 )), and so v2 lies in \u2202A2 \\ \u03b3(A2 ). Applying\nthe same lemma again gives \u03a9(v2 ) = A2 . Then both v1 \u223cf t v2 and the betweenness\ncondition follow directly.\nNext suppose that (ii) (\u03a9(u1 ), \u03a9(v1 )) \u2208 E(D \u2032 ). In this case, B1 := \u03a9(v1 ) is a face of\nSC(1). Since A1 < B1 , the edge e1 lies in B1 , the vertices u1 and \u03c3\u0304(B1 ) (which may or\nmay not be the same point) both lie in A1 \u2229 B1 , and v1 lies in B1 \\ \u03b3(B1 ). Let B2 be\nthe face of SC(1) whose vertex \u03c3\u0304(B2 ) lies at the vertex of \u2202A2 satisfying i(A2 , \u03c3\u0304(B2 )) =\ni(A1 , \u03c3\u0304(B1 )). Again using the fact that the pairs of polygons A1 , B1 and A2 , B2 have the\nsame boundary labels, the gluings of B2 onto A2 correspond to the gluings of B1 onto A1 .\nHence u2 \u2208 A2 \u2229B2 , and there is an edge (u2 , x, v2 ) in B2 with v2 \u2208\n/ A2 . Since \u03a9(u2 ) = A2 ,\nwe have A2 < B2 , and so (A2 , B2 ) \u2208 E(D \u2032 ). In addition, we have \u00ee(C1 , \u03c1(B1 )) =\n\u00ee(C2 , \u03c1(B2 )) and \u00ee(C1 , \u03c6(B1 )) = \u00ee(C2 , \u03c6(B2 )) for Ci \u2208 {Ai , Bi } and \u00ee(B1 , v1 ) = \u00ee(B2 , v2 ).\nSince B1 = \u03a9(v1 ), then \u00ee(B1 , v1 ) lies strictly between \u00ee(B1 , \u03c6(B1 )) and \u00ee(B1 , \u03c1(B1 )), and\n\n\f12\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\nhence \u00ee(B2 , v2 ) lies strictly between \u00ee(B2 , \u03c6(B2 )) and \u00ee(B2 , \u03c1(B2 )), giving B2 = \u03a9(v2 ).\nThe property \u03c3\u0304(\u03a9(v1 )) \u223cf t \u03c3\u0304(\u03a9(v2 )) follows immediately. Now A1 \u223cf t A2 implies that\nkA1 = kA2 . Lemma 5.1 shows that dS\u0393 (v0 , \u03c1(Bi )) = dS\u0393 (v0 , xAi )\u2212dS\u0393 (xAi , \u03c1(Bi )) for i =\n1, 2, and similarly for \u03c6(Bi ). Then dS\u0393 (v0 , \u03c1(B1 )) \u2212 dS\u0393 (v0 , \u03c6(B1 )) = dS\u0393 (xA1 , \u03c6(B1 )) \u2212\ndS\u0393 (xA1 , \u03c1(B1 )) = |kA1 \u2212 \u00ee(A1 , \u03c6(B1 ))| \u2212 |kA1 \u2212 \u00ee(A1 , \u03c1(B1 ))|. Since all of these numbers\nare the same if the subscript 1 is replaced by 2 everywhere, then we have dS\u0393 (v0 , \u03c1(B1 ))\u2212\ndS\u0393 (v0 , \u03c6(B1 )) = dS\u0393 (v0 , \u03c1(B2 )) \u2212 dS\u0393 (v0 , \u03c6(B2 )). This shows that kB1 = kB2 , which is\nthe last item needed to show that B1 \u223cf t B2 . Therefore v1 \u223cf t v2 .\nFinally, suppose that (iii) (\u03a9(v1 ), \u03a9(u1 )) \u2208 E(D \u2032 ) and \u03c3\u0304(\u03a9(u1 )) \u223cf t \u03c3\u0304(\u03a9(u2 )). Suppose further that \u03c3\u0304(A1 ) = v0 . Then v1 = v0 and A1 = \u03a9(u1 ) = F1 . In this case\n\u03c3\u0304(\u03a9(u2 )) = v0 , and so A1 = A2 , u1 = u2 , and the lemma holds.\nOn the other hand, suppose that \u03c3\u0304(A1 ) = \u03c3\u0304(\u03a9(u1 )) 6= v0 . Then Ei := \u03a9(\u03c3\u0304(Ai ) is\na face of SC(1) for i = 1, 2, and we also have (E2 , A2 ) \u2208 D \u2032 and E1 = \u03a9(v1 ). The\ndefinition of \u03c3\u0304(A1 ) \u223cf t \u03c3\u0304(A2 ) implies that E1 \u223cf t E2 and i(E1 , \u03c3\u0304(A1 )) = i(E2 , \u03c3\u0304(A2 )).\nNow the edge gluings in the folding of A1 onto its parent face E1 and in the folding of\nA2 onto E2 must be the same. The edge e1 = (u1 , x, v1 ) lies in A1 with u1 in \u2202A1 \\ \u03b3(A1 )\nand v1 in \u03b3(A1 ), and there must be a corresponding edge e2 = (u2 , x, v2 ) in the face\nA2 . Then i(A1 , v1 ) = i(A2 , v2 ), and so v2 lies in \u03b3(A2 ). Hence E2 = \u03a9(v2 ). Finally\nthe correspondence in edge gluings together with i(E1 , \u03c3\u0304(A1 )) = i(E2 , \u03c3\u0304(A2 )) imply that\ni(E1 , v1 ) = i(E2 , v2 ), and so v1 \u223cf t v2 .\n\u0003\nNext we use the face type classes of vertices in SC(1) to build a deterministic pushdown automaton, following the notation for a PDA in [HU79, p.110].\nDefinition 5.4. Let P = (Q, \u03a3, \u0393, \u03b4, q0 , Z0 , F ) be the deterministic pushdown automaton\nwith state set Q = {[v] | v \u2208 V (SC(1))}, input alphabet \u03a3 = X \u222a X \u22121 , stack alphabet \u0393 =\n{[v] | v \u2208 V (SC(1))}, initial state q0 = [v0 ], initial stack symbol Z0 = [v0 ], final (accept)\nstate F = {[v0 ]}, and transition function the partial function \u03b4 : Q \u00d7 \u03a3 \u00d7 \u0393 \u2192 Q \u00d7 \u0393\u2217 for\nwhich \u03b4([u], x, [t]) is defined only if there is an edge (u, x, v) for some vertex v in SC(1),\nby\n\uf8f1\nif \u03a9(u) = \u03a9(v)\n\uf8f2 ([v], [t])\n([v], [\u03c3(\u03a9(v))][t]) if (\u03a9(u), \u03a9(v)) \u2208 E(D \u2032 )\n\u03b4([u], x, [t]) :=\n\uf8f3\n([v], \u01eb)\nif (\u03a9(v), \u03a9(u)) \u2208 E(D \u2032 ), [t] = [\u03c3\u0304(\u03a9(u))]\n\nThe undefined transitions for \u03b4 are viewed as going to a fail state. Note that for an\nedge (u, x, v) in SC(1) satisfying v0 6= v = \u03c3\u0304(\u03a9(u)) = \u03c1(\u03a9(u)) = \u03c6(\u03a9(u)), so that the\nface \u03a9(u) is attached at v but no edges are glued, the last case of the definition of \u03b4\ncan be split into two subcases. In this situation we have \u03a9(u) \u223cf t F1 , and there is an\nedge (u1 , x, v0 ) in F1 with u1 \u223cf t u. If [t] = [v] 6= [v0 ], then \u03b4([u], x, [t]) := ([v], \u01eb), but\nif [t] = [v0 ], then \u03b4([u], x, [t]) := ([v0 ], \u01eb). The fact that \u03b4 is well-defined follows directly\nfrom Lemma 5.3.\nAn instantaneous description (\u03b1, z, \u03b2) for the PDA P consists of the current state\n\u03b1 \u2208 Q of the machine, the word z \u2208 (X \u222a X \u22121 )\u2217 that remains to be read, and the\ncurrent contents \u03b2 \u2208 \u0393\u2217 of the stack, where the first letter of \u03b2 is the \"top\" of the stack.\nWe write (\u03b1, yz, \u03b2) \u22a2\u2217 (\u03b1\u2032 , z, \u03b2 \u2032 ) if, when y is read in starting from (\u03b1, yz, \u03b2), the PDA\nreaches (\u03b1\u2032 , z, \u03b2 \u2032 ), and write \u22a2 when a single letter y \u2208 X \u222a X \u22121 is read.\nDefine a function \u03b2 : V (SC(1)) \u2192 \u0393\u2217 as follows. Given any vertex v in SC(1), let\nv0 , F1 , ..., Fm = \u03a9(v) be the labels of the vertices along the geodesic path in the tree\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n13\n\nD \u2032 from v0 to \u03a9(v). Then \u03b2(v) is the associated word over the stack alphabet given by\n\u03b2(v) := [\u03c3\u0304(Fm )] * * * [\u03c3\u0304(F1 )][v0 ].\nProposition 5.5. Let w be sparse, and let SC(1) be the Sch\u00fctzenberger complex of\n1 for M = InvhX | w = 1i. Let \u03b1 \u2208 Q, y, z \u2208 (X \u222a X \u22121 )\u2217 , and \u03b2 \u2208 \u0393\u2217 . Then\n([v0 ], yz, [v0 ]) \u22a2\u2217 (\u03b1, z, \u03b2) if and only if y labels an edge path in SC(1) starting at v0 and\n\u03b1 = [v] and \u03b2 = \u03b2(v) where v is the end vertex of this path.\nProof. First we prove the forward implication, by induction on the length of y. If l(y) = 0,\nthen y = \u01eb and ([v0 ], \u01ebz, [v0 ]) \u22a2\u2217 (\u03b1, z, \u03b2) implies that \u03b1 = [v0 ], and \u03b2 = [v0 ] = \u03b2(v0 ).\nThe path starting at v0 labeled by y = \u01eb ends at v = v0 , as required.\nNow, suppose that the forward implication holds for any word \u1ef9 with 0 \u2264 l(\u1ef9) < l(y),\nand write y = y \u2032 x with x \u2208 X \u222a X \u22121 . Suppose that ([v0 ], yz, [v0 ]) \u22a2\u2217 (\u03b1, z, \u03b2). Then we\nhave ([v0 ], y \u2032 xz, [v0 ]) \u22a2\u2217 (\u03b1\u2032 , xz, \u03b2 \u2032 ) \u22a2 (\u03b1, z, \u03b2) for some \u03b1\u2032 \u2208 Q and \u03b2 \u2032 \u2208 \u0393\u2217 . By induction,\nthe word y \u2032 labels a path \u03c0 \u2032 in SC(1) starting at v0 , and \u03b1\u2032 = [u] and \u03b2 \u2032 = \u03b2(u) where\nu is the ending vertex of the path \u03c0 \u2032 .\nSince (\u03b1\u2032 , xz, \u03b2 \u2032 ) \u22a2 (\u03b1, z, \u03b2), the transition function \u03b4 is defined on the triple (\u03b1\u2032 , x, \u03b3),\nwhere \u03b3 is the first letter of the word \u03b2(u) \u2208 \u0393\u2217 . This means that there is a representative\n\u0169 of the \u223cf t -class \u03b1\u2032 such that there is an edge of the form e = (\u0169, x, v) in SC(1) for some\nvertex v, and either (i) \u03a9(\u0169) = \u03a9(v), (ii) (\u03a9(\u0169), \u03a9(v)) \u2208 E(D \u2032 ), or (iii) \u03b3 = [\u03c3\u0304(\u03a9(\u0169))] and\n(\u03a9(v), \u03a9(\u0169)) \u2208 E(D \u2032 ). In cases (i) and (ii), Lemma 5.3 shows that we may take \u0169 = u.\nIn case (iii), notice that the first letter \u03b3 of \u03b2(u) satisfies \u03b3 = [\u03c3\u0304(\u03a9(u))] if \u03a9(u) 6= v0 , and\n\u03b3 = [v0 ] if \u03a9(u) = v0 . However, if \u03a9(u) = v0 , then u = v0 , and since [\u0169] = \u03b1\u2032 = [u], then\n\u0169 = v0 , contradicting the existence of the edge (\u03a9(v), \u03a9(\u0169)) in D \u2032 . Then \u03a9(u) 6= v0 , and\nso we also may take \u0169 = u in this case.\nThen in all three cases, the path \u03c0 \u2032 followed by the edge e is a path in SC(1) labeled\nby the word y starting at v0 and ending at the vertex v. Moreover, we have \u03b1 = [v].\nIn case (i), \u03b4(\u03b1\u2032 , x, \u03b3) = ([v], \u03b3), and the stack word \u03b2 = \u03b2 \u2032 = \u03b2(u) is unchanged by\nthis transition. Since \u03a9(u) = \u03a9(v), then \u03b2 = \u03b2(v).\nIn case (ii), \u03b4(\u03b1\u2032 , x, \u03b3) = ([v], [\u03c3\u0304(\u03a9(v))]\u03b3), and we have \u03b2 = [\u03c3\u0304(\u03a9(v))]\u03b2(u). Since\n(\u03a9(u), \u03a9(v)) \u2208 E(D \u2032 ), we again have \u03b2 = \u03b2(v).\nIn case (iii), \u03b4(\u03b1\u2032 , x, \u03b3) = ([v], \u01eb). Now (\u03a9(v), \u03a9(u)) \u2208 E(D \u2032 ) implies that \u03b2(u) =\n[\u03c3\u0304(\u03a9(u))]\u03b2(v), and we have \u03b2 = \u03b2(v) in this case as well.\nThis completes the proof of the forward implication.\nFor the reverse implication, we again induct on the length l(y). If l(y) = 0, the as\nbefore y = \u01eb labels a path from v0 to v0 , and so ([v0 ], yz, [v0 ]) \u22a2\u2217 (\u03b1, z, \u03b2) where \u03b1 = [v0 ]\nand \u03b2 = [v0 ] = \u03b2(v0 ).\nSuppose again that l(y) > 0 and write y = y \u2032 x with x \u2208 X \u222a X \u22121 . By hypothesis,\ny labels a path in SC(1) from v0 ; let v be the vertex at the end of this path, and let\nu be the penultimate vertex; that is, u is at the end of the path labeled by y \u2032 . By\ninduction we have ([v0 ], yz, [v0 ]) \u22a2\u2217 ([u], xz, \u03b2(u)). The definition of \u03b4 then shows that\n([v0 ], yz, [v0 ]) \u22a2\u2217 ([v], z, \u03b2(v)).\n\u0003\nWe can now prove Theorems 1.3 and 1.4.\nProof of Theorem 1.3\nFor a word y \u2208 (X \u222a X \u22121 )\u2217 , we have y = 1 in M if and only if y labels an edge\npath from v0 to v0 in S\u0393(1). Proposition 5.5 shows that the latter holds if and only if\n([v0 ], y, [v0 ]) \u22a2\u2217 ([v0 ], \u01eb, \u03b2) for some \u03b2; that is, exactly when the PDA P finishes in the\n\n\f14\n\nSUSAN HERMILLER, STEVEN LINDBLAD, AND JOHN MEAKIN\n\naccept state [v0 ]. Thus, the set of words representing the identity element in M is a\ndeterministic context-free language.\nThe word y is in the language of words related to 1 in M by Green's relation R if and\nonly if y labels a path starting at v0 in S\u0393(1), which holds if and only if ([v0 ], y, [v0 ]) \u22a2\u2217\n(\u03b1, \u01eb, \u03b2) for some \u03b1 \u2208 Q and \u03b2 \u2208 \u0393\u2217 . Let P\u2032 be the PDA P with the the set of final\n(accept) states changed to F = Q. Then we have y is accepted by P\u2032 if and only if y is\nin the R-equivalence class R1 of 1. Hence the set of words representing an element of R1\nin M is also a deterministic context-free language.\n\u0003\nProof of Theorem 1.4\nLet (Q, \u03a3, \u03b4, q0 , F ) be the finite state automaton with state set Q = {[v] | v \u2208 V (SC(1))},\ninput alphabet \u03a3 = X \u222a X \u22121 , initial state q0 = [v0 ], final (accept) states F = Q, and\ntransition function the partial function \u03b4 : Q \u00d7 \u03a3 \u2192 Q, defined by \u03b4([u], x) := [v] if there\nis an edge (u, x, v) in SC(1) and either\n(i) \u03a9(u) = \u03a9(v) and either \u00ee(\u03a9(u), u) < \u00ee(\u03a9(u), v) \u2264 k\u03a9(u) or \u00ee(\u03a9(u), u) > \u00ee(\u03a9(u), v) \u2265\nk\u03a9(u) , or\n(ii) (\u03a9(u), \u03a9(v)) \u2208 E(D \u2032 )\nLemma 5.3 shows that this transition function is well-defined.\nLet p be an arbitrary path in SC(1) starting at v0 . Let v0 , v1 , ..., vm be the sequence of\nconsecutive vertices traversed by p, and let Ai := \u03a9(vi ). Note that the path p is geodesic\nif and only if dS\u0393 (v0 , vi\u22121 ) > dS\u0393 (v0 , vi ) for all i.\nIf (Ai , Ai\u22121 ) \u2208 E(D \u2032 ), then the Geodesic Theorem 4.4 says that p is not a geodesic.\nIf (Ai\u22121 , Ai ) \u2208 E(D \u2032 ), then vi \u2208 \u2202Ai \\ \u03b3(Ai ) = \u2202Ai \\ Ai\u22121 , and the vertex vi\u22121 must\nbe one of the endpoints \u03c1(Ai ), \u03c6(Ai ) of the gluing path of Ai onto Ai\u22121 ; let ui be the\nother. The Geodesic Theorem 4.4 says that any geodesic from v0 to vi must pass through\none of the points vi\u22121 , ui . Since dS\u0393 (vi\u22121 , vi ) = 1, then Lemma 4.3(1) shows that such\na geodesic must also pass through vi\u22121 . Hence dS\u0393 (v0 , vi ) > dS\u0393 (v0 , vi\u22121 ). Finally, if\nAi\u22121 = Ai , then vi\u22121 and vi are both vertices in \u2202Ai \\ \u03b3(Ai ). By Lemma 5.1, it follows\nthat dS\u0393 (v0 , vi ) > dS\u0393 (v0 , vi\u22121 ) if and only if either i(Ai , vi\u22121 ) < i(Ai , vi ) \u2264 kAi or\ni(Ai , vi\u22121 ) > i(Ai , vi ) \u2265 kAi .\nIn the proof of Theorem 1.3, we showed that a word y labels a path starting at v0\nin SC(1) if and only if it is accepted by the PDA P\u2032 , which is the PDA in Definition\n5.4 but for which all states in Q are final (accept) states. Note that the only transitions\nof this PDA which utilize the stack in determining the next state are those associated\nwith edges from u to v with (\u03a9(v), \u03a9(u)) \u2208 E(D \u2032 ). Combining this with the previous\nparagraph, then, the finite state automaton defined above is precisely the underlying\nfinite state automaton of the PDA P\u2032 consisting only of transitions associated with edges\n(u, x, v) such that d(v0 , v) > d(v0 , u). Thus this finite state automaton accepts precisely\nthe words which label geodesic paths in SC(1).\n\u0003\nRemark 1. The minimized form of the finite state automaton defined in the proof of\nTheorem 1.4 is the automaton of cone types of S\u0393(1). As an example, S. Haataja showed\nthat the automaton of cone types for S\u0393(1) for the sparse word w = aba\u22121 b\u22121 cdc\u22121 d\u22121\ncorresponding to the surface group of genus 2 has 19 cone types (unpublished manuscript). A description of Haataja's example may be found in Meakin's survey article\n[Me07].\n\n\fINVERSE MONOIDS PRESENTED BY A SINGLE SPARSE RELATOR\n\n15\n\nRemark 2. Descriptions of an iterative construction of the PDA in Definition 5.4 and\nan implementation of the algorithm for solving the word problem is provided in S. Lindblad's PhD thesis [Lin03]. The software is available from http://www.math.unl.edu/\u223cshermiller2/lindblad/\n.\nRemark 3. In their paper [IMM01], Ivanov, Margolis and Meakin show that the word\nproblem for the inverse monoid M = InvhX | w = 1i corresponding to a cyclically reduced\nword w is solvable if the membership problem for the submonoid of the corresponding\none-relator group G = GphX|w = 1i generated by the prefixes of w is solvable. However\nas far as we are aware, it is not known whether the prefix membership problem for this\nsubmonoid of G is equivalent to the word problem for M in general. In particular, it\nis not known whether this prefix membership problem for G is solvable if w is a sparse\nword.\nReferences\n[BMM94] Birget, J.-C., Margolis, S. W. and Meakin, J. C., The word problem for inverse monoids\npresented by one idempotent relator, Theoret. Comput. Sci. 123 (1994), no. 2, 273\u2013289.\n[CP67]\nClifford, A. H., Preston, G. P. The Algebraic Theory of Semigroups, Math. Surveys 7, Amer.\nMath. Soc., Providence 1961 (Vol I) and 1967 (Vol. II).\n[HU79]\nHopcroft, J. E. and Ullman, J. D., Introduction to automata theory, languages, and computation, Addison-Wesley Publishing Co., Reading, Mass., 1979, Addison-Wesley Series in\nComputer Science.\n[IMM01] Ivanov,S. V., Margolis, S. W. and Meakin, J. C., On one-relator inverse monoids and onerelator groups, J. Pure Appl. Algebra 159 (2001), no. 1, 83\u2013111.\n[Law98]\nLawson, M. V., Inverse semigroups, World Scientific Publishing Co. Inc., River Edge, NJ,\n1998.\n[Lin03]\nLindblad, S P., Inverse monoids presented by a single sparse relator, PhD Thesis, Univ. of\nNebraska-Lincoln, 2003.\n[Me07]\nMeakin, J C., Groups and semigroups: connections and contrasts, Proceedings, Groups St\nAndrews 2005, London Math. Soc. Lecture Note Series 340, Vol 2, 2007, 357-400.\n[MMS05] Margolis, S., Meakin, J. and \u0160uni\u1e31, Z., Distortion functions and the membership problem for\nsubmonoids of groups and monoids, Contemporary Mathematics 372 (2005) 109-129.\n[Mun74] Munn, W. D., Free inverse semigroups, Proc. London Math. Soc. 29 (1974), no. 3, 385\u2013404.\n[Step90] Stephen, J. B., Presentations of inverse monoids, J. Pure Appl. Algebra 63 (1990), no. 1,\n81\u2013112.\n[Step93] Stephen, J. B., Inverse monoids and rational subsets of related groups, Semigroup Forum 46\n(1993), no. 1, 98\u2013108.\n[Stei03]\nSteinberg, B.,A topological approach to inverse and regular semigroups, Pacific J. Math. 208\n(2003), no. 2, 367\u2013396.\nSusan Hermiller, Department of Mathematics, University of Nebraska, Lincoln NE\n68588-0130, USA\nE-mail address: smh@math.unl.edu\nSteve Lindblad, Hewitt Associates LLC, 45 South 7th Street, Suite 2100, Minneapolis\nMN 55402, USA\nE-mail address: splindblad@gmail.com\nJohn Meakin, Department of Mathematics, University of Nebraska, Lincoln NE 685880130, USA\nE-mail address: jmeakin@math.unl.edu\n\n\f"}