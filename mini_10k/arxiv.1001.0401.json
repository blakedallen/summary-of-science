{"id": "http://arxiv.org/abs/1001.0401v4", "guidislink": true, "updated": "2012-01-09T13:22:50Z", "updated_parsed": [2012, 1, 9, 13, 22, 50, 0, 9, 0], "published": "2010-01-03T19:35:59Z", "published_parsed": [2010, 1, 3, 19, 35, 59, 6, 3, 0], "title": "Numerical simulation of BSDEs with drivers of quadratic growth", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1001.4168%2C1001.0831%2C1001.1259%2C1001.2920%2C1001.4419%2C1001.2609%2C1001.1179%2C1001.3235%2C1001.3842%2C1001.0276%2C1001.4608%2C1001.1547%2C1001.0647%2C1001.2264%2C1001.2919%2C1001.5369%2C1001.3076%2C1001.4771%2C1001.1408%2C1001.1048%2C1001.3619%2C1001.0873%2C1001.1574%2C1001.3380%2C1001.4042%2C1001.0372%2C1001.4507%2C1001.4789%2C1001.3818%2C1001.3905%2C1001.2777%2C1001.4678%2C1001.2011%2C1001.4344%2C1001.2372%2C1001.2528%2C1001.2127%2C1001.4932%2C1001.3095%2C1001.1342%2C1001.4023%2C1001.4446%2C1001.4936%2C1001.4403%2C1001.5139%2C1001.4095%2C1001.2684%2C1001.0585%2C1001.0363%2C1001.2320%2C1001.1264%2C1001.2720%2C1001.3817%2C1001.4604%2C1001.1834%2C1001.5243%2C1001.0419%2C1001.1851%2C1001.5160%2C1001.0197%2C1001.0895%2C1001.3396%2C1001.2518%2C1001.3900%2C1001.0558%2C1001.4774%2C1001.0531%2C1001.0277%2C1001.0172%2C1001.2791%2C1001.1973%2C1001.0580%2C1001.0119%2C1001.4954%2C1001.2312%2C1001.4880%2C1001.4482%2C1001.2477%2C1001.2435%2C1001.1673%2C1001.4925%2C1001.4256%2C1001.0352%2C1001.2380%2C1001.3490%2C1001.2786%2C1001.1616%2C1001.2055%2C1001.2778%2C1001.5178%2C1001.5088%2C1001.3482%2C1001.3602%2C1001.4140%2C1001.4617%2C1001.4085%2C1001.0401%2C1001.2281%2C1001.1307%2C1001.2065%2C1001.1096&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Numerical simulation of BSDEs with drivers of quadratic growth"}, "summary": "This article deals with the numerical resolution of Markovian backward\nstochastic differential equations (BSDEs) with drivers of quadratic growth with\nrespect to $z$ and bounded terminal conditions. We first show some bound\nestimates on the process $Z$ and we specify the Zhang's path regularity\ntheorem. Then we give a new time discretization scheme with a non uniform time\nnet for such BSDEs and we obtain an explicit convergence rate for this scheme.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1001.4168%2C1001.0831%2C1001.1259%2C1001.2920%2C1001.4419%2C1001.2609%2C1001.1179%2C1001.3235%2C1001.3842%2C1001.0276%2C1001.4608%2C1001.1547%2C1001.0647%2C1001.2264%2C1001.2919%2C1001.5369%2C1001.3076%2C1001.4771%2C1001.1408%2C1001.1048%2C1001.3619%2C1001.0873%2C1001.1574%2C1001.3380%2C1001.4042%2C1001.0372%2C1001.4507%2C1001.4789%2C1001.3818%2C1001.3905%2C1001.2777%2C1001.4678%2C1001.2011%2C1001.4344%2C1001.2372%2C1001.2528%2C1001.2127%2C1001.4932%2C1001.3095%2C1001.1342%2C1001.4023%2C1001.4446%2C1001.4936%2C1001.4403%2C1001.5139%2C1001.4095%2C1001.2684%2C1001.0585%2C1001.0363%2C1001.2320%2C1001.1264%2C1001.2720%2C1001.3817%2C1001.4604%2C1001.1834%2C1001.5243%2C1001.0419%2C1001.1851%2C1001.5160%2C1001.0197%2C1001.0895%2C1001.3396%2C1001.2518%2C1001.3900%2C1001.0558%2C1001.4774%2C1001.0531%2C1001.0277%2C1001.0172%2C1001.2791%2C1001.1973%2C1001.0580%2C1001.0119%2C1001.4954%2C1001.2312%2C1001.4880%2C1001.4482%2C1001.2477%2C1001.2435%2C1001.1673%2C1001.4925%2C1001.4256%2C1001.0352%2C1001.2380%2C1001.3490%2C1001.2786%2C1001.1616%2C1001.2055%2C1001.2778%2C1001.5178%2C1001.5088%2C1001.3482%2C1001.3602%2C1001.4140%2C1001.4617%2C1001.4085%2C1001.0401%2C1001.2281%2C1001.1307%2C1001.2065%2C1001.1096&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "This article deals with the numerical resolution of Markovian backward\nstochastic differential equations (BSDEs) with drivers of quadratic growth with\nrespect to $z$ and bounded terminal conditions. We first show some bound\nestimates on the process $Z$ and we specify the Zhang's path regularity\ntheorem. Then we give a new time discretization scheme with a non uniform time\nnet for such BSDEs and we obtain an explicit convergence rate for this scheme."}, "authors": ["Adrien Richou"], "author_detail": {"name": "Adrien Richou"}, "author": "Adrien Richou", "links": [{"href": "http://arxiv.org/abs/1001.0401v4", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1001.0401v4", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1001.0401v4", "affiliation": "IRMAR", "arxiv_url": "http://arxiv.org/abs/1001.0401v4", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "The Annals of Applied Probability\n2011, Vol. 21, No. 5, 1933\u20131964\nDOI: 10.1214/10-AAP744\nc Institute of Mathematical Statistics, 2011\n\narXiv:1001.0401v4 [math.PR] 9 Jan 2012\n\nNUMERICAL SIMULATION OF BSDES WITH DRIVERS OF\nQUADRATIC GROWTH\nBy Adrien Richou\nUniversit\u00e9 Rennes 1\nThis article deals with the numerical resolution of Markovian\nbackward stochastic differential equations (BSDEs) with drivers of\nquadratic growth with respect to z and bounded terminal conditions.\nWe first show some bound estimates on the process Z and we specify\nthe Zhang's path regularity theorem. Then we give a new time discretization scheme with a nonuniform time net for such BSDEs and\nwe obtain an explicit convergence rate for this scheme.\n\n1. Introduction. Since the early nineties, there has been an increasing\ninterest for backward stochastic differential equations (BSDEs). These equations have a wide range of applications in stochastic control, in finance or\nin partial differential equation theory. A particular class of BSDE has been\nstudied for a few years: BSDEs with drivers of quadratic growth with respect to the variable z. This class arises, for example, in the context of utility\noptimization problems with exponential utility functions or alternatively in\nquestions related to risk minimization for the entropic risk measure (see,\ne.g., [13]). Many papers deal with existence and uniqueness of solution for\nsuch BSDEs; we refer the reader to [17, 18] when the terminal condition\nis bounded and [3, 4, 9] for the unbounded case. Our concern is rather related to the simulation of BSDEs and more precisely time discretization of\nBSDEs coupled with a forward stochastic differential equation (SDE). Actually, the design of efficient algorithms which are able to solve BSDEs in\nany reasonable dimension has been intensely studied since the first work of\nChevance [6] (see, e.g., [1, 11, 19]). But in all these works, the driver of the\nBSDE is a Lipschitz function with respect to z and this assumption plays a\nkey role in their proofs. In a recent paper, Cheridito and Stadje [5] studied\napproximation of BSDEs by backward stochastic difference equations which\nare based on random walks instead of Brownian motions. They obtain a\nReceived February 2010; revised September 2010.\nAMS 2000 subject classifications. Primary 60H35; secondary 65C30, 60H10.\nKey words and phrases. BSDEs, driver of quadratic growth, time discretization scheme.\n\nThis is an electronic reprint of the original article published by the\nInstitute of Mathematical Statistics in The Annals of Applied Probability,\n2011, Vol. 21, No. 5, 1933\u20131964. This reprint differs from the original in\npagination and typographic detail.\n1\n\n\f2\n\nA. RICHOU\n\nconvergence result when the driver has a subquadratic growth with respect\nto z and they give an example where this approximation does not converge\nwhen the driver has a quadratic growth. To the best of our knowledge, the\nonly work where the time approximation of a BSDE with a quadratic growth\nwith respect to z is studied is the one of Imkeller and Reis [14]. Notice that,\nwhen the driver has a specific form (roughly speaking, the driver is a sum\nof a quadratic term z 7\u2192 C|z|2 and a function that has a linear growth with\nrespect to z), it is possible to get around the problem by using an exponential transformation method (see [15]) or by using results on fully coupled\nforward\u2013backward differential equations (see [7]).\nTo explain the ideas of this paper, let us introduce (X, Y, Z) the solution\nto the forward\u2013backward system\nZ t\nZ t\n\u03c3(s) dWs ,\nb(s, Xs ) ds +\nXt = x +\n0\n\n0\n\nYt = g(XT ) +\n\nZ\n\nT\n\nf (s, Xs , Ys , Zs ) ds \u2212\nt\n\nZ\n\nT\n\nZs dWs ,\nt\n\nwhere g is bounded, f is locally Lipschitz and has a quadratic growth with\nrespect to z. A well-known result is that when g is a Lipschitz function\nwith Lipschitz constant Kg , then the process Z is bounded by C(Kg + 1)\n(see Theorem 3.1). So, in this case, the driver of the BSDE is a Lipschitz\nfunction with respect to z and we are able to use standard results about\ndiscretization of BSDEs. Because of the above observation, this paper will\nfocus on the case that the terminal function g is not Lipschitz. To obtain\nour main results, we will assume that g is an \u03b1-H\u00f6lder function but it is also\npossible to adapt our methods when g is not \u03b1-H\u00f6lder; for example, Remark\n4.13 deals with the case of an indicator function of a smooth domain. Let\nus notice that the time approximation of BSDEs with an irregular terminal\nfunction has already been studied by Gobet and Makhlouf [12] when the\ngenerator is a Lipschitz function with respect to z.\nIn light of previous observation, a simple idea is to do an approximation\nof (Y, Z) by the solution (Y N , Z N ) to the BSDE\nZ T\nZ T\nZsN dWs ,\nf (s, Xs , YsN , ZsN ) ds \u2212\nYtN = gN (XT ) +\nt\n\nt\n\nwhere gN is a Lipschitz approximation of g. Thanks to bounded mean oscillation martingale (BMO martingale in the sequel) tools, we have an error\nestimate for this approximation (see, e.g., [2, 14] or Proposition 4.2). For ex\u2212\u03b1/(1\u2212\u03b1)\nample, if g is \u03b1-H\u00f6lder, we are able to obtain the error bound CKgN\n(see Proposition 4.11). Moreover, we can have an error estimate for the time\ndiscretization of the approximated BSDE thanks to any numerical scheme\nfor BSDEs with Lipschitz driver. But this error estimate depends on KgN ;\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n3\n\n2\n\nroughly speaking, this error is CeCKgN n\u22121 with n the number of discretization times. The exponential term results from the use of Gronwall's inequality. Finally, when g is \u03b1-H\u00f6lder and KgN = N , the global error bound is\n\u0012\n2\u0013\neCN\n1\n+\n(1)\n.\nC\nn\nN \u03b1/(1\u2212\u03b1)\n\nSo, when N increases, n\u22121 will have to become small very quickly and the\nspeed of convergence turns out to be bad; if we take N = ( C\u03b5 log n)1/2 with\n0 < \u03b5 < 1, then the global error bound becomes C\u03b5 (log n)\u2212\u03b1/(2(1\u2212\u03b1)) . The\nsame drawback appears in the work of Imkeller and Reis [14]. Indeed, their\nidea is to do an approximation of (Y, Z) by the solution (Y N , Z N ) to the\ntruncated BSDE\nZ T\nZ T\nN\nN\nN\nZsN dWs ,\nf (s, Xs , Ys , hN (Zs )) ds \u2212\nYt = g(XT ) +\nt\n\nt\n\n: R1\u00d7d\n\nR1\u00d7d\n\nwhere hN\n\u2192\nis a smooth modification of the projection on the\nopen Euclidean ball of radius N about 0. Thanks to several statements\nconcerning the path regularity and stochastic smoothness of the solution\nprocesses, the authors show that for any \u03b2 \u2265 1, the approximation error is\nlower than C\u03b2 N \u2212\u03b2 . So they obtain the global error bound\n\u0012\n2\u0013\n1\neCN\nC\u03b2\n+\n(2)\nN\u03b2\nn\n\nand, consequently, the speed of convergence also turns out to be bad; if we\ntake N = ( C\u03b5 log n)1/2 with 0 < \u03b5 < 1, then the global error bound becomes\nC\u03b2,\u03b5 (log n)\u2212\u03b2/2 .\nAnother idea is to use an estimate of Z that does not depend on Kg . So\nwe extend a result of [8] which shows\n(3)\n\n|Zt | \u2264 M1 +\n\nM2\n,\n(T \u2212 t)1/2\n\n0 \u2264 t < T.\n\nLet us notice that this type of estimation is well known in the case of drivers\nwith linear growth as a consequence of the Bismut\u2013Elworthy formula (see,\ne.g., [10]). But in our case, we do not need to suppose that \u03c3 is invertible.\nThen, thanks to this estimation, we know that when t < T , f (t, *, *, *) is a\nLipschitz function with respect to z and the Lipschitz constant depends\non t. So we are able to modify the classical uniform time net to obtain a\nconvergence speed for a modified time discretization scheme for our BSDE;\nthe idea is to put more discretization points near the final time T than near\n0. Roughly speaking, our discretization grid is equal to\n\u0012\n\u0012 \u0013k/n \u0013\n\u03b5\ntk := T 1 \u2212\n,\n0 \u2264 k \u2264 n,\nT\n\n\f4\n\nA. RICHOU\n\nwith \u03b5 a parameter. But due to technical reasons we need to apply this\nmodified time discretization scheme to the approximated BSDE\nZ T\nZ T\nN,\u03b5\n\u03b5\nN,\u03b5\nN,\u03b5\nZsN,\u03b5 dWs\nf (s, Xs , Ys , Zs ) ds \u2212\nYt = gN (XT ) +\nt\n\nt\n\nwith\n\nf \u03b5 (s, x, y, z) := 1s\u2264T \u2212\u03b5f (s, x, y, z) + 1s>T \u2212\u03b5 f (s, x, y, 0).\nThanks to the estimate (3), we obtain a speed convergence for the time\ndiscretization scheme of this approximated BSDE (see Theorem 4.9). Moreover, BMO tools give us again an estimate of the approximation error\n(see Proposition 4.2). Finally, if we suppose that g is \u03b1-H\u00f6lder, we prove\nthat we can choose properly N and \u03b5 to obtain the global error estimate\nCn\u22122\u03b1/((2\u2212\u03b1)(2+K)\u22122+2\u03b1) (see Theorem 4.14) where K > 0 depends on constant M2 defined in equation (3) and constants related to f . Let us notice\nthat such a speed of convergence where constants related to f , g, b and \u03c3\nappear in the power of n is unusual. Even if we have an error far better than\n(1) or (2), this result is not very interesting in practice because the speed of\nconvergence strongly depends on K. But, when b is bounded, we prove that\nwe can take M2 as small as we want in (3). Finally, we obtain a global error\nestimate lower than C\u03b7 n\u2212(\u03b1\u2212\u03b7) for all \u03b7 > 0 (see Theorem 4.17).\nTo conclude, it could be interesting to do some comparisons between our\nwork and the article of Gobet and Makhlouf [12]. We already explain that\nthis paper studies the time approximation of Lipschitz BSDEs with irregular\nterminal functions. These authors show that the error of approximation is\nlower than C\u03b7 n\u2212\u03b1 when g is an \u03b1-H\u00f6lder function and the discretization\ngrid is uniform. So, our better speed of convergence is very close to their\nresult. Nevertheless, they also show that it is possible to obtain the classical\nspeed of convergence, that is to say Cn\u22121 , when we use the nonuniform grid\ngiven by\n\u0012\n\u0013\nk 1/\u03b2\ntk := T \u2212 T 1 \u2212\n,\n0 \u2264 k \u2264 n,\nn\n\nwith \u03b2 < \u03b1. It is interesting to notice that we both use nonuniform time discretization points but their grid is different than our grid; the accumulation\nspeed of discretization points near the terminal time T is not the same; it\nis faster in our case.\nThe paper is organized as follows. In the introductory Section 2 we recall\nsome of the well-known results concerning SDEs and BSDEs. In Section\n3 we establish some estimates concerning the process Z; we show a first\nuniform bound for Z, then a time dependent bound and finally we specify\nthe classical path regularity theorem. In Section 4 we define a modified time\ndiscretization scheme for BSDEs with a nonuniform time net and we obtain\nan explicit error bound.\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n5\n\n2. Preliminaries.\n2.1. Notation. Throughout this paper, (Wt )t\u22650 will denote a d-dimensional\nBrownian motion, defined on a probability space (\u03a9, F, P). For t \u2265 0, let Ft\ndenote the \u03c3-algebra \u03c3(Ws ; 0 \u2264 s \u2264 t), augmented with the P-null sets of\nF . The Euclidean norm on Rd will be denoted by | * |. The operator norm\ninduced by | * | on the space of linear operator is also denoted by | * |. For\np \u2265 2, m \u2208 N, we denote further:\n(1) S p (Rm ) or S p when no confusion is possible, the space of all adapted\nprocesses (Yt )t\u2208[0,T ] with values in Rm normed by\nh\u0010\n\u0011p i1/p\nkY kS p = E\nsup |Yt |\n;\nt\u2208[0,T ]\n\nS \u221e (Rm ) or S \u221e , the space of bounded measurable processes;\n(2) Mp (Rm ) or Mp , the space of all progressively measurable processes\n(Zt )t\u2208[0,T ] with values in Rm normed by\n\u0013p/2 \u00151/p\n\u0014\u0012Z T\n2\n.\n|Zs | ds\nkZkMp = E\n0\n\nIn the following we keep the same notation C for all finite, nonnegative\nconstants that appear in our computations; they may depend on known\nparameters deriving from assumptions and on T but not on any of the\napproximation and discretization parameters. In the same spirit, we keep\nthe same notation \u03b7 for all finite, positive constants that we can take as\nsmall as we want independently of the approximation and discretization\nparameters.\n2.2. Some results on BMO martingales. In our work, the space of BMO\nmartingales play a key role for the a priori estimates needed in our analysis of\nBSDEs. We refer the reader to [16] for the theory of BMO martingales and we\nRt\njust recall the properties that we will use in the sequel. Let \u03a6t = 0 \u03c6s dWs ,\nt \u2208 [0, T ], be a real square integrable martingale with respect to the Brownian\nfiltration. Then \u03a6 is a BMO martingale if\n\u0014Z T\n\u00151/2\n2\n1/2\n\u03c6s ds|F\u03c4\n< +\u221e,\nk\u03a6kBMO = sup E[h\u03a6iT \u2212 h\u03a6i\u03c4 |F\u03c4 ] = sup E\n\u03c4 \u2208[0,T ]\n\n\u03c4 \u2208[0,T ]\n\n\u03c4\n\nwhere the supremum is taken over all stopping times in [0, T ]; h\u03a6i denotes\nthe quadratic variation of \u03a6. In our case, the very important feature of BMO\nmartingales is the following lemma.\nLemma 2.1.\n\nLet \u03a6 be a BMO martingale. Then we have:\n\n\f6\n\nA. RICHOU\n\n(1) The stochastic exponential\n\u0013\n\u0012Z t\nZ\n1 t\n2\n|\u03c6s | ds ,\n\u03c6s dWs \u2212\nE(\u03a6)t = Et = exp\n2 0\n0\n\n0 \u2264 t \u2264 T,\n\nis a uniformly integrable martingale.\n(2) Thanks to the reverse H\u00f6lder inequality, there exists p > 1 such that\nET \u2208 Lp . The maximal p with this property can be expressed in terms of the\nBMO norm of \u03a6. R\nT\n(3) \u2200n \u2208 N\u2217 , E[( 0 |\u03c6s |2 ds)n ] \u2264 n!k\u03a6k2n\nBMO .\n\n2.3. The backward\u2013forward system. Given functions b, \u03c3, g and f , for\nx \u2208 Rd we will deal with the solution (X, Y, Z) to the following system of (decoupled) backward\u2013forward stochastic differential equations: for t \u2208 [0, T ],\nZ t\nZ t\nXt = x +\nb(s, Xs ) ds +\n(4)\n\u03c3(s) dWs ,\n0\n\n(5)\n\n0\n\nYt = g(XT ) +\n\nZ\n\nT\n\nf (s, Xs , Ys , Zs ) ds \u2212\nt\n\nZ\n\nT\n\nZs dWs .\nt\n\nFor the functions that appear in the above system of equations we give some\ngeneral assumptions.\n(HX0). b : [0, T ] \u00d7 Rd \u2192 Rd , \u03c3 : [0, T ] \u2192 Rd\u00d7d are measurable functions.\nThere exist four positive constants Mb , Kb , M\u03c3 and K\u03c3 such that \u2200t, t\u2032 \u2208\n[0, T ], \u2200x, x\u2032 \u2208 Rd ,\n|b(t, x)| \u2264 Mb (1 + |x|),\n|b(t, x) \u2212 b(t\u2032 , x\u2032 )| \u2264 Kb (|x \u2212 x\u2032 | + |t \u2212 t\u2032 |1/2 ),\n|\u03c3(t)| \u2264 M\u03c3 ,\n|\u03c3(t) \u2212 \u03c3(t\u2032 )| \u2264 K\u03c3 |t \u2212 t\u2032 |.\n(HY0). f : [0, T ] \u00d7 Rd \u00d7 R \u00d7 R1\u00d7d \u2192 R, g : Rd \u2192 R are measurable functions. There exist five positive constants Mf , Kf,x , Kf,y , Kf,z and Mg such\nthat \u2200t \u2208 [0, T ], \u2200x, x\u2032 \u2208 Rd , \u2200y, y \u2032 \u2208 R, \u2200z, z \u2032 \u2208 R1\u00d7d ,\n|f (t, x, y, z)| \u2264 Mf (1 + |y| + |z|2 ),\n|f (t, x, y, z) \u2212 f (t, x\u2032 , y \u2032 , z \u2032 )| \u2264 Kf,x |x \u2212 x\u2032 | + Kf,y |y \u2212 y \u2032 |\n+ (Kf,z + Lf,z (|z| + |z \u2032 |))|z \u2212 z \u2032 |,\n|g(x)| \u2264 Mg .\nWe next recall some results on BSDEs with quadratic growth. For their\noriginal version and their proof we refer to [2, 17] and [14].\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n7\n\nTheorem 2.2. Under (HX0), (HY0), the system (4)\u2013(5) has a unique\nsolution (X, Y, Z) \u2208 S 2 \u00d7 S \u221e \u00d7 M2 . The martingale Z \u2217 W belongs to the\nspace of BMO martingales and kZ \u2217 W kBMO only depends on T , Mg and\nMf . Moreover, there exists r > 1 such that E(Z \u2217 W ) \u2208 Lr .\n3. Some useful estimates of Z.\n3.1. A first bound for Z.\nTheorem 3.1. Suppose that (HX0), (HY0) hold and that g is Lipschitz\nwith Lipschitz constant Kg . Then, there exists a version of Z such that,\n\u2200t \u2208 [0, T ],\n|Zt | \u2264 e(2Kb +Kf,y )T M\u03c3 (Kg + T Kf,x ).\nProof. First, we suppose that b, g and f are differentiable with respect to x, y and z. Then (X, Y, Z) is differentiable with respect to x and\n(\u2207X, \u2207Y, \u2207Z) is the solution of\nZ t\n(6) \u2207Xt = Id +\n\u2207b(s, Xs )\u2207Xs ds,\n0\n\n\u2207Yt = \u2207g(XT )\u2207XT \u2212\n\nZ\n\nT\n\n\u2207Zs dWs\n\nt\n\n(7)\n\n+\n+\n\nZ\nZ\n\nT\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs + \u2207y f (s, Xs , Ys , Zs )\u2207Ys ds\nt\nT\n\n\u2207z f (s, Xs , Ys , Zs )\u2207Zs ds,\nt\n\nwhere \u2207Xt = (\u2202Xti /\u2202xj )1\u2264i,j\u2264d , \u2207Yt = t (\u2202Yt /\u2202xj )1\u2264j\u2264d \u2208 R1\u00d7d , \u2207Zt = (\u2202Zti /\nRT\n\u2202xj )1\u2264i,j\u2264d and t \u2207Zs dWs means\nX Z T\n(\u2207Zs )i dWsi\n1\u2264i\u2264d t\n\nwith (\u2207Z)i denoting the ith line of the d \u00d7 d matrix process \u2207Z. Thanks\nto usual transformations on the BSDE we obtain\nRt\n\ne\n\n0\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\nRT\n\n=e\n\n0\n\n\u2212\n+\n\n\u2207Yt\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\nZ\nZ\n\nT\n\n\u2207g(XT )\u2207XT\n\nRs\n0\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207Zs dW\u0303s\n\nRs\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs ds\n\ne\nt\nT\n\ne\nt\n\n0\n\n\f8\n\nA. RICHOU\n\nwith dW\u0303s = dWs \u2212 \u2207z f (s, Xs , Ys , Zs ) ds. We have\nZ *\n2\n\u2207z f (s, Xs , Ys , Zs ) dWs\n0\n\nBMO\n\n= sup E\n\u03c4 \u2208[0,T ]\n\n\u0012\n\n\u0014Z\n\nT\n\n2\n\n|\u2207z f (s, Xs , Ys , Zs )| ds|F\u03c4\n\u03c4\n\n\u2264 C 1 + sup E\n\u03c4 \u2208[0,T ]\n\n\u0014Z\n\nT\n\n2\n\n|Zs | ds|F\u03c4\n\u03c4\n\n\u0015\n\n\u0015\u0013\n\n= C(1 + kZ \u2217 W k2BMO ).\nSince Z \u2217 W belongs to the space of BMO martingales,\nZ *\n\u2207z f (s, Xs , Ys , Zs ) dWs\n< +\u221e.\n0\n\nBMO\n\nR*\nLemma 2.1 gives us that E( 0 \u2207z f (s, Xs , Ys , Zs ) dWs )t is a uniformly integrable martingale so we are able to apply Girsanov's theorem: there exists\na probability Q under which (W\u0303 )t\u2208[0,T ] is a Brownian motion. Then,\nRt\n\ne\n\n0\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\n\u0014\n\nRT\n\n= EQ e\n\n+\n\n\u2207Yt\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\n0\n\nZ\n\nT\n\nRs\n\ne\n\n0\n\n\u2207g(XT )\u2207XT\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs ds|Ft\n\nt\n\n\u0015\n\nand\n(8)\n\n|\u2207Yt | \u2264 e(Kb +Kf,y )T (Kg + T Kf,x ),\n\nbecause |\u2207Xt | \u2264 eKb T . Moreover, thanks to the Malliavin calculus, it is classical to show that a version of (Zt )t\u2208[0,T ] is given by (\u2207Yt (\u2207Xt )\u22121 \u03c3(t))t\u2208[0,T ] .\nSo we obtain\n|Zt | \u2264 eKb T M\u03c3 |\u2207Yt | \u2264 e(2Kb +Kf,y )T M\u03c3 (Kg + T Kf,x )\n\na.s.,\n\nbecause |\u2207Xt\u22121 | \u2264 eKb T .\nWhen b, g and f are not differentiable, we can also prove the result by a\nstandard approximation and stability results for BSDEs with linear growth.\n\u0003\nRemark 3.2. Thanks to Theorem 3.1, the generator f becomes a Lipschitz function with respect to z, so we are able to use standard results\nabout time discretization of BSDEs. In this case, we obtain that the error\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n9\n\nof approximation is lower than Cn\u22121 with n the number of discretization\ntimes (see, e.g., [1, 11]). Let us notice that, in all studies about discretization\nof BSDEs, we do not care about the constant in the error bound; we only\nconsider the asymptotic speed of convergence. But, with a practical point of\nview, the constant could play an important role, particularly for small n. In\nour case, the generator f may be viewed as Lipschitz in z with a Lipschitz\nconstant Ce(2Kb +Kf,y )T . So, if we apply the standard result, the generic con2(2Kb +Kf,y )T\n. This\nstant in the rate of convergence will be in the order of CeCe\nis, of course, not desirable because it blows up when Kb , Kf,y or T increase.\nWe think that it could be interesting to see if we are able to observe such a\nphenomena with numerical simulation.\n3.2. A time dependent estimate of Z. We will introduce two alternative\nassumptions.\n(HX1). b is differentiable with respect to x and \u03c3 is differentiable with\nrespect to t. There exists \u03bb \u2208 R+ such that \u2200\u03b7 \u2208 Rd\n|t \u03b7\u03c3(s)[t \u03c3(s)t \u2207b(s, x) \u2212 t \u03c3 \u2032 (s)]\u03b7| \u2264 \u03bb|t \u03b7\u03c3(s)|2 .\n\n(9)\n\n(HX1\u2032 ). \u03c3 is invertible and \u2200t \u2208 [0, T ], |\u03c3(t)\u22121 | \u2264 M\u03c3\u22121 .\nExample. Assumption (HX1) is verified when, \u2200s \u2208 [0, T ], \u2207b(s, *) commutes with \u03c3(s) and \u2203A : [0, T ] \u2192 Rd\u00d7d bounded such that \u03c3 \u2032 (t) = \u03c3(t)A(t).\nTheorem 3.3. Suppose that (HX0), (HY0) hold and that (HX1) or\n(HX1\u2032 ) holds. Moreover, suppose that g is lower (or upper) semi-continuous.\nThen there exists a version of Z and there exist two constants C, C \u2032 \u2208 R+\nthat depend only in T , Mg , Mf , Kf,x , Kf,y , Kf,z and Lf,z such that, \u2200t \u2208\n[0, T [,\n|Zt | \u2264 C + C \u2032 (T \u2212 t)\u22121/2 .\nProof. In a first time, we will suppose that (HX1) holds and that f ,\ng are differentiable with respect to x, y and z. Then (Y, Z) is differentiable\nwith respect to x and (\u2207Y, \u2207Z) is the solution of the BSDE\nZ T\n\u2207Zs dWs\n\u2207Yt = \u2207g(XT )\u2207XT \u2212\nt\n\n+\n\nZ\n\nT\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs + \u2207y f (s, Xs , Ys , Zs )\u2207Ys ds\n\nt\n\n+\n\nZ\n\nt\n\nT\n\n\u2207z f (s, Xs , Ys , Zs )\u2207Zs ds.\n\n\f10\n\nA. RICHOU\n\nThanks to usual transformations we obtain\nRt\n\ne\n\n0\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\n+\n\nt Rs\n\nZ\n\ne\n\n0\n\n0\n\nRT\n\n=e\n\n0\n\n+\n\u2212\n\n\u2207Yt\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\nZ\nZ\n\nT\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs ds\n\n\u2207g(XT )\u2207XT\n\nRs\n0\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs ds\n\nRs\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207Zs dW\u0303s\n\ne\n0\nT\n\ne\n\n0\n\nt\n\nwith dW\u0303s = dWs \u2212 \u2207z f (s, Xs , Ys , Zs ) ds. We can rewrite it as\nZ T R\ns\ne 0 \u2207y f (u,Xu ,Yu ,Zu ) du \u2207Zs dW\u0303s\nFt = FT \u2212\n(10)\nt\n\nwith\n\nRt\n\nFt := e\n\n0\n\n+\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\nZ\n\nt Rs\n\ne\n\n0\n\n\u2207Yt\n\n\u2207y f (u,Xu ,Yu ,Zu ) du\n\n\u2207x f (s, Xs , Ys , Zs )\u2207Xs ds.\n\n0\n\nZ \u2217 W belongs to the space of BMO martingales so we are able to apply\nGirsanov's theorem: there exists a probability Q under which (W\u0303 )t\u2208[0,T ] is\na Brownian motion. Thanks to the Malliavin calculus, it is possible to show\nthat (\u2207Yt (\u2207Xt )\u22121 \u03c3(t))t\u2208[0,T ] is a version of Z. Now we define\nZ t R\ns\ne 0 \u2207y f (u,Xu ,Yu ,Zu ) du \u2207x f (s, Xs , Ys , Zs )\u2207Xs ds (\u2207Xt )\u22121 \u03c3(t),\n\u03b1t :=\n0\n\nRt\n\nZ\u0303t := Ft (\u2207Xt )\u22121 \u03c3(t) = e\n\n0\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\nZt + \u03b1t\n\na.s.,\n\nF\u0303t := e\u03bbt Ft (\u2207Xt )\u22121 .\nSince d\u2207Xt = \u2207b(t, Xt )\u2207Xt dt, then d(\u2207Xt )\u22121 = \u2212(\u2207Xt )\u22121 \u2207b(t, Xt ) dt and\nthanks to It\u00f4's formula,\ndZ\u0303t = dFt (\u2207Xt )\u22121 \u03c3(t) \u2212 Ft (\u2207Xt )\u22121 \u2207b(t, Xt )\u03c3(t) dt + Ft (\u2207Xt )\u22121 \u03c3 \u2032 (t) dt\nand\nd(e\u03bbt Z\u0303t ) = F\u0303t (\u03bbId \u2212 \u2207b(t, Xt ))\u03c3(t) dt + F\u0303t \u03c3 \u2032 (t) dt + e\u03bbt dFt (\u2207Xt )\u22121 \u03c3(t).\nFinally,\nd|e\u03bbt Z\u0303t |2 = 2[\u03bb|F\u0303t \u03c3(t)|2 \u2212 F\u0303t \u03c3(t)[t \u03c3(t)t \u2207b(t, Xt ) \u2212 t \u03c3 \u2032 (t)]t F\u0303t ] dt\n+ dhM it + dMt\u2217\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n11\n\nRt\nwith Mt := 0 e\u03bbs dFs (\u2207Xs )\u22121 \u03c3(s) and Mt\u2217 a Q-martingale. Thanks to the\nassumption (HX1) we are able to conclude that |e\u03bbt Z\u0303t |2 is a Q-submartingale.\nHence,\n\u0014Z T\n\u0015\n2\u03bbs\n2\nQ\ne |Z\u0303s | ds|Ft\nE\nt\n\n\u2265 e2\u03bbt |Z\u0303t |2 (T \u2212 t)\nRt\n\n\u2265 e2\u03bbt |e\n\n0\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\n\nZt + \u03b1t |2 (T \u2212 t)\n\na.s.,\n\nwhich implies\n|Zt |2 (T \u2212 t) = e\u22122\u03bbt e\u22122\nRt\n\n\u00d7 |e\n\n0\n\nRt\n0\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds 2\u03bbt\n\ne\n\n\u2207y f (s,Xs ,Ys ,Zs ) ds\nRt\n\nZt + \u03b1t \u2212 \u03b1t |2 (T \u2212 t)\n\n\u2264 C(e2\u03bbt |e 0 \u2207y f (s,Xs ,Ys ,Zs ) ds Zt + \u03b1t |2 + 1)(T \u2212 t)\n\u0012 \u0014Z T\n\u0015\n\u0013\n\u2264 C EQ\ne2\u03bbs |Z\u0303s |2 ds|Ft + (T \u2212 t)\na.s.\nt\n\nwith C a constant that only depends on T , Kb , M\u03c3 , Kf,x , Kf,y and \u03bb.\nMoreover, we have, a.s.,\n\u0014Z T\n\u0015\n\u0014Z T\n\u0015\nQ\n2\u03bbs\n2\nQ\n2\n2\nE\ne |Z\u0303s | ds|Ft \u2264 CE\n|Zs | + |\u03b1s | ds|Ft\nt\n\nt\n\n\u2264\n\nC(kZk2BMO(Q)\n\n+ (T \u2212 t)).\n\nBut kZkBMO(Q) does not depend on Kg because (Y, Z) is a solution of the\nfollowing quadratic BSDE:\nZ T\n(f (s, Xs , Ys , Zs ) \u2212 Zs \u2207z f (s, Xs , Ys , Zs )) ds\nYt = g(XT ) +\nt\n\n(11)\n\n\u2212\n\nZ\n\nT\n\nZs dW\u0303s .\n\nt\n\nFinally, |Zt | \u2264 C(1 + (T \u2212 t)\u22121/2 ) a.s.\nWhen \u03c3 is invertible, the inequality (9) is verified with \u03bb := M\u03c3\u22121 (M\u03c3 Kb +\nK\u03c3 ). Since this \u03bb does not depend on \u2207b and \u03c3 \u2032 , we can prove the result\nwhen b(t, *) and \u03c3 are not differentiable by a standard approximation and\nstability results for BSDEs with linear growth. So, we are allowed to replace\nassumption (HX1) by (HX1\u2032 ).\nWhen f is not differentiable and g is only Lipschitz, we can prove the\nresult by a standard approximation and stability results for linear BSDEs.\nBut we notice that our estimation on Z does not depend on Kg . This allows\n\n\f12\n\nA. RICHOU\n\nus to weaken the hypothesis on g further; when g is only lower or upper\nsemi-continuous the result stays true. The proof is the same as the proof of\nProposition 4.3 in [8]. \u0003\nRemark 3.4. The previous proof gives us a more precise estimation for\na version of Z when f is differentiable with respect to z : \u2200t \u2208 [0, T ],\n\u0014Z T\n\u00151/2\n\u2032 Q\n2\n|Zt | \u2264 C + C E\n|Zs | ds|Ft\n(T \u2212 t)\u22121/2 .\nt\n\nRemark 3.5. When assumption (HX1) or (HX1\u2032 ) is not verified, the\nprocess Z may blow up before T . Zhang gives an example of such a phenomenon in dimension 1; we refer the reader to Example 1 in [20].\n3.3. Zhang's path regularity theorem. Let 0 = t0 < t1 < * * * < tn = T be\nany given partition of [0, T ] and denote \u03b4n the mesh size of this partition.\nWe define a set of random variables\n\u0014Z ti+1\n\u0015\n1\nE\n\u2200i \u2208 {0, . . . , n \u2212 1}.\nZs ds|Fti\nZ\u0304ti =\nti+1 \u2212 ti\nti\nThen we are able to give a more detailed version at Theorem 3.4.3 in [21].\nTheorem 3.6. Suppose that (HX0), (HY0) hold and g is a Lipschitz\nfunction with Lipschitz constant Kg . Then we have\n\u0015\nn\u22121\nX \u0014Z ti+1\nE\n|Zt \u2212 Z\u0304ti |2 dt \u2264 C(1 + Kg2 )\u03b4n ,\ni=0\n\nti\n\nwhere C is a positive constant independent of \u03b4n and Kg .\n\nProof. We will follow the proof of Theorem 5.6 in [14]; we just need\nto specify how the estimate depends on Kg . First, it is not difficult to show\nthat Z\u0304ti is the best Fti -measurable approximation of Z in M2 ([ti , ti+1 ]),\nthat is,\n\u0015\n\u0014Z ti+1\n\u0015\n\u0014Z ti+1\n2\n2\n|Zt \u2212 Zi | dt .\nE\n|Zt \u2212 Z\u0304ti | dt =\ninf\nE\nZi \u2208L2 (\u03a9,Fti )\n\nti\n\nti\n\nIn particular,\nE\n\n\u0014Z\n\nti+1\n\nti\n\n\u0015\n\u0014Z\n|Zt \u2212 Z\u0304ti |2 dt \u2264 E\n\nti+1\n\nti\n\n\u0015\n|Zt \u2212 Zti |2 dt .\n\nIn the same spirit as previous proofs, we suppose in a first time that b, g\nand f are differentiable with respect to x, y and z. So,\nZt \u2212 Zti = \u2207Yt (\u2207Xt )\u22121 \u03c3(t) \u2212 \u2207Yti (\u2207Xti )\u22121 \u03c3(ti ) = I1 + I2 + I3\n\na.s.,\n\n\f13\n\nNUMERICAL SIMULATION OF QUADRATIC BSDES\n\nwith I1 = \u2207Yt (\u2207Xt )\u22121 (\u03c3(t) \u2212 \u03c3(ti )), I2 = \u2207Yt ((\u2207Xt )\u22121 \u2212 (\u2207Xti )\u22121 )\u03c3(ti )\nand I3 = \u2207(Yt \u2212 Yti )(\u2207Xti )\u22121 \u03c3(ti ). First, thanks to the estimation (8) we\nhave\n|I1 |2 \u2264 |\u2207Yt |2 e2Kb T K\u03c32 |ti+1 \u2212 ti |2 \u2264 C(1 + Kg2 )\u03b4n2 .\nWe obtain the same estimation for |I2 | because\nZ t\n\u22121\n\u22121\n|(\u2207Xt ) \u2212 (\u2207Xti ) | \u2264\n(\u2207Xs )\u22121 \u2207b(s, Xs ) ds \u2264 Kb eKb T |t \u2212 ti |.\nti\n\neKb T |\u2207Y\n\nLast, |I3 | \u2264 M\u03c3\nn\u22121 \u0014Z\nX\nE\ni=0\n\n\u2212 \u2207Yti |. So,\n\u0015\nn\u22121\nti+1\nX h\n2\nE ess\n|I3 | dt \u2264 C\u03b4n\nt\n\nti\n\ni=0\n\nsup\nt\u2208[ti ,ti+1 ]\n\ni\n|\u2207Yt \u2212 \u2207Yti |2 .\n\nBy using the BSDE (7), (HY0), the estimate on \u2207Xs and the estimate (8),\nwe have\n\u00132\n\u0012Z t\n2\n(C(1 + Kg ) + |\u2207z f (s, Xs , Ys , Zs )||\u2207Zs |) ds\n|\u2207Yt \u2212 \u2207Yti | \u2264 C\nti\n\n+C\n\n\u0012Z\n\nt\n\n\u2207Zs dWs\n\nti\n\n\u00132\n\n.\n\nThe inequalities of H\u00f6lder and Burkholder\u2013Davis\u2013Gundy give us\nn\u22121\ni\nX h\nE ess sup |\u2207Yt \u2212 \u2207Yti |2\ni=0\n\nt\u2208[ti ,ti+1 ]\n\n\u2264 C(1 + Kg2 ) + C\n\nn\u22121\nX\n\nE\n\n+ CE\n\nti+1\n\n2\n\n|\u2207Zs | ds\n\nti\n\n\u2264 C(1 + Kg2 )\n\u0014\u0012Z\n+ CE\n\nti+1\n\n|\u2207z f (s, Xs , Ys , Zs )||\u2207Zs | ds\n\nti\n\ni=0\n\n\u0012Z\n\n\u0012Z\n\n\u0013\n\nT\n\n|\u2207z f (s, Xs , Ys , Zs )||\u2207Zs | ds\n\n0\n\n\u2264 C(1 + Kg2 )\n\u0013\u0012Z\n\u0014\u0012Z T\n2\n(1 + |Zs | ) ds\n+ CE\n0\n\n\u2264 C(1 + Kg2 )\n\u0012\n\u0014\u0012Z\n+C 1+E\n\nT\n0\n\n\u00132\n\nT\n\n\u00132\n\n+\n\n\u0013\n\n2\n\nZ\n\n|\u2207Zs | ds +\n0\n\n\u0013p \u00151/p \u0013 \u0014\u0012Z\n|Zs | ds\nE\n\nT\n\n2\n\nT\n\n2\n\n|\u2207Zs | ds\n0\n\nZ\n\nT\n\n|\u2207Zs | ds\n\n0\n\n2\n\n|\u2207Zs | ds\n0\n\n2\n\n\u0015\n\n\u0013q \u00151/q\n\n\u0015\n\n\f14\n\nA. RICHOU\n\nfor all p > 1 and q > 1 such that 1/p + 1/q = 1. But, (\u2207Y, \u2207Z) is the solution\nof BSDE (7) so, from Corollary 9 in [2], there exists q that only depends on\nkZ \u2217 W kBMO such that\n\u0013q \u00151/q\n\u0014\u0012Z T\n\u2264 C(1 + Kg2 ).\n|\u2207Zs |2 ds\nE\n0\n\nMoreover, we can apply Lemma 2.1 to obtain the estimate\n\u0013p \u00151/p\n\u0014\u0012Z T\n2\n\u2264 CkZk2BMO \u2264 C.\n|Zs | ds\nE\n0\n\nFinally,\n\nn\u22121\nX\ni=0\n\nand\nn\u22121\nX\ni=0\n\nE\n\n\u0014Z\n\nti+1\nti\n\nE\n\n\u0014Z\n\nti+1\nti\n\n2\n\n\u0015\n\n2\n\n\u0015\n\n|I3 | dt \u2264 C(1 + Kg2 )\u03b4n\n\n|Zt \u2212 Z\u0304ti | dt \u2264\n\nn\u22121\nX\ni=0\n\nE\n\n\u0014Z\n\nti+1\n\n2\n\n2\n\n2\n\n(|I1 | + |I2 | + |I3 | ) dt\n\nti\n\n\u2264 C(1 + Kg2 )\u03b4n .\n\n\u0015\n\u0003\n\n4. Convergence of a modified time discretization scheme for the BSDE.\n4.1. An approximation of the quadratic BSDE. In a first time we will\napproximate our quadratic BSDE (5) by another one. We set \u03b5 \u2208 ]0, T [ and\nN \u2208 N. Let (YtN,\u03b5 , ZtN,\u03b5 ) be the solution of the BSDE\nZ T\nZ T\nN,\u03b5\n\u03b5\nN,\u03b5\nN,\u03b5\n(12) Yt = gN (XT ) +\nZsN,\u03b5 dWs\nf (s, Xs , Ys , Zs ) ds \u2212\nt\n\nt\n\nwith\n\nf \u03b5 (s, x, y, z) := 1s\u2264T \u2212\u03b5 f (s, x, y, z) + 1s>T \u2212\u03b5 f (s, x, y, 0)\nand gN a Lipschitz approximation of g with Lipschitz constant N . f \u03b5 verifies\nassumption (HY0) with the same constants as f . Since gN is a Lipschitz\nfunction, Z N,\u03b5 has a bounded version and the BSDE (12) is a BSDE with a\nlinear growth. Moreover, we can apply Theorem 3.3 to obtain the following\nproposition.\nProposition 4.1. Let us assume that (HX0), (HY0) and (HX1) or\n(HX1\u2032 ) hold. There exists a version of Z N,\u03b5 and there exist three constants\nMz,1 , Mz,2 , Mz,3 \u2208 R+ that do not depend on N and \u03b5 such that, \u2200s \u2208 [0, T ],\n\u0013\n\u0012\nMz,2\nN,\u03b5\n\u2227 (Mz,3 (N + 1)).\n|Zs | \u2264 Mz,1 +\n(T \u2212 s)1/2\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n15\n\nThanks to BMO tools we have a stability result for quadratic BSDEs (see\n[2] and [14]).\nProposition 4.2. Let us assume that (HX0) and (HY0) hold. There\nexists a constant C that does not depend on N and \u03b5 such that\n\u0015\n\u0014Z T\ni\nh\nN,\u03b5\nN,\u03b5\n2\n2\n|Zt \u2212 Zt | dt \u2264 C(e1 (N ) + e2 (N, \u03b5))\nE sup |Yt \u2212 Yt | + E\n0\n\nt\u2208[0,T ]\n\nwith\ne1 (N ) := E[|gN (XT ) \u2212 g(XT )|2q ]1/q ,\n\u00132q \u00151/q\n\u0014\u0012Z T\nN,\u03b5\nN,\u03b5\nN,\u03b5\n|f (t, Xt , Yt , Zt ) \u2212 f (t, Xt , Yt , 0)| dt\ne2 (N, \u03b5) := E\nT \u2212\u03b5\n\nand q defined in Theorem 2.2.\nRemark 4.3. The authors of [14] obtain this result with q 2 instead of q.\nNevertheless, we are able to obtain the good result by applying the estimates\nof [2].\nThen, in a second time, we will approximate our modified backward\u2013\nforward system by a discrete-time one. We will slightly modify the classical\ndiscretization by using a nonequidistant net with 2n + 1 discretization times.\nWe define the n + 1 first discretization times on [0, T \u2212 \u03b5] by\n\u0012\n\u0012 \u0013k/n \u0013\n\u03b5\ntk = T 1 \u2212\nT\nand we use an equidistant net on [T \u2212 \u03b5, T ] for the last n discretization times\n\u0012\n\u0013\n2n \u2212 k\ntk = T \u2212\n\u03b5,\nn \u2264 k \u2264 2n.\nn\nWe denote the time step by (hk := tk+1 \u2212tk )0\u2264k\u22642n\u22121 . We consider (Xtnk )0\u2264k\u22642n\nthe classical Euler scheme for X given by\n(13)\n\nX0n = x,\nXtnk+1 = Xtnk + hk b(tk , Xtnk ) + \u03c3(tk )(Wtk+1 \u2212 Wtk )\n\nfor 0 \u2264 k \u2264 2n \u2212 1. We denote \u03c1s : R1\u00d7d \u2192 R1\u00d7d the projection on the ball\n\u0013\n\u0012\nMz,2\nB 0, Mz,1 +\n(T \u2212 s)1/2\n\n\f16\n\nA. RICHOU\n\nwith Mz,1 and Mz,2 given by Proposition 4.1. Finally, we denote (Y N,\u03b5,n , Z N,\u03b5,n )\nour time approximation of (Y N,\u03b5 , Z N,\u03b5 ). This couple is obtained by a slight\nmodification of the classical dynamic programming equation\n\n(14)\n(15)\n\nYtN,\u03b5,n\n= gN (Xtn2n ),\n2n\n\u0013\n\u0012\n1\nN,\u03b5,n\nN,\u03b5,n\nEt [Y\n(Wtk+1 \u2212 Wtk )] ,\nZtk\n= \u03c1tk+1\nhk k tk+1\n\nYtN,\u03b5,n\n= Etk [YtN,\u03b5,n\n] + hk Etk [f \u03b5 (tk , Xtnk , YtN,\u03b5,n\n, ZtN,\u03b5,n\n)],\nk\nk+1\nk+1\nk\n\nwhere 0 \u2264 k \u2264 2n \u2212 1 and Etk stand for the conditional expectation given\nFtk . Let us notice that the classical dynamic programming equation does not\nuse a projection in (14); it is the only difference with our time approximation\n(see, e.g., [11] for the classical case). This projection comes directly from the\nestimate of Z in Proposition 4.1. The aim of our work is to study the error\nof discretization\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5,n\n2\n2\ne(N, \u03b5, n) := sup E[|Ytk\n\u2212 Ytk | ] +\n|Ztk\n\u2212 Zt | dt .\nE\n0\u2264k\u22642n\n\nk=0\n\ntk\n\nIt is easy to see that\n\ne(N, \u03b5, n) \u2264 C(e1 (N ) + e2 (N, \u03b5) + e3 (N, \u03b5, n))\nwith e1 (N ) and e2 (N, \u03b5) defined in Proposition 4.2 and\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5,n\nN,\u03b5 2\nN,\u03b5 2\ne3 (N, \u03b5, n) := sup E[|Ytk\n\u2212 Ytk | ] +\n|Ztk\n\u2212 Zt | dt .\nE\n0\u2264k\u22642n\n\nk=0\n\ntk\n\n4.2. Study of the time approximation error e3 (N, \u03b5, n). We need an extra\nassumption.\n(HY1). There exists a positive constant Kf,t such that \u2200t, t\u2032 \u2208 [0, T ],\n\u2200x \u2208 Rd , \u2200y \u2208 R, \u2200z \u2208 R1\u00d7d ,\n|f (t, x, y, z) \u2212 f (t\u2032 , x, y, z)| \u2264 Kf,t |t \u2212 t\u2032 |1/2 .\nMoreover, we set \u03b5 = T n\u2212a and N = nb , with a, b \u2208 R+,\u2217 two parameters.\nBefore giving our error estimates, we recall two technical lemmas that we\nwill prove in Appendices A and B.\nLemma 4.4. For all constant M > 0 there exists a constant C that depends only on T , M and a, such that\n2n\u22121\nY\ni=0\n\n(1 + M hi ) \u2264 C\n\n\u2200n \u2208 N\u2217 .\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n17\n\nLemma 4.5. For all constants M1 > 0 and M2 > 0 there exists a constant\nC that depends only on T , M1 , M2 and a, such that\n\u0013\nn\u22121\nY\u0012\nhi\n\u2264 CnaM2 .\n1 + M1 hi + M2\nT \u2212 ti+1\ni=0\n\nFirst, we give a convergence result for the Euler scheme.\nProposition 4.6. Assume (HX0) holds. Then there exists a constant\nC that does not depend on n, such that\nsup E[|Xtk \u2212 Xtnk |2 ] \u2264 C\n\n0\u2264k\u22642n\n\nln n\n.\nn\n\nProof. We just have to copy the classical proof to obtain, thanks to\nLemma 4.4,\nsup E[|Xtk \u2212 Xtnk |2 ] \u2264 C\n\n0\u2264k\u22642n\n\nsup\n0\u2264i\u22642n\u22121\n\nhi = Ch0 .\n\nBut\nh0 = T (1 \u2212 n\u2212a/n ) \u2264 C\n\nln n\n,\nn\n\nbecause (1 \u2212 n\u2212a/n ) \u223c aT lnnn when n \u2192 +\u221e, so the proof is complete. \u0003\nNow, let us treat the BSDE approximation. In a first time we will study\nthe time approximation error on [T \u2212 \u03b5, T ].\nProposition 4.7. Assume that (HX0), (HY0) and (HY1) hold. Then\nthere exists a constant C that does not depend on n and such that\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nC ln n\nN,\u03b5,n\nN,\u03b5 2\nN,\u03b5 2\nsup E[|Ytk\n\u2212 Ytk | ] +\n|Ztk\n\u2212 Zt | dt \u2264 1\u22122b .\nE\nn\nn\u2264k\u22642n\ntk\nk=n\n\nProof. The BSDE (12) has a linear growth with respect to z on [T \u2212\n\u03b5, T ] so we are allowed to apply classical results which give us that\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5,n\nN,\u03b5 2\nN,\u03b5 2\nsup E[|Ytk\n\u2212 Ytk | ] +\n|Ztk\n\u2212 Zt | dt\nE\nn\u2264k\u22642n\n\n\u2264C\n\nk=n\n\n\u0012\n\nE[|gN (XT ) \u2212 gN (XTn )|2 ] +\n\ntk\n\n\u03b5\nn\n\n\u0013\n\nby using the fact that gN is N -Lipschitz and by applying Proposition 4.6.\n\u0003\n\n\f18\n\nA. RICHOU\n\nRemark 4.8.\n(1) When a \u2265 1 \u2212 2b, then \u03b5 = T n\u2212a = o(n2b\u22121 ln n). We do not need to\nhave a discretization grid on [T \u2212 \u03b5, T ]; n + 2 points of discretization are\nsufficient on [0, T ].\n(2) When a < 1 \u2212 2b, then it is possible to take only \u2308nc \u2309 discretization\npoints on [T \u2212 \u03b5, T ] with a + c = 1 \u2212 2b. In this case the error bound becomes\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5,n\nN,\u03b5 2\nN,\u03b5 2\nsup E[|Ytk\n\u2212 Ytk | ] +\n|Ztk\n\u2212 Zt | dt\nE\nn\u2264k\u22642n\n\n\u2264C\n\nk=n\n\n\u0012\n\n1\nln n\n+ a+c\n1\u22122b\nn\nn\n\ntk\n\n\u0013\n\nand the Proposition 4.7 stays true.\nNow, let us see what happens on [0, T \u2212 \u03b5].\nTheorem 4.9. Assume that (HX0), (HY0), (HY1) and (HX1) or (HX1\u2032 )\nhold. Then for all \u03b7 > 0, there exists a constant C that does not depend on\nN , \u03b5 and n, such that\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nC\nN,\u03b5 2\nN,\u03b5,n\nN,\u03b5 2\n|Ztk\n\u2212 Zt | dt \u2264 1\u22122b\u2212Ka\nE\nsup E[|Ytk\n\u2212 Ytk | ] +\nn\n0\u2264k\u22642n\ntk\nk=0\n\nwith K\n\n2 .\n= 4(1 + \u03b7)L2f,z Mz,2\n\nProof. First, we will study the error on Y . From (12) and (15) we get\nYtN,\u03b5\n\u2212 YtN,\u03b5,n\nk\nk\n= Etk [YtN,\u03b5\n\u2212 YtN,\u03b5,n\n]\nk+1\nk+1\nZ tk+1\n+ Etk\n, ZtN,\u03b5,n\n)) ds.\n(f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 ) \u2212 f (tk , Xtnk , YtN,\u03b5,n\nk+1\nk\ntk\n\nWe introduce a parameter \u03b3k > 0 that will be chosen later. Thanks to Proposition 4.1 and assumption (HY0), f is Lipschitz on [tk , tk+1 ] with a Lipschitz\n2\nconstant Kk := K 1 + (T \u2212tK )1/2 where K 2 = 2Lf,z Mz,2 . A combination of\nk+1\n\nYoung's inequality (a + b)2 \u2264 (1 + \u03b3k hk )a2 + (1 +\nf gives\n|2\nE|YtN,\u03b5\n\u2212 YtN,\u03b5,n\nk\nk\n\u2264 (1 + \u03b3k hk )E|Etk [YtN,\u03b5\n\u2212 YtN,\u03b5,n\n]|2\nk+1\nk+1\n\n1\n2\n\u03b3k hk )b\n\nand properties of\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n19\n\n\u0013 Z tk+1\n1\n|2 ds\n|ZsN,\u03b5 \u2212 ZtN,\u03b5,n\nE\n+ (1 + \u03b7)\nhk +\nk\n\u03b3k\ntk\n\u0012\n\u0013\n\u0013\u0012\nZ tk+1\n1\n+ C hk +\nE|Xs \u2212 Xtnk |2 ds\nh2k +\n\u03b3k\ntk\n\u0012\n\u0013\n\u0013\u0012Z tk+1\n1\nN,\u03b5,n 2\nN,\u03b5\n+ C hk +\nE|Ys \u2212 Ytk+1 | ds .\n\u03b3k\ntk\n1/3\n\n(16)\n\nKk2\n\n\u0012\n\nWe define\nZ\u0303tN,\u03b5,n\n:=\nk\n\n1\nEt [Y N,\u03b5,n (Wtk+1 \u2212 Wtk )].\nhk k tk+1\n\nSo, ZtN,\u03b5,n\n= \u03c1tk+1 (Z\u0303tN,\u03b5,n\n). Moreover, Proposition 4.1 implies that ZsN,\u03b5 =\nk\nk\n\u03c1tk+1 (ZsN,\u03b5 ) and, since \u03c1tk+1 is 1-Lipschitz, we have\n(17) |ZsN,\u03b5 \u2212 ZtN,\u03b5,n\n|2 = |\u03c1tk+1 (ZsN,\u03b5 ) \u2212 \u03c1tk+1 (Z\u0303tN,\u03b5,n\n)|2 \u2264 |ZsN,\u03b5 \u2212 Z\u0303tN,\u03b5,n\n|2 .\nk\nk\nk\nAs in Theorem 3.6, we define Z\u0304tN,\u03b5\nby\nk\nZ tk+1\nhk Z\u0304tN,\u03b5\n:=\nE\nZsN,\u03b5 ds\ntk\nk\ntk\n\n\u0012\u0012\nZ\nN,\u03b5\n= Etk\nYtk+1 +\n\ntk+1\n\ntk\n\nf (s, Xs , YsN,\u03b5 , ZsN,\u03b5 ) ds\n\n\u0013\n\nt\n\n\u0013\n(Wtk+1 \u2212 Wtk ) .\n\nClearly,\nE\n(18)\n\nZ\n\ntk+1\n\ntk\n\n|ZsN,\u03b5 \u2212 Z\u0303tN,\u03b5,n\n|2 ds\nk\n\n=E\n\nZ\n\ntk+1\n\ntk\n\n|ZsN,\u03b5 \u2212 Z\u0304tN,\u03b5\n|2 ds + hk E|Z\u0304tN,\u03b5\n\u2212 Z\u0303tN,\u03b5,n\n|2 .\nk\nk\nk\n\nThe Cauchy\u2013Schwarz inequality yields\n|Etk ((YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)t (Wtk+1 \u2212 Wtk ))|2\nk+1\nk+1\n\u2264 hk {Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 }\nk+1\nk+1\nk+1\nk+1\nand consequently\nhk E|Z\u0304tN,\u03b5\n\u2212 Z\u0303tN,\u03b5,n\n|2\nk\nk\n(19)\n\n\u2212 YtN,\u03b5,n\n)|2 ]\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2264 (1 + \u03b7)1/3 E[Etk (|YtN,\u03b5\nk+1\nk+1\nk+1\nk+1\nZ tk+1\n+ Chk E\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds.\ntk\n\n\f20\n\nA. RICHOU\n\nPlugging (18) and (19) into (16), we get\nE|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2\nk\nk\n\u2264 (1 + \u03b3k hk )E|Etk [YtN,\u03b5\n\u2212 YtN,\u03b5,n\n]|2\nk+1\nk+1\n\u0013 Z tk+1\n\u0012\n1\n2\n|ZsN,\u03b5 \u2212 Z\u0304tN,\u03b5\n|2 ds\nE\n+ (1 + \u03b7)Kk hk +\nk\n\u03b3k\ntk\n\u0013\u0012\n\u0012\nZ tk+1\n1\n2\nE|Xs \u2212 Xtnk |2 ds\nhk +\n+ C hk +\n\u03b3k\ntk\n\u0013\nZ tk+1\nN,\u03b5,n 2\nN,\u03b5\n+\nE|Ys \u2212 Ytk+1 | ds\ntk\n\n2/3\n\n+ (1 + \u03b7)\n\n+ CKk2\nNow write\n(20)\n(21)\n\n\u0012\n\nKk2\n\n\u0012\n\n\u0013\n1\nhk +\nE[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 )\nk+1\nk+1\n\u03b3k\n\n\u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk+1\nk+1\n\n\u0013\nZ tk+1\n1\nh\nE\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds.\nhk +\nk\n\u03b3k\ntk\n\nE|YsN,\u03b5 \u2212 YtN,\u03b5,n\n|2 \u2264 2E|YsN,\u03b5 \u2212 YtN,\u03b5\n|2 + 2E|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ,\nk+1\nk+1\nk+1\nk+1\nE|Xs \u2212 Xtnk |2 \u2264 2E|Xs \u2212 Xtk |2 + 2E|Xtk \u2212 Xtnk |2\n\nand we obtain\nE|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2\nk\nk\n\u2264 (1 + \u03b3k hk )E|Etk [YtN,\u03b5\n\u2212 YtN,\u03b5,n\n]|2\nk+1\nk+1\n\u0012\n\u0013 Z tk+1\n1\n2\n+ (1 + \u03b7)Kk hk +\nE\n|ZsN,\u03b5 \u2212 Z\u0304tN,\u03b5\n|2 ds\nk\n\u03b3k\ntk\n\u0012\n\u0013\u0012\n\u0013\nZ tk+1\n1\n2\nn 2\n2\n+ C hk +\nE|Xs \u2212 Xtk | ds + hk E|Xtk \u2212 Xtk |\nhk +\n\u03b3k\ntk\n\u0013\n\u0013\u0012Z tk+1\n\u0012\n1\nN,\u03b5 2\nN,\u03b5\nN,\u03b5,n 2\nN,\u03b5\nE|Ys \u2212 Ytk+1 | ds + hk E|Ytk+1 \u2212 Ytk+1 |\n+ C hk +\n\u03b3k\ntk\n\u0012\n\u0013\n1\n2/3 2\n+ (1 + \u03b7) Kk hk +\nE[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 )\nk+1\nk+1\n\u03b3k\n\u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk+1\nk+1\n\n+ CKk2\n\n\u0012\n\n\u0013\nZ tk+1\n1\nhk E\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds.\nhk +\n\u03b3k\ntk\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n21\n\nTaking \u03b3k = (1 + \u03b7)2/3 Kk2 and for hk small enough, it gives\nE|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2\nk\nk\n\u2264 (1 + Chk + (1 + \u03b7)2/3 Kk2 hk )E|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 + Ch2k\nk+1\nk+1\n+ Chk max E|Xtk \u2212 Xtnk |2\n0\u2264k\u2264n\n\n+ CE\nZ\n\n+C\n\ntk+1\n\nZ\n\ntk\ntk+1\n\ntk\n\n|ZsN,\u03b5 \u2212 Z\u0304tN,\u03b5\n|2 ds + C\nk\n\nE|YsN,\u03b5\n\nZ\n\ntk+1\n\ntk\n\n\u2212 YtN,\u03b5\n|2 ds + Chk E\nk+1\n\nZ\n\nE|Xs \u2212 Xtk |2 ds\ntk+1\n\ntk\n\nf (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )2 ds,\n\nbecause Kk2 hk \u2264 C(h0 + hk (T \u2212 tk+1 )\u22121 ) \u2264 C lnnn . The Gronwall's lemma\ngives us\nE|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2\nk\nk\n#\n\"\nn\u22121 j\u22121\nY\nX\n2/3 2\n(1 + Chi + (1 + \u03b7) Ki hi )\n\u2264C\nj=0 i=0\n\n\u0014\n\n\u00d7 h2j + hj max E|Xtl \u2212 Xtnl |2\n0\u2264l\u2264n\n\n+E\n\ntj+1\n\nZ\n\ntj\n\n|2 ) ds\n(|ZsN,\u03b5 \u2212 Z\u0304tN,\u03b5\n|2 + |Xs \u2212 Xtj |2 + |YsN,\u03b5 \u2212 YtN,\u03b5\nj\nj+1\n+ hj E\n\nZ\n\ntj+1\n\ntj\n\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds\n\n\u0015\n\n#\n\"n\u22121\nY\n2/3 2\n(1 + Chi + (1 + \u03b7) Ki hi ) E|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 .\n+\nn\nn\ni=0\n\nThen, we apply Lemma 4.5.\nE|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2\nk\nk\n\u2264 Cn(1+\u03b7)(K\n\"\n\n2 )2 a\n\n\u00d7 h0 + max E|Xtl \u2212 Xtnl |2\n0\u2264l\u2264n\n\n+\n\n\u0012Z\nn\nX\nE\nj=0\n\ntj+1\ntj\n\n+ h0 E\n\n|ZsN,\u03b5 \u2212 Z\u0304tN,\u03b5\n|2 + |Xs \u2212 Xtj |2 + |YsN,\u03b5 \u2212 YtN,\u03b5\n|2 ds\nj\nj+1\nZ\n\n0\n\ntn\n\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds + E|YtN,\u03b5\nn\n\n\u0013\n\n\u2212 YtN,\u03b5,n\n|2\nn\n\n#\n\n.\n\n\f22\n\nA. RICHOU\n\nA classical estimation gives us E[|Xs \u2212 Xtj |2 ] \u2264 |s \u2212 tj |. Moreover, since\nZ N,\u03b5 is bounded,\nZ tn\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds\nE\n0\n\n\u2264 CT (1 + |Y N,\u03b5 |\u221e ) + CE\n\n\u0014Z\n\ntn\n\n|ZsN,\u03b5 |4 ds\n\n0\n\n\u2264 CT (1 + |Y\n\nN,\u03b5\n\n2b\n\n|\u221e ) + Cn E\n\n\u0014Z\n\nT\n\n0\n\n\u0015\n\n|ZsN,\u03b5 |2 ds\n\n\u0015\n\n.\n\nRT\nBut we have an a priori estimate for E[ 0 |ZsN,\u03b5 |2 ds] that does not depend\non N and \u03b5. So\nZ tn\n(22)\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds \u2264 Cn2b .\nE\n0\n\nWith the same type of argument we also have\n\n|2 \u2264 Chj n2b .\nE|YsN,\u03b5 \u2212 YtN,\u03b5\nj+1\n\n(23)\n\nIf we add Zhang's path regularity Theorem 3.6, Propositions 4.6 and 4.7,\nwe finally obtain\nln n\nn2b ln n\n= C 1\u22122b\u2212(1+\u03b7)(K 2 )2 a .\nn\nn\nNow, let us deal with the error on Z. First of all, (17) gives us\n\u0015 n\u22121\n\u0015\nn\u22121\nX \u0014Z tk+1 N,\u03b5,n\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5 2\nN,\u03b5 2\nE\n|Ztk\n\u2212 Zt | dt \u2264\nE\n|Z\u0303tk\n\u2212 Zt | dt .\n(24) E|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 \u2264 Cn(1+\u03b7)(K\nk\nk\n\n2 )2 a\n\ntk\n\nk=0\n\nk=0\n\ntk\n\nFor 0 \u2264 k \u2264 n \u2212 1, we can use (18) and (19) to obtain\n\u0015\n\u0014Z tk+1\nN,\u03b5,n\nN,\u03b5 2\n|Z\u0303tk\n\u2212 Zt | dt\nE\ntk\n\n\u2264E\n\n\u0014Z\n\ntk+1\n\ntk\n\n|Z\u0304tN,\u03b5\nk\n\n\u2212 ZtN,\u03b5 |2 dt\n\n\u0015\n\n+ (1 + \u03b7)2/3 E[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk+1\nk+1\nk+1\nk+1\n\u0015\n\u0014Z tk+1\nN,\u03b5\nN,\u03b5 2\n|f (s, Xs , Ys , Zs )| ds .\n+ Chk E\ntk\n\nInequality (22) and estimates for Z give us\n\u0015\nn\u22121\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5 2\n|Ztk\n\u2212 Zt | dt\nE\nk=0\n\ntk\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n\u2264\n\nn\u22121\nX\n\nE\n\nk=0\n\n\u0014Z\n\ntk+1\ntk\n\n+ (1 + \u03b7)2/3\n\n|Z\u0304tN,\u03b5\nk\nn\u22121\nX\n\n\u2212 ZtN,\u03b5 |2 dt\n\n23\n\n\u0015\n\nE[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk+1\nk+1\nk+1\nk+1\n\nk=0\n\n(25)\n\n+ Ch0 E\n\u2264\n\nn\u22121\nX\nk=0\n\nE\n\n\u0014Z\n\n\u0014Z\n\nT\n0\n\ntk+1\ntk\n\n+ (1 + \u03b7)2/3\n\n|f (s, Xs , YsN,\u03b5 , ZsN,\u03b5 )|2 ds\n\n|Z\u0304tN,\u03b5\nk\nn\u22121\nX\n\n\u2212 ZtN,\u03b5 |2 dt\n\n\u0015\n\n\u0015\n\nE[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk\nk\nk+1\nk+1\n\nk=0\n\n+ CE[|YtN,\u03b5\nn\n\n\u2212 YtN,\u03b5,n\n|2 ] + Ch0 n2b\nn\n\nwith an index change in the penultimate line. Then, by using (16) we get\n(1 + \u03b7)2/3 E[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk\nk\nk+1\nk+1\n\u2264 C\u03b3k hk E|Etk [YtN,\u03b5\n\u2212 YtN,\u03b5,n\n]|2\nk+1\nk+1\n(26)\n\u0013 Z tk+1\n\u0012\n1\n2\nE\n|ZsN,\u03b5 \u2212 ZtN,\u03b5,n\n|2 ds\n+ (1 + \u03b7)Kk hk +\nk\n\u03b3k\ntk\n\u0013 \u0010\n\u0012\n\u0011\n1\n2\n|\n]\n.\nhk hk + sup E[|Xs \u2212 Xtnk |2 + |YsN,\u03b5 \u2212 YtN,\u03b5,n\n+ C hk +\nk+1\n\u03b3k\ns\u2208[tk ,tk+1 ]\nThanks to (20), (21), (23) and a classical estimation on E[|Xs \u2212 Xtk |2 ] we\nhave\nsup\ns\u2208[tk ,tk+1 ]\n\n|2 ]\nE[|Xs \u2212 Xtnk |2 + |YsN,\u03b5 \u2212 YtN,\u03b5,n\nk+1\n\n\u2264 C(hk n2b + E[|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ]).\nk+1\nk+1\nLet us set \u03b3k = 3(1 + \u03b7)Kk2 . We recall that hk Kk2 \u2264\nSo, for n big enough, (26) becomes\n\nC ln n\nn\n\n\u2192 0 when n \u2192 0.\n\n(1 + \u03b7)2/3 E[Etk (|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ) \u2212 |Etk (YtN,\u03b5\n\u2212 YtN,\u03b5,n\n)|2 ]\nk\nk\nk+1\nk+1\nZ tk+1\n1\nC ln n\nN,\u03b5\nN,\u03b5,n 2\n|ZsN,\u03b5 \u2212 ZtN,\u03b5,n\n|2 ds\nE[|Ytk+1 \u2212 Ytk+1 | ] + E\n\u2264\nk\nn\n2 tk\n+ Ch0 hk n2b .\n\n\f24\n\nA. RICHOU\n\nIf we inject this last estimate in (25) and we use Theorem 3.6, we obtain\n\u0015\nn\u22121 \u0014Z tk+1\n1X\nN,\u03b5,n\nN,\u03b5 2\n|Ztk\n\u2212 Zt | dt\nE\n2\ntk\nk=0\n\n\u2264 Ch0 n2b + C ln n\n\nsup\n0\u2264k\u2264n\u22121\n\nE[|YtN,\u03b5\n\u2212 YtN,\u03b5,n\n|2 ].\nk+1\nk+1\n\nBy using (24) and Proposition 4.7, we finally have\n\u0015\n2n\u22121\nX \u0014Z tk+1 N,\u03b5,n\nN,\u03b5,n\nN,\u03b5 2\nN,\u03b5 2\nsup E[|Ytk\n\u2212 Ytk | ] +\n|Ztk\n\u2212 Zt | dt\nE\n0\u2264k\u22642n\n\n\u2264C\n\ntk\n\nk=0\n\n(ln n)2\n\nn1\u22122b\u2212Ka\n\n2 . Since this estimate is true for every \u03b7 > 0, we\nwith K = 4(1 + \u03b7)L2f,z Mz,2\nhave proved the result. \u0003\n\n4.3. Study of the global error e(N, \u03b5, n). Let us study errors e1 (N ) and\ne2 (N, \u03b5).\nProposition 4.10. Let us assume that (HX0) and (HY0) hold. There\nexists a constant C > 0 such that\nC\ne2 (N, \u03b5) \u2264 2a\u22124b .\nn\nProof. We just have to notice that\n|f (t, Xt , YtN,\u03b5 , ZtN,\u03b5 ) \u2212 f (t, Xt , YtN,\u03b5 , 0)| \u2264 C|ZtN,\u03b5 |2\nand |ZtN,\u03b5 | is bounded by Cnb . \u0003\nFor gN we use the classical Lipschitz approximation\ngN (x) = inf{g(u) + N |x \u2212 u||u \u2208 Rd }.\nProposition 4.11. We assume that (HX0) holds and g is \u03b1-H\u00f6lder.\nThen, there exists a constant C such that\ne1 (N ) \u2264\n\nC\nn2b\u03b1/(1\u2212\u03b1)\n\n.\n\nProof. gN is a N -Lipschitz function and gN \u2192 g when N \u2192 +\u221e uniformly on Rd . More precisely, we have\n|g \u2212 gN |\u221e \u2264\n\nC\nN \u03b1/(1\u2212\u03b1)\n\n.\n\n\u0003\n\n\f25\n\nNUMERICAL SIMULATION OF QUADRATIC BSDES\n\nRemark 4.12. For some explicit examples, it is possible to have a better convergence speed. For example, let us take g(x) = (|x|\u03b1 1x\u22650 ) \u2227 C and\nassume that \u03c3 is invertible. Then, we can use the fact that this function is\nnot Lipschitz only in 0 and obtain\ne1 (N ) \u2264\n\nC\nn2\u03b1b/(1\u2212\u03b1)\n\nP(XT \u2208 [0, N \u22121/(1\u2212\u03b1) ])1/q \u2264\n\nC\nn(b/(1\u2212\u03b1))(2\u03b1+1/q)\n\n.\n\nRemark 4.13. It is also possible to obtain convergence speed when g\nis not \u03b1-H\u00f6lder.\nFor example, we assume that \u03c3 is invertible and we set\nQ\ng(x) = di=1 1xi >0 (x). Then\n#1/q\n\" d\nX\nC\nC\nP((XT )i \u2208 [0, 1/N ])\ne1 (N ) \u2264 C\n\u2264 1/q = b/q .\nN\nn\ni=1\nNow we are able to gather all these errors.\nTheorem 4.14. We assume that (HX0), (HY0), (HY1) and (HX1) or\n(HX1\u2032 ) hold. We assume also that g is \u03b1-H\u00f6lder. Then for all \u03b7 > 0, there\nexists a constant C > 0 that does not depend on n such that\ne(n) := e(N, \u03b5, n) \u2264\n\nC\nn2\u03b1/((2\u2212\u03b1)(2+K)\u22122+2\u03b1)\n\n2 .\nwith K = 4(1 + \u03b7)L2f,z Mz,2\n\nProof. Thanks to Theorem 4.9, Propositions 4.10 and 4.11 we have\ne(n) \u2264\n\nC\nn1\u22122b\u2212Ka\n\nThen we only need to set a :=\nresult. \u0003\n\n+\n\n1+2b\n2+K\n\nC\nn2a\u22124b\n\n+\n\nand b :=\n\nC\nn2\u03b1b/(1\u2212\u03b1)\n\n.\n\n1\u2212\u03b1\n(2\u2212\u03b1)(2+K)\u22122+2\u03b1\n\nto obtain the\n\nCorollary 4.15. We assume that assumptions of Theorem 4.14 hold.\nMoreover, we assume that f has a sub-quadratic growth with respect to z;\nthere exists 0 < \u03b2 < 1 such that, for all t \u2208 [0, T ], x \u2208 Rd , y \u2208 R, z, z \u2032 \u2208 R1\u00d7d ,\n|f (t, x, y, z) \u2212 f (t, x, y, z \u2032 )| \u2264 (Kf,z + Lf,z (|z|\u03b2 + |z \u2032 |\u03b2 ))|z \u2212 z \u2032 |.\nThen we are allowed to take K as small as we want. So, for all \u03b7 > 0, there\nexists a constant C > 0 that does not depend on n such that\ne(n) \u2264\n\nC\nn\u03b1\u2212\u03b7\n\n.\n\nRemark 4.16. We are able to specify Remark 4.8 in our case, when\n1\u2212\u03b1\na = 1+2b\n2+K and b = (2\u2212\u03b1)(2+K)\u22122+2\u03b1 .\n\n\f26\n\nA. RICHOU\n\n(1) When K \u2264 2\u22123\u03b1\n2\u2212\u03b1 , that is to say, when \u03b1 < 2/3 and K is sufficiently\nsmall, then we do not need to have a discretization grid on [T \u2212 \u03b5, T ].\nc\n(2) When K > 2\u22123\u03b1\n2\u2212\u03b1 , then it is possible to take only \u2308n \u2309 discretization\npoints on [T \u2212 \u03b5, T ] with\nc=1+\n\n3\u03b1 \u2212 4\n.\n(2 \u2212 \u03b1)(2 + K) \u2212 2 + 2\u03b1\n\nTheorem 4.14 is not interesting in practice because the speed of convergence depends strongly on K. But we see that the global error becomes\nC\ne(n) \u2264 n\u03b1\u2212\u03b7\nwhen we are allowed to choose K as small as we want. Under\nextra assumption we can show that we are allowed to take the constant Mz,2\nas small as we want.\n(HX2). b is bounded on [0, T ] \u00d7 Rd by a constant Mb .\nTheorem 4.17. We assume that (HX0), (HY0), (HY1), (HX2) and\n(HX1) or (HX1\u2032 ) hold. We assume also that g is \u03b1-H\u00f6lder. Then for all\n\u03b7 > 0, there exists a constant C > 0 that does not depend on n such that\ne(n) \u2264\n\nC\nn\u03b1\u2212\u03b7\n\n.\n\nRemark 4.18. With the assumptions of the previous theorem, it is\nalso possible to have an estimate of the global error for examples given in\nRemarks 4.12 and 4.13. When g(x) = (|x|\u03b1 1x\u22650 ) \u2227 C, we have\ne(n) \u2264\nand when g(x) =\n\nQd\n\ni=1 1xi >0 (x),\n\nC\nn\u03b1+(1\u2212\u03b1)/(1+2q)\u2212\u03b7\nwe have\n\ne(n) \u2264\n\nC\nn1/(1+2q)\u2212\u03b7\n\n.\n\nProof of Theorem 4.17. First, we suppose that f is differentiable\nwith respect to z. Thanks to Remark 3.4 we see that it is sufficient to show\nthat\n\u0014Z T\n\u0015\nN,\u03b5 2\nQN,\u03b5\n|Zs | ds|Ft\nE\nt\n\nis small uniformly in \u03c9, N and \u03b5 when t is close to T . We will obtain an\nestimation for this quantity by applying the same computation as [2] for the\nBMO norm estimate of Z, page 831. Thus, we have\n\u0014Z T\n\u0015\nN,\u03b5\nN,\u03b5 2\nQN,\u03b5\n|Zs | ds|Ft \u2264 EQ [|\u03c6(YTN,\u03b5 ) \u2212 \u03c6(YtN,\u03b5 )||Ft ] + C(T \u2212 t)\nE\nt\n\n\f27\n\nNUMERICAL SIMULATION OF QUADRATIC BSDES\n\nwith \u03c6(x) = (e2c(x+m) \u2212 2c(x + m) \u2212 1)/(2c2 ), m = |Y |\u221e and c that depends\non constants in assumption (HY0) but does not depend on \u2207z f . Let us\nnotice that m, c and so \u03c6 do not depend on N and \u03b5. Since Y is bounded,\n\u03c6 is a Lipschitz function, so\n\u0014Z T\n\u0015\nN,\u03b5\nN,\u03b5 2\nQN,\u03b5\n|Zs | ds|Ft \u2264 CEQ [|YTN,\u03b5 \u2212 YtN,\u03b5 ||Ft ] + C(T \u2212 t).\nE\nt\n\nWe denote by (Y N,\u03b5,t,x , Z N,\u03b5,t,x ) the solution of BSDE (12) when Xtt,x = x.\nAs usual, we set Xst,x = x and ZsN,\u03b5,t,x = 0 for s \u2264 t and we define uN,\u03b5 (t, x) :=\nYtN,\u03b5,t,x . Then we give a proposition that we will prove in Appendix C.\n\nProposition 4.19. We assume that (HX0), (HY0), (HY1), (HX2) and\n(HX1) or (HX1\u2032 ) hold. We assume also that g is uniformly continuous on\nRd . Then uN,\u03b5 is uniformly continuous on [0, T ] \u00d7 Rd and there exists \u03c9 a\nconcave modulus of continuity for all functions in {uN,\u03b5 |N \u2208 N, \u03b5 > 0}, that\nis, \u03c9 does not depend on N and \u03b5.\nThen\nEQ\n\nN,\u03b5\n\n[|YTN,\u03b5 \u2212 YtN,\u03b5 ||Ft ]\n\n= EQ\n\nN,\u03b5\n\n[|uN,\u03b5 (T, XT ) \u2212 uN,\u03b5 (t, Xt )||Ft ]\n\n\u2264 EQ\n\nN,\u03b5\n\n[1| R T \u03c3(s) dW\u0303s |\u2264\u03bd |uN,\u03b5 (T, XT ) \u2212 uN,\u03b5 (t, Xt )|\nt\n\n+ 2|Y N,\u03b5 |\u221e 1| R T \u03c3(s) dW\u0303s |>\u03bd |Ft ]\nt\n\n\u2264E\n\nQN,\u03b5\n\n[\u03c9(|T \u2212 t| + 1| R T \u03c3(s) dW\u0303s |\u2264\u03bd |XT \u2212 Xt |)\nt\n\n+ 2|Y N,\u03b5 |\u221e 1| R T \u03c3(s) dW\u0303s |>\u03bd |Ft ]\nt\n\nwith\n\ndW\u0303s = dWs \u2212 \u2207z f \u03b5 (s, Xs , YsN,\u03b5 , ZsN,\u03b5 ) ds.\n\nBut,\n\n1| R T \u03c3(s) dW\u0303s |\u2264\u03bd |XT \u2212 Xt |\nt\n\n= 1| R T \u03c3(s) dW\u0303s |\u2264\u03bd\nt\n\nZ\n+\n\nT\n\nb(s, Xs ) ds\nt\n\nZ\n\nT\n\n\u2207z f\n\nt\n\n\u2264 Mb (T \u2212 t) + \u03bd + C\n\nZ\n\nT\nt\n\n\u03b5\n\n(s, Xs , YsN,\u03b5 , ZsN,\u03b5 ) ds +\n\n(1 + |ZsN,\u03b5 |) ds\n1/2\n\n\u2264 C(T \u2212 t) + \u03bd + C(T \u2212 t)\n\n\u0012Z\n\nt\n\nT\n\n|ZsN,\u03b5 |2 ds\n\n\u00131/2\n\n.\n\nZ\n\nT\n\n\u03c3(s) dW\u0303s\nt\n\n\f28\n\nA. RICHOU\n\nSince \u03c9 is concave, we have by Jensen's inequality\nEQ\n\nN,\u03b5\n\n[\u03c9(|T \u2212 t| + 1| R T \u03c3(s) dW\u0303s |\u2264\u03bd |XT \u2212 Xt |)|Ft ]\nt\n\n\u0012\n\n1/2 QN,\u03b5\n\n\u2264 \u03c9 C|T \u2212 t| + \u03bd + C(T \u2212 t)\n\nE\n\nT\n\n\u0014\u0012Z\n\nt\n\n\u0012\n\n1/2 QN,\u03b5\n\n\u2264 \u03c9 C|T \u2212 t| + \u03bd + C(T \u2212 t)\n\nE\n\n\u0014Z\n\nT\n\n|ZsN,\u03b5 |2 ds\n\n\u00131/2\n\n|ZsN,\u03b5 |2 ds|Ft\n\nt\n\nFt\n\n\u0015\u0013\n\n\u00151/2 \u0013\n\n\u2264 \u03c9(C|T \u2212 t| + \u03bd + C(T \u2212 t)1/2 kZ N,\u03b5 kBMO(Q) ).\nBut, kZ N,\u03b5 kBMO(Q) only depends on constants in assumption (HY0), so it\nRT\nis bounded uniformly in N and \u03b5. Moreover, | t \u03c3(s) dW\u0303s | is independent\nof Ft so we have by the Markov inequality\n\u0012Z T\n\u0013\nN,\u03b5\nQN,\u03b5\n[1| R T \u03c3(s) dW\u0303s |>\u03bd |Ft ] = Q\n\u03c3(s) dW\u0303s > \u03bd\nE\nt\n\nt\n\n\u2264\n\nC(T \u2212 t)1/2\n.\n\u03bd\n\nFinally, we have\nEQ\n\nN,\u03b5\n\n[|YTN,\u03b5 \u2212 YtN,\u03b5 ||Ft ] \u2264 \u03c9(C|T \u2212 t|1/2 + \u03bd) + C\n\n(T \u2212 t)1/2\n\u03bd\n\n\u2264 \u03c9(C|T \u2212 t|1/2 + |T \u2212 t|1/4 ) + C|T \u2212 t|1/4\nN,\u03b5\n\nby setting \u03bd = |T \u2212 t|1/4 and EQ [|YTN,\u03b5 \u2212 YtN,\u03b5 ||Ft ] \u2192 0 uniformly in \u03c9, N\nand \u03b5 when t \u2192 T . When f is not differentiable with respect to z but is only\nlocally Lipschitz, then we can prove the result by a standard approximation.\n\u0003\n\nAPPENDIX A: PROOF OF LEMMA 4.4\nWe have\n2n\u22121\nY\n\n(1 + M hi ) =\n\nn\u22121\nY\n\n!\n\n(1 + M hi )\n\ni=0\n\ni=0\n\n2n\u22121\nY\n\n(1 + M hi ) .\n\ni=n\n\nFirst,\n2n\u22121\nY\ni=n\n\n\u0012\n\nT\n(1 + M hi ) \u2264 1 + M\nn\n\n\u0013n\n\n!\n\n\u2264 C.\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n29\n\nMoreover, for 0 \u2264 i \u2264 n \u2212 1,\nhi = ti+1 \u2212 ti = T n\u2212ai/n (1 \u2212 e\u2212(a ln n)/n ) \u2264 T n\u2212ai/n a\n\nln n\nn\n\nthanks to the convexity of the exponential function. So\n\u0013\nn\u22121\nn\u22121\nY\u0012\nY\n\u2212ai/n ln n\n(1 + M hi ) \u2264\n1 + M T an\nn\ni=0\n\ni=0\n\nn\u22121\nX\n\n\u0012\n\u0013!\n\u2212ai/n ln n\nln 1 + M T an\n= exp\nn\ni=0\n!\nn\u22121\nX\nln\nn\n\u2264 exp\nM T a(n\u2212a/n )i\nn\ni=0\n\u0012\n\u0013\u0013\n\u0012\nln n\n1 \u2212 (1/na )\n\u2264 exp M T a\nn 1 \u2212 (1/n(a/n) )\n\u0013\n\u0012\nln n na/n\n.\n\u2264 exp M T a\nn na/n \u2212 1\nBut,\nln n\nln n na/n\n1\n1\n\u223c\n\u223c ,\na/n\nn n\nn (a ln n)/n a\n\u22121\nwhen n \u2192 +\u221e. Thus, we have shown the result.\nAPPENDIX B: PROOF OF LEMMA 4.5\nThanks to Lemma 4.4, we have\nQn\u22121\n\u0013\nn\u22121\nY\u0012\nM1\ni=0 (1 + M1 hi + M2 hi /(T \u2212 ti+1 ))\n1+\n=\nhi\nQn\u22121\n1 + M2 hi /(T \u2212 ti+1 )\ni=0 (1 + M2 hi /(T \u2212 ti+1 ))\ni=0\n\u2264\n\nn\u22121\nY\n\n(1 + M1 hi ) \u2264 C.\n\ni=0\n\nSo we just have to show that\nn\u22121\nY\u0012\n1 + M2\ni=0\n\nhi\nT \u2212 ti+1\n\n\u0013\n\n\u2264 CnaM2 .\n\nBut\n\n1 + M2\n\nhi\n= 1 + M2 (na/n \u2212 1).\nT \u2212 ti+1\n\n\f30\n\nA. RICHOU\n\nSo\nn\u22121\nY\u0012\ni=0\n\nhi\n1 + M2\nT \u2212 ti+1\n\n\u0013\n\n= (1 + M2 (na/n \u2212 1))n\n\u0012\n\u0012\n\u0012 2 \u0013\u0013\u0013\nln n\nln n\n= exp n ln 1 + aM2\n+O\nn\nn2\n\u0012\n\u0012 2 \u0013\u0013\nln n\n= exp aM2 ln n + O\n\u223c naM2 ,\nn\n\nwhen n \u2192 +\u221e. Thus, we have shown the result.\n\nAPPENDIX C: PROOF OF PROPOSITION 4.19\nWe will prove this proposition as the authors of [9] do for their Proposition\n4.2. In this proof we omit the superscript N, \u03b5 for u, Y and Z to be more\nreadable. Let x0 , x\u20320 \u2208 Rd and t0 , t\u20320 \u2208 [0, T ]. By an argument of symmetry we\nare allowed to suppose that t0 \u2264 t\u20320 . We have\n|u(t0 , x0 ) \u2212 u(t\u20320 , x\u20320 )| \u2264 |u(t0 , x0 ) \u2212 u(t0 , x\u20320 )| + |u(t0 , x\u20320 ) \u2212 u(t\u20320 , x\u20320 )|.\nLet us begin with the first term. We will use a classical argument of linearization:\nt ,x\u20320\n\nYtt0 ,x0 \u2212 Yt 0\n\nt ,x\u2032\n\n= gN (XTt0 ,x0 ) \u2212 gN (XT0 0 )\nZ T\nt ,x\u2032\nt ,x\u2032\n\u03b1s (Xst0 ,x0 \u2212 Xs0 0 ) + \u03b2s (Yst0 ,x0 \u2212 Ys 0 0 ) ds\n+\nt\n\n\u2212\n\nZ\n\nt\n\nwith\n\nT\n\nt ,x\u20320\n\n(Zst0 ,x0 \u2212 Zs0\n\nt ,x\u20320\n\n\u03b1s :=\n\nf \u03b5 (s, Xst0 ,x0 , Ys 0\n\nt ,x\u20320\n\n, Zs0\n\nt ,x\u20320\n\n) \u2212 f \u03b5 (s, Xs0\n\nt ,x\u20320\n\n, Ys 0\n\nt ,x\u20320\n\n, Zs0\n\n)\n\nt ,x\u20320\n\n6= 0 and \u03b1s = 0 elsewhere,\nt ,x\u20320\n\nf \u03b5 (s, Xst0 ,x0 , Yst0 ,x0 , Zs0\n\nt ,x\u20320\n\n) \u2212 f \u03b5 (s, Xst0 ,x0 , Ys 0\n\nt ,x\u20320\n\n, Zs0\n\n)\n\nt ,x\u2032\nYst0 ,x0 \u2212 Ys 0 0\nt ,x\u20320\n\nif Xst0 ,x0 \u2212 Xs0\n\n,\n\n6= 0 and \u03b2s = 0 elsewhere,\nt ,x\u20320\n\n\u03b3s :=\n\n,\n\nt ,x\u2032\nXst0 ,x0 \u2212 Xs0 0\n\nif Xst0 ,x0 \u2212 Xs0\n\u03b2s :=\n\n) dW\u0303s\n\nf \u03b5 (s, Xst0 ,x0 , Yst0 ,x0 , Zst0 ,x0 ) \u2212 f \u03b5 (s, Xst0 ,x0 , Yst0 ,x0 , Zs0\nt0 ,x\u20320\n\n|Zst0 ,x0 \u2212 Zs\nt ,x\u20320\n\n\u00d7 t (Zst0 ,x0 \u2212 Zs0\n\n),\n\n|2\n\n)\n\n\f31\n\nNUMERICAL SIMULATION OF QUADRATIC BSDES\nt ,x\u2032\n\nif Zst0 ,x0 \u2212 Zs0 0 6= 0 and \u03b3s = 0 elsewhere and dW\u0303s := dWs \u2212 \u03b3s ds. By a\nBMO argument, there exists a probability Q under which W\u0303 is a Brownian\nmotion. Then we apply a classical transformation to obtain\nRt\n\nEQ [e\n\nt0\n\n\u03b2s ds\n\n\u0014\n\nt ,x\u20320\n\n(Ytt0 ,x0 \u2212 Yt 0\nRT\n\n= EQ e\n\n+\n\n\u03b2s ds\n\nt0\n\nZ\n\nt ,x\u20320\n\n(gN (XTt0 ,x0 ) \u2212 gN (XT0\nRs\n\nT\n\n)]\n\n\u03b1s e\n\nt0\n\n\u03b2u du\n\nt0\n\n(Xst0 ,x0\n\n))\n\nt ,x\u2032\n\u2212 Xs0 0 ) ds\n\n\u0015\n\nand\n|u(t0 , x0 ) \u2212 u(t0 , x\u20320 )|\n\u0012\nZ\nt ,x\u2032\n\u2264 C EQ [\u03c9(|XTt0 ,x0 \u2212 XT0 0 |)] +\n\nT\n\nt0\n\nt ,x\u20320\n\nEQ [|Xst0 ,x0 \u2212 Xs0\n\n|] ds\n\n\u0013\n\nwith \u03c9 a modulus of continuity of g that is also a modulus of continuity for\ngN . We are allowed to suppose that \u03c9 is concave; indeed, there exist two\npositive constants a and b such that \u03c9(x) \u2264 ax + b, then the concave hull of\nx 7\u2192 \u03c9(x) \u2228 (1x\u22651 (ax + b)) is also a modulus of continuity of g. So Jensen's\ninequality gives us\n|u(t0 , x0 ) \u2212 u(t0 , x\u20320 )|\n\u0012\nZ\nt ,x\u2032\n\u2264 C \u03c9(EQ [|XTt0 ,x0 \u2212 XT0 0 |]) +\n\nT\n\nE\n\nQ\n\nt0\n\n[|Xst0 ,x0\n\nt ,x\u2032\n\u2212 Xs0 0 |] ds\n\n\u0013\n\n.\n\nBy using the fact that b is bounded we can prove the following proposition\nexactly as authors of [9] do for their Proposition 4.7.\nProposition C.1. \u2203C > 0 that does not depend on N and \u03b5 such that\n\u2200t, t\u2032 \u2208 [0, T ], \u2200x, x\u2032 \u2208 Rd , \u2200s \u2208 [0, T ],\n\u2032\n\n\u2032\n\nEQ [|Xst,x \u2212 Xst ,x |] \u2264 C(|x \u2212 x\u2032 | + |t \u2212 t\u2032 |1/2 ).\nThen,\n|u(t0 , x0 ) \u2212 u(t0 , x\u20320 )| \u2264 C(\u03c9(|x0 \u2212 x\u20320 |) + |x0 \u2212 x\u20320 |).\nNow we will study the second term,\nt ,x\u20320\n\n|u(t0 , x\u20320 ) \u2212 u(t\u20320 , x\u20320 )| = |Yt00\n\nt ,x\u20320\n\n\u2264 |Yt00\n\nt\u2032 ,x\u20320\n\n\u2212 Yt\u20320\n0\n\nt\u2032 ,x\u20320\n\n\u2212 Yt00\n\n|\nt\u2032 ,x\u20320\n\n| + |Yt00\n\nt\u2032 ,x\u20320\n\n\u2212 Yt\u20320\n0\n\n|.\n\n\f32\n\nA. RICHOU\n\nFirst,\nt\u2032 ,x\u2032\n|Yt00 0\n\nZ\n\nt\u2032 ,x\u2032\n\u2212 Yt\u20320 0 | \u2264\n0\n\nt\u20320\n\nt\u2032 ,x\u20320\n\nf (s, x\u20320 , Ys 0\n\nt0\n\n, 0) ds \u2264 C|t0 \u2212 t\u20320 |.\n\nMoreover, as for the first term we have\nRt\n\nEQ [e\n\nt0\n\n\u03b2s ds\n\n\u0014\n\nt ,x\u20320\n\n(Yt 0\nRT\n\n= EQ e\n\n+\n\nt0\n\nZ\n\n\u03b2s ds\n\nT\n\nt\u2032 ,x\u20320\n\n\u2212 Yt 0\n\n)]\n\nt ,x\u20320\n\n(gN (XT0\nRs\n\n\u03b1s e\n\nt0\n\n\u03b2u du\n\nt\u2032 ,x\u20320\n\n) \u2212 gN (XT0\n\nt ,x\u2032\n(Xs0 0\n\nt0\n\n))\n\nt\u2032 ,x\u2032\n\u2212 Xs0 0 ) ds\n\n\u0015\n\nand\nt ,x\u20320\n\n|Yt00\n\nt\u2032 ,x\u20320\n\n\u2212 Yt\u20320\n0\n\n| \u2264 C(\u03c9(|t0 \u2212 t\u20320 |1/2 ) + |t0 \u2212 t\u20320 |1/2 ).\n\nFinally,\n|u(t0 , x\u20320 ) \u2212 u(t\u20320 , x\u20320 )| \u2264 C(\u03c9(|t0 \u2212 t\u20320 |1/2 ) + |t0 \u2212 t\u20320 |1/2 )\nand\n|u(t0 , x0 ) \u2212 u(t\u20320 , x\u20320 )|\n\u2264 C(\u03c9(|x0 \u2212 x\u20320 |) + \u03c9(|t0 \u2212 t\u20320 |1/2 ) + |x0 \u2212 x\u20320 | + |t0 \u2212 t\u20320 |1/2 ).\nSo u is uniformly continuous on [0, T ] \u00d7 Rd and this function has a modulus\nof continuity that does not depend on N and \u03b5. Moreover, we are allowed\nto suppose that this modulus of continuity is concave.\nAcknowledgments. The author would like to thank his Ph.D. advisers,\nPhilippe Briand and Ying Hu, an anonymous referee and the Associate Editor for their careful reading and helpful comments.\nREFERENCES\n[1] Bouchard, B. and Touzi, N. (2004). Discrete-time approximation and MonteCarlo simulation of backward stochastic differential equations. Stochastic Process. Appl. 111 175\u2013206. MR2056536\n[2] Briand, P. and Confortola, F. (2008). BSDEs with stochastic Lipschitz condition\nand quadratic PDEs in Hilbert spaces. Stochastic Process. Appl. 118 818\u2013838.\nMR2411522\n[3] Briand, P. and Hu, Y. (2006). BSDE with quadratic growth and unbounded terminal value. Probab. Theory Related Fields 136 604\u2013618. MR2257138\n[4] Briand, P. and Hu, Y. (2008). Quadratic BSDEs with convex generators and\nunbounded terminal conditions. Probab. Theory Related Fields 141 543\u2013567.\nMR2391164\n\n\fNUMERICAL SIMULATION OF QUADRATIC BSDES\n\n33\n\n[5] Cheridito, P. and Stadje, M. (2010). BS\u2206Es and BSDEs with nonLipschitz drivers: Comparison, convergence and robustness. Available at\narXiv:1002.0175v1.\n[6] Chevance, D. (1997). Numerical methods for backward stochastic differential equations. In Numerical Methods in Finance. Publ. Newton Inst. 232\u2013244. Cambridge\nUniv. Press, Cambridge. MR1470517\n[7] Delarue, F. and Menozzi, S. (2006). A forward\u2013backward stochastic algorithm for\nquasi-linear PDEs. Ann. Appl. Probab. 16 140\u2013184. MR2209339\n[8] Delbaen, F., Hu, Y. and Bao, X. (2011). Backward SDEs with superquadratic\ngrowth. Probab. Theory Related Fields 150 145\u2013192.\n[9] Delbaen, F., Hu, Y. and Richou, A. (2011). On the uniqueness of solutions to\nquadratic BSDEs with convex generators and unbounded terminal conditions.\nAnn. Inst. H. Poincar\u00e9 Probab. Statist. To appear.\n[10] Fuhrman, M. and Tessitore, G. (2002). The Bismut\u2013Elworthy formula for backward SDEs and applications to nonlinear Kolmogorov equations and control in\ninfinite dimensional spaces. Stochastics Stochastics Rep. 74 429\u2013464. MR1940495\n[11] Gobet, E., Lemor, J.-P. and Warin, X. (2005). A regression-based Monte Carlo\nmethod to solve backward stochastic differential equations. Ann. Appl. Probab.\n15 2172\u20132202. MR2152657\n[12] Gobet, E. and Makhlouf, A. (2010). L2 -time regularity of BSDEs with irregular\nterminal functions. Stochastic Process. Appl. 120 1105\u20131132. MR2639740\n[13] Hu, Y., Imkeller, P. and M\u00fcller, M. (2005). Utility maximization in incomplete\nmarkets. Ann. Appl. Probab. 15 1691\u20131712. MR2152241\n[14] Imkeller, P. and Dos Reis, G. (2010). Path regularity and explicit convergence\nrate for BSDE with truncated quadratic growth. Stochastic Process. Appl. 120\n348\u2013379. MR2584898\n[15] Imkeller, P., dos Reis, G. and Zhang, J. (2010). Results on numerics for FBSDE\nwith drivers of quadratic growth. In Contemporary Quantitative Finance (A.\nChiarella and C. Novikov, eds.). Springer, Berlin.\n[16] Kazamaki, N. (1994). Continuous Exponential Martingales and BMO. Lecture Notes\nin Math. 1579. Springer, Berlin. MR1299529\n[17] Kobylanski, M. (2000). Backward stochastic differential equations and partial differential equations with quadratic growth. Ann. Probab. 28 558\u2013602. MR1782267\n[18] Lepeltier, J. P. and San Mart\u0131\u0301n, J. (1998). Existence for BSDE with superlinearquadratic coefficient. Stochastics Stochastics Rep. 63 227\u2013240. MR1658083\n[19] Zhang, J. (2004). A numerical scheme for BSDEs. Ann. Appl. Probab. 14 459\u2013488.\nMR2023027\n[20] Zhang, J. (2005). Representation of solutions to BSDEs associated with a degenerate\nFSDE. Ann. Appl. Probab. 15 1798\u20131831. MR2152246\n[21] Zhang, J. (2001). Some fine properties of BSDE. Ph.D. thesis, Purdue Univ.\nIRMAR\nUniversit\u00e9 de Rennes 1\nCampus de Beaulieu\n35042 Rennes Cedex\nFrance\nE-mail: adrien.richou@univ-rennes1.fr\n\n\f"}