{"id": "http://arxiv.org/abs/physics/0501018v1", "guidislink": true, "updated": "2005-01-06T01:21:09Z", "updated_parsed": [2005, 1, 6, 1, 21, 9, 3, 6, 0], "published": "2005-01-06T01:21:09Z", "published_parsed": [2005, 1, 6, 1, 21, 9, 3, 6, 0], "title": "A Hilbert-space formulation of and variational principle for spontaneous\n  wiggler radiation", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0501136%2Cphysics%2F0501017%2Cphysics%2F0501023%2Cphysics%2F0501100%2Cphysics%2F0501099%2Cphysics%2F0501123%2Cphysics%2F0501116%2Cphysics%2F0501072%2Cphysics%2F0501107%2Cphysics%2F0501134%2Cphysics%2F0501150%2Cphysics%2F0501110%2Cphysics%2F0501093%2Cphysics%2F0501048%2Cphysics%2F0501073%2Cphysics%2F0501063%2Cphysics%2F0501024%2Cphysics%2F0501088%2Cphysics%2F0501003%2Cphysics%2F0501071%2Cphysics%2F0501055%2Cphysics%2F0501103%2Cphysics%2F0501009%2Cphysics%2F0501077%2Cphysics%2F0501046%2Cphysics%2F0501058%2Cphysics%2F0501152%2Cphysics%2F0501030%2Cphysics%2F0501066%2Cphysics%2F0501001%2Cphysics%2F0501129%2Cphysics%2F0501074%2Cphysics%2F0501018%2Cphysics%2F0501097%2Cphysics%2F0501067%2Cphysics%2F0501056%2Cphysics%2F0501165%2Cphysics%2F0501041%2Cphysics%2F0501015%2Cphysics%2F0501158%2Cphysics%2F0501051%2Cphysics%2F0501054%2Cphysics%2F0501141%2Cphysics%2F0501132%2Cphysics%2F0602110%2Cphysics%2F0602116%2Cphysics%2F0602073%2Cphysics%2F0602105%2Cphysics%2F0602086%2Cphysics%2F0602096%2Cphysics%2F0602108%2Cphysics%2F0602106%2Cphysics%2F0602144%2Cphysics%2F0602157%2Cphysics%2F0602015%2Cphysics%2F0602185%2Cphysics%2F0602079%2Cphysics%2F0602150%2Cphysics%2F0602131%2Cphysics%2F0602089%2Cphysics%2F0602160%2Cphysics%2F0602151%2Cphysics%2F0602077%2Cphysics%2F0602013%2Cphysics%2F0602042%2Cphysics%2F0602001%2Cphysics%2F0602067%2Cphysics%2F0602050%2Cphysics%2F0602007%2Cphysics%2F0602043%2Cphysics%2F0602127%2Cphysics%2F0602068%2Cphysics%2F0602101%2Cphysics%2F0602190%2Cphysics%2F0602139%2Cphysics%2F0602103%2Cphysics%2F0602167%2Cphysics%2F0602084%2Cphysics%2F0602023%2Cphysics%2F0602172%2Cphysics%2F0602028%2Cphysics%2F0602097%2Cphysics%2F0602004%2Cphysics%2F0602113%2Cphysics%2F0602137%2Cphysics%2F0602112%2Cphysics%2F0602130%2Cphysics%2F0602029%2Cphysics%2F0602074%2Cphysics%2F0602003%2Cphysics%2F0602126%2Cphysics%2F0602169%2Cphysics%2F0602158%2Cphysics%2F0602063%2Cphysics%2F0602111%2Cphysics%2F0602016%2Cphysics%2F0602094%2Cphysics%2F0602091%2Cphysics%2F0602052%2Cphysics%2F0602184%2Cphysics%2F0602161&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Hilbert-space formulation of and variational principle for spontaneous\n  wiggler radiation"}, "summary": "Within the framework of Hilbert space theory, we derive a maximum-power\nvariational principle applicable to classical spontaneous radiation from\nprescribed harmonic current sources. Results are first derived in the paraxial\nlimit, then appropriately generalized to non-paraxial situations. The\ntechniques were developed within the context of undulator radiation from\nrelativistic electron beams, but are more broadly applicable.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0501136%2Cphysics%2F0501017%2Cphysics%2F0501023%2Cphysics%2F0501100%2Cphysics%2F0501099%2Cphysics%2F0501123%2Cphysics%2F0501116%2Cphysics%2F0501072%2Cphysics%2F0501107%2Cphysics%2F0501134%2Cphysics%2F0501150%2Cphysics%2F0501110%2Cphysics%2F0501093%2Cphysics%2F0501048%2Cphysics%2F0501073%2Cphysics%2F0501063%2Cphysics%2F0501024%2Cphysics%2F0501088%2Cphysics%2F0501003%2Cphysics%2F0501071%2Cphysics%2F0501055%2Cphysics%2F0501103%2Cphysics%2F0501009%2Cphysics%2F0501077%2Cphysics%2F0501046%2Cphysics%2F0501058%2Cphysics%2F0501152%2Cphysics%2F0501030%2Cphysics%2F0501066%2Cphysics%2F0501001%2Cphysics%2F0501129%2Cphysics%2F0501074%2Cphysics%2F0501018%2Cphysics%2F0501097%2Cphysics%2F0501067%2Cphysics%2F0501056%2Cphysics%2F0501165%2Cphysics%2F0501041%2Cphysics%2F0501015%2Cphysics%2F0501158%2Cphysics%2F0501051%2Cphysics%2F0501054%2Cphysics%2F0501141%2Cphysics%2F0501132%2Cphysics%2F0602110%2Cphysics%2F0602116%2Cphysics%2F0602073%2Cphysics%2F0602105%2Cphysics%2F0602086%2Cphysics%2F0602096%2Cphysics%2F0602108%2Cphysics%2F0602106%2Cphysics%2F0602144%2Cphysics%2F0602157%2Cphysics%2F0602015%2Cphysics%2F0602185%2Cphysics%2F0602079%2Cphysics%2F0602150%2Cphysics%2F0602131%2Cphysics%2F0602089%2Cphysics%2F0602160%2Cphysics%2F0602151%2Cphysics%2F0602077%2Cphysics%2F0602013%2Cphysics%2F0602042%2Cphysics%2F0602001%2Cphysics%2F0602067%2Cphysics%2F0602050%2Cphysics%2F0602007%2Cphysics%2F0602043%2Cphysics%2F0602127%2Cphysics%2F0602068%2Cphysics%2F0602101%2Cphysics%2F0602190%2Cphysics%2F0602139%2Cphysics%2F0602103%2Cphysics%2F0602167%2Cphysics%2F0602084%2Cphysics%2F0602023%2Cphysics%2F0602172%2Cphysics%2F0602028%2Cphysics%2F0602097%2Cphysics%2F0602004%2Cphysics%2F0602113%2Cphysics%2F0602137%2Cphysics%2F0602112%2Cphysics%2F0602130%2Cphysics%2F0602029%2Cphysics%2F0602074%2Cphysics%2F0602003%2Cphysics%2F0602126%2Cphysics%2F0602169%2Cphysics%2F0602158%2Cphysics%2F0602063%2Cphysics%2F0602111%2Cphysics%2F0602016%2Cphysics%2F0602094%2Cphysics%2F0602091%2Cphysics%2F0602052%2Cphysics%2F0602184%2Cphysics%2F0602161&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Within the framework of Hilbert space theory, we derive a maximum-power\nvariational principle applicable to classical spontaneous radiation from\nprescribed harmonic current sources. Results are first derived in the paraxial\nlimit, then appropriately generalized to non-paraxial situations. The\ntechniques were developed within the context of undulator radiation from\nrelativistic electron beams, but are more broadly applicable."}, "authors": ["A. E. Charman", "J. S. Wurtele"], "author_detail": {"name": "J. S. Wurtele"}, "author": "J. S. Wurtele", "links": [{"href": "http://arxiv.org/abs/physics/0501018v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/physics/0501018v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "physics.class-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.class-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.optics", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/physics/0501018v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/physics/0501018v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "UCB/LBNL-CBP preprint\n\nA Hilbert-space formulation of and variational principle for\nspontaneous wiggler radiation\nA.E. Charman\u2217 and J.S. Wurtele\n\narXiv:physics/0501018v1 [physics.class-ph] 6 Jan 2005\n\nDepartment of Physics, University of California, Berkeley, Berkeley, CA 94720, USA\nCenter for Beam Physics, Lawrence Berkeley National Laboratory, USA\n(Dated: 22 December 2004)\nWithin the framework of Hilbert space theory, we derive a maximum-power variational principle\napplicable to classical spontaneous radiation from prescribed harmonic current sources. Results\nare first derived in the paraxial limit, then appropriately generalized to non-paraxial situations.\nThe techniques were developed within the context of undulator radiation from relativistic electron\nbeams, but are more broadly applicable.\nPACS numbers: 02.70.Dh, 41.20.Jb, 41.60.Ap, 41.60.Cr, 42.25.Bs, 45.10.Db, 52.38.Ph, 52.40.Db,\n52.59.Rz, 52.59.Ye\n\nI.\n\nINTRODUCTION\n\nVariational principles are ubiquitous in electromagnetism [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]. Thomson's and\nDirichlet's Principles allow the determination of potentials or capacitances in electrostatics, or the determination of steady-state currents and voltages in electrical networks. General reciprocity relations lead to\nvariational estimates for eigenmodes of cavities or waveguides, impedances of cavities, apertures, or other\nstructures, and even certain scattering coefficients. In magnetohydrodynamics, plasma kinetic theory,\nand certain equilibrium or non-equilibrium thermodynamic situations, stability or dynamics accessibility\nof charged particle distributions has been derived from minimum energy/free energy, maximum entropy,\nor minimum entropy production or minimum heat production principles [12, 13, 14, 15, 16, 17, 18, 19, 20].\nDensity functional theory, an elaboration of the famous Thomas-Fermi and Hartree-Fock methods in\nquantum mechanics, has also been applied to classical and quantum Coulomb gases [21, 22]. Many\nnumerical methods and approximation techniques [8, 23, 24, 25, 26, 27, 28] for mechanical or manual\ncomputation, associated with the names Raleigh, Ritz, Galerkin, Finite Elements, Minimum Residuals,\nMethod of Moments, etc., may all be derived from or interpreted as variational principles. As is well\nknown, all of ray optics may be derived from Fermat's Principle of Least Time, and ultimately, all of\nclassical electrodynamics may be derived via Hamilton's Principle, a variational formulation demanding\nstationarity of the action functional.\nVariational techniques or approaches enjoy many advantages. They provide unified theoretical treatments and compact mathematical descriptions of many physical phenomena, which allow for straightforward change of coordinates and incorporation of additional constraints. Conventional equations of\nmotion and conservation laws may be derived in an concise manner. Connections between classical and\nquantum limits are often more readily apparent. Variational principles often suggest appealing physical\ninterpretations of the behaviors governed by them. They provide a unified, compact framework for\nperforming eikonal, ponderomotive, or other averaging techniques. Perhaps most importantly from a\npractical standpoint, they offer starting points for efficient approximation or numerical computation,\nwhereby complicated partial differential equations or integro-differential equations may be replaced with\nmore tractable mathematical beasts, namely quadratures, ordinary differential equations, systems of\nalgebraic or even linear equations, or ordinary function minimization. Although approximate, these simplified, projected, or parameterized variational solutions may be more easily interpreted or more easily\ncomputed or offer more insight than the exact forms.\nHere, we derive another principle, which we will call the Maximum-Power Variational Principle (MPVP),\ntogether with some surrounding mathematical formalism. Although relatively simple in its statement\n\n\u2217 Electronic\n\naddress: acharman@physics.berkeley.edu\n\n\f2\nand scope, somewhere between intuitively plausible and obvious, depending upon one's point of view,\nthe MPVP may be of some use in the classical theory of radiation, in particular in the analysis of light\nsources relying on spontaneous radiation from relativistic electron beams in undulators or other magnetic\ninsertion devices, or more generally, for the approximation of features of other forms of synchrotron\nor \"magnetic Bremsstrahlung\" radiation. After some suitable generalization, these ideas may also be\napplicable to the cases of \u010cerenkov, transition, wave-guide/cavity, Smith-Purcell, or other types of\nradiation emitted by classical particle beams traveling through certain media or structures.\nThis work arose out of a recent treatment of coherent X-ray generation via a harmonic cascade in an\nelectron beam which radiates in the low-gain regime while traveling through a series of undulators. Penn,\net al. [29, 30, 31] approximate the modal structure of the radiation in terms of a paraxial mode described\nby certain adjustable parameters. Some of these parameters are subsequently determined directly by\ndynamical considerations, but some remain free, and are determined at the end of the calculation under\nthe assumption that the \"proper\" or \"natural\" criterion is to choose the values of these parameters which\nmaximize the resulting radiated power assuming that mode shape. This procedure seems so physically\nreasonable, appealing, and plausible that intuition suggests that, in some sense, it must be the correct\napproach under the circumstances. However, at least the present authors' intuitions fail to immediately\nsuggest a precise derivation or rigorous justification of this power-maximization idea. Then again, it does\nlead us to expect that the governing principles or concepts should be quite fundamental, and applicable\nto more general radiation problems.\nIn this paper we pursue these ideas, developing various Hilbert-space approaches to the spontaneous\nradiation from prescribed current sources, culminating in the Maximum-power variational principle\n(MPVP) applicable to such problems under very general assumptions. Although the final results are\nquite simple and intuitive, the mathematics are developed in some detail in a deliberate and pedagogical\nfashion; much can probably be skipped with impunity by all but the most interested readers.\nWe first consider the approximate but commonly-encountered case of paraxial fields, where the structure\nand dynamics of the fields and the development of the mathematical results are greatly simplified.\nMotivated by the parallels between the Schrodinger equation in non-relativistic quantum mechanics\nand the paraxial wave equation of classical physical optics, we present an elementary derivation of\na convenient Hilbert-space formalism for the spontaneous radiation produced by prescribed classical\nsources in the paraxial limit, including a derivation of the MPVP. Guided by these results, we then\nemploy Green function and spherical wave treatments of the general three-dimensional radiation fields\nto generalize these results to the case of non-paraxial fields propagating in free space. Specifically, we\nhave in mind applications to the spontaneous synchrotron emission from a reasonably well-collimated\nrelativistic electron bunch in a wiggler or similar insertion device, although the results remain valid more\ngenerally.\nBy spontaneous emission, we mean that the trajectories of the charged particles constituting the source\nfor the radiation are considered prescribed functions of time, independent of the actual radiation fields\ngenerated. That is, the particle trajectories are assumed to be determined by initial conditions, externally\napplied wiggler or other guiding fields, and possibly even space-charge effects (quasi-static self-fields,\neither exact including collisions, or in a mean-field/Vlasov approximation), while any back-action of the\nradiation itself on the particles \u2013 either recoil, absorption, or multiple scattering effects \u2013 is neglected.\nThus the MPVP provides an approximate alternative to calculation of the fields via the usual Li\u00e9nardWeichart potentials or related expressions [5].\nFor the case of a wiggler or undulator, this implies that any gain due to ponderomotive feedback and\ndynamic bunching remains small, so the resulting self-consistent stimulated emission component of the\nradiation can be neglected compared to the spontaneous component. The spontaneously-emitted radiation and its measurable properties (power, angular distribution, coherence, etc.) can then in principle\nbe expressed as deterministic functions of the incoming beam phase space profile (including emittance\neffects and any pre-bunching) and the prescribed external fields, without having to solve the equations\nof motion including radiation to obtain completely self-consistent trajectories for the particles.\nAlthough the radiation is treated classically, this terminology involving spontaneous/stimulated emission\nis standard in the Free Electron Laser (FEL) literature, which, of course, intentionally borrowed it\nfrom the quantum theory of lasers. The stimulated emission is that which requires (for ponderomotive\nbunching) the presence of both the static wiggler field and additional radiation, either from an external\n\n\f3\nseed (FEL amplifier), from emission earlier in the same wiggler (SASE), or from a previous pass through\nthe wiggler in the presence of a resonant cavity or mirror system (conventional FEL oscillator). The\nspontaneous emission is, by definition, that which occurs in the absence of additional (applied) radiation\nfields, but of course it still requires the static wiggler field. Truly \"free\" electrons do not radiate because\nthey are not accelerated, and in fact energy-momentum considerations would forbid even a solitary\naccelerated electron from radiating if the interaction providing the acceleration did not also allow for a\nmomentum exchange with some external matter (ultimately the wiggler magnets or other electrons, in\nthe present case).\nTherefore, the description of the wiggler radiation as spontaneous is similar to the atomic case in that\nit occurs in the absence of applied radiation (i.e., real photons), but it differs in that electrons bound\nin atoms, if somehow excited, can then radiate in the absence of any external fields. The static (i.e.,\nvirtual photon) wiggler field is therefore playing a role analogous to the nuclear Coulomb field. In the\naverage rest frame of a sufficiently relativistic beam, the Weizsacker-Williams method of virtual quanta\nmay be used, since the Lorentz-transformed static wiggler field begins to resemble an oncoming beam\nof actual photons. Spontaneous radiation occurs when a backwardly-moving, virtual, wiggler photon is\nscattered by an electron into a forward-moving, real photon. Stimulated emission occurs in a \"threebody collision\" where an electron simultaneously scatters a virtual wiggler photon and real radiation\nphoton into two real photons, both in the same mode as the incident photon.\nThroughout this analysis, we also assume that the charge and current densities are not only prescribed,\nbut remain localized in space (so that the far-field, or wave zone, is defined) and time (so that certain\nFourier transforms exist), in a manner more precisely specified in the course of our derivations. We\ncould generalize our treatment to additionally include the effects of uniform background conductive or\ndielectric media, but for simplicity we here assume that, apart from its generation by the prescribed microscopic sources in a bounded spacetime region, the emitted radiation otherwise propagates in vacuum.\nGeneralizations to allow for non-uniform dielectric tensors, representing wave-guides, lenses, windows,\nor other optical devices, might also be possible, but is not pursued here. As we are interested in the\ncausal (outgoing) radiation produced by the given sources, we neglect any incident source-free fields or\nfields from other, remote sources. Because we are working in the fully linear spontaneous limit, any such\nfields may be added in superposition at the very end of the calculation.\n\nII.\n\nFUNDAMENTAL EQUATIONS\n\nThroughout this paper, we denote in boldface type any real or complex vectors, e.g., a or b, and denote\nwith carets any real or complex unit vectors such as \u00e2 which satisfy\nk\u00e2k \u2261 (\u00e2\u2217 * \u00e2)1/2 = 1,\n\n(1)\n\nwhere for any N -dimensional complex-valued vectors a, b \u2208 CN ,\na*b=\n\nN\nX\n\nan b n\n\n(2)\n\nn=1\n\nis the usual Euclidean dot product (without any implicit complex conjugation) of the components of a\nand b in some orthogonal basis. Additional notation will be introduced as needed.\nConforming to widespread, if not universal, convention in beam physics, we work in the (non-covariant)\nCoulomb, transverse, or radiation gauge, where the vector potential A = A\u22a5 = A(x, t) is chosen to be\npurely solenoidal (i.e., divergenceless), or everywhere transverse in the sense of Helmholtz's Theorem:\n\u2207 * A(x, t) = 0.\n\n(3)\n\nHere, x \u2208 R3 denotes the three-dimensional position and t \u2208 R the time, in any one convenient Lorentz\nframe (typically the lab frame, or possibly the average electron beam frame, for wiggler radiation problems). In Gaussian units, the scalar potential \u03a6 = \u03a6(x, t) then satisfies the instantaneous (i.e., unretarded) Poisson's equation\n\u22072 \u03a6(x, t) = \u22124\u03c0\u03c1(x, t),\n\n(4)\n\n\f4\ngiven the charge density \u03c1, while the vector potential the vector potential A satisfies the inhomogeneous\nwave equation\n\u22072 A(x, t) \u2212\n\n1 \u22022\nc2 \u2202t2 A(x, t)\n\n= \u2212 4\u03c0\nc J\u22a5 (x, t),\n\n(5)\n\nwhere c is the speed of light in vacuo, and J\u22a5 is the transverse (solenoidal) component of the full current\ndensity J, and which, using (4) and local charge conservation, can be shown to be given by\nJ\u22a5 (x, t) = J(x, t) \u2212 Jk (x, t) = J(x, t) \u2212\n\n1\n\u2202\n4\u03c0 \u2207 \u2202t \u03a6(x, t).\n\n(6)\n\nThe physical fields are, as usual, related to the potentials by\n\u2202\nA \u2212 \u2207\u03a6,\nE = E\u22a5 + Ek = \u2212 1c \u2202t\n\n(7)\n\nB = B\u22a5 = \u2207 \u00d7 A.\n\n(8)\n\nand\n\nNote again that we are describing only the fields generated by the prescribed sources \u03c1 and J. By\nassumption, any externally applied fields (due ultimately to some additional, remote sources) such as\nundulator or bend magnets are not included in the potentials A or \u03c6, but their effects on the trajectories\nof the charge particles constituting the actual radiation sources are assumed to be either already included\nin J(x, t) and \u03c1(x, t), or else are neglected.\nWithout some prior expectation for the typical magnitudes of the dominant radiation frequency \u03c9rad\nor characteristic transverse spot size w0 of a radiation beam, it is convenient to re-scale the space-time\ncoordinates using the remaining spatio-temporal scales, namely those determined by the speed of light c\nand the plasma frequency \u03c9p associated with the charge density of the known source. That is, choosing\nsome reference number density n\u0304, ideally characteristic of that of the actual particle bunch, and defining\nthe corresponding linear plasma frequency\n\u03c9p =\n\n\u0012\n\n4\u03c0n\u0304e2\nme\n\n\u00131/2\n\n,\n\n(9)\n\nwere me is the electron mass and e the magnitude of the electron charge, we define normalized (di\u03c9\nmensionless) variables: a normalized time \u03c4 = \u03c9p t, normalized longitudinal position \u03be = cp z, normal\u03c9p\nized transverse coordinates r = rx x\u0302 + ry \u0177 = c (x x\u0302 + y \u0177) , normalized three-dimensional coordinates\ne\n\u03b6 = \u03be \u1e91 + r, the normalized vector potential a(\u03b6; \u03c4 ) = a(r, \u03be; \u03c4 ) = mc\n2 A(x, t), normalized scalar poe\n1\ntential \u03c6(\u03b6; \u03c4 ) = \u03c6(r, \u03be; \u03c4 ) = mc2 \u03a6(x, t), normalized charge density \u03bc(\u03b6; \u03c4 ) = \u03bc(r, \u03be; \u03c4 ) = en\u0304\n\u03c1(x, t),\n1\nJ(x,\nt),\nwith\ntransverse\n(solenoidal)\npart\nand a normalized current\ndensity\nj(\u03b6;\n\u03c4\n)\n=\nj(r,\n\u03be,\n\u03c4\n)\n=\nen\u0304c\n\u0010\n\u0011\n\nj\u22a5 =\n\n1\nen\u0304c J\u22a5\n\n\u2202\n= j \u2212 \u1e91 \u2202\u03be\n+ \u2207\u22a5\n\n\u2202\n\u2202\u03c4 \u03c6,\n\nwhere \u2207\u22a5 \u2261\n\ntransverse gradient operator, and we also define \u2202 =\nthe full three-dimensional space.\n\n\u2202\n\u2202\n\u2202\n\u2202r = x\u0302 \u2202rx + \u0177 \u2202ry is\n\u2202\n\u2202\n\u2202\u03b6 = \u1e91 \u2202\u03be + \u2207\u22a5 as the\n\nIn these variables, Poisson's equation becomes\n\u0010 2\n\u0011\n2\n\u2202\n\u2202 2 \u03c6(\u03b6; \u03c4 ) = \u2202\u03be\n\u03c6(r, \u03be; \u03c4 ) = \u03bc(r, \u03be; \u03c4 ),\n2 + \u2207\u22a5\n\nthe scaled, (geometrically)\nscaled gradient operator in\n\n(10)\n\nwhere \u22072\u22a5 = \u2207\u22a5 * \u2207\u22a5 is the scaled (geometrically) transverse Laplacian, and \u2202 2 = \u2202 * \u2202 is the scaled\nthree-dimensional Laplacian. The solutions to this equation just consist of the well-known unretarded\n(i.e., instantaneous) Coulomb fields,\nZ\n\u03bc(\u03b6 \u2032 , \u03c4 )\n1\n(11)\n\u03c6(\u03b6; \u03c4 ) = \u2212 4\u03c0\nd3 \u03b6 \u2032\nk\u03b6 \u2212 \u03b6 \u2032 k\n\nwhich fall off like the inverse-square distance from the instantaneous positions of the charges, so they\ndo not contribute to the radiation fields, and can be neglected for our purposes. (These unretarded\nCoulomb fields are \"attached\" to the charges and move with them even under acceleration, so do not\n\n\f5\ninclude or in any way constitute radiation.) The scaled wave equation for the vector potential may be\nwritten as\n\u0013\n\u0012\n\u0013\n\u0012\n\u22022\n\u22022\n2\n2\n\u22022\n(12)\n\u2202 \u2212 2 a(\u03b6; \u03c4 ) = \u2202\u03be2 + \u2207\u22a5 \u2212 2 a(r, \u03be; \u03c4 ) = \u2212j\u22a5 (r, \u03be; \u03c4 ),\n\u2202\u03c4\n\u2202\u03c4\nwhere a also satisfies the gauge condition\n\u0010\n\u0011\n\u2202\n\u2202 * a(\u03b6; \u03c4 ) = \u1e91 \u2202\u03be\n+ \u2207\u22a5 * a(r, \u03be; \u03c4 ) = 0.\n\n(13)\n\nAll of what we conventionally consider radiation is associated with the fields derived from this vector\npotential, although these fields also include (in the near-field region) non-radiative components needed\nto cancel the non-retarded features of the Coulomb fields.\nTo separately analyze each spectral component of the radiation, we perform Fourier transforms in (scaled)\ntime, obtaining, for each (scaled) frequency \u03c9, the frequency-domain wave equation\n\u0011\n\u0010 2\n\u0001\n2\n2\n\u2202\na(r, \u03be; \u03c9) = \u2212j\u22a5 (r, \u03be; \u03c9),\n(14)\n\u2202 2 + \u03c9 2 a(r, \u03be; \u03c9) = \u2202\u03be\n2 + \u2207\u22a5 + \u03c9\nand frequency-domain gauge condition\n\nwhere\n\n\u0011\n\u0010\n\u2202\n\u2202 * a(\u03b6; \u03c9) = \u1e91 \u2202\u03be\n+ \u2207\u22a5 * a(r, \u03be; \u03c9) = 0,\n\n(15)\n\na(\u03b6; \u03c9) =\n\n\u221a1\n2\u03c0\n\nZ\n\nd\u03c4 ei\u03c9\u03c4 a((\u03b6; \u03c4 )\n\n(16)\n\nj\u22a5 (\u03b6; \u03c9) =\n\n\u221a1\n2\u03c0\n\nZ\n\nd\u03c4 ei\u03c9\u03c4 j\u22a5 (\u03b6; \u03c4 )\n\n(17)\n\nand\n\ndenote the usual Fourier transforms in scaled time, and are in general complex-valued. Because the\nphysical, time-domain fields are real-valued, we necessarily have a(\u03b6; \u2212\u03c9) = a(\u03b6; \u03c9)\u2217 , so we can restrict\nattention to the analytic signal, or positive frequency (\u03c9 > 0), components of the radiation fields. We\nassume that the source charge density \u03c1 and current density j are at least weakly localized in time, to\nthe extent that all needed Fourier transforms of the sources and the resulting fields actually exist (at\nleast as generalized functions).\nCorresponding to the scaled, frequency-domain vector potential a(\u03b6; \u03c9), we define the scaled solenoidal\nelectric field:\n\u03b5a = \u03b5a (\u03b6; \u03c9) = i\u03c9 a(\u03b6; \u03c9);\n\n(18)\n\nand the scaled frequency-domain magnetic field\nba = ba (\u03b6; \u03c9) = \u2202 \u00d7 a(\u03b6; \u03c9).\n\n(19)\n\nThe subscript may be dropped when it is clear from which vector potential these fields are derived. For\nlater convenience, we also define the scaled, frequency-domain Poynting vector\nsa (\u03b6; \u03c9) = \u03b5a (\u03b6; \u03c9) \u00d7 ba (\u03b6; \u03c9)\u2217 .\n\n(20)\n\nFor any orientable surface \u03a3 with unit outward normal n\u0302, and positive frequency interval 0 < \u03c90 \u2264 \u03c9 \u2264\n\u03c91 , the quantity\nP[a](\u03a3; \u03c90 , \u03c91 ) \u2261\n\nZ\u03c91\n\n\u03c90\n\nd\u03c9 Re\n\n\u0014Z\n\n\u03a3\n\n2\n\nd \u03c3 n\u0302*sa\n\n\u0015\n\n(21)\n\nmay be taken as the scaled, time-averaged (over an optical period) net electromagnetic power, in the\nbandwidth [\u03c90 , \u03c91 ], which passes through the surface \u03a3.\n\n\f6\nIn order that the far-field, or radiation zone, even be well-defined, we assume that the physical source\nj(\u03b6; \u03c4 ) remains localized in space throughout the relevant emission process, at least in the direction(s)\nof observed radiation propagation. In the general, three-dimensional case, this means that j(\u03b6; \u03c9) is\nnon-negligible only in some neighborhood of some fixed point \u03b60 . However, from (6) and (11), it then\nfollows that the solenoidal component j\u22a5 (\u03b6; \u03c4 ) will not be strictly localized, but must possess decaying\ntails which fall off like O(1/k\u03b6 \u2212 \u03b6s k2 ) at sufficiently large distances from \u03b60 . That is, j and j\u22a5 will not\nboth be of compact support simultaneously. But the fields arising from any particular part of j\u22a5 (\u03b6 \u2032 ; \u03c4 )\nwill consist of the near-zone and intermediate zone fields which will fall off like like O(1/k\u03b6 \u2212 \u03b6 \u2032 k2 ) or\nfaster, as well as the true radiation fields which fall off more slowly, i.e. as O(1/k\u03b6 \u2212 \u03b6 \u2032 k). Because our\ninterest resides in the latter, it follows that as long as j(\u03b6; \u03c4 ) is appropriately localized, we can always\nchoose some suitably large but finite region beyond which the contributions of the decaying tails of j\u22a5\nto the radiation fields may be neglected to any desired level of accuracy, and we can then act as if both\nj(\u03b6; \u03c4 ) and j\u22a5 (\u03b6; \u03c4 ) have compact support.\n\nIII.\n\nPARAXIAL CASE\n\nBy paraxial, we mean that the radiation from the electron bunch in the insertion device can be assumed\nto be highly mono-directional, in the sense that the relevant angular scales \u2013 namely any possible overall\nangular offset between the electron beam and optical axis of the insertion device, the angular spread of\nthe particle beam, and the characteristic angle of diffraction \u2013 are assumed to be small, in a sense made\nprecise below. If we restrict attention to radiation observed within a sufficiently small detection solidangle, then radiation from relativistic particles in certain non-straight devices, i.e., synchrotron radiation\nin circular rings, may also be treated within the paraxial approximation. The needed local directionality\nis provided by the assumed finite acceptance entendue of the detector and the characteristic O(1/\u03b3)\nangular spread in the radiation resulting from relativistic O(1/\u03b3 2 ) compression effects between emitter\nand observer times, where \u03b3 is the usual relativistic kinematic factor associated with the mean velocity\nof the source charges, which together limit the contributing portion of the electron trajectory to some\nsmall arc.\n\nA.\n\nParaxial Approximation to the Wave Equation\n\nWe have already seen how, in the Coulomb gauge, the scalar potential \u03c6 does not contribute to the\nradiation fields. The vector potential a contributes to near-field (quasi-static), intermediate (inductionzone), and far-field (radiation-zone) effects (and in fact part of it must cancel, in the resulting fields, the\nnon-retarded effects of the scalar potential), but considerable simplification is possible if we effectively\nrestrict our attention to those portions of the fields which, if allowed to evolve freely after propagating\nbeyond the finite support of the sources, actually constitute radiation, and further assume that the\nradiation of interest propagates nearly along the +\u1e91 axis, with a small characteristic angle of diffraction\n\u03b8D \u226a 1 and any overall angular offset \u03b4\u03b80 . O(\u03b8d ). Then we can make the so-called paraxial approximation to the wave-equation for the vector potential a, which in effect consists of an asymptotic expansion\nin \u03b4\u03b80 .\nFirst, for any \u03c9 > 0 of interest, we express the vector potential in enveloped form:\na(r, \u03be; \u03c9) = \u03c8(r, \u03be; \u03c9)eik\u03be ,\n\n(22)\n\nwhere the (scaled), axial carrier wavenumber k = k(\u03c9) = +\u03c9 satisfies the vacuum dispersion relation for\na local plane wave traveling along +\u1e91. Similarly, we define an enveloped source term such that:\nj\u22a5 (r, \u03be; \u03c9) = 2k f (r, \u03be; \u03c9)eik\u03be .\nUsing the chain rule, the wave equation then becomes\n\u0012\n\u0013\n\u2202\n2\n\u22022\n\u2202\u03be 2 + 2ik \u2202\u03be + \u2207\u22a5 \u03c8(r, \u03be; \u03c9) + 2kf (r, \u03be; \u03c9) = 0,\n\n(23)\n\n(24)\n\n\f7\nwhile the radiation envelope \u03c8 and source envelope f both satisfy envelope-transversality conditions:\n\u0011\n\u0010\n\u2202\n(25a)\n+ ik \u1e91 + \u2207\u22a5 * \u03c8(r, \u03be; \u03c9) = 0,\n\u1e91 \u2202\u03be\n\u0011\n\u0010\n\u2202\n(25b)\n+ ik \u1e91 + \u2207\u22a5 * f (r, \u03be; \u03c9) = 0.\n\u1e91 \u2202\u03be\nWe assume that the charge density \u03c1 and full current density j remain weakly localized transversely, in\nthe sense that they are square-integrable in any transverse plane. Actually we will impose the slightly\nstronger constraint that |f (r; \u03be; \u03c9)| \u2192 0 more rapidly than 1/ |r| , as |r| \u2192 \u221e. We also assume that\nthe physical currents are strongly localized longitudinally, in the sense that they are negligible outside\nsome finite interval \u03be0\u2032 \u2264 \u03be \u2264 \u03be1\u2032 along the propagation axis, implying in general that the solenoidal\npart of the\u0010 current density\nj\u22a5 will actually have a component with non-compact support, corresponding\n\u0011\n\u2202\n\u2202\nto the \u2212 \u1e91 \u2202\u03be\n+ \u2207\u22a5 \u2202\u03c4\n\u03c6 term. However, this contribution to the sources falls off no slower than\nthe inverse-square of the distance from the source charges, so with arbitrarily small relative error in\nthe radiation fields, which are linear in the sources and fall off with the inverse distance from them,\nwe can safely truncate the source envelope f (r; \u03be; \u03c9) outside of some sufficiently large but finite range\n\u03be0 < \u03be0\u2032 \u2264 \u03be \u2264 \u03be1\u2032 < \u03be1 . (Again, the neglected contributions are strictly necessary to cancel the unretarded\npart of the Coulomb fields to ensure that the full fields remain compatible with relativistic causality, but\nwe are confining attention only to actual radiation.) Most of the final results will not actually depend on\nthe size of this interval, so if necessary we may safely take |\u03be1 \u2212 \u03be0 | \u2192 \u221e at the end of the calculation,\nprovided the charge and current densities continue to fall off sufficiently rapidly to ensure convergence\nof the relevant integrals, and we can somehow distinguish the far-fields from the local quasi-static fields\nwhen the latter may then extend to infinity.\nThe (scaled) waist of the radiation beam, or characteristic transverse spot size w0 , may be defined in\nterms of the minimal, power-weighted, root mean-square radius:\nR 2\n2\n2\nd r |r| |\u03c8(r, \u03be; \u03c9)|\n1 2\n.\n(26)\nR\n2 w0 = inf\n2\n\u03be\nd2 r |\u03c8(r, \u03be; \u03c9)|\n\nThe corresponding characteristic diffraction angle \u03b8D may then be taken as\n\u03b8D =\n\n1\n1 \u03bb\n=\n,\n2\u03c0 w0\nkw0\n\n(27)\n\nand finally the (scaled) Rayleigh range \u03beR , or longitudinal length-scale for appreciable change in the\ntransverse spot size due to diffraction, becomes:\n\u03beR = 12 kw02 .\n\n(28)\n\nWe now treat \u03b8D as a small parameter. Specifically, if \u03c8j is any (non-zero) component of the radiation\nenvelope \u03c8, then we may consistently assume that:\n\n\u2202\n\u2202\u03be \u03c8j\n\n/ |\u03c8j | \u223c O(\u03beR\u22121 ), while k\u2207\u22a5 \u03c8j k/ |\u03c8j | \u223c\n\nO(w0\u22121 ). If the spot size is sufficiently large compared to the carrier wavelength \u03bb = 2\u03c0/k, such that\n\u03b8D \u226a 1, then with a relative error of O(\u03b8D2 ), we may drop the higher-order longitudinal derivative in\nequation (24), obtaining the forced paraxial wave equation\n\u0011\n\u0010\n\u2202\n1\n(29)\ni \u2202\u03be\n+ 2k\n\u22072\u22a5 \u03c8(r, \u03be; \u03c9) + f (r, \u03be; \u03c9) = 0.\nNote that we have not yet directly imposed the same ordering assumptions on the spatial variations in the\nenvelope f (r; \u03be; \u03c9), but as the latter is the actual source for the radiation, it is clear that the transverse\nscale-lengths of \u03c8 must be consistent with those of f (r; \u03be; \u03c9) under diffractive propagation (and therefore\ntypically comparable in the vicinity of the sources.) However, as long as we consider sufficiently small\nwavelengths, the scale-length for longitudinal variations in f (r; \u03be; \u03c9) need not be comparable to \u03beR\nin order for the paraxial approximation to remain accurate for the fields of interest, i.e., for radiation\nobserved in the far-field region beyond the sources. Specifically, we may imagine the paraxial fields as the\nsuperposition of those fields from each infinitesimal transverse slice of current, evolved forward according\n\n\f8\nto the free-space paraxial propagation, so that each component will satisfy the paraxial conditions\neverywhere except for a discontinuous jump at its source slice, which can be replaced with an equivalent\nboundary condition applied to the homogeneous (source-free) equation. The paraxial solution is expected\nto remain accurate for any \u03be > \u03be1 if the paraxial conditions both hold for the calculated fields in the\nregion \u03be > \u03be1 and also hold for \u03be < \u03be1 , when the fields are extrapolated backwards via the free-space\n(homogeneous) paraxial propagation.\nThis paraxial wave equation is valid when the propagation direction is sufficiently close to the fiducial\n(+\u1e91) axis, and the scale-length for transverse variations in the radiation beam are large compared to\nthe carrier wavelength and small compared to the length-scale for longitudinal envelope variation (i.e.,\nresidual variation after the faster carrier oscillations have been removed.) Actually, although we have\nformally assumed that \u03b8D \u226a 1, numerical solutions to the full wave equation typically reveal that the\nparaxial approximation actually remains surprisingly accurate for focused radiation beams provided only\n\u03b8D . O(1). For still smaller spot sizes (tighter focus), the paraxial equation predicts a coherence volume\nVcoh < O(\u03bb3 ) for a single oscillatory mode, which would be in conflict with the diffraction limit dictated\nby the \"Heisenberg\" inequality constraining conjugate Fourier transform pairs.\n2\n\nFrom our above ordering assumptions, and the transversality condition (25a), it follows that |\u03c8z | /(|\u03c8x | +\n2\n|\u03c8y | )1/2 \u223c O(\u03b8D ), so the axial component \u03c8z can in certain circumstances be neglected outright, but\nwe will retain it here in order to explicitly satisfy the gauge condition. However, whenever convenient,\nthe gauge constraint for fully paraxial fields may be simplified, within the same O(\u03b8D2 ) relative accuracy\nas the paraxial wave equation itself, by dropping the longitudinal derivative:\n(ik \u1e91 + \u2207\u22a5 ) * \u03c8(r, \u03be; \u03c9) \u2248 0.\n\n(30)\n\nSo if the (geometrically) transverse components \u03c8\u22a5 = \u03c8\u2212 \u1e91 \u1e91 *\u03c8 are specified, then in this approximation\n\u03c8z (r, \u03be; \u03c9) may be taken as\n\u1e91 * \u03c8(r, \u03be; \u03c9) = ki \u2207\u22a5 * \u03c8\u22a5 (r, \u03be; \u03c9),\n\n(31)\n\nor conversely, if \u03c8z (r, \u03be; \u03c9) is given, then a \u03c8\u22a5 can always be chosen to satisfy (31) and ensure paraxial\nHelmholtz-transversality. The solenoidal source envelope f must in general satisfy the complete envelope\nconstraint (25b) including the longitudinal derivative, because its \u03be-dependence may be arbitrary.\n\nB.\n\nHilbert Space Formalism\n\nMathematically, the homogeneous (i.e., free-space, or source-free) part of (29) is exactly analogous to\nthe Schrodinger equation, in the position representation, for a quantum mechanical, spin-one particle\nof mass M, moving non-relativistically in a potential-free, two-dimensional, Euclidean space, where\nthe longitudinal position \u03be plays the role of the \"temporal\" evolution variable, r serves as the spatial\ncoordinates, and polarization is analogous to spin angular momentum, all in units where ~ = 1 and\nM = k = \u03c9.\nIn order to leverage the analogies to ordinary quantum mechanics, we introduce a Hilbert space, inner\nproduct, state vectors, operators, etc., using a Dirac-like notation. The full Hilbert space may be\nconsidered a tensor product of the Hilbert spaces for the (geometrically) transverse-spatial and the spin\n(polarization) degrees of freedom. (Our notation is similar, but not identical, to that in [32, 33]). We\nassociate the ket (really a spinor) |\u03c8i with the complex vector field \u03c8(r) defined on the (geometrically)\ntransverse spatial plane, i.e., as a mapping \u03c8 : R2 \u2192 C3 (possibly also parameterized by additional\ncontinuous variables such as \u03be and \u03c9 and by discrete mode indices, all suppressed for the moment). The\ncorresponding bra h\u03c8| is associated with the dual, or conjugate transpose, vector field, \u03c8(r)\u2020 , and a\ncombined L2 /Euclidean inner product is defined by\nZ\nh\u03c81 |\u03c82 i = d2 r \u03c81 (r)\u2217 * \u03c82 (r).\n(32)\nWe define a number of Hermitian operators acting on the spatial degrees of freedom by their action on\nthese position-representation wave vector fields \u03c8. Given any fixed unit vectors \u00ea, \u00ea\u2032 \u2208 C2 in the complex\n\n\f9\nlinear span of x\u0302 and \u0177, the transverse position operators just act via multiplication by the corresponding\ntransverse spatial coordinates\n\u00ea * Q\u03c8(r) \u2261 (\u00ea * r)\u03c8(r),\n\n(33)\n\nwhile the conjugate \"momentum\" operators act by differentiation:\n\u00ea\u2032 * P \u03c8(r) \u2261\n\n1\ni\n\n(\u00ea\u2032 * \u2207\u22a5 ) \u03c8(r),\n\n(34)\n\nso these operators then satisfy the usual canonical commutation relations\n[\u00ea * Q , \u00ea\u2032 * P ] = i (\u00ea * \u00ea\u2032 ) Ir ,\n\n(35)\n\nwhere Ir is the identity operator on transverse position-state space. We stress that these operators act\nonly on the transverse spatial coordinates, so that \u1e91 *Q = \u1e91 *P = 0. The \"kinetic energy\" or \"free-particle\nHamiltonian\" operator is then defined as:\nH\u2261\n\n1\n2M P\n\n1\n* P = \u2212 2k\n\u22072\u22a5 ,\n\n(36)\n\nwhich is just the infinitesimal generator of free-space, diffractive propagation along \u03be. With somewhat\nmore mathematical care about operator domains than is justified for this presentation, these Hermitian\noperators may be extended to fully self-adjoint operators without difficulty.\nIn order to include the polarization, we also define the complex helicity basis in C3 :\n\u01eb\u0302s = \u2212s \u221a12 (x\u0302 \u2212 is\u0177) + (1 \u2212 s2 )\u1e91 = \u2212 21 s2 (1 + s)\u00ea\u2212 + 21 s2 (1 \u2212 s)\u00ea+ + (1 \u2212 s2 )\u1e91,\n\n(37)\n\nfor s = \u22121, 0, +1, satisfying\n\u01eb\u0302\u2217s * \u01eb\u0302s\u2032 = \u03b4s s\u2032 ,\n\n(38)\n\nwhere \u03b4s s\u2032 is the usual Kronecker delta symbol and \u00ea\u00b1 \u2261 \u221a12 (x\u0302 \u00b1 i\u0177) = \u00ea\u2217\u2213 , and then can define various\nHermitian \"spin\" operators by their action on the polarization components of the fields \u03c8. In particular,\nwe define a vector of mutually orthogonal polarization projection operators\nX\n\u01eb\u0302s \u03a0s ,\n(39)\n\u03a0=\ns=\u22121,0,+1\n\nwhere\n\u03a0s \u03a8 = \u01eb\u0302s (\u01eb\u0302\u2217s * \u03a8) ,\n\n(40)\n\n\u03a0s \u03a0s\u2032 = \u03a0s\u2032 \u03a0s = \u03b4s s\u2032 \u03a0s ,\n\n(41)\n\nsuch that\n\nand\nX\n\n\u03a0s = I3 ,\n\n(42)\n\ns=\u22121,0,+1\n\nwhere\nI3 =\n\nX\n\n\u01eb\u0302s \u01eb\u0302\u2020s\n\n(43)\n\ns=\u22121,0,+1\n\nis the identity operator on the spin degrees of freedom. We also define the helicity, or circular polarization\noperator by\nSz = \u03a01 \u2212 \u03a0\u22121 ,\n\n(44)\n\nSz \u03c8 = \u00ea\u2212 \u00ea\u2217\u2212 * \u03c8 \u2212 \u00ea+ \u00ea\u2217+ * \u03c8.\n\n(45)\n\nso that\n\n\f10\nand\nSz2 = I3 \u2212 \u03a00 .\n\n(46)\n\nFor an enlightening discussion of the orbital and spin components of angular momentum in electromagnetic fields, see [34].\nClearly, all of these polarization operators commute with the spatial operators, so we may define generalized (i.e., non-normalizable) simultaneous eigenkets of position and spin |r; si for any r \u2208 R2 and\ns \u2208 {\u22121, 0, 1} :\nQ |r; si = r |r; si ,\n\n(47)\n\neir *P |r; si = |r \u2212 r \u2032 ; si ,\n\n(48)\n\nSz |r; si = s |r; si .\n\n(49)\n\n\u2032\n\nand\n\nWe similarly define generalized simultaneous eigenkets of spin and \"momentum\" (transverse wavevector)\nby taking the Fourier transforms of these position kets:\nZ\n1\n|p; si = 2\u03c0\nd2 r eip*r |r; si ,\n(50)\nwhich satisfy\nP |p; si = p |p; si ,\n\n(51)\n\nSz |p; si = s |p; si .\n\n(52)\n\nand\n\nThese generalized eigenkets satisfy the orthogonality relations\nhr; s|r \u2032 ; s\u2032 i = \u03b4s s\u2032 \u03b4 (2) (r \u2212 r \u2032 ),\n\n(53)\n\nhp; s|p\u2032 ; s\u2032 i = \u03b4s s\u2032 \u03b4 (2) (p \u2212 p\u2032 ),\n\n(54)\n\nand\n\nand the completeness relation\nXZ\ns\n\n2\n\nd r |r; s ih r; s| =\n\nXZ\ns\n\nd2 p |p; s ih p; s| = I,\n\n(55)\n\nwhere \u03b4 (2) (r) is the two-dimensional Dirac delta function, and I = I3 \u2297 Ir is the identity operator on the\nfull Hilbert space H consisting of all |\u03c8i which are normalizable, i.e., for which h\u03c8|\u03c8i < \u221e, implying\nthat the corresponding paraxial radiation fields \u03c8(r) are of finite power (but not of finite energy). The\nallowed radiation envelopes actually reside in the Hilbert sub-space H\u22a5 \u2282 H consisting of vector fields\nwhich also satisfy the transverse envelope gauge constraint when evolved in \u03be according to free-space\nparaxial evolution.\nDefining the coupled spin-momentum operator\n\u0013\n\u0012\n\u2202\n\u03a00 + P * \u03a0\nT (\u03b4) = k \u2212 i\u03b4\n\u2202\u03be\n\n(56)\n\nfor a real parameter \u03b4, and the constant reference ket |\u03c80 i \u2208 H such that\n\u03c80 (r) =\n\n\u221a1\n3\n\n(\u01eb\u0302\u22121 + \u01eb\u03020 + \u01eb\u0302+1 ) ,\n\n(57)\n\n\f11\nthe full envelope-transversality constraints (25) on the radiation and source may be written in our\nquantum notation as:\nh\u03c80 |T (\u03b4 = 1)| \u03c8(\u03be; \u03c9)i = 0,\nh\u03c80 |T (\u03b4 = 1)| f (\u03be; \u03c9)i = 0,\n\n(58a)\n(58b)\n\nwhile the approximate paraxial gauge constraint (30) becomes:\nh\u03c80 |T (\u03b4 = 0)| \u03c8(\u03be; \u03c9)i = 0,\n\n(59)\n\nAgain, within the paraxial approximation, either of these constraints may be used interchangeably for\nthe radiation, but the source must satisfy the full transversality constraint because its \u03be dependence is\narbitrary.\nIt is straightforward to see how the full envelope gauge constraint (58a) (including the longitudinal\nderivative) will be automatically maintained by the evolution, and how the approximate paraxial constraint (59) (neglecting the longitudinal derivative) will be preserved by free-space propagation or by\npropagation in the region of a fully paraxial source. Assuming that |\u03c8(\u03be; \u03c9)i satisfies the paraxial wave\nequation, with an initial condition satisfying\nlim h\u03c80 |T (\u03b4)| \u03c8(\u03be; \u03c9)i = 0,\n\n\u03be\u2192\u2212\u221e\n\n(60)\n\n(our specific choice of |\u03c8(\u03be; \u03c9)i = 0 for all \u03be < \u03be0 clearly works), and that the source |f (\u03be; \u03c9)i satisfies\nh\u03c80 |T (\u03b4)| f (\u03be; \u03c9)i = 0\n\n(61)\n\ni\nh\n\u2202\n= 0,\n[T (\u03b4), H(\u03c9)] = T (\u03b4), \u2202\u03be\n\n(62)\n\nfor all \u03be, and noting that\n\n\u2202\n\u2202\u03be H(\u03c9)\n\n= 0,\n\n(63)\n\nand\nH(\u03c9) |\u03c80 i = 0,\n\n(64)\n\nthen:\n\u2202\n\u2202\u03be\n\nE\nD\n\u2202\n\u03c8(\u03be; \u03c9)\nh\u03c80 |T (\u03b4)| \u03c8(\u03be; \u03c9)i = \u03c80 T (\u03b4) \u2202\u03be\n\n= \u2212i h\u03c80 |T (\u03b4)H(\u03c9)| \u03c8(\u03be; \u03c9)i + i h\u03c80 |T (\u03b4)| f (\u03be; \u03c9)i\n= \u2212i h\u03c80 |H(\u03c9)T (\u03b4)| \u03c8(\u03be; \u03c9)i + 0 = 0.\n\n(65)\n\nUsing the initial condition, we then have h\u03c80 |T (\u03b4)| \u03c8(\u03be; \u03c9)i = 0 for all \u03be. This shows that the full (\u03b4 = 1)\nenvelope transversality constraint (58a (including the longitudinal derivative) on the fields is preserved\neverywhere, if it holds initially for the fields and holds everywhere for the sources. The approximate\n(i.e., \u03b4 = 0) paraxial gauge constraint (59) is preserved by the evolution in regions free of sources and\nwherever the solenoidal source also satisfies this same, stronger condition.\n\nC.\n\nGreen Function Solution\n\nIn this quantum-like notation, the paraxial wave equation may be written as\n\u2202\n|\u03c8(\u03be; \u03c9)i = H |\u03c8(\u03be; \u03c9)i \u2212 |f (\u03be; \u03c9)i\ni \u2202\u03be\n\n(66)\n\n\f12\nGiven some \"initial\" state |\u03c8(\u03be \u2032 ; \u03c9)i , the solution to the homogeneous part of the equation (i.e., for\n|f (\u03be; \u03c9)i = 0) representing free space propagation of the radiation fields, may be written in terms of the\nunitary evolution operator as\n|\u03c8(\u03be; \u03c9)i = U (\u03be, \u03be \u2032 ; \u03c9) |\u03c8(\u03be \u2032 ; \u03c9)i ,\n\n(67)\n\nwhere U (\u03be, \u03be \u2032 ; k) satisfies the operator-valued Schrodinger equation\n\u2202\ni \u2202\u03be\nU (\u03be, \u03be \u2032 ; \u03c9) = HU (\u03be, \u03be \u2032 ; \u03c9)\n\n(68)\n\nU (\u03be \u2032 , \u03be \u2032 ; \u03c9) = I,\n\n(69)\n\nwith initial condition\n\nand possesses the group composition properties\nU (\u03be, \u03be \u2032 ; \u03c9)\u22121 = U (\u03be, \u03be \u2032 ; \u03c9)\u2020 = U (\u03be \u2032 , \u03be; \u03c9),\n\n(70)\n\nU (\u03be, \u03be \u2032\u2032 ; \u03c9)U (\u03be \u2032\u2032 , \u03be \u2032 ; \u03c9) = U (\u03be, \u03be \u2032 ; \u03c9).\n\n(71)\n\nand\n\nHere H = H(\u03c9) (with \u03c9 = k) is the Hamiltonian, or diffraction operator, defined above. Because H is\n\u03be-independent, we can immediately integrate (68) to find\n\u2032\n\nU (\u03be, \u03be \u2032 ; \u03c9) = e\u2212i(\u03be\u2212\u03be )H(\u03c9) .\n\n(72)\n\nThe solution to the full inhomogeneous wave equation (66) may be written in terms of the propagator,\nor causal Green function operator G(\u03be, \u03be \u2032 ; \u03c9) satisfying\n\u0011\n\u0010\n\u2202\n\u2212 H G(\u03be, \u03be \u2032 ; \u03c9) = \u03b4(\u03be \u2212 \u03be \u2032 )\n(73)\ni \u2202\u03be\nand\n\nG(\u03be, \u03be \u2032 ; \u03c9) = 0 for \u03be < \u03be \u2032 .\n\n(74)\n\nIt can easily be verified that this operator is given by\nG(\u03be, \u03be \u2032 ; \u03c9) = \u2212i\u0398(\u03be \u2212 \u03be \u2032 )U (\u03be, \u03be \u2032 ; \u03c9).\n\n(75)\n\nd\n\u0398(\u03be) is the one-dimensional Dirac delta\nHere \u0398(\u03be) is the usual Heaviside step function, and \u03b4(\u03be) = d\u03be\nfunction. Assuming no initial (incoming or outgoing) radiation, the formal solution to the inhomogeneous\nequation (66) (i.e., with the source term) is then\n\n|\u03c8(\u03be; \u03c9)i = \u2212\n\nZ\u221e\n\n\u2212\u221e\n\nd\u03be \u2032 G(\u03be, \u03be \u2032 ; \u03c9) |f (\u03be \u2032 ; \u03c9)i\n\nmin(\u03be,\u03be\nZ 1)\n\n(76)\n\nd\u03be \u2032 U (\u03be, \u03be \u2032 ; \u03c9) |f (\u03be \u2032 ; \u03c9)i ,\n\n=i\n\n\u03be0\n\nwhere we have used the assumption that the support of f (\u03be; r; \u03c9) is confined to \u03be0 < \u03be < \u03be1 . For any\n\u03be < \u03be0 , we then have |\u03c8(\u03be; \u03c9)i = 0 consistent with our assumed initial condition, while for all \u03be \u2265 \u03be1 , this\njust reduces to free-space propagation: |\u03c8(\u03be; \u03c9)i = U (\u03be, \u03be1 ; \u03c9) |\u03c8(\u03be1 ; \u03c9)i . In between we must actually\nsolve the full expression (76).\n\n\f13\nD.\n\nEnergetics\n\nIn our dimensionless variables, recall that the normalized, solenoidal electric field is given by\n\u2202\n\u2202\na(r; \u03be; \u03c4 ) = \u2212 \u2202\u03c4\n\u03c8(r; \u03be; \u03c4 )eik\u03be\n\u03b5a \u22a5 (r; \u03be; \u03c4 ) = \u2212 \u2202\u03c4\n\n(77)\n\nin the (scaled) time domain, or equivalently\n\u03b5a \u22a5 (r; \u03be; \u03c9) = i\u03c9 a(r; \u03be; \u03c9) = i\u03c9 \u03c8(r; \u03be; \u03c9)eik\u03be\n\n(78)\n\nin the (scaled) frequency domain.\nWithin the paraxial approximation, the inner product\nh\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i is then proportional to the (time-averaged) power spectral density for radiation of\nfrequency \u03c9 passing through the transverse plane at the longitudinal position \u03be. In fact, in scaled units\nwe may define the (normalized) power spectral density as\nZ\n2\n2\n2\n\u2202\nP\n[a](\u03be;\n\u03c9)\n=\n\u03c9\nh\u03c8(\u03be;\n\u03c9)|\u03c8(\u03be;\n\u03c9)i\n=\n\u03c9\nd2 r |\u03c8(r; \u03be; \u03c9)|\nEM\n\u2202\u03c9\nZ\nZ\n(79)\n2\n2\n2\n2\n2\n=\u03c9\nd r |a(r; \u03be; \u03c9)| = d r |\u03b5\u22a5 (r; \u03be; \u03c9)| .\nStrictly speaking, this yields the time-averaged Poynting flux only to O(\u03b8D ) at any finite distance from\nthe sources, but it is exact as \u03be \u2192 \u221e and we consider only the truly radiative transport of energy to\nspatial infinity. The unitary (inner-product preserving) nature of the paraxial evolution in vacuum then\ncorresponds to energy conservation for paraxial fields, where the (time-averaged) power crossing any\ntransverse plane in any frequency bandwidth, remains constant (with respect to propagation distance\n\u03be) during free-space evolution. Note, however, that while it is particularly convenient to formulate\nparaxial propagation in terms of the transformation of the fields in successive transverse planes, the\nactual wavefronts (level surfaces of phase) of a general paraxial beam are not planar except at the focus.\nFrom the actual solution |\u03c8(\u03be2 ; \u03c9)i in any conveniently-chosen transverse plane \u03be2 \u2265 \u03be1 beyond (i.e., to\nthe right of) the sources, we can construct the extrapolated free-space field\n\n|\u03c7(\u03be; \u03c9)i = U (\u03be, \u03be2 ; \u03c9) |\u03c8(\u03be2 ; \u03c9)i = i\n\nZ\u03be1\n\nd\u03be \u2032 U (\u03be, \u03be \u2032 ; \u03c9) |f (\u03be \u2032 ; \u03c9)i ,\n\n(80)\n\n\u03be0\n\nwhich represents the post-source paraxial radiation envelope extrapolated throughout all space via freespace propagation, including in the backward or \"upwind\" direction into the region where sources are\nactually present. Thus |\u03c7(\u03be; \u03c9)i and |\u03c8(\u03be; \u03c9)i coincide for all \u03be > \u03be1 , but not in general for \u03be < \u03be1 , where\n|\u03c7(\u03be; \u03c9)i satisfies the homogeneous (source-free) Schrodinger equation with no incoming radiation as \u03be \u2192\n\u2212\u221e, whereas |\u03c8(\u03be; \u03c9)i satisfies the inhomogeneous equation everywhere, so that all outgoing radiation\nat \u03be \u2192 \u221e is matched by incoming radiation at \u03be \u2192 \u2212\u221e. For any particular \u03be, these extrapolated fields\nare those fields which would have been present if the fields actually observed beyond the sources at some\n \u0304 \u03c9) located in some sufficiently remote\n\u03be2 > \u03be1 were instead produced by some effective source g(r; \u03be; \u03be;\n \u0304\n \u0304\nregion \u03be0 \u2212 \u03be < \u03be < \u03be1 \u2212 \u03be, instead of by the actual sources within \u03be0 < \u03be < \u03be1 :\n|\u03c7(\u03be; \u03c9)i = i\n\n\u03beZ\n1 \u2212\u03be\u0304\n\nd\u03be \u2032 U (\u03be, \u03be \u2032 ; \u03c9) g(\u03be \u2032 ; \u03be\u0304; \u03c9) ,\n\n(81)\n\n\u03be0 \u2212\u03be\u0304\n\nwhere the effective source is determined from the actual source simply by longitudinal translation and\ncompensation for diffraction:\n \u0304 f (\u03be \u2032 + \u03be\u0304; \u03c9) ,\ng(\u03be \u2032 ; \u03be\u0304; \u03c9) = U (\u03be \u2032 , \u03be + \u03be)\n\n(82)\n\n \u0304 \u03be1 ) \u2265 0 may any positive constant satisfying\nand \u03be \u0304 = \u03be(\u03be;\n\u03be \u0304 > \u03be1 \u2212 \u03be.\n\n(83)\n\n\f14\nChoosing any \u03be\u0304 > \u03be1 \u2212 \u03be0 , the expression (81) is then valid for any \u03be \u2265 \u03be0 , or we may actually take\n\u03be \u0304 \u2192 +\u221e if convenient, moving the effective sources to an abitrarily remote \"upwind\" location.\nUsing the Green function solution (76), and taking advantage of the assumed finite support of f , we\nfind that for any \u03be > \u03be1 ,\nmin(\u03be,\u03be\nZ 1)\n\nd\u03be \u2032 h\u03c8(\u03be; \u03c9) |U (\u03be, \u03be \u2032 ; \u03c9)| f (\u03be \u2032 ; \u03c9)i\n\nh\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = i\n\n\u03be0\n\n=i\n\nZ\u221e\n\nd\u03be \u2032 h\u03c7(\u03be \u2032 ; \u03c9)|f (\u03be \u2032 ; \u03c9)i\n\nZ\n\nZ\nd\u03be \u2032 d2 r \u03c7(r; \u03be \u2032 ; \u03c9)\u2217 * f (r; \u03be \u2032 ; \u03c9),\n\n\u2212\u221e\n\n=i\n\n(84)\n\nwhich is just a three-dimensional inner product, or overlap integral, between the source envelope\nf (r; \u03be \u2032 ; \u03c9) and the free-space radiation envelope \u03c7(r; \u03be \u2032 ; \u03c9) which has been extrapolated via free-space\npropagation backwards into the region where sources are present.\nWhile solenoidal and irrotational vector fields are not in general locally orthogonal in the geometric\nsense, they are Hilbert-space orthogonal when their Euclidean inner product is integrated over all space.\nBecause |\u03c8(\u03be; \u03c9)i and hence |\u03c7(\u03be; \u03c9)i satisfy the transverse gauge constraint, this overlap integral may\nbe simplified to\nZ\nZ\nh\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = i d\u03be \u2032 d2 r \u03c7(r; \u03be \u2032 ; \u03c9)\u2217 * f (r; \u03be \u2032 ; \u03c9)\nZ\nZ\n\u0003\u2217 \u0002\n\u0003\n\u0002\n\u2032\n1\n= \u2212 2\u03c92\nd\u03be d2 r i\u03c9 \u03c7eik\u03be * 2k f eik\u03be\nZ\nZ\n(85)\n= \u2212 2\u03c91 2\nd\u03be \u2032 d2 r \u03b5\u03c7 \u22a5 (r; \u03be \u2032 ; \u03c9)\u2217 * j\u22a5 (r; \u03be \u2032 ; \u03c9)\nZ\nZ\nd\u03be \u2032 d2 r \u03b5\u03c7 \u22a5 (r; \u03be \u2032 ; \u03c9)\u2217 * j(r; \u03be \u2032 ; \u03c9)\n= \u2212 2\u03c91 2\nZ\nd\u03be \u2032 h\u03b5\u03c7 \u22a5 (\u03be \u2032 ; \u03c9)|j(\u03be \u2032 ; \u03c9)i ,\n= \u2212 2\u03c91 2\nwhere \u03b5\u03c7 \u22a5 (r; \u03be \u2032 ; \u03c9) is the scaled, solenoidal electric field associated with the extrapolated radiation\nenvelope \u03c7. In order to evaluate the power, we therefore need never explicitly decompose the current\ndensity into its solenoidal and irrotational components, nor worry about the precise cutoff beyond which\nthe solenoidal component may be neglected.\nAs one would expect from energy conservation considerations, this overlap integral may be interpreted\nin terms of the rate of energy transfer between the charges constituting the sources and the fields. We\nmay define the scaled power spectral density associated with the rate of (time-averaged) mechanical\nwork done by scaled electric fields \u03b5(r; \u03be; \u03c9) on the charges associated with the scaled current density\nj(r; \u03be \u2032 ; \u03c9) as\nZ\n\u2202\nd\u03be \u2032 h\u03b5(\u03be \u2032 ; \u03c9)|j(\u03be \u2032 ; \u03c9)i\n\u2202\u03c9 Pmech [\u03b5; j](\u03c9) = Re\nZ\nZ\n(86)\n= Re d\u03be \u2032 d2 r \u03b5(r; \u03be \u2032 ; \u03c9)\u2217 * j(r; \u03be \u2032 ; \u03c9).\nR\nFrom (85), we see that d\u03be \u2032 h\u03b5\u03c7 \u22a5 (\u03be \u2032 ; \u03c9)|j(\u03be \u2032 ; \u03c9)i must be purely real and non-positive, because h\u03c8|\u03c8i =\nk\u03c8k2 is necessarily real and non-negative. Physically, this reflects the fact that the back-extrapolated\nfields, if actually present, would lead to no reactive energy transfer to local fields associated with rearrangement of the source charges, and mechanical energy would be transferred monodirectionally from\nthe charges to the radiation fields. Therefore (85) is equivalent to:\n\u2202\n\u2202\u03c9 PEM [a](\u03be; \u03c9)\n\n\u2202\n= \u2212 21 \u2202\u03c9\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9)\n\n(87)\n\n\f15\nThat is, the average power seen in the far field is exactly one-half of that which would be delivered by the\nsources to the extrapolated homogeneous fields if these fields were those actually present in the region\nof the sources.\nThe presence of the extra factor of 12 is intuitively plausible. The actual paraxial fields from each\ntransverse current slice consist only of the forward half of the corresponding extrapolated fields from this\nslice, and hence the former fields could interact only with \"downstream\" current slices while propagating\nin the forward (+\u1e91) direction, while the extrapolated fields from any current slice impinge on all other\ncurrent slices, both upstream and downstream. If we adopt the symmetric convention \u0398(0) = 21 for\nthe Heaviside step function (which is anyway the natural choice when Fourier transforms are involved),\neach current slice also appears to interact only with one-half of its own field. Assuming a reciprocity\narising from Newton's Third Law (magnetic forces can violate this law, but do no mechanical work, and\nradiation reaction forces can violate the third law as well, but are ignored here), we then anticipate an\nover-counting of the work by exactly a factor of 2 when we use the extrapolated fields and integrate over\nall current slices. This is a dynamical, electromagnetic analog of the well known electrostatic result that\nthe potential energy\nassociated with a given charge distribution \u03c1 in a given external potential \u03a6ext is\nR\ngiven by U = d3 x \u03c1\u03a6ext , while theR self-energy (potential energy of formation) of a charge distribution\nresulting in a potential \u03a6 is U = 21 d3 x \u03c1\u03a6.\nBelow, we will provide an elementary proof of this result in the general case, but it is informative to verify\nit with an explicit calculation for paraxial fields. By using the Green function solution and inserting a\nresolution of the identity, we have, for any \u03be > \u03be1 ,\n\u2202\n\u2202\u03c9 PEM [a](\u03be; \u03c9)\n\n2\n\n= \u03c9 h\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = i\u03c9\n\n2\n\nZ\u03be1\n\nd\u03be \u2032 h\u03c7(\u03be \u2032 ; \u03c9)|f (\u03be \u2032 ; \u03c9)i\n\n\u03be0\n\n= \u03c92\n\nZ\u03be1\n\nZ\u03be1\n\nd\u03be \u2032\n\n\u03be0\n\n= \u03c92\n\nd\u03be \u2032\u2032 hf (\u03be \u2032\u2032 ; \u03c9) |U (\u03be \u2032\u2032 , \u03be \u2032 ; \u03c9)| f (\u03be \u2032 ; \u03c9)i\n\n\u03be0\n\nXZ\n\nd2 r\n\ns\n\n=\u03c9\n\n2\n\nZ\u03be1\n\n(88)\n\n2\n\nd\u03be \u2032 hr; s |U (\u03be0 , \u03be \u2032 ; \u03c9)| f (\u03be \u2032 ; \u03c9)i\n\n\u03be0\n\nXZ\n\n2\n\nd r\n\ns\n\nZ\u03be1\n\n2\n\u2032\n\n\u2032\n\nd\u03be g(r; \u03be0 ; \u03be \u2212 \u03be0 ; \u03c9)\n\n\u03be0\n\nwhich explicitly demonstrates its reality and non-negativity. Using the same sort of manipulations, we\nthen have\n\u2202\n\u2202\u03c9 Pmech [\u03b5\u03c8 \u22a5 ; j](\u03c9)\n\n= Re\n\n\"Z\u03be1\n\n\u2032\n\n\u2032\n\n#\n\n\u2032\n\nd\u03be h\u03b5\u03c8 \u22a5 (\u03be ; \u03c9)|j(\u03be ; \u03c9)i\n\n\u03be0\n\n\"\n\n= Re \u22122i\u03c9k\n\nZ\u03be1\n\n\u2032\n\n#\n\n\u2032\n\nd\u03be h\u03c8(\u03be ; \u03c9)|f (\u03be ; \u03c9)i\n\n\u03be0\n\n= \u22122\u03c9 2 Re\n\n\"Z\u03be1\n\n2\n\nXZ\ns\n\nZ\u03be\n\nd\u03be \u2032\n\n\u03be0\n\n= \u22122\u03c9\n\n\u2032\n\n2\n\n(89)\n\n\u2032\n\nd\u03be \u2032\u2032 hf (\u03be \u2032\u2032 ; \u03c9) |U (\u03be \u2032\u2032 , \u03be \u2032 ; \u03c9)| f (\u03be \u2032 ; \u03c9)i\n\n\u03be0\n\nd r Re\n\n\"Z\u03be1\n\u03be0\n\n\u2032\n\n\u2032\n\nd\u03be g(r; \u03be0 ; \u03be \u2212 \u03be0 ; \u03c9)\n\nZ\u03be\n\n\u03be0\n\n#\n\n\u2032\n\n\u2032\u2032\n\n\u2032\u2032\n\n\u2217\n\nd\u03be g(r; \u03be0 ; \u03be \u2212 \u03be0 ; \u03c9)\n\n#\n\n\f16\nBut using integration by parts, this simplifies to\n\u2202\n\u2202\u03c9 Pmech [\u03b5\u03c8 \u22a5 ; j](\u03c9)\n2\n\n\"\n\n= (\u22122\u03c9 )\n\n1\n2\n\nXZ\n\n2\n\nd r\n\ns\n\nZ\u03be1\n\n\u2032\n\n\u2032\n\nd\u03be g(r; \u03be0 ; \u03be \u2212 \u03be0 ; \u03c9)\n\n\u03be0\n\n2#\n\n.\n\n(90)\n\n2\n\n\u2202\n= \u2212\u03c9 h\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = \u2212 \u2202\u03c9\nPa (\u03be; \u03c9)\n\nSo, indeed it is the case that:\n\u2202\n\u2202\n= \u2212 21 \u2202\u03c9\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9) = \u2212 \u2202\u03c9\nPmech [\u03b5a \u22a5 ; j](\u03c9),\n\n\u2202\n\u2202\u03c9 PEM [a](\u03be; \u03c9)\n\n(91)\n\nconsistent with expectations of energy conservation. Note that while the extrapolated source-free solution\n\u03c7 coincides ,by construction, with a in the downstream region \u03be > \u03be1 , and so exhibits identical outflowing power, in order to actually satisfy the source-free equation, it must have an equal magnitude of\npower flowing into the interaction region through any upstream plane at \u03be < \u03be0 , which accounts for the\nextra factor of two.\n\nE.\n\nBasis-Set Approximation\n\nAs we have seen, equation (76) in principle gives the exact solution to the paraxial wave equation with\nprescribed sources, without any further approximations, and is compatible with energy conservation for\nparaxial electromagnetic fields. For given sources, the field at an arbitrary longitudinal plane \u03be can\nbe determined via a convolution integral over the longitudinal source position \u03be \u2032 and a two-dimensional\nintegral over either the transverse position-dependence (real space) or transverse wavevector-dependence\n(reciprocal space) of the solenoidal component of the current. In position space, we have\n|\u03c8(\u03be; \u03c9)i =\n\nXZ\n\n2\n\nd r\n\ns\n\nZ\n\nmin(\u03be,\u03be\nZ 1)\n\n2 \u2032\n\nd r\n\n\u03be0\n\ni\n\nk|r\u2212r \u2032 |2\n\nk e 2(\u03be\u2212\u03be\u2032 )\nd\u03be\nhr \u2032 ; s|f (\u03be \u2032 ; \u03c9)i |r; si ,\n2\u03c0i(\u03be \u2212 \u03be \u2032 )\n\u2032\n\n(92)\n\nwhere we have used the well-known result for the two-dimensional, position-space, free-particle propagator in quantum mechanics. In momentum space representation, the propagator is diagonal, and we\nhave\n|\u03c8(\u03be; \u03c9)i = i\n\nXZ\ns\n\n2\n\nmin(\u03be,\u03be\nZ 1)\n\n2\n\u2032 |p|\n2k\n\nd\u03be \u2032 e\u2212i(\u03be\u2212\u03be )\n\nd p\n\nhp; s|f (\u03be \u2032 ; \u03c9)i |p; si ,\n\n(93)\n\n\u03be0\n\nwhere hp; s|f (\u03be \u2032 ; \u03c9)i is just the Fourier transform (with respect to the scaled transverse wavevector) of the\nsolenoidal current density slice at longitudinal position \u03be \u2032 . Now, using either either of these approaches,\nwe require something like 10 integrations to determine a given frequency component of the field at a given\nspatial location, starting from the full current density as a function of space and time coordinates. In\npractice, we often only know the source probabilistically, so we will typically have to perform additional\naverages over the particle distribution function, involving up to 6 more integrations over the full particle\nphase space.\nA complementary approach is to decompose the paraxial radiation fields into a complete, orthogonal\nset of modes. Because we are actually only interested in the radiation observed beyond the region of\ninteraction with the localized sources, these modes are naturally chosen to satisfy the homogeneous\n(source-free) paraxial wave equation for all longitudinal positions \u03be > \u03be1 , but we may then also choose\nthese modes to be extrapolated free-space solutions everywhere, including within the support of the\nsources. That is, we consider a countable set of explicitly \u03be-dependent, solenoidal, envelope modes\n|un (\u03be; \u03c9)i \u2208 H\u22a5 , where n denotes some set of integral transverse-spatial and polarization modal indices,\nsuch that each mode envelope satisfies\n\u2202\ni \u2202\u03be\n|un (\u03be; \u03c9)i = H(\u03c9) |un (\u03be; \u03c9)i ,\n\n(94)\n\n\f17\nor equivalently\n|un (\u03be; \u03c9)i = U (\u03be, \u03be \u2032 ; \u03c9) |un (\u03be \u2032 ; \u03c9)i\n\n(95)\n\ntogether with the gauge constraint (58a), for all longitudinal positions \u2212\u221e < \u03be < \u221e. Because free-space\npropagation is unitary, these modes may be chosen to be orthonormal in each transverse plane, i.e.,\nhun (\u03be; \u03c9)|un\u2032 (\u03be; \u03c9)i = \u03b4n n\u2032\nand complete in each transverse plane, in the sense that\n\u0002\n\u0003\nspan |un (\u03be; \u03c9)i \u223c\n= H\u22a5 .\n\n(96)\n\n(97)\n\nor equivalently\n\nX\nn\n\n|un (\u03be; \u03c9) ih un (\u03be; \u03c9)| = I\u22a5 ,\n\n(98)\n\nwhere I\u22a5 is the identity operator restricted to the solenoidal sub-space H\u22a5 , or equivalently the Hermitian projection from H into H\u22a5 . Familiar and convenient choices are the usual free-space Gauss-Hermite\nmodes or Gauss-Laguerre modes in paraxial optics. The spatial profiles of these modes may be characterized by specifying the longitudinal location of the focal plane and the eigenvalues of certain Hermitian\noperators of which they are eigenfunctions in that plane. For example, in the focal plane, the components\nof the Gauss-Hermite modes are simultaneous number states of two harmonic oscillator Hamiltonians\n(one for each transverse Cartesian coordinate), while the Gauss-Laguerre modes are simultaneous eigenstates of a radial harmonic oscillator Hamiltonian and the longitudinal component of orbital angular\nmomentum [32, 33]. Modes with slightly off-axis propagation directions can be defined in terms of\nthe coherent states associated with these quadratic Hamiltonians, and many other generalizations are\npossible to suit particular problems.\nAny linear combinations of the un modes satisfy the homogeneous paraxial wave equation, so cannot\npossibly represent the fields in the region actually containing the sources, but they can exactly reproduce\nany fields in the \"downstream\" vacuum region beyond the sources, and then be extrapolated upstream.\nThat is, for all \u03be > \u03be1 , the actual radiation envelope |\u03c8(\u03be; \u03c9)i satisfies the homogeneous wave equation,\nlies entirely in the solenoidal sub-space H\u22a5 , and may be decomposed as\n\u0014X\n\u0015\n|\u03c8(\u03be; \u03c9)i =\n|un (\u03be; \u03c9) ih un (\u03be; \u03c9)| |\u03c8(\u03be; \u03c9)i\nn\n\n=\n\nX\nn\n\n(99)\n\nhun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i |un (\u03be; \u03c9)i ,\n\nand both the modulus and argument of the complex expansion coefficients appearing in the sum have a\nsimple interpretation. Using the orthonormality of the modes, the normalized power spectral density at\na given transverse plane \u03be > \u03be1 is given by\nX\n2\n2\n2\n\u2202\n|hun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i| ;\n(100)\n\u2202\u03c9 PEM [a](\u03be; \u03c9) = \u03c9 h\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = \u03c9\nn\n\nand, individually, each\n\u2202\n\u2202\u03c9 P\u0303EM [un ](\u03be; \u03c9)\n\n\u2261 \u03c9 2 |hun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i|2 \u2265 0\n\nprovides the normalized power-spectral-density contribution from the nth mode, while\n\u0002\n\u0003\n\u03b8n (\u03be; \u03c9) = arg hun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i\n\n(101)\n\n(102)\n\ndetermines the slowly-varying envelope phase (i.e., phase apart from the fast k\u03be \u2212 \u03c9\u03c4 dependence) of\n\u2202\n\u2202\nthe the nth mode. From unitarity, it follows that \u2202\u03c9\nPEM [un ](\u03be; \u03c9), \u03b8n (\u03be; \u03c9) and \u2202\u03c9\nPEM [a](\u03be; \u03c9) =\nP \u2202\n\u2202\u03c9 P\u0303EM [un ](\u03be; \u03c9) are all independent of \u03be for any \u03be > \u03be1 . With perhaps a slight abuse of notation,\nn\n\nwe have used\n\n\u2202\n\u2202\u03c9 P\u0303EM [un ]\n\nwith a tilde to denote the scaled power (spectral density) contribution from\n\n\f18\nthe nth normalized mode i.e., the power spectral density associated through Poynting's theorem with\n\u2202\nthe ket hun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i |un (\u03be; \u03c9)i , and not the power spectral density \u2202\u03c9\nPEM [un ] literally associated\n2\nwith the ket |un (\u03be; \u03c9)i , which is fixed at the value \u03c9 by our normalization conventions.\nIn general, a countably infinite number of orthogonal modes are required to exactly describe the radiation\nfields, but if the modes are chosen appropriately, a finite basis set BN of size N, 1 \u2264 N < \u221e, such that\nattention is confined to n \u2208 BN , may provide a sufficiently accurate representation. For example, if the\nmode shape is approximately Gaussian in cross section, then it should be accurately represented by the\nfundamental and perhaps a few higher-order Gauss-Hermite modes, with proper choice of the waist size\nand location. Formally, the expansion coefficients may be determined by again using the Green function\nsolution (76), taking advantage of the finite support of |f (\u03c9)i . In a derivation exactly analogous to that\nin the previous section, we find that for any \u03be > \u03be1 ,\nmin(\u03be,\u03be\nZ 1)\n\nd\u03be \u2032 hun (\u03be; \u03c9) |U (\u03be, \u03be \u2032 ; \u03c9)| f (\u03be \u2032 ; \u03c9)i\n\nhun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = i\n\n\u03be0\nZ\u221e\n\n=i\n\n\u2212\u221e\n\n=i\n\nZ\n\nd\u03be \u2032 hun (\u03be \u2032 ; \u03c9)|f (\u03be \u2032 ; \u03c9)i\n\n(103)\n\nZ\nd\u03be \u2032 d2 r un (r; \u03be \u2032 ; \u03c9)\u2217 * f (r; \u03be \u2032 ; \u03c9),\n\nwhich apart from an overall constant is just a three-dimensional inner product, or overlap integral,\nbetween the solenoidal source envelope f (r; \u03be \u2032 ; \u03c9) and the free-space mode envelope un (r; \u03be \u2032 ; \u03c9). Equivalently, we can write this as the overlap integral between the full current density j(r; \u03be \u2032 ; \u03c9), and the\nnormalized electric field \u03b5n \u22a5 (\u03be \u2032 ; \u03c9) = i\u03c9 un (r; \u03be \u2032 ; \u03c9) associated with the nth mode:\nZ\nZ\nhun (\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i = \u2212 2\u03c91 2\nd\u03be \u2032 d2 r \u03b5n \u22a5 (r; \u03be; \u03c9)\u2217 * j(r; \u03be; \u03c9)\nZ\n(104)\n\u2032\n\u2032\n\u2032\n1\nd\u03be h\u03b5n \u22a5 (\u03be ; \u03c9)|j(\u03be ; \u03c9)i .\n= \u2212 2\u03c92\nSo, again, we do not need to explicitly decompose the current density into its solenoidal and irrotational\ncomponents in order to calculate these expansion coefficents. The factor of 12 is analogous to that\nappearing in (87), and in fact (104) reduces to the full energy conservation result if we are lucky enough\nto choose a basis which contains the extrapolated solution \u03c7(r; \u03be; \u03c9) in its span. More generally, it is\nclear that the finite-basis set approximation\u0002 is just the\u0003orthogonal projection of the actual extrapolated\nfree-space solution into the subspace span |un (\u03be; \u03c9)i spanned by the modes in BN :\nn\u2208BN\n\n|\u03bd(\u03be; \u03c9; BN )i =\n\nX\n\nn\u2208BN\n\n|un (\u03be; \u03c9) ih un (\u03be; \u03c9)| |\u03c7(\u03be; \u03c9)i .\n\n(105)\n\nFrom linearity, it immediately follows P\nthat if |\u03bdm (\u03be; \u03c9)i is the basis-set approximation\nto |\u03c7m (\u03be; \u03c9)i\nP\nresulting form a source |fm (\u03be; \u03c9)i then\ncm (\u03c9) |\u03bdm (\u03be; \u03c9)i is the approximation to\ncm (\u03c9) |\u03c7m (\u03be; \u03c9)i\nm\nP m\nresulting from the source envelope\ncm (\u03c9) |fm (\u03be; \u03c9)i , where the cm (\u03c9) \u2208 C are arbitrary coefficients.\nm\n\nSo we may also determine the basis set approximation for any source by first finding the basis set\napproximation for the impulse source |r; si and then performing a convolution over the actual source.\nThat is, we can\n\u0002 use as an\u0003 approximate propagator, the restriction of the full Green operator to the\nsubspace span |un (\u03be; \u03c9)i :\nn\u2208BN\n\n|\u03bd(\u03be; \u03c9; BN )i = i\n\nZ\u03be1\n\n\u03be0\n\nd\u03be \u2032\n\nX\n\nn\u2208BN\n\n|un (\u03be; \u03c9) ih un (\u03be \u2032 ; \u03c9)| |f (\u03be \u2032 ; \u03c9)i ,\n\nwhich clearly agrees with previous results after exchanging the order of the integral and sum.\n\n(106)\n\n\f19\nIt follows from the properties of orthogonal projections in Hilbert space that the projected basis-set\napproximation is also uniquely determined by the following constrained minimum-distance criteria:\nh\ni\n(107a)\n|\u03bd(\u03be; \u03c9; BN )i = arg min k |\u03bd(\u03be; \u03c9)i \u2212 |\u03c7(\u03be; \u03c9)i k\n\u03bd\nh\ni\n(107b)\ns.t. |\u03bd(\u03be; \u03c9)i \u2208 span |un (\u03be; \u03c9)i .\nn\u2208BN\n\nThe estimated radiated power (spectral density) is then always a lower bound on the actual power\n(spectral density) in any plane \u03be > \u03be1 :\nX\n\u2202\n\u2202\n\u2202\n\u2202\n(108)\n\u2202\u03c9 PEM [\u03bd](\u03be; \u03c9; BN ) =\n\u2202\u03c9 P\u0303EM [un ](\u03be; \u03c9) \u2264 \u2202\u03c9 PEM [\u03c7](\u03be; \u03c9) = \u2202\u03c9 PEM [a](\u03be; \u03c9),\nn\u2208BN\n\nwith equality if and only if \u03bd(r; \u03be; \u03c9; BN ) = \u03c7(r; \u03be; \u03c9). In fact, it is straightforward to establish that,\nat the constrained optimum (107), the squared-distance between the basis-set approximation and the\nactual extrapolated fields is just proportional to their difference in power spectral density:\n\u03c9 2 k |\u03bd(\u03be; \u03c9; BN )i \u2212 |\u03c7(\u03be; \u03c9)ik2 =\nF.\n\n\u2202\n\u2202\u03c9 PEM [\u03c7](\u03be; \u03c9)\n\n\u2212\n\n\u2202\n\u2202\u03c9 PEM [\u03bd](\u03be; \u03c9; BN )\n\n\u2265 0.\n\n(109)\n\nVariational Approximation\n\nSuch connections revealed in the basis-set approach between the orthogonal projection, minimum distance, maximum radiated power, minimal negative mechanical work, and maximal source/field overlap\nsuggest that an approximate field profile for the radiation and a lower bound on the radiated power\nmay be obtained directly through a general variational principle. Consider a parameterized family of\ntrial envelope modes v(r; \u03be; \u03c9; \u03b1) depending on some set of adjustable parameters denoted by the vector\n\u03b1, where, for any fixed choice of allowed parameter values, we assume the the trial mode satisfies the\nfree-space wave equation, is solenoidal, and is normalized in any transverse plane. In principle, the trail\nmode can be written formally as a linear combination of the above basis modes:\nX\n|v(\u03be; \u03c9; \u03b1)i =\ncn (\u03c9; \u03b1) |un (\u03be; \u03c9)i\n(110)\nn\n\nfor some complex expansion coefficients cn = cn (\u03c9; \u03b1) \u2208 C which satisfy the constraint\nX\n2\n|cn (\u03c9; \u03b1)| = 1,\n\n(111)\n\nn\n\nso that\nhv(\u03be; \u03c9; \u03b1)|v(\u03be; \u03c9; \u03b1)i = 1,\n\n(112)\n\nbut are otherwise arbitrary. Note that the expansion coefficients are here assumed independent of \u03be, but\nmay in general depend on the adjustable parameters in some complicated, and perhaps nonlinear fashion.\n(More generally, we could allow dependence on \u03be in the cn , leading to a variational problem involving\nthe solution of a set of coupled ODEs rather than miniization of a function. This extra generalization is\nnot really needed for the case of spontaneous radiation.) Using the Cauchy-Schwarz inequality, we have,\nfor any \u03be,\n2\n\n|hv(\u03be; \u03c9; \u03b1)|\u03c8(\u03be; \u03c9)i| \u2264 hv(\u03be; \u03c9; \u03b1)|v(\u03be; \u03c9; \u03b1)i h\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i ,\n\n(113)\n\nwhich using (112) simplifies to\n\nor equivalently\n\n\u0001\n2\n\u03c9 2 |hv(\u03be; \u03c9; \u03b1)|\u03c8(\u03be; \u03c9)i| \u2264 \u03c9 2 h\u03c8(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i ,\n\u2202\n\u2202\u03c9 P\u0303EM [v](\u03be; \u03c9; \u03b1)\n\n\u2264\n\n\u2202\n\u2202\u03c9 PEM [a](\u03be; \u03c9),\n\n(114)\n\n(115)\n\n\f20\nwith strict equality if and only if v(r; \u03be; \u03c9; \u03b1) exactly mirrors the shape and polarization of the actual\nparaxial solution \u03c8(r; \u03be; \u03c9) in the plane \u03be, up to some overall phase; i.e.,\n\u0001\u22121/2\n|\u03c8(\u03be; \u03c9)i\n(116)\n|v(\u03be; \u03c9; \u03b1)i = ei\u03b8v (\u03c9;\u03b1) hv(\u03be; \u03c9)|\u03c8(\u03be; \u03c9)i\n\nfor some real angle \u03b8v (\u03c9; \u03b1).\n\nWe have indeed arrived at a variational principle for the paraxial radiation, where we may approximate\nboth the relative spatial/polarization profile and overall amplitude of the radiation fields by maximizing\nthe power-spectral density in a normalized trial mode v(\u03be; \u03c9; \u03b1) measured in some post-source plane\n\u03be > \u03be1 , as a function of the variational parameters \u03b1 determining the trial mode's shape and polarization.\nThat is, we take as the approximate radiation envelope\n\u0001\n|\u03bd(\u03be; \u03c9; \u03b1\u0303)i = hv(\u03be; \u03c9; \u03b1\u0303)|\u03c8(\u03be; \u03c9)i |v(\u03be; \u03c9; \u03b1\u0303)i ,\n(117)\n\nwhere the optimal parameter vector \u03b1\u0303 = \u03b1\u0303[j](\u03c9) is chosen so as to maximize\n\u2202\n\u2202\u03c9 PEM [\u03bd](\u03be; \u03c9; \u03b1)\n\n=\n\n\u2202\n\u2202\u03c9 P\u0303EM [v](\u03be; \u03c9; \u03b1)\n\n2\n\n= \u03c9 2 |hv(\u03be; \u03c9; \u03b1)|\u03c8(\u03be; \u03c9)i| .\n\n(118)\n\nThe optimized mode shape is then the best guess, within the manifold of possibilities allowed by the\nshapes parameterized by \u03b1, of the actual paraxial field profile beyond the sources, and the squared-norm\nyields a lower bound on the actual paraxial power spectral density of the radiation at the frequency under\nconsideration.\nHowever, as written, this variational principle appears vacuous at best, since if we knew the actual\n\u03c8(r; \u03be; \u03c9) so as to be able to calculate its overlap with the trial field v(r; \u03be; \u03c9; \u03b1), there would of course\nbe no need for a variational approximation in the first place. But from (104), we may also write\nZ\nZ\n\u2032\n1\nhv(\u03be; \u03c9; \u03b1)|\u03c8(\u03be; \u03c9)i = \u2212 2\u03c92\nd\u03be d2 r \u03b5v \u22a5 (r; \u03be; \u03c9; \u03b1)\u2217 * j(r; \u03be; \u03c9)\n=\n\n\u2212 2\u03c91 2\n\nZ\u03be1\n\n(119)\n\nd\u03be \u2032 h\u03b5v \u22a5 (\u03be \u2032 ; \u03c9; \u03b1)|j(\u03be \u2032 ; \u03c9)i\n\n\u03be0\n\nwhere \u03b5v \u22a5 (r; \u03be; \u03c9; \u03b1) = i\u03c9 v(r; \u03be; \u03c9; \u03b1)eik\u03be is the normalized solenoidal frequency-domain electric field\nassociated with the unit-norm trial vector potential envelope v(r; \u03be; \u03c9; \u03b1). In terms of the trial envelope\n\u03bd(r; \u03be; \u03c9; \u03b1\u0303), we see that\n\u2202\n\u2202\u03c9 P\u03bd (\u03be; \u03c9; \u03b1)\n\n2\n\n= \u03c9 2 |hv(\u03be; \u03c9; \u03b1)|\u03c8(\u03be; \u03c9; \u03b1)i| = \u03c9 2 h\u03bd(\u03be; \u03c9; \u03b1)|\u03bd(\u03be; \u03c9; \u03b1)i\nZ\n= \u2212 21 d\u03be \u2032 h\u03b5\u03bd \u22a5 (\u03be \u2032 ; \u03c9; \u03b1)|j(\u03be \u2032 ; \u03c9)i ,\n\n(120)\n\nwhere \u03b5\u03bd \u22a5 (r; \u03c9; \u03b1) = i\u03c9 \u03bd(\u03be; \u03c9; \u03b1) is the solenoidal electric field associated with the unnormalized trial\nenvelope . Because the left-hand side is purely real and non-negative, the right hand side must already\nbe so as well, so in fact:\n\u0014Z\n\u0015\n\u2032\n\u2032\n\u2032\n1\n\u2202\nd\u03be h\u03b5\u03bd \u22a5 (\u03be ; \u03c9; \u03b1)|j(\u03be ; \u03c9)i\n\u2202\u03c9 P\u03bd (\u03be; \u03c9; \u03b1) = \u2212 2 Re\n(121)\n\u2202\nPmech [\u03b5\u03bd \u22a5 ; j](\u03c9; \u03b1).\n= \u2212 12 \u2202\u03c9\nFrom the inequality (115) and the energy-conservation result (87) we arrive at an alternative formulation\nof the variational principle:\n\u2202\n\u2202\u03c9 P\u03bd (\u03be; \u03c9; \u03b1)\n\n\u2264\n\n\u2264\n\n=\n\n\u2202\n1 \u2202\n\u2202\u03c9 P\u03bd (\u03be; \u03c9; \u03b1\u0303) = \u2212 2 \u2202\u03c9 Pmech [\u03b5\u03bd \u22a5 ; j](\u03c9; \u03b1)\n\u2202\n\u2202\n\u2202\u03c9 Pa (\u03be; \u03c9) = \u2212 \u2202\u03c9 Pmech [\u03b5a \u22a5 ; j](\u03c9)\n\n(122)\n\n\u2202\n\u2212 12 \u2202\u03c9\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9).\n\nIn addition, since\n2\n\nh\u03bd(\u03be; \u03c9; \u03b1)|\u03bd(\u03be; \u03c9; \u03b1)i = |hv(\u03be; \u03c9; \u03b1)|\u03c7(\u03be; \u03c9)i| = h\u03bd(\u03be; \u03c9; \u03b1)|\u03c7(\u03be; \u03c9)i ,\n\n(123)\n\n\f21\nfor all \u03be, it follows that the unnormalized trial envelope \u03bd(r; \u03be; \u03c9; \u03b1\u0303) (i.e., with the absolute amplitude\nincluded as an adjustable parameter) also minimizes the Hilbert-space distance between the trial solution\nand the actual extrapolated paraxial solution in any transverse plane \u03be :\nk |\u03bd(\u03be; \u03c9; \u03b1) i \u2212 |\u03c7(\u03be; \u03c9)ik \u2265 k |\u03bd(\u03be; \u03c9; \u03b1\u0303)i \u2212 |\u03c7(\u03be; \u03c9)i k\n\u0002\u2202\n\u0003\n\u2202\n= \u03c9 \u22122 \u2202\u03c9\nP\u03c7 (\u03be; \u03c9) \u2212 \u2202\u03c9\nP\u03bd (\u03be; \u03c9; \u03b1\u0303) \u2265 0.\n\n(124)\n\nThe results (122) and (124) are obviously closely related to the results (108) and (107) derived in the\nbasis-set expansion, which first led us to the variational formulation. Equivalently, we can express our\nvariational principle most succinctly in terms of the unnormalized (amplitude-included) trial wavefield\nwhich solves a constrained power-maximization problem for all parameters \u03b1 defining the trial-solution\n\u03bd(r; \u03be; \u03c9; \u03b1\u0303):\n\u0002\u2202\n\u0003\nP\u03bd (\u03be; \u03c9; \u03b1)\n(125a)\n\u03b1\u0303 = arg max \u2202\u03c9\n\u03b1\n\ns.t.\n\n\u2202\n\u2202\u03c9 P\u03bd (\u03be; \u03c9; \u03b1)\n\n\u2202\n= \u2212 12 \u2202\u03c9\nPmech [\u03b5\u03bd \u22a5 ; j](\u03c9; \u03b1).\n\n(125b)\n\nThese several equivalent formulations of the maximum-power variational principle (MPVP) are intuitively appealing, perhaps so much so that they might be guessed immediately, without the entire\nbuild-up of mathematical machinery. The variational approximation, which maximizes the resemblance\n(in the Hilbert-space metric), within the considered family of possibilities, to the actual paraxial field\nin the post-source region, or equivalently, to the extrapolated source-freeR paraxial field everywhere in\nspace, can be obtained by maximizing the source/field spatial overlap\nd\u03be \u2032 h\u03b5v \u22a5 (\u03be \u2032 ; \u03c9; \u03b1)|j(\u03be \u2032 ; \u03c9)i ,\ni.e., the magnitude of the three-dimensional inner product between the normalized source-free trial field\nand the actual current density. That is to say, our best approximation to the free-space radiation fields\nbeyond the sources is found by maximizing the physical resemblance of these fields, when extrapolated\nbackward into the region of the sources assuming free-space propagation, to the profile of the sources.\nEquivalently, we can say the optimal profile is that which, if it actually were to be incident on the sources,\nwould experience the maximal small-signal gain (i.e., neglecting saturation effects or indeed any backaction on the sources), due to energy absorbed from those sources, and in this case the virtual \"gross\"\npower gain (i.e., due to stimulated emission, but neglecting the stimulated absorption) is numerically\nproportional to the estimated spectral density of spontaneously-radiated power. This approximation also\noptimizes the total radiated power spectral density in the full variational radiation envelope \u03bd(r; \u03be; \u03c9; \u03b1),\nconsistent with the constraint, arising from energy-conservation, that this power could have arisen from\nwork done by the sources, with appropriate compensation (i.e., scaling by 12 ) for the fact that we have\nreplaced the inhomogeneous fields with their homogeneous extrapolation in the region of these sources.\nNote that this variational principle is reminiscent of the Rayleigh-Ritz variational principle familiar from\nordinary quantum mechanics, but despite the analogies between paraxial radiation propagation and nonrelativistic quantum mechanics, these variational principles are actually distinct. In quantum mechanics, \"the\" Rayleigh-Ritz method is applicable to approximating the low-lying energy eigenvalues and\ncorresponding stationary states of the homogeneous, time-independent Schrodinger equation, whereas\nthe present variational principle is associated with solutions to the inhomogeneous, time-dependent\nSchrodinger equation.\nHowever, the MPVP does share with the quantum-mechanical Raleigh-Ritz technique many of the same\nfeatures and limitations common to variational approximations and optimization problems. Because we\nare determining a stationary point (in fact, a maximum) of a power (spectral density) functional, the\nactual value obtained for the power spectrum at the extremum is relatively insensitive to the precise\nshape of the trial field \u2013 generally, if the characteristic relative error in the latter is O(\u01eb) in some sense,\nthen the relative error in the former is O(\u01eb2 ), because the first-order variations vanish. In order to\nestimate the power to say 1%, we need only match the variational parameters describing the field shape\nto about 10%. This is, of course, great news if we are actually most interested in estimating the power,\nbut, conversely, much less satisfying if we are interested in determining, say, the spot size w0 , or some\ncharacterization of the the angular spectrum. This is analogous to the situation in quantum mechanics,\nwhere it is well known that the Raleigh-Ritz approximation estimates the ground-state energy eigenvalue\nmore accurately than its corresponding wavefunction.\nThe variational approximation for the field profile is expected to be accurate to the extent that the\ntrial mode can overlap, or mimic, the actual mode in any transverse plane \u03be > \u03be1 in the free-space\n\n\f22\nregion beyond the sources, and obviously the approximation is expected to improve as the number of\nfunctionally-independent shape parameters is increased. Since \u03bd(\u03be; \u03c9; \u03b1\u0303) satisfies the free-space equation,\nit is actually an approximation throughout all \u03be to the extrapolated envelope \u03c7(r; \u03be; \u03c9). The corresponding power yields a lower bound for the actual power radiated, but in the absence of an upper bound, one\ndoes not have any foolproof means to estimate the closeness of this approximated to actual power. We\ncan consider a so-called \"minimizing\" sequence of variational problems where at each stage we expand\nthe parametric family of trial envelopes to include additional possible details of the field profiles which\nwe anticipate might be present in the actual radiation but which could not be captured in the previous\ntrial fields. If the extended family continues to include as a possibility the previous variational solution,\nthen the estimated power monotonically approaches the actual (unknown) power from below, and the\nHilbert-space distance between the trial envelope and the actual (unknown) envelope in any post-source\nplane monotonically approaches zero from above. In practice, we can stop when the difference (in power\nor Hilbert-space distance) upon adding finer details to the trial envelope becomes sufficiently small, or\nelse when we have expended as much computational effort as we can spare. From above, we know that\nan additional\nparameter leading to an O(\u01eb) relative increase in the power is expected to produce only\n\u221a\nan O( \u01eb) relative improvement in the local field profile.\nAlthough we formally expressed the normalized ket |v(\u03be; \u03c9; \u03b1)i as a sum over the orthonormal modes\n|un (\u03be; \u03c9; \u03b1)i , we stress that the variational envelope can be explicitly written in any arbitrary form, with\nadjustable parameters which appear linearly or non-linearly, as long as it satisfies the homogeneous wave\nequation, gauge constraint, and normalization constraint. If the parameters \u03b1 represent the expansion\ncoefficients in some finite linear sum of orthonormal modes, which is the assumption of the classic\nRaleigh-Ritz and Ritz-Galerkin techniques in the calculus of variations, then the variational approach\nformally reduces to the basis-set approach, but it is often more convenient or efficient in practice to use\nan explicitly nonlinear family of trial solutions where the variational parameters do not appear linearly.\nFor example, one might use a Gaussian beam with indeterminate waist size and location, as discussed in\nthe introduction, or perhaps even additional parameters to include skew or eccentricity or higher-order\nstructure in the spot profile.\n\nIV.\n\nNON-PARAXIAL GENERALIZATION\n\nWhen translated from the quantum mechanical into conventional notation, none of the energy-balance\nand variational results derived above in the paraxial limit depend in any essential way on the assumed\nparaxial nature of the fields. This suggests that analogous results should hold more generally, beyond\nthe paraxial approximation, for any radiation emitted spontaneously by charges moving along prescribed\ntrajectories. The essential features which emerged in the paraxial case, which we now abstract to more\ngeneral problems, are: approximation of the actual radiation fields arising from the sources by homogeneous (i.e., free-space, or source-free) fields; a variational principle, derived from the Cauchy-Schwarz\ninequality in a Hilbert space picture, mandating the maximization of (only) outgoing power spectral density; energy exchange between fields and charges which can be characterized as the three-dimensional\ninner product, or overlap integral, between the extrapolated, solenoidal electric field and either the full or\nsolenoidal current density, as convenient; and, finally, a functional relationship between the mechanical\nwork performed on/by the charges by/on the extrapolated fields within a region and the radiation flux\nthrough a boundary surface, arising, physically, from energy conservation, and, mathematically, either\nexplicitly from the formal solution or else from some form of the the Fundamental Theorem of Calculus\n(e.g., Gauss's theorem or Green's Identities in multiple dimensions.)\n\nA.\n\nVector Spherical Harmonics and the Spherical Wave Basis\n\nIn order to generalize our results to the non-paraxial case, we first introduce a bit more mathematical\nnotation and machinery. We use the scaled spatial position \u03b6, and introduce spherical coordinates: the\nscaled radius \u03b6 = k\u03b6k \u2265 0, the polar angle \u03b8, and the azimuthal angle \u03c6, so that \u03b6 = \u03b6 \u03b6\u0302 = \u03b6 x\u0302. We let R\ndenote any (closed) spatial region in R3 , and \u2202R will denote its boundary. For any position \u03b60 and any\nnonnegative \u03b6 \u2032 \u2265 0, we define the closed ball of radius \u03b6 \u2032 centered at \u03b60 as B(\u03b6 \u2032 ; \u03b60 ) \u2261 {\u03b6 | k\u03b6 \u2212 \u03b60 k \u2264 \u03b6 \u2032 } ,\n\n\f23\nand we will take V (\u03b6 \u2032 ; \u03b60 ) \u2282 R3 to denote a closed, simply-connected region satisfying B(\u03b6 \u2032 ; \u03b60 ) \u2286\nV (\u03b6 \u2032 ; \u03b60 ). For simplicity, whenever the central position coincides with the origin (\u03b60 = 0), the dependence\nwill be suppressed in the notation; i.e., B(\u03b6 \u2032 ) \u2261 B(\u03b6 \u2032 ; 0) and V (\u03b6 \u2032 ) = V (\u03b6 \u2032 ; 0).\nAs in the paraxial case, we take the (scaled, frequency-domain) current density j(\u03b6; \u03c9), assumed known, is\nto be localized in space, vanishing identically outside some finite-radius ball B(\u03b61\u2032 ), for some 0 < \u03b61\u2032 < \u221e.\nAgain, the solenoidal component j\u22a5 (\u03b6; \u03c9) will therefore not have have compact support in general, but\nbecause of the rapid falloff of its spatial dependence (O(\u03b6 \u22122 ) as \u03b6 \u2192 \u221e), we may, with arbitrary small\nerror in the calculated radiation fields, neglect it beyond some sufficiently large but finite radius \u03b61 \u2265 \u03b61\u2032 .\n(Again, at the end of the calculation, we could attempt to take this support to be infinite, provided that\nthe full current density continues to fall off sufficiently rapidly to ensure convergence of the integrals,\nand to enable somehow the unambiguous characterization of the \"far-zone\" versus non-radiative fields,\nwhen the latter extend to infinity.)\nIt will prove very convenient to have some explicit basis in which to decompose the vector potential.\nThe plane-wave (spatial-Fourier) basis immediately comes to mind, but certain cumbersome singularities\ninevitably arise in this representation. Namely, whenever the vacuum dispersion relation is satisfied, i.e.,\nkkk = \u03c9, solutions to the homogeneous Helmholtz equation possess delta-function singularities, while\nsolutions to the inhomogeneous solution exhibit second-order divergences whenever the corresponding\nFourier components j\u22a5 (k, \u03c9) 6= 0. In order to avoid such difficulties, we will instead use the spherical\nwave basis [5, 35, 36]. The conventional vector spherical harmonics are defined as\n1\nLYl m (\u03b8, \u03c6),\nl(l+1)\n\nXl m = Xl m (\u03b6\u0302) = Xl m (\u03b8, \u03c6) = \u221a\n\n(126)\n\nwhere, in analogy to quantum mechanics, we have defined the Hermitian (scaled) orbital angular momentum operator as\n\u0001\nL \u2261 Q3D \u00d7 P3D \u2261 \u03b6 \u00d7 1i \u2202 = \u2212i (\u03b6 \u00d7 \u2202) ,\n(127)\n\nwhich acts only on the angular degrees of freedom (i.e., not on the radial or the polarization degrees-offreedom),\n\u0010\n\u0010\n\u0011\n\u0011\n\u2202\n\u2202\n\u2202\n\u2202\n\u2202\nL = \u221a12 \u00ea+ e\u2212i\u03c6 \u2212 \u2202\u03b8\n+ i cot(\u03b8) \u2202\u03c6\n+ i cot(\u03b8) \u2202\u03c6\n;\n(128)\n+ \u221a12 \u00ea\u2212 e+i\u03c6 + \u2202\u03b8\n\u2212 i\u1e91 \u2202\u03c6\n\nand the functions Yl m (\u03b8, \u03c6) denote the usual scalar spherical harmonics for nonnegative integers l =\n0, 1, 2, . . . , and integer m = \u2212l, \u2212l + 1, . . . , 0, . . . , l \u2212 1, l. In addition, we define two other related sets\nof basis vector fields:\nZl m = Zl m (\u03b6\u0302) = Zl m (\u03b8, \u03c6) = \u03b6\u0302 \u00d7 Xl m ,\n\n(129)\n\nNl m = Nl m (\u03b6\u0302) = Nl m (\u03b8, \u03c6) = \u03b6\u0302 Yl m .\n\n(130)\n\nand\n\n(By definition, we take X0 0 = Z0 0 \u2261 0 identically, ultimately reflecting the fact that sphericallysymmetric solutions to the free-space Maxwell equations can exist only in the non-radiative \u03c9 \u2192 0\nlimit.)\nThe orbital angular momentum operator L effects infinitesimal (inverse) rotations of the spatial degrees\nof freedom, i.e., observation position or field point, and satisfies the useful identities:\n\u03b6\u0302 * L = 0,\nL \u00d7 L = iL,\n\u0002 2 \u0003\nL , L = 0,\n\u0002 2\n\u0003\nP3D , L = 0,\n\n2\n\n2\n\u2202\nL2 = r \u2202r\n) + r2 P3D\n.\n2 (r\n\n(131a)\n(131b)\n(131c)\n(131d)\n(131e)\n\nThe scalar spherical harmonics themselves may be interpreted as simultaneous eigenstates of L2 and Lz .\nEach of the basis vector fields may then be interpreted as a simultaneous eigenstate of J 2 = Jx2 + Jy2 + Jz2\n\n\f24\nand Jz for some spin-one object, where J = L + S is the total (spatial plus spin/polarization) angular\nmomentum operator. For fixed l and fixed W = X, Z, or N , the members Wl m (\u03b8, \u03c6) of each of these\nthree families therefore transform amongst themselves under total spatial rotations (of both spatial and\npolarization degrees of freedom). The spin angular momentum operator S generates rotations of the\npolarization vector, and in the Cartesian basis, S = x\u0302S1 + \u0177S2 + \u1e91S3 may be defined as a vector of 3 \u00d7 3\nHermitian matrices Sj for j = 1, 2, 3, whose components are given by\n(Sj )kn = \u2212i\u01ebjkn ,\n\n(132)\n\nwhere \u01ebjkn is the completely antisymmetric Levi-Civita tensor in three dimensions. From this definition\none can prove the useful operator identity\n\u2202\u00d7 \u2261 P3D * S.\n\n(133)\n\nUsing various vector identities, these spherical vector harmonic basis fields also can be shown to satisfy:\np\nL *Xl m = l(l + 1)Yl m ,\nL * Zl m = 0,\nL * Nl m = 0;\n\n(134a)\n(134b)\n(134c)\n\nL \u00d7Xl m = iXl m ,\np\nL \u00d7 Zl m = l(l + 1)Nl m ,\nL \u00d7 Nl m = 0;\n\n(135a)\n\nand\n\n(135b)\n(135c)\n\nas well as\n\u03b6\u0302 *Xl m = 0,\n\n\u03b6\u0302 * Zl m = 0,\n\n\u03b6\u0302 * Nl m = Yl m ;\n\n(136a)\n(136b)\n(136c)\n\nand\n\u03b6\u0302 \u00d7Xl m =\n\nZl m ,\n\n(137a)\n\n\u03b6\u0302 \u00d7 Zl m = \u2212Xl m ,\n\n(137b)\n\n\u03b6\u0302 \u00d7 Nl m =\n\n0;\n\n(137c)\n\nand also\n\u2202 *Xl m =\n\u2202 * Zl m\n\n0,\np\n= \u2212 \u03b6i l(l + 1)Yl m ,\n\n\u2202 * Nl m =\n\n2\n\u03b6 Yl m ;\n\n(138a)\n(138b)\n(138c)\n\ntogether with\n\u2202 \u00d7Xl m =\n\n1\n\u03b6\n\n\u0010p\n\u0011\ni l(l + 1)Nl m + Zl m ,\n\n\u2202 \u00d7 Zl m = \u2212 \u03b61 Xl m ,\np\n\u2202 \u00d7 Nl m = \u2212 \u03b6i l(l + 1)Xl m .\n\n(139a)\n(139b)\n(139c)\n\nFor any allowed l and m, the vector spherical harmonics are geometrically orthogonal as vectors at every\npoint \u03b6\u0302 on the unit sphere:\nXl m (\u03b6\u0302)\u2217 * Zl m (\u03b6\u0302) = Xl m (\u03b6\u0302)\u2217 * Nl m (\u03b6\u0302) = Zl m (\u03b6\u0302)\u2217 * Nl m (\u03b6\u0302) = 0;\n\n(140)\n\n\f25\nare (Hilbert-space) orthonormal when integrated over solid angle (except in the trivial case where both\nvector fields identically vanish for l = 0):\nZ\nZ\n(141)\nd\u03b8 sin \u03b8 d\u03c6 Wl m (\u03b8, \u03c6)\u2217 * Wl\u2032\u2032 m\u2032 (\u03b8, \u03c6) = \u03b4W W \u2032 \u03b4l l\u2032 \u03b4m m\u2032 (1 \u2212 \u03b4W X \u03b4l 0 ) (1 \u2212 \u03b4W Z \u03b4l 0 ) ;\nand also collectively constitute a complete set for vector fields defined on the unit sphere:\nl\n\u221e X\nX\n\nX\n\nW =X,Z,N l=0 m=\u2212l\n\nWl m (\u03b8, \u03c6) * Wl m (\u03b8\u2032 , \u03c6\u2032 )\u2020 = \u03b4(cos \u03b8 \u2212 cos \u03b8\u2032 )\u03b4(\u03c6 \u2212 \u03c6\u2032 )I3 ,\n\n(142)\n\nwhere I3 is the identity matrix on the polarization degrees of freedom.\nNow, outside the (effective) support of the solenoidal sources, i.e., for any \u03b6 \u2265 \u03b62 > \u03b61 , the actual\nCoulomb-gauge vector potential a(\u03b6; \u03c9) is assumed to satisfy the homogeneous Helmholtz equation,\nand the method of separation-of-variables may be used in spherical coordinates to show that there the\nsolution may always be written in the form:\nX\n\u0002 (1)\n\u0003 i M\n(1)\n1 E\n(143)\na(\u03b6; \u03c9) =\n\u03c9 2 al m (\u03c9)\u2202 \u00d7 hl (k\u03b6)Xl m (\u03b8, \u03c6) \u2212 \u03c9 al m (\u03c9)hl (k\u03b6)Xl m (\u03b8, \u03c6),\nl, m\n\nwhere the spherical Hankel functions of the first and second kind,\n(1)\n\nhl (x) = jl (x) + i nl (x),\n\n(144a)\n\n(2)\nhl (x)\n\n(144b)\n\n= jl (x) \u2212 i nl (x).\n\nare defined in terms of the usual spherical Bessel functions,\n\u0013l \u0012\n\u0013\n\u0012\nsin x\n1 d\nl\n,\njl (x) = (\u2212x)\nx dx\nx\n\n(145)\n\n(which should not be confused with any current density), and the spherical Neumann functions,\n\u0013l \u0010\n\u0012\ncos x \u0011\n1 d\nl\n.\n(146)\nnl (x) = \u2212(\u2212x)\nx dx\nx\nAny two of these four families of special functions may be taken as the linearly-independent solutions\nto the radial differential equation obtained through separation of variables. The appearance of only the\nik\u03b6\n(1)\nhl (kr) \u221d ek\u03b6 in the radial part of our formal solution reflects the facts that the solution holds in the\nextra-source region \u03b6 > \u03b61 which excludes the origin, and that we have imposed the so-called Sommerfeld\nboundary conditions, requiring only outgoing radiation at spatial infinity.\n\nEach term in the superposition (143) is everywhere divergenceless, so the total vector field is solenoidal,\nas required. The expansion coefficients aEl m (\u03c9) \u2208 C and aM\nl m (\u03c9) \u2208 C are, respectively, the (scaled)\nelectric and magnetic multipole moments of the transverse current density j\u22a5 (\u03b6; \u03c9), and are uniquely\ndetermined by quadratures over j, or equivalently by field values in the far-field (or, in fact, by just the\nradial components of the fields on any two spherical shells outside the sources.) For example, using the\nfar-field asymptotic behavior, one can, with a bit of algebra, show that\nM\n\n\u03c92\n\nmax[m+1,l]\n\nX\n\nal m (\u03c9) = \u2212 p\nM\nl(l + 1) m\u2032 =min[0,m\u22121]\naEl m (\u03c9) =\n\nl m\u2032\n\n(\u03c9) *\n\nZ\n\nZ\nd\u03b8 sin \u03b8 d\u03c6 Yl m (\u03b8, \u03c6)\u2217 LYl m\u2032 (\u03b8, \u03c6),\n\nZ\nZ\nmax[m+1,l]\nX\n\u03c9\nRl m\u2032 (\u03c9) * d\u03b8 sin \u03b8 d\u03c6 Yl m (\u03b8, \u03c6)\u2217 LYl m\u2032 (\u03b8, \u03c6);\nip\nl(l + 1) m\u2032 =min[0,m\u22121]\n\n(147a)\n\n(147b)\n\nwhere we have defined\n\nMl m (\u03c9) =\nRl m (\u03c9) =\n\nZ\n\nZ\n\nd3 \u03b6 [jl (kr)Yl m (r\u0302)\u2217 ] j\u22a5 (\u03b6; \u03c9),\n\n(148a)\n\nd3 \u03b6 [jl (kr)Yl m (r\u0302)\u2217 ] \u2202 \u00d7j\u22a5 (\u03b6; \u03c9).\n\n(148b)\n\n\f26\nMany other equivalent forms are possible, depending on precisely what data are used and where, but\nexplicit forms for the multipole expansion coefficients will not actually be needed here. (After all, if\nthey were known or easily calculable, we would not need to resort to any sort of approximation.) Note\nthat time-reversed, or equivalently conjugate, or incoming-wave, solutions can obviously be written in\n\u2212ik\u03b6\n(1)\n(2)\nan analogous manner, with the hl (k\u03b6) replaced with hl (k\u03b6) \u221d e k\u03b6 .\nBy assumption, any solenoidal, source-free \"trial\" vector potential \u03c7(\u03b6; \u03c9; \u03b1) satisfies the homogeneous\nequation everywhere in space, and may be expressed, for any \u03b6, in a similar form:\nX\n\u0002\n\u0003\n1 E\ni M\n\u03c7(\u03b6; \u03c9; \u03b1) =\n(149)\n\u03c9 2 \u03c7l m (\u03c9; \u03b1)\u2202 \u00d7 jl (k\u03b6)Xl m (\u03b8, \u03c6) + \u2212 \u03c9 \u03c7l m (\u03c9; \u03b1)jl (k\u03b6)Xl m (\u03b8, \u03c6).\nl, m\n\nThe use of jl (k\u03b6) is the only choice for the radial dependence which solves the Helmholtz equation but\nis regular everywhere in space, including the origin. Each term in (149) is also automatically divergenceless everywhere, so their sum (when convergent) is solenoidal. The complex coefficients \u03c7El m (\u03c9; \u03b1)\nand \u03c7M\nl m (\u03c9; \u03b1) for this source-free solution may nevertheless be interpreted as some effective (scaled)\nmultipole moments which would describe what we might term an \"effective source\" g(\u03b6; \u03c9; \u03b1), or may\njust be regarded as free expansion coefficients determined by (or even taken to be equal to) the actual\nvariational parameters \u03b1 appearing in \u03c7(\u03b6; \u03c9; \u03b1). The familiar expansions\neik*\u03b6 = 4\u03c0\n\n\u221e\nX\nl=0\n\nil jl (k\u03b6)\n\nl\nX\n\nYl m (\u03b6\u0302)\u2217 Yl m (k\u0302) =\n\nm=\u2212l\n\n\u221e\nX\np\nil 4\u03c0(2l + 1)jl (k\u03b6)Y1 0 (arccos(\u03b6\u0302 * k\u0302), 0),\n\n(150)\n\nl=0\n\nfor any fixed (scaled) wavevector k = k k\u0302, may be used to establish the connection between the plane wave\nand spherical wave representations, and to confirm that they both span the same space of source-free\nsolutions.\n\nB.\n\nGreen Functions\n\nAlternatively, the exact solution to the inhomogeneous problem at any position \u03b6 may be expressed in\nterms of a convolution over the retarded Green function:\n\u2032\n\nGret (\u03b6; \u03b6 \u2032 ; \u03c9) =\n\ne+ikk\u03b6\u2212\u03b6 k\n,\n4\u03c0k\u03b6 \u2212 \u03b6 \u2032 k\n\n(151)\n\nwhich is invariant under simultaneous translations, rotations, or reflections of both spatial arguments,\nand satisfies the scalar Helmholtz equation with impulsive source (and with negative unit charge, conforming to convention for electromagnetic problems),\n\u0001\n(152)\n\u2202 2 + \u03c9 2 Gret (\u03b6; \u03b6 \u2032 ; \u03c9) = \u2212\u03b4(\u03b6 \u2212 \u03b6 \u2032 ),\n\ntogether with the Sommerfeld asymptotic radiation conditions for outgoing waves:\n\n\u2202\n\u2202\u03b6\n\nGret (\u03b6; \u03b6 \u2032 ; \u03c9) = O(1/\u03b6) as \u03b6 \u2192 \u221e\n\u0001 ret\n\u2212 ik G (\u03b6; \u03b6 \u2032 ; \u03c9) = o(1/\u03b6) as \u03b6 \u2192 \u221e,\n\n(153a)\n(153b)\n\nfor any fixed emitter position \u03b6 \u2032 . (Because we are working with solenoidal sources in otherwise free space,\nwe can use a scalar rather than dyadic Green function [37].) The retarded Green function Gret (\u03b6; \u03b6 \u2032 ; \u03c9),\nthen represents an outgoing (scalar) spherical wave at the observation position \u03b6 emanating from a\nharmonic point source at \u03b6 \u2032 . (By symmetry, analogous conditions and interpretations obviously hold\ntrue under permutation of the two spatial positions \u03b6 and \u03b6 \u2032 , from which follow various well-known\nelectromagnetic reciprocity results such as the Raleigh-Carson and Lorentz theorems.) The advanced\nGreen function\n\u2032\n\nadv\n\nG\n\n\u0003\u2217\ne\u2212ikk\u03b6\u2212\u03b6 k\n,\n(\u03b6; \u03b6 ; \u03c9) = G (\u03b6; \u03b6 ; \u03c9) =\n4\u03c0k\u03b6 \u2212 \u03b6 \u2032 k\n\u2032\n\n\u0002\n\nret\n\n\u2032\n\n(154)\n\n\f27\nsatisfies the same impulsive Helmholtz equation, and in fact may be interpreted as the time-reversal of\nthe retarded impulse response, representing an incoming spherical wave, observed at \u03b6, and ultimately\nconverging to a point absorber at \u03b6 \u2032 . Given any current density j(\u03b6 \u2032 ; \u03c9) with compact support in the\nneighborhood V (\u03b61 ) of the origin, and supposing no incoming radiation from distant sources by assumption, the solenoidal component j\u22a5 (\u03b6 \u2032 ; \u03c9) can result only in outgoing radiation asymptotically as \u03b6 \u2192 \u221e,\nso the Coulomb-gauge vector potential can always be expressed as:\nZ\nZ\n3 \u2032 ret\n\u2032\n\u2032\nd3 \u03b6 \u2032 Gret (\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9).\n(155)\na(\u03b6; \u03c9) = d \u03b6 G (\u03b6; \u03b6 ; \u03c9)j\u22a5 (\u03b6 ; \u03c9) =\nV (\u03b61 )\n\nClearly, this satisfies the appropriate inhomogeneous Helmholtz equation:\nZ\n2\n2\n(\u2202 + \u03c9 )a(\u03b6; \u03c9) = d3 \u03b6 \u2032 (\u2202 2 + \u03c9 2 )Gret (\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9)\nZ\n= \u2212 d3 \u03b6 \u2032 \u03b4(\u03b6 \u2212 \u03b6 \u2032 ) j\u22a5 (\u03b6 \u2032 ; \u03c9), = \u2212j\u22a5 (\u03b6; \u03c9)\n\n(156)\n\nand also shares with Gret (\u03b6; \u03b6 \u2032 ; \u03c9) the appropriate outgoing-wave Sommerfeld boundary conditions. Because Gret (\u03b6; \u03b6 \u2032 ; \u03c9) is radially symmetric, depending on the spatial coordinates only through k\u03b6 \u2212 \u03b6 \u2032 k,\nand because \u2202 * j\u22a5 (\u03b6; \u03c9) = 0 by construction, we have\n\u0002\n\u0003\n\u2202 * Gret (\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9) = \u2202Gret (\u03b6; \u03b6 \u2032 ; \u03c9) * j\u22a5 (\u03b6 \u2032 ; \u03c9) = \u2212\u2202 \u2032 Gret (\u03b6; \u03b6 \u2032 ; \u03c9) * j\u22a5 (\u03b6 \u2032 ; \u03c9)\n(157)\n= \u2212\u2202 \u2032 * [Gret (\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9)] .\nSince Gret (\u03b6; \u03b6 \u2032 ; \u03c9) = O(1/ |\u03b6 \u2212 \u03b6 \u2032 |) and j\u22a5 (\u03b6; \u03c9) . O(1/\u03b6 2 ) as \u03b6 \u2192 \u221e, Gauss's law then implies\nZ\nZ\n3 \u2032\nret\n\u2032\n\u2032\n\u2202 * a(\u03b6; \u03c9) = d \u03b6 \u2202 * [G (\u03b6; \u03b6 ; \u03c9)j\u22a5 (\u03b6 ; \u03c9)] = \u2212 d3 \u03b6 \u2032 \u2202 \u2032 *[Gret (\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9)]\nZ\n(158)\nd\u03c3 \u2032 n\u0302 * [Gret (\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9)] = 0\n= \u2212 lim\n\u03b62 \u2192\u221e\nV (\u03b62 )\n\nso indeed a(\u03b6; \u03c9) is solenoidal, as required. (Subsequently, we will make use of a number of similar\nmultidimensional \"integrations by parts,\" relying on the the sufficiently rapid fall-off of j\u22a5 and radiative\nfall-off of Gret , but for brevity we will not always provide the explicit demonstrations.)\nOutside the support of sources, say for \u03b6 \u2265 \u03b62 > \u03b61 , the solution to the inhomogeneous Helmholtz\nequation may also be written in terms of a surface integral involving the Green function and boundary\ndata. Specifically, by applying Green's second identity to the region lim V (\u03b63 ) \u2212 V (\u03b62 ), using the\n\u03b63 \u2192\u221e\n\nHelmholtz equations satisfied by the vector potential and the retarded Green function, and making use\nof the assumed Sommerfeld radiation conditions, we find:\nZ\n\u0002\n\u0003\n(159)\nd\u03c3 \u2032 a(\u03b6 \u2032 ; \u03c9)(n\u0302\u2032 *\u2202 \u2032 )Gret (\u03b6; \u03b6 \u2032 ; \u03c9) \u2212 Gret (\u03b6; \u03b6 \u2032 ; \u03c9)(n\u0302\u2032 *\u2202 \u2032 )a(\u03b6 \u2032 ; \u03c9) ,\na(\u03b6; \u03c9) =\n\u2202V (\u03b62 )\n\nwhich is the vector form of the well-known Kirchoff diffraction integral. Here the unit vector n\u0302\u2032 = n\u0302(\u03b6 \u2032 )\ndenotes an outward normal to the boundary surface at any point \u03b6 \u2032 \u2208 \u2202V (\u03b62 ).\nBy piecing together different spherical wave solutions to produce just the right discontinuity at \u03b6 = \u03b6 \u2032 ,\nit is straightforward to establish the well-known Bessel decomposition of the retarded Green function:\nGret (\u03b6; \u03b6 \u2032 ; \u03c9) = i\u03c9\n\n\u221e\nX\n\n(1)\n\njl (k\u03b6< )hl (k\u03b6> )\n\nl\nX\n\nYl m (\u03b6\u0302)Yl m (\u03b6\u0302 \u2032 )\u2217\n\n(160)\n\nm=\u2212l\n\nl=0\n\nwhere\n\u03b6< = min[\u03b6, \u03b6 \u2032 ],\n\u03b6> = max[\u03b6, \u03b6 \u2032 ].\n\n(161a)\n(161b)\n\n\f28\nFrom linearity, we can see that the difference between the retarded and advanced Green functions,\nD(\u03b6; \u03b6 \u2032 ; \u03c9) \u2261 Gret (\u03b6; \u03b6 \u2032 ; \u03c9) \u2212 Gadv (\u03b6; \u03b6 \u2032 ; \u03c9) = \u2212\n\ni\nsin (kk\u03b6 \u2212 \u03b6 \u2032 k)\n=\nsinc (kk\u03b6 \u2212 \u03b6 \u2032 k) ,\n2\u03c0ik\u03b6 \u2212 \u03b6 \u2032 k\n2\u03c0\n\n(162)\n\nmust be a solution (with respect to either spatial coordinate) to the source-free scalar Helmholtz equation\neverywhere in space. Substituting in the decomposition (160) for the Green function, this homogeneous\nsolution D(\u03b6; \u03b6 \u2032 ; \u03c9) may be written as:\nX\nD(\u03b6; \u03b6 \u2032 ; \u03c9) = 2i\u03c9\njl (k\u03b6)jl (k\u03b6 \u2032 )\u2217 Yl m (\u03b6\u0302)Yl m (\u03b6\u0302 \u2032 )\u2217 ,\n(163)\nl ,m\n\nwhere we have used the facts that\n\nl\nP\n\nYl m (\u03b6\u0302)Yl m (\u03b6\u0302 \u2032 )\u2217 and jl (k\u03b6) are both real.\n\nm=\u2212l\n\nNow, it turns out that, just as a general solution to the inhomogeneous equation with outgoing Sommerfeld radiation boundary conditions may be written as a convolution between the retarded Green\nfunction and the solenoidal portion of the current density, any arbitrary solenoidal solution to the homogeneous problem may be written as a convolution between what we may term the fundamental solution\nD(\u03b6; \u03b6 \u2032 ; \u03c9) and the solenoidal component g\u22a5 (\u03b6 \u2032 ; \u03c9), of some effective source term g(\u03b6 \u2032 ; \u03c9) whose support\ncan be confined to any finite-radius ball B(\u03b60 ) where \u03b60 > 0 :\nZ\nZ\nd3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9)g\u22a5 (\u03b6 \u2032 ; \u03c9)\n(164)\n\u03c7(\u03b6; \u03c9) = d3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9)g\u22a5 (\u03b6 \u2032 ; \u03c9) =\nV (\u03b60 )\n\nTo see this, first note that if we choose\ng(\u03b6; \u03c9) = g\u22a5 (\u03b6; \u03c9) \u221d \u0398(\u03b60 \u2212 \u03b6)jl (k\u03b6)Xl m (\u03b8, \u03c6),\n\n(165)\n\n(which is clearly divergenceless by the chain rule and the transverse nature of Xl m (\u03b6\u0302)), then, by using the\nexplicit decomposition (163) for D(\u03b6; \u03b6 \u2032 ; \u03c9) and the orthogonality properties of the spherical harmonics\nas well as their behavior under the action of the orbital angular momentum operator L, we find\n\u03c7(\u03b6; \u03c9) \u221d\n\n\u0014Z\u03b60\n0\n\n\u2032\n\n\u2032\n\n\u2032\n\n2\n\n\u0015\n\nd\u03b6 |\u03b6 jl (k\u03b6 )| jl (k\u03b6)Xl m (\u03b8, \u03c6),\n\n(166)\n\nand thus any term of the magnetic multipole form in (149) can be generated in this manner. Using\nstandard vector identities, the symmetry of D(\u03b6; \u03b6 \u2032 ; \u03c9) in its spatial arguments, and integration by parts\nrelying on the rapid fall-off of g\u22a5 , we also have\nZ\nZ\n\u0002\n\u0003\n\u2202 \u00d7 d3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9) g(\u03b6 \u2032 ; \u03c9) = d3 \u03b6 \u2032 \u2202 \u00d7 D(\u03b6; \u03b6 \u2032 ; \u03c9) g\u22a5 (\u03b6 \u2032 ; \u03c9)\nZ\n(167)\n= d3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9) \u2202 \u2032 \u00d7g\u22a5 (\u03b6 \u2032 ; \u03c9),\nSo any required term of the electric multipole form can also be so generated. By linearity, an arbitrary\nhomogeneous solution may then be constructed as a convolution over the fundamental homogeneous\nsolution. We will see below that the effective source g(\u03b6; \u03c9) appearing in the convolutional representation may be taken to be identical to that determining the multipole coefficients in the spherical wave\nexpansion.\n\nC.\n\nHilbert Space Results\n\nIn the non-paraxial case, the wave-equation is no longer equivalent to a time-dependent Schrodinger\nequation, although the source-free Helmholtz equation is analogous to a time-independent, free-particle\nSchrodinger equation, albeit typically with non-normalizable, scattering-state boundary conditions.\n\n\f29\nHowever, when convenient, we can still recast our non-paraxial mathematical results into a Hilbertspace-like formalism. Without a distinguished optic axis, we extend the spatial dependence of spinors\nand observables from two dimensions to three dimensions, each coordinate now treated on an equal\nfooting, and we allow for more general polarization bases, using some given family (labeled here by n,\nstanding for some set of integer indices or \"quantum numbers\") of smooth, possibly complex-valued\nvector fields \u01eb\u0302ns (\u03b6; \u03c9) (still indexed, say by s = \u22121, 0, +1) which constitute a local orthonormal triad at\nevery spatial position \u03b6 :\n\u01ebns (\u03b6; \u03c9)\u2217 * \u01ebns\u2032 (\u03b6; \u03c9) = \u03b4s s\u2032 .\n\n(168)\n\nFor example, we could use, as convenient, a fixed Cartesian basis x\u0302, \u0177, \u1e91; the spherical-coordinate basis\n\u03b6\u0302, \u03b8\u0302, \u03c6\u0302; the helicity basis \u00ea+ , \u00ea\u2212 , \u1e91 (also known as the spherical basis because of its role in defining\nspherical tensors, not to be confused with the above basis vectors for spherical coordinates); normalized\nvector spherical harmonic basis vector field for some l \u2265 1 and m, i.e., X\u0302l m (\u03b6\u0302), N\u0302l m (\u03b6\u0302), \u1e90l m (\u03b6\u0302); or a\nnatural radiation basis field derived from some reference vector potential a(\u03b6; \u03c9), namely \u03b5\u0302a \u22a5 , \u015da , b\u0302a .\nMuch of the \"quantum\"-like formalism developed in the paraxial case can be generalized in the obvious\nway to a three-dimensional Hilbert space H3D consisting of square-integrable functions g : R3 \u2192 C3 ,\nand will not be reproduced here, except to note that we will now denote the (possibly generalized, i.e.,\nnon-normalizable) eigenket corresponding to the vector field g(\u03b6; \u03c9) by |g(\u03c9)i , and the generalized 3D\nposition/polarization eigenkets by |\u03b6; \u01eb\u0302ns (\u03b6; \u03c9)i , such that\nh\u03b6; \u01eb\u0302ns (\u03b6; \u03c9)|g(\u03c9)i = \u01eb\u0302ns (\u03b6; \u03c9)\u2217 * g(\u03b6; \u03c9),\nwhere the Hilbert-space inner product now involves integration over all spatial variables:\nZ\nhg|g \u2032 i = d3 \u03b6 g(\u03b6)\u2217 *g \u2032 (\u03b6).\n\n(169)\n\n(170)\n\nNow, consider the Hilbert-space operator K = K(\u03c9) defined via its spatial/polarization kernel:\nK(\u03b6, s; \u03b6 \u2032 , s\u2032 ; \u03c9) \u2261 h\u03b6; \u01eb\u0302ns (\u03b6; \u03c9) |K(\u03c9)| \u03b6 \u2032 ; \u01eb\u0302ns\u2032 (\u03b6; \u03c9)i \u2261 \u2212 12 i\u03c9 \u03b4s s\u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9),\n\n(171)\n\nwhich is given explicitly by\nK(\u03b6, 0; \u03b6 \u2032 , 0; \u03c9) =\n\nX\n\u03c9\nsinc (kk\u03b6 \u2212 \u03b6 \u2032 k) = \u03c9 2\njl (k\u03b6)jl (k\u03b6 \u2032 )\u2217 Yl m (\u03b6\u0302)Yl m (\u03b6\u0302 \u2032 )\u2217 .\n4\u03c0\n\n(172)\n\nl ,m\n\nThe kernel is seen to be real-valued and symmetric in all spin/spatial arguments, so the corresponding\noperator K = K \u2020 is Hermitian. Because the kernel acts as the identity on polarization degrees of freedom,\nthe operator is independent of spin observables, and may be formally written as a function only of spatial\nobservables. In fact, because the kernel is translationally and rotationally invariant, depending on the\nspatial coordinates\nonly through k\u03b6 \u2212 \u03b6 \u2032 k, K must be a function solely of the momentum magnitude\n\u221a\n2\nkP3D k = \u2212\u2202 . Crucially, K is also positive semidefinite, in the sense that\nZ\nZ\n\u2032\n3\nhg(\u03c9) |K(\u03c9)| g (\u03c9)i = d \u03b6 d3 \u03b6 \u2032 K(\u03b6, 0; \u03b6 \u2032 , 0; \u03c9) g(\u03b6; \u03c9)\u2217 *g(\u03b6 \u2032 ; \u03c9) \u2265 0,\n(173)\nfor any complex vector field g(\u03b6; \u03c9) which is sufficiently well-behaved for the integral to exist. This can\nbe seen most easily from the diagonal expansion in spherical waves:\n2\nXX Z\n\u2032\n2\nhg(\u03c9) |K(\u03c9)| g (\u03c9)i = \u03c9\nd3 \u03b6 \u01eb\u0302ns (\u03b6)\u2217 *g(\u03b6; \u03c9)jl (k\u03b6)\u2217 Yl m (\u03b6\u0302)\u2217 \u2265 0.\n(174)\nl ,m\n\ns\n\nIt is also a direct consequence of the well-known Bochner theorem, which says that a continuous function\nin real-space is nonnegative definite as a spatial kernel if and only if its Fourier transform is proportional\nto a positive measure over reciprocal space (and positive definite if this measure is everywhere non-zero).\nTransforming to the scaled momentum (i.e., wavevector, or reciprocal-space) representation where the\noperator K is diagonal, we find:\nK(\u03c9) = \u03c0\u03b4(P3D *P3D \u2212 \u03c9 2 ),\n\n(175)\n\n\f30\nso that\nhg(\u03c9) |K(\u03c9)| g \u2032 (\u03c9)i = \u03c0\n\nZ\n\nd3 k |g(k; \u03c9)|2 \u03b4(kkk2 \u2212 \u03c9 2 ) \u2265 0,\n\n(176)\n\nwhere k is the scaled wavevector conjugate to \u03be, and g(k; \u03c9) is the (scaled) spatial Fourier transform\nof g(\u03b6; \u03c9). Note that K(\u03c9) acts to restrict the spectral content of any vector field g(\u03b6; \u03c9) in its domain\nto the manifold of wavevectors satisfying the vacuum dispersion relation \u03c9 2 = kkk2 . However, K is not\nidempotent, so cannot be considered a true projection.\nThat K(\u03b6; \u03b6 \u2032 ; \u03c9) is only positive semidefinite and not strictly positive definite is a consequence of the\nwell-known existence of non-radiating sources for the Helmholtz problem, which invariably complicate\nuniqueness results and inverse-scattering calculations. Specifically, suppose we take\ng0 (\u03b6; \u03c9) = g0 \u22a5 (\u03b6; \u03c9) \u221d \u0398(\u03b60 \u2212 \u03b6)gl (k\u03b6)Xl m (\u03b8, \u03c6),\n\n(177)\n\nfor any allowed l and m, some \u03b60 > 0, and any well-behaved, non-trivial scalar function gl (k\u03b6) which is\nchosen to satisfy\nZ\u03b60\n\nd\u03b6 \u03b6 2 gl (k\u03b6)jl (k\u03b6) = 0,\n\n(178a)\n\nZ\u03b60\n\nd\u03b6 \u03b6 2 gl (k\u03b6)gl (k\u03b6) > 0,\n\n(178b)\n\n0\n\n0\n\nThen using the spherical wave expansions, it immediately follows for this source that, for all \u03b6,\nZ\n\u03c70 (\u03b6; \u03c9) = d3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9)g0 (\u03b6 \u2032 ; \u03c9) = 0;\nand also, anywhere in the extra-source region, i.e., for \u03b6 > \u03b60 ,\nZ\nout\na0 (\u03b6; \u03c9) = d3 \u03b6 \u2032 Gret (\u03b6; \u03b6 \u2032 ; \u03c9)g0 (\u03b6 \u2032 ; \u03c9) = 0,\nZ\nain\n(\u03b6;\n\u03c9)\n=\nd3 \u03b6 \u2032 Gadv (\u03b6; \u03b6 \u2032 ; \u03c9)g0 (\u03b6 \u2032 ; \u03c9) = 0,\n0\n\n(179)\n\n(180a)\n(180b)\n\nand indeed no radiation is produced by g0 acting either as a real, time-reversed, or effective (homogeneous) source. Any such vector field g0 (\u03b6; \u03c9) corresponds to a ket |g0 (\u03c9)i in the nullspace of the operator\nK; i.e., K(\u03c9) |g0 (\u03c9)i = 0.\nThe nullspace of the Hermitian operator K is therefore infinite-dimensional (and in fact nondenumerable). Modulo some (admittedly thorny) normalization issues due to the unbounded nature\nof K, the basis of homogeneous spherical waves solutions (149) are the orthogonal eigenfunctions of K in\nthe position basis corresponding to non-zero eigenvalue. Although it would involve more mathematical\ndetail than justified in this presentation, the properties and behavior of K can be analyzed rigorously\nwithin the theory of Reproducing Kernel Hilbert Spaces (RKHS), where the spherical wave expansion of\nthe kernel emerges as a consequence of Mercer's theorem [38]. In a similar manner, we may define Green\noperators Gret (\u03c9) and Gadv (\u03c9) from their spatial representations; these operators are complex-symmetric,\nbut neither Hermitian nor positive semidefinite.\nHowever, the problems encountered with normalization cannot be completely ignored. While this Hilbert\nspace H3D , equipped with the Euclidean/L2 inner product, is the natural setting for the source-terms such\nas j(\u03b6; \u03c9), j\u22a5 (\u03b6; \u03c9), g(\u03b6; \u03c9), and g\u22a5 (\u03b6; \u03c9), it is not always a comfortable home for the vector potentials\na(\u03b6; \u03c9) or \u03c7(\u03b6; \u03c9) or the corresponding fields, since the presence of far-zone radiation fields, falling\noff like O(1/\u03b6), implies that the vector potentials and fields are not normalizable with respect to this\ninner product, so do not strictly belong to the Hilbert space H3D . However, they may be approximated\narbitrarily closely (point-wise) by vector fields in the Hilbert-space, and inner products between radiation\nand sources, e.g., hj(\u03c9)|a(\u03c9)i will exist for allowed current densities, which must be localized.\n\n\f31\nThe lack of nomalizability may be traced to the fact that radiation fields can contain, in principle, an\ninfinite amount of energy when integrated over all space, while transmitting only a finite amount of\npower. If necessary, we could use the familiar regularizing device of introducing a finite \"quantization\"\nvolume V (\u03b6Q ) together with periodic or conducting-wall boundary conditions, and then take the limit\n\u03b6Q \u2192 \u221e at the very end of the calculation. For the currently envisioned application, this is not terribly\nconvenient, as we are interested primarily in the far-field from the start. Alternatively, we can choose\na different inner product, which effectively normalizes the radiation fields based on power (or power\nspectral density) rather than energy. We can define a Hilbert space Hout spanned by the basis consisting\nof outgoing solenoidal vector spherical waves, with an inner product defined as a Euclidian dot product\non the multipole expansion coefficients:\nX\u0002\n\u0003\n\u2217\n\u2032M\n(a(\u03c9) , a\u2032 (\u03c9))out =\n(181)\naEl \u2217m (\u03c9)a\u2032lEm (\u03c9) + aM\nl m (\u03c9)al m (\u03c9) .\nlm\n\nThe exact relationship between this inner product and the scaled power spectral density will be seen\nshortly, but it should be apparent that this quantity may be expressed soley in in terms of far-field\ndata, rather than on the field throughout all space, and physical radiation fields, with finite power,\n\u2217 \u223c\nwill be normalizable in the sense (a(\u03c9) , a(\u03c9)) < \u221e. An isomorphic Hilbert space Hin \u2261 Hout\n= Hout\n\u2217\nmay be defined in an exactly analogous manner for incoming-wave solutions, such as a(\u03b6; \u03c9) . Complex\nconjugation provides a natural isometry between them, or instead one may use the mapping which simply\nswaps the spherical Hankel functions h(1) (kr) and h(2) (kr) in the spherical wave expansions without\nchanging the multipole expansion coefficients or the vector spherical harmonics. Strictly outside the\nsupport of the sources (if any), any solenoidal solution \u03c8 to the vector Helmholtz equation (homogeneous\nor inhomogeneous), of finite power but with otherwise arbitrary boundary conditions, may be expressed\nas the superposition of incoming and outgoing spherical waves, so it necessarily lies in the Hilbert space\nHout \u2295 Hin . Thus, we can in this case uniquely decompose (for \u03b6 > \u03b62 ) any such solution \u03c8(\u03b6; \u03c9) as\n\u03c8(\u03b6; \u03c9) = \u03c8 out (\u03b6; \u03c9) + \u03c8 in (\u03b6; \u03c9),\n\n(182)\n\nwhere \u03c8 out and \u03c8 in are, respectively, the outgoing and incoming components of the vector field, in the\nsense that they satisfy the appropriate Sommerfeld boundary conditions as \u03b6 \u2192 \u221e. The inherited inner\nproduct is given by\n(\u03c8(\u03c9) , \u03c8 \u2032 (\u03c9)) = (\u03c8 out (\u03c9) , \u03c8 \u2032out (\u03c9))out + (\u03c8 in (\u03c9) , \u03c8 \u2032in (\u03c9))in .\n\n(183)\n\nOur approximating \"trial\" vector potentials \u03c7 will lie in the proper Hilbert subspace Hhom ( Hout \u2295 Hin ,\nconsisting of source-free solutions which are regular everywhere in space. This space of homogeneous\nsolutions is also isomorphic to the outgoing or incoming wave spaces: Hhom \u223c\n= Hin , as can be seen\n= Hout \u223c\nby imagining the mapping that replaces, in the spherical wave expansions, each real-valued spherical\nBessel function jl (kr) with the corresponding complex spherical Hankel function h(1) (kr) or h(2) (kr),\nrespectively, without altering the angular dependence or the expansion coefficients.\n\nD.\n\nEnergy Balance and Poynting Flux\n\nUsing the Helmholtz equation, gauge constraint, and various vector identities, one can derive a generalized impedance relation, or complexified power-balance equation, for the fields in the frequency domain\nover any arbitrary spatial region R, and valid for any consistent boundary conditions imposed on the\nradiation at spatial infinity:\nZ\nZ\nZ\n\u0003\n\u0002\nd3 \u03b6 [j\u22a5 (\u03b6; \u03c9)\u2217 *\u03b5a \u22a5 (\u03b6; \u03c9)] + i\u03c9 d3\u03b6 k\u03b5a \u22a5 (\u03b6; \u03c9)k2 \u2212 kba (\u03b6; \u03c9)k2 + d2 \u03c3 [n\u0302*sa (\u03b6; \u03c9)] = 0, (184)\nR\n\nR\n\n\u2202R\n\nwhere n\u0302 = n\u0302(\u03b6) is a outward normal unit vector on the boundary surface at \u03b6 \u2208 \u2202R. This relation is\nquite similar to the usual conservation law derived in textbooks from the time-harmonic formulation of\nMaxwell's equations [2, 5], except that it involves only the solenoidal components of the sources and the\nfields \u2013 the longitudinal component jk of the current density and the scalar potential \u03c6 and its derivatives\ndo not appear.\n\n\f32\nIn the most general, inhomogeneous case, this relation implies:\nZ\nZ\n3\n\u2217\n\u2212 Re d \u03b6 [j\u22a5 *\u03b5a \u22a5 ] = Re d2 \u03c3 [n\u0302*sa ] ,\nR\n\n(185)\n\n\u2202R\n\nwhich is an expression of time-averaged energy conservation, relating the (negative) rate of mechanical\nwork done on the solenoidal sources within R to the rate of energy escape in the form of radiation\nthrough the boundary \u2202R. If we let R = V (\u03b62 ) for any \u03b62 > \u03b61 , we can replace j\u22a5 with the the full\ncurrent density j on the right-hand-side, and this becomes\nZ\nZ\n\u2202\n\u2202\nd2 \u03c3 [n\u0302*sa ] \u2261 \u2202\u03c9\n\u2212 \u2202\u03c9\nPmech [\u03b5a \u22a5 ; j](\u03c9) \u2261 \u2212 Re d3 \u03b6 [j \u2217 *\u03b5a \u22a5 ] = Re\nPEM [a](\u03b62 ; \u03c9)\n(186)\n\u2202V (\u03b62 )\n\nThe radiated power spectral density is independent of radius \u03b62 as long as \u03b62 > \u03b61 , as assumed, so we\nmay take \u03b62 \u2192 \u221e on the left-hand-side whenever convenient. Using Green's Second Identity and other\nvector identities, the spectral density of the radiative flux can also be written in the following useful\nforms within the Coulomb gauge:\nZ\nZ\n\u0002\n\u0003 i\u03c9\ni\u03c9\n3\n2 \u2217\n\u2217\n2\n\u2202\nd \u03b6 a*\u2207 a \u2212 a *\u2207 a =\nd2 \u03c3 [a*(n\u0302*\u2202)a\u2217 \u2212 a\u2217 *(n\u0302*\u2202)a] . (187)\n\u2202\u03c9 PEM [a](\u03b62 ; \u03c9) = 2\n2\nV (\u03b62 )\n\n\u2202V (\u03b62 )\n\nSimilarly, if a(\u03b6; \u03c9) is the exact solenoidal radiation corresponding to j\u22a5 (\u03b6; \u03c9), and \u03c7(\u03b6; \u03c9) is any\narbitrary solenoidal solution to the source-free Helmholtz equation, then for \u03b62 > \u03b61 ,\nZ\n\u0002\n\u0003\ni\u03c9\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9) =\n\u2212 \u2202\u03c9\nd3 \u03b6 \u03c7*\u2202 2 a\u2217 \u2212 a\u2217 *\u2202 2 \u03c7 + a*\u2202 2 \u03c7\u2217 \u2212 \u03c7\u2217 *\u2202 2 a\n2\nV (\u03b62 )\n\n=\n\ni\u03c9\n2\n\nZ\n\n(188)\n\nd2 \u03c3 [\u03c7*(n\u0302*\u2202)a\u2217 \u2212 a\u2217 *(n\u0302*\u2202)\u03c7 + a*(n\u0302*\u2202)\u03c7\u2217 \u2212 \u03c7\u2217 *(n\u0302*\u2202)a] .\n\n\u2202V (\u03b62 )\n\nFor any such solution\n\u03c7(\u03b6; \u03c9) to the\u0003 homogeneous Helmholtz equation (i.e., where \u2202 2 \u03c7 = \u2212\u03c9 2 \u03c7), the\n\u0002\nLorentz invariant k\u03b5\u03c7 \u22a5 k2 \u2212 kb\u03c7 k2 vanishes everywhere (as can be seen easily, for example, from an\nexpansion in transverse plane waves, or from the spherical wave basis), and from (184) or (188) we have:\nZ\n\n\u2202R\n\nd2 \u03c3 [n\u0302*s\u03c7 ] =\n\nZ\n\nR\n\nd3 \u03b6 [\u2202 *s\u03c7 ] =\n\nZ\n\u0002\n\u0003\ni\u03c9\nd3 \u03b6 \u03c7*\u2202 2 \u03c7\u2217 \u2212 \u03c7\u2217 *\u2202 2 \u03c7 = 0.\n2\n\n(189)\n\nR\n\nThat is, both real and imaginary parts of the Poynting flux vanish when integrated over any closed\nsurface, reflecting the fact that, as is intuitively evident from the convolution representation (164) or\nfrom a plane-wave decomposition, any vector potential which satisfies the homogeneous wave equation\neverywhere must, in fact, result in an equal amount of averaged radiative flux passing into and out from\nany closed surface, without any dissipation of field energy or reactive storage of energy in localized,\nquasi-static fields.\nAs we saw above, however, we can locally decompose the homogeneous fields into what represent, or at\nleast eventually (as \u03b6 \u2192 \u221e) become, separately outwardly-radiating and inwardly-radiating waves:\n\u03c7(\u03b6; \u03c9) = \u03c7out (\u03b6; \u03c9) + \u03c7in (\u03b6; \u03c9),\n(190)\n\u0003\n\u0003\n\u0002\n\u0002\n\u2265 0 and Re n\u0302(\u03b6) * sin\nwhere for all \u03b6 \u2208 \u2202V (\u03b62 ), Re n\u0302(\u03b6) * sout\n\u03c7 \u2264 0 as \u03b62 \u2192 \u221e. This is most easily ac\u03c7\ncomplished simply by separating the fundamental representation into retarded (outgoing) and advanced\n(incoming) parts:\nZ\nout\n\u03c7 (\u03b6; \u03c9) =\nd3 \u03b6 \u2032 Gret (\u03b6; \u03b6 \u2032 ; \u03c9)g\u22a5 (\u03b6 \u2032 ; \u03c9);\n(191)\n\n\f33\nand\n\u03c7in (\u03b6; \u03c9) = \u2212\n\nZ\n\nd3 \u03b6 \u2032 Gadv (\u03b6; \u03b6 \u2032 ; \u03c9)g\u22a5 (\u03b6 \u2032 ; \u03c9).\n\n(192)\n\nNote that these vector potentials separately satisfy the homogeneous equation only for \u03b6 > \u03b60 , but\nsatisfy the inhomogeneous equation everywhere for the appropriate effective source terms and specified\nboundary conditions. Although \u03c7in (\u03b6; \u03c9) involves the time-reversed (advanced) Green function, it is not\nthe time-reversal of \u03c7out (\u03b6; \u03c9), because it involves the negation, not complex conjugation, of the effective\nsource g\u22a5 (\u03b6; \u03c9). Indeed, the conjugate wave \u03c7in (\u03b6; \u03c9)\u2217 may be interpreted as the usual outgoing radiation\nfrom the effective source \u2212g\u22a5 (\u03b6 \u2032 ; \u03c9)\u2217 .\nUsing the symmetry of the Green functions and a simple change of variables, it is easily shown that for\nany \u03b62 > \u03b60 ,\nZ\nZ\nout\nout\n3\n\u2202\n\u2202\nP\n[\u03c7\n](\u03b6\n;\n\u03c9)\n=\n\u2212\nP\n[\u03b5\n;\ng](\u03c9)\n=\nd\n\u03b6\nd3 \u03b6 \u2032 K(\u03b6; \u03b6 \u2032 ; \u03c9) g\u22a5 (\u03b6; \u03c9)\u2217 *g\u22a5 (\u03b6 \u2032 ; \u03c9)\n2\n\u2202\u03c9 EM\n\u2202\u03c9 mech \u03c7 \u22a5\n(193)\n= hg\u22a5 (\u03c9) |K(\u03c9)| g\u22a5 (\u03c9)i \u2265 0,\nwhich vanishes if and only if g\u22a5 (\u03b6; \u03c9) is a non-radiating source at frequency \u03c9. In the same manner, we\nalso find\nZ\nZ\nin\nin\n3\n\u2202\n\u2202\nP\n[\u03c7\n](\u03b6\n;\n\u03c9)\n=\n\u2212\nP\n[\u03b5\n;\n\u2212g](\u03c9)\n=\n\u2212\nd\n\u03b6\nd3 \u03b6 \u2032 K(\u03b6; \u03b6 \u2032 ; \u03c9) g\u22a5 (\u03b6; \u03c9)\u2217 *g\u22a5 (\u03b6 \u2032 ; \u03c9)\nEM\n2\nmech\n\u03c7\u22a5\n\u2202\u03c9\n\u2202\u03c9\n(194)\n= \u2212 hg\u22a5 (\u03c9) |K(\u03c9)| g\u22a5 (\u03c9)i \u2264 0,\nalso vanishing if and only if g\u22a5 (\u03b6; \u03c9) is a non-radiating source. Thus, we see that, as anticipated,\nout\n\u2202\n\u2202\u03c9 PEM [\u03c7 ](\u03b62 ; \u03c9)\n\n\u2202\n= \u2212 \u2202\u03c9\nPEM [\u03c7in ](\u03b62 ; \u03c9) =\n\nin\u2217\n\u2202\n\u2202\u03c9 PEM [\u03c7 ](\u03b62 ; \u03c9)\n\n\u2265 0.\n\n(195)\n\nIt then follows that\nZ\nZ\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; g](\u03c9) = \u2212 12 Re d3 \u03b6 [g \u2217 *\u03b5\u03c7 \u22a5 ] = 12 d3 \u03b6 [g \u2217 *\u03b5\u03c7 \u22a5 ]\n\u2212 21 \u2202\u03c9\nZ\nZ\n3\n1\n= 2 d \u03b6 d3 \u03b6 \u2032 i\u03c9D(\u03b6; \u03b6 \u2032 ; \u03c9) g\u22a5 (\u03b6; \u03c9)\u2217 *g\u22a5 (\u03b6 \u2032 ; \u03c9)\nZ\nZ\n= d3 \u03b6 d3 \u03b6 \u2032 K(\u03b6; \u03b6 \u2032 ; \u03c9) g\u22a5 (\u03b6; \u03c9)\u2217 *g\u22a5 (\u03b6 \u2032 ; \u03c9)\n\n(196)\n\n\u2202\nPmech [\u03b5out\n= hg\u22a5 (\u03c9 |K(\u03c9)| g\u22a5 (\u03c9)i = \u2212 \u2202\u03c9\n\u03c7 \u22a5 ; g](\u03c9) \u2265 0,\n\nwhich is the generalization of the paraxial result (91).\nIf we take g(\u03b6; \u03c9) = j(\u03b6; \u03c9) to be the physical current density of interest, then the homogeneous approximation\nZ\n\u03c7j (\u03b6; \u03c9) = d3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9)j\u22a5 (\u03b6 \u2032 ; \u03c9)\n(197)\nagrees exactly in its outgoing components with the actual radiation:\n\u03c7out\nj (\u03b6; \u03c9) = a(\u03b6; \u03c9),\n\n(198)\n\nbut in order to actually satisfy the homogeneous Helmholtz equation everywhere, it must possess an equal\nmagnitude of net power in the corresponding (i.e., conjugate) incoming modes making up \u03c7in (\u03b6; \u03c9), power\nwhich will flow in the opposite direction through any surface enclosing the sources. This extra power\nappears as extra work which would be done by the actual source charges on these incoming fields, if they\nwere present. (These advanced fields do not lead to absorption by the sources making up j because,\nagain, they are the time-reversal of the retarded fields which would be produced by \u2212j \u2217 , not j itself.)\nUsing Green's identities and the governing Helmholtz equations, one can show that this homogeneous\n\n\f34\nsolution may also be formally expressed in the Kirchoff-integral form, only with the Green function\nGret (\u03b6; \u03b6 \u2032 ; \u03c9) replaced with the fundamental homogeneous solution D(\u03b6; \u03b6 \u2032 ; \u03c9) :\nZ\n\u0002\n\u0003\n(199)\nd\u03c3 \u2032 a(\u03b6 \u2032 ; \u03c9)(n\u0302\u2032 *\u2202 \u2032 )D(\u03b6; \u03b6 \u2032 ; \u03c9) \u2212 D(\u03b6; \u03b6 \u2032 ; \u03c9)(n\u0302\u2032 *\u2202 \u2032 )a(\u03b6 \u2032 ; \u03c9) .\n\u03c7j (\u03b6; \u03c9) =\n\u2202V (\u03b63 )\n\nUnlike the inhomogeneous case, this remains valid for any boundary radius \u03b63 > 0 and any observation\nposition \u03b6.\nNot surprisingly, the homogeneous approximation \u03c7j (\u03b6; \u03c9) to a(\u03b6; \u03c9) is just the result of the abovementioned one-to-one mapping between the isomorphic spaces Hout and Hhom , involving the replacement\n(1)\nof each \"outgoing\" spherical Hankel function hl (k\u03b6) with the corresponding \"standing-wave\" spherical\nBessel function jl (k\u03b6) in the spherical wave expansion for a(\u03b6; \u03c9), without altering any of the multipole\nexpansion coefficients or basis vector fields for the angular dependence. Schematically, we have:\nHout \u2192 Hhom\na(\u03b6; \u03c9) \u2192 \u03c7j (\u03b6; \u03c9)\n\n(200a)\n(200b)\n\n(1)\n\nhl (k\u03b6) \u2192 jl (k\u03b6)\n\n(200c)\n\nWl m (\u03b6\u0302) \u2192 Wl m (\u03b6\u0302)\naEl m (\u03c9) \u2192 \u03c7El m (\u03c9) = aEl m (\u03c9)\nM\nM\naM\nl m (\u03c9) \u2192 \u03c7l m (\u03c9) = al m (\u03c9).\n\n(200d)\n(200e)\n(200f)\n\nWe expect that this \u03c7j (\u03b6; \u03c9) is in some sense the closest possible homogeneous approximation to a(\u03b6; \u03c9),\nwhich will be confirmed below by the non-paraxial form of the Maximum-Power Variational Principle.\nWe can also express the various radiated power spectral densitities directly in terms of the multipole\nexpansion coefficients or associated inner product, by using (187) in the limit \u03b62 \u2192 \u221e. Asymptotically,\ni.e., for kr \u226b l, the limiting forms of the spherical Bessel, Neumann, and Hankel functions are:\nsin(kr \u2212 l\u03c0\n2 )\n,\nkr\ncos(kr \u2212 l\u03c0\n2 )\n,\nnl (kr) \u2192 \u2212\nkr\ne+ikr\n(1)\nhl (kr) \u2192 (\u2212i)l+1\n,\nkr\ne\u2212ikr\n(2)\nhl (kr) \u2192 (+i)l+1\n.\nkr\njl (kr) \u2192\n\n(201a)\n(201b)\n(201c)\n(201d)\n\nExamining the form of the Sommerfeld radiation conditions, we see that, asymptotically as k\u03b6 \u2192 \u221e,\nany vector potential \u03c8(\u03b6; \u03c9) (not necessarily a source-free solution) may be locally decomposed into its\nincoming and outgoing components on the spherical surface \u2202B(\u03b6) by the projections:\n\u0010\n\u0011\n\u2202\n\u03c8 out (\u03b6; \u03c9) \u2192 12 1 \u2212 ki \u2202\u03b6\n\u03c8(\u03b6; \u03c9),\n(202a)\n\u0010\n\u0011\n\u2202\n\u03c8(\u03b6; \u03c9).\n(202b)\n\u03c8 in (\u03b6; \u03c9) \u2192 21 1 + ki \u2202\u03b6\nEquipped with these results, it is straightforward to show that for any solution \u03c8 \u2208 Hout \u2295 Hin , the\noutgoing power spectral density is given by\nZ\n\u0002\n\u0003\ni\u03c9\nout\n\u2202\nd2 \u03c3 \u03c8 out *(n\u0302*\u2202)\u03c8 out\u2217 \u2212 \u03c8 out\u2217 *(n\u0302*\u2202)\u03c8 out\nP\n[\u03c8\n](\u221e;\n\u03c9)\n=\nlim\n\u2202\u03c9 EM\n\u03b62 \u2192\u221e 2\n\u2202B(\u03b62 )\n\n= lim\n\n\u0014\n\n= lim\n\n\u0014\n\n\u03b62 \u2192\u221e\n\n\u03b62 \u2192\u221e\n\ni\u03c9\n8\n\nZ\n\n\u0002\nd2 \u03c3 (1 \u2212\n\ni \u2202\n\u2202\nk \u2202\u03b6 )\u03c8*( \u2202\u03b6\n\n\u2212\n\n\u2217\ni \u22022\nk \u2202\u03b6 2 )\u03c8\n\n\u2202B(\u03b62 )\n\ni\u03c9 2\n\u03b6\n8 2\n\nZ\n\nd\u03c6\n\nZ\n\n\u0002\n\nd\u03b8 sin \u03b8 (1 \u2212\n\n\u2202\ni \u2202\nk \u2202\u03b6 )\u03c8*( \u2202\u03b6\n\n\u0015\n\u0003\n\u2212\n\n+ c.c\n\u2217\ni \u22022\nk \u2202\u03b6 2 )\u03c8\n\n(203)\n\n\u0003\n\n\u0015\n\n+ c.c,\n\n\f35\nwhich, after a little algebra, reduces to the inner product over the outgoing multipole coefficients:\ni\nX h E (out)\n2\n2\nM (out)\nout\n\u2202\nP\n[\u03c8\n](\u221e;\n\u03c9)\n=\n= (\u03c8 out (\u03c9) , \u03c8 out (\u03c9))out \u2265 0,\n(204)\n\u03c8\n(\u03c9)\n+\n\u03c8\n(\u03c9)\nEM\nlm\nlm\n\u2202\u03c9\nlm\n\nwith equality (vanishing outgoing power) in the last step if and only if \u03c8 out (\u03b6; \u03c9) vanishes identically.\nSimilarly, we find\n\u2202\n\u2212 \u2202\u03c9\nPEM [\u03c8 in ](\u221e; \u03c9) = (\u03c8 in (\u03c9) , \u03c8 in (\u03c9))in \u2265 0,\n\n(205)\n\nso we may write\n(\u03c8(\u03c9) , \u03c8(\u03c9)) \u2261 (\u03c8 out (\u03c9) , \u03c8 out (\u03c9))out + (\u03c8 in (\u03c9) , \u03c8 in (\u03c9))in\n=\n\n=\n\nout\n\u2202\n\u2202\n](\u221e; \u03c9) \u2212 \u2202\u03c9\nPEM [\u03c8 in ](\u221e; \u03c9)\n\u2202\u03c9 PEM [\u03c8\nout\n\u2202\n\u2202\n](\u221e; \u03c9) + \u2202\u03c9\nPEM [\u03c8 in ](\u221e; \u03c9)\n\u2202\u03c9 PEM [\u03c8\n\n(206)\n.\n\nThe inner products previously introduced for Hout and Hin , and Hout \u2295 Hin are just equal, respectively,\nto the (scaled) outgoing power spectral density, the absolute value of the incoming spectral density, and\nthe magnitude of total (not net) in-flowing and out-flowing power spectral density, passing through an\narbitrarily remote boundary somewhere outside the support of the (real or effective) sources. Choosing\n\u03c8 = \u03c7j , the relations (204) and (205) provide an explicit verfication of (195). As an aside, we note that\nthese separate incoming and outgoing power spectral densities and their (incoherent) sum, are often of\n\u2202\nmore physical interest than the net power \u2202\u03c9\nPEM [\u03c8](\u221e; \u03c9). For UV and lower frequencies, detectors\n(such as photomultipliers or solid state photoelectric devices) are typically directionally sensitive, in\nthe sense of an acceptance solid angle \u03a9 \u2264 2\u03c0, so measurements of the power in the radiation \u03c8 will\n\u2202\n\u2202\nPEM [\u03c8 out ](\u221e; \u03c9) or \u2202\u03c9\nPEM [\u03c8 in ](\u221e; \u03c9) , depending on\ntypically reveal something closer to either \u2202\u03c9\nthe orientation, (or some fraction thereof, with less than full 4\u03c0 solid-angular coverage of the localized\n\u2202\nsource), rather than \u2202\u03c9\nPEM [\u03c8](\u221e; \u03c9). In the X-ray regime, shielding is difficult and detectors are often\nnot directionally sensitive, and the response will likely depend on the total fluence into the detector\n\u2202\n\u2202\n\u2202\nvolume, i.e., on \u2202\u03c9\nPEM [\u03c8 out ](\u221e; \u03c9) + \u2202\u03c9\nPEM [\u03c8 in ](\u221e; \u03c9) rather than \u2202\u03c9\nPEM [\u03c8](\u221e; \u03c9).\nIn a similar fashion, we may formally express the spectral density of mechanical work in terms of the\nmultipole coefficients for the exact radiation a and the homogeneous approximant \u03c7, by using (188),\nchoosing a spherical boundary \u2202B(\u03b62 ) and letting \u03b62 \u2192 \u221e. After the algebraic dust settles, we find\nX\n\u2217 M\n\u2202\n\u2212 21 \u2202\u03c9\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9) = Re\n[\u03c7El m (\u03c9)\u2217 aEl m (\u03c9) + \u03c7M\nl m (\u03c9) al m (\u03c9)]\n(207)\nlm\nout\n= Re (\u03c7 (\u03c9) , a(\u03c9))out\nIn effect, we have managed to re-express the three-dimensional, \"volume\" inner product hj(\u03c9)|a(\u03c9)i in\nterms of the two-dimensional, \"boundary\" inner product (\u03c7out (\u03c9) , a(\u03c9))out . If we choose \u03c7 = \u03c7j , then\nby applying (204), the power spectrial density in the form (207) is seen to satisfy (196) explicitly.\n\nE.\n\nVariational Principle\n\nOur general variational principle follows directly from the nonnegative-definiteness of the operator K(\u03c9),\ni.e., equation (173), and the above energy conservation considerations. Re-tracing the standard proof of\nthe Cauchy-Schwarz inequality, we find that, with a little extra care, it goes through almost unchanged if\nwe replace the positive definite inner product with a positive-semidefinite pseudo-product. In particular,\nwith the bilinear form associated with K(\u03c9), one can show\n2\n\n|hg(\u03c9) |K(\u03c9)| g \u2032 (\u03c9)i| \u2264 hg(\u03c9) |K(\u03c9)| g(\u03c9)i hg \u2032 (\u03c9) |K(\u03c9)| g \u2032 (\u03c9)i ,\n\n(208)\n\nwith strict equality if and only if there exist constants \u03b4, \u03b4 \u2032 , \u03b40 \u2208 C, not all zero, and a non-radiating\nsource g0 (\u03b6; \u03c9) which is not identically zero but is otherwise arbitrary, such that\n\u03b4 g(\u03b6; \u03c9) + \u03b4 \u2032 g \u2032 (\u03b6; \u03c9) + \u03b40 g0 (\u03b6; \u03c9) = 0.\n\n(209)\n\n\f36\nWe also have, for any complex number c \u2208 C, the inequalities\nRe[c] \u2264 |Re[c]| \u2264 |c| ,\n\n(210)\n\nwith overall equality if and only if c is real and nonnegative. Choosing g \u2032 = j\u22a5 (\u03b6; \u03c9) to be the solenoidal\nsource responsible for the actual radiation a(\u03b6; \u03c9) and g = g\u22a5 (\u03b6; \u03c9; \u03b1) to be an effective source corresponding to a solenoidal, source-free trial vector field \u03c7(\u03b6; \u03c9; \u03b1) depending on certain variational\nparameters collected in the vector \u03b1, these inequalities yield:\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1) \u2264\n\u2212 21 \u2202\u03c9\n\n1\n2\n\n\u2264\n\n\u0002\n\nwith overall equality assuming\n\n\u2202\n\u2202\u03c9 Pmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1)\n\u00031/2 \u0002 \u2202\n\u00031/2\nout\n\u2202\n,\n\u2202\u03c9 PEM [\u03c7 ](\u03b62 ; \u03c9; \u03b1)\n\u2202\u03c9 PEM [a](\u03b62 ; \u03c9)\n\n\u2202\n\u2202\u03c9 PEM [a](\u03b62 ; \u03c9)\n\n(211)\n\n6= 0, if and only if\n\n\u03c7out (\u03b6; \u03c9; \u03b1) \u221d a(\u03b6; \u03c9).\n\n(212)\n\n\u2202\n(In the trivial case where \u2202\u03c9\nPEM [a](\u03b62 ; \u03c9) = 0, equality is achieved trivially for \u03c7(\u03b6; \u03c9) = 0 or indeed\nfor any \u03c7(\u03b6; \u03c9) which is Hilbert space orthogonal to j\u22a5 (\u03b6; \u03c9).)\n\nIn practice, we can obtain an actual variational approximation with one of two different but ultimately\nequivalent procedures, each arriving at the same final result when optimizing over equivalent families of\nT\ntrial solutions. In the first approach, we may partition the variational parameters as \u03b1 = (\u03b70 , \u03b80 , \u03b1\u2032 ) ,\nT\n\u2032\n\u2032\n\u2032\nwhere \u03b1 = (\u03b11 , \u03b12 , . . . , ) , and consider a restricted family of solenoidal, homogeneous trial solutions\nv(\u03b6; \u03c9; \u03b1\u2032 ) normalized to unit power:\nout\n\u2202\n](\u03b62 ; \u03c9; \u03b1\u2032 )\n\u2202\u03c9 PEM [v\n\n= 1,\n\n(213)\n\nor really to any conveniently-chosen but constant value. (Recall that this power is independent of the\n\u2202\nPmech [\u03b5v \u22a5 ; j](\u03c9; \u03b1\u2032 ) for fixed\nprecise choice of surface V (\u03b62 ) as long as \u03b62 > \u03b61 .) We then maximize \u2202\u03c9\noutput power, in order to determine the optimal parameter values \u03b1\u0303\u2032 = \u03b1\u0303\u2032 [j](\u03c9) and therefore the\nrelative shape (spatial profile and polarization) of the radiation. Once the relative profile is determined,\nwe then renormalize this trial solution, taking\n\u03c7(\u03b6; \u03c9; \u03b1\u0303) = \u03b7\u03030 ei\u03b8\u03030 v(\u03b6; \u03c9; \u03b1\u0303\u2032 ),\n\n(214)\n\nfor some real phase \u03b8\u03030 , 0 \u2264 \u03b80 < 2\u03c0, and nonnegative amplitude \u03b7\u03030 \u2265 0. To maximize the mechanical\nwork term, the overlap integral (3D inner product) between (scaled) solenoidal electric field and current\ndensity must necessarily be real and negative, so \u03b8\u03030 is chosen so as to ensure\ni\nh\n\u2212 21 Re e\u2212i\u03b8\u03030 h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1\u0303\u2032 )|j(\u03c9)i \u2265 0\n(215a)\ni\nh\n(215b)\nIm e\u2212i\u03b8\u03030 h\u03b5\u03c7 \u22a5 (\u03c9); \u03b1\u0303\u2032 |j(\u03c9)i = 0.\n\nFinally , the positive amplitude \u03b7\u03030 > 0 is chosen to ensure energy balance between the power (spectral\ndensity) in the approximate outgoing fields and the work which would be done on these fields, if present\nin the region of the sources, by those actual sources:\n\u2202\n\u2212 21 \u03b70 e\u2212i\u03b8\u03030 h\u03b5\u03c7 \u22a5 (\u03c9)|j(\u03c9)i = \u03b702 \u2202\u03c9\nPEM [v out ](\u03b62 ; \u03c9; \u03b1\u0303),\n\n(216)\n\nor\n\u03b7\u03030 =\n\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1\u0303\u2032 )\n\u2212 12 \u2202\u03c9\n\u2202\nout\n\u2202\u03c9 PEM [\u03c7 ](\u03b62 ; \u03c9; \u03b1\u0303)\n\n.\n\n(217)\n\nNote that under the assumptions of energy conservation given the sources, the overall amplitude, set by\n\u03b7\u03030 , is uniquely determined, and the overall phase \u03b8\u03030 is determined modulo 2\u03c0, because the mechanical\nwork done on/by the sources is linear in the fields, but the radiated power is quadratic in the fields.\nAs in the paraxial case, we can also interpret this as a maximization of the small-signal, no-recoil gain\n\n\f37\nwhich would be experienced by the trial field if it were to be incident on the sources. Upon substituting\nback into the Cauchy-Schwarz inequality, canceling common terms, and squaring, we deduce\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1\u0303) \u2264\n\u2212 12 \u2202\u03c9\n\nout\n\u2202\n\u2202\u03c9 PEM [\u03c7 ](\u03b62 ; \u03c9; \u03b1\u0303),\n\n(218)\n\nwith equality if and only if\n\u03c7out (\u03b6; \u03c9; \u03b1\u0303) = a(\u03b6; \u03c9),\n\n(219)\n\nZ\n\n(220)\n\nor equivalently,\n\u03c7(\u03b6; \u03c9; \u03b1\u0303) = \u03c7j (\u03b6; \u03c9) =\n\nd3 \u03b6 \u2032 D(\u03b6; \u03b6 \u2032 ; \u03c9) j\u22a5 (\u03b6; \u03c9).\n\nThus, we see that the variational approximation \u03c7out (\u03b62 ; \u03c9; \u03b1\u0303) may also be obtained more directly from\na simultaneous optimization, with respect to all parameters in \u03b1, of the outgoing power, subject to the\nconstraint of energy conservation:\nh\ni\n\u2202\nPEM [\u03c7out ](\u03b62 ; \u03c9; \u03b1)\n(221a)\n\u03b1\u0303 = arg max \u2202\u03c9\n\u03b1\n\ns.t. \u2212\n\n1 \u2202\n2 \u2202\u03c9 Pmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1)\n\n=\n\nout\n\u2202\n\u2202\u03c9 PEM [\u03c7 ](\u03b62 ; \u03c9; \u03b1).\n\n(221b)\n\nThis is our desired result. As anticipated, we have arrived at a variational principle which holds in the\ngeneral, non-paraxial case, which is exactly analogous to that found previously in the paraxial limit.\nUnfortunately, there seems to be no simple way to express the constrained optimization problem (221)\nas an unconstrained maximization of a ratio between the mechanical work and radiated power (or some\nfunctions thereof).\nIt is also instructive to also see how this all works out explicitly in the spherical wave basis. Applying\nthe usual Cauchy-Schwarz inequality directly in Hout , and using equations (204) and (207), we have\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1) = Re (\u03c7out (\u03c9; \u03b1) , a(\u03c9))out \u2264 |(\u03c7out (\u03c9; \u03b1) , a(\u03c9))out |\n\u2212 21 \u2202\u03c9\n1/2\n\n1/2\n\n\u2264 (\u03c7out (\u03c9; \u03b1) , \u03c7out (\u03c9; \u03b1))out (a(\u03c9) , a(\u03c9))out\n=\n\n(222)\n\nout\n1/2 \u2202\n1/2\n\u2202\n,\n\u2202\u03c9 PEM [\u03c7 ](\u221e; \u03c9)\n\u2202\u03c9 PEM [a](\u221e; \u03c9)\n\nwith overall equality if and only if \u03c7out (\u03c9; \u03b1) = \u03ba(\u03c9) a(\u03c9) for some positive real scalar \u03ba(\u03c9) > 0, or\nequivalently when\naEl m (\u03c9)\naM (\u03c9)\n1\n= Ml m\n=\n> 0.\n\u03c7l m (\u03c9; \u03b1)\n\u03c7l m (\u03c9; \u03b1)\n\u03ba(\u03c9)\nE\n\n(223)\n\nfor all mutlipole coefficients of a(\u03b6; \u03c9). Imposing the additional energy conservation relation on\n\u03c7(\u03b6; \u03c9; \u03b1), this becomes\n\u2202\nPmech [\u03b5\u03c7 \u22a5 ; j](\u03c9; \u03b1) \u2264 PEM [a](\u221e; \u03c9)\n\u2212 21 \u2202\u03c9\n\n(224)\n\nwith equality if and only if \u03c7out (\u03b6; \u03c9; \u03b1) = a(\u03b6; \u03c9). Because in practice we will not have knowledge of\nthe actual multipole expansion coefficients for a in situations where we are resorting to a variational\napproximation, this \"angular-representation\" or \"boundary-value\" formulation is not directly applicable\nfor calculation, but it does lead directly to the relevant power inequality without any worries about a\nsemidefinite or \"pseudo\" inner product. We also see that the MPVP follows immediately as a consequence\nof the minimum distance property of orthogonal projectors in these multipolar Hilbert spaces: the\nvariational approximation \u03c7(\u03b6; \u03c9; \u03b1\u0303) is simply that which minimizes the distance to the actual solution:\ni\nh\n1/2\n\u03b1\u0303 = arg min (a(\u03c9) \u2212 \u03c7(\u03c9; \u03b1) , a(\u03c9) \u2212 \u03c7(\u03c9; \u03b1))\n\u03b1\n\nwithin the considered family of solenoidal, source-free, trial wavefields.\n\n(225)\n\n\f38\nV.\n\nDISCUSSION\n\nHere we assess advantages and limitations of the MPVP, briefly consider possible variations and extensions, and compare the method to other variational techniques commonly encountered in electromagnetic\ntheory, in particular those which have been used for paraxial radiation problems, laser-plasma interactions, and FEL-type devices.\n\nA.\n\nSummary\n\nThe derived MPVP (221), valid in the paraxial or non-paraxial regimes, says, in effect, that classical\n(accelerating) charges spontaneously radiate \"as much as possible,\" consistent with energy conservation. By spontaneous we mean that charges are assumed to follow prescribed classical trajectories\ndetermined by the external fields and possibly (averaged) quasi-static self-fields, but are not affected by\nrecoil/radiation-reaction, multiple scattering, absorption, or other feedback from the emitted radiation\n(although arbitrary pre-bunching due to previously-imposed or radiated fields may be included, if it can\nbe characterized). The sources are assumed to be localized in space, so that the far-field (i.e., radiation\nzone , or wave zone) is defined, and at least weakly localized in time, so that Fourier transforms (i.e.,\nfrequency-domain representations) of the current density exist. In turn, the radiation, once emitted\nby any part of the source, propagates as in free space, without further scattering or absorption. The\noptimized trial mode-shape (or more accurately, the outgoing component thereof) is then the best guess,\nwithin the manifold of possibilities allowed by the adjustable parameters (\u03b1), of the exact radiation field\nprofile radiated by those prescribed sources, and the optimized outgoing Poynting flux yields a lower\nbound on the actual spontaneously-radiated power spectral density at the frequency under consideration\n(apart from any numerical/roundoff errors in the computation). The approximation will improve monotonically as additional independent parameters are included to allow for more general envelope shapes.\nAs with other variational principles, the relative error in the value of the variational functional (here,\nthe power) at the stationary point is generally smaller than the error in the parameterized trial function\n(here, the radiation profile). The adjustable parameters may appear linearly or non-linearly in the trialfunctions; if they are taken to be the linear expansion coefficients in a sum over orthogonal modes, then\nthe MPVP is equivalent to a truncated basis-set approach. (In the paraxial case, \"outgoing\" implies\npropagation nearly along the optic axis away from the localized sources, defining the \"downstream\" or\n\"post-source\" direction, while \"incoming\" means propagating towards the sources from the upstream\ndirection. In this case, say, a right-going pulse has both ingoing and outgoing components. In the general non-paraxial case, \"outgoing\" implies wavefronts which, at least asymptotically, diverge in time and\npropagate away from the localized sources, while \"incoming\" denotes the reverse, i.e., asymptotically\nconverging wavefronts propagating towards the sources.)\nThis variational principle can be variously interpreted according to one's tastes or application. As\nwe have seen, the best variational approximation maximizes the radiated power consistent with the\nconstraint that this energy could have arisen from work extracted from the actual sources. It also\nminimizes a Hilbert-space distance between the actual fields and the parameterized family of solenoidal,\nfree-space radiation fields, and in many cases may actually be regarded as an orthogonal projection into\nthis manifold of trial solutions. It also maximizes, for each frequency component, the spatial overlap,\nor physical resemblance, between the actual current density and the trial fields, when the latter are\nextrapolated back into the region of the sources assuming source-free propagation. Equivalently, one can\nsay the optimal free-space field profile is that which, if it actually were to be incident on the sources,\nwould maximally couple to the given sources and would experience maximal small-signal gain, and\nfurthermore the virtual gain delivered would be equal to the estimated power spontaneously radiated.\nWhatever the shape of the trial function, and whether the variational parameters appear linearly or\nnon-linearly, after optimization this profile may be regarded as one of a complete set of solenoidal basis\nfunctions solving the source-free wave equation. After introducing an inner product associated with\nthe radiated power (not energy), these basis functions can be orthonormalized via a Gram-Schmidt\nprocedure, leaving the original trial function unchanged. Bessel's inequality then confirms that the\noutgoing power radiated in (the outgoing component of) this one mode can be no greater than the total\noutgoing power radiated in all the modes. All this is obvious. What is perhaps more surprising (if we do\n\n\f39\nnot think too hard about the Fundamental Theorem of Calculus or its multidimensional generalizations)\nis that we can exactly relate the outgoing power radiated in the far-field to the \"virtual\" work which\nwould be performed by the localized sources on the \"source-free extrapolant\" of this radiation field, as\nif it and it alone were present in the region of the source, i.e., to the overlap integral between source\nand extrapolated electric field, even though the extrapolated field may not closely resemble the actual\nemitted field there, as it must necessarily solve the inhomogeneous wave equation. The factor of 12\nin the resulting conservation constraint emerges in order to avoid double-counting in the energetics.\nThe radiated power in the outgoing component of the variational approximation is being related to the\nmechanical power which would be delivered by the sources to the full source-free fields, if they were\nactually present in the region of the sources, rather than the actual, inhomogeneous fields; and, any\nwave-field satisfying the source-free wave equation everywhere in space must have the power in each\noutgoing mode exactly balanced by that in a corresponding incoming mode, or else singularities would\narise somewhere in space. (Without any sources, in the paraxial case, radiation observed to emerge\nfrom, say, the right side of any longitudinal interval must have previously traveled into that interval\nfrom the left. In the free-space non-paraxial case, analogous conclusions can be drawn for plane waves\ntraveling along any chosen direction, or, thinking in terms of multipole radiation, it is necessary that\nany diverging spherical wave must be matched to a converging spherical wave to avoid a singularity at\ntheir common center of wavefront curvature.)\n\nB.\n\nAssessment\n\nAgain, the present approach involves approximation of the actual radiation fields by trial modes which\nare solenoidal and satisfy the homogeneous (source-free) wave equation. As we are primarily interested\nin the net radiation from the given sources observed in the free-space region beyond the sources, it is\nappropriate to use solutions of the source-free equation there, but then it is natural, efficient, and even\nalmost inevitable, in the context of an approximation scheme, to effectively extrapolate the fields back\ninto the support of the sources by free-space propagation. (Otherwise, if we could somehow propagate\naccording to the actual dynamics, we would not need to resort to any approximation \u2013 but we would also\nbe carrying around unneeded information about the near-fields.) In the paraxial limit, these free-space\nsolutions are uniquely specified by the carrier frequency and the (complex) profile in any transverse\nplane, which can be decomposed into a convenient, countable set of modes consisting of the eigenmodes\nof some quantum-like operator(s). In the general case the solutions are more complicated, but from the\nspherical wave expansion, we know at least that they also form a separable Hilbert space, parameterized\nby the multipole expansion coefficients. Because there is no known closed-form, analytic solution for\na general focused radiation beam outside the paraxial approximation, the formalism and variational\nprinciple are probably of most use in the paraxial case, although may also be applied, with little added\ncomplication, to cases where the radiation consists of a superposition of multiple beams, each paraxial\nindividually, but with sufficiently divergent directions to violate overall paraxiality, or to cases where\nhigher-order terms in the generalized paraxial (i.e., diffraction-angle) expansion are included to describe\na moderately-collimated beam.\nThe output \u03c7(\u03b6; \u03c9; \u03b1\u0303) of the MPVP is therefore actually better considered a variational approximation\nto the source-free \"embedding\" or \"extrapolation\" \u03c7j (\u03b6; \u03c9) rather than to the actual outgoing vector\npotential a(\u03b6; \u03c9). If the radiation is sufficiently directional, then the outgoing component \u03c7out (\u03b6; \u03c9; \u03b1\u0303)\nmay be determined simply by restricting attention to some finite solid angle. In the most general\ncase, where the \"spurious\" incoming radiation may overlap with the \"physical\" outgoing radiation, it is\nmore difficult to disentangle \u03c7out and \u03c7in at an arbitrary position. If the spherical wave expansion is\nknown, then the outgoing projection may be easily determined everywhere in space, but direct use of\nthe the spherical-waves as the variational basis is not generically expected to prove convenient. (This\nwould correspond to just using a truncated multipole expansion for the radiation.) In the far-field\nlimit k\u03b6 \u2192 \u221e, at least, the outgoing component may be determined easily by using the Sommerfeld\nprojections (202).\nBecause of these difficulties, and remaining mindful of the proportionality between the calculated power\ndelivered from the source j\u22a5 (\u03b6; \u03c9) to the radiation fields corresponding to the vector potential a(\u03b6; \u03c9)\nor to the fields of its source-free approximant \u03c7(\u03b6, \u03c9), one might be tempted to apply the variational\n\n\f40\nmethod directly (just without the extra factor of 12 ) to outgoing, solenoidal solutions of some convenient inhomogeneous or homogeneous Helmholtz equation. However, purely outgoing-wave, free-space\nsolutions cannot exist everywhere in space, and will inevitably possess one or more singularities in the\nvicinity of the sources, preventing calculation of the required mechanical work integrals. Furthermore,\nany solenoidal vector field whatsoever, say \u03c8(\u03b6; \u03c9), is trivially the solution to some inhomogeneous\nHelmholtz equation for some boundary conditions and some solenoidal source, namely, for those boundary conditions satisfied by \u03c8 itself, and for a solenoidal source given by \u2212(\u2202 2 + \u03c9 2 )\u03c8. Without further\nconstraints, this class of trial solutions is simply too general to be useful. If we naively apply the MPVP\nusing homogeneous trial functions, the method will converge not to a but to something proportional\nto j, since, for given norm, no other vector field can have greater overlap with j than a multiple of j\nitself. By using the source-free solutions, we effectively regularize the problem, so that we can converge\nto something which maximizes the overlap with the source under the assumption that the trial look like\na radiation field, and not a current density.\nIn any case, the method requires not only the parameterization of trial modes but the calculation of\ninner products between these trial modes and the current density, or else some other, problem-specific,\nmeans to determine the absolute level of the power, either analytically, in terms of the free parameters,\nor numerically and indeed repeatedly, as the parameters are varied in search of the maximum. One\ncan easily imagine counter-examples where it is simply easier to work directly with the Li\u00e9nard-Wichart\npotentials or corresponding expressions for the fields, than use the variational principle.\nWe also have some options (or rather, trade-offs) in handling stochastic sources. So far, we have assumed\na specific, prescribed, deterministic current density j(\u03b6; \u03c4 ), but in practice we must contend with statistical uncertainty in the exact electron trajectories in any one realization, meaning j(\u03b6; \u03c9) is in principle\nstochastic, with statistical properties determined by the phase space distribution of the particle beam (in\nthe reduced six-dimensional phase space, if we may neglecting direct two-body or higher-order interactions, but in an even higher-dimensional phase space if particle-particle correlations are to be included).\nIn certain cases, we can get by with using an averaged or course-grained current directly as the source,\nwithout need for further probabilistic considerations. In the Vlasov equation, for example, the fields that\nappear are self-consistent mean fields, i.e., solutions to Maxwell's equations for the averaged sources.\nThe exact fields are linear in the sources, so it makes no difference in the end result whether we average\nthe currents first and then calculate the resulting fields, or calculate the fields for a general instance of\nthe currents and then average the result \u2013 the averaging procedure will commute with the convolution\nover the Green function. (Pragmatically, the former approach will almost always be more efficient if the\naverage is all we need, since the random variables determining the stochastic shape of the current need\nnot carried through the convolution, but the latter approach allows calculation of higher-order correlations or moments.) When using the MPVP to approximate the radiation, the averaged trial fields will\nequal the trial fields from the averaged sources if the variational parameters appear as linear expansion\ncoefficients in a basis-set expansion, but not, in general, if they occur non-linearly in the trial wavefields.\nConvolution is a linear process, but optimization is in general a nonlinear one.\nUnfortunately, it is often the case that we desire to estimate the fields from given sources, then calculate\nmoments, rather than to determine the fields from averaged sources. This is particularly true of spontaneous wiggler radiation, where the radiation is almost entirely \"fluctuational,\" both in the sense that\nthe squared-magnitude of the average field is small compared to the average of the squared-magnitude,\nand in that the relative variance in the spectral intensity approaches 100% in each sufficiently narrow\nfrequency-band for radiation from sufficiently long, unbunched electron beams. At least second-order\nmoments are needed to estimate the power spectrum and transverse coherence properties, and fourthorder moments are necessary if we wish to to estimate the uncertainty in the estimates for these spectra\nor coherence functions. Statistical estimates for the power spectral density, based on the moments of\nthe MPVP trial fields, cannot in general be guaranteed to be lower bounds, as in the deterministic case.\nBefore even calculating moments, we may either approximate the radiation fields from the total current\ndensity using the MPVP, or else apply the MPVP separately to each particle trajectory or family of\ntrajectories, then superimpose the resulting variational fields. If identical, linear basis-sets are used\nin the expansions for each particle's radiation, identical results will be achieved (although the amount\nof calculation or computational effort may differ), but if nonlinear variational parameters are used or\neven if different truncated linear basis sets are used for different particles, the two approaches will be\ninequivalent.\n\n\f41\nA simple example should clarify the issues. Suppose we seek to approximate the wiggler radiation\nfrom some electron beam with negligible normalized energy spread \u03b3\u03b4 \u226a 1 but some non-zero transverse\nemittance \u01eb > \u03bb0 , where \u03bb0 \u223c 2\u03b31 2 \u03bbu (1+ 12 a2u ) is the central wavelength of the wiggler radiation in the lab\nframe, \u03bbu is the wiggler wavelength, and au is the normalized wiggler strength parameter. For radiation\n1\nfrom a single on-axis electron, confined within the relative bandwidth \u03b4\u03bb\n\u03bb0 \u223c Nu , where Nu is the number\nof wiggler periods, we know the radiation is approximately diffraction-limited, with characteristic angle\n\u03b4\u03b8D \u223c \u221aN1 \u03b3 and a waist located at the midpoint of the wiggler. However, the radiation for the beam as\nu\n\na whole will not be diffraction-limited, but will have a transverse degree of coherence \u0393coh \u22a5 \u223c\ndue to averaging, or convolution, over the transverse particle distribution.\n\n\u03bb0\n4\u03c0\u01eb\n\n< 1,\n\nSuppose first we use the total current density as source, and use paraxial Gauss-Hermite or GaussLaguerre modes as trial solutions, with optic axis coinciding with the wiggler axis. If we attempt\nto include, for \u03bb \u2248 \u03bb0 , only the fundamental Gaussian mode with undetermined waist size w0 and\nlocation \u03bew , then, regardless of the exact values of the optimized parameters, the approximation cannot\nsimultaneously predict both the transverse size and angular divergence with accuracy, or equivalently,\nthe partial transverse incoherence cannot be adequately captured, since we are putting all the power in\na single, diffraction-limited transverse mode. In fact, we expect that we must include at least n\u22a5 \u223c 4\u03c0\u01eb\n\u03bb0\ndiffraction-limited modes to resolve the transverse coherence, even if the average transverse intensity\nprofile continues to look Gaussian. If the particle phase space distribution function is also taken to be\nGaussian, then the needed overlap integrals in the MPVP may be calculated analytically.\nAlternatively, we could decompose the current density into contributions from each electron, and employ\na single Gaussian mode for each, only with the optic axis aligned along the average single-particle\ntrajectory determined by its spatial and angular displacement from the reference orbit. The needed\noverlap integrals in this case are easily perfomed, at least for typical values of \u03bb0 , \u03b3, and au , where\nthe transverse spatial extent of an electron orbit is small compared to w0 , but after determining the\nsingle-particle MPVP fields, each with a different propagation axis, they all must be superimposed to\ndetermine the full field. This can be done easily in the far-field so as to determine the angular spectrum,\nor at arbitrary positions, to a good approximation, provided the angular deviations for the electrons\nremain moderately small, i.e., \u2206\u03b8 . \u03b31 . The result will agree approximately, but not exactly, with the\nprevious approach. The details of a simplified version of this calculation will be presented in elsewhere.\n\nC.\n\nExtensions\n\nThe results derived here are restricted to radiation from localized sources otherwise propagating in\nvacuum, which includes the cases of charged particle beams in bending magnets or undulators, but it\nwould be desirable to extend applicability to more general radiation problems. Using the macroscopic\nMaxwell's equations, it should be straightforward to include a linear, dielectric background \u01eb0 (\u03c9) \u2265 0\nwhich is spatially homogeneous, but possibly frequency-dependent. This would be sufficient to handle\nmany \u010cerenkov radiation problems. To treat some forms of transition radiation and waveguide problems, piecewise-slowly-varying spatial variations in the dielectric tensor and the possibility of (perfectly)\nconducting boundaries should both be included, but in general the \"source-free\" solutions become difficult to calculate and parameterize \u2013 a single planar jump, or other simple geometries, might still be\ntractable.\nOne important class of geometries for which this formalism should be almost immediately applicable is\nthat of conducting-wall and/or dielectric waveguides with translational symmetry along the optic axis.\nIn such circumstances, it is well known [1, 5, 39, 40] that such systems share much of the mathematical\nHilbert-space structure as that elaborated above for paraxial radiation \u2013 in particular, solenoidal modes\nwhich are uniquely specified by their cross-section in any transverse plane, and which are orthonormalizable with respect to the natural L2 /Euclidean inner product in that plane. (However, these modes\nare not complete for the near-fields, as discussed, for example, in [41].) In addition, it is easily shown\nthat, in any such waveguides, the power in any source-free, propagating mode, measured sufficiently far\ndownstream from a localized source inserted inside the waveguide, can be related to the overlap integral\nbetween the actual current density of the source and the electric field profile of this free-space mode\nextrapolated back into the support region of the sources as if no sources were present. Modifications\n\n\f42\ndue to finite conductivity effects might be then treated perturbatively. Again, this is all familiar, and is\nexactly analogous to our basis-set expansion technique. What is perhaps not widely appreciated is that\nthe Cauchy-Schwarz inequality then allows one to transform this basis-set approach into a maximum\nprinciple, where the exact form of the normal modes are not needed.\nAttempts to use a more general complex-valued dielectric tensor or index of refraction in order to incorporate linear loss or gain will encounter fundamental difficulties. Our derivations have exploited the fact\nthat the free-space retarded and advanced Green functions are just related by complex conjugation in the\nfrequency domain, but with any dissipation or gain, this time-reversal symmetry will be lost. Ideally, one\nwould like to fully generalize the treatment to allow for dielectric tensors \u01eb\u03bc\u03bd (x, t; \u03c9) with any frequency\ndispersion consistent with the Kramers-Kroning relations and/or piecewise-slowly-varying spacetime dependence (inhomogeneity), and possibly anisotropy, in order to model the effects of essentially arbitrary\nconducting or dielectric boundaries, obstacles, or passive optical elements, such as lenses, prisms, polarizers, waveplates, apertures, waveguides, cavities, transmission lines, fibers, gratings, etc., either ideal or\nlossy, but it not even clear whether this is possible, or if so, practical. Many variational techniques have\nbeen used for waveguides, cavities, and other structures, but these are usually of a stationary, rather\nthan extremal, character, an important distinction which is examined below in Section V E. All of these\ndirections are left as open problems.\n\nD.\n\nConnections to Stimulated Emission\n\nOne is also naturally led to speculations as to whether similar ideas may be applied to stimulated\nemission. Naively, one might imagine some iterative procedure, where the approximated radiation,\nassuming given sources, is somehow used to deduce corresponding energy changes that must have taken\nplace in those sources, which leads to revised estimates for the radiation, and so on. It is not clear\nwhether this is applicable to any real problems, or even if it can converge to a self-consistent solution\ndescribing an active medium.\nHowever, results for the case of spontaneous emission from a classical particle beam may be of direct\nrelevance to the problem of stimulated emission, namely in the so-called small-signal regime where\nsaturation and depletion effects are ignored. In his celebrated 1917 quantum analysis of radiation [42],\nEinstein first classified the radiative processes involving photons (or really any bosons) into spontaneous\nemission of, stimulated emission by, and stimulated absorption of the photons by atoms or other material\nsources. By exploiting the fact that the matter and radiation can be in thermodynamic equilibrium,\nEinstein used the properties of blackbody radiation and the principle of detailed balance to establish the\nproportionalities between the intrinsic rates, within each mode, for each of these processes, as summarized\nin the famous A and B coefficients, results which must hold for arbitrary initial conditions, not just those\nconsistent with thermal equilibrium. Less widely appreciated is that these relations persist in a purely\nclassical limit of the matter and fields where Planck's constant h never appears, clearly discussed, for\nexample, by Beckefi in Chapter 2 of [43], and derived using somewhat different arguments in [44].\nAs a simple example, consider the case of radiation transport in an electron plasma, where direct manybody effects are neglected, and with an isotropic, single-particle momentum distribution function f (p),\nwhere p = kpk is the magnitude of kinetic momentum, and uniform density n0 over some region. (This\nmight also describe a long electron beam in its average rest frame.) Then, for each type of radiative\nprocess (or the aggregate of all processes), the spontaneous emission rate l\u03c9 defined as the power emitted\nin polarization \u00ea per unit volume of medium per unit bandwidth per solid angle in the direction of \u015d,\nmay be written as\nZ\nl\u03c9 [\u00ea; \u015d] = n0 d3 p \u03b7\u03c9 (p; \u00ea; \u015d)f (p),\n(226)\nwhere \u03b7\u03c9 (p; \u00ea; \u015d) is the single-particle, intrinsic emission coefficient, which is determined by the details of\nthe microscopic physics, but is independent of the particle distribution function or the incident radiation\nstate. The net absorption rate, i.e., bare stimulated absorption less stimulated emission, is given by\n\u03b1\u03c9 I\u03c9 , where the radiant brightness I\u03c9 is the incident power per unit area per unit solid angle per unit\n\n\f43\nbandwidth, and the absorption coefficient is given by\nZ\n8\u03c0c2\n\u2202\n\u03b1\u03c9 [\u00ea; \u015d] = \u2212 2 2 n0 d3 p \u03b7\u03c9 (p; \u00ea; \u015d) \u2202\u03b5\nf (p),\n(227)\nnir \u03c9\np\nwhere \u03b5 = \u03b5(p) = c2 p2 + m2 c4 is the particle energy, nir is the background index of refraction, and\n\u03b7\u03c9 (p; \u00ea; \u015d) is the same quantity that appears in the spontaneous emission. These results are completely\nclassical, as no factors of ~ anywhere appear. The dependence on the derivative of the distribution\nfunction is the only reminder that this expression represents the net difference between stimulated\nabsorption and emission. These connections between spontaneous and stimulated emission/absorption\nare essentially a generalized manifestation of the well-known fluctuation-dissipation theorem, which\nrelates the response of a system when perturbed to the spontaneous fluctuations which occur in the\nabsence of external perturbation [43, 44, 45].\nIn FEL physics, first described quantum-mechanically but now understood classically, such generalizations of Einstein's arguments are the basis for Madey's theorem in one-dimensional theory [46] and its\ngeneralizations to higher dimensions (see, for example, [44, 45, 47], or else [48] and references therein),\nwhere the gain curve (specifically, the relative change in intensity versus de-tuning) in the small-signal\nregime is proportional to the derivative of the spontaneous emission spectrum.\nGiven these connections, certain properties of the spontaneous wiggler radiation, or approximations\nthereof, can yield information about the stimulated emission, or gain, in the small-signal regime. Perhaps\nmore satisfying is the obverse relation, whereby our intuitions about stimulated emission provide the\nclearest justification and interpretation for the appearance of a maximum-power variational principle for\nclassical spontaneous emission. In situations with gain, we might naturally approximate the radiation\nprofile by that which maximizes the extraction of energy from the electrons to the laser. For example,\nthis is precisely the heuristic justification for the variational principle suggested in [49] for opticallyguided modes in FELs, where the fundamental mode is estimated by maximizing the imaginary part of\nthe effective wavenumber. If the radiation is to be estimated by one mode, the mode should be chosen\nto be whatever shape is expected to have the fastest growth (or slowest loss).\nIn fact, we saw above that the MPVP can be interpreted precisely in this manner \u2013 as finding the\nmode shape which, if actually incident, would maximally couple to the given sources, and furthermore\nthe \"virtual\" gain delivered would be equal to the estimated power spontaneously radiated. The only\nessential difference between our case, and say, Madey's theorem is that by taking completely prescribed\nsources, we implicitly assume that any radiation, once emitted by some part of the source, can then\npropagate to the far-field where it may interfere constructively or destructively with other radiation, but\ncannot cause any recoil in that source nor subsequently be re-scattered or absorbed by any other part\nof the source. So in fact we find a relationship between the spontaneous emission spectrum and that of\nthe bare stimulated emission, not the net response given by the difference between stimulated emission\nand absorption as in Madey's theorem.\n\nE.\n\nRelation to Lagrangian Formulation and Other Variational Approaches\n\nA survey of variational techniques in electrostatics, electrodynamics, and optics reveals that, at some\nfundamental level, they seem to derive from only a very few general concepts: Hamilton's principle for\nsystems derivable from a Lagrangian/action, energy conservation/optimization, electromagnetic reciprocity, and entropy maximization (for problems of a thermodynamic nature.) Of course these principles\nare interrelated \u2013 both energy conservation and reciprocity follow from the structure of the governing\nLagrangian, while entropy maximization usually relies on energy conservation or other dynamical invariants as constraints and automatically satisfies certain reciprocity relations \u2013 but nevertheless they\nremain useful and conceptually distinct organizational categories. Each variational principle may be\nfurther classified by whether it demands (generally constrained) optimality, or mere stationarity, of the\nrelevant function or functional.\nWe examine in turn the relevance or relation of each of these principles to the MPVP. Obviously the\nMPVP is most closely related to energy principles, although in the case of classical spontaneous radiation,\n\n\f44\nwe maximize the rate of energy transfer (power) in each spectral band, rather than, say, minimize\npotential energy as in electrostatics, or free energy in thermodynamics.\nEntropy maximization might be a useful technique to determine or approximate certain source distributions given only macroscopic thermodynamic constraints or other incomplete information, but is not\ndirectly relevant for the problem of finding the radiation from given deterministic sources, which is more\na problem of dynamics than thermodynamics. However, as we saw above, new connections and rationales\nare revealed by generalization of the arguments leading to Einstein's A and B coefficients to classical\nbeams or plasmas, and these arguments rely on the equilibrium properties of black-body radiation, even\nwhen the actual system of interest may be far from thermodynamic equillibrium.\nReciprocity-based variational principles are commonly used to approximate resonant frequencies in cavities or waveguides, impedances of cavities, transmission lines, apertures, or other structures, and scattering cross sections by conductors or dielectrics [2, 6, 50]. They can be suitably generalized to many\nsituations where the background medium is not necessarily homogeneous or isotropic. Despite superificial similarities between the MPVP and reciprocity-based techniques, a closer look reveals them to be\nquite distinct. Consider the solenoidal electric field \u03b5\u03c8 \u22a5 (\u03b6; \u03c9) derived from some Coulomb-gauge vector\npotential \u03c8(\u03b6; \u03c9), and any source j \u2032 (\u03b6; \u03c9), not necessarily that associated with \u03c8. For our purposes, we\nmay define the complex reaction of the field \u03b5a \u22a5 on the source j \u2032 as\nZ\nR[\u03b5\u03c8 \u22a5 , j \u2032 ] \u2261 d3 \u03b6 \u03b5\u03c8 \u22a5 (\u03b6; \u03c9)*j \u2032 (\u03b6; \u03c9) = h\u03b5\u03c8 \u22a5 (\u03c9)\u2217 |j \u2032 (\u03c9)i ,\n(228)\nWhich is similar to the original definition in [50], but involves only the solenoidal electric fields, and drops\nthe analogous terms involving the magnetic field and magnetization density, because we are working\nwith the microscopic fields from classical sources. Given any source j(\u03b6; \u03c9), let a(\u03b6; \u03c9) denote the\ncorresponding Coulomb-gauge, retarded vector potential, and let \u03c7(\u03b6; \u03c9) = \u03c7j (\u03b6; \u03c9) denote the closest\nhomogeneous approximant (i.e., that vector potential obtained by using j\u22a5 as an effective source in\nconvolution with the fundamental solution, rather than an actual source in convolution with the retarded\nGreen function); and define a\u2032 and \u03c7\u2032 in an analogous fashion for the source j \u2032 .\nBy using the symmetry properties of the Green functions, it is then straightforward to establish the\nRaleigh-Carson reciprocity relation for the inhomogeneous case:\nR[\u03b5a \u22a5 , j \u2032 ](\u03c9) = h\u03b5a \u22a5 (\u03c9)\u2217 |j \u2032 (\u03c9)i = h\u03b5a\u2032 \u22a5 (\u03c9)\u2217 |j(\u03c9)i = R[\u03b5a\u2032 \u22a5 , j](\u03c9),\n\n(229)\n\nand similarly for the homogeneous case:\nR[\u03b5\u03c7 \u22a5 , j \u2032 ](\u03c9) = h\u03b5\u03c7 \u22a5 (\u03c9)\u2217 |j \u2032 (\u03c9)i = h\u03b5\u03c7\u2032 \u22a5 (\u03c9)\u2217 |j(\u03c9)i = R[\u03b5\u03c7\u2032 \u22a5 , j](\u03c9).\n\n(230)\n\nSuch a quantity was introduced in [50] as a measure of \"reaction,\" or coupling, between the sources j and\nj \u2032 , and in many contexts a variety of physical observables such as fields or forces, impedances, etc., may\nbe proportional to or otherwise related to reactions. Despite resemblances, the complex self-reaction\nh\u03b5\u03c8 \u22a5 (\u03c9)\u2217 |j(\u03c9)i is distinct from the complex power h\u03b5\u03c8 \u22a5 (\u03c9)|j(\u03c9)i , because no complex conjugates\nappear in the overlap integral in the former case. (Adding to the potential for confusion, the imaginary\npart of the complex power is referred to as the \"reactive power,\" following the conventions of circuit\ntheory.) Said another way, the complex power is associated with a standard complex inner product,\nwhich is conjugate-symmetric and positive-definite, while the reaction is associated with a symmetric,\nbilinear form which is not a true inner product. Physically, the concepts are also distinct: energy\nconservation arises from the invariance properties of the full electromagnetic Lagrangian (including selfconsistent particle dynamics) under time-translations, while reciprocity arises from invariance under\ntime reversals. The real part of the complex power is of course proportional to the time-average (over\nan optical period) of the power exchanged between source and field. The real part of the reaction is\nactually proportional to the fluctuation about this average.\nThe concept of reaction is of interest precisely because of reciprocity properties like (229) or (230),\nand the possibilities for variational approximation that emerge, by demanding that all trial sources\n\"look\" the same to themselves as to the correct sources. For example, suppose we seek a trial-function\napproximation \u03c8\u0303 to the unknown vector potential \u03c8, given the actual source j. Let j\u0303 correspond to a\n\n\f45\nsource associated with \u00e3 (the existence of non-radiating sources implies non-uniqueness, which is of no\nconsequence here.) From a reaction point-of-view, we would like an approximation such that\nR[\u03b5\u03c8\u0303 \u22a5 , j\u0303](\u03c9) \u2248 R[\u03b5\u03c8 \u22a5 , j](\u03c9),\n\n(231)\n\nbut by assumption we have no tractable way of calculating the right-hand side, so instead that approximation is then \"best\" if we can impose the constraint\nR[\u03b5\u03c8\u0303 \u22a5 , j\u0303](\u03c9) \u2248 R[\u03b5\u03c8\u0303 \u22a5 , j](\u03c9).\n\n(232)\n\nIn fact, one can show that under this constraint, the reaction R[\u03b5\u03c8\u0303 \u22a5 , j](\u03c9) is then stationary for firstorder variations of \u03c8\u0303 about the actual solution \u03c8.\nNote that this leads to a stationarity condition, not an optimization condition. Because reaction and\npower are not equivalent, in general they lead to different variational principles. In the Method of\nMoments, which encompasses both the Finite-Element and the Ritz-Galerkin basis-expansion techniques,\none can obtain algebraic (typically linear) stationarity conditions using either a symmetric form between\ntrial functions and weight functions, and thus automatically satisfy reciprocity relations, or using a\nconjugate-symmetric inner product, and satisfy energy constraints, but typically not both simultaneously.\nPerhaps the reaction approach may also lead to some useful variational principle for our problem, but\nwe do not pursue this question further here. One immediate difficulty is that, if we use inhomogeneous\nsolutions \u03c8\u0303 as trial vector fields, the corresponding sources are easily determined by substitution into the\nHelmholtz equation, but the fields themselves are difficult to parameterize in any economical manner,\nwhile if we use source-free solutions for \u03c8\u0303, variational families may be more easily characterized, but the\neffective sources appearing in the reactions are then difficult to determine.\nNow we turn to action principles. Because the fundamental dynamics of charge-carrying matter and\nelectromagnetic fields are ultimately derivable from a Lagrangian, we had anticipated that our maximumpower variational principle would be traced back to Hamilton's Principle, but this appears not to be\nthe case. (Perhaps this should not have been so surprising; after all, the Lagrangian involves differences\nbetween kinetic and potential energies, while an an energy-based principle should involve the sum.) To\nunderstand the issues encountered, let us proceed by re-framing the governing dynamical equations in\nterms of a standard Lagrangian formulation. For prescribed current and charge densities, the dynamics\nof the fields are derivable from the action functional, which in terms of the Coulomb-gauge potentials\nand scaled coordinates may be written as a space-time integral over the Lagrangian densities for the free\nelectromagnetic fields and the source-field interaction:\nZ Z\nS = d\u03c4 d3 \u03b6 [L0 + Lint ] ,\n(233)\nwhere\n\u2202\nL0 = k\u03b5(\u03b6; \u03c4 )k2 \u2212 kb(\u03b6; \u03c4 )k2 = k\u2212 \u2202\u03c4\na(\u03b6; \u03c4 ) \u2212 \u2202\u03c6(\u03b6; \u03c4 )k2 \u2212 k\u2202 \u00d7 a(\u03b6; \u03c4 )k2 ,\n\n(234)\n\nLint = j(\u03b6; \u03c4 ) * a(\u03b6; \u03c4 ) \u2212 \u03bc(\u03b6; \u03c4 )\u03c6(\u03b6; \u03c4 ),\n\n(235)\n\nand\n\nsubject as always to the solenoidal gauge constraint\n\u2202 * a(\u03b6; \u03c4 ) = 0.\n\n(236)\n\nUsing the reality of the physical potentials and sources and the (Hilbert-space) orthogonality between\nthe transverse vector field a(\u03b6; \u03c4 ) and longitudinal electric field \u2212\u2202\u03c6(\u03b6; \u03c4 ) when integrated over all space,\nwe can re-write this as\nZ Z\n\u0002 \u2202 \u2217 \u2202\n\u0003\nS = d\u03c4 d3 \u03b6 ( \u2202\u03c4\na * \u2202\u03c4 a) + (\u2202\u03c6\u2217 *\u2202\u03c6) \u2212 (\u2202 \u00d7a\u2217 )*(\u2202 \u00d7a) + (a\u2217 *j) \u2212 (\u03c6\u2217 \u03bc) ,\n(237)\nwhere we may use j or j\u22a5 interchangeably within the action functional because the current density only\nappears in an inner product with the solenoidal vector potential a. The equations of motion (EulerLagrange equations) for the vector and scalar potentials (and their complex conjugates) are obtained as\n\n\f46\nthe conditions for this action remaining stationary under independent, infinitesimal variations \u03b4a(\u03b6; \u03c4 ),\n\u03b4a(\u03b6; \u03c4 )\u2217 , \u03b4\u03c6(\u03b6; \u03c4 ), and \u03b4\u03c6(\u03b6; \u03c4 )\u2217 , which are fixed at the space-time boundaries (here taken to be at infinity), are consistent with the gauge constraint, and which do not destroy integrability of the Lagrangian\ndensity, but are otherwise arbitrary.\nBy interchanging the order of temporal and spatial integrations and using the Parseval-Plancherel Identity, we may express this action in the (scaled) frequency domain:\nZ Z\nS = d\u03c9 d3 \u03b6 [(i\u03c9a)\u2217 *(i\u03c9a) + (\u2202\u03c6\u2217 *\u2202\u03c6) \u2212 (\u2202 \u00d7a\u2217 )*(\u2202 \u00d7a) + (a\u2217 *j) \u2212 (\u03c6\u2217 \u03bc)] ,\n(238)\nwith additional gauge constraint\n\u2202 * a(\u03b6; \u03c9) = 0,\n\n(239)\n\nwhere we have used integration by parts on the time-derivatives, and where each potential and source\nterm appearing in the action integral is now interpreted as the Fourier transform in scaled time (assumed\nto exist) of the function of the same name appearing in the time-domain version above, and where\ncoordinate dependence has been suppressed for the sake of brevity and readability in the equations.\nUsing standard vector identities, this may be written in the more transparent form:\nZ Z\n\u0002\n\u0003\nS = d\u03c9 d3 \u03b6 a\u2217 *(\u2202 2 + \u03c9 2 )a + a\u2217 *j \u2212 \u03c6\u2217 (\u2202 2 \u03c6) \u2212 \u03c6\u2217 \u03bc + \u2202 *(\u03c6\u2217 \u2202\u03c6 \u2212 a\u2217 \u00d7\u2202 \u00d7a)\n(240)\n\nDemanding stationarity under independent, infinitesimal variations \u03b4a(\u03b6; \u03c9), \u03b4a(\u03b6; \u03c9)\u2217 , \u03b4\u03c6(\u03b6; \u03c9), and\n\u03b4\u03c6(\u03b6 \u2032 \u03c9) satisfying the gauge constraint and fixed boundary conditions (as k\u03b6k \u2192 \u221e and |\u03c9| \u2192 \u221e) leads\nto the frequency-domain version of Poisson's equation and the wave equation in the Coulomb gauge. Now,\nby Gauss's theorem, the final term involving the pure divergence can be expressed as a surface integral\nover the spatial boundary (at infinity), which will not affect the stationarity conditions (Euler-Lagrange\nequations) under the assumption of infinitesimal variations with fixed boundary conditions as dictated\nby Hamilton's principle, so it may be dropped without any change in the resulting dynamical equations.\nLikewise, we may then introduce the divergence \u2202 * q of some other, arbitrary differentiable vector field\nq which may be a function of \u03b6 and \u03c9 and a functional of a and a\u2217 and their spatial derivatives. The\nsignificance of this auxiliary field will emerge shortly. Since we are ultimately only interested in the\nradiative component of the fields, the terms in the action involving the scalar potential \u03c6 may also be\nsuppressed, as they are constant with respect to variations in the vector potential. Recalling that the\ntime-domain potentials and sources are all real, we can then use as the relevant action the modified\nfunctional\nZ\u221e Z\n\u0002\n\u0003\nS\u0303 = d\u03c9 d3 \u03b6 a\u2217 *(\u2202 2 + \u03c9 2 )a + a\u2217 *j + \u2202 *q + c.c.,\n\n(241)\n\n0\n\nand, noting the additivity with respect to contributions from the various frequencies \u03c9, we may use as\nthe variational, or \"objective\" or \"cost\" function, for each distinct (positive) frequency component the\nspectral density associated with this expression:\nZ\n\u0002\n\u0003\n\u2217\n\u2217\n\u2202\nd3 \u03b6 a\u2217 *(\u2202 2 + \u03c9 2 )a + a\u2217 *j + \u2202 *q + c.c.,\n(242)\n\u2202\u03c9 S\u0303[a, a , j, j ](\u03c9) \u2261\n\nwhose variations, subject to the solenoidal gauge constraint and given spatial boundary conditions, lead\nto Euler-Lagrange equations consisting of the inhomogeneous Helmholtz equation for the vector potential\nand its complex conjugate at the frequency \u03c9 > 0. Choosing\ni\n\u0011\n\u0010\n\u0011\nh \u0010\nP\u2032\n\u2202\n\u2202\n(243)\na\u00d7 1 + ki \u2202\u03b6\na\u2217 + 4\u03c00 \u2202 \u03b6 \u22121 ,\nq = 21 \u03bb 14 1 \u2212 ki \u2202\u03b6\nor equivalently (at least asymptotically, as \u03b6 \u2192 \u221e),\nh\nq = 21 \u03bb sout\na \u2212\n\nP0\u2032 \u03b6\n4\u03c0 \u03b6 3\n\ni\n\n,\n\n(244)\n\n\f47\nfor some undetermined real parameters \u03bb = \u03bb(\u03c9) and P0\u2032 = P0\u2032 (\u03c9), equation (242) becomes:\nZ\n\u0002 \u2217 2\n\u0003\n\u0002\u2202\n\u0003\n\u2217\n\u2217\n3\n2\n\u2217\nout\n\u2032\n\u2202\n\u2202\u03c9 S\u0303[a, a , j, j ](\u03c9) \u2261 2 d \u03b6 Re a *(\u2202 + \u03c9 )a + a *j + \u03bb(\u03c9) \u2202\u03c9 PEM [a ](\u221e; \u03c9) \u2212 P0 (\u03c9) . (245)\nThe chosen boundary term amounts to the addition of a Lagrange multiplier enforcing a specified out\u2202\nS\u0303.\ngoing power spectral density in the radiation fields at the stationary points of \u2202\u03c9\n\nNow, a natural approach to approximation, associated variously with the names of Raleigh, Ritz, and\nGalerkin in slightly different contexts, consists in simply replacing this infinite-dimensional variational\nproblem with a finite-dimensional restriction or projection of it onto some more easily characterized\nspace of possibilities.\nThat is, we restrict the space of possible vector potentials to some parameterized family a(\u03b6; \u03c9; \u03b1) for\nsome finite-dimensional vector \u03b1 of continuous parameters (over some specified domain), and thereby\nreplace a variational problem involving functional derivatives of the action functional with respect to\nthe vector potential with one involving ordinary derivatives of an action function with respect to the\nvariational shape parameters determining the form of the radiation and the Lagrange multiplier enforcing\na power normalization. That is, assuming the family of variational trial functions is implicitly constrained\nto satisfy the gauge constraint, the inhomogeneous Helmholtz PDE is replaced for each \u03c9 > 0 with a\nsystem of algebraic equations,\n\u2202\n\u2202\u03b1\n\u2202\n\u2202\u03bb\n\n\u2202\n\u2202\u03c9 S\u0303(\u03b1)\n\u2202\n\u2202\u03c9 S\u0303(\u03b1)\n\n= 0,\n\n(246a)\n\n= 0,\n\n(246b)\n\nwhose solution \u03b1\u0303 = \u03b1\u0303[j](\u03c9; P0\u2032 ), \u03bb\u0303 = \u03bb\u0303[j](\u03c9; P0\u2032 ) determines the variational approximation \u00e3(\u03b6; \u03c9; \u03b1\u0303) to\na(\u03b6; \u03c9).\nNow, following our earlier development, suppose we consider a family \u03c7(\u03b6; \u03c9; \u03b1) of trial vector fields for\nthe general inhomogeneous problem which are explicitly constrained to be solenoidal and to satisfy the\nsource-free Helmholtz equation, so the first term in the action density vanishes identically. Then the\nvariational action spectral density becomes\n\u0002\u2202\n\u0003\nout\n\u2032\n\u2202\n2\n(247)\n\u2202\u03c9 S\u0303(\u03c9; \u03b1; \u03bb) = \u03c9 Im h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1)|j(\u03c9)i + \u03bb(\u03c9) \u2202\u03c9 PEM [\u03c7 ](\u221e; \u03c9) \u2212 P0 (\u03c9) .\nDespite certain similarities, the Ritz-Galerkin-type variational principle associated with this action\nis distinct form the MPVP. The action principle involves finding constrained stationary points of\nIm h\u03b5\u03c7 \u22a5 (\u03c9)|j(\u03c9)i , while the MPVP involves finding the constrained maxima of Pmech [\u03b5\u03c7 \u22a5 , j](\u03c9; \u03b1) =\nRe h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1)|j(\u03c9)i .\n\nAlthough generically the \"true\" Euler-Lagrange solutions correspond to saddle-points, when the trial\nfunctions are restricted to a parameterized source-free family and when the power-normalization\nconstraint is imposed via a Lagrange multiplier, the overall problem inherits convexity from the\nconstraint alone, and the critical points turn out to be power-constrained local maxima or minima of Im h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1)|j(\u03c9)i , which implies that the overall phase should be chosen such that\nRe h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1)|j(\u03c9)i = 0. In the MPVP case, the variational solution corresponds to constrained local\nmaxima of \u2212 Re h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1)|j(\u03c9)i , so that Im h\u03b5\u03c7 \u22a5 (\u03c9; \u03b1)|j(\u03c9)i = 0. Any attempt to employ directly\nthe action-based variational principle with the source-free trial solutions thus encounters two related\nproblems: the ostensible method converges to a solution with a global phase error of \u03c0/2; and as an\nimmediate result, the calculated work performed on/by the sources vanishes, so the problem becomes\ndegenerate, and we are left with no means to consistently choose the absolute power level.\nIt is not difficult to trace the origin of this phase error. Naive application of Fourier transforms to the\nGreen function yields the reciprocal-space, frequency-domain kernel\nGout (k, k; \u03c9) = \u03b4(k \u2212 k\u2032 )\n\n1\n,\n\u03c9 2 \u2212 kkk2\n\n(248)\n\nbut this neglects the requirement of causality demanded of the retarded Green function, wherein the\nresponse can appear only after the source is applied, implying that the Green function must be analytic\nfor Im \u03c9 \u2265 0. We must be slightly more careful, and here treat the (temporal) Fourier transform as the\n\n\f48\nlimiting case of a Laplace transform, where the initial conditions are pushed back into the arbitrarily\nremote past rather than future, before being forgotten altogether. The Green function (248) must be\nunderstood in the sense\nGout (k, k; \u03c9) = lim+ \u03b4(k \u2212 k\u2032 )\n\u01eb\u21920\n\n1\nkkk2 \u2212 (\u03c9 + i\u01eb)2\n\n(249)\n\nwhere the limit is taken only after Gout is convolved with the Fourier transform of the source. In the\nfull Fourier representation, the vector potential and transverse source are then related by\na(k; \u03c9) = lim+\n\u01eb\u21920\n\nj\u22a5 (k; \u03c9)\n,\n\u2212 (\u03c9 + i\u01eb)2\n\nkkk2\n\n(250)\n\nwhere\nj\u22a5 (k; \u03c9) = (1 \u2212 k\u0302k\u0302T )j(k; \u03c9),\n\n(251)\n\nand\na(k; \u03c9) =\nj(k; \u03c9) =\n\n1\n(2\u03c0)3/2\n1\n(2\u03c0)3/2\n\nZ\nZ\n\nd3 \u03b6 a(\u03b6; \u03c9)e\u2212ik*\u03b6 ,\n\n(252a)\n\nd3 \u03b6 j(\u03b6; \u03c9)e\u2212ik*\u03b6\n\n(252b)\n\nare the (scaled) Fourier transforms. For real \u03c9 and kkk > |\u03c9| , we see that\n\u0015\n\u0014\n\u00ea*a(k; \u03c9)\n= 0,\narg\n\u00ea*j\u22a5 (k; \u03c9)\n\n(252c)\n\n(253)\n\nwhile for kkk < |\u03c9| ,\narg\n\n\u0014\n\n\u0015\n\u00ea*a(k; \u03c9)\n= \u03c0.\n\u00ea*j\u22a5 (k; \u03c9)\n\n(254)\n\nIn either case, the associated electric field for these spectral components is then in quadrature with\nthe current, and no time-averaged work is performed or energy exchanged. However, on the singular\nresonant manifold where kkk = |\u03c9| exactly, the magnitude of the Green function diverges in the limit as\n\u01eb \u2192 0+ , but the phase is such that\n\u0015\n\u0014\n\u03c0\n\u00ea*a(k; \u03c9 = kkk)\n= .\narg\n(255)\n\u00ea*j\u22a5 (k; \u03c9 = kkk)\n2\nThe relative phase between field and source then jumps discontinuously, to where the currents deliver\ntime-averaged energy to the fields. Our purported action principle fails to capture this, while the\nMPVP, although operating entirely within this singular manifold of source-free solutions, relies on energy\nconservation, which then enforces the correct phase relation. This is not to imply that action-based\nvariational principles are not also useful for radiation problems, only that they will not naturally work\nwith source-free solutions, and generically will involve finding saddle-points, not extrema.\nIn fact, most of the variational principles previously employed for FEL analysis, paraxial wave propagation, or laser-plasma problems are based on precisely this type of generalized Ritz-Galerkin approximations to the underlying Lagrangian dynamics, although some of the authors have erroneously claimed\nextremal instead of mere stationary character for their techniques. A Lagrangian-based variational principle is developed in [51] for paraxial optical propagation in an inhomogeneous gain medium, which\nis generalized in [52] to include nonlinear self-focusing effects, but the authors erroneously claim extremal, not just stationary, properties. This approach was further extended to include more general\nlaser-plasma interaction terms in [53], where the authors correctly state that their trial solutions derive from a stationary principle. In [49] the authors state without proof an extremal principle for the\nfundamental FEL mode in the small-signal regime, which in fact appears to be perfectly correct, but\nhigher modes will merely be stationary. These ideas are further generalized in [54, 55, 55, 56], where\n\n\f49\nthe variational techniques are erroneously described as extremal principles. Similar trial-function-based\nvariational principles are also used in [57, 58, 59] for which, correctly, only stationarity is claimed.\nA number of other authors have made extensive use of (correctly-stated) stationary action principles\nboth for general wave-wave and wave-particle interactions in kinetic and fluid treatments of plasmas and\nparticle beams [60, 61, 62, 63, 64] and more specifically for analysis of FELs [65]. However, rather than\ninvolving parameter-laden trial functions, these approaches employ the variational principles in order\nto provide economical descriptions and derivations of dynamical equations and conservation laws in the\nform of conventional ODEs or PDEs, and to effect in an efficient and transparent manner certain eikonal\nexpansions or approximations, or oscillation-center/ponderomotive or other averaging procedures [66, 67]\nwhile preserving the Hamiltonian nature of the dynamics.\nSuch confusion between stationary and extremal principles seems deeply embedded in physics literature\nand folklore. Linguistically, \"optimizing,\" \"maximizing,\" or \"minimizing\" simply sound better than\n\"criticalizing\" or \"making stationary.\" Philosophically, optimality enjoys a certain teleological appeal\nwhich mere stationarity lacks. Historically, the buzzwords \"least action\" have been invoked so often\nin the discussion of dynamics that Hamilton's Principle and the Principle of Least Action have been\nmistakenly conflated, despite being quite distinct concepts. The Principle of Least Action was first\narticulated by Maupertuis and formalized by Euler, not Hamilton; is restricted to a smaller class of\nLagrangians (no explicit time dependence); uses a different action (the abbreviated action integral) and\na different set of constrained variations (the energy is fixed but temporal endpoints are not); and in fact\nit is itself misnamed, requiring only that the abbreviated action be stationary, not necessarily minimal,\nfor the physical trajectory. Practically, both optimization principles and stationary principles share an\ninsensitivity of the variational quantity to the trial functions, but the extremal case additionally provides\nan upper or lower bound.\nNumerically, more efficient and/or reliable computational techniques may be employed for optimization\nproblems. Finding (local) maxima or minima of functions is much easier than finding roots of systems of\nequations. The \"Alpine\" analogy is often made: lost in a foggy terrain, the mountain-climber can reliably\nfind a nearby peak (local maximum) by moving uphill, a nearby valley (local minimum) by wandering\ndownhill, but has no guaranteed strategy for finding a mountain pass (saddle-point.) If the original\naction density is convex (at least in some sufficiently large region of function space), so that the true\nsolution corresponds to an extremum of the action, then in the Raleigh-Ritz approximation we have a\nnatural metric to measure both \"closeness\" to the true solution and \"progress\" in iteratively determining\nthe approximate one \u2013 namely, a metric induced by the action itself. Without convexity, the true and\napproximate solutions may correspond to saddle-points, and we must introduce some arbitrary external\nmetric to measure similarity or improvement. Even in the classic formulations which employ only linear\nexpansions in basis functions, the extremal case leads to the solution of equations corresponding to a\nsymmetric (or Hermitian), positive definite matrix, while in the merely stationary problem the matrix\nis in general Hermitian but not positive definite.\nIn the case of electromagnetic radiation, the stationary points are generically saddles, because of the\nhyperbolic nature of the wave equation. Alternatively, one can see this by the well-known equivalence of\nelectromagnetic mode dynamics to a collection of harmonic oscillators, for which the action functional is\nknown to be minimal only for sufficiently short times intervals away from turning points along an orbit.\nSimilar subtleties occur in the usual Raleigh-Ritz approximation for the stationary states in quantum\nmechanics. The energy-expectation value is always a local minimum for the ground state, and is always\nstationary for any excited state, but is only minimal for excited states if the variations are constrained\nto be orthogonal to all lower states.\nTo summarize, the MPVP involves finding constrained extrema of quantities of the form:\n\u0014Z\n\u0015\n\u2032\n3\n\u2217\nP [\u03c9; \u03b1] \u223c Im\nd x \u03b5(x; \u03c9; \u03b1) *j(x; \u03c9) ;\n\n(256)\n\nwhile Rumsey reaction-based variational principles would involve finding constrained stationary points\nof quantities of the form:\n\u0014Z\n\u0015\n3\nR[\u03c9; \u03b1] \u223c Im\nd x \u03b5(x; \u03c9; \u03b1)*j(x; \u03c9) ;\n(257)\n\n\f50\nand Lagrangian action-based principles would involve finding constrained stationary points of quantities\nof the form:\n\u0014Z\n\u0015\nS[\u03c9; \u03b1] \u223c Re\nd3 x \u03b5(x; \u03c9; \u03b1)\u2217 *j(x; \u03c9) ;\n(258)\nso indeed they all appear to be distinct variational principles.\n\nVI.\n\nCONCLUSIONS\n\nWe have reviewed in some detail a Hilbert-space and operator-based approach to electromagnetic radiation, and have used this formalism to derive in some detail a maximum-power variational principle\n(MPVP) for spontaneous radiation from prescribed classical sources, first in the paraxial limit and then\nin a more general setting, adding to the large family of variational techniques for electromagnetic problems in general, and undulator/wiggler radiation in particular. Mathematical details aside, at its most\nessential, the MPVP is really just a straightforward and rather obvious consequence of two simple and\nrather obvious constraints, together with another fundamental mathematical fact: the power in any one\nsource-free mode of the electromagnetic field may not exceed the total power in all the modes (i.e., Bessel\ninequality); and the power radiated must be attributable to power delivered by the sources, even in the\nregime where we ignore back-action on the sources (i.e., conservation of energy); while information about\nthe fields on some boundary surface, needed to determine this radiated power, can be converted into information about the derivatives of the fields in the interior (i.e., Gauss's law, one of the multidimensional\ngeneralizations of the Fundamental Theorem of Calculus).\nThis approximation, or ones similar to it, has been frequently used, almost without comment or perceived need for further justification, in classical or quantum stimulated emission situations, where in the\npresence of gain we naturally expect to observe that mode which grows the fastest, but it is equally\napplicable in the spontaneous regime, because arguments along the lines of Einstein's derivation of the\nA and B coefficients lead to definite connections between spontaneous emission, stimulated emission,\nand stimulated absorption, even when the radiation is completely classical. However simple, even trivial, these observations are not without practical content or application to undulator and possibly other\nradiation problems.\n\nAcknowledgements\n\nWe acknowledge useful discussions with W. Fawley, G. Penn, R. Lindberg, J. Morehead, A. Zholents,\nand J. Zimba. This research was supported by the Division of High Energy Physics, U.S. Department\nof Energy, and by DARPA, U.S. Department of Defense.\n\n[1] R.F. Collin. Field theory of guided waves. International series in pure and applied physics. McGraw-Hill\nBook Company, New York, 1960.\n[2] R.F. Harrington. Time-harmonic electromagnetic fields. Mcgraw-hill electrical and electronic enginering\nseries. McGraw-Hill Book Company, New York, 1961.\n[3] S.G. Mikhlin. Variational methods in mathematical physics. Maxmillan Company, New York, 1964.\n[4] L. Cairo and T. Kahan. Variational techniques in electromagnetism. Blackie, London, 1965.\n[5] J.D. Jackson. Classical electrodynamics. John Wiley and Sons, New York, second edition, 1975.\n[6] J.A. Kong. Electromagnetic wave theory. John Wiley and Sons, New York, 1986.\n[7] J.L. Davis. Wave propgation in electromagnetic media. Springer-Verlag, New York, 1990.\n[8] J.J.H. Wang. Generalized moment methods in electromagnetics: Formulation and computer solution of\nintegral equations. John Wiley and Sons, New York, 1991.\n[9] W.Z. Zhang. Engineering electromagnetism: Functional methods. Ellis Horwood, New York, 1991. Chang,\nWen-Hsun.\n\n\f51\n[10] I. Vago and M. Gyimesi. Electromagnetic fields. Akademiai Kiado, Budapest, 1998.\n[11] G.W. Hanson and A.B. Yakovlev. Operator theory for electromagnetics: An introduction. Springer, New\nYork, 2002.\n[12] I.B. Bernstein, E.A. Frieman, M.D. Kruskal, and K. R.M. An energy principle for hydromagnetic stability\nproblems. Proceedings of the Royal Society of London A, 244:17, 1958.\n[13] M.D. Kruskal and C.R. Oberman. On the stability of a plasma in static equilibrium. Physics of Fluids,\n1:275, 1958.\n[14] E.A. Frieman and M. Rotenberg. On hydrodynamic stability of stationary equilibria. Reviews of Modern\nPhysics, 32:898, 1960.\n[15] W.A. Newcomb. lagrangian and hamiltonian methods in magnetohydrodynamics. Nuclear Fusion:, Suplement(part 2):451, 1962.\n[16] C.S. Gardner. Bound on the energy available from a plasma. Physics of Fluids, 6:839, 1963.\n[17] V.I. Arnold. Variational principle for three dimensional steady-state flows of an ideal fluid. Journal of\nApplied Mathematical Mechanics, 29:1002, 1965.\n[18] D.D. Holm, J.E. Marsden, T. Ratiu, and A. Weinstein. Nonlinear stability of fluid and plasma equilibria.\nPhysics Reports, 123:1, 1985.\n[19] J.M. Finn and G.-Z. Sun. Nonlinear stability nad the energy-Casimir method. Comments Plasma Phys.\nControlled Fusion, 11:7, 1987.\n[20] P.J. Morrison and D. Pfirsch. Free-energy expressions for Vlasov equilibria. Physical Review A, 40(7):3898\u2013\n3910, 1 October 1989.\n[21] R. Evans. Density functionals in the theory of nonuniform fluids. In D. Henderson, editor, Fundamentals of\ninhomogeneous fluids. Marcel Dekker, New York, 1992.\n[22] S. Ichimaru. Statistical plasma physics. Westview Press, Bolder, Colorado, revised edition, 2004.\n[23] R.F. Harrington. Field computation by moment methods. MacMIllan, New York, 1968.\n[24] R. Glowinski. Numerical methods for nonlinear variational problems. Springer-Verlag, New York, 1983.\n[25] A.R. Mitchell and R. Wait. The finite element method in partial differential equations. Wiley, Chichester,\n1984.\n[26] P. Blanchard and E. Bruning. Variational methods in mathematical physics: A unified approach. Texts and\nmonographs in physics. Springer-Verlag, Berlin, 1992.\n[27] S.C. Brenner and L.R. Scott. The mathematical theory of finite element methods, volume 15 of Texts in\napplied mathematics. Springer-Verlag, Berlin, 1994.\n[28] C.W. Steele. Numerical computation of elecric and magnetic fields. Chapman and Hall, New York, second\nedition, 1997.\n[29] G. Penn, M. Reinsch, and J.S. Wurtele. Analytic model of harmonic generation in the low-gain FEL regime.\nTechnical Report LBNL-56177, LBNL, August 2004.\n[30] G. Penn, M. Reinsch, and J.S. Wurtele. Analytic model of harmonic generation in the low-gain FEL regime.\nIn 26th International Free Electron Laser Conference, 2004.\n[31] G. Penn, J.N. Coreltt, W. Fawley, M. Reinsch, W. Wan, J.S. Wurtele, and A. Zholents. Harmonic cascade\nFEL designs for LUX. In European Paticle Accelerator Conference (EPAC), 2004.\n[32] S.J. van Enk and G. Nienhuis. Eigenfunction description of laser beams and orbital angular momentum\nof light. In L. Allen, S.M. Barnett, and M.J. Padgett, editors, Optical angular momentum, pages 36\u201347.\nInstitute of Physics Publishing, Bristol, 2003.\n[33] G. Nienhuis and L. Allen. Paraxial wave optics and harmonic oscillators. In L. Allen, S.M. Barnett, and\nM.J. Padgett, editors, Optical angular momentum, pages 48\u201357. Institute of Physics Publishing, Bristol,\n2003.\n[34] L. Allen, S.M. Barnett, and M.J. Padgett, editors. Optical angular momentum. Institute of Physics Publishing, Bristol, 2003.\n[35] N. George and A. Gamliel. Correlation theory of electromagnetic radiation using multipole expansions.\nIn H.N. Kritikos and D.L. Jaggard, editors, Recent advances in electromagnetic theory, pages 144\u2013182.\nSpringer-Verlag, New York, 1990.\n[36] J. Morehead. Vector spherical harmonics., 2001.\n[37] C.T. Tai. Dyadic Green functions in electromagnetic theory. IEEE Press, New York, second edition, 1993.\n[38] H.L. Weinart, editor. Reproducing kernel Hilbert spaces: Applications in statistical signal processing, volume 25 of Benchmark papers in electrical engineering and computer science. Hutchinson Ross Publishing\nCompany, Stroudburg, Pennsylvania, 1982.\n[39] R.A. Waldron. Theory of guided electromagnetic waves. van Nostrand-Reinhold, London, 1970.\n[40] J. van Bladel. Singular electromagentic fields and sources. Oxford engineering science series. Oxford University Press, Oxford, 1991.\n[41] Rahmat-Samii. On the question of computation of the dyadic Green function at the source region in waveguides and cavities. IEEE Transactions on Microwave Theory and Techniques, 23(9):762\u2013765, September\n1975.\n[42] A. Einstein. Zur quantentheorie der strahlung. Phys. Zeit., 18:121, 1917.\n[43] G. Bekefi. Radiation processes in plasmas. Wiley series in plasma physics. John Wiley and Sons, New York,\n1966.\n\n\f52\n[44] V.N. Litvinenko and N.A. Vinokurov. On the classical analog of the Einstein relations between spontaneous\nemission, induced emission, and absorption. Nuclear Instruments and Methods in Physics Research A,\n331:440\u2013449, 1993.\n[45] S. Krinsky, J.M. Wang, and P. Luchini. Madey's gain-spread theorem for the free electron laser and the\ntheory of stochatic processes. Journal of Applied Physics, 53(8):5453\u20135458, August 1982.\n[46] J.M.J. Madey. Relationship between mean radiated energy, mean squared radiated energy, and spontaneous\npower spectrum in a power series expansion of the equations of motion in a free electron laser. Nuovo\nCimento della Societa Italiana di Fisica B, 50(ser. 2, no. 1):64\u201388, 11 March 1979.\n[47] K.w.-J.e. Kim. FEL gain taking into account diffraction and beam emittance; generalized Madey's theorem.\nNuclear Instruments and Methods in Physics Research A, 318:489\u2013494, 1992.\n[48] D.E. Nikonov, Y.V. Rostovtsev, and G. Sussman. Madey's and Liouville's theorems relating to free-electron\nlasers without inversion. Physical Review E, 57(3):3444\u20133454, March 1998.\n[49] M. Xie and D.A.G. Deacon. Theoretical study of FEL active guiding in the small signal regime. Nuclear\nInstruments and Methods in Physics Research A, 250(1-2):426\u2013431, 1 September 1986.\n[50] V.H. Rumsey. Reaction concept in electromagnetic theory. Physical Review, 94(6):1483\u20131491, 15 June 1954.\n[51] A.J. Firth. Propagation of LASER beams through inhomogenous media. Optics Commuications, 22(2):226\u2013\n230, August 1977.\n[52] A. Anderson and M. Bonnedal. Variational apporach to nonlinear focusing of Gaussian laser beams. Physics\nof Fluids, 22(1):105\u2013109, January 1979.\n[53] B.J. Duda and W.B. Mori. Variational principle approach to short-pulse laser-plasma interactions in three\ndimensions. Physical Review E, 61(2):1925\u20131939, February 2000.\n[54] A. Amir and Y. Greenzweig. Three-dimensional theory of the free-electron laser. i. Gain and evolution of\noptical modes. Physical Review A, 34(6):4809\u20134819, December 1986.\n[55] P. Luchini and S. Solimeno. Variational solution of the wave equation for a high gain FEL and a finite\nwiggling radius. Nuclear Instruments and Methods in Physics Research A, 272(1-2):311\u2013317, October 1988.\n[56] A. Amir. Optical-mode trapping in the free-electron laser. Physical Review A, 37(3):780\u2013786, 1 February\n1988.\n[57] L.H. Yu, S. Krinsky, and R.L. Gluckstern. Calculation of universal scaling function for free-electron laser\ngain. Physical Review Letters, 64(25):3011\u20133013, 18 June 1990.\n[58] B. Hafizi and C.W. Roberson. Effect of emittance and energy spread on a free-electron laser in the gainfocusing regime. Physical Review Letters, 68(24):3539\u20133542, 15 June 1992.\n[59] M. Xie. Exact and variational solutions of 3d eigenmodes in high gain FELs. Nuclear Instruments and\nMethods in Physics Research A, 445(1-3):59\u201366, 1 May 2000.\n[60] A.N. Kaufman and D.D. Holm. The Lie-transformed Vlasov action principle: Relativistically covariant wave\npropagation and self-consistent pondermotive effects. Physics Letters, 105A(6):277\u2013279, 22 October 1984.\n[61] D. Pfirsch and P.J. Morrison. Local conservation laws for the Maxwell-Vlasov and collisionless kinetic guiding\ncenter theories. Physical Review A, 32(3):1714\u20131721, September 1985.\n[62] L.A. Turski and A.N. Kaufman. Canonical-dissipative formulation of relativistic plasma kinetic theory with\nself-consistent Maxwell field. Physics Letters A, 120(7):331\u2013333, 9 March 1987.\n[63] A.N. Kaufman, H. Ye, and Y. Hui. Variational formulation of covariant eikonal theory for vector waves.\nPhysics Lettera A, 120(7):327\u2013330, 9 March 1987.\n[64] A.J. Brizard. A new Lagrangian formulation for laser-plasma interactions. Physics of Plasmas, 5(4):1110\u2013\n1117, April 1998.\n[65] P. Similon and J.S. Wurtele. Nonlinear interaction of a relativisitc electron beam with electromagentic\nwaves. Physics Letters A, 154(4,5):224\u2013232, 4 March 1991.\n[66] M.E. Delanay. On the averaged Lagrangian technique for nonlinear dispersive waves. Ph.d., California\nInstitute of Technology, 1971.\n[67] G.B. Whitham. Linear and nonlinear waves. Pure and applied mathematics. John Wiley and Sons, Inc.,\nNew York, 1974.\n\n\f"}