{"id": "http://arxiv.org/abs/0805.2121v2", "guidislink": true, "updated": "2008-09-17T18:05:52Z", "updated_parsed": [2008, 9, 17, 18, 5, 52, 2, 261, 0], "published": "2008-05-14T17:26:37Z", "published_parsed": [2008, 5, 14, 17, 26, 37, 2, 135, 0], "title": "Maximum Likelihood Fitting of Tidal Streams With Application to the\n  Sagittarius Dwarf Tidal Tails", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0805.4182%2C0805.0026%2C0805.1666%2C0805.2345%2C0805.2281%2C0805.1769%2C0805.2931%2C0805.2892%2C0805.4650%2C0805.4504%2C0805.1890%2C0805.3042%2C0805.4573%2C0805.1402%2C0805.1467%2C0805.2445%2C0805.0157%2C0805.2789%2C0805.2729%2C0805.0068%2C0805.4287%2C0805.0161%2C0805.0776%2C0805.2979%2C0805.3798%2C0805.0143%2C0805.1577%2C0805.0930%2C0805.3026%2C0805.2073%2C0805.2616%2C0805.4746%2C0805.2172%2C0805.4157%2C0805.1186%2C0805.2605%2C0805.3126%2C0805.2658%2C0805.4119%2C0805.1839%2C0805.0809%2C0805.3407%2C0805.0461%2C0805.1372%2C0805.2107%2C0805.1146%2C0805.3326%2C0805.2042%2C0805.0731%2C0805.2646%2C0805.3085%2C0805.1390%2C0805.2821%2C0805.2811%2C0805.3086%2C0805.2412%2C0805.3493%2C0805.2468%2C0805.1047%2C0805.4223%2C0805.3758%2C0805.0740%2C0805.2418%2C0805.4789%2C0805.2984%2C0805.1314%2C0805.2870%2C0805.2780%2C0805.0376%2C0805.1785%2C0805.3294%2C0805.3642%2C0805.1717%2C0805.3358%2C0805.2319%2C0805.1913%2C0805.0130%2C0805.3598%2C0805.0919%2C0805.2191%2C0805.1190%2C0805.3079%2C0805.3227%2C0805.4360%2C0805.3333%2C0805.2175%2C0805.2477%2C0805.4074%2C0805.2121%2C0805.0114%2C0805.4390%2C0805.0938%2C0805.0323%2C0805.2027%2C0805.2679%2C0805.0129%2C0805.4722%2C0805.2136%2C0805.3422%2C0805.4774%2C0805.4486&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Maximum Likelihood Fitting of Tidal Streams With Application to the\n  Sagittarius Dwarf Tidal Tails"}, "summary": "We present a maximum likelihood method for determining the spatial properties\nof tidal debris and of the Galactic spheroid. With this method we characterize\nSagittarius debris using stars with the colors of blue F turnoff stars in SDSS\nstripe 82. The debris is located at (alpha, delta, R) = (31.37 deg +/- 0.26\ndeg, 0.0 deg, 29.22 +/- 0.20 kpc), with a (spatial) direction given by the unit\nvector < -0.991 +/- 0.007 kpc, 0.042 +/- 0.033 kpc, 0.127 +/- 0.046 kpc >, in\nGalactocentric Cartesian coordinates, and with FWHM = 6.74 +/- 0.06 kpc. This\n2.5 degee-wide stripe contains 0.9% as many F turnoff stars as the current\nSagittarius dwarf galaxy. Over small spatial extent, the debris is modeled as a\ncylinder with a density that falls off as a Gaussian with distance from the\naxis, while the smooth component of the spheroid is modeled with a Hernquist\nprofile. We assume that the absolute magnitude of F turnoff stars is\ndistributed as a Gaussian, which is an improvement over previous methods which\nfixed the absolute magnitude at Mg0 = 4.2. The effectiveness and correctness of\nthe algorithm is demonstrated on a simulated set of F turnoff stars created to\nmimic SDSS stripe 82 data, which shows that we have a much greater accuracy\nthan previous studies. Our algorithm can be applied to divide the stellar data\ninto two catalogs: one which fits the stream density profile and one with the\ncharacteristics of the spheroid. This allows us to effectively separate tidal\ndebris from the spheroid population, both facilitating the study of the tidal\nstream dynamics and providing a test of whether a smooth spheroidal population\nexists.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0805.4182%2C0805.0026%2C0805.1666%2C0805.2345%2C0805.2281%2C0805.1769%2C0805.2931%2C0805.2892%2C0805.4650%2C0805.4504%2C0805.1890%2C0805.3042%2C0805.4573%2C0805.1402%2C0805.1467%2C0805.2445%2C0805.0157%2C0805.2789%2C0805.2729%2C0805.0068%2C0805.4287%2C0805.0161%2C0805.0776%2C0805.2979%2C0805.3798%2C0805.0143%2C0805.1577%2C0805.0930%2C0805.3026%2C0805.2073%2C0805.2616%2C0805.4746%2C0805.2172%2C0805.4157%2C0805.1186%2C0805.2605%2C0805.3126%2C0805.2658%2C0805.4119%2C0805.1839%2C0805.0809%2C0805.3407%2C0805.0461%2C0805.1372%2C0805.2107%2C0805.1146%2C0805.3326%2C0805.2042%2C0805.0731%2C0805.2646%2C0805.3085%2C0805.1390%2C0805.2821%2C0805.2811%2C0805.3086%2C0805.2412%2C0805.3493%2C0805.2468%2C0805.1047%2C0805.4223%2C0805.3758%2C0805.0740%2C0805.2418%2C0805.4789%2C0805.2984%2C0805.1314%2C0805.2870%2C0805.2780%2C0805.0376%2C0805.1785%2C0805.3294%2C0805.3642%2C0805.1717%2C0805.3358%2C0805.2319%2C0805.1913%2C0805.0130%2C0805.3598%2C0805.0919%2C0805.2191%2C0805.1190%2C0805.3079%2C0805.3227%2C0805.4360%2C0805.3333%2C0805.2175%2C0805.2477%2C0805.4074%2C0805.2121%2C0805.0114%2C0805.4390%2C0805.0938%2C0805.0323%2C0805.2027%2C0805.2679%2C0805.0129%2C0805.4722%2C0805.2136%2C0805.3422%2C0805.4774%2C0805.4486&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a maximum likelihood method for determining the spatial properties\nof tidal debris and of the Galactic spheroid. With this method we characterize\nSagittarius debris using stars with the colors of blue F turnoff stars in SDSS\nstripe 82. The debris is located at (alpha, delta, R) = (31.37 deg +/- 0.26\ndeg, 0.0 deg, 29.22 +/- 0.20 kpc), with a (spatial) direction given by the unit\nvector < -0.991 +/- 0.007 kpc, 0.042 +/- 0.033 kpc, 0.127 +/- 0.046 kpc >, in\nGalactocentric Cartesian coordinates, and with FWHM = 6.74 +/- 0.06 kpc. This\n2.5 degee-wide stripe contains 0.9% as many F turnoff stars as the current\nSagittarius dwarf galaxy. Over small spatial extent, the debris is modeled as a\ncylinder with a density that falls off as a Gaussian with distance from the\naxis, while the smooth component of the spheroid is modeled with a Hernquist\nprofile. We assume that the absolute magnitude of F turnoff stars is\ndistributed as a Gaussian, which is an improvement over previous methods which\nfixed the absolute magnitude at Mg0 = 4.2. The effectiveness and correctness of\nthe algorithm is demonstrated on a simulated set of F turnoff stars created to\nmimic SDSS stripe 82 data, which shows that we have a much greater accuracy\nthan previous studies. Our algorithm can be applied to divide the stellar data\ninto two catalogs: one which fits the stream density profile and one with the\ncharacteristics of the spheroid. This allows us to effectively separate tidal\ndebris from the spheroid population, both facilitating the study of the tidal\nstream dynamics and providing a test of whether a smooth spheroidal population\nexists."}, "authors": ["Nathan Cole", "Heidi Jo Newberg", "Malik Magdon-Ismail", "Travis Desell", "Kristopher Dawsey", "Warren Hayashi", "Xinyang", "Liu", "Jonathan Purnell", "Boleslaw Szymanski", "Carlos Varela", "Benjamin Willett", "James Wisniewski"], "author_detail": {"name": "James Wisniewski"}, "author": "James Wisniewski", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1086/589681", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0805.2121v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0805.2121v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "50 pages, 8 figures, 5 tables. Accepted for publication into the\n  Astrophysical Journal", "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0805.2121v2", "affiliation": "Fred", "arxiv_url": "http://arxiv.org/abs/0805.2121v2", "journal_reference": "Astrophys.J. 683 (2008) 750", "doi": "10.1086/589681", "fulltext": "arXiv:0805.2121v2 [astro-ph] 17 Sep 2008\n\nMaximum Likelihood Fitting of Tidal Streams With Application\nto the Sagittarius Dwarf Tidal Tails\nNathan Cole,1 Heidi Jo Newberg,1 Malik Magdon-Ismail,2 Travis Desell,2 Kristopher\nDawsey,1 Warren Hayashi,1 Xinyang (Fred) Liu,1 Jonathan Purnell,2 Boleslaw\nSzymanski,2 Carlos Varela,2 Benjamin Willett,1 James Wisniewski1\nABSTRACT\nWe present a maximum likelihood method for determining the spatial properties of tidal debris and of the Galactic spheroid. With this method we characterize\nSagittarius debris using stars with the colors of blue F turnoff stars in SDSS stripe\n82. The debris is located at (\u03b1, \u03b4, R) = (31.37\u25e6 \u00b1 0.26\u25e6, 0.0\u25e6 , 29.22 \u00b1 0.20 kpc),\nwith a (spatial) direction given by the unit vector < \u22120.991 \u00b1 0.007 kpc, 0.042 \u00b1\n0.033 kpc, 0.127\u00b10.046 kpc >, in Galactocentric Cartesian coordinates, and with\nFWHM = 6.74 \u00b10.06 kpc. This 2.5\u25e6 -wide stripe contains 0.9% as many F turnoff\nstars as the current Sagittarius dwarf galaxy. Over small spatial extent, the debris\nis modeled as a cylinder with a density that falls off as a Gaussian with distance\nfrom the axis, while the smooth component of the spheroid is modeled with a\nHernquist profile. We assume that the absolute magnitude of F turnoff stars is\ndistributed as a Gaussian, which is an improvement over previous methods which\nfixed the absolute magnitude at M\u0304g0 = 4.2. The effectiveness and correctness of\nthe algorithm is demonstrated on a simulated set of F turnoff stars created to\nmimic SDSS stripe 82 data, which shows that we have a much greater accuracy\nthan previous studies. Our algorithm can be applied to divide the stellar data\ninto two catalogs: one which fits the stream density profile and one with the\ncharacteristics of the spheroid. This allows us to effectively separate tidal debris from the spheroid population, both facilitating the study of the tidal stream\ndynamics and providing a test of whether a smooth spheroidal population exists.\nSubject headings: Galaxy: structure - Galaxy: halo - methods: data analysis\n1\n\nDept. of Physics, Applied Physics and Astronomy, Rensselaer Polytechnic Institute Troy, NY 12180;\nastro@cs.rpi.edu\n2\n\nDept. of Computer Science, Rensselaer Polytechnic Institute Troy, NY 12180; astro@cs.rpi.edu\n\n\f\u20132\u2013\n1.\n1.1.\n\nIntroduction\n\nThe Milky Way's Spheroid\n\nIn the late 1980s, the Milky Way's spheroid population was described as slowly rotating, with density distribution given by \u03c1 \u221d r \u22123.5 (Freeman 1987). There was a controversy\nconcerning the flattening of the spheroid, since kinematic studies of the spheroid stars suggested a flatter spheroid (Gilmore, Wyse, and Kuijken 1989) and star counts often suggested\na more spherical spheroid (Bahcall 1986). By early in the 21st century, the spheroid was still\nthought of as a smooth power law distribution, but studies were starting to show that the\nshape of the spheroid depended on the type of star being observed, and it was noted that\nat least some of the spheroid, if not all, was composed of debris from hierarchical structure formation (Freeman & Bland-Hawthorne 2002). The Sagittarius (Sgr) dwarf galaxy\n(Ibata, Gilmore, and Irwin 1994) and its associated tidal stream (Yanny, Newberg et al.\n2000; Ibata, Lewis, et al. 2001; Ibata et al. 2001) was the one known example of merging\nin the present day. In the last ten years, the discovery of substructure has dominated the\ndiscussion of the Galactic spheroid. The discovery of substructure has been driven primarily\nby the Sloan Digital Sky Survey (SDSS) and the related Sloan Extension for Galactic Understanding and Exploration (SEGUE), but other surveys such as the Quasar Equatorial Survey\nTeam (QUEST) and the Two Micron All Sky Survey (2MASS) have also been influential.\nDiscoveries include new tidal debris streams, dwarf galaxies, and globular clusters.\nThe positions, velocities, and metallicities of Sgr dwarf spheroidal tidal debris stars\nhave been measured all across the sky (Newberg, Yanny et al. 2002; Bellazzini et al. 2003;\nMajewski et al. 2003; Newberg, Yanny et al. 2003; Majewski et al. 2004; Mart\u0131\u0301nez-Delgado et al.\n2004; Fellhauer et al. 2006; Chou et al. 2007). These measurements have then been compared\nwith models of tidal disruption (Johnston et al. 1995; Ibata et al. 1997; Ibata and Lewis\n1998; G\u00f3mez-Flechoso et al. 1999; Helmi and White 2001; Johnston et al. 2002; Law et al.\n2004, 2005). Given that the data spans three spatial dimensions plus radial velocities, but\nboth the models and data are presented in papers primarily as two dimensional plots, it\nhas been difficult to make detailed comparisons in multidimensional space. In this paper\nwe develop a technique that would allow us to create a catalog of stars that has the same\nspatial distribution as the stars in the Sgr tidal stream. That catalog could then be made\navailable to the modeling community, who would be able to transform the coordinates into\nwhatever system they find most natural to make comparisons.\nAt least three newly discovered tidal debris streams are thought to be associated with\ndwarf galaxies, including: the Monoceros stream in the Galactic plane (Newberg, Yanny et al.\n2002; Yanny, Newberg et al. 2003), the Virgo Stellar Stream (Vivas et al. 2001; Duffau et al.\n\n\f\u20133\u2013\n\n2006; Newberg et al. 2007), and the Orphan Stream (Grillmair 2006) in the Field of Streams(Belokurov et al\n2006b). An additional piece of tidal debris was found in Triangulum-Andromeda by Rocha-Pinto et al.\n(2004) which might be part of the Monoceros stream (Pen\u00f1arrubia et al. 2005). Tidal tails\nspanning many tens of degrees across the sky have been found around Pal 5 (Odenkirchen et al.\n2001; Rockosi et al. 2002; Grillmair & Dionatos 2006), and NGC 5466 (Grillmair & Johnson\n2006; Belokurov et al. 2006c). Grillmair & Dionatos (2006) find a similar-looking tidal stream\nfor which there is no known progenitor globular cluster. Eight new low surface brightness dwarf galaxy satellites of the Milky Way have been discovered (Willman et al. 2005a;\nZucker et al. 2006a; Belokurov et al. 2006a; Zucker et al. 2006b; Grillmair 2006; Belokurov et al.\n2007a; Irwin et al. 2007), nearly doubling the number of known Milky Way dwarfs. Belokurov et al.\n(2007b) suggest that there is a new structural component of the spheroid called the HerculesAquila cloud.\nWith all of this substructure detected in the densities of spheroid stars, one wonders\nhow much of the spheroid is smooth, and what the shape of the smooth spheroid might be. It\nis no wonder that standard Galactic models, such as the the Besan\u00e7on model (Robin et al.\n2003), which uses a power law density profile, do not match the SDSS star counts. The\nspheroid shape is a current controversy as Helmi (2004) has found prolate models favorable while Johnston et al. (2005) has found oblate models best. The large number of very\nsignificant over-densities of stars in the spheroid show that pencil beam studies and studies that extrapolate from the solar neighborhood could be contaminated by local structure\nand may not be indicative of the global shape of the Milky Way spheroid. Recent results\nfrom F turnoff stars from the SDSS suggest the smooth component of the spheroid might\nbe asymmetric about the Galactic center, so that no axially symmetric spheroid model can\nbe fit (Newberg and Yanny 2005, 2006; Savage et al. 2006; Xu,Deng & Hu 2006). However,\naccurate measurements of the smooth component require that spatial substructure be identified and quantified - otherwise it is difficult to know which stars to fit to smooth spheroid\nmodels.\nWe need to develop a model that is as complex as the data. In this paper we start this\nprocess by developing a maximum likelihood method that can be used to fit a smooth stellar\nspheroid containing one debris stream, using one 2.5\u25e6 stripe of SDSS data, and show that our\nalgorithm produces the correct results on a simulated dataset. In the future, we will extend\nthe algorithm to include larger datasets with multiple pieces of debris. The long-term goal\nis to develop a model of the spheroid that fits the observed, lumpy density distribution of\nstars in the spheroid.\n\n\f\u20134\u2013\n1.2.\n\nThe Sloan Digital Sky Survey\n\nThe SDSS is a large, international collaboration that was originally established to find\nthe largest structures of galaxies in the Universe from an imaging survey of 10,000 sq. deg. of\nsky and spectra of 1,000,000 galaxies selected from the photometry (from images). The SDSS\ncan simultaneously obtain 640 spectra per pointing, using two 320-fiber double (blue/red)\nspectrographs. The angular position of a galaxy in the sky is easy to measure from the\nimaging survey, and for distant galaxies the distance is well estimated from a spectroscopic\nmeasurement of the Hubble redshift. By combining the imaging with the spectroscopic\nsurvey, the SDSS has built up a three dimensional picture of the distribution of galaxies\nin the Universe using a dedicated 2.5 meter telescope at Apache Point Observatory in New\nMexico (York et al. 2000).\nImages are obtained with an array of thirty 2048 \u00d7 2048 pixel CCD cameras operated\nin a drift-scan (time delay and integrate, TDI) mode, which produces six \"scan lines\" of\nimaging data that are each 13.6' wide and grow longer at a rate of 15 degrees per hour for\nthe length of that \"run.\" In each of the six \"scan lines,\" the sky is imaged in five optical\nfilters: u, g, r, i, and z; the time at which each astronomical object is imaged is a few minutes\ndifferent for each passband. When a second set of six scan lines is observed that fill in the\ngaps between the first set of six scan lines, they produce a contiguous \"stripe\" of data of\nwidth 2.5\u25e6 and length that depends on the length of time the sky was observed in the \"runs.\"\nEach 2.5\u25e6 -wide stripe follows a defined great circle on the sky, and is built up of two or more\n\"runs\" of data, as many runs as are needed to traverse the SDSS survey area.\nThe entire sky is divided up into 144 numbered stripes that start and end at the survey\npoles: (l, b) = (209.33\u25e6 , \u22127\u25e6 ) and (l, b) = (29.33\u25e6, 7\u25e6 ). Stripes 10 and 82 are centered on\nthe Celestial Equator, with stripe 10 in the North Galactic Cap and stripe 82 in the South\nGalactic Cap. The other stripes are sequentially numbered with inclinations 2.5 degrees\napart. If the entire length (180\u25e6 ) of every stripe were imaged, we would have 64, 800 sq.\ndegrees of imaging data for a sky that is 41, 253 sq. deg. The overlaps between stripes\nincrease towards the survey poles. Since the SDSS generally observes only parts of the sky\nthat are more than 30\u25e6 from the survey poles, there is about 50% overlap at the ends of\nthe stripes and very little overlap on the survey equator, which is at RA= 185\u25e6 . With the\nrelease of SDSS DR6 (Adelman-McCarthy et al. 2007), a contiguous 8500 sq. deg. area of\nthe North Galactic Cap is now publicly available. It is pieced together with 31 adjacent SDSS\nstripes. Three stripes of data are available in the South Galactic Cap, including stripe 82\non the Celestial Equator. Further information about the SDSS, including survey geometry,\ncan be found in: Stoughton et al. (2001), Abazajian et al. (2003), Fukugita et al. (1996),\nGunn et al. (1998), Hogg et al. (2001), Pier et al. (2003), Smith et al. (2002).\n\n\f\u20135\u2013\nBecause the imaging survey is large and well calibrated, and because the spectroscopic\nsurvey included many Galactic stars, in some cases by design and in some cases accidentally,\nthe SDSS has made a significant contribution to our knowledge about the Milky Way, and in\nparticular the discovery of substructure in the spheroid component, as we discussed above.\nBecause of this, SDSS has been expanded to include a new project, the Sloan Extension for\nGalactic Understanding and Exploration (SEGUE). This extension will eventually include\n3500 sq. deg. of new imaging data which is collected in 2.5\u25e6 -wide great circles on the sky, but\nthese great circles do not in general match those laid out on the sky for the SDSS, and they\nare not adjacent to each other so they do not fill contiguous areas of the sky. The positions\nof these stripes were chosen to sparsely sample all directions in the sky that are visible\nfrom Apache Point Observatory, and include scans at constant Galactic longitude that pass\nthrough the Galactic plane. SEGUE will also obtain \u223c 250, 000 spectra of Galactic stars to\nstudy stellar populations and kinematics.\nIn this paper, we wish to use the photometry derived from imaging of Galactic stars to\ntrace the three dimensional shape of the Galactic spheroid and the substructure, including\ntidal streams, contained within it. In this demonstration of the algorithm and the results\nfrom running it, we will focus on only one well-studied stripe of SDSS data: stripe 82 on\nthe Celestial Equator. We use only F turnoff stars in 300 square degrees of this stripe,\nroughly centered on the place where the Sgr stream crosses it. Unlike galaxies, the distances\nof stars cannot be inferred from their radial velocities. By selecting only stars with colors\nconsistent with spheroid F turnoff stars, we select a stellar population that is not a very\ngood standard candle. But because we observe a large number of F turnoff stars we can\nfind their underlying density distribution through statistical methods. We will assume the\nabsolute magnitudes of the F turnoff stars in the population have a mean of M\u0304g0 = 4.2 and\na dispersion of \u03c3Mg0 = 0.6. These are reasonable estimates for the Sgr dwarf tidal stream\n(Newberg and Yanny 2006).\n\n1.3.\n\nThe Technique of Maximum Likelihood\n\nGiven a parameterized model and some data generated according to the model for some\n\"true\" values of the model parameters, the task of model estimation is to determine the set\nof parameters used in generating the data. Within a Bayesian setting, the model estimation\nproblem can be reformulated as determining the a posteriori most likely parameters given\nthe data and the model. In our case we have spatial positions for a set of stars in the\nspheroid, and a proposed model for the spheroid and a tidal stream which passes through\nit, and we would like to find the most likely values of the parameters in that model.\n\n\f\u20136\u2013\nThe likelihood of a set of parameters is the probability of obtaining a particular data\nset for a given set of parameters. Via Bayes' theorem, one can decompose the a posteriori\nprobability of a particular set of parameters given the data and the model into the product\nof two terms, the first being the likelihood of the parameters and the second being the prior\nprobability of the parameters. When the prior probability distribution over the parameters\nis uniform (as is typically assumed), the a posteriori probability is proportional to the\nlikelihood, and so the maximum likelihood technique may be used to find the most likely\nmodel parameters [see Fletcher (1987) for more details].\nThere are two main tasks to implementing the maximum likelihood technique. The first\nis to develop the likelihood function, which measures the probability of observing a particular\ndataset given a parameterized model. The second is to maximize the likelihood with respect\nto the parameters.\nIn developing the likelihood function, one typically assumes that each data point is\nindependently generated, hence the likelihood of the dataset is the product of the likelihoods\nof each individual data point. Within our setting, we develop a parameterized model for\nthe background Milky Way and Sagittarius stellar distributions from which we compute the\nlikelihood. We prefer to maximize the logarithm of the likelihood, rather than the likelihood\nbecause the computation of the log-likelihood is numerically more stable. We then use the\nstandard technique of optimization via conjugate gradients (Fletcher 1987) to maximize the\nlikelihood and hence determine the most likely model parameters fitting the data.\nOne advantage of the maximum likelihood framework is that the Hessian of the loglikelihood (at the maximum) gives the shape of the probability distribution over the parameters, and hence allows us to determine the statistical error in the estimated model\nparameters. When the model parameters are physical quantities of interest, this statistical\nerror translates to an error bar on the measured (i.e. estimated) physical quantity.\nIn the remainder of this paper we present a new automated technique that can detect\ntidal debris in a spatial input catalog of stars from one stripe of SDSS data. Since the\nfirst stripe in which the Sgr dwarf tidal stream was detected in SDSS data was Stripe 82\n(Newberg, Yanny et al. 2002), and it has therefore been the most well-studied; this is the\nsection of data on which we test our maximum likelihood. Building upon this, we describe a\ntechnique to extract a catalog of stars that fits the density profile of the debris; this catalog\ncan then be used to constrain the dynamical models.\n\n\f\u20137\u2013\n2.\n\nAlgorithm for Fitting Spheroid Substructure\n2.1.\n\nGoals of the Algorithm\n\nStarting with a parameterized density model for the spheroid, a parameterized density\nmodel for the Sgr dwarf tidal stream, the absolute magnitude distribution for F turnoff\nstars, and a dataset of observed (l, b) angular coordinates and apparent magnitudes for\ncolor-selected F turnoff stars in a 2.5\u25e6 stripe through which a tidal stream passes, we find\nthe parameters for a tidal stream and stellar spheroid concurrently that give us the highest\nlikelihood of observing the data. This will allow us to tabulate summary statistics for the Sgr\ndwarf tidal stream, including position, width, and density. It will also allow us to test models\nfor the spheroid component of the Milky Way, and ultimately, it will allow us to construct\na catalogue of stars that fit the density profile of the Sgr tidal stream by probabilistically\nseparating the stream from the spheroid.\nThe parameters in our stellar density model describe the position, direction, and width\nof the tidal stream, as well as the shape of the smooth stellar spheroid. We start with an\ninitial set of parameters and iterate using a conjugate gradient search technique until the\noptimum values for each parameter given the data set are determined. From the parameters\nwhich produce the maximum likelihood, we estimate the errors in each parameter.\nOnce we have found the best parameters, we are able to use a separation algorithm to\ndivide the data into two sets of stars, one of which has the density profile of the stream and\nthe other of which has the density profile of the spheroid. While we cannot determine which\nof the individual stars in the data set belong to the stream and which belong to the spheroid,\nwe can separate the input catalog into two catalogs that will have the density properties of\nthe stream and the spheroid, respectively. These catalogs will allow for a close comparison\nof the stream density profile with that of simulations of tidal disruption and constrain the\ndynamical models used in simulations of tidal disruption.\n\u00a72.2 gives a brief overview of the algorithm. \u00a72.3 describes the construction of the probability density function. \u00a72.4 discusses the optimizaiton method we use. \u00a72.5 describes the\nmethod by which we estimate the errors in the parameters. \u00a72.6 discusses the application of\na separation algorithm to distinguish stream and spheroid stars. \u00a72.7 describes the computational time required to run the algorithm and the application of parallel processing as a\nway to improve efficiency. \u00a72.8 discusses some limitations and possible enhancements that\ncould be made in the future. A thorough discussion of the conjugate gradient and line search\noptimization method can be found in the Appendix.\n\n\f\u20138\u2013\n2.2.\n\nOverview of the Algorithm\n\nThe algorithm starts with initial guesses for the model parameters and an input catalog\nof observed F turnoff star positions as (l, b, g), which represent the Galactic longitude, in degrees; Galactic latitude, in degrees; and reddening corrected g magnitude for each star. The\napparent magnitudes are corrected for reddening using the Schlegel, Finkbeiner, & Davis\n(1998) reddening maps, as implemented in SDSS Data Release 6 (DR6).\nThe essence of the maximum likelihood technique is to create a parameterized probability density function (PDF), and then find parameters in this function which maximize the\nlikelihood of observing the data. We first select a parameterized stellar density function for\nthe spheroid and its substructure. Since the parameterized models describe the density as a\nfunction of space (X, Y, Z), and the observations include only Galactic coordinates (l, b) and\napparent magnitude, g, we need to relate spatial position to (l, b, g). The angular position in\nthe sky is very well known for each star, but it is difficult to determine the distance to each\nstar. We can only estimate the distance from its apparent magnitude, g. If all of the stars in\nthe sample have the same absolute magnitude, then the conversion of apparent magnitude to\ndistance is trivial. Unfortunately, this is not a good approximation for F turnoff stars, whose\nluminosity can deviate from the mean by a factor of 5 or more, even within the same age and\nmetallicity population. Instead, we approximate the distribution of absolute magnitudes of\nF turnoff stars as Gaussian.\nThe likelihood of observing the data is the product of the likelihoods of observing each\nof the stars within the dataset, given the model:\n~ =\nL(Q)\n\nN\nY\ni=1\n\n~\nP DF (li , bi , gi |Q),\n\n(1)\n\n~ is a vector representing the parameters in the\nwhere the index i runs over the N stars, Q\nmodel, and the probability density function (PDF) is a normalized version of the stellar density function that will be derived in the next section. Because the individual probabilities are\nsmall, we avoid numerical underflow by maximizing the average logarithm of the likelihood:\nN\n1\n1 X\n~\n~\nln P DF (li , bi , gi |Q),\nln L(Q) =\nN\nN i=1\n\n(2)\n\nwhich is maximized for the same parameters that the likelihood is maximized.\nWe have chosen as input to this first version of the maximum likelihood algorithm a\nvolume of the Galaxy sampled in a section of stripe 82. This volume is a piece of a wedge, 2.5\u25e6\nwide, with point at the Sun, limited in near and far end by the apparent magnitude range\n\n\f\u20139\u2013\n16 < g0 < 22.5. For F turnoff stars with absolute magnitude Mg = 4.2, the approximate\ndistance range is 2.3 < R < 45.7 kpc from the Sun. The near and far edges of the volume\nare fuzzy due to the inexact relationship between apparent magnitude and distance, and\nthe variable detection efficiency at the faint end. We chose this volume of a single stripe\nas the first application of the algorithm, for we do not have a global model for a general\ntidal stream; however, if we choose to look at a small enough volume of the stream (as is\nthe intersection of the stream with Stripe 82), we are able to approximate its shape as a\ncylindrical density with cross-sectional Gaussian fall-off from its axis. We model the entire\ntidal stream as a set of these cylindrical stream segments. This model will not work if the\nstream is in the plane of the wedge, but we show later that this cylindrical approximation\nworks for this stream in this wedge.\nThe algorithm begins by calculating the average log-likelihood for an initial set of parameters. A conjugate gradient with line search method is used to find the next set of\nparameters and the process iterates. Using this method, each subsequent set of parameters\nis guaranteed to produce an equal or higher likelihood in each iteration of the algorithm. The\nalgorithm continues to generate new sets of parameters until convergence, that is defined by\none of a number of conditions: either the gradient becomes so small that it would not provide foreseeable improvement, the line search returns negligible movement, or a maximum\nnumber of iterations is reached.\n\n2.3.\n\nThe Probability Density Function\n2.3.1. Tidal Stream Model\n\nIn general, tidal streams follow a complex path through the sky. The stars in the\nstructures may bunch up at apogalacticon and may have a complex cross-sectional density\nthat varies with position along the stream. However, within a single SDSS stripe through\nwhich the stream passes it is reasonable to approximate the path of the stream as linear (see\n\u00a73.3).\nWe model the stream in a piecewise linear fashion with a separate set of parameters\nfor each stripe of data in the SDSS, though in principle we could run this algorithm on any\n2.5\u25e6 -wide great circle, or set of 2.5\u25e6 -wide great circles on the sky. The length of the cylinder is\nlimited by the edges of the data in one stripe. The cross section is circularly symmetric with\na density that falls off as a Gaussian with distance from the stream axis. Figure 1 depicts\nthe data volume and the relationship between the stream parameters and the segment of a\ncylinder that describes the stream.\n\n\f\u2013 10 \u2013\nThe SDSS great circle coordinate system (\u03bc, \u03bd) is used to measure the angular position\non the sky. \u03bd is bounded by \u22121.25\u25e6 < \u03bd < 1.25\u25e6 for all stripes, and measures the angular\nposition across the narrow dimension of the stripe. \u03bd is by definition zero along the center\nof each stripe of data. \u03bc measures the angular distance along the great circle swept out by\neach stripe. The inclination of each stripe is the maximum angle between that stripe and\nthe Celestial Equator. Thus, \u03bc, \u03bd, and the stripe inclination uniquely specify the angular sky\ncoordinates.\nThe vector ~c points from the Galactic center to the axis of the cylinder. Normally, a\nvector requires three parameters, one for each dimension. However, since we have the freedom\nto require that the position along the cylinder axis to which it points be in the plane that\nsplits the volume in half along the narrow direction, we reduce that to two parameters.\nEnforcing the condition that \u03bd = 0, we are thus able to parameterize the stream center with\nonly a radial distance from the Sun, R (in kpc), and the angular position along the stripe,\n\u03bc (in degrees). Therefore, ~c(\u03bc, R) fixes the center point of a piece of tidal debris within an\nSDSS stripe and lies along the axis of our cylinder.\nThe unit vector \u00e2 describes the orientation of the axis of the cylinder. Again, we need\nonly two parameters because this vector is constrained to be of unit length. We parameterize\nthis vector using two angles \u03b8 and \u03c6, both in radians. \u03b8 is the angle between \u00e2 and the\nGalactic Z-axis. Z is perpendicular to the Galactic plane and points towards the North\nGalactic Cap. The azimuthal angle \u03c6 is measured counter-clockwise around the Z axis, as\nviewed looking down on the Galaxy from the North Galactic Pole, starting from the X-axis,\nwhich points in the direction from the Sun to the Galactic Center.\nThe last stream parameter, \u03c3 (in kpc), specifies the stream width and is the standard\ndeviation of the Gaussian distribution used to describe the density fall off with distance from\nthe cylinder axis. For a star with spatial coordinates given by ~p, the distance, d, from the\ncylinder axis is given by\nd =| (~p \u2212 ~c) \u2212 \u00e2 \u2217 (\u00e2 * (~p \u2212 ~c) | .\n(3)\nIn practice, this calculation is performed by first converting each vector to a Galactocentric\nCartesian coordinate system.\n\nIn summary, we use five parameters to define our cylindrical stream: \u03bc, R, \u03b8, \u03c6, and \u03c3.\nFigure 1 depicts how these parameters are defined with respect to the stripe volume. Using\nthese parameters, the stellar density of the stream at point ~p is:\nd2\n\n\u03c1stream (~p) \u221d e\u2212 2\u03c32 .\n\n(4)\n\nNormalization of the stellar density will be considered once we have assembled the entire\nprobability density function.\n\n\f\u2013 11 \u2013\n2.3.2. Spheroid\nWe model the stellar spheroid with a standard Hernquist profile (Hernquist 1990):\n1\n, where\nr(r + r0 )3\ns\nZ2\nr = X2 + Y 2 + 2 ,\nq\n\n\u03c1spheroid (~p) \u221d\n\n(5)\n\nand X, Y , and Z are Cartesian coordinates centered on the Galactic center. X and Y are\nin the Galactic plane, with X directed from the Sun to the Galactic center and Y in the\ndirection of the Solar motion. Z is perpendicular to the Galactic plane and points in the\ndirection of the North Galactic Cap. The spheroid is described by two parameters: r0 which\nis a core radius, in kpc, and the dimensionless quantity, q, which is scaling factor in the Z\ncoordinate direction. For q < 1 the spheroid is oblate, for q = 1 the spheroid is spherically\nsymmetric, and for q > 1 the spheroid is prolate.\nThere are many Galactic components (thick disk, bulge, etc) other than the spheroid\nthat we could in principle add to our full model. However, we don't expect many disk stars\nin our sample because we are fitting data that is too far from the plane of the Milky Way,\nand the color-selected F turnoff stars are bluer than the turnoff of the thick disk stellar\npopulation.\n\n2.3.3. Absolute Magnitude Distribution\nIn this section we address the fact that stars within our selected color range, which\nare primarily F turnoff stars, do not all have the same absolute magnitude. If we assume\nthat all of the color-selected stars have the same absolute magnitude (equal to the mean\nabsolute magnitude of the population) when we estimate their distances from the Sun, any\nsubstructure in the spheroid will appear to be elongated along our line of sight. To account\nfor this, we calculate an \"observed\" spheroid spatial density that is elongated along our\nline of sight by convolution of the density model with the absolute magnitude distribution\nfunction along our line of sight.\nWe model the distribution of absolute magnitudes as a Gaussian with a center of M\u0304g0 =\n4.2 and dispersion \u03c3g0 = 0.6, which is a simplification of the F turnoff star absolute magnitude\ndistribution found for globular clusters by Newberg and Yanny (2006). Thus, letting Mg0 be\nthe absolute magnitude,\nMg0 = M\u0304g0 + \u2206Mg0 ,\n(6)\n\n\f\u2013 12 \u2013\nwhere M\u0304g0 = 4.2 and \u2206Mg0 has a Gaussian distribution with zero mean and standard\ndeviation 0.6. To account for this distribution over the absolute magnitude, we first derive\nthe probability of observing a star per unit apparent magnitude per unit solid angle, assuming\nall stars are of absolute magnitude M\u0304g0 = 4.2, and then convolve in apparent magnitude with\na Gaussian of dispersion 0.6 centered at zero. The result is the probability of observing a star\nper unit apparent magnitude per unit solid angle, with the absolute magnitude distribution\ntaken into account.\nWe will need to refer to several density functions in different spaces, and so we first\nlay down some definitions to make this discussion clear. We will refer to a density as \u03c1A (x)\nwhere A is the name of the density which will refer to the coordinate space in which it is\ndefined and x refers to a generic variable in this space. Thus we define the 6 densities:\n\u03c1X (~x),\n\n\u03c1R (R, \u03a9),\n\n\u03c1g4.2 (g4.2 , \u03a9),\n\n\u03c1g0 (g0 , \u03a9),\n\n\u03c1R (R(g0 ), \u03a9),\n\n\u03c1Xc (~x),\n\n(7)\n\nwhere the first three densities are the model in Cartesian, spherical, and apparent magnitude\ncoordinate systems;\n\u03c1X (~x) =\n\ndV\n,\ndxdydz\n\n\u03c1R (R, \u03a9) =\n\ndV\ndV\n, and \u03c1g4.2 (g4.2 , \u03a9) =\n.\ndRd\u03a9\ndg4.2 d\u03a9\n\n(8)\n\nThe densities which take into account the distribution on the absolute magnitude space are\ndenoted by \u03c1g0 (g0 , \u03a9), \u03c1R (R(g0 ), \u03a9), and \u03c1Xc (~x), where the subscript c stands for convolved.\nAll coordinate systems are centered at the Sun, the solar position is assumed to be 8.5 kpc\nfrom the Galactic center, and the direction from the Sun to the Galactic center is in the\npositive X direction. Here we have made a distinction between R and R: R denotes the\nactual distance each star is from the Sun; R(g0 ) denotes the distance a star of apparent\nmagnitude g0 would be from the Sun if it had an absolute magnitude of M \u0304g0 = 4.2. We have\nalso made the distinction between g0 and g4.2 : g0 denotes the actual reddening corrected\napparent magnitude of a star. g4.2 denotes the apparent magnitude a star at distance R\nwould be calculated to have if it had an absolute magnitude of M\u0304g0 = 4.2. We will adopt\nthese definitions for the remainder of this paper.\nThe Galactocentric Cartesian density, \u03c1X , is the actual spatial density of stars as described in Equations 4 and 5 for the stream and spheroid, respectively. We need \u03c1Xc , the\nobserved Galactocentric Cartesian density that is elongated along our line of sight to account\nfor Gaussian distribution of absolute magnitudes with dispersion \u2206Mg0 . We will obtain \u03c1Xc\nthrough the sequence of transformations\n\u03c1X (~x) \u2192 \u03c1R (R, \u03a9) \u2192 \u03c1g4.2 (g4.2 , \u03a9) \u2192 \u03c1g0 (g0 , \u03a9) \u2192 \u03c1R (R(g0 ), \u03a9) \u2192 \u03c1Xc (~x).\n\n(9)\n\nThe relationship between these densities is determined by the transformations which take one\ncoordinate space to the other. The X \u2192 R mapping is the well known spherical coordinate\n\n\f\u2013 13 \u2013\ntransform,\n\u03c1R (R, \u03a9) = R2 \u03c1X (~x).\n\n(10)\n\nIf all of the stars had an absolute magnitude M\u0304g0 = 4.2, then one would measure an\napparent magnitude\nR\ng4.2 = 4.2 + 5 log10 ( 10pc\n), therefore\n\n(11)\n\nR = R(g4.2 ) = 100.2(g4.2 \u22124.2\u221210) (kpc), and\ndR =\n\nln 10\nRdg4.2 .\n5\n\nThus, the relationship between \u03c1R and \u03c1g is given by\n\u03c1g4.2 (g4.2 , \u03a9) =\n\ndg4.2\nln 10 3\nln 10 3\n\u03c1R (R, \u03a9) =\nR \u03c1X (~x) =\nR (g4.2 )\u03c1X (~x).\ndR\n5\n5\n\n(12)\n\nThe measured g0 is given by\ng0 = g4.2 + \u2206Mg0 .\n\n(13)\n\nSince g0 is the sum of independent random variables, its density is the convolution of the\ntwo densities, i.e., we have that \u03c1g0 (g0 , \u03a9) = \u03c1g \u2217 \u03c1\u2206Mg0 (g0 , \u03a9), where the convolution is in\nthe g-dimension. Thus,\nZ \u221e\n\u03c1g0 (g0 , \u03a9) =\ndg \u03c1g4.2 (g, \u03a9)N (g0 \u2212 g; u),\n(14)\n\u2212\u221e\n\nwhere N is the Gaussian density function given by:\n\n\u2212x2\n1\nN (x; u) = \u221a e 2u2 ,\nu 2\u03c0\n\n(15)\n\nwith u = 0.6. Switching back from apparent magnitude to spherical coordinates,\n\u03c1R (R(g0 ), \u03a9) =\n\n5 \u03c1g0 (g0 , \u03a9)\n,\nln 10 R(g0 )\n\n(16)\n\nSince the coordinate spaces Xc and R are related by the spherical coordinate transformation,\nwe may now collect our results and write the convolved density \u03c1Xc in terms of \u03c1X as follows:\n1\n\u03c1R (R(g0 ), \u03a9),\nR2 (g0 )\n5\n\u03c1g (g0 , \u03a9),\n=\n3\nR (g0 ) ln 10 0\nZ \u221e\n5\ndg \u03c1g (g, \u03a9) * N (g0 \u2212 g; u),\n=\nR3 (g0 ) ln 10 \u2212\u221e\nZ \u221e\n1\ndgR3 (g) * \u03c1X (~x(R(g), \u03a9)) * N (g0 \u2212 g; u),\n=\nR3 (g0 ) \u2212\u221e\n\n\u03c1Xc (~x) =\n\n(17)\n\n\f\u2013 14 \u2013\nwhere (R(g0 ), \u03a9) are the angular coordinates of ~x.\nWe have derived the convolved stellar density function \u03c1Xc , for a generic stellar density\n\u03c1X , which could represent either the stream or the spheroid densities in our present context.\nThis convolution is performed separately on the stream and spheroid densities, to compute\ncon\nthe functions \u03c1con\nstream (l, b, R(g0 )) and \u03c1spheroid (l, b, R(g0 )). We us the numerical integration\ntechnique of Gaussian quadrature (Heath 2002) to do the convolution integral.\n\n2.3.4. Combined Probability Density Function\nWe are now ready to compute the probability density function for the combination of\nthe stream and spheroid densities. To do this we need the stellar densities of the stream\nand spheroid as derived in \u00a72.3.3, the detection efficiency for finding stars as a function of\napparent magnitude, the volume over which the density is defined, and one more parameter,\n\u01eb, which describes the fraction of stars in each of the two components (spheroid and stream).\nThe detection efficiency function, E, was derived by fitting a sigmoid curve to the\ndetection efficiency measurement in Figure 2 of Newberg, Yanny et al. (2002). The efficiency\nfunction accounts for the decrease in detection efficiency at faint magnitudes:\nE(g0 ) =\n\ns0\n\n, where\nes1 (g0 \u2212s2 ) + 1\n~s = (0.9402, 1.6171, 23.5877).\n\n(18)\n\nThe dimensionless parameter that defines the fraction of the input stars that are in the\nstream and the fraction that are in the spheroid is \u01eb. The parameter \u01eb is modeled, as with\nthe stream parameters themselves, separately for each stripe of data that is analyzed. Thus,\nthe value of \u01eb for a given stripe of data gives only the relative number of stars that comprise\nthe stream as compared to the spheroid for that stripe of data and does not measure the\nfraction of stars in the stream as a function of position within the Galaxy.\nBy definition, the fraction of stars in the stream is:\nP [stream] =\nSimilarly for the spheroid\n\ne\u01eb\n.\n1 + e\u01eb\n\n(19)\n\n1\n.\n(20)\n1 + e\u01eb\nWe introduce here the concept of constrained and unconstrained variables. Instead of \u01eb, we\ncould have defined a variable f which is the fraction in the stream, and then the fraction\nP [spheroid] =\n\n\f\u2013 15 \u2013\nin the spheroid would be 1 \u2212 f . However, we would then need to maximize the likelihood\nsubject to the constraint that this parameter must be between zero and one. To avoid that\nconstraint, we instead introduced \u01eb, which is not constrained. If \u01eb is \u221e, then all of the stars\nare in the stream, if \u01eb = 0 the stars are evenly split between the components, and if \u01eb = \u2212\u221e\nthen all of the stars are in the spheroid component. The other parameters are naturally\nunconstrained and do not need a conversion.\nIn total, then, we fit eight model parameters: five from the stream fragment in the\ncurrent stripe (\u03bc, R, \u03b8, \u03c6, \u03c3), two from the spheroid (r0 , q), and one that specifies the fraction\nof stars in each component (\u01eb). Together, we will refer to these parameters as the eight\n~\ncomponents of the parameter vector Q.\nThe probability density function, then, is given by:\n~ =\nP DF (l, b, R(g0 )|Q)\n\n~\ne\u01eb\nE(R(g0 ))\u03c1con\nstream (l, b, R(g0 )|Q)\nR\n~\n1 + e\u01eb E(R(g0 ))\u03c1con\nstream (l, b, R(g0 )|Q)dV\n~\nE(R(g0 ))\u03c1con\n1\nspheroid (l, b, R(g0 )|Q)\n,\n+\nR\n~\n1 + e\u01eb E(R(g0 ))\u03c1con\n(l,\nb,\nR(g\n)|\nQ)dV\n0\nspheroid\n\n(21)\n\nwhere the integral is over the entire volume probed by the input data.\n\nCalculation of the volume integrals dominates the runtime of the algorithm. Since these\nintegrals cannot be solved analytically for our functions, we define an integration mesh which\ndivides the total volume into many volume elements. The edges of the volume elements are\nalong constant g, \u03bc, or \u03bd. We then calculate the spheroid and stream probabilities at the\ncenter of each volume element and multiply this by the volume of that element. The values\nfor the spheroid and stream probabilities in all volume elements are then summed and will\nbe hereafter referred to as the stream and spheroid integrals, respectively.\n\n2.4.\n\nOptimization\n\nNow that we have defined a probability distribution function and a likelihood measure,\nwe need to find the parameters that maximize that likelihood. At the beginning of the first\niteration of the program, the likelihood is calculated for the input parameters. Thereafter, a\nnew set of parameters and likelihood is calculated using a conjugate gradient search coupled\nwith a line search technique. For a detailed description of the conjugate gradient and line\nsearch methods employed see the Appendix \u00a7A.1 and \u00a7A.2, respectively.\n\n\f\u2013 16 \u2013\n2.5.\n\nErrors in the Parameter Estimates\n\nThe accuracy of the parameter estimates depends upon the the shape of the likelihood\nsurface at its maximum, which is governed by the number of stars in our input catalog. The\nfewer stars, the wider the peak at the maximum and the larger the statistical error. It is\nalso limited by the accuracy with which we are able to numerically determine the maximum.\nWe will address this latter point when we discuss the test data in \u00a73. Here, we explain how\nwe calculate the accuracy with which we expect to be able to determine each parameter.\nWe assume that the likelihood surface for the parameters can be reasonably estimated\nby a Gaussian near the maximum. Then, an estimate for the variance of each parameter\ncan be found from the square matrix of second order partial derivatives of the log-likelihood\nfunction, evaluated at the maximum. This matrix is called a Hessian Matrix, H. The\nvariance matrix V is the inverse of the Hessian Matrix, normalized by the number of stars\nin the data set:\n1\nV = H\u22121 .\n(22)\nN\nThe square roots of the diagonal elements of the matrix provide us with the statistical error\nin the measurement of each parameter. We compute the Hessian numerically using a finite\ndifference method (as we did the gradient) as follows:\nHij\nHij1\nHij2\n\nHij1 \u2212 Hij2 \u2212 Hij3 + Hij4\n, where,\n=\n4hi hj\n= L(Qj + hj , Qi + hi )|all other Q fixed ,\nk\n= L(Qj \u2212 hj , Qi + hi )|all other Q fixed ,\n\n(23)\n\nk\n\nHij3 = L(Qj + hj , Qi \u2212 hi )|all other Qk fixed ,\nHij4 = L(Qj \u2212 hj , Qi \u2212 hi )|all other Q fixed .\nk\n~ similarly for Qi ; and hj is the perturHere, Qj is the j th component of parameter vector Q,\nbation value for Qj , similarly for hi . In practice we use the same hk to calculate the gradient\nas the Hessian. These hk can be seen in Table 1.\n\n2.6.\n\nSeparation\n\nOnce we have found the values of the parameters in our model, we can use the model\nto separate the input catalog of stars into two catalogs, one having the density profile of the\nstream and the other having the density profile of the spheroid. It is possible to determine\nthe probability that a star is in the stream or in the spheroid, however, it is not possible\n\n\f\u2013 17 \u2013\nto determine which stars are in the stream and which are in the spheroid. For example,\nsuppose a star selected from the data set is computed to be a stream star with probability\n0.6 and that it is a spheroid star with probability 0.4. We would put that star in the stream\ncatalog with probability 0.6 and in the spheroid catalog with probability 0.4, but there is a\n48% chance that the star was put in the wrong file. The separation has proved very useful\nfor evaluating the effectiveness of the model fits to the data, and hopefully will be useful\nfor fitting tidal stripping models to the stream density profiles. However, it may not be\nthe best method for selecting spectroscopic follow-up targets to measure the composition\nand velocities of stream stars, for example. Spectroscopic follow-up targets might be better\nselected based on the probability that it is a stream star, rather than on the catalog to which\nit was randomly assigned.\nTo perform this separation, we calculate for each star the probability, T , that it was\ndrawn from the stream population given the parameters, where T is defined by\n~ =\nT (l, b, R(g0 ) | Q)\n\n~\nS(l, b, R(g0 ) | Q)\n,\n~ + B(l, b, R(g0 ) | Q)\n~\nS(l, b, R(g0 ) | Q)\n\n(24)\n\n~ is the stream portion of Equation 21, and B(l, b, R(g0 ) | Q)\n~ is the\nwhere S(l, b, R(g0 ) | Q)\nspheroid portion of Equation 21.\nA uniform random number between 0 and 1 is then generated and tested against this\nprobability. If the probability of being drawn from the stream population is greater than\nthat of the random number, then the star is placed into the stream star catalog; otherwise,\nit is placed within the spheroid catalog. We repeat this process, generating a new random\nnumber for each star until all stars have been placed into their appropriate catalog. Thus,\nwe get two distinct populations: one that is a smooth spheroid and one that has all the\ndensity properties of the stream.\nWe use this nondeterministic approach of testing the star probability against a random\nnumber for extracting the stream from the spheroid stars in order to get an accurate representation of the density profiles. Since the stream probability definition is based solely upon\nthe star's distance from the stream axis, assigning all stars with a probability greater than\na set value to the stream would result in assignment of all stars within a certain distance\nto the stream. This would not be an accurate representation of the stream as we would be\ncarving out a cylinder of stars from the data rather than a set of stars that fit a specific\ndistribution with Gaussian cross section in density.\n\n\f\u2013 18 \u2013\n2.7.\n\nRuntime and Distribution\n\nIn determining the likelihood, a trade-off needs to be made in the accuracy of the\nnumerical integral calculation in Equation 21. The smaller the step size, \u03b6, in each dimension\nthe more accurate the integral calculation is, which can lead to faster convergence of the\nsearch method being used. However, increasing the precision of the integral calculation leads\nto polynomially longer calculation time (scaling like \u03b6 3 ). Thus, the precision to which the\nintegral is calculated is the dominant factor in the runtime and accuracy of our astronomical\nmodel.\nTesting has shown that in order to generate a meaningful likelihood value in stripe 82,\na minimum of 1.4 million points within the stream and spheroid integrals is required. On\na single processor, this takes approximately 15 minutes, assuming there is no magnitude\ndistribution and the non-convolved probabilities are used. As performing a single conjugate\ngradient descent can take thousands (or more) integral calculations, these long execution\ntimes presented an obstacle to this research.\nTo generate a meaningful value for the magnitude convolution integral, each integral\npoint requires the calculation of at least 30 surrounding points. This increases the calculation\ntime of a single integral to 7.5 hours. Again, assuming a bare minimum of 1,000 likelihood\nevaluations for a single conjugate gradient descent (typically the range is closer to 5,000),\nevaluating one astronomical model would take almost a year on a single processor.\nTo alleviate these massive computational requirements, a Generic Maximum Likelihood\nEvaluator (GMLE1 ) has been developed and used (Desell, et al. 2007). GMLE allows for a\nlikelihood calculation to use various distributed computing environments, such as multiple\nprocessors in a cluster, a heterogeneous grid of clusters, or even a supercomputer.\nUsing this distributed framework with 88 processors on the Rensselaer Grid resulted\nin a 65 times speedup over a single processor and using 512 nodes of an IBM BlueGene/L\nsystem resulted in a 148 times speedup. It now takes only a few days to compute the\nmaximum likelihood parameters for a particular model and stripe of data. In both the\ngrid and supercomputing environments used, overhead of communication was very small\ncompared to the calculation time. Communication time consists of approximately 1-10%\nof the time to calculate the likelihood and does not noticeably increase as more processors\nare used. With these observations, the calculation should scale to at least 1000 processors\non a grid, and 10,000 processors on the IBM BlueGene/L. More precise calculations of the\nintegral and magnitude convolution will allow the distributed calculation to scale to even\n1\n\nGMLE is available for download along with more information at http://wcl.cs.rpi.edu/gmle\n\n\f\u2013 19 \u2013\nlarger numbers of processors, due to the increased calculation time assuming relatively fixed\ncommunication times.\nGMLE has also been extended to allow maximum likelihood evaluation over the Berkeley Open Infrastructure for Network Computing (BOINC) Internet computing framework\n(Anderson et al. 2005). This allows users to volunteer computing resources by downloading a BOINC client and attaching to the MilkyWay@Home project2 . Currently, over 500\ncomputers from around the world are being volunteered for the project and performance is\ncomparable to 512 nodes of the IBM BlueGene/L.\n\n2.8.\n\nLimitations and Enhancements\n\nGenerically, all enhancements to this algorithm either improve the Galaxy model, increase the quantity of data to which the model is fit, or improve the accuracy of speed and\naccuracy of the convergence. We plan to improve the algorithm in all of these aspects.\nWe plan to build up a model of the Milky Way stellar density, starting with the spheroid\ncomponent. Over time, we will be able to include additional streams and additional pieces\nof the Sagittarius dwarf tidal stream, a more sophisticated model of the smooth component\nof the spheroid, and disk components. The spheroid substructure is best fit in a piecewise\nmanner as we have done in this paper, but the smooth components require that more directions be fit simultaneously. To be able to fit multiple stripes during a single optimization\nit must be possible fit multiple debris pieces during a single run as well. To add additional\ntidal debris, we need only to add a term for each additional stream to the PDF:\nk\nX\n\n~\n\u03c1con\nstream (l, b, R(g0 )|Qstreami )\nP DF =\n[\n]\nR\n\u01ebj\n~\n\u03c1con\nstream (l, b, R(g0 )|Qstreami )dV\nj=1 e )\ni=1 (1 +\n~\n\u03c1con\n1\nspheroid (l, b, R(g0 )|Qspheroid )\n+\n,\nR\nP\n~\n(1 + ki=1 \u01ebi ) \u03c1con\nspheroid (l, b, R(g0 )|Qspheroid )dV\ne\u01ebi\nPk\n\n(25)\n\nwhere i and j denote the ith and j th stream of k total streams, respectively. We add five new\n~ stream , and a sixth parameter, \u01ebi , for each new stream segment. This change to\nparameters, Q\ni\nthe PDF would allow k pieces of tidal debris to be fit within a single or multiple stripes. We\nare considering whether we should enforce continuity conditions between adjacent sections\nof the tidal stream. Since it has been suggested that the smooth portion of the spheroid may\n2\n\nhttp://milkyway.cs.rpi.edu/milkyway/\n\n\f\u2013 20 \u2013\nnot be symmetric, we would like also to increase the number of parameters in the smooth\nspheroid component, following Newberg and Yanny (2006).\nWe are currently fitting only F turnoff stars, and assuming that the absolute magnitude\ndistribution of these stars is a standard Gaussian for all populations. Ideally, we would use\nstars in a wider color range, and develop a probability distribution in magnitude and color for\neach population of stars. This would increase the number of stars available to the algorithm\nand would allow us to use additional information about real structures in the Milky Way insisting that each population with a turnoff also has a main sequence and giant branch, for\nexample. Implementing this requires significant development not only in the computation\nof the likelihood, but also in characterizing Galactic stellar distributions. Small steps in\nimproving this aspect of the algorithm are currently underway.\nAll of the preceding improvements to the algorithm increase the number of fit parameters and the complexity of calculating the likelihood function. In parallel with scientific\ndevelopment of the algorithm, we will be improving the speed of convergence. We are experimenting with other methods of finding the maximum, and increasing the number of\narchitectures on which our software can be run in parallel. Future architectures that we\nwill use include supercomputers and BOINC, which among other products supports the\nSETI@home application.\n\n3.\n\nSimulated Data\n\n3.1.\n\nGeneration\n\nTo test our algorithm we generated a simulated version of SDSS stripe 82. The \"True\nValue\" column of Table 2 shows the parameter values used for the data generation while\nFigure 2 shows a plot of the simulated data. The data set contained a total of 205,708\nsimulated stars; 28,498 (13.85%)of which are stream stars. The stream model parameters\nand star ratio were chosen to be the same as the real data for stripe 82. The techniques of\ngeneration are described below.\n\n3.1.1. Stream\nWe create the simulated stream using an active generation technique, which means\nthat all points that are generated are valid stream stars. First, we define a set of stream\nparameters to generate over. From these parameters we then calculate the ~c and \u00e2 vectors\n\n\f\u2013 21 \u2013\ndefining our stream position and direction. We then generate three random numbers: a\nuniform random number that determines where along the stream axis the point is, and two\nGaussian random numbers (with standard deviation \u03c3 as defined in the parameters) to define\nthe stream cross-sectional coordinates. The point is then converted to Galactic longitude,\nlatitude and apparent magnitude. Thus far, we have assumed a constant absolute magnitude\nfor each star in the stream. To account for the fact that there is an absolute magnitude\ndistribution, we add or subtract a small amount from the apparent magnitudes of each of\nthe stream stars in the dataset. A Gaussian random variable with standard deviation 0.6\nis generated (one for each point); this value is added to the apparent magnitude of the\ngenerated point. Finally, we keep points with a probability given by the efficiency function\nto produce a data set for a simulated stream. Stars near the magnitude limit of the data are\ntossed out of the sample with a probability equal to the efficiency of our object detection as\na function of apparent magnitude in the real data.\n\n3.1.2. Spheroid\nThe simulated spheroid is generated using a rejection sampling technique. Here we\ncannot apply the same active generation technique we used for the stream because the density\ndistribution in the smooth component of the spheroid is more complex than a Gaussian.\nInstead, we define a rejection technique that allows us to generate over a given stripe. We\ncannot simply generate values for \u03bc, \u03bd, and R, however, because the stars are not uniformly\ndistributed in these variables. The distribution in \u03bd varies according to the cos(\u03bd), and the\ndistribution in R must take into account the growing volume at increasing distance. \u03bc may\nbe generated uniformly over the stripe as it corresponds to a longitude, and the volume of\nspace in each longitude bin is the same. The volume element in a stripe is given by:\ndV = R2 cos(\u03bd)drd\u03bcd\u03bd,\n\n(26)\n\nand the corresponding stripe volume is:\n3\nRmax\nV =\n(\u03bc+ \u2212 \u03bc\u2212 )(sin(\u03bd + ) \u2212 sin(\u03bd \u2212 )),\n3\n\n(27)\n\nwhere Rmax is the maximum radial distance, and the positive and negative superscripts refer\nto the maximum and minimum values of that coordinate for the stripe. These equations are\nused to define the functions which allow us to generate in the other two coordinates:\n\u03bd = sin\u22121 (u \u2217 (sin(\u03bd + ) \u2212 sin(\u03bd \u2212 )) + sin(\u03bd \u2212 )),\n1\n3\n\nR = Rmax w ,\n\n(28)\n\n\f\u2013 22 \u2013\nwhere u and w are uniform random numbers between zero and one. \u03bc is generated by a\nuniform random number between the stripe limits. Once a point is generated, its probability\nis calculated using the likelihood function developed in \u00a72.3. The probability is then divided\nby the total probability possible for a star. The total probability possible for a star is simply\nthe maximum value that can be returned by the likelihood function given the current volume\nand parameter set. The value of this ratio is then tested against a uniform random number\nbetween zero and one; the point is put into the data set if the value is greater than the value\nof the random number.\n\n3.1.3. Accuracy of Parameter Determination\nUsing the method described in \u00a72.5 we calculated the expected accuracy for each parameter. Since we created the simulated data with a known set of parameters, we therefore\nknow the true parameter values of the dataset. We can calculate the Hessian Matrix at the\noptimum values and subsequently get a set of error bars at the optimum values. These error\nbars therefore give us the accuracy with which we expect to find the values of the parameters.\nThe values of these errors can be found in the column \"Expected Deviation\" (the statistical\nerror bar) in Table 2 for the 205,708 star simulated data set.\nIn addition to the statistical errors, there can be numerical errors driven primarily by\nthe accuracy with which we determine the integrals. These numerical errors were estimated\nby determining the accuracy the likelihood can be calculated for a fixed number of points in\nthe numerical integration and then calculating the 'error' in each parameter by perturbing\na single parameter, holding all others fixed, until a change in the total likelihood is observed\nthat is greater than the minimum accuracy threshold of the numerical integration. It should\nbe noted that the values quoted as \"Numerical Error\" are heuristic errors, meaning they are\nestimated and not a true error bar.\n\n3.2.\n\nTesting\n\nWe tested our algorithm by letting it optimize to convergence for eight randomized sets\nof input parameters. Randomized here means a random perturbation of the actual values\nby 75 percent of the parameter's value. Although parameters outside of this range are in\nprinciple allowed, the likelihood surface for parameter values very far from the correct values\nis so flat, and the gradient so small, that numerical errors dominate our measurement of\nthe gradient. In these eight optimizations: five optimized to the true values, two optimized\n\n\f\u2013 23 \u2013\nto a local maxima which has a lower likelihood than that of the true values, and one did\nnot converge because it was far enough from the correct parameter values that the gradient\ncould not be accurately determined. The local maxima appears to be related to the fact\nthat the stream crosses the stripe at low inclination, the algorithm sometimes fits the data\nwith a much higher inclination angle and larger width to compensate. All other parameters\nare still optimized to their true values at this local maxima.\nThe average values of the returned parameters from the five optimizations to the true\nvalues are presented in the \"Optimized Value\" column of Table 2, and the \"Actual Deviation\" is the deference between the \"True Value\" and the \"Optimized Value.\" The returned\nparameters have very little deviation. The standard deviation of the five optimizations were\ncalculated to be around an order of magnitude lower than the statistical error calculated\nfrom the Hessian. These can be be seen in the \"Std. Deviations of Optimizations\" column\nof Table 2. Note that if the theoretical deviation is large for a particular parameter then\nnear the maximum, the likelihood changes little with the variation of that parameter. This\nleads to a larger \"Actual deviation,\" and can also make it more difficult for the algorithm to\nnumerically find the maximum since the gradient will be very small. The errors calculated\nfrom the Hessian assume that the maximum of the PDF is found exactly.\nAs can be seen in Table 2, all of the parameters have \"Actual Deviations\" which are\nsmaller than their \"Theoretical Deviations\" with the exception of r0 . It has been discovered\nthat the likelihood changes so little compared to perturbations in these parameters when\nclose to the maximum that this parameter is not being calculated accurately enough to\nreach the \"True Value\" seen in Table 2. The true error bar should be taken as the sum, in\nquadrature, of the \"Expected Deviation\" and \"Numerical Error\" columns. Once this is done\nthe \"Optimized Value\" of all parameters are comparable, within the errors, to the \"True\nValue.\"\nFinally, we ran our separation algorithm upon the average returned parameter values\nto create two catalogs of stars given those parameters, and we plotted these separately in\nFigure 3. Clearly visible is the stream with a Gaussian density fall off in the left plot, while\nthe right plot depicts a smooth Hernquist profile.\nWe also tested our algorithm on this same simulated dataset of 205,708 stars without\nusing an absolute magnitude correction, thereby simply assuming that all F turnoff stars\nhave an absolute magnitude, M\u0304g0 = 4.2. This was done to see how important this correction\nwas and to see whether the algorithm could be effectively used without it. The results showed\nthat the parameters of \u03bc and r0 were the only values not affected by this correction; the rest\nof the parameters deviated wildly from their actual values with the stream parameters R, \u03b8,\nand \u03c6 being the worst of the eight parameters reaching upwards of 34\u03c3 in error.\n\n\f\u2013 24 \u2013\n3.3.\n\nRobustness of Models\n\nThe previous section showed that the algorithm produces the correct answer given that\nthe data is drawn from our model. In this section, we test the algorithm on data that was not\ngenerated according to the assumed spatial model. We constructed a reproduction of the Sgr\nDwarf Galaxy tidal disruption produced by Law et al. (2005) using a semi-analytic N-body\napproach. Using their parameters for the Galactic potential and kinematic values, we constructed an orbit for Sagittarius using the NEMO Stellar Dynamics Toolbox (Teuben, P.J.\n1995). Specifically, we used the case of a spherical dark matter halo, with a velocity dispersion of 114 km/s. We used a Plummer Sphere with one million particles as our model for\nSagittarius, The sphere was evolved along the orbit for 3.18 Gyr until it reached the present\nposition of the Sgr dwarf spheroidal. The resulting plot of the disruption of Sagittarius is\nshown in Figure 4. It is consistent with the results obtained by Law et al. (2005).\nWe then selected the volume corresponding to SDSS stripe 82 from the N-body simulation and fit it using our model Hernquist profile spheroid and maximum likelihood technique.\nUsing the output model parameters found by our algorithm, we created a new simulated\nstream as described in \u00a73.1.1. Finally, we compared the cross-sections of this simulated\nstream with that of a similar stream generated with our density model.\nA cross-section of these two streams 1 kpc thick and centered at the returned stream\ncenter are plotted, along with a histogram of the stars within the cross-section, in Figure\n5. Figure 5 (left panel) depicts the N-body simulation stream while Figure 5 (right panel)\nis that of our simulated stream. It can be seen that the N-body simulation is indeed not\nGaussian. The drawback to testing with an N-body model is that there are no correct\nmodel parameters with which to compare; but the center, as shown in Figure 5 (left), and\nthe direction, as shown in Figure 4, are reasonable. In order to assess the error in the\ndetermination of the stream center, one would have to define what is meant by the center of\nan asymmetric distribution, but the algorithm's choice seems reasonable.\nNext, we estimate the curvature of the Sgr tidal stream in stripe 82. Taking the distance\nto the center of the stream in stripe 82 to be 29 kpc (Newberg, Yanny et al. 2003) we calculate that the 2.5\u25e6 -wide SDSS stripes would be 1.3 kpc thick at this distance. The length of the\nstream in stripe 82, taking an inclination of 30\u25e6 from the stripe (Freese, Gondolo, & Newberg\n2005), is then 2.5 kpc. We estimate the radius of curvature of the Sgr tidal tail in the orbital\nplane at this point to be 18 kpc by fitting a circle to the two southern stripes with detections\nin Newberg, Yanny et al. (2003). The deviation from linear can then be found to be d = 0.06\nkpc at the edge and is very small when compared to the 6 kpc (Freese, Gondolo, & Newberg\n2005) width of the stream or the 6.74 kpc width found in this paper. The linear approximation is quite reasonable for the Sgr stream in stripe 82.\n\n\f\u2013 25 \u2013\nFinally, we tested our algorithm with differing spheroid models. Because it was easier\nto change the spheroid model we fit than to regenerate many sets of spheroid stars, we\nmodified the exponential component of the model Hernquist profile the algorithm fits to the\ndata. Three tests were performed with the exponent of the Hernquist profile set to 3.5, 2.5\nand 2.0 as compared to the value of 3.0 used to generate the data. The results from these\ntests can be found in Table 3. In all cases, the stream parameters and the epsilon parameter\nsaw little to no change (all optimizations were within the errors calculated above). As\nexpected, the spheroid parameter values were incorrect, but represent the best parameters\nfor the model profile fit to the simulated data within our generated volume.\n\n4.\n\nResults From SDSS Stripe 82\n\nAfter validating the algorithm on the simulated data, we then applied the algorithm\nto the stripe 82 data as described in \u00a72.2. Figure 6 shows a plot of this data where a\npiece of the Sgr tidal stream is clearly visible as a dense structure on left of the image at\n(\u03b1, g0) \u2248 (31, 21.5).\nWe selected from the SDSS SkyServer Data Release 6 all of the sources in stripe 82 that\nhad magnitudes 16 < g0 < 22.5, colors of 0.1 < (g \u2212 r)0 < 0.3 and (u \u2212 g)0 > 0.4, were\nidentified as point sources, and were not EDGE or SATURATED. Since the selected stars\nare far from the Galactic plane, the reddening can reasonably be estimated from the total\namount of dust in that direction in the sky. The subscript \"0\" indicates that we selected\nreddening corrected magnitudes from the SDSS databases. The cut in (u-g) is made to\nremove low-redshift QSOs. We limited the angular length along stripe 82 to 109\u25e6 , with\nright ascension in the range 310\u25e6 < \u03b1 < 360\u25e6, 0 < \u03b1 < 59\u25e6 . Since stripe 82 is centered on\nthe Celestial Equator, the edges of the stripe are \u00b11.25\u25e6 in declination and the angle along\nthe stripe is given exactly by right ascension. A small section of data with right ascension\n323.2\u25e6 < \u03b1 < 323.6\u25e6 and declination \u22121.0\u25e6 < \u03b4 < \u22120.7\u25e6 was removed in order to avoid a\nglobular cluster. The final dataset includes 115,907 stars.\nAs was done for the test data, a number of randomized sets of initial parameters were\nused (having the same 75% perturbation) and the average of the parameters of those optimizations that converged to a minima was taken. In this case ten total optimizations were\nperformed, five optimized to a minima, four to a local minima with lower likelihood than\nthe true minima, and one was again a poor starting point allowing for no optimization. The\nHessian method was then used to calculate the error bars for these parameters at the true\nminima. The errors, as well as the average parameter values, are tabulated in Table 4. There\nare additional, unknown systematic errors for real data that were not present for the model\n\n\f\u2013 26 \u2013\ndata. The quoted errors assume that the model is an accurate representation of the stellar\ndensity function, including our formula for the smooth spheroid, tidal stream, and absolute\nmagnitude distribution.\nThe average parameter values were used as input for our separation algorithm to create\nstream and spheroid catalogs for stripe 82. These catalogs were then plotted in Figure 7.\nAs can be seen, the Sgr tidal stream has been clearly extracted from the spheroid in the left\npanel while the spheroid remains in the right panel.\nWe compared the average stream center and direction with Figure 4 from Newberg et al.\n(2007) in Figure 8 of this paper. As can be seen in the figure, the stream direction is roughly\ntangent to the stream of 2MASS M giants (though at a different distance \u2212 there is a\ndifference in scale between distances measured with the M giants and distances measured\nwith F turnoff stars and RR Lyraes). Notice also that the stream direction does not lie exactly\nin the plane of the Sgr dwarf, but is tilted slightly with respect to the XSgr \u2212YSgr plane (3\u25e6 \u00b1\n1\u25e6 ). We also compare our direction to the directional results of Freese, Gondolo, & Newberg\n(2005), who estimated the angle between the observational plane and the Sagittarius dwarf\nstream to be 30\u25e6 and the angle between the normal to the line of sight towards a point and\nthe tangent of the stream at that point to be 10\u25e6 . We calculated the former angle from\nour parameters by taking the angle between the observational plane of stripe 82 and the\ndirectional vector. Doing this we get a value of 30\u25e6 \u00b1 3\u25e6 . Our value agrees perfectly. The\nsecond angle was calculated by first finding the line of sight vector to the center of the stream,\ncalculating a normal to that, and then finding the angle between the stream direction and\nthat normal. We found a value of 22.5\u25e6 \u00b1 0.2\u25e6 . This difference is explained by the drastically\nimproved accuracy of the maximum likelihood algorithm over the estimate by eye for this\nmore difficult angle. A tabulation of the stream center position and the stream direction in\nvarious coordinate systems can be found in Table 5. Note that the Cartesian Center and\nCartesian Direction correspond to the vectors ~c and \u00e2, respectively, that are used in \u00a72.3.1.\nOur results are in reasonable agreement with those of Newberg, Yanny et al. (2003),\nbut with much tighter error bars. The center of the stream is shifted from \u03b1 = 33.99\u25e6 \u00b1 1\u25e6 to\n\u03b1 = 31.37\u25e6 \u00b1 0.25\u25e6 . This shift is slightly larger than expected, but not overly so. Note also\nthat the Newberg, Yanny et al. (2002) estimate of the center in F turnoff stars is \u03b1 = 33\u25e6 ,\nwhich is closer to our value. Our detection of radial distance, however, corresponds exactly\nto that seen in the Newberg, Yanny et al. (2003). Our stream width of \u03c3 = 2.86 is equivalent\nto a FWHM of 6.7 kpc, which is in good agreement with the value of 6 kpc estimated in\nFreese, Gondolo, & Newberg (2005).\nThe stream ratio \u01eb provides a very good separation as shown in Figure 7 and corresponds to a detection of approximately 16,000 stream stars out of the total 115,907\n\n\f\u2013 27 \u2013\nF turnoff stars in the stripe. By performing a calculation parallelling Equation 10 of\nFreese, Gondolo, & Newberg (2005) we are able to get an estimate of the total stellar mass\nin stripe 82 as a fraction of the Sgr dwarf itself. We first calculate the number of stars in\nFigure 6 of Newberg, Yanny et al. (2002) with 0.1 < (g \u2212 r)0 < 0.3 and 16.0 < g0 < 22.5.\nThis was calculated to be 2,194 stars. We then use this in place of the value calculated\nfor F/G type stars in Equation 10 of Freese, Gondolo, & Newberg (2005) to get the total\nnumber of F turnoff stars currently in the Sgr dwarf itself. This results in a total of 1,798,700\nF turnoff stars in the Sgr dwarf. Dividing this by the 16,050 stars found to be in the stream\nin stripe 82 yields that stripe 82 contains 0.9% of the Sgr dwarf's current F turnoff stars.\nOur spheroid parameters of q = 0.46 and r0 = 19.4 are slightly unexpected given the\nprevious work in Bell et al. (2007), which finds that the flattening parameter for the stellar\nhalo closer to q = 0.6. However, this does not discount that the best likelihood for the stellar\nhalo is obtained from these results, only that they were not the expected. Further results\nfrom other data sets and other stripes will be needed to determine the consistency of these\nresults amongst other stripes and confirm such a strong flattening of the stellar halo.\n\n5.\n\nConclusions\n\nWe have measured the position, direction, distribution, width and number or F turnoff\nstars of the Sgr tidal debris in SDSS stripe 82 as well as the stellar spheroid parameters corresponding to flattening and core radius. Our work has resulted in the improved measurement\nof the Sgr stream width (FWHM = 6.74 \u00b10.06 kpc), position [(\u03b1, \u03b4, R) = 31.37\u25e6 \u00b10.26, 0.0\u25e6 ,\n29.22 \u00b1 0.20 kpc], and direction [(X, Y, Z)galactic = \u22120.991 \u00b1 0.007 kpc, \u22120.042 \u00b1 0.033 kpc,\n0.127 \u00b1 0.046 kpc]. We measured the number of F turnoff stars in the stream in SDSS stripe\n82 (13.86 \u00b1 0.06% of 115,907). There are 16, 050 Sgr F turnoff stars in stripe 82 compared\nto 1.8 \u00d7 106 turnoff stars in the Sgr dwarf itself (0.9%). We also calculated values for the\nstellar spheroid parameters: the flattening parameter (q = 0.46 \u00b1 0.024) and the core radius\n(r0 = 19.40 \u00b1 0.59). While these spheroid parameters are not the expected values, they are\nintriguing and deserve further study. Finally, we were able to generate separate catalogs of\nstream stars and spheroid stars for the F turnoff stars in stripe 82. These catalogs, while\nnot a true representation of the actual stars in the stream or spheroid, provide the correct\ndensity characteristics of these structures and can be compared with the density profiles of\nN-body simulations.\nThe results were calculated using a new method to study tidal debris that is more robust\nthan previous methods. This method will prove valuable to the study of tidal disruption and\nGalactic structure as it provides a means to accurately and efficiently study many variables\n\n\f\u2013 28 \u2013\nused to model the spheroid and tidal debris. Also, we are able to extract a catalog of stream\nstars which can be used to better constrain models of the Sgr dwarf disruption by providing\nactual stream stellar positions to compare with the data.\nThe algorithm itself is quite flexible. The stream and spheroid models can be easily\nchanged should more accurate ones be discovered. The new model definitions would simply\nreplace the existing probability code with no other changes. Also, with minor changes to the\nvolume definitions it would be possible to use data from surveys other than the SDSS as an\ninput catalog. With some revisions, the code could be adapted to search for multiple debris\nand use multiple volumes to provide more accurate results.\nThis publication is based upon work supported by the National Science Foundation\nunder Grant No. SEI(AST)-0612213. Additional support was provided by the NSF grants\nAST 0607618 and CNS 0323324, NASA New York Space Grant, and John A. Huberty. We\nthank Brian Yanny for his help in the extraction of data and overall troubleshooting he did\nto aid us in this work.\nWe use data from the Sloan Digital Sky Survey. Funding for the SDSS and SDSS-II has\nbeen provided by the Alfred P. Sloan Foundation, the Participating Institutions, the National\nScience Foundation, the U.S. Department of Energy, the National Aeronautics and Space\nAdministration, the Japanese Monbukagakusho, the Max Planck Society, and the Higher\nEducation Funding Council for England. The SDSS Web Site is http://www.sdss.org/.\nThe SDSS is managed by the Astrophysical Research Consortium for the Participating\nInstitutions. The Participating Institutions are the American Museum of Natural History,\nAstrophysical Institute Potsdam, University of Basel, University of Cambridge, Case Western\nReserve University, University of Chicago, Drexel University, Fermilab, the Institute for Advanced Study, the Japan Participation Group, Johns Hopkins University, the Joint Institute\nfor Nuclear Astrophysics, the Kavli Institute for Particle Astrophysics and Cosmology, the\nKorean Scientist Group, the Chinese Academy of Sciences (LAMOST), Los Alamos National\nLaboratory, the Max-Planck-Institute for Astronomy (MPIA), the Max-Planck-Institute for\nAstrophysics (MPA), New Mexico State University, Ohio State University, University of\nPittsburgh, University of Portsmouth, Princeton University, the United States Naval Observatory, and the University of Washington.\n\n\f\u2013 29 \u2013\nAPPENDIX\nA.\n\nOptimization Technique\n\nA.1.\n\nConjugate Gradient\n\nThe conjugate gradient method is similar to the gradient method in that we perturb\nthe current parameter value, Qi , by a small amount, hi , and get a direction for the change in\nthe parameter space. However, unlike the gradient method, the conjugate gradient method\nenforces the condition that each direction is conjugate to the previous direction. This means\nthat as we move along the new search direction, the component of the gradient parallel to\nthe previous search direction must remain zero. This condition speeds up the optimization\nby using search directions that are non-interfering. A further discussion may be found in\nFletcher (1987).\n~ is calculated numerically by perturbing\nThe ith component of the gradient vector, G,\nQi , holding all other Qj fixed:\nGi =\n\nL(Qi + hi ) \u2212 L(Qi \u2212 hi )\n,\n2hi\nall other Qj fixed\n\n(A1)\n\nwhere Gi is the ith component of the gradient vector, Qi is the ith parameter, hi is the\nperturbation amount for that parameter, and L is the likelihood function from \u00a72.2.\n~ for the first iteration:\nThis gradient is used to calculate the direction, D,\n~1 = G\n~ 1.\nD\n\n(A2)\n\nWe take the positive value of the gradient, for we want to maximize the likelihood. Should we\nwant to perform a simple gradient ascent we would do this same calculation for every iteration\nand use solely the direction calculated above; however, we wish to apply the conjugate\ngradient technique which always calculates a direction conjugate to the previous directions.\nThis is done by calculating a multiplier, Bi , based upon the current gradient and the previous\ngradient, as;\n~ i * (G\n~i \u2212 G\n~ i\u22121 )\nG\nBi =\n,\n(A3)\n~2\nG\ni\u22121\n\n~ i denotes the gradient vector for the ith iteration. This value is then used to calculate\nwhere G\nthe new conjugate gradient direction:\n~i = G\n~ i + Bi \u2217 D\n~ i\u22121 ,\nD\n\n(A4)\n\n\f\u2013 30 \u2013\n~ i denotes the direction vector of the ith iteration (the direction to move the current\nwhere D\n~ i is the gradient of the current parameters, Qi , at the the ith iteration.\nparameters) and G\nDue to the large variety of parameters that we utilize, all on different scales, we do not\nuse one value for our perturbation value, h, for it could potentially produce poor estimates\nfor the gradient if the perturbation is too large or small for a given parameter. If h is too\nlarge, then the computed gradient is not an accurate approximation of the true gradient\nat the current point; if h is too small then we may encounter computational errors. We\ntherefore choose an appropriate value for each parameter independently. Table 1 shows the\nperturbation values for each parameter. These numbers were chosen in two ways. The\nvalues of the gradient were calculated at a number of differing perturbation values in order\nto determine how much the gradient changed. Also, plots of all parameter spaces were\ngenerated in order to determine the distribution of each parameter. Combining these two\ntechniques we were able to determine a value for the perturbation for each parameter that\nwould be small enough to provide a very accurate gradient calculation, but also large enough\nto overcome any anomalous behavior within the parameter's distribution.\n\nA.2.\n\nLine Search\n\nThe line search technique seeks to determine the value, \u03b1, that minimizes the function\n~ k + \u03b1D\n~ k ),\n\u03a6(\u03b1) = L(Q\n\n(A5)\n\n~ k is the direction and Q\n~ k is the current set of parameters. After finding \u03b1\u2217 which\nwhere D\nminimizes \u03a6(\u03b1), we then update\n~ k+1 \u2190\u2212 Q\n~ k + \u03b1\u2217 D\n~ k.\nQ\n\n(A6)\n\nA bracketing method must be employed first to ensure that the minimum of the function\nis within the range we are searching. This is done by calculating the likelihood at three\npoints along the current search direction: the current parameter values plus zero, one, and\n~ k . This corresponds to the current position, the current position plus the full\ntwo times D\ndirection, and the current position plus twice the full direction. If the middle point does not\nhave a likelihood greater than the two endpoints, the endpoint with the highest probability\nbecomes the new center point, the center point the end, and a new third point is calculated by\nexpanding to two times the current factor times direction and the new likelihood is calculated.\nIteration continues until the midpoint has a greater likelihood than both endpoints.\nThese three points are then passed to the line search algorithm which will use them\nto find the peak of the parabolic function defined by moving along the current directional\n\n\f\u2013 31 \u2013\nvector and calculating the likelihood at points along this path. The line search iterates as\nfollows: first a guess is made for the value of \u03b1 by fitting a parabola via the calculation:\nu = a21 \u2217 (L2 \u2212 L3 ) + a22 \u2217 (L3 \u2212 L1 ) + a23 \u2217 (L1 \u2212 L2 ),\n\n(A7)\n\nb = a1 \u2217 (L2 \u2212 L3 ) + a2 \u2217 (L3 \u2212 L1 ) + a3 \u2217 (L1 \u2212 L2 ),\nu\n\u03b1 = 0.5 \u2217 ,\nb\nwhere a1 , a2 , and a3 are the factors multiplied by the current direction that produce the\nparameters with likelihood L1 , L2 , and L3 , respectively. For the first iteration, a1 , a2 , and\na3 are the values returned from the bracketing method. \u03b1 is then the current guess for the\nvalue to minimize Equation A5. The likelihood L\u03b1 is then calculated using the parameters\ngenerated using \u03b1. The new order of the three points is:\nif : \u03b1 > a2 and L\u03b1 > L2 ; then : 1, 2, \u03b1,\n\n(A8)\n\nif : \u03b1 > a2 and L\u03b1 < L2 ; then : 2, \u03b1, 1,\nif : \u03b1 < a2 and L\u03b1 > L2 ; then : \u03b1, 2, 3,\nif : \u03b1 < a2 and L\u03b1 < L2 ; then : 1, \u03b1, 2.\nIn short, the distance along the search direction is reduced based upon the value of \u03b1 and\nits corresponding likelihood. These new points are then used to calculate a new guess for\n\u03b1 using Equations A6 through A8. Iteration continues for a set number of iterations until\nreturning the optimum value of \u03b1; we currently use three.\nOnce we have calculated the change in the parameters, utilizing the conjugate gradient\nand line search methods, we then update the value of the probability for the fit using the\nsame method as discussed in \u00a72.3 and continue to maximize our probability through the use\nof the conjugate gradient and line search methods. The algorithm stops iterating and returns\nthe current values when the value of the largest component of the conjugate gradient drop\nbelow a set threshold, the line search returns a value that would cause negligible movement,\nor the algorithm has completed a maximum number of iterations.\n\n\f\u2013 32 \u2013\nREFERENCES\nAbazajian et al., Astron.J. 126 (2003) 2081.\nAdelman-McCarthy, J. K., et al. 2007, ApJS, submitted, arXiv:0707.3413\nAnderson, David P., Korpela, Eric, Walton, Rom. 2005, \"High-Performance Task Distribution for Volunteer Computing\", e-Science, 196-203\nBahcall, J. 1986, ARA&A, 24, 577\nBell, Eric F., Zucker, Daniel B., Belokurov, Vasily, et al., 2007, ApJ, submitted,\narXiv:0706.0004\nBellazzini, M., Ibata, R., Ferraro, F. R., Testa, V., 2003, A&A, 405, 577\nBelokurov, V. et al. 2006a, ApJ, 647, L111\nBelokurov, V., Zucker, D. B., Evans, N.W., et al. 2006b, ApJ, 642, L137\nBelokurov, V., Evans, N.W., Irwin, M. J., Hewett, P. C., & Wilkinson, M. I. 2006c, ApJ,\n637, L29\nBelokurov, V. et al. 2007a, ApJ, 654, 897\nBelokurov, V. et al. 2007b, ApJ, 657, L89\nChou, Mei-Yin, Majewski, S. R., et al. 2007, ApJ, 670, 346\nDesell, T., Cole, N., Magdon-Ismail, M., Newberg, H., Szymanski, B., Varela, C. To appear\nDecember 10-13, 2007, \"Distributed and Generic Maximum Likelihood Evaluation\",\n3rd IEEE International Conference on e-Science and Grid Computing (eScience2007),\nBangalore, India\nDuffau, S., Zinn, R., Vivas, A. K., et al. 2006, ApJ, 636, L97\nFellhauer, M., Belokurov, V., Evans, W. et al. 2006, ApJ, 651, 167\nFletcher, R. 1987, Practical Methods of Optimization, 2nd edition (New York: WileyInterscience)\nFreeman, K. C. 1987, ARA&A, 25, 603\nFreeman, K., and Bland-Hawthorn, J. 2002, ARA&A, 40, 487\n\n\f\u2013 33 \u2013\nFreese, K., Gondolo, P., Newberg, H. J. 2005, Physical Review D, 71, 4\nFukugita, M., Ichikawa,T., Gunn, J. E., Doi, M., Shimasaku, K., Schneider, D. P. 1996, AJ,\n111, 1758\nGilmore, Wyse, Kuijken 1989, ARA&A, 27, 555\nG\u00f3mez-Flechoso, M. A., Fux, R., Martinet, L., 1999, A&A, 347, 77\nGrillmair, C. J. 2006, ApJ, 645, L37\nGrillmair, C. J. & Dionatos, O. 2006, ApJ, 643, L17\nGrillmair, C. J. & Dionatos, O. 2006, ApJ, 641, L37\nGrillmair, C. J. & Johnson, R. 2006, ApJ, 639, L17\nGunn, J. E. et al. 1998, AJ, 116, 3040\nHeath, Michael, T. 2002, Scientific Computing, 2nd edition (New York, McGraw-Hill)\nHelmi, A., White, S. D. M., 2001, MNRAS, 323, 529\nHelmi, A., 2004, ApJ, 610, L97\nHernquist, L. 1990, ApJ, 356, 359\nHogg, D. W., Finkbeiner, D. P., Schlegel, D. J., and Gunn, J. E. 2001, AJ, 1222, 2129\nIbata, R. A., Gilmore, G., and Irwin, M. J. 1994, Nature, 370, 194\nIbata, Rodrigo A., Wyse, Rosemary F. G., et al., 1997, AJ, 113, 634\nIbata, Rodrigo A., Lewis, Geraint F., 1998, ApJ, 500, 575\nIbata, R., Irwin, M., Lewis, G. F., and Stolte, A. 2001, ApJ, 547, L133\nIbata, R., Lewis, G. F., et al. 2001, ApJ, 551, 294\nIrwin, M. J. et al. 2007, ApJ, 656, L13\nJohnston, K. V., Spergel, D. N., Hernquist, L., 1995, ApJ, 451, 598\nJohnston, K. V., Spergel, D. N., Hadyn, C., 2002, ApJ, 570, 656\nJohnston, K. V., Law, D. R., Majewski, S. R. 2005, ApJ, 619, 800\n\n\f\u2013 34 \u2013\nLaw, David R., Johnston, Kathryn V., and Majewkski, Steven R. 2005, ApJ, 619, 807\nLaw, David R., et al. 2004, PASP, 327\nMajewski, S. R., Skrutskie, M. F., Weinberg, M. D., and Ostheimer, J. C. 2003, ApJ, 599,\n1082\nMajewski, S. R., Kunkel, W. E., Law, D. R., Patterson, R. J., et al. 2004, AJ, 128, 245\nMart\u0131\u0301nez-Delgado, D., G\u00f3mez-Flechoso, M. A., Aparicio, A., and Carrera, R. 2004, ApJ,\n601, 242\nMart\u0131\u0301nez-Delgado, D., Pen\u00f1arrubia, J., et al. 2007, ApJ, submitted, astro-ph/0609104\nPe\u00f1arrubia, J., Mart\u0131\u0301nez-Delagdo, D., Rix, H. W., G\u00f3mez-Flechoso, M. A., Munn, J., Newberg, H., Bell, E. F., Yanny, B., Zucker, D., & Grebel, E. K. 2005, ApJ, 626, 128\nNewberg, H., Yanny, B., et al. 2002, ApJ, 569, 245\nNewberg, H., Yanny, B., et al. 2003, ApJ, 596, L191\nNewberg, H. J. & Yanny, B. 2005, A. S. P. Conf. Ser., 338, 210\nNewberg, H. & Yanny, B. 2006, Journal of Physics: Conference Series 47, 195\nNewberg, H., Yanny, B., et al. 2007, ApJ, arXiv:0706.3391v1\nOdenkirchen, M. et al. 2001, ApJ, 548, L165\nPier, J. R., Munn, J. A., Hindsley, R. B., Hennessy, G. S., Kent, S. M., Lupton, R. H., and\nIvezi\u0107, Z. 2003, AJ, 125, 1559\nRobin, A. C., Reyl\u00e9, C., Derri\u00e8re, S., Picaud, S., 2003, A&A, 409, 523\nRocha-Pinto, H. J., Majewski, S. R., Skrutskie, M. F., Crane, J. D., and Patterson, R. J.\n2004, ApJ, 615, 723\nRockosi, C. M., et al. 2002, AJ, 124, 349\nSavage, C., Newberg, H. J., Freese, K. & Gondolo, P. 2006, Journal of Cosmology and\nAstroparticle Physics, 7, 3\nSchlegel, D.J., Finkbeiner, D.P., & Davis, M. 1998, ApJ, 500, 525\nSmith, J. A. et al. 2002, AJ, 123, 2121\n\n\f\u2013 35 \u2013\nStoughton, C., et al. 2001, AJ, 123, 485\nTeuben, P.J. The Stellar Dynamics Toolbox NEMO, in: Astronomical Data Analysis Software and Systems IV, ed. R. Shaw, H.E. Payne and J.J.E. Hayes. (1995), PASP Conf\nSeries 77, p398.\nVivas, A. K. et al. 2001, ApJ, 554, L33\nWillman, B. et al. 2005, ApJ, 626, L85\nXu, Y., Deng, L. C., & Hu, J. Y. 2006, MNRAS, 368, 1811\nYanny, B., Newberg, H. J., et al. 2003, ApJ, 588, 841\nYanny, B., Newberg, H. J., et al. 2000, ApJ, 540, 825\nYork, D. G., et al. 2000, AJ, 120, 1579\nZucker, D. B. et al. 2006a, ApJ, 643, L103\nZucker, D. B. et al. 2006b, ApJ, 650, L41\n\nThis preprint was prepared with the AAS LATEX macros v5.2.\n\n\f\u2013 36 \u2013\nFig. 1.- Stripe and stream parameter definitions. The segment of a stream which passes\nthrough an SDSS stripe is cylindrical within an individual stripe, with density that falls off\nas a Gaussian with distance from its axis. The coordinates \u03bc, \u03bd, and r are used to define\nSDSS stripes. We adopt these coordinates to define a vector, ~c(\u03bc, R) (\u03bd = 0), which points\nto the center of the stream from the Galactic center. We then define a stream directional\nvector \u00e2(\u03b8, \u03c6) of unit length. Finally, we define the stream width as \u03c3, which is the standard\ndeviation of the Gaussian that defines the density fall-off of the stream.\nFig. 2.- Simulated data wedge plot. We show a Sun-centered density plot of the 205,708\nstars generated to mimic SDSS stripe 82. g0 is labeled along the radial spokes; the circle\nindicates where g0 = 23. The angle \u03bc in degrees is marked along this circle. For stripe 82\n\u03bc = \u03b1 and \u03bd = \u03b4. The simulated stream is easily discerible at (\u03b1, g0 ) = (33.4, 21.4).\nFig. 3.- Simulated stream and spheroid stars after separation. Here we have plotted the\nsame 205,708 star simulated data set similarly to Figure 2. However, we have separately\nplotted the stream (left) and spheroid (right) catalogs returned from running our separation\nalgorithm. The spheroid is recovered as a smooth Hernquist function after the removal of\nthe stream component.\nFig. 4.- Plot of the disruption of the one million particle simulated Sagittarius Dwarf with\na spherical dark matter halo (q = 1), and a velocity dispersion of vhalo = 114 km/s in the\nSgr XY orbital plane. To reduce crowding, the stream was sampled one in one hundred. The\nthin line is the future orbit of the core, while the dotted line is the past orbit. The past orbit\nis not closed, but in fact follows the lower trailing stream. The arrow depicts the center and\ndirection returned by our algorithm optimization.\nFig. 5.- Cross-sections of Sgr N-body simulation stream (left panel) and simulated stream\n(right panel). The simulated stream matches our stream model and was generated from the\nparameters fit to the N-body simulation. The upper figure in both panels show the 1 kpc\nthick cross-section of the respective data set. The cross-sections are centered at the best-fit\nvalue of the optimization of the center in the N-body simulation from Figure 4. Here the axes\nare perpendicular to the stream direction. The X-axis is 0.053X + 0.055Y + 0.997Z and the\nY-axis is 0.055X + 0.997Y \u2212 0.058Z, where X,Y,Z are Galactocentric Cartesian coordinates\nwith the Sun at X = -8.5 kpc and moving in the direction of positive Y. The lower figure of\nboth panels is a histogram of those stars within the cross-section binned along the X-axis.\nThe heavy dashed line shows a Gaussian distribution with standard deviation given by \u03c3\nfrom the fit to the N-body simulation. Note that the cross-section of the N-body simulation\nis non-Gaussian and somewhat asymmetric. Also note the model simulated stream is well\nfit by a Gaussian. The density distributions in the left and right panels are not the same,\n\n\f\u2013 37 \u2013\nhowever, the algorithm still fits a reasonable center for the non-Gaussian N-body data set.\nFig. 6.- F turnoff stars within SDSS stripe 82. Here we plot, as in the Figure 2, F turnoff\nstars with color cut 0.1 < (g \u2212 r)0 > 0.3 and (u \u2212 g)0 > 0.4 that are within the volume\ndefined by 310 < \u03b1 < 419, \u00b11.25 = \u03b4, and 16 < g0 < 22.5 that were detected in SDSS stripe\n82. Sgr tidal debris is visible around (\u03b1, g0) = (31, 21.5).\nFig. 7.- F turnoff stars within SDSS stripe 82 after separation. Here we have plotted the\ndata from Figure 6 after being separated into two distinct catalogs: one for stream and one\nfor spheroid. The stream (left) has clearly been extracted from the spheroid (right).\nFig. 8.- Plot of the stream center and direction in the Sgr dwarf plane compared to other Sgr\ndetections. Here we reproduce Figure 4 of Newberg et al. (2007) which displays detections of\nthe Sgr stream in A-colored stars in eleven stripes, where the filled circles and larger squares\nrepresent leading debris, the open circles trailing debris, and the smaller squares Sgr debris\non the opposing side of the Sgr orbital plane. These are plotted along with the positions of\n2MASS M giants from Figure 11 of Majewski et al. (2003). The arrow shows our improved\nmeasurement of the position and direction in one place on the Sgr tidal stream. The length\nof the directional vector is arbitrary representing only the projection of an elongated unit\nvector onto the respective planes. Note that the direction is tangent to the 2MASS M star\ndata, and plausibly on a smooth path from stripe 86 (the open circle just to the right of our\ndetection for stripe 82) to stripe 27 (the open circle farthest to the left in the lower figure).\n\n\f\u2013 38 \u2013\n\nTable 1. Perturbation values used for the gradient and Hessian\nParameter\n\u03bc (deg)\nR (kpc)\n\u03b8 (rad)\n\u03c6 (rad)\n\u03c3 (kpc)\n\u01eb\nq\nr0 (kpc)\n\nh\n3 * 10\u22125\n4 * 10\u22125\n6 * 10\u22125\n4 * 10\u22125\n4 * 10\u22126\n1 * 10\u22126\n4 * 10\u22126\n8 * 10\u22124\n\n\f\u2013 39 \u2013\n\nTable 2. Results for the simulated data set of 205,708 stars\nParameter\n\n\u03bc (deg)\nR (kpc)\n\u03b8 (rad)\n\u03c6 (rad)\n\u03c3 (kpc)\n\u01eb\nq\nr0 (kpc)\n\nTrue\nValue\n31.361\n29.228\n1.445\n3.186\n2.854\n-1.8281\n0.670\n13.500\n\n1 Corresponds\n\nExpected\nDeviation\n\nNumerical\nError\n\nOptimized\nValue\n\nActual\nDeviation\n\nStd. Deviation\nof Optimizations\n\n0.233\n0.167\n0.032\n0.049\n0.033\n0.005\n0.013\n0.276\n\n0.05\n0.04\n0.003\n0.001\n0.015\n0.002\n0.000\n0.15\n\n31.443\n29.217\n1.421\n3.182\n2.858\n-1.833\n0.671\n13.917\n\n0.082\n0.011\n0.024\n0.004\n0.004\n0.005\n0.001\n0.417\n\n0.064\n0.010\n0.0005\n0.002\n0.009\n0.005\n0.0004\n0.016\n\nto a stream star ratio of 13.85 percent: 28,498 in stream; 177,210 in spheroid.\n\n\f\u2013 40 \u2013\n\nTable 3. Stream fitting results for tests with incorrect spheroid model.\nParameter\n\nTrue\nValue\n\nExpected\nDeviation\n\n\u03b1 = 3.5\nOptimization\n\n\u03b1 = 2.5\nOptimization\n\n\u03b1 = 2.0\nOptimization\n\n\u03bc (deg)\nR (kpc)\n\u03b8 (rad)\n\u03c6 (rad)\n\u03c3 (kpc)\n\n31.361\n29.228\n1.445\n3.186\n2.854\n\n0.233\n0.167\n0.032\n0.049\n0.033\n\n31.449\n29.094\n1.426\n3.172\n2.869\n\n31.526\n29.326\n1.452\n3.168\n2.848\n\n31.457\n29.108\n1.437\n3.160\n2.865\n\n\f\u2013 41 \u2013\n\nTable 4. Results for the 115,907 F turnoff stars in SDSS Stripe 82\nParameter\n\n\u03bc (deg)\nR (kpc)\n\u03b8 (rad)\n\u03c6 (rad)\n\u03c3 (kpc)\n\u01eb\nq\nr0 (kpc)\n\nOptimized\nValue\n31.373\n29.218\n1.444\n3.184\n2.862\n-1.8271\n0.458\n19.404\n\nStatistical\nError\n\nNumerical\nError\n\nStd. Deviation\nof Optimizations\n\n0.244\n0.184\n0.044\n0.034\n0.025\n0.005\n0.023\n0.581\n\n0.08\n0.07\n0.01\n0.008\n0.008\n0.001\n0.005\n0.09\n\n0.008\n0.012\n0.001\n0.002\n0.009\n0.000\n0.001\n0.051\n\n1 Corresponds to a stream star ratio of 13.86 percent of the 115,907 F\nturnoff stars; about 16,000 stream stars.\n\n\f\u2013 42 \u2013\n\nTable 5. Table of the stream center and direction as calculated for different coordinate\nsystems. All distances are in kpc and angles are in degrees.\nPhysical\nQuantity\n\nCoordinate\nsystem\n\nValue 1\n\nValue 2\n\nValue 3\n\nCenter\nCenter\nCenter\nCenter\nCenter\nDirection\n\nEquatorial (\u03b1, \u03b4, R)\nEquatorial (\u03b1, \u03b4, g0 )\nGalactic (l, b, R)\nGalactic (l, b, g0 )\nCartesian (X, Y , Z)\nCartesian (X, Y , Z)\n\n31.37\n31.36\n159.223\n159.223\n-23.154\n-0.991\n\n0.0\n0.0\n-57.558\n-57.558\n5.560\n-0.042\n\n29.221\n21.53\n29.221\n21.53\n-24.658\n0.127\n\n1 Assuming\n\nan absolute magnitude of M\u0304g0 = 4.2.\n\n\f\u20131\u2013\n\n\f\u20132\u2013\n\n\f\u20133\u2013\n\n\f-60\n\n-40\n\n0\n\n\u20134\u2013\n\nYsgr,GC (kpc)\n\n-20\n\n20\n\n40\n\n60\n\n80\n-100\n\n-80\n\n-60\n\n-40\n\n-20\n0\nXsgr,GC (kpc)\n\n20\n\n40\n\n60\n\n\f\u20135\u2013\n\n\f\u20136\u2013\n\n\f\u20137\u2013\n\n\fY SGR,GC = -0.015X + 0.232Y - 0.972Z\n\nZ\nSGR,GC\n\n15\n\n0\n\n-15\n\n\u20138\u2013\n\n0\n\nX SGR,GC = 0.998X + 0.066Y kpc\n\n\f"}