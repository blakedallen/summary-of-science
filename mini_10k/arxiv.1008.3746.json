{"id": "http://arxiv.org/abs/1008.3746v2", "guidislink": true, "updated": "2010-09-09T04:00:01Z", "updated_parsed": [2010, 9, 9, 4, 0, 1, 3, 252, 0], "published": "2010-08-23T04:20:37Z", "published_parsed": [2010, 8, 23, 4, 20, 37, 0, 235, 0], "title": "Belief Propagation Algorithm for Portfolio Optimization Problems", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1008.4608%2C1008.3593%2C1008.1895%2C1008.1995%2C1008.4235%2C1008.4904%2C1008.0594%2C1008.4324%2C1008.3663%2C1008.3746%2C1008.4345%2C1008.4728%2C1008.2710%2C1008.5166%2C1008.4665%2C1008.2623%2C1008.4577%2C1008.1159%2C1008.1467%2C1008.2312%2C1008.3315%2C1008.2052%2C1008.0500%2C1008.1954%2C1008.3871%2C1008.2024%2C1008.4068%2C1008.3109%2C1008.3616%2C1008.1920%2C1008.5013%2C1008.3363%2C1008.1970%2C1008.1061%2C1008.2432%2C1008.0230%2C1008.1114%2C1008.4000%2C1008.3990%2C1008.5360%2C1008.4666%2C1008.3907%2C1008.2957%2C1008.4832%2C1008.2854%2C1008.0285%2C1008.1705%2C1008.3378%2C1008.3743%2C1008.1497%2C1008.4610%2C1008.3289%2C1008.4582%2C1008.1686%2C1008.0938%2C1008.3749%2C1008.0843%2C1008.4941%2C1008.3189%2C1008.2536%2C1008.2079%2C1008.2645%2C1008.4596%2C1008.1019%2C1008.2214%2C1008.2478%2C1008.3075%2C1008.1186%2C1008.1867%2C1008.2225%2C1008.1716%2C1008.4958%2C1008.0756%2C1008.4199%2C1008.0560%2C1008.4918%2C1008.2528%2C1008.0869%2C1008.3585%2C1008.1044%2C1008.3463%2C1008.3637%2C1008.2046%2C1008.5378%2C1008.0716%2C1008.3424%2C1008.1626%2C1008.5156%2C1008.2988%2C1008.3223%2C1008.3296%2C1008.0261%2C1008.5153%2C1008.3330%2C1008.2997%2C1008.3399%2C1008.4863%2C1008.4799%2C1008.0434%2C1008.3465%2C1008.2070&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Belief Propagation Algorithm for Portfolio Optimization Problems"}, "summary": "The typical behavior of optimal solutions to portfolio optimization problems\nwith absolute deviation and expected shortfall models using replica analysis\nwas pioneeringly estimated by S. Ciliberti and M. M\\'ezard [Eur. Phys. B. 57,\n175 (2007)]; however, they have not yet developed an approximate derivation\nmethod for finding the optimal portfolio with respect to a given return set. In\nthis study, an approximation algorithm based on belief propagation for the\nportfolio optimization problem is presented using the Bethe free energy\nformalism, and the consistency of the numerical experimental results of the\nproposed algorithm with those of replica analysis is confirmed. Furthermore,\nthe conjecture of H. Konno and H. Yamazaki, that the optimal solutions with the\nabsolute deviation model and with the mean-variance model have the same typical\nbehavior, is verified using replica analysis and the belief propagation\nalgorithm.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1008.4608%2C1008.3593%2C1008.1895%2C1008.1995%2C1008.4235%2C1008.4904%2C1008.0594%2C1008.4324%2C1008.3663%2C1008.3746%2C1008.4345%2C1008.4728%2C1008.2710%2C1008.5166%2C1008.4665%2C1008.2623%2C1008.4577%2C1008.1159%2C1008.1467%2C1008.2312%2C1008.3315%2C1008.2052%2C1008.0500%2C1008.1954%2C1008.3871%2C1008.2024%2C1008.4068%2C1008.3109%2C1008.3616%2C1008.1920%2C1008.5013%2C1008.3363%2C1008.1970%2C1008.1061%2C1008.2432%2C1008.0230%2C1008.1114%2C1008.4000%2C1008.3990%2C1008.5360%2C1008.4666%2C1008.3907%2C1008.2957%2C1008.4832%2C1008.2854%2C1008.0285%2C1008.1705%2C1008.3378%2C1008.3743%2C1008.1497%2C1008.4610%2C1008.3289%2C1008.4582%2C1008.1686%2C1008.0938%2C1008.3749%2C1008.0843%2C1008.4941%2C1008.3189%2C1008.2536%2C1008.2079%2C1008.2645%2C1008.4596%2C1008.1019%2C1008.2214%2C1008.2478%2C1008.3075%2C1008.1186%2C1008.1867%2C1008.2225%2C1008.1716%2C1008.4958%2C1008.0756%2C1008.4199%2C1008.0560%2C1008.4918%2C1008.2528%2C1008.0869%2C1008.3585%2C1008.1044%2C1008.3463%2C1008.3637%2C1008.2046%2C1008.5378%2C1008.0716%2C1008.3424%2C1008.1626%2C1008.5156%2C1008.2988%2C1008.3223%2C1008.3296%2C1008.0261%2C1008.5153%2C1008.3330%2C1008.2997%2C1008.3399%2C1008.4863%2C1008.4799%2C1008.0434%2C1008.3465%2C1008.2070&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The typical behavior of optimal solutions to portfolio optimization problems\nwith absolute deviation and expected shortfall models using replica analysis\nwas pioneeringly estimated by S. Ciliberti and M. M\\'ezard [Eur. Phys. B. 57,\n175 (2007)]; however, they have not yet developed an approximate derivation\nmethod for finding the optimal portfolio with respect to a given return set. In\nthis study, an approximation algorithm based on belief propagation for the\nportfolio optimization problem is presented using the Bethe free energy\nformalism, and the consistency of the numerical experimental results of the\nproposed algorithm with those of replica analysis is confirmed. Furthermore,\nthe conjecture of H. Konno and H. Yamazaki, that the optimal solutions with the\nabsolute deviation model and with the mean-variance model have the same typical\nbehavior, is verified using replica analysis and the belief propagation\nalgorithm."}, "authors": ["Takashi Shinzato", "Muneki Yasuda"], "author_detail": {"name": "Muneki Yasuda"}, "author": "Muneki Yasuda", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1371/journal.pone.0134968", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1008.3746v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1008.3746v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "5 pages, 2 figures, to submit to EPL", "arxiv_primary_category": {"term": "q-fin.PM", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-fin.PM", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.LG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-fin.RM", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1008.3746v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1008.3746v2", "journal_reference": null, "doi": "10.1371/journal.pone.0134968", "fulltext": "epl draft\n\nBelief Propagation Algorithm for Portfolio Optimization Problems\nTakashi Shinzato1 and Muneki Yasuda2\n\narXiv:1008.3746v2 [q-fin.PM] 9 Sep 2010\n\n1\n\nDepartment of Management Science and Engineering, Graduate School of Systems Science and Technology, Akita\nPrefectural University, Yurihonjo, Akita, 015-0055, Japan\n2\nDepartment of Applied Information Sciences, Graduate School of Information Sciences, Tohoku University, Sendai,\nMiyagi, 980-8579, Japan\n\nPACS\nPACS\nPACS\n\n89.65.Gh \u2013 Econophysics\n89.90.+n \u2013 Interdisciplinary physics\n75.10.Nr \u2013 Spin-glass and other random models\n\nAbstract. - The typical behavior of optimal solutions to portfolio optimization problems with\nabsolute deviation and expected shortfall models using replica analysis was pioneeringly estimated\nby S. Ciliberti and M. M\u00e9zard [Eur. Phys. B. 57, 175 (2007)]; however, they have not yet\ndeveloped an approximate derivation method for finding the optimal portfolio with respect to\na given return set. In this study, an approximation algorithm based on belief propagation for\nthe portfolio optimization problem is presented using the Bethe free energy formalism, and the\nconsistency of the numerical experimental results of the proposed algorithm with those of replica\nanalysis is confirmed. Furthermore, the conjecture of H. Konno and H. Yamazaki, that the\noptimal solutions with the absolute deviation model and with the mean-variance model have the\nsame typical behavior, is verified using replica analysis and the belief propagation algorithm.\n\nIntroduction. \u2013 Portfolio optimization is one of the\nmost fundamental frameworks of risk diversification management. Its theory was introduced by Markowitz in 1959\nand is one of the most important areas being actively investigated in financial engineering [1\u20133]. In their theoretical research, Ciliberti and M\u00e9zard assessed the typical behavior of optimal solutions to portfolio optimization\nproblems, in particular those described by the absolute deviation and expected shortfall models, using replica analysis, one of the most powerful approaches in disordered\nsystems. With this approach, they showed that the phase\ntransitions of these optimal solutions were nontrivial [2].\nHowever, they did not develop an effective algorithm for\nfinding the optimal portfolio with respect to a fixed return set. This requires a rapid algorithm for resolving the\noptimal portfolio problem with respect to a large enough\nin-sample set.\nAs a first step in such a research direction, we propose\nan algorithm based on belief propagation, which is wellknown as one of the most prominent algorithms in probabilistic inference, to resolve the microscopic averages of the\noptimal solution in a feasible amount of time for a fixed\nreturn set. We also confirm whether the numerical experimental results of our novel algorithm are consistent with\nthe ones of replica analysis. Furthermore, the conjecture\n\nof Konno and Yamazaki, that if the return at each period\nis independently and identically drawn from the normal\nprobability distribution [3], the optimal portfolio of the\nmean-variance model is consistent with that of the absolute deviation model, is supported using replica analysis\nand belief propagation.\nModel Setting. \u2013 Let us define the model setting for\nour discussion. A portfolio of N assets and the return at\nT\nperiod \u03bc are represented by w\n~ = {w1 , w2 , * * * , wN } \u2208 RN\nT\nN\nand ~x\u03bc = {x1\u03bc , x2\u03bc , * * * , xN \u03bc } \u2208 R , respectively, where\nwk is the position of asset k, and we assume for simplicity\nthat the mean of the return of asset k in period \u03bc, xk\u03bc ,\nis zero. The notation T indicates matrix transposition.\nGiven a return set for p periods as reference, the problem is\nto minimize the following cost function (i.e., Hamiltonian)\nfor the portfolio:\nH (w)\n~ =\n\np\nX\n\n\u03bc=1\n\nR\n\n\u0012\n\nw\n~ T ~x\u03bc\n\u221a\nN\n\n\u0013\n\n,\n\n(1)\n\n2\n\nwhere R(u) represents a cost function, such as u2 in the\nmean-variance model and |u| in the absolute deviation\nmodel, respectively. Furthermore, since the budget is as-\n\np-1\n\n\fT. Shinzato et al.\nreducibility condition of Eq.\nhP (5). By adding the\ni term\nPp PN P\nb\u03bc (w)\n~ \u2212 bk (wk ) to the\nN\n\u03bc=1\nk=1\nwk \u03bbk\u03bc (wk )\nw\\w\n~\nk\nX\nright-hand\nside\nof\nEq.\n(6),\nit\nis\npossible\nto maximize the\nwk = N.\n(2)\nBethe\nfree\nenergy\nwith\nrespect\nto\nthe\nbeliefs\nto obtain\nk=1\n\"\n#\np\nOne of our aims is to develop an effective general algo1 X\nbk (wk ) \u221d P0k (wk ) exp\n\u03bbk\u03bc (wk ) ,\nrithm for solving this problem; in particular, our aim is\n1 \u2212 p \u03bc=1\nan algorithm that works for all cost functions R(u) and\n#\n\" N\n\u0012 T \u0013\nX\nall probability distributions of the returns.\nw\n~ ~x\u03bc\nb\u03bc (w)\n~ \u221d P0 (w)\n~ g \u221a\n\u03bbk\u03bc (wk ) .\nexp \u2212\nAs a basis for the proposed algorithm, following examN\nk=1\nples in statistical mechanics, we set the joint probability\nof portfolio w\n~ used in Eq. (1) using finite inverse absolute Furthermore, for simplicity, we set \u03bb\u0303 (w ) =\nk\u03bc\nk\nPp\n1\ntemperature \u03b2 as follows:\n\u03bb (w ) + \u03bb (w )\nas\nnovel\nauxilsumed to be finite, the following global constraint is set:\n\nk\u03bc\n\nk\n\nk\u03bc\n\nk\n\n1\u2212p\n\n\u03bc=1\n\niary\ncan\nPp\n\nfunctions,\nand then\nbe rewritten using\n\nand b\u03bc (w)\n~\n\u03bbk\u03bc (wk )\n=\nP\n= \u2212 \u03bd(6=\u03bc) \u03bb\u0303k\u03bd (wk )\n\u221d\n(3)\n\u03bc=1 \u03bb\u0303k\u03bc (wk ) and \u03bbk\u03bc (wk )\nhP\ni\np\nas bk (wk )\n\u221d\nP0k (wk ) exp\nand\n\u03bc=1 \u03bb\u0303k\u03bc (wk )\n\u0010\n\u0011\nh\ni\nT\nP\nP\nw\n~ ~\nx\nN\nwhere g(u) = e\u2212\u03b2R(u) is the likelihood\n\u221a \u03bc exp\n~\n\u221d P0 (w)g\n~\n\u03bb\u0303\n(w\n)\n.\nh \u0010P function and\n\u0011i b\u03bc (w)\nk\u03bd\nk\nk=1\n\u03bd(6=\u03bc)\nN\nN\nprior probability P0 (w)\n~\n\u221d exp m\u0303\nw\n\u2212\nN\nk\nMoreover, applying the cumulant generating functions\nk=1\nX\nfor sufficiently large N .\nNotice that the par\u03c6\n(\u03b8\n)\n=\nlog\nbk (wk )ewk \u03b8k ,\n(7)\nk\nk\ntition function of\u0010 this \u0011iposterior probability Z =\nT\nP Qp h\nwk\nw\n~ ~\nx\u03bc\n1\u2212p\n\u221a\nP0 (w)\n~ is implicitly ignored\n\u0010 \u0011\n~\nX\n\u03bc=1 P0 (w)g\nw\n~\nT~\nN\n\u03b8~\n= log\nb\u03bc (w)e\n~ w~ \u03b8 ,\n(8)\n\u03c6\n\u03bc\nin this analysis because intuitively it is possible to evalw\n~\nuate the first- and second-order moments of portfolio wk\napproximately without the partition function by the fol- the first and second moments of wk have the compact\n2\n~\n\u2202\u03c6 (\u03b8)\n\u2202\u03c6k (\u03b8k )\nlowing procedure. An arbitrary test probability of portfo- forms m\nk)\n= \u2202\u03b8\u03bc k and \u03c7wk = \u2202 \u03c6\u2202\u03b8k (\u03b8\n=\n2\nwk =\n\u2202\u03b8k\nk\nlio is defined as follows:\n~\n\u2202 2 \u03c6\u03bc (\u03b8)\nT\nat ~\u03b8 = {\u03b81 , * * * , \u03b8N } \u2192 0. This allows us to disre2\n\u2202\u03b8k\np\nN\nY\nY\nb\u03bc (w)\n~\nb1\u2212p\n(wk ),\n(4) gard the calculation of the partition function. Then, our\nQ (w)\n~ \u221d\nk\nproposed algorithm for sufficiently large N comprises the\n\u03bc=1\nk=1\nfollowing:\nwhere the reducibility condition on beliefs bk (wk ) and\nmwk = \u03c7wk (hwk + m\u0303) ,\n(9)\nb\u03bc (w),\n~\np\n1 X\nX\nhwk = \u221a\nxk\u03bc mu\u03bc + \u03c7\u0303wk mwk ,\n(10)\nbk (wk ) =\nb\u03bc (w)\n~ ,\n(5)\nN\nP (w)\n~ \u221d\n\nP0 (w)\n~ exp [\u2212\u03b2H (w)]\n~\n\u0014\n\u0012\n\u0013\u0015\np\nY\nw\n~ T ~x\u03bc\n\u221a\nP0 (w)g\n~\nP01\u2212p (w),\n~\nN\n\u03bc=1\n\np\n\u03bc=1\n\n\u03bc=1\n\nw\\w\n~\nk\n\nmust hold and w\n~ \\ wk denotes a subset of w\n~ from which\nwk is excluded. The Kullback-Liebler divergence (KLD)\nP\nw)\n~\n~ log Q(\nKL(Q|P ) = w~ Q(w)\nP (w)\n~ provides a useful guideline\nfor deriving the belief propagation algorithm. However,\nsince it is too complicated to directly assess KLD except in\nspecific graphical models, we here approximate the Bethe\nfree energy denoted as follows:\n\uf8f6\n\uf8eb\np X\nX\nb\n(\nw)\n~\n\u03bc\n\u0010 T \u0011\uf8f8\nFBethe =\nb\u03bc (w)\n~ log \uf8ed\nw\n~ ~\nx\n\u221a \u03bc\nP\n(\nw)g\n~\n\u03bc=1 w\n0\n~\nN\n\u0013\n\u0012\nN X\nX\nbk (wk )\n,(6)\nbk (wk ) log\n+(1 \u2212 p)\nP0k (wk )\nw\nk=1\n\nbkP\n(wk )\n\n1\n1\u2212p\n\nk\n\nwhere P0k (wk ) \u221d em\u0303wk is used. The purpose of this step\nis to derive the optimal portfolio using the beliefs bk (wk )\nand b\u03bc (w)\n~ that minimize the Bethe free energy under the\n\n\u03c7\u0303wk\n\n=\n\n\u03c7wk\n\n=\n\nmu\u03bc\n\n=\n\nhu\u03bc\n\n=\n\n\u03c7\u0303u\u03bc\n\n=\n\n\u03c7u\u03bc\n\n=\n\np\n1 X 2\nx \u03c7u\u03bc ,\nN \u03bc=1 k\u03bc\n\n(11)\n\n1\n,\n(12)\n\u03c7\u0303wk\nZ \u221e\n\u0010 p\n\u0011\n\u2202\nlog\nDzg z \u03c7\u0303u\u03bc + hu\u03bc , (13)\n\u2202hu\u03bc\n\u2212\u221e\nN\n1 X\n\u221a\nxk\u03bc mwk \u2212 \u03c7\u0303u\u03bc mu\u03bc ,\nN k=1\n\n(14)\n\nN\n1 X 2\nxk\u03bc \u03c7wk ,\n(15)\nN\nk=1\nZ \u221e\n\u0011\n\u0010 p\n\u22022\nDzg z \u03c7\u0303u\u03bc + hu\u03bc ,(16)\n\u2212 2 log\n\u2202hu\u03bc\n\u2212\u221e\n2\n\nwhere Dz =\n\nz\n\u221adz e\u2212 2\n2\u03c0\n\nis used. Note that if \u03bb\u0303k\u03bc (wk ) is\n\nredefined as \u03bb\u0303k\u03bc (wk ) = \u2212\n\np-2\n\n\u03b3k\u03bc 2\n2 wk\n\n+ h\u0303k\u03bc wk , then \u03c7\u0303wk =\n\n\fBelief Propagation Algorithm for Portfolio Optimization Problems\nPp\n\nPp\n=\nIn addition,\n\u03bc=1 h\u0303k\u03bc [4, 5].\ndescribe the Onsager reaction terms\nin the literature of spin glass theory (respectively [6, 7]).\nFour points should be noticed here. First, the calculation of this procedure is reduced from O(N 3 ) to O(N 2 ).\nFor instance, in the case of the mean-variance model, although we are required to calculate the inverse matrix\nof the correlation matrix of return set XX T \u2208 MN \u00d7N ,\nwhere return matrix X = {~x1 , * * * , ~xp } \u2208 MN \u00d7p , in order\nto assess the optimal solution rigorously, it is well-known\nthat this calculation is O(N 3 ). Moreover, fortunately it is\nfound that in the case of the mean-variance model, this algorithm derives the exact optimal solution (see appendix\nA for details). Second, only Eqs. (13) and (16) are dependent on the likelihood function g(u) = e\u2212\u03b2R(u) , and the\nvariables of index u are the only model dependent ones.\nFurthermore, m\u0303 is determined by Eqs. (2) and (9). Third,\nthe randomness of return is not assumed to be sampled\nfrom specific distributions. Because it is plausible that\nthe assumption on the Bethe free energy approximation\nworks correctly if the return at each period is asymptotically not correlated with other returns . Lastly, we expect\nthat in the limit as \u03b2 \u2192 \u221e, the estimate of the portfolio of\nasset k, mwk , asymptotically corresponds to the optimal\nportfolio with respect to the given return set.\n\u03bc=1 \u03b3k\u03bc and hwk\n\u03c7\u0303wk mwk and \u03c7\u0303u\u03bc mu\u03bc\n\n\u221a\n\u0001\u22121 \u2212 u2\ne 2 in the case of u \u226b 1, mu\u03bc \u2243\nH(u) \u2243\n2\u03c0u\nhu\u03bc\n1\n\u2212 \u03c7\u0303u\u03bc and \u03c7u\u03bc \u2243 \u03c7\u0303u\u03bc are estimated; that is, this finding\nindicates that the conjecture of Konno and Yamazaki is\nvalid in part in the sense of the belief propagation approach. See appendices for details.\n\nConclusion. \u2013 In conclusion, we have discussed an\neffective algorithm for finding the optimal solution of the\nportfolio optimization problem with respect to an arbitrary cost function according to Ciliberti and M\u00e9zard [2].\nWith loss of generality, applying the likelihood function\ng(u) defined by the cost function R(u) dependent on the\nrisk diversification problem, we proposed a novel approximation derivation method based on one of the most powerful estimation methods in probabilistic inference. In addition, since two types of Onsager reaction terms are derived\nin Eqs (10) and (14), our algorithm provides the Thouless,\nAnderson, and Palmer approach rather than the meanfield approximation in the literature of spin glass theory.\nOne advantage of our algorithm is that it rapidly converges\nby excluding the effect of self-response. In order to confirm the effectiveness of the proposed approach, we have\ndescribed the case of the mean-variance model. Furthermore, we have shown that the conjecture of Konno and\nYamazaki is supported by employing both approaches developed in cross-disciplinary research involving statistical\nApplication. \u2013 In order to confirm the effectiveness\nmechanics and information sciences. In future work, we\nof our method, the numerical experimental results of the\nwill assess the properties of R(u) and the randomness of\nproposed algorithm and those of the replica analysis for\nreturn that make solving the portfolio optimization probthe case of the Markowitz model are shown in Figs. 1 and\nlem using belief propagation possible.\n2, where xk\u03bc are independently and identically drawn from\nthe normal distribution with mean and variance 0 and 1,\n\u2217\u2217\u2217\nrespectively. The numerical experimental result of belief\n2\npropagation is assessed from 10 samples of the number\nWe thank K. Inakawa, Y. Kimura, and K. Yagi for their\nof assets N = 100 and is denoted by error bars and the\nresult of replica analysis is denoted by a solid line. Both fruitful comments. This work is partially supported by\nfindings indicate that the two approaches are consistent the Grants-in-Aid (No. 21700247) for Scientific Research\nfrom the Ministry of Education, Culture, Sports, Science\nwith each other.\nWith regard to the conjecture of Konno and Yamazaki, and Technology of Japan.\nthe variables in Eqs. (13) and (16), in the case of the\nAppendix A: Proof of Exactness. \u2013 We here conmean-variance model\nfirm the exactness of the proposed belief propagation almu\u03bc\n\n=\n\n\u03c7u\u03bc\n\n=\n\n\u03b2\nhu\u03bc ,\n1 + \u03b2 \u03c7\u0303u\u03bc\n\u03b2\n1 + \u03b2 \u03c7\u0303u\u03bc\n\n(17)\n\n\u2212\n\n(18)\n\nand the absolute deviation model\n\u0013\uf8f6\n\u0012\n\uf8eb\np\nhu\u03bc\n\u221a\n\u03c7\u0303\n+\nH\n\u03b2\nu\u03bc\n\uf8ec\n\u03c7\u0303u\u03bc \uf8f7\n1\n\u0013\uf8f7\n\u0012\nmu\u03bc = \u03b2 tanh \uf8ec\n\u03b2h\n+\nlog\nu\u03bc\n\uf8ed\n\uf8f8,\np\n2\nhu\u03bc\nH \u03b2 \u03c7\u0303u\u03bc \u2212 \u221a\n\u03c7\u0303u\u03bc\n\ngorithm for the case of the Markowitz model. Our discussion is restricted to \u03b1 > 1 for simplicity. From Eqs. (14),\n~ w , where m\n~u=\n(17), and (18), we obtain m\n~ u = \u2212 \u221a\u03b2N X T m\nT\n\n=\n\n\u2212\n\n\u2202mu\u03bc\n,\n\u2202hu\u03bc\n\nare assessed exactly using H(u) =\n\nR\u221e\nu\n\nDz.\n\nT\n\nfrom Eqs. (9), (10), and (12), where ~e = {1, * * * , 1} \u2208\n\u0001\u22121\nRN . Thus, substituting m\n~ w = N m\u0303 \u03b2XX T\n~e into the\nconstraint N = ~eT m\n~ w gives the exact optimal solution\n\u22121\nN (XX T ) ~\ne\nm\n~ w = ~eT (XX T )\u22121~e .\n\n(19)\n\n\u03c7u\u03bc\n\nT\n\n{mu1 , * * * , mup } \u2208 Rp and m\n~ w = {mw1 , * * * , mwN } \u2208\n~ u follows immediately\nRN . Furthermore, m\u0303~e = \u2212 \u221a1N X m\n\nAppendix B: Replica Analysis. \u2013 According to\nCiliberti and M\u00e9zard and Varga-Hoszonits and Kondor\n(20) [2, 8], replica symmetry solution of the portfolio optimization problem, where xk\u03bc is independently and identically\nBecause distributed with N (0, 1), is derived as the following exp-3\n\n\fT. Shinzato et al.\ntremum:\n6.5\n\n\u2212\u03b2f\n\n1\n= lim\n[log Z]q\nN \u2192\u221e N\n\u001a\nq\u22121 1\n= Extr\n+ log \u03c7\nq,\u03c7\n2\u03c7\n2\n\u001b\nZ \u221e\nZ \u221e\n\u221a\n\u221a\n+\u03b1\nDy log\nDzg (z \u03c7 + y q) , (21)\n\u2212\u221e\n\nwhere Z =\n\nP\n\nw\n~\n\nP0 (w)\n~\n\n6\n5.5\n5\n4.5\nq\n\n\u2212\u221e\n\nQp\n\n\u03bc=1\n\ng\n\n\u0010\n\nT\n\nw\n~ ~\nx\n\u221a \u03bc\nN\n\n\u0011\n\n4\n3.5\n3\n2.5\n\nis the partition\n\nfunction and the notation [* * *]q denotes the quenched average over the return set. Moreover,\nPN the quenched overlap parameters become qab = N1 k=1 wka wkb = \u03c7 + q\nif a = b and q otherwise by employing replica indices\na, b = 1, 2, * * * , n and the assumption of replica symmetry.\nFurthermore, for large N and p, \u03b1 = p/N \u223c O(1) remains\nfinite and plays an important role as a control parameter\nwith respect to phase transition phenomena. If g(u) =\n\u0001\u22121\n\u03b2 2\n\u22121\nand \u03c7 = (\u03b2(\u03b1 \u2212 1)) can be\ne\u2212 2 u , then q = 1 \u2212 \u03b11\nexactly calculated in the case \u03b1 > 1 and q \u2192 \u221e, and\n\u03c7 \u2192 \u221e otherwise. This analytical finding is also verified\nin by the following. It is well known that the eigenvalue\ndistribution of the correlation matrix C = N1 XX T in the\nlimit of N \u2192 \u221e is asymptotically close\n\u221a to the Mar\u010dhenko-\n\n2\n1.5\n1\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n\u03b1\n\nFig. 1: The reference ratio \u03b1 = p/N (horizontal axis) versus\nthe quenched overlap parameter q (vertical axis). The numerical experimental results from the proposed algorithm (error\nbars) are assessed from 102 experiments using N = 100 assets.\nComparing with the results of replica analysis (solid line), the\neffectiveness of proposed algorithm is verified.\n4\n3.5\n3\n\n[\u03bb\u2212\u03bb ]+ [\u03bb \u2212\u03bb]+\n\n\u2212\n+\nPastur law \u03c1(\u03bb) = [1 \u2212 \u03b1]+ \u03b4(\u03bb) +\nwith\n2\u03c0\u03bb\n\u221a 2\n+\n\u03bb\u00b1 = (1 \u00b1 \u03b1) and [u] = max {u, 0} [9]. There\u22122\nfore, q = \u03bb12 \u03bb1\nand one degree of the cost function\n\n\u22121\n\n2.5\n\u03b5\n2\n1.5\n\n~ q = 21 \u03bb1\n\u03b5 = limN \u2192\u221e N1 [H(w)]\nare obtained straightR\u221e\n1\nforwardly using hf (\u03bb)i = \u2212\u221e d\u03bb\u03c1(\u03bb)f (\u03bb). Applying\n\u03bb\n+\u03bb\n1\n0.5\nMar\u010dhencko-Pastur law, that \u03bb1 = \u221a+ \u2212 \u2212 21 = \u03b1\u22121\n4 \u03bb+ \u03bb\u2212\n\u221a\n\u0011\u00112\n\u0010 \u0010\n0\n\u03bb+ \u03bb\u2212\n1\n2\n3\n4\n5\n6\n7\n8\n\u03b1\nand \u03bb12 =\n= (\u03b1\u22121)\n\u00d7 \u03c02 12 \u03bb1\u2212 \u2212 \u03bb1+\n3 if\n2\u03c0\n\u03b1\n\u03b1 > 1 and approach infinity otherwise follows directly\n[10\u201313]. This is consistent with the findings of replica\nFig. 2: The reference ratio \u03b1 (horizontal axis) versus one degree\nanalysis.\nof the cost function \u03b5 (vertical axis). This result also indicates\nIn general, the order parameters are derived as follows: that the approximation approach based on probabilistic inference works correctly.\n\u221a\nq\n\u03c7 = \u2212\n,\n(22)\n\u03b1\u03b7\nq = 1 + \u03b1\u03c72 \u03b4,\n(23) is obtained. In the limit of\u221aqsufficiently qlarge \u03b2 of g(u) =\n\uf8f6\n\uf8ebZ \u221e\ne\u2212\u03b2|u| , if we assess \u03b7 \u2243 \u2212 \u03c7 and \u03b4 \u2243 \u03c72 asymptotically,\n\u221a\n\u221a\n\u2032\nDzg (z \u03c7 + y q)\nZ \u221e\nthen the conjecture of Konno and Yamazaki is confirmed\n\uf8f7\n\uf8ec \u2212\u221e\n\uf8f7\nas correct in the sense of replica analysis.\nZ\n,\n(24)\n\u03b7 =\nDyy \uf8ec\n\uf8ed \u221e\n\u221a\n\u221a \uf8f8\n\u2212\u221e\nDzg (z \u03c7 + y q)\nAppendix C: The Conjecture of Konno and Ya\u2212\u221e\nmazaki. \u2013 This conjecture is related to the assessment\n\uf8f62\n\uf8ebZ \u221e\n\u221a\n\u221a\nof an annealed system in the context of spin glass theDzg \u2032 (z \u03c7 + y q)\nZ \u221e\n\uf8f7\n\uf8ec \u2212\u221e\n\uf8f7\n\uf8ec\nZ\n. (25) ory. If the return at period \u03bc, ~x\u03bc , is independently\n\u03b4 =\nDy \uf8ed \u221e\n\u221a \uf8f8\n\u221a\nand identically drawn from N (0, \u03a3), where \u03a3 \u2208 MN \u00d7N\n\u2212\u221e\nDzg (z \u03c7 + y q)\nis variance-covariance matrix and w\n~ is fixed, the novel\n\u2212\u221e\n\u0001\nw\n~ T~\nx\n~ with\nvariable z = \u221aN\u03bc is distributed as N 0, s2 (w)\nFrom Eqs. (22) and (23),\ns2 (w)\n~ = N1 w\n~ T \u03a3w\n~ \u2208 R. With respect to fixed w,\n~ em\u0013\u22121\n\u0012\nploying one degree of the cost hfunction of \u0010\nthe annealed\n\u0011i\n1 \u03b4\nPp\nw\n~ T~\nx\n(26) optimization problem \u03b5(w)\nq =\n1\u2212\n~ = N1 \u03bc=1 R \u221aN\u03bc\n=\n2\n\u03b1\u03b7\nq\np-4\n\n\fBelief Propagation Algorithm for Portfolio Optimization Problems\nR\u221e\n\u03b1 \u2212\u221e DuR (us(w)),\n~\nwhich becomes \u03b5MV (w)\n~ = \u03b12 s2 (w)\n~\nin the case of the mean-variance model and \u03b5AD (w)\n~ =\n\u221a2\u03b1 |s(w)|\n~ in the absolute deviation model. This implies\n2\u03c0\nthat the optimal portfolios of the annealed situations of\nthe two models are consistent with each other. Note\nthat one degree of the cost function in the case of the\nannealed portfolio problemn with the\nshortfall\n\u0010 expected\n\u0011o\nv\nmodel, \u03b5ES (w)\n~ = minv\u22650 \u03b1 v\u03b3 + H s(w)\nwith \u03b3 > 0\n~\n1\n, then this optican also be assessed [14]. If s(w)\n~ \u2264 \u221a2\u03c0\u03b3\nmal solution is identical to those of the previous mentioned\nmodels. This finding, that is, arg minw~ T~e=N \u03b5MV (w)\n~ =\narg minw~ T~e=N \u03b5AD (w),\n~ is one part of the contributions reported by Konno and Yamazaki.\nHowever, they optimistically assumed w\n~ MV = w\n~ AD with\nrespect to a given return set X without any mathematical\nproof, using\n\nw\n~ MV\n\nw\n~ AD\n\n=\n\n=\n\narg min\n\nw\n~ T~\ne=N\n\narg min\n\nw\n~ T~\ne=N\n\n[9] Shinzato T. and Kabashima Y., J. Phys. A., 41 (2008)\n324013.\n[10] Kondor I. and Varga-Haszonits I., Eur. Phys. B, 64 (2008)\n601.\n[11] Pafka S. and Kondor I., Eur. Phys. B, 27 (2002) 277.\n[12] Pafka S. and Kondor I., Physica A, 319 (2003) 487.\n[13] Papp G., Pafka S., Nowak M. A. and Kondor I., Acta\nPhysica Polonica B, 36 (2005) 2757.\n[14] Rockafellar R. T. and Uryasev S., J. of Risk, 2 (2000) 21.\n[15] Guly\u00e1s N. and Kondor I., preprint. Available online at:\nhttp://mktudegy.hu/files/GulyasN.pdf\n\np\nN N\n1 XXX\nwi wk xi\u03bc xk\u03bc ,(27)\n2N \u03bc=1 i=1\nk=1\n\np\nX\n\n\u03bc=1\n\n1\n\u221a\nN\n\nN\nX\n\nwk xk\u03bc .\n\n(28)\n\nk=1\n\nAs explained above,\narg minw~ T~e=N \u03b5MV (w)\n~\n=\narg minw~ T~e=N \u03b5AD (w)\n~ with respect to the annealed optimization problem strictly holds; however, w\n~ MV = w\n~ AD\nis not always satisfied. For example, in the simple case\nof N = p = 2 for the two returns ~x1 = {a, c}T and\nT\n~x2 = {b, d} , their assumption w\n~ MV = w\n~ AD does not\nhold, except under specific special situations.\nAlthough this is apparently contradictory to these obtained findings from both approaches, it is necessary to\nrecognize that the relation w\n~ MV = w\n~ AD with a fixed return set is equivalent to the sufficient\ncondition\nqMV =\n\u0003\n\u0002 T\n~ MV w\n~ MV q and qAD =\nqAD , where qMV = limN \u2192\u221e N1 w\n\u0002 T\n\u0003\n~ AD w\n~ AD q are quenched averages of overlap\nlimN \u2192\u221e N1 w\nparameters. Moreover, although w\n~ MV = w\n~ AD does not\nhold in general, it is expected that the inner product\nT\nP\nw\n~ MV\nw\n~ AD\n1\n\u03bc>\u03bd xk\u03bc xj\u03bd \u2192\n|w\n~ MV ||w\n~ AD | is approximately 1 because N\n0 in the case of sufficiently large N [15].\nREFERENCES\n[1] Markowitz H. Portfolio Selection: Efficient Diversification of Investments (J. Wiley and Sons, New York) 1959.\n[2] Ciliberti S. and M\u00e9zard M., Eur. Phys. B, 57 (2007) 175.\n[3] Konno H. and Yamazaki H., Man. Sci., 37 (1991) 5191.\n[4] Kabashima Y., J. Phys. Soc. Jpn., 74 (2005) 2133.\n[5] Minka T. P., Proc. Unc. Art. Int., 17 (2001) 362.\n[6] Opper M. and Winther O., Phys. Rev. Lett., 86 (2001)\n3695.\n[7] Opper M. and Winther O., Phys. Rev. E., 64 (2001)\n056131.\n[8] Varga-Haszonits I. and Kondor I., J. Stat. Mech., (2008)\nP12007.\n\np-5\n\n\f"}