{"id": "http://arxiv.org/abs/math/0011121v1", "guidislink": true, "updated": "2000-11-17T09:47:20Z", "updated_parsed": [2000, 11, 17, 9, 47, 20, 4, 322, 0], "published": "2000-11-17T09:47:20Z", "published_parsed": [2000, 11, 17, 9, 47, 20, 4, 322, 0], "title": "Formal schemes and formal groups", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0011168%2Cmath%2F0011008%2Cmath%2F0011107%2Cmath%2F0011142%2Cmath%2F0011242%2Cmath%2F0011232%2Cmath%2F0011156%2Cmath%2F0011063%2Cmath%2F0011209%2Cmath%2F0011121%2Cmath%2F0011206%2Cmath%2F0011228%2Cmath%2F0011041%2Cmath%2F0011158%2Cmath%2F0011018%2Cmath%2F0011050%2Cmath%2F0011165%2Cmath%2F0011196%2Cmath%2F0011159%2Cmath%2F0011118%2Cmath%2F0011268%2Cmath%2F0011131%2Cmath%2F0011251%2Cmath%2F0011146%2Cmath%2F0011263%2Cmath%2F0011250%2Cmath%2F0011062%2Cmath%2F0011179%2Cmath%2F0011233%2Cmath%2F0011072%2Cmath%2F0011036%2Cmath%2F0011061%2Cmath%2F0011084%2Cmath%2F0011030%2Cmath%2F0011064%2Cmath%2F0011122%2Cmath%2F0011140%2Cmath%2F0011097%2Cmath%2F0011134%2Cmath%2F0011059%2Cmath%2F0011139%2Cmath%2F0011264%2Cmath%2F0011054%2Cmath%2F0011243%2Cmath%2F0011224%2Cmath%2F0011169%2Cmath%2F0011210%2Cmath%2F0011093%2Cmath%2F0011079%2Cmath%2F0011141%2Cmath%2F0011205%2Cmath%2F0011010%2Cmath%2F0011174%2Cmath%2F0011154%2Cmath%2F0011019%2Cmath%2F0011071%2Cmath%2F0011270%2Cmath%2F0011166%2Cmath%2F0011090%2Cmath%2F0011025%2Cmath%2F0011198%2Cmath%2F0011126%2Cmath%2F0011177%2Cmath%2F0011271%2Cmath%2F0011247%2Cmath%2F0011051%2Cmath%2F0011244%2Cmath%2F0011108%2Cmath%2F0011092%2Cmath%2F0011104%2Cmath%2F0011155%2Cmath%2F0011078%2Cmath%2F0011076%2Cmath%2F0011116%2Cmath%2F0011039%2Cmath%2F0011137%2Cmath%2F0011149%2Cmath%2F0011103%2Cmath%2F0011132%2Cmath%2F0011258%2Cmath%2F0011201%2Cmath%2F0011106%2Cmath%2F0011058%2Cmath%2F0011055%2Cmath%2F0011081%2Cmath%2F0011204%2Cmath%2F0011020%2Cmath%2F0011035%2Cmath%2F0011034%2Cmath%2F0011185%2Cmath%2F0011214%2Cmath%2F0011266%2Cmath%2F0011221%2Cmath%2F0011091%2Cmath%2F0011133%2Cmath%2F0011029%2Cmath%2F0011111%2Cmath%2F0011052%2Cmath%2F0011157%2Cmath%2F0011252%2Cmath%2F0011186&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Formal schemes and formal groups"}, "summary": "We set up a framework for using algebraic geometry to study the generalised\ncohomology rings that occur in algebraic topology. This idea was probably first\nintroduced by Quillen and it underlies much of our understanding of complex\noriented cohomology theories, exemplified by the work of Morava. Most of the\nresults have close and well-known analogues in the algebro-geometric\nliterature, but with different definitions or technical assumptions that are\noften inconvenient for topological applications. We merely put everything\ntogether in a systematic and convenient way.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0011168%2Cmath%2F0011008%2Cmath%2F0011107%2Cmath%2F0011142%2Cmath%2F0011242%2Cmath%2F0011232%2Cmath%2F0011156%2Cmath%2F0011063%2Cmath%2F0011209%2Cmath%2F0011121%2Cmath%2F0011206%2Cmath%2F0011228%2Cmath%2F0011041%2Cmath%2F0011158%2Cmath%2F0011018%2Cmath%2F0011050%2Cmath%2F0011165%2Cmath%2F0011196%2Cmath%2F0011159%2Cmath%2F0011118%2Cmath%2F0011268%2Cmath%2F0011131%2Cmath%2F0011251%2Cmath%2F0011146%2Cmath%2F0011263%2Cmath%2F0011250%2Cmath%2F0011062%2Cmath%2F0011179%2Cmath%2F0011233%2Cmath%2F0011072%2Cmath%2F0011036%2Cmath%2F0011061%2Cmath%2F0011084%2Cmath%2F0011030%2Cmath%2F0011064%2Cmath%2F0011122%2Cmath%2F0011140%2Cmath%2F0011097%2Cmath%2F0011134%2Cmath%2F0011059%2Cmath%2F0011139%2Cmath%2F0011264%2Cmath%2F0011054%2Cmath%2F0011243%2Cmath%2F0011224%2Cmath%2F0011169%2Cmath%2F0011210%2Cmath%2F0011093%2Cmath%2F0011079%2Cmath%2F0011141%2Cmath%2F0011205%2Cmath%2F0011010%2Cmath%2F0011174%2Cmath%2F0011154%2Cmath%2F0011019%2Cmath%2F0011071%2Cmath%2F0011270%2Cmath%2F0011166%2Cmath%2F0011090%2Cmath%2F0011025%2Cmath%2F0011198%2Cmath%2F0011126%2Cmath%2F0011177%2Cmath%2F0011271%2Cmath%2F0011247%2Cmath%2F0011051%2Cmath%2F0011244%2Cmath%2F0011108%2Cmath%2F0011092%2Cmath%2F0011104%2Cmath%2F0011155%2Cmath%2F0011078%2Cmath%2F0011076%2Cmath%2F0011116%2Cmath%2F0011039%2Cmath%2F0011137%2Cmath%2F0011149%2Cmath%2F0011103%2Cmath%2F0011132%2Cmath%2F0011258%2Cmath%2F0011201%2Cmath%2F0011106%2Cmath%2F0011058%2Cmath%2F0011055%2Cmath%2F0011081%2Cmath%2F0011204%2Cmath%2F0011020%2Cmath%2F0011035%2Cmath%2F0011034%2Cmath%2F0011185%2Cmath%2F0011214%2Cmath%2F0011266%2Cmath%2F0011221%2Cmath%2F0011091%2Cmath%2F0011133%2Cmath%2F0011029%2Cmath%2F0011111%2Cmath%2F0011052%2Cmath%2F0011157%2Cmath%2F0011252%2Cmath%2F0011186&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We set up a framework for using algebraic geometry to study the generalised\ncohomology rings that occur in algebraic topology. This idea was probably first\nintroduced by Quillen and it underlies much of our understanding of complex\noriented cohomology theories, exemplified by the work of Morava. Most of the\nresults have close and well-known analogues in the algebro-geometric\nliterature, but with different definitions or technical assumptions that are\noften inconvenient for topological applications. We merely put everything\ntogether in a systematic and convenient way."}, "authors": ["Neil P. Strickland"], "author_detail": {"name": "Neil P. Strickland"}, "author": "Neil P. Strickland", "arxiv_comment": "90 pages", "links": [{"href": "http://arxiv.org/abs/math/0011121v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0011121v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "14L05; 55N22", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0011121v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0011121v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0011121v1 [math.AT] 17 Nov 2000\n\nContemporary Mathematics\n\nFormal Schemes and Formal Groups\nNeil P. Strickland\n\nContents\n1. Introduction\n1.1. Notation and conventions\n1.2. Even periodic ring spectra\n2. Schemes\n2.1. Points and sections\n2.2. Colimits of schemes\n2.3. Subschemes\n2.4. Zariski spectra and geometric points\n2.5. Nilpotents, idempotents and connectivity\n2.6. Sheaves, modules and vector bundles\n2.7. Faithful flatness and descent\n2.8. Schemes of maps\n2.9. Gradings\n3. Non-affine schemes\n4. Formal schemes\n4.1. (Co)limits of formal schemes\n4.2. Solid formal schemes\n4.3. Formal schemes over a given base\n4.4. Formal subschemes\n4.5. Idempotents and formal schemes\n4.6. Sheaves over formal schemes\n4.7. Formal faithful flatness\n4.8. Coalgebraic formal schemes\n4.9. More mapping schemes\n5. Formal curves\n5.1. Divisors on formal curves\n5.2. Weierstrass preparation\n5.3. Formal differentials\n5.4. Residues\n6. Formal groups\n6.1. Group objects in general categories\n6.2. Free formal groups\n\n2\n3\n3\n3\n6\n8\n9\n11\n12\n13\n17\n23\n24\n25\n29\n30\n31\n34\n36\n39\n40\n41\n43\n47\n50\n51\n54\n57\n59\n60\n60\n64\nc 0000 (copyright holder)\n\n1\n\n\f2\n\nNEIL P. STRICKLAND\n\n6.3. Schemes of homomorphisms\n6.4. Cartier duality\n6.5. Torsors\n7. Ordinary formal groups\n7.1. Heights\n7.2. Logarithms\n7.3. Divisors\n8. Formal schemes in algebraic topology\n8.1. Even periodic ring spectra\n8.2. Schemes associated to spaces\n8.3. Vector bundles and divisors\n8.4. Cohomology of Abelian groups\n8.5. Schemes associated to ring spectra\n8.6. Homology of Thom spectra\n8.7. Homology operations\nReferences\n\n67\n68\n69\n71\n72\n74\n74\n75\n75\n76\n83\n86\n87\n87\n89\n91\n\n1. Introduction\nIn this paper we set up a framework for using algebraic geometry to study the\ngeneralised cohomology rings that occur in algebraic topology. This idea was probably first introduced by Quillen [21] and it implicitly or explicitly underlies much\nof our understanding of complex oriented cohomology theories, exemplified by the\nwork of Morava. Most of the results presented here have close and well-known analogues in the algebro-geometric literature, but with different definitions or technical\nassumptions that are often inconvenient for topological applications. Our aim here\nis merely to put everything together in a systematic way that naturally incorporates\nthe phenomena that we see in topology while discarding complications that never\narise there. In more detail, in the classical situation one is often content to deal\nwith finite dimensional, Noetherian schemes. Nilpotents are seen as a somewhat\nperipheral phenomenon, and formal schemes are only introduced at a late stage in\nthe exposition. Schemes are defined as spaces with extra structure. The idea of a\nscheme as a functor occurs in advanced work (a nice example is [16]) but is usually\nabsent from introductory treatments. For us, however, it is definitely most natural\nto think of schemes as functors. Our schemes are very often not Noetherian or finite\ndimensional, and nilpotents are of crucial importance. We make heavy use of formal schemes, and we need to define these in a more general way than is traditional.\nOn the other hand, we can get a long way using only affine schemes, whereas the\nusual treatment devotes a great deal of attention to the non-affine case.\nSection 2 is an exposition of the basic facts of algebraic geometry that is well\nadapted to the viewpoint discussed above, together with a number of useful examples.\nIn Section 3, we give a basic account of non-affine schemes from our point of\nview.\nIn Section 4, we give a very general definition of formal schemes which follows\nnaturally from our description of ordinary (or \"informal\") schemes. We then work\nout the basic properties of the category of formal schemes, such as the existence\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n3\n\nof limits and colimits and the behaviour of regular monomorphisms (or \"closed\ninclusions\").\nIn Section 6, we discuss the Abelian monoid and group objects in the category of\nformal schemes. We then specialise in Section 7 to the case of smooth, commutative,\none-dimensional formal groups, which we call \"ordinary formal groups\".\nFinally, in Section 8, we construct functors from the homotopy category of\nspaces (or suitable subcategories) to the category of formal schemes. We use the\nwork of Ravenel, Wilson and Yagita [24] to show that spaces whose Morava Ktheory is concentrated in even degrees give formal schemes with good technical\nproperties. We also discuss what happens to a number of popular spaces under our\nfunctors. Further applications of this point of view appear in [26, 27, 7, 11] and\na number of other papers in preparation.\n1.1. Notation and conventions. We write Rings for the category of rings\n(by which we always mean commutative unital rings) and Sets for the category of\nsets. For any ring R, we write ModR for the category of R-modules, and AlgR for\nthe category of R-algebras. Given a category C, we usually write C(X, Y ) for the\nset of C-morphisms from X to Y . We write CX for the category of objects of C\nover X. More precisely, on object of CX is a pair (Y, u) where u : Y \u2212\n\u2192 Z, and\nCX ((Y, u), (Z, v)) is the set of maps f : Y \u2212\n\u2192 Z in C such that vf = u.\nWe write F for the category of all functors Rings \u2212\n\u2192 Sets.\n1.2. Even periodic ring spectra. We now give a basic topological definition,\nas background for some motivating remarks to be made in subsequent sections.\nDetails of topological applications will appear in Section 8. The definition below\nwill be slightly generalised there, to deal with unpleasantness at the prime 2.\nDefinition 1.1. An even periodic ring spectrum is a commutative and associative ring spectrum E such that\n1. \u03c01 E = 0\n2. \u03c02 E contains a unit.\nThe example to bear in mind is the complex K-theory spectrum KU . Suitable\nversions of Morava E-theory and K-theory are also examples, as are periodised\nversions of M U and H; we write M P and HP for these. See Section 8 for more\ndetails.\n2. Schemes\nIn this section we set up the basic categorical apparatus of schemes. We then\ndiscuss limits and colimits of schemes, and various kinds of subschemes. We compare our functorial approach with more classical accounts by discussing the Zariski\nspace of a scheme. We then discuss various issues about nilpotent and idempotent\nfunctions. We define sheaves over functors, and show that our definition works\nas expected for schemes. We then define flatness and faithful flatness for maps of\nschemes, and prove descent theorems for schemes and sheaves over faithfully flat\nmaps. Finally, we address the question of defining a \"scheme of maps\" Map(X, Y )\nbetween two given schemes X and Y .\nDefinition 2.1. An affine scheme is a covariant representable functor\nX : Rings \u2212\n\u2192 Sets.\n\n\f4\n\nNEIL P. STRICKLAND\n\nWe make little use of non-affine schemes, so we shall generally omit the word\n\"affine\". A map of schemes is just a natural transformation. We write X for\nthe category of schemes, which is a full subcategory of F. We write spec(A) for the\nfunctor represented by A, so spec(A)(R) = Rings(A, R) and spec(A) is a scheme.\nRemark 2.2. If E is an even periodic ring spectrum and Z is a finite spectrum\nwe define ZE = spec(E 0 Z). This gives a covariant functor Z 7\u2192 ZE from finite\ncomplexes to schemes. We also write SE = spec(E 0 ).\nDefinition 2.3. We write A1 for the forgetful functor Rings \u2212\n\u2192 Sets. This is\nisomorphic to spec(Z[t]) and thus is a scheme. Given any functor X \u2208 F, we write\nOX for the set of natural maps X \u2212\n\u2192 A1 . (This can actually be a proper class for\ngeneral X, but it will always be a set in the cases that we consider.) Note that OX\nis a ring under pointwise operations.\nOur category of schemes is equivalent to the algebraic geometer's category of\naffine schemes, which in turn is equivalent (by Yoneda's lemma) to the opposite of\nthe category of rings.\nWe now describe the duality between schemes and rings in more detail. The\nYoneda lemma tells us that Ospec(A) is naturally isomorphic to A. For any functor\nX \u2208 F we have a tautological map \u03ba : X \u2212\n\u2192 spec(OX ). To define \u03ba explicitly,\nsuppose we have a ring R and an element x \u2208 X(R); we need to produce a map\n\u03baR (x) : OX \u2212\n\u2192 R. An element f \u2208 OX is a natural map f : X \u2212\n\u2192 A1 , so it has a\ncomponent fR : X(R) \u2212\n\u2192 R, and we can define \u03baR (x)(f ) = fR (x). If X = spec(A)\nthen \u03ba is easily seen to be bijective. As schemes are by definition representable,\nany scheme X is equivalent to spec(A) for some A, so we see that the map X \u2212\n\u2192\nspec(OX ) is always an isomorphism. Thus, the functor X \u2212\n\u2192 OX is inverse to the\nfunctor spec : Ringsop \u2212\n\u2192 X.\nWe next give some examples of schemes.\nExample 2.4. A basic example is the \"multiplicative group\" Gm , which is\ndefined by\nGm (R) = R\u00d7 = the group of units of R.\nThis is a scheme because it is represented by Z[x\u00b11 ].\nExample 2.5. The affine n-space An is defined by An (R) = Rn . This is a\nscheme because it is represented by Z[x1 , . . . , xn ]. If f1 , . . . , fm are polynomials\nin n variables over Z then there is an obvious natural map Rm \u2212\n\u2192 Rn for all rings\nR, which sends a = (a1 , . . . , am ) to (f1 (a), . . . , fn (a)). Thus, this gives a map\nAm \u2212\n\u2192 An of schemes. These are in fact all the maps between these schemes.\nThe key point is of course that the set of ring maps Z[y1 , . . . , ym ] \u2190\n\u2212 Z[x1 , . . . , xn ]\nbijects naturally with the set of such tuples (f1 , . . . , fm ). It is a good exercise to\nwork out all of the identifications going on here.\nWe next define the scheme FGL of formal group laws, which will play a central\nr\u00f4le in the applications of schemes to algebraic topology.\nExample 2.6. A formal group law over a ring R is a formal power series\nX\nF (x, y) =\nakl xk y l \u2208 R[[x, y]]\nk,l\u22650\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n5\n\nsatisfying\nF (x, 0) = x\nF (x, y) = F (y, x)\nF (F (x, y), z) = F (x, F (y, z)).\nWe can define a scheme FGL as follows:\nFGL(R) = { formal group laws over R}.\nTo see that FGL is a scheme, we consider\nL0 = Z[akl | k, l > 0] and the\nPthe ring\nformal power series F0 (x, y) = x + y +\nakl xk y l \u2208 L0 [[x, y]]. We then let I be\nthe ideal in L0 generated by the coefficients of the power series F0 (x, y) \u2212 F0 (y, x)\nand F0 (F0 (x, y), z) \u2212 F0 (x, F0 (y, z)). Finally, set L = L0 /I. It is easy to see that\nFGL = spec(L). The ring L is called the Lazard ring. It is a polynomial ring in\ncountably many variables; there is a nice exposition of the proof in [2, Part II].\nRecall that M P denotes the 2-periodic version of M U ; a fundamental theorem of\nQuillen [19, 20] (also proved in [2]) identifies the scheme SMP := spec(M P 0 ) with\nFGL.\nExample 2.7. Given any diagram of schemes {Xi }, we claim that the functor\nX = lim Xi (which is defined by (lim Xi )(R) = lim (Xi (R))) is also a scheme.\n\u2190- i\n\n\u2190- i\n\n\u2190- i\n\nIndeed, suppose that Xi = spec(Ai ). As spec : Ringsop \u2212\n\u2192 X is an equivalence, we\nget a diagram of rings Ai with arrows reversed. It is well-known that the category\nof rings has colimits, and it is clear that X = spec(lim Ai ).\n-\u2192 i\n\nIn particular, if X and Y are schemes, we have a scheme X \u00d7 Y with (X \u00d7\nY )(R) = X(R) \u00d7 Y (R) and OX\u00d7Y = OX \u2297 OY (because coproducts of rings are\nf\n\ng\n\ntensor products). Similarly, if we have maps X \u2212\n\u2192 Z \u2190\u2212 Y then we can form the\npullback\n(X \u00d7Z Y )(R) = X(R) \u00d7Z(R) Y (R) = {(x, y) \u2208 X(R) \u00d7 Y (R) | f (x) = g(y)}.\n\nThis is represented by the tensor product OX \u2297OZ OY .\nWe write 1 for any one-point set, and also for the constant functor 1(R) = 1.\nThus 1 = spec(Z), and this is the terminal object in X or F.\nExample 2.8. Let Z and W be finite CW complexes, and let E be an even\nperiodic ring spectrum. There is a natural map (Z \u00d7 W )E \u2212\n\u2192 ZE \u00d7SE WE . This\nwill be an isomorphism if E 1 Z = 0 = E 1 W and we have a K\u00fcnneth isomorphism\nE \u2217 (Z \u00d7 W ) = E \u2217 (Z) \u2297E \u2217 E \u2217 (W ). This holds in particular if H\u2217 Z is a free Abelian\ngroup, concentrated in even degrees.\nExample 2.9. An invertible power series over a ring R is a formal power series\nf \u2208 R[[x]] such that f (x) = wx + O(x2 ) for some w \u2208 R\u00d7 . This implies, of course,\nthat f has a composition-inverse g = f \u22121 , so that f (g(x)) = x = g(f (x)). We write\nIPS(S) for the set of such f , which is easily seen to be a scheme. It is actually a\ngroup scheme, in that IPS(R) is a group (under composition), functorially in R.\nThe group IPS acts on FGL by\n(f, F ) 7\u2192 Ff\n\nFf (x, y) = f (F (f \u22121 x, f \u22121 y)).\n\n\f6\n\nNEIL P. STRICKLAND\n\nAn isomorphism between formal group laws F and G is an invertible series f\nsuch that f (F (a, b)) = G(f (a), f (b)). Let FI be the following scheme:\nFI(R) = {(F, f, G) | F, G \u2208 FGL(R) and f : F \u2212\n\u2192 G is an isomorphism }.\n\nThere is an evident composition map\nFI \u00d7FGL FI \u2212\n\u2192 FI\n\nMoreover, there is an isomorphism\nIPS \u00d7 FGL \u2212\n\u2192 FI\n\n((F, f, G), (G, g, H)) 7\u2192 (F, gf, H).\n(F, f ) 7\u2192 (F, f, Ff ).\n\nOne can describe these maps by giving implicit formulae in the representing rings\nOIPS , OFGL an OFI , but this should be avoided where possible. Note that for each\nR we can regard FGL(R) as the set of objects of a groupoid, whose morphism\nset is FI(R). In other words, the schemes FGL and FI define a groupoid scheme.\nIt is known that FI = spec(M P0 M P ) (this follows easily from the description of\nM U\u2217 M U in [2]).\nExample 2.10. We now give an example for which representability is less obvious. We say that an effective divisor of degree n on A1 over a scheme Y is a\nsubscheme D \u2286 Y \u00d7 A1 = spec(OY [x]) such that OD is a quotient of OY [x] and\n1\nis free of rank n over OY . We let X(R) = Div+\nn (A )(R) denote the set of such\n+\ndivisors over spec(R), and we claim that X = Divn (A1 ) is a scheme. Firstly, it is a\nfunctor of R: given a ring map u : R \u2212\n\u2192 R\u2032 and a divisor D over R we get a divisor\n\u2032\n\u2032\nuD = spec(R \u2297R OD ) = spec(R ) \u00d7spec(R) D over R\u2032 . Next, given a divisor D as\nabove and an element y \u2208 R[x], we let \u03bb(y) be the map u 7\u2192 uy, which is an R-linear\nendomorphism of the\nOD \u2243 Rn . The map \u03bb(x) thus has a characteristic\nPmodule\nn\n\u2192 A1\npolynomial fD (t) = i=0 ai (D)tn\u2212i \u2208 R[t]. One checks that the map ai : X \u2212\nis natural, so we get an element ai of OX . As fD (t) is monic, we have a0 = 1. The\nremaining ai 's give us a map X \u2212\n\u2192 An .\nThe Cayley-Hamilton theorem tells us that fD (\u03bb(x)) = 0, but it is clear that\nfD (\u03bb(x)) = \u03bb(fD (x)) and fD (x) = \u03bb(fD (x))(1), so we find that fD (x) = 0 in OD\nand thus that OD is a quotient of R[x]/fD (x). On the other hand, it is clear that\nR[x]/fD (x) is also free over R of rank n, and it follows that OD = R[x]/fD (x).\nGiven this, we see that D is freely and uniquely determined by the coefficients\na1 , . . . , an , so that our map X \u2212\n\u2192 An is an isomorphism. This shows in particular\nthat X is a scheme. (I learned this argument from [4].)\n2.1. Points and sections. Let X be a scheme. A point of X means an\nelement x \u2208 X(R) for some ring R. We write Ox for R, which conveniently allows\nus to mention x before giving R a name. Recall that points x \u2208 X(R) biject with\nmaps spec(R) \u2212\n\u2192 X. We say that x is defined over R, or over spec(R).\nWe can also think of an element of R as a point of the scheme A1 over R. If\nf \u2208 OX then f is a natural map X(S) \u2212\n\u2192 S for all rings S, so in particular we have\na map X(R) \u2212\n\u2192 R. We thus have f (x) \u2208 Ox = R.\nExample 2.11. Let F be a point of FGL, in other words a formal group law\nover some ring R. We can write\n[3](x) = F (x, F (x, x)) = 3x + u(F )x2 + v(F )x3 + O(x4 )\nfor certain scalars u(F ) and v(F ). This construction associates to each point F \u2208\nFGL a point v(F ) \u2208 A1 in a natural way, thus giving an element v \u2208 OFGL .\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n7\n\nOf course, we know that OFGL is the Lazard ring L, which is generated by the\ncoefficients akl of the universal formal group law\nX\nFuniv (x, y) =\nakl xk y l\nk,l\n\nUsing this formal group law, we find that\n[3](x) = 3x + 3a11 x2 + (a211 + 8a12 )x3 + O(x4 )\nThis means that\nv(Funiv ) = a211 + 8a12\nIt follows that for any F over any ring R, the element v(F ) is the image of a211 +8a12\nunder the map L \u2212\n\u2192 R classifying F .\nExample 2.12. For any scalar a, we have a formal group law\nHa (x, y) = x + y + axy.\nThe construction a 7\u2192 Ha gives a natural transformation h : A1 (R) \u2212\n\u2192 FGL(R), in\nother words a map of schemes h : A1 \u2212\n\u2192 FGL. This can be thought of as a family\nof formal group laws, parametrised by a \u2208 A1 . It can also be thought of as a single\nformal group law over Z[a] = OA1 .\nExample 2.13. The point of view described above allows for some slightly\nschizophrenic constructions, such as regarding the two projections \u03c00 , \u03c01 : X \u00d7X \u2212\n\u2192\nX as two points of X over X 2 . Indeed, this is the universal example of a scheme\nY equipped with two points of X defined over Y . Similarly, we can think of the\nidentity map X \u2212\n\u2192 X as the universal example of a point of X. This is analogous to\nthinking of the identity map of K(Z, n) as a cohomology class u \u2208 H n K(Z, n); this\nis of course the universal example of a space with a given n-dimensional cohomology\nclass.\nDefinition 2.14. For any functor X : Rings \u2212\n\u2192 Sets, we define a category\nPoints(X), whose objects are pairs (R, x) with x \u2208 X(R). The maps (R, x) \u2212\n\u2192 (S, y)\nare ring maps f : R \u2212\n\u2192 S such that X(f )(x) = y.\nRemark 2.15. Let X be a scheme. The following categories are equivalent:\n(a)\n(b)\n(c)\n(d)\n(e)\n\nThe\nThe\nThe\nThe\nThe\n\ncategory\ncategory\ncategory\ncategory\ncategory\n\nXX of schemes Y equipped with a map u : Y \u2212\n\u2192 X.\nof representable functors Y \u2032 : Points(X) \u2212\n\u2192 Sets.\nof representable functors Y \u2032\u2032 : Xop\n\u2192 Sets.\nX \u2212\nAlgop\nOX of algebras R over OX .\nPoints(X)op of pairs (R, x) with x \u2208 X(R).\n\nBy Yoneda, an element x \u2208 X(R) corresponds to a map x\u2032 : spec(R) \u2212\n\u2192 X. Similarly, a map v : Z \u2212\n\u2192 X gives a map v \u2217 : OX \u2212\n\u2192 OZ , making OZ into an OX -algebra.\nThis can also be regarded as an element of spec(OX )(OZ ) = X(OZ ). With this\n\n\f8\n\nNEIL P. STRICKLAND\n\nnotation, the equivalence is as follows.\na\nY \u2032 (S, z)\nY (S) =\nz\u2208X(S)\n\nY \u2032 (S, z) = preimage of z \u2208 X(S) under u : Y (S) \u2212\n\u2192 X(S)\nz\u2032\n\nv\n\n= Y \u2032\u2032 (spec(S) \u2212\u2192 X)\n\nY \u2032\u2032 (Z \u2212\n\u2192 X) = Y \u2032 (OZ , v \u2217 )\nR = OY\n\nY = spec(R).\nFor us, the most important part of this will be the equivalence (a)\u21d4(b).\nRemark 2.16. If E is an even periodic ring spectrum and SE = spec(E 0 ) then\nwe can regard the construction Z 7\u2192 ZE = spec(E 0 Z) as a functor from finite\ncomplexes to XSE .\nDefinition 2.17. If X is a scheme over another scheme Y , and y \u2208 Y (R) is a\npoint of Y , we write Xy = spec(R) \u00d7Y X, which is a scheme over spec(R). Here\nwe have used the map spec(R) \u2212\n\u2192 Y corresponding to the point y \u2208 Y (R) to form\nthe pullback spec(R) \u00d7Y X. We call Xy the fibre of X over the point y.\n2.2. Colimits of schemes. The category of rings has limits for small diagrams, and the category of schemes is dual to that of rings, so it has colimits for\nsmall diagrams. However, it seems that these colimits only interact well with our\ngeometric point of view if they have some additional properties (this is also the\nreason for Mumford's geometric invariant theory, which is much more subtle than\nanything that we consider here.) One good property that often occurs (with C = X\nor C = XY ) is as follows.\n\nDefinition 2.18. Let C be a category with finite products, and let {Xi } be a\ndiagram in C. We say that an object X with a compatible system of maps Xi \u2212\n\u2192X\nis a strong colimit of the diagram if W \u00d7 X is the colimit of {W \u00d7 Xi } for each\nW \u2208 C. We define strong coproducts and strong coequalisers as special cases of\nthis, in the obvious way.\nExample\nQ 2.19. The categories X and XY have strong finite coproducts, and\nO` i Xi = i OXi . Indeed, by the usual duality Ringsop = X, we see that the\nQ\ncoproduct exists and has O` i Xi = i OXi . Thus, we need only check that Z \u00d7Y\nQ\nQ\n`\n`\ni OZ \u2297OY OXi , which\ni OXi =\ni Z \u00d7Y Xi , or equivalently that OZ \u2297OY\ni Xi =\nis clear because the indexing set is finite. Note that when Y = 1 is the terminal\nobject, we have XY = X, so we have covered that case as well.\nAs a special case of the above, we can make the following definition.\nDefinition 2.20. Given a finite set A, we can define an associated constant\nscheme A by\na\n1\nA=\na\u2208A\n\n`\n(where 1 is the terminal object in X). This has the property that X \u00d7 A = a\u2208A X\nfor all X. We also have OA = F (A, Z), which denotes the ring of functions from\nthe set A to Z; this is a ring under pointwise operations.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n9\n\nRemark 2.21. It is not the case that (X \u2210 Y )(R) = X(R) \u2210 Y (R) (unlike the\ncase of products and pullbacks). Instead, we have\n(X \u2210 Y )(R) = {(S, T, x, y) | S, T \u2264 R , R = S \u00d7 T , x \u2208 X(S) , y \u2208 Y (T )}.\n\nTo explain this, note that an element of (X\u2210Y )(R) is (by Yoneda) a map spec(R) \u2212\n\u2192\nX \u2210 Y . This will be given by a decomposition spec(R) = spec(S) \u2210 spec(T ) and\nmaps spec(S) \u2212\n\u2192 X and spec(T ) \u2212\n\u2192 Y . Clearly, if R does not split nontrivially as a\nproduct of smaller rings then we have the naive rule (X \u2210 Y )(R) = X(R) \u2210 Y (R).\nSimilarly, the initial scheme \u2205 = spec(0) has \u2205(R) = \u2205 unless R = 0 in which\ncase \u2205(R) has a single element.\nExample 2.22. Let f : X \u2212\n\u2192 Y be a map of schemes. Let XYn denote the fibre\nproduct of n copies of X over Y , so that the symmetric group \u03a3n acts on XYn ,\ncovering the trivial action on Y . Suppose that the resulting map f \u2217 : OY \u2212\n\u2192 OX\nmakes OX into a free module over OY . We then claim that there is a strong\ncolimit for the action of \u03a3n on XYn . To see this, write A = OX and B = OY and\nC = A\u2297B n , so that XYn = spec(C). Our claim reduces easily to the statement\nthat B \u2032 \u2297B (C \u03a3n ) = (B \u2032 \u2297B C)\u03a3n for every algebra B \u2032 over B. To see that this\nholds, choose a basis for A over B. This gives an evident basis for C over B, which\nis permuted by the action of \u03a3n . Clearly C \u03a3n is a free module over B, with one\ngenerator for each \u03a3n -orbit in our basis for C. There is a similar description for\n(B \u2032 \u2297B C)\u03a3n , which quickly implies our claim.\nSome more circumstances in which colimits have unexpectedly good behaviour\nare discussed in [7], which mostly follows ideas of Quillen [21].\n2.3. Subschemes. Recall that an element of OX is a natural map X \u2212\n\u2192 A1 .\nThus, if x is a point of X then f (x) is a scalar (more precisely, if x \u2208 X(R) then\nf (x) \u2208 R) and we can ask whether f (x) = 0, or whether f (x) is invertible.\nDefinition 2.23. Given a scheme X and an ideal I \u2264 OX , we define a scheme\nV (I) by\nV (I)(R) = {x \u2208 X(R) | f (x) = 0 for all f \u2208 I}.\n\nOne checks that V (I) = spec(OX /I), so this really is a scheme. Schemes of this\nform are called closed subschemes of X.\nGiven an element f \u2208 OX , we define a scheme D(f ) by\nD(f )(R) = {x \u2208 X(R) | f (x) \u2208 R\u00d7 }.\n\nOne checks that D(f ) = spec(OX [1/f ]), so this really is a scheme. Schemes of this\nform are called basic open subschemes of X.\nA locally closed subscheme is a basic open subscheme of a closed subscheme.\nSuch a thing has the form D(f ) \u2229 V (I) = spec(OX [1/f ]/I).\nRemark 2.24. Recall that a map f : R \u2212\n\u2192 S of rings is said to be a regular\nepimorphism if and only if it is the coequaliser of some pair of maps T\nR, which\nhappens if and only if it is the coequaliser of the obvious maps R \u00d7S R\nR. It is\neasy to check that this holds if and only if f is surjective. Given this, we see that\nthe regular monomorphisms of schemes are precisely the closed inclusions, and that\ncomposites and pushouts of regular monomorphisms are regular monomorphisms.\n\nw\n\nw\n\n\f10\n\nNEIL P. STRICKLAND\n\nExample 2.25. The map h in Example 2.12 gives an isomorphism between A1\nand the closed subscheme V ((aij | i + j > 2)) of FGL. The multiplicative group\nGm is an open subscheme of A1 .\nExample 2.26. If X is a scheme and e \u2208 OX satisfies e2 = e then it is easy to\ncheck that D(e) = V (1\u2212e), so this subscheme is both open and closed. Moreover, we\nhave X\nP = D(e)\u2210D(1\u2212e). More generally, if`we have idempotents e1 , . . . , em \u2208 OX\nwith i ei = 1 and ei ej = \u03b4ij ei then X = i D(ei ), and every splitting of X as a\nfinite coproduct occurs in this way.\nExample 2.27. Suppose X = spec(k[x]) is the affine line over a field k, and\n\u03bb, \u03bc \u2208 k. The closed subscheme V (x\u2212\u03bb) = spec(k[x]/(x\u2212\u03bb)) \u2243 spec(k) corresponds\nto the point \u03bb of the affine line; it is natural to refer to it as {\u03bb}. The closed\nsubscheme V ((x \u2212 \u03bb)(x \u2212 \u03bc)) corresponds to the pair of points {\u03bb, \u03bc}. If \u03bb = \u03bc,\nthis is to be thought of as the point \u03bb with multiplicity two, or as an infinitesimal\nthickening of the point \u03bb.\nWe can easily form the intersection of locally closed subschemes:\nD(a) \u2229 V (I) \u2229 D(b) \u2229 V (J) = D(ab) \u2229 V (I + J).\n\nWe cannot usually form the union of basic open subschemes and still have an\naffine scheme. Again, it would be easy enough to consider non-affine schemes, but\nit rarely seems to be necessary. Moreover, a closed subscheme V (a) determines\nthe complementary open subscheme D(a) but not conversely; D(a) = D(a2 ) but\nV (a) 6= V (a2 ) in general.\nWe say that a scheme\n\u221a X is reduced if OX has no nonzero nilpotents, and\nwrite Xred = spec(OX / 0), which is the largest reduced closed subscheme of X.\nMoreover, if Y \u2286 X is closed then Yred = Xred if and only if X(k) = Y (k) for every\nfield k (we leave the proof as an exercise).\nWe define the union of closed subschemes by V (I) \u222a V (J) = V (I \u2229 J). We\nalso define the schematic union by V (I) + V (J) = V (IJ). This is a sort of \"union\nwith multiplicity\" - in particular, V (I) + V (I) 6= V (I) in general. In the previous\nexample, we have\n{\u03bb} \u222a {\u03bb} = V ((x \u2212 \u03bb)2 )\n\nwhich is a thickening of {\u03bb}. Note that V (IJ)red = V (I \u2229 J)red , because (I \u2229 J)2 \u2264\nIJ \u2264 I \u2229 J.\nWe shall say that X is connected if it cannot be split nontrivially as Y \u2210 Z, if\nand only if there are no idempotents in OX other than 0 and 1.\nWe shall say that a scheme X is integral if and only if OX is an integral\ndomain, and that X is irreducible if and only if Xred is integral. We also say that\nX is Noetherian if and only if the ring O\nSX is Noetherian. If so, then Xred can be\nwritten in a unique way as a finite union i Yi with Yi an integral closed subscheme.\nThe schemes Yi are called the irreducible components of Xred ; they are precisely\nthe schemes V (pi ) for pi a minimal prime ideal of OX . See [18, section 6] for this\nmaterial.\nS\nSuppose that X is Noetherian and reduced, say X = S i\u2208 S Yi as above for\nsomeTfinite set S. Suppose that S = S \u2032 \u2210 S \u2032\u2032 . Write X \u2032 = S \u2032 Yi = V (I \u2032 ), where\nI \u2032 = S \u2032 pi , and similarly for X \u2032\u2032 and I \u2032\u2032 . If we then write\n\u0393(I \u2032 ) = {a \u2208 OX | a(I \u2032 )N = 0 for N \u226b 0},\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n11\n\nwe find that \u0393(I \u2032 ) = I \u2032\u2032 and thus V (\u0393(I \u2032 )) = X \u2032\u2032 .\nExample 2.28. Take Z = spec(k[x, y]/(xy 2 )) and set\nX = V (y) = spec(k[x])\nX \u2032 = V (y 2 ) = spec(k[x, y]/(y 2 ))\nY = V (x) = spec(k[y])\nThen X is the x-axis, Y is the y-axis and X \u2032 is an infinitesimal thickening of X.\n\u2032\nThe schemes X and Y are integral, and X \u2032 is irreducible because Xred\n= X. The\nscheme Z is reducible, and its irreducible components are X and Y .\n2.4. Zariski spectra and geometric points. If R is a ring, we define the\nZariski space to be\nzar(R) = { prime ideals p < R }.\n\nIf X is a scheme, we write Xzar = zar(OX ). Note that\n\nV (I)zar = zar(OX /I) = {p \u2208 Xzar | I \u2264 p}\n\nD(f )zar = zar(OX [1/f ]) = {p \u2208 Xzar | f 6\u2208 p}\n\nThere is a map\n\n(X \u2210 Y )zar = Xzar \u2210 Yzar\n\n(X \u00d7 Y )zar \u2212\n\u2192 Xzar \u00d7 Yzar ,\n\nbut it is almost never a bijection.\nSuppose that Y, Z \u2264 X are locally closed; then\nIf Y and Z are closed then\n\n(Y \u2229 Z)zar = Yzar \u2229 Zzar .\n\n(Y \u222a Z)zar = (Y + Z)zar = Yzar \u222a Zzar .\n\nWe give Xzar the topology with closed sets V (I)zar . A map of schemes X \u2212\n\u2192Y\nthen induces a continuous map Xzar \u2212\n\u2192 Yzar .\nSuppose that R is an integral domain, and that x \u2208 X(R). Then x gives a map\nx\u2217 : OX \u2212\n\u2192 R, whose kernel px is prime. We thus have a map X(R) \u2212\n\u2192 Xzar , which\nis natural for monomorphisms of R and arbitrary morphisms of X.\nA geometric point of X is an element of X(k), for some algebraically closed\nfield k. Suppose that either OX is a Q-algebra, or that some prime p is nilpotent\nin OX . Let k be an algebraically closed field of the appropriate characteristic, with\ntranscendence degree at least the cardinality of OX . Then it is easy to see that\nX(k) \u2212\n\u2192 Xzar is epi.\nA useful feature of the Zariski space is that it behaves quite well under colimits [21, 7]. The following proposition is another example of this.\nProposition 2.29. Suppose that a finite group G acts on a scheme X. Then\n(X/G)zar = Xzar /G.\nProof. Write S = OX and R = S G = OX/G . Given a prime p \u2208 zar(R) =\n(X/G)zar , the fibre F over p in zar(S) = Xzar is just zar(Sp /pSp) (see [18, Section\n7]). We need to prove that F is nonempty, and that G acts transitively on F .\nAs localisation is exact, we have (Sp )G = Rp , so we can replace R by Rp and\nthus assume that R is local at p. With this assumption, we have F = zar(S/pS).\n\n\f12\n\nNEIL P. STRICKLAND\n\nQ\nFor a \u2208 S we write fa (t) = g\u2208G (t \u2212 ga) \u2208 S[t]G = R[t], so that fa is a monic\npolynomial with fa (a) = 0. This shows that S is an integral extension over R, so\nF 6= \u2205 and there are no inclusions between the elements of F [18, Theorem 9.3].\nLet q and r be two points of F T\n, so they are prime ideals in S with q\u2229R = qG = p\nand r \u2229 R = rG = p. Write I = g\u2208G g.q \u2264 S. If a \u2208 I then g.a \u2208 q for all g so\nfa (t) \u2208 t|G| + q[t] but also fa (t) is G-invariant so fa (t) \u2208 t|G| + qG [t] \u2286 t|G| + r[t].\nAs fa (a) = 0 we conclude that a is nilpotent mod r but r is prime so a \u2208 r. Thus\nT\ng\u2208G g.q \u2264 r. As r is prime, we deduce that g.q \u2264 r for some g \u2208 G. As there are\nno inclusions between the elements of F , we conclude that g.q = r. Thus G acts\ntransitively on F , which proves that (X/G)zar = Xzar /G.\nA number of interesting things can be detected by looking at Zariski spaces. For\nexample, Xzar splits as a disjoint union if and only if X does - see Corollary 2.40.\nWe also use the space Xzar to define the Krull dimension of X.\nDefinition 2.30. If there is a chain p0 < . . . < pn in Xzar , but no longer\nchain, then we say that dim(X) = n. If there are arbitrarily long chains then\ndim(X) = \u221e.\nExample 2.31. The terminal object 1 has dimension one (because there are\nchains (0) < (p) of prime ideals in Z). If OX is a field then dim(X) = 0. If OX is\nNoetherian then dim(Gm \u00d7 X) = 1 + dim(X) and dim(An \u00d7 X) = n + dim(X) [18,\nSection 15]. In particular, we have dim(An ) = dim(1 \u00d7 An ) = n + 1.\nExample 2.32. The schemes FGL, IPS and FI all have infinite dimension.\n2.5. Nilpotents, idempotents and connectivity.\nProposition 2.33. Suppose that e \u2208 R is idempotent, and f = 1 \u2212 e. Then\neR = R/f = R[e\u22121 ] = {a \u2208 R | f a = 0}.\n\nMoreover, this is a ring with unit e, and we have R = eR \u00d7 f R as rings.\n`n\nProposition 2.34. If X is a scheme, P\nthen splittings X = i=1 Xi biject with\nsystems of idempotents {e1 , . . . , en } with i ei = 1 and ei ej = \u03b4ij ej .\n\nExample 2.35. Let Mult(n) be the scheme of polynomials \u03c6(u) of degree at\nmost n suchPthat \u03c6(1) = 1 and \u03c6(uv) = \u03c6(u)\u03c6(v). Such a series P\ncan be written\nn\ni\ne\nu\n,\nand\nthe\nconditions\non\n\u03c6\nare\nequivalent\nto\nas \u03c6(u) =\ni ei = 1 and\ni=0 i\nei ej = \u03b4ij ej . In other words, the `\nelements ei are orthogonal idempotents. Using\nn\nthis, we see easily that Mult(n) = i=0 1.\n\nExample 2.36. Now let E(n) be the scheme of n \u00d7 n matrices A over R such\nthat A2 = A. Define \u03b1A (u) = uA+ (1 \u2212 A) = (u \u2212 1)A+ 1 \u2208 Mn (R[u]) and \u03c6A (u) =\ndet(\u03b1A (u)) \u2208 R[u]. We find easily that \u03b1A (1) = 1 and \u03b1A (uv) = \u03b1A (u)\u03b1A`\n(v), so\nn\n\u03c6A (u) \u2208 Mult(n)(R). This construction\ngives\na\nmap\nE(n)\n\u2212\n\u2192\nMult(n)\n=\ni=0 1,\n`n\nwhich gives a splitting E(n) = i=0 E(n, i), where E(n, i) is the scheme of n \u00d7 n\nmatrices A such that A2 = A and \u03c6A (u) = ui .\nNote that the function A 7\u2192 trace(A) lies in OE(n) and that E(n, i) is contained\nin the closed subscheme E \u2032 (n, i) = {A | trace(A) = i}. However, if n > 0 but\nn = 0 in R then E \u2032 (n, 0)(R) and E \u2032 (n, n)(R) are not disjoint, which shows that\nE \u2032 (n, i) 6= E(n, i) in general.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n13\n\nFor any ring R, we let Nil(R) denote the set of nilpotents in R.\nProposition 2.37. Nil(R) is the intersection of all prime ideals in R.\nProof. [18, Section 1]\nProposition 2.38 (Idempotent Lifting). Suppose that e \u2208 R/ Nil(R) is idempotent. Then there is a unique idempotent \u1ebd \u2208 R lifting e.\nProof. Choose a (not necessarily idempotent) lift of e to R, call it e, and\nwrite f = 1 \u2212 e. We know that ef is nilpotent, say en f n = 0. Define\nc = en + f n \u2212 1 = en + f n \u2212 (e + f )n\n\nThis is visibly divisible by ef , hence nilpotent; thus en + f n = 1 + c is invertible.\nDefine\n\u1ebd = en /(1 + c)\nf \u0303 = f n /(1 + c) = 1 \u2212 \u1ebd\n\nThen \u1ebd is an idempotent lifting e. If \u1ebd1 is another such then \u1ebd1 f \u0303 is idempotent. It\nlifts ef = 0, so it is also nilpotent. It follows that \u1ebd1 f \u0303 = 0 and \u1ebd1 = \u1ebd\u1ebd1 . Similarly,\n\u1ebd = \u1ebd\u1ebd1 , so \u1ebd = \u1ebd1 .\n\nTheorem 2.39 (Chinese Remainder Theorem). Suppose that {I\u03b1 } is a finite\nfamily of ideals in R, which are pairwise coprime (i.e. I\u03b1 + I\u03b2 = R when \u03b1 6= \u03b2).\nThen\n\\\nY\nR/ I\u03b1 =\nR/I\u03b1\n\u03b1\n\n\u03b1\n\nProof. [18, Theorems 1.3,1.4]\n\n`\nCorollary 2.40. Suppose that zar(R)\n\u221a = \u03b1 zar(R/I\u03b1 )Q(a finite coproduct).\nThen there are unique ideals J\u03b1 \u2264 I\u03b1 \u2264 J\u03b1 such that R \u2243 \u03b1 R/J\u03b1 .\nT\nProof. Proposition 2.37 implies that \u03b1 I\u03b1 is nilpotent. If \u03b1 6= \u03b2 then no\nprime ideal contains I\u03b1 + I\u03b2 , so I\u03b1 + I\u03b2 = R. Now use the Chinese remainder\ntheorem, followed by idempotent lifting.\nRemark 2.41. There are nice topological applications of these ideas in [15, 7],\nfor example.\n2.6. Sheaves, modules and vector bundles. The simplest definition of\na sheaf over a scheme X is just as a module over the ring OX . (It would be\nmore accurate to refer to this as a quasi-coherent sheaf of O-modules over X, but\nwe shall just call it a sheaf.) However, we shall give a different (but equivalent)\ndefinition which fits more neatly with our emphasis on schemes as functors, and\nwhich generalises more easily to formal schemes.\nDefinition 2.42. A sheaf over a functor X \u2208 F consists of the following data:\n(a) For each (R, x) \u2208 Points(X), a module Mx over R.\n(b) For each map f : (R, x) \u2212\n\u2192 (S, y) in Points(X), an isomorphism \u03b8(f ) =\n\u03b8(f, x) : S \u2297R Mx \u2212\n\u2192 My of S-modules.\nThe maps \u03b8(f, x) are required to satisfy the functorality conditions\n(i) In the case f = 1 : (R, x) \u2212\n\u2192 (R, x) we have \u03b8(1, x) = 1 : Mx \u2212\n\u2192 Mx .\n\n\f14\n\nNEIL P. STRICKLAND\nf\n\ng\n\n(ii) Given maps (R, x) \u2212\n\u2192 (S, y) \u2212\n\u2192 (T, z), the map \u03b8(gf, x) is just the composite\n1\u2297\u03b8(f,x)\n\n\u03b8(g,y)\n\nT \u2297R Mx = T \u2297S S \u2297R Mx \u2212\u2212\u2212\u2212\u2212\u2192 T \u2297S My \u2212\u2212\u2212\u2212\u2192 Mz .\n\nWe write SheavesX for the category of sheaves over X. This has direct sums (with\n(M \u2295 N )x = Mx \u2295 Nx ) and tensor products (with (M \u2297 N )x = Mx \u2297R Nx when\nx \u2208 X(R)). The unit for the tensor product is the sheaf O, which is defined by\nOx = R for all x \u2208 X(R).\nRemark 2.43. If M and N are sheaves over a sufficiently bad functor X, it\ncan happen that SheavesX (M, N ) is a proper class. This will not be the case if X\nis a scheme or a formal scheme, however.\nExample 2.44. Let x be a point of A1 (R), or in other words an element of R.\nDefine Mx = R/x; this gives a sheaf over A1 . Note that Mx = 0 if x is invertible,\nbut Mx = R if x = 0. Thus, M is concentrated at the origin of A1 .\nDefinition 2.45.\n1. Let X be a functor in F. If N is a module over the\nring OX = F(X, A1 ), we define a sheaf \u00d1 over X by \u00d1x = R \u2297OX N , where\nwe use x to make R into an algebra over OX .\n`\n2. If M is a sheaf over X and R is a ring, we write A(M )(R) = x\u2208X(R) Mx .\nIf f : R \u2212\n\u2192 S is a homomorphism, we define a map A(M )(R) \u2212\n\u2192 A(M )(S),\nwhich sends Mx to Mf (x) by m 7\u2192 \u03b8(f, x)(1 \u2297 m). This gives a functor\nA(M ) \u2208 FX .\n3. If M is a sheaf over X, we define \u0393(X, M ) = FX (X, A(M )). Thus, an\nelement u \u2208 \u0393(X, M ) is a system of elements ux \u2208 Mx for all rings R and\npoints x \u2208 X(R), which behave in the obvious way under maps of rings. If\nM = O then A(O) = A1 \u00d7 X and \u0393(X, O) = OX . It follows that \u0393(X, M ) is\na module over OX for all M .\n4. If Y is a scheme over X, we also define \u0393(Y, M ) = FX (Y, A(M )).\nProposition 2.46. For any functor X \u2208 F, the functor \u0393(X, \u2212) : SheavesX \u2212\n\u2192\nModOX is right adjoint to the functor N 7\u2192 \u00d1 .\nProof. For typographical convenience, we will write T N for \u00d1 and GM for\n\u0393(X, M ). We define maps \u03b7 : N \u2212\n\u2192 GT N and \u01eb : T GM \u2212\n\u2192 M as follows. Let\nn be an element of N ; for each point x \u2208 X(R), we define \u03b7(n)x = 1 \u2297 n \u2208\nR \u2297OX N = (T N )x , giving a map \u03b7 as required. Next, we define \u01ebx : (T GM )x =\n\u2192 Mx by \u01ebx (a \u2297 u) = aux . We leave it to the reader to check the\nR \u2297OX \u0393(X, M ) \u2212\ntriangular identities (\u01ebT )(T \u03b7) = 1T and (G\u01eb)(\u03b7G ) = 1G , which show that we have\nan adjunction.\nProposition 2.47. Let X be a scheme, and let x0 \u2208 X(OX ) be the tautological point, which corresponds to the identity map of OX under the isomorphism X = spec(OX ). Then there is a natural isomorphism \u0393(X, M ) = Mx0 ,\nand \u0393(X, \u2212) : SheavesX \u2212\n\u2192 ModOX is an equivalence of categories.\nProof. First, we define a map \u03b1 : \u0393(X, M ) \u2212\n\u2192 Mx0 by u 7\u2192 ux0 . Next, suppose\nthat m \u2208 Mx0 . If x \u2208 X(R) for some ring R then we have a corresponding ring map\nx\u0302 : f 7\u2192 f (x) from (OX , x0 ) to (R, x). We define \u03b2(m)x = \u03b8(x\u0302, x0 )(m) \u2208 Mx . One\n\u2192 \u0393(X, M )\ncan check that this gives an element \u03b2(m) \u2208 \u0393(X, M ), and that \u03b2 : Mx0 \u2212\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n15\n\nis inverse to \u03b1. It follows that \u0393(X, \u00d1 ) = \u00d1x0 , which is easily seen to be the same\nas N . Also, if N = Mx0 then \u00d1x = R \u2297OX Mx0 , and \u03b8(x\u0302, x0 ) gives an isomorphism\nof this with Mx , so \u00d1 = M . It follows that the functor N 7\u2192 \u00d1 is inverse to\n\u0393(X, \u2212).\nIt follows that when X is a scheme, the category SheavesX is Abelian. Because\ntensor products preserve colimits and finite products, we see that the functors\nM 7\u2192 Mx preserve colimits and finite products.\nWe next need some recollections about finitely generated projective modules.\nIf M is such a module over a ring R and p \u2208 zar(R) then Mp is a finitely generated\nmodule over the local ring Rp and thus is free [18, Theorem 2.5], of rank rp (M ) say.\nNote that rp (M ) is also the dimension of \u03ba(p) \u2297R M over the field \u03ba(p) = Rp /pRp .\nIf this is independent of p then we call it r(M ) and say that M has constant rank.\nClearly, if any two of M , N and M \u2295 N have constant rank then so does the third\nand r(M \u2295 N ) = r(M ) + r(N ). Also, if r(M ) = 0 then M = 0.\n\nDefinition 2.48. Let M be a sheaf over a functor X. If Mx is a finitely\ngenerated projective module over Ox for all x \u2208 X, we say that M is a vector\nbundle or locally free sheaf over X. If in addition Mx has rank one for all x, we\nsay that M is a line bundle or invertible sheaf .\n\nIf X is a scheme, a sheaf M is a vector bundle if and only if \u0393(X, M ) is a\nfinitely generated projective module over OX . However, this does not generalise\neasily to formal schemes, so we do not take it as the definition. It is not hard to\ncheck that Mx has constant rank r for all R and all x \u2208 X(R) if and only if Mx\nhas dimension r over K for all algebraically closed fields K and all x \u2208 X(K).\n\nRemark 2.49. In algebraic topology, it is very common that the naturally\noccurring projective modules are free, and thus that the corresponding vector bundles and line bundles are trivialisable. However, they are typically not equivariantly\ntrivial for important groups of automorphisms, so it is conceptually convenient to\navoid choosing bases. The main example is that if Z is a finite complex and V is\ne 0 Z V gives a line\na complex vector bundle over Z with Thom complex Z V then E\nbundle over ZE . A choice of complex orientation on E gives a Thom class and thus\na trivialisation, but this is not invariant under automorphisms of E.\n`n\nExample 2.50. Recall the scheme E(n) = i=0 E(n, i) of Example 2.36. A\npoint of E(n)(R) is an n \u00d7 n matrix A over R with A2 = A. This means that\nMA = A.Rn is a finitely generated projective R-module, so this construction defines\na vector bundle M over E(n). If A is a point of E(n, i) (so that det((u \u2212 1)A + 1) =\nui \u2208 R[u]) and R is an algebraically closed field, then elementary linear algebra\nshows that A has rank i. It follows that the restriction of M to E(n, i) has rank i.\nLet N be a vector bundle over an arbitrary scheme X. The associated projective\nOX -module is then a retract of a finitely generated free module, so there is a matrix\nA \u2208 E(n)(OX ) such that \u0393(X, N ) = A.OnX for some n. The point A \u2208 E(n)(OX )\n\u2217\ncorresponds to a map \u03b1 : X \u2212\n\u2192 E(n), and we\n`find that \u03b1 M = N . If Xi denotes\nthe preimage of E(n, i) under \u03b1, then X = i Xi and the restriction of N to Xi\nhas rank i.\nLet X be a scheme. Using equivalence SheavesX \u2243 ModOX again, we see that\nthere are sheaves Hom(M, N ) such that\nSheavesX (L, Hom(M, N )) = SheavesX (L \u2297 M, N ).\n\n\f16\n\nNEIL P. STRICKLAND\n\nIn particular, we define M \u2228 = Hom(M, O). If M is a vector bundle then we have\nHom(M, N )x = HomR (Mx , Nx ) and thus (M \u2228 )x = Hom(Mx , R). In that case M \u2228\nis again a vector bundle and M \u2228\u2228 = M . If M is a line bundle then we also have\nM \u2297 M \u2228 = O.\nExample 2.51. Let Y be a closed subscheme of X, with inclusion map j : Y \u2212\n\u2192\nX. Then IY = {f \u2208 OX | f (y) = 0 for all points y \u2208 Y } is an ideal in OX and\nOY = OX /IY . We define j\u2217 O to be the sheaf over X corresponding to the OX module OY . More explicitly, we have\n(j\u2217 O)x = Ox /(f (x) | f \u2208 JY \u2286 OX ).\nWe also let IY be the sheaf associated to the OX -module IY , so that (IY )x =\nOx \u2297OX IY for all points x of X. Note that the sequence IY \u058c O \u0589 j\u2217 O is short\nexact in SheavesX , even though the sequences (IY )x \u2212\n\u2192 OX \u0589 (j\u2217 O)x need only be\nright exact.\nExample 2.52. Given a sheaf N over a functor Y and a map f : X \u2212\n\u2192 Y , we\ncan define a sheaf f \u2217 N over X by (f \u2217 N )x = Nf (x) . The functor f \u2217 : SheavesY \u2212\n\u2192\nSheavesX clearly preserves colimits and tensor products. If N is a vector bundle\nthen so is f \u2217 N and we have f \u2217 Hom(N, M ) = Hom(f \u2217 N, f \u2217 M ) for all M . If X and\nY are schemes, we find that \u0393(X, f \u2217 N ) = OX \u2297OY \u0393(Y, N ).\nExample 2.53. If the functor f \u2217 defined above has a right adjoint, we call it\nf\u2217 . If X and Y are schemes then we know from Proposition 2.47 that there is\nan essentially unique functor f\u2217 : SheavesX \u2212\n\u2192 SheavesY such that \u0393(Y, f\u2217 M ) =\n\u0393(X, M ) (where the right hand side is regarded as an OY -module using the map\nOX \u2212\n\u2192 OY induced by f ). Using the fact that \u0393(X, f \u2217 N ) = OX \u2297OY \u0393(Y, N ) one\nchecks that f\u2217 is right adjoint to f \u2217 as required.\nProposition 2.54. If M is a vector bundle over a scheme X, then A(M ) is a\nscheme.\n\u2192 R) \u2208\nProof. Write N = ModOX (\u0393(X, M ), OX ). Then for any map (x : OX \u2212\nX(R) we have Mx = ModOX (N, R), where R is considered as an OX -module via x.\nIf we let S be the symmetric algebra `\nSymOX [N ] then we have\n` Mx = AlgOX (S, R).\nIt follows easily that Rings(S, R) = x AlgOX ,x (S, R) = x Mx = A(M )(R), so\nA(M ) is representable as required.\nDefinition 2.55. Given a line bundle L over a functor X, we define a functor\nA(L)\u00d7 over X by\na\n{ isomorphisms u : R \u2212\n\u2192 Lx of R-modules }.\nA(L)\u00d7 (R) =\nx\u2208X(R)\n\nIf X L\nis a scheme, an argument similar to the one for A(M ) shows that A(L)\u00d7 =\nspec( n\u2208Z N \u2297n ), where N = ModOX (\u0393(X, L), OX ) and N \u2297(\u2212n) means the dual\nof N \u2297n . In particular, A(L)\u00d7 is a scheme in this case.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n17\n\n2.7. Faithful flatness and descent.\nDefinition 2.56. Let f : X \u2212\n\u2192 Y be a map of schemes, and f \u2217 : XY \u2212\n\u2192 XX the\nassociated pullback functor. We say that f is flat if f \u2217 preserves finite colimits. By\nExample 2.19, it is equivalent to say that f \u2217 preserves coequalisers. We say that f\nis faithfully flat if f \u2217 preserves finite colimits and reflects isomorphisms.\nRemark 2.57. Let f : X \u2212\n\u2192 Y be faithfully flat. We claim that f \u2217 reflects\n\u2217\nfinite colimits, so that f Z = lim f \u2217 Zi if and only if Z = lim Zi . More precisely,\n-\u2192 i\n\n-\u2192 i\n\nif {Zi } is a finite diagram in XY and {Zi \u2212\n\u2192 Z} is a cone under the diagram, then\n{f \u2217 Zi \u2212\n\u2192 f \u2217 Z} is a colimit cone in XX if and only if {Zi \u2212\n\u2192 Z} is a colimit cone in\nXY . The \"if\" part is clear. For the \"only if\" part, write Z \u2032 = lim Zi , so we have\n-\u2192 i\n\na canonical map u : Z \u2032 \u2212\n\u2192 Z. As f is flat we have f \u2217 Z \u2032 = lim f \u2217 Zi = f \u2217 Z. As f \u2217\n-\u2192 i\n\nreflects isomorphisms, we see that u is an isomorphism if f \u2217 u is an isomorphism.\nThe claim follows.\nRemark 2.58. Classically, a module M over a ring A is said to be flat if the\nfunctor M \u2297A (\u2212) is exact. It is said to be faithfully flat if in addition, whenever\nM \u2297A L = 0 we have L = 0. It turns out that f is (faithfully) flat if and only if the\nassociated ring map OY \u2212\n\u2192 OX makes OX into a (faithfully) flat module over OY .\nWe leave this as an exercise (consider schemes of the form spec(OX \u2295 L), where L\nis an OX module and the ring structure is such that L.L = 0).\n\nRemark 2.59. The idea of faithful flatness was probably first used in topology\nby Quillen [21]. He observed that if V is a complex vector bundle over a finite\ncomplex Z and F is the bundle of complete flags in V , then the projection map\nFE \u2212\n\u2192 ZE is faithfully flat. This idea was extended and used to great effect in [12].\nWe next define some other useful properties of maps, which do not seem to fit\nanywhere else.\nDefinition 2.60. We say that a map f : X \u2212\n\u2192 Y is very flat if it makes OX\ninto a free module over OY . A very flat map is flat, and even faithfully flat provided\nthat X 6= \u2205.\nDefinition 2.61. We say that a map f : X \u2212\n\u2192 Y is finite if it makes OX into\na finitely generated module over OY .\nRemark 2.62. A flat map f : X \u2212\n\u2192 Y is faithfully flat if and only if the resulting map fzar : Xzar \u2212\n\u2192 Yzar is surjective [18, Theorem 7.3].\nExample 2.63. An open inclusion D(a) \u2212\n\u2192`\nX (where a \u2208 OX ) is always flat.\n\u2192 X is faithfully flat.\nIf a1 , . . . , am \u2208 OX generate the unit ideal then k D(ak ) \u2212\n\nExample 2.64. If D is a divisor on A1 over Y (as in Example 2.10) then\nD\u2212\n\u2192 Y is very flat and thus faithfully flat.\nDefinition 2.65. Given a ring R and an R-algebra S, we write I for the kernel\nof the multiplication map S \u2297R S \u2212\n\u2192 S, and \u03a91S/R = I/I 2 , which is a module over\nS. Given a map of schemes X \u2212\n\u2192 Y , we define \u03a91X/Y = \u03a91OX /OY , which we think\n\n\f18\n\nNEIL P. STRICKLAND\n\nof as a sheaf over X. We say that X is smooth over Y of relative dimension n if\nthe map X \u2212\n\u2192 Y is flat and \u03a91X/Y is a vector bundle of rank n over X (we allow\nthe case n = \u221e). In that case, we write \u03a9kX/Y for the k'th exterior power of \u03a91X/Y\n\u0012\n\u0013\nn\nover OX , which is a vector bundle over X of rank\n.\nk\nRemark 2.66. If X and Y are reduced affine algebraic varieties over C, and\nX is smooth over Y then the preimage of each point y \u2208 Y is a smooth variety of\ndimension independent of y. The converse is probably not true but at least that is\nroughly the right idea. It has nothing to do with the question of whether the map\nX \u2212\n\u2192 Y is a smooth map of manifolds. The latter only makes sense if X and Y\nare both smooth varieties (in other words, smooth over spec(C)), and in that case\nit holds automatically for any algebraic map X \u2212\n\u2192Y.\nThe following two propositions summarise the basic properties of (faithfully)\nflat maps.\nf\n\ng\n\nProposition 2.67. Let X \u2212\n\u2192Y \u2212\n\u2192 Z be maps of schemes. Then:\n(a) If f and g are flat then gf is flat.\n(b) If f and g are faithfully flat then gf is faithfully flat.\n(c) If f is faithfully flat and gf is flat then g is flat.\n(d) If f and gf are faithfully flat then g is faithfully flat.\nProof. All this follows easily from the definitions.\nProposition 2.68. Suppose we have a pullback diagram of schemes\nW\nf\n\ns\ns\ng\ng\n\nwX\n\ng\n\nu\n\nY\nThen:\n(a) If\n(b) If\n(c) If\n(d) If\n\nr\n\ns\n\nu\nw Z.\n\nis flat then r is flat.\nis faithfully flat then r is faithfully flat.\nis faithfully flat and r is flat then s is flat.\nand r are faithfully flat so s is faithfully flat.\nu\n\nProof. Consider the functor f\u2217 : XW \u2212\n\u2192 XY , which sends a scheme U \u2212\n\u2192W\nfu\nover W to the scheme U \u2212\u2192 Y over Y . Colimits in XW are constructed by forming\nthe colimit in X and equipping it with the obvious map to W . This means that\nf\u2217 preserves and reflects colimits, as does g\u2217 . For any scheme V over X, we have\nW \u00d7X V = (Y \u00d7Z X) \u00d7X V = Y \u00d7Z V , or in other words f\u2217 r\u2217 V = s\u2217 g\u2217 V in XY . It\nfollows that if s\u2217 preserves or reflects finite colimits then so does r\u2217 , which gives (a)\nand (b).\nFor part (c), suppose that g is faithfully flat and r is flat. This implies that\nsf = gr is flat. Also, part (b) says that any pullback of a faithfully flat map is\nfaithfully flat, and f is a pullback of g so f is faithfully flat. As sf is flat, part (c)\nof the previous proposition tells us that s is flat, as required. A similar argument\nproves (d).\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n19\n\nProposition 2.69. Let f : X \u2212\n\u2192 Y be a faithfully flat map, and let {Vi } be a\nfinite diagram in XY . If {f \u2217 Vi } has a strong colimit in XX , then {Vi } has a strong\ncolimit in XX . In other words, f \u2217 reflects strong finite colimits.\nProof. Write V = lim Vi . Given a map g : X \u2032 \u2212\n\u2192 X, we need to show that\n-\u2192 i\n\ng \u2217 V = lim g \u2217 Vi . To see this, form the pullback square\n-\u2192 i\n\nY\u2032\ng\u2032\n\nf\u2032\n\nu\n\nY\n\nwX\nu\n\nf\n\n\u2032\ng\n\nw X.\n\nWe know from Proposition 2.68 that f \u2032 is faithfully flat. Because f is flat, we have\nf \u2217 V = lim f \u2217 Vi . By hypothesis, this colimit is strong, so (g \u2032 )\u2217 f \u2217 V = lim (g \u2032 )\u2217 f \u2217 Vi .\n-\u2192 i\n\n-\u2192 i\n\nAs gf \u2032 = f g \u2032 , we have (f \u2032 )\u2217 g \u2217 V = lim (f \u2032 )\u2217 g \u2217 Vi . As f \u2032 is faithfully flat, the functor\n-\u2192 i\n\n(f \u2032 )\u2217 reflects colimits, so g \u2217 V = lim g \u2217 Vi as required.\n-\u2192 i\n\nProposition 2.70. If f : X \u2212\n\u2192 Y is faithfully flat and Y \u2212\n\u2192 Z is arbitrary then\nthe diagram\n\nis a strong coequaliser in XZ .\n\nw X \u2212\u2192 Y\nf\n\nX \u00d7Y X\n\nProof. As f \u2217 : XY \u2212\n\u2192 XX reflects strong coequalisers, it is enough to show\nthat the above diagram becomes a strong coequaliser after applying f \u2217 . Explicitly,\nwe need to show that the following is a strong coequaliser:\nwhere\n\nX \u00d7Y X \u00d7Y X\n\nd0\nd1\n\nwX\u00d7\n\nd\n\nY\n\nX\u2212\n\u2192 X,\n\nd0 (a, b, c) = (b, c)\nd1 (a, b, c) = (a, c)\nd(a, b) = b.\nIn fact, one can check that this is a split coequaliser, with splitting given by the\nmaps\ns\n\nwhere\n\nt\n\nX \u00d7Y X \u00d7Y X \u2190\u2212 X \u00d7Y X \u2190\n\u2212 X,\ns(a, b) = (a, b, b)\nt(a) = (a, a).\n\nAs split coequalisers are preserved by all functors, they are certainly strong coequalisers.\nNow suppose that f : X \u2212\n\u2192 Y is faithfully flat, and that U is a scheme over\nX. We will need to know when U descends to Y , in other words when there is a\nscheme V over Y such that U = V \u00d7Y X. Given a point a \u2208 X(R), we regard a as\na map spec(R) \u2212\n\u2192 X and write Ua for the pullback of U along this map, which is\na scheme over spec(R).\n\n\f20\n\nNEIL P. STRICKLAND\n\nDefinition 2.71. Let f : X \u2212\n\u2192 Y be a map of schemes, and let U be a scheme\nover X. A system of descent data for U consists of a collection of maps \u03b8a,b : Ua \u2212\n\u2192\nUb of schemes over spec(R), for any ring R and any pair of points a, b \u2208 X(R) with\nf (a) = f (b). These maps are required to be natural in (a, b), and to satisfy the\ncocycle conditions \u03b8a,a = 1 and \u03b8a,c = \u03b8b,c \u25e6 \u03b8a,b .\nWe write Xf for the category of pairs (U, \u03b8), where U is a scheme over X and\n\u03b8 is a system of descent data.\nRemark 2.72. The naturality condition for the maps \u03b8a,b just means that they\ngive rise to a map \u03c00\u2217 U \u2212\n\u2192 \u03c01\u2217 U of schemes over X \u00d7Y X.\nRemark 2.73. Note also that the cocycle conditions imply that \u03b8a,b \u25e6 \u03b8b,a = 1,\nso \u03b8a,b is an isomorphism.\nDefinition 2.74. If V is a scheme over Y and f : X \u2212\n\u2192 Y then there is an\nobvious system of descent data for U = f \u2217 V , in which \u03b8a,b is the identity map of\nUa = Vf (a) = Vf (b) = Ub . We can thus consider f \u2217 as a functor XY \u2212\n\u2192 Xf . We say\nthat a system of descent data \u03b8 on U is effective if (U, \u03b8) is equivalent to an object\nin the image of f \u2217 . It is equivalent to say that there is a scheme V over Y and an\nisomorphism \u03c6 : U \u2243 f \u2217 V such that\n\u03c6\n\n\u03c6\u22121\n\nfor all (a, b).\n\n\u2192 Vf (a) = Vf (b) \u2212\u2212\u2192 Ub )\n\u03b8a,b = (Ua \u2212\ng\n\nDefinition 2.75. Given a map f : X \u2212\n\u2192 Y , a scheme U \u2212\n\u2192 X over X, and a\nq\nsystem of descent data \u03b8 for U , we define U \u2212\n\u2192 QU to be the coequaliser of the\nmaps d0 , d1 : U \u00d7Y X \u2212\n\u2192 U defined by\nd0 (u, a) = u\n\nd1 (u, a) = \u03b8g(u),a (u).\nWe note that d0 and d1 have a common splitting s : u 7\u2192 (u, g(u)), so we have a\nreflexive coequaliser. We also note that there is a unique map r : QU \u2212\n\u2192 Y such\nthat rq = f g, so we can think of QU as a scheme over Y .\nProposition 2.76 (Faithfully flat descent). If f : X \u2212\n\u2192 Y is faithfully flat,\nthen the functor f \u2217 : XY \u2212\n\u2192 Xf is an equivalence, with inverse given by Q. Moreover, the coequaliser in XY that defines QU is a strong coequaliser.\nProof. Firstly, it is entirely formal to check that Q is left adjoint to f \u2217 . Next,\nwe claim that Qf \u2217 = 1, or in other words that the projection map f \u2217 V = V \u00d7Y X \u2212\n\u2192\nV is a coequaliser of the maps d0 , d1 : V \u00d7Y X \u00d7Y X \u2212\n\u2192 V \u00d7Y X. Explicitly, we need\nto show that (v, a) 7\u2192 v is the coequaliser of (v, b, a) 7\u2192 (v, b) and (v, b, a) 7\u2192 (v, a).\nThis is just the same as Proposition 2.70. Thus Qf \u2217 = 1 as claimed.\nWe now show that f \u2217 QU = U . As f \u2217 preserves coequalisers, it will be enough\nto show that the\nprojection f \u2217 U = U \u00d7Y X \u2212\n\u2192 U is the coequaliser of the fork\nf \u2217 d0\nU \u00d7Y X \u00d7Y X \u2217 U \u00d7Y X. More explicitly, we need to show that the map (u, a) 7\u2192 u\nf d1\nis the coequaliser of the maps (u, a, b) 7\u2192 (u, b) and (u, a, b) 7\u2192 (\u03b8g(u),a (u), b). In\nfact, it is a split coequaliser, with splitting given by the maps u 7\u2192 (u, g(u)) and\n(u, a) 7\u2192 (u, a, a). Thus, f \u2217 Q = 1 as claimed. We also see that the coequaliser\n\nw\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n21\n\ndefining QU becomes split and thus strong after applying f \u2217 . It follows from\nProposition 2.69 that it was a strong coequaliser in the first place.\n\nXX\n\nCorollary 2.77. If f : X \u2212\n\u2192 Y is faithfully flat, then the functor f \u2217 : XY \u2212\n\u2192\nis faithful.\nWe also have a similar result for sheaves.\n\nDefinition 2.78. Let f : X \u2212\n\u2192 Y be a map of schemes, and let M be a sheaf\nover X. A system of decent data for M consists of a collection of maps \u03b8a,b : Ma \u2212\n\u2192\nMb of R-modules, for every ring R and every pair of points a, b \u2208 X(R) with\nf (a) = f (b). These are supposed to be natural in (a, b) and to satisfy the conditions\n\u03b8a,a = 1 and \u03b8b,c \u25e6 \u03b8a,b = \u03b8a,c . We write Sheavesf for the category of sheaves over X\nequipped with descent data. The pullback functor f \u2217 can be regarded as a functor\nfrom SheavesY to Sheavesf .\nProposition 2.79. If f is faithfully flat, then the functor f \u2217 : SheavesX \u2212\n\u2192\nSheavesf is an equivalence of categories.\nThe proof is similar to that of Proposition 2.76, and is omitted.\nWe shall say that a statement holds locally in the flat topology or fpqc locally if\nit is true after pulling back along a faithfully flat map. (fpqc stands for fid\u00e8lement\nplat et quasi-compact; the compactness condition is automatic for affine schemes).\nSuppose that a certain statement S is true whenever it holds fpqc-locally. We then\nsay that S is an fpqc-local statement.\nRemark 2.80. Let X be a topological space. We say that\nS a statement S holds\nlocally on X if and only`if there is an open covering X = i Ui such that S holds\n\u2192 X is a coproduct of open inclusions and is\non each Ui . Write Y = i Ui , so Y \u2212\nsurjective. We could call such a map an \"disjoint covering map\". We would then\nsay that S holds locally if and only if it holds after pulling back along a disjoint\ncovering map. One can get many analogous concepts varying the class of maps\nin question. For example, we could use covering maps in the ordinary sense. In\nthe category of compact smooth manifolds, we could use submersions. This is the\nconceptual framework in which the above definition is supposed to fit.\nExample 2.81. Suppose that N is a sheaf on Y which vanishes fpqc-locally.\nThis means that there is a faithfully flat map f : X \u2212\n\u2192 Y such that \u0393(X, f \u2217 N ) =\nOX \u2297OY \u0393(Y, N ) = 0. By the classical definition of faithful flatness, this implies\nthat N = 0. In other words, the vanishing of N is an fpqc-local condition.\nExample 2.82. Let N be a sheaf over Y , and let n be an element of \u0393(Y, N )\nthat vanishes fpqc-locally. This means that there is a faithfully flat map f : X \u2212\n\u2192Y\nsuch that the image of n in \u0393(X, f \u2217 N ) = OX \u2297OY \u0393(Y, N ) is zero. Let g be the\nprojection X \u00d7Y X \u2212\n\u2192 Y . One can show that the diagram\nf\u2217\n\n\u0393(Y, N ) \u2212\u2192 \u0393(X, f \u2217 N )\n\nw \u0393(X \u00d7\n\nY\n\nX, g \u2217 N )\n\nis an equaliser. Indeed, it becomes split after tensoring with OX over OY , and\nthat functor reflects equalisers by the classical definition of faithful flatness. In\nparticular, the map marked f \u2217 is injective, so n = 0. Thus, the vanishing of n is\nan fpqc-local condition.\n\n\f22\n\nNEIL P. STRICKLAND\n\nExample 2.83. Suppose that M is a vector bundle of rank r over a scheme\nX. We claim that M is fpqc-locally free of rank r, in other words that there is\na faithfully flat map f : W \u2212\n\u2192 X such that f \u2217 M \u2243 Or . To prove this, choose a\nmatrix A \u2208 Mn (OX ) such that \u0393(X, M ) = A.OnX . If R is a ring and x \u2208 X(R) then\nA(x) \u2208 Mn (R) and Mx = A(x).Rn . Let W (R) be the set of triples (x, P, Q) such\nthat x \u2208 X(R) and P and Q are matrices over R of shape r \u00d7 n and n \u00d7 r such that\ndet(P A(x)Q) is invertible. This is easily seen to be a scheme over X. In fact, it\nis an open subscheme of the scheme of all triples (x, P, Q), which can be identified\nwith A2nr \u00d7 X. It follows that W is flat over X. Moreover, if R is a field then\nelementary linear algebra tells us that the map W (R) \u2212\n\u2192 X(R) is surjective, so\nthat W is faithfully flat over R. If (x, P, Q) is a point of W then A(x)Q : Rr \u2212\n\u2192 Mx\nis a split monomorphism. By comparison of ranks, it is an isomorphism. It follows\nthat M becomes free after pulling back to W .\nExample 2.84. Proposition 2.68 tells us that flatness and faithful flatness are\nthemselves fpqc-local properties.\nExample 2.85. Let M be a vector bundle of rank r over a scheme X, as in\nExample 2.83. Let Bases(M ) be the functor of pairs (x, B) where x is a point of\nX and B : Orx \u2212\n\u2192 Mx is an isomorphism. Note that Bases(M )(R) can be identified\nwith the set of tuples (x, b1 , . . . , br , \u03b21 , . . . , \u03b2r ) such that bi \u2208 Mx and \u03b2j \u2208 Mx\u2228\nand \u03b2j (bi ) = \u03b4ij , so Bases(M ) is a closed subscheme of A(M )rX \u00d7X A(M \u2228 )rX .\nIt is clear that M becomes free after pulling back along the projection\nr\n\nf : Bases(M ) \u2212\n\u2192 X.\n\nIf M = O is free, then Bases(M ) is just the scheme GLr \u00d7X, where GLr is the\nscheme of invertible r \u00d7 r matrices. It's not hard to see that OGLr = Z[xi,j | 0 \u2264\ni, j < r][det(xij )\u22121 ] is torsion-free, and clearly GLr (k) 6= \u2205 for all fields k, and\none can conclude that the map GLr \u2212\n\u2192 1 = spec(Z) is faithfully flat. It follows\nthat Bases(M ) is faithfully flat over X when M is free. Even if M is not free, we\nsee from Example 2.83 that it is fpqc-locally free, so the map Bases(M ) \u2212\n\u2192 X is\nfpqc-locally faithfully flat. As remarked in Example 2.84, faithful flatness is itself\na local condition, so Bases(M ) \u2212\n\u2192 X is faithfully flat.\nExample 2.86. Any monic polynomial f \u2208 R[x] can be factored as a product\nof linear terms, locally in the flat topology. Indeed, suppose\nf=\n\nm\nX\n\n(\u22121)m\u2212k am\u2212k xk\n\n0\n\nwith a0 = 1. It is well known that S = Z[x1 , . . . xm ] is free of rank m! over\nsymmetric function in\nT = S \u03a3m = Z[\u03c31 , . . . \u03c3m ], where \u03c3k is the k'th elementary\nQ k\nthe x's. A basis is given by the monomials x\u03b1 = x\u03b1\nfor\nwhich\n\u03b1k < k. We can\nk\nmap T to R by sending \u03c3k to ak , and then\nobserve\nthat\nU\n=\nS\n\u2297\nT R is free and\nQ\nthus faithfully flat over R. Clearly f (x) = k (x \u2212 xk ) in U [x], as required.\n\nWe conclude this section with some remarks about open mappings. We have\nto make a slightly twisted definition, because in our affine context we do not have\nenough open subschemes. Suppose that f : X \u2212\n\u2192 Y is a map of spaces, and that\nW \u2286 X is closed. We can then define W \u2032 = {y \u2208 Y | f \u22121 y \u2286 W } = f (W c )c .\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n23\n\nClearly f is open iff (W closed implies W \u2032 closed). We will define openness for\nmaps of schemes by analogy with this.\nDefinition 2.87. Let f : X \u2212\n\u2192 Y be a map of schemes. For any closed subscheme W \u2286 X, we define a subfunctor W \u2032 of Y by\nW \u2032 (R) = {y \u2208 Y (R) | Wy = Xy }.\n\nWe say that f is open if for every W , the corresponding subfunctor W \u2032 \u2286 Y is\nactually a closed subscheme.\nProposition 2.88. A very flat map is open.\nProof. Let f : X \u2212\n\u2192 Y be very flat. Write A = OX and B = OY , and choose\na basis A = B{e\u03b1 }. Suppose that W = V (I) is a closed\nP subscheme of X. Let {g\u03b2 }\nbe a system of generators of I, so we can write g\u03b2 = \u03b1 g\u03b2\u03b1 e\u03b1 for suitable elements\ng\u03b1\u03b2 \u2208 A. Consider a point y \u2208 Y (R), corresponding to a map y \u2217 : B \u2212\n\u2192 R. This\nwill lie in W \u2032 (R) iff R \u2297B A = R \u2297B (A/I), iff the imageP\nof I in R \u2297B A = R{e\u03b1 }\nis zero. This image is generated by the elements h\u03b2 = \u03b1 y \u2217 (g\u03b2\u03b1 )e\u03b1 . Thus, it\nvanishes iff y \u2217 (g\u03b2\u03b1 ) = 0 for all \u03b1 and \u03b2. This shows that W \u2032 = V (I \u2032 ), where\nI \u2032 = (g\u03b2\u03b1 ), so W \u2032 is a closed subscheme as required.\n2.8. Schemes of maps.\nDefinition 2.89. Let Z be a functor Rings \u2212\n\u2192 Sets, and let X and Y be\nfunctors over Z. For any ring R, we let MapZ (X, Y )(R) be the class of pairs (z, u),\nwhere z \u2208 Z(R) and u : Xz \u2212\n\u2192 Yz is a map of functors over spec(R). If this is a set\n(rather than a proper class) for all R, then we get a functor MapZ (X, Y ) \u2208 F. This\nis clearly the case whenever X, Y and Z are all schemes. However, the functor\nMapZ (X, Y ) need not itself be a scheme.\nWhen Z = 1 is the terminal scheme we will usually write Map(X, Y ) rather\nthan Map1 (X, Y ).\nRemark 2.90. It is formal to check that\nFZ (W, MapZ (X, Y )) = FZ (W \u00d7Z X, Y ) = FW (W \u00d7Z X, W \u00d7Z Y ).\nIn particular, if X, Y , Z and MapZ (X, Y ) are all schemes then we have\nXZ (W, MapZ (X, Y )) = XZ (W \u00d7Z X, Y ) = XW (W \u00d7Z X, W \u00d7Z Y ).\nExample 2.91. It is not hard to see that maps An \u00d7 spec(R) \u2212\n\u2192 Am \u00d7 spec(R)\nover spec(R) biject with m-tuples of polynomials\nover R in n variables, so Map(An , Am )(R) =\nL\nm\nR[x1 , . . . , xn ] , which is isomorphic to\nn\u2208N R (naturally in R). This functor\nis not a representable (it does not preserve infinite products, for example) so\nMap(An , Am ) is not a scheme. It is a formal scheme, however.\nExample 2.92. Write D(n)(R) = {a \u2208 R | an+1 = 0}, so\nD(n) = spec(Z[x]/xn+1 )\n\nis a scheme. We find that Map(D(n), A1 )(R) = R[x]/xn+1 \u2243\nMap(D(n), A1 ) \u2243 An+1 is a scheme.\n\nQn\n\ni=0\n\nR, so that\n\n\f24\n\nNEIL P. STRICKLAND\n\nExample 2.93. Let E be an even periodic ring spectrum. As \u03a9U (n) is a\ncommutative H-space, we see that E0 (\u03a9U (n)) is a ring, so we can define a scheme\nspec(E0 (\u03a9U (n))). We will see later that there is a canonical isomorphism\nspec(E0 (\u03a9U (n))) \u2243 MapSE ((CP n\u22121 )E , Gm ).\nWe now give a proposition which generalises the last two examples.\nProposition 2.94. Let Z be a scheme and let X and Y be schemes over Z,\nand suppose that X is finite and very flat over Z. Then MapZ (X, Y ) is a scheme.\nProof. Let R be a ring, and z a point of Z(R), giving a map \u1e91 : OZ \u2212\n\u2192 R. We\nneed to produce an algebra B over OZ such that the maps B \u2212\n\u2192 R of OZ -algebras\nbiject with maps Xz \u2212\n\u2192 Yz of schemes over spec(R), or equivalently with maps\n\u2192 R \u2297OZ OX\n\u2192 R \u2297OZ OX of R-algebras, or equivalently with maps OY \u2212\nR \u2297OZ OY \u2212\nof OZ -algebras.\n\u2228\nWrite O\u2228\nX = HomOZ (OX , OZ ) and A = SymOZ [OX \u2297OZ OY ]. Then\nAlgOZ (A, R) = HomOZ (O\u2228\nX \u2297OZ OY , R) = HomOZ (OY , R \u2297OZ OX ).\n\nA suitable quotient B of A will pick out the algebra maps from OY to OW \u2297P\nOZ OX .\nTo be more P\nexplicit, let {e1 , . . . , en } be a basis for OX over OZ , with 1 = i di ei\nand ei ej = k cijk ek . Let {\u01ebi } be the dual basis for O\u2228\nX . Then B is A mod the\nrelations\nX\ncijk (\u01ebi \u2297 a)(\u01ebj \u2297 b)\n\u01ebk \u2297 ab =\ni,j\n\n\u01ebi \u2297 1 = di .\n\nMore abstractly, if we write q for the projection A \u2212\n\u2192 B and j for the inclusion\nO\u2228\n\u2297\nO\n\u2212\n\u2192\nA,\nthen\nB\nis\nthe\nlargest\nquotient\nof\nA\nsuch\nthat the following diagrams\nY\nX\ncommute:\nOY \u2297 OY \u2297 O\u2228\nX\n\n\u03bcY \u22971\n\nwO\n\nY\n\n\u2297 O\u2228\nX\n\nu\n\n1\u2297\u03bc\u2228\nX\n\nO\u2228\nX\n\n\u2228\nOY \u2297 OY \u2297 O\u2228\nX \u2297 OX\n\nu\n\ntwist\n\nqj\n\n\u2228\nOY \u2297 O\u2228\nX \u2297 OY \u2297 OX\nqj\u2297qj\n\nu\n\nB\u2297B\n\n\u03bcB\n\nu\nwB\n\n1\u2297\u03b7\n\n\u03b7\u2228\n\nZ\n\n\u03b7\n\nu\n\nO\u2228\nX \u2297 OY\n\nwO\n\nqj\n\nu\nwB\n\nWe conclude that spec(B) has the defining property of MapZ (X, Y ).\n2.9. Gradings. In this section, we show that graded rings are essentially the\nsame as schemes with an action of the multiplicative group Gm .\nDefinition 2.95. A grading L\nof a ring R is a system of additive subgroups\nRk \u2264 R for k \u2208 Z such that R = k Rk and 1 \u2208 R0 and Rj Rk \u2286 Rj+k for all j, k.\nWe say that a map g : R \u2212\n\u2192 S between graded rings is homogeneous if g(Rk ) \u2286 Sk\nfor all k.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n25\n\nProposition 2.96. Let X be a scheme. Then gradings of OX biject with\nactions of the group scheme Gm on X. Given such actions on X and Y , a map\nf: X \u2212\n\u2192 Y is Gm -equivariant if and only if the corresponding map OY \u2212\n\u2192 OX is\nhomogeneous.\nProof. Given an action of Gm on X, we define (OX )k to be the set of maps\nf: X \u2212\n\u2192 A1 such that f (u.x) = uk f (x) for all rings R and points u \u2208 Gm (R),\nx \u2208 X(R). It is clear\nLthat 1 \u2208 (OX )0 and that (OX )j (OX )k \u2286 (OX )j+k . We need\n\u2192 OGm \u00d7X =\nto check that OX = Pk (OX )k . For this, we consider the map \u03b1\u2217 : OX \u2212\nk), then we find that the fk\nOX [u\u00b11 ]. If \u03b1\u2217 (f ) = k uk fk (so fk = 0 for almost all P\nare the unique functions X \u2212\n\u2192 A1 P\nsuch that f (u.x) = k uk fk (x) for all u and x.\nBy taking u = 1, we see that f = k fk . We also find that\nX\nX\nuk v k fk (x) = f ((uv).x) = f (u.(v.x)) =\nuj v k fkj (x).\nk\n\nj,k\n\n\u00b11\n\n\u00b11\n\nBy working in the universal case R = OX [u , v ] and comparing coefficients, we\nsee\nL that fkj = \u03b4jk fk so that fk \u2208 (OX )k . It follows easily that the addition map\n\u2192 OX is an isomorphism, with inverse f 7\u2192 (fk )k\u2208Z . Thus, we have a\nk (OX )k \u2212\ngrading of OX .\nConversely,\nP suppose we have a grading (OX )\u2217 . We can then write any element\nf \u2208 OX P\nas\nk fk with fk \u2208 (OX )k and fk = 0 for almost all k. We define\n\u2192 OX [u\u00b11 ]. One can\n\u03b1\u2217 (f ) = k uk fk , and check that this gives a ring map OX \u2212\n\u2217\nalso check that \u03b1 = spec(\u03b1 ) : Gm \u00d7X \u2212\n\u2192 X is an action, and that this construction\nis inverse to the previous one.\nExample 2.97. Recall the scheme FGL from Example 2.6. We can let Gm\nact on FGL\nPby (u.F )(x, y) = uF (x/u, y/u); this gives a grading of OFGL . Write\nF (x, y) = i,j aij (F )xi y j , and recall that the elements aij generate OFGL . It is\nP\nclear that (u.F )(x, y) = i,j u1\u2212i\u2212j aij (F )xi y j , so that aij (u.F ) = u1\u2212i\u2212j aij (F ),\nso aij is homogeneous of degree 1 \u2212 i \u2212 j. This is of course the same as the grading\ncoming from the isomorphisms OFGL = \u03c00 M P = \u03c0\u2217 M U , except that all degrees\nare halved.\n3. Non-affine schemes\nLet E be the category of (not necessarily affine) schemes in the classical sense,\nas discussed in [9] for example. In this section we show that E can be embedded as\na full subcategory of F, containing our category X of affine schemes. We show that\nour definition of sheaves over functors gives the right answer for functors coming\nfrom non-affine schemes, and we investigate the schemes Pn from this point of view.\nThis theory is useful in topology when one wants to study elliptic cohomology, for\nexample [11]. The results here are surely known to algebraic geometers, but I do\nnot know a reference.\nGiven a ring A, we write zar(A) for the Zariski spectrum of A, considered as\nan object of E in the usual way. The results of this section will allow us to identify\nzar(A) with spec(A). Of course, in most treatments, spec(A) is defined to be what\nwe call zar(A).\nDefinition 3.1. Given a scheme X \u2208 E, we define a functor F X \u2208 F by\nF X(R) = E(zar(R), X).\n\n\f26\n\nNEIL P. STRICKLAND\n\nIt is well-known that\nE(zar(R), zar(A)) = Rings(A, R),\nso that F (zar(A)) = spec(A).\nProposition 3.2. The functor F : E \u2212\n\u2192 F is full and faithful.\nProof. Let X, Y \u2208 E be schemes; we need to show that the map F : E(X, Y ) \u2212\n\u2192\nF(F X, F Y ) is an isomorphism. First suppose that X is affine, say X = zar(A).\nThen the Yoneda lemma tells us that\nF(F X, F Y ) = F(spec(A), F Y ) = F Y (A) = E(zar(A), Y ) = E(X, Y )\nas required.\nNow let X be an arbitrary scheme. We can cover X by open affine subschemes\nXi , and for each i and j we can cover Xi \u2229 Xj by open affine subschemes Xijk .\nThis gives rise to a diagram as follows.\nQ\nQ\nE(X, Y )\nijk E(Xijk , Y )\ni E(Xi , Y )\nF\n\nF\n\nu\n\nF(F X, F Y )\n\nww\n\nw\n\nv\n\nJ\n\n\u2243\n\nu\nw Q F(F X , F Y )\ni\n\ni\n\nF\n\nww Q\n\nijk\n\nu\n\n\u2243\n\nF(F Xijk , F Y ).\n\nStandard facts about the category E show that the top line is an equaliser. The\naffine case of our proposition shows that the middle and right-hand vertical arrows\nare isomorphisms. If we can prove that the map J is injective, then a diagram chase\nwill show that the left-hand vertical map is an isomorphism, as required.\nSuppose we have two maps f, g : F X \u2212\n\u2192 F Y and that Jf = Jg, or in other\nwords f |F Xi = g|F Xi for all i. We need to show that f = g. Consider a ring R and\nx\na point x \u2208 F X(R), or equivalently a map W = zar(R) \u2212\n\u2192 X. We need to show\nthat f (x) = g(x) as maps from W to Y . We can cover W by open affine subschemes\nWs such that x : Ws \u2212\n\u2192 X factors through Xi for some i. As f |F Xi = g|F Xi , we see\nthat f (x) \u25e6 js = g(x) \u25e6 js , where js : Ws \u2212\n\u2192 W is the inclusion. As the schemes Ws\ncover W , we see that f (x) = g(x) as required.\nProposition 3.3. Let X \u2208 E be a scheme. Then the category of quasicoherent\nsheaves of O-modules over X is equivalent to the category of sheaves over F X.\nProof. Let M be a quasicoherent sheaf of O-modules over X. Consider a\nring R and a point x \u2208 F X(R), corresponding to a map x : zar(R) \u2212\n\u2192 X. We can\npull M back along this map to get a quasicoherent sheaf of O-modules over zar(R),\nwhose global sections form a module G(M )x = \u0393(zar(R), x\u2217 M ) over R. It is not\nhard to see that this construction gives a sheaf GM over the functor F X. If X\nis affine then we know from Proposition 2.47 that sheaves over F X are the same\nas modules over OX , and it is classical that these are the same as quasicoherent\nsheaves of O-modules over X, so the functor G is an equivalence in this case.\nNow let X \u2208 E be an arbitrary scheme, and let N be a sheaf over F X. We can\ncover X by open affine subschemes Xi , and we can cover Xi \u2229 Xj by open affine\nsubschemes Xijk . By the affine case of the proposition, we can identify Ni = N |F Xi\nwith a quasicoherent sheaf Mi of O-modules over Xi . The obvious isomorphism\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n27\n\nNi |F Xijk = Nj |F Xijk gives an isomorphism Mi |Xijk = Mj |Xijk (because our functor\nG is an equivalence for the affine scheme Xijk ). One checks that these isomorphisms\nsatisfy the relevant cocycle condition, so we can glue together the sheaves Mi to\nget a quasicoherent sheaf M over X. One can also check that this construction is\ninverse to our previous one, which implies that G is an equivalence of categories.\nFrom now on we will not usually distinguish between X and F X.\nWe next examine how projective spaces fit into our framework. Let Pn be the\nscheme obtained by gluing together n Q\n+ 1 copies of An in the usual way. In more\nn+1\ndetail, we consider the scheme A\n= ni=0 A1 , and let Ui be the closed subscheme\nwhere xi = 1, so Ui \u2243 An . If j 6= i we let Vij be the open subscheme of Ui where\nxj is invertible. We define \u03c6ij : Vij \u2212\n\u2192 Vji by\n\u03c6ij (x0 , . . . , xn ) = (x0 , . . . , xn )/xj .\n\nWe use these maps to glue the Ui 's together to get a scheme Pn .\nWe define a sheaf Li over Ui by Li,a = Ra \u2264 Rn+1 for a \u2208 Ui (R). Note that\nif \u03c0i : Rn+1 \u2212\n\u2192 R is the i'th projection then \u03c0i induces an isomorphism Li,a \u2212\n\u2192 R,\nso Li,a is a line bundle over Ui . If a \u2208 Vij (R) then it is clear that Li,a = Lj,\u03c6ij (a) .\nIt follows that the bundles Li glue together to give a line bundle L over Pn . From\nthe construction, we see that there is a short exact sequence L \u058c On+1 \u0589 V , in\nwhich V is a vector bundle of rank n. We also write O(k) for the (\u2212k)'th tensor\npower of L, which is again a line bundle over Pn .\nProposition 3.4. For any ring R, we can identify Pn (R) = E(zar(R), Pn ) with\nthe set of submodules M \u2264 Rn+1 such that M is a summand and has rank one.\nThis will be proved after a lemma.\n\nDefinition 3.5. Write Qn (R) for the set of submodules M \u2264 Rn+1 such that\nL is a rank-one projective module and a summand, or equivalently Rn+1 /M is a\nprojective module of rank n. Given a map R \u2212\n\u2192 R\u2032 we have a map Qn (R) \u2212\n\u2192 Qn (R\u2032 )\n\u2032\nn\nsending M to R \u2297R M , which makes Q into a functor.\nWe now define a map \u03b3 : Pn \u2212\n\u2192 Qn , which will turn out to be an isomorphism.\nConsider a ring R and a point x \u2208 Pn (R), corresponding to a map x : spec(R) \u2212\n\u2192 Pn .\nn+1\nBy pulling back the sequence L \u058c O\n\u0589 V and identifying sheaves over spec(R)\nwith R-modules, we get a short exact sequence x\u2217 L \u058c Rn+1 \u0589 x\u2217 V . Here x\u2217 L\nand x\u2217 V are projective, with ranks one and n respectively, so x\u2217 L \u2208 Qn (R). We\ndefine \u03b3(x) = x\u2217 L.\nLemma 3.6. Let W be an affine scheme, and let W1 , . . . , Wm be a finite cover\nof W by basic affine open subschemes Wi = D(ai ). Then there is an equaliser\ndiagram\nY\nY\nF(Wi \u2229 Wj , Qn ).\nF(Wi , Qn )\nF(W, Qn ) \u2212\n\u2192\n\nw\n\ni\n\nij\n\n`\nProof. Write W = i Wi and W = ij Wi \u2229 Wj , so that the evident\nmap f : W \u2032 \u2212\n\u2192 W is faithfully flat and W \u2032\u2032 = W \u2032 \u00d7W W \u2032 . We can thus use\nProposition 2.79 to identify SheavesW with the category Sheavesf of sheaves on W \u2032\nequipped with descent data. It follows that for any sheaf F on W , the subsheaves of\nF biject with subsheaves K \u2264 f \u2217 F that are preserved by the descent data for f \u2217 F .\nThis condition is equivalent to the condition \u03c00\u2217 K = \u03c01\u2217 K \u2264 (f \u03c00 )\u2217 F = (f \u03c01 )\u2217 F .\nNow take F = On+1 , and the lemma follows easily.\n\u2032\n\n`\n\n\u2032\u2032\n\n\f28\n\nNEIL P. STRICKLAND\n\nProof of Proposition 3.4. Suppose we have two points x \u2208 Ui (R) \u2282 Pn (R)\nand y \u2208 Uj (R) \u2282 Pn (R), and that \u03b3(x) = \u03b3(y). It then follows easily from the\ndefinitions that x = y.\nNow suppose we have two points x, y \u2208 Pn (R) such that \u03b3(x) = \u03b3(y). We\nwrite W = spec(R), so x : W \u2212\n\u2192 Pn . We can cover W by basic affine open subsets\nW1 , . . . , Wm with the property that each x(Wk ) is contained in some Ui , and each\ny(Wk ) is contained in some Uj . This implies (by the previous paragraph) that\nx = y as maps Wk \u2212\n\u2192 Pn . We can now deduce from Lemma 3.6 that x = y. Thus,\nn\nn\n\u03b3 : P (R) \u2212\n\u2192 Q (R) is always injective.\nNow consider a point M \u2208 Qn (R), so M is a sheaf over W = spec(R). We claim\nthat we can cover W by basic open subschemes V such that M |V lies in the image\nof \u03b3 : F(V, Pn ) \u2212\n\u2192 F(V, Qn ). Indeed, as M is projective, we can start by covering\nW with basic open subschemes on which M is free. It is easy to see that over such\nu\nv\na subscheme, there exist maps O \u2212\n\u2192 On+1 \u2212\n\u2192 O such that the image ofP\nu is M and\nvu = 1. If we write u and v in terms of bases in the obvious way then i ui vi = 1,\nso the elements ui generate the unit ideal, so the basic open subschemes D(ui ) form\na covering. On D(ui ) we can define x = (u0 , . . . , un )/ui \u2208 Ui , and it is clear that\n\u03b3(x) = M .\nWe can thus choose a basic open covering W = W1 \u222a . . . \u222a Wm and maps\nxk : Wk \u2212\n\u2192 Pn such that \u03b3(xk ) = M |Wk . Let xjk be the restriction of xj to Wjk =\nWj \u2229 Wk . We then have \u03b3(xjk ) = M |Wjk = \u03b3(xkj ) and \u03b3 is injective so xjk = xkj .\nWe also have a diagram\nQ\nQ\nn\nn\nF(W, Pn )\nij F(Wij , P )\ni F(Wi , P )\nv\n\n\u03b3\n\nu\n\nF(W, Qn )\n\nww\n\nw\n\n\u03b3\n\nu\nw Q F(W , Q )\ni\n\ni\n\nn\n\nww Q\n\nij\n\nu\n\n\u03b3\n\nF(Wij , Qn ).\n\nThe top row is unchanged if we replace F by E, and this makes it clear that it is an\nequaliser diagram. The bottom row is an equaliser diagram by Lemma 3.6. We have\nalready\nseen that the vertical maps\nThe elements xi give an element of\nQ are injective.\nQ\nn\nn\nF(W\n,\nQ\n)\nis\nthe\nsame as that of M \u2208 F(W, Qn ).\nF(W\n,\nP\n),\nwhose\nimage\nin\ni\ni\ni\ni\nWe conclude by diagram chasing that there is an element x \u2208 F(W, Pn ) such that\n\u03b3(x) = M . Thus \u03b3 is also surjective, as required.\nDefinition 3.7. Suppose\nthat we have elements a0 , . . . , an \u2208 R, which generP\nate the unit ideal, say i bi ai = 1. Let M be the submodule of Rn+1 generated\nby a = (a0 , . . . , an ). The elements bj define a map Rn+1 \u2212\n\u2192 R which carries L\nisomorphically to R. It follows that M \u2208 Qn (R); the submodules M that occur in\nthis way are precisely those that are free over R. We write [a0 : . . . : an ] for the\ncorresponding point of Pn (R). Most of the time, when working with points of Pn ,\nwe can assume that they have this form, and handle the general case by localising.\nWe finish this section with a useful lemma.\nLemma 3.8. We have [a0 : . . . : an ] = [a\u20320 : . . . : a\u2032n ] if and only if there is a unit\nu \u2208 R\u00d7 such that ua\u2032j = aj for all j, if and only if ai a\u2032j = aj a\u2032i for all i and j.\n\nProof. The first equivalence is clear if we think in terms of Qn (R). For the\nsecond, suppose that ua\u2032j = aj for all j. Then ai a\u2032j = u\u22121 ai aj = a\u2032i aj as required.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n29\n\nConversely, suppose that ai a\u2032j = aj a\u2032i for all i and j. We can choose sequences\nP \u2032 \u2032\nP\nb0 , . .P\n. , bn and b\u20320 , . . .P\n, b\u2032n such that\ni ai bi = 1. Now define\ni ai bi = 1 and\n\u2032 \u2032\n\u2032\nu = i ai bi and v = j aj bj . Then\nX\nX\nb\u2032i a\u2032i aj = aj .\nb\u2032i ai a\u2032j =\nua\u2032j =\ni\n\ni\n\nMoreover, we have\n\nu\n\nX\n\nbj a\u2032j =\n\nj\n\nso u is a unit as required.\n\nX\n\nbj aj = 1,\n\nj\n\n4. Formal schemes\nIn this section we define formal schemes, and set up an extensive categorical\napparatus for dealing with them, and generalise our results for schemes to formal\nschemes as far as possible. We define the subcategory of solid formal schemes, which\nis convenient for some purposes. We also define functors from various categories\nof coalgebras to the category of formal schemes, which are useful technical tools.\nFinally, we study the question of when MapZ (X, Y ) is a formal scheme.\nDefinition 4.1. A formal scheme is a functor X : Rings \u2212\n\u2192 Sets that is a small\nfiltered colimit of schemes. More precisely, there must be a small filtered category\nI and a functor i 7\u2192 Xi from I to X \u2286 F = [Rings, Sets] such that X = lim Xi in\n-\u2192 i\n\nF, or equivalently X(R) = lim Xi (R) for all R. We call such a diagram {Xi } a\n-\u2192 i\n\nb for the category of formal schemes.\npresentation of X. We write X\n\nb 1 defined by A(R)\nb\nExample 4.2. The most basic example is the functor A\n=\nNil(R). This is clearly the colimit over N of the functors D(N ) = spec(Z[x]/xN +1 ).\nb n (R) = Nil(R)n .\nWe also define A\n\nExample 4.3. More generally, given a scheme X and a closed subscheme Y =\nV (I), we define a formal scheme XY\u2227 = lim V (I N ).\n-\u2192 N\n\nExample 4.4. For a common example not of the above type, consider the\nbn\nb (\u221e) (R) = L\nfunctor A\nn\u2208N Nil(R), so X = lim A , which is again a formal scheme.\n-\u2192 n\n\nExample 4.5. If Z is an infinite CW complex and {Z\u03b1 } is the collection of\nfinite subcomplexes and E is an even periodic ring spectrum, we define ZE =\nlim (Z\u03b1 )E . This is clearly a formal scheme.\n-\u2192 \u03b1\n\nWe can connect this with the framework of [8, Section 8] by taking C to be the\ncategory Ringsop . From this point of view, a formal scheme is an ind-representable\ncontravariant functor from Ringsop to Sets. We shall omit any mention of universes here, leaving the set-theoretically cautious reader to lift the necessary details\nfrom [8, Appendice], or to avoid the problem in some other way.\nGiven two filtered diagrams X : I \u2212\n\u2192 X and Y : J \u2212\n\u2192 X we know from [8, 8.2.5.1]\nthat\nb\nX(lim\nXi , lim Yj ) = lim lim X(Xi , Yj ).\n-\u2192\ni\n\n-\u2192\nj\n\n\u2190- -\u2192\ni\nj\n\n\f30\n\nNEIL P. STRICKLAND\n\nb is equivalent to the category whose objects are pairs (I, X) and\nIt follows that X\nwhose morphisms are given by the above formula. We will feel free to use either\nb where convenient.\nmodel for X\n\nif\n\nProposition 4.6. A functor X : Rings \u2212\n\u2192 Sets is a formal scheme if and only\n\n(a) X preserves finite limits, and\n(b) There is a set`of schemes Xi and natural maps Xi \u2212\n\u2192 X such that the\n\u2192 X(R) is surjective for all R.\nresulting map i Xi (R) \u2212\n\nProof. This is essentially [8, Th\u00e9or\u00e8me 8.3.3]. To see this, let D be the\ncategory of schemes over X. A map spec(R) \u2212\n\u2192 X is the same (by Yoneda) as an\nelement of X(R), so Dop is equivalent to the category Points(X). This category\ncorresponds to the category C/F of the cited theorem. Thus, by the equivalence\n(i)\u21d4(iii) of that theorem, we see that X is a formal scheme if and only if X preserves\nfinite limits, and D has a small cofinal subcategory. (Grothendieck actually talks\nabout finite colimits, but in our case that implicitly refers to colimits in Ringsop and\nthus limits in Rings.) It is shown in the proof of the theorem that if X preserves\nfinite limits, then D is a filtered category, so we can use [8, Proposition 8.1.3(c)] to\nrecognise cofinal subcategories. This means that a small collection {Xi } of schemes\nover X gives a cofinal subcategory if and only if each map from a scheme Y to X\nfactors through some Xi . By writing\n`Y = spec(R) and using the Yoneda lemma,\n\u2192 X(R) is surjective for all R.\nit is equivalent to say that the map i Xi (R) \u2212\n4.1. (Co)limits of formal schemes.\n\nb has all small colimits. The inclusion X \u2212\nb\nProposition 4.7. The category X\n\u2192X\nb\npreserves finite colimits, and the inclusion X \u2212\n\u2192 F = [Rings, Sets] preserves filtered\nb\nb \u2212\ncolimits. Moreover, if X \u2208 X then the functor X(X,\n\u2212) : X\n\u2192 Sets also preserves\ncolimits.\nProof. Apart from the last sentence, the proof is the same as that of [14,\nTheorem VI.1.6]. Johnstone assumes that C (which is Ringsop in our case) is small,\nbut he does not really use this. The last sentence is [14, Lemma VI.1.8].\n\nExample 4.8. It is not hard to see that the functor Z 7\u2192 ZE of example 4.5\nconverts filtered homotopy colimits to colimits of formal schemes.\nb For each i \u2208 I\nSuppose we have a diagram of formal schemes X : I \u2212\n\u2192 X.\nwe then have a filtered category J(i) and a functor X(i, \u2212) : J(i) \u2212\n\u2192 X such that\nX(i) = lim\nX(i, j). For many purposes, it is convenient if we can take all the\n-\u2192 J(i)\n\ncategories J(i) to be the same. This motivates the following definition.\nb there\nDefinition 4.9. A category I is rectifiable if for every functor X : I \u2212\n\u2192X\nis a filtered category J and a functor Y : I \u00d7 J \u2212\n\u2192 X such that X(i) = lim Y (i, j)\n-\u2192 J\n\nas functors of i.\n\nProposition 4.10. If I is a finite category such that I(i, i) = {1} for all i \u2208 I,\nthen I is rectifiable.\nProof. See [8, Proposition 8.8.5].\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n31\n\nProposition 4.11. If I is a discrete small category (in other words, a set),\nthen I is rectifiable.\nProof. As X(i) is a formal scheme, there is a filtered category Q\nJ(i) and a\nfunctor Z(i, \u2212) : J(i) \u2212\n\u2192 X such that X(i) = lim\nZ(i, j). Write J = i J(i), let\n-\u2192 J(i)\n\n\u03c0\n\ni\n\u03c0i : J \u2212\n\u2192 J(i) be the projection, and let Y (i, \u2212) be the composite functor J \u2212\u2192\n\nZ(i,\u2212)\n\nJ(i) \u2212\u2212\u2212\u2212\u2192 X. It is easy to check that J is filtered and that \u03c0i is cofinal, so\nX(i) = lim Y (i, j), as required.\n-\u2192 J\n\nb has finite limits, and the inclusions X \u2212\nProposition 4.12. The category X\n\u2192\nb\nb commute with\nX\u2212\n\u2192 F preserve all limits that exist. Moreover, finite limits in X\nfiltered colimits.\nb indexed by a finite rectifiable\nProof. First consider a diagram X : I \u2212\n\u2192 X\ncategory. We define U (R) = lim X(i)(R), which gives a functor Rings \u2212\n\u2192 Sets. It\n\u2190- I\n\nis well-known that this is the inverse limit of the diagram X in the functor category\nF, so it will suffice to show that U is a formal scheme. As I is rectifiable, we\ncan choose a diagram Y : I \u00d7 J \u2212\n\u2192 X as in Definition 4.9. As X has limits, we\nb Then\ncan define Z(j) = lim Y (i, j) \u2208 X, and then define W = lim Z(j) \u2208 X.\n\u2190- i\n\n-\u2192 j\n\nW (R) = lim lim Y (i, j)(R). As filtered colimits commute with finite limits in the\n-\u2192 j \u2190- i\n\ncategory of sets, this is the same as lim lim Y (i, j)(R) = lim X(i)(R) = V (R).\n\u2190- i -\u2192 j\n\n\u2190- i\n\nThus V = W is a formal scheme, as required.\nBoth finite products and equalisers can be considered as limits indexed by\nrectifiable categories, and we can write any finite limit as the equaliser of two maps\nb has finite limits.\nbetween finite products. This shows that X\nNow let {Xi } be a diagram of formal schemes, let X be a formal scheme, and\nb then we must have\nlet {fi : X \u2212\n\u2192 Xi } be a cone. If this is a limit cone in X\nb\nb\nX(R) = X(spec(R),\nX) = lim X(spec(R),\nXi ) = lim Xi (R), which means that it\n\u2190- i\n\n\u2190- i\n\nis a limit cone in F (because limits in functor categories are computed pointwise).\nb\u2212\nThe converse is equally easy, so the inclusion X\n\u2192 F preserves and reflects limits.\nSimilarly, the inclusion X \u2212\n\u2192 F preserves and reflects limits, and it follows that the\nb\nsame is true of the inclusion X \u2212\n\u2192 X.\n4.2. Solid formal schemes.\n\nDefinition 4.13. A linear topology on a ring R is a topology such that the\ncosets of open ideals are open and form a basis of open sets. One can check that\nsuch a topology makes R into a topological ring. We write LRings for the category\nof rings with a given linear topology, and continuous homomorphisms. For any\nring S, the discrete topology is a linear topology on S, so we can think of Rings\nas a full subcategory of LRings. Given a linearly topologised ring R, we define\nspf(R) : Rings \u2212\n\u2192 Sets by\nspf(R)(S) = LRings(R, S) = lim Rings(R/J, S),\n-\u2192\nJ\n\nwhere J runs over the directed set of open ideals. Clearly this defines a functor\nb\nspf : LRingsop \u2212\n\u2192 X.\n\n\f32\n\nNEIL P. STRICKLAND\n\nDefinition 4.14. Let R be a linearly topologised ring. The completion of R\nb = lim R/I, where I runs over the open ideals in R. There is an\nis the ring R\n\u2190- I\n\nb and the composite R \u2212\nb\u2212\nevident map R \u2212\n\u2192 R,\n\u2192R\n\u2192 R/I is surjective so we have\nb for some ideal I \u2264 R.\nb These ideals form a filtered system, so we can\nR/I = R/I\nb the linear topology for which they are a base of neighbourhoods of zero. It\ngive R\nbb\nb and that spf(R)\nb = spf(R). We say that R is complete,\nis easy to check that R\n=R\nb\nb is always a formal ring. We write\nor that it is a formal ring, if R = R. Thus R\nFRings for the category of formal rings.\nb\nDefinition 4.15. Given a formal scheme X, we recall that OX = X(X,\nA1 ).\nThis is again a ring under pointwise operations. If {Xi } is a presentation of X then\nOX = lim OXi .\n\u2190- i\n\nFor any point x of X we define Ix = {f \u2208 OX | f (x) = 0 \u2208 Ox }. From a\nslightly different point of view, we can think of x as a map Y = spec(Ox ) \u2212\n\u2192X\nand Ix as the kernel of the resulting map OX \u2212\n\u2192 OY . As the informal schemes\nover X form a filtered category, we see that the ideals Ix form a directed system.\nThus, there is a unique linear topology on OX , such that the ideals Ix form a base\nof neighbourhoods of zero. With this topology, if {Xi } is a presentation of X, then\nOX = lim OXi as topological rings.\n\u2190- i\n\nNote that\nb i , spf(R)) = lim LRings(R, OX ) = LRings(R, OX ),\nb\nX(X,\nspf(R)) = lim X(X\ni\n\u2190i\n\n\u2190i\n\nb \u2212\nb In particular, we\nso that O : X\n\u2192 LRingsop is left adjoint to spf : LRingsop \u2212\n\u2192 X.\nb\nhave a unit map X \u2212\n\u2192 spf(OX ) in X, and a counit map R \u2212\n\u2192 Ospf(R) in LRings.\nb\nThe latter is just the completion map R \u2212\n\u2192 R.\n\nDefinition 4.16. We say that a formal scheme X is solid if it is isomorphic\nb sol for the category of\nto spf(R) for some linearly topologised ring R. We write X\nsolid formal schemes.\n\nIn the earlier incarnation of this paper [25] we defined formal schemes to be\nwhat we now call solid formal schemes. While only solid formal schemes seem to\noccur in the cases of interest, the category of all formal schemes has rather better\ncategorical properties, so we use it instead.\nExample 4.17. Any informal scheme X is a solid formal scheme (because the\nzero ideal is open).\n\nb n is solid. To see this, consider the formal\nExample 4.18. The formal scheme A\npower series ring R = Z[[x1 , . . . , xn ]], with the usual linear topology defined by the\nb n = spf(R).\nideals I k , where I = (x1 , . . . , xk ). This is clearly a formal ring, and A\n\nExample 4.19. If R is a complete Noetherian semilocal ring with Jacobson\nradical I (for example, a complete Noetherian local ring with maximal ideal I)\nthen it is natural to give R the linear topology defined by the ideals I k , and to\nb\ndefine spf(R) using this. With this convention, the set X(spf(R),\nspf(S)) (where S is\nanother ring of the same type) is just the set of local homomorphisms S \u2212\n\u2192 R. Thus,\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n33\n\nthe categories of formal schemes used in [26] and [7] embed as full subcategories of\nb\nour category X.\n\nExample 4.20. Let Z be an infinite CW complex with finite subcomplexes\n{Z\u03b1 }, and let E be an even periodic ring spectrum. Let J\u03b1 be the kernel of the\nmap E 0 Z \u2212\n\u2192 E 0 Z\u03b1 . These ideals define a linear topology on E 0 Z. In good cases\nE 0 Z will be complete and we will have ZE = spf(E 0 Z), so this is a solid formal\nscheme. See Section 8 for technical results that guarantee this.\nProposition 4.21.\n(a) If X is a solid formal scheme then OX is a formal ring.\n(b) A formal scheme X is solid if and only if it is isomorphic to spf(R) for\nsome formal ring R, if and only if the natural map X \u2212\n\u2192 spf(OX ) is an\nisomorphism.\nb sol in\n(c) The functor X 7\u2192 Xsol = spf(OX ) is left adjoint to the inclusion of X\nb\nX.\nb is left adjoint to the inclusion of FRings in LRings.\n(d) The functor R 7\u2192 R\nb sol\n(e) The functors R 7\u2192 spf(R) and X 7\u2192 OX give an equivalence between X\nop\nand FRings .\n\nProof. (a): If X is solid then X = spf(R) for some linearly topologised ring\nb which is a formal ring.\nR, so OX = Ospf(R) = R\nb so we may\n(b): If X is solid then X = spf(R) as above, but spf(R) = spf(R)\nassume that R is formal. We find as in (a) that OX = R and thus that the map\nX\u2212\n\u2192 spf(OX ) = spf(R) is an isomorphism. The converse is easy.\n(c): Let T denote the functor X 7\u2192 Xsol . This arises from an adjunction,\nso it is a monad. On the other hand, if R = OX then R is formal by (a), so\nR = Ospf(R) = OXsol . By applying spf(\u2212), we see that (Xsol )sol = Xsol , so T 2 = T\nb sol is the subcategory of formal schemes\nand T is an idempotent monad. Moreover, X\nfor which the unit map \u03b7X : X \u2212\n\u2192 T X is an isomorphism. It is well-known that\nthis is automatically a reflective subcategory. In outline, if Y is solid and X is\n\u2192 Y is the unique map such\narbitrary and f : X \u2212\n\u2192 Y , then f \u2032 = \u03b7Y\u22121 \u25e6 T f : Xsol \u2212\n\u2032\nthat f \u25e6 \u03b7X = f .\n(d): The proof is similar.\nb = R. If X is solid then\n(e): If R is formal then spf(R) is solid and Ospf(R) = R\nOX is formal (by (a)) and X = spf(OX ) (by (b)).\n\nDefinition 4.22. Let R, S and T be linearly topologised rings, and let R \u2212\n\u2192S\nand R \u2212\n\u2192 T be continuous homomorphisms. We then give S\u2297R T the linear topology\ndefined by the ideals I \u2297 T + S \u2297 J, where I runs over open ideals in S and J runs\nover open ideals in T . This is easily seen to be the pushout of S and T under R in\nb R T to be the completion of S \u2297R T . If R, S and T are\nLRings. We also define S \u2297\nb\nformal then S \u2297R T is the pushout in FRings (because completion is left adjoint to\nthe inclusion FRings \u2212\n\u2192 LRings).\nb sol \u2286 X\nb is closed under finite products\nProposition 4.23. The subcategory X\nand arbitrary coproducts. It also has its own colimits for arbitrary diagrams, which\nb sol \u2212\nb\nneed not be preserved by the inclusion X\n\u2192 X.\n\n\f34\n\nNEIL P. STRICKLAND\n\nb = spf(R) \u00d7 spf(S), which\nProof. One can check that spf(R \u2297 S) = spf(R\u2297S)\ngivesQfinite products. Let {Ri | i \u2208 I} be a family of formal rings, and write\ntopology, which is the same as the linear\nR = i Ri . We give this ring the product Q\ntopology defined by the ideals of the form ` i Ji , where Ji is open in Ri and Ji = Ri\nfor almost all i. We claim that spf(R) = i spf(R\nQ i ).\nTo see this, let J denote the set ideals J = Qi Ji as above. This is easily seen to\nbe a directed set. For J \u2208 J we see that R/J\n` = i Ri /Ji , where almost all terms in\nthe product are zero. Thus spec(R/J) = i\u2208I spec(Ri /Ji ), where almost all terms\nin the coproduct\nare empty. As colimits commute with coproducts, we see that\n`\nspf(R) = I lim spec(Ri /Ji ). As the projection from J to the set of open ideals in\n-\u2192 J\n`\nRi is cofinal, we see that lim spec(Ri /Ji ) = spf(Ri ), so that spf(R) = I spf(Ri )\n-\u2192 J\n\nas claimed.\nNow let {Xi } be an arbitrary diagram of solid formal schemes, and let X be\nb As the functor Y 7\u2192 Ysol is left adjoint to the inclusion X\nb sol \u2212\nb\nits colimit in X.\n\u2192 X,\nb\nwe see that Xsol is the colimit of our diagram in Xsol .\n\nb sol is actually closed under\nRemark 4.24. We will see in Corollary 4.40 that X\nfinite limits.\nExample 4.25. As a special case of the preceeding proposition, consider an\ninfinite set A. Let R be\n\u2192 Z with the product topology,\n`the ring of functions u : A \u2212\nconstant formal\nso that A = spf(R) = a\u2208A 1. We call formal schemes of this type`\nschemes. More generally, given a formal scheme X we write AX = a\u2208A X. If X is\nsolid then AX = spf(C(A, OX )), where C(A, OX ) is the ring of functions A \u2212\n\u2192 OX ,\nunder the evident product topology. Clearly, if E is an even periodic ring spectrum\nand we regard A as a discrete space then AE = A \u00d7 SE .\n4.3. Formal schemes over a given base. Let X be a formal scheme. Write\nb X for the category of formal schemes over X, and XX for the full subcategory\nX\nof informal schemes over X. We also write Points(X) for the category of pairs\n(R, x), where R is a ring and x \u2208 X(R); the maps are as in Definition 2.14. Again,\nb\nthe Yoneda isomorphism X(R) = X(spec(R),\nX) gives an equivalence Points(X) =\nop\nXX . Moreover, formal schemes Y over X biject with ind-representable functors\nY \u2032 : Points(X) \u2212\n\u2192 Sets by the rules\nY \u2032 (R, x) = preimage of x under the map Y (R) \u2212\n\u2192 X(R)\na\nY \u2032 (R, x).\nY (R) =\nx\u2208X(R)\n\nNow consider a formal scheme X with presentation {Xi }, indexed by a filtered\nb X and\ncategory I. We next investigate the relationship between the categories X\nb\nXXi , which we now define.\nDefinition 4.26. Given a diagram {Xi } as above, we write D{Xi } for the\nb equipped with a map of diagrams {Yi } \u2212\ncategory of diagrams {Yi } : I \u2212\n\u2192X\n\u2192 {Xi }.\nFor any such diagram {Yi } and any map u : i \u2212\n\u2192 j in I, we have a commutative\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n35\n\nsquare\nYi\n\nYu\n\nj\n\nu\n\nXi\n\nwY\n\nXu\n\nu\nwX.\nj\n\nb {X } for the full subcategory of D{X } consisting of diagrams {Yi } for\nWe write X\ni\ni\nwhich all such squares are pullbacks.\nb X and G : X\nbX \u2212\nWe define functors F : D{Xi } \u2212\n\u2192X\n\u2192 D{Xi } by\nF {Yi } = lim Yi\n-\u2192\ni\n\nGY = {Y \u00d7X Xi }.\nProposition 4.27. The functor F is left adjoint to G, and it preserves finite\nb {X } . The functors F\nlimits. The functor G is full and faithful, and its image is X\ni\nb\nb\nand G give an equivalence between XX and X{Xi } .\nb {X } , then any\nMoreover, if W is an informal scheme over X and {Yi } \u2208 X\ni\nfactorisation W \u2212\n\u2192 Xi \u2212\n\u2192 X of the given map W \u2212\n\u2192 X gives an isomorphism\nW \u00d7X F {Yi } = W \u00d7Xi Yi .\nProof. A map F {Yi } \u2212\n\u2192 Z is the same as a compatible system of maps Yi \u2212\n\u2192Z\nover X. As the map Yi \u2212\n\u2192 X has a given factorisation through Xi , this is the same\nas a compatible system of maps Yi \u2212\n\u2192 Z \u00d7X Xi = G(Z)i over Xi , or in other words\na map {Yi } \u2212\n\u2192 G(Z). Thus F is left adjoint to G.\nAs filtered colimits commute with finite limits, we see that F G(Y ) = lim (Y \u00d7X\n-\u2192 i\n\nXi ) = Y \u00d7X lim Xi = Y . This means that\n-\u2192 i\n\nb X (Y, F GZ) = X\nb X (Y, Z),\nD{Xi } (GY, GZ) = X\n\nb X with its image,\nso G is full and faithful. This means that G is an equivalence of X\nb {X } . The commutation of finite\nand it is clear that the image is contained in X\ni\nlimits and filtered colimits also implies that F preserves finite limits.\nWe now prove the last part of the proposition; afterwards we will deduce that\nb {x } . Consider an informal scheme W and a map\nthe image of G is precisely X\ni\nb {X } . Let J be the category of pairs (i, g),\nf: W \u2212\n\u2192 X, and an object {Yi } of X\ni\ng\nwhere i \u2208 I and g : W \u2212\n\u2192 Xi and the composite W \u2212\n\u2192 Xi \u2212\n\u2192 X is the same as f .\nIt is not hard to check that J is filtered and that the projection functor J \u2212\n\u2192 I is\ncofinal. For each (i, g) \u2208 J we have a pullback diagram\nW \u00d7Xi Yi\n\nu\n\nW\n\nwY\n\ni\n\nu\nw X.\ni\n\n\f36\n\nNEIL P. STRICKLAND\n\nBy taking the colimit over J we get a pullback diagram\nlim W \u00d7Xi Yi\n-\u2192\n\nu\n\nw F {Y }\ni\n\nu\nw X.\n\nW\n\nOn the other hand, for each map u : (i, g) \u2212\n\u2192 (j, h) in J we have Yi = Xi \u00d7Xj Yj\nb {X } ) and thus W \u00d7X Yi = W \u00d7X Yj . It follows easily that\n(by the definition of X\nj\ni\ni\n\u2192 lim W \u00d7Xj Yj is an isomorphism, and thus (by\nfor each (i, g) the map W \u00d7Xi Yi \u2212\n-\u2192\n\nthe diagram) that W \u00d7X F {Yi } = W \u00d7Xi Yi .\nNow take W = Xi and g = 1 in the above. We find that Xi \u00d7X F {Yi } = Yi ,\nand thus that F G{Yi } = {Yi }, and thus that {Yi } is in the image of G. This shows\nb {X } , as required.\nthat the image of G is precisely X\ni\n\nDefinition 4.28. Let Y be a formal scheme over a formal scheme X. We say\nthat Y is relatively informal over X if for all informal schemes X \u2032 over X, the\npullback Y \u00d7X X \u2032 is informal.\nProposition 4.29. The category of relatively informal schemes over X has\nbX.\nlimits, which are preserved by the inclusion into X\n\nProof. We can write X as the colimit of a filtered diagram of informal schemes\nXi . It is clear that the category of relatively informal schemes is equivalent to\nb {X } consisting of systems {Yi } of informal schemes. As\nthe subcategory C of X\ni\nthe category of informal schemes has limits, we see that the category of informal\nschemes over Xi has limits. Moreover, for each map Xi \u2212\n\u2192 Xj , the functor Xi \u00d7Xj\n\u2192 XXi preserves limits. Given this, it is easy to check that C has limits,\n(\u2212) : XXj \u2212\nb preserves limits, one can check that the same\nas required. As the inclusion X \u2212\n\u2192X\nb {X } = X\nbX.\nb X and C \u2212\n\u2192X\n\u2192X\nis true of the inclusions XXi \u2212\ni\ni\n4.4. Formal subschemes.\n\nDefinition 4.30. We say that a map f : X \u2212\n\u2192 Y of formal schemes is a closed\nb (This means that it is the equaliser\ninclusion if it is a regular monomorphism in X.\nZ, or equivalently that it is the equaliser of the pair\nof some pair of arrows Y\nY\nY \u2210X Y .) A closed formal subscheme of a formal scheme Y is a subfunctor X\nof Y such that X is a formal scheme and the inclusion X \u2212\n\u2192 Y is a closed inclusion.\n\nw\n\nw\n\nRemark 4.31. The functor Z 7\u2192 Z(R) is representable (by spec(R)). It follows\nb then V (R) \u2212\nthat if f : V \u2212\n\u2192 W is a monomorphism in X\n\u2192 W (R) is injective for all\nR, so V is isomorphic to a subfunctor of W . If f is a regular monomorphism, then\nthe corresponding subfunctor is a closed subscheme.\nExample 4.32. Let J be an ideal in OX , generated by elements {fi | i \u2208 I}\nsay. We define\nV (J)(R) = {x \u2208 X(R) | f (x) = 0 for all f \u2208 J} = {x | fi (x) = 0 for all i}.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n37\n\nQ\nDefine a scheme AI by AI (R) = i\u2208I R (this is represented by the polynomial\nQ\nalgebra Z[xi | i \u2208 I]). This is just the product i\u2208I A1 ; by Proposition 4.12, it\nb It follows that there is a map\ndoes not matter whether we interpret this in X or X.\nI\nf: X \u2212\n\u2192 A with components fi , and another map g : X \u2212\n\u2192 AI with components 0.\nClearly V (J) is the equaliser of f and g, and thus it is a closed formal subscheme of\nX. There is a natural map OX /J \u2212\n\u2192 OV (J) which is an isomorphism in most cases\nof interest, but I suspect that this is not true in general (compare Remark 4.39).\nExample 4.33. If X is an informal scheme and Y is a closed informal subscheme of X then the evident map XY\u2227 \u2212\n\u2192 X is a closed inclusion.\nProposition 4.34. A map f : X \u2212\n\u2192 Y of informal schemes is a closed inclusion\nb if and only if it is a closed inclusion in X.\nin X\nProof. It follows from Proposition 4.7 that the pushout Y \u2210X Y is the same\nb It follows in turn from Proposition 4.12 that the\nwhether constructed in X or X.\nequaliser of the two maps Y\nY \u2210X Y is the same whether constructed in X or\nb The map f is a closed inclusion if and only if X maps isomorphically to this\nX.\nequaliser, so the proposition follows.\n\nw\n\nb and Y \u2208 X, then a map f : X \u2212\nProposition 4.35. If X \u2208 X\n\u2192 Y is a closed\ninclusion if and only if there is a directed set of closed informal subschemes Yi of\nY such that X = lim Yi .\n-\u2192 i\n\nProof. First suppose that f is a closed inclusion. We can write X as a colimit\nof informal schemes, say X = lim Xi . Write Zi = Y \u2210Xi Y . One checks that these\n-\u2192 i\u2208I\n\nschemes give a functor I \u2212\n\u2192 X, and that lim Zi = Y \u2210X Y . Let Yi be the equaliser\n\nw\n\n-\u2192 i\n\nZi , so that Yi is a closed informal subscheme of X, and again\nof the two maps X\nthe schemes Yi give a functor I \u2212\n\u2192 X. As finite limits commute with filtered colimits\nb we see that lim Yi is the equaliser of the maps Y\nlim Zi = Y \u2210X Y . This\nin X,\n\nw\n\n-\u2192 i\n\n-\u2192 i\n\nis just X, because f is assumed to be a regular monomorphism.\nConversely, suppose that {Yi } is a directed family of closed subschemes of an\ninformal scheme Y . Write Zi = Y \u2210Yi Y and Z = lim Zi . By much the same logic\nas above, we see that there is a pair of maps Y\n\nw Z whose equaliser in X = lim Y ,\n-\u2192 i\n\n-\u2192 i\n\nso that X is a closed formal subscheme of Y .\n\ni\n\nb is a closed inclusion if and only if\nProposition 4.36. A map f : X \u2212\n\u2192 Y in X\nfor all informal schemes Y \u2032 and all maps Y \u2032 \u2212\n\u2192 Y , the pulled-back map f \u2032 : X \u2032 \u2212\n\u2192Y\u2032\nis a closed inclusion.\nProof. It is clear that the condition is necessary, because in any category a\npullback of a regular monomorphism is a regular monomorphism. For sufficiency,\nsuppose that f : X \u2212\n\u2192 Y is such that all maps of the form f \u2032 : X \u2032 \u2212\n\u2192 Y \u2032 are closed\ninclusions. Write Y as a colimit of informal schemes Yi in the usual way, and let\nb\nf i : Xi \u2212\n\u2192 Yi be the pullback of f along the map Yi \u2212\n\u2192 Y . As finite limits in X\ncommute with filtered colimits, we see that X = lim Xi . By assumption, fi is a\n-\u2192 i\n\nclosed inclusion. Write Zi = Yi \u2210Xi Yi , so Xi is the equaliser of the fork Yi\n\nwZ.\ni\n\n\f38\n\nNEIL P. STRICKLAND\n\nb commute with filtered colimits, we see that\nWrite Z = lim Zi . As finite limits in X\n\nw Z, and thus that f is a closed inclusion.\n\n-\u2192 i\n\nX is the equaliser of the maps Y\n\nf\n\ng\n\nProposition 4.37. Let X \u2212\n\u2192Y \u2212\n\u2192 Z be maps of formal schemes. If f and g\nare closed inclusions, then so is gf . Conversely, if gf is a closed inclusion and g is\na monomorphism then f is a closed inclusion.\nProof. The second part is a formal statement which holds in any category: if\np\nf\ng\nwe have maps X \u2212\n\u2192Y \u2212\n\u2192 Z such that gf is the equaliser of a pair Z q W , then\nf\na diagram chase shows that X \u2212\n\u2192 Y is the equaliser of pg and qg and thus is a\nregular monomorphism.\nFor the first part, we can assume by Proposition 4.36 that Z is an informal\nscheme. We then know from Proposition 4.35 that there is a filtered system of\nclosed subschemes Zi of Z such that Y is the colimit of the Zi . The maps Y \u2212\n\u2192Z\nand Zi \u2212\n\u2192Y \u2212\n\u2192 Z are closed inclusions, so the second part tells us that Yi \u2212\n\u2192Y\nis a closed monomorphism. Let Xi be the preimage of Zi \u2286 Y under the map\nf: X \u2212\n\u2192 Y . The maps Xi \u2212\n\u2192 Zi and Zi \u2212\n\u2192 Z are closed inclusions of informal\nschemes, so the composite Xi \u2212\n\u2192 Z is easily seen to be a closed inclusion (because\nclosed inclusions in the informal category are just dual to surjections of rings). As\nfiltered colimits commute with pullbacks, we see that X = lim Xi . It follows from\n\nw\n\nProposition 4.35 that X \u2212\n\u2192 Z is a closed inclusion.\n\n-\u2192 i\n\nProposition 4.38. Any closed formal subscheme of a solid formal scheme is\nagain solid.\nf\n\ng\n\nw\n\nProof. Let W \u2212\n\u2192X\nY be an equaliser diagram, and suppose that X is\nh\nsolid. We need to show that W is solid. Choose a presentation Y = lim Yi for\n-\u2192 i\u2208I\n\nY . Let J be the set of tuples j = (J, i, g \u2032 , h\u2032 ), where J is an open ideal in OX and\ni \u2208 I and g \u2032 , h\u2032 : V (J) \u2212\n\u2192 Yi and the following diagram commutes.\nV (J)\n\ng\u2032\n\nh\u2032\n\nww Y\n\ni\n\nv\n\nu\n\nX\n\ng\nh\n\nww Yu\n\nOne can make J into a filtered category so that j 7\u2192 J is a cofinal functor to the\ndirected set of open ideals of OX , and j 7\u2192 i is a cofinal functor to I (see the proof\nof [8, Proposition 8.8.5]). The equaliser of g \u2032 and h\u2032 is a closed subscheme of V (J),\nso it has the form V (Ij ) for some ideal Ij \u2265 J. As equalisers commute with filtered\ncolimits, we see that W = lim V (Ij ). Let K be the set of ideals of the form Ij for\n-\u2192 J\n\nsome j. The functor j 7\u2192 Ij from J to K is cofinal, so we have W = lim\n\n-\u2192 I\u2208K\n\nV (I).\n\nWe can define a new linear topology on R = OX by letting the ideals I \u2208 K be a\nbase of neighbourhoods of zero, and we conclude that W = spf(R). Thus, W is\nsolid.\nRemark 4.39. In the above proof, suppose that Y is also solid, and let K be\nthe ideal in OX generated by elements of the form g \u2217 u \u2212 h\u2217 u with u \u2208 OY . One can\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n39\n\nthen check that OW = lim OX /(K + J), where J runs over the open ideals in OX .\n\u2190- J\nT\nThe kernel of the map \u03c0 : OX \u2212\n\u2192 OW is J (J + K), which is just the closure of K.\nOne would like to say that \u03c0 was surjective, but in fact its cokernel is lim1 (J + K),\n\nwhich can presumably be nonzero.\n\n\u2190- J\n\nb sol \u2286 X\nb of solid formal schemes is closed\nCorollary 4.40. The subcategory X\nunder finite limits.\nProof. We know from Proposition 4.23 that a finite product of solid schemes\nis solid, and a finite limit is a closed formal subscheme of a finite product.\n4.5. Idempotents and formal schemes.\nProposition 4.41. Let`X be a formal scheme. Then systems of formal subschemes Xi such that X\nP= i Xi biject with systems of idempotents ei \u2208 OX such\nthat ei ej = \u03b4ij ei and i ei converges to 1 in the natural topology in OX . More\nexplicitly, we\nP require that for every open ideal J \u2264 OX the set S = {i | ei 6\u2208 J} is\nfinite, and S ei = 1 (mod J).\nQ b\n`\n1\n1\nb\nQ Proof. Suppose that X = i\u2208I Xi . Then OX = X(X, A )`= i X(Xi , A ) =\ni OXi as rings. If K is a finite subset of I, we write XK =\ni\u2208K Xi . We then\nhave X = lim XK , and this is a filtered colimit, so X(R) = lim XK (R) for all\n-\u2192 K\n-\u2192 K\nQ\nR. Using this, it is not hard to check that OX = i OXi as topological rings, where\nthe right hand side is given the product\nQ topology. Note that the product topology\nis defined by the ideals of the form i Ji , where Ji is an open ideal in OXi and\nJi = OXi for almost all i.\nQ\nFor each i there is an evident idempotent ei in OX = i OXi , whose j'th component is \u03b4ij . This gives a system of idempotents as described in the proposition.\nConversely, suppose we start with such a system of idempotents. For any\nidempotent e \u2208 OX it is easy to check that D(e) = V (1 \u2212\n`e), so we can define\nXi = D(ei ) = V (1 \u2212 ei ). We need to check that X = i Xi . We can write\nX = lim Yj for some filtered system of informal schemes Yj . Let eij be the image\n-\u2192 J\n\nof ei in OYj and write Zij = D(eij ) = V (1 \u2212 eij ) \u2286 Yj . As Yj is informal we know\nthat the kernel of the map OX \u2212\n\u2192 OY`\nj is open and thus that eij = 0 for almost all i.\nWe thus have a decomposition Yj = i Zij , in which only finitely many factors are\nnonempty. If we fix i, it is easy to check that the schemes Zij are functors of j,\n` and\nthat lim Zij = Xi . As colimits commute with coproducts, we find that X = i Xi\n-\u2192 j\n\nas claimed.\n\nb or X\nb X are strong.\nCorollary 4.42. Coproducts in X\n\n`\nProof. Let {Yi } be a family of schemes over X, and write Y = i Yi . Let\nZ be another\n` scheme over X, and write Zi = Z \u00d7X Yi . We need to show that\nZ \u00d7X Y = i Zi . To see this, take idempotents ei \u2208 OY as in the proposition,\nso that Yi = D(ei ) = V (1 \u2212 ei ). Let e\u2032i be the image of ei under the evident map\nOZ \u2212\n\u2192 OY ; it is easy to check that Zi = D(e\u2032i ). As the idempotents ei are orthogonal\nand sum to 1 and the map OZ\u00d7X Y \u2212\n\u2192 OY is a continuous map of topological rings,\nwe see that `\nthe e\u2032i are also orthogonal idempotents whose sum is 1. This shows that\nZ \u00d7X Y = i Zi as claimed.\n\n\f40\n\nNEIL P. STRICKLAND\n\n4.6. Sheaves over formal schemes. In Section 2.6, we defined sheaves and\nvector bundles over all functors, and in particular over formal schemes.\nRemark 4.43. If M is a vector bundle and L is a line bundle over a formal\nscheme X, we can define functors A(M )(R) and A(L)\u00d7 (R) just as in Definitions 2.45\nand 2.55. We claim that these are formal schemes. Given a map f : W \u2212\n\u2192 X, it\nis easy to check that f \u2217 A(M ) = A(f \u2217 M ) (where the pullback on the left hand\nside is computed in the functor category F). In particular, if W is informal then\nProposition 2.54 shows that f \u2217 A(M ) is a scheme. Now write X = lim Xi in\n-\u2192 i\n\nthe usual way, and let Mi be the pullback of M over Xi . We find easily that\nA(M ) = lim A(Mi ), so A(M ) is a formal scheme. Similarly, A(L)\u00d7 is a formal\nscheme.\n\n-\u2192 i\n\nRemark 4.44. If M is a sheaf such that Mx is an infinitely generated free\nmodule for all x, we find that A(M ) is a formal scheme over X. Unlike the case\nof a vector bundle, it is not relatively informal over X. We leave the proof as an\nexercise.\nRemark 4.45. Let {Xi } be a presentation of a formal scheme X. If M is a\nsheaf over X then one can check that \u0393(X, M ) = lim \u0393(Xi , M ). In particular,\n\u2190- i\n\nif X is solid and MJ = \u0393(V (J), M ) for all open ideals J \u2264 OX we find that\n\u0393(X, M ) = lim MJ . Moreover, if J \u2264 K we find that MK = MJ /KMJ .\n\u2190- J\n\nIn particular, if N is an OX -module we find that \u0393(X, \u00d1 ) = lim N/JN . We\n\u2190- J\n\nsay that N is complete if N = lim N/JN . It follows that the functor N 7\u2192\n\u2190- J\n\n\u00d1 embeds the category of complete modules as a full subcategory of SheavesX .\nWarning: it seems that the functor N 7\u2192 lim N/JN need not be idempotent in\n\u2190- J\n\nbad cases, so lim N/JN need not be complete.\n\u2190- J\n\nWe next consider the problem of constructing sheaves over filtered colimits.\nDefinition 4.46. Let {Xi } be a filtered diagram of functors, with colimit X.\nLet Sheaves{Xi } denote the category of systems ({Mi }, \u03c6) of the following type:\n(a) For each i we have a sheaf Mi over Xi .\n(b) For each u : i \u2212\n\u2192 j (with associated map Xu : Xi \u2212\n\u2192 Xj ) we have an isomorphism \u03c6(u) : Mi \u2243 Xu\u2217 Mj .\n(c) In the case u = 1 : i \u2212\n\u2192 i we have \u03c6(1) = 1.\nu\nv\n(d) Given i \u2212\n\u2192j\u2212\n\u2192 k we have \u03c6(vu) = (Xu\u2217 \u03c6(v)) \u25e6 \u03c6(u).\nProposition 4.47. Let {Xi | i \u2208 I} be a filtered diagram of functors, with\ncolimit X. The category Sheaves{Xi } is equivalent to SheavesX .\nProof. Given a sheaf M over X, we define a system of sheaves Mi = vi\u2217 M ,\nwhere vi : Xi \u2212\n\u2192 X is the given map. If u : i \u2212\n\u2192 j then vj \u25e6 Xu = vi so we have a\ncanonical identification Mi = Xu\u2217 Mj , which we take as \u03c6(u). This gives an object\nof Sheaves{Xi } .\nOn the other hand, suppose we start with an object {Mi } of Sheaves{Xi } , and\nwe want to construct a sheaf M over X. Given a ring R and a point x \u2208 X(R),\nwe need to define a module Mx over R. As X = lim Xi (R), we can choose i \u2208 I\n-\u2192 i\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n41\n\nand y \u2208 Xi (R) such that vi (y) = x. We would like to define Mx = Mi,y , but we\nneed to check that this is canonically independent of the choices made. We thus\nlet J be the category of all such pairs (i, y). Because X(R) = lim Xi (R), we see\n-\u2192 i\n\nthat J is filtered. For each (i, y) \u2208 J we have an R-module Mi,y , and the maps\n\u03c6(u) make this a functor J \u2212\n\u2192 ModR . We define Mx = lim Mi,y . Because this is\n-\u2192 J\n\na filtered diagram of isomorphisms, each of the canonical maps Mi,y \u2212\n\u2192 Mx is an\nisomorphism. We leave it to the reader to check that this construction produces a\nsheaf, and that it is inverse to our previous construction.\n\nCorollary 4.48. Let X \u2212\n\u2192 Y be a map of formal schemes. To construct a\nsheaf over X, it suffices to construct sheaves over W \u00d7Y X in a sufficiently natural\nway, for all informal schemes W over Y . It also suffices to construct sheaves over\nXy in a sufficiently natural way, for all points y of Y .\nProof. The two claims are really the same, as points of Y biject with informal\ny\nschemes over Y by sending a point y \u2208 Y (R) to the usual map spec(R) \u2212\n\u2192Y.\nFor the first claim, we choose a presentation Y = lim Yi and write Xi =\n-\u2192 i\n\nYi \u00d7Y X, and note that X = lim Xi . By assumption, we have sheaves Mi over Xi .\n-\u2192 i\n\n\"Sufficiently natural\" means that we have maps \u03c6(u) making {Mi } into an object\nof Sheaves{Xi } , so the proposition gives us a sheaf over X.\n4.7. Formal faithful flatness.\nDefinition 4.49. Let f : X \u2212\n\u2192 Y be a map of formal schemes. We say that f\nbY \u2212\nb X preserves finite colimits. We say that\nis flat if the pullback functor f \u2217 : X\n\u2192X\nf is faithfully flat if f \u2217 preserves and reflects finite colimits.\nRemark 4.50. For any map f : X \u2212\n\u2192 Y of formal schemes, we know that f \u2217\npreserves all small coproducts. Thus f is flat if and only if f \u2217 preserves coequalisers,\nif and only if f \u2217 preserves all small colimits.\nDefinition 4.49 could in principle conflict with Definition 2.56; the following\nproposition shows that this is not the case.\nProposition 4.51. A map f : X \u2212\n\u2192 Y of informal schemes is flat (resp. faithfully flat) as a map of informal schemes if and only if it is flat (resp. faithfully flat)\nas a map of formal schemes.\nb preserves finite colimits. Given this,\nProof. Recall that the inclusion X \u2212\n\u2192X\nwe see easily that a map that is formally flat (resp. faithfully flat) flat is also\ninformally flat (resp. faithfully flat).\nNow suppose that f is informally flat. Let U\nV \u2212\n\u2192 W be a coequaliser in\nb Y . By Proposition 4.10, we can find a filtered system of diagrams Ui\nVi (with\nX\nV . We define Wi to be the\nUi and Vi in X) whose colimit is the diagram U\ncoequaliser of Ui\nVi . As colimits commute, we have W = lim Wi . Clearly all\n\nw\n\nw\n\nw\n\nw\n\nw\n\n-\u2192 i\n\nthis can be thought of as happening over W and thus over Y . By assumption, the\ndiagram f \u2217 Ui\nf \u2217 Vi \u2212\n\u2192 f \u2217 Wi is a coequaliser. We now take the colimit over i,\n\u2217\nnoting that f commutes with filtered colimits and that colimits of coequalisers are\nf \u2217V \u2212\n\u2192 f \u2217 W is a coequaliser. Thus, f is\ncoequalisers. This shows that f \u2217 U\nflat.\n\nw\n\n\f42\n\nNEIL P. STRICKLAND\n\nNow suppose that f is informally faithfully flat, and let u : U \u2212\n\u2192 V be a map\nof formal schemes over Y such that f \u2217 u is an isomorphism. Choose a presentation\nV = lim Vi and write Ui = U \u00d7V Vi , so that U = lim Ui . As f \u2217 preserves pullbacks,\n-\u2192 i\n\n-\u2192 i\n\nwe see that the map f \u2217 Ui \u2212\n\u2192 f \u2217 Vi is the pullback of the isomorphism f \u2217 U \u2212\n\u2192 f \u2217V\n\u2217\n\u2217\n\u2217\n\u2217\nalong the map f Vi \u2212\n\u2192 f V , and thus that the map f Ui \u2212\n\u2192 f Vi is itself an\nisomorphism. As f is informally faithfully flat, we conclude that Ui \u2243 Vi . By\npassing to colimits, we see that U \u2243 V as claimed.\n\nRemark 4.52. Propositions 2.67, 2.68, 2.70 and 2.76 are general nonsense,\nvalid in any category with finite limits and colimits. They therefore carry over\ndirectly to formal schemes.\nLemma 4.53. Let f : X \u2212\n\u2192 Y be a map of formal schemes. Let XY be the\nb X be the\ncategory of informal schemes with a map to Y , and let f0\u2217 : XY \u2212\n\u2192 X\n\u2217\n\u2217\nrestriction of f to XY . If f0 preserves coequalisers, then f is flat.\n\nw\n\nProof. Suppose that f0\u2217 preserves coequalisers. Let U\nV \u2212\n\u2192 W be a\nb Y . By Proposition 4.10, we can find a filtered system of diagrams\ncoequaliser in X\nUi\nVi (with Ui and Vi in X) whose colimit is the diagram U\nV . We define\nVi . As colimits commute, we have W = lim Wi .\nWi to be the coequaliser of Ui\n\nw\n\nw\n\nw\n\n-\u2192 i\n\nw\n\nClearly all this can be thought of as happening over W and thus over Y . By\nf \u2217 Vi \u2212\n\u2192 f \u2217 Wi is a coequaliser. We now take the\nassumption, the diagram f \u2217 Ui\n\u2217\ncolimit over i, noting that f commutes with filtered colimits and that colimits of\ncoequalisers are coequalisers. This shows that f \u2217 U\nf \u2217V \u2212\n\u2192 f \u2217 W is a coequaliser.\nThus, f is flat.\n\nw\n\nProposition 4.54. Let f : X \u2212\n\u2192 Y be a map of formal schemes. Suppose that\nY has a presentation Y = lim Yi for which the maps fi : Xi = f \u2217 Yi \u2212\n\u2192 Yi are\n-\u2192 i\n\n(faithfully) flat. Then f is (faithfully) flat.\n\nw\n\nProof. First suppose that each fi is flat. Let U\nV \u2212\n\u2192 W be a coequaliser of\nf \u2217V \u2212\n\u2192\ninformal schemes over Y . By Lemma 4.53, it is enough to check that f \u2217 U\n\u2217\nb\nb\nYi ),\nf W is a coequaliser. We know from Proposition 4.7 that X(W,\nY ) = lim X(W,\n\nw\n\n-\u2192 i\n\nso we can choose a factorisation W \u2212\n\u2192 Yi \u2212\n\u2192 Y of the given map W \u2212\n\u2192 Y , for some\ni. We then have f \u2217 W = W \u00d7Y X = W \u00d7Yi Yi \u00d7Y X = W \u00d7Yi Xi = fi\u2217 W . Similarly,\nwe have f \u2217 V = fi\u2217 V and f \u2217 U = fi\u2217 U . As fi is flat, we see that f \u2217 U\nf \u2217V \u2212\n\u2192 f \u2217W\nis a coequaliser, as required.\nNow suppose that each fi is faithfully flat. Let s : U \u2212\n\u2192 V be a morphism in\nb Y such that f \u2217 s is an isomorphism. We need to show that s is an isomorphism.\nX\nWe have a pullback square of the following form.\n\nw\n\nXi\n\nui\n\nfi\n\ni\n\nu\n\nX\n\nwY\n\nu\nw Y.\n\nvi\n\nf\n\nAs f \u2217 s is an isomorphism, we see that fi\u2217 vi\u2217 s = u\u2217i f \u2217 s is an isomorphism. As fi is\nfaithfully flat, we conclude that vi\u2217 s : vi\u2217 U \u2212\n\u2192 vi\u2217 V is an isomorphism for all i. We\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n43\n\nalso know that U = lim vi\u2217 U and V = lim vi\u2217 V , and it follows easily that s is an\nisomorphism.\n\n-\u2192 i\n\n-\u2192 i\n\nProposition 4.55. Let M be a vector bundle of rank r over a formal scheme\nX. Then there is a faithfully flat map f : Bases(M ) \u2212\n\u2192 X such that f \u2217 M \u2243 Or .\nProof. Let Bases(M )(R) be the set of pairs (x, B), where x \u2208 X(R) and\nB : Rr \u2212\n\u2192 Mx is an isomorphism. Define f : Bases(M ) \u2212\n\u2192 X by f (x, B) = x. As in\nthe informal case (Example 2.85) we see that Bases(M ) is a formal scheme over X,\nand that f \u2217 M \u2243 Or . If Xi is an informal scheme and u : Xi \u2212\n\u2192 X then one checks\nthat u\u2217 Bases(M ) = Bases(u\u2217 M ), which is faithfully flat over Xi by Example 2.85.\nIt follows from Proposition 4.54 that Bases(M ) is faithfully flat over X.\nDefinition 4.56. A map f : X \u2212\n\u2192 Y of formal schemes is very flat if for all\ninformal schemes Y \u2032 over Y , the scheme X \u2032 = f \u2217 Y \u2032 is informal and the map\nX\u2032 \u2212\n\u2192 Y \u2032 is very flat (in other words, OX \u2032 is a free module over OY \u2032 ). Similarly,\nwe say that f is finite if for all such Y \u2032 , the scheme X \u2032 is informal and the map\nX\u2032 \u2212\n\u2192 Y \u2032 is finite.\n4.8. Coalgebraic formal schemes. Fix a scheme Z, and write R = OZ . We\nnext study the category CZ of coalgebras over R, and a certain full subcategory\nb Z , and\nC\u2032Z . It turns out that there is a full and faithful embedding C\u2032Z \u2212\n\u2192 X\nbZ.\nthat the categorical properties of CZ are in some respects superior to those of X\n\u2032\nBecause of this, the categories CZ and CZ are often useful tools for constructing\nb Z with specified properties. Our use of coalgebras was inspired by their\nobjects of X\nappearance in [3], although it is assumed there that R is a field, which removes\nmany technicalities.\nWe will use R and Z as interchangeable subscripts, so\nbR = X\nb Z = {formal schemes over Z},\nX\nfor example. Write MR = MZ and CR = CZ for the categories of modules and coalgebras over R. (All coalgebras will be assumed to be cocommutative and counital.)\nIt is natural to think of CZ as a \"geometric\" category, and we choose our notation to reflect this point of view. In particular, we shall see shortly that CZ has\nfinite products; we shall write them as U \u00d7 V , although they are actually given by\nthe tensor product over R. We also write 1 for the terminal object, which is the\ncoalgebra R with \u03c8R = \u01ebR = 1R .\nThe following result is well-known when R is a field, but we outline a proof to\nshow that nothing goes wrong for more general rings.\nProposition 4.57. The category CZ has finite products, and strong colimits\nfor all small diagrams. The forgetful functor to MZ creates colimits.\nProof. Given two coalgebras U, V , we make U \u2297 V into a coalgebra with\ncounit \u01ebU \u2297 \u01ebV : U \u2297 V \u2212\n\u2192 R and coproduct\n\u03c8U \u2297\u03c8V\n\n1\u2297\u03c4 \u22971\n\nU \u2297 V \u2212\u2212\u2212\u2212\u2212\u2192 U \u2297 U \u2297 V \u2297 V \u2212\u2212\u2212\u2212\u2192 U \u2297 V \u2297 U \u2297 V.\n\nThis is evidently functorial in U and V . There are two projections \u03c0U = 1 \u2297\n\u01ebV : U \u2297 V \u2212\n\u2192 U and \u03c0V = \u01ebU \u2297 1 : U \u2297 V \u2212\n\u2192 V , and one checks that these are\ncoalgebra maps. One also checks that a pair of maps f : W \u2212\n\u2192 U and W \u2212\n\u2192 V yield\na coalgebra map h = (f, g) = (f \u2297 g) \u25e6 \u03c8W : W \u2212\n\u2192 U \u2297 V , and that this is the unique\n\n\f44\n\nNEIL P. STRICKLAND\n\nmap such that \u03c0U \u25e6 h = f and \u03c0V \u25e6 h = g. Thus, U \u2297 V is the categorical product\nof U and V . Similarly, we can make R into a coalgebra with \u03c8R = \u01ebR = 1R , and\nthis makes it a terminal object in CZ .\nNow suppose we have a diagram of coalgebras Ui , and let U = lim Ui denote\n-\u2192 i\n\nthe colimit in MZ . Because tensor products are right exact, we see that U \u2297 U =\nlim Ui \u2297 Uj , so there is an obvious map Ui \u2297 Ui \u2212\n\u2192 U \u2297 U . By composing with\n-\u2192 i,j\n\nthe coproduct on Ui , we get a map Ui \u2212\n\u2192 U \u2297 U . These maps are compatible with\nthe maps of the diagram, so we get a map U = lim Ui \u2212\n\u2192 U \u2297 U . We use this as\n-\u2192 i\n\nthe coproduct on U . The counit maps Ui \u2212\n\u2192 R also fit together to give a counit\nmap U \u2212\n\u2192 R, and this makes U into a coalgebra. One can check that this gives a\ncolimit in the category CZ . Thus, CZ has colimits and they are created in MZ . It\nis clear from the construction that V \u00d7 lim Ui = lim (V \u00d7 Ui ), because tensoring\nwith V is right exact.\n\n-\u2192 i\n\n-\u2192 i\n\nLet f : R \u2212\n\u2192 S = OY be a map of rings, and let Tf : MZ \u2212\n\u2192 MY be the functor\nM 7\u2192 S\u2297R M . This clearly gives a functor CZ \u2212\n\u2192 CY which preserves finite products\nand all colimits.\nWe now introduce a class of coalgebras with better than usual behaviour under\nduality.\nDefinition 4.58. Let U be a coalgebra over R, and suppose that U is free\nas an R-module, say U = R{ei | i \u2208 I}. For any finite set J of indices, we\nwrite UJ = R{ei | i \u2208 J}; if this is a subcoalgebra of U , we call it a standard\nsubcoalgebra. We say that {ei } is a good basis if each finitely generated submodule\nof U is contained in a standard subcoalgebra. We write C\u2032Z for the category of those\ncoalgebras that admit a good basis. It is easy to see that C\u2032Z is closed under finite\nproducts.\nbZ,\nProposition 4.59. There is a full and faithful functor sch = schZ : C\u2032Z \u2212\n\u2192X\nwhich preserves finite products and commutes with base change. Moreover, sch(U )\nis always solid and we have Osch(U) = U \u2228 := HomR (U, R).\nProof. Let U be a coalgebra in C\u2032Z . For each subcoalgebra V \u2264 U such that\nV is a finitely generated free module over R, we define V \u2228 = HomR (V, R). We can\nclearly make this into an R-algebra using the duals of the coproduct and counit\nmaps, so we have a scheme spec(V \u2228 ) over Z. We define sch(U ) = lim spec(V \u2228 ) \u2208\n-\u2192 V\n\nb Z . If we choose a good basis {ei | i \u2208 I}for U then it is clear that the standard\nX\nsubcoalgebras form a cofinal family of V 's, so we have sch(U ) = lim spec(UJ\u2228 ),\n-\u2192 J\n\nwhere J runs over the finite subsets of I for which UJ is a subcoalgebra. This is\nclearly a directed, and thus filtered, colimit. It follows that Osch(U) = lim UJ\u2228 =\n\u2190- J\n\nU \u2228 . The resulting topology on U \u2228 = HomR (U, R) is just the topology of pointwise\nconvergence, where we give R the discrete topology. We can also think of this as\nQ\nI R, and the topology is just the product topology. It is clear from this that\nsch(U ) is solid.\nIf V is another coalgebra with good basis, then the obvious basis for U \u2297R V\nis also good. Moreover, if UJ and VK are standard subcoalgebras of U and V ,\nthen UJ \u2297R VJ is a standard subcoalgebra of U \u2297R V , and the subcoalgebras of\nthis form are cofinal among all standard subcoalgebras of U \u2297R V . It follows easily\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\nthat sch(U \u00d7 V ) = sch(U \u2297R V ) = lim\n\n-\u2192 J,K\n\n45\n\nspec(UJ\u2228 ) \u00d7Z spec(VK\u2228 ). As finite limits\n\nb this is the same as sch(U ) \u00d7Z sch(V ).\ncommute with filtered colimits in X,\nNow consider a map Y = spec(S) \u2212\n\u2192 Z of schemes. The claim is that the\nfunctors schY and schZ commute with base change, in other words that schY (S \u2297R\nU ) = Y \u00d7Z schZ (U ). As pullbacks commute with filtered colimits, the right hand\nside is just lim spec(S \u2297R UJ ), which is the same as the left hand side.\n-\u2192 J\n\nb \u2032 for the image\nDefinition 4.60. Let Z be an informal scheme. We write X\nZ\nb Z . We say that a formal scheme Y is\nof schZ , which is a full subcategory of X\nb \u2032 . We say that Y is finitely coalgebraic over Z if\ncoalgebraic over Z if it lies in X\nZ\nOY is a finitely generated free module over OZ , or equivalently Y is finite and very\nflat over Z; this easily implies that Y is coalgebraic over Z.\nMore generally, let Z be a formal scheme, and Y a formal scheme over Z. We\nsay that Y is (finitely) coalgebraic over Z if for all informal schemes Z \u2032 over Z,\nb \u2032 for the\nthe pullback Z \u2032 \u00d7Z Y is (finitely) coalgebraic over Z \u2032 . We again write X\nZ\ncategory of coalgebraic formal schemes over Z.\nExample 4.61. Let Z be a space such that H\u2217 (Z; Z) is a free Abelian group,\nconcentrated in even degrees. It is not hard to check that E0 Z is a coalgebra over\nE 0 which admits a good basis, and that ZE = schE 0 (E0 Z). Details are given in\nSection 8.\nb \u2032 is an equivalence of categories,\nRemark 4.62. The functor schX : C\u2032X \u2212\n\u2192X\nX\ncts\nwith inverse Y 7\u2192 cY = HomOX (OY , OX ).\nRemark 4.63. For any coalgebra U , we say that an element u \u2208 U is grouplike if \u01eb(u) = 1 and \u03c8(u) = u \u2297 u, or equivalently if the map R \u2212\n\u2192 U defined by\nr 7\u2192 ru is a coalgebra map. We write GL(U ) = CR (R, U ) for the set of group-like\nelements. If U is a finitely generated free module over R, then it is easy to check\nthat GL(U ) = AlgR (U \u2228 , R). From this one can deduce that\nb Z (Y, schZ (U )) = GL(OY \u2297R U ),\nX\n\nwhere we regard OY \u2297R U as a coalgebra over OY . This gives another useful\ncharacterisation of schZ (U ).\nProposition 4.64. Let {Ui } be a diagram in CZ with colimit U , and suppose\nb Z of the\nthat U and Ui actually lie in C\u2032Z . Then sch(U ) is the strong colimit in X\nformal schemes sch(Ui ).\nProof. Note that U = lim Ui as R-modules (because colimits in CZ are cre-\u2192 i\n\nated in MZ ), and it follows immediately that U \u2228 = lim Ui\u2228 as rings. There are ap\u2190- i\n\nparently two possible topologies on U \u2228 . The first is as in the definition of schR (U ),\nwhere the basic neighbourhoods of zero are the submodules ann(M ), where M runs\nover finitely generated submodules of U . The second is the inverse limit topology:\nfor each index i and each finitely generated submodule N of Ui , the preimage of\nthe annihilator of N under the evident map U \u2228 \u2212\n\u2192 Ui\u2228 is a neighbourhood of zero.\nThis is just the same as the annihilator of the image of N in U , and neighbourhoods\n\n\f46\n\nNEIL P. STRICKLAND\n\nof this form give a basis for the inverse limit topology. Given this, it is easy to see\nthat the two topologies in question are the same. We thus have an inverse limit of\ntopological rings. As the category of formal schemes is just dual to the category of\nformal rings, we have a colimit diagram of formal schemes, so sch(U ) = lim sch(Ui ).\n-\u2192 i\n\nWe need to show that the colimit is strong, in other words that for any formal\nscheme T over Z we have T \u00d7Z schZ (U ) = lim (T \u00d7Z schZ (Ui )). First suppose that\n-\u2192 i\n\nT = spec(B) is an informal scheme. We then have T \u00d7Z schZ (U ) = schT (B \u2297R U )\nand similarly for each Ui , and B \u2297R U = lim B \u2297R Ui because tensor products\n-\u2192 i\n\nare right exact. By the first part of the proof (with R replaced by B) we see that\nT \u00d7Z schZ (U ) = lim (T \u00d7Z schZ (Ui )) as required.\n-\u2192 i\n\nIf T is a formal scheme, we write it as a strong filtered colimit of informal\nschemes Tk . The colimit of the isomorphisms Tk \u00d7Z schZ (U ) = lim (Tk \u00d7Z schZ (Ui ))\n-\u2192 i\n\nis the required isomorphism T \u00d7Z schZ (U ) = lim (T \u00d7Z schZ (Ui )).\n-\u2192 i\n\nExample 4.65. If X is coalgebraic over Y we claim that XYn /\u03a3n is a strong\ncolimit for the action of \u03a3n on XYn . To see this, we first suppose that Y is informal\nand X = schY (U ) for some coalgebra U that is free over X with good basis {ei | i \u2208\nI} say. Then XYn = schY (U \u2297n ), and the set of terms ei = ei1 \u2297 . . . \u2297 ein for\ni = (i1 , . . . , in ) \u2208 I n is a good basis for I n . For each orbit j \u2208 I n /\u03a3n , we choose\nan element i of the orbit and let fj be the image of ei in U \u2297n /\u03a3n . We find that\nthe terms fj form a good basis for U \u2297n /\u03a3n , so this coalgebra lies in C\u2032Y . It follows\nfrom Proposition 4.64 that XYn = schY (U \u2297n /\u03a3n ), and that this is a strong colimit.\nFor a general base Y , we choose a presentation Y = lim Yi and write Xi = X \u00d7Y Yi\n-\u2192 i\n\nb {Y } , with\nand Zi = (Xi )nYi /\u03a3n . By what we have just proved, this is an object of X\ni\nn\nlim Zi = XY /\u03a3n . It is now easy to see that this is a strong colimit, using the ideas\n-\u2192 i\n\nof Proposition 4.27.\n\nWe conclude this section with a result about gradings.\nProposition 4.66. Let Y be a coalgebraic formal scheme over an informal\nscheme X, and suppose that X and Y have compatible actions of Gm . Then cY\nhas a natural structure as a graded coalgebra over OX .\nProof. Write R = OX and U = cY . Proposition 2.96 makes R into a graded\n\u2228\nb \u00b11 ], which is the ring\nring. Next, observe that OY = UP\nand OGm \u00d7Y = U \u2228 \u2297Z[t\nk\n\u2192 0 as\nof doubly infinite Laurent series k\u2208Z ak t such that ak \u2208 U \u2228 and ak \u2212\n|k| \u2212\n\u2192 \u221e. Thus, the action \u03b1 : Gm P\n\u00d7Y \u2212\n\u2192 Y gives a continuous homomorphism\nb \u00b11 ], say \u03b1\u2217 (a) = k ak tk . The basic neighbourhoods of zero in\n\u03b1\u2217 : U \u2228 \u2212\n\u2192 U \u2228 \u2297Z[t\n\u2228\nU are the kernels of the maps U \u2228 \u2212\n\u2192 W \u2228 , where W is a standard subcoalgebra\nb \u00b11 ] are the kernels of\nof U . Similarly, the basic neighbourhoods of zero in U \u2228 \u2297Z[t\n\u2228 \u00b11\nthe maps to V [t ], where V is a standard subcoalgebra. Thus, continuity means\nthat for every standard subcoalgebra V \u2264 U , there is a standard subcoalgebra W\nsuch that whenever a(W ) = 0 we have ak (V ) = 0 for all k. In particular, it follows\nthat the mapP\u03c0k : a \u2212\n\u2192 ak is continuous. Just as in the proof of Proposition 2.96,\nwe see that k ak = a and that \u03c0j \u03c0k = \u03b4jk \u03c0k . It follows that U \u2228 is a kind of\ncompleted direct sum of the subgroups image(\u03c0k ). We would like to dualise this\nand thus split U as an honest direct sum.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n47\n\nFirst, we need to show that the maps \u03c0i have a kind of R-linearity.\nLet r be\nP\nri = 0 for\nan element of R, and let ri be the part in degree i, so that r = i ri and P\nalmost all i. Using the compatibility of the actions, we find that (ra)i = j rj ai\u2212j\n(which is really a finite sum).\nSuppose that u \u2208 U . Choose a standard subcoalgebra V containing u, and let\nW be a standard subcoalgebra such that whenever a(W ) = 0 we have ai (V ) = 0\nfor all i.\nSuppose that a \u2208 U \u2228 . It follows from our asymptotic condition\nP on Laurent\nseries that ai (u) = 0 when |i| is large, so we can define \u03c7k (u)(a) = i ai (u)i+k \u2208 R.\nWe then have\nX\n((ra)i (u))i+k\n\u03c7k (u)(ra) =\ni\n\n=\n\nX\n\n(rj ai\u2212j (u))i+k\n\ni,j\n\n=\n\nX\n\nrj (ai\u2212j (u))i+k\u2212j\n\ni,j\n\n=\n\nX\n\nrj am (u)m+k\n\nm,j\n\n= r\u03c7k (u)(a).\nThus, the map \u03c7j (u) : U \u2228 \u2212\n\u2192 R is R-linear. Clearly, if a(W ) = 0 then \u03c7j (u)(a) = 0,\nso \u03c7j (u) can be regarded as an element of (U \u2228 /ann(W ))\u2228 = W \u2228\u2228 = W (because\nW is a finitely generated free module). More precisely, there is a unique element\nuj \u2208 U such that \u03c7j (u)(a) = a(uj ) for all a, and in fact uj \u2208 W .\nNext, we choose a finite set of elements in U \u2228 which project to a basis for W \u2228 .\nWe can then choose a number N such that bi (u) = 0 whenever b lies in that set and\n|i| > N . Because aj (u) = 0 for all j whenever a(W ) = 0, we conclude that ai (u) = 0\nfor all a \u2208 U \u2228 and all i such that |i| > N . It follows\nthat ui =P0 when |i| > N\nP. This\nP\njustifies the following manipulation: a(u) = i,j ai (u)j = j a(uj ) = a( j uj ).\nP\n\u2192 U by \u03c6i (u) = ui , and\nWe conclude that u = j uj . We define a map \u03c6i : U \u2212\nwe define L\nUi = image(\u03c6i ). We leave it to the reader to check that \u03c6i \u03c6j = \u03b4ij \u03c6j , so\nthat U = i Ui , and that this grading is compatible with the R-module structure\nand the coalgebra structure.\n4.9. More mapping schemes. Recall the functor MapZ (X, Y ) , given in\nDefinition 2.89. We now prove some more results which tell us when MapZ (X, Y )\nis a scheme or a formal scheme.\nFirst, note that for any functor W over Z, we have\nFZ (W, MapZ (X, Y )) = FZ (W \u00d7Z X, Y ) = FW (W \u00d7Z X, W \u00d7Z Y ).\nIndeed, if W is informal then this follows from the definitions and the Yoneda\nlemma, by writing W in the form spec(R). The general case follows from this\nby taking limits, because every functor is the colimit of a (not necessarily small\nor filtered) diagram of representable functors. It is also not hard to give a direct\nproof.\nConversely, suppose we have a functor M over Z and a natural isomorphism\nFZ (W, M ) \u2243 FZ (W \u00d7Z X, Y ) for all informal schemes W over Z. It is then easy\nto identify M with MapZ (X, Y ).\n\n\f48\n\nNEIL P. STRICKLAND\n\nLemma 4.67. Let X and Y be functors over Z, and suppose that X and Z are\nformal schemes. Then MapZ (X, Y )(R) is a set for all R, so the functor MapZ (X, Y )\nexists.\nProof. We have only a set of elements z \u2208 Z(R), so it suffices to check that\nfor any such z there is only a set of maps Xz \u2212\n\u2192 Yz of functors over spec(R). Here\nXz is a formal scheme, with presentation {W\nQi } say. Clearly F(Wi , Yz ) = Yz (OWi )\nis a set, and Fspec(R) (Xz , Yz ) is a subset of i F(Wi , Yz ).\nRecall also from Proposition 2.94 that MapZ (X, Y ) is a scheme when X, Y\nand Z are all informal schemes, and X is finite and very flat over Z.\n\nDefinition 4.68. We say that a formal scheme Y over Z is of finite presentab Z of the form\ntion if there is an equaliser diagram in X\nY \u2212\n\u2192 An \u00d7 Z\n\nwA\n\nm\n\n\u00d7 Z.\n\nTheorem 4.69. Let X and Y be formal schemes over Z. Then MapZ (X, Y )\nis a formal scheme if\n(a) X is coalgebraic over Z and Y is relatively informal over Z, or\n(b) X is finite and very flat over Z, or\n(c) X is very flat over Z and Y is of finite presentation over Z.\nThis will be proved at the end of the section, after some auxiliary results.\nLemma 4.70. If Z \u2032 is a functor over Z then MapZ \u2032 (X \u00d7Z Z \u2032 , Y \u00d7Z Z \u2032 ) =\nMapZ (X, Y ) \u00d7Z Z \u2032 .\nProof. If W is a scheme over Z \u2032 then\nFZ \u2032 (W, MapZ (X, Y ) \u00d7Z Z \u2032 ) = FZ (W, MapZ (X, Y ))\n= FZ (W \u00d7Z X, Y )\n\n= FZ \u2032 (W \u00d7Z X, Y \u00d7Z Z \u2032 )\n\n= FZ \u2032 (W \u00d7Z \u2032 (X \u00d7Z Z \u2032 ), Y \u00d7Z Z \u2032 ).\n\nThus, MapZ (X, Y ) \u00d7Z Z \u2032 has the required universal property.\nLemma 4.71. If X is a strong colimit of formal schemes Xi and MapZ (Xi , Y )\nis a formal scheme and is relatively informal over Z for all i then MapZ (X, Y )\nis a formal scheme and is equal to lim MapZ (Xi , Y ) (where the inverse limit is\n\u2190- i\n\nb Z ).\ncomputed in X\n\nNote that coproducts and filtered colimits are always strong, so the lemma\napplies in those cases.\n\nProof. Because MapZ (Xi , Y ) is relatively informal, Proposition 4.29 allows\nb Z . If W is a formal scheme over Z then\nus to form the limit lim MapZ (Xi , Y ) in X\n\u2190- i\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n49\n\nwe have\nb Z (W, Map (Xi , Y ))\nb Z (W, lim Map (Xi , Y )) = lim X\nX\nZ\nZ\n\u2190i\n\n\u2190i\n\nb Z (W \u00d7Z Xi , Y )\n= lim X\n\u2190i\n\nb Z (lim W \u00d7Z Xi , Y )\n=X\n-\u2192\ni\n\nb Z (W \u00d7Z X, Y ).\n=X\n\nThis proves that lim MapZ (Xi , Y ) = MapZ (X, Y ) as required.\n\u2190- i\n\nWe leave the next lemma to the reader.\nLemma 4.72. Suppose that Y is an inverse limit of a finite diagram of formal schemes {Yi } over Z. Then MapZ (X, Y ) = lim MapZ (X, Yi ), where the\n\u2190- i\n\nlimit is computed in FZ . Thus, if MapZ (X, Yi ) is a formal scheme for all i, then\nMapZ (X, Y ) is a formal scheme.\n\nLemma 4.73. Let {Zi } be a filtered system of informal schemes with colimit\nZ. Let X and Y be formal schemes over Z, with Xi = X \u00d7Z Zi and Yi = Y \u00d7Z Zi .\nIf MapZi (Xi , Yi ) is a formal scheme for all i then MapZ (X, Y ) is a formal scheme\nand is equal to lim MapZi (Xi , Yi ).\n-\u2192 i\n\nProof. Lemma 4.70 tells us that the system of formal schemes\nMi = MapZi (Xi , Yi )\nb {Z } of Proposition 4.27. Thus, if we define\ndefines an object of the category X\ni\nb\nM = lim Mi we find that XZ (W, M ) is the set of maps of diagrams {W \u00d7Z Zi } \u2212\n\u2192\n-\u2192 i\n\n{Mi } over {Zi }. This is the same as the set of maps of diagrams {W \u00d7Z Xi } =\n\u2192 {Yi } over {Zi }. By the adjunction in Proposition 4.27, this\n{W \u00d7Z Zi \u00d7Zi Xi } \u2212\nis the same as the set of maps W \u00d7Z X = lim W \u00d7Z Xi \u2212\n\u2192 Y over Z. Thus, M\nhas the defining property of MapZ (X, Y ).\n\n-\u2192 i\n\nLemma 4.74. Let X be relatively informal over Z, and let {Yi } be a filtered\nsystem of formal schemes over Z with colimit Y . If MapZ (X, Yi ) is a formal scheme\nfor all i, then MapZ (X, Y ) is a formal scheme and is equal to lim MapZ (X, Yi ).\n-\u2192 i\n\nProof. Write M = lim MapZ (X, Yi ). Let W be an informal scheme over Z.\n-\u2192 i\n\nAs X is relatively informal, we see that W \u00d7Z X is informal. It follows that the\nb Z (W, \u2212) and X\nb Z (W \u00d7Z X, \u2212) preserve filtered colimits. We thus have\nfunctors X\nb Z (W, Map (X, Yi ))\nb Z (W, M ) = lim X\nX\n-\u2192\ni\n\nZ\n\nb Z (W \u00d7Z X, Yi )\n= lim X\n-\u2192\ni\n\nb Z (W \u00d7Z X, lim Yi )\n=X\n-\u2192\ni\n\nb Z (W \u00d7Z X, Y ),\n=X\n\n\f50\n\nNEIL P. STRICKLAND\n\nas required.\nLemma 4.75. If X and Z are informal and X is very flat over Z then the\nfunctor MapZ (X, A1 \u00d7 Z) is a formal scheme.\nProof. We can choose a basis for OX over OZ and thus write OX as a filtered\ncolimit of finitely generated free modules Mi over OZ . From the definitions we\nsee that MapZ (X, A1 )(R) is the set of pairs (x, u), where x \u2208 X(R) (making R\ninto an OX -algebra) and u is a map R[t] \u2212\n\u2192 R \u2297OZ OX of R-algebras. This is of\ncourse equivalent to an element of R \u2297OZ OX = lim R \u2297OZ Mi . Thus, we see that\n-\u2192 i\n\nMapZ (X, A1 \u00d7 Z) = lim A(Mi ), which is a formal scheme.\n-\u2192 i\n\nProof of Theorem 4.69. We shall prove successively that MapZ (X, Y ) is a\nformal scheme under any of the following hypotheses. Cases (3), (5) and (7) give\nthe results claimed in the theorem.\n(1) X, Y and Z are informal, and X is finite and very flat. In this case\nMapZ (X, Y ) is informal.\n(2) Y is informal, and X is finite and very flat. In this case MapZ (X, Y ) is\nrelatively informal.\n(3) X is finite and very flat.\n(4) Y and Z are informal, and X is coalgebraic. In this case, MapZ (X, Y ) is\ninformal.\n(5) Y is relatively informal, and X is coalgebraic. In this case, MapZ (X, Y ) is\nrelatively informal.\n(6) X and Z are informal, X is very flat, and Y is of finite presentation.\n(7) X is very flat and Y is of finite presentation.\nProposition 2.94 gives case (1). For case (2), write Z = lim Zi in the usual way.\n-\u2192 i\n\nThen case (1) tells us that MapZi (X \u00d7Z Zi , Y \u00d7Z Zi ) is an informal scheme. Using\nthis and Lemma 4.73, we see that MapZ (X, Y ) is a formal scheme. Using case (1)\nand Lemma 4.70 we see that MapZ (X, Y ) is relatively informal. In case (3), we write\nY as a filtered colimit of informal schemes Yj . Case (2) tells us that MapZ (X, Yj )\nis a relatively informal scheme, so Lemma 4.74 tells us that MapZ (X, Y ) is a formal\nscheme. In case (4), it follows easily from the definitions that X can be written as\nthe filtered colimit of a system of finite, very flat schemes Xi . It then follows from\ncase (1) that MapZ (Xi , Y ) is an informal scheme. Using Lemma 4.71 we see that\nMapZ (X, Y ) = lim MapZ (Xi , Y ). This is an inverse limit of informal schemes,\n\u2190- i\n\nand thus is an informal scheme. We deduce (5) from (4) in the same way that we\ndeduced (2) from (1). Case (6) follows easily from Lemmas 4.75 and 4.72. Again,\nthe argument for (1)\u21d2(2) also gives (6)\u21d2(7).\n5. Formal curves\nIn this section, we define formal curves. We also study divisors, differentials,\nand meromorphic functions on such curves.\nLet X be a formal scheme, and let C be a formal scheme over X. We say that\nb X to A\nb 1 \u00d7 X. (In some sense,\nC is a formal curve over X if it is isomorphic in X\nb1 \u00d7 X\nit would be better to allow formal schemes that are only isomorphic to A\nfpqc-locally on X, but this seems unnecessary for the topological applications so\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n51\n\nb 1 giving rise to an isomorphism\nwe omit it.) A coordinate on C is a map x : C \u2212\n\u2192A\nb 1 \u00d7 X.\nC\u2243A\n\nExample 5.1. If E is an even periodic ring spectrum then (CP \u221e )E and (HP \u221e )E\nare formal curves over SE .\n5.1. Divisors on formal curves. Let C be a formal curve over X, and let\nD be a closed subscheme of X. If X is informal, we say that D is a effective divisor\nof degree n on C if D is informal, and OD is a free module of rank n over OX . If\nX is a general formal scheme, we say that D is a divisor if D \u00d7X X \u2032 is a divisor on\nC \u00d7X X \u2032 , for all informal schemes X \u2032 over X. If Y is a formal scheme over X, we\nrefer to divisors on C \u00d7X Y as divisors on C over Y .\n\nProposition 5.2. There is a formal scheme Div+\nn (C) over X such that maps\n+\nY \u2212\n\u2192 Divn (C) over X biject with effective divisors of degree n on C over Y .\nMoreover, a choice of coordinate on C gives rise to an isomorphism Div+\nn (C) \u2243\nb n \u00d7 X.\nA\nProof. This is much the same as Example 2.10. We define\n\nDiv+\nn (C)(R) =\n\n{(a, D) | a \u2208 X(R) and D is an effective divisor of degree n on Ca }.\n\nWe make this a functor by pullback, just as in Example 2.10. To see that Div+\nn (C)\nis a formal scheme, choose a coordinate x on C. Given a point (a, D) as above,\nwe find that Ca = C \u00d7X spec(R) = spf(R[[x]]), where the topology on R[[x]] is\ndefined by the ideals (xk ). We know that D is a closed subscheme of Ca , and\nthat D is informal. It follows that D = spec(R[[x]]/J) for some ideal J such that\nxk \u2208 J for some k. Let P\n\u03bb(x) be the endomorphism of OD given by multiplication\nn\nn\u2212i\nby x, and let fD (t) =\nbe the characteristic polynomial of \u03bb(x).\ni=0 ai (D)t\nk\nk\nAs x \u2208 J, we see that \u03bb(x) = 0. If R is a field, then we deduce by elementary\nlinear algebra that fD (t) = tn . If p is a prime ideal in R then by considering\nthe divisor spec(\u03ba(p)) \u00d7spec(R) D, we conclude that fD (t) = tn (mod p[t]). Using\nProposition 2.37, we deduce that ai (D) \u2208 Nil(R) for i > 0. Thus, the ai 's give a\nb n \u00d7 X. As in Example 2.10, the Cayley-Hamilton theorem tells\nmap Div+\n\u2192A\nn (C) \u2212\nus that fD (x) \u2208 J and thus that OD = R[x]/fD (x) = R[[x]]/fD (x).\nConversely, suppose we have\nP elements b0 , . . . , bn with b0 = 1 and bi \u2208 Nil(R)\nfor i > 0Pand we define g(t) = i bi tn\u2212i and D = spf(R[[x]]/g(x)). In OD we have\nxn = \u2212 i>0 bi xn\u2212i , which is nilpotent, so x is nilpotent, so (g(x)) is open in R[[x]].\nThis means that D is informal and that OD = R[x]/g(x), which is easily seen to be\na free module of rank n over R. Thus, D is an effective divisor of rank n on Ca . We\nbn\nconclude that Div+\nn (C) is isomorphic to A , and in particular is a formal scheme.\nIf Y is an arbitrary formal scheme over X, we can choose a presentation Y =\nlim Yi , so Yi is an informal scheme over X. The above tells us that maps Yi \u2212\n\u2192\n-\u2192 i\n\nDiv+\nn (C) over X biject with effective divisors of degree n on C over Yi . Thus, maps\nY \u2212\n\u2192 Div+\nn (C) over X biject with systems of divisors Di over Yi , such that for each\nmap Yi \u2212\n\u2192 Yj we have Di = Dj \u00d7Yj Yi . Using Proposition 4.27, we see that these\nbiject with effective divisors of degree n on C over Y .\nExample 5.3. It is essentially well-known that BU (n)E = Div+\nn (GE ), where\nGE = (CP \u221e )E . A proof will be given in Section 8.\n\n\f52\n\nNEIL P. STRICKLAND\n\nRemark 5.4. It is not hard to check that for any map Y \u2212\n\u2192 X of formal\nschemes and any formal curve C over X we have Div+\n(C\n\u00d7\nY\n)\n=\nDiv+\nX\nn\nn (C) \u00d7X Y\nb\n(because both sides represent the same functor XY \u2212\n\u2192 Sets).\n\nDefinition 5.5. Let D be an effective divisor on a curve C over X. We shall\ndefine an associated line bundle J(D) over C. By Corollary 4.48, it is enough to\ndo this in a sufficiently natural way when X is an informal scheme. In that case we\nhave OD = OC /J(D) for some ideal J(D) in OC . In terms of a coordinate x, we see\nfrom the proof of Proposition 5.2 that J(D) is generated by a monic polynomial\nf (x) whose lower coefficients are nilpotent. Thus f (x) = xn \u2212 g(x) where g(x)k = 0\nsay. If f h = 0 then xnk h = g k h = 0 so h = 0, so f is not a zero-divisor and J(D)\nis free of rank one over OC . Thus, J(D) can be regarded as a line bundle over C\nas required (using Remark 4.45).\n\nProposition 5.6. There is a natural commutative and associative addition\n+\n\u03c3 : Div+\n\u2192 Div+\nj (C) \u00d7X Divk (C) \u2212\nj+k (C), such that J(D + E) = J(D) \u2297 J(E).\nProof. Let a : spec(R) \u2212\n\u2192 X be an element of X(R), and let D and E be\neffective divisors of degrees j and k on Ca over spec(R). We then have D =\nV (J(D)) and E = V (J(E)) where J(D) and J(E) are ideals in OCa . We define\nF = V (J(D)J(E)). If we choose a coordinate x on C we find (as in the proof\nof Proposition 5.2) that J(D) = (fD (x)) and J(E) = (fE (x)), where fD and fE\nare monic polynomials whose lower coefficients are nilpotent. This means that\ng = fD fE is a polynomial of the same type, and it follows that F = V (g) is a\ndivisor of degree j + k as required. We define \u03c3(D, E) = D + E = F . It is clear\nfrom the construction that J(D + E) = J(D) \u2297 J(E).\nProposition 5.7. Let C be a formal curve over a formal scheme X. Then\nn\nDiv+\nn (C) = CX /\u03a3n , and this is a strong colimit. Moreover, the quotient map\nn\nn\nCX \u2212\n\u2192 CX /\u03a3n is faithfully flat.\nProof. First consider the case n = 1. Fix a ring R and a point a \u2208 X(R),\nand write Ca = C \u00d7X spec(R), which is a formal curve over Y = spec(R). A point\nc \u2208 C lying over a is the same as a section of the projection Ca \u2212\n\u2192 Y . Such a\nsection is a split monomorphism, and thus a closed inclusion; we write [c] for its\nimage, which is a closed formal subscheme of Ca . The projection Ca \u2212\n\u2192 Y carries\n[c] isomorphically to Y , which shows that [c] is an effective divisor of degree 1 on C\nover Y . Thus, this construction gives a map C \u2212\n\u2192 Div+\n1 (C). If x is a coordinate on\nC then it is easy to see that x(c) \u2208 Nil(R) and [c] = spf(R[[x]]/(x \u2212 x(c))). Using\nthis, we see easily that our map is an isomorphism, giving the case n = 1 of the\nProposition.\nn\nn\nWe now use the iterated addition map CX\n= Div+\n\u2192 Div+\nn (C) to get a\n1 (C)X \u2212\nn\nmap CX\n/\u03a3n \u2212\n\u2192 Div+\nn (C).\nb 1 \u00d7 X, it is easy to see that C is coalgebraic over X and\nNext, because C \u2243 A\nn\nthus (by Example 4.65) that CX\n/\u03a3n is a strong colimit. Given this, we can reduce\neasily to the case where X is informal, say X = spec(R). Choose a coordinate\nn =\nx on C. This gives isomorphisms ODiv+\n= R[[a1 , . . . , an ]] = S and OCX\nn (C)\n\u03a3n\nn\n\u2192 T \u03a3n\nR[[x1 , . . . , xn ]] = T and OCX /\u03a3n = T . The claim is thus that the map S \u2212\n\u03a3n\n\u03a3n\nis an isomorphism, and that T is faithfully flat over T . The map S \u2212\n\u2192T\nsends\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n53\n\nQ\nai to the coefficient of xn\u2212i in j (x \u2212 xj ), which is (up to sign) the i'th elementary\nsymmetric function of the variables xj . It is thus a well-known theorem of Newton\nQn\nd\nthat S = T \u03a3n . It is also well-known that the elements of the form j=1 xj j with\n\u03a3n\n0 \u2264 dj < j form a basis for T over T , so that T is indeed faithfully flat over\nT \u03a3n .\nWe next consider pointed curves, in other words curves C equipped with a\n0\nspecified \"zero-section\" 0 : X \u2212\n\u2192 C such that the composite X \u2212\n\u2192C \u2212\n\u2192 X is the\nidentity. If C is such a curve and x is a coordinate on C, we say that x is normalised\nif x(0) = 0. If y is an unnormalised coordinate then x = y \u2212 y(0) is a normalised\none, so normalised coordinates always exist.\nDefinition 5.8. Let C be a pointed formal curve over X. Define\nf : Div+\n\u2192 Div+\nn (C) \u2212\nn+1 (C)\n\nby f (D) = D + [0]. For n \u2208 Z with n < 0 we write Div+\nn (C) = \u2205. Define\na\nDiv+ (C) =\nDiv+\nn (C)\nn\u22650\n\nf\n\nf\n\n\u2192 Div+\nDivn (C) = lim(Div+\n\u2192 ...)\nn (C) \u2212\nn+1 (C) \u2212\n-\u2192\na\nDiv(C) =\nDivn (C)\nn\u2208Z\n\nf\n\nf\n\n= lim(Div+ (C) \u2212\n\u2192 Div+ (C) \u2212\n\u2192 . . . ).\n-\u2192\n\nIt is not hard to see that f k `\ninduces an isomorphism Divn (C) \u2243 Divn+k (C),\nso Div(C) can be identified with n Div0 (C) = Z \u00d7 Div0 (C).\nA choice of normalised coordinate on C gives an isomorphism Div+\nn (C) \u2243 X \u00d7\nn\nb\nA . Under this identification, f becomes the map\n(x, a1 , . . . , an ) 7\u2192 (x, a1 , . . . , an , 0).\n\nb (\u221e) (using the notation of Example 4.4)\nWe thus have an isomorphism Div0 (C) = A\n(\u221e)\nb\nand thus Div = Z \u00d7 A .\n\nDefinition 5.9. Given a divisor D on a pointed curve C over X, we define\nthe Thom sheaf of D to be the line bundle L(D) = 0\u2217 J(D) over X. It is clear that\nL(D + E) = L(D) \u2297 L(E). Note that a coordinate on C gives a generator fD (x)\nfor J(D) and thus a generator uD for L(D), which we call the Thom class. This is\nnatural for maps of X, and satisfies uD+E = uD \u2297 uE .\nDefinition 5.10. If C is a pointed formal curve over X, we define a functor\nCoord(C) \u2208 FX by\nCoord(C)(R) = {(a, x) | a \u2208 X(R) and x is a normalised coordinate on Ca }.\n\nProposition 5.11. The functor Coord(C) is a formal scheme over X, and is\nunnaturally isomorphic to Gm \u00d7 A\u221e \u00d7 X.\n\n\f54\n\nNEIL P. STRICKLAND\n\nProof. Choose a normalised coordinate x on C, and suppose that a \u2208 X(R).\nb 1 has the form\nThen any normalised function y : Ca \u2212\n\u2192A\nX\ny(c) = f (x(c)) =\nuk x(c)k\nk>0\n\nfor a uniquely determined sequence of coefficients uk . Moreover, y is a coordinate\nb 1 \u00d7 spec(R) \u2212\nb 1 \u00d7 spec(R) is an isomorphism, if and only if\nif and only if f : A\n\u2192A\nthere is a power series g with g(f (t)) = t = f (g(t)). It is well-known that this\nhappens if and only if u1 is invertible. Thus, the set of coordinates on Ca bijects\nnaturally with (Gm \u00d7 A\u221e )(R), and Coord(C) \u2243 Gm \u00d7 A\u221e \u00d7 X is a formal scheme,\nas required.\n\nRemark 5.12. We will see later that when E is an even periodic ring spectrum\nand GE = (CP \u221e )E we have Coord(GE ) = spec(E0 M P ).\n5.2. Weierstrass preparation.\nDefinition\n5.13. A Weierstrass series over a ring R is a formal power series\nP\ng(x) = k ak xk \u2208 R[[x]] such that there exists an integer n such that ak is nilpotent\nfor k < n, and an is a unit. The integer n is called the Weierstrass degree of g(x).\n(It is clearly well-defined unless\nP R = 0). A Weierstrass polynomial over a ring R is\na monic polynomial h(x) = nk=0 bk xk such that bk is nilpotent for k < n.\nThe following result is a version of the Weierstrass Preparation Theorem; see [6,\nTheorem 3] (for example) for a more classical version.\n\nLemma 5.14. Let R be a ring, and let g(x) be a Weierstrass series over R, of\nWeierstrass degree n. Then there is a unique ring map \u03b1 : R[[y]] \u2212\n\u2192 R[[x]] sending y to\ng(x), and this makes R[[x]] into a free module over R[[y]] with basis {1, x, . . . , xn\u22121 }.\nProof. We can easily reduce to the case where an = 1. It is also easy to\nPcheck\nthat there is a unique map \u03b1 sending y to g(x), and that it sends any series j bj y j\nP\nto the sum j bj g(x)j , which is x-adically convergent.\nFor any j \u2265 0 and 0 \u2264 k < n we define zjk = g(x)j xk . Given any m \u2265 0 we\ncan write m = nj + k for some j \u2265 0 and 0 \u2264 k < n, and we put wm = zjk . For\nany R-module M , we define a map\nY\n\u03b2M :\nM\u2212\n\u2192 M [[x]]\nm\n\nP\nby \u03b2M (b) =\nm bm wm . It is easy to check that this sum is again x-adically\nconvergent. The claim in the lemma is equivalent to the statement that \u03b2R is an\nisomorphism.\nWrite I = (a0 , . . . , an\u22121 ). This\nso the same is true of I r\nQ generated,\nQ is finitely\nr\nr\nfor all r, and it follows that I\nm I M and so on. We also see that\nmM =\nwm = xm (mod I, xm+1 ).\nNow consider a module M with\n0, so that bwm = bxm (mod xm+1 ) for\nPIM = m\nM [[x]], we see by induction on m\nb \u2208 M . Given any series c(x) = m cm x \u2208P\nthat there is a unique sequence (bj ) such that j<m bm wm = c(x) (mod xm ) for\nall m. It follows that \u03b2M is an isomorphism whenever IM = 0. Next, whenever\nwe\nQ sequence L \u058c M \u0589 N we have short exact sequences\nQ have aQshort exact\nM\n\u0589\nL\n\u058c\nm N and L[[x]] \u058c M [[x]] \u0589 N [[x]], and we can use the fivem\nm\nlemma to see that \u03b2M is iso if \u03b2L and \u03b2N are. Using this we see by induction that\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n55\n\n\u03b2R/I r is iso for all r. On the other hand, when R is large we have I r = 0 and so\n\u03b2R is an isomorphism.\nCorollary 5.15. In the situation of the lemma, the quotient ring R[[x]]/g(x)\nis a free module of rank n over R, with basis {1, . . . , xn\u22121 }.\nCorollary 5.16. If g(x) is a Weierstrass series over a ring R then there is a\nunique factorisation g(x) = h(x)u(x), where h(x) is a Weierstrass polynomial, and\nu(x) is invertible.\nPn\u22121\nProof. By the previous corollary, we have \u2212xn = j=0 bj xj (mod g(x)) for\nP\nsome unique sequence b0 , . . . , bn\u22121 \u2208 R. Put h(x) = xn + j bj xj , so h is a monic\npolynomial of degree\nP n with h(x) = 0 (mod g(x)), say h(x) = g(x)v(x). Now write\ng(x) in the form k ak xk and put I = (a0 , . . . , an\u22121 ), so I is a nilpotent ideal.\nModulo I we find that g(x) is a unit multiple of xn , so xn = 0 (mod I, g(x)). The\nuniqueness argument applied mod I now tells us that h(x) = xn (mod I), so h(x)\nis a Weierstrass polynomial. It is also clear that v(x) becomes a unit mod I[[x]],\nbut I[[x]] is nilpotent so v(x) is a unit. We can thus take u(x) = 1/v(x) to get the\nrequired factorisation.\nWe now give a more geometric restatement of the above results.\nq\n\nr\n\nDefinition 5.17. Let C \u2212\n\u2192 X and D \u2212\n\u2192 X be formal curves over a formal\nscheme X, and let f : C \u2212\n\u2192 D be a map over X. We then have a curve r\u2217 C = C\u00d7X D\nover D, with projection map s : (c, d) 7\u2192 d. We also have a map f \u2032 : C \u2212\n\u2192 r\u2217 C of\n\u2032\nformal schemes over D, given by f (c) = (c, f (c)). We say that f is an isogeny if\nthe map f \u2032 makes C into a divisor on r\u2217 C over D. This implies in particular that\nf is finite and very flat.\nLemma 5.18. Let X be an informal scheme, and let f : C \u2212\n\u2192 D be a map of\nformal curves over X. Let x and y be coordinates on C and D respectively, and\nsuppose that f \u2217 y = g(x) for some Weierstrass series g(x). Then f is an isogeny.\nProof. Write R = OX , and let n be the Weierstrass degree of g(x). We then\nhave C = spf(R[[x]]) and D = spf(R[[y]]) and r\u2217 C = spf(R[[x, y]]). In this last case\nwe think of x as the coordinate on r\u2217 C and y as a parameter on the base. The map\nf \u2032 corresponds to the map \u03b1 : R[[x, y]] \u2212\n\u2192 R[[x]] that sends x to x and y to g(x). We\nthus need to show that \u03b1 is surjective (making f \u2032 a closed inclusion) and that it\nmakes A[[x]] into a free module of rank n over A[[y]]. The surjectivity is clear, and\nthe freeness follows from Lemma 5.14.\nExample 5.19. One can check that the evident map CP \u221e \u2212\n\u2192 HP \u221e gives an\n\u221e\n\u221e\nisogeny (CP )E \u2212\n\u2192 (HP )E of formal curves.\nDefinition 5.20. Let X be an informal scheme, and C a formal curve over X.\nWe then let MC/X be the ring obtained from OC by inverting all coordinates on\nC. We refer to this as the ring of meromorphic functions on C.\nLemma 5.21. Let X be an informal scheme, and C a formal curve over\nP X, and\nx a coordinate on C. Then MC/X = OC [1/x], which is the ring of series k\u2208Z ak xk\nsuch that ak \u2208 OX and ak = 0 for k \u226a 0.\n\n\f56\n\nNEIL P. STRICKLAND\n\nProof. Let y be another coordinate on C; it will suffice to check that y\nbecomes\nP invertible in OC [1/x]. As x and y are both coordinates, we find that\ny = k\u22650 ak xk for some series such that a0 is nilpotent and a1 is a unit. In other\nwords, we have y = b + xc(x), where b is nilpotent and c(0) is invertible in OX , so\nc(x) is invertible in OC . It is thus clear that y \u2212 b has inverse x\u22121 c(x)\u22121 in OC [1/x].\nThe sum of a unit and a nilpotent element is always invertible, so y is a unit as\nrequired.\nRemark 5.22. The elements of MC/X should be thought of as Laurent expansions of functions whose poles are all very close to the origin, the expansion being\nvalid outside a small disc containing all the poles.\nP\nLemma 5.23. Let x be a coordinate on C, and let f (x) = k\u2208Z ak xk be an\nelement of MC/X .`Then f is invertible in MC/X if and only if X can be written as\na coproduct X = k\u2208Z Xk , where Xk = \u2205 for almost all k, such that aj is nilpotent\non Xk for j < k, and ak is invertible on Xk .\nFirst suppose that f (x) is invertible,\nsay f (x)g(x) = 1 with g(x) =\nP\nP Proof.\nbj xj . Write Ij = (aj b\u2212j ) and Jj = k6=j Ij . Because f (x)g(x) = 1 it is clear\nj\u2208ZP\nthat j Ij = OX and thus Ji + Jj = OX when i 6= j. There exists K such that\na\u2212j = b\u2212j = 0 when j > K. It follows that Ij = 0 and Jj = OX when |j| > K.\nNext, let p be a prime ideal in OX . As OX /p is an integral domain, it is clear that\nmodulo p we must have f (x) = ak xk + . . . and g(x) = b\u2212k x\u2212k + . . . for some k.\nThis implies that ai bj \u2208 p whenever i + j < 0. As the intersection of all prime\nideals is the set of nilpotents, the elements ai bj must be nilpotent when i + j < 0.\nIf i 6= j then either i \u2212 j or j \u2212 i is negative, so T\nai b\u2212i aj b\u2212j is nilpotent. It follows\nthat Ii Ij is nilpotent when i 6= j, and thus that j Jj is nilpotent. It follows from\np\nthe results of Section 2.5 that there are unique ideals Jj\u2032 such that Jj \u2264 Jj\u2032 \u2264 Jj\nQ\nand OX = j OX /Jj\u2032 . We take Xj = spec(OX /Jj\u2032 ); one can check that this has the\nclaimed properties.\nConversely, suppose that X has a decomposition of the type discussed. We\nreduce easily to the case where X = Xk for some P\nk. After replacing f by x\u2212k f , we\nmay assume that k = 0. This means that f (x) = j\u2208Z aj xj , where a0 is invertible\nand aj is nilpotent for j < 0 and aj = 0 for j \u226a 0. The invertibility or otherwise of\nf is unaffected if we subtract off a nilpotent term, so we may assume that aj = 0\nfor j < 0. The resulting series is invertible in OC and thus certainly in MC/X .\nDefinition 5.24. Let x be a coordinate on C,\n` and let f be an invertible element of MC/X , so we have a decomposition X = k Xk as above. If X = Xk then\nwe say that f has constant degree k. More generally, we let deg(f ) be the map\nfrom X to the constant scheme Z that takes the value k on Xk . One can check that\nthese definitions are independent of the choice of coordinate.\nLemma 5.25. Let x be a coordinate on C, and let f be an invertible element\nof MC/X , with constant degree k. Then there is a unique factorisation f (x) =\nP\n\u2212j\nxk u(x)g(x), where u(x) \u2208 O\u00d7\nwhere b0 = 1 and bj is\nC , and g(x) =\nj\u22650 bj x\nnilpotent for j > 0 and bj = 0 for j \u226b 0.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n57\n\nProof. Clearly we have h(x) = xN f (x) \u2208 OC for some N > 0. We see from\nLemma 5.23 that h(x) is a Weierstrass power series of Weierstrass degree N + k.\nIt follows from Corollary 5.16 that h(x) has a unique factorisation of the form\nh(x) = k(x)u(x), where k(x) is a Weierstrass polynomial of degree N + k, and\n\u2212N \u2212k\nu(x) \u2208 O\u00d7\nh(x); this clearly gives a factorisation of the\nC . We write g(x) = x\nrequired type, and one can check that it is unique.\nProposition 5.26. Let C be a formal curve over a formal scheme X. For any\nring R, we define\nMer(C, Gm )(R) = {(u, f ) | u \u2208 X(R) , f \u2208 M\u00d7\nCu /spec(R) }.\nThen Mer(C, Gm ) is a formal scheme over X, and there is a short exact sequence\nof formal groups\nMap(C, Gm ) \u058c Mer(C, Gm ) \u0589 Div(C),\nwhich admits a non-canonical splitting.\nProof. As Map(C, Gm )(R) = {(u, f ) | u \u2208 X(R) , f \u2208 O\u00d7\nCu }, there is an\nobvious inclusion Map(C, Gm ) \u2212\n\u2192P\nMer(C, Gm ) of group-valued functors. Next, let\nY (R) be the set of series g(x) = j\u22650 bj x\u2212j such that b0 = 1 and bj is nilpotent\nQ\nb1\nfor j > 0 and bj = 0 for j \u226b 0. Then Y = lim\n0<j<k A is a formal scheme, and\n-\u2192 k\n\nLemma 5.25 gives an isomorphism Mer(C, Gm ) \u2243 Map(C, Gm )\u00d7 Z \u00d7 Y . This shows\nthat Mer(C, Gm ) is a formal scheme. We next define a map div : Mer(C, Gm ) \u2212\n\u2192\nDiv(C). Suppose that f \u2208 OCu is such that OCu /f is a free module of rank n\nover R. Then D = spf(OCu /f ) \u2208 Divn (G)(R)and we define div(f ) = D. Given\nanother such function g \u2208 OCu , we define div(f /g) = div(f ) \u2212 div(g). This is\nwell-defined, because if f /g = f \u2032 /g \u2032 then f g \u2032 = f \u2032 g (because series of this form are\nnever zero-divisors) and thus div(f ) + div(g \u2032 ) = div(f \u2032 ) + div(g) and so div(f ) \u2212\ndiv(g) = div(f \u2032 )\u2212div(g \u2032 ). It is easy to see that we get a well-defined homomorphism\ndiv : Mer(C, Gm ) \u2212\n\u2192 Div(C), which is zero on Map(C, Gm ). Conversely, suppose\nthat div(f /g) = 0, so that div(f ) = div(g). Then f and g are non-zero-divisors\nand they generate the same ideal in OCu , so they are unit multiples of each other\nand thus f /g \u2208 Map(C, Gm )(R). Thus ker(div) = Map(C, Gm ).\nNow let j : C \u2212\n\u2192 Div(C) be the evident inclusion. Given a point a \u2208 C(R),\nwe also define \u03c3(a) = x \u2212 x(a) = x(1 \u2212 x(a)/x) \u2208 Mer(C)(R). This gives a map\n\u03c3: C \u2212\n\u2192 Mer(C, Gm ), and it is clear that div \u25e6 \u03c3 = j. As Div(C) is the free\nAbelian formal group generated by C, we see that there is a unique homomorphism\n\u03c4 : Div(C) \u2212\n\u2192 Mer(C, Gm ) with \u03c4 \u25e6 j = \u03c3. We thus have div \u25e6 \u03c4 \u25e6 j = j and thus\ndiv \u25e6 \u03c4 = 1. It follows that the sequence Map(C, Gm ) \u058c Mer(C, Gm ) \u0589 Div(C)\nis a split exact sequence. The splitting depends on a choice of coordinate, but the\nother maps are canonical.\n5.3. Formal differentials. We next generalise Definition 2.65 to a certain\n(rather small) class of formal schemes.\nDefinition 5.27. We say that a formal scheme W over X is formally smooth\nb X to A\nb n \u00d7 X. In particular, W is\nof dimension n over X if it is isomorphic in X\nformally smooth of dimension one if and only if it is a formal curve.\n\n\f58\n\nNEIL P. STRICKLAND\n\nDefinition 5.28. Let W be formally smooth of dimension n over X; we shall\ndefine a vector bundle \u03a91W/X of rank n over W . By Corollary 4.48, it suffices to do\nthis in a sufficiently natural way whenever X is an informal scheme. In that case,\nb OX OW \u2212\n\u2192 OW ,\nwe let J be the kernel of the multiplication map OW \u00d7X W = OW \u2297\nso that V (J) is the diagonal subscheme in W \u00d7X W . We then write \u03a91W/X = J/J 2 ,\nwhich is a module over OW \u00d7X W /J = OW . If f \u2208 OW then we write d(f ) =\nf \u2297 1 \u2212 1 \u2297 f + J 2 \u2208 \u03a91W/X , and note that d(f g) = f d(g) + gd(f ) as usual. As\nW is formally smooth, we can choose x1 , . . . , xn \u2208 OW giving an isomorphism\nb n \u00d7 X and thus OW \u2243 OX [[x1 , . . . , xn ]]. One checks that \u03a91\nW \u2243 A\nW/X is freely\n1\ngenerated over OW by {d(x1 ), . . . , d(xn )}. Thus, \u03a9W/X can be regarded as a vector\nbundle of rank n over W , as required. We write \u03a9kW/X for the k'th exterior power\nof \u03a91W/X .\nAny map f : V \u2212\n\u2192 W of formally smooth schemes over X gives rise to a map\n\u2192 \u03a91V /X of vector bundles over V . If we have coordinates xi on W\nf \u2217 : f \u2217 \u03a91W/X \u2212\nand yj on V then xP\ni \u25e6 f = ui (y1 , . . . , yd ) for certain power series ui over OX , and\nwe have f \u2217 (dxi ) = j (\u2202ui /\u2202yj )dyj . Thus, f \u2217 is a coordinate-free way of encoding\nthe partial derivatives of the series ui .\nIf W is formally smooth over X and g : Y \u2212\n\u2192 X then g \u2217 W = Y \u00d7X W is easily\n1\nseen to be formally smooth over Y , with \u03a9g\u2217 W/Y = h\u2217 \u03a91W/X , where h : g \u2217 W \u2212\n\u2192W\nis the evident projection map.\nDefinition 5.29. If R is an Fp -algebra, then we have a ring map \u03c6R from R to\nitself defined by \u03c6R (a) = ap . We call this the algebraic Frobenius map. Now let X be\na functor over spec(Fp ). If R is an Fp -algebra, we define (FX )R = X(\u03c6R ) : X(R) \u2212\n\u2192\nX(R). If R is not an Fp -algebra then spec(Fp )(R) = \u2205 and thus X(R) = \u2205 and we\ndefine (FX )R = 1 : X(R) \u2212\n\u2192 X(R). This gives a map FX : X \u2212\n\u2192 X, which we call\nthe geometric Frobenius map.\nRemark 5.30. If h : X \u2212\n\u2192 Y is a map of functors over spec(Fp ) then one can\ncheck that FY \u25e6 h = h \u25e6 FX . If X is a scheme then FX is characterised by the fact\nthat g(FX (a)) = g(a)p for all rings R, points a \u2208 X(R), and functions g \u2208 OX . If\nX = spec(A) then FX = spec(\u03c6A ).\nDefinition 5.31. Let X be a functor over spec(Fp ), and let W be functor over\n\u2217\nX, with given map q : W \u2212\n\u2192 X. We then have a functor FX\nW over X defined by\n\u2217\n(FX\nW )(R) = {(a, b) \u2208 W (R) \u00d7 X(R) | q(a) = FX (b)}.\n\n\u2217\nWe define a map FW/X : W \u2212\n\u2192 FX\nW by FW/X (a) = (FW (a), q(a)). Note that if\n\u2217\nW is formally smooth over X then the same is true of FX\nW . Moreover, if we have\n\u2217\ncoordinates xi on W and we use the obvious resulting coordinates yi on FX\nW then\np\nwe have yi (FW/X (a)) = xi (a) .\n\nProposition 5.32. Let f : V \u2212\n\u2192 W be a map of formally smooth schemes over\n\u2192 \u03a91V /X .\nX, and suppose that f \u2217 = 0 : \u03a91W/X \u2212\n(a) If X lies over spec(Q) then there is a unique map g : X \u2212\n\u2192 W of schemes\ng\nover X such that f is the composite V \u2212\n\u2192X \u2212\n\u2192 W . In other words, f is\nconstant on the fibres of V .\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n59\n\n(b) If X lies over spec(Fp ) for some prime p, then there is a unique map\n\u2217\nf \u2032 : FX\nW \u2212\n\u2192 V such that f = f \u2032 \u25e6 FW/X .\nProof. Choose coordinates xi on W and yj on V , so xi P\n\u25e6 f = ui (y1 , . . . , yd )\nfor certain power series ui over OX . We have 0 = f \u2217 (dxi ) = j (\u2202ui /\u2202yj )dyj , so\n\u2202ui /\u2202yj = 0 for all i and j. In the rational case we conclude that the series ui are\nconstant, and in the mod p case we conclude that ui (y1 , . . . , yd ) = vi (y1p , . . . , ydp )\nfor some unique series vi . The conclusion follows easily.\n5.4. Residues. We now describe an algebraic theory of residues, which is\nessentially the same as that discussed in [10] and presumably identical to the unpublished definition by Cartier mentioned in [19].\nP\nDefinition 5.33. If f (x) = k\u2208Z ak xk \u2208 R[[x]][1/x], we define \u03c1(f ) = a\u22121 .\n\nRemark 5.34. Recall from Remark 5.22 that the elements of R[[x]][1/x] should\nbe compared with meromorphic functions on a neighbourhood of zero in C of moderate size, whose poles are concentrated very near the origin. The expansion in\nterms of x should be thought of as a Laurent expansion that is valid outside a tiny\ndisc containing all the poles. Thus, the coefficient of 1/x is the sum of the residues\nat all the poles, and not just the pole at the origin. To justify this, note that if a\nPN \u22121\nis nilpotent (say aN = 0) we have 1/(x \u2212 a) = k=0 ak /xk+1 so \u03c1(1/(x \u2212 a)) = 1.\n\nProposition 5.35. For any f \u2208 R[[x]][1/x] we have \u03c1(f \u2032 ) = 0. If f is invertible\nwe have \u03c1(f \u2032 /f ) = deg(f ), where deg(f ) is as in Definition 5.24. Moreover, we have\n\u03c1(f n .f \u2032 ) = 0 for n 6= \u22121.\nProof. It is immediate from the definitions that \u03c1(f \u2032 ) = 0. Now let f be\ninvertible; we may assume that it has constant degree d say. LemmaP5.25 gives\n\u00d7\na factorisation f (x) = xd u(x)g(x), where u(x) \u2208 R[[x]] , and g(x) = j\u22650 bj x\u2212j\nwhere b0 = 1 and bj is nilpotent for j > 0 and bj = 0 for j \u226b 0. We then have\nf \u2032 /f = d/x + u\u2032 /u + g \u2032 /g. It is clear that u\u2032 /u \u2208 R[[x]] so \u03c1(u\u2032 /u) = 0. Similarly,\nwe find that g \u2032 only involves powers xk with k < \u22121. Moreover, if h(x) = 1 \u2212 g(x)\nPN\nthen h is a polynomial in 1/x and is nilpotent, and 1/g = k=0 hk for some N\nso 1/g is a polynomial in 1/x. It follows that g \u2032 /g only involves powers xk with\nk < \u22121, so \u03c1(g \u2032 /g) = 0. Thus \u03c1(f \u2032 /f ) = d as claimed.\nFinally, suppose that n 6= \u22121. Note that (n + 1)\u03c1(f n .f \u2032 ) = \u03c1((f n+1 )\u2032 ) = 0. If\nn \u2032\nR is torsion-free we conclude\nP\u221e thati \u03c1(f .f ) = 0. If R is not torsion-free, we recall\nthat f (x) has the form i=m ai x for some m, where ai is nilpotent for i < d and\nN\nad is invertible. Thus there is some N > 0 such that aP\ni = 0 for all i < d. Define\n\u2032\nN\nR = Z[bi | i \u2265 m][1/bd]/(bi | m \u2264 i < d) and g(x) = i bi xi \u2208 R\u2032 [[x]][1/x]\u00d7 . It is\nclear that R\u2032 is torsion-free and thus that \u03c1(g n .g \u2032 ) = 0. There is an evident map\nR\u2032 \u2212\n\u2192 R carying g to f , so we deduce that \u03c1(f n .f \u2032 ) = 0 as claimed.\nCorollary 5.36. If g(x) \u2208 R[[x]] is a Weierstrass series of degree d > 0 and\nf (x) \u2208 R[[x]][1/x] then \u03c1(f (g(x))g \u2032 (x)) = d\u03c1(f (x)).\nP\nk\nProof. Suppose that f (x) =\nk\u2265m ak x . We first observe that the claim\nmakes sense: as g is a Weierstrass series of degree d > 0 we know that g(0) is\nnilpotent, so g N \u2208 R[[x]]x for some N , so g N k \u2208 R[[x]]xk for k \u2265 0. Moreover,\n\n\f60\n\nNEIL P. STRICKLAND\n\nLemma 5.23\nP implies that g is invertible in R[[x]][1/x]. Thus, the terms in the sum\nf (g(x)) = k\u2265m ak g(x)k are all defined, and the sum is convergent. We thus have\nX\n\u03c1(f (g(x))) =\nak \u03c1(g k .g \u2032 ) = d a\u22121 = d\u03c1(f )\nk\n\nas required.\n\nDefinition 5.37. Let C be a formal curve over an affine scheme X. We write\nM\u03a91C/X for MC/X \u2297OC \u03a91C/X , which is a free module of rank one over MC/X . It is\neasy to check that there is a unique map d : MC/X \u2212\n\u2192 M\u03a91C/X extending the usual\nmap d : OC \u2212\n\u2192 \u03a91C/X and satisfying d(f g) = f d(g) + g d(f ).\nCorollary 5.38. Let C be a formal curve over an affine scheme X. Then\nthere is a natural residue map res = resC/X : M\u03a91C/X \u2212\n\u2192 OX such that\n(a) res(df ) = 0 for all f \u2208 MC/X .\n(b) res((df )/f ) = deg(f ) for all f \u2208 M\u00d7\nC/X .\n\u2032\n(c) If q : C \u2212\n\u2192 C is an isogeny then res(q \u2217 \u03b1) = deg(q)res(\u03b1) for all \u03b1.\n\nProof. Choose a coordinate x on C, so that any \u03b1 \u2208 MC/X \u2297OC \u03a91C/X has\na unique expression \u03b1 = f (x)dx for some f \u2208 OX [[t]][1/t]. Define res(\u03b1) = \u03c1(f ). If\ny is a different coordinate then x = g(y) for some Weirstrass series g of degree 1\nand dx = g \u2032 (y)dy so \u03b1 = f (g(y))g \u2032 (y)dy and we know that \u03c1(f (g(y))g \u2032 (y)) = \u03c1(f )\nso our definition is independent of the choice of the coordinate. The rest of the\ncorollary is just a translation of the properties of \u03c1.\nSee Remark 8.34 for a topological application of this.\n6. Formal groups\nA formal group over a formal scheme X is just a group object in the category\nb X . In this section, we will study formal groups in general. In the next, we will\nX\nspecialise to the case of commutative formal groups G over X with the property\nthat the underlying scheme is a formal curve; we shall call these ordinary formal\ngroups. For technical reasons, it is convenient to compare our formal groups with\ngroup objects in suitable categories of coalgebras. To combine these cases, we\nstart with a discussion of Abelian group objects in an arbitrary category with finite\nproducts. We then discuss the existence of free Abelian formal groups, or of schemes\nof homomorphisms between formal groups. As a special case, we discuss the Cartier\nduality functor G 7\u2192 Hom(G, Gm ). Finally, we define torsors over a commutative\nformal group, and show that they form a strict Picard category.\n6.1. Group objects in general categories. Let D be a category with finite\nproducts (including an empty product, in other words a terminal object). There is\nan evident notion of an Abelian group object in D; we write Ab D for the category\nof such objects. We also consider the category Mon D of Abelian monoids in D.\nA basepoint for an object U of D is a map from the terminal object to U . We\nwrite Based D for the category of objects of D equipped with a specified basepoint.\nThere are evident forgetful functors\nAb D \u2212\n\u2192 Mon D \u2212\n\u2192 Based D \u2212\n\u2192 D.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n61\n\nIf U \u2208 D and G \u2208 Ab D then the set D(U, G) has a natural Abelian group\nstructure. In fact, to give such a group structure is equivalent to giving maps\n0\n\u03c3\n1 \u2212\n\u2192 G \u2190\u2212 G \u00d7 G making it an Abelian group object, as one sees easily from\nYoneda's lemma.\nLet {Gi } be a diagram in Ab D, and suppose that the underlying diagram in D\nhas a limit G. Then D(U, G) = lim D(U, Gi ) has a natural Abelian group structure.\n\u2190- i\n\nIt follows that there is a unique way to make G into an Abelian group object such\nthat the maps G \u2212\n\u2192 Gi become homomorphisms, and with this structure G is also\nthe limit in Ab D. In other words, the forgetful functor Ab D \u2212\n\u2192 D creates limits.\nSimilarly, we see that all the functors Ab D \u2212\n\u2192 Mon D \u2212\n\u2192 Based D \u2212\n\u2192 D and their\ncomposites create limits.\nSuppose that G, H and K are Abelian group objects in D and that f : G \u2212\n\u2192K\nf \u00d7g\nand g : H \u2212\n\u2192 K are homomorphisms. One checks that the composite G \u00d7 H \u2212\u2212\u2192\n\u03c3\nK\u00d7K \u2212\n\u2192 K is also a homomorphism, and that it is the unique homomorphism\nwhose composites with the inclusions G \u2212\n\u2192 G \u00d7 H and H \u2212\n\u2192 G \u00d7 H are f and g.\nThis means that G \u00d7 H is the coproduct of G and H in Ab D, as well as being their\nproduct.\nWe next investigate another type of colimit in Ab D.\nDefinition 6.1. A reflexive fork in any category D is a pair of objects U, V ,\ntogether with maps d0 , d1 : U \u2212\n\u2192 V and s : V \u2212\n\u2192 U such that d0 s = 1 = d1 s. The\ncoequaliser of such a fork means the coequaliser of the maps d0 and d1 .\nProposition 6.2. Let D be a category with finite products. Let\n\nwU wV\nw V w W be a strong coequaliser in D.\nbe a reflexive fork in Mon D, and let U\nd0\n\ns\n\nV\n\nd1\n\nd0\n\ne\n\nd1\n\nThen there is a monoid structure on W such that e is a homomorphism, and this\nmakes the above diagram into a coequaliser in Mon D.\n\nProof. Let \u03c3U : U \u00d7 U \u2212\n\u2192 U and \u03c3V : V \u00d7 V \u2212\n\u2192 V be the addition maps. We\nhave a commutative diagram as follows:\nV \u00d7U\n\nw U \u00d7U\n\ns\u00d71\n\nuu\n\nuu\n\n1\u00d7d0 1\u00d7d1\n\nd0 \u00d7d0 d1 \u00d7d1\n\nV \u00d7V\n\nV \u00d7V\n\nwU\n\n\u03c3U\n\nuu\nwV\n\nd0 d1\n\n\u03c3V\n\nThe right hand square commutes because d0 and d1 are homomorphisms, and\nthe left hand one because d0 s = d1 s = 1. Using this, we see that e\u03c3V (1 \u00d7 d0 ) =\ne\u03c3V (1 \u00d7 d1 ), and a similar proof shows that e\u03c3V (d0 \u00d7 1) = e\u03c3V (d1 \u00d7 1). In terms\nof elements, this just says that e(d0 (u) + v) = e(d1 (u) + v). As our coequaliser\ndiagram was assumed to be strong, we see that the diagram\nV \u00d7U\n\nwV \u00d7V wV \u00d7W\n\n1\u00d7d0\n1\u00d7d1\n\n1\u00d7e\n\n\f62\n\nNEIL P. STRICKLAND\n\nis a coequaliser. This implies that there is a unique map \u03c4 : V \u00d7 W \u2212\n\u2192 W with\n\u03c4 (1 \u00d7 e) = e\u03c3V : V \u00d7 V \u2212\n\u2192 W . Now consider the diagram\nU \u00d7V\n1\u00d7e\n\nu\n\nU \u00d7W\n\nd0 \u00d71\n\nd1 \u00d71\n\nd0 \u00d71\nd1 \u00d71\n\nw V \u00d7V\nu\n\n\u03c3V\n\nwV\nu\n\n1\u00d7e\n\nw V \u00d7W\n\n\u03c4\n\ne\n\nw W.\n\nWe have already seen that e\u03c3V (d0 \u00d7 1) = e\u03c3V (d1 \u00d7 1), and it follows that \u03c4 (d0 \u00d7\n1)(1 \u00d7 e) = \u03c4 (d1 \u00d7 1)(1 \u00d7 e). As the relevant coequaliser is preserved by the\nfunctor U \u00d7 (\u2212), we see that 1U \u00d7 e is an epimorphism, so we can conclude that\n\u03c4 (d0 \u00d71) = \u03c4 (d1 \u00d71). As the functor (\u2212)\u00d7W preserves our coequaliser, this gives us\na unique map \u03c3W : W \u00d7W \u2212\n\u2192 W such that \u03c3W (e\u00d71) = \u03c4 : V \u00d7W \u2212\n\u2192 W . One checks\nthat this makes W into an Abelian group object, and that e is a homomorphism.\nOne can also check that this makes W into a coequaliser in Ab D.\nRemark 6.3. The same result holds, with essentially the same proof, with\nMon D replaced by Ab D or Based D. The same methods also show that a reflexive\nfork in the category of R-algebras (for any ring R) has the same coequaliser when\ncomputed in the category of R-algebras, or of R-modules, or of sets.\nWe next try to construct free Abelian groups or monoids on objects of D or\nBased D. If U \u2208 D and V \u2208 Based D, we \"define\" objects M + (U ), N + (V ) \u2208 Mon D\nand M (U ), N (V ) \u2208 Ab(D) by the equations\nMon D(M + (U ), M ) = D(U, M )\n\nMon D(N + (V ), M ) = Based D(V, M )\nAb D(M (U ), G) = D(U, G)\nAb D(N (V ), G) = Based D(V, G).\nMore precisely, if there is an object H \u2208 Ab D with a natural isomorphism\nAb D(H, G) = Based D(V, G)\n\nfor all G \u2208 Ab D, then H is unique up to canonical isomorphism, and we write\nN (V ) for H. Similar remarks apply to the other three cases. Given a monoid\nobject M , we also \"define\" its group completion G(M ) \u2208 Ab D by the equation\nAb D(G(M ), H) = Mon D(M, H).\nThere are fairly obvious ways to try to construct free group and monoid objects,\nusing a mixture of products and colimits. However, there are two technical points\nto address. Firstly, it turns out that we need our colimits to be strong colimits\nin the sense of Definition 2.18. Secondly, in some places we can arrange to use\nreflexive coequalisers, which is technically convenient.\nProposition 6.4. Let U be an object of D. For each k \u2265 0, the symmetric\ngroup \u03a3k acts on U`k . Suppose that the quotient U k /\u03a3k exists as a strong colimit\nand also that L = k\u22650 U k /\u03a3k exists as a strong coproduct. Then L = M + (U ).\nProof. Let I be the category with object set N, and with morphisms\n(\n\u2205\nif j 6= k\nI(j, k) =\n\u03a3k if j = k.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n63\n\nIt is easy to see that there is a functor k 7\u2192 U k from I to D, and that L is a\nstrong colimit of this functor. It follows that L \u00d7 U m is the colimit of the functor\nk 7\u2192 U k \u00d7 U m , and thus (using the \"Fubini theorem\" for colimits) that\nL\u00d7L=\n\nlim\n\n-\u2192\n(k,m)\u2208I\u00d7I\n\nU k \u00d7 U m.\n\nSimilarly, L \u00d7 L \u00d7 L is the colimit of the functor (k, m, n) 7\u2192 U k \u00d7 U m \u00d7 U n from\nI \u00d7 I \u00d7 I to D.\nLet jk : U k \u2212\n\u2192 L be the evident map. We then have maps U k \u00d7 U m \u2243\njk+m\n\nU k+m \u2212\u2212\u2212\u2192 L, and these fit together to give a map \u03c3 : L \u00d7 L \u2212\n\u2192 L. We also\nhave a zero map 0 = j0 : 1 = U 0 \u2212\n\u2192 L. We claim that this makes L into a commutative monoid object in D. To check associativity, for example, we need to show\nthat \u03c3 \u25e6 (\u03c3 \u00d7 1) = \u03c3 \u25e6 (1 \u00d7 \u03c3) : L3 \u2212\n\u2192 L. By the above colimit description of L3 , it is\nenough to check this after composing with the map jk \u00d7 jm \u00d7 jn : U k+m+n \u2212\n\u2192 L3 ,\nand it is easy to check that both the resulting composites are just jk+m+n . We\nleave the rest to the reader.\nNow suppose we have a monoid M \u2208 Mon D and a map f : U \u2212\n\u2192 M in D. We\nfk\n\n\u03c3\n\nthen have maps fk = (U k \u2212\u2192 M k \u2212\n\u2192 M ), which are easily seen to be invariant\nunder the action of \u03a3k , so we get an induced map f \u2032 : L \u2212\n\u2192 M in D. We claim that\nthis is a homomorphism. It is clear that f \u2032 \u25e6 0 = 0, so we need only check that\nf \u25e6 \u03c3 = \u03c3 \u25e6 (f \u00d7 f ) : L2 \u2212\n\u2192 M . Again, we need only check this after composing with\nthe map jk \u00d7 jm : U k+m \u2212\n\u2192 L2 , and it then becomes easy. We also claim that f \u2032 is\nthe unique homomorphism g : L \u2212\n\u2192 M such that g \u25e6 j1 = f . Indeed, we have jk =\njk\n\n\u03c3\n\nfk\n\n\u03c3\n\n1\n(U k \u2212\u2192\nLk \u2212\n\u2192 L), so for any such g we have g \u25e6 jk = (U k \u2212\u2192 M k \u2212\n\u2192 M ) = f \u2032 \u25e6 jk .\n\u2032\nBy our colimit description of L, we see that g = f as claimed.\nThis shows that monoid maps g : L \u2212\n\u2192 M biject naturally with maps f : U \u2212\n\u2192\nM , by the correspondence g 7\u2192 g \u25e6 j1 . This means that L = M + (U ) as claimed.\n\nProposition 6.5. Let V be an object of Based D, and suppose that Vk =\nV k /\u03a3k exists as a strong colimit for all k \u2265 0. The basepoint of U then induces\nmaps Vk \u2212\n\u2192 Vk+1 . Suppose also that the sequence of Vk 's has a strong colimit L.\nThen L = N + (V ).\nProof. This is essentially the same as the proof of Proposition 6.4, and is left\nto the reader.\nWe next try to construct group completions of monoid objects. We digress\nbriefly to introduce some convenient language. Let M be a monoid object, so that\nD(U, M ) is naturally a monoid for all U . We thus have a map fU : D(U, M 3 ) =\nD(U, M )3 \u2212\n\u2192 D(U, M 2 ) defined by f (a, b, c) = (c + 2a, 3b + c) (for example). This\nis natural in U , so Yoneda's lemma gives us a map f : M 3 \u2212\n\u2192 M 2 . From now on,\nwe will allow ourselves to abbreviate this definition by saying \"let f : M 3 \u2212\n\u2192 M2\nbe the map (a, b, c) 7\u2192 (c + 2a, 3b + c)\". This is essentially the same as thinking of\nD as a subcategory of [Dop , Sets], by the Yoneda embedding.\n\n\f64\n\nby\n\nNEIL P. STRICKLAND\n\nGiven a monoid object M , we define maps d0 , d1 : M 3 \u2212\n\u2192 M 2 and s : M 2 \u2212\n\u2192M\nd0 (a, b, x) = (a, b)\nd1 (a, b, x) = (a + x, b + x)\ns(a, b) = (a, b, 0).\n\nThis is clearly a reflexive fork in Mon D.\nProposition 6.6. If the above fork has a strong coequaliser q : M 2 \u2212\n\u2192 H in D,\nthen H has a unique group structure making q into a homomorphism of monoids,\nand with that group structure we have H = G(M ).\nProof. Firstly, Proposition 6.2 tells us that there is a unique monoid structure\non H making q into a monoid map, and that this makes H into the coequaliser\nin Mon D. We define a monoid map \u03bd \u2032 : M 2 \u2212\n\u2192 H by \u03bd \u2032 (a, b) = q(b, a). Clearly\n\u03bd \u2032 d0 (a, b, x) = qd0 (b, a, x) and \u03bd \u2032 d1 (a, b, x) = qd1 (b, a, x) but qd0 = qd1 so \u03bd \u2032 d0 =\n\u03bd \u2032 d1 , so there is a unique map \u03bd : H \u2212\n\u2192 H with \u03bd \u2032 = \u03bdq. We then have\nq(a, b) + \u03bdq(a, b) = q(a, b) + q(b, a)\n= q(a + b, a + b)\n= qd1 (0, 0, a + b)\n= qd0 (0, 0, a + b)\n= q(0, 0) = 0.\nThis shows that (1 + \u03bd)q = 0, but q is an epimorphism so 1 + \u03bd = 0. This means\nthat \u03bd is a negation map for H, making it into a group object. We let j : M \u2212\n\u2192H\nbe the map a 7\u2192 q(a, 0), which is clearly a homomorphism of monoids. Clearly\nq(a, b) = q(a, 0) + q(0, b) = j(a) + \u03bdj(b) = j(a) \u2212 j(b).\nNow let K be another Abelian group object, and let f : M \u2212\n\u2192 K be a homomorphism of monoids. We define f \u2032 : M 2 \u2212\n\u2192 K by f \u2032 (a, b) = f (a) \u2212 f (b). It\nis clear that f \u2032 d0 = f \u2032 d1 , so we get a unique monoid map f \u2032\u2032 : H \u2212\n\u2192 K with\nf \u2032\u2032 q = f \u2032 . In particular, we have f \u2032\u2032 j(a) = f \u2032\u2032 q(a, 0) = f \u2032 (a, 0) = f (a), so\nthat f \u2032\u2032 j = f . If g : H \u2212\n\u2192 K is another homomorphism with gj = f then\ngq(a, b) = g(j(a) \u2212 j(b)) = f (a) \u2212 f (b) = f \u2032\u2032 q(a, b), and q is an epimorphism\nso g = f \u2032\u2032 .\nThis shows that group maps H \u2212\n\u2192 K biject with monoid maps M \u2212\n\u2192 K by the\ncorrespondence g 7\u2192 gj, which means that H = G(M ) as claimed.\n6.2. Free formal groups. We next discuss the existence of free Abelian formal groups.\nProposition 6.7. Let Y be a formal scheme over a formal scheme X. Write\nX as a filtered colimit of informal schemes Xi , and put Yi = Y \u00d7X Xi . If M + (Yi )\nb X for all i, then M + (Y ) exists and is equal to lim M + (Yi ). Similar\nexists in Mon X\ni\n-\u2192 i\n\nremarks apply to M (Y ) and (if Y has a given section 0 : X \u2212\n\u2192 Y ) to N + (Y ) and\nN (Y ).\nProof. We use the notation of Definition 4.26 and Proposition 4.27. It is clear\nthat {M + (Yi )} is the free Abelian monoid object on {Yi } in the category D{Xi } . As\nb X preserves finite limits, we see that L = lim M + (Yi ) =\nthe functor F : D{Xi } \u2212\n\u2192X\n-\u2192 i\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n65\n\nb X . Using the fact that F preserves\nF {M + (Yi )} is an Abelian monoid object in X\nfinite products and is left adjoint to G, we see that\nb X (Lm , Z) = D{X } ({M + (Yi )m }, {Z \u00d7X Xi })\nX\nXi\ni\n\nb Z . Using this, one can check that\nfor all Z \u2208 X\n\nb\nMon X(L,\nM ) = Mon D{Xi } ({M + (Yi )}, {M \u00d7X Xi })\n\nb X (Y, M ),\n= D{Xi } ({Yi }, {M \u00d7X Xi }) = X\n\nas required. We leave the case of M (Y ) and so on to the reader.\n\nProposition 6.8. If Y is a coalgebraic formal scheme over X, then the free\nAbelian monoid scheme M + (Y ) exists. If Y also has a specified section 0 : X \u2212\n\u2192Y\nb X ) then N + (Y ) exists.\n(making it an object of Based X\n\nProof. By the previous proposition, we may assume that X is informal, and\nthat Y = schX (U ) for some coalgebra U over R = OX with a good basis {ei | i \u2208 I}.\nWe know from Example\nthat YXk /\u03a3k is a strong colimit for the action of\n` 4.65\nk\nk\n\u03a3k on YX . Moreover, k Y /\u03a3k exists as a strong coproduct by Corollary 4.42.\n`\nWe conclude from Proposition 6.4 that M + (Y ) = k Y k /\u03a3k . In the based case,\nwe observe that the diagram {Y k /\u03a3k } is just indexed by N and thus is filtered,\nb X by Proposition 4.12. Given this,\nand filtered colimits exists and are strong in X\nProposition 6.5 completes the proof.\n\nRemark 6.9. If X is informal we see that the coalgebra cM + (Y ) is just the\nsymmetric algebra generated by cY over OX . In the based case, if e0 \u2208 cY is the\nbasepoint then cN + (Y ) = cM + (Y )/(e0 \u2212 1).\nWe next show that in certain cases of interest, the free Abelian monoid N + (Y )\nconstructed above is actually a group.\nDefinition 6.10. A good filtration of a coalgebra U over a ring R is a sequence\nof submodules Fs U for s \u2265 0 such that\n(a) \u01eb : F0 U \u2212\n\u2192 A is an isomorphism.\n(b) For s > 0 the quotient Gs U = Fs U/Fs\u22121 U is a finitely generated free module\nover\nS R.\n(c) s Fs U = U\nP\n(d) \u03c8(Fs U ) \u2286 s=t+u Fs U \u2297 Ft U .\n\nWe write C\u2032\u2032 = C\u2032\u2032R = C\u2032\u2032Z for the category of coalgebras that admit a good filtration.\n\u01eb\u22121\n\nGiven a good filtration, we write \u03b7 for the composite A \u2212\u2212\u2192 F0 U \u058c U . One can\ncheck that this is a coalgebra map, so it makes U into a based coalgebra. A good\nbasepoint for U is a basepoint which arises in this way. We say that a very good\nbasis for U is a basis {e0 , e1 , . . . } for U over R such that\n(i) e0 = \u03b7(1)\n(ii) \u01eb(ei ) = 0 for i > 0\n(iii) There exist integers Ns such that {ei | i < Ns } is a basis for Fs U .\nOne can check that very good bases exist, and that a very good basis is a good\nbasis.\n\n\f66\n\nNEIL P. STRICKLAND\n\nProposition 6.11. If U and V lie in C\u2032\u2032Z then so do U \u00d7 V and U k /\u03a3k . If we\nchoose a good basepoint for U then we can define N + (U ), and it again lies in C\u2032\u2032Z .\nProof. Choose good filtrations\non U and V . Define a filtration on U \u00d7 V =\nP\nU \u2297 V by setting Fs (U \u2297 V ) = s=t+u Ft U \u2297 Fu V . It is not hard to check that this\nis good. Essentially the same procedure gives a filtration of U \u2297m . This is invariant\nunder the action of the symmetric group \u03a3m , so we get an induced filtration of the\n. Our filtrations on these groups are compatible as m\ngroup of coinvariants U\u03a3\u2297m\nm\nvaries, so we get an induced filtration of N (U ) = lim U\u03a3\u2297m\n. Using a very good\nm\n-\u2192 m\n\nbasis for U and the associated monomial basis for N (U ), we can check that the\nfiltration of N (U ) is good.\nProposition 6.12. Let U be an Abelian monoid object in CZ , with addition\nmap \u03c3 : U \u00d7 U = U \u2297 U \u2212\n\u2192 U . If U admits a good filtration such that the basepoint\nis good and \u03c3(Fs U \u2297 Ft U ) \u2286 Fs+t U for all s, t \u2265 0, then U is actually an Abelian\ngroup object.\nProof. First note that we can use \u03c3 to make U into a ring. We need to\nconstruct a negation map (otherwise known as an antipode) \u03c7 : U \u2212\n\u2192 U , which\nmust be a coalgebra\nmap\nsatisfying\n\u03c3(1\n\u2297\n\u03c7)\u03c8\n=\n\u03b7\u01eb.\nIn\nterms\nof\nelements,\nif\nP\nP\n\u03c8(a) = 1 \u2297 a + a\u2032 \u2297 a\u2032\u2032 then the requirement is that \u03c7(a) = \u03b7\u01eb(a) \u2212 a\u2032 \u03c7(a\u2032\u2032 ).\nThe idea is to use this formula to define \u03c7 on Fs U by recursionPon s.\ns\n\u2192 U \u2297 U . Note that \u03c8(Fs U ) \u2286 t=0 Fs\u2212t U \u2297 Ft U ,\nWrite \u03c8 = \u03c8 \u2212 \u03b7 \u2297 1 : U \u2212\nand\nP that (\u01eb \u2297 1)\u03c8 = 0. Choose a very good basis {ei } for U , and write \u03c8(ei ) =\nj,k aijk ej \u2297 ek . Suppose that Ns\u22121 \u2264 i < Ns , so that ei \u2208 Fs U \\ Fs\u22121 U . If j > 0\nand k \u2265 Ns\u22121 then ej \u2297 ek 6\u2208 Fs (U \u2297 U ) so aijk = 0. On the other hand, the\nP\nequation (\u01eb \u2297 1)\u03c8(ei ) = 0 gives m ai0m em = 0 for all m, so ai0k = 0, so aijk = 0\nfor all j. This applies for all k \u2265 Ns\u22121 , and thus in particular for k \u2265 i.\nWe now define \u03c7(ei ) recursively by \u03c7(e0 ) = e0 and\nX\n\u03c7(ei ) = \u2212\naijk ej \u03c7(ek )\n0\u2264k<i\n\nP\nfor i > 0. By the previous paragraph, we actually have \u03c7(ei ) = \u2212 k\u22650 aijk ej \u03c7(ek ),\nand it follows that \u03c3(1 \u2297 \u03c7)\u03c8 = \u03b7\u01eb as required. We still have to check that \u03c7 is\na coalgebra map. For the counit, it is clear that \u01eb\u03c7(e0 ) = \u01eb(e0 ). If we assume\ninductively that \u01eb(\u03c7(ek )) = \u01eb(ek ) = 0 for 0 < k < i then we find that\nX\n\u01eb\u03c7(ei ) = \u2212\naijk \u01eb(ej )\u01eb\u03c7(ek ) = ai00 = (\u01eb \u2297 \u01eb)\u03c8(ei ) = \u01eb(ei ) = 0.\n0\u2264k<i\n\nA similar, but slightly more complicated, induction shows that \u03c8\u03c7 = (\u03c7 \u2297 \u03c7)\u03c8, so\n\u03c7 is a coalgebra map as required.\n\nProposition 6.13. Let C be a pointed formal curve over a formal scheme X.\nThen there are natural isomorphisms\nM + (C) = Div+ (C)\nN + (C) = N (C) = Div0 (C)\nM (C) = Div(C).\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n67\n\nProof. This follows easily from the constructions in Section 6.1 and the results\nabove.\n6.3. Schemes of homomorphisms.\nDefinition 6.14. Given formal groups G and H over X and a ring R, we let\nHomX (G, H)(R) be the set of pairs (x, u), where x \u2208 X(R) and u : Gx \u2212\n\u2192 Hx is a\nhomomorphism of formal groups over spec(R). This is a subfunctor of MapX (G, H),\nso we have defined an object HomX (G, H) \u2208 F. It is not hard to define an equaliser\ndiagram\nHomX (G, H) \u2212\n\u2192 MapX (G, H)\n\nd0\nd1\n\nw Map\n\nX (G\n\n\u00d7X G, H).\n\nIn more detail, note that a point of MapX (G, H) is a map x : spec(R) \u2212\n\u2192 X together\nwith a map f : Gx \u2212\n\u2192 Hx of schemes over spec(R). Given such a pair (x, f ), we\ndefine g, h : Gx \u00d7spec(R) Gx \u2212\n\u2192 Hx by g(a, b) = f (a + b) and h(a, b) = f (a) + f (b),\nand then we define di by d0 (f ) = g and d1 (f ) = h.\nProposition 6.15. Let G and H be formal groups over X. If G is finite and\nvery flat over X, or if G is coalgebraic and H is relatively informal, or if G is very\nflat and H is of finite presentation, then HomX (G, H) is a formal scheme and there\nis a natural isomorphism\nbX.\nfor all Y \u2208 X\n\nb X (Y, HomX (G, H)) = Ab X\nb Y (G \u00d7X Y, H \u00d7X Y )\nX\n\nProof. Theorem 4.69 tells us that MapX (G, H) and MapX (G \u00d7X G, H) are\nb X is closed under finite limits in F, so HomX (G, H) is a\nformal schemes, and X\nformal scheme. The natural isomorphism comes from the Yoneda lemma when Y\nis informal, and follows in general by passage to colimits.\nb a be the additive formal group (over the terminal scheme\nExample 6.16. Let G\nb a (R) = Nil(R), with the usual addition. Thus, the\n1 = spec(Z)) defined by G\nb\nb 1 . This is coalgebraic over 1, so we see that\nunderlying scheme of Ga is just A\nb\nb\nb\nb1 \u00d7 Y \u2212\nb1 \u00d7 Y\nEnd(Ga ) = Hom1 (Ga , Ga ) exists. One checks that any map A\n\u2192 A\nover Y is given by a unique power series f (x) \u2208 OY [[x]] such that f (0) is nilpotent.\nb a )(R) is the set of power series f \u2208 R[[x]] such that\nIt follows easily that End(G\nf (x + y) = f (x) + f (y) \u2208 R[[x, y]]. If R is an algebra over Fp , then a well-known\nlemma says that f (x + y) = f (x) + f (y) if and only if f can be written in the form\nP\nk\nf (x) = k ak xp , for uniquely determined coefficients ak \u2208 R. One can deduce\nb a ) = spec(Fp [ak | k \u2265 0]).\nthat spec(Fp ) \u00d7 End(G\nExample 6.17. A similar analysis shows that End(Gm )(R) is the set of Laurent polynomials\nf \u2208 R[u\u00b11 ] such that f (u)f (v) = f (uv) and f (1) = 1. If\nP\nf (u) P\n= k ek uk , we find that the elements ek \u2208 R are orthogonal idempotents\nwith k ek = 1. It follows that End(Gm ) is the constant formal scheme Z, with\nthe n'th piece in the coproduct corresponding to the endomorphism u 7\u2192 un .\n\nb a , Gm ). In this\nExample 6.18. We can also form the scheme\n= Hom(G\nP Exp\n[k] k\ncase, Exp(R) is the set of power series f (x) = k a x such that f (0) = 1 and\n\n\f68\n\nNEIL P. STRICKLAND\n\n\u0012\n\n\u0013\ni+j\na[i+j] . In other\ni\nwords, a point of Exp(R) is an element a = a[1] of R together with a specified system\nof divided powers for a. Clearly, if R is a Q-algebra then there is a unique possible\nsystem of divided powers, viz. a[k] = ak /k!, so spec(Q) \u00d7 Exp \u2243 spec(Q) \u00d7 A1 .\nNow let R be an Fp -algebra. Given an element a \u2208 R with ap = 0, we define\nPp\u22121 j j\nT (a)(x) =\nj=0 a x /j!; it is not hard to see that T (a) \u2208 Exp(R). Given a\nQ\ni\nsequence of such elements a = (a0 , a1 , . . . ), we define T (a)(x) = i T (ai )(xp ); it\nis not hard to check that the product is convergent in the x-adic topology on R[[x]],\n\u2192 spec(Fp ) \u00d7 Exp.\nand that T (a) \u2208 Exp(R). Thus T defines a map spec(Fp ) \u00d7 DpN \u2212\nIt can be shown that this is an isomorphism.\nMore generally, we have Exp = spec(DZ [a]), where DZ [a] is the divided-power\nalgebra on one generator a over Z. The previous paragraph is equivalent to the fact\nk\nthat DFp [a] = DZ [a]/p = Fp [ak | k \u2265 0]/(apk ), where ak = a[p ] .\nf (x+y) = f (x)f (y), or equivalently a[0] = 1 and a[i] a[j] =\n\n6.4. Cartier duality. Let G be a coalgebraic commutative formal group over\na formal scheme X. By Proposition 6.15, we can define the group scheme DG =\nHomX (G, Gm \u00d7 X). We call this the Cartier dual of G. Note also that the product\nstructure on G makes cG into commutative group in the category of coalgebras, in\nother words a Hopf algebra, and in particular an algebra over OX . We can thus\ndefine H = spec(cG), which is an informal scheme over X. The coproduct on\ncG gives a product on H, making it into a group scheme over X. Moreover, we\nknow that cG is a free module over OX , so that H is very flat over OX . Thus, by\nProposition 6.15, we can define a formal group scheme DH = HomX (H, Gm \u00d7 X).\nWe again call this the Cartier dual of H. These definitions appear in various levels\nof generality in many places in the literature; the treatment in [3] is similar in spirit\nto ours, although restricted to the case where OX is a field.\nProposition 6.19. If G and H are as above, then DG = H and DH = G.\nProof. First suppose that X = spec(R) is informal. We shall analyse the\nb X (X, DG) of sections of the map DG \u2212\nset X\n\u2192 X. From the definitions, we see\nthat a section of the map DG \u2212\n\u2192 X is the same as a map G \u2212\n\u2192 Gm \u00d7 X of\nformal groups over X, or equivalently a map of Hopf algebras OGm \u00d7X \u2212\n\u2192 OG . As\nOGm \u00d7X = R[u\u00b11 ] with \u01eb(u) = 1 and \u03c8(u) = u \u2297 u, such a map is equivalent to an\nelement v \u2208 O\u00d7\nG with \u01eb(v) = 1 and \u03c8(v) = v \u2297 v. In fact, if v is any element with\n\u01eb(v) = 1 and \u03c8(v) = v \u2297 v then the Hopf algebra axioms imply that v\u03c7(v) = 1 so\nwe do not need to require separately that v be invertible. As G is coalgebraic we\nhave OG = HomR (cG, R), so we can regard v as a map cG \u2212\n\u2192 R of R-modules. The\nconditions \u01eb(v) = 1 and \u03c8(v) = v \u2297 v then become v(1) = 1 and v(ab) = v(a)v(b),\nb X (X, H).\nso the set of such v's is just AlgR (cG, R) = X\nNow let X be arbitrary. The above (together with the commutation of various constructions with pullbacks, which we leave to the reader) shows that for\nb X (W, DG) = X\nb W (W, D(G \u00d7X W )) =\nany informal scheme W over X we have X\nb\nb\nXW (W, H \u00d7X W ) = XX (W, H). It follows that DG = H as claimed.\nWe now show that DH = G. Just as previously, we may assume that X =\nspec(R) is informal, and it is enough to show that DH and G have the same sections.\nAgain, the sections of DH are just the elements v \u2208 OH = cG with \u01eb(v) = 1 and\n\u03c8(v) = v \u2297 v. In this case, we identify cG with the continuous dual of OG , so v is\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n69\n\na continuous map OG \u2212\n\u2192 R of R-algebras, and thus a section of spf(OG ) = G as\nrequired.\n6.5. Torsors. Let G be a formal group over a formal scheme X. Let T be\na formal scheme over X with an action of G. More explicitly, we have an action\nmap \u03b1 : G \u00d7X T \u2212\n\u2192 T , so whenever g and t are points of G and T with the same\nimage in X, we can define g.t = \u03b1(g, t). This is required to satisfy 1.t = t and\ng.(h.t) = (gh).t (whenever g, h and t all have the same image in X). We write\nb X for the category of such T . Note that G itself can be regarded as an object\nGX\nbX.\nof GX\nIf Y is a scheme with a specified map p : Y \u2212\n\u2192 X we shall allow ourselves to write\n\u2217\nb\nb\nbX \u2212\nbY .\nGXY instead of (p G)XY . It is easy to see that p\u2217 gives a functor GX\n\u2192 GX\nDefinition 6.20. Let G be a formal group over a formal scheme X, and let T\nbe a formal scheme over X with an action of G. We say that T is a G-torsor over\nb Y . We\nX if there exists a faithfully flat map p : Y \u2212\n\u2192 X such that p\u2217 T \u2243 p\u2217 G in GX\nwrite GTX for the category of G-torsors over X.\n\nExample 6.21. Let M be a vector bundle over X of rank d, and let Bases(M )\nbe as in Example 2.85. Let GLd be the group scheme of invertible d \u00d7 d matrices.\nThen GLd \u00d7X acts on Bases(M ), and if M is free then Bases(M ) \u2243 GLd \u00d7X. As\nwe can always pull back along a faithfully flat map p : Y \u2212\n\u2192 X to make M free, and\nBases(p\u2217 M ) = p\u2217 Bases(M ), we find that Bases(M ) is a torsor for GLd \u00d7X.\nExample 6.22. Let C be a pointed formal curve over X, let Coord(C) be as\nin Definition 5.10, and let IPS be as in Example 2.9. Then Coord(C) is a torsor\nfor group scheme IPS \u00d7 X. In fact, this torsor is trivialisable (i.e. isomorphic to\nIPS \u00d7 X even without pulling back) but not canonically so.\nProposition 6.23. Every morphism in GTX is an isomorphism, so GTX is a\ngroupoid.\nProof. First, let u : G \u2212\n\u2192 G be a map of G-torsors. As u is G-equivariant we\nhave u(g) = g.u(1), so h 7\u2192 h.u(1)\u22121 is an inverse for u. Now let u : S \u2212\n\u2192 T be\nan arbitrary map of G-torsors. Then there is a faithfully flat map p : Y \u2212\n\u2192 X such\nthat p\u2217 S \u2243 p\u2217 T \u2243 p\u2217 G, so the first case tells us that p\u2217 u is an isomorphism. As p\nis faithfully flat, we see that p\u2217 reflects isomorphisms, so u is an isomorphism.\nProposition 6.24. Every homomorphism \u03c6 : G \u2212\n\u2192 H of formal groups over X\ngives rise to functors\nbX \u2212\nbX\n\u03c6\u2022 : H X\n\u2192 GX\n\n\u03c6\u2022 : GTX \u2212\n\u2192 HTX ,\nsuch that\n\nbX.\nfor all U \u2208 H X\n\nb X (\u03c6\u2022 T, U ) = GX\nb X (T, \u03c6\u2022 U )\nHX\n\n\f70\n\nNEIL P. STRICKLAND\n\nProof. The functor \u03c6\u2022 is just \u03c6\u2022 U = U , with G-action g.u := \u03c6(g).u. Let\n\u03c6\u2022 T be the coequaliser of the maps (h, g, t) 7\u2192 (h\u03c6(g), t) and (h, g, t) 7\u2192 (h, g.t)\nfrom H \u00d7X G \u00d7X T to H \u00d7X T . Note that these maps have a common splitting\n(h, t) 7\u2192 (h, 1, t), so we have a reflexive fork. In the case T = G, the coequaliser is\njust the map H \u00d7X G \u2212\n\u2192 H given by (h, g) 7\u2192 h\u03c6(g). In fact, this coequaliser is\nsplit by the maps h 7\u2192 (h, 1) and (h, g) 7\u2192 (h, g, 1), so it is a strong coequaliser.\nNow consider a general G-torsor T . We claim that the coequaliser that defines\n\u03c6\u2022 T is strong. By proposition 2.69, we can check this after pulling back along a\nfaithfully flat map p : Y \u2212\n\u2192 X. We can choose p so that p\u2217 T \u2243 p\u2217 G, and then the\nclaim follows from the previous paragraph.\nWe can let H act on the left on H \u00d7X G \u00d7X T and H \u00d7X G, and then the maps\nwhose coequaliser defines \u03c6\u2022 T are both H-equivariant. The reader can easily check\nb X has a strong coequaliser in X\nb X then the coequaliser has a\nthat if a fork in H X\nb\nunique H-action making it the coequaliser in H XX . This implies that \u03c6\u2022 T is the\nb X , and one can deduce that\ncoequaliser of our fork in H X\nb X (\u03c6\u2022 T, U ) = GX\nb X (T, \u03c6\u2022 U )\nHX\nbX.\nfor all U \u2208 H X\nAll that is left is to check that \u03c6\u2022 T is a torsor. For this, we just choose a\nfaithfully flat map p such that p\u2217 T \u2243 p\u2217 G, and observe that p\u2217 \u03c6\u2022 T = \u03c6\u2022 p\u2217 T \u2243\np\u2217 H.\n\nProposition 6.25. If G is an Abelian formal group over X, then there is a\nfunctor \u2297 : GTX \u00d7 GTX \u2212\n\u2192 GTX which makes GTX into a symmetric monoidal\ncategory with unit G. Moreover, the twist map of T \u2297 T is always the identity, and\nevery object is invertible under \u2297, so that GTX is a strict Picard category.\nProof. If S and T are G-torsors over X, then it is easy to see that S \u00d7X T has\na natural structure as a G \u00d7X G-torsor. As G is Abelian, the multiplication map\n\u03bc : G\u00d7X G \u2212\n\u2192 G is a homomorphism, so we can define S\u2297T = \u03bc\u2022 (S\u00d7X T ). We leave\nit to the reader to check that this gives a symmetric monoidal structure with unit\nG. If we let \u03c7 : G \u2212\n\u2192 G denote the map g 7\u2192 g \u22121 then \u03c7 is also a homomorphism,\nso we can define T \u22121 = \u03c7\u2022 T . We then have T \u2297 T \u22121 = (\u03bc(1 \u00d7 \u03c7))\u2022 (T \u00d7X T ) =\n0\u2022 (T \u00d7X T ) = G, so T \u22121 is an inverse for T . Finally, we need to show that the\ntwist map \u03c4 : T \u2297 T \u2212\n\u2192 T \u2297 T is the identity. As the map q : T \u00d7X T \u2212\n\u2192 T \u2297 T is a\nregular epimorphism, it suffices to show that \u03c4 q = q, and clearly \u03c4 q(a, b) = q(b, a)\nso we need to show that q(a, b) = q(b, a). In the case T = G we have T \u2297 T = G\nand the map q is just q(a, b) = ab, so the claim holds. For general T , we just pull\nback along a faithfully flat map p such that p\u2217 T \u2243 p\u2217 G and use the fact that p\u2217 is\nfaithful.\nProposition 6.26. Let Gm denote the multiplicative group, which is defined\nby Gm (R) = R\u00d7 . Then the functor L 7\u2192 A(L)\u00d7 (as in Definition 2.55 and Remark 4.43) is an equivalence from the category of line bundles over X and isomorphisms, to the category of Gm -torsors over X. Moreover, this equivalence respects\ntensor products.\nProof. Let L be a line bundle over X. For any x \u2208 X(R), we have a rank\none projective module Lx over R, and clearly R\u00d7 = Gm (R) acts on the set of\nbases for Lx (even though this set may be empty). If L is free then it is clear\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n71\n\nthat A(L)\u00d7 \u2243 A(O)\u00d7 = Gm \u00d7 X, and thus that A(L)\u00d7 is a torsor. In general,\nwe know from Proposition 4.55 that L is fpqc-locally isomorphic to O, so A(L)\u00d7 is\nfpqc-locally isomorphic to A(O)\u00d7 = Gm \u00d7 X, and thus is a torsor.\nIn the opposite direction, let T be a Gm -torsor over X. Define a formal scheme\nA over X by the coequaliser\nA1 \u00d7 G m \u00d7 T\n\n\u03bb\n\u03c1\n\nwA\n\n1\n\n\u00d7T \u2212\n\u2192 A,\n\nwhere \u03bb(a, u, t) = (au, t) and \u03c1(a, u, t) = (a, ut). Locally in the flat topology we may\nassume that T = Gm \u00d7X, and it is easy to check that A1 \u00d7X is the split coequaliser\nof the fork. Thus Proposition 2.69 tells us that A is the strong coequaliser of the\noriginal fork. Also, we can make A1 \u00d7Gm \u00d7T and A1 \u00d7T into modules over the ring\nscheme A1 . As the functor A1 \u00d7 (\u2212) preserves our coequaliser, the formal scheme\nA is also a module over A1 . This means that if we define Lx to be the preimage of\nx \u2208 X(R) under the map A(R) \u2212\n\u2192 X(R), then Lx is an R-module. Locally on X\nwe have T \u2243 Gm \u00d7 X and thus A \u2243 A1 and thus Lx \u2243 R. One can deduce that L\nis a line bundle over X, with A(L) = A and thus A(L)\u00d7 = T .\nWe leave it to the reader to check that this gives an equivalence of categories,\nwhich preserves tensor products.\n7. Ordinary formal groups\nRecall that an ordinary formal group over a scheme X is a formal group G over\nb 1 as a formal scheme over X. In particular, G is\nX that is isomorphic to X \u00d7 A\na pointed formal curve over X, so we can choose a normalised coordinate x on G\nb X . However, for the usual reasons\nb 1 \u00d7 X in Based X\ngiving an isomorphism G \u2243 A\nit is best to proceed as far as possible in a coordinate-free way. Lazard's book [17]\ngives an account in this spirit, but in a somewhat different framework.\nIf we do choose a coordinate x on G then we have a function (g, h) 7\u2192 x(g + h)\nb 1 . As G \u00d7X G \u2243 A\nb 2 \u00d7 X, we see that this can be written\nfrom G \u00d7X G to A\nP\ni\nj\nuniquely in the form x(g + h) =\ni,j aij x(g) x(h) = Fx (x(g), x(h)) for some\npower series Fx (s, t) \u2208 OX [[s, t]]. It is easy to see that this is a formal group law\n(Example 2.6), so we get a map X \u2212\n\u2192 FGL. This construction gives a canonical map\nCoord(G) \u2212\n\u2192 FGL. We can let the group scheme IPS act on FGL as in Example 2.9,\nand on Coord(G) by f.x = f (x). It is easy to see that the map Coord(G) \u2212\n\u2192 FGL\nis IPS-equivariant.\nDefinition 7.1. Let G be a formal group over an affine scheme X. Let I be\nthe ideal in OX of functions g : X \u2212\n\u2192 A1 such that g(0) = 0.\n2\nDefine \u03c9G = \u03c9G/X = I/I , and let d0 (g) denote the image of g in \u03c9G/X . We\nalso define\nPrim(\u03a91G/X ) = {\u03b1 \u2208 \u03a91G/X | \u03c3 \u2217 \u03b1 = \u03c00\u2217 \u03b1 + \u03c01\u2217 \u03b1 \u2208 \u03a9G\u00d7X G/X }.\nHere \u03c00 , \u03c01 : G \u00d7X G \u2212\n\u2192 G are the two projections, and \u03c3 : G \u00d7X G \u2212\n\u2192 G is the\naddition map.\nWe now give a formal version of the fact that left-invariant differential forms\non a Lie group biject with elements of the cotangent space at the identity element.\nProposition 7.2. \u03c9G/X is a free module on one generator over OX . Moreover,\nthere are natural isomorphisms \u03c9G/X \u2243 Prim(\u03a91G/X ) and \u03a91G/X = OG \u2297OX \u03c9G/X .\n\n\f72\n\nNEIL P. STRICKLAND\n\nProof. Let x be a normalised coordinate on G. We then have OG = OX [[x]],\nand it is easy to check that I = (x) so I 2 = (x2 ) so \u03c9G/X is freely generated over\nOX by d0 (x).\nNow let K be the ideal in OG\u00d7X G of functions k such that k(0, 0) = 0. In terms\nof the usual description OG\u00d7X G = OX [[x\u2032 , x\u2032\u2032 ]], this is just the ideal generated by\nx\u2032 and x\u2032\u2032 . Given g \u2208 I, we define \u03b4(g)(u, v) = g(u + v) \u2212 g(u) \u2212 g(v). We claim\nthat \u03b4(g) \u2208 K 2 . Indeed, we clearly have \u03b4(g)(0, v) = 0, so \u03b4(g) is divisible by x\u2032 .\nWe also have \u03b4(g)(u, 0) = 0, so \u03b4(g) is divisible by x\u2032\u2032 . It follows easily that \u03b4(g) is\ndivisible by x\u2032 x\u2032\u2032 and thus that it lies in K 2 as claimed.\nNext, let J be the ideal of functions on G \u00d7X G that vanish on the diagonal\n(so we have \u03a91G/X = J/J 2 ). For any function g \u2208 I we define \u03bb(g) \u2208 J by\n\u03bb(g)(u, v) = g(u \u2212 v). As g(0) = 0 we see that \u03bb(g) \u2208 J, so \u03bb induces a map\n\u03c9G/X \u2212\n\u2192 \u03a91G/X . We claim that \u03bb(g) \u2208 Prim(\u03a91G/X ). To make this more explicit,\nlet L be the ideal of functions l on G4X such that l(s, s, u, u) = 0. The claim is that\n\u03c3 \u2217 \u03bb(g) \u2212 \u03c00\u2217 \u03bb(g) \u2212 \u03c01\u2217 \u03bb(g) = 0 in L/L2, or equivalently that the function\nk : (s, t, u, v) 7\u2192 \u03bb(g)(s + u, t + v) \u2212 \u03bb(g)(s, t) \u2212 \u03bb(g)(u, v)\n\nlies in L2 . To see this, note that k = \u03b4(g) \u25e6 \u03b8, where \u03b8(s, t, u, v) = (s \u2212 t, u \u2212 v). It\nis clear that \u03b8\u2217 K \u2282 L and thus that \u03b8\u2217 K 2 \u2282 L2 , and we have seen that \u03b4(g) \u2208 K 2\nso k \u2208 L2 as claimed. Thus, we have a map \u03bb : \u03c9G/X \u2212\n\u2192 Prim(\u03a91G/X ).\nNext, given a function h(u, v) in J, we have a function \u03bc(h)(u) = h(u, 0) in\n\u2192 \u03c9G/X with \u03bc \u25e6 \u03bb = 1. Now suppose\nI. It is clear that \u03bc induces a map \u03a91G/X \u2212\n1\nthat h gives an element of Prim(\u03a9G/X ) and that \u03bc(h) \u2208 I 2 . Define k(s, t, u, v) =\nh(s + u, t + v) \u2212 h(s, t) \u2212 h(u, v). The primitivity of h means that k \u2208 L2 . Define\n\u03c6 : G \u00d7X G \u2212\n\u2192 G \u00d7X G \u00d7X G \u00d7X G by \u03c6(s, t) = (t, t, s \u2212 t, 0). One checks that\n\u03c6\u2217 L \u2286 J and that\nh(s, t) = k(t, t, s \u2212 t, 0) + h(t, t) + h(s \u2212 t, 0).\n\nNoting that h(t, t) = 0, we see that h = \u03c6\u2217 k + \u03c8 \u2217 \u03bc(h), where \u03c8(u, v) = u \u2212 v. As\n\u03bc(h) \u2208 I 2 and k \u2208 L2 we conclude that h \u2208 J 2 . This means that \u03bc is injective on\nPrim(\u03a91G/X ). As \u03bc\u03bb = 1, we conclude that \u03bb and \u03bc are isomorphisms.\nFinally, we need to show that the map f \u2297 \u03b1 7\u2192 f \u03bb(\u03b1) gives an isomorphism\n\u2192 \u03a91G/X . As \u03a91G/X is freely generated over OG by d(x), we must\nOG \u2297OX \u03c9G/X \u2212\nhave \u03bb(d0 (x)) = u(x)d(x) for some power series u. As \u03c9G/X is freely generated\nover OX by d0 (x), it will suffice to check that u is invertible, or equivalently that\nu(0) is a unit in OX . To see this, observe that \u03bc(f d(g)) = f (0)d0 (g), so that\nd0 (x) = \u03bc\u03bb(d0 (x)) = \u03bc(u(x)d(x)) = u(0)d0 (x), so u(0) = 1.\nMore explicitly, let F be the formal group law such that x(a+b) = F (x(a), x(b)),\nand define H(s) = D2 F (s, 0), where D2 F is the partial derivative with respect to\nthe second variable. We observe that H(0) = 1, so H is invertible in R[[s]]. We then\ndefine \u03b1 = H(x)\u22121 dx \u2208 \u03a91G/X . One can check that, in the notation of the above\nproof, we have \u03b1 = \u03bb(d0 (x)), and thus that \u03b1 generates Prim(\u03a91G/X ).\n7.1. Heights.\nProposition 7.3. Let G and H be ordinary formal groups over an affine\nscheme X, and let s : G \u2212\n\u2192 H be a homomorphism. Suppose that the induced\nmap s\u2217 : \u03c9H \u2212\n\u2192 \u03c9G is zero.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n73\n\n(a) If X is a scheme over spec(Q), then s = 0.\n(b) If X is a scheme over spec(Fp ) for some prime p then there is a unique\n\u2217\nG\u2212\n\u2192 H of formal groups over X such that s = s\u2032 \u25e6\nhomomorphism s\u2032 : FX\nFG/X .\nProof. It follows from the definitions that our identification of \u03c9G/X with\nPrim(\u03a9G/X ) is natural for homomorphisms. Thus, if \u03b1 \u2208 Prim(\u03a9H/X ) then s\u2217 \u03b1 =\n0. We also know that \u03a9H/X = OH \u2297OX \u03c9H/X , so any element of \u03a9H/X can be\nwritten as f \u03b1 with f \u2208 Prim(\u03a9H/X ). Thus s\u2217 (f \u03b1) = (f \u25e6 s).s\u2217 \u03b1 = 0. Thus,\nProposition 5.32 applies to s. If X lies over spec(Q) then we conclude that s\nis constant on each fibre. As it is a homomorphism, it must be the zero map.\nSuppose instead that X lies over spec(F p). In that case we know that there is\n\u2217\na unique map s\u2032 : G\u2032 = FX\nG \u2212\n\u2192 H such that s = s\u2032 \u25e6 FG/X , and we need only\ncheck that this is a homomorphism. In other words, we need to check that the map\nt\u2032 (u, v) = s\u2032 (u + v) \u2212 s\u2032 (u) \u2212 s\u2032 (v) (from G\u2032 \u00d7X G\u2032 to H) is zero. Because s and\nFG/X are homomorphisms, we see that t\u2032 \u25e6 FG\u00d7X G/X = 0 : G \u00d7X G \u2212\n\u2192 H. Using\nthe uniqueness clause in Proposition 5.32, we conclude that t\u2032 = 0 as required.\nCorollary 7.4. Let G and H be ordinary formal groups over an affine scheme\nX, which lies over spec(Fp ). Let s : G \u2212\n\u2192 H be a homomorphism. Then either\nn \u2217\ns = 0 or there is an integer n \u2265 0 and a homomorphism s\u2032 : (FX\n) G\u2212\n\u2192 H such\n\u2032\nn\n\u2032 \u2217\nthat s = s \u25e6 FG/X and (s ) is nonzero on \u03c9H/X .\nProof. Suppose that there is a largest integer n (possibly 0) such that s can\nn\nn \u2217\nbe factored in the form s = s\u2032 \u25e6 FG/X\n. Write G\u2032 = (FX\n) G, so that s\u2032 : G\u2032 \u2212\n\u2192 H. If\n\u2032 \u2217\n(s ) = 0 on \u03c9H/X then the proposition gives a factorisation s\u2032 = s\u2032\u2032 \u25e6 FG\u2032 /X and\nn+1\nthus s = s\u2032\u2032 \u25e6 FG/X\ncontradicting maximality. Thus (s\u2032 )\u2217 6= 0 as claimed. On the\nother hand, suppose that there is no largest n. Choose coordinates x and y on G\nand H, so there is a series g such that y(s(u)) = g(x(u)) for all points u of G. As\nn\ns is a homomorphism we have g(0) = 0. If s factors through FG/X\nwe see that\npn\ng(x) = h(x ) for some series h. As this happens for arbitrarily large n, we see\nthat g is constant. As g(0) = 0 we conclude that g = 0 and thus s = 0.\nDefinition 7.5. Let G and H be ordinary formal groups over an affine scheme\nX, which lies over spec(Fp ). Let s : G \u2212\n\u2192 H be a homomorphism. If s = 0, we say\nthat s has infinite height. Otherwise, the height of s is defined to be the integer n\noccurring in Corollary 7.4. The height of the group G is defined to be the height\nof the endomorphism pG : G \u2212\n\u2192 G (which is just p times the identity map).\nDefinition 7.6. Let G be an ordinary formal group over an affine scheme X.\nLet Xn be the largest closed subscheme of X on which G has height at least n, and\nn \u2217\nwrite Gn = G \u00d7X Xn . We then have a map sn : Hn = (FX\n) Gn \u2212\n\u2192 Gn such that\nn\n\u2192 \u03c9Hn of trivialisable line bundles over\n, and thus a map s\u2217n : \u03c9Gn \u2212\npGn = sn \u25e6 FG/X\nXn . If we trivialise these line bundles then s\u2217n becomes an element un \u2208 OXn , which\nis well-defined up to multiplication by a unit, and Xn+1 = V (un ) = spec(OXn /un ).\nNote also that u0 = p.\nWe say that G is Landweber exact if for all p and n, the element un is not a\nzero-divisor in OXn . Because X0 = X and u0 = p, this implies in particular that\nOX is torsion-free.\n\n\f74\n\nNEIL P. STRICKLAND\n\n7.2. Logarithms.\nDefinition 7.7. A logarithm for an ordinary formal group G is a map of formal\nb 1 satisfying u(g + h) = u(g) + u(h), or in other words a homoschemes u : G \u2212\n\u2192A\nb\nmorphism G \u2212\n\u2192 Ga . A logarithm for a formal group law F over a ring R is a power\nseries f (s) \u2208 R[[s]] such that f (F (s, t)) = f (s) + f (t) \u2208 R[[s, t]]. Clearly, if x is a coordinate on G and F is the associated formal group law then logarithms for F biject\nwith logarithms for G by u(g) = f (x(g)). It is also clear that when u is a logarithm,\nb a) \u2212\nthe differential du lies in \u03c9G . We thus have a map d : Hom(G, G\n\u2192 A(\u03c9G ).\nb a) \u2212\nProposition 7.8. If OX is a Q-algebra then the map d : Hom(G, G\n\u2192\nA(\u03c9G ) is an isomorphism.\n\nProof. If u = f (x) is a logarithm and du = f \u2032 (x)dx = 0 then f is constant\n(because OX is rational so we can integrate) but f (0) = 0 (because u(0) = u(0+0) =\nu(0) + u(0)) so f = 0 so u = 0. Thus d is injective. Conversely, suppose that\n\u03b1 = g(x)dx \u2208 \u03c9G . Let f be the integral of g with f (0) = 0, so u = f (x) : G \u2212\n\u2192\n1\nb\nA and du = \u03b1. Consider the function w(g, h) = u(g + h) \u2212 u(g) \u2212 u(h), so\nb 1 and dw = \u03c3 \u2217 \u03b1 \u2212 \u03c0 \u2217 \u03b1 \u2212 \u03c0 \u2217 \u03b1 = 0. Thus w is constant and\nw : G \u00d7X G \u2212\n\u2192 A\n1\n2\nw(0, 0) = 0 so u(g + h) = u(g) + u(h) as required.\nCorollary 7.9. Any ordinary formal group over a scheme X over spec(Q) is\nisomorphic to the additive group A1 \u00d7 X.\n\n7.3. Divisors. An ordinary formal group G over X is in particular a pointed\nn\nformal curve over X, so it makes sense to consider the schemes Div+\nn (G) = GX /\u03a3n\nand so on. Moreover, Proposition 6.13 tells us that Div+ (G) = M + (G) and so on.\nProposition 7.10. The formal scheme Div+ (G) has a natural structure as a\nbX.\ncommutative semiring object in the category X\n\nProof. Everywhere in this proof, products really mean fibre products over X.\nWe define a map \u03bdi,j : Gi \u00d7 Gj \u2212\n\u2192 Gij by\n\u03bdi,j (a1 , . . . , ai , b1 , . . . , bj ) = (a1 + b1 , . . . , ai + bj ).\n\nUsing the fact that the colimits involved are strong, we see that there is a unique\nmap \u03bci,j : Gi /\u03a3i \u00d7 Gj /\u03a3j \u2212\n\u2192 Gij /\u03a3ij that is compatible with the maps \u03bdi,j in the\n+\ni\nevident sense. We can use the isomorphisms Div+\ni (G) = G /\u03a3i and Div (G) =\n`\n+\n+\n+\n\u2192\ni Div i (G) to piece these maps together, giving a map \u03bc : Div (G) \u00d7 Div (G) \u2212\nDiv+ (G). Given two divisors D and E we write\nD\n\u2217\nE\n=\n\u03bc(D,\nE).\nThe\nabove\nP\nP\nP\ndiscussion really just shows that the definition ( i [ai ]) \u2217 ( j [bj ]) = i,j [ai + bj ]\nmakes sense. It is easy to check (although tedious to write out in detail) that the\noperation \u2217 is associative and commutative, and that the divisor [0] is a unit for it,\nb X as\nand that it distributes over addition. Thus, Div+ (G) is a semiring object in X\nclaimed.\nRemark 7.11. One can also interpret and prove the statement that Div+ (G)\nb X , with\nis a graded \u03bb-semiring object in X\nn\nX\nX\n[ai1 + . . . + aik ].\n\u03bbk ( [ai ]) =\ni=1\n\ni1 <...<ik\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n75\n\nProposition 7.12. The formal scheme Div(G) has a natural structure as a\nbX.\ncommutative ring object in the category X\nProof. We know that Div(G) = M (G) is a group under addition. It thus\nmakes sense to define a map \u03bc(n, m) : Div+ (G) \u00d7X Div+ (G) \u2212\n\u2192 Div(G) by\n\u03bc(n, m)(D, E) = D \u2217 E \u2212 mE \u2212 nD + nm[0].\n\nIt is easy to check that\n\n\u03bc(n + i, m + j)(D + i[0], E + j[0]) = \u03bc(n, m)(D, E).\nRecall that Div(G) = lim Div+ (G), where the maps in the diagram are of the\n-\u2192 n\n\nform D 7\u2192 D + i[0]. This is a filtered colimit and thus a strong one, so Div(G) \u00d7X\nDiv(G) = lim\nDiv+ (G) \u00d7X Div+ (G), where the maps have the form (D, E) 7\u2192\n-\u2192 m,n\n\n(D + i[0], E + j[0]). It follows that the maps \u03bc(n, m) fit together to give a map\n\u03bc : Div(G) \u00d7X Div(G) \u2212\n\u2192 Div(G). We leave it to the reader to check that this\nproduct makes Div(G) into a ring object.\n8. Formal schemes in algebraic topology\nIn this section, we show how suitable cohomology theories give rise to functors\nfrom suitable categories of spaces to formal schemes. In particular, the space CP \u221e\ngives rise to a formal group G. We show how vector bundles over spaces give\nrise to divisors on G over the corresponding formal schemes, and we investigate\nthe schemes arising from classifying spaces of Abelian Lie groups. We then give a\nrelated construction that associates informal schemes to ring spectra. Using this\nwe relate the Thom isomorphism to the theory of torsors, and maps of ring spectra\nto homomorphisms of formal groups.\n8.1. Even periodic ring spectra. In this section, we define the class of\ncohomology theories that we wish to study. We would like to restrict attention to\ncommutative ring spectra, but unfortunately that would exclude some examples\nthat we really need to consider. We therefore make the following ad hoc definition,\nwhich should be ignored at first reading.\nDefinition 8.1. Let E be an associative ring spectrum, with multiplication\n\u03bc: E \u2227 E \u2212\n\u2192 E. A map Q : E \u2212\n\u2192 \u03a3d E is a derivation if we have\nQ \u25e6 \u03bc = \u03bc \u25e6 (1 \u2227 Q + Q \u2227 1).\n\nA ring spectrum E is quasi-commutative if there is a derivation Q of odd degree d\nand a central element v \u2208 \u03c02d E such that 2v = 0 and\n\u03bc \u2212 \u03bc \u25e6 \u03c4 = v\u03bc \u25e6 (Q \u2227 Q).\n\nNote that if 2 is invertible in \u03c0\u2217 E then v = 0 and E is actually commutative.\nDefinition 8.2. An even periodic ring spectrum is a quasi-commutative ring\nspectrum E such that\n1. \u03c01 E = 0\n2. \u03c02 E contains a unit.\nThis implies that \u03c0odd (E) = 0. Thus, the derivation Q in Definition 8.1 acts\ntrivially on E\u2217 , so E\u2217 is a commutative ring. Similarly, if X is any space such that\nE 1 X = 0 then E 0 X is commutative.\n\n\f76\n\nNEIL P. STRICKLAND\n\nExample 8.3. The easiest example is E \u2217 X = H \u2217 (X; Z[u\u00b11 ]), where we give u\ndegree 2. This is represented by the even periodic ring spectrum\n_\nHP =\n\u03a32k H.\nk\u2208Z\n\nExample 8.4. The next most elementary example is the complex K-theory\nspectrum KU . This is an even periodic ring spectrum, by the Bott periodicity\ntheorem. If p is a prime then we can smash this with the mod p Moore space to\nget a spectrum KU/p. It is true but not obvious that this is a ring spectrum. It is\ncommutative when p > 2, but only quasi-commutative when p = 2. The derivation\nQ in Definition 8.1 is just the Bockstein map \u03b2 : KU/2 \u2212\n\u2192 \u03a3KU/2.\nExample 8.5. Let M P be the Thom spectrum associated to the tautological\nvirtual bundle over Z \u00d7 BU . It is more usual to consider the connected component\nBU = W\n0 \u00d7 BU of Z \u00d7 BU , giving the Thom spectrum M U . It turns out that\nM P = k\u2208Z \u03a32k M U , and that this is an even periodic ring spectrum. Moreover,\na fundamental theorem of Quillen tells us that M P0 = L = OFGL .\nExample 8.6. It turns out [5, 28] that given any ring E0 that can be obtained\nfrom M P0 [ 12 ] by inverting some elements and killing a regular sequence, there is\na canonical even periodic ring spectrum E with \u03c00 E = E0 . If we work over M P0\nrather than M P0 [ 12 ] then things are more complicated, but typically not too different in cases of interest, except that we only have quasi-commutativity rather than\ncommutativity. Because M P0 = OFGL , the theory of formal group laws provides\nus with many naturally defined rings E0 to which we can apply this result.\n8.2. Schemes associated to spaces. Let E be an even periodic ring spectrum. We write SE = spec(E 0 ).\nExample 8.7. As mentioned above, Quillen's theorem tells us that SMP =\nFGL. Less interestingly, we have SHP = SK = 1 = spec(Z), the terminal scheme.\nIf Z is a finite complex, we write ZE = spec(E 0 Z) \u2208 XSE . This is a covariant\nfunctor of Z. If Z is an arbitrary space, we write \u039b(Z) for the category of pairs\n(W, w), where W is a finite complex and w is a homotopy class of maps W \u2212\n\u2192 Z.\nLemma 8.8. The category \u039b(Z) is filtered and essentially small.\nProof. It is well-known that every finite CW complex is homotopy equivalent\nto a finite simplicial complex, and that there are only countably many isomorphism\ntypes of finite simplicial complexes. It follows easily that \u039b(Z) is essentially small.\nIf (W, w) and (V, v) are objects of \u039b(Z) then there is an evident map u : U =\nV \u2210W \u2212\n\u2192 Z whose restrictions to V and W are v and w. Thus (U, u) \u2208 \u039b(Z), and\nthere are maps (V, v) \u2212\n\u2192 (U, u) \u2190\n\u2212 (W, w) in \u039b(Z).\nOn the other hand, suppose we have a parallel pair of maps f0 , f1 : (V, v) \u2212\n\u2192\n(W, w) in \u039b(Z). Let U be the space (W \u2210 V \u00d7 I)/ \u223c, where (x, t) \u223c ft (x) whenever\nx \u2208 V and t \u2208 {0, 1}. Let g : W \u2212\n\u2192 U be the evident inclusion, so clearly gf0 \u2243 gf1 .\nWe are given that wf0 and wf1 are homotopic to v. A choice of homotopy between\nwf0 and wf1 gives a map u : U \u2212\n\u2192 X with ug = w. Thus g is a map (W, w) \u2212\n\u2192 (U, u)\nin \u039b(Z) with gf0 = gf1 . This proves that \u039b(Z) is filtered.\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n77\n\nRemark 8.9. Let Z be a space with a given CW structure, and let \u039bCW (Z)\nbe the directed set of finite subcomplexes of Z. Then there is an evident functor\n\u039bCW (Z) \u2212\n\u2192 \u039b(Z), which is easily seen to be cofinal. We can also define \u039bstable (Z) to\nbe the filtered category of finite spectra W equipped with a map w : W \u2212\n\u2192 \u03a3\u221e Z + .\nThere is an evident stabilisation functor \u039b(Z) \u2212\n\u2192 \u039bstable (Z), and one checks that\nthis is also cofinal.\nRemark 8.10. Given two spaces Y and Z, there is a functor \u039b(Y ) \u00d7 \u039b(Z) \u2212\n\u2192\n\u039b(Y \u00d7 Z) given by ((V, v), (W, w)) 7\u2192 (V \u00d7 W, v \u00d7 w). This is always cofinal, as one\ncan see easily from the previous remark (for example).\nDefinition 8.11. For any space Z, we write\nZE =\n\nlim\n\n-\u2192\n(W,w)\u2208\u039b(Z)\n\nbS .\nspec(E 0 W ) \u2208 X\nE\n\nw\u2217\n\nWe also give E 0 Z the linear topology defined by the ideals I(W,w) = ker(E 0 Z \u2212\u2212\u2192\nE 0 W ). Thus\nspf(E 0 Z) = lim spec(image(E 0 Z \u2212\n\u2192 E 0 W )).\n-\u2192\n\u039b(Z)\n\nb 0 Z for the completion of E 0 Z. There is an evident map ZE \u2212\nWe write E\n\u2192 spf(E 0 Z).\nAlso, if Y is another space then the projection maps Y \u2190\n\u2212Y \u00d7Z \u2212\n\u2192 Z give rise to\na map (Y \u00d7 Z)E \u2212\n\u2192 YE \u00d7SE ZE .\nRemark 8.12. We know from [1] that the map E 0 Z \u2212\n\u2192 lim\n\n\u2190- \u039b(Z)\n\nE 0 W is surjec-\n\ntive; the kernel is the ideal of phantom maps. It is clear that the map E 0 (Z)/I(W,w) \u2212\n\u2192\nE 0 W is injective, so the same is true of the map\nlim E 0 (Z)/I(W,w) \u2212\n\u2192 lim E 0 W.\n\u2190-\n\n\u2190-\n\nb0\n\nIt follows by diagram chasing that E Z = lim E 0 (Z)/I(W,w) = lim E 0 W , and that\n\u2190-\n\n\u2190-\n\nthis is a quotient of E 0 Z. From this we see that E 0 Z is complete if and only if\nthere are no phantom maps Z \u2212\n\u2192 E.\nDefinition 8.13. We say that Z is tolerable (relative to E) if ZE = spf(E 0 Z)\nand (Y \u00d7 Z)E = YE \u00d7SE ZE for all finite complexes Y .\nProposition 8.14. If Z is tolerable and Y is arbitrary then\n(Y \u00d7 Z)E = YE \u00d7SE ZE .\n\nb 0 (Z). Of\nb 0 (Y \u00d7 Z) = E\nb 0 (Y )\u2297\nb E0 E\nIf Y is also tolerable then so is Y \u00d7 Z, and E\ncourse if E 0 Y , E 0 Z and E 0 (Y \u00d7 Z) are complete this means that E 0 (Y \u00d7 Z) =\nb E 0 E 0 Z.\nE0Y \u2297\n\nProof. If we fix V \u2208 \u039b(Y ) then the functor from \u039b(Z) to \u039b(V \u00d7 Z) given by\nW 7\u2192 V \u00d7 W is clearly cofinal, so lim (V \u00d7 W )E = (V \u00d7 Z)E , and this is the same\n-\u2192 W\n\nas VE \u00d7SE ZE because Z is tolerable and V is finite. If we now take the colimit\nover V and use the fact that filtered colimits of formal schemes commute with finite\n\n\f78\n\nNEIL P. STRICKLAND\n\nlimits, we find that lim\n\n-\u2192 V,W\n\nthat (Y \u00d7 Z)E = lim\n\n-\u2192 V,W\n\n(V \u00d7 W )E = YE \u00d7SE ZE . It follows from Remark 8.10\n\n(V \u00d7 W )E , so the first claim follows.\n\nNow suppose that Y is tolerable. Then\n\n(Y \u00d7 Z)E = YE \u00d7SE ZE\n\n= spf(E 0 Y ) \u00d7SE spf(E 0 Z)\n\nb 0 Z)\nb 0 Y ) \u00d7SE spf(E\n= spf(E\n\nb0 Y \u2297\nb 0 Z).\nb E0 E\n= spf(E\n\nb0 Y \u2297\nb 0 Z as claimed. It also follows\nb 0 (Y \u00d7 Z) = O(Y \u00d7Z) = E\nb E0 E\nIt follows that E\nE\nthat (Y \u00d7 Z)E is solid, and thus that (Y \u00d7 Z)E = spf(E 0 (Y \u00d7 Z)).\nNow let X be a finite complex. We need to show that (X \u00d7 Y \u00d7 Z)E =\nXE \u00d7SE (Y \u00d7 Z)E = XE \u00d7SE YE \u00d7SE ZE . In fact, we have (X \u00d7 Y )E = XE \u00d7SE YE\nbecause Y is tolerable, and ((X \u00d7 Y ) \u00d7 Z)E = (X \u00d7 Y )E \u00d7SE ZE because Z is\ntolerable, and the claim follows.\nDefinition 8.15. A space Z is decent if H\u2217 Z is a free Abelian group, concentrated in even degrees.\nExample 8.16. The spaces CP \u221e , BU (n), Z \u00d7 BU , BSU and \u03a9S 2n+1 are all\ndecent.\nProposition 8.17. Let Z be a decent space. Then Z is tolerable for any E,\nand ZE is coalgebraic over SE . Moreover, for any map E \u2212\n\u2192 E \u2032 of even periodic\nring spectra, the resulting diagram\nZE \u2032\n\nu\n\nSE \u2032\n\nwZ\nwS\n\nE\n\nu\nE\n\nis a pullback.\nProof. We may assume that Z is connected (otherwise treat each component\nseparately). As H1 Z = 0 we see that \u03c01 Z is perfect, so we can use Quillen's plus\nconstruction to get a homology equivalence Z \u2212\n\u2192 Z + such that \u03c01 (Z + ) = 0. By\nthe stable Whitehead theorem, this map is a stable equivalence, so E 0 (Y \u00d7 Z + ) =\nE 0 (Y \u00d7 Z) for all Y . We may thus replace Z by Z + and assume that \u03c01 Z = 0. This\nstep is not strictly necessary, but it seems the cleanest way to avoid trouble from the\nfundamental group. Given this, it is well-known that Z has a CW structure in which\nall the cells have even dimension. It follows that the Atiyah-Hirzebruch spectral\nsequence collapses and that E\u2217 Z is a free module over E\u2217 , with one generator\nei for each cell. As E\u2217 is two-periodic, we can choose these generators in degree\nzero. Similarly, E\u2217 (Z \u00d7 Z) is free on generators ei \u2297 ej and thus is isomorphic to\nE\u2217 (Z) \u2297E\u2217 E\u2217 (Z), so we can use the diagonal map to make E\u2217 Z into a coalgebra\nover E\u2217 . By periodicity, E0 (Z \u00d7 Z) = E0 (Z) \u2297E0 E0 (Z) and E0 Z is a coalgebra\nover E0 , and is freely generated as an E0 -module by the ei .\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n79\n\nIf W is a finite subcomplex of Z, it is easy to see that E0 W is a standard\nsubcoalgebra of E0 Z (in the language of Definition 4.58). Moreover, any finite\ncollection of cells lies in a finite subcomplex, so it follows that any finitely generated\nsubmodule of E0 Z lies in a standard subcoalgebra. It follows that {ei } is a good\nbasis for E0 Z, so that E0 Z \u2208 C\u2032SE .\nIt follows from the above in the usual way that E \u2227 Z+ is equivalent as an Emodule spectrum to a wedge of copies of E (one for each cell), and thus that E \u2217 Z =\nHomE \u2217 (E\u2217 Z, E\u2217 ). Using the periodicity we conclude that E 0 Z = HomE 0 (E0 Z, E 0 ).\nIt follows that spf(E 0 Z) = schSE (E0 Z) is a solid formal scheme, which is coalgebraic over SE . It is also easy to check that spf(E 0 Z) is the colimit of the schemes\nspec(E 0 W ) as W runs over the finite subcomplexes. It follows from Remark 8.9\nthat spf(E 0 Z) = ZE .\nNow let Y be another space. Let W be a finite subcomplex of Z, and let (V, v)\nbe an object of \u039b(Y ). The usual K\u00fcnneth arguments show that E 0 (W \u00d7 V ) =\nE 0 W \u2297E 0 E 0 V , and thus that (W \u00d7 V )E = WE \u00d7SE VE . Using Remark 8.10 we\nconclude that\n(Z \u00d7 Y )E = lim WE \u00d7SE VE = (lim WE ) \u00d7SE (lim VE ) = ZE \u00d7SE YE .\n-\u2192\nW,V\n\n-\u2192\nW\n\n-\u2192\nV\n\nThis proves that Z is tolerable. We leave it to the reader to check that a map\nE\u2212\n\u2192 E \u2032 gives an isomorphism ZE \u2032 = ZE \u00d7SE SE \u2032 .\nExample 8.18. It follows from the proposition that the spaces CP \u221e , BU (n),\nZ \u00d7 BU , BSU and \u03a9S 2n+1 are all tolerable, and the corresponding schemes are\ncoalgebraic over SE . The case of CP \u221e is particularly important. We note that\nCP \u221e = BS 1 = K(Z, 2) is an Abelian group object in the homotopy category, so\nGE = CP \u221e E is an Abelian formal group over SE . Because H \u2217 CP \u221e = Z[[x]], the\nAtiyah-Hirzebruch spectral sequence tells us that E 0 CP \u221e = E 0 [[x]] (although this\nb 1 \u00d7 SE\ndoes not give a canonical choice of generator x). This means that GE \u2243 A\nb S , so that GE is an ordinary formal group.\nin Based X\nE\n\nWe next recall that for n > 0 there is a quasicommutative rings spectrum\nP (n) = BP/In with P (n)\u2217 = Fp [vk | k \u2265 0], where vk has degree \u22122(pk \u2212 1). The\ncleanest construction now available is given in [5, 28], although of course there are\nmuch older constructions using Baas-Sullivan theory. We also have P (0) = BP ,\nwith P (0)\u2217 = Z(p) [vk | k > 0].\nDefinition 8.19. Let E be an even periodic ring spectrum. We say that E is\nan exact P (n)-module (for some n \u2265 0) if it is a module-spectrum over P (n), and\nthe sequence (vn , vn+1 , . . . ) is regular on E\u2217 .\nProposition 8.20. Let E be an exact P (n)-module. Let Z be a CW complex\nof finite type such that K(m)\u2217 Z is concentrated in even degrees for infinitely many\nm. If n = 0, assume that H s (Z; Q) = 0 for s \u226b 0. Then Z is tolerable for E.\nRemark 8.21. When combined with Proposition 8.14 this gives a useful K\u00fcnneth\ntheorem.\nThe proof will follow after Corollary 8.27. Many spaces are known to which this\napplies: simply connected finite Postnikov towers of finite type, classifying spaces\nof many finite groups and compact Lie groups, the spaces QS 2m , BO, ImJ and\n\n\f80\n\nNEIL P. STRICKLAND\n\nBU h2mi for example. See [24] for more details. The proof of our proposition will\nalso rely heavily on the results of that paper.\nWe next need some results involving the pro-completion of the category of\ngraded Abelian groups, which we denote by Pro(Ab\u2217 ). It is necessary to distinguish\nthis carefully from the category Pro(Ab)\u2217 of graded systems of pro-groups. A tower\nof graded groups can be regarded as an object in either category, but the morphisms\nare different. A tower {A0\u2217 \u2190\n\u2212 A1\u2217 \u2190\n\u2212 * * * } in Pro(Ab\u2217 ) is pro-trivial if for all j,\nthere exists k > j such that the map Ak\u2217 \u2212\n\u2192 Aj\u2217 is zero. It is pro-trivial in Pro(Ab)\u2217\nif for all j and d there exists k such that the map Akd \u2212\n\u2192 Ajd is zero. Because k is\nallowed to depend on d, this is a much weaker condition than triviality in Pro(Ab\u2217 ).\nNote also that if R\u2217 \u2212\n\u2192 R\u2217\u2032 is a map of graded rings, and {M\u03b1\u2217 } is a pro-system\nof R\u2217 -modules that is trivial in Pro(Ab\u2217 ), then the same is true of R\u2217\u2032 \u2297R\u2217 M\u2217 .\nHowever, the corresponding statement for Pro(Ab)\u2217 is false.\nRemark 8.22. If E is an exact P (n)-module, we know from work [29] of\nYagita that the functor M 7\u2192 E \u2217 \u2297P (n)\u2217 M is an exact functor on the category of P (n)\u2217 P (n)-modules that are finitely presented as modules over P (n)\u2217 .\n(This category is Abelian, because the ring P (n)\u2217 is coherent.) It follows that\nE \u2217 Z = E \u2217 \u2297P (n)\u2217 P (n)\u2217 Z for all finite complexes Z.\nThe following lemma is largely a paraphrase of results in [24].\nLemma 8.23. Fix n \u2265 0. Suppose that Z is a CW complex of finite type, and\nwrite Z r for the r-skeleton of Z. If n = 0 we also assume that H s (Z; Q) = 0\nfor s \u226b 0. Let F r+1 = ker(P (n)\u2217 Z \u2212\n\u2192 P (n)\u2217 Z r ) denote the (r + 1)'st Atiyah\u2217\nHirzebruch filtration in P (n) Z. Then the tower {P (n)\u2217 Z r }r\u22650 is isomorphic to\n{P (n)\u2217 (Z)/F r+1 }r\u22650 in Pro(Ab\u2217 ), and thus is Mittag-Leffler. Moreover, the groups\nP (n)\u2217 (Z)/F r+1 are finitely presented modules over P (n)\u2217 , and their inverse limit\nis P (n)\u2217 Z.\nProof. Write P = P (n) for brevity. Write Ar = P \u2217 Z r and\nBr = P \u2217 (Z)/F r+1 = image(P \u2217 Z \u2212\n\u2192 Ar ).\n\nWe then have an inclusion of towers {Br } \u2212\n\u2192 {Ar }, for which we need to provide\nan inverse in the Pro-category. We claim that for each r, there exists m(r) > r\nsuch that the image of the map Am(r) \u2212\n\u2192 Ar is precisely Br . We will deduce the\nlemma from this before proving it. Define m0 = 0 and mk+1 = m(mk ) > mk . By\nconstruction, the map Amk+1 \u2212\n\u2192 Amk factors through Bmk \u2286 Amk . One checks\nthat the resulting maps Amk+1 \u2212\n\u2192 Bmk are compatible as k varies, and that they\nprovide the required inverse. We also know that P \u2217 is a coherent ring, so the\ncategory of finitely presented modules is Abelian and closed under extensions. It\nfollows in the usual way that Ar is finitely presented for all r, and thus that Br =\nimage(Am(r) \u2212\n\u2192 Ar ) is finitely presented.\nWe now need to show that m(r) exists. By the basic setup of the AtiyahHirzebruch spectral sequence, it suffices to show that for large m, the first r + 1\ncolumns in the spectral sequence for P \u2217 Z m are the same as in the spectral sequence\nfor P \u2217 Z. This is Lemma 4.4 of [24]. (When n = 0, we need to check that we are in\nthe case P (0) = BP of their Definition 1.5. This follows from our assumption that\nH s (Z; Q) = 0 for s \u226b 0.)\nFinally, we need to show that P \u2217 Z = lim P \u2217 (Z)/F r+1 . This is essentially [24,\nCorollary 4.8].\n\n\u2190- r\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n81\n\nCorollary 8.24. Let Z and n be as in the Lemma, and let E be an exact P (n)-module. Then E 0 Z is complete, and ZE = spf(E 0 Z), and E \u2217 Z =\nb P (n)\u2217 P (n)\u2217 Z. Moreover we have isomorphisms\nE\u2217\u2297\n{E \u2217 (Z r )} \u2243 {E \u2217 (Z)/F r+1 } \u2243 {E \u2217 \u2297P (n)\u2217 P (n)\u2217 Z r }\n\n\u2243 {E \u2217 \u2297P (n)\u2217 (P (n)\u2217 (Z)/F r+1 )}\n\nin Pro(Ab\u2217 ).\nProof. We reuse the notation of the previous proof. We also define A\u2032r =\nE \u2297P \u2217 Ar and Br\u2032 = E \u2217 \u2297P \u2217 Br . As Z r is finite we see that A\u2032r = E \u2217 Z r . Next\nrecall that for any r we can choose m > r such that Br = image(Am \u2212\n\u2192 Ar ). As\nthe functor E \u2217 \u2297P \u2217 (\u2212) is exact on finitely presented comodules, we see that Br\u2032\nis the image of the map A\u2032m \u2212\n\u2192 A\u2032r and in particular that the map Br\u2032 \u2212\n\u2192 A\u2032r is\n\u2217\nm\n\u2217\nm\n\u2032\n\u2217\n\u2217\n\u2217\n\u2192 E \u2297P \u2217 P Z = E Z = Am clearly\ninjective. Next, the map E \u2297P \u2217 P Z \u2212\nfactors through E \u2217 Z, so our epimorphism P \u2217 Z \u2212\n\u2192 Am \u2212\n\u2192 Br gives an epimorphism\n\u2192 A\u2032m \u2212\n\u2192 Br\u2032 which factors through E \u2217 Z, so the map E \u2217 Z \u2212\n\u2192 Br\u2032 is\nE \u2217 \u2297P \u2217 P \u2217 Z \u2212\n\u2032\n\u2217\n\u2217 r\n\u2217\nr+1\nsurjective. Thus Br = image(E Z \u2212\n\u2192 E Z ) = E (Z)/F\n. We can now apply\nthe functor E \u2217 \u2297P \u2217 (\u2212) to the pro-isomorphisms in the Lemma to get the proisomorphisms in the present corollary. This makes it clear that the tower {E \u2217 Z r }\nis Mittag-Leffler so the Milnor sequence tells us that\n\u2217\n\nE \u2217 Z = lim E \u2217 Z r = lim E \u2217 (Z)/F r+1 .\n\u2190r\n\n\u2190r\n\nThis means in particular that E 0 Z is complete with respect to the linear topology\ngenerated by the ideals F r+1 , which is easily seen to be the same as the topology\nin Definition 8.11. Moreover, we have an isomorphism {A\u2032r } \u2243 {Br\u2032 } in the Pro\ncategory of groups, and it is easy to see from the construction that this is actually\nan isomorphism in the Pro category of rings as well, so by applying spec(\u2212) we\nget an isomorphism in the Ind category of schemes, which is just the category of\nformal schemes. From the definitions we have ZE = lim spec(A\u2032r ) and spf(E 0 Z) =\nlim spec(Br\u2032 ), so we conclude that ZE = spf(E 0 Z).\n\n-\u2192 r\n\n-\u2192 r\n\nLemma 8.25. Let E and Z be as in Corollary 8.24, and suppose that K(m)\u2217 Z is\nconcentrated in even degrees for infinitely many m. Then the ring E \u2217 Z is Landweber exact over P (n)\u2217 , so the function spectrum F (Z+ , E) is an exact P (n)-module.\nProof. We know from [24, Lemma 5.3] that P (m)\u2217 Z is concentrated in even\ndegrees for all m, and from [24, Corollary 4.6] that the tower {P (m)\u2217 Z r } has the\nMittag-Leffler property. It follows that the tower {P (m)odd Z r } is pro-trivial. Next,\nm\nm\nv\n\u2192 P (m) \u2212\n\u2192 P (m + 1) \u2212\n\u2192 \u03a32p \u22121 P (m).\nconsider the cofibration \u03a32(p \u22121) P (m) \u2212\u2212m\nThis gives a pro-exact sequence of towers\nv\n\n\u2192 {P (m)ev Z r } \u2212\n\u2192 {P (m + 1)ev Z r } \u2212\n\u2192 0.\n0\u2212\n\u2192 {P (m)ev Z r } \u2212\u2212m\n\nIt follows that the sequence (vn , vn+1 , . . . ) acts regularly on the tower {P (n)\u2217 Z r }.\nNext, for any spectrum X we have a map P (m) \u2227 X \u2212\n\u2192 P (m) \u2227 BP \u2227 X which\nmakes P (m)\u2217 X a comodule over P (m)\u2217 BP = BP\u2217 BP/In . Moreover, we have\nP (m)\u2217 X\u2297P (m)\u2217 P (m)\u2217 BP = P (m)\u2217 X\u2297BP\u2217 BP\u2217 BP so this actually makes P (m)\u2217 X\ninto a comodule over BP\u2217 BP . One can check from this construction that the maps\n\n\f82\n\nNEIL P. STRICKLAND\nm\n\nv\n\nm\n\n\u2192 P (m) \u2212\n\u2192 P (m+ 1) \u2212\n\u2192 \u03a32p \u22121 P (m) give rise to maps of comod\u03a32(p \u22121) P (m) \u2212\u2212m\nules, so our whole diagram of towers is a diagram of finitely-presented comodules\nover P (n)\u2217 BP . The functor E \u2217 \u2297P (n)\u2217 (\u2212) is exact on this category. It is easy to\nconclude by induction that {E \u2217 \u2297P (n)\u2217 P (m)\u2217 Z r } \u2243 {E \u2217 (Z r )/Im }, that the odd\ndimensional part of these towers is pro-trivial, the towers are Mittag-Leffler, and\nthe sequence (vn , vn+1 , . . . ) is regular on the tower {E \u2217 (Z r )}. We can now pass\nto the inverse limit (using the Mittag-Leffler property to show that the lim1 terms\nvanish) to see that the sequence (vn , vn+1 , . . . ) is regular on E \u2217 (Z).\n\n\u2190-\n\nOur next few results are closely related to those of [24, Section 9], although a\nprecise statement of the relationship would be technical.\nLemma 8.26. Let Z be a CW complex of finite type such that K(m)\u2217 Z is\nconcentrated in even degrees for infinitely many m. If n = 0 we also assume that\nH s (Z; Q) = 0 for s \u226b 0. Then for any finite spectrum W we have pro-isomorphisms\n{P (n)\u2217 (Z r \u00d7 W )} \u2243 {P (n)\u2217 Z r \u2297P (n)\u2217 P (n)\u2217 W }\n\n\u2243 {P (n)\u2217 (Z)/F r+1 \u2297P (n)\u2217 P (n)\u2217 W },\n\nand these towers are Mittag-Leffler. Moreover, we have isomorphisms\nb P (n)\u2217 P (n)\u2217 W.\nP (n)\u2217 (Z \u00d7 W ) = P (n)\u2217 Z \u2297P (n)\u2217 P (n)\u2217 W = P (n)\u2217 Z \u2297\n\nProof. Write P = P (n) for brevity. The usual Landweber exactness argument\nshows that W 7\u2192 P \u2217 Z \u2297P \u2217 P \u2217 W is a cohomology theory and thus that it coincides\nwith P \u2217 (Z \u00d7 W ). We can also do the same argument with pro-groups. We saw\nin the proof of the previous lemma that the sequence (vn , vn+1 , . . . ) acts regularly\n\u2217\n\u2217\n\u2217 r\non the pro-group {P \u2217 Z r }, so the pro-group {TorP\n1 (P (m) , P Z )} is trivial for\n\u2217\nall m \u2265 n. Any finitely presented comodule M has a finite Landweber filtration\nwhose quotients have the form P (m)\u2217 for m \u2265 n, and we see by induction on the\n\u2217\n\u2217\n\u2217 r\nlength of the filtration that {TorP\n1 (M , P Z )} is trivial. This implies that the\n\u2217\n\u2217\n\u2217\nr\nconstruction M 7\u2192 {M \u2297P \u2217 P Z } gives an exact functor from finitely presented\ncomodules to Pro(Ab\u2217 ), so that W 7\u2192 {P \u2217 W \u2297P \u2217 P \u2217 Z r } is a Pro(Ab\u2217 )-valued\ncohomology theory on finite complexes. The construction W 7\u2192 {P \u2217 (W \u00d7 Z r )}\ngives another such cohomology theory, and we have a natural transformation from\nthe first to the second that is an isomorphism when W is a sphere, so it is an\nisomorphism in general. Thus {P \u2217 (Z r \u00d7 W )} = {P \u2217 Z r \u2297P \u2217 P \u2217 W }, as claimed.\nWe have seen that the tower {P \u2217 Z r } is pro-isomorphic to {P \u2217 (Z)/F r+1 }, so it\nfollows that {P \u2217 Z r \u2297P \u2217 P \u2217 W } \u2243 {P \u2217 (Z)/F r+1 \u2297P \u2217 P \u2217 W }. The second of these\nis a tower of isomorphisms, so all three of our towers are Mittag-Leffler as claimed.\nAs Z \u00d7 W is the homotopy colimit of the spaces Z r \u00d7 W , the Milnor sequence gives\nan isomorphism P \u2217 (Z \u00d7 W ) = lim P \u2217 (Z)/F r+1 \u2297P \u2217 P \u2217 W , and the right hand side\n\u2190- r\n\nb P \u2217 P \u2217 W , which completes the proof.\nis by definition P \u2217 (Z)\u2297\n\nCorollary 8.27. Let E be an exact P (n)-module. Let Z be a CW complex\nof finite type such that K(m)\u2217 Z is concentrated in even degrees for infinitely many\nm. If n = 0 we also assume that H s (Z; Q) = 0 for s \u226b 0. Then for any finite\nspectrum W we have pro-isomorphisms\n{E 0 (Z r \u00d7 W )} \u2243 {E 0 Z r \u2297E 0 E 0 W } \u2243 {E 0 (Z)/F r+1 \u2297E 0 E 0 W },\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n83\n\nand these towers are Mittag-Leffler. Moreover, we have isomorphisms\nb E 0 E 0 W.\nE 0 (Z \u00d7 W ) = E 0 Z \u2297E 0 E 0 W = E 0 Z \u2297\n\nProof. If we apply the functor E \u2217 \u2297P (n)\u2217 (\u2212) to the pro-isomorphisms in the\nlemma, we get the pro-isomorphisms in the corollary. We deduce in the same way\nb E 0 E 0 W . On the other hand, we see from\nas in the lemma that E 0 (Z \u00d7 W ) = E 0 Z \u2297\nLemma 8.25 that\nE \u2217 (Z \u00d7 W ) = [W+ , F (Z+ , E)]\u2217 = E \u2217 Z \u2297P (n)\u2217 P (n)\u2217 W =\n\nE \u2217 Z \u2297E \u2217 (E \u2217 \u2297P (n)\u2217 P (n)\u2217 W ) = E \u2217 Z \u2297E \u2217 E \u2217 W.\n\nThus E 0 (Z \u00d7 W ) = E 0 Z \u2297E 0 E 0 W as claimed.\nProof of Proposition 8.20. Corollary 8.24 shows that ZE = spf(E 0 Z).\nWrite\nF r+1 = ker(E 0 Z \u2212\n\u2192 E 0 Z r ),\n\nso ZE = lim V (F r ). Let W be a finite complex. We then have\n-\u2192 r\n\nZE \u00d7SE WE = lim V (F r ) \u00d7SE WE\n-\u2192\nr\n\n= lim spec(E 0 (Z)/F r \u2297E 0 E 0 (W ))\n-\u2192\nr\n\nb E 0 E 0 (W ))\n= spf(E 0 (Z)\u2297\n\n= spf(E 0 (Z \u00d7 W )),\n\nwhere we have used Corollary 8.27. We can apply Lemma 8.23 to Y \u00d7Z and conclude\nthat spf(E 0 (Y \u00d7 Z)) = (Y \u00d7 Z)E , giving the required isomorphism (Y \u00d7 Z)E =\nYE \u00d7SE ZE .\n8.3. Vector bundles and divisors. Let V be a complex vector bundle of\nrank n over a tolerable space Z. We write P (V ) for the space of pairs (z, W ),\nwhere z \u2208 Z and W is a line (i.e. a one-dimensional subspace) in Vz . This is clearly\na fibre bundle over Z with fibres CP n\u22121 . We write D(V ) = P (V )E . There is a\ntautological line bundle L over P (V ), whose fibre over a pair (z, W ) is W . This is\nclassified by a map P (V ) \u2212\n\u2192 CP \u221e . By combining this with the projection to Z, we\n\u221e\nget a map P (V ) \u2212\n\u2192 CP \u00d7 Z and thus a map D(V ) \u2212\n\u2192 G \u00d7S ZE . The well-known\ntheorem on projective bundles translates into our language as follows.\nProposition 8.28. The above map is a closed inclusion, making D(V ) into an\neffective divisor of degree n on G.\nProof. Choose an orientation x of E, so x \u2208 \u1ebc 0 CP \u221e . We also write x for\nthe image of x under the map P (V ) \u2212\n\u2192 CP \u221e , which is just the Euler class of L.\n\u2217\nWe claim that E P (V ) is freely generated over E \u2217 Z by {1, x, . . . , xn\u22121 }, which\nwill prove the claim. This is clear when V is trivialisable. For the general case, we\nmay assume that Z is a regular CW complex. The claim holds when Z is a finite\nunion of subcomplexes on which V is trivialisable, by a well-known Mayer-Vietoris\nargument. It thus holds when Z is a finite complex, and the general case follows\nby passing to colimits.\n\n\f84\n\nNEIL P. STRICKLAND\n\nProposition 8.29. If V and W are two vector bundles over a tolerable space\nZ then D(V \u2295 W ) = D(V ) + D(W ).\nProof. Choose an orientation, and let x be the Euler class of the usual line\nbundle over P (V \u2295 W ). The polynomial fD(V \u2295W ) (t) is the unique one of degree\ndim(V \u2295 W ) of which x is a root, so it suffices to check that fD(V ) (x)fD(W ) (x) = 0.\nThere are evident inclusions P (V ) \u2212\n\u2192 P (V \u2295 W ) \u2190\n\u2212 P (W ) with P (V ) \u2229 P (W ) = \u2205.\nWrite A = P (V \u2295W )\\P (V ) and B = P (V \u2295W )\\P (W ), so that A\u222aB = P (V \u2295W ).\nBy a well-known argument, if a, b \u2208 E 0 P (V \u222a W ) and a|A = 0 and b|B = 0 then\nab = 0, so it suffices to check that fD(V ) (x)|B = 0 and fD(W ) (x)|A = 0. It is not\nhard to see that the inclusions P (V ) \u2212\n\u2192 B is a homotopy equivalence and thus that\nfD(V ) (x)|B = 0, and the other equation is proved similarly.\nProposition 8.30. If M is a complex line bundle over a tolerable space Z,\nwhich is classified by a map u : Z \u2212\n\u2192 CP \u221e , then D(M ) is the image of the map\n\u221e\n(u, 1)E : ZE \u2212\n\u2192 (CP \u00d7 Z)E = G \u00d7S ZE .\nProof. This follows from the definitions, using the obvious fact that P (M ) =\nZ.\nProposition 8.31. There is a natural isomorphism BU (n)E = Div+\nn (G).\nProof. This is essentially well-known, but we give some details to illustrate\nhow everything fits together. Let T (n) be the maximal torus in U (n), so that\nBT (n) \u2243 (CP \u221e )n and BT (n)E = GnS . Thus, the inclusion i : T (n) \u2212\n\u2192 U (n) gives\n\u2192 BU (n)E . If \u03c3 \u2208 \u03a3n is a permutation, then the evident action of\na map GnS \u2212\n\u03c3 on T (n) is compatible with the action on U (n) given by conjugating with the\nassociated permutation matrix. This matrix can be joined to the identity matrix\nby a path in U (n), so the conjugation is homotopic to the identity. Thus, our map\nn\n\u2192 BU (n)E factors through a map Div+\n\u2192 BU (n)E . On the\nGnS \u2212\nn (G) = GS /\u03a3n \u2212\nother hand, the tautological bundle Vn over BU (n) gives rise to a divisor D(Vn ) over\nn\nBU (n)E and thus a map BU (n)E \u2212\n\u2192 Div+\n\u2192\nn (G). The composite GS = BT (n)E \u2212\n+\nn\n\u2217\nBU (n)E \u2212\n\u2192 Divn (G) = GS /\u03a3n classifies the divisor D(i Vn ). Let M1 , . . . , Mn be\nthe evident line bundles over BT (n), so that i\u2217 Vn = M1 \u2295. . .\u2295Mn . One checks from\nthis and Propositions 8.29 and 8.30 that the composite is just the usual quotient\nmap GnS \u2212\n\u2192 GnS /\u03a3n , and thus the composite Div+\n\u2192 BU (n)E \u2212\n\u2192 Div+\nn (G) \u2212\nn (G) is\nthe identity.\nNext, we take the space of n-frames in C\u221e as our model for EU (n). There is\nthen a homeomorphism EU (n)/(S 1 \u00d7 U (n \u2212 1)) \u2212\n\u2192 P (Vn ) (sending (w1 , . . . , wn )\nto the pair (L, W ), where W is the span of {w1 , . . . , wn } and L is the span of w1 ).\nThe left hand side is a model for CP \u221e \u00d7 BU (n \u2212 1). By induction on n, we may\nassume that BU (n \u2212 1)E = Gn\u22121 /\u03a3n\u22121 . This gives a commutative diagram as\nfollows.\nG \u00d7 Gn\u22121 /\u03a3n\u22121\n\nu\n\nGn /\u03a3n\nv\n\n\u2243\n\nw P (V )\n\nn E\n\nu\nw BU (n)\n\nE\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n85\n\nThe top horizontal is an isomorphism by induction and the right hand vertical is\nfaithfully flat, and thus a categorical epimorphism. It follows that the bottom map\nis an epimorphism, but we have already seen that it is a split monomorphism, so\nit is an isomorphism as required.\n\nDefinition 8.32. Let x be a coordinate on G. If V is a vector bundle of rank\nn over a tolerable space Z,Pthen we have D(V ) = spf(E 0 Z[[x]]/f (x)) for a unique\nn\nmonic polynomial f (x) = i=0 ci (V )xn\u2212i , with ci (V ) \u2208 E 0 Z. We call ci (V ) the\ni'th Chern class of V .\nDefinition 8.33. We write L(V ) for L(D(V )), the Thom sheaf of D(V ), which\nis a line bundle over ZE . It is easy to see that L(V ) = \u1ebc 0 Z V , where Z V =\nP (C \u2295 V )/P (V ) is the Thom space of V .\nRemark 8.34. Let E be an even periodic ring spectrum and put G = GE =\n\u221e\n(CP \u221e )E and S = SE = spec(E 0 ) as usual. Then the Thom spectra CP\u2212n\nform a\n0\n\u221e\ntower, and there is a natural identification MG/S = lim E (CP\u2212n ). We also have\n-\u2192 n\n\ne 0 CP 1 = E\ne 0 S 2 = \u03c02 E. The theory of invariant differentials identifies\n\u03c9G/S = E\n\u221e\nM\u03a91G/S with MG/S \u2297E 0 \u03c9G/S = lim E 0 (\u03a32 CP\u2212n\n). The S 1 -equivariant Segal con-\u2192 n\n\n\u221e\njecture gives an equivalence between holim \u03a32 CP\u2212n\nand the profinite completion\n\u2190-\n\nn\n\n\u221e\nof S 0 , and one can show that the resulting map M\u03a91G/S = lim E 0 (\u03a32 CP\u2212n\n)\u2212\n\u2192 E0\n-\u2192 n\n\nis just resG/S .\n\nProposition 8.35. There are natural isomorphisms\na\n( BU (n))E = M + (G) = Div+ (G)\nn\n\nBUE = N + (G) = N (G) = Div0 (G)\n\n(Z \u00d7 BU )E = M (G) = Div(G)\n(Z \u00d7 BU )E = MapS (G, Gm ).\n\nProof. This is well-known, and follows easily from Proposition 8.31 and the\nremarks following Definition 5.8. The fourth statement follows from the third one\nby Cartier duality.\nNext, recall that there is a \"complex reflection map\" r : S 1 \u00d7 CP+n\u22121 \u2212\n\u2192 U (n),\nwhere r(z, L) has eigenvalue z on the line L < Cn and eigenvalue 1 on L\u22a5 . This\ngives an unbased map CP n\u22121 \u2212\n\u2192 \u03a9U (n). We can also fix a line L0 < Cn and\n\u22121\ndefine r(z, L) = r(z, L)r(z, L0 ) , giving a map r : CP n\u22121 \u2212\n\u2192 \u03a9SU (n). Moreover,\nthe Bott periodicity isomorphisms \u03a9U = Z \u00d7 BU and \u03a9SU = BU give us maps\n\u03a9U (n) \u2212\n\u2192 Z \u00d7 BU and \u03a9SU (n) \u2212\n\u2192 BU . It is easy to see that (CP n\u22121 )E is the\n0\nn\ndivisor Dn = n[0] = spec(E [[x]]/x ) on GE over SE .\n\n\f86\n\nNEIL P. STRICKLAND\n\nProposition 8.36. There are natural isomorphisms\n(\u03a9U (n))E = M (Dn )\n(\u03a9SU (n))E = N (Dn )\n(\u03a9U (n))E = MapS (Dn , Gm )\n(\u03a9SU (n))E = BasedMapS (Dn , Gm ).\nUnder these identifications, the map \u03a9U (n) \u2212\n\u2192 Z \u00d7 BU gives the obvious map\nM (Dn ) \u2212\n\u2192 M (GE ) and so on.\nProof. For the second statement, it is enough (by Remark 6.9) to check that\nE\u2217 (\u03a9SU (n)) is the symmetric algebra generated by the reduced E-homology of\nCP n\u22121 . This is well-known for ordinary homology, and it follows for all E by a\ncollapsing Atiyah-Hirzebruch spectral sequence. See [22, 23] for more details. The\ninclusion S 1 = U (1) \u2212\n\u2192 U (n) and the determinant map det : U (n) \u2212\n\u2192 S 1 give a\n1\nsplitting U (n) = S \u00d7 SU (n) of spaces and thus \u03a9U (n) = Z \u00d7 \u03a9SU (n) of H-spaces\nand the first claim follows in turn using this. The last two statements follow by\nCartier duality.\n8.4. Cohomology of Abelian groups. Let A be a compact Abelian Lie\ngroup, and write A\u2217 for the character group Hom(A, S 1 ), which is a finitely generated discrete Abelian group. Let G be an ordinary formal group over a base S.\nb spec(R) (spec(R), Gs ) for the associFor any point s \u2208 S(R) we write \u0393(Gs ) = X\nated group of sections. A coordinate gives a bijection between \u0393(Gs ) and Nil(R),\nwhich becomes a homomorphism if we use an appropriate formal group law to make\nNil(R) a group. We define a formal scheme Hom(A\u2217 , G) by\nHom(A\u2217 , G)(R) = {(s, \u03c6) | s \u2208 S(R) and \u03c6 : A\u2217 \u2212\n\u2192 \u0393(Gs )}.\n\n(If A\u2217 is a direct sum of r cyclic groups then this can be identified with a closed\nformal subscheme of GrS in an evident way, which shows that it really is a scheme.)\nProposition 8.37. For any finite Abelian group A, there is a natural map\nBAE \u2212\n\u2192 Hom(A\u2217 , G). This is an isomorphism if E is an exact P (n)-module for\nsome n.\nProof. An element \u03b1 \u2208 A\u2217 = Hom(A, S 1 ) gives a map BA \u2212\n\u2192 BS 1 of spaces\n1\nand thus a map BAE \u2212\n\u2192 (BS )E = G of formal groups over S. One checks that the\nb S (BAE , G) is a homomorphism, so by adjointing things\nresulting map A\u2217 \u2212\n\u2192 Ab X\naround we get a map BAE \u2212\n\u2192 Hom(A\u2217 , G). If A is a torus then A\u2217 \u2243 Zr and\nr\n\u2217\nBAE = G = Hom(A , G), so our map is an isomorphism. Moreover, in this case\nBA \u2243 (CP \u221e )r which is decent and thus tolerable for any E. If A = Z/m then\nthere is a well-known way to identify BA with the circle bundle in the line bundle\nLm , where L is the tautological bundle over CP \u221e . This gives a long exact Gysin\nsequence\n[m](x)\n\nE \u2217 BA \u2190\n\u2212 E \u2217 CP \u221e \u2190\u2212\u2212\u2212\u2212 E \u2217 CP \u221e .\n\nThe second map here is multiplication by [m](x), which is the image of x under\n\u00d7m\nthe map G \u2212\u2212\u2192 G. If this map is injective then the Gysin sequence is a short\nexact sequence and we have E 0 BA = E 0 CP \u221e /[m](x), and we conclude easily that\nm\nspf(E 0 BA) = ker(G \u2212\u2192 G) = Hom(A\u2217 , G). One can apply similar arguments to\n2k+1\nthe skeleta S\n/(Z/m) of BA and find that spf(E 0 BA) = BAE .\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n87\n\nIn the case of two-periodic Morava K-theory we recover the well-known calculation showing that K(n)\u2217 BA is concentrated in even degrees for all n. We also\nhave H s (BA, Q) = 0 for s > 0 so Proposition 8.20 tells us that BAE is tolerable\nfor any E that is an exact P (n)-module for any n. Moreover, it is easy to see that\n[m](x) is not a zero-divisor in this case so BAE = Hom(A\u2217 , G). We have just shown\nthis when A\u2217 is cyclic, but it follows easily for all A by Proposition 8.14.\n8.5. Schemes associated to ring spectra. If R is a commutative ring spectrum with a ring map E \u2212\n\u2192 R, we have a scheme spec(\u03c00 R) over SE . If Z\nis a finite complex we can take R = F (Z+ , E) and we recover the case ZE =\nspec(E 0 Z) = spec(\u03c00 R). If M is an arbitrary commutative ring spectrum, we\ncan take R = E \u2227 M . In this case we write M E = spec(E0 M ) for the resulting scheme. If Y is a commutative H-space we can take M = \u03a3\u221e Y+ , and we\nwrite Y E for M E = spec(E0 Y ) in this case. If we have a K\u00fcnneth isomorphism\nE0 Y k = (E0 Y )\u2297k then E0 Y is a Hopf algebra, so Y E is a group scheme over S.\nIf Y is decent then E0 Y is a coalgebra with good basis. In this case Proposition 6.19 applies, and we have a Cartier duality Y E = D(YE ) = HomS (YE , Gm )\nand YE = D(Y E ) = HomS (Y E , Gm ).\nIf {R\u03b1 } is an inverse system of ring spectra as above, we have a formal scheme\nlim spec(\u03c00 R\u03b1 ). If Z\u03b1 runs over the finite subcomplexes of a CW complex Z, then\n-\u2192 \u03b1\n\nthe rings F (Z\u03b1+ , E) give an example of this, and the associated formal scheme\nis just ZE . Another good example is to take the tower of spectra E/pk , where\nE is an even periodic ring spectrum such that E 0 is torsion-free. More generally,\nif E has suitable Landweber exactness properties then we can smash E with a\ngeneralised Moore spectrum S/I (see [13, Section 4], for example) and get a new\neven periodic ring spectrum E/I, and then we can consider a tower of these. There\nare technicalities about the existence of products on the spectra E/I, which we\nomit here.\n8.6. Homology of Thom spectra. Let Z be a space equipped with a map\nz\nZ\u2212\n\u2192 Z \u00d7 BU , and let T (Z, z) be the associated Thom spectrum. It is well-known\nthat T is a functor from spaces over Z \u00d7 BU to spectra, which preserves homotopy\npushouts. Moreover, if (Y, y) is another space over Z \u00d7 BU then we can use the\naddition on Z \u00d7 BU to make (Y \u00d7 Z, (y, z)) into a space over Z \u00d7 BU and we find\nthat T (Y \u00d7 Z, (y, z)) = T (Y, y) \u2227 T (Z, z).\nz\nThe above construction really needs an actual map Z \u2212\n\u2192 Z \u00d7 BU and not just\na homotopy class. However, we do have the following result.\nLemma 8.38. If Z is a decent space then the spectrum T (Z, z) depends only\non the homotopy class of z, up to canonical homotopy equivalence. Thus T can be\nregarded as a functor from the homotopy category of decent spaces over Z \u00d7 BU to\nspectra. In particular, we can define T (Z, V ) when V is a virtual bundle over Z.\nProof. Suppose we have two homotopic maps z0 , z1 : Z \u2212\n\u2192 Z \u00d7 BU . We can\nthen choose a map w : Z \u00d7 I \u2212\n\u2192 Z \u00d7 BU such that wj0 = z0 and wj1 = z1 , where\nft\njt (a) = (a, t). The maps jt induce maps of spectra T (Z, zt ) \u2212\u2192 T (Z \u00d7 I, w), and\nthe Thom isomorphism theorem implies that these give equivalences in homology so\nthey are weak equivalences. We thus have a weak equivalence f1\u22121 f0 : T (Z, z0 ) \u2212\n\u2192\nT (Z, z1 ). This much is true even when Z is not decent.\n\n\f88\n\nNEIL P. STRICKLAND\n\nTo see that our map is canonical when Z is decent, note that KU \u2217 Z is concentrated in even degrees, so the space F of unpointed maps from Z to Z \u00d7 BU\nhas trivial odd-dimensional homotopy groups with respect to any basepoint. We\ncan think of z0 and z1 as points of F , and w as a path between them. If w\u2032 is\nanother path then then we can glue w and w\u2032 to get a map of S 1 to F , which can\nbe extended to give a map u : D2 \u2212\n\u2192 F because \u03c01 F = 0. It follows that we have a\ncommutative diagram as follows:\n\nw T (Z \u00d7 I, w)\nAA\nA\n\u000f\nDA\nT (Z \u00d7 D , u)\n\u0010\nCA\nf0\n\nT (Z, z0 )\n\nu\n\nf0\u2032\n\n2\n\nu AAA\n\nT (Z \u00d7 I, w\u2032 )\n\nu\n\nf1\u2032\n\nf1\n\nT (Z, z1 )\n\nIt follows easily that f1\u22121 \u25e6 f0 = (f1\u2032 )\u22121 \u25e6 f0\u2032 , as required.\nA coordinate on GE is the same as a degree zero complex orientation of E, which\ngives a multiplicative system of Thom classes for all virtual complex bundles. In\nparticular, this gives isomorphisms E\u2217 T (Y, y) \u2243 E\u2217 Y , which are compatible in the\nevident way with the isomorphisms T (Y \u00d7 Z, (y, z)) = T (Y, y) \u2227 T (Z, z).\nz\nIf Z \u2212\n\u2192 {n} \u00d7 BU (n) classifies an honest n-dimensional bundle V over Z then\nwe have T (Z, z) = \u03a3\u221e Z V . In particular, the inclusion CP \u221e = BU (1) \u2212\n\u2192 {1} \u00d7 BU\njust gives the Thom spectrum \u03a3\u221e (CP \u221e )L , which is well-known to be the same as\n\u03a3\u221e CP \u221e (without a disjoint basepoint).\nNow let Z be a decent commutative H-space. Let z : Z \u2212\n\u2192 Z\u00d7BU be an H-map,\nand write M = T (Z, z). We note that addition gives a map (Z \u00d7 Z, (z, z)) \u2212\n\u2192 (Z, z)\nof spaces over Z \u00d7 BU and thus a map of spectra M \u2227 M \u2212\n\u2192 M , which makes M\ninto a commutative ring spectrum. Similarly, the diagonal gives a map (Z, z) \u2212\n\u2192\n\u03b4\n\u221e\n(Z \u00d7 Z, (0, z)) and thus a map M \u2212\n\u2192 \u03a3 Z+ \u2227 M . Finally, we consider the shearing\nmap (a, b) 7\u2192 (a, a + b). This is an isomorphism (Z \u00d7 Z, (z, z)) \u2212\n\u2192 (Z \u00d7 Z, (0, z))\nover Z \u00d7 BU , which gives an isomorphism M \u2227 M \u2212\n\u2192 \u03a3\u221e Z+ \u2227 M of spectra.\nA choice of coordinate gives a Thom isomorphism E\u2217 M \u2243 E\u2217 Z, which shows\nthat E\u2217 M is free and in even degrees. For the moment we just use this to show\nthat we have K\u00fcnneth isomorphisms, from which we will recover a more natural\nstatement about the relationship between E\u2217 Z and E\u2217 M .\nRecall that we defined define Z E = spec(E0 Z) = spec(E0 \u03a3\u221e Z+ ) (which is a\ncommutative group scheme over S = SE ) and M E = spec(E0 M ). Our diagonal\nmap \u03b4 gives an action of Z E on M E . The shearing isomorphism M \u2227 M = \u03a3\u221e Z+ \u2227\nM shows that the action and projection maps give an isomorphism Z E \u00d7S M E \u2212\n\u2192\nM E \u00d7S M E .\nA choice of coordinate on G gives an isomorphism E0 M \u2243 E0 Y . One can check\n(using the multiplicative properties of Thom classes) that this is an isomorphism\nof E0 Y -comodule algebras, so it gives an isomorphism Y E \u2243 M E of schemes,\ncompatible with the action of Y E . This means that M E is a trivialisable torsor for\nY E.\nIn the universal case Y = Z \u00d7 BU , this works out as follows. As mentioned\npreviously, we have a map CP \u221e = {1} \u00d7 BU (1) \u2212\n\u2192 Z \u00d7 BU , and the Thom functor\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n89\n\ngives a map \u03a3\u221e CP \u221e \u2212\n\u2192 M P . In particular, the bottom cell gives a map S 2 =\n1\nCP \u2212\n\u2192 M P , or an element u \u2208 \u03c02 M P . The inclusion {\u22121} \u2212\n\u2192 Z\u00d7BU also gives an\nelement of \u03c0\u22122 M P , which one checks is inverse to u. Thus, a ring map E0 M P \u2212\n\u2192R\ngives an E0 -algebra structure on R, and an E0 -module map \u1ebc0 CP \u221e \u2212\n\u2192 R, which\nsends \u1ebc0 S 2 into R\u00d7 . In other words, it gives a point s \u2208 SE (R) together with\nb E 0 \u1ebc 0 CP \u221e . We can identify R\u2297\nb E 0 \u1ebc 0 CP \u221e with the ideal of\nan element y \u2208 R\u2297\nfunctions on Gs that vanish at zero, and the extra condition on the restriction to\nS 2 says that y is a coordinate. This gives a natural map M P E \u2212\n\u2192 Coord(G). Wellknown calculations show that E0 M P is the symmetric algebra over E0 on \u1ebc0 CP \u221e ,\nwith the bottom class inverted. This implies easily that the map M P E \u2212\n\u2192 Coord(G)\nis an isomorphism. Recall also that (Z \u00d7 BU )E = Map(G, Gm ). Clearly, if u : G \u2212\n\u2192\nGm and x is a coordinate on G, then the product ux is again a coordinate. This\ngives an action of Map(G, Gm ) on Coord(G), which makes Coord(G) into a torsor\nover Map(G, Gm ). One can check that this structure arises from our geometric\ncoaction of Z \u00d7 BU on M P .\n8.7. Homology operations. Let G be an ordinary formal group over S, and\nlet H be an ordinary formal group over T . Let \u03c0S and \u03c0T be the projections\nfrom S \u00d7 T to S and T . We write Hom(G, H) for HomS\u00d7T (\u03c0S\u2217 G, \u03c0T\u2217 H), which is\na scheme over S \u00d7 T by Proposition 6.15. Recall that Hom(G, H)(R) is the set of\ntriples (s, t, u) where s \u2208 S(R) and t \u2208 T (R) and u : Gs \u2212\n\u2192 Ht is a map of formal\ngroups over spec(R). We write Iso(G, H)(R) for the subset of triples for which u is\nan isomorphism. If we choose coordinates x and y on G and H, then for any u we\nhave y(u(g)) = \u03c6(x(g)) for some power series \u03c6 \u2208 R[[t]] with \u03c6(0) = 0, and u is an\nisomorphism if and only if \u03c6\u2032 (0) is invertible. It follows that Iso(G, H) is an open\nsubscheme of Hom(G, H).\nProposition 8.39. Let E and E \u2032 be even periodic ring spectra. Then there\nis a natural map SE\u2227E \u2032 \u2212\n\u2192 Iso(GE , GE \u2032 ) of schemes over SE \u00d7 SE \u2032 . This is an\nisomorphism if E or E \u2032 is Landweber exact over M P .\nProof. We write S \u2032 = SE \u2032 and G\u2032 = GE \u2032 . The evident ring maps E \u2212\n\u2192\nq\u2032\n\nq\n\nE \u2227 E\u2032 \u2190\n\u2212 E \u2032 give maps S \u2190\u2212 SE\u2227E \u2032 \u2212\u2192 S \u2032 , and pullback squares\nG\n\n\u2032\n\nu\n\nu\n\nS\n\nwG\n\nGE\u2227E \u2032\nu\n\nu\n\nq\n\nSE\u2227E \u2032\n\nq\n\n\u2032\n\nu\nwS\n\n\u2032\n\nThis gives an isomorphism v : q \u2217 G \u2212\n\u2192 (q \u2032 )\u2217 G\u2032 . Using this, we easily construct the\nrequired map.\nNow consider the case E \u2032 = M P , so that S \u2032 = FGL. Then Iso(G, G\u2032 )(R) is\nthe set of triples (s, F, x), where s \u2208 S(R) and F is a formal group law over R\nb 1 is an isomorphism over spec(R) such that x(g + h) =\nand x : Gs \u2212\n\u2192 spec(R) \u00d7 A\nF (x(g), x(h)). In other words, x is a coordinate on Gs and F is the unique formal\ngroup law such that x(g + h) = F (x(g), x(h)). Thus, we find that Iso(G, G\u2032 ) =\nCoord(G) = M P E = spec(\u03c00 M P ) (see Section 8.6). It follows after a comparison\nof definitions that our map SE\u2227E \u2032 \u2212\n\u2192 Iso(G, G\u2032 ) is an isomorphism.\n\n\f90\n\nNEIL P. STRICKLAND\n\nNow suppose that E \u2032\u2032 is Landweber exact over E \u2032 , in the sense that there is\na ring map E \u2032 \u2212\n\u2192 E \u2032\u2032 which induces an isomorphism E0\u2032\u2032 \u2297E0\u2032 E0\u2032 Z = E0\u2032\u2032 Z for all\nspectra Z. We then find that G\u2032\u2032 = G\u2032 \u00d7S \u2032 S \u2032\u2032 and that\nas required.\n\nSE\u2227E \u2032\u2032 = SE\u2227E \u2032 \u00d7S \u2032 S \u2032\u2032 = Iso(G, G\u2032 ) \u00d7S \u2032 S \u2032\u2032 = Iso(G, G\u2032\u2032 ),\n\nRemark 8.40. If there are enough K\u00fcnneth isomorphisms, then E0 \u03a9\u221e E \u2032 will\nbe a Hopf ring over E0 and thus the \u2217-indecomposables Ind(E0 \u03a9\u221e E \u2032 ) will be an\nalgebra over E0 using the circle product. The procedure described in [15] will then\ngive a map spec(Ind(E0 \u03a9\u221e E \u2032 )) \u2212\n\u2192 Hom(G, G\u2032 ), which is an isomorphism in good\ncases.\nDefinition 8.41. Let G and G\u2032 be formal groups over S and S \u2032 , respectively.\nA fibrewise isomorphism from G to G\u2032 is a square of the form\nG\n\nf\n\nu\n\nS\n\ng\n\nwG\n\n\u2032\n\nu\nwS\n\n\u2032\n\nsuch that the induced map G \u2212\n\u2192 f \u2217 G\u2032 is an isomorphism of formal groups over S.\nDefinition 8.42. We write OFG for the category of ordinary formal groups\nover affine schemes and fibrewise isomorphisms, and EPR for the category of even\nperiodic ring spectra. We thus have a functor EPRop \u2212\n\u2192 OFG sending E to GE .\nWe write LOFG for the subcategory of OFG consisting of Landweber exact formal\ngroups, and LEPR for the category of those E for which GE is Landweber exact.\nProposition 8.43. If E \u2208 EPR and E \u2032 \u2208 LEPR then the natural map\nEPR(E \u2032 , E) \u2212\n\u2192 OFG(GE , GE \u2032 )\n\nis an isomorphism. Moreover, the functor LEPRop \u2212\n\u2192 LOFG is an equivalence of\ncategories.\nProof. Using [13, Proposition 2.12 and Corollary 2.14], we see that there is a\ncofibration P \u2212\n\u2192Q\u2212\n\u2192 E\u2032 \u2212\n\u2192 \u03a3P , in which P and Q are retracts of wedges of finite\nspectra with only even cells, and the connecting map E \u2032 \u2212\n\u2192 \u03a3P is phantom. If W is\nan even finite spectrum then we see from the Atiyah-Hirzebruch spectral sequence\nthat E1 W = 0 and E0 W is projective over E0 and [W, E] = Hom(E0 W, E0 ) and\n[\u03a3W, E] = 0. It follows that all these things hold with W replaced by P or Q.\nUsing the cofibration we see that E1 E \u2032 = 0, and there is a short exact sequence\nE0 P \u058c E0 Q \u0589 E0 E \u2032 .\nNow consider the diagram\n0\n\nw [E , E]\n\u03b1E \u2032\n\n0\n\nw [Q, E]\n\n\u2032\n\nu\n\n\u03b1Q\n\nw Hom(E E , E )\n0\n\n\u2032\n\n0\n\nw [P, E]\n\u03b1P\n\nu\n\nw Hom(E Q, E )\n0\n\n0\n\nu\nw Hom(E P, E ).\n0\n\n0\n\n\fFORMAL SCHEMES AND FORMAL GROUPS\n\n91\n\nThe short exact sequence above implies that the bottom row is exact. The top\nrow is exact because of our cofibration and the fact that [\u03a3P, E] = 0. We have\nseen that \u03b1P and \u03b1Q are isomorphisms, and it follows that \u03b1E \u2032 is an isomorphism.\nThus, [E \u2032 , E] is the set of maps of E0 -modules from E0 E \u2032 to E0 . One can check\nthat the ring maps E \u2032 \u2212\n\u2192 E biject with the maps of E0 -algebras from E0 E \u2032 to\nE0 (using [13, Proposition 2.19]). We see from Proposition 8.39 that these maps\nbiject with sections of SE\u2227E \u2032 = Iso(GE , GE \u2032 ) over SE , and these are easily seen\nto be the same as fibrewise isomorphisms from GE to GE \u2032 . Thus EPR(E \u2032 , E) =\n\u2192 LOFG is full\nOFG(GE , GE \u2032 ), as claimed. This implies that the functor LEPRop \u2212\nand faithful, so we need only check that it is essentially surjective. Suppose that\nG is a Landweber exact ordinary formal group over an affine scheme S. Define a\n\u2297k\ngraded ring E\u2217 by putting E2k+1 = 0 and E2k = \u03c9G/S\nfor all k \u2208 Z, so in particular\nE0 = OS . A choice of coordinate on G gives a formal group law F over OS = E0\nand thus a map S \u2212\n\u2192 FGL or equivalently a map u : M P0 = OFGL \u2212\n\u2192 E0 . If G0 =\nGMP is the evident formal group over FGL then one sees from the construction\nthat S \u00d7FGL G0 = G. Given this, we see that our map u extends to give a map\nM P\u2217 \u2212\n\u2192 E\u2217 . We define a functor from spectra to graded Abelian groups by\nE\u2217 Z = E\u2217 \u2297MP\u2217 M P\u2217 Z = E\u2217 \u2297MU\u2217 M U\u2217 Z,\n\nwhere we have used the map M U \u2212\n\u2192 M P of ring spectra to regard E\u2217 as a module over M U\u2217 . One can also check that E0 Z = E0 \u2297MP0 M P0 Z. The classical\nLandweber exact functor theorem implies that this is a homology theory, represented by a spectrum E. The refinements given in [13, Section 2.1] show that\nE is unique up to canonical isomorphism, and that it admits a canonical commutative ring structure, making it an even periodic ring spectrum. It is easy to\nb MP0 M P 0 CP \u221e and thus that GE = S \u00d7FGL G0 = G, as\ncheck that E 0 CP \u221e = E0 \u2297\nrequired.\nReferences\n\n[1] J. F. Adams. A variant of E. H. Brown's representability theorem. Topology, 10:185\u2013198,\n1971.\n[2] J. F. Adams. Stable Homotopy and Generalised Homology. University of Chicago Press,\nChicago, 1974.\n[3] M. Demazure. Lectures on p-divisible groups. Springer-Verlag, Berlin, 1972. Lecture Notes in\nMathematics, Vol. 302.\n[4] M. Demazure and P. Gabriel. Groupes alg\u00e9briques. Tome I: G\u00e9om\u00e9trie alg\u00e9brique,\ng\u00e9n\u00e9ralit\u00e9s, groupes commutatifs. Masson & Cie, \u00c9diteur, Paris, 1970. Avec un appendice\nCorps de classes local par Michiel Hazewinkel.\n[5] A. D. Elmendorf, I. Kriz, M. A. Mandell, and J. P. May. Rings, Modules and Algebras in\nStable Homotopy Theory, volume 47 of Amer. Math. Soc. Surveys and Monographs. American\nMathematical Society, 1996.\n[6] A. Fr\u00f6lich. Formal Groups, volume 74 of Lecture Notes in Mathematics. Springer\u2013Verlag,\n1968.\n[7] J. P. C. Greenlees and N. P. Strickland. Varieties and local cohomology for chromatic group\ncohomology rings. 40 pp., To appear in Topology, 1996.\n[8] A. Grothendieck and J. L. Verdier. Expos\u00e9 I in Th\u00e9orie des topos et cohomologie \u00e9tale des\nsch\u00e9mas, volume 269 of Lecture Notes in Mathematics. Springer\u2013Verlag, 1972. (SGA 4, second\nedition).\n[9] R. H. Hartshorne. Algebraic Geometry, volume 52 of Graduate Texts in Mathematics.\nSpringer\u2013Verlag, 1977.\n[10] P. Henrici. Applied and computational complex analysis. Vol. 1. Wiley Classics Library. John\nWiley & Sons Inc., New York, 1988. Power series-integration-conformal mapping-location\nof zeros, Reprint of the 1974 original, A Wiley-Interscience Publication.\n\n\f92\n\nNEIL P. STRICKLAND\n\n[11] M. J. Hopkins, M. Ando, and N. P. Strickland. Elliptic spectra, the Witten genus, and the\ntheorem of the cube. 65 pp., Submitted to Inventiones, 1997.\n[12] M. J. Hopkins, N. J. Kuhn, and D. C. Ravenel. Generalised group characters and complex\noriented cohomology theories. Preprint (various editions, since the late 1980's).\n[13] M. Hovey and N. P. Strickland. Morava K-theories and localisation. Mem. Amer. Math. Soc.,\n139(666):104, 1999.\n[14] P. T. Johnstone. Stone spaces, volume 3 of Cambridge Studies in Advanced Mathematics.\nCambridge University Press, 1982.\n[15] T. Kashiwabara, N. Strickland, and P. Turner. The Morava K-theory Hopf ring for BP . In\nAlgebraic topology: new trends in localization and periodicity (Sant Feliu de Gu\u0131\u0301xols, 1994),\nProgr. Math., 136, pages 209\u2013222. Birkh\u00e4user, Basel, 1996.\n[16] N. M. Katz and B. Mazur. Arithmetic Moduli of Elliptic Curves, volume 108 of Annals of\nMathematics Studies. Princeton University Press, 1985.\n[17] M. Lazard. Commutative formal groups. Springer-Verlag, Berlin, 1975. Lecture Notes in\nMathematics, Vol. 443.\n[18] H. Matsumura. Commutative Ring Theory, volume 8 of Cambridge Studies in Advanced\nMathematics. Cambridge University Press, 1986.\n[19] D. G. Quillen. On the formal group laws of unoriented and complex cobordism. Bulletin of\nthe American Mathematical Society, 75:1293\u20131298, 1969.\n[20] D. G. Quillen. Elementary proofs of some results of cobordism theory using Steenrod operations. Advances in Mathematics, 7:29\u201356, 1971.\n[21] D. G. Quillen. The spectrum of an equivariant cohomology ring, I and II. Annals of Mathematics, 94:549\u2013602, 1971.\n[22] D. C. Ravenel. Complex Cobordism and Stable Homotopy Groups of Spheres. Academic Press,\n1986.\n[23] D. C. Ravenel. Nilpotence and Periodicity in Stable Homotopy Theory, volume 128 of Annals\nof Mathematics Studies. Princeton University Press, 1992.\n[24] D. C. Ravenel, W. S. Wilson, and N. Yagita. Brown-Peterson cohomology from Morava Ktheory. K-Theory, 15(2):147\u2013199, 1998.\n[25] N. P. Strickland. Functorial philosophy for formal phenomena. 59 pp., Preprint, 1994.\n[26] N. P. Strickland. Finite subgroups of formal groups. Journal of Pure and Applied Algebra,\n121:161\u2013208, 1997.\n[27] N. P. Strickland. Morava E-theory of symmetric groups. Topology, 37(4):757\u2013779, 1998.\n[28] N. P. Strickland. Products on M U -modules. Trans. Amer. Math. Soc., posted on March 1,\n1999, PII:S 0002-9947(99)02436-8 (31 pp., to appear in print), 1999.\n[29] N. Yagita. The exact functor theorem for BP\u2217 /In \u2013theory. Proceedings of the Japan Academy,\n52:1\u20133, 1976.\n\n\f"}