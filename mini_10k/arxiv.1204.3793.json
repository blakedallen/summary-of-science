{"id": "http://arxiv.org/abs/1204.3793v1", "guidislink": true, "updated": "2012-04-17T13:49:52Z", "updated_parsed": [2012, 4, 17, 13, 49, 52, 1, 108, 0], "published": "2012-04-17T13:49:52Z", "published_parsed": [2012, 4, 17, 13, 49, 52, 1, 108, 0], "title": "Quantum error correction benchmarks for continuous weak parity\n  measurements", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1204.5242%2C1204.2174%2C1204.5292%2C1204.1383%2C1204.6477%2C1204.5524%2C1204.5786%2C1204.0738%2C1204.1019%2C1204.5191%2C1204.2468%2C1204.1045%2C1204.3387%2C1204.1684%2C1204.5855%2C1204.0218%2C1204.1009%2C1204.3518%2C1204.0070%2C1204.2947%2C1204.2525%2C1204.1369%2C1204.2441%2C1204.4721%2C1204.1592%2C1204.4347%2C1204.4830%2C1204.1433%2C1204.5985%2C1204.5144%2C1204.3447%2C1204.3290%2C1204.3375%2C1204.1657%2C1204.4914%2C1204.4130%2C1204.2716%2C1204.1668%2C1204.6547%2C1204.1723%2C1204.0043%2C1204.2454%2C1204.4047%2C1204.5135%2C1204.4038%2C1204.2739%2C1204.2993%2C1204.4533%2C1204.2373%2C1204.4718%2C1204.0362%2C1204.0289%2C1204.6126%2C1204.4484%2C1204.5246%2C1204.0022%2C1204.5430%2C1204.3252%2C1204.1122%2C1204.2211%2C1204.1874%2C1204.3972%2C1204.5543%2C1204.5705%2C1204.0721%2C1204.5825%2C1204.2119%2C1204.4161%2C1204.1161%2C1204.2481%2C1204.2263%2C1204.6134%2C1204.2273%2C1204.0399%2C1204.1566%2C1204.0366%2C1204.1810%2C1204.3271%2C1204.1568%2C1204.3186%2C1204.3793%2C1204.2367%2C1204.2292%2C1204.1238%2C1204.5553%2C1204.6425%2C1204.4575%2C1204.0302%2C1204.3998%2C1204.1361%2C1204.4231%2C1204.2644%2C1204.5340%2C1204.6226%2C1204.0833%2C1204.0912%2C1204.1352%2C1204.5197%2C1204.4732%2C1204.6454%2C1204.1607&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Quantum error correction benchmarks for continuous weak parity\n  measurements"}, "summary": "We present an experimental procedure to determine the usefulness of a\nmeasurement scheme for quantum error correction (QEC). A QEC scheme typically\nrequires the ability to prepare entangled states, to carry out multi-qubit\nmeasurements, and to perform certain recovery operations conditioned on\nmeasurement outcomes. As a consequence, the experimental benchmark of a QEC\nscheme is a tall order because it requires the conjuncture of many elementary\ncomponents. Our scheme opens the path to experimental benchmarks of individual\ncomponents of QEC. Our numerical simulations show that certain parity\nmeasurements realized in circuit quantum electrodynamics are on the verge of\nbeing useful for QEC.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1204.5242%2C1204.2174%2C1204.5292%2C1204.1383%2C1204.6477%2C1204.5524%2C1204.5786%2C1204.0738%2C1204.1019%2C1204.5191%2C1204.2468%2C1204.1045%2C1204.3387%2C1204.1684%2C1204.5855%2C1204.0218%2C1204.1009%2C1204.3518%2C1204.0070%2C1204.2947%2C1204.2525%2C1204.1369%2C1204.2441%2C1204.4721%2C1204.1592%2C1204.4347%2C1204.4830%2C1204.1433%2C1204.5985%2C1204.5144%2C1204.3447%2C1204.3290%2C1204.3375%2C1204.1657%2C1204.4914%2C1204.4130%2C1204.2716%2C1204.1668%2C1204.6547%2C1204.1723%2C1204.0043%2C1204.2454%2C1204.4047%2C1204.5135%2C1204.4038%2C1204.2739%2C1204.2993%2C1204.4533%2C1204.2373%2C1204.4718%2C1204.0362%2C1204.0289%2C1204.6126%2C1204.4484%2C1204.5246%2C1204.0022%2C1204.5430%2C1204.3252%2C1204.1122%2C1204.2211%2C1204.1874%2C1204.3972%2C1204.5543%2C1204.5705%2C1204.0721%2C1204.5825%2C1204.2119%2C1204.4161%2C1204.1161%2C1204.2481%2C1204.2263%2C1204.6134%2C1204.2273%2C1204.0399%2C1204.1566%2C1204.0366%2C1204.1810%2C1204.3271%2C1204.1568%2C1204.3186%2C1204.3793%2C1204.2367%2C1204.2292%2C1204.1238%2C1204.5553%2C1204.6425%2C1204.4575%2C1204.0302%2C1204.3998%2C1204.1361%2C1204.4231%2C1204.2644%2C1204.5340%2C1204.6226%2C1204.0833%2C1204.0912%2C1204.1352%2C1204.5197%2C1204.4732%2C1204.6454%2C1204.1607&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present an experimental procedure to determine the usefulness of a\nmeasurement scheme for quantum error correction (QEC). A QEC scheme typically\nrequires the ability to prepare entangled states, to carry out multi-qubit\nmeasurements, and to perform certain recovery operations conditioned on\nmeasurement outcomes. As a consequence, the experimental benchmark of a QEC\nscheme is a tall order because it requires the conjuncture of many elementary\ncomponents. Our scheme opens the path to experimental benchmarks of individual\ncomponents of QEC. Our numerical simulations show that certain parity\nmeasurements realized in circuit quantum electrodynamics are on the verge of\nbeing useful for QEC."}, "authors": ["Gabrielle Denhez", "Alexandre Blais", "David Poulin"], "author_detail": {"name": "David Poulin"}, "author": "David Poulin", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevA.86.032318", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1204.3793v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1204.3793v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.mes-hall", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1204.3793v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1204.3793v1", "arxiv_comment": null, "journal_reference": "Phys. Rev. A 86, 032318 (2012)", "doi": "10.1103/PhysRevA.86.032318", "fulltext": "Quantum error correction benchmarks for continuous weak parity measurements\nGabrielle Denhez, Alexandre Blais, and David Poulin\nD\u00e9partement de Physique, Universit\u00e9 de Sherbrooke, Sherbrooke, Qu\u00e9bec, Canada J1K 2R1\n(Dated: November 1, 2018)\n\narXiv:1204.3793v1 [quant-ph] 17 Apr 2012\n\nWe present an experimental procedure to determine the usefulness of a measurement scheme for\nquantum error correction (QEC). A QEC scheme typically requires the ability to prepare entangled\nstates, to carry out multi-qubit measurements, and to perform certain recovery operations conditioned\non measurement outcomes. As a consequence, the experimental benchmark of a QEC scheme is a\ntall order because it requires the conjuncture of many elementary components. Our scheme opens\nthe path to experimental benchmarks of individual components of QEC. Our numerical simulations\nshow that certain parity measurements realized in circuit quantum electrodynamics are on the verge\nof being useful for QEC.\n\nI.\n\nINTRODUCTION\n\nThe physical realization of a quantum information processor represents a formidable experimental and theoretical challenge. The inevitable presence of noise and\nimperfections in a physical device causes it to deviate from\nits intended ideal evolution. For any complex information\nprocessing task comprising a large number of elementary\noperations, these deviations can add up to the point of\ncompletely invalidating the information content of the\nprocessor. Experimental efforts are constantly improving\nthe accuracy in the control of quantum devices and reducing the level of noise, but this progress can only make\nit so far, and other methods are required to overcome the\nproblem of noise and imperfections.\nQuantum error correction (QEC) enables, in principle, the coherent manipulation of quantum information\nfor arbitrarily long times, despite the presence of noise\nand imperfections in the physical device [1\u20133]. This is\nachieved by encoding the information redundantly in an\nerror-correction code. The information in the code is\ndelocalized, encoded in the many-body correlations of\nthe qubits. As a consequence, it becomes less vulnerable to local noise. To stabilize the information for long\ntimes, measurements need to be carried on the redundant systems to detect the presence of possible errors\nand evacuate entropy from the system. Following these\nmeasurements, a recovery operation can be executed to\nrestore the content of the processor to its error-free state.\nOf course, the building blocks of any error-correcting\nscheme are themselves subject to faults, and can sometimes introduce more errors in the system than they\nremove. The theory of fault-tolerance quantum computation [4\u20138] demonstrates that, provided that the amount\nof noise in each elementary component is below a certain\nthreshold value, it is possible to use QEC to decrease the\nlevel of residual noise after correction below any desired\nvalue.\nThe exact value of this fault-tolerant error threshold\nis not know, but it can be estimated numerically for\nvarious schemes (e.g. [9, 10]) and theoretical lower bounds\ncan be derived for it (e.g. [11, 12]). However, these\nestimates often require simplifying assumptions and fail\n\nto include all the physical features and limitations of a\ngiven quantum computer architecture. Theoretical efforts\nare being deployed to remove these assumptions as much\nas possible; correlated errors [12], slow measurements\n[13], and nearest-neighbor interactions [9, 14, 15] are\na few examples of limitations that have recently been\nincorporated in theoretical estimates of the threshold.\nIt remains very likely that the true threshold deviates\nsignificantly from these estimates, and thus experimental\ninvestigations of QEC are crucial.\nA handful of experiments [16\u201321] have demonstrated\nthe principles of QEC. Part of the difficulty with the\nimplementation of QEC is that it requires many building\nblocks, and the failure of one of these could invalidate the\nentire process. Depending on the details of the scheme,\nQEC typically requires the preparation of ancilary qubits\nin a known state, projective measurements, unitary control, classical data processing, etc, and moreover each of\nthese components often needs to be realized in a very\nshort time and with high fidelity.\nThe goal of this Article is to demonstrate that some of\nthese QEC building blocks can be tested experimentally\nindividually, without necessarily realizing a full QEC cycle.\nIn particular, we propose a scheme to experimentally\ndecide whether a measurement procedure is sufficiently\ngood to perform QEC. We hope that this important\nsimplification will stimulate experimental research in that\narea, something that could bring new insights to further\nrefine theoretical models. We will pay particular attention\nto the measurement process which, in many solid-state\nqubit architecture, can be slow, weak, and noisy. We\nwill in particular consider weak parity measurements and\nshow that in some conditions such measurements can be\nsuccessfully used in a QEC scheme to reduce the overall\namount of noise. For concreteness, we will illustrate our\nmethods using superconducting qubits in the circuit QED\narchitecture [22, 23], but the ideas extend to other devices.\nAnother problem that we address and that is often disregarded is the need for ultra-fast classical data processing\nto assist the QEC scheme. For instance, the continuous\nerror-correction schemes of Ref. [24] is very effective at\nsuppressing errors in theory, but the data processing it\nentails would require a speed-up of current classical data\nprocessing of several orders of magnitudes before becom-\n\n\f2\ning practical. Fault-tolerant schemes tailored for slow data\nprocessing [13], more cleaver data-processing algorithms\n[25], or even fast FPGA electronics could surmount these\nroadblocks, but they nevertheless remain an obstacle to\ncurrent experimental investigations of QEC. We will show\nthat for the purpose of benchmarking, all data processing\ncan be delayed until after the experiment at no cost.\nThis paper is organized as follows. We first present in\nSec. II an overview of QEC and highlight some difficulties associated to implementation of these ideas with the\nmeasurements typically realized in solid-state qubits. In\nSec. III, we propose a figure of merit that isolates the usefulness of a measurement scheme in a QEC protocol, and\npropose an experimental procedure to evaluate it. The\nvalidity of this experimental procedure is demonstrated\nin the appendix. Section IV presents an numerical application of our method to a recently proposed parity\nmeasurement in circuit quantum electrodynamics architecture [26].\n\nII.\n\nments of the Pauli group, so the statistical evolution of\nthe system is captured by the quantum map E\nE(\u03c1) =\n\nX\n\nPr(E)E\u03c1E,\n\n(1)\n\nE\n\nwhere Pr(E) represents the probability that the Pauli\nerror E = E \u2020 has affected the system. In that case, the\nrecovery operation could consist of applying to the system\nthe Pauli operator E that has the largest probability\nPr(E) and which is consistent with the observed error\nsyndrome. This will be effective since all elements of the\nPauli group square to the identity, so applying the same\nerror twice has no net effect on the system. In certain\ncircumstances, this third step can be partly omitted; it\nis often sufficient to keep in mind that the information\nstore in the encoded qubits has been modified by some\nknown unitary transformation E-i.e. perform a basis\nchange-and unnecessary to revert its action. This is\nsometimes referred to has changing Pauli frame [10, 27].\n\nQUANTUM ERROR CORRECTION\nB.\nA.\n\nDifficulties in application to solid-state qubits\n\nGeneral description\n\nA QEC cycle usually breaks into three steps, the last\none being to some extent optional. In a first step, the\nsystem is initialized to a code state |\u03c8i \u2208 C. The quantum\ncode C is a subspace of the Hilbert space of n physical\nqubits that can be specified by a set of operators Sa , called\nstabilizers. The stabilizers represent constraints on the\nencoded information in the sense that |\u03c8i is a code state if\nand only if it gives the outcome +1 when any stabilizer Sa\nis measured, i.e. C = {|\u03c8i : Sa |\u03c8i = |\u03c8i}. The dimension\nof C determines the number of encoded qubits. When\ndim(C) = 2k , we say that the code encodes k qubits, and\nthat it has a rate k/n, the ratio of encoded qubits per\nphysical qubits. For simplicity, we will here limit our\ndiscussion to codes encoding a single qubit, k = 1.\nAfter the information is encoded, the physical qubits\nare subject to a noisy evolution. The second step of QEC\nconsists of verifying that the state remains inside the code\nafter this evolution. This is achieved by measuring the\nstabilizers Sa , a measurement outcome that differs from\n+1 signalling the presence of errors. The operators Sa are\nusually elements of the Pauli group- i.e., constructed\nfrom tensor products of the three Pauli matrices \u03c3x , \u03c3y ,\nand \u03c3z and the identity-and can therefore only yield\n\u00b11 measurement outcomes. The collection of these \u00b11\nmeasurement outcomes, one per stabilizer Sa , is called\nthe error syndrome.\nThe third and last step consists of reverting, to the\ngreatest possible extent, the effect of the noise. Such a\nrecovery operation can be inferred from a prior statistical description of the noise model-as given, e.g., by a\nrelaxation time T1 and a dephasing time T\u03c6 -and the\nadditional information obtained from the error syndrome.\nIt is common to assume that the errors E are also ele-\n\nIn practice, many of the usual assumptions described\nabove are not met in solid-state devices, and this leads\nto additional burdens for experimental investigations of\nQEC. First and foremost, breaking the QEC cycle into\ndiscrete steps-a noisy evolution followed by a projective\nmeasurement-is not always possible. Measurements of\nsolid-state qubits are often slow, and errors will occur on\nthe system during the course of these measurements.\nIn addition to being slow, measurements are noisy. For\nexample, often, the experimental outcome for the measurement of a Pauli operator will be a continuous and\nnoisy signal rather than a binary \u00b11 value. This is, for\nexample, the case with an heterodyne measurement in\ncircuit QED [28]. Of course, the noisy signal can be integrated over a period of time and discretized to be treated\nas binary, but this would entail a loss of precious information about the errors, as we will see below. Measurements\ncan be omitted, but at the price of performing multi-qubit\ngates (outside the Clifford group) and resetting auxiliary\nqubits [21].\nLastly, the noise affecting solid-state devices (and other\nqubit architectures) does not correspond to a simple statistical distribution Pr(E) over elements of the Pauli group.\nInstead, we usually model the evolution of these systems\nby a master equation of the Lindblad form. This more\ncomplicated evolution has several consequences. In general, it requires an error-diagnostic protocol far more\ncomplex than the one described above for Pauli operators\nthat simply consisted of optimizing Pr(E) over a subset\nof Pauli operators. In addition, the optimal recovery operation found by the error-diagnostic protocol will not\nbe a simple unitary transformation, but instead will be\na general quantum map. The physical realization of this\nmap could be beyond today's technologies. Moreover,\n\n\f3\nbecause the recovery will typically not be a unitary transformation, it cannot be regarded as a basis change and\nit becomes imperative to implement it physically, an additional experimental burden. One can always pretend\nthat the noise model is a Pauli channel and perform error\ncorrection following the usual approach. However, this\nwill inevitably entail a loss of performances, so it does not\nwell reflect the usefulness of the measurement scheme.\n\nrelaxes, corresponding to the operator \u03c3 \u2212 \u2297 I \u2297 I \u2297 I, the\ninitial state \u03b1|0\u0304i + \u03b2|1\u0304i maps to\n\u03b1|0111i + \u03b2|0100i,\n\nretaining all the information about the encoded state.\n\nIII.\nC.\n\nTwo examples of quantum codes\n\nWe will illustrate our methods to test QEC building\nblocks using two different error correcting codes. The first\none is the bit flip code [1]. It uses n = 3 qubits and has\nstabilizers S1 = \u03c3z \u2297 \u03c3z \u2297 I and S2 = I \u2297 \u03c3z \u2297 \u03c3z . Thus,\nthe code C is spanned by the two states |0\u0304i = |000i and\n|1\u0304i = |111i. As its name suggests, this code is effective at\ncorrecting bit flip errors that invert the two basis states\n|0i \u2194 |1i, corresponding to the quantum operation \u03c3x .\nOn an encoded state \u03b1|0\u0304i + \u03b2|1\u0304i, flipping the first qubit\nwould lead to a state of the form \u03b1|100i + \u03b2|011i, with\nerror syndrome S1 = \u22121 and S2 = +1. Similarly, flipping\nthe second qubit produces the syndrome (\u22121, \u22121) and\nflipping the third qubit produces (+1, \u22121). Thus, any\nsingle-qubit flip can be uniquely identified and corrected\nby an additional flip.\nFlipping two qubits leads to the same syndrome as\nflipping only the complementary qubit. For instance, an\nerror that flips the first two qubits E = \u03c3x \u2297 \u03c3x \u2297 I\nleads to the syndrome (+1, \u22121), and would be mistaken\nfor the error E 0 = I \u2297 I \u2297 \u03c3x flipping only the third\nqubit. Correcting the error E with the misdiagnosed\nflip E 0 would have the net effect of flipping the encoded\nstate from \u03b1|0\u0304i + \u03b2|1\u0304i to \u03b1|1\u0304i + \u03b2|0\u0304i. Thus, the code can\ncorrect any one-bit flip, but fails at correcting two-bit\nflip. For a noise model where each qubit is independently\nflipped with probability p, the code would have a failure\n\u0001\n\u0001\u22121\nprobability 32 p2 , a net gain when p < 32\n= 13 .\nIn practice however, bit-flip is not the dominant source\nof noise in solid-state devices, so the bit-flip code is not\nvery relevant. We nonetheless choose to use this code to\nillustrate some of our schemes because it is conceptually\nvery simple. Note that in this paper, whenever we use\nthis code, we will artificially change the noise model of\nthe device, adapting it for the purpose of illustration with\nthe bit flip code.\nThe second code we study is tailored to deal with\nrelaxation processes [29], which are more directly relevant\nfor solid-state qubits. Indeed, relaxation is the main error\nchannel in superconducting qubits, and pure dephasing\nnoise is often negligible in comparison [30]. The code uses\nn = 4 qubits and has stabilizers S1 = \u03c3z \u2297 \u03c3z \u2297 I \u2297 I,\nS2 = I \u2297 I \u2297 \u03c3z \u2297 \u03c3z , and S3 = \u03c3x \u2297 \u03c3x \u2297 \u03c3x \u2297 \u03c3x .\nThus, the code C is spanned by the two basis states\n|0\u0304i = \u221a12 (|0000i + |1111i) and |1\u0304i = \u221a12 (|0011i + |1100i).\nAlthough the workings of this code is more intricate, one\ncan gain some intuition by noting that when the first qubit\n\n(2)\n\nBENCHMARKING THE MEASUREMENT\nA.\n\nIsolating the measurement\n\nStabilizers can always be measured indirectly by performing an appropriate multi-qubit gate, followed by\nsingle qubit measurement. Alternatively, they can be\nmeasured directly using some sort of generalized parity\nmeasurement. For instance, the parity measurement proposed in [26, 31\u201333] can be used to measure two-qubit\nstabilizers, which includes all the stabilizers from the\nexamples described above with the exception of S3 in\nthe last example. While both approaches are viable, our\nscheme will focus on such direct stabilizer measurements.\nThe question we would like to answer now is: Can a\ngiven physical realization of a parity measurements be\nsuccessfully used in a QEC scheme to reduce the overall\namount of noise? One way to answer this question is\nto use the parity measurement in an experimental QEC\nprotocol and check that the resulting noise rate is reduced. However, this method would provide an answer\nthat depends on all the components of the QEC protocol. For instance, perfect parity measurements combined\nwith noisy recovery operations could lead to an overall\nuseless scheme. Here we will show how to decouple these\nquestions and propose a method to evaluate the quality\nof the measurement alone.\nTo decouple the measurement process from the other\ncomponents of the QEC scheme, it is useful to consider\nthe following two gedanken experiments. In the first experiment, the system is prepared in a random unknown\ncode state |\u03c8i, and subject to noisy evolution for a time\nT , resulting is a mixed state \u03c1 = E(\u03a8). Here and throughout, we use capital Greek letters to denote the density\nmatrix corresponding to a pure state \u03a8 = |\u03c8ih\u03c8|. E is the\ncompletely positive trace-preserving (CPTP) map that describes the evolution of the system for time T . After this\ntime, the optimal recovery operation is performed on \u03c1 to\nmaximize the fidelity to the initial state. This recovery\noperation can be anything allowed by the laws of quantum\nmechanics, including measurements, unitary transformations, coupling to an external system, etc. Thus, it can\nbe described by a CPTP map R. In other words, one\nchooses the CPTP map R that maximizes the quantity\nFR (\u03c8) = h\u03c8|R(\u03c1)|\u03c8i = h\u03c8|R(E(\u03a8))|\u03c8i, averaged over all\ncode states |\u03c8i. The average performance of this scheme\ncan be summarized by the average fidelity\nZ\nF\u03041 = max FR (\u03c8)d\u03c8.\n(3)\nR\n\n\f4\nIn the second thought experiment, the system is again\nprepared in a random unknown code state |\u03c8i. Then, continuous weak parity measurements of the stabilizers {Si }\nare performed for a time T to stabilize the encoded states.\nThe outcome of these measurements is a collection of\ncontinuous current J (t) = {Ji (t)}, one for each measured\nstabilizer generator. Of course, while these measurements\nare being performed, the system undergoes its noisy evolution and suffers from measurement back-action. The\ncombined effect of the noisy evolution and the measurements results in a state \u03c1 = EJ (\u03a8), where EJ is a completely positive (CP) map that depends on the observed\ncurrents J . At time T , after the evolution, one can apply\na recovery R which yields a fidelity to the initial state\nFR (\u03c8, J ) = h\u03c8|RJ (\u03c1)|\u03c8i = h\u03c8|RJ (EJ (\u03a8))|\u03c8i. Clearly,\nthe optimal choice of R will depend on the observed currents J . The average performance of this scheme can be\nsummarized by the average fidelity\n\u0014\n\u0012Z\n\u0013\u0015\nF\u03042 = E max\nFR (\u03c8, J )P (\u03c8|J )d\u03c8\n(4)\nR\n\nJ\n\nwhere E[*]J stands for the average over the output currents J , whose distribution depends on the initial state\n|\u03c8i and can be modeled by the conditional probability P (J |\u03c8). The probability P (\u03c8|J ) is obtained from\nP (J |\u03c8) via Bayes rule. We denote RJ the recovery that\nmaximizes the average fidelity given an output current\nJ.\nOur original question of whether the parity measurement can be used in a QEC scheme to reduce the overall amount of noise can then be answered positively if\nF\u03041 < F\u03042 . Indeed, the only difference between Eq. (3) and\nEq. (4) is that in the latter, the system's dynamics is\naltered by the presence of measurements and one uses\nthe outcome of these measurements to design the optimal\nrecovery. The presence of the measurement can lower the\nfidelity because of the measurement back-action, but it\ncan also increase the fidelity because it brings information about the stochastic evolution of the system. Thus,\nF\u03041 < F\u03042 means that including the measurement had an\noverall positive effect.\n\nB.\n\nstate |\u03c6i = \u221a12 (|0\u0304i \u2297 |0iR + |1\u0304i \u2297 |1iR ) that is maximally\nentangled between the code space and some auxiliary reference qubit. Here, the subscript R denotes the reference\nqubit. The entanglement fidelity describes how well this\nentangled state was preserved by the combined effect of\nthe noise EJ and the recovery RJ :\nFe (J ) = h\u03c6|RJ (EJ (\u03a6))|\u03c6i\n\n(5)\n\nwhere it is understood that both RJ and EJ act only on\nthe system, i.e. the reference qubit evolves trivially. The\naverage fidelity and the entanglement fidelity are related\ne d+1\nby F\u0304 = Fd+1\nwhere d is the dimension of the code space,\nin the present case d = 2.\nThus, maximizing the average fidelity is equivalent to\nmaximizing the entanglement fidelity. This is an important conceptual simplification because it only requires\noptimizing the fidelity for one given initial state-an\nentangled state between the system and the reference\nqubit-and therefore leads to a simple numerical procedure. All we need to do is to numerically integrate the\nmaster question for the system including noise, given the\ninitial state |\u03c6i and taking into account the observed currents J [26, 34]. The outcome of such a simulation is\na mixed state which we will denote \u03a9EJ = (EJ \u2297 I)(\u03a6).\nFor a recovery operation R, the entanglement fidelity can\nnow be expressed as\nFe = h\u03c6|(R \u2297 I)(\u03a9EJ )|\u03c6i\n= Tr(\u03a9R\u2020 \u03a9EJ ),\n\n(6)\n\nwhere \u03a9R = R(\u03a6). Thus, the optimal recovery can be\nfound by maximizing Tr(\u03a9R\u2020 \u03a9EJ ) over \u03a9R , subject to\nthe constraint that R is a CPTP map, i.e. \u03a9R \u2265 0\nand TrR \u03a9R = I, where TrR stands for the partial trace\nover the reference qubit. This optimization problem is a\nsemi-definite program [35], and can be efficiently solved.\nTo summarize, the optimal recovery RJ for a given set\nof output currents J , can be found by first integrating the\nevolution equation for an input state entangled between\nthe code space and a reference qubit, and then solving\na semi-definite program. Both of these can be realized\nin polynomial time as a function of the dimension of the\nHilbert space of the system and the duration T of the\nexperiment.\n\nOptimal recovery\n\nIn this section, we explain how to mathematically construct the optimal recovery maps R needed for the two\ngedanken experiments described above. We will focus\non the second type of experiment, corresponding to F\u03042\nand where continuous parity measurements are performed.\nThe case without measurements follows trivially by removing all references to the output currents J . The\naverage fidelity to the initial state F\u0304 is a good figure of\nmerit because it has a simple interpretation. However,\nit is mathematically more convenient to use a slightly\ndifferent figure of merit called the entanglement fidelity\nFe defined as follows. Imagine preparing the system in a\n\nC.\n\nDelayed tomography\n\nSo far, we have described how to compute the optimal\nrecovery operation R to revert the effect of some evolution\nE, that may or may not contain contributions from parity\nmeasurements. This recovery is chosen to maximize the\naverage fidelity over the code space. The usual way to\nassess this protocol experimentally is to perform quantum\nprocess tomography on the map E[RJ EJ ]J (or RE in the\nabsence of measurements), describing the joint effect of\nthe measurement and the recovery. This can be realized\nexperimentally as follows.\n\n\f5\n1. Prepare a code state |\u03c8i i.\n2. Let the system evolve according to EJ .\n\nThis procedure is repeated M times, and the average\nentanglement fidelity F\u0304e = E[Fe (J )]J can be estimated\nby\n\n3. Compute the optimal recovery RJ .\n\nM\n\n4n+1 X [`] [`]\n[`]\n[`]\n2\n\u03c4 \u03bd Tr(\u03a9 \u2020 Bk \u2297 \u03c3 [`] ),\nRJ\nM\n\n4. Apply the optimal recovery RJ to the system.\n\n(7)\n\n`=1\n\n5. Measure some observable Aj .\nRepeating this sequence many times provides an estimate\nof E[Tr{Aj RJ (EJ (|\u03c8i ih\u03c8i |))}]J . Varying over the initial\nstate |\u03c8i i and final measurement Aj provides complete\ninformation about the map E[RJ EJ ]J . From this complete description, on can directly compute the average\nfidelity.\nThere are two obvious problems with this approach.\nFirst, the optimal recovery RJ might be beyond what\ncan be realized with today's technologies, so step 4 cannot\nbe realized. Second, when EJ is the evolution resulting\nfrom the combined effects of noise and parity measurements, the optimal recovery RJ depends on the observed\nmeasurement currents J . In that case, the procedure to\ncompute RJ described in Sec. III B must be realized in\nreal time. With the integration of the evolution equation\nof a 3-4 qubit system taking several seconds, the system\nwill have long completely decohered before the recovery\noperation can even be applied.\nWe propose a method to directly estimate the average\nfidelity that circumvents these problems. The intuitive\nidea is to invert steps 4 and 5 in the above procedure, i.e.\nmeasure a complete set of observables before applying the\nrecovery. So crudely, we can imagine that we are characterizing the state EJ (\u03a6) before applying the recovery,\nand then computing what would have been the resulting\nfidelity had we applied the recovery. The problem with\nthis crude explanation is that the state EJ (\u03a6) changes at\nevery run of the experiment because it depends on the\nobserved currents Jj (t). Thus, this naive approach only\nreveals the average state E[EJ (\u03a6)]J , which washes away\nthe information content of Jj (t) that should have been\nused to determine the optimal recovery.\nNevertheless, the essence of the idea is right and, borrowing some ideas from Refs. [36, 37], we will show that\nthe following scheme can be used to estimate the average\nfidelity.\n1. Choose \u03c3 randomly among the Pauli operators and\na random \u03c4 = \u00b1. Prepare the n physical qubits in\nthe state |\u03c8\u0304\u03c3\u03c4 i, that is the eigenstate with eigenvalue\n\u03c4 of the encoded operators \u03c3, i.e. a state among the\nset {|0\u0304i, |1\u0304i, |0\u0304i \u00b1 |1\u0304i, |0\u0304i \u00b1 i|1\u0304i}.\n2. Let the system evolve according to EJ , and collect\nthe currents J .\n3. Measure the observable Bk chosen uniformly at\nrandom from the set of n-qubit Pauli operators,\nobtaining the result \u03bd.\n4. Compute the optimal recovery operation RJ .\n\nwhere the superscript [`] makes reference to the `th realization of the procedure. In this altered scheme, the\nexperimental work ends at step 3; step 4 and the computation of fidelity can be delayed as post processing. The\nvalidity of Eq. (7) is demonstrated in appendix A.\n\nIV.\n\nEXAMPLE: PARITY MEASUREMENT IN\nCIRCUIT QED\nA.\n\nParity measurement\n\nAs a concrete example of QEC measurements benchmark, we focus on the 3 and 4-qubit codes discussed above\nand consider a realization in circuit QED. These ideas\nare however general and apply to other systems. We will\nconsider the continuous two-qubit parity measurement\nproposed in Ref. [26] for circuit QED. Note that two-qubit\nparity measurements are sufficient to implement the bitflip code, but insufficient for the relaxation code that also\ncontains the stabilizer S3 = \u03c3x \u2297 \u03c3x \u2297 \u03c3x \u2297 \u03c3x . In our case\nstudy, this third stabilizer will simply be ignored, only the\nstabilizers that involve a simple two-qubit parity being\nmeasured. Since S3 is responsible for the correction of\nphase errors that occur on a longer timescale T2 = 2T1 , we\nexpect that measurement of the two-qubit parities alone\ncan lead to an improved error rate, and this is confirmed\nby our numerical simulation.\nBefore presenting the numerical results, we first give\na brief overview of circuit QED. In this architecture, a\nsuperconducting qubit is dipole coupled, with strength\ng, to the zero-point electric field of a transmission-line\nresonator [22, 23]. In the regime where the detuning \u2206\nbetween the qubit transition frequency \u03c9a and the resonator frequency \u03c9r is large with respect to the coupling\nstrenght, |\u2206| = |\u03c9a \u2212 \u03c9r | \u001d g, the electric-dipole interaction leads to a dispersive coupling of the qubit and the\nresonator of the form \u03c7a\u2020 a\u03c3z , where \u03c7 = g 2 /\u2206. This\ninteraction can be interpreted as a qubit-state depend\nshift of the resonator frequency to \u03c9r + \u03c7\u03c3z . As a result,\na coherent tone of frequency \u03c9m \u223c \u03c9r and amplitude\n\u000fm driving the resonator will displace the intra-resonator\nfield, initially assumed to be in the vacuum state, to a\nqubit-state-dependent coherent state |\u03b1\u03c3 i of amplitude\n\u03b1\u03c3 = \u2212\u000fm / [\u03c9r + (\u22121)\u03c3 \u03c7 \u2212 \u03c9m \u2212 i\u03ba/2]. In this expression, \u03ba is the resonator photon-loss rate and \u03c3 = {0, 1}\nstands for the two qubit states. These two coherent state\ncan be resolved by homodyne detection of the coherent\ndrive transmitted or reflected by the resonator, thereby\nrealizing a measurement of the qubit [38].\n\n\f6\n\n\u039101\n\u039110\n\n\u039111\n\n0.4\n\n0.2\n\n0.0\n\n0.99\n0.98\n1.0\n0.8\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nQuadrature, Q\n\n1.0\n\n1.2\n\nFIG. 1: (color online) Phase space illustration of the stationary\nstates |\u03b1\u03c3\u03c30 i for: g1 = \u2212g2 = \u221215\u03ba and \u03c7j \u223c 1.5\u03ba. The\nmeasurement drive is such that \u03c9m = \u03c9r and \u000fm = \u03ba/2.\n\nA similar situation holds if multiple qubits are dispersively interacting with the resonator. For example, in the presence of two qubits, the resonator frequency is shifted to the two-qubit state dependent value\n\u03c9r +\u03c71 \u03c3z \u2297I+\u03c72 I\u2297\u03c3z , where \u03c7j is the dispersive coupling\nof qubit j. This leads to four possible qubit-state dependent coherent states |\u03b1\u03c3 i, where now \u03c3 = {00, 01, 10, 11},\nand that can be resolved in a homodyne detection [39].\nAs shown in Refs. [26, 40], it is possible to adjust the\nfrequency of the measurement tone, the dispersive couplings and the frequency and phase of the local oscillator\nused in the homodyne detection such that the measurement only reveals information about the parity of the\njoint two-qubit states. This is illustrated in Fig. 1 where\nthe parameters have been chosen such that the coherent\nstates corresponding to even qubit parity {|00i, |11i} overlay, while those corresponding to odd parity {|01i, |10i}\nalmost do 1 . In this situation, homodyne detection of the\nQ quadrature of the resonator field will yield information\nabout the qubit parity, and nothing about the individual\nqubit state. In other words, for the settings of Fig. 1,\nthe measurement operator in circuit QED takes the form\n\u03c3z \u2297 \u03c3z , exactly what is required for the stabilizers S1 and\nS2 of the two quantum error correcting codes discussed\nabove. Moreover, these two stabilizers can be measured\nsimultaneously, for example, by using a two-resonator\nsetup where the pair of qubits to be jointly measured is\nfabricated in the same resonator. For the 3-qubit code,\nthis means that one of the qubit must be coupled to\ntwo resonators, something that has already been realized\nexperimentally [41].\n\n1\n\nIt is not possible for the coherent states corresponding to odd\nparity to perfectly overlay if the even ones do, and vice-versa.\nWith the parameters chosen for Fig. 1, this results in measurementinduced dephasing of superpositions of the odd parity states [26].\n\n0.6\n0.4\n\nc)\n\n0.98\n\na)\nFidelity\n\n0.0\n0.2\n\nFidelity\n\n\u039100\n\n0.2\n\n1.00\n\n1.00\n\nFidelity\n\nIn-Phase, I\n\n0.4\n\nb)\nOptimal QEC with meas.\n\n0.96\n\n0.94\n\nOptimal QEC without meas.\nTextbook QEC\nSingle qubit\n\n10 20 30 40 50 60 70\nTime \u001fns\u001e\n\n0.92\n0 0.2 0.4 0.6 0.8 1\nDetection efficiency, \u03b7\n\nFIG. 2: (color online) a-b) Fidelity vs time for optimal QEC\nwith (blue line) and without (green line) parity measurements,\ntextbook QEC (purple line) and unencoded single qubit evolution (yellow line). Panel a) is a zoom of panel b) in the\nregion close to unit fidelity. c) Fidelity vs detection efficiency\n\u03b7 taken at t = 48 ns as indicated by the vertical dashed line in\npanels a) and b). In all cases, the parameters are \u03c7/2\u03c0 = 120\nMHz, \u03ba/2\u03c0 = 50 MHz, \u03b3x /2\u03c0 = 5 MHz. When measurement\nis present, \u03b7 = 1 [in panels a) and b)] and \u000f/2\u03c0 = 40 MHz.\nThe results where averaged over 8000 trajectories.\n\nB.\n\nNumerical results\n\nFig. 2 presents the fidelity as a function of time for the\nthree-qubit code under continuous measurement of the\nsyndromes S1 and S2 . These results were obtained by\nnumerical integration of the stochastic master equation\n(SME) found in Eq. (2) of Ref. [26] and using the parameters indicated in the caption. This SME describes the\nevolution of two qubits coupled to the same resonator\nand under continuous parity measurement realized, as\ndiscussed above, by homodyne detection of the signal\ntransmitted through the resonator. Since the 3-qubit\ncode protects against bit flips, and not relaxation, we\nreplaced the qubit damping term in this SME by a term\nrepresenting symmetric bit flips. We have also dropped\npure dephasing since both the 3 and 4 qubit codes do\nnot protect against this noise source (and many superconducting qubits in circuit QED suffer only very weakly\nfrom pure phase damping [30]). These are the only modifications made to the results of Ref. [26].\nIn this Figure, the blue and green lines correspond\nto the fidelity after optimal recovery, respectively in the\npresence and absence of continuous weak parity measurements. These results are compared to the fidelity of a\nsingle unencoded qubit (yellow line). For the chosen parameters, we see that it is always beneficial to encode\nthe information (blue and green line are above the yellow one), but that the benefit of weak measurements\ndepends on the duration of the experiment. Thus, even\nwith optimal recovery, continuous syndrome measurement\ndoes not always help. Indeed, below \u223c 25 ns, measurement backaction [26] disrupts the encoded state more that\n\n\f7\n1.00\n\na)\n\nb)\n\n0.98\n\nFidelity\n\n0.96\n0.94\n0.92\n0.90\n\nOptimal QEC with meas.\nOptimal QEC without meas.\nSingle qubit\n\n0.88\n0.86\n\n0\n\nto an unencoded qubit, the green line to optimal recovery\nin the absence of continuous measurements and, finally,\nthe blue line to optimal recovery with continuous measurement of S1 and S2 . Compared to the three-qubit code,\nthe case with measurement always do as good, or better,\nthan without measurement. This is because measurementinduced dephasing acts in the odd-parity subspace [26].\nThis, combined with the fact that the four-qubit codewords are of even parity and that relaxation never bring\na superposition of encoded states to a superposition of\nodd-parity state2 , yields the enhanced result compare to\nthe three-qubit code.\n\n20 40 60 0 0.2 0.4 0.6 0.8 1\nDetection efficiency, \u03b7\nTime \u001fns\u001e\n\nFIG. 3: (color online) a) Fidelity vs time for optimal QEC\nwith (blue line) and without (green line) parity measurements,\nand unencoded single qubit case (yellow line). b) Fidelity vs\ndetection efficiency \u03b7 taken at t = 48 ns as indicated by the\nvertical dashed line in panel a). The parameters are the same\nas in Fig. 2.\n\nthe acquired information helps. Beyond that time, the\nmeasurement record can be used to improve the optimal\nrecovery.\nThe purple line shows the fidelity obtained by a direct\napplication of textbook QEC. The continuous weak stabilizer measurements are performed for a time t, after which\nthe output signal are integrated and round-up to a \u00b11\nvalue. The simplest Pauli operator consistent with this\nround-up error syndrome is applied to the state. At early\ntimes, the fidelity of this scheme approaches 1/4. This is\nbecause the integration of the output signal is essentially\nrandom, so the recovery will essentially consist in flipping\none of the 3 qubits or none at all, each option having\nprobability 1/4. Since at early times it is likely that the\nqubit has not suffered any errors at all, only 1 out of\nthese 4 options is correct, explaining the 1/4 fidelity. The\nfidelity reaches a maximum at a subsequent time, when\nthe syndrome measurements reveal useful information\nabout the error. Yet, it does not reach the fidelity under\noptimal recovery. This is because, as explained above,\nthe optimal recovery can be any CPTP map, while this\ntextbook application is limited to a recovery that flips\none of the three qubits. As intuitively expected, the time\nscale where this maximum occurs corresponds roughly\nto the time scale where weak measurements provide an\nadvantage under optimal recovery; prior to this time the\nmeasurement signal is essentially random.\nFig. 3 shows similar results for the four qubit code.\nSince this code protects against relaxation (and not symmetric bit flips), this is the type of noise that was numerically simulated to generate these results. This situation\nis therefore closer to the experimental reality. Using the\nsame color code as in Fig. 2, the yellow line corresponds\n\nC.\n\nPossible experimental realization\n\nIs this protocol experimentally realistic? First, we\nemphasize that, with delayed tomography, the recovery\noperation need not be applied in the laboratory. It is\nonly applied, after the fact, on the tomographically reconstructed state. The most stringent requirement is on\nthe quality of the parity measurements, something that\ndepends on the details of the implementation. In this\nrespect, all the circuit QED parameters that we have\nchosen are within experimental reach, except one: the\ndetection efficiency \u03b7. This parameter corresponds to\nthe the efficiency with which photons used for the syndrome measurements are detected. The results presented\nin Figs. 2 and 3 have been obtained by setting \u03b7 = 1,\nabove what can now be realized. Indeed, most experiments use cold amplifiers with a rather low detection\nefficiency \u03b7 \u2248 0.05. Recent experiments with near quantum limited amplifiers have reached \u03b7 \u2248 1/3 [42], and\nvalues approaching unity should be realizable in the near\nfuture. To evaluate the importance of this parameter,\nthe fidelity, evaluated at t = 48 ns, is plotted versus \u03b7 in\nFigs. 2c) and 3b). For the three qubit code, because of\nthe measurement-induced dephasing, the weak syndrome\nmeasurements do not help until a rather high value of\n\u03b7 \u223c 0.85. For the more experimentally relevant case of\nthe four-qubit code, because this backaction does not\ndamage the encoded state, measurement helps even at\nlow efficiency.\nThe two other parameters worth commenting on are the\ncoupling strength g and the relaxation rate \u03b31 . Our choice\nof \u03c7/2\u03c0 = 120 MHz and \u03bb = g/\u2206 = 1/10 3 correspond to\na qubit-resonator coupling strength of g/2\u03c0 = 1200 MHz,\n\n2\n\n3\n\nNote for example that the state in Eq. (2) can be written as\n|01i\u2297(\u03b1|11i+\u03b2|00i), and contains no superpositions of odd parity\nstates that would undergo measurement-induced dephasing.\nThe value of \u03bb = g/\u2206 = 0.1 is chosen such that the system\nis in the dispersive regime where the results of Ref. [26] hold.\nFor the same reason, we have also chosen the measurement tone\namplitude \u000f such that the average photon number in the resonator\nis always smaller than about a tenth of the critical photon number\nncrit = (\u2206/2g)2 [22].\n\n\f8\na value that is beyond current experiments by about a\nfactor of four [21]. An architecture to realize this type of\n'ultra-strong' coupling has been theoretically proposed [43]\nand tested experimentally with g/2\u03c0 \u223c 600MHz [44, 45].\nThe value used here is thus not beyond reach. Finally, the\nrelaxation rate \u03b31 /2\u03c0 = 5 MHz used here is more than an\norder of magnitude larger than recently achieved [46, 47].\nAdjusting this rate to the best current experimental value\nwould relax the constraints on all the other parameters.\nLastly, our scheme is sensitive to state initialization\nerrors. These are estimated to be at the percent level [48]\nbut can be reduced by using measurements to initialize\nthe qubits [49, 50].\n\nV.\n\nDISCUSSION\n\nThe method we have presented offers the possibility\nto experimentally determine if a measurement scheme\nis useful for a given QEC protocol, without the need to\nrealize the full QEC protocol. In particular, there is no\nneed in our method to implement the recovery operation\non the system and all data analysis are delayed until after\nthe experiment-in particular there is no operation that\nis realized on the system conditioned on the outcome of\nprevious measurements.\nThere are obvious limitations to our scheme. On the\none hand, a negative answer does not imply that the measurement scheme is of no use in QEC, but merely as used\nin a prescribed scheme. In principle, there can exist QEC\nschemes that are more or less sensitive to measurement\nimperfections than other. On the other hand, a positive\nanswer only indicates that the measurement is useful in\nprinciple, but other limitations, such as imperfect unitary\ncontrol and slow data processing, could render the entire scheme useless. Despite these limitations, we believe\nthat our scheme is of interest at this early stage of information processing devices, and in particular for devices\nwhere distinct measurement schemes are currently being\ndevelopped.\nThe type of syndrome measurement that we have considered in this Article are of a special type that we call\ndirect: the output signal at time t is directly correlated\nwith the value of the measured observable at that time\n(or a slightly earlier time). This type of measurement is\nto be distinguish from an indirect measurement where\nan ancillary system is coupled to the measured qubits\nand measured at a later time. For instance, a syndrome\nmeasurement can be realized by applying cnot gates to an\nancillary qubit and then measuring that ancillary qubit\nin the computational basis. In a direct measurement,\nthe signal history correlates with the noise history, so\nthere is information to be gained by analyzing the entire\nsignal rather than simply considering its average. In an\nindirect measurement, all the correlations between the\nerror-corrected qubits and the ancillary qubit are established at the beginning (and on a very short time scale),\nso the signal history is uncorrelated to the noise history\n\non the error-corrected qubit (but correlated instead to\nerror history on the ancillary qubit). While some of the\ntechniques we have proposed could be extended to an\nindirect measurement setting, it is not clear how to decouple the measurement imperfection from the imperfections\narising in the unitary control in a measurement scheme\nthat relies on unitary control. 4\nFinally, another interesting error correcting code to\nstudy with this architecture is the Bacon-Shor code [51\u2013\n53]. The main motivations for this code is that it is\nspatially local in a 2D architecture, requires only two-qubit\nparity measurements, and can correct all type of errors.\nThe complications arise because the parity measurements\nneed to be in complementary basis, and our theoretical\ntreatment would need to be generalized to subsystem\ncodes [51, 54].\nAcknowledgments\n\nWe thank K. Lalumi\u00e8re, M. P. da Silva and M. Boissonneault for discussions and help with the numerical\ncalculations. This work was partially funded by FQRNT,\nNSERC, the Alfred P. Sloan Foundation, and CIFAR.\nAppendix A: Estimation of the average\nentanglement fidelity\n\nFor a complete set of observables Aj satisfying\nTr(Aj Ak ) = d\u03b4jk , for example Pauli operators where\nd = 2, we can express the entanglement fidelity as\nFe = Tr(\u03a9R\u2020 \u03a9EJ )\nJ\n1X\nTr(\u03a9R\u2020 Aj )Tr(\u03a9EJ Aj ).\n=\nJ\nd j\n\n(A1)\n\nLet us denote by |\u03c8\u03c3\u03c4 i \u2208 {|0i, |1i, |0i \u00b1 |1i, |0i \u00b1 i|1i} the\neigenstates of the Pauli operators, i.e. \u03c3|\u03c8\u03c3\u03c4 i = \u03c4 |\u03c8\u03c3\u03c4 i and\nsimilarly, let us denote by |\u03c8\u0304\u03c3\u03c4 i \u2208 {|0\u0304i, |1\u0304i, |0\u0304i \u00b1 |1\u0304i, |0\u0304i \u00b1\ni|1\u0304i} the encoded versions. We can decompose the Pauli\noperator Aj = Bk \u2297 \u03c3 into a component Bk on the n\nphysical qubits forming the QEC code and a Pauli matrix\n\u03c3 acting on the reference qubit. This enables us to write\n\u2212\nTr(\u03a9EJ Aj ) = Tr{Bk EJ (\u03a8\u0304+\n\u03c3 )} \u2212 Tr{Bk EJ (\u03a8\u0304\u03c3 )}. (A2)\n\nCombining with Eq. (A1), we obtain\nXX X\nFe =\n\u03c4 Tr(\u03a9R\u2020 Bk \u2297\u03c3)Tr{Bk EJ (\u03a8\u0304\u03c4\u03c3 )}. (A3)\nk\n\n4\n\n\u03c3 \u03c4 =\u00b1\n\nJ\n\nIn the circuit QED architecture we have considered, the cavity is\ncoupled to the qubit throughout the measurement process. Even\nthough the cavity serves as an ancillary system, the measurement\ncannot be decomposed into a two stage process (unitary coupling\nfollowed by a measurement) and is thus of the direct type.\n\n\f9\nSimilarly, we can take a spectral decomposition of Bk =\nPk+ \u2212 Pk\u2212 to obtain\nFe =\n\nXX X\nk\n\n\u03c4 \u03bdTr(\u03a9R\u2020 Bk \u2297 \u03c3)Tr{Pk\u03bd EJ (\u03a8\u0304\u03c4\u03c3 )}\n\n\u03c3 \u03c4,\u03bd=\u00b1\n\nJ\n\n(A4)\nThe first term Tr(\u03a9R\u2020 Bk \u2297 \u03c3) of this expression can\nJ\nbe evaluated numerically given knowledge of RJ . Let us\ndenote\nPr(\u03bd, \u03c4, k, \u03c3) =\n\nTr{Pk\u03bd EJ (\u03a8\u0304\u03c4\u03c3 )}\n.\n2 * 4n+1\n\n(A5)\n\nrandom among the 4n n-qubit Pauli operators; choosing\n\u03c3 uniformly at random among the 4 single-qubit Pauli\noperators; \u03c4 uniformly at random between \u00b11; and \u03bd\nat random according to the probability Tr{Pk\u03bd EJ (\u03a8\u0304\u03c4\u03c3 )}.\nThese probabilities correspond exactly to probability with\nwhich the experiment described in Sec. III C generates\nthe values k, \u03c3, \u03c4 , and \u03bd.\nFinally, rewriting\nFe = 4n+1 2\n\nX\n\n\u03c4 \u03bdTr(\u03a9R\u2020 Bk \u2297 \u03c3) Pr(\u03bd, \u03c4, k, \u03c3),\nJ\n\nk,\u03c3,\u03c4,\u03bd\n\nThis can be interpreted as a probability distribution; it\nis positive and sums to 1. Moreover, one can efficiently\nsample from this distribution by choosing k uniformly at\n\nwe recognize Eq. (7) as a Monte Carlo estimate of the\nentanglement fidelity Fe .\n\n[1] P. W. Shor, Phys. Rev. A 52, 2493 (1995).\n[2] A. M. Steane, Proc. R. Soc. Lond. A 452, 2551 (1996).\n[3] D. Gottesman, Stabilizer codes and quantum error correction, Ph.D. thesis, California Institute of Technology,\nPasadena, CA (1997).\n[4] P. W. Shor, in Proceedings of the 37th Symposium on\nthe Foundations of Computer Science (IEEE press, Los\nAlamitos, California, 1996), pp. 56\u201365.\n[5] A. Y. Kitaev, in Proceedings of the third International\nConference on Quantum Communication and Measurement, edited by O. Hirota, A. S. Holevo, and C. M. Caves\n(Plenum, New York, 1997), pp. 181\u2013188.\n[6] E. Knill, R. Laflamme, and W. H. Zurek, Science 279,\n342 (1998).\n[7] D. Aharonov and M. Ben-Or, in Proc. 29th. Ann. ACM\nSymp. on Theory of Computing (1997), longer version\nquant-ph/9906129.\n[8] J. Preskill, Proc. R. Soc. Lond. A 454, 385 (1998).\n[9] R. Raussendorf and J. Harrington, Phys. Rev. Lett. 98,\n190504 (2007).\n[10] E. Knill, Nature 434, 39 (2005).\n[11] B. Reichardt, in Automata, Languages and Programming,\nedited by M. Bugliesi, B. Preneel, V. Sassone, and I. Wegener (Springer Berlin / Heidelberg, 2006), vol. 4051 of\nLecture Notes in Computer Science, pp. 50\u201361.\n[12] P. Aliferis, D. Gottesman, and J. Preskill, Quant. Info.\nand Comp. 6, 97 (2006).\n[13] D. P. DiVincenzo and P. Aliferis, Phys. Rev. Lett. 98,\n020501 (2007).\n[14] D. Gottesman, Journal of Modern Optics 47, 333 (2000).\n[15] K. M. Svore, B. M. Terhal, and D. P. DiVincenzo, Phys.\nRev. A. 72 (2005).\n[16] D. G. Cory, W. Maas, M. Price, E. Knill, R. Laflamme,\nW. H. Zurek, T. F. Havel, and S. S. Somaroo, Phys. Rev.\nLett. 81, 2152 (1998).\n[17] E. Knill, R. Laflamme, R. Martinez, and C. Negrevergne,\nPhys. Rev. Lett. 86, 5811 (2001).\n[18] J. Chiaverini, D. Leibfried, T. Schaetz, M. D. Barrett,\nR. B. Blakestad, J. Britton, W. M. Itano, J. D. Jost,\nE. Knill, C. Langer, R. Ozeri, and D. J. Wineland, Nature\n432, 602 (2004).\n[19] O. Moussa, J. Baugh, C. A. Ryan, and R. Laflamme,\n\nPhys. Rev. Lett. 107, 160501 (2011).\n[20] J. Zhang, D. Gangloff, O. Moussa, and R. Laflamme,\nPhys. Rev. A 84, 034303 (2011).\n[21] M. D. Reed, L. DiCarlo, S. E. Nigg, L. Sun, L. Frunzio,\nS. M. Girvin, and R. J. Schoelkopf, Nature 482, 382\n(2012).\n[22] A. Blais, R.-S. Huang, A. Wallraff, S. M. Girvin, and R. J.\nSchoelkopf, Phys. Rev. A 69, 062320 (2004).\n[23] A. Wallraff, D. I. Schuster, A. Blais, L. Frunzio, R.-S.\nHuang, J. Majer, S. Kumar, S. M. Girvin, and R. J.\nSchoelkopf, Nature 431, 162 (2004).\n[24] C. Ahn, A. C. Doherty, and A. J. Landahl, Phys. Rev. A\n65, 042301 (2002).\n[25] B. A. Chase, A. J. Landahl, and J. Geremia, Phys. Rev.\nA 77, 032304 (2008).\n[26] K. Lalumi\u00e8re, J. M. Gambetta, and A. Blais, Phys. Rev.\nA 81, 040301 (2010).\n[27] A. M. Steane, Physical Review A 68, 042322 (2003).\n[28] R. Bianchetti, S. Filipp, M. Baur, J. Fink, M. Goppl,\nP. Leek, L. Steffen, and A. W. A. Blais, Phys. Rev. A 80,\n043840 (2009).\n[29] D. W. Leung, M. A. Nielsen, I. L. Chuang, and Y. Yamamoto, Phys. Rev. A 56, 2567 (1997).\n[30] A. A. Houck, J. A. Schreier, B. R. Johnson, J. M. Chow,\nJ. Koch, J. M. Gambetta, D. I. Schuster, L. Frunzio, M. H.\nDevoret, S. M. Girvin, and R. J. Schoelkopf, Physical\nReview Letters 101, 080502 (2008).\n[31] W. Mao, D. V. Averin, R. Ruskov, and A. N. Korotkov,\nPhys. Rev. Lett. 93, 056803 (2004).\n[32] B. Trauzettel, A. N. Jordan, C. W. J. Beenakker, and\nM. B\u00fcttiker, Physical Review B (Condensed Matter and\nMaterials Physics) 73, 235331 (2006).\n[33] J. Kerckhoff, L. Bouten, A. Silberfarb, and H. Mabuchi,\nPhys. Rev. A 79, 024305 (2009).\n[34] H. M. Wiseman and G. J. Milburn, Phys. Rev. A 47, 642\n(1993).\n[35] A. S. Fletcher, P. W. Shor, and M. Z. Win, Physical\nReview A 75, 012338 (2007).\n[36] M. P. da Silva, O. Landon-Cardinal, and D. Poulin, Phys.\nRev. Lett. 107, 210404 (2011).\n[37] S. T. Flammia and Y. Liu, Physical Review Letters 106,\n230501 (2011).\n\n\f10\n[38] A. Wallraff, D. I. Schuster, A. Blais, L. Frunzio, J. Majer,\nS. M. Girvin, and R. J. Schoelkopf, Phys. Rev. Lett. 95,\n060501 (2005).\n[39] J. Majer, J. M. Chow, J. M. Gambetta, J. Koch, B. R.\nJohnson, J. A. Schreier, L. Frunzio, D. I. Schuster, A. A.\nHouck, A. Wallraff, A. Blais, M. H. Devoret, S. M. Girvin,\nand R. J. Schoelkopf, Nature 449, 443 (2007).\n[40] S. Filipp, P. Maurer, P. J. Leek, M. Baur, R. Bianchetti,\nJ. M. Fink, M. G\u00f6ppl, L. Steffen, J. M. Gambetta, A. Blais,\nand A. Wallraff, Phys. Rev. Lett. 102, 200402 (2009).\n[41] B. R. Johnson, M. D. Reed, A. A. Houck, D. I. Schuster,\nL. S. Bishop, E. Ginossar, J. M. Gambetta, L. DiCarlo,\nL. Frunzio, S. M. Girvin, and R. J. Schoelkopf, Nat Phys\n6, 663 (2010).\n[42] C. Macklin, R. Vijay, and I. Siddiqi, personal communication.\n[43] J. Bourassa, J. M. Gambetta, A. A. A. Jr, O. Astafiev,\nY. Nakamura, and A. Blais, Phys. Rev. A 80, 032109\n(2009).\n[44] T. Niemczyk, F. Deppe, H. Huebl, E. P. Menzel, F. Hocke,\nM. J. Schwarz, J. J. Garcia-Ripoll, D. Zueco, T. Hummer,\nE. Solano, A. Marx, and R. Gross, Nat Phys 6, 772 (2010).\n[45] P. Forn-D\u0131\u0301az, J. Lisenfeld, D. Marcos, J. J. Garc\u0131\u0301a-Ripoll,\nE. Solano, C. J. P. M. Harmans, and J. E. Mooij, Phys.\n\nRev. Lett. 105, 237001 (2010).\n[46] H. Paik, D. I. Schuster, L. S. Bishop, G. Kirchmair,\nG. Catelani, A. P. Sears, B. R. Johnson, M. J. Reagor,\nL. Frunzio, L. I. Glazman, S. M. Girvin, M. H. Devoret,\nand R. J. Schoelkopf, Phys. Rev. Lett. 107, 240501 (2011).\n[47] C. Rigetti, S. Poletto, J. M. Gambetta, B. L. T. Plourde,\nJ. M. Chow, A. D. Corcoles, J. A. Smolin, S. T. Merkel,\nJ. R. Rozen, G. A. Keefe, M. B. Rothwell, M. B. Ketchen,\nand M. Steffen (2012).\n[48] A. Palacios-Laloy, F. Mallet, F. Nguyen, F. Ong, P. Bertet,\nD. Vion, and D. Esteve, Physica Scripta 2009, 014015\n(2009).\n[49] J. E. Johnson, C. Macklin, D. H. Slichter, R. Vijay, E. B.\nWeingarten, J. Clarke, and I. Siddiqi (2012).\n[50] D. Rist\u00e8, J. G. van Leeuwen, H.-S. Ku, K. W. Lehnert,\nand L. DiCarlo (2012).\n[51] D. Poulin, Phys. Rev. Lett. 95, 230504 (2005).\n[52] D. Bacon, Phys. Rev. A 73, 012340 (2006).\n[53] P. Aliferis and A. Cross, Phys. Rev. Lett. 98, 220502\n(2007).\n[54] D. Kribs, R. Laflamme, and D. Poulin, Phys. Rev. Lett.\n94, 180501 (2005).\n\n\f"}