{"id": "http://arxiv.org/abs/0709.0588v2", "guidislink": true, "updated": "2008-03-11T14:37:43Z", "updated_parsed": [2008, 3, 11, 14, 37, 43, 1, 71, 0], "published": "2007-09-05T08:11:04Z", "published_parsed": [2007, 9, 5, 8, 11, 4, 2, 248, 0], "title": "Optimization of Short Coherent Control Pulses", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0709.3837%2C0709.1552%2C0709.0567%2C0709.4031%2C0709.0614%2C0709.3041%2C0709.0924%2C0709.2650%2C0709.2829%2C0709.3920%2C0709.2072%2C0709.0823%2C0709.2572%2C0709.2397%2C0709.0856%2C0709.0956%2C0709.3281%2C0709.1140%2C0709.1542%2C0709.0291%2C0709.3673%2C0709.0588%2C0709.0494%2C0709.0015%2C0709.3753%2C0709.4239%2C0709.3014%2C0709.0644%2C0709.2446%2C0709.4635%2C0709.3027%2C0709.0938%2C0709.0720%2C0709.3151%2C0709.0491%2C0709.0583%2C0709.0289%2C0709.4374%2C0709.0037%2C0709.0630%2C0709.4531%2C0709.3995%2C0709.3841%2C0709.1842%2C0709.1586%2C0709.2830%2C0709.0878%2C0709.2735%2C0709.1129%2C0709.1404%2C0709.0266%2C0709.3353%2C0709.3564%2C0709.1358%2C0709.1155%2C0709.2661%2C0709.4436%2C0709.4051%2C0709.0638%2C0709.0192%2C0709.1053%2C0709.3792%2C0709.1064%2C0709.0327%2C0709.1345%2C0709.0769%2C0709.2232%2C0709.0212%2C0709.2692%2C0709.4345%2C0709.0770%2C0709.1745%2C0709.0581%2C0709.3898%2C0709.3438%2C0709.2915%2C0709.2199%2C0709.2280%2C0709.1302%2C0709.3134%2C0709.3928%2C0709.1798%2C0709.3805%2C0709.2430%2C0709.2675%2C0709.4315%2C0709.3341%2C0709.1294%2C0709.1554%2C0709.1681%2C0709.2303%2C0709.4039%2C0709.4049%2C0709.1825%2C0709.2635%2C0709.2210%2C0709.1857%2C0709.1571%2C0709.3947%2C0709.0852%2C0709.2643&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Optimization of Short Coherent Control Pulses"}, "summary": "The coherent control of small quantum system is considered. For a two-level\nsystem coupled to an arbitrary bath we consider a pulse of finite duration. We\nderive the leading and the next-leading order corrections to the evolution\noperator due to the non-commutation of the pulse and the bath Hamiltonian. The\nconditions are computed that make the leading corrections vanish. The pulse\nshapes optimized in this way are given for $\\pi$ and $\\frac{\\pi}{2}$ pulses.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0709.3837%2C0709.1552%2C0709.0567%2C0709.4031%2C0709.0614%2C0709.3041%2C0709.0924%2C0709.2650%2C0709.2829%2C0709.3920%2C0709.2072%2C0709.0823%2C0709.2572%2C0709.2397%2C0709.0856%2C0709.0956%2C0709.3281%2C0709.1140%2C0709.1542%2C0709.0291%2C0709.3673%2C0709.0588%2C0709.0494%2C0709.0015%2C0709.3753%2C0709.4239%2C0709.3014%2C0709.0644%2C0709.2446%2C0709.4635%2C0709.3027%2C0709.0938%2C0709.0720%2C0709.3151%2C0709.0491%2C0709.0583%2C0709.0289%2C0709.4374%2C0709.0037%2C0709.0630%2C0709.4531%2C0709.3995%2C0709.3841%2C0709.1842%2C0709.1586%2C0709.2830%2C0709.0878%2C0709.2735%2C0709.1129%2C0709.1404%2C0709.0266%2C0709.3353%2C0709.3564%2C0709.1358%2C0709.1155%2C0709.2661%2C0709.4436%2C0709.4051%2C0709.0638%2C0709.0192%2C0709.1053%2C0709.3792%2C0709.1064%2C0709.0327%2C0709.1345%2C0709.0769%2C0709.2232%2C0709.0212%2C0709.2692%2C0709.4345%2C0709.0770%2C0709.1745%2C0709.0581%2C0709.3898%2C0709.3438%2C0709.2915%2C0709.2199%2C0709.2280%2C0709.1302%2C0709.3134%2C0709.3928%2C0709.1798%2C0709.3805%2C0709.2430%2C0709.2675%2C0709.4315%2C0709.3341%2C0709.1294%2C0709.1554%2C0709.1681%2C0709.2303%2C0709.4039%2C0709.4049%2C0709.1825%2C0709.2635%2C0709.2210%2C0709.1857%2C0709.1571%2C0709.3947%2C0709.0852%2C0709.2643&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The coherent control of small quantum system is considered. For a two-level\nsystem coupled to an arbitrary bath we consider a pulse of finite duration. We\nderive the leading and the next-leading order corrections to the evolution\noperator due to the non-commutation of the pulse and the bath Hamiltonian. The\nconditions are computed that make the leading corrections vanish. The pulse\nshapes optimized in this way are given for $\\pi$ and $\\frac{\\pi}{2}$ pulses."}, "authors": ["S. Pasini", "T. Fischer", "P. Karbach", "G. S. Uhrig"], "author_detail": {"name": "G. S. Uhrig"}, "author": "G. S. Uhrig", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevA.77.032315", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0709.0588v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0709.0588v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "9 pages, 6 figures; published version", "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.mes-hall", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.str-el", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0709.0588v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0709.0588v2", "journal_reference": "Physical Review A 77, 032315 (2008)", "doi": "10.1103/PhysRevA.77.032315", "fulltext": "Optimization of Short Coherent Control Pulses\nS. Pasini,1 T. Fischer,1 P. Karbach,1 and G. S. Uhrig1\n1\n\nLehrstuhl f\u00fcr Theoretische Physik I, Technische Universit\u00e4t Dortmund,\nOtto-Hahn Strasse 4, 44221 Dortmund, Germany\n(Dated: November 16, 2018)\n\narXiv:0709.0588v2 [quant-ph] 11 Mar 2008\n\nThe coherent control of small quantum system is considered. For a two-level system coupled to\nan arbitrary bath we consider a pulse of finite duration. We derive the leading and the next-leading\norder corrections to the evolution operator due to the non-commutation of the pulse and the bath\nHamiltonian. The conditions are computed that make the leading corrections vanish. The pulse\nshapes optimized in this way are given for \u03c0 and \u03c02 pulses.\nPACS numbers: 03.67.Lx,03.67.Pp,03.65.Yz,76.60.-k\n\nI.\n\nINTRODUCTION\n\nFor a long time, the coherent control of quantum systems has been an important issue. For instance, nuclear\nmagnetic resonance (NMR) is a widely used technique\nfor the analysis of chemical compounds and for imaging techniques. Another broad field of application is the\ncoherent control of the state of quantum dots, both in\nthe charge and in the spin degrees of freedom. In recent\nyears, however, coherent control has gained an even more\nvivid interest because it is the indispensable prerequisite\nin quantum information processing.\nIn its most basic form, the quantum state of a single\nquantum bit (qubit) is to be changed in a given way. This\nis called a single qubit gate. A qubit is a two-level system\nwhich can be conveniently seen as S = 1/2 system. So we\nuse this spin language to describe the qubit gates. The\ntwo most common gates are the \u03c0 pulse, which flips the\nspin from up to down and vice-versa, and the \u03c0/2 pulse\nor Hadamard gate, which rotates the spin by 90\u25e6 away\nfrom the Sz direction.\nThe \u03c0 pulse is particularly interesting for dynamic decoupling [1, 2, 3, 4, 5, 6, 7, 8]. In a nutshell, this technique\naims at decoupling the single qubit from its environment\nas well as possible by switching the qubit state by single\nqubit gates. Mostly, the \u03c0 pulse is considered. The idea\ncomes from the spin-echo technique in NMR where a \u03c0\npulse is used to refocus the precessing magnetization. In\nNMR, the use of sophisticated protocols of \u03c0 and \u03c0/2\npulses is common to suppress unwanted couplings between nuclear spins [9, 10].\nExperiments using \u03c0 pulses have obtained many encouraging results in prolonging the coherence time of a\nqubit [11, 12, 13, 14]. More complex pulse sequences\nbased on \u03c0/2 pulses have also proved useful by deminishing the rate of decoherence in quantum registers considerably [15].\nIn the theoretical treatments the generic ingredient\nto dynamic decoupling is an idealized pulse, mostly a\n\u03c0 pulse, which is considered to be instantaneous. This\nmeans that its amplitude is infinite in the sense of a\n\u03b4-function. This assumption is convenient because the\nHamiltonian H0 of the pulse and the Hamiltonian H\n\nof the system at rest do not commute in general. The\nHamiltonian H comprises the Hamiltonian of the qubit\nitself, the Hamiltonian of the environment (henceforth\ncalled \"bath\") and the coupling between the qubit and\nthe bath which is responsible for its decoherence. But\nduring the pulse H0 dominates and H is negligible and\nfor the rest of the time only H is present. Hence it is relatively straightforward to deal with the time evolution.\nExperimentally, however, this idealized situation is not\nrealistic. The real pulses are always of finite amplitude\nand of finite length. So the question has to be addressed\nwhich effect a finite pulse duration \u03c4p has. We want to\nelucidate this issue in the present work theoretically in a\nfully quantum mechanical framework.\nThe issue of pulses of finite duration and finite amplitude has been considered in other papers. Viola and Knill\ngeneralized their previous approach of averaging over a\nsymmetry group [16] by instantaneous changes of the effective Hamiltonian to continuous changes requiring only\nfinite, bounded control amplitudes [17]. But the presence of the coupling to the bath during the pulses has\nnot been considered.\nKhodjasteh and Lidar considered the effect of finite\npulse duration in a comprehensive comparison of various\nschemes for \u03c0 pulse sequences [18]. They did not consider to make the detrimental effects of the finite pulse\nduration vanish on the level of the individual pulse, but\nthey discussed possible cancellations on the higher hierarchical level of the pulse sequence. In the present work,\nwe will choose another route and aim at reducing the\ndecoherence due to finite pulse duration already on the\nlevel of the single pulse. As a side remark, we note that\nthe statement in Ref. 18 on optimized pulse sequences\n[8] that they hold only for bosonic bath operators is very\nlikely not to be correct. It has been conjectured very\nrecently by Lee et al. [19] that the optimized sequences\napply to the most general phase decoherence model.\nVery recently, the effect of classical random telegraph\nnoise during pulses of finite length has been discussed\nnumerically [20]. It was shown that shaping the pulse\namplitude in a particular way can be used to improve\nits performance. This means that one can optimize the\npulse such that its effect is closer to the desired one, e.g.\n\n\f2\n\nII.\n\nMODEL\n\nWe consider the time evolution operator from t = 0 to\nt = \u03c4p\n\u001a\n\u0012 Z\nUp (\u03c4p , 0) = T exp \u2212i\n\n0\n\n\u03c4p\n\nH0 (t)dt \u2212 iH\u03c4p\n\n\u0013\u001b\n\n. (1)\n\n10\n\n(a)\n\n8\n\nv(t) [1/\u03c4p]\n\na \u03c0 pulse.\nTuning pulses by shaping them is a possibility of optimization which has been discussed intensively in the vast\nliterature on NMR. But the objectives were mostly different from the consideration of the effects of a bath. For\ninstance, Geen and Freeman aimed at frequency selectivity [21], i.e. the pulse should act only on spins on or close\nto resonance, but leave others unchanged. Closest to our\nscope are the investigations by Tycko [22], Cummins et\nal. [23, 24], and Brown et al. [25] where composite pulses\nare optimized to be robust against off-resonance effects\nand pulse length inaccuracies. Again, no dynamic but\nonly static effects are considered. Interestingly, we will\nsee that some of the pulse shapes fulfilling the conditions\nin first order derived here for fully dynamical baths coincide with pulse shapes previously derived to compensate\nstatic effects.\nIn this work, we present a systematic expansion in the\npulse duration \u03c4p considering a qubit coupled to a fully\nquantum mechanical and dynamical bath. This means\nthat the related energy scale \u03c9p := 1/\u03c4p (~ is set to unity\nfor simplicity) is considered to be very large so that all\nother energy scales, namely the coupling \u03bb between qubit\nand bath and the internal energy scale of the bath \u03c9b ,\nare small relative to \u03c9p . We expand in \u03bb/\u03c9p = \u03c4p \u03bb and\n\u03c9b /\u03c9p = \u03c4p \u03c9b . The zeroth order is the instantaneous\npulse. We compute the first and the second order and\ndiscuss the conditions for which they vanish. These conditions allow us to predict pulse shapes which approximate instantaneous pulses in spite of their finite pulse\nduration.\nWe emphasize that it is not our primary aim to eliminate the coupling between qubit and bath. On the contrary, it turns out that the expansion around the instantaneous pulse keeps this coupling. But the coupling to\nthe bath is disentangled from the actual pulse. They are\nexpressed by separate, subsequent time evolution operators. Given the thus optimized pulse shapes, the coupling to the bath can be compensated on the higher hierarchical level of an appropriate pulse sequence, i.e., by\ndynamic decoupling [1, 2, 3, 4, 5, 6, 7, 8].\nThe paper is organized as follows. After introducing\nthe model (Sect. II), we start describing the method we\nused to derive our general equations for the first and second order (Sect. III). Then we discuss the results and\nprovide various examples for pulses that satisfy our conditions (Sect. IV). At last we discuss our results and compare them with other proposals for shaped pulses in the\nliterature (Sect. V).\n\n6\n\n\u03c6(t)\n\n4\n2\n0\n\n\u03c4p\n\n\u03c4s\n\n-2\n\nt\n\n-4\n(b)\n\u03a6 \u03b4(t-\u03c4s)\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\nt [ \u03c4p]\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nFigure 1: (a) Plot of a generic pulse v(t). The x- and y-axis\nvalues are expressed in units of \u03c4p and 1/\u03c4p , respectively. The\nshaded region represents an example for \u03c6(t), that is the integrated pulse amplitude between the instant \u03c4s and a generic\ninstant t (see text).\n(b) Sketch of the approximately equivalent idealized instantaneous pulse.\n\nFor simplicity the pulse is chosen to start at t = 0; T\nstands for the usual time-ordering. The control Hamiltonian of the pulse shall be given by\nH0 = v(t)\u03c3y ,\n\n(2)\n\nwhere v(t) stands for the pulse shape as function of time,\nsee Fig. 1. The time-independent Hamiltonian of the\nbath and the coupling to the qubit reads\nH = Hb + \u03bbA\u03c3z ,\n\n(3)\n\nwith Hb representing a generic bath and A its coupling\noperator to the qubit. The internal energy scale of Hb\nshall be denoted by \u03c9b . Note that H0 and H do not\ncommute so that the evolution operator (1) is a nontrivial expression.\nThe model (3) does not include spin flips; hence it implies an infinite life time T1 . But the decoherence of a\nprecessing spin in the xy plane is described in full generality because we do not specify for which operator A\nstands and the bath dynamics described by Hb . Such a\nmodel is experimentally very well justified as the effective model in the limit of a large applied magnetic field\nwhich implies that other couplings between the quantum\nbit spin and the bath are averaged out, see for instance\nRef. 26, 27.\nAs an example only one may consider the spin-boson\nmodel\nX\nX\n\u03bbi (b\u2020i + bi )\n(4)\n\u03c9i b\u2020i bi + \u03c3z\nH=\ni\n\ni\n\nwith \u03bb := maxi \u03bbi , A =\nmaxi \u03c9i .\n\nP\n\n\u2020\ni (\u03bbi /\u03bb)(bi\n\n+ bi ) and \u03c9b :=\n\n\f3\nThe primitive of the pulse amplitude is\n\u03c6(t) :=\n\nZ\n\nt\n\nv(t\u2032 )dt\u2032 ,\n\n(5)\n\n\u03c4s\n\nwhere the integration starts from an instant \u03c4s \u2208 [0, \u03c4p ].\nThe intended angle of rotation is given by twice the total\narea under the curve \u03b8 := 2\u03a6 = 2(\u03c6(\u03c4p ) \u2212 \u03c6(0)). This\narea has to be kept constant while investigating the limit\n\u03c4p \u2192 0 so that the amplitude v(t) has to tend to infinity\nas v(t) \u221d 1/\u03c4p . To simplify our notation later, we define\nalso \u03c8(t) := 2\u03c6(t).\nThe aim is to replace the real pulse given by v(t) by\nan approximately equivalent instantaneous pulse acting\nat the instant \u03c4s , see Fig. 1. The equivalence shall hold\nup to linear order or quadratic order in \u03c4p . We highlight\nthat the time evolution before and after the equivalent instantaneous pulse shall be governed by H, i.e., including\nthe decohering interaction between qubit and bath. This\nshall be accounted for on the higher hierarchical level of\nappropriate pulse sequences.\n\nIII.\n\nMETHOD AND GENERAL EQUATIONS\nA.\n\nGeneral Equation\n\nLet \u03c4s be an arbitrary instant inside the interval [0, \u03c4p ]\nat which we want to split the time evolution\nUp (\u03c4p , 0) = Up (\u03c4p , \u03c4s ) Up (\u03c4s , 0) .\n\n(6)\n\nThe guiding idea is shown in Fig. 1b. We want to replace\nthe full evolution by a first part during [0, \u03c4s ] where only\nthe Hamiltonian H is active. Then the instantaneous\npulse shall follow. Finally, another intervall [\u03c4s , \u03c4p ] of\nthe dynamics governed by H terminates the pulse. This\nmotivates the two following ans\u00e4tze for the two unitary\noperators in Eq. 6\nUp (\u03c4p , \u03c4s ) = e\u2212i(\u03c4p \u2212\u03c4s )H e\u2212i\u03c3y\nUp (\u03c4s , 0) = U1 (\u03c4s , 0) e\n\n\u2212i\u03c3y\n\nR \u03c4p\n\nR \u03c4s\n0\n\n\u03c4s\n\nv(t)dt\n\nv(t)dt\n\ne\n\nU2 (\u03c4p , \u03c4s ) (7a)\n\n\u2212i\u03c4s H\n\n,\n\n(7b)\n\nwhich define the operators U1 (\u03c4s , 0) and U2 (\u03c4p , \u03c4s ).\nBoth, U1 and U2 must be seen as the corrections which\nare necessary because the left hand sides in Eqs. 7 do\nnot equal the right hand sides without them since the\npulse and the bath Hamiltonians do no commute. Note\nthat no time-ordering is necessary for the exponential of\nH because it is constant. For the exponential of H0 no\ntime-ordering is necessary despite the time dependence\nbecause the commutator [H0 (t), H0 (t\u2032 )] = 0 for any two\ntimes t and t\u2032 .\nIf the corrections are small, e.g. U2 (\u03c4p , \u03c4s )U1 (\u03c4s , 0) =\n1 + O(\u03c4p2 ) up to linear order in \u03c4p , this implies\nUp (\u03c4p , 0) = e\u2212i(\u03c4p \u2212\u03c4s )H e\u2212i\u03c3y\n\nR \u03c4p\n0\n\nv(t)dt \u2212i\u03c4s H\n\ne\n\n(8)\n\nwhich corresponds to the ideal, instantaneous pulse\nsketched in Fig. 1b at \u03c4s while the dynamics before and\nafter \u03c4s includes both the bath dynamics and the coupling between qubit and bath.\nThe unitary corrections U1 and U2 are determined from\nthe Schr\u00f6dinger equation. We start analyzing U2 (7a).\nLet \u03c4 be a time instant in the interval ]\u03c4s , \u03c4p ] such that\nUp (\u03c4, \u03c4s ) = e\u2212i\u2206\u03c4 H e\u2212i\n\nR\u03c4\n\n\u03c4s\n\nH0 (t)dt\n\nU2 (\u03c4, \u03c4s ) ,\n\n(9)\n\nwhere we use the difference\n\u2206x := x \u2212 \u03c4s\n\n(10)\n\ngenerally for any variable x; here in particular for x = \u03c4 .\nThe Schr\u00f6dinger equation of Up (\u03c4, \u03c4s ) is the usual one\ni\u2202\u03c4 Up (\u03c4, \u03c4s ) = (H0 (\u03c4 ) + H) Up (\u03c4, \u03c4s ) .\n\n(11)\n\nInserting Eq. (9) into (11) one obtains\n\b\n\nHe\u2212i\u2206\u03c4 H + e\u2212i\u2206\u03c4 H H0 (\u03c4 ) e\u2212i\n+i e\u2212i\u2206\u03c4 H e\n= (H0 (\u03c4 ) + H)e\n\n\u2212i\n\n\u2212i\u2206\u03c4 H\n\nR\u03c4\n\n\u03c4s\n\nH0 (t)dt\n\nR\u03c4\n\nH0 (t)dt\n\n\u2212i\n\nR\u03c4\n\ne\n\n\u03c4s\n\n\u03c4s\n\nU2 (\u03c4, \u03c4s )\n\n\u2202\u03c4 U2 (\u03c4, \u03c4s )\n\nH0 (t)dt\n\nU2 (\u03c4, \u03c4s ) . (12)\n\nIt is easy to see that the terms with H cancel so that the\ndifferential equation for U2 becomes\n\u0010\n\u0011\ne 0 (\u03c4 ) \u2212 H0 (\u03c4 ) U2 (\u03c4, \u03c4s ) ,\ni\u2202\u03c4 U2 (\u03c4, \u03c4s ) = H\n(13a)\nwhere\n\ne 0 (\u03c4 ) := ei\nH\n\nR\u03c4\n\n\u03c4s\n\nH0 (t)dt i\u2206\u03c4 H\n\ne\n\nH0 (\u03c4 )e\u2212i\u2206\u03c4 H e\u2212i\n\nFormal integration leads to\n\u0014\n\u0012 Z\nU2 (\u03c4, \u03c4s ) = T exp \u2212i\n\n\u03c4\n\nF (t)dt\n\n\u03c4s\n\n\u0013\u0015\n\n,\n\nR\u03c4\n\n\u03c4s\n\nH0 (t)dt\n\n.\n(13b)\n\n(14a)\n\nwhere\ne 0 (t) \u2212 H0 (t).\nF (t) := H\n\n(14b)\n\n\u03c3y (\u2206t) := ei\u2206tH \u03c3y e\u2212i\u2206tH\n\n(15)\n\nFrom its defintion it is obvious that F (t) vanishes identically if H0 and H commute. This is the case if there is\nno coupling between qubit and bath. Closer inspection\nof Eqs. (13b,14b) shows that F (t) = O(t\u03bbv(t)). More\ngenerally, F (t) can be expanded in a series of H, i.e. in\nthe parameters t\u03bb and t\u03c9 which amounts up to an expansion in \u03c4p . Thus our approach provides the intended\nexpansion in the shortness of the pulse.\nWith the definitions\n\nand (5) the time-dependent operator F (t) can be written\nin the compact form\ni\nh\n(16)\nF (t) = v(t) ei\u03c3y \u03c6(t) \u03c3y (\u2206t) e\u2212i\u03c3y \u03c6(t) \u2212 \u03c3y .\n\n\f4\nNext, we treat U1 by the analogous procedure solving\nthe Schr\u00f6dinger equation for (7b). Let \u03c4 be a generic\ninstant in the interval [0, \u03c4s [, the ansatz for this interval\nis\nUp (\u03c4s , \u03c4 ) = U1 (\u03c4s , \u03c4 ) ei\u03c6(\u03c4 )\u03c3y ei\u2206\u03c4 H .\n\n(17)\n\nTo obtain the Schr\u00f6dinger equation in the second time\nargument of U1 (\u03c4s , \u03c4 ) it is convenient to consider the\nhermitian conjugate of (11) yielding\n\u2212 i\u2202\u03c4 Up (\u03c4s , \u03c4 ) = Up (\u03c4s , \u03c4 ) [H0 (\u03c4 ) + H]\n\n\u0013\u0015\n\u0014\n\u0012 Z \u03c4p\nF (t)dt\nUF (\u03c4p , 0) = T exp \u2212i\n0\n\u0010\ni\n= exp [\u2212i\u03c4p (F (1) + F (2) + F (3) + . . .) , (23)\nwhere F (1) =\n\n(19)\n\nwith the same F (t) as defined in (14b). Formal integration yields\n\u0013\u0015\n\u0014\n\u0012 Z \u03c4s\nF (t)dt .\n(20)\nU1 (\u03c4s , \u03c4 ) = T exp \u2212i\n\nF\n\n(2)\n\nUp (\u03c4p , 0) = Up (\u03c4p , \u03c4s ) Up (\u03c4s , 0)\n= e\u2212i(\u03c4p \u2212\u03c4s )H e\u2212i\u03c3y \u03c6(\u03c4p ) UF (\u03c4p , 0)ei\u03c3y \u03c6(0) e\u2212i\u03c4s H , (21)\nwhere\n\nR \u03c4p\n0\n\nF (t)dt is the average value of F .\n\n\u2212i\n=\n2\u03c4p\n\nZ\n\n\u03c4p\n\ndt1\n\n0\n\nZ\n\nt1\n\ndt2 [F (t1 ), F (t2 )].\n\n(24)\n\n0\n\nThus from the Magnus expansion we know at least the\ntwo leading orders in powers of F (t). Next, we expand\nF (t) itself which is still a complicated quantity, see Eq.\n(16). To obtain the two leading orders in H we expand\nF (t) in powers of H corresponding to an expansion in \u03c4p .\nWe use the identity [29]\n\u03c3y (\u2206t) = \u03c3y +\n\n\u03c4\n\nFinally, we combine both corrections U1 and U2\n\n1\n\u03c4p\n\nThe next-leading term F (2) comprises the commutators\nof F with itself at different times\n\n(18)\n\nwhere the property Up\u2020 (t1 , t2 ) = Up (t2 , t1 ) has been exploited. The procedure is the same as for U2 with the\nonly difference that now the exponentials occur on the\nright side of U1\n\u2212 i\u2202\u03c4 U1 (\u03c4s , \u03c4 ) = U1 (\u03c4s , \u03c4 ) F (\u03c4 )\n\nThe Magnus expansion reads\n\n\u221e n\nX\ni\n(\u2206t)n [[H, \u03c3y ]]n\nn!\nn=1\n\n(25)\n\nwhere \u2206t is used as defined in (10). The notation stands\nfor\n[[H, \u03c3y ]]1 = [H, \u03c3y ] = \u22122i\u03c3x\u03bbA\n[[H, \u03c3y ]]2 = [H, [H, \u03c3y ]] = \u22122i\u03c3x \u03bb[Hb , A] + 4\u03c3y \u03bb2 A2\n[[H, \u03c3y ]]3 = [H, [H, [H, \u03c3y ]]] = . . . ,\n(26)\n\nUF (\u03c4p , 0) := U2 (\u03c4p , \u03c4s ) U1 (\u03c4s , 0)\no\no n\nn\nR \u03c4p\nR \u03c4s\n= T e\u2212i \u03c4s F (t)dt T e\u2212i 0 F (t)dt\no\nn\nR \u03c4p\n(22)\n= T e\u2212i 0 F (t)dt .\nThus the total correction UF is given by the time-ordered\nproduct of F (t). Thereby, we have derived the general\nexpression for the difference between the unitary action\nof the real pulse as sketched in Fig. 1a and the idealized,\ninstantaneous pulse in Fig. 1b.\n\nB.\n\nExpansion to Second Order in \u03c4p H\n\nWe want to find the conditions under which UF (\u03c4p , 0)\ncan be approximated by the identity operator. Because\nF (t) is O(\u03bb) for \u03bb \u2192 0 the expansion in F is an appropriate first step. A convenient way to obtain the n-th\norder of an expansion in \u03bb and \u03c9b is to compute up to the\nn-th order of the Magnus expansion from average Hamiltonian theory [9, 28]. Then the resulting expressions are\nexpanded to n-th order in \u03bb and \u03c9b . The advantage of\nthis approach over a direct expansion is that the expansion is done in the argument of the exponential.\n\nto obtain\n\u03c3y (\u2206t) \u2212 \u03c3y = 2\u03c3x \u2206t\u03bbA +\n\n\u0001\ni\u03c3x \u03bb[Hb , A] \u2212 2\u03c3y \u03bb2 A2 (\u2206t)2 + O(\u2206t3 ). (27)\n\nInserting the above expansion in the equation (16) of F (t)\nand using the elementary relation\nei\u03c3y \u03c6(t) \u03c3x e\u2212i\u03c3y \u03c6(t) = cos(\u03c8)\u03c3x + sin(\u03c8)\u03c3z\n\n(28)\n\nwhere \u03c8(t) = 2\u03c6(t) as well as the Magnus expansion\n(23) allows us to compute the leading orders of UF in\nexponential representation\nUF (\u03c4p , 0) = exp[\u2212i(\u03b7 (1) + \u03b7 (2) + . . .)]\n\n(29)\n\nwith\n\u03b7 (1) = (\u03b711 \u03c3x + \u03b712 \u03c3z )\u03bbA\n\u03b7\n\n(2)\n\n(30a)\n2\n\n2\n\n= i (\u03b721 \u03c3x + \u03b722 \u03c3z ) \u03bb[Hb , A] + \u03b723 \u03c3y \u03bb A . (30b)\n\nNote that [Hb , A] = O(\u03c9b ) so that \u03b7 (2) truly represents\nthe desired second order in the shortness of the pulse.\n\n\f5\nThe coefficients \u03b7ij are given by the integrals\nZ \u03c4p\n\u2206tv(t) cos(\u03c8(t))dt\n(31a)\n\u03b711 = 2\nZ0 \u03c4p\n\u2206tv(t) sin(\u03c8(t))dt\n(31b)\n\u03b712 = 2\n0\nZ \u03c4p\n\u2206t2 v(t) cos(\u03c8(t))dt\n(31c)\n\u03b721 =\n0\nZ \u03c4p\n\u2206t2 v(t) sin(\u03c8(t))dt\n(31d)\n\u03b722 =\n0\nZ \u03c4p\n(\u2206t)2 v(t)dt\n(31e)\n\u03b723 = \u22122\n0\nZ t1\nZ \u03c4p\ndt2 \u2206t1 \u2206t2 v1 v2 sin(\u03c81 \u2212 \u03c82 ),\ndt1\n+4\n0\n\n0\n\nwhere we used \u03c8i for \u03c8(ti ) and vi for v(ti ) for i \u2208 {1, 2}\nin the last line. The differences are used as defined in\n(10). The last line of (31e) results from the commutator\n(24) yielding\n\nA last general property worth mentioning is the symmetry of Eqs. (33) under the transformation v(t) \u2192\nv(\u03c4p \u2212t) which implies \u03c4s \u2192 \u03c4p \u2212\u03c4s and \u03c8(t) \u2192 \u2212\u03c8(\u03c4p \u2212t).\nThus, if v(t) fulfills Eqs. (33) for \u03c4s , then v(\u03c4p \u2212 t) fulfills\nthem for \u03c4p \u2212 \u03c4s also.\n\n2.\n\nThe requirement \u03b7 (2) in quadratic order adds another\nthree integrals for \u03b721 , \u03b722 , and \u03b723 . It is obvious that\nintegration by parts can also be used to make v(t) disappear in the expressions for \u03b721 , \u03b722 , and \u03b723 . The resulting\nexpressions are\n\u03b721 =\n\nThis concludes the expansion up to second order in \u03c4p H,\ni.e., in the shortness of the pulse.\nIV.\n\nSHAPING THE PULSES\nA.\n\nGeneral Discussion\n1.\n\nLinear Order\n\nThe general idea is that one can shape the pulses such\nthat the leading deviations in UF from unity vanish.\nFirst, we focus on the linear order which requires that\n\u03b7 (1) vanishes. Hence we have two conditions given by\n\u03b711 = 0 and \u03b712 = 0. The relation v(t) = \u2202t \u03c8(t)/2 can be\nexploited to integrate the corresponding integrals (31a)\nand (31b) by parts yielding\nZ \u03c4p\n0 = (\u03c4p \u2212 \u03c4s ) sin \u03c8(\u03c4p ) + \u03c4s sin \u03c8(0) \u2212 sin \u03c8dt (33a)\nZ0 \u03c4p\n0 = (\u03c4p \u2212 \u03c4s ) cos \u03c8(\u03c4p ) + \u03c4s cos \u03c8(0) \u2212 cos \u03c8dt.(33b)\n\n(\u03c4p \u2212 \u03c4s )2\n\u03c42\nsin \u03c8(\u03c4p ) \u2212 s sin \u03c8(0)\n2\nZ 2\n\u03c4p\n\n\u2206t sin \u03c8(t)dt\n\n\u2212\n\n(34a)\n\n0\n\n\u03b722 = \u2212\n\n[F (t1 ), F (t2 )] = \u2206t1 \u2206t2 v1 v2 ([\u03c3z , \u03c3x ] sin \u03c81 cos \u03c82\n+[\u03c3x , \u03c3z ] cos \u03c81 sin \u03c82 ) \u03bb2 A2\n= 2i\u2206t1 \u2206t2 v1 v2 \u03c3y \u00d7\n(sin \u03c81 cos \u03c82 \u2212 cos \u03c81 sin \u03c82 ) \u03bb2 A2\n= 2i\u2206t1 \u2206t2 v1 v2 \u03c3y sin (\u03c81 \u2212 \u03c82 ) \u03bb2 A2 . (32)\n\nQuadratic Order\n\n(\u03c4p \u2212 \u03c4s )2\n\u03c42\ncos \u03c8(\u03c4p ) + s cos \u03c8(0)\n2\nZ 2\n\u03c4p\n\n+\n\n\u2206t cos \u03c8(t)dt\n\n0\n\nZ\n\n(34b)\n\n\u03c4p\n\nsin(\u03c8(t) \u2212 \u03c8(0))dt\n\u03b723 = (\u03c4p \u2212 \u03c4s )\u03c4s sin \u03b8 \u2212 \u03c4s\n0\nZ \u03c4p\nsin(\u03c8(\u03c4p ) \u2212 \u03c8(t))dt\n\u2212(\u03c4p \u2212 \u03c4s )\n0\nZ Z \u03c4p\n1\nsin(\u03c81 \u2212 \u03c82 )sgn(t1 \u2212 t2 )dt1 dt2 , (34c)\n+\n2\n0\nwhere we used \u03b8 = \u03c8(\u03c4p ) \u2212 \u03c8(0).\nIn view of the five expressions to be set to zero, one\nneeds at least five free parameters including \u03c4s , in order\nto obtain pulses which show only cubic deviations from\nthe idealized instantaneous pulse. One way to approach\nthe solution of the above discussed conditions is to consider symmetric pulses aiming at \u03c4s = \u03c4p /2. Then \u03c8(t)\nis an odd function about \u03c4s and the coefficients \u03b711 and\n\u03b722 vanish by antisymmetry. Then only three conditions\nremain to be solved. But the shape of the pulse is already\nfixed to some extent by its symmetry.\nA closer inspection reveals that \u03c0 pulses cannot be\ncorrected in second order. This statement is proven rigorously by the following consideration. We combine the\ntwo real Eqs. (34a) and (34b) to the complex equation\nZ \u03c4p\n\u2206tei\u03c8(t) dt, (35)\n0 = \u03c4s2 ei\u03c8(0) \u2212 (\u03c4p \u2212 \u03c4s )2 ei\u03c8(\u03c4p ) + 2\n0\n\n0\n\nAny pulse which fulfills these two conditions will show\nonly quadratic deviations from the idealized instantaneous pulse. Note that \u03c4s is not a priori fixed and can be\nconsidered a free parameter which can be tuned to fulfill\nthe above conditions. Hence one additional free parameter is sufficient to obtain a pulse which is ideal up to\nlinear order. Explicit solutions will be discussed below.\n\nwhich leads to\n\u03c4s2\n\n2\n\n+ (\u03c4p \u2212 \u03c4s )\n\n= \u22122\nZ\n\u2264 2\n\nZ\n\n\u03c4p\n\n\u2206tei(\u03c8(t)\u2212\u03c8(0)) dt\n\n0\n\u03c4p\n\n|\u2206t|dt\n\n0\n\n\u2264 \u03c4s2 + (\u03c4p \u2212 \u03c4s )2 .\n\n(36)\n\n\f6\n5\n4\n3\n2\n1\n0\n-1\n-2\n-3\n-4\n-5\n0\n\n4\nv\u03c0\n\n3\n\nv\u03c0\n\n2\nv\u03c0/2\n\u03c4s\n\nv(t) [1/\u03c4p]\n\nv(t)[1/\u03c4p]\n\n6\n\n\u03c4p\n\nv\u03c0/2\n\n1\n0\n\n\u03c4p\n\n\u03c4s\n\n\u03c4s\n\n\u03c0\n\n\u03c0/2\n\n-1\n-2\n-3\n\n0.1 0.2\n\n0.3 0.4\n\n0.5 0.6 0.7 0.8 0.9\nt [\u03c4p]\n\n1\n\nFigure 2: Composite \u03c0 and \u03c0/2 pulses with piecewise constant amplitude in the symmetric case. In the \u03c0 pulse, the\nsign changes occur at \u03c41 = \u03c4p /7 (6\u03c4p /7, respectively) and the\namplitude is amax = 7\u03c0/6[1/\u03c4p ]. In the \u03c0/2 pulse, the sign\nchanges occur at \u03c41 = 0.13155\u03c4p (\u03c4p \u2212 \u03c41 , respectively) and\nthe amplitude is amax = 1.65765[1/\u03c4p ].\n\nThe equality holds if and only if the exponential factor\nin the first line of (36) changes its value from \u22121 to 1\nabruptly at \u2206t = 0. This implies an instantaneous, ideal\npulse with infinite amplitude which is not experimentally\nrealizable. Hence a \u03c0 pulse cannot be corrected in second\norder. This no-go result is very remarkable in its general\nvalidity.\nFor \u03c0/2 pulses we found solutions which make \u03b721 and\n\u03b722 vanish. In spite of our intensive search we have not\nsucceeded in finding solutions which additionally make\n\u03b723 vanish. Hence we conjecture that no such solution\nexists. But to our knowledge, there is no mathematical\nproof stating the impossibility to correct \u03c0/2 pulses in\nsecond order.\nIn this context, the reader may wonder whether one\ncannot combine two \u03c0/2 pulses to obtain a \u03c0 pulse. But\nthis is indeed not possible within the present framework.\nAccording to (21) there is always some decoherent time\nevolution before and after the ideal pulse. Hence no direct combination of pulses with small angles to pulses\nwith larger angles is possible. But pulse sequences with\nfinite time intervals between the pulses as in dynamic\ndecoupling are well possible [1, 2, 3, 4, 5, 6, 7, 8].\n\n3.\n\nPossibility of \u03c4s = \u03c4p ?\n\nWe return to the corrections in linear order (33). Inspired from discussions with experimentalists in NMR,\nwe pose the question whether it is possible to shape a\npulse such that it corresponds to an ideal, instantaneous\npulse at the end of the real pulse, i.e. \u03c4s = \u03c4p . If such a\npulse existed it could be used to measure the response of\n\n-4\n0\n\n0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9\nt [\u03c4p]\n\n1\n\nFigure 3: Composite \u03c0 and \u03c0/2 pulses with piecewise constant\namplitude made from two elementary pulses in the asymmetric case. For the \u03c0 pulse, the sign change occurs at \u03c41 = 3\u03c4p /4,\nthe amplitude is amax = \u03c0[1/\u03c4p ] and the instant of the equivalent ideal pulse is \u03c4s = (\u03c4p /2)(1 \u2212 1/\u03c0). For the \u03c0/2 pulse,\n\u03c41 = 0.78220\u03c4p , the amplitude is amax = 1.39156[1/\u03c4p ] and\nthe instant of the equivalent ideal pulse is \u03c4s = 0.23128\u03c4p .\n\nsystems at delay times much shorter than the duration\n\u03c4p of the initial pulse. Clearly, this would represent a\npromising experimental tool.\nUnfortunately, it is impossible to construct such a\npulse. Again, we can prove this rigorously by inserting\n\u03c4s = \u03c4p into the equations (33) which we combine to one\nsingle complex equation using exp(i\u03c8) = cos \u03c8 + i sin \u03c8\nZ \u03c4p\nexp(i\u03c8(t))dt.\n(37)\n0 = \u03c4p exp(i\u03c8(0)) \u2212\n0\n\nWe find again a rigorous estimate\nZ \u03c4p\nexp{i[\u03c8(t) \u2212 \u03c8(0)]}dt\n\u03c4p =\nZ0 \u03c4p\n1dt = \u03c4p\n\u2264\n\n(38)\n\n0\n\nwhich is fulfilled if and only if \u03c8(t) is piecewise constant\nwith jumps of 2\u03c0. But such a \u03c8(t) represents via \u2202t \u03c8(t) =\n2v(t) instantaneous pulses with infinite amplitudes. Thus\nthere cannot be a real pulse with bounded amplitude\nwhich is close to an ideal pulse at the end of its duration\nin linear order of the bath parameters.\nOne can only approximate the desired situation by\naiming at a \u03c4s close to \u03c4p . To this end, asymmetric pulses\nwill be considered below.\nB.\n\nSolutions\n\nIn view of the above general discussion we focus here\nonly on the correction in linear order. First, we consider\n\n\f7\n8\n\n10\n6\nv(t) [1/\u03c4p]\n\n4\n\n6\nv\u03c0/2\n\n5\n\n2\n0\n-2\n\n\u03c4s\n\n\u03c4s\n\n\u03c0\n\n\u03c4p\n\n\u03c0/2\n\n4\n2\n1\n\n-6\n\n0\n\n-8\n\n-1\n0.1 0.2\n\n0.3 0.4 0.5 0.6 0.7 0.8 0.9\nt [\u03c4p]\n\n1\n\nFigure 4: Composite \u03c0 and \u03c0/2 pulses with piecewise constant amplitude made from three elementary pulses in the\nasymmetric case. For the \u03c0 pulse, the sign changes occur at \u03c41 = \u03c4p /13 and at \u03c42 = 6\u03c4p /13, the amplitude is\namax = 13\u03c0/6[1/\u03c4p ] and the instant of the equivalent ideal\npulse is \u03c4s = \u03c4p /2. For the \u03c0/2 pulse, the sign changes occur\nat \u03c41 = 0.44834\u03c4p and at \u03c42 = 0.80813\u03c4p , the amplitude is\namax = 2.80074[1/\u03c4p ] and the instant of the equivalent ideal\npulse is \u03c4s = 0.219\u03c4p .\n\nso-called composite pulses which consist of piecewise constant pulses of maximally positive or negative amplitude\n\u00b1amax . Second, continuously shaped pulses made from\nsines and cosines are investigated. In each class, we look\nat symmetric pulses with \u03c4s = \u03c4p /2 first and then at\nasymmetric pulses.\n1.\n\nComposite Pulses\n\na. Symmetric Pulses For symmetric pulses with\n\u03c4s = \u03c4p /2 there is only one equation to be solved, namely\n(33b), because (33a) is fulfilled by antisymmetry. We\nneed only one free parameter and take the instant \u03c41 , at\nwhich the pulse changes first, to be this free parameter.\nAnother sign change occurs by symmetry at t = \u03c4p \u2212 \u03c41 .\nFig. 2 depicts the solutions for a \u03c0 pulse and for a \u03c0/2\npulse. The parameters are given in the caption.\nIt is noteworthy that the symmetric \u03c0 pulse found is\nexactly the one that Cummins et al. named SCORPSE\n[23, 24]. Do our results reproduce theirs generally? The\nanswer is \"no\" because the goals are different. While\nCummins et al. aim at finding a pulse shape such that\nUp (\u03c4p , 0) \u2248 U\u03b8\n\n(39)\n\nour aim is to approximate as closely as possible\nUp (\u03c4p , 0) \u2248 exp(\u2212i(\u03c4p \u2212 \u03c4s )H)U\u03b8 exp(\u2212i\u03c4s H),\n\n(40)\n\nwhere U\u03b8 stands for the ideal, \u03b8 pulse evolution operator.\nIn other words, the authors of the Refs. 23, 24 aim at\n\nv\u03c0/2\n\n3\n\n-4\n\n-10\n0\n\nv\u03c0\n\n7\n\nv\u03c0\n\nv(t) [1/\u03c4p]\n\n8\n\n-2\n0\n\n\u03c4s\n0.1 0.2\n\n0.3 0.4\n\n0.5 0.6 0.7 0.8 0.9\nt [\u03c4p]\n\n\u03c4p\n\n1\n\nFigure 5: Continuous \u03c0 and \u03c0/2 pulses in the symmetric case.\nThe paramter a as defined in the ansatz (42) takes the value\n\u22123.73002/\u03c4p for the \u03c0 pulse and the value \u22121.78259/\u03c4p for\nthe \u03c0/2 pulse. The horizontal lines indicate the amplitude\nfor a totally constant, uncorrected \u03c0 pulse (solid line) and\n\u03c0/2 pulse (dashed-dotted line), respectively.\n\nmaking the imperfections vanish completely while our\naim is more modest: we aim at separating the bath and\nthe pulse evolution. We are convinced that our aim is\nmore realistic, in particular for general dynamic baths\nwithout static components so that no averaging to zero\nis possible. The compensation of the coupling between\nqubit and bath for longer storage times shall be done by\ndynamic decoupling [1, 2, 3, 4, 5, 6, 7, 8] on the basis of\nthe optimized pulses discussed here.\nBut for static couplings H \u221d \u03c3z and a \u03c0 pulse with\n\u03c4s = \u03c4p /2 both aims (39,40) happen to coincide\ne\u2212i\u03c4p H/2 U\u03c0 e\u2212i\u03c4p H/2 = U\u03c0 ei\u03c4p H/2 e\u2212i\u03c4p H/2\n= U\u03c0 .\n\n(41)\n\nNote that the argument does not require that the pulse\nis symmetric but only that the splitting time \u03c4s is in the\nmiddle of the pulse so that the first half of the evolution under H compensates the second half. Indeed, the\nCORPSE pulse [23, 24] fulfills our conditions (33) as well,\nsee Fig. 4.\nb. Asymmetric Pulses On considering asymmetric\npulses there is no reason to restrict oneself to \u03c4s = \u03c4p /2.\nHence there is another free parameter to tune. In this\nway, it is possible to find composite pulses which consist\nonly of two constant regions. Fig. 3 depicts the simplest\nsolutions, but there can be many more. For the \u03c0 pulse,\nfor instance, we have found an infinite set of solutions\nwith the time \u03c41 = (2n + 1)\u03c4p /(4n) at which the jump\noccurs and the amplitude amax = \u03c0n/\u03c4p where n is a\npositive integer. The corresponding splitting time reads\n\u03c4s /\u03c4p = 1/2 + (\u22121)n /(2n\u03c0). The solution depicted corresponds to n = 1.\n\n\fThe pulses depicted in Fig. 3 are the most asymmetric\nones for given maximum amplitude. This is reflected by\nthe values for \u03c4s which are not close to \u03c4p /2. If one is\nlooking for a pulse shape which allows the measurement\nof a signal as soon as possible after an ideal pulse the\ninverted pulses v(\u03c4p \u2212 t) with \u03c4s \u2248 0.77 for the \u03c0/2 pulse\nand with \u03c4s \u2248 0.66 for the \u03c0 pulse should be used.\nBeyond the composite pulses consisting of two constant regions we consider also the more commonly discussed composite pulses consisting of three constant regions. Fig. 4 shows generic results. The \u03c0 pulse depicted\nis the CORPSE pulse proposed previously [23, 24] which\nhappens to fulfill also our conditions as explained above.\nThe solution is arbitrary in the sense that other values\nfor \u03c4s are also possible.\nThe same is true for the \u03c0/2 pulse for which we have\nchosen \u03c4s at will. Many other values are also possible.\nFor \u03c4s = \u03c4p /2, however, we have not found any asymmetric solution.\n2.\n\nContinuous Pulses\n\nThe above composite pulses are advantageous because\nthey are fairly simple to generate and because they use\nthe maximally possible amplitudes most efficiently. But\nthey are not optimum in view of their frequency selectivity due to the jumps. It is well-known that the faithful\nrepresentation of jumps requires particularly broad frequency bands. Hence it is important to demonstrate that\nour conditions (33) can be also fulfilled by continuous\npulses. We choose ans\u00e4tze inspired from Fourier series\nwhich ensure even continuity of the derivative v \u2032 (t).\na. Symmetric Pulses For symmetric pulses our\nansatz reads\nv(t) = \u03b8/2 + a cos(2\u03c0t/\u03c4p ) \u2212 (a + \u03b8/2) cos(4\u03c0t/\u03c4p ). (42)\nThe coefficients are chosen such that v(0) = v(\u03c4p ) = 0\nand v \u2032 (0) = v \u2032 (\u03c4p ) = 0. Of course, higher cosine terms\ncould be added. But the constraints in linear order (33)\ncan be fulfilled already by the above ansatz. Fig. 5 displays the resulting pulse shapes. Note that the instant of\nthe equivalent ideal pulse is \u03c4s = \u03c4p /2. Comparing Fig.\n2 and Fig. 5 the above statement is illustrated that the\ncomposite pulses require only smaller amplitudes. But\nthe continuous pulses in Fig. 5 are much smoother and,\nhence, do not spread so much in frequency space. It depends on the actual constraints in experiment which kind\nof pulse is the most advantageous.\nb. Asymmetric Pulses For completeness, we also\nconsider an ansatz allowing for asymmetric continuous\npulses\nv(t) = (\u03b8/2)(1 \u2212 cos(2\u03c0t/\u03c4p ))\n+a sin(2\u03c0t/\u03c4p ) \u2212 (a/2) sin(4\u03c0t/\u03c4p ).\n\n(43)\n\nThe resulting solutions of the conditions (33) are plotted in Fig. 6. The values of the parameters are given in\n\nv(t) [1/\u03c4p]\n\n8\n8\n7\n6\n5\n4\n3\n2\n1\n0\n-1\n-2\n-3\n0\n\nv\u03c0\n\nv\u03c0/2\n\n\u03c4s\n\n\u03c0/2\n\n\u03c4s\n\n\u03c0\n\n0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9\nt[\u03c4p]\n\n\u03c4p\n\n1\n\nFigure 6: Continuous \u03c0 and \u03c0/2 pulses in the asymmetric\ncase. For the \u03c0 pulse, the parameter a as defined in the\nansatz (43) takes the value 3.39308/\u03c4p and the position \u03c4s of\nthe equivalent ideal pulse takes the value 0.33806\u03c4p . For the\n\u03c0/2 pulse, the parameter a is 1.54714/\u03c4p and the position \u03c4s\nof the equivalent ideal pulse is 0.28093\u03c4p . The horizontal lines\nindicate the amplitude for a totally constant, uncorrected \u03c0\npulse (solid line) and \u03c0/2 pulse (dashed-dotted line), respectively.\n\nthe caption. Naturally, the instant of the equivalent instantaneous pulse is no longer in the middle of the pulse\n\u03c4s 6= \u03c4p .\nV.\n\nCONCLUSIONS\n\nIn this paper, we have investigated under which conditions it is possible to shape the pulses implementing\nsingle qubit gates such that they correspond to ideal, instantaneous pulses (cf. Fig. 1). To this end, we computed\nthe corrections in powers of H, the Hamiltonian containing the coupling to the bath and the dynamics of the\nbath, to the equivalence\nUp (\u03c4p , 0) = e\u2212i(\u03c4p \u2212\u03c4s )H U\u03b8 e\u2212i\u03c4s H + O(H 2 ).\n\n(44)\n\nThe expansion in powers of H is an expansion in the\nshortness of the total pulse. No assumption about the\nnature of the bath is made so that our results are very\ngenerally applicable.\nWe have derived the explicit expression for the corrections in linear order in H as well as those quadratic\nin H. In the evaluation of the expressions found we focussed on the \u03c0 pulse and the \u03c0/2 pulse. They are by\nfar the most important ones for all kinds of applications.\nThe \u03c0 pulse is used to flip spins or qubits. An important\napplication are spin echo experiments and, more generally, dynamic decoupling of two-level systems from their\nenvironment [1, 2, 3, 4, 5, 6, 7, 8]. The \u03c0/2 pulse generates in NMR experiments the precessing magnetic field\n\n\f9\nand is used in many intricate pulse sequences to suppress\nthe effect of unwanted interactions [9]. In the context of\nquantum information, the \u03c0/2 pulse realizes the important Hadamard gate.\nWe found and showed a multitude of pulse shapes\nwhich are correct in linear order, i.e.\nUp (\u03c4p , 0) = e\u2212i(\u03c4p \u2212\u03c4s )H U\u03b8 e\u2212i\u03c4s H + O(H 2 ).\n\n(45)\n\nThe pulses can be chosen piecewise constant which requires the lowest amplitudes. They imply, however,\njumps which deteriorate the frequency selectivity [10].\nContinuous and continuously differentiable pulses can\nalso be realized and they have a much better frequency\nselectivity. Their drawback is that the maximum amplitude required is larger than for the piecewise constant\npulses.\nWe noted that our objective (45) happens to coincide\nwith the one of earlier work [22, 23, 24] for a \u03c0 pulse with\n\u03c4s = 1/2 applied to a completely static bath, i.e., a bath\nwithout internal dynamics. One reason for this coincidence is that in leading order the internal bath dynamics\ndoes not play a role. The commutators between different\nbath operators occur only in second order. Hence the corresponding CORPSE and SCORPSE pulse fulfill also the\nconditions derived in the present paper. In general, however, the coincidence does not hold, i.e. if \u03c4s 6= \u03c4p /2 or if\nthe bath is not static in the above sense or if pulses with\nangles \u03b8 different from \u03c0 are considered. Moreover, we\nemphasize that for dynamic baths without static components, i.e., baths with internal dynamics, the aim to\nmake the coupling between qubit and bath vanish altogether, i.e. Up (\u03c4p , 0) \u2248 U\u03b8 , cannot be fulfilled for general\nangle \u03b8 6= \u03c0.\nInvestigating the quadratic order, we could prove that\n\u03c0 pulses cannot be corrected in this order. For \u03c0/2\npulses we have not found any solution in spite of intensive search. Hence we are led to conjecture that no such\nsolution exists. It would be interesting to find a mathematical foundation for this conjecture. Even in linear\norder, it is not possible to shape the pulse in such a way\nthat it corresponds to an ideal, instantaneous pulse at\nthe very end of the real pulse. This would have been a\nnice property for NMR measurements since it would have\npermitted to measure directly after a given pulse with-\n\n[1] L. Viola and S. Lloyd, Phys. Rev. A 58, 2733 (1998).\n[2] M. Ban, J. Mod. Opt. 45, 2315 (1998).\n[3] P. Facchi, S. Tasaki, S. Pascazio, H. Nakazato, A. Tokuse,\nand D. A. Lidar, Phys. Rev. A 71, 022302 (2005).\n[4] K. Khodjasteh and D. A. Lidar, Phys. Rev. Lett. 95,\n180501 (2005).\n[5] P. Cappellaro, J. S. Hodges, T. F. Havel, and D. G. Cory,\nJ. Chem. Phys. 125, 044514 (2006).\n[6] W. M. Witzel and S. DasSarma, Phys. Rev. Lett. 98,\n077601 (2007).\n[7] W. Yao, R. B. Liu, and L. J. Sham, Phys. Rev. Lett. 98,\n\nout further delay. One may, however, use asymmetric\npulses which correspond to ideal pulses at about 77% of\nthe total pulse length.\nThe message from our findings is that pulses can be\nshaped such that they approximate ideal, instantaneous\npulses. The required pulse shapes have to fulfill rather\nsimple analytic integrals so that everyone can fine-tune\nhis pulse shape easily himself. The optimized \u03c0 pulses\nare an excellent starting point for optimized dynamic decoupling schemes [8].\nM\u00f6tt\u00f6nen et al. [20] have posed themselves a similar question for \u03c0 pulses as we have done. The main\ndifferences are that they investigated classical noise numerically while we tackled a fully quantum mechanical\nmodel by analytical means. Another difference is that\nthey aimed at Up (\u03c4p , 0) \u2248 U\u03c0 whereas our goal was not\nto make the bath vanish, but to disentangle it from the\nactual pulse, i.e., the coupling between qubit and bath\nis still present before and after the idealized pulse. Of\ncourse, in a model of classical noise there are no bath operators which do not commute so the mere disentanglement is trivially given in the model studied by M\u00f6tt\u00f6nen\net al.. We found that Up (\u03c4p , 0) \u2248 U\u03c0 and Up (\u03c4p , 0) =\ne\u2212i(\u03c4p /2)H U\u03c0 e\u2212i(\u03c4p /2)H coincide for baths without internal dynamics. For these special cases, our pulse shapes\nagree with those previously found [20, 23, 24]. For instance, the SCORPSE pulse appears to be a very good\nchoice.\nFurther work should simulate the proposed pulse\nshapes in specific models in order to understand better\nhow important the neglected corrections in second order\nreally are. It is to be expected that for small values of \u03bb\n(generic coupling to the bath) and \u03c9b (generic frequency\nof the bath) the corrected pulses are superior to the simple, uncorrected ones. But if the characteristic times of\nthe bath are too short, presumably the simple pulses will\nbe better.\n\nAcknowledgments\n\nWe would like to thank M. Lovri\u0107, J. Stolze, and\nD. Suter for helpful discussions. The financial support\nin the GK 726 by the DFG is gratefully acknowledged.\n\n077602 (2007).\n[8] G. S. Uhrig, Phys. Rev. Lett. 98, 100504 (2007).\n[9] U. Haeberlen, High Resolution NMR in Solids: Selective\nAveraging (Academic Press, New York, 1976).\n[10] L. M. K. Vandersypen and I. L. Chuang, Rev. Mod. Phys.\n76, 1037 (2004).\n[11] J. J. L. Morton, A. M. Tyryshkin, A. Ardavan, S. C. Benjamin, K. Porfyrakis, S. A. Lyon, and G. A. D. Briggs,\nNature Phys. 2, 40 (2006).\n[12] J. R. Petta, A. C. Johnson, J. M. Taylor, E. A. Laird,\nA. Yacoby, M. D. Lukin, C. M. Markus, M. P. Hanson,\n\n\f10\nand A. C. Gossard, Science 309, 2180 (2005).\n[13] A. Greilich, R. Oulton, E. A. Zkukov, I. A. Yugova,\nD. R. Yakovlev, M. Bayer, A. Shabaev, A. L. Efros, I. A.\nMerkulov, V. Stavarache, et al., Phys. Rev. Lett. 96,\n227401 (2006).\n[14] A. Greilich, , D. R. Yakovlev, A. Shabaev, A. L. Efros,\nI. A. Yugova, R. Oulton, V. Stavarache, D. Reuter,\nA. Wieck, et al., Science 313, 341 (2006).\n[15] H. G. Krojanski and D. Suter, Phys. Rev. Lett. 97,\n150503 (2006).\n[16] L. Viola, E. Knill, and S. Lloyd, Phys. Rev. Lett. 82,\n2417 (1999).\n[17] L. Viola and E. Knill, Phys. Rev. Lett. 90, 037901 (2003).\n[18] K. Khodjasteh and D. A. Lidar, Phys. Rev. A 75, 062310\n(2007).\n[19] B. Lee, W. M. Witzel, and S. DasSarma,\np.\narXiv:0710.1416 (2007).\n[20] M. M\u00f6tt\u00f6nen, R. de Sousa, J. Zhang, and K. B. Whaley,\n\nPhys. Rev. A 73, 022332 (2006).\n[21] H. Geen and R. Freeman, J. Mag. Res. 93, 93 (1991).\n[22] R. Tycko, Phys. Rev. Lett. 51, 775 (1983).\n[23] H. K. Cummins and J. A. Jones, New J. Phys. 2, 6\n(2000).\n[24] H. K. Cummins, G. Llewellyn, and J. A. Jones, Phys.\nRev. A 67, 042308 (2003).\n[25] K. R. Brown, A. W. Harrow, and I. L. Chuang, Phys.\nRev. A 70, 052318 (2004).\n[26] D. Li, A. E. Dementyev, Y. Dong, R. G. Ramos, and\nS. E. Barrett, Phys. Rev. Lett. 98, 190401 (2007).\n[27] D. Li, Y. Dong, R. G. Ramos, J. D. Murray, K. MacLean,\nA. E. Dementyev, and S. E. Barrett, p. arXiv:0704.3620\n(2008).\n[28] W. Magnus, Comm. Pure Appl. Math. 7, 649 (1954).\n[29] This identity can be derived by simply expanding the exponential and then rearranging the terms with the same\norder in \u2206t as a sum of nested commutators.\n\n\f"}