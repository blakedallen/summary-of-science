{"id": "http://arxiv.org/abs/0704.0273v1", "guidislink": true, "updated": "2007-04-02T21:37:30Z", "updated_parsed": [2007, 4, 2, 21, 37, 30, 0, 92, 0], "published": "2007-04-02T21:37:30Z", "published_parsed": [2007, 4, 2, 21, 37, 30, 0, 92, 0], "title": "Dimers on surface graphs and spin structures. II", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0704.1232%2C0704.2097%2C0704.1681%2C0704.1660%2C0704.0967%2C0704.3340%2C0704.1930%2C0704.2652%2C0704.0095%2C0704.1242%2C0704.1342%2C0704.1386%2C0704.0703%2C0704.0364%2C0704.1554%2C0704.3372%2C0704.3190%2C0704.0637%2C0704.2715%2C0704.0357%2C0704.0138%2C0704.3830%2C0704.2757%2C0704.2179%2C0704.3838%2C0704.2290%2C0704.1955%2C0704.0292%2C0704.1289%2C0704.1545%2C0704.3120%2C0704.3199%2C0704.2413%2C0704.1714%2C0704.1410%2C0704.0400%2C0704.1627%2C0704.2025%2C0704.1458%2C0704.3142%2C0704.3182%2C0704.0263%2C0704.2833%2C0704.3358%2C0704.1217%2C0704.2842%2C0704.1972%2C0704.0415%2C0704.2549%2C0704.1821%2C0704.2826%2C0704.0884%2C0704.0590%2C0704.1574%2C0704.3360%2C0704.1832%2C0704.0573%2C0704.2777%2C0704.3550%2C0704.1228%2C0704.3117%2C0704.1671%2C0704.1461%2C0704.2073%2C0704.2248%2C0704.1860%2C0704.0498%2C0704.0247%2C0704.0373%2C0704.1801%2C0704.0693%2C0704.2495%2C0704.3712%2C0704.1878%2C0704.1171%2C0704.3818%2C0704.2999%2C0704.0042%2C0704.0234%2C0704.0464%2C0704.0704%2C0704.0514%2C0704.1030%2C0704.3223%2C0704.0215%2C0704.3046%2C0704.2835%2C0704.3348%2C0704.3367%2C0704.0273%2C0704.0753%2C0704.0961%2C0704.2015%2C0704.2267%2C0704.0799%2C0704.3764%2C0704.0536%2C0704.2176%2C0704.0283%2C0704.1502%2C0704.2640&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Dimers on surface graphs and spin structures. II"}, "summary": "In a previous paper, we showed how certain orientations of the edges of a\ngraph G embedded in a closed oriented surface S can be understood as discrete\nspin structures on S. We then used this correspondence to give a geometric\nproof of the Pfaffian formula for the partition function of the dimer model on\nG. In the present article, we generalize these results to the case of compact\noriented surfaces with boundary. We also show how the operations of cutting and\ngluing act on discrete spin structures and how they change the partition\nfunction. These operations allow to reformulate the dimer model as a quantum\nfield theory on surface graphs.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0704.1232%2C0704.2097%2C0704.1681%2C0704.1660%2C0704.0967%2C0704.3340%2C0704.1930%2C0704.2652%2C0704.0095%2C0704.1242%2C0704.1342%2C0704.1386%2C0704.0703%2C0704.0364%2C0704.1554%2C0704.3372%2C0704.3190%2C0704.0637%2C0704.2715%2C0704.0357%2C0704.0138%2C0704.3830%2C0704.2757%2C0704.2179%2C0704.3838%2C0704.2290%2C0704.1955%2C0704.0292%2C0704.1289%2C0704.1545%2C0704.3120%2C0704.3199%2C0704.2413%2C0704.1714%2C0704.1410%2C0704.0400%2C0704.1627%2C0704.2025%2C0704.1458%2C0704.3142%2C0704.3182%2C0704.0263%2C0704.2833%2C0704.3358%2C0704.1217%2C0704.2842%2C0704.1972%2C0704.0415%2C0704.2549%2C0704.1821%2C0704.2826%2C0704.0884%2C0704.0590%2C0704.1574%2C0704.3360%2C0704.1832%2C0704.0573%2C0704.2777%2C0704.3550%2C0704.1228%2C0704.3117%2C0704.1671%2C0704.1461%2C0704.2073%2C0704.2248%2C0704.1860%2C0704.0498%2C0704.0247%2C0704.0373%2C0704.1801%2C0704.0693%2C0704.2495%2C0704.3712%2C0704.1878%2C0704.1171%2C0704.3818%2C0704.2999%2C0704.0042%2C0704.0234%2C0704.0464%2C0704.0704%2C0704.0514%2C0704.1030%2C0704.3223%2C0704.0215%2C0704.3046%2C0704.2835%2C0704.3348%2C0704.3367%2C0704.0273%2C0704.0753%2C0704.0961%2C0704.2015%2C0704.2267%2C0704.0799%2C0704.3764%2C0704.0536%2C0704.2176%2C0704.0283%2C0704.1502%2C0704.2640&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In a previous paper, we showed how certain orientations of the edges of a\ngraph G embedded in a closed oriented surface S can be understood as discrete\nspin structures on S. We then used this correspondence to give a geometric\nproof of the Pfaffian formula for the partition function of the dimer model on\nG. In the present article, we generalize these results to the case of compact\noriented surfaces with boundary. We also show how the operations of cutting and\ngluing act on discrete spin structures and how they change the partition\nfunction. These operations allow to reformulate the dimer model as a quantum\nfield theory on surface graphs."}, "authors": ["David Cimasoni", "Nicolai Reshetikhin"], "author_detail": {"name": "Nicolai Reshetikhin"}, "author": "Nicolai Reshetikhin", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1007/s00220-008-0488-3", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0704.0273v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0704.0273v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "23 pages, 3 figures", "arxiv_primary_category": {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.GT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "82B20, 57R15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0704.0273v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0704.0273v1", "journal_reference": "Comm. Math. Phys. 281 (2008), 445-468", "doi": "10.1007/s00220-008-0488-3", "fulltext": "DIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\narXiv:0704.0273v1 [math-ph] 2 Apr 2007\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\nAbstract. In a previous paper [3], we showed how certain orientations of the\nedges of a graph \u0393 embedded in a closed oriented surface \u03a3 can be understood\nas discrete spin structures on \u03a3. We then used this correspondence to give a\ngeometric proof of the Pfaffian formula for the partition function of the dimer\nmodel on \u0393. In the present article, we generalize these results to the case of\ncompact oriented surfaces with boundary. We also show how the operations\nof cutting and gluing act on discrete spin structures and how they change the\npartition function. These operations allow to reformulate the dimer model as\na quantum field theory on surface graphs.\n\nContents\nIntroduction\nAcknowledgements\n1. The dimer model on graphs with boundary\n1.1. Dimers on graphs with boundary\n1.2. Dimers on surface graphs with boundary\n2. Kasteleyn orientations on surface graphs with boundary\n2.1. Kasteleyn orientations\n2.2. Discrete spin structures\n2.3. The Pfaffian formula for the partition function\n3. Cutting and gluing\n3.1. Cutting and gluing graphs with boundary\n3.2. Cutting and gluing surface graphs with boundary\n3.3. Cutting and gluing discrete spin structures\n3.4. Cutting Pfaffians\n4. Quantum field theory for dimers\n4.1. Quantum field theory on graphs\n4.2. Quantum field theory for dimers on graphs\n4.3. The dimer model as the theory of free Fermions\n5. Dimers on bipartite graphs and height functions\n5.1. Composition cycles on bipartite graphs\n5.2. Height functions for planar bipartite graphs\n5.3. Height functions for bipartite surface graphs\n5.4. The dimer quantum field theory on bipartite surface graphs\nReferences\n\nDate: October 22, 2018.\n1991 Mathematics Subject Classification. Primary: 82B20; Secondary: 57R15.\n1\n\n2\n3\n3\n3\n4\n5\n5\n5\n6\n8\n8\n9\n10\n12\n13\n13\n13\n14\n16\n16\n16\n19\n22\n23\n\n\f2\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nIntroduction\nA dimer configuration on a graph \u0393 is a choice of a family of edges of \u0393, called\ndimers, such that each vertex of \u0393 is adjacent to exactly one dimer. Assigning\nweights to the edges of \u0393 allows to define a probability measure on the set of dimer\nconfigurations. The study of this measure is called the dimer model on \u0393. Dimer\nmodels on graphs have a long history in statistical mechanics [6, 12], but also show\ninteresting aspects involving combinatorics, probability theory [10, 4], real algebraic\ngeometry [9, 8], etc...\nA remarkable fact about dimer models was discovered by P.W. Kasteleyn in\nthe 60's: the partition function of the dimer model can be written as a linear\ncombination of 22g Pfaffians of N \u00d7 N matrices, where N is the number of vertices\nin the graph and g the genus of a closed oriented surface \u03a3 where the graph can be\nembedded. The matrices are signed-adjacency matrices, the sign being determined\nby an orientation of the edges of \u0393 called a Kasteleyn orientation. If the graph\nis embedded in a surface of genus g, there are exactly 22g equivalence classes of\nKasteleyn orientations, defining the 22g matrices. This Pfaffian formula for the\npartition function was proved by Kasteleyn in [6] for the cases g = 0, 1, and only\nstated for the general case [7]. A combinatorial proof of this fact and the exact\ndescription of coefficients for all oriented surfaces first appeared much later [11, 14].\nThe number of equivalence classes of Kasteleyn orientations on a graph \u0393 embedded in \u03a3 is also equal to the number of equivalence classes of spin structures on\n\u03a3. An explicit construction relating a spin structure on a surface with a Kasteleyn\norientation on a graph with dimer configuration was suggested in [10]. In [3], we investigated further the relation between Kasteleyn orientations and spin structures.\nThis allows to understand Kasteleyn orientations on a graph embedded in \u03a3 as\ndiscrete spin structures on \u03a3. We also used this relation to give a geometric proof\nof the Pfaffian formula for closed surfaces. Our final formula can be expressed as\nfollows: given a graph \u0393 embedded in a closed oriented surface \u03a3 of genus g, the\npartition function of the dimer model on \u0393 is given by\nZ(\u0393) =\n\n1 X\nArf(\u03be)Pf(A\u03be (\u0393)),\n2g\n\u03be\u2208S(\u03a3)\n\nwhere S(\u03a3) denotes the set of equivalence classes of spin structures on \u03a3, Arf(\u03be) =\n\u00b11 is the Arf invariant of the spin structure \u03be, and A\u03be (\u0393) is the matrix given by\nthe Kasteleyn orientation corresponding to \u03be.\nThe first part of the present paper is devoted to the extension of the results\nobtained in [3] to dimer models on graphs embedded in surfaces with boundary\n(Sections 1 and 2). We then show how the operations of cutting and gluing act\non discrete spin structures and how they change the partition function (Section 3).\nThese operations define the structure of a functorial quantum field theory in the\nspirit of [2, 13], as detailed in Section 4. We then give two equivalent reformulations\nof the dimer quantum field theory: the \"Fermionic\" version, which describes the\npartition function of the dimer model as a Grassman integral, and the \"Bosonic\"\nversion, the equivalent description of dimer models on bipartite surface graphs in\nterms of height functions. This special case of bipartite graphs is the subject of\nSection 5.\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n3\n\nThroughout this paper, \u03a3 is a compact surface, possibly disconnected and possibly with boundary, endowed with the counter-clockwise orientation. All results can\nbe extended to the case of non-orientable surfaces, which will be done in a separate\npublication. We refer to [14] for a combinatorial treatment of dimer models on\nnon-orientable surface graphs.\nAcknowledgements. We are grateful to J. Andersen, M. Baillif, P. Teichner and\nA. Vershik for inspiring discussions. We also thankfully acknowledge the hospitality\nof the Department of Mathematics at the University of Aarhus. The work of D.C.\nwas supported by the Swiss National Science Foundation. This work of N.R. was\npartially supported by the NSF grant DMS\u20130307599, by the CRDF grant RUM1\u2013\n2622, by the Humboldt foundation and by the Niels Bohr research grant.\n1. The dimer model on graphs with boundary\n1.1. Dimers on graphs with boundary. In this paper, a graph with boundary\nis a finite graph \u0393 together with a set \u2202\u0393 of one valent vertices called boundary\nvertices. A dimer configuration D on a graph with boundary (\u0393, \u2202\u0393) is a choice of\nedges of \u0393, called dimers, such that each vertex that is not a boundary vertex is\nadjacent to exactly one dimer. Note that some of the boundary vertices may be\nadjacent to a dimer of D, and some may not. We shall denote by \u2202D this partition\nof boundary vertices into matched and non-matched. Such a partition will be called\na boundary condition for dimer configurations on \u0393.\nA weight system on \u0393 is a positive real valued function w on the set of edges of\n\u0393. It defines edge weights on the set D(\u0393, \u2202\u0393) of dimer configurations on (\u0393, \u2202\u0393)\nby\nY\nw(D) =\nw(e),\ne\u2208D\n\nwhere the product is taken over all edges occupied by dimers of D.\nFix a boundary condition \u2202D0 . Then, the Gibbs measure for the dimer model\non (\u0393, \u2202\u0393) with weight system w and boundary condition \u2202D0 is given by\nProb(D | \u2202D0 ) =\n\nw(D)\n,\nZ(\u0393; w | \u2202D0 )\n\nwhere\nZ(\u0393; w | \u2202D0 ) =\n\nX\n\nw(D),\n\nD:\u2202D=\u2202D0\n\nthe sum being on all D \u2208 D(\u0393, \u2202\u0393) such that \u2202D = \u2202D0 .\nLet V (\u0393) denote the set of vertices of \u0393. The group\nG(\u0393) = {s : V (\u0393) \u2192 R>0 }\nacts on the set of weight systems on \u0393 as follows: (sw)(e) = s(e+ )w(e)s(e\u2212 ), where\neQ+ and e\u2212 are the two vertices adjacent\nto the edge e. Note that (sw)(D) =\nQ\ns(v)Z(\u0393;\nw | \u2202D0 ), both products being on\ns(v)w(D)\nand\nZ(\u0393;\nsw\n|\n\u2202D\n)\n=\n0\nv\nv\nthe set of vertices of \u0393 matched by D0 . Therefore, the Gibbs measure is invariant\nunder the action of the group G(\u0393).\nNote that the dimer model on (\u0393, \u2202\u0393) with boundary condition \u2202D0 is equivalent\nto the dimer model on the graph obtained from \u0393 by removing all edges adjacent\nto non-matched boundary vertices.\n\n\f4\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nGiven two dimer configurations D and D\u2032 on a graph with boundary (\u0393, \u2202\u0393),\nlet us define the (D, D\u2032 )-composition cycles as the connected components of the\nsymmetric difference C(D, D\u2032 ) = (D \u222a D\u2032 )\\(D \u2229 D\u2032 ). If \u2202D = \u2202D\u2032 , then C(D, D\u2032 )\nis a 1-cycle in \u0393 with Z2 -coefficients. In general, it is only a 1-cycle (rel \u2202\u0393).\n1.2. Dimers on surface graphs with boundary. Let \u03a3 be an oriented compact\nsurface, not necessarily connected, with boundary \u2202\u03a3. A surface graph with boundary \u0393 \u2282 \u03a3 is a graph with boundary (\u0393, \u2202\u0393) embedded in \u03a3, so that \u0393 \u2229 \u2202\u03a3 = \u2202\u0393\nand the complement of \u0393 \\ \u2202\u0393 in \u03a3 \\ \u2202\u03a3 consists of open 2-cells. These conditions\nimply that the graph \u0393 := \u0393 \u222a \u2202\u03a3 is the 1-skeleton of a cellular decomposition of\n\u03a3.\nNote that any graph with boundary can be realized as a surface graph with\nboundary. One way is to embed the graph in a closed surface of minimal genus,\nand then to remove one small open disc from this surface near each boundary vertex\nof the graph.\nA dimer configuration on a surface graph with boundary \u0393 \u2282 \u03a3 is simply a\ndimer configuration on the underlying graph with boundary (\u0393, \u2202\u0393). Given two\ndimer configurations D and D\u2032 on a surface graph \u0393 \u2282 \u03a3, let \u2206(D, D\u2032 ) denote\nthe homology class of C(D, D\u2032 ) in H1 (\u03a3, \u2202\u03a3; Z2 ). We shall say that two dimer\nconfigurations D and D\u2032 are equivalent if \u2206(D, D\u2032 ) = 0 \u2208 H1 (\u03a3, \u2202\u03a3; Z2 ). Note\nthat given any three dimer configurations D, D\u2032 , and D\u2032\u2032 on \u0393 \u2282 \u03a3, we have the\nidentity\n(1)\n\n\u2206(D, D\u2032 ) + \u2206(D\u2032 , D\u2032\u2032 ) = \u2206(D, D\u2032\u2032 )\n\nin H1 (\u03a3, \u2202\u03a3; Z2 ).\nFix a homology class \u03b2 \u2208 H1 (\u03a3, \u2202\u03a3; Z2 ), a dimer configuration D1 \u2208 D(\u0393, \u2202\u0393)\nand a boundary condition \u2202D0 . The associated partial partition function is defined\nby\nX\nw(D),\nZ\u03b2,D1 (\u0393; w | \u2202D0 ) =\nD:\u2202D=\u2202D0\n\u2206(D,D1 )=\u03b2\n\nwhere the sum is taken over all D \u2208 D(\u0393, \u2202\u0393) such that \u2202D = \u2202D0 and \u2206(D, D1 ) =\n\u03b2.\nThe equality (1) implies that\nZ\u03b2,D1 (\u0393; w | \u2202D0 ) = Z\u03b2+\u2206(D0 ,D1 ),D0 (\u0393; w | \u2202D0 ).\nFurthermore, the relative homology class \u03b2 \u2032 = \u03b2 + \u2206(D0 , D1 ) lies in the image of\nthe canonical homomorphism j : H1 (\u03a3, Z2 ) \u2192 H1 (\u03a3, \u2202\u03a3; Z2 ). Hence,\nX\nZ\u03b2 \u2032 ,D0 (\u0393; w | \u2202D0 ) =\nZ\u03b1 (\u0393, w | \u2202D0 ),\n\u03b1:j(\u03b1)=\u03b2 \u2032\n\nwhere the sum is taken over all \u03b1 \u2208 H1 (\u03a3, Z2 ) such that j(\u03b1) = \u03b2 \u2032 , and\nX\nw(D).\nZ\u03b1 (\u0393; w | \u2202D0 ) =\nD:\u2202D=\u2202D0\n\u2206(D,D0 )=\u03b1\n\nTherefore the computation of the partition function Z\u03b2,D1 (\u0393; w | \u2202D0 ) boils down\nto the computation of Z\u03b1 (\u0393; w | \u2202D0 ) with \u03b1 \u2208 H1 (\u03a3; Z2 ). We shall give a Pfaffian\nformula for this latter partition function in the next section (see Theorem 2.4).\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n5\n\n2. Kasteleyn orientations on surface graphs with boundary\n2.1. Kasteleyn orientations. Let K be an orientation of the edges of a graph \u0393,\nand let C be an oriented closed curve in \u0393. We shall denote by nK (C) the number\nof times that, traveling once along C following its orientation, one runs along an\nedge in the direction opposite to the one given by K.\nA Kasteleyn orientation on a surface graph with boundary \u0393 \u2282 \u03a3 is an orientation K of the edges of \u0393 = \u0393 \u222a \u2202\u03a3 which satisfies the following condition: for\neach face f of \u03a3, nK (\u2202f ) is odd. Here \u2202f is oriented as the boundary of f , which\ninherits the orientation of \u03a3.\nUsing the proof of [3, Theorem 3.1], one easily checks that if \u2202\u03a3 is non-empty,\nthen there always exists a Kasteleyn orientation on \u0393 \u2282 \u03a3. More precisely, we have\nthe following:\nProposition 2.1. Let \u0393 \u2282 \u03a3 be a connected surface graph, possibly with boundary,\nand let C1 , . . . , C\u03bc be the boundary components of \u03a3 with the induced orientation.\nFinally, let n1 , . . . , n\u03bc be 0's and 1's. Then, there exists a Kasteleyn orientation on\n\u0393 \u2282 \u03a3 such that 1 + nK (\u2212Ci ) \u2261 ni (mod 2) for all i if and only if\nn1 + * * * + n\u03bc \u2261 V\n\n(mod 2),\n\nwhere V is the number of vertices of \u0393.\nProof. First, let us assume that there is a Kasteleyn orientation K on \u0393 \u2282 \u03a3 such\nthat 1 + nK (\u2212Ci ) \u2261 ni for all i. Let \u03a3\u2032 be the closed surface obtained from \u03a3 by\npasting a 2-disc Di along each boundary component Ci . Let \u0393\u2032 \u2282 \u03a3\u2032 be the surface\ngraph obtained from \u0393 as follows: for each i such that ni = 1, add one vertex in the\ninterior of Di and one edge (arbitrarily oriented) between this vertex and a vertex\nof Ci . The result is a Kasteleyn orientation on \u0393\u2032 \u2282 \u03a3\u2032 , with \u03a3\u2032 closed. By [3,\nTheorem 3.1], the number V \u2032 of vertices of \u0393\u2032 is even. Hence,\n0 \u2261 V \u2032 \u2261 V + n1 + * * * + n\u03bc\n\n(mod 2).\n\nConversely, assume \u0393 \u2282 \u03a3 is a surface graph with n1 + * * *+ n\u03bc \u2261 V (mod 2). Paste\n2-discs along the boundary components of \u03a3 as before. This gives a surface graph\n\u0393\u2032 \u2282 \u03a3\u2032 with \u03a3\u2032 closed and V \u2032 even. By [3, Theorem 3.1], there exists a Kasteleyn\norientation K \u2032 on \u0393\u2032 \u2282 \u03a3\u2032 . It restricts to a Kasteleyn orientation K on \u0393 \u2282 \u03a3 with\n1 + nK (\u2212Ci ) \u2261 ni for all i.\n\u0003\nRecall that two Kasteleyn orientations are called equivalent if one can be obtained from the other by a sequence of moves reversing orientations of all edges\nadjacent to a vertex. The proof of [3, Theorem 3.2] goes through verbatim: if\nnon-empty, the set of equivalence classes of Kasteleyn orientations on \u0393 \u2282 \u03a3 is an\naffine H 1 (\u03a3; Z2 )-space. In particular, there are exactly 2b1 (\u03a3) equivalence classes of\nKasteleyn orientations on \u0393 \u2282 \u03a3.\n2.2. Discrete spin structures. As in the closed case, any dimer configuration\nD on a graph \u0393 allows to identify equivalence classes of Kasteleyn orientations on\n\u0393 \u2282 \u03a3 with spin structures on \u03a3. Indeed, [3, Theorem 4.1] generalizes as follows.\nGiven an oriented simple closed curve C in \u0393, let lD (C) denote the number of\nvertices v in C whose adjacent dimer of D sticks out to the left of C in \u03a3. Also, let\nV\u2202D (C) be the number of boundary vertices v in C not matched by D, and such\nthat the interior of \u03a3 lies to the right of C at v.\n\n\f6\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nTheorem 2.2. Fix a dimer configuration D on a surface graph with boundary\n\u0393 \u2282 \u03a3. Given a class \u03b1 \u2208 H1 (\u03a3; Z2 ), represent it by oriented simple closed curves\nC1 , . . . , Cm in \u0393. If K is a Kasteleyn orientation on \u0393 \u2282 \u03a3, then the function\nK\nqD\n: H1 (\u03a3; Z2 ) \u2192 Z2 given by\nK\nqD\n(\u03b1) =\n\nX\ni<j\n\nCi * Cj +\n\nm\nX\n\n(1 + nK (Ci ) + lD (Ci ) + V\u2202D (Ci )) (mod 2)\n\ni=1\n\nis a well-defined quadratic form on H1 (\u03a3; Z2 ).\nProof. Fix a dimer configuration D on (\u0393, \u2202\u0393) and a Kasteleyn orientation K on\n\u0393 \u2282 \u03a3. Let \u03a3\u2032 be the surface (homeomorphic to \u03a3) obtained from \u03a3 by adding a\nsmall closed collar to its boundary. For every vertex v of \u2202\u0393 that is not matched\nby a dimer of D, add a vertex v \u2032 near v in the interior of the collar and an edge\nbetween v and v \u2032 . Let us denote by \u0393\u2032 the resulting graph in \u03a3\u2032 . Putting a\ndimer on each of these additional edges, and orienting them arbitrarily, we obtain\na perfect matching D\u2032 and an orientation K \u2032 on \u0393\u2032 . Although \u0393\u2032 \u2282 \u03a3\u2032 is not\nstrictly speaking a surface graph, all the methods of [3, Section 4] apply. Indeed,\nKuperberg's vector field defined near \u0393\u2032 clearly extends continuously to the collar.\nAs in the closed case, it also extends to the faces with even index singularities. Using\nthe perfect matching D\u2032 on \u0393\u2032 , we obtain a vector field f (K \u2032 , D\u2032 ) with even index\nsingularities, which determines a spin structure \u03bef (K \u2032 ,D\u2032 ) on \u03a3\u2032 . Johnson's theorem\n[5] holds for surfaces with boundary, so this spin structure defines a quadratic\nform q on H1 (\u03a3\u2032 ; Z2 ) = H1 (\u03a3; Z2 ). If C is a simple close curve in \u0393\u2032 \u2282 \u03a3\u2032 , then\n\u2032\nq([C]) + 1 = nK (C) + lD\u2032 (C) as in the closed case. The proof is completed using\n\u2032\nthe equalities nK (C) = nK (C) and lD\u2032 (C) = lD (C) + V\u2202D (C).\n\u0003\nSince Johnson's theorem holds true for surfaces with boundary and [3, Proposition 4.2] easily extends, we have the following corollary.\nCorollary 2.3. Let \u0393 \u2282 \u03a3 be a surface graph, non-necessarily connected, and possibly with boundary. Any dimer configuration D on \u0393 \u2282 \u03a3 induces an isomorphism\nof affine H 1 (\u03a3; Z2 )-spaces\n\u03c8D : K(\u0393 \u2282 \u03a3) \u2212\u2192 S(\u03a3)\nfrom the set of equivalence classes of Kasteleyn orientations on \u0393 \u2282 \u03a3 onto the set\nof spin structures on \u03a3. Furthermore, \u03c8D \u2212 \u03c8D\u2032 is equal to the Poincar\u00e9 dual of\n\u2206(D, D\u2032 ). In particular, \u03c8D = \u03c8D\u2032 if and only if D and D\u2032 are equivalent dimer\nconfigurations.\n\u0003\n2.3. The Pfaffian formula for the partition function. Let \u0393 be a graph, not\nnecessarily connected, and possibly with boundary, endowed with a weight system\nw. Realize \u0393 as a surface graph \u0393 \u2282 \u03a3, and fix a Kasteleyn orientation K on it.\nThe Kasteleyn coefficient associated to an ordered pair (v, v \u2032 ) of distinct vertices\nof \u0393 is the number\nX\naK\n\u03b5K\nvv \u2032 =\nvv \u2032 (e)w(e),\ne\n\nwhere the sum is on all edges e in \u0393 between the vertices v and v \u2032 , and\n(\n1 if e is oriented by K from v to v \u2032 ;\nK\n\u03b5vv\u2032 (e) =\n\u22121 otherwise.\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n7\n\nOne also sets aK\nvv = 0. Let us fix a boundary condition \u2202D0 and enumerate the\nmatched vertices of \u0393 by 1, 2, . . . , 2n. Then, the corresponding coefficients form a\n2n \u00d7 2n skew-symmetric matrix AK (\u0393; w | \u2202D0 ) = AK called the Kasteleyn matrix .\nLet D be a dimer configuration on (\u0393, \u2202\u0393) with \u2202D = \u2202D0 , given by edges\ne1 , . . . , en matching vertices il and jl for l = 1, . . . , n. Let \u03c3 be the permutation\n(1, . . . , 2n) 7\u2192 (i1 , j1 , . . . , in , jn ), and set\n\u03b5K (D) = (\u22121)\u03c3\n\nn\nY\n\n\u03b5K\nil jl (el ),\n\nl=1\n\u03c3\n\nwhere (\u22121) denotes the sign of \u03c3. Note that \u03b5K (D) does not depend on the choice\nof \u03c3, but only on the dimer configuration D.\nFinally, recall that the Arf invariant of a (possibly degenerate) quadratic form\nq on H := H1 (\u03a3; Z2 ) is defined by\n1 X\nArf(q) =\n(\u22121)q(\u03b1) .\n|H|\n\u03b1\u2208H\n\nIf there is a component \u03b3 of \u2202\u03a3 such that q(\u03b3) 6= 0, then one easily checks that\nArf(q) = 0. On the other hand, if q(\u03b3) = 0 for all boundary components \u03b3 of \u03a3,\nthen Arf(q) takes the values +1 or \u22121.\n\nTheorem 2.4. Let \u0393 \u2282 \u03a3 be a surface graph, not necessarily connected, and possibly with boundary. Let b1 (\u03a3) denote the dimension of H1 (\u03a3; Z2 ), and let g denote\nthe genus of \u03a3. Then,\nK\n1 X\n(\u22121)qD0 (\u03b1) \u03b5K (D0 )Pf(AK )\nZ\u03b1 (\u0393; w | \u2202D0 ) = b (\u03a3)\n1\n2\n[K]\n\nfor any \u03b1 \u2208 H1 (\u03a3; Z2 ), and\nZ(\u0393; w | \u2202D0 ) =\n\n1 X\nK\n)\u03b5K (D0 )Pf(AK ),\nArf(qD\n0\n2g\n[K]\n\nb1 (\u03a3)\n\nwhere both sums are over the 2\nequivalence classes of Kasteleyn orientations\nK\nK\non \u0393 \u2282 \u03a3. Furthermore, Arf(qD\n)\u03b5\n(D\n0 ) does not depend on D0 .\n0\nProof. First note that if the theorem holds for two surface graphs, then it holds\nfor their disjoint union. Therefore, it may be assumed that \u03a3 is connected. The\nfirst formula follows from Theorem 2.2: the proof of Theorem 4 and the first half\nof the proof of Theorem 5 of [3] generalize verbatim to the case with (possible)\nboundary. The second formula can be obtained from the first one by summing\nover all \u03b1 \u2208 H1 (\u03a3; Z2 ). However, this requires some cumbersome computations,\nso let us give another proof of this equality. As mentioned in Section 1, the dimer\nmodel on (\u0393, \u2202\u0393) with boundary condition \u2202D0 is equivalent to the dimer model\non the graph \u0393\u2032 = \u0393\u2032 (\u2202D0 ) obtained from \u0393 by removing all edges adjacent to nonmatched boundary vertices. Let w\u2032 denote the restriction of w to \u0393\u2032 . If \u0393 \u2282 \u03a3 is a\nsurface graph with boundary, then \u0393\u2032 \u2282 \u03a3\u2032 is a surface graph, where \u03a3\u2032 is the closed\noriented surface obtained from \u03a3 by gluing discs along all boundary components.\nBy [3, Theorem 5.3],\n\u2032\n1 X\nK\u2032 K\u2032\n)\u03b5 (D0 )Pf(AK (\u0393\u2032 ; w\u2032 )),\nArf(qD\nZ(\u0393; w | \u2202D0 ) = Z(\u0393\u2032 ; w\u2032 ) = g\n0\n2\n\u2032\n[K ]\n\n\f8\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nthe sum being on all equivalence classes of Kasteleyn orientations on \u0393\u2032 \u2282 \u03a3\u2032 .\nSuch a Kasteleyn orientation K \u2032 extends uniquely to a Kasteleyn orientation K on\nK\n\u0393 \u2282 \u03a3 such that qD\n(\u03b3) = 0 for all boundary component \u03b3 of \u03a3. Furthermore,\n0\n\u2032\n\u2032\nK\nK\nK\n\u03b5 (D0 ) = \u03b5 (D0 ) and AK (\u0393\u2032 ; w\u2032 ) = AK (\u0393; w | \u2202D0 ). Since Arf(qD\n) = 0 for all\n0\nother Kasteleyn orientations, the theorem follows.\n\u0003\n3. Cutting and gluing\n3.1. Cutting and gluing graphs with boundary. Let (\u0393, \u2202\u0393) be a graph with\nboundary, and let us fix an edge e of \u0393. Let (\u0393{e} , \u2202\u0393{e} ) denote the graph with\nboundary obtained from (\u0393, \u2202\u0393) as follows: cut the edge e in two, and set \u2202\u0393{e} =\n\u2202\u0393 \u222a {v \u2032 , v \u2032\u2032 }, where v \u2032 and v \u2032\u2032 are the new one valent vertices. Iterating this\nprocedure for some set of edges E leads to a graph with boundary (\u0393E , \u2202\u0393E ), which\nis said to be obtained by cutting (\u0393, \u2202\u0393) along E.\nNote that a dimer configuration D \u2208 D(\u0393, \u2202\u0393) induces an obvious dimer configuration DE \u2208 D(\u0393E , \u2202\u0393E ): cut in two the dimers of D that belong to E.\nA weight system w on \u0393 induces a family of weight systems (wEt )t on \u0393E indexed\nby t : E \u2192 R>0 , as follows: if e is an edge of \u0393 which does not belong to E, set\nwEt (e) = w(e); if e \u2208 E is cut into two edges e\u2032 , e\u2032\u2032 of \u0393E , set wEt (e\u2032 ) = t(e)w(e)1/2 and\nwEt (e\u2032\u2032 ) = t(e)\u22121 w(e)1/2 . Note that this family of weight systems is an orbit under\nthe action of the subgroup of G(\u0393E ) consisting of elements s such that s(v) = 1 for\nall v \u2208 V (\u0393) and s(v \u2032 ) = s(v \u2032\u2032 ) whenever v \u2032 , v \u2032\u2032 \u2208 \u2202\u0393E come from the same edge of\nE.\nLet us now formulate how the cutting affects the partition function. The proof\nis straightforward.\nProposition 3.1. Fix a boundary condition \u2202D0 on (\u0393, \u2202\u0393) and a set E of edges\nof \u0393. Then, given any parameter t : E \u2192 R>0 ,\nX\nZ(\u0393; w | \u2202D0 ) =\nZ(\u0393E ; wEt | \u2202D0I ),\nI\u2282E\n\nwhere the sum is taken over all subsets I of E and \u2202D0I is the boundary condition\non (\u0393E , \u2202\u0393E ) induced by \u2202D0 and I: a vertex of \u2202\u0393E is matched in \u2202D0I if and only\nif it is matched in \u2202D0 or it comes from an edge in I.\n\u0003\nThe operation opposite to cutting is called gluing: pick a pair of boundary\nvertices of \u0393, and glue the adjacent edges e\u2032 , e\u2032\u2032 along these vertices into a single\nedge e. In order for the result to be a graph, it should be assumed that e\u2032 and e\u2032\u2032\nare different edges of \u0393. We shall denote by (\u0393\u03c6 , \u2202\u0393\u03c6 ) the graph obtained by gluing\n(\u0393, \u2202\u0393) according to a pairing \u03c6 of several vertices of \u2202\u0393.\nNote that a dimer configuration D \u2208 D(\u0393, \u2202\u0393) induces a dimer configuration\nD\u03c6 \u2208 D(\u0393\u03c6 , \u2202\u0393\u03c6 ) if and only if the boundary condition \u2202D on \u2202\u0393 is compatible\nwith \u03c6, i.e: \u03c6 relates matched vertices with matched vertices. Obviously, a dimer\nconfiguration DE is compatible with the pairing \u03c6 which glues back the edges of E,\nand (DE )\u03c6 = D on ((\u0393E )\u03c6 , (\u2202\u0393E )\u03c6 ) = (\u0393, \u2202\u0393).\nAn edge weight system w on \u0393 induces an edge weight system w\u03c6 on \u0393\u03c6 as\nfollows:\n(\nw(e)\nif e is an edge of \u0393;\nw\u03c6 (e) =\n\u2032\n\u2032\u2032\nw(e )w(e ) if e is obtained by gluing the edges e\u2032 and e\u2032\u2032 of \u0393.\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n9\n\nIf E is a set of edges of \u0393 and \u03c6 is the pairing which glues back these edges, then\n(wEt )\u03c6 = w for any t : E \u2192 R>0 .\nThe effect of gluing on the partition function is best understood in the language\nof quantum field theory. We therefore postpone its study to Section 4.\n3.2. Cutting and gluing surface graphs with boundary. Let \u0393 \u2282 \u03a3 be a\nsurface graph with boundary. Let C be a simple curve in \u03a3 which is \"in general\nposition\" with respect to \u0393, in the following sense:\n(i) it is disjoint from the set of vertices of \u0393;\n(ii) it intersects the edges of \u0393 transversally;\n(iii) its intersection with any given face of \u03a3 is connected.\nLet \u03a3C be the surface with boundary obtained by cutting \u03a3 open along C. Also,\nlet \u0393C := \u0393E(C) be the graph with boundary obtained by cutting (\u0393, \u2202\u0393) along the\nset E(C) of edges of \u0393 which intersect C, as illustrated in Figure 1.\n\u0393\u2282\u03a3\n\nC\n\n\u0393C \u2282 \u03a3C\n\nFigure 1. Cutting a surface graph \u0393 \u2282 \u03a3 along a curve C.\nObviously, \u0393C \u2282 \u03a3C is a surface graph with boundary. We will say that it is\nt\nobtained by cutting \u0393 \u2282 \u03a3 along C. Abusing notation, we shall write wC\nfor the\nt\nweight system wE(C)\non \u0393C .\nA class \u03b2 \u2208 H1 (\u03a3, \u2202\u03a3; Z2 ) induces \u03b2C \u2208 H1 (\u03a3C , \u2202\u03a3C ; Z2 ) via\nH1 (\u03a3, \u2202\u03a3; Z2 ) \u2192 H1 (\u03a3, \u2202\u03a3 \u222a N (C); Z2 ) \u2243 H1 (\u03a3C , \u2202\u03a3C ; Z2 ).\nHere N (C) denotes a neighborhood of C in \u03a3, the first homomorphism is induced\nby inclusion, and the second one is the excision isomorphism. Note that given\n\u2032\nany two dimers configurations D and D\u2032 on \u0393 \u2282 \u03a3, \u2206(DC , DC\n) = \u2206(D, D\u2032 )C in\nH1 (\u03a3C , \u2202\u03a3C ; Z2 ).\nThis easily leads to the following refinement of Proposition 3.1.\nProposition 3.2. Fix \u03b2 \u2208 H1 (\u03a3, \u2202\u03a3; Z2 ), D\u2032 \u2208 D(\u0393, \u2202\u0393), and a boundary condition \u2202D0 on (\u0393, \u2202\u0393). Then, given any parameter t : E(C) \u2192 R>0 ,\nX\nt\n| \u2202D0I ),\nZ\u03b2C ,DC\u2032 (\u0393C ; wC\nZ\u03b2,D\u2032 (\u0393; w | \u2202D0 ) =\nI\u2282E(C)\n\nwhere the sum is taken over all subsets I of E(C) and \u2202D0I is the boundary condition\non (\u0393C , \u2202\u0393C ) induced by \u2202D0 and I.\n\u0003\nLet us now define the operation opposite to cutting a surface graph with boundary. Pick two closed connected subsets M1 , M2 of \u2202\u03a3, which are not points, and\nsatisfy the following properties:\n(i) M1 \u2229 M2 \u2282 \u2202M1 \u222a \u2202M2 and \u2202M1 \u222a \u2202M2 is disjoint from \u2202\u0393;\n\n\f10\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\n(ii) the intersection of each given face of \u03a3 with M1 \u222a M2 is connected;\n(iii) there exists an orientation-reversing homeomorphism \u03c6 : M1 \u2192 M2 which\ninduces a bijection M1 \u2229 \u2202\u0393 \u2192 M2 \u2229 \u2202\u0393 such that for all v in M1 \u2229 \u2202\u0393, v\nand \u03c6(v) are not adjacent to the same edge of \u0393.\nLet \u0393\u03c6 \u2282 \u03a3\u03c6 be obtained from the surface graph \u0393 \u2282 \u03a3 by identifying M1 and M2\nvia \u03c6 and removing the corresponding vertices of \u0393. This is illustrated in Figure 2.\nBy the conditions above, the pair \u0393\u03c6 \u2282 \u03a3\u03c6 remains a surface graph. It is said to\nbe obtained by gluing \u0393 \u2282 \u03a3 along \u03c6.\n\u0393\u2282\u03a3\n\n\u0393\u03c6 \u2282 \u03a3\u03c6\n\n\u03c6\n\nM1 \u2212\u2192 M2\n\nFigure 2. Gluing a surface graph \u0393 \u2282 \u03a3 along \u03c6 : M1 \u2192 M2 .\nNote that any surface graph \u0393C \u2282 \u03a3C obtained by cutting \u0393 \u2282 \u03a3 along some\ncurve C in general position with respect to \u0393 satisfies the conditions listed above.\nFurthermore, (\u0393C )\u03c6 \u2282 (\u03a3C )\u03c6 = \u0393 \u2282 \u03a3, where \u03c6 is the obvious homeomorphism\nidentifying the two closed subsets of \u2202\u03a3C coming from C. Conversely, if C denotes\nthe curve in \u03a3\u03c6 given by the identification of M1 and M2 via \u03c6, then it is in general\nposition with respect to \u0393\u03c6 , and (\u0393\u03c6 )C \u2282 (\u03a3\u03c6 )C .\n3.3. Cutting and gluing discrete spin structures. Let \u0393 \u2282 \u03a3 be a surface\ngraph with boundary, and let C be a simple curve in \u03a3 in general position with\nrespect to \u0393. As noted above, any dimer configuration D on (\u0393, \u2202\u0393) induces a dimer\nconfiguration DC on (\u0393C , \u2202\u0393C ). If two dimer configurations D, D\u2032 \u2208 D(\u0393, \u2202\u0393) are\n\u2032\nequivalent, then DC , DC\n\u2208 D(\u0393C , \u2202\u0393C ) are equivalent as well:\n\u2032\n\u2206(DC , DC\n) = \u2206(D, D\u2032 )C = 0 \u2208 H1 (\u03a3C , \u2202\u03a3C ; Z2 ).\n\nA Kasteleyn orientation K on \u0393 \u2282 \u03a3 induces a Kasteleyn orientation KC on\n\u0393C \u2282 \u03a3C as follows. Let KC be equal to K on all edges of \u0393C coming from edges\nof \u0393. For all the new edges of \u0393C , there is a unique orientation which satisfies the\nKasteleyn condition, since each face of \u03a3 is crossed at most once by C. One easily\n\u2032\nchecks that if K and K \u2032 are equivalent Kasteleyn orientations, then KC and KC\nare also equivalent. Hence, there is a well-defined operation of cutting discrete spin\nstructures on a surface with boundary.\nThis is not a surprise. Indeed, the inclusion \u03a3C \u2282 \u03a3C \u222a N (C) = \u03a3 induces\na homomorphism i\u2217 : H1 (\u03a3C ; Z2 ) \u2192 H1 (\u03a3; Z2 ). The assignment q 7\u2192 qC = q \u25e6 i\u2217\ndefines a map from the quadratic forms on H1 (\u03a3; Z2 ) to the quadratic forms on\nH1 (\u03a3C ; Z2 ), which is affine over the restriction homomorphism i\u2217 : H 1 (\u03a3; Z2 ) \u2192\nH 1 (\u03a3C ; Z2 ). By Johnson's theorem, it induces an affine map between the sets of\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n11\n\nspin structures S(\u03a3) \u2192 S(\u03a3C ). By Corollary 2.3, there is a unique map K(\u0393 \u2282\n\u03a3) \u2192 K(\u0393C \u2282 \u03a3C ) which makes the following diagram commute:\n(2)\n\nK(\u0393 \u2282 \u03a3)\n\u223c\n= \u03c8D\n\n\u000f\nS(\u03a3)\n\n/ K(\u0393C \u2282 \u03a3C )\n\u223c\n= \u03c8DC\n\n\u000f\n/ S(\u03a3C ).\n\nThis map is nothing but [K] 7\u2192 [KC ].\nNow, let K be a Kasteleyn orientation on a surface graph \u0393 \u2282 \u03a3, and let\n\u03c6 : M1 \u2192 M2 be an orientation-reversing homeomorphism between two closed connected subsets in \u2202\u03a3, as described above. We shall say that a Kasteleyn orientation\nK on \u0393 \u2282 \u03a3 is compatible with \u03c6 if the following conditions hold:\n(i) whenever two edges e\u2032 , e\u2032\u2032 of \u0393 are glued into a single edge e of \u0393\u03c6 , the\norientation K agrees on e\u2032 and e\u2032\u2032 , giving an orientation K\u03c6 on e;\n(ii) the induced orientation K\u03c6 is a Kasteleyn orientation on \u0393\u03c6 \u2282 \u03a3\u03c6 .\nThe Kasteleyn orientation K\u03c6 on \u0393\u03c6 \u2282 \u03a3\u03c6 is said to be obtained by gluing K along\n\u03c6.\nGiven any Kasteleyn orientation K on \u0393 \u2282 \u03a3, the induced orientation KC on\n\u0393C \u2282 \u03a3C is compatible with the map \u03c6 such that (\u03a3C )\u03c6 = \u03a3; furthermore, (KC )\u03c6\nis equal to K. Conversely, if K is a Kasteleyn orientation on \u0393 \u2282 \u03a3 which is\ncompatible with \u03c6, and C denotes the curve in \u03a3\u03c6 given by the identification of\nM1 and M2 via \u03c6, then (K\u03c6 )C is equal to K. With these notations, any dimer\nconfiguration D on \u0393 which is compatible with \u03c6 satisfies (D\u03c6 )C = D. Therefore,\ndiagram (2) gives\n/ K(\u0393 \u2282 \u03a3)\nK(\u0393\u03c6 \u2282 \u03a3\u03c6 )\n\u223c\n= \u03c8D\u03c6\n\n\u000f\nS(\u03a3\u03c6 )\n\n\u223c\n= \u03c8D\n\n\u000f\n/ S(\u03a3),\n\nwhere both horizontal maps are affine over i\u2217 : H 1 (\u03a3\u03c6 ; Z2 ) \u2192 H 1 (\u03a3; Z2 ). Understanding the gluing of Kasteleyn orientations (up to equivalence) now amounts to\nunderstanding the restriction homomorphism i\u2217 . Using the exact sequence of the\npair (\u03a3\u03c6 , \u03a3), one easily checks the following results:\n\u2013 The restriction homomorphism i\u2217 is injective, unless M1 and M2 are disjoint\nand belong to the same connected component of \u03a3. In this case, the kernel\nof i\u2217 has dimension 1.\n\u2013 The homomorphism i\u2217 is onto unless M1 \u222a M2 is a 1-cycle and the corresponding connected component of \u03a3\u03c6 is not closed. In this case, the\ncokernel of i\u2217 has dimension 1.\nThis leads to the four following cases. Fix a Kasteleyn orientation K on \u0393 \u2282 \u03a3.\n(1) If i\u2217 is an isomorphism, then there exist a Kasteleyn orientation K \u2032 equivalent to K which is compatible with \u03c6. Furthermore, the assignment\n[K] 7\u2192 [K\u03c6\u2032 ] gives a well-defined map between K(\u0393 \u2282 \u03a3) and K(\u0393\u03c6 \u2282 \u03a3\u03c6 ).\n(2) If i\u2217 is onto but not injective, then there exist K \u2032 , K \u2032\u2032 \u223c K which are\ncompatible with \u03c6, inducing two distinct well-defined maps [K] 7\u2192 [K\u03c6\u2032 ]\nand [K] 7\u2192 [K\u03c6\u2032\u2032 ] between K(\u0393 \u2282 \u03a3) and K(\u0393\u03c6 \u2282 \u03a3\u03c6 ).\n\n\f12\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\n(3) If i\u2217 is injective but not onto, then M1 \u222a M2 is a 1-cycle, oriented as part\nof the boundary of \u03a3. There exist K \u2032 \u223c K which is compatible with \u03c6 if\nand only if the following condition holds:\nnK (M1 ) + nK (M2 ) \u2261 0\nK\n\nn (M1 \u222a M2 ) \u2261 1\n\n(mod 2) if M1 and M2 are disjoint;\n(mod 2) otherwise.\n\n(Note that this condition only depends on the equivalence class of K.) In\nthis case, it induces a well-defined class [K\u03c6\u2032 ] in K(\u0393\u03c6 \u2282 \u03a3\u03c6 ).\n(4) Finally, assume i\u2217 is neither onto nor injective. If K satisfies the condition\nabove, then there exist K \u2032 , K \u2032\u2032 \u223c K which are compatible with \u03c6, inducing\ntwo well-defined maps [K] 7\u2192 [K\u03c6\u2032 ] and [K] 7\u2192 [K\u03c6\u2032\u2032 ]. On the other hand,\nif K does not satisfy the condition above, then it does not contain any\nrepresentative which is compatible with \u03c6.\n3.4. Cutting Pfaffians. Let us conclude this section with one last observation.\nLet \u0393 \u2282 \u03a3 be a surface graph with boundary, and let C be a simple curve in \u03a3.\nThe equality\nX\nt\nZ(\u0393C ; wC\n| \u2202D0I )\nZ(\u0393; w | \u2202D0 ) =\nI\u2282E(C)\n\nof Proposition 3.1 can be understood as the Taylor series expansion of the function\nZ(\u0393; w | \u2202D0 ) in the variables (w(e))e\u2208E(C) . Clearly, if E(C) = {ei1 , . . . , eik }, then\nk\nY\n\nl=1\n\nw(eil )\n\n\u2202 k Z(\u0393; w | \u2202D0 )\nt\n(0) = Z(\u0393C ; wC\n| \u2202D0I ).\n\u2202w(ei1 ) * * * \u2202w(eik )\n\nBy Theorem 2.4, the partition function Z(\u0393; w | \u2202D0 ) can be expressed as a linear combination of Pfaffians of matrices AK (\u0393; w | \u2202D0 ) depending on Kasteleyn\nK\norientations K of \u0393 \u2282 \u03a3 such that qD\n(\u03b3) = 0 for all boundary component \u03b3 of\n0\n\u03a3. Recall that any such orientation K extends to a Kasteleyn orientation KC on\n\u0393C \u2282 \u03a3C . Furthermore, all equivalence classes of Kasteleyn orientations such that\nKC\nq(D\n(\u03b3) = 0 for all boundary component \u03b3 of \u03a3C are obtained in this way. (This\n0 )C\nfollows from the fact that the map [K] 7\u2192 [KC ] is affine over the restriction homot\nmorphism.) Finally, the partition function Z(\u0393C ; wC\n| \u2202D0 ) can also be expressed\nt\nKC\n| \u2202D0 ) via Theorem\nas a linear combination of Pfaffians of matrices A (\u0393C ; wC\n2.4.\nGathering all these equations, we obtain a relation between the Pfaffian of the\nt\nmatrix AK (\u0393; w | \u2202D0 ) and the Pfaffian of the matrix AKC (\u0393C ; wC\n| \u2202D0 ). This\nrelation turns out to be exactly the equation below, a well-known property of Pfaffians.\nProposition 3.3. Let A = (aij ) be a skew-symmetric matrix of size 2n. Given\nan ordered subset I of the ordered set \u03b1 = (1, . . . , 2n), let AI denote the matrix\nobtained from A by removing the ith row and the ith column for all i \u2208 I. Then,\nfor any ordered set of indices I = (i1 , j1 , . . . , ik , jk ),\n\u2202 k Pf(A)\n= (\u22121)\u03c3(I) Pf(AI ),\n\u2202ai1 j1 * * * \u2202aik jk\nwhere (\u22121)\u03c3(I) denote the signature of the permutation which sends \u03b1 to the ordered\nset I(\u03b1\\I).\n\u0003\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n13\n\n4. Quantum field theory for dimers\n4.1. Quantum field theory on graphs. Let (\u0393, \u2202\u0393) be a graph with boundary,\nand let us assume that each vertex v in \u2202\u0393 is oriented, that is, endowed with some\nsign \u03b5v . In the spirit of the Atiyah-Segal axioms for a (0 + 1)-topological quantum\nfield theory [2, 13], let us define a quantum field theory on graphs as the following\nassignment:\n(1) Fix a finite dimensional complex vector space V .\n(2) To the oriented boundary \u2202\u0393, assign the vector space\nO\nO\nV \u2217,\nV \u2297\nZ(\u2202\u0393) =\nv\u2208\u2202\u0393\n\u03b5v =+1\n\nv\u2208\u2202\u0393\n\u03b5v =\u22121\n\nwhere V \u2217 denotes the vector space dual to V .\n(3) To a finite graph \u0393 with oriented boundary \u2202\u0393 and weight system w, assign\nsome vector Z(\u0393; w) \u2208 Z(\u2202\u0393), with Z(\u2205; w) = 1 \u2208 C = Z(\u2205).\nNote that any orientation preserving bijection f : \u2202\u0393 \u2192 \u2202\u0393\u2032 induces an isomorphism Z(f ) : Z(\u2202\u0393) \u2192 Z(\u2202\u0393\u2032 ) given by permutation of the factors. This assignment is functorial: if g : \u2202\u0393\u2032 \u2192 \u2202\u0393\u2032\u2032 is another orientation preserving bijection,\nthen Z(g \u25e6 f ) = Z(g) \u25e6 Z(f ). Finally, if f : \u2202\u0393 \u2192 \u2202\u0393\u2032 extends to a homeomorphism\nF : \u0393 \u2192 \u0393\u2032 , then Z(f ) maps Z(\u0393) to Z(\u0393\u2032 ). Note also that Z(\u2212\u2202\u0393) = Z(\u2202\u0393)\u2217 , and\nthat Z(\u2202\u0393 \u2294 \u2202\u0393\u2032 ) = Z(\u2202\u0393) \u2297 Z(\u2202\u0393\u2032 ).\nThe main point is that we require the following gluing axiom. Let \u0393 be a graph\nwith oriented boundary \u2202\u0393, such that there exists two disjoint subsets X1 , X2 of \u2202\u0393\nand an orientation reversing bijection \u03c6 : X1 \u2192 X2 (i.e. \u03b5\u03c6(v) = \u2212\u03b5v for all v \u2208 X1 ).\nObviously, \u03c6 induces a linear isomorphism Z(\u03c6) : Z(X1 ) \u2192 Z(X2 )\u2217 . Let \u0393\u03c6 denote\nthe graph with boundary \u2202\u0393\u03c6 = \u2202\u0393 \\ (X1 \u222a X2 ) obtained by gluing \u0393 according to\n\u03c6, and let w\u03c6 be the corresponding weight system on \u0393\u03c6 (recall Section 3.1). Let\nB\u03c6 denote the composition\nZ(\u2202\u0393) = Z(\u2202\u0393\u03c6 ) \u2297 Z(X1 ) \u2297 Z(X2 ) \u2192 Z(\u2202\u0393\u03c6 ) \u2297 Z(X2 )\u2217 \u2297 Z(X2 ) \u2192 Z(\u2202\u0393\u03c6 ),\nwhere the first homomorphism is given by id \u2297 Z(\u03c6) \u2297 id, and the second is induced\nby the natural pairing Z(X2 )\u2217 \u2297 Z(X2 ) \u2192 C. We require that\nB\u03c6 (Z(\u0393; w)) = Z(\u0393\u03c6 ; w\u03c6 ).\nRemark. In the same spirit, one can define a quantum field theory on surface graphs.\nHere, the vector Z(\u0393 \u2282 \u03a3; w) \u2208 Z(\u2202\u0393) might depend on the realization of \u0393 as a\nsurface graph \u0393 \u2282 \u03a3, and the gluing axiom concerns gluing of surface graphs, as\ndefined in Section 3.2.\n4.2. Quantum field theory for dimers on graphs. Let us now explain how\nthe dimer model on weighted graphs with boundary defines a quantum field theory.\nAs vector space V , choose the 2-dimensional complex vector space with fixed basis\na0 , a1 . Let \u03b10 , \u03b11 denote the dual basis in V \u2217 . To a finite graph \u0393 with oriented\nboundary \u2202\u0393 and weight system w, assign\nX\nZ(\u0393; w) =\nZ(\u0393; w | \u2202D) a(\u2202D) \u2208 Z(\u2202\u0393),\n\u2202D\n\nwhere the sum is on all possible boundary conditions \u2202D on \u2202\u0393, and\nO\nO\n\u03b1iv (\u2202D) \u2208 Z(\u2202\u0393).\naiv (\u2202D) \u2297\na(\u2202D) =\nv\u2208\u2202\u0393\n\u03b5v =+1\n\nv\u2208\u2202\u0393\n\u03b5v =\u22121\n\n\f14\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nHere, iv (\u2202D) = 1 if the vertex v is matched by \u2202D, and iv (\u2202D) = 0 otherwise.\nLet us check the gluing axiom. First note that B\u03c6 (a(\u2202D)) = 0 unless \u2202D is\ncompatible with \u03c6 (i.e: unless \u03c6(v) is matched in \u2202D if and only if v is matched in\n\u2202D). In such a case, B(a(\u2202D)) = a(\u2202D|\u2202\u0393\u03c6 ), where \u2202D|\u2202\u0393\u03c6 denotes the restriction\nof the boundary condition \u2202D to \u2202\u0393\u03c6 \u2282 \u2202\u0393. All the possible boundary conditions\n\u2202D\u03c6 on \u2202\u0393\u03c6 are given by such restrictions. Therefore,\n\u0011\nX\u0010 X\nB\u03c6 (Z(\u0393; w)) =\nZ(\u0393; w | \u2202D) a(\u2202D\u03c6 ),\n\u2202D\u03c6\n\n\u2202D\u2283\u2202D\u03c6\n\nthe interior sum being on all boundary conditions \u2202D on \u2202\u0393 that are compatible\nwith \u03c6, and such that \u2202D|\u2202\u0393\u03c6 = \u2202D\u03c6 . By definition,\nX\nX\nw(D) = Z(\u0393\u03c6 ; w\u03c6 | \u2202D\u03c6 ).\nZ(\u0393; w | \u2202D) =\nD:\u2202D\u2283\u2202D\u03c6\n\n\u2202D\u2283\u2202D\u03c6\n\nTherefore, the gluing axiom is satisfied.\n4.3. The dimer model as the theory of free Fermions. Let W be an ndimensional vector space. The choice of an ordered basis in W induces an isomorV\nVk\nphism between its exterior algebra W = \u2295nk=0\nW and the algebra generated\nby elements \u03c61 , . . . , \u03c6n with defining relations \u03c6i \u03c6j = \u2212\u03c6j \u03c6i . This space is known\nas the Grassman algebra generated by \u03c61 , . . . , \u03c6n . The choice of an ordered basis\nin W also defines a basis in the top exterior\nV power of W . The integral over the\nGrassman algebra of W of an element a \u2208 W is the coordinate\nR of a in the top\nexterior power of W with respect to this basis. It is denoted by a d\u03c6.\nThere is a scalar product on the Grassman algebra generated by \u03c61 , . . . , \u03c6n ; it\nis given by the Grassman integral\nZ\nn\n\u0011\n\u0010X\n\u03c6i \u03c8i F (\u03c6)G(\u03c8)d\u03c6d\u03c8.\n(3)\n< F, G >= exp\ni=1\n\nNote that the monomial basis is orthonormal with respect to this scalar product.\nOne easily shows (see e.g. the Appendix to [3]) that the Pfaffian of a skew symmetric\nmatrix A = (aij ) can be written as\nZ\nn\n\u0011\n\u00101 X\nPf(A) = exp\n\u03c6i aij \u03c6j d\u03c6.\n2 i,j=1\nLet us now use this to reformulate the quantum field theory of dimers in terms of\nGrassman integrals. Let \u0393 \u2282 \u03a3 be a (possibly disconnected) surface graph, possibly\nwith boundary. Let us fix a numbering of the vertices of \u0393, a boundary condition\n\u2202D0 on \u2202\u0393 and a Kasteleyn orientation K on \u0393 \u2282 \u03a3. Let aK\nij be the Kasteleyn\ncoefficient associated to K and the vertices i, j of \u0393 (recall Section 2). By Theorem\n2.4 and the identity above,\nZ\n\u0011\n\u00101 X\n1 X\nK\nK\nK\nd\u03c6\u2202D0 ,\n\u03c6\na\n\u03c6\n)\u03b5\n(D\n)\nexp\nArf(qD\nZ(\u0393; w | \u2202D0 ) = g\ni\nj\n0\nij\n0\n2\n2\n[K]\n\ni,j\u2208V (D0 )\n\nwhere the sum is over all 2b1 (\u03a3) equivalence classes of Kasteleyn orientations on\n\u0393 \u2282 \u03a3, V (D0 ) denotes the set of vertices of \u0393 that are matched by D0 , and d\u03c6\u2202D0 =\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n\u2227i\u2208V (D0 ) d\u03c6i . This leads to the formula\nZ\n\u00101\n1 X\nZ(\u0393; w | \u2202D0 ) = g\nexp\n2\n2\n[K]\n\nK\nD\u2202D\n\u03c6\n0\n\nX\n\ni,j\u2208V (D0 )\n\n15\n\n\u0011\nK\n\u03c6i aK\nij \u03c6j D\u2202D0 \u03c6,\n\nK\nArf(qD\n)\u03b5K (D0 ) d\u2202D0 \u03c6.\n0\n\nwhere\n=\nLet us point out that this measure does\nnot depend on the choice of D0 , but only on the induced boundary condition \u2202D0 .\nNow, the numbering of the vertices of \u0393 gives a numbering of the vertices V\nof \u2202\u0393.\nThis induces a linear isomorphism between Z(\u2202\u0393) and the Grassman algebra (\u2202\u0393)\ngenerated by (\u03c6i )i\u2208\u2202\u0393 . The image of the partition function under this isomorphism\nis the following element of the Grassman algebra of boundary vertices:\nX\nV\nQ\nZ(\u0393; w) =\nZ(\u0393; w | \u2202D0 ) i\u2208V (\u2202D0 ) \u03c6i \u2208 (\u2202\u0393),\n\u2202D0\n\nwhere V (\u2202D0 ) = V (D0 ) \u2229 \u2202\u0393. This leads to\nZ\n\u0011\n\u00101 X\nQ\n1 XX\nK\n\u03c6i aK\nZ(\u0393; w) = g\nexp\nij \u03c6j D\u2202D0 \u03c6\ni\u2208V (\u2202D0 ) \u03c6i\n2\n2\n\u2202D0 [K]\ni,j\u2208V (D0 )\nZ\n\u0011\n\u00101 X\n1 X\nK\n= g\n\u03c6i aK\nexp\nij \u03c6j D \u03c6,\n2\n2\n[K]\n\nK\n\ni,j\u2208V (\u0393)\n\nK\nArf(qD\n)\u03b5K (D0 )\n0\n\nwhere D \u03c6 =\n\u2227i\u2208\u2202\u0393\nd\u03c6i . This measure depends only on K, but\n/\nnot on D0 .\nWe can now formulate the dimer model as the theory of free (Gaussian) Fermions:\nV\n(1) To the boundary of \u0393 \u2282 \u03a3, we assign (\u2202\u0393), the Grassman algebra generated by the ordered set \u2202\u0393;\n(2) To a surface graph \u0393 \u2282 \u03a3 with ordered set of vertices\nV (\u0393) and weight\nV\nsystem w, we assign the element Z(\u0393 \u2282 \u03a3; w) of (\u2202\u0393) given by\nZ\n\u0011\n\u00101 X\n1 X\nDK \u03c6,\n\u03c6i aK\n\u03c6\nZ(\u0393 \u2282 \u03a3; w) = g\nexp\nj\nij\n2\n2\n[K]\n\ni,j\u2208V (\u0393)\n\nwhere the sum is over all 2b1 (\u03a3) equivalence classes of Kasteleyn orientations\nK\non \u0393 \u2282 \u03a3, and DK \u03c6 = Arf(qD\n)\u03b5K (D0 ) \u2227i\u2208\u2202\u0393\nd\u03c6i .\n/\n0\nThe gluing axiom now takes the following form. Let \u0393\u03c6 \u2282 \u03a3\u03c6 denote the surface\ngraph with boundary obtained by gluing \u0393 \u2282 \u03a3 along some orientation-reversing\nhomeomorphism \u03c6 : M1 \u2192 M2 (see Section 3.2). Recall that \u03c6 induces a bijection\nbetween the two disjoint sets XV\nM1 and X2 = \u2202\u0393 \u2229 M2 . Therefore, it\n1 = \u2202\u0393 \u2229 V\ninduces an isomorphism Z(\u03c6) : (X1 ) \u2192 (X2 ). Consider the map B\u03c6 given by\nthe composition\nV\nV\nV\nV\nV\nV\nV\nV\n(\u2202\u0393) = (\u2202\u0393\u03c6 ) \u2297 (X1 ) \u2297 (X2 ) \u2192 (\u2202\u0393\u03c6 ) \u2297 (X2 )\u2217 \u2297 (X2 ) \u2192 (\u2202\u0393\u03c6 ).\nV\nHere, the first homomorphism is given by id \u2297 (h \u25e6 Z(\u03c6)) \u2297 id, where h : (X2 ) \u2192\nV\n(X2 )\u2217 is the isomorphism induced by the scalar product (3). Then, we require\nthat\nB\u03c6 (Z(\u0393 \u2282 \u03a3; w)) = Z(\u0393\u03c6 \u2282 \u03a3\u03c6 ; w\u03c6 ).\nWe already know that this equality holds. Indeed, Z(\u0393 \u2282 \u03a3; w) just depends on\n(\u0393, w), and the formula above is nothing but the gluing axiom for Z(\u0393; w) translated\nin the formalism of Grassman algebras. However, it can also be proved from scratch\nusing the results of Section 3.3 together with well-known properties of Pfaffians.\n\n\f16\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\n5. Dimers on bipartite graphs and height functions\n5.1. Composition cycles on bipartite graphs. Recall that a bipartite structure\non a graph \u0393 is a partition of its set of vertices into two groups, say blacks and\nwhites, such that no edge of \u0393 joins two vertices of the same group. Equivalently,\na bipartite structure can be regarded as a 0-chain\nX\nX\n\u03b2=\nv\u2212\nv \u2208 C0 (\u0393; Z).\nv black\n\nv white\n\nA bipartite structure induces an orientation on the edges of \u0393, called the bipartite\norientation: simply orient all the edges from the white vertices to the black ones.\nUsing this orientation, a dimer configuration D \u2208 D(\u0393, \u2202\u0393) can now be regarded\nas a 1-chain with Z-coefficients\nX\nD=\ne \u2208 C1 (\u0393; Z)\ne\u2208D\n\nsuch that \u2202D = \u03b2 in C0 (\u0393, \u2202\u0393; Z) = C0 (\u0393; Z)/C0 (\u2202\u0393; Z). Therefore, given two\ndimer configurations D, D\u2032 on \u0393, their difference D \u2212 D\u2032 is a 1-cycle (rel \u2202\u0393) with\nZ-coefficients, denoted by C(D, D\u2032 ). Its connected components are called (D, D\u2032 )composition cycles. In short, a bipartite structure on a graph allows to orient the\ncomposition cycles.\n5.2. Height functions for planar bipartite graphs. Let us now assume that\nthe bipartite graph \u0393 is planar without boundary, i.e. that it can be realized\nas a surface graph \u0393 \u2282 S 2 . Let X denote the induced cellular decomposition\nof the 2-sphere, which we endow with the counter-clockwise orientation. Since\nH1 (X; Z) = H1 (S 2 ; Z) = 0, the 1-cycle C(D, D\u2032 ) is a 1-boundary, so there exists\n\u03c3D,D\u2032 \u2208 C2 (X; Z) such that \u2202\u03c3D,D\u2032 = C(D, D\u2032 ). Let hD,D\u2032 \u2208 C 2 (X; Z) be given\nby the equality\nX\nhD,D\u2032 (f ) f \u2208 C2 (X; Z),\n\u03c3D,D\u2032 =\nf \u2208F (X)\n\nwhere the sum is over all faces of X. The cellular 2-cochain hD,D\u2032 is called a height\nfunction associated to D, D\u2032 . Since H2 (X; Z) = H2 (S 2 ; Z) = Z, the 2-chain \u03c3D,D\u2032\nis uniquely defined by D, D\u2032 up to a constant, and the same holds for hD,D\u2032 . Hence,\none can normalize all height functions by setting hD,D\u2032 (f0 ) = 0 for some fixed face\nf0 . This is illustrated in Figure 3.\nAlternatively, hD,D\u2032 can be defined as the only h \u2208 C 2 (X; Z) such that h(f0 ) = 0\nand h increases by 1 when a (D, D\u2032 )-composition cycle is crossed in the positive\ndirection (left to right as we cross). It follows that for any height function h and\nany two 2-cells f1 and f2 ,\n|h(f1 ) \u2212 h(f2 )| \u2264 d(f1 , f2 ),\nwhere d(f1 , f2 ) is the distance between f1 and f2 in the dual graph, i.e. the minimal\nnumber of edges crossed by a path connecting an point inside f1 with a point inside\nf2 . This can be regarded as a Lipschitz property of height functions. Note also\nthat for any three dimer configurations D, D\u2032 and D\u2032\u2032 on \u0393, the following cocycle\nequality holds:\nhD,D\u2032 + hD\u2032 ,D\u2032\u2032 = hD,D\u2032\u2032 .\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n\u22121\n\n17\n\n0\n\n0\n1\n0\n0\n\nFigure 3. An example of a bipartite planar graph with two dimer\nconfigurations D (solid) and D\u2032 (traced lines). The corresponding\nheight function hD,D\u2032 (where f0 is the outer face) and (D, D\u2032 )composition cycles are pictured on the right hand side.\nThe Lipschitz condition stated above leads to the following definition. Given a\nfixed 2-cell f0 of the cellular decomposition X induced by \u0393 \u2282 S 2 , set\nH(X, f0 ) = {h \u2208 C 2 (X; Z) | h(f0 ) = 0 and |h(f1 ) \u2212 h(f2 )| \u2264 d(f1 , f2 ) \u2200f1 , f2 }.\nGiven h \u2208 H(X, f0 ), let C(h) denote the oriented closed curves formed by the\nset of oriented edges e of \u0393 such that h increases its value by 1 when crossing e in\nthe positive direction. (In other words, C(h) = \u2202\u03c3, where \u03c3 \u2208 C2 (X; Z) is dual to\nh \u2208 C 2 (X; Z).) Obviously, there is a well-defined map\nD(\u0393) \u00d7 D(\u0393) \u2192 H(X, f0 ),\n\n(D, D\u2032 ) 7\u2192 hD,D\u2032\n\nwith C(hD,D\u2032 ) = C(D, D\u2032 ). However, this map is neither injective nor surjective\nin general. Indeed, the number of preimages of a given h is equal to the number of\ndimer configurations on the graph obtained from \u0393 by removing the star of C(h).\nDepending on \u0393 \u2282 S 2 , this number can be zero, or arbitrarily large.\nTo obtain a bijection, we proceed as follows. Fix a dimer configuration D0 on \u0393.\nLet C(D0 ) denote the set of all C \u2282 \u0393 consisting of disjoint oriented simple 1-cycles,\nsuch that the following condition holds: for all e \u2208 D0 , either e is contained in C\nor e is disjoint from C. Finally, set\nHD0 (X, f0 ) = {h \u2208 H(X, f0 ) | C(h) \u2208 C(D0 )}.\nProposition 5.1. Given any h \u2208 HD0 (X, f0 ), there is unique dimer configuration\nD \u2208 D(\u0393) such that hD,D0 = h. Furthermore, given any two dimer configurations\nD0 , D1 on \u0393, we have a canonical bijection\nHD0 (X, f0 ) \u2192 HD1 (X, f0 )\ngiven by h 7\u2192 h + hD0 ,D1 .\nProof. One easily checks that the assignment D 7\u2192 C(D, D0 ) defines a bijection\nD(\u0393) \u2192 C(D0 ). Furthermore, there is an obvious bijection HD0 (X, f0 ) \u2192 C(D0 )\ngiven by h 7\u2192 C(h). This induces a bijection D(\u0393) \u2192 HD0 (X, f0 ) and proves the\nfirst part of the proposition. The second part follows from the first one via the\n\u0003\ncocycle identity hD,D0 + hD0 ,D1 = hD,D1 .\n\n\f18\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nLet us now consider an edge weight system w on the bipartite planar graph \u0393.\nRecall that the Gibbs measure of D \u2208 D(\u0393) is given by\nProb(D) =\n\nw(D)\n,\nZ(\u0393; w)\nP\n\nQ\nwhere w(D) = e\u2208D w(D) and Z(\u0393; w) = D\u2208D(\u0393) w(D). Let us now fix a dimer\nconfiguration D0 and a face f0 of X, and use the bijection D(\u0393) \u2192 HD0 (X, f0 ) given\nby D 7\u2192 hD,D0 to translate this measure into a probability measure on HD0 (X, f0 ).\nTo do so, we shall need the following notations: given an oriented edge e of \u0393,\nset\n(\nw(e)\nif the orientation on e agrees with the bipartite orientation;\nw\u03b2 (e) =\nw(e)\u22121 otherwise.\nThis defines a group homomorphism w\u03b2 : C1 (X; Z) \u2192 R>0 . Finally, given any\nf \u2208 F (X), set\nqf = w\u03b2 (\u2202f ),\nwhere \u2202f is oriented as the boundary of the counter-clockwise oriented face f . This\nnumber qf is called the volume weight of the face f .\nProposition 5.2. The Gibbs measure on D(\u0393) given by the edge weight system w\ntranslates into the following probability measure on HD0 (X, f0 ):\nProbD0 (h) =\nwhere\nq(h) =\n\nY\n\nh(f )\n\nqf\n\nand\n\nq(h)\n,\nZD0 ,f0 (X, q)\nX\n\nZD0 ,f0 (X; q) =\n\nq(h).\n\nh\u2208HD0 (X,f0 )\n\nf \u2208F (X)\n\nFurthermore, this measure is independant of the choice of f0 . Finally, the bijection\nHD0 (X, f0 ) \u2192 HD1 (X, f0 ) given by h 7\u2192 h + hD0 ,D1 is invariant with respect to the\nmeasures ProbD0 and ProbD1 .\nProof. For any D \u2208 D(\u0393), we have\nY\nY\nw(e)\u22121 = w\u03b2 (C(D, D0 ))\nw(D)w(D0 )\u22121 =\nw(e)\ne\u2208D\n\ne\u2208D0\n\n= w\u03b2 (\u2202\u03c3D,D0 ) = w\u03b2\n\n\u0010 X\n\nhD,D0 (f )\u2202f\n\nf \u2208F (X)\n\n=\n\nY\n\nf \u2208F (X)\n\nw\u03b2 (\u2202f )hD,D0 (f ) =\n\nY\n\nh\n\n\u0011\n\nqf D,D0\n\n(f )\n\n= q(hD,D0 ).\n\nf \u2208F (X)\n\nThe proposition follows easily from this equality.\n\n\u0003\n\nLet V (\u0393) (resp. E(\u0393)) denote the set of vertices (resp. of edges) of \u0393. Recall\nthat the group\nG(\u0393) = {s : V (\u0393) \u2192 R>0 }\nacts on the set of weight systems on \u0393 by (sw)(e) = s(e+ )w(e)s(e\u2212 ), where e+ and\ne\u2212 are the two vertices adjacent to the edge e. As observed in Section 1.1, the\nGibbs measure on D(\u0393) is invariant under the action of the group G(\u0393).\nNote also that this action is free unless \u0393 is bipartite. In this later case, the\n1-parameter family of elements s\u03bb \u2208 G(\u0393) given by s\u03bb (v) = \u03bb if v is black and\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n19\n\ns\u03bb (v) = \u03bb\u22121 if v is white act as the identity on the set of weight systems. Hence, if\n\u0393 is bipartite, the number of \"essential\" parameters is equal to |E(\u0393)| \u2212 |V (\u0393)| + 1.\nIf this bipartite graph is planar, then\n|E(\u0393)| \u2212 |V (\u0393)| + 1 = |F (X)| \u2212 \u03c7(S 2 ) + 1 = |F (X)| \u2212 1.\nThe |F (X)| volume weights qf are invariant\nQ with respect to the action of G(\u0393). They\ncan be normalized in such a way that f \u2208F (X) qf = 1, giving exactly |F (X)| \u2212 1\nparameters. Thus, in the height function formulation of the Gibbs measure, only\nessential parameters appear.\n5.3. Height functions for bipartite surface graphs. Let us now address the\ngeneral case of a bipartite surface graph \u0393 \u2282 \u03a3, possibly disconnected, and possibly\n1\nof oriented simple curves in \u0393\nwith boundary \u2202\u0393 \u2282 \u2202\u03a3. Fix a family \u03b3 = {\u03b3i }bi=1\nrepresenting a basis in H1 (\u03a3, \u2202\u03a3; Z). Note that such a family of curves exists since\n\u0393 is the 1-squeletton of a cellular decomposition X of \u03a3.\nGiven any D, D\u2032 \u2208 D(\u0393, \u2202\u0393), the homology class of C(D, D\u2032 ) = D \u2212 D\u2032 can be\nwritten in a unique way\n[C(D, D\u2032 )] =\n\nb1\nX\n\na\u03b3D,D\u2032 (i)[\u03b3i ] \u2208 H1 (\u03a3, \u2202\u03a3; Z),\n\ni=1\n\nPb1 \u03b3\nwith a\u03b3D,D\u2032 (i) \u2208 Z. Hence, C(D, D\u2032 ) \u2212 i=1\naD,D\u2032 (i)\u03b3i is a 1-boundary (rel \u2202X),\n\u03b3\nthat is, there exists \u03c3D,D\n\u2032 \u2208 C2 (X, \u2202X; Z) = C2 (X; Z) such that\n(4)\n\n\u2032\n\nC(D, D ) \u2212\n\n\u03b3\n\u2202\u03c3D,D\n\u2032\n\n\u2212\n\nb1\nX\n\na\u03b3D,D\u2032 (i)\u03b3i \u2208 C1 (\u2202X; Z).\n\ni=1\n\nh\u03b3D,D\u2032\n\n\u03b3\nThe 2-cochain\n\u2208 C (X; Z) dual to \u03c3D,D\n\u2032 is called a height function associated\n\u2032\nto D, D with respect to \u03b3. Since Z2 (X, \u2202X; Z) = H2 (X, \u2202X; Z) = H2 (\u03a3, \u2202\u03a3; Z) \u223c\n=\n\u03b3\n\u2032\nH 0 (\u03a3; Z), the 2-chain \u03c3D,D\n\u2032 is uniquely determined by D, D and \u03b3 up to an element\nof H 0 (\u03a3; Z), and the same holds for h\u03b3D,D\u2032 . In other words, the set of height\nfunctions associated to D, D\u2032 with respect to \u03b3 is an affine H 0 (\u03a3; Z)-space: it admits\na freely transitive action of the abelian group H 0 (\u03a3; Z). One can normalize the\nheight functions by choosing some family F0 of faces of X, one for each connected\ncomponent of X, and by setting h\u03b3D,D\u2032 (f0 ) = 0 for all f0 \u2208 F0 .\nGiven h \u2208 C 2 (X; Z), set C(h) = \u2202\u03c3 \u2208 C1 (X; Z), where \u03c3 \u2208 C2 (X; Z) is dual to\nh \u2208 C 2 (X; Z). Given a fixed D0 \u2208 D(\u0393, \u2202\u0393), let C(D0 ) denote the set of all C \u2282 \u0393\nconsisting of disjoint oriented 1-cycles (rel \u2202\u0393) such that the following condition\nholds: for all e \u2208 D0 , either e is contained in C or e is disjoint from C.\n\u03b3\n(X, F0 ) denote the set of pairs (h, a) \u2208 C 2 (X; Z) \u00d7 Zb1 which\nFinally, let HD\n0\nsatisfy the following properties:\n2\n\n\u2013 h(f0 ) = 0 for all f0 in F0 ;\nPb1\na(i)\u03b3i \u2208 C1 (\u2202X; Z).\n\u2013 there exists C \u2208 C(D0 ) such that C \u2212 C(h) \u2212 i=1\n\nWe obtain the following generalization of Proposition 5.1. The proof is left to the\nreader.\n\u03b3\n(X, F0 ), there is a unique dimer configProposition 5.3. Given any (h, a) \u2208 HD\n0\n\u03b3\nuration D \u2208 D(\u0393, \u2202\u0393) such that hD,D0 = h and a\u03b3D,D0 = a. Furthermore, given any\n\n\f20\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\ntwo dimer configuration D0 , D1 \u2208 D(\u0393, \u2202\u0393), there is a canonical bijection\n\u03b3\n\u03b3\n(X, F0 )\n(X, F0 ) \u2192 HD\nHD\n1\n0\n\ngiven by (h, a) 7\u2192 (h + h\u03b3D0 ,D1 , a + a\u03b3D0 ,D1 ).\n\n\u0003\n\nRecall that the boundary conditions on dimer configurations induce a partition\nG\nD(\u0393, \u2202\u0393 | \u2202D0\u2032 ),\nD(\u0393, \u2202\u0393) =\n\u2202D0\u2032\n\nwhere D(\u0393, \u2202\u0393 | \u2202D0\u2032 ) = {D \u2208 D(\u0393, \u2202\u0393) | \u2202D = \u2202D0\u2032 }. This partition translates\n\u03b3\n\u03b3\ninto a partition of HD\n(X, F0 ) via the bijection D(\u0393, \u2202\u0393) \u2192 HD\n(X, F0 ) given by\n0\n0\n\u03b3\n\u03b3\nD 7\u2192 (hD,D0 , aD,D0 ). Indeed, let F\u2202 (X) denote the set of boundary faces of X, that\nis, the set of faces of X that are adjacent to \u2202\u03a3. The choice of a boundary condition\n\u2202D0\u2032 (together with F0 ) determines h\u03b3D,D0 (f ) for all D such that \u2202D = \u2202D0\u2032 and\nall f \u2208 F\u2202 (X). The actual possible values of h\u03b3D,D0 on the boundary faces depend\non \u03b3, D0 and F0 ; they can be determined explicitely. We shall denote by \u2202h such\na value of a height function on boundary faces, and call it a boundary condition for\nheight functions. In short, we obtain a partition\nG \u03b3\n\u03b3\nHD0 (X, F0 | \u2202h\u20320 )\nHD\n(X, F0 ) =\n0\n\u2202h\u20320\n\nindexed by all possible boundary conditions on height functions h\u03b3D,D0 . Each boundary condition on dimer configurations corresponds to one boundary condition on\nheight functions via D 7\u2192 h\u03b3D,D0 .\nLet us now consider an edge weight system w on the bipartite graph \u0393, and a\nfixed boundary condition \u2202D0\u2032 . Recall that the Gibbs measure for the dimer model\non (\u0393, \u2202\u0393) with weight system w and boundary condition \u2202D0\u2032 is given by\nProb(D | \u2202D0\u2032 ) =\n\nw(D)\n,\nZ(\u0393; w | \u2202D0\u2032 )\n\nwhere\nZ(\u0393; w | \u2202D0\u2032 ) =\n\nX\n\nw(D).\n\nD\u2208D(\u0393,\u2202\u0393 | \u2202D0\u2032 )\n\nLet us realize \u0393 as a surface graph \u0393 \u2282 \u03a3, fix a dimer configuration D0 \u2208\nD(\u0393, \u2202\u0393), a family \u03b3 = {\u03b3i } of oriented simple curves in \u0393 representing a basis\nin H1 (\u03a3, \u2202\u03a3; Z), and a collection F0 of faces of the induced cellular decomposition\nX of \u03a3, one face for each connected component of X. We can use the bijection\n\u03b3\nD(\u0393, \u2202\u0393 | \u2202D0\u2032 ) \u2192 HD\n(X, F0 | \u2202h\u20320 ) given by D 7\u2192 (h\u03b3D,D0 , a\u03b3D,D0 ) to translate the\n0\n\u03b3\nGibbs measure into a probability measure on HD\n(X, F0 | \u2202h\u20320 ).\n0\nTo do so, let us first extend the weight system w to all edges of X by setting\nw(e) = 1 for all boundary edges of X. As in the planar case, define w\u03b2 : C1 (X; Z) \u2192\nR>0 as the group homomorphism such that, for any oriented edge e of X,\n(\nw(e)\nif the orientation on e agrees with the bipartite orientation;\nw\u03b2 (e) =\n\u22121\nw(e)\notherwise.\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\n21\n\nNote that this makes sense even for boundary edges where there is no bipartite\norientation, as w(e) = 1 for such edges. Consider the parameters\nqf = w\u03b2 (\u2202f ) for all f \u2208 F (X) \\ F\u2202 (X);\nqi = w\u03b2 (\u03b3i )\n\nfor all 1 \u2264 i \u2264 b1 .\n\nWe obtain the following generalization of Proposition 5.2:\n\u03b3\n(X, F0 ), set\nProposition 5.4. Given an element (h, a) \u2208 HD\n0\nY a(i)\nY\nh(f )\nqi .\nqf\nq(h, a) =\n1\u2264i\u2264b1\n\nf \u2208F (X)\\F\u2202 (X)\n\nThen, the Gibbs measure for the dimer model on (\u0393, \u2202\u0393) with weight system w\nand boundary condition \u2202D0\u2032 translates into the following probability measure on\n\u03b3\nHD\n(X, F0 | \u2202h\u20320 ):\n0\nProbD0 (h, a | \u2202h\u20320 ) =\n\nq(h, a)\n\n,\n\u03b3\n(X; q | \u2202h\u20320 )\nZD\n0 ,F0\n\nwhere\n\u03b3\n(X; q | \u2202h\u20320 ) =\nZD\n0 ,F0\n\nX\n\nq(h, a).\n\n\u03b3\n(h,a)\u2208HD\n(X,F0 | \u2202h\u20320 )\n0\n\nFurthermore, the measure is independant of the choice of F0 . Finally, the bijection\n\u03b3\n\u03b3\nHD\n(X, F0 | \u2202h\u20320 ) \u2192 HD\n(X, F0 | \u2202h\u20321 ) given by (h, a) 7\u2192 (h + h\u03b3D0 ,D1 , a + a\u03b3D0 ,D1 ) is\n0\n1\ninvariant with respect to the measures ProbD0 and ProbD1 .\nProof. For any D \u2208 D(\u0393, \u2202\u0393 | \u2202D0\u2032 ), equation (4) leads to\n\u0001\nPb1 \u03b3\n\u03b3\n\u2212 i=1\naD,D0 (i)\u03b3i = 1.\nw\u03b2 C(D, D0 ) \u2212 \u2202\u03c3D,D\n0\n\nComputing the first term, we get\nY\nY\nw\u03b2 (C(D, D0 )) =\nw(e)\nw(e)\u22121 = w(D)w(D0 )\u22121 .\ne\u2208D\n\ne\u2208D0\n\nAs for the second one,\n\u03b3\nw\u03b2 (\u2202\u03c3D,D\n) = w\u03b2\n0\n\n\u0010 X\n\nf \u2208F (X)\n\n\u0011\nhD,D0 (f )\u2202f =\n\nY\n\nh\n\nqf D,D0\n\n(f )\n\n.\n\nf \u2208F (X)\n\nSince w\u03b2 (\u03b3i ) = qi , these equations lead to\nY h\u03b3D,D (f ) Y a\u03b3D,D (i)\n0\nqi\n= \u03bb * q(h\u03b3D,D0 , a\u03b3D,D0 ),\nqf 0\nw(D) = w(D0 )\nf \u2208F (X)\n\n1\u2264i\u2264b1\n\nQ\nh\u03b3\n(f )\ndepends only on D0 and \u2202D0\u2032 . The proposiwhere \u03bb = w(D0 ) f \u2208F\u2202 (X) qf D,D0\ntion follows easily from this equality.\n\u0003\nLet us count the number of essential parameters in the dimer model on (\u0393, \u2202\u0393)\nwith some boundary condition partitioning \u2202\u0393 into (\u2202\u0393)nm \u2294 (\u2202\u0393)m , matched and\nnon-matched vertices. We have |E(\u0393)| \u2212 |(\u2202\u0393)nm | edge weights, with an action of a\n(|V (\u0393)|\u2212|(\u2202\u0393)nm |)-parameter group. Since \u0393 is bipartite, there is a b0 (\u0393)-parameter\n\n\f22\n\nDAVID CIMASONI AND NICOLAI RESHETIKHIN\n\nsubgroup acting as the identity. Therefore, the number of essential parameters is\nequal to\n|E(\u0393)| \u2212 |V (\u0393)| + b0 (\u0393) = |E(X)| \u2212 |\u2202\u0393| \u2212 |V (X)| + b0 (X)\n= |F (X)| \u2212 |\u2202\u0393| \u2212 \u03c7(X) + b0 (X)\n= |F (X) \\ F\u2202 (X)| + b1 (\u03a3) \u2212 b2 (\u03a3).\nThe numbers |F (X) \\ F\u2202 (X)| and b1 (\u03a3) correspond to\nQ the parameters qf and qi .\nFurthermore, the parameters qf can be normalized by f qf = 1, the product being\non all faces of a given closed component of \u03a3. Therefore, we obtain exactly the\nright number of parameters in this height function formulation of the dimer model.\nRemark. Note that all the results of the first part of the present section can be\nadapted to the general case of a non-necessarily bipartite surface graph: one simply\nneeds to work with Z2 -coefficients. However, the height function formulation of the\ndimer model using volume weights does require a bipartite structure. It is unknown\nwhether a reformulation of the dimer model with the right number of parameters\nis possible in the general case.\n5.4. The dimer quantum field theory on bipartite surface graphs. Let us\nnow use these results to reformulate the dimer quantum field theory on bipartite\ngraphs. Let \u0393 \u2282 \u03a3 be a bipartite surface graph, and let X denote the induced\ncellular decomposition of \u03a3. Fix a dimer configuration D0 \u2208 D(\u0393, \u2202\u0393), a family\n\u03b3 = {\u03b3i } of oriented simple curves in \u0393 representing a basis in H1 (\u03a3, \u2202\u03a3; Z), and a\nchoice F0 of one face in each connected component of X.\n(1) To \u2202X, assign\nO\n\nZ(\u2202X) =\n\nW,\n\nf \u2208F\u2202 (X)\n\nwhere W is the complex vector space with basis {\u03b1n }n\u2208Z , and F\u2202 (X) denotes the set of faces of X adjacent to the boundary.\n(2) To X with weight system q = {qf }f \u2208F (X) \u222a {qi }1\u2264i\u2264b1 (\u03a3) , assign\n\u03b3\n(X; q) =\nZD\n0 ,F0\n\nX\n\n\u03b3\n(X; q | \u2202h) \u03b1(\u2202h) \u2208 Z(\u2202X),\nZD\n0 ,F0\n\n\u2202h\n\nwhere\n\u03b3\n(X; q | \u2202h) =\nZD\n0 ,F0\n\nX\n\n\u03b3\n(X,F0\n(h,a)\u2208HD\n0\n\nand \u03b1(\u2202h) =\n\nh(f )\n\nY\n\nqf\n\n| \u2202h) f \u2208F (X)\\F\u2202 (X)\n\nY\n\na(i)\n\nqi\n\n1\u2264i\u2264b1 (\u03a3)\n\nh(f )\n\u03b1h(f ) .\nf \u2208F\u2202 (X) qf\n\nN\n\nRecall the notation a(\u2202D) \u2208 Z(\u2202\u0393) of Section 4.2. The bijection D(\u0393, \u2202\u0393) \u2192\n\u03b3\n(X, F0 ) induces an inclusion j : Z(\u2202\u0393) \u0592\u2192 Z(\u2202X) such that\nHD\n0\nj(a(\u2202D)) =\n\nO\n\nf \u2208F\u2202 (X)\n\n\u03b1h\u03b3D,D\n\n0\n\n(f ) .\n\n\fDIMERS ON SURFACE GRAPHS AND SPIN STRUCTURES. II\n\nTherefore, using the proof of Proposition 5.4,\nX\nj(Z(\u0393; w)) =\nZ(\u0393; w | \u2202D) j(a(\u2202D))\n\n23\n\n\u2202D\n\n=\n\nX\n\n\u03b3\n(X; q | \u2202h) w(D0 )\nZD\n0 ,F0\n\n\u2202h\n\nY\n\nf \u2208F\u2202 (X)\n\n\u03b3\n(X; q),\n= w(D0 ) ZD\n0 ,F0\n\nh(f )\n\nqf\n\nO\n\n\u03b1h(f )\n\nf \u2208F\u2202 (X)\n\nwhere the weight system q is obtained from w by qf = w\u03b2 (\u2202f ) and qi = w\u03b2 (\u03b3i ).\nIn this setting, the gluing axiom makes sense only when the data \u03b2, D0 and \u03b3\nare compatible with the gluing map \u03c6. In such a case case, it holds by the equality\nabove and the results of Section 4.2.\nThe equivalence between the quantum field theories formulated in Section 4.3\nand in the present section should be regarded as a discrete version of the bosonfermion correspondence on compact Riemann surfaces (see [1]).\nReferences\n1. L. \u00c1lvarez-Gaum\u00e9, J.-B. Bost, G. Moore, P. Nelson and C. Vafa, Bosonization on higher genus\nRiemann surfaces, Comm. Math. Phys. 112, (1987) 503\u2013552.\n2. M. Atiyah, Topological quantum field theories, Inst. Hautes \u00c9tudes Sci. Publ. Math. 68,\n(1988) 175\u2013186.\n3. D. Cimasoni and N. Reshetikhin, Dimers on surface graphs and spin structures. I, to appear\nin Comm. Math. Phys.\n4. H. Cohn, R. Kenyon and J. Propp, A variational principle for domino tilings. J. Amer. Math.\nSoc. 14, (2001) 297\u2013346.\n5. D. Johnson, Spin structures and quadratic forms on surfaces. J. London Math. Soc. (2) 22,\n(1980) 365\u2013373.\n6. W. Kasteleyn, Dimer statistics and phase transitions. J. Mathematical Phys. 4, (1963) 287\u2013\n293.\n7. W. Kasteleyn, Graph Theory and Theoretical Physics (Academic Press, London 1967) pp.\n43\u2013110.\n8. R. Kenyon and A. Okounkov, Planar dimers and Harnack curves. Duke Math. J. 131, (2006)\n499\u2013524.\n9. R. Kenyon, A. Okounkov and S. Sheffield, Dimers and amoebae. Ann. of Math. (2) 163,\n(2006) 1019\u20131056.\n10. G. Kuperberg, An exploration of the permanent-determinant method. Electron. J. Combin.\n5, (1998) Research Paper 46, 34 pp. (electronic).\n11. A. Galluccio and M. Loebl, On the theory of Pfaffian orientations. I. Perfect matchings and\npermanents. Electron. J. Combin. 6, (1999) Research Paper 6, 18 pp. (electronic).\n12. B. McCoy and T.T. Wu, The two-dimensional Ising model (Harvard University Press, Cambridge Massachusetts 1973).\n13. G. Segal, The definition of conformal field theory, Differential geometrical methods in theoretical physics (Como, 1987), 165\u2013171, NATO Adv. Sci. Inst. Ser. C Math. Phys. Sci., 250,\nKluwer Acad. Publ., Dordrecht, 1988.\n14. G. Tesler, Matchings in graphs on non-orientable surfaces, J. Combin. Theory Ser. B 78\n(2000), no. 2, 198\u2013231.\nDepartment of Mathematics, UC Berkeley, 970 Evans Hall, Berkeley, CA 94720, USA\nE-mail address: cimasoni@math.berkeley.edu\nE-mail address: reshetik@math.berkeley.edu\n\n\f"}