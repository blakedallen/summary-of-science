{"id": "http://arxiv.org/abs/math/0207171v2", "guidislink": true, "updated": "2003-02-03T21:08:46Z", "updated_parsed": [2003, 2, 3, 21, 8, 46, 0, 34, 0], "published": "2002-07-19T20:40:09Z", "published_parsed": [2002, 7, 19, 20, 40, 9, 4, 200, 0], "title": "The Nash problem on arc families of singularities", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0207113%2Cmath%2F0207292%2Cmath%2F0207243%2Cmath%2F0207156%2Cmath%2F0207247%2Cmath%2F0207117%2Cmath%2F0207162%2Cmath%2F0207062%2Cmath%2F0207298%2Cmath%2F0207206%2Cmath%2F0207122%2Cmath%2F0207146%2Cmath%2F0207224%2Cmath%2F0207171%2Cmath%2F0207261%2Cmath%2F0207038%2Cmath%2F0207166%2Cmath%2F0207288%2Cmath%2F0207022%2Cmath%2F0207052%2Cmath%2F0207100%2Cmath%2F0207151%2Cmath%2F0207213%2Cmath%2F0207187%2Cmath%2F0207163%2Cmath%2F0207116%2Cmath%2F0207036%2Cmath%2F0207028%2Cmath%2F0207011%2Cmath%2F0207076%2Cmath%2F0207134%2Cmath%2F0207225%2Cmath%2F0207093%2Cmath%2F0207087%2Cmath%2F0207128%2Cmath%2F0207272%2Cmath%2F0207068%2Cmath%2F0207197%2Cmath%2F0207067%2Cmath%2F0207208%2Cmath%2F0207270%2Cmath%2F0207175%2Cmath%2F0207167%2Cmath%2F0207010%2Cmath%2F0207030%2Cmath%2F0207161%2Cmath%2F0207284%2Cmath%2F0207233%2Cmath%2F0207237%2Cmath%2F0207181%2Cmath%2F0207132%2Cmath%2F0207046%2Cmath%2F0207088%2Cmath%2F0309174%2Cmath%2F0309152%2Cmath%2F0309091%2Cmath%2F0309295%2Cmath%2F0309476%2Cmath%2F0309143%2Cmath%2F0309089%2Cmath%2F0309395%2Cmath%2F0309153%2Cmath%2F0309099%2Cmath%2F0309084%2Cmath%2F0309378%2Cmath%2F0309389%2Cmath%2F0309320%2Cmath%2F0309158%2Cmath%2F0309206%2Cmath%2F0309181%2Cmath%2F0309073%2Cmath%2F0309052%2Cmath%2F0309195%2Cmath%2F0309413%2Cmath%2F0309002%2Cmath%2F0309078%2Cmath%2F0309450%2Cmath%2F0309354%2Cmath%2F0309165%2Cmath%2F0309462%2Cmath%2F0309166%2Cmath%2F0309424%2Cmath%2F0309142%2Cmath%2F0309075%2Cmath%2F0309044%2Cmath%2F0309423%2Cmath%2F0309321%2Cmath%2F0309469%2Cmath%2F0309406%2Cmath%2F0309291%2Cmath%2F0309340%2Cmath%2F0309332%2Cmath%2F0309319%2Cmath%2F0309100%2Cmath%2F0309154%2Cmath%2F0309325%2Cmath%2F0309369%2Cmath%2F0309373%2Cmath%2F0309310%2Cmath%2F0309109%2Cmath%2F0309066&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Nash problem on arc families of singularities"}, "summary": "Nash proved that every irreducible component of the space of arcs through a\nsingularity corresponds to an exceptional divisor that occurs on every\nresolution. He asked if the converse also holds: does every such exceptional\ndivisor correspond to an arc family? We prove that the converse holds for toric\nsingularities but fails in general.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0207113%2Cmath%2F0207292%2Cmath%2F0207243%2Cmath%2F0207156%2Cmath%2F0207247%2Cmath%2F0207117%2Cmath%2F0207162%2Cmath%2F0207062%2Cmath%2F0207298%2Cmath%2F0207206%2Cmath%2F0207122%2Cmath%2F0207146%2Cmath%2F0207224%2Cmath%2F0207171%2Cmath%2F0207261%2Cmath%2F0207038%2Cmath%2F0207166%2Cmath%2F0207288%2Cmath%2F0207022%2Cmath%2F0207052%2Cmath%2F0207100%2Cmath%2F0207151%2Cmath%2F0207213%2Cmath%2F0207187%2Cmath%2F0207163%2Cmath%2F0207116%2Cmath%2F0207036%2Cmath%2F0207028%2Cmath%2F0207011%2Cmath%2F0207076%2Cmath%2F0207134%2Cmath%2F0207225%2Cmath%2F0207093%2Cmath%2F0207087%2Cmath%2F0207128%2Cmath%2F0207272%2Cmath%2F0207068%2Cmath%2F0207197%2Cmath%2F0207067%2Cmath%2F0207208%2Cmath%2F0207270%2Cmath%2F0207175%2Cmath%2F0207167%2Cmath%2F0207010%2Cmath%2F0207030%2Cmath%2F0207161%2Cmath%2F0207284%2Cmath%2F0207233%2Cmath%2F0207237%2Cmath%2F0207181%2Cmath%2F0207132%2Cmath%2F0207046%2Cmath%2F0207088%2Cmath%2F0309174%2Cmath%2F0309152%2Cmath%2F0309091%2Cmath%2F0309295%2Cmath%2F0309476%2Cmath%2F0309143%2Cmath%2F0309089%2Cmath%2F0309395%2Cmath%2F0309153%2Cmath%2F0309099%2Cmath%2F0309084%2Cmath%2F0309378%2Cmath%2F0309389%2Cmath%2F0309320%2Cmath%2F0309158%2Cmath%2F0309206%2Cmath%2F0309181%2Cmath%2F0309073%2Cmath%2F0309052%2Cmath%2F0309195%2Cmath%2F0309413%2Cmath%2F0309002%2Cmath%2F0309078%2Cmath%2F0309450%2Cmath%2F0309354%2Cmath%2F0309165%2Cmath%2F0309462%2Cmath%2F0309166%2Cmath%2F0309424%2Cmath%2F0309142%2Cmath%2F0309075%2Cmath%2F0309044%2Cmath%2F0309423%2Cmath%2F0309321%2Cmath%2F0309469%2Cmath%2F0309406%2Cmath%2F0309291%2Cmath%2F0309340%2Cmath%2F0309332%2Cmath%2F0309319%2Cmath%2F0309100%2Cmath%2F0309154%2Cmath%2F0309325%2Cmath%2F0309369%2Cmath%2F0309373%2Cmath%2F0309310%2Cmath%2F0309109%2Cmath%2F0309066&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Nash proved that every irreducible component of the space of arcs through a\nsingularity corresponds to an exceptional divisor that occurs on every\nresolution. He asked if the converse also holds: does every such exceptional\ndivisor correspond to an arc family? We prove that the converse holds for toric\nsingularities but fails in general."}, "authors": ["Shihoko Ishii", "J\u00e1nos Koll\u00e1r"], "author_detail": {"name": "J\u00e1nos Koll\u00e1r"}, "author": "J\u00e1nos Koll\u00e1r", "arxiv_comment": "17 pages", "links": [{"href": "http://arxiv.org/abs/math/0207171v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0207171v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "14J17, 14M25, 14J10", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0207171v2", "affiliation": "Princeton University", "arxiv_url": "http://arxiv.org/abs/math/0207171v2", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0207171v2 [math.AG] 3 Feb 2003\n\nTHE NASH PROBLEM ON ARC FAMILIES OF\nSINGULARITIES\nSHIHOKO ISHII AND J\u00c1NOS KOLL\u00c1R\nAbstract. Nash proved that every irreducible component of the\nspace of arcs through a singularity corresponds to an exceptional\ndivisor that appears on every resolution. He asked if the converse\nalso holds: does every such exceptional divisor correspond to an\narc family? We prove that the converse holds for toric singularities\nbut fails in general.\n\n1. Introduction\nIn a 1968 preprint, later published as [21], Nash introduced arc spaces\nand jet schemes for algebraic and analytic varieties. The problems\nraised by Nash were studied by Bouvier, Gonzalez-Sprinberg, Hickel,\nLejeune-Jalabert, Nobile, Reguera-Lopez and others, see [3, 10, 11, 16,\n17, 18, 22, 23].\nThe study of these spaces was further developed by Kontsevich,\nDenef and Loeser as the theory of motivic integration, see [15, 7]. Further interesting applications of jet spaces are given by Musta\u0163\u01ce [20].\nThe main subject of the paper of Nash is the map from the set of\nirreducible components of the space of arcs through singular points\n(families of arcs in the original terminology of Nash) to the set of\nessential components of a resolution of singularities. Roughly speaking,\nthese are the irreducible components of the exceptional set of a given\nresolution that appear on every possible resolution, see Definition 2.3.\nWe call this map the Nash map, see Theorem 2.15 for a precise\ndefinition. The Nash map is always injective and Nash asked if it is\nalways bijective. This problem remained open even for 2-dimensional\nsingularities, though many cases were settled in [23].\nIn this paper we prove that the Nash map is bijective for toric singularities in any dimension, see Theorem 3.16. On the other hand we\nalso show that the Nash map is not bijective in general. For instance,\nthe 4-dimensional hypersurface singularity\nx31 + x32 + x33 + x34 + x65 = 0\n1\n\n\f2\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nhas only 1 irreducible family of arcs but 2 essential divisors over any\nalgebraically closed field of characteristic 6= 2, 3. See Example 4.5.\nIn \u00a72 we define the Nash map and show its injectivity. This is essentially taken from [21] with some scheme theoretic details filled in. The\nNash map for toric singularities is studied in \u00a73. Counter examples are\ngiven in \u00a74.\nIn this paper, the ground field k is an algebraically closed field of\narbitrary characteristic. A k-scheme is not necessarily of finite type\nunless we state otherwise. A variety means a separated, irreducible\nand reduced scheme of finite type over k. Every variety X that we\nconsider is assumed to have a resolution of singularities f : Y \u2212\u2192 X\nwhich is an isomorphism over the smooth locus and whose exceptional\nset is purely one codimensional. Without this or similar assumptions\nthe definition of essential divisors and components would not make\nsense. The existence of resolutions is known in characteristic zero and\nfor toric varieties in any characteristic.\nThe first author would like to thank Professor G\u00e9rard GonzalezSprinberg who generated her interest in this problem, provided the\ninformation on his joint paper [4] and gave constructive comments to\nimprove this paper. We thank the referee for useful comments and\ncorrections. Part of the work was completed during the second author's stay at the Isaac Newton Institute for Mathematical Sciences,\nCambridge. The first author is partially supported by Grant-in-Aid\nfor Scientific Research, Japan. Partial financial support for the second\nauthor was provided by the NSF under grant numbers DMS-9970855\nand DMS02-00883.\n\n2. The space of arcs and the Nash problem\nDefinition 2.1. Let X be a variety, g : X1 \u2212\u2192 X a proper birational morphism from a normal variety X1 and E \u2282 X1 an irreducible\nexceptional divisor of g. Let f : X2 \u2212\u2192 X be another proper birational morphism from a normal variety X2 . The birational map\nf \u22121 \u25e6 g : X1 99K X2 is defined on a (nonempty) open subset E 0 of\nE. The closure of (f \u22121 \u25e6 g)(E 0 ) is well defined. It is called the center\nof E on X2 .\nWe say that E appears in f (or in X2 ), if the center of E on X2 is also\na divisor. In this case the birational map f \u22121 \u25e6 g : X1 99K X2 is a local\nisomorphism at the generic point of E and we denote the birational\ntransform of E on X2 again by E. For our purposes E \u2282 X1 is identified\nwith E \u2282 X2 . (Strictly speaking, we should be talking about the\n\n\fTHE NASH PROBLEM\n\n3\n\ncorresponding divisorial valuation instead.) Such an equivalence class\nis called an exceptional divisor over X.\nDefinition 2.2. Let X be a variety over k. In this paper, by a resolution of the singularities of X we mean a proper, birational morphism\nf : Y \u2212\u2192 X with Y non-singular such that Y \\ f \u22121 (Sing X) \u2212\u2192\nX \\ Sing X is an isomorphism.\nA resolution f : Y \u2212\u2192 X is called a divisorial resolution of X if the\nexceptional set is of pure codimension one.\nIf X is factorial (or at least Q-factorial) then every resolution is\ndivisorial.\nDefinition 2.3. An exceptional divisor E over X is called an essential\ndivisor over X if for every resolution f : Y \u2212\u2192 X the center of E on\nY is an irreducible component of f \u22121 (Sing X).\nAn exceptional divisor E over X is called a divisorially essential\ndivisor over X if for every divisorial resolution f : Y \u2212\u2192 X the center\nof E on Y is a divisor, (and hence also an irreducible component of\nf \u22121 (Sing X)).\nFor a given resolution f : Y \u2212\u2192 X, the set\nE = EY /X =\n\n(\n\nirreducible components of f \u22121 (Sing X)\nwhich are centers of essential divisors over X\n\n)\n\ncorresponds bijectively to the set of all essential divisors over X.\nTherefore we call an element of E an essential component on Y .\nSimilarly, we can talk about divisorially essential components on Y .\nIt is clear that an essential divisor is also a divisorially essential divisor. We do not know any examples when the two notions are different.\nIn \u00a73 we will see that they coincide for toric singularities.\nExample 2.4. Let (X, x) be a normal 2-dimensional singularity. Then\nthe set of the divisorially essential divisors over X coincides with the set\nof the exceptional curves appearing on the minimal resolution X \u2032 \u2212\u2192\nX. These are also the essential components on X \u2032 .\nExample 2.5. Proposition 4 of [1] asserts that if E is an exceptional\ndivisor of a birational morphism Y \u2212\u2192 Y \u2032 with Y \u2032 smooth then E is\nruled, that is, E is birational to F \u00d7P1 for some variety F . As noted by\nNash, this implies that any nonruled exceptional divisor of a resolution\nY \u2212\u2192 X is essential.\nExample 2.6. Let (X, x) be a canonical singularity which admits a\ncrepant divisorial resolution. A quite large group of such singularities\nis known (see, for example, [6] and the references there). Then the\nset of the essential divisors over X and also the set of the divisorially\n\n\f4\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nessential divisors over X coincide with the set of the crepant exceptional\ndivisors. Indeed, a divisorial essential divisor should be one of the\ncrepant exceptional divisors because of the existence of a divisorial\ncrepant resolution. On the other hand, a crepant exceptional divisor\ncannot be contracted on a non-singular model of X, because if it could\nbe contracted, the discrepancy of the crepant component would have\nto be positive. This shows that every crepant divisor is an essential\ncomponent.\nDefinition 2.7. Let X be a scheme of finite type over k and K \u2283 k a\nfield extension. A morphism Spec K[t]/(tm+1 ) \u2212\u2192 X is called an m-jet\nof X and Spec K[[t]] \u2212\u2192 X is called an arc of X. We denote the closed\npoint of Spec K[[t]] by 0 and the generic point by \u03b7.\n2.8. Let X be a scheme of finite type over k. Let Sch/k be the category of k-schemes and Set the category of sets. Define a contravariant\nfunctor Fm : Sch/k \u2212\u2192 Set by\nFm (Y ) = Homk (Y \u00d7Spec k Spec k[t]/(tm+1 ), X).\nThen, Fm is representable by a scheme Xm of finite type over k, that\nis\nHomk (Y, Xm ) \u2243 Homk (Y \u00d7Spec k Spec k[t]/(tm+1 ), X).\nThis Xm is called the scheme of m-jets of X. The canonical surjection\nk[t]/(tm+1 ) \u2212\u2192 k[t]/(tm ) induces a morphism \u03c6m : Xm \u2212\u2192 Xm\u22121 .\nDefine \u03c0m = \u03c61 \u25e6 * * * \u25e6 \u03c6m : Xm \u2212\u2192 X. A point x \u2208 Xm gives an\nm-jet \u03b1x : Spec K[t]/(tm+1 ) \u2212\u2192 X and \u03c0m (x) = \u03b1x (0), where K is the\nresidue field at x.\nLet X\u221e = \u2190\nlim\n\u2212 m Xm and call it the space of arcs of X. X\u221e is not\nof finite type over k but it is a scheme, see [7]. Denote the canonical\nprojection X\u221e \u2212\u2192 Xm by \u03b7m and the composite \u03c0m \u25e6 \u03b7m by \u03c0. A point\nx \u2208 X\u221e gives an arc \u03b1x : Spec K[[t]] \u2212\u2192 X and \u03c0(x) = \u03b1x (0), where\nK is the residue field at x.\nUsing the representability of Fm we obtain the following universal\nproperty of X\u221e :\nProposition 2.9. Let X be a scheme of finite type over k. Then\nb Spec k Spec k[[t]], X)\nHomk (Y, X\u221e ) \u2243 Homk (Y \u00d7\n\nb Spec k Spec k[[t]] means the forfor an arbitrary k-scheme Y , where Y \u00d7\nmal completion of Y \u00d7Spec k Spec k[[t]] along the subscheme Y \u00d7Spec k {0}.\n\nCorollary 2.10. There is a universal family of arcs\nb Spec k Spec k[[t]] \u2212\u2192 X.\nX\u221e \u00d7\n\n\fTHE NASH PROBLEM\n\n5\n\nDefinition 2.11. Let X be a k-variety with singular locus Sing X \u2282 X.\nEvery point x of the inverse image \u03c0 \u22121 (Sing X) \u2282 X\u221e corresponds to\nan arc \u03b1x : Spec K[[t]] \u2212\u2192 X such that \u03b1x (0) \u2208 Sing X, where K is\nthe residue field at x. \u03c0 \u22121 (Sing X) is the space of arcs through Sing X.\nDecompose \u03c0 \u22121 (Sing X) into its irreducible components\n\u03c0 \u22121 (Sing X) = (\n\n[\n\ni\u2208I\n\nCi ) \u222a (\n\n[\n\nCj\u2032 ),\n\nj\u2208J\n\nwhere the Ci 's are the components with a point x corresponding to an\narc \u03b1x such that \u03b1x (\u03b7) 6\u2208 Sing X, while the Cj\u2032 's are the components\nwithout such points. We call the Ci 's the good components of the space\nof arcs through Sing X.\nThe notion of \"arc families\" in [21] is the same as the above concept\nof good components.\nThe next lemma shows that in characteristic zero every irreducible\ncomponent of \u03c0 \u22121 (Sing X) \u2282 X\u221e is good. This can be viewed as a\nstrong form of Kolchin's irreducibility theorem [12, Chap.IV,Prop.10].\nSee also [9]. It is also interesting to compare this with the results of\n[20] according to which the jet spaces Xm are usually reducible.\nLemma 2.12. Let k be a field of characteristic zero and X a k-variety.\nThen every arc through Sing X is a specialization of an arc through\nSing X whose generic point maps into X \\ Sing X.\nProof. We may assume that X is affine. Pick any arc \u03c6 : Spec k \u2032 [[s]] \u2212\u2192\nX such that \u03c6(0) \u2208 Sing X. Let Y be the Zariski closure of the image\nof \u03c6. Then OY is an integral domain and \u03c6 corresponds to an injection\nOY \u2212\u2192 k \u2032 [[s]], where we can take k \u2032 to be algebraically closed. We are\ndone if Y 6\u2282 Sing X. Otherwise we write \u03c6 as a specialization in two\nsteps.\nFirst we prove that \u03c6 is a specialization of an arc \u03a6 : Spec K[[s]] \u2212\u2192\nY \u2282 X such that \u03a6(0) is the generic point of Y .\nWe have an embedding k \u2032 [[s]] \u0592\u2192 k \u2032 [[S, T ]] which sends s to S + T .\nIt is easy to check that the composite\nk \u2032 [[s]] \u0592\u2192 k \u2032 [[S, T ]] \u2212\u2192 k \u2032 [[S, T ]]/(T ) \u223c\n= k \u2032 [[S]]\nis an isomorphism. Thus we obtain \u03a6 as the composite\n\u03c6\n\nOY \u2212\u2192 k \u2032 [[s]] \u0592\u2192 k \u2032 [[S, T ]] \u0592\u2192 k \u2032 ((T ))[[S]].\nSet K = k \u2032 ((T 1/n : n = 1, 2, . . . )), the algebraic closure of k \u2032 ((T )).\nThe closed point of Spec K[[S]] maps to the ideal \u03a6\u22121 (S), but the pull\nback of (S) to k \u2032 [[s]] is already the zero ideal. Thus the closed point of\nSpec K[[S]] maps to the generic point of Y .\n\n\f6\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nRepeatedly cutting with hypersurfaces containing Y we obtain a subvariety Y \u2282 Z \u2282 X such that dim Z = dim Y + 1 and X is smooth\nalong the generic points of Z. Let n : Z\u0304 \u2212\u2192 Z be the normalization\nand \u0232 \u2282 Z\u0304 the preimage of Y with reduced scheme structure. \u0232 \u2212\u2192 Y\nis finite, surjective, and so generically \u00e9tale in characteristic zero. Thus\nthe arc \u03a6 : Spec K[[S]] \u2212\u2192 Y can be lifted to \u03a6\u0304 : Spec K[[S]] \u2212\u2192 \u0232 .\nZ\u0304 is normal, so smooth along the generic point of \u0232 . Thus \u03a6\u0304 is the\nspecialization of an arc through \u0232 whose generic point maps to the\ngeneric point of Z\u0304. Projecting to Z we obtain \u03a6 and hence \u03c6 as the\nspecialization of an arc through Sing X whose generic point maps into\nX \\ Sing X.\n\u0003\nExample 2.13. Let k have characteristic p and consider the surface\nS = (xp = y p z) \u2282 A3 with singular locus Y = (x = y = 0). The\nnormalization is S\u0304 \u223c\n= A2 with (u, v) 7\u2192 (uv, v, up). The preimage of Y\nis \u0232 = (v = 0) and \u0232 \u2212\u2192 Y is purely inseparable. Thus a smooth arc\nin Y can not be lifted to \u0232 and it is also not the specialization of an\narc through Y whose generic point maps into S \\ Sing S. In this case\n\u03c0 \u22121 (Sing S) \u2282 S\u221e has a component which is not good.\nLemma 2.14. Let f : Y \u2212\u2192 X be a resolution of the singularities\nof X and E1 , . . . , Er the irreducible components of exceptional sets on\nY . For a good component Ci , let Cio denote the open subset of Ci\nconsisting of arcs \u03b1x : Spec K[[t]] \u2212\u2192 X such that \u03b1x (\u03b7) 6\u2208 Sing X.\nThen, for every x \u2208 Cio the arc \u03b1x can be uniquely lifted to an arc\n\u03b1\u0303x : Spec K[[t]] \u2212\u2192 Y .\nProof. As f is isomorphic outside of Sing X and \u03b1x (\u03b7) 6\u2208 Sing X, we\nobtain the commutative diagram\nSpec K((t)) \u2212\u2192\n\u2193\n\u03b1x\nSpec K[[t]] \u2212\u2192\n\nY\n\u2193f\nX.\n\nSince f is proper, there exists a unique morphism \u03b1\u0303x : Spec K[[t]] \u2212\u2192\nY such that f \u25e6 \u03b1\u0303x = \u03b1x by the valuative criterion of properness. \u0003\nThis \u03b1\u0303x is called the lifting of \u03b1x . Now we have a map\n\u03c6 : points of (\n\n[\ni\n\nCio ) \u2212\u2192 points of (\n\n[\n\nEl )\n\nl\n\ngiven by x 7\u2192 \u03b1\u0303x (0). We emphasize that this map is not a continuous\nmap of schemes. In fact, the image of an irreducible subset is not\nnecessarily irreducible.\n\n\fTHE NASH PROBLEM\n\n7\n\nTheorem 2.15 (Nash [21]). Let X be a k-variety and f : Y \u2212\u2192 X a\nresolution of singularities. Let {Ci : i \u2208 I} be the good components of\nthe space of arcs through Sing X and let zi denote the generic point of\nCi . Then:\n(i) \u03c6(zi ) is the generic point of an exceptional component Eli \u2282 Y\nfor some li .\n(ii) For every i \u2208 I, Eli is an essential component on Y .\n(iii) The resulting Nash map\n\uf8f1\n\uf8f4\n\uf8f2\n\ngood components\nof the space of arcs\n\uf8f4\n\uf8f3\nthrough Sing X\n\n\uf8fc\n\uf8f4\n\uf8fd\n\n\uf8f1\n\uf8f4\n\uf8f2\n\nessential\nN\n\u2212\u2192 components\n\uf8f4\n\uf8f4\n\uf8fe\n\uf8f3\non Y\n\n\uf8fc\n\uf8f4\n\uf8fd\n\n\uf8f1\n\uf8f4\n\uf8f2\n\nessential\ndivisors\n\u2243\n\uf8f4\n\uf8f4\n\uf8f3 over X\n\uf8fe\n\n\uf8fc\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8fe\n\ngiven by Ci 7\u2192 Eli is injective. In particular, there are only\nfinitely many good components of the space of arcs through Sing X.\n\nProof. The resolution f : Y \u2212\u2192 X induces a morphism f\u221e : Y\u221e \u2212\u2192\nX\u221e of schemes. Let \u03c0 Y : Y\u221e \u2212\u2192 Y be the canonical projection. As\nY is non-singular, (\u03c0 Y )\u22121 (El ) is irreducible for every l. Denote by\n(\u03c0 Y )\u22121 (El )o the open subset of (\u03c0 Y )\u22121 (El ) consisting of the points y\nS\ncorresponding to arcs \u03b2y : Spec K[[t]] \u2212\u2192 Y such that \u03b2y (\u03b7) 6\u2208 l El .\nS\nS\n\u2032\n: rl=1 (\u03c0 Y )\u22121 (El )o \u2212\u2192 i\u2208I Cio . For a point\nBy restriction f\u221e gives f\u221e\nx \u2208 Cio , let \u03b1x : Spec K[[t]] \u2212\u2192 X be the corresponding arc, where\nK is the residue field at x. The lifting \u03b1\u0303x : Spec K[[t]] \u2212\u2192 Y of \u03b1x\nobtained in Lemma 2.14 determines a K-valued point \u03b2 : Spec K \u2212\u2192\n\u2032\nis\nY\u221e . Denote the image of \u03b2 by y, then f\u221e (y) = x. Therefore, f\u221e\nsurjective. Hence, for each i \u2208 I there is 1 \u2264 li \u2264 r such that the\ngeneric point yli of (\u03c0 Y )\u22121 (Eli )o is mapped to the generic point zi of\nCio . Let \u03b1\u0303zi be the lifting of the arc \u03b1zi corresponding to zi and let \u03b2yli\nbe the arc of Y corresponding to yli . Then \u03b2yli = \u03b1\u0303zi . This is proved\nas follows: Let L and K be the residue fields at yli and zi , respectively\nand g : Spec L[[t]] \u2212\u2192 Spec K[[t]] be the canonical morphism induced\nfrom the inclusion K \u2212\u2192 L. Then \u03b2yli = \u03b1\u0303zi \u25e6 g. From this, we\nhave K = L and therefore \u03b2yli = \u03b1\u0303zi . Note that \u03b2yli (0) = \u03c0 Y (yli ),\nwhich is the generic point of Eli . To finish the proof of (i), just recall\n\u03c6(zi ) = \u03b1\u0303zi (0) = \u03b2yli (0).\nNext, we can see that the map Ci 7\u2192 Eli is injective. Indeed, if\n\u2032\n\u2032\nEli = Elj for i 6= j, then zi = f\u221e\n(yli ) = f\u221e\n(ylj ) = zj , a contradiction.\nTo prove that the {Eli : i \u2208 I} are essential components on Y , let\nY \u2032 \u2212\u2192 X be another resolution and \u1ef8 \u2212\u2192 X a divisorial resolution\nwhich factors through both Y and Y \u2032 . Let El\u2032i \u2282 Y \u2032 and \u1ebcli \u2282 \u1ef8 be\nthe irreducible components of the exceptional sets corresponding to Ci .\nThen, we can see that Eli and El\u2032i are the image of \u1ebcli . This shows\n\n\f8\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nthat \u1ebcli is an essential divisor over X and therefore Eli is an essential\ncomponent on Y .\n\u0003\nNash poses the following problem in his paper [21, p.36].\nProblem 2.16. Is the Nash map bijective?\n3. The Nash problem for toric singularities\n3.1. We use the notation and terminology of [8]. Let M be the free\nabelian group Zn (n \u2265 2) and N its dual HomZ (M, Z). We denote\nM \u2297Z R and N \u2297Z R by MR and NR , respectively. The canonical\npairing h , i : N \u00d7 M \u2212\u2192 Z extends to h , i : NR \u00d7 MR \u2212\u2192 R.\nFor a finite fan \u2206 in NR , the corresponding toric variety is denoted\nby X = X(\u2206). For the primitive vector v in a one-dimensional cone\n\u03c4 \u2208 \u2206, denote the invariant divisor orb(\u03c4 ) in X by Dv .\nFor a cone \u03c4 \u2208 \u2206 denote by U\u03c4 the invariant affine open subset which\ncontains orb \u03c4 as the unique closed orbit. A cone \u03c4 is called regular or\nnon-singular, if its generators can be extended to a basis of N. A cone\nis called singular, if it is not regular. Note that a cone \u03c4 is regular, if\nand only if U\u03c4 is non-singular. A cone generated by v1 , . . . , vr \u2208 N is\ndenoted by hv1 , . . . , vr i.\nWe can write k[M] as k[xu ]u\u2208M , where we use the shorthand xu =\nxu1 1 xu2 2 * * * xunn for u = (u1 , . . . , un ) \u2208 M.\nDefinition 3.2. An exceptional divisor E over a toric variety X is\ncalled a toric divisorially essential divisor over X if its center is a\ndivisor on every equivariant divisorial resolution of the singularities of\nX.\nThe following is obvious by the definition.\nProposition 3.3. For a toric variety X a divisorially essential divisor\nover X is a toric divisorially essential divisor over X.\nAt this moment the converse of the above proposition is not clear.\nBut later on, as a corollary of our theorem we obtain the converse.\n3.4. In what follows, we consider an affine toric variety X = X(\u2206),\ntherefore the fan \u2206 consists of all faces of a cone \u03c3. Let \u03c3 = he1 , . . . , es i,\nwhere the right hand side means the cone generated by primitive vectors e1 , . . . , es . Let T be the open orbit in X. Let W be the singular\nS\nS\nlocus of X, then W = \u03c4 :singular orb(\u03c4 ). Let S = N \u2229 ( \u03c4 :singular \u03c4 o ),\nwhere o means the relative interior.\nProposition 3.5. If Dv is a toric divisorially essential divisor for v \u2208\nN \u2229 \u03c3, then v belongs to S.\n\n\fTHE NASH PROBLEM\n\n9\n\nProof. If Dv is a toric divisorially essential divisor, then the image of\nS\nDv must be in the singular locus W = \u03c4 :singular orb(\u03c4 ). Therefore\nv \u2208 S.\n\u0003\n3.6 (Sketch of the proof). We prove that all maps in the following\ndiagram are injective and that composite of all maps is the identity.\nThis shows that all maps are bijective.\nF\n\n(\n\n\u2283\n\n(\n\n{minimal elements in S} \u2212\u2192\n\nG\u2191\n\uf8f1\n\uf8f4\n\uf8f2\n\n\uf8fc\n\ntoric divisorially \uf8f4\n\uf8fd\nessential divisors\n\uf8f4\n\uf8f4\n\uf8fe\n\uf8f3\nover X\n\ngood components of\narcs through Sing X\n\u2193N\n(\n)\nessential divisors\nover X\n\u2229\ndivisorially essential\ndivisors over X\n\n)\n\n)\n\nFirst we define an order in N \u2229 \u03c3.\nDefinition 3.7. For two elements v, v \u2032 \u2208 N \u2229 \u03c3 we define v \u2264 v \u2032 , if\nv \u2032 \u2208 v + \u03c3.\nFor a subset A \u2282 N \u2229 \u03c3, a \u2208 A is called minimal in A, if there is no\nother element a\u2032 \u2208 A such that a\u2032 \u2264 a.\nNote that v \u2264 v \u2032 if and only if hv, ui \u2264 hv \u2032 , ui for every u \u2208 M \u2229 \u03c3 \u2228 .\nIt is clear that \u2264 is a partial order, i.e.,\n(1) v \u2264 v,\n(2) if v \u2264 v \u2032 and v \u2032 \u2264 v, then v = v \u2032 ,\n(3) if v \u2264 v \u2032 and v \u2032 \u2264 v \u2032\u2032 , then v \u2264 v \u2032\u2032 .\nDefinition 3.8. For an arc \u03b1 : Spec K[[t]] \u2212\u2192 X such that \u03b1(\u03b7) \u2208 T ,\ndefine v\u03b1 \u2208 N \u2229 \u03c3 as follows:\nBy the condition of \u03b1, we have a commutative diagram of ring homomorphisms:\n\u03b1\u2217\n\nk[M \u2229 \u03c3 \u2228 ] \u2212\u2192 K[[t]]\n\u2229\n\u2229\n\u03b1\u2217\n\u2212\u2192 K((t)).\nk[M]\nThe map M \u2212\u2192 Z, u 7\u2192 ord(\u03b1\u2217 xu ) is a group homomorphism, therefore it determines an element v\u03b1 \u2208 N such that hv\u03b1 , ui = ord(\u03b1\u2217 xu ) for\nevery u \u2208 M. By the commutative diagram it follows that v\u03b1 |M \u2229\u03c3\u2228 \u2265 0,\nhence v\u03b1 \u2208 N \u2229 \u03c3.\n\n\f10\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nProposition 3.9.\n(i) Let \u03b1 be an arc of X such that \u03b1(\u03b7) \u2208 T\nand \u03c4 a face of \u03c3. Then \u03b1(0) \u2208 orb(\u03c4 ), if and only if v\u03b1 \u2208 \u03c4 o .\nIn particular, \u03b1(0) \u2208 T , if and only if v\u03b1 = 0.\n(ii) Let \u03a3 be a subdivision of the fan \u2206 and f : Y \u2212\u2192 X be the\ntoric morphism corresponding to this subdivision. Then, an arc\n\u03b1 of X such that \u03b1(\u03b7) \u2208 T is lifted to an arc \u03b1\u0303 of Y . Let \u03c4 \u2208 \u03a3.\nThen, \u03b1\u0303(0) \u2208 orb(\u03c4 ), if and only if v\u03b1 = v\u03b1\u0303 \u2208 \u03c4 o .\nProof. The first statement of (ii) follows immediately from the properness of f and the condition \u03b1(\u03b7) \u2208 T . The second statement of (ii)\nfollows from the result (i) with replacing X by U\u03c4 .\nFor the proof of (i) it is sufficient to prove that v\u03b1 \u2208 \u03c4 if and only if\nS\nS\n\u03b1(0) \u2208 U\u03c4 , because \u03c4 o = \u03c4 \\ \u03c4 \u2032 \u03c4 \u2032 and orb(\u03c4 ) = U\u03c4 \\ \u03c4 \u2032 U\u03c4 \u2032 , where the\nunions are over all the proper faces \u03c4 \u2032 of \u03c4 . The condition v\u03b1 \u2208 \u03c4 is\nequivalent to hv\u03b1 , ui \u2265 0 for all u \u2208 M \u2229 \u03c4 \u2228 . And this holds if and only\nif the ring homomorphism \u03b1\u2217 : k[M \u2229 \u03c3 \u2228 ] \u2212\u2192 k[[t]] can be extended to\nk[M \u2229 \u03c4 \u2228 ] \u2212\u2192 k[[t]], which is equivalent to that \u03b1 factors through U\u03c4 .\nAs U\u03c4 contains T , this is equivalent to that \u03b1(0) \u2208 U\u03c4 .\n\u0003\nProposition 3.10. For every point v \u2208 S, there exists an arc \u03b1 :\nSpec k[[t]] \u2212\u2192 X such that \u03b1(0) \u2208 W , \u03b1(\u03b7) \u2208 T and v = v\u03b1 .\nProof. Define the ring homomorphism \u03b1\u2217 : k[M] \u2212\u2192 k((t)) by \u03b1\u2217 (xu ) =\nthv,ui . Then we have the following commutative diagram:\n\u03b1\u2217\n\nk[M \u2229 \u03c3 \u2228 ] \u2212\u2192 k[[t]]\n\u2229\n\u2229\n\u03b1\u2217\n\u2212\u2192 k((t)),\nk[M]\nbecause hv, ui \u2265 0 for every u \u2208 M \u2229 \u03c3 \u2228 . Let \u03b1 : Spec k[[t]] \u2212\u2192 X\nbe the morphism corresponding to \u03b1\u2217 , then v = v\u03b1 and we obtain\n\u03b1(\u03b7) \u2208 T by the diagram. On the other hand, as v \u2208 S, there is a\nsingular face \u03c4 < \u03c3 such that v = v\u03b1 \u2208 N \u2229 \u03c4 0 . By Proposition 3.9\n\u03b1(0) \u2208 orb(\u03c4 ) \u2282 W .\n\u0003\nProposition 3.11 (Upper semi-continuity). Let C be a k-scheme, \u03b1 :\nb Spec k Spec k[[t]] \u2212\u2192 X a family of arcs on X and \u03b1c : Spec k(c)[[t]] \u2212\u2192\nC\u00d7\nX the arc induced from \u03b1 for each point c \u2208 Y . Here k(c) is the\nresidue field at c. Assume \u03b1c (\u03b7) \u2208 T for every c \u2208 C. Then the\nmap C \u2212\u2192 N \u2229 \u03c3, c 7\u2192 v\u03b1c is upper semi-continuous, i.e., for every\nv \u2208 N \u2229 \u03c3 the subset Uv := {c \u2208 C | v\u03b1c \u2264 v} is open in C. In particular, if there is a point z \u2208 C such that v\u03b1z is minimal in S, then there\nis a non-empty open subset U \u2282 C such that v\u03b1c = v\u03b1z holds for every\nc \u2208 U.\n\n\fTHE NASH PROBLEM\n\n11\n\nProof. It is sufficient to prove the assertion in the affine case C =\nSpec A. Let \u03b1\u2217 : k[M \u2229 \u03c3 \u2228 ] \u2212\u2192 A[[t]] be the ring homomorphism\ncorresponding to \u03b1. Let \u03b1\u2217 (xu ) be au0 + au1 t + au2 t2 + . . ., where aui \u2208 A\nfor i \u2265 0. By the definition of Uv , a point c \u2208 C belongs to Uv , if and\nonly if hv\u03b1c , ui \u2264 hv, ui for every u \u2208 M \u2229 \u03c3 \u2228 . This is equivalent to\nthat for every element u of generating system of M \u2229 \u03c3 \u2228 there exists\ni \u2264 hv, ui such that aui (c) 6= 0. Now, we see that Uv is a finite union of\nthe complements of zero locus of functions on C.\n\u0003\n3.12. Let {Ci : i \u2208 I} be the good components of the space of arcs\nthrough W . For each component Ci \u2282 X\u221e , there exists a correspondb Spec k Spec k[[t]] \u2212\u2192 X of arcs by Corollary 2.10.\ning family \u03b1i : Ci \u00d7\n\nLemma 3.13. Under the above notation, for a minimal element v \u2208 S\nthere are a good component Ci and a non-empty open subset U \u2282 Ci\nsuch that v\u03b1ic = v for every c \u2208 U, where \u03b1ic : Spec k(c)[[t]] \u2212\u2192 X is\nth arc induced from \u03b1i .\nFor a minimal element v \u2208 S, take one of these components Ci and\nF\ndefine F (v) := Ci . Then the map {minimal elements in S} \u2212\u2192 {Ci }\nis injective.\nProof. For a given minimal element v \u2208 S there is an arc \u03b1 : Spec k[[t]] \u2212\u2192\nX such that \u03b1(0) \u2208 W , \u03b1(\u03b7) \u2208 T and v\u03b1 = v by Proposition 3.10.\nThen, by Definition 2.11, there exist a good component Ci and its kvalued point z such that \u03b1 = \u03b1iz . As \u03b1i (Ci \u00d7Spec k {0}) \u2282 W and\n\u03b1iz (\u03b7) \u2208 T , there exists a non-empty open subset V \u2282 Ci such that\nboth the conditions \u03b1i (V \u00d7Spec k {0}) \u2282 W and \u03b1ic (\u03b7) \u2208 T for every\nc \u2208 V hold. Then, by Proposition 3.11, there exists a non-empty open\nsubset U \u2282 V such that v\u03b1ic = v.\nThe second assertion is obvious from the first statement.\n\u0003\nLemma 3.14. Let N : {Ci : i \u2208 I} \u2212\u2192 {essential divisors}, Ci 7\u2192 Eli\nbe the Nash map in Theorem 2.15. Then the composite\nN \u25e6 F : {minimal elements in S} \u2212\u2192 {essential divisors}\nsatisfies N \u25e6 F (v) = Dv .\n\nProof. By Lemma 3.13, the generic point z of F (v) corresponds to an\narc \u03b1 : Spec K[[t]] \u2212\u2192 X such that v\u03b1 = v. Let \u03b1\u0303 be the lifting of\n\u03b1 as an arc of a toric divisorial resolution Y . By the definition of\nN , N \u25e6 F (v) is an exceptional divisor containing \u03b1\u0303(0) as the generic\npoint. By Proposition 3.9, the exceptional divisor orb(\u03c4 ) containing\n\u03b1\u0303(0) satisfies v = v\u03b1 = v\u03b1\u0303 \u2208 \u03c4 o . Therefore this divisor is Dv .\n\u0003\nWe prove the following by using the idea of the proof of [4, Th\u00e9or\u00e8me\n1.10].\n\n\f12\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nLemma 3.15. Consider the map\nG : {toric divisorially essential divisors over X} \u2212\u2192 S\ngiven by G(Dv ) = v. Then, this map is injective and its image is\ncontained in the set of minimal elements of S.\n\u0003\nProof. The injectivity is clear by the definition of the map. For the\nsecond assertion it is sufficient to prove that if a primitive vector v \u2208 S\nis not minimal then Dv is not toric divisorially essential. To do this, we\nconstruct a regular subdivision \u03a3 of \u03c3 such that the map X(\u03a3) \u2212\u2192 X\nis a divisorial resolution of X, and in which vR\u22650 does not appear as\na one-dimensional cone.\nIf v \u2208 S is not minimal, then v can be written as v = n1 + n2 ,\nwhere n1 \u2208 S and n2 \u2208 N \u2229 \u03c3 \\ {0}. Then, we can reduce it into\ntwo cases: (1) n1 , n2 \u2208 S, (2) n1 \u2208 S and n2 is in a one-dimensional\nface of \u03c3. Indeed, if n2 6\u2208 S, then n2 is in a non-singular face \u03c4 of\nP\n\u03c3. Let \u03c4 = he1 , . . . , ed i, then n2 = di=1 bi ei with bi \u2208 N \u222a {0} (i =\n1, . . . , d). We may assume that b1 6= 0. Let \u03b3 be the minimal face of\nP\n\u03c3 containing the cone hn1 , di=2 bi ei i, then, since n1 \u2208 \u03b3, \u03b3 is singular\nPd\nP\nand n1 + i=2 bi ei \u2208 \u03b3 o \u2282 S. Here, replace n1 by n1 + di=2 bi ei and n2\nby b1 e1 , then we can reduce to the case (2).\nNext, take the minimal regular subdivision of the 2-dimensional cone\nhn1 , n2 i ([4, Proposition 1.8]) which gives the minimal resolution of the\n2-dimensional singularity. Let hv1 , v2 i be its 2-dimensional cone containing v, then v is in the relative interior of this cone. We will construct\na regular subdivision of \u03c3 which contains hv1 , v2 i as a cone. We may\nassume that v1 \u2208 S. First, take the star-shaped subdivision \u03a31 with\nthe center v1 . Then take the star-shaped subdivision \u03a32 of \u03a31 with the\ncenter v2 if v1 , v2 are in the case (1). If v1 , v2 are in the case (2), let\n\u03a32 = \u03a31 . Here, we note that the exceptional set for the corresponding\nequivariant morphism is a divisor. If \u03a32 is not simplicial, let \u03b3 be a\nminimal dimensional cone which is not simplicial. Take n \u2208 \u03b3 o and take\nthe star-shaped subdivision of \u03a32 with the center n. Then \u03b3 is divided\ninto simplicial cones and the exceptional set for the corresponding equivariant morphism is a divisor. Continuing this procedure, we finally\nobtain a simplicial subdivision \u03a33 . If \u03a33 is not regular, take a cone\n\u03bb = hp1 , . . . , pt i \u2208 \u03a33 with the maximal multiplicity. The multiplicity\nP\nis vol P\u03bb , where P\u03bb = { ti=1 ci pi | 0 \u2264 ci < 1}. Since vol P\u03bb > 1, there\nis a non-zero element n\u2032 \u2208 P\u03bb \u2229 N. Take the star-shaped subdivision\nwith the center n\u2032 . Then again the exceptional set for the corresponding equivariant morphism is a divisor. Continuing this procedure, we\nfinally obtain a regular subdivision \u03a34 . As we did not change the cone\n\n\fTHE NASH PROBLEM\n\n13\n\nhv1 , v2 i in these procedures, \u03a34 contains this cone. Therefore, the exceptional divisor Dv does not appear in X(\u03a34 ). As all regular cones\nare unchanged, the corresponding equivariant morphism is a resolution which is isomorphic outside the singular locus. It is clear that the\nresolution is divisorial, as we saw it in each step of subdivisions.\n\u0003\nTheorem 3.16. Let X be an affine toric variety. Then the Nash map\nN : {Ci : i \u2208 I} \u2212\u2192 {essential divisors over X}\nis bijective.\nProof. In the diagram 3.6, we obtain that F is injective by Lemma 3.13,\nN is injective by Nash's theorem 2.15 and G is injective by Lemma 3.15.\nWe also have that G \u25e6 N \u25e6 F is the identity map on {minimal elements\nin S} by Lemma 3.14 and 3.15. Hence, G, N , F are all bijective.\n\u0003\nBy the proof of the above theorem, the following are obvious.\nCorollary 3.17. For a toric variety X, E is an essential divisor over\nX, if and only if E is a toric divisorially essential divisor over X.\nThe analogous result for essential divisors is proved in [3], but the\ndefinition used there is not quite equivalent to ours.\nCorollary 3.18. For a cone \u03c3 in N the number of the minimal eleS\nments in S = N \u2229 ( \u03c4 :singular \u03c4 o ) is finite. More precisely this number\nis the number of essential components and also the number of the good\ncomponents.\nCorollary 3.19. For a general point c \u2208 Ci for (i \u2208 I), the corresponding arc \u03b1ic satisfies \u03b1ic (\u03b7) \u2208 T .\nExample 3.20. Let e1 = (1, 0, 0), e2 = (0, 1, 0), e3 = (1, 1, e) \u2208 N \u2243 Z3\nand \u03c3 = he1 , e2 , e3 i. Then all proper faces of \u03c3 are regular and \u03c3\nitself is not regular, therefore the affine toric variety X corresponding\nto \u03c3 has an isolated singularity at the closed orbit. We can also see\nthat S = N \u2229 \u03c3 o . By simple calculations we obtain that the minimal\nelements in S are (1, 1, d) (1 \u2264 d \u2264 e \u2212 1). Therefore, by our theorem\nthe number of Ci 's and the number of the essential components are\nboth e \u2212 1.\n4. Counter examples to the Nash problem\nThe basic idea of our counter examples to the Nash problem is the\nfollowing:\nTake a singularity x \u2208 X and a partial resolution p : Y \u2212\u2192 X with\nexceptional divisor F \u2282 Y . Assume that Y has a singular point y \u2208 F\n\n\f14\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nsuch that every general arc g : Spec k[[s]] \u2212\u2192 (Y, y) is contained in an\nembedded smooth surface germ G : Spec k[[s, t]] \u2212\u2192 (Y, y).\nAssume that there is an essential divisor E over X whose center on\nY is y. The arcs on Y that should correspond to E are all arcs through\ny. If such an arc is contained in an embedded smooth surface germ\nG : Spec k[[s, t]] \u2212\u2192 (Y, y), then this arc can be moved in Y such that\nits closed point moves along the curve G\u22121 (F ), hence the arcs through\nE are all limits of arcs through some component of F .\nThis implies that E does not correspond to an irreducible component\nof the family of arcs through x \u2208 X. If we can also arrange E to be\nessential, we have a counter example to the Nash problem.\n4.1. Algebraically, a smooth formal curve through 0 \u2208 Y is equivalent\nto a surjection \u03c6 : \u00d4Y \u2212\u2192 k[[s]], where \u00d4Y denotes the completion of\nOY at the ideal m0 of 0. Similarly, a smooth surface germ is equivalent\nto a surjection \u03a6 : \u00d4Y \u2212\u2192 k[[t, s]]. The induced maps m0 /m20 \u2212\u2192\n(s)/(s)2 and m0 /m20 \u2212\u2192 (s, t)/(s, t)2 correspond to a point and a line\nin the exceptional divisor of the blow up B0 Y \u2212\u2192 Y .\nLemma 4.2. Let 0 \u2208 Y \u2282 An be a hypersurface singularity of multiplicity m defined by an equation F = 0 where F = Fm + Fm+1 + . . . is\nthe decomposition into homogeneous pieces. Set Z = (Fm = 0) \u2282 Pn\u22121\nand let z \u2208 Z be a point and z \u2208 L \u2282 Z a line such that Z is smooth\nalong L and H 1 (L, NL|Z ) = 0.\nLet \u03c6 : \u00d4Y \u2212\u2192 k[[s]] be a smooth formal curve through 0 with tangent\ndirection z. Then \u03c6 can be extended to a surjection \u03a6 : \u00d4Y \u2212\u2192 k[[t, s]]\nwith tangent direction L.\nProof. The line L can be identified with a map \u03a61 : k[y1 , . . . , yn ] \u2212\u2192\nk[s, t] such that the \u03a61 (yi ) are linear in s, t and \u03a61 (F ) \u2208 (s, t)m+1 . Our\naim is to find inductively maps\n\u03a6r : k[y1 , . . . , yn ] \u2212\u2192 k[s, t] such that \u03a6r (F ) \u2208 (s, t)m+r ,\n\u03a6r modulo (t) coincides with \u03c6 modulo (sr+1 ) and \u03a6r is congruent to\n\u03a6r+1 modulo (s, t)r+1. If this can be done then the inverse limit of the\nmaps\n\u03a6\n\nr\nk[s, t] \u2212\u2192 k[s, t]/(s, t)r+1\nk[y1 , . . . , yn ] \u2212\u2192\n\ngives \u03a6 : k[[y1 , . . . , yn ]] \u2212\u2192 k[[s, t]] such that \u03a6(F ) = 0. Thus it\ndescends to \u03a6 : \u00d4Y \u2212\u2192 k[[s, t]]\nA map g : k[y1 , . . . , yn ] \u2212\u2192 (any ring) can be identified with the vector (g(y1), . . . , g(yn )). Using this convention, by changing coordinates\nwe may assume that \u03c6 = (s, 0, . . . , 0) and L = (y3 = * * * = yn = 0).\n\n\fTHE NASH PROBLEM\n\n15\n\nThe first condition implies that no power of y1 appears in F and the\nsecond means that we can choose \u03a61 = (s, t, 0, . . . , 0).\nAssume that we already have \u03a6r which we assume to be of the form\n\u03a6r = (s, t, tA3,r\u22121 (s, t), . . . , tAn,r\u22121(s, t))\nwhere the Ai,r\u22121 are polynomials of degree \u2264 r \u2212 1 without constant\nterms. The vanishing of the constant term comes from extending the\nmap \u03a61 and the divisibility by t comes from the requirement of extending \u03c6. We are looking for \u03a6r+1 of the form\n\u03a6r+1 = (s, t, tA3,r\u22121 (s, t) + tB3,r (s, t), . . . , tAn,r\u22121(s, t) + tBn,r (s, t)),\nwhere the Bi,r are homogeneous of degree r. Let us compute \u03a6r+1 (F ).\nUsing the Taylor expansion, we get that\n\u03a6r+1 (F ) = \u03a6r (F ) + t *\n\nn\nX\n\n\u2202Fm\n(s, t, 0, . . . , 0) * Bi,r (s, t)\ni=3 \u2202yi\n\n+(terms of multiplicity \u2265 m + r + 1).\nBy the inductive assumption,\n\u03a6r (F ) = t * Cm+r\u22121 (s, t) + (terms of multiplicity \u2265 m + r + 1),\nwhere Cm+r\u22121 has degree m+ r \u22121. In order to achieve that \u03a6r+1 (F ) \u2208\n(s, t)m+r+1 , we need to find polynomials Bi,r such that\nCm+r\u22121 (s, t) = \u2212\n\nn\nX\n\n\u2202Fm\n(s, t, 0, . . . , 0) * Bi,r (s, t).\ni=3 \u2202yi\n\n(\u2217)\n\nSince we know nothing about Cm+r\u22121 , we need to guarantee that the\nideal generated by the partials \u2202Fm /\u2202yi (s, t, 0, . . . , 0) contains all homogeneous polynomials of degree m + r \u2212 1 in s, t for every r \u2265 1. The\ncritical case is r = 1.\nThe normal bundles of L in Z and in Pn\u22121 are related by an exact\nsequence\ndFm\n0 \u2212\u2192 NL|Z \u2212\u2192 NL|Pn\u22121 \u223c\n= O(m) \u2212\u2192 0,\n= O(1)n\u22122 \u2212\u2192 NZ|Pn\u22121 |L \u223c\n\nand dFm is the map O(1)n\u22122 \u2212\u2192 O(m) given by multiplication by the\npartials \u2202Fm /\u2202yi for i = 3, . . . , n. We have assumed that H 1(L, NL|Z ) =\n0, thus the induced map\ndFm :\n\nn\nX\n\nH 0 (L, O(1)) \u2212\u2192 H 0 (L, O(m)),\n\ngiven by\n\ni=3\n\n(l3 , . . . , ln )\n\n7\u2192\n\nn\nX\ni=3\n\nli\n\n\u2202Fm\n(s, t, 0, . . . , 0)\n\u2202yi\n\nis surjective. Thus the equation (*) always has a solution.\n\n\u0003\n\n\f16\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\nTheorem 4.3. Let Z \u2282 Pn\u22121 be a smooth hypersurface. Assume that\nZ is not ruled but through a general point of Z there is a line L such\nthat H 1 (L, NL|Z ) = 0.\nLet 0 \u2208 X be any singularity with a partial resolution p : Y \u2212\u2192 X\nand y \u2208 p\u22121 (0) a point such that\n(1) y \u2208 Y is a hypersurface singularity whose projectivised tangent\ncone is isomorphic to Z, and\n(2) p\u22121 (0) \u2282 Y is a Cartier divisor.\nThen the blow up By Y gives an essential exceptional divisor Z \u223c\n=\nE \u2282 By Y over 0 \u2208 X which does not correspond to an irreducible\nfamily of arcs on X.\nProof. E is an essential divisor by Example 2.5.\nIn order to prove that E does not correspond to an irreducible family\nof arcs on X, consider the family W of arcs in By Y through E. These\ncorrespond to a subset Wy of arcs on Y through y and to a subset\nWx of arcs in X through x. We claim that Wx is not an irreducible\ncomponent of the family of all arcs on X through x.\nIn order to see this, it is enough to show that a general arc in Wy is\na limit of arcs in Y through p\u22121 (0) but not passing through y.\nBy assumption, the pull back of a general local equation of y contains\nE with multiplicity 1. A general arc in W is transversal to E, so the\ngeneral member of Wy is an arc on Y wich has multiplicity 1 intersection\nwith a general local equation of y. Hence the general member of Wy is\na smooth arc on Y with general tangent direction. Therefore, by our\nassumption on Z and by (4.2), a general arc in Wy is contained in a\nsmooth surface germ. Thus it is a limit of arcs through p\u22121 (0) which\ndo not pass through y. Hence Wx is not an irreducible component of\nthe space of arcs on X through x.\n\u0003\nRemark 4.4. In characteristic 0, a smooth hypersurface Z \u2282 Pn\u22121 is\ncovered by lines if and only if deg Z \u2264 n \u2212 2 (cf. [14, V.4.6]). A general\nline then has H 1 (L, NL|Z ) = 0 by [14, II.3.11]. Thus the key condition\nis to check that Z is not birationally ruled. This can not happen if\nn \u2264 4. In higher dimensions there are two known sets of examples:\n(1) Z \u2282 P4 is a smooth cubic. Then Z is not birational to P3 . This\nwas proved by [5] over C and by [19] in characteristic 6= 2. This implies\nthat Z is not ruled. Indeed, assume that Z is birational to S \u00d7 P1 .\nThere is a degree 2 map P3 99K Z (this goes back to M. Noether, cf.\n[14, V.5.18.3]), so in characteristic 6= 2 we get a dominant separable\nmap P3 99K S \u00d7P1 \u2212\u2192 S. Thus S is rational by Castelnuovo's theorem.\nTherefore Z is birational to P2 \u00d7 P1 and so rational, a contradiction.\n\n\fTHE NASH PROBLEM\n\n17\n\nEvery line on a smooth cubic satisfies H 1 (L, NL|Z ) = 0 by [14,\nV.4.4.1] in any characteristic.\n(2) Z \u2282 Pn\u22121 is a very general hypersurface with n \u2265 deg Z \u2265 2n\n+2.\n3\nThese are nonruled in characteristic zero by [13].\nExample 4.5. The 4-dimensional hypersurface singularity over an algebraically closed field of characteristic 6= 2, 3\nx31 + x32 + x33 + x34 + x65 = 0\nhas only 1 irreducible family of arcs but 2 essential exceptional components.\nProof. Apply Theorem 4.3 to X = (x31 +x32 +x33 +x34 +x65 = 0). Blowing\nup the origin produces Y . The exceptional divisor F \u2282 Y is Cartier\nand Y has a unique singular point which is the cone over the cubic\n3\u2013fold Z := (x31 + x32 + x33 + x34 + x35 = 0). Z is not birationally ruled\nby (4.4.1).\nBlowing up the unique singular point of Y we get a resolution of X\nwith 2 exceptional divisors. One is E \u223c\n= Z and the other is F \u2032 , the\nbirational transform of F .\nF \u2032 is birationally ruled, but it is still essential. Indeed, the family of\narcs on X has to correspond to some exceptional divisor, and F \u2032 is the\nonly possibility. Thus F \u2032 has to be essential. Another way to see this\nis to note that X is terminal and F \u2032 has minimal discrepancy, namely\n1.\n\u0003\nReferences\n1. S. Abhyankar, On the valuations centered in a local domain. Amer. J. Math.\n78 (1956) 321\u2013348.\n2. M. Artin, On the solutions of analytic equations, Invent. Math. 5 1968 277\u2013291.\n3. C. Bouvier, Diviseurs essentiels, composantes essentielles des vari\u00e9t\u00e9s toriques\nsinguli\u00e8res, Duke Math. J. 91 (1998) 609\u2013620\n4. C. Bouvier and G. Gonzalez-Sprinberg, Syst\u00e8me g\u00e9n\u00e9rateur minimal, diviseurs\nessentiels et G-d\u00e9singularisations de vari\u00e9t\u00e9s toriques, Tohoku Math. J. 47,\n(1995) 125\u2013149.\n5. C.H. Clemens and P. Griffiths, The intermediate Jacobian of the cubic threefold,\nAnn. of Math. 95 (1972), 281\u2013356\n6. D. I. Dais, C. Haase and G. M. Ziegler, All toric local complete intersection singularities admit projective crepant resolutions, Tohoku Math. J. (2) 53, (2001)\n95\u2013107.\n7. J. Denef and F. Loeser, Germs of arcs on singular varieties and motivic integration, Invent. Math. 135, (1999) 201\u2013232.\n8. W. Fulton, Introduction to Toric Varieties, Annals of Math. St. 131, (1993)\nPrinceton University Press.\n9. H. Gillet, Differential Algebra - a scheme theory approach, preprint,\nhttp://www.math.uic.edu/\u223chenri\n\n\f18\n\nSHIHOKO ISHII & J\u00c1NOS KOLL\u00c1R\n\n10. G. Gonzalez-Sprinberg and M. Lejeune-Jalabert, Families of smooth curves\non surface singularities and wedges, Annales Polonici Mathematici, LXVII.2,\n(1997) 179\u2013190.\n11. M. Hickel, Fonction de Artin et germes de courbes trac\u00e9es sur un germe d'espace\nanalytique, Amer. J. Math. 115, (1993) 1299\u20131334.\n12. E. R. Kolchin Differential algebra and algebraic groups, Pure and Applied Mathematics, Vol. 54. Academic Press, New York-London, 1973.\n13. J. Koll\u00e1r, Nonrational hypersurfaces, J. Amer. Math. Soc. 8 (1995) 241\u2013249\n14. J. Koll\u00e1r, Rational Curves on Algebraic Varieties, Springer, 1996\n15. M. Kontsevich, Lecture at Orsay (December 7, 1995)\n16. M. Lejeune-Jalabert, Arcs analytiques et r\u00e9solution minimale des surfaces\nquasihomog\u00e8nes. in: Lecture Notes in Math. 777, (1980) 303\u2013336.\n17. M. Lejeune-Jalabert, Courbes trac\u00e9es sur un germe d'hypersurface. Amer. J.\nMath. 112, (1990) 525\u2013568.\n18. M. Lejeune-Jalabert and A. J. Reguera-Lopez, Arcs and wedges on sandwiched\nsurface singularities, Amer. J. Math. 121, (1999) 1191\u20131213.\n19. J. P. Murre, Reduction of the proof of the non-rationality of a non-singular\ncubic threefold to a result of Mumford, Compositio Math. 27 (1973), 63\u201382\n20. M. Musta\u0163\u01ce, Singularities of Pairs via Jet Schemes, J. Amer. Math. Soc. 15\n(2002), 599-615.\n21. J. F. Nash, Arc structure of singularities, Duke Math. J. 81, (1995) 31\u201338.\n22. A. Nobile, On Nash theory of arc structure of singularities. Ann. Mat. Pura\nAppl. 160 (1991), 129\u2013146\n23. A. J. Reguera-Lopez, Families of arcs on rational surface singularities,\nManuscr. Math. 88, (1995) 321\u2013333.\nShihoko Ishii: Department of Mathematics, Tokyo Institute of Technology, Oh-Okayama, Meguro, Tokyo, Japan\ne-mail : shihoko@math.titech.ac.jp\nJ\u00e1nos Koll\u00e1r: Princeton University, Princeton NJ 08544-1000 USA\ne-mail : kollar@math.princeton.edu\n\n\f"}