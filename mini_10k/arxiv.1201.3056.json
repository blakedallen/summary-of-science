{"id": "http://arxiv.org/abs/1201.3056v1", "guidislink": true, "updated": "2012-01-15T00:38:51Z", "updated_parsed": [2012, 1, 15, 0, 38, 51, 6, 15, 0], "published": "2012-01-15T00:38:51Z", "published_parsed": [2012, 1, 15, 0, 38, 51, 6, 15, 0], "title": "Power Allocation and Pricing in Multi-User Relay Networks Using\n  Stackelberg and Bargaining Games", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1201.3582%2C1201.6101%2C1201.4255%2C1201.5771%2C1201.3797%2C1201.2979%2C1201.1666%2C1201.1572%2C1201.4181%2C1201.6422%2C1201.1705%2C1201.6494%2C1201.1340%2C1201.6505%2C1201.3179%2C1201.0897%2C1201.1556%2C1201.2104%2C1201.3842%2C1201.4322%2C1201.6599%2C1201.4870%2C1201.0485%2C1201.3874%2C1201.2134%2C1201.5495%2C1201.2206%2C1201.1469%2C1201.0612%2C1201.4534%2C1201.2100%2C1201.5521%2C1201.0525%2C1201.6671%2C1201.2181%2C1201.3454%2C1201.1950%2C1201.0930%2C1201.3056%2C1201.1081%2C1201.5568%2C1201.1082%2C1201.3035%2C1201.5889%2C1201.4105%2C1201.2228%2C1201.1672%2C1201.2222%2C1201.4253%2C1201.1251%2C1201.5824%2C1201.3674%2C1201.0688%2C1201.5441%2C1201.0276%2C1201.3097%2C1201.0159%2C1201.2307%2C1201.2149%2C1201.2390%2C1201.0405%2C1201.2800%2C1201.0121%2C1201.2176%2C1201.2735%2C1201.0661%2C1201.0739%2C1201.6258%2C1201.0720%2C1201.3227%2C1201.0302%2C1201.3878%2C1201.6487%2C1201.6609%2C1201.5811%2C1201.0642%2C1201.5812%2C1201.1863%2C1201.3620%2C1201.2191%2C1201.4929%2C1201.5848%2C1201.0948%2C1201.0247%2C1201.0337%2C1201.6116%2C1201.6641%2C1201.6342%2C1201.0679%2C1201.1987%2C1201.2981%2C1201.2476%2C1201.3644%2C1201.1885%2C1201.1762%2C1201.5106%2C1201.1243%2C1201.6255%2C1201.5867%2C1201.3297%2C1201.6306&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Power Allocation and Pricing in Multi-User Relay Networks Using\n  Stackelberg and Bargaining Games"}, "summary": "This paper considers a multi-user single-relay wireless network, where the\nrelay gets paid for helping the users forward signals, and the users pay to\nreceive the relay service. We study the relay power allocation and pricing\nproblems, and model the interaction between the users and the relay as a\ntwo-level Stackelberg game. In this game, the relay, modeled as the service\nprovider and the leader of the game, sets the relay price to maximize its\nrevenue; while the users are modeled as customers and the followers who buy\npower from the relay for higher transmission rates. We use a bargaining game to\nmodel the negotiation among users to achieve a fair allocation of the relay\npower. Based on the proposed fair relay power allocation rule, the optimal\nrelay power price that maximizes the relay revenue is derived analytically.\nSimulation shows that the proposed power allocation scheme achieves higher\nnetwork sum-rate and relay revenue than the even power allocation. Furthermore,\ncompared with the sum-rate-optimal solution, simulation shows that the proposed\nscheme achieves better fairness with comparable network sum-rate for a wide\nrange of network scenarios. The proposed pricing and power allocation solutions\nare also shown to be consistent with the laws of supply and demand.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1201.3582%2C1201.6101%2C1201.4255%2C1201.5771%2C1201.3797%2C1201.2979%2C1201.1666%2C1201.1572%2C1201.4181%2C1201.6422%2C1201.1705%2C1201.6494%2C1201.1340%2C1201.6505%2C1201.3179%2C1201.0897%2C1201.1556%2C1201.2104%2C1201.3842%2C1201.4322%2C1201.6599%2C1201.4870%2C1201.0485%2C1201.3874%2C1201.2134%2C1201.5495%2C1201.2206%2C1201.1469%2C1201.0612%2C1201.4534%2C1201.2100%2C1201.5521%2C1201.0525%2C1201.6671%2C1201.2181%2C1201.3454%2C1201.1950%2C1201.0930%2C1201.3056%2C1201.1081%2C1201.5568%2C1201.1082%2C1201.3035%2C1201.5889%2C1201.4105%2C1201.2228%2C1201.1672%2C1201.2222%2C1201.4253%2C1201.1251%2C1201.5824%2C1201.3674%2C1201.0688%2C1201.5441%2C1201.0276%2C1201.3097%2C1201.0159%2C1201.2307%2C1201.2149%2C1201.2390%2C1201.0405%2C1201.2800%2C1201.0121%2C1201.2176%2C1201.2735%2C1201.0661%2C1201.0739%2C1201.6258%2C1201.0720%2C1201.3227%2C1201.0302%2C1201.3878%2C1201.6487%2C1201.6609%2C1201.5811%2C1201.0642%2C1201.5812%2C1201.1863%2C1201.3620%2C1201.2191%2C1201.4929%2C1201.5848%2C1201.0948%2C1201.0247%2C1201.0337%2C1201.6116%2C1201.6641%2C1201.6342%2C1201.0679%2C1201.1987%2C1201.2981%2C1201.2476%2C1201.3644%2C1201.1885%2C1201.1762%2C1201.5106%2C1201.1243%2C1201.6255%2C1201.5867%2C1201.3297%2C1201.6306&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "This paper considers a multi-user single-relay wireless network, where the\nrelay gets paid for helping the users forward signals, and the users pay to\nreceive the relay service. We study the relay power allocation and pricing\nproblems, and model the interaction between the users and the relay as a\ntwo-level Stackelberg game. In this game, the relay, modeled as the service\nprovider and the leader of the game, sets the relay price to maximize its\nrevenue; while the users are modeled as customers and the followers who buy\npower from the relay for higher transmission rates. We use a bargaining game to\nmodel the negotiation among users to achieve a fair allocation of the relay\npower. Based on the proposed fair relay power allocation rule, the optimal\nrelay power price that maximizes the relay revenue is derived analytically.\nSimulation shows that the proposed power allocation scheme achieves higher\nnetwork sum-rate and relay revenue than the even power allocation. Furthermore,\ncompared with the sum-rate-optimal solution, simulation shows that the proposed\nscheme achieves better fairness with comparable network sum-rate for a wide\nrange of network scenarios. The proposed pricing and power allocation solutions\nare also shown to be consistent with the laws of supply and demand."}, "authors": ["Qian Cao", "H. Vicky Zhao", "Yindi Jing"], "author_detail": {"name": "Yindi Jing"}, "author": "Yindi Jing", "links": [{"href": "http://arxiv.org/abs/1201.3056v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1201.3056v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1201.3056v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1201.3056v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "1\n\nPower Allocation and Pricing in Multi-User Relay\nNetworks Using Stackelberg and Bargaining Games\nQian Cao, H. Vicky Zhao, and Yindi Jing\n\narXiv:1201.3056v1 [cs.IT] 15 Jan 2012\n\nECE Dept., University of Alberta, Edmonton, AB Canada T6G 2V4\nEmail: qcao1@ualberta.ca, vzhao@ece.ualberta.ca, yindi@ualberta.ca\n\nAbstract\nThis paper considers a multi-user single-relay wireless network, where the relay gets paid for\nhelping the users forward signals, and the users pay to receive the relay service. We study the relay\npower allocation and pricing problems, and model the interaction between the users and the relay as\na two-level Stackelberg game. In this game, the relay, modeled as the service provider and the leader\nof the game, sets the relay price to maximize its revenue; while the users are modeled as customers\nand the followers who buy power from the relay for higher transmission rates. We use a bargaining\ngame to model the negotiation among users to achieve a fair allocation of the relay power. Based on\nthe proposed fair relay power allocation rule, the optimal relay power price that maximizes the relay\nrevenue is derived analytically. Simulation shows that the proposed power allocation scheme achieves\nhigher network sum-rate and relay revenue than the even power allocation. Furthermore, compared with\nthe sum-rate-optimal solution, simulation shows that the proposed scheme achieves better fairness with\ncomparable network sum-rate for a wide range of network scenarios. The proposed pricing and power\nallocation solutions are also shown to be consistent with the laws of supply and demand.\n\nIndex terms: Multi-user relay network, power allocation, pricing, Stackelberg game, KailaiSmorodinsky bargaining solution (KSBS).\nI. I NTRODUCTION\nCooperative communication has been shown to be a promising concept for future wireless\nnetworks (e.g., [1], [2]). The basic idea is to have multiple nodes in the network help each\nother's transmission to achieve diversity. Numerous cooperative relaying strategies aiming at\n\n\f2\n\noptimizing the global network performance have been proposed. Two widely used ones are\namplify-and-forward (AF) and decode-and-forward (DF). For AF, the relays simply forward\namplified versions of the signals they receive without decoding. For DF, the relays decode their\nreceived signals and transmit the re-encoded signals [3]. While pioneering efforts in cooperative\nnetworks focus on single-user networks (e.g., [4]\u2013[9]), research on multi-user networks, in which\nmultiple transmissions of different users can be supported, are important to meet the demands of\nfuture communication systems. One such model is the multi-user single-relay network (e.g., [10]\u2013\n[16]). Capacity bounds of the network are investigated in [10], [11], and interference cancellation\nschemes are proposed in [12], [13]. In [14] and [15], network decoding is applied to combat\ninterference among users in multi-user single-relay networks. In [16], the resource allocation\nproblem, including both the subcarrier allocation and the relay power allocation, in a multi-user\nsingle-relay network is studied to maximize the sum-rate.\nIn the aforementioned papers, nodes in a network are assumed to be altruistic and willing to\ncooperate to optimize the overall network performance. In many practical applications, however,\nnodes are selfish and aim to optimize their own benefits or quality-of-service. On the other hand,\ndue to limited resources available, multiple selfish users in the network have conflicts in resource\nallocation. It is important to find solutions that achieve both high overall network performance\nand fairness among users. To model and analyze these behaviors, game theory is often used [17].\nResearch in cooperative network designs using game theory become increasingly popular in\nrecent years. Many papers have appeared in literature, e.g., [18]\u2013[25]. [18] considers the uplink\nof a network with multiple users and single base station, in which users can form coalitions\nand share resources to form a virtual multi-antenna system to improve performance. A mergeand-split algorithm is proposed to construct coalitions among users to maximize utilities, which\nare defined as the transmission rates. In [19] and [20], a two-user network where each user\ncan also work as a relay for the other is studied. By employing a two-user bargaining game,\nfair bandwidth allocation [19] and power allocation [20] are found from the Nash bargaining\nsolution. In [21], the relay power allocation problem in the downlink of a multi-user multi-relay\ncellular network is studied. Non-cooperative game theory is used to model the competition for\nrelay power among users. An iterative scheme is proposed to ensure all users reach the Nash\n\n\f3\n\nequilibrium point.\nNone of the aforementioned works consider the cooperation stimulation problem. In a relay\nnetwork, one possible solution to user cooperation stimulation is the payment-based scheme,\nwhere the relays get paid if they forward users' messages and users pay for the relay service.\nHere, relays and users aim to maximize their own payoffs instead of the overall network\nperformance. In [22]\u2013[25], the pricing mechanism is used to encourage the relays to help forward\npackets for the users. For multi-user ad hoc networks, compensation frameworks are proposed\nin [22] and [23], in which a network node sets price and receives revenue if it cooperatively\nhelps others' transmissions. In [24], for a single-user multi-relay network, the relay selection\nand relay power control are investigated using a two-level Stackelberg game. In this game, the\nrelays compete to provide service to the user to gain revenue. [25] studies the user power control\nand relay pricing problems in a multi-user single-relay network. In the game theoretic model,\nthe relay sets the price to maximize its revenue, while a non-cooperative game is used to model\nthe user behavior, in which each user adjusts its transmit power to selfishly maximize its own\nutility. A distributed iterative scheme is proposed to achieve the unique Nash equilibrium point.\nIn this paper, we consider a multi-user single-relay network and use game theory to model and\nanalyze the user and relay behavior. Amplify-and-forward is adopted due to its simplicity and low\ncomputational load. Pricing mechanism is used where the relay gets paid for signal forwarding\nand users pay for the relay service. We model the interaction between the relay and the users as a\ntwo-level Stackelberg game, in which the relay is the leader and sets the unit power price for the\nrelay service, and users are the followers where each user decides how much power to purchase\nfrom the relay. Different from [25], we consider the relay power allocation among users, instead\nof the user power control; and also we model the relay power competition among users as a\ncooperative bargaining game. For the relay power allocation, the Kalai-Smorodinsky bargaining\nsolution (KSBS) is used for fairness. The power allocation problem is transformed into a convex\noptimization problem. With the KSBS-based relay power allocation, We analytically find the\noptimal relay price that maximizes the relay revenue. From our simulations, compared with\nthe sum-rate-optimal power allocation, the proposed KSBS-based power allocation is fairer and\nachieves close-to-optimal sum-rate for a wide range of network scenarios. Compared with the\n\n\f4\n\neven power allocation, the proposed KSBS-based power allocation archives higher relay revenue\nand network sum-rate. It is also shown via simulations that the proposed relay pricing and power\nallocation solutions are consistent with the laws of supply and demand.\nThe rest of this paper is organized as follows. Section II gives a brief background review on\ngame theory. Section III describes the multi-user single-relay cooperative network model and the\nStackelberg game and bargaining game models for the relay pricing and relay power allocation\nproblems. In Section IV, we analyze the relay power pricing and power allocation problems.\nThe optimal relay price is solved analytically, while the relay power allocation is transformed\ninto a convex optimization problem. Section V discusses the properties of the proposed solutions\nand their possible implementation. Simulation results are shown in Section VI. Conclusions are\ndrawn in Section VII.\nII. R EVIEW\n\nOF\n\nG AME T HEORY\n\nIn this section, we provide a brief review of game theory and introduce the basic concepts\nand results that will be used in this paper.\nGame theory mainly analyzes behavior in strategic situations, or games, in which players\ninfluence each other's decision and performance [28]. A game consists of three parts: a set of\nplayers, a set of actions of the players, and a set of utilities that represent the players' relative\nsatisfaction of the outcome of the game. Equilibrium is the strategy outcome of a game that is\nthe best response of each user given the decision of others. The most famous equilibrium is the\nNash equilibrium, in which no player can increase its utility by unilaterally changing its own\nstrategy, and the corresponding strategy set and utilities constitute a Nash equilibrium.\n\nA. Stackelberg Game\nIn a Stackelberg game, one player acts as a leader who takes action first, and the other players\nare followers who observe the leader's action and act accordingly. The subgame perfect Nash\nequilibrium of the Stackelberg game can be found using the backward induction method. It\nfirst studies the followers' game: for each possible action of the leader, it finds the optimal\nfollowers' response that maximizes the followers' payoff. Then given the optimal followers'\n\n\f5\n\nresponse strategy, it studies the leader's action and chooses the one that maximizes the leader's\nutility. The chosen strategy set is the Stackelberg equilibrium [28].\n\nB. Bargaining Game and Kailai-Smorodinsky Bargaining Solution (KSBS)\nA bargaining game models the bargaining interactions of players. In a bargaining problem,\nthere are N players with utilities u1 , u2 , * * * uN . A utility vector u = (u1 u2 * * * uN ) is\ncalled feasible if it is possible to find a strategy set that gives the ith player utility ui for all\ni = 1, * * * , N. Let S denote the set of all feasible utility vectors. The disagreement point, denoted\nas u0 = (u1,0 u2,0 . . . uN,0 ), is the vector of the minimal utility that each player expects if the\nplayers do not reach an agreement and play non-cooperatively. It is the guaranteed utility for the\nplayers in the bargaining game. The ideal point uI = (uI1 uI2 . . . uIN ) (the superscript 'I' stands\nfor ideal) is the vector of the maximum achievable utilities of the players in S. We thus have\nuIi \u2265 ui,0. Note that for players with uIi = ui,0 , cooperation does not increase their utilities and\nthey will not enter the game. For the rest of the players, uIi > ui,0 and they will participate in\nthe bargaining process.\nGiven S, the disagreement point u0 , and the ideal point uI , players negotiate with each other to\nselect one feasible solution u and the corresponding strategy set that all players agree. Depending\non how players define fairness, they may select different solutions. One popular solution for the\nbargaining game is the KSBS [29], which is the solution to the optimization problem\nmax k\n\ns.t.\n\nui \u2212 ui,0\n=k\nuIi \u2212 ui,0\n\n(1)\n\nfor all participating players with uIi > ui,0 .\nKSBS is an equilibrium point that guarantees fairness in the sense of equal penalty, which can\nbe deducted from the constraint in (1). In (1), (uIi \u2212 ui,0 ) and (ui \u2212 ui,0 ) are Player i's maximum\nand actual net utility gains, respectively. Taking logarithm on both sides of the constraint in (1),\nwe have\nlog (uIi \u2212 ui,0 ) \u2212 log (ui \u2212 ui,0) = \u2212 log k.\n\n(2)\n\nAs log k is a constant independent of the players, the constraint in (1) forces all players participating in the bargaining game to suffer the same quality penalty in the logarithmic scale, and\n\n\f6\n\nthus ensures fairness in this sense. It is worth mentioning that KSBS is neither individual utility\noptimal nor global optimal in general. It is an equilibrium point that balances the proposed utility\nmeasure and fairness among users.\nPSfrag replacements\nIII. G AME M ODELS\n\nFOR\n\nR ELAY P OWER A LLOCATION\n\nAND\n\nP RICING\n\nIn this section, we explain the network model, elaborate the relay power pricing and relay\npower allocation problems, and propose the game theoretical models for the problems using a\nStackelberg game and a bargaining game.\n\nA. Network Model\nConsider a wireless network with N users communicating with their destinations with the\nhelp of one relay as shown in Figure 1. Denote the channel gain from User i to Destination i\nRelay\n\nf1\nUser 1\n\ng1\nh1\n\nDestination 1\n\ngi\n\nfi\nhi\nUser i\n\nDestination i\n\nfN\nUser N\n\nFig. 1.\n\ngN\nhN\n\nDestination N\n\nMulti-user single-relay network.\n\n(direct link) as hi , the channel gain from User i to the relay as fi , and the channel gain from the\nrelay to Destination i as gi . The relay and destination are assumed to have global and perfect\nchannel state information (CSI) f1 , * * * , fN , g1 , * * * , gN through training and feedback. No CSI\nis required at the users. User i uses transmit power Qi and the maximum transmit power of the\nrelay is P .\nFrequency division multiple access (FDMA) is used, so transmissions of different users are\northogonal and interference-free. Without loss of generality, we elaborate the transmission of\n\n\f7\n\nUser i's message on Channel i. We use the popular half-duplex two-step AF relaying protocol.\nLet si be the information symbol of User i. It is normalized as E(|si |2 ) = 1, where E stands\n\u221a\nfor the average. In the first step, User i transmits Qi si . The signals received by the relay and\nDestination i are\nyiR =\n\np\n\nQi si fi + niR\n\nand\n\nyiD =\n\np\n\nQi si hi + niD ,\n\n(3)\n\nrespectively, where niR and niD are the additive noises at the relay and the destination in the\nfirst step, respectively. In the second step, the relay amplifies its received signal and forwards it\nto Destination i. Denote the power the relay uses to help User i as Pi . Since the relay has perfect\nCSI, coherent power coefficient is used for better performance [26], [27]. The signal received\nat Destination i can be shown to be\ns\ns\nQi Pi\nPi\nyRi =\ns\nf\ng\n+\ngi niR + nRD ,\ni\ni\ni\nQi |fi |2 + 1\nQi |fi |2 + 1\n\n(4)\n\nwhere nRD is the additive noise at the destination in the second step. All noises are assumed to\nbe i.i.d. additive circularly symmetric complex Gaussian with zero-mean and unit-variance.\nAfter maximum-ratio combining of both the direct path and the relay path, the effective\nreceived signal-to-noise-ratio (SNR) of User i's transmission can be shown to be\nSNRi =\n\nQi Pi |fi gi |2\n+ Qi |hi |2 .\nPi |gi |2 + Qi |fi |2 + 1\n\n(5)\n\nIf User i's transmission is not helped by the relay and only the direct transmission is active, the\nreceived SNR of User i's transmission becomes\nSNRiD = Qi |hi |2 .\n\n(6)\n\nB. Game Theoretical Model for Relay Pricing and Relay Power Allocation\nIn this paper, we focus on the relay power allocation among users and the relay power pricing.\nIn early relay network designs, many research focused on relay power allocation that optimizes\nthe global network performance. In these models, the relay has no gain and selflessly helps the\nusers using its own power; and the users are also selfless, who care about the global network\nperformance instead of their own benefits. In many practical applications, however, the relay\n\n\f8\n\nneeds incentives for cooperation. Also, there is a natural conflict among users, who want to\nobtain help from the relay to maximize their individual benefits. With no payment for the relay\npower, each user wants as much power as possible, which leads to undesirable situations, e.g.,\nthe total power demand from users exceeds the relay power budget. This motivates the use of\ngame theory to model the selfish behavior of the users and the relay. Our goal is to find a fair\npower allocation among the users and the optimal relay pricing strategy. We use the Stackelberg\ngame to model the interaction between the users and the relay, and the bargaining game to model\nthe relay power allocation among the users, which, as explained in Section II, is a natural fit.\nWe consider the relay as the leader of the Stackelberg game who sets the price of its power\nin helping the users. The key point of the relay game is for the relay to set the price to gain the\nmaximum revenue. The relay revenue, denoted as uR , is the total payment from the users. We\nuse a simple pricing model by assuming that the relay revenue is linear in the amount of power\nP\nit sells, i.e., uR = N\ni=1 \u03bbPi , where \u03bb is the normalized unit price of the relay power and Pi is\n\nthe power the relay uses to help User i.\n\nWe consider the users as followers of the Stackelberg game that react in a rational way\ngiven the unit price of the relay power. The bargaining game is used to model the cooperative\ninteraction among users. That is, we assume that users make agreements to cooperatively share\nthe relay power. A key point of formulating the users as selfish players in a bargaining game is\nto design the utility function, which should reflect both the quality-of-service and the paymentfor-service of users. Its physical meaning can be the benefits received by the users. In this paper,\nwe seek to design an appropriate utility function that is not only physically meaningful, but also\nmathematically attractive to ensure tractability and convergence.\nWe define the utility of User i as\nQi Pi |fi gi |2\n+ Qi |hi |2 \u2212 \u03bbPi ,\nui ,\n2\n2\nPi |gi | + Qi |fi | + 1\n\ni = 1 * * * N,\n\n(7)\n\nwhich, for a given network scenario, is a function of Pi , the power the relay uses to help User\ni. The first two terms of (7) correspond to the effective received SNR of User i given in (5)\nand represent the quality-of-service of the user. It is directly related to the performance of the\ncommunication, e.g., the achievable rate. The last term \u03bbPi represents the user's normalized cost\n\n\f9\n\nin purchasing the relay service. If User i does not buy any power from the relay and uses the\ndirect transmission only, i.e., Pi = 0, its utility is the minimum utility that User i expects. Thus\nui,0 = Qi |hi |2 .\n\n(8)\n\nIn the following section, we analyze the above Stackelberg game and bargaining game models\nto find the optimal relay power pricing and a fair power allocation among the users.\nIV. R ELAY P OWER A LLOCATION\n\nAND\n\nP RICING S OLUTIONS\n\nIn this section, we solve the power allocation and pricing problems jointly using the backward\ninduction method [28]. That is, we first solve the user game, i.e., the relay power allocation among\nthe users for a given price of the relay power, then solve the relay game, i.e., the optimal price\nof the relay power, based on the derived user bargaining strategy. The user game and the relay\ngame are formulated and analyzed in the following two subsections, respectively.\n\nA. Relay Power Allocation Based on KSBS\nThe user game is to find the relay power allocation among the users for a given unit power\nprice \u03bb. We use the bargaining game in cooperative game theory to find a fair power allocation.\nSpecifically, we look for the KSBS of the bargaining game, the background of which is provided\nin Section II-B.\nWe first calculate User i's ideal utility uIi of a given \u03bb. To maximize its utility, User i's goal\nis\nmax ui\nPi\n\ns.t. ui \u2265 ui,0, 0 \u2264 Pi \u2264 P.\n\n(9)\n\nThe first constraint in (9) ensures that User i gets no less utility than ui,0, which is its utility\nwhen it receives no help from the relay, i.e., Pi = 0. The second constraint ensures that the power\ndemand of User i does not exceed the total power budget P of the relay. Given a relay power\nprice, this optimization problem can be solved analytically and the result is given in Lemma 1.\nLemma 1: Define\nbi ,\n\nQi |fi gi |2\n.\nQi |fi |2 + 1\n\n(10)\n\n\f10\n\nGiven the unit relay power price \u03bb, the ideal power demand of User i that maximizes its utility\nui in (7) is\nPiI (\u03bb) =\n\n\uf8f1\n\uf8f4\n0\n\uf8f4\n\uf8f4\n\uf8f2\n\n|2\n\nQi |fi\n\u221a\nbi\n\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 P\n\nif \u03bb \u2265 bi\n( \u221a1\u03bb\n\n\u2212\n\n\u221a1 )\nbi\n\n\u0010\n\nbi P\nQi |fi |2\n\n+1\nif bi > \u03bb > bi\n\u0011\u22122\n\u0010\niP\nif \u03bb \u2264 bi Qbi|f\n2 + 1\ni|\n\n\u0011\u22122\n\n.\n\nThe ideal utility of User i is\n\uf8f1\n\uf8f4\nui,0\nif \u03bb \u2265 bi ,\n\uf8f4\n\uf8f4\n\uf8f2\n\u0011\u22122\n\u0010\np\nbi P\n2\n2\nuIi (\u03bb) =\n.\nQi |fi | (1 \u2212 \u03bb/bi ) + ui,0 if bi > \u03bb > bi Qi|fi |2 + 1\n\uf8f4\n\u0010\n\u0011\n\uf8f4\n\u22122\n\uf8f4\n\uf8f3\nbi P\niP\n\u2212 \u03bbP + ui,0 if \u03bb \u2264 bi Qbi |f\n2 + 1\n(Qi |fi |2 )\u22121 bi P +1\n|\ni\nProof: From (7), we have\n\u0012\n\u0013\u22122\n\u2202ui\nbi Pi\n= bi\n+1\n\u2212 \u03bb,\n\u2202Pi\nQi |fi |2\n\nThus\n\n\u2202 2 ui\n\u2202 2 Pi\n\n(11)\n\n(12)\n\n\u22122(Qi |fi |2 )\u22121 b2i\n\u2202 2 ui\n=\n.\n\u2202 2 Pi\n[(Qi |fi |2 )\u22121 bi Pi + 1]3\n\n< 0, which means that ui is a concave function of Pi .\n\u2202ui\n\u2202Pi\n\n\u2264 0 for all Pi \u2265 0 as [(Qi |fi |2 )\u22121 bi Pi + 1]2 > 1. So ui is a non-increasing\n\u0010\n\u0011\u22122\n\u2202ui\niP\n+\n1\n\u22650\nfunction of Pi and its maximum is reached at PiI (\u03bb) = 0. When \u03bb \u2264 bi Qbi |f\n, \u2202P\n2\ni|\ni\nWhen \u03bb \u2265 bi ,\n\nfor all Pi \u2264 P . So ui is a non-decreasing function of Pi , and PiI (\u03bb) = P in this case. When\n\u0010\n\u0011\u22122\nQi |fi |2 1\n\u2202ui\n\u221a\n( \u221a\u03bb \u2212 \u221a1bi ).\n=\n0,\ni.e.,\nP\n=\nbi > \u03bb > bi Qbi i|fPi|2 + 1\n, ui reaches its maximum when \u2202P\ni\nbi\ni\n\nThis proves the ideal power solution in (11). Using this solution and the equalities (7) and (8),\nwe can obtain the ideal utility for User i in (12).\nFrom Lemma 1, we see that PiI (\u03bb) is independent of User i's direct link hi . Intuitively, this\n\nis because the contribution of the direct link to User i's receive SNR and utility is fixed and\nkeeps unchanged for any amount of relay power that User i obtains.\nLemma 1 also shows that when the price is too high, Case 1 in (11), User i will not buy\nany relay service. When the price is too low, Case 3 in (11), User i wants to purchase all relay\npower to maximize its utility. For the price range shown in Case 2 in (11), User i asks for part\nof the relay power that gives the ideal balance between its SNR and its payment to maximize its\nutility. The ideal power demand of User i depends not only on the relay power price, but also\non its power constraint Qi and the quality of its local channels fi and gi . The bi defined in (10),\n\n\f11\n\nwhose value depends on User i's condition only, is an important parameter. As shown in (11), it\nnot only determines whether a relay asks for the relay service but also affects how much power\na user asks for ideally. We can see bi as a quality measure for User i to some extent. For any\ntwo users, User i and User j, assume that bi > bj . We can see that if User i is not allocated any\nrelay power, which happens when bi \u2264 \u03bb, User j will not be allocated any relay power either\nbecause its bj is smaller. Also, for a given price \u03bb, increasing the Qi and |fi |2 of User i, which\nincreases bi , results in higher or the same relay power demand from User i, which is shown in\nthe following lemma.\nLemma 2: Given a relay power price \u03bb, PiI (\u03bb) is a non-decreasing function of Qi and |fi |2 .\n\u0011\u22122\n\u0010\niP\n+\n1\n,\nProof: From (11), we get, when bi > \u03bb > bi Qbi |f\n2\ni|\n!\n(s\n)\nr\n2\n2\n2\nQ\n|f\n|\nb\n|g\n|\nQ\n|f\n|\n+\n1\ni i\ni\ni\ni i\nPiI (\u03bb) =\n\u22121 =\n\u22121 .\n2\nbi\n\u03bb\n|gi |\n\u03bb[1 + 1/(Qi |fi |2 )]\n\u0011\u22122\n\u0010\niP\n+\n1\n, PiI (\u03bb) =\nFor other two price ranges, when \u03bb \u2265 bi PiI (\u03bb) = 0, and when \u03bb \u2264 bi Qbi|f\n2\ni|\nP . So, in all price ranges,\n\"\n\n(s\n\n) !#\n2\n|g\n|\ni\n\u2212 1 ,P\n.\nPiI (\u03bb) = max 0, min\n\u03bb[1 + 1/(Qi |fi |2 )]\no\nnq\n2\n|gi |2\ni | +1\n\u2212\n1\nis\nmax and min are non-decreasing functions. For a given \u03bb, Qi |f\n|gi |2\n\u03bb[1+1/(Qi |fi |2 )]\nQi |fi |2 + 1\n|gi |2\n\nalso a non-decreasing function of Qi and |fi |2 . So we conclude that PiI (\u03bb) is a non-decreasing\nfunction of Qi and |fi |2 .\n\nTo find the KSBS of the user bargaining game, without loss of generality, we assume that the\nusers are sorted in the descending order of their bi values, that is\nb1 \u2265 b2 \u2265 * * * \u2265 bN .\n\n(13)\n\nWith the given price \u03bb, for users satisfying bi \u2264 \u03bb, as shown in Lemma 1, their ideal power\ndemand is 0 so they do not buy any power from the relay, thus do not enter the game.\nLet L be the number of users satisfying bi > \u03bb. That is, with the ordering in (13), assume\nthat bL > \u03bb > bL+1 . The first L users will participate in the bargaining game and purchase the\nrelay service. Given \u03bb, to find the KSBS-based power allocation of the L users is equivalent to\n\n\f12\n\nsolving the following optimization problem [29]:\nmax k\nPi\n\ns.t.\n\nbi Pi\n\u2212\n(Qi |fi |2 )\u22121 bi Pi +1\nuIi \u2212 ui,0\n\n\u03bbPi\n\nL\nX\n\n= k,\n\ni=1\n\nPi \u2264 P,\n\n0 < Pi < Qi |fi |\n\n2\n\n\u0012\n\n1\n1\n\u2212\n\u03bb bi\n\n\u0013\n\n, (14)\n\nwhere uIi and ui,0 , given in (12) and (8) respectively, are the ideal and minimal utilities of User\ni. The second constraint in (14) is due to the total power constraint of the relay, and the last\nconstraint is to ensure the feasibility of the solution and is derived from rewriting ui > ui,0.\nIn the proof of Lemma 1, we have shown that ui is a concave function of Pi . Also, ui = ui,0\nat Pi = 0 and Pi = Qi |fi |2 (1/\u03bb \u2212 1/bi ), and ui reaches its maximum uIi (\u03bb) at Pi = PiI (\u03bb).\nAn example of ui as a function of Pi is given in Figure 2. It can be shown from the utility\ndefinition in (7) that for each u \u2208 (ui,0 , uIi (\u03bb)), there are two possible choices of Pi in the\n\u0003\nrange (0, Qi |fi |2 (1/\u03bb \u2212 1/bi )) that satisfy ui (Pi ) = u: one in the range 0, PiI (\u03bb) and the other\n\u0002\n\u0001\nin the range PiI (\u03bb), Qi |fi |2 (1/\u03bb \u2212 1/bi ) . Thus we can shrink the feasible region of Pi from\n\n(0, Qi |fi |2 (1/\u03bb \u2212 1/bi )) to either one of the smaller regions. We choose the first region for two\nPSfrag replacements\nui\nuIi (\u03bb)\n\nui,0\n0\n\nFig. 2.\n\nPiI (\u03bb)\n\nQi |fi |2\n\n\u0010\n\n1\n\u03bb\n\n\u2212\n\n1\nbi\n\n\u0011 Pi\n\nConcavity of the utility function.\n\nreasons. First, for the same ui value, this choice results in a smaller Pi than choosing the second\nregion, and the users prefer to buy less power to gain the same utility. Second, smaller power\nconsumption for each user saves relay power, so more users can be helped. Thus, (14) becomes\nmax k\nPi\n\ns.t.\n\nbi Pi\n\u2212\n(Qi |fi |2 )\u22121 bi Pi +1\nuIi \u2212 ui,0\n\n\u03bbPi\n\n= k,\n\nL\nX\ni=1\n\nPi \u2264 P,\n\n0 < Pi \u2264 PiI (\u03bb).\n\nTo solve this optimization problem, we prove the following lemma.\n\n(15)\n\n\f13\n\nLemma 3: The relay power allocation problem in (15) is equivalent to the following max-min\nproblem:\nmax min\nPi\n\ni\n\n(\n\nbi Pi\n(Qi |fi |2 )\u22121 bi Pi +1\n\nuIi\n\n\u2212 ui,0\n\n\u2212 \u03bbPi\n\n)\n\n,\n\ns.t.\n\nProof: First we use the notation \u03c8i (Pi ) ,\n\nL\nX\ni=1\n\nPi \u2264 P,\n\nbi Pi\n\u2212\u03bbPi\n(Qi |fi |2 )\u22121 bi Pi +1\nI\nui \u2212ui,0\n\n0 < Pi \u2264 PiI (\u03bb).\n\n(16)\n\n. To prove this lemma, it is\n\nsufficient to show that the power allocation solution in (16), denoted as (P1\u2217, * * * , PL\u2217 ), satisfies\n\u03c81 (P1\u2217 ) = * * * = \u03c8L (PL\u2217 ). We prove this by contradiction. Without loss of generality, suppose\nthat \u03c81 (P1\u2217 ) < \u03c82 (P2\u2217 ) < min{\u03c83 (P3\u2217 ), * * * , \u03c8L (PL\u2217)}. Thus, maxPi mini \u03c8i (Pi\u2217 ) = \u03c81 (P1\u2217 ). Since\n\u03c81 (P1 ), \u03c82 (P2 ) are increasing and continuous functions of P1 , P2 in the feasible region given\nin (16), there exists a small enough positive \u01eb such that P1\u2217 + \u01eb, P2\u2217 \u2212 \u01eb are still in the feasible\nregion and\n\u03c81 (P1\u2217 ) < \u03c81 (P1\u2217 + \u01eb) < \u03c82 (P2\u2217 \u2212 \u01eb) < \u03c82 (P2\u2217 ).\nThe new power allocation (P1\u2217 + \u01eb, P2\u2217 \u2212 \u01eb, P3\u2217 , * * * , PL\u2217 ) satisfies all power constraints in (16). Its\nmax-min value is \u03c81 (P1\u2217 +\u01eb) which is larger than the max-min value of the solution (P1\u2217, * * * , PL\u2217).\nThis contradicts the assumption that (P1\u2217 , * * * , PL\u2217) is optimal, thus completes the proof.\n(16) is a convex optimization problem and can be solved efficiently using standard convex\noptimization techniques [30]. We call the solution of (16) the KSBS-based power allocation.\nRecall that in (16), only the L users whose bi 's are larger than the relay price \u03bb participate in\nthe game. The remaining N \u2212 L users request no relay power.\nIn the game theoretical model in (16), the power constraint at the relay is taken into consideration. For any relay price \u03bb, (16) will result in a feasible power allocation among users, i.e.,\nthe total power demanded by the users does not exceed the relay power constraint. Without the\ngame theoretical model, if, for example, for a given price, the users request their ideal relay\npowers to maximize their individual utilities, it may happen that the total power demand of\nthe users exceeds the relay power constraint, and the relay cannot make a satisfactory power\nallocation. With the proposed KSBS-based relay power allocation, when the sum of the ideal\npower demands of all users does not exceed the relay power constraint, the users will be allocated\ntheir ideal powers, in which case, k in (15) reaches its maximum 1; when the sum of the ideal\n\n\f14\n\npower demands of all users exceeds the relay power constraint, the proposed KSBS-based power\nallocation will allocate all relay power to the users fairly. This is shown in the following lemma.\n\nLemma 4: For a fixed \u03bb, let the ideal power allocation of User i be PiI (\u03bb), which is given\nin (11); and let the KSBS-based power allocation be PiK (\u03bb) (K stands for KSBS). When\nPL\nPL\nPL\nK\nI\nI\nK\nI\nP\n(\u03bb)\n>\nP\n,\nwe\nhave\nP\n(\u03bb)\n\u2264\nP\n,\nwe\nhave\nP\n(\u03bb)\n=\nP\n(\u03bb);\nwhen\ni\ni\ni\ni\ni=1 Pi (\u03bb) = P .\ni=1\ni=1\nProof: Again, we use the notation \u03c8i (Pi ) ,\n\nbi Pi\n\u2212\u03bbPi\n(Qi |fi |2 )\u22121 bi Pi +1\nuIi \u2212ui,0\n\n. With the new feasible region\n\nof Pi in (16), \u03c8i (Pi )'s are increasing functions and reach their maximum 1 when Pi = PiI (\u03bb).\nP\nThus k \u2208 [0, 1] and achieves the maximum k = 1 if and only if Li=1 PiI (\u03bb) \u2264 P , that is, when\n\nusers can reach their ideal utility with a feasible relay power. In this case, PiK (\u03bb) = PiI (\u03bb).\nP\nIf Li=1 PiI (\u03bb) > P , not all users can reach their ideal utilities and thus k < 1. From the\nequivalent form (15), actually no user can reach its ideal utility. That is, PiK (\u03bb) < PiI (\u03bb).\nP\nSuppose that Li=1 PiK (\u03bb) < P . Define\n)\n(\nP\nP \u2212 Li=1 PiK (\u03bb) I\nK\nI\nK\n, P1 (\u03bb) \u2212 P1 (\u03bb), * * * , PL (\u03bb) \u2212 PL (\u03bb) .\n\u01eb , min\ni\nL\n\n\u01eb is a positive number. Now consider the power allocation P\u0303i (\u03bb) , PiK (\u03bb) + \u01eb. First, this new\npower allocation satisfies all power constraints due to its construction. Also, as \u03c8i 's are increasing\nfunctions, the new power allocation results in a higher minimum value, that is mini \u03c8i (P\u0303i (\u03bb)) >\nmini \u03c8i (PiK (\u03bb)), which contradicts the assumption that PiK (\u03bb) is optimal. This completes the\nproof.\n\nB. Optimal Relay Power Price\nNow we investigate the relay pricing problem. The price of the relay power is crucial to the\nrelay revenue and the relay power allocation among the users. If the relay sets the price too\nhigh, no user will buy any power, and the relay revenue will be zero. If the relay sets the price\ntoo low, all users will ask for as much power as possible; and even though all relay power can\nbe sold, the relay revenue will not be maximized.\nWith the unit price of the relay power \u03bb, from Section III, and by using the KSBS-based relay\nP\nK\nK\npower allocation in Section IV.A, the revenue of the relay is N\ni=1 \u03bbPi (\u03bb), where Pi (\u03bb) is\n\n\f15\n\nthe relay power allocated to User i based on the KSBS for the given price \u03bb. The relay pricing\nproblem can be formulated as:\nmax\n\u03bb\n\nNote that the relay power constraint\n\nPN\n\ni=1\n\nN\nX\n\n\u03bbPiK (\u03bb).\n\n(17)\n\ni=1\n\nPiK (\u03bb) \u2264 P is always guaranteed by the KSBS-based\n\npower allocation, thus needs not to appear explicitly in the relay revenue maximization.\nTo solve the relay pricing problem, we first prove the following lemma.\nLemma 5: The optimal price is inside the interval [blb , b1 ), where blb satisfies the following\nequation:\n\u03c6(blb ) ,\n\nN\nX\ni=1\n\nand\n\nQi |fi |2\nmax 0, \u221a\nbi\n\u001a\n\n\u0012\n\n1\n1\n\u221a \u2212\u221a\nblb\nbi\n\n\u0013\u001b\n\n=P\n\n(18)\n\n( \u0012\n\u0013\u22122 )\nbi P\nblb \u2265 max bi\n+1\ni\nQi |fi |2\n\n(19)\n\nProof: First we can see that \u03c6(blb ) monotonically decreases from \u221e to 0 as blb increases\nfrom 0 to b1 . Thus, the equation (18) has a unique positive solution inside (0, b1 ).\n\u0011\u22122\n\u0010\n. Thus,\nThen we prove (19) by contradiction. Assume that blb < b1 Qb11|fP1 |2 + 1\n\u001a\n\u0012\n\u0013\u001b\nQ1 |f1 |2\n1\n1\n\u221a \u2212\u221a\n\u03c6(blb ) \u2265 max 0, \u221a\n> P,\nb1\nblb\nb1\n\u0011\u22122\n\u0011\u22122\n\u0010\n\u0010\niP\n+\n1\n. Similarly, we can show that blb \u2265 bi Qbi |f\nwhich conflicts (18). So blb \u2265 b1 Q1b1|fP1 |2 + 1\n2\ni|\nfor i = 2, * * * , N. Thus (19) is proved.\n\nNow we show that the optimal price is no less than blb . Using the result in (19) and from\n(11), when the relay power price is blb , i.e., \u03bb = blb , we have\nN\nX\n\nPiI (blb ) = \u03c6(blb ) = P.\n\n(20)\n\ni=1\n\nAlso from (11), PiI (\u03bb) is a continuous and non-increasing function of \u03bb. So\n\nPN\n\ni=1\n\nPiI (\u03bb) is a\n\ncontinuous and non-increasing function of \u03bb. Inside the price range [0, blb ], i.e., \u03bb < blb , we have\nPL\nI\ni=1 Pi (\u03bb) \u2265 P based on (20). With the KSBS-based power allocation, according to Lemma 4,\n\n\f16\n\nPL\n\nPiK (\u03bb) = P . The relay revenue\n\nPiK (\u03bb) = blb P,\n\n(21)\n\nall power of the relay will be allocated to the users , i.e.,\nmaximization when the price is with [0, blb ] becomes:\nmax \u03bb\n\n0\u2264\u03bb\u2264blb\n\nL\nX\n\ni=1\n\ni=1\n\nwhich is reached at \u03bb = blb . So the optimal price in the range [0, blb ] is blb , which shows that\nthe optimal price is no less than blb .\nTo prove the upper bound on the relay price, note that when \u03bb \u2265 b1 , from (11), PiI (\u03bb) = 0\nfor all i, i.e., no user will buy any power from the relay and the relay revenue will be 0. So any\nprice in the range [b1 , +\u221e) is not optimal for the relay revenue, and the optimal price must be\nin the range [blb , b1 ).\nThe value of blb can be obtained by solving the equation in (18). This is a generalized\n\u221a\n\u221a\nwaterfilling problem [32], where 1/ \u03bb is the water-level, 1/ bi is the ground level of User\n\u221a\ni, and Qi |fi |2 / bi are the weights that can be visually interpreted as the width of each patch. In\nthis paper, we can find the value of blb analytically. Notice that \u03c6(blb ) is a decreasing function\nof blb and bi 's are in non-increasing order. We can first find the M such that \u03c6(bM ) < P and\n\u0011\nPM Qi|fi |2 \u0010 1\n1\n\u221a\n\u221a\n\u221a\n\u2212 bi =\n\u03c6(bM +1 ) > P . Thus, blb \u2208 [bM , bM +1 ]. Within this interval, \u03c6(blb ) = i=1 bi\nblb\n\u0011\n\u0010P\n\u0010P\n\u0011\n2\n2\nM Qi |fi |\nM Qi |fi |\n\u221a\n\u221a1 \u2212\n. Thus, from \u03c6(blb ) = P , we have\ni=1\ni=1\nbi\nblb\nbi\nblb =\n\nM\nX\nQi |fi |2\n\u221a\nbi\ni=1\n\n!2\n\nP+\n\nM\nX\nQi |fi |2\ni=1\n\nbi\n\n!\u22122\n\n.\n\n(22)\n\nIn what follows, we solve the optimal relay power price analytically. First, several notation\nare introduced. Recall the ordering of the users based on their bi values in (13) and M is the\nindex such that bM \u2265 blb \u2265 bM +1 . That is, the bi 's of the first M users are no less than blb ,\nwhile the bi 's of the remaining users are no larger than blb . We have shown in Lemma 5 that\nonly the price range [blb , b1 ) needs to be considered for the optimal price. Define \u03b3i , bi for\ni = 1, * * * , M and \u03b3M +1 , blb . Further define \u03931 , [\u03b32 , \u03b31) and \u0393i , [\u03b3i+1 , \u03b3i ] for i =, 2 * * * , M.\nWe thus can have divided the price range [blb , b1 ) into the following M intervals:\n[blb , b1 )=[blb , bM ] \u222a [bM , bM \u22121 ] \u222a * * * \u222a [b3 , b2 ] \u222a [b2 , b1 )\n,\u0393M \u222a \u0393M \u22121 * * * \u222a \u03932 \u222a \u03931 .\n\n(23)\n\n\f17\n\nP\nI\nInside the price range [blb , b1 ), because N\ni=1 Pi (\u03bb) is a non-increasing function of \u03bb and (18),\nP\nI\nK\nI\nwe have N\ni=1 Pi (\u03bb) \u2264 P . Thus, Pi (\u03bb) = Pi (\u03bb) from Lemma 4. We can thus rewrite the price\noptimization problem in (17) into\n\nmax max\n\ni=1,2,***M \u03bb\u2208\u0393i\n\ni\nX\n\n\u03bbPjI (\u03bb).\n\n(24)\n\nj=1\n\nIn (24), we have decomposed the optimization problem into M subproblems, where the ith\nsubproblem is to find the optimal price within the range \u0393i where User 1 to i purchase non-zero\npower from the relay:\nSub-problem i :\n\nmax\n\u03bb\u2208\u0393i\n\ni\nX\n\n\u03bbPjI (\u03bb).\n\n(25)\n\nj=1\n\nThe following proposition is proved to solve the sub-problem.\nProposition 1: For i = 1, 2, * * * , M, define\nPi\nci ,\n\nThe solution to (25) is\n\u03bbi ,\n\np !2\n\n2\nj=1 Qj |fj | / bj\nPi\n2 j=1 Qj |fj |2 /bj\n\n.\n\n(26)\n\n\uf8f1\n\uf8f4\n\uf8f4\n\u03b3\nif ci < \u03b3i+1 ,\n\uf8f4\n\uf8f2 i+1\n\u03b3i\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 c\ni\n\n(27)\n\nif ci > \u03b3i ,\n\nif \u03b3i+1 \u2264 ci \u2264 \u03b3i .\n\nProof: When \u03bb \u2208 \u0393i , for 1 \u2264 j \u2264 i, from (11), User j will ask for\n\nQi |fi |2\n\u221a\nbi\n\n\u0010\n\n\u221a1\n\u03bb\n\n\u2212\n\n\u221a1\nbi\n\n\u0011\n\nunits\n\nof power, and User (i + 1) to User M will ask for zero relay power. Subproblem (25) can be\nrewritten as\n\n(\n\n\u0012\n\u0013)\ni\nX\nQi |fi |2\n1\n1\n\u221a\n\u221a \u2212\u221a\nmax \u03bb\n= max \u03c6R,i (\u03bb),\n(28)\n\u03bb\u2208\u0393i\n\u03bb\u2208\u0393i\nb\nb\n\u03bb\ni\ni\nj=1\n\u0013\n\u0012\n\u0010P\n\u0011\nPi Qj |fj |2 \u221a\nQj |fj |2\ni\n\u221a\nwhere \u03c6R,i (\u03bb) ,\n\u03bb\u2212\n\u03bb. In (28), \u03c6R,i (\u03bb) is the relay revenue\nj=1\nj=1\nbj\nbj\n\ngiven the price \u03bb \u2208 \u0393i . It can be shown through straightforward calculation that d\u03c6R,i (\u03bb)/d\u03bb = 0\nwhen \u03bb = ci , defined in Proposition 1, and\n\nd2 \u03c6R,i (\u03bb)\nd\u03bb2\n\n< 0, when \u03bb \u2208 \u0393i . Therefore, if ci > \u03b3i ,\n\n\u03c6R,i (\u03bb) reaches its maximum at \u03b3i ; if ci < \u03b3i+1 , it reaches its maximum at \u03b3i+1 ; and if \u03b3i+1 \u2264\nci \u2264 \u03b3i , it reaches its maximum at ci .\n\n\f18\n\nWith the subproblems solved, we are ready to find the optimal relay power price. The result\nis given in the following theorem.\nTheorem 1: The optimal relay power price, denoted as \u03bb\u2217 , is\n( i\n!\n)\ni\n2\nX\nX Qj |fj |2 p\nQ\n|f\n|\nj\nj\np\n\u03bbi \u2212\n\u03bb\u2217 = arg max\n\u03bbi ,\n\u03bbi\nb\nb\nj\nj\nj=1\nj=1\n\n(29)\n\nwhere \u03bbi is defined in Proposition 1.\n\nProof: This is a natural result of Proposition 1 and (24).\nWith Theorem 1, we can find the optimal price for the relay power by solving the M\nsubproblems in (24) analytically using Proposition 1, then find the optimal price among the M\nsub-problem solutions that results in the maximum relay revenue. This is written as Algorithm 1.\nWe can see that, after ordering (whose average complexity is N log N), its complexity is linear\nin the number of users in the network.\nAlgorithm 1 Optimal relay power price.\n1: Calculate bi 's using (10). Order the N users such that b1 \u2265 b2 \u2265 * * * \u2265 bN .\n2:\n\nFind M then blb using (22).\n\n3:\n\nInitialize \u03b3i : \u03b3i = bi for i = 1, * * * , M and \u03b3M +1 = blb .\n\n4:\n\nCalculate ci 's for i = 1, * * * , M using (26).\n\n5:\n\nFor i = 1, * * * , M, find \u03bbi using (27).\n\n6:\n\nFind the optimal price \u03bb\u2217 using (29).\n\nPreviously, we have shown that bi is an important factor for the ideal relay power. Here we\ncan see that it is also important for the optimal relay price. We prove the following lemma,\nwhich further reflects the importance of bi .\nLemma 6: If b1 < 4blb , the optimal price for the relay is blb .\nProof: First recall that b1 \u2265 * * * \u2265 bM \u22121 \u2265 bM \u2265 blb . When b1 < 4blb , for i = 1, * * * , M\nand j = 1, * * * , i, we have bj \u2264 b1 < 4\u03b3M +1 \u2264 4\u03b3i+1 . Therefore,\n\n\u221a\n2Qj |fj |2 \u03b3i+1\nQj |fj |2\nQj |fj |2\nQj |fj |2\n\u221a\n\u21d4 p\n<\n,\n< p\nbj\n4\u03b3i+1\nbj\nbj\n\n\f19\n\nand\n\u221a\n\nci =\n\nPi\n\n2\nj=1 Qj |fj | / bj\nP\n2 ij=1 Qj |fj |2 /bj\n\np\n\nP\n\u221a\n2 \u03b3i+1 ij=1 Qj |fj |2 /bj\n\u221a\n<\n= \u03b3i+1\nPi\n2\n2 j=1 Qj |fj | /bj\n\nfor i = 1, * * * , M. From Proposition 1, within the range \u0393i where i = 1, * * * , M, the optimal\nprice is \u03b3i+1 , the lower bound of \u0393i . So the optimal price in the range [\u03b3M +1 , \u03b31 ) is \u03b3M +1, which\nis blb .\nLemma 6 says that when the difference between b1 and blb is small, that is, the conditions\nof the users are not too separate apart, the relay should set its price to be low so all users can\ngain some benefits. On the contrary, when some users have a much higher bi than others, the\nprice will be higher than blb and those users with lower bi 's may not purchase the relay service\nbecause the price is too high compared to the SNR gain they may receive.\nV. D ISCUSSION\nIn this section, we discuss possible implementation of the proposed relay power allocation and\npricing solutions, properties of the power allocation solution, and applications of the proposed\nsolutions to some special network scenarios.\nThe first to discuss is the implementation of the proposed relay power allocation and power\npricing solutions. In practical network applications, to use the proposed scheme, the relay, which\nis the service provider and has perfect and global channel knowledge, first finds the optimal price\nof the relay power using Algorithm 1. With this optimal price, the relay then finds the KSBSbased solution for the relay power allocation problem given in (16). With this implementation,\nwe actually assume that the relay is trustworthy. All users believe that the relay will not change\nthe parameter values (e.g., the CSI); and the relay uses the above procedure to set the price\nand determine the KSBS-based power allocation, and follows the results to help all users in\ntheir transmission. For the relay to know the channel gains from the users to itself, training and\nchannel estimation should be performed at the relay. For the relay to know the channel gains\nfrom itself to the destinations, feedback from the destinations to the relay are required. The\nproposed algorithm is a centralized one instead of distributed.\nNow we discuss properties of the KSBS-based power allocation. When the relay sets its price\nto be the optimal, from the analysis in Section IV-B, all users will be allocated their ideal relay\n\n\f20\n\npowers, PiI (\u03bb), and the individual utilities of the users are maximized. This is the ideal case and\nrequires the relay to have perfect CSI. However, in reality, CSI at the relay is subject to error and\ndelay, in which case, the relay may set a price different to the optimal one. Sometimes, the relay\nmay want to set its price different to the optimal one due to other reasons such as marketing\nconsiderations. Our bargaining game model and KSBS-based power allocation is robust to the\nrelay price fluctuation in the sense that a \"fair\" relay power allocation among the users can still\nbe made. Specifically, if the relay power price is set to be higher than or equal to blb , defined\nin (18), with the KSBS-based power allocation, each user gets its ideal power demand; if the\nrelay power price is set to be lower than blb , no user can get its ideal relay power but the relay\npower will be fairly allocated to the users such that the utility losses of the users are the same\nin the logarithmic scale; and all relay power will allocated.\nFinally, we discuss the application of the proposed solution to two special network scenarios.\nOne network application is the multi-user, single-relay, and single-destination network, also\naddressed as multi-access relay network (MARN) in some papers [10]\u2013[16]. The proposed\nscheme can be directly applied to MARNs by setting g1 = * * * = gN in the network formulation.\nFrom Lemma 2, PiI (\u03bb) is a non-decreasing functions of Qi and fi . Thus, with the relay to\ndestination channel the same for all users, users with better user-relay channels or higher transmit\npowers will be allocated more relay power. Another popular network scenario is the multi-user\nsingle-relay network with no direct links. Our solutions again can be applied straightforwardly\nas the solutions are independent of the direct link.\nVI. S IMULATION R ESULTS\nIn this section, we show the simulated performance of the proposed relay power allocation\nand pricing solutions, and compare them with the sum-rate-optimal power allocation and the\neven power allocation. Sum-rate-optimal power allocation solution is the relay power allocation\namong the users that maximizes the network sum-rate. For the even power allocation, the relay\nallocates 1/N of its total power to each of the N user, and each user decides how much power\nto buy from the relay to maximize its utility. That is, the relay power allocated to User i is\nmin{PiI (\u03bb), P/N}. Two channel models are considered: the Rayleigh flat-fading channel and\n\n\fRelay revenue Total power sold (dB) Relay power price\n\n21\n\nFig. 3.\n\n0.6\n0.4\n0.2\n0\n10\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n25\n20\n15\n10\n10\n15\n\n10\n\n5\n10\n\nRelay power constraint P (dB)\n\nThree-user relay network with Rayleigh fading channels and different relay power constraints.\n\nthe static channel with path-loss only.\n\nA. Network with Rayleigh Flat-Fading Channels\nIn the first numerical experiment, the channels are modeled as i.i.d. Rayleigh flat-fading, i.e.,\nfi , hi , and gi are generated as i.i.d. random variables following the distribution CN (0, 1). We\nconsider a network with three users. The transmit powers of the users are set to be 10 dB. The\nsimulation results follow the same trend for other values of user powers.\nWe first investigate the network performance when the relay power ranges from 10 dB to 40\ndB. This corresponds to the scenario where the total user demand is fixed while the relay power\nsupply increases. We set the relay power price to be the optimal according to Theorem 1. Figure\n3 shows the optimal relay power price, the relay power actually sold, and the maximum relay\nrevenue under different relay power constraints. We can see that when the relay has more power\n\n\f22\n\nto sell, the optimal relay power price is lower, more relay power is sold, and the relay receives\nmore revenue. This complies with one of the laws of supply and demand [33], which says that\nif supply increases and demand remains unchanged, then it leads to lower equilibrium price and\nhigher quantity.\nFigure 4 compares the network sum-rate and fairness of the proposed KSBS-based power\nallocation with those of the sum-rate-optimal power allocation and the even power allocation.\nWe set the relay power price to be the optimal according to Theorem 1. It can be seen that for\nthe system sum-rate, the difference between our algorithm and the sum-rate-optimal solutions is\nwithin 3.5%, while it is within 13% between the sum-rate-optimal and the even power solutions.\nThe proposed solution is about 5 dB superior to the even power allocation. To quantify the\nfairness of different allocation schemes, we use the average value of the normalized difference:\n[maxi (ri ) \u2212 mini (ri )]/ maxi (ri ), where ri is the achievable rate of User i. A smaller difference\nindicates a fairer solution. We can see that our solution achieves similar fairness to the even\npower solution and is fairer than the sum-rate-optimal one.\nNext, we examine the trend of the optimal relay price with an increasing demand. From\nLemma 2, PiI (\u03bb) is a non-decreasing function of |fi |2 . So, we can use an increasing |fi |2 to\nsimulate the increasing user demand. In this numerical experiment, we again consider a threeuser network and model all channels as independent circularly symmetric complex Gaussian\nrandom variables with zero-mean, that is, they are independent Rayleigh flat-fading channels.\nThe variances of all gi 's and hi 's are 1, while the variance of all fi 's ranges from 1 to 20. A\nlarger variance means a higher average value of |fi |2 , which on average means a higher power\ndemand from the users. The transmit power of the users is set to be 10 dB and relay power is\nset to be 20 dB. Figure 5 shows the optimal relay power price, the actual relay power sold, and\nthe maximum relay revenue with different variances of fi . We can see that as the variance of fi\nincreases, the optimal relay price increases, more relay power is sold, and the maximum relay\nrevenue increases. This fits one of the laws of supply and demand, which says, if the supply is\nunchanged and demand increases, it leads to higher equilibrium price and quantity.\nIn the third numerical experiment, we examine the relationship between the optimal relay\nprice and the number of users. We assume that the relay power is fixed to be 20 dB. The user\n\n\f23\n\n2.5\n\nNormalized rate\u2212difference\n\nSum\u2212rate\n\n2.3\n\nKSBS\nSum\u2212rate\u2212optimal\nEven\n\n2\n\n1.7\n\n1.4\n10\n0.47\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\nKSBS\nSum\u2212rate\u2212optimal\nEven\n\n0.43\n\n0.39\n\n0.35\n10\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\nRelay power constraint P (dB)\n\nFig. 4.\n\nSystem sum-rate and fairness of a three-user relay network with Rayleigh-fading channels.\n\npower is fixed as 10 dB but the number of users vary from 5 to 15. All channels are generated\nfollowing the distribution CN (0, 1). Figure 6 shows the optimal relay power price, the total\nrelay power sold, and the maximum relay revenue with different numbers of users. We can see\nthat as the number of users increases, the optimal relay power price increases, the relay power\nactually sold increases, and the maximum relay revenue increases. Figure 6 verifies the same\nlaw as Figure 5, which says, if the supply is unchanged and demand increases, it leads to higher\nequilibrium price and quantity.\n\nB. Static Network with Path-Loss Channel Only\nIn this subsection, we study a static network whose channels are deterministic instead of\nrandom. The network has three users, one relay, and three destinations. The relative positions of\nthe nodes are shown in Figure 7, where the coordinates of User 1-3, the relay, and Destination\n\n\fRelay revenue Toal power sold (dB) Relay power price\n\n24\n\nFig. 5.\n\n0.35\n0.3\n0.25\n0.2\n\n30\n\n0\n\n5\n\n10\ni\n\n15\n\n20\n\n0\n\n5\n\n10\n\n15\n\n20\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n20\n15\n150\n100\n50\n0\n\nVariance of f i\n\nThree-user relay network with Rayleigh fading channels and different variances of fi .\n\n1-3 are (-15, 3), (-10, 0), (-5, -3), (0, 0), and (5, 3), (5, 0), (5, -3), respectively. We consider\nthe path-loss effect of wireless channels only by assuming that the channel gains are inverse\nproportional to the distance squared. In Figure 7, User 1 is the farthest from its destination and\nthus has the worst channel; while User 3 is the closest to its destination and has the best channel.\nThe power of the users is set to be 10 dB and the power of the relay is set to be 15 dB.\nIn Figure 8, the total power sold to the three users, the relay revenue, and the network sumrate are shown as the relay power price varies. Three power allocation solutions are presented:\nthe proposed KSBS-based power allocation, the sum-rate-optimal power allocation, and the\neven power allocation. Note that the sum-rate-optimal allocation solution aims to maximize\nthe network sum-rate, is independent of the relay power price, and allocates all the relay power\nP to the three users. We can observe from Figure 8 that, when the price is higher, with the\nKSBS-based and the even power allocation schemes, the users purchase less power from the\n\n\fRely power price\n\n25\n\n0.25\n\n0.2\n\n0.15\n\nToal power sold (dB)\n\n0.1\n\n5\n\n10\n\n15\n\n5\n\n10\n\n15\n\n10\n\n15\n\n25.5\n25\n24.5\n24\n23.5\n\nRelay revenue\n\n60\n50\n40\n30\n20\n\n5\n\nNumber of users\n\nFig. 6.\n\nThree-user relay network with Rayleigh fading channels and different numbers of users.\n\nUser 1\n\nDestination 1\nRelay\n\nUser 2\nUser 3\n\nFig. 7.\n\nDestination 2\nDestination 3\n\nA three-user static network.\n\nrelay and the total power demand is smaller. For example, using the KSBS-based allocation\nscheme, the total power demand is less than P when the price is higher than 0.0023. Now let\nus look at different price ranges separately. First, we can see that in the price range [0, 0.0007],\nboth KSBS-based and the even power allocation schemes sell all relay power to the users. This\n\n\fTotal power sold (dB)\n\n26\n\n15\n10\nSum\u2212rate\u2212optimal\n\n5\n\nKSBS\nEven\n\n0\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\nx 10\n\nRelay revenue\n\n0.1\nKSBS\nEven\n\n0.05\n\n0\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\nx 10\n\n0.4\n\nSum\u2212rate\n\n7\n\u22123\n\n\u22123\n\n0.35\n0.3\n\nSum\u2212rate\u2212optimal\nKSBS\n\n0.25\n\nEven\n\n0.2\n\n0\n\n1\n\n2\n\n3\n\n4\n\nRelay power pice\n\nFig. 8.\n\n5\n\n6\n\n7\n\u22123\n\nx 10\n\nPower allocation, relay revenue, and sum-rate in three-user relay network with static channels.\n\nis because in this price range, PiI (\u03bb) \u2265 P/3 for i = 1, 2, 3, thus with the even power allocation,\neach user will buy P/3, and all relay power will be sold; for the KSBS-based power allocation,\nP3\nI\ni=1 Pi (\u03bb) \u2265 P , so all power of the relay will be purchased by the users based on Lemma 4.\n\nSecond, when \u03bb \u2265 0.0047, the even power and the KSBS-based schemes give the same power\nallocation results. This is because in this price range, all three users' ideal power demands are\nP\nno more than P/3, that is, PiI (\u03bb) \u2264 P/3 for i = 1, 2, 3 and 3i=1 PiI (\u03bb) \u2264 P . In this scenario,\n\nfrom Lemma 4, both the even power allocation and the KSBS-based schemes assign the ideal\n\npower demand PiI (\u03bb) to User i, and the two schemes have the same performance. And when\n\u03bb is in the range [0.0007, 0.0047], the KSBS-based power allocation demands more relay power\nthan the even power allocation, and thus the relay receives a higher revenue in this range. This\n\n\f27\n\nTABLE I\nACHIEVABLE RATES , NORMALIZED RATE - DIFFERENCE , AND THE SYSTEM SUM - RATE IN THREE USER RELAY NETWORK\nWITH STATIC CHANNELS\n\nSum-rate\n\n0\n\n0.0013\n\n0.0027\n\n0.0047\n\n0.0053\n\n-optimal\n\nEven\n\nKSBS\n\nEven\n\nKSBS\n\nEven\n\nKSBS\n\nEven\n\nKSBS\n\nEven\n\nKSBS\n\nr1\n\n0.0356\n\n0.0498\n\n0.0499\n\n0.0356\n\n0.0356\n\n0.0356\n\n0.0356\n\n0.0356\n\n0.0356\n\n0.0356\n\n0.0356\n\nr2\n\n0.0838\n\n0.1017\n\n0.0994\n\n0.1017\n\n0.0991\n\n0.0823\n\n0.0823\n\n0.0627\n\n0.0627\n\n0.0627\n\n0.0627\n\nr3\n\n0.2802\n\n0.2127\n\n0.2169\n\n0.2127\n\n0.2643\n\n0.2127\n\n0.2727\n\n0.1992\n\n0.1992\n\n0.1777\n\n0.1777\n\nRate-difference\n\n0.8729\n\n0.7658\n\n0.7701\n\n0.8325\n\n0.8652\n\n0.8325\n\n0.8694\n\n0.8211\n\n0.8211\n\n0.7995\n\n0.7995\n\nSum-rate\n\n0.3997\n\n0.3641\n\n0.3662\n\n0.3500\n\n0.3989\n\n0.3306\n\n0.3907\n\n0.2975\n\n0.2975\n\n0.2760\n\n0.2760\n\nis because with the even power allocation, a user cannot request more than 1/3 of the total\nrelay power, while the KSBS-based scheme does not have this constraint and thus enables users\nto request more power. Furthermore, when \u03bb is 0.0027 and the KSBS-based scheme demands\n91% of the relay power to be sold to the users, the relay revenue is maximized. At this relay\npower price, the network sum-rate difference between the proposed KSBS-based solution and\nthe sum-rate-optimal power allocation is only about 2%. The sum-rate difference between the\neven power and the sum-rate-optimal schemes, however, is 23% at the price \u03bb = 0.0047, which\nis the relay revenue maximizing price under the even power allocation. For any relay price, the\nsum-rate difference between the even power and the sum-rate-optimal schemes is no less than\n9%.\nTo further compare the performance of the three schemes, Table I shows each user's achievable\nrate, the normalized rate-difference, and the network sum-rate with the three power allocation\nschemes at the relay power prices 0, 0.0013, 0.0027, 0.0047 and 0.0053. Recall that a smaller\nnormalized rate-difference represents a fairer power allocation. As can be seen from Table I, the\nproposed KSBS-based scheme achieves a smaller normalized rate difference than the sum-rateoptimal solution for all relay prices, while the network sum-rate difference between these two\nschemes is small. It shows that the proposed solution is fairer than the sum-rate-optimal solution\nwith comparable network sum-rate. In sum, Figure 8 and Table I show that for the simulated\nnetwork, the proposed KSBS-based power allocation and relay pricing solutions achieve close-tooptimal sum-rate, in the mean while, they also maximize the relay revenue and achieve fairness\n\n\f28\n\nSum\u2212rate\n\n0.7\n0.6\n\nOptimal\nKSBS\n\n0.5\n0.4\n\nRelay power price\n\n0.3\n10\n\u22123\nx 10\n4\n\n15\n\n20\n\n25\n\n15\n\n20\n\n25\n\n3\n\n2\n\n1\n\n0\n10\n\nRelay power constraint P (dB)\n\nFig. 9.\n\nSum-rate and relay power price in three user relay network with static channels.\n\namong users.\nTo compare the sum-rates of the proposed solutions and the sum-rate-optimal solution, we\nshow in Figure 9 the network sum-rate of the proposed relay pricing and power allocation\nsolutions as the relay power constraint P varies. We can see that when the relay power constraint\nP is small, indicating high demand and low supply, the sum-rate of the proposed solution\nis almost the same as the optimal sum-rate of the network. As the relay power constraint P\nincreases, indicating low demand and high supply, the sum-rate difference between the proposed\nsolutions and the sum-rate-optimal solution increases. When the relay power is 25 dB, the\ndifference is about 6%. The optimal relay price, on the other hand, decreases as P increases.\nThese verifies the same law of supply and demand with Figure 3, which says, if supply increases\nand demand remains unchanged, then it leads to lower equilibrium price.\n\n\f29\n\nVII. C ONCLUSION\nIn this paper, we study the relay power allocation problem in a multi-user single-relay network.\nBy introducing a relay power price, we take into consideration the incentives for cooperation at\nthe relay in helping the users. The Stackelberg game is used to model the interaction between\nthe relay and the users, in which the relay acts as the leader who sets the price of its power\nto gain the maximum revenue and the users act as followers who pay for the relay service.\nTo model the competition among users, a bargaining game and its KSBS are used for a fair\npower allocation. We analytically solve the optimal relay price, while the problem of relay power\nallocation among users is transformed into a convex optimization problem and can be solved\nwith efficient numerical methods. Simulation results show that our solutions reflect the laws of\nsupply and demand, give better user utilities and relay revenue than even power allocation, and\napproach the sum-rate-optimal power allocation in terms of network sum-rate for a wide range\nof network scenarios.\nR EFERENCES\n[1] A. Nosratinia, T. E. Hunter, and A. Hedayat, \"Cooperative communication in wireless networks,\" IEEE Communication\nMagazine, vol. 42, no. 10, pp. 74-80, Oct. 2004.\n[2] A. Gosh and D. R. Wolter, \"Broadband wireless access with WiMax/802.16: current performance benchmarks and future\npotential,\" IEEE Communication Magazine, vol. 43, no. 2, pp. 129-136, Feb. 2005.\n[3] L. N. Laneman, D. N. C. Tse, and G. W. Wornell, \"Cooperative diversity in wireless networks: efficient protocols and\noutage behavior,\" IEEE Transactions on Information Theory, vol. 50, no. 12, pp. 3062-3080, Dec. 2004.\n[4] R. Annavajjala, P. C. Cosman, and L. B. Milstein, \"Statistical channel knowledge-based optimum power allocation for\nrelaying protocols in the high SNR regime,\" IEEE Transactions on Selected Areas in Communications, vol. 25, no. 2,\npp. 292-305, Feb. 2007.\n[5] S. Serbetli and A. Yener, \"Relay assisted F/TDMA ad hoc networks: node classification, power allocation and relaying\nstrategies,\" IEEE Transactions on Selected Areas in Communications, vol. 56, no. 6, pp. 937-947, Feb. 2007.\n[6] K. T. Phan, Le-Ngoc Tho, S. A. Vorobyov, and C. Tellambura, \"Power allocation in wireless multi-user relay networks,\"\nIEEE Transactions on Wireless Communications, vol. 8, no. 5, pp. 1536-1276, May 2009.\n[7] Y. Jing and H. Jafarkhani, \"Network beamforming using relays with perfect channel information,\" IEEE Transactions on\nInformation Theory, vol. 55, no. 11, pp. 2499-2517, June 2009.\n[8] K. T. Phan, Le-Ngoc Tho, S. A. Vorobyov, and C. Tellambura, \"Distributed power allocation strategies for parallel relay\nnetworks,\" IEEE Transactions on Wireless Communications, vol. 7, no. 2, pp. 552-561, Feb. 2008.\n\n\f30\n\n[9] J. Cai, X. Shen, J. W. Mark, and A. S. Alfa, \"Semi-distributed user relaying algorithm for amplify-and-forward wireless\nrelay networks,\" IEEE Transactions on Wireless Communications, vol. 7, no. 4, pp. 1348-1357, Apr. 2008.\n[10] L. Sankaranarayanan, G. Kramer, and N. B. Mandayam, \"Hierarchical sensor networks: capacity theorems and cooperative\nstrategies using the multiple-access relay channel model,\" in Proc. of First IEEE Conf. Sensor Ad Hoc Commun., Santa\nClara, CA, pp. 1-10, 2004.\n[11] L. Sankaranarayanan, G. Kramer, and N. B. Mandayam, \"Capacity theorems for the multiple-access relay channel,\" in\nProc. of 42nd Annual Allerton Conf. Commun. Control Comput., Monticello, IL, pp. 1782-1791, Sep. 2004.\n[12] L. Li, Y. Jing, and H. Jafarkhani, \"Multisource transmission for wireless relay networks with linear complexity,\" IEEE\nTransactions on Signal Processing, vol. 59, pp. 2898-2912, June 2011.\n[13] L. Li, Y. Jing, and H. Jafarkhani, \"Interference cancellation at the relay for multi-user wireless cooperative networks,\"\nIEEE Transactions on Wireless Communications, vol. 10, no. 3, pp. 930-939, Mar. 2011.\n[14] T. Wang and G. B. Giannakis, \"Complex field network coding for multiuser cooperative communications,\" IEEE Journal\non Selected Areas in Communications, vol. 26, no. 3, pp. 561-571, Apr. 2008.\n[15] S. Yao and M. Skoglund, \"Analog network coding mappings in Gaussian multiple-access relay channels,\" IEEE Transactions\non Communications, vol. 58, no. 7, pp. 1973-1983, July 2010.\n[16] G. A. Sidhu and F. Gao, \"Resource allocation for relay aided uplink multiuser OFDMA system,\" in Proc. of Wireless\nCommunications and Networking Conference (WCNC), 2010 IEEE, pp. 1-5, Apr. 2010.\n[17] A. MacKenzie and L. DaSilva, Game theory for wireless engineers, Morgan & Claypool publishers, 2006.\n[18] W. Saad, Z. Han, M. Debbah, and A. Hj\u00f8rungnes, \"A distributed coalition formation framework for fair user cooperation\nin wireless networks,\" IEEE Transactions on Wireless Communications, vol. 8, no. 9, pp. 4580-4593, Sep. 2009.\n[19] Z. Zhang, J. Shi, H. Chen, M. Guizani, and P. Qiu, \"A cooperation strategy based on Nash bargaining solution in cooperative\nrelay networks,\" IEEE Transactions on Vehicular Technology, vol. 57, no. 4, pp. 2570-2577, July 2008.\n[20] G. Zhang, H. Zhang, L. Zhao, W. Wang, and L. Cong, \"Fair resource sharing for cooperative relay networks using Nash\nbargaining solutions,\" IEEE Communications Letters, vol. 13, no. 6, pp. 381-383, June 2009.\n[21] S. Ren and M. van der Schaar, \"Distributed power allocation in multi-user multi-channel cellular relay networks,\"IEEE\nTransactions on Wireless Communications, vol. 9, no. 6, pp. 1952-1964, June 2010.\n[22] N. Shastry and R. S. Adve, \"Stimulating cooperative diversity in wireless ad hoc networks through pricing,\" in Proc. IEEE\nInt. Conf. Commun., Jun. 2006.\n[23] O. Ileri, S. C. Mau, and N. B. Mandayam, \"Pricing for enabling forwarding in self-configuring ad hoc networks,\" IEEE\nJournal on Selected Areas in Communications, vol. 23, no. 1, pp. 151-162, Jan. 2005.\n[24] B. Wang, Z. Han, and K. J. R. Liu, \"Distributed relay selection and power control for multiuser cooperative communication\nnetworks using Stackelberg Game,\" IEEE Transactions on Mobile Computing, vol. 8, no. 7, pp. 975-990, July 2009.\n[25] S. Ren and M. van der Schaar, \"Pricing and distributed power control in wireless relay networks,\" IEEE Transactions on\nSignal Processing, vol. 59, no. 6, pp. 2913-2926, June 2011.\n[26] M. O. Hasna and M. S. Alouini, \"End-to-end performance of transmission systems with relays over Rayleigh-fading\nchannels,\" IEEE Transactions on Wireless Communications, vol. 2, no. 6, pp. 1126-1131, Nov. 2003.\n[27] M. Hasna and M. S. Alouini, \"Harmonic mean and end-to-end performance of transmission systems with relays,\" IEEE\nTransactions on Communications, vol. 52, no. 1, pp. 130-135, Jan. 2004.\n\n\f31\n\n[28] D. Fudenberg and J. Tirole, Game Theory. MIT Press, 1991.\n[29] E. Kalai and M. Smorodinsky, \"Other solutions to Nash's bargaining problem,\" Econometrica, vol. 43, pp. 513-518, May\n1975.\n[30] S. Boyd and L. Vandenberghe, Convex optimization. Cambridge university Press, 2004.\n[31] A. Muthoo, Bargaining theory with applications. Cambridge university Press, 1999.\n[32] D. P. Palomar and J. R. Fonollosa, \"Practical algorithms for a family of waterfilling solutions,\" IEEE Transactions on\nSignal Processing, vol. 53, no. 2, pp. 686-695, Feb. 2005.\n[33] D. Besanko and R. R. Braeutigam Microeconomics. Wiley Press, 2005.\n\n\f"}