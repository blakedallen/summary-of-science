{"id": "http://arxiv.org/abs/0705.4556v4", "guidislink": true, "updated": "2009-08-20T12:00:23Z", "updated_parsed": [2009, 8, 20, 12, 0, 23, 3, 232, 0], "published": "2007-05-31T09:59:52Z", "published_parsed": [2007, 5, 31, 9, 59, 52, 3, 151, 0], "title": "Quantization of symplectic vector spaces over finite fields", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0705.3685%2C0705.2213%2C0705.4095%2C0705.4157%2C0705.3058%2C0705.0462%2C0705.3283%2C0705.0858%2C0705.2802%2C0705.0058%2C0705.3754%2C0705.3084%2C0705.1404%2C0705.0334%2C0705.3860%2C0705.2419%2C0705.4478%2C0705.1121%2C0705.4007%2C0705.0117%2C0705.3488%2C0705.2117%2C0705.2668%2C0705.3452%2C0705.1355%2C0705.0932%2C0705.3403%2C0705.1150%2C0705.2925%2C0705.1030%2C0705.4627%2C0705.3157%2C0705.3407%2C0705.1148%2C0705.0646%2C0705.2289%2C0705.4505%2C0705.3505%2C0705.0172%2C0705.3626%2C0705.1560%2C0705.3649%2C0705.0262%2C0705.0417%2C0705.2453%2C0705.1887%2C0705.4518%2C0705.1433%2C0705.2105%2C0705.3167%2C0705.1180%2C0705.1529%2C0705.2971%2C0705.2702%2C0705.2836%2C0705.3939%2C0705.4556%2C0705.4062%2C0705.1959%2C0705.3527%2C0705.2983%2C0705.1345%2C0705.0322%2C0705.1052%2C0705.4020%2C0705.3870%2C0705.2729%2C0705.1407%2C0705.2991%2C0705.0792%2C0705.3660%2C0705.1536%2C0705.0762%2C0705.0989%2C0705.3176%2C0705.1740%2C0705.2257%2C0705.2121%2C0705.1982%2C0705.3842%2C0705.0275%2C0705.1587%2C0705.2976%2C0705.3064%2C0705.2354%2C0705.4131%2C0705.2393%2C0705.2709%2C0705.2432%2C0705.4151%2C0705.1146%2C0705.1847%2C0705.4106%2C0705.1579%2C0705.0751%2C0705.2630%2C0705.2839%2C0705.3720%2C0705.1935%2C0705.1714%2C0705.1042&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Quantization of symplectic vector spaces over finite fields"}, "summary": "In this paper, we construct a quantization functor, associating a complex\nvector space H(V) to a finite dimensional symplectic vector space V over a\nfinite field of odd characteristic. As a result, we obtain a canonical model\nfor the Weil representation of the symplectic group Sp(V). The main new\ntechnical result is a proof of a stronger form of the Stone-von Neumann\nproperty for the Heisenberg group. Our result answers, for the case of the\nHeisenberg group, a question of Kazhdan about the possible existence of a\ncanonical vector space attached to a coadjoint orbit of a general unipotent\ngroup over finite field.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0705.3685%2C0705.2213%2C0705.4095%2C0705.4157%2C0705.3058%2C0705.0462%2C0705.3283%2C0705.0858%2C0705.2802%2C0705.0058%2C0705.3754%2C0705.3084%2C0705.1404%2C0705.0334%2C0705.3860%2C0705.2419%2C0705.4478%2C0705.1121%2C0705.4007%2C0705.0117%2C0705.3488%2C0705.2117%2C0705.2668%2C0705.3452%2C0705.1355%2C0705.0932%2C0705.3403%2C0705.1150%2C0705.2925%2C0705.1030%2C0705.4627%2C0705.3157%2C0705.3407%2C0705.1148%2C0705.0646%2C0705.2289%2C0705.4505%2C0705.3505%2C0705.0172%2C0705.3626%2C0705.1560%2C0705.3649%2C0705.0262%2C0705.0417%2C0705.2453%2C0705.1887%2C0705.4518%2C0705.1433%2C0705.2105%2C0705.3167%2C0705.1180%2C0705.1529%2C0705.2971%2C0705.2702%2C0705.2836%2C0705.3939%2C0705.4556%2C0705.4062%2C0705.1959%2C0705.3527%2C0705.2983%2C0705.1345%2C0705.0322%2C0705.1052%2C0705.4020%2C0705.3870%2C0705.2729%2C0705.1407%2C0705.2991%2C0705.0792%2C0705.3660%2C0705.1536%2C0705.0762%2C0705.0989%2C0705.3176%2C0705.1740%2C0705.2257%2C0705.2121%2C0705.1982%2C0705.3842%2C0705.0275%2C0705.1587%2C0705.2976%2C0705.3064%2C0705.2354%2C0705.4131%2C0705.2393%2C0705.2709%2C0705.2432%2C0705.4151%2C0705.1146%2C0705.1847%2C0705.4106%2C0705.1579%2C0705.0751%2C0705.2630%2C0705.2839%2C0705.3720%2C0705.1935%2C0705.1714%2C0705.1042&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper, we construct a quantization functor, associating a complex\nvector space H(V) to a finite dimensional symplectic vector space V over a\nfinite field of odd characteristic. As a result, we obtain a canonical model\nfor the Weil representation of the symplectic group Sp(V). The main new\ntechnical result is a proof of a stronger form of the Stone-von Neumann\nproperty for the Heisenberg group. Our result answers, for the case of the\nHeisenberg group, a question of Kazhdan about the possible existence of a\ncanonical vector space attached to a coadjoint orbit of a general unipotent\ngroup over finite field."}, "authors": ["Shamgar Gurevich", "Ronny Hadani"], "author_detail": {"name": "Ronny Hadani"}, "author": "Ronny Hadani", "arxiv_comment": "Results obtained: March 2005 (under the direction of Ph.D. advisor\n  Joseph Bernstein, Tel-Aviv, Israel) Keywords: Strong Stone-von Neumann\n  theorem, canonocal Hilbert space, quantization functor, Weil representation", "links": [{"href": "http://arxiv.org/abs/0705.4556v4", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0705.4556v4", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.RT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.RT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.QA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.SG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0705.4556v4", "affiliation": "University of Chicago", "arxiv_url": "http://arxiv.org/abs/0705.4556v4", "journal_reference": "Journal of Symplectic Geometry, Volume 7, Number 4, 1-28, 2009", "doi": null, "fulltext": "arXiv:0705.4556v4 [math.RT] 20 Aug 2009\n\nQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER\nFINITE FIELDS\nSHAMGAR GUREVICH AND RONNY HADANI\nAbstract. In this paper, we construct a quantization functor, associating a\ncomplex vector space H(V ) to a finite dimensional symplectic vector space V\nover a finite field of odd characteristic. As a result, we obtain a canonical\nmodel for the Weil representation of the symplectic group Sp (V ). The main\nnew technical result is a proof of a stronger form of the Stone\u2013von Neumann\nproperty for the Heisenberg group H(V ). Our result answers, for the case of\nthe Heisenberg group, a question of Kazhdan about the possible existence of\na canonical vector space attached to a coadjoint orbit of a general unipotent\ngroup over finite field.\n\n0. Introduction\nQuantization is a fundamental procedure in mathematics and in physics. Although it is widely used in both contexts, its precise nature remains to some extent unclear. From the physical side, quantization is the procedure by which one\nassociates to a classical mechanical system its quantum counterpart. From the\nmathematical side, it seems that quantization is a way to construct interesting\nvector spaces out of symplectic manifolds, suggesting a method for constructing\nrepresentations of the corresponding groups of symplectomorphisms [15, 17].\n0.1. Main results.\n0.1.1. Quantization functor. In this paper, we construct a quantization functor\nH : Symp \u2192 Vect,\nwhere Symp denotes the (groupoid) category whose objects are finite dimensional\nsymplectic vector spaces over the finite field Fq , and morphisms are linear isomorphisms of symplectic vector spaces and Vect denotes the category of finite dimensional complex vector spaces.\n0.1.2. Canonical model for the Weil representation. As a consequence, for a fixed\nsymplectic vector space V \u2208 Symp, we obtain, by functoriality, a homomorphism\nH : Sp (V ) \u2192 GL (H (V )) ,\nwhich is isomorphic to the Weil representation [19] of the group Sp (V ) and we refer\nto it as the canonical model of the Weil representation.\nRemark 0.1.1. The symplectic group acts on the canonical model H (V ) in a\nnatural way. This should be contrasted with the classical approach [7, 13, 19] in\nwhich one constructs a projective representation of the symplectic group (invoking\nthe Stone\u2013von Neumann theorem) and then deriving the linear action, implicitly,\nby invoking the fact that every projective representation of Sp (V ) can be linearized.\n1\n\n\f2\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n0.1.3. Properties of the quantization functor. We show that the functor H is a\nmonoidal functor, compatible with duality and with the operation of linear symplectic reduction. The last compatibility means that given V \u2208 Symp and a pair\nI \u25e6 = (I, oI ), where I \u2282 V is an isotropic subspace and oI \u2208 \u2227top I is a non-zero\nvector1, there exists a natural isomorphism\n\u0001\n(0.1)\nHI (V ) \u2243 H I \u22a5 /I ,\n\nwhere HI (V ) stands for the subspace of I-invariant vectors in H (V ) (an operation\nwhich will be made precise in the sequel) and I \u22a5 /I \u2208 Symp is the symplectic\nreduction of V with respect to I [3]. A particular situation is when I = L is a\nLagrangian subspace. In this situation, L\u22a5 /L = 0 and (0.1) yields an isomorphism\nHL (V ) \u2243 H (0) = C, which associates to 1 \u2208 C a well defined vector in H (V ).\nThis establishes a mechanism which associates to every pair L\u25e6 = (L, oL ) a well\ndefined vector vL\u25e6 \u2208 HV . To the best of our knowledge (cf. [11, 20, 21]), this kind\nof structure, which exists in the setting of the Weil representation of the group\nSp (V ) , was not observed before.\n0.1.4. The strong Stone\u2013von Neumann theorem. The main technical result of this\npaper is a proof ([8, 12] unpublished) of a strong form of the Stone\u2013von Neumann\ntheorem for the Heisenberg group over Fq (see also the survey [9]). We supply two\nproofs; in the first proof we use only basic considerations from linear algebra and\nin the second proof we construct an algebra geometric object (an l-adic perverse\nWeil sheaf) which is interesting in its own sake and in particular implies the strong\nStone\u2013von Neumann theorem.\nWe devote the rest of the introduction to an intuitive explanation of the main\nideas and results of this paper.\n0.2. The Heisenberg representation.\n0.2.1. The Heisenberg group. Let (V, \u03c9) be a 2n-dimensional symplectic vector\nspace over the finite field Fq . The vector space V considered as an abelian group\nadmits a non-trivial central extension called the Heisenberg group\n0 \u2192 Fq \u2192 H (V ) \u2192 V \u2192 0.\nChoosing a section V \u2192 H (V ), the Heisenberg group can be presented as\nH (V ) = V \u00d7 Fq with the center given by Z = Z(H) = {(0, z) : z \u2208 Fq }. The\nsymplectic group Sp (V ) acts on H (V ) by group automorphisms via its tautological action on the V -coordinate.\n0.2.2. The Heisenberg representation. The representation theory of the Heisenberg\ngroup is relatively simple. Given a non-trivial central character \u03c8 : Z \u2192 C\u00d7 , there\nexist a unique (up to isomorphism) irreducible representation\n\u03c0 : H (V ) \u2192 GL(H),\nsuch that the center acts by \u03c8, i.e., \u03c0 |Z = \u03c8 * IdH . This is the content of the\ncelebrated Stone\u2013von Neumann Theorem. The representation \u03c0 is referred to as\nthe Heisenberg representation.\n1We will call the pair I \u25e6 = (I, o ) an oriented isotropic subspace.\nI\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n3\n\n0.2.3. Models of the Heisenberg representation. The Heisenberg representation admits a family of models which are associated with oriented Lagrangian subspaces\nin V [1, 18]. An oriented Lagrangian subspace is a pair L\u25e6 = (L, oL ), where L \u2282 V\nis a Lagrangian subspace and oL \u2208 \u2227top L is a non-zero vector. Every oriented\nLagrangian L\u25e6 is associated with a model\n\u03c0 L\u25e6 : H (V ) \u2192 GL (HL\u25e6 ) ,\nwhere the vector space HL\u25e6 is the space of functions C (L\\H (V ) , \u03c8), consisting of\nfunctions f : H (V ) \u2192 C such that f (z * l * h) = \u03c8 (z) f (h), for every z \u2208 Z, l \u2208 L\nand the action \u03c0 L\u25e6 is given by right translation.\nRemark 0.2.1. The definition of the model (\u03c0 L\u25e6 , H (V ) , HL\u25e6 ) does not depend on\nthe orientation oL . The role of the orientation will appear later when we explain\nthe relation between different models-the strong Stone\u2013von Neumann property.\n0.3. The strong Stone\u2013von Neumann property. The collection of models\n{HL\u25e6 } can be thought of as a vector bundle H on the set OLag (V ) of oriented\nLagrangians, with fibers H|L\u25e6 = HL\u25e6 . The vector bundle H is equipped with the\nfollowing tautological structures:\n\u2022 An action of the group H (V ) on each fiber.\n\u2022 An Sp (V )-equivariant structure.\nThe content of the strong Stone\u2013von Neumann theorem is that H admits a\ncanonical trivialization:\nTheorem 0.3.1 (Strong Stone\u2013von Neumann theorem). There exists a canonical system of intertwining morphisms TM \u25e6 ,L\u25e6 \u2208 HomH(V ) (HL\u25e6 , HM \u25e6 ), for every\n2\n(M \u25e6 , L\u25e6 ) \u2208 OLag (V ) , satisfying the following multiplicativity property\nTN \u25e6 ,M \u25e6 \u25e6 TM \u25e6 ,L\u25e6 = TN \u25e6 ,L\u25e6 ,\nfor every (N \u25e6 , M \u25e6 , L\u25e6 ) \u2208 OLag (V )3 .\nRemark 0.3.2. The definition of the trivialization {TM \u25e6 ,L\u25e6 } depends on the orientation structure.\n0.3.1. Canonical vector space. The vector space H (V ) is the space of \"horizontal\nsections\" of H\nH (V ) = \u0393hor (OLag (V ) , H) ,\nwhere a vector in H (V ) is a compatible system (vL\u25e6 \u2208 HL\u25e6 : L\u25e6 \u2208 OLag (V )) such\n2\nthat TM \u25e6 ,L\u25e6 (vL\u25e6 ) = vM \u25e6 , for every (M \u25e6 , L\u25e6 ) \u2208 OLag (V ) . The symplectic group\nSp (V ) acts on the vector space H (V ) in an obvious manner. We denote this action\nby\n\u03c1V : Sp (V ) \u2192 GL (H (V )) ,\nand refer to it as the canonical model of the Weil representation.\nWe proceed to explain an algebra geometric construction of the trivialization\n{TM \u25e6 ,L\u25e6 }.\n0.3.2. Canonical trivialization. The construction will be close in spirit to the procedure of \"analytic continuation\". Let U2 \u2282 OLag (V )2 denote the subset consisting\n2\nof pairs (M \u25e6 , L\u25e6 ) \u2208 OLag (V ) such that M + L = V . On the set U2 , the canonical intertwining morphisms are given by a uniform explicit formula-ansatz. The\nproblem is how to extend this formula to the set of all pairs. An appealing way to\ndo this is through the use of algebraic geometry.\n\n\f4\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n0.3.3. Kernel functions. Every intertwining morphism TM \u25e6 ,L\u25e6 can be uniquely presented by a function KM \u25e6 ,L\u25e6 \u2208 C (M \\H (V ) /L, \u03c8), which we refer to as the canonical kernel function. The collection of kernel functions {KM \u25e6 ,L\u25e6 : (M \u25e6 , L\u25e6 ) \u2208 U2 }\ncan be thought of as a single function KO on O = U2 \u00d7 H (V ) which is given by\nKO (M \u25e6 , L\u25e6 , \u2212) = KM \u25e6 ,L\u25e6 (\u2212), for every (M \u25e6 , L\u25e6 ) \u2208 U2 . The problem now trans2\nlates to the problem of extending the function KO to the set X = OLag (V ) \u00d7\nH (V ). To this end, we invoke the procedure of geometrization.\n0.4. Geometrization. A general ideology due to Grothendieck is that any meaningful set-theoretic object is governed by a more fundamental algebra-geometric\none. The procedure by which one translate from the set theoretic setting to algebraic geometry is called geometrization, which is a formal procedure by which\nsets are replaced by algebraic varieties and functions are replaced by certain sheaftheoretic objects.\nThe precise setting consists of:\n\u2022 A set X = X (Fq ) of rational points of an algebraic variety X, defined over\nFq .\n\u2022 A complex valued function f \u2208 C (X) governed by an l-adic Weil sheaf F .\nThe variety X is a space equipped with an automorphism F r : X \u2192 X (called\nFrobenius), such that the set X is naturally identified with the set of fixed points\nX = XF r .\nThe sheaf F can be thought of as a vector bundle on the variety X, equipped\nwith an endomorphism \u03b8 : F \u2192 F which lifts F r.\nThe relation between the function f and the sheaf F is called Grothendieck's\nsheaf-to-function correspondence: Given a point x \u2208 X, the endomorphism \u03b8 restricts to an endomorphism \u03b8x : F|x \u2192 F|x of the fiber F|x . The value of f on the\npoint x is given by\nf (x) = f F (x) = T r(\u03b8 x : F|x \u2192 F|x ).\n0.5. Solution to the extension problem. The extension problem of the function\nKO fits nicely to the geometrization setting:\n\u2022 The sets O, X are sets of rational points of corresponding algebraic varieties\nO = O (Fq ) and X = X (Fq ). In addition, the imbedding j : O \u0592\u2192 X is\ninduced from an open imbedding j : O \u0592\u2192 X.\n\u2022 The function KO comes from a Weil sheaf KO on the variety O\nK O = f KO .\nThe extension problem is solved as follows: First extend the sheaf KO to a sheaf\nK on the variety X and then take the corresponding function K = f K , which\nestablishes the desired extension. The reasoning behind this strategy is that in the\nrealm of sheaves there exist several functorial operations of extension, probably the\nmost interesting one is called perverse extension [2]. The sheaf K is defined as the\nperverse extension of KO .\n0.6. Structure of the paper. Apart from the introduction, the paper consists of\ntwo sections and two appendices.\nIn Section 1, the classical construction of the Weil representation is described.\nWe begin with the definition of the Heisenberg group and the Heisenberg representation, then we briefly describe the classical construction of the Weil representation.\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n5\n\nIn Section 2 we develop the framework of canonical vector spaces. Specifically, we\nintroduce the canonical system of intertwining morphisms between different models of the Heisenberg representation and formulate the strong Stone\u2013von Neumann\nproperty of the Heisenberg representation (Theorem 2.2.3). Using Theorem 2.2.3,\nwe construct a quantization functor H. We finish this section by showing that H\nis a monoidal functor and it is compatible with duality and the operation of linear\nsymplectic reduction. In section 3, we construct a sheaf theoretic counterpart of the\ncanonical system of intertwining morphisms. Finally, in Appendix A, we provide\nproofs for all statements which appear in the body of the paper.\n0.7. Acknowledgements. We would like to thank our scientific advisor J. Bernstein for his interest and guidance, and for his idea about the notion of oriented\nLagrangian subspace. It is a pleasure to thank D. Kazhdan for sharing with us his\nthoughts [14] about the possible existence of canonical Hilbert spaces. We thank A.\nWeinstein for several very influential discussions and for the opportunity to present\nthis work in the symplectic geometry seminar, Berkeley, February 2007. We would\nlike to acknowledge M. Vergne for the encouragement to write this paper. Finally,\nwe would like to thank O. Ceyhan and the organizers of the conference AGAQ,\nheld in Istanbul during June 2006, for the invitation to present this work.\n\n1. The Weil representation\n1.1. The Heisenberg group. Let (V, \u03c9) be a 2n\u2013dimensional symplectic vector\nspace over the finite field Fq , where q is odd. Considering V as an abelian group, it\nadmits a non\u2013trivial central extension H (V ) called the Heisenberg group, namely\n0 \u2192 Fq \u2192 H (V ) \u2192 V \u2192 0.\nConcretely, the group H (V ) can be presented as the set H (V ) = V \u00d7 Fq with\nthe multiplication given by\n(v, z) * (v \u2032 , z \u2032 ) = (v + v \u2032 , z + z \u2032 + 21 \u03c9(v, v \u2032 )).\nThe center of H (V ) is Z = ZH(V ) = {(0, z) : z \u2208 Fq }. The symplectic group\nSp (V ) = Sp(V, \u03c9) acts by automorphism on H (V ) through its tautological action\non the V \u2013coordinate.\n1.2. The Heisenberg representation . One of the most important attributes of\nthe group H (V ) is that it admits, principally, a unique irreducible representation-\nthis is the Stone\u2013von Neumann property (S-vN for short). The precise statement\ngoes as follows. Let \u03c8 : Z \u2192 C\u00d7 be a non-trivial character of the center. For\n2\u03c0i\nexample we can take \u03c8 (z) = e p tr(z) .\nTheorem 1.2.1 (Stone\u2013von Neuman property). There exists a unique (up to isomorphism) irreducible unitary representation (\u03c0, H, H) with the center acting by \u03c8,\ni.e., \u03c0 |Z = \u03c8 * IdH .\nThe representation \u03c0 which appears in the above theorem will be called the\nHeisenberg representation.\n\n\f6\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n1.3. The Weil representation. A direct consequence of Theorem 1.2.1 is the existence of a projective representation e\n\u03c1 : Sp (V ) \u2192 P GL(H). The construction of\ne\n\u03c1 out of the Heisenberg representation \u03c0 is due to Weil [19] and it goes as follows.\nConsidering the Heisenberg representation \u03c0 and an element g \u2208 Sp (V ), one can define a new representation \u03c0 g acting on the same Hilbert space via \u03c0 g (h) = \u03c0 (g (h)).\nClearly both \u03c0 and \u03c0 g have the same central character \u03c8 hence by Theorem 1.2.1\nthey are isomorphic. Since the space HomH(V ) (\u03c0, \u03c0 g ) is one-dimensional, choosing\nfor every g \u2208 Sp (V ) a non-zero representative e\n\u03c1(g) \u2208 HomH(V ) (\u03c0, \u03c0 g ) gives the\nrequired projective representation. In more concrete terms, the projective representation e\n\u03c1 is characterized by the formula\n\u0001\n(1.1)\ne\n\u03c1 (g) \u03c0 (h) e\n\u03c1 g \u22121 = \u03c0 (g (h)) ,\nfor every g \u2208 Sp (V ) and h \u2208 H (V ).\nIt is known [7, 13] that\n\nTheorem 1.3.1 (The Weil representation). There exists a linear representation\n\u03c1 : Sp (V ) \u2192 GL (H) lying over e\n\u03c1.\n\nIn the next section we will show that the linear representation \u03c1 appears as a\nconsequence of the existence of a canonical vector space H(V ) associated with the\nsymplectic vector space V.\n2. Canonical vector space\n2.1. Models of the Heisenberg representation. Although the representation \u03c0\nis unique, it admits a multitude of different models (realizations), in fact this is one\nof its most interesting and powerful attributes. These models appear in families,\nin this work we will be interested in a particular family of such models which are\nassociated with Lagrangian subspaces in V .\nLet Lag (V ) denote the set of Lagrangian subspaces in V . Let C (H (V ) , \u03c8)\ndenote the subspace of functions f \u2208 C (H (V )) satisfying the equivariance property\nf (z * h) = \u03c8 (z) f (h) for every z \u2208 Z.\nWe associate with each Lagrangian subspace L \u2208 Lag (V ) a model (\u03c0 L , H (V ) , HL )\nof the Heisenberg representation as follows: The vector space HL consists of functions f \u2208 C (H (V ) , \u03c8) satisfying f (l * h) = f (h) for every l \u2208 L and the Heisenberg\naction is given by right translation \u03c0 L (h) [f ] (h\u2032 ) = f (h\u2032 * h) for every f \u2208 HL .\nDefinition 2.1.1. An oriented Lagrangian L\u25e6 is a pair L\u25e6 = (L, oL ), where L \u2208\nVtop\nL is a non-zero vector.\nLag (V ) and oL \u2208\n\nLet us denote by OLag (V ) the set of oriented Lagrangian subspaces in V .\nSimilarly, we associate with each oriented Lagrangian L\u25e6 \u2208 OLag (V ) a model\n(\u03c0 L\u25e6 , H, HL\u25e6 ) of the Heisenberg representation, taking HL\u25e6 = HL and \u03c0 L\u25e6 = \u03c0 L .\nThe collection of models {HL\u25e6 } forms a vector bundle H (V ) \u2192 OLag (V ) with\nfibers HL\u25e6 = HL\u25e6 . The vector bundle H = H (V ) is equipped with an additional\nstructure of an action \u03c0 L\u25e6 of H (V ) on each fiber. This suggests the following\nterminology:\nk\n\nDefinition 2.1.2. Let k \u2208 N. An H (V ) -vector bundle on OLag (V ) is a vector\nk\nbundle E \u2192 OLag (V ) equipped with a fiberwise action \u03c0 L\u25e6 : H (V ) \u2192 GL(EL\u25e6 ),\n\u25e6\nfor every L \u2208 OLag (V ).\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n7\n\nIn addition, our H is equipped with a natural Sp (V )-equivariant structure,\ndefined as follows: For every g \u2208 Sp (V ), let g \u2217 H be the H (V )-vector bundle\nwith fibers g \u2217 HL\u25e6 = HgL\u25e6 and the g-twisted Heisenberg action \u03c0 gL\u25e6 : H (V ) \u2192\nGL (HgL\u25e6 ), given by \u03c0 gL\u25e6 (h) = \u03c0 gL\u25e6 (g (h)). The equivariant structure is the isomorphisms of H (V )-vector bundles\n\u03b8g : g \u2217 H \u2192 H,\n\n(2.1)\n\nwhich on the level of fibers, sends f \u2208 HgL\u25e6 to f \u25e6 g \u2208 HL\u25e6 .\n2.2. The strong Stone\u2013von Neumann property . By Theorem 1.2.1, for every\n2\npair (M \u25e6 , L\u25e6 ) \u2208 OLag (V ) , the models HL\u25e6 and HM \u25e6 are isomorphic as representations of H (V ), moreover, since the Heisenberg representation is irreducible, the vec\u25e6\n) of intertwining morphisms is one dimensional. Roughly,\ntor space HomH (HL\u25e6 , HM\nthe strong Stone\u2013von Neumann property asserts the existence of a distinguished element FM \u25e6 ,L\u25e6 \u2208 HomH (HL\u25e6 , HM \u25e6 ), for every pair (M \u25e6 , L\u25e6 ) \u2208 OLag (V )2 . The\nprecise statement involves the following definition:\nk\n\nDefinition 2.2.1. Let E \u2192 OLag (V ) be an H (V ) -vector bundle. A trivialization\nof E is a system of intertwining isomorphisms {EM \u25e6 ,L\u25e6 \u2208 HomH(V )k (EL\u25e6 , EM \u25e6 ) :\n2\n\n(M \u25e6 , L\u25e6 ) \u2208 OLag (V ) } satisfying the following multiplicativity condition\nEN \u25e6 ,M \u25e6 \u25e6 EM \u25e6 ,L\u25e6 = EN \u25e6 ,L\u25e6 ,\nfor every N \u25e6 , M \u25e6 , L\u25e6 \u2208 OLag (V ).\nk\n\nRemark 2.2.2. Intuitively, a trivialization of a H (V ) -vector bundle E \u2192 OLag (V )\ncan be thought of as a flat connection, compatible with the Heisenberg action and\nadmitting a trivial monodromy.\nTheorem 2.2.3 (The strong S-vN property). The H (V )-vector bundle H admits\na natural trivialization {TM \u25e6 ,L\u25e6 }.\nThe intertwining morphisms TM \u25e6 ,L\u25e6 in the above theorem will be referred to as\nthe canonical intertwining morphisms.\n2.3. A linear algebra proof of the strong S-vN property. The proof of Theorem 2.2.3 proceeds in several steps. First we note that the vector bundle H ad2\nmits a natural partial trivialization: Let us denote by U2 \u2282 OLag (V ) the subset\n2\n\u25e6\n\u25e6\nconsisting of pairs of oriented Lagrangians (M , L ) \u2208 OLag (V ) which are in\ngeneral position, that is L + M = V . For every (M \u25e6 , L\u25e6 ) \u2208 U2 , define the intertwining morphisms\n(2.2)\n\nTM \u25e6 ,L\u25e6 = AM \u25e6 ,L\u25e6 * FM \u25e6 ,L\u25e6 ,\n\nwhere FM \u25e6 ,L\u25e6 : HL\u25e6 \u2192 HM \u25e6 is the averaging morphism given by\nX\nFM \u25e6 ,L\u25e6 [f ] (h) =\nf (m * h) ,\nm\u2208M\n\nfor every f \u2208 HL\u25e6 and AM \u25e6 ,L\u25e6 is a normalization constant given by\n(2.3)\n\nn\nAM \u25e6 ,L\u25e6 = (G1 /q)n \u03c3((\u22121)( 2 ) \u03c9\u2227 (oL , oM )),\n\nwhere\n\u2022 \u03c3 is the unique quadratic character (also called the Legendre character) of\nthe multiplicative group Gm = F\u00d7\nq .\n\n\f8\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n\u2022 G1 is the one dimensional Gauss sum\nX\n\u03c8( 21 z 2 ).\nG1 =\nz\u2208Fq\n\n\u2022 \u03c9\u2227 :\n\nVtop\n\nL\u00d7\n\nVtop\n\nM \u2192 Fq is the pairing induced by the symplectic form.\n\nLet us denote by U3 \u2282 OLag (V )3 the subset consisting of triples of oriented\nLagrangians (N \u25e6 , M \u25e6 , L\u25e6 ) which are in general position pairwisely.\nProposition 2.3.1. For every (N \u25e6 , M \u25e6 , L\u25e6 ) \u2208 U3\nTN \u25e6 ,L\u25e6 = TN \u25e6 ,M \u25e6 \u25e6 TM \u25e6 ,L\u25e6 .\nFor a proof, see Appendix A.\nTheorem 2.2.3, now, follows from\nProposition 2.3.2. The sub-system {TM \u25e6 ,L\u25e6 : (M \u25e6 , L\u25e6 ) \u2208 U2 } extends in a unique\nmanner to a trivialization of H.\nFor a proof, see Appendix A.\nWe will refer to {TM \u25e6 ,L\u25e6 } as the system of canonical intertwining morphisms.\n2.4. Explicit formulas for the canonical intertwining morphisms. The canonical intertwining morphism TM \u25e6 ,L\u25e6 can be written in a closed form for a general\n2\npair (M \u25e6 , L\u25e6 ) \u2208 OLag (V ) . In order to do that we need to fix some additional\ndim(I \u22a5 /I )\nterminology: Denote I = M \u2229 L and let nI =\n.\n2\nThere are canonical decompositions\nVtop\nVtop N Vtop\nM =\nI\nM/I,\nVtop\nVtop N Vtop\nL =\nI\nL/I.\nIn terms of these decompositions, the orientations on M and L can be written\nin the form oM = \u03b9M \u2297 oM/I and oL = \u03b9L \u2297 oL/I respectively. Let FM \u25e6 ,L\u25e6 : HL\u25e6 \u2192\nHM \u25e6 denote the averaging morphism\nX\nf (m * h) ,\nFM \u25e6 ,L\u25e6 [f ] (h) =\nm\u2208M/I\n\nfor every f \u2208 HL\u25e6 where in the above summation, m \u2208 M is any element lying over\nm \u2208 M/I. Define the normalization constant\n\u0013\n\u0012\nnI\n\u0001\n\u03b9L\nnI\n(\n)\n2\n* \u03c9\u2227 oL/I , oM/I ,\nAM \u25e6 ,L\u25e6 = (G1 /q) \u03c3 (\u22121)\n\u03b9M\nV\nV\nwhere \u03c9 \u2227 : top L/I\u00d7 top M/I \u2192 Fq is the pairing induced by the symplectic\nform \u03c9.\nProposition 2.4.1. For every (M \u25e6 , L\u25e6 ) \u2208 OLag (V )2\n\nTM \u25e6 ,L\u25e6 = AM \u25e6 ,L\u25e6 * FM \u25e6 ,L\u25e6 .\nFor a proof, see Appendix A.\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n9\n\n2.5. Kernel presentation of an intertwining morphism. An explicit way to\npresent an intertwining morphism is via a kernel function. Fix a pair (M \u25e6 , L\u25e6 ) \u2208\n2\nOLag (V ) of oriented Lagrangians and let C (M \\H (V ) /L, \u03c8) \u2282 C (H (V ) , \u03c8) be\nthe subspace of functions K \u2208 C (H (V ) , \u03c8), satisfying the equivariance property K (m * h * l) = K (h), for every m \u2208 M and l \u2208 L. Given a function K \u2208\nC (M \\H (V ) /L, \u03c8), we can associate to it the intertwining morphism I [K] \u2208\nHomH(V ) (HL\u25e6 , HM \u25e6 ) defined by\nI [K] (f ) = K \u2217 f = m! (K \u22a0Z*L f ) ,\nfor every f \u2208 HL\u25e6 , where K \u22a0Z*L f is the descent of the function K \u22a0 f \u2208\nC (H (V ) \u00d7 H (V )) to H (V ) \u00d7Z*L H (V )-the quotient of H (V ) \u00d7 H (V ) by the\naction x * (h1 , h2 ) = (h1 x, x\u22121 h2 ) for x \u2208 Z * L-and m! denotes the operation of\nsummation along the fibers of the multiplication mapping m : H (V ) \u00d7 H (V ) \u2192\nH (V ). We call the function K an intertwining kernel. The procedure that we just\ndescribed defines an isomorphism of vector spaces\nI : C (M \\H (V ) /L, \u03c8) \u2212\u2192 HomH(V ) (HL\u25e6 , HM \u25e6 ).\n3\n\nFix a triple (N \u25e6 , M \u25e6 , L\u25e6 ) \u2208 OLag (V ) . Given kernels K1 \u2208 C (N \\H (V ) /M, \u03c8)\nand K2 \u2208 C (M \\H (V ) /L, \u03c8), their convolution K1 \u2217 K2 = m! (K1 \u22a0Z*M K2 ) lies\nin C (N \\H (V ) /L, \u03c8). Moreover, the transform I sends convolution of kernels to\ncomposition of operators\nI [K1 \u2217 K2 ] = I [K1 ] \u25e6 I [K2 ] .\n2.5.1. Canonical system of intertwining kernels . Below, we formulate a version of\nTheorem 2.2.3 in the setting of kernels.\n2\n\nDefinition 2.5.1. A system {KM \u25e6 ,L\u25e6 \u2208 C (M \\H (V ) /L, \u03c8) : (M \u25e6 , L\u25e6 ) \u2208 OLag (V ) }\n3\nof kernels is called multiplicative if for every triple (N \u25e6 , M \u25e6 , L\u25e6 ) \u2208 OLag (V ) the\nfollowing equation holds\nKN \u25e6 ,L\u25e6 = KN \u25e6 ,M \u25e6 \u2217 KM \u25e6 ,L\u25e6\nA multiplicative system of kernels {KM \u25e6 ,L\u25e6 } can be equivalently thought of as a\n2\nsingle function K \u2208 C(OLag (V ) \u00d7H (V )) defined by K (M \u25e6 , L\u25e6 , \u2212) = KM \u25e6 ,L\u25e6 (\u2212)\n3\nsatisfying the following multiplicativity relation on OLag (V ) \u00d7 H (V )\np\u221712 K \u2217 p\u221723 K = p\u221713 K,\n\u0001 \u0001\nwhere pij ((L\u25e61 , L\u25e62 , L\u25e63 ) , h) = L\u25e6i , L\u25e6j , h are the projections on the i, j copies\nof OLag (V ) and the left-hand side of (2.4) means fiberwise convolution, namely\np\u221712 K \u2217 p\u221723 K(L\u25e61 , L\u25e62 , L\u25e63 , \u2212) = K (L\u25e61 , L\u25e62 , \u2212) \u2217 K (L\u25e62 , L\u25e63 , \u2212).\n2\nFor every (M \u25e6 , L\u25e6 ) \u2208 OLag (V ) , there exists a unique kernel KM \u25e6 ,L\u25e6 such\nthat TM \u25e6 ,L\u25e6 = I [KM \u25e6 ,L\u25e6 ]. We will refer to {KM \u25e6 ,L\u25e6 } as the system of canonical\n2\nintertwining kernels. We will denote the corresponding function on OLag (V ) \u00d7\nH (V ) by K.\n(2.4)\n\n2\n\nProposition 2.5.2. The function K \u2208 C(OLag (V ) \u00d7 H (V )) satisfies\np\u221712 K \u2217 p\u221723 K = p\u221713 K.\n\n\f10\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\nIn case (M \u25e6 , L\u25e6 ) \u2208 U2 , the kernel KM \u25e6 ,L\u25e6 is given by the following explicit\nformula\ne M \u25e6 ,L\u25e6 ,\n(2.5)\nKM \u25e6 ,L\u25e6 = AM \u25e6 ,L\u25e6 * K\n\u0001\n\u2217\ne M \u25e6 ,L\u25e6 = \u03c4 \u22121 \u03c8 where \u03c4 = \u03c4 M \u25e6 ,L\u25e6 is the isomorphism given by the\nwhere K\ncomposition Z \u0592\u2192 H \u0589 M \\H (V ) /L. The system {KM \u25e6 ,L\u25e6 : (M \u25e6 , L\u25e6 ) \u2208 U2 }\nyields a well defined function KU2 \u2208 C (U2 \u00d7 H (V )). In Section 3, we will give\nan algebra geometric interpretation to the description of the kernels KM \u25e6 ,L\u25e6 when\n(M \u25e6 , L\u25e6 ) \u2208\n/ U2 .\n2.6. The canonical vector space. Let us denote by Symp the category whose\nobjects are finite dimensional symplectic vector spaces over the finite field Fq and\nmorphisms are linear isomorphisms of symplectic vector spaces. In addition, let\nus denote by Vect the category of finite dimensional complex vector spaces. Using\nTheorem 2.2.3, we can associate, in a functorial manner, a vector space H (V ) to\na symplectic vector space V \u2208 Symp as follows: Define H (V ) to be the space of\n\"horizontal sections\" of the trivialized vector bundle H (V )\nH (V ) = \u0393hor (OLag (V ) , H (V )) ,\nwhere \u0393hor (OLag (V ) , H (V )) \u2282 \u0393 (OLag (V ) , H (V )) is the sub-space consisting\nof sections (vL\u25e6 \u2208 HL\u25e6 : L\u25e6 \u2208 OLag (V )) satisfying TM \u25e6 ,L\u25e6 (vL\u25e6 ) = vM \u25e6 for every\n2\n(M \u25e6 , L\u25e6 ) \u2208 OLag (V ) . The vector space H (V ) will be referred to as the canonical\nvector space associated with V .\nNotation 2.6.1. The definition of the vector space H (V ) depends on a choice of\na central character \u03c8. Sometime, we will use the notation H (V, \u03c8) to emphasize\nthis point.\nProposition 2.6.2 (Functoriality). The rule V 7\u2192 H (V ) establishes a contravariant (quantization) functor\nH : Symp \u2212\u2192 Vect.\nFor a proof, see Appendix A.\nConsidering a fixed symplectic vector space V , we obtain\nas a consequence a\n\u0001\nrepresentation (\u03c1V , Sp (V ) , H (V )), with \u03c1V (g) = H g \u22121 , for every g \u2208 Sp (V ).\nThe representation \u03c1V is isomorphic to the Weil representation and will be referred\nto as the canonical model of the Weil representation.\nRemark 2.6.3. The canonical model \u03c1V can be viewed from another perspective:\nWe begin with the total vector space \u0393 (V ) = \u0393 (OLag (V ) , H (V )) and make the following two observations. First observation, is that the symplectic group Sp (V ) acts\nnaturally on \u0393 (V ), the action is of a geometric nature-induced from the diagonal\naction on OLag (V ) \u00d7 H (V ). Second observation, is that the system {TM \u25e6 ,L\u25e6 } defines an Sp (V )-invariant idempotent, which should be thought of as a total Fourier\ntransform, T : \u0393 (V ) \u2192 \u0393 (V ) given by\nL\n1\nTM \u25e6 ,L\u25e6 (vL\u25e6 ) ,\nT (vL\u25e6 ) =\n# (OLag (V )) M \u25e6 \u2208OLag(V )\n\nfor every L\u25e6 \u2208 OLag (V ) and vL\u25e6 \u2208 HL\u25e6 . The situation is summarized in the\nfollowing diagram\nSp (V ) \b \u0393 (V ) T.\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n11\n\nThe canonical model is given by the image of T , that is, H (V ) = T (\u0393 (V )).\nThe nice thing about this point of view is that it shows a clear distinction between operators associated with action of the symplectic group and operators associated with intertwining morphisms. Finally, we remark that we can, also, consider\nthe Sp (V )-invariant \u0011idempotent T \u22a5 = Id \u2212 T and the associated representation\n\u0010\n\u22a5\n\u22a5\n, with H (V ) = T \u22a5 (\u0393 (V )). The meaning of this represen\u03c1\u22a5\nV , Sp (V ) , H (V )\ntation is unclear.\n2.7. Properties of the quantization functor.\n2.7.1. Compatibility with Cartesian products. The category Symp admits a monoidal\nstructure given by Cartesian product of symplectic vector spaces. The category Vect\nadmits the standard monoidal structure given by tensor product. The functor H is\na monoidal functor with respect to these monoidal structures.\nProposition 2.7.1. For every V1 , V2 \u2208 Symp, there exists a natural isomorphism\n\u2243\n\n\u03b1V1 \u00d7V2 : H (V1 \u00d7 V2 ) \u2192 H (V1 ) \u2297 H (V2 ) .\nFor a proof, see Appendix A.\nAs a result, we obtain the following compatibility condition between the canonical models of the Weil representation\n\u0001\n\u2243\n(2.6)\n\u03b1V1 \u00d7V2 : \u03c1V1 \u00d7V2 |Sp(V1 )\u00d7Sp(V2 ) \u2212\u2192 \u03c1V1 \u2297 \u03c1V2 .\n\nRemark 2.7.2. Condition (2.6) has an interesting consequence in case the ground\nfield is F3 [5]. In this case, the group Sp (V ) is not perfect when dim V = 2,\ntherefore, in this particular situation, the Weil representation is not uniquely defined. Nevertheless, since the group Sp (V ) becomes perfect when dim V > 2, the\ncanonical model gives a natural choice for the Weil representation in the \"singular\"\ndimension, dim V = 2.\n\n2.7.2. Compatibility with symplectic duality. Let V = (V, \u03c9) \u2208 Symp and let us\ndenote by V = (V, \u2212\u03c9) the symplectic dual of V .\nProposition 2.7.3. There exists a natural non-degenerate pairing\n\u0001\nh*, *iV : H V \u00d7 H (V ) \u2192 C,\nwhere V \u2208 Symp.\n\nFor a proof, see Appendix A.\n2.7.3. Compatibility with symplectic reduction. Let V \u2208 Symp. Let I be an isotropic\nsubspace in V considered as an abelian subgroup in H (V ). The fiberwise action of\nH (V ) on the vector bundle H induces an action of H (V ) on H (V ), using this action\nwe can associate to I the subspace H (V )I of I-invariant vectors. In addition, we\ncan form the symplectic reduction2 I \u22a5 /I and consider the canonical vector space\n\u0001\n\u0001\nI\nH I \u22a5 /I . Roughly, we claim that the vector spaces H I \u22a5 /I and H (V ) are\nnaturally isomorphic. The precise statement involves the following definition\n2Note that since I is isotropic, I \u2282 I \u22a5 and I \u22a5 /I is equipped with a natural symplectic\nstructure.\n\n\f12\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\nDefinition 2.7.4. An oriented isotropic subspace in V is a pair I \u25e6 = (I, oI ), where\nVtop\nI is a non-trivial vector.\nI \u2282 V is an isotropic subspace and oI \u2208\n\nProposition 2.7.5. There exists a natural isomorphism\n\u0001\n\u2243\n\u03b1(I \u25e6 ,V ) : H (V )I \u2192 H I \u22a5 /I ,\n\nwhere, V \u2208 Symp and I \u25e6 an oriented isotropic subspace in V . The naturality\ncondition is\nH (fI ) \u25e6 \u03b1(J \u25e6 ,U) = \u03b1(I \u25e6 ,V ) \u25e6 H (f ) ,\n\nfor every f \u2208 MorSymp (V, U ) such that f (I \u25e6 ) = J \u25e6 and fI \u2208 MorSymp I \u22a5 /I, J \u22a5 /J\nis the induced morphism.\n\n\u0001\n\nFor a proof, see Appendix A.\nAs a result, we obtain the following compatibility condition between the canonical models of the Weil representation: Fix V \u2208 Symp and let I \u25e6 be an enhanced\nisotropic subspace in V . Let P \u2282 Sp (V ) be the subgroup of elements g \u2208 Sp (V )\nsuch that g (I \u25e6 ) = I \u25e6 . The isomorphism \u03b1(I \u25e6 ,V ) establishes the following isomorphism\n\u2243\n\n\u03b1(I \u25e6 ,V ) : (\u03c1V )|P \u2212\u2192 \u03c1I \u22a5 /I \u25e6 \u03c0,\n\u0001\nwhere \u03c0 : P \u2192 Sp I \u22a5 /I is the canonical homomorphism.\n3. Geometric canonical intertwining kernels\nIn this section, we construct a geometric counterpart to the set-theoretic system\nof canonical intertwining kernels. In particular, we obtain an algebra-geometric\n/ U2 , and an alternative\ninterpretation for the kernels KM \u25e6 ,L\u25e6 when (M \u25e6 , L\u25e6 ) \u2208\nproof for the strong S-vN theorem.\n3.1. Preliminaries from algebraic geometry. We denote by k an algebraic\nclosure of the field Fq . Next we have to use some space to recall notions and\nnotations from algebraic geometry and the theory of l-adic sheaves.\n3.1.1. Varieties. In the sequel, we are going to translate back and forth between\nalgebraic varieties defined over the finite field Fq and their corresponding sets of\nrational points. In order to prevent confusion between the two, we use bold-face\nletters to denote a variety X and normal letters X to denote its corresponding set\nof rational points X = X(Fq ). For us, a variety X over the finite field is a quasi\nprojective algebraic variety, such that the defining equations are given by homogeneous polynomials with coefficients in the finite field Fq . In this situation, there\nexists a (geometric) Frobenius endomorphism F r : X \u2192 X, which is a morphism\nof algebraic varieties. We denote by X the set of points fixed by F r, i.e.,\nX = X(Fq ) = XF r = {x \u2208 X : F r(x) = x}.\nThe category of algebraic varieties over Fq will be denoted by VarFq .\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n13\n\n3.1.2. Sheaves. Let Db (X) denote the bounded derived category of constructible\nl-adic sheaves on X [2]. We denote by Perv(X) the Abelian category of perverse\nsheaves on the variety X, that is the heart with respect to the autodual perverse\nt-structure in Db (X). An object F \u2208Db (X) is called N -perverse if F [N ] \u2208 Perv(X).\nFinally, we recall the notion of a Weil structure (Frobenius structure) [4]. A Weil\nstructure associated to an object F \u2208Db (X) is an isomorphism\n\u223c\n\n\u03b8 : F r\u2217 F \u2212\u2192 F .\nA pair (F , \u03b8) is called a Weil object. By an abuse of notation we often denote\n\u03b8 also by F r. We choose once an identification Ql \u2243 C, hence all sheaves are\nconsidered over the complex numbers.\nRemark 3.1.1. All the results in this section make perfect sense over the field\nQl , in this respect the identification of Ql with C is redundant. The reason it is\nspecified is in order to relate our results with the standard constructions.\nGiven a Weil object (F , F r\u2217 F \u2243 F ) one can associate to it a function f F : X \u2192\nC to F as follows\nP\nf F (x) = (\u22121)i T r(F r|H i (Fx ) ).\ni\n\nThis procedure is called Grothendieck's sheaf-to-function correspondence[10]. Another common notation for the function f F is \u03c7F r (F ), which is called the Euler\ncharacteristic of the sheaf F .\n3.2. Geometrization. We shall now start the geometrization procedure.\n3.2.1. Replacing sets by varieties. The first step we take is to replace all sets involved by their geometric counterparts, i.e., algebraic varieties. The symplectic\nspace (V, \u03c9) is naturally identified as the set V = V(Fq ), where V is a 2ndimensional symplectic vector space in VarFq . The Heisenberg group H is naturally\nidentified as the set H = H(Fq ), where H = V\u00d7Ga is the corresponding group\nvariety. Finally, OLag (V ) = OLag(V) (Fq ), where OLag (V) is the variety of\noriented Lagrangians in V.\n3.2.2. Replacing functions by sheaves. The second step is to replace functions by\ntheir sheaf-theoretic counterparts [6]. The additive character \u03c8 : Fq \u2212\u2192 C\u00d7 is\nassociated via the sheaf-to-function correspondence to the Artin-Schreier sheaf L\u03c8\non the variety Ga , i.e., we have f L\u03c8 = \u03c8. The Legendre character \u03c3 on F\u00d7\nq \u2243 Gm (Fq )\nis associated to the Kummer sheaf L\u03c3 on the variety Gm . The one dimensional\nGauss sum G1 is associated with the Weil object\nR\nG1 = L\u03c8( 21 z2 ) \u2208 Db (pt),\nGa\n\nR\nR\nwhere, for the rest of this paper, = ! denotes integration with compact support\n[2]. Grothendieck's Lefschetz trace formula [10] implies that, indeed, f G1 = G1 .\nq.i\n\nIn fact, there exists a quasi-isomorphism G1 \u2212\u2192 H 1 (G1 )[\u22121] and dim H 1 (G1 ) =1,\nhence, G1 can be thought of as a one-dimensional vector space, equipped with a\nFrobenius operator, sitting at cohomological degree 1.\n\n\f14\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n3.3. Canonical system of geometric intertwining kernels. Let U2 \u2282 OLag (V)\nbe the open subvariety consisting of pairs (M \u25e6 , L\u25e6 ) \u2208 OLag (V)2 which are in general position. We define a sheaf \"of kernels\" KU2 on the variety U2 \u00d7 H (V) as\nfollows:\n\n2\n\ne U2 .\nKU2 = A\u2297K\n\nwhere\ne U2 is the sheaf of non-normalized kernels given by\n\u2022 K\n\u0001\ne U2 (M \u25e6 , L\u25e6 ) = \u03c4 \u22121 \u2217 L\u03c8 ,\nK\n\nwhere \u03c4 = \u03c4 M \u25e6 ,L\u25e6 is the isomorphism given by the composition\nZ \u0592\u2192 H \u0589 M\\H/L.\n\n\u2022 A is the \"Normalization coefficient\" sheaf given by\n\u0010\n\u0011\n( n2 ) \u03c9 (o , o ) [2n] (n) .\n(\u22121)\n(3.1)\nA (M \u25e6 , L\u25e6 ) = G \u2297n\n\u2297\nL\n\u2227\nL\nM\n\u03c3\n1\nk\n\nLet nk = dim(OLag (V) ) + n + 1 for k \u2208 N. By construction, the sheaf KU2 is\na local system (liss\u00e9) of rank 1, normalized to sit in cohomological degree \u2212n2 and\nconsequently of pure weight w(KU2 ) = 0.\n\nProposition 3.3.1. The local system KU2 can be extended in a unique manner\n2\nto a geometrically irreducible [n2 ]-perverse Weil sheaf K on OLag (V) \u00d7H (V) of\npure weight w(K) = 0. Moreover, there exists an isomorphism\np\u221713 K \u2243p\u221712 K\u2217p\u221723 K.\nThe proof of Proposition 3.3.1 proceeds in several steps. The construction of K\nuses the functor of middle extension, namely, take\n(3.2)\n\nK =j!\u2217 KU2 ,\n2\n\nwhere j : U2 \u00d7H (V) \u0592\u2192 OLag (V) \u00d7 H (V) is the open imbedding and j!\u2217 is the\nfunctor of middle extension [2]. It follows directly from the construction that the\nsheaf K is irreducible [n2 ]-perverse of pure weight 0.\nRemark 3.3.2. Proposition 3.3.1 establishes an alternative proof of Proposition\n2.5.2 as follows: Let K = f K . The multiplicativity condition for the sheaf K implies\nthat K is multiplicative. Moreover, since KU2 = f KU2 , it implies that K extends\nthe function KU2 . In addition, the geometric construction yields a description of\n/ U2 in terms of the middle extension of KU2 .\nthe kernels KM \u25e6 ,L\u25e6 when (M \u25e6 , L\u25e6 ) \u2208\n3\n\n3.4. Proof of the multiplicativity property. Denote by U3 \u2282 OLag (V) the\nopen subvariety consisting of triples (N \u25e6 , M \u25e6 , L\u25e6 ) which are in general position\npairwisely.\nLemma 3.4.1. There exists an isomorphism on U3 \u00d7 H (V)\np\u221713 K \u2243p\u221712 K\u2217p\u221723 K.\nFor a proof, see Appendix A.\n3\nLet V3 \u2282 OLag (V) denote the open subvariety consisting of triples (N \u25e6 , M \u25e6 , L\u25e6 )\n\u25e6\n\u25e6\nsuch that (N , M ) , (M \u25e6 , L\u25e6 ) \u2208 U2 .\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n15\n\nLemma 3.4.2. There exists an isomorphism on V3 \u00d7 H (V)\np\u221713 K \u2243p\u221712 K\u2217p\u221723 K.\nFor a proof, see Appendix A.\nUsing Lemma 3.4.1 we conclude that the sheaves p\u221713 K and p\u221712 K\u2217p\u221723 K are isomorphic on the open subvariety U3 \u00d7 H (V). The sheaf p\u221713 K is irreducible [n3 ]perverse as a pull-back by a smooth, surjective with connected fibers morphism, of\nan irreducible [n2 ]-perverse sheaf on OLag (V)2 \u00d7 H (V), hence, it is enough to\nshow that the sheaf p\u221712 K\u2217p\u221723 K is irreducible [n3 ]-perverse.\n4\nLet us denote by V4 \u2282 OLag (V) the open subvariety consisting of quadruples\n4\n\u25e6\n\u25e6\n\u25e6\n\u25e6\n(N , S , M , L ) \u2208 OLag (V) such that (N \u25e6 , S \u25e6 ) , (S \u25e6 , M \u25e6 ) \u2208 U2 . The projection\n3\np134 : V4 \u00d7 H (V) \u2192 OLag (V) \u00d7 H (V) is smooth, surjective and admits connected fibers, therefore, it is enough to show that the pull-back p\u2217134 (p\u221712 K\u2217p\u221723 K) is\nirreducible [n4 ]-perverse. Using Lemma 3.4.2 and also invoking some direct diagram\nchasing we obtains\np\u2217134 (p\u221712 K\u2217p\u221723 K) \u2243p\u221712 K \u2217 p\u221723 K \u2217 p\u221734 K.\n\n(3.3)\n\nThe right-hand side of the above formula is principally a subsequent application\nof a properly normalized, Fourier transforms (see Formula (A.6) below) on p\u221734 K,\nhence by the Katz\u2013Laumon theorem [16] it is irreducible [n4 ]-perverse.\nLet us summarize. We showed that both sheaves p\u221713 K and p\u221712 K\u2217p\u221723 K are irreducible [n3 ]-perverse and are isomorphic on an open subvariety. This implies that\nthey must be isomorphic.\nThis concludes the proof of the multiplicativity property.\nAppendix A. Proofs of statements\nA.1. Proof of Proposition 2.3.1. For every (N \u25e6 , M \u25e6 , L\u25e6 ) \u2208 U3 the intertwining morphisms FN \u25e6 ,M \u25e6 \u25e6 FM \u25e6 ,L\u25e6 , FN \u25e6 ,L\u25e6 \u2208 HomH(V ) (HL\u25e6 , HN \u25e6 ) are proportional,\nnamely\nFN \u25e6 ,M \u25e6 \u25e6 FM \u25e6 ,L\u25e6 = C (N \u25e6 , M \u25e6 , L\u25e6 ) * FN \u25e6 ,L\u25e6 ,\n\u25e6\nfor some C (N , M \u25e6 , L\u25e6 ) \u2208 C. This follows from the fact that HL\u25e6 and HN \u25e6 are\nirreducible and isomorphic as representations of the Heisenberg group H (V ).\nThe proof will proceed in two steps.\nStep 1. We calculate the proportionality coefficient C (N \u25e6 , M \u25e6 , L\u25e6 ).\nLet \u03b4 L \u2208 HL\u25e6 denote the unique function supported on L * Z normalized such\nthat \u03b4 L (0) = 1. On the one hand, it is easy to verify that FN \u25e6 ,L\u25e6 (\u03b4 L ) (0) = 1\ntherefore\nC (N \u25e6 , M \u25e6 , L\u25e6 ) = FN \u25e6 ,M \u25e6 \u25e6 FM \u25e6 ,L\u25e6 (\u03b4 L ) (0) .\nOn the other hand, explicit calculation reveals that\n\u0001\nP\n\u03c8( 21 \u03c9 rL (m) , m ),\nFN \u25e6 ,M \u25e6 \u25e6 FM \u25e6 ,L\u25e6 (\u03b4 L ) (0) =\nm\u2208M\n\nL\n\nwhere r : M \u2192 N is the linear map defined by the condition rL (m) \u2212 m \u2208 L for\nevery m \u2208 M . Furthermore, an easy diagonalization argument implies that\n\u0001\n\u0002\n\u0001\u0003\u0001\nP\n\u03c8( 12 \u03c9 rL (m) , m ) = Gn1 * \u03c3 d \u03c9 rL (\u2212) , \u2212 ,\nm\u2208M\n\n\u0002\n\u0001\u0003\n\u00d72\nwhere d \u03c9 rL (\u2212) , \u2212 \u2208 F\u00d7\nq /Fq denotes the discriminant of the symmetric form\n\u0001\nVtop\nVtop\nL\nL\nL\nN.\nM\u2192\n\u03c9 r (\u2212) , \u2212 . The map r : M \u2192 N induces a map r\u2227\n:\n\n\f16\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\nLemma A.1.1. We have\nn\n\u0001\n\u0002\n\u0001\u0003\nL\n(oM ) , oM .\nd \u03c9 rL (\u2212) , \u2212 = (\u22121)( 2 ) \u03c9 \u2227 r\u2227\nSummarizing, we get that\n\n(A.1)\n\nn\n\u0001\nL\n(oM ) , oM ).\nC (N \u25e6 , M \u25e6 , L\u25e6 ) = Gn1 * \u03c3((\u22121)( 2 ) \u03c9 \u2227 r\u2227\n\nStep 2. Denote A (N \u25e6 , M \u25e6 , L\u25e6 ) = AN \u25e6 ,M \u25e6 * AM \u25e6 ,L\u25e6 * A\u22121\nN \u25e6 ,L\u25e6 . We will show that\nA (N \u25e6 , M \u25e6 , L\u25e6 ) = C (N \u25e6 , M \u25e6 , L\u25e6 )\n\n\u22121\n\n.\n\nUsing Formula (2.3) for the normalization coefficients, we can write A (N \u25e6 , M \u25e6 , L\u25e6 )\nin the form\nn\n\u22121\nn\n(G /q) \u03c3((\u22121)( 2 ) \u03c9 (o , o ) \u03c9 (o , o ) \u03c9 (o , o ) ).\n\u2227\n\n1\n\nM\n\nN\n\n\u2227\n\nL\n\nM\n\n\u2227\n\nL\n\nN\n\nLemma A.1.2. We have\n\u0001\nL\n(oM ) , oM = (\u22121)n \u03c9 \u2227 (oM , oN ) \u03c9\u2227 (oL , oM ) \u03c9 \u2227 (oL , oN )\u22121 .\n\u03c9\u2227 r\u2227\nUsing Lemma A.1.2, we get that A (N \u25e6 , M \u25e6 , L\u25e6 ) is equal to\nn\n\u0001\n\u22121\n+n\nn\nL\n(oM ) , oM ) = C (N \u25e6 , M \u25e6 , L\u25e6 ) ,\n(G1 /q) \u03c3((\u22121)( 2 ) \u03c9\u2227 r\u2227\nn\n\nn\nwhere in the second equality we use the identity G2n\n1 = q \u03c3 ((\u22121) ).\nThis concludes the proof of the proposition.\n\u2243\n\nA.1.1. Proof of Lemma A.1.1. Choose an isomorphism \u03c6 :P\nM \u2192 Fnq . Let B :\n\u2217\nM \u00d7 M \u2192 Fq be the symmetric\nform defined by B = \u03c6 ( xi yi ). Present the\n\u0001\nsymmetric form \u03c9 rL (\u2212) , \u2212 as\n\u0001\n\u03c9 rL (\u2212) , \u2212 = B (A (\u2212) , \u2212) ,\n\u0002\n\u0001\u0003\nwhere A \u2208 M atn\u00d7n (Fq ) is a symmetric matrix. By definition d \u03c9 rL (\u2212) , \u2212 =\ndet A mod F\u00d72\nq .\nLet e1 , e2 , .., en be an orthonormal basis with respect to the form B. The argument now follows from\nn\nP\n\u03c3 Q\n(\u22121)\n\u03c9(rL (ei ) , e\u03c3(i) )\ndet A =\ni=1\n\n\u03c3\u2208\u03a3n\n\nL\n(e1 \u2227 .. \u2227 en ) , e1 \u2227 .. \u2227 en )\n= (\u22121)( ) \u03c9 \u2227 (r\u2227\nn\n)\n(\nL\n= (\u22121) 2 \u03c9 (r (o ) , o ) mod F\u00d72 .\nn\n2\n\n\u2227\n\nM\n\nM\n\nq\n\nThis concludes the proof of the lemma.\nL\nA.1.2. Proof of Lemma A.1.2. We can write r\u2227\n(oM ) = a * oN , for some a \u2208 Fq .\nThe constant a can be computed as follows: On the one hand, since rL (m) \u2212 m \u2208 L\nL\n, we have that \u03c9\u0001\u2227 (r\u2227\n(oM ) , oL ) = \u03c9\u2227 (oM , oL ). On the other hand, we have that\nL\n\u03c9\u2227 r\u2227 (oM ) , oL = a\u03c9 \u2227 (oN , oL ), hence\n\na=\n\n\u03c9 \u2227 (oM , oL )\n.\n\u03c9 \u2227 (oN , oL )\n\nTherefore we obtain that\n\u0001\n\u22121\nL\n= \u03c9 \u2227 (oM , oL ) \u03c9\u2227 (oN , oL ) \u03c9\u2227 (oN , oM )\n(oM ) , oM\n\u03c9\u2227 r\u2227\nn\n\n\u22121\n\n= (\u22121) \u03c9 \u2227 (oM , oN ) \u03c9\u2227 (oL , oM ) \u03c9 \u2227 (oL , oN )\n\n,\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n17\n\nn\n\nwhere in the second equality we used the relation \u03c9 \u2227 (o, o\u2032 ) = (\u22121) \u03c9 \u2227 (o\u2032 , o). This\nconcludes the proof of the lemma.\nA.2. Proof of Proposition 2.3.2. The trivialization of the vector bundle H is\n2\nconstructed as follows: Let (N \u25e6 , L\u25e6 ) \u2208 OLag (V ) . In order to construct TN \u25e6 ,L\u25e6 ,\n\u25e6\n\u25e6\nchoose a third M \u2208 OLag (V ) such that (N , M \u25e6 ) , (M \u25e6 , L\u25e6 ) \u2208 U2 (such a choice\nalways exists). Define\nTN \u25e6 ,L\u25e6 = TN \u25e6 ,M \u25e6 \u25e6 TM \u25e6 ,L\u25e6 ,\nwhere we note that both operators in the composition on the left hand side are well\ndefined. We are left to show that the definition of TN \u25e6 ,L\u25e6 does not depends on the\nchoice of M \u25e6 . Let Mi\u25e6 \u2208 OLag (V ), i = 1, 2, such that (N \u25e6 , Mi\u25e6 ) , (Mi\u25e6 , L\u25e6 ) \u2208 U2 .\nWe want to show that\nTN \u25e6 ,M1\u25e6 \u25e6 TM1\u25e6 ,L\u25e6 = TN \u25e6 ,M2\u25e6 \u25e6 TM2\u25e6 ,L\u25e6 .\nChoose M3\u25e6 \u2208 OLag (V ) such that (M3\u25e6 , Mi\u25e6 ) \u2208 U2 for i = 1, 2 and, in addition,\n(M3\u25e6 , L\u25e6 ) , (M3\u25e6 , N \u25e6 ) \u2208 U2 . We have\nTN \u25e6 ,M1\u25e6 \u25e6 TM1\u25e6 ,L\u25e6\n\n=\n\nTN \u25e6 ,M1\u25e6 \u25e6 TM1\u25e6 ,M3\u25e6 \u25e6 TM3\u25e6 ,L\u25e6\n\n=\n\nTN \u25e6 ,M3\u25e6 \u25e6 TM3\u25e6 ,L\u25e6 ,\n\nwhere the first and second equalities are the multiplicativity property for triples\nwhich are in general position pairwisely (Proposition 2.3.1). In the same fashion,\nwe show that TN \u25e6 ,M2\u25e6 \u25e6 TM2\u25e6 ,L\u25e6 = TN \u25e6 ,M3\u25e6 \u25e6 TM3\u25e6 ,L\u25e6 .\nFinally, the same kind of argument shows that the complete system {TM \u25e6 ,L\u25e6 :\n2\n(M \u25e6 , L\u25e6 ) \u2208 OLag (V ) } forms a trivialization.\nThis concludes the proof of the proposition.\nA.3. Proof of Proposition\ncanonical\nV\nV 2.4.1. VDenote I = MV\u2229 L. Using\nV the V\ndecompositions top M = top I \u2297 top M/I and top L = top I \u2297 top L/I,\nwe can write the orientations on M and L in the form oM = \u03b9M \u2297 oM/I and\noL = \u03b9L \u2297 oL/I respectively.\nChoose a third S \u25e6 \u2208 OLag (V ) such that (M \u25e6 , S \u25e6 ) , (S \u25e6 , L\u25e6 ) \u2208 U2 . By Theorem\n2.3.2, we conclude that TM \u25e6 ,L\u25e6 = TM \u25e6 ,S \u25e6 \u25e6 TS \u25e6 ,L\u25e6 , furthermore, using the explicit\nformula (2.2), we can write the composition TM \u25e6 ,S \u25e6 \u25e6 TS \u25e6 ,L\u25e6 explicitly in the form\n(G1 /q)2n \u03c3 (\u03c9\u2227 (oS , oM ) \u03c9\u2227 (oL , oS )) FM \u25e6 ,S \u25e6 \u25e6 FS \u25e6 ,L\u25e6 .\n\n(A.2)\n\nDirect computation reveals that\n\u0015\n\u0014\nP\n(A.3)\nFM \u25e6 ,S \u25e6 \u25e6 FS \u25e6 ,L\u25e6 =\n\u03c8( 12 \u03c9(m, rL (m))) * FM \u25e6 ,L\u25e6\nm\u2208M\n\"\n#\n\u0001\nP\nL\n1\n=\n#I *\n\u03c8( 2 \u03c9 m, r (m) ) * FM \u25e6 ,L\u25e6 ,\nm\u2208M/I\n\nL\n\nwhere r : M \u2192 S is the linear map\ncondition rL (m) \u2212 m \u2208 L,\n\u0001 defined by the\nL\nL\nfor every m \u2208 M ; moreover, ker r = I, hence, r factors to an injective map\nrL : M/I \u2192 S. This also explains the second equality in (A.3).\nLet us denote by B : M/I \u00d7\n\u0001 M/I \u2192 Fq the symmetric form on M/I given by\nB (m1 , m2 ) = 21 \u03c9 m1 , rL (m2 ) . An easy diagonalization argument implies that\n\u0001\nP\n\u03c8( 12 \u03c9 m, rL (m) ) = Gn1 I * \u03c3 (d [B]) ,\nm\u2208M/I\n\n\f18\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n\u00d72\nwhere d [B] \u2208 F\u00d7\nq /Fq denotes the discriminant of the symmetric form B.\nVtop\nM/I induce from B.\nLet us denote by B\u2227 the form on\n\nLemma A.3.1. We have\n\nnI\n\u0001\nd [B] = (\u22121)( 2 ) B\u2227 oM/I , oM/I .\n\nSummarizing, we obtain that TM \u25e6 ,S \u25e6 \u25e6 TS \u25e6 ,L\u25e6 is equal to\nnI\n\u0001\nn\n+n\n(A.4) (G1 /q) I \u03c3((\u22121)( 2 ) B\u2227 oM/I , oM/I \u03c9 \u2227 (oS , oM ) \u03c9 \u2227 (oL , oS ))FM \u25e6 ,L\u25e6 .\nFinally use\n\nLemma A.3.2. We have\n\u0001\n\u0001\n\u22121 \u03b9L\nn\n.\nB\u2227 oM/I , oM/I = (\u22121) \u03c9 \u2227 oL/I , oM/I \u03c9\u2227 (oS , oM ) \u03c9 (oL , oS )\n\u03b9M\nin order to conclude that TM \u25e6 ,S \u25e6 \u25e6 TS \u25e6 ,L\u25e6 is equal to\nnI\n\u0001 \u03b9L\nn\n(G1 /q) I \u03c3((\u22121)( 2 ) \u03c9 \u2227 oL/I , oM/I\n)FM \u25e6 ,L\u25e6 .\n\u03b9M\nThis concludes the proof of the proposition.\n\n\u2243\n\nA.3.1. Proof of Lemma A.3.1. Choose an isomorphism \u03c6 : M/I P\n\u2192 Fnq I . Let B0 :\n\u2217\nM/I \u00d7 M/I \u2192 Fq be the symmetric form defined by B0 = \u03c6 ( xi yi ). Present\nthe symmetric form B as\nB (\u2212, \u2212) = B0 (A (\u2212) , \u2212) ,\n\nwhere A \u2208 M atnI \u00d7nI (Fq ) is a symmetric matrix. By definition d [B] = det A mod\nF\u00d72\nq .\nLet e1 , e2 , .., enI be an orthonormal basis with respect to the form B0 . The\nargument follows from the following equalities:\nnI\n\u0001\nP\n\u03c3 Q\n\u03c9(ei , rL e\u03c3(i) )\n(\u22121)\ndet A =\ni=1\n\n\u03c3\u2208\u03a3nI\n\n= (\u22121)\n= (\u22121)\n\nnI (nI \u22121)\n2\n\nnI (nI \u22121)\n2\n\nL\n(e1 \u2227 .. \u2227 enI ))\n\u03c9\u2227 (e1 \u2227 .. \u2227 enI , r\u2227\n\u0001\n\u03c9\u2227 (oM/I , rL oM/I ) mod F\u00d72\nq .\n\nThis concludes the proof of the lemma.\n\nVtop\nVtop L\nL\nA.3.2. Proof of Lemma A.3.2. Let us denote by r\u2227\n:\nM/I \u2192\nr (M/I)\nL\nL\nthe map induced from r : M/I \u2192 r (M/I). There is a canonical decomposition\nVtop\nVtop L\nVtop\nS =\nr (M/I) \u2297\nS/rL (M/I)\n\u0001 and consequently the orientation oS\nL\noM/I \u2297 o. On the one hand\ncan be written in the form oS = r\u2227\n\u0001\n\u0001\nL\noM/I \u2297 o\n\u03c9 \u2227 (oM , oS ) = \u03c9 \u2227 \u03b9M \u2297 oM/I , r\u2227\n\u0001\u0001\nL\noM/I .\n= \u03c9 \u2227 (\u03b9M , o) * \u03c9 \u2227 oM/I , r\u2227\nOn the other hand\n\n\u03c9 \u2227 (oL , oS ) =\n=\n=\n\n\u0001\n\u0001\nL\noM/I \u2297 o\n\u03c9 \u2227 \u03b9L \u2297 oL/I , r\u2227\n\u0001\u0001\nL\noM/I\n\u03c9 \u2227 (\u03b9L , o) * \u03c9 \u2227 oL/I , r\u2227\n\u0001\n\u03b9L\n\u03c9 \u2227 (\u03b9M , o) * \u03c9 \u2227 oL/I , oM/I .\n\u03b9M\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n19\n\nwhich implies that\n\u03c9 \u2227 (\u03b9M , o) = \u03c9 \u2227 (oL , oS ) \u03c9 \u2227 oL/I , oM/I\n\n\u0001\u22121 \u03b9M\n.\n\u03b9L\n\nAltogether, we obtain that\n\u0001\n\u0001\u0001\n\u22121 \u03b9L\nN\nL\n.\n\u03c9 \u2227 oM/I , r\u2227\noM/I = (\u22121) \u03c9\u2227 oL/I , oM/I \u03c9 \u2227 (oS , oM ) \u03c9 \u2227 (oL , oS )\n\u03b9M\nThis concludes the proof of the lemma.\n\nA.4. Proof of Proposition 2.6.2. Let f \u2208 MorSymp (V1 , V2 ) be an isomorphism\nof symplectic vector spaces. The map f induces a pair isomorphisms\n\u2243\n\nr\n\n: H (V1 ) \u2212\u2192 H (V2 ) ,\n\ns\n\n: OLag (V1 ) \u2212\u2192 OLag (V2 ) .\n\n\u2243\n\nThe first is the isomorphism of groups given by r (v1 , z) = (f (v1 ) , z) and the\nsecond is the evident induced bijection of sets. For every L\u25e6 \u2208 OLag (V1 ), we have\n\u2243\n\u2217\na pull-back isomorphism rL\n\u25e6 : Hs(L\u25e6 ) (V2 ) \u2192 HL\u25e6 (V1 ).\nLemma A.4.1. For every (M \u25e6 , L\u25e6 ) \u2208 OLag (V1 )2\n\u2217\n\u2217\nTM \u25e6 ,L\u25e6 \u25e6 rL\n\u25e6 = rM \u25e6 \u25e6 Ts(M \u25e6 ),s(L\u25e6 ) .\n\u2217\nThe system of isomorphisms {rL\n\u25e6 } yields the required isomorphism of vector\n\u2243\nspaces H (f ) : H (V2 ) \u2192 H (V1 ); evidently, for every f \u2208 MorSymp (V1 , V2 ), g \u2208\nMorSymp (V2 , V3 )\n\nH (g \u25e6 f ) = H (g) \u25e6 H (f )\n. This concludes the proof of the proposition.\nA.4.1. Proof of Lemma A.4.1. It will be convenient to work with the system of\nkernels {KM \u25e6 ,L\u25e6 } (Theorem 2.5.2). Recall, TM \u25e6 ,L\u25e6 = I [KM \u25e6 ,L\u25e6 ]. It is enough to\nshow\n(A.5)\n\nr\u2217 Ks(M \u25e6 ),s(L\u25e6 ) = KM \u25e6 ,L\u25e6 ,\n\nfor every (M \u25e6 , L\u25e6 ) \u2208 OLag (V1 )2 . Direct verification reveals that (A.5) holds when\n2\n(M \u25e6 , L\u25e6 ) \u2208 U2 . Given (M \u25e6 , L\u25e6 ) \u2208 OLag (V1 ) , let S \u25e6 \u2208 OLag (V1 ) be an oriented\n\u25e6\n\u25e6\n\u25e6\n\u25e6\nLagrangian such that (M , S ) , (S , L ) \u2208 U2 . Write\n\u0001\nr\u2217 Ks(M \u25e6 ),s(L\u25e6 ) = r\u2217 Ks(M \u25e6 ),s(S \u25e6 ) \u2217 Ks(S \u25e6 ),s(L\u25e6 )\n= r\u2217 Ks(M \u25e6 ),s(S \u25e6 ) \u2217 r\u2217 Ks(S \u25e6 ),s(L\u25e6 )\n= KM \u25e6 ,S \u25e6 \u2217 KS \u25e6 ,L\u25e6 = KM \u25e6 ,L\u25e6 ,\n\nwhere the first and forth equalities are by the multiplicativity property of the system\n{KM \u25e6 ,L\u25e6 } (see Theorem 2.5.2) and the second equality follows from the fact that\nr is a morphism of groups.\nThis concludes the proof of the lemma.\n\n\f20\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\nA.5. Proof of Proposition 2.7.1. Let Vi \u2208 Symp, i = 1, 2. There are two maps\nr\n\n: H (V1 ) \u00d7 H (V2 ) \u2212\u2192 H (V1 \u00d7 V2 ) ,\n\ns\n\n: OLag (V1 ) \u00d7 OLag (V1 ) \u2212\u2192 OLag (V1 \u00d7 V2 ) .\n\nThe map r is a surjective morphism of groups given by r ((v1 , z1 ) , (v2 , z2 )) =\n((v1 , v2 ) , z1 + z2 ). The map s is a bijection of sets given by\ns (L\u25e61 , L\u25e62 ) = (L1 \u00d7 L2 , oL1 \u2297 oL2 ) ,\nfor Li = (Li , oLi ), i = 1, 2, where we use the canonical isomorphism of vector spaces\nVtop\nVtop\nVtop\n(L1 \u00d7 L2 ) \u2243\nL1 \u2297\nL2 .\n\nFor every (L\u25e61 , L\u25e62 ) \u2208 OLag (V1 ) \u00d7 OLag (V1 ), the map r induces a pull back\n\u2243\nisomorphism r\u2217L\u25e6 ,L\u25e6 : Hs(L\u25e6 ,L\u25e6 ) \u2192 HL\u25e61 \u2297 HL\u25e62 .\n2\n1\n( 1 2)\nThe proof of the following lemma follows along similar lines as the proof of\nLemma A.4.1.\nLemma A.5.1. For every (L\u25e61 , L\u25e62 ) , (M1\u25e6 , M2\u25e6 ) \u2208 OLag (V1 ) \u00d7 OLag (V1 )\nTM1\u25e6 ,L\u25e61 \u2297 TM2\u25e6 ,L\u25e62 \u25e6 r(\u2217L\u25e6 ,L\u25e6 ) = r(\u2217M \u25e6 ,M \u25e6 ) \u25e6 Ts(M \u25e6 ,M \u25e6 ),s(L\u25e6 ,L\u25e6 ) .\n1\n2\n1\n2\n1\n2\n1\n2\nThe system {r\u2217L\u25e6 ,L\u25e6 } gives the required isomorphism \u03b1V1 \u00d7V2 .\n( 1 2)\nThis concludes the proof of the proposition.\n\u0001\nA.6. Proof of Proposition 2.7.3. Let r : H (V ) \u2192 H V be the isomorphism\nof Heisenberg groups, given\u0001 by r (v, z) = (v, \u2212z). For every oriented Lagrangian\nL\u25e6 \u2208 OLag (V ) = OLag V , the map r induces a the pull-back isomorphism\n\u0001\n\u0001 \u2243\n\u2217\n\u2192 HL\u25e6 V, \u03c8 \u22121 .\nrL\n\u25e6 : HL\u25e6 V , \u03c8\n\u0001\nWe denote by T M \u25e6 ,L\u25e6 and TM \u25e6 ,L\u25e6 the trivializations of H V , \u03c8 \u22121 and H (V, \u03c8)\nrespectively.\nLemma A.6.1. For every (M \u25e6 , L\u25e6 ) \u2208 OLag (V )\n\n2\n\n\u2217\n\u2217\nrM\n\u25e6 \u25e6 T M \u25e6 ,L\u25e6 = TM \u25e6 ,L\u25e6 \u25e6 rL\u25e6 .\n\n\u0001 \u2243\n\u0001\n\u2217\n\u2217\nThe system {rL\n: H V , \u03c8 \u2192 H V, \u03c8 \u22121 . Finally,\n\u25e6 } gives an isomorphism r\nthere is a natural non-degenerate pairing\n\u0001\n\u2032\nh*, *iV : H V, \u03c8 \u22121 \u00d7 H (V, \u03c8) \u2192 C,\n\u0001\n\u2032\ninduced from the system pairings h*, *iL\u25e6 : HL\u25e6 V, \u03c8 \u22121 \u00d7 HL\u25e6 (V, \u03c8) \u2192 C, given\nby\nP\n\u2032\ng (v) f (v) ,\nhf, giL\u25e6 =\nv\u2208V /L\n\n\u22121\n\n\u0001\n\nand g \u2208 HL\u25e6 (V, \u03c8); we note that the function g * f :\nfor every f \u2208 HL\u25e6 V, \u03c8\nH (V ) \u2192 C descends to a function on V /L. Define\nh*, *iV = hr\u2217 (*) , *i\u2032V .\n\nThis concludes the proof of the proposition.\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n21\n\nA.6.1. Proof of Lemma\u0001 A.6.1. It is enough to prove the condition for (M \u25e6 , L\u25e6 ) \u2208\nU2 . Let f \u2208 HL\u25e6 V , \u03c8 . On the one hand\n\u2217\n=\nrM\n\u25e6 T M \u25e6 ,L\u25e6 [f ] (v, z)\n\n=\n\nT M \u25e6 ,L\u25e6 [f ] (v, \u2212z)\n\u0001\nP\nf m + v, \u2212z \u2212 21 \u03c9 (m, v) .\nAM \u25e6 ,L\u25e6\nm\u2208M\n\nOn the other hand\n\u2217\nTM \u25e6 ,L\u25e6 [rL\n=\n\u25e6 (f )] (v, z)\n\n=\n\n\u0001\n\u2217\n1\nrL\n\u25e6 (f ) m + v, z +\n2 \u03c9 (m, v)\nm\u2208M\n\u0001\nP\nf m + v, \u2212z \u2212 21 \u03c9 (m, v) .\nAM \u25e6 ,L\u25e6\nAM \u25e6 ,L\u25e6\n\nP\n\nm\u2208M\n\nNoting that AM \u25e6 ,L\u25e6 = AM \u25e6 ,L\u25e6 , the result follows.\nThis concludes the proof of the lemma.\nA.7. Proof of Proposition 2.7.5. Let V \u2208 Symp. Let \u0001I \u25e6 = (I, oI ) be an oriented\nisotropic subspace in V . There is a map s : OLag I \u22a5 /I \u2212\u2192 OLag (V ), given by\n\u0001\ns (L, oL ) = pr\u22121 (L) , oI \u2297 oL ,\n\n\u0001\nfor (L, oL ) \u2208 OLag I \u22a5 /I , where pr : I \u22a5 \u2192 I \u22a5 /I is the natural projection and we\nuse the canonical isomorphism\nVtop\n\nVtop\nVtop\npr\u22121 (L) \u2243\nI\u2297\nL.\n\u0001\n\u2217\nFor every\nL\u25e6 \u2208 OLag I \u22a5 /I there is a \"pull-back\" map rL\n\u25e6 : Hs(L\u25e6 ) (V ) \u2192\n\u0001\n\u2217\nHL\u25e6 I \u22a5 /I defined as follows: Given f \u2208 Hs(L\u25e6 ) (V ), the function\nrL\n\u25e6 (f ) is the\n\u0001\n\u22a5\nrestriction f|Z*I \u22a5 , which descends to a function on H I /I . It is easy to verify\n\u0001\nI\n\u2217\nthat rL\nisomorphically onto HL\u25e6 I \u22a5 /I .\n\u25e6 maps Hs(L\u25e6 ) (V )\n\u0001\nLemma A.7.1. For every (M \u25e6 , L\u25e6 ) \u2208 OLag I \u22a5 /I\n\u2217\n\u2217\nFM \u25e6 ,L\u25e6 \u25e6 rL\n\u25e6 = rM \u25e6 \u25e6 Fs(M \u25e6 ),s(L\u25e6 ) .\n\n\u0001\nI \u2243\n\u2217\n\u22a5\nThe system {rL\n/I .\n\u25e6 } gives the required isomorphism \u03b1(I \u25e6 ,V ) : H (V ) \u2192 H I\nThis concludes the proof of the proposition.\nA.7.1. Proof of Lemma A.7.1. It will be convenient to work with the canonical system of kernels {KM \u25e6 ,L\u25e6 } (Proposition 2.5.2), recall we have FM \u25e6 ,L\u25e6 = I [KM \u25e6 ,L\u25e6 ].\nLet pr : I \u22a5 \u2192 I \u22a5 /I be the canonical projection and let i : I \u22a5 \u2192 V denote the\ninclusion. It is enough to show that\ni\u2217 Ks(M \u25e6 ),s(L\u25e6 ) = pr\u2217 KM \u25e6 ,L\u25e6 ,\n\u00012\nfor every (M \u25e6 , L\u25e6 ) \u2208 OLag I \u22a5 /I . This is done by direct verification using the\nformulas from Proposition 2.4.1. This concludes the proof of the lemma.\n\n\f22\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\nA.8. Proof of Lemma 3.4.1. The proof will proceed in several steps.\nStep 1. First, we prove that the sheaf p\u221712 K\u2217p\u221723 K is irreducible [n3 ]-perverse\ne \u221723 K\ne is irreducible\non U3 \u00d7 H (V) and for this, it is enough to show that p\u221712 K\u2217p\n[n3 ]-perverse on U3 \u00d7 H (V).\ne \u2217 K\ne can be written explicitly as\nThe convolution p\u221712 K\u2217p\n23\nZ\n\u0001\n\u25e6\ne \u221723 K(N\ne \u25e6 , M \u25e6 , L\u25e6 , h) \u2243\ne N \u25e6 , M \u25e6 , h * n\u22121 \u2297 K(M\ne\np\u221712 K\u2217p\nK\n, L\u25e6 , n).\nn\u2208N\n\nIt is enough to consider the case when h = m \u2208 M where we get\nZ\n\u25e6\ne \u2217 K(N\ne \u25e6 , M \u25e6 , L\u25e6 , m) \u2243\ne\n(A.6)\np\u221712 K\u2217p\nL\u03c8 (\u03c9 (n, m)) \u2297 K(M\n, L\u25e6 , n).\n23\nn\u2208N\n\nWe see\n\ne \u221723 K\ne (N \u25e6 , M \u25e6 , L\u25e6 , \u2212)\nthat p\u221712 K\u2217p\n|M is an application of l-adic Fourier\n\u25e6\n\u25e6\ne\ne \u2217 K\ne\nto K(M , L , \u2212)|N , hence, by the Katz\u2013Laumon theorem [16] p\u221712 K\u2217p\n23\n\ntransform\nis irreducible [n3 ]-perverse.\n\nRemark A.8.1. A more functorial way to describe the previous development is as\nfollows: Let Ci \u2192 U3 , i = 1, 2, 3, denote the tautological vector bundle with fibers\n(Ci )|(L\u25e6 ,L\u25e6 ,L\u25e6 ) = Li . What we showed is that\n1\n2\n3\n\u0011\n\u0010\n\u0011\n\u0010\ne \u2217 K\ne\ne |C ,\np\u221712 K\u2217p\n\u2243 F ourC2 ,C1 p\u221723 K\n23\n1\n|C2\n\nwhere F ourC2 ,C1 is the l-adic Fourier transform from Db (C1 ) to Db (C2 ), induced\nfrom the pairing w : C1 \u00d7U3 C2 \u2192 Ga,U3 .\n\nStep 2. It is enough to show that the sheaves p\u221713 K and p\u221712 K\u2217p\u221723 K are isomorphic on the zero section U3 \u00d7 {0} \u2282 U3 \u00d7H (V). We have\ne \u2217 K.\ne\np\u221712 K\u2217p\u221723 K \u2243 p\u221712 A \u2297 p\u221723 A \u2297 p\u221712 K\u2217p\n23\n\nDirect computation reveals that\n\ne \u221723 K(N\ne \u25e6 , M \u25e6 , L\u25e6 , 0)\np\u221712 K\u2217p\n\n\u2243\n\nZ\n\nn\u2208N\n\n\u0001\nL\u03c8 ( 21 \u03c9 rM (n) , n ),\n\nwhere rM : N \u2192 L is the linear map defined by the relation rM (n) \u2212 n \u2208 M for\nV\nV\nM\n: top N \u2192 top L. There exists an\nevery n \u2208 N. The map rM induces a map r\u2227\nisomorphism\n\u0013\n\u0012\nZ\nn\n\u0001\n\u0001\n1\nM\n(oN ) , oN ).\n\u03c9 rM (n) , n \u2243 G1\u2297n \u2297 L\u03c3 ((\u22121)( 2 ) \u03c9\u2227 r\u2227\nL\u03c8\n2\nn\u2208N\n\nCombining everything together we obtain\np\u221712 K\u2217p\u221723 K(N \u25e6 , M \u25e6 , L\u25e6 , 0)\nn\n\u0001\nM\n(oN ) , oN ))[4n] (2n)\n\u2243 G1\u22973n \u2297 L\u03c3 ((\u22121)( 2 ) \u03c9 \u2227 (oM , oN ) * \u03c9 \u2227 (oL , oM ) * \u03c9\u2227 r\u2227\nn\n\u0001\n+n\nM\n(oN ) , oN )) [2n] (n)\n\u2243 G1\u2297n \u2297 L\u03c3 ((\u22121)( 2 ) \u03c9 \u2227 (oM , oN ) * \u03c9 \u2227 (oL , oM ) * \u03c9\u2227 r\u2227\n\nn\n\u2243 G1\u2297n \u2297 L\u03c3 ((\u22121)( 2 ) \u03c9 \u2227 (oL , oN )) [2n] (n)\n\n\u2243 p\u221713 K(N \u25e6 , M \u25e6 , L\u25e6 , 0).\n\n\fQUANTIZATION OF SYMPLECTIC VECTOR SPACES OVER FINITE FIELDS\n\n23\n\nn\n\nwhere in the second isomorphism we used G1\u22972n \u2243 L\u03c3 ((\u22121) )[\u22122n](\u2212n) and the\nthird isomorphism follows from the identity\n\u0001\nn\n\u22121\nM\n(oN ) , oN ) = (\u22121) \u03c9 \u2227 (oN , oL ) * \u03c9 \u2227 (oM , oN ) \u03c9 \u2227 (oM , oL ) ,\n\u03c9 \u2227 r\u2227\nwhich is proved similarly to Lemma A.1.2.\nThis concludes the proof of Lemma 3.4.1.\n\nA.9. Proof of Lemma 3.4.2. Lemma 3.4.1 implies that the sheaves p\u221713 K and\np\u221712 K\u2217p\u221723 K are isomorphic on the open subvariety U3 \u00d7 H (V) \u2282 V3 \u00d7 H (V). The\nsheaf p\u221713 K is irreducible [n3 ]-perverse as a pull-back by a smooth, surjective with\n2\nconnected fibers morphism, of an irreducible [n2 ]-perverse sheaf on OLag (V) \u00d7\n\u2217\n\u2217\nH (V). Hence, it is enough to show that the sheaf p12 K\u2217p23 K is irreducible [n3 ]perverse.\nThe last assertion follows from the fact that p\u221712 K\u2217p\u221723 K is principally an application of a, properly normalized, Fourier transform (see Formula (A.6)) on p\u221723 K,\nhence by the Katz\u2013Laumon theorem [16] it is irreducible [n3 ]-perverse.\nLet us summarize. We showed that both sheaves p\u221713 K and p\u221712 K\u2217p\u221723 K are irreducible [n3 ]-perverse and are isomorphic on an open subvariety. This implies that\nthey must be isomorphic. This concludes the proof of the lemma.\nReferences\n[1] Bernstein J., Private communication, Max Planck Institute, Bonn, Germany (August, 2004).\n[2] Beilinson A., Bernstein J. and Deligne P. Faisceaux pervers. Analysis and topology on singular\nspaces, I, Asterisque, 100, Soc. Math. France, Paris (1982), 5\u2013171.\n[3] Bates S, and Weinstein A., Lectures on the geometry of quantization. Berkeley Mathematics\nLecture Notes, 8. American Mathematical Society, Providence, RI (1997).\n[4] Deligne P., La conjecture de Weil II. Publ. Math. I.H.E.S 52 (1981), 313\u2013428.\n[5] Gabber O., Private communication (2006).\n[6] Gaitsgory D., Informal introduction to geometric Langlands. An introduction to the Langlands program, Jerusalem 2001 , Birkhauser, Boston, MA (2003) 269\u2013281.\n[7] G\u00e9rardin P., Weil representations associated to finite fields. J. Algebra 46, no. 1, (1977),\n54\u2013101.\n[8] Gurevich S. and Hadani R., Heisenberg Realizations, Eigenfunctions and Proof of the\nKurlberg\u2013Rudnick Supremum Conjecture. arXiv:math-ph/0511036 (2005).\n[9] Gurevich S. and Hadani R., Notes on quantization of symplectic vector spaces over finite fields.\nProceedings of the EMS Summer School, Arithmetic and Geometry Around Quantization,\nIstanbul, June 5\u201315 2006 (Editors: O. Ceyhan, Yu. I. Manin and M. Marcolli). To appear\n(2006).\n[10] Grothendieck A., Formule de Lefschetz et rationalit\u00e9 des fonctions L. Seminaire Bourbaki,\nVol. 9, Exp. No. 279 (1964).\n[11] Guillemin V. and Sternberg S., Some problems in integral geometry and some related problems in microlocal analysis. Amer. J. Math. 101 (1979).\n[12] Hadani R., The geometric Weil Representation and some applications, Ph.D. Thesis, Tel\nAviv University (2006).\n[13] Howe R., On the character of Weil's representation. Trans. Amer. Math. Soc. 177 (1973),\n287\u2013298.\n[14] Kazhdan D., Private communication, Hebrew University, Jerusalem, Israel (March, 2004).\n[15] Kirillov, A. A. Unitary representations of nilpotent Lie groups. Uspehi Mat. Nauk 17 (1962).\n[16] Katz N. M. and Laumon G., Transformation de Fouri\u00e9r et majoration de sommes exponenti\u00e8lles. Inst. Hautes Etudes Sci. Publ. Math. No. 62 (1985), 361\u2013418.\n[17] Kostant B., Quantization and Unitary Representations. Lecture Notes in Math. 170,\nSpringer-Verlag (1970), 87\u2013207.\n[18] Lion G. and Vergne M., The Weil representation, Maslov index and theta series. Progress in\nMathematics, 6. Birkh\u00e4user, Boston, Mass (1980).\n\n\f24\n\nSHAMGAR GUREVICH AND RONNY HADANI\n\n[19] Weil A., Sur certains groupes d'operateurs unitaires. Acta Math. 111 (1964) 143\u2013211.\n[20] Weinstein A., Symplectic geometry. Bull. Amer. Math. Soc. (N.S.) 5, no. 1 (1981) 1\u201313.\n[21] Weinstein A., The symplectic \"category\". Differential geometric methods in mathematical\nphysics. Lecture Notes in Math., 905, Springer, Berlin-New York (1982) 45\u201351.\nDepartment of Mathematics, University of California, Berkeley, CA 94720, USA.\nE-mail address: shamgar@math.berkeley.edu\nDepartment of Mathematics, University of Chicago, IL 60637, USA.\nE-mail address: hadani@math.uchicago.edu\n\n\f"}