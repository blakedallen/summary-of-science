{"id": "http://arxiv.org/abs/0909.3557v1", "guidislink": true, "updated": "2009-09-21T19:56:59Z", "updated_parsed": [2009, 9, 21, 19, 56, 59, 0, 264, 0], "published": "2009-09-21T19:56:59Z", "published_parsed": [2009, 9, 21, 19, 56, 59, 0, 264, 0], "title": "Simulations of Binary Black Hole Mergers Using Spectral Methods", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.1222%2C0909.3557%2C0909.1938%2C0909.3964%2C0909.3456%2C0909.0626%2C0909.4877%2C0909.2920%2C0909.3440%2C0909.1461%2C0909.5484%2C0909.3606%2C0909.4129%2C0909.5344%2C0909.5244%2C0909.3045%2C0909.4458%2C0909.2442%2C0909.3431%2C0909.2722%2C0909.5079%2C0909.4768%2C0909.3785%2C0909.5468%2C0909.3678%2C0909.2509%2C0909.0638%2C0909.4632%2C0909.5527%2C0909.3382%2C0909.1038%2C0909.5296%2C0909.4073%2C0909.4332%2C0909.5438%2C0909.2391%2C0909.5664%2C0909.1022%2C0909.1142%2C0909.1229%2C0909.4983%2C0909.4449%2C0909.3342%2C0909.1589%2C0909.2511%2C0909.1071%2C0909.1499%2C0909.2263%2C0909.3752%2C0909.0525%2C0909.4853%2C0909.1272%2C0909.0259%2C0909.3210%2C0909.1759%2C0909.5672%2C0909.4112%2C0909.2998%2C0909.0785%2C0909.2931%2C0909.2398%2C0909.0391%2C0909.1064%2C0909.0944%2C0909.2829%2C0909.0742%2C0909.5564%2C0909.1992%2C0909.5095%2C0909.5283%2C0909.1518%2C0909.4977%2C0909.2234%2C0909.2159%2C0909.2997%2C0909.4153%2C0909.0764%2C0909.0987%2C0909.5599%2C0909.4560%2C0909.5208%2C0909.0255%2C0909.1133%2C0909.0911%2C0909.4997%2C0909.2785%2C0909.4212%2C0909.0419%2C0909.0718%2C0909.1043%2C0909.4910%2C0909.2232%2C0909.4134%2C0909.4425%2C0909.4748%2C0909.0127%2C0909.2477%2C0909.0536%2C0909.2924%2C0909.3112%2C0909.4057&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Simulations of Binary Black Hole Mergers Using Spectral Methods"}, "summary": "Several improvements in numerical methods and gauge choice are presented that\nmake it possible now to perform simulations of the merger and ringdown phases\nof \"generic\" binary black-hole evolutions using the pseudo-spectral evolution\ncode SpEC. These improvements include the use of a new damped-wave gauge\ncondition, a new grid structure with appropriate filtering that improves\nstability, and better adaptivity in conforming the grid structures to the\nshapes and sizes of the black holes. Simulations illustrating the success of\nthese new methods are presented for a variety of binary black-hole systems.\nThese include fairly ``generic'' systems with unequal masses (up to 2:1 mass\nratios), and spins (with magnitudes up to 0.4 M^2) pointing in various\ndirections.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.1222%2C0909.3557%2C0909.1938%2C0909.3964%2C0909.3456%2C0909.0626%2C0909.4877%2C0909.2920%2C0909.3440%2C0909.1461%2C0909.5484%2C0909.3606%2C0909.4129%2C0909.5344%2C0909.5244%2C0909.3045%2C0909.4458%2C0909.2442%2C0909.3431%2C0909.2722%2C0909.5079%2C0909.4768%2C0909.3785%2C0909.5468%2C0909.3678%2C0909.2509%2C0909.0638%2C0909.4632%2C0909.5527%2C0909.3382%2C0909.1038%2C0909.5296%2C0909.4073%2C0909.4332%2C0909.5438%2C0909.2391%2C0909.5664%2C0909.1022%2C0909.1142%2C0909.1229%2C0909.4983%2C0909.4449%2C0909.3342%2C0909.1589%2C0909.2511%2C0909.1071%2C0909.1499%2C0909.2263%2C0909.3752%2C0909.0525%2C0909.4853%2C0909.1272%2C0909.0259%2C0909.3210%2C0909.1759%2C0909.5672%2C0909.4112%2C0909.2998%2C0909.0785%2C0909.2931%2C0909.2398%2C0909.0391%2C0909.1064%2C0909.0944%2C0909.2829%2C0909.0742%2C0909.5564%2C0909.1992%2C0909.5095%2C0909.5283%2C0909.1518%2C0909.4977%2C0909.2234%2C0909.2159%2C0909.2997%2C0909.4153%2C0909.0764%2C0909.0987%2C0909.5599%2C0909.4560%2C0909.5208%2C0909.0255%2C0909.1133%2C0909.0911%2C0909.4997%2C0909.2785%2C0909.4212%2C0909.0419%2C0909.0718%2C0909.1043%2C0909.4910%2C0909.2232%2C0909.4134%2C0909.4425%2C0909.4748%2C0909.0127%2C0909.2477%2C0909.0536%2C0909.2924%2C0909.3112%2C0909.4057&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Several improvements in numerical methods and gauge choice are presented that\nmake it possible now to perform simulations of the merger and ringdown phases\nof \"generic\" binary black-hole evolutions using the pseudo-spectral evolution\ncode SpEC. These improvements include the use of a new damped-wave gauge\ncondition, a new grid structure with appropriate filtering that improves\nstability, and better adaptivity in conforming the grid structures to the\nshapes and sizes of the black holes. Simulations illustrating the success of\nthese new methods are presented for a variety of binary black-hole systems.\nThese include fairly ``generic'' systems with unequal masses (up to 2:1 mass\nratios), and spins (with magnitudes up to 0.4 M^2) pointing in various\ndirections."}, "authors": ["B\u00e9la Szil\u00e1gyi", "Lee Lindblom", "Mark A. Scheel"], "author_detail": {"name": "Mark A. Scheel"}, "author": "Mark A. Scheel", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevD.80.124010", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0909.3557v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0909.3557v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "16 pages, 16 figures", "arxiv_primary_category": {"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0909.3557v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0909.3557v1", "journal_reference": "Phys. Rev. D 80:124010 (2009)", "doi": "10.1103/PhysRevD.80.124010", "fulltext": "Simulations of Binary Black Hole Mergers Using Spectral Methods\nB\u00e9la Szil\u00e1gyi, Lee Lindblom, and Mark A. Scheel\nTheoretical Astrophysics 350-17, California Institute of Technology, Pasadena, CA 91125\n(Dated: September 22, 2009)\n\narXiv:0909.3557v1 [gr-qc] 21 Sep 2009\n\nSeveral improvements in numerical methods and gauge choice are presented that make it possible\nnow to perform simulations of the merger and ringdown phases of \"generic\" binary black-hole\nevolutions using the pseudo-spectral evolution code SpEC. These improvements include the use of\na new damped-wave gauge condition, a new grid structure with appropriate filtering that improves\nstability, and better adaptivity in conforming the grid structures to the shapes and sizes of the\nblack holes. Simulations illustrating the success of these new methods are presented for a variety of\nbinary black-hole systems. These include fairly \"generic\" systems with unequal masses (up to 2:1\nmass ratios), and spins (with magnitudes up to 0.4M 2 ) pointing in various directions.\n\nI.\n\nINTRODUCTION\n\nBlack-hole science took a great stride forward in 2005\nwhen Pretorius [1] performed the first successful full nonlinear dynamical numerical simulation of the inspiral,\nmerger, and ringdown of an orbiting black-hole binary\nsystem; this initial success then stimulated other groups\nto match this achievement within months [2, 3]. These\ndevelopments lead quickly to advances in our understanding of black-hole physics: investigations of the orbital\nmechanics of spinning binaries [4, 5, 6, 7, 8, 9], studies of\nthe recoil from the merger of unequal mass binary systems [10, 11, 12, 13], the remarkable discovery of unexpectedly large recoil velocities from the merger of certain\nspinning binary systems [7, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26], investigations into the mapping\nbetween the binary black-hole initial conditions (individual masses and spins) and the final state of the merged\nblack hole [27, 28, 29, 30, 31, 32, 33, 34], and improvements in our understanding of the validity of approximate binary black-hole orbital calculations using postNewtonian methods [35, 36, 37, 38, 39, 40, 41, 42].\nThese first results on binary black-hole systems were\nobtained by several different groups using different codes\nbased on two different formulations of the Einstein equations (BSSN and generalized harmonic), using two different methods for treating the black-hole interiors (moving puncture and excision), and using rather different\ngauge conditions to fix the spacetime coordinates. All\nof these early results, however, were obtained with codes\nbased on finite difference numerical methods and adaptive mesh refinement for computational efficiency. The\nCaltech/Cornell collaboration decided a number of years\nago to follow a different path by developing an Einstein\nevolution code, called SpEC, based on spectral methods.\nThe advantages of spectral methods are their superior accuracy and computational efficiency, and their extremely\nlow numerical dissipation that is ideal for solving wave\npropagation problems with high precision. The disadvantages are the relative complexity of spectral codes, the\nlack of any appropriate pre-existing spectral code infrastructure (analagous to CACTUS [43] for example), and\nthe extreme sensitivity of spectral algorithms to develop-\n\ning instabilities when any aspect of the solution method is\nmathematicaly ill-posed. Consequently it has taken our\ngroup somewhat longer to bring SpEC up to the level of\nthe state-of-the-art codes in the field.\nWe, along with our Caltech/Cornell collaborators,\nhave developed a large number of numerical and analytical tools over the years that make it possible for SpEC to\nevolve binary black-hole systems with greater precision\nthan any other code (at the present time) [44]. These\ntechnical developments include the derivation and implementation of constraint preserving and physical (no incoming gravitational wave) boundary conditions [45, 46],\ndual frame evolution methods and feedback and control\nsystems to lock the computational grids onto the location\nof the black holes [47], and special angular filtering methods needed to cure an instability that occurs when tensor\nfields are evolved [48]. Using these methods we and our\ncollaborators have performed a number of high precision\nevolutions of the inspiral portions of binary black-hole\nsystems, and have used the gravitational waveforms from\nthese evolutions to calibrate the accuracy of the approximate post-Newtonian waveforms that are widely used in\ngravitational wave data analysis [49, 50, 51, 52].\nDuring the past year our group has begun to have some\nsuccess in performing the more dynamical and difficult\n(for spectral codes) merger and ringdown portions of binary black-hole evolutions [50, 52, 53, 54, 55, 56]. The\ntechniques we used to achieve these first merger calculations turned out to be rather non-robust however, requiring a great deal of hands-on adjustment and fine tuning\nfor each new case we attempted. In this paper we report\non several new numerical and analytical developments\nthat allow us now to perform stable and accurate binary\nmerger and ringdown simulations of a fairly wide range\nof binary black-hole systems. These new methods appear to be quite robust, and no fine tuning is required:\nthe same basic method works on each of the cases we\nhave attempted.\nThe three new technical breakthroughs that allow us\nnow to perform successful binary black-hole merger and\nringdown simulations are described in Sec. II. These major advances include the development of a new gauge\ncondition that works extremely well with the generalized\nharmonic formulation of the Einstein system used in our\n\n\f2\ncode. This new gauge chooses spatial coordinates that\nare solutions of a damped wave equation, and chooses\nthe time coordinate in a way that limits the growth of\n\u221a\ng/N , here g is the determinant of the spatial metric\nand N is the lapse function. This new gauge condition is\ndescribed in some detail in Sec. II A. Another important\ndevelopment, reported in Sec. II B, is the construction of\na new grid structure on which our binary black-hole evolutions are performed. This new non-overlapping grid\nstructure, and a certain type of spectral filtering used\nwith the new grid structure, removes a class of numerical\ninstabilities that were a limiting factor in our ability to\nperform the highly dynamical portions of merger calculations, and allows us to increase resolution near the black\nholes in a more targeted and computationally efficient\nway. The third technical development is a new more efficient and robust method to conform the structure of the\ngrid to the shape and size of the black holes in an automatic dynamical way. These developments are described\nin Sec. II C and the Appendix .\nUsing these new technical tools we have now performed\nsuccessful merger and the succeeding ringdown simulations of a fairly wide range of binary black-hole systems.\nWe describe in Sec. III merger simulations for six reasonably diverse cases. These include two systems in which\nthe black holes are non-spinning: one has equal mass\nblack holes, the other has holes with a 2:1 mass ratio.\nWe also describe successful merger and ringdown calculations with two different equal-mass binary systems in\nwhich the holes have identical intrinsic spins of magnitude 0.4M 2 : aligned to the orbital angular momentum in\none system, and anti-aligned in the other. We have also\nperformed successful merger and ringdown simulations\non two fairly generic binary systems. These two systems\nhave black holes with the same mass ratio M2 /M1 = 2,\nand the same \"randomly oriented\" initial spins of magnitudes 0.2M12 and 0.4M22 respectively. But the initial separations of the holes are different in the two cases: one\nstarts about 8.5 orbits before merger, and another (used\nto perform careful convergence studies) starts about 1.5\norbits before merger. The same methods were used to\nperform all of these merger and ringdown simulations,\nand no particular fine tuning was required.\n\nII.\n\nTECHNICAL DEVELOPMENTS\n\nThis section describes the three new technical breakthroughs that allow us now to perform successful binary\nblack-hole merger and ringdown simulations. These major advances include the development of a new gauge\ncondition, described in Sec. II A, in which the spatial coordinates satisfy a damped wave equation and the time\ncoordinate is chosen in a way that controls the growth\nof the spatial volume element. Another important development, described in Sec. II B, is a new non-overlapping\ngrid structure for our binary black-hole simulations, and\na type of spectral filtering for these new grid structures\n\nthat improves their accuracy and stability. The third new\ntechnical development, described in Sec. II C, is a more\nefficient and robust method of conforming the structure\nof the grid to the shape and size of the black holes in a\ndynamical and automatic way.\nA.\n\nDamped-Wave Gauge\n\nHarmonic gauge is defined by the condition that each\ncoordinate xa satisfies the co-variant scalar wave equation:\n\u2207c \u2207c xa = H a = 0.\n\n(1)\n\nHarmonic coordinates have proven to be extremely useful for analytical studies of the Einstein equations, but\nhave found only limited success in numerical problems\nlike simulations of complicated highly dynamical blackhole mergers. One reason for some of these difficulties\nis the wealth of \"interesting\" dynamical solutions to the\nharmonic gauge condition itself, Eq. (1). Since all \"physical\" dynamical fields are expressed in terms of the coordinates, an ideal gauge condition would limit coordinates to\nthose that are simple, straightforward, dependable, and\nnon-singular; having \"interesting\" dynamics of their own\nis not a desirable feature for coordinates. The dynamical\nrange available to harmonic coordinates can be reduced\nby adding a damping term to the equation: [57, 58]\n\u2207c \u2207c xa = \u03bcS tc \u2202c xa = \u03bcS ta ,\n\n(2)\n\nwhere ta is the future directed unit normal to the\nconstant-t hypersurfaces. Adding such a damping term\nto the equations for the spatial coordinates xi tends to\nremove extraneous gauge dynamics and drives the coordinates toward solutions of the co-variant spatial Laplace\nequation on the timescale 1/\u03bc. Choosing 1/\u03bc to be comparable to (or smaller than) the characteristic timescale\nof a particular problem should remove any extraneous coordinate dynamics on timescales shorter than the physical timescale. The addition of such a damping term in\nthe time-coordinate equation is not appropriate however.\nSuch a damped-wave time coordinate is driven toward a\nconstant value, and therefore toward a state in which it\nfails to be a useful time coordinate at all. It makes sense\nthen to use the damped-wave gauge condition only for\nthe spatial coordinates:\n\u2207c \u2207c xi = H i = \u03bcS ti = \u2212\u03bcS N i /N,\n\n(3)\n\nwhere N i is the shift, and N is the lapse. The appropriate contra-variant version of this damped-wave gauge\ncondition is therefore\nHa = \u2212\u03bcS gai N i /N,\n\n(4)\n\nwhere gab is the spatial metric of the constant-t hypersurfaces. (Note that we use Latin letters from the beginning\nof the alphabet, a, b, c, . . ., to denote four-dimensional\n\n\f3\nspacetime indices, and letters from the middle of the alphabet, i, j, k, . . ., for three-dimensional spatial indices.)\nWhile the damped-wave gauge is a poor choice for the\ntime coordinate, the idea of imposing a gauge that adds\ndissipation to the gauge dynamics of the time coordinate\nis attractive. To find the appropriate expression for ta Ha ,\nthe component of Ha not fixed by Eq. (4), we note that\nthe gauge constraint Ha + \u0393a = 0 implies that ta Ha is\ngiven by\n\u0012\u221a \u0013\ng\na\na\nt Ha = t \u2202a log\n\u2212 N \u22121 \u2202k N k ,\n(5)\nN\nwhere g = det gij is the spatial volume element. In our\nexperience, a frequent symptom of the failure of simpler\ngauge conditions in binary black-hole simulations is an\nexplosive growth of g in the spacetime region near the\nblack-hole horizons. This suggests that a good use of the\nremaining gauge freedom would be to attempt to control\nthe growth of the spatial volume element, g. Choosing\nthe gauge condition,\n\u0012\u221a \u0013\ng\na\n,\n(6)\nt Ha = \u2212\u03bcL log\nN\ntogether with Eq. (5) implies the following evolution\n\u221a\nequation for g/N :\nta \u2202a log\n\n\u0012\u221a \u0013\n\u0012\u221a \u0013\ng\ng\n+ \u03bcL log\n= N \u22121 \u2202k N k ,\nN\nN\n\nhole always evolved quickly toward a non-singular timeindependent equilibrium state.\nThe solutions to the lapse gauge condition, Eq. (7),\n\u221a\ncan be thought of as equating log( g/N ) to a certain\nweighted time average of \u2202k N k /N . The timescale associated with this time averaging is set by \u03bcL , which de\u221a\ntermines for example the rate at which g/N is driven\ntoward an asymptotic equilibrium state. When \u03bcL is con\u221a\nstant, it is easy to show that g/N is driven exponentially toward this asymptotic state. In highly dynamical\n\u221a\nspacetimes, however, we find that g/N must be driven\neven faster than exponential in order to prevent the formation of singularities in g. This can be accomplished by\nmaking \u03bcL larger whenever g becomes large. In practice\n\u221a\nwe find that the choice \u03bcL = \u03bc0 [log( g/N )]2 , (where \u03bc0\nis a constant or perhaps a function of time) is very effective at suppressing the growth of these singularities. We\nfind that choosing the same damping factor \u03bcS ,\n\u0014 \u0012 \u221a \u0013\u00152\ng\n\u03bcS = \u03bcL = \u03bc0 log\n,\n(9)\nN\nfor the spatial part of the gauge condition is also quite\neffective. The binary black-hole merger and ringdown\nsimulations described in Sec. III use these \u03bcL and \u03bcS ,\nwith \u03bc0 taken to be an order-unity function of time (to\naccomodate starting up evolutions from initial data satisfing a different gauge condition).\n\n(7)\n\n\u221a\nwhose solutions tend to suppress growth in g/N . The\ndiscussion of this gauge condition in Ref. [57] shows that\nit also implies that the lapse N satisfys a damped wave\nequation, with the damping factor \u03bcL . So in this sense,\nthe gauge condition on the time coordinate, Eq. (6), is\nthe natural extension of the spatial-coordinate dampedwave gauge condition, Eq. (4).\nCombining this new lapse condition, Eq. (6), with the\ndamped-wave spatial coordinate condition, Eq. (4), gives\nthe gauge-source function for our full damped-wave gauge\ncondition:\n\u0012\u221a \u0013\ng\nHa = \u03bcL log\nta \u2212 \u03bcS N \u22121 gai N i .\n(8)\nN\nThe damping factors \u03bcL \u2265 0 and \u03bcS \u2265 0 can be chosen\nquite arbitrarily as functions of spacetime coordinates xa ,\nor even as functions of the spacetime metric \u03c8ab . The\ngauge source function Ha depends only on coordinates\nand the spacetime metric \u03c8ab in this case, so these gauge\nconditions can be implemented directly in the generalized\nharmonic Einstein system without the need for a gauge\ndriver. Previous studies of this condition (developed initially as a test of the first-order gauge-driver system [57])\nshowed it to be quite useful for evolving single black-hole\nspacetimes. In those tests, which included several different evolutions of maximal-slice Schwarzschild initial data\nwith large non-spherical gauge perturbations, the black\n\nB.\n\nGrid Structure and Filtering\n\nThe pseudo-spectral numerical methods used by our\ncode, the Spectral Einstein Code (SpEC) [45, 47, 59], represent dynamical fields on a spatial grid structure that is\nspecially constructed for each problem. For binary blackhole simulations, our group has been using grid structures\nconstructed from layers of spherical-shell subdomains\ncentered on each black hole, surrounded and connected\nby cylindrical, cylindrical-shell, and/or rectangular-block\nsubdomains, all surrounded by spherical-shell subdomains that extend to the outer boundary of the computational domain (located far from the holes). The\nintermediate-zone cylindrical-shell and/or rectangularblock subdomains must overlap both the inner and outer\nspherical-shell subdomains in these grid structures to\ncover the computational domain completely. These grid\nstructures are quite efficient, and have allowed our group\nto perform long stable inspiral calculations for a variety\nof simple binary black-hole systems [47, 49, 52, 60], and\nalso simulations of the merger and ringdown phases of a\nfew of these simple cases [53, 56]. The overlap regions in\nthese grid structures are well behaved in these successful\ncases. But in more generic inspiral and merger simulations, these overlap regions become significant sources of\nnumerical error and instability.\nThe overlap-related instability discussed above is most\nlikely caused by the method we use to exchange information between adjacent subdomains. We set the incoming\n\n\f4\n\nFIG. 2: Grid structure around each black hole. A series of\nspherical shells (two shells shown) is surrounded by a series of\ncubed-sphere layers (three shown) to fill up a cube. This figure illustrates one quarter of the cube structure surrounding\none of the black holes.\nFIG. 1: Illustrates a basic element of the grid structure used\nto fill the 3D volume between a sphere and a concentric cube.\n\ncharacteristic fields, whose values are determined by interpolation from the adjacent subdomain, using a penalty\nmethod [61, 62, 63, 64]. This penalty method for imposing boundary conditions was derived explicitly for the\ncase where adjacent subdomain boundaries touch but do\nnot overlap. One possibility for resolving this instability\nwould be to re-derive the appropriate penalty boundary\nterms for the case of overlapping subdomains. We have\nchosen the simpler option of constructing new grid structures without overlapping subdomains. We do this by\nchanging the intermediate-zone grid structure from the\ncylindrical-shells and/or rectangular blocks used previously into a series of deformed rectangular blocks whose\nboundaries conform to the spherical shells used near the\ninner and outer boundaries. The new type of grid element needed for this construction is illustrated in Fig. 1,\nwhich shows how the 3D volume between a sphere and a\nconcentric cube can be mapped into six deformed cubes.\nThis construction is based on the \"cubed-sphere\" coordinate representations of the sphere (i.e. the mapping of\nthe six faces of the cube onto the sphere as illustrated in\nFig. 1), that is widely used in atmospheric and geophysical modeling [65, 66, 67, 68]. Three-dimensional grid\nstructures based on cubed spheres have also been used\nin other types of simulations, including a few black-hole\nsimulations [69, 70].\nOur new grid structure is illustrated in Figs. 2 and 3.\nIt consists of a series of spherical-shell subdomains and\nseveral layers of cubed-sphere subdomains surrounding\neach black hole, as illustrated in Fig. 2. The two cubic blocks containing the black holes are surrounded by\na series of rectangular-block subdomains to fill out the\nvolume of a large cube. The center of this large cube\nis placed at the center-of-mass of the binary system, as\nillustrated in Fig. 3 for a system having a 2:1 mass ratio.\nThis large cube is connected to the outer spherical-shell\n\nFIG. 3: Illustrates the intermediate grid structure surrounding the two black holes, consisting of a set of rectangular\nblocks placed around the cubic block containing each hole.\nThis collection of blocks filles up a cube which is surrounded\nby a series of cubed-sphere layers (two shown) all surrounded\nby a series of spherical shells (one shell shown) that are centered on the center of mass of the binary system.\n\nsubdomains by several additional layers of cubed-sphere\nsubdomains, also illustrated in Fig. 3.\nPrevious attempts to use this type of cubed-sphere grid\nstructure in SpEC have always proven unsuccessful, due\nto numerical instabilities at the interdomain boundaries.\nThese previous attempts used no spectral filtering, or a\ntwo-thirds anti-aliasing filter, in the cubed-sphere subdomains. It has been shown, however, that an appropriate\nfilter is required for stability (and improved accuracy) of\nChebyshev polynomial spectral expansions, such as those\nused in these cubed-sphere subdomains. Such a filter\nmust satisfy two important conditions. The first criterion\nis that when represented in physical space, this filter must\nact like a dissipation term in the evolution equations that\nvanishes on the subdomain boundaries (to avoid conflicting with the boundary conditions). The second criterion\nis that it must set the highest spectral coefficient to zero.\nAdding this type of spectral filtering turns out to be one\n\n\f5\nof the key elements in improving our numerical method\nenough to make possible the binary black-hole simulations described in Sec. III. The needed spectral filter is\napplied to each field u(x, t) that is expanded as a sum of\nChebyshev polynomials:\nX\nu(x, t) =\nuk (t)Tk (x).\n(10)\nk\n\nThese are used for the radial-coordinate expansions in\nthe spherical-shell subdomains, and for all three spectralcoordinate expansions in the rectangular-block and the\ncubed-sphere subdomains. Each spectral coefficient uk in\nthese expansions is filtered according to the expression,\n2p\n\nF (uk ) = uk e\u2212\u03b1(k/kmax ) ,\n\n(11)\n\nafter each time step. This filter satisfies the first necessary filter criterion by adding a 2pth -order dissipation\nterm to the evolution equations which vanishes on each\nsubdomain boundary [64]. For the binary black-hole\nsimulations presented here, we use the filter parameters\n\u03b1 = 36 and p = 32. The choice \u03b1 = 36 guarantees\nthat this filter satisfies the second necessary filter criterion by ensuring that the highest spectral coefficient is\nset to (double precision) zero, while the choice p = 32\ninsures that this is a very mild filter that only influences\nthe largest few spectral coefficients. This new filter is applied wherever Chebyshev expansions, Eq. (10), are used.\nWe use the same filter we have used in previous binary\nblack-hole simulations in the angular directions in the\nspherical-shell subdomains: we set to zero the top four lcoefficients in the tensor spherical-harmonic represention\nof each dynamical field [47, 48].\nC.\n\nAdaptive Conforming Grid\n\nOne of the important developments that allowed our\ngroup (several years ago) to begin performing successful\nbinary black-hole inspiral simulations was the introduction of the dual-coordinate-frame evolution method [47].\nThis method uses two distinct coordinate frames: One is\na non-rotating and asymptotically Cartesian coordinate\nsystem used to construct the tensor basis for the components of the various dynamical fields evolved by our code.\nThe second is a coordinate system chosen to follow (approximately) the motions of the black holes. We fix the\ncomputational grid to this second coordinate frame, and\nsolve the evolution equations for the \"inertial-frame\" tensor field components as functions of these \"grid-frame\"\ncoordinates. The map M connecting these grid frame\ncoordinates x\u0304i to the inertial frame xi , can be written as\nthe composition of more elementary maps:\nM = MK \u25e6 MS .\n\n(12)\n\nMK represents a \"kinematical\" map that keeps the centers of the black holes located (approximately) at the\n\ncenters of the excised holes in our grid structures (cf.\nSec. II B), and MS is a \"shape-control\" map that makes\nthe grid conform (approximately) to the shapes of the\nblack holes. The third major technical development\n(which makes it possible now for us to perform robust merger simulations) consists of improvements in the\nchoice of the shape-control map, MS , and improvements\nin the way this map is adapted to the dynamically changing shapes of the black holes.\nThe kinematical map MK can itself be decomposed\ninto more elementary maps:\nMK = MT \u25e6 ME \u25e6 MR .\n\n(13)\n\nThe maps MT , ME , and MR each move the centers\nof the black holes, but do not significantly distort their\nshapes: The map MT translates the grid to account for\nthe motion of the center of the system due to linear momentum being exchanged with the near field [54] and\nbeing emitted in gravitational radiation. The map ME\ndoes a conformal rescaling that keeps the coordinate distance between the centers of the two black holes fixed in\nthe grid frame, as they inspiral in the inertial frame. And\nMR rotates the frame so that the centers of the two black\nholes remain on the x\u0304 axis in the grid frame, as they move\nalong their orbits in the inertial frame. These maps are\nalso used during inspiral simulations in the same way we\nuse them for our merger simulations. So here we focus on\nthe new shape-control map MS , which is one of the critical new developments that made the merger simulations\nreported in Sec. III possible.\nThe interiors of the black holes are excised in our simulations at the spherical boundaries shown in Figs. 2 and\n3. This is possible because, if this excision boundary is\nchosen wisely, the spacetime inside this boundary can\nnot influence the spacetime region covered by our computational grid. For hyperbolic evolution systems, like the\ngeneralized harmonic form of the Einstein equations used\nin our code [45], boundary conditions must be placed\non each incoming characteristic field at each boundary\npoint. Apparent horizons are surfaces that are often used\nto study black holes, because they can be found numerically in a fairly straightforward way, and because (if they\nexist at all) they are always located within the true event\nhorizons. If the excision bounaries for our computational\ndomain were placed exactly on the apparent horizons,\nthen all the characteristic fields of the Einstein system\nwould be outflowing (with respect to the computational\ndomain) since apparent horizons are spacelike (or null)\nhypersurfaces. Boundary conditions would not be needed\non any field at such boundaries. Unfortunately we are not\nable to place excision boundaries precisely on the apparent horizons. So the best that can be done numerically is\nto place them slightly inside the apparent horizons (i.e.,\nthe apparent horizons must remain within the computational domain), if we are to avoid the need for boundary\nconditions on these excision surfaces.\nHowever, if an excision boundary is placed inside an\napparent horizon, the outflow condition is no longer auto-\n\n\f6\nmatic or simple: the condition depends on the shape and\nthe location of the excision boundary, its motion with\nrespect to the horizon, and the gauge. In our simulations, the excision boundaries are kept somewhat inside\nthe apparent horizons, so the outflow condition can-and\ndoes-fail if we are not careful. One reason (and probably the principal reason) we need to control the shapes\nof the computational domains through the map MS is to\nkeep pure outflow conditions on all the dynamical fields\nat the excision boundaries. We do this, as described in\nmore detail below, by requiring that the excision boundaries closely track the shapes and sizes of the horizons.\nAnother (probably secondary) reason that shape and\nsize control are needed in our numerical simulations is\nrelated to finite numerical resolution. If the excision\nboundaries had different shapes than the horizons, then\nsome points on the boundaries would be located deeper\ninto the black-hole inerior and hence closer to the spacetime singularity. Higher numerical resolution would be\nneeded at these points, and for fixed resolution, the\namount of constraint violation and errors in the solution\nwould be largest there. In many situations we find that\nnumerical instabilities at these points cause our simulations to fail. This mode of failure can be eliminated by\nkeeping the shapes and sizes of the boundaries close to\nthose of the horizons.\nWe have decomposed the map M, which connects\nthe grid-frame coordinates x\u0304i with inertial-frame coordinates xi , into kinematical and shape-control parts:\nM = MK \u25e6 MS . It will be convenient to have a name\nfor the intermediate coordinate system whose existence is\nimplied by this split. The map MK connects the inertialframe coordinates xi with coordinates x\u0303i in which the\ncenters of the black holes are at rest (approximately). So\nit is natural to call these intermediate-frame coordinates,\nx\u0303i , the \"rest frame\" coordinate system. The shape control map MS connects the grid-frame coordinates x\u0304i with\nthese rest-frame coordinates x\u0303i .\nIt is useful to express the shape-control map MS as\nthe composition of maps acting on each black hole individually: MS = MS1 \u25e6 MS2 . Such individual black-hole\nshape-control maps can be written quite generally in the\nform\n\u03b8\u0303A = \u03b8\u0304A ,\n\n(14)\n\n\u03c6\u0303A = \u03c6\u0304A ,\nr\u0303A = r\u0304A \u2212 fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A )\n\n(15)\n\n\u00d7\n\nlX\nmax\n\nl\nX\n\n\u03bblm\nA (t)Ylm (\u03b8\u0304A , \u03c6\u0304A ),\n\n(16)\n\nl=0 m=\u2212l\n\nwhere (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) and (r\u0303A , \u03b8\u0303A , \u03c6\u0303A ) are, respectively, the\ngrid-frame and rest-frame spherical polar coordinates\ncentered at the (fixed) grid-coordinate location of black\nhole A = {1, 2}. The functions fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) are fixed\nfunctions of space in the grid frame. We note that these\nmaps become the identity whenever fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) = 0,\nso making fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) vanish as r\u0304A \u2192 \u221e ensures that\n\nthe distortion is limited to the neighborhood of each black\nhole. The parameters \u03bblm\nA (t) specify the angular structure of the distortion map. They are determined by a\nfeedback control system (discussed in Appendix ) that\ndynamically adjusts the shape and overall size of the grid\nframe coordinates relative to the rest-frame coordinates.\nThe Caltech/Cornell collaboration has used shapecontrol maps of this form, Eqs. (14)\u2013(16), in all of our\nrecent binary black-hole simulations [53, 54, 56]. In\nthose cases the functions fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) were taken to\nbe smooth functions of r\u0304A alone: roughly constant near\neach black hole and falling off to zero rapidly enough that\nMS1 and MS2 approximately commute. These functions\nhad large gradients which made it difficult to control the\ngrid distortion near the horizons without introducing additional unwanted distortions elsewhere. As a result, we\nwere never able to achieve very robust shape control using these maps.\nOne of our major breakthroughs, leading to the successful merger results reported here, is an improvement\nin our choice of the map functions fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ). We\nnow use simpler functions fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) that have much\nsmaller gradients and that are exactly zero outside (nonintersecting) compact regions surrounding each black\nhole. This means the new maps MS1 and MS2 commute,\nexactly. These new maps can be defined everywhere between the black holes because of the new non-overlapping\ngrid structure discussed in Sec. II B, but these improvements are achieved at the expense of smoothness: the\nnew fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) are smooth except at subdomain\nboundaries where they may only be continuous, not differentiable 1 . Fortunately, this lack of smoothness at\nsubdomain boundaries is not a problem for our basic evolution method. In our multidomain code the equations\nare solved independently on each subdomain, and subdomains communicate only by equating the appropriate\ncharacteristic fields at their mutual boundaries. These\nboundary conditions require no differentiation, so the\ngrid coordinates themselves need not be smooth across\nthese boundaries.\nThe new fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) are chosen to be unity inside a\nsphere of radius b\u0304A centered on black hole A={1,2}, then\ndecrease linearly with radius along a ray through the center of the black hole, and finally vanish on the surface of\na centered cube of size 2\u0101A . A two-dimensional sketch\nof this grid-frame domain is shown in Fig. 4, which is\nmerely an abstract version of the type of grid structures\nwe use around each black hole as illustrated in Figs. 1\nand 2. This function fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) can be expressed\n\n1\n\nThe idea of introducing non-smooth time-dependent mappings\nwas also suggested by Larry Kidder.\n\n\f7\n\n2 aA\n\nbA\n\nFIG. 4: Two-dimensional illustration of the grid-frame coordinate domain on which the function fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) is defined\nin Eq. (17).\nFIG. 5: Illustrates the inertial frame representation of the grid\nstructure around one black hole, just at the time of merger.\nThis grid structure has been distorted in relation to the inertial frame by the shape-control maps MS described here.\n\nanalytically as\n\uf8f1\n1,\n\uf8f4\n\uf8f2 r\u0304 \u2212 \u03c1\u0304\nA\nA\n,\nfA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) =\n\uf8f4 b\u0304A \u2212 \u03c1\u0304A\n\uf8f3\n0,\n\nr\u0304A \u2264 b\u0304A ,\n\nb\u0304A \u2264 r\u0304A \u2264 \u03c1A ,\n\n(17)\n\n\u03c1\u0304A \u2264 r\u0304A ,\n\nwhere\n\n\u03c1\u0304A (\u03b8\u0304A , \u03c6\u0304A ) = \u0101A\n(18)\n\u0002\n\u0001\u0003\u22121\n\u00d7 max | sin \u03b8\u0304A cos \u03c6\u0304A |, | sin \u03b8\u0304A sin \u03c6\u0304A |, | cos \u03b8\u0304A |\n\nis the value of r\u0304A on the surface of the cube of size 2\u0101A\ncentered on black hole A={1,2}. The different cases of the\nmaxima which appear in the denominator of Eq. (18)\ncorrespond to the different faces of this cube.\nWe note that the choice of fA (r\u0304A , \u03b8\u0304A , \u03c6\u0304A ) in Eq. (17)\nimplies that the shape-control map MS , and hence the\nmap between grid-frame and rest-frame coordinates is\nnot smooth. Since the kinematical map MK is smooth,\nthis also imples that the full map M relating grid-frame\nto inertial-frame coordinates is not smooth either. This\nnon-smoothness does not cause a problem for our basic\nevolution method, but it implies that calculations that\nrequire smoothness must not be performed in the grid\nframe. For example, the representation of a smooth apparent horizon in grid coordinates will not be smooth.\nSo apparent horizon finding and other calculations that\nrequire smoothness are done in the smooth rest-frame or\ninertial-frame coordinates.\nThe angular structures of the shape-control maps defined in Eq. (14)\u2013(16) are determined by the parameters \u03bblm\nA (t). These are chosen dynamically to ensure that\nthe shapes of the excision boundaries match the evolving\nshapes of the apparent horizons. These maps also control the sizes of the excision boundaries by adjusting \u03bb00\nA,\nwhich are chosn to ensure that the excision boundaries\nremain close to but safely inside the apparent horizons.\nFigure 5 illustrates the effect of this distortion map on the\nstructure of the grid surrounding a black hole in one of\n\nthe generic merger simulations described in Sec. III. The\nchoices of suitable target shapes and sizes for these shapecontrol maps, and the feedback control system that we\nuse to implement these choices dynamically in our simulations, are also among the critical technical advances\nthat allow us now to perform robust merger and ringdown\nsimulations. The details of exactly how this is done are\nsomewhat complicated, however, so we defer their discussion to the Appendix .\nIII.\n\nMERGER AND RINGDOWN\nSIMULATIONS\n\nIn this section we present simulations of the merger and\nringdown of binary black-hole systems using our Spectral\nEinstein Code (SpEC). In Section III A we describe the\nbinary black-hole initial data sets that we evolve. In Section III B we discuss our evolution algorithm, pointing\nout at which stage we employ the various improvements\ndescribed in Section II and what goes wrong when these\nimprovements are not used. Finally, in Section III C\nwe describe six different binary black-hole merger and\nringdown simulations peformed using these new methods. We present snapshots of the shapes and locations\nof the horizons at various times during the merger and\nringdown, and a demonstration of convergence of the constraint violations.\nA.\n\nInitial Data\n\nOur initial data are in quasi-equilibrium [71, 72, 73]\n(see also [74, 75]), and are built using the conformal\nthin sandwich formalism [76, 77] with the simplifying\n\n\f8\n~1 /M12\n~2 /M22\nCase M2 /M1\nS\nS\nNorbits\nA\n1\n0\n0\n16\nB\n2\n0\n0\n15\nC\n1\n\u22120.4\u1e91\n\u22120.4\u1e91\n11\nD\n1\n0.4\u1e91\n0.4\u1e91\n15\n\u221a\n\u221a\nE\n2\n0.2(\u1e91 \u2212 x\u0302)/ 2 \u22120.4(\u1e91 + \u0177)/ 2 8.5\n\u221a\n\u221a\nF\n2\n0.2(\u1e91 \u2212 x\u0302)/ 2 \u22120.4(\u1e91 + \u0177)/ 2 1.5\nTABLE I: Black hole binary configurations run through\nmerger and ringdown using the methods presented here. For\n~1 /M12 and S\n~2 /M22 , the \u1e91 direction\nthe initial spin parameters S\nis parallel to the orbital angular momentum.\n\nchoices of conformal flatness and maximal slicing. Quasiequilibrium boundary conditions are imposed on spherical excision boundaries for each black hole, with the lapse\nboundary condition given by Eq. (33a) of Ref. [73]. The\nspins of the black holes are determined by boundary conditions on the shift vector at each excision surface [72].\nThis formalism for constructing initial data also requires the initial radial velocity vr of each black hole toward its partner and an initial orbital angular frequency\n\u03a90 (chosen to be about the z axis without loss of generality). These parameters determine the orbital eccentricity of the binary, and can be tuned by an iterative\nmethod [56, 60] to produce data with very low eccentricity. This has been done for most of the initial data sets\ndescribed here (cases A through D in Table I), but is unnecessary for the purposes of the present paper, since our\ngoal here is simply to document our improved methods\nfor evolving binaries through merger. For cases E and F,\nvr and \u03a90 are chosen roughly by using post-Newtonian\nformulae that ignore spins.\nTable I shows the mass ratio and initial spins for the\nblack hole binary configurations we evolve here. The initial data and first 15 orbits of inspiral for case A are\nidentical to those presented in [49, 53]. The initial data\nand first 9 orbits of inspiral for case C are identical to\nthose presented in [56]. Cases E and F are fully generic,\nwith unequal masses and unaligned spins, and exhibit\nprecession and radiation-reaction recoil.\nB.\n\nEvolution procedure\n\nIn this section we summarize our procedure for evolving black hole binary systems through merger and ringdown, concentrating on the improvements discussed in\nSection II. This procedure can be divided into several\nstages, beginning with the early inspiral and extending\nthrough ringdown:\n1. Evolve early inspiral using \"quasi-equilibrium\"\ngauge.\n2. Transition smoothly to damped harmonic gauge.\n3. Eliminate overlapping subdomains.\n\n4. Turn on shape control.\n5. Replace remaining inner spherical shells with cubed\nspheres.\n6. Turn on size control just before holes merge.\n7. After merger, interpolate to a single-hole grid to\nrun through ringdown.\nThe above ordering of these stages is not the only possible choice: we have exchanged the order of some of these\nstages without trouble. For example, for the runs described here we perform stage 3 at the instant we start\nstage 2. The transitions between these stages are relatively simple, require little or no fine tuning, and can\nbe automated. We now discuss each of these stages in\nturn. For several of these stages, we will illustrate the effects of new improvements (Section II) for one particular\nevolution, case F of Table I.\n1.\n\nEarly inspiral\n\nThe gauge is chosen early in the evolution following the\nprocedure of Ref. [49]: the initial data are constructed in\nquasi-equilibrium, so we choose the initial Ha to make the\ntime derivatives of the lapse and shift zero. We attempt\nto maintain this quasi-equilibrium condition by demanding that Ha remains constant in time in the grid frame\nin the following sense: we require\n\u2202t\u0304 H\u0303\u0101 = 0,\n\n(19)\n\nwhere H\u0303a is a tensor (note that Ha is not a tensor)\ndefined so that H\u0303a = Ha in the inertial frame. The\nbars in Eq. (19) refer to the grid frame coordinates.\nWe refer to this as \"quasi-equilibrium\" gauge, although\nstrictly speaking this gauge maintains quasi-equilibrium\nonly when the spin directions are constant in the grid\nframe.\nFor cases A\u2013D, the simulations follow many orbits using this quasi-equilibrium gauge. For cases E and F, in\nwhich the spins change direction in the grid frame, this\ngauge is not appropriate and causes difficulties, so for\nthese cases we transition to harmonic gauge Ha = 0 very\nearly in the inspiral.\nDuring inspiral, the map ME uniformly contracts the\ngrid so that the grid-coordinate distance between the\ncenters of the two black holes remains constant. Because this contraction is uniform, the spherical-shell subdomains inside each apparent horizon shrink relative to\nthe horizon. This means that the excision boundary (the\ninner boundary of the innermost spherical shell) inside\neach black hole moves further into the strong-field region\nin the interior, towards the singularity. If this motion\ncontinues unchecked, gradients on the innermost spherical shell increase until the solution is no longer resolved.\nHowever, the inner boundary of the next-to-innermost\nspherical shell is also shrinking, and it eventually shrinks\n\n\fminimum characteristic speed\n\n9\n\nProper separation/M\n9.5 9 8.5\n8\n7.5\nA3\nA4 A5\nA0\nA6\n0 A1\nA2\nA\n\n7\n\nA8\n\n-0.2\n\n-0.4\n\n-0.6\n0\n\n25\n\nt/M\n\n50\n\nFIG. 6: The minimum of the outgoing (into the hole) characteristic speeds on the nine innermost spherical grid boundaries\n(labeled A0 . . . A8 ) around the larger black hole, for part of\nrun F.\n\nenough that the characteristic fields on this boundary\nall become outflowing (into the black hole); when this\nhappens, the innermost spherical shell no longer influences the exterior solution, so we simply drop that shell\nfrom the domain. This shell-dropping process occurs automatically as successive spherical shells shrink relative\nto the horizons, This process is illustrated in Figure 6,\nwhich shows the minimum of the (into the hole) characteristic speeds on spherical grid boundaries around one\nof the black holes. At any given time, the innermost of\nthese boundaries is an excision boundary. All characteristic speeds at all points on the excision boundary (and\nhence the minimum) must be positive for the excision algorithm to be well-posed. The innermost shell is dropped\nwhenever the characteristic speeds are positive on the\ninner boundary of the next shell. For example, surface\nA3 in Figure 6 is the excision boundary at t = 24M ,\nbut after the characteristic speeds on A4 become positive (around t = 26M ), the innermost shell is dropped\nand A4 becomes the excision boundary. Similarly, A5\nbecomes the excision boundary at t = 38, and so on. It\nis important that the characteristic speed on surface An\nin Figure 6 does not become negative before the speed\non surface An+1 becomes positive; otherwise this shelldropping procedure will fail. Shell dropping works well\nduring most of the evolution but it fails in the last stage\nbefore merger, which is discussed in Section III B 6.\nWhen describing mergers, it is useful to introduce a\nmeasure of distance between the black holes. One such\nmeasure of distance is indicated on the horizontal axis at\nthe top of Figure 6. This is the spatial (in each time slice)\nproper separation between the apparent horizon surfaces,\nobtained by integrating along the rest-frame x\u0303 axis (recall\n\nthat in the rest frame, the centers of the horizons always\nremain along this axis). This is not the true proper separation between the horizons because we do not minimize\nover all possible paths between all possible pairs of points\non the two surfaces; however, we use this only as an approximate measure of how far the black holes are from\nmerger. Note that the horizons touch each other when\n(or possibly before) this proper separation measure falls\nto zero.\nIt turns out that the improvements discussed in Section II are unnecessary during early inspiral for cases\nA\u2013D and are not yet used at this stage. For instance,\nthe domain decomposition uses overlapping cylinders and\nspherical shells, and not the cubed-sphere subdomains\ndescribed in Sec. II B. We find no problems while the\nholes are far enough apart that they remain roughly in\nequilibrium. However, the binary eventually becomes extremely dynamical, and the black holes become significantly distorted. Unless the algorithm is modified, the\nsimulation fails (typically because of large constraint violations) before the black holes merge.\nTypically, it is possible to extend the quasi-equilibrium\ninspiral stage until the proper separation decreases to\nabout 7M or 8M , but the next stages, Secs. III B 3\nand III B 2, can be done sooner if desired. (For example, cases E and F use a non-overlapping cubed-sphere\ngrid from t = 0.) For the simulations presented here, the\nlength of this quasi-equilibrium inspiral stage is variable.\nFor instance, for case A in Table I this stage lasts for 15\norbits, but for case F we transition to damped harmonic\ngauge and eliminate overlapping subdomains starting at\nt = 0 because the black holes are initially very close together.\n\n2.\n\nTransition to damped harmonic gauge\n\nWhen the inspirling black holes reach a proper separation of about 8M , we smoothly transition from quasiequilibrium gauge to damped harmonic gauge at t = tg\n(g stands for \"gauge\") by choosing\n4\n\n4\n\nHa (t) = H\u0303a (t)e\u2212(t\u2212tg ) /\u03c3g\n\u0012\u221a \u0013\ng\n+\u03bcL log\nta \u2212 \u03bcS N \u22121 gai N i , (20)\nN\nwhere H\u0303a (t) is the value of Ha (t) obtained from the\nquasiequilibrium gauge condition (19), and \u03c3g is a constant. The last line in Eq. (20) is the damped harmonic\ngauge condition, Eq. (8). The values of \u03bcL and \u03bcS are\nset according to Eq. (9), using\n(\n0,\nt < td\n,\n(21)\n\u03bc0 =\n2\n2\n1 \u2212 e\u2212(t\u2212td ) /\u03c3d , t > td\nwhere td and \u03c3d are constants. It is necessary to choose\n\u03c3g and \u03c3d sufficiently large or else the gauge becomes\n\n\f10\n\n3.\n\nEliminate overlapping subdomains\n\nAlthough the domain decomposition consisting of overlapping spherical shells, cylinders, and cylindrical shells\nis quite efficient for the early inspiral, it often suffers from\nnumerical instabilities, particularly as the black holes approach merger. Therefore, we regrid onto the cubedsphere subdomains described in Sec. II B. Use of these\nnon-overlapping subdomains eliminates these remaining\ninstabilities, and effectively increases our resolution. For\nmost of the runs described here, we happen to regrid at\nthe same time td that we begin the transition to damped\nharmonic gauge. However, for runs E and F, the entire\nsimulation uses the non-overlapping cube-sphere subdomains. As far as we know, there is no reason that regridding cannot occur at times other than td or tg .\n4.\n\nShape control\n\nThe next stage is to turn on shape control by introducing the map MS defined in Eqs. (14\u201318). The parameters\n\u03bblm\nA that appear in this map are determined (via a feedback control system) by Eqs. (A.3) and (A.6) for l > 0,\nand \u03bb00\nA is set to zero. This map deforms the grid so that\nthe boundaries of the spherical shells inside the horizons,\nincluding the excision boundaries, are mapped to closely\nmatch the horizons' shapes.\nWe do not turn on shape control until time tg + 2.5\u03c3g ,\nwhich is when the coefficient multiplying the gauge term\nH\u0303a (t) in Eq. (20) becomes smaller than double-precision\nroundoff. This ensures that Ha remains a smooth function of space in inertial coordinates. If shape control\nwere turned on too early, Ha would fail to be everywhere\nsmooth because the quasi-equilibrium-gauge quantity H\u0303\u0101\nis a smooth function of space in the grid-frame coordinates (and its numerical value is constant in time for\neach grid point), and the deformation is only C 0 across\nsubdomain boundaries.\n\nProper separation/M\n6\n5\n7\nminimum characteristic speed\n\nunnecessarily dynamical, possibly resulting in incoming\ncharacteristic fields on the excision boundary.\nFor all runs shown here, td corresponds approximately\nto a proper separation of 8M . We use the values \u03c3g =\n20M, \u03c3d = 50M for the equal mass binaries (cases A, C,\nand D), \u03c3g = 15M, \u03c3d = 100M for case B, and \u03c3g =\n25M, \u03c3d = 50M for case F. For these cases, tg = td . For\ncase E, the gauge is rolled off to harmonic early in the\ninspiral, so at t = td we need only to roll on the damped\nharmonic gauge, and we use \u03c3d = 40M . The constants\nin Eqs. (20) and (21) can be chosen quite flexibly: the\nonly constraint is that \u03c3g and \u03c3d must be large enough\nto avoid significant spurious gauge dynamics, but small\nenough so that the simulation is using damped harmonic\ngauge before the black holes approach each other too\nclosely. The \u03c3g and \u03c3d can always be made longer by\nchoosing earlier transition times tg and td .\n\n4\n\n0.1 A5\n0\n\nA6\n\n-0.1\n\nA7\n\n-0.2\n\nA8\n\n50\n\n75\n\nt/M\n\n100\n\nFIG. 7: The minimum of the outgoing (into the hole) characteristic speeds on the remaining four spherical-shell boundaries (labeled A5 . . . A8 ) around the larger black hole, for a\nportion of run F. The dashed curves correspond to runs without shape control, and the solid curves correspond to runs\nwith shape control turned on at t = 62M . The run without shape control terminates at proper separation 5.2M (time\nt = 106M ) because the excision algorithm fails on surface A7 .\n\nShape control is necessary for the shell-dropping procedure described in Section III B 1 to remain successful as\nthe holes approach each other. For a shell to be dropped,\nthe entire inner boundary of that shell must remain an\noutflow surface until the entire inner boundary of the\nnext shell becomes an outflow surface. If these boundaries do not have the same shape as the horizon, then\ntypically some portion of either boundary moves too close\nor too far from the horizon, and violates this condition.\nAn example is shown in Figure 7. Like Figure 6, Figure 7\nshows the minimum characteristic speeds on the boundaries of inner spherical shells for a portion of case F, but\nFigure 7 shows two separate evolutions: one with shape\ncontrol turned on at t = 62M (solid curves) and one\nwith no shape control (dashed curves). Without shape\ncontrol, the minimum characteristic speed on surface A7\nstops growing around t = 100M and becomes negative\nsoon thereafter. Because A7 is the excision surface at\nt \u223c 100M , the excision algorithm becomes ill-posed and\nthe simulation stops at t = 106M , well before merger\n(which occurs at t \u223c 128M ). In the simulation with active shape control, the same boundary A7 shows no such\nproblems-in fact it is dropped at t = 102M when all\nspeeds on the next shell, A8 become positive.\n\n\f11\n\nProper separation/M\n6\n5\n4 3 21\n\n-1\n\n10\n\n-2\n\n|| CGH ||\n\n10\n\n-3\n\n10\n\n-4\n\n10\n\n80\n\n100\nt/M\n\n120\n\nFIG. 8: Constraint norm ||CGH || as a function of time for a\nportion of case F. The dashed curve corresponds to a run with\nspherical shells around each hole, and the solid curve corresponds to an identical run with these inner spherical shells\nreplaced by cubed-sphere shells at t = 80M . The constraint\nnorm grows larger and begins to grow earlier when spherical\nshells are used.\n\n5.\n\nEliminate inner spherical shells\n\nSpherical-shell subdomains are extremely efficient\nwhen the solution is nearly spherically symmetric, because these subdomains use Ylm basis functions, which\nare well-suited for nearly spherical functions. However,\nonce the holes become sufficiently distorted, it is difficult\nto resolve the region near each horizon using spherical\nshells. At this point in the evolution, we replace the inner spherical shells with cubed-sphere shells. Figure 8\nshows the constraints as a function of time for two evolutions of case F: one with inner spherical shells (dashed\ncurves), and another in which the inner spherical shells\nwere replaced with cubed-sphere shells at t = 80M (solid\ncurves). The quantity plotted is ||CGH ||, the L2 norm\nover all the constraint fields of our first-order generalized\nharmonic system, normalized by the L2 norm over the\nspatial gradients of all dynamical fields (see Eq. (71) of\nRef.[45]). The L2 norms are taken over the portion of\nthe computational volume that lies outside the apparent\nhorizons. For the spherical-shell case in Figure 8, the constraints in the spherical shells grow large enough that the\nsimulation terminates at t = 129.5M , when the proper\nseparation has fallen to 0.5M . Note that these simulations typically proceed through merger even if we do\nnot replace spherical shells with cubed-sphere shells. So\nwhile this replacement step is not strictly necessary, eliminating spherical shells improves the accuracy of the simulation (as measured by the constraint quantity ||CGH ||)\nby almost an order of magnitude.\n\n6.\n\nSize control\n\nEventually, even using shape control, shell dropping\ntypically fails before the horizons merge: the outflow condition on the inner boundary of the inner shell fails before\nthe outflow condition on the inner boundary of the next\nshell becomes satisfied. This problem occurs because the\nmap ME shrinks the entire grid-including regions inside each hole-faster and faster as the holes approach\neach other. As soon as the velocity of excision boundary towards the center of the hole becomes large enough,\nthe boundary becomes timelike, and the excision algorithm fails. To remedy this, we turn off shell dropping\nand we turn on size control. Size control slows down\nthe infall of the excision surface (by pulling the excision\nsphere towards the horizon), thus keeping the characteristic speeds from changing sign. Size control is implemented by changing the map parameters \u03bb00\nA (t), which\npreviously were set to zero, to values given by Eqs. (A.3)\nand (A.10). This causes the size of each excision boundary to be driven towards some fraction \u03b7 of the size of\nthe appropriate horizon. For the equal-mass runs A, C,\nand D we use \u03b7 = 0.8 for both black holes. For the\nunequal-mass run B and the generic cases E and F we\nuse \u03b7 = 0.9 and \u03b7 = 0.7 for the smaller and larger black\nholes, respectively. These values do not require finetuning; for instance, case E still runs through merger and\nringdown if we change \u03b7 to 0.9 for both black holes. The\nmain criterion for choosing this parameter is that a grid\nsphere of radius b\u0304A (see Figure 4) should not be mapped\noutside the cube of side 2\u0101A . If this occurs, the map\nMS becomes singular and the run fails. Figure 9 shows\nthe minimum characteristic speed at particular domain\nboundaries for two evolutions of case F: one with size\ncontrol and one without. Without size control, the outflow condition on the excision boundary fails at proper\nseparation 1.67M and time t = 127.24M . With size control, the evolution proceeds to proper separation 0.015M ,\ntime t = 130.17, well past the formation of a common apparent horizon, which occurs at proper separation 1.4M\n(time t = 128.23M ).\n\n7.\n\nRingdown\n\nAt some time t = tm shortly after a common apparent horizon forms, we define a new grid, composed only\nof spherical shells. This grid has only a single excision\nboundary inside the common horizon. We also define a\nnew map Mringdown : x\u0304i \u2192 xi that can be written as a\ncomposition of simpler maps:\nMringdown := MTf \u25e6 MEf \u25e6 MR \u25e6 MS3 .\n\n(22)\n\nThis is similar to the ringdown maps described in\nRefs. [53, 56] (which had no translation) and Ref.[54]\n(which had no rotation). The new translation map MTf\nis tied to the center of the new common horizon, and\n\n\f12\n\nminimum characteristic speed\n\nProper separation/M\n3\n2\n1\n0.05\nB0\n0\n\n-0.05\nB1\n120\n\n125\nt/M\n\n130\n\nFIG. 9: The minimum of the outgoing (into the hole) characteristic speeds on the two innermost cubed-sphere boundaries\n(labeled B0 and B1 ) around the smaller black hole, for a portion of run F. The dashed curves correspond to runs without\nsize control, and the solid curves correspond to runs with size\ncontrol turned on at t = 120.2M . Without size control, the\ninnermost cubed-sphere is dropped at t = 124.5M and B1\nbecomes the excision boundary. However, the characteristic\nspeeds become negative on B1 at t = 127M and excision\nfails. With size control, the characteristic speeds on the excision boundary B0 remain positive until proper separation\n0.075M , well after merger.\n\nis not continuous with the old translation map MT except near the outer boundary where both translation\nmaps are the identity. The new expansion map MEf\nis chosen to be continuous with the old expansion map\nME at the outer boundary, but it is the identity near\nthe merged black hole. This new expansion map MEf\nsmoothly becomes constant in time shortly after merger.\nThe rotation map MR is continuous at merger, and after merger it smoothly becomes constant in time. The\nmap MS3 has the same form as Eqs. (14\u201317) except the\nfunction \u03c1\u0304A (\u03b8\u0304A , \u03c6\u0304A ) defined in Eq. (18) is replaced by\n\u03c1\u03043 = constant, where the constant value corresponds to\na subdomain boundary.\nAs described in Ref. [53], at t = tm the parameters\n\u03bblm\nA are chosen so that the common apparent horizon\nis stationary and spherical in the grid frame. Similarly,\nthe map MTf is chosen at t = tm so that the center\nof the horizon is located at the grid-frame origin and is\nstationary in the grid frame.\nOnce we have defined the maps at t = tm , we then interpolate all variables from the old grid to the new grid.\nNote that the grid frame changes discontinuously in time\nat t = tm . Because of this, we take care to properly\nuse both the new map Mringdown and the old map M in\ndoing this interpolation, so that the inertial frame and\n\nFIG. 10: Three snapshots of the apparant horizons of the\nnon-spinning equal-mass binary black hole merger (case A).\nSolid curves are the orbital plane cross section when a common horizon is first detected; dotted curves represent the time\nof transition between the binary merger and the single hole\nringdown evolutions; dashed curve shows the final equilibrium\nhorizon.\n\nquantities defined in that frame remain smooth. In particular, the gauge source function Ha is still determined\nby Eq. (20) during ringdown, and remains smooth at\nt = tm .\nFor t > tm , the parameters \u03bblm\nA (t) are determined by a\nfeedback control system that keeps the common apparent\nhorizon stationary in the grid frame. Likewise, the map\nMTf keeps the common apparent horizon centered at the\norigin in the grid frame.\n\nC.\n\nResults\n\nIn this section we present some results from the simulations listed in Table I. We first show snapshots of\nthe inertial-coordinate shapes of the apparent horizons\nduring merger and after ringdown. Figures 10, 11, 12,\nand 13 show cross-sections of the horizons in the orbital\nplane for cases A\u2013D; in these cases, the orbital plane is\nwell-defined and is constant in time. For all cases, we\nshow the apparent horizons of the individual black holes\nand the common apparent horizon at the time when the\ncommon horizon is first detected (solid curves), and at\nthe time tm when we transition to a new grid that has a\nsingle excision boundary (dotted curves). We also show\nthe apparent horizon of the final remnant black hole after\nit has reached equilibrium (dashed curves). Figures 14\nand 15 show cross-sections of the horizons for cases E and\nF, in which the orbital plane precesses. For these cases\nwe show cross-sections in the coordinate plane (defined\n\n\f13\n\nFIG. 11: Apparent horizon snapshots as in Figure 10, except\nfor a 2:1 mass ratio non-spinning binary black hole merger\n(case B).\n\nFIG. 13: Apparent horizon snapshots as in Figure 10, except\nfor an aligned-spin equal-mass binary black hole merger (case\nD).\n\nFIG. 12: Apparent horizon snapshots as in Figure 10, except\nfor an anti-aligned-spin equal-mass binary black hole merger\n(case C).\n\nFIG. 14: Three snapshots of the apparant horizons of a\ngeneric binary black-hole merger (case E). The plane of the\ncross-sections is a coordinate plane perpendicular to the instantenous orbital axis at the time the common horizon is first\ndetected. The additional degree of freedom is fixed by having\nthis plane go through the coordinate-center of the shape of\nthe common horizon at its first detection. Solid curves are\nthe cross section when a common horizon is first detected;\ndotted curves represent the time of transition between the binary merger and the single hole ringdown evolutions; dashed\ncurve shows the horizon at a time well after merger.\n\nusing the flat metric) that is perpendicular to the instantaneous orbital angular velocity at the time the common\nhorizon is first detected, and that passes through the coordinate center of the common horizon at this time. We\nshow cross-sections at three different times: the time of\nhorizon formation, the time tm , and a time 300M after\nmerger, all with respect to the same plane. The remnant black hole in cases E and F have nonzero linear\nmomentum both because of radiation reaction and because of some nonzero linear momentum present in the\ninitial data; this is why the centers of the horizons shown\nin Figures 14 and 15 change with time.\nFor case F, we also show the constraint norm as a func-\n\ntion of time in Figure 16. We plot the same quantity\n||CGH || as shown in Figure 8. This quantity is shown for\nfour numerical resolutions, and is convergent at all times\n(although the convergence rate is smaller near merger\nwhen the solution is most dynamical). The constraints\nare largest at t = tm , when we transition to a grid with\n\n\f14\nAcknowledgments\n\nWe thank Jan Hesthaven for helpful discussions. We\nare grateful to Luisa Buchman, Larry Kidder, and Harald Pfeiffer for the improved kinematical coordinate maps\nand associated control systems that handle inspirals of\nprecessing and unequal-mass binaries, and we thank Harald Pfeiffer for help preparing the initial data. We also\nthank Luisa Buchman, Tony Chu, Geoffrey Lovelace,\nand Harald Pfeiffer for producing some of the BBH inspiral simulations that we here extend through merger\nand ringdown. We acknowledge use of the Spectral Einstein Code (SpEC). This work was supported in part by\ngrants from the Sherman Fairchild Foundation, by NSF\ngrants PHY-0601459, PHY-0652995, and by NASA grant\nNNX09AF97G.\n\nAPPENDIX: CONTROLLING THE MAPS\nFIG. 15: Apparent horizon snapshots as in Figure 14, except\nfor the generic binary black-hole merger case F in Table I.\n\nThe purpose of the shape-control maps MSA , with\nis to distort the grid structures around the black\nholes so the excision boundaries of the computational domain are mapped to surfaces lying just inside and having\nthe same basic shapes as the apparent horizons. Choosing the right maps is equivalent to choosing the right\ntarget values for the parameters \u03bblm\nA (t) that define these\nmaps, cf. Eq. (16). This Appendix describes in some\ndetail how these parameters are chosen, and what target\nsurfaces are used to fix these maps in the merger simulations described in Sec. III.\nThe grid structures used in our merger simulations, cf.\nSec. II B, have excision boundaries that are grid-frame\nT\ncoordinate spheres. The target surfaces SA\nto which we\nwant to map these grid-frame spheres can be written in\nthe form\nA={1,2},\n\n10\n\n-1\n0.03\n0.02\n\n|| CGH ||\n\n10\n\n-2\n0.01\n\n10\n\n10\n\n-3\n\n0\n130\n\n130.2\n\n130.4\n\n130.6\n\n-4\n\n10\n\n-5\n\n-6\n\n10 0\n\nt/M\n100 200 300 400\n\nFIG. 16: Constraint norm ||CGH || as a function of time for\nthe generic (case F) binary black-hole merger and ringdown,\ncomputed with four different numerical resolutions. The small\ninset graph shows that numerical convergence is maintained\n(at a reduced rate) even during the most dynamical part of\nthe merger.\n\nr\u0303A =\n\nlX\nmax\n\nl\nX\n\n(A.1)\n\nl=0 m=\u2212l\n\nwhere the expansion coefficients \u039blm\nA (t) define the target\nsurface and (r\u0303A , \u03b8\u0303A , \u03c6\u0303A ) are rest-frame coordinates.\nLet r\u0304Atarget denote the radii of the grid-frame coordinate\nspheres that are to be mapped onto the target surfaces\nT\nSA\n. The rest-frame representations of these coordinate\nspheres, using Eqs. (14\u201316), are:\nr\u0303A = r\u0304Atarget \u2212\n\na single excision boundary. Just after t = tm the constraints decrease discontinuously by a small amount because part of the computational domain has been newly\nexcised. The approximate\nnumber of grid points for the\n\b\nfour \b\nresolutions is 793 , 873 , 953 , 1033 just before merger\nand 443 , 513 , 573 , 633 during ringdown.\n\n\u039blm\nA (t)Ylm (\u03b8\u0303A , \u03c6\u0303A ).\n\nlX\nmax\n\nl\nX\n\n\u03bblm\nA (t)Ylm (\u03b8\u0303A , \u03c6\u0303A ). (A.2)\n\nl=0 m=\u2212l\n\nNote that the functions fA that appear in Eq. (17) are set\nequal to unity here because we always choose the target\ngrid-spheres r\u0304Atarget to be smaller than the outer radii of\nthe largest spherical subdomain layers: b\u0304a \u2265 r\u0304Atarget . It\nfollows that the target spheres will be mapped to the\n\n\f15\nT\nshapes of SA\nwhen\n\uf8f1\nr\u0304Atarget\n\uf8f2\n00\n,\n\u2212\u039b\n(t)\n+\nA\n\u03bblm\nY00\nA (t) =\n\uf8f3\n\u2212\u039blm\nA (t),\n\nl = 0,\n\n(A.3)\n\nl > 0.\n\nThese conditions can not be imposed directly for a number of reasons, but they can be enforced approximately\nusing a feedback control system. The control system used\nin the merger calculations described in Sec. III is the\nsame one used to perform our earlier binary black-hole\nsimulations [47], so we will not describe it in detail here.\nTo complete the specification of the shape-control\nmaps we must choose the target grid-spheres r\u0304Atarget , and\nthe target surface parameters \u039blm\nA . From Eq. (A.3) it follows that the choice of r\u0304Atarget only effects the l = 0 size\ncontrol part of the distortion map. So until size control\nis activated late in our runs, there is no need to specify\nwhat r\u0304Atarget actually is. We think of it as being the radius of the suitably scaled apparent horizon, but this fact\ndoes not influence the shape control part of the map in\nany way. Once size control is activated late in the run,\nthen we require r\u0304Atarget to be the radius of the excision\nboundary:\nr\u0304Atarget = r\u0304Aex .\n\nr\u0303A =\n\nl\nX\n\nlm\nS\u0303A\n(t)Ylm (\u03b8\u0303, \u03c6\u0303).\n\n(A.5)\n\nl=0 m=\u2212l\n\nTo keep the shapes of the target surfaces similar to the\nshapes of the apparent horizons, the target surface palm\nrameters \u039blm\nA should be made proportional to SA . We\nfind it is appropriate to scale these coefficients by a factor, G(R\u0303A ), which depends on the average radius of the\n00\napparent horizon, R\u0303A = SA\nY00 :\nlm\n\u039blm\nA (t) = G(R\u0303A )SA (t).\n\n\u2206rA = \u03b7 R\u0303A \u2212 r\u0304Aex .\n\n(A.4)\n\nT\nNext consider the choice of target surfaces SA\n, starting with the l > 0 contributions that control the shape\nbut not the overall scaling of the map. The idea is to\nT\nchoose the target surfaces SA\nto be similar in shape to\nthe apparent horizons HA . The HA can be represented\nas smooth surfaces in the rest-frame coordinate system:\nlX\nmax\n\n1 for x \u226b 1. The p-dependence maintains these asymptotic forms, but allows the transition between them to\noccur more quickly than the p = 1 case.\nWe have found no need to introduce the l = 0 size\ncontrol parts these maps, until the final plunge phase\njust before the black holes merge. So during most of our\nmerger simulations we simply set \u03bb00\nA (t) = 0. This allows the apparent horizons to grow relative to the grid\ncoordinates as the map ME contracts the rest-frame relative to the inertial coordinates. This growth in the apparent horizons in the grid frame allows us to drop a\nnumber of spherical subdomain layers as the evolution\nprogresses, and this helps remove unwanted constraint\nviolations from the computational domain.\nAt some point however, we may not be able to drop\nadditional spherical subdomain layers: either because we\nrun out of layers, or because the inner boundary experiences incoming characteristic fields when the apparent horizon expands too quickly during the final plunge.\nWhen either of these conditions occurs we turn on the\nl = 0 part of the shape-control maps, to keep the radius of the excision boundary r\u0304Aex close to the size of the\napparent horizon. It will be useful to define\n\n(A.6)\n\nThe larger the apparent horizon radius in relation to the\ndesired excision radius, the smaller this scaling factor\nmust be to maintain an appropriate shape for the excision boundry. In practice, we find the scale factor\n\uf8ee\n!1/p \uf8f9\n\u0101A\nR\u0303\nA\n\uf8fb,\nG(R\u0303A ) =\ntanh p \uf8f0\n(A.7)\n\u0101A\nR\u0303A\n\nworks quite well for p = 2. This scaling factor is near\nunity when R\u0303A < \u0101A and decreases like 1/R\u0303A for larger\nvalues of R\u0303A . The tanh x function is introduced here because it is linear for small values of |x|, and approaches\n\n(A.8)\n\nWe choose \u03b7 so that when \u2206rA < 0 there is no need to\nimpose size control, and use \u03b7 in the range 0.7 \u2264 \u03b7 \u2264 0.9\nfor the merger simulations reported in Sec. III. When\n\u2206rA becomes positive we want to turn on size control,\nbut we want to do it in a fairly smooth and continuous\nway. This is done by defining the function:\n\nP (\u2206rA ) =\n\n\uf8f1\n\uf8f2\n\n\u0013 \u2206rA < 0\n\u0012 0,\n,\n40\u2206rA\n\uf8f3 tanh\n, \u2206rA \u2265 0\nR\u0303A\n\n(A.9)\n\nwhich vanishes for \u2206rA \u2264 0, and asymptotically approaches P (\u2206rA ) \u2192 1 for \u2206rA \u226b R\u0303A /40. We find that\nan appropriate value for the overall scale of the target\nT\nsurfaces SA\n, i.e. their l = 0 components, to be\n\u039b00\nA =\n\nr\u0304Aex + \u2206rA P (\u2206rA )\n.\nY00\n\n(A.10)\n\nOnce size control is activated, the target radius is given\nby Eq. (A.4): r\u0304Atarget = r\u0304Aex . This choice implies that\nthe average rest-frame radius of the excision boundary,\nR\u0303Aex = r\u0304Aex \u2212 \u03bb00\nA Y00 , approaches \u03b7 R\u0303A when \u2206rA &\nRA /40.\nTo summarize, the appropriate shape and size control of the inner grid structures in our binary blackhole merger simulations are deterined by the target\nT\nshape-control surfaces SA\n, whose definitions are given in\nEqs. (A.6) and (A.10). The shape-control map needed to\nT\ndistort the grid coordinates to the shape of SA\n, is given in\nEq. (A.3). This mapping is enforced with an appropriate\nfeedback control system.\n\n\f16\n\n[1] F. Pretorius, Phys. Rev. Lett. 95, 121101 (2005).\n[2] M. Campanelli, C. O. Lousto, P. Marronetti, and Y. Zlochower, Phys. Rev. Lett. 96, 111101 (2006).\n[3] J. G. Baker, J. Centrella, D.-I. Choi, M. Koppitz, and\nJ. van Meter, Phys. Rev. Lett. 96, 111102 (2006).\n[4] M. Campanelli, C. O. Lousto, and Y. Zlochower, Phys.\nRev. D 74, 041501(R) (2006), gr-qc/0604012.\n[5] M. Campanelli, C. O. Lousto, and Y. Zlochower, Phys.\nRev. D 74, 084023 (2006), astro-ph/0608275.\n[6] M. Campanelli, C. O. Lousto, Y. Zlochower, B. Krishnan,\nand D. Merritt, Phys. Rev. D 75, 064030 (2007), grqc/0612076.\n[7] F. Herrmann, I. Hinder, D. M. Shoemaker, P. Laguna,\nand R. A. Matzner, Phys. Rev. D 76, 084032 (2007),\narXiv:0706.2541v2.\n[8] P. Marronetti, W. Tichy, B. Br\u00fcgmann, J. Gonz\u00e1lez, and\nU. Sperhake, Phys. Rev. D 77, 064010 (2008).\n[9] E. Berti, V. Cardoso, J. A. Gonzalez, U. Sperhake, and\nB. Br\u00fcgmann, Class. Quantum Grav. 25, 114035 (2008),\narXiv:0711.1097v2.\n[10] M. Campanelli, Class. Quantum Grav. 22, S387 (2005).\n[11] F. Herrmann, I. Hinder, D. Shoemaker, and P. Laguna,\nClass. Quantum Grav. 24, S33 (2007).\n[12] J. G. Baker, J. Centrella, D.-I. Choi, M. Koppitz, J. R.\nvan Meter, and M. C. Miller, Astrophys. J. 653, L93\n(2006), astro-ph/0603204.\n[13] J. A. Gonzalez, U. Sperhake, B. Br\u00fcgmann, M. Hannam,\nand S. Husa, Phys. Rev. Lett. 98, 091101 (2007), grqc/0702052.\n[14] M. Campanelli, C. O. Lousto, Y. Zlochower, and D. Merritt, Phys. Rev. Lett. 98, 231102 (2007), gr-qc/0702133.\n[15] J. A. Gonzalez, M. D. Hannam, U. Sperhake,\nB. Br\u00fcgmann, and S. Husa, Phys. Rev. Lett. 98, 231101\n(2007), gr-qc/0702052.\n[16] B. Br\u00fcgmann, J. A. Gonz\u00e1lez, M. Hannam, S. Husa,\nand U. Sperhake, Phys. Rev. D 77, 124047 (2008),\narXiv:0707.0135.\n[17] F. Herrmann, I. Hinder, D. Shoemaker, P. Laguna,\nand R. A. Matzner, Astrophys. J. 661, 430 (2007), grqc/0701143.\n[18] D.-I. Choi, B. J. Kelly, W. D. Boggs, J. G. Baker, J. Centrella, and J. van Meter, Phys. Rev. D 76, 104026 (2007).\n[19] J. G. Baker, W. D. Boggs, J. Centrella, B. J. Kelly, S. T.\nMcWilliams, M. C. Miller, and J. R. van Meter, Astrophys. J. 668, 1140 (2007), astro-ph/0702390.\n[20] W. Tichy and P. Marronetti, Phys. Rev. D76, 061502\n(R) (2007).\n[21] J. D. Schnittman, A. Buonanno, J. R. van Meter, J. G.\nBaker, W. D. Boggs, J. Centrella, B. J. Kelly, and S. T.\nMcWilliams, Phys. Rev. D 77, 044031 (2008).\n[22] M. Campanelli, C. O. Lousto, Y. Zlochower, and D. Merritt, Astrophys. J. Lett. 659, L5 (2007).\n[23] M. Koppitz, D. Pollney, C. Reisswig, L. Rezzolla,\nJ. Thornburg, P. Diener, and E. Schnetter, Phys. Rev.\nLett. 99, 041102 (2007), gr-qc/0701163.\n[24] S. H. Miller and R. Matzner, Gen. Rel. Grav. 41, 525\n(2009), arXiv:0807.3028.\n[25] J. G. Baker, W. D. Boggs, J. Centrella, B. J. Kelly, S. T.\nMcWilliams, M. C. Miller, and J. R. van Meter, Astrophys. J. 682, L29 (2008), arXiv:0802.0416.\n[26] J. Healy, F. Herrmann, I. Hinder, D. M. Schoemaker,\n\nP. Laguna, and R. A. Matzner (2008), 0807.3292.\n[27] L. Boyle, M. Kesden, and S. Nissanke, Phys. Rev. Lett.\n100, 151101 (2008), arXiv:0709.0299 [gr-qc].\n[28] L. Boyle and M. Kesden, Phys. Rev. D 78, 024017 (2008),\narXiv:0712.2819 [astro-ph].\n[29] A. Buonanno, L. E. Kidder, and L. Lehner, Phys. Rev.\nD 77, 026004 (2008).\n[30] W. Tichy and P. Marronetti, Phys. Rev. D 78, 081501\n(2008), arXiv:0807.2985 [gr-qc].\n[31] M. Kesden, Phys. Rev. D 78, 084030 (2008).\n[32] L. Rezzolla, Class. Quant. Grav. 26, 094023 (2009),\narXiv:0812.2325 [gr-qc].\n[33] E. Barausse and L. Rezzolla (2009), arXiv:0904.2577 [grqc].\n[34] C. O. Lousto, M. Campanelli, and Y. Zlochower (2009),\narXiv:0904.3541 [gr-qc].\n[35] A. Buonanno, G. B. Cook, and F. Pretorius, Phys. Rev.\nD 75, 124018 (2007).\n[36] J. G. Baker, J. R. van Meter, S. T. McWilliams, J. Centrella, and B. J. Kelly, Phys. Rev. Lett. 99, 181101\n(2007).\n[37] Y. Pan, A. Buonanno, J. G. Baker, J. Centrella, B. J.\nKelly, S. T. McWilliams, F. Pretorius, and J. R. van\nMeter, Phys. Rev. D 77, 024014 (2008).\n[38] A. Buonanno, Y. Pan, J. G. Baker, J. Centrella, B. J.\nKelly, S. T. McWilliams, and J. R. van Meter, Phys.\nRev. D 76, 104049 (2007).\n[39] M. Hannam, S. Husa, J. A. Gonz\u00e1lez, U. Sperhake, and\nB. Br\u00fcgmann, Phys. Rev. D 77, 044020 (2008).\n[40] A. Gopakumar, M. Hannam, S. Husa, and B. Br\u00fcgmann,\nPhys. Rev. D 78, 064026 (2008).\n[41] M. Hannam, S. Husa, B. Br\u00fcgmann, and A. Gopakumar,\nPhys. Rev. D 78, 104007 (2008).\n[42] I. Hinder, F. Herrmann, P. Laguna, and D. Shoemaker\n(2008), http://www.arxiv.org/abs/0806.1037.\n[43] The\nCactus\nComputational\nToolkit,\nhttp://www.cactuscode.org.\n[44] M. Hannam, S. Husa, J. G. Baker, M. Boyle, B. Bruegmann, T. Chu, N. Dorband, F. Herrmann, I. Hinder,\nB. J. Kelly, et al., Phys. Rev. D 79, 084025 (2009),\narXiv:0901.2437.\n[45] L. Lindblom, M. A. Scheel, L. E. Kidder, R. Owen, and\nO. Rinne, Class. Quantum Grav. 23, S447 (2006).\n[46] O. Rinne, L. Lindblom, and M. A. Scheel, Class. Quantum Grav. 24, 4053 (2007).\n[47] M. A. Scheel, H. P. Pfeiffer, L. Lindblom, L. E. Kidder,\nO. Rinne, and S. A. Teukolsky, Phys. Rev. D 74, 104006\n(2006).\n[48] L. E. Kidder, L. Lindblom, M. A. Scheel, L. T. Buchman,\nand H. P. Pfeiffer, Phys. Rev. D 71, 064020 (2005).\n[49] M. Boyle, D. A. Brown, L. E. Kidder, A. H. Mrou\u00e9, H. P.\nPfeiffer, M. A. Scheel, G. B. Cook, and S. A. Teukolsky,\nPhys. Rev. D 76, 124038 (2007).\n[50] M. Boyle, A. Buonanno, L. E. Kidder, A. H. Mrou\u00e9,\nY. Pan, H. P. Pfeiffer, and M. A. Scheel, Phys. Rev. D\n78, 104020 (2008).\n[51] M. Boyle, D. A. Brown, and L. Pekowsky (2009),\narXiv:0901.1628.\n[52] A. Buonanno, Y. Pan, H. P. Pfeiffer, M. A. Scheel, L. T.\nBuchman, and L. E. Kidder, Phys. Rev. D 79, 124028\n(2009).\n\n\f17\n[53] M. A. Scheel, M. Boyle, T. Chu, L. E. Kidder, K. D.\nMatthews, and H. P. Pfeiffer, Phys. Rev. D 79, 024003\n(2009).\n[54] G. Lovelace, Y. Chen, M. Cohen, J. D. Kaplan, D. Keppel, K. D. Matthews, D. A. Nichols, M. A. Scheel,\nand U. Sperhake (2009), submitted to Phys. Rev. D,\narXiv:0907.0869.\n[55] M. Cohen, H. P. Pfeiffer, and M. A. Scheel, Class. Quantum Grav. 26, 035005 (2009), arXiv:0809.2628.\n[56] T. Chu, H. P. Pfeiffer, and M. A. Scheel (2009),\narXiv:0909.1313.\n[57] L. Lindblom and B. Szil\u00e1gyi, Phys. Rev. D (2009), submitted, arXiv:0904.4873.\n[58] M. W. Choptuik and F. Pretorius (2009),\narXiv:0908.1780.\n[59] M. Boyle, L. Lindblom, H. P. Pfeiffer, M. A. Scheel, and\nL. E. Kidder, Phys. Rev. D 75, 024006 (2007).\n[60] H. P. Pfeiffer, D. A. Brown, L. E. Kidder, L. Lindblom,\nG. Lovelace, and M. A. Scheel, Class. Quantum Grav.\n24, S59 (2007), gr-qc/0702106.\n[61] J. S. Hesthaven, SIAM J. Sci. Comput. 18, 658 (1997).\n[62] J. S. Hesthaven, SIAM J. Sci. Comput. 20, 62 (1999).\n[63] J. S. Hesthaven, Appl. Num. Math. 33, 23 (2000).\n[64] D. Gottlieb and J. S. Hesthaven, J. Comput. Appl. Math.\n128, 83 (2001), ISSN 0377-0427.\n\n[65] R. Sadourny, Monthly Weather Review 144, 136 (1972).\n[66] C. Ronchi, R. Iacono, and P. S. Paolucci, J. Computational Phys. 124, 93 (1996).\n[67] M. Rancic, R. J. Purser, and F. Mesinger, Q. J. R. Meteorol. Soc. 122, 959 (1996).\n[68] M. Taylor, J. Tribbia, and M. Iskandarani, J. Comp.\nPhys. 130, 92 (1997).\n[69] L. Lehner, O. Reula, and M. Tiglio, Class. Quant. Grav.\n22, 5283 (2005).\n[70] E. Pazos, M. Tiglio, M. D. Duez, L. E. Kidder, and S. A.\nTeukolsky (2009), arXiv:0904.0493.\n[71] G. B. Cook, Phys. Rev. D 65, 084003 (2002).\n[72] G. B. Cook and H. P. Pfeiffer, Phys. Rev. D 70, 104016\n(2004).\n[73] M. Caudill, G. B. Cook, J. D. Grigsby, and H. P. Pfeiffer,\nPhys. Rev. D 74, 064011 (2006).\n[74] E. Gourgoulhon, P. Grandcl\u00e9ment, and S. Bonazzola,\nPhys. Rev. D 65, 044020 (2002).\n[75] P. Grandcl\u00e9ment, E. Gourgoulhon, and S. Bonazzola,\nPhys. Rev. D 65, 044021 (2002).\n[76] J. W. York, Phys. Rev. Lett. 82, 1350 (1999).\n[77] H. P. Pfeiffer and J. W. York, Phys. Rev. D 67, 044022\n(2003).\n\n\f"}