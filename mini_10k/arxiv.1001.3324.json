{"id": "http://arxiv.org/abs/1001.3324v1", "guidislink": true, "updated": "2010-01-19T17:54:17Z", "updated_parsed": [2010, 1, 19, 17, 54, 17, 1, 19, 0], "published": "2010-01-19T17:54:17Z", "published_parsed": [2010, 1, 19, 17, 54, 17, 1, 19, 0], "title": "Kakutani-von Neumann maps on simplexes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1001.3281%2C1001.2010%2C1001.1674%2C1001.0758%2C1001.4270%2C1001.4741%2C1001.0238%2C1001.2059%2C1001.5064%2C1001.1119%2C1001.2101%2C1001.4253%2C1001.1322%2C1001.1256%2C1001.4371%2C1001.3018%2C1001.1784%2C1001.4136%2C1001.5004%2C1001.1495%2C1001.2961%2C1001.2277%2C1001.5150%2C1001.2272%2C1001.4431%2C1001.5443%2C1001.1578%2C1001.2503%2C1001.4693%2C1001.2323%2C1001.0038%2C1001.1029%2C1001.4806%2C1001.4275%2C1001.4357%2C1001.4240%2C1001.5033%2C1001.0527%2C1001.2789%2C1001.0387%2C1001.3324%2C1001.1291%2C1001.3761%2C1001.1812%2C1001.4175%2C1001.0806%2C1001.2746%2C1001.5106%2C1001.2508%2C1001.1627%2C1001.4076%2C1001.1890%2C1001.2927%2C1001.5382%2C1001.4646%2C1001.0763%2C1001.0507%2C1001.1556%2C1001.4760%2C1001.4764%2C1001.4835%2C1001.5455%2C1001.4982%2C1001.2807%2C1001.4840%2C1001.4264%2C1001.2345%2C1001.3849%2C1001.2294%2C1001.3647%2C1001.1926%2C1001.0098%2C1001.0828%2C1001.1486%2C1001.0224%2C1001.2724%2C1001.2463%2C1001.4730%2C1001.1614%2C1001.5028%2C1001.3573%2C1001.0999%2C1001.2125%2C1001.2617%2C1001.2530%2C1001.3316%2C1001.0465%2C1001.2167%2C1001.0776%2C1001.0384%2C1001.2086%2C1001.4943%2C1001.1651%2C1001.5392%2C1001.0308%2C1001.3381%2C1001.3128%2C1001.4819%2C1001.1086%2C1001.2563%2C1001.5112&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Kakutani-von Neumann maps on simplexes"}, "summary": "A Kakutani-von Neumann map is the push-forward of the group rotation (Z_2,+1)\nto a unit simplex via an appropriate topological quotient. The usual quotient\ntowards the unit interval is given by the base 2 expansion of real numbers,\nwhich in turn is induced by the doubling map. In this paper we replace the\ndoubling map with an n-dimensional generalization of the tent map; this allows\nus to define Kakutani-von Neumann transformations in simplexes of arbitrary\ndimensions. The resulting maps are piecewise-linear bijections (not just mod 0\nbijections), whose orbits are all uniformly distributed; in particular, they\nare uniquely ergodic w.r.t. the Lebesgue measure. The forward orbit of a\ncertain vertex provides an enumeration of all points in the simplex having\ndyadic coordinates, and this enumeration can be translated via the\nn-dimensional Minkowski function to an enumeration of all rational points. In\nthe course of establishing the above results, we introduce a family of\n{+1,-1}-valued functions, constituting an n-dimensional analogue of the\nclassical Walsh functions.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1001.3281%2C1001.2010%2C1001.1674%2C1001.0758%2C1001.4270%2C1001.4741%2C1001.0238%2C1001.2059%2C1001.5064%2C1001.1119%2C1001.2101%2C1001.4253%2C1001.1322%2C1001.1256%2C1001.4371%2C1001.3018%2C1001.1784%2C1001.4136%2C1001.5004%2C1001.1495%2C1001.2961%2C1001.2277%2C1001.5150%2C1001.2272%2C1001.4431%2C1001.5443%2C1001.1578%2C1001.2503%2C1001.4693%2C1001.2323%2C1001.0038%2C1001.1029%2C1001.4806%2C1001.4275%2C1001.4357%2C1001.4240%2C1001.5033%2C1001.0527%2C1001.2789%2C1001.0387%2C1001.3324%2C1001.1291%2C1001.3761%2C1001.1812%2C1001.4175%2C1001.0806%2C1001.2746%2C1001.5106%2C1001.2508%2C1001.1627%2C1001.4076%2C1001.1890%2C1001.2927%2C1001.5382%2C1001.4646%2C1001.0763%2C1001.0507%2C1001.1556%2C1001.4760%2C1001.4764%2C1001.4835%2C1001.5455%2C1001.4982%2C1001.2807%2C1001.4840%2C1001.4264%2C1001.2345%2C1001.3849%2C1001.2294%2C1001.3647%2C1001.1926%2C1001.0098%2C1001.0828%2C1001.1486%2C1001.0224%2C1001.2724%2C1001.2463%2C1001.4730%2C1001.1614%2C1001.5028%2C1001.3573%2C1001.0999%2C1001.2125%2C1001.2617%2C1001.2530%2C1001.3316%2C1001.0465%2C1001.2167%2C1001.0776%2C1001.0384%2C1001.2086%2C1001.4943%2C1001.1651%2C1001.5392%2C1001.0308%2C1001.3381%2C1001.3128%2C1001.4819%2C1001.1086%2C1001.2563%2C1001.5112&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Kakutani-von Neumann map is the push-forward of the group rotation (Z_2,+1)\nto a unit simplex via an appropriate topological quotient. The usual quotient\ntowards the unit interval is given by the base 2 expansion of real numbers,\nwhich in turn is induced by the doubling map. In this paper we replace the\ndoubling map with an n-dimensional generalization of the tent map; this allows\nus to define Kakutani-von Neumann transformations in simplexes of arbitrary\ndimensions. The resulting maps are piecewise-linear bijections (not just mod 0\nbijections), whose orbits are all uniformly distributed; in particular, they\nare uniquely ergodic w.r.t. the Lebesgue measure. The forward orbit of a\ncertain vertex provides an enumeration of all points in the simplex having\ndyadic coordinates, and this enumeration can be translated via the\nn-dimensional Minkowski function to an enumeration of all rational points. In\nthe course of establishing the above results, we introduce a family of\n{+1,-1}-valued functions, constituting an n-dimensional analogue of the\nclassical Walsh functions."}, "authors": ["Giovanni Panti"], "author_detail": {"name": "Giovanni Panti"}, "author": "Giovanni Panti", "arxiv_comment": "16 pages, 5 figures", "links": [{"href": "http://arxiv.org/abs/1001.3324v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1001.3324v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11K31; 37A45", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1001.3324v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1001.3324v1", "journal_reference": null, "doi": null, "fulltext": "KAKUTANI-VON NEUMANN MAPS ON SIMPLEXES\n\narXiv:1001.3324v1 [math.NT] 19 Jan 2010\n\nGIOVANNI PANTI\n\nAbstract. A Kakutani-von Neumann map is the push-forward of the group\nrotation (Z2 , +1) to a unit simplex \u0393 via an appropriate topological quotient.\nThe usual quotient towards the unit interval \u0393 = [0, 1] is given by the base 2 expansion of real numbers, which in turn is induced by the doubling map x 7\u2192 2x\n(mod 1). In this paper we replace the doubling map with an n-dimensional\ngeneralization of the tent map; this allows us to define Kakutani-von Neumann maps in simplexes of arbitrary dimensions. The resulting maps K are\npiecewise-linear bijections of \u0393 (not just mod 0 bijections), whose orbits are\nall uniformly distributed. In particular, the dynamical systems (\u0393, K) are\nuniquely ergodic, minimal, and have zero topological entropy. The forward orbit of a certain vertex gives a uniformly distributed enumeration of all points\nhaving dyadic coordinates, and this enumeration can be translated via the ndimensional Minkowski function to an enumeration of all rational points in \u0393.\nIn the course of establishing the above results, we introduce a family of \u00b11valued functions on \u0393, constituting an n-dimensional analogue of the classical\nWalsh functions.\n\n1. Introduction\nWe are going to construct certain Kakutani-von Neumann type transformations\n-namely, maps which are the push-forward of the adding machine- on unit simplexes. Let {0, 1}N be the Cantor space, i.e., the space of all countable 0\u20131 sequences\na = a0 a1 a2 . . . endowed with the product topology. It is a key topological fact that\nevery compact metric space -and in particular every n-dimensional simplex- is\na topological quotient (i.e., a continuous surjection) of {0, 1}N [6, Theorem 3.28].\nIn addition to the topological structure, the Cantor space carries the algebraic\nstructure of the group Z2 of 2-adic integers, the addition of two group elements\na = a0 a1 a2 . . . and b = b0 b1 b2 . . . being defined componentwise from left to right\nwith carry. The Haar measure on the compact topological group Z2 is the product\nmeasure determined by giving equal mass to the points in {0, 1}. The adding machine (Z2 , +1) is the topological dynamical system induced by addition by 1 = 10\u221e\nin Z2 . It is the prototypical example of a minimal uniquely ergodic dynamical system with zero topological entropy [2, IV.1], [7, \u00a715.4]. By a Kakutani-von Neumann\ntransformation on a unit simplex \u0393 we intend a Borel map from \u0393 to itself which is\nthe push-forward -in some reasonable sense- of the adding machine by a topological quotient.\n\nKey words and phrases. Kakutani-von Neumann maps, unique ergodicity, uniform distribution, Minkowski question mark function, Walsh functions.\n2000 Math. Subj. Class.: 11K31; 37A45.\n1\n\n\f2\n\nKAKUTANI-VON NEUMANN MAPS\n\nIn dimension 1, P\nthe simplest choice for such a quotient is provided by the binary\nexpansion \u03c6(a) =\nai 2\u2212(i+1) . This choice yields the classical Kakutani-von Neumann transformation (also called van der Corput map [3, \u00a75.2.3]) N : [0, 1] \u2192 [0, 1],\nwhose graph is shown in Figure 1.\n\nFigure 1: graph of N . The small dots clarify the definition of the function at break\npoints.\nThe quotient \u03c6 is induced by the doubling map Dx = 2x (mod 2) on [0, 1].\nIndeed, \u03c6(a) = p iff a is a symbolic orbit for p under D (i.e., for every t \u2265 0, at = 0\nimplies Dt p \u2264 1/2 and at = 1 implies 1/2 \u2264 Dt p). The point p is dyadic iff it\nbelongs to the ring Z[1/2] iff its binary expansion is not unique iff either p = 0,\nor p = 1, or Dt p = 1/2 for some t \u2265 0. For points which are not dyadic N is\nsafely defined by N p = \u03c6(\u03c6\u22121 (p) + 1). Things get problematic with dyadic points;\nnamely, the points whose twin expansions are 1t 10\u221e and 1t 01\u221e (i.e., the points\n1/2, 3/4, 7/8, . . .) force us to make choices, expressed by a dot in graphs such as\nthe one in Figure 1. Usually these choices pass unnoticed, since they involve sets\nof Lebesgue measure 0. If, however, we are interested in questions such as unique\nergodicity, then we cannot discard sets so easily, as they could support invariant\nmeasures.\nThe dot placing displayed in Figure 1 is the usual one; it corresponds to choosing\nthe finite expansion (i.e., the one ending with 0\u221e ) for each problematic dyadic point.\nWe thus obtain an injective minimal uniquely ergodic map which is not invertible\n(of course, it is invertible modulo nullsets). Note that it is not possible to arrange\nthings so as to obtain an invertible uniquely ergodic map. Indeed, a few moments\nof reflection on the graph of Figure 1 show that the only possibility of achieving\na true bijection is to \"switch dots\" at domain points of the form (2i \u2212 1)/2i , for i\nodd. In other words, one is forced to map 1/2 to 1 (rather than to 1/4), 7/8 to 1/4,\nand so on. The resulting bijection has finite orbits, such as 0 7\u2192 1/2 7\u2192 1 7\u2192 0, and\nhence is not minimal nor uniquely ergodic. Note also that restricting the domain to\nthe half-open interval [0, 1), or gluing 0 and 1 together, is of no help, since then 0\ndoes not have a counterimage.\nThe key idea of this paper is to substitute the doubling map D with an ndimensional version of the tent map T . In dimension 1, T is the usual tent map\nof ergodic theory [7, p. 78], defined by T \u03b1 = 2\u03b1 on [0, 1/2], and T \u03b1 = \u22122\u03b1 + 2\non [1/2, 1]. In dimension n \u2265 1, T is the transformation introduced in [10] as a\nlinearized version of the M\u00f6nkemeyer map. It is a continuous piecewise-linear map\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n3\n\non the n-dimensional simplex \u0393 = {(\u03b11 , . . . , \u03b1n ) \u2208 Rn : 0 \u2264 \u03b1n \u2264 \u03b1n\u22121 \u2264 * * * \u2264\n\u03b11 \u2264 1}, defined by\n(\n(\u03b11 + \u03b1n , \u03b11 \u2212 \u03b1n , . . . , \u03b1n\u22121 \u2212 \u03b1n ),\nif \u03b11 + \u03b1n \u2264 1;\nT (\u03b11 , \u03b12 , . . . , \u03b1n ) =\n(2 \u2212 \u03b11 \u2212 \u03b1n , \u03b11 \u2212 \u03b1n , . . . , \u03b1n\u22121 \u2212 \u03b1n ), if \u03b11 + \u03b1n \u2265 1.\nReplacing D with T allows us to construct Kakutani-von Neumann transformations\nK on unit simplexes of arbitrary dimension. The maps K are piecewise-linear bijections of \u0393, invertible (not just invertible modulo nullsets), minimal and uniquely\nergodic, the unique K-invariant Borel measure being the Lebesgue measure. Actually, we will prove a stronger result, namely that the K-orbit of every point in\n\u0393 is uniformly distributed. We will also prove that the set of points in \u0393 having\ndyadic coordinates coincides with the forward K-orbit of the vertex (0, 0, . . . , 0) of\n\u0393, thus obtaining a uniformly distributed enumeration of these points. By conjugating K by the Minkowski question mark function introduced in [10] this yields\nan enumeration of all rational points in \u0393. In the course of establishing the above\nresults, we will introduce a family of {+1, \u22121}-valued functions on \u0393, constituting\nan n-dimensional analogue of the classical Walsh functions.\nAcknowledgments. I would like to thank most sincerely Mirko Degli Esposti and\nStefano Isola for first suggesting me the possibility of applying the results in [10]\nto obtain multidimensional versions of the Kakutani-von Neumann transformation.\nI am also indebted to them for many discussions and several exchanges of emails\nthat greatly helped me in shaping the present work.\n2. Preliminaries\nWe refer to [2], [13], [7], for all unexplained notions in topological dynamics and\nergodic theory, and to [11] for the few needed facts on simplicial complexes. For\nthe reader's convenience we repeat here the main definitions in [10]. Fix an integer\nn \u2265 1, and consider the following (n + 1) \u00d7 (n + 1) matrices:\n\uf8eb\n\uf8f6\n0 1 1 *** 1 1\n\uf8ec0 1 1 * * * 1 0\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec0 1 1 * * * 0 0\uf8f7\n\uf8ec\n\uf8f7\nV = \uf8ec. . .\n.. .. \uf8f7 ,\n\uf8ec .. .. ..\n. .\uf8f7\n\uf8ec\n\uf8f7\n\uf8ed0 1 0 * * * 0 0\uf8f8\n1 1 1 *** 1 1\n\uf8eb\n\uf8f6\n\uf8eb\n\uf8f6\n1 0 0 *** 0 1\n0 0 0 *** 0 1\n\uf8ec1 0 0 * * * 0 1\uf8f7\n\uf8ec0 0 0 * * * 0 1\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec0 1 0 * * * 0 0\uf8f7\n\uf8ec0 1 0 * * * 0 0\uf8f7\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\nA0 = \uf8ec . . .\nA1 = \uf8ec . . .\n.. .. \uf8f7 ,\n.. .. \uf8f7 .\n.\n.\n.\n\uf8ec .. .. ..\n\uf8f7\n\uf8ec\n. .\uf8f7\n. .\uf8f7\n\uf8ec. . .\n\uf8f7\n\uf8ec\n\uf8ed0 0 0 * * * 0 0\uf8f8\n\uf8ed0 0 0 * * * 0 0\uf8f8\n0 0 0 *** 1 0\n0 0 0 *** 1 0\nMore precisely: all entries of V are 0, except those in position ij, with either\n(i = n + 1) or (j \u2265 2 and i + j \u2264 n + 2), that have value 1. All entries of A0 and\nA1 are 0, except (A0 )11 , (A1 )21 , and all elements in position 1(n + 1), 2(n + 1),\n(j + 1)j, for 2 \u2264 j \u2264 n, that have value 1.\n\n\f4\n\nKAKUTANI-VON NEUMANN MAPS\n\nFor a = 0, 1, let Ba be the matrix which is identical to Aa , except for the last\ncolumn, where the two entries 1 are replaced by 1/2. Let Ca = V Aa V \u22121 , and\nDa = V Ba V \u22121 . We write points (\u03b11 , . . . , \u03b1n ) \u2208 Rn as column vectors in projective\ncoordinates (\u03b11 * * * \u03b1n 1)tr , and we let \u0393 be the n-dimensional simplex in Rn whose\nith vertex vi is given by the (i + 1)th column of V , for 0 \u2264 i \u2264 n; in affine\ncoordinates, \u0393 = {(\u03b11 , . . . , \u03b1n ) \u2208 Rn : 0 \u2264 \u03b1n \u2264 \u03b1n\u22121 \u2264 * * * \u2264 \u03b11 \u2264 1}.\nThe matrix B1 is column-stochastic and primitive (i.e., some power is strictly\npositive). By the Perron-Frobenius theory its conjugate D1 has exactly one eigenvector (\u03b11 * * * \u03b1n 1)tr such that the point (\u03b11 , . . . , \u03b1n ), which we denote by v\u22121 , is\nin \u0393. The corresponding eigenvalue is 1, and hence \u03b11 , . . . , \u03b1n are rational numbers; for example, for n = 1, 2, 3 we have v\u22121 = 2/3, (4/5, 2/5), (6/7, 4/7, 2/7),\nrespectively. For a = 0, 1, let \u03c4a : \u0393 \u2192 \u0393 be the affine map determined by Da ,\nnamely \u03c4a (\u03b11 , . . . , \u03b1n ) = (\u03b21 , . . . , \u03b2n ) iff Da (\u03b11 * * * \u03b1n 1)tr = (\u03b21 * * * \u03b2n 1)tr . As\nproved in [10], \u03c40 and \u03c41 are the two inverse branches\nof the tent map T defined in\nP\no\nthe\nIntroduction.\nLet\n\u0393\nbe\nthe\nset\nof\nall\npoints\nx\nv\n\u2208\n\u0393 such that x0 , . . . , xn \u2265 0,\ni\ni\nP\nxi = 1, and x0 > 0; one easily computes that \u0393 \\ \u0393o = {(\u03b11 , . . . , \u03b1n ) \u2208 \u0393 : \u03b11 =\n1}.\nProposition 2.1. The sets {v\u22121 }, \u03c40 \u0393o , \u03c41 \u03c40 \u0393o , \u03c412 \u03c40 \u0393o , \u03c413 \u03c40 \u0393o , . . . constitute a\npartition of \u0393; the same holds for the sets {v0 }, \u03c41 \u0393o , \u03c40 \u03c41 \u0393o , \u03c402 \u03c41 \u0393o , \u03c403 \u03c41 \u0393o , . . ..\nProof. We claim that for every k \u2265 0 the sets \u03c40 \u0393o , \u03c41 \u03c40 \u0393o , . . . , \u03c41k \u03c40 \u0393o , \u03c41k+1 \u0393 constitute a partition of \u0393. This is true for k = 0 since, as proved in [10], \u0393 = \u03c40 \u0393 \u222a \u03c41 \u0393\nand \u03c40 \u0393 \\ \u03c41 \u0393 = \u03c40 \u0393o . Assume the statement true for k. Since \u03c41 : \u0393 \u2192 \u03c41 \u0393 is a\nbijection, \u03c41k+1 : \u0393 \u2192 \u03c41k+1 \u0393 is a bijection as well, and hence the partition \u03c40 \u0393o , \u03c41 \u0393\nof \u0393 induces a partition \u03c41k+1 \u03c40 \u0393o , \u03c41k+2 \u0393 of \u03c41k+1 \u0393; this T\nsettles our claim. The\nfirst statement now follows readily since, by construction, k\u22651 \u03c41k \u0393 = {v\u22121 }. The\nproof of our second\nis analogous, using \u03c41 \u0393o , \u03c40 \u0393 as base partition and\nT statement\nk\nobserving that k\u22651 \u03c40 \u0393 = {v0 }.\n\u0003\n\nWe can now define our Kakutani-von Neumann transformation K : \u0393 \u2192 \u0393.\nFirst, we set Kv\u22121 = v0 ; second, for every k \u2265 0 we have bijections\n\n\u03c41k \u03c40 \u0393o o\n\n\u03c41k \u03c40\n\n\u0393o\n\n\u03c40k \u03c41\n\n/ \u03c4 k \u03c41 \u0393o ,\n0\n\nand we define K = \u03c40k \u03c41 (\u03c41k \u03c40 )\u22121 on \u03c41k \u03c40 \u0393o .\nA couple of pictures may be helpful. In Figure 2 we draw the graph of K for\nn = 1 and \u0393 = [0, 1]. In Figure 3 we draw the partitions {\u03c40 \u0393o , \u03c41 \u03c40 \u0393o , \u03c412 \u03c40 \u0393o ,\n\u03c413 \u03c40 \u0393o , \u03c414 \u03c40 \u0393o , \u03c415 \u0393} and {\u03c41 \u0393o , \u03c40 \u03c41 \u0393o , \u03c402 \u03c41 \u0393o , \u03c403 \u03c41 \u0393o , \u03c404 \u03c41 \u0393o , \u03c405 \u0393}, for n = 2;\nhere \u0393 = {(\u03b1, \u03b2) : 0 \u2264 \u03b2 \u2264 \u03b1 \u2264 1}.\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n5\n\nFigure 2: graph of K in dimension 1.\n\nFigure 3: partitions of \u0393, in dimension 2.\nA good way of comparing the classical Kakutani-von Neumann map N : [0, 1] \u2192\n[0, 1] with the 1-dimensional version of our K is by noting that N is definable by\na cut-and-stack procedure [4]. At stage 1, the interval [0, 1] is cut into two equal\npieces, and the right-hand piece [1/2, 1] is stacked on top of the left-hand one [0, 1/2)\nin an orientation-preserving way. At stage k + 1, the 2k layers of stage k are all\ncut in two equal pieces, and the resulting right-hand pieces are stacked on top of\nthe left-hand ones, again in an orientation-preserving way. At stage k a map Nk is\ndefined as the map that moves every point of every layer (except the top one) to the\npoint immediately above in the next layer. A clear limiting process defines then N\nfrom the partial maps Nk , and shows that N is a bijection modulo \u03bb-nullsets (we\nalways use \u03bb to denote the Lebesgue measure, normalized so that \u03bb(\u0393) = 1). Now,\nif we are happy to neglect \u03bb-nullsets (namely, the endpoints of the cut intervals),\nthen the same cut-and-stack procedure defines our K, except that now at each\nstage the right-hand half-intervals must be put on top of the left-hand ones in an\norientation-reversing way. We leave to the reader the straightforward verification\nthat this construction is correct, i.e., defines a map \u03bb-everywhere identical to K.\nWe stress however that K is a true bijection on \u0393 in every dimension n \u2265 1, not\njust a mod 0 one.\n\n\f6\n\nKAKUTANI-VON NEUMANN MAPS\n\n3. Coding points\nFor t \u2265 1 and a0 , . . . , at\u22121 \u2208 {0, 1}, let \u0393a0 ...at\u22121 be the simplex \u03c4a0 \u03c4a1 * * * \u03c4at\u22121 \u0393.\nWe have the identity\n\u0393a0 ...at\u22121 = \u0393a0 \u2229 T \u22121 \u0393a1 \u2229 T \u22122 \u0393a2 \u2229 * * * \u2229 T \u2212(t\u22121) \u0393at\u22121 .\n\n(1)\n\nMoreover, for a fixed t the set of all faces of all n-dimensional simplexes \u0393a0 ...at\u22121\nforms a simplicial complex Bt whose support is \u0393. Each complex in the chain\nB0 , B1 , B2 , . . . refines the preceding ones; see [10, Proposition 2.2] for the above\nstatements.\nT\nBy [10, Lemma 2.3], for every point a = a0 a1 a2 . . . of Z2 the set {\u0393a0 ...at\u22121 :\nt \u2265 0} is a singleton {p}, and the map \u03c5 : Z2 \u2192 \u0393 defined by \u03c5(a) = p is a\ntopological quotient. The \u03c5-counterimage of \u0393a0 ...at\u22121 is the cylinder [a0 , . . . , at\u22121 ]\nwhose elements are all sequences b such that bi = ai for every 0 \u2264 i < t.\nDefinition 3.1. If \u03c5(a) = p, we say that a is a symbolic orbit of p under T .\nBy (1), this amounts to saying that T t p \u2208 \u0393at for every t \u2265 0. Since \u03930 \u2229 \u03931 6= \u2205,\nthe symbolic orbit is not unique. The simplex \u0393a0 ...at\u22121 is the set of points that\nhave a symbolic orbit beginning with a0 . . . at\u22121 . Let now c \u2208 {0, 1, \u2217}N ; we say\nthat c is the \u2217-orbit of p if ct equals 0, 1, or \u2217, whenever T t p belongs to \u03930 \\ \u03931 ,\n\u03931 \\ \u03930 , or \u03930 \u2229 \u03931 , respectively. Every point has a unique \u2217-orbit, and replacing\nthe symbols \u2217 in it by 0 or 1, arbitrarily, we obtain its various symbolic orbits. The\nfinal orbit of p is its unique symbolic orbit a such that T t p \u2208 \u03930 \u2229 \u03931 implies at = 1;\nit is obtained from the \u2217-orbit by replacing all symbols \u2217 by 1.\nTheorem 3.2. Every p \u2208 \u0393 has at most 2n(n+1)/2 symbolic orbits.\nProof. We will show that the \u2217-orbit of p contains at most 1 + 2 + 3 + * * * + n\nsymbols \u2217. Consider the following cones in Rn+1 :\nC = {(\u03b21 * * * \u03b2n+1 )tr : \u03b2i \u2265 0 for every i, and \u03b2i > 0 for at least one i};\nC0 = {(\u03b21 * * * \u03b2n+1 )tr \u2208 C : \u03b21 \u2265 \u03b22 };\nC1 = {(\u03b21 * * * \u03b2n+1 )tr \u2208 C : \u03b21 \u2264 \u03b22 }.\nLet M : C \u2192 C be defined by\n(\nM(\u03b21 * * * \u03b2n+1 )tr =\n\n(\u03b21 \u2212 \u03b22 \u03b23 \u03b24 * * * \u03b2n+1 \u03b22 )tr , if \u03b21 \u2265 \u03b22 ;\n(\u03b22 \u2212 \u03b21 \u03b23 \u03b24 * * * \u03b2n+1 \u03b21 )tr , if \u03b21 \u2264 \u03b22 .\n\nBy explicit computation one sees that M is induced by left multiplication by the\ninverses of the matrices A0 , A1 defined in Section 2. By [10, p. 250], M is the\nprojective version of a conjugate of the M\u00f6nkemeyer map. Let P = V \u22121 \u03a6\u22121 (p);\nhere \u03a6 is the Minkowski question mark function in [10, Theorem 2.1], and \u03a6\u22121 (p)\nis written as a column vector in projective coordinates. By [10, Lemma 2.5] we\nhave T t p \u2208 \u0393a iff Mt P \u2208 Ca , for a = 0, 1. Hence the set of T -symbolic orbits of p\ncoincides with the set of M-symbolic orbits (taken w.r.t. the partition C0 , C1 ) of\nP.\nt\n)tr , and refer to a time t at\nFor simplicity's sake, write Mt P = P t = (\u03b21t * * * \u03b2n+1\nt\nwhich P \u2208 C0 \u2229 C1 as a hitting time. The hitting time t is principal if \u03b21 = \u03b22 6= 0,\nand is secondary if \u03b21 = \u03b22 = 0. Let 0 \u2264 z(t) \u2264 n be the number of symbols 0\nt\nappearing in (\u03b21t * * * \u03b2n+1\n)tr . By the definition of M we always have z(t+1) = z(t),\nexcept when t is a primary hitting time, in which case z(t+1) = z(t)+1. Therefore,\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n7\n\nfollowing the M-orbit of P we will encounter at most n primary hitting times. Say\nr+1\nr+1 tr\nthat r \u2265 0 is one of these, and let P r+1 = (0 * * * 0 \u03b2m+1\n* * * \u03b2n+1\n) , with\nr+1\n\u03b2m+1 6= 0 and m \u2265 1. Then r + 1, r + 2, . . . , r + m \u2212 1 are all secondary hitting\nr+1\nr+1\ntimes (there are none such if m = 1), and P r+m = (0 \u03b2m+1\n* * * \u03b2n+1\n0 * * * 0)tr .\nr+1\nSince \u03b2m+1 6= 0, a moment of reflection shows that the first hitting time t > r + m\nmust be a primary one. Since m \u2264 z(r + 1) = z(r) + 1, we have m \u2212 1 \u2264 z(r);\nin other words, every primary hitting time r is followed by at most z(r) secondary\nhitting times. By the same argument, if the first hitting time r is secondary, then\nit is followed by at most z(r) \u2212 2 secondary hitting times. Since the number of\nsymbols 0 in the coordinates of points in C varies from 0 to n, it is clear that\nthe number of hitting times along the M-orbit of P is bounded by the triangular\nnumber 1 + 2 + 3 + * * * + n = n(n + 1)/2.\n\u0003\nRemark 3.3. The set of admissible \u2217-orbits depends on the dimension n. For\nexample, consider the sequence c = 0010\u2217\u221710\u221e . By Theorem 3.2, c is not realizable\nas a \u2217-orbit in dimension 1. Let n \u2265 2; the only point in \u0393 whose \u2217-orbit may\npossibly equal c is p = \u03c402 \u03c41 \u03c4o \u03c413 v0 (see Lemma 3.4 below). By actual computation,\none checks that in dimension 2 p equals (3/8, 3/8), whose \u2217-orbit is indeed c. On\nthe other hand, in dimension 3 p equals (3/4, 1/4, 1/4) and has \u2217-orbit \u2217\u22171\u2217\u2217\u221710\u221e ,\nwhile in dimension 4 p = (1/2, 1/2, 0, 0), whose \u2217-orbit is 00\u2217\u2217\u2217\u221710\u221e .\nBy saying that a is a final orbit we mean that a is the final orbit of some point,\nnecessarily the point \u03c5(a).\nLemma 3.4. The following statements hold.\n(i) If b is a symbolic orbit of p, then ab is a symbolic orbit of \u03c4a p, for a = 0, 1.\n(ii)\n\u03c40 \u0393o = \u0393 \\ \u03931 = \u03930 \\ \u03931 = {p \u2208 \u0393 : the final orbit of p begins with 0},\n\u03c41 \u0393 = \u03931 = {p \u2208 \u0393 : the final orbit of p begins with 1}.\n(iii) If p \u2208 \u0393o has final orbit b, then \u03c4a p has final orbit ab, for a = 0, 1.\n(iv) If p \u2208 \u0393 \\ \u0393o has final orbit b, then \u03c40 p = \u03c41 p \u2208 \u03930 \u2229 \u03931 and has final orbit\n1b.\n(v) If wb is a final orbit, with w a finite {0, 1}-word, then 1t b is a final orbit\nfor every t \u2265 0.\n(vi) 0\u221e and 1\u221e are the unique symbolic orbits of the points v0 and v\u22121 , respectively.\nProof. Since T \u03c4a = id\u0393 , (i) is clear. The second identity in (ii) is a special case\nof (1), and the first follows by taking complements and looking at the proof of\nProposition 2.1. (iii) follows from (ii), and (iv) from (i) and the observation that\n\u03c40 = \u03c41 on \u0393 \\ \u0393o . (v) If wb is the final orbit of p, then 1t b is the final orbit of\n\u03c41t T |w| p, by (iii) and (iv). We obtain (vi) by noting that v0 and v\u22121 are the only\nfixed points for \u03c40 and \u03c41 , respectively.\n\u0003\nIn the following main Theorem 3.5 we will give an alternate description of K.\nAs corollaries, we will obtain that the forward K-orbit of v0 contains precisely all\ndyadic points in \u0393 (a point is dyadic if all its coordinates are dyadic), each such point\nappearing exactly once. We will also obtain that the measure-preserving system\n(\u0393, \u03bb, K) is metrically isomorphic to the adding machine (Z2 , Haar measure, +1).\n\n\f8\n\nKAKUTANI-VON NEUMANN MAPS\n\nLet a \u2208 Z2 and, for each t \u2208 Z, let at = a + t. Consider the doubly infinite\nbilateral orbit A of a under +1, namely A = . . . , a\u22122 , a\u22121 , a0 = a, a1 , a2 , . . .. If a\nends with either 0\u221e or 1\u221e , then the elements of A are all sequences b such that b\nends with either 0\u221e or 1\u221e . Otherwise, the elements of A are all sequences b that\nhave the same tail of a (i.e., such that there exists t \u2265 0, depending on b, with\nar = br for every r \u2265 t). Let p \u2208 \u0393 be such that A contains at least one symbolic\norbit of p. From Theorem 3.2 and the above characterization of the elements of\nA, this implies that A contains all symbolic orbits of p. For every such p, remove\nfrom A all these symbolic orbits except the last one (this last one is precisely the\nfinal orbit of p, whence the name). Write A0 = . . . , ar\u22122 , ar\u22121 , ar0 , ar1 , ar2 , . . . for\nthe resulting pruned sequence. By Theorem 3.2, A0 is surely infinite to the right,\nand the following Theorem 3.5 implies, since K is a bijection, that it is infinite to\nthe left as well.\nTheorem 3.5. Let ark \u2208 A0 be the final orbit of p. Then the final orbit of Kp is\nark+1 .\nProof. Without loss of generality a0 is a final orbit and rk = r0 = 0. If a0 = 1\u221e ,\nthen a0 is the final orbit of v\u22121 and a1 = 0\u221e is the final orbit of v0 = Kv\u22121 . By the\ndefinition of A0 we have ar1 = a1 and we are through. Otherwise, write uniquely\na0 = 1t 0b for a certain t \u2265 0, and let q = T t+1 p; then q has final orbit b. We\nclaim that q \u2208 \u0393o . Indeed, the point T t p has final orbit 0b, and hence is in \u03c40 \u0393o by\nLemma 3.4(ii). Since T \u03c40 is the identity map, we have q = T T t p \u2208 T \u03c40 \u0393o = \u0393o . By\n(iii) and (iv) of the same Lemma, the point \u03c41t \u03c40 q has final orbit a0 , and hence is p.\nBy the definition of K, we have Kp = \u03c40t \u03c41 q, and by (i) one of the symbolic orbits of\nKp (not necessarily the final one) is 0t 1b = a1 . We will show that \u03c5(a1 ) = \u03c5(ar1 ),\nthus concluding the proof.\nDefine numbers t1 , t2 , . . . in the following inductive way:\nt1\n\u2022 t1 is the maximum number \u2265 0 and \u2264 t such that\nPi 0 1b is a final orbit.\n\u2022 Assume ti has been defined. If si = (t + 1) \u2212 j=1 (tj + 1) = 0, then the\nprocedure stops at ti . Otherwise ti+1 is the maximum number \u2265 0 and\n\u2264 t \u2212 si such that 0ti+1 10ti 1 * * * 0t2 10t1 1b is a final orbit.\n\nAfter finitely many steps the procedure stops, say at td . For 1 \u2264 i \u2264 d,\nlet now ui be the integer whose binary expansion (written from left to right)\nis 0si 0ti 10ti\u22121 1 * * * 0t1 1; this expansion contains exactly t + 1 digits. Let li =\nui \u2212 (2t \u2212 1); observe that 2t \u2212 1 has binary expansion 1t 0. We then have\n1 = l1 < l2 < * * * < ld . By construction, ali = 0si 0ti 10ti\u22121 1 * * * 0t1 1b, which is\na final orbit iff i = d (note that sd = 0). Now, let 1 \u2264 i \u2264 d be maximum such that\n\u03c5(al1 ) = \u03c5(al2 ) = * * * = \u03c5(ali ) and for every l1 \u2264 l < li the orbit al is not final. We\nshall show that i = d, so that ld = r1 (since ald is a final orbit) and \u03c5(a1 ) = \u03c5(ar1 ),\nthus concluding the proof.\nAssume by contradiction i < d. Then 0si 0ti 10ti\u22121 1 * * * 0t1 1b is not final. By the\ndefinition of ti , the orbit 0ti 10ti\u22121 1 * * * 0t1 1b is final, while 00ti 10ti\u22121 1 * * * 0t1 1b is\nnot. Therefore, by Lemma 3.4(iii), the point z = \u03c5(0ti 10ti\u22121 1 * * * 0t1 1b) does not\nbelong to \u0393o . Applying (iv), we obtain \u03c5(ali ) = \u03c40si z = \u03c40si \u22121 \u03c41 z = \u03c5(ali+1 ). Moreover, for every li \u2264 l < li+1 the orbit al is not final, since it has 00ti 10ti\u22121 1 * * * 0t1 1b\nas a tail. This contradicts the maximality of i and concludes the proof.\n\u0003\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n9\n\nCorollary 3.6. Two points belong to the same K-orbit iff either their final orbits\nhave the same tail, or one of them has tail 0\u221e and the other 1\u221e (one can use\nequivalently any symbolic orbit, or the \u2217-orbit).\nProof. Immediate from Theorem 3.5.\n\n\u0003\n\nCorollary 3.7. The forward K-orbit of v0 constitutes an enumeration without\nrepetitions of all dyadic points in \u0393.\nProof. By [10, Theorem 3.5(ii)] the dyadic points in \u0393 are exactly the points whose\nsymbolic orbits have tail 0\u221e . Since v0 has symbolic orbit 0\u221e , if we set a0 = 0\u221e\nand construct A0 as above, then the points in A0 to the right of a0 are exactly the\nfinal orbits of the dyadic points.\n\u0003\nSince the proof of Corollary 3.7 makes crucial use of [10, Theorem 3.5], we take\nthis opportunity to correct the annoying -albeit apparent- typo in the statement (iii) of the above reference, where \"iff\" must be read \"if\".\nCorollary 3.8. The map K preserves the Lebesgue measure \u03bb. The measurepreserving system (\u0393, \u03bb, K) is metrically isomorphic to the adding machine\n(Z2 , \u03bc, +1), where \u03bc is the Haar measure on Z2 .\nProof. The matrix Ek = D0k D1 D0\u22121 D1\u2212k induces K on \u03c41k \u03c40 \u0393o . We have |det(D0 )| =\n|det(D1 )| = 1/2, and hence |det(Ek )| = 1. The row vector (1 * * * 1 1) is a left eigenvector for the column-stochastic matrices B0 and B1 , and therefore (1 * * * 1 1)V \u22121 =\n(0 * * * 0 1) is a left eigenvector for D0 and D1 , with corresponding eigenvalue 1. This\nimplies that the last row of Ek is (0 * * * 0 1), and hence the Jacobian matrix of K\non \u03c41k \u03c40 \u0393o is the n \u00d7 n minor given by the first n rows and columns of Ek . Such a\nmatrix has determinant of absolute value 1, and hence K preserves the Lebesgue\nmeasure.\nFor every t > 0 and every (a0 , . . . , at\u22121 ) \u2208 {0, 1}t the Lebesgue measure 2\u2212t of\n\u0393a0 ...at\u22121 coincides with the Haar measure of its \u03c5-counterimage [a0 , . . . , at\u22121 ]. Since\nthe sets \u0393a0 ...at\u22121 generate the Borel \u03c3-algebra of \u0393, the push-forward of \u03bc via \u03c5 is\n\u03bb. Let Y = {p \u2208 \u0393 : the symbolic orbit\nS of p is not unique}. Then Y is aS\u03bb-nullset,\nsince it is contained in the \u03bb-nullset t\u22650 T \u2212t [\u03930 \u2229\u03931 ]. Therefore X = \u0393\\ t\u2208Z K t Y\nhas full Lebesgue measure, and \u03c5 \u22121 X has full Haar measure. By construction, \u03c5 is\na bijection between \u03c5 \u22121 X and X. If a \u2208 \u03c5 \u22121 X and p = \u03c5(a), then all the elements\nin the K-orbit of p have a unique symbolic orbit. Hence the sequence A constructed\n\u0003\nfrom a coincides with A0 , and by Theorem 3.5 \u03c5(a + 1) = K\u03c5(a).\n4. T -Walsh functions on simplexes\nIn this section we will prove that every K-orbit is \u03bb-uniformly distributed. Remember [9, Definition III.1.1] that a countable sequence {pi }i\u2208N in a compact metric\nspace X endowed with a Borel probability measure \u03bd is \u03bd-uniformly distributed if\nfor every continuous function f : X \u2192 R we have\nZ\nk\u22121\n1X\nf (pi ) =\nf d\u03bd.\n(2)\nlim\nk\u2192\u221e k\nX\ni=0\nLet \u03b9 : \u0393 \u2192 {0, 1}N be the function that associates to a point its final orbit. It\nis a right inverse to \u03c5, so it is injective. For t \u2265 1 and a0 , . . . , at\u22121 \u2208 {0, 1}, let\n\u0393fa0 ...at\u22121 = \u03b9\u22121 [a0 , . . . , at\u22121 ] = {p \u2208 \u0393 : the final orbit of p begins with a0 . . . at\u22121 }.\n\n\f10\n\nKAKUTANI-VON NEUMANN MAPS\n\nFor a fixed t, the collection of all sets \u0393fa0 ...at\u22121 is a true partition of \u0393, not just a\nmod 0 one.\nLemma 4.1. The set \u0393fa0 ...at\u22121 is obtained from the simplex \u0393a0 ...at\u22121 by removing\nsome of its proper faces. In particular, \u0393fa0 ...at\u22121 and \u0393a0 ...at\u22121 have the same\nLebesgue measure 2\u2212t . The embedding \u03b9 is Borel, not continuous, and has dense\nrange.\nProof. Let w = a0 . . . at\u22121 be a finite word, let 0 \u2264 i < t, and let w(i, 1) be the\nword obtained from w by setting ai = 1. We immediately have from the definitions\n[\n\u0001\n\u0393fw = \u0393w \\\n{\u0393w(i,1) : ai = 0} .\nSince Bt is a simplicial complex, if ai = 0 then \u0393w \u2229 \u0393w(i,1) is a proper face (possibly empty) of \u0393w , and our first two statements follow. As the clopen cylinders\n[a0 , . . . , at\u22121 ] generate the topology of the Cantor space, \u03b9 is Borel; it is not continuous since \u03b9\u22121 [0] = \u0393f0 = \u03930 \\ \u03931 is not closed. Finally, \u03b9 has dense range because\n\u0003\nno \u0393fa0 ...at\u22121 is empty.\nWe now change the group structure on the Cantor space, by endowing it with\nthe structure of the direct product Z2N of countably many copies of the two-element\ngroup Z2 (no blackboard type here). Addition of two elements a and b is done\ncomponentwise without carry, the topology and the Haar measure being the same\nas those of Z2 .\nJust as a Kakutani-von Neumann map is the push-forward of the adding machine (Z2 , +1) by a topological quotient, a Walsh function is the push-forward of\na character \u03c7 of Z2N by the same topological quotient; in our case, it is simply the\ncomposition \u03c7\u03b9. By the Pontrjagin duality, the character group of Z2N is the direct\nLN\nsum\nZ2 with the discrete topology; since Z2N has exponent 2, each character\nhas range in {+1, \u22121}. By associating the element (d0 , d1 , . . . , dt\u22121 , 0, 0, . . .) (with\nPt\u22121\nLN\ndt\u22121 = 1) to m = i=0 di 2i , we identify\nZ2 with N; under this identification\nthe sum of m and l is the natural number m \u2295 l whose ith binary digit is the mod 2\nsum of the ith binary digits of m and l. In short, we obtain the following definition.\nPt\u22121\nDefinition 4.2. Given m \u2208 N whose binary expansion is m = i=0 di 2i (with\ndt\u22121 = 1) and p \u2208 \u0393fa0 ...at\u22121 , write hm, pi for d0 a0 + d1 a1 + * * * + dt\u22121 at\u22121 (mod 2).\nThe mth T -Walsh function um = \u03c7m \u03b9 : \u0393 \u2192 {+1, \u22121} is defined by um (p) =\n(\u22121)hm,pi ; we have u0 = 1l\u0393 . For m \u2265 1 the level of um is t \u2265 1, and the set Ut of\nT -Walsh functions of level t has cardinality 2t\u22121 .\nThe name T -Walsh refers to the r\u00f4le of the map T -thatSstays on the stage\nthrough the \u03b9 embedding- in generating the group U = {u0 } \u222a t\u22651 Ut ; see Proposition 4.3(i). Write r = u1 for the first T -Walsh function; then r(p) equals +1 or \u22121\naccording whether p belongs to \u0393f0 or not. The functions r, rT, rT 2 , . . . correspond\nto the classical Rademacher functions; see Remark 4.4.\nPt\u22121\nProposition 4.3. Let m = i=0 di 2i be as above; then the following statements\nhold.\n(i)\nt\u22121\nY\num =\n(rT i )di ;\ni=0\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n11\n\nthis expression is unique and includes the case m = 0, since an empty\nproduct equals 1 by definition.\n(ii) um *ul = um\u2295l , and hence the group algebra R[U ] coincides with the R-span\nof U .\n(iii) The family U forms an orthonormal set in L2 (\u0393, R).\n(iv) The closure of R[U ] in L\u221e (\u0393, R) contains all continuous real-valued functions on \u0393.\nLN\nProof. (i) Under the identification of the character group of Z2N with\nZ2 , the\nfunction r = \u03c71 \u03b9 corresponds to (1, 0, 0, . . .). Applying T amounts to shifting the\nfinal orbit of a point by one, and therefore rT i corresponds to (0, . . . , 0, 1, 0, . . .),\nwith 1 in the ith position. Our identity reduces then to the unique expansion of m\nin base 2.\n(ii) is immediate from the definitions.\n(iii) Let [a0 , . . . , at\u22121 ] be a cylinder in Z2N . By Lemma 4.1 the Lebesgue measure\nof its \u03b9-counterimage equals its Haar measure \u03bc([a0 , . . . , at\u22121 ]). Since the cylinders\ngenerate\ntheR Borel \u03c3-algebra of Z2N , the push-forward of \u03bb by \u03b9 is \u03bc. In particular,\nR\nu d\u03bb = Z N \u03c7m d\u03bc, and (iii) amounts to the well known orthonormality of the\n\u0393 m\n2\nelements of the character group.\n(iv) Let f \u2208 C(\u0393, R) and \u03b5 > 0. Then f \u03c5 \u2208 C(Z2N , R) and, sincePthe R-span of\ns\nthe characters is dense in the uniform topology, there\nPsexists \u03c6 = i=0 \u03b1i \u03c7i such\nthat k\u03c6 \u2212 f \u03c5k\u221e < \u03b5. But then |\u03c6\u03b9(p) \u2212 f \u03c5\u03b9(p)| = |( i=0 \u03b1i ui )(p) \u2212 f (p)| < \u03b5 for\nevery p \u2208 \u0393.\n\u0003\n\nRemark 4.4. Let w0 , w1 , w2 , . . . denote the classical Walsh functions on [0, 1].\nThey are definable in a manner analogous to the one in Proposition 4.3(i), namely\nQt\u22121\nby wm = i=0 (rDi )di , with the doubling map D in place of the tent map T ;\nthe functions rDi are then the classical Rademacher functions [9, p. 116]. Let\nWt = {wm : 2t\u22121 \u2264 m < 2t } be the set of Walsh function of level t \u2265 1. Then\nWt = Ut for every t (we neglect the behavior at points of discontinuity). Indeed,\nthe above identity is true for t = 1 (since w1 = r = u1 ) and for t = 2 (since\nw2 = rD = rT * r = u3 and w3 = rD * r = rT = u2 ). Now observe that:\n(i) T D = T 2 ;\n(ii)\n\nUt+1 =\n\n[\n\n{uT, uT * r}.\n\nu\u2208Ut\n\nApplying the identity (ii) twice yields\n\nUt+1 =\n\n[\nv\u2208Ut\u22121\n\n{vT 2 , vT 2 * rT, vT 2 * r, vT 2 * rT * r},\n\n\f12\n\nKAKUTANI-VON NEUMANN MAPS\n\nand similar identities hold for Wt+1 , with D replacing T . We thus obtain by\ninduction\n[\n{wD, wD * r}\nWt+1 =\nw\u2208Wt\n\n=\n\n[\n\n{uD, uD * r}\n\nu\u2208Ut\n\n=\n\n[\n\n{vT D, vT D * rD, vT D * r, vT D * rD * r}\n\nv\u2208Ut\u22121\n\n=\n\n[\n\n{vT 2 , vT 2 * rT * r, vT 2 * r, vT 2 * rT }\n\nv\u2208Ut\u22121\n\n= Ut+1 .\nRemark 4.5. For n \u2265 3 our T -Walsh functions are rather different from the usual\nmultidimensional Walsh functions [5]. Indeed, the latter assume constant value \u00b11\non the cubes of a partition on [0, 1]n defined by equations of the form xi = c, with\nc a dyadic rational. On the other hand, the T -Walsh function um of level t assumes\nconstant value on the interior of the simplexes of the partition Bt . The equations\ndefining the simplexes of Bt have rational coefficients, but definitely not dyadic\nones. Actually, pictures drawn for the 2-dimensional case -such as Figure 3, or\nthe second picture on [10, p. 252], displaying B4 - are rather misleading, since they\nlead to think that the simplexes constitutingP\nBt are always congruent to each other,\nn\nand are definable by equations of the form i=1 bi xi = c, with bi \u2208 {0, 1, \u22121} and\nc \u2208 Z[1/2]. These facts are true for n = 1, 2, but false for n \u2265 3; for example, one\nof the planes bounding \u03c4111 \u0393 in dimension 3 has equation 20x1 \u2212 12x2 + 16x3 = 15.\nSee also the remark after [10, Corollary 2.4].\nThe main result in this section is the following.\nTheorem 4.6. For every p \u2208 \u0393, the sequence p, Kp, K 2 p, . . . is \u03bb-uniformly distributed.\nIt is well known that the \u03bd-uniform distribution of all orbits implies that a\ndynamical system admits only \u03bd as an invariant measure, i.e., is uniquely ergodic.\nNote that this fact is usually stated for homeomorphisms (in which case the two\nconditions are equivalent), but the proof of the implication concerning us holds for\nall Borel maps; see, e.g., [2, Theorem I.8.2].\nBy [9, Theorem III.1.1] and Proposition 4.3(iv), the class of T -Walsh functions\nis convergence-determining, so the validity of (2) -with \u03bd = \u03bb- for all T -Walsh\nfunctions implies its validity for all continuous functions. Taking Proposition 4.3(iii)\ninto account, and noting that (2) surely holds for u0 = 1l\u0393 , we must prove that for\nevery m > 0 and every p \u2208 \u0393 we have\nk\u22121\n1X\num (K i p) = 0.\nk\u2192\u221e k\ni=0\n\nlim\n\n(3)\n\nFix therefore um of level t \u2265 1; then um is constant on each \u0393fa0 ...at\u22121 . By\nLemma 4.1, um is constant on the topological interior of each of the n-dimensional\nsimplexes in Bt . Let X be the union of these topological interiors, and Y = \u0393 \\ X\nbe the union of all the (n \u2212 1)-dimensional simplexes in Bt .\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n13\n\nChoose now p, and let a0 be its final orbit. Construct the sequences A =\na , a1 , a2 , . . . and A0 as in Section 3, now taking them infinite to the right only.\nPartition A in blocks B0 , B1 , B2 , . . . of consecutive elements: the block B0 contains\na0 and all subsequent elements until and including the first one aj0 beginning with\n1t . The block B1 now contains aj0 +1 (that begins with 0t ) and all subsequent elements till the first one aj1 beginning with 1t ; the blocks B2 , B3 , . . . are constructed\nanalogously. Let us call the last element of the block B the pivot of B; it is the\nonly element of B beginning with 1t .\n0\n\nLemma 4.7. Let B be a block in A with pivot b = 1t c; then the following statements hold.\n(i) If a \u2208 B is a final orbit, then b is a final orbit.\n(ii) Assume that b is a final orbit, while a \u2208 B is not. Then {\u03c5(d) : d \u2208 B} \u2282\nY.\nProof. Note first that the elements of B are exactly the symbolic orbits of the\nform wc, for w a word of length t. Hence, if wc is a final orbit, then 1t c is a\nfinal orbit by Lemma 3.4(v); this proves (i). About (ii): let a = wc be not final,\nd = d0 . . . dt\u22121 c \u2208 B, q = \u03c5(a), z = \u03c5(d). Since the final orbit of q is not a, while\nthe final orbit of T t q is c (because c is a final orbit, again by Lemma 3.4(v) applied\nto b), we must have T i q \u2208 \u03930 \u2229 \u03931 for some 0 \u2264 i < t. Therefore T t q = T t z\nlies in a proper face of \u0393. By Lemma 3.4(i) and the proof of [10, Proposition 2.2],\nz = \u03c4d0 * * * \u03c4dt\u22121 T t z \u2208 Y .\n\u0003\nRename the elements of A0 by writing\nA0 = b0 , . . . , bs0 , bs0 +1 , . . . , bs1 , bs1 +1 , . . . , bs2 , . . .\nwhere bsi is the ith surviving pivot; since a0 is a final orbit, we have b0 = a0\nand bs0 is the pivot of B0 , by Lemma 4.7(i). The reduced blocks Bi0 are defined\n0\n= {bsi +1 , . . . , bsi+1 }. The elements of Bi0 are\nby B00 = {b0 , . . . , bs0 } and Bi+1\nexactly the final orbits in the block B \u2282 A to which bsi belongs. The cardinality\nof Bi0 varies from 1 (if only the pivot survives) to 2t . Applying\nP Theorem 3.5, let\npi = K i p be the point whose final orbit is bi , and let Si = {um (pj ) : bj \u2208 Bi0 }.\nSince the length of the reduced blocks is bounded, and um is bounded too, we can\nestablish (3) by computing the limit along the surviving pivots, i.e., by establishing\nk\n\n1 X\nSi = 0.\nk\u2192\u221e sk + 1\ni=0\nlim\n\n(4)\n\nConsider the reduced block Bi0 . If Bi0 contains 2t elements, then one sees easily that\nSi = 0. By Lemma 4.7(ii), if Bi0 contains less than 2t elements, then {pj : bj \u2208\nBi0 } \u2282 Y . Therefore (4) follows immediately from the following claim.\nClaim. The set {j \u2208 N : pj \u2208 Y } has density 0.\nProof of Claim. Let us backtrack to the unpruned sequence A, and let q i = \u03c5(ai ).\nThe sequence q 0 , q 1 , q 2 , . . . may have repetitions, but is surely \u03bb-uniformly distributed. Indeed, every continuous function f : \u0393 \u2192 R gives rise to a continuous\nfunction f \u03c5 on Z2 . One then uses the fact that A is \u03bc-uniformly distributed [9, Theorem IV.4.2], and that \u03bb is the push-forward of \u03bc by \u03c5, as noted in Corollary 3.8.\n\n\f14\n\nKAKUTANI-VON NEUMANN MAPS\n\nChoose now \u03b5 > 0. By the above, we can find an index i0 such that for each\ni1 \u2265 i0 we have\n]{0 \u2264 i < i1 : q i \u2208 Y }\n\u03b5\n< n(n\u22121)/2 ,\ni1\n2\nwhere ] denotes cardinality. Without loss of generality ai0 is a surviving pivot,\nsay ai0 = bj0 . Let j1 \u2265 j0 , so that bj1 = ai1 for a certain i1 \u2265 i0 . By Theorem 3.2, every point in q 0 , q 1 , q 2 , . . . repeats at most 2n(n\u22121)/2 times. Therefore\nj1 \u2265 i1 /2n(n\u22121)/2 , and we obtain\n]{0 \u2264 j < j1 : pj \u2208 Y }\n]{0 \u2264 j < j1 : pj \u2208 Y }\n\u2264 2n(n\u22121)/2\nj1\ni1\n]{0 \u2264 i < i1 : q i \u2208 Y }\n\u2264 2n(n\u22121)/2\n< \u03b5.\ni1\nThis proves our claim, and concludes the proof of Theorem 4.6.\n5. An arithmetical conjugate\nIn this final section we discuss a conjugate of our map K that has some arithmetical significance. Since the facts we are presenting derive in a rather formal\nfashion from the results proved in the previous sections, we will be somehow brief.\nRecall the matrices C0 and C1 introduced in Section 2. Define a map \u03c80 : \u0393 \u2192 \u0393\nas follows: if p = (\u03b11 , . . . , \u03b1n ) \u2208 \u0393, then \u03c80 p is the unique point (\u03b21 , . . . , \u03b2n ) such\nthat (\u03b21 * * * \u03b2m 1)tr is proportional to C0 (\u03b11 * * * \u03b1m 1)tr . Define analogously \u03c81 in\nterms of C1 . For every t \u2265 1 and every tuple (a0 , . . . , at\u22121 ) \u2208 {0, 1}t the image\n\u03c8a0 * * * \u03c8at\u22121 \u0393 is a simplex, and the set of all faces of these 2t n-dimensional simplexes form a simplicial complex Ft supported on \u0393. The complexes Ft and Bt are\ncombinatorially isomorphic, and there exists a unique orientation-preserving homeomorphism \u03a6 : \u0393 \u2192 \u0393 that restricts to homeomorphisms between \u03c8a0 * * * \u03c8at\u22121 \u0393\nand \u03c4a0 * * * \u03c4at\u22121 \u0393, for each t and a0 , . . . , at\u22121 . See [10] for the above results; the\nmap \u03a6 can be seen as an n-dimensional generalization of the Minkowski question\nmark function [8], [12].\nSince K was defined via a combinatorial property (namely, the existence of\nthe partitions in Proposition 2.1), it is no surprise that the conjugate \u03a6\u22121 K\u03a6\nis definable via an analogous combinatorial construction. Namely, we define a\n0\n=\nbijection E : \u0393 \u2192 \u0393 by setting E = \u03c80k \u03c81 (\u03c81k \u03c80 )\u22121 on \u03c81k \u03c80 \u0393o . We also set Ev\u22121\nT k\n0\nv0 , where v\u22121 is the only element in {\u03c81 \u0393 : k \u2265 0}. By [10, Proposition 3.1] the\nfollowing diagram commutes\nk\n\n\u03c81 \u03c80\n\u03c81k \u03c80 \u0393o o\n\u03a6\n\n\u0393o\n\u03a6\n\n\u000f\n\n\u03c41k \u03c40 \u0393o o\n\n\u03c41k \u03c40\n\n\u000f\n\u0393o\n\n\u03c80k \u03c81\n\n/ \u03c8 k \u03c81 \u0393o\n0\n\u03a6\n\n\u000f\n/ \u03c4 k \u03c81 \u0393o\n0\n\n\u03c40k \u03c41\n\n0\nSince \u03a6v\u22121\n= v\u22121 and \u03a6v0 = v0 , we have E = \u03a6\u22121 K\u03a6, as expected.\nThe bijection E is piecewise-fractional with integer coefficients: indeed, let\n(ei1 * * * ein+1 ) be the ith row of C0k C1 C0\u22121 C1\u2212k . Then on \u03c81k \u03c80 \u0393o the ith component E i of E (i.e., E followed by the projection on the ith coordinate) has the\n\n\fKAKUTANI-VON NEUMANN MAPS\n\n15\n\nform\n+ * * * + ein \u03b1n + ein+1\n.\n+ * * * + en+1\n\u03b1n + en+1\nn\nn+1\nIn the 1-dimensional case a conjugate of the classical Kakutani-von Neumann map\nvia the Minkowski function was introduced in [1, Theorem 2.3].\nE i (\u03b11 , . . . , \u03b1n ) =\n\nei1 \u03b11\nn+1\ne1 \u03b11\n\nTheorem 5.1. The homeomorphism E is minimal and uniquely ergodic, with the\nMinkowski measure \u03a6\u2217 \u03bb as its unique invariant probability. All points of \u0393 have\na \u03a6\u2217 \u03bb-uniformly distributed E-orbit. The orbit of v0 constitutes an enumeration\nwithout repetitions of all points in \u0393 having rational coordinates.\nProof. By definition \u03a6\u2217 \u03bb is the pullback of \u03bb via \u03a6, i.e., (\u03a6\u2217 \u03bb)(A) = \u03bb(\u03a6A) for\nevery Borel subset A of \u0393. All statements are immediate from our previous results,\nupon noting that by [10, Theorem 3.5] the set of rational points in \u0393 is mapped\nbijectively by \u03a6 to the set of dyadic points.\n\u0003\nBasic ergodic theory yields that the Minkowski and the Lebesgue measures are\nmutually singular [10, p. 262]. The enumeration of all rational points given by\nTheorem 5.1 gives a nice and effective representation of the mass distribution determined by the Minkowski measure, so we conclude this paper by drawing the first\n6000 points in the E-orbit of v0 .\n\nFigure 4: the set {E t v0 : 0 \u2264 t < 6000}.\nReferences\n[1] C. Bonanno and S. Isola. Orderings of the rationals and dynamical systems. Colloq. Math.,\n116(2):165\u2013189, 2009.\n[2] I. P. Cornfeld, S. V. Fomin, and Ya. G. Sina\u0131\u0306. Ergodic theory, volume 245 of Grundlehren der\nMathematischen Wissenschaften. Springer, 1982.\n[3] N. P. Fogg. Substitutions in dynamics, arithmetics and combinatorics, volume 1794 of Lecture\nNotes in Mathematics. Springer-Verlag, Berlin, 2002. Edited by V. Berth\u00e9, S. Ferenczi, C.\nMauduit and A. Siegel.\n\n\f16\n\nKAKUTANI-VON NEUMANN MAPS\n\n[4] N. A. Friedman. Replication and stacking in ergodic theory. Amer. Math. Monthly, 99(1):31\u2013\n41, 1992.\n[5] P. Hellekalek. General discrepancy estimates: the Walsh function system. Acta Arith.,\n67(3):209\u2013218, 1994.\n[6] J. G. Hocking and G. S. Young. Topology. Dover, 1988. First published in 1961 by AddisonWesley.\n[7] A. Katok and B. Hasselblatt. Introduction to the modern theory of dynamical systems, volume 54 of Encyclopedia of Mathematics and its Applications. Cambridge University Press,\nCambridge, 1995. With a supplementary chapter by Katok and Leonardo Mendoza.\n[8] J. R. Kinney. Note on a singular function of Minkowski. Proc. Amer. Math. Soc., 11:788\u2013794,\n1960.\n[9] L. Kuipers and H. Niederreiter. Uniform distribution of sequences. Dover, 2006. First published in 1974 by Wiley-Interscience.\n[10] G. Panti. Multidimensional continued fractions and a Minkowski function. Monatshefte f\u00fcr\nMathematik, 154:247\u2013264, 2008.\n[11] C. P. Rourke and B. J. Sanderson. Introduction to Piecewise-Linear Topology. Springer, 1972.\n[12] P. Viader, J. Parad\u0131\u0301s, and L. Bibiloni. A new light on Minkowski's ?(x) function. J. Number\nTheory, 73(2):212\u2013227, 1998.\n[13] P. Walters. An introduction to ergodic theory, volume 79 of Graduate Texts in Mathematics.\nSpringer, 1982.\nDepartment of Mathematics, University of Udine, via delle Scienze 208, 33100 Udine,\nItaly\nE-mail address: panti@dimi.uniud.it\n\n\f"}