{"id": "http://arxiv.org/abs/0905.3250v2", "guidislink": true, "updated": "2013-12-20T19:44:25Z", "updated_parsed": [2013, 12, 20, 19, 44, 25, 4, 354, 0], "published": "2009-05-20T09:08:29Z", "published_parsed": [2009, 5, 20, 9, 8, 29, 2, 140, 0], "title": "Generalised Weber Functions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0905.3060%2C0905.0880%2C0905.1293%2C0905.4504%2C0905.2561%2C0905.3542%2C0905.1893%2C0905.3302%2C0905.3426%2C0905.0982%2C0905.0617%2C0905.4336%2C0905.1296%2C0905.2835%2C0905.3452%2C0905.0491%2C0905.3453%2C0905.3843%2C0905.1467%2C0905.4729%2C0905.2519%2C0905.3280%2C0905.2230%2C0905.3592%2C0905.4173%2C0905.1326%2C0905.1099%2C0905.3531%2C0905.2216%2C0905.0263%2C0905.4158%2C0905.4892%2C0905.2211%2C0905.0282%2C0905.2237%2C0905.1194%2C0905.1131%2C0905.4601%2C0905.4326%2C0905.4607%2C0905.4376%2C0905.2379%2C0905.2572%2C0905.4787%2C0905.1240%2C0905.4468%2C0905.3112%2C0905.4690%2C0905.3800%2C0905.1532%2C0905.0346%2C0905.3693%2C0905.4242%2C0905.0203%2C0905.2446%2C0905.0719%2C0905.1769%2C0905.0158%2C0905.2992%2C0905.2571%2C0905.2279%2C0905.3666%2C0905.3374%2C0905.3852%2C0905.2952%2C0905.1464%2C0905.1474%2C0905.3447%2C0905.1349%2C0905.1263%2C0905.1193%2C0905.3111%2C0905.0130%2C0905.1828%2C0905.2893%2C0905.3558%2C0905.2209%2C0905.1403%2C0905.3940%2C0905.0234%2C0905.4412%2C0905.3296%2C0905.0873%2C0905.0777%2C0905.2234%2C0905.4666%2C0905.1005%2C0905.1885%2C0905.4430%2C0905.3250%2C0905.3273%2C0905.0320%2C0905.3575%2C0905.0085%2C0905.4270%2C0905.1575%2C0905.4490%2C0905.1687%2C0905.1429%2C0905.0829%2C0905.2613&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Generalised Weber Functions"}, "summary": "A generalised Weber function is given by $\\w_N(z) = \\eta(z/N)/\\eta(z)$, where\n$\\eta(z)$ is the Dedekind function and $N$ is any integer; the original\nfunction corresponds to $N=2$. We classify the cases where some power $\\w_N^e$\nevaluated at some quadratic integer generates the ring class field associated\nto an order of an imaginary quadratic field. We compare the heights of our\ninvariants by giving a general formula for the degree of the modular equation\nrelating $\\w_N(z)$ and $j(z)$. Our ultimate goal is the use of these invariants\nin constructing reductions of elliptic curves over finite fields suitable for\ncryptographic use.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0905.3060%2C0905.0880%2C0905.1293%2C0905.4504%2C0905.2561%2C0905.3542%2C0905.1893%2C0905.3302%2C0905.3426%2C0905.0982%2C0905.0617%2C0905.4336%2C0905.1296%2C0905.2835%2C0905.3452%2C0905.0491%2C0905.3453%2C0905.3843%2C0905.1467%2C0905.4729%2C0905.2519%2C0905.3280%2C0905.2230%2C0905.3592%2C0905.4173%2C0905.1326%2C0905.1099%2C0905.3531%2C0905.2216%2C0905.0263%2C0905.4158%2C0905.4892%2C0905.2211%2C0905.0282%2C0905.2237%2C0905.1194%2C0905.1131%2C0905.4601%2C0905.4326%2C0905.4607%2C0905.4376%2C0905.2379%2C0905.2572%2C0905.4787%2C0905.1240%2C0905.4468%2C0905.3112%2C0905.4690%2C0905.3800%2C0905.1532%2C0905.0346%2C0905.3693%2C0905.4242%2C0905.0203%2C0905.2446%2C0905.0719%2C0905.1769%2C0905.0158%2C0905.2992%2C0905.2571%2C0905.2279%2C0905.3666%2C0905.3374%2C0905.3852%2C0905.2952%2C0905.1464%2C0905.1474%2C0905.3447%2C0905.1349%2C0905.1263%2C0905.1193%2C0905.3111%2C0905.0130%2C0905.1828%2C0905.2893%2C0905.3558%2C0905.2209%2C0905.1403%2C0905.3940%2C0905.0234%2C0905.4412%2C0905.3296%2C0905.0873%2C0905.0777%2C0905.2234%2C0905.4666%2C0905.1005%2C0905.1885%2C0905.4430%2C0905.3250%2C0905.3273%2C0905.0320%2C0905.3575%2C0905.0085%2C0905.4270%2C0905.1575%2C0905.4490%2C0905.1687%2C0905.1429%2C0905.0829%2C0905.2613&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A generalised Weber function is given by $\\w_N(z) = \\eta(z/N)/\\eta(z)$, where\n$\\eta(z)$ is the Dedekind function and $N$ is any integer; the original\nfunction corresponds to $N=2$. We classify the cases where some power $\\w_N^e$\nevaluated at some quadratic integer generates the ring class field associated\nto an order of an imaginary quadratic field. We compare the heights of our\ninvariants by giving a general formula for the degree of the modular equation\nrelating $\\w_N(z)$ and $j(z)$. Our ultimate goal is the use of these invariants\nin constructing reductions of elliptic curves over finite fields suitable for\ncryptographic use."}, "authors": ["Andreas Enge", "Fran\u00e7ois Morain"], "author_detail": {"name": "Fran\u00e7ois Morain"}, "author": "Fran\u00e7ois Morain", "links": [{"href": "http://arxiv.org/abs/0905.3250v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0905.3250v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0905.3250v2", "affiliation": "LIX, INRIA Saclay - Ile de France", "arxiv_url": "http://arxiv.org/abs/0905.3250v2", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0905.3250v2 [math.NT] 20 Dec 2013\n\nGeneralised Weber Functions\nAndreas Enge\nINRIA, LFANT\nCNRS, IMB, UMR 5251\nUniv. Bordeaux, IMB\n33400 Talence\nFrance\nandreas.enge@inria.fr\n\nFran\u00e7ois Morain\nINRIA Saclay\u2013\u00cele-de-France\n& LIX (CNRS/UMR 7161)\n\u00c9cole polytechnique\n91128 Palaiseau Cedex\nFrance\nmorain@lix.polytechnique.fr\n\n20 December 2013\nAbstract\nA generalised Weber function is given by wN (z) = \u03b7(z/N )/\u03b7(z),\nwhere \u03b7(z) is the Dedekind function and N is any integer; the original\nfunction corresponds to N = 2. We classify the cases where some\npower weN evaluated at some quadratic integer generates the ring\nclass field associated to an order of an imaginary quadratic field. We\ncompare the heights of our invariants by giving a general formula\nfor the degree of the modular equation relating wN (z) and j(z). Our\nultimate goal is the use of these invariants in constructing reductions\nof elliptic curves over finite fields suitable for cryptographic use.\n\n1\n\nIntroduction\n\nLet K be an imaginary quadratic field of discriminant \u2206 < 0. We are\ninterested in orders O of K having discriminant D = c2 \u2206. The\nprincipal\n\u221a\n1+ \u2206\norder of discriminant\n\u2206 is OK , which is generated by \u03c9 = 2 if \u2206 \u2261 1\n\u221a\n\u2206\n(mod 4) resp. \u03c9 = 2 if \u2206 \u2261 0 (mod 4). For any order O of discriminant\nD, let KD denote the ring class field that is associated to it. It is wellknown that if j denotes the modular invariant, then KD = K(j(c\u03c9)); so\nKD /K \u2243 K[X]/(HD (X)), where the class polynomial HD is the minimal\npolynomial of j(c\u03c9). It can be used to obtain elliptic curves over finite fields\nwith a number of points known in advance, with applications to cryptology,\n2010 Mathematics Subject Classification: 11G15, 14K22\nKey words: complex multiplication, class invariants, eta quotients\n\n1\n\n\f2\n\nA. Enge and F. Morain\n\nin particular based on the Weil or Tate pairing (cf. [13]), and primality\nproving [1].\nSince the class polynomial has a rather large height, it is desirable to\nfind smaller defining polynomials to speed up the computations. There is a\nlong history of such studies, going back to at least Weber [27]; see, e.g., [2,\n26, 20] for connections with the class number 1 problem. Generally modular\nfunctions f and special arguments \u03b1 \u2208 O are considered such that the\nsingular value f (\u03b1) lies in KD , in which case f (\u03b1) is called a class invariant.\nOur ultimate goal is to build elliptic curves having CM, and this is done\nusing a so-called modular equation (with integer coefficients) relating a modular function f to j. For this to be efficient, we need f (\u03b1) to have a small\nheight and the corresponding modular equation to be of small genus (with\na predilection for genus 0).\nPart of the literature has concentrated on the functions introduced by\nWeber, quotients of two \u03b7-functions with a transformation of level 2 applied\nto one of them, see [23, 14, 15, 22] besides the already cited sources. This is\na perfect case for us, since the genus of the associated modular curve is 0.\nResults on more general \u03b7-quotients are given in [18, 17, 19, 14, 8, 12].\nAll of them are obtained using the modern tool for determining the Galois\naction of the class group of O on singular values of modular functions,\nnamely Shimura's reciprocity law [25]. The present article is no exception\nto this rule. For the sake of self-containedness and the reader's ease, we\nbriefly summarise in \u00a72 the reciprocity law in the version of [22], which is\nmost suited to actual computations.\nIn this article, we propose a systematic study of class invariants obtained\nas singular values of the generalised Weber functions wN , defined and studied in \u00a73, which are quotients of two \u03b7-functions with a transformation of\nlevel N applied to one of them. These appear in [22, Table 1] and as a special case of [19]. While there is some overlapping between this article and\n[19], we follow a different approach: The authors of [19] use an ideal in the\nclass group to transform the \u03b7-function, and the norm of the ideal implicitly determines the level; they then proceed to prove which root of unity is\nneeded for twisting the function so that a minimal power of it yields a class\ninvariant. On the other hand, we start with a fixed level and thus a fixed\ngeneralised Weber function and determine the minimal power yielding class\ninvariants without using additional roots of unity.\nA first result on the \"canonical\" power wsN is readily obtained in \u00a74 by\na direct application of Shimura reciprocity. Examining the Galois action on\nthe singular values in \u00a75 allows us to determine the precise conditions under\nwhich lower powers weN with e | s yield class invariants in \u00a76.\nWhile there is always some transformation level N (or, equivalently, an\nideal in the class group) such that the corresponding generalised Weber function yields a class invariant, fixing the level first as we do it in this study\nimplies control over the height of the class invariants. Indeed, this height, an\nimportant measure for the complexity of computing a class polynomial, is\n\n\fGeneralised Weber Functions\n\n3\n\nasymptotically given as a function of the degrees of the modular polynomials relating the modular function to the j-invariant. Thus, the generalised\nWeber functions can be ordered totally with respect to their computational\nefficiency, see \u00a77, and the invariants can be compared directly to other invariants in the literature, cf. [7, 10].\nUnlike [19], we explicitly consider levels N that are not coprime to 6, a\nconsiderable source of complication, which is justified since the corresponding functions tend to yield class invariants of lower height, see the formulae\nin \u00a77.2 and Table 7.2. Otherwise said, the corresponding modular curves,\nrelated to 2- and 3-torsion points on elliptic curves, have a lower genus than\nwould be expected from the size of N alone. This makes it easier to construct\nthe associated elliptic curves with complex multiplication; in particular, [21]\nshows how w3 can be used to directly write down the correct twist of the\nelliptic curve with the desired number of points over a finite field.\nExisting results in the literature often only state when a singular value\nis a class invariant; to obtain the class polynomial, however, one needs an\nexplicit description of its algebraic conjugates. These can be worked out\nusing Shimura reciprocity again; following the approach of N-systems introduced in [22], we obtain synthetic and simple descriptions of the conjugates,\nand moreover determine when the class invariant has a minimal polynomial\nwith rational coefficients, that is, it defines the real subfield of the class field\nover Q.\n\n2\n\nClass invariants by Shimura reciprocity\n\n\u0013\n\u0012\na b\n\u2208\nIn the following, we denote by f \u25e6 M the action of matrices M =\nc d\n\u0393 = Sl2 (Z)/{\u00b11} on modular functions given by\n\u0012\n\u0013\naz + b\n(f \u25e6 M)(z) = f (Mz) = f\n.\ncz + d\n\u001a\u0012\n\u0013 \u0012\n\u0013\n\u001b\na b\n1 0\nFor n \u2208 N, let \u0393(n) =\n\u2261\n(mod n) be the principal\nc d\n0 1\ncongruence subgroup of level n; for a congruence subgroup \u0393\u2032 such that\n\u0393(n) \u2286 \u0393\u2032 \u2286 \u0393, denote by C\u0393\u2032 the field of modular functions for \u0393\u2032 .\nOne\nthe most\nimportant congruence\nsubgroups is given by \u03930 (n) =\n\u0013\n\u001b\n\u0012\n\u001a\u0012 of \u0013\n\u2217 0\na b\n(mod n) .\n\u2261\n\u2217 \u2217\nc d\n\nDefinition 2.1. The set Fn of modular functions of level n rational over\nthe n-th cyclotomic field Q(\u03b6n ) is given by all functions f such that\n1. f is modular for \u0393(n) and\n2. the q-expansion of f has coefficients in Q(\u03b6n ), that is,\n\u0001\u0001\nf \u2208 Q(\u03b6n ) q 1/n ,\n\n\f4\n\nA. Enge and F. Morain\nwhere q 1/n = e2\u03c0iz/n .\n\nThe function field extension Fn /Q(j) has Galois group isomorphic to\nGl2 (Z/nZ)/{\u00b11}, where the isomorphism is defined by the following action\nof matrices on functions:\n\u2022 (f \u25e6 M)(z) = f (Mz) as above for M \u2208 \u0393; this implies in particular\nthat also the q-expansion of f \u25e6 M has coefficients in Q(\u03b6n );\n\u0012\n\u0013\n1 0\n\u2022 f\u25e6\nfor gcd(d, n) = 1 is obtained by applying to the q-expansion\n0 d\nof f the automorphism \u03b6n 7\u2192 \u03b6nd;\n\u2022 any other matrix\nM\n\u0012\n\u0013 that is invertible modulo n may be decomposed\n1 0\nas M \u2261 M1\nM2 (mod n) with gcd(d, n) = 1 and M1 , M2 \u2208 \u0393,\n0 d\nand\n\u0012\u0012\n\u0012\n\u0013\u0013\n\u0013\n1 0\n\u25e6 M2 (z).\n(f \u25e6 M)(z) =\n(f \u25e6 M1 ) \u25e6\n0 d\nShimura reciprocity makes a link between the Galois group of the function field Fn and the Galois groups of class fields generated over an imaginary-quadratic field by singular values of modular functions.\nTheorem 2.2 (Shimura's reciprocity law, Th. 5 of [22], Th. 5.1.2 of [24]).\nLet f be a function\n\u221a in Fn , \u2206 < 0 a fundamental discriminant and O the\norder of K = Q( \u2206) of conductor c. In\n\u0012 the\u0013following, all Z-bases of ideals\n\u03b11\nwith basis quotient \u03b1 = \u03b1\u03b112 \u2208\nare written as column vectors. Let a =\n\u03b12 Z\nH be a proper ideal of O, m an ideal of OK of norm m prime to cn, m\nits \u0012\nconjugate\nideal and M \u2208 Gl2 (Z) a matrix of determinant m such that\n\u0013\n\u03b11\nis a basis of a(m \u2229 O). If f does not have a pole in \u03b1, then\nM\n\u03b12\n\u2022 f (\u03b1) lies in the ray class field modulo cn over K and\n\u2022 the Frobenius map \u03c3(m) acts as\nf (\u03b1)\u03c3(m) = (f \u25e6 mM \u22121 )(M\u03b1).\nIn the following, we are particularly interested in class invariants, that is,\nvalues f (\u03b1) that lie not only in a ray class field, but even in a ring class field.\nUsing Shimura's reciprocity law, [22, Th. 4] gives a very general criterion\nfor class invariants, which is the basis for our further investigations.\nTheorem 2.3. Let f \u2208 C\u03930 (n) for some n \u2208 N be such that f itself and\nf \u25e6 S have rational q-expansions. Denote by \u03b1 \u2208 H a root of the primitive\nform [A, B, C] of discriminant D with gcd(A, n) = 1 and n | C. If \u03b1 is not\na pole of f , then f (\u03b1) \u2208 KD .\n\n\f5\n\nGeneralised Weber Functions\n\nThe conjugates of f (\u03b1) are then derived generically in a form that is well\nsuited for computations in [22, Prop. 3 and Th. 7], [24, Th. 5.2.4].\nTheorem 2.4. An n-system for the discriminant D is a complete system\nof equivalence classes of primitive quadratic forms [Ai , Bi , Ci ] = Ai X 2 +\nBi X + Ci , i = 1, . . . , h(D), of discriminant D = Bi2 \u2212 4Ai Ci , such that\ngcd(Ai , n) = 1 and Bi \u2261 B1 (mod 2n). Such a system exists for any n. To\nthese quadratic\nforms, we associate in the following the quadratic numbers\n\u221a\n\u2212Bi + D\n\u03b1i = 2Ai .\n\u0013\n\u0012\n0 \u22121\nhas a rational qLet f \u2208 Fn be such that f \u25e6 S with S =\n1 0\nexpansion. If f (\u03b11 ) \u2208 KD , then a complete system of conjugates of f (\u03b11 )\nunder the Galois group of KD is given by the f (\u03b1i ), and the characteristic\npolynomial of f (\u03b11 ) over K is\nh(D)\n\nHD [f ] =\n\nY\ni=1\n\n3\n\n(X \u2212 f (\u03b1i )).\n\nThe generalised Weber functions wN\n\nIn this section we examine the general properties of the function wN , with\nthe aim in mind of applying Theorem 2.3 to its powers.\nLet z be any complex number and put q = e2i\u03c0z . Dedekind's \u03b7-function\nis defined by [5]\nY\n\u03b7(z) = q 1/24\n(1 \u2212 q m ).\nm>1\n\nThe Weber functions are [27, \u00a7 34, p. 114]\n\u22121\nf(z) = \u03b648\n\n\u03b7((z + 1)/2)\n,\n\u03b7(z)\n\nf1 (z) =\n\n\u03b7(z/2)\n,\n\u03b7(z)\n\nf2 (z) =\n\n\u221a \u03b7(2z)\n.\n2\n\u03b7(z)\n\nThe modular invariant j is recovered via [27, \u00a7 54, p. 179]:\nj(z) =\n\n3\n3\n(f24 \u2212 16)3\n(f24\n(f24\n1 + 16)\n2 + 16)\n=\n=\n.\nf24\nf24\nf24\n1\n2\n\n24\nThe functions \u2212f24 , f24\n1 and f2 are the three roots of the modular polynomial\n\n\u03a6c2 (F, j) = F 3 + 48 F 2 + F (768 \u2212 j) + 4096,\nthat describes the curve X0 (2).\nFor an integer N > 1, let the generalised Weber function be defined by\nwN =\n\n\u03b7(z/N)\n.\n\u03b7(z)\n\n\f6\n\nA. Enge and F. Morain\n\nAs shown in the following, there is a canonical exponent t such that wtN is\nmodular for \u03930 (N). Its minimal polynomial \u03a6cN (F, j) over C(j) is a model\nfor X0 (N). The other roots of this polynomial can be expressed in terms of\n\u03b7, too, a topic to which we come back in \u00a77.\nWe need to know the behaviour of wN under unimodular transformations, which can be broken down to the transformation behaviour of \u03b7(z/K)\nfor K = 1 or N. This has been worked out in [9, Th. 3].\n\u0013\n\u0012\na b\n\u2208 \u0393 be normalised such that c > 0, and\nTheorem 3.1. Let M =\nc d\nd > 0 if c = 0. Write c = c1 2\u03bb(c) with c1 odd; by convention, c1 = \u03bb(c) = 1\nif c = 0. Define\n\u0012 \u0013\na ab+c(d(1\u2212a2 )\u2212a)+3c1 (a\u22121)+ 32 \u03bb(c)(a2 \u22121)\n\u03b5(M) =\n\u03b6\n.\nc1 24\nFor K \u2208 N write\nua + vKc = \u03b4 = gcd(a, Kc) = gcd(a, K).\nThen\n\u0012a\n\u0013\n\u0010z\u0011\n\u2212v p\n\u03b4\n\u25e6 M = \u03b5 Kc\n\u03b4(cz + d) \u03b7\n\u03b7\nu\nK\n\u03b4\n\n\u03b4z + (ub + vKd)\nK\n\u03b4\n\n!\n\n,\n\nwhere the square root is chosen with positive real part.\nTheorem\n3.2.\n\u0012\n\u0013 The function wN has a rational q-expansion. Denote by\n0 \u22121\nS =\nthe matrix belonging to the inversion z 7\u2192 \u2212 1z . If N is a\n1 0\nsquare, then wN \u25e6 S has a rational q-expansion. Otherwise, w2N \u25e6 S has a\nrational q-expansion.\nLet the subscript 1 and the function \u03bb have the same meaning for a\n\u03bb(n)\nwith n1 odd. If\npositive\n\u0012 integer\u0013n as in Theorem 3.1, that is, n = n1 2\na Nb0\n\u2208 \u03930 (N), then wN \u25e6 M = \u03b5 wN with\nM=\nc d\n\u0012 \u0013\n(N \u22121)(a\u22121)\n\u03bb(N)(a2 \u22121)\na\n(N \u22121)(\u2212b0 a+c(d(1\u2212a2 )\u2212a)) c1 1 2\n8\n\u03b624\n\u03b64\n(\u22121)\n.\n(3.1)\n\u03b5=\nN1\nLet t = gcd(N24\u22121,24) measure how far N \u2212 1 is from being divisible by 24,\nand let e and s be such that t | s |\u0001 24 and e \u0001| s. If N1 is a square or e is\neven, then \u0001weN is modular\nfor \u0393 es \u2229 \u03930 es N . Otherwise, weN is modular\n\u0001\ns\n0 s\nfor \u0393 e N1 \u2229 \u0393 e N . In both cases, weN \u2208 F es N \u2286 F24N .\nProof.\n\u0013The q-expansion of wN is rational since that of \u03b7 is. Let M =\n\u0012\na b\n\u2208 \u0393. By Theorem 3.1 applied to K = 1 and N, we have\nc d\n\u0010\n\u0011\n\u03b4z+(ub+vN d)\n\u0013\u22121\n\u0013 \u0012\n\u0012a\n\u03b7\nN\n\u221a\na b\n\u2212v\n\u03b4\n\u03b5\n\u03b4\n(3.2)\nwN \u25e6 M = \u03b5 N\u03b4c\nc\nd\nu\n\u03b7(z)\n\u03b4\n\n\f7\n\nGeneralised Weber Functions\nwith \u03b4 = gcd(a, N) = ua + vNc.\nIn the special case M = S we obtain \u03b4 = N, v = 1, u = 0 and\nwN \u25e6 S =\n\n\u221a\n\nN\n\n\u03b7(Nz)\n,\n\u03b7(z)\n\nwhich proves the assertion on the q-expansion of wN \u25e6 S.\nAssume now that M \u2208 \u03930 (N). Letting b = Nb0 , we have \u03b4 = 1, u = d\nand v = \u2212b0 since ad \u2212 bc = 1. Thus, (3.2) specialises as\n\u0013\u22121\n\u0013 \u0012\n\u0012\n\u03b7(z/N)\na b\na b0\n\u03b5\nwN \u25e6 M = \u03b5\n= \u03b5 wN (z)\nc d\nNc d\n\u03b7(z)\nwith\n\u0013\u0012 \u0013\u22121\n\u0012\na\na\n(b0 \u2212b)a+c(N \u22121)(d(1\u2212a2 )\u2212a)+3c1 (N1 \u22121)(a\u22121)+ 32 (\u03bb(N c)\u2212\u03bb(c))(a2 \u22121)\n\u03b624\n\u03b5=\n,\nc1\nc1 N1\nwhich proves (3.1).\nWe need to examine under which conditions \u03b5e = 1. The Legendre symbol\nvanishes when N1 is a square, e is even or a \u2261 1 (mod N1 ). The exponent\nof \u03b624 becomes divisible by s(N \u2212 1) and thus by 24 whenever se divides b0\nand c.\nIn the case of odd N, we have \u03bb(N) = 0 and N = N1 , and the condition\non a implies that the exponent of \u03b64 is divisible by 4.\nIn the case of even N, the coefficient a is odd since det M = 1, and\ne\n\n\u03b5 = (\u22121)\n\n\u0010\n\u0011\n2\n(N \u22121)(a\u22121)\n+\u03bb(N ) a 8\u22121\ne c1 1 4\n\n.\n\nFor even e, there is nothing to show. If e is odd, then 8 | t | s implies that\na \u2261 1 (mod 8), which finishes the proof.\n\n4\n\nFull powers of wN\n\nTo be able to apply Theorem 2.3 directly to powers of wN , we are interested\nin the minimal exponent s such that wsN is invariant under \u03930 (N) and\nwsN \u25e6S has a rational q-expansion. From Theorem 3.2, we recover the integer\nt = 24/(gcd(N \u2212 1, 24)) and recall that s = 2t if t is odd and N is not a\nsquare, and s = t otherwise.\n\n4.1\n\nArithmetical prerequisites\n\nWe begin with the following purely arithmetical lemma.\nLemma 4.1. Let N be an integer. For a prime p, denote by vp the p-adic\nvaluation. Let D = c2 \u2206 be a discriminant with fundamental part \u2206. Then D\nadmits a square root B modulo 4N if and only if for each prime p dividing\nN, one of the following holds.\n\n\f8\n\nA. Enge and F. Morain\n1.\n\n\u2206\np\n\n= +1;\n\n2.\n\n\u2206\np\n\n= \u22121 and vp (N) 6 2vp (c);\n\n3.\n\n\u2206\np\n\n= 0 and vp (N) 6 2vp (c) + 1.\n\n\u0001\n\u0001\n\u0001\n\nProof. The Chinese remainder theorem allows to argue modulo the different\nprime powers dividing N. The argumentation is slightly different for p odd\nand even, and we give some hints only for p = 2.\nWhen \u2206 \u2261 1 mod 8, \u2206 admits a square root modulo any power of 2.\nWhen \u2206 is even, then \u2206 \u2261 8 or 12 (mod 16), and \u2206 is a square modulo\n8, but not modulo any higher power of 2. Therefore, c2 \u2206 is a square modulo\n4N if and only if v2 (c2 ) + 3 > v2 (4N).\nWhen \u2206 \u2261 5 mod 8, \u2206 has a square root modulo 4 but not modulo 8,\nso that v2 (c2 ) + 2 > v2 (4N) is needed in that case.\nIn the following, arithmetical conditions on a prime p to be representable\nby the principal form of discriminant D will be needed. We take the following form of Dirichlet's theorem from [3, Ch.\n\u0001 4] (alternatively,\n\u0001 see [4, Chap\n2\n18, G]). For an integer p, let \u03c74 (p) = \u22121\nand\n\u03c7\n(p)\n=\n. The generic\n8\np\np\n2\ncharacters of D = c \u2206 are defined as follows:\np\u0001\n(a) q for all odd primes q dividing D;\n(b) if D is even:\n\n(i) \u03c74 (p) if D/4 \u2261 3, 4, 7 (mod 8);\n\n(ii) \u03c78 (p) if D/4 \u2261 2 (mod 8);\n\n(iii) \u03c74 (p) * \u03c78 (p) if D/4 \u2261 6 (mod 8);\n\n(iv) \u03c74 (p) and \u03c78 (p) if D/4 \u2261 0 (mod 8).\n\nNote that if D is fundamental (i.e., c = 1), then case (iv) cannot occur and\nin case (i), we may have D/4 \u2261 3, 7 (mod 8) only.\nTheorem 4.2. An integer p such that gcd(p, 2cD) = 1 is representable by\nsome class of forms in the principal genus of discriminant D if and only if\nall generic characters \u03c7(p) have value +1. In particular, this condition is\nnecessary for representability by the principal class.\n\n4.2\n\nClass invariants\n\nTheorem 4.3. Let N be an integer and t = gcd(N24\u22121,24) . If t is odd and N\nis not a square, let s = 2t, otherwise, let s = t. Suppose D satisfies Lemma\n\u221a\ni+ D\n4.1. Consider an N-system of forms [Ai , Bi , Ci ] with roots \u03b1i = \u2212B2A\ni\nsuch that Bi \u2261 B (mod 2N), as introduced in 2.4. Then the singular values\nwsN (\u03b1i ) lie in the ring class field KD , and they form a complete set of Galois\nconjugates.\n\n\f9\n\nGeneralised Weber Functions\n2\n\nProof. Once the existence of B is verified, the form [1, B, C] with C = B 4\u2212D\nis of discriminant D and satisfies N | C. The assertion of the theorem is\nthen a direct consequence of Theorems 2.3 and 3.2.\ns\nSometimes, the characteristic polynomial of w\u221a\nN is real, so that its coefficients lie in Z instead of the ring of integers of Q( D). It is then interesting\nto determine the pairs of quadratic forms that lead to complex conjugates.\n\nTheorem 4.4. Under the assumptions of Theorem 4.3, let B \u2261 0 (mod N),\nwhich is possible whenever N is odd and N | D, or N is even and 4N | D.\nThen the characteristic polynomial of wsN is real. More precisely, if \u03b1i and\n\u03b1j are roots of inverse forms of the N-system, then wsN (\u03b1j ) = wsN (\u03b1i ).\nProof. Notice that B \u2261 0 (mod N) and Bi \u2261 B (mod 2N) imply \u2212Bi \u2261 B\n(mod 2N), so that [Ai , \u2212Bi , Ci ], the inverse \u0010form of \u0011[Ai , Bi , Ci ], satisfies the\n\u221a\n+ D\n= wsN (\u2212\u03b1i ). On the\nN-system constraint; thus wsN (\u03b1j ) = wsN Bi2A\ni\n\nother hand, q(\u2212\u03b1i ) = q(\u03b1i ), which implies wN (\u2212\u03b1i ) = wN (\u03b1i ) since wN\nhas a rational q-expansion.\n\nThese first results, direct consequences of the Shimura reciprocity law,\nare meant to set the stage for the detailed and much more involved analysis\nof lower powers in the following chapters. For gcd(N, 6) = 1, [19, Theorem 20] determines a 48-th root of unity \u03b6 and an exponent e | s such\nthat \u03b6weN yields a class invariant. With a bit of work, it can be shown that\n\u03b6 s/e = 1 in our context, which provides an alternative proof of Theorem 4.3\nwithout giving the algebraic conjugates of the singular value.\n\n5\n\nExplicit Galois action\n\nThroughout the remainder of this section, we assume that N is a square\nor e is even, so that f = weN and f \u25e6 S have rational q-expansions by\nTheorem 3.2. Let \u03b1 be a root of the primitive quadratic form [A, B, C] of\ndiscriminant D with gcd(A, N) = 1. By Theorems 3.2 and 2.2, the singular\nvalue f (\u03b1) lies in the ray class field modulo c et N over K, and the Galois\naction of ideals in OK can be computed explicitly. We eventually need to\nshow that the action of principal prime ideals generated by elements in O\nis trivial, which implies that the singular value lies in the ring class field\nKD . Then Theorems 3.2 and 2.4 show that the conjugates are given by the\nsingular values in a et N-system.\nWe are only interested in the situation that N | C. Notice that under\ngcd(A, N) = 1 this is equivalent to 4N | 4AC = B 2 \u2212 D, or B 2 \u2261 D\n(mod 4N). The remainder of this section is devoted to computing in this\ncase the Galois action of principal prime ideals (\u03c0) with \u03c0 \u2208 O coprime to\n6cN on the singular values according to the arithmetic properties of N and\nD. \u00a76 applies these results to the determination of class invariants.\n\n\f10\n\nA. Enge and F. Morain\n\nTo apply Shimura reciprocity in the formulation of Theorem 2.2, we\nneed\u0012to explicitly\nwrite down adapted\n\u0013\n\u0012 \u0013 bases for the different ideals. So let\nA\u03b1\nA\u03b1\nwith basis quotient \u03b1. Without loss\nbe an ideal of O =\na=\n1 Z\nA Z\nof generality, we may assume that p = N(\u03c0) | C by suitably modifying \u03b1:\nIndeed, notice that the quadratic form associated to \u03b1\u2032 = \u03b1\u221224kN for some\nk \u2208 Z is given by [A, B \u2032 , C \u2032 ] = [A, B+2A(24kN), A(24kN)2 +B(24kN)+C].\nThis form still satisfies N | C \u2032 , and furthermore f (\u03b1\u2032 ) = f (\u03b1) since f is\ninvariant under translations by 24N according to Theorem 3.2. Since p splits\nin O and is prime to c, the equation AX 2 + BX + C has a root x modulo p.\nChoosing k \u2208 Z such that k \u2261 x(24N)\u22121 (mod p), which is possible since\np \u2224 6N, we obtain p | C \u2032 .\nLet \u03c0 = u + vA\u03b1 with u, v \u2208 Z. From\np = N(\u03c0) = u(u \u2212 vB) + v 2 AC\n\n(5.1)\n\nand p | C we deduce that p divides u or u\u2032 = u \u2212 vB. Using A\u03b1 = \u2212A\u03b1 \u2212 B\nand N(A\u03b1) = AC, we compute\n\u0012 \u0013 \u0012\n\u0013 \u0012\n\u0013\u0012 \u0013\nA\u03b1\nuA\u03b1 + vAC\nu\nvC\nA\u03b1\npa = \u03c0\n=\n=\n2\nA\nuA \u2212 vA \u03b1 \u2212 vAB\n\u2212vA u \u2212 vB\nA\nSo if p | u, the matrix M of Theorem 2.2 is given by\n\u0013\n\u0012 u\n\u0013 \u0012\n\u0012\n\u0013\nv Cp\np 0\nu\nvC\np\nM1 with M1 =\n=\nM=\n\u2208 \u03930 (N)\n0 1\n\u2212vA u \u2212 vB\n\u2212vA u\u2032\nsince N | C and p \u2224 N.\nIf f is invariant under M1\u22121 , the rationality of its q-expansion implies\nthat\n\u0012\n\u0013\n1 0\n\u22121\n\u22121\nf \u25e6 mM = f \u25e6 M1 \u25e6\n= f,\n0 p\n\nso that\n\nf (\u03b1)\n\n\u03c3(p)\n\n= f (M\u03b1) = f\n\n\u0012\n\nu\u03b1 + vC\n\u2212vA\u03b1 + u \u2212 vB\n\n\u0013\n\n=f\n\n\u0012\n\n\u03c0\u03b1\n\u03c0\n\n\u0013\n\n= f (\u03b1).\n\nFor p | u\u2032 , we decompose in a similar manner\n\u0012\n\u0013\n\u0012\n\u0013\n1 0\np 0\nM = M2\n= M2 S\nS with M2 =\n0 p\n0 1\n\nu\nv Cp\n\u2032\n\u2212vA up\n\n!\n\n\u2208 \u03930 (N),\n\nand the rationality of the q-expansion of f \u25e6 S allows to conclude if f is\ninvariant under M2\u22121 .\nSo we need the transformation of f under\n\u0012 \u2032\n\u0013\nu \u2212v Cp\n\u22121\nM1 =\n.\nu\nvA\np\n\n\f11\n\nGeneralised Weber Functions\ne\u03b8\nRewriting (3.1), it is given by f \u25e6 M1\u22121 = \u03b624\nf with\n\u0012\n\u0013\u0013\n\u0012\nu\n\u2032 C\n\u20322\n\u2032\n\u03b8 =(N \u2212 1)v u\n+A\n(1 \u2212 u ) \u2212 u\nNp\np\n(5.2)\n3\u03bb(N)(u\u2032 2 \u2212 1)\n\u2032\n+ 3v1 A1 (N1 \u2212 1)(u \u2212 1) +\n.\n2\n\nWe obtain invariance provided e\u03b8 \u2261 0 mod 24. (The treatment of M2\u22121 is\ncompletely analogous and omitted.) In the following, we classify the values\nof D and B for which \u03b8 is 0 modulo some divisor of 24. It is natural to study\nseparately \u03b8 mod 3 and \u03b8 mod 2\u03be for 1 6 \u03be 6 3 depending on the value of\nN. We will give code names to the following propositions for future use.\n\n5.1\n\nThe value of \u03b8 modulo 3\n\nTo be able to use some exponent e not divisible by 3, we need to impose\n3 | \u03b8. From the reduction of (5.2) modulo 3, namely\n\u0012\n\u0013\u0013\n\u0012\nu\n\u2032 C\n\u20322\n\u2032\n\u03b8 = (N \u2212 1)v u\nmod 3,\n+A\n(1 \u2212 u ) \u2212 u\nNp\np\nwe immediately see that 3 | \u03b8 for N \u2261 1 mod 3 without any further condition, which is coherent with 3 \u2224 s in this case.\nFor N 6\u2261 1 (mod 3), we impose B 2 \u2261 D (mod 4N) to obtain divisibility\nof C by N (see the discussion above), and define r \u2208 {0, 1, 2} such that\n(5.3)\n\nA\n\nB2 \u2212 D\nC\n=\n\u2261r\nN\n4N\n\nNotice that r = 1 implies A \u2261\n(mod 3).\n5.1.1\n\nC\nN\n\n(mod 3).\n\nC\n(mod 3), while r = 2 implies A \u2261 \u2212 N\n\nThe case N \u2261 0 mod 3\n\nProposition 5.1 (PROP30). Let N \u2261 0 (mod 3), B 2 \u2261 D (mod 4N) and\nr as in (5.3). Then 3 | \u03b8 if\n(a) 3 | D and r = 1;\n(b) D \u2261 1 (mod 3) and r = 2.\nIn these cases, B satisfies the following congruences modulo 3:\n(a) 3 | B;\n(b) 3 \u2224 B.\nProof. Since 3 | N | C and 3 \u2224 p, u2 \u2261 u\u2032 2 \u2261 1 (mod 3) by (5.1) and\n\u0012\n\u0013\nC\n\u03b8 \u2261 \u00b1v\n\u2212 A mod 3.\nNp\n\n\f12\n\nA. Enge and F. Morain\n\n(a) If 3 | B, or equivalently 3 | D, then p \u2261 u2 \u2261 1 (mod 3) in (5.1). The\ndesired result follows from (5.3).\n(b) If 3 \u2224 B, which is equivalent with D \u2261 1 (mod 3), only the case 3 \u2224 v\nneeds to be examined. Then u 6\u2261 u\u2032 (mod 3) and p \u2261 2 (mod 3), and\nagain (5.3) allows to conclude.\n\n5.1.2\n\nThe case N \u2261 2 mod 3\n\nProposition 5.2 (PROP32). Let N \u2261 2 (mod 3), B 2 \u2261 D (mod 4N) and\nr \u2208 {1, 2} as in (5.3). If D \u2261 r (mod 3), then 3 | \u03b8 and 3 | B.\nProof. Notice that D \u2261 r (mod 3) is equivalent with 3 | B by (5.3). Then\nu\u2032 \u2261 u (mod 3) and\n\u0013\n\u0012\nA\nC\n2\n+ (1 \u2212 u ) \u2212 A\n(mod 3).\n\u03b8 \u2261 uv\nNp\np\n\nIf 3 divides u or v, we are done.\nOtherwise, u2 \u2261 v 2 \u2261 1 (mod 3), which implies\n\u0012\n\u0013\nC\n\u03b8\u2261\u00b1\n\u2212A\n(mod 3).\nNp\n\nWriting p \u2261 1+AC \u2261 1\u2212r (mod 3), we see that this case is possible only for\nC\n(mod 3) and 3 | NCp \u2212 A.\nr = 2 and p \u2261 2 (mod 3), and then A \u2261 \u2212 N\nNote that the proposition does not hold for r = 0, since then 3 | D,\n3 | B, 3 | AC, and exactly one of A and C is divisible by 3 (if both were,\nthen [A, B, C] would not be primitive), causing \u03b8 6\u2261 0 mod 3 unless one of\nu or v is divisible by 3.\n\n5.2\n5.2.1\n\nThe value of \u03b8 modulo powers of 2\nThe case N odd\n\nSince N1 = N and \u03bb(N) = 0, (5.2) becomes\n\u03b8 \u2261 (N \u2212 1)\u03c1\nfor\n\n(mod 8)\n\n\u0012\n\u0013\u0013\n\u0012\nu\n\u2032 C\n\u20322\n\u2032\n\u03c1=v u\n+ 3v1 A1 (u\u2032 \u2212 1).\n+A\n(1 \u2212 u ) \u2212 u\nNp\np\nSo \u03b8 is divisible by 8 if N \u2261 1 (mod 8), which is the case in particular if\nN is a square. Otherwise, e is supposed to be even, so e\u03b8 is divisible by 4;\nif N \u2261 1 (mod 4), e\u03b8 is even divisible by 8. So the only remaining case of\ninterest is N \u2261 3 (mod 4); then for e \u2261 2 (mod 4), 8 | e\u03b8 is equivalent with\n\u03c1 even. We have\n\u0001\n\u03c1 \u2261 v u\u2032 C + A(u(1 + u\u2032 ) + u\u2032 ) + u\u2032 + 1 mod 2.\n\n\f13\n\nGeneralised Weber Functions\n\nProposition 5.3 (PROP21). Let N be odd. If D is odd, then \u03b8 \u2261 (N \u2212 1)\u03c1\n(mod 8) with \u03c1 even.\nProof. Since B is odd, u\u2032 \u2261 u + v (mod 2).\nIf one of v, A and C is even, then u and u\u2032 are odd by (5.1) (so that in\nfact v is even), and \u03c1 is even.\nOtherwise, v, A and C are odd, u\u2032 = u + 1 (mod 2) and \u03c1 is even as\nwell.\n5.2.2\n\nThe case N even\n\nLet N = 2\u03bb(N ) N1 with N1 odd and \u03bb(N) > 1. We study divisibility of \u03b8 by\n2\u03be for increasing values of \u03be. The value \u03be = 3 is of interest only when e is\nodd, in which case N and thus N1 are squares. We start with an elementary\nremark.\nLemma 5.4. If 2 | N | C, then\n(a) u and u\u2032 are odd and\n(5.4)\n\n\u03b8 \u2261 (N \u2212 1)vu\n\n\u2032\n\n\u0012\n\n\u0013\nC\n\u2212A\nNp\n\n(mod 4);\n\n(b) moreover, if 4 | C, then 2 | vB.\n\nProof. (a) u and u\u2032 are odd by (5.1), so that u\u2032 2 \u2261 1 (mod 8). Since N1\nis odd, almost all terms disappear from (5.2).\n(b) We have p = u2 + v(\u2212uB + vAC) \u2261 u(u \u2212 vB) mod 4. Since u is odd\nby (a), we deduce that vB must be even.\nAs discussed above, N | C is equivalent with B 2 \u2261 D (mod 4N). Then\n2 \u2212D\nC\nAN\n= B4N\n; by gradually imposing more restrictions modulo powers of 2\nC\ntimes 4N, we fix A N\nmodulo powers of 2.\nProposition 5.5 (PROP20). When N is even, \u03b8 is even in the following\ncases:\n(a) B 2 \u2261 D + 4N (mod 8N);\n(b) B 2 \u2261 D (mod 8N) and D \u2261 1 (mod 8).\nProof. (a) The conditions imply that A(C/N) is odd, and Lemma 5.4(a)\nallows to conclude since p is odd.\n(b) In that case A(C/N) is even. Since A is prime to N, it is odd and\ntherefore C/N is even, which implies in turn 4 | C. By Lemma 5.4(b),\nwe get 2 | vB. Since D is odd, B is odd and v is even, and (5.4) finishes\nthe proof.\n\n\f14\n\nA. Enge and F. Morain\n\nDivisibility of \u03b8 by 4\nWe begin with a purely arithmetical lemma that will give us necessary\nconditions on the parameters for the equation B 2 \u2261 D + r(4N) mod (16N)\nto have a solution.\nLemma 5.6. Let r \u2208 {0, 1, 2, 3} and N be even. Given D, suppose the\nequation B 2 \u2261 D + 4rN (mod 16N) admits a solution in B. Then either\nD \u2261 1 mod 8 which implies B is odd, or D is even and D satisfies one of\nthe conditions of the following table depending on rN mod 8, which in turn\ngives properties of B.\nrN mod 8 condition on D \u21d2 D/4 mod 8\nB/2\n0\n4 mod 32\n1\nodd\n16 | D\n0\neven\n2\n24 mod 32\n6\n0 mod 4\n28 mod 32\n7\nodd\n8 mod 32\n2\n2 mod 4\n4\n16 | D\n0\neven\n20 mod 32\n5\nodd\n6\n8 || D\n0\n0 mod 4\n12 mod 32\n3\nodd\nProof. Since B 2 \u2261 D mod 8, the only possible value for odd D is D \u2261\n1 mod 8, giving B odd. If D is even, then\n\u0012\n\nB\n2\n\n\u00132\n\n\u2261\n\nD\n+ rN mod 8\n4\n\nand since N is even, the above table makes sense.\nRemembering that the only squares modulo 8 are {0, 1, 4}, the table is\neasily constructed and left as an exercise to the reader.\nNow, we are ready to extend the result of Proposition 5.5 by considering\nC\nB 2 \u2261 D+r(4N) (mod 16N) with r \u2208 {1, 3}, which yields A N\n\u2261 r (mod 4).\nNote that case (b) cannot be extended and we leave the proof of this to the\nreader.\nProposition 5.7 (PROP44). Let N be even, and suppose B 2 \u2261 D + 4N\n(mod 16N) has a solution. Then \u03b8 is divisible by 4 if one of the following\nconditions is met:\n(a) D \u2261 1 (mod 8);\n(b) 16 | D;\n(c) 2 || N and 4 || D.\n\n\fGeneralised Weber Functions\n\n15\n\nProof. If D is odd, the condition follows from Lemma 5.6. Then u\u2032 = u\u2212vB\nleads to 2 | v and 4 | \u03b8.\nAssuming D even, Theorem 4.2 implies that \u03c74 (p) = 1 (or, equivalently,\np \u2261 1 (mod 4)) when D/4 mod 8 \u2208 {3, 4, 7, 0}, which immediately settles\ncase (b). When D/4 is odd, we see that we cannot have the case 4 | N when\ncomparing with the table of Lemma 5.6, and this gives us (c).\nIn the other cases, when p \u2261 3 mod 4, we get v odd since AC \u2261 2 mod 4\nand there is no reason to have \u03b8 \u2261 0 mod 4.\nProposition 5.8 (PROP412). Let N be even, and suppose B 2 \u2261 D + 12N\n(mod 16N). Then \u03b8 is divisible by 4 if one of the following conditions is\nmet:\n(a) D \u2261 1 (mod 8);\n(b) 8 || D and 2 || N;\n(c) 4 || D and 4 | N.\nIn the cases of D even, B satisfies the following congruences modulo 4:\n(b) 4 | B;\n(c) 2 || B.\nProof. The proof for D odd as well as the case distinctions for D even are\nC\nthe same as in Proposition 5.7. However, we now have A N\n\u2261 \u22121 (mod 4).\nIn the cases where \u03c74 (p) = 1 (i.e., D/4 \u2208 {3, 4, 7, 0}), we get p \u2261 1\n(mod 4) and NCp \u2212 A \u2261 2 (mod 4). Since there is no compelling reason why\nv should be even, \u03b8 may or may not be divisible by 4.\nSo we have to turn our attention to the four other cases, i.e., D/4 \u2208\n{1, 2, 5, 6}, with Lemma 5.6 in mind. If 4 | B, 8 || D and 2 || N, then 2 || C,\nand either v is even or p \u2261 3 (mod 4). In both cases, Lemma 5.4 shows that\n4 | \u03b8. If 2 || B and 4 || D, suppose that furthermore 4 | N. Then 4 | AC,\nand again v is even or p \u2261 3 (mod 4).\n\nDivisibility of \u03b8 by 8\nAs discussed at the beginning of \u00a75.2.1, for generating class fields we are only\ninterested in \u03b8 mod 8 when N is a square, that is, \u03bb(N) is even and N1 is a\nsquare; in particular, N1 \u2261 1 (mod 8). Then the following generalisation of\nLemma 5.4 is immediately seen to hold:\nLemma 5.9. If N is an even square dividing C, then\n\u0013\n\u0012\nC\n\u2032\n\u2212A\n(mod 8).\n\u03b8 \u2261 (N \u2212 1)vu\nNp\n\n\f16\n\nA. Enge and F. Morain\n\nFrom the results obtained for B 2 \u2261 D + 4rN (mod 16N) for r \u2208 {1, 3},\nit is natural to look at B 2 \u2261 D + 4rN (mod 32N) for r \u2208 {1, 3, 5, 7}. Then\nC\n\u2261 r (mod 8).\nAN\nProposition 5.10 (PROP8). Let N be an even square, and suppose B 2 \u2261\nD + 4rN (mod 32N). Then \u03b8 is divisible by 8 if one of the following conditions holds:\n(a) r = 3 or r = 7, and D \u2261 1 (mod 8);\n(b) r = 1, and 32 | D;\n(c) r = 5, and 16 || D.\nIn the cases of D even, B satisfies the following congruences modulo 8:\n(b1) 4 || B if 4 || N;\n(b2) 8 | B if 16 | N.\n(c1) 4 || B if 16 | N;\n(c2) 8 | B if 4 || N.\nProof. Since 4 | N | C, we have p \u2261 u(u \u2212 vB) (mod 4) by (5.1).\nFor D odd, B is odd and v is even as seen in Proposition 5.7. If v is\ndivisible by 4, then \u03b8 is divisible by 8 by Lemma 5.9. If 2 || v, then p \u2261 3\n(mod 4); if furthermore r \u2261 3 (mod 4), then 4 | NCp \u2212 A, and 8 | \u03b8 by\nLemma 5.9.\nIn the remaining cases of the proposition, 16 | D, 4 | B, r \u2261 1 (mod 4)\nand p \u2261 1 (mod 4). If v is even, Lemma 5.9 implies that 8 | \u03b8. From now\non, we assume that v is odd. Then p = u2 \u2212 uvB + AC (mod 8), and we\nneed to verify that 8 | NCp \u2212 A.\nThe results now follow from close inspection of\nAC \u2261 rN\n\n\u0012 \u00132\nN\nB\nD\n(mod 8) and\n+r\n\u2261\n4\n16\n4\n\n(mod 8).\n\nConsider first the case r = 1 and 32 | D. By Theorem 4.2, we have\n\u03c74 (p) = \u03c78 (p) = 1, which yields p \u2261 1 mod 8 and implies the desired\ndivisibility of NCp \u2212 A by 8.\nConsider now r = 5; it is sufficient to show that p \u2261 5 (mod 8). If 16 || D\nand 16 | N | C, then B \u2261 4 (mod 8) and p \u2261 5 (mod 8). If 16 || D and\n4 || N, then AC \u2261 4 (mod 8) and 32 | D + 4rN, whence 8 | B and p \u2261 5\n(mod 8).\n\n\fGeneralised Weber Functions\n\n6\n\n17\n\nLower powers of wN\n\nThe aim of this section is to determine conditions under which singular\nvalues of lower powers of wN than those given in Theorem 4.3 yield class\ninvariants. When N is not a square, only even powers are possible by Theorems 3.2 and 2.3. So we specialise the propositions of \u00a75 according to the\nvalue of N (mod 12). When N is a square, odd powers may yield class invariants, and we need to distinguish more finely modulo 24. Note that then\nN \u2208 {0, 1, 4, 9, 12, 16} (mod 24).\nThroughout this section, we use the notation of Theorem 4.3. The number \u03b1 is a root of the quadratic form [A, B, C] of discriminant D and N is\nan integer such that A is prime to N and B is a square root of D modulo 4N according to Lemma 4.1, so that N | C. The canonical power s\nsuch that wsN (\u03b1) is a class invariant, that is, wsN (\u03b1) \u2208 KD , is defined as in\nTheorem 4.3, and we wish to determine the minimal exponent e such that\nweN (\u03b1) is still a class invariant. The general procedure is as follows: Given\nthe value of N, we assemble the propositions of \u00a75 (using their code names\nthroughout) and deduce from them conditions on B as well as the period\nof D for which class invariants are obtained. In general, we can combine a\ncondition on B related to \u03b8 mod 3 and another one related to \u03b8 mod 2\u03be . The\nChinese remainder theorem is then used to find compatible values. When\nno particular condition modulo 3 or powers of 2 is imposed, that is, e and\ns have the same 3-adic or 2-adic valuation, then Theorem 4.3 already leads\nto the desired conclusion.\nOnce a power weN (\u03b1) is identified as a class invariant, its conjugates may\nbe obtained by an M-system for M = es N containing [A, B, C] as shown\nthrough Theorems 2.4 and 3.2. In more detail, one may proceed as follows:\n1. Determine a form [A, B, C] with root \u03b1 satisfying gcd(A, M) = 1 and\nthe constraint on B so that weN (\u03b1) is a class invariant; in general, one\nmay choose A = 1.\n2. Enumerate all reduced forms [ai , bi , ci ], i = 1, . . . , h(D) of discriminant\nD, numbered in such a way that [a1 , b1 , c1 ] \u2261 [A, B, C].\n3. Let [A1 , B1 , C1 ] = [A, B, C]. For i > 2, find a form [Ai , Bi , Ci ] \u2261\n[ai , bi , ci ] such that gcd(Ai , M) = 1 and Bi \u2261 B (mod 2M), using, for\ninstance, the algorithm of [22, Prop. 3], [24, Th. 3.1.10].\nThen a floating point approximation of the class polynomial can be computed as\nhD\nY\n\u0001\nX \u2212 weN (\u03b1i )\ni=1\n\n\u221a\n\ni+ D\nwith \u03b1i = \u2212B2A\n. Using the algorithms of [11], one obtains a quasi-linear\ni\ncomplexity in the total size of the class polynomial.\n\n\f18\n\nA. Enge and F. Morain\n\nNote that the conditions on B of \u00a75 can be summarised as B 2 \u2261 D +4rN\n(mod 4RN), where r is defined modulo R and the only primes dividing R\nare 2 and 3. For the sake of brevity, we denote such a condition by r:R.\nSo if no particular condition beyond B 2 \u2261 D (mod 4N) is required, this is\ndenoted by 0:1.\nWe will give more details for the first non-trivial cases and be briefer\nin the sequel, since the results rapidly become unweildy. We add numerical\nexamples for these cases.\n\n6.1\n6.1.1\n\nThe case N odd\nN 6\u2261 0 mod 3\n\nThis is the simplest case. We may use PROP32, PROP21 or both of them.\nWhenever N \u2261 2 (mod 3) and 3 \u2224 D, then PROP32 applies; moreover, the\nresulting condition 3 | B is automatically satisfied, and we gain a factor of\n3 in the exponent. Similarly if D is odd, then PROP21 applies without any\nrestriction on B, and we gain a factor of 2 in the exponent.\nN mod 12\n5\n5\n7\n11\n11\n11\n11\n11\n\ns\n6\n6\n4\n12\n12\n12\n12\n12\n\nB\n1:3\n2:3\n0:1\n0:1\n1:3\n2:3\n1:3\n2:3\n\nD\ne proposition(s)\nD \u2261 1 mod 3 2 PROP32\nD \u2261 2 mod 3 2 PROP32\n2\u2224D\n2 PROP21\n2\u2224D\n6 PROP21\nD \u2261 1 mod 3 4 PROP32\nD \u2261 2 mod 3 4 PROP32\nD \u2261 1 mod 6 2 PROP32+PROP21\nD \u2261 5 mod 6 2 PROP32+PROP21\np\n\u221a\nLetting D = c2 \u2206, we put \u03c9 = \u2206/4 if 4 | \u2206 and \u03c9 = (1+ \u2206)/2 otherwise.\nHere are some numerical examples:\nN f \u2212D HD [f ]\n5 w25\n11 X \u2212 \u03c9 \u2212 1\n5 w25\n4 X \u22121\u2212 2\u03c9\n2\n7 w7\n3 X \u22123\u03c9 +1\n6\n11 w11\n39 X 4 + (27 \u03c9 \u2212 73) X 3 + (1656 \u03c9 \u2212 8914) X 2\n+ (7947 \u03c9 \u2212 139058) X \u2212 515016 \u03c9 + 1000693\n4\n11 w11\n8 X +7+6\u03c9\n11 w411\n28 X + 8 \u03c9 \u2212 7\n11 w211\n11 X \u2212 2 \u03c9 + 1\n2\n11 w11\n7 X \u22122\u03c9 +3\n6.1.2\n\nThe case N \u2261 3 (mod 12)\n\nThe situation becomes more intricate when gcd(N, 6) 6= 1. For N \u2261 3\n(mod 12), we have s = 12, and N cannot be a square. Therefore we need\n\n\f19\n\nGeneralised Weber Functions\n\nan even exponent e. Since already the full power w12\nN can only be used\nwhen D is a square modulo 4N, we only have to consider D \u2208 {0, 1, 4, 9}\n(mod 12). Then PROP30 applies; moreover, PROP21 applies whenever D\nis odd, resulting in the following table.\nN mod 12\n3\n3\n3\n3\n3\n\ns\n12\n12\n12\n12\n12\n\nB\n0:1\n1:3\n2:3\n1:3\n2:3\n\nD mod 12\n1, 9\n0, 9\n1, 4\n9\n1\n\ne\n6\n4\n4\n2\n2\n\npropositions(s)\nPROP21\nPROP30(a)\nPROP30(b)\nPROP30(a)+PROP21\nPROP30(b)+PROP21\n\nThe entries in the first and last line for D \u2261 1 (mod 12) may seem\nredundant; but note that they induce differently severe restrictions on B.\nThe entry D \u2261 1 (mod 12) in the third line, as well as D \u2261 9 (mod 12)\nin the second line, are redundant, however: Since PROP21 does not induce\nany additional restriction on B, the lower exponent is available for precisely\nthe same quadratic forms. In the following, we will present only tables that\nhave been reduced accordingly.\nHowever, the previous table does not yet contain the full truth. A line\nin the table means that if there is a solution to B 2 \u2261 D + 4rN (mod 4RN)\nwith D in the given residue class D0 modulo 12, then weN yields a class\ninvariant. Examining this equation modulo the part of 4RN that contains\nonly 2 and 3 yields further restrictions. Write N = N6 N \u2032 such that the\nonly primes dividing N6 are 2 and 3 and gcd(N \u2032 , 6) = 1. Then we need to\nensure that D + 4rN \u2261 D is a square modulo N \u2032 ; this is guaranteed by\nLemma 4.1, since otherwise we would not even consider the full power wsN .\nWe furthermore need to examine under which conditions\nD + 4N6 rN \u2032 is a square modulo 4RN6 and D \u2261 D0\n\n(mod 12).\n\nConcerning the second to last line, for instance, the condition becomes\nD + 12\n\nN\nis a square modulo 36 and D \u2261 9\n3\n\n(mod 12).\n\nThus, D + 12 N3 \u2261 9 (mod 36), and depending on N3 mod 3, only one value\nof D (mod 36) remains.\nFor N = 3, for instance, or more generally N3 \u2261 1 (mod 3), we obtain\nthe following class invariants.\nB\n0:1\n0:1\n1:3\n2:3\n1:3\n2:3\n\nD mod 36\ne\n0, 12\n12\n9, 21\n6\n24\n4\n4, 16, 28\n4\n33\n2\n1, 13, 25\n2\n\n\f20\n\nA. Enge and F. Morain\n\nTo illustrate this, we give the following table of examples:\nN f \u2212D HD [f ]\n3 w12\n24 X 2 \u2212 162 X + 729\n3\n3 w63\n15 X 2 \u2212 3 (2 \u03c9 \u2212 1) X \u2212 27\n3 w43\n12 X \u2212 3\n3 w43\n8 X \u2212 1\u22122\u03c9\n2\n3 w3\n3 X \u2212\u03c9\u22121\n3 w23\n11 X \u2212 \u03c9\n6.1.3\n\nThe case N \u2261 9 mod 12\n\nWe have s = 3 for squares in that family (for instance, N = 32n ) and may\nthen reach wN . Otherwise, s = 6, and the only possible smaller exponent is\n2.\n9 mod 12,\n9 mod 12,\n9 mod 12,\n9 mod 12,\n\nN\n6= \u0003\n6= \u0003\n=\u0003\n=\u0003\n\ns\n6\n6\n3\n3\n\nB\n1:3\n2:3\n1:3\n2:3\n\nD\n0 mod 3\n1 mod 3\n0 mod 3\n1 mod 3\n\ne\n2\n2\n1\n1\n\npropositions(s)\nPROP30a\nPROP30b\nPROP30a\nPROP30b\n\nWe give two examples, one for N = 21, the second for N = 9. For the\nformer, we find\nB\n0:1\n1:3\n2:3\n\nD mod 252\ne\n0, 9, 21, 36, 57, 72, 81, 84, 93, 120, 144, 156, 165, 189, 225, 228 6\n60, 105, 141, 168, 177, 204, 240, 249\n2\n1, 4, 16, 25, 28, 37, 49, 64, 85, 88, 100, 109, 112, 121, 133, 148, 2\n169, 172, 184, 193, 196, 205, 217, 232\nN f \u2212D HD [f ]\n21 w621\n24 X 2 + (108 + 102 \u03c9) X \u2212 6345 + 2754 \u03c9\n21 w221\n3 X +\u03c9+4\n2\n21 w21\n20 X 2 + (\u22122 + 4 \u03c9) X \u2212 19 \u2212 4 \u03c9\n\nFor N = 9, we get:\n\nB\n0:1\n1:3\n2:3\n\nD mod 108\n9, 36\n0, 45, 72, 81\n1, 4, 13, 16, 25, 28, 37, 40, 49, 52,\n61, 64, 73, 76, 85, 88, 97, 100\nN f \u2212D HD [f ]\n9 w39\n72 X 2 \u2212 18 X + 27\n9 w9\n27 X \u2212 \u03c9 \u2212 1\n9 w9\n8 X \u22121\u2212\u03c9\n\ne\n3\n1\n1\n\n\f21\n\nGeneralised Weber Functions\n\nThe case N even\n\n6.2\n\nA look at \u00a75 immediately shows the complexity of the results when N is\neven. We distinguish the cases \u03bb = 1 (in which N cannot be a square) and\n\u03bb > 2 with N a square or not.\n6.2.1\n\nThe case \u03bb = 1\n\nThree values are concerned, namely N mod 12 \u2208 {2, 6, 10}. We have s = 24\nfor N mod 12 \u2208 {2, 6}, whereas s = 8 for N \u2261 10 (mod 12).\nN mod 12\n\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n10\n10\n10\n10\n\ns\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n8\n8\n8\n8\n\nB\n1:2\n0:2\n1:3\n2:3\n1:4\n3:4\n1:2\u22291:3\n1:2\u22292:3\n0:2\u22291:3\n0:2\u22292:3\n1:4\u22291:3\n1:4\u22292:3\n3:4\u22291:3\n3:4\u22292:3\n1:2\n0:2\n1:3\n2:3\n1:4\n3:4\n1:2\u22291:3\n1:2\u22292:3\n0:2\u22291:3\n0:2\u22292:3\n1:4\u22291:3\n1:4\u22292:3\n3:4\u22291:3\n3:4\u22292:3\n1:2\n0:2\n1:4\n3:4\n\nD\n-\n1 mod 8\n1 mod 3\n2 mod 3\n1, 4 mod 8; 0 mod 16\n1 mod 8; 8 mod 16\n1 mod 3\n2 mod 3\n1 mod 24\n17 mod 24\n1, 4 mod 24; 16 mod 48\n17, 20 mod 24; 32 mod 48\n1 mod 24; 40 mod 48\n17 mod 24; 8 mod 48\n-\n1 mod 8\n0 mod 3\n1 mod 3\n1, 4 mod 8; 0 mod 16\n1 mod 8; 8 mod 16\n0 mod 3\n1 mod 3\n9 mod 24\n1 mod 24\n9, 12 mod 24; 0 mod 48\n1, 4 mod 24; 16 mod 48\n9 mod 24; 24 mod 48\n1 mod 24; 40 mod 48\n-\n1 mod 8\n1, 4 mod 8; 0 mod 16\n1 mod 8; 8 mod 16\n\ne\n12\n12\n8\n8\n6\n6\n4\n4\n4\n4\n2\n2\n2\n2\n12\n12\n8\n8\n6\n6\n4\n4\n4\n4\n2\n2\n2\n2\n4\n4\n2\n2\n\nproposition(s)\nPROP20a\nPROP20b\nPROP32\nPROP32\nPROP44\nPROP412ab\nPROP20a+PROP32\nPROP20a+PROP32\nPROP20b+PROP32\nPROP20b+PROP32\nPROP44+PROP32\nPROP44+PROP32\nPROP412ab+PROP32\nPROP412ab+PROP32\nPROP20a\nPROP20b\nPROP30a\nPROP30b\nPROP44\nPROP412ab\nPROP20a+PROP30a\nPROP20a+PROP30b\nPROP20b+PROP30a\nPROP20b+PROP30b\nPROP44+PROP30a\nPROP44+PROP30b\nPROP412ab+PROP30a\nPROP412ab+PROP30b\nPROP20a\nPROP20b\nPROP44\nPROP412ab\n\nThe case N = 2 corresponds to Weber's classical functions. We present\nthe case N = 6 in more detail, illustrating the complexity of the process.\n\n\f22\n\nA. Enge and F. Morain\nB\n0:1\n1:2\n1:3\n2:3\n3:4\n1:4\n1:4\n1:2\n1:2\n3:4\n1:4\n1:4\n3:4\n1:4\n1:4\n\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\n1:3\n2:3\n1:3\n1:3\n1:3\n2:3\n2:3\n2:3\n\nD mod 288\ne\n0, 36, 96, 132, 144, 180, 240, 276\n24\n60, 252\n12\n48, 84, 192, 228\n8\n4, 16, 52, 64, 100, 112, 148, 160, 196, 208, 244, 256 8\n24, 72, 168, 216\n6\n9, 33, 81, 105, 153, 177, 225, 249\n6\n108, 204\n6\n156\n4\n28, 124, 220\n4\n120, 264\n2\n57, 129, 201, 273\n2\n12\n2\n40, 88, 136, 184, 232, 280\n2\n1, 25, 49, 73, 97, 121, 145, 169, 193, 217, 241, 265\n2\n76, 172, 268\n2\n\nN f \u2212D HD [f ]\n6 w24\n12 X + 186624\n6\n6 w12\n36 X 2 \u2212 3888 \u03c9 X + 1259712\n6\n6 w86\n60 X 2 + (432 \u03c9 \u2212 720) X + 20736\n6 w86\n32 X 2 + (112 + 64 \u03c9) X \u2212 1088 \u2212 3584 \u03c9\n6\n6 w6\n72 X 2 \u2212 216 X \u2212 5832\n6 w66\n39 X 4 + (3 \u03c9 \u2212 42) X 3 + (486 \u03c9 + 108) X 2\n+ (\u2212648 \u03c9 + 9072) X + 6561 \u03c9 \u2212 45198\n6 w66\n84 X 4 + (324 + 60 \u03c9) X 3 + 14688 X 2\n+ (69984 \u2212 12960 \u03c9) X + 46656\n6 w46 132 X 4 + (144 \u2212 12 \u03c9) X 3 + 2196 X 2\n+ (5184 + 432 \u03c9) X + 1296\n4\n6 w6\n68 X 4 + (\u221232 + 4 \u03c9) X 3 + (\u2212204 \u2212 96 \u03c9) X 2\n+ (1152 \u2212 144 \u03c9) X \u2212 752 + 256 \u03c9\n2\n6 w6\n24 X 2 \u2212 \u03c9 X \u2212 6\n2\n6 w6\n15 X 2 + (\u22122 \u03c9 \u2212 2) X + 3 \u03c9 \u2212 3\n6 w26 276 X 8 + (\u221212 \u2212 4 \u03c9) X 7 + (132 + 6 \u03c9) X 6\n\u2212144 X 5 \u2212 576 X 4 \u2212 864 X 3 + (4752 \u2212 216 \u03c9) X 2\n+ (\u22122592 + 864 \u03c9) X + 1296\n2\n6 w6\n8 X +2+\u03c9\n2\n6 w6\n23 X 3 \u2212 6 X 2 + (\u2212\u03c9 + 15) X + \u03c9 \u2212 15\n6 w26\n20 X 2 + (2 \u2212 2 \u03c9) X \u2212 4 \u2212 2 \u03c9\n6.2.2\n\nThe case \u03bb > 2\n\nWe have to study three values of N mod 12, namely, 0, 4 and 8, for which\ns = 24, 8, and 24, respectively. The cases N \u2261 0 or 4 authorise squares, so\nthat the results become somewhat lengthy.\n\n\f23\n\nGeneralised Weber Functions\nWhen N \u2261 4 mod 12, we find\n\nN\n4 mod 12\n4 mod 12\n4 mod 12\n4 mod 12\n4 mod 12\n4 mod 12\n4 mod 12, = \u0003\n4 mod 12, = \u0003\n4 mod 12, = \u0003\n4 mod 12, = \u0003\n\ns\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n\nB\n1:2\n1:2\n1:4\n1:4\n3:4\n3:4\n3:8\n7:8\n1:8\n5:8\n\nD\n-\n1 mod 8\n1 mod 8\n0 mod 16\n1 mod 8\n4 mod 8\n1 mod 8\n1 mod 8\n0 mod 32\n16 mod 32\n\ne\n4\n4\n2\n2\n2\n2\n1\n1\n1\n1\n\nproposition(s)\nPROP20a\nPROP20b\nPROP44a\nPROP44b\nPROP412a\nPROP412c\nPROP8a\nPROP8a\nPROP8b\nPROP8c\n\nWhen N \u2261 8 mod 12, it cannot be a square, and the results are:\n\nN mod 12\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n\ns\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n\nB\n1:2\n1:2\n1:4\n1:4\n3:4\n3:4\n1:3\n2:3\n1:2\n1:2\n1:2\n1:2\n1:4\n1:4\n1:4\n1:4\n3:4\n3:4\n3:4\n3:4\n\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n\nD\n-\n1 mod 8\n1 mod 8\n0 mod 16\n1 mod 8\n4 mod 8\n1 mod 3\n2 mod 3\n1 mod 3\n2 mod 3\n1 mod 24\n17 mod 24\n1 mod 24\n17 mod 24\n16 mod 48\n32 mod 48\n1 mod 24\n17 mod 24\n4 mod 24\n20 mod 24\n\ne\n12\n12\n6\n6\n6\n6\n8\n8\n4\n4\n4\n4\n2\n2\n2\n2\n2\n2\n2\n2\n\nproposition(s)\nPROP20a\nPROP20b\nPROP44a\nPROP44b\nPROP412a\nPROP412c\nPROP32\nPROP32\nPROP20a+PROP32\nPROP20a+PROP32\nPROP20b+PROP32\nPROP20b+PROP32\nPROP44a+PROP32\nPROP44a+PROP32\nPROP44b+PROP32\nPROP44b+PROP32\nPROP412a+PROP32\nPROP412a+PROP32\nPROP412c+PROP32\nPROP412c+PROP32\n\nFinally, for N \u2261 0 mod 12, we obtain the following results:\n\n\f24\n\nA. Enge and F. Morain\nN\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n12\n\ns\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n24\n\nB\n1:2\n1:2\n1:4\n1:4\n3:4\n3:4\n1:3\n2:3\n1:2\n1:2\n1:2\n1:2\n1:4\n1:4\n1:4\n1:4\n3:4\n3:4\n3:4\n3:4\n3:8\n7:8\n1:8\n5:8\n3:8\n3:8\n7:8\n7:8\n1:8\n1:8\n5:8\n5:8\n\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\u2229\n\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n1:3\n2:3\n\nD\n-\n1 mod 8\n1 mod 8\n0 mod 16\n1 mod 8\n4 mod 8\n0 mod 3\n1 mod 3\n0 mod 3\n1 mod 3\n9 mod 24\n1 mod 24\n9 mod 24\n1 mod 24\n0 mod 48\n16 mod 48\n9 mod 24\n1 mod 24\n12 mod 24\n4 mod 24\n1 mod 8\n1 mod 8\n0 mod 32\n16 mod 32\n9 mod 24\n1 mod 24\n9 mod 24\n1 mod 24\n0 mod 96\n64 mod 96\n48 mod 96\n16 mod 96\n\ne\n12\n12\n6\n6\n6\n6\n8\n8\n4\n4\n4\n4\n2\n2\n2\n2\n2\n2\n2\n2\n3\n3\n3\n3\n1\n1\n1\n1\n1\n1\n1\n1\n\nproposition(s)\nPROP20a\nPROP20b\nPROP44a\nPROP44b\nPROP412a\nPROP412c\nPROP30a\nPROP30b\nPROP20a+PROP30a\nPROP20a+PROP30b\nPROP20b+PROP30a\nPROP20b+PROP30b\nPROP44a+PROP30a\nPROP44a+PROP30b\nPROP44b+PROP30a\nPROP44b+PROP30b\nPROP412a+PROP30a\nPROP412a+PROP30b\nPROP412c+PROP30a\nPROP412c+PROP30b\nPROP8a\nPROP8a\nPROP8b\nPROP8c\nPROP8a+PROP30a\nPROP8a+PROP30b\nPROP8a+PROP30a\nPROP8a+PROP30b\nPROP8b+PROP30a\nPROP8b+PROP30b\nPROP8c+PROP30a\nPROP8c+PROP30b\n\nFor N = 4, these results translate as follows:\n\nB\n0:1\n1:2\n3:4\n1:4\n3:8\n1:8\n5:8\n\nD mod 128\n\u2261 4 (mod 32)\n16, 32, 80, 96\n\u2261 20 (mod 32)\n64\n\u2261 1 (mod 8)\n0\n\u2261 48 (mod 64)\n\ne\n8\n4\n2\n2\n1\n1\n1\n\n\f25\n\nGeneralised Weber Functions\n\nN\n4\n4\n4\n4\n4\n4\n4\n\nf \u2212D HD [f ]\nw84\n28 X \u2212 48 \u03c9 + 32\n4\nw4\n32 X 2 \u2212 8 \u03c9 X \u2212 16\n2\nw4\n12 X \u2212 2 \u03c9\n2\nw4\n64 X 2 + (\u22124 \u2212 4 \u03c9) X + 4 \u03c9\nw4\n7 X \u2212\u03c9\nw4 128 X 4 + (\u22124 \u2212 2 \u03c9) X 3 + 6 \u03c9 X 2 + (8 \u2212 4 \u03c9) X \u2212 4\nw4\n16 X \u2212 1 \u2212 \u03c9\n\nThe precise results for N = 16 are the following:\nB\n0:1\n1:2\n3:4\n1:4\n3:8\n1:8\n5:8\n\nD mod 512\n\u2261 16 (mod 128)\n64, 128, 320, 384\n\u2261 4 (mod 32)\n256\n\u2261 1 (mod 8)\n0, 192, 448\n\u2261 80 (mod 128)\n\ne\n8\n4\n2\n2\n1\n1\n1\n\nN f \u2212D HD [f ]\n16 w816 112 X 2 + (12288 \u03c9 \u2212 8192) X \u2212 196608 \u03c9 \u2212 917504\n16 w416 128 X 4 + (128 + 192 \u03c9) X 3 + 6656 \u03c9 X 2\n+ (\u221232768 + 49152 \u03c9) X \u2212 65536\n2\n16 w16\n28 X + 2 \u03c9 \u2212 4\n16 w216 256 X 4 + (16 \u2212 48 \u03c9) X 3 + (\u2212288 + 288 \u03c9) X 2\n+ (768 \u2212 256 \u03c9) X \u2212 256 \u03c9\n16 w16\n7 X \u2212\u03c9\u22121\n16 w16\n64 X 2 \u2212 4 X + 4\n16 w16\n48 X 2 + 4 X + 4\n\n6.3\n\nReality of class polynomials\n\nThe argumentation of the proof of Theorem 4.4 carries over to the lower\npowers of wN and shows that the class polynomial is real whenever for\nsome form [A, B, C] in the se N-system the inverse form [A, \u2212B, C] satisfies\nthe congruence constraints of the system as well. This is precisely the case\nwhen B is divisible by se N. In particular, this implies that N | D, and\ninspection of the previous results proves the following theorem.\nTheorem 6.1. Under the general assumptions of \u00a76, the characteristic polynomial of weN (\u03b1) is real whenever N | D and se N | B. For e < s, this is\npossible only in the following cases:\n\n\f26\n\nA. Enge and F. Morain\n\n(a) N odd:\nN\ns\n5 mod 12 6\n5 mod 12 6\n11 mod 12 12\n11 mod 12 12\n3 mod 12 12\n9 mod 12, 6= \u0003 6\n9 mod 12, = \u0003 3\n\nB\n1:3\n2:3\n1:3\n2:3\n1:3\n1:3\n1:3\n\nD\n1 mod 3\n2 mod 3\n1 mod 3\n2 mod 3\n6 mod 9\n18 mod 27\n18 mod 27\n\ne\n2\n2\n4\n4\n4\n2\n1\n\n(b) 2 || N and 4 | D\n(b1)\n(b2)\n\ns\ne\ns\ne\n\nis even and 8 || D\n\n=3\n\n(c) 4 | N and 16 | D\nProof. We again start from B 2 \u2261 D+4rN (mod 4RN), where in fact R = es\nis a non-trivial divisor of 24. Then the hypotheses of the theorem translate\nas B = NRB \u2032 and D = ND \u2032 , so that\n(6.1)\n\n2\n\nNR2 B \u2032 \u2261 D \u2032 + 4r\n\n(mod 4R).\n\nThis immediately implies\n(6.2)\n(6.3)\n\nD \u2032 \u2261 \u2212r\n4 | D\u2032\n\n(mod 3)\n\nif 3 | R\nif 2 | R\n\n(a) The assertions are a direct consequence of (6.2) and (6.3), together\nwith the tables in \u00a76.1.\n(b) If N is even, from N | D we immediately have 4 | D.\n\nIf R is even, then moreover (6.3) yields that 8 | D. Going through\nthe table in \u00a76.2.1 shows that then r is odd, and (6.1) implies that\nD \u2032 \u2261 \u22124r \u2261 4 (mod 8) and 8 || D.\n\n(c) If 4 | N, then (6.1) shows that 4 | D \u2032 , whence 16 | D.\n\u221a\nWe\u221aend this section with related\nconcerning the functions D weN .\n\u221a results\nSince D \u2208 O, a singular value D weN (\u03b1) is a class invariant if and only\nif weN (\u03b1) is, and integrality of the class polynomial\ncoefficients carries over.\n\u221a\nIn some cases, however, the additional factor D may lead to rational class\npolynomials.\n\n\f27\n\nGeneralised Weber Functions\nLemma 6.2. Let N 6\u2261 1 (mod 8), \u03b1 = \u2212B+2\ns\nN | B and se N \u2224 B. Then wN (\u03b1)e \u2208 iR.\n2e\n\n\u221a\n\nD\n\nand e be such that\n\ns\ne\n\nis even,\n\nN\u22121\n\nProof. Write wN = f0 f1 , where f0 = q \u2212 24N and f1 is a power series in q 1/N .\nNotice that if N | B, then q 1/N (\u03b1) = e2\u03c0i\u03b1/N \u2208 R. So weN (\u03b1) is real up to\n2\u03c0i s(N\u22121) 2eB\nthe factor f0 (\u03b1)e , which itself is real up to the factor e 4 * 24 * sN . This is\nan odd power of i under the hypotheses of the lemma; N 6\u2261 1 (mod 8) is\nneeded to ensure that s(N24\u22121) is odd.\nLemma 6.3. Let f be a modular function and \u03b1 \u2208 O such that f (\u03b1) is a\nclass invariant and a real number. Then HD [f ] \u2208 Q[X].\nProof. This is a trivial application of Galois theory. The complex conjugate\nf (\u03b1) is a root of HD [f ]. Since f (\u03b1) = f (\u03b1), this implies that HD [f ] is a\nmultiple of the minimal polynomial HD [f ] of f (\u03b1), so both are the same,\nand HD [f ] has coefficients in K \u2229 R = Q.\nCombining the lemmata yields the following result.\nTheorem \u221a\n6.4. Under the general assumptions of \u00a76, the characteristic polynomial of D weN (\u03b1) is real whenever N 6\u2261 1 (mod 8), N | D, se is even,\ns\nN | B and se N \u2224 B.\n2e\nFor instance, we may apply this theorem to the cases N \u2208 {2, 3, 4, 7}, in\nwhich Propositions 5.3 or 5.5 hold:\nN\nD\nB\ne\n2 12 mod 16 \u00b12 12\n24 mod 96 \u00b112 6\n3 9 mod 12 \u00b13 6\n7 21 mod 28 \u00b17 2\n4 0 mod 32 \u00b14 4\nAs numerical examples, we find:\n\u221a\nH\u221272 [ \u221272 w62 ] = X 2 + 720X + 576,\n\u221a\nH\u221251 [w63 ](X) = X 2 + 6 \u221251X \u2212 27,\n\u221a\nH\u221251 [ \u221251 w63 ](X) = X 2 \u2212 306X + 1377.\n\n7\n\nHeights and comparison with other invariants\n\nLet f be a modular function yielding class invariants and \u03a6[f ](F, J) the\nassociated modular polynomial such that \u03a6[f ](f, j) = 0. It is shown in [7]\n\n\f28\n\nA. Enge and F. Morain\n\nthat asymptotically for |D| \u2192 \u221e, the height of the class invariant f (\u03b1) is\nc(f ) times the height of j(\u03b1), where\n(7.1)\n\nc(f ) =\n\ndegJ (\u03a6[f ])\ndegF (\u03a6[f ])\n\ndepends only on f . It is then clear that c(f r ) = rc(f ) for rational r. So\nto obtain c(weN ), it is sufficient to determine the degrees of the modular\npolynomials of the full power wsN , where s is as defined in Theorem 4.3.\n\n7.1\n\nModular polynomials for wsN\n\nSince wsN is modular for \u03930 (N) by Theorem 3.2, we have\nY\n\u03a6cN := \u03a6[wsN ] =\n(F \u2212 wsN \u25e6 M).\nM \u2208\u03930 (N )\\\u0393\n\n\u0010\n\u0011\nQ\nSo degF \u03a6cN = \u03c8(N) = N p prime, p|N 1 + p1 . The degree in J is obtained\nby examining the q-developments of the conjugates wsN \u25e6 M of wsN .\nProposition 7.1 (Oesterl\u00e9). The cosets of \u03930 (N)\\\u0393 can be split into the\nfollowing three families:\n\u0013\n\u0012\n1 \u03bd\n\u03bd\n, 0 6 \u03bd < N,\nT =\n0 1\n\u0012\n\u0013\n0 \u22121\nS=\n,\n1 0\n\u0013\n\u0012\nk kk \u2032 \u2212 1\nMk,k\u2032 =\n1\nk\u2032\n\nwith 1 < k < N, gcd(k, N) > 1 and 0 6 k \u2032 < \u03bc(k) where \u03bc(k) is the\nsmallest integer for which gcd(\u03bc(k)k \u2212 1, N) = 1.\nUsing (3.2), we find\nProposition 7.2.\n(wsN \u25e6 T )(z) = wN (z + \u03bd)s , 0 6 \u03bd < N,\n\u0013\n\u0012\n\u221a \u03b7(Nz) s\ns\nN\n,\n(wN \u25e6 S)(z) =\n\u03b7(z)\n\u0011 \uf8f6s\n\u0010\n\uf8eb\n\u03b4k z+ck,k\u2032\n\u03b7\np\nN/\u03b4k\n\uf8f8 ,\n(wsN \u25e6 Mk,k\u2032 )(z) = \uf8ed\u03b6k,k\u2032 \u03b4k\n\u03b7(z)\n\nwhere \u03b4k = gcd(k, N), \u03b6k,k\u2032 is a 24-th root of unity and ck,k\u2032 is a rational\ninteger.\n\n\f29\n\nGeneralised Weber Functions\n\nThe proposition shows in particular that all conjugates of wsN have integral and that wsN and wsN \u25e6 S have rational q-expansions. The q-expansion\nprinciple now implies that \u03a6cN \u2208 Z[F, J], cf. [6, \u00a73]\nTheorem 7.3.\ndegJ \u03a6cN =\n\ns\n(N \u2212 1 + S(N))\n24\n\nwhere\n(7.2)\n\nS(N) =\n\nX\n\n\u03bc(k)\n\u221a\n\nk:1<k<N,1<\u03b4k =gcd(k,N )< N\n\n\u0012\n\n\u03b42\n1\u2212 k\nN\n\n\u0013\n\n.\n\nProof. Consider \u03a6cN as a polynomial in F with coefficients in Z[J]. Following\nthe same reasoning as in [9], we see that the coefficient of highest degree in J\nis obtained when all conjugates are multiplied together whose q-expansions\nhave strictly negative order; since the q-expansion of j starts with q \u22121 , the\ndegree in J is then the opposite of this order. The wN (z + \u03bd)s have negative\n\u22121)\ns\norder \u2212 s(N\nand contribute a total of \u2212 s(N24\u22121) . The function w\u0010\nN \u25e6 S has\n24N\n\u0011\npositive order. The conjugates coming from Mk,k\u2032 have order\n\u221a\nwhich is negative whenever \u03b4k < N .\n\ns\n24\n\n\u03b4k2\nN\n\n\u22121 ,\n\nLet us note a list of useful corollaries.\nProposition 7.4. When N = ln for a prime l and n > 1, then\n\u001a m\n(l \u2212 1)2\nif n = 2m + 1,\nS(N) =\nm\nm+1\n(l \u2212 1)(l\n\u2212 1) if n = 2m + 2.\n\nProof. The k occurring in (7.2) are the (k1 + lk2 )lr with 1 6 k1 < l,\n1 6 r 6 m and 0 6 k2 < ln\u2212r\u22121 (so that k < N); they yield \u03b4k = lr and\n\u03bc(k) = 1. Hence,\nS(N) =\n\nm\nX\nr=1\n\n\u0001\n\u0001\n(l \u2212 1)ln\u2212r\u22121 1 \u2212 l2r\u2212n = ln\u2212m\u22121 \u2212 1 (lm \u2212 1) .\n\nCorollary 7.5. When N is prime or the square of a prime, then degJ \u03a6cN =\ns(N \u22121)\n.\n24\nProposition 7.6. When N = p1 p2 for two primes p2 > p1 , then S(N) =\np2 \u2212 p1 .\n\nProof. The case p1 = p2 is already proven. So it remains to consider p1 <\n\u221a\nN < p2 , and the integers k contributing to S(N) are the k\u0303p1 with 1 6\nk\u0303 < p2 . Among these, only one is such that gcd(k \u2212 1, N) 6= 1, namely the\nk with k\u0303 \u2261 1/p1 (mod p2 ); for this one, \u03bc(k) = 2. Therefore\n\u0013\n\u0012\n\u0001\np21\n= p2 \u2212 p1 .\nS(N) = (p2 \u2212 2) * 1 + 1 * 2 1 \u2212\nN\n\n\f30\n\nA. Enge and F. Morain\n\nWith some more effort, the constant coefficient \u03a6cN (0, J) could be obtained as the product of all conjugates, but it is not needed in the following.\n\n7.2\n\nHeights\n\nKnowing the degrees of the modular polynomials, we can compare class\ninvariants obtained from weN among themselves and with others using (7.1).\nOf special interest is the infinite family of invariants obtained in [8] from\nthe double \u03b7-quotients\n\uf8eb \u0010 \u0011 \u0010 \u0011 \uf8f6\u03c3\n\u03b7 pz1 \u03b7 pz2\n\u03c3\n\uf8f8 ,\n\u0011\nwp1 ,p2 (z) = \uf8ed \u0010\nz\n\u03b7 p1 p2 \u03b7(z)\n\nwhere p1 , p2 are (not necessarily distinct) primes and \u03c3 = gcd(24,(p124\n.\n\u22121)(p2 \u22121))\n\u0001\n\u0001\nThese functions yield class invariants whenever pD1 = pD2 = 1, and in\n\u0001\n\u0001\nsome cases when pD1 = 0 or pD2 = 0, see [8, Cor. 3.1]. The degrees of their\nmodular polynomials have been worked out in [9, Th. 9], and we summarise\nthe results in the following table, in which l and p1 6= p2 are supposed to be\nprime numbers.\nf\n\nc(f )\n\ndegJ \u03a6cN\n\nwel\n\ne(l\u22121)\n24(l+1)\ne(l\u22121)\n24l\ne(p2 \u22121)\n24(p2 +1)\ne(N \u22121+S(N ))\n24\u03c8(N )\ne(l\u22121)2\n12l(l+1)\ne(p1 \u22121)(p2 \u22121)\n12(p1 +1)(p2 +1)\n\ns(l\u22121)\n24\nl2 \u22121\nif l > 3\n24\ns(p2 \u22121)(p1 +1)\n24\ns(N \u22121+S(N ))\n24\n\u03c3(l\u22121)2\n12\n\u03c3(p1 \u22121)(p2 \u22121)\n12\n\nwel2\nwep1 p2\nweN\nwel,l\nwep1 ,p2\n\nNotice that asymptotically for l or p1 , p2 \u2192 \u221e, the factors c(f ) tend\ne\nto e/2\nfor wel (here, e is necessarily even), 12\nfor the double \u03b7 quotients\n12\ne\ne\nand 24 for wl2 . For any discriminant D, there are suitable choices of primes\nin arithmetic progressions modulo D such that e/2 = 1 resp. e = 1 are\n1\n1\nreachable, and c(f ) may become arbitrarily close to 12\nresp. 24\n. However,\nat the same time, the degrees of \u03a6cN in F and J tend to infinity, which may\nbe undesirable in complex multiplication applications where the modular\npolynomial needs to be factored over a finite field.\nIn Table 7.2, we list in decreasing order of attractiveness the functions\nf together with the factors 1/c(f ) they allow to gain in height compared\nto j and with the degree of the modular polynomial in J, thus completing\nthe tables of [7] and [10, p. 21]. We limit ourselves to functions gaining a\nfactor of at least 13 and with degree in J at most 20. The function w2 is in\n\n\f31\n\nGeneralised Weber Functions\n\nfact the Weber function f1 , and leads to the same height as the other two\nWeber functions f and f2. Notice that, as indicated by the explicit formulae,\ntransformation levels divisible by 2 or 3 (or, in general, small primes) tend\nto yield smaller class invariants.\nTable 1: Comparison of class invariants: height factor and degree in J\n\n8\n\nw2\n72,1\n\n>\n\nw4\n48,1\n\n>\n\nw2,73\n37,6\n\n>\n\nw2,97\n147/4,8\n\n>\n\nw9\n36,1\n\n=\n\nw22\n36,1\n\n>\n\nw16\n32,6\n\n>\n\nw25\n30,1\n\n>\n\nw3,13\n28,2\n\n=\n\nw49\n28,2\n\n>\n\nw81\n27,12\n\n>\n\nw112\n132/5,5\n\n>\n\nw132\n26,7\n\n>\n\nw172\n51/2,12\n\n>\n\nw3,37\n76/3,6\n\n=\n\nw192\n76/3,15\n\n>\n\nw3,61\n124/5,10\n\n>\n\nw5,7\n24,2\n\n=\n\nw32\n24,1\n\n=\n\nw26\n24,6\n\n=\n\nw24\n24,1\n\n=\n\nw23\n24,1\n\n>\n\nw5,13\n21,4\n\n=\n\nw22,13\n21,2\n\n>\n\nw212\n144/7,14\n\n>\n\nw5,19\n20,6\n\n>\n\nw5,31\n96/5,10\n\n>\n\nw5,37\n19,12\n\n=\n\nw22,37\n19,6\n\n>\n\nw7,13\n56/3,6\n\n>\n\nw22,61\n93/5,10\n\n>\n\nw7,17\n18,8\n\n=\n\nw215\n18,8\n\n=\n\nw28\n18,8\n\n=\n\nw42\n18,1\n\n=\n\nw25\n18,1\n\n=\n\nw210\n18,4\n\n>\n\nw11,13\n84/5,10\n\n>\n\nw23,7\n16,2\n\n=\n\nw235\n16,18\n\n=\n\nw221\n16,6\n\n=\n\nw240\n16,18\n\n=\n\nw214\n16,18\n\n=\n\nw216\n16,6\n\n=\n\nw228\n16,12\n\n=\n\nw27\n16,1\n\n=\n\nw33\n16,1\n\n=\n\nw36\n16,6\n\n>\n\nw245\n108/7,14\n\n>\n\nw13,13\n91/6,12\n\n>\n\nw255\n72/5,10\n\n=\n\nw277\n72/5,20\n\n=\n\nw222\n72/5,10\n\n=\n\nw211\n72/5,5\n\n=\n\nw233\n72/5,10\n\n=\n\nw227\n72/5,15\n\n>\n\nw291\n14,16\n\n=\n\nw265\n14,18\n\n=\n\nw213\n14,1\n\n>\n\nw312\n96/7,14\n\n>\n\nw32,17\n27/2,4\n\n=\n\nw285\n27/2,8\n\n=\n\nw234\n27/2,16\n\n=\n\nw217\n27/2,4\n\n>\n\nw23,19\n40/3,6\n\n=\n\nw27*19\n40/3,12\n\n=\n\nw257\n40/3,18\n\n=\n\nw219\n40/3,3\n\n>\n\nw223\n144/11,11\n\nOutlook\n\nThe presented results concern singular values of powers of wN as class invariants. It is possible to obtain smaller invariants by authorising 24-th roots\nof unity to enter the game. This was already done by Weber for N = 2 (the\nclassical f -functions) and by Gee in [16] for N = 3. For instance, \u03b64 w27 is an\ninvariant for D = \u221240, leading to the minimal polynomial\nX 2 + (\u22125 + 2\u03c9) X + 3 \u2212 4 \u03c9.\ne\nSimilarly, when N is not a square and\n\u221a e is odd, then wN \u25e6 S has a qexpansion that is rational up to a factor N , so that Theorems 2.3 and 2.4\n\n\f32\n\nA. Enge and F. Morain\n\nare not applicable any more. Nevertheless, weN may yield class invariants;\nthis is well-known for Weber's original functions in certain cases.\nAcknowledgements. The second author wants to thank the University\nof Waterloo for its hospitality during his sabbatical leave; he also wants to\nacknowledge the warm and studious atmosphere of the Asahi Judo club of\nKitchener where large parts of the results were proven. The first author was\npartially funded by ERC Starting Grant ANTICS 278537.\n\nReferences\n[1] A. O. L. Atkin and F. Morain. Elliptic curves and primality proving.\nMathematics of Computation, 61(203):29\u201368, 1993.\n[2] B. J. Birch. Weber's class invariants. Mathematika, 16:283\u2013294, 1969.\n[3] D. A. Buell. Binary quadratic forms (Classical theory and modern\ncomputations). Springer-Verlag, 1989.\n[4] H. Cohn. A classical invitation to algebraic numbers and class fields.\nUniversitext. Springer-Verlag, 1978.\n[5] R. Dedekind. Erl\u00e4uterungen zu den vorstehenden Fragmenten. In\nR. Dedekind and H. Weber, editors, Bernhard Riemann's gesammelte\nmathematische Werke und wissenschaftlicher Nachlass, pages 438\u2013447.\nTeubner, Leipzig, 1876.\n[6] M. Deuring. Die Klassenk\u00f6rper der komplexen Multiplikation. In\nEnzyklop\u00e4die der mathematischen Wissenschaften mit Einschluss ihrer\nAnwendungen, volume I 2, Heft 10, Teil II. Teubner, Stuttgart, 1958.\n[7] A. Enge and F. Morain. Comparing invariants for class fields of imaginary quadratic fields. In C. Fieker and D. R. Kohel, editors, Algorithmic Number Theory, volume 2369 of Lecture Notes in Comput. Sci.,\npages 252\u2013266. Springer-Verlag, 2002. 5th International Symposium,\nANTS-V, Sydney, Australia, July 2002, Proceedings.\n[8] A. Enge and R. Schertz. Constructing elliptic curves over finite fields\nusing double eta-quotients. Journal de Th\u00e9orie des Nombres de Bordeaux, 16:555\u2013568, 2004.\n[9] A. Enge and R. Schertz. Modular curves of composite level. Acta\nArith., 181(2):129\u2013141, 2005.\n[10] Andreas Enge. Courbes alg\u00e9briques et cryptologie. Habilitation \u00e0 diriger\ndes recherches, Universit\u00e9 Denis Diderot, Paris 7, 2007.\n\n\fGeneralised Weber Functions\n\n33\n\n[11] Andreas Enge. The complexity of class polynomial computation\nvia floating point approximations. Mathematics of Computation,\n78(266):1089\u20131107, 2009.\n[12] Andreas Enge and Reinhard Schertz. Singular values of multiple etaquotients for ramified primes. Technical Report 768375, HAL-INRIA,\n2012. To appear in LMS Journal of Computation and Mathematics.\n[13] David Freemann, Michael Scott, and Edlyn Teske. A taxonomy of\npairing-friendly elliptic curves. Journal of Cryptology, 23(2):224\u2013280,\n2010.\n[14] A. Gee. Class invariants by Shimura's reciprocity law. J. Th\u00e9or. Nombres Bordeaux, 11:45\u201372, 1999.\n[15] A. Gee and P. Stevenhagen. Generating class fields using Shimura\nreciprocity. In J. P. Buhler, editor, Algorithmic Number Theory, volume\n1423 of Lecture Notes in Comput. Sci., pages 441\u2013453. Springer-Verlag,\n1998. Third International Symposium, ANTS-III, Portland, Oregon,\nJune 1998, Proceedings.\n[16] Alice Chia Ping Gee. Class fields by Shimura reciprocity. Proefschrift,\nUniversiteit Leiden, 2001.\n[17] F. Hajir. Elliptic units of cyclic unramified extensions of complex\nquadratic fields. Acta Arith., LXIV:69\u201385, 1993.\n[18] F. Hajir. Unramified elliptic units. Phd in mathematics, Princeton\nUniversity, June 1993.\n[19] F. Hajir and F. R. Villegas. Explicit elliptic units, I. Duke Math. J.,\n90(3):495\u2013521, 1997.\n[20] C. Meyer. Bemerkungen zum Satz von Heegner\u2013Stark \u00fcber die imagin\u00e4r-quadratischen Zahlk\u00f6rper mit der Klassenzahl Eins. Journal f\u00fcr\ndie reine und angewandte Mathematik, 242:179\u2013214, 1970.\n[21] Fran\u00e7ois Morain. Computing the cardinality of CM elliptic curves\nusing torsion points. Journal de Th\u00e9orie des Nombres de Bordeaux,\n19(3):663\u2013681, 2007.\n[22] R. Schertz. Weber's class invariants revisited. J. Th\u00e9or. Nombres Bordeaux, 14(1):325\u2013343, 2002.\n[23] Reinhard Schertz. Die singul\u00e4ren Werte der Weberschen Funktionen\nf, f1 , f2, \u03b32 , \u03b33 . Journal f\u00fcr die reine und angewandte Mathematik,\n286/287:46\u201374, 1976.\n[24] Reinhard Schertz. Complex Multiplikation.\nPress, Cambridge, 2009.\n\nCambridge University\n\n\f34\n\nA. Enge and F. Morain\n\n[25] Goro Shimura. Introduction to the Arithmetic Theory of Automorphic\nFunctions. Iwanami Shoten and Princeton University Press, 1971.\n[26] H. M. Stark. On the \"gap\" in a theorem of Heegner. J. Number Theory,\n1:16\u201327, 1969.\n[27] H. Weber. Lehrbuch der Algebra, volume III. Chelsea Publishing Company, New York, 1902.\n\n\f"}