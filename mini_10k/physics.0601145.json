{"id": "http://arxiv.org/abs/physics/0601145v1", "guidislink": true, "updated": "2006-01-19T22:27:01Z", "updated_parsed": [2006, 1, 19, 22, 27, 1, 3, 19, 0], "published": "2006-01-19T22:27:01Z", "published_parsed": [2006, 1, 19, 22, 27, 1, 3, 19, 0], "title": "A Second Look at Canonical Sampling of Biomolecules using Replica\n  Exchange Simulation", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0408124%2Cphysics%2F0408074%2Cphysics%2F0408096%2Cphysics%2F0408114%2Cphysics%2F0408040%2Cphysics%2F0408115%2Cphysics%2F0408021%2Cphysics%2F0408008%2Cphysics%2F0408081%2Cphysics%2F0408054%2Cphysics%2F0408130%2Cphysics%2F0408032%2Cphysics%2F0408098%2Cphysics%2F0408016%2Cphysics%2F0408036%2Cphysics%2F0408037%2Cphysics%2F0408053%2Cphysics%2F0408029%2Cphysics%2F0408012%2Cphysics%2F0601125%2Cphysics%2F0601080%2Cphysics%2F0601135%2Cphysics%2F0601148%2Cphysics%2F0601146%2Cphysics%2F0601110%2Cphysics%2F0601043%2Cphysics%2F0601179%2Cphysics%2F0601183%2Cphysics%2F0601075%2Cphysics%2F0601008%2Cphysics%2F0601152%2Cphysics%2F0601147%2Cphysics%2F0601113%2Cphysics%2F0601013%2Cphysics%2F0601207%2Cphysics%2F0601204%2Cphysics%2F0601081%2Cphysics%2F0601206%2Cphysics%2F0601027%2Cphysics%2F0601173%2Cphysics%2F0601217%2Cphysics%2F0601118%2Cphysics%2F0601036%2Cphysics%2F0601099%2Cphysics%2F0601143%2Cphysics%2F0601134%2Cphysics%2F0601169%2Cphysics%2F0601037%2Cphysics%2F0601151%2Cphysics%2F0601166%2Cphysics%2F0601103%2Cphysics%2F0601193%2Cphysics%2F0601006%2Cphysics%2F0601106%2Cphysics%2F0601067%2Cphysics%2F0601208%2Cphysics%2F0601159%2Cphysics%2F0601096%2Cphysics%2F0601021%2Cphysics%2F0601199%2Cphysics%2F0601097%2Cphysics%2F0601172%2Cphysics%2F0601190%2Cphysics%2F0601213%2Cphysics%2F0601210%2Cphysics%2F0601042%2Cphysics%2F0601158%2Cphysics%2F0601126%2Cphysics%2F0601095%2Cphysics%2F0601121%2Cphysics%2F0601058%2Cphysics%2F0601131%2Cphysics%2F0601109%2Cphysics%2F0601203%2Cphysics%2F0601005%2Cphysics%2F0601145%2Cphysics%2F0601055%2Cphysics%2F0601168%2Cphysics%2F0601218%2Cphysics%2F0601039%2Cphysics%2F0601187%2Cphysics%2F0601108%2Cphysics%2F0601049%2Cphysics%2F0601026%2Cphysics%2F0601165%2Cphysics%2F0601060%2Cphysics%2F0601015%2Cphysics%2F0601186%2Cphysics%2F0601221%2Cphysics%2F0601182%2Cphysics%2F0601188%2Cphysics%2F0601144%2Cphysics%2F0601044%2Cphysics%2F0601038%2Cphysics%2F0601200%2Cphysics%2F0601086%2Cphysics%2F0601114%2Cphysics%2F0601061%2Cphysics%2F0601045%2Cphysics%2F0601025%2Cphysics%2F0601105&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Second Look at Canonical Sampling of Biomolecules using Replica\n  Exchange Simulation"}, "summary": "Because of growing interest in temperature-based sampling methods like\nreplica exchange, this note aims to make some observations and raise some\npotentially important questions which we have not seen addressed sufficiently\nin the literature. Mainly, we wish to call attention to limits on the maximum\nspeed-up to be expected from temperature-based methods, and also note the need\nfor careful quantification of sampling efficiency. Because potentially lengthy\nstudies may be necessary to address these issues, we felt it would be useful to\nbring them to the attention of the broader community. Here \\emph{we are\nstrictly concerned with canonical sampling at a fixed temperature,} and\n\\emph{not} with conformational search.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0408124%2Cphysics%2F0408074%2Cphysics%2F0408096%2Cphysics%2F0408114%2Cphysics%2F0408040%2Cphysics%2F0408115%2Cphysics%2F0408021%2Cphysics%2F0408008%2Cphysics%2F0408081%2Cphysics%2F0408054%2Cphysics%2F0408130%2Cphysics%2F0408032%2Cphysics%2F0408098%2Cphysics%2F0408016%2Cphysics%2F0408036%2Cphysics%2F0408037%2Cphysics%2F0408053%2Cphysics%2F0408029%2Cphysics%2F0408012%2Cphysics%2F0601125%2Cphysics%2F0601080%2Cphysics%2F0601135%2Cphysics%2F0601148%2Cphysics%2F0601146%2Cphysics%2F0601110%2Cphysics%2F0601043%2Cphysics%2F0601179%2Cphysics%2F0601183%2Cphysics%2F0601075%2Cphysics%2F0601008%2Cphysics%2F0601152%2Cphysics%2F0601147%2Cphysics%2F0601113%2Cphysics%2F0601013%2Cphysics%2F0601207%2Cphysics%2F0601204%2Cphysics%2F0601081%2Cphysics%2F0601206%2Cphysics%2F0601027%2Cphysics%2F0601173%2Cphysics%2F0601217%2Cphysics%2F0601118%2Cphysics%2F0601036%2Cphysics%2F0601099%2Cphysics%2F0601143%2Cphysics%2F0601134%2Cphysics%2F0601169%2Cphysics%2F0601037%2Cphysics%2F0601151%2Cphysics%2F0601166%2Cphysics%2F0601103%2Cphysics%2F0601193%2Cphysics%2F0601006%2Cphysics%2F0601106%2Cphysics%2F0601067%2Cphysics%2F0601208%2Cphysics%2F0601159%2Cphysics%2F0601096%2Cphysics%2F0601021%2Cphysics%2F0601199%2Cphysics%2F0601097%2Cphysics%2F0601172%2Cphysics%2F0601190%2Cphysics%2F0601213%2Cphysics%2F0601210%2Cphysics%2F0601042%2Cphysics%2F0601158%2Cphysics%2F0601126%2Cphysics%2F0601095%2Cphysics%2F0601121%2Cphysics%2F0601058%2Cphysics%2F0601131%2Cphysics%2F0601109%2Cphysics%2F0601203%2Cphysics%2F0601005%2Cphysics%2F0601145%2Cphysics%2F0601055%2Cphysics%2F0601168%2Cphysics%2F0601218%2Cphysics%2F0601039%2Cphysics%2F0601187%2Cphysics%2F0601108%2Cphysics%2F0601049%2Cphysics%2F0601026%2Cphysics%2F0601165%2Cphysics%2F0601060%2Cphysics%2F0601015%2Cphysics%2F0601186%2Cphysics%2F0601221%2Cphysics%2F0601182%2Cphysics%2F0601188%2Cphysics%2F0601144%2Cphysics%2F0601044%2Cphysics%2F0601038%2Cphysics%2F0601200%2Cphysics%2F0601086%2Cphysics%2F0601114%2Cphysics%2F0601061%2Cphysics%2F0601045%2Cphysics%2F0601025%2Cphysics%2F0601105&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Because of growing interest in temperature-based sampling methods like\nreplica exchange, this note aims to make some observations and raise some\npotentially important questions which we have not seen addressed sufficiently\nin the literature. Mainly, we wish to call attention to limits on the maximum\nspeed-up to be expected from temperature-based methods, and also note the need\nfor careful quantification of sampling efficiency. Because potentially lengthy\nstudies may be necessary to address these issues, we felt it would be useful to\nbring them to the attention of the broader community. Here \\emph{we are\nstrictly concerned with canonical sampling at a fixed temperature,} and\n\\emph{not} with conformational search."}, "authors": ["Daniel M. Zuckerman", "Edward Lyman"], "author_detail": {"name": "Edward Lyman"}, "author": "Edward Lyman", "links": [{"href": "http://arxiv.org/abs/physics/0601145v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/physics/0601145v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "physics.bio-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.bio-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/physics/0601145v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/physics/0601145v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:physics/0601145v1 [physics.bio-ph] 19 Jan 2006\n\nA Second Look at Canonical Sampling of\nBiomolecules using Replica Exchange\nSimulation\nDaniel M. Zuckerman and Edward Lyman\nDepartment of Computational Biology, School of Medicine,\nand Department of Environmental & Occupational Health,\nGraduate School of Public Health,\nSuite 3064 BST3, 3501 Fifth Avenue, University of Pittsburgh, Pittsburgh, Pennsylvania 15213\nPhone: 412-648-3335; Fax: 412-648-3163\ndmz@ccbb.pitt.edu\n\n(October 5, 2018)\n\n\fBecause of growing interest in temperature-based sampling methods like\nreplica exchange [1\u20137], this note aims to make some observations and raise\nsome potentially important questions which we have not seen addressed sufficiently in the literature. Mainly, we wish to call attention to limits on the\nmaximum speed-up to be expected from temperature-based methods, and\nalso note the need for careful quantification of sampling efficiency. Because\npotentially lengthy studies may be necessary to address these issues, we felt\nit would be useful to bring them to the attention of the broader community.\nHere we are strictly concerned with canonical sampling at a fixed temperature,\nand not with conformational search.\nWe will base our discussion around a generic replica exchange protocol,\nconsisting of M levels spanning from the temperature T0 at which canonical\nsampling is desired, up to TM . The protocol is motivated by the increased\nrate of barrier crossing possible at higher temperatures. We assume each level\nis simulated for a time tsim , which implies a total CPU cost (M + 1) \u00d7 tsim .\nIn typical explicitly solvated peptide systems, M \u223c 20, T0 \u2243 300K and\nTM \u223c 450K [3] [check temp]. The relatively low TM values reflect the wellknown, high sensitivity of the approach to configuration-space overlap in\nlarge systems [2, 3]: that is, because of minimal overlap, typical configurations\nin high T Boltzmann ensembles are unlikely in low T enembles. We note that\na new exchange variant introduced by Berne and coworkers permits the use\nof \"cold\" solvent and larger temperature gaps [8], but the issues we raise still\napply to the new protocol, especially as larger solutes are considered.\nWhile replica exchange is often thought of as an 'enhanced sampling\nmethod,' what does that mean? Indeed, what is an appropriate criterion\nfor judging efficiency? As our first observation, we believe (Obs. I) efficiency can only mean a decrease in the total CPU usage - i.e., summed\nover all processors - for a given degree of sampling quality. (We will defer\nthe necessary discussion of assessing sampling quality, and only assume such\nassessment is possible.) When the goal is canonical sampling at T0 , after\nall, one has the option of running an ordinary parallel simulation at T0 (e.g.,\n[namd]) or even M independent simulations [9]. A truly efficient method\nmust be a superior alternative to such \"brute force\" simulation.\n(Obs. II) Reports in the literature offer an ambiguous picture as to\nwhether replica exchange attains efficiency for canonical sampling. Sanbonmatsu and Garcia compared replica exchange to an equivalent amount of\nbrute-force sampling, but their claim of efficiency is largely based on the\nalternative goal of enhancing sampling over the full range of temperatures,\n1\n\n\frather than for canonical sampling at T0 [3]. When the data solely for T0\nare examined, there is no clear gain, especially noting that assessment was\nbased on principal components derived only from the replica exchange data.\nAnother claim of efficiency, by Duan and coworkers [7], fails to include the\nfull CPU cost of all M levels. When suitably corrected, there does appear\nto be speedup of perhaps a factor of two for T0 = 308K, but the system\nstudied is considerably smaller (permitting larger temperature jumps) than\nwould be possible in protein systems of interest. Another efficiency claim by\nRoe et al. also does not account for the full CPU cost of all ladder levels [6].\nIn a structural-glass system, replica exchange was found not to be helpful\n[10], although efficiency has been noted in spin-systems [1, 11]. We emphasize\nthat biomolecular replica exchange should indeed be efficient in certain cases\n(with high enough energy barriers; see below). At least one such instance\nhas been noted by Garcia, using a suitable brute-force comparison system\n[12].\nThe lack of clear-cut results in a much-heralded approach merit closer\nexamination. What might be preventing efficiency gain? Or put another\nway, what is the maximum efficiency possible in a standard replica exchange\nsimulation? The very construction of the method implies that (Obs. III) in\nany parallel exchange protocol, the sampling \"speed\" at the bottom level -\nlowest T - will be controlled by the speed at which the top level - highest\nT - samples the necessary space. Further, given our interest in efficient\ncanonical sampling at T0 , the speed of the top level should exceed that of\nthe bottom by at least a factor of M. If not, the simulation does not \"break\neven\" in total CPU cost, as compared to brute-force canonical sampling at\nT0 for the full length M \u00d7 tsim .\nThe basic temperature dependence of barrier-crossing is well known (e.g.,\n[13]) and has important consequences for replica exchange. The Arrhenius\nfactor indicates that the temperature-dependent rate k for crossing a particular barrier obeys\nka (T ) = k0 exp (+\u2206S/kB ) exp (\u2212\u2206E/kB T )\n\n(1)\n\nfor a fixed-volume system, where k0 is an unknown prefactor insensitive to\ntemperature and assumed constant; \u2206E is the energy barrier and \u2206S is the\nentropy barrier - i.e., \"narrowing\" of configuration space - which must\nbe expected in a multi-dimensional molecular system. Two observations are\nimmediate: (Obs. IV) the entropic component of the rate is completely\n2\n\n\funaffected by an increase in temperature, and the possible speedup due to\nthe energetic part can easily be calculated.\nThe table gives possible speedups for several energy barriers and temperatures, employing units of kB T0 for T0 = 300K. Speed-ups are computed\nsimply as the ratio ka (TM )/ka (T0 ) for possible values of TM . It is clear that\nfor modest barriers, the speed-up attainable even with a top temperature\nTM = 500K is only of the order of a typical number of replicas in replica exchange, M \u223c 20. Thus, (Obs. V) if modest barriers (< 8kB T0 ) dominate a\nsystem's dynamics, efficiency will be difficult to obtain via replica exchange,\nsince the speed-up noted in the table needs to be divided by M + 1.\nHow high are barriers encountered in molecular systems? We can only\nbegin to answer this question, but one must first be careful about which\nbarriers matter. We believe that (Obs. VI) \"local\" barriers will matter most:\nthat is, the energy barriers actually encountered in a trajectory will dominate\nsampling speed. Apparent barriers determined by projections onto arbitrary\nlow-dimensional reaction coordinates would seem of uncertain value. (We\nnote that Zwanzig has attempted to account for local roughness with an\neffective diffusion constant on a slowly varying landscape [14].)\nEvidence from simulations and experiments is far from complete, but\nindicates that (Obs. VII) energy barriers in molecular systems appear to\nbe modest. Here, unless noted otherwise, T0 \u2243 300K. In their extensive\nstudy of a tetrapeptide, Czerminski and Elber found barriers < 3 kcal/mole\n\u2243 5kB T0 for the lowest energy transition path [15]. Equally interesting,\nthey found approximately 1,000 additional paths with similar energy profiles\n(differing by < 1 kcal/mole < 2kB T0 ) - suggesting what we might term a\n\"pebbly\" rather than \"mountainous\" energy landscape. See also Ref. [16].\nIn our own work (unpublished) with implicitly solvated dileucine, increasing\nthe temperature from 298K to 500K led to a hopping-rate increase of a\nfactor of 1.8, suggesting a small barrier (< 1.5kB T0 ). Similarly, Sanbonmatsu\nand Garcia found that barriers for explicitly solvated met-enkephalin were\nsmall, on the order of kB T0 [3]. An experimental study has also suggested\nbarriers are modest (< 6kB T0 ) [17]. Although this list is fairly compelling,\nwe believe the question of barrier heights is far from settled. Further study\nshould carefully consider local vs. global barriers, as well as entropy vs. energy\ncomponents of barriers. (We purposely do not discuss barriers to protein\nfolding, because our scope here is solely equilibrium fluctuations.)\nFinally, the goal of understanding efficiency implies the need for reliable\nmeans for assessing sampling. An ideal approach to assessment would survey\n3\n\n\fall pertinent substates to ensure appropriate Boltzmann frequencies. Present\napproaches to assessment typically calculate free energy surfaces (equivalently, probability distributions) on one or two-dimensional surfaces, which\nare evaluated visually. Principal components (e.g., [3, 7]) as well as \"composite\" coordinates like the radius of gyration [6] are popular coordinate choices.\nYet we believe that (Obs. VIII) the use of low-dimensional sampling assessment is intrinsically limited, since it could readily mask structural diversity\n- i.e., be consistent with substantially distinct conformational ensembles.\nFuture work could usefully pursue higher-dimensional measures, which can\nalways be numerically compared between independent simulations for sampling assessment. In our own work, for instance, we have begun to use a\nhistogram measure which directly reports on the structural distribution of\nan ensemble [18].\nIn conclusion, we have attempted to tie together a number of straightforward observations which reflect concerns about the effectiveness of the\nreplica exchange simulation method, when the goal is single-temperature\ncanonical sampling. The concerns suggest other simulation strategies, such\nas Hamiltonian exchange [19] and resolution exchange [20, 21], may merit\nconsideration - as well as scrutiny. We emphasize that our goal has been to\nraise questions more than to answer them. Even if our worries turn out to\nbe exaggerated, a candid discussion of the issues should be beneficial to the\nmolecular simulation community.\nThe authors wish to thank Rob Coalson, Juan de Pablo, Ron Elber, Angel\nGarcia, and Robert Swendsen for very useful conversations. We gratefully acknowledge support from the NIH, through Grants ES007318 and GM070987.\nWe also greatly appreciate support from the Department of Computational\nBiology and the Department of Environmental & Occupational Health.\n\n4\n\n\fTM = 400K\n500K\n600K\n\n\u2206E = 2kB T0\n1.65\n2.23\n2.72\n\n4kB T0\n2.72\n4.95\n7.39\n\n6kB T0\n4.48\n11.0\n20.1\n\n8kB T0\n7.39\n24.5\n54.6\n\nTable 1: High-temperature speed-up factors calculated using Arrhenius factors. Speed-up factors are computed as the ratio ka (TM )/ka (T0 = 300K) for\nthe indicated energy barriers \u2206E via Eq. (1). Energy barriers are given in\nunits of kB T0 . A rough estimate of the efficiency factor (the factor by which\ntotal CPU usage is reduced) obtainable in an M-level parallel replica exchange simulation with maximum temperature TM is the table entry divided\nM.\n\n5\n\n\fBibliography\n[1] R. H. Swendsen and J.-S. Wang. Replica monte carlo simulation of\nspin-glasses. Phys. Rev. Lett., 57:2607\u20132609, 1986.\n[2] U. H. E. Hansmann. Parallel tempering algorithm for conformational\nstudies of biological molecules. Chem. Phys. Lett., 281:140\u2013150, 1997.\n[3] Sanbonmatsu K. Y. and A. E. Garcia. Structure of met-enkephalin in\nexplicit aqueous solution using replica exchange molecular dynamics.\nProteins, 46:225\u2013234, 2002.\n[4] D. Paschek and A. E. Garcia. Reversible temperature and pressure\ndenaturation of a protein fragment: A replica-exchange molecular dynamics simulation study. Phys. Rev. Lett., 93:238105, 2004.\n[5] N. Rathore, M. Chopra, and J. J. de Pablo. Optimal allocation of\nreplicas in parallel tempering simulations. J. Chem. Phys., 122:024111,\n2005.\n[6] D. R. Roe, V. Hornak, and C. Simmerling. Folding cooperativity in a\nthree-stranded beta-sheet model. J. Molec. Bio., 352:370\u2013381, 2005.\n[7] W. Zhang, C. Wu, and Y. Duan. Convergence of replica exchange molecular dynamics. J. Chem. Phys., 123:154105, 2005.\n[8] P. Liu, B. Kim, R. A. Friesner, and B. J. Berne. Replica exchange with\nsolute tempering: A method for sampling biological systems in explicit\nwater. Proc. Nat. Acad. Sci., 102:13749\u201313754, 2005.\n[9] L. S. D. Caves, J. D. Evanseck, and M. Karplus. Locally accessible\nconformations of proteins: Multiple molecular dynamics simulations of\ncrambin. Protein Sci., 7:649\u2013666, 1998.\n6\n\n\f[10] C. De Michele and F. Sciortino. Equilibration times in numerical simulation of structural glasses: Comparing parallel tempering and conventional molecular dynamics. Phys. Rev. E, 65:051202, 2002.\n[11] J.-S. Wang and R.H. Swendsen. Replica Monte Carlo simulation (revisited). Prog. Theoret. Phys. Supp., 157:317\u2013323, 2005.\n[12] A. E. Garcia. Personal communication with D. M. Zuckerman. 2005.\n[13] P. Atkins and J. de Paula. Physical Chemistry (7th ed.). Freeman, New\nYork, 2002.\n[14] R. W. Zwanzig. Diffusion in a rough potential. Proc. Natl. Acad. Sci.\nUSA, 85:2029\u20132030, 1988.\n[15] R. Czerminski and R. Elber. Reaction-path study of conformational\ntransitions in flexible systems - applications to peptides. J. Chem. Phys.,\n92:5580\u20135601, 1990.\n[16] C. Hyeon and D. Thirumalai. Can energy landscape roughness of proteins and RNA be measured by using mechanical unfolding experiments?\nProc. Nat. Acad. Sci., 100:10249\u201310253, 2003.\n[17] R. Nevo, V. Brumfeld, R. Kapon, P. Hinterdorfer, and Z. Reich. Direct measurement of protein energy landscape roughness. EMBO Rep.,\n6:482\u2013486, 2005.\n[18] E. Lyman and D. M. Zuckerman.\nEnsemble based convergence assessment of biomolecular trajectories.\nArchived version:\nhttp://www.arxiv.org/abs/physics/0601104, 2006.\n[19] Y. Sugita, A. Kitao, and Y. Okamoto. Multidimensional replicaexchange method for free-energy calculations. J. Chem. Phys., 113:6042\u2013\n6051, 2000.\n[20] E. Lyman, F. M. Ytreberg, and D. M. Zuckerman. Resolution exchange\nsimulation. Phys. Rev. Lett., page In press, 2006.\n[21] E. Lyman and D. M. Zuckerman.\nsimulation with incremental coarsening.\nwww.arxiv.org/abs/physics/0601093, 2006.\n\n7\n\nResolution exchange\nArchived version:\n\n\f"}