{"id": "http://arxiv.org/abs/1101.1330v4", "guidislink": true, "updated": "2014-05-29T14:14:13Z", "updated_parsed": [2014, 5, 29, 14, 14, 13, 3, 149, 0], "published": "2011-01-06T22:38:41Z", "published_parsed": [2011, 1, 6, 22, 38, 41, 3, 6, 0], "title": "The good pants homology and the Ehrenpreis conjecture", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1101.5086%2C1101.5681%2C1101.3720%2C1101.0926%2C1101.3718%2C1101.1789%2C1101.5411%2C1101.3145%2C1101.1712%2C1101.4120%2C1101.1405%2C1101.4159%2C1101.5444%2C1101.4759%2C1101.2557%2C1101.1259%2C1101.0919%2C1101.5474%2C1101.4755%2C1101.3886%2C1101.1192%2C1101.3256%2C1101.3092%2C1101.2335%2C1101.2568%2C1101.4577%2C1101.5510%2C1101.0479%2C1101.5965%2C1101.1183%2C1101.0198%2C1101.0364%2C1101.2771%2C1101.0216%2C1101.5076%2C1101.0876%2C1101.4077%2C1101.0417%2C1101.5687%2C1101.1844%2C1101.1671%2C1101.3122%2C1101.4375%2C1101.1918%2C1101.2883%2C1101.4462%2C1101.3677%2C1101.4694%2C1101.5434%2C1101.0222%2C1101.3917%2C1101.3551%2C1101.3127%2C1101.4455%2C1101.5897%2C1101.4690%2C1101.1338%2C1101.0752%2C1101.2580%2C1101.0226%2C1101.2935%2C1101.3440%2C1101.5069%2C1101.4074%2C1101.4493%2C1101.2375%2C1101.1214%2C1101.4520%2C1101.2307%2C1101.3069%2C1101.2713%2C1101.2795%2C1101.0837%2C1101.5311%2C1101.5108%2C1101.4874%2C1101.0539%2C1101.1330%2C1101.1983%2C1101.1978%2C1101.1263%2C1101.1526%2C1101.4735%2C1101.4156%2C1101.3549%2C1101.1417%2C1101.5864%2C1101.2165%2C1101.5168%2C1101.1818%2C1101.4485%2C1101.4241%2C1101.5776%2C1101.5330%2C1101.4689%2C1101.5017%2C1101.3938%2C1101.2330%2C1101.5702%2C1101.0033%2C1101.3607&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The good pants homology and the Ehrenpreis conjecture"}, "summary": "We develop the notion of the good pants homology and show that it agrees with\nthe standard homology on closed surfaces (the good pants are pairs of pants\nwhose cuffs have the length nearly equal to some large number R). Combined with\nour previous work on the Surface Subgroup Theorem, this yields a proof of the\nEhrenpreis conjecture.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1101.5086%2C1101.5681%2C1101.3720%2C1101.0926%2C1101.3718%2C1101.1789%2C1101.5411%2C1101.3145%2C1101.1712%2C1101.4120%2C1101.1405%2C1101.4159%2C1101.5444%2C1101.4759%2C1101.2557%2C1101.1259%2C1101.0919%2C1101.5474%2C1101.4755%2C1101.3886%2C1101.1192%2C1101.3256%2C1101.3092%2C1101.2335%2C1101.2568%2C1101.4577%2C1101.5510%2C1101.0479%2C1101.5965%2C1101.1183%2C1101.0198%2C1101.0364%2C1101.2771%2C1101.0216%2C1101.5076%2C1101.0876%2C1101.4077%2C1101.0417%2C1101.5687%2C1101.1844%2C1101.1671%2C1101.3122%2C1101.4375%2C1101.1918%2C1101.2883%2C1101.4462%2C1101.3677%2C1101.4694%2C1101.5434%2C1101.0222%2C1101.3917%2C1101.3551%2C1101.3127%2C1101.4455%2C1101.5897%2C1101.4690%2C1101.1338%2C1101.0752%2C1101.2580%2C1101.0226%2C1101.2935%2C1101.3440%2C1101.5069%2C1101.4074%2C1101.4493%2C1101.2375%2C1101.1214%2C1101.4520%2C1101.2307%2C1101.3069%2C1101.2713%2C1101.2795%2C1101.0837%2C1101.5311%2C1101.5108%2C1101.4874%2C1101.0539%2C1101.1330%2C1101.1983%2C1101.1978%2C1101.1263%2C1101.1526%2C1101.4735%2C1101.4156%2C1101.3549%2C1101.1417%2C1101.5864%2C1101.2165%2C1101.5168%2C1101.1818%2C1101.4485%2C1101.4241%2C1101.5776%2C1101.5330%2C1101.4689%2C1101.5017%2C1101.3938%2C1101.2330%2C1101.5702%2C1101.0033%2C1101.3607&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We develop the notion of the good pants homology and show that it agrees with\nthe standard homology on closed surfaces (the good pants are pairs of pants\nwhose cuffs have the length nearly equal to some large number R). Combined with\nour previous work on the Surface Subgroup Theorem, this yields a proof of the\nEhrenpreis conjecture."}, "authors": ["Jeremy Kahn", "Vladimir Markovic"], "author_detail": {"name": "Vladimir Markovic"}, "author": "Vladimir Markovic", "arxiv_comment": "Revised to incorporate the advice of the referee. Appendix 2 has been\n  substantially rewritten. 78 pages", "links": [{"href": "http://arxiv.org/abs/1101.1330v4", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1101.1330v4", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.GT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.GT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1101.1330v4", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1101.1330v4", "journal_reference": null, "doi": null, "fulltext": "May 30, 2014\nTHE GOOD PANTS HOMOLOGY AND THE\nEHRENPREIS CONJECTURE\n\narXiv:1101.1330v4 [math.GT] 29 May 2014\n\nJEREMY KAHN AND VLADIMIR MARKOVIC\nAbstract. We develop the notion of the good pants homology\nand show that it agrees with the standard homology on closed\nsurfaces (good pants are pairs of pants whose cuffs have the length\nnearly equal to some large number R > 0). Combined with our\nprevious work on the Surface Subgroup Theorem [6], this yields a\nproof of the Ehrenpreis conjecture.\n\n1. Introduction\nLet S and T denote two closed Riemann surfaces (all closed surfaces\nin this paper are assumed to have genus at least 2). The well-known\nEhrenpreis conjecture asserts that for any K > 1, one can find finite\ndegree covers S1 and T1 , of S and T respectively, such that there exists\na K-quasiconformal map f : S1 \u2192 T1 . The purpose of this paper is to\nprove this conjecture. Below we outline the strategy of the proof.\nLet R > 1 and let \u03a0(R) be the hyperbolic pair of pants (with geodesic\nboundary) whose three cuffs have the length R. We define the surface\nS(R) to be the genus two surface that is obtained by gluing two copies\nof \u03a0(R) along the cuffs with the twist parameter equal to +1 (these\nare the Fenchel-Nielsen coordinates for S(R)). By Orb(R) we denote\nthe quotient orbifold of the surface S(R) (the quotient of S(R) by the\ngroup of automorphisms of S(R)). For a fixed R > 1, we sometimes\nrefer to Orb(R) as the model orbifold. The following theorem is the\nmain result of this paper.\nTheorem 1.1. Let S be a closed hyperbolic Riemann surface. Then\nfor every K > 1, there exists R0 = R0 (K, S) > 0 such that for every\nR > R0 there are finite covers S1 and O1 of the surface S and the model\norbifold Orb(R) respectively, and a K-quasiconformal map f : S1 \u2192\nO1 .\nThe Ehrenpreis conjecture is an immediate corollary of this theorem.\nCorollary 1.1. Let S and T denote two closed Riemann surfaces. For\nany K > 1, one can find finite degree covers S1 and T1 of S and T\nJK is supported by NSF grant number DMS 0905812\n2000 Mathematics Subject Classification. Primary 20H10.\n1\n\n\f2\n\nKAHN AND MARKOVIC\n\nrespectively, such that there exists a K-quasiconformal map f : S1 \u2192\nT1 .\nProof. Fix K > 1. It follows from Theorem 1.1 that for R large enough,\nthere exist\n(1) Finite covers S1 , T1 , of S and T respectively, and\n(2) \u221a\nFinite covers O1 and O10 of Orb(R),\n(3) K-quasiconformal mappings f : S1 \u2192 O1 , and g : T1 \u2192 O10 .\nLet O2 denote a common finite cover of O1 and O10 (such O2 exists\nsince O1 and O10 are covers of the same orbifold Orb(R)). Then there\n\u221a\nare finite covers S2 and T2 , of S1 and T1 , respectively, and the Kquasiconformal maps fe : S2 \u2192 O2 , and ge : T2 \u2192 O2 , that are the lifts\nof f and g. Then ge\u22121 \u25e6 fe : S2 \u2192 T2 is K-quasiconformal map, which\nproves the corollary.\n\u0003\nIn the remainder of the paper we prove Theorem 1.1. This paper\nbuilds on our previous paper [6] where we used immersed skew pants in\na given hyperbolic 3-manifold to prove the Surface Subgroup Theorem.\nWe note that Lewis Bowen [1] was the first to attempt to build finite\ncovers of Riemann surfaces by putting together immersed pairs of pants.\nWe also note that it follows from the work of Danny Calegari [2] that\nthe pants homology is equal to the standard homology. This means\nthat every sum of closed curves on a closed surface S that is zero in\nthe standard homology H1 (S) is the boundary of a sum of immersed\npairs of pants in S.\nWe are grateful to Lewis Bowen for carefully reading the manuscript\nand suggesting numerous improvements and corrections. The second\nnamed author would like to acknowledge that the first named author\nhas done most of the work in the second part of the paper concerning\nthe Correction Theory.\nOutline. In our previous paper [6] we proved a theorem very similar\nto Theorem 1.1, namely that given a closed hyperbolic 3-manifold M3 ,\nand K > 1, R > R0 (K, M3 ), we can find a finite cover O1 of Orb(R)\nand a map f : O1 \u2192 M3 that lifts to a map fe : H2 \u2192 H3 such\nthat \u2202 fe : \u2202H2 \u2192 \u2202H3 has a K-quasiconformal extension. We proved\nthat theorem by finding a large collection of \"skew pairs of pants\"\nwhose cuffs have complex half-lengths close to R, and which are \"evenly\ndistributed\" around every closed geodesic that appears as a boundary.\nWe then assemble these pants by (taking two copies of each and\nthen) pairing off the pants that have a given geodesic as boundary,\nso that the resulting complex twist-bends (or reduced Fenchel-Nielsen\n\n\fTHE EHRENPREIS CONJECTURE\n\n3\n\ncoordinates) are close to 1. We can then construct a cover O1 of Orb(R)\nand a function f : O1 \u2192 M whose image is the closed surface that\nresults from this pairing. The function f will then have the desired\nproperty.\nWe would like to proceed in the same manner in dimension 2, that is\nwhen a 3-manifold M3 is replaced with a closed surface S. We can, as\nbefore, find a collection of good immersed pants (with cuff length close\nto R) that is \"evenly distributed\" around each good geodesic (of length\nclose to R) that appears as boundary. If and when we can assemble the\npants to form a closed surface with (real) twists close to 1, we will have\nproduced a K-quasiconformal immersion of a cover of Orb(R) into S.\nThere is only one minor detail: the unit normal bundle of a closed\ngeodesic in S has two components. In other words, an immersed pair\nof pants that has a closed geodesic \u03b3 as a boundary can lie on one of\nthe two sides of \u03b3. If, in our formal sum of pants, we find we have\nmore pants on one side of \u03b3 than the other, then we have no chance\nto form a closed surface out of this formal sum of pants. It is for this\nvery reason that the Ehrenpreis Conjecture is more difficult to prove\nthan the Surface Subgroup Theorem.\nBecause our initial collection is evenly distributed, there are almost\nthe same number of good pants on both sides of any good geodesic,\nso it is natural to try to adjust the number of pairs of pants so that\nit is balanced (with the same number of pants on both sides of each\ngeodesic). This leads us to look for a \"correction function\" \u03c6 from\nformal sums of (normally) oriented closed geodesics (representing the\nimbalance) to formal sums of good pants, such that the boundary of\n\u03c6(X) is X.\nThe existence of this correction function then implies that \"good\nboundary is boundary good\", that is any sum of good geodesics that is\na boundary in H1 (S) (the first homology group of S) is the boundary\nof a sum of good pants. Thus we define the good pants homology\nto be formal sums of good geodesics (with length close to R) modulo\nboundaries of formal sums of good pants. We would like to prove that\nthe good pants homology is the standard homology on good curves.\nThe natural approach is to show that any good curve is homologous\nin good pants homology to a formal sum of 2g particular good curves\nthat represent a basis in H1 (S) (g is the genus of S). That is, we want\nto show that there are {h1 , ..., h2g } good curves that generate H1 (S)\n(here H1 (S) is taken with rational coefficients) such that every good\ncurve\n\u03b3 is homologous in the good pants homology to a formal sum\nP\nai hi , for some ai \u2208 Q. Then any sum of good curves is likewise\nhomologous to a sum of good generators hi , but if the original sum of\n\n\f4\n\nKAHN AND MARKOVIC\n\ngood curves is zero in H1 (S) then the corresponding sum of hi 's is zero\nas well.\nTo prove the Good Correction Theorem , we must first develop the\ntheory of good pants homology. Let \u2217 denote a base point on S. For A \u2208\n\u03c01 (S, \u2217)\\{id}, we let [A] denote the closed geodesic freely homotopic to\nA. Our theory begins with the Algebraic Square Lemma, which states\nthat, under certain geometric conditions,\nX\n(\u22121)i+j [Ai U Bj V ] = 0,\ni,j=0,1\n\nin the good pants homology. (The curves [Ai U Bj V ] must be good\ncurves, the words Ai U Bj V reasonably efficient, and the length of U and\nV sufficiently large). This then permits us to define, for A, T \u2208 \u03c01 (S, \u2217),\n\u0001\n1\nAT =\n[T AT \u22121 U ] \u2212 [T A\u22121 T \u22121 U ] ,\n2\nwhere U is fairly arbitrary. Then AT in good pants homology is independent of the choice of U .\nWe then show through a series of lemmas that (XY )T = XT + YT in\ngood pants homology, and therefore\nX\nXT =\n\u03c3(j)(gij )T ,\n\u03c3(1)\n\n\u03c3(k)\n\nwhere by X = gi1 ...gik we have written X as a product of generators\n(here g1 , ..., g2g are the generators for \u03c01 (S, \u2217) and \u03c3(j) = \u00b11). With a\nlittle more work we can show\nX\n[X] =\n\u03c3(j)(gij )T\nas well, and thus we can correct any good curve to good generators.\nWe are then finished except for one last step: We must show that\nour correction function, which gives an explicit sum of pants with a\ngiven boundary, is well-behaved in that it maps sums of curves, with\nbounded weight on each curve, to sums of pants, with bounded weight\non each pair of pants. We call such a function semirandom, because if\nwe pick a curve at random, the expected consumption of a given pair of\npants is not much more than if we picked the pair of pants at random.\nWe define the correction function implicitly, through a series of lemmas, each of which asserts the existence of a formal sum of pants with\ngiven boundary, and which is in principle constructive. The notion of\nbeing semirandom is sufficiently natural to permit us to say that the\nbasic operations, such as the group law, or forming [A] from A, as well\nas composition and formal addition, are all semirandom. So in order\nto verify that our correction function is semirandom, we need only to\n\n\fTHE EHRENPREIS CONJECTURE\n\n5\n\ngo through each lemma observing that the function we have defined\nis built out of the functions that we have previously defined using the\nstandard operations which we have proved are semirandom.\nTo make the paper as easy to read as possible, we have relegated\nthe verification of semi-randomness to the \"Randomization remarks\"\nwhich follow our homological lemmas, and which use the notation and\nresults (that basic constructions are semirandom) that we have placed\nin the Appendix. We strongly recommend that the reader skip over\nthese Randomization remarks in the first reading, and to interpret the\nword \"random\" in the text to simply mean \"arbitrary\".\nA word on notation. When we use the letter K to denote a constant\nthen we mean a universal constant or if K depends on parameters\nX, Y, Z... then we write K(X, Y, Z...) or we may leave out some of the\nparameters. In sections where we fixed certain parameters we may\nleave out the dependence of constants on these parameters.\n2. Constructing good covers of a Riemann surface\n2.1. The reduced Fenchel-Nielsen coordinates and the model\norbifolds. Let S 0 be an oriented closed topological surface with a\ngiven pants decomposition C, where C is a maximal collection of disjoint\nsimple closed curves that cut S 0 into the corresponding pairs of pants.\nWe will say that C makes S 0 into a panted surface.\nDenote by C \u2217 the set of oriented curves from C (each curve in C is\ntaken with both orientations). The set of pairs (\u03a0, C \u2217 ), where \u03a0 is a\npair of pants from the pants decomposition and C \u2217 \u2208 C \u2217 is an oriented\nboundary cuff of \u03a0, is called the set of marked pants and it is denoted\nby \u03a0(S 0 ). For C \u2208 C there are exactly two pairs (\u03a0i , Ci\u2217 ) \u2208 \u03a0(S 0 ),\ni = 1, 2, such that C1\u2217 and C2\u2217 are the two orientations on C (note that\n\u03a01 and \u03a02 may agree as pairs of pants).\nLet (S, C) be a panted Riemann surface. Then for every cuff C \u2208 C\nwe can define the reduced Fenchel-Nielsen coordinates (hl(C), s(C))\nfrom [6]. Here hl(C) is the half-length of the geodesic homotopic to\nC, and s(C) \u2208 R/hl(C)Z is the reduced twist parameter which lives\nin the circle R/hl(C)Z (when we write s(C) = x \u2208 R, we really mean\ns(C) \u2261 x mod(hl(C)Z)). The following theorem was proved in [6] (see\nTheorem 2.1 and Corollary 2.1 in [6]).\nb > 0 such that the following\nTheorem 2.1. There exist constants b\n\u000f, R\nholds. Let S denote a panted Riemann surface whose reduced FenchelNielsen coordinates satisfy the inequalities.\n\u000f\n|hl(C) \u2212 R| < \u000f, and |s(C) \u2212 1| < ,\nR\n\n\f6\n\nKAHN AND MARKOVIC\n\nb Then there exists a marked surface MR ,\nfor some b\n\u000f > \u000f > 0 and R > R.\nwith the reduced Fenchel-Nielsen coordinates hl(C) = R and s(C) = 1,\nand a K-quasiconformal map f : S \u2192 MR , where\nb\n\u000f+\u000f\n.\nK=\nb\n\u000f\u2212\u000f\nLet R > 1, and let Orb(R) denote the corresponding model orbifold (defined in the introduction). In the next subsection we will see\nthat the significance of the above theorem comes from the observation\nthat any Riemann surface MR with reduced Fenchel-Nielsen coordinates hl(C) = R and s(C) = 1 is a finite cover of Orb(R).\n2.2. A proof of Theorem 1.1. Below we state the theorem which is\nthen used to prove Theorem 1.1.\nTheorem 2.2. Let S denote a closed Riemann surface, and let \u000f > 1.\nThere exists R(S, \u000f) > 1 such that for every R > R(S, \u000f) we can find\na finite cover S1 of S that has a pants decomposition whose reduced\nFenchel-Nielsen coordinates satisfy the inequalities\n\u000f\n|hl(C) \u2212 R| < \u000f, and |s(C) \u2212 1| < .\nR\nThis theorem will be proved at the end of section.\nP roof of Theorem 1.1: Let K > 1. It follows from Theorem 2.1\nthat for \u000f > 0 small enough, and every R large enough, there is a Kquasiconformal map f : S1 \u2192 MR , where MR is a Riemann surface with\nreduced Fenchel-Nielsen coordinates hl(C) = R and s(C) = 1, and S1\nis the finite cover of S from Theorem 2.2. Recall the corresponding\nmodel orbifold Orb(R) (defined in the introduction). As we observed,\nthe surface MR is a finite cover of Orb(R). This completes the proof\nof the theorem.\n2.3. The set of immersed pants in a given Riemann surface.\nFrom now on S = H2 /G is a fixed closed Riemann surface and G a\nsuitable Fuchsian group. By \u0393 we denote the collection of oriented\nclosed geodesics in S. By \u2212\u03b3 we denote the opposite orientation of an\noriented geodesic \u03b3 \u2208 \u0393. We sometimes write \u03b3 \u2217 \u2208 \u0393 to emphasize a\nchoice of orientation.\nLet \u03a00 denote a hyperbolic pair of pants (that is \u03a00 is equipped\nwith a hyperbolic metric such that the cuffs of \u03a00 are geodesics). Let\nf : \u03a00 \u2192 S be a local isometry (such an f must be an immersion).\nWe say that \u03a0 = (f, \u03a00 ) is an immersed pair of pants in S. The set of\nall immersed pants in S is denoted by \u03a0. Let C \u2217 denote an oriented\ncuff of \u03a00 (the geodesic C \u2217 is oriented as a boundary component of\n\n\fTHE EHRENPREIS CONJECTURE\n\n7\n\n\u03a00 ). Set f (C \u2217 ) = \u03b3 \u2208 \u0393. We say that \u03b3 is an oriented cuff of \u03a0. The\nset of such pairs (\u03a0, \u03b3) is called the set of marked immersed pants and\ndenoted by \u03a0\u2217 . The half-length hl(\u03b3) associated to the cuff \u03b3 of \u03a0 is\ndefined as the half-length hl(C) associated to the cuff C of \u03a00 .\nLet \u03b3 \u2208 \u0393 be a closed oriented geodesic in S. Denote by N 1 (\u03b3) the\nunit normal bundle of \u03b3. Elements of N 1 (\u03b3) are pairs (p, v), where\np \u2208 \u03b3 and v is a unit vector at p that is orthogonal to \u03b3. The bundle\nN 1 (\u03b3) is a differentiable manifold that has two components which we\ndenote by N+1 (\u03b3) and N\u22121 (\u03b3) (the right-hand side and the left-hand side\ncomponents). Each component inherits the metric from the geodesic\n\u03b3, and both N+1 (\u03b3) and N\u22121 (\u03b3) are isometric (as metric spaces) to the\ncircle of length 2hl(\u03b3). By dis we denote the corresponding distance\nfunctions on N+1 (\u03b3) and N\u22121 (\u03b3).\nLet (p, v) \u2208 N 1 (\u03b3), and denote by (p1 , v1 ) \u2208 N 1 (\u03b3) the pair such\nthat (p, v) and (p1 , v1 ) belong to the same component of N 1 (\u03b3), and\ndis(p, p1 ) = hl(\u03b3). Set A(p, v) = (p1 , v1 ). Then A is an involution\nthat leaves invariant each component of N 1 (\u03b3). Define the bundle\n\u221a\n\u221a\nN 1 ( \u03b3) = N 1 (\u03b3)/A. The two components are denoted by N+1 ( \u03b3)\n\u221a\nand N\u22121 ( \u03b3), and both are isometric (as metric spaces) to the circle\nof length\nhl(\u03b3). The disjoint union of all such bundles is denoted by\n\u221a\n1\nN ( \u0393).\nWe now define the foot of a pair of pants. Let \u03a0 \u2208 \u03a0 be an immersed\npants and f : \u03a00 \u2192 \u03a0 the corresponding local isometry. Let C \u2217 denote\nan oriented cuff of \u03a00 and \u03b3 = f (C \u2217 ). Let C1 and C2 denote the other\ntwo cuffs of \u03a00 , and let p01 , p02 \u2208 C \u2217 denote the two points that are the\nfeet of the shortest geodesic segments in \u03a00 that connect C and C1 ,\nand C and C2 , respectively. Let v10 denote the unit vector at p01 that\nis orthogonal to C and points towards the interior of \u03a00 . We define\nv20 similarly. Set (p1 , v1 ) = f\u2217 (p01 , v10 ) and (p2 , v2 ) = f\u2217 (p02 , v20 ). Then\n(p1 , v1 ) and (p2 , v2 ) are in the same component of N 1 (\u03b3), and the points\np1 and p2 separate \u03b3 into two intervals of length hl(\u03b3). Therefore,\u221athe\nvectors (p1 , v1 ) and (p2 , v2 ) represent the same point (p, v) \u2208 N 1 ( \u0393),\nand we set\n\u221a\nfoot(\u03a0, \u03b3) = (p, v) \u2208 N 1 ( \u03b3).\nWe call the vector (p, v) the foot of the immersed pair of pants \u03a0 at\nthe cuff \u03b3. This defines the map\n\u221a\nfoot : \u03a0\u2217 \u2192 N 1 ( \u0393).\n2.4. Measures on pants and the \u2202b operator. By M(\u03a0) we denote the space of real valued Borel measures with finite\n\u221a support on the\n1\nset of immersed pants \u03a0, and likewise, by M(N ( \u0393)) we denote the\n\n\f8\n\nKAHN AND MARKOVIC\n\nspace of real\nsupport on the man\u221a valued Borel measures+with1 compact\n\u221a\n1\nifold N ( \u0393) (a measure from M (N ( \u0393)) has a compact support\nif and only if its\u221asupport is contained in at most finitely\nmany bundles\n\u221a\n1 \u221a\n1\n+\n+\n1\nN ( \u03b3) \u2282 N ( \u0393)). By M (\u03a0) and M (N ( \u0393)), we denote the\ncorresponding spaces of positive measures.\nWe define the operator\n\u221a\n\u2202b : M(\u03a0) \u2192 M(N 1 ( \u0393)),\nas follows. The set \u03a0 is a countable set, so every measure from \u03bc \u2208\nM(\u03a0) is determined by its value \u03bc(\u03a0) on every \u03a0 \u2208 \u03a0. Let \u03a0 \u2208 \u03a0\nand let \u03b3i \u2208 \u0393, i = 0, 1, 2, denote the corresponding\noriented geodesics\n\u221a\n1\n\u2217\n\u03a0\nso that (\u03a0, \u03b3i ) \u2208 \u03a0 . Let \u03b1i \u2208 M(N ( \u0393)) be the atomic measure\n\u221a\nsupported at the point foot(\u03a0, \u03b3i ) \u2208 N 1 ( \u03b3i ), where the mass of the\natom is equal to 1. Let\n2\nX\n\u03a0\n\u03b1 =\n\u03b1i\u03a0 ,\ni=0\n\nand define\nb =\n\u2202\u03bc\n\nX\n\n\u03bc(\u03a0)\u03b1\u03a0 .\n\n\u03a0\u2208\u03a0\n\nb \u2208\nWe call this\nthe \u2202b operator on measures. If \u03bc \u2208 M+ (\u03a0), then \u2202\u03bc\n\u221a\nb is three times the total\nM+ (N 1 ( \u0393)), and the total measure of \u2202\u03bc\nmeasure of \u03bc.\nWe recall the notion of equivalent measures from Section 3 in [6]. Let\n(X, d) be a metric space. By M+ (X) we denote the space of positive,\nBorel measures on X with compact support. For A \u2282 X and \u03b4 > 0 let\nN\u03b4 (A) = {x \u2208 X :\n\nthere exists a \u2208 A such that d(x, a) \u2264 \u03b4},\n\nbe the \u03b4-neighbourhood of A.\nDefinition 2.1. Let \u03bc, \u03bd \u2208 M+ (X) be two measures such that \u03bc(X) =\n\u03bd(X), and let \u03b4 > 0. Suppose that for every Borel set A \u2282 X we\nhave \u03bc(A) \u2264 \u03bd(N\u03b4 (A)). Then we say that \u03bc and \u03bd are \u03b4-equivalent\nmeasures.\nRemark. We observe that this definition is symmetric because \u03bd(A) \u2264\n\u03bc(N\u03b4 (A)) whenever \u03bc(X \\ N\u03b4 (A)) \u2264 \u03bd(N\u03b4 (X \\ N\u03b4 (A)).\nIn our applications X will be either a 1-torus (a circle) or R. In this\ncase, \u03bc(A) \u2264 \u03bd(N\u03b4 (A)) for all Borel sets A if it holds for all intervals\nA. We recall that if \u03bc and \u03bd are discrete and integer valued measures\nthat are \u000f-equivalent then there is a \"matching\" between \u03bc and \u03bd that\nmatches each point x to a point within \u000f of x. In other words, letting\nEn be {1, 2..., n} with the counting measure, if \u03bc = f\u2217 En and \u03bd = g\u2217 En\n\n\fTHE EHRENPREIS CONJECTURE\n\n9\n\nand \u03bc and \u03bd are \u000f-equivalent, then we can find \u03c3 : En \u2192 En such that\nd(f (k), g(\u03c3(k))) \u2264 \u000f for each k \u2208 En . This holds when \u03bc and \u03bd are\nmeasures on any metric space (by the Hall's Marriage Theorem) and\nis even more elementary when the metric space is a 1-torus (that is a\ncircle) or an interval.\nWe observe that if \u03bc and \u03bd are \u000f1 -equivalent and \u03bd and \u03c1 are \u000f2 equivalent then \u03bc and \u03c1 are (\u000f1 + \u000f2 )-equivalent.\n\u221a\n\u221a\nLet \u03b3 \u2208 \u0393 and \u03b1 \u2208 M(N 1 ( \u03b3)). The bundle N 1 ( \u03b3) has the two\n\u221a\n\u221a\ncomponents N+1 ( \u03b3) and N\u22121 ( \u03b3) (the right-hand and left-hand side\ncomponents), each isometric to the circle of length hl(\u03b3). The restric\u221a\n\u221a\ntions of \u03b1 to N+1 ( \u03b3) and N\u22121 ( \u03b3) are denoted by \u03b1+ and \u03b1\u2212 respectively. In particular, by \u2202b+ \u03bc and \u2202b\u2212 \u03bc we denote the decomposition of\nb\nthe measure \u2202\u03bc.\n\u221a\nDefinition 2.2. Fix \u03b3 \u2208 \u0393, and let \u03b1, \u03b2 \u2208 M+ (N 1 ( \u03b3)). We say that\n\u03b1 and \u03b2 are \u03b4-equivalent if the pairs of measures \u03b1+ and \u03b2+ , and \u03b1\u2212 and\n\u221a\n\u03b2\u2212 , are respectively \u03b4-equivalent. Also, by \u03bb(\u03b3) \u2208 M+ (N 1 ( \u03b3)), we\ndenote the measure whose components \u03bb+ (\u03b3) and \u03bb\u2212 (\u03b3), are the stan\u221a\n\u221a\ndard Lebesgue measures on the metric spaces N 1 ( \u03b3)+ and N 1 ( \u03b3)\u2212 ,\nrespectively. In particular, the measure \u03bb(\u03b3) is invariant under the full\n\u221a\ngroup of isometries of N 1 ( \u03b3).\nLet \u000f, R > 0. By \u0393\u000f,R \u2282 \u0393 we denote the closed geodesics in the\nRiemann surface S whose half-length is in the interval [R \u2212 \u000f, R + \u000f].\nWe define \u03a0\u000f,R \u2282 \u03a0, as the set of immersed pants whose cuffs are in\n\u0393\u000f,R . We will often call \u0393\u000f,R the set of \"good curves\" and \u03a0\u000f,R the set\nof \"good pants\". Our aim is to prove the following theorem, which in\nturn yields the proof of Theorem 2.2 stated above.\nWe adopt the following convention. In the rest of the paper by P (R)\nwe denote a polynomial in R whose degree and coefficients depend only\non the choice of \u000f and the surface S.\nTheorem 2.3. Let \u000f > 0. There exists q > 0 (depending only on the\nsurface S and \u000f) so that for every R > 0 large enough, there exists a\nmeasure \u03bc \u2208 M+ (\u03a0\u000f,R ) with the following properties. Let \u03b3 \u2208 \u0393\u000f,R\nb\nb to N 1 (\u221a\u03b3). If \u2202\u03bc(\u03b3)\nb\nand let \u2202\u03bc(\u03b3)\ndenote the restriction of \u2202\u03bc\nis not\nthe zero measure then there exists a constant K\u03b3 > 0 such that the\nb\nmeasures \u2202\u03bc(\u03b3)\nand K\u03b3 \u03bb(\u03b3) are P (R)e\u2212qR -equivalent.\n\u221a\nRemark. We say that \u03b1 \u2208 M(N 1 ( \u03b3)) is \u03b4 symmetric (for \u03b4 > 0) if\n\u221a\n\u221a\nfor every isometry \u03b9 : N 1 ( \u03b3) \u2192 N 1 ( \u03b3) the measures \u03b1 and \u03b9\u2217 \u03b1 are\n\u03b4-equivalent. If \u03b1 and K\u03b3 \u03bb(\u03b3) are \u03b4-equivalent then \u03b1 is 2\u03b4 symmetric\nbecause \u03bb(\u03b3) is 0 symmetric.\n\n\f10\n\nKAHN AND MARKOVIC\n\nThe proof of Theorem 2.2 follows from Theorem 2.3 in the same way\nas it was done in Section 3 in [6]. The brief outline is as follows. We\nmay assume that the measure \u03bc from the above theorem has integer\ncoefficients. Then we may think of \u03bc as a formal sum of immersed pants\nb on any N 1 (\u221a\u03b3) is P (R)e\u2212qR such that the restriction of the measure \u2202\u03bc\nequivalent with some multiple of the Lebesgue measure (unless the\nrestriction is the zero measure). Considering \u03bc as the multiset (formally\none may use the notion of a labelled collection of immersed pants) we\ncan then define a pairing between marked immersed pants, such that\ntwo marked pants (\u03a01 , \u03b31 ) and (\u03a02 , \u03b32 ), are paired if \u03b31 = \u2212\u03b32 , and the\ncorresponding twist parameter between these two pairs is P (R)e\u2212pR\nclose to +1, for some universal constant p > 0. After gluing all the\nmarked pants we have paired we obtain the finite cover from Theorem\n2.2.\n3. Equidistribution and self-Correction\nWe introduce in this section the Equidistribution Theorem (Theorem 3.1) and the Correction Theorem (Theorem 3.4), and we use them\nto prove Theorem 2.3. Theorem 3.1 follows from our previous work [6],\nand provides us with an evenly distributed collection of good pants.\nThe Correction Theorem allows us to correct the slight imbalance (as\ndescribed in the introduction) that may be found in the original collection of pants.\n3.1. Generating essential immersed pants in S. Let us first describe how we generate a pair of pants from a \u0398-graph. Let \u03a0 denote a\npair of pants whose three cuffs have the same length, and let \u03c9 : \u03a0 \u2192 \u03a0\ndenote the standard (orientation preserving) isometry of order three\nthat permutes the cuffs of \u03a0. Let a and b be the fixed points of \u03c9.\nLet \u03b30 \u2282 \u03a0 denote a simple oriented geodesic arc that starts at a and\nterminates at b. Set \u03c9 i (\u03b30 ) = \u03b3i . The union of two different arcs \u03b3i\nand \u03b3j is a closed curve in \u03a0 homotopic to a cuff. One can think of\nthe union of these three segments as the spine of \u03a0. Moreover, there\nis an obvious projection from \u03a0 to the spine \u03b3 = \u03b30 \u222a \u03b31 \u222a \u03b32 , and this\nprojection is a homotopy equivalence.\nLet p and q be two (not necessarily) distinct points in S, and let \u03b10 ,\n\u03b11 , and \u03b12 , denote three distinct oriented geodesic arcs, each starting\nat p and terminating at q. We let \u03b1 = \u03b10 \u222a \u03b11 \u222a \u03b12 (we call \u03b1 a\n\u0398-graph). Let i(\u03b1j ) \u2208 Tp1 S and t(\u03b1j ) \u2208 Tq1 S denote the initial and\nterminal unit tangent vectors to \u03b1j at p and q respectively. Suppose\nthat the triples of vectors (i(\u03b10 ), i(\u03b11 ), i(\u03b12 )) and (t(\u03b10 ), t(\u03b11 ), t(\u03b12 )),\nhave opposite cyclic orders on the unit circle.\n\n\fTHE EHRENPREIS CONJECTURE\n\n11\n\nWe define the map f : \u03a0 \u2192 S by first projecting the pants \u03a0 onto\nits spine \u03b3, and then by mapping \u03b3j onto \u03b1j by a map that is a local\n(orientation preserving) homeomorphism. Then the induced conjugacy\nclass of maps f\u2217 : \u03c01 (\u03a0) \u2192 \u03c01 (S) is injective.\nMoreover we can homotop the map f to an immersion g : \u03a0 \u2192 S as\nfollows. We can write the pants \u03a0 as a (non-disjoint) union of three\nstrips G0 , G1 , G2 , where each Gi is a fattening of the geodesic arc \u03b3i .\nThen we define a map gi : Gi \u2192 S to be a local homeomorphism on\neach Gi by extending the restriction of the map f on \u03b3i . The condition\non the cyclic order of the \u03b1i 's at the two vertices enables us to define\ngi and gj on Gi and Gj respectively, so that gi = gj on Gi \u2229 Gj . Then\nwe set g = gi .\nWe say that g : \u03a0 \u2192 S is the essential immersed pair of pants\ngenerated by the three geodesic segments \u03b10 , \u03b11 and \u03b12 .\nOften we will be given two geodesic segments, say \u03b10 and \u03b11 , and\nthen find a third geodesic segment \u03b12 so to obtain an essential immersed\npair of pants. We then say that \u03b12 is a third connection. In this paper\nwe will often be given a closed geodesic C on a Riemann surface S,\nwith two marked points p, q \u2208 C. Then every geodesic arc \u03b1 between p\nand q, that meets p and q at the same sides of C will be called a third\nconnection, since then C and \u03b1 generate an immersed pair of pants\nas described above. In particular, this represents an efficient way of\ngenerating pants that contain a given closed geodesic C as its cuff.\n3.2. Preliminary lemmas. Let T 1 H2 denote the unit tangent bundle.\nElements of T 1 (H2 ) are pairs (p, u), where p \u2208 H2 and u \u2208 Tp1 H2 .\nSometimes we write u = (p, u) and refer to u as a unit vector in Tp1 H2 .\nBy T 1 S we denote the unit tangent bundle over S. For u, v \u2208 Tp1 H2 we\nlet \u0398(u, v) denote the unoriented angle between u and v. The function\n\u0398 takes values in the interval [0, \u03c0].\nFor L, \u000f > 0, and (p, u), (q, v) \u2208 T 1 S, we let Conn\u000f,L ((p, u), (q, v)) be\nthe set of unit speed geodesic segments \u03b3 : [0, l] \u2192 S such that\n\u2022 \u03b3(0) = p, and \u03b3(l) = q,\n\u2022 |l \u2212 L| < \u000f,\n\u2022 \u0398(u, \u03b3 0 (0)), \u0398(v, \u03b3 0 (l)) < \u000f.\nThe next lemma will be referred to as the Connection Lemma. It\nprovides a good lower bound on the size of the Connection set we have\njust defined. This lemma also follows from discussion in the appendix.\nLemma 3.1. Given \u000f > 0, we can find L0 = L0 (S, \u000f) such that for any \u0001\nL > L0 , and any two vectors (p, u) and (q, v), the set Conn\u000f,L (p, u), (q, v)\n\n\f12\n\nKAHN AND MARKOVIC\n\nis non-empty and\n\u0001\nConn\u000f,L (p, u), (q, v) \u2265 eL\u2212L0 .\nProof. The unit tangent bundle T 1 S is naturally identified with G\\PSL(2, R),\nwhere G is a lattice. By dis we denote a distance function on T 1 S (we\ndefined dis explicitly later in the paper). Then we can find a neighbourhood U of the identity in PSL(2, R) so that if (q, v) \u2208 T 1 S =\nG\\PSL(2, R), and \u03be \u2208 U , then dis((q, v), (q, v) * \u03be) < 16\u000f .\nWe letR \u03c8 : U \u2192 [0, \u221e) be a C \u221e function with compact support in\nU , with U \u03c8 = 1. For any (q, v) \u2208 T 1 S we let NU (q, v) = {(q, v) * s :\ns \u2208 U }, and let \u03c8(q,v) ((q, v) * s) = \u03c8(s) on NU (q, v). (If \u000f is small, then\ns 7\u2192 (q, v) * s is injective). The C k norm of \u03c8(q,v) is independent of\n(q, v).\nLet gt : T 1 S \u2192 T 1 S be the geodesic flow. By uniform mixing for\nuniformly C \u221e functions on S,\nZ\n(1)\n\u03c8(q,v) (gt (x, w))\u03c8(p,u) (x, w) d(x, w) \u2192 1,\nT 1S\n\nuniformly in (p, u) and (q, v), as t \u2192 \u221e (we always assume that the\nLiouville measure is normalized so that the total measure of the tangent\nbundle is one). If \u03c8(q,v) (gt (x, w))\u03c8(p,u) (x, w) > 0, then (x, w) \u2208 NU (p, u)\nand gt (x, w) \u2208 NU (q, v).\nThe segment g[0,t] (x, w) is \u000f-nearly homotopic (see the definition after\nthis proof) to a unique geodesic segment \u03b1 connecting p and q. The\nreader can verify that \u03b1 \u2208 Conn\u000f,t ((p, u), (q, v)). We let E\u03b1,t \u2282 NU (p, u)\nbe the set of (x, w) for which gt (x, w) \u2208 NU (q, v), and g[0,t] (x, w) is \u000fhomotopic to \u03b1. Then by (1),\nXZ\n\u03c8(q,v) (gt (x, w))\u03c8(p,u) (x, w) d(x, w) = 1 + o(1).\n\u03b1 E\n\u03b1,t\n\nOn the other hand, we can easily verify that V (E\u03b1,t ) \u2264 K(\u03c8)e\u2212t\n(here V (E\u03b1,t ) is the volume of E\u03b1,t ). Hence\nZ\n\nZ\n\u03c8(q,v) (gt (x, w))\u03c8(p,u) (x, w) d(x, w) \u2264\n\n(sup \u03c8)2 d(x, w)\nU\n\nE\u03b1,t\n\nE\u03b1,t\n\n\u2264 K(\u03c8)e\u2212t .\nSo the number of good \u03b1 is at least K(\u03c8)et , as long as t is large\ngiven S and \u000f.\n\u0003\n\n\fTHE EHRENPREIS CONJECTURE\n\n13\n\nDefinition 3.1. Let E \u2265 0. We say that two paths A and B in H2 are\nE-nearly homotopic if the distance between the endpoints of A and B is\nat most E. Two paths on the closed surface S are E-nearly homotopic\nif they have lifts to H2 that are E-nearly homotopic.\nThe following lemma gives the estimate for the number of good pants\nthat are bounded by a given (good) cuff.\nLemma 3.2. Let 0 < \u000f < 1. We let \u03b3 \u2208 \u0393\u000f,R and let \u03a0\u000f,R (\u03b3) denote\nthe set of pants in \u03a0\u000f,R that contain \u03b3 as a cuff. Then\n|\u03a0\u000f,R (\u03b3)| \u0010 ReR\nwhere the constant for \u0010 depends only on S and \u000f.\nProof. For the upper bound, let F\u03b3 denote a set of d2Re evenly distributed points on \u03b3. If \u03a0 \u2208 \u03a0\u000f,R and if \u03b3 \u2208 \u2202\u03a0, we let \u03b1 be the\ngeodesic segment in \u03a0 that is orthogonal to \u03b3 at its endpoints and simple on \u03a0. Then we let \u03b10 be a geodesic segment connecting two points of\nF\u03b3 , such that \u03b10 is 21 -nearly homotopic to \u03b1, and hence l(\u03b10 ) \u2264 l(\u03b1) + 1.\nIt can easily be verified that the length of \u03b1 is at most R + 9 thus the\nlength of \u03b10 is at most R + 10.\nWe leave it to the reader to verify that the number of geodesic segments of length at most L that connect two given points on the closed\nsurface S is at most eR+diam(S) / Area(S).\nIf two pants produce identical \u03b10 , then the two pants are the same.\nBetween any two points of F\u03b3 there are at most N eR such arcs \u03b10 (the\nconstant N depends only on S), and the endpoints of \u03b10 are R \u00b1 1\napart, so the total number of such arcs is at most 10N ReR .\nFor the lower bound: By Lemma 3.1 we can find N (S, \u000f)eR geodesic\nsegments \u03b1\nb connecting two given diametrically opposite points of \u03b3, of\n\u000f\nlength within 100\nof R + log 4, and such that the angle between \u03b1\nb and\n\u000f\n\u03c0\n\u03b3 is within 100 of 2 . Here we assume that the two vectors (at the two\ndiametrically opposite points) at \u03b3 that are tangent to \u03b1\nb are on the\n\u000f\nsame side of \u03b3. Then to any such \u03b1\nb there is an 10 -nearly homotopic \u03b1\nwith endpoints on \u03b3 (homotopic on S through arcs with endpoints on\n\u03b3) and such that \u03b1 is orthogonal to \u03b3. Each such \u03b1 produces a pair of\npants \u03a0 \u2208 \u03a0\u000f,R that contains \u03b3 as a cuff.\nDifferent \u03b1's give different pants. Two \u03b1\nb with the same \u03b1 must have\nnearby endpoints along \u03b3 and be 10\u000f-nearly homotopic. So we get at\nleast\n2RN (S, \u000f) R\ne\n10\u000f\nof the \u03b1's, and hence of the pants.\n\u0003\n\n\f14\n\nKAHN AND MARKOVIC\n\nRemark. Let M > 1 and let X\u03b3 (M ) denote the number of pants in\n\u03a0\u000f,R (\u03b3) whose two other cuffs are in \u0393 M\u000f ,R . Then X\u03b3 (M ) \u0010 ReR . The\nupper bound follows from the upper bound of the lemma. If the segment\n\u000f\nof 2R \u2212 hl(\u03b3) + log 4, and if that the angle\n\u03b1\nb is of length within 100M\n\u000f\nbetween \u03b1\nb and \u03b3 is within 100\nof \u03c02 , then the induced pants have the\ndesired property that the other two cuffs are in \u0393 M\u000f ,R . On the other\nhand it follows from the Connection Lemma that the number of such\n\u03b1\nb's is \u0010 to N (S, \u000f, M )eR for some constant N (S, \u000f, M ).\n3.3. The Equidistribution Theorem. The following is the Equidistribution Theorem. This is a stronger equidistribution result than the\none proved in our previous paper [6].\nTheorem 3.1. Let \u000f > 0. Let \u03bc be the measure on \u03a0\u000f,R that assigns to\neach pants in \u03a0\u000f,R the value 1. Then for R large enough the measure\n\u03bc has the following properties:\n(1) \u03bc(\u03a0\u000f,R ) \u0010 e3R .\n(2) For every \u03b3 \u2208 \u0393\u000f,R the measure \u2202b\u00b1 \u03bc(\u03b3) is Ce\u2212qR equivalent\nto K\u03b3\u00b1 \u03bb\u00b1 (\u03b3), for some constants K\u03b3+ and K\u03b3\u2212 that satisfy the\ninequality\nK\u03b3+\n\u2212 1 < Ce\u2212qR ,\nK\u03b3\u2212\nwhere C, q > 0 depend only on S and \u000f.\n(3) Moreover, K\u03b3\u00b1 \u0010 ReR for \u03b3 \u2208 \u0393\u000f,R .\nProof. The well know result of Margulis [7] asserts that\ne2R\n.\nR\nThe claim (1) of the theorem follows from this estimate and Theorem\n3.2. The claim (3) follows from the claim (2) and Lemma 3.2. Thus,\nit remains to prove (2). To prove (2) we need be able to estimate the\nnumber of good pants that bound gamma and whose feet belong to a\ngiven interval of \u03b3. Moreover, we need to show that the number of such\npants that are to the left of \u03b3 is very close to the number of such pants\nthat are to the right of \u03b3. We first explain how to effectively estimate\nthe two numbers.\nLet \u03b71 and \u03b72 be two geodesic arcs on S that connect the same\ntwo points on S. Denote by [*\u03b71 * \u03b72 *] the corresponding closed broken\ngeodesic on S (see the second paragraph of Section 4.1 for more on this\nnotation). We assume that \u03b71 and \u03b72 meet at the right angles and that\nwe can orient [*\u03b71 * \u03b72 *] so that both right turns are \"to the right\", or\nboth right turns are \"to the left\".\n\u0393\u000f,R \u0010\n\n\fTHE EHRENPREIS CONJECTURE\n\n15\n\nLet \u03b3 be the closed geodesic freely homotopic to [*\u03b71 * \u03b72 *]. Then we\ncan write\nl(\u03b3) = h(l(\u03b71 ), l(\u03b72 ))\nfor some smooth symmetric function h (where l denotes the length\nfunction), for which\nh(e1 , e2 ) = e1 + e2 \u2212 log 2 + O(e\u2212 min(e1 ,e2 )/2 ).\n(the function h can be computed explicitly from the basic formulas in\nhyperbolic geometry).\nSuppose that \u03b3 is a (good) closed geodesic on S, and suppose that \u03b7\nis a \"third connection\" for \u03b3. So \u03b7 is a geodesic segment which meets\n\u03b3 at two points x and y, and is orthogonal to \u03b3 at x and y, and lies on\nthe same side of \u03b3 at both points: the two normal vectors to \u03b3 pointing\ninto \u03b7 at x and y are on the same component of N 1 (\u03b3). Then there\nis a unique pair of pants \u03a0 for which \u03b3 \u2208 \u2202\u03a0, and for which \u03b7 is an\northogeodesic on \u03a0 that lifts to be embedded in \u03a0. Letting \u03c31 and \u03c32\nbe the two segments of \u03b3 \\ {x, y}, we find that the two other cuffs \u03b31 , \u03b32\nof \u03a0 are freely homotopic to [*\u03c3i * \u03b7 \u00b11 *]. So we have\nl(\u03b3i ) = h(l(\u03b7), l(\u03c3i ))\nwhere h is defined as above. Moreover, the two feet of \u03a0 on \u03b3 lie at\nthe two midpoints of x and y on \u03b3. (Really, we should think of x and y\nas lying on the parameterizing 1-torus for \u03b3, and likewise the feet, but\nwe will say that they're on \u03b3, by a mild abuse of notation).\n\u221a\nSuppose that I \u2282 N 1 ( \u03b3) is an interval. So I comprises a choice of\ncomponent of N 1 (\u03b3)-a side of \u03b3-along with a pair of intervals in \u03b3,\nof equal length and placed halfway along \u03b3 from each other. We should\nthink of \u03b3 as long, say longer than 10, and I as short, say shorter than\n1/10.\nWe define the region\nR(\u03b3, I) \u2282 \u03b3 \u00d7 \u03b3 \u00d7 R+\nas the set of (x, y, l) for which\nh(l, si ) \u2208 [2R \u2212 2\u000f, 2R + 2\u000f]\nand for which the two midpoints of x and y lie in the two intervals\non \u03b3 associated to I. Here s1 , s2 are the lengths of the two arcs in \u03b3\nbetween x and y. Then suppose \u03b7 is a third connection for \u03b3 and that\n\u03b7 lies on the same side of \u03b3 as I does. Let x and y be the endpoints\nof \u03b7, and let \u03a0\u03b7 be the associated pair of pants for \u03b7 (and \u03b3). Then\n(x, y, l(\u03b7)) \u2208 R(\u03b3, I) if and only if \u03a0\u03b7 is a good pair of pants, and the\n\u221a\npair of feet of \u03a0\u03b7 on N 1 ( \u03b3) lies in I. Thus, the number of good pants\n\n\f16\n\nKAHN AND MARKOVIC\n\nwhose feet belong to the interval I is equal to the number of third\nconnections \u03b7 (on a given side of \u03b3) for which the associated triple\n(x, y, l(\u03b7)) lies in R(\u03b3, I). So our goal is simply to count the number\nof third connections \u03b7 (on a given side of \u03b3) for which the associated\ntriple (x, y, l(\u03b7)) lies in R(\u03b3, I).\nOne can see that the volume of R(\u03b3, I) is on the order of \u000f2 |I| as\nfollows. For any choice of a point in I, x and y are determined by s0 ,\nand possible pairs (l, s0 ) lie in a diamond of size about \u000f. Since the\narea of the diamond is about \u000f2 it follows that the volume of R(\u03b3, I)\nis about \u000f2 |I|.\nIf we denote by C\u03b3 the set of associated triples (x, y, l(\u03b7)) for all third\nconnections \u03b7, our goal is simply to count C\u03b3 \u2229 R(\u03b3, I). The following\ncounting formula is the main ingredient we need to finish the proof.\nLet A and B be two oriented geodesic segments on S of lengths a > 0\nand b > 0 respectively and let 0 < L0 < L1 . Define\nConnA,B (L0 , L1 )\nto be the set of geodesic connections between A and B. That is, \u03b7 \u2208\nConnA,B (L0 , L1 ) if \u03b7 is a geodesic segment on S of length at least L0\nand at most L1 such that \u03b7 connects the right side of A and the left\nside of B and is orthogonal to the arcs A and B (\u03b7 is an orthogeodesic\nconnecting the appropriate sides of A and B). The following theorem\nis stated and proved in the Appendix as Theorem 11.3.\nTheorem 3.2. There exist constants C = C(S), q = q(S) > 0 with the\nfollowing properties. Let \u03b4 = e\u2212qL , and suppose a = b = \u03b4 2 . Then\n\u0001\n1\n#ConnA,B (L, L + \u03b4 2 ) = 2\n\u03b4 6 eL 1 + O(\u03b4) .\n8\u03c0 \u03c7(S)\nThis type of counting result appears often in literature (for example\nsee [4] [8]) and it goes back to Margulis [7].\nNow let Q be any cube of the form J1 \u00d7 J2 \u00d7 [L0 , L1 ] \u2282 \u03b3 \u00d7 \u03b3 \u00d7 R+ ,\nwith |J1 | = |J2 | = L1 \u2212 L0 = \u03b4 2 (and suppose L0 , L1 are about R which\nis large). Then Theorem 3.2 implies\n\u0001\n#(Q \u2229 C\u03b3 ) = ES \u03b4 6 eL 1 + O(\u03b4)\nZ\n= (1 + O(\u03b4)) ES eL dx dy dL,\nQ\n\nwhere\nES =\n\n1\n8\u03c0 8 |\u03c7(S)|\n\n.\n\n\fTHE EHRENPREIS CONJECTURE\n\n17\n\nIt follows that for any region R \u2282 \u03b3 \u00d7 \u03b3 \u00d7 [R \u2212 1, R + 1] tiled by\nsuch cubes\nZ\n\u0001\n#(R \u2229 C\u03b3 ) = 1 + O(\u03b4)\nES eL dx dy dL\nR\n\nand, more generally, for any region R \u2282 \u03b3 \u00d7 \u03b3 \u00d7 [R \u2212 1, R + 1]\n!\nZ\nZ\n\u0001\n#(R\u2229C\u03b3 ) = 1+O(\u03b4)\nES eL dx dy dL \u00b1\nES eL dx dy dL ,\nR\n\nN3\u03b42 (\u2202R\n\nwhere N3\u03b42 (\u2202R) is the neighbourhood of \u2202R. (Here A \u00b1 B means a\nnumber in [A \u2212 B, A + B]).\nNow let R = R(\u03b3, I) and we assume that \u000f \u2265 |I| > \u03b4. Then\n\u0001\n\u0001\nVol N3\u03b42 (R) \u2248 \u000f2 \u03b4 2 = O \u03b4Vol(R) .\nTherefore\n\u0001\n#(R \u2229 C\u03b3 ) = 1 + O(\u03b4)\n\nZ\n\nES eL dx dy dL \u2248 eR \u000f2 |I|.\n\nR\n\nOn the other hand,\nZ\n\nES eL dx dy dL = K\u03b3 |I|,\n\nR(\u03b3,I)\n\nfor some K\u03b3 > 0 because the integral clearly depends only on |I| and\nZ\nZ\nZ\n*=\n*+\n*\nR(\u03b3,I)\n\nR(\u03b3,I1 )\n\nR(\u03b3,I2 )\n\nwhere I1 , I2 is a partition of I.\nTherefore\n\u0001\n#(R(\u03b3, I) \u2229 C\u03b3 ) = K\u03b3 |I| 1 + O(\u03b4)\nfor every interval I of length at least \u03b4, and the claim (2) of the theorem\nfollows.\n\u0003\n3.4. The Good Correction Theorem. To prove Theorem 2.3 we\nneed to produce a measure \u03bc on good pants such that for each good\nb\ngeodesic \u03b3, \u2202\u03bc(\u03b3)\nis P (R)e\u2212qR -equivalent to some K\u03b3 \u03bb(\u03b3), where \u03bb is\nb\nthe Lebesgue measure on N 1 (\u03b3). In particular, \u2202\u03bc(\u03b3)\nmust have the\nsame total measure on both sides of \u03b3. In other words there must be\nthe same number of pants on both sides of \u03b3. We can write this as\n\u2202\u03bc(\u03b3) = 0.\n\n\f18\n\nKAHN AND MARKOVIC\n\nNow let us construct the measure \u03bc0 on good pants as the counting\nb\nmeasure on the good pair of pants. Theorem 3.1 says that \u2202\u03bc(\u03b3)\nis\n\u2212qR\n\u00b1\nCe\nequivalent to K \u03bb\u00b1 (\u03b3), with\nK\u03b3+\n\u2212 1 < Ce\u2212qR .\nK\u03b3\u2212\nSo we have the desired equidistribution on each side of \u03b3, and we have\na small discrepancy between the number of pants on the two sides of \u03b3.\nWhat we want to do is to make a small change in the number of each\npair of good pants in order to correct the discrepancy. So we want to\nreplace \u03bc0 with \u03bc0 + X where \u2202X = \u2212\u2202\u03bc0 , and X is small compared\nto \u03bc0 .\nTo do this we consider the more general problem of finding X such\nthat\n(2)\n\n\u2202X = \u03b1,\n\nand ask two questions:\n1. For which \u03b1 can we solve (2)?\n2. What bound can we get on the size of X given a suitable bound\non the size of \u03b1?\nIt turns out that we can get fairly sharp answers for both questions.\nFirst, if \u2202X = \u03b1, then \u03b1 \u2261 0 in H1 (S); we will prove that we can\nalways solve \u2202X = \u03b1 when \u03b1 is zero in singular homology. Second, if\n\u03b3 is a single good closed geodesic, and \u2202X = \u03b3, then\ne \u2265 1,\n|X|({\u03a0 : \u03b3 \u2208 \u2202\u03a0}\nand therefore\n\n1\n.\nReR\nWe prove that we can solve \u2202X = \u03b1 such that\n||X||\u221e \u2265\n\n||X||\u221e \u2264 P (R)e\u2212R ||\u03b1||\u221e\nfor some polynomial P (R) depending on S and \u000f. These two results are\nstated essentially as Theorems 3.4, 3.5, and the proof of these theorems\nwill be the object of the remainder of this paper.\nHaving proven these theorems, we can correct the discrepancy and\nprove Theorem 2.3.\nWe let \u03bc1 = \u03bc0 + X, where \u2202X = \u2212\u2202\u03bc0 , and\n||X||\u221e \u2264 P (R)e\u2212R ||\u2202\u03bc0 ||\u221e\n\u2264 P (R)e\u2212R e(1\u2212q(S))R\n<< 1.\n\n\fTHE EHRENPREIS CONJECTURE\n\n19\n\nThen \u03bc1 is a positive sum of good pants, has the same number of pants\nof both sides of every closed geodesic, and has the same equidistribution\nproperty as \u03bc0 because it is a small perturbation. Therefore it satisfies\nthe conclusions of Theorem 2.3, and we can use it to build a good cover.\nRecall that if A is an Abelian group and X any set then AX is the\ngroup of A-weighted finite formal sums of elements from X.\nDefinition 3.2. Let s0 , s1 \u2208 R\u0393\u000f,R and let M \u2265 1. We say that s0 = s1\nin \u03a0M \u000f,R homology if there exists W \u2208 R\u03a0M \u000f,R such that \u2202W = s1 \u2212s0 .\nThe following theorem summarizes the main idea of this paper. It\nimplies that every sum of good curves that is zero in the standard\nhomology is the boundary of a sum of good pants. That is, if s0 , s1 \u2208\nR\u0393\u000f,R and s0 = s1 in the standard homology on the surface S, then\ns0 = s1 in \u03a0300\u000f,R homology. By H1 (S) we denote the first homology\non S with rational coefficients.\nTheorem 3.3. Let \u000f > 0. There exists R0 = R0 (S, \u000f) > 0 such\nthat for every R > R0 the following holds. There exists a set H =\n{h1 , ..., h2g } \u2282 Q\u0393\u000f,R that form a basis of H1 (S), such that for every\n\u03b3 \u2208 \u0393\u000f,R there are ai \u2208 Z so that\n\u03b3=\n\n2g\nX\n\nai hi\n\ni=1\n\nin \u03a0300\u000f,R homology.\nRemark. Observe that if \u03b3 = 0 in H1 (S) then \u03b3 = 0 \u03a0300\u000f,R homology.\nThe proof of this theorem occupies the primary text of sections 49. But to prove the Ehrenpreis conjecture we require the following\nstronger result.\nTheorem 3.4. Let \u000f > 0. There exists R0 > 0 (that depend only on S\nand \u000f) such that for every R > R0 there exists a set H = {h1 , ..., h2g } \u2282\nQ\u0393\u000f,R and a map \u03c6 : \u0393\u000f,R \u2192 Q\u03a0300\u000f,R such that\n(1) h1 , ..., h2g is a basis for H1 (S),\n(2) \u2202(\u03c6(\u03b3)) \u2212 \u03b3 \u2208 ZH,\n(3)\nX\n|\u03c6(\u03b3)(\u03a0)| < P (R)e\u2212R ,\n\u03b3\u2208\u0393\u000f,R\n\nfor every \u03a0 \u2208 \u03a0300\u000f,R , where the polynomial P (R) depends only\non S and \u000f.\nRemark. Note that the map \u03c6 depends on \u000f and R, so sometimes we\nwrite \u03c6 = \u03c6\u000f,R .\n\n\f20\n\nKAHN AND MARKOVIC\n\nRemark. An inequality of the form\nX\n|q(\u03b3)(\u03a0)| \u2264 A\n\u03b3\u2208\u0393\u000f,R\n\nis equivalent to saying\n||q(\u03b1)||\u221e \u2264 A||\u03b1||\u221e\nfor all \u03b1 \u2208 Q\u0393\u000f,R .\ne \u2202e = \u2202.\ne\nRemark. Observe that (1) and (2) imply that \u2202\u03c6\nThe existence of the function \u03c6 that satisfies the conditions (1) and\n(2) follows from Theorem 3.3. The condition (3) will be proved using\nour randomization theory (see Appendix 1). As we go along, after every relevant homological statement we make Randomization remarks.\nTheorem 3.4 then follows from these randomization remarks as we explain at the end of Section 9.\nRemark. The estimate (3) in the statement of the theorem can be\nreformulated as follows. Consider the standard measures \u03c3\u0393 on \u0393\u000f,R\nand \u03c3\u03a0 on \u03a0300\u000f,R . Then the map \u03c6 is P (R)-semirandom with respect\nto \u03c3\u0393 and \u03c3\u03a0 . See the Appendix for definitions of the standard measures\nand the notion of semirandom maps.\nThe image of \u03c6 lies in \u03a0300\u000f,R , and we want it to lie in \u03a0\u000f,R , so we\nrequire the following:\nLet M > 1. The following lemma states that any curve \u03b3 \u2208 \u0393\u000f,R is\nhomologous to some s \u2208 R\u0393 M\u000f ,R in \u03a0\u000f,R homology.\nLemma 3.3. Let \u000f, M > 0. Then there exists R0 > 0 such that for\nevery R > R0 we can find a map qM = q : \u0393\u000f,R \u2192 Q+ \u03a0\u000f,R such that\n(1) For every \u03b3 \u2208 \u0393\u000f,R , q(\u03b3) is a positive sum of pants, all of which\nhave \u03b3 as one boundary cuff (with the appropriate orientation),\nand two other cuffs in \u0393 M\u000f ,R , and \u03b3 \u2212 \u2202q(\u03b3) \u2208 Q\u0393 M\u000f ,R ,\n(2) For every \u03a0 \u2208 \u03a0\u000f,R , we have\nX\nK\n|q(\u03b3)(\u03a0)| \u2264 e\u2212R ,\nR\n\u03b3\u2208\u0393\n\u000f,R\n\nfor some constant K \u2261 K(S, \u000f, M ) > 0, where q(\u03b3)(\u03a0) \u2208 Q+ is\nthe coefficient of \u03a0 in q(\u03b3).\nProof. It follows from the remark after Lemma 3.2 that the number of\npants which have \u03b3 as one boundary cuff, and two other cuffs in \u0393\u000f, R is\nM\nof the order ReR . Let q(\u03b3) be the average of these pants (the average of\na finite set S is the formal sum of elements from S where each element\n\n\fTHE EHRENPREIS CONJECTURE\n\n21\n\n1\nin the sum has the weight |S|\n). The inequality in the condition (2)\nfollows from the fact that for any \u03a0 \u2208 \u03a01,R the sum\nX\n|q(\u03b3)(\u03a0)|,\n\u03b3\u2208\u0393\u000f,R\n\nhas at most 3 non-zero terms.\n\u0003\nWe can now state the following improved version of Theorem 3.4.\nThis new theorem is exactly the same as the previous one except that\nthe new function \u03c6, which is denoted by \u03c6new , maps \u0393\u000f,R to Q\u03a0\u000f,R\nwhereas the old \u03c6 maps \u0393\u000f,R to Q\u03a0300\u000f,R .\nTheorem 3.5. Let \u000f > 0. There exists R0 > 0 (that depend only on S\nand \u000f) such that for every R > R0 there exists a set H = {h1 , ..., h2g } \u2282\nQ\u0393\u000f,R and a map \u03c6new : \u0393\u000f,R \u2192 Q\u03a0\u000f,R such that\n(1) h1 , ..., h2g is a basis for H1 (S),\n(2) \u2202(\u03c6new (\u03b3)) \u2212 \u03b3 \u2208 ZH,\n(3)\nX\n|\u03c6new (\u03b3)(\u03a0)| < P (R)e\u2212R .\n\u03b3\u2208\u0393\u000f,R\n\nwhere the polynomial P (R) depends only on S and \u000f.\nProof. We extend the function \u03c6 to R\u0393\u000f,R by linearity. For \u03b3 \u2208 \u0393\u000f,R we\nlet\n\u03c6new (\u03b3) = \u03c6(\u03b3 \u2212 \u2202q(\u03b3)) + q(\u03b3),\nwhere \u03c6 is from the previous theorem and q = q300 is the improvement\nfunction from Lemma 3.3. Then since H is a generating set for H1 (S) it\nfollows that \u2202(\u03c6new (\u03b3)) = \u2202(\u03c6(\u03b3)) and thus we obtain \u2202(\u03c6new (\u03b3)) \u2212 \u03b3 \u2208\nZH. It remains to verify the inequality (3) of the theorem.\nFor each \u03a0 \u2208 \u03a0\u000f,R we have\nX\nX\nX\n(3)\n\u03c6new (\u03b3)(\u03a0) \u2264\nq(\u03b3)(\u03a0) +\n\u03c6(\u03b3 \u2212 \u2202q(\u03b3))(\u03a0) .\n\u03b3\n\n\u03b3\n\n\u03b3\n\nOn the other hand, for each \u03b7 \u2208 \u0393\u000f,R we have the inequality\nX\n\u2202q(\u03b3)(\u03b7) \u2264 C1 ,\n\u03b3\n\nfor some universal constant C1 > 0. In other words, the total weight\nof \u03b7 in the formal sum of curves\nX\n\u2202q(\u03b3) \u2208 Q\u0393\u000f,R\n\u03b3\n\n\f22\n\nKAHN AND MARKOVIC\n\nis at most C1 . This follows from the last inequality of Lemma 3.3 and\nLemma 3.2.\nThus, we have\nX\nX\nX\n\u03c6(\u03b3 \u2212 \u2202q(\u03b3))(\u03a0) \u2264\n\u03c6(\u03b3)(\u03a0) + C1\n\u03c6(\u03b3)(\u03a0) .\n\u03b3\n\n\u03b3\n\n\u03b3\n\nWe replace this inequality in (3) and the theorem follows.\n\u0003\nOf course \u03c6new extends linearly to Q\u0393\u000f,R .\nWe observe that if \u03b3 is zero in H1 (S) then \u2202\u03c6new (\u03b3) is equal to\n\u03b3 because \u2202(\u03c6new (\u03b3)) \u2212 \u03b3 \u2208 ZH and \u2202(\u03c6new (\u03b3)) differs from \u03b3 by a\nboundary. In particular, for any \u03bc \u2208 Q\u03a0\u000f,R the equality\n\u2202\u03c6new \u2202\u03bc = \u2202\u03bc\nholds.\n3.5. A proof of Theorem 2.3. First we state and prove the following\nlemma about equivalent measures on the circle R/2RZ, where R > 0 is\na parameter. Recall that \u03bb denotes the Lebesgue measure on the circle\nR/2RZ.\nLemma 3.4. If \u03b1 is \u03b4-equivalent to K\u03bb on R/2RZ, for some K > 0,\n|\u03b2|\n+ \u03b4)-equivalent to\nand \u03b2 is a measure on R/2RZ, then \u03b1 + \u03b2 is ( 2K\n|\u03b2|\n(K + 2R )\u03bb on R/2RZ.\nProof. Recall the definition of \u03b4-equivalent measures from the previous\n|\u03b2|\nsection. We need to prove that (\u03b1 + \u03b2)(I) \u2264 (K + 2R\n)|N\u03b40 (I)|, where\n|\u03b2|\n0\n0\n\u03b4 = \u03b4 + 2K , for any interval I such that \u03b4 neighbourhood of I is a\nproper subset of the circle R/2RZ.\nWe have\n(\u03b1 + \u03b2)(I)\u2264K(|I| + 2\u03b4) + |\u03b2|\n\u0012\n\u0013\u0012\n\u0013\n|\u03b2|\n|\u03b2|\n\u2264 K+\n|I| + 2\u03b4 +\n2R\nK\n\u0012\n\u0013\n|\u03b2|\nN\u03b40 (I) .\n= K+\n2R\n\u0003\n\n\u221a\nWe give the following definitions. To any measure \u03b1 \u2208 M(N 1 ( \u03b3))\nwe associate the number |\u03b1|(\u03b3) = |\u03b1+ (\u03b3)| + |\u03b1\u2212 (\u03b3)|.\nWe proceed with the proof of Theorem 2.3. Let \u03bc be the measure\non \u03a0\u000f,R from Theorem 3.1. Define the measure \u03bc1 on \u03a0\u000f,R by letting\n\n\fTHE EHRENPREIS CONJECTURE\n\n23\n\n\u03bc1 = \u03bc \u2212 \u03c6(\u2202\u03bc), where \u03c6 = \u03c6new is from Theorem 3.5. We show that\n\u03bc1 is the measure that satisfies the conclusions of Theorem 2.3.\nb 1 (\u03b3) is\nAs observed before \u2202\u03bc1 = 0. It remains to show that \u2202\u03bc\nP (R)e\u2212qR equivalent to some multiple of the Lebesgue measure on\n\u221a\nN 1 ( \u03b3). Recall from Theorem 3.1 that the measure \u2202b\u00b1 \u03bc(\u03b3) is Ce\u2212qR\nequivalent to K\u03b3\u00b1 \u03bb\u00b1 (\u03b3), for some constants K\u03b3+ and K\u03b3\u2212 that satisfy\nthe inequality\nK\u03b3+\n(4)\n\u2212 1 < Ce\u2212qR ,\nK\u03b3\u2212\nand that K\u03b3\u00b1 \u0010 ReR . Then for all \u03b3, from (4) we get\n\u2202\u03bc(\u03b3) \u2264 CRe(1\u2212q)R ,\nwhich together with Theorem 3.5 yields the inequality\n|\u03c6(\u2202\u03bc)|(\u03a0) \u2264 P (R)e\u2212qR ,\nfor each pair of pants \u03a0, and we obtain\nb\n|\u2202\u03c6(\u2202\u03bc)|(\u03b3)\n\u2264 P (R)e(1\u2212q)R ,\nb 1 (\u03b3)\nfor all \u03b3. Since K\u03b3\u00b1 \u0010 ReR we conclude from Lemma 3.4 that \u2202\u03bc\nis P (R)e\u2212qR equivalent to some multiple of the Lebesgue measure \u03bb(\u03b3)\n\u221a\non N 1 ( \u03b3), and we are done.\n4. The theory of inefficiency\nIn this section we develop the theory of inefficiency. This theory\nsupports the geometric side of the correction theory that is used to\nprove our main technical result the Good Correction Theorem.\nBefore we begin with the estimates of this section, we will provide\na brief overview of the remainder of this paper. Our goal is to prove\nidentities in the good pants homology, which means that we need to\ngenerate a formal sum of good pants whose boundary is a certain given\nformal sum of good curves. How do we generate a pair of good pants?\nWe generate a pair of good pants by constructing a \u0398-graph made\nout of geodesic segments; the Connection Lemma insures that we have\nenough geodesic segments with the desired properties, and the Theory\nof Inefficiency allows us to estimate the length of the cuffs of the associated pair of pants in terms of the length of the geodesic segments\nand the angle at which they meet.\nIn every identity we prove in the good pants homology we will state\nout hypothesis in terms of the Theory of Inefficiency, and every time\nwe estimate the length of a geodesic segment or a closed geodesic we\nwill use this theory as well.\n\n\f24\n\nKAHN AND MARKOVIC\n\n4.1. The inefficiency of a piecewise geodesic arc. By T 1 H2 we\ndenote the unit tangent bundle of H2 . Elements of T 1 H2 are pairs\n(p, u), where p \u2208 H2 and u \u2208 Tp1 H2 . For u, v \u2208 Tp1 H2 we let \u0398(u, v)\ndenote the unoriented angle between u and v. Let \u03b1 : [a, b] \u2192 H2 be a\nunit speed geodesic segment. We let i(\u03b1) = \u03b10 (a), and t(\u03b1) = \u03b10 (b).\nLet \u03b11 , ..., \u03b1n denote oriented piecewise geodesic arcs on S such that\nthe terminal point of \u03b1i is the initial point of \u03b1i+1 . By \u03b11 \u03b12 ...\u03b1n we\ndenote the concatenation of the arcs \u03b1i . If the initial point of \u03b11 and\nthe terminal point of \u03b1n are the same, by [\u03b11 \u03b12 ...\u03b1n ] we denote the\ncorresponding closed curve.\nWe define the inefficiency operator as follows. We first discuss the\ninefficiency of piecewise geodesic arcs and after that the inefficiency of\npiecewise geodesic closed curves.\nDefinition 4.1. Let \u03b1 be an arc on a surface. By \u03b3 we denote the\ngeodesic arc with the same endpoints and homotopic to \u03b1. We let\nI(\u03b1) = l(\u03b1) \u2212 l(\u03b3). We call I(\u03b1) the inefficiency of \u03b1 (the inefficiency\nI(\u03b1) is equal to 0 if and only if \u03b1 is a geodesic arc).\nWe observe the monotonicity of inefficiency. Let \u03b1, \u03b2, \u03b3 \u2282 H2 be\nthree piecewise geodesic arcs in H2 such that \u03b1\u03b2\u03b3 is a well defined\npiecewise geodesic arc. Then I(\u03b1\u03b2\u03b3) \u2265 I(\u03b2). This is seen as follows.\nLet \u03b7 be the geodesic arc with the same endpoints as \u03b1\u03b2\u03b3, and let \u03b2 0\nbe the geodesic arc with the same endpoints as \u03b2. Then\nI(\u03b1\u03b2\u03b3) = l(\u03b1\u03b2\u03b3) \u2212 l(\u03b7)\n\u2265 l(\u03b1\u03b2\u03b3) \u2212 l(\u03b1\u03b2 0 \u03b3)\n= l(\u03b2) \u2212 l(\u03b2 0 )\n= I(\u03b2).\nWe also define the inefficiency function of an angle \u03b8 \u2208 [0, \u03c0] as\nfollows. Let \u03b1\u221e and \u03b2\u221e be two geodesic rays in H2 that have the\nsame initial point, such that \u03b8 is the exterior angle between \u03b1\u221e and\n\u22121\n\u03b2\u221e (then \u03b8 is also the bending angle of the piecewise geodesic \u03b1\u221e\n\u03b2\u221e ).\n\u22121\nWe want to define I(\u03b8) as the inefficiency of \u03b1\u221e \u03b2\u221e , but since the\n\u22121\npiecewise geodesic \u03b1\u221e\n\u03b2\u221e is infinite in length we need to prove that\nsuch a definition is valid.\nConsider a geodesic triangle in H2 with sides A, B and C, and let\n\u03b8 > 0 be the exterior angle opposite to C (we also let l(A) = A,\nl(B) = B, l(C) = C). Then\ncosh C = cosh A cosh B + cos \u03b8 sinh A sinh B,\n\n\fTHE EHRENPREIS CONJECTURE\n\n25\n\nand therefore\ncosh C\ncosh A cosh B\nsinh A sinh B\n=\n+ cos \u03b8 A\n.\nA+B\nA\nB\ne\ne\ne\ne\neB\nWe conclude that\ncosh C\n1\n\u2192 (cos \u03b8 + 1),\nA+B\ne\n4\nwhen A, B \u2192 \u221e. Since\ncosh C\n1\n, C \u2192 \u221e,\n\u2192\neC\n2\nwe get\n\u0012\n\u00132\n\u03b8\nC\u2212A\u2212B\n\u2192 cos\ne\n,\n2\nand therefore\n\u03b8\nA + B \u2212 C \u2192 2 log sec .\n2\nLet r, s > 0 and let \u03b1r be the geodesic subsegment of \u03b1\u221e (with the\nsame initial point) of length r. Similarly, \u03b2s is a geodesic subsegment\nof \u03b2\u221e of length s. Then we let\n\u22121\nI(\u03b8) = I(\u03b1\u221e\n\u03b2\u221e ) = lim I(\u03b1r\u22121 \u03b2s ).\nr,s\u2192\u221e\n\nIt follows from the above discussion that this limit exists and\n\u03b8\n(5)\nI(\u03b8) = 2 log sec .\n2\n4.2. Preliminary lemmas. We have the following lemma.\nLemma 4.1. Let \u03b1 denote an arc on S, and let \u03b3 be the appropriate\ngeodesic arc with the same endpoints as \u03b1 and homotopic to \u03b1. Choose\nlifts of \u03b1 and \u03b3 in the universal cover H2 that have the same endpoints\nand let \u03c0 : \u03b1 \u2192 \u03b3 be the nearest point projection. Let\nE(\u03b1) = sup d(x, \u03c0(x)).\nx\u2208\u03b1\n\nThen\n\nI(\u03b1)\n+ log 2.\n2\nProof. Let E > 0. The minimally inefficient arc \u03b1 (that has the same\nendpoints as \u03b3 and is homotopic to \u03b3), that is at the distance E from \u03b3\nis given in Figure 1. Here \u03b3 is divided into two sub-segments of length\nL\u2212 and L+ . Let A\u2212 = l(\u03b1\u2212 ) and A+ = l(\u03b1+ ). By the monotonicity of\ninefficiency, and using the inefficiency for angles, we have\n\u03c0\nE + L\u2212 \u2212 A\u2212 < I( ),\n2\nE(\u03b1) \u2264\n\n\f26\n\nKAHN AND MARKOVIC\n\n\u03b1+\n\n\u03b1\u2212\nE\nL+\n\nL\u2212\n\nFigure 1. The case where \u03b3 is an arc\nand\n\n\u03c0\nE + L+ \u2212 A+ < I( ).\n2\n\nSumming up yields\nE<\n\nI(\u03b1)\n\u03c0\nI(\u03b1)\n+ I( ) =\n+ log 2,\n2\n2\n2\n\nsince by (5) we have I( \u03c02 ) = log 2.\n\u0003\nThe following is the New Angle Lemma.\nLemma 4.2 (New Angle Lemma). Let \u03b4, \u2206 > 0 and let \u03b1\u03b2 \u2282 H2\nbe a piecewise geodesic arc, where \u03b1 is piecewise geodesic arc and \u03b2\nis a geodesic arc. Suppose that \u03b3 is the geodesic arc with the same\nendpoints as \u03b1\u03b2. There exists L = L(\u03b4, \u2206) > 0 such that if l(\u03b2) > L\nand I(\u03b1\u03b2) \u2264 \u2206 then the unoriented angle between \u03b3 and \u03b2 is at most\n\u03b4.\nProof. Denote by \u03b8 the angle between \u03b3 and \u03b2, and let h be the distance\nbetween the other endpoint of \u03b2 and \u03b3. Then\nsinh(h)\n= sinh(l(\u03b2)).\nsin(\u03b8)\nThe lemma follows from this equation and the fact that h is bounded\nin terms of I(\u03b1\u03b2) (see Lemma 4.1).\n\u0003\nWe also have\n\n\fTHE EHRENPREIS CONJECTURE\n\n27\n\nLemma 4.3. Suppose that \u03b1\u03b2\u03b3 is a concatenation of three geodesic\narcs in H2 , and let \u03b8\u03b1\u03b2 and \u03b8\u03b2\u03b3 be the two bending angles. Suppose that\n\u03b8\u03b1\u03b2 , \u03b8\u03b2\u03b3 < \u03c02 . Then\nI(\u03b1\u03b2\u03b3) \u2264 log(sec(\u03b8\u03b1\u03b2 )) + log(sec(\u03b8\u03b2\u03b3 )).\nProof. Let \u03b71 be the geodesic that is orthogonal to \u03b2 at the point where\n\u03b1 and \u03b2 meet. Similarly let \u03b72 be the geodesic that is orthogonal to \u03b2 at\nthe point where \u03b2 and \u03b3 meet. Let A\u03b1 be the geodesic arc orthogonal\nto \u03b71 that starts at the initial point of \u03b1, and let A\u03b3 be the geodesic\narc orthogonal to \u03b72 that starts at the terminal point of \u03b3.\nLet \u03b7 be the geodesic arc with the same endpoints as \u03b1\u03b2\u03b3. Then\nl(\u03b7) \u2265 l(A\u03b1 ) + l(\u03b2) + l(A\u03b3 ).\nOn the other hand, from the hyperbolic low of sines, we have\nsinh A\u03b1 = sinh \u03b1 * cos(\u03b8\u03b1\u03b2 ,\nand hence\nlog sinh \u03b1 \u2212 log sinh A\u03b1 \u2264 log sec \u03b8\u03b1\u03b2 ,\nwhich implies\n\u03b1 \u2212 A\u03b1 \u2264 log sec \u03b8\u03b1\u03b2 ,\nbecause the derivative of log sinh is greater than one. Thus, we have\nproved that l(A\u03b1 ) > l(\u03b1) \u2212 log(sec(\u03b8\u03b1\u03b2 )), and similarly l(A\u03b3 ) > l(\u03b3) \u2212\nlog(sec(\u03b8\u03b2\u03b3 )). So\nI(\u03b1\u03b2\u03b3) < l(\u03b1) + l(\u03b3) \u2212 l(A\u03b1 ) \u2212 l(A\u03b3 )\n< log(sec(\u03b8\u03b1\u03b2 )) + log(sec(\u03b8\u03b2\u03b3 )).\n\u0003\n4.3. The Long Segment Lemmas for arcs. We now state and prove\nseveral lemmas called the Long Segment Lemmas. The following is the\nLong Segment Lemma for angles.\nLemma 4.4 (Long Segment Lemma). Let \u03b4 > 0, \u2206 > 0. There exists\na constant L = L(\u03b4, \u2206) > 0 such that if \u03b1 and \u03b2 are oriented geodesic\narcs such that I(\u03b1\u03b2) \u2264 \u2206 (assuming that the terminal point of \u03b1 is the\ninitial point of \u03b2) and l(\u03b1), l(\u03b2) > L, then I(\u03b1\u03b2) < I(\u0398(t(\u03b1), i(\u03b2))) <\nI(\u03b1\u03b2) + \u03b4.\nProof. The left hand side of the above inequality follows from the monotonicity of inefficiency. For the right hand side, let \u03b1\u221e and \u03b2\u221e denote\nthe geodesic rays whose initial point is the point where \u03b1 and \u03b2 meet,\nand that contain \u03b1 and \u03b2 respectively (we also assume that \u03b1\u221e has the\nsame orientation as \u03b1 and \u03b2\u221e the same orientation as \u03b2). Recall that\n\n\f28\n\nKAHN AND MARKOVIC\n\nI(\u03b1\u221e \u03b2\u221e ) was defined just above the formula (5). Let \u03b7 be the geodesic\narc with the same endpoints as \u03b1\u03b2, and \u03b71 the geodesic ray with the\nsame endpoints as \u03b1\u221e \u03b2. By \u03b80 we denote the angle between \u03b1 and \u03b7,\nby \u03b81 the angle between \u03b7 and \u03b2, and by \u03b82 the angle between \u03b7 and\n\u03b71 .\nWe observe that \u03b80 , \u03b81 and \u03b82 are small (by the New Angle Lemma),\nand therefore\nI(\u03b1\u221e \u03b2\u221e ) < I(\u03b1\u221e \u03b2) + I(\u03b81 + \u03b82 )\n< I(\u03b1\u03b2) + I(\u03b80 ) + I(\u03b81 + \u03b82 )\n< I(\u03b1\u03b2) + o(1),\nwhere o(1) \u2192 0 as L \u2192 \u221e.\n\u0003\nThe following is the Long Segment Lemma for arcs.\nLemma 4.5 (Long Segment Lemma for arcs). Suppose we can write\n\u03b7 = \u03b1\u03b2\u03b3, where \u03b1 and \u03b3 are piecewise geodesic arcs, and \u03b2 is a geodesic\narc of length l. Then\nI(\u03b1\u03b2) + I(\u03b2\u03b3) \u2212 I(\u03b1\u03b2\u03b3) \u2192 0,\nuniformly when l \u2192 \u221e and I(\u03b1\u03b2) + I(\u03b2\u03b3) is bounded above.\nProof. If we replace \u03b1 and \u03b3 by the associated geodesics arcs, then\nI(\u03b1\u03b2) + I(\u03b2\u03b3) \u2212 I(\u03b1\u03b2\u03b3) will be unchanged, and I(\u03b1\u03b2) + I(\u03b2\u03b3) will be\ndecreased, so we can assume that \u03b1 and \u03b3 are geodesic arcs. We divide\n\u03b2 at its midpoint into \u03b2 \u2212 and \u03b2 + , so \u03b2 = \u03b2 \u2212 \u03b2 + , and \u03b1\u03b2\u03b3 = \u03b1\u03b2 \u2212 \u03b2 + \u03b3.\nWe will show the following estimates (for \u03b4 small when l is large and\nI(\u03b1\u03b2) + I(\u03b2\u03b3) is bounded above):\n(1) I(\u03b1\u03b2 \u2212 ) + I(\u03b2 + \u03b3) \u2212 I(\u03b1\u03b2\u03b3) < \u03b4,\n(2) I(\u03b1\u03b2) + I(\u03b1\u03b2 \u2212 )) < \u03b4,\n(3) I(\u03b2\u03b3) + I(\u03b2 + \u03b3)) < \u03b4,\nThe lemma then follows from (1), (2) and (3).\nFor (1), we refer to the Figure 2. We find that\nb = I(\u03b1\u03b2\u03b3) \u2212 I(\u03b1\u03b2 \u2212 ) \u2212 I(\u03b2 + \u03b3).\n0 \u2264 I(b\n\u03b1\u03b2)\nMoreover, when I(\u03b1\u03b2 \u2212 ) (which is at most I(\u03b1\u03b2)) and I(\u03b2 + \u03b3) (which\nis at most I(\u03b2\u03b3)) are bounded above, and l(\u03b2 \u2212 ) = l(\u03b2 + ) = l(\u03b2)\nis\n2\n\u2212\n+\na large, then \u03b8 and \u03b8 are small (by the New Angle Lemma), so\nb \u2264 I(\u03b8\u2212 + \u03b8+ ) is small. Likewise, I(\u03b1\u03b2) \u2212 I(\u03b1\u03b2 \u2212 ) = I(b\nI(b\n\u03b1\u03b2)\n\u03b1\u03b2 + ), and\n0 \u2264 I(b\n\u03b1\u03b2 + ) \u2264 I(\u03b8\u2212 ). This proves (1) and (2), and (3) is the same as\n(2).\n\u0003\n\n\fTHE EHRENPREIS CONJECTURE\n\n\u03b2\u2212\n\u03b1\n\n29\n\n\u03b2+\n\u03b8\u2212\n\n\u03b3\n\n\u03b8+\n\n\u03b1\u0302\n\n\u03b2\u0302\n\u03b7\n\nFigure 2. The Long Segment Lemma\n4.4. The inefficiency of a closed piecewise geodesic curve. Let\n\u03b11 , ..., \u03b1n denote oriented piecewise geodesic arcs on S such that the\nterminal point of \u03b1i is the initial point of \u03b1i+1 . By \u03b11 \u03b12 ...\u03b1n we denote\nthe concatenation of the arcs \u03b1i . Assume that the initial point of \u03b11\nand the terminal point of \u03b1n are the same. By [\u03b11 \u03b12 ...\u03b1n ] we denote\nthe corresponding closed curve.\nWe define the inefficiency operator as follows.\nDefinition 4.2. Let \u03b1 be a closed curve on a surface. By \u03b3 we denote\nthe appropriate closed geodesic that is freely homotopic to \u03b1. We let\nI(\u03b1) = l(\u03b1) \u2212 l(\u03b3). We call I(\u03b1) the inefficiency of \u03b1 (the inefficiency\nI(\u03b1) is equal to 0 if and only if \u03b1 is a closed geodesic).\nThe following is a closed curve version of Lemma 4.1.\nLemma 4.6. Let \u03b1 denote a closed curve on S, and let \u03b3 be the appropriate closed geodesic freely homotopic to \u03b1. Choose lifts \u03b1\ne and \u03b3\ne,\nof \u03b1 and \u03b3 respectively, in the universal cover H2 that have the same\nendpoints. The nearest point projection \u03c0\ne:\u03b1\ne\u2192\u03b3\ne descends to the map\n\u03c0 : \u03b1 \u2192 \u03b3. Let\nE = E(\u03b1) = sup d(x, \u03c0\ne(x)).\nx\u2208e\n\u03b1\n\nThen providing l(\u03b1) > L0 for some universal constant L0 we have\nE\u2264\n\nI(\u03b1)\n+ 1.\n2\n\nProof. The minimally inefficient closed curve \u03b1 that is freely homotopic\nto \u03b3 and the distance E from \u03b3 is given in Figure 3. Denote by \u03b7\nthe corresponding geodesic segment of length E. Then by the Long\n\n\f30\n\nKAHN AND MARKOVIC\n\nE\n\u03b3\n\n\u03b1\n\nFigure 3. \u03b1 is the minimally inefficient curve with\nl(\u03b7) = E\nSegment Lemma and monotonicity of inefficiency\n1\nI(\u03b7\u03b3\u03b7 \u22121 ) \u2264 I(\u03b7\u03b3) + I(\u03b3\u03b7 \u22121 ) +\n7\n\u0010\u03c0 \u0011\n\u0010\u03c0 \u0011 1\n\u2264I\n+I\n+\n2\n2\n7\n< 2,\nproviding that l(\u03b3) > L0 , where L0 is a universal constant. Hence\nl(\u03b1) \u2212 l(\u03b3) \u2265 2l(\u03b7) \u2212 2,\nor\nE\u2264\n\nI(\u03b1)\n+ 1.\n2\n\u0003\n\nThe following is the Long Segment Lemma for closed curves.\nLemma 4.7 (Long Segment Lemma for closed curves). Let \u03b1 be an\npiecewise geodesic arc and \u03b2 an geodesic arc on S, such that the initial\npoint of \u03b1 is the terminal point of \u03b2 and the initial point of \u03b2 is the\nterminal point of \u03b1. Then\n|I([\u03b1\u03b2]) \u2212 I(\u03b2\u03b1\u03b2)| < \u03b4,\nwhere \u03b4 \u2192 0 when l(\u03b2) \u2192 \u221e and I(\u03b2\u03b1\u03b2) is bounded above.\n\n\fTHE EHRENPREIS CONJECTURE\n\n31\n\nProof. The proof is similar to the proof of Lemma 4.5 and is left to\nreader.\n\u0003\n4.5. The Sum of Inefficiencies Lemma. The following is the Sum\nof Inefficiencies Lemma. Let S denote a closed hyperbolic Riemann\nsurface\nLemma 4.8 (Sum of Inefficiencies Lemma). Let \u000f, \u2206 > 0 and n \u2208\nN. There exists L = L(\u000f, \u2206, n) > 0 such that the following holds.\nLet \u03b11 , ..., \u03b1n+1 = \u03b11 , \u03b21 , ...\u03b2n , be geodesic arcs on the surface S such\nthat \u03b11 \u03b21 \u03b12 \u03b22 ...\u03b1n \u03b2n is a piecewise geodesic closed curve on S. If\nI(\u03b1i \u03b2i \u03b1i+1 ) \u2264 \u2206, and l(\u03b1i ) \u2265 L, then\nI([\u03b11 \u03b21 \u03b12 \u03b22 ...\u03b1n \u03b2n ]) \u2212\n\nn\nX\n\nI(\u03b1i \u03b2i \u03b1i+1 ) \u2264 \u000f.\n\ni=1\n\nProof. It directly follows from the Long Segment Lemma for closed\ncurves.\n\u0003\nRemark. In particular, we can leave out the \u03b2's in the above lemma,\nand write\nn\nX\nI([\u03b11 \u03b12 ...\u03b1n ]) \u2212\nI(\u03b1i \u03b1i+1 ) \u2264 \u000f,\ni=1\n\nproviding that I(\u03b1i \u03b1i+1 ) \u2264 \u2206, and l(\u03b1i ) \u2265 L. Moreover, by the Long\nSegment Lemma for Angles (for L large enough) we have\nI([\u03b11 \u03b12 ...\u03b1n ]) \u2212\n\nn\nX\n\nI(\u03b8i ) \u2264 2\u000f,\n\ni=1\n\nwhere \u03b8i = \u0398(t(\u03b1i ), i(\u03b1i+1 )).\nA more general version of the Sum of Inefficiencies Lemma is as\nfollows (the proof is the same).\nLemma 4.9. Let \u000f, \u2206 > 0 and n \u2208 N. There exists L = L(\u000f, \u2206, n) > 0\nsuch that the following holds. Let \u03b11 , ..., \u03b1n+1 = \u03b11 and \u03b211 , ...\u03b21j1 , ...\u03b2n1 , ...\u03b2njn ,\nbe geodesic segments on S such that \u03b11 \u03b211 ...\u03b21j1 ...\u03b1n \u03b2n1 ...\u03b2njn is a piecewise geodesic closed curve on S. If I(\u03b1i \u03b2i \u03b1i+1 ) \u2264 \u2206, and l(\u03b1i ) \u2265 L,\nthen\nI([\u03b11 \u03b211 ...\u03b21j1 ...\u03b1n \u03b2n1 ...\u03b2njn ]) \u2212\n\nn\nX\ni=1\n\nI(\u03b1i \u03b2i1 ...\u03b2iji \u03b1i+1 ) \u2264 \u000f.\n\n\f32\n\nKAHN AND MARKOVIC\n\nProof. It directly follows from the Long Segment Lemma.\n\u0003\nWe will use the theory of inefficiency for two purposes. First, to\ncontrol the geometry of piecewise geodesic arcs and closed curves, and\nsecond, to precisely estimate the length of the associated geodesic arcs\nand closed curves.\nFor example, suppose [\u03b1, \u03b2] is a closed curve, and \u03b1 and \u03b2 meet\nnearly at right angles at the two places they meet, and \u03b1 and \u03b2 are\nboth long. Then l(\u03b3) is close to l(\u03b1) + l(\u03b2) \u2212 log 4 where \u03b3 is the\ncorresponding closed geodesic.\nAs a second example, suppose \u03b11 , \u03b12 , \u03b13 is a piecewise geodesic arc,\nand let \u03b112 be the geodesic arc homotopic rel endpoints to \u03b11 \u03b12 , and\nlikewise define \u03b123 and \u03b1123 . Then\nl(\u03b1123 ) = l(\u03b11 ) + l(\u03b12 ) + l(\u03b13 ) + I(\u03b112 ) + I(\u03b123 ),\nprovided that I(\u03b112 ), I(\u03b123 ) \u2264 \u2206 and l(\u03b12 ) \u2265 L(\u2206).\n5. The Geometric Square Lemma\nIn this section we will prove the Geometric Square Lemma (Lemma\n5.4), which will then be reformulated as the Algebraic Square Lemma\nin the next section. This section is probably the hardest and most\ntechnical section in the paper, and the reader who is still struggling\nto have a clear idea of where we are going may wish to skip to the\nnext section and see how the Algebraic Square Lemma follows from\nthe Geometric one.\nFrom now on we can think of the surface S as being fixed. We also\nfix \u000f > 0. However, for the reader's convenience we always emphasize\nhow quantities may depend on S and \u000f.\n5.1. Notation and preliminary lemmas. By an oriented closed geodesic C on S we will mean an isometric immersion C : TC \u2192 S, where\nTC = R/l(C), and l(C) is the length of C. To simplify the notation, by\nC : R \u2192 S we also denote the corresponding lift (such a lift is uniquely\ndetermined once we fix a covering map \u03c0 : R \u2192 TC ). We call TC the\nparameterizing torus for C (because TC = R/l(C) is a 1-torus). By a\npoint on C we mean C(p) where p \u2208 TC , or p \u2208 R. Given two points\na, b \u2208 R, we let C[a, b] be the restriction of C : R \u2192 S to the interval\n[a, b]. If b < a then the orientation of the segment C[a, b] is the negative\nof the orientation for C. Of course C[a + nl(C), b + nl(C)] is the same\ncreature for n \u2208 Z. By C 0 (p) we denote the unit tangent vector to C\nwith the appropriate orientation.\n\n\fTHE EHRENPREIS CONJECTURE\n\n33\n\nRecall that T 1 H2 denotes the unit tangent bundle, where elements\nof T 1 (H2 ) are pairs (p, u), where p \u2208 H2 and u \u2208 Tp1 H2 . The tangent\n\u221a\nspace Tp1 has a complex structure and given u \u2208 T 1 S, by \u22121u \u2208 Tp1 S\nwe denote the vector obtained from u by rotating for \u03c02 .\nRecall that for u, v \u2208 Tp1 H2 we let \u0398(u, v) denote the unoriented\nangle between u and v. If u \u2208 Tp1 H2 then u @ q \u2208 Tq1 H2 denotes the\nvector u parallel transported to q along the geodesic segment connecting p and q. We use the similar notation for points in T 1 S, except that\nin this case one always has to specify the segment between p and q\nalong which we parallel transport vectors from Tp1 S to Tq1 S.\nWe refer to the following lemma as the Convergence Lemma. The\nproof is left to the reader.\nLemma 5.1. Suppose A and B are oriented geodesics in H2 that are\nE-nearly homotopic, and let\n\u0014\n\u0015\n\u0014\n\u0015\nl(A) l(A)\nl(B) l(B)\n2\na: \u2212\n,\n\u2192H , b: \u2212\n,\n\u2192 H2 ,\n2\n2\n2\n2\ndenote the unit time parametrization. Set l = 21 min(l(A), l(B)). Then\nthere exists 0 \u2264 t0 \u2264 E, such that for t \u2208 [\u2212l, l] the following inequalities hold\n(1) d(a(t), b(t + t0 )) \u2264 e|t|+E+1\u2212l ,\n(2) \u0398(a0 (t)@b(t + t0 ), b0 (t + t0 )) \u2264 e|t|+E+1\u2212l .\nLet (p, u) and (q, v) be two vectors from T 1 (H2 ). We define the\ndistance function\ndis((p, u), (q, v)) = max(\u0398(u @ q, v), d(p, q)).\n(We do not insist that dis is a metric on T 1 H2 ).\nLet \u03b1 : [a, b] \u2192 H2 be a unit speed geodesic segment. We let i(\u03b1) =\n\u03b10 (a), and t(\u03b1) = \u03b10 (b). We have the following lemma (we omit the\nproof).\nLemma 5.2. Let \u000f, L > 0. There exists a constant \u000f0 (L) with the\nfollowing properties. Suppose that \u03b1 : [a0 , a1 ] \u2192 H2 and \u03b2 : [b0 , b1 ] \u2192\nH2 are \u000f-nearly homotopic, that is d(\u03b1(ai ), \u03b2(bi )) \u2264 \u000f. Suppose that\na1 \u2212 a0 > L, and \u000f < 1. Then\ndis(\u03b10 (ai ), \u03b2 0 (bi )) \u2264 \u000f(1 + \u000f0 (L)),\nwith \u000f0 (L) \u2192 0 as L \u2192 \u221e.\n\n\f34\n\nKAHN AND MARKOVIC\n\n5.2. The Preliminary Geometric Square Lemma (the PGSL).\nSuppose Cij , i, j = 0, 1, are four closed geodesics on S, and imagine\n+\nthat Cij is covered by two overlapping arcs Cij+ and Cij\u2212 , where Ci0\nand\n+\n\u2212\n\u2212\nCi1 are nearly homotopic and likewise for C0j and C1j . The Geometric\nSquare Lemma (GSL) states that\nX\n\n(\u22121)ij Cij = 0.\n\nThe full statement of the GSL is given in Section 5.3.\nThe following is the Preliminary Geometric Square Lemma. We have\nadded the hypothesis (5) to the GSL (Lemma 5.4), so as to find points\nin the two convergence intervals of the four curves, that are nearly\ndiametrically opposite.\nLemma 5.3 (Preliminary Geometric Square Lemma). Let E, \u000f > 0.\nThere exist constants K = K(\u000f, E) > 0 and R0 (S, \u000f, E) > 0 with the\nfollowing properties. Suppose that we are given four oriented geodesics\nCij \u2208 \u0393\u000f,R , i, j = 0, 1, and for each ij we are given 4 real numbers\n+\n\u2212\n+\n\u2212\nx\u2212\nij < xij < yij < yij < xij + l(Cij ). Assume that\n\u2212\n+\n\u2212\n(1) The inequalities x+\nij \u2212 xij > K, and yij \u2212 yij > K, hold.\n+\n\u2212\n+\n(2) The segments Cij [x\u2212\nij , xij ] and Ci0 j 0 [xi0 j 0 , xi0 j 0 ] are E-nearly homotopic, and likewise the segments Cij [yij\u2212 , yij+ ] and Ci0 j 0 [yi\u22120 j 0 , yi+0 j 0 ]\nare E-nearly homotopic, for any i, j, i0 , j 0 \u2208 {0, 1}.\n+\n\u2212\n+\n(3) The segments C0j [x\u2212\n0j , y0j ] and C1j [x1j , y1j ] are E-nearly homotopic.\n\u2212\n\u2212\n+\n(4) The segments Ci0 [yi0\n, x+\ni0 + l(Ci0 )] and Ci1 [yi1 , xi1 + l(Ci1 )] are\nE-nearly homotopic.\n+\n+\n\u2212\n(5) y00\n\u2212 x\u2212\n00 \u2265 R + K, and x00 + l(C00 ) \u2212 y00 \u2265 R + K.\n\nThen for R > R0 , we have\nX\n(6)\n(\u22121)i+j Cij = 0,\ni,j=0,1\n\nin \u03a010\u000f,R homology.\n+\n\u2212\n\u2265 R.\nRemark. The hypothesis (5) is satisfied provided that y00\n\u2212 y00\n\nProof. Set K = 1 + E \u2212 log \u000f. For simplicity we write l(Cij ) = lij .\n+\nK\nK\nWe claim that we can find x00 \u2208 [x\u2212\n00 + 2 , x00 \u2212 2 + 1] and y00 \u2208\n\u2212\n+\n\u2212\nK\nK\n[y00 + 2 , y00 \u2212 2 ] such that y00 \u2212 x00 = R. If y00 \u2264 x\u2212\n00 + R, we let\n\u2212\n\u2212\n\u2212\nK\nx00 = x\u2212\nand\ny\n=\nx\n+\nR.\nIf\ny\n\u2265\nx\n+\nR,\nwe\nlet\ny00 = y00\n+ K2 ,\n+\n00\n00\n00\n00\n00\n2\nand x00 = y00 \u2212 R.\n\n\fTHE EHRENPREIS CONJECTURE\n\nyij\u2212\n\n\u2212iC 0 (yij )\nyij\n\nyij+\n\n35\n\nx+\nij\n\niC 0 (xij )\n\nxij\n\nx\u2212\nij\n\nFigure 4. The Preliminary Geometric Square Lemma\nBy the Convergence Lemma (Lemma 5.1), and by the choice of the\n+\n\u2212\n+\nconstant K, we can find x\u2212\nij < xij < xij and yij < yij < yij so that\n0\n0\ndis(Cij0 (xij ), C00\n(x00 )), dis(Cij0 (yij ), C00\n(y00 )) \u2264 \u000f,\n\nand the pairs of geodesic segments C0i [x0i , y0i ] and C1i [x1i , y1i ], and\nCi0 [yi0 , xi0 + li0 ] and Ci1 [yi1 , xi1 + li1 ] are \u000f-nearly homotopic.\nLet Iij = yij \u2212 xij and Jij = xij + lij \u2212 yij , so Iij + Jij = lij . Then\nI00 = R and J00 = l00 \u2212 R, so |J00 \u2212 R| < 2\u000f.\nAlso, by the triangle inequality we have |I01 \u2212 R| = |I01 \u2212 I00 | < 2\u000f.\nSo\n|J01 \u2212 R| \u2264 |I01 \u2212 R| + |l01 \u2212 2R| \u2264 4\u000f.\nThen\n|J1j \u2212 R| \u2264 |J0j \u2212 R| + |J1j \u2212 J0j | < 6\u000f,\nso\n|I1j \u2212 R| \u2264 |J1j \u2212 R| + |l1j \u2212 2R| < 8\u000f.\nTherefore we get |Iij \u2212 R|, |Jij \u2212 R| < 8\u000f for i, j \u2208 {0, 1}.\nWe take\n\u221a\n\u221a\n\u03b100 \u2208 Conn\u000f,R+log 4 ( \u22121C 0 (x00 ), \u2212 \u22121C 0 (y00 )),\nand let \u03b1ij be the geodesic arc connecting xij and yij that is \u000f-nearly homotopic to \u03b100 (see Figure 4). Then dis(i(\u03b1ij ), i(\u03b100 )), dis(t(\u03b1ij ), t(\u03b100 )) \u2264\n0\n0\n2\u000f. Therefore, because dis(Cij0 (xij ), C00\n(x00 )) \u2264 \u000f and dis(Cij0 (yij ), C00\n(y00 )) \u2264\n\u000f, we have\n\u221a\n\u221a\n\u03b1ij \u2208 Conn3\u000f,R+log 4 ( \u22121C 0 (xij ), \u2212 \u22121C 0 (yij )).\n\n\f36\n\nKAHN AND MARKOVIC\n\nDefine \u03a0ij as the pants generated from Cij by adding the third connection \u03b1ij . Denote by Aij and Bij the other two cuffs of \u03a0ij , oriented\nsuch that\n\u2202\u03a0ij = Cij \u2212 Aij \u2212 Bij ,\n\u22121\nwhere Aij is freely homotopic to the closed broken geodesic Cij [xij , yij ]\u03b1ij\n,\nand Bij to Cij [yij , xij + lij ]\u03b1ij .\nApplying Lemma 4.8, we obtain\n|l(Aij ) \u2212 2R| < |Iij \u2212 R| + 10\u000f < 20\u000f\nand similarly |l(Bij ) \u2212 2R| < 20\u000f, so \u03a0ij \u2208 \u039310\u000f,R . Finally, Ai0 = Ai1 ,\nand B0j = B1j , so\nX\nX\n0=\n(\u22121)i+j \u2202\u03a0ij =\n(\u22121)i+j Cij ,\ni,j=0,1\n\ni,j=0,1\n\nin \u03a010\u000f,R homology, which proves the lemma.\n\n\u0003\n\n5.3. The Geometric Square Lemma.\nLemma 5.4 (Geometric Square Lemma). Let E, \u000f > 0. There exist\nconstants K1 = K1 (S, \u000f, E) > 0 and R0 (S, \u000f, E) > 0 with the following\nproperties. Suppose that we are given four oriented geodesics Cij \u2208 \u0393\u000f,R ,\n+\n\u2212\n+\ni, j = 0, 1, and for each ij we are given 4 points x\u2212\nij < xij < yij < yij <\nx\u2212\nij + l(Cij ). Assume that\n\u2212\n+\n\u2212\n(1) The inequalities x+\nij \u2212 xij > K1 , and yij \u2212 yij > K1 , hold.\n+\n\u2212\n+\n(2) The segments Cij [x\u2212\nij , xij ] and Ci0 j 0 [xi0 j 0 , xi0 j 0 ], are E-nearly homotopic, and likewise the segments Cij [yij\u2212 , yij+ ] and Ci0 j 0 [yi\u22120 j 0 , yi+0 j 0 ],\nare E-nearly homotopic, for any i, j, i0 , j 0 \u2208 {0, 1}.\n+\n\u2212\n+\n(3) The segments C0j [x\u2212\n0j , y0j ] and C1j [x1j , y1j ] are E-nearly homotopic.\n\u2212\n\u2212\n+\n(4) The geodesic segments Ci0 [yi0\n, x+\ni0 + l(Cij )] and Ci1 [yi1 , xi1 +\nl(Cij )] are E-nearly homotopic.\nThen for R > R0 , we have\nX\n(7)\n(\u22121)i+j Cij = 0,\ni,j=0,1\n\nin \u03a0100\u000f,R homology.\nProof. Below we use L0 = L0 (S, \u000f, E) and K0 = (S, \u000f, E) to denote\ntwo sufficiently large constants whose values will be determined in the\ncourse of the argument. The constant Q0 can depend on K0 and L0 .\nThe constants K1 and R0 (from the statement of the GSL) can depend\non K0 and L0 and Q0 . Each of these constants will be implicitly defined\n\n\fTHE EHRENPREIS CONJECTURE\n\n37\n\nas a maximum of expressions in terms of constants which precede the\ngiven constant in the partial order of dependence which we just have\ndescribed.\nIf we cannot apply the PGSL, then possibly interchanging the roles\nof the x' and the y's, we find that\n\u2212\nx+\n00 \u2264 y00 \u2212 l00 + R + K(\u000f, E)\n\u2212\n\u2212 R + K(\u000f, E) + 1,\n< y00\n\nwhere K = K(\u000f, E) is the constant from the previous lemma. We then\n\u2212\nlet y00 = y00\n+ Q0 , and let w00 = y00 \u2212 R (we assume that Q0 > K).\nThen\nw00 > x+\n00 + 10,\n\n(8)\n\nprovided Q0 > K + 11, and\n\u2212\n+\ny00\n+ Q0 \u2264 y00 \u2264 y00\n+ Q0 \u2212 K1 ,\n\nwhich implies\n(9)\n\n\u2212\n+\ny00\n+ 2(E \u2212 log \u000f) + 10 \u2264 y00 \u2264 y00\n\u2212 2(E + log \u000f) \u2212 10,\n\nprovided Q0 \u2265 2(E \u2212 log \u000f) + 10 and K1 \u2265 Q0 + 2(E \u2212 log \u000f) + 10.\nTherefore by the Convergence Lemma we can find yij in the interval\n0\n(y00 )) \u2264 \u000f. We then let\n[yij\u2212 , yij+ ] such that dis(Cij0 (yij ), C00\nwij = yij \u2212 R\n\u2265 x+\nij + 10\n(provided Q0 > E + K + 12)\n\u2265 x\u2212\nij + K1\n\u2265 x\u2212\nij + 2(E \u2212 log \u000f) + 10\n(provided K1 > 2(E \u2212 log \u000f) + 10).\nIt follows from Lemma 5.1 that Ci0 [wi0 , yi0 ] and Ci1 [wi1 , yi1 ] are \u000f C 1\nnearly homotopic (two segments are C 1 nearly homotopic if the two\ninitial and the two terminal vectors are \u000f close in the tangent bundle\nrespectively). The point is that these two segments are contained into\nmuch larger segments that are E-nearly homotopic.\n\u221a\n0\nLet (q, v) \u2208 T 1 S, and take \u03b2i0 \u2208 Conn\u000f,L0 (v, \u2212 \u22121Ci0\n(wi0 )) (where\nwe assume that L0 > L0 (\u000f, S) and L0 (\u000f, S) is the constant from the\n\u221a Con0\nnection Lemma (Lemma 3.1)). We take \u03b100 \u2208 Conn\u000f,R+log\n(\n\u221a 4\u2212L0 0 \u22121C00 (y00 ), v)\n(see Figure 5). Then we find \u03b1ij \u2208 Conn3\u000f,R+log 4\u2212L0 ( \u22121Cij (yij ), v),\n\n\f38\n\nKAHN AND MARKOVIC\n\nwij\nv\nq\n\nyij\u2212\n\n\u03b2ij\n\nx+\nij\n\n\u03b1ij\nyij\nx\u2212\nij\n\nyij+\n\nFigure 5. The Geometric Square Lemma\n\u221a\nand \u03b2ij \u2208 Conn3\u000f,L0 (v, \u2212 \u22121Cij0 (wij ) such that \u03b100 and \u03b1ij are \u000f-nearly\nhomotopic and \u03b2i0 and \u03b2i1 are 2\u000f-nearly homotopic for every i, j = 0, 1.\nWe let \u03a0ij be the pair of pants generated by the geodesic segment\n\u22121\nCij [wij , yij ], the broken geodesic segment \u03b2 \u22121 \u03b1ij\n, and the geodesic seg\u22121\nment (Cij [yij , wij + lij ]) . The reader can verify that it is a topological\npair of pants.\nWe let Aij be the closed geodesic freely homotopic to \u03b1ij \u03b2ij Cij [wij , yij ]\n\u22121\nand let Bij be the one for Cij [yij , wij + lij ]\u03b2ij\u22121 \u03b1ij\n. Then \u2202\u03a0ij =\nCij \u2212 Aij \u2212 Bij .\nUsing the second inequality from the remark just after the Sum of\nInefficiencies Lemma (see Lemma 4.8), we find that |l(Aij )\u22122R| \u2264 13\u000f,\nand |l(Bij ) \u2212 2R| \u2264 15\u000f. Hence \u03a0ij \u2208 \u03a010\u000f,R .\nObserve that Ai0 = Ai1 , so\nX\nX\nX\n(\u22121)i+j Cij \u2212\n(\u22121)i+j \u2202\u03a0ij =\n(\u22121)i+j Bij .\ni,j=0,1\n\na\u2212\nij ,\n\na\u2212\nij ,\n\ni,j=0,1\n\nb\u2212\nij\n\nb\u2212\nij\n\ni,j=0,1\n\nLet the\nand\nbe real numbers and Bij : R \u2192 Bij be a\n+\n\u2212\nparametrization of the geodesic Bij so that Bij (a\u2212\nij ), Bij (aij ), Bij (bij ),\n+\n\u2212\n+\nBij (b+\nij ) are the projections of points q, Cij (yij ), Cij (xij ) and Cij (xij )\nrespectively onto the geodesic Bij . The points q, Cij (yij+ ), Cij (x\u2212\nij ) and\n+\n\u22121 \u22121\nCij (xij ) belong to the broken geodesic Cij [yij , wij + lij ]\u03b2ij \u03b1ij , and we\n\u22121\nproject them to Bij by choosing lifts of Bij and Cij [yij , wij + lij ]\u03b2ij\u22121 \u03b1ij\n\n\fTHE EHRENPREIS CONJECTURE\n\n39\n\nin H2 that have the same endpoints and then use the standard projection onto the lift of Bij .\nIt follows from the Convergence Estimate that each of q, Cij (yij+ ),\n+\nCij (x\u2212\nij ) and Cij (xij ) are within distance 1 of the corresponding projections on Bij . Then\n\u2212\n+\n\u2212\nb+\nij \u2212 bij \u2265 xij \u2212 xij \u2212 2\n\u2265 K0\n\n(provided K1 > K0 + 2),\nand\n\u2212\na+\nij \u2212 aij \u2265 R \u2212 L0 \u2212 3 + K1 \u2212 Q0 \u2212 E \u2212 1\n\u2265 R + K0\n\n(provided K1 > K0 + Q0 + L0 + E + 4).\nAssuming that K0 \u2265 K(10\u000f, E + 2) (where K is the constant from\n\u2212\n+\n\u2212\nthe PGSL) we find that the differences b+\nij \u2212 bij and aij \u2212 aij satisfy the\n+\n\u2212\nlower bound from the PGSL (observe that bij and bij are E + 2 close\nand similarly for the a's).\nAlso, the Bij 's are in \u039310\u000f,R . So we apply the PGSL to show that\nX\n(\u22121)i+j Bij = 0\ni,j=0,1\n\nin \u03a0100\u000f,R homology.\nHere we explain why the assumptions of the PGSL are satisfied. For\n+\n\u2212\neach i, piecewise geodesics \u03b1i0\u2212 Ci0 [yi0 , x+\ni0 ] and \u03b1i1 Ci1 [yi1 , xi1 ], are\n+\nE-nearly homotopic; it follows from Lemma 4.1 that Bi0 [a\u2212\ni0 , ai0 ] and\n\u2212\n+\nBi1 [ai1 , ai1 ] are (E + 4)-nearly homotopic.\n\u22121 \u22121\n+\n\u22121 \u22121\n+\nLikewise, C0j [x0j , w0j ]\u03b20j\n\u03b10j C0j [y0j , y0j\n] and C1j [x1j , w1j ]\u03b21j\n\u03b11j C1j [y1j , y1j\n]\nare E-nearly homotopic (because the individual segments are) and\n+\n\u2212\n+\nhence B0j [b\u2212\n0j , a0j ] and B1j [b1j , a1j ] are.\n\u0003\nRandomization: Randomization remarks for the GSL. Let \u000f, E > 0.\nEvery constant K below may depend only\n\u0010 on \u0011\u000f, S and E.\n....\n\nBelow we will define a partial map g : \u0393 1,R\n\n4\n\n\u2192 R\u03a0100\u000f,R such that\n\n\u00b1\n(1) g is defined on any input (Cij , x\u00b1\nij , yij ) that satisfies the hypothesis\n4 of GSL,\nP 1 \u2212i+j\n\u00b1\n(2) (\u22121) Cij = \u2202g(Cij , x\u00b1\nij , yij ),\n\n\f40\n\nKAHN AND MARKOVIC\n.... on\n(3) g is K-semirandom with respect to measures classes \u03a3\u00024\n\u0393\n\u0010.... \u00114\n\u0393 1,R and \u03c3\u03a0 on \u03a01,R .\n\u0010.... \u00114\nWe first define a partial function g0 : \u0393 1,R\n\u2192 R\u03a010\u000f,R that\n\n\u00b1\nis defined on inputs (Cij , x\u00b1\nij , yij ) that satisfy the extra hypothesis\n(5) from the PGSL. Given such an input, we follow the construction\nof the PGSL to construct xij and yij , and we observe that because\nthese new points are bounded distance from the old ones, the map\n\u00b1\n(Cij , x\u00b1\nij , yij ) \u2192 (Cij , xij , yij ) is K-semirandom as a partial map from\n\u0010.... \u00114 \u0010 .. \u00114\n\u0010.... \u00114\n.... on\n\u0393 1,R to \u03931,R , with respect to the measure classes \u03a3\u00024\n\u0393 1,R\n\u0393\n\u0010 .. \u00114\n..\nand \u03a3\u00024\non \u03931,R .\n\u0393\nThen we take a random third connection\n\u221a\n\u221a\n0\n0\n(x00 ), \u2212 \u22121C00\n(y00 )).\n\u03b100 \u2208 Conn\u000f,R+log 4 ( \u22121C00\n\nLikewise for \u03b1ij . Adding the third connection \u03b1ij to Cij we obtain\nthe pants \u03a0ij (\u03b1ij ). We claim that distinct \u03b1ij lead to distinct pants\n\u03a0ij (\u03b1ij ). The third connection \u03b1ij is \u000f-close to the unique simple geodesic arc on \u03a0ij (\u03b1ij ) that is orthogonal to \u03b3ij at both ends. On the\nother hand, no two distinct \u03b1ij are \u000f-close, so assuming that the injectivity radius of the surface S is at least 2\u000f we find that distinct \u03b1ij give\ndistinct \u03a0ij (\u03b1ij ).\nSo, for each input (Cij , xij , yij ), by adding a random third connection\n\u03b1ij we construct the pants \u03a0ij (\u03b1ij ). So far, we have been using the term\n\"random\" to mean arbitrary. In these randomization remarks we will\nalso interpret the phrase \"a random\nPelement of a finite set S\" as \"the\n1\nrandom element of RS, namely |S| x\u2208S x.\nWe can then think of every map f : S \u2192 T that we have implicitly\nconstructed inPthe text P\nas the associated linear map f : RS \u2192 RT\ndefined by f ( ai xi ) = ai f (xi ). So, for example, we let\n\u221a\n\u221a\n\u03b1ij \u2208 Conn\u000f,R+log 4 ( \u22121Cij0 (xij ), \u2212 \u22121Cij0 (yij ))\nbe the random element of\n\n\u221a\n\u221a\nConn\u000f,R+log 4 ( \u22121Cij0 (xij ), \u2212 \u22121Cij0 (yij )),\n\nand then \u03a0ij (\u03b1ij ) is the image of \u03b1ij by the linear form of the map\n\u03b1ij \u2192 \u03a0ij (\u03b1ij ).\n..\nIn this manner we have constructed a partial map from \u03931,R \u2192 \u03a01,R\n(defined by (Cij , xij , yij ) \u2192 \u03a0ij (\u03b1ij ), compare with Lemma 3.2 ), and\nwe claim that it is K-semirandom with respect to \u03a3\u0393.. and \u03c3\u03a0 . To\n\n\fTHE EHRENPREIS CONJECTURE\n\n41\n\nverify this claim we need to show that for any given pants \u03a0 \u2208 \u03a01,R ,\nthe weight of \u03a0 is at most Ke\u22123R . Let C be a cuff of \u03a0, and choose\npoints x, y \u2208 C which lie in certain unit length intervals on C. Let\nConn be the set of all good third connections between x and y (by this\nwe mean all connections \u03b1 so that C and \u03b1 produce a pair of pants\nin \u03a01,R ). The set Conn has approximately eR\u2212K elements. Moreover,\nthere is a unique third connection \u03b1 \u2208 Conn so that \u03b1 and C yield\nthe given pair of pants \u03a0. So, the total weight of \u03a0 is at most eK\u2212R\ntimes the total weight for the three choices of C \u2208 \u2202\u03a0 (with associated\nunit intervals), and we conclude that the total weight for \u03a0 is at most\n3eK\u2212R e\u22122R = Ke\u22123R .\u0001\nP\nAlso, the map \u03a0ij i,j\u2208{0,1} 7\u2192 (\u22121)i+j \u03a0ij , is of course 4-semirandom\nfrom (\u03a041,R , \u03a3\u00024\n\u03a0 ) to (R\u03a01,R , \u03a3\u03a0 ). Composing the above maps we construct the map g0 and see that g0 is K-semirandom.\nFor the general case, similarly as above we first define the map\n\u00b1\nh : (Cij , x\u00b1\nij , yij ) \u2192 R\u03a01,R\n\u00b1\naccording to our second construction, on every input (Cij , x\u00b1\nij , yij ) that\nsatisfies conditions (1) \u2212 (4) of the GSL, but not condition (5) of the\nPGSL.\n\u00b1\nWe construct yij and wij as before. The map (Cij , x\u00b1\nij , yij ) \u2192 (Cij , yij , wij )\nis K-semirandom. Then we find the connections \u03b1ij and \u03b2ij . There are\nat least eR\u2212K of the \u03b1ij (we only fix a single \u03b2ij ), and each third connection \u03b1ij \u03b2ij leads to a new pair of pants \u03a0ij (\u03b1ij \u03b2ij ). Let N denote\nthe number of connections \u03b1ij (by construction, the number N does\nnot depend on i and j). This defines the map\nX 1\n\u00b1\nh(Cij , x\u00b1\n,\ny\n)\n=\n\u03a0ij (\u03b1ij \u03b2ij ),\nij ij\nN\nand we can verify that h is K-semirandom.\nThen we observe that \u2202B : \u03a0ij \u2192 Bij formed by taking the appropriate boundary curve of the \u03a0ij we constructed is K-semirandom, so\n\u00b1\nthe induced map e\nh : (Cij , x\u00b1\n(Bij , aij , bij ) is as well. So the\nij , yij ) \u2192P\n\u00b1\n\u00b1\n\u00b1\nmap g1 defined by g1 (Cij , xij , yij ) = (\u22121)i+j \u03a0ij + g0 (Bij , a\u00b1\nij , bij ) is\nK-semirandom, and hence g = g0 + g1 is as well.\n\n6. The Algebraic Square Lemma\nWe prove the Algebraic Square Lemma which will be used in almost\nall of our subsequent identities in the Good Pants Homology. In particular it will allow us to encode an element of \u03c01 (S, \u2217) as a sum of\ngood pants and then prove that the encoding of products of elements\nof \u03c01 (S, \u2217) is the sum of their encodings.\n\n\f42\n\nKAHN AND MARKOVIC\n\n6.1. Notation. Let \u2217 \u2208 S denote a point that we fix once and for all.\nBy \u03c01 (S, \u2217) we denote the fundamental group of a pointed surface. If\nA \u2208 \u03c01 (S, \u2217), we let *A* be the geodesic segment from \u2217 to \u2217 homotopic\nto A. By [A] we denote the closed geodesic on S that is freely homotopic\nto *A*. If A1 , ..., An \u2208 \u03c01 (S, \u2217) we let *A1 * A2 ... * An * be the piecewise\ngeodesic arc that is the concatenation of the arcs *Ai *. We let [*A1 *\nA2 ... * An *] be the closed piecewise geodesic that arises from the arc\n*A1 * A2 ... * An * by noticing that the starting and the ending point of\n*A1 * A2 ... * An * are the same. By l([A]) is the length of the closed\ngeodesic [A]. By l(*A*) we mean of course the length of the geodesic\narc *A*, and in general by l(*A1 *...*An *) the length of the corresponding\npiecewise geodesic arc.\nRemark. Observe that for any Xi \u2208 \u03c01 (S, \u2217), i = 0, ..., n\u22121, the closed\ngeodesics [Xj Xj+1 ...Xn+j\u22121 ] are one and the same (we are taking the\nindices modulo n). We will call this rotation and often use it without\nwarning.\nWe remind the reader that *AB* is a geodesic arc from \u2217 to \u2217 representing AB, while *A * B* is a concatenation of two geodesic arcs. Similarly *AB * C* is a concatenation of two geodesic arcs, while *A * B * C*\nis a concatenation of three, and so on.\nIn particular, we have the following statements about the inefficiency\nfunction,\nX\nI(*A1 * ... * An *) =\nl(*Ai *) \u2212 l(*A1 A2 ....An *),\nand\nI([*A1 * ... * An *]) =\n\nX\n\nl(*Ai *) \u2212 l([A1 ....An ]).\n\nNotice that we may have (and will usually have)\nI([*A1 * .... * An *]) > I(*A1 * .... * An *).\n6.2. The Algebraic Square Lemma (the ASL). The following is\nthe Algebraic Square Lemma.\nLemma 6.1 (Algebraic Square Lemma). Let \u000f, \u2206 > 0. There exist\nconstants K(S, \u000f, \u2206) = K and R0 = R0 (S, \u000f, \u2206) so that for R > R0 the\nfollowing holds. Let Ai , Bi , U, V \u2208 \u03c01 (S, \u2217), i = 0, 1, be such that\n(1) l([Ai U Bj V ]) \u2212 2R < 2\u000f, i, j = 0, 1,\n(2) I([*Ai * U * Bj * V *]) < \u2206,\n(3) l(*U *), l(*V *) > K.\nThen\nX\n(\u22121)i+j [Ai U Bj V ] = 0\nij\n\n\fTHE EHRENPREIS CONJECTURE\n\n43\n\nin \u03a0100\u000f,R homology.\nProof. For each i, j \u2208 {0, 1} we project the closed piecewise geodesic\n[*Ai *U *Bj *V *] onto the closed geodesic \u03b3ij = [Ai U Bj V ]. By Lemma 4.6\nwe find that each appearance of \u2217 is moved at most distance E = \u22062 + 1\n\u00b1\nby the projections. Let \u03b3ij (x\u00b1\nij ) and \u03b3ij (yij ) be the projections of \u2217\non \u03b3ij before and after U , and before and after V , respectively. Then\nproviding that our K is at least 2E plus the corresponding constant\n+\n\u2212\n+\n\u2212\nfrom the GSL, we have x\u2212\nij < xij < yij < yij < xij + l(\u03b3ij ) and the\nhypotheses of the Geometric Square Lemma. We conclude that\nX\n(\u22121)i+j [Ai U Bj V ] = 0\nij\n\nin \u03a0100\u000f,R homology.\n\u0003\nRandomization: Randomization remarks for the ASL. Let \u000f, \u03b4 > 0.\nBy K we denote any constant that may depend only on \u000f, S, and \u2206.\nBelow we will define a partial map\nf : G2 \u00d7 G \u00d7 G2 \u00d7 G \u2192 R\u03a01,R ,\nsuch that\n(1) f is defined on any input (Ai , U, Bj , V ) that satisfies the assumptions\nof the ASL,\nP\n(2) (\u22121)i+j [Ai U Bj V ] = \u2202f (Ai , U, Bj , V ),\n(3) f is K-semirandom with respect to the classes of measures \u03a3\u00022\nG \u00d7\n2\n2\n\u00d7\n\u03a3\non\nG\n\u00d7\nG\n\u00d7\nG\n\u00d7\nG\nand\n\u03c3\non\n\u03a0\n.\n\u03a3G \u00d7 \u03a3\u00022\nG\n\u03a0\n1,R\nG\nLet h be a partial map\n\u0010.... \u00114\nh : G2 \u00d7 G \u00d7 G2 \u00d7 G \u2192 \u0393 1,R\n\u00b1\ndefined by letting h(Ai , U, Bj , V ) = (Cij , x\u00b1\nij , yij ), where Cij = [Ai U Bj V ],\n\u00b1\nand x\u00b1\nij and yij are the points on the parameterizing torus for Cij such\n\u00b1\nthat the points Cij (x\u00b1\nij ) and Cij (yij ) are the corresponding projections\nof the 4 copies of the base point \u2217 (that belong to the closed piecewise\ngeodesic [*Ai * U * Bj * V *]) to the closed geodesic Cij (these projections\nwere defined above). It follows from Lemma 10.2 and Lemma 10.3 that\n\u0010.... \u00114\nh is K-semirandom. Let g : \u0393 1,R \u2192 R\u03a01,R be the K-semirandom\nmap from the previous section (see the Randomization remarks for the\nGSL). Then f = g \u25e6 h is K-semirandom.\n\n\f44\n\nKAHN AND MARKOVIC\n\n6.3. The Sum of Inefficiencies Lemma in the algebraic notation. The following lemma follows from Lemma 4.8.\nLemma 6.2 (Sum of Inefficiencies Lemma in the algebraic notation).\nLet \u000f, \u2206 > 0 and n \u2208 N. There exists L = L(\u000f, \u2206, n) > 0 such that if\nU1 , ..., Un+1 = U1 , X1 , ...Xn \u2208 \u03c01 (S, \u2217), and I(*Ui * Xi * Ui+1 ) \u2264 \u2206, and\nl(*Ui *) \u2265 L, then\nI([*U1 * X1 * U2 * X2 * ... * Un * Xn *]) \u2212\n\nn\nX\n\nI(*Ui * Xi * Ui+1 *) \u2264 \u000f.\n\ni=1\n\nRemark. In particular, we can leave out the X's in the above lemma,\nand write\nn\nX\nI([*U1 * U2 * ... * Un *]) \u2212\nI(*Ui * Ui+1 *) \u2264 \u000f,\ni=1\n\nproviding that I(*Ui * Ui+1 *) \u2264 \u2206, and l(*Ui *) \u2265 L. Moreover, by the\nLong Segment Lemma for Angles (for L large enough) we have\nI([*U1 * U2 * ... * Un *]) \u2212\n\nn\nX\n\nI(\u03b8i ) \u2264 2\u000f,\n\ni=1\n\nwhere \u03b8i = \u0398(t(*Ui *), i(*Ui+1 *)).\nSimilarly, the following lemma follows from Lemma 4.9.\nLemma 6.3. Let \u000f, \u2206 > 0 and n \u2208 N. There exists L = L(\u000f, \u2206, n) > 0\nsuch that if U1 , ..., Un+1 = U1 \u2208 \u03c01 (S, \u2217) and X11 , ...X1j1 , ...Xn1 , ...Xnjn \u2208\n\u03c01 (S, \u2217), and I(*Ui * Xi * Ui+1 ) \u2264 \u2206, and l(*Ui *) \u2265 L, then\nI([*U1 * X11 * ... * X1j1 * ... * Un * Xn1 * ... * Xnjn *]) \u2212\n\nn\nX\n\nI(*Ui * Xi1 ...Xiji * Ui+1 *) \u2264 \u000f.\n\ni=1\n\nFinally, we have the Flipping Lemma.\n6.4. The Flipping Lemma. For X \u2208 \u03c01 (S, \u2217) we let X\u0304 = X \u22121 denote\nthe inverse of X.\nLemma 6.4 (Flipping Lemma). Let \u000f, \u2206 > 0. There exists a constant\nL = L(\u000f, \u2206) > 0 with the following properties. Suppose A, B, T \u2208\n\u03c01 (S, \u2217), and\nI(*T * A * T\u0304 *), I(*T\u0304 * B * T *) \u2264 \u2206,\nand l(*T *) \u2265 L. Then\nI([*T * A * T\u0304 * B*]) \u2212 I([*T * \u0100 * T\u0304 * B*]) < \u000f,\n\n\fTHE EHRENPREIS CONJECTURE\n\n45\n\nand therefore\nl([T AT\u0304 B]) \u2212 l([T \u0100T\u0304 B]) < \u000f.\nProof. By the Long Segment Lemmas,\nI(*T * A * T\u0304 * B * T *) \u2212 I(*T * A * T\u0304 *) \u2212 I(*T\u0304 * B * T *) <\nand\n\n\u000f\n4\n\n\u000f\nI(*T * A * T\u0304 * B*) \u2212 I(*T * A * T\u0304 * B * T *) < .\n4\n\nLikewise\nI(*T * \u0100 * T\u0304 * B * T *) \u2212 I(*T * \u0100 * T\u0304 *) \u2212 I(*T\u0304 * B * T *) <\n\n\u000f\n4\n\nand\n\n\u000f\nI(*T * \u0100 * T\u0304 * B*) \u2212 I(*T * \u0100 * T\u0304 * B * T *) < .\n4\nBut I(*T * A * T\u0304 *) = I(*T * \u0100 * T\u0304 *), because *T * A * T\u0304 * is the same as\n*T * \u0100 * T\u0304 * with reversed orientation. So\nI([*T * A * T\u0304 * B*]) \u2212 I([*T * \u0100 * T\u0304 * B*]) < \u000f.\nSimilarly we conclude l([T AT\u0304 B]) \u2212 l([T \u0100T\u0304 B]) < \u000f.\n\u0003\n7. Applications of the Algebraic Square Lemma\nIn this section we will describe the encoding of an element A of\n\u03c01 (S, \u2217) as a sum AT of good pants (the encoding depends on a choice\nof a sufficiently large element T of \u03c01 (S, \u2217)).\nIn brief, we let\n\u0001\n1\nAT =\n[T AT\u0304 B] \u2212 [T \u0100T\u0304 B]\n2\nfor suitable B, and then observe that the Algebraic Square Lemma\nimplies that different choices of B give the same element of the good\npants homology.\nWe can then easily prove that\n[T AT\u0304 B] = AT + BT\u0304 ,\nwhich we call the Two-Part Itemization Lemma. We want to go one\nstep further and prove that\n[T AT\u0304 BT C T\u0304 D] = AT + BT\u0304 + CT + DT\u0304 ,\nfor suitable A, B, C, D and T .\n\n\f46\n\nKAHN AND MARKOVIC\n\nIt turns out that in order to prove this Four-Part Itemization Lemma\nwe must first prove that\n[T AT\u0304 BT C T\u0304 D] = [T AT\u0304 DT C T\u0304 B].\nThis is indeed the most difficult lemma of this section.\nWe would then be able to go ahead and prove a Six-Part Itemization\nLemma and so forth but the Four-Part Itemization Lemma is sufficient\nfor our purposes.\nWe state several results and definitions (notably the definition of AT\nin the next lemma), which depend on an element T \u2208 \u03c01 (S, \u2217) and\n\u2206 > 0. We treat both T and \u2206 as parameters, and the exact value of\nboth T and \u2206 (that are then used in the proof of the main theorem)\nwill be determined in Section 9.\n7.1. The definition of AT . For A, T \u2208 \u03c01 (S, \u2217), and \u000f, R > 0, we let\nFConn\u000f,R (A, T ) be the set all B \u2208 \u03c01 (S, \u2217) such that [T AT\u0304 B], [T \u0100T\u0304 B] \u2208\n\u0393\u000f,R , and I(*T\u0304 * B * T *) < 1.\nLemma 7.1. Let \u000f, \u2206 > 0. There exists a constant L = L(S, \u000f, \u2206)\nsuch that if A, T \u2208 \u03c01 (S, \u2217) and I(*T * A * T\u0304 *) \u2264 \u2206, and l(*T *) \u2265 L, and\n2R \u2212 l(*A*) \u2212 2l(*T *) \u2265 L, then\n(1) FConn\u000f,R (A, T ) is non-empty, and log FConn\u000f,R (A, T ) \u2265 2R\u2212\nl(*A*) \u2212 2l(*T *) \u2212 \u2206 \u2212 L,\n(2) [T AT\u0304 B] \u2212 [T \u0100T\u0304 B] = [T AT\u0304 B 0 ] \u2212 [T \u0100T\u0304 B 0 ] in \u03a0100\u000f,R homology\nfor any B, B 0 \u2208 FConn\u000f,R (A, T ).\nWe then let\n\u0001\n1\nAT = [T AT\u0304 B] \u2212 [T \u0100T\u0304 B]\n2\nfor a random B \u2208 FConn\u000f,R (A, T ).\nRemark. The part (2) of Lemma 7.1 implies that for any given B \u2208\nFConn\u000f,R (A, T ) we have\n\u0001\n1\nAT = [T AT\u0304 B] \u2212 [T \u0100T\u0304 B]\n2\nin \u03a0100\u000f,R homology. Also, it is important to note that [A] is equal to\nAT in the standard homology H1 .\nProof. Suppose that *B* \u2208 Conn\u000f,R0 (\u2212i(*T *), i(*T *)), where R0 = 2R \u2212\nl(*A*) \u2212 2l(*T *) \u2212 I(*T * A * T\u0304 *). The set Conn\u000f,R0 (\u2212i(*T *), i(*T *)) will\nbe non-empty (by the Connection lemma (Lemma 3.1)) provided L is\nlarge. Then, by the Sum of Inefficiencies Lemma,\nl([T AT\u0304 B]) \u2212 2R < \u000f + O(\u000f2 ),\n\n\fTHE EHRENPREIS CONJECTURE\n\n47\n\nand\nl([T \u0100T\u0304 B]) \u2212 2R < \u000f + O(\u000f2 ),\nprovided l(*T *) is large. Thus, with slight abuse of notation we have\nConn\u000f,R0 (\u2212i(*T *), i(*T *)) \u2282 FConn\u000f,R (A, T ),\nand\nlog |Conn\u000f,R0 (\u2212i(*T *), i(*T *)| \u2265 2R \u2212 l(*A*) \u2212 2l(*T *) \u2212 L\nif L is large, so we have proved the statement (1) of the lemma.\nAgain, by the Sum of Inefficiencies Lemma, the inefficiency of the\npiecewise geodesic [*T *A*T\u0304 *B*] is at most \u2206+2. Then the statement (2)\nthen follows, provided L (and hence (l(*T *)) is large, from the Algebraic\nSquare Lemma.\n\u0003\nRandomization: Randomization remarks for AT . All constants K\nmay depend only on \u000f, \u2206, and S and T \u2208 \u03c01 (S, \u2217).\nLetting B A \u2208 RG denote the random element of FConn\u000f,R (A, T ),\nwe consider the map A \u2192 B A from G to RG. If l(*A*) \u2208 [a, a + 1], we\nfind that l(*B*) \u2208 [La , Ra ], where La = 2R \u2212 a \u2212 2l(*T *) \u2212 \u2206 \u2212 4 and\nRa = 2R \u2212 a \u2212 2l(*T *), for all B \u2208 FConn\u000f,R (A, T ). Because\nFConn\u000f,R (A, T ) > eLa \u2212L\n(where L = L(\u000f, S) from the Connection Lemma), and \u03c3a (G) \u2264 K (see\nAppendix for the definition of \u03c3a ), we find that for any X \u2208 G\n(A \u2192 B A )\u2217 \u03c3a (X) \u2264 KeL\u2212La ,\nif l(*X*) \u2208 [La , Ra ], and (A \u2192 B A )\u2217 \u03c3a (X) = 0 otherwise. This implies\nbRb c\n\n(A \u2192 B A )\u2217 \u03c3a \u2264 K\n\nX\n\nek+L\u2212La \u03c3k ,\n\nk=bLa c\n\nwhich in turn implies that the map A \u2192 B A is K-semirandom with\nrespect to \u03a3G and \u03a3G .\nWe define [AT\u0304 B A T ] by\nX\n1\n[AT\u0304 B A T ] =\n[AT\u0304 BT ]\n|FConn\u000f,R (A, T )|\nB\u2208F Conn\u000f,R (A,T )\n\nThe map A \u2192 (A, T ), is el(*T *) semirandom by the remark stated just\nbefore the Principles of andomization section in the Appendix.\n\n\f48\n\nKAHN AND MARKOVIC\n\nThen the partial maps from G to RG4 defined by A \u2192 (A, T\u0304 , B A , T )\nand A \u2192 (\u0100, T\u0304 , B A , T ), are Ke2l(*T *) -semirandom with respect to \u03a3G\nand \u03a34G and hence the map\nA \u2192 AT =\n\n\u0001\n1\n[AT\u0304 B A T ] \u2212 [\u0100T\u0304 B A T ]\n2\n\nis Ke2l(*T *) -semirandom with respect to \u03a3G and \u03c3\u0393 .\nThe map (A, B 0 ) \u2192 (A, B A , B 0 ) is K-semirandom with respect to\n\u00d72\n0\n0\n2l(*T *)\n-semirandom\n\u03a3G and \u03a3\u00d73\nG , and (A, B A , B ) \u2192 (A, \u0100, T\u0304 , B A , B , T ) is Ke\n\u00d73\n\u00d72\n\u00022\nwith respect to \u03a3G and \u03a3G \u00d7 \u03a3G \u00d7 \u03a3G \u00d7 \u03a3G .\nAlso, by the Algebraic Square Lemma, the map (A, \u0100, T\u0304 , B, B 0 , T ) \u2192\n\u03a0 \u2208 R\u03a01,R , such that\n\u2202\u03a0 = [T AT\u0304 B] \u2212 [T \u0100T\u0304 B] \u2212 [T AT\u0304 B 0 ] + [T \u0100T\u0304 B 0 ],\nis K-semirandom from G2 \u00d7 G \u00d7 G2 \u00d7 G to \u03a01,R , with respect to the\n\u00022\nmeasure classes \u03a3\u00022\nG \u00d7 \u03a3G \u00d7 \u03a3G \u00d7 \u03a3G and \u03c3\u03a0 . Composing the above\n2l(*T *)\nmappings we find a Ke\n-semirandom map g : G2 \u2192 R\u03a01,R such\nthat\n\u2202g(A, B 0 ) = AT \u2212\n\n\u0001\n1\n[T AT\u0304 B 0 ] \u2212 [T \u0100T\u0304 B 0 ] .\n2\n\nRemark. At the end of the paper we will see that T and \u2206 only depend\non S and \u000f.\n7.2. The Two-part Itemization Lemma. The following lemma is\na corollary of the previous one and we refer to it as the Two-part\nItemization Lemma.\nLemma 7.2 (Two-part Itemization Lemma). Let \u000f, \u2206 > 0. There\nexists a constant L = L(S, \u000f, \u2206) > 0 such that for any A, B, T \u2208\n\u03c01 (S, \u2217) such that [T AT\u0304 B] \u2208 \u0393\u000f,R , we have [T AT\u0304 B] = AT + BT\u0304 in\n\u03a0200\u000f,R homology, provided that l(*T *), l(*A*), l(*B*) > L and I([*T * A *\nT\u0304 * B*]) \u2264 \u2206.\nProof. It follows from Lemma 6.4 that [T \u0100T\u0304 B] \u2208 \u03932\u000f,R . In order to\napply Lemma 7.1 we need an upper bound on I(*T * \u0100 * T\u0304 *) and a lower\nbound on 2R \u2212 l(*A*) \u2212 2l(*T *). These follow from l(*B*), l(*T *) \u2265 L,\nI([*T * A * T\u0304 * B*]) \u2264 \u2206, and the Sum of Inefficiencies Lemma.\n\n\fTHE EHRENPREIS CONJECTURE\n\n49\n\nWe observe\n\u0001\n1\n[T AT\u0304 B] \u2212 [B\u0304T \u0100T\u0304 ]\n2\n\u0001\n1\n= [T AT\u0304 B] \u2212 [T \u0100T\u0304 B\u0304]\n2\n\u0001\n1\n= [T AT\u0304 B] \u2212 [T \u0100T\u0304 B]\n2\n\u0001\n1\n+ [T\u0304 BT \u0100] \u2212 [T\u0304 B\u0304T \u0100]\n2\n= AT + BT\u0304 ,\n\n[T AT\u0304 B] =\n\nin \u03a0200\u000f,R homology.\n\u0003\nRandomization: The randomization remarks for the Two-part Itemization Lemma. We have implicitly defined a map g : G2 \u2192 R\u03a0100\u000f,R\nsuch that \u2202g(A, B) = AT + BT \u2212 [AT\u0304 BT ]. The map g is Ke2l(*T *) semirandom with respect to \u03a3G \u00d7 \u03a3G and \u03c3\u03a0 .\nRemark. In fact it should be true that\nn\nX\n(10)\n[T A1 T\u0304 B1 ...T An T\u0304 Bn ] =\n(Ai )T + (Bi )T\u0304 ,\ni=1\n\nprovided l(*T *) is large given I(T Ai T\u0304 ) and I(T\u0304 Bi T ). Above we proved\nthis when n = 1 (provided l(*A*) and l(*B*) are large) and we will\nprove it in the rest of this section for n = 2, using the ADCB lemma\nwhich we prove next. The general case can be proved by induction using\nthe cases n = 1 and n = 2 (but we will only need this statement for\nn = 1, 2).\nRemark.\nWe also observe that under the usual conditions we have AT U =\nAU in \u03a0100\u000f,R homology. This follows from the fact that 2AT U =\n[T U A\u016a T\u0304 B] + [T U A\u016a T\u0304 B\u0304] = [U A\u016a T\u0304 BT ] + [U A\u016a T\u0304 B\u0304T ] = 2AU .\n7.3. The ADCB Lemma.\nClaim. Let \u03b4, \u2206 > 0. There exists L = L(\u2206, \u03b4) > 0 with the following\nproperties. Let Ai , Bi , T \u2208 \u03c01 (S, \u2217), i = 0, 1. If l(*T *) > L and I(*T\u0304 *\nAi * T *) then\nl([A0 T B0 T\u0304 A1 T B1 T\u0304 ]) \u2212\n\n1\nX\ni=0\n\nl(*T\u0304 Ai T *) \u2212\n\n1\nX\ni=0\n\nl(*T Bi T\u0304 *) + 4l(*T *) < \u03b4.\n\n\f50\n\nKAHN AND MARKOVIC\n\nProof. By the Sum of Inefficiencies Lemma we have that\nI([*A0 * B0 * T\u0304 * A1 * T * B1 * T\u0304 *])\nis close to\nX\n\nI(*T\u0304 * Ai * T *) + I(*T * Bj * T\u0304 *).\n\ni=0,1\n\nBy the definition of inefficiency, the number\nX\n\u0001\nl([A0 T B0 T\u0304 A1 T B1 T\u0304 ]) \u2212 4l(T ) \u2212\nl(Ai ) + l(Bi )\ni=0,1\n\n\u2212\n\nX\n\n\u0001\nl(*T\u0304 Ai T *) + l(*T Bi T\u0304 *) \u2212 4l(T ) \u2212 l(Ai ) \u2212 l(Bi )\n\ni=0,1\n\nis small in absolute value. The claim now follows from the Sum of\nInefficiencies Lemma.\n\u0003\nLemma 7.3 (ADCB Lemma). Let \u000f, \u2206 > 0. There exists L = L(S, \u000f, \u2206) >\n0 and R0 = R0 (S, \u000f, \u2206) > 0 with the following properties. Let A, B, C, D, T \u2208\n\u03c01 (S, \u2217) such that l(*B*), l(*D*), l(*T *) > L. If R > R0 and\nI(*T * A * T\u0304 *), I(*T * C * T\u0304 *), I(*T * B * T\u0304 *), I(*T * D * T\u0304 *) \u2264 \u2206\nthen [AT B T\u0304 CT DT\u0304 ] = [AT DT\u0304 CT B T\u0304 ] in \u03a0200\u000f,R homology provided\nthat the curves in question are in \u0393\u000f,R .\nProof. Let hX, Y i = [AT X T\u0304 CT Y T\u0304 ], for X, Y \u2208 \u03c01 (S, \u2217), and let\n{X, Y } = hX, Y i \u2212 hY, Xi when both are in \u0393\u000f,R . We claim that\n(11)\n\n{X, Y0 } = {X, Y1 }\n\nin \u03a0100\u000f,R whenever I(T X T\u0304 ), I(T Yi T\u0304 ) \u2264 \u2206, and the curves in question\nare in \u0393\u000f,R . To verify (11) we let Ai = Yi , B0 = AT X T\u0304 C, B1 =\nCT X T\u0304 A, and U = T\u0304 and V = T , where Ai , Bi , U, V are from the\nstatement of the Algebraic Square Lemma. Since by rotation\nhX, Y0 i = [Y0 T\u0304 AT X T\u0304 CT ]\nhY0 , Xi = [Y0 T\u0304 CT X T\u0304 AT ]\nhX, Y1 i = [Y1 T\u0304 AT X T\u0304 CT ]\nhY1 , Xi = [Y1 T\u0304 CT X T\u0304 AT ],\nthe equation (11) follows from the Algebraic Square Lemma (the hypotheses in the Algebraic Square Lemma follow from the hypothesis of\nthis lemma and the Sum of Inefficiencies Lemma) . Likewise,\n(12)\n\n{X0 , Y } = {X1 , Y }\n\nunder the appropriate hypotheses.\n\n\fTHE EHRENPREIS CONJECTURE\n\n51\n\nIn order to prove the lemma we first suppose that |l(*T B T\u0304 *) \u2212\nl(*T DT\u0304 *)| < 4\u000f . If L is large enough (and hence l(*B*),l(*D*) and l(*T *)\nare large enough), it follows from the Connection Lemma that we can\nfind a random geodesic arc\n*E* \u2208 Conn\u000f,l(*T B T\u0304 *)\u22122l(*T *) (\u2212i(*T *), i(*T *)).\nFor any such E we have |l(*T B T\u0304 *) \u2212 l(*T E T\u0304 *)| < \u000f + O(\u000f2 ). Therefore,\nby the previous Claim we have that the curves hB, Ei, hE, Bi, hD, Ei,\nand hE, Di are in \u03932\u000f,R . Then from (11) and (12) it follows that\n{B, D} = {B, E} = {D, E} = {D, B},\nand therefore {B, D} = 0, in \u03a0200\u000f,R homology.\nMore generally, if l(*B*), l(*D*) > L let k be the smallest integer such\nthat\n|l(*T DT\u0304 *) \u2212 l(*T B T\u0304 *)|\n.\nk>4\n\u000f\nSet\ni\n2k \u2212 i\nri =\nl(*T DT\u0304 *) +\nl(*T B T\u0304 *) \u2212 2l(*T *).\n2k\n2k\nFor 0 < i < 2k we take random *Ei * \u2208 Conn\u000f,ri (t(*T *), i(T\u0304 )) (observe\nthat ri > L \u2212 \u2206), and we let E0 = D and E2k = B. Then\n{E0 , E2k } = {E1 , E2k }\n= {E1 , E2k\u22121 } = {E2 , E2k\u22121 }\n= {E2 , E2k\u22122 } = {E3 , E2k\u22122 }\n..\n.\n= {Ek\u22121 , Ek+1 } = {Ek , Ek+1 }\nand {Ek , Ek+1 } = 0 in \u03a0200\u000f,R homology by the first case so we are\nfinished.\n\u0003\nRandomization: The randomization remarks for the ADCB Lemma.\nAll constants K may depend only on \u000f, S and \u2206. We have defined a\nmap g : G4 \u2192 R\u03a01,R such that\n\u2202g(A, B, C, D) = [AT B T\u0304 CT DT\u0304 ] \u2212 [AT DT\u0304 CT B T\u0304 ].\nIn particular, we defined h : G5 \u2192 R\u03a01,R so that\n\u2202h(A, C, X, Y0 , Y1 ) = {X, Y0 } \u2212 {X, Y1 }.\nThis map h is e4l(*T *) K-semirandom with respect to the measure classes\n\u00022\n\u03a3\u00d72\nG \u00d7 \u03a3G \u00d7 \u03a3G and \u03a3\u03a0 .\n\n\f52\n\nKAHN AND MARKOVIC\n\nThen g(A, B, C, D) is a sum of 2k terms of the form \u2202h(A, C, X, Y0 , Y1 ),\nwhere each of X, Y0 , Y1 is either B or D, or Ei , which is a K-semirandom\nelement of G with respect to \u03a3G . Moreover, the Yi are always independent from X. Therefore, for each choice we make of X, Y0 , Y1 (such as\nX = Ei , , Y0 = E2k\u2212i , Y1 = E2k\u2212i+1 or X = B, and Y0 = D, Y1 = E)\nthe map from (A, B, C, D) to (A, C, X, Y0 , Y1 ) is K-semirandom with\nb8Rc\n\u00d72\n\u00022\nrespect to \u03a3\u00d74\n,\nG and \u03a3G \u00d7 \u03a3G \u00d7 \u03a3G . Therefore, noting that k <\n\u000f\n\u00d74\n4l(*T *)\nwe find that g is KRe\n-semirandom, with respect to \u03a3G .\nRemark. This is a remark to the previous randomization remark.\nWhere B and D are close in length, we can write {B, D} = {B, B}\nby (11), and hence {B, D} = 0. But we are letting (X, Y0 , Y1 ) be\n(B, D, B), and the map (B, D) \u2192 (B, D, B) is not 1-semirandom for\n\u00022\n\u03a3\u00d72\nG and \u03a3G \u00d7 \u03a3G (because X and Y1 are not independent). This map\nl(*B*)\nis only e\n-semirandom, which is no good. It is for this reason that\nwe introduce E.\nThe following lemma is a corollary of the ADCB Lemma. We call\nit the Four-part Itemization Lemma.\nLemma 7.4 (Four-part Itemization Lemma). Let \u000f, \u2206 > 0. There\nexists L = L(\u000f, \u2206) > 0 such that for any A, B, C, D, T \u2208 \u03c01 (S, \u2217) we\nhave\n[AT\u0304 BT C T\u0304 DT ] \u2212 [T\u0304 D\u0304T C\u0304 T\u0304 B\u0304T \u0100] = 2(AT\u0304 + BT + CT\u0304 + DT )\nin \u03a0200\u000f,R homology provided that l(*T *) > L and I(*A * T\u0304 * B * T * C *\nT\u0304 * D * T *) < \u2206, and the curve [AT\u0304 BT C T\u0304 DT ] is in \u0393\u000f,R .\nProof. Recall the remark after the statement of Lemma 7.1. We have\n[AT\u0304 BT C T\u0304 DT ] \u2212 [\u0100T\u0304 BT C T\u0304 DT ] = 2AT\u0304\n[\u0100T\u0304 BT C T\u0304 DT ] \u2212 [\u0100T\u0304 B\u0304T C T\u0304 DT ] = 2BT\n[\u0100T\u0304 B\u0304T C T\u0304 DT ] \u2212 [\u0100T\u0304 B\u0304T C\u0304 T\u0304 DT ] = 2CT\u0304\n[\u0100T\u0304 B\u0304T C\u0304 T\u0304 DT ] \u2212 [\u0100T\u0304 B\u0304T C\u0304 T\u0304 D\u0304T ] = 2DT ,\nin \u03a0100\u000f,R homology (all the curves in question lie in \u03932\u000f,R by the Flipping Lemma). So\n[AT\u0304 BT C T\u0304 DT ] \u2212 [\u0100T\u0304 B\u0304T C\u0304 T\u0304 D\u0304T ] = 2(AT\u0304 + BT + CT\u0304 + DT )\nin \u03a0100\u000f,R homology. But\n[\u0100T\u0304 B\u0304T C\u0304 T\u0304 D\u0304T ] \u2212 [\u0100T\u0304 D\u0304T C\u0304 T\u0304 B\u0304T ] = 0\nin \u03a0200\u000f,R homology by the ADCB Lemma so we are finished.\n\u0003\n\n\fTHE EHRENPREIS CONJECTURE\n\n53\n\nRandomization: The randomization remark for the Four-part Itemization Lemma. We have defined g : G4 \u2192 R\u03a01,R such that\n\u2202g(A, B, C, D) = [AT B T\u0304 CT DT\u0304 ] \u2212 (AT\u0304 + BT + CC\u0304 + DT ).\nThis map is KRe4l(*T *) -semirandom with respect to \u03a3\u00d74\nG and \u03c3\u03a0 , for\nsome K = K(\u000f, S).\n8. The XY Theorem\nIn this section we prove the XY Theorem which states that\n(XY )T = XT + YT\nfor suitable X, Y and T .\nThe XY Theorem will be the central identity in the last section of the\npaper; it will allow us to reduce the encoding of long elements of \u03c01 (S, \u2217)\nto encoding of the generators. To prove the XY Theorem we will first\nprove two related statements called the First and the Second Rotation\nLemmas. These are in turn proven with the Four-Part Itemization\nLemma and the estimates from the Theory of Inefficiency.\n8.1. The Rotation Lemmas. Let X, Y, Z \u2208 \u03c01 (S, \u2217). Then we have\nthe three geodesic arcs *X*, *Y *, and *Z*. Consider the union of these\nthree geodesic arcs as a \u03b8-graph on the surface S. This \u03b8-graph generates an immersed pair of pants in S if and only if the triples of unit\nvectors i(*X*), i(*Y *), i(*Z*) and t(*X*), t(*Y *), t(*Z*), have the opposite\ncyclic orderings.\nThe following is the First Rotation Lemma.\nLemma 8.1 (First Rotation Lemma). Let \u000f, \u2206 > 0. There exists\nK = K(\u000f, \u2206) > 0 with the following properties. Let Ri , Si , T \u2208 \u03c01 (S, \u2217),\ni = 0, 1, 2, such that\n(1) I(*T * Ri * R\u0304i+1 * T\u0304 *), I(*T * Si * S\u0304i+1 * T\u0304 *) < \u2206,\n(2) l(*T *) \u2265 K,\n(3) l(*Ri *) + l(*Si *) + 2l(*T *) < R \u2212\u0001 K,\n\u0001\n(4) The triples of vectors t(*T Ri *) and t(*T Si *) , i = 0, 1, 2, have\nopposite cyclic ordering in T\u22171 S (one of them is clockwise and\nthe other one anti-clockwise).\nThen\n2\n2\nX\nX\n(13)\n(Ri+1 R\u0304i )T +\n(Si S\u0304i+1 )T = 0,\ni=0\n\nin \u03a0300\u000f,R homology.\n\ni=0\n\n\f54\n\nKAHN AND MARKOVIC\n\nT\n\nT\n\nR1\nR0\nR2\nT\nA2\n\nA1\n\nA0\n\nT\n\nS2\nS0\n\nS1\n\nT\n\nT\nFigure 6. The Rotation Lemma\n\nRemark. It follows by relabeling that if max(l(*Ri *))\u0001+ max(l(*Si *)) +\n\u0001\n2l(*T *) < R \u2212 K and the triples of vectors t(*T Ri *) and t(*T Si *) ,\ni = 0, 1, 2, have the same cyclic ordering in T\u22171 S, then\n(14)\n\n2\nX\ni=0\n\n(Ri R\u0304i+1 )T +\n\n2\nX\n\n(Si S\u0304i+1 )T = 0,\n\ni=0\n\nin \u03a0300\u000f,R homology.\nProof. Let ri \u2265 0, i = 0, 1, 2, be the solutions of the equations\n(15)\n\nri + ri+1 = 2R \u2212 l(*T Ri+1 R\u0304i T\u0304 *) \u2212 l(*T Si S\u0304i+1 T\u0304 *).\n\nThen we let Ai be a random element of Conn\u000f,ri (\u2212i(*T *), i(*T *)).\nConsider the three elements R\u0304i T\u0304 Ai T Si of \u03c01 (S, \u2217) and the corresponding geodesic arcs *R\u0304i T\u0304 Ai T Si *. We will show that the corresponding \u03b8-graph generates an immersed pair of pants \u03a0A in S. The three\ncuffs of \u03a0A are the closed curves [R\u0304i+1 T\u0304 Ai+1 T Si+1 S\u0304i T\u0304 \u0100i T Ri ]. We will\nalso show that these closed geodesics have length 3\u000f close to 2R, which\nimplies that \u03a0A \u2208 \u03a03\u000f,R .\n\n\fTHE EHRENPREIS CONJECTURE\n\n55\n\nWe finish the argument as follows. Taking the boundary of \u03a0A , we\nobtain\n2\nX\n[R\u0304i T\u0304 Ai T Si S\u0304i+1 T\u0304 \u0100i+1 T Ri+1 ] = 0\ni=0\n\nin \u03a03\u000f,R homology. Applying the Four-part Itemization Lemma we find\n2\nX\n0=\n[Ri+1 R\u0304i T\u0304 Ai T Si S\u0304i+1 T\u0304 \u0100i+1 T ]\ni=0\n\n=\n\n2\nX\n\n(Ri+1 R\u0304i )T + (Ai )T\u0304 + (Si S\u0304i+1 )T + (\u0100i+1 )T\u0304\n\n\u0001\n\ni=0\n2\n2\nX\nX\n=\n(Ri R\u0304i+1 )T +\n(Si S\u0304i+1 )T ,\ni=0\n\ni=0\n\nin \u03a0300\u000f,R , because (Ai )T\u0304 = \u2212(\u0100i )T\u0304 .\nWe now verify that [R\u0304i T\u0304 Ai T Si S\u0304i+1 T\u0304 \u0100i+1 T Ri+1 ] \u2208 \u03932\u000f,R . By the New\nAngle Lemma (Lemma 4.2), applied to \u03b2 = *T\u0304 * and \u03b1 = *T * Ri *, for K \u0001\nlarge enough (and therefore l(*T *) large) the\n\u0398 i(*T *), i(*T Ri+1 R\u0304i T\u0304 *) \u2264\n\u0001 angle\n\u000f\n\u000f\n, and likewise \u0398 t(*T\u0304 *), t(*T Ri+1 R\u0304i T\u0304 *) \u2264 10 , and for the same\n10\n\u0001 with\nRi replaced with Si . It follows that \u0398 t(*\u0100i+1 *), i(*T Ri+1 R\u0304i T *) < 2\u000f,\nand so on, so by the Sum of Inefficiencies Lemma (using equation (5))\nl([R\u0304i T\u0304 Ai T Si S\u0304i+1 T\u0304 \u0100i+1 T Ri+1 ])\u2212l(*Ai *)\u2212l(*T Ri+1 R\u0304i T\u0304 *)\u2212l(*Ai+1 *)\u2212\n\u2212 l(*T Si S\u0304i+1 T\u0304 *) < O(\u000f2 ),\nand moreover by (15) we have\nl(*Ai *) + l(*T Ri+1 R\u0304i T\u0304 *) + l(*Ai+1 *) + l(*T Si S\u0304i+1 T\u0304 *) \u2212 2R < 2\u000f,\nwhich proves the claim.\nWe now verify that the \u03b8-graph associated to the geodesic arcs *R\u0304i T\u0304 Ai T Si *\ngenerates an immersed pair of pants \u03a0A in S. We find the unique\n\u2206+1\n\u03b80 \u2208 [0, \u03c0] such that I(\u03c0 \u2212 \u03b80 ) = \u2206 + 1 (that is \u03c0 \u2212 \u03b80 = 2 sec\u22121 (e 2 )).\nObserve that I(*R\u0304i * T\u0304 *) < I(*T * Ri+1 * R\u0304i * T\u0304 *) \u2264 \u2206. Then l(*R\u0304i T\u0304 *) >\nl(*T *) \u2212 \u2206 > K \u2212 \u2206. By the Sum of Inefficiencies Lemma for Angles\n\u0001\nI(\u03c0 \u2212 \u0398 i(*R\u0304i T\u0304 *), i(*R\u0304i+1 T\u0304 *) ) \u2212 1 < I(*T Ri+1 * R\u0304i T\u0304 *)\n\u2264 I(*T * Ri+1 * R\u0304i * T\u0304 *) < \u2206.\nTherefore \u0398 i(*R\u0304i T\u0304 *), i(*R\u0304i+1 T\u0304 *)) > \u03b80 .\n\n\f56\n\nKAHN AND MARKOVIC\n\nOn the other hand, by the New Angle Lemma, because the geodesic\narc *R\u0304i T\u0304 * is long for large enough K (we showed\nthat l(*R\u0304i T\u0304 *) >\n\u0001 above\n\u03b80\nK \u2212 \u2206), we have \u0398 i(*R\u0304i T\u0304 *), i(*R\u0304i T\u0304 Ai T Si *) < 2 , so the cyclic order\nof the triple of vectors i(*R\u0304i T\u0304 Ai T Si *), i = 0, 1, 2, is the same as of the\ntriple of vectors i(*R\u0304i T\u0304 *), and likewise the cyclic order of the triple of\nvectors t(*R\u0304i T\u0304 Ai T Si *), i = 0, 1, 2, is the same as of the triple of vectors\nt(*T Si *). So the corresponding cyclic orderings are opposed and we are\nfinished.\n\u0003\nRandomization: The randomization remark for the First Rotation\nLemma. We let K = K(\u000f, S). We have defined g : G6 \u2192 R\u03a01,R such\nthat\n2\nX\n\u2202g(R0 , R1 , R2 , S0 , S1 , S2 ) =\n(Ri+1 R\u0304i )T + (Si S\u0304i+1 )T .\ni=0\n\nLet \u03a0 denote the pants whose \u03b8-graph is made out of the three connections *R\u0304i T\u0304 Ai T Si S\u0304i+1 T\u0304 Ai+1 T Ri+1 *, i = 0, 1, 2. We can write\ng((Ri ), (Si )) = \u03a0 +\n\n2\nX\n\ng1 (Ri+1 R\u0304i , Ai , Si S\u0304i+1 , \u0100i+1 ),\n\ni\u22120\n\nwhere g1 is the map from the F our \u2212 part \u2212 Itemization Lemma (see\nthe randomization remark). So g is K(e12l(*T *) + Re4l(*T *) )-semirandom\nwith respect to \u03a3\u00d76\nG and \u03a3\u03a0 .\nThe Second Rotation Lemma is:\nLemma 8.2 (Second Rotation Lemma ). Let \u000f, \u2206 > 0. There exists\nK = K(\u000f, \u2206) > 0 with the following properties. Let Ri , T \u2208 \u03c01 (S, \u2217),\ni = 0, 1, 2, such that\n(1) I(*T * Ri * R\u0304i+1 * T\u0304 *) < \u2206,\n(2) l(*T *) \u2265 K.\nThen\n2\nX\n(16)\n(Ri R\u0304i+1 )T = 0,\ni=0\n\nin \u03a0300\u000f,R homology.\n2\u03c0i\n\nProof. Given T ; We choose v \u2208 T\u22171 S and let \u03c1 = e 3 . We take L sufficiently large so that Conn\u000f,L (t(*T *), \u03c1i v) is non-empty, for i = 0, 1, 2.\nThen we choose *Si * \u2208 Conn\u000f,L (t(*T *), \u03c1i v). Then I(*T * Si * S\u0304i+1 * T\u0304 *) \u2264\nlog 34 + O(\u000f) \u2264 1, by the Sum of Inefficiencies for Angles Lemma, so\n\n\fTHE EHRENPREIS CONJECTURE\n\n57\n\nwhen l(*T *) is large we can apply the previous Lemma (see the Remark\nafter Lemma 8.1) with Ri := Si to obtain\n2\n\n2\nX\n\n(Si S\u0304i+1 )T = 0\n\ni=0\n\nin \u03a0300\u000f,R homology.\nThen given Ri as in the hypothesis to this lemma, we obtain\n2\nX\n\n(Si S\u0304i+1 )T + (Ri R\u0304i+1 )T = 0,\n\ni=0\n\nso\n2\nX\n\n(Ri R\u0304i+1 )T = 0.\n\ni=0\n\n\u0003\nRandomization: The randomization remark for the Second Rotation\nLemma. All constants K may only depend on \u000f and S. We have defined\ng : G3 \u2192 R\u03a01,R such that\n\u2202g(R0 , R1 , R2 ) =\n\n2\nX\n\n(Ri Ri+1 )T .\n\ni=0\n\nWe are fixing S0 , S1 , S2 of length L, so the triple (S0 , S1 , S2 ) is e3L semirandom, and the maps (R0 , R1 , R2 ) \u2192 (R0 , R1 , R2 , S0 , S1 , S2 ) and\n(R0 , R1 , R2 ) \u2192 (S0 , S1 , S2 , S0 , S1 , S2 ) are e3L and e6L semirandom respectively.\nThen letting g1R be the g for the First Rotation Lemma, we can\nletter\n\u0001 1\n\u0001\ng(R0 , R1 , R2 ) = g1R (Ri ), (Si ) \u2212 g1R (Si ), (Si )\n2\n12l(*T *)\nand g1R is KRe\nsemirandom, so g is KRe6L+12l(*T *) semirandom.\n8.2. The XY Theorem. The following theorem follows from the Second Rotation Lemma. We call it the XY Theorem.\nTheorem 8.1 (XY Theorem). Let \u000f, \u2206 > 0. There exists K = K(\u000f, \u2206) >\n0 with the following properties. Let X, Y, T \u2208 \u03c01 (S, \u2217), i = 0, 1, 2, such\nthat\n(1) I(*T * X * Y * T\u0304 *), I(*T * X * T\u0304 *), I(*T * Y * T\u0304 *) < \u2206,\n(2) l(*T *) \u2265 K.\nThen (XY )T = XT + YT in \u03a0300\u000f,R homology.\n\n\f58\n\nKAHN AND MARKOVIC\n\nProof. Set R0 = id, R1 = X, and R2 = \u0232 , and apply the previous\nlemma.\n\u0003\nRandomization: We have defined the map gXY : (X, Y ) \u2192 R\u03a01,R\nsuch that \u2202gXY (X, Y ) = (XY )T \u2212 XT \u2212 YT (the map gXY is defined on\nthe appropriate subset of \u03a32G described in the statement of Theorem\n8.1). This map is RKe12l(*T *) -semirandom with respect to \u03a3\u00d72\nG and \u03c3\u03a0 ,\nwhere K = K(\u000f, \u2206).\n9. The Endgame\nIn this last section of the main text of the paper, we prove that every\ngood curve is good pants homologous to a sum of encodings of a given\nset of standard generators for \u03c01 (S, \u2217).\nWe prove this in three steps:\n1. We prove in Lemma 9.2 that every good curve is good pants homologous to a sum of two encodings of two elements of \u03c01 (S, \u2217); these\nelements are represented by geodesic segments of length about R.\n2. We use the XY Theorem and Lemma 9.3 to repeatedly write XT =\n(X1 )T +(X2 )T where X1 and X2 have length about half that of X. This\nallows us to reduce an encoding of an arbitrary element of \u03c01 (S, \u2217) to\na sum of encodings of elements of bounded length (bounded in terms\nof S and \u000f)\n3. We use the XY Theorem to reduce the encoding of an element of\n\u03c01 (S, \u2217) of bounded length to a sum of encodings of generators. This\nrequires the proper choice of T , which is discussed in Lemma 9.1.\n9.1. The good pants homology of short words. The following is\nthe Good Direction Lemma.\nLemma 9.1 (Good Direction Lemma). For any finite set W \u2282 \u03c01 (S, \u2217),\nwe can find \u2206 = \u2206(S, W ), such that for any L we can find T \u2208 \u03c01 (S, \u2217)\nsuch that l(*T *) > L and I(*T * X * T\u0304 *) < \u2206, when X \u2208 W .\nProof. For any v \u2208 T\u22171 S, and t > 0, we let \u03b1t (v) be the geodesic\nsegment of length t such that i(\u03b1t (v)) = v, and we let \u03b1\u221e (v) be the\ncorresponding infinite geodesic ray. We claim that for any X \u2208 \u03c01 (S, \u2217),\nand X 6= id, there are at most two v \u2208 T\u22171 S such that\n(17)\n\nlim I(\u03b1t\u22121 (v) * X * \u03b1t (v)) = \u221e.\n\nt\u2192\u221e\n\nTo prove the claim we lift *X* to the universal cover H2 , and thus\nget two lifts of \u2217, and hence two lifts of v. We observe that (17) holds\nif and only if the two lifts of \u03b1\u221e (v) end at the same point of \u2202H2 . The\n\n\fTHE EHRENPREIS CONJECTURE\n\n59\n\nmap that maps one lift of \u03b1\u221e (v) to the other is the deck transformation\nthat maps one lift of \u2217 to the other. The relation (17) holds if and only\nif \u03b1\u221e (v) is a fixed point of the M\u00f6bius transformation M , and since M\nis not the identity this can be true for at most two vectors v.\n\u0003\nIn the remainder of this section we fix a set of standard generators\ng1 , ..g2n of \u03c01 (S, \u2217) (here n is the genus of S). Recall that H1 denotes\nthe standard homology on S. Let [gi ] denote the corresponding closed\ncurves.\nP For any closed curve \u03b3 \u2282 S there are unique a1 , ...a2n such\nP that\n\u03b3 =\nai [gi ] in H1 . We define q : \u0393 \u2192 R\u03c01 (S, \u2217) by q(\u03b3) =\nai g i ,\nwhere \u0393 is the set of all closed curves on S. We extend the definition\nof q to a map q : \u03c01 (S, \u2217) \u2192 R{g1 , .., g2n } by q(X) = q([X]).\nFor l \u2208 N, we define the set Wl as the set of elements X \u2208 \u03c01 (S, \u2217)\nthat can be written as a product of at most l generators (or their\ninverses).\nTheorem 9.1. Let \u000f > 0. For all l \u2208 N, and L > 0, we can find\nT \u2208 \u03c01 (S, \u2217) and R0 such that l(*T *) > L, and for R > R0 , and\nX \u2208 Wl , we have\nXT = (q(X))T\nin \u03a0300\u000f,R homology.\nRemark. Here we extended the partial map (*)T : \u03c01 (S, \u2217) \u2192 R\u0393\u000f,R\n(given by X 7\u2192 XT ) to a partial map (*)T : R\u03c01 (S, \u2217) \u2192 R\u0393\u000f,R . We\nremind the reader that XT depends implicitly on R and \u000f.\nProof. We take \u2206 = \u2206(Wl ) and T = T (Wl , L) from the previous\nlemma, so l(*T *) > L and I(*T * X * T\u0304 ) < \u2206, for all X \u2208 Wl . If\nX \u2208 W1 , then q(X) = X or q(X) = \u2212X\u0304, so XT = (q(X))T .\nTake 1 \u2264 k < l, and assume XT = ((q(X))T in \u03a0300\u000f,R homology for\nall X \u2208 Wk . Then for any X \u2208 Wk+1 we can write X = gi\u03c3 Y , for some\ni \u2208 {1, .., 2n}, and \u03c3 = \u00b11, and Y \u2208 Wk . Then XT = (gi\u03c3 )T + YT by\nthe XY Theorem (see Theorem 8.1) which requires\nI(*T * X * T\u0304 *), I(*T * gi\u03c3 * T\u0304 *), I(*T * Y * T\u0304 *) < \u2206,\nand YT = (q(Y ))T by assumption, so XT = ((q(X))T . We conclude the\ntheorem by induction.\n\u0003\nRandomization: The Randomization remarks for Theorem 9.1. Given\nl, L, T and R (and \u000f) we have implicitly defined the map gW : Wl \u2192\n\u03a0300\u000f,R such that \u2202gW (X) = XT \u2212 (q(X))T . The map gW arises\nfrom a sum of at most l applications of the XY Theorem so gW is\n\n\f60\n\nKAHN AND MARKOVIC\n\nK(S)RKe12l(*T *) -semirandom, because every measure in \u03a3G has total\nmass at most K(S).\n9.2. Preliminary lemmas. We now observe that every good curve is\ngood pants homologous to (X0 )T + (X1 )T for suitable X0 and X1 from\n\u03c01 (S, \u2217).\nLemma 9.2. There exists a universal constant b\n\u000f > 0 such that for\nevery 0 < \u000f < b\n\u000f, there exist constants L = L(\u000f, S) > 0 and R0 =\nR0 (\u000f, S) > 0, with the following properties. For any \u03b3 \u2208 \u0393\u000f,R and\nT \u2208 \u03c01 (S, \u2217), l(*T *) > L, we can find X0 , X1 \u2208 \u03c01 (S, \u2217) such that\n(1) |l(*Xi *) \u2212 (R + 2L \u2212 log 4)| < 21 ,\n(2) \u0398(t(*T *), i(*Xi *)), \u0398(t(*Xi *), i(*T\u0304 *)) \u2264 \u03c06 ,\n(3) \u03b3 = (X0 )T + (X1 )T in \u03a0300\u000f,R homology,\nfor R > R0 .\nProof. We take at random two points x0 and x1 on the parameterizing\n\u221a\ntorus T\u03b3 that are hl(\u03b3) apart and we let wi \u2208 Tx1i S be \u2212 \u22121\u03b3 0 (xi ).\nWe let \u03b3i be the subsegment of \u03b3 from xi to xi+1 (where x2 = x0 ).\nFor i = 0, 1 we take \u03b1i \u2208 Conn 10\u000f ,L (t(*T *), wi ), where L = L(\u000f, S)\nis the constant from the Connection Lemma (that is, we choose L\nso that the set Conn 10\u000f ,L (t(*T *), wi ) is non-empty). Observe that the\npiecewise geodesic arc \u03b10 \u03b30 \u03b11\u22121 begins and ends at the point \u2217, so we let\nX0 \u2208 \u03c01 (S, \u2217) denote the corresponding element of \u03c01 (S, \u2217). Similarly\nwe let X1 \u2208 \u03c01 (S, \u2217) be the element that corresponds to the curve\n\u03b11 \u03b31 \u03b10\u22121 .\nIt follows from the Remark after Lemma 4.8 that the inequality (1)\nof the statement of the lemma holds. On the other hand, by the New\nAngle Lemma the angle \u0398(i(*X0 *), i(\u03b10 )) is as small as we want providing that l(\u03b10 ) > L is large enough (here we use that the inefficiency I(\u03b10 \u03b30 \u03b11\u22121 ) is bounded above). Since by construction the angle\n\u0398(i(\u03b10 ), t(*T *)) is less than 10\u000f we conclude that for L large enough we\nhave \u0398(t(*T *), i(*X0 *)) < \u03c06 . Other cases are treated similarly.\nLet *A* be a random element of Conn 10\u000f ,R0 (\u2212i(*T *), i(*T *)), where\n0\nR = R + log 4 \u2212 2L \u2212 2l(*T *). Then\nl([X0 T\u0304 \u0100T ]) \u2212 2R < \u000f,\nl([X1 T\u0304 AT ]) \u2212 2R < \u000f,\nso \u03b3 = [X0 T\u0304 \u0100T ]+[X1 T\u0304 AT ] in \u03a0\u000f,R homology, because the three curves\nbound a good pair of pants.\nMoreover, [X0 T\u0304 \u0100T ] = (X0 )T + (\u0100)T\u0304 , and [X1 T\u0304 AT ] = (X1 )T + AT\u0304 in\n\u03a0100\u000f,R homology by the Two-part Itemization Lemma. Since (\u0100)T\u0304 =\n\u2212AT\u0304 we conclude \u03b3 = (X0 )T + (X1 )T in \u03a0300\u000f,R homology.\n\n\fTHE EHRENPREIS CONJECTURE\n\n61\n\n\u0003\nRandomization: The randomization remarks for Lemma 9.2. We\nhave defined the maps qC : \u03931,R \u2192 RG (by qC (\u03b3) = X0 + X1 ) and\ngC : \u03931,R \u2192 R\u03a01,R , such that \u2202gC (\u03b3) = \u03b3 \u2212 (qC (\u03b3))T (where A \u2192 AT\nmaps RG \u2192 R\u03931,R ).\nThe map qC is eL K-semirandom with respect to \u03c3\u0393 and \u03a3G . The\nmap gC is e2l(*T *) K(S, \u000f) semirandom with respect to \u03c3\u0393 and \u03c3\u03a0 , where\nK = K(S, \u000f).\nWe have the following definition. For any X, T \u2208 \u03c01 (S, \u2217), X 6= id,\nwe let\nT\n\u03b8X\n= max{\u0398(t(*T *), i(*X*)), \u0398(t(*X*), i(*T\u0304 *))}.\nLemma 9.3. For L > L0 (S), and X, T \u2208 \u03c01 (S, \u2217), X 6= id, then we\ncan write X = X0 X1 , for some X0 , X1 \u2208 \u03c01 (S, \u2217), such that\n(1) l(*Xi *) \u2212 ( l(*X*)\n+ L \u2212 log 2) < 12 ,\n2\n(2) I(*X0 * X1 *) \u2264 2L + 3,\nT\nT\n\u2264 max{\u03b8X\n+ eL+4 e\u2212l(*Xi *) , \u03c06 }.\n(3) \u03b8X\ni\nProof. We let \u03b1 = *X*, then \u03b1 : [0, l(*X*)] \u2192 S is the unit speed\nparametrization with \u03b1(0) = \u03b1(l(*X*)) = \u2217. We let y = l(*X*)\n. Then\n\u221a 20\nfor L large enough, we can find \u03b2 \u2208 Conn 1 ,L (t(*T *), \u22121\u03b1 (y)) (as\n20\nalways, L is determined by the Connection Lemma).\nThen \u03b1[0, y]\u03b2 \u22121 begins and ends at \u2217, so it represents some X0 \u2208\n\u03c01 (S, \u2217). Likewise \u03b2\u03b1[y, l(*X*)] represents some X1 \u2208 \u03c01 (S, \u2217), and\nX = X0 X1 . Moreover, it follows from the Remark after Lemma 4.8\nthat\n\u0012\n\u0013\nl(*X*)\n1\nl(*Xi *) \u2212\n+ L \u2212 log 2 < .\n2\n2\nThe condition (2) follows immediately from (1).\nLet \u03b8 = \u0398(i(*X*), i(*X0 *)). Then by the hyperbolic law of sines,\nassuming that l(*Xi *) \u2265 1 (which follows if we assume that l(\u03b1) \u2265 L\u22121\nis at least 1) we obtain\nsinh(L + 1)\nsin(\u03b8) \u2264\n\u2264 eL+2\u2212l(*X0 *) ,\nsinh(l(*X0 *))\nTherefore\n\u0398(t(*T *), i(*X0 *)) \u2264 \u0398(t(*T *), i(*X*)) + eL+4\u2212l(*X0 *) .\n\u03c0\n, asBy similar reasoning we find that \u0398(t(*X0 *), \u2212i(\u03b2)) \u2264 e2\u2212L < 12\nsuming that L is large enough. Also by construction \u0398(\u2212i(\u03b2), t(*T *)) <\n1\n\u03c0\n< 12\n, so \u0398(t(*X0 *), i(*T\u0304 *)) \u2264 \u03c06 . We proceed similarly for X1 .\n20\n\u0003\n\n\f62\n\nKAHN AND MARKOVIC\n\nRandomization: The randomization remarks for Lemma 9.3. We\nhave defined qbD : G \u2192 G2 such that qbD (X) = (X0 , X1 ). If l(*X*) \u2208\n[a, a + 1], then l(*X0 *), l(*X1 *) \u2208 [ a2 + L0 , a2 + L0 + 1], where L0 = L \u2212\nlog 2 \u2212 12 .\nMoreover, given (X0 , X1 ) \u2208 G2 there is at most one X such that\nqbD (X) = (X0 , X1 ) (because X = X0 X1 ). We conclude that\n0\n\n(b\nqD )\u2217 \u03c3a \u2264 e2L +2 \u03c3 a2 +L0 \u00d7 \u03c3 a2 +L0 ,\n0\n\nand hence qbD is e2L +2 -semirandom. It follows that the map qD : G \u2192\n0\nRG defined by X \u2192 X0 + X1 , is 2e2L +2 -semirandom.\n9.3. Proof of Theorem 3.3. The following theorem implies Theorem\n3.3. Recall {g1 , ..., g2n } denotes a standard basis for \u03c01 (S, \u2217), where n\nis the genus of S.\nTheorem 9.2. Let \u000f > 0. There exists R0 = R0 (S, \u000f) > 0 with the\nfollowing properties. There exists T \u2208 \u03c01 (S, \u2217), where T depends only\non \u000f and S, such that for every R > R0 and every \u03b3 \u2208 \u0393\u000f,R we have\n\u03b3=\n\n2g\nX\n\nai (gi )T ,\n\ni=1\n\nin \u03a0300\u000f,R homology, for some ai \u2208 Q.\nRemark. To prove Theorem 3.3 we take hi = (gi )T . Since (gi )T is\nequal to the closed curve on S that corresponds to gi in the standard\nhomology H1 , it follows that hi is a basis for H1 (with rational coefficients).\nProof. We take L that is sufficiently large for Lemma 9.2 and Lemma\n9.3. We let l \u2208 N be such that X \u2208 Wl whenever l(*X*) < 2L + 5.\nThen by Theorem 9.1 we can find T such that l(*T *) > L and l(*T *) >\nK(\u000f, 2L + 3), where K(\u000f, \u2206) is the constant from Theorem 8.1, and\nsuch that XT = (q(X))T in \u03a0300\u000f,R homology for all X \u2208 Wl . We take\nR > R0 (S, \u000f, L) from Lemma 9.2, and R > R0 (L, T ) from Theorem 9.1.\nFix any \u03b3 \u2208 \u0393\u000f,R .\nBy Lemma 9.2 we can find X0 , X1 \u2208 \u03c01 (S, \u2217) such that |l(*Xi *) \u2212\n(R + 2L \u2212 log 4)| < 21 , and\n(18)\n\n\u03b3 = (X0 )T + (X1 )T\n\nin \u03a0300\u000f,R homology. Observe that q(\u03b3) = q(X0 ) + q(X1 ).\nBy Lemma 9.3 we can write X0 = X00 X01 , where\n\u0002R\n\u0003\nR\n(19)\nl(*X0i *) \u2208\n+ 2L, + 2L + 1\n2\n2\n\n\fTHE EHRENPREIS CONJECTURE\n\n63\n\nand the conclusions of Lemma 9.3 hold. And likewise for X1 .\nLet N = blog2 Rc \u2212 1. For every 0 \u2264 k \u2264 N , we define sets Xk by\nletting X0 = {X0 , X1 } and the set Xk+1 is the set of children of elements\nof Xk . Each set Xk has 2k+1 elements and the elements of Xk are not\nnecessarily distinct. ( For the pedantic reader we proceed as follows:\nXk is a set of ordered pairs of the form (a, X), when 0 \u2264 a < 2k and\nX \u2208 \u03c01 (S, \u2217). If X0 , X1 are constructed from X according to Lemma\n9.3 we let the children of (a, X) be (2a + i, Xi ) for i = 0, 1. Then we\nlet X0 = {(i, Xi ) : i = 0, 1} and let Xk+1 be the set of children of Xi .)\nMoreover, for any X \u2208 Xk we have\n\u0002\n\u0003\nl(*X*) \u2208 R2\u2212k + 2L, R2\u2212k + 2L + 1 .\nWe claim that\n\n\u03c0\n3\nfor every X in any Xk . For any such X we can find a sequence\nY0 , Y1 , ..., Yk , so that Y0 = X0 or Y0 = X1 and Yk = X, and where Yi+1 is\na child of Yi . It follows from the equation (19) that l(*Yi+1 *) \u2264 l(*Yi *)\u22121,\nand l(*Yk *) \u2265 2L \u2212 2.\nT\n<\n\u03b8X\n\n\u03b8YTk\n\nk\n\u03c0 X L+4\u2212l(*Yi *)\ne\n\u2264 +\n6\ni=0\n\u03c0\ne L+4\u2212(2L\u22123) \u03c0\n\u2264 +\ne\n< ,\n6 e\u22121\n3\n\nassuming L > 8.\nBy Lemma 4.3 we have I(*T * X * T\u0304 *) \u2264 log 4 for every X in every\nXk . Therefore, we can apply The XY Theorem (see Theorem 8.1) and\nconclude that\n(20)\n\nYT = (Y0 Y1 )T\n\nwhenever Y is a non-trivial node of our tree and Y0 and Y1 are its two\nchildren.\nIt follows by (18) and (20) applied recursively that\nX\n\u03b3=\nXT ,\nX\u2208XN\n\nin \u03a0300\u000f,R homology. We know that if X \u2208 XN then X \u2208 Wl , so\nXT = (q(X))T . Therefore\nX\nX\n\u03b3=\n(q(X))T =\n((q(\u03b3))T ,\nX\u2208XN\n\nso we are finished.\n\n\f64\n\nKAHN AND MARKOVIC\n\n\u0003\nRandomization: Randomization remarks for the proof of Theorem\n3.4. We have determined T \u2261 T (S, \u000f), so el(*T *) = K(S, \u000f). We have\nimplicitly defined the map g : \u0393\u000f,R \u2192 R\u03a0300\u000f,R such that \u2202g(\u03b3) =\nN\n\u03b3 \u2212 (q(\u03b3))T . We note that q = qD\n\u25e6 qC , where qC (\u03b3) = X + X 0 from\nLemma 9.2, qD (X) = X0 + X1 , from Lemma 9.3.\nMoreover,\ng(\u03b3) = gC (\u03b3) +\n\nN\n\u22121\nX\n\ni\nN\ngXY (b\nqD (qD\n(qC (\u03b3)))) + gW (qD\n(qC (\u03b3)))\n\ni=0\n\nwhere gC is the map from Lemma 9.2, qD and qbD are the maps from\nLemma 9.3, gXY is the map from Theorem 8.1, N is the number of\ntimes we iterate the division (the application of Lemma 9.3), and gW\nis from Theorem 9.1.\nBy far the most important point is that qD is K = K(S, \u000f)-semirandom,\ni\nis K i -semirandom, for any i \u2264 N (recall that N \u2264 blog2 Rc) and\nso qD\ni\ntherefore K i \u2264 Rlog2 K so the map qD\nis P (R)-semirandom, where P (R)\ndenotes a polynomial in R).\n9.4. The proof of Theorem 3.4. The map \u03c6 from Theorem 3.4 is\ndefined to be equal to the map g from the Randomization remarks for\nTheorem 9.2. We take hi = (gi )T . Then \u2202\u03c6(\u03b3) = \u03b3 \u2212 (q(\u03b3))T , and\n(q(\u03b3))T \u2208 R{h1 , .., h2n }, for any \u03b3 \u2208 R\u0393\u000f,R . Moreover, the map \u03c6 is\nP (R)-semirandom as shown in those Randomization remarks. This\nimplies the estimate (3) of the statement of Theorem 3.4 and we are\nfinished.\n10. Appendix 1\nIntroduction to randomization. Let (X, \u03bc) and (Y, \u03bd) denote two\nmeasure spaces (where \u03bc and \u03bd are positive measures).\nDefinition 10.1. We say that a map g : (X, \u03bc) \u2192 (Y, \u03bd) is Ksemirandom with respect to \u03bc and \u03bd if g\u2217 \u03bc \u2264 K\u03bd.\nBy RX we denote the vector space of finite formal sums (with real\ncoefficients) of points in X. There is a natural inclusion map \u03b9 : X \u2192\nRX, where \u03b9(x) \u2208 RX represents the corresponding sum. Then every\nmap fe : RX \u2192 S, where S is any set, induces the map f : X \u2192 S by\nletting f = fe \u25e6 \u03b9.\nP\nLet f : X \u2192 RY be a map. Then we can write f (x) = y fx (y)y,\nwhere the function fx : Y \u2192 R is non-zero for at most finitely many\n\n\fTHE EHRENPREIS CONJECTURE\n\n65\n\npoints of Y . We define |f | : X \u2192 RY by\nX\n|f |(x) =\n|fx (y)|y.\ny\n\nWe define the measure |f |\u2217 \u03bc on Y by\n!\nZ X\n|fx (y)|\u03c7V (y) d\u03bc(x),\n|f |\u2217 \u03bc(V ) =\nX\n\ny\n\nfor any measurable set V \u2282 Y , and \u03c7V (y) = 1, if y \u2208 V and \u03c7V (y) = 0,\nif y \u2208\n/ V.\nDefinition 10.2. Let (X, \u03bc) and (Y, \u03bd) be two measure spaces (with\npositive measures \u03bc and \u03bd). A map f : X \u2192 RY is K-semirandom\nif |f |\u2217 \u03bc \u2264 K\u03bd. A linear map fe : RX \u2192 RY is K-semirandom with\nrespect to measures \u03bc and \u03bd on X and Y respectively, if the induced\nmap f : X \u2192 RY is K-semirandom.\nThe following propositions are elementary.\nProposition 10.1. Let X, Y and Z denote three measure spaces. If\nf : RX \u2192 RY is K-semirandom, and f : RY \u2192 RZ is L-semirandom,\nthen g \u25e6 f : RX \u2192 RZ is KL-semirandom.\nProposition 10.2. If fi : RX \u2192 RY is Ki -semirandom, i = 1, 2, and\n\u03bbi \u2208 R, then the map (\u03bb1 f1 + \u03bb2 f2 ) : RX \u2192 RY is (|\u03bb1 |K1 + |\u03bb2 |K2 )semirandom.\nRemark. We say that f : X \u2192 Y is a partial map if it is defined\non some measurable subset X1 \u2282 X. The notion of a semirandom\nmaps generalizes to the case of partial maps by letting a partial map\nf : X \u2192 Y be K-semirandom if the restriction f : X1 \u2192 Y is Ksemirandom, where the corresponding measure on X1 is the restriction\nof the measure from X. Every statement we make about semirandom\nmaps has its version for a partial semirandom map. In particular,\nif f : X \u2192 Y is K-semirandom then the restriction of f onto any\nX1 \u2282 X is K-semirandom. Moreover, trivial partial maps (those that\nare defined on an empty set) are K-semirandom for any K \u2265 0.\nA measure class on a space X is a subset of M(X) where M(X) is\nthe set of measures on X.\nDefinition 10.3. Let X and Y be measure spaces and let M \u2282 M(X)\nand N \u2282 M(Y ) be measures classes on X and Y respectively (all\nmeasures from M and N are positive measures). We say f : X \u2192 Y\nis K semirandom with respect to M and N if for every \u03bc \u2208 M there\n\n\f66\n\nKAHN AND MARKOVIC\n\nis \u03bd \u2208 N such that f is K-semirandom with respect to \u03bc and \u03bd, that is\nf\u2217 \u03bc \u2264 K\u03bd.\nIn a similar fashion as above we define the notion of a semirandom\nmap f : RX \u2192 RY with respect to classes of measures M and N on X\nand Y respectively. The following proposition follows from Proposition\n10.1.\nProposition 10.3. Let X, Y and Z denote three measure spaces, with\nclasses of measures M, N and Z respectively. If f : RX \u2192 RY\nis K-semirandom with respect to M and N , and f : RY \u2192 RZ is\nL-semirandom with respect to N and Z, then g \u25e6 f : RX \u2192 RZ is\nKL-semirandom with respect to M and Z.\nWe say that a class of measures M is convex if it contains all convex\ncombinations of its elements. The following proposition then follows\nfrom Proposition 10.2\nProposition 10.4. If fi : RX \u2192 RY is Ki -semirandom with respect\nto classes of measures M and N , i = 1, 2, and if N is convex, then\nfor \u03bbi \u2208 R, the map (\u03bb1 f1 + \u03bb2 f2 ) : RX \u2192 RY is (|\u03bb1 |K1 + |\u03bb2 |K2 )semirandom with respect to M and N .\nRemark. The space RX is naturally contained in the space M(X),\nand in a similar way we can define the notion of a semirandom map\nf : M(X) \u2192 M(Y ).\nNatural measure classes. Let Xi , i = 1, .., k, denote measure spaces\nwith measure classes Mi . Let X1 \u00d7 ... \u00d7 Xk denote the product space\nand by \u03c0i : (X1 \u00d7 ... \u00d7 Xk ) \u2192 Xi we denote the coordinate projections.\nBy M1 \u00d7 M2 ... \u00d7 Mk we denote the set of measures on X1 \u00d7 ... \u00d7 Xk\nthat arise as the convex combinations of all standard products \u03bc1 \u00d7\n... \u00d7 \u03bck with \u03bci \u2208 Mi . We also define a natural class of measures\nM1 \u0002 M2 ... \u0002 Mk on X1 \u00d7 ... \u00d7 Xk as\nM1 \u0002M2 ...\u0002Mk = {\u03bc \u2208 M(X1 \u00d7...\u00d7Xk ) : (\u2200i)(\u2203\u03bci \u2208 Mi )((\u03c0i )\u2217 \u03bc \u2264 \u03bci )}.\nThis produces a large class of measures even if each Mi consists of\na single measure. If each Mi is convex then M1 \u0002 M2 ... \u0002 Mk is as\nwell. If Xi = X and Mi = M, then the standard product measure on\nX k is M\u00d7k and the other class of measures is denoted by M\u0002k .\nWe define the class L1 of Borel measures on R by saying that \u03bc \u2208 L1\nif \u03bc[x, x + 1) \u2264 1, for all x \u2208 R. This is a closed convex class of\nmeasures. Likewise we define the class of measures L1 on R/\u03bbZ, for\n\u03bb > 1, by saying that \u03bc \u2208 L1 if \u03bc[x, x + 1) \u2264 1, for all x \u2208 R/\u03bbZ. The\nclass of measures L1 is the class of measures that are controlled by the\nLebesgue measure at the unit scale.\n\n\fTHE EHRENPREIS CONJECTURE\n\n67\n\nWe consider the following spaces and their measure classes. In this\npaper, we define several maps (or partial maps) between these spaces\n(or their powers) and prove they are semirandom. We have\n(1) The space of curves \u03931,R with the measure class containing the\nsingle measure \u03c3\u0393 which is defined by setting \u03c3\u0393 (\u03b3) = Re\u22122R ,\nfor every \u03b3 \u2208 \u03931,R . We may assume that \u000f is small enough so\nthat \u0393\u000f,R \u2282 \u03931,R .\n(2) The space of pants \u03a01,R with the measure class containing the\nsingle measure \u03c3\u03a0 given by \u03c3\u03a0 (\u03a0) = e\u22123R . We may assume\nthat \u000f is small enough so that \u03a0300\u000f,R \u2282 \u03a01,R .\n.\n(3) Let \u03931,R = {(x, \u03b3) : \u03b3 \u2208 \u03931,R , x \u2208 T\u03b3 } denote the space of\npointed curves (recall that T\u03b3 = R/l(\u03b3)Z is the parameteriz.\ning torus for \u03b3). The space \u03931,R is really just the union of\nparameterizing tori T\u03b3 for curves \u03b3 \u2208 \u03931,R . By \u03a3\u0393. we denote\n.\n\nthe measure class on \u03931,R , such that \u03bc \u2208 \u03a3\u0393. if the restriction\n\u03bc\u03b3 = \u03bc|T\u03b3 is in e\u22122R L1 , where L1 is the measure class on the\ncircle T\u03b3 that was defined above.\n.k\n\n(4) Let \u03931,R = {(x1 , ..., xk , \u03b3) : \u03b3 \u2208 \u03931,R , xi \u2208 T\u03b3 } denote the space\n.k\n\nof curves with k marked points. The space \u03931,R is canonically\n.\n.k\n\u0001k\ncontained in \u03931,R . The measure class \u03a3k. on \u03931,R is the re\u0393\n.\n.k\n\u0001k\n\u0002k\nstriction of \u03a3 . on the image of \u03931,R in \u03931,R .\n\u0393\n(5) The space G = \u03c01 (S, \u2217) with the measure class \u03a3G that is the\nconvex closure of the collection of measures \u03c3a on G, where \u03c3a\nis defined so that for X \u2208 G we have \u03c3a (X) = \u03bda (l(*X*))e\u2212l(*X*) ,\nwhere \u03bda (x) = 1, if x \u2208 [a, a + 1], and \u03bda (x) = 0 otherwise.\nWe observe that there exists a constant K = K(S) such that for\nany measure \u03bc in any of the above defined measure classes, the total\nmeasure of \u03bc is bounded by K.\nFinally we consider the map \u2202 : \u03a01,R \u2192 R\u03931,R defined by \u2202\u03a0 =\n\u03b30 + \u03b31 + \u03b32 , where \u03b3i are the three oriented boundary curves of \u03a0. We\nobserve that \u2202 is K(S)-semirandom from \u03c3\u03a0 to \u03c3\u0393 .\nStandard maps are semirandom. We consider several standard\nmappings and prove they are semirandom.\nLemma 10.1. Let l > 0 and a, b \u2264 l \u2212 1. Then for any Z \u2208 G =\na+b\u2212l\n\u03c01 (S, \u2217) such that l(*Z*) = l, there are at most Ke 2 ways of writing\nZ = XY , with l(*X*) \u2208 [a, a + 1] and l(*Y *) \u2208 [b, b + 1], for some\nK = K(S).\n\n\f68\n\nKAHN AND MARKOVIC\n\nProof. Suppose that X and Y satisfy the given conditions. Consider\na triangle in H2 whose sides are lifts of *X*, *Y * and *Z* (these lifts\nare denoted the same as the arcs we are lifting). Then we drop the\nperpendicular t from the vertex z opposite to *Z* to the side *Z*, and\nlet a0 and b0 be the lengths of the subintervals of *Z* that meet at the\nendpoint of t on *Z* (then a0 + b0 = l(*Z*)). For simplicity, set t = l(t)\nWe find that\na \u2264 l(*X*) \u2264 t + a0 \u2264 l(*X*) + log 2 \u2264 a + 2,\nand likewise b \u2264 t + b0 \u2264 b + 2. So\n\u0014\n\u0015\na+b\u2212l a+b\u2212l\nt\u2208\n,\n+2 ,\n2\n2\nand\n\n\u0015\na\u2212b+l\na\u2212b+l\n\u2212 2,\n+2 .\na \u2208\n2\n2\nTherefore, the vertex z must lie in a disc of radius a+b\u2212l\n+ 4 around\n2\na\u2212b+l\nthe point on Z that is 2 away from the initial point of Z. It follows\na+b\u2212l\nthat there are at most K(S)e 2 lifts of the base point in this disc,\nand we are finished.\n\u0003\n0\n\n\u0014\n\nLet p : G \u00d7 G \u2192 G be the product map, that is g(X, Y ) = XY .\nLemma 10.2. The map p : G \u00d7 G \u2192 G is K-semirandom with respect\nto \u03a3G \u00d7 \u03a3G on G2 and \u03a3G on G, for some K = K(S)\nProof. Let a, b \u2208 [0, \u221e), and assume b \u2265 a. Recall the measures \u03c3a on\nG, and let \u03c3 = p\u2217 (\u03c3a \u00d7 \u03c3b ). We must show that \u03c3 \u2264 K\u03a3G .\nLet Z \u2208 G, and let l = l(*Z*). If a \u2264 b \u2264 l \u2212 1, then\n\u03c3(Z) \u2264 Ke\n\na+b\u2212l\n2\n\ne\u2212a e\u2212b = Ke\u2212l e\u2212\n\na+b\u2212l\n2\n\n.\n\n(If l > a + b + 2 then \u03c3(Z) = 0).\nIf l \u2212 1 \u2264 b, then because there are at most Kea X's in G for which\n\u03c3a (X) > 0, we find\n\u03c3(Z) \u2264 Kea e\u2212a e\u2212b = Ke\u2212l e\u2212(b\u2212l) .\nThen we see that\n1\n\u03c3\u2264\nK\n\nbb+1c\n\nX\nk=bb\u2212a\u22121c\n\nba+b+3c\n\u2212(b\u2212k)\n\ne\n\n\u03c3k +\n\nX\n\ne\u2212\n\n(a+b\u2212k)\n2\n\n\u03c3k ,\n\nk=bbc\n\nso \u03c3 \u2264 K\u03a3G .\n\u0003\n\n\fTHE EHRENPREIS CONJECTURE\n\n69\n\n.\n\nWe define a partial map proj : G \u2192 \u03931,R as follows. Given A \u2208 G,\nwe let \u03b3 = [A], and z \u2208 \u03b3 be the projection of the base point \u2217 to\n\u03b3. As always, the projection is defined by choosing lifts of *A* and \u03b3\nin H2 that have the same endpoints and then we project a lift of \u2217\nto the lift of \u03b3, where the lift of \u2217 belongs to the lift of *A*. We let\nproj(A) = (\u03b3, z).\n.\n\nLemma 10.3. The map proj : G \u2192 \u03931,R is K(S)-semirandom with\nrespect to \u03a3G and \u03a3\u0393. .\nProof. Let J be a unit interval on a curve \u03b3 \u2208 \u03931,R . We have seen in\nl\u22122R\nthe two previous proofs that there are at most Ke 2 many Z \u2208 G for\nwhich l(*Z*) \u2264 l, and proj(Z) \u2208 J. Therefore, if \u03c3 \u2208 \u03a3G , then\n\u221e\nX\nk\u22122R\nproj\u2217 \u03c3(\u03b3, J) \u2264 K\ne 2 e\u2212k \u2264 Ke\u22122R ,\nk=b2Rc\n\nand we are finished.\n.\n\n\u0003\n\nAnother standard map we consider is the projection map \u03931,L \u2192 \u03931,L\ngiven by (\u03b3, x) \u2192 \u03b3. This map is clearly 1-semirandom. Going in\nthe opposite direction, we have the map \u03b3 \u2192 (\u03b3, x) which assigns to\n\u03b3 \u2208 \u03931,R a random point x \u2208 \u03b3. This map is really defined as a map\n.\nM(\u03931,R ) \u2192 M(\u03931,R ), and we observe that it is 1-semirandom as well.\nRemark. We also observe that for T \u2208 G, the map {1} \u2192 G defined\nby 1 \u2192 T is el(*T *) semirandom with respect to the unit measure on {1}\nand \u03a3G .\nThe principles of randomization. After almost every lemma or\ntheorem we prove in Sections 4-9, we have added a \"Randomization\nremark\" which considers the functions that we have implicitly defined,\nstates their domain and range, and argues that the functions are semirandom with respect to a certain measure class. In the remarks we\nhave followed the following principles:\n1. When we write \"a random element\" (of a finite set S) which the\nreader was previously told to read as \"an arbitrary element\", we now\nmean \"the random element\" of RS, namely\n1 X\nx.\n|S| x\u2208S\nIf a \u2208 RS \u2282 M(S) and M is a measure class on S we say that a is a\nK-semirandom element of S, with respect to M, if there exists \u03bc \u2208 M\nsuch that a \u2264 K\u03bc.\n\n\f70\n\nKAHN AND MARKOVIC\n\n2. We can replace at will any map f : X \u2192 Y (or f : X \u2192 RY )\nby the linear extension f : RX \u2192 RY . This can cause confusion if\nyou think about it the wrong way so we offer the following example to\nclarify what is going on.\nIn the hard case of the GSL, we take a random third connection\n(meaning the random third connection), and then cancel out one square\n(Aij ), i, j = 0, 1, of boundaries to get a formal sum of squares (Bij )\nof curves. We then find, for each new square (in the formal sum) a\nsecond third connection at random from a set depending on (Bij ), to\ncomplete the argument. The right way to think of the randomization\n(and linearizion) is that the first operation defines a partial map\n....\n\nq1 : \u0393 1,R\n\n\u00014\n\n....\n\n\u2192 R \u0393 1,R\n\n\u00014\n\nand the second operation defines\ng0 : \u039341,R \u2192 R\u03a01,R ,\nso we can write g0 \u25e6 q1 by extending g0 to a map from R\u039341,R to R\u03a01,R\nlinearly. The danger is that one may try to imagine g0 acting on a\nformal sum of curves by taking the random element from RConn\u000f,R (*, *).\nSo we will imagine that we are defining functions from X to Y , or\nfrom X to RY , and only think of them as functions from RX to RY\nwhen we want to compose them.\n2\n3. We want to use the measure class \u03a3G \u00d7 \u03a3G = \u03a3\u00d72\nG on G =\n{(X, Y )} when we want to form the product XY . We want to use the\n2\nmeasure class \u03a3G \u0002 \u03a3G = \u03a3\u00022\nG on G if we want to be able to let X = Z\nand Y = Z for some Z \u2208 G.\n\u00022\nFor example, for the ASL, we use the measure class \u03a3\u00022\nG \u00d7\u03a3G \u00d7\u03a3G \u00d7\n6\n2\n2\n\u03a3G on six-tuples (A0 , A1 , U, B0 , B1 , V ) in G = G \u00d7 G \u00d7 G \u00d7 G. This\nis basically the largest measure class for which the maps \u03c0ij : G6 \u2192 G4\ndefined by \u03c0ij (A0 , A1 , U, B0 , B1 , V ) = (Ai , U, Bj , V ) are 1-semirandom\n4\nwith respect to the measure class \u03a3\u00d74\nG on G .\nThis is exactly what we want, because we have to form the words\nAi U Bj V , but we need the freedom to assign to A0 and A1 (or B0 and\nB1 ) the same value.\n\n11. Appendix 2\nWe develop the theory of equidistribution and counting, based on\nthe uniformly exponential mixing of the geodesic flow, that we need to\nprove Theorem 3.2.\n\n\fTHE EHRENPREIS CONJECTURE\n\n71\n\nEquidistribution of equidistant lines. The group PSL(2, R) acts\non the unit tangent bundle T 1 H2 on the left (we refer to this action as\nthe action by isometries). Namely, if v \u2208 T 1 H2 and h \u2208 PSL(2, R) then\nh*v = h(v) is the resulting vector in T 1 H2 . Moreover, if u and v are two\nvectors in T 1 H2 then there exists a unique element h \u2208 PSL(2, R) such\nthat h*v = u. This enables us to identify the unit tangent bundle T 1 H2\nwith PSL(2, R) as follows. Choose a vector v0 \u2208 T 1 H2 . We identify\nv0 with the identity element 1 in PSL(2, R). A vector v \u2208 T 1 H2 is\nidentified with the unique element h \u2208 PSL(2, R) so that h * v0 = v.\nThe group PSL(2, R) also acts on T 1 H2 on the right (we sometimes refer to this action as the action by instructions). This action is\nuniquely defined by the following two properties:\n(1) h * v0 = v0 * h,\n(2) g * (v * h) = (g * v) * h,\nfor any h, g \u2208 PSL(2, R).\nNow we describe the following factorization of elements of PSL(2, R).\nLet t \u2208 R and let gt \u2208 PSL(2, R) denote a one-parameter Abelian\ngroup of hyperbolic transformations. By Axis(gt ) we denote the oriented axis of the hyperbolic transformations gt (it is oriented from the\nrepelling fixed point to the attracting fixed point of a transformation\ngt for t > 0). Let Ya , where a \u2208 R, denote another such family so\nthat the oriented angle between Axis(Ya ) and Axis(gt ) is \u03c02 . Denote by\np0 \u2208 H2 the point p0 = Axis(Ya ) \u2229 Axis(gt ) and let v0 \u2208 T 1 H2 denote\nthe vector at p0 that is tangent to Axis(gt ). Also, let Rc \u2208 PSL(2, R),\nc \u2208 R, denote the rotation for angle c about the point p0 .\nLemma 11.1. Any h \u2208 PSL(2, R) can be uniquely written as h =\nYa * gt * Rc , for some choice of a, t, c \u2208 R.\nProof. We identify PSL(2, R) with the unit tangent bundle T 1 H2 in\nthe usual way so that the identity in PSL(2, R) is identified with the\nvector v0 \u2208 T 1 H2 . Let v \u2208 T 1 H2 be the vector corresponding to some\nh \u2208 PSL(2, R) and suppose that v is based at the point p \u2208 H2 . For\nsimplicity set \u03b1(g) = Axis(gt ) and \u03b1(Y ) = Axis(Ya ). Let \u03b2 be the\noriented geodesic in H2 that contains p and is orthogonal to \u03b1(Y ) and\nthat points to the left of \u03b1(Y ).\n(1) Let u be the tangent vector to \u03b2 at the point p. By c we denote\nthe oriented angle between the vectors v and u.\n(2) Let t denote the signed distance from p to \u03b1(Y ) along the oriented geodesic \u03b2.\n(3) Let q = \u03b2 \u2229 \u03b1(Y ) and let a denote the signed distance from p0\nto q along the oriented geodesic \u03b1(Y ).\n\n\f72\n\nKAHN AND MARKOVIC\n\nThen clearly h = Ya * gt * Rc and such a, t and c are unique.\n\u0003\nWe equip PSL(2, R) with the following distance function. Let hj \u2208\nPSL(2, R), j = 1, 2, and let vj \u2208 T 1 H2 denote the vectors corresponding to hj (the vector vj is based at the point pj \u2208 H2 ). We let\ndPSL(2,R) (h1 , h2 ) = d(p1 , p2 ) + \u0398(u1 , v2 ),\nwhere u1 \u2208 T 1 H2 is the parallel transport of the vector v1 at the point\np2 (recall that \u0398(u, v) is the unoriented angel between vectors u and\nv). For h \u2208 PSL(2, R) we denote by ||h|| the distance between h and\nthe identity element 1 \u2208 PSL(2, R).\nWe leave the proof of the following lemma to the reader.\nLemma 11.2. There are universal constants \u03b40 , K0 > 0 such that providing ||h|| \u2264 \u03b40 then\nh * gt = Ya * gt+b * Rc ,\nwhere |a| + |b| + |c| \u2264 K0 ||h||.\nWe now discuss the equidistribution of the equidistant lines on a\nclosed Riemann surface S. Let \u03b1 : R \u2192 S be a unit speed geodesic,\nand let \u03b1\nb : R \u2192 T 1 S be the leftward normal unit vector field, given by\n\u03b1\nb(s) = i\u03b10 (s) (here i denotes the imaginary unit in the tangent space\nto S at the point \u03b1(s) \u2208 S). Let t \u2208 R and consider the vector field\ngt (b\n\u03b1). Then the vectors from the field gt (b\n\u03b1) are orthogonal to the line\nthat is equidistant (at distance t) from the geodesic \u03b1. In what follows\nwe assume that the Liouville measure \u039b on T 1 S is normalized so that\n\u039b(T 1 S) = 1.\nTheorem 11.1. Let f : T 1 S \u2192 R be any C 1 function. Then for\na \u2265 C1 e\u2212qt , we have\nZa\nZ\n\u0001\n\u2212qt 1\n1\nf (gt (b\n\u03b1(s)) ds \u2212\nf d\u039b \u2264 C2 e 5\n+ ||f ||C 1 ,\na\na\n0\n\nT 1S\n\nwhere the positive constants C1 , C2 and q depend only on S.\nProof. We let \u03c8\u03b7 : PSL(2, R) \u2192 [0, \u221e) be such that\n(1) \u03c8\u03b7 is supported in B\u03b7 (1) which is the ball of radius \u03b7 centered\nRat 1.\n(2) \u03c8\u03b7 = 1, where we integrate with respect to the Haar measure\non PSL(2, R).\n(3) ||\u03c8\u03b7 ||C 1 \u2264 K1 \u03b7 \u22124 , for some universal constant K1 .\n\n\fTHE EHRENPREIS CONJECTURE\n\n73\n\n(4) \u03c8\u03b7 (X) = \u03c8\u03b7 (X \u22121 ) for X \u2208 PSL(2, R).\nWe can arrange that (3) holds because \u03c8\u03b7 needs to reach the height\nof \u03b7 \u22123 in a space of size \u03b7 (so the derivative of \u03c8\u03b7 is proportional to\n\u03b7 \u22124 ). For simplicity we let \u03c8 = \u03c8\u03b7 .\nIf u, v \u2208 T 1 H2 then there is a unique g \u2208 PSL(2, R) such that\nu * g = v. We let \u03c8(u, v) = \u03c8(g) (condition (4) above implies that\n\u03c8(u, v) = \u03c8(v, u)). Then for a < b and X \u2208 T 1 S we let\nZb\n\u03b1\nba,b (X) =\n\n\u03c8(b\n\u03b1(s), X) ds,\na\n\nand we let \u03b1\nba = \u03b1\nb0,a .\nThen\n||b\n\u03b1a,b ||C 1 \u2264 (b \u2212 a)||\u03c8||C 1\nand\nZ\n\u03b1\nba,b d\u039b = b \u2212 a.\nT 1S\n\nApplying the factorization lemma above (Lemma 11.2) we find that\nZa Z\n\nZ\n\nf (b\n\u03b1(s) * h * gt )\u03c8(h) dsd\u039b(h)\n\nf (X)b\n\u03b1a (g\u2212t X) d\u039b(X) =\n0 B\u03b7 (1)\n\nT 1S\n\nZa Z\nf (b\n\u03b1(s) * Ya * gt+b * Rc )\u03c8(h) dsd\u039b(h)\n\n=\n0 B\u03b7 (1)\n\nZa Z\nf (b\n\u03b1(s + a(t, h)) * gt+b(t,h) * Rc(t,h) )\u03c8(h) dsd\u039b(h)\n\n=\n0 B\u03b7 (1)\n\nZa Z\n=\n\n\u0001\nf (b\n\u03b1(s + a(t, h))\u03c8(h) dsd\u039b(h) + O ||f ||C 1 \u03b7a ,\n\n0 B\u03b7 (1)\n\nwhere the last equality follows from the upper bounds on b(t, h) and\nc(t, h) from Lemma 11.2. This yields the inequalities\n\n\f74\n\nKAHN AND MARKOVIC\n\na\u2212K\nZ 0\u03b7\n\nZ\n\nf (gt (b\n\u03b1(s)) ds \u2212 K0 ||f ||C 1 \u03b7 \u2264\n\nf (X)b\n\u03b1a (g\u2212t X) d\u039b(X)\nT 1S\n\nK0 \u03b7\n\na+K\nZ 0\u03b7\n\n\u2264\n\nf (gt (b\n\u03b1(s)) ds + K0 ||f ||C 1 \u03b7.\n\u2212K0 \u03b7\n\nOn the other hand, by exponential mixing\nZ\n\nZ\n((gt )\u2217 \u03b1\nba )(X)f (X) d\u039b(X) \u2212\n\nT 1S\n\nZ\n\u03b1\nba d\u039b\n\nT 1S\n\u2212qt\n\n\u2264 Ce\n\n\u2212qt\n\n||b\n\u03b1a ||C 1 ||f ||C 1 \u2264 Ce\n\nf d\u039b\n\nT 1S\n\u22124\n\na\u03b7 ||f ||C 1 ,\n\nwhere C, q > 0 depend only on S. So we obtain, for a > 2K0 \u03b7,\nZa\n\nZ\nf (gt (b\n\u03b1(s))) ds \u2264\n\n0\n\nf ((gt )\u2217 \u03b1\nb\u2212K0 \u03b7,a+K0 \u03b7 ) d\u039b + K0 ||f ||C 1 \u03b7\nT 1S\n\nZ\n\u2264 (a + 2K0 \u03b7)\n\nf d\u039b + Ce\u2212qt a\u03b7 \u22124 ||f ||C 1 + K0 \u03b7||f ||C 1\n\nT 1S\n\nand likewise\nZ\nZa\nf (gt (b\n\u03b1(s))) ds \u2265 (a \u2212 2K0 \u03b7)\nf d\u039b \u2212 (Ce\u2212qt a\u03b7 \u22124 + K0 \u03b7)||f ||C 1 .\n0\n\nT 1S\n1\n\nLetting \u03b7 = e\u2212 5 qt , the theorem follows.\n\u0003\n11.1. Counting good connections. Let \u03b2 be another geodesic on S\nand define \u03b2b : R \u2192 T 1 S in analogy to \u03b1\nb. For intervals I and J in R\nwe let\nb\nMI,J = {gt (\u03b2(s))\n: (s, t) \u2208 I \u00d7 J},\nbe a 2-submanifold of T 1 S.\nWe recall the normal flow Y on T 1 S. Then \u03b1\nb0 (s) = Y (b\n\u03b1(s)) for any\n1\ngeodesic \u03b1 : R \u2192 T S, and we let\n1\nYt \u2261\n(gt )\u2217 Y\ncosh t\n\n\fTHE EHRENPREIS CONJECTURE\n\n75\n\nbe the distance t flow, so\n\u0001\n\u2202\ngt (b\n\u03b1(s)) = (cosh t)Y t (gt (b\n\u03b1(s))).\n\u2202s\nFor t large Y t is close to the negative horocyclic flow.\nTheorem 11.2. Let f be a C 1 function with compact support on MI,J .\nThen\n\n1\na cosh t\n\nX\n\nZ\nf (gt (b\n\u03b1(s))) \u2212\n\ngt (b\n\u03b1(s))\u2208MI,J\n\nf \u03b9Y t dV\n\nMI,J\n\n\u0001\n\u2212qt 1\n+ ||f ||C 1 ,\n\u2264 Ce 5\na\nprovided that |I|, |J| < \u03b4 and 1 \u2265 a \u2265 C1 e\u2212qt , where C, C1 , \u03b4 > 0\ndepend only on S and ||f ||\u221e \u2264 1. (Here \u03b9Y t dV is the contraction of the\nvolume form dV by the vector Y t .)\nProof. The assumptions on MI,J , t and a imply that the map Q : MI,J \u00d7\n\u0001\nb\n(0, \u000f) \u2192 T 1 S, defined by Q(q, r, s) = Yst gr (\u03b2(q))\n, is injective for\n1\nsome \u000f = \u000f(S). We let \u03c8 be a C bump function on (0, \u000f), and let\n\u0001\nfe : Q MI,J \u00d7 (0, \u000f) \u2192 R be defined by\n\u0001\ne\nfe Q(q, r, s) = f (gr (\u03b2(q)))\u03c8(s).\nThen\n||fe||C 1 \u2264 C(S)||f ||C 1 ,\nand\n\nZ\n\nZ\nfed\u039b =\nT 1S\n\nf \u03b9Y t d\u039b.\nM\n\nMoreover,\nX\ngt (b\n\u03b1(s))\u2208MI,J\n\nZa\nf (gt (b\n\u03b1(s))) \u2212 cosh t\n\nfe(gt (b\n\u03b1(s))) ds \u2264 ||f ||\u221e .\n0\n\n\u0001\nThis inequality holds because every time the curve Ys gt (b\n\u03b1(0)) (for s \u2208\n[0, cosh t]) crosses MI,J , it goes through Q (and contributes the same\namount to the sum and the integral), except that the curve may start\nin Q and miss MI,J , and the terminal point may end in Q, contributing\nmore to the sum than to the integral. For both endpoints the error is\nat most |f ||\u221e , and the error has different signs at the two endpoints,\nso the total error is at most ||f ||\u221e .\n\n\f76\n\nKAHN AND MARKOVIC\n\nTherefore, by Theorem 11.1,\n\n1\na cosh t\n\nX\n\nZ\nf (gt (b\n\u03b1(s))) \u2212\n\ngt (b\n\u03b1(s))\u2208MI,J\n\nf \u03b9Y t dV\n\nMI,J\n\n\u0001\n\u2212qt 1\n1\n||f ||\u221e + Ce 5\n+ ||f ||C 1\na cosh t\na\n\u0001\n\u2212qt 1\n\u2264 Ce 5\n+ ||f ||C 1 .\na\n\u2264\n\n\u0003\nIf \u03b1 and \u03b2 are two geodesic segments, and \u000f, L > 0, we let Conn\u000f,L (\u03b1, \u03b2)\nb and t \u2208 [L, L + \u000f].\nbe the set of (r, s, t) such that gt (b\n\u03b1(r)) = \u03b2(s)\nqL\n\nTheorem 11.3. Letting \u03b4 = e\u2212 40 , and \u03b1, \u03b2 geodesic segments of length\n\u03b4 2 , the number of orthogeodesics connections from one side of \u03b1 to one\nside of \u03b2, of length in the interval [L, L + \u03b4 2 ], is given by\n\u0001\n1\n6 L\n\u03b4\ne\n1\n+\nO(\u03b4)\n,\n8\u03c0 2 \u03c7(S)\nwhere the big O constant depends only on S.\nProof. We let M = MI,J , where I = [0, \u03b4 2 ] and J = [\u2212\u03b4 2 , 0]. We want\nto count the number of s \u2208 [0, \u03b4 2 ] for which gL (b\n\u03b1(s)) \u2208 M .\nLet\nM + = M[\u2212\u03b43 ,\u03b42 +\u03b43 ],[\u2212\u03b42 \u2212\u03b43 ,\u03b43 ]\nbe a slightly larger surface and we let f + be a C 1 function on M + that\nis equal to 1 on M . We can arrange\n||f + ||C 1 \u2264 10\u03b4 \u22123 ,\nand f + takes values in in [0, 1].\nThen\nZ\n\nf + \u2212 \u03c7M \u03b9Y L dV \u2264 10\u03b4 5 ,\n\nM+\n\nand given our normalization of the Liouville volume form dV we have\nZ\n1\n\u03b9Y L dV = 2\n\u03b4 4 + O(\u03b4 8 ).\n4\u03c0 |\u03c7(S)|\nM\n\n\fTHE EHRENPREIS CONJECTURE\n\n77\n\nPutting all this together and applying Theorem 11.2 we have\nX\n\u0001\n1\n1\n#Conn\n(\u03b1,\n\u03b2)\n\u2264\n\u03b1(s))\nf + gL (b\n\u000f,L\n2\n2\n\u03b4 cosh L\n\u03b4 cosh L\ngL (b\n\u03b1(s))\u2208M + ,s\u2208[0,a]\nZ\n\u0001\n1\n\u2264\nf + \u03b9Y L dV + C\u03b4 8 + ||f ||C 1\na\nM+\n\n\u03b44\n+ O(\u03b4 8 ) + 10\u03b4 5 + C\u03b4 8 (\u03b4 \u22122 + \u03b4 \u22123 )\n4\u03c0 2 |\u03c7(S)|\n\u03b44\n+ C\u03b4 5 .\n\u2264 2\n4\u03c0 |\u03c7(S)|\n\n\u2264\n\nWe can analogously define f \u2212 supported on M , with f \u2212 \u2261 1 on\nM[\u03b43 ,\u03b42 \u2212\u03b43 ],[\u2212\u03b42 +\u03b43 ,\u2212\u03b43 ] and prove that\n1\n\u03b44\n#Conn\n(\u03b1,\n\u03b2)\n\u2265\n\u2212 C\u03b4 5 .\n\u000f,L\n\u03b4 2 cosh L\n4\u03c0 2 |\u03c7(S)|\nSince cosh L =\n\neL\n2\n\n\u0001\n1 + O(e\u22122L ) , the theorem follows.\n\u0003\n\nReferences\n[1] L. Bowen, Weak Forms of the Ehrenpreis conjecture and the surface subgroup\nconjecture. arXiv:math/0411662\n[2] D. Calegari, Faces of the scl norm ball. Geom. Topol. 13 (2009), no. 3, 13131336\n[3] D. Epstein, A. Marden, V. Markovic, Quasiconformal homeomorphisms and\nthe convex hull boundary. Ann. of Math. (2) 159 (2004), no. 1, 305\u2013336.\n[4] A. Eskin, C. McMullen, Mixing, counting, and equidistribution in Lie groups.\nDuke Math. Journal 71 (1993), no. 1, 181-209\n[5] J. Kahn, V. Markovic, The Weil-Petersson distance between finite degree\ncovers of punctured Riemann surfaces and random ideal triangulations.\narXiv:0806.2304\n[6] J. Kahn, V. Markovic, Immersing almost geodesic surfaces in a closed hyperbolic three manifold. arXiv:0910.5501\n[7] G. Margulis, Certain applications of ergodic theory to the investigation of\nmanifolds of negative curvature. Funkcional. Anal. i Prilozen. 3 (1969) no. 4.\n89-90\n[8] J. Parkkonen, F. Paulin, Counting arcs in negative curvature. arXiv:1203.0175\n\n\f78\n\nKAHN AND MARKOVIC\n\nMathematics Department, Brown University, Providence, 02912, RI,\nUSA\nE-mail address: kahn@math.brown.edu\nMathematics Department, California Institute of Technology, Pasadena,\n91105, CA, USA\nE-mail address: markovic@caltech.edu\n\n\f"}