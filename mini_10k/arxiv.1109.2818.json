{"id": "http://arxiv.org/abs/1109.2818v3", "guidislink": true, "updated": "2014-05-28T21:11:35Z", "updated_parsed": [2014, 5, 28, 21, 11, 35, 2, 148, 0], "published": "2011-09-13T15:03:14Z", "published_parsed": [2011, 9, 13, 15, 3, 14, 1, 256, 0], "title": "Bifurcation analysis of delay-induced resonances of the El-Nino Southern\n  Oscillation", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.4793%2C1109.3729%2C1109.2514%2C1109.6466%2C1109.4313%2C1109.1564%2C1109.4904%2C1109.0670%2C1109.1218%2C1109.5333%2C1109.2129%2C1109.6913%2C1109.5351%2C1109.0199%2C1109.5063%2C1109.4556%2C1109.4602%2C1109.6450%2C1109.4824%2C1109.2818%2C1109.1105%2C1109.0210%2C1109.0633%2C1109.6611%2C1109.4689%2C1109.0259%2C1109.2426%2C1109.2789%2C1109.6315%2C1109.0651%2C1109.6827%2C1109.3382%2C1109.5305%2C1109.3734%2C1109.3034%2C1109.2458%2C1109.0799%2C1109.5141%2C1109.5127%2C1109.2611%2C1109.2811%2C1109.1472%2C1109.0236%2C1109.6398%2C1109.5908%2C1109.6734%2C1109.3083%2C1109.6052%2C1109.5206%2C1109.3864%2C1109.4201%2C1109.1197%2C1109.0265%2C1109.4421%2C1109.5791%2C1109.4840%2C1109.1319%2C1109.2744%2C1109.2642%2C1109.2788%2C1109.5753%2C1109.1482%2C1109.2724%2C1109.3312%2C1109.0686%2C1109.1161%2C1109.3063%2C1109.3995%2C1109.2204%2C1109.4586%2C1109.5354%2C1109.0400%2C1109.2069%2C1109.3099%2C1109.6627%2C1109.0898%2C1109.1906%2C1109.2633%2C1109.0044%2C1109.0019%2C1109.3885%2C1109.4530%2C1109.0713%2C1109.4893%2C1109.1538%2C1109.1639%2C1109.5347%2C1109.5456%2C1109.6480%2C1109.3031%2C1109.0229%2C1109.1424%2C1109.5772%2C1109.1457%2C1109.6077%2C1109.3158%2C1109.1632%2C1109.1146%2C1109.0518%2C1109.2684%2C1109.1558&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Bifurcation analysis of delay-induced resonances of the El-Nino Southern\n  Oscillation"}, "summary": "Models of global climate phenomena of low to intermediate complexity are very\nuseful for providing an understanding at a conceptual level. An important\naspect of such models is the presence of a number of feedback loops that\nfeature considerable delay times, usually due to the time it takes to transport\nenergy (for example, in the form of hot/cold air or water) around the globe. In\nthis paper we demonstrate how one can perform a bifurcation analysis of the\nbehaviour of a periodically-forced system with delay in dependence on key\nparameters. As an example we consider the El-Nino Southern Oscillation (ENSO),\nwhich is a sea surface temperature oscillation on a multi-year scale in the\nbasin of the Pacific Ocean. One can think of ENSO as being generated by an\ninterplay between two feedback effects, one positive and one negative, which\nact only after some delay that is determined by the speed of transport of\nsea-surface temperature anomalies across the Pacific. We perform here a case\nstudy of a simple delayed-feedback oscillator model for ENSO (introduced by\nTziperman et al, J. Climate 11 (1998)), which is parametrically forced by\nannual variation. More specifically, we use numerical bifurcation analysis\ntools to explore directly regions of delay-induced resonances and other\nstability boundaries in this delay-differential equation model for ENSO.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.4793%2C1109.3729%2C1109.2514%2C1109.6466%2C1109.4313%2C1109.1564%2C1109.4904%2C1109.0670%2C1109.1218%2C1109.5333%2C1109.2129%2C1109.6913%2C1109.5351%2C1109.0199%2C1109.5063%2C1109.4556%2C1109.4602%2C1109.6450%2C1109.4824%2C1109.2818%2C1109.1105%2C1109.0210%2C1109.0633%2C1109.6611%2C1109.4689%2C1109.0259%2C1109.2426%2C1109.2789%2C1109.6315%2C1109.0651%2C1109.6827%2C1109.3382%2C1109.5305%2C1109.3734%2C1109.3034%2C1109.2458%2C1109.0799%2C1109.5141%2C1109.5127%2C1109.2611%2C1109.2811%2C1109.1472%2C1109.0236%2C1109.6398%2C1109.5908%2C1109.6734%2C1109.3083%2C1109.6052%2C1109.5206%2C1109.3864%2C1109.4201%2C1109.1197%2C1109.0265%2C1109.4421%2C1109.5791%2C1109.4840%2C1109.1319%2C1109.2744%2C1109.2642%2C1109.2788%2C1109.5753%2C1109.1482%2C1109.2724%2C1109.3312%2C1109.0686%2C1109.1161%2C1109.3063%2C1109.3995%2C1109.2204%2C1109.4586%2C1109.5354%2C1109.0400%2C1109.2069%2C1109.3099%2C1109.6627%2C1109.0898%2C1109.1906%2C1109.2633%2C1109.0044%2C1109.0019%2C1109.3885%2C1109.4530%2C1109.0713%2C1109.4893%2C1109.1538%2C1109.1639%2C1109.5347%2C1109.5456%2C1109.6480%2C1109.3031%2C1109.0229%2C1109.1424%2C1109.5772%2C1109.1457%2C1109.6077%2C1109.3158%2C1109.1632%2C1109.1146%2C1109.0518%2C1109.2684%2C1109.1558&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Models of global climate phenomena of low to intermediate complexity are very\nuseful for providing an understanding at a conceptual level. An important\naspect of such models is the presence of a number of feedback loops that\nfeature considerable delay times, usually due to the time it takes to transport\nenergy (for example, in the form of hot/cold air or water) around the globe. In\nthis paper we demonstrate how one can perform a bifurcation analysis of the\nbehaviour of a periodically-forced system with delay in dependence on key\nparameters. As an example we consider the El-Nino Southern Oscillation (ENSO),\nwhich is a sea surface temperature oscillation on a multi-year scale in the\nbasin of the Pacific Ocean. One can think of ENSO as being generated by an\ninterplay between two feedback effects, one positive and one negative, which\nact only after some delay that is determined by the speed of transport of\nsea-surface temperature anomalies across the Pacific. We perform here a case\nstudy of a simple delayed-feedback oscillator model for ENSO (introduced by\nTziperman et al, J. Climate 11 (1998)), which is parametrically forced by\nannual variation. More specifically, we use numerical bifurcation analysis\ntools to explore directly regions of delay-induced resonances and other\nstability boundaries in this delay-differential equation model for ENSO."}, "authors": ["Bernd Krauskopf", "Jan Sieber"], "author_detail": {"name": "Jan Sieber"}, "author": "Jan Sieber", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1098/rspa.2014.0348", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1109.2818v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1109.2818v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "as accepted for Proc Roy Soc A, 20 pages, 7 figures", "arxiv_primary_category": {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "nlin.CD", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1109.2818v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1109.2818v3", "journal_reference": "Proceedings of the Royal Society A 470, 2169, 20140348, 18 pages,\n  2014", "doi": "10.1098/rspa.2014.0348", "fulltext": "Bifurcation analysis of delay-induced resonances\nof the El-Ni\u00f1o Southern Oscillation\nB Y B ERND K RAUSKOPF1 AND JAN S IEBER2 ,\n1 Department\n\narXiv:1109.2818v3 [math.DS] 28 May 2014\n\n2 College\n\nof Mathematics, The University of Auckland, New Zealand\nof Engineering, Mathematics and Physical Sciences, University of Exeter, UK\n\nModels of global climate phenomena of low to intermediate complexity are very useful\nfor providing an understanding at a conceptual level. An important aspect of such models is\nthe presence of a number of feedback loops that feature considerable delay times, usually\ndue to the time it takes to transport energy (for example, in the form of hot/cold air or water)\naround the globe.\nIn this paper we demonstrate how one can perform a bifurcation analysis of the behaviour\nof a periodically-forced system with delay in dependence on key parameters. As an example\nwe consider the El-Ni\u00f1o Southern Oscillation (ENSO), which is a sea surface temperature\noscillation on a multi-year scale in the basin of the Pacific Ocean. One can think of ENSO\nas being generated by an interplay between two feedback effects, one positive and one\nnegative, which act only after some delay that is determined by the speed of transport of seasurface temperature anomalies across the Pacific. We perform here a case study of a simple\ndelayed-feedback oscillator model for ENSO (introduced by Tziperman et al, J. Climate\n11 (1998)), which is parametrically forced by annual variation. More specifically, we use\nnumerical bifurcation analysis tools to explore directly regions of delay-induced resonances\nand other stability boundaries in this delay-differential equation model for ENSO.\nKeywords: delay differential equations, bifurcation analysis, El-Ni\u00f1o Southern oscillation\n\n1. Introduction\nIn climate science one finds a hierarchy of increasingly complex mathematical models,\nall the way from low-dimensional conceptual models in the form of ordinary differential\nequations (ODE) to global climate models with many millions of unknowns. Our interest\nhere is in models of a low to intermediate complexity, in particular, those that feature\ndelayed feedback mechanisms. The mathematical description of such a system, hence, takes\nthe form of delay differential equations (DDEs). Despite looking similar to ODEs at first\nsight, DDEs have an infinite-dimensional phase space (that is, space of possible initial\nconditions), which enables them to describe complex phenomena even with a low number\nof dependent variables [1]. This type of model arises in other fields of science, for example,\nin mechanical engineering, in laser physics and in mathematical biology, where one finds\ncommunication delays (between optical elements or cells) as well as processing delays; see,\nfor example, [2, 3]. In climate science, on the other hand, delays arise mainly in feedback\nloops due to the transport of mass or energy from one location on the planet to another.\nThere are models that describe such transport phenomena directly in the form of partial\ndifferential equations [4]. However, in some situations it is advantageous to take a more\nconceptual point of view by considering only the resulting feedback effect itself, which is\nthen subject to a delay due to the associated transport time.\nArticle submitted to Phil. Trans. of the Royal Society\n\nTEX Paper\n\n\f2\n\nB. Krauskopf and J. Sieber\n\nIn this contribution we perform a case study of such a DDE model to demonstrate how\ntools from bifurcation theory can be brought to bear to understand its behaviour. More\nspecifically, we study delay-induced resonances in the classical ENSO problem. This is an\nideal showcase problem for bifurcation analysis because the ocean-atmosphere system of\nthe Pacific has an oscillatory instability at the linear level due to reasonably well identified\nfeedback effects. The resulting oscillator interacts with the annual forcing to produce a\nrich set of resonances [5, 6, 7] in a wide region of parameters. Extensive research has\ncreated a hierarchy of models that isolate the processes affecting ENSO; see also [8]. We\nexplore here one of the simplest of these models that still contains physically meaningful\nparameters, namely, the model introduced by Tziperman et al [9]. This model takes the\nform of a scalar DDE that lumps all coupled processes into two feedback terms, which act\nonly after given delays due to the time it takes for thermocline anomalies (proportional to\nsea-surface temperature anomalies) to travel across the Pacific. We provide a brief summary\nof the motivation behind this delayed-feedback oscillator model of ENSO in Section 2; for\nan account of the modelling of the processes involved at coarse to intermediate levels of\ncomplexity see the review [8] and the textbook [4].\nOnce a DDE model, such as that for ENSO, has been derived, the task is to understand\nits behaviour in dependence on relevant parameters. A quite straightforward method for\ninvestigating the eventual or attracting behaviour of a given mathematical model is its\nsimulation by numerical integration. However, when one wants to find all possible behaviour\nby simulation, one is faced with a number of challenges. One generally needs to perform\nmany simulation runs for different parameter values, for example, chosen from some\nsufficiently fine grid; each such run needs to be performed until transients die out sufficiently\nand care needs to be taken in the choice of the initial condition, especially in the presence of\nmultistability. Note that for DDEs one needs an entire history segment as initial condition\n[10], making the search space infinite dimensional. Furthermore, there is the difficulty of\nrepresenting and identifying, ideally automatically, what the eventual dynamics actually is.\nAn alternative to simulation is bifurcation analysis. It was orginally developed as a\nmathematical tool to classify the long-term behaviour of nonlinear dynamical systems that\nare modelled by low-dimensional ordinary differential equations (ODEs) or maps. The\nunderlying idea is that one studies equilibria and periodic orbits and their stability and\nother properties as a function of relevant system parameters. When a parameter is varied,\none may observe well-defined qualitative changes of the dynamics, which are referred to\nas bifurcations. The goal of bifurcation analysis is to find the bifurcation diagram, which\ndivides the parameter space into regions of qualitatively different behaviour. A bifurcation\ndiagram is effectively a 'road map' of where in parameter space one may find which kind\nof behaviour, and what changes occur in the transition from one type of behaviour to\nanother. In spite of their seeming simplicity, ODE models of quite low dimension (such as\nthe well-known Lorenz and R\u00f6ssler systems) can already give rise to intricate bifurcation\ndiagrams with regions of stationary, periodic, quasiperiodic and even chaotic behaviour;\nsee, for example, the textbooks [11, 12, 13] as entry points to bifurcation theory.\nToday, the bifurcation analysis of a given ODE can be performed routinely with freely\navailable numerical tools, such as the packages AUTO [14] and MatCont [15]; see also the\nsurvey [16]. These tools only require knowledge of the right-hand side of the ODE and allow\nthe user to perform a systematic exploration of the bifurcation diagram. This is achieved by\nfinding and then tracking (or continuing) equilibria, periodic orbits, and their bifurcations to\nyield stability boundaries of the different types of solutions. The usefulness of bifurcation\n\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n3\n\ntheory has been demonstrated in numerous studies of ODE models arising in diverse fields\nof science; see, for example, [17].\nMore recently, numercial bifurcation tools have been implemented also for more general\nclasses of systems. For complex models, which are typically based on partial differential\nequation formulations, numerical routines are available as libraries [18]. Review [19]\ndiscusses bifurcation analysis techniques specifically for fluid dynamics problems (which\nare the dynamical core of climate models). Textbook [4] gives an introduction to bifurcation\nanalysis in oceanography and demonstrates the role it can play (it uses ENSO as one of\nits case studies). Specifically for DDEs, numerical methods for their bifurcation analysis\nare today available in the form of the packages DDE-Biftool [20] and knut [21]. These\nnumerical tools apply to general systems of DDEs, including DDEs with several delays\nand periodic forcing. In the same way as for ODEs, these tools can determine and track the\nstability properties and bifurcations of equilibria and periodic orbits. As we will demonstrate,\nthis means that numerical bifurcation studies can be performed efficiently today also for\nmodels that feature delays; see also the survey [22].\nThe most obvious application areas of bifurcation analysis are those where systems\nunder consideration have tunable parameters that the practitioner can adjust to achieve the\ndesired behaviour [11]; concrete such examples are engineering and laser physics. The\nsituation in climate science, on the other hand, is very different in that tuning a parameter\nis typically not possible in the real system. In spite of this fact, we argue that systematic\nparameter studies are still relevant in this context, namely to determine the sensitivity\nof the model under consideration to changes of parameters that are known only in an\norder-of-magnitude sense. The fact that the observed behaviour of a nonlinear system may\ndepend critically on all parameters motivates the bifurcation analysis with respect to selected\ndifficult-to-determine parameters; see [23] for an exemplary study.\nFor our specific example, two parameters that affect the ENSO resonances strongly\nare the mean and the annual variation of the ocean-atmosphere coupling. The values of\nthese two parameters are hard to ascertain in the real system; furthermore, they are also\ndifficult to compare and convert between models of different complexity. Hence, it makes\nperfect sense to locate a chosen resonance tongue in the given model to restrict the values\nof these two parameters. When one attempts to locate a particular resonance one encounters\nthe problem that the only places where one knows the frequency ratio analytically (or at\nleast numerically without a scan of the complete parameter plane) are the small-forcing\nand the small-oscillation-amplitude regimes. In these two regimes resonance tongues are\nextremely narrow, and convergence to the resonant orbits (if they are stable) is very slow.\nThis makes resonances hard to observe and track with simulations in the small-amplitude\nregime (corresponding to the classical devil's staircase scenario [5]). In this paper we show\nhow this difficulty can be overcome with numerical bifurcation analysis. More specifically,\nperiodic orbits are tracked as solutions of a boundary-value problem (BVP) and, as such,\nthese computations are unaffected by the instability (or weak stability) of the periodic orbit\nunder consideration or by its sensitive dependence on parameters. With this BVP approach\nwe have tracked the relevant resonance tongues directly from their root point near the\nlinear regime over a considerable region of the parameter plane. This bifurcation diagram,\nshown in Figure 6 of Section 4 below, constitutes our main result which demonstrates the\ncapabilities of numerical bifurcation analysis in the context of climate science.\n\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f4\n\nB. Krauskopf and J. Sieber\n\nparameter\n\nvalue (units)\n\ninterpretation\n\n\u03c41\n\n1.15 (months)\n\n\u03c42\n\n5.75 (months)\n\ntime it takes warm equatorial SST perturbations from central Pacific to reach eastern\nboundary (via Kelvin wave),\ntime it takes cold off-equatorial SST peturbations from central Pacific to reach eastern\nboundary (first westward via Rossby wave,\nthen eastward via reflected Kelvin wave),\namplification factor of warm perturbations,\nattenuation factor of cold perturbations,\nattenuation due to dissipation,\nocean-atmosphere coupling (saturation nonlinearity),\nannually varying slope of G at h = 0,\nfrequency of annual variation (period T = 12\nmonths),\nmaximum and minimum of saturation nonlinearity in G.\n\nb\nc\nd\nG(\u03bah)\n\n1/120 (per day, 0.2535 per month)\n1/160 (per day, 0.1901 per month)\n1/190 (per day, 0.1601 per month)\ndefined in Eq. (2.2)\n\n\u03ba(t)\n\u03c9\n\n\u03ba(t) = k0 + dk sin(\u03c9t)\n2\u03c0/12 (per month)\n\nb\u00b1\n\nb+ = 3, b\u2212 = \u22121\n\nTable 1: Values and interpretation of parameters in (2.1)\u2013(2.3)\n\n2. ENSO as a parametrically forced delayed-feedback oscillator\nWe consider a conceptual model for the ENSO mechanism that simplifies the circulation of\nocean surface water waves and the ocean-atmosphere interaction to a scalar DDE, which is\nperiodically forced due to the annual variation of the strength of ocean-atmosphere coupling.\nWe use the parameters and follow the notation of [9], where the dependent variable is the\nheight anomaly h(t) of the thermocline at the Eastern boundary of the Pacific. The height\nanomaly h (in dimensionless units) satisfies\nd\nh(t) = bG [\u03ba(t \u2212 \u03c41 )h(t \u2212 \u03c41 )] \u2212 cG [\u03ba(t \u2212 \u03c42 )h(t \u2212 \u03c42 )] \u2212 dh(t), where\ndt\n(\nb+ tanh(x/b+ ) if x \u2265 0,\nG(x) =\nb\u2212 tanh(x/b\u2212 ) if x < 0,\n\u03ba(t) = k0 + dk sin(\u03c9t).\n\n(2.1)\n(2.2)\n(2.3)\n\nThe right-hand side of (2.1) combines positive feedback due to the warm equatorial seasurface temperature (SST) perturbation in the central Pacific, negative feedback due to the\ncold off-equatorial SST perturbation in the central Pacific, and dissipation. The parameters\nand their values used here are from Tziperman et al [9], and they are listed in Table 1.\nThe idea that a dynamical instability is the basic mechanism behind ENSO was first\nproposed by Bjerknes in 1969 [24]. The review by Neelin et al [8] describes the hierarchy of\nmodels that have been developed during the following decades. The textbook [4] presents a\ndetailed walk-through of this hierarchy, including a derivation of delayed-feedback oscillator\nmodels very similar to (2.1). The more complex models in this hierarchy help to establish\nwhich physical processes are connected. The simpler models, such as (2.1) considered\nhere, take these connections for granted and treat them as lumped positive or negative\nfeedback terms in the right-hand side. Figure 1 sketches the physical processes that enter the\nright-hand side of (2.1) and their connections. The height of the thermocline is a proxy for\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\ncooling &\nsinking\n\nAtmospheric convection\n0\n\nwest wind (easterlies)\n0\nWest\n\n0\n\nave\nRossby w\n\u03c42\nhec\n\nKelvin wave\n\n\u03c42\n\n0\n\n0\nhoc\n\nEquator\n\nRossby\nwave\nPacific ocean\n\n5\n\nhoc\nCentral Pacific\n\n\u03c41\n\nh\nEast\n\nFigure 1: Schematic of the two feedback mechanisms that motivate the ENSO model (2.1). The shading of the\nocean corresponds to the thermocline (and sea-surface temperature) in equilibrium: darker means lower (colder).\nEquation (2.1) only describes the anomaly of the thermocline, h, at the eastern boundary. The labels hec and hoc\nrefer to the thermocline anomaly in the equatorial and the off-equatorial central pacific, respectively, which feed\ninto the feedback mechanisms. Regular arrows indicate same-sign re-inforcement and horizontal (inhibition) bars\nindicate oppposite-sign re-inforcement; the label on each arrow shows the time delay of the interaction.\n\nthe sea-surface temperature. In equilibrium the thermocline is low at the eastern boundary of\nthe Pacific and high at the western end. This difference maintains an atmospheric convective\nloop above the equatorial ocean, which points westward at the ocean surface because the\nrelatively cold water at the eastern end cools the atmosphere, causing air to sink (and\nvice-versa, the relatively warm water at the western end heats up the atmosphere, causing\nair to rise). The dependent variable h in (2.1) measures the anomaly of the thermocline at\nthe eastern boundary, that is, the deviation from equilibrium at this point.\nA disturbance in the atmospheric convective loop, that is, a slowing down of the\nwestward surface wind (creating an eastward wind stress of the ocean surface) in the central\nPacific causes surface water transport toward the equator. Surface water is warm, causing\nan increase of h in the equatorial central Pacific, and a decrease of h in the off-equatorial\ncentral Pacific. The positive thermocline disturbance at the equator travels eastward along the\nequator (in a Kelvin wave), and hits the eastern boundary after time \u03c41 . The corresponding\nincrease in sea-surface temperature at the eastern boundary slows down the atmospheric\nconvection (the relatively cold water at the eastern boundary is a driver of the convection).\nThis creates the first, positive feedback term in (2.1) with the delay \u03c41 (note that b > 0).\nThe off-equatorial depression of h travels westward and toward the equator (in a Rossby\nwave), reflects at the western Pacific boundary, and then travels as a Kelvin wave eastward,\nreaching the eastern boundary after time \u03c42 . The depression of h corresponds to a cooling\ndown of the sea surface such that atmospheric convection is enhanced, creating the negative\ndelayed feedback term in (2.1) with the delay \u03c42 (note that c > 0).\nThe above effects work all at the linear level of the disturbance of the equilibrium.\nThe nonlinearity in (2.1) comes from saturation and asymmetry in the ocean-atmosphere\ncoupling instability, as expressed by the function G in (2.2) that is shown in Figure 2.\nMoreover, the slope of G at h = 0 varies throughout the year, being strongest in the northern\nsummer and weakest in the winter; see [9] for a realistic time profile of the annual variation.\nThis annual variation is expressed in the sinusoidal variation (2.3) of the pre-factor \u03ba in the\nargument of G. Since only the amplification factor varies in time, the oscillator described by\n(2.1) is parametrically excited; in particular, the equilibrium h = 0 of the unforced system\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f6\n\nB. Krauskopf and J. Sieber\n\n3\n\n0\n\n2\n\n\u03ba\n\nG(\u03ba h)\n1\n\n2.75\n\n0\n\n\u22121\n\u22121\n\n0\n\nh\n\n5.5\n1\n\n2\n\nFigure 2: Profile of coupling function G(\u03bah) for \u03ba \u2208 0, . . . , 5.5, which are the values that are encountered in the\nparameter range (dk , k0 ) \u2208 [0, 2.5] \u00d7 [0, 3].\n\n(for dk = 0) corresponds to a trivial periodic solution in the periodically-forced system (for\ndk > 0).\n\n3. Delay differential equations and their bifurcations analysis\nThis section is a short review of the general theory of dynamical systems with delays as\nneeded for the bifurcation analysis of the ENSO model in Section 4, which the reader\nmay wish to consult already for illustrations of the concepts introduced now. To keep the\nexposition specific to the ENSO model under consideration, we present the theory for the\ncase that the right-hand side of the DDE depends on the current value of the dependent\nvariable, as well as on two values from the past, with delays \u03c41 \u2264 \u03c42 . Furthermore, we allow\nthe right-hand-side of the DDE to depend explicitly on time, which accounts for the periodic\nforcing of (2.1). Hence, we consider a DDE of the form\nd\nx(t) = f (t, x(t), x(t \u2212 \u03c41 ), x(t \u2212 \u03c42 ), \u03b7),\ndt\n\n(3.1)\n\nwhere x \u2208 Rn is an n-dimensional state and \u03b7 \u2208 Rm is a multi-parameter; one also refers to\nRn as the physical space. The function\nf : R \u00d7 Rn \u00d7 Rn \u00d7 Rn \u00d7 R m \u2192 Rn\ndescribes the right-hand-side, and it is assumed to be sufficiently smooth. Note that (3.1)\nis non-autonomous because f depends explicitly on time t. We consider here only the\ncase of periodic forcing, that is, f (t, *, *, *, \u03b7) = f (t + T f , *, *, *, \u03b7) where T f is the forcing\nperiod. An important special case is that the forcing amplitude is zero, so that system (3.1)\nis autonomous. We assume here that the forcing amplitude is one of the components of\nthe parameter vector \u03b7, so that the limiting autonomous case can be found as a subset of\nparameter space.\nWe proceed to discuss the basic properties of the DDE (3.1), both for the autonomous\nand the non-autonomous cases, which form the basis of the bifurcation analysis of the\nENSO model in Section 4. We remark that the theory presented here is also valid for more\ngeneral DDEs, including those with distributed delays, as long as all delays are constant\nand bounded. Full technical proofs can be found in the classical textbooks by Hale and\nVerduyn-Lunel [10] and Diekmann et al [25]; the textbook by St\u00e9p\u00e1n [2] is also rigorous,\nbut provides a shorter route to those parts of the theory that are necessary for practical\napplications.\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n7\n\nBecause of the presence of delayed terms, the DDE (3.1) does not define a dynamical\nsystem on the physical space Rn . Rather, its phase space is the infinite-dimensional space\nR \u00d7C([\u2212\u03c42 , 0]; Rn ); here R represents time and C([\u2212\u03c42 , 0]; Rn ) is the space of continuous\nfunctions over the maximal delay interval [\u2212\u03c4max , 0] = [\u2212\u03c42 , 0] with values in the physical\nspace Rn . This means that in order for the initial-value problem to be well defined one needs\nto prescribe an entire function x0 : [\u2212\u03c42 , 0] \u2192 Rn as the initial condition. Similarly, after\nsolving (3.1) from time 0 to time t the current state is the function xt : [\u2212\u03c42 , 0] \u2192 Rn given\nby xt (s) = x(t + s), s \u2208 [\u2212\u03c42 , 0]. These trajectories xt in the infinite-dimensional phase space\nR \u00d7 C([\u2212\u03c42 , 0]; Rn ) depend smoothly on the initial condition x0 , meaning that classical\ndynamical systems theory can be applied to the DDE (3.1) in R \u00d7C([\u2212\u03c42 , 0]; Rn ). When the\nforcing amplitude is zero the time axis decouples and it is sufficient to study the autonomous\nDDE with phase space C([\u2212\u03c42 , 0]; Rn ).\n(a) Equilibria and their bifurcations\nWe first consider the case that f is autonomous, which is of interest on its own as well\nas in the context of periodic forcing where it corresponds to zero forcing amplitude. An\nequilibrium or steady state is an initial function x0 : [\u2212\u03c42 , 0] \u2192 Rn in phase space such\nthat xt (s) = x0 (s) for all s \u2208 [\u2212\u03c42 , 0] and t > 0. Hence, x0 (s) equals a constant x\u03040 for all\ns \u2208 [\u2212\u03c42 , 0] and the constant vector x\u03040 \u2208 Rn can be determined from the equation\nf (x\u03040 , x\u03040 , x\u03040 , \u03b7) = 0,\n\n(3.2)\n\nwhich, as for ODEs, is a system of n algebraic equations. This means that equilibria of\nDDEs can be found and tracked in a parameter as roots of (3.2) by standard continuation\nmethods.\nTo determine the stability of an equilibrium x0 one moves it to the origin and linearises\nthe DDE. The result is a linear DDE of the form\n\u1e8b(t) = Ax(t) + Bx(t \u2212 \u03c41 ) +Cx(t \u2212 \u03c42 ),\nwhere A, B and C are n\u00d7n matrices. The stability of the origin is determined by the spectrum\nof the eigenvalues of the linearisation, which can be found as the roots of the characteristic\nfunction\n\u03c7(\u03bb ) = det(\u03bb I \u2212 A \u2212 Be\u2212\u03bb \u03c41 \u2212Ce\u2212\u03bb \u03c42 ),\n(3.3)\nwhere I is the n \u00d7 n identity matrix. The characteristic function \u03c7 of a linear autonomous\nDDE (of the type considerd here) has at most finitely many roots with non-negative real\npart [10, 2]. This means that the stability theory of equilibria of DDEs is very similar to that\nfor ODEs. An equilibrium is stable if all eigenvalues of its linearisation have negative real\npart. It changes its stability type when eigenvalues cross the imaginary axis of the complex\nplane. When a single parameter is varied there are two typical scenarios, which give rise to\nthe standard local bifurcations of equilibria of codimension one [11, 12, 13]:\n\u2022 when a single real eigenvalue goes through zero the bifurcation then one encounters,\nin the generic case, a saddle-node bifurcation, where two equilibria meet and disapper\n(or are created); in the presence of additional properties of the equation (such as\nsymmetries) one encounters a branch bifurcation, where two additional equilibria\nbifurcate;\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f8\n\nB. Krauskopf and J. Sieber\n\u2022 when a complex conjugate pair of eigenvalues moves across the imaginary axis of the\ncomplex plane then one encounters a Hopf bifurcation from which a small periodic\norbit bifurcates.\n\nThese bifurcations of autonomous DDEs can be detected and tracked as for ODEs by\nfixing the real parts of roots of the characteristic function \u03c7 in (3.3) to zero and freeing\na second parameter (such that \u03b7 \u2208 R2 ). In this way, one can compute curves of saddlenode/branch and Hopf bifurcations in a two-dimensional parameter space. The curves divide\nthe parameter plane into regions where different numbers and types of equilibria exist.\n(b) Periodic orbits and their bifurcations\nAn initial function x0 is a periodic point of the DDE (3.1) if it satisfies xT\u0393 (s) = x0 (s) for all\ns \u2208 [\u2212\u03c42 , 0] and some T\u0393 \u2265 0, where T\u0393 is called the (minimal) period of x0 . Practically, one\nfinds a periodic point of (3.1) as a periodic orbit, which is a closed curve \u0393 : [0, 1] 7\u2192 Rn in\nthe physical space satisfying the periodic boundary-value problem\n\u0393\u0307(t) = T\u0393 f (t, \u0393(t), \u0393(t \u2212 \u03c41 /T\u0393 )mod[0,1] , \u0393(t \u2212 \u03c42 /T\u0393 )mod[0,1] , \u03b7) for t \u2208 (0, 1],\n\n\u0393(0) = \u0393(1).\n\n(3.4)\n\nThe notation \u0393(t \u2212 \u03c4 j /T\u0393 )mod[0,1] means that for combinations of t, \u03c4 j and T\u0393 for which\nt \u2212 \u03c4 j /T\u0393 is outside of the interval [0, 1] we choose the appropriate integer \u03bd such that\nt \u2212 \u03c4 j /T\u0393 + \u03bd \u2208 [0, 1] and evaluate \u0393(t \u2212 \u03c4 j /T\u0393 + \u03bd). From any solution \u0393 of (3.4) one can\nfind periodic points x0 of period T\u0393 through the relationship\nq(s) = \u0393(s/T\u0393 )mod[0,1]\n\nfor s \u2208 [\u2212\u03c42 , 0].\n\n(3.5)\n\nWhen the DDE is autonomous then the period T\u0393 in (3.4) is one of the unknowns that must\nbe found together with \u0393. This can be done in the same way as for ODEs by the adding\none scalar equation, a so-called phase condition [26], which determines T\u0393 and makes the\nsolution \u0393 of (3.4) locally unique. Good starting points for periodic orbits of autonomous\nDDEs are Hopf bifurcations where small-ampitude periodic orbits branch off. Their period\nT\u0393 is determined by the imaginary part of the pair of purely complex conjugate eigenvalues\nat the Hopf bifurcation.\nThe situation is different when the DDE is periodically forced. Then there are no\nequilibria, and the simplest invariant object is a periodic orbit \u0393 whose period equals the\nforcing period T f , that is, T\u0393 = T f is known in (3.4). In fact, each equilibrium x0 (s) =\nx\u03040 , s \u2208 [\u2212\u03c42 , 0] of the autonomous system for zero forcing amplitude gives rise to a trivial\nperiodic orbit of the form \u03930 (t) \u2261 x\u03040 . The trivial periodic orbit \u03930 can then be continued as\na periodic orbit \u0393 of the periodically-forced DDE when the forcing is increased from 0. For\nthe special case that the forcing is parametric, as in the ENSO model (2.1), one finds that\n\u0393(t) = \u03930 (t) \u2261 0 remains constant for all forcing amplitudes; however, in general, \u0393(t) is a\nnon-constant periodic function when the forcing is nonzero; note that generically the period\nof any periodic orbit of a periodically-forced DDE is an integer multiple of the forcing\nperiod. Periodic orbits can generally not be found analytically, but the boundary value\nproblem (3.4) can be solved numerically with the same numerical methods (for example,\nwith Gauss collocation) that are used to compute periodic orbits of ODEs [22].\nThe stability of a periodic orbit \u0393 is determined by its Floquet multipliers \u03bci , which\nare the eigenvalues of the time-T\u0393 map of the point x0 on the periodic orbit \u0393 given by\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n9\n\n(3.5). If all \u03bci are inside the unit circle of the complex plane then \u0393 is stable; conversely,\nthe eigendirections of the Floquet multipliers outside the unit circle correspond to unstable\ndirections. Similarly to the case of equilibria, for a time-periodic DDE one can construct\na characteristic function \u03c7 p (\u03bc) such that the Floquet multipliers of \u0393 are the roots of \u03c7 p\n[21, 27]. Generally, the characteristic function \u03c7 p and its roots are found numerically, after\none has computed \u0393 and its period T\u0393 [28]. For a DDE there are infinitely many roots of\n\u03c7 p and, hence, Floquet multipliers \u03bci , but they are also discrete and have the origin of the\ncomplex plane as their only accumulation point; in particular, there are at most finitely\nmany unstable Floquet multipliers. As for ODEs, a periodic orbit changes its stability when\nFloquet multipliers cross the unit circle, and this gives rise to the same well-known local\nbifurcations of periodic orbits. When a single parameter is varied there are three typical\nscenarios, which give rise to the standard generic local bifurcations of periodic orbits of\ncodimension-one [11, 12, 13]:\n\u2022 when a single real Floquet multiplier goes through +1 then one encounters a saddlenode bifurcation of limit cycles, where two periodic orbits meet and disappear (or are\ncreated);\n\u2022 when a single real Floquet multiplier goes through \u22121 then one encounters a perioddoubling bifurcation, where a periodic orbit of twice the period bifurcates;\n\u2022 when a complex conjugate pair of eigenvalues goes through the unit circle at e\u00b12\u03c0\u03b1i\nthen one encounters a Neimark-Sacker or torus bifurcation, where a smooth invariant\ntorus bifurcates (provided that low-order resonances are avoided, that is, \u03b1 6= 1, 1/2,\n1/3, 2/3, 1/4, 3/4).\nAn example where bifurcations of the trivial periodic orbit can be found analytically is\nthe delayed Mathieu equation (also a parametrically forced system) [29]. More generally,\nhowever, these bifurcations of DDEs need to be detected and tracked numerically as for\nODEs, by appending the above conditions on the Floquet multipliers to the continuation\nof the periodic orbit. In this way, one can compute curves of saddle-node of limit cycle,\nperiod-doubling and torus bifurcations of DDEs in a two-dimensional parameter space.\n(c) Resonances and quasiperiodicity\nResonant periodic orbits are special periodic orbits that correspond to the locking of two\ndifferent oscillations of the system. They are organised in DDEs in resonance tongues\nand resonance surfaces in the same way as in ODEs; see Figure 6 later and, for example,\n[30, 31] for the general theory for ODEs. Along a torus bifurcation curve in a parameter\nplane a Floquet multiplier e\u00b12\u03c0\u03b1i moves along the unit circle, that is, the quantity \u03b1 changes.\nWhen \u03b1 = k/` \u2208 Q, a two-parameter family of k : ` resonant periodic orbits (a so-called\nresonance surface) branches off. The projection of this surface onto the parameter plane is a\nresonance tongue, which is a region in the parameter plane where periodic orbits exist that\nare k : ` locked to the original periodic orbit (or to the forcing period in a forced DDE, such\nas the parametrically forced ENSO model). Inside the resonance tongue there are initially\ntwo periodic orbits, one of which is always unstable. The root point of the resonance tongue\nis attached to the bifurcation curve. Close to the root point the two periodic orbits form\nk : ` torus knots. In a cross section transverse to the flow one finds a period-` orbit; the\nreturn map to the cross section acts on it by mapping each point to its kth neighbour in the\ncounter-clockwise direction. If the denominator ` is also greater than 4 both periodic orbits\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f10\n\nB. Krauskopf and J. Sieber\n\nlie on an invariant torus (close to the root point this is guaranteed by general theory [13]),\none periodic orbit is stable within the torus, one is unstable.\nSimilarly, one finds resonance tongues that are rooted at a line in the parameter plane\nwhere the forcing is zero. At such a root point of the k : ` resonance tongue the unforced\nsystem has a periodic orbit \u0393 such that the ratio of its period T\u0393 and the forcing frequency\nT f is \u03b1 = k/` \u2208 Q.\nBy contrast, when \u03b1 is irrational, that is, \u03b1 6\u2208 Q, then there is a smooth curve in the\nparameter plane starting at the corresponding point on the torus bifurcation curve, or line of\nzero forcing, along which one finds a torus that is densely filled by a quasiperiodic trajectory.\nThe overall scenario is one of a complicated interplay between locked and quasiperiodic\ndynamics on the bifurcating torus. In particular, if one plots the rotation number along\nany parameter path that intersects the resonance tongues one finds the well-known devil's\nstaircase consisting of infinitely many intervals where the rotation number is constant (inside\nthe resonance tongues), as also observed in simulations of ENSO models [5, 6, 7].\nA resonance tongue is bounded near its root point by saddle-node of limit cycle bifurcation curves of the two orbits existing inside. An alternative method to the simulations as\ndone in [5, 6, 7] is to compute the k : ` resonance surface by using the periodic BVP (3.4)\nwith period T\u0393 = `T f and two free parameters. In this way one obtains a surface consisting\nof all locked periodic orbits inside the resonance tongue. This compuation can be started\nat any point with rational \u03b1 on the torus bifurcation curve or the line where the system\nis unforced. The continuation of the locked periodic orbits is numerically robust, and the\nresonance tongue is obtained by projection onto the parameter plane. This method has been\nintroduced in [31, 32] for the computation of resonance surfaces in maps and forced ODEs;\nAppendix A explains how it can be adapted and implemented for a general DDE of the form\n(3.1).\n\n(d) Ready-to-use software for the bifurcation analysis of DDEs\nDDE-Biftool is a collection of Matlab functions that perform each necessary task and that\ncan be called by the user. For example, there exist functions for calculating the eigenvalues\nof a given equilibrium, the Floquet multipliers of a periodic orbit, for converting a periodic\nBVP into a large (discretised) nonlinear system, for solving nonlinear equations with Newton\niteration, for adapting the mesh on a given periodic solution, and for tracking solutions\nof nonlinear systems if one has one more free parameter than equations. Curve tracking\nof equilibria in a single parameter, of codimension-one bifurcations of equilibria in two\nparameters, and of periodic orbits of autonomous DDEs in a single parameter have been\nimplemented. Codimension-one bifurcations of periodic orbits can be detected, but tracking\nthem requires one to define a suitable extended system manually. Because DDE-Biftool\npermits one to add an arbitrary number of conditions and parameters to the system, it is\npossible to track solution surfaces instead of curves. We make use of this feature for the\ncomputation of resonance tongues; see Appendix A.\nThe package knut (formerly known as PDDE-Cont) is a stand-alone alternative to\nDDE-Biftool. Its numerical methods are summarised in the review article by Roose and\nSzalai [22] and in [21].\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n0.3\n\n(a)\n0.2\n\n(b)\n\n0.2\n\n0.1\n\nRe \u03bb\n\n11\n\nH\n\n0.1\n0\n\nH\n\nB\n\nIm \u03bb\n\nincrease k0\n\nB\n\n0\n\n\u22120.1\n\u22120.1\n\u22120.2\n\nH\n\n\u22120.2\n\n\u22120.3\n\u22120.4\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n\u22120.5\n\n\u22120.4\n\n\u22120.3\n\n\u22120.2\n\n\u22120.1\n\nk0\n\n0\n\n0.1\n\n0.2\n\nRe \u03bb\n\nFigure 3: Stability of the trivial equilibrium h \u2261 0 and of bifurcating secondary equilibria of (2.1) for dk = 0 as a\nfunction of k0 . Panel (a) shows the real parts of the eigenvalues of the equilibria as a function of k0 , and panel (b)\nshows the locus of the two leading eigenvalues in the complex plane; the eigenvalues of h \u2261 0 are plotted in black\nand those of the bifurcating equilibria in grey.\n\n4. Bifurcation analysis of the ENSO model\nThe main conclusion of Tziperman et al [9] was that in model (2.1) the peak of the ENSO\nis locked to the end of the year, which corresponds to the minimum of the excitation \u03ba(t).\nThat is, if \u03ba(t) = k0 + dk sin(t\u03c0/6) such that the period of \u03ba is 12 (time is in unit of months),\nthen the maximum of the thermocline anomaly, h, occurs at t \u2248 8 . . . 9 + 12` where ` is the\ndenominator of the resonance. In [9] the parameters were chosen such that ` = 3, so the\nENSO peak occured every three years. The authors also stated that in all their simulations\nthey found the locking to the peak to the end of the year to be extremely robust with respect\nto all parameters.\nWe demonstrate here how the phenomenon of delay-induced resonances can be studied\nsystematically by means of a bifurcation analysis of (2.1). More specifically, we determine\nall k : ` resonance tongues with ` \u2264 11 in the relevant region of the (dk , k0 )-plane of mean\nk0 versus annual variation dk of the amplification factor in (2.3); they are chosen as the\nbifurcation parameters since the interaction between ocean and atmosphere is known only\nqualitatively as expressed by the function G shown in Figure 2. In contrast, confidence in\nthe other parameters of (2.1) is higher: the delays \u03c41 and \u03c42 are known with good accuracy,\nand the relation between damping and feedback effects can be estimated directly from\nobservations (involving only oceanic quantities). These other parameters are fixed at the\nvalues from [9]; see Table 1.\n(a) The autonomous regime for dk = 0\nThe starting point of our bifurcation analysis is the autonomous case where dk = 0. Then\nh \u2261 0 is an equilibrium irrespective of the value of k0 , and we know that it is stable for\nk0 = 0. We proceed to continue this equilibrium with the package DDE-Biftool [20] over\nthe range k0 \u2208 [0, 3] while monitoring its stability. The behaviour of the eigenvalues of\nh \u2261 0 is illustrated by the black curves in Figure 3. Panel (a) shows how the real part of\nthe eigenvalues changes with k0 , and panel (b) how the two leading eigenvalues move\nin the complex plane with increasing k0 . The trivial equilibrium h \u2261 0 is initially stable\nand then loses its stability at k0 \u2248 1.426 in a Hopf bifurcation H, where a complex pair of\neigenvalues crosses the imaginary axis. At k0 \u2248 2.158 the complex pair meets on the real line\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f12\n\nB. Krauskopf and J. Sieber\n\n2\n\n2 (a)\n\nmint h(t), maxt h(t)\n\n1\n\n0\n\nH\n\n0\n\u22121\n\n1:4\n\n2\n\n(d)\n\n0\n\nstable\nunstable\n\n2\n\n(b)\n\n0\n\n1 : 6 (g)\n\n\u22121\n\n2 : 11 (f)\n\n2\n\n66\n\n60\n\n1 : 5 (e)\n\n54\n\n2 : 9 (d)\n\n72\n\n1 : 4 (c)\n0\n\n1\n\n1:5\n\n0\n\n2 : 11\n\n\u22121\n2\n0\n\n1:6\n\n\u22121\n\nk0\n\n2\n\n72 months\n\n(g)\n\n1\n\nh\nH\n\n66 months\n\n(f)\n\n1\n\nh\n\n48\n\n60 months\n\n(e)\n\n1\n\nh\n\nperiod T (months)\n\n2:9\n\n\u22121\n\u22121\n\n54 months\n\n1\n\nh\n\nB\n\n48 months\n\n(c)\n\n1\n\nh\n\n3\n\n0\n\n12\n\n24\n\n36\n\n48\n\n60\n\n72\n\ntime (months)\n\nFigure 4: Single-parameter bifurcation diagram (a) of the autonomous system (2.1) for dk = 0 and varying k0 . The\nequilibrium h \u2261 0 loses stability at the Hopf bifurcation H; a branch of secondary equilibria emerges from the\nbranch point B. Panel (b) shows the period T along the branch of stable periodic orbits that bifurcates from H, and\npanels (c)\u2013(g) show time profiles of the indicated low-order resonant periodic orbits along the branch.\n\nof the complex plane and splits up into two real eigenvalues. One of these real eigenvalues\ndecreases and crosses the origin of the complex plane at k0 \u2248 2.526 (the point is labelled\nB in Figures 3 and 4). Physically, at B the positive feedback terms in (2.1) exactly cancel\nthe damping and the negative feedback for h = 0, and a branch of two nonzero equilibria\nbifurcates and exists for k0 past B. We continued these equilibria, and their eigenvalues are\nshown as grey curves in Figure 3. There is a pair of positive real eigenvalues and, hence, the\nsecondary equilibria are unstable in the range k0 \u2208 [2.526, 3].\nFigure 4(a) shows the one-parameter bifurcation diagram for k0 \u2208 [0, 3]. The equilibrium\nh \u2261 0 loses its stability at H, and at the branch point B the branch of secondary, unstable\nequilibria emerges. Also shown in Figure 3(a) is the branch of bifurcating periodic orbits\nas computed by continuation with DDE-Biftool from the Hopf bifurcation point H. The\nperiodic orbits are represented by plotting their minina and maxima; they are all stable, as\nwas checked with the computation of the Floquet multipliers (not shown). Of special interest\nare those periodic orbits along the branch that give rise to low-order resonances with the\nforcing period of T f = 12 months (once the annual variation of the amplification is turned\non, that is, dk is increased from 0). Figure 4(b) shows the period T\u0393 of the periodic orbits\nalong the branch, where all k : ` resonant periodic orbits with ` \u2264 11 are indicated - from\nthe 1 : 4 resonance very close to the Hopf bifurcation H to the 1 : 6 resonance at k0 \u2248 2.982.\nPanels (c)\u2013(g) show the respective time profiles of these resonant periodic orbits.\nFigure 4 gives a complete picture of the autonomous dynamics of (2.1) for dk = 0. Notice\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n2\n\n1.5\n\n(a)\n\n13\n\n(b)\n\n1\n1.5\n0.5\n\n|\u03bc |\n\n1\n\nTR\n\nPD\n\nIm \u03bc\n\nTR\nincrease dk\n\n0\n\nPD\n\n\u22120.5\n0.5\n\nTR\n\n\u22121\n0\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n\u22121.5\n\u22122.5\n\n\u22122\n\n\u22121.5\n\n\u22121\n\n\u22120.5\n\ndk\n\nRe \u03bc\n\n0\n\n0.5\n\n1\n\nFigure 5: Stability of the trivial periodic solution h \u2261 0 as a function of the forcing dk for k0 = 1.8. Panel (a) shows\nthe Floquet multipliers as a function of dk , and panel (b) shows the locus of the two leading Floquet multipliers in\nthe complex plane.\n\nfurther from Figure 3(a) that all but the two leading eigenvalues have quite large negative\nreal parts. This suggests that the dynamics of the DDE (2.1) behaves like a two-dimensional\nODE with parametric periodic forcing for k0 \u2264 3 and delays that are realistic for the ocean.\nFor this reason, the bifurcation diagram of the autonomous DDE is fairly simple. This is\nin contrast to the much more complex bifurcation diagrams when the delays become large\nenough to shift a large number of eigenvalues close to the imaginary axis [33].\n\n(b) The dynamics with periodic forcing for dk > 0\nWe now perform a bifurcation analysis of the periodically-forced DDE (2.1) for dk > 0. The\ntrivial periodic solution h \u2261 0 for dk = 0 gives rise for dk > 0 to a periodic orbit with period\nT f . Owing to the parametric nature of the periodic forcing, this periodic orbit has zero\namplitude, that is, it remains the trivial solution h \u2261 0. As was the case for the equilibria in\nthe autonomous case, the main question is when h \u2261 0 is stable. This can be determined by\nits continuation in dk for fixed k0 . Figure 5 shows how the Floquet multipliers of the trivial\nperiodic orbit h \u2261 0 change as dk is increased for fixed k0 = 1.8, which is the value that was\nused in [9]. For (k0 , dk ) = (1.8, 0) the periodic orbit h \u2261 0 is initially unstable, since a single\npair of complex conjugate Floquet multipliers lies outside the unit circle. At dk \u2248 1.659\nthis complex conjugate pair crosses the unit circle and h \u2261 0 undergoes a torus bifurcation,\nlabelled T R, and becomes stable. When dk is increased further, the complex conjugate pair\ncomes together on the real line of the complex plane at dk \u2248 1.810 and then splits up into\ntwo real Floquet multipliers. Very soon thereafter, at dk \u2248 1.814, one of them decreases and\ncrosses the unit circle at \u22121 and, hence, h \u2261 0 undergoes a period-doubling bifurcation,\nlabelled PD, and becomes unstable again.\nWe now consider the bifurcation diagram of (2.1) in the (dk , k0 )-plane, which is shown\nin Figure 6. The torus bifurcation and the period-doubling bifurcation have been continued\nas curves. The torus bifurcation curve T R starts at the Hopf bifurcation point on the\nautomonous-limit line dk = 0 and it ends on the period-doubling bifurcation curve PD in\na 1 : 2 resonance. Below the curve T R and to the left of the curve PD the trivial periodic\norbit h \u2261 0 is stable. To the right of the curve PD and above the curve T R the periodic orbit\nh \u2261 0 is unstable.\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f14\n\nB. Krauskopf and J. Sieber\n\n3\n1:6\n1:4\n2:11\n\n2.5\n1:3\n\n1:5\nk0\n\n2 2:9\nsa\n\ne\nod\n-n\ne\nl\ndd\n\node\ne-n\nl\nd\nsad\n\n1:2\n\np\n\ng\nlin\nub\no\n-d\nod\neri\n\nPD\n\n1:3\nion T R\ntorus bifurcat\n\norigin stable\n\n1\n0\n\n0.5\n\nPD\n\n3:11\n\n1.9\n\n3:10\n\nub\nling\n\nH\n\n2:7\n\nper\nio d\n-do\n\n1:4\n\n1.5\n\n1\n\ndk\n\n[T'98]\n4:11\n\n1.7\n1.4\n1.5\n\n1:3\n\n2\n\n1.7\n2.5\n\nFigure 6: Two-parameter bifurcation diagram of the ENSO model (2.1) in the (dk , k0 )-plane (dk , k0 ). All k : `\nresonance tongues with ` \u2264 11 are shown. They are rooted at points on the autonomous boundary dk = 0 and on\nthe torus bifurcation curve T R, which ends on a period-doubling curve at a 1 : 2 resonance. The trivial solution\nh \u2261 0 is stable in the region below the curve T R. The inset shows an enlargement near the tip of the 1 : 3 resonance\ntongue; the point corresponding to the parameter values used by Tziperman et al [9] is marked by a cross.\n\n(c) Resonance tongues in the ENSO model\nAbove the torus bifurcation curve T R one finds invariant tori and associated k : ` resonance\ntongues, and Figure 6 shows all resonance tongues for ` \u2264 11. As we have already seen in\nFigure 4, along the line dk = 0 and above the Hopf bifurcation point H we find five root\npoints of these resonance tongues. Additional root points of resonance tongues are found\nalong the torus bifurcation curve T R. Specifically, we observe that the rotation number \u03b1\ngradually increases until the torus bifurcation curve terminates in the 1 : 2 resonance on\nthe period-doubling bifurcation curve PD; along T R we find nine more root points of k : `\nresonance tongues with ` \u2264 11. The resonance tongues in Figure 6 have been computed as\nresonance surfaces with the method described in Appendix A; they were then projected onto\nthe (dk , k0 )-plane to yield the open regions of locked periodic orbits and their boundaries.\nNotice how, as theory states [30, 31], the resonance tongues become very narrow with\nincreasing denominator `. We found that the corresponding k : ` locked periodic orbit of\nthe ENSO model is stable and, hence, observable practically everywhere throughout the\nconsidered parameter region (exceptions are the parts of the narrow 3 : 11, 3 : 10, 4 : 9,\nand 5 : 11 resonance tongues in the area where dk > 2). The cross in Figure 6 shows the\nparameter point chosen by Tziperman et al [9]; it is slightly to the left of the 1 : 3 tongue\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n(a)\n\n1:3\n\n15\n\n(b) 1 : 4\n\n2\n\n2\n\n2.5\n\nh\n1\n\n2.5\n\nh\n1\n\ndk\n\ndk\n\n0\n\n0\n\n2\n\nforcing\n\n\u22121\n\nforcing\n\n\u22121\n\n1.3\n\n1.5\n0\n\n10\n\n20\n\n30\n\n0\n0\n\ntime t (months)\n\n10\n\n20\n\n30\n\n40\n\ntime t (months)\n\nFigure 7: Locking of ENSO peak to the end of the year for all stable periodic orbits in the main tongues of 1 : 3 (a)\nand 1 : 4 resonance (b), where grayscale represents the value of dk for which the periodic orbit is found. The black\nsinusoidal curve at the bottom indicates the phase of the forcing.\n\n(see the inset), which explains that these authors observed non-periodic motion closely\nresembling a period-three orbit.\nThe other main feature observed in [9] is that the peak of the oscillations appeared to be\nlocked to the end of the year, that is, the maximum of h(t) occurs at time t \u2248 8 . . . 9 + 12`.\nTo investigate how general this observation is Figure 7 displays the profiles of all stable\nperiodic orbits in the main 1 : 3 and 1 : 4 resonance tongues, together with the forcing. We\nfind clear evidence of phase locking to the forcing in both cases, where the stable periodic\norbit reaches its maximum shortly before the forcing reaches its minimum. Since the delays\n\u03c41 and \u03c42 enter directly into the phase of the forcing of the ENSO model (2.1), it is clear that\nthe two delays strongly influence the location of the maximum of h relative to the forcing\nphase. Figure 7 is evidence that the phase between h and the forcing is nearly independent\nof the parameters dk and k0 . This observation provides a certain justification for a reduction\nof the ENSO model even further to contain only the delays and not the periodic forcing; see\n[34] for a demonstration of how resonances can be explored with Boolean delay equations.\n\n5. Conclusions\nWe presented a bifurcation study of how delay-induced resonances organise the parameter\nplane of mean and variation of the annual forcing of a model of ENSO with delayed feedback\nand forcing. The main message is that, colloquially speaking, the bifurcation theory for\nthe considered class of DDEs is exactly as that for ODEs, but embedded into an infinite\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f16\n\nB. Krauskopf and J. Sieber\n\ndimensional phase space. Hence, equilibria, periodic orbits and their bifurcations can be\ndetected and tracked in DDEs much as for ODEs, and software packages exist for this task.\nAs our case study demonstrates, numerical bifurcation anlysis is today perfectly feasible for\nperiodically-forced DDEs, and it allows one to obtain insights beyond what is possible with\nlong-time simulations.\nBifurcation analysis of equilibria and periodic orbits can give evidence for the presence\nof deterministic chaos via the detection of bifurcations associated with routes to chaos. A\nspecific example is chaotic dynamics due to the break-up of tori when resonance tongues\noverlap. In the ENSO model the resonance tongues do not overlap in the parameter region\nwe explored and, hence, no chaotic dynamics was found. However, when the forcing is large\nenough, resonance tongues will generally overlap, and the method we used of computating\nresonance tongues as surfaces is especially suitable in this case. Hence, bifurcation analysis\ncan add insight into the chaotic dynamics in DDE models.\nA limitation of bifurcation analysis is that chaotic behaviour can only be studied indirectly, by finding bifurcations and instabilities of equilibria and periodic orbits. In the\nstudy of climate systems this imposes restrictions on the realism of the model. For example,\na realistic ocean boundary or ocean floor will introduce fluctuations even at steady-state\nocean flow. Thus, bifurcation analysis in ocean and climate systems is typically performed\non idealised systems [4]. These idealized systems incorporate the relevant physical effects\nbut reduce realism such that steady states become genuine equilibria. The Zebiak-Cane\nmodel for ENSO, which provides the basis for the delayed oscillator model, is one example\nof such idealised systems (described in the review [8]).\nAnother issue in this regard is that - even for systems much simpler than climate models\n- it is often very hard, if not impossible, in practice to distinguish between deterministic\nchaos and noise-induced fluctuations in observed data. One reason for this may lie in a lack\nof hyperbolicity of the deterministic chaotic attractor, which makes it non-robust (that is,\nsensitive to arbitrarily small changes in the parameters); this non-robustness gets 'smeared\nout' if one adds random disturbances to the deterministic model; see [35] for a study relevant\nto climate dynamics. In particular, for the ENSO these two hypotheses are still competing.\nWhereas Tziperman et al [9] presented the ENSO as if it was mostly a deterministic chaotic\ntrajectory, linear models subject to noise are also used to explain, for example, the variation\nin ENSO predictability [36]. In terms of the two-parameter bifurcation diagram in Figure 6,\nlinear models would assume that the forcing parameters are from the stable region (below\ncurve T R), and that noise excites the system in the direction of the dominant eigenvectors.\n\nAcknowledgements\nThe research of B.K. was supported by an FRDF grant from the Faculty of Science, The\nUniversity of Auckland, and that of J.S. by grant EP/J010820/1 from the Engineering and\nPhysical Sciences Research Council.\n\nReferences\n[1] Henry DI Abarbanel and Matthew B Kennel. Synchronizing high-dimensional chaotic\noptical ring dynamics. Phys. Rev. Lett., 80(14):3153, 1998.\n[2] G St\u00e9p\u00e1n. Retarded Dynamical Systems: Stability and Characteristic Functions.\nLongman Scientific and Technical, Harlow, Essex, 1989.\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n17\n\n[3] B. Krauskopf. Bifurcation analysis of lasers with delay. In D.M. Kane and K.A. Shore,\neditors, Unlocking Dynamical Diversity: Optical Feedback Effects on Semiconductor\nLasers, pages 147\u2013183. Wiley, 2005.\n[4] H.A. Dijkstra. Dynamical Oceanography. Springer-Verlag, New York, 2008.\n[5] F.-F. Jin, J.D. Neelin, and M. Ghil. El Ni\u00f1o on the devil's staircase: annual subharmonic\nsteps to chaos. Science, 264(5155):70\u201372, 1994.\n[6] F.-F. Jin, J.D. Neelin, and M. Ghil. El Ni\u00f1o/Southern Oscillation and the annual cycle:\nsubharmonic frequency locking and aperiodicity. Physica D, 98:442\u2013465, 1996.\n[7] E. Tziperman, L. Stone, M.A. Cane, and H. Jarosh. El Ni\u00f1o chaos: Overlapping of\nresonances between the seasonal cycle and the Pacific ocean-atmosphere oscillator.\nScience, 264:7274, 1994.\n[8] J.D. Neelin, D.S. Battisti, A.C. Hirst, F.-F. Jin, Y. Wakata, T. Yamagata, and S.E.\nZebiak. ENSO theory. J. Geophysical Research, 103(C7):14261\u201314290, 1998.\n[9] E. Tziperman, M.A. Cane, S.E. Zebiak, Y. Xue, and B. Blumenthal. Locking of El\nNi\u00f1o's peak time to the end of the calendar year in the delayed oscillator picture of\nENSO. J. Climate, 11:2191\u20132199, 1998.\n[10] J.K. Hale and S.M. Verduyn Lunel. Introduction to functional-differential equations,\nvolume 99 of Applied Mathematical Sciences. Springer-Verlag, New York, 1993.\n[11] J. Michael T. Thompson and H. B. Stewart. Nonlinear dynamics and chaos. Wiley,\nChichester, UK, 2 edition, 2002.\n[12] J. Guckenheimer and P. Holmes. Nonlinear oscillations, dynamical systems, and\nbifurcations of vector fields, volume 42 of Applied Mathematical Sciences. SpringerVerlag, New York, 1990. ISBN 0-387-90819-6.\n[13] Y. A Kuznetsov. Elements of Applied Bifurcation Theory, volume 112 of Applied\nMathematical Sciences. Springer-Verlag, New York, third edition, 2004. ISBN\n0-387-21906-4.\n[14] E. J. Doedel, A. R. Champneys, T. F. Fairgrieve, Y. A. Kuznetsov, B. Sandstede, and\nX. Wang. AUTO97, Continuation and bifurcation software for ordinary differential\nequations. Concordia University, 1998.\n[15] A Dhooge, W Govaerts, and Y A Kuznetsov. MatCont: A Matlab package for\nnumerical bifurcation analysis of ODEs. ACM Transactions on Mathematical Software,\n29(2):141\u2013164, 2003.\n[16] W. Govaerts and Y.A. Kuznetsov. Interactive continuation tools. In B Krauskopf, H M\nOsinga, and J Gal\u00e1n-Vioque, editors, Numerical Continuation Methods for Dynamical\nSystems: Path following and boundary value problems, pages 51\u201375. Springer-Verlag,\nDordrecht, 2007.\n[17] B Krauskopf, H M Osinga, and J Gal\u00e1n-Vioque, editors. Numerical Continuation Methods for Dynamical Systems: Path following and boundary value problems. SpringerVerlag, Dordrecht, 2007.\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f18\n\nB. Krauskopf and J. Sieber\n\n[18] A.G. Salinger, N.M. Bou-Rabee, R.P. Pawlowski, E.D. Wilkes, E.A. Burroughs, R.B.\nLehoueq, and L.A. Romero. LOCA 1.1 - Library of continuation algorithms: Theory\nand implementation manual. SANDIA, 2002.\n[19] H. A. Dijkstra, F. W. Wubs, A. K. Cliffe, E. Doedel, I. F. Dragomirescu, B. Eckhardt,\nA. Y. Gelfgat, A. L. Hazel, V. Lucarini, A. G. Salinger, E. T. Phipps, J. SanchezUmbria, H. Schuttelaars, L. S. Tuckerman, and U. Thiele. Numerical bifurcation\nmethods and their application to fluid dynamics: analysis beyond simulation. Commun.\nComput. Phys., 15:1\u201345, 2014.\n[20] K. Engelborghs, T. Luzyanina, and D. Roose. Numerical bifurcation analysis of delay\ndifferential equations using DDE-BIFTOOL. ACM Transactions on Mathematical\nSoftware, 28(1):1\u201321, 2002.\n[21] R. Szalai, G. St\u00e9p\u00e1n, and S.J. Hogan. Continuation of bifurcations in periodic delay\ndifferential equations using characteristic matrices. SIAM J. Scientific Computing, 28\n(4):1301\u20131317, 2006.\n[22] D. Roose and R. Szalai. Continuation and bifurcation analysis of delay differential\nequations. In B Krauskopf, H M Osinga, and J Gal\u00e1n-Vioque, editors, Numerical\nContinuation Methods for Dynamical Systems: Path following and boundary value\nproblems, pages 51\u201375. Springer-Verlag, Dordrecht, 2007.\n[23] H.A. Dijkstra and M. Ghil. Low-frequency variability of the large-scale ocean circulation: A dynamical systems approach. Rev. Geophys., 43(3):RG3002, 2005.\n[24] J. Bjerknes. Atmospheric teleconnections from the equatorial pacific. Monthly Weather\nReview, 97:163\u2013172, 1969.\n[25] O. Diekmann, S.A. van Gils, S.M. Verduyn Lunel, and H.-O. Walther. Delay equations,\nvolume 110 of Applied Mathematical Sciences. Springer-Verlag, New York, 1995.\n[26] E J Doedel. Lecture notes on numerical analysis of nonlinear equations. In\nB Krauskopf, H M Osinga, and J Gal\u00e1n-Vioque, editors, Numerical Continuation\nMethods for Dynamical Systems: Path following and boundary value problems, pages\n1\u201349. Springer-Verlag, Dordrecht, 2007.\n[27] J. Sieber and R. Szalai. Characteristic matrices for linear periodic delay differential\nequations. SIAM J. Appl. Dynam. Syst., 10(1):129\u2013147, 2011.\n[28] T. Insperger and G. St\u00e9p\u00e1n. Semi-Discretization for Time-Delay Systems. Applied\nMathematical Sciences, volume 178. Springer-Verlag, New York, 2011.\n[29] T Insperger and G St\u00e9p\u00e1n. Stability chart for the delayed Mathieu equation. Proc. Roy.\nSoc. A, 458(2024):1989\u20131998, 2002.\n[30] V.I. Arnol'd. Geometrical Methods in the Theory of Ordinary Differential equations,\nvolume 250 of Fundamental Principles of Mathematical Sciences. Springer-Verlag,\nNew York, 1983.\n[31] R.P. McGehee and B.B. Peckham. Resonance surfaces for forced oscillators. Experimental Mathematics, 3(3):221\u2013244, 1994.\nArticle submitted to Phil. Trans. of the Royal Society\n\n\fBifurcation analysis of delay-induced resonances of ENSO\n\n19\n\n[32] F. Schilder and B. B. Peckham. Computing Arnol'd tongue scenarios. J. Comput.\nPhys., 220:932\u2013951, 2007.\n[33] H. Fazelinia, R. Sipahi, and N. Olgac. Stability robustness analysis of multiple timedelayed systems using building block concept. IEEE Trans. Automatic Control, 52(5):\n799\u2013810, 2007.\n[34] M. Ghil, I. Zaliapin, and B. Coluzzi. Boolean delay equations: a simple way of looking\nat complex systems. Physica D, 237(23):2967 \u2013 2986, 2008.\n[35] M. Ghil, M.D. Chekroun, and E. Simonnet. Climate dynamics and fluid dynamics:\nnatural variability and related uncertainties. Physica D, 237:2111\u20132126, 2008.\n[36] C. J. Thompson and D. S. Battisti. A linear stochastic dynamical model of ENSO.\nPart II: Analysis. J. Climate, 14:445\u2013466, 2001.\n\nAppendix A. Computation of resonance tongues as surfaces\nWe now present technical details of how we compute a resonance surface of a DDE of the\nform (3.1); our method is based on the principle described in [31, 32] for ODEs and has\nbeen implemented on top of DDE-Biftool.\n(i) Branching off from a resonant torus bifurcation point\nWe consider a k : ` resonant point x on a previously computed torus bifurcation curve in\na parameter plane (such as the curve T R in Figure 6), where the periodic orbit \u0393 undergoing\nthe torus bifurcation has a Floquet multiplier e\u00b12\u03c0\u03b1i with \u03b1 = k/` and 0 < k < ` are coprime\nintegers. We represent this point as the tuple (x, \u03b1, \u03b7). Here \u03b7 is assumed to be of dimension\ntwo, and the periodic orbit \u0393 is the solution of the periodic BVP (3.4). Let z(t) be the\neigenfunction corresponding to the Floquet multiplier e2\u03c0i\u03b1 ; then z has period ` (since k and\n` do not have a common divisor). We now choose a small radius \u03c1, and consider as initial\nguesses for the initial circle (of radius \u03c1) of locked periodic orbits the family\nx0,\u03c6 (t) = \u0393(`t) + \u03c1 cos \u03c6 Re z(`t) + \u03c1 sin \u03c6 Im z(`t),\n\n\u03c6 \u2208 [0, 2\u03c0/`], t \u2208 [0, 1],\n\nwhich is parametrised by the angle \u03c6 . Note that here we have rescaled time again so that\nx0,\u03c6 has period 1. We now perform a Newton iteration where we keep the two-dimensional\nsystem parameter \u03b7 (initialised to its value at the resonance point) free but fix the integral\nscalar products\n0=\n\nZ 1\n0\n\nRe z(`t)T [x\u03c6 (t) \u2212 x0,\u03c6 (t)] dt,\n\n0=\n\nZ 1\n0\n\nIm z(`t)T [x\u03c6 (t) \u2212 x0,\u03c6 (t)] dt.\n\n(A 1)\n\nTogether with requiring that x\u03c6 satisfies the periodic boundary-value problem (similar to\n(3.4) but with T\u0393 = `T f )\n\u1e8b\u03c6 (t) = `T f f (t, x\u03c6 (t), x\u03c6 (t \u2212 \u03c41 /(`T f )), x\u03c6 (t \u2212 \u03c42 /(`T f )), \u03b7),\n\nx\u03c6 (0) = x\u03c6 (1),\n\n(A 2)\n\nsystem (A 1)\u2013(A 2) is an equation for the variables (x\u03c6 , \u03b7) with a locally unique solution\nfor every \u03c6 and (sufficiently small) initial radius \u03c1.\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f20\n\nB. Krauskopf and J. Sieber\n\n(ii) Branching off from an autonomous periodic orbit\nCreating the initial circle for a resonance surface starting from an autonomous oscillation\nfor zero forcing is slightly different from the case of branching off from a torus curve.\nSuppose that at \u03b7 = (\u03b71 , \u03b72 ) = (\u03b71 , 0) the period T\u0393 of a periodic orbit \u0393 and the forcing\nperiod T f have a ratio k/`, where 0 < k < ` are again coprime; here we assume that the\nsecond component \u03b72 of the parameter \u03b7 is the amplitude of the forcing. Then we choose\nas our initial guesses x0,\u03c6 (t) = x(`(t + \u03c6 /(2\u03c0))) (again, rescaling time such that the period\nof x0,\u03c6 equals 1). Two additional conditions are given by fixing the initial forcing \u03b72 to the\nsmall radius \u03c1, and by fixing the phase of the initial solution x\u03c6 :\n0=\n\nZ 1\n0\n\n\u1e8b0,\u03c6 (t)T x\u03c6 (t) dt,\n\n\u03b72 = \u03c1.\n\n(A 3)\n\nSolving (A 2) combined with (A 3) results in an initial topological circle of locked orbits\n(x\u03c6 , (\u03b71 , \u03b72 )), parametrised by \u03c6 \u2208 [0, 2\u03c0/`].\n(iii) Growing the surface circle by circle\nOnce we have an initial circle of solutions x\u03c6 on the resonance surface, we can continue\nthe surface by computing nearby circles (which are generally only topological circles). We\nparametrise the surface locally by the angle \u03c6 on the circle and by its orthogonal complement\nin the tangent space of the solution surface. An equidistributed mesh of solutions on an\nalready computed topological circle is given. We pick a point (x, \u03b7)old at angle \u03c6 on this\ncircle. The tangent space in (x, \u03b7)old to the resonance surface is two-dimensional, and can\nbe computed as the two-dimensional nullspace of the linearisation of (A 2) in (x, \u03b7)old . One\ncomponent of this tangent space, spanned by t1 = (x, \u03b7)tan,1 , points along the old circle. We\ndenote its orthogonal complement in the tangent space by t2 = (x, \u03b7)tan,2 , and take a small\nstep (of size \u03b4 ) from (x, \u03b7)old along t2 to obtain an initial guess (x, \u03b7)new . Newton iteration\nis used to solve (A 2), augmented with the two linear equations\n0=\n\nZ 1\n0\n\nT\nT\nxtan,k\n[x\u03c6 (t) \u2212 xnew (t)] dt + \u03b7tan,k\n[\u03b7 \u2212 \u03b7new ] for k = 1, 2.\n\n(A 4)\n\nThis gives for every \u03c6 \u2208 [0, 2\u03c0] a new solution x\u03c6 on the resonance surface. The family\nof new solutions x\u03c6 forms again a topological circle, so that the above procedure can be\nrepeated to 'grow' the resonance surface as a family of topological circles. In practice one\nhas to perform computations only for angles \u03c6 \u2208 [0, 2\u03c0/`], since for any x\u03c6 the solution\nt 7\u2192 x\u03c6 (t \u2212 j/`)mod[0,1] , j = 1 . . . ` \u2212 1, is also a solution.\n\nArticle submitted to Phil. Trans. of the Royal Society\n\n\f"}