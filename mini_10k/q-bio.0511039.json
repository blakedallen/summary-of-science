{"id": "http://arxiv.org/abs/q-bio/0511039v2", "guidislink": true, "updated": "2006-05-12T17:43:31Z", "updated_parsed": [2006, 5, 12, 17, 43, 31, 4, 132, 0], "published": "2005-11-23T18:50:59Z", "published_parsed": [2005, 11, 23, 18, 50, 59, 2, 327, 0], "title": "Evolution on distributive lattices", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=q-bio%2F0401019%2Cq-bio%2F0401024%2Cq-bio%2F0401026%2Cq-bio%2F0401038%2Cq-bio%2F0401003%2Cq-bio%2F0401012%2Cq-bio%2F0401029%2Cq-bio%2F0401042%2Cq-bio%2F0401035%2Cq-bio%2F0401028%2Cq-bio%2F0401013%2Cq-bio%2F0401032%2Cq-bio%2F0401011%2Cq-bio%2F0401006%2Cq-bio%2F0401040%2Cq-bio%2F0401023%2Cq-bio%2F0401007%2Cq-bio%2F0401009%2Cq-bio%2F0401033%2Cq-bio%2F0401022%2Cq-bio%2F0401020%2Cq-bio%2F0401044%2Cq-bio%2F0401025%2Cq-bio%2F0401018%2Cq-bio%2F0401030%2Cq-bio%2F0401039%2Cq-bio%2F0401015%2Cq-bio%2F0401014%2Cq-bio%2F0511040%2Cq-bio%2F0511001%2Cq-bio%2F0511042%2Cq-bio%2F0511031%2Cq-bio%2F0511028%2Cq-bio%2F0511049%2Cq-bio%2F0511035%2Cq-bio%2F0511050%2Cq-bio%2F0511044%2Cq-bio%2F0511020%2Cq-bio%2F0511014%2Cq-bio%2F0511002%2Cq-bio%2F0511051%2Cq-bio%2F0511024%2Cq-bio%2F0511046%2Cq-bio%2F0511027%2Cq-bio%2F0511005%2Cq-bio%2F0511022%2Cq-bio%2F0511017%2Cq-bio%2F0511033%2Cq-bio%2F0511016%2Cq-bio%2F0511021%2Cq-bio%2F0511010%2Cq-bio%2F0511012%2Cq-bio%2F0511029%2Cq-bio%2F0511025%2Cq-bio%2F0511034%2Cq-bio%2F0511009%2Cq-bio%2F0511045%2Cq-bio%2F0511004%2Cq-bio%2F0511048%2Cq-bio%2F0511036%2Cq-bio%2F0511013%2Cq-bio%2F0511032%2Cq-bio%2F0511008%2Cq-bio%2F0511011%2Cq-bio%2F0511047%2Cq-bio%2F0511043%2Cq-bio%2F0511018%2Cq-bio%2F0511039%2Cq-bio%2F0511041%2Cq-bio%2F0511006%2Cq-bio%2F0511019%2Cq-bio%2F0511023%2Cq-bio%2F0511015%2Cq-bio%2F0511026%2Cq-bio%2F0511030%2Cq-bio%2F0511038%2Cq-bio%2F0511037%2Cq-bio%2F0608008%2Cq-bio%2F0608001%2Cq-bio%2F0608013%2Cq-bio%2F0608007%2Cq-bio%2F0608020%2Cq-bio%2F0608027%2Cq-bio%2F0608036%2Cq-bio%2F0608024%2Cq-bio%2F0608022%2Cq-bio%2F0608006%2Cq-bio%2F0608023%2Cq-bio%2F0608010%2Cq-bio%2F0608035%2Cq-bio%2F0608026%2Cq-bio%2F0608038%2Cq-bio%2F0608004%2Cq-bio%2F0608032%2Cq-bio%2F0608021%2Cq-bio%2F0608040%2Cq-bio%2F0608031%2Cq-bio%2F0608030%2Cq-bio%2F0608014%2Cq-bio%2F0608019%2Cq-bio%2F0608018&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Evolution on distributive lattices"}, "summary": "We consider the directed evolution of a population after an intervention that\nhas significantly altered the underlying fitness landscape. We model the space\nof genotypes as a distributive lattice; the fitness landscape is a real-valued\nfunction on that lattice. The risk of escape from intervention, i.e., the\nprobability that the population develops an escape mutant before extinction, is\nencoded in the risk polynomial. Tools from algebraic combinatorics are applied\nto compute the risk polynomial in terms of the fitness landscape. In an\napplication to the development of drug resistance in HIV, we study the risk of\nviral escape from treatment with the protease inhibitors ritonavir and\nindinavir.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=q-bio%2F0401019%2Cq-bio%2F0401024%2Cq-bio%2F0401026%2Cq-bio%2F0401038%2Cq-bio%2F0401003%2Cq-bio%2F0401012%2Cq-bio%2F0401029%2Cq-bio%2F0401042%2Cq-bio%2F0401035%2Cq-bio%2F0401028%2Cq-bio%2F0401013%2Cq-bio%2F0401032%2Cq-bio%2F0401011%2Cq-bio%2F0401006%2Cq-bio%2F0401040%2Cq-bio%2F0401023%2Cq-bio%2F0401007%2Cq-bio%2F0401009%2Cq-bio%2F0401033%2Cq-bio%2F0401022%2Cq-bio%2F0401020%2Cq-bio%2F0401044%2Cq-bio%2F0401025%2Cq-bio%2F0401018%2Cq-bio%2F0401030%2Cq-bio%2F0401039%2Cq-bio%2F0401015%2Cq-bio%2F0401014%2Cq-bio%2F0511040%2Cq-bio%2F0511001%2Cq-bio%2F0511042%2Cq-bio%2F0511031%2Cq-bio%2F0511028%2Cq-bio%2F0511049%2Cq-bio%2F0511035%2Cq-bio%2F0511050%2Cq-bio%2F0511044%2Cq-bio%2F0511020%2Cq-bio%2F0511014%2Cq-bio%2F0511002%2Cq-bio%2F0511051%2Cq-bio%2F0511024%2Cq-bio%2F0511046%2Cq-bio%2F0511027%2Cq-bio%2F0511005%2Cq-bio%2F0511022%2Cq-bio%2F0511017%2Cq-bio%2F0511033%2Cq-bio%2F0511016%2Cq-bio%2F0511021%2Cq-bio%2F0511010%2Cq-bio%2F0511012%2Cq-bio%2F0511029%2Cq-bio%2F0511025%2Cq-bio%2F0511034%2Cq-bio%2F0511009%2Cq-bio%2F0511045%2Cq-bio%2F0511004%2Cq-bio%2F0511048%2Cq-bio%2F0511036%2Cq-bio%2F0511013%2Cq-bio%2F0511032%2Cq-bio%2F0511008%2Cq-bio%2F0511011%2Cq-bio%2F0511047%2Cq-bio%2F0511043%2Cq-bio%2F0511018%2Cq-bio%2F0511039%2Cq-bio%2F0511041%2Cq-bio%2F0511006%2Cq-bio%2F0511019%2Cq-bio%2F0511023%2Cq-bio%2F0511015%2Cq-bio%2F0511026%2Cq-bio%2F0511030%2Cq-bio%2F0511038%2Cq-bio%2F0511037%2Cq-bio%2F0608008%2Cq-bio%2F0608001%2Cq-bio%2F0608013%2Cq-bio%2F0608007%2Cq-bio%2F0608020%2Cq-bio%2F0608027%2Cq-bio%2F0608036%2Cq-bio%2F0608024%2Cq-bio%2F0608022%2Cq-bio%2F0608006%2Cq-bio%2F0608023%2Cq-bio%2F0608010%2Cq-bio%2F0608035%2Cq-bio%2F0608026%2Cq-bio%2F0608038%2Cq-bio%2F0608004%2Cq-bio%2F0608032%2Cq-bio%2F0608021%2Cq-bio%2F0608040%2Cq-bio%2F0608031%2Cq-bio%2F0608030%2Cq-bio%2F0608014%2Cq-bio%2F0608019%2Cq-bio%2F0608018&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We consider the directed evolution of a population after an intervention that\nhas significantly altered the underlying fitness landscape. We model the space\nof genotypes as a distributive lattice; the fitness landscape is a real-valued\nfunction on that lattice. The risk of escape from intervention, i.e., the\nprobability that the population develops an escape mutant before extinction, is\nencoded in the risk polynomial. Tools from algebraic combinatorics are applied\nto compute the risk polynomial in terms of the fitness landscape. In an\napplication to the development of drug resistance in HIV, we study the risk of\nviral escape from treatment with the protease inhibitors ritonavir and\nindinavir."}, "authors": ["Niko Beerenwinkel", "Nicholas Eriksson", "Bernd Sturmfels"], "author_detail": {"name": "Bernd Sturmfels"}, "author": "Bernd Sturmfels", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/j.jtbi.2006.03.013", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/q-bio/0511039v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/q-bio/0511039v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "22 pages, 4 figures; minor corrections, moved details to appendix.\n  Final version to appear in Journal of Theoretical Biology", "arxiv_primary_category": {"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/q-bio/0511039v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/q-bio/0511039v2", "journal_reference": null, "doi": "10.1016/j.jtbi.2006.03.013", "fulltext": "arXiv:q-bio/0511039v2 [q-bio.PE] 12 May 2006\n\nEVOLUTION ON DISTRIBUTIVE LATTICES\nNIKO BEERENWINKEL\u2217 , NICHOLAS ERIKSSON, AND BERND STURMFELS\nDEPARTMENT OF MATHEMATICS\nUNIVERSITY OF CALIFORNIA\nBERKELEY, CA 94720, USA\n{NIKO,ERIKSSON,BERND}@MATH.BERKELEY.EDU\n\u2217\nCORRESPONDING AUTHOR:\nPHONE: +1 (510) 642-3529, FAX: +1 (510) 642-8204\nAbstract. We consider the directed evolution of a population after an\nintervention that has significantly altered the underlying fitness landscape. We model the space of genotypes as a distributive lattice; the\nfitness landscape is a real-valued function on that lattice. The risk of\nescape from intervention, i.e., the probability that the population develops an escape mutant before extinction, is encoded in the risk polynomial. Tools from algebraic combinatorics are applied to compute the risk\npolynomial in terms of the fitness landscape. In an application to the\ndevelopment of drug resistance in HIV, we study the risk of viral escape\nfrom treatment with the protease inhibitors ritonavir and indinavir.\n\nKeywords: fitness landscape, distributive lattice, directed\nevolution, risk polynomial, chain polynomial, HIV drug resistance, Bayesian network, mutagenetic tree\n1. Introduction\nThe evolutionary fate of a population is determined by the replication\ndynamics of the ensemble and by the reproductive success of its individuals.\nWe are interested in scenarios where most individuals have a low fitness,\neventually leading to extinction, and only a few types of individuals (\"escape\nmutants\") can survive permanently. These situations often arise due to\na significant change of the underlying fitness landscape. For example, a\nvirus that has been transmitted to a new host is confronted with a new\nimmune response. Likewise, medical interventions such as radiation therapy,\nvaccination, or chemotherapy result in altered fitness landscapes for the\ntargeted agents, which may be bacteria, viruses, or cancer cells.\nGiven a population and such a hostile fitness landscape, the central question is whether the population will survive. In the case of medical interventions we wish to know the probability of successful treatment. Answering\nthis question involves computing the risk of evolutionary escape, i.e., the\nprobability that the population develops an escape mutant before extinction.\nWe present a mathematical framework for computing such probabilities.\n1\n\n\f2\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n1111\n\n3\n\n4\n\n1101\n\n1110\n\n1100\n\n1\n\n2\n\n1000\n\n0101\n\n0100\n\n0000\n\nFigure 1. An event poset, its genotype lattice, and a fitness landscape.\n\nOur primary application is the evolution of drug resistance during treatment of HIV infected patients [9]. We consider therapy with two different\nprotease inhibitors (PIs). These compounds interfere with HIV particle\nmaturation by inhibiting the viral protease enzyme. The effectiveness of PI\ntherapy is limited by the development of drug resistance. Rapid and highly\nerror prone replication of a large virus population generates mutants that\nresist the selective pressure of drug therapy. PI resistance is caused by mutations in the protease gene that reduce the binding affinity of the drug to\nthe enzyme. These mutations have been shown to accumulate in a stepwise\nmanner [6]. For most PIs, no single mutation confers a significant level of resistance, but multiple mutations are required for escape from drug pressure.\nQuantitative predictions of the probability of successful PI treatment would\nhelp in finding effective antiretroviral combination therapies. Selecting a\ndrug combination amounts to controlling the viral fitness landscape.\nWe regard the directed evolution of a population towards an escape state\nas a fluctuation on a fitness landscape. The space of genotypes is modeled\nas follows. We start with a finite partially ordered set (poset) E whose\nelements are called events. The events are non-reversible mutations with\nsome constraints on their order of occurrence. Such constraints are primarily\ndue to epistatic effects between different loci in a genome [7]. The event\nconstraints define the poset structure: e1 < e2 in E means that event e1\nmust occur before event e2 can occur. Each genotype g is represented by a\nsubset of E, namely, the set of all events that occurred to create g. Thus a\ngenotype g is an order ideal in the poset E. The space of genotypes G is the\nset of all order ideals in E, which is a distributive lattice [25, Sec. 3.4]. The\norder relation on G is set inclusion and corresponds to the accumulation\nof mutations. This mathematical formulation is reasonable in the above\nsituations, where a population is exposed to strong selective pressure.\nThe risk of escape is governed by the structure of G, the fitness function\non G, and the population dynamics (such as the mutation rates and population size). Our focus is on the dependency of the risk of escape on the\nassigned fitness values for each genotype g \u2208 G. This leads us to the risk\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n3\n\npolynomial, which is shown to be equivalent to a well-known object in algebraic combinatorics. Indeed, one of the objectives of this work is to provide\na bridge between algebraic combinatorics and evolutionary biology.\nThis paper is organized as follows. In Section 2 we formalize our model\nof a static fitness landscape on the genotype lattice G derived from an event\nposet E, and we discuss evolution on the lattice G. In Section 3 we review the\nmultistate branching process studied by Iwasa, Michor and Nowak [14, 15].\nIn Section 4 we study the Bayesian networks which arise from identifying\nthe events in E with binary random variables. These statistical models\ncan be used to infer the genotype space from given data. For conjunctive\nBayesian networks we recover the distributive lattice of order ideals in E. Of\nparticular interest is the case where E is a directed forest: here the Bayesian\nnetwork is a mutagenetic tree model [3, 4]. The application of our methods\nto the development of PI resistance in HIV is presented in Section 5.\nThe Appendix summarizes various representations of the risk polynomial\nin terms of structures from algebraic combinatorics. Efficient methods for\ncomputing the risk polynomial and their implementation are presented.\n2. Fitness landscapes on distributive lattices\nA partially ordered set (or poset) is a set E together with a binary relation,\ndenoted \"\u2264\", which is reflexive, antisymmetric, and transitive. Here we fix a\nfinite poset E whose elements are called events. If the number of events is n\nthen we often identify the set underlying E with the set [n] = {1, 2, . . . , n}.\nIn this way, the subsets of E are encoded by the 2n binary strings of length\nn. The empty subset of E is encoded by the all-zero string 0\u0302 = 00 * * * 0 which\nrepresents the wild type, and the full set E is encoded by the all-one string\n1\u0302 = 11 * * * 1 which represents the escape state.\nAn order ideal g in a poset E is a subset of E that is closed downward;\nthat is, if e2 \u2208 g and e1 \u2264 e2 , then e1 \u2208 g. The set of all order ideals of E\nforms a distributive lattice J(E) under inclusion. Birkhoff's Representation\nTheorem [25, Thm. 3.4.1] states that all distributive lattices have the form\nJ(E) for a poset E. We write G = J(E), and we call G the genotype lattice.\nExample 1. Let E be the trivial poset, where no two events are comparable,\nwith |E| = n. Then G = J(E) is the Boolean lattice consisting of all subsets\nof E ordered by inclusion. This means that all possible combinations of\nmutations are possible, and they can occur in any order. Each of the 2n\nbinary strings g \u2208 {0, 1}n represents a mutational pattern, or genotype.\nIn general, the event poset E does have non-trivial relations e1 < e2 . The\nrelation e1 < e2 excludes all genotypes g with ge1 = 0 and ge2 = 1 from G.\nThe remaining genotypes g form a sublattice of the Boolean lattice {0, 1}n ,\nand this is precisely our distributive lattice G = J(E). Note that the lattice\nG is ranked, with the rank function given by rank(g) = |g|.\n\n\f4\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\nExample 2. Consider a scenario with n = 4 mutation events, labeled E =\n{1, 2, 3, 4}. Suppose that event 3 can only occur after events 1 and 2, and\nevent 4 can only occur after event 2. This allows for precisely eight genotypes\n\b\nG = 0000, 1000, 0100, 1100, 0101, 1110, 1101, 1111 .\nThe event poset E and the genotype lattice G are shown in Figure 1.\n\nA fitness landscape associates to each possible genotype a number which\nquantifies the reproductive capacity of an individual with that genotype [21].\nWe define a fitness landscape on the distributive lattice G to be any function\nf : G \u2192 R. The value f (g) at any g \u2208 G is the fitness of the genotype\ng. Thus, the space of all fitness landscapes is the finite-dimensional vector\nspace RG .\nWe shall consider certain special models of fitness landscapes, which are\nrepresented by linear subspaces of RG . In the following definitions, a genotype g is regarded as a subset of the event poset E, where |E| = n. A\nconstant fitness landscape has the form f (g) \u2261 a for some constant a. Thus\nthe constant landscapes form a line through the origin in RG . A graded fitness landscape is a landscape on G whose fitness values depend only on the\nrank. Equivalently, we have f (g) = a|g| for constants a0 , a1 , . . . , an . Thus,\ngraded fitness landscapes form an (n + 1)-dimensional linear subspace of RG .\nOur biological application in Section 5 uses the graded fitness landscape\nmodel, which means that the fitness of a virus type depends only on the\nnumber of mutations it harbors. We shall model situations where a virus\nescapes from a wild type 0\u0302 to a drug-resistant type 1\u0302. In this case, we assume\na graded fitness landscape that is monotonically increasing with rank, i.e.,\na0 < a1 < a2 < * * * < an .\nThis implies that the fitness landscape f has a unique local (and global)\nmaximum at the drug resistant type 1\u0302, which is the top element in G.\nWe next introduce the mathematical framework for evolution on a fitness\nlandscape. The general setup is as in the work of Reidys and Stadler [21],\nbut this is adapted here to our specific situation, where the genotypes form\na distributive lattice G. The order relation on G, which comes from inclusion\nof subsets of E, induces a neighborhood structure on G where the neighbors\nof g \u2208 G are the genotypes that strictly contain g,\n\b\n(1)\nN (g) := h \u2208 G | g \u2282 h .\n\nUnlike the typical situation considered in [21], this notion of neighborhood\nis not symmetric. To be precise, we have that h \u2208 N (g) implies g 6\u2208 N (h).\nThis neighborhood structure implies that mutational changes are possible\nonly upward in the genotype lattice. This structure models a directed evolutionary process from the wild type 0\u0302 towards the escape state 1\u0302. Typically,\nour configuration space G is a small subset of the Boolean lattice {0, 1}n of\nall binary strings. Indeed, in the course of viral evolution, a population will\nvisit only a small fraction of {0, 1}n , as most mutants are not viable.\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n5\n\nSuppose that the number of genotypes in G is m. We wish to define\ndynamics between the states of G. To this end, we fix a linear extension of\nG, and we introduce an m \u00d7 m matrix of transition rates, written U = (ugh ),\nwhose rows and columns are indexed by genotypes g, h \u2208 G. Each entry ugh\nof the matrix U is a non-negative real number which is zero unless h \u2208 N (g).\nIn the framework of algebraic combinatorics, it is convenient to think of the\nmatrix U as an element in the incidence algebra of G; see [25, Sec. 3.6].\nWe further assume that the non-zero mutation rates ugh depend only on\nthe events in h\\g. Equivalently, the rate at which a collection of mutation\nevents occurs is independent of which other mutations have already occurred.\nWith this assumption, there are only n free parameters \u03bc1 , . . . , \u03bcn in the\nmatrix U, where \u03bce is the mutation rate of event e. Then\n( Q\ne\u2208h\\g \u03bce if g \u2282 h\n(2)\nugh =\n0\notherwise.\nIn particular, if all rates are the same, say \u03bc = \u03bc1 = * * * = \u03bcn , then the\nentries of U are ugh = \u03bc|h\\g| if g \u2282 h and ugh = 0 otherwise.\nExample 3. For the genotype lattice G in Figure 1, the matrix U equals\n0000 1000 0100 1100\n\uf8eb\n0000\n0\n\u03bc1\n\u03bc2 \u03bc1 \u03bc2\n1000 \uf8ec\n0\n0\n0\n\u03bc2\n\uf8ec\n\uf8ec\n0100 \uf8ec 0\n0\n0\n\u03bc1\n1100 \uf8ec\n0\n0\n0\n0\n\uf8ec\n0101 \uf8ec\n0\n0\n0\n0\n\uf8ec\n1110 \uf8ec\n0\n0\n0\n0\n\uf8ec\n\uf8ed\n1101\n0\n0\n0\n0\n1111\n0\n0\n0\n0\n\n0101 1110\n1101\n1111\n\uf8f6\n\u03bc2 \u03bc4 \u03bc1 \u03bc2 \u03bc3 \u03bc1 \u03bc2 \u03bc4 \u03bc1 \u03bc2 \u03bc3 \u03bc4\n0\n\u03bc2 \u03bc3\n\u03bc2 \u03bc4\n\u03bc2 \u03bc3 \u03bc4 \uf8f7\n\uf8f7\n\u03bc4\n\u03bc1 \u03bc3\n\u03bc1 \u03bc4\n\u03bc1 \u03bc3 \u03bc4 \uf8f7\n\uf8f7\n0\n\u03bc3\n\u03bc4\n\u03bc3 \u03bc4 \uf8f7\n\uf8f7\n0\n0\n\u03bc1\n\u03bc1 \u03bc3 \uf8f7\n\uf8f7\n\uf8f7\n0\n0\n0\n\u03bc4\n\uf8f7\n\uf8f8\n0\n0\n0\n\u03bc3\n0\n0\n0\n0\n\nNote that the entry in row g and column h of any power Uk equals ugh times\nthe number of paths of length k from g to h in G. In particular, U5 = 0.\n\u0001\nLet f be a fitness landscape on G and F = diag f (g) | g \u2208 G the m \u00d7 m\ndiagonal matrix whose entries are the fitness values. The entry of the matrix\nproduct UF in row g and column h represents the probability of genotype g\ntransitioning into genotype h in one step. A precise probabilistic derivation\nand interpretation will be given in the next section.\nWe are interested in all mutational pathways that lead from the wild type\n0\u0302 to the escape state 1\u0302. Towards this end, note that the entry (g, h) of the\nmatrix (UF)k represents the probability of genotype g evolving to genotype\nh along any mutational pathway (chain) of length k in the genotype lattice\nG. The chains from 0\u0302 to 1\u0302 in G are accounted for by the upper right hand\nentry of (UF)k . Note that the matrix (UF)k is zero for k > n.\nTo account for chains of arbitrary length, we consider the matrix\n(3)\n\n(I \u2212 UF)\u22121 \u2212 I = UF + (UF)2 + (UF)3 + * * * + (UF)n ,\n\n\f6\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\nwhere I is the m \u00d7 m identity matrix. We summarize our discussion in the\nfollowing proposition, which is proved by elementary matrix algebra.\nProposition 4. The entry of the matrix (3) in row g and column h is zero\nunless g \u2282 h, in which case it is ugh * f (h) * Pgh (f ) where Pgh is a polynomial\nfunction of degree |h\\g| \u2212 1 on the space of all fitness landscapes RG .\nThe polynomial Pgh (f ) is the generating function for all chains from g\nto h in G. This will be made precise in the following corollary. We shall\nrestrict ourselves to the most important case when g = 0\u0302 is the wild type\nand h = 1\u0302 is the escape state. Studying P0\u03021\u0302 (f ) only is no loss of generality\nbecause any interval of a distributive lattice is again a distributive lattice.\nProposition 4 tells us that P0\u03021\u0302 (f ) is a polynomial of degree n \u2212 1 in the\nunknown fitness values f (g), which are also written as fg , where g \u2208 G.\nCorollary 5. The polynomial P0\u03021\u0302 (f ) in the upper-right entry of (3) equals\n(4)\n\nP0\u03021\u0302 (f )\n\n=\n\nX\n\nfg1 fg2 * * * fgk\u22121 ,\n\n0\u0302=g0 \u2282g1 \u2282***\u2282gk =1\u0302\n\nwhere the sum runs over all chains from 0\u0302 to 1\u0302 in the genotype lattice G.\n3. The risk of escape\nFor a poset of events E and the corresponding distributive lattice G =\nJ(E), the risk polynomial of G is defined as the polynomial (4), which we\ndenote by R(G; f ). The risk polynomial was introduced in [14, 15]. In\nthis section we review the evolutionary dynamics model proposed in these\npapers, and we discuss the probabilistic meaning of the risk polynomial.\nExample 6. Let G be the genotype lattice in Figure 1. Then the risk polynomial R(G; f ) is the following polynomial of degree three in six unknowns:\n1 + f1000 + f0100 + f1100 + f0101 + f1110 + f1101\n+f1000 f1100 + f0100 f1100 + f0100 f0101 + f1000 f1110 + f0100 f1110\n+f1000 f1101 + f0100 f1101 + f1100 f1110 + f1100 f1101 + f0101 f1101\n+f1000 f1100 f1110 + f0100 f1100 f1110 + f1000 f1100 f1101\n+f0100 f1100 f1101 + f0100 f0101 f1101 .\nIf we restrict the fitness landscape f to lie in a linear subspace of RG , then\nR(G; f ) specializes to a polynomial in fewer unknowns. For example, the risk\npolynomial for graded fitness landscapes is obtained from the specialization\nf (g) = a|g| . That risk polynomial has degree n \u2212 1 and is denoted by\nR(G; a1 , . . . , an\u22121 ). For instance, R(G; f ) in Example 6 specializes to\nR(G; a1 , a2 , a3 ) = 1 + 2a1 + 2a2 + 2a3 + 3a1 a2 + 4a1 a3 + 3a2 a3 + 5a1 a2 a3 .\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n7\n\nFor constant fitness landscapes f \u2261 a , the risk polynomial is a polynomial\nin one unknown a. It is denoted R(G; a). In our running example,\nR(G; a) = 1 + 6a + 10a2 + 5a3 .\nWe now make precise the notion of risk of escape, which will justify our\ndefinition of the risk polynomial. Our derivation is based on the model for\nthe dynamics of a replicating population on a fitness landscape studied by\nIwasa, Michor and Nowak [14, 15]. See also the work of Wilke [29] and the\nreferences given therein for approaches to computing fixation probabilities.\nA multistate branching process [1] consists of a set of genotypes along\nwith a fitness landscape and mutation rates between genotypes. We assume\na discrete time process, where in one generation an individual with genotype\ng has a random number of offspring following a Poisson distribution with\nmean Rg . Some of these offspring may be mutants according to the mutation\nrates ugh . The parameter Rg is the basic reproductive ratio [19, Chap. 3].\nWe assume there is no interaction between individuals; each reproduces\nat a rate independent of the distribution of the population. Let \u03c1kg,h be the\nprobability that one individual of genotype g has k children of type h. Then,\n\u03c1kg,h =\n\n(5)\n\n(ugh Rg )k * e\u2212ugh Rg\n.\nk!\n\nThe reproductive fitness fg is related to the reproductive ratio Rg by\n(6)\n\nfg =\n\nRg\n1 \u2212 Rg\n\nand\n\nRg =\n\nfg\n.\n1 + fg\n\nLet \u03beg be the probability of escape starting with one individual of genotype\ng, so 1\u2212\u03beg is the probability of extinction. In particular, \u03be1\u0302 is the probability\nthat one resistant virus will not become extinct. Each of these probabilities\nis a function of the mutation rates ugh and the reproductive ratios Rg . We\nassume that the ugh are as in (2), but with ugg = 1. Thus, each escape\nprobability \u03beg can be expressed as a function of the \u03bce for e \u2208 E and (using\nthe relation (6)) the fitness values fg for g \u2208 G.\nTheorem 7. If \u03beg \u226a 1 for g 6= 1\u0302, then the probability of escape on the\nfitness landscape f \u2208 RG starting with one individual of wild type 0\u0302, satisfies\n(7)\n\n\u03be0\u0302\n\n\u2248\n\n\u03be1\u0302 * f0\u0302 *\n\nY\n\n\u03bce * R(G; f ).\n\ne\u2208E\n\nProof. The probability of extinction satisfies the recursive formula\n(8)\n\n1 \u2212 \u03beg\n\n=\n\n\u221e\nYX\n(1 \u2212 \u03beh )k * \u03c1kg,h .\n\nh\u2287g k=0\n\n\f8\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nFigure 2. Example of an event poset whose general risk\npolynomial is of degree 11 in 375 unknowns.\nUsing (5), the right hand side of (8) can be rewritten as follows:\n\uf8eb\n\uf8f6\nX\nY\n\u2212\u03beh ugh Rg \uf8f8 .\nexp((1 \u2212 \u03beh )ugh Rg ) * exp(\u2212ugh Rg ) = exp \uf8ed\nh\u2287g\n\nh\u2287g\n\nWe conclude that\n\nlog(1 \u2212 \u03beg )\n\n=\n\n\u2212\n\nX\n\n\u03beh ugh Rg\n\nfor all g \u2208 G.\n\nh\u2287g\n\nUnder the assumption that \u03beg \u226a 1 for g 6= 1\u0302, we can linearize the logarithms\nusing the relation log(1 \u2212 \u03beg ) \u2248 \u2212\u03beg . This implies, for g \u2208 G\\{1\u0302},\nP\n\u03beg \u2248\nRg * h\u2287g \u03beh ugh\nP\nR\n= 1\u2212Rggugg * h\u2283g \u03beh ugh\nP\n=\nfg * h\u2283g \u03beh ugh .\n\nThe theorem now follows by setting g = 0\u0302 and expanding the last equation\nrecursively. Here we are using the fact from (2) that the product of the ugh\nQ\nover any chain from 0\u0302 to 1\u0302 in G equals e\u2208E \u03bce .\n\u0003\n\nThe typical situation of interest is a fitness landscape for which only the\nescape state has a basic reproductive ratio greater than one, i.e.,\nR1\u0302 > 1\n\nand\n\nRg < 1\n\nfor all\n\ng 6= 1\u0302.\n\nWhen the positive numbers Rg are very small for g \u2208 G\\{1\u0302} then the approximation (7) is valid, and it shows the crucial role that the risk polynomial\nR(G; f ) plays in assessing the risk of escape from the wild type 0\u0302 to the\nescape state 1\u0302. The theorem implies that the risk of escape of a population\nof N wild type viruses is (1 \u2212 \u03be0\u0302 )N . In Section 6 we discuss the situation in\nwhich the population is not homogeneous at the time of intervention.\nThe risk of escape is an important quantity in analyzing the invasiveness\nof pathogens and in assessing the success probability of medical interventions\nsuch as chemotherapy. However, putting this concept into practice depends\non our ability to actually compute the risk polynomial. It turns out that\nmethods from algebraic combinatorics lead to efficient algorithms for this\ntask. In the Appendix, several methods are presented in detail.\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n9\n\nOur method of choice from a practical perspective relies on computing linear extensions of the event poset E (Theorem 15, Appendix). Our software\nimplementation is available at http://bio.math.berkeley.edu/riskpoly/\n. For an example of the efficiency of the software, let E be the poset in Figure 2 on n = 12 events with cover relations i < 6 + i for 1 \u2264 i \u2264 6 and\ni < 7+i for 1 \u2264 i \u2264 5. Here the genotype lattice G consists of 375 genotypes.\nThe risk polynomial R(G; f ) is a polynomial of degree 11 in 375 unknowns\nfg . This polynomial has 224,750,298 monomials in the 375 unknowns, but\nwe represent it as a sum of 2,702,765 products, one for each linear extension\nof the event poset E. Our software takes about ten seconds to compute this\nrepresentation of R(G; f ). The result takes up 200MB of disk space.\nThe univariate risk polynomial for this example is\n1 + 375a + 19088a2 + 324498a3 + 2610169a4 + 11729394a5 + 32080336a6 +\n55597909a7 + 61448965a8 + 42020208a9 + 16216590a10 + 2702765a11 .\nThus, exact symbolic computations, as opposed to numerical approximations, may be necessary and feasible when one is interested in assessing the\nrisk of escape in applications like the one described in Section 5 below.\n4. Distributive lattices from Bayesian networks\nIn this section, we present a family of statistical models that naturally\ngives rise to distributive lattices. This statistical interpretation provides a\nmethod for deriving the genotype lattice G directly from data. The basic\nidea is to estimate the poset structure on E from observed genotypes, by\napplying model selection techniques to a range of Bayesian networks, and to\ndefine G as the set of all genotypes with non-zero probability in the model.\nWe first make precise the derivation of a genotype space from a statistical model. Let E be an unordered set of n genetic events. The events\nare labeled by 1, 2, . . . , n. Subsets of E are identified with binary strings\ng \u2208 {0, 1}n . They are the possible genotypes. We consider binary random\nvariables XE = (X1 , . . . , Xn ), where Xe = 1 indicates the occurrence of event\ne. Let \u2206 denote the (2n \u22121)-dimensional simplex of probability distributions\non {0, 1}n . A statistical model for XE is a map p : \u0398 \u2192 \u2206, where \u0398 is some\nparameter space. The g-th coordinate of p, denoted pg , is the probability of\ngenotype g \u2208 {0, 1}n under the model p. The induced genotype space of the\nmodel p : \u0398 \u2192 \u2206 is the set Gp of all strings g \u2208 {0, 1}n such that pg is not\nthe zero function on \u0398. We regard Gp as a poset ordered by inclusion.\nNow consider a directed acyclic graph on the set of events E. We will also\ncall this graph E. The Bayesian network model, or directed acyclic graphical\nmodel, defined by E is the family of joint distributions that factor as\nY\nPr(X1 , . . . , Xn ) =\nPr(Xe | Xpa(e) ),\ne\u2208E\n\n\f10\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\nwhere pa(e) denotes the set of parents of e in E. Equivalently, a Bayesian network is specified by a set of conditional independence statements. Each node\nis independent of its ancestors given its parents. See [16] for an introduction\nto the relevant statistical theory and [13] for an algebraic perspective.\nThe parameters for a Bayesian network are specified by providing, for\neach event e \u2208 E, a 2|pa(e)| \u00d7 2 matrix \u03b8 e . The matrix entries are\n\u0001\n\u03b8gepa(e) ,ge = Pr Xe = ge | Xpa(e) = gpa(e) ,\n\nfor gpa(e) \u2208 {0, 1}pa(e) , ge \u2208 {0, 1}. These conditional probabilities satisfy\n\n\u03b8gepa(e) ,0 \u2265 0 , \u03b8gepa(e) ,1 \u2265 0 and \u03b8gepa(e) ,0 + \u03b8gepa(e) ,1 = 1.\nP\n|pa(e)| and \u0398 = [0, 1]d . The points in the cube \u0398 are\nSet d =\ne\u2208E 2\nidentified with n-tuples of matrices \u03b8 = (\u03b8 e | e \u2208 E) as above. The general\nBayesian network is the polynomial map p : \u0398 \u2192 \u2206 whose coordinates are\n(9)\n\n(10)\n\npg (\u03b8) =\n\nY\n\n\u03b8gepa(e) ,ge .\n\ne\u2208E\n\nThe general Bayesian network on E induces the genotype space Gp = {0, 1}n ,\nthe Boolean lattice on E. Indeed, the factorization (10) implies that no\ngenotype g \u2208 {0, 1}n has probability zero for all parameter values.\nTo obtain other genotype spaces, we replace the cube \u0398 = [0, 1]d by one\nof its faces, as follows. For each event e \u2208 E consider a Boolean function\n\u03b2e : {0, 1}pa(e) \u2192 {0, 1}. If \u03b2e (ge ) = 0 then the row of the 2|pa(e)| \u00d7 2-matrix\n\u03b8 e indexed by the genotype g is fixed to be the vector (1, 0); otherwise that\nrow remains indeterminate subject to the constraints (9). Let \u0398\u03b2 denote the\nface of \u0398 determined by these requirements and p\u03b2 : \u0398\u03b2 \u2192 \u2206 the restriction\nof the polynomial map p to \u0398\u03b2 . The resulting model is the Bayesian network\non E constrained by the Boolean functions \u03b2 e .\nIf all Boolean functions \u03b2 e are disjunctions then we get the disjunctive\nBayesian network on E. In this model, an event e can only occur if at least\none of its parent events has already occurred. If all Boolean functions \u03b2 e\nare conjunctions then we get the conjunctive Bayesian network on E. In\nthis model, an event e can only occur if all of its parent events have already\noccurred. These restricted Bayesian network models induce interesting genotype spaces. Our main result in this section concerns the conjunctive case.\nWe regard the given directed acyclic graph E as a poset by setting e1 \u2264 e2\nif there exists a path from e1 to e2 . We write pconj : [0, 1]n \u2192 \u2206 for the\nconjunctive Bayesian network on E, since it has precisely n free parameters.\nTheorem 8. The genotype space induced by the conjunctive Bayesian network on E is the distributive lattice of order ideals in E, i.e., Gpconj = J(E).\nProof. The possible genotypes g are binary strings whose coordinates ge\nindicate whether or not the event e has occurred. If p is any of the Bayesian\nnetwork models discussed above, then (10) implies that g \u2208 Gp if and only\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n11\n\nif each \u03b8gepa(e) ,ge is non-zero. Consider now the conjunctive model p = pconj .\nHere, the conditional probability \u03b8gepa(e) ,ge is non-zero if and only if ge = 1\nimplies gpa(e) = (1, . . . , 1). This is precisely the condition for g to be an\norder ideal in E. Thus Gp is the distributive lattice of order ideals of E. \u0003\nThe following example illustrates Theorem 8, and it compares the genotype spaces induced by the disjunctive and the conjunctive Bayesian network. The former is not a distributive lattice, but the latter always is.\nExample 9. Let E be the event poset in Figure 1. The general Bayesian\nnetwork model defined by E is parametrized by the following four matrices:\n\uf8eb\n\uf8f6\n\u0001\nc00 1 \u2212 c00\n\u0012\n\u0013\n1\n\u03b8 = a 1\u2212a ,\n\uf8ec c01 1 \u2212 c01 \uf8f7\nd0 1 \u2212 d0\n3\n4\n\uf8ec\n\uf8f7\n\u03b8 =\uf8ed\n, \u03b8 =\n.\n\u0001\nc10 1 \u2212 c10 \uf8f8\nd1 1 \u2212 d1\n\u03b82 = b 1 \u2212 b ,\nc11 1 \u2212 c11\nThe map p : [0, 1]8 \u2192 \u2206 has coordinates\np0000 = abc00 d0 ,\np0010 = ab(1 \u2212 c00 )d0 ,\np0100 = a(1 \u2212 b)c01 d1 ,\np0110 = a(1 \u2212 b)(1 \u2212 c01 )d1 ,\np1000 = (1 \u2212 a)bc10 d0 ,\np1010 = (1 \u2212 a)b(1 \u2212 c10 )d0 ,\np1100 = (1 \u2212 a)(1 \u2212 b)c11 d1 ,\np1110 = (1 \u2212 a)(1 \u2212 b)(1 \u2212 c11 )d1 ,\n\np0001\np0011\np0101\np0111\np1001\np1011\np1101\np1111\n\n=\n=\n=\n=\n=\n=\n=\n=\n\nabc00 (1 \u2212 d0 ),\nab(1 \u2212 c00 )(1 \u2212 d0 ),\na(1 \u2212 b)c01 (1 \u2212 d1 ),\na(1 \u2212 b)(1 \u2212 c01 )(1 \u2212 d1 ),\n(1 \u2212 a)bc10 (1 \u2212 d0 ),\n(1 \u2212 a)b(1 \u2212 c10 )(1 \u2212 d0 ),\n(1 \u2212 a)(1 \u2212 b)c11 (1 \u2212 d1 ),\n(1\u2212a)(1\u2212b)(1\u2212c11 )(1\u2212d1 ).\n\nThis model induces the Boolean lattice {0, 1}4 as genotype space.\nThe disjunctive Bayesian network is the six-dimensional submodel obtained by setting c00 = 1 and d0 = 1. This substitution implies\np0001 = p0010 = p0011 = p1001 = p1011 = 0.\nThe genotype space Gpdisj consists of the remaining eleven strings in {0, 1}4 .\nNote that Gpdisj is not a lattice because it is not closed under intersections.\nFor instance, 1010 and 0110 are in Gpdisj but 0010 = 1010 \u2229 0110 6\u2208 Gpdisj .\nThe conjunctive Bayesian network is the four-dimensional submodel obtained by setting c00 = c01 = c10 = d0 = 1. The remaining eight non-zero\nprobabilities are indexed by the eight genotypes in Figure 1:\np0000 = ab ,\np0101 = a(1 \u2212 b)(1 \u2212 d1 ) ,\np1100 = (1 \u2212 a)(1 \u2212 b)c11 d1 ,\np1110 = (1 \u2212 a)(1 \u2212 b)(1 \u2212 c11 )d1 ,\n\np0100\np1000\np1101\np1111\n\n=\n=\n=\n=\n\na(1 \u2212 b)d1 ,\n(1 \u2212 a)b ,\n(1 \u2212 a)(1 \u2212 b)c11 (1 \u2212 d1 ) ,\n(1\u2212a)(1\u2212b)(1\u2212c11 )(1\u2212d1 ).\n\nIf E is a directed forest, i.e., if every e \u2208 E has at most one parent, then\nwe can augment E to a tree E T by adding an auxiliary root node 0 which\n\n\f12\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\npoints to the roots (edges with no parents) of the forest. On the resulting\ntree E T we consider the mutagenetic tree model of [4, 11].\nProposition 10. If E is a directed forest then the following three statistical\nmodels coincide: the disjunctive Bayesian network on E, the conjunctive\nBayesian network on E, and the mutagenetic tree model on E T .\nProof. The disjunctive and the conjunctive networks coincide because they\nare defined by the same specializations of the parameters \u03b8 e . The identification with the mutagenetic tree model follows from [3, Thm. 14.6].\n\u0003\nMutagenetic tree models can be learned from observed data by an efficient\ncombinatorial algorithm. With appropriate edge weights that depend on the\npairwise probabilities of events, a mutagenetic tree can be obtained as the\nmaximum weight branching rooted at 0 in the complete graph on {0, . . . , n};\nsee [11]. This gives an efficient method for learning the poset E, and hence\nthe genotype lattice G = J(E), from data. It would be interesting to extend\nthis model selection technique to arbitrary conjunctive Bayesian networks.\n5. Applications to HIV drug resistance\nWe investigate the development of resistance during treatment of HIV\ninfected patients with two different PIs. Consider the seven genetic events\nE = {K20R, M36I, M46I, I54V, A71V, V82A, I84V} ,\nwhere K20R stands for the amino acid change from lysine (K) to arginine (R)\nat position 20 of the protease chain, etc. The occurrence of these mutations\nconfers broad cross-resistance to the entire class of PIs. Appearance of the\nvirus with all 7 mutations renders most of the PIs ineffective for subsequent\ntreatment. We analyze the risk of reaching this escape state under therapy\nwith the PIs ritonavir (RTV) and indinavir (IDV) [10, 18].\nWe use mutagenetic trees for estimating preferred mutational pathways\nand for defining genotype lattices. For both drugs, a tree E T is learned from\ngenotypes derived from patients under the respective therapy. We used 112\nand 691 samples from the Stanford HIV Drug Resistance Database [22] for\nritonavir and indinavir, respectively. Figure 3 shows the inferred mutagenetic trees. The models indicate that the evolution of ritonavir resistance\nis partly a linear process, whereas indinavir resistance develops in a less\nordered fashion. This is consistent with previous studies [10, 18]. The genotype lattices G have size 16 for ritonavir and 45 for indinavir. We study the\nrisk polynomials on these lattices under different fitness landscape models.\nFor the constant fitness landscape on G\\{0\u0302, 1\u0302}, we obtain\nRRTV (a) = 15a6 + 70a5 + 131a4 + 124a3 + 61a2 + 14a + 1,\nRIDV (a) = 420a6 + 1470a5 + 1970a4 + 1250a3 + 372a2 + 43a + 1.\nThus, the risk of developing all seven PI resistance mutations is higher under\nindinavir therapy than under ritonavir: RIDV (a) > RRTV (a) for a > 0.\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n13\n\nM36I\nK20R\nI84V\n\nA71V\n\nM46I\n\nI54V\n\nV82A\n\nK20R\nM36I\n\nI54V\n\nA71V\n\nV82A\n\n0\n\n0\n\n(a)\n\n(b)\n\nI84V\nM46I\n\nFigure 3. Mutagenetic tree E T for the development of resistance to (a) ritonavir and (b) indinavir in the HIV-1 protease.\nThe event poset E is obtained by removing the root node \"0\".\nIntuitively, the risk under ritonavir is lower because the mutations must\noccur in a certain order. Likewise, the high risk under indinavir results\nfrom many mutations occurring independently, which gives rise to a large\ngenotype lattice and to many mutational pathways from the wild type to\nthe escape state.\nMore realistic fitness landscapes may be derived by modeling viral fitness\nas a function of drug concentration. We follow the approach pursued in [26]\nand use a simple saturation function for this dependency. Specifically, we\nassume viral fitness to be the following function of drug concentration D,\n(11)\n\nfg (D)\n\n=\n\n\u03c6g\n,\n1 + D/rg\n\nwhere \u03c6g denotes the fitness of genotype g in the absence of drug and rg\nthe IC50 value of g, i.e., the drug concentration necessary to inhibit viral\nreplication in vitro by 50%. The IC50 value is a measure of resistance. We\nwill assume throughout that all \u03c6g \u2261 \u03c6 are equal. If we assume, in addition,\nthat the resistance landscape is constant on G\\{0\u0302, 1\u0302}, with rg \u2261 r, then the\nsubstitution (11) turns the risk polynomial into a rational function in \u03c6, D,\nand r. For example, for ritonavir, this rational function is\n(15\u03c62 r 2 + 10\u03c6Dr + 10\u03c6r 2 + D 2 + 2Dr + r 2 )(\u03c6r + D + r)4\n.\n(D + r)6\nIn general, the IC50 values rg are distinct and can be determined experimentally for some genotypes by phenotypic resistance testing [28], and may\nbe predicted for all genotypes using regression techniques [2]. PI phenotypic resistance data suggests a graded resistance landscape; see [6] and [10,\n\n\fBEERENWINKEL, ERIKSSON, AND STURMFELS\n\n1 e\u221201\n\nRTV\nIDV\n\n1 e\u221203\n\nresistance, IC50 [mug/ml]\n\n1 e+01\n\n14\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\nrank (number of mutations)\n\nFigure 4. Graded resistance landscapes for ritonavir (RTV,\nbullets) and indinavir (IDV, squares). Resistance is quantified as the drug concentration necessary to inhibit viral replication in vitro by 50% (IC50 ).\n\nTab. 3]. Hence, we estimate the resistance r \u2208 R8 for ritonavir and indinavir\nby defining rk as the mean predicted IC50 of all genotypes of rank k. The\nresulting resistance landscapes are shown in Figure 4.\nThe graded risk polynomials R(a1 , a2 , a3 , a4 , a5 , a6 ) have 64 terms. After\nsubstituting ak = \u03c6/(1 + D/rk ), we obtain rational risk functions in D\nwith parameter \u03c6. Figure 5 illustrates the dependency of the risk on drug\nconcentration for three different values of \u03c6. For both drugs we indicate\npublished mean plasma trough (Cmin ) and peak (Cmax ) levels observed in\nclinical settings.\nThis example illustrates how the risk polynomial can be used to study\nviral escape as a function of different parameters. For instance, given a\npharmacokinetics model of antiretroviral drug therapy, we can compute the\nrisk of developing resistance after a patient has missed a dose. Thus, our\nmathematical framework may help in designing robust drug combinations.\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n3.5\n\n(b)\n\n3.5\n\n(a)\n\n1.5\n\n2.0\n\n2.5\n\n3.0\n\nphi = 0.9\nphi = 0.5\nphi = 0.1\n\n0.5\n0.0\n\n0.0\n\n0.5\n\n1.0\n\n1.5\n\n2.0\n\nlog10 risk\n\n2.5\n\n3.0\n\nphi = 0.9\nphi = 0.5\nphi = 0.1\n\n1.0\n\nlog10 risk\n\n15\n\n1 e\u221202\n\n1 e\u221201\n\n1 e+00\n\n1 e+01\n\n1 e+02\n\n1 e\u221202\n\ndrug concentration [mug/ml]\n\n1 e\u221201\n\n1 e+00\n\n1 e+01\n\n1 e+02\n\ndrug concentration [mug/ml]\n\nFigure 5. Drug dependent risk. The log of the risk polynomial for ritonavir (a) and indinavir (b) is displayed as a\nfunction of plasma drug concentration D. Marked values denote mean trough (Cmin ) and peak (Cmax ) levels observed in\nclinical studies. The parameter \u03c6 is the relative fitness of\nmutants as compared to the wild type in the absence of drug.\n\n6. Discussion\nWe have presented a computational framework for assessing the risk of\nescape of an evolving population of pathogens. The risk of escape is the\nprobability that the population reaches an escape state before extinction. In\nvirus transmissions, for example, this probability is the chance of survival in\nthe new host. In the situation of antiretroviral therapy, the risk of escape is\nthe probability of therapy failure due to the development of drug resistance.\nThe general setup we consider for computing the risk of escape includes\nan event poset, a fitness landscape on its induced genotype lattice, and a\nbranching process on this lattice. The event poset E consists of all mutational events that can occur and encodes the constraints which apply to their\norder of occurrence. From this structure the genotype space G is obtained\nby considering all mutational pathways that respect the order constraints.\nThis natural construction endows G with the mathematical structure of a\ndistributive lattice. The risk polynomial, the crucial factor in computing\nthe risk of escape, turns out to coincide with the chain polynomial of the\ngenotype lattice. We have presented methods from algebraic combinatorics\nthat exploit this connection and that result in efficient algorithms.\nThe space of genotypes may also be inferred from observed genotype data\nusing statistical model selection tools. We have identified a class of Bayesian\nnetwork models, the conjunctive Bayesian networks, whose support induces\na genotype lattice. Mutagenetic tree models arise as important special cases.\n\n\f16\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\nHere, both statistical model selection and risk computation are particularly\nefficient, and readily available with existing software [5] coupled with our\nimplementation of the linear extensions method (Theorem 15, Appendix).\nWe have focused on the dependency of the risk polynomial on the fitness\nlandscape and considered throughout a homogeneous wild type population\nprior to intervention. However, the risk of escape is calculated similarly\nfor a quasispecies distribution at the time of intervention. In fact, this\ninvolves computing the risk polynomial of the prior fitness landscape [14].\nIn contrast, the branching process model can not account for recombination,\nhorizontal gene transfer, or frequency dependent selection, since evolution\nis assumed to take place in multiple lineages independently.\nThe main challenge in using our method to compute the risk of escape\nfrom antiretroviral therapy lies in accurately modeling the fitness landscape.\nThe dependency (11) of the fitness on drug concentration may be improved\nby experimentally determined viral replicative capacities in the absence of\ndrugs. An alternative approach to derive a fitness landscape for HIV-1 proteases is based on estimating the binding affinity of the drug to the mutant\nprotease, and the mutant's ability to cleave its natural substrates [23]. These\ncalculations are based on simplified molecular modeling techniques. The resulting fitness landscape does not account for different drug levels, but it is\nindependent of experimental resistance and fitness data.\nEscape from indinavir and ritonavir therapy may in some cases involve\nmutations other than the seven we considered, although those are the most\nfrequent mutations observed after therapy failure [10, 18]. On the other\nhand, viral escape might be accomplished with genotypes that harbor fewer\nthan all of the mutations. Thus it would be desirable to compute the risk of\nreaching any of several escape states, rather than only the 11 * * * 1 type. This\ncomputation will involve similar techniques to those presented in Section 3\nand the Appendix.\nFinally, the PIs form only one out of four distinct classes of antiretroviral\ndrugs that are in current clinical use. The standard of care is combination\ntherapy with at least three different drugs from two different drug classes.\nModeling the fitness landscape of combination therapy in terms of viral drug\nresistance and drug exposure is even more challenging, but can eventually\nhelp in designing optimal antiretroviral therapies. Algebraic combinatorics\noffers tools for the mathematical analysis of these biomedical problems.\nAcknowledgements\nNiko Beerenwinkel is supported by Deutsche Forschungsgemeinschaft under grant No. BE 3217/1-1. Nicholas Eriksson and Bernd Sturmfels are\nsupported by the U.S. National Science Foundation, under the grants EF0331494 and DMS-0456960 respectively, and by the DARPA program Fundamental Laws in Biology (HR0011-05-1-0057).\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n17\n\nReferences\n[1] K.B. Athreya and P.E. Ney. Branching processes. Dover, Mineola, New York, 1972.\n[2] N. Beerenwinkel, M. D\u00e4umer, M. Oette, K. Korn, D. Hoffmann, R. Kaiser, T.\nLengauer, J. Selbig, and H. Walter. Geno2pheno: Estimating phenotypic drug resistance from HIV-1 genotypes. Nucl. Acids Res., 31(13):3850\u20133855, Jul 2003.\n[3] N. Beerenwinkel and M. Drton. Mutagenetic tree models. In L. Pachter and B. Sturmfels, editors, Algebraic Statistics for Computational Biology, chapter 14, pages 278\u2013\n290. Cambridge University Press, Cambridge, UK, 2005.\n[4] N. Beerenwinkel, J. Rahnenf\u00fchrer, M. D\u00e4umer, D. Hoffmann, R. Kaiser, J. Selbig,\nand T. Lengauer. Learning multiple evolutionary pathways from cross-sectional data.\nJ. Comput. Biol., 12(6):584\u2013598, 2005.\n[5] N. Beerenwinkel, J. Rahnenf\u00fchrer, R. Kaiser, D. Hoffmann, J. Selbig, and T.\nLengauer. Mtreemix: a software package for learning and using mixture models of\nmutagenetic trees. Bioinformatics, 21(9):2106\u20132107, May 2005.\n[6] B. Berkhout. HIV-1 evolution under pressure of protease inhibitors: Climbing the\nstairs of viral fitness. J. Biomed. Sci., 6:298\u2013305, 1999.\n[7] S. Bonhoeffer, C. Chappey, N.T. Parkin, J.M. Whitcomb, and C.J. Petropoulos.\nEvidence for Positive Epistasis in HIV-1. Science, 306:1547\u20131550, 2004.\n[8] G. Brightwell and P. Winkler. Counting linear extensions. Order, 8(3):225\u2013242, 1991.\n[9] F. Clavel and A.J. Hance. HIV drug resistance. N. Engl. J. Med., 350(10):1023\u20131035,\nMar 2004.\n[10] J.H. Condra, D.J. Holder, W.A. Schleif, O.M. Blahy, R.M. Danovich, L.J. Gabryelski,\nD.J. Graham, D. Laird, J.C. Quintero, A. Rhodes, H.L. Robbins, E. Roth, M. Shivaprakash, T. Yang, J.A. Chodakewitz, P.J. Deutsch, R.Y. Leavitt, F.E. Massari, J.W.\nMellors, K.E. Squires, R.T. Steigbigel, H. Teppler, and E.A. Emini. Genetic correlates of in vivo viral resistance to indinavir, a human immunodeficiency virus type 1\nprotease inhibitor. J. Virol., 70(12):8270\u20138276, 1996.\n[11] R. Desper, F. Jiang, O.P. Kallioniemi, H. Moch, C.H. Papadimitriou, and A.A.\nSch\u00e4ffer. Inferring tree models for oncogenesis from comparative genome hybridization data. J. Comput. Biol., 6(1):37\u201351, 1999.\n[12] R. Ehrenborg. On posets and Hopf algebras. Adv. Math., 119(1):1\u201325, 1996.\n[13] L. Garcia, M. Stillman, and B. Sturmfels. Algebraic geometry of Bayesian networks.\nJ. Symbol. Comput., 39:331\u2013355, 2005.\n[14] Y. Iwasa, F. Michor, and M.A. Nowak. Evolutionary dynamics of escape from biomedical intervention. Proc. Biol. Sci., 270(1533):2573\u20132578, Dec 2003.\n[15] Y. Iwasa, F. Michor, and M.A. Nowak. Evolutionary dynamics of invasion and escape.\nJ. Theor. Biol., 226(2):205\u2013214, Jan 2004.\n[16] S.L. Lauritzen. Graphical Models. Clarendon Press, 1996.\n[17] E. Miller and B. Sturmfels. Combinatorial commutative algebra, volume 227 of Graduate Texts in Mathematics. Springer, New York, 2005.\n[18] A. Molla, M. Korneyeva, Q. Gao, S. Vasavanonda, P.J. Schipper, H.M. Mo,\nM. Markowitz, T. Chernyavskiy, P. Niu, N. Lyons, A. Hsu, G.R. Granneman, D.D.\nHo, C.A. Boucher, J.M. Leonard, D.W. Norbeck, and D.J. Kempf. Ordered accumulation of mutations in HIV protease confers resistance to ritonavir. Nat. Med.,\n2(7):760\u2013766, Jul 1996.\n[19] M.A. Nowak and R.M. May. Virus dynamics. Oxford University Press, 2000.\n[20] G. Pruesse and F. Ruskey. Generating linear extensions fast. SIAM J. Comput.,\n23(2):373\u2013386, 1994.\n[21] C.M. Reidys and P.F. Stadler. Combinatorial landscapes. SIAM Review, 44:3\u201354,\n2002.\n\n\f18\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\n[22] S.-Y. Rhee, M.J. Gonzales, R. Kantor, B.J. Betts, J. Ravela, and R.W. Shafer. Human\nimmunodeficiency virus reverse transcriptase and protease sequence database. Nucl.\nAcids Res., 31(1):298\u2013303, Jan 2003.\n[23] C.D. Rosin, R.K. Belew, G.M. Morris, A.J. Olson, and D.S. Goodsell. Coevolutionary analysis of resistance-evading peptidomimetic inhibitors of HIV-1 protease. Proc.\nNatl. Acad. Sci. U. S. A., 96:1369\u20131374, 1999.\n[24] R.P. Stanley. A matrix for counting paths in acyclic digraphs. J. Combin. Theory\nSer. A, 74(1):169\u2013172, 1996.\n[25] R.P. Stanley. Enumerative combinatorics. Vol. 1, volume 49 of Cambridge Studies in\nAdvanced Mathematics. Cambridge University Press, Cambridge, 1997.\n[26] N.I. Stilianakis, C.A. Boucher, M.D. De Jong, R. Van Leeuwen, R. Schuurman, and\nR.J. De Boer. Clinical data sets of human immunodeficiency virus type 1 reverse transcriptase resistant mutants explained by a mathematical model. J. Virol., 71(1):161\u2013\n168, 1997.\n[27] Y.L. Varol and D. Rotem. An algorithm to generate all topological sorting arrangements. Comput. J., 24(1):83\u201384, 1981.\n[28] H. Walter, B. Schmidt, K. Korn, A. M. Vandamme, T. Harrer, and K. \u00dcberla. Rapid,\nphenotypic HIV-1 drug sensitivity assay for protease and reverse transcriptase inhibitors. J. Clin. Virol., 13:71\u201380, 1999.\n[29] C.O. Wilke. Probability of fixation of an advantageous mutant in a viral quasispecies.\nGenetics, 163:467\u2013474, 2003.\n\nAppendix: Mathematics and computation of the risk polynomial\nHere we discuss in more detail mathematical properties of the risk polynomial and we present several methods for computing it. The given data\nconsists of an n element poset E and its induced genotype lattice G, which\nis the distributive lattice of order ideals in E. We assume that G has m\nelements, which are encoded either as subsets of E or as binary strings in\n{0, 1}n . The risk polynomial is the polynomial R(G; f ) in the m unknowns\nfg = f (g), one for each genotype g. We are also interested in specializations\nof R(G; f ) obtained by setting some (or all) of the unknowns equal to each\nother, such as the graded risk polynomial and the univariate risk polynomial.\nStanley's linear algebra method. A direct method for computing the\nrisk polynomial is given in Section 3. Namely, we can set all \u03bce equal to\none in the matrix U and then compute the upper right entry of the matrix\n(I \u2212 UF)\u22121 \u2212 I of equation (3). In practice, one would compute this entry\nby a dynamic program which runs in time O(m2 ). That dynamic program\nis easily derived by resolving the recursion in the last equation of the proof\nof Theorem 7.\nThe following alternative linear algebra technique for computing polynomials similar to our risk polynomials was given by Stanley in [24]. Let\nG \u2032 = G\\{0\u0302, 1\u0302} denote the genotype lattice with the top element 1\u0302 and the\nbottom element 0\u0302 removed. We define A to be the anti-adjacency matrix of\nthe truncated genotype lattice G \u2032 . Thus A is the (m \u2212 2) \u00d7 (m \u2212 2)-matrix\nwith rows and columns indexed by G \u2032 , and whose entry in row g and column\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n19\n\nh is 0 if g \u2282 h and is 1 otherwise. We write\nI for the (m \u2212 2) \u00d7 (m \u2212 2) iden\u0001\ntity matrix and F\u2032 = diag f (g) | g \u2208 G \u2032 for the (m \u2212 2) \u00d7 (m \u2212 2)-diagonal\nmatrix whose entries are the fitness values. Stanley's result reads as follows.\nTheorem 11 (Stanley [24]). The risk polynomial R(G; f ) equals the determinant of the (m \u2212 2) \u00d7 (m \u2212 2)-matrix I + F\u2032 * A.\nExample 12. Let G be the genotype lattice in Figure 1. Then m = 8 and\nI + F\u2032 * A is the 6 \u00d7 6-matrix\n1000\n\uf8eb\n1000 1 + f1000\n0100 \uf8ec\n\uf8ec f0100\n1100 \uf8ec\n\uf8ec f1100\n0101 \uf8ec\n\uf8ec f0101\n1110 \uf8ed f1110\n1101\nf1101\n\n0100\nf1000\n1 + f0100\nf1100\nf0101\nf1110\nf1101\n\n1100\n0\n0\n1 + f1100\nf0101\nf1110\nf1101\n\n0101\nf1000\n0\nf1100\n1 + f0101\nf1110\nf1101\n\n1110\n0\n0\n0\nf0101\n1 + f1110\nf1101\n\n1101\n\uf8f6\n0\n\uf8f7\n0\n\uf8f7\n\uf8f7\n0\n\uf8f7.\n\uf8f7\n0\n\uf8f7\nf1110 \uf8f8\n1 + f1101\n\nThe determinant of this matrix is the risk polynomial of Example 6.\nThe Hilbert series method. A more conceptual way of thinking about\nthe risk polynomial is based on the following algebraic construction. The\nStanley-Reisner ideal IG \u2032 of G \u2032 is the ideal generated by all quadratic monomials fg *fh where g and h are genotypes that are incomparable, i.e., neither\ng \u2286 h nor h \u2286 g holds. The ambient polynomial ring S = R[f ] is generated by the unknowns fg where g \u2208 Q\nG \u2032 . The Hilbert series of IG \u2032 is the\nu\nformal sum over all monomials f u = g\u2208G \u2032 fg g which are not in the ideal\nIG \u2032 . This is a formal generating function which can be written as a rational\nfunction of the following form\nH(S/IG \u2032 ; f )\n\n=\n\nQ\n\nKG (f )\n.\ng\u2208G \u2032 (1 \u2212 fg )\n\nHere KG (f ) is a polynomial in the unknowns fg with integer coefficients. The\npolynomial KG (f ) is known as the K-polynomial of the ideal IG \u2032 . We refer to\n[17] for an introduction to Stanley-Reisner ideals and their K-polynomials.\nIf E is a directed forest (and we identify fg = pg ) then Proposition 10 and\n[3, Thm. 14.11] imply that the ideal IG \u2032 is an initial monomial ideal of the\nconjunctive Bayesian network on E. In a forthcoming paper we shall prove\nthat this initial ideal property holds for all event posets (not just trees).\nExample 13. Let G be the genotype lattice in Figure 1. Then\nIG \u2032\n\n=\n\nh f0101 f1110 , f1101 f1110 , f0101 f1100 , f0101 f1000 , f0100 f1000 i\n\n\f20\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\nis indeed the initial monomial ideal of the conjunctive Bayesian network in\nExample 9. The K-polynomial KG (f ) equals\n1 \u2212 f0101 f1110 \u2212 f1101 f1110 \u2212 f0101 f1100 \u2212 f0101 f1000 \u2212 f0100 f1000\n+f0100 f1000 f0101 + f1000 f0101 f1100 + f1000 f0101 f1110 + f0101 f1100 f1110\n+f0101 f1110 f1101 + f0100 f1000 f1110 f1101\n\u2212f1000 f0101 f1100 f1110 \u2212 f0100 f1000 f0101 f1110 f1101 .\nAgain using Proposition 10 and Theorem 14.11 in [3] we see that the risk\npolynomial R(G; f ) is the sum of all squarefree monomials in the expansion\nof the Hilbert series H(S/IG \u2032 ; f ). Equivalently, R(G; f ) is the reduction of\nH(S/IG \u2032 ; f ) modulo the ideal generated by the squares fg2 of the unknowns.\nSince 1/(1 \u2212 fg ) equals 1 + fg modulo h fg2 i, we have the following result.\nProposition 14. The risk polynomial R(G; f ) of the genotype lattice G is\nthe sum of all squarefree terms in the expansion of\nY\nKG (f ) *\n(1 + fg ),\ng\u2208G \u2032\n\nwhere KG (f ) is the K-polynomial of the Stanley-Reisner ideal IG \u2032 .\nThe univariate risk polynomial R(G; a) is derived from R(G; f ) by replacing each fg by the scalar unknown a. We have\nR(G; a)\n\n=\n\nc0 + c1 a + c2 a2 + * * * + cn\u22121 an\u22121 ,\n\nwhere ci is the number of chains of length i in G \u2032 . Thus, (c0 , . . . , cn\u22121 ) is\nthe f -vector of the simplicial complex of chains in G \u2032 . Likewise, we get the\ngraded risk polynomial from R(G; f ) by replacing each fg by a|g| . We note\nthat the graded risk polynomial is related to Ehrenborg's quasi-symmetric\nfunction encoding [12] of the flag f -vector of the chain complex of G \u2032 .\nThe linear extensions method. One advantage of both Theorem 11 and\nProposition 14 is that these formulas do not actually depend on the fact\nthat G is a distributive lattice. They also apply if the set G of genotypes\nis an arbitrary poset. This is relevant for our discussion of the statistical\nmodels in Section 4, where we introduced a more general class of posets\nGp \u2286 {0, 1}n .\nThis advantage is also a disadvantage: Theorem 11 and Proposition 14\ndo not give the most efficient methods for computing R(G; f ) when G is\nthe distributive lattice induced by an event poset E. In what follows we\npresent a specialized and more efficient algorithm for the risk polynomial.\nThe input to this algorithm consists of the event poset E. It is not necessary\nto compute the genotype lattice G as this will be done as a byproduct of our\napproach, which is to compute the risk polynomial R(G; f ) directly from E.\nAs before, we assume that E has n elements, and we write [n] for the linearly ordered set {1, 2, . . . , n}. A linear extension of E is an order-preserving\n\n\fEVOLUTION ON DISTRIBUTIVE LATTICES\n\n21\n\nbijection \u03c0 : E \u2192 [n]. This means that e < e\u2032 in E implies \u03c0(e) < \u03c0(e\u2032 ). Every linear extension \u03c0 : E \u2192 [n] gives rise to an ordered list of n\u22121 genotypes\ng(1) , g (2) , . . . , g(n\u22121) in G \u2032 = G\\{0\u0302, 1\u0302} as follows. The genotype g(i) is the\nsubset of E consisting of all events whose image under \u03c0 is among the first\ni positive integers. In symbols, g (i) = \u03c0 \u22121 ({1, 2, . . . , i}). The sequence\ng(1) , g (2) , . . . , g(n\u22121) , derived from \u03c0, represents a mutational pathway in G.\nWe now fix one distinguished linear extension of E, that is, we identify\nthe set underlying E with [n] itself. Then a linear extension is simply any\npermutation \u03c0 of [n] which preserves the order relations in E. We define\nY\nY\nfg(i) ,\n(12)\nf (\u03c0) =\n(fg(i) + 1) *\ni:\u03c0(i)<\u03c0(i+1)\n\ni:\u03c0(i)>\u03c0(i+1)\n\nwhere i runs over {1, 2, . . . , n \u2212 1}. Our algorithm amounts to evaluating\nthe risk polynomial by means of the following explicit summation formula.\nTheorem 15. The risk polynomial R(G; f ) equals the sum of the products\nf (\u03c0) where \u03c0 runs over all linear extensions of the event poset E.\nProof. The relationship between chains in G and linear extensions of E is\nthe content of [25, Prop. 3.5.2]. The distributive lattice G has a canonical\nR-labeling [25, Sec. 3.13] which assigns to each edge of the Hasse diagram of\nG the corresponding element of E. In view of this R-labeling, Exercise 59d\nin [25, Chap. 3] tells us that the poset G \u2032 = G\\{0\u0302, 1\u0302} is chain-partitionable.\nEach product f (\u03c0) as in (12) is the generating function for all the chains in\nprecisely one part of that chain partition of G \u2032 . Adding up all products gives\nthe generating function for all chains, which is the risk polynomial.\n\u0003\nExample 16. The event poset E in Figure 1 has five linear extensions \u03c0:\n\u03c0\nf (\u03c0)\n(1, 2, 3, 4) (1 + f1000 )(1 + f1100 )(1 + f1110 )\n(1, 2, 4, 3)\n(1 + f1000 )(1 + f1100 )f1101\n(2, 1, 3, 4)\nf0100 (1 + f1100 )(1 + f1110 )\n(2, 1, 4, 3)\nf0100 (1 + f1100 )f1101\n(2, 4, 1, 3)\n(1 + f0100 )f0101 (1 + f1101 )\nThe sum of these five products equals the risk polynomial R(G; f ).\nImplementation. Pruesse and Ruskey [20] showed that the linear extensions of a poset E can be computed in time linear in the number of linear\nextensions. Thus, their algorithm computes R(G; f ) in time linear in the\nsize of the output of Theorem 15. That output is in factored form (12) and\nis always more compact than the expanded risk polynomial. In this manner,\nwe compute the risk polynomial in time sublinear in the size of the expanded\nrisk polynomial.\nTo obtain the univariate risk polynomial, we take the sum of the terms\n(1 + a)n\u22121\u2212\u03b4 a\u03b4 , where \u03b4 = \u03b4(\u03c0) is the number of descents of the linear\n\n\f22\n\nBEERENWINKEL, ERIKSSON, AND STURMFELS\n\nextension \u03c0. Similarly, the graded risk polynomial R(G; a1 , . . . , an\u22121 ) is\nfound by keeping track of the descent set of each linear extension \u03c0. We\nbelieve that this method is best possible for general posets E. Notice that\nthe leading term of the univariate risk polynomial is the number of linear\nextensions of E, and it is #P-complete to count linear extensions [8].\nWhen E is a directed forest, the recursive structure can be used to help\ncompute the risk polynomial. In this case, E is built up by the operations\nof disjoint union and ordinal sum from the one element poset. For example, in the univariate case, the zeta polynomial [25, Sec. 3.11] of G behaves\nnicely under these operations and can be used to write down the risk polynomial. Based on these considerations, we can design an efficient algorithm\nfor computing the univariate risk polynomial of a directed forest.\nUsing the method of Theorem 15, we have developed software for computing risk polynomials. The input to our program is an arbitrary event\nposet E, and the output is the risk polynomial, the graded risk polynomial\nor the univariate risk polynomial. Optionally, the user can also input either\nexact fitness values or upper and lower bounds for each fitness value. The\noutput in this case is either the exact risk of escape or upper and lower\nbounds for the risk. It is designed to integrate with the package Mtreemix\n[5], allowing the user to start with data, infer a mutagenetic tree, and then\neasily compute the risk polynomial. Our software is available at\nhttp://bio.math.berkeley.edu/riskpoly/\nWe use the algorithm of [27] for computing linear extensions. Although\nthis algorithm isn't asymptotically optimal, as shown in [20], it is simple to\nimplement and efficient in practice.\n\n\f"}