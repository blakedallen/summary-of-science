{"id": "http://arxiv.org/abs/0805.2355v3", "guidislink": true, "updated": "2008-07-24T12:47:47Z", "updated_parsed": [2008, 7, 24, 12, 47, 47, 3, 206, 0], "published": "2008-05-15T16:18:43Z", "published_parsed": [2008, 5, 15, 16, 18, 43, 3, 136, 0], "title": "The three-point function of planar quadrangulations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0805.4413%2C0805.3335%2C0805.2057%2C0805.4234%2C0805.3924%2C0805.3193%2C0805.4368%2C0805.4314%2C0805.1220%2C0805.2855%2C0805.3300%2C0805.0873%2C0805.3446%2C0805.3151%2C0805.3830%2C0805.0021%2C0805.3285%2C0805.0267%2C0805.2504%2C0805.1610%2C0805.2138%2C0805.0118%2C0805.1560%2C0805.4472%2C0805.1452%2C0805.2155%2C0805.1332%2C0805.3560%2C0805.2359%2C0805.1798%2C0805.4555%2C0805.4501%2C0805.1612%2C0805.1725%2C0805.3514%2C0805.0508%2C0805.4088%2C0805.3442%2C0805.2968%2C0805.1480%2C0805.3039%2C0805.0506%2C0805.3900%2C0805.4493%2C0805.1637%2C0805.0140%2C0805.4500%2C0805.4481%2C0805.4664%2C0805.3234%2C0805.4104%2C0805.1776%2C0805.2531%2C0805.0990%2C0805.0925%2C0805.1226%2C0805.0349%2C0805.4343%2C0805.2378%2C0805.4304%2C0805.3000%2C0805.4416%2C0805.0400%2C0805.2355%2C0805.1007%2C0805.2088%2C0805.2537%2C0805.2224%2C0805.4635%2C0805.2707%2C0805.4014%2C0805.1903%2C0805.0713%2C0805.0369%2C0805.1248%2C0805.0688%2C0805.2354%2C0805.1033%2C0805.4557%2C0805.3414%2C0805.0762%2C0805.4288%2C0805.0695%2C0805.2955%2C0805.3829%2C0805.1588%2C0805.3935%2C0805.1269%2C0805.3483%2C0805.2123%2C0805.0926%2C0805.1546%2C0805.1778%2C0805.0561%2C0805.3856%2C0805.4433%2C0805.4347%2C0805.1000%2C0805.2264%2C0805.3220%2C0805.0977&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The three-point function of planar quadrangulations"}, "summary": "We compute the generating function of random planar quadrangulations with\nthree marked vertices at prescribed pairwise distances. In the scaling limit of\nlarge quadrangulations, this discrete three-point function converges to a\nsimple universal scaling function, which is the continuous three-point function\nof pure 2D quantum gravity. We give explicit expressions for this universal\nthree-point function both in the grand-canonical and canonical ensembles.\nVarious limiting regimes are studied when some of the distances become large or\nsmall. By considering the case where the marked vertices are aligned, we also\nobtain the probability law for the number of geodesic points, namely vertices\nthat lie on a geodesic path between two given vertices, and at prescribed\ndistances from these vertices.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0805.4413%2C0805.3335%2C0805.2057%2C0805.4234%2C0805.3924%2C0805.3193%2C0805.4368%2C0805.4314%2C0805.1220%2C0805.2855%2C0805.3300%2C0805.0873%2C0805.3446%2C0805.3151%2C0805.3830%2C0805.0021%2C0805.3285%2C0805.0267%2C0805.2504%2C0805.1610%2C0805.2138%2C0805.0118%2C0805.1560%2C0805.4472%2C0805.1452%2C0805.2155%2C0805.1332%2C0805.3560%2C0805.2359%2C0805.1798%2C0805.4555%2C0805.4501%2C0805.1612%2C0805.1725%2C0805.3514%2C0805.0508%2C0805.4088%2C0805.3442%2C0805.2968%2C0805.1480%2C0805.3039%2C0805.0506%2C0805.3900%2C0805.4493%2C0805.1637%2C0805.0140%2C0805.4500%2C0805.4481%2C0805.4664%2C0805.3234%2C0805.4104%2C0805.1776%2C0805.2531%2C0805.0990%2C0805.0925%2C0805.1226%2C0805.0349%2C0805.4343%2C0805.2378%2C0805.4304%2C0805.3000%2C0805.4416%2C0805.0400%2C0805.2355%2C0805.1007%2C0805.2088%2C0805.2537%2C0805.2224%2C0805.4635%2C0805.2707%2C0805.4014%2C0805.1903%2C0805.0713%2C0805.0369%2C0805.1248%2C0805.0688%2C0805.2354%2C0805.1033%2C0805.4557%2C0805.3414%2C0805.0762%2C0805.4288%2C0805.0695%2C0805.2955%2C0805.3829%2C0805.1588%2C0805.3935%2C0805.1269%2C0805.3483%2C0805.2123%2C0805.0926%2C0805.1546%2C0805.1778%2C0805.0561%2C0805.3856%2C0805.4433%2C0805.4347%2C0805.1000%2C0805.2264%2C0805.3220%2C0805.0977&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We compute the generating function of random planar quadrangulations with\nthree marked vertices at prescribed pairwise distances. In the scaling limit of\nlarge quadrangulations, this discrete three-point function converges to a\nsimple universal scaling function, which is the continuous three-point function\nof pure 2D quantum gravity. We give explicit expressions for this universal\nthree-point function both in the grand-canonical and canonical ensembles.\nVarious limiting regimes are studied when some of the distances become large or\nsmall. By considering the case where the marked vertices are aligned, we also\nobtain the probability law for the number of geodesic points, namely vertices\nthat lie on a geodesic path between two given vertices, and at prescribed\ndistances from these vertices."}, "authors": ["J. Bouttier", "E. Guitter"], "author_detail": {"name": "E. Guitter"}, "author": "E. Guitter", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1088/1742-5468/2008/07/P07020", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0805.2355v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0805.2355v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "43 pages, 16 color figures, misprints and figure 15 corrected", "arxiv_primary_category": {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0805.2355v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0805.2355v3", "journal_reference": "J. Stat. Mech. (2008) P07020", "doi": "10.1088/1742-5468/2008/07/P07020", "fulltext": "The three-point function of planar quadrangulations\n\narXiv:0805.2355v3 [math-ph] 24 Jul 2008\n\nJ. Bouttier and E. Guitter\nInstitut de Physique Th\u00e9orique\nCEA, IPhT, F-91191 Gif-sur-Yvette, France\nCNRS, URA 2306\njeremie.bouttier@cea.fr\nemmanuel.guitter@cea.fr\n\nAbstract\nWe compute the generating function of random planar quadrangulations with\nthree marked vertices at prescribed pairwise distances. In the scaling limit of\nlarge quadrangulations, this discrete three-point function converges to a simple\nuniversal scaling function, which is the continuous three-point function of pure\n2D quantum gravity. We give explicit expressions for this universal threepoint function both in the grand-canonical and canonical ensembles. Various\nlimiting regimes are studied when some of the distances become large or small.\nBy considering the case where the marked vertices are aligned, we also obtain\nthe probability law for the number of geodesic points, namely vertices that\nlie on a geodesic path between two given vertices, and at prescribed distances\nfrom these vertices.\n\n1. Introduction\n1.1. The problem\nMaps are fundamental objects of discrete mathematics, usually defined as cellular\nembeddings of graphs into surfaces. They raise many interesting combinatorial and\nprobabilistic questions. The understanding of their statistical properties is also relevant to physics, where random maps provide discrete models for fluctuating surfaces,\nfor instance in the context of two-dimensional quantum gravity [1]. Many results have\nbeen obtained over the years for the enumeration of various families of maps, including\nmaps carrying spins or particles. Besides Tutte's original approach using some recursive\ndecomposition of the maps [2], several new techniques of enumeration were introduced\nover the years, using for instance random matrix integrals [3,4] or, more recently, bijections with decorated trees like \"blossom trees\" [5-10] or \"well-labeled trees\" [11-14].\nSo far, most enumeration results dealt however with global properties of the maps,\nconsisting in simply counting these maps or computing global correlations functions for\nsome observables, obtained by averaging over the position of the points where these\nobservables are measured (see [4]). To fully understand the structure of random maps,\n1\n\n\fit is however necessary to have access to local correlations, in which one controls the\ndistance between the points where the measure takes place [15,16]. Very little is known\nat this time about local correlations but many results in this direction should be within\nreach by a proper use of the above-mentioned bijection with well-labeled trees. Indeed,\nin this approach, the coding of maps into trees makes explicit reference to the graph\ndistance to some origin vertex, thus keeping track in the enumeration of a number of\ngraph distances between vertices. A first progress was achieved in Ref. [17], where the\nso-called canonical two-point function of quadrangulations was computed. This function\ngives the average number of pairs of vertices at prescribed distance from each other in\nthe ensemble of quadrangulations (i.e. maps with only tetravalent faces) with a fixed\nnumber of faces. In particular, for large quadrangulations and at large distances, a\nsensible scaling limit can be obtained where the two-point function converges to some\nuniversal scaling function, which is the two-point function of pure 2D quantum gravity\n[15,17]. Another recent progress was made in Ref.[18], where the question of geodesic\npaths between two vertices in random quadrangulations was addressed, and a number\nof results were obtained on the actual dependence of the statistics of geodesics on the\ndistance between their endpoints.\nIn this paper, we address the question of the three-point function of planar quadrangulations, consisting in enumerating triply-pointed quadrangulations, i.e. quadrangulations with three marked vertices at prescribed pairwise distances. Our main result is\nan explicit formula for the generating function of such triply-pointed quadrangulations\ncounted with a weight g per face. Our approach relies on an extension by Miermont of\nthe bijection with well-labeled trees which allows to treat the case of multiply-pointed\nquadrangulations [19] via a coding by more general well-labeled maps, which can then be\nenumerated. Considering the scaling limit of large quadrangulations and large distances,\nwe then give explicit expressions for the universal scaling form of this three-point function, in both grand-canonical and canonical ensembles. In the language of 2D quantum\ngravity, this constitutes the continuous three-point function for the universality class of\nthe so-called pure gravity, with the planar topology. We discuss here its main properties.\nThe paper is organized as follows: in section 1.2, we start by briefly recalling some\nknown results about the two-point function of quadrangulations, and its continuum\nlimit. We then present in section 2 our results for the three-point function. We give\nin section 2.1 the explicit formula for the generating function G(d12 , d23 , d31 ; g) with a\nweight g per face of planar quadrangulations with three distinct vertices, distinguished\nas 1, 2 and 3, at prescribed pairwise distances d12 , d23 and d31 . We then derive in\nsection 2.2 its universal scaling form both in the grand-canonical ensemble with a fixed\n\"cosmological constant\" and in the canonical ensemble of maps with a fixed, but large\nnumber n of faces. The grand-canonical three-point function is obtained by letting\ng tend to its critical value 1/12 and considering distances scaling as (1/12 \u2212 g)\u22121/4 .\nAs for the canonical three-point function, it is obtained by letting the size n of the\nquadrangulations tend to infinity, with distances scaling as n1/4 . Various limits of the\ncanonical three-point function are discussed in section 2.3, corresponding to the cases\nwhen one or several of the (rescaled) distances become large or small. Sections 3 and\n2\n\n\f4 are devoted to the actual derivation of our main formula for G(d12 , d23 , d31 ; g). We\nfirst recall in section 3.1 the Miermont bijection between, on the one hand, multiplypointed quadrangulations with sources and delays and, on the other hand, well-labeled\nmaps. We show in section 3.2 how to use this bijection in the case of triply-pointed\nmaps and how to keep track of all pairwise distances by a proper choice of delays. This\nallows us to reduce our enumeration problem to that of counting particular well-labeled\nmaps with three faces, with a number of constraints on their labels. The generating\nfunction for such maps is finally obtained in section 4, where we make use of three main\nbuilding blocks: the already known generating function for well-labeled trees, recalled in\nsection 4.1, a new generating function for properly weighted Motzkin paths describing\nchains of such trees corresponding to well-labeled maps with two faces, explicited in\nsection 4.2 and another new generating function for so-called Y-diagrams appearing in\na decomposition of well-labeled maps with three faces, explicited in section 4.3, where\nwe finally establish our formula for G(d12 , d23 , d31 ; g). An alternative derivation of the\nabove generating function for weighted Motzkin path is presented in Appendix A. We\ndiscuss in section 4.4 a number of applications of our formula corresponding to the\nso-called (non-universal) \"local limit\" of large quadrangulations, where we keep the\ndistances finite but let the number n of faces tend to infinity. We discuss in details the\ncase where one of the three marked vertices is a geodesic point, i.e. lies on a geodesic\npath between the two others. We give in particular the probability law for the number of\ngeodesic points at fixed distances from two marked vertices. We finally discuss possible\nextensions of our results and conclude in section 5.\n1.2. The two-point function of quadrangulations\nBefore we present our results for the three-point function, it is useful to recall briefly\nsome known facts about the two-point function of quadrangulations. This function\nis obtained by considering configurations of doubly-pointed planar quadrangulations,\ni.e. planar quadrangulations with two marked distinct and distinguished vertices. As\ncustomary, every configuration is counted with a weight g per face and some inverse\nsymmetry factor, equal to the inverse of the order of its automorphism group. The\ngenerating function G(i; g) of such weighted doubly-pointed quadrangulations where\nthe two marked points are at distance i from each other was found to be [13]:\n\uf8f1\n\u0013\n\u0012\nR\n\uf8f4\ni\n\uf8f2 log\nfor i \u2265 2\nRi\u22121\n(1.1)\nG(i; g) =\n\uf8f4\n\uf8f3\nlog R1\nfor i = 1\nwith Ri given by [17]:\n\nRi = R\n\n[i]x [i + 3]x\n,\n[i + 1]x [i + 2]x\n\ni\u22651.\n\n(1.2)\n\nHere and throughout the paper, we use the shorthand notation:\n[i]x \u2261\n\n1 \u2212 xi\n.\n1\u2212x\n3\n\n(1.3)\n\n\fThe quantities R and x in (1.2) are power series in g determined by\ng=\n\nx+1+\nx+4+\n\nso that we have\n1\u2212\n\n1\nx\n\u0001\n1 2\nx\n\nx+4+\nR=\nx+1+\n\n,\n\n1\nx\n1\nx\n\n,\n\n(1.4)\n\n\u221a\n\n1 \u2212 12g\n,\n6g\n\u221a p\n\u221a\n\u221a\n1 \u2212 24g \u2212 1 \u2212 12g + 6 72g 2 + 6g 1 \u2212 12g \u2212 1\n\u221a\n.\nx=\n2(6g + 1 \u2212 12g \u2212 1)\n\nR=\n\n(1.5)\n\nThe quantity G(i; g) constitutes the discrete \"grand-canonical\" two-point function of\nquadrangulations and corresponds to an ensemble of quadrangulations with a varying\nnumber of faces, governed by g. We may instead decide to fix the number n of faces\nof the quadrangulation. The corresponding partition function can be obtained via a\ncontour integral in g around 0 as:\nI\n1\ndg\nG(i; g)|g n =\nG(i; g) .\n(1.6)\n2i\u03c0\ng n+1\nThis quantity constitutes the discrete \"canonical\" two-point function of quadrangulations.\n\n\u03a6( D )\n\n\u03c1( D )\n\n1\n0.6\n0.8\n\n0.5\n0.4\n\n0.6\n\n0.3\n0.4\n0.2\n0.2\n\n0.1\n1\n\n2\n\n4\n\n3\n\n5\n\nD\n\n1\n\n(a)\n\n2\n\n3\n\n4\n\n5\n\nD\n\n(b)\n\nFig. 1: The universal canonical two-point function, given by (a) the probability density function \u03c1(D), and (b) the corresponding distribution function \u03a6(D).\nA sensible continuum limit is reached by letting g approach its critical value 1/12\nand jointly taking a large distance i, with the following scaling:\ng=\n\n1\n(1 \u2212 \u039b \u01eb) ,\n12\n4\n\ni = D\u01eb\u22121/4 ,\n\n(1.7)\n\n\fwhere \u01eb \u2192 0 and where \u039b is the so-called \"cosmological constant\". In this limit, we\nhave\n\u0012\n\u0013\n\u0012 \u0013\n\u0010 p\n\u0011\n3\nRi\n2\u03b12\n1/2\n1/4\n\u223c \u01eb F D; 3/2\u039b\n1+\nlog\nwith F (D; \u03b1) = \u2212\n2\n3\nsinh2 (\u03b1D)\n(1.8)\nso that\n\u0011\n\u0010 p\ncosh(\u03b1D)\nwith G(D; \u03b1) = \u2202D F (D; \u03b1) = 4\u03b13\nG(i; g) \u223c \u01eb3/4 G D; 3/2\u039b1/4\n.\nsinh3 (\u03b1D)\n(1.9)\nThis constitutes the continuous two-point function in the grand-canonical ensemble with\ncosmological constant \u039b [15,16]. Again, we may instead consider the canonical ensemble\nwhere the number of faces n of the quadrangulations is now fixed to a large value. A\nsensible limit is reached by letting n tend to infinity with the distance between the\nmarked vertices scaling as n1/4 . The integral (1.6) translates at large n via a saddle\npoint estimate into an integral over real values of some parameter \u03be, upon setting\n\u0012\n\u0013\n\u03be2\n1\n1+\n,\ni = Dn1/4 .\n(1.10)\ng=\n12\nn\n\nUsing Eq. (1.9) with \u01eb = 1/n and \u039b = \u2212\u03be 2 , and performing a proper normalization\nof G(i; g)|g n by the number of doubly-pointed quadrangulations with size n, we then\nobtain a normalized probability density\nZ \u221e\np\n2\n2\nd\u03be \u03be e\u2212\u03be G(D; \u22123i\u03be/2) .\n(1.11)\n\u03c1(D) = \u221a\ni \u03c0 \u2212\u221e\n\nThis constitutes the continuous canonical two-point function: the quantity \u03c1(D)dD measures the infinitesimal probability, in the ensemble of large doubly-pointed quadrangulations, that the two marked vertices be at a rescaled distance in the range [D, D+dD]. Its\nvalue (1.11) is expected to be universal for a large class of maps forming the universality\nclass of so-called pure gravity. Finally, another quantity of interest is the (cumulative)\ndistribution function\nZ \u221e\np\n2\n2\n(1.12)\n\u03a6(D) = \u221a\nd\u03be \u03be e\u2212\u03be F (D; \u22123i\u03be/2)\ni \u03c0 \u2212\u221e\n\ngiving the probability that the distance is less than D. The functions \u03c1(D) and \u03a6(D)\nare represented in Fig. 1. For small D, we have \u03c1(D) \u223c (3/7)D3 .\n2. The three-point function\n\nWe now come to our main subject, namely the three-point function of quadrangulations. In this section, we present our main result, which is an explicit formula for the\ngenerating function of planar quadrangulations with three marked vertices at prescribed\npairwise distances. We shall concentrate here on the properties of this three-point function, leaving its precise derivation to sections 3 and 4 below. An important application\nis the continuum scaling limit in which the three-point function takes a particularly\nsimple universal form.\n5\n\n\f2.1. The three-point function of quadrangulations\nWe consider planar quadrangulations with three distinct vertices distinguished as\n1, 2 and 3, and we denote by d12 , d23 and d31 their respective pairwise graph distances.\nPrescribing these distances, let G(d12 , d23 , d31 ; g) denote the generating function for the\nnumber of such triply-pointed quadrangulations, counted with a weight g per face. Note\nthat there are no symmetry factors for triply-pointed quadrangulations as the latter have\nno symmetries. The function G(d12 , d23 , d31 ; g) is defined for strictly positive integer\nvalues of d12 , d23 and d31 that furthermore satisfy:\n- the triangular inequalities: d12 \u2264 d23 + d31 and its cyclic permutations;\n- the condition that d12 + d23 + d31 is even.\nThis latter condition stems from the fact that every planar quadrangulation is bipartite,\nhence the length of any cycle on the map is even. These conditions are best expressed\nthrough the parametrization\nd12 = s + t ,\nd23 = t + u ,\n\n(2.1)\n\nd31 = u + s ,\neasily inverted into\nd12 \u2212 d23 + d31\n,\n2\nd12 + d23 \u2212 d31\nt=\n,\n2\n\u2212d12 + d23 + d31\nu=\n.\n2\ns=\n\n(2.2)\n\nd31\n\n3\n\n1\n\nd23\n\nu\ns t\nd12\n\nFig. 2: A schematic picture of the relations (2.1) and (2.2).\n6\n\n2\n\n\fWith this parametrization, the above conditions are equivalent to requiring that s, t,\nu be non-negative integers and that at most one of them may vanish. An intuitive\npicture of this parametrization is as follows (see Fig 2): drawing a triangle 123 in the\nplane with sides d12 , d23 and d31 , the quantities s, t and u can be viewed as the radii\nof three pairwise tangent circles centered at the points 1, 2, 3. Note that having one\nof the parameters vanishing, say u, corresponds in this picture to having 3 lying on\nthe segment 12. On the quadrangulation, this simply means that 3 lies precisely on a\ngeodesic path between 1 and 2, so that d12 = d23 + d31 . We shall say in this case that\nthe three points are aligned and that 3 is a geodesic point between 1 and 2.\nWe find the following expression for the three-point function:\nG(d12 , d23 , d31 ; g) = \u2206s \u2206t \u2206u F (s, t, u; g) ,\n\n(2.3)\n\nwhere \u2206s denotes the finite difference operator acting on an arbitrary function f (s) as:\n\u2206s f (s) \u2261 f (s) \u2212 f (s \u2212 1) ,\n\n(2.4)\n\nand similarly for \u2206t and \u2206u , while F (s, t, u; g) has the explicit form:\nF (s, t, u; g) =\n[3]x ([s + 1]x [t + 1]x [u + 1]x [s + t + u + 3]x )\n3\n[1]x\n\n2\n\n(2.5)\n\n[s + t + 1]x [s + t + 3]x [t + u + 1]x [t + u + 3]x [u + s + 1]x [u + s + 3]x\n\nAs before, we use the notation (1.3) with a parameter x related to g by Eq. (1.4), or\nmore explicitly by Eq. (1.5). Note that F (s, t, u; g) is manifestly symmetric in s, t, u,\nwhich is consistent with G being symmetric in the distances, as expected.\nRelations (2.3) and (2.5) hold a priori only in the allowed range of distances, namely\nwhen s, t, u are non-negative integers and no more than one of them may vanish. In\nthe case of aligned points, say when u vanishes, relation (2.3) reduces to\nG(s + t, t, s; g) = \u2206s \u2206t F (s, t, 0; g)\n\n(2.6)\n\nas F (s, t, \u22121; g) vanishes identically, while relation (2.5) reduces to\nF (s, t, 0; g) =\n\n[3]x [s + 1]x [t + 1]x [s + t + 3]x\n.\n[1]x [s + 3]x [t + 3]x [s + t + 1]x\n\n(2.7)\n\nIt is convenient to slightly extend the domain of definition of G and F as follows: when\nexactly two of the parameters, say t and u, vanish, corresponding to 2 and 3 being\nidentical, Eqs. (2.3) and (2.5) give a result G(s, 0, s; g) = 0, which can still be considered\nas the correct result as we imposed that the three marked vertices have to be distinct.\nFinally, when s = t = u = 0, the above formulas yield the somewhat conventional\n7\n\n\fvalue G(0, 0, 0; g) = 1. We shall therefore take the convention that G(d, d, 0; g) =\nG(d, 0, d; g) = G(0, d, d; g) = \u03b4d,0 . With this convention, Eq. (2.3) may be inverted into:\nF (s, t, u; g) =\n\nu\nt X\ns X\nX\n\ns\u2032 =0 t\u2032 =0\n\nG(s\u2032 + t\u2032 , t\u2032 + u\u2032 , u\u2032 + s\u2032 ; g) ,\n\n(2.8)\n\nu\u2032 =0\n\nso that F (s, t, u; g)\u22121 can be interpreted as the generating function of quadrangulations\nwith three distinct marked vertices at distances d12 = s\u2032 +t\u2032 , d23 = t\u2032 +u\u2032 and d31 = u\u2032 +s\u2032\nsuch that s\u2032 \u2264 s, t\u2032 \u2264 t and u\u2032 \u2264 u. In particular, taking the limit s, t, u \u2192 \u221e amounts\nto relaxing these constraints, i.e. considering three arbitrary distinct vertices. We have:\n\u0011\n1 + x + x2\n1\u0010\n\u22121/2\nlim F (s, t, u; g) =\n1 + (1 \u2212 12g)\n=\ns,t,u\u2192\u221e\n(1 \u2212 x)2\n2\nX 3n \u00122n\u0013\n=1+\ngn ,\n2 n\n\n(2.9)\n\nn\u22651\n\nwhere we identify the coefficient of g n as the number of triply-pointed quadrangulations\nwith n faces and three distinct marked vertices.\n2.2. Universal continuum limit\nThe above formula for the three-point function is easily translated in the continuum\nlimit, i.e. when g approaches its critical value 1/12 and all distances are large, with the\nfollowing scaling:\n1\n(1 \u2212 \u039b \u01eb) ,\n12\n= D23 \u01eb\u22121/4 , d31 = D31 \u01eb\u22121/4 ,\n\ng=\nd12 = D12 \u01eb\u22121/4 ,\n\nd23\n\n(2.10)\n\nwith \u01eb \u2192 0. Similarly, the parameters s, t, u defined in Eq. (2.1) have the scaling:\ns = S\u01eb\u22121/4 , t = T \u01eb\u22121/4 , s = U \u01eb\u22121/4 ,\n\n(2.11)\n\nwhere S, T , U are related to D12 , D23 and D31 via relations similar to Eqs. (2.1) and\n(2.2), namely\nD12 \u2212 D23 + D31\n,\nD12 = S + T ,\nS=\n2\nD12 + D23 \u2212 D31\n(2.12)\n,\nD23 = T + U ,\nT =\n2\n\u2212D12 + D23 + D31\nD31 = U + S ,\nU=\n.\n2\nIn this limit, we obtain\np\nG(d12 , d23 , d31 ; g) \u223c \u01eb1/4 2G(D12 , D23 , D31 ; 3/2\u039b1/4 )\n(2.13)\np\nF (s, t, u; g) \u223c \u01eb\u22121/2 F (S, T, U ; 3/2\u039b1/4 )\n8\n\n\fwith finite scaling functions G and F depending on the rescaled distances and on the\n\"cosmological constant\" \u039b, encoded for later convenience in the parameter\np\n(2.14)\n\u03b1 = 3/2\u039b1/4 .\n\nNote the factor of 2 in the first line of Eq. (2.13) which we introduced to compensate the\nfact that this relation holds only for discrete distances satisfying the parity condition\nthat d12 + d23 + d31 be even, while G should be taken as zero otherwise. The factor 2\nensures a posteriori that G = (2G + 0)/2 is a correct measure of G on average. Relation\n(2.3) becomes\n1\nG(D12 , D23 , D31 ; \u03b1) = \u2202S \u2202T \u2202U F (S, T, U ; \u03b1) ,\n(2.15)\n2\nwhile Eq.(2.5) translates immediately into\n3\nF (S, T, U ; \u03b1) = 2\n\u03b1\n\n\u0012\n\nsinh(\u03b1(S + T + U )) sinh(\u03b1S) sinh(\u03b1T ) sinh(\u03b1U )\nsinh(\u03b1(S + T )) sinh(\u03b1(T + U )) sinh(\u03b1(U + S))\n\n\u00132\n\n.\n\n(2.16)\n\nThe above formulas (2.15) and (2.16) give the continuous three-point function in the\ngrand-canonical ensemble with a varying size of the quadrangulations and a fixed cosmological constant \u039b. This constitutes the grand-canonical three-point function of pure\n2D quantum gravity.\nIf we wish instead to work in the canonical ensemble where the number of faces\nn of the quadrangulations is fixed to a large value, and the distances are scaled as\nn1/4 , we can use the above formulas with \u01eb = 1/n, and a varying cosmological constant\n\u039b = \u2212\u03be 2 . As seen for the two-point function, the coefficient of g n in G or F is obtained\nby a contour integral in g which, asymptotically at large n, yields, via a saddle point\nestimate, an integral over real values of \u03be, namely:\nZ\np\n2\n12n \u221e\nn\nd\u03be \u03be e\u2212\u03be n\u22121/4 2G(D12 , D23 , D31 ; \u22123i\u03be/2) ,\nG(d12 , d23 , d31 ; g)|g \u223c\ni\u03c0n \u2212\u221e\n(2.17)\nZ\np\n12n \u221e\n\u2212\u03be2 1/2\nd\u03be \u03be e\nn F (S, T, U ; \u22123i\u03be/2) ,\nF (s, t, u; g)|g n \u223c\ni\u03c0n \u2212\u221e\n\np\n\u221a\nwhere we take the determination \u2212i\u03c4 = e\u2212sign(\u03c4 )i\u03c0/4 |\u03c4 | for \u03c4 real. Normalizing these\nasymptotic values, we find the canonical three-point function\nZ \u221e\np\n2\n2\nd\u03be \u03be e\u2212\u03be G(D12 , D23 , D31 ; \u22123i\u03be/2) ,\n\u03c1(D12 , D23 , D31 ) = \u221a\n(2.18)\ni \u03c0 \u2212\u221e\n\nwhere \u03c1(D12 , D23 , D31 ) dD12 dD23 dD31 is the infinitesimal probability that the pairwise\nrescaled distances between the three marked points in the ensemble of triply-pointed random quadrangulations of fixed large size be respectively in the ranges [D12 , D12 + dD12 ],\n[D23 , D23 + dD23 ], [D31 , D31 + dD31 ]. Eq. (2.18) constitutes the canonical three-point\nfunction of pure 2D quantum gravity for the planar topology.\n9\n\n\fEq. (2.18) was obtained by dividing the first line of Eq. (2.17) by the number of\ntriply pointed quadrangulations of size n, as given by (2.9):\n\u0012 \u0013\n12n\n3n 2n\n\u223c \u221a 1/2 ,\n2 n\n2 \u03c0n\n\n(2.19)\n\nand multiplying by n3/4 /2 which is the number of allowed triplets of discrete distances\n(d12 , d23 , d31 ) falling into the above range of rescaled distances (note the factor 1/2\ncoming from the parity of d12 + d23 + d31 ). Similarly, the second line of Eq. (2.17)\ntranslates into the integrated three-point function\n2\n\u03a6(S, T, U ) = \u221a\ni \u03c0\n\nZ\n\n\u221e\n\u2212\u221e\n\n2\n\nd\u03be \u03be e\u2212\u03be F (S, T, U ;\n\np\n\u22123i\u03be/2) ,\n\n(2.20)\n\ncorresponding to the probability that the three marked points be at distances S \u2032 + T \u2032 ,\nT \u2032 + U \u2032 and U \u2032 + S \u2032 with S \u2032 \u2264 S, T \u2032 \u2264 T and U \u2032 \u2264 U . The functions \u03a6 and \u03c1 are\nrelated through\n\u03c1(D12 , D23 , D31 ) =\n\n1\n\u2202S \u2202T \u2202U \u03a6(S, T, U )\n2\n\n(2.21)\n\nor conversely\n\n\u03a6(S, T, U ) =\n\nZ\n\nS\n\ndS\n\n\u2032\n\nZ\n\n0\n\n0\n\nT\n\ndT\n\n\u2032\n\nZ\n\nU\n\ndU \u2032 2\u03c1(S \u2032 + T \u2032 , T \u2032 + U \u2032 , U \u2032 + S \u2032 ) ,\n\n(2.22)\n\n0\n\nwhere the factor 2 may be alternatively understood as the Jacobian in the change\nof variables from (D12 , D23 , D31 ) to (S, T, U ). Finally, Eq. (2.9) translates into\nlimS,T,U\u2192\u221e \u03a6(S, T, U ) = 1, so that we find the normalization\nZ\n\ndD12 dD23 dD31 \u03c1(D12 , D23 , D31 ) = 1\n\n(2.23)\n\nD\n\nas it should. Here D denotes the domain of positive real values of D12 , D23 and D31\nsatisfying the triangular inequalities.\nLet us know discuss in more details the properties of the above continuous grandcanonical or canonical three-point functions. As a preliminary exercise, let us see how\nto recover the two-point function from the value of the three-point function upon integrating over the position of one of the points, say 3, keeping the distance D12 fixed to\n10\n\n\fa constant value. We have\nZ\ndD23 dD31 G(D12 , D23 , D31 ; \u03b1)\nD12\nZ \u221e Z \u221e Z \u221e\n=\ndS\ndT\ndU \u2202S \u2202T \u2202U F (S, T, U ; \u03b1) \u03b4(S + T \u2212 D12 )\n0\n0\n0\nZ \u221e Z \u221e\n=\ndS\ndT lim (\u2202S \u2202T F (S, T, U ; \u03b1)) \u03b4(S + T \u2212 D12 )\n0\n\nU\u2192\u221e\n\n0\n\n\u00132\nsinh(\u03b1S) sinh(\u03b1(D12 \u2212 S))\n=\ndS 18\nsinh2 (\u03b1D12 )\n0\n\u0013\n\u0012\nsinh(2\u03b1D12 )\n9\n.\n4D12 + 2D12 cosh(2\u03b1D12 ) \u2212 3\n=\n\u03b1\n8 sinh4 (\u03b1D12 )\n(2.24)\nHere D12 is a short-hand notation for the domain of allowed distances D23 , D31 at\na fixed value of D12 . Comparing this result with the value (1.9) for the continuous\ntwo-point function, we see that\nZ\n9\n\u2202\u03b1 G(D12 ; \u03b1) .\n(2.25)\ndD23 dD31 G(D12 , D23 , D31 ; \u03b1) = \u2212\n16\u03b13\nD12\nZ\n\nD12\n\n\u0012\n\nTaking \u03b1 as in Eq. (2.14) for the grand-canonical ensemble, we have \u22129/(16\u03b13 )\u2202\u03b1 = \u2212\u2202\u039b\nand we thus find the expected result that the integral of the grand-canonical three-point\nfunction over the position of one of the points reproduces precisely the grand-canonical\ntwo-point function for the remaining two points, up to the action of the trivial operator\n\u2212\u2202\u039b corresponding precisely to the marking of the third point with no prescription on\nits position.\np\nSimilarly in the canonical ensemble, taking \u03b1 = \u22123i\u03be/2, we have \u22129/(16\u03b13 )\u2202\u03b1 =\n1/(2\u03be)\u2202\u03be so that\nZ\nZ \u221e\np\n2 1\n2\n\u2202\u03be G(D12 ; \u22123i\u03be/2) = \u03c1(D12 )\ndD23 dD31 \u03c1(D12 , D23 , D31 ) = \u221a\nd\u03be \u03be e\u2212\u03be\n2\u03be\ni \u03c0 \u2212\u221e\nD12\n(2.26)\nupon integrating by part over \u03be, with \u03c1(D12 ) as in Eq. (1.11). As expected, we recover the canonical two-point function as the marginal probability density obtained by\nintegrating the canonical three-point function over the position of one of the points.\nIn order to visualize the three-point function and in view of the above result, it is\nconvenient to first fix one of the distances, say D12 to a constant value and to plot the\nconditional probability density:\n\u03c1(D23 , D31 |D12 ) \u2261\n\n\u03c1(D12 , D23 , D31 )\n.\n\u03c1(D12 )\n\n(2.27)\n\nThe quantity \u03c1(D23 , D31 |D12 )dD23 dD31 measures the infinitesimal conditional probability that point 3 be at distances from points 1 and 2 respectively in the ranges\n11\n\n\fD31\n\n\u03c1(D23 , D31| D12 )\n\n4\n\n3.5\n\nD31\n\n3\n\n2.5\n\n2\n\n1.5\n\n1\n\n0.5\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n4\n\nD23\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n4\n\nD23\n\nD31\n\u03c1(D23 , D31| D12 )\n\n4\n\nD23\n\n3.5\n\n3\n\nD31\n\n2.5\n\n2\n\n1.5\n\n1\n\n0.5\n\nD31\nD23\n\u03c1(D23 , D31| D12 )\n\n4\n\nD31\n3\n\n2\n\n1\n\n1\n\nD23\n\n2\n\n3\n\n4\n\nD23\n\nFig. 3: Left: plots of the conditional probability density \u03c1(D23 , D31 |D12 )\nfor D12 = 0.8, 1.5 and 3.0, from top to bottom. Right: the corresponding\ncontour plots, where the thick lines indicate the boundary of the allowed\ndomain D12 for distances, as determined by the triangular inequalities.\nFor the first (small enough) two values of D12 , the density is maximal for\nD23 = D31 \u223c 1.5. For the larger value D12 = 3.0, the density becomes\nelongated and squeezed along the boundary line D23 + D31 = D12 .\n12\n\n\f[D23 , D23 + dD23 ] and [D31 , D31 + dD31 ], given that the distance between 1 and 2 is\nD12 . This conditional probability density may then be plotted for various values of D12 ,\nas illustrated in Fig. 3, where a number of properties of the three-point function can be\nobserved.\nFirst, the three-point function vanishes at the boundary of the domain D12 , namely\nwhen the three points are aligned. It also vanishes when the distances from point 3 to\npoints 1 and 2 tends to infinity. The probability density is maximal when D23 and D31\nare both equal to a particular value Dmax , depending on D12 . For small enough D12\n(less than \u223c 3 or so), this preferred value is roughly independent of D12 and comparable\nto the maximum of the two-point function \u03c1(D), namely Dmax \u223c 1.5. For larger D12 ,\nthe triangular inequalities impose that Dmax \u2265 D12 /2 so that the value of Dmax must\nincrease. In this case, the density profile becomes squeezed and elongated along the\nboundary line D23 + D31 = D12 of the domain D12 with, as we shall see below, a width\n\u22121/3\nof order D12 at large D12 .\n2.3. Limiting behaviors\nThe conditional probability density \u03c1(D23 , D31 |D12 ) has interesting limiting behaviors whenever D12 becomes small or large. For D12 \u2192 0, taking S = \u03c3D12 and\nT = \u03c4 D12 , we find that\n1\n2 \u2202\u03c3 \u2202\u03c4 \u2202U F (\u03c3D12 , \u03c4 D12 , U ; \u03b1)\n2D12\n2\n9D12\n\u03c3 2 \u03c4 2 (\u03c3 2 + 4\u03c3\u03c4 + \u03c4 2 )\n3\n=\nG(U ; \u03b1) + O(D12\n),\n4\n2\n(\u03c3 + \u03c4 )\n(2.28)\nwhere G(U ; \u03b1) is the two-point function, as given by Eq. (1.9). Taking \u03c3 + \u03c4 = 1 and\n3\nusing the small D12 behavior \u03c1(D12 ) \u223c (3/7)D12\n, we deduce that\n\u0001\nG (\u03c3+\u03c4 )D12 , \u03c4 D12 + U, \u03c3D12 + U ; \u03b1 =\n\n\u0001\n\u03c1 (1 \u2212 \u03c3)D12 + U, \u03c3D12 + U |D12 \u223c\n\n\u0001\n1\n\u00d7 \u03c1(U ) \u00d7 21\u03c3 2 (1 \u2212 \u03c3)2 1 + 2\u03c3(1 \u2212 \u03c3) (2.29)\n2D12\n\nin terms of the canonical two-point function \u03c1(U ). Writing U = (D23 + D31 \u2212 D12 )/2\nand \u03c3 = (1 + \u03c9)/2 with \u03c9 = (D31 \u2212 D23 )/D12 , this equation may alternatively be\nwritten as\n\u0013\n\u0012\n\u0013\n\u0012\n1\nD31 \u2212 D23\nD23 + D31 \u2212 D12\n\u03c1(D23 , D31 |D12 ) \u223c\n\u00d7\u03c8\n\u00d7\u03c1\nD12\n2\nD12\n(2.30)\n21\n2 2\n2\n(1 \u2212 \u03c9 ) (3 \u2212 \u03c9 )\nwith \u03c8(\u03c9) \u2261\n64\ninvolving a new function \u03c8(\u03c9) properly normalized to 1 when \u03c9 varies from \u22121 to 1.\nThe conditional probability density \u03c1(D23 , D31 |D12 ) therefore factorizes in the small\nD12 limit into the product of the canonical two-point function in the \"longitudinal\ndirection\" (corresponding to varying values of D23 + D31 ) and of the above probability\n13\n\n\f\u03c1(D23 , D31| D12 )\n\n\u03c1(D23 , D31| D12 )\nD31\nU\n\nU\n\n(a)\n\n\u03c9\n\n(b)\n\nD23\n\n\u03c1(D23 , D31| D12 )\n\n\u03c1(D23 , D31| D12 )\n\nU\n\nU\n\n\u03c9\n\n(c)\n\n(d)\n\n\u03c9\n\n(e)\n\n\u03c9\n\nFig. 4: The conditional probability density \u03c1(D23 , D31 |D12 ) for a small\nvalue of D12 , here D12 = 0.05 (a). The same density (b) and its\ncontour plot (c), now expressed as a function of the longitudinal variable U = (D23 + D31 \u2212 D12 )/2 and a rescaled transverse variable \u03c9 =\n(D31 \u2212 D23 )/D12 . As apparent by taking longitudinal and transverse cut\nviews along the thick lines in (c), the conditional probability factorizes\ninto the product of the two-point function \u03c1(U ) (red curve in (d)) and the\nprobability density \u03c8(\u03c9) (green curve in (e)).\n\ndensity \u03c8 in the \"transverse direction\" (corresponding to varying D31 \u2212 D23 ). This\nproperty is illustrated in Fig. 4 for a value D12 = 0.05.\nLet us now consider the case D12 \u2192 \u221e, and more precisely the limit when both S\nand T tend simultaneously to infinity (with D12 = S + T ). In this limit, we have\nG(D12 , (D12 \u2212S)+U, S +U ; \u03b1) \u223c 24\u03b1e\u2212\u03b1(2D12 +5U) sinh2 (\u03b1U ) (3 cosh(\u03b1U )+19 sinh(\u03b1U ))\n(2.31)\nwhile the grand-canonical two-point function behaves as\nG(D12 ; \u03b1) \u223c 16\u03b13 e\u22122\u03b1D12 .\n14\n\n(2.32)\n\n\f\u03c1(D23 , D31| D12 )\n\n\u03c1(D23 , D31| D12 )\n\nD31\n\n\u03bd\n\n\u03bd\n\n(a)\n\nD23\n\n(b)\n\n\u03c1(D23 , D31| D12 )\n\nS\n\u03c1(D23 , D31| D12 )\n\n\u03bd\n\n\u03bd\n\nS\n\n(c)\n\n(d)\n\nS\n\n(e)\n\nS\n\nFig. 5: The conditional probability density \u03c1(D23 , D31 |D12 ) for a large\nvalue of D12 , here D12 = 10. (a). The same density (b) and its contour\nplot (c), now expressed as a function of the transverse variable S = (D12 +\nD31 \u2212 D23 )/2 and a rescaled longitudinal variable \u03bd = (9D12 )1/3 (D23 +\nD31 \u2212D12 )/2. As apparent by taking longitudinal and transverse cut views\nalong the thick lines in (c), the conditional probability factorizes into the\nproduct of the probability density \u03c6(\u03bd) (red curve in (d)) and a uniform\ndensity in the S direction (green curve in (e)).\nWe deduce that\n\u03c1(D12 \u2212 S + U, S + U |D12 )\nR\u221e\n2\nd\u03be \u03bee\u2212\u03be 24\u03b1 e\u2212\u03b1(2D12 +5U) sinh2 (\u03b1U ) (3 cosh(\u03b1U ) + 19 sinh(\u03b1U ))\n\u2212\u221e\nR\u221e\n\u223c\n,\n\u2212\u03be2 16\u03b13 e\u22122\u03b1D12\nd\u03be\n\u03bee\n\u2212\u221e\n(2.33)\np\nwith \u03b1 = \u22123i\u03be/2 . Note that this result is independent of S. Both integrals are\n2 1/3\ndominated at large D12 by their saddle point at \u03be = (3D12\n) i/2, leading to\n\u0012\n\u0013\n1\n1/3\n1/3 D23 + D31 \u2212 D12\n\u00d7 (9D12 )\n\u03c6 (9D12 )\n\u03c1(D23 , D31 |D12 ) \u223c\n2D12\n2\n(2.34)\n\u0001\n4\n2\n\u22122\u03bd\n\u22123\u03bd\nwith \u03c6(\u03bd) \u2261 sinh(\u03bd/2) 11e\n\u2212 8e\n3\n15\n\n\finvolving a new function \u03c6(\u03bd) properly normalized to 1 when \u03bd varies from 0 to \u221e.\nIn the limit of large D12 , the conditional probability density \u03c1(D23 , D31 |D12 ) therefore\nbecomes elongated and squeezed along the line D23 +D31 = D12 , with a profile given by\nthe above probability density \u03c6 in the longitudinal direction and a uniform probability\ndensity in the transverse direction. This property is illustrated in Fig. 5 for a value\n\u22121/3\nD12 = 10. Note that the extension in the longitudinal direction is of order D12 , as\nannounced.\nTo end this section, let us finally discuss the value of the three-point function\nwhenever all distances become small or large. For S, T and U small (and of the same\norder), we find the limiting behavior\n3\n\n\u03a6(S, T, U ) \u223c\n\n9 (ST U (S + T + U )) (S 2 + T 2 + U 2 + ST + T U + U S)\n,\n28\n(S + T )2 (T + U )2 (U + S)2\n\n(2.35)\n\nwhich is a homogeneous function of degree 8 of its arguments. Applying Eq. (2.21), we\ndeduce that \u03c1(D12 , D23 , D31 ) is, at small distances, a homogeneous function of degree 5\nof its arguments. Note that for a manifold of fractal dimension dF , we expect a degree\n(dF \u2212 1) + (dF \u2212 2) = 2dF \u2212 3 as the choice of point 2 at a fixed distance from point 1\nwill select a manifold of dimension dF \u2212 1 and the choice of point 3 at fixed distances\nfrom points 1 and 2 will then select a manifold of dimension dF \u2212 2. The value 5 above\nis therefore compatible with the known value dF = 4 for the fractal dimension of large\nquadrangulations.\nFinally, when D12 , D23 and D31 are large and of the same order, we have\nG(D12 , D23 , D31 ; \u03b1) \u223c 66 \u03b1 e\u2212\u03b1(D12 +D23 +D31 )\n\n(2.36)\n\nand we find the asymptotic behavior\n4/3\n3 5/3\n99\n\u03c1(D12 , D23 , D31 ) \u223c \u221a (D12 + D23 + D31 )e\u2212( 4 ) (D12 +D23 +D31 ) .\n6\n\n(2.37)\n\n3. Triply-pointed quadrangulations and well-labeled maps\nLet us now come to the derivation of our main result, as given by Eqs. (2.3) and\n(2.5). For this derivation, we shall rely on a new bijection discovered recently by Miermont between multiply-pointed quadrangulations, i.e. quadrangulations with a number,\nsay p, of marked vertices, and well-labeled maps with p faces, as will be defined below.\nThis bijection extends a well-known bijection obtained by Schaeffer [11,12] between\npointed quadrangulations and well-labeled trees (or g-trees) corresponding to the case\np = 1. In this section, we first recall the Miermont bijection and show how to use\nit to treat the case of planar triply-pointed quadrangulations with prescribed pairwise\ndistances between the three marked vertices. We then exploit these results in section\n4 to obtain explicit formulas for various generating functions, leading eventually to\nexpressions (2.3) and (2.5).\n16\n\n\f3.1. The Miermont bijection\nThe Miermont bijection works as follows. We start with a bipartite quadrangulation\nof genus h with n faces, together with a marked p-tuple of distinct vertices, hereafter\ndenoted 1, 2, . . . , p and referred to as the sources of the quadrangulation. We shall\ndenote by dij , i, j = 1, . . . , p, the distance in the quadrangulation between the sources\ni and j. For the construction below to work, we must impose that dij \u2265 2 for all i 6= j,\ni.e. no two marked vertices are immediate neighbors on the map.\nWith each source i, we furthermore associate an integer \u03c4i , hereafter referred to\nas the delay of the source i, and which will act as a penalty when measuring distances\nfrom this source. Delays are subject to the following constraints:\n|\u03c4i \u2212 \u03c4j | < dij ,\n\n1 \u2264 i 6= j \u2264 p ,\n\n\u03c4i \u2212 \u03c4j + dij is even,\n\n1 \u2264 i, j \u2264 p .\n\n(3.1)\n\nNote that delays satisfying these constraints can always be found, for instance by taking \u03c4i = 0 (respectively 1) for all sources belonging to the white (respectively black)\nsublattice of the naturally colored bipartite quadrangulation.\nGiven a quadrangulation with sources and delays as above, we may associate with\neach vertex v of the quadrangulation a label l(v) defined as\nl(v) = min (\u03c4j + dj (v)) ,\nj=1,...,p\n\n(3.2)\n\nwhere dj (v) denotes the distance in the quadrangulation from the vertex v to the source\nj. The label of any vertex is therefore the minimal value for all sources of a \"delayed\ndistance\" equal, for each source, to the actual graph distance to this source incremented\nby the delay of the source. The first condition in (3.1) ensures that the label of the\nsource i is \u03c4i (with the minimum in (3.2) reached only for j = i). Clearly, the labels of\ntwo adjacent vertices cannot differ by more than 1. Moreover, the parity of \u03c4j + dj (v)\nnecessarily changes between neighbors on a bipartite map and, from the second condition\nin (3.1), this parity is independent of j. This implies that the parity of l(v) must also\nchange between neighbors, leading to the crucial property:\n|l(v) \u2212 l(v \u2032 )| = 1\n\n(3.3)\n\nfor any pair of adjacent vertices v and v \u2032 . The faces of the quadrangulation are therefore\nof two types: simple faces with a cyclic sequence of labels around the face of the form\nl, l + 1, l + 2, l + 1 and confluent faces with a sequence of the form l, l + 1, l, l + 1.\nAs in Schaeffer's original construction, we associate with each of the n faces of the\n(now labeled) quadrangulation an edge as follows: for each simple face, we select the\nedge of type l + 2 \u2192 l + 1 encountered clockwise around the face (see Fig.6-(a)); for\neach confluent face, we draw a new edge between the two vertices labeled l + 1 (see\nFig.6-(b)).\nIt was shown by Miermont that the graph spanned by these n edges is a map that\nconnects all the original vertices but the sources, which become isolated in the process\n17\n\n\fl\n\nl+1\n\nl\n\nl+1\n\nl+1\n\nl+1\n\nl+2\n\nl\n\n(a)\n\n(b)\n\nFig. 6: The two possible types of faces according to the labels of their\nincident vertices: (a) simple faces and (b) confluent faces. With each face,\nwe associate an edge (thick line) as shown.\n(see Fig. 7 for an example). This map has moreover the same genus h as the original\nquadrangulation, and has p faces, each of them enclosing exactly one of the original\nsources and being referred to as face 1, 2, . . . , p accordingly. Keeping the labels on the\nvertices of the map, we see that, by construction, these labels vary by at most one along\nany edge of the map. Maps with integer labels satisfying this latter constraint will be\ncalled well-labeled maps. Finally, it can be shown that, for all the vertices incident to\nface i in the well-labeled map, the minimum in (3.2) is reached for j = i (and possibly\nfor some other value of j). In particular, all these vertices have a label larger than or\nequal to \u03c4i + 1, and this value is reached by at least one of them, namely:\nmin\n\nv incident to face i\n\nl(v) = \u03c4i + 1 .\n\n(3.4)\n\nIt was shown that the construction above provides a bijection between, on the one\nhand, quadrangulations of genus h with n faces, p distinguished sources and prescribed\ndelays {\u03c4i } satisfying (3.1), and on the other hand, well-labeled maps of genus h with\nn edges and p distinguished faces whose labels satisfy (3.4).\nTo recover the original quadrangulation from the well-labeled map, one can proceed\nas follows: for each face i of the map, we visit all its incident corners successively by\ngoing counterclockwise around the face. Calling \u03c4i + 1 the minimal label of vertices\nincident to face i, we then connect by an arch each corner with label l > \u03c4i + 1 to the\nfirst corner labeled l \u2212 1 encountered counterclockwise around the face (see Fig. 8 for\nan example). Corners labeled \u03c4i + 1 are finally connected by arches to an extra vertex\nlabeled \u03c4i at the center of the face i. The set of all arches forms the edges of the original\nquadrangulation and the added vertices correspond to its sources.\nAn important property of the above coding of multiply-pointed quadrangulations\nby well-labeled maps is that it keeps track of a number of distances in the original map.\nIndeed, as already mentioned, all the vertices incident to face i in the well-labeled map\n18\n\n\f2\n\n2\n\n\u03c41=0\n\n1\n\n4\n\n1\n\n4\n0\n\n1\n\n0\n2\n\n3\n\n3\n\n2\n\n3\n\n1\n\n3\n4\n\n4\n2\n\n2\n\n\u03c42=1\n\n3\n\n3\n2\n\n2\n\n\u03c43=2\n\n(a)\n\n(b)\n2\n\n1\n\n4\n\n2\n\n1\n2\n\n3\n\n3\n4\n\n3\n3\n2\n\n(c)\nFig. 7: An example (a) of triply-pointed quadrangulations where the\nmarked vertices are indicated by thick circles. Taking delays \u03c41 = 0, \u03c42 = 1\nand \u03c43 = 2 as indicated, each vertex v receives its label l(v) as defined by\n(3.2). Applying (b) the rules of Fig.6 on all the labeled faces results in a\nwell-labeled map (c) with three distinguished faces i = 1, 2, 3. As apparent\nin (c), the minimal label among vertices incident to face i is \u03c4i + 1.\ncorrespond to vertices of the original quadrangulation for which the minimum in (3.2)\nis reached for j = i. This ensures the crucial property:\ndi (v) = l(v) \u2212 \u03c4i\n\nfor v incident to face i .\n\n(3.5)\n\nFinally, the above bijection holds for prescribed values of the delays but one may\nas well consider all pairs made of a quadrangulation with p marked vertices and of a set\n19\n\n\f2\n\n2\n\n1\n\n4\n\n1\n\n4\n0\n\n1\n\n0\n2\n\n3\n\n3\n\n1\n\n2\n\n3\n\n3\n4\n\n4\n2\n\n2\n3\n\n3\n\n2\n\n2\n\n(a)\n\n(b)\n\nFig. 8: The inverse construction leading back from a well-labeled map,\nhere with p = 3 faces, to a multiply- (here triply-)pointed quadrangulation.\nAs explained in the text, calling \u03c4i +1 the minimal label of vertices incident\nto face i, an extra vertex (thick circle) with label \u03c4i is added at the center\nof each face i. Each corner with label l is connected (a) by an arch (dashed\nline) to its successor with label l \u2212 1. The set of these arches reconstructs\nthe edges of the quadrangulation (b), while the added vertices form the\nsources of the quadrangulation.\nof delays satisfying (3.1). In that case, in order to keep a finite number of configurations\nof delays, we must impose an additional condition, say for instance mini=1,...,p \u03c4i = 0.\nThe resulting configurations are clearly in bijection with well-labeled maps with p faces\nand arbitrary integer labels such that the minimal label is 1 and the delay \u03c4i associated\nwith each source i is recovered via \u03c4i = minv incident to face i l(v) \u2212 1.\n3.2. Application to triply-pointed quadrangulations\nLet us now apply the above results to the case of planar quadrangulations with\nthree distinct marked vertices, distinguished as 1, 2 and 3. Note first that a planar\nquadrangulation is automatically bipartite, as required by the above construction. We\nshall distinguish two cases of marked vertices:\n(i) the generic case where the three marked vertices are not aligned;\n(ii) the particular case where these three vertices are aligned.\nLet us first concentrate on case (i), leaving the discussion of case (ii) to the end of this\nsection. Note first that, since the three points are not aligned, their pairwise distances\ndij , 1 \u2264 i 6= j \u2264 3, are all larger than or equal to 2. Indeed, if at least one of these\ndistances, say d12 , was equal to 1, i.e. if 1 and 2 were immediate neighbors, then, from\nthe triangular inequalities, we would have |d31 \u2212 d23 | \u2264 1 and, from the bipartite nature\n20\n\n\f1\n\n1\n\n2\n\n1\n\n2\n\n2\n\n3\n\n3\n\n(a)\n\n3\n\n(b)\n\n(c)\n\nFig. 9: A planar map with three faces (a), its skeleton map (b) and its\nbackbone map (c).\n\n1\n2\n\n1\n\n3\n\n2\n\n(a)\n\n2\n3\n\n3\n\n(b)\n\n1\n2\n\n1\n\n1\n\n(c)\n\n3\n\n3\n1\n\n(f)\n\n2\n(d)\n\n2\n3\n\n(e)\n\n3\n\n1\n\n2\n(g)\n\nFig. 10: The seven possible backbones of planar maps with three faces\ndistinguished as 1, 2 and 3. It will prove useful to view backbones of type\n(b), (c) and (d) as degenerate limits of the backbone (a) when one of its\nthree edges is shrunk to a point.\nof the map, this would imply d31 = d23 + 1 or d23 = d31 + 1. In the first case, 2 would be\non a geodesic path between 1 and 3 while in the second case, 1 would be on a geodesic\npath between 2 and 3. In both cases, the three vertices would be aligned.\nHaving dij \u2265 2 for all 1 \u2264 i 6= j \u2264 3, we may therefore apply Miermont's construction with p = 3. The resulting well-labeled map is now a planar map with three\nfaces that are distinguished. Such maps can be classified as follows: it is convenient\nto view the map as made of a skeleton map decorated by a number of attached tree\ncomponents (see Fig. 9). The skeleton map is obtained by iteratively erasing all the\n21\n\n\fedges of the map which are incident to a univalent vertex until no univalent vertex is\nleft. The suppressed edges form tree components which, once attached to the skeleton,\nreproduce the original map. The skeletons themselves can be classified according to\ntheir backbone map, which is the map obtained by erasing all the bivalent vertices of\nthe skeleton and merging their incident edges into a single edge (see Fig. 9). Clearly,\nby construction, the backbones are planar maps with three (distinguished) faces and\nno univalent nor bivalent vertex. There are only a finite number of such maps, all displayed in Fig. 10. This allows to classify all well-labeled maps obtained in the Miermont\nbijection according to their underlying backbone.\nThe above classification holds for arbitrary planar maps with three (distinguished)\nfaces and makes no reference to labels or delays. For arbitrary fixed values of the delays,\nthe maps in the Miermont bijection must be equipped with labels satisfying (3.4) and\none recovers all quadrangulations with three marked vertices at pairwise distances compatible with these delays by considering all possible well-labeled maps with such labels.\nThis requires in particular to consider all possible backbones in the above classification.\nThe key point of our derivation that will allow us to keep track of all pairwise\ndistances is to impose an extra condition relating the delays at the sources to the pairwise\ndistances between these sources. In other words, we choose particular values for the\ndelays related to the pairwise distances of three marked vertices on the quadrangulation.\nThis particular choice of delays will impose extra conditions on the associated welllabeled maps that will restrict the possible choice of backbone and imply additional\nconstraints for the labels. More precisely, let us choose for the delays \u03c41 , \u03c42 and \u03c43 the\nvalues \u2212s, \u2212t, \u2212u with s, t, u as in Eq. (2.2), namely\n\u2212d12 + d23 \u2212 d31\n,\n2\n\u2212d12 \u2212 d23 + d31\n,\n\u03c42 = \u2212t =\n2\nd12 \u2212 d23 \u2212 d31\n\u03c43 = \u2212u =\n.\n2\n\n\u03c41 = \u2212s =\n\n(3.6)\n\nNote that s, t and u are strictly positive integers since the three points are not aligned,\nso that the delays are strictly negative. We have |\u03c41 \u2212 \u03c42 | = |d23 \u2212 d31 | \u2264 d12 from the\ntriangular inequality and again, since we assumed that the points are not aligned, we\ncannot have equality. This property and the same properties under cyclic permutations\nof the indices ensure that the first condition in (3.1) is satisfied. Moreover, \u03c41 \u2212\u03c42 +d12 =\n2t is even and so are the two similar quantities obtained by cyclic permutations of the\nindices, so that the second condition in (3.1) is also satisfied.\nLet us now analyze in more details the constraints on the labels of the well-labeled\nmaps that result from this particular choice of delays. First, we must impose the general\ncondition (3.4), namely that all labels of vertices incident to face 1 (respectively face\n2 and 3) be larger than or equal to 1 \u2212 s (respectively 1 \u2212 t and 1 \u2212 u), this value\nbeing reached by at least one of them. In particular, for any vertex v incident to face\n1 (respectively 2 and 3), the quantity l(v) \u2212 \u03c41 = l(v) + s (respectively l(v) + t and\n22\n\n\fl(v) + u) measures the distance from this vertex to the source 1 (respectively 2 and\n3). Let us now consider the boundary between, say faces 1 and 2, defined as the set of\nvertices and edges incident to both faces 1 and 2. Note that such boundary is part of\nthe skeleton, which is the union of all boundaries for all pairs of faces. For any vertex\non the boundary between faces 1 and 2, the quantity (l(v) + s) + (l(v) + t) = 2l(v) + d12\nmeasures the length of a particular path joining the source 1 to the source 2 and passing\nthrough v. This length must be larger than or equal to the distance d12 between 1 and\n2, which implies that l(v) \u2265 0. The same is true for vertices on the boundary between\nfaces 1 and 3 or between 2 and 3. We therefore have the crucial property that the labels\nof vertices on the skeleton are non-negative.\nNow consider a geodesic path on the quadrangulation between sources 1 and 2.\nThis path must necessarily intersect the skeleton of the well-labeled map at a vertex v1\nincident to face 1 and at a vertex v2 incident to face 2. We have then d12 = (l(v1 ) +\ns) + d(v1 , v2 ) + (l(v2 ) + t), where d(v1 , v2 ) is the distance between v1 and v2 in the\nquadrangulation. As s + t = d12 , this implies that l(v1 ) + l(v2 ) + d(v1 , v2 ) = 0, and,\nsince v1 and v2 lie on the skeleton, all these terms are non-negative. We deduce that\nd(v1 , v2 ) = 0, i.e. v1 and v2 are identical, and moreover l(v1 ) = l(v2 ) = 0. The fact that\nv1 = v2 requires that the boundary between faces 1 and 2 be non-empty, which rules\nout well-labeled maps whose backbone is of type (g) in Fig. 10. Similarly, backbones\nof type (e) and (f) are ruled out by considering a geodesic path between 2 and 3 or\nbetween 1 and 3 respectively. We are therefore left with backbones of the type (a), (b),\n(c) or (d) only.\nIn the case of a backbone of type (a), we moreover deduce that there must be\na label 0 on the boundary between 1 and 2. The same property holds of course for\nthe other boundaries too. We end up with the following constraint: each of the three\nboundaries between faces 1 and 2, 2 and 3, and 1 and 3 must contain a vertex v with\nlabel l(v) = 0. The same constraint holds in the case of a backbone of type (b), (c) or\n(d). In this case, one of the boundaries is made of a single vertex (which also belongs\nto the two other boundaries and corresponds to the four-valent vertex of the backbone\nor of the skeleton). We deduce that this vertex must have a label 0.\nTo summarize the above analysis, the well-labeled maps obtained for our particular\nchoice (3.6) of delays satisfy (see Fig. 11 for an illustration):\nmin\n\nv incident\nto face 1\n\nl(v) = 1 \u2212 s ,\n\nmin\n\nv incident\nto faces 1 and 2\n\nl(v) =\n\nmin\n\nv incident\nto face 2\n\nmin\n\nv incident\nto faces 2 and 3\n\nl(v) = 1 \u2212 t ,\nl(v) =\n\nmin\n\nmin\n\nv incident\nto face 3\n\nv incident\nto faces 3 and 1\n\nl(v) = 1 \u2212 u ,\n\nl(v) = 0 .\n\n(3.7)\n\nBy the convention that the minimum of the empty set is +\u221e, the last three conditions\nimply that any two faces have a non-empty boundary, hence the backbone is necessarily\nof type (a), (b), (c) or (d). Note also that the first three conditions are simply the\ngeneral requirement (3.4) in the Miermont bijection, while the last three are specific to\nour choice of delays. For all these conditions to be compatible, it is crucial that s, t and\nu be strictly positive.\n23\n\n\fmin l(v) = 1 \u2212 s\n\n1\n\nmin l(v) = 0\n\nmin l(v) = 1 \u2212 u\n\nmin l(v) = 1 \u2212 t\n\n2\n\n3\n\nmin l(v) = 0\n\nmin l(v) = 0\n\nFig. 11: A schematic picture of a well-labeled map whose backbone is\nof type (a) in the classification of Fig. 10, and the set of constraints on\nits labels for our special choice of delays (3.6). This constraints are \"face\nconstraints\" (in squared boxes) for the vertices incident to each face, and\n\"boundary constraints\" (in ellipses) for the vertices on the boundary between two faces (thick lines). The case of maps whose backbone is of type\n(b), (c) or (d) is obtained from this picture by simply shrinking one of the\nthree boundary lines into a single vertex.\nLet us start conversely from a well-labeled map with three (distinguished) faces\nwhose labels satisfy (3.7) for some strictly positive integer values of s, t and u. The\nlabels satisfy in particular the general condition (3.4) for delays \u03c41 = \u2212s, \u03c42 = \u2212t and\n\u03c43 = \u2212u, and applying the inverse construction discussed in section 3.1 will produce\na triply-pointed quadrangulation with three distinct sources (necessarily at a distance\nlarger than or equal to 2) and with associated delays \u2212s, \u2212t and \u2212u. Again a geodesic\npath from the source 1 to the source 2 will necessarily intersect the skeleton of the\nwell-labeled map at a vertex v1 incident to face 1 and at a vertex v2 incident to face 2,\nso that d12 \u2265 l(v1 ) + s + l(v2 ) + t \u2265 s + t. Now, from the fourth condition in (3.7),\nthere exists a vertex v at the boundary between faces 1 and 2 with label l(v) = 0 and\nthe union of a geodesic path from the source 1 to v and a geodesic path from v to the\nsource 2 forms a path from 1 to 2 of length l(v) + s + l(v) + t = s + t. We deduce that\nthe distance between the sources 1 and 2 in the quadrangulation is given by d12 = s + t,\nand similarly d23 = t + u and d31 = u + s. In particular, as s, t, and u are strictly\npositive, the sources cannot be aligned.\nTo conclude, we now have a bijection between, on the one hand, triply-pointed quadrangulations whose three marked vertices are not aligned and have prescribed pairwise\ndistances d12 , d23 and d31 , and on the other hand, well-labeled maps with three faces\n24\n\n\fmin l(v) = 1 \u2212 s\n\n1\n\nmin l(v) = 1 \u2212 t\n\n3\n\nl(v) = 0\n\n2\nmin l(v) = 0\n\nFig. 12: A schematic picture of a well-labeled map with two faces (a) and\na marked vertex 3 (big circle) as obtained from the Miermont bijection\nin the case of aligned marked vertices. For our special choice of delays,\nthe constraints on labels are two \"face constraints\" (in squared boxes) for\nthe vertices incident to each of the two faces, one \"boundary constraint\"\n(ellipse) for the vertices on the boundary between the two faces (thick\nline), and a \"vertex constraint\" that l = 0 for the vertex 3. Note that this\npicture can be considered as a degenerate limit of Fig. 11 when the two\nboundaries with face 3 reduce to a single vertex.\nwhose labels satisfy (3.7) for s, t and u related to d12 , d23 and d31 via relation (2.2).\nIt remains to discuss the case (ii) of aligned marked vertices. Let us consider the\ncase where, say 3 lies on a geodesic path between 1 and 2, i.e. d12 = d23 + d31 , or\nequivalently u = 0. In this case, as the three points are distinct, we have d12 \u2265 2 and\nwe may apply the Miermont bijection to our map, now considered as a doubly-pointed\nquadrangulation with sources 1 and 2 only, complemented by an extra marked vertex\n3 lying on a geodesic between 1 and 2. For the two sources, we again choose specific\ndelays, namely \u03c41 = \u2212s = \u2212d31 and \u03c42 = \u2212t = \u2212d23 . We have |d31 \u2212d23 | < d23 +d31 and\nd31 \u2212 d23 + d23 + d31 = 2d31 is even, so that the delays satisfy (3.1). The associated welllabeled map now has two (distinguished) faces and its skeleton is a simple loop, made of\nall vertices and edges on the boundary of faces 1 and 2 (note that the backbone in this\ncase is not strictly speaking a map as it has no vertex). The same argument as before\nshows that, for our particular choice of delays, all labels of vertices on the skeleton are\nnon-negative and at least one of them vanishes. Now the vertex 3 is necessarily incident\nto one of the two faces, say face 2. Consider then a geodesic path from 1 to 3. This\npath must meet the boundary between faces 1 and 2 at a vertex v and we have then\nd31 = l(v) + s + d3 (v) where d3 (v) is the distance from v to the vertex 3. As s = d31 ,\nwe deduce that l(v) + d3 (v) = 0 and, as both quantity are nonnegative, l(v) = 0 and\nd3 (v) = 0. The vertex 3 necessarily lies on the skeleton and has the minimum label 0.\n25\n\n\fWe therefore end up with a well-labeled map with two (distinguished) faces, with labels\nsatisfying (see Fig. 12 for an illustration)\nmin\n\nv incident\nto face 1\n\nl(v) = 1 \u2212 s ,\n\nmin\n\nv incident\nto face 2\n\nmin\n\nv incident\nto faces 1 and 2\n\nl(v) = 1 \u2212 t ,\n\nl(v) = 0 ,\n\n(3.8)\n\nand with a marked vertex 3 among those vertices of the skeleton having label 0.\nStarting conversely from a well-labeled map with two faces, and labels satisfying\n(3.8) for some strictly positive integer values of s and t, and with a marked vertex 3\non the skeleton with label 0, we can use the inverse construction to recover a quadrangulation with two sources and a marked vertex. All paths between the sources 1 and\n2 necessarily cross a vertex v on the boundary between faces 1 and 2 so their length\nis larger than (l(v) + s) + (l(v) + t), hence larger than s + t. As the marked vertex 3\nbelongs to the boundary and has label 0, it is at distance d31 = s and d23 = t from the\nsources 1 and 2 and the distance between the two sources is exactly d12 = s + t. In\nparticular, the three points are aligned with 3 lying between 1 and 2.\nTo conclude, we now have a bijection between, on the one hand, triply-pointed\nquadrangulations whose three marked vertices are aligned with, say 3 lying between 1\nand 2, and have prescribed pairwise distances d12 , d23 and d31 = d12 \u2212 d23 , and on the\nother hand, well-labeled maps with two faces whose labels satisfy (3.8) for s = d31 and\nt = d23 , and with a marked vertex with label 0 on the skeleton.\nNote finally that the case of aligned vertices is not fundamentally different from\nthe generic case of non aligned vertices. Indeed, the well-labeled map with two faces\nand a marked vertex of Fig. 12 may be viewed as a degenerate form of the generic case\nof Fig. 11 for which two of the boundaries, say that between faces 1 and 3 and that\nbetween faces 2 and 3 reduce to a single vertex, so that face 3 in practice disappears\nand its boundary reduces to the single vertex 3.\n\n4. Enumeration of triply-pointed quadrangulations\nThanks to the above bijections, enumerating triply-pointed planar quadrangulations with marked points at prescribed pairwise distances amounts to enumerating welllabeled maps having three or two faces, and satisfying (3.7) or (3.8) respectively. In\npractice, the generic case corresponds to a well-labeled map whose backbone is of type\n(a) in Fig. 10. One then recovers all the other possible cases (backbone of type (b), (c),\n(d) or aligned vertices) by simply allowing one or two of the boundaries to reduce to a\nsingle vertex.\nIn all this section, we shall consider generating functions with a weight g per edge\nof the well-labeled map, corresponding to a weight g per face of the quadrangulation.\nOur approach is as follows. In section 4.1 we recall known results about the enumeration of well-labeled trees, that is well-labeled planar maps with one face. In section 4.2\n26\n\n\fwe consider well-labeled maps with two faces, which correspond to triply-pointed quadrangulations whose marked points are aligned. Considering this simpler situation first\nallows us to introduce some definitions and derive a formula that will be instrumental\nin the next section 4.3, where we consider the general case and derive the expressions\n(2.3) and (2.5) for the three-point function. Finally section 4.4 is devoted to other applications of our formulas, here in the \"local limit\" for infinitely large quadrangulations\n(in contrast with the continuum limit studied previously).\n4.1. Generating functions for well-labeled trees\nThe first building block in our enumeration task is the generating function Ri (g)\nof well-labeled trees planted at a corner with label i and such that all labels are strictly\npositive. With this definition we clearly have Ri = 0 for i \u2264 0 while, for i > 0, Ri\nsatisfies the recursion relation\nRi =\n\n1\n,\n1 \u2212 g (Ri\u22121 + Ri + Ri+1 )\n\n(4.1)\n\nwhere by convention, we set Ri |g 0 = 1 for i > 0. This recursion relation was solved in\n[17], with the result\nRi = R\n\n[i]x [i + 3]x\n[i + 1]x [i + 2]x\n\nfor i > 0 with [i]x \u2261\n\n1 \u2212 xi\n,\n1\u2212x\n\n(4.2)\n\nwhere the quantities R and x are related to g by Eq. (1.4), and more precisely Eq. (1.5).\nAs already mentioned in the introduction, the quantities log(Ri /Ri\u22121 ) for i > 1 and\nlog(R1 ) for i = 1 can be interpreted as the generating functions for doubly-pointed\nquadrangulations with two marked vertices at distance i from each other (and counted\nwith their inverse symmetry factor). This property is a direct consequence of Schaeffer's\nbijection between pointed planar quadrangulations and well-labeled trees.\nHere, from conditions (3.7) or (3.8), we will be led to consider well-labeled trees\nplanted at a corner with some label l \u2265 0 and such that all labels be larger than, say\n1 \u2212s for some strictly positive integer value of s. The corresponding generating function\nis nothing but Rl+s , as obtained by shifting all labels on the tree by s. Note that, in\ntrees counted by Rl+s , the label 1 \u2212 s may or may not be reached.\n4.2. Generating functions for well-labeled maps with two faces\nThe second building block in our enumeration task corresponds to quadrangulations\nwith three marked aligned vertices. By the bijection of section 3, we must actually\nenumerate well-labeled maps with two faces 1 and 2, with labels satisfying (3.8), and\nwith a marked vertex on the skeleton having label 0.\nConsider such a well-labeled map. Its skeleton consists of a single loop of arbitrary\nlength m, and the sequence of labels along it, read from the marked vertex, can be\nviewed as the sequence of heights in a Motzkin path M of length m, i.e. a path going\n27\n\n\f2\n0= l0\n\n1\n\nl1 l2\n\nl\n\nlm =0\n\nl2\nl\n\nl1\n3\n\n2\n\n1\n\nl0 = lm =0\nl\n\n0\n\ng R l+s R l+t\n\nFig. 13: Illustration of the expression for the generating function\nof well-labeled maps with two faces, corresponding to triply pointedquadrangulations whose marked vertices are aligned. Opening the skeleton (thick edges) at the marked vertex 3, we obtain a chain with nonnegative labels (l0 , l1 , . . . , lm ) and with attached well-labeled trees. Since\nl0 = lm = 0, the sequence of labels along the chain forms a Motzkin path.\nIn the enumeration, each vertex with height l in the Motzkin path receives\na weight Rl+s , which counts the possible configurations of the incident\nwell-labeled tree in face 1, a weight Rl+t for the incident tree in face 2 and\na weight g for the subsequent edge on the chain.\nfrom 0 to 0 in m steps that never dips below height 0 and is made only of +1, 0 or \u22121\nsteps (see Fig. 13 for an illustration). Let us denote (0 = l0 , l1 , . . . , lm\u22121 , lm = 0) this\nsequence. The whole well-labeled map is uniquely decomposed into the skeleton and its\nattached tree components: we see that there are two well-labeled trees attached at each\nvertex of the skeleton, one surrounded by face 1 with all labels larger than 1 \u2212 s, the\nother surrounded by face 2 with all labels larger than 1 \u2212 t. The generating function for\nsuch trees are Rl+s and Rl+t respectively, where l is the label of the attachment vertex\non the skeleton. This leads to consider the generating function for Motzkin paths with\nsuch attached trees:\nXs,t \u2261\n\nX\n\nm\u22650\n\nX\n\nMotzkin paths of length m\nM=(0=l0 ,l1 ,...,lm =0)\n\nm\u22121\nY\n\ng Rlk +s Rlk +t ,\n\n(4.3)\n\nk=0\n\nwhere a weight g is attached to each step of the path (corresponding to an edge of the\nskeleton), in addition to the weight g per edge in the well-labeled trees already counted\nin Ri . Note that there is no weight attached to the last endpoint (k = m) of the path as\n28\n\n\fit should be identified with the first one (k = 0), so that we do not overcount the trees\nattached there. By convention the path of length m = 0 is counted with a weight 1.\nConversely, a Motzkin path with such attached trees can be transformed back into\na well-labeled map with two faces, but this map does not necessarily satisfy (3.8) in\ngeneral, because we have not imposed that the minimum label in face 1 (respectively\nface 2) be exactly 1 \u2212 s (respectively 1 \u2212 t). Nevertheless, we readily see that these\nglobal constraints are realized by considering the generating function:\n\u2206s \u2206t Xs,t = Xs,t \u2212 Xs\u22121,t \u2212 Xs,t\u22121 + Xs\u22121,t\u22121\n\n(4.4)\n\nwhich corresponds to subtracting the contribution of maps where the labels in face 1 are\nlarger than 2 \u2212 s = 1 \u2212 (s \u2212 1) or the labels in face 2 are larger than 2 \u2212 t = 1 \u2212 (t \u2212 1).\nIn the end, using the bijection of section 3, we find that \u2206s \u2206t Xs,t is the generating\nfunction for triply-pointed quadrangulations whose marked vertices are aligned, with\npairwise distances s, t and s + t.\nIt turns out that, with the particular form (4.2) for Ri , Xs,t has a very simple\nexpression. We indeed have the remarkable combinatorial identity:\nXs,t =\n\n[3]x [s + 1]x [t + 1]x [s + t + 3]x\n[1]x [s + 3]x [t + 3]x [s + t + 1]x\n\n(4.5)\n\nwhich holds for all nonnegative integer values of s and t. This establishes the restricted\nresult (2.6)-(2.7).\nLet us discuss how (4.5) can be proved. First, from its definition (4.3) as a sum of\nweighted Motzkin paths, Xs,t satisfies the recursion relation\nXs,t = 1 + gRs Rt Xs,t (1 + gRs+1 Rt+1 Xs+1,t+1 )\n\n(4.6)\n\nobtained by decomposing the Motzkin path according to its first step. The Motzkin\npath can be of length 0 and receives by convention the weight 1, or it can start with a\n0 or +1 step yielding a first factor gRs Rt . If it starts with a 0 step, the rest of the path\nis again a Motzkin path with generating function Xs,t . If is starts with with a step +1,\nthe rest of the path is now a path from height 1 to height 0 which, upon considering the\nfirst return at height 0, can be decomposed into a path from 1 to 1 with heights larger\nthan or equal to 1, a step down from 1 to 0 and a Motzkin path from 0 to 0. These\nthree components have respective weights Xs+1,t+1 , gRs+1 Rt+1 and Xs,t . Gathering all\nthe possibilities above leads to Eq. (4.6), which uniquely determines Xs,t for all s, t \u2265 0\nas power series in g, with Xs,t = 1 + O(g). Now it is a straightforward exercise to\ncheck that the form (4.5) of Xs,t does indeed satisfy (4.6) for Ri given by (4.2) with the\nrelation (1.4), and has the expansion Xs,t = 1 + O(g). This completes the proof.\nThe above argument does not allow to derive the explicit form (4.5) ab initio from\nits definition (4.3) but only checks a posteriori that this form matches the definition\nof Xs,t . A more constructive and historical proof of the formula (4.5) is presented in\nAppendix A where we give two methods for enumerating so-called \"quadrangulations\n29\n\n\fwith a geodesic boundary\" of length 2(s + t). Equating the two results precisely yields\nthe expression (4.5) for Xs,t .\nYet another proof is provided by the discussion in section 4.4 below, where it will\nbe shown that \u2206s \u2206t log Xs,t is the generating function for well-labeled maps with two\nfaces satisfying (3.8), but without a marked vertex on the skeleton (this induces nontrivial symmetry factors). By the Miermont bijection, with the particular choice of\ndelays \u03c41 = \u2212s and \u03c42 = \u2212t, these correspond to doubly-pointed quadrangulations\nwhere the marked vertices are at distance s + t. But the generating function for these\ndoubly-pointed quadrangulations is given by Eq.(1.1) with i = s + t, and we arrive at\nthe equality:\n\u0013\n\u0012\n\u0013\n\u0012\nRs+t\nXs,t Xs\u22121,t\u22121\n= \u2206s \u2206t log Xs,t = log\n.\n(4.7)\nlog\nRs+t\u22121\nXs,t\u22121 Xs\u22121,t\nIt is now an easy exercise to derive (4.5) from this equality using (4.2) and the initial\nvalues Xs,0 = X0,t = 1.\nFinally, let us remark that:\nlim Xs,t = 1 + x + x2 =\n\ns,t\u2192\u221e\n\nx\n.\ngR2\n\n(4.8)\n\nThus the basic quantity x can be interpreted as a generating function for Motzkin paths\nwith attached well-labeled trees with no lower bound on the labels.\n4.3. Generating functions for well-labeled maps with three faces\nWe are now ready to enumerate triply-pointed quadrangulations in the generic\ncase, corresponding to well-labeled maps with three faces 1, 2, 3 satisfying (3.7). Let us\nconsider such a well-labeled map. As discussed in section 3, its backbone is necessarily\nof one of the types (a), (b), (c) or (d) illustrated in Fig. 10.\nWe first consider the generic type (a), and denote by v and v \u2032 the two trivalent\nvertices of the backbone, say with v such that faces 1, 2, 3 appear in counterclockwise\norder around it. Then the skeleton consists of three chains connecting v to v \u2032 , corresponding to the three boundaries 1 \u2212 2, 2 \u2212 3 and 3 \u2212 1. By (3.7), the minimal label\n\u2032\non each boundary must be 0. Let us then denote by v12 (resp. v12\n) the first vertex\nwith label 0 encountered when following the boundary 1 \u2212 2 starting from v (resp. v \u2032 ).\n\u2032\n\u2032\nSimilarly we define v23 , v23\n, v31 and v31\n. We can now perform a decomposition of the\n\u2032\n\u2032\n\u2032\n, as illustrated\nwell-labeled map by cutting it at the vertices v12 , v12\n, v23 , v23\n, v31 and v31\non Fig. 14. More precisely for each cut vertex, the cutting line is drawn between the two\ncorners following immediately the two incident skeleton edges, going counterclockwise\naround the vertex. With this convention, each half of the cut vertex has one incident\nskeleton edge, and one attached well-labeled tree. In general the skeleton is split into\nfive components:\n\u2032\n\u2032\n\u2032\n- three (linear) chains connecting v12 to v12\n, v23 to v23\n, and v31 to v31\nrespectively,\n- two Y-diagrams, made of three chains connecting a central vertex (v or v \u2032 ) to\n\u2032\n\u2032\n\u2032\ndistinct endpoints (v12 , v23 , v31 or v12\n, v23\n, v31\n).\n30\n\n\fY s,t,u\nv\n\nt0\n\nfirs\n\n1\nv31\n\nv12\nv23\nv'23 3\n\n2\n\nXu,s\nv'31\n\nv'12\n\nXs,t\n\nXt,u\n\nv'\n\nY s,t,u\nFig. 14: The decomposition of a generic well-labeled map with three faces\ninto chains and Y-diagrams. We represented the skeleton of the map by\nthick lines and schematized the attached trees by blobs. The skeleton is\nthe union of the three boundaries 1 \u2212 2, 2 \u2212 3 and 3 \u2212 1 which meet at\nvertices v and v \u2032 . On each boundary, we select the vertices with label 0\n\u2032\n\u2032\n\u2032\nclosest to v and v \u2032 (denoted v12 , v12\n, v23 , v23\n, v31 and v31\nwith obvious\nconventions). We cut the map at these selected vertices as shown by the\ndashed lines. We end up with five pieces in general, namely three chains\n(in red) and two Y-diagrams (in blue). Taking into account the constraints\non the labels of the attached trees (see text), this decomposition translates\ninto the relation F (s, t, u; g) = Xs,t Xt,u Xu,s (Ys,t,u)2 .\nThere are a number of particular cases. If there is a unique vertex with label 0 on one\n\u2032\nof the boundaries, say 1 \u2212 2, then v12 = v12\n, and the corresponding linear chain can be\nseen as an isolated vertex without attached trees, i.e. it is trivial. If, say, v has label 0,\nthen v = v12 = v23 = v31 , and the corresponding Y-diagram can also be considered as\ntrivial, made of an isolated vertex without attached trees (using our convention to cut\nwithin the corners following immediately the incident skeleton edges counterclockwise,\nthe three trees attached to v go in different chains). For a backbone of type (a), we\nhave v 6= v \u2032 , hence it is not possible that both two Y-diagrams and one of the chains\nbe simultaneously trivial. Such situation however occurs when we consider degenerate\nbackbones types (b), (c), (d), in which case both two Y-diagrams and exactly one of\nthe chains are trivial, or when we consider well-labeled maps with two faces, for which\nboth two Y-diagrams and exactly two of the chains are trivial. It is then convenient to\nalso include the case of the fully trivial map reduced to a single vertex, when both two\nY-diagrams and three chains are trivial. To summarize, gathering all possible cases, an\narbitrary triply-pointed quadrangulation is in correspondence with a well-labeled map\n31\n\n\fthat itself can be decomposed into a combination of three chains and two Y-diagrams\n(possibly reduced to isolated vertices).\nLet us now investigate the constraints on the labels of attached well-labeled trees\ninherited from the first line of (3.7). It is convenient to slightly relax these conditions\nand consider well-labeled maps satisfying:\nmin\n\nv incident\nto face 1\n\nl(v) \u2265 1 \u2212 s ,\n\nmin\n\nv incident\nto face 2\n\nl(v) \u2265 1 \u2212 t ,\n\nmin\n\nv incident\nto face 3\n\nl(v) \u2265 1 \u2212 u .\n\n(4.9)\n\nWe shall call F (s, t, u; g) the generating function of such maps. Then the generating\nfunction for maps satisfying (3.7) is simply given by \u2206s \u2206t \u2206u F . With the relaxed\nconditions (4.9), the constraints on labels simply factorize into individual constraints\nfor each attached well-labeled tree.\nThe case of chains is easy: the sequence of labels along the chain between v12 and\n\u2032\nv12 , say, can be seen as a Motzkin path, and all attached trees previously surrounded\nby face 1 (resp. 2) have labels larger than 1 \u2212 s (resp. 1 \u2212 t). Upon closing the chain,\nthis is the same object as that considered in the previous section since, for non-trivial\n\u2032\nchains, there is only one attached tree at the endpoint v12 (resp. v12\n), with labels larger\nthan 1 \u2212 s (resp. 1 \u2212 t). Therefore the generating function for chains with attached\nwell-labeled trees satisfying these constraints is nothing but Xs,t , including the trivial\nchain with weight 1. By the same reasoning, upon a common cyclic permutation of\n1, 2, 3 and s, t, u, we find that the generating function for all possible chains between\n\u2032\n\u2032\nv23 and v23\n(resp. v31 and v31\n) is Xt,u (resp. Xu,s ).\nWe next need to consider the new situation of a Y-diagram, say the one containing\nv. As said above, it is made of three chains (branches) connecting the central vertex v,\nto the endpoints v12 , v23 , v31 . If v has label 0 then the Y-diagram is trivial, otherwise\nevery branch has a non-zero length, since l(v12 ) = l(v23 ) = l(v31 ) = 0. On each branch,\nthe sequence of labels can be viewed as a path going from height l(v) to 0, made only of\n+1, 0 or \u22121 steps, and not reaching height 0 before the last endpoint. On the branch to\nv12 , every intermediate vertex has two attached trees, and by (4.9) the one (within face\n1) has labels larger than 1 \u2212 s and the other (within face 2) has labels larger than 1 \u2212 t.\nThe final vertex v12 has only one attached tree with labels larger than 1 \u2212 t. Similar\nproperties are found for the other branches, upon a simultaneous cyclic permutation of\n1, 2, 3 and s, t, u. Finally v, being incident to all three faces, has three attached trees\nwith labels respectively larger than 1 \u2212 s, 1 \u2212 t and 1 \u2212 u. Let us denote by Ys,t,u\nthe generating function for Y-diagrams satisfying such constraints. This function is\ndetermined by the recursive equation:\nYs,t,u = 1 + g 3 Rs Rs+1 Rt Rt+1 Ru Ru+1 Xs+1,t+1 Xt+1,u+1 Xu+1,s+1 Ys+1,t+1,u+1 (4.10)\nwhich is derived in the same spirit as Eq.(4.6) for Xs,t . Indeed, let us consider the\nlabel of v. If l(v) = 0 then the Y-diagram is reduced to an isolated vertex with weight\n1. Otherwise l(v) \u2265 1, and we cut the Y-diagram at each first vertex with label 1\nencountered when following each branch starting from v (using the same procedure as\n32\n\n\fabove for dispatching attached trees). We then obtain four pieces : another Y-diagram\n(which is trivial iff l(v) = 1) and three chains. The Y-diagram has labels 1 on its\nendpoints, otherwise it satisfies the same constraints regarding the labels on its attached\ntrees. By decreasing all labels by 1, we find that such Y-diagrams are enumerated by\nYs+1,t+1,u+1 . The chains can be seen as paths from 1 to 0, that do not reach height\n0 before the endpoint. By cutting out the last step and decreasing all labels by 1, we\nobtain Motzkin paths enumerated by Xs+1,t+1 , Xt+1,u+1 , Xu+1,s+1 , for the respective\nendpoints v12 , v23 and v31 . Finally the last steps contribute with respective weights\ngRs+1 Rt , gRt+1 Ru and gRu+1 Rs . Collecting all contributions, Eq.(4.10) follows.\nWe found the remarkably simple form for Ys,t,u :\nYs,t,u =\n\n[s + 3]x [t + 3]x [u + 3]x [s + t + u + 3]x\n[3]x [s + t + 3]x [t + u + 3]x [u + s + 3]x\n\n(4.11)\n\nwhich can be readily checked by substituting into (4.10), and noting that it is the unique\nsolution satisfying Ys,t,u = 1 + O(g). However we do not have a more \"combinatorial\"\nderivation for this formula, similar to those mentioned in the previous section for Xs,t .\nNote that the form (4.2) for Ri itself still lacks such a combinatorial explanation. Alternatively, we may also write Ys,t,u as a sum:\nYs,t,u =\n\n\u221e\nX\n\nX\u0303l,s,t X\u0303l,t,u X\u0303l,u,s ,\n\nl=0\n\nX\u0303l,s,t\n\nxl [s + 1]x [s + 2]x [t]x [t + 3]x [2l + s + t + 3]x\n=\n,\n[s + t + 3]x [l + s + 1]x [l + s + 2]x [l + t]x [l + t + 3]x\n\n(4.12)\n\nwhere X\u0303l,s,t satisfies X\u0303l,s,t = gRs+1 Rt Xs+1,t+1 X\u0303l\u22121,s+1,t+1 , and corresponds to the\ngenerating function for branches from v to v12 where v has a prescribed label l.\nSo far we have derived the generating function for Y-diagrams containing v, however\nwe easily see that Y-diagrams containing v \u2032 have the same generating function Ys,t,u\n(which is symmetric in s, t, u). Combining the expressions for X and Y , we arrive at\nthe following expression for F (s, t, u; g):\n2\n\nF (s, t, u; g) = Xs,t Xt,u Xu,s (Ys,t,u )\n=\n\n[3]x ([s + 1]x [t + 1]x [u + 1]x [s + t + u + 3]x )\n\n2\n\n3\n\n[1]x [s + t + 1]x [s + t + 3]x [t + u + 1]x [t + u + 3]x [u + s + 1]x [u + s + 3]x\n(4.13)\nand we readily recognize (2.5). As mentioned above, the desired generating function\nfor maps satisfying (3.7) is \u2206s \u2206t \u2206u F (s, t, u; g). By the discussion of section 3, this is\nprecisely the three-point function G(d12 , d23 , d31 ; g). This completes the proof of (2.3).\n4.4. Local limit for large quadrangulations and statistics of geodesic points\nAs a final application of our formulas for triply-pointed quadrangulations, we can\nconsider the \"local limit\" of large quadrangulations, obtained by considering the canonical ensemble of quadrangulations with n faces and letting n tend to \u221e, keeping the\n33\n\n\fdistances between the marked vertices finite. As opposed to the scaling limit discussed\nin section 2.2, results in this local limit are expected to be non-universal and specific\nto quadrangulations, and would be different for other classes of maps. Again, we can\nextract the term g n of the various generating functions by contour integrals in g of\nthe type of Eq. (1.6). In the local limit of large quadrangulations, these integrals can\nbe evaluated exactly by saddle point estimates (see for instance Ref. [18] for a general\ndiscussion of this technique). By proper normalizations, our enumeration results then\ntranslate directly into average properties in canonical ensembles of simply- or doublypointed large (meaning strictly speaking with fixed size n \u2192 \u221e) quadrangulations, i.e.\nquadrangulations with one or two marked vertices, here referred to as sources (see again\nRef. [18] for a discussion on these ensembles).\nFor instance, from the explicit form (2.5), we can extract the average number\nhc(d12 , d23 , d31 )i of couples of vertices (2, 3) at finite distance d23 from each other and\nat respective distances d12 and d31 from the source (denoted 1) in the ensemble of large\nsimply-pointed quadrangulations. We find the following formula:\nhc(d12 , d23 , d31 )i = \u2206s \u2206t \u2206u f (s, t, u) , where\n\n2\n\n9\n((1 + s)(1 + t)(1 + u)(3 + s + t + u))\nf (s, t, u) =\n140 (1 + s + t)(3 + s + t)(1 + t + u)(3 + t + u)(1 + u + s)(3 + u + s)\n\u0001\n\u00d7 29 + 20(s + t + u) + 5(s2 + t2 + u2 + st + tu + us)\n\u00d7 ((st + tu + us + stu)(4 + s + t + u) \u2212 stu)\n\n(4.14)\n\nand s, t, u are related to d12 , d23 , d31 via (2.2).\nTaking u = 0, this quantity reduces to \u2206s \u2206t f (s, t, 0) with\nf (s, t, 0) =\n\n9 (1 + s)(1 + t)(3 + s + t)\n140 (3 + s)(3 + t)(1 + s + t)\n2\n\n2\n\n(4.15)\n\u0001\n\n\u00d7 st 29 + 20(s + t) + 5(s + t + st) (4 + s + t)\nand measures, in the ensemble of large simply-pointed quadrangulations, the average\nnumber of pairs made of a first vertex at distance s + t from the source and a second\nvertex lying on a geodesic path between the source and the first vertex, at distance\ns form the former. Upon dividing by the known average number Ns+t of vertices at\ndistance s +t from the source in large simply-pointed quadrangulations (see for instance\nRef. [13] for the value of Ns+t ), this gives the average number\nhc(s)is+t =\nwith Ns+t\n\n1\n\n\u2206s \u2206t f (s, t, 0) ,\nNs+t\n3\n(s + t + 1)(5(s + t)2 + 10(s + t) + 2) ,\n=\n35\n\n(4.16)\n\nof geodesic points, i.e. vertices lying on a geodesic path between the two sources, and at\ndistance s from the first one, in the ensemble of large doubly-pointed quadrangulations\n34\n\n\f<c(s)>d\n\n<c(s)>\n3\n2.5\n2\n1.5\n1\n0.5\n\n2\n\n4\n\n6\n\n8\n\ns/d\n\n(a)\n\n10\n\ns\n\n(b)\n\nFig. 15: The \"profile of geodesic points\" hc(s)id , measuring the average\nnumber c of vertices lying on a geodesic path between the two sources,\nand at distance s from the first source, in the ensemble of large doublypointed quadrangulations with the two sources at distance d from each\nother. This profile is represented in (a) versus s/d for d = 10, 100 and\n1000 (from bottom to top), for all allowed values of s. The edge of the\nprofile corresponding to values s = 1, . . . , 10 is represented versus s in (b)\nfor d = 10, 20 and 50 (lower values, ordered from bottom to top) and in\nthe limit d \u2192 \u221e (top values in red).\nwhere the two sources are at distance s + t from each other. Fixing this distance to\na constant value s + t = d and letting s vary, the \"profile of geodesic points\" hc(s)id\nversus s/d is represented in Fig. 15-(a) for d = 10, 100 and 1000. When t becomes large,\nkeeping s finite, we have\n9 s(1 + s) 4\nt\n(4.17)\nf (s, t, 0) \u223c\n28 3 + s\nand thus\n\u2206s \u2206t f (s, t, 0) \u223c\n\n9 s(5 + s)\nt3\n7 (3 + s)(2 + s)\n\n(4.18)\n\nwhich compared to the average number (3/7)t3 of vertices at a large distance (s +t) \u223c t,\ngives an average number\n3s(5 + s)\nhc(s)i\u221e =\n(4.19)\n(3 + s)(2 + s)\nof geodesic points at finite distance s from the first source when the second source is\nfar apart. This limiting form is represented in Fig. 15-(b), where it is compared with\nthe profile at finite values d = 10, 20 and 50 of the distance between the two sources.\nIn particular, far from the first source, i.e. when s becomes large, Eq. (4.19) gives an\naverage number of 3 geodesic points far away from both sources, as apparent in Fig. 15(a) and (b).\n35\n\n\fBeside its average hc(s)is+t , we have access to the full probability law for the number\nc of geodesic points. Indeed, consider triply-pointed quadrangulations where the three\nsources are aligned, with the third one lying on a geodesic path between the first two.\nAs discussed in section 3.2, these are in bijection with well-labeled maps of the type of\nFig. 12, with two faces and labels satisfying (3.8). As already discussed, these maps are\ncounted by \u2206s \u2206t Xs,t , where Xs,t accounts for the closed chain of vertices forming the\nboundary of the two faces. Now, for a fixed well-labeled map, the third marked vertex\n(vertex 3 in Fig. 12) can sit on any of the vertices of the boundary with label 0 and\nthe number of geodesic points is given by the number of such vertices. Maps whose\n(c)\nboundary has exactly c such vertices are simply enumerated by \u2206s \u2206t Xs,t , where\n(c)\nXs,t\n\n1\n=\nc\n\n\u0012\n\nXs,t \u2212 1\nXs,t\n\n\u0013c\n\n.\n\n(4.20)\n\nIndeed, the quantity (Xs,t \u22121)/Xs,t = gRs Rt (1 +gRs+1 Rt+1 Xs+1,t+1 ) is the generating\nfunction for weighted Motzkin paths having all intermediate heights strictly above 0 and\n(c)\nXs,t simply counts cyclic sequences of exactly c such paths. In particular, we have the\nconsistency relation\nX\n(c)\ncXs,t = Xs,t\n(4.21)\nc\u22651\n\nsince in Xs,t , one of the c vertices with label 0 is marked on the chain. We also have\nthe normalization\nX (c)\nXs,t = log Xs,t\n(4.22)\nc\u22651\n\nwhich allows to recover the generating function for doubly pointed maps with two\nmarked vertices at distance s + t via\n2\n\nXs,tXs\u22121,t\u22121\nXs,t\u22121 Xs\u22121,t\n\n\u0013\n\n!\n\n\u0013\nRs+t\n= log\n= log\n.\n\u2206s \u2206t log Xs,t = log\n2\nRs+t\u22121\n[s + t \u2212 1]x [s + t + 2]x\n(4.23)\nAs mentioned in section 4.2, this identity can be used to actually derive formula (4.5).\nCombining (4.20) and (4.23), we deduce that, in the canonical ensemble of doublypointed quadrangulations with n faces whose two sources are at distance s + t from each\nother, the probability ps+t;n (c, s) that there be exactly c vertices lying on geodesics\nbetween the two sources at distance s from the first one reads\n\u0012\n\n[s + t + 3]x [s + t]x\n\n\u0012\n\n(c)\n\n\u2206s \u2206t Xs,t |g n\n.\nps+t;n (c, s) =\nlog(Rs+t /Rs+t\u22121 )|g n\n\n(4.24)\n\nAgain we can consider the local limit of large quadrangulations by sending n \u2192 \u221e and\nkeeping s and t finite, leading, after extracting the g n terms by a saddle point technique,\n36\n\n\fto a probability\n1\n\nf (s, t, 0)\nps+t (c, s) =\n\u2206s \u2206t\nNs+t\nA2s,t\nwith As,t\n\n\u0012\n\nAs,t \u2212 1\nAs,t\n\n(s + 1)(t + 1)(s + t + 3)\n=3\n(s + 3)(t + 3)(s + t + 1)\n\n\u0013c\u22121\n\n(4.25)\n\nand with f (s, t, 0) and Ns+t as in (4.15) and (4.16). In particular, when t becomes large,\nwe find a probability\n\u0012\n\u0013c\n\u0012\n\u0013c\ns+3\n2s\ns + 2 2(s \u2212 1)\np\u221e (c, s) =\n\u2212\n(4.26)\n2\n3(s + 1)\n2\n3s\nthat there be c geodesic points at distance s from the first source if the two sources\nare far apart. Finally, far away from the first source, i.e. when s becomes large, this\nprobability reduces to\n\u0012 \u0013c\n1 2\n,\n(4.27)\np\u221e (c) =\n2 3\nwhich is the probability law for the number c of geodesic points at any fixed distance,\nfar away from the two sources.\n5. Discussion\nIn this paper, we computed the generating function for triply-pointed planar quadrangulations with three marked vertices at prescribed pairwise distances. We then\nderived its universal scaling form and analyzed its behavior in various limiting regimes.\nThe main ingredient in our derivation is the Miermont bijection between triply-pointed\nplanar quadrangulations with sources and delays and well-labeled planar maps with\nthree faces. To keep track of all distances between the marked points, we had to supplement this bijection with a particular choice of delays, resulting in a more restricted\nset of well-labeled maps amenable to a direct enumeration. The combinatorial building\nblocks in this enumeration were the already known generating function Ri for welllabeled trees and new generating functions Xs,t and Ys,t,u describing configurations of\nchains or Y-diagrams of such trees. These new functions have very simple forms (4.5)\nand (4.11), the first one being also used to address the statistics of geodesic points in\ndoubly-pointed quadrangulations. We believe that these formulas will be useful to other\nenumeration problems related to well-labeled maps, and consequently to quadrangulations, including maps with higher genus. In this respect, is it tempting to view Xs,t as\na propagator and Ys,t,u as a vertex, whose combination into Feynman diagrams builds\ngeneral well-labeled maps with a number of constraints in their labels.\nA natural question is of course that of the p-point function for p > 3, which would\nrequire to compute the generating function for multiply-pointed quadrangulations with\np sources at prescribed pairwise distances. Even if the Miermont bijection works in\n37\n\n\fthis case with arbitrary delays, it does not seem possible in general to keep track of all\npairwise distances by a proper choice of delays as we did for p = 3. Indeed, there are\nonly p free values for the delays but p(p \u2212 1)/2 pairwise distances, so that, when p > 3,\nwe cannot encode all pairwise distances in the delays. More precisely, we expect that\nour construction will work only if the p marked vertices have pairwise distances which\ncan be realized as distances between the centers of p pairwise tangent hyper-spheres in\np \u2212 1 dimensions. In other words, this requires that we can write dij = si + sj for some\nset of non-negative integers si , i = 1, . . . , p. This is clearly not a generic situation but\nit includes for instance the case of regular simplices, for which all pairwise distances are\nthe same. Multiply-pointed quadrangulations whose p sources have prescribed pairwise\ndistances of the above restricted form can be enumerated explicitly along the same\nlines as in the case p = 3. For instance, taking (s1 , s2 , s3 , s4 ) = (s, t, u, v) in the case\np = 4, one finds a generating function \u2206s \u2206t \u2206u \u2206v F (s, t, u, v; g) with F (s, t, u, v; g) =\nXs,t Xs,u Xs,v Xt,u Xt,v Xu,v Ys,t,uYs,t,v Ys,u,v Yt,u,v .\nFinally, another extension concerns classes of maps more general than quadrangulations. The discrete two-point function is known for instance for bipartite maps with\nprescribed face degrees [17] and has a similar structure as that of Eqs. (1.1) and (1.2),\nbut now with [i]x taking a more general explicit form. We expect that the Miermont\nbijection naturally extends to these maps, using the mobile rules of Ref. [13]. We further\nexpect that many of our arguments hold in this case. In particular, the derivation of\nXs,t in Appendix A should extend to this situation and lead to the same formula (4.5),\nnow with the modified [i]x . As for Ys,t,u , we had no combinatorial derivation but we\nmay still speculate that the form (4.11) remains unchanged.\nAcknowledgments: We thank G. Miermont for helpful discussions. The authors\nacknowledge support from the Geocomp project, ACI Masse de donn\u00e9es, from the ENRAGE European network, MRTN-CT-2004-5616 and from the Programme d'Action\nInt\u00e9gr\u00e9e J. Verne \"Physical applications of random graph theory\".\n\nAppendix A. Derivation of formula (4.5) for Xs,t\nWe give here a derivation of the explicit formula (4.5) for Xs,t based on the enumeration of quadrangulations with a geodesic boundary. Such objects were introduced and\nenumerated in Ref.[18] in the context of a general study of geodesic paths in quadrangulations. They can be defined as follows: a quadrangulation with a geodesic boundary\nof length 2i (i \u2265 2) is a planar map with a marked face of degree 2i and with all other\nfaces of degree four (squares), and with two marked (and distinguished) vertices incident\nto the marked face at distance i from each other in the map. This last requirement is\nequivalent to demanding that the boundary of the marked face be made of two paths\nof length i joining the marked vertices, which are moreover geodesic paths in the map.\nThese paths may possibly meet at common vertices (necessarily at the same distance\nfrom the marked vertices) or even along common edges. It is convenient, when drawing\nthis map in the plane, to choose the marked face as the external face. Ignoring this face\n38\n\n\f\u2212s\n\n0\n1\n\n1\u2212s\n\n1\n2\n\n2\n\n1\u2212s\n2\u2212s\n\n2\u2212s\n\n3\n0\n\n0\ni\u22122\n\n(a)\n\ni\u22121\n\ni\u22121\n\n1\u2212t\n\n1\u2212t\n\u2212t\n\ni\n\n(c)\n\n(b)\n1\u2212s\n\n1\n\n2\u2212s\n\nmin l(v) = 1 \u2212 s\n\n2\n\n0\n\n0\n\nmin l(v) = 1\n1\u2212t\n\ni\u22121\n\nmin l(v) = 1 \u2212 t\n\ni\n\n(d)\n\n(e)\n\nFig. 16: A schematic picture (a) of a quadrangulation with a geodesic\nboundary of length 2i. The underlying quadrangulation is symbolized by\nthe grey background. Its boundary is made of two paths of length i joining\ntwo marked vertices (thick circles) which are geodesic paths in the whole\nquadrangulation. The configuration can be transformed into a true quadrangulation without boundary by adding winding edges as in (b) or (c).\nSuch quadrangulation can be considered as a simply-pointed quadrangulation (b) whose source is the top marked vertex to which we assign a delay\n0. Performing the Miermont bijection creates a well-labeled tree whose\nstructure is displayed in (d). The quadrangulation can be considered alternatively as a doubly-pointed quadrangulation (c) whose sources are the\ntwo marked vertices to which we assign delays \u2212s and \u2212t, (with s + t = i).\nPerforming the Miermont bijection now creates a well-labeled map with\ntwo faces whose structure is displayed in (e).\n\n39\n\n\fresults in a quadrangulation having a boundary made of the two geodesic paths above\njoining the marked vertices (see Fig. 16-(a) for an illustration).\nTo enumerate these maps, we may transform them into true planar quadrangulations by adding edges in the external face linking the two boundaries of the quadrangulation. We shall refer to these boundaries as the left and right boundary by viewing\nthe quadrangulation with the first marked vertex at the top. We then connect by an\nedge winding around the quadrangulation each vertex of the right boundary at distance\nk = 2, . . . , i \u2212 1 from the first marked vertex to the vertex of the left boundary at\ndistance k \u2212 1 form the first marked vertex (see Fig. 16-(b) and (c)). As a result, the\nexternal face is divided into i \u2212 1 squares. Note that the added edges do not modify the\ndistances to the two marked vertices of any vertex in the map. In particular, the two\nboundaries remain geodesic paths.\nWe then can use the Miermont bijection to transform this quadrangulation into a\nwell-labeled map. Let us do this in two ways:\n(i) by considering the map as a pointed map with only one source (the first marked\nvertex) and delay \u03c41 = 0 (this corresponds to the original Schaeffer construction).\nThis construction will create a particular type of well-labeled maps with one face,\ni.e. a well-labeled tree referred to as a \"spine tree\" in Ref. [18].\n(ii) by considering the map as a doubly-pointed map with two sources (the two marked\nvertices) and delays \u03c41 = \u2212s and \u03c42 = \u2212t for arbitrary strictly positive values of s\nand t satisfying s + t = i. This will produce a particular type of well-labeled map\nwith two faces.\nIn the first case, the label of the vertices of the two boundaries are their distance to\nthe first marked vertex, ranging from 0 to a maximal value i for the second marked\nvertex. Applying the construction of Fig. 6, each of the added squares selects an edge\nof the right boundary (see Fig. 16-(d)). All the edges of this boundary but the first\none are selected, creating a chain of length i \u2212 1 whose vertices have labels 1, 2, . . . , i.\nThe rest of the quadrangulation gives rise to tree components that are attached only to\nthe left side of the chain. All these tree components are well-labeled trees with labels\nlarger than \u03c41 + 1 = 1, i.e. with strictly positive labels. Note that the minimal label 1 is\nautomatically attained at the first vertex of the chain. The generating function for the\nobtained well-labeled map with the above structure, counted with a weight g per edge,\nis simply:\ni\nY\n[1] [i + 3]x\ng i\u22121\nRk = g i\u22121 Ri x\n.\n(A.1)\n[3]x [i + 1]x\nk=1\n\nThanks to the Schaeffer bijection, this is also the generating function for our quadrangulations with a geodesic boundary (up to a factor g i\u22121 for the spurious added squares).\nIn the second approach, the labels of the vertices on the boundaries are, when going\naway from the first marked vertex towards the second marked vertex, \u2212s, 1\u2212s, 2\u2212s, . . . , 0\nfor the first s + 1 vertices and then \u22121, \u22122, . . . , \u2212t for the last t. Applying again the\nconstruction of Fig. 6, the first s \u2212 1 added squares select edges of the right boundary\nwhile the last t \u2212 1 ones select edges of the left boundary (see Fig. 16-(e)). The first s\n40\n\n\fedges of right boundary but the first one are selected, creating a chain of length s \u2212 1\nwhose vertices have labels 1 \u2212 s, 2 \u2212 s, . . . , 0, while the last t edges of left boundary\nbut the last one are selected, creating a chain of length t \u2212 1 whose vertices have labels\n0, \u22121, . . . , 1 \u2212 t. Finally, the s-th added square is a confluent face that gives rise to a\nwinding edge connecting the two vertices labeled 0 on the two boundaries. The rest\nof the quadrangulation creates a path joining these two vertices with label 0, and a\nnumber of tree components attached to both side of this path, to the left side of the\nchain of length s \u2212 1 and to the right side of the chain of length t \u2212 1 (see Fig. 16-(e)).\nAll these tree components are well-labeled trees with labels larger than \u03c41 + 1 = 1 \u2212 s\nor \u03c42 + 1 = 1 \u2212 t according to which face they lie in (see Fig. 16). Note again that the\nminimal label 1 \u2212 s or 1 \u2212 t is automatically attained on the chains. The generating\nfunction for the obtained labeled maps with the above structure is now\ng\n\ns+t\u22121\n\n0\nY\n\nl=1\u2212s\n\nRl+s\n\n0\nY\n\nl=1\u2212t\n\nRl+t \u00d7 Xs,t = g s+t\u22121 Rs+t\n\n[1]x [s + 3]x [1]x [t + 3]x\nXs,t , (A.2)\n[3]x [s + 1]x [3]x [t + 1]x\n\nwhere the factor Xs,t comes from the path joining the two vertices labeled 0 on the\nboundaries. Thanks to the Miermont bijection, this is also the generating function for\nour quadrangulations with a geodesic boundary of length 2(s + t) (up to a factor g s+t\u22121\nfor the spurious added squares). Taking i = s + t, the formulas (A.1) and (A.2) thus\nenumerate the same objects, hence they must be equal. Equating (A.1) and (A.2) with\ni = s + t yields\n[3] [s + 1]x [t + 1]x [s + t + 3]x\n(A.3)\nXs,t = x\n[1]x [s + 3]x [t + 3]x [s + t + 1]x\nwhich is nothing but (4.5).\n\n41\n\n\fReferences\n[1] V. Kazakov, Bilocal regularization of models of random surfaces, Phys. Lett. B150\n(1985) 282-284; F. David, Planar diagrams, two-dimensional lattice gravity and\nsurface models, Nucl. Phys. B257 (1985) 45-58; J. Ambj\u00f8rn, B. Durhuus and J.\nFr\u00f6hlich, Diseases of triangulated random surface models and possible cures, Nucl.\nPhys. B257(1985) 433-449; V. Kazakov, I. Kostov and A. Migdal Critical properties\nof randomly triangulated planar random surfaces, Phys. Lett. B157 (1985) 295-300.\n[2] W. Tutte, A Census of planar triangulations Canad. J. of Math. 14 (1962) 21-38; A\nCensus of Hamiltonian polygons Canad. J. of Math. 14 (1962) 402-417; A Census of\nslicings, Canad. J. of Math. 14 (1962) 708-722; A Census of Planar Maps, Canad.\nJ. of Math. 15 (1963) 249-271.\n[3] E. Br\u00e9zin, C. Itzykson, G. Parisi and J.-B. Zuber, Planar Diagrams, Comm. Math.\nPhys. 59 (1978) 35-51.\n[4] P. Di Francesco, P. Ginsparg and J. Zinn\u2013Justin, 2D Gravity and Random Matrices,\nPhysics Reports 254 (1995) 1-131.\n[5] G. Schaeffer, Bijective census and random generation of Eulerian planar maps, Electronic Journal of Combinatorics, vol. 4 (1997) R20; see also Conjugaison d'arbres\net cartes combinatoires al\u00e9atoires, PhD Thesis, Universit\u00e9 Bordeaux I (1998).\n[6] M. Bousquet-M\u00e9lou and G. Schaeffer, Enumeration of planar constellations, Adv.\nin Applied Math., 24 (2000) 337-368.\n[7] J. Bouttier, P. Di Francesco and E. Guitter, Census of planar maps: from the\none-matrix model solution to a combinatorial proof, Nucl. Phys. B645[PM] (2002)\n477-499, arXiv:cond-mat/0207682.\n[8] M. Bousquet-M\u00e9lou and G. Schaeffer,The degree distribution in bipartite planar\nmaps: application to the Ising model, arXiv:math.CO/0211070.\n[9] J. Bouttier, P. Di Francesco and E. Guitter. Combinatorics of Hard Particles on\nPlanar Graphs, Nucl.Phys. B655 (2003) 313-341, arXiv:cond-mat/0211168.\n[10] J. Bouttier, P. Di Francesco and E. Guitter. Combinatorics of bicubic maps with\nhard particles, J.Phys. A: Math.Gen. 38 (2005) 4529-4560, arXiv:math.CO/0501344.\n[11] M. Marcus and G. Schaeffer, Une bijection simple pour les cartes orientables, (2001),\navailable at http://www.lix.polytechnique.fr/Labo/Gilles.Schaeffer/Biblio/; see also\nG. Chapuy, M. Marcus and G. Schaeffer, A bijection for rooted maps on orientable\nsurfaces, arXiv: math-CO/0712.3649 and G. Schaeffer, Conjugaison d'arbres et\ncartes combinatoires al\u00e9atoires, PhD Thesis, Universit\u00e9 Bordeaux I (1998).\n[12] P. Chassaing and G. Schaeffer, Random Planar Lattices and Integrated SuperBrownian Excursion, Probability Theory and Related Fields 128(2) (2004) 161-212,\narXiv:math.CO/0205226.\n42\n\n\f[13] J. Bouttier, P. Di Francesco and E. Guitter. Planar maps as labeled mobiles, Elec.\nJour. of Combinatorics 11 (2004) R69, arXiv:math.CO/0405099.\n[14] J. Bouttier, P. Di Francesco and E. Guitter. Blocked edges on Eulerian maps and\nmobiles: Application to spanning trees, hard particles and the Ising model, J. Phys.\nA: Math. Theor. 40 (2007) 7411-7440, arXiv:math.CO/0702097.\n[15] J. Ambj\u00f8rn and Y. Watabiki, Scaling in quantum gravity, Nucl.Phys. B445 (1995)\n129-144.\n[16] J. Ambj\u00f8rn, J. Jurkiewicz and Y. Watabiki, On the fractal structure of twodimensional quantum gravity, Nucl.Phys. B454 (1995) 313-342.\n[17] J. Bouttier, P. Di Francesco and E. Guitter, Geodesic distance in planar graphs,\nNucl. Phys. B663[FS] (2003) 535-567, arXiv:cond-mat/0303272.\n[18] J. Bouttier and E. Guitter, Statistics of geodesics in large quadrangulations, J. Phys.\nA: Math. Theor. 41 (2008) 145001 (30pp), arXiv:math-ph/0712.2160.\n[19] G. Miermont, Tessellations of random maps of arbitrary genus, arXiv:math.PR/0712.3688.\n\n43\n\n\f"}