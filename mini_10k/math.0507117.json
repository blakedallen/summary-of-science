{"id": "http://arxiv.org/abs/math/0507117v4", "guidislink": true, "updated": "2006-04-13T08:49:28Z", "updated_parsed": [2006, 4, 13, 8, 49, 28, 3, 103, 0], "published": "2005-07-06T12:07:10Z", "published_parsed": [2005, 7, 6, 12, 7, 10, 2, 187, 0], "title": "Cohomology of colorings of cycles", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0507525%2Cmath%2F0507490%2Cmath%2F0507082%2Cmath%2F0507527%2Cmath%2F0507075%2Cmath%2F0507465%2Cmath%2F0507306%2Cmath%2F0507181%2Cmath%2F0507034%2Cmath%2F0507245%2Cmath%2F0507498%2Cmath%2F0507003%2Cmath%2F0507583%2Cmath%2F0507565%2Cmath%2F0507262%2Cmath%2F0507117%2Cmath%2F0507121%2Cmath%2F0507194%2Cmath%2F0507261%2Cmath%2F0507481%2Cmath%2F0507309%2Cmath%2F0507430%2Cmath%2F0507322%2Cmath%2F0507158%2Cmath%2F0507087%2Cmath%2F0507337%2Cmath%2F0507531%2Cmath%2F0507167%2Cmath%2F0507237%2Cmath%2F0507553%2Cmath%2F0507225%2Cmath%2F0507030%2Cmath%2F0507352%2Cmath%2F0507589%2Cmath%2F0507026%2Cmath%2F0507578%2Cmath%2F0507546%2Cmath%2F0507115%2Cmath%2F0507274%2Cmath%2F0507453%2Cmath%2F0507143%2Cmath%2F0507275%2Cmath%2F0507529%2Cmath%2F0507326%2Cmath%2F0507095%2Cmath%2F0507482%2Cmath%2F0507336%2Cmath%2F0507414%2Cmath%2F0507500%2Cmath%2F0507243%2Cmath%2F0507116%2Cmath%2F0507491%2Cmath%2F0507239%2Cmath%2F0507259%2Cmath%2F0507219%2Cmath%2F0507208%2Cmath%2F0507595%2Cmath%2F0507551%2Cmath%2F0507108%2Cmath%2F0507234%2Cmath%2F0507088%2Cmath%2F0507550%2Cmath%2F0507007%2Cmath%2F0507480%2Cmath%2F0507362%2Cmath%2F0507547%2Cmath%2F0507131%2Cmath%2F0507373%2Cmath%2F0507248%2Cmath%2F0507507%2Cmath%2F0507435%2Cmath%2F0507445%2Cmath%2F0507438%2Cmath%2F0507188%2Cmath%2F0507559%2Cmath%2F0507285%2Cmath%2F0507473%2Cmath%2F0507521%2Cmath%2F0507387%2Cmath%2F0507037%2Cmath%2F0507332%2Cmath%2F0507093%2Cmath%2F0507064%2Cmath%2F0507370%2Cmath%2F0507340%2Cmath%2F0507043%2Cmath%2F0507253%2Cmath%2F0507175%2Cmath%2F0507427%2Cmath%2F0507516%2Cmath%2F0507169%2Cmath%2F0507031%2Cmath%2F0507533%2Cmath%2F0507575%2Cmath%2F0507079%2Cmath%2F0507091%2Cmath%2F0507162%2Cmath%2F0507221%2Cmath%2F0507499%2Cmath%2F0507020%2Cmath%2F0507080&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Cohomology of colorings of cycles"}, "summary": "We compute the cohomology groups of the spaces of colorings of cycles, i.e.,\nof the prodsimplicial complexes Hom(C_m,K_n). We perform the computation first\nwith Z_2, and then with integer coefficients. The main technical tool is to use\nspectral sequences in conjunction with a detailed combinatorial analysis of a\nfamily of cubical complexes, which we call torus front complexes.\n  As an application of our method, we demonstrate how to collapse each\nconnected component of Hom(C_m,C_n) onto a garland of cubes.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0507525%2Cmath%2F0507490%2Cmath%2F0507082%2Cmath%2F0507527%2Cmath%2F0507075%2Cmath%2F0507465%2Cmath%2F0507306%2Cmath%2F0507181%2Cmath%2F0507034%2Cmath%2F0507245%2Cmath%2F0507498%2Cmath%2F0507003%2Cmath%2F0507583%2Cmath%2F0507565%2Cmath%2F0507262%2Cmath%2F0507117%2Cmath%2F0507121%2Cmath%2F0507194%2Cmath%2F0507261%2Cmath%2F0507481%2Cmath%2F0507309%2Cmath%2F0507430%2Cmath%2F0507322%2Cmath%2F0507158%2Cmath%2F0507087%2Cmath%2F0507337%2Cmath%2F0507531%2Cmath%2F0507167%2Cmath%2F0507237%2Cmath%2F0507553%2Cmath%2F0507225%2Cmath%2F0507030%2Cmath%2F0507352%2Cmath%2F0507589%2Cmath%2F0507026%2Cmath%2F0507578%2Cmath%2F0507546%2Cmath%2F0507115%2Cmath%2F0507274%2Cmath%2F0507453%2Cmath%2F0507143%2Cmath%2F0507275%2Cmath%2F0507529%2Cmath%2F0507326%2Cmath%2F0507095%2Cmath%2F0507482%2Cmath%2F0507336%2Cmath%2F0507414%2Cmath%2F0507500%2Cmath%2F0507243%2Cmath%2F0507116%2Cmath%2F0507491%2Cmath%2F0507239%2Cmath%2F0507259%2Cmath%2F0507219%2Cmath%2F0507208%2Cmath%2F0507595%2Cmath%2F0507551%2Cmath%2F0507108%2Cmath%2F0507234%2Cmath%2F0507088%2Cmath%2F0507550%2Cmath%2F0507007%2Cmath%2F0507480%2Cmath%2F0507362%2Cmath%2F0507547%2Cmath%2F0507131%2Cmath%2F0507373%2Cmath%2F0507248%2Cmath%2F0507507%2Cmath%2F0507435%2Cmath%2F0507445%2Cmath%2F0507438%2Cmath%2F0507188%2Cmath%2F0507559%2Cmath%2F0507285%2Cmath%2F0507473%2Cmath%2F0507521%2Cmath%2F0507387%2Cmath%2F0507037%2Cmath%2F0507332%2Cmath%2F0507093%2Cmath%2F0507064%2Cmath%2F0507370%2Cmath%2F0507340%2Cmath%2F0507043%2Cmath%2F0507253%2Cmath%2F0507175%2Cmath%2F0507427%2Cmath%2F0507516%2Cmath%2F0507169%2Cmath%2F0507031%2Cmath%2F0507533%2Cmath%2F0507575%2Cmath%2F0507079%2Cmath%2F0507091%2Cmath%2F0507162%2Cmath%2F0507221%2Cmath%2F0507499%2Cmath%2F0507020%2Cmath%2F0507080&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We compute the cohomology groups of the spaces of colorings of cycles, i.e.,\nof the prodsimplicial complexes Hom(C_m,K_n). We perform the computation first\nwith Z_2, and then with integer coefficients. The main technical tool is to use\nspectral sequences in conjunction with a detailed combinatorial analysis of a\nfamily of cubical complexes, which we call torus front complexes.\n  As an application of our method, we demonstrate how to collapse each\nconnected component of Hom(C_m,C_n) onto a garland of cubes."}, "authors": ["Dmitry N. Kozlov"], "author_detail": {"name": "Dmitry N. Kozlov"}, "author": "Dmitry N. Kozlov", "arxiv_comment": "25 pages, references updated", "links": [{"href": "http://arxiv.org/abs/math/0507117v4", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0507117v4", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05C15; 57M15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0507117v4", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0507117v4", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0507117v4 [math.AT] 13 Apr 2006\n\nCOHOMOLOGY OF COLORINGS OF CYCLES\nDMITRY N. KOZLOV\nAbstract. We compute the cohomology groups of the spaces of colorings of\ncycles, i.e., of the prodsimplicial complexes Hom (Cm , Kn ). We perform the\ncomputation first with Z2 , and then with integer coefficients. The main technical tool is to use spectral sequences in conjunction with a detailed combinatorial analysis of a family of cubical complexes, which we call torus front\ncomplexes.\nAs an application of our method, we demonstrate how to collapse each\nconnected component of Hom (Cm , Cn ) onto a garland of cubes.\n\n1. Introduction\nGiven a graph G, one can try to color it with n colors so that if two vertices are\nconnected by an edge, then they should get different colors. Traditionally a question\nof interest has been \"does such a coloring exist?\" If it does, then the possible\ncolorings will form a discrete set Hom 0 (G, Kn ), with no a priori given structure.\nIt has recently been realized, that it is possible to add an additional topological\nstructure to this set. This is done by considering a polyhedral complex Hom (G, Kn ),\nwhose vertices are all legal colorings, as the choice of our notations indicate, and\nwhose higher-dimensional cells encode \"commuting relations\" among the colorings.\nThe complex Hom (G, Kn ) is a special case of the Lov\u00e1sz Hom construction, which\nassociates to any pair of graphs T and G (no double edges, loops are allowed)\na polyhedral, in fact prodsimplicial, see [Ko05a], complex Hom (T, G), whose vertices\nare all graph homomorphisms from T to G and whose cells encode \"commuting\nrelations\" among these homomorphisms.\nThis paper is devoted to studying the cohomology groups of the coloring\nspace of a cycle: Hom (Cm , Kn ). When m is an odd number, the partial analysis of the topology of these spaces played a central role in the resolution of\nthe Lov\u00e1sz Conjecture, see [BK03a, BK03b, BK04, Ko05a]. Since then the\nstudy of Hom complexes in general has become a vibrant field, see additionally\n[Cs05, CK04a, CK04b, En05, Ka05, Ko04, Ko05b, Ko06, Pf05, S05a, S05b]. The\nHom complexes even appeared in topological stochastics, see [MSS03, SS05].\nThe particular information about the cohomology groups of Hom (Cm , Kn ), which\nwas needed for the proof of this conjecture consisted of computing the cohomology\ngroups, with Z2 as well as with integer coefficients, up to dimension n \u2212 2, analyzing the Z2 -action on the cohomology groups (in the case of Z-coefficients), and\ncomputing the height of the Stiefel-Whitney characteristic classes (for odd n).\nDate: September 11, 2018.\n2000 Mathematics Subject Classification. primary: 05C15, secondary 57M15.\nKey words and phrases. Hom complex, cohomology groups, Lov\u00e1sz conjecture, collapse, torus\nfront complex, spectral sequence, graph homomorphism.\nResearch supported by Swiss National Science Foundation Grant PP002-102738/1.\n1\n\n\f2\n\nDMITRY N. KOZLOV\n\nHere we present a complete computation of the groups H \u2217 (Cm , Kn ) first with Z2 ,\nand then with integer coefficients. The idea is to take the same spectral sequence\nas in [BK04], but this time to calculate the second tableau in its entirety. The main\ntechnical tool will be the detailed analysis of a certain family of combinatorially\ndefined cubical complexes {\u03a6m,n,g }, which is interesting in its own right. Once\nthese complexes are understood, we will almost have computed all the cohomology\ngroups. The two additional ingredients are the computation of signs, to handle the\ncase of the integer coefficients, as well as in-depth study of the top row entries in\nthe second tableau.\nThere are two byproducts of our investigation. First, several technical lemmas\nfrom [BK04] are special cases of our statements here. Thus, we find alternative\nsimpler ways to confirm their correctness. Second, the collapsing procedure for the\ncomplexes \u03a6m,n,g , which we call grinding for the graphic reasons which will become clear later, generalizes easily to yield a collapsing procedure for the connected\ncomponents of complexes Hom (Cm , Cn ), leading to symmetrical cores consisting of\ngarlands of higher-dimensional cubes, linked in a circle pattern by their opposite\nend vertices. Thereby we obtain a combinatorial strengthening of the earlier result\nthat these connected components are either points or are homotopy equivalent to\ncircles, see [CK04a].\nThe paper is organized as follows.\nSection 2. This section contains preliminaries on Hom and Hom+ complexes of\narbitrary graphs, as well as on independence and partial coloring complexes of\ncycles.\nSection 3. Here, we review the setup of the spectral sequence converging to the\ncohomology of Hom+ (T, G), and recall various facts about the first two tableaux,\nand the first differential of that sequence.\nSection 4. We introduce the terminology of arc pictures and see how the generators\nof the entries in the first tableau of our spectral sequence can be indexed by them.\nThis allows us to perform the first reduction in our computation of the second\ndifferential.\nSection 5. The bulk of our calculation is concentrated in this section and in\nSection 7. We rephrase the problem of computing the entries of the second tableau\nas a question of computing the homology groups of a certain family of cubical\ncomplexes, the so-called torus front complexes. We find a collapsing procedure on\nthese complexes, which we call grinding, as a result reducing them to the thin torus\nfront complexes, which turn out to be garlands of cubes linked by the opposite end\nvertices. This allows almost a complete computation of the second tableau of our\nspectral sequence with Z2 -coefficients.\nSection 6. We use our filtration to prove a formula which expresses the Euler characteristic of the Hom complex in terms of Euler characteristics of Hom+ complexes.\nSpecifically, the Euler characteristic of Hom (T, Kn ) can be expressed in terms of\nEuler characteristics of the independence complexes of induced subgraphs of T .\nThis leads to an easy proof of an older formula. Furthermore, we use the second\ntableau of our spectral sequence to derive a formula for the Euler characteristic of\nHom (Cm , Kn ).\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n3\n\nSection 7. The complete calculation of the groups H \u2217 (Hom (Cm , Kn ); Z) is finalized. Since here we are working over integers, the additional element of computing\nsigns in the differentials requires some care, as does the analysis of a few top diagonals in the spectral sequence tableaux.\nSection 8. We apply the grinding technique to demonstrate a useful collapsing of\nHom (Cm , Cn ) onto its symmetric core of thin cycle maps, which also turns our to\nbe a collection of garlands of cubes.\n2. Preliminaries\n2.1. Hom versus Hom+ .\nAll graphs considered in this paper will be finite. Let us start with the basic\ndefinitions. Let G be a graph, and let A, B \u2286 V (G), A, B 6= \u2205. We call (A, B)\na complete bipartite subgraph of G, if for any x \u2208 A, y \u2208 B, we have (x, y) \u2208 E(G),\ni.e., A \u00d7 B \u2286 E(G).\nDefinition 2.1. For arbitraryQ graphs T and G, the prodsimplicial complex\nHom (T, G) is the subcomplex of x\u2208V (T ) \u2206V (G) defined by the following condition:\nQ\n\u03c3 = x\u2208V (T ) \u03c3x \u2208 Hom (T, G) if and only if for any x, y \u2208 V (T ), if (x, y) \u2208 E(T ),\nthen (\u03c3x , \u03c3y ) is a complete bipartite subgraph of G.\nQ\nHere, x\u2208V (T ) \u2206V (G) denotes the direct product of |V (T )| identical copies of\n\u2206V (G) , indexed by the vertices of T . We refer the reader to the survey article\n[Ko05a] for all further background material on Hom complexes.\nAllowing partial graph homomorphisms yields a related simplicial complex.\nDefinition 2.2. For arbitrary graphs T and G, Hom+ (T, G) is the simplicial subcomplex of \u2217x\u2208V (T ) \u2206V (G) defined by the following condition: \u03c3 = \u2217x\u2208V (T ) \u03c3x \u2208\nHom+ (T, G) if and only if for any x, y \u2208 V (T ), if (x, y) \u2208 E(T ), and both \u03c3x and\n\u03c3y are nonempty, then (\u03c3x , \u03c3y ) is a complete bipartite subgraph of G.\nWe call Hom+ (T, G) the Hom plus complex. The plus version of the space of\nall colorings of a certain graph has a simpler topological structure, which we now\nproceed to describe.\nFor an arbitrary graph G, let the strong complement \u2201G be the graph defined by\nV (\u2201G) = V (G), and E(\u2201G) = V (G) \u00d7 V (G) \\ E(G). Let the independence complex\nInd (G) be the simplicial complex whose set of vertices is V (G), defined by the rule:\n\u03c3 \u2208 2V (G) is a simplex in Ind (G) if and only if \u03c3 is an independent set of G, i.e.,\nno two vertices in \u03c3 are connected by an edge.\nProposition 2.3. ([BK04, Proposition 3.2]).\nFor arbitrary graphs T and G, Hom+ (T, G) is isomorphic to Ind (T \u00d7 \u2201G).\nSpecializing\nProposition 2.3 to the case G = Kn , and taking into account that\n`\n\u2201Kn = ni=1 \u2201K1 , as well as the fact that for arbitrary graphs G1 and G2 we have\nthe isomorphism of simplicial complexes\n\u0010 a \u0011\nInd G1\nG2 = Ind (G1 ) \u2217 Ind (G2 ),\nwe obtain the following corollary.\n\nCorollary 2.4. For an arbitrary graph T , Hom+ (T, Kn ) is isomorphic to the n-fold\njoin Ind (T )\u2217n .\n\n\f4\n\nDMITRY N. KOZLOV\n\nIn other words, if we understand the independence complex of a graph, then we\nunderstand the plus version of its space of n-colorings for any n.\nAn important additional piece of structure, binding together the Hom and the\nHom plus constructions is that of a support map. Indeed, for any topological space\nX and a set S, there is the standard support map from the S-fold join of X to the\nappropriate simplex supp : \u2217S X \u2212\u2192 \u2206S . The map supp is simply the projection\nmap which \"forgets\" the coordinates in X.\nAs a special case, for arbitrary graphs T and G, we get the restriction map supp :\nHom+ (T, G) \u2192 \u2206V (T ) . Explicitly, for each simplex of Hom+ (T, G), \u03b7 : V (T ) \u2192\n2V (G) , the support of \u03b7 is given by supp \u03b7 = V (T ) \\ \u03b7 \u22121 (\u2205). An important property\nof the support map is that the preimage of the barycenter of \u2206V (T ) is homeomorphic\nto Hom (T, G). We shall use this heavily in the analysis of our spectral sequence.\n2.2. Cohomology of partial colorings of cycles.\nThe homotopy type of the independence complexes of cycles is well-understood.\nProposition 2.5. ([Ko99, Proposition 5.2]).\nFor any m \u2265 2, we have\n(\nS k\u22121 \u2228 S k\u22121 ,\nInd (Cm ) \u2243\nS k\u22121 ,\n\nif m = 3k;\nif m = 3k \u00b1 1.\n\nBy Corollary 2.4, we have Hom+ (Cm , Kn ) \u2243 Ind (Cm )\u2217n , hence we can derive\nan explicit description.\nCorollary 2.6. ([BK04, Corollary 4.2]).\nFor any m \u2265 2, n \u2265 3, we have\n(W\nnk\u22121\n,\n2n copies S\nHom+ (Cm , Kn ) \u2243\nS nk\u22121 ,\n\nif m = 3k;\nif m = 3k \u00b1 1.\n\nWe shall use this result later on, as our spectral sequence will be converging to\nthe cohomology groups of Hom+ (Cm , Kn ). For future reference we also record the\nfollowing observation.\nProposition 2.7. For all integers m, n, such that m \u2265 5, n \u2265 4, we have\ne i (Hom+ (Cm , Kn )) = 0, for i \u2264 m + n \u2212 4, with one exception (m, n, i) = (7, 4, 7).\nH\n\nProof. By Corollary 2.6, we just need to check that\n(2.1)\n\nnk \u2212 1 > m + n \u2212 4,\n\nwhere k = \u230a(m + 1)/3\u230b.\nIf m \u2208 {5, 6}, then k = 2, and (2.1) reduces to n + 3 > m, which is true. Thus\nwe can assume that m \u2265 7. Notice that k \u2265 (m \u2212 1)/3, hence (2.1) would follow\nfrom n(m \u2212 1)/3 + 3 > m + n. This can be rewritten as nm \u2212 3m \u2212 4n + 9 > 0,\nor, equivalently as (n \u2212 3)(m \u2212 4) > 3. Since n \u2265 4, m \u2265 7, this inequality is valid,\nwith the equality only when m = 7, n = 4.\n\u0003\n3. Setting up the spectral sequence\n3.1. Filtration induced by the support map.\nFor simplicity, we shall for now consider Z2 -coefficients. The additional issues arising in connection with switching to integer coefficients will be analyzed in Section 7.\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n5\n\nFor a function \u03b7 : V (T ) \u2192 2V (G) let \u03b7+ denote the chain in C\u2217 (Hom+ (T, G))\nconsisting of a single simplex (with coefficient 1) indexed by \u03b7; when no confu\u2217\nsion arises, we identify this chain with the simplex itself. Furthermore, let \u03b7+\ndenote the dual cochain. Following [BK04, Ko05a] we consider the Serre filtration of the cellular cochain complex C \u2217 (Hom+ (T, G); Z2 ) associated with the support map. To describe the considered filtration explicitly, define the subcomplexes\nF p = F p C \u2217 (Hom+ (T, G); Z2 ) of C \u2217 (Hom+ (T, G); Z2 ) as follows:\n\u2202 q\u22121\n\n\u2202q\n\n\u2202 q+1\n\nF p : * * * \u2212\u2192 F p,q \u2212\u2192 F p,q+1 \u2212\u2192 . . . ,\nwhere\n\nh\ni\n(q)\n\u2217\nF p,q = F p C q (Hom+ (T, G); Z2 ) = Z2 \u03b7+\n\u03b7+ \u2208 Hom+ (T, G), |supp \u03b7| \u2265 p + 1 ,\n(q)\n\n\u2202 \u2217 is the restriction of the differential in C \u2217 (Hom+ (T, G); Z2 ), and Hom+ (T, G)\ndenotes the q-th skeleton of Hom+ (T, G). The idea is to filter by the preimages of\nthe skeleta of \u2206V (T ) . The F p,q is a vector space over Z2 generated by all elementary\ncochains corresponding to q-dimensional cells, which are supported in at least p + 1\nvertices of T . Note, that this restriction defines a filtration, since the differential\ndoes not decrease the cardinality of the support set. We have\nC q (Hom+ (T, G); Z2 ) = F 0,q \u2287 F 1,q \u2287 * * * \u2287 F |V (T )|\u22121,q \u2287 F |V (T )|,q = 0.\n3.2. The 0th and the 1st tableaux.\nWe follow the treatment in [BK04, Ko05a] to describe the 0th and the 1st tableaux,\nas well as to perform a partial analysis of the second tableau.\nTo start with, as an additional piece of notations, by writing the brackets [\u2212]\nafter the name of a cochain complex, we shall mean the index shifting (to the left),\nthat is for the cochain complex C = (C \u2217 , d\u2217 ), the cochain complex C[s] = (C \u2217 [s], d\u2217 )\nis defined by C i [s] := C i+s . We sharpen reader's attention on the fact that, when\nconsidering integer coefficients, we choose not to change the sign of the differential.\nProposition 3.1. ([BK04, Proposition 3.4]).\nFor any p, we have\nM\nC \u2217 (Hom (T [S], G); R)[\u2212p].\n(3.1)\nF p /F p+1 =\nS\u2286V (T )\n|S|=p+1\n\nHence, the 0th tableau of the spectral sequence associated to the cochain complex\nfiltration F \u2217 , and converging to H p+q (Hom+ (T, G); R), is given by\nM\nC q (Hom (T [S], G); R).\n(3.2)\nE0p,q = C p+q (F p , F p+1 ) =\nS\u2286V (T )\n|S|=p+1\n\nFurthermore, using the standard facts about spectral sequence, see [Ko05a,\nMcC01], we obtain the description of the first tableau as well.\n(3.3)\n\nE1p,q = H p+q (F p , F p+1 ) =\n\nM\n\nS\u2286V (T )\n|S|=p+1\n\nH q (Hom (T [S], G); R).\n\n\f6\n\nDMITRY N. KOZLOV\n\n3.3. The first differential.\np,q\np+1,q\nAccording to the formula (3.3) the first differential dp,q\nis actually\n1 : E1 \u2212\u2192 E1\na map\nM\nM\nH q (Hom (T [S], G); Z2 ).\nH q (Hom (T [S], G); Z2 ) \u2212\u2192\nS\u2286V (T )\n|S|=p+2\n\nS\u2286V (T )\n|S|=p+1\n\nFor S2 \u2286 S1 \u2286 V (T ), let i[S1 , S2 ] : T [S2 ] \u0592\u2192 T [S1 ] be the inclusion graph\nhomomorphism. Since Hom (\u2212, G) is a contravariant functor, we have an induced\nmap iG [S1 , S2 ] : Hom (T [S1 ], G) \u2192 Hom (T [S2 ], G), and hence, an induced map on\nthe cohomology groups\ni\u2217G [S1 , S2 ] : H \u2217 (Hom (T [S2 ], G); R) \u2192 H \u2217 (Hom (T [S1 ], G); R).\nLet \u03c3 \u2208 H q (Hom (T [S], G); Z2 ), for some q, and some S \u2286 V (G). The value of the\nfirst differential on \u03c3 is then given by\n(3.4)\n\ndp,q\n1 (\u03c3) =\n\nX\n\nx\u2208V (T )\\S\n\ni\u2217G [S \u222a {x}, S](\u03c3).\n\nWe shall next detail the formula (3.4) by introducing specific generators for the\ngroups in the first tableau.\n4. Encoding cohomology generators by arc pictures\n4.1. The language of arcs.\nAn extensive notational apparatus to deal with these specific spectral sequence\ncomputations was introduced in [BK04]. It is convenient here to alter these notations somewhat, in part since our needs are different and in part to streamline the\npresentation, so, for the sake of compatibility, we shall now introduce the notations\nwhich we need.\nLet S be a proper subset of V (Cm ). We call the connected components of the\ngraph Cm [S] either singletons or arcs depending on whether they have 1 or at least\n2 vertices. For v \u2208 S we let a(S, v) denote the arc of S to which v belongs (assuming\nthis arc exists). Furthermore, for an arbitrary arc a of S, we let a = [a\u2022 , a\u2022 ]m , and\nfinally, we set b\na := [a\u2022 \u2212 1, a\u2022 + 1]m , so |b\na| = |a| + 2, if |a| \u2264 m \u2212 2. We stress\nthat the arithmetic operations as well as intervals are taken modulo m, for example\n\\\n[m, 1]m and [1, 2]m are arcs with two vertices each, while [m,\n1]m = [m \u2212 1, 2]m and\nd\n[1, 2]m = [m, 3]m . To make the formulas easier, we also think of the cycle a = Cm\nitself as an arc, in which case we use the convention a\u2022 = 1. When A is a collection\nS\nS\nb\nof\nS arcs, we set V (A) := a\u2208A a, A\u2022 := a\u2208A a\u2022 , and we let A denote the union\nb\na\n.\na\u2208A\n\nDefinition 4.1. Let t \u2265 1. A t-arc picture is a pair (S, A), where S is some\nproper subset of V (Cm ), and A is a set consisting of t different arcs of Cm [S].\nWe refer to arcs in A as marked arcs, and sometimes simply call (S, A) an arc\npicture.\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n7\n\n4.2. The corresponding cohomology generators.\nFor S \u2282 V (Cm ), such that |S| = p + 1 < m, the t-arc pictures (S, A) will index\np,t(n\u22122)\nthe generators of E1\n. To introduce these, let V = {va }a\u2208A be a set of vertex\nrepresentatives of A, i.e., va \u2208 A for each a \u2208 A. Now, set\nX\n\u2217\n(4.1)\n\u03c3VS :=\n\u03b7+\n,\n\u03b7\n\nwhere the sum is taken over all \u03b7 : V (S) \u2192 2[n] \\ {\u2205}, such that \u03b7(va ) = [n \u2212 1], for\nall a \u2208 A, and |\u03b7(w)| = 1, for all w \u2208 V (S) \\ V .\nIt is easily checked that \u03c3VS is a cocycle of Hom+ (Cm [S], Kn ). When\n\u0002 \u0003vertex\nrepresentatives move along edges, the corresponding cohomology class \u03c3VS does\nnot change, see [BK04, subsection 4.2], therefore, we may limit our attention to\nS\n\u03c3A\n. The only reason we introduce the vertex representatives at all is for the\n\u2022\n\u0002 \u0003\nlater calculations with integer coefficients. In this case, the cohomology class \u03c3VS\nchanges the sign according to a certain pattern, see Section 7 of this paper and\n[BK04, subsection 4.2].\nIt is now time to interpret the formula (3.4) in terms of our combinatorial generators. Since the differentials in the spectral sequence are induced by the differential\nin the original chain complex, we may conclude that\nX h S\u222a{w} i\n\u0002 S \u0003\n,\n\u03c3A\u2022\n(4.2)\nd1 ( \u03c3A\n)\n=\n\u2022\nw \u2208S\n/\n\nwhere the sum is taken over all w, such that adding w to S does not unite two arcs\nfrom A. Note that (4.2) is also valid when |S| = m \u2212 1, if we define \u03c3VS in the same\nway for S = [m]. It might be worthwhile to observe at this point that the set of\nb\nmarked arcs in S \u222a {w} is equal to A if and only if w \u2208\n/ A.\n4.3. The first reduction.\n\nBy the definition (or in some approaches - property) of spectral sequences, in order\nto obtain the second tableau {E2\u2217,\u2217 } we need to calculate the cohomology groups of\n\u2217,(n\u22122)t\nthe complex (E1\n, d1 ). Let (A\u2217t , d1 ) be its subcomplex generated by all classes\n\u0002 S \u0003\nb = V (Cm ).\n\u03c3A\u2022 , such that A\nProposition 4.2. ([BK04, Lemma 4.8]).\nFor all t, we have\n(4.3)\n\n\u2217,(n\u22122)t\n\nH \u2217 (E1\n\n) = H \u2217 (A\u2217t ).\n\nTo be precise, Proposition 4.2 is only stated in [BK04, Lemma 4.8] for the case\nwhen m is odd. However, the parity of m is not used in the proof there, and\ntherefore holds for all m. The proof of [BK04, Lemma 4.8] proceeds by setting\nup an auxiliary spectral sequence and then analyzing it. It is also possible to\ngive a more direct combinatorial (matching) argument by using the version of the\ndiscrete Morse theory which works for chain complexes, see [Ko05c].\nThe matchings can be done as follows: for each collection of arcs\n\u0003 such that\n\u0002 A,\nb 6= V (Cm ), choose some element x \u2208 V (Cm )\\A,\nb then, an element \u03c3 S is matched\nA\nA\u2022\ni\nh\nSxor{x}\n, where xor denotes the symmetric difference (exclusive\nwith the element \u03c3A\u2022\nor) of sets. One can then check that this matching is acyclic, in the sense of [Ko05c].\nIndeed, assume that there exists a cycle yt \u227a x1 \u227b y1 \u227a x2 \u227b * * * \u227a xt \u227b yt , where\n\n\f8\n\nDMITRY N. KOZLOV\n\nxi and yi are matched for all i = 1, . . . , t. Consider the covering relation xi \u227b yi\u22121 ,\nfor some i = 2, . . . , t. One can see that in this situation, xi must be obtained from\nyi\u22121 by adding an element to its indexing set S which extends one of the arcs in\nA. The same should hold for the covering relation yt \u227a x1 . Clearly, this leads to\na contradiction, since the total length of arcs in A does not change on the matching\nedges in the cycle (A itself does not change there), while it increases along other\nedges.\n5. Topology of the torus front complexes\n5.1. Reinterpretation of H \u2217 (A\u2217t , d1 ) using a family of cubical complexes\n{\u03a6m,n,g }.\n\nCombining Proposition 4.2 with formula (4.2) we see that to compute the second tableau of our spectral sequence we need to calculate cohomology groups of\na certain cochain complex, which we have combinatorially described by choosing\nan explicit basis of generators and then writing out the differentials in terms of\nthese generators.\nOur next idea is to reinterpret the cochain complex (A\u2217t , d1 ) as a chain complex\nwhich computes Z2 -homology of a certain cubical complex. We now proceed with\ndefining these complexes. For a natural number n \u2265 2, a circular n-set is the set of\nn points, which are equidistantly arranged on the circle of length n.\nDefinition 5.1. Let m, n, and g be natural numbers. The cubical complex \u03a6m,n,g\nis defined as follows:\n\u2022 vertices of \u03a6m,n,g are indexed by all possible selections of m elements from\nthe circular n-set, so that every two of the chosen vertices are at a distance\nat least g;\n\u2022 to index higher-dimensional cubes we take all possible collections of m sets,\nwhere each set either contains a single element of the circular n-set, or\nconsists of a pair of two elements at distance 1; the sets are requested to\nbe at minimal distance g, where the distance between two sets is defined as\nthe minimum of the distances between their elements.\n\nClearly, the dimension of a cube indexed by a collection of sets is equal to the\nnumber of 2-element sets in this collection, and one cube contains another if and\nonly if the corresponding collection of sets contains the collection of sets associated\nto the second cube. See Figure 5.1 for graphic explanation.\nFor convenience of formulations, we introduce the convention that the complex\n\u03a60,n,g is a point. One can quickly list some trivial cases of the complexes \u03a6m,n,g . To\nstart with a necessary and sufficient condition that these complexes are non-empty\nis that n \u2265 gm. The complex \u03a6n,n,1 is just a point, and more generally \u03a6m,gm,g is\na disjoint union of g points. It is not difficult to check by hand that the complex\n\u03a6m,n,g is connected whenever n > gm. The next case to consider is \u03a6m,gm+1,g ,\nthe interested reader is invited to check that \u03a6m,gm+1,g is a cycle of length gm + 1.\nFinally we remark that the dimension of \u03a6m,n,g is equal to min(m, n \u2212 gm).\nThe usefulness of this family in our context becomes apparent from the following\nproposition.\nProposition 5.2. The cochain complex (C\u2217 (\u03a6t,m,3 ; Z2 ), d) is isomorphic to the\nchain complex (A\u2217t , d1 ), with module Ci (\u03a6t,m,3 ; Z2 ) corresponding to the module\nAtm\u2212t\u2212i\u22121 , for all i.\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n9\n\n1\n2\n\n8\n\n1\n\n1\n\n2\n\n8\n\n3\n\n7\n3\n\n7\n\n3\n\n7\n4\n\n6\n4\n\n6\n\n5\n1\n\n1\n2\n\n1\n2\n\n8\n3\n\n7\n\n3\n\n7\n\n4\n\n6\n\n5\n\n1\n\n1\n2\n\n8\n\n1\n3\n\n7\n\n3\n\n7\n3\n\n7\n4\n5\n\n2\n\n8\n2\n\n8\n\n6\n\n4\n\n6\n\n5\n\n5\n\n2\n\n8\n3\n\n7\n\n4\n\n6\n\n4\n\n6\n\n5\n\n5\n\n8\n\n2\n\n8\n\n4\n\n6\n4\n\n6\n\n5\n\n5\n\nFigure 5.1. Indexing of cubes in \u03a62,8,2 .\nProof. We think of a collection of sets which indexes a cube in \u03a6t,m,3 as a collection\nof gaps between the arcs from A. This will clearly give a dimension-preserving\nbijection between the cubes of \u03a6t,m,3 and the collections of t arcs A such that\nb = V (Cn ). The condition that the distance between sets (read - gaps) is at least 3\nA\ncorresponds to the requirement that arcs must have at least 2 elements. It remains\nthe compare the differential maps: they coincide by the formula (4.2). Note that\nwe are using the fact that we are working over Z2 -coefficients.\n\u0003\nSince we know that \u03a6m,gm,g are disjoint unions of g points it is enough to assume\nfrom now on that n > gm.\n5.2. The torus front interpretation.\nLet m and n be two positive integers. An (m, n)-grid path is a directed path\non the unit orthogonal grid using only the unit basis vectors (0, 1) (northbound\nedge) and (1, 0) (eastbound edge) and connecting the point (\u2212x, x) with the point\n(m \u2212 x, n + x), for some integer x.\nDefinition 5.3. Consider the action of the group Z \u00d7 Z on the plane, where the\nstandard generators of Z \u00d7 Z act by vector translations, with vectors (\u22121, 1) and\n(m, n). An (m, n)-torus front (or sometimes simply torus front) is an orbit of\nthis (Z \u00d7 Z)-action on the set of all (m, n)-grid paths.\nThe reason for choosing the word torus here is because the quotient space of\nthe plane by this (Z \u00d7 Z)-action can be viewed as a torus, where each (m, n)-grid\npath yields a loop following the grid in the northeastern direction, see Figure 5.2.\nWe notice that every torus front has a unique representative starting from the\npoint (0, 0). It will soon become clear why we choose to consider the orbits of the\naction rather than merely considering these representatives of the orbits.\n\n\f10\n\nDMITRY N. KOZLOV\n\ntorus reflection axes\nsharp corners\n(5, 3)\n(5, 3)-torus front\n\n(0, 0)\n\nFigure 5.2. (5, 3)-path and the associated torus front.\n\nA northwestern sharp corner of a torus front is a vertex which is entered by\na northbound edge, and exited by an eastbound edge, in the same way, a southeastern sharp corner of a torus front is a vertex which is entered by an eastbound\nedge, and exited by a northbound edge.\nAn elementary flip of a torus front is either a replacement of a northwestern\nsharp corner at (a, b) by a southeastern sharp corner at (a + 1, b \u2212 1) or vice versa.\nIt may help to think a torus front as a sort of flexible snake, where the sharp corners\n(meaning the vertex in the sharp corner, together with the two adjacent edges) can\nbe flipped about (as if using ball-and-socket joints) the diagonal line connecting the\nneighbors of the sharp corner vertex.\nFinally, A flip of a torus front is a collection of non-interfering elementary flips,\ni.e., the flipped vertices are at least at distance 2 from each other, where the distance\nis measured along the front, see Figure 5.3. The picture which we have in mind is\nthat the torus front propagates through the torus by means of flips. Since we want\nflips to encode cells, we prefer to think of them as schemes of allowed elementary\nflips, rather than a concrete process of replacing one torus front with another. For\na flip F , we call those torus fronts, which can be obtained by actually performing\nall the elementary flips from F (meaning here choosing one of the two positions for\neach flipped corner), the members of F .\nDefinition 5.4. Let m, n, and g be natural numbers. The cubical complex T Fm,n,g\nis defined as follows:\n\u2022 vertices of T Fm,n,g are indexed by all possible (m, n)-torus fronts, whose\nhorizontal legs have length at least g, here the length of the leg is taken to\nbe the number of vertices it contains;\n\u2022 the higher-dimensional cubes of T Fm,n,g are indexed by all possible flips of\n(m, n)-torus fronts, whose members are vertices of T Fm,n,g .\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\nmillstones of the flip\n\n11\n\n(5, 3)\nT\n\n(0, 0)\n\nmillstones of T\n\nFigure 5.3. A flip of a (5, 3)-torus front consisting of 3 noninterfering elementary flips.\nNotice that for g = 1 there are no conditions, so T Fm,n,1 simply has all (m, n)torus fronts as vertices and all flips as higher-dimensional cubes. It is also important\nto remark that the term \"horizontal legs\" includes the legs of length 1, on other\nwords, for g > 1, it is prohibited that the torus front contains two consecutive\nnorthbound edges.\nProposition 5.5. For any natural numbers m, n, and g, the cubical complexes\n\u03a6m,n,g and T Fm,n\u2212m,g are isomorphic.\nProof. Let S \u2286 [n], |S| = m, be a vertex of \u03a6m,n,g . We can construct an (m, n\u2212m)grid path as follows. Start out from the point (0, 0), then, for all i from 1 to n\nperform the following step: either move along the northbound edge if i \u2208 S, or\nmove along the eastbound edge if i \u2208\n/ S. Since |S| = m, we will eventually reach\nthe point (m, n \u2212 m). It is obvious that this gives a bijection between vertices of\n\u03a6m,n,g and (m, n\u2212 m)-grid paths satisfying the extra restriction that the horizontal\nlegs are at least g-long.\nIt is also clear that moving along edges in \u03a6m,n,g corresponds to elementary flips\nin T Fm,n\u2212m,g . This is completely obvious as long as the flip does not concern the\nvertex (0, 0) (or, equivalently the vertex (m, n \u2212 m)). If, on the other side, the edge\nin \u03a6m,n,g indicates that we should flip the sharp corner (0, 0), then we can do that\nas well, but then we should also flip (m, n \u2212 m), and we will get an (m, n \u2212 m)-path\nfrom (1, \u22121) to (m + 1, n \u2212 m \u2212 1); translating back we will again get an (m, n \u2212 m)path from (0, 0) to (m, n \u2212 m).\nIf the flips are done on torus fronts instead of grid paths, then we do not need to\nconsider different special cases, which is the main reason why we chose to replace\nthe paths by the orbits of the (Z \u00d7 Z)-action.\n\u0003\nNote that the complex T Fm,n\u2212m,1 is isomorphic to the complex T Fn\u2212m,m,1, and\nso the complex \u03a6m,n,1 is isomorphic to the complex \u03a6n\u2212m,n,1 .\nTo understand the complexes \u03a6m,n,g satisfying n > mg, we shall study the\ncomplexes T Fm,n,g with n > m(g \u2212 1).\n\n\f12\n\nDMITRY N. KOZLOV\n\n5.3. Grinding.\nWe shall now drastically simplify complexes T Fm,n,g be means of the collapsing\nprocedure which we call grinding. To illustrate the idea, let us consider the case m =\nn = 3, g = 1. The complex T F3,3,1 (= \u03a63,6,1 ) consists of two cubes, indexed by the\nset collections {{1, 2}, {3, 4}, {5, 6}} and {{1, 6}, {2, 3}, {4, 5}}, and six additional\nsquares, see Figure 5.41. Each of these squares commands a vertex which does\nnot belong to any other maximal cell; for example, for the square indexed with\n{{1, 2}, {3}, {4, 5}} this vertex is indexed with {{2}, {3}, {4}}. Therefore, we can\ncollapse these 6 squares through these 6 vertices and the only thing left will be the\n2 cubes hanging together by their end points. This is the characteristic picture we\nshall now see in general.\n\nFigure 5.4. The complex T F3,3,1 = \u03a63,6,1 .\nLet T be an (m, n)-torus front, which we represent as an (m, n)-grid path starting\nfrom (0, 0). We associate to T two lines Mnw (T ) and Mse (T ) defined as follows:\nboth lines are parallel to the line L passing through the points (0, 0) and (m, n),\nand they both are tangential to the grid path representing T , Mnw (T ) from the\nnorthwest, and Mse (T ) from the southeast; see Figure 5.3. We call these two lines\nthe millstones of T .\nThe width of the torus front T , denoted w(T ), is the distance between the millstones\nmeasured along the line x = \u2212y. Clearly, the width cannot be less than\n\u221a\n2/2, and the minimum is achieved only when m = n by the torus front where\nnorthbound and eastbound edges alternate at every step.\nWe let Enw (T ) denote the set of the points in T \u2229 Mnw (T ) which we call northwestern extreme corners; in the same way Ese (T ) = T \u2229 Mse (T ) denotes the set of\nsoutheastern extreme corners. Extreme corners are by construction always sharp\ncorners.\n1The figure is reproduced courtesy to Eva-Maria Feichtner.\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n13\n\nAs mentioned above, each sharp corner defines an elementary flip of T , during\nwhich it remains a sharp corner, but changes orientation. If this sharp corner was\nextreme, then the\n\u221a new sharp corner would be extreme (on the opposite side) if and\nonly if w(T ) \u2264 2. Clearly, for any torus front, the elementary flips of northwestern\nextreme corners are mutually non-interfering, and therefore form one flip;\n\u221a the same\nis true for the southeastern extreme corners. Furthermore, if w(T ) > 2/2, then\nthese two sets of elementary flips do not interfere with each other either. Indeed,\nif they did, it would mean that two neighboring vertices on the torus\n\u221a front are\nextreme corners of different orientations,\nwhich\nwould\nimply\nw(T\n)\n=\n2/2.\n\u221a\nAssume now that w(T ) > 2, and consider the total flip of all extreme corners. It\nis geometrically clear, that performing any combination of these elementary flips will\nnot increase the width of the torus front, and that performing all of the northwestern\nflips, or all of the southeastern flips, simultaneously will for sure decrease it.\nAnother important observation is that if an extreme northwestern corner is\nflipped on a torus front, where all horizontal legs have length at least g, then\nall horizontal legs have length at least g in the obtained torus front as well; the\nsame is true if we flip an extreme southeastern corner. To see this, note that the\nonly time the horizontal leg could be decreased, is when one of its endpoints would\nbe flipped. Assume that the horizontal leg in question runs from vertex a to vertex\nb, that a is flipped (no loss of generality here), and denote by c the vertex which\nwe reach by the northbound edge from b. Then, the slope of the line connecting a\nwith c is 1/(g \u2212 1), and, since we assumed m(g \u2212 1) < n, we have 1/(g \u2212 1) > m/n.\nThe vertex a is flipped, hence it is a northwestern extreme corner, since c must lie\non Mnw (T ) or to the southeast of it, this implies that 1/(g \u2212 1) \u2264 m/n, yielding\na contradiction.\n5.4. Thin fronts.\nLet us now describe the cells which will, in a sense specified later, form a core of\nthe cubical complexes T Fm,n,g .\n\u221a\nDefinition\u221a5.6. We call a torus front T thin if w(T ) \u2264 2; we call it very thin\nif w(T ) < 2.\nIt is easy to construct a very thin torus front for fixed m and n: simply start\nfrom the point (0, 0) eastwards and then approximate the line connecting (0, 0) with\n(m, n) as closely as possible, staying on one side of this line (touching the line is\npermitted).\n\u221a It is clear that if the approximation is not the closest possible, then\nw(T ) \u2265 2.\nIt is also important to notice that, since we assumed m(g\u22121) < n, each horizontal\nleg in a thin torus front has length at least g, this can be proved with the same\nargument as the one we used to show that flipping all extreme corners preserves\nthat property as well.\nLet I denote the line segment connecting (0, 0) with (m, n). Counting from the\norigin in the northeastern direction, the first point on I with integer coordinates,\nother than the origin itself, is (m/ gcd(m, n), n/ gcd(m, n)), which can be achieved\nin (m + n)/ gcd(m, n) steps, (it is customary to denote the greatest common divisor\nwith simple round brackets, but since (m, n) is used to denote the point on the\nplane with these coordinates, we prefer here a somewhat longer notation).\nThe very thin torus front, which we just constructed, will have (0, 0) as a northwestern extreme corner, and after that the northwestern extreme corners will repeat\n\n\f14\n\nDMITRY N. KOZLOV\n\nwith the period of (m + n)/ gcd(m, n). From this we see that in general, to determine a very thin torus front we just need to specify, where on the part of the torus\nfront connecting two consequent northwestern extreme corners the origin will lie.\nTherefore, we conclude that there are precisely (m + n)/ gcd(m, n) very thin torus\nfronts, and that the width of any very thin (m, n)-torus front depends only on\nm and n.\nWe now extend the definition of width. For any flip F , we define its width w(F )\nto be the maximum of widths of all the torus fronts which are members of F . The\nconcepts of millstones and extreme corners can be extended to flips as well, see\nFigure 5.3.\n\u221a\nWe call a flip F thin if w(F ) \u2264 2. The thin flips play an important role in our\ncontext, as the next theorem indicates.\nTheorem 5.7. For any natural numbers m, n, and g, there exists a sequence of\ncollapses leading from the cubical complex T Fm,n,g to its subcomplex consisting of\nall thin flips.\nProof. To start with, we notice that if \u03c3 and \u03c4 are cells of T Fm,n,g , and \u03c3 is\ncontained in \u03c4 , then w(\u03c3) \u2264 w(\u03c4 ). Therefore,\u221ait is enough to describe how to\ncollapse away all the cells of a certain width (> 2), under the condition that the\ncells of larger width are already gone.\nLet us fix this width and denote it by w. To every cell \u03c3, we can associate\ncells \u03c3 \u2191 and \u03c3\u2193 as follows: \u03c3 \u2191 is obtained from \u03c3 by adding elementary flips on\nall extreme corners which do not yet have them, whereas \u03c3 \u2193 is obtained from \u03c3\nby removing the elementary flips on all extreme\n\u221a corners, where in each elementary\nflip we keep the extreme corner (since w > 2 both corners of an elementary flip\ncannot be extreme, hence this is well-defined). Note that it is possible that \u03c3 = \u03c3 \u2191 ,\nor \u03c3 = \u03c3\u2193 , but not both.\nBy our discussion above, if all horizontal legs have length at least g in vertices of\n\u03c3, then the same is true for all cells in the interval [\u03c3\u2193 , \u03c3 \u2191 ]. We also see that, by our\nconstruction, all cells in the interval [\u03c3\u2193 , \u03c3 \u2191 ] have the same width. Moreover, each\nsuch interval is isomorphic to a Boolean algebra Bt , where t is equal to the number\nof extreme corners. Clearly, the intervals [\u03c3\u2193 , \u03c3 \u2191 ] are disjoint, and the removal\nof such an interval constitutes a collapse, as long as \u03c3 \u2191 is the only maximal cell\ncontaining \u03c3\u2193 at the given time.\nThis observation allows us to do as follows: restrict the partial inclusion order to\nthe cells \u03c3 \u2191 , choose a linear extension of this partial order, and then remove intervals\n[\u03c3\u2193 , \u03c3 \u2191 ] following the linear extension in the decreasing order. The statement follows\nnow from the fact, that if \u03c4 contains \u03c3, then \u03c4 \u2191 contains \u03c3 \u2191 , since at the moment\nwhen the interval [\u03c3\u2193 , \u03c3 \u2191 ] is being removed, this will translate to: if \u03c4 contains \u03c3\u2193 ,\nthen \u03c4 \u2191 = \u03c3 \u2191 .\n\u0003\nLet us now finish our study of torus fronts by analyzing the subcomplex Thinm,n,g\nof T Fm,n,g consisting of all thin flips.\nProposition 5.8. For any natural numbers m, n, and g, such that n > m(g\u22121), the\ncomplex Thinm,n,g consists of (m + n)/ gcd(m, n) cubes, each one having dimension\ngcd(m, n), which are connected together by their diagonally opposite end vertices,\nlike a garland, to form one cycle.\nProof. Let v be a thin torus front. Flipping\na corner which is not extreme will\n\u221a\ngive a flip of width strictly larger than 2, hence this is not allowed. If, on the\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n15\n\nother hand,\u221aan extreme northwestern corner is flipped, then, the width of this flip\nis equal to 2, and flipping another extreme northwestern corner will not change\nthe width, whereas flipping any other vertex will increase it. The same holds for\nflipping extreme southeastern corners. It follows that there are two ways to get\na maximal cell adjacent to v: either by flipping all extreme northwestern corners,\nor by flipping all extreme southeastern corners.\n\u221a\nOn the other hand, if F is a maximal cell, we have w(F ) = 2.\n\u221a If we now choose\na torus front T belonging to this cell, we will also have w(T ) = 2, except for two\ncases: if in each elementary flip we either always choose northwestern path, or if we\nalways choose southeastern path. We see that each\n\u221a maximal cell contains exactly\ntwo torus front of width strictly smaller than 2, and that these are opposite\ncorners of the cube. Since Thinm,n,g is connected, the conclusion follows.\n\u0003\nWe remark, that since each cube can further individually be collapsed onto\na path connecting two opposite vertices, Theorem 5.7 and Proposition 5.8 entail\nthat T Fm,n,g can be collapsed onto a cycle.\n5.5. The implications for the cohomology groups of Hom (Cm , Kn ).\nWe now have enough information to complete the computation of the entire second\ntableau, except for the (m \u2212 1)th column, the latter containing the cohomology\ngroups of Hom (Cm , Kn ). Since the cohomology groups of Hom+ (Cm , Kn ) are nontrivial only in one dimension, we can then use this to derive almost complete information about the cohomology groups of Hom (Cm , Kn ) with Z2 -coefficients. In fact,\nwith a little extra effort we can describe H \u2217 (Hom (Cm , Kn ); Z2 ) completely already\nnow. For the sake of brevity we postpone the complete determination to Section 7\nwhere the general case of integer coefficients will be dealt with.\nBy Propositions 4.2 and 5.2, to compute the values E2p,q , for p 6= m \u2212 1, it\nis enough to calculate the Z2 -cohomology groups of the complexes \u03a6t,n,3 , for the\nrequired range of the parameter t. These, on the other hand, are isomorphic to\nH \u2217 (Thint,n\u2212t,3 ; Z2 ), this follows from Proposition 5.5, and Theorem 5.7. Finally,\nby Proposition 5.8, we see that H 0 (Thint,n\u2212t,3 ; Z2 ) = H 1 (Thint,n\u2212t,3 ; Z2 ) = Z2 ,\nand the other cohomology groups are trivial. Tracing back all the indices we obtain\nthe following answer.\nProposition 5.9. The non-zero entries E2p,q , for p 6= m \u2212 1, are the following:\nm\u2212t\u22122,t(n\u22122)\nm\u2212t\u22121,t(n\u22122)\nE2m\u22123,n\u22122 = Z2 , E2\n= E2\n= Z2 , for 2 \u2264 t \u2264 \u230a(m \u2212 1)/3\u230b,\n2m/3\u22121,m(n\u22122)/3\n0,0\nand E2 = Z2 . If additionally 3 m, then E2\n= Z32 .\n2m/3\u22121,m(n\u22122)/3\n\nThe non-zero entry E2\n= Z32 stems from the fact that the complexes \u03a6m,mg,g are disjoint unions of g points, and are not homotopy equivalent to\ncircles.\nAn alert reader may also inquire why E2m\u22122,n\u22122 = 0. If the entries in (m \u2212 1)th\ncolumn were all 0, we would of course have E2m\u22122,n\u22122 = Z2 . However, we know\nthat H m+n\u22124 (Hom+ (Cm , Kn ); Z2 ) = 0, unless (m, n) = (7, 4). Since all the entries\nto the northwest from E2m\u22122,n\u22122 , which could potentially eliminate this entry at\na later stage of the spectral sequence computation, are 0, we have no choice but to\nconclude that the map\n\u000e\nd1 : E1m\u22122,n\u22122 Im (d1 : E1m\u22123,n\u22122 \u2192 E1m\u22122,n\u22122 ) \u2212\u2192 E1m\u22121,n\u22122\n\n\f16\n\nDMITRY N. KOZLOV\n\nis injective, and so E2m\u22122,n\u22122 = 0. The case (m, n) = (7, 4) can be computed\ndirectly.\nSince the reduced cohomology of Hom+ (Cm , Kn ) is concentrated in one dimension, Proposition 5.9 allows us to compute almost all cohomology groups of\nHom (Cm , Kn ). The complete computation is done in Section 7, see Theorem 7.2 for\nfull answer.\n6. Euler characteristic formula\nWhile the cohomology groups, and even the Betti numbers of the Hom complexes are\nusually very hard to compute, the Euler characteristic may turn out to be a more\naccessible invariant.\nTo start with, let T and G be arbitrary graphs. A simple counting in the filtration which we imposed on the simplicial complex Hom+ (T, G) yields the following\nformula:\nX\n(\u22121)|S|+1 \u03c7\ne(Hom (T [S], G)),\n(6.1)\n\u03c7\ne(Hom+ (T, G)) =\n\u22056=S\u2286V (T )\n\ncompare also with Proposition 7.1.\n\nTheorem 6.1. Let T and G be arbitrary graphs, then we have\nX\n(\u22121)|S|+1 \u03c7\ne(Hom+ (T [S], G)).\n(6.2)\n\u03c7\ne(Hom (T, G)) =\n\u22056=S\u2286V (T )\n\nProof. Take the formula (6.1), and apply M\u00f6bius inversion on the Boolean algebra\nwithout the minimal element of all subsets of V (T ).\n\u0003\nTheorem 6.2. For an arbitrary graph T , we have the following formula:\nX\n(\u22121)n+|S| \u03c7\ne(Ind (T [S]))n .\n(6.3)\n\u03c7\ne(Hom (T, Kn )) =\n\u22056=S\u2286V (T )\n\nProof. By Corollary 2.4 we know that Hom+ (T, Kn ) = Ind (T )\u2217n . On the other\nhand, for any two simplicial complexes X and Y , we have \u03c7\ne(X \u2217 Y ) = \u2212\u03c7\ne(X)e\n\u03c7(Y ).\nIt follows that \u03c7\ne(Hom+ (T, Kn )) = (\u22121)n\u22121 \u03c7\ne(Ind (T ))n . Substituting this into identity (6.2) yields formula (6.3).\n\u0003\nThis gives a new proof of the following result.\n\nCorollary 6.3. ([BK03b, Proposition 4.6], [Ko05a, Proposition 3.3.4]).\nFor arbitrary positive integers m and n, such that n \u2265 m, we have\n\u0012\n\u0013\nm\u22121\nX\nm\nkn .\n(6.4)\n\u03c7\ne(Hom (Km , Kn )) =\n(\u22121)n+k+1\nk+1\nk=1\n\nProof. Since Ind (Kt ) is just a set of t points, we have \u03c7\ne(Kt ) = t \u2212 1. Substituting\nthis into equation (6.3) and noticing that the summands depend on the cardinality\nof S only, we obtain (6.4).\n\u0003\nIf we try to use formula (6.3) to compute the Euler characteristic of Hom (Cm , Kn ),\nwe will need nontrivial reductions to get a nice answer. Using Proposition 5.9 instead yields a very simple formula directly. This is reflecting very well the reduction\nwhich often occurs when passing between tableaux in the spectral sequence computation, since using the filtration on the simplicial complex Hom+ (T, G) as we did\nis the same as using the first tableau of our spectral sequence.\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n17\n\nCorollary 6.4. For arbitrary positive integers m and n, such that m \u2265 5, n \u2265 4,\nwe have\n(\n(\u22121)nk\u2212m ,\nif m = 3k \u00b1 1,\n(6.5)\n\u03c7\ne(Hom (Cm , Kn )) =\n(\u22121)nk\u2212m (2n \u2212 3), if m = 3k.\nm\u2212t\u22122,t(n\u22122)\n\nm\u2212t\u22121,t(n\u22122)\n\nProof. The entries E2\n, and E2\ncancel out in pairs, except for E2m\u22123,n\u22122 , which we can discount for, since E2m\u22122,n\u22122 already canceled\nout with E2m\u22121,n\u22122 . Thus the only nontrivial contribution comes from the Betti\nnumbers of the total complex Hom+ (Cm , Kn ), and, in case m = 3k from the entry\n2m/3\u22121,m(n\u22122)/3\nE2\n.\n\u0003\n7. Cohomology with integer coefficients\n7.1. Fixing orientations on Hom and Hom+ complexes.\nIn this section we work only with integer coefficients, so we shall suppress Z from the\nnotation. To be able to work with integer coefficients we need to choose orientations\non cells, so that the differential maps can be determined. We shall use the notation\nand we shall cite (without proofs) results from [BK04].\nLet T and G be two graphs, and let us fix an order of the vertices of T and\nof G. When convenient, we may identify vertices of T , resp. of G, with integers\n1, . . . , |V (T )|, resp. 1, . . . , |V (G)|, according to the chosen orders. First we deal\nwith the simpler, simplicial case of Hom+ (T, G). The vertices of Hom+ (T, G) are\nindexed with pairs (x, y), where x \u2208 V (T ), y \u2208 V (G), such that if x is looped, then\nso is y. We order these pairs lexicographically: (x1 , y1 ) \u227a (x2 , y2 ) if either x1 < x2 ,\nor x1 = x2 and y1 < y2 . Then, we orient each simplex of Hom+ (T, G) according to\nthis order on the vertices. We call this orientation standard, and call the oriented\nsimplex \u03b7+ . We identify this simplex with the corresponding chain, and denote the\n\u2217\n.\ndual cochain with \u03b7+\nNext, we deal with C \u2217 (Hom (T, G)). On each cell \u03b7 \u2208 Hom (T, G) we fix an orientation (also called standard) as follows: orient each simplex \u03b7(i) according to the\nchosen order on the vertices of G, then, order these simplices in the direct product\naccording to the chosen order on the vertices of T . We call this oriented cell \u03b7;\na choice of orders on the vertex sets of T and G is implicit.\nNote, that permuting the vertices of the simplex \u03b7(i) by some \u03c3 \u2208 S|\u03b7(i)|\nchanges the orientation of the cell \u03b7 by sgn \u03c3, and that swapping the simplices\nwith vertex sets \u03b7(i) and \u03b7(i + 1) in the direct product changes the orientation\nby (\u22121)dim \u03b7(i)*dim \u03b7(i+1) . Furthermore, if \u03b7\u0303 \u2208 Hom (i+1) (T, G) is obtained from\n\u03b7 \u2208 Hom (i) (T, G) by adding a vertex v to the list \u03b7(t), then [\u03b7 : \u03b7\u0303] is (\u22121)k+d\u22121 ,\nwhere k is the position of v in \u03b7\u0303(t), and d is the dimension of the product of the\nP\nsimplices with the vertex sets \u03b7(1), . . . , \u03b7(t \u2212 1), i.e., d = 1 \u2212 t + t\u22121\nj=1 |\u03b7(j)|.\n\u2217\n\u2217\n\u2217\ne\nLet C be the subcomplex of C (Hom+ (T, G)) generated by all \u03b7+ , for \u03b7 : V (T ) \u2192\n2V (G) , such that supp \u03b7 = V (T ). Set\n(7.1)\n\ne\u2217 [|V (T )| \u2212 1].\nX \u2217 (T, G) := C\n\nNote that both C i (Hom (T, G)) and X i (T, G) are free Z-modules with the bases\nP|V (T )|\n\u2217\n{\u03b7 \u2217 }\u03b7 and {\u03b7+\n}\u03b7 indexed by \u03b7 : V (T ) \u2192 2V (G) \\ {\u2205}, such that j=1 |\u03b7(j)| =\n\n\f18\n\nDMITRY N. KOZLOV\n\n|V (T )| + i. Furthermore, when \u03b7 is a cell of Hom (T, G), we set\nX\n|\u03b7(i)|.\nc(\u03b7) :=\ni is even\n1\u2264i\u2264|V (T )|\n\nFor any \u03b7 : V (T ) \u2192 2V (G) \\ {\u2205}, set \u03c1(\u03b7+ ) := (\u22121)c(\u03b7) \u03b7. The induced map \u03c1\u2217 :\nX i (T, G) \u2192 C i (Hom (T, G)) is of course an isomorphism of abelian groups for any i.\nIt turns out that more is true.\nProposition 7.1. ([BK04, Proposition 3.3]).\nFor any two graphs T , and G, the map \u03c1\u2217 : X \u2217 (T, G) \u2192 C \u2217 (Hom (T, G)) is an isomorphism of the cochain complexes.\n7.2. Signed versions of formulas for generators [\u03c3VS ].\nLet us now return to considering the cohomology classes [\u03c3VS ] defined in Subsection 4.2, though this time we are working with integer coefficients. Clearly, these\np,t(n\u22122)\n. The new feature appearing when working\nstill index the generators of E1\nover integers is that the sign of the generator may change when vertex representatives move along edges.\nThe pattern of the sign change is the same as in the case |V | = 1 described in\n[BK04]. Indeed, let S be a proper subset of [m], so that Cm [S] is a forest. Let\n(S, A) be an arc picture, and let V be the set of vertex representatives. Choose\nan arc a \u2208 A, and denote its vertex representative by v \u2208 a. Choose w \u2208 a, such\nthat (v, w) \u2208 E(Cm ), and set W := (V \u222a {w}) \\ {v}. We would like to understand\nthe sign change\nwhich occurs when v is replaced by w as the vertex representative\n`\nof a. Let A K2 denote the\n` disjoint union of copies of K2 indexed by A. We define\na graph homomorphism A K2 \u0592\u2192 Cm as follows: for the copy of K2 indexed by a\nwe choose one of the two graph homomorphisms K2 \u2192 (v, w), for the other copies\nof K2 we take any graph homomorphism mapping one of the vertices of K2 to the\nvertex representative of the corresponding arc, and mapping the other vertex of K2\nto any of the neighboring vertices in S.\n`\nThis homomorphism induces a Z2 -equivariant map H \u2217 (Hom ( A K2 , Kn )) \u2192\nH \u2217 (Hom (Cm [S], Kn )), where the Z2 -action on the left hand side is induced by the\nantipodal\naction on Q\nthe copy of K2 indexed\n`\nQ by a. On the other hand, we have\nHom ( A K2 , Kn ) \u223c\n= A Hom (K2 , Kn ) \u223c\n= A S n\u22122 and the Z2 -action on the last\nspace is the antipodal action on the factor indexed by a. Recall, that the antipodal\naction on S n changes the sign of the n-dimensional cohomology generator if and\nonly if n is even, and the same is true if we are acting on one of the factors in a direct\nproduct. Using already introduced terminology, we can take \u03c1\u2217 (\u03c3VS ) as a representative for the generator of H t(n\u22122) (Hom (Cm [S], Kn )), which we are considering. If\n(v, w) 6= (1, m), then there is no further sign change and we get\nS\n[\u03c1\u2217 (\u03c3VS )] = (\u22121)n+1 [\u03c1\u2217 (\u03c3W\n)].\n\nIf on the other hand (v, w) = (1, m), then the Z2 -action does not interchange\ntwo neighboring simplices, but the first one and the last one instead. One of these\nsimplices has dimension 0 and the other one has dimension n \u2212 2. Using the rules\nfor the sign change described in the subsection 7.1, we see that we get additional\nsign factor (\u22121)n(|A|\u22121) , since we have to swap simplices of dimension n \u2212 2 in total\n2\n|A| \u2212 1 times, and each swap yields the sign (\u22121)(n\u22122) = (\u22121)n ; we ignore the\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n19\n\nswaps involving 0-dimensional simplices since they do not influence the sign. So in\nthis case we get\nS\n[\u03c1\u2217 (\u03c3VS )] = (\u22121)n|A|+1 [\u03c1\u2217 (\u03c3W\n)].\nCombining with Proposition 7.1 we get\n\u0002 S\u0003\n\u0002 S\u0003\n,\n(7.2)\n\u03c3V = \u2212 \u03c3W\n\nif (v, w) 6= (1, m), since the swapped vertices have different parity. In case (v, w) =\n(1, m), the swapped vertices may or may not have different parity, so we have\nan additional sign factor (\u22121)nb , where b is the number of vertices in S between w\nand v. So in this case we get\n\u0002 S\u0003\n\u0002 S\u0003\n.\n(7.3)\n\u03c3V = (\u22121)n|A|+nb+n+1 \u03c3W\nNext, we look at the analog of the formulas (4.2) and [BK04, (4.7)]. Combining\nthe construction of generators \u03c3VS with the choice of orientations on Hom+ (T, Kn ),\nwe get the following formula.\n(7.4)\n\nh\ni\nX\n\u0002 \u0003\nS\u222a{w}\n,\n(\u22121)sgn (w) \u03c3V\nd1 ( \u03c3VS ) =\nw \u2208S\n/\n\nwhere the sum is taken over all w, such that adding w to S does not unite two arcs\nfrom A, and the sign (\u22121)sgn (w) is given by the formula\n(7.5)\n\nsgn (w) = |S \u2229 [w \u2212 1]| + n * |V \u2229 [w \u2212 1]|.\n\nThe same way as for Z2 -coefficients, the equation (7.4) is also valid when |S| = m\u22121.\n7.3. Completing the calculation of the second tableau.\nWe shall now do the same computation as we did in Subsection 5.5, only this time\nwith integer coefficients.\nThe first obstruction is that Proposition 5.2 may not be valid anymore, since\nwe have to take the signs into account. However, though the cochain complexes\n(A\u2217t , d1 ) and (C\u2217 (\u03a6t,m,3 ; Z), d) may not be isomorphic, the only difference is that\nsome of the incidence numbers differ by a sign.\nThe argument, using torus fronts, with which we computed H\u2217 (\u03a6t,m,3 ; Z2 ), consisted of presenting a sequence of collapses leading from T Ft,m\u2212t,3 to Thint,m\u2212t,3 .\nDue to isomorphism of cochain complexes over Z2 , stated in Proposition 5.2, these\ncollapses could have been performed directly on (A\u2217t , d1 ).\nIt is now crucial to realize, that the same collapses can still be performed in the\ncochain complex (A\u2217t , d1 ), even though we are working over integers. This follows\nfrom the version of Discrete Morse theory for chain complexes, see [Ko05c], since\nour matching is acyclic, and the weights on the matching relations, which here are\nthe incidence numbers, are \u00b11, hence invertible over Z.\nLet m \u2212 t > 2t, i.e., m > 3t, and consider the complexes Thint,m\u2212t,3 . On each\nmaximal cube, choose any of the shortest paths connecting the opposite vertices by\nwhich these cubes hang together. Such a path has gcd(t, m \u2212 t) = gcd(t, m) edges.\nIt is obvious that the collapsing process can be continued until the whole complex\nThint,m\u22122,3 is collapsed onto this path P . Let us extend this collapsing to (A\u2217t , d1 )\nas well, and let us denote the remaining chain complex by (Qt , d1 ).\nThe chain complex (Qt , d1 ) has only two non-zero entries, so let us write it as\n0 \u2192 Q1t \u2192 Q0t \u2192 0. If we worked over Z2 , this chain complex would be simply\ncomputing the homology of a circle with coefficients in Z2 . Over integers we have\n\n\f20\n\nDMITRY N. KOZLOV\n\nsigns and there are two possibilities: either H1 (Qt ) = H0 (Qt ) = Z, or H1 (Qt ) = 0,\nand H0 (Qt ) = Z2 . To distinguish between these two cases we shall now calculate\nthe differential.\nBoth groups Q1t and Q0t have m generators. The boundary of each generator\nof Q1t is a sum of exactly two generators of Q0t with coefficients \u00b11. Let \u03b1 be the\nnumber of those generators of Q1t where these two coefficients are equal. It is easy\nto see that H1 (Qt ) = H0 (Qt ) = Z, if \u03b1 is even, and H1 (Qt ) = 0, H0 (Qt ) = Z2 , if \u03b1\nis odd, so all that remains is to calculate the parity of \u03b1.\n1\n\nm\n\n1\n\nm\n\n1\n\nm\u22121\n\nx\n\nx\u22121\n\nFigure 7.1. 3 cases of the sign calculation.\nOne may think of generators of Q1t as being indexed by t-arc pictures (S, A),\nwith all but one gaps consisting of one element, and one 2-element gap, denoted\n[x \u2212 1, x]m . Taking the boundary corresponds to narrowing this gap in two different\nways: by extending one of the bordering arcs clockwise or counterclockwise. We\nbreak our calculation into 3 cases. See Figure 7.1.\nCase 1. 2 \u2264 x \u2264 m \u2212 1. By formula (7.4), filling in x \u2212 1 or x will have the\nsame sign. Furthermore, when filling in x, we shall also need to move the vertex\nrepresentative from x + 1 to x. These vertices have different parity in the order on\nV (Cm [S \u222a {a}]), hence by (7.2) we get an additional factor \u22121 for this generator.\nWe conclude that all these generators of Q1t do not contribute to \u03b1.\nCase 2. x = m. Again, by formula (7.4), filling in x \u2212 1 or x will have the same\nsign. However, in this case we have to be careful about the sign caused by moving\nthe vertex representative from 1 to m. By formula (7.3), the additional sign is\n(\u22121)mn+n+1 , since b = m \u2212 t \u2212 2, and |A| = t. So the contribution to \u03b1 is 1 if\nmn + n is odd, and 0 otherwise.\nCase 3. x = 1. In this case shifting the vertex representative gives the sign \u22121,\nby (7.2). The non-trivial contribution comes instead from the fact that filling x\nand x \u2212 1 may give different signs. The difference in signs is (\u22121)nt+m+t+1 , since\nm \u2212 t \u2212 1 + t(n \u2212 2) is total number of vertices (if counted with multiplicities) in\npositions 2 through m \u2212 1. Therefore, in this case the contribution to \u03b1 is 1 if\nnt + m + t + 1 is even, and 0 otherwise.\nBy construction of the path P , the group Q1t contains exactly one generator with\nx = m, and exactly one generator with x = 1. Summarizing we see that \u03b1 is odd if\nand only if mn + n + nt + m + t + 1 is odd. Note that mn + n + nt + m + t + 1 =\n(m + t + 1)(n + 1). Thus we obtain the extension of Proposition 5.9 to the case of\ninteger coefficients. We present it in the Table 7.1.\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\nm\u2212t\u22122,t(n\u22122)\n\nn, m, t\n\nE2\n\nt=1\nm(n + 1) is odd,\nm(n + 1) is even,\nn is odd,\nor m + t is odd,\n2 \u2264 t \u2264 \u230a(m \u2212 1)/3\u230b\nn is even,\nand m + t is even,\n2 \u2264 t \u2264 \u230a(m \u2212 1)/3\u230b\nn is any,\nand 3 m,\nt = m/3\n\n21\n\nm\u2212t\u22121,t(n\u22122)\n\nE2\n\n0\nZ\n\n0\n0\n\nZ\n\nZ\n\n0\n\nZ2\n\n0\n\nZ3\n\nTable 7.1.\n\ne \u2217 (Hom (Cm , Kn ); Z).\n7.4. Summary: the full description of the groups H\n\nFor an abelian group \u0393, we let \u0393(d) denote the copy of \u0393 in a graded Z-algebra,\nplaced in dimension d.\nTheorem 7.2. For any integers m, n, such that m \u2265 5, n \u2265 4, we have\n\uf8f6\n\uf8eb\n\u230a(m\u22122)/3\u230b\nM\ne \u2217 (Hom (Cm , Kn ); Z) = \uf8ed\n(7.6)\nH\nAt,m,n \uf8f8 \u2295 Bm,n ,\nt=1\n\nwhere\n\n(7.7) At,m,n =\n\n(\n\nZ(tn \u2212 3t) \u2295 Z(tn \u2212 3t + 1),\nZ2 (tn \u2212 3t + 1),\n\nand\n(7.8)\n\nBm,n\n\n\uf8f1 n\n2 \u22123\n\uf8f4\n(nk \u2212 m),\n\uf8f2Z\n= Z(nk \u2212 m + 2),\n\uf8f4\n\uf8f3\nZ(nk \u2212 m),\n\nif n is odd or m + t is odd,\nif n is even and m + t is even,\nif m = 3k,\nif m = 3k + 1,\nif m = 3k \u2212 1.\n\ne \u2217 (Hom (C6 , K4 ); Z) = A1,6,4 \u2295 B6,4 = Z(1) \u2295 Z(2) \u2295 Z13 (2) =\nFor example H\n14\ne \u2217 (Hom (C8 , K6 ); Z) = A1,8,6 \u2295 A2,8,6 \u2295 B8,6 = Z(3) \u2295 Z(4) \u2295\nZ(1) \u2295 Z (2), and H\nZ2 (7) \u2295 Z(10).\n\nProof of Theorem 7.2. Recall that all cohomology groups of Hom+ (Cm , Kn ) are\nzero, except for one, see Corollary 2.6. Since our spectral sequence converges to\nH \u2217 (Hom+ (Cm , Kn ); Z), we know that almost all entries in the second tableau should\ncancel out.\nSince n \u2265 4, the calculation summarized in Table 7.1 implies that there will be\nno non-zero differential between entries in columns 0, . . . , m \u2212 2. If n \u2265 5, then the\ndifferentials with entries in the (m\u22121)st column as a target will never have the same\ntarget entry. If n = 4, the targets for two such differentials may be the same, but\n\n\f22\n\nDMITRY N. KOZLOV\n\nthen the sources will simply sum up. This follows from the pattern of the entries\nand from the algebraic fact that if we have a group homomorphism f : A \u2192 G,\nsuch that f is an injection, A is either Z or Z2 , and G/Im f is isomorphic to Z,\nthen G is isomorphic to A \u2295 Z.\ne i (Hom+ (Cm , Kn )) = 0, for i < nk \u2212 1, we obtain the \"A part\" of (7.6),\nSince H\nwith the exception of a single entry in the case m = 3k + 1, which is dealt with\nbelow. So we are done with the calculation of almost all cohomology groups of\nHom (Cm , Kn ) at this point. To get the remaining \"B part\", we need to see what\nhappens on the diagonals x + y = const \u2265 nk \u2212 2. We shall consider 3 different\ncases.\nAssume first that m = 3k\u22121. We see from Table 7.1 that the top (in terms of the\nm\u2212k,(n\u22122)(k\u22121)\nsum of coordinates) non-zero element is E2\n. This element is on the\ndiagonal m\u2212k+(n\u22122)(k\u22121) = m+nk\u22123k\u2212n+2 = nk\u2212n+1 = (nk\u22121)\u2212(n\u22122),\nhence it is n \u2212 2 diagonals away from the diagonal nk \u2212 1, and we conclude that\nBm,n = Z(nk \u2212 m).\nAssume now that m = 3k. The top non-zero element in columns 0, . . . , m \u2212 2 is\nm\u2212k\u22121,k(n\u22122)\nE2\n, which lies precisely on the diagonal x+y = nk\u22121. By the analysis in\nm\u2212k\u22121,k(n\u22122)\nS\nSubsection 4.2, the generators of E2\nare given by those [\u03c3A\n], where S is\n\u2022\nobtained from [m] by deleting every third element, which can be done in three different ways, and A is the collection of all m/3 arcs of length 2. By construction, we see\nS\nthat in this case d(\u03c3A\n) = 0, where the differential is taken in C \u2217 (Hom+ (Cm , Kn )).\n\u2022\nm\u2212k\u22121,k(n\u22122)\n\nAdditionally, there are no non-zero elements northwest from E2\n. It\nm\u2212k\u22121,k(n\u22122)\nm\u22121,nk\u2212m+1\nfollows that the spectral sequence differential dk : E2\n\u2192 E2\nm\u2212k\u22121,k(n\u22122)\nis a zero-map, and therefore E2\n= Z3 . Choosing a field F of arbitrary\ncharacteristic we see that the Betti number of the entry E2m\u22121,nk\u2212m is equal to\n2n \u2212 3 if n \u2265 5, and 2n \u2212 2, if n = 4. Since this does not depend on the choice of F ,\nwe conclude that H nk\u2212m (Hom (Cm , Kn )) = E2m\u22121,nk\u2212m is equal to the direct sum\nn\nif the corresponding number of copies of Z, and hence Bm,n = Z2 \u22123 (nk \u2212 m) in\nthis case.\nFinally, assume that m = 3k+1. In this case we have to deal with the differentials\nm\u2212k\u22122,k(n\u22122)\nm\u2212k\u22121,k(n\u22122)\nfrom E2\n= E2\n= Z, and, if n = 4, also from E2m\u2212k,2k\u22122 =\nZ2 . Let X+ denote Hom+ (Cm , Kn ), let X \u2282 X+ be the subcomplex consisting of all\ncells \u03b7, such that |supp \u03b7| < m, and consider the cohomology long exact sequence\ne \u2217 (X+ ; Z) are trivial\nof the pair (X+ , X). Since the reduced cohomology groups H\nin all dimensions except for nk \u2212 1, we find the following exact sequence inside the\nconsidered one:\nf\n\n(7.9) 0 \u2190\u2212 H nk (X+ , X) \u2190\u2212 H nk\u22121 (X) \u2190\u2212\nf\n\n\u2190\u2212 H nk\u22121 (X+ ) \u2190\u2212 H nk\u22121 (X+ , X) \u2190\u2212 H nk\u22122 (X) \u2190\u2212 0.\nThe crucial observation now if that the map f is an inclusion map to a direct\nsummand. To see this, set Y := Hom+ (Cm [V (Cm ) \\ {1}], Kn) \u2282 X. By [Ko99,\nProposition 5.2], and by the fact that Hom+ (Cm , Kn ) \u2243 Ind (Cm )\u2217n , we see that\nthe inclusion map i : Y \u0592\u2192 X+ induces isomorphism of the cohomology groups\nf\n\ni\u2217 : H \u2217 (X+ ) \u2192 H \u2217 (Y ). The isomorphism map ink\u22121 factors as H nk\u22121 (X+ ) \u2192\nH nk\u22121 (X) \u2192 H nk\u22121 (Y ), since f itself is induced by the inclusion map X \u0592\u2192 X + .\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n23\n\nIt follows from this factorization that f is an inclusion map to a direct summand,\nso the sequence (7.9) splits in this sense.\nReinterpreting this for our original spectral sequence we see that this means that\nm\u2212k\u22122,k(n\u22122)\nthe differential dk+1 : E2\n\u2192 E2m\u22121,nk\u2212m+1 is a zero-map, and that, if\nm\u2212k,2k\u22122\nn = 4, then the differential dk\u22121 : E2\n\u2192 E2m\u22121,k is an isomorphism. This\nproves the \"B part\" as well as the rest of the \"A part\" in this case.\n\u0003\nWe remark that in general the homotopy type of Hom (Cm , Kn ) is unknown, even\nconjecturally.\n8. Grinding complexes of maps between cycles\nIn this section we take another look at the complexes of graph homomorphisms\nbetween cycles Hom (Cm , Cn ). For having case-free statements, we assume that\nm \u2265 5, n \u2265 3, n 6= 4, the other cases are very simple. It was shown in [CK04a] that\nthe homotopy type of each connected component of Hom (Cm , Cn ) is either that of\na point, or that of S 1 . The complexes Hom (Cm , Cn ) are cubical, and the encoding of\ncells, suggested in [CK04a, Section 5] can be easily translated into the language of\ntorus fronts as follows. We rephrase Definition 5.3 introducing an extra parameter.\nDefinition 8.1. Let b be a positive integer, and consider the action of the group\nZ\u00d7Z on the plane, where the standard generators of Z\u00d7Z act by vector translations,\nwith vectors (\u2212b, b) and (m, n). A b-band (m, n)-torus front (or sometimes simply band torus front) is an orbit of this (Z \u00d7 Z)-action on the set of all (m, n)-grid\npaths.\nb\nare defined by replacing\nAs an analogous generalization, the complexes T Fm,n,g\n(m, n)-torus fronts in Definition 5.4 by b-band (m, n)-torus fronts.\nIt is clear that, when translated into our language, the description from [CK04a,\nSection 5] would simply say that the cells of Hom (Cm , Cn ) are encoded by band torus\nfronts. More precisely, consider the subcomplex Xw of Hom (Cm , Cn ) induced by the\nvertices which have the winding number w (each vertex is a graph homomorphism\nbetween cycles, which gives rise to continuous map of S 1 to itself, hence the notion\nof winding number is well defined). Without loss of generality we can assume that\nw is nonnegative. Then, m \u2212 nw is even, and we set r = (m \u2212 nw)/2. If both\nm and n are even, the complex Xw has two connected components, otherwise it is\nconnected. Tracing the constructions we obtain the following reformulation.\n\nProposition 8.2. The cubical complex Xw is isomorphic to the band torus front\nn\ncomplex T Fr,m\u2212r,1\n.\nMost of the discussion from Section 5, including such notions as extreme corners,\nthin flips, and millstones, generalizes to the band torus front context without any\nmodification whatsoever. For the sake of brevity, we do not repeat it here, and\nsimply state the main result.\nTheorem 8.3. For any natural numbers m, n, and g, there exists a sequence of\nb\ncollapses leading from the cubical complex T Fm,n,g\nto its subcomplex consisting of\nall thin b-band flips.\nWe now obtain the band analog of Proposition 5.8.\nCorollary 8.4. When r > 0, the cubical complex Xw collapses to the subcomplex\nconsisting of mn/ gcd(m, r) cubes of dimension gcd(m, r). These cubes are linked\n\n\f24\n\nDMITRY N. KOZLOV\n\nby the opposite vertices to form 2 circles of both m and n are even, and one circle\notherwise.\nProof. The proof of Proposition 5.8 holds. The only difference is that when\nenumerating the cubes we have an extra factor n to compensate for working on\nan n-band.\n\u0003\nThe cubes in the thin part of Hom (Cm , Cn ) are linked in vertices, which encode\nthose graph homomorphisms from Cm to Cn which distribute their turning points\nas evenly as possible.\nSince collapsing Hom (Cm , Cn ) onto the subcomplex of thin graph homomorphisms produces a (Dm \u00d7 Dn )-equivariant strong deformation retraction, Corollary 8.4 yields in particular a full description of the (Dm \u00d7 Dn )-action on the cohomology groups of Hom (Cm , Cn ), where Dt denotes the t-th dihedral group.\nAcknowledgments. We would like to thank the Swiss National Science Foundation and ETH-Z\u00fcrich for the financial support of this research.\nReferences\n[BK03a] E. Babson, D.N. Kozlov, Topological obstructions to graph colorings, Electron. Res.\nAnnounc. Amer. Math. Soc. 9 (2003), pp. 61\u201368.\n[BK03b] E. Babson, D.N. Kozlov, Complexes of graph homomorphisms, Israel J. Math. 152\n(2006), pp. 285\u2013312.\narXiv:math.CO/0310056\n[BK04] E. Babson, D.N. Kozlov, Proof of the Lov\u00e1sz Conjecture, Annals of Mathematics (2), in\npress.\narXiv:math.CO/0402395\n[Cs05] P. Csorba, Non-tidy spaces and graph colorings, Ph.D. Thesis, ETH Z\u00fcrich, 2005.\n[CK04a] S.Lj. \u010cuki\u0107, D.N. Kozlov, The homotopy type of the complexes of graph homomorphisms\nbetween cycles, Discr. Comp. Geom., in press.\narXiv:math.CO/0408015\n[CK04b] S.Lj. \u010cuki\u0107, D.N. Kozlov, Higher connectivity of graph coloring complexes, Int. Math.\nRes. Not., 2005, no. 25, 1543\u20131562.\narXiv:math.CO/0410335\n[En05] A. Engstr\u00f6m, A short proof of a conjecture on the higher connectivity of graph coloring\ncomplexes, Proc. Amer. Math. Soc., in press.\narXiv:math.CO/0505460\n[Ka05] M. Kahle, The neighborhood complex of a random graph, 9 pages, 2005.\narXiv:math.CO/0512077\n[Ko99] D.N. Kozlov, Complexes of directed trees, J. Comb. Theory Ser. A 88 (1999), pp. 112\u2013\n122.\n[Ko04] D.N. Kozlov, A simple proof for folds on both sides in complexes of graph homomorphisms, Proc. Amer. Math. Soc. 134, (2006), no. 5, pp. 1265\u20131270.\narXiv:math.CO/0408262\n[Ko05a] D.N. Kozlov, Chromatic numbers, morphism complexes, and Stiefel-Whitney characteristic classes, in: Geometric Combinatorics (eds. E. Miller, V. Reiner, B. Sturmfels),\nIAS/Park City Mathematics Series 14, American Mathematical Society, Providence, RI;\nInstitute for Advanced Study (IAS), Princeton, NJ; in press.\narXiv:math.AT/0505563\n[Ko05b] D.N. Kozlov, Simple homotopy types of Hom-complexes, neighborhood complexes, Lov\u00e1sz\ncomplexes, and atom crosscut complexes, Topology Appl., in press.\narXiv:math.AT/0503613\n[Ko05c] D.N. Kozlov, Discrete Morse theory for chain complexes, C. R. Acad. Sci. Paris, Ser. I\n340 (2005), pp. 867\u2013872.\narXiv:cs.DM/0504090\n\n\fCOHOMOLOGY OF COLORINGS OF CYCLES\n\n25\n\n[Ko06]\n\nD.N. Kozlov, Cobounding odd cycle colorings, 2 pages, 2006.\narXiv:math.AT/0602561\n[McC01] J. McCleary, A user's guide to spectral sequences, Second edition, Cambridge Studies in\nadvanced mathematics 58, Cambridge University Press, Cambridge, 2001.\n[MSS03] D. Mond, J. Smith, D. van Straten, Stochastic factorizations, sandwiched simplices and\nthe topology of the space of explanations, Proc. R. Soc. Lond. A 459 (2003), pp. 2821\u2013\n2845.\n[Pf05]\nJ. Pfeifle, Dissections, Hom -complexes and the Cayley trick, 21 pages, 2005.\narXiv:math.CO/0512529\n[S05a]\nC. Schultz, A short proof of w1n (Hom(C2r+1 , Kn+2 )) = 0 for all n and a graph colouring\ntheorem by Babson and Kozlov, 8 pages, 2005.\narXiv:math.AT/0507346\n[S05b] C. Schultz, Small models of graph colouring manifolds and the Stiefel manifolds\nHom (C5 , Kn ), 19 pages, 2005.\narXiv:math.CO/0510535\n[SS05] B. Sturmfels, S. Sullivant, Combinatorial secant varieties, 20 pages, 2005.\narXiv:math.AC/0506223\nDepartment of Computer Science, Eidgen\u00f6ssische Technische Hochschule, Z\u00fcrich,\nSwitzerland\nE-mail address: dkozlov@inf.ethz.ch\n\n\f"}