{"id": "http://arxiv.org/abs/hep-ph/0605240v2", "guidislink": true, "updated": "2006-05-26T18:49:09Z", "updated_parsed": [2006, 5, 26, 18, 49, 9, 4, 146, 0], "published": "2006-05-22T20:03:21Z", "published_parsed": [2006, 5, 22, 20, 3, 21, 0, 142, 0], "title": "LHAPDF: PDF Use from the Tevatron to the LHC", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=hep-ph%2F0605052%2Chep-ph%2F0605294%2Chep-ph%2F0605201%2Chep-ph%2F0605175%2Chep-ph%2F0605177%2Chep-ph%2F0605073%2Chep-ph%2F0605337%2Chep-ph%2F0605240%2Chep-ph%2F0605245%2Chep-ph%2F0605086%2Chep-ph%2F0605168%2Chep-ph%2F0605097%2Chep-ph%2F0605230%2Chep-ph%2F0605057%2Chep-ph%2F0605072%2Chep-ph%2F0605291%2Chep-ph%2F0605084%2Chep-ph%2F0605329%2Chep-ph%2F0605274%2Chep-ph%2F0605210%2Chep-ph%2F0605032%2Chep-ph%2F0605077%2Chep-ph%2F0605133%2Chep-ph%2F0605045%2Chep-ph%2F0605065%2Chep-ph%2F0605302%2Chep-ph%2F0605081%2Chep-ph%2F0605289%2Chep-ph%2F0605259%2Chep-ph%2F0605227%2Chep-ph%2F0605129%2Chep-ph%2F0605010%2Chep-ph%2F0605139%2Chep-ph%2F0605239%2Chep-ph%2F0605172%2Chep-ph%2F0605304%2Chep-ph%2F0605145%2Chep-ph%2F0605105%2Chep-ph%2F0605169%2Chep-ph%2F0605088%2Chep-ph%2F0605266%2Chep-ph%2F0605339%2Chep-ph%2F0605134%2Chep-ph%2F0605276%2Chep-ph%2F0605219%2Chep-ph%2F0605082%2Chep-ph%2F0605197%2Chep-ph%2F0605164%2Chep-ph%2F0605316%2Chep-ph%2F0605170%2Chep-ph%2F0605012%2Chep-ph%2F0605007%2Chep-ph%2F0605074%2Chep-ph%2F0605261%2Chep-ph%2F0605286%2Chep-ph%2F0605272%2Chep-ph%2F0605026%2Chep-ph%2F0605039%2Chep-ph%2F0605241%2Chep-ph%2F0605038%2Chep-ph%2F0605138%2Chep-ph%2F0605016%2Chep-ph%2F0605121%2Chep-ph%2F0605233%2Chep-ph%2F0605013%2Chep-ph%2F0605017%2Chep-ph%2F0605022%2Chep-ph%2F0605140%2Chep-ph%2F0605256%2Chep-ph%2F0605064%2Chep-ph%2F0605277%2Chep-ph%2F0605288%2Chep-ph%2F0605112%2Chep-ph%2F0605255%2Chep-ph%2F0605070%2Chep-ph%2F0605273%2Chep-ph%2F0605144%2Chep-ph%2F0605157%2Chep-ph%2F0605001%2Chep-ph%2F0605298%2Chep-ph%2F0605083%2Chep-ph%2F0605306%2Chep-ph%2F0605206%2Chep-ph%2F0605099%2Chep-ph%2F0605318%2Chep-ph%2F0605061%2Chep-ph%2F0605181%2Chep-ph%2F0605264%2Chep-ph%2F0605106%2Chep-ph%2F0605048%2Chep-ph%2F0605113%2Chep-ph%2F0605015%2Chep-ph%2F0605043%2Chep-ph%2F0605249%2Chep-ph%2F0605202%2Chep-ph%2F0605071%2Chep-ph%2F0605187%2Chep-ph%2F0605066%2Chep-ph%2F0605068%2Chep-ph%2F0605238%2Chep-ph%2F0605027&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "LHAPDF: PDF Use from the Tevatron to the LHC"}, "summary": "Parton Density Functions (PDFs) and their uncertainties are extremely\nimportant topics for both the Tevatron and the LHC. Experiments at the Tevatron\ncan enhance this knowledge not only by constraining the PDF fits, but also by\ndeveloping and refining the available PDF tools through feed-back from the\nexperiments that are currently analyzing the highest energy hadron collider\ndata available. It is important that the community has standardized tools and\nmethods at its disposal. In this note we summarize briefly the most recent\ndevelopments of the The Les Houches Accord PDF (LHAPDF), which is the modern\nreplacement for PDFLIB. We also outline and compare the methods of quantifying\nthe impact of PDF uncertainties on physical observables. The PDF weighting\nmethod for propagating errors from PDFs to event generator observables is\noutlined in detail, and example code for using this method with PYTHIA is also\nincluded.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=hep-ph%2F0605052%2Chep-ph%2F0605294%2Chep-ph%2F0605201%2Chep-ph%2F0605175%2Chep-ph%2F0605177%2Chep-ph%2F0605073%2Chep-ph%2F0605337%2Chep-ph%2F0605240%2Chep-ph%2F0605245%2Chep-ph%2F0605086%2Chep-ph%2F0605168%2Chep-ph%2F0605097%2Chep-ph%2F0605230%2Chep-ph%2F0605057%2Chep-ph%2F0605072%2Chep-ph%2F0605291%2Chep-ph%2F0605084%2Chep-ph%2F0605329%2Chep-ph%2F0605274%2Chep-ph%2F0605210%2Chep-ph%2F0605032%2Chep-ph%2F0605077%2Chep-ph%2F0605133%2Chep-ph%2F0605045%2Chep-ph%2F0605065%2Chep-ph%2F0605302%2Chep-ph%2F0605081%2Chep-ph%2F0605289%2Chep-ph%2F0605259%2Chep-ph%2F0605227%2Chep-ph%2F0605129%2Chep-ph%2F0605010%2Chep-ph%2F0605139%2Chep-ph%2F0605239%2Chep-ph%2F0605172%2Chep-ph%2F0605304%2Chep-ph%2F0605145%2Chep-ph%2F0605105%2Chep-ph%2F0605169%2Chep-ph%2F0605088%2Chep-ph%2F0605266%2Chep-ph%2F0605339%2Chep-ph%2F0605134%2Chep-ph%2F0605276%2Chep-ph%2F0605219%2Chep-ph%2F0605082%2Chep-ph%2F0605197%2Chep-ph%2F0605164%2Chep-ph%2F0605316%2Chep-ph%2F0605170%2Chep-ph%2F0605012%2Chep-ph%2F0605007%2Chep-ph%2F0605074%2Chep-ph%2F0605261%2Chep-ph%2F0605286%2Chep-ph%2F0605272%2Chep-ph%2F0605026%2Chep-ph%2F0605039%2Chep-ph%2F0605241%2Chep-ph%2F0605038%2Chep-ph%2F0605138%2Chep-ph%2F0605016%2Chep-ph%2F0605121%2Chep-ph%2F0605233%2Chep-ph%2F0605013%2Chep-ph%2F0605017%2Chep-ph%2F0605022%2Chep-ph%2F0605140%2Chep-ph%2F0605256%2Chep-ph%2F0605064%2Chep-ph%2F0605277%2Chep-ph%2F0605288%2Chep-ph%2F0605112%2Chep-ph%2F0605255%2Chep-ph%2F0605070%2Chep-ph%2F0605273%2Chep-ph%2F0605144%2Chep-ph%2F0605157%2Chep-ph%2F0605001%2Chep-ph%2F0605298%2Chep-ph%2F0605083%2Chep-ph%2F0605306%2Chep-ph%2F0605206%2Chep-ph%2F0605099%2Chep-ph%2F0605318%2Chep-ph%2F0605061%2Chep-ph%2F0605181%2Chep-ph%2F0605264%2Chep-ph%2F0605106%2Chep-ph%2F0605048%2Chep-ph%2F0605113%2Chep-ph%2F0605015%2Chep-ph%2F0605043%2Chep-ph%2F0605249%2Chep-ph%2F0605202%2Chep-ph%2F0605071%2Chep-ph%2F0605187%2Chep-ph%2F0605066%2Chep-ph%2F0605068%2Chep-ph%2F0605238%2Chep-ph%2F0605027&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Parton Density Functions (PDFs) and their uncertainties are extremely\nimportant topics for both the Tevatron and the LHC. Experiments at the Tevatron\ncan enhance this knowledge not only by constraining the PDF fits, but also by\ndeveloping and refining the available PDF tools through feed-back from the\nexperiments that are currently analyzing the highest energy hadron collider\ndata available. It is important that the community has standardized tools and\nmethods at its disposal. In this note we summarize briefly the most recent\ndevelopments of the The Les Houches Accord PDF (LHAPDF), which is the modern\nreplacement for PDFLIB. We also outline and compare the methods of quantifying\nthe impact of PDF uncertainties on physical observables. The PDF weighting\nmethod for propagating errors from PDFs to event generator observables is\noutlined in detail, and example code for using this method with PYTHIA is also\nincluded."}, "authors": ["D Bourilkov", "R C Group", "M R Whalley"], "author_detail": {"name": "M R Whalley"}, "author": "M R Whalley", "arxiv_comment": "8 pages, 2 figures, 2 tables; prepared for the TeV4LHC workshop; v2 -\n  reference added", "links": [{"href": "http://arxiv.org/abs/hep-ph/0605240v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/hep-ph/0605240v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "hep-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "hep-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/hep-ph/0605240v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/hep-ph/0605240v2", "journal_reference": null, "doi": null, "fulltext": "LHAPDF: PDF Use from the Tevatron to the LHC\n\narXiv:hep-ph/0605240v2 26 May 2006\n\nD Bourilkov\u2021 , R C Group\u2021\u2217 , and M R Whalley\u2020 ,\nUniversity of Florida\u2021\nGainesville, FL 32611, USA\nand\nUniversity of Durham\u2020\nDurham, DH1 3LE, UK\n\nParton Density Functions (PDFs) and their uncertainties are extremely important topics for both\nthe Tevatron and the LHC. Experiments at the Tevatron can enhance this knowledge not only by constraining the PDF fits, but also by developing and refining the available PDF tools through feed-back\nfrom the experiments that are currently analyzing the highest energy hadron collider data available.\nIt is important that the community has standardized tools and methods at its disposal. In this note\nwe summarize briefly the most recent developments of the The Les Houches Accord PDF (LHAPDF),\nwhich is the modern replacement for PDFLIB. We also outline and compare the methods of quantifying the impact of PDF uncertainties on physical observables. The PDF weighting method for\npropagating errors from PDFs to event generator observables is outlined in detail, and example code\nfor using this method with PYTHIA is also included.\n\nI. INTRODUCTION\n\nThe experimental errors in current and future hadron colliders are expected to decrease to a level that will challenge the uncertainties in theoretical calculations. One important component in the prediction of uncertainties at\nhadron colliders comes from the Parton Density Functions (PDFs) of the (anti)proton.\nThe highest energy particle colliders in the world currently, and in the near future, collide hadrons. To make\npredictions of hadron collisions, the parton cross sections must be folded with the parton density functions:\nX\n\u0001\nd\u03c3\nfi/p (x1 )fj/p (x2 ) + (i \u2194 j) \u03c3\u0302\n[pp \u2192 X] \u223c\nd variable\n\n(1)\n\nij\n\n\u03c3\u0302 - cross section for the partonic subprocess ij \u2192 X\nx1 , x2 - parton momentum fractions,\nfi/p(p\u0304) (xi ) - probability to find a parton i with momentum fraction xi in the (anti)proton.\nA long standing problem when performing such calculations is to quantify the uncertainty of the results coming\nfrom our limited knowledge of the PDFs. Even if the parton cross section \u03c3\u0302 is known very precisely, there may be a\nsizable error on the hadronic cross section \u03c3 due to the PDF uncertainty.\nThe Tevatron can contribute to PDF knowledge in many ways that will benefit the experiments at the LHC. First,\nmeasurements made by the experiments at FNAL will reduce PDF uncertainties by constraining PDF fits. Perhaps\n\n\u2217\n\n1\n\nThis talk was given by R. C. Group in October 2005 at the TeV4LHC workshop, describing ongoing work performed in collaboration with the\nother authors.\n\n\fmore importantly tools and techniques for propagating PDF uncertainty through to physical observables can be\nimproved and tested at the Tevatron.\nNext-to-leading order (NLO) is the first order at which the the normalization of the hard-scattering cross sections\nhas a reasonable uncertainty. Therefore, this is the first order at which PDF uncertainties are usually applied. To\ndate, all PDF uncertainties have been calculated in the context of NLO global analysis. However, useful information\ncan still be obtained from NLO PDF uncertainties with leading order (LO) calculations and parton shower Monte\nCarlos [1].\nTechniques and tools for calculating PDF uncertainty in the context of LO parton shower Monte Carlos will be\nthe primary topic of this document. Examples are provided employing CTEQ6 [2] error sets from LHAPDF and the\nparton shower Monte Carlo program PYTHIA [3].\n\nII.\nA.\n\nLHAPDF UPDATE\nRecent developments\n\nHistorically, the CERN PDFLIB library [4] has provided a widely used standard FORTRAN interface to PDFs\nwith interpolation grids built into the PDFLIB code itself. However, it was realized that PDFLIB would be increasingly unable to meet the needs of the new generation of PDFs which often involve large numbers of sets (\u224820\u201340)\ndescribing the uncertainties on the individual partons from variations in the fitted parameters. As a consequence\nof this, at the Les Houches meeting in 2001 [5], the beginnings of a new interface were conceived - the so-called\nLes Houches Accord PDF (LHAPDF). The LHAGLUE package [6] plus a unique PDF numbering scheme enables\nLHAPDF to be used in the same way as PDFLIB, without requiring any changes in the PYTHIA or HERWIG codes.\nThe evolution of LHAPDF (and LHAGLUE) up to summer 2005 is well documented [7].\nRecently, LHAPDF has been further improved. With the release of v4.1 in August of 2005 the installation method\nhas been upgraded to the more conventional configure; make; make install. Version 4.2, released in\nNovember of 2005, includes the new cteq6AB (variable \u03b1(MZ )) PDF sets. It also includes new modifications by\nthe CTEQ group to other cteq code to improve speed. Some minor bugs were also fixed in this version that affected\nthe a02m nnlo.LHgrid file (previous one was erroneously the same as LO) and SMRSPI code which was wrongly\nsetting usea to zero.\nA v5 version, with the addition of the option to store PDFs from multiple sets in memory, has been released.\nThis new functionality speeds up the code by making it possible to store PDF results from many sets while only\ngenerating a MC sample once without significant loss of speed.\n\nB. Consistency checks\n\nAs a technical check, cross sections have been computed, as well as errors where appropriate, for all PDF sets\nincluded in LHAPDF. 10,000 events are generated for each member of a PDF set for both HERWIG [8] and PYTHIA [3],\nand at both Tevatron and LHC energies. As this study serves simply as a technical check of the interface, no attempt\nwas made to unfold the true PDF error. The maximum Monte Carlo variance (integration error) in our checks is\nless than 1 percent. This has not been subtracted and will result in an overestimate of the true PDF uncertainty by a\nfactor <\u223c 1.05 in our analysis. The results in general show good agreement for most PDFs included in the checks.\nOverall the consistency is better for Tevatron energies, where we do not have to make large extrapolations to the\nnew energy domain and much broader phase space covered by the LHC.\n\n2\n\n\fTwo complementary processes are used:\n\u2022 Drell\u2013Yan Pairs (\u03bc+ \u03bc\u2212 ): the Drell\u2013Yan process is chosen here to probe the functionality of the quark PDFs\nincluded in the LHAPDF package.\n\u2022 Higgs Production: the cross section for gg \u2192 H probes the gluon PDFs, so this channel is complementary to\nthe case considered above.\n\nIII. PDF UNCERTAINTIES\n\nAs stated above, the need to understand and reduce PDF uncertainties in theoretical predictions for collider\nphysics is of paramount importance. One of the first signs of this necessity was the apparent surplus of high PT\nevents observed in the inclusive jet cross section in the CDF experiment at FNAL in run I. Subsequent analysis of\nthe PDF uncertainty in this kinematic region indicated that the deviation was within the range of the PDF dominated theoretical uncertainty on the cross section. Indeed, when the full jet data from the Tevatron (including the\nD0 measurement over the full rapidity range) was included in the global PDF analysis, the enhanced high x gluon\npreferred by CDF jet data from Run I became the central solution. This was an overwhelming sign that PDF uncertainty needed to be quantified [9]. Below, a short review of one approach to quantify these uncertainties called\nthe Hessian matrix method is given, followed by outlines of two methods used to calculate the PDF uncertainty on\nphysical observables.\n\nA.\n\nReview of the Hessian Method\n\nExperimental constraints must be incorporated into the uncertainties of parton distribution functions before these\nuncertainties can be propagated through to predictions of observables. The Hessian Method [10] both constructs\na N Eigenvector Basis of PDFs and provides a method from which uncertainties on observables can be calculated.\nThe first step of the Hessian method is to make a fit to data using N free parameters. The global \u03c72 of this fit is\nminimized yielding a central or best fit parameter set S0 . Next the global \u03c72 is increased to form the Hessian error\nmatrix:\n\u2206\u03c72 =\n\nN X\nN\nX\n\nHij (ai \u2212 a0i )(aj \u2212 a0j )\n\n(2)\n\ni=1 j=1\n\nThis matrix can then be diagonalized yielding N (20 for CTEQ6) eigenvectors. Each eigenvector probes a direction\nin PDF parameter space that is a combination of the 20 free parameters used in the global fit. The largest eigenvalues\ncorrespond to the best determined directions and the smallest eigenvalues to the worst determined directions in\nPDF parameter space. For the CTEQ6 error PDF set, there is a factor of roughly one million between the largest\nand smallest eigenvectors. The eigenvectors are numbered from highest eigenvalue to lowest eigenvalue. Each N\neigenvector direction is then varied up and down within tolerance to obtain 2N new parameter sets, Si\u00b1 (i = 1, .., N ).\nThese parameter sets each correspond to a member of the PDF set, Fi\u00b1 = F (x, Q; Si\u00b1 ). The PDF library described\nabove, LHAPDF, provides standard access to these PDF sets.\n\n3\n\n\fB. 'Master' Equations\n\nAlthough the variations applied in the eigenvector directions are symmetric by construction, this is not always the\ncase for the result of these variations when propagated through to an observable. In general the well constrained\ndirections (low eigenvector numbers) tend to have symmetric positive and negative deviations on either side of\nthe central value of the observable (X0 ). This can not be counted on in the case of the smaller eigenvalues (larger\neigenvector numbers). The 2N+1 members of the PDF set provide 2N+1 results for any observable of interest. Two\nmethods for obtaining a set of results are described in detail below. Once results are obtained they can be used to\napproximate PDF uncertainty through the use of a 'Master Equation'. Although many versions of these equations\ncan be found in the literature, the type which considers maximal positive and negative variations of the physical\nobservable separately, known as \"modified tolerance method\", is preferred [11, 12]:\n\n+\n\u2206Xmax\n\nv\nuN\nuX\n= t [max(Xi+ \u2212 X0 , Xi\u2212 \u2212 X0 , 0)]2\n\n(3)\n\nv\nuN\nuX\n= t [max(X0 \u2212 Xi+ , X0 \u2212 Xi\u2212 , 0)]2\n\n(4)\n\ni=1\n\n\u2212\n\u2206Xmax\n\ni=1\n\nOther forms of 'Master' equations with their flaws are summarized:\nqP\nN\n+\n\u2212 2\n\u2022 \u2206X1 = 21\ni=1 (Xi \u2212 Xi )\nThis is the original CTEQ 'Master Formula'. It correctly predicts uncertainty on the PDF values since in the\nPDF basis Xi+ and Xi\u2212 are symmetric by construction. However, for physical observables this equation will\nunderestimate the uncertainty if Xi+ and Xi\u2212 lie on the same side of X0 .\nqP\n2N\n+\n\u2212\n+\n2\n\u2022 \u2206X2 = 12\ni=1 Ri (R1 = X1 \u2212 X0 ,R2 = X1 \u2212 X0 , R3 = X2 \u2212 X0 ...)\nIf Xi+ and Xi\u2212 lie on the same side of X0 this equation adds contributions from both in quadrature. NOTE:\nFor symmetric and asymmetric deviations, \u2206X1 varies from 0 \u2192 \u221a22 \u2206X2\n\u2022 positive q\nand negative variations basedq\non eigenvector directions\nPN\nPN\n+\n\u2212\n+\n\u2212\n2\n2\n\u2206X =\ni=1 (Xi \u2212 X0 ) , \u2206X =\ni=1 (Xi \u2212 X0 )\nSince the positive and negative directions defined in the PDF eigenvector space are not always related to positive and negative variations on an observable these equations can not be interpreted as positive and negative\nerrors in the general case.\n\nC. Summary of Techniques\n\nTwo main techniques are currently employed to study the effect of PDF uncertainties of physical observables.\nBoth techniques work with the PDF sets derived from the Hessian method.\n\n4\n\n\f1.\n\n'Brute Force'\n\nThe 'brute force' method simply entails running the MC and obtaining the observable of interest for each PDF in\nthe PDF set. This method is robust, and theoretically correct. Unfortunately, it can require very large CPU time since\nlarge statistical samples must be generated in order for the PDF uncertainty to be isolated over statistical variations.\nThis method generally is unrealistic when detector simulation is desired.\nBecause the effect on the uncertainty of the PDF set members is added in quadrature, the uncertainty is often\ndominated by only a few members of the error set. In this case, a variation of the 'brute force' method can be\napplied. Once the eigenvectors that the observable is most sensitive to are determined, MC samples only need to be\ngenerated for the members corresponding to the variation of these eigenvalues. This method will always slightly\nunderestimate the true uncertainty.\n\n2.\n\nPDF Weights\n\nAs mentioned above, often it is not possible to generate the desired MC sample many times in order to obtain the\nuncertainty on the observable due to the PDF. The 'PDF Weights' method solves this problem [1]. The idea is that\nthe PDF contribution to Equation 1 may be factored out. That is, for each event generated with the central PDF from\n(x1 ,Q;Si )f (x2 ,Q;Si )\nwhere n = 1...Nevents , i = 1..NP DF ) can be stored for each\nthe set, a PDF weight (Wn0 = 1, Wni = ff(x\n1 ,Q;S0 )f (x2 ,Q;S0 )\nevent. The PDF weight technique can be summarized as follows...\n\u2022 Only one MC sample is generated but 2N (e.g. 40) PDF weights are obtained for\nWn0 = 1, Wni =\n\nf (x1 , Q; Si )f (x2 , Q; Si )\nf (x1 , Q; S0 )f (x2 , Q; S0 )\n\n(5)\n\nwhere n = 1...Nevents , i = 1..NP DF\n\u2022 Only one run, so kinematics do not change and there is no residual statistical variation in uncertainty.\n\u2022 The observable must be weighted on an event by event basis for each PDF of the set. One can either store a\nntuple of weights to be used 'offline', or fill a set of weighted histograms (one for each PDF in the set).\nThe benefits of the weighting technique are twofold. First, only one sample of MC must be generated. Second,\nsince the observable for each PDF member is obtained from the same MC sample there is no residual statistical\nfluctuation in the estimate of the PDF uncertainty. One concern involving this method is that re-weighting events\ndoes not correctly modify the Sudakov form factors. However, the difference in this effect due to varying the PDF\nwas shown to be negligible [13]. That is, the initial state parton shower created with the central PDF (CTEQ6.1) also\naccurately represents the parton shower that would be produced by any other PDF in the error set.\nThe weighting method is only theoretically correct in the limit that all possible initial states are populated. For\nthis reason, it is important that reasonable statistical samples are generated when using this technique. Any analysis\nwhich is sensitive to the extreme tails of distributions should use this method with caution.\nThere are two options for using the PDF weighting technique. One can either store 2N (e.g. 40 for CTEQ) weights\nfor each event, or store X1 , X2 , F1 , F2 , and Q2 and calculate the weights 'offline'. The momentum of the two incoming partons may be obtained from PYTHIA via PARI(33) and PARI(34). Flavour types of the 2 initial partons are\nstored in F1 = M ST I(15) and F2 = M ST I(16), and the numbering scheme is the same as the one used by LHAPDF,\nTable I, except that the gluon is labeled '21' rather than '0'. The Q2 of the interaction is stored in Q2 = P ARI(24). In\n5\n\n\ftheory, this information and access to LHAPDF is all that is needed to use the PDF weights method. This approach\nhas the additional benefit of enabling the 'offline reweighting' with new PDF sets, which have not been used, or\neven existed, during the MC generation. We plan to include sample code facilitating the use of PDF weights in\nfuture releases of LHAPDF.\nTABLE I: The flavour enumeration scheme used for f(n) in LHAPDF\nparton t\u0304 b\u0304 c\u0304 d \u0304 \u016b d \u0304 g d u s c b t\n\nn\n\n-6 -5 -4 -3 -2 -1 0\n\n1\n\n2\n\nIV.\n\nEXAMPLE STUDIES\n\nA.\n\nDrell\u2013Yan at the LHC\n\n3\n\n4\n\n5\n\n6\n\nThe Drell\u2013Yan process is chosen as an almost ideal test case involving quark PDFs for the different flavours.\n\nQ 2(GeV)2\n\nh_Flavor\nEntries 200000\nMean\n2.162\nRMS\n1.164\n\nDY_70\n\nParton Kinematics for Drell Yan at LHC\n8\n\n10\n\n70000\n7\n\n10\n\n60000\n50000\n\n6\n\n10\n\n40000\n105\n\nMll=70 GeV\nMll=1000 GeV\nMll=2000 GeV\n\n4\n\n10\n\n30000\n20000\n10000\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\nd\n\nX\nh_Flavor\nEntries 200000\nMean\n1.841\nRMS\n0.5469\n\nDY_1000\n3\n\n\u00d710\n140\n\ns\n\nc\n\nb\nh_Flavor\nEntries 200000\nMean\n1.827\nRMS\n0.4643\n\nDY_2000\n3\n\n\u00d710\n160\n140\n\n120\n\n120\n\n100\n\n100\n\n80\n\n80\n\n60\n\n60\n\n40\n\n40\n\n20\n\n20\n\n0\n\nu\n\nd\n\nu\n\ns\n\nc\n\nb\n\n0\n\nd\n\nu\n\ns\n\nc\n\nb\n\nFIG. 1: The parton kinematics for Drell\u2013Yan production at the LHC for three Drell\u2013Yan mass choices. Also the initial parton\nflavour content for the three cases is shown.\n\nThe initial state parton kinematics and flavour contributions are given in Figure 1 for three regions of invariant\nmass of the final state lepton pair: 70 < M < 120, M > 1000, M > 2000 GeV. As we can observe, they cover very\n6\n\n\fwide range in X and Q2 . It is interesting to note that the flavour composition around the Z peak contains important\ncontributions from five flavours, while at high mass the u and d quarks (in ratio 4:1) dominate almost completely.\n\nB. Higgs Production in gg\u2192H at the LHC\n\nThis channel is chosen as complementary to the first one and contains only contributions from the gluon PDF. A\nlight Higgs mass of 120 GeV is selected.\n\nC. Inclusive Jet Cross Section at the Tevatron and the LHC\n\nAs mentioned above, the inclusive jet cross section was one of the first measurements where the need to quantify\nPDF uncertainty was evident. QCD 2-2 processes are studied for P\u02c6T > 500 GeV . The kinematic range probed can\nbe seen in Figure 2.\nParton Kinematics for dijet P min=500GeV\nQ2\n\nT\n\n107\n\nTevatron\nLHC\n\n6\n\n10\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\nX\n\nFIG. 2: The partonic jet kinematics for the inclusive jet cross section at the Tevatron and the LHC.\n\nD.\n\nResults\n\nThe results for all 3 studies are summarized in Table II. The weighting technique produces the same results as the\nmore elaborate 'brute force' approach for all cases.\n\nV.\n\nSUMMARY\n\nIn this talk new developments of LHAPDF and consistency checks for all PDF sets are described. The approaches\nto PDF uncertainty analysis are outlined and the modern method of PDF weighting is described in detail and tested\nin different channels of current interest. Drell-Yan, gluon fusion to Higgs, and high PT jet production are studied\nat the Tevatron and LHC energy scales. The methods are in agreement in all cases. Equations for quantifying PDF\nuncertainty are discussed and the type which relies on maximal positive and negative variations on the observable\nis considered superior.\n\n7\n\n\fTABLE II: Results for the 3 case studies. The central values of the cross sections in [pb] are shown, followed by the estimates of\nthe uncertainties for the different master equations and the 'brute force' (B.F.) and weighting (W) techniques.\n\nProcess (method)\nX0 (best fit) \u2206X1\nDY 70<M<110 (B.F.)\n1086\n48\nDY 70<M<110 (W)\n1086\n48\n\n+\n+\n\u2206X2 +\u2206X + \u2212\u2206X \u2212 +\u2206Xmax\n\u2212\u2206Xmax\n42\n+55\n-63\n+51\n-62\n42\n+55\n-64\n+51\n-63\n\nDY M>1000 (B.F.)\nDY M>1000 (W)\n\n6.7e-3\n6.7e-3\n\n3.5e-4 2.6e-4 + 3.5e-4 -3.8e-4\n3.5e-4. 2.6e-4 +3.5e-4 -3.8e-4\n\n+3.4e-4\n+3.4e-4\n\n-3.9e-4\n-3.8e-4\n\nDY M>2000 (B.F.)\nDY M>2000 (W)\n\n2.2e-4\n2.2e-4\n\n1.8e-5 1.3e-5 +1.9e-5 -1.9e-5\n1.8e-5 1.3e-5 +1.8e-5 -1.9e-5\n\n+2.0e-5\n+2.0e-5\n\n-1.7e-5\n-1.7e-5\n\n-1.1\n-1.1\n\n+.8\n+.8\n\n-1.1\n-1.1\n\n0.010\n0.010\n\n0.011\n0.011\n\n0.0042\n0.0042\n\n74\n75\n\n76\n77\n\n53\n53\n\ngg \u2192 H (B.F.)\ngg \u2192 H (W)\n\n17\n17\n\nDJ500 TeV (B.F.)\nDJ500 TeV (W)\n\n0.022\n0.022\n\nDJ500 LHC (B.F.)\nDJ500 LHC (W)\n\n880\n880\n\n.94\n.94\n\n.68\n.68\n\n+.82\n+.82\n\n0.0068 0.0057 0.0048\n0.0068 0.0057 0.0048\n63\n63\n\n47\n47\n\n56\n57\n\nAcknowledgments\n\nThe authors would like to thank Joey Huston for encouraging this study. DB wishes to thank the United States\nNational Science Foundation for support from grant NSF 0427110 (UltraLight). CG wishes to thank the US Department of Energy for support from an Outstanding Junior Investigator award under grant DE-FG02-97ER41209.\nMRW wishes to thank the UK PPARC for support from grant PP/B500590/1.\n\n[1]\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n[8]\n[9]\n[10]\n[11]\n[12]\n[13]\n\n8\n\nJ. Huston, private communication.\nJ. Pumplin et al., JHEP 07, 012 (2002), hep-ph/0201195.\nT. Sjostrand, L. Lonnblad, S. Mrenna, and P. Skands (2003), hep-ph/0308153.\nH. Plothow-Besch, Comput. Phys. Commun. 75, 396 (1993).\nW. Giele et al., in The QCD/SM working group: Summary report (2002), hep-ph/0204316.\nD. Bourilkov (2003), hep-ph/0305126.\nM. R. Whalley, D. Bourilkov, and R. C. Group (2005), hep-ph/0508110.\nG. Corcella et al., JHEP 01, 010 (2001), hep-ph/0011363.\nW. T. Giele, S. A. Keller, and D. A. Kosower (2001), hep-ph/0104052.\nJ. Pumplin et al., Phys. Rev. 65 (2002), hep-ph/0101032.\nP. M. Nadolsky and Z. Sullivan, eConf C010630, P510 (2001), hep-ph/0110378.\nZ. Sullivan, Phys. Rev. D66, 075011 (2002), hep-ph/0207290.\nS. Gieseke, JHEP 01, 058 (2005), hep-ph/0412342.\n\n\f"}