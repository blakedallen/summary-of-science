{"id": "http://arxiv.org/abs/astro-ph/0106120v3", "guidislink": true, "updated": "2001-06-15T01:48:46Z", "updated_parsed": [2001, 6, 15, 1, 48, 46, 4, 166, 0], "published": "2001-06-07T06:23:59Z", "published_parsed": [2001, 6, 7, 6, 23, 59, 3, 158, 0], "title": "PTHalos: A fast method for generating mock galaxy distributions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0106205%2Castro-ph%2F0106368%2Castro-ph%2F0106200%2Castro-ph%2F0106020%2Castro-ph%2F0106317%2Castro-ph%2F0106004%2Castro-ph%2F0106003%2Castro-ph%2F0106387%2Castro-ph%2F0106162%2Castro-ph%2F0106234%2Castro-ph%2F0106182%2Castro-ph%2F0106472%2Castro-ph%2F0106446%2Castro-ph%2F0106572%2Castro-ph%2F0106460%2Castro-ph%2F0106264%2Castro-ph%2F0106513%2Castro-ph%2F0106274%2Castro-ph%2F0106277%2Castro-ph%2F0106127%2Castro-ph%2F0106098%2Castro-ph%2F0106438%2Castro-ph%2F0106543%2Castro-ph%2F0106010%2Castro-ph%2F0106128%2Castro-ph%2F0106014%2Castro-ph%2F0106363%2Castro-ph%2F0106235%2Castro-ph%2F0106146%2Castro-ph%2F0106531%2Castro-ph%2F0106526%2Castro-ph%2F0106077%2Castro-ph%2F0106349%2Castro-ph%2F0106120%2Castro-ph%2F0106305%2Castro-ph%2F0106160%2Castro-ph%2F0106299%2Castro-ph%2F0106211%2Castro-ph%2F0106070%2Castro-ph%2F0106397%2Castro-ph%2F0106233%2Castro-ph%2F0106404%2Castro-ph%2F0106174%2Castro-ph%2F0106419%2Castro-ph%2F0106015%2Castro-ph%2F0106550%2Castro-ph%2F0106480%2Castro-ph%2F0106364%2Castro-ph%2F0106369%2Castro-ph%2F0106367%2Castro-ph%2F0106056%2Castro-ph%2F0106351%2Castro-ph%2F0106516%2Castro-ph%2F0106276%2Castro-ph%2F0106362%2Castro-ph%2F0106384%2Castro-ph%2F0106297%2Castro-ph%2F0106571%2Castro-ph%2F0106447%2Castro-ph%2F0106574%2Castro-ph%2F0106497%2Castro-ph%2F0106377%2Castro-ph%2F0106294%2Castro-ph%2F0106461%2Castro-ph%2F0106081%2Castro-ph%2F0106136%2Castro-ph%2F0106441%2Castro-ph%2F0106201%2Castro-ph%2F0106533%2Castro-ph%2F0106426%2Castro-ph%2F0106033%2Castro-ph%2F0106390%2Castro-ph%2F0106405%2Castro-ph%2F0106242%2Castro-ph%2F0106249%2Castro-ph%2F0106184%2Castro-ph%2F0106485%2Castro-ph%2F0106007%2Castro-ph%2F0106467%2Castro-ph%2F0106232%2Castro-ph%2F0106495%2Castro-ph%2F0106086%2Castro-ph%2F0106379%2Castro-ph%2F0106332%2Castro-ph%2F0106545%2Castro-ph%2F0106118%2Castro-ph%2F0106310%2Castro-ph%2F0106026%2Castro-ph%2F0106208%2Castro-ph%2F0106011%2Castro-ph%2F0106085%2Castro-ph%2F0106417%2Castro-ph%2F0106280%2Castro-ph%2F0106067%2Castro-ph%2F0106416%2Castro-ph%2F0106292%2Castro-ph%2F0106488%2Castro-ph%2F0106071%2Castro-ph%2F0106005%2Castro-ph%2F0106273%2Castro-ph%2F0106231&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "PTHalos: A fast method for generating mock galaxy distributions"}, "summary": "Current models of galaxy formation applied to understanding the large-scale\nstructure of the universe have two parts. The first is an accurate solution of\nthe equations of motion for the dark matter due to gravitational clustering.\nThe second consists of making physically reasonable approximations to the\nbehavior of baryons inside dark matter halos. The first uses large,\ncomputationally intensive, $n$-body simulations. We argue that because the\nsecond step is, at least at present, uncertain, it is possible to obtain\nsimilar galaxy distributions without solving the first step exactly. We\ndescribe an algorithm which is several orders of magnitude faster than n-body\nsimulations, but which is, nevertheless, rather accurate. The algorithm\ncombines perturbation theory with virialized halo models of the nonlinear\ndensity and velocity fields. For two- and three-point statistics the resulting\nfields are exact on large scales, and rather accurate well into the nonlinear\nregime, particularly for two-point statistics in real and redshift space. We\nthen show how to use this algorithm to generate mock galaxy distributions from\nhalo occupation numbers. As a first application, we show that it provides a\ngood description of the clustering of galaxies in the PSCz survey. We also\ndiscuss applications to the estimation of non-Gaussian contributions to error\nbars and covariance matrix of the power spectrum, in real and redshift space,\nfor galaxies and dark matter. The results for the latter show good agreement\nwith simulations, supporting the use of our method to constrain cosmological\nparameters from upcoming galaxy surveys.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0106205%2Castro-ph%2F0106368%2Castro-ph%2F0106200%2Castro-ph%2F0106020%2Castro-ph%2F0106317%2Castro-ph%2F0106004%2Castro-ph%2F0106003%2Castro-ph%2F0106387%2Castro-ph%2F0106162%2Castro-ph%2F0106234%2Castro-ph%2F0106182%2Castro-ph%2F0106472%2Castro-ph%2F0106446%2Castro-ph%2F0106572%2Castro-ph%2F0106460%2Castro-ph%2F0106264%2Castro-ph%2F0106513%2Castro-ph%2F0106274%2Castro-ph%2F0106277%2Castro-ph%2F0106127%2Castro-ph%2F0106098%2Castro-ph%2F0106438%2Castro-ph%2F0106543%2Castro-ph%2F0106010%2Castro-ph%2F0106128%2Castro-ph%2F0106014%2Castro-ph%2F0106363%2Castro-ph%2F0106235%2Castro-ph%2F0106146%2Castro-ph%2F0106531%2Castro-ph%2F0106526%2Castro-ph%2F0106077%2Castro-ph%2F0106349%2Castro-ph%2F0106120%2Castro-ph%2F0106305%2Castro-ph%2F0106160%2Castro-ph%2F0106299%2Castro-ph%2F0106211%2Castro-ph%2F0106070%2Castro-ph%2F0106397%2Castro-ph%2F0106233%2Castro-ph%2F0106404%2Castro-ph%2F0106174%2Castro-ph%2F0106419%2Castro-ph%2F0106015%2Castro-ph%2F0106550%2Castro-ph%2F0106480%2Castro-ph%2F0106364%2Castro-ph%2F0106369%2Castro-ph%2F0106367%2Castro-ph%2F0106056%2Castro-ph%2F0106351%2Castro-ph%2F0106516%2Castro-ph%2F0106276%2Castro-ph%2F0106362%2Castro-ph%2F0106384%2Castro-ph%2F0106297%2Castro-ph%2F0106571%2Castro-ph%2F0106447%2Castro-ph%2F0106574%2Castro-ph%2F0106497%2Castro-ph%2F0106377%2Castro-ph%2F0106294%2Castro-ph%2F0106461%2Castro-ph%2F0106081%2Castro-ph%2F0106136%2Castro-ph%2F0106441%2Castro-ph%2F0106201%2Castro-ph%2F0106533%2Castro-ph%2F0106426%2Castro-ph%2F0106033%2Castro-ph%2F0106390%2Castro-ph%2F0106405%2Castro-ph%2F0106242%2Castro-ph%2F0106249%2Castro-ph%2F0106184%2Castro-ph%2F0106485%2Castro-ph%2F0106007%2Castro-ph%2F0106467%2Castro-ph%2F0106232%2Castro-ph%2F0106495%2Castro-ph%2F0106086%2Castro-ph%2F0106379%2Castro-ph%2F0106332%2Castro-ph%2F0106545%2Castro-ph%2F0106118%2Castro-ph%2F0106310%2Castro-ph%2F0106026%2Castro-ph%2F0106208%2Castro-ph%2F0106011%2Castro-ph%2F0106085%2Castro-ph%2F0106417%2Castro-ph%2F0106280%2Castro-ph%2F0106067%2Castro-ph%2F0106416%2Castro-ph%2F0106292%2Castro-ph%2F0106488%2Castro-ph%2F0106071%2Castro-ph%2F0106005%2Castro-ph%2F0106273%2Castro-ph%2F0106231&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Current models of galaxy formation applied to understanding the large-scale\nstructure of the universe have two parts. The first is an accurate solution of\nthe equations of motion for the dark matter due to gravitational clustering.\nThe second consists of making physically reasonable approximations to the\nbehavior of baryons inside dark matter halos. The first uses large,\ncomputationally intensive, $n$-body simulations. We argue that because the\nsecond step is, at least at present, uncertain, it is possible to obtain\nsimilar galaxy distributions without solving the first step exactly. We\ndescribe an algorithm which is several orders of magnitude faster than n-body\nsimulations, but which is, nevertheless, rather accurate. The algorithm\ncombines perturbation theory with virialized halo models of the nonlinear\ndensity and velocity fields. For two- and three-point statistics the resulting\nfields are exact on large scales, and rather accurate well into the nonlinear\nregime, particularly for two-point statistics in real and redshift space. We\nthen show how to use this algorithm to generate mock galaxy distributions from\nhalo occupation numbers. As a first application, we show that it provides a\ngood description of the clustering of galaxies in the PSCz survey. We also\ndiscuss applications to the estimation of non-Gaussian contributions to error\nbars and covariance matrix of the power spectrum, in real and redshift space,\nfor galaxies and dark matter. The results for the latter show good agreement\nwith simulations, supporting the use of our method to constrain cosmological\nparameters from upcoming galaxy surveys."}, "authors": ["Roman Scoccimarro", "Ravi K. Sheth"], "author_detail": {"name": "Ravi K. Sheth"}, "author": "Ravi K. Sheth", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1046/j.1365-8711.2002.04999.x", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/astro-ph/0106120v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/astro-ph/0106120v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "13 pages, 10 figures. (references added)", "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/astro-ph/0106120v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/astro-ph/0106120v3", "journal_reference": "Mon.Not.Roy.Astron.Soc. 329 (2002) 629-640", "doi": "10.1046/j.1365-8711.2002.04999.x", "fulltext": "Mon. Not. R. Astron. Soc. 000, 000,000 (0000)\n\nPrinted 29 October 2018\n\n(MN LATEX style file v1.4)\n\nPTHalos: A fast method for generating mock galaxy\ndistributions\nRom\u00e1n Scoccimarro1 and Ravi K. Sheth2\n1 Department\n\nof Physics, New York University, 4 Washington Place, New York, NY 10003\nAstrophysics Center, P.O.Box 500, Batavia, IL 60510\n\narXiv:astro-ph/0106120v3 15 Jun 2001\n\n2 NASA/FermiLab\n\n29 October 2018\n\nABSTRACT\n\nCurrent models of galaxy formation applied to understanding the large-scale structure of the universe have two parts. The first is an accurate solution of the equations\nof motion for the dark matter due to gravitational clustering. The second consists of\nmaking physically reasonable approximations to the behavior of baryons inside dark\nmatter halos. The first uses large, computationally intensive, n-body simulations. We\nargue that because the second step is, at least at present, uncertain, it is possible to\nobtain similar galaxy distributions without solving the first step exactly.\nWe describe an algorithm which is several orders of magnitude faster than nbody simulations, but which is, nevertheless, rather accurate. The algorithm combines\nperturbation theory with virialized halo models of the nonlinear density and velocity\nfields. For two- and three-point statistics the resulting fields are exact on large scales,\nand rather accurate well into the nonlinear regime, particularly for two-point statistics\nin real and redshift space. We then show how to use this algorithm to generate mock\ngalaxy distributions from halo occupation numbers. As a first application, we show\nthat it provides a good description of the clustering of galaxies in the PSCz survey.\nWe also discuss applications to the estimation of non-Gaussian contributions to\nerror bars and covariance matrix of the power spectrum, in real and redshift space,\nfor galaxies and dark matter. The results for the latter show good agreement with\nsimulations, supporting the use of our method to constrain cosmological parameters\nfrom upcoming galaxy surveys.\nKey words: cosmology: large-scale structure of the universe; methods: numerical\n\n1\n\nINTRODUCTION\n\nUpcoming large galaxy surveys will provide a major advance in our understanding of the large-scale structure of\nthe universe, helping to determine cosmological parameters,\nconstrain models of galaxy formation and the properties\nof primordial fluctuations that gave rise to galaxies. However, extracting information about cosmological parameters\nfrom the galaxy distribution requires an accurate modeling\nof non-linear effects such as gravitational evolution, redshift\ndistortions, and galaxy biasing (i.e., the relationship between\nthe galaxy and the underlying dark matter distribution).\nThe physics of galaxy formation is not yet fully understood. Numerical simulations which include the effects\nof both gravitational instability as well as gas hydrodynamics in cosmological volumes are only now becoming available\n(e.g. Cen & Ostriker 2000; Pearce et al. 2001). But the role of\nfeedback from star formation, and how to incorporate it into\nsimulations, remains uncertain. As a result, a complemenc 0000 RAS\n\ntary approach to generating realistic galaxy distributions\nhas been to use semianalytic models (see, e.g., Kauffmann\net al. 1999; Somerville & Primack 1999; Cole et al. 2000).\nThese models build on the work of White & Rees (1978)\nand White & Frenk (1991), in which galaxy formation is\ntreated as a two-stage process: dark matter haloes virialize,\nand gas cools and forms stars within these virialized halos. The first step is solved numerically: n-body simulations\nof nonlinear gravitational clustering are used to follow the\nformation of the dark matter halos. The second step uses\na number of reasonable prescriptions for approximating the\ncomplicated nonlinear physics of gas cooling in gravitational\npotential wells to incorporate star and galaxy formation into\nthe simulations which otherwise only describe the effects of\ngravitational clustering. The predictions of the semi-analytic\nmodels, while similar to those from smoothed particle simulations which solve the hydrodynamic equations for the gas\nnumerically, can differ by as much as fifty percent in the twopoint correlation function (e.g. Benson et al. 2001). There-\n\n\f2\n\nR. Scoccimarro and R. K. Sheth\n\nfore, it is this second step which is the more uncertain one,\nsince we do not yet understand galaxy formation from first\nprinciples. On the other hand, it is the first step which is\nthe most time consuming.\nIn this paper we present a method which generates realistic galaxy distributions in a very small fraction of the\ntime it takes for methods that require n-body simulations of\ngravitational clustering. By realistic distributions, we mean\nspecifically that the point distributions our method generates can reproduce the observed galaxy clustering statistics;\nin particular, the distribution of galaxy counts-in-cells, the\npower spectrum and the bispectrum. The philosophy of our\napproach is that since the step which involves generating\ngalaxies from knowledge of the dark matter distribution is\nnecessarily uncertain, one does not need to start with a fully\ncorrect dark matter distribution to generate galaxy correlations to the extent allowed by the present understanding of\ngalaxy formation. By suitably approximating the non-linear\nstructures which form in the gravitational clustering simulations, one can hope to still obtain a reasonably accurate\ngalaxy distribution by slightly altering the mapping from\ndark matter to galaxies within the uncertainties.\nTo obtain an approximation to the fully nonlinear dark\nmatter distribution we first generate the large-scale dark\nmatter distribution using second-order Lagrangian perturbation theory (2LPT). This reproduces the correct two and\nthree-point statistics at large scales, and approximates the\nfour-point and higher-order statistics very well (Moutarde\net al. 1991; Buchert et al. 1994; Bouchet et al. 1995; Scoccimarro 2000). Note that use of 2LPT, rather than linear\ntheory or the Zel'dovich approximation, is essential to incorporate accurately the large-scale departures from Gaussian\ninitial conditions.\nThe 2LPT correlations are incorrect on small scales,\nwhere perturbation theory breaks down. We build up more\naccurate small-scale correlations by using the amplitude of\nthe 2LPT density field to determine the masses and positions\nof virialized halo centers, and we then distribute particles\naround the halo centers with realistic density profiles. We\nuse the 2LPT code described by Scoccimarro (1998,2000)\nto set up the perturbation theory density and velocity\nfields, and the merger history algorithm of Sheth & Lemson (1999b) to partition the 2LPT density field into haloes.\nFinally, a galaxy distribution can be generated by specifying how many galaxies populate haloes of a given mass (e.g.\nMo, Jing & B\u00f6rner 1997; Jing, Mo & B\u00f6rner 1998). In this\nrespect, our PTHalos algorithm treats the difference between\nthe clustering statistics of the dark matter and galaxy distributions in much the same way that recent analytic models (Peacock & Smith 2000; Seljak 2000; Scoccimarro et al.\n2001) do.\nIn this paper, we do not attempt to match other galaxy\nproperties (e.g. the luminosity function) than clustering\nstatistics. Statistics like the luminosity function can be estimated rather easily by simply replacing the dark matter\ndistribution of an n-body simulation with the PTHalos distribution, and then running the usual semianalytic galaxy\nformation codes on top. Our motivation was mainly to develop a fast algorithm which can be used to generate realistic non-Gaussian galaxy distributions, and thus provide a\nmethod to quickly explore parameter space for constraining\ncosmological parameters and galaxy formation models from\n\ngalaxy surveys. In addition, the speed of our code makes feasible to construct a large number of mock galaxy catalogs\nin a reasonable CPU time from which reliable estimation of\nerrors and covariance matrices can be derived. Application\nalong these lines to imaging data in the SDSS survey will\nbe considered elsewhere (Connolly et al. 2001; Dodelson et\nal. 2001; Scranton et al. 2001; Szalay et al. 2001; Tegmark\net al. 2001).\nThis paper is organized as follows. In Section 2 we review 2LPT. In Section 3 we describe how we parametrize\nhaloes and in Section 4 how we place them in the 2LPT density field. In Section 5, we compare the clustering statistics\nof the dark matter distribution of PTHalos to n-body simulations. In Section 6 we describe how we map from dark\nmatter to galaxies. We show that our method provides a\nsensible match to to the galaxies in the PSCz survey. We\nconclude in Section 7.\n\n2\n\nSECOND-ORDER LAGRANGIAN PT\n\nIn Lagrangian PT, the dynamics is described by the displacement field \u03a8(q) which maps the initial particle positions q into the final Eulerian particle positions x,\nx = q + \u03a8(q).\n\n(1)\n\nThe equation of motion for particle trajectories x(\u03c4 ) is\ndx\nd2 x\n+ H(\u03c4 )\n= \u2212\u2207\u03a6,\n(2)\nd\u03c4 2\nd\u03c4\nwhere \u03a6 denotes the gravitational potential, and \u2207 the gradient operator in Eulerian coordinates x. Taking the divergence of this equation we obtain\nJ(q, \u03c4 ) \u2207 *\n\nh d2 x\nd\u03c4 2\n\n+ H(\u03c4 )\n\ndx\n3\n= \u03a9m H2 (J \u2212 1),\nd\u03c4\n2\n\ni\n\n(3)\n\nwhere we have used Poisson equation together with the fact\nthat 1 + \u03b4(x) = J \u22121 , and the Jacobian J(q, \u03c4 ) is the determinant\n\n\u0011\n\n\u0010\n\nJ(q, \u03c4 ) \u2261 Det \u03b4ij + \u03a8i,j ,\n\n(4)\n\nwhere \u03a8i,j \u2261 \u2202\u03a8i /\u2202qj . Equation (3) can be fully rewritten in terms of Lagrangian coordinates by using that \u2207i =\n(\u03b4ij + \u03a8i,j )\u22121 \u2207qj , where \u2207q \u2261 \u2202/\u2202q denotes the gradient\noperator in Lagrangian coordinates. The resulting non-linear\nequation for \u03a8(q) is then solved perturbatively, expanding\nabout its linear solution, the Zel'dovich (1970) approximation\n\u2207q * \u03a8(1) = \u2212D1 (\u03c4 ) \u03b4(q).\n\n(5)\n\nHere \u03b4(q) denotes the (Gaussian) density field imposed by\nthe initial conditions and D1 (\u03c4 ) is the linear growth factor.\nThe solution to second order describes the correction to the\nZA displacement due to gravitational tidal effects and reads\n\u2207q * \u03a8(2) =\n\nX (1) (1)\n1\n(1) (1)\nD2 (\u03c4 )\n(\u03a8i,i \u03a8j,j \u2212 \u03a8i,j \u03a8j,i ),\n2\n\n(6)\n\ni6=j\n\n(e.g., Bouchet et al. 1995) where D2 (\u03c4 ) denotes the secondorder growth factor, which for flat models with non-zero\ncosmological constant \u039b we have for 0.01 \u2264 \u03a9m \u2264 1\n3\n3\nD2 (\u03c4 ) \u2248 \u2212 D12 (\u03c4 ) \u03a9\u22121/143\n\u2248 \u2212 D12 (\u03c4 ),\nm\n7\n7\n\n(7)\n\nc 0000 RAS, MNRAS 000, 000,000\n\n\fPTHalos: A fast method for generating mock galaxy distributions\nto better than 0.6% and 2.6%, respectively (Bouchet et al.\n1995). Since Lagrangian solutions up to second-order are\ncurl-free, it is convenient to define Lagrangian potentials\n\u03c6(1) and \u03c6(2) so that in 2LPT\nx(q) = q \u2212 D1 \u2207q \u03c6(1) + D2 \u2207q \u03c6(2) ,\n\n(8)\n\nand the velocity field then reads (t denotes cosmic time)\ndx\n= \u2212D1 f1 H \u2207q \u03c6(1) + D2 f2 H \u2207q \u03c6(2) ,\n(9)\ndt\nwhere H is the Hubble constant, and the logarithmic derivatives of the growth factors fi \u2261 (d ln Di )/(d ln a) can be approximated for flat models with non-zero cosmological constant \u039b and 0.01 \u2264 \u03a9m \u2264 1\n\nv\u2261\n\nf1 \u2248 \u03a95/9\nm ,\n\nf2 \u2248 2 \u03a96/11\nm ,\n\n(10)\n\n3\n\nTherefore, in what follows, we will make the simplifying assumption that all virialized haloes are spherical. (In fact,\nhaloes have a range of shapes; allowing for a distribution\nof shapes is a detail which does not change the logic of our\nmethod, so we will comment on it in more detail later.)\nWe will approximate the effects of fully nonlinear clustering in two steps. First, we need a prescription for dividing up the 2LPT density field into a collection of virialized\nhaloes. Once this has been done, we must decide how to distribute the mass associated with each halo around the halo\ncentre-of-mass. This second step is more straightforward, so\nwe will describe it first.\n\n3.1\n\nVirialized halo profiles\n\nto better than 10% and 12%, respectively (Bouchet et al.\n1995). The accuracy of these two fits improves significantly\nfor \u03a9m \u2265 0.1, in the range relevant according to present\nobservations. The time-independent potentials in Eqs. (8)\nand (9) obey the following Poisson equations (Buchert et al.\n1994)\n\nAs noted above, we will assume that all dark matter haloes\nare spherically symmetric. High resolution n-body simulations (Navarro, Frenk & White 1997) show that the spherically averaged density run around the centre of a virialized\nhalo containing mass m within the virial radius rvir is well\nfit by\n\n\u22072q \u03c6(1) (q)\n\n\u03c1(r)\n\u2206vir (z) c3 f (c)\n=\n,\n\u03c1\u0304\n3\u03a9(z) x(1 + x)2\n\n\u22072q \u03c6(2) (q)\n\n=\n\n\u03b4(q),\n\n=\n\nX\n\n(11)\n(1)\n\n(1)\n\n(1)\n\n[\u03c6,ii (q) \u03c6,jj (q) \u2212 (\u03c6,ij (q))2 ].\n\n(12)\n\ni>j\n\nThus, 2LPT positions and velocities can all be determined from the initial fluctuation field. In practice, we generate 2LPT positions and velocities using the algorithm\ndescribed in detail in Appendix D of Scoccimarro (1998),\nwhere the Poisson equations are solved by standard fast\nFourier transform methods. As mentioned before, 2LPT\nrecovers the exact two and three-point statistics at large\nscales, and approximates very well higher-order ones (see\ne.g. Fig. 15 in Bouchet et al. 1995, and Table 2 in Scoccimarro 2000). It is possible to improve on 2LPT by going to\nthird-order in the displacement field (3LPT), however it becomes more costly due to the need of solving three additional\nPoisson equations (Buchert 1994). 3LPT reproduces exactly\nup to four-point statistics, and improves the behavior in the\nunderdense regions (where 2LPT tends to overestimate the\ndensity, see Bouchet et al. 1995).\n\n3\n\nFROM 2LPT TO VIRIALIZED HALOES\n\nThe end result of 2LPT is a list of particle positions and\nvelocities. These positions and velocities are not quite the\nsame as those the particles would have had in a full n-body\nsimulation which started from the same initial conditions.\nThis section describes how to use our knowledge of fully\nnonlinear density and velocity fields to increase the agreement with simulations.\nThe primary difference between the 2LPT density field\nand that from a full n-body simulation of nonlinear gravitational clustering is that the 2LPT density field has no\nvirialized objects. In a full simulation, however, most of the\nmass in a simulation box is partitioned into virialized haloes\n(e.g. Tormen 1998). For our purposes here, all virialized objects have well defined edges, and the edge, called the virial\nradius, is defined so that all virialized haloes have the same\n3\nspherically averaged density, whatever their mass: m \u221d rvir\n.\nc 0000 RAS, MNRAS 000, 000,000\n\nwhere x \u2261 c(m)\n\nr\n,\nrvir\n\n(13)\n\nwhere \u03c1\u0304(z) is the average density of the background universe\nat z, \u03c1\u0304(z) \u2206vir (z)/\u03a9(z) is the average density within the\nvirial radius (\u2206vir \u2248 178 for all z in an Einstein de-Sitter universe; it is \u2248 102 at z = 0 for the \u039bCDM model we present\nresults for in this paper), and f (c) = [ln(1+c)\u2212c/(1+c)]\u22121 .\nThe density run is a broken power-law, with a shallower inner slope and a steeper outer slope. The exact shape of these\ntwo slopes is the subject of some debate. Although we will\nuse the NFW form in what follows, it is trivial to modify\nour algorithm to generate profiles of the form given, e.g., by\nHernquist (1990) or by Moore et al. (1999). The parameter c\nis often called the central concentration of the halo. As NFW\nnoted, more massive haloes are less centrally concentrated.\nWe will use the parametrization of this trend provided by\nBullock et al. (2001):\nc(m) \u2248\n\n9\nm\n(1 + z) m\u22170\n\n\u0010\n\n\u0011\u22120.13\n\n,\n\n(14)\n\nwhere m\u22170 is the standard non-linear mass scale (defined in\nthe next subsection). Numerical simulations show that not\nall haloes of mass m have the same density profile, there\nis considerable scatter. Fortunately, this scatter is well fit\nby using the same NFW shape for all haloes, but letting\nthe concentration parameter have a Lognormal distribution\nwith dispersion \u2206(log c) \u2248 0.2 (Jing 2000; Bullock et al.\n2001). We include this scatter in PTHalos.\nEquation (13) says that if the centre of mass of an mhalo is at position x, then there will be Ndm \u221d m particles\ndistributed around x according to equation (13). This is easily done. For example, if the halo profile were an isothermal\nsphere (\u03c1 \u221d r \u22122 ), then particle positions around the halo\ncentre (r, \u03b8, \u03c6) could be got by drawing random numbers\ndistributed uniformly between zero and rvir for the radial\ndistance r from the centre, uniform numbers between plus\nand minus one for cos \u03b8, and uniform numbers between zero\nand two pi for \u03c6. Generating an NFW profile is only slightly\nmore complicated.\n\n\f4\n\nR. Scoccimarro and R. K. Sheth\n\nFigure 1. A slice of 2LPT, 150 Mpc/h a side and 6 Mpc/h thick.\n\nFigure 2. The same slice as previous figure for PTHalos.\n\nBecause the density run depends on halo mass m, the\ntrick is to identify those positions in the 2LPT density field\nwhich should be identified with the centres-of-masses of mhaloes. The next subsection describes how to do this.\n\n3.2\n\nHalo masses and positions\n\nImagine comparing the 2LPT density and velocity fields\nwith those from an n-body simulation which started from\nthe same initial fluctuation field. One might imagine that the\n2LPT density and velocity fields contain information about\nwhere bound objects in the n-body simulation formed. For\nexample, perhaps the densest 2LPT regions are those regions\nwhich, in the n-body simulation, collapsed to form bound\nc 0000 RAS, MNRAS 000, 000,000\n\n\fPTHalos: A fast method for generating mock galaxy distributions\n\n5\n\nhaloes. If so, then one might imagine running a friends-offriends group finder on the 2LPT density field to identify\nthese overdense regions. One could then use the number of\nparticles associated with the friends-of-friends group as an\nestimate of the mass of the virialized halo which formed\nin the n-body simulation, and the position of the centreof-mass of the group could be used as an estimate of the\nposition of the corresponding halo. While such a procedure\nis possible in principle, running a group-finder can be quite\ntime-consuming. This is the primary reason why we have\nadopted the approach we describe below.\nAt any given time, which we will label by redshift z,\nvirialized haloes have a wide range of masses. Let n(m|z)\ndenote the comoving number density of haloes of mass m at\nz. The shape of this universal mass function distribution is\nwell approximated by\n\nin the different density cells follows the correct n(m, \u03b4|z)\nrelation.\nWe can do this as follows. The actual nonlinear density\nin V at z is given by M/V \u2261 \u03c1\u0304(1 + \u03b4). Let \u03b40 denote the\nvalue for the overdensity one would have predicted for such\na region, had one used linear theory to make the prediction. Typically, we expect that if \u03b4 > 0, then \u03b40 < \u03b4, and\nviceversa for underdense regions. A simple fitting formula to\nthe relation between the nonlinear and the linear overdensities, \u03b4 and \u03b40 , got from assuming that objects form from a\nspherical collapse in an Einstein-deSitter universe, has been\nprovided by Mo & White (1996). We have checked that the\nfollowing simple modification to their formula is accurate for\nall cosmologies of interest:\n\ndln\u03bd\nm2 n(m|z)\n= \u03bdf (\u03bd)\n,\n\u03c1\u0304\ndlnm\n\n\u03b4sc (z)\n.\n(19)\n1.68647\nNow, what we are trying to do is to partition the mass\nM in V at z up into subregions, each of nonlinear density\n\u2206vir (z) \u226b 1, and hence each with predicted linear density\n\u03b4sc (z).\nThis is extremely similar to what one does when one\nstudies the merger histories of objects. Given the mass\nM and the linear theory density \u03b40 associated with that\nmass, one studies the distribution of subclumps mj of M\nat some earlier time when the critical density for collapse\nwas \u03b4sc (z). A number of merger history tree codes which\ndo this are available. The algorithm described by Sheth &\nLemson (1999b) is simple and efficient, so we will use it to\npartition the 2LPT mass M up into virialized haloes. The\nonly difference is that, whereas they were trying to generate\nthe Press-Schechter mass function, we would like to generate the distribution which fits the simulations better. This\ncan be done by making the following simple change to their\nalgorithm.\nSheth & Lemson's algorithm loops over a range of 'time'\nsteps, chooses a series of Gaussian random numbers gi at\neach time step, and then, for each i, makes use of gi\u22122 . Their\nalgorithm is fast because there are efficient ways to generate\nGaussian variates. Therefore, if we modify the algorithm, we\nwould like to do it in such a way that it still requires only\nGaussian variates. For \u039bCDM we have found that requiring\nthe number of 'time' steps to equal ten, and then using a [3+\n0.33/(1 + |gi |1.5 )]/|gi | instead of gi\u22122 , where a = 0.707 is the\nsame parameter as in equation (16), is all that is required\nto generate a mass function which is more like the n-body\nsimulations (see Fig. 3).\nNotice that because (1 + \u03b4) \u2264 \u2206vir , equation (19) guarantees that \u03b40 \u2264 \u03b4sc (z). Therefore, in essence, by using a\nmerger tree code to perform the partition, we are making\nuse of the following fact: a dense cell can be thought of as a\nregion which will, at some point in the near future, become\na virialized object. Therefore, when we view a dense cell at\nthe present time, it is as though we are viewing a virialized\nobject at a small 'lookback time' from the time it virialized.\nAt small lookback times, most of the mass M of an object\nis likely to be partitioned up into just a few pieces which\nare each a substantial fraction of M , because there has not\nbeen enough time for M to have been split up into many\nsmaller pieces. In hierarchical clustering models, the oppo-\n\n(15)\n\nwhere \u03c1\u0304 denotes the comoving density of the background,\nand\n\n\u0010\n\n2 \u2212p\n\n\u03bdf (\u03bd) = 2A 1 + (a\u03bd )\n\n\u0011\u0012\n\na\u03bd 2\n2\u03c0\n\n\u00131/2\n\n\u0012\n\na\u03bd 2\nexp \u2212\n2\n\n\u0013\n\n.\n\n(16)\n\nHere \u03bd \u2261 \u03b4sc (z)/\u03c3(m, z) where \u03b4sc (z) is the collapse threshold given by the spherical collapse model (e.g. it is 1.68 in\nan Einstein-deSitter universe), \u03c3 2 (m, z) is the linear theory\nvariance in the density field when smoothed on the comoving\nscale R = (3m/4\u03c0 \u03c1\u0304)1/3 at z, and A = 0.5, 0.322, p = 0, 0.3\nand a = 1, 0.707 for the mass functions given by Press &\nSchechter (1974) and Sheth & Tormen (1999), respectively.\n(Sheth, Mo & Tormen 2001 show that these two cases may\nbe related to models in which objects form from spherical or\nellipsoidal collapses, respectively. Jenkins et al. (2001) compare these mass functions with n-body simulations.) The\nnumber of haloes falls exponentially at large masses. Let\nm\u2217 denote the mass at which this cut-off sets in. Then m\u2217\nis defined by requiring \u03c3(m\u2217 , z) \u2261 \u03b4sc (z). The quantity m\u22170\nwhich should be used in equation (14) is got from setting\n\u03c3(m\u22170 , 0) \u2261 \u03b4sc (0).\nThe distribution of haloes in dense regions is different\nfrom that in underdense regions: n(m, \u03b4|z) 6= (1 + \u03b4) n(m|z),\nwhere \u03b4 denotes the overdensity of the region. For example,\nthe ratio of massive to less massive haloes is larger in dense\nregions than in underdense ones. A simple model for this\ndependence is\n\nh\n\ni\n\nn(m, \u03b4|z) \u2248 1 + b(m|z) \u03b4 n(m|z),\n\n(17)\n\nwhere \u03b4 \u2261 M/\u03c1\u0304V \u2212 1, and\nb(m|z) = 1 +\n\n2p/\u03b4sc (z)\na\u03bd 2 \u2212 1\n+\n\u03b4sc (z)\n1 + (a\u03bd 2 )p\n\n(18)\n\n(Mo & White 1996; Sheth & Tormen 1999). The actual detailed dependence of n(m, \u03b4|z) on \u03b4 can be computed following Lemson & Kauffmann (1999), Sheth & Lemson (1999a)\nand Sheth & Tormen (2001), so we will not repeat the analysis here.\nIf we place a grid on the 2LPT density field, then some\nof the cells will be denser than others. We must find an\nalgorithm which ensures that the distribution of halo masses\nc 0000 RAS, MNRAS 000, 000,000\n\n\u03b40 =\n\n\u0014\n\n1.68647 \u2212\n\n1.35\n1.12431\n0.78785\n\u2212\n+\n(1 + \u03b4)0.58661\n(1 + \u03b4)2/3\n(1 + \u03b4)1/2\n\u00d7\n\n\u0015\n\n\f6\n\nR. Scoccimarro and R. K. Sheth\nmotion of the halo as a whole (Sheth & Diaferio 2001). Furthermore, the virial motions within a halo are well approximated by velocities which are independent Gaussians in each\nof the three cartesian components, with rms values which\n2\n2\n= hvvir\ni \u221d Gm/rvir \u221d m2/3 . In\ndepend on halo mass: \u03c3vir\nparticular, we use (Bryan & Norman 1998; Sheth & Diaferio\n2001)\n\u03c3vir = 476fvir (\u2206nl E(z)2 )1/6\n\nFigure 3. The halo mass function at z = 1 (top) and z = 0 (bottom). In each panel, squares show the output from PTHalos, solid\nline shows the fitting function which describes the n-body simulations, and dashed line shows the Press\u2013Schechter mass function.\nStars and circles in the bottom panel show the mass function in\nthe densest and the least dense three percent of the box at z = 0.\nThese results correspond to flat \u039bCDM realizations (\u03c38 = 0.9,\n\u03a9m = 0.3 at z = 0) in a 100 Mpc/h box with mass resolution\nmmin = 1010.5 M\u2299 /h and Rgrid = 12.5 Mpc/h.\n\nsite is true at large lookback times. This provides a simple\nreason why the ratio of massive to less massive haloes is\nlarger in dense regions than in underdense ones. In particular, this shows that when we partition the mass of a cell\nup as though we were partitioning the mass of a virialized\nhalo up into subhaloes at high redshift, the only decision to\nbe made is which redshift, which 'lookback time', to choose\nwhen running the merger tree algorithm. We have argued\nabove that this choice depends on \u03b4: the exact transformation is given by equation (19).\nTo summarize, given the mass M and the 2LPT overdensity \u03b4 in a cell V , a merger tree algorithm is used to\nsplit M up into virialized haloes mj . The next step is to\ndecide where within V to place the halo centres. We do this\nby assuming that the most massive haloes within V occupy\nthe densest subregion within V . Once this has been done,\nall that remains is to distribute particles around each halo\ncentre as described in the previous subsection.\n\n3.3\n\nNonlinear velocities\n\nThe final step is to account for the differences between the\n2LPT and n-body velocity fields. In the n-body simulations,\nit is a good approximation to assume that the motion of a\nparticle can be written as the sum of two terms:\nv = vvir + vhalo ,\n\n(20)\n\nwhere the first term represents the virial motion of the particle within its parent halo, and the second term is the bulk\n\n\u0010\n\nm\n1015 M\u2299 /h\n\n\u00111/3\n\nkm/s,\n\n(21)\n\nwhere fvir = 0.9 and \u2206nl = 18\u03c0 2 + 60x \u2212 32x2 with x =\n\u03a9(z) \u2212 1, \u03a9(z) = \u03a90 (1 + z)3 /E(z)2 , E(z)2 = \u03a90 (1 + z)3 + \u03a9\u039b\nfor a flat model with cosmological constant.\nWe assume that virial motions are uncorrelated with\nthe direction or amplitude of vhalo . Therefore, if we substitute the 2LPT velocity vector at the position of the halo\ncentre-of-mass for vhalo , and then add an uncorrelated vector of virial motions to each particle, and we do this for\neach of the particles in the halo, then the resulting velocity\nfield should be quite similar to that in the n-body simulations. This is essentially a numerical implementation of the\nanalytical model developed in Sheth et al (2001).\nThis is the final step in converting the 2LPT density and\nvelocity fields to fields which resemble the n-body simulations more closely. The next section describes the algorithm\nwhich implements all of this.\n\n4\n4.1\n\nPTHALOS\nThe Algorithm\n\nGiven a realization of the large-scale density field, PTHalos\nassigns halo centers to appropriate 2LPT particles, and then\ngenerates NFW density profiles around them. This is done\nas follows.\n\u2022 The desired mass resolution mmin , the size of the simulation volume, and the cosmological model set the abundance of halos of mass larger than mmin , Nhalos . Since halo\ncenters are going to be identified as 2LPT particles, this sets\nthe number of 2LPT particles to be used, N2LPT \u2248 Nhalos ,\nand thus their mass m2LPT .\n\u2022 The 2LPT box is divided into cubic cells of size Rgrid ,\nand the mass in 2LPT particles Mi in each cell i is obtained. The choice of Rgrid is dictated by the competing\nrequirements that it be small enough so that the mass distribution is not rearranged at large scales (to preserve the\ncorrect correlations imposed by 2LPT), and large enough so\nthat, within the cell, there can be halos sufficiently massive.\nUnless otherwise noted, we use Rgrid = 15 Mpc/h. This corresponds roughly to a spherical cell of 8 Mpc/h radius which\nis the natural non-linear scale.\n\u2022 Then, a merger history code is run on each cell i, which\ngives a partition of the cell mass Mi into halos of smaller\nmass mj (Mi = m1 + m2 + ...) down to the mass resolution.\n\u2022 The 2LPT particles in a cell and the list of halos resulting from the merger history tree are matched so that\nmost massive halos are centered about 2LPT particles in the\ndensest regions. An exclusion volume of 2Mpc/h (1Mpc/h\nat z = 1) radius is imposed about 2LPT centers in densities larger than 5.6 (set by the turnaround density in the\nspherical collapse model). Halos of mass mj are constructed\nc 0000 RAS, MNRAS 000, 000,000\n\n\fPTHalos: A fast method for generating mock galaxy distributions\nabout their 2LPT centers by sampling the NFW profile with\nthe appropriate number of particles according to the mass\nresolution.\n\u2022 Velocities are assigned using v = v2LPT + vvir , where\nv2LPT is the velocity of the 2LPT particle representing the\nhalo center of mass, and vvir is a virial velocity drawn at random from a Maxwellian distribution with one-dimensional\ndispersion \u03c3vir (mj ) given by Eq. 21. We require that the\ncenter of mass velocity of each halo equals that of the associated v2LPT ; this is always possible because N2LPT >\n\u223c Nhalos .\nThis maintains the correct 2LPT correlations between density and velocity fields at large scales, which is important if\nwe wish to have the correct large-scale redshift-space statistics.\n\u2022 A galaxy distribution can be obtained by specifying how\nmany galaxies, Ngal (mj ) on average populate dark matter\nhalos of mass mj . Given this function, we use a binomial distribution (as explained in detail in Scoccimarro et al. 2001)\nto sample the NFW profile with the resulting number of\ngalaxies. Benson et al. (2000) describe one possible alternative to the binomial. The binomial model we use has two\nfree functions, the first and second moments of the number of galaxies per halo of mass m. The first moment is\nparametrized by a broken power-law with a low-mass cutoff, as described in Section 6; the second moment is related\nto the first taking into account that low-mass halos have a\nsub-Poisson dispersion (Kauffmann et al. 1999, Benson et\nal. 2000).\n\n7\n\nFigure 4. The power spectrum as a function of scale for \u039bCDM at\nz = 0 (top) and z = 1 (bottom). Symbols denote measurements in\nN-body simulations, solid lines correspond to PTHalos (averaged\nover 30 realizations), and dashed lines show linear perturbation\ntheory.\n\nFig. 1 shows a slice of 150 Mpc/h a side and 6 Mpc/h\nthick from a 2LPT distribution corresponding to \u039bCDM\nwith \u03a9m = 0.3, \u03a9\u039b = 0.7, \u03c38 = 0.90. Figure 2 shows the\nsame slice in PTHalos, after 2LPT high-density regions have\nbeen replaced by virialized halos.\n4.2\n\nMemory Requirements and Speed\n\nThe PTHalos code requires a memory of 50 bytes per particle in the simulation box. Most importantly, a 3003 particle realization takes only about 5 minutes to generate on\na single-CPU workstation, about 2 \u2212 3 orders of magnitude faster than n-body simulations. For particle numbers\n3\nNpar >\n\u223c 300 approximately equal time is spent generating\nthe 2LPT density field, imposing the spatial exclusion of\nmassive halos, generating profiles and velocities, and writing the output files to disk. From tests we have performed up\nto Npar = 4003 , the run time scales roughly as Npar ln(Npar ).\n\n5\n\nPTHALOS VS. NUMERICAL SIMULATIONS\n\nWe now turn to a quantitative comparison of clustering\nstatistics for the dark matter obtained from PTHalos to nbody simulations. Application of PTHalos to the distribution\nof PSCz galaxies is discussed in Section 6.\n5.1\n\nMass Function\n\nA first test of our algorithm is to check that we obtain the\ncorrect mass function of dark matter halos. Fig. 3 shows\nthe number density of haloes as a function of halo mass,\nfor a simulation box of side 100 Mpc/h, mass resolution\nc 0000 RAS, MNRAS 000, 000,000\n\nFigure 5. The power spectrum in redshift-space at z = 0 and\nz = 1. The top panel shows the power spectrum monopole, the\nbottom panel corresponds to the quadrupole to monopole ratio.\nLine styles are as in Fig 4. The dotted line in the bottom panel\nshows the fitting formula by Hatton & Cole (1999).\n\n\f8\n\nR. Scoccimarro and R. K. Sheth\n\nFigure 6. The skewness (S3 ) and kurtosis (S4 ) as a function of\nsmoothing scale R in real (top) and redshift (bottom) space. Circles denote measurements in ten PTHalos realizations, and squares\ncorrespond to the average over four n-body simulations.\n\nmmin = 1010.5 M\u2299 /h and Rgrid = 12.5 Mpc/h. The symbols show the universal mass function one gets after using\nthe merger tree algorithm to partition the 2LPT mass into\nhaloes, and the solid curves show the fitting formula which\ndescribes the universal mass function in n-body simulations\n(equations 15 and 16). The symbols match the curves quite\nwell, suggesting that our decision to use a merger tree algorithm was quite successful. The stars and circles in the z = 0\npanel show the mass function in the densest and the least\ndense three percent of the box. This shows that the densest\ncells contain the most massive haloes, as expected.\n\n5.2\n\nPower Spectrum in Real and Redshift Space\n\nFigure 4 shows the power spectrum for the \u039bCDM model\nat z = 0 (\u03c38 = 0.90, \u03a9m = 0.3, \u03a9\u039b = 0.7) and z = 1\n(\u03c38 = 0.55). The symbols in this and next figure denote\nthe measurements in n-body simulations taken from Scoccimarro, Couchman & Frieman (1999a). The simulation was\nrun by the Virgo Consortium; it corresponds to a single realization with 2563 particles in a 240 Mpc/h box. The dashed\nlines show the linear power spectrum, and the solid lines correspond to the measured power spectrum averaged over 30\nPTHalos realizations. Figure 5 shows similar measurements\nfor the power spectrum in redshift-space. The top panel corresponds to the monopole at z = 0 (top) and z = 1 (bottom)\nand the bottom panel shows the quadrupole to monopole ratio at z = 0 (bottom) and z = 1 (top). Error bars for the\nsimulations correspond to the dispersion among four different lines of sight for the redshift-space mapping, done in the\nplane-parallel approximation, as assumed throughout this\npaper.\n\nWe see that the agreement between PTHalos and numerical simulations is very good, especially considering the simplicity of our algorithm. Similar results hold for the SCDM\nmodel. In redshift space, the power spectrum monopole is\nsomewhat overestimated (for z = 0) at small scales, suggesting perhaps our model for virial velocities is oversimplified (consistent with the analytic results presented in Sheth\net al. 2001). Another possibility is inaccurate treatment of\nhalo spatial exclusion effects; in redshift space halo-halo correlations are important down to smaller scales than in real\nspace, because velocity dispersion suppresses halo profiles.\nWe shall come back to this point in the next subsection when\nwe study higher-order moments.\nThe excellent agreement shown for the quadrupole to\nmonopole ratio even at scales below zero-crossing is very\nencouraging, since until now there was no alternative to numerical simulations that could provide an accurate treatment of redshift distortions. The problem, as emphasized\nby Hatton & Cole (1998) is that phenomenological models,\nwhere linear perturbation theory predictions (Kaiser 1987)\nare convolved with a kernel which describes the effects of velocity dispersion (Peacock & Dodds 1994, Park et al. 1994),\ntend to underestimate non-linear effects at large scales. Similarly, recent models of redshift distortions based on the halo\nmodel (White 2001, Seljak 2001) which assume linear perturbation theory for halo-halo correlations do not accurately\nreproduce the quadrupole moment, although they provide a\ngood description of the power spectrum monopole (White\n2001).\nIn our case the large-scale (k <\n\u223c 0.2 h/Mpc) behavior of\nthe monopole and quadrupole is dictated by 2LPT and has\nlittle to do with velocity dispersion (unlike in phenomenological models), and is reproduced very accurately. In fact,\nthe bottom panel in Fig. 5 shows as dotted line the fitting\nformula found by Hatton & Cole (1999) empirically from an\nensemble of n-body simulations. This relation, valid at scales\nlarger than that of the quadrupole zero-crossing, fits our\nresults extremely well. A detailed explanation of how perturbation theory can accurately describe the large-scale behavior of power spectrum multipoles will be presented elsewhere. Essentially, the large-scale pairwise velocity along the\nline of sight is strong enough to suppress the power spectrum\nmonopole and drive the quadrupole to zero. The demonstration of this effect requires an accurate treatment of the nonlinear nature of the redshift-space mapping (Scoccimarro et\nal. 1999a), which in our numerical treatment is trivially implemented since 2LPT treats the dynamics perturbatively\nbut the mapping to redshift space is done exactly. Note that\nthe deviations from linear perturbation theory are not negligible, even at scales larger than the non-linear scale k \u2248 0.2\nh/Mpc, in particular for the quadrupole.\n5.3\n\nHigher-Order Moments in Real and Redshift\nSpace\n\nFigure 6 shows a comparison of PTHalos against n-body\nsimulations for higher-order moments of the density field in\nreal (top) and redshift (bottom) space. The figure shows the\nskewness S3 (R) and kurtosis S4 (R) as a function of smoothing scale R. Squares denote the average over 4 realizations\nof \u039bCDM with 1283 particles in a box of Lbox = 300 Mpc/h\na side, obtained by running the Hydra code (Couchman et\nc 0000 RAS, MNRAS 000, 000,000\n\n\fPTHalos: A fast method for generating mock galaxy distributions\nal. 1995). The circles denote the average of 10 realizations\nof PTHalos with 3003 particles in the same volume.\nThe agreement in real space is very good, particularly\nfor the skewness. The runs in this figure were made using\nRgrid = 20 Mpc/h, we found that for Rgrid = 15 Mpc/h, the\nskewness and kurtosis were underestimated at small scales\nR < 1 Mpc/h by 10% and 70%, respectively. Changing\nRgrid does not affect the power spectrum, but does affect\nincreasingly more the higher-order moments which are most\nsensitive to the presence of high-mass halos. The choice of\nRgrid = 15 Mpc/h is thus a bit small for Lbox = 300 Mpc/h,\nwhich leads to an underestimation of the number of very\nmassive halos (which occasionally share more than one cell\n15 Mpc/h a side).\nIn redshift space (bottom panel in Fig. 6) the situation\nis somewhat different, the small-scale skewness and kurtosis\nare actually higher in PTHalos than in n-body simulations.\nIncreasing artificially the value of the velocity dispersion of\nhalos, Eq. (21), does not fix the discrepancy (since the skewness and kurtosis are ratios of moments), suggesting perhaps\nthat the problem is due to our approximate treatment of\nhalo exclusion. More work is needed to fully understand the\norigin of this discrepancy.\n5.4\n\nPower Spectrum Covariance Matrix\n\nAs mentioned in the introduction, one of the motivations\nbehind PTHalos is to provide a efficient tool for calculating\naccurate error bars and covariance matrices for clustering\nstatistics including the effects of non-linear evolution, redshift distortions and galaxy biasing, that can be used to\nconstrain cosmological parameters, galaxy formation models and the statistics of primordial fluctuations from analysis\nof clustering in upcoming galaxy surveys.\nHere we consider what impact these effects have on the\nerror bars and covariance matrix of the power spectrum.\nAs it is well known, non-linear effects lead to increased error bars in individual band power estimates and introduce\ncorrelations between them that are absent in the Gaussian\ncase (Meiksin & White 1999; Scoccimarro, Zaldarriaga &\nHui 1999b; Hamilton 2000). In this Section we compare the\npredictions of PTHalos for the covariance matrix of the dark\nmatter power spectrum against the numerical simulation results in Scoccimarro et al. (1999b), and present results that\ninclude redshift distortions and galaxy biasing as well.\nAll the covariance matrices are calculated using 300 realizations of PTHalos. The SCDM (\u03a9m = 1, \u03c38 = 0.61) realizations contain 2003 particles in a box of side Lbox = 100\nMpc/h (identical volume and band power binning as the\nsimulations we compare to, with bin width \u03b4k = 2\u03c0/100\nh/Mpc). The \u039bCDM (\u03a9m = 0.3, \u03a9\u039b = 0.7, \u03c38 = 0.9) realizations contain 3003 particles in a box of side Lbox = 300\nMpc/h. Finally, we construct realizations of galaxy distributions as described above with halo occupation numbers\ngiven by Eq. (22), derived in the next section from comparison to the PSCz survey. These have about 21.4\u00d7106 galaxies\nin a box of side Lbox = 300 Mpc/h (we do not include the\nsurvey selection function, our only purpose here is to explore\nthe effects of galaxy weighing on the covariance matrix). In\nthese cases, the width of bins in k-space is \u03b4k = 0.05 h/Mpc\nFigure 7 shows the results from PTHalos (solid lines)\ncompared to the measurements obtained in Scoccimarro et\nc 0000 RAS, MNRAS 000, 000,000\n\n9\n\nal. (1999b) for the SCDM model. The top panel shows the\nratio of the power spectrum errors (diagonal elements of\nthe covariance matrix, Cii ) to those under the assumption\nG\nof Gaussianity, Cii\n. PTHalos seems to overestimate the errors at small scales by perhaps as much as 50%, although\nwe regard this as a preliminary result since our n-body results contain only 20 realizations. Indeed, from our PTHalos\nMonte Carlo pool we see that error bars estimated from\n20 realizations typically have a scatter of about 40% compared to the results from 300 realizations. The remaining three panels in\npFig. 7 show the cross-correlation coefficient, rij \u2261 Cij / Cii Cjj , between band powers centered\nat kj = 0.32, 0.88, 1.52 h/Mpc as a function ki . Here the\nagreement seems much better, although it seems PTHalos\nslightly overestimates cross-correlations.\nFigure 8 shows results in the same format as Fig. 7\nbut for \u039bCDM PTHalos realizations for the dark matter\npower spectrum covariance matrix in real space (solid lines),\nredshift space (dotted lines), and for galaxies [with halo\noccupation numbers given by Eq. (22)] in redshift space\n(dashed lines). The effects of redshift distortions is to suppress the non-Gaussian contribution to the errors and the\ncross-correlations between band powers (Meiksin & White\n1999; Scoccimarro et al. 1999b), due to the fact that velocity\ndispersion suppresses the higher-order moments, see Fig. 6.\nFor galaxies, there is the additional effect of weighing the\ncontribution of dark matter halos by the galaxy occupation\nnumber. At the scales shown here, this weighing suppresses\nnon-Gaussianity and thus errors and cross-correlations. We\nfind however that for k >\n\u223c 3 h/Mpc (not shown), where the\ngalaxy power spectrum is larger than the dark matter power\nspectrum, the situation reverses and galaxies have larger\nerrors and cross-correlations than dark matter (as can be\nguessed e.g. from the asymptotic behavior in the top panel\nof Fig. 8).\nAlthough galaxies in redshift space are generally less\naffected by non-Gaussianity, the effect is strong enough to\nbe very important for constraining cosmological parameters\nfrom galaxy redshift surveys. Methods developed to decorrelate band powers (Hamilton 2000) were shown to work very\nwell for the mass power spectrum when non-Gaussianities\nare modelled by the hierarchical model. It would be interesting to test these methods with PTHalos galaxy realizations\nto see how well they perform.\nAnother interesting application of our code would be to\nweak gravitational lensing, where studies have been made of\nerror bars and covariance matrices for the power spectrum\nand moments of the convergence field (White & Hu 1999,\nCooray & Hu 2000, Van Waerbeke et al 2001).\n\n6\n\nGALAXY DISTRIBUTIONS: APPLICATION\nTO THE PSCZ SURVEY\n\nAs discussed above, one the motivations behind PTHalos is\nto apply it to galaxy distributions, where its accuracy for\ngalaxy clustering is expected to be comparable to standard\nmethods which are computationally much more costly.\nAs a first example, we apply PTHalos to clustering in\nthe PSCz survey (Saunders et al. 2000) assuming an underlying \u039bCDM (\u03a9m = 0.3, \u03a9\u039b = 0.7) cosmology. We use\nthe following measurements of clustering statistics: the real-\n\n\f10\n\nR. Scoccimarro and R. K. Sheth\nspace power spectrum (Hamilton & Tegmark 2001) inverted\nfrom redshift-space, the skewness and kurtosis in redshift\nspace as a function of scale (Szapudi et al. 2000) and the\nredshift-space bispectrum (Feldman et al. 2001).\nIn order to specify a galaxy distribution, we need to\nspecify the moments of the number of galaxies Ngal per halo\nof mass m. We use a binomial distribution, as described in\nScoccimarro et al. (2001), which has only 2 free functions,\nthe first and second moments of Ngal (m). We relate these\ntwo by using the semianalytic model results of Kauffmann\net al. (1999), where the dispersion in Ngal (m) is sub-Poisson\nfor dark matter halos of mass m < 1013 M\u2299 /h, and Poisson\notherwise. We then searched for a first moment parametrized\nby a broken power-law that leads to a good match with the\nreal-space power spectrum of PSCz galaxies, and found\nh Ngal (m) i = 0.7 (m/m0 )\u03b1 ,\n\nFigure 7. The Power Spectrum Covariance Matrix in SCDM\nn-body simulations (symbols) and PTHalos (solid lines). The top\npanel shows the ratio of the power spectrum errors to those under\nthe assumption of Gaussianity. The remaining three panels show\nthe cross-correlation coefficient rij between band powers centered\nat kj = 0.32, 0.88, 1.52 h/Mpc as a function ki (Gaussianity corresponds to rij = \u03b4ij ).\n\nFigure 8. Same as Fig. 7, but for \u039bCDM PTHalos realizations.\nSolid lines denote the real space dark matter power spectrum\ncovariance matrix, whereas dotted lines correspond to redshift\nspace. Dashed lines show redshift-space measurements of galaxies\ngiven by Eq. (22).\n\n(22)\n\nwhere \u03b1 = 0 for 8 \u00d7 1010 M\u2299 /h \u2264 m \u2264 m0 , \u03b1 = 0.7 for\nm > m0 , m0 = 4 \u00d7 1011 M\u2299 /h. By definition, Ngal = 0 for\nmasses below the mass resolution of the PTHalos realization,\n8\u00d71010 M\u2299 /h. The resulting power spectrum is shown in the\ntop panel in Fig. 9 in solid lines, compared to the inferred\npower spectrum from the PSCz survey, shown in symbols\nwith error bars (Hamilton & Tegmark 2001). Jing, B\u00f6rner\nand Suto (2001) found recently that a similar relation, with\n\u03b1 = 0.75, fits the two-point correlation function of PSCz\ngalaxies.\nWe then calculated the skewness, kurtosis, and bispectrum in redshift-space (bottom panel in Fig. 9 and Fig. 10).\nThe results turned out to be in very good agreement with the\nmeasurements in the PSCz survey (we only consider scales\nlarger than R = 3 Mpc/h in Fig. 9 given that PTHalos is\nnot yet accurate enough for higher-order moments in redshift space, see Fig 6). This is very encouraging, because\nwe did not attempt to fit them by adjusting the relation in\nequation (22). A similar result has been found by Szapudi\net al. (2000) using the semianalytic models of Benson et al.\n(2000).\nThe resulting bias parameters are also in good agreement with the full likelihood analysis of the PSCz bispectrum (Feldman et al. 2001), 1/b1 \u2248 1.2 \u00b1 0.2 and\nb2 /b21 \u2248 \u22120.4 \u00b1 0.2. Indeed, from taking the ratio of the\npower spectrum of the PTHalos galaxies to the underlying\ndark matter spectrum at large scales, k < 0.3 h/Mpc, we\nfind 1/b1 = 1.28. Comparing the large-scale skewness for\nthe dark matter, S3 = 2.6, and for the PTHalos galaxies,\nS3\u2032 = 2, and using S3\u2032 \u2248 S3 /b1 + 3b2 /b21 (Fry & Gazta\u00f1aga\n1993), yields b2 /b21 = \u22120.44.\nWe stress that the result in Eq. (22) should not be considered a full analysis of constraints on galaxy occupation\nnumbers from clustering of PSCz galaxies, since we have not\nexplored the parameter space for Ngal (m) in a detailed fashion and only considered the constraint from the power spectrum measurements. However, the fact that this exercise led\nto very reasonable higher-order moments in redshift space\ngives us confidence that PTHalos can be successfully used to\nconstrain galaxy formation models by using measurements\nof redshift-space clustering statistics at scales R >\n\u223c 3 Mpc/h.\n\nc 0000 RAS, MNRAS 000, 000,000\n\n\fPTHalos: A fast method for generating mock galaxy distributions\n\nFigure 9. Top panel: real-space power spectrum inferred from\nthe PSCz survey (Hamilton & Tegmark 2001) compared to the\npredictions for galaxies obeying the relation in Eq.(22). Bottom\npanel: same for the skewness S3 and kurtosis S4 (Szapudi et al\n2000).\n\n7\n\nCONCLUSIONS\n\nWe have described PTHalos, a fast algorithm which generates point distributions which have similar clustering statistics to those of the observed galaxy distribution. We have\nshown that our approach, although based on simple approximations, is able to reproduce the results of numerical simulations very well and requires minimal computational resources. Its speed and flexibility makes it suitable to explore parameter space in constraining cosmological parameters and galaxy formation models that can be later studied\nin more detail if necessary by perhaps more accurate (and\ncomputationally costly) methods.\nAs we noted in the introduction, although we only used\nPTHalos to model galaxy clustering, if one uses the PTHalos\ndark matter distribution in place of an n-body simulation,\nthen, by placing a semianalytic galaxy formation package\non top, one can model other properties of galaxies, such\nas luminosities and colours, as well. If one is interested in\nhow bulge-to-disk ratios, or the correlation between galaxy\nluminosity and velocity dispersion, depend on local density,\nthen the models described by, e.g., Dalcanton, Spergel &\nSummers (1997), Mo, Mao & White (1998), van den Bosch\n(2000), etc. can also be placed on top of the PTHalos dark\nmatter distribution. These models may differ substantially\nin their formulation and in the specific physical processes\nwhich were considered relevant. The fact that PTHalos is\nseveral orders of magnitude faster than approaches which\nrequire the output of an n-body simulation means that it\noffers an efficient way of testing these different models.\nThere is an interesting history of making mock catalogs\nof the galaxy distribution in which one does not start with\nc 0000 RAS, MNRAS 000, 000,000\n\n11\n\nFigure 10. The redshift-space bispectrum in the weakly nonlinear regime (k < 0.3 h/Mpc) as a function of triangle shape for\ngalaxies populating halos as in Eq.(22), compared to the PSCz\nbispectrum as measured by Feldman et al. (2001). The plot corresponds to wavectors in a ratio of approximately k1 /k2 = 0.5\nand angle between them equal to \u03b8. Error bars here represent the\nscatter in each bin from measurements of triangles of the same\nshape but somewhat different overall scale, and should only be\nconsidered a rough estimate of the uncertainties, see Feldman et\nal. (2001) for a full analysis.\n\nan n-body simulation. Soneira & Peebles (1978) describe an\nalgorithm which generates point distributions which have\nthe same small-scale two-point statistics as the observations.\nHowever, their method does not allow them to generate velocities and, because they were designed to work on small\nscales only, they do not include large-scale correlations. Motivated by the fact that the observed galaxy distribution is\napproximately Lognormal, Coles & Jones (1991) suggested\nthat it might be a reasonable approximation to simply map\ninitially Gaussian fluctuations to non-Gaussian ones by setting exp(\u03b4init ) = 1 + \u03b4final . However, this mapping is only\napproximate, and it is not obvious how one might assign velocities, or account for the difference in clustering between\nthe dark matter and galaxies. In addition, although it is possible to generate one-point higher-order moments by a local\ntransformation of a Gaussian field, this does not generate\nthe correct configuration dependence of multi-point correlation functions, which in gravitational instability are the\nresult of the non-local character of Poisson's equation.\nSheth & Saslaw (1994) described a halo-based algorithm which is similar in spirit to the one presented here.\nHowever, their prescription had no large-scale correlations\n(their haloes were given a Poisson spatial distribution), and\nthey did not describe how to incorporate velocities into\ntheir model, nor how to allow for differences between the\ndark matter and the galaxy distributions. Bond & Myers\n(1996) described a halo-based algorithm which did include\n\n\f12\n\nR. Scoccimarro and R. K. Sheth\n\nspatial correlations and used the Zel'dovich approximation\nfor velocities. However, their algorithm was rather computationally intensive. Moreover, although it produced approximately the right number of massive halos, it was less accurate at the low mass end.\nOur PTHalos algorithm represents a real improvement\nbecause:\n\u2022 it has correct two- and three-point correlations on largescales;\n\u2022 it has accurate higher-order moments on all scales;\n\u2022 it includes realistic velocity correlations; and\n\u2022 it allows one to model the differences between the\ndistributions of dark matter and different galaxy types-\nnontrivial biasing effects are rather simple to incorporate.\nThere are a number of inputs to PTHalos which are\neasily modified. For example, we distribute particles around\nhalo centres so that they follow an NFW profile; this is easily changed to one's favourite profile-a tophat, an isothermal sphere, or one of the profiles described by Hernquist\n(1990) or Moore et al. (1999). Also, our code assumes that\nall haloes are smooth, whereas haloes in simulations have\nsubstructure. Neglecting this fact is reasonable on all but\nthe very smallest scales because substructure accounts for\nonly about fifteen percent of the mass of a halo (e.g. Ghigna\net al. 2000). In any case, Blasi & Sheth (2000) provide simple\nfitting formulae to Ghigna et al.'s simulations which make\nincluding substructure straightforward.\nIt is slightly more complicated to generate haloes with\na range of ellipticities. There are, at present, no convenient\nparametrizations of the distribution of halo shapes in n-body\nsimulations (see however Dubinski & Carlberg 1992). The ellipsoidal collapse model which reproduces the correct halo\nmass function makes specific predictions for this distribution (Sheth, Mo & Tormen 2001); in principle, it could be\nused to specify the distribution of shapes. The simplification\nof spherical halos leads to discrepancies in the bispectrum,\nat small scales the reduced bispectrum Q looses the dependence on triangle shape at scales larger than those of the\nsimulations (Scoccimarro et al. 2001). One the other hand,\nthe numerical results in Ma & Fry (2000) suggest that except\npossibly for the smallest scales, the low-order spatial statistics at least are insensitive to whether or not the haloes are\nspherical.\nImprovements which we hope to include in the near\nfuture include the following. One of the places in which\nPTHalos is not as accurate as we would like is in its assignment of virial velocities. At present, we assume that\nvelocities within haloes are isotropic. Cole & Lacey (1996)\nshow that this is not quite correct; haloes in simulations\ntend to have slightly more radial orbits near the edge of the\nhalo. This is something we have included as a test but it\nturned out to be a small effect in the statistics we studied.\nHowever, in view of the deviations found for redshift-space\nhigher-order moments, more work is needed to make sure\nour velocity statistics are accurate enough at small scales.\nIn this connection, most importantly perhaps is that our\npresent scheme which accounts for the fact that haloes may\nnot overlap is somewhat adhoc. An improved treatment of\nexclusion, or a better algorithm for using the 2LPT density\nfield to assign positions to the haloes output from the merger\ntree partition would be very useful. One promising option is\n\nto modify the approach described by Bond & Myers (1996),\nso that it can be applied to the 2LPT rather than the linear fluctuation field, to assign positions to the most massive\nhalos. One could then use the merger tree algorithm to assign the mass which remains to less massive haloes-one of\nthe advantages of Sheth & Lemson's (1999b) merger tree\nalgorithm is that it is easily adapted to construct partitions\nwhen it is known that some of the mass has already been\nassigned to more massive haloes.\nTo model deep galaxy redshift surveys, the angular correlations of galaxies, weak lensing observations, quasar absorption lines and the Ly-\u03b1 forest, or the thermal and kinematic Sunyaev-Zel'dovich effects, rather than providing particle positions and velocities at a fixed epoch, it is more\nuseful to have a simulation output particle positions and velocities along the observer's light-cone. In PTHalos this is\nparticularly straightforward, and is the subject of ongoing\nwork.\nFinally, another issue that is important for generating\nmock galaxy surveys is to adapt the simulation to the required survey geometry and selection function. At present\nwe generate a cubical volume that encloses the survey volume and whose mean (constant) density matches the maximum density required by the survey in question, as usually\ndone in mock catalogues constructed from n-body simulations (see e.g. Cole et al 1998 for a detailed exposition).\nThis requires a lot more galaxies than really needed. The\nefficiency of PTHalos will be improved significantly by including these considerations from the start, rather than imposing them at the end. We hope to implement this in the\nnext version of the code, which will become publically available.\n\n8\n\nACKNOWLEDGMENTS\n\nWe thank Stephane Colombi, Lam Hui and Istvan Szapudi for useful discussions. RS thanks Fermilab, and RKS\nthanks NYU, for hospitality at the initial and final stages\nof this project. RKS is supported by the DOE and NASA\ngrant NAG 5-7092 at Fermilab. The n-body simulations\nused in Figs. 6 and 7 were produced using the Hydra nbody code (Couchman, Thomas, & Pearce 1995). The nbody simulations used in Figs. 4-5 are publically available\nat http://www.mpa-garching.mpg.de/NumCos and were carried out at the Computer Center of the Max-Planck Society\nin Garching and at the EPCC in Edinburgh, as part of the\nVirgo Consortium project.\n\nREFERENCES\nBenson A. J., Cole S., Frenk C. S., Baugh C. M., Lacey C. G.,\n2000, MNRAS, 311, 793\nBenson A. J., Pearce F. R., Frenk C. S., Baugh C. M., Jenkins\nA., 2001, MNRAS, 320, 261\nBlasi P., Sheth R. K., 2000, PLB, 486, 233\nBond J. R., Myers S. T., 1996, ApJS, 103, 1\nBryan, G. & Norman, M. 1998, ApJ, 495, 80\nBullock J. S., Kolatt T. S., Sigad Y., Somerville R. S., Kravtsov\nA. V., Klypin A. A., Primack J. R., Dekel A., 2001, MNRAS,\n321, 559\nc 0000 RAS, MNRAS 000, 000,000\n\n\fPTHalos: A fast method for generating mock galaxy distributions\nBouchet F. R., Colombi S., Hivon E., Juszkiewicz R., 1995, AA,\n296, 575\nBuchert T., Melott A. L., Weiss A. G., 1994, AA, 288, 349\nBuchert, T. 1996, MNRAS 267, 811\nCen, R. & Ostriker, J.P. 2000, ApJ, 538, 83\nCole S., Lacey C. G., 1996, MNRAS, 281, 716\nCole S., Hatton S., Weinbgerg D. H., Frenk C. S., 1998, MNRAS,\n300, 945\nCole S., Lacey C. G., Baugh C. M., Frenk C. S., 2000, MNRAS,\n319, 168\nColes P., Jones B., 1991, MNRAS, 248, 1\nConnolly, A. et al., 2001, in preparation\nCooray, A., & Hu, W. 2000, astro-ph/0012087\nCouchman H. M. P., Thomas P. A., Pearce F. R., 1995, ApJ, 452,\n797\nDalcanton J. J., Spergel D. N., Summers F. J., 1997, ApJ, 482,\n659\nDodelson, S. et al., 2001, in preparation\nDubinski, J. & Carlberg, R.G. 1992, ApJ, 378, 496\nFeldman H. A., Frieman J. A., Fry J. N., Scoccimarro R., 2001,\nPRL, 86, 1434\nFry J. N., Gazta\u00f1aga E., 1993, ApJ, 413, 447\nGhigna S., Moore B., Governato F., Lake G., Quinn T., Stadel\nJ., 2000, ApJ, 544, 616\nHamilton, A.J.S. 2000, MNRAS, 312, 257\nHamilton A. J. S., Tegmark M., 2001, MNRAS, submitted, astroph/0008392\nHatton, S. & Cole, S. 1998, MNRAS, 296, 10\nHatton, S. & Cole, S. 1999, MNRAS, 310, 1137\nHernquist L., 1990, ApJ, 356, 359\nJenkins A., Frenk C. S., White S. D. M., Colberg J. M., Cole S.,\nEvrard A. E., Couchman H. M. P., Yoshida N., 2001, MNRAS,\n321, 372\nJing Y. P., Mo H. J., B\u00f6rner G., 1998, ApJ, 494, 1\nJing Y. P., 2000, ApJ, 535, 30\nJing Y. P., B\u00f6rner G., Suto Y. 2001, astro-ph/0104023\nKaiser, N. 1987, MNRAS, 227, 1\nKauffmann G., Colberg J. M., Diaferio A., & White S. D. M.,\n1999, MNRAS, 303, 188\nLemson, G., Kauffmann G. 1999, MNRAS, 302, 111\nMa C-P., Fry J. N., 2000, ApJL, 531, 87\nMeiksin, A.& White, M. 1999, MNRAS, 308, 1179\nMo H. J., Jing Y. P., B\u00f6rner G., 1997, MNRAS, 286, 979\nMo H. J., White S. D. M., 1996, MNRAS, 282, 347\nMo H. J., Mao S., White S. D. M., 1998, MNRAS, 295, 319\nMoore B., Quinn T., Governato F., Stadel J., Lake G., 1999,\nMNRAS, 310, 1147\nMoutarde F., Alimi J.-M., Bouchet F. R., Pellat R., Ramani A.,\n1991, ApJ, 382, 377\nNavarro J. F., Frenk C. S., White S. D. M., 1997, ApJ, 490, 493\nPark, C., Vogeley, M.S., Geller, M., Huchra, J.P., ApJ, 431, 569\nPeacock J. A., Dodds S. J., 1994, MNRAS, 267, 1020\nPeacock J. A., Smith R. E., 2000, MNRAS, 318, 1144\nPearce F. P., Jenkins A., Frenk C. S., White S. D. M., Thomas\nP. A., Couchman H. M. P., Peacock J. A., Efstathiou G.\n(The Virgo Consortium) 2001, MNRAS, to appear, astroph/0010587\nPress W., Schechter P., 1974, ApJ, 187, 425\nSaunders, W., Sutherland, W.J., Maddox, S.J., Keeble, O., Oliver,\nS.J., Rowan-Robinson, M., McMahon, R.G., Efstathiou, G.P.,\nTadros, H., White, S.D.M., Frenk, C.S., Carrami\u00f1ana, A.,\nHawkins, M.R.S. 2000, MNRAS, 317, 55\nScoccimarro R. 1998, MNRAS, 299, 1097\nScoccimarro, R., Couchman, H. & Frieman, J. 1999a, ApJ, 517,\n531\nScoccimarro, R., Zaldarriaga, M. & Hui, L. 1999b, ApJ, 527, 1\nScoccimarro R. 2000, ApJ, 544, 597\nScoccimarro R., Sheth R. K., Hui L., Jain B., 2001, ApJ, 546, 20\nc 0000 RAS, MNRAS 000, 000,000\n\n13\n\nScranton R. et al., 2001, in preparation\nSeljak, U., 2000, MNRAS, 318, 203\nSeljak, U., 2001, MNRAS in press, astro-ph/0009016\nSheth R. K., Diaferio A., 2001, MNRAS, 322, 901\nSheth R. K., Hui, L., Diaferio A., & Scoccimarro, R., 2001, MNRAS, in press\nSheth R. K., Lemson G., 1999a, MNRAS, 304, 767\nSheth R. K., Lemson G., 1999b, MNRAS, 305, 946\nSheth R. K., Mo H. J., Tormen G., 2001, MNRAS, 323, 1\nSheth R. K., Saslaw W. C., 1994, ApJ, 437, 35\nSheth R. K., Tormen G., 1999, MNRAS, 308, 119\nSheth R. K., Tormen G. 2001, astro-ph/0105113\nSomerville R. S.; Primack J. R., 1999, MNRAS, 310, 1087\nSoneira R. M., Peebles P. J. E., 1978, AJ, 83, 845\nSpringel V., Yoshida N., White S. D. M., 2000, astro-ph/0003162.\nSzalay, A. et al., 2001, in preparation\nSzapudi I., Branchini E., Frenk C. S., Maddox S., Saunders W.,\n2000, MNRAS, 318, L45\nTegmark, M. et al., 2001, in preparation\nTormen, G. 1998, MNRAS, 297, 648\nvan den Bosch F. C., 2000, ApJ, 530, 177\nVan Waerbeke, L., Hamana, T., Scoccimarro, R., Colombi, S.,\nBernardeau, F. 2001, MNRAS, 322, 918\nWhite M. & Hu, W., 1999, ApJ, 537, 1\nWhite, M. 2001, MNRAS, 321, 1\nWhite S. D. M., Rees M. J., 1978, MNRAS, 183, 341\nWhite S. D. M., Frenk C. S., 1991, ApJ, 379, 52\nZel'Dovich Y. B., 1970, AA, 5, 84\n\n\f"}