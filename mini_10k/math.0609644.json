{"id": "http://arxiv.org/abs/math/0609644v1", "guidislink": true, "updated": "2006-09-22T14:48:29Z", "updated_parsed": [2006, 9, 22, 14, 48, 29, 4, 265, 0], "published": "2006-09-22T14:48:29Z", "published_parsed": [2006, 9, 22, 14, 48, 29, 4, 265, 0], "title": "Shape-Wilf-ordering of permutations of length 3", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0609328%2Cmath%2F0609445%2Cmath%2F0609498%2Cmath%2F0609716%2Cmath%2F0609741%2Cmath%2F0609733%2Cmath%2F0609272%2Cmath%2F0609085%2Cmath%2F0609782%2Cmath%2F0609572%2Cmath%2F0609351%2Cmath%2F0609685%2Cmath%2F0609456%2Cmath%2F0609707%2Cmath%2F0609138%2Cmath%2F0609012%2Cmath%2F0609233%2Cmath%2F0609354%2Cmath%2F0609166%2Cmath%2F0609831%2Cmath%2F0609223%2Cmath%2F0609416%2Cmath%2F0609649%2Cmath%2F0609184%2Cmath%2F0609058%2Cmath%2F0609120%2Cmath%2F0609597%2Cmath%2F0609047%2Cmath%2F0609644%2Cmath%2F0609720%2Cmath%2F0609175%2Cmath%2F0609317%2Cmath%2F0609030%2Cmath%2F0609705%2Cmath%2F0609532%2Cmath%2F0609575%2Cmath%2F0609530%2Cmath%2F0609447%2Cmath%2F0609298%2Cmath%2F0609643%2Cmath%2F0609415%2Cmath%2F0609665%2Cmath%2F0609114%2Cmath%2F0609232%2Cmath%2F0609766%2Cmath%2F0609156%2Cmath%2F0609162%2Cmath%2F0609515%2Cmath%2F0609613%2Cmath%2F0609565%2Cmath%2F0609213%2Cmath%2F0609448%2Cmath%2F0609413%2Cmath%2F0609706%2Cmath%2F0609089%2Cmath%2F0609692%2Cmath%2F0609042%2Cmath%2F0609363%2Cmath%2F0609590%2Cmath%2F0609075%2Cmath%2F0609449%2Cmath%2F0609533%2Cmath%2F0609757%2Cmath%2F0609398%2Cmath%2F0609850%2Cmath%2F0609359%2Cmath%2F0609422%2Cmath%2F0609602%2Cmath%2F0609545%2Cmath%2F0609809%2Cmath%2F0609827%2Cmath%2F0609806%2Cmath%2F0609550%2Cmath%2F0609224%2Cmath%2F0609568%2Cmath%2F0609668%2Cmath%2F0609450%2Cmath%2F0609388%2Cmath%2F0609779%2Cmath%2F0609407%2Cmath%2F0609600%2Cmath%2F0609122%2Cmath%2F0609801%2Cmath%2F0609118%2Cmath%2F0609525%2Cmath%2F0609655%2Cmath%2F0609730%2Cmath%2F0609680%2Cmath%2F0609006%2Cmath%2F0609417%2Cmath%2F0609347%2Cmath%2F0609760%2Cmath%2F0609663%2Cmath%2F0609697%2Cmath%2F0609693%2Cmath%2F0609469%2Cmath%2F0609543%2Cmath%2F0609768%2Cmath%2F0609470%2Cmath%2F0609236%2Cmath%2F0609504&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Shape-Wilf-ordering of permutations of length 3"}, "summary": "The research on pattern-avoidance has yielded so far limited knowledge on\nWilf-ordering of permutations. The Stanley-Wilf limits sqrt[n](|S_n(tau)|) and\nfurther works suggest asymptotic ordering of layered versus monotone patterns.\nYet, Bona has provided the only known up to now result of its type on ordering\nof permutations: |S_n(1342)|<|S_n(1234)|<|S_n(1324)| for n>6. We give a\ndifferent proof of this result by ordering S_3 up to the stronger\nshape-Wilf-order: |S_Y(213)|<=|S_Y(123)|<=|S_Y(312)| for any Young diagram Y,\nderive as a consequence that |S_Y(k+2,k+1,k+3,tau)|<=|S_Y(k+1,k+2,k+3,tau)|<=\n|S_Y(k+3,k+1,k+2,tau)| for any tau in S_k, and find out when equalities are\nobtained. (In particular, for specific Y's we find out that\n|S_Y(123)|=|S_Y(312)| coincide with every other Fibonacci term.) This\nstrengthens and generalizes Bona's result to arbitrary length permutations.\nWhile all length-3 permutations have been shown in numerous ways to be\nWilf-equivalent, the current paper distinguishes between and orders these\npermutations by employing all Young diagrams. This opens up the question of\nwhether shape-Wilf-ordering of permutations, or some generalization of it, is\nnot the ``true'' way of approaching pattern-avoidance ordering.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0609328%2Cmath%2F0609445%2Cmath%2F0609498%2Cmath%2F0609716%2Cmath%2F0609741%2Cmath%2F0609733%2Cmath%2F0609272%2Cmath%2F0609085%2Cmath%2F0609782%2Cmath%2F0609572%2Cmath%2F0609351%2Cmath%2F0609685%2Cmath%2F0609456%2Cmath%2F0609707%2Cmath%2F0609138%2Cmath%2F0609012%2Cmath%2F0609233%2Cmath%2F0609354%2Cmath%2F0609166%2Cmath%2F0609831%2Cmath%2F0609223%2Cmath%2F0609416%2Cmath%2F0609649%2Cmath%2F0609184%2Cmath%2F0609058%2Cmath%2F0609120%2Cmath%2F0609597%2Cmath%2F0609047%2Cmath%2F0609644%2Cmath%2F0609720%2Cmath%2F0609175%2Cmath%2F0609317%2Cmath%2F0609030%2Cmath%2F0609705%2Cmath%2F0609532%2Cmath%2F0609575%2Cmath%2F0609530%2Cmath%2F0609447%2Cmath%2F0609298%2Cmath%2F0609643%2Cmath%2F0609415%2Cmath%2F0609665%2Cmath%2F0609114%2Cmath%2F0609232%2Cmath%2F0609766%2Cmath%2F0609156%2Cmath%2F0609162%2Cmath%2F0609515%2Cmath%2F0609613%2Cmath%2F0609565%2Cmath%2F0609213%2Cmath%2F0609448%2Cmath%2F0609413%2Cmath%2F0609706%2Cmath%2F0609089%2Cmath%2F0609692%2Cmath%2F0609042%2Cmath%2F0609363%2Cmath%2F0609590%2Cmath%2F0609075%2Cmath%2F0609449%2Cmath%2F0609533%2Cmath%2F0609757%2Cmath%2F0609398%2Cmath%2F0609850%2Cmath%2F0609359%2Cmath%2F0609422%2Cmath%2F0609602%2Cmath%2F0609545%2Cmath%2F0609809%2Cmath%2F0609827%2Cmath%2F0609806%2Cmath%2F0609550%2Cmath%2F0609224%2Cmath%2F0609568%2Cmath%2F0609668%2Cmath%2F0609450%2Cmath%2F0609388%2Cmath%2F0609779%2Cmath%2F0609407%2Cmath%2F0609600%2Cmath%2F0609122%2Cmath%2F0609801%2Cmath%2F0609118%2Cmath%2F0609525%2Cmath%2F0609655%2Cmath%2F0609730%2Cmath%2F0609680%2Cmath%2F0609006%2Cmath%2F0609417%2Cmath%2F0609347%2Cmath%2F0609760%2Cmath%2F0609663%2Cmath%2F0609697%2Cmath%2F0609693%2Cmath%2F0609469%2Cmath%2F0609543%2Cmath%2F0609768%2Cmath%2F0609470%2Cmath%2F0609236%2Cmath%2F0609504&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The research on pattern-avoidance has yielded so far limited knowledge on\nWilf-ordering of permutations. The Stanley-Wilf limits sqrt[n](|S_n(tau)|) and\nfurther works suggest asymptotic ordering of layered versus monotone patterns.\nYet, Bona has provided the only known up to now result of its type on ordering\nof permutations: |S_n(1342)|<|S_n(1234)|<|S_n(1324)| for n>6. We give a\ndifferent proof of this result by ordering S_3 up to the stronger\nshape-Wilf-order: |S_Y(213)|<=|S_Y(123)|<=|S_Y(312)| for any Young diagram Y,\nderive as a consequence that |S_Y(k+2,k+1,k+3,tau)|<=|S_Y(k+1,k+2,k+3,tau)|<=\n|S_Y(k+3,k+1,k+2,tau)| for any tau in S_k, and find out when equalities are\nobtained. (In particular, for specific Y's we find out that\n|S_Y(123)|=|S_Y(312)| coincide with every other Fibonacci term.) This\nstrengthens and generalizes Bona's result to arbitrary length permutations.\nWhile all length-3 permutations have been shown in numerous ways to be\nWilf-equivalent, the current paper distinguishes between and orders these\npermutations by employing all Young diagrams. This opens up the question of\nwhether shape-Wilf-ordering of permutations, or some generalization of it, is\nnot the ``true'' way of approaching pattern-avoidance ordering."}, "authors": ["Zvezdelina Stankova"], "author_detail": {"name": "Zvezdelina Stankova"}, "author": "Zvezdelina Stankova", "arxiv_comment": "38 pages, 32 figures", "links": [{"href": "http://arxiv.org/abs/math/0609644v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0609644v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05A20; 05A15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0609644v1", "affiliation": "Mills College, USA", "arxiv_url": "http://arxiv.org/abs/math/0609644v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0609644v1 [math.CO] 22 Sep 2006\n\nSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\nZVEZDELINA STANKOVA\n\nAugust 2006\nAbstract. The research on pattern-avoidance has yielded so far p\nlimited knowledge on\nWilf-ordering of permutations. The Stanley-Wilf limits limn\u2192\u221e n |Sn (\u03c4 )| and further\nworks suggest asymptotic ordering of layered versus monotone patterns. Yet, B\u00f3na has provided essentially the only known up to now result of its type on ordering of permutations:\n|Sn (1342)| < |Sn (1234)| < |Sn (1324)| for n \u2265 7. We give a different proof of this result\nby ordering S3 up to the stronger shape-Wilf-order: |SY (213)| \u2264 |SY (123)| \u2264 |SY (312)|\nfor any Young diagram Y , derive as a consequence that |SY (k + 2, k + 1, k + 3, \u03c4 )| \u2264\n|SY (k+1, k+2, k+3, \u03c4 )| \u2264 |SY (k+3, k+1, k+2, \u03c4 )| for any \u03c4 \u2208 Sk , and find out when equalities are obtained. (In particular, for specific Y 's we find out that |SY (123)| = |SY (312)|\ncoincide with every other Fibonacci term.) This strengthens and generalizes B\u00f3na's result to arbitrary length permutations. While all length-3 permutations have been shown\nin numerous ways to be Wilf-equivalent, the current paper distinguishes between and orders these permutations by employing all Young diagrams. This opens up the question\nof whether shape-Wilf-ordering of permutations, or some generalization of it, is not the\n\"true\" way of approaching pattern-avoidance ordering.\n\n1. Introduction\nWe review first basic concepts and results that are crucial to the present paper, and\ndirect the reader to [14, 15, 18, 19] for further introductory definitions and examples on\npattern-avoidance.\nA permutation \u03c4 of length k is written as (a1 , a2 , . . . , ak ) where \u03c4 (i) = ai , 1 \u2264 i \u2264 k.\nFor k < 10 we suppress the commas without causing confusion. As usual, Sn denotes the\nsymmetric group on [n] = {1, 2, ..., n}.\nDefinition 1. Let \u03c4 and \u03c0 be two permutations of lengths k and n, respectively. We say\nthat \u03c0 is \u03c4 -avoiding if there is no subsequence i\u03c4 (1) , i\u03c4 (2) , ..., i\u03c4 (k) of [n] such that \u03c0(i1 ) <\n\u03c0(i2 ) < . . . < \u03c0(ik ). If there is such \u0001a subsequence, we say that it is of type \u03c4 , and denote\nthis by \u03c0(i\u03c4 (1) ), \u03c0(i\u03c4 (2) ),..., \u03c0(i\u03c4 (k) ) \u2248 \u03c4 .\n\nThe following reformulation in terms of matrices is probably more insightful. In it, and\nthroughout the paper, we coordinatize all matrices from the bottom left corner in order to\nkeep the resemblance with the \"shape\" of permutations.\nDefinition 2. Let \u03c0 \u2208 Sn . The permutation matrix M (\u03c0) is the n \u00d7 n matrix Mn having\na 1 in position (i, \u03c0(i)) for 1 \u2264 i \u2264 n. Given two permutation matrices M and N , we say\nthat M avoids N if no submatrix of M is identical to N .\nA permutation matrix is simply an arrangement, called a transversal, of n non-attacking\nrooks on an n \u00d7 n board. We refer to the elements of a transversal also as \"1's\" and \"dots\".\nClearly, a permutation \u03c0 \u2208 Sn contains a subsequence \u03c4 \u2208 Sk if and only if M (\u03c0) contains\nM (\u03c4 ) as a submatrix.\n1\n\n\f2\n\nZVEZDELINA STANKOVA\n\nDefinition 3. Let Sn (\u03c4 ) denote the set of \u03c4 -avoiding permutations in Sn . Two permutations \u03c4 and \u03c3 are Wilf-equivalent, denoted by \u03c4 \u223c \u03c3, if they are equally restrictive:\n|Sn (\u03c4 )| = |Sn (\u03c3)| for all n \u2208 N. If |Sn (\u03c4 )| \u2264 |Sn (\u03c3)| for all n \u2208 N, we say that \u03c4 is more\nrestrictive than \u03c3, and denote this by \u03c4 \u0016 \u03c3.\nThe classification of permutations in Sk for k \u2265 7 up to Wilf-equivalence was completed\nover the last two decades by a number of people. We refer the reader to Simion-Schmidt\n[14], Rotem [13], Richards [12], and Knuth [8, 9] for length k = 3; to West [19] and Stankova\n[15, 16] for k = 4; to Babson-West [2] for k = 5; and to Backelin-West-Xin [3] and StankovaWest [17] for k = 6, 7.\nHowever, total Wilf-ordering does not exist for a general Sk . The first counterexample\noccurs in S5 (cf. [17]): if \u03c4 = (53241) and \u03c3 = (43251), then S7 (\u03c4 ) < S7 (\u03c3) but S13 (\u03c4 ) >\nS13 (\u03c3), and hence \u03c4 and \u03c3 cannot be Wilf-ordered. This phenomenon prompts\nDefinition 4. For two permutations \u03c4 and \u03c3, we say that \u03c4 is asymptotically more restrictive\nthan \u03c3, denoted by \u03c4 \u0016a \u03c3, if |Sn (\u03c4 )| \u2264 |Sn (\u03c3)| for all n \u226b 1.\nStanley-Wilf Theorem (cf. Marcus and Tardos [10], Arratia [1]) gives some insight into the\nasymptotic\nordering of permutations. Inequalities between the Stanley-Wilf limits L(\u03c4 ) =\np\nn\nlimn\u2192\u221e |Sn (\u03c4 )| suggest asymptotic comparisons between the corresponding permutations. For instance, works of B\u00f3na [5, 7] and Regev [11] show that L(Ik ) = (k \u2212 1)2 \u2264 L(\u03c4 ),\nwhere Ik = (12...k) is the identity pattern and \u03c4 is any layered pattern in Sk (cf. Definition 7), which provides strong evidence that the identity pattern is more restrictive than\nall layered patterns in Sk . Yet, this result will still not imply asymptotic ordering between\nthe above types of patterns if it happens that L(Ik ) = L(\u03c4 ) for some layered \u03c4 .\nIn [4, 6], B\u00f3na provides essentially the only known so far result on Wilf-ordering:\n(1)\n\n|Sn (1342)| < |Sn (1234)| < |Sn (1324)| for n \u2265 7,\n\nalong with some sporadic examples on asymptotic Wilf-ordering, e.g. Ik \u0016a \u03c4k for some\n\u03c4k \u2208 Sk . Since S2 and S3 are each a single Wilf-equivalence class (cf. [14]), the first possibility\nof nontrivial Wilf-ordering arises in S4 . A representative of each of the 3 Wilf-equivalence\nclasses in S4 appears in (1) (cf. [19, 15, 16].).\nIn order to prove differently and extend result (1) to Wilf-ordering of certain permutations\nof arbitrary lengths, we shall use the concept of a stronger Wilf-equivalence relation, called\nshape-Wilf-equivalence. The latter was introduced in [2], and further explored in consequent\npapers [3, 17].\nDefinition 5. A transversal T of a Young diagram Y , denoted T \u2208 SY , is an arrangement\nof 1's such that every row and every column of Y has exactly one 1 in it. A subset of 1's in\nT forms a submatrix of Y if all columns and rows of Y passing through these 1's intersect\ninside Y . For a permutation \u03c4 \u2208 Sk , T contains the pattern \u03c4 (in Y ) if some k 1's of T form\na submatrix of Y identical to M (\u03c4 ). Denote by SY (\u03c4 ) the set of all transversals of Y which\navoid \u03c4 .\nNow, suppose T \u2208 SY has a subsequence L = (\u03b11 \u03b12 ...\u03b1k ) \u2248 \u03c4 \u2208 Sk . From the above\ndefinition, in order for T \u2208 SY to contain the pattern \u03c4 in Y , it is necessary and sufficient\nthat the column of the rightmost element of L and the row of the smallest element of L\nintersect inside Y . In such a case, we say that the subsequence L lands inside Y . For\nexample, Figure 1a shows the transversal T \u2208 SY representing the permutation (51324).\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n3\n\nNote that T contains the patterns (312) and (321) because its subsequences (513) and (532)\nland inside Y . However, T 's subsequence (324) \u2248 (213) does not land in Y , and in fact, T\ndoes not contain the pattern (213); symbolically, T \u2208 SY (213).\nWhen Y is a square diagram of size n, Sn (\u03c4 ) \u2261 SY (\u03c4 ). Let Y (a1 , a2 , ..., an ) denote the\nYoung diagram Y whose i-th row has ai cells, for 1 \u2264 i \u2264 n. In order for Y to have any\ntransversals at all, it must be proper: Y must have the same number of rows and columns\nand must contain the staircase diagram St1 = Y (n, n \u2212 1, ..., 2, 1); equivalently, Y must\ncontain its southwest-northeast 45\u25e6 diagonal d(Y ) which connects Y 's bottom left and top\nright corners. If not specified otherwise, a Young diagram is always proper in this paper.\n\nFigure 1. T \u2208 SY versus T \u2032 \u2208 S5\nYoung diagrams are traditionally coordinatized from the top left corner, meaning that\ntheir first (and largest) row and column are the top, respectively, leftmost ones. To avoid\npossible confusion with the matrix \"bottom-left-corner\" coordinatization used in this paper,\none can think of a transversal T \u2208 SY by first completing the (proper) Young diagram Y\nto a square matrix Mn , and then taking a transversal T of Mn all of whose 1's are in the\noriginal cells of Y . Thus, whether using a matrix or a Young diagram, all transversals\nresemble the \"shape\" of permutations. For instance, in Fig. 1, the proper Young diagram\nY (5, 5, 4, 4, 3) is completed to the square matrix M5 , and the transversal T \u2208 SY induces\na transversal T \u2032 \u2208 S5 . As observed above, T \u2208 SY (213), but T \u2032 6\u2208 S5 (213) because the\nsubsequence (324) \u2248 (213) of T \u2032 does land in M5 .\nDefinition 6. Two permutations \u03c4 and \u03c3 are called shape-Wilf-equivalent (SWE), denoted\nby \u03c4 \u223cs \u03c3, if |SY (\u03c4 )| = |SY (\u03c3)| for all Young diagrams Y . If |SY (\u03c4 )| \u2264 |SY (\u03c3)| for all such\nY , we say that \u03c4 is more shape-restrictive than \u03c3, and denote this by \u03c4 \u0016s \u03c3.\nClearly, \u03c4 \u223cs \u03c3 (\u03c4 \u0016s \u03c3) imply \u03c4 \u223c \u03c3 (\u03c4 \u0016 \u03c3, respectively), but the converses are false.\nBabson-West showed in [2] that SWE is useful in establishing more Wilf-equivalences. To\nthe best of our knowledge, this idea of Young diagrams has not been yet been modified\nor used to prove Wilf-ordering, which the present paper will accomplish. To this end, we\ninclude below an extension of Babson-West's proposition, replacing shape-Wilf-equivalences\n\"\u223cs \" with shape-Wilf-ordering \"\u0016s \". Section 2 presents a modification and extension of\ntheir original proof, and introduces along the way new notation necessary for the completion\nof our Wilf-ordering results.\nProposition 1. Let A \u0016s B for some permutation matrices A and B. Then for any\npermutation matrix C:\n\u0012\n\u0013\n\u0013\n\u0012\nB 0\nA 0\n\u0016s\n*\n0 C\n0 C\nIf we shape-Wilf-order permutations in Sk for a small k, Proposition 1 will enable us to\nshape-Wilf-order some permutations in Sn for larger n. Since (12) \u223cs (21) in S2 , Proposition 1 can imply in this case only shape-Wilf-equivalences.\n\n\f4\n\nZVEZDELINA STANKOVA\n\nThe first non-trivial shape-Wilf-ordering can occur in S3 , since the latter splits into three\ndistinct shape-Wilf-equivalence classes: {(213) \u223cs (132)}, {(123) \u223cs (231) \u223cs (321)}, and\n{(312)}. The first SWE-class was proven by Stankova-West in [17], and the second class\nwas proven by Babson-Backelin-West-Xin in [2, 3]. The smallest Young diagram for which\nall three classes differ from each other is Y = Y (5, 5, 5, 5, 4): |SY (213)| = 37 < |SY (123)| =\n41 < |SY (312)| = 42. Numerical evidence suggests that such inequalities hold for all Young\ndiagrams Y , and indeed this is true:\nTheorem 1 (Main Theorem). For all Young diagrams Y :\n|SY (213)| \u2264 |SY (123)| \u2264 |SY (312)|.\nFigure 2 with \u03c4 = \u2205 illustrates Theorem 1. Let Yn = Y (n, n, n, ..., n, n \u2212 1) be the Young\ndiagram obtained by removing the right bottom cell from the square Mn . Section 9 shows\n|SYn (213)| < |SYn (123)| < |SYn (312)| for n \u2265 5.\nThese strict inequalities preclude the possibility of the three permutations (213), (123),\n(312) to be asymptotically SWE, even though they are Wilf-equivalent. More precisely,\nTheorem 2. |SY (213)| < |SY (123)| if and only if Y contains an i-critical point with i \u2265 2,\nand |SY (123)| < |SY (312)| if and only if Y contains an i-critical point with i \u2265 3.\nThe definition and a discussion of critical points can be found in Subsection 3.2. While\n\u0001\n2n\n1\nfor any \u03c4 \u2208 S3 the \"Wilf-numbers\" |Sn (\u03c4 )| equal the Catalan numbers cn = n+1\nn , the\n\"shape-Wilf-numbers\" |SY (\u03c4 )| naturally vary a lot more. In particular, for the staircases\nY = St3n , |SY (\u03c4 )| coincide\u221awith the odd-indexed Fibonacci terms f2n\u22121 , and hence involve\nthe golden ratio \u03c6 = (1 + 5)/2 (cf. Definition 13 and Section 9.)\nDefinition 7. We say that a permutation \u03c4 \u2208 Sn is decomposable into blocks A1 and\nA2 if for some k < n, \u03c4 can be partitioned into two subpatterns A1 = (\u03c41 , \u03c42 , ..., \u03c4k ) and\nA2 = (\u03c4k+1 , \u03c4k+2 , ..., \u03c4n ) such that all entries of A1 are bigger than (and a priori come before)\nall entries of A2 . We denote this by \u03c4 = (A1 |A2 ). If there is no such decomposition into two\nblocks, we say that \u03c4 is indecomposable. In particular, a layered pattern \u03c4 is a permutation\ndecomposable into increasing blocks.\nFor example, (4132) = (4|132) is decomposable, while (3142) and (1432) are indecomposable; (4123) = (4|123) is layered, while (4132) is not layered. Without confusion, we can\nalso write (213|1) instead of (3241). In this notation, Proposition 1 can be rewritten as\nA \u0016s B \u21d2 (A|C) \u0016s (B|C).\nCorollary 1. For any permutation \u03c4 \u2208 Sk , (213|\u03c4 ) \u0016s (123|\u03c4 ) \u0016s (312|\u03c4 ). Moreover, strict\nasymptotic Wilf-ordering |Sn (213|\u03c4 )| < |Sn (123|\u03c4 )| < |Sn (312|\u03c4 )| occurs for n \u2265 2k + 5.\n\n<\n\u03c4\n\n<\n\u03c4\n\nFigure 2. Corollary 1\n\n\u03c4\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n5\n\nIn particular, when \u03c4 = (1) Corollary 1 reduces to:\n|Sn (213|1)| < |Sn (123|1)| < |Sn (312|1)| for n \u2265 7\n\u21d2 |Sn (3241)| < |Sn (2341)| < |Sn (4231)| for n \u2265 7.\n\nNote that (3241) \u223c (1342) and (4231) \u223c (1324) (cf. Fig. 3a-c) since the two permutation\nmatrices in each Wilf-equivalence pair can be obtained from each other by applying symmetry operations of flipping along vertical, horizontal and/or diagonal axes (cf. [19, 15]).\nFurther, (2341) \u223c (1234) by the SWE-relations in [3], or by an earlier work [16]. Thus,\nchoosing the second representatives of the three Wilf-equivalence classes in S3 , we obtain\nB\u00f3na's (1) inequality as a special case of Corollary 1.\n\n~\n\n<\n\n~\n\n<\n\n~\n\nFigure 3. Wilf-Ordering of S4\nSome of the implied new shape-Wilf-orderings by Corollary 1 in S5 and S6 are:\n(43521) \u227a\u2217s (54321) \u227as (53421)\n(546321) \u227a\u2217s (654321) \u227as (645321)\n\n(546231) \u227a\u2217s (654231) \u227a\u2217s (645231),\n(546213) \u227a\u2217s (654213) \u227a\u2217s (645213).\n\nThese inequalities imply Wilf-orderings, of which the ones corresponding to \u2217's are new. The\npaper is organized as follows. Section 2 presents the proof of Proposition 1, along with a\nstrategy for establishing strict asymptotic Wilf-orderings. In Section 3, we introduce critical\npoints, provide the 0- and 1-splittings SY (\u03c3) \u223c\n= SY R (\u03c3) \u00d7 SQ Y (\u03c3) in Proposition 2, and a\n2-critical splitting in Lemma 6. Subsection 3.5 defines the \u03c3 \u2192 \u03c4 moves on transversals in Y ,\nand opens up the discussion of the induced maps \u03c6 : SY (\u03c4 ) \u2192 SY (\u03c3). Sections 4-6 contain\nthe proof of the inequalities |SY (312)| \u2265 |SY (321)| and |SY (213)| \u2264 |SY (123)|; a description\nof the structures of T \u2208 SY (321) and T \u2208 SY (312) can be found in Subsections 4.1-4.2.\nUsing critical points, necessary and sufficient conditions for strict inequalities |SY (312)| >\n|SY (321)| and |SY (213)| < |SY (123)| are established in Sections 5-7. Section 8 provides the\nproof of the strict Wilf-orderings |Sn (213|\u03c4 )| < |Sn (123|\u03c4 )| < |Sn (312|\u03c4 )| for n \u2265 2k + 5.\nFinally, in Section 9 we calculate |SY (\u03c4 )| for \u03c4 \u2208 S3 and Young diagrams Y which are\nextreme with respect to their critical points. The paper ends with a generalization of the\nStanley-Wilf limits and the fact that \u03c62 is such a limit.\n2. Proof of Proposition 1\nIn this section we present a modified and extended version of the original proof of BabsonWest to address our new setting of shape-Wilf ordering. Let the permutation matrices A, B\nand C represent permutations \u03b1, \u03b2 and \u03b3, respectively. Before we proceed with the proof,\nwe need to introduce some definitions and notation.\n2.1. Various subboards of Y . Let Y be a Young diagram, and let c be a cell in Y . Denote\nby c\u0304 Y the subboard of Y to the right and below c, not including c's row and column; and\nby Yc the subboard of Y to the left and above c, including the corresponding cells in c's\nrow and column. Since Y is a Young diagram, c\u0304 Y is also a Young diagram (not necessarily\nproper), and Yc is a rectangle whose right bottom cell is c (cf. Fig. 4). This notation is\ncreated so as to match the relative positions of c and the corresponding subboard of Y ,\n\n\f6\n\nZVEZDELINA STANKOVA\n\nYc\u0304\n\nYc\nc\n\nc\n\ncY\n\nc\nY\n\nc\u0304\n\nY c\u0304\n\nY\n\nFigure 4. Notation Yc and c Y versus Yc\u0304 , c\u0304 Y , etc.\nwhere exclusion of c's row and column is denoted by c\u0304. In the same vein, we define Y c ,\nc\u0304 Y , etc. We also extend the notation to (full or partial) transversals T of Y , to elements\n\u03b1 \u2208 T , and to grid points P of Y ; for instance, \u1fb1 T = T |\u1fb1 Y is the restriction of T onto the\nsubboard \u1fb1 Y , while Y P is the subboard Y c where P is the top right corner of cell c.\nWe use the symbols \u0580 and \u0581 instead of the words \"increasing\" and \"decreasing\". Thus,\nIk\u0580, and its transpose Jk\u0581.\nDefinition 8. Let T \u2208 SY , and \u03b1, \u03b2 \u2208 T . We say that \u03b1 (21)-dominates \u03b2 if (\u03b1\u03b2) \u0581.\nSimilarly, \u03b1 (12)-dominates \u03b2 if (\u03b2\u03b1)\u0580 and lands in Y . We extend these definitions to any\ncells of and dots in Y .\n2.2. Coloring of Y with respect to T and \u03b3. Fix a transversal T \u2208 SY . With respect\nto the pattern \u03b3, T induces a white/blue coloring on Y 's cells as follows. Color a cell c in Y\nwhite if c\u0304 Y contains C as a submatrix; otherwise, color c blue. Clearly, for every white cell\nw, the rectangle Yw is also entirely white. Hence, the white subboard W \u2032 of Y is a Young\nsubdiagram of Y (not necessarily proper), and T induces a partial transversal T |W \u2032 of W \u2032 .\nIn order for T to avoid (\u03b1|\u03b3), it is necessary and sufficient that T |W \u2032 avoids \u03b1. However,\nsome rows and columns of W \u2032 cannot participate in any undesirable \u03b1-patterns since the\n1's in them are in blue cells: recolor these white rows and columns of W \u2032 to blue. After\ndeletion of the newly blue rows and columns of W \u2032 , the latter is reduced to a white proper\nYoung subdiagram W of Y , while T |W \u2032 is reduced to a full transversal T |W of W .\nDefinition 9. We say that the transversal T of Y induces with respect to \u03b3 the white\nsubdiagram W of Y and the (full) transversal T |W of W . Let SYW (\u03b1|\u03b3) denote the set all\ntransversals T \u2208 SY (\u03b1|\u03b3) which induce W with respect to \u03b3.\nFor example, Figure 5a shows a transversal T \u2208 SY and the induced white subboard W \u2032\nwith respect to \u03b3 = (213): the blue subboard of Y is depicted with its grid lines, while W \u2032\nis depicted without them; the dashed lines pass through some of the blue 1's and indicate\nthat these rows and columns of Y will be deleted from W \u2032 . Figure 5c shows the final white\nsubdiagram W (4, 4, 3, 3) and its transversal T |W = (2134). Figure 5a-c also illustrates that\nT = (7, 6, 9, 2, 10, 1, 4, 5, 3, 8) \u2208 SY avoids (123|213) because T |W = (2134) avoids (123) on\nW , but it contains (213|213) because T |W contains the pattern (213) on W .\nWe summarize the observations in this subsection in the following\n\nLemma 1. Let W be any Young subdiagram of Y . Then\n(1) T \u2208 SY (\u03b1|\u03b3) \u21d4 T |W \u2208 SW (\u03b1).\nF\n(2) SY (\u03b1|\u03b3) = W \u2282Y SYW (\u03b1|\u03b3).\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n7\n\n2.3. Splitting of transversals T \u2208 SY with respect to \u03b3. Fix now a (white) Young\nsubdiagram W of Y , and let T \u2208 SYW (\u03b1|\u03b3). By construction of W , T splits itself into two\ndisjoint subsets: the induced transversal T |W of W consisting of all \"white\" 1's, and the\nremainder T\u03b3 = T \\T |W consisting of all \"blue\" 1's. We denote this by\nT = T |W \u2295 T\u03b3 , where T |W \u2208 SW (\u03b1).\n\n\u2032 is another transversals in S (\u03b1), then T \u2032 = T \u2032 \u2295 T \u2208\nA key observation is that, if TW\nW\n\u03b3\nW\nSYW (\u03b1|\u03b3). This is true because fixing T\u03b3 preserves the white cells of W , and replacing T |W\nwith any other transversal of W certainly does not affect the blue colored cells in Y \\W . For\nexample, Figure 5 shows T \u2208 SYW (123|213) with W = (4, 4, 3, 3), T |W = (2134) \u2208 SW (123),\n\u2032 =\nand T(213) = (214538) \u2248 (214536). If we keep T(213) and replace T |W with another TW\n(3214) \u2208 SW (123) (shown in Fig. 5d), we obtain the transversal in Fig. 5e:\n\nT \u2032 = (9, 7, 6, 2, 10, 1, 4, 5, 3, 8) = (9, 7, 6, 10) \u2295 (2, 1, 4, 5, 3, 8) \u2208 SYW (123|213).\n\nW\u2032\n\nW\u2032\n\nW\n\nW\u2032\n\nW\n\n\u2032 \u2295T\nW\nFigure 5. T = T |W \u2295 T(213) \u2192 T \u2032 = TW\n(213) in SY (123|213)\n\nWe conclude that all transversals T \u2208 SYW (\u03b1|\u03b3) whose second component is a fixed T\u03b3 are\n\u2032 \u2208 S (\u03b1) to T :\nobtained by adding an arbitrary transversal TW\nW\n\u03b3\n\u2032\n\u2032\nT = TW\n\u2295 T\u03b3 \u2208 SYW (\u03b1|\u03b3) for any TW\n\u2208 SW (\u03b1).\n\n2.4. Description of the T\u03b3 -component of T \u2208 SYW (\u03b1|\u03b3). We can extend the definitions\nof the white/blue coloring of Y above to partial transversals T \u2032 of Y : a blue cell b in Y is\nsuch that b\u0304 Y does not contain a \u03b3-subpattern of T \u2032 , while a white cell w in Y is such that\nw\u0304 Y does contain a \u03b3-subpattern of T \u2032 .\n\u000e\nRecall the notion of reduction of Y along a subset X of Y 's cells, introduced in [17]: Y X\nis the Young subdiagram obtained from Y by deleting all rows and columns of Y which\nintersect X. This notation should not be confused with Y \\X - the subboard obtained from\nY by removing the cells in X, or with T |W - the restriction of T on W .\nDefinition 10. Let W be a proper subdiagram of a Young diagram Y . A partial transversal\nT \u2032 of Y saturates W with respect to \u03b3 if the induced by T \u2032 blue/white coloring on Y with\nrespect to \u03b3 satisfies:\n(1) T \u2032 's elements are all placed in blue cells;\n(2) Reducing Y along T \u2032 and removing any leftover blue cells results in W ; and\n(3) |W | + |T \u2032 | = |Y |, where |U | is the size of a proper Young diagram U and |T \u2032 | counts\nthe number of elements in T \u2032 .\n\n\f8\n\nZVEZDELINA STANKOVA\n\nSince a blue cell cannot (21)-dominate a white cell, no matter which transversal of W we\nchoose to complete T \u2032 to a (full) transversal of Y , the blue/white coloring of Y will remain\nthe same (cf. Fig. 6.) Condition (3) ensures that there is no entirely blue row or column\nwithout an element of T \u2032 ; in fact, (3) matches the sizes of W and T \u2032 so that any transversal\nof W will indeed complete T \u2032 to a full transversal of Y .\nAccording to Definition 10, for a transversal T \u2208 SYW (\u03b1|\u03b3) with splitting T = T |W \u2295 T\u03b3 ,\nthe partial transversal T\u03b3 of Y saturates W with respect to \u03b3.\nW\n\nW\nT\u2032\n\nFigure 6. T \u2032 saturates W with respect to (213)\nDefinition 11. Given a subdiagram W of the Young diagram Y , let S\u0304Y \\W (\u03b3) denote the\nset of partial transversals T \u2032 of Y which saturate W with respect to \u03b3.\n2.5. Splitting Formula for |SY (\u03b1|\u03b3)|. We have seen that any transversal T \u2208 SYW (\u03b1|\u03b3)\nsplits uniquely as T = T |W \u2295 T\u03b3 , where T |W avoids \u03b1 on W and T\u03b3 saturates W in Y\nwith respect to \u03b3. This defines an injective map SYW (\u03b1|\u03b3) \u0592\u2192 SW (\u03b1) \u00d7 S\u0304Y \\W (\u03b3). The key\nobservation in Subsection 2.3 shows that this map is surjective. Therefore,\nLemma 2 (Splitting Formula for |SY (\u03b1|\u03b3)|). For any subdiagram W of the Young diagram\nY , the isomorphism of sets SYW (\u03b1|\u03b3) \u223c\n= SW (\u03b1) \u00d7 S\u0304Y \\W (\u03b3) holds true. Consequently,\nX\n|SY (\u03b1|\u03b3)| =\n|SW (\u03b1)| * |S\u0304Y \\W (\u03b3)|,\nW \u2282Y\n\nwhere the sum is taken over all Young subdiagrams W of Y .\nSince the components S\u0304Y \\W (\u03b3) depend only on \u03b3 and W (but not on \u03b1), this allows for\ndirect comparisons between SY (\u03b1|\u03b3) and SY (\u03b2|\u03b3). In particular, if \u03b1 \u0016s \u03b2, then |SW (\u03b1)| \u2264\n|SW (\u03b2)| for any Young diagram W , and the splitting formulas for \u03b1 and \u03b2 imply |SY (\u03b1|\u03b3)| \u2264\n|SY (\u03b2|\u03b3)|. This completes the Proof of Proposition 1.\n\u0003\n2.6. Strategy for proving strict Wilf-ordering. When \u03b1 \u0016 \u03b2, the Splitting Formula\ncan be used to prove a strict asymptotic Wilf-ordering of the form |Sn (\u03b1|\u03b3)| \b |Sn (\u03b2|\u03b3)|,\nprovided that for n \u226b 1:\n(SF1) there is a Young diagram Wn with |SWn (\u03b1)| \b |SWn (\u03b2)|; and\n(SF2) there is a partial transversal Tn of Mn saturating Wn with respect to \u03b3.\nThe existence of Wn and Tn ensures that |SWn (\u03b2)| > 0 and |S\u0304Mn \\Wn (\u03b3)| > 0, so that\n|SWn (\u03b1)| * |S\u0304Mn \\Wn (\u03b3)| \b |SWn (\u03b2)| * |S\u0304Mn \\Wn (\u03b3)|.\n\nWe shall employ this strategy in Section 8 to show strict asymptotic Wilf-ordering between\nthe permutations (213|\u03c4 ), (123|\u03c4 ) and (312|\u03c4 ) of Corollary 1.\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n9\n\n3. Critical Splittings of Young Diagrams and Transversals\n3.1. First and second subsequences of T \u2208 SY . Recall that \u03b1 \u2208 T is a left-to-right\nmaximum of T if \u03b1 is not (21)-dominated by any other element of T , i.e. T\u1fb1 = \u2205.\n\nDefinition 12. Let T \u2208 SY . The subsequence T 1 of all left-to-right maxima \u03b1i of T is\ncalled the first subsequence of T . The second subsequence T 2 of T consists of all elements\n\u03b2j \u2208 T \\T 1 for which Y\u03b2 \u0304j contains only elements of T 1 , i.e. \u03b2j is (21)-dominated only by (a\nnon-empty set of) elements of T 1 .\nT1\n\nT2\nd0 (Y )\n\nT\u1fb1\n\nc\u0304 T\n\u03b1\n\nc\n\n\u03b2\n\nd2 (Y )\n\nSt310\n\nT c\u0304\nP\n\nFigure 7. (a) T 1 and T 2\n\n(b) Lemma 3\n\n(c) 2-critical P in St310\n\nObserve that T 1 and T 2 are increasing subsequences of T . Figure 7a depicts T 1 and T 2 (via\ndashed lines) and three instances of \u03b1i \u2208 T 1 (21)-dominating \u03b2j \u2208 T 2 (via solid arrows).\n3.2. Diagonal Properties and Critical Points. We address now the relative positioning\nof an arbitrary transversal within its Young diagram.\nLemma 3. Let T \u2208 SY and let c be a cell on the diagonal d(Y ). Then the rectangle Yc\ncontains some element of T 1 . Consequently, all elements of the first subsequence T 1 are on\nor above d(Y ).\nProof: Suppose Yc contains no elements of T . But there is no transversal of Y to sustain\nsuch a big empty rectangle. Indeed, since c \u2208 d(Y ), Y c\u0304 is a proper Young subdiagram of\nY , say of size k, and there are no elements of T above Y c\u0304 . Thus, the first k columns of\nY must have their 1's within Y c\u0304 , and T induces a transversal T c\u0304 of Y c\u0304 . Analogously, T\ninduces a transversal c\u0304 T of c\u0304 Y . Hence, T must split into T = T c\u0304 \u2295 T (c) \u2295 c\u0304 T , where T (c) is\na transversal of the cell c (cf. Fig. 7b, where T is concentrated in the 3 shaded subboards).\nBut cell c is empty by the supposition, a contradiction. Therefore, Yc does contain some\nelement \u03b3 \u2208 T . Since either \u03b3 \u2208 T 1 or \u03b3 is (21)-dominated by some \u03b1 \u2208 T 1 , we conclude\nthat Yc contains an element of T 1 .\nIf some \u03b1i \u2208 T 1 is below the diagonal d(Y ), then the rectangle Y\u1fb1i contains a cell c\non d(Y ), and Yc is empty, a contradiction with the previous paragraph. Therefore, T 1 's\nelements are on or above d(Y ).\n\u0003\nBy the border of a Young diagram Y we mean the path that starts at the bottom left\ncorner of Y , follows Y 's outline below and to the right of d(Y ), and ends at the top right\ncorner of Y .\nDefinition 13. For a Young diagram Y , define the i-th diagonal di (Y ) as follows: starting\nfrom the bottom left corner of Y , move i cells to the right, draw a parallel line to d(Y )\nuntil it goes through the rightmost column of Y ; the resulting segment is di (Y ). For i \u2265 1,\n\n\f10\n\nZVEZDELINA STANKOVA\n\ndenote by Stin the i-th Staircase Young diagram of size n whose border is the stepwise path\nfrom the bottom left corner to the top right corner of Y that zigzags between di\u22121 (Y ) and\ndi (Y ) (cf. Fig. 7c for di (Y ) with 0 \u2264 i \u2264 3, and St310 .)\nWe distinguish between d0 (Y ), which is a segment going through Y 's diagonal grid points,\nand d(Y ), which is the union of all diagonal cells of Y .\nDefinition 14. A grid point P on Y 's border is called a critical point of Y if Y 's border\ngoes upwards to enter P and then goes to the right to leave P . If in addition P \u2208 di (Y ),\nthen P is called an i-critical point of Y .\nFigure 7c shows the bottom 2-critical point P of St310 . Note that Stnn = Mn is the only\nYoung diagram of size n with no critical points, while St1n has the largest number of critical\npoints. Also, for any critical point P , the subboard P Y has no cells and consists only of\nthe point P , while YP is a rectangle.\nLemma 4. If P is an i-critical point of Y and T \u2208 SY , then the rectangle YP contains\nexactly i elements of T .\nProof: Let Y have exactly k rows above P . Since P \u2208 di (Y ), the subboard P Y has k rows\nand k \u2212 i columns; the latter are in fact all columns of Y which are to the right of P , and\ntherefore each of these k \u2212 i columns contains exactly 1 element of T . Hence k \u2212 i of P Y 's\nrows contain an element of T , while i rows of P Y are empty (cf. Fig. 8a-b for i = 0, 1 and\nFig. 9a for i = 2.)\nOn the other hand, each of the top k rows of Y is split between the rectangle YP and the\nsubboard P Y . From the viewpoint of YP , the above observations mean that k \u2212 i rows of\nYP are empty, while exactly i rows of YP contain an element of T . Thus, |TP | = i.\n\u0003\n3.3. Definition of the map \u03b6P . For an i-critical point P in Y , let Q, R \u2208 d0 (Y ) be the\ndiagonal grid points of Y to the left of, respectively above, P . Then Q Y and Y R are proper\nYoung subdiagrams (cf. Fig. 8a-b and Fig. 9a.)\nFix T \u2208 SY . Lemma 4 ensures that rectangle YP contains exactly i elements of T ,\nwhich form some subsequence \u03b1 = (\u03b11 , \u03b12 , ..., \u03b1i ). While preserving the pattern \u03b1, we can\nsimultaneously pull downward all \u03b1i 's until they become the top i elements in a transversal\nT1 of Y R , and we can also push all \u03b1i 's to the right until they become the i leftmost elements\nof a transversal T2 of Q Y . These operations define an injective map\n\u03b6P : SY \u0592\u2192 SY R \u00d7 SQ Y where \u03b6P (T ) = (T1 , T2 ).\n\nFor example, Fig. 8b-c show \u03b6P (31628547) = (3142, 35214) with i = 1 and \u03b11 = 6, while\nFig. 9 shows \u03b6P (831629547) = (53142, 536214) with i = 2 and \u03b11 = \u03b1 = 8 and \u03b12 =\n\u03b2 = 6. Since P Y has no cells, any subsequence of T landing inside Y must be contained\neither entirely in the rows of Y above P , or entirely in the columns of Y to the left of P .\nConsequently,\nLemma 5. For any pattern \u03c3, T avoids \u03c3 on Y if and only if the components T1 and T2\nof \u03b6P (T ) avoid \u03c3 on Y R and Q Y , respectively. In particular, \u03b6P respects pattern-avoidance\nand we can restrict \u03b6P : SY (\u03c3) \u0592\u2192 SY R (\u03c3) \u00d7 SQ Y (\u03c3).\n3.4. Critical Splittings induced by \u03b6P .\n\u03b6\n\nP\n\u223c\nProposition 2. If P is a 0- or 1-critical point of Y , then SY (\u03c3) =\nSY R (\u03c3) \u00d7 SQ Y (\u03c3) for\nany \u03c3 \u2208 Sk .\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n11\n\nProof: Fix T \u2208 SY and let \u03c3 be any permutation. A 0-critical point P coincides with\nthe points Q and R in the definition of \u03b6P , and the rectangle YP has no elements of T by\nLemma 4 (cf. Fig. 8a.) Thus, \u03b6P : SY (\u03c3) \u0592\u2192 SY R (\u03c3) \u00d7 SQ Y (\u03c3) simply restricts T |Y P = T1\nand T |P Y = T2 ; combined with Lemma 5, this yields invertibility of \u03b6P . In this case, we\nsay that \u03b6P induces the 0-splitting T = T |Y P \u2295 T |P Y .\nYP\n\nYP\nQY\n\n\u03b1Q\n\n\u03b1\n\nc\n\nP\n\nQ\n\nR\n\nQY\n\n\u03b1R\nP\n\nYR\n\nYR\n\nFigure 8. (a) 0-splitting\n\nQY\n\n\u03b6P\n\nYR\n\n(b)-(c) 1-splitting\n\nNow, consider the case of a 1-critical point P (cf. Fig. 8b-c.) Let c be the cell whose\nbottom right corner is P . Then c lies on the diagonal d(Y ), and Q and R are also respective\ncorners of c. Let c = (k, m) where k is c's row and m is c's column in Y . By Lemma 4, the\nrectangle YP has exactly one element of T : call it \u03b1, and let it be in position (i, j) in Y . To\nform transversals T1 \u2208 SY R and T2 \u2208 SQ Y , \u03b6P replaces \u03b1 by \u03b1R in position (k, j) and \u03b1Q\nin position (i, m), respectively.\nIt is not hard to see that \u03b6P is surjective. Indeed, start with (T1 , T2 ) \u2208 SY R \u00d7 SQ Y . If\nT1 has its top element \u03b1Q in its j-th column, and T2 has its leftmost element \u03b1R in its\ni-th row, we can reconstruct the unique \u03b1 \u2208 YP by replacing (\u03b1R , \u03b1Q ) by an element in\nposition (i, j) and leaving the rest of T1 and T2 fixed. Combining this with Lemma 5 yields\nthe wanted isomorphism \u03b6P on SY (\u03c3). In this case, we say that \u03b6P induces the 1-splitting\n\u0003\nT = T |Y P \u22951 T |P Y .\nAs expected, i-critical points for larger i complicate matters, and in general, it is not possible to derive such nice splittings of transversals. Below we describe the image \u03b6P (SY (\u03c3))\nfor a 2-critical point P .\nDefinition 15. Let S\u0580Y (\u03c3), respectively SY\u0580 (\u03c3), be the set of transversals T in SY (\u03c3)\nwhose two leftmost, respectively two top, elements form an increasing subsequence of T .\nDefine analogously SY\u0581 (\u03c3) and S\u0581Y (\u03c3) with appropriate replacement of \u0580 by \u0581.\nWe will also need the notation S\u0580Y\u0581 (\u03c3) = SY\u0581 (\u03c3) \u2229 S\u0580Y (\u03c3). As with previous notation,\nthis one preserves the relative position of the involved objects, in this case \u2013 Y and its two\n(top and/or leftmost) subsequences of length 2. The \u0580 and \u0581 arrows can be arbitrarily\nswitched to denote the corresponding other subsets of transversals.\nLemma 6. If P is a 2-critical point of Y , then for any \u03c3 \u2208 Sk :\n(2)\n\n\u03b6\n\nP\nSY (\u03c3) \u223c\n= SY\u0580R (\u03c3) \u00d7 S\u0580Q Y (\u03c3) \u2294 SY\u0581R (\u03c3) \u00d7 S\u0581Q Y (\u03c3).\n\nProof: Start with T \u2208 SY . By Lemma 4, we may assume that \u03b1 and \u03b2 are the only\nelements of T in rectangle YP , with \u03b1 to the left of \u03b2. Depending on whether (\u03b1\u03b2) \u0580 or\n\u0581, either component T1 \u2208 SY R (\u03c3) has its top two elements (\u03b1R , \u03b2R ) \u0580 and component\n\n\f12\n\nZVEZDELINA STANKOVA\n\u03b1Q\n\nYP\n\n\u03b1\n\n\u03b2\n\nQ\nY\n\n\u03b2Q\nR\n\nQY\nQY\n\n\u03b6P\n\n\u03b1R\n\u03b2R\n\nP\nR\n\nYR\n\nFigure 9. \u03b6P (T ) = (T1 , T2 ) on Y R \u00d7 Q Y with (\u03b1\u03b2)\u0581 in YP\nT2 \u2208 SQ Y (\u03c3) has its two leftmost elements (\u03b1Q , \u03b2Q ) \u0580, or both of these subsequences are\ndecreasing. For instance, Figure 9 depicts the case (\u03b1\u03b2) \u0581.\nConversely, start with (T1 , T2 ) \u2208 SY\u0580R (\u03c3)\u00d7 S\u0580Q Y (\u03c3)\u2294 SY\u0581R (\u03c3)\u00d7 S\u0581Q Y (\u03c3). If (\u03b1R , \u03b2R ) and\n(\u03b1Q , \u03b2Q ) are the top two, respectively, the leftmost two, elements of T1 and T2 , they form\nthe same length-2 pattern, say, they are both decreasing. This makes it possible to pull\nback \u03b1R and \u03b1Q to an element \u03b1 in rectangle YP , and pull back \u03b2R and \u03b2Q to an element\n\u03b2 in rectangle YP , so that (\u03b1, \u03b2) is also decreasing and \u03b6P (\u03b1, \u03b2) = (\u03b1R , \u03b2R ) \u00d7 (\u03b1Q , \u03b2Q ) in\nY R \u00d7 Q Y . This discussion establishes the two isomorphisms SY\u0580 (\u03c3) \u223c\n= SY\u0580R (\u03c3) \u00d7 S\u0580Q Y (\u03c3)\nand SY\u0581 (\u03c3) \u223c\n\u0003\n= SY\u0581R (\u03c3) \u00d7 S\u0581Q Y (\u03c3), and since SY (\u03c3) = SY\u0580 (\u03c3) \u2294 SY\u0581 (\u03c3), we deduce (2).\nThe reader can prove a similar splitting for an i-critical point P with i \u2265 3 and \u03c3 \u2208 Sk :\nG\n\u03b6P : SY (\u03c3) \u223c\nSY\u03c4 R (\u03c3) \u00d7 S\u03c4 Q Y (\u03c3),\n=\n\u03c4 \u2208Si\n\nwhere in the notations SY\u03c4 R (\u03c3) and S\u03c4 Q Y (\u03c3) the patterns \u03c4 \u2208 Si have replaced the previously\nused \u0580= (12) and \u0581= (21) in S2 . In order for this isomorphism to be useful, one should\nbe able to enumerate the components SY\u03c4 R (\u03c3) and S\u03c4 Q Y (\u03c3); however, for a general pattern\n\u03c3 and high critical index i, this question acquires a level of difficulty at least comparable\nto that of Wilf-enumeration |Sn (\u03c3)|. Fortunately, when i = 2 and \u03c3 = (312) or (321), this\nenumeration is possible and is carried out in Section 5.\n3.5. The \u03c3 \u2192 \u03c4 moves. Let T \u2208 SY . For any two permutations \u03c3, \u03c4 \u2208 Sk we define a\n\u03c3 \u2192 \u03c4 move on T as follows: if (\u03b11 \u03b12 * * * \u03b1k ) is a \u03c3-subpattern of T in Y , we rearrange the\n\u03b1i 's within the k \u00d7 k matrix they generate so as to obtain a \u03c4 -subpattern (\u03b21 \u03b22 * * * \u03b2k ) in Y .\nThe inverse operation is obviously a \u03c4 \u2192 \u03c3 move. A sequence of \u03c3 \u2192 \u03c4 moves that starts\nwith a transversal T is called \"a sequence of \u03c3 \u2192 \u03c4 moves on T \".\nFor example, if (\u03b1\u03b2\u03b3) is a (213)-pattern in T landing in Y , a (213) \u2192 (123) move switches\nthe places of \u03b1 and \u03b2 to obtain (\u03b2\u03b1\u03b3) \u2248 (123) in Y . Throughout the paper, we will use\ntwo instances of \u03c3 \u2192 \u03c4 moves: (213) \u2192 (123) and (312) \u2192 (321) moves, along with their\ninverses. In particular, we will construct maps\nSY (213) \u0592\u2192 SY (123) \u223c\n= SY (321) \u0565\u0582 SY (312),\nand pose questions about the general maps \u03c6 : SY (\u03c4 ) \u2192 SY (\u03c3) that are induced under\ncertain circumstances by a sequence of \u03c3 \u2192 \u03c4 moves in Y .\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n13\n\n4. Proof of the Inequality SY (312) \u2265 SY (321)\nIn this section we prove that (321) \u0016s (312). Since (321) \u223cs (123), this will establish the\nrequired in Theorem 1 inequalities |SY (123)| \u2264 |SY (312)| for all Young diagrams Y . The\nstrategy is to describe the structures of each set SY (321) and SY (312), use this information\nto define a canonical map \u03c6 : SY (312) \u2192 SY (321), and finally prove that \u03c6 is surjective.\n4.1. The structure of T \u2208 SY (321). T is the disjoint union of its first and second subsequences: T = T 1 \u2294 T 2 . Indeed, if there were some \u03b3 \u2208 T \\{T 1 \u222a T 2 }, then Y\u03b3\u0304 would\ncontain some element \u03b2 \u2208 T 2 , and hence Y\u03b2\u0304 would contain some element \u03b1 \u2208 T 1 , so that\n(\u03b1\u03b2\u03b3) \u2248 (321) in T and lands in Y , a contradiction.\n4.2. The structure of T \u2208 SY (312). Compared to the previous paragraph, the structure\nhere is considerably more complex. We shall not need all of it in the proof of the inequality\nSY (312) \u2265 SY (321). Yet, it is enlightening as to why the proof works and why strict\ninequalities SY (312) > SY (321) occur for some Y . For the remainder of this subsection, we\nfix some transversal T \u2208 SY (312).\nDefinition 16. For any \u03b2 \u2208 T 2 , define a directed graph G\u03b2 on the elements of \u03b2 T as follows:\n\u2212\u2192\n\nconnect by a directed edge \u03b41 \u03b42 any two elements \u03b41 and \u03b42 of \u03b2 T such that (\u03b41 \u03b42 ) \u0581 and\nthere is no \"intermediate\" \u03b43 \u2208 \u03b2 T with (\u03b41 \u03b43 \u03b42 ) \u0581 (cf. Fig. 10a.)\n\u03b1\n\u03b2\n\u03b2\n\n\u03b2\nG\u03b2\n\u03b41\n\n\u03b31\n\n\u03b32\n\u03b32\n\n\u03b42\n\nFigure 10. (a) Graph G\u03b2 for \u03b2 \u2208 T 2 ;\n\n\u03b31\n\u03b33\n\nc\n\u03b33\n\n(b)-(c) Lemma 7\n\nLemma 7. For any \u03b2 \u2208 T 2 , \u03b2 T avoids (12) in Y . Further, G\u03b2 is connected and, stripping\noff the orientation of its edges, cycle-free.\nProof: For the first part, by definition of \u03b2 \u2208 T 2 , there is some \u03b1 \u2208 T 1 \u2229 T\u03b2\u0304 which (21)dominates \u03b2. To avoid the possibility of \u03b1 playing the role of a \"3\" in a (312)-pattern in\nT , \u03b2 T must avoid (12) in Y .\nFor the second part, \u03b2 (21)-dominates any \u03b3 \u2208 \u03b2\u0304 T so that \u03b3 is connected to at least one\nother vertex in \u03b2 T \u2229 T\u03b3\u0304 , and eventually, there is a path starting from \u03b2 and leading to \u03b3.\nThus, G\u03b2 is connected.\nSuppose that there is an (undirected) cycle C in G\u03b2 . If we start at an arbitrary vertex\n\u03b4 \u2208 C and follow C along the orientation of its edges, we cannot come back to \u03b4, or else we\nwill have a decreasing sequence (\u03b4, \u03b41 , \u03b42 , ...., \u03b4k , \u03b4), which is absurd.\nTherefore, going around C along the edge orientation leads to a smallest vertex \u03b33 in\n\u2212\u2192\n\u2212\u2192\nC, at which two edges \u03b31 \u03b33 and \u03b32 \u03b33 terminate (with, say, \u03b31 before \u03b32 .) If (\u03b31 \u03b32 ) \u0581,\nthen (\u03b31 \u03b32 \u03b33 ) \u0581, contradicting the construction of G\u03b2 without intermediate vertices (cf.\n\n\f14\n\nZVEZDELINA STANKOVA\n\nFig. 10b.) Thus, (\u03b31 \u03b32 ) \u0580. Since \u03b33 \u2208 \u03b3 \u03041 T \u2229 \u03b3 \u03042 T , the triangle \u03b31 \u03b32 \u03b33 contains the cell c\nonto which (\u03b31 \u03b32 ) lands as a (12)-pattern, and hence \u03b2 T also contains c (cf. Fig. 10c.) Yet,\nby the first part of this Lemma, \u03b2 T avoids (12) in Y , a contradiction. Therefore, G\u03b2 has\nno (undirected) cycles.\n\u0003\nLemma 7 allows us to think of G\u03b2 as an oriented tree rooted at \u03b2. Now consider all trees\nG\u03b2i , where T 2 = (\u03b21 , \u03b22 , * * * , \u03b2k ) \u0580. For i < j, if \u03b3 \u2208 G\u03b2i \u2229 G\u03b2j , then \u03b3 6= \u03b21 , \u03b22 and\n(\u03b2i \u03b3) \u2248 (\u03b2j \u03b3)\u0581. Evidently, if m is between i and j, then (\u03b2m \u03b3) \u0581, so that \u03b3 is also in G\u03b2m\n(cf. Fig. 11a.) In other words,\nLemma 8. Let G = \u222aki=1 G\u03b2i be the union of all trees. Then each connected component Cj\nof G is the union of several consecutive trees: Cj = G\u03b2kj \u222a G\u03b2kj +1 \u222a G\u03b2kj +2 \u222a . . . \u222a G\u03b2kj+1 \u22121 .\n\u03b2j\n\u03b2i\n\n\u03b2m\n\n\u03b2k\n\n\u03b2k\n\n\u03b2l\n\n\u03b31\n\n\u03b2i\n\n\u03b33\n\n\u03b3i\n\n\u03b3\n\u03b32\n\n\u03b3j\n\nFigure 11. Lemmas 8, 9, 10\n\u2212\u2192\n\nBy construction, each edge \u03b31 \u03b32 of a connected component Cj is entirely contained in\n\u2212\u2192\nsome tree G\u03b2i . If \u03b31 and \u03b32 also belong to another tree G\u03b2k , then the edge \u03b31 \u03b32 must also\nbelong to G\u03b2k . Indeed, if not, the (21)-pattern (\u03b31 \u03b32 ) requires at least one intermediate\nvertex \u03b33 in G\u03b2k : (\u03b31 \u03b33 \u03b32 ) \u0581 (cf. Fig. 11b.) But then \u03b33 is also an intermediate vertex in\n\u2212\u2192\nG\u03b2i , hence the edge \u03b31 \u03b32 does not exist in G\u03b2i , a contradiction. We conclude that\nLemma 9. Any tree G\u03b2i is a full subgraph of its connected component Cj .\nUsing Lemma 9, we can augment the proof in Lemma 7 to derive in an almost identical\nway that each connected component Cj has no (undirected) cycles. Thus, we can think of\neach Cj as an oriented \"tree\" rooted at all of its the maximal elements, i.e. all \u03b2i \u2208 T 2 \u2229 Cj .\nLemma 10. The connected components of G are arranged in an increasing pattern according to the \u03b2i 's they contain. More precisely, choose some \u03b2k \u2208 Ci and \u03b2l \u2208 Cj such that\nk < l, i.e. (\u03b2k \u03b2l ) \u0580. Then Ci is entirely to the left and below Cj .\nProof: Consider any \u03b3i \u2208 Ci and \u03b3j \u2208 Cj . If (\u03b3i \u03b3j ) \u0581 or (\u03b3j \u03b3i ) \u0581, Lemma 9 guarantees a\npath between \u03b3i and \u03b3j , contradicting Ci \u2229 Cj = \u2205. Thus, \u03b3i and \u03b3j form (in some order)\nan increasing sequence. To complete the proof, we need to show (\u03b3i \u03b3j ) \u0580.\nTo the contrary, suppose (\u03b3j \u03b3i ) \u0580. Because of Lemma 8 and the arbitrary choice of\n\u03b2k \u2208 Ci and \u03b2l \u2208 Cj , we may assume that \u03b3i \u2208 G\u03b2k \u2282 Ci and \u03b3j \u2208 G\u03b2l \u2282 Cj , i.e.\n(\u03b2k \u03b3i ) \u0581 and (\u03b2l \u03b3j ) \u0581 (cf. Fig. 11c.) Putting together all four elements, we arrive at the\nsubsequence (\u03b2k \u03b2l \u03b3j \u03b3i ) \u2248 (3412), which does not necessarily land in Y . Then (\u03b2k \u03b3j ) \u0581 so\nthat \u03b3j \u2208 G\u03b2k \u2282 Ci . Thus, \u03b3j \u2208 Ci \u2229 Cj = \u2205, a contradiction. If it happens that \u03b3i = \u03b2k , or\n\u03b3j = \u03b2l , or both, immediate contradictions in the overall arrangement arise.\nWe conclude that (\u03b3i \u03b3j ) \u0580, so that Ci is entirely to the left and below Cj .\n\u0003\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n15\n\nThus, the connected components of G are arranged in a increasing diagonal fashion,\nsymbolically, G = (C1 , C2 , ..., Ck ) \u0580. Correspondingly, the whole transversal T \u2208 SY (312)\nis the disjoint union of the increasing subsequence T 1 and all the vertices |Ci | of the Ci 's:\nT = T 1 \u2294 |G| = T 1 \u2294i |Ci |.\n\n(3)\n\nThis description of a (312)-avoiding transversal in Y is only partial (transversals satisfying\nit do not necessarily avoid (312)), but sufficient for our purpose to explain why (312) is\neasier to avoid than (321) on Young diagrams Y (cf. also Section 5.) In particular, the\ndescription involves only the elements of the transversal T , while it is possible to extend\nit to the whole Young diagram Y . To this end, let Yj be the Young subdiagram of Y\nobtained after reducing Y along all elements of T not in Cj ; one can think of Yj as the\nYoung subdiagram induced by the elements of Cj . Since the Cj 's are disjoint, the Yj 's are\ndisjoint, and we leave it to the reader to deduce in a similar fashion as above:\nLemma 11. The Young subdiagrams Yi are arranged in a increasing diagonal fashion:\nY = (Y1 , Y2 , ..., Yk ) \u0580.\n4.3. Definition of the map \u03c6 : SY (312) \u2192 SY (321). Fix a transversal T \u2208 SY (312), and\ndecompose T = T 1 \u2294 |G| as in (3) (cf.\u000eFig. 12.) Reducing Y along T 1 leaves the pattern\nof |G| in a Young subdiagram Y0 = Y 1 . Since |G| represents a transversal of Y0 , then\nT\nY0 is proper, with diagonal d(Y0 ). Replacing |G| by the increasing pattern Is = (123...s)\nalong d(Y0 ) produces another transversal of Y0 . We reintroduce the rows and columns of\nthe previously reduced subsequence T 1 to obtain our original Young diagram Y with a new\ntransversal \u03c6(T ) = T 1 \u2294 Is . Since \u03c6(T ) is partitioned into two increasing subsequences,\n\u03c6(T ) avoids (321) and thus \u03c6 : SY (312) \u2192 SY (321) is well-defined.\nT 1 =(\u03c6(T ))1\n\nT1 T2\n\u03b1\n\u03b2\u2032\n\n\u03b2\n\n|G|1 =T 2\n\nIs on Y0\n\n(\u03c6(T ))2\n\n\u03b1\n\n\u03b4\u2032\n\u03b4\nG\n\nFigure 12. T \u2208 SY (312) \u2192 T |Y0 \u2192 Is \u2192 \u03c6(T ) \u2208 SY (321)\n4.4. Surjectivity of \u03c6. To show that \u03c6 is surjective, we will first show\nLemma 12. \u03c6 preserves T 1 , i.e. (\u03c6(T ))1 = T 1 .\nProof: Since the elements of T 1 are fixed by \u03c6, it suffices to show that any other element\n\u03b4 \u2208 \u03c6(T )\\T 1 , is (21)-dominated by some \u03b1 \u2208 T 1 , implying \u03b4 6\u2208 (\u03c6(T ))1 .\nThus, start with \u03b4 \u2208 \u03c6(T )\\T 1 and pull it back to \u03b4\u2032 \u2208 Is on Y0 (cf. Fig. 12d-c.) Consider\nthe rectangle (Y0 )\u03b4\u2032 : since the cell of \u03b4\u2032 is on the diagonal d(Y0 ), the proof of Lemma 3\nimplies that the transversal T |\u000eY0 cannot sustain such a big empty rectangle. On the other\nhand, in the reduction Y0 = Y 1 , the first sequence of the transversal |G| coincides with\nT\nthe original second sequence T 2 in Y : |G|1 = T 2 (cf. Fig. 12b.) Putting together these\nconsiderations implies the existence of some \u03b2 \u2032 \u2208 |G|1 in the rectangle (Y0 )\u03b4\u2032 . Pulling \u03b2 \u2032 to\n\n\f16\n\nZVEZDELINA STANKOVA\n\n\u03b2 \u2208 T 2 on Y , we deduce that some \u03b1 \u2208 T 1 (21)-dominates \u03b2 (cf. Fig. 12a.) Comparing\nthe relative positions of \u03b1, \u03b2 and \u03b4 in Y , we conclude that \u03b1 (21)-dominates \u03b4 in \u03c6(T ).\nTherefore, \u03b4 6\u2208 (\u03c6(T ))1 , and as noted above, this means (\u03c6(T ))1 = T 1 .\n\u0003\nWe can also think of \u03c6 in terms of the canonical decomposition in (3) of T \u2208 SY (312):\nreplace every connected component Ci in G by the increasing sequence Ii in the Young\nsubdiagram Yi . Then Is = I1 \u2294 I2 \u2294 . . . \u2294 Ik . This works since the Ci 's and the Yi 's are\nindependent of each other and arranged in an increasing sequence in Y .\n\nLemma 13. Given a fixed increasing sequence L of dots in Y , there is at most one transversal T \u2208 SY (321) for which T 1 = L.\n\u000e\nProof: If T \u2208 SY (321) is such a transversal, then T = T 1 \u2294 T 2 with T 1 = L. Reducing T L\nleaves T 2 , \u000ewhich must be an increasing sequence in and a\u000etransversal of the resulting Young\ndiagram Y L ; yet, there is only one such sequence in Y L , namely, its diagonal sequence\nIs . This uniquely defines T 2 , and since the rest of T is the fixed L, it uniquely defines\nT := L \u2294 Is too. Of course, after putting back L and Is = T 2 to Y , it may turn out that\nthe newly added points of T 2 violate the definition of L by participating in T 1 , so in this\ncase there would be no T \u2208 SY (321) with T 1 = L.\n\u0003\nProposition 3. The map \u03c6 : SY (312) \u2192 SY (321) is surjective.\n\nProof: Let Q \u2208 SY (321), and decompose Q = Q1 \u2294 Q2 . We will construct T \u2208 SY (312)\nsuch that T 1 = Q1 . For that, start with Q and apply any sequence of (312) \u2192 (321) moves\non Q until there are no more (312)-patterns in Y . Denote the final transversal of Y by T .\nAs an example, reverse the arrow \u03c6 in Figure 13 in Section 5: depending on the order of\npicking the (312)-patterns, one can get from Q = (31524) \u2208 SY (321) to T1 = (31542) or\nT2 = (32514) in SY (312).\nEach move replaces a (312)-pattern in Y with a (321)-pattern in Y by fixing the element\nplaying the role of \"3\", and switching the other two elements as in (12) 7\u2192 (21), and thereby\nincreasing the number\nof inversions in the total transversal. Hence the number of moves\n\u0001\ncannot exceed n2 and the sequence of moves eventually terminates with some T \u2208 SY (312).\nThe first subsequences of the original and of the final permutation coincide: T 1 = Q1 .\nIndeed, none of the moves (\u03b11 \u03b12 \u03b13 ) \u2248 (312) 7\u2192 (\u03b11 \u03b13 \u03b12 ) \u2248 (321) changes the first subsequence, because \u03b11 (21)-dominates the other two elements, whether before or after the\nmove. Hence \u03b12 and \u03b13 are not in and cannot land in the first subsequence via the moves,\nand their switch certainly does not affect in any way the existing first subsequence elements.\nWe conclude that T 1 = Q1 .\nBy Lemma 12, \u03c6 preserves the first subsequence, so that applying \u03c6 to T yields \u03c6(T ) \u2208\nSY (321) with (\u03c6(T ))1 = T 1 = Q1 . But by Lemma 13, there is at most one transversal in\nSY (321) with first subsequence Q1 , namely, Q. Thus, \u03c6(T ) = Q and \u03c6 is surjective.\n\u0003\n4.5. Conclusions. Proposition 3 implies that for all Young diagrams Y :\n|SY (312)| \u2265 |SY (321)|,\n\nwhich is one of the two inequalities in Theorem 1. Therefore, (312) \u0017s (321). Now Proposition 1 implies that (312|\u03c4 ) \u0017s (321|\u03c4 ) for any permutation \u03c4 ; equivalently, for any Young\ndiagram Y we have |SY (312|\u03c4 ) \u2265 |SY (321|\u03c4 )|. Consequently, for all n:\n|Sn (312|\u03c4 )| \u2265 |Sn (321|\u03c4 )|,\n\nwhich completes half of Corollary 1.\n\n\u0003\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n17\n\n5. Strict Inequalities SY (312) > SY (321)\n5.1. Examples of Strict Inequalities. Since \u03c6 : SY (312) \u0589 SY (321), a strict inequality\n|SY (312)| > |SY (321)| occurs exactly when for some Q \u2208 SY (321) the fiber \u03c6\u22121 (Q) \u2282\nSY (312) has more than 1 element. From the proof of Proposition 3, this happens exactly\nwhen two distinct T1 , T2 \u2208 SY (312) have the same first subsequences: (T1 )1 = (T2 )1 .\nT1\n\nT 1=Q1 I3\n\nT1\n\n\u03c6\n\nand\n\n\u03c6\n\nFigure 13. T1 = (31542), T2 = (32514) \u2208 SY5 (312) \u2212\u2192 Q = (31524) \u2208 SY5 (321)\nExample 1. We revisit the Young diagram Y5 = (5, 5, 5, 5, 4), mentioned in the Introduction. It is the smallest Young diagram on which (312) is less restrictive than (321):\n|SY (312)| = 42 > 41 = |SY (321)|. The two sets intersect in a large subset: |SY (312, 321)| =\n21, and \u03c6 : SY (321) \u0589 SY (312) acts as the identity map on this intersection. Indeed, if\nT \u2208 SY (312, 321), then T = T 1 \u2294 T 2 , so that Is \u2261 T 2 \u0580 and \u03c6(T ) = T 1 \u2294 Is = T . In\naddition, there are 19 transversals U \u2208 SY (321) whose preimages in SY (312) consist of\nsingle elements \u03c6\u22121 (U ) 6= U .\nAs expected, the map \u03c6 is non-invertible only on the remaining one transversal Q \u2208\nSY (321), namely, Q = (31524) (cf. Fig. 13, where all first subsequences are denoted by\nT 1 .) Its preimage is \u03c6\u22121 (Q) = {T1 , T2 } where T1 = (31542) and T2 = (32514). Note\nthat (T1 )1 = (T2 )1 (= {3, 5}), which ensures that \u03c6(T1 ) = \u03c6(T2 )(= Q). Yet, the canonical\ndecompositions of T1 and T2 into connected components differ: T1 = T 1 \u2294 {1} \u2294 {4, 2} and\nT2 = T 1 \u2294 {2, 1} \u2294 {4}, causing two preimages of Q.\n\n\u03c6\n\nand\nT1\n\nQ\n\nT2\n\n\u03c6\n\nFigure 14. T1 , T2 \u2208 SYn (312) \u2212\u2192 Q \u2208 SYn (321)\nExample 2. We extend Example 1 to all Yn with n \u2265 5. Let T1n = (3, 4, ..., n \u2212 2, 1, n, n \u2212\n1, 2) and T2n = (3, 4, ..., n \u2212 2, 2, n, 1, n \u2212 1) (cf. Fig. 14.) It is easy to verify that T1n and T2n\nare (312)-avoiding on Yn with the same first subsequence (T1n )1 = (T2n )1 = (3, 4, ..., n\u22122, n),\nand as such, they have the same image Q = \u03c6(T1n ) = \u03c6(T2n ) = (3, 4, ..., n \u2212 2, 1, n, 2, n \u2212 1) \u2208\nSYn (321). Hence |SYn\u000e(312)| > |SYn (321)|. Non-surprisingly, reducing Yn along most of the\nfirst subsequence: Yn {3, 4, ..., n \u2212 3} , we recover the permutations in Y5 of Example 1.\n\n\f18\n\nZVEZDELINA STANKOVA\n\n5.2. Sufficient condition for strict inequality.\nProposition 4. If Y has an i-critical point with i \u2265 3, then |SY (312)| > |SY (321)|.\nProof: As in Example 2, for strict inequality it is necessary and sufficient to exhibit two\ndistinct transversals T\u03041 , T\u03042 \u2208 SY (312) with (T\u03041 )1 = (T\u03042 )1 . Let P be an i-critical point of Y\nwith i \u2265 3. Starting from P , go down (resp. right) one cell and go left (resp. up) till hitting\nd0 (Y ): call this point S1 (resp. S2 ). With S1 S2 as diagonal, we construct a subdiagram\nY (P ) of Y such that Y (P ) \u223c\n= Yi+2 and P is the i-critical point of Y (P ). For example, in\nFigure 15a the subdiagram Y (P ) \u223c\n= Y6 is generated by the 4-critical point P ; the dashed\nlines represent the diagonals di (Y6 ) for 0 \u2264 i \u2264 4.\n\u03b1Q\n\u03b1=\u03b3\n\nYP\n\nS2\n\nY (P )\n\nR\nT16 or T26\n\nQY\n\n\u03b1R\nQ\n\nS1\n\n\u03b2Q\n\nQY\n\n\u03b2=\u03b4\nP\n\nP\nY\n\n\u03b6P\n\n\u03b2R\n\nR\n\nYR\n\nFigure 15. (a) T\u0304j = (1, Tji+2 , 8, 9)\n\n(b)-(c) (\u03b3\u03b4) \u2282 YP\n\nNow, put dots everywhere along d(Y ) outside of Y (P ). (In Fig. 15a, these dots represent\n1, 8 and 9.) For j = 1, 2, insert Tji+2 from Example 2 inside Y (P ) in order to obtain T\u0304j on\nY . It is immediate that T\u03041 , T\u03042 \u2208 SY (312) and they have the same first subsequence, so that\n\u03c6(T\u03041 ) = \u03c6(T\u03042 ), and hence |SY (312)| > |SY (321)|.\n\u0003\n5.3. Necessary condition for strict inequality SY (312) > SY (321). We shall prove\nthat strict inequalities are obtained, as Theorem 2 claims, only when Y has higher critical\npoints. To this end, we first need to establish two technical recursive formulas for 2-critical\npoints when the avoided pattern is \u03c3 = (312) or (321).\n5.3.1. Recursions for 2-critical points. Recall the points R and Q associated to P in the\ndefinition of the map \u03b6P . When P is the bottom critical point of Y , Y R and Y Q are\nboth squares, which makes the calculations below possible (cf. Fig. 15b.) Recursion (4)\nin Lemma 14 below reduces calculations from the larger Young diagram Y to the smaller\nQ Y ; yet, it is not very useful on its own since it also introduces the new sets S\u0581Q Y (\u03c3) and\nS\u0580Q Y (\u03c3). Hence the necessity to prove recursion (5). Note the apparent similarity between\nthese recursive formulas for |SY (\u03c3)| and |S\u0581Y (\u03c3)|.\nLemma 14. Let Y be a Young diagram whose bottom critical point P is 2-critical. If there\nare k rows of Y below P , for \u03c3 = (312) or (321) we have:\n(4)\n(5)\n\n|SY (\u03c3)| = ck+1 * |S\u0581Q Y (\u03c3)| + (ck+2 \u2212 ck+1 ) * |S\u0580Q Y (\u03c3)|\n\n|S\u0581Y (\u03c3)| =\n\nck * |S\u0581Q Y (\u03c3)| +\n\n(ck+1 \u2212 ck ) * |S\u0580Q Y (\u03c3)|\n\nProof: The 2-critical splitting from Lemma 6 implies:\n|SY (\u03c3)| = |SY\u0580R (\u03c3)| * |S\u0580Q Y (\u03c3)| + |SY\u0581R (\u03c3)| * |S\u0581Q Y (\u03c3)|.\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n19\n\nClaim 1 below treats the special case of the square Y R of size k + 2. Substituting its results\n|SY\u0581R (\u03c3)| = ck+1 and |SY\u0580R (\u03c3)| = ck+2 \u2212 ck+1 , we readily arrive at the wanted recursion (4).\nTo prove (5), we restrict the map \u03b6P to S\u0581Y (\u03c3) in the 2-splitting isomorphism in (2):\n\n(6)\n\n\u03b6P (S\u0581Y (\u03c3)) \u2282 S\u0581Y\u0580R (\u03c3) \u00d7 S\u0580Q Y (\u03c3) \u2294 S\u0581Y\u0581R (\u03c3) \u00d7 S\u0581Q Y (\u03c3).\n\nAs in the definition of \u03b6P , we write (\u03b1\u03b2) for the 2-element subsequence of T inside YP .\nThere are three possibilities for the initial decreasing subsequence (\u03b3\u03b4) of T \u2208 S\u0581Y (\u03c3).\nCase 1. (\u03b3\u03b4)\u0581 is entirely in the rectangle YP . Then (\u03b3\u03b4) = (\u03b1\u03b2)\u0581 and\n\u03b6P (T ) \u2208 S\u0581Y\u0581R (\u03c3) \u00d7 S\u0581Q Y (\u03c3),\nwith the extra condition that \u03b1R occupies cell (1,1) and \u03b2R occupies cell (2,2) of square Y R\n(cf. Fig. 15b-c.) If avoiding \u03c3 = (312), the remainder of the transversal in Y R is completely\ndetermined as a decreasing subsequence (depicted in Fig. 15c via \"\u25e6\"), while avoiding (321)\nyields no possible completions in Y R . Thus, the images \u03b6P (T ) are in 1-1 correspondence\nwith {Jk+2 } \u00d7 S\u0581Q Y (\u03c3) if \u03c3 = (312), and there are 0 such if \u03c3 = (321).\n\u03b2Q\n\nYP\n\n\u03b2\n\nR\n\nQ\n\n\u03b3\n\u03b4\n\n\u03b1Q\n\nQY\n\n\u03b1\n\n\u03b6P\n\nP\nY\n\nQY\n\n\u03b2R\n\u03b1R\n\u03b3\n\nR\n\n\u03b4\n\nYR\n\nFigure 16. Case 2\nCase 2. (\u03b3\u03b4)\u0581 is entirely in the square Y Q (cf. Fig. 16.) Then (\u03b3\u03b4)\u2229(\u03b1\u03b2) = \u2205, and hence\n(\u03b1\u03b2) can be \u0580 or \u0581. In either case, the four elements (\u03b3\u03b4\u03b1R \u03b2R ) occupy the two leftmost\ncolumns and two top rows of Y R . In the sub-factor S\u0581Y\u0580R (\u03c3) of (6), (\u03b3\u03b4\u03b1R \u03b2R ) \u2248 (2134),\nwhile in the sub-factor S\u0581Y\u0581R (\u03c3), (\u03b3\u03b4\u03b1R \u03b2R ) \u2248 (2143). Claim 2a-b implies that the number\nof images \u03b6P (T ) in these two subcases equals respectively (ck+1 \u2212 ck \u2212 k) * |S\u0580Q Y (\u03c3)| or\n(ck \u2212 1) * |S\u0581Q Y (\u03c3)|.\nYP\n\n\u03b1Q\n\n\u03b3=\u03b1\n\nQY\n\nR\nQY\n\n\u03b2\nQ\n\u03b4\n\nY\n\n\u03b2Q\n\n\u03b3=\u03b1R\nP\n\n\u03b6P\n\n\u03b2R\n\nR\n\n\u03b4\n\nYR\n\nFigure 17. Case 3\n\n\f20\n\nZVEZDELINA STANKOVA\n\nCase 3. \u03b3 \u2208 YP and \u03b4 \u2208 YQ (cf. Fig. 17.) Then \u03b3 = \u03b1, and (\u03b1\u03b2) can be \u0580 or\n\u0581. In the sub-factor S\u0581Y\u0580R (\u03c3), we have (\u03b1R \u03b4\u03b2R ) \u2248 (213) where \u03b1R occupies cell (2,1).\nClaim 2c implies that the number of images in this subcase is k * S\u0580Q Y (\u03c3). In the subfactor S\u0581Y\u0581R (\u03c3), (\u03b1R \u03b4\u03b2R ) \u2248 (312) where \u03b1R occupies cell (1,1). Thus, avoiding \u03c3 = (312)\nyields 0 transversals in this subcase. For \u03c3 = (321), the position of \u03b1R allows for only one\ntransversal on Y R , namely, T1 = (k + 2, 1, 2, ..., k + 1) (depicted in Fig. 17b via \"\u25e6\"), and\nhence the images \u03b6P (T ) here are in 1-1 correspondence with {T1 } \u00d7 S\u0581Q Y (\u03c3).\nAdding up the results in all three Cases, we obtain for each \u03c3 = (312) and \u03c3 = (321):\n|\u03b6P (S\u0581Y (\u03c3))| = (0 + 1 + ck \u2212 1) * |S\u0581Q Y (\u03c3)| + (ck+1 \u2212 ck \u2212 k + k) * |S\u0580Q Y (\u03c3)|\nSince \u03b6P is injective, we derive the wanted recursion (5):\n|S\u0581Y (\u03c3)| = |\u03b6P (S\u0581Y (\u03c3))| = ck * |S\u0581Q Y (\u03c3)| + (ck+1 \u2212 ck ) * |S\u0580Q Y (\u03c3)|.\n\n\u0003\n\n5.3.2. Calculations on the square Y R . We show here all Claims from the proof of Lemma 14:\nthey involve specific calculations on the square Y R of size k + 2. To simplify notation, we\nshall write \u03b1 for \u03b1R and \u03b2 for \u03b2R . Thus, (\u03b1\u03b2) and (\u03b3\u03b4) are the subsequences of T in the\ntop two rows, respectively leftmost two columns, of Y R .\nClaim 1. For \u03c3 = (312) or (321), |SY\u0581R (\u03c3)| = ck+1 , and hence |SY\u0580R (\u03c3)| = ck+2 \u2212 ck+1 .\nProof: We calculate first |SY\u0581R (\u03c3)|, so we assume that (\u03b1\u03b2)\u0581 in Y R . If \u03c3 = (321), to\navoid the situation of \u03b1 and \u03b2 playing the roles of \"3\" and \"2\" in a (321)-pattern in Y R , \u03b2\nmust be in the last column (and the second row) of Y R . As such, \u03b2 cannot participate in\nany (321)-pattern on Y\u000eR , so that reducing along \u03b2 we obtain a (321)-avoiding transversal\nT \u2032 on the rectangle Y R {\u03b2} = Mk+1 , without any further restrictions (cf. Fig. 18a-b.) The\n\noriginal transversal of Y R can be reconstructed from T \u2032 by reinserting \u03b2 in the last row\nand second column of Y R . We have established that SY\u0581R (321) \u223c\n= Sk+1 (321), and hence\n|SY\u0581R (321)| = ck+1 .\n\u03b1\n\u03b2\n\n\u000e\n\nYR\n\n{\u03b2}\n\nMk+1\n\n\u03b1\n\n\u000e\n\nYR\n\n{\u03b2}\n\nYR\n\n\u03b2\n\nYR\n\nFigure 18. Claim 1\nSimilarly, if \u03c3 = (312), \u03b1 and \u03b2 must be in adjacent columns in Y R in order to avoid\n(312). But they are already in the top two rows of Y , so they are situated in diagonally\u2032\u2032\nadjacent cells.\n\u000e Again, reducing along \u03b2 we obtain a (312)-avoiding transversal T on the\nR\nrectangle Y {\u03b2} = Mk+1 , without any further restrictions (cf. Fig. 18c-b.) The original\n\ntransversal of Y R can be reconstructed from T \u2032\u2032 by reinserting \u03b2 in the second row and the\ncolumn on the right of \u03b1's column in Y R . We have established that SY\u0581R (312) \u223c\n= Sk+1 (312),\nand hence |SY\u0581R (312)| = ck+1 .\nTo finish the argument, we note that SY\u0580R (\u03c3) is the complement of SY\u0581R (\u03c3) in SY R (\u03c3), so\n\u0003\nthat for \u03c3 = (321) of (312) we have |SY\u0580R (\u03c3)| = |SY R (\u03c3)| \u2212 |SY\u0581R (\u03c3)| = ck+2 \u2212 ck+1 .\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n21\n\nClaim 2. (a) There are ck+1 \u2212 ck \u2212 k transversals T \u2208 S\u0581Y\u0580R (\u03c3) with {\u03b3\u03b4} \u2229 {\u03b1\u03b2} = \u2205.\n(b) There are ck \u2212 1 transversals T \u2208 S\u0581Y\u0581R (\u03c3) with {\u03b3\u03b4} \u2229 {\u03b1\u03b2} = \u2205.\n(c) There are k transversals T \u2208 S\u0581Y\u0580R (\u03c3) with \u03b1 = \u03b3.\nProof: All transversals in question are elements of S\u0581Y R (\u03c3), i.e. (\u03b3\u03b4)\u0581. Similarly to the\nproof of Claim 1, either \u03b4 is in the last row (and second column) of Y R (\u03c3 = (321)), or\nneighboring \u03b3 southeast-diagonally\u000e (\u03c3 = (312)). In either case, we reduce Y R along \u03b4 to\nobtain equinumerant subsets of Y R {\u03b4} = Mk+1 with the following restrictions (cf. Fig. 19):\n\u03b2\n\u03b1\n\n\u03b1\n\n\u03b2\n\u03b2\n\nMk+1\n\nMk+1\n\n\u03b1\n\nMk+1\n\nFigure 19. Claim 2. (a1)-(b1)-(c1)\n\n\u0580\n\n\u223c\n=\n\nMk+1 =\n\n= \u0580Mk+1\n\n\u0580\n\n(M k+1 )t \u223c\n= \u0580Mk+1\n\n\u0580\n(a1) all transversals of SM\n(\u03c3) for which the top two elements (\u03b1\u03b2)\u0580 do not lie in the\nk+1\nfirst column of Mk+1 (occupied by \u03b3);\n\u0581\n(b1) all transversals of SM\n(\u03c3) for which the top two elements (\u03b1\u03b2)\u0581 do not lie in the\nk+1\nfirst column of Mk+1 (occupied by \u03b3);\n\u0580\n(c1) all transversals of SMk+1\n(\u03c3), for which one of the top two elements (\u03b1\u03b2)\u0580 does lie\nin the first column of Mk+1 (\u03b1 = \u03b3 is that element.)\nLet's start with case (c1). Since \u03b1 is in position (2,1), the rows below \u03b1 are filled either\nwith an increasing (for \u03c3 = (321)) or with a decreasing (for \u03c3 = (312)) subsequence. In\nFig. 19c, \u25e6 and \u2212 denote, respectively, these increasing and decreasing subsequences. At the\nsame time, \u03b2 can be reinserted in any of the k possible cells of the top row of Y R without\ncreating any \u03c3-patterns. Thus, the number of transversals in (c) is k.\n\u0003\n\u0580\nCase (a1) is the complement of (c1) inside SMk+1\n(\u03c3). Since (321), (312) and Y R are\nsymmetric with respect to transposing across the northwest/southeast diagonal, and since\n\u0580\n(SMk+1\n(\u03c3))t = S\u0580Mk+1 (\u03c3), we can use Claim 1 for Y R = Mk+1 to calculate:\n\u0580\n|SMk+1\n(\u03c3)| = |S\u0580Mk+1 (\u03c3)| = ck+1 \u2212 ck .\n\nTherefore, the number of transversals in (a) equals ck+1 \u2212 ck \u2212 k.\n\u0003\n\u0581\nFinally, case (b1) misses only one transversal of the set SMk+1\n(\u03c3): namely, when \u03b1 is in\nposition (1,1), without any more restrictions (cf. Fig 19b.) In such a situation, the rest of\nMk+1 is again filled either with an increasing or with a decreasing subsequence (respectively,\n\u0581\nfor \u03c3 = (321) and (312)). Thus, case (b1) counts 1 fewer transversals than SMk+1\n(\u03c3). Using\nR\nagain the transposing argument and Claim 1 for Y = Mk+1 , we conclude that the number\nof transversals in (b) equals\n\u0581\n|SMk+1\n(\u03c3)| \u2212 1 = |S\u0581Mk+1 (\u03c3)| \u2212 1 = ck \u2212 1. \u0003\n\n5.3.3. Conclusions for low-rank critical points.\nLemma 15. If Y has only 2-critical points, then |S\u0581Y (321)| = |S\u0581Y (312)|, |S\u0580Y (321)| =\n|S\u0580Y (312)|, and hence |SY (321)| = |SY (312)|.\n\n\f22\n\nZVEZDELINA STANKOVA\n\nProof: For the special case of a square Y = Mk+2 (which has no critical points), the first\ntwo equalities were proven in Claim 1 for the square YR , while the third equality is the\nwell-known Wilf-equivalence (312) \u223c (321).\nFor the general case, we proceed by induction on the size n of Y . For n \u2264 3 there\nare no 2-critical points. Suppose that Y is of size n \u2265 4, not a square, and has only 2critical points. Let Y 's bottom (2-)critical point be P . The Young subdiagram Q Y from\nLemma 14 is of smaller size, and by construction, its critical points are all of Y 's critical\npoints, short of P . Applying induction to Q Y , we have |S\u0581Q Y (321)| = |S\u0581Q Y (312)| and\n|S\u0580Q Y (321)| = |S\u0580Q Y (312)|. Recursions (4)-(5) then imply |SY (321)| = |SY (312)| and\n|S\u0581Y (321)| = |S\u0581Y (312)|. Since S\u0580Y (\u03c3) is the complement of S\u0580Y (\u03c3) in SY (\u03c3) for any \u03c3,\nit also follows that |S\u0580Y (321)| = |S\u0580Y (312)|.\n\u0003\nProposition 5. |SY (312)| = |SY (321)| if Y has only i-critical points with i \u2264 2.\nProof: If Y has some 0- or 1-critical point P , Proposition 2 implies that there is a 0- or\n1-splitting for any permutation \u03c3:\n|SY (\u03c3)| = |SU (\u03c3)| * |SV (\u03c3)|,\n\nwhere U and V are some Young subdiagrams of Y of smaller sizes. Since by construction\nthe diagonals d(U ) and d(V ) lie on d(Y ), the set of critical points of U and V is the same\nas the set of critical points of Y , short of P . In other words, U and V again have only 0-,\n1- or 2-critical points. Continuing the splitting process for every 0- or 1-critical point of the\nsmaller diagrams, we arrive eventually at a splitting\n|SY (\u03c3)| = |SU1 (\u03c3)| * |SU2 (\u03c3)| * * * |SUk (\u03c3)|,\n\nwhere each subdiagram Ui has only 2-critical points (or no critical points at all). Lemma 15\nguarantees that |SUi (321)| = |SUi (321)| for all i, so that the products |SY (321)| and\n|SY (312)| are also equal.\n\u0003\nFinally, combining the results of Propositions 4-5, we derive the second necessary and\nsufficient condition in Theorem 2: |SY (312)| > |SY (321)| if and only if Y contains an\ni-critical point with i \u2265 3.\n\u0003\n6. Proof of the Inequality SY (213) \u2264 SY (123)\n6.1. The (213)-decomposition. In [17], Stankova-West show (213) \u223cs (132). Their proof\nintroduces a special decomposition of the (213)-avoiding transversals on any Young diagram.\nHere we modify and extend this decomposition for our purposes, and use it later for comparing SY (213) and SY (123).\nDefinition 17. Let Y be a Young diagram and let c be a cell in the bottom row of Y .\nStart from the bottom left corner of c, draw a 45\u25e6 ray in north-east direction until the ray\nintersects for the first time the border of Y , and use the resulting segment as the \u000e\ndiagonal of\na smaller subdiagram Ac of Y . Reducing Y along Ac leaves a subdiagram Bc = Y A . Thus,\nc\nc determines a pair (Ac , Bc ) of Young subdiagrams of Y , called the (213)-decomposition of Y\ninduced by c and denoted by Y213 (c) = Ac \u2297Bc . If a transversal T \u2208 SY is concentrated in Ac\nand Bc , we say that T respects this (213)-decomposition of Y and we write T = T |Ac \u2297 T |Bc .\n\nBecause of the 45\u25e6 angle of the diagonal d(Ac ), the Young subdiagram Ac is proper, and\nhence the reduction along it, Bc , is also proper. The smallest Ac can be is the cell c: this\nhappens when c is the rightmost cell in the bottom row of Y . The decomposition Y213 (c)\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n23\n\nor\nBLc\n\nBLb\n\nBLc BRc\n\nBRc\n\nBb\n\n\u03b3\nBc\n\n\u03b1\nAc\n\nor\nAb\n\nAc\n\nb\n\nBRb\n\nb\nc\n\nc\n\nFigure 20. Minimal and non-minimal (213)-decompositions\nis trivial exactly when Bc = \u2205: this happens when c is the bottom left corner of Y and Y\nhas no 0-critical points. In such a case, Y213 (c) = Ac . While Ac 's rows and columns are\nnot interspersed with \"outside\" rows or columns from Y \\Ac , in general, Bc splits into two\nparts: Bc = BRc + BLc where BRc is to the left and above Ac and BLc is to the right and\nabove Ac (cf. Fig. 20.)\nThe name \"(213)-decomposition\" comes from the fact that all (213)-avoiding transversals\nT respect at least one (213)-decomposition of Y .\nProposition 6 (Stankova-West). Let c be a bottom cell in Y , and let T \u2208 SY (213) have\nits bottom element in cell c. Then T respects the (213)-decomposition Y213 (c) = Ac \u2297 Bc ,\nand hence it decomposes as T = T |Ac \u2297 T |Bc . Conversely, if T \u2208 SY respects this (213)decomposition, and if the restrictions T |Ac and T |Bc are each (213)-avoiding on Ac and Bc ,\nrespectively, then T is (213)-avoiding on all of Y .\nFor some T \u2208 SY (213), it is possible that different bottom cells ci 's induce different (213)decompositions T = T |Aci \u2297 T |Bci . However, for only one (213)-decomposition T 's bottom\nelement ~ is in Ac 's bottom left corner; we call this the minimal (213)-decomposition of T\nsince all other (213)-decompositions will have ~ somewhere further to the left and hence\ntheir components Aci will contain properly Ac . For example, Figure 20 shows the minimal\nT213 (c) = (15234) \u2297 (35124) and a non-minimal T213 (b) = (6152347) \u2297 (132) decompositions\nof T = (8, 10, 6, 1, 5, 2, 3, 4, 7, 9). Proposition 6 implies that every T \u2208 SY (213) respects its\nminimal (213)-decomposition. More generally,\nDefinition 18. For any transversal T \u2208 SY , the (213)-decomposition of T whose Ac component is contained properly in the A-components of any other (213)-decomposition\nof T is called the minimal (213)-decomposition of T . If all (213)-decompositions of T are\ntrivial, i.e. T = T |Ac , we say that T is (213)-indecomposable.\n\nWhen it is irrelevant which bottom cell c induces some (213)-decomposition of T , we\nshall drop c from the notation, e.g. T = T |A \u2297 (T |BL + T |BR ).\nFor a general transversal T \u2208 SY (\u03c3) which (213)-decomposes as T = T |A \u2297 T |B , it is\nevidently true that T |A and T |B each avoid \u03c3 on A and B, respectively. The converse is\nfalse in general: T |A \u00d7 T |B \u2208 SA (\u03c3) \u00d7 SB (\u03c3) does not imply T \u2208 SY (\u03c3). Yet, for special\ncases of \u03c3, the converse is true. We have seen in Proposition 6 that \u03c3 = (213) is such a\nspecial case. Another one is \u03c3 = (123).\nLemma 16. If T \u2208 SY has a (213)-decomposition T = T |A \u2297 T |B on Y , and if each\nsubtransversal avoids (123): T |A \u2208 SA (123) and T |B \u2208 SB (123), then T \u2208 SY (123).\n\n\f24\n\nZVEZDELINA STANKOVA\n\nProof: Suppose that T has a (123)-subsequence (\u03b1\u03b2\u03b3) landing inside Y . Because of\nthe hypothesis on the two subtransversals, this pattern must involve elements from both\nsubdiagrams A and B. Since A is entirely below B, the element \u03b1 (which plays the role\nof \"1\") must come from A. But since \u03b1 is also the leftmost element of the pattern, it\neliminates any participation coming from BL. This forces the last element \u03b3 to come from\nBR (cf. Fig. 20a.) Yet, no two elements of A and BR can participate in any pattern in Y :\nby construction of the 45\u25e6 diagonal of A, BR is entirely to the right and above A, forcing\nthe rows of A and the columns of BR, to intersect outside Y .\nWe conclude that a (123)-pattern is impossible, so that T \u2208 SY (123).\n\u0003\nWe shall see below that the (213)-decompositions of any T \u2208 SY on Y are preserved by\n(213) \u2192 (123)- and (123) \u2192 (213) moves on T , which will allow us to prove eventually the\ndesired inequality |SY (123)| \u2265 |SY (213)|.\n6.2. Special (213)-decompositions. Fix a (213)-decomposition T = T |Ac \u2297 T |Bc of a\ntransversal T \u2208 SY . If BRc = \u2205, we obtain a generalization of the decomposability Definition 7 of a permutation \u03c3 \u2208 Sn . To keep up with the previous conventions, we say in\nthis case that the transversal T is decomposable, and also write T = (T |BLc T |Ac ). The two\nblocks of T are arranged in a northwest/southeast fashion.\nOn the other hand, if BLc = \u2205, not only the given transversal decomposes as T =\nT |Ac \u2297 T |BRc , but any transversals T \u2032 of Y respects this decomposition. Indeed, in this\ncase, c is the bottom left corner cell of Y and Y contains a 0-critical point P , and hence\nany transversal T \u2032 \u2208 SY has this 0-splitting with respect to P . Here the two blocks of T \u2032\nare arranged in a southwest/northeast fashion.\nThus, all decompositions in this paper are (213)-decompositions or special cases of it.\n6.3. \u03c3 \u2192 \u03c4 moves on T \u2208 SY . Since each (213) \u2192 (123) move decreases the number of\ninversions in T , any sequence of (213) \u2192 (123) moves eventually terminates with some T \u2032 \u2208\nSY (213). Similarly, a sequence of (123) \u2192 (213) moves terminates with some T \u2032\u2032 \u2208 SY (123).\nConjecture 1. Starting with a transversal T \u2208 SY , all sequences of (213) \u2192 (123) moves\nterminate in the same transversal T \u2032 \u2208 SY (213).\nThe conjecture, if proven, would give a well-defined map SY \u2192 SY (213), which could be\nrestricted to a map \u03be : SY (123) \u2192 SY (213). To show then that \u03be is surjective, we would\nstart with any T \u2032 \u2208 SY (213) and apply any sequence of (123) \u2192 (213) moves on T \u2032 until it\nterminates with some T \u2208 SY (123). Reversing the sequence of moves would yield a sequence\nof (213) \u2192 (123) moves on T that terminates in T \u2032 . The definition of \u03be would then give\n\u03be(T ) = T \u2032 and hence \u03be would be surjective, from where |SY (123)| \u2265 |SY (213)|.\nIn the next Subsection 6.4 we proceed in a different way by defining a section of the\nconjectured map \u03be, i.e. a map \u03c8 : SY (213) \u2192 SY (123) such that \u03be \u25e6 \u03c8 = idSY (213) . As\nopposed to \u03be, the map \u03c8 will be given by a specific sequence of (123) \u2192 (213) moves which\ncan be retraced back. The latter will then readily imply |SY (213)| \u2264 |SY (123)|.\nAnalogously to the first and second subsequences of T \u2208 SY in Definition 12, in working\nwith (123)-avoidance we will need the following terminology.\nDefinition 19. Let T \u2208 SY . The primary subsequence \u1e6a of T consists of all elements which\nare not (12)-dominated in T . The secondary subsequence T\u0308 of T consists of all elements of\nT which are (12)-dominated by something in \u1e6a and by nothing in T \\\u1e6a .\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n25\n\nIn particular, if T \u2208 SY (123) where Y is a square, then T is the disjoint union of its two\ndecreasing subsequences \u1e6a and T\u0308 : T = \u1e6a \u2294 T\u0308 .\n6.4. Definition of \u03c8 : SY (213) \u2192 SY (123). We define \u03c8 by induction on the size of Y .\nWhen Y is a single cell, \u03c8 is the identity map. Suppose we have defined \u03c8 for all Young\ndiagrams of size < n. Fix a Young diagram Y of size n \u2265 2 and T \u2208 SY (213). Throughout\nthis subsection, we shall refer to the element in the bottom row of Y as ~ and denote by\nY/~ the reduction along it. There are two cases to discuss, depending on whether T is\n(213)-decomposable or not.\n\nB\n\n\u03c8(B+C)\n\nB+C\n\nC\n\nB\u0303\n\nC\u0303\n\n\u03c8\nA\n\n\u03c8(A)\n\nA\n\n\u03c8(A)\n\n~\n\nFigure 21. \u03c8(A \u2297 (B + C)) = \u03c8(A) \u2297 \u03c8(B + C) = \u03c8(A) \u2297 (B\u0303 + C\u0303)\n\n6.4.1. Case 1. T has a non-trivial (213)-decomposition; so consider its minimal (213)decomposition T = T |A~ \u2297 (T |BL~ + T |BR~ ), denoted for simplicity as T = A \u2297 (B + C).\nSince both A~ and B~ are of sizes < n, \u03c8(A) and \u03c8(B + C) are well-defined by induction.\nWe can further split \u03c8(B + C) = B\u0303 + C\u0303 where B\u0303 = \u03c8(B + C)|BL~ and C\u0303 = \u03c8(B + C)|BR~\noccupy respectively the same columns as the original B and C. We define \u03c8(T ) to be the\n(213)-decomposable transversal of Y given by \u03c8(T ) = \u03c8(A) \u2297 (B\u0303 + C\u0303). For example, the\nfirst arrow in Figure 21 signifies the (213)-decomposition Y213 (~) which combines subboards\nB and C; the second arrow applies \u03c8 to each of A and B + C, and the third arrow splits\n\u03c8(B + C) as B\u0303 and C\u0303 back into the original Young diagram Y .\n6.4.2. Case 2. T is (213)-indecomposable. As remarked earlier, this can happen only if ~\nis in the bottom left corner cell of Y and Y has no 0-critical points. Consider the reduction\nY/~, and let D = T |Y/~ be its transversal obtained from T by removing ~. Y/~ breaks up\ninto two parts: the rectangle (Y/~)\u2032 which lies over the bottom row of Y , and the remaining\nsubboard (Y/~)\u2032\u2032 (cf. Fig. 22a.) We define \u03c8(T ) in two steps: T \u2192 T1 \u2192 \u03c8(T ).\n\u1e0a\u2032 D\u0308\u2032\n\nJk D\u0308\u2032\n\nD\u2032\n(Y/~ )\u2032\n\nD\u2032\u2032\n\nD\u2032\u2032\n\n(Y/~ )\u2032\u2032\nD\n\n\u03c8|(Y/~ )\u2032\n\n\u03c8(D)\n\n\u03b7\n\nM\n\n~\n\n~\n\n~\n\nFigure 22. Definition of \u03c8 in Case 2: T \u2192 T1 \u2192 \u03c8(T ) = \u03b7(T1 )\nSince Y/~ is of size n \u2212 1 and D \u2208 SY/~ (213), by induction \u03c8(D) is defined as an element\nof SY/~ (123). Let T1 be the transversal of Y obtained from \u03c8(D) by prepending ~ in its\nbottom left corner; symbolically, T1 = ~[\u03c8(D)] (cf. Fig. 22b.)\n\n\f26\n\nZVEZDELINA STANKOVA\n\nThe partition Y/~ = (Y/~)\u2032 +(Y/~)\u2032\u2032 induces a partition of the transversal \u03c8(D) = D \u2032 +D \u2032\u2032 .\nSince D \u2032 is a (123)-avoiding partial transversal of the rectangle (Y/~)\u2032 , then D \u2032 splits into its\nprimary \u1e0a \u2032 and secondary D\u0308 \u2032 decreasing subsequences, as in Fig. 22b. Let M be the (square)\nsubmatrix of Y induced by ~ and D\u0308 \u2032 , and let T1 |M = ~[D\u0308 \u2032 ] be M's transversal induced by\nT1 . For instance, Figure 22b shows T1 |M = (1432) and depicts M \u223c\n= M4 via dotted lines.\n\u2032\n\u223c\nIf k \u2212 1 is the length of D\u0308 (k \u2265 1), then M = Mk and T1 |M \u2248 (1, k, k \u2212 1, . . . , 3, 2). Let\n\u03b7(T1 ) be the transversal of Y obtained from T1 by replacing T1 |M 7\u2192 Jk (cf. Fig. 22c.)\nSet \u03c8(T ) := \u03b7(T1 ) as the desired transversal in SY , and define the map \u03c8 : SY (213) \u2192 SY\nas the composition \u03c8 = \u03b7 \u25e6 (~[\u03c8|Y /~ ]).\n6.5. Properties of \u03c8 : SY (213) \u2192 SY (123).\nProposition 7. For any Y the map \u03c8 : SY (213) \u2192 SY satisfies:\n(1) \u03c8 is a sequence of (123) \u2192 (213) moves;\n(2) \u03c8 maps to SY (213);\n(3) \u03c8 is injective.\nA key idea in the proof of Proposition 7 is the following lemma:\nLemma 17. Given T \u2208 SY , all (213) \u2192 (123) and (123) \u2192 (213) moves on T respect\nany (213)-decomposition of T . Consequently, a sequence of such moves preserves (213)decomposability and (213)-indecomposability of transversals.\nProof: Suppose T \u2208 SY has a (213)-decomposition T = A \u2297 (B + C). The proof of\nProposition 6 implies that a (213)-pattern inside Y can involve elements only inside A or\nonly inside B + C. Thus, a (213) \u2192 (123) move occurs entirely in A or in B + C, and hence\nit respects any (213)-decomposition of T . Using the proof of Lemma 16, the same reasoning\nshows that (123) \u2192 (213) moves also respect any (213)-decomposition of T .\nIt remains to prove that the two types of moves map indecomposable to indecomposable\ntransversals. To the contrary, if, say, a (123) \u2192 (213) move maps an indecomposable T to\na decomposable T \u2032 , then the reverse (213) \u2192 (123) move would map T \u2032 \u2192 T and hence\nviolate the preservation of (213)-decompositions proved above. Thus, the two types of\nmoves preserve (213)-indecomposability too.\n\u0003\nThe properties of \u03c8 claimed in Proposition 7 are trivial for size 1 Young diagrams. In\nthe proof of Proposition 7, we assume by induction that the map \u03c8 satisfies the three\nrequired properties on all Young diagrams of size smaller than n, and we fix a transversal\nT \u2208 SY (213) for some Y of size n.\n6.5.1. Proof of Proposition 7, Part (1): Suppose T has a non-trivial (213)-decomposition,\nso take the minimal such decomposition T = A\u2297 (B + C). This is Case 1 of \u03c8's definition \u03c8,\nwhere \u03c8 consists of a move inside A and a move inside B +C. Hence \u03c8 respects this minimal\n(213)-decomposition. By induction, \u03c8(A) and \u03c8(B + C) are each obtained (independently)\nby (123) \u2192 (213) moves. Consequently, \u03c8(T ) is obtained by the composition of all of these\nSuppose\nnow\nthat T is (213)-indecomposable. This is Case 2 of \u03c8's definition. By\n(123)\n\u2192 (213)\nmoves.\ninduction on D's size, \u03c8(D) and therefore T1 are obtained by (123) \u2192 (213) moves inside\nD. It remains to show that \u03c8(T1 |M ) = Jk can be obtained from T1 |M via such moves\ntoo. Recall that each \u03b2 \u2208 D\u0308 \u2032 is (12)-dominated in the rectangle (Y/~)\u2032 by some \u03b1 \u2208 \u1e0a \u2032 .\nThus, as long as ~ is before \u03b2 (~ still in the bottom row of Y ), then (~\u03b2\u03b1) is a (123)pattern inside (Y/~)\u2032 , and hence in Y . So the move (~\u03b2\u03b1) 7\u2192 (\u03b2~\u03b1) is a (123) \u2192 (213)\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\nD\u0308\u2032\n\n\u03b11\n\u03b21\n\n\u03b21\n\n\u03b21\n\n\u03b21\n\n\u03b12\n\n\u03b12\n\n\u03b12\n\n\u03b12\n\n27\n\n\u1e0a\u2032\n\n\u03b11\n\n\u03b11\n\n\u03b11\n\nJk\n\n\u1e0a\u2032\n\n\u1e0a\u2032\n\n\u1e0a\u2032\n\n(Y/~ )\u2032\nR=\n\n\u03b23\n\n\u03b23\n\n\u03b23\n~\n\n\u03b22\n\n\u03b22\n\n\u03b22\n\n\u03b22\n\n~\n\n~\n\n\u03b23\n~\n\nFigure 23. (~, \u03b21 , \u03b22 , \u03b23 ) \u2192 (\u03b21 , ~, \u03b22 , \u03b23 ) \u2192 (\u03b21 , \u03b22 , ~, \u03b23 ) \u2192 (\u03b21 , \u03b22 , \u03b23 , ~) in R\nmove which leaves ~ still in the bottom row of Y . Let D\u0308 \u2032 = (\u03b21 , \u03b22 , ..., \u03b2k\u22121 ) \u0581. Then\n(~, \u03b21 , \u03b22 , ..., \u03b2k\u22121 ) \u2248 (1, k, k \u2212 1, ..., 3, 2). Using the above reasoning, we can switch ~\nconsecutively with each of the \u03b2i 's via some (123) \u2192 (213) move. For example, Figure 23\ndepicts this situation in the rectangular part R = ~[(Y/~)\u2032 ] of Y projecting onto Y 's bottom\nrow, where each (123) \u2192 (213) move is marked with a dotted line. Hence, the sequence\n(~, \u03b21 , \u03b22 , ..., \u03b2k\u22121 ) \u2192 (\u03b21 , ~, \u03b22 , ..., \u03b2k\u22121 ) \u2192 (\u03b21 , \u03b22 , ~, ..., \u03b2k\u22121 ) \u2192 * * * \u2192 (\u03b21 , \u03b22 , ..., \u03b2k\u22121 , ~)\nis a composition of (123) \u2192 (213) moves, and so is \u03c8.\n\n\u0003\n\n6.5.2. Proof of Proposition 7, Part (2): In Case 1 of \u03c8's definition, by induction \u03c8(A)\nand \u03c8(B + C) are both (123)-avoiding. Lemma 16 implies that no new (123)-pattern can\nbe introduced in the (213)-decomposition \u03c8(T ) = \u03c8(A) \u2297 (B\u0303 + C\u0303). We conclude that\n\u03c8(T ) \u2208 SY (123).\nIn Case 2 of \u03c8's definition, by induction \u03c8(D) avoids (123). The only (123)-patterns in\nY before applying \u03b7 can occur because of ~ being prepended to D's bottom left corner,\nand hence any such pattern can appear only in the rectangle R = ~[(Y/~)\u2032 ] (cf. Fig. 23.) A\n(123)-pattern in R is of the form (~\u03b2\u03b1) with \u03b1 \u2208 \u1e0a \u2032 , \u03b2 \u2208 D\u0308 \u2032 and \u03b1 (12)-dominates \u03b2 in R.\nThe map \u03b7 eliminates all these (123)-patterns by shifting D\u0308 \u2032 horizontally to the left and ~\nto the right until ~ is after all of D\u0308 \u2032 . Thus, after \u03b7 is applied, ~ cannot participate in any\nmore (123)-patterns in \u03c8(T ).\nIt remains to show that \u03b7 has not created any new (123)-patterns (\u03b1\u03b2\u03b3) which do not\ninvolve ~. Since \u03b7 preserves \u1e0a \u2032 and D \u2032\u2032 , such (123)-pattern must involve an element of\n\u03b7(D\u0308 \u2032 ); in fact, \u03b1 \u2208 \u03b7(D\u0308 \u2032 ) since the elements of \u03b7(D\u0308 \u2032 ) do not (12)-dominate anything and\nhence they can play only the role of \"1\" in a (123)-pattern. Since \u03b7(D\u0308 \u2032 )\u0581 and \u1e0a \u2032 \u0581, at\nmost one element of each can participate in this (123)-pattern. Finally, at most one element\nof D \u2032\u2032 can participate too; indeed, suppose two elements \u03b2 and \u03b3 of D \u2032\u2032 participate in the\n(123)-pattern (\u03b1\u03b2\u03b3) with \u03b1 \u2208 \u03b7(D\u0308 \u2032 ) (cf. Fig. 24a.) If \u03b11 = \u03b7 \u22121 (\u03b1), then (\u03b11 \u03b2\u03b3) would also\nbe a (123)-pattern in \u03c8(D) since \u03b11 is a horizontal shift of \u03b1 to the right but still inside\n(Y |~)\u2032 and before \u03b2, \u03b3 \u2208 (Y |~)\u2032\u2032 . This is a contradiction with the inductive assumption that\n\u03c8(D) is (123)-avoiding. We conclude that at most one element of D \u2032\u2032 can participate in the\n(123)-pattern, and therefore (\u03b1\u03b2\u03b3) is formed by \u03b1 \u2208 \u03b7(D\u0308 \u2032 ), \u03b2 \u2208 \u1e0a \u2032 , and \u03b3 \u2208 D \u2032\u2032 .\nIf \u03b11 = \u03b7 \u22121 (\u03b1) \u2208 D\u0308 \u2032 is before \u03b2, then \u03b11 is (12)-dominated by \u03b2 (cf. Fig. 24b) and so\n(\u03b11 \u03b2\u03b3) \u2248 (123) in \u03c8(D), a contradiction. If \u03b11 is after \u03b2, then \u03b11 must be (12)-dominated\nby some \u03b21 \u2208 \u1e0a \u2032 , \u03b21 6= \u03b2 (cf. Fig. 24c.) Since \u03b11 is after \u03b2, and \u03b21 is after \u03b1, then \u03b21 is\nafter \u03b2. Because \u03b2, \u03b21 \u2208 \u1e0a \u2032 \u0581, it follows that (\u03b2\u03b21 )\u0581. Further, \u03b3 \u2208 D \u2032\u2032 , hence \u03b3 comes\n\n\f28\n\nZVEZDELINA STANKOVA\n(Y/~ )\u2032\n\n(Y/~ )\u2032\u2032\n\u03b3\n\n(Y/~ )\u2032\n\n\u03b2\n\nD\u2032\u2032\n\n\u03b21\n\n\u03b11\n\n\u03b1\n\n~\n\nD\u2032\u2032\n\n\u03b7\n\n\u03b7\n\n\u03b7\n\n(Y/~ )\u2032\u2032\n\u03b3\n\n\u03b2\n\n\u03b2\nD\u2032\u2032\n\n\u03b1\n\n(Y/~ )\u2032\n\n(Y/~ )\u2032\u2032\n\u03b3\n\n\u03b11\n\n\u03b1\n\n\u03b11\n\n~\n\n~\n\nFigure 24. \u03c8 : SY (213) \u2192\u2208 SY (123)\nafter both \u03b2 and \u03b21 . Finally, \u03b21 < \u03b2 < \u03b3 implies that (\u03b11 \u03b21 \u03b3)\u0580 is a (123)-subpattern of\n\u03c8(D) landing in Y : indeed, the intersection of \u03b3's column and \u03b11 's row is the same as the\nintersection of \u03b3's column and \u03b1's row, and the latter is inside Y by the assumption that\n(\u03b1\u03b2\u03b3) is a (123)-pattern in Y . The existence of such (\u03b11 \u03b21 \u03b3) contradicts (123)-avoidance\nof \u03c8(D).\nTherefore, \u03b7 gets rid of all (123)-patterns involving ~ and does not introduce any new\n(123)-patterns, so that \u03b7(T1 ) is (123)-avoiding and \u03c8(T ) \u2208 SY (123).\n\u0003\n6.5.3. Proof of Proposition 7, Part (3): Let T2 \u2208 \u03c8(SY (213)) \u2282 SY (123) for some Young\ndiagram Y of size n, and let T \u2208 SY (213) be any preimage of T2 , i.e. \u03c8(T ) = T2 . We will\nshow that T can be recovered uniquely from T2 .\nCase 1. Suppose that T2 is (213)-decomposable, and let T2 = \u00c3\u2297 (B\u0303 + C\u0303) be T2 's minimal\n\u03c8\n\n(213)-decomposition. By Property 1 of \u03c8, T 7\u2192 T2 is a sequence of (123) \u2192 (213) moves;\ninverting each of these moves, we obtain a sequence of (213) \u2192 (123) moves that takes\nT2 7\u2192 T . By Lemma 17, T respects the (213)-decomposition of T2 ; moreover, the induced\n(213)-decomposition T = A \u2297 (B + C) is also minimal, i.e. ~ \u2208 T is in the bottom left\ncorner of A (cf. Fig. 21.) Thus, \u03c8(A \u2297 (B + C)) = \u00c3 \u2297 (B\u0303 + C\u0303) where \u03c8(A) = \u00c3 and\n\u03c8(B + C) = B\u0303 + C\u0303 by the \u03c8's definition in Case 1. By induction, \u03c8 is injective on smaller\nsize Young diagrams, so that A and B + C can be recovered from \u00c3 and B\u0303 + C\u0303. Finally,\nsince the decomposition of T is determined by T2 , B and C themselves can be recovered\nuniquely from B + C. We conclude that T can be recovered uniquely from T2 .\nCase 2. Suppose that T2 is (213)-indecomposable. As in Case 1, \u03c8 must have preserved\nthis property, i.e. T is also (213)-indecomposable. Since T \u2208 SY (213), this implies that ~\nin T is in the bottom left corner of Y . By \u03c8's definition in Case 2, there is an intermediate\nT1 = ~[\u03c8(D)] such that \u03c8(T ) = \u03b7(T1 ) = T2 (cf. Fig. 22.) We will first show that T1 is\nrecoverable from T2 .\nIn T2 we can uniquely determine D \u2032\u2032 as the subtransversal in the part of Y that does not\nproject on the bottom row of Y . The remainder D\u0303 of T2 projects onto the bottom row of Y\nand lies in the rectangle R. Since T2 avoids (123), D\u0303 splits into its primary and secondary\nsubsequences, D\u03031 and D\u03032 , respectively. Note that ~ in D\u0303 is (12)-dominated: being in the\nbottom row of R, the only way for ~ not to be (12)-dominated is to be in the rightmost\n(bottom) cell of R; but then T2 would be decomposable, contradicting our assumption in\nthis case. Thus, ~ \u2208 D\u03032 .\nNow consider T1 . By \u03b7's definition in Case 2, T1 = ~[D\u0308 \u2032 + \u1e0a \u2032 + D \u2032\u2032 ], where \u03b7 fixes \u1e0a \u2032\nand D \u2032\u2032 , slides D\u0308 \u2032 to the left, and slides ~ to the right until ~ is after D\u0308 \u2032 . Sliding D\u0308 \u2032 to\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n29\n\nthe left leaves all of its elements (12)-dominated by some elements in \u1e0a \u2032 , and as we argued\nabove, it makes \u03b7(~) also (12)-dominated in T2 . In other words, \u03b7(\u1e0a \u2032 ) = \u1e0a \u2032 = D\u03031 and\n\u03b7(~[D\u0308 \u2032 ]) = D\u03032 . Thus, to recover T1 from T , we keep D \u2032\u2032 and D\u03031 , and switch horizontally\nthe places of D\u03032 \\~ and ~. Note that at this point ~ \u2208 T1 must be in the bottom left corner\nof Y by \u03c8's definition in Case 2.\nTo recover T from T1 , note that by induction \u03c8 is injective on Y/~, so that \u03c8(D) in T1\ncould have come only from one transversal D; appending ~ at the bottom left corner of D\ngives the unique preimage T = ~[D] \u2208 SY (213).\n\u0003\n6.6. Conclusions. Subsubsections 6.5.1-3 complete inductively the proof of Proposition 7.\nThe latter implies that \u03c8 : SY (213) \u0592\u2192 SY (123) is injective for all Young diagrams Y . Thus,\n|SY (213)| \u2264 |SY (123)| and Theorem 1 is proven.\n\u0003\nWe leave the following questions to the reader for further study. For which pairs of\npermutations \u03c3 and \u03c4 in Sk can a map \u03c8Y : SY (\u03c3) \u2192 SY (\u03c4 ) be well-defined via \u03c3 \u2192 \u03c4\nmoves? What properties does \u03c8 possess in such cases?\n7. Strict Inequalities |SY (213)| < |SY (123)|\nBelow we refer to the notation from the definition of the map \u03c8 : SY (213) \u0592\u2192 SY (123) in\nSection 6; in particular, \u03c8(T ) = \u03b7(T1 ) = T2 for any (213)-indecomposable T \u2208 SY (213).\nLemma 18. If Y has an i-critical point with i \u2265 2 and no 0- and 1-critical points, some\n(213)-indecomposable T2 \u2208 SY (123) is not invertible under \u03b7 and hence under \u03c8.\nProof: Since i \u2265 2, the size of Y is n \u2265 4. Place \u03b1 in position (2, 1), ~ in (n, 2) and \u03b2 in\n(1, n), and set Y = Y /{\u03b1, ~, \u03b2}. The hypotheses on Y imply that Y is non-empty and has\nno 0-critical points. Since (12) \u223cs (21) and since there is obviously exactly 1 transversal of\nY that avoids (21) (namely, the diagonal transversal), there is also exactly 1 transversal T\nof Y that avoids (12) (cf. Fig. 25a.) Thus, T2 = {\u03b1, ~, T , \u03b2} is a transversal of Y . We claim\nthat T2 \u2208 SY (123)\\\u03c8(SY (213)).\n\u03b2\n\n\u03b1\n\n\u03b2\n\u03b1\n\nT\u0304 on \u0232\n\nR\n~\n\n~\n\nFigure 25. T2 \u2208 SY (123)\\\u03c8(SY (213))\nTo show that T2 avoids (123), note that the position of \u03b1 in Y precludes it from participating in any such pattern. Moreover, ~ and \u03b2 cannot simultaneously participate in a\n(123)-pattern since \u03b2's column and ~'s row do not intersect inside the non-square Y . Yet,\nat most 1 element from T can participate in a (123)-pattern due to the (12)-avoidance of\nT . This does not leave enough elements of T2 to participate in a (123)-pattern in Y .\nNext, in any (213)-decomposition of T2 = A \u2297 (B + C), A contains ~ and hence the\n1-diagonal d1 (Y ), which starts from ~ (cf. Fig. 25b.) The hypotheses on Y and the position\nof ~ imply that d1 (Y ) does not intersect the border of Y until goes through the rightmost\n\n\f30\n\nZVEZDELINA STANKOVA\n\ncolumn of Y and stops underneath \u03b2's cell. This forces the subtransversal A to involve the\nsecond row of Y and hence to contain \u03b1, as well as the rightmost column of Y and hence\nto contain \u03b2, i.e. A = T2 and the (213)-decomposition of T2 is trivial. Therefore, T2 is\n(213)-indecomposable.\nFrom Lemma 17, if a preimage T \u2208 SY (213) of T2 existed under \u03c8, then T would also be\n\u03c8\n\n\u03b7\n\n(213)-indecomposable and by Case 2 of \u03c8's definition: T \u2192 T1 \u2192 T2 . In particular, T and\nT1 would have ~ is their bottom left corners. But \u03b1 \u2208 T2 is (12)-dominated only by \u03b2, and\n\u03b2 does not project on the bottom row of Y , hence \u03b1 is not (12)-dominated in the rectangle\nR, hence \u03b1 \u2208 \u1e0a \u2032 (cf. Fig. 23.) Since \u03b7 fixes \u1e0a \u2032 , inverting \u03b7 would leave \u03b1 fixed in the first\ncolumn of T1 . This precludes ~ from occupying the bottom left corner in T1 , a contradiction.\nWe conclude that T2 is not invertible under \u03b7 and \u03c8, and hence T2 6\u2208 \u03c8(SY (213)).\n\u0003\nProposition 8. |SY (213)| < |SY (123)| if and only if Y has an i-critical point with i \u2265 2.\nProof: As in the proof of Proposition 5, for any permutation \u03c3 we can split Y and its\ntransversals with respect to any 0- and 1-critical points:\n|SY (\u03c3)| = |SU1 (\u03c3)| * |SU2 (\u03c3)| * * * |SUk (\u03c3)|,\n\nwhere each Uj is either square or contains only i-critical points with i \u2265 2. If the original Y\ncontains only 0- or 1-critical points, then all Uj 's are square with |SUj (213)| = |SUj (123)|,\nso that |SY (213)| = |SY (123)|.\nIf Y does contain some high i-critical points with i \u2265 2, in addition to the square Uj 's,\nthere will be at least one other Um with such a high critical point. Lemma 18 implies\nstrict inequalities for all non-square Uj 's in our decomposition. In particular, |SUm (213)| <\n|SUm (123)| and therefore |SY (213)| < |SY (123)|.\n\u0003\nThis completes the proof of Theorem 2.\n\n\u0003\n\n8. Strict Wilf-ordering for (213|\u03c4 ), (123|\u03c4 ) and (312|\u03c4 )\nSubsection 2.6 gives a strategy for proving that for any permutation \u03c4 :\n|Sn (213|\u03c4 )| \b |Sn (123|\u03c4 )| \b |Sn (312|\u03c4 )| for n \u226b 1.\n\nSince each Young diagram Ym has an (m\u22122)-critical point, Theorem 2 implies |SYm (213)| \b\n|SYm (123)| \b |SYm (312)| for m \u2265 5. This fulfills the first step (SF1) of the strategy. The\nother step (SF2) is provided by the following construction.\nLemma 19. Given a permutation \u03c4 \u2208 Sk , for any n \u2265 2k + 2 there is a partial transversal\nTn of Mn which saturates Yn\u22122k with respect to \u03c4 .\nProof: Take two copies \u03c41 and \u03c42 of \u03c4 and arrange them in a southwest/northeast diagonal\nfashion within a square matrix M2k (cf. Fig. 26a.) Insert a row and column through the\nmiddle of M2k so that the resulting M \u223c\n= M2k+1 has an empty separating row and column\nbetween \u03c41 and \u03c42 . Place M in the bottom right corner of Mn for n \u2265 2k + 2 (cf. Fig. 26b.)\nWe claim that the partial transversal Tn of Mn produced by the two copies \u03c41 and \u03c42 in M\nsaturates Yn\u22122k with respect to \u03c4 .\nSaturation-of-Yn.{ps,eps} not found (or no BBox)\n\nFigure 26. Tn = \u03c41 \u2295 \u03c42 saturates W = Yn\u22122k with respect to \u03c4\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n31\n\nTo see this, denote by w1 and w2 the cells of Y diagonally to the left and above the k \u00d7 k\nmatrices of \u03c41 and \u03c42 . Then w1 and w2 are white cells with respect to \u03c4 and the partial\ntransversal Tn . The existence of w1 and w2 gives n \u2265 2k + 2. If c is the central cell of\nM, then the initial white subboard W \u2032 is of the union Yw1 \u222a Yw2 of two rectangles, plus\npossibly some more white cells within the rectangle Mc\u0304 (these cells are depicted by \"?\" in\nFig. 26b-c). However, the reduction of W \u2032 along \u03c41 \u222a \u03c42 deletes all cells in Mc\u0304 , and the\nconsequent removal of the (blue) central row and column of M leaves the white diagram\nW = Yn\u22122k (cf. Fig. 26d). By definition, Tn saturates Yn\u22122k with respect to \u03c4 in Mn . \u0003\nWhen n \u2265 2k + 5, then the saturated Yn\u22122k satisfies (SF1). Combining with (SF2),\n\n|SYn\u22122k (213)|*|S\u0304Mn \\Yn\u22122k (\u03c4 )| \b |SYn\u22122k (123)|*|S\u0304Mn \\Yn\u22122k (\u03c4 )| \b |SYn\u22122k (312)|*|S\u0304Mn \\Yn\u22122k (\u03c4 )|\n\u21d2 |Sn (213|\u03c4 )| \b |Sn (123|\u03c4 )| \b |Sn (312|\u03c4 )| for n \u2265 2k + 5.\nThis completes the proof of Corollary 1.\n\nW\u2032\n\nW = Y4\n\nW\u2032\n\n\u0003\n\nW1\n\nFigure 27. T \u2032 saturates W = Y4 with respect to \u03c4 = (1)\nExample 3. As an illustration of the above inequalities, let \u03c4 = (1) and consider (213|1) \u0016\n(123|1) \u0016 (312|1). When n = 6, 7:\n(7)\n(8)\n\n|S6 (3241)| = 512 < |S6 (2341)| = |S6 (4231)| = 513,\n|S7 (3241)| = 2740 < |S7 (2341)| = 2761 < |S7 (4231)| = 2762.\n\nLet T \u2032 be a partial transversal of M6 that saturates a W \u2282 M6 with respect to \u03c4 = (1).\nThen |W | \u2264 5 with |W | = 5 if and only if T \u2032 consists of a single element in the bottom\nright corner of M6 ; in such a case W = M5 . Thus, |SW (213)| = |SW (123)| = |SW (312)|\nfor all W \u2282 M6 except W = Y4 , where the 2-critical point of Y4 implies the inequality\n|SY4 (213)| = 12 < |SY4 (123)| = |SY4 (312)| = 13. On the other hand, it is easy to verify that\nthe only T \u2032 that saturates Y4 in M6 consists of two elements placed in positions (4, 6) and\n(6, 4) (cf. Fig. 27a-b.) Thus, the Splitting Formulas for S6 (3241), S6 (2341) and S6 (4231)\nhave all but one equal summands:\n12 * 1 = |SY4 (213)| * |S| \b |SY4 (123)| * |S| = SY4 (312)| * |S| = 13 * 1,\n\nwhere S = S\u0304M6 \\Y4 (1). This explains the difference of 1 between the quantities in (7).\nThe analogous partial transversal T \u2032\u2032 in M7 (whose two elements are placed in (5, 7) and\n(7, 5)) saturates Y5 with respect to \u03c4 = (1). The 3-critical point of Y5 implies the following\ninequalities, where S = S\u0304M7 \\Y5 (1):\n37 * 1 = |SY5 (213)| * |S| \b 41 * 1 = |SY5 (123)| * |S| \b 42 * 1 = |SY5 (312)| * |S|.\n\nThis explains the difference of 1 between |S7 (2341)| and |S7 (4231)| in (8). Further, Y5 ,\nW1 \u223c\n= Y (5, 5, 5, 4, 4), its transpose W1t = W2 \u223c\n= Y (5, 5, 5, 5, 3) and Y4 are saturated in M7\nby correspondingly 1, 1, 1, and 9 partial transversals of M7 . (W1 is depicted in Fig. 27d).\n\n\f32\n\nZVEZDELINA STANKOVA\n\nOn all other induced Young subdiagrams of M7 , (213) and (123) are equally restrictive.\nTherefore, the Splitting Formulas give the remaining difference of 21 in (8):\nX\n\u0001\n|SW (123)| \u2212 |SW (213)| * |S\u0304M7 \\W (1)|\n|S7 (2341)| \u2212 |S7 (3241)| =\nW \u2208{Y5 ,W1 ,W2 ,Y4 }\n\n= (41 \u2212 37) * 1 + (37 \u2212 33) * 1 + (37 \u2212 33) * 1 + (13 \u2212 12) * 9 = 21.\n9. Avoidance on Young Diagrams with Extreme Critical Indices\n9.1. The sets |SYn (\u03c3)| and the Catalan numbers. For Young diagrams Y with higher\ni-critical points, it is interesting to find out by how much (312) and (321) are less restrictive\nthan (321) and (213), respectively. Below we answer this for the diagram Y = Yn with\nhighest critical index i = n \u2212 2, and leave the general question to the reader.\nProposition 9. |SYn (213)| = cn \u2212 cn\u22122 for n \u2265 2.\nProof: This follows from Corollary 1 of the Row-Decomposition in Stankova-West [17].\nParaphrasing into the notation in the current paper, let a, b, c be the three bottom right\ncorner cells of Mn\u000e as in Fig. 28. Then Mn \\{b} = Yn . On the other hand, reducing Mn\nalong a gives Mn a = Mn\u22121 whose right bottom cell is c. The minimal non-trivial (213)decomposition of this Mn\u22121 is obtained with respect to c: (Mn\u22121 )213 (c) = Ac \u00d7 Bc =\n{c} \u00d7 Mn\u22122 . Thus, the row-decomposition formula for SMn (213) in [17] reads: |SMn (213)| =\n|SYn (213)|+|SAc \u00d7Bc (213)|, from where |SYn (213)| = |Sn (213)|\u2212|Sn\u22122 (213)| = cn \u2212cn\u22122 . \u0003\nBc\n\nc\na b\n\nAc \u00d7 Bc\n\nYn\n\nMn\n=\n\n+\n\nc\n\nBc\n\nFigure 28. |Sn (213)| = |SYn (213)| + |Sn\u22122 (213)|\nIn the following, we keep the notation b for the bottom right cell of Mn , which is missing\nfrom Yn . We shall enumerate SYn (321) and SYn (312) by finding out how each differs as a\nset from Sn (321) and Sn (312), respectively.\nProposition 10. |SYn (321)| = cn \u2212 1 for n \u2265 2.\n\nProof: Fix T \u2208 SYn (321). Adding the cell b to Yn induces a transversal T \u2032 on Mn , which\nalso avoids (321) on Mn . Indeed, if (\u03b1\u03b2\u03b3) were a (321)-pattern of T \u2032 in Mn , then (\u03b1\u03b2\u03b3)\nlands on \u03b3's cell d. Since d is dotted in T \u2032 on Mn , it is also dotted in T on Yn , i.e. d 6= b. But\nthen (\u03b1\u03b2\u03b3) is a (321)-pattern of T landing on d in Yn , a contradiction with T \u2208 SYn (321).\nThus, we have a natural inclusion map \u03b9 : SYn (321) \u0592\u2192 Sn (321). The reasoning above\nalso shows that the only transversals T \u2032 \u2208 Sn (321) not hit by \u03b9 are those with dotted b.\nHowever, in order to avoid (321) on Mn , a dot in b implies that the rest of T \u2032 is increasing,\nand there is only one such transversal, namely, T \u2032 = (2, 3, ..., n, 1). We conclude that\nSn (321) = \u03b9(SYn (321)) \u2294 {T \u2032 }.\n\u21d2 |SYn (321)| = |Sn (321)| \u2212 1 = cn \u2212 1 for any n \u2265 2.\n\nProposition 11. |SYn (312)| = 2cn \u2212 3cn\u22121 for n \u2265 2.\n\n\u0003\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n33\n\nProof: As indicated above, we describe how SYn (312) differs as a set from Sn (312).\nOn the one hand, Sn (312) contains transversals of Mn with a dotted b. Since b cannot\nparticipate in any (312)-pattern, we can reduce Mn along b to obtain Mn\u22121 without any\nfurther restrictions, and hence the number of transversals in question equals |Sn\u22121 (312)|.\nNone of these transversals is in SYn (312) because Yn cannot have a dot in the missing b (cf.\nFig. 29a.) Thus, |Sn (312)\\SYn (312)| = cn\u22121 .\n\nb\n\nFigure 29. Examples of the difference between Sn (312) and SYn (312)\nOn the other hand, SYn (312) contains transversals of Yn for which a (312)-subsequence\nlands outside Yn (on b). As we shall see below in Lemma 20, the number of these transversals\nis cn \u2212 2cn\u22121 , and none of them is in Sn (312) because of the (312)-pattern in Mn (cf.\nFig. 29b.) Thus, |SYn (312)\\Sn (312)| = cn \u2212 2cn\u22121 .\nAll other transversals of Sn (312) and SYn (312) are identical: they don't have an element\nin b, and they don't have a (312)-pattern landing on b (cf. Fig. 29c.) Summarizing,\n|SYn (312)| = |Sn (312)| \u2212 cn\u22121 + (cn \u2212 2cn\u22121 ) = 2cn \u2212 3cn\u22121 for any n \u2265 2.\n\n\u0003\n\nIncidentally, we have shown the strict inequality |SYn (312)| > |SYn (321)| for n \u2265 5 (proven\nin an indirect way in Example 2). Indeed, from Propositions 10-11, for n \u2265 5:\n|SYn (312)| \u2212 |SYn (321)| = (2cn \u2212 3cn\u22121 ) \u2212 (cn \u2212 1) =\n9.1.1. Claims in the Proof of Proposition 11.\n\n(n \u2212 5)n(2n \u2212 2)!\n+ 1 \u2265 1.\n(n + 1)!(n \u2212 2)!\n\nLemma 20. The number of all transversals in SYn (312) with a (312)-subsequence landing\noutside Yn (on b) is cn \u2212 2cn\u22121 .\nProof: Let T \u2208 SYn (312), and let \u03b1 and \u03b3 denote the elements of T in the bottom row\nand in the rightmost column of Yn , respectively. Because Yn misses b, \u03b1 6= \u03b3 (cf. Fig. 30a).\nSuppose T contains a (312)-subsequence which doesn't land in Yn , hence lands on b. Thus,\nfor some \u03b2 \u2208 T , (\u03b2\u03b1\u03b3) \u2248 (312). Since \u03b2 is before \u03b1 and above \u03b3, without loss of generality,\nwe can replace \u03b2 by the largest element of T before \u03b1; symbolically, \u03b2 := max{t \u2208 T\u1fb1 }.\nSymmetrically, let \u03b4 be the leftmost element of T higher than \u03b3. It is possible that \u03b4 = \u03b2;\nif not, (\u03b4\u03b2\u03b1\u03b3) \u2248 (3412) is a subsequence of T not landing in Yn . Let B be the rectangle\nin Yn defined by \u03b2's and \u03b3's rows, and \u03b4's and \u03b1's columns such that B includes \u03b2 and \u03b4,\nbut excludes \u03b1 and \u03b3. Let A be the rectangle below and to the left of B, excluding \u03b1's and\n\u03b3's rows; and symmetrically, let C be the rectangle to the right and above B, excluding \u03b1's\nand \u03b3's columns.\nClaim 3. Except for \u03b1 and \u03b3, the transversal T is concentrated in rectangles A, B and C.\nProof: Yn splits as a disjoint union of 9 rectangles, plus \u03b1's and \u03b3's rows and columns.\nFigure 30a depicts all these rectangles. The definitions of \u03b2 and \u03b4 imply that rectangles D4 ,\nD5 and D6 are empty. In order for the pair (\u03b2\u03b1) not to be completed to a (312)-pattern\nin Yn , rectangles D1 and D2 must also be empty. Symmetrically, in order for the pair (\u03b4\u03b3)\n\n\f34\n\nZVEZDELINA STANKOVA\nD5\n\nD4\n\nC\n\nT |C\n\n\u03b2\nD6\n\nD2\n\nB\n\nT |B\n\n\u03b4\n\n\u03b3\n\n\u03b3\nA\n\nT |A\n\nD1\n\nD3\n\n\u03b1\n\n\u03b1\nb\n\nFigure 30. Splitting of T \u2208 SYn (312)\n\nnot to be completed to a (312)-pattern in Yn , rectangles D3 and D1 must be empty. Thus,\nT \\{\u03b1, \u03b3} is concentrated in A, B and C.\n\u0003\nWe conclude that T induces transversals on the rectangles A, B and C, and since the\nlatter are disjoint, they must be squares. Thus, T splits into an increasing sequence of 3\nindependent subtransversal T |A , T |B and T |C , with \u03b1 inserted in the bottom row of Yn so\nthat its column is between B and C, and \u03b3 is inserted in the rightmost column of Yn so that\nits row is between A and B. Finally, the assumption that T contains a (312)-subsequence\nnot landing inside Yn was translated above in the existence \u03b2 \u2208 B, i.e. the square B is of\nsize at least 1. Conversely,\nClaim 4. If T is a transversal of Yn satisfying the above description (depicted also in\nFig. 30b), and such that the 3 subtransversals T |A , T |B and T |C each avoid (312) on the\nrespective squares A, B and C, then the whole transversal T avoids (312) on Yn , and has a\n(312)-subsequence not landing in Yn .\n\u000e\nProof: Consider the reduction Yn {\u03b1,\u03b3} = Mn\u22122 , along whose diagonal the squares A, B\nand C are arranged (in increasing order). It is evident that there can be no (312)-pattern in\nMn\u22122 containing elements from different squares. Since T |A , T |B and T |C each avoid (312),\nany (312)-pattern in T on Yn must contain \u03b1 and/or \u03b3. But \u03b1 and \u03b3 cannot participate\nsimultaneously in any pattern landing inside Yn because of the missing cell b. Hence, only\none of \u03b1 and \u03b3 can participate in a (312)-pattern in Yn .\nSince \u03b1 can play only the role of \"1\", it can participate only in a (312)-pattern of the\nform (\u03be\u03b1\u03bd), where (\u03be\u03bd) \u0581, \u03be is before \u03b1 and \u03bd is after \u03b1. Yet, this arrangement is not\npossible since everything before \u03b1 is smaller than everything after \u03b1: A \u2295 B < C, with the\nexception of \u03b3, so no such pattern is possible. \"Transposing\" this argument, one concludes\nthat \u03b3 cannot participate in a (312)-pattern in Yn either.\nTherefore, T \u2208 SYn (312). Finally, since B is of size at least 1, let \u03b2 \u2208 T |B . Then\n(\u03b2\u03b1\u03b3) \u2248 (312) landing on b.\n\u0003\nClaims 3-4 establish a 1-1 correspondence between the transversals T \u2208 SYn (312) that do\nnot induce transversals in Sn (312) due to their (312)-subsequence landing on b, and the diagrams in Figure 30b. Therefore, each element of SYn (312)\\Sn (312) is uniquely determined\nby the size of the squares A, B and C, and the choice of (312)-avoiding transversals T |A , T |B\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n35\n\nand T |C . Below, the sum of sizes |A| + |B| + |C| = n \u2212 2 accounts for \u03b1, \u03b3 6\u2208 A \u222a B \u222a C.\nG\nSA (312) \u00d7 SB (312) \u00d7 SC (312)\nSYn (312)\\Sn (312) \u223c\n=\n|A|+|B|+|C| = n\u22122\n|B| \u2265 1\n\n\u21d2 |SYn (312)\\Sn (312)| =\n\nX\n\nci cj ck = cn \u2212 2cn\u22121 .\n\ni+j +k = n\u22122\nj\u22651\n\nThe last equality was obtained using the well-known relation ck =\nCatalan numbers. This completes the proof of Lemma 20.\n\nP\n\nl+m=k\u22121 cl cm\n\nfor the\n\u0003\n\n9.2. The sets |SSt3n (\u03c4 )| and the Fibonacci Numbers. In this subsection, we consider\nthe other extreme situation of a non-decomposable Young diagram Y : having lowest critical\nindices i = 2. This is Y = St3n for n \u2265 4, which is the smallest non-decomposable Young\ndiagram of size n. The last description is also satisfied by the squares Mn with n \u2264 3, and\nwe set St3n := Mn for n \u2264 3. This new notation and Theorem 2 imply that (123) and (312)\nare equinumerant on St3n for all n \u2265 1, so that we can state the following\nProposition 12. |SSt3n (213)| = 2n\u22123 (n + 2) for n \u2265 2 and\n\n\u0001\n1\n|SSt3n (123)| = |SSt3n (312)| = f2n\u22121 = \u221a \u03c8 2n\u22121 \u2212 \u03c8 \u2212(2n\u22121) for n \u2265 1,\n5\n\u221a\nwhere fn is the n-th Fibonacci number (f1 = f2 = 1) and \u03c8 = (1 + 5)/2.\n\nProof: Let an = |SSt3n (213)|. From the row-decomposition formula in [17] on St3n :\n|SSt3n (213)| = 2 |SSt3n\u22121 (213)| + |SSt2n\u22122 (213)| (cf. Fig. 31).\n\n= 2\n\n+\n\na b c\n\nFigure 31. Row-decomposition of SSt3n (213)\nSince St2n\u22122 1-decomposes as a product of (n \u2212 3) squares M2 (cf. Fig. 31d), we have\n|SSt2n\u22122 (213)| = 2n\u22123 . Thus, an = 2an\u22121 + 2n\u22123 , i.e. an = 2n\u22123 (n + 2) for n \u2265 2.\nConsider now bn = |SSt3n (312)|. Let a, b and c be the bottom cells of St3n , as in Fig. 32a.\nPlacing 1 in a or c does not affect the (312)-avoidance in the reduction St3n /{u} \u223c\n= St3n\u22121\nfor u = a or c (cf. Fig. 32b), and thus yields overall 2bn\u22121 transversals. However, placing\n1 in b forces the elements in the first two columns of the reduction St3n /{b} \u223c\n= St3n\u22121 to\nform an increasing sequence (depicted by \u0580 above cell d in Fig. 32c.) In accordance with\nprevious notation, we denote the number of such (312)-avoiding transversals of St3n\u22121 by\n\u0580\nb\u0580\nn\u22121 . Therefore, bn = 2bn\u22121 + bn\u22121 .\nTo calculate b\u0580\nn\u22121 , note that 1 can be placed only in the first cell d or in the third cell e\nof the bottom row of St3n\u22121 . The first case does not cause any restrictions on the reduction\n\n\f36\n\nZVEZDELINA STANKOVA\n\n=2\n\n+\nd\n\ne\n\na b c\n\n+\n\nFigure 32. Row-decomposition of |SSt3n (312)|\nSt3n\u22121 /{d} \u223c\n= St3n\u22122 (cf. Fig. 32d) and hence it produces bn\u22122 transversals. Placing 1 in e\n\u0580\n\u0580\n3\n\u223c 3\nreduces to b\u0580\nn\u22122 on Stn\u22121 /{e} = Stn\u22122 (cf. Fig. 32e). Summarizing, bn\u22121 = bn\u22122 + bn\u22122 .\nCombining the two newly derived formulas, we obtain bn = 3bn\u22121 \u2212 bn\u22122 , with b1 = 1\nand b2 = 2. It is a standard exercise to check that the odd-indexed terms in the Fibonacci\nsequence satisfy the same recursive relation, and hence the desired formula for bn involving\nthe golden ratio \u03c8 follows.\n\u0003\n9.3. Generalization\nof Stanley-Wilf limits. Recall the Stanley-Wilf limits L(\u03c4 ) =\np\nlimn\u2192\u221e n |Sn (\u03c4 )| for any \u03c4 \u2208 Sk . From works\n\u221a of2 Regev [11] and B\u00f3na [7], it follows\n2\nthat L(Jk ) = (k \u2212 1) and L(213|Jk ) = (k \u2212 1 + 8) for k \u2265 1.\nFrom the viewpoint of the current paper, Corollary 1 has established in particular the\nstrict inequalities |Sn (213|Jk )| < |Sn (123|Jk )| < |Sn (312|Jk )| for any k \u2265 1 and n \u2265 2k + 5.\nHence the Stanley-Wilf limits follow suit for k \u2265 1:\n\u221a\nL(213|Jk ) = (k \u2212 1 + 8)2 < L(123|Jk ) = L(321|Jk ) = L(Jk+3 ) = (k + 2)2 \u2264 L(312|Jk ).\nIt is still an open question whether L(312|1) < 9, and in order to complete the above picture,\nit would certainly be nice to find the exact value of L(312|Jk ). Conceivably, the Splitting\nFormula for (312|Jk ) from Subsection 2.5 and other observations in this paper might be\nhelpful towards calculating L(312|Jk ).\n\u221a\nWith the methods so far, all known L(\u03c4 ) belong to Z[ 2]. However, if we generalize the\ndefinition of Stanley-Wilf limits from the square matrices Mn to using any (proper) Young\ndiagrams Y of size n, we can obtain presumably a much greater variety of limits. To this\nn\nend, consider the set Y = \u222a\u221e\nn=0 Y of all proper Young diagrams, graded by the size n of the\n~ = {Y n } be a sequence of (proper) Young diagrams, one per each graded\ndiagrams. Let Y\n~ as a path in Y. Define the generalized Stanley-Wilf limit of\npiece of Y; we can think of Y\n~\n\u03c4 \u2208 Sk along the path Y as\np\nLY~ (\u03c4 ) = lim n |SY n (\u03c4 )|.\nn\u2192\u221e\n\n~ = {Mn } where the limits L ~ (\u03c4 ) = L(\u03c4 ) are guaranteed by StanleyExcept for the case Y\nY\nWilf Theorem, for all other paths in Y the existence of LY~ (\u03c4 ) must be verified.\nA worthwhile consequence of Proposition 12 is the following\n~ = {St3n }, L ~ (321) = L ~ (312) = \u03c8 2 =\nCorollary 2. For Y\nY\nY\n\n\u221a\n3+ 5\n2 *\n\n~ , \u03c4 ) do the limits L ~ (\u03c4 ) exist, and what\nTwo natural questions arise: for which pairs (Y\nY\nis the algebraic closure L of the set of generalized limits L = {LY~ (\u03c4 )}. As of now, we have\n\u221a \u221a\nshown that L \u2283 Q( 2, 5); but are there any other irrational or transcendental generalized\nStanley-Wilf limits LY~ (\u03c4 )? We leave these questions to the reader for further study.\n\n\fSHAPE-WILF-ORDERING ON PERMUTATIONS OF LENGTH 3\n\n37\n\nAcknowledgments\nThe author would like to thank Miklos B\u00f3na (University of Florida) for supplying a\nnumber of useful references and discussing his and related works in relation to the present\npaper; David Moews (Center for Communications Research, San Diego) for writing a computer program used in this project; and Paulo de Souza (UC Berkeley) for his help in\nimplementing the necessary computer software.\nReferences\n[1] R. Arratia, On the Stanley-Wilf Conjecture for the Number of Permutations Avoiding a Given Pattern,\nElectronic J. Combin., 6 (1999), no. 1, N1.\n[2] E. Babson, J. West, The permutations 123p4 ...pt and 321p4 ...pt are Wilf-equivalent, Graphs Comb 16\n(2000) 4, 373-380.\n[3] J. Backelin, J. West, G. Xin, Wilf-equivalence for singleton classes, Proceedings of the 13th Conference\non Formal Power Series and Algebraic Combinatorics, Tempe, AZ, 2001.\n[4] M. B\u00f3na, Permutations avoiding certain patterns. The case of length 4 and some generalizations, Disc.\nMath. 175 (1997) 55-67.\n[5] M. B\u00f3na, The Solution of a Conjecture of Wilf and Stanley for all layered patterns, J. Combinatorial\nTheory, Series A, 85 (1999) 96-104.\n[6] M. B\u00f3na, Combinatorics of Permutations, Chapman & Hall/CRC, 2004, 135-159.\n[7] M. B\u00f3na, The Limit of a Stanley-Wilf sequence is not always rational, and layered patterns beat\nmonotone patterns, J. Combin. Theory Ser. A 110 (2) (2005), 223-235.\n[8] D. Knuth, The Art of Computer Programming, Vol.3, Addison-Wesley, Reading, MA, 1973.\n[9] D. Knuth, Permutations, matrices, and generalized Young tableaux, Pacific J. of Mathematics 34\n(1970) 709-727.\n[10] A. Marcus and J. Tardos, Excluded Permutation Matrices and the Stanley-Wilf conjecture, J. Combin.\nTheory Ser. A 107 (1) (2004), 153-160.\n[11] A. Regev, Asymptotic values for degrees associated with strips of Young diagrams, Advances in Mathematics, 41 (1981), 115-136.\n[12] D. Richards, Ballot sequences and restricted permutations, Ars Combinatoria 25 (1988) 83-86.\n[13] D. Rotem, On correspondence between binary trees and a certain type of permutation, Information\nProcessing Letters 4 (1975), 58-61.\n[14] R. Simion and F. Schmidt, Restricted permutations, Europ. J. Combinatorics 6 (1985) 383-406.\n[15] Z. Stankova, Forbidden subsequences, Disc. Math. 132 (1994) 291-316.\n[16] Z. Stankova, Classification of forbidden subsequences of length 4, Europ. J. Combinatorics (1996) 17,\n501-517.\n[17] Z. Stankova and J. West, A new class of Wilf-equivalent permutations, J. Algebraic Combin., 15\n(2002), no. 3, 271-290.\n[18] J. West, Generating trees and the Catalan and Schr\u00f6der numbers, Disc. Math. 146 (1995) 247-262.\n[19] J. West, Generating trees and forbidden subsequences, Disc. Math. 157 (1996) 363-374.\nZvezdelina Stankova, Dept. of Mathematics and Computer Science, Mills College, Oakland, CA, stankova@mills.edu\n\n\f"}