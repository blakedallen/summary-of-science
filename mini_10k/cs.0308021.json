{"id": "http://arxiv.org/abs/cs/0308021v1", "guidislink": true, "updated": "2003-08-11T18:43:35Z", "updated_parsed": [2003, 8, 11, 18, 43, 35, 0, 223, 0], "published": "2003-08-11T18:43:35Z", "published_parsed": [2003, 8, 11, 18, 43, 35, 0, 223, 0], "title": "A Bernstein-Bezier Sufficient Condition for Invertibility of Polynomial\n  Mapping Functions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cs%2F0011022%2Ccs%2F0011033%2Ccs%2F0011006%2Ccs%2F0011023%2Ccs%2F0011002%2Ccs%2F0011042%2Ccs%2F0011020%2Ccs%2F0308009%2Ccs%2F0308010%2Ccs%2F0308042%2Ccs%2F0308003%2Ccs%2F0308020%2Ccs%2F0308006%2Ccs%2F0308023%2Ccs%2F0308017%2Ccs%2F0308022%2Ccs%2F0308040%2Ccs%2F0308025%2Ccs%2F0308021%2Ccs%2F0308012%2Ccs%2F0308014%2Ccs%2F0308013%2Ccs%2F0308044%2Ccs%2F0308001%2Ccs%2F0308035%2Ccs%2F0308034%2Ccs%2F0308038%2Ccs%2F0308039%2Ccs%2F0308026%2Ccs%2F0308007%2Ccs%2F0308005%2Ccs%2F0308002%2Ccs%2F0308043%2Ccs%2F0308033%2Ccs%2F0308027%2Ccs%2F0308008%2Ccs%2F0308004%2Ccs%2F0308019%2Ccs%2F0308041%2Ccs%2F0308015%2Ccs%2F0308024%2Ccs%2F0308011%2Ccs%2F0308037%2Ccs%2F0308018%2Ccs%2F0308030%2Ccs%2F0308031%2Ccs%2F0308016%2Ccs%2F0308032%2Ccs%2F0308028%2Ccs%2F0308036%2Ccs%2F0308029%2Ccs%2F0504015%2Ccs%2F0504024%2Ccs%2F0504027%2Ccs%2F0504017%2Ccs%2F0504099%2Ccs%2F0504075%2Ccs%2F0504083%2Ccs%2F0504093%2Ccs%2F0504084%2Ccs%2F0504088%2Ccs%2F0504012%2Ccs%2F0504058%2Ccs%2F0504005%2Ccs%2F0504097%2Ccs%2F0504044%2Ccs%2F0504041%2Ccs%2F0504063%2Ccs%2F0504016%2Ccs%2F0504043%2Ccs%2F0504033%2Ccs%2F0504034%2Ccs%2F0504053%2Ccs%2F0504071%2Ccs%2F0504004%2Ccs%2F0504064%2Ccs%2F0504068%2Ccs%2F0504030%2Ccs%2F0504032%2Ccs%2F0504065%2Ccs%2F0504013%2Ccs%2F0504090%2Ccs%2F0504104%2Ccs%2F0504046%2Ccs%2F0504035%2Ccs%2F0504080%2Ccs%2F0504092%2Ccs%2F0504111%2Ccs%2F0504110%2Ccs%2F0504055%2Ccs%2F0504091%2Ccs%2F0504095%2Ccs%2F0504074%2Ccs%2F0504089%2Ccs%2F0504052%2Ccs%2F0504085%2Ccs%2F0504079%2Ccs%2F0504029%2Ccs%2F0504067%2Ccs%2F0504019%2Ccs%2F0504076&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Bernstein-Bezier Sufficient Condition for Invertibility of Polynomial\n  Mapping Functions"}, "summary": "We propose a sufficient condition for invertibility of a polynomial mapping\nfunction defined on a cube or simplex. This condition is applicable to finite\nelement analysis using curved meshes. The sufficient condition is based on an\nanalysis of the Bernstein-B\\'ezier form of the columns of the derivative.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cs%2F0011022%2Ccs%2F0011033%2Ccs%2F0011006%2Ccs%2F0011023%2Ccs%2F0011002%2Ccs%2F0011042%2Ccs%2F0011020%2Ccs%2F0308009%2Ccs%2F0308010%2Ccs%2F0308042%2Ccs%2F0308003%2Ccs%2F0308020%2Ccs%2F0308006%2Ccs%2F0308023%2Ccs%2F0308017%2Ccs%2F0308022%2Ccs%2F0308040%2Ccs%2F0308025%2Ccs%2F0308021%2Ccs%2F0308012%2Ccs%2F0308014%2Ccs%2F0308013%2Ccs%2F0308044%2Ccs%2F0308001%2Ccs%2F0308035%2Ccs%2F0308034%2Ccs%2F0308038%2Ccs%2F0308039%2Ccs%2F0308026%2Ccs%2F0308007%2Ccs%2F0308005%2Ccs%2F0308002%2Ccs%2F0308043%2Ccs%2F0308033%2Ccs%2F0308027%2Ccs%2F0308008%2Ccs%2F0308004%2Ccs%2F0308019%2Ccs%2F0308041%2Ccs%2F0308015%2Ccs%2F0308024%2Ccs%2F0308011%2Ccs%2F0308037%2Ccs%2F0308018%2Ccs%2F0308030%2Ccs%2F0308031%2Ccs%2F0308016%2Ccs%2F0308032%2Ccs%2F0308028%2Ccs%2F0308036%2Ccs%2F0308029%2Ccs%2F0504015%2Ccs%2F0504024%2Ccs%2F0504027%2Ccs%2F0504017%2Ccs%2F0504099%2Ccs%2F0504075%2Ccs%2F0504083%2Ccs%2F0504093%2Ccs%2F0504084%2Ccs%2F0504088%2Ccs%2F0504012%2Ccs%2F0504058%2Ccs%2F0504005%2Ccs%2F0504097%2Ccs%2F0504044%2Ccs%2F0504041%2Ccs%2F0504063%2Ccs%2F0504016%2Ccs%2F0504043%2Ccs%2F0504033%2Ccs%2F0504034%2Ccs%2F0504053%2Ccs%2F0504071%2Ccs%2F0504004%2Ccs%2F0504064%2Ccs%2F0504068%2Ccs%2F0504030%2Ccs%2F0504032%2Ccs%2F0504065%2Ccs%2F0504013%2Ccs%2F0504090%2Ccs%2F0504104%2Ccs%2F0504046%2Ccs%2F0504035%2Ccs%2F0504080%2Ccs%2F0504092%2Ccs%2F0504111%2Ccs%2F0504110%2Ccs%2F0504055%2Ccs%2F0504091%2Ccs%2F0504095%2Ccs%2F0504074%2Ccs%2F0504089%2Ccs%2F0504052%2Ccs%2F0504085%2Ccs%2F0504079%2Ccs%2F0504029%2Ccs%2F0504067%2Ccs%2F0504019%2Ccs%2F0504076&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We propose a sufficient condition for invertibility of a polynomial mapping\nfunction defined on a cube or simplex. This condition is applicable to finite\nelement analysis using curved meshes. The sufficient condition is based on an\nanalysis of the Bernstein-B\\'ezier form of the columns of the derivative."}, "authors": ["Stephen Vavasis"], "author_detail": {"name": "Stephen Vavasis"}, "author": "Stephen Vavasis", "links": [{"href": "http://arxiv.org/abs/cs/0308021v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/cs/0308021v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cs.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cs.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.CG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "G.1.8", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/cs/0308021v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/cs/0308021v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:cs/0308021v1 [cs.NA] 11 Aug 2003\n\nA Bernstein-B\u00e9zier Sufficient Condition for\nInvertibility of Polynomial Mapping Functions\n(Draft)\nStephen A. Vavasis\u2217\nJune 29, 2018\n\nAbstract\nWe propose a sufficient condition for invertibility of a polynomial\nmapping function defined on a cube or simplex. This condition is applicable to finite element analysis using curved meshes. The sufficient\ncondition is based on an analysis of the Bernstein-B\u00e9zier form of the\ncolumns of the derivative.\n\n1\n\nInvertibility of polynomial mapping functions\n\nIn finite element analysis, it is common to subdivide the domain into elements\nthat are images of a reference domain under polynomial functions. This\napproach gives rise to the popular isoparametric elements [6]. The reference\ndomain is the unit square I 2 = {(\u03be, \u03b7) : 0 \u2264 \u03be, \u03b7 \u2264 1} or triangle \u22062 =\n{(\u03be, \u03b7) : 0 \u2264 \u03be, \u03b7; \u03be + \u03b7 \u2264 1} in R2 or the unit cube I 3 = {(\u03be, \u03b7, \u03b6) : 0 \u2264\n\u03be, \u03b7, \u03b6 \u2264 1} or tetrahedron \u22063 = {(\u03be, \u03b7, \u03b6) : 0 \u2264 \u03be, \u03b7, \u03b6; \u03be + \u03b7 + \u03b6 \u2264 1} in R3 .\nPolynomials defined on \u2206d , d = 2, 3, generally include monomial terms\nup to degree p for some p > 0. On the other hand, for the unit cube I d , the\nmonomial terms are generally up to degree p individually in each coordinate.\nTherefore, for the rest of the paper we use p to denote the maximum total\n\u2217\n\nSupported in part by NSF ITR Award number 0085969.\n\n1\n\n\fdegree of polynomials on \u22062 or \u22063 , and the maximum degree in individual\ncoordinates of polynomials defined on I 2 or I 3 .\nLet F : U \u2192 Rd be a polynomial function, where U is either I d or\n\u2206d and d is 2 or 3. Suppose F is injective on U, implying that it has an\ninverse G defined on F (U) such that G(F (u)) = u. If such a G exists\nand is smooth, then we say that F is invertible. Invertibility is important\nfor correctness of a finite element mesh. This definition of invertibility is\nsometimes called \"global invertibility\" in order to distinguish it from \"local\ninvertibility.\" The function F is locally invertible if its derivative, denoted\nas J, is nonsingular on the entire reference element U. Local invertibility\nis necessary for global invertibility but is not sufficient. A function can be\nlocally but not globally invertible if F (U) \"wraps around\" (e.g., consider\nF (r, \u03b8) = r(cos \u03b8, sin \u03b8) for (r, \u03b8) \u2208 [1, 2] \u00d7 [0, 4\u03c0]). Additional sufficient\nconditions for global invertibility in the general setting are considered by\nIvanenko [5]. Beyond local invertibility, one would also like an upper bound\non the \"condition number\"\ncond(F ) = max kJ(u)k * max kJ(u)\u22121 k\nu\u2208U\n\n(1)\n\nu\u2208U\n\nof F . Even more strongly, one would like bounds on the higher derivatives\nof F in terms of cond(F ) to satisfy the Ciarlet-Raviart [2] conditions on\nconvergence of order-p finite element approximation.\nUnfortunately, even the first problem, namely, determining nonsingularity\nof the Jacobian, is a difficult problem. We know of simple necessary and\nsufficient conditions only for the following special cases:\n1. linear polynomials, that is, p = 1, defined on \u2206d of all dimensions,\n2. quadratic polynomials on \u22062 in the case d = 2, in the special case that\nF is linear on two of the three edges of the reference triangle [6], and\n3. bilinear elements (i.e., p = 1) defined on I 2 [14].\nFor all other cases, we know of only separate necessary and sufficient\nconditions, and this paper also proposes only a sufficient condition. To our\nknowledge, the only necessary condition for the general case proposed in\nthe literature is that det(J) have the same sign (strictly positive or strictly\nnegative) at some finite list of test points. In engineering applications, it is\ncommon to test invertibility at the Gauss points used for quadrature on the\n2\n\n\felement [13]. This test is known not to be sufficient; see further remarks on\nthis point below.\nSufficient conditions have been proposed for a few settings. For example\nUshakova [15] presents a sufficient condition for the case p = 1 on domain\nI 3 . Her sufficient condition is interpreted as requiring that certain tetrahedra\nformed by choosing subsets of four of the eight vertices of F (I 3 ) have positive\nvolume. Sufficient conditions for quadratic triangles and tetrahedra have\nbeen proposed by Salem, Canann and Saigal [9, 11, 10, 12].\nIn this work, we present a sufficient condition to ensure both local and\nglobal invertibility of F for any of the four domains I d , \u2206d , d = 2, 3 and for\nany polynomial degree p. Our condition appears to be weaker (i.e., not able\nto certify invertibility in more cases) than existing sufficient tests for specific\nreference domains and values of p but is considerably more general.\nOur condition is based on writing J in Bernstein-B\u00e9zier form and then\nconsidering the convex hull of the derivatives at the control points. In the\nnext section we describe the new sufficient condition and establish that it is\nsufficient for local invertibility. In Section 3 we provide an equivalent characterization of the sufficient condition that is amenable to efficient testing. In\nSection 4 we use the equivalent characterization to prove that the condition\nalso implies global invertibility. Our condition has a desirable property that\nwe term \"affinity,\" which we define in the last section.\n\n2\n\nBernstein-B\u00e9zier form\n\nBernstein-B\u00e9zier (BB) form is a popular way to write polynomials in computeraided geometric design [4]. A univariate polynomial of degree p in BB form\nwould be written:\nF (\u03be) =\n\np\nX\n\nfi (1 \u2212 \u03be)p\u2212i\u03be i\n\ni=0\n\np!\ni!(p \u2212 i)!\n\n(2)\n\nand has natural parametric domain \u03be \u2208 [0, 1]. A bivariate polynomial with\nmaximum degree p individually in \u03be, \u03b7 is written in the form:\nF (\u03be, \u03b7) =\n\np\np X\nX\n\nfi,j (1 \u2212 \u03be)p\u2212i \u03be i (1 \u2212 \u03b7)p\u2212j \u03b7 j\n\ni=0 j=0\n\n3\n\np!p!\ni!(p \u2212 i)!j!(p \u2212 j)!\n\n(3)\n\n\fand has as its natural parametric domain (\u03be, \u03b7) \u2208 I 2 . A trivariate polynomial\nwith maximum degree p individually is written\nF (\u03be, \u03b7, \u03b6) =\n\np X\np X\np\nX\n\nfi,j,k (1\u2212\u03be)p\u2212i \u03be i (1\u2212\u03b7)p\u2212j \u03b7 j (1\u2212\u03b6)p\u2212k \u03b6 k\n\ni=0 j=0 k=0\n\np!p!p!\n,\ni!(p \u2212 i)!j!(p \u2212 j)!k!(p \u2212 k)!\n(4)\n\nand has as its natural parametric domain (\u03be, \u03b7, \u03b6) \u2208 I 3 .\nA bivariate polynomial with total degree at most p is written in the BB\nform\np\u2212i\np X\nX\np!\nfi,j \u03be i \u03b7 j (1 \u2212 \u03be \u2212 \u03b7)p\u2212i\u2212j\nF (\u03be, \u03b7) =\n(5)\ni!j!(p \u2212 i \u2212 j)!\ni=0 j=0\nand has natural parametric domain (\u03be, \u03b7) \u2208 \u22062 .\nFinally, a trivariate polynomial with total degree at most p is written in\nthe BB form\nF (\u03be, \u03b7, \u03b6) =\n\np\u2212i p\u2212i\u2212j\np X\nX\nX\n\nfi,j,k \u03be i \u03b7 j \u03b6 k (1 \u2212 \u03be \u2212 \u03b7 \u2212 \u03b6)p\u2212i\u2212j\u2212k\n\ni=0 j=0 k=0\n\np!\ni!j!k!(p \u2212 i \u2212 j \u2212 k)!\n(6)\n\nand has natural parametric domain (\u03be, \u03b7, \u03b6) \u2208 \u22063 .\nIn all five cases, the vectors fi (in 1D), fi,j \u2208 R2 (in 2D) or fi,j,k \u2208 R3 (in\n3D) are called the control points. A fundamental theorem about BB form is:\nTheorem 1 Let U be the natural parametric domain of BB form for the five\ncases listed above. Then F (U) is contained in the convex hull of the control\npoints.\nFarin [4] proves this as a consequence of the deCasteljau algorithm for\nevaluating F , but here is a sketch of a more direct proof. One observes that\non the natural parametric domain, all the factors in the summations like \u03be,\n(1 \u2212 \u03be \u2212 \u03b7), etc., are nonnegative. Furthermore, one observes that the value\nof all the sums, if the control points are excluded, is exactly 1. For example,\nconsider (2) without control points:\np\nX\n\n(1 \u2212 \u03be)p\u2212i\u03be i\n\ni=0\n\np!\ni!(p \u2212 i)!\n\nThis sum is identically 1, as seen by considering a binomial expansion of\n(\u03be + (1 \u2212 \u03be))p . Similar argument apply to (3)\u2013(6). Thus, in the natural\n4\n\n\fparametric domains, the above summations may be regarded as weighted\naverages of the control points, proving the theorem.\nThe next feature of BB form is that once a function is in BB form, the\nderivatives can be easily put into BB form. In all cases, the derivative is a\nBB expansion of one degree lower, multiplied by p, and with control points\nthat are finite differences of the control points for F in the direction of the\nvariable being differentiated. Thus, for example, in the case of (5), we have\np\u22121\nX\nX p\u2212i\u22121\n\u2202F\n(p \u2212 1)!\np(fi+1,j \u2212 fi,j )\u03be i \u03b7 j (1 \u2212 \u03be \u2212 \u03b7)p\u2212i\u2212j\u22121\n=\n\u2202\u03be\ni!j!(p \u2212 i \u2212 j \u2212 1)!\ni=0 j=0\n\nand\np\u22121\nX\nX p\u2212i\u22121\n(p \u2212 1)!\n\u2202F\np(fi,j+1 \u2212 fi,j )\u03be i \u03b7 j (1 \u2212 \u03be \u2212 \u03b7)p\u2212i\u2212j\u22121\n=\n.\n\u2202\u03b7\ni!j!(p \u2212 i \u2212 j \u2212 1)!\ni=0 j=0\n\nIn this case, the list of p(p + 1)/2 vectors of the form p(fi+1,j \u2212 fi,j ) are control\npoints of \u2202F/\u2202\u03be, and analogously p(fi,j+1 \u2212 fi,j ) are control points for \u2202F/\u2202\u03b7.\nLet us denote these two lists of control points G\u03be and G\u03b7 respectively. Similar\nexpressions hold for the other four BB forms described above. In 3D there\nis a third list G\u03b6 . We now state our condition:\nCondition 1 In the case d = 2, the matrix [u, v] is invertible for every\nu \u2208 hull(G\u03be ) and every v \u2208 hull(G\u03b7 ). In the case d = 3, the matrix [u, v, w]\nis invertible for every u \u2208 hull(G\u03be ), v \u2208 hull(G\u03b7 ), w \u2208 hull(G\u03be ).\nIn this condition, \"hull\" denotes the convex hull. The main result of this\nsection is as follows.\nTheorem 2 If Condition 1 holds, then the matrix J is invertible on the\nentire reference element.\nThe proof of this theorem follows from the arguments in the previous\nparagraphs: Condition 1 is sufficient since the actual Jacobians that occur\non the domain have their first columns chosen from hull(G\u03be ), etc.\n\n5\n\n\f3\n\nA computational characterization of the sufficient condition\n\nCondition 1 specifies our sufficient condition in somewhat nonconstructive\nterms. In this section we provide a computational means to verify the sufficient condition.\nTheorem 3 In the case of R2 , Condition 1 is equivalent to the following\ncondition:\n\u2022 there exists a vector h \u2208 R2 such that for all f \u2208 G\u03be \u222a G\u03b7 , hT f > 0,\nand\n\u2022 there exists a vector h\u0304 \u2208 R2 such that for all f \u2208 G\u03be , h\u0304T f > 0 and for\nall f \u2208 G\u03b7 , h\u0304T f < 0.\nProof. Let u, v be arbitrary in hull(G\u03be ) and hull(G\u03b7 ) respectively. This is\nequivalent to saying there exist nonnegative \u03b11 , . . . , \u03b1n summing to 1 such\nthat u = \u03b11 f1 +* * *+\u03b1n fn , where f1 , . . . , fn is an enumeration of G\u03be . Similarly,\nthere exist nonnegative \u03b21 , . . . , \u03b2m summing to 1 such that v = \u03b21 g1 + * * * +\n\u03b2m gm , where g1 , . . . , gm is an enumeration of G\u03b7 . The condition that [u, v] is\ninvertible is equivalent to saying that u, v are independent, i.e., that there do\nnot exist \u03b4, \u03b3, at least one nonzero such that \u03b4u + \u03b3v = 0. Suppose they are\ndependent, and let \u03b4, \u03b3 be the two coefficients of dependence. Without loss of\ngenerality, \u03b4 \u2265 0. There are now two cases: either \u03b3 \u2265 0 or \u03b3 < 0. If \u03b3 \u2265 0,\ndefine \u1fb11 , * * * , \u1fb1n to be \u03b4\u03b11 , . . . , \u03b4\u03b1n and define \u03b2\u03041 , * * * , \u03b2\u0304m to be \u03b3\u03b21 , * * * , \u03b3\u03b2n .\nThen the condition that the \u03b1's are nonnegative and the assumption that\n\u03b4 \u2265 0 is equivalent to the hypothesis that \u1fb11 , . . . \u1fb1n are nonnegative (with\nno restriction on their sum). Similarly, the condition on the \u03b2\u0304i 's is that they\nare nonnegative.\nThus, in the case that \u03b3 \u2265 0, a dependence is equivalent to the existence\nof nonnegative \u1fb1i 's and \u03b2\u0304i 's, not all zeros, such that\nn\nX\ni=1\n\n\u1fb1i fi +\n\nm\nX\n\n\u03b2\u0304i gi = 0.\n\ni=1\n\nThis problem is solved by linear programming. By Farkas' lemma [16], there\nis a nonnegative solution to this problem, with not all the coefficients zero, if\n6\n\n\fand only if there does not exist a vector h such that hT fi > 0 and hT gi > 0\nfor all fi 's and gi 's.\nNow we turn to the case of dependence when \u03b3 < 0. In this case, using\nthe analogous argument, there is no dependence provided that there is a\nvector h\u0304 such that h\u0304T fi > 0 for all i and h\u0304T (\u2212gi ) > 0 for all i.\nThis shows that in the case of R2 , Condition 1 can be tested by solving\ntwo linear programming problems over R2 to find h and h\u0304. In fact, there\nis a much simpler algorithm, namely, compute the args of all the points in\nG\u03be \u222a G\u03b7 . To determine whether h exists, one checks whether the max arg\ndiffers by less than \u03c0 from the min arg. (The branch cut for defining the\narg function must be chosen outside the min-max range). A similar test can\ndetermine whether h\u0304 exists.\nIn the three-dimensional setting, the algorithm is not so simple but it is\nstill linear time. Following the same approach as in the previous proof, we\nsee that in 3D, Condition 1 is equivalent to the following conditions:\n\u2022 there exists a vector h1 \u2208 R3 such that hT1 f > 0 for any f \u2208 G\u03be \u222aG\u03b7 \u222aG\u03b6 ,\n\u2022 there exists a vector h2 \u2208 R3 such that hT2 f > 0 for any f \u2208 G\u03be \u222a G\u03b7 \u222a\n(\u2212G\u03b6 ), where \u2212G\u03b6 means {\u2212f : f \u2208 G\u03b6 },\n\u2022 there exists a vector h3 \u2208 R3 such that hT3 f > 0 for any f \u2208 G\u03be \u222a\n(\u2212G\u03b7 ) \u222a G\u03b6 , and\n\u2022 there exists a vector h4 \u2208 R3 such that hT4 f > 0 for any f \u2208 G\u03be \u222a\n(\u2212G\u03b7 ) \u222a (\u2212G\u03b6 ).\nEach of these can be verified with linear programming, which is linear time\nin three dimensions [8]. Alternatively, they can be verified in O(n log n) time\nusing a convex hull algorithm [3].\n\n4\n\nGlobal invertibility\n\nWe are now in a position to prove that Condition 1 in fact implies global\ninvertibility of the mapping function. To demonstrate global invertibility,\nwe will show that F is injective, i.e., for all u, v in the reference domain,\nu 6= v \u21d2 F (u) 6= F (v). Injectivity is sufficient for global invertibility: if\nan injective smooth function has a nonsingular derivative at all points of\n7\n\n\fits domain, then the global inverse is also smooth by the inverse mapping\ntheorem. The nonsingularity of the derivative is already established.\nTheorem 4 If Condition 1 holds, then F is globally invertible on the reference element.\nProof. Let us start with the proof of injectivity in two dimensions. Choose\nu, v in the reference element such that u 6= v. Let w = v \u2212 u. Then by the\ndefinition of directional derivative,\nF (v) \u2212 F (u) =\n\nZ\n\n1\n\nJ(u + tw)w dt\n\n(7)\n\n0\n\nAssume without loss of generality that w1 \u2265 0, where (w1 , w2) denotes the\nentries of w. (The case w1 < 0 is handled by exchanging the roles of u, v.)\nNow there are two cases: either w2 \u2265 0 or w2 < 0. Suppose first that w2 \u2265 0.\nBecause we assume Condition 1 and because we have established Theorem 3,\nwe conclude that there exists a vector h \u2208 R2 such that hT f > 0 for all\nf \u2208 G\u03be \u222a G\u03b7 . By convexity, this implies hT f > 0 for all f \u2208 hull(G\u03be \u222a G\u03b7 ).\nThis implies that hT J(\u03be, \u03b7) is a vector both of whose entries are positive\nfor any \u03be, \u03b7 in the reference domain since both columns of J are taken from\nhull(G\u03be \u222a G\u03b7 ). Since w has both entries nonnegative, and at least one entry\nof w is positive (because u 6= v), this means hT J(\u03be, \u03b7)w > 0 for all \u03be, \u03b7 in\nthe reference domain. Thus, taking the inner product of both sides of (7)\nwith h shows that hT (F (v) \u2212 F (u)) > 0, and in particular, F (v) 6= F (u).\nThe second case is w2 < 0. The argument is analogous, except we use h\u0304\ninstead of h.\nFinally, the extension to 3D follows the same lines. We assume w1 \u2265 0.\nDepending on the signs of entries w2 , w3 of w, we select one of h1 , h2 , h3 , h4 .\n\n5\n\nDiscussion\n\nWe say that a sufficient condition for invertibility has the \"affinity\" property\nprovided that it is always satisfied if the mapping function is a nondegenerate\naffine linear mapping, or a sufficiently small perturbation of a nondegenerate\naffine linear mapping.\n\n8\n\n\fAffinity is a desirable property since the affine linear mapping is obviously\nthe easiest case for invertibility. Furthermore, if a sufficient condition for invertibility has the affinity property, then it can be turned into a necessary\nand sufficient condition if applied to each subcell of a sufficiently fine subdivision of the original domain. This is because an invertible mapping on a\nfine subdivision will behave like an affine mapping plus a small perturbation\non each subcell, and the small perturbation tends to zero as the subdivision\ngets finer.\nIt is fairly easy to see that our test has the affinity property. Recall\nthat the BB control points for a constant function are all identical. Thus,\nif F is affine linear, then G\u03be , G\u03b7 and G\u03b6 are all singleton sets. Assuming\nthat F is affine and invertible means that the condition must be satisfied.\nFurthermore, a sufficiently small perturbation of F will give G\u03be , G\u03b7 , and G\u03b6\na positive radius, but the condition of separability by planes will still hold.\nUshakova's condition also has the affinity property. We suggest that any\nproposed sufficient condition should possess the affinity property in order to\nbe considered useful.\nUshakova's sufficient condition for the p = 1 and U = I 3 case is less\nrestrictive (i.e., is able to validate more elements) than the condition proposed\nhere.\nWe conclude with a few open questions raised by this work.\n1. In the case p = 1 and U = I 3 , our condition is more restrictive than\nUshakova's. On the other hand, it is not obvious how to generalize\nher condition to higher degrees or to tetrahedral elements. It would\nbe interesting to combine her techniques with the ones in this paper to\ncome up with less restrictive conditions for higher degrees. Ushakova\n(private communication) found that experiments with randomly generated elements indicate that for p = 1, U = I 3 , the conditions stated\nhere overly restrictive in the sense that most of the valid (invertible)\nelements among a randomly generated test set would not satisfy the\nsufficient condition proposed here.\n2. In practical application of isoparametric mesh generation, one defines\nthe polynomial function only on one face of the boundary of the element (namely, the face adjacent to a curved exterior boundary). The\nremaining coefficients defining F can be determined by a formula such\nas the formula proposed by Lenoir [7], which has certain theoretical\n9\n\n\fguarantees. How does the sufficient condition here specialize if we assume that interior degrees of freedom of F are determined by Lenoir's\nformula? Our very preliminary computational tests seem to indicate\nthat using Lenoir's formula seems to make the element more amenable\nto our sufficient condition (i.e., it seems to minimize the diameters of\nthe sets G\u03be , G\u03b7 , G\u03b6 compared to other choices for interior degrees of\nfreedom).\n3. The test proposed here could be strengthened to obtain an upper bound\non cond(F ) defined by (1) in terms of the numerical values of hT fi as\nfi ranges over the sets G\u03be , G\u03b7 , G\u03b6 and h is the vector defining one of\nthe halfspaces in Theorem 3. This raises the possibility of a sufficient\ncondition not only for invertibility but also for confirming the CiarletRaviart conditions. Recall that the Ciarlet-Raviart conditions require\nthat higher derivatives of F are bounded in terms of cond(F ).\nNote that other condition numbers besides cond(F ) may be useful in\npractice. For example, Branets and Garanzha [1] have developed a\ndistortion measure related to structured grid generation. It would be\ninteresting to get bounds on all of these condition numbers in terms of\nthe the numerical values of hT fi .\n\n6\n\nAcknowledgments\n\nThe author is grateful to O. Ushakova, S. Ivanenko and V. Garanzha for\nhelpful comments on this manuscript.\n\nReferences\n[1] L. V. Branets and V. A. Garanzha. Global condition number of trilinear mappings. Application to 3-d grid generation. See http: //\nwww.ccas.ru / gridgen, 2001.\n[2] P. Ciarlet and P.-A. Raviart. Interpolation theory over curved elements,\nwith applications to finite element methods. Computer Methods in Applied Mechanics and Engineering, 1:217\u2013249, 1972.\n[3] H. Edelsbrunner. Algorithms in combinatorial geometry.\nVerlag, New York, 1987.\n10\n\nSpringer-\n\n\f[4] Gerald Farin. Curves and Surfaces for Computer-Aided Geometric Design. Academic Press, 4th edition, 1997.\n[5] S. Ivanenko. Harmonic mapping. In J. Thompson, B. Soni, and\nN. Weatherill, editors, Handbook of Grid Generation. CRC Press, 1999.\n[6] C. Johnson. Numerical Solution of Partial Differential Equations by the\nFinite Element Method. Cambridge University Press, 1987.\n[7] M. Lenoir. Optimal isoparametric finite elements and error estimates for\ndomains involving curved boundaries. SIAM J. Numer. Anal., 23:562\u2013\n580, 1986.\n[8] N. Megiddo. Linear-time algorithms for linear programming in R3 and\nrelated problems. SIAM J. Computing, 12:759\u2013776, 1983.\n[9] A. Salem, S. Canann, and S. Saigal. Robust quality metric for quadratic\ntriangular 2D finite elements. In Trends in unstructured mesh generation, volume 220, pages 73\u201380. AMD/ASME, 1997.\n[10] A. Salem, S. Canann, and S. Saigal. Mid-node admissible spaces for\nquadratic triangular 2D arbitrarily curved finite elements. International\nJ. Numer. Meth. Eng., 50:253\u2013272, 2001.\n[11] A. Salem, S. Canann, and S. Saigal. Mid-node admissible spaces for\nquadratic triangular 2D finite elements with one edge curved. International J. Numer. Meth. Eng., 50:181\u2013197, 2001.\n[12] A. Salem, S. Saigal, and S. Canann. Mid-node admissible space for\n3D quadratic tetrahedral finite elements. Engineering with Computers,\n17:39\u201354, 2001.\n[13] M. Shephard, S. Dey, and M. Georges. Automatic meshing of curved\nthree-dimensional domains: Curving finite elements and curvaturebased mesh control. In I. Babuska, J. Flaherty, J. Hopcroft, W. Henshaw, J. Oliger, and T. Tezduyar, editors, Modeling, Mesh Generation, and Adaptive Numerical Methods for Partial Differential Equations. Springer Verlag, 1995.\n[14] G. Strang and G. Fix. An Analysis of the Finite Element Method. Prentice Hall, 1973.\n11\n\n\f[15] O. Ushakova. Nondegeneracy criteria for 3-d grid cells. Formulas for a\ncell volume. SIAM J. Sci. Comp., to appear.\n[16] G. M. Ziegler. Lectures on polytopes. Springer-Verlag, New York, 1995.\n\n12\n\n\f"}