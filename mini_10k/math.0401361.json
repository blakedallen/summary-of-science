{"id": "http://arxiv.org/abs/math/0401361v1", "guidislink": true, "updated": "2004-01-26T18:04:51Z", "updated_parsed": [2004, 1, 26, 18, 4, 51, 0, 26, 0], "published": "2004-01-26T18:04:51Z", "published_parsed": [2004, 1, 26, 18, 4, 51, 0, 26, 0], "title": "The First Order Definability of Graphs with Separators via the\n  Ehrenfeucht Game", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0401361%2Cmath%2F0401435%2Cmath%2F0401150%2Cmath%2F0511321%2Cmath%2F0511169%2Cmath%2F0511414%2Cmath%2F0511574%2Cmath%2F0511241%2Cmath%2F0511641%2Cmath%2F0511399%2Cmath%2F0511591%2Cmath%2F0511411%2Cmath%2F0511104%2Cmath%2F0511487%2Cmath%2F0511114%2Cmath%2F0511017%2Cmath%2F0511128%2Cmath%2F0511284%2Cmath%2F0511692%2Cmath%2F0511709%2Cmath%2F0511422%2Cmath%2F0511051%2Cmath%2F0511612%2Cmath%2F0511490%2Cmath%2F0511048%2Cmath%2F0511363%2Cmath%2F0511071%2Cmath%2F0511660%2Cmath%2F0511645%2Cmath%2F0511195%2Cmath%2F0511319%2Cmath%2F0511708%2Cmath%2F0511505%2Cmath%2F0511106%2Cmath%2F0511408%2Cmath%2F0511112%2Cmath%2F0511210%2Cmath%2F0511264%2Cmath%2F0511603%2Cmath%2F0511607%2Cmath%2F0511168%2Cmath%2F0511066%2Cmath%2F0511601%2Cmath%2F0511478%2Cmath%2F0511047%2Cmath%2F0511090%2Cmath%2F0511515%2Cmath%2F0511003%2Cmath%2F0511742%2Cmath%2F0511485%2Cmath%2F0511238%2Cmath%2F0511232%2Cmath%2F0511711%2Cmath%2F0511248%2Cmath%2F0511009%2Cmath%2F0511618%2Cmath%2F0511397%2Cmath%2F0511297%2Cmath%2F0511352%2Cmath%2F0511310%2Cmath%2F0511004%2Cmath%2F0511097%2Cmath%2F0511526%2Cmath%2F0511494%2Cmath%2F0511346%2Cmath%2F0511382%2Cmath%2F0511648%2Cmath%2F0511277%2Cmath%2F0511421%2Cmath%2F0511161%2Cmath%2F0511428%2Cmath%2F0511117%2Cmath%2F0511389%2Cmath%2F0511518%2Cmath%2F0511502%2Cmath%2F0511347%2Cmath%2F0511737%2Cmath%2F0511155%2Cmath%2F0511255%2Cmath%2F0511172%2Cmath%2F0511030%2Cmath%2F0511285%2Cmath%2F0511740%2Cmath%2F0511176%2Cmath%2F0511644%2Cmath%2F0511702%2Cmath%2F0511543%2Cmath%2F0511280%2Cmath%2F0511259%2Cmath%2F0511022%2Cmath%2F0511390%2Cmath%2F0511452%2Cmath%2F0511716%2Cmath%2F0511166%2Cmath%2F0511219%2Cmath%2F0511089%2Cmath%2F0511317%2Cmath%2F0511202%2Cmath%2F0511420%2Cmath%2F0511159%2Cmath%2F0511514&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The First Order Definability of Graphs with Separators via the\n  Ehrenfeucht Game"}, "summary": "We say that a first order formula $\\Phi$ defines a graph $G$ if $\\Phi$ is\ntrue on $G$ and false on every graph $G'$ non-isomorphic with $G$. Let $D(G)$\nbe the minimal quantifier rank of a such formula. We prove that, if $G$ is a\ntree of bounded degree or a Hamiltonian (equivalently, 2-connected) outerplanar\ngraph, then $D(G)=O(\\log n)$, where $n$ denotes the order of $G$. This bound is\noptimal up to a constant factor. If $h$ is a constant, for connected graphs\nwith no minor $K_h$ and degree $O(\\sqrt n/\\log n)$, we prove the bound\n$D(G)=O(\\sqrt n)$. This result applies to planar graphs and, more generally, to\ngraphs of bounded genus.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0401361%2Cmath%2F0401435%2Cmath%2F0401150%2Cmath%2F0511321%2Cmath%2F0511169%2Cmath%2F0511414%2Cmath%2F0511574%2Cmath%2F0511241%2Cmath%2F0511641%2Cmath%2F0511399%2Cmath%2F0511591%2Cmath%2F0511411%2Cmath%2F0511104%2Cmath%2F0511487%2Cmath%2F0511114%2Cmath%2F0511017%2Cmath%2F0511128%2Cmath%2F0511284%2Cmath%2F0511692%2Cmath%2F0511709%2Cmath%2F0511422%2Cmath%2F0511051%2Cmath%2F0511612%2Cmath%2F0511490%2Cmath%2F0511048%2Cmath%2F0511363%2Cmath%2F0511071%2Cmath%2F0511660%2Cmath%2F0511645%2Cmath%2F0511195%2Cmath%2F0511319%2Cmath%2F0511708%2Cmath%2F0511505%2Cmath%2F0511106%2Cmath%2F0511408%2Cmath%2F0511112%2Cmath%2F0511210%2Cmath%2F0511264%2Cmath%2F0511603%2Cmath%2F0511607%2Cmath%2F0511168%2Cmath%2F0511066%2Cmath%2F0511601%2Cmath%2F0511478%2Cmath%2F0511047%2Cmath%2F0511090%2Cmath%2F0511515%2Cmath%2F0511003%2Cmath%2F0511742%2Cmath%2F0511485%2Cmath%2F0511238%2Cmath%2F0511232%2Cmath%2F0511711%2Cmath%2F0511248%2Cmath%2F0511009%2Cmath%2F0511618%2Cmath%2F0511397%2Cmath%2F0511297%2Cmath%2F0511352%2Cmath%2F0511310%2Cmath%2F0511004%2Cmath%2F0511097%2Cmath%2F0511526%2Cmath%2F0511494%2Cmath%2F0511346%2Cmath%2F0511382%2Cmath%2F0511648%2Cmath%2F0511277%2Cmath%2F0511421%2Cmath%2F0511161%2Cmath%2F0511428%2Cmath%2F0511117%2Cmath%2F0511389%2Cmath%2F0511518%2Cmath%2F0511502%2Cmath%2F0511347%2Cmath%2F0511737%2Cmath%2F0511155%2Cmath%2F0511255%2Cmath%2F0511172%2Cmath%2F0511030%2Cmath%2F0511285%2Cmath%2F0511740%2Cmath%2F0511176%2Cmath%2F0511644%2Cmath%2F0511702%2Cmath%2F0511543%2Cmath%2F0511280%2Cmath%2F0511259%2Cmath%2F0511022%2Cmath%2F0511390%2Cmath%2F0511452%2Cmath%2F0511716%2Cmath%2F0511166%2Cmath%2F0511219%2Cmath%2F0511089%2Cmath%2F0511317%2Cmath%2F0511202%2Cmath%2F0511420%2Cmath%2F0511159%2Cmath%2F0511514&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We say that a first order formula $\\Phi$ defines a graph $G$ if $\\Phi$ is\ntrue on $G$ and false on every graph $G'$ non-isomorphic with $G$. Let $D(G)$\nbe the minimal quantifier rank of a such formula. We prove that, if $G$ is a\ntree of bounded degree or a Hamiltonian (equivalently, 2-connected) outerplanar\ngraph, then $D(G)=O(\\log n)$, where $n$ denotes the order of $G$. This bound is\noptimal up to a constant factor. If $h$ is a constant, for connected graphs\nwith no minor $K_h$ and degree $O(\\sqrt n/\\log n)$, we prove the bound\n$D(G)=O(\\sqrt n)$. This result applies to planar graphs and, more generally, to\ngraphs of bounded genus."}, "authors": ["Oleg Verbitsky"], "author_detail": {"name": "Oleg Verbitsky"}, "author": "Oleg Verbitsky", "arxiv_comment": "17 pages", "links": [{"href": "http://arxiv.org/abs/math/0401361v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0401361v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.LO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "03C13; 05C60", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0401361v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0401361v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0401361v1 [math.CO] 26 Jan 2004\n\nThe First Order Definability\nof Graphs with Separators\nvia the Ehrenfeucht Game\nOleg Verbitsky\nKyiv University, Ukraine\noleg@ov.litech.net\n\n30 March 2003\nAbstract\nWe say that a first order formula \u03a6 defines a graph G if \u03a6 is true on G\nand false on every graph G\u2032 non-isomorphic with G. Let D(G) be the minimal\nquantifier rank of a such formula. We prove that, if G is a tree of bounded\ndegree or a Hamiltonian (equivalently, 2-connected) outerplanar graph, then\nD(G) = O(log n), where n denotes the order of G. This bound is optimal up\nto a constant factor. If h is a constant, for connected graphs with no minor\n\u221a\n\u221a\nKh and degree O( n/ log n), we prove the bound D(G) = O( n). This result\napplies to planar graphs and, more generally, to graphs of bounded genus.\nOur proof techniques are based on the characterization of the quantifier\nrank as the length of the Ehrenfeucht game on non-isomorphic graphs. We\nuse the separator theorems to design a winning strategy for Spoiler in this\ngame.\n\n1\n\nIntroduction\n\nWe treat a graph G as a structure with a single anti-reflexive and symmetric binary\npredicate E for the adjacency relation of G. Every closed first order formula \u03a6\nwith predicate symbols E and = is either true or false on G. The quantifier rank\nof \u03a6 is the maximum number of nested quantifiers in this formula (see Section 2\nfor formal definitions). Given two non-isomorphic graphs G and G\u2032 , we say that \u03a6\ndistinguishes G from G\u2032 if \u03a6 is true on G but false on G\u2032 . Let D(G, G\u2032 ) denote the\nminimum quantifier rank of a such formula.\nThe definability issues, studied in finite model theory, are important for such\nareas in computer science as databases, model checking, and descriptive complexity\ntheory. The number D(G, G\u2032 ) should be considered the measure of indistinguishability of the graphs by means of first order logic. The larger D(G, G\u2032 ) is, the harder\nis to find a difference between G and G\u2032 expressible by a first order statement. A\n1\n\n\fcharacterization of D(G, G\u2032 ) in terms of partial isomorphisms between G and G\u2032\nand extensions thereof is given by Fra\u0131\u0308ss\u00e9 [6]. Equivalently in essence, Ehrenfeucht\n[5] characterizes D(G, G\u2032) as the length of a Spoiler-Duplicator game on G and G\u2032 ,\nwhich provides us with a nice and robust tool for estimation of D(G, G\u2032 ).\nOne of the simplest examples of graphs whose distinguishion requires large quantifier rank is given by complete graphs. The lower bound D(Kn , Kn+1 ) > n is obvious from the Ehrenfeucht characterization and matches the simple general upper\nbound D(G, G\u2032 ) \u2264 n + 1 for G of order n and G\u2032 non-isomorphic with G. A bit\nless obvious, rather popular in the literature, examples of the first order similarity\nare given by paths and cycles. Two paths or two cycles of distinct length turn out\nindistinguishable by formulas of logarithmic quantifier rank: if m > n, then\nD(Pn , Pm ) > log2 (n \u2212 1) \u2212 2\n\n(1)\n\n(e.g. [18, Theorem 2.1.3]) and\nD(Cn , Cm ) > log2 n\n\n(2)\n\n(e.g. [18, Proof of Theorem 2.4.2] and [4, Example 2.3.8]). These lower bounds are\nwell known to be tight up to an additive constant (e.g. [18, Theorem 2.1.2]).\nWe say that a first order formula \u03a6 defines a graph G if \u03a6 distinguishes G from\nall non-isomorphic graphs. Let D(G) denote the minimum quantifier rank of a such\nformula. Complementing (1) and (2), it is not hard to show that\nD(Pn ) < log2 n + 3 and D(Cn ) < log2 n + 3\n\n(3)\n\n(cf. Remark 4.2). We here generalize (3) both for paths and cycles by showing that\nD(G) = O(log n)\n\n(4)\n\nfor G of order n being, respectively, a tree of bounded degree or a Hamiltonian\nouterplanar graph.\nIf we put no restriction on the degree, D(G) for a tree may be much bigger. For\nexample, for stars we have\nD(K1,n\u22121 , K1,n ) = n.\n(5)\nThe same example shows that the hamiltonicity is essential for the definability of\nouterplanar graphs with small (logarithmic) quantifier rank. Note, however, that for\nouterplanar graphs the hamiltonicity should not be considered a strong structural\nrestriction. It is well known that every 2-connected component of an outerplanar\ngraph is an outerplanar graph (see e.g. [10]) and it is easy to see that 2-connected\nouterplanar graphs are precisely Hamiltonian outerplanar graphs.\nIt is worth noting that the defining formulas assumed by (4) have a restricted\nlogical structure. We say that a first order formula \u03a6 is in negation normal form\nif the connective \u00ac occurs in \u03a6 only in front of atomic subformulas. If \u03a6 is such a\nformula, its alternation number is the maximum number of alternations of \u2203 and \u2200\nin a sequence of nested quantifiers of \u03a6. Our proof of (4) produces defining formulas\nin negation normal form whose alternation number is at most 2.\n2\n\n\fThe proof of (4) is based on the analysis of the Ehrenfeucht game on nonisomorphic graphs G and G\u2032 , where G is a tree of bounded degree or Hamiltonian\nouterplanar. The analysis is uniform for both classes of graphs and uses only the existence of a small separator in G. A separator of G is a set of vertices whose removal\nsplits G into connected components each having at most \u01ebn vertices. Cai, F\u00fcrer,\nand Immerman [3] prove that, if G has separator of size O(n\u03b4 ), 0 < \u03b4 < 1, then G\nis definable by a formula with counting quantifiers that has O(n\u03b4 ) variables. For an\ninteger m, a counting quantifier \u2203\u2265m x\u03a8 means that there are at least m vertices x\nfor which the statement \u03a8 holds. Note that we use separators in a more complicated\nsituation than they were used in [3], where the power of counting quantifiers was\nessential.\nTo prove the logarithmic bound (4), it is essential that trees and outerplanar\ngraphs have separators of constant size. For some larger classes, as planar graphs,\ngraphs of bounded genus, and,\n\u221a most generally, graphs with an excluded minor, there\nexist separators of size O( n) [14, 7, 1]. We are able to adapt our \u221atechniques for\nconnected graphs in these classes and prove the bound D(G) = O( n) under the\n\u221a\nrestriction of the maximum vertex degree of G to O( n/ log n). The connectedness\nis here essential: for example, D(T rivm,2m , T rivm\u22121,2m+2 ) = 2m, where T riva,b is a\ngraph with a isolated edges and b isolated vertices. The restriction of the maximum\nvertex degree is essential by (5). Note that the bounded degree, on its own right,\ndoes not bound D(G) so much. Cai, F\u00fcrer, and Immerman [3] construct a sequence\nof graphs G whose maximum degree is 4 but nevertheless D(G) = \u03a9(n).\nRelated work. In [17] we prove that, if G and G\u2032 are non-isomorphic graphs\nof the same order n, then D(G, G\u2032 ) \u2264 (n + 3)/2. Simple examples show that this\nbound is best possible up to an additive constant of 1. Thus, trees of bounded degree\nand Hamiltonian outerplanar graphs should be considered classes of graphs definable\nwith low quantifier rank. Another important characteristics is the minimum number\nof variables used in a distinquishing or defining formula (different occurrences of\nthe same variable are not counted). Note that this number does not exceed the\nminimum quantifier rank. Immerman and Kozen [12] prove that every tree of degree\nd, represented by a child-parent relation between vertices, is definable with at most\nd variables. Grohe [8, 9] shows that planar graphs and, more generally, graphs\nof bounded genus are definable by formulas with counting quantifiers using only\nconstantly many variables.\nThe paper is organized as follows. Section 2 contains the relevant definitions\nfrom graph theory and logic. We present our approach in Section 3 and apply it\nto trees of bounded degree and Hamiltonian outerplanar graphs in Section 4. In\nSection 5 we handle the classes of graphs of bounded degree with separators.\n\n3\n\n\f2\n2.1\n\nPreliminaries\nGraphs\n\nGiven a graph G, we denote its vertex set by V (G). Throughout the paper, unless\nstated otherwise, n denotes the order of G, that is, n = |V (G)|. Sometimes the order\nof G will be denoted by |G|. The neighborhood of a vertex v consists of all vertices\nadjacent to v and is denoted by \u0393(v). The neighborhood of a set X \u2286 V (G) is\nS\ndefined by \u0393(X) = v\u2208X \u0393(v) \\ X. The degree of a vertex v is the number of vertices\nin \u0393(v). The maximum vertex degree of G is denoted by \u2206(G). We say that graphs\nin a class C have bounded degree if \u2206(G) = O(1) for G in C. The distance between\ntwo vertices of a graph G, u and v, is equal to the shortest length of a path between\nu and v and denoted by d(u, v). The distance from a vertex u \u2208 V (G) to a set\nX \u2286 V (G) is defined by d(u, X) = minv\u2208X d(u, v).\nA Hamilton cycle in a graph G is an ordering v1 , . . . , vn of V (G) such that vi\nand vi+1 are adjacent for all i < n and adjacent are also vn and v1 . A graph with a\nHamilton cycle is called Hamiltonian.\nAn outerplanar graph is a planar graph embeddable in plane so that all vertices\nlie on the border of the same face.\nIf X \u2286 V (G), then G[X] denotes the subgraph induced by G on X. The result of\nremoval of all vertices in X from G is denoted by G\\X, that is, G\\X = G[V (G)\\X].\nDefinition 2.1 [1] If X \u2286 V (G), we call a connected component of G \\ X an\nX-flap.\nWe write G \u223c\n= G\u2032 if graphs G and G\u2032 are isomorphic. A one-to-one map \u03c6 : X \u2192\nX \u2032 , where X \u2286 V (G) and X \u2032 \u2286 V (G\u2032 ), is a partial isomorphism from G to G\u2032 if \u03c6\nis an isomorphism from G[X] to G\u2032 [X \u2032 ].\nA colored graph is a structure that, in addition to the anti-reflexive and symmetric\nbinary relation, has countably many unary relations Ci , i \u2265 1. The truth of Ci (v)\nfor a vertex v is interpreted as coloration of v in color i. We consider finite colored\ngraphs, whose vertices can have only finitely many colors. Most graph-theoretic\nnotions carry over colored graphs literally. For example, a colored graph is connected\niff so is its underlying graph. Note only that an isomorphism of colored graphs\npreserves the adjacency relation and, moreover, matches a vertex of one graph to\nan equally colored vertex of the other graph. If C is a class of graphs, color(C) will\ndenote the class of colored graphs whose underlying graphs are in C.\n\n2.2\n\nLogic\n\nFirst order formulas are assumed to be over the set of connectives {\u00ac, \u2227, \u2228}.\nDefinition 2.2 A sequence of quantifiers is a finite word over the alphabet {\u2203, \u2200}.\nIf S is a set of such sequences, then \u2203S (resp. \u2200S) means the set of concatenations\n\u2203s (resp. \u2200s) for all s \u2208 S. If s is a sequence of quantifiers, then s\u0304 denotes the result\n4\n\n\fof replacement of all occurrences of \u2203 to \u2200 and vice versa in s. The set S\u0304 consists of\nall s\u0304 for s \u2208 S.\nGiven a first order formula \u03a6, its set of sequences of nested quantifiers is denoted\nby Nest(\u03a6) and defined by induction as follows:\n(1) Nest(\u03a6) consists only of the empty word if \u03a6 is atomic.\n(2) Nest(\u00ac\u03a6) = Nest(\u03a6).\n(3) Nest(\u03a6 \u2227 \u03a8) = Nest(\u03a6 \u2228 \u03a8) = Nest(\u03a6) \u222a Nest(\u03a8).\n(4) Nest(\u2203x\u03a6) = \u2203 Nest(\u03a6) and Nest(\u2200x\u03a6) = \u2200 Nest(\u03a6).\nDefinition 2.3 The quantifier rank of a formula \u03a6 is the maximum length of a\nstring in Nest(\u03a6).\nWe adopt the notion of the alternation number of a formula (cf. [15, Definition 2.8]).\nDefinition 2.4 Given a sequence of quantifiers s, let alt(s) denote the number of\noccurrences of \u2203\u2200 and \u2200\u2203 in s. The alternation number of a first order formula \u03a6 is\nthe maximum alt(s) over s \u2208 Nest(\u03a6).\nDefinition 2.5 Given a graph G and a first order formula \u03a6 over vocabulary\n{E, =}, we say that \u03a6 distinguishes G from G\u2032 if \u03a6 is true on G but false on G\u2032 .\nBy D(G, G\u2032 ) (resp. Dk (G, G\u2032 )) we denote the minimum quantifier rank of a formula\n(with alternation number at most k resp.) distinguishing G from G\u2032 .\nWe say that \u03a6 defines G (up to isomorphism) if \u03a6 distinguishes G from any nonisomorphic graph G\u2032 . By D(G) (resp. Dk (G)) we denote the minimum quantifier\nrank of a formula defining G (with alternation number at most k resp.).\nNote that D(G, G\u2032 ) = mink\u22650 Dk (G, G\u2032 ) and D(G) = mink\u22650 Dk (G). The following proposition is a simple consequence of the well-known fact that over a fixed finite\nrelational vocabulary there are only finitely many inequivalent first order formulas\nof bounded quantifier rank.\nProposition 2.6 For every graph G it holds D(G) = max { D(G, G\u2032 ) : G\u2032 6\u223c\n= G} and\n\u2032\n\u2032 \u223c\nDk (G) = max { Dk (G, G ) : G 6= G}.\n\n2.3\n\nGames\n\nThe Ehrenfeucht game is played on a pair of structures of the same type. We give\na definition in the terminology of graphs.\n\n5\n\n\fDefinition 2.7 Let G and G\u2032 be graphs with disjoint vertex sets. The r-round\nEhrenfeucht game on G and G\u2032 , denoted by Ehrr (G, G\u2032 ), is played by two players,\nSpoiler and Duplicator, with using r pairwise distinct pebbles p1 , . . . , pr , each given\nin duplicate. Spoiler starts the game. A round consists of a move of Spoiler followed\nby a move of Duplicator. In the s-th round Spoiler selects one of the graphs G or\nG\u2032 and places ps on a vertex of this graph. In response Duplicator should place the\nother copy of ps on a vertex of the other graph. It is allowed to place more than one\npebble on the same vertex. We will use xs (resp. ys ) to denote the vertex of G (resp.\nG\u2032 ) occupied by ps , irrespectively of who of the players places the pebble on this\nvertex. The pair of sequences x\u0304 = (x1 , . . . , xs ) and \u0233 = (y1 , . . . , ys ) is a configuration\nof the game after the s-th round. If after every of r rounds it is true that\nxi = xj iff yi = yj for all i, j \u2264 s,\nand the component-wise correspondence x\u0304 to \u0233 is a partial isomorphism from G to\nG\u2032 , this is a win for Duplicator; Otherwise the winner is Spoiler.\nThe k-alternation Ehrenfeucht game on G and G\u2032 is a variant of the game in\nwhich Spoiler is allowed to switch from one graph to another at most k times during\nthe game, i.e., in at most k rounds he can choose the graph other than that in the\npreceding round.\nThe main technical tool we will use is given by the following statement.\nProposition 2.8 Let G and G\u2032 be non-isomorphic graphs.\n(1) D(G, G\u2032) equals the minimum r such that Spoiler has a winning strategy in\nEhrr (G, G\u2032 ).\n(2) Dk (G, G\u2032 ) equals the minimum r such that Spoiler has a winning strategy in\nthe k-alternation Ehrr (G, G\u2032 ).\nWe refer the reader to [4, Theorem 1.2.8], [11, Theorem 6.10], or [18, Theorem 2.3.1]\nfor the proof of the first claim and to [16] for the second claim.\n\n2.4\n\nNotation\n\nThroughout the paper log n means the logarithm base 2. We will use [n] to denote\nthe set {1, . . . , n}. For a function f , by f (k) we will denote the k-fold composition\nof f .\n\n3\n\nSpoiler's winning strategy based on separators\n\nLemma 3.1 Let x\u0304, \u0233 be a configuration after the s-th round of the Ehrenfeucht\ngame on colored graphs G, G\u2032 . Given I \u2282 [s], let XI = { xh : h \u2208 I} and YI =\n{ yh : h \u2208 I}. Assume that there are i, j \u2208 [s] and I \u2282 [s] such that xi and xj are in\nthe same XI -flap F of G while yi and yj are in different YI -flaps of G\u2032 . Then Spoiler\nis able to win in at most \u2308log |F |\u2309 moves, playing only in G.\n6\n\n\fProof. Let dF be the standard metric on F , i.e., dF (z1 , z2 ) is the shortest length\nof a path from z1 to z2 through vertices of F .\nSpoiler sets u1 = xi , u2 = xj , v1 = yi , v2 = yj , and places a pebble on a vertex\nu in F such that dF (u, um) \u2264 \u2308dF (u1 , u2 )/2\u2309 for both m = 1, 2. Let v \u2208 V (G\u2032 ) be\nselected by Duplicator in response to u. For both m = 1, 2 there is a path of length\nat most \u2308dF (u1 , u2)/2\u2309 from u to um through vertices of G \\ XI . In contrast with\nthis, for m = 1 or m = 2 there is no path from v to vm through vertices of G\u2032 \\ YI .\nFor this particular value of m, Spoiler resets u1 = u, u2 = um , v1 = v, v2 = vm\nand applies the same strategy once again. Therewith Spoiler ensures that, in each\nround, v1 and v2 are in different YI -flaps of G\u2032 . Eventually, unless Duplicator loses\nearlier, dF (u, um) = 1 for both m = 1, 2, that is, u1 , u, u2 is a path in F . As there is\nno path from v1 to v2 inside G\u2032 \\ YI , the isomorphism is broken and Spoiler wins.\nTo estimate the number of moves made, notice that initially dF (u1 , u2 ) \u2264 |F | \u2212 1\nand for each subsequent u1, u2 this distance becomes at most f (dF (u1 , u2)), where\nf (\u03b1) = (\u03b1 + 1)/2. Therefore the number of moves does not exceed the minimum k\nsuch that f (k) (|F | \u2212 1) < 2. As (f (k) )\u22121 (\u03b2) = 2k \u03b2 \u2212 2k + 1, the latter inequality is\nequivalent to 2k > |F | \u2212 2, which proves the bound.\n\u2737\nRemark 3.2 The bound \u2308log |F |\u2309 in Lemma 3.1 is tight up to a small additive\nconstant. For example, let 2Cn be the disjoint union of two cycles of length n. It is\nknown (e.g. [4, Example 2.3.8]) that Duplicator can survive in the Ehrenfeucht game\non 2Cn and Cn during \u230alog(n \u2212 1)\u230b rounds for any strategy of Spoiler, in particular,\nwhen Spoiler's first move is in one component of 2Cn and his second move is in the\nother component of 2Cn (Cn and both components of 2Cn are considered \u2205-flaps).\nWe now give a fairly rudimentary definition of a separator that abstracts away\nsome important features usually associated with this notion. These features will be\nspecified a bit later (cf. Definition 3.5).\nDefinition 3.3 Let C be a class of graphs. Let k be a function from N to R. A\nseparator of size k for C is a function sep defined on graphs in C such that, for every\nG \u2208 C, sep(G) \u2286 V (G) and | sep(G)| \u2264 k(n). We call the separator hereditary if,\nfor every G \u2208 C, all sep(G)-flaps are in C. We will extend sep over colored graphs\nby setting sep(G\u0303) = sep(G) for an arbitrary coloration G\u0303 of a graph G.\nLet C be a class of connected graphs with hereditary separator sep of size k(n).\nFor each i \u2265 0, we now describe a winning strategy Si for Spoiler applicable to the\nEhrenfeucht game on colored graphs G and G\u2032 such that G \u2208 color(C) and G\u2032 is\narbitrary non-isomorphic with G. The strategy Si is designed so that Spoiler reduces\nplay on G to play on a sep(G)-flap F , where the index i means that this trick can\nbe used up to i times.\nStrategy S0 .\nSpoiler selects all vertices of G. If this is still not a win (G is isomorphic to a proper\ninduced subgraph of G\u2032 ), then Spoiler selects one more vertex u in G\u2032 . This is\nSpoiler's win for any choice of u. Nevertheless, we will need an additional condition:\n7\n\n\fIf possible (e.g., G\u2032 is also connected), u must be adjacent to a vertex that was\nselected in G\u2032 by Duplicator.\nStrategy Si , i \u2265 1.\nAs usually, we denote the order of G by n. If G\u2032 is disconnected, Spoiler selects 2\nvertices in different components of G\u2032 and then applies the strategy of Lemma 3.1\n(with I = \u2205) winning in at most \u2308log n\u2309 next moves. Assume that G\u2032 is connected.\nIf k(n) \u2265 n, then Spoiler applies the strategy S0 . Assume that k(n) < n.\nLet X = sep(G) and k = |X|. Spoiler first selects all k vertices of X. Let\n(x1 , . . . , xk ), (y1 , . . . , yk ) be the configuration at this stage of the game. Note that\nX = {x1 , . . . , xk } and let X \u2032 = {y1 , . . . , yk }. Assume that Duplicator still does not\nlose.\nWe now modify coloring of each X-flap and each X \u2032 -flap in the following way.\nLet A1 , . . . , Ak be colors that occur neither in G nor in G\u2032 . If F is X-flap (resp. X \u2032 flap), then, for every i \u2264 k, the color Ai is assigned to all those vertices of F that are\nadjacent to xi in G (resp. to yi in G\u2032 ). It should be stressed that we introduce new\ncolors solely for the sake of technical convenience and this puts no new constraint on\nDuplicator: If Duplicator violates a new color, he therewith violates the adjacency\nto a previously selected vertex. Our technical benefit is that now, if Spoiler and\nDuplicator play on an X-flap F and X \u2032 -flap F \u2032 , we can forget about the rest of G\nand G\u2032 because Spoiler's win in the game on F and F \u2032 will mean his win in the\ngame on G and G\u2032 as well.\nGiven a colored graph H, let m(H) (resp. m\u2032 (H)) denote the number of X-flaps\n(resp. X \u2032 -flaps) isomorphic to H (the flaps are assumed with modified colorings).\nObserve that the partial isomorphism \u03c6 : X \u2192 X \u2032 established by Duplicator extends\nto an isomorphism from G to G\u2032 iff m(H) = m\u2032 (H) for all H. As G \u223c\n6= G\u2032 , there is\nH with m(H) 6= m\u2032 (H).\nCase 1: There is an H with m(H) > m\u2032 (H). Spoiler starts to select one vertex\nin each X-flap isomorphic to H. At latest in the (m\u2032 (H) + 1)-th round Duplicator\neither selects two vertices in the same X \u2032 -flap isomorphic to H or selects a vertex in\nan X \u2032 -flap F \u2032 non-isomorphic to H. In the former case Spoiler applies the strategy\nof Lemma 3.1 and wins in at most \u2308log |H|\u2309 moves. In the latter case Spoiler applies\nthe strategy Si\u22121 on graphs F and F \u2032 , where F is the X-flap, isomorphic to H, that\nis visited by Spoiler in the same round when Duplicator visits F \u2032 . Spoiler follows\nSi\u22121 on F and F \u2032 as long as Duplicator plays inside F and F \u2032 . If in any round\nSpoiler selects a vertex in F but Duplicator replies with a vertex outside F \u2032 , Spoiler\nswitches to the strategy of Lemma 3.1 and wins in at most \u2308log |F |\u2309 moves. We do\nnot need to specify the strategy Si for the case when Spoiler selects a vertex in F \u2032\nbut Duplicator replies with a vertex outside F because this is a loss of Duplicator\n(see Lemma 3.4 below). Note that we so far have not encountered the situation\nwhen Spoiler switches from G to G\u2032 , except the strategy S0 .\nCase 2: m(H) \u2264 m\u2032 (H) for all H. It follows that the number of X-flaps, that\nwill be denoted by f , is strictly less than the number of X \u2032 -flaps. In the subsequent\nf moves Spoiler selects one vertex in each X-flap. Then, in the next move Spoiler\nselects a vertex u in an X \u2032 -flap F \u2032 that was not visited by Duplicator so that u is\n8\n\n\fadjacent to a vertex in X \u2032 (such a vertex exists in F \u2032 because G\u2032 is connected and\nthere can be no path from F \u2032 to X \u2032 through other flaps). Duplicator is enforced to\nselect in response yet another, the second, vertex in one of X-flaps, say, in F . Then\nSpoiler applies the strategy of Lemma 3.1 and wins in at most \u2308log |F |\u2309 moves. This\ncompletes the description of the strategy Si .\nLemma 3.4 Let C be a class of connected graphs with hereditary separator sep. Let\nt \u2265 1. Consider the Ehrenfeucht game on colored graphs G \u2208 color(C) and G\u2032 \u223c\n6= G in\nwhich Spoiler follows St and Duplicator follows an arbitrary fixed strategy. Assume\nthat during the course of the game Spoiler invokes the strategy St\u22121 on X-flap F\nand X \u2032 -flap F \u2032 . If afterwards Spoiler selects a vertex in F \u2032 but Duplicator responds\nwith a vertex outside F , this is an immediate loss for Duplicator.\nProof. We start with some notation. Let q, 0 \u2264 q \u2264 t \u2212 1, be the smallest\nnumber such that the strategy Sq is invoked during the course of the game. Set\n\u2032\nFt = G, Ft\u2032 = G\u2032 , and Xt+1 = Xt+1\n= \u2205. If q \u2264 i \u2264 t, let Xi = sep(Fi ) and Xi\u2032 be the\n\u2032\nsubset of V (G ) that Duplicator takes into correspondence with Xi . Furthermore,\n\u2032\nlet Fi and Fi\u2032 be respectively Xi+1 - and Xi+1\n-flaps on which Spoiler applies the\n\u2032\n\u2032\n\u2032\nstrategy Si . In particular, X = Xt , X = Xt , F = Ft\u22121 , and F \u2032 = Ft\u22121\n. Note that\nXi \u2282 V (Fi ) and V (Fi ) \u2282 V (Fi+1 ).\nTracing trough the description of St , it is easy to see that, as St\u22121 is known to be\ninvoked, Spoiler can change G for G\u2032 only when invoking Sl for some q \u2264 l \u2264 t \u2212 1\nand, moreover, if l > 0, there must be Case 2.\nAssume that Spoiler selects a vertex u in F \u2032 and consider first the case that l > 0.\n\u2032\nThus, u is selected in the Xl\u2032 -flap Fl\u22121\nso that d(u, Xl\u2032) = 1. Assume that Duplicator\nresponds with v \u2208 V (G) and does not lose. Therefore d(v, Xl ) = 1 too. Notice that\nS\n\u0393(Xl ) \u2286 V (Fl ) \u222a ti=l+1 Xi . Since all vertices in the Xi 's are already occupied, we\nconclude that v \u2208 V (Fl ) \u2282 . . . \u2282 V (Ft\u22121 ) = V (F ).\nConsider now the case that l = 0. Spoiler selects u in the last round of the play on\nF0 and F0\u2032 with the strategy S0 . Recall that u is selected in F0\u2032 so that u is adjacent\nto a vertex y previously selected in F0\u2032 be Duplicator. Let x be a counterpart of\ny in F0 . Hence Duplicator is forced to select a v \u2208 V (G) that is adjacent to x.\nS\nSince \u0393(F0 ) \u2286 ti=1 Xi consists of previously occupied vertices, Duplicator loses\nanyway.\n\u2737\nDefinition 3.5 Let m be an integer and \u01eb \u2208 (0, 1). A separator sep for a class of\ngraphs C is called an m-flap \u01eb-separator if, for every G \u2208 C, there are at most m\nsep(G)-flaps and each of them has at most \u01ebn vertices.\nWe now estimate the length of the Ehrenfeucht game if Spoiler follows the strategy St , where the choice of t is optimized for our purposes.\nLemma 3.6 Suppose that C is a class of connected graphs with hereditary m-flap\n\u01eb-separator sep of size k(n), where the function k is assumed to be defined over\nreals and non-decreasing. For i \u2265 0, let the strategies Si be based on sep. If\n9\n\n\fG and G\u2032 are colored graphs such that G \u2208 color(C) and G\u2032 \u223c\n6= G, let Li (G, G\u2032 )\ndenote the minimum r such that Spoiler wins Ehrr (G, G\u2032 ) following Si , regardless\nof Duplicator's strategy. Set t = \u2308log(n/m)/ log(\u01eb\u22121 )\u2309. Then\nLt (G, G\u2032 ) <\n\nt\u22121\nX\n\nk(\u01ebi n) + m(t + 1) + log n + 2.\n\ni=0\n\nProof. Assume that H \u2208 color(C) and H \u2032 is an arbitrary connected colored\ngraph. Fix the strategy Si for Spoiler and an arbitrary strategy D for Duplicator.\nConsider the Ehrenfeucht game on H and H \u2032 in which the players follow these\nstrategies. Let li (H, H \u2032) denote the number of rounds till Spoiler wins or a position\nas in Lemma 3.1 occurs. Note first that\nl0 (H, H \u2032) \u2264 |H| + 1.\n\n(6)\n\nLet n = |H|. If n is such that k(n) \u2265 n, we have\nli (H, H \u2032) = l0 (H, H \u2032) \u2264 n + 1 \u2264 k(n) + 1.\n\n(7)\n\nOtherwise Spoiler selects all vertices of sep(H) and the further play depends on\nwhich of Cases 1 or 2 takes place. In Case 2 we have\nli (H, H \u2032 ) \u2264 k(n) + m + 1.\n\n(8)\n\nIn Case 1, suppose that the strategy Si\u22121 is invoked on subgraphs F and F \u2032 . Then\nit is easy to see that\nli (H, H \u2032) \u2264 k(n) + m + li\u22121 (F, F \u2032 )\n\n(9)\n\nand this bound exceeds the bounds (7) and (8). Notice that |F | \u2264 \u01ebn.\nAssume that G\u2032 is connected and let n = |G|. By a simple inductive argument,\n(9) and (6) imply that\n\u2032\n\nlt (G, G ) \u2264\n\nt\u22121\nX\ni=0\n\ni\n\nt\n\nk(\u01eb n) + mt + \u01eb n + 1 \u2264\n\nt\u22121\nX\n\nk(\u01ebi n) + m(t + 1) + 1,\n\ni=0\n\nwhere the latter inequality follows by the choice of t. Since Duplicator's strategy D\nwas chosen arbitrary, by the description of Si and Lemma 3.1 we have\nLt (G, G\u2032 ) \u2264 lt (G, G\u2032) + \u2308log(\u01ebn)\u2309 <\n\nt\u22121\nX\n\nk(\u01ebi n) + m(t + 1) + log n + 2.\n\ni=0\n\nIn the case that G\u2032 is disconnected, we easily have a better bound\nLt (G, G\u2032 ) \u2264 \u2308log n\u2309 + 2.\nThis completes the proof.\n\n\u2737\n10\n\n\fLemma 3.7 Suppose that C is a class of connected graphs with hereditary m-flap\n\u01eb-separator of size k, where k is a constant and \u01ebm > 1. Then for every G \u2208 C it\nholds\n!\nk+m\nD2 (G) <\n+ 1 log n + m + 2.\nlog(\u01eb\u22121 )\nProof. By Proposition 2.6, we actually have to estimate D2 (G, G\u2032 ) uniformly\nfor all G\u2032 \u223c\n6= G. We use the characterization of D2 (G, G\u2032 ) as the length of the\nEhrenfeucht game given by Proposition 2.8. We may consider G and G\u2032 colored\ngraphs (whose vertices satisfy no color relation), because the length of the game will\nobviously remain the same. As G \u2208 C, Spoiler can apply the strategy St with t as\nin Lemma 3.6. By this lemma, he wins in less than tk + m(t + 1) + log n + 2 moves\nwith\nlog(n/m)\nlog n\nt<\n+\n1\n<\n,\nlog(\u01eb\u22121 )\nlog(\u01eb\u22121 )\nthe latter inequality because \u01ebm > 1. This easily implies the bound claimed. It\nremains to notice that, following St , Spoiler makes at most 2 alternations between\nG and G\u2032 . The alternation from G to G\u2032 happens when, under the invocation of\nsome Sl , l \u2264 t, for the first time there occurs Case 2. Afterwards Spoiler goes\nback to G and wins without further invocation of Sl\u22121 and hence without further\nalternation.\n\u2737\n\n4\n\nApplication to trees and outerplanar graphs\n\nTheorem 4.1 Let d \u2265 2 be a constant. If G is a tree of maximum vertex degree d,\nthen\nD2 (G) < cd log n + d + 2,\n(10)\nwhere cd = (d + 1)/ log(3/2) + 1.\nProof. We use the well-known fact that every tree has 23 -separator of size 1 (see\ne.g. [14] Let Cd consists of all trees of degree at most d. Any separator for Cd is\nobviously hereditary, and it is easy to see that a 1-vertex separator splits a G \u2208 Cd\nin at most d flaps. Lemma 3.7 applies to Cd and implies (10).\n\u2737\nRemark 4.2 The constants cd in Theorem 4.1 are not the best possible. For example, if d = 2, the optimal constant is 1 because D1 (Pn ) < log n + 3. Indeed, if G\nis disconnected, then D1 (Pn , G) < log n + 3 by Lemma 3.1. If G is connected with\n\u2206(G) > 2, then clearly D0 (Pn , G) \u2264 4. If G = Cm , then D1 (Pn , G) \u2264 3. Finally, if\nG = Pm is another path, then D1 (Pn , G) < log n + 3 by [18, Theorem 2.1.2].\nTheorem 4.3 If G is a Hamiltonian outerplanar graph, then\nD2 (G) < c log n + 9,\nwhere c = 12/ log(3/2) + 1 < 22.\n11\n\n\fThe theorem directly follows from Lemma 3.7 and Lemma 4.5 below. It is well\nknown [13] that every outerplanar graph has 23 -separator of size 2. If a graph is in\naddition Hamiltonian, then there are obviously only 2 flaps. However, for the class\nof Hamiltonian outerplanar graphs such separator is not hereditary. Fortunately, we\nare able to extend the class of Hamiltonian outerplanar graphs to a wider class with\nhereditary constant-flap 23 -separator of constant size.\nDefinition 4.4 We will further on abbreviate the term Hamiltonian outerplanar\nas HOP. An edge-deleted HOP graph (to be abbreviated as 1-e.d.HOP) is a graph\nwhich is not HOP but becomes such after joining a pair of vertices by an edge. A\n2-edge-deleted HOP graph (to be abbreviated as 2-e.d.HOP) is a connected graph\nwhich is not 1-e.d.HOP but becomes such after joining a pair of vertices by an edge.\nLet O be the class of HOP, 1-e.d.HOP, and 2-e.d.HOP graphs.\nLemma 4.5 The class O has hereditary 7-flap 23 -separator of size 5.\nProof. We will use the fact that outerplanar graphs have 2-vertex 32 -separators.\nAssume that G \u2208 O and show the existence of an appropriate separator in G.\nProvided any separator X of G is specified, by hv1 , . . . , vq i we will denote the X-flap\ncontaining the vertices v1 , . . . , vq (if such exists).\nCase 1: G is HOP. Let {s1 , s2 } be a 23 -separator of G and C be a Hamilton cycle\nin G. For i = 1, 2, denote the neighbors of si in C by ai and bi as shown in Figure 1.\nThe separator splits G in two flaps ha1 , a2 i and hb1 , b2 i. If a1 and a2 (resp. b1 and b2 )\nare adjacent, the flap ha1 , a2 i (resp. hb1 , b2 i) is HOP, otherwise it is 1-e.d.HOP. For\nthe completeness notice the possibility that a1 = a2 or b1 = b2 , which can happen\nfor graphs on at most 6 vertices.\nCase 2: G is 1-e.d.HOP. Let {c1 , c2 } be the edge that G lacks to become a HOP\ngraph \u1e20. Let C be a Hamilton cycle of \u1e20. Given u, v \u2208 V (G), by [u, v] we will\ndenote the set of vertices on the arc of C from u to v that does not contain {c1 , c2 }\n(if such exists).\nLet {s1 , s2 } be a 32 -separator of \u1e20. If {s1 , s2 } and {c1 , c2 } intersect, {s1 , s2 }-flaps\nof G and \u1e20 are the same, and we essentially have Case 1. Assume that {s1 , s2 } and\n{c1 , c2 } are disjoint and denote the neighbors of si in C by ai and bi as in Figure 1\n(some of the vertices shown there may coincide).\nNote that [a1 , a2 ] can be connected neither to [b1 , c1 ] nor to [b2 , c2 ]. As easily\nseen, the flap ha1 , a2 i is either HOP or 1-e.d.HOP, depending on if a1 and a2 are\nadjacent. If [b1 , c1 ] and [b2 , c2 ] are connected by an edge, hb1 , c1 i = hb2 , c2 i is the\nsecond {s1 , s2 }-flap which is 1-e.d.HOP or 2-e.d.HOP, depending on the adjacency of\nb1 and b2 ; otherwise hb1 , c1 i and hb2 , c2 i are two flaps, HOP or 1-e.d.HOP depending\non the adjacency of b1 , c1 and b2 , c2 respectively.\nCase 3: G is 2-e.d.HOP. Let {c1 , c2 } and {d1 , d2 } be the edges that G lacks\nto be a HOP graph \u1e20. Let C be a Hamilton cycle of \u1e20. Given u, v \u2208 V (G), by\n[u, v] we now denote the set of vertices on the arc of C from u to v that does not\ncontain {c1 , c2 } and {d1 , d2 } (if such exists). Furthermore, [u, v) = [u, v] \\ {v} and\n(u, v] = [u, v] \\ {u}.\n12\n\n\f1\n\u2709\n\u2709\n\u2605\n\n\u2709\n\n\u2725\n\n1\n\u2709\n\u2709\n\u2605\n\n\u2709\n\n\u2709\n\u2727\n\u2709\n\n\u2709\n\n\u2726\n\n\u2709\n\u2727\n\u2709\n\n\u2709\n\na\n\na2\n\ns1 b1\n\ns2 b2\n\na2\n\nCase 1\n\nd1 \u2709\nd2 \u2709\n\n\u2709\n\ns1\n\n\u2709\n\nb1\n\n\u2709\n\n\u2709\n\n\u2709\n\ns2\n\ns2 b2\n\n\u2718\n\u2709 c1\n\u2709 c2\n\u270c\n\nCase 2\n\na1\n\na2\n\ns1 b1\n\na\n\n\u2709\n\nb2\n\na1 s\u27091 b1\u2709\n\na2 s2 b\n\u2709 \u2709 2\n\ne1 \u2709 \u2709 \u2709\n\n\u2709 c1\n\nd1 \u2709\n\n\u2709 c2\n\nd2 \u2709\n\nSubcase 3.1\n\n\u2709\n\n\u2709\n\ne2\n\n\u2709\n\nf\n\n\u2709 c1\n\u2709 c2\n\nSubcase 3.2\nFigure 1: Proof of Lemma 4.5\n\nLet {s1 , s2 } be a 23 -separator of \u1e20. If {s1 , s2 } and {c1 , c2 , d1 , d2} intersect, we\nessentially have Case 2. Assume they do not. Denote the neighbors of si in C by\nai and bi . Two different subcases, depicted in Figure 1, are possible (some of the\nvertices may coincide).\nSubcase 3.1: s1 and s2 are separated in C by the missing edges {c1 , c2 } and\n{d1 , d2 }. Note that neither [d1 , a1 ] nor [d2 , a2 ] can be connected to any of [b1 , c1 ] and\n[b2 , c2 ]. If [d1 , a1 ] is connected to [d2 , a2 ], the flap hd1 , a1 i = hd2 , a2 i is 1-e.d.HOP or\n2-e.d.HOP, depending on whether a1 and a2 are adjacent or not. Otherwise, hd1, a1 i\nand hd2 , a2 i are two flaps, each HOP or 1-e.d.HOP. All the same is true for the pair\n[b1 , c1 ] and [b2 , c2 ].\nSubcase 3.2: s1 and s2 are in C not separated by {c1 , c2 } and {d1 , d2}. Note that\n[b1 , a2 ] cannot be connected to any of [d1 , a1 ], [b2 , c1 ], and [d2 , c2 ], and that hb1 , a2 i is\na HOP or 1-e.d.HOP flap. If one of [d1 , a1 ], [b2 , c1 ], and [d2 , c2 ] is disconnected to the\nother two, then the corresponding of the components hd1 , a1 i, hb2 , c1 i, and hd2 , c2 i\nis HOP or 1-e.d.HOP, and the other two are also HOP or 1-e.d.HOP (if there is no\nedge between the corresponding arcs) or they are the same 1-e.d.HOP or 2-e.d.HOP\nflap (if a such edge exists).\nConsider now the case that one of [d1 , a1 ], [b2 , c1 ], and [d2 , c2 ] is connected to the\nother two, that is, hd1 , a1 i = hb2 , c1 i = hd2, c2 i. Without loss of generality, assume\nthat [d1 , a1 ] is connected to [d2 , c2 ]. Let e1 be the nearest to a1 vertex in [d1 , a1 ] that\nsends an edge to [d2 , c2 ]. Let e2 be the nearest to c2 vertex in [d2 , c2 ] that sends\nan edge to [d1 , a1 ]. It is not hard to see that e1 and e2 are adjacent. Assume that\n[d1 , a1 ] is connected by an edge to [b2 , c1 ] and let f be the nearest to c1 vertex in\n13\n\n\f[b2 , c1 ] sending an edge to [d1 , a1 ].\nIn addition to s1 and s2 , remove from G also e1 , e2 , and f , thereby extending\nthe separator to {s1 , s2 , e1 , e2 , f }. Then an inner edge (i.e. an edge not in C) may\nbe only between [d1 , e1 ) and [d2 , e2 ), (e1 , a1 ] and [b2 , f ), (f, c1 ] and (e2 , c2 ]. It is easy\nto see that, if [d1 , e1 ) and [d2 , e2 ) are connected by an edge, then hd1 i = hd2 i is a\n2-e.d.HOP or 1-e.d.HOP flap; otherwise hd1 i and hd2i are two flaps, each HOP or\n1-e.d.HOP (one of them may disappear if d1 = e1 or d2 = e2 ). A completely similar\nsituation is with the pairs (e1 , a1 ], [b2 , f ) and (f, c1 ], (e2 , c2 ].\nIf [d1 , a1 ] and [b2 , c1 ] are not connected by an edge, we add to the separator only\ne2 and, similarly to the above, deal with two pairs [d1 , a1 ], [d2 , e2 ) and (e2 , c2 ], [b2 , c1 ].\nIn the worst case, the separator we have constructed consists of 5 vertices and\nhas 7 flaps.\n\u2737\n\n5\n\nBounded degree graphs with separators\n\nDefinition 5.1 Let G be a graph and X \u2282 V (G). We call two X-flaps, F1 and\nF2 , similar if the identity map of X onto itself extends to an isomorphism from\nG[X \u222a V (F1 )] to G[X \u222a V (F2 )]. We say that a separator sep for a class of graphs\nC has at most s similar flaps if, for every G \u2208 C, the maximum number of pairwise\nsimilar sep(G)-flaps is bounded by s.\nAn m-flap separator obviously has at most m similar flaps, and we hence can\nexpect more classes to have separators with bounded number of similar flaps rather\nthan with bounded number of all flaps. We now modify the strategy Si so that it\nwill guarantee a fast Spoiler's win on graphs possessing separators with bounded\nnumber of similar flaps. The price will be an increase of the number of alternation\nbetween the graphs during the game.\nWe denote the modified strategy by Si\u2217 . Like Si , this is a strategy for Spoiler\nin the Ehrenfeucht game on non-isomorphic colored graphs G and G\u2032 , where G\nis a connected graph in color(C) and a class of graphs C has separator sep. The\nonly difference of Si\u2217 from Si concerns Case 2. In this case Spoiler chooses a flap\nH such that m(H) < m\u2032 (H) and during m(H) rounds selects one vertex in each\nX-flap isomorphic to H. Recall that all flaps are considered with the modified\ncoloring. Note that two X-flaps with modified colorings can be isomorphic only if\ntheir underlying graphs are similar in the sense of Definition 5.1. Thus, m(H) \u2264 s,\nwhere s is the maximum number of similar X-flaps.\nIn the next move Spoiler selects a vertex u in F \u2032 , an X \u2032 -flap isomorphic to H\nthat has not been visited by Duplicator, so that d(u, X \u2032) = 1. If Duplicator responds\nwith a vertex in an X-flap isomorphic to H, then, as this X-flap already contains\na selected vertex, Spoiler is able to apply the strategy of Lemma 3.1 and win in at\nmost \u2308log |H|\u2309 subsequent moves. If Duplicator responds with a vertex in an X-flap\nF non-isomorphic to H, then Spoiler restricts the game to F and F \u2032 and applies the\n\u2217\nstrategy Si\u22121\n. If in any round Spoiler selects a vertex in F but Duplicator replies\nwith a vertex outside F \u2032 , Spoiler switches to the strategy of Lemma 3.1 and wins in\n14\n\n\fat most \u2308log |F |\u2309 moves. If Spoiler selects a vertex in F \u2032 but Duplicator replies with\na vertex outside F , this is an immediate loss of Duplicator: Lemma 3.4 holds true\nfor Si\u2217 with literally the same proof.\nLemma 5.2 Suppose that a class of connected graphs C has hereditary \u01eb-separator\nsep of size k(n) with at most s similar flaps, where the function k is assumed to\nbe defined over reals and non-decreasing. For i \u2265 0, let the strategies Si\u2217 be based\non sep. If G and G\u2032 are colored graphs such that G \u2208 color(C) and G\u2032 \u223c\n6= G, let\n\u2032\n\u2032\nLi (G, G ) denote the minimum r such that Spoiler wins Ehrr (G, G ) following Si ,\nn\nregardless of Duplicator's strategy. Set t = \u2308(log s+1\n)/ log(\u01eb\u22121 )\u2309. Then\nLt (G, G\u2032 ) <\n\nt\u22121\nX\n\nk(\u01ebi n) + (s + 1)(t + 1) + log n + 2.\n\ni=0\n\nThe proof is almost identical to the proof of Lemma 3.6.\nLemma 5.3 Let s \u2265 2, c > 0, \u01eb, \u03b4 \u2208 (0, 1) be constants such that \u01eb(s + 1) > 1.\nSuppose that C is a class of connected graphs with hereditary \u01eb-separator having at\nmost s similar flaps and size k(n) = cn\u03b4 . Set a = 2 log n/ log(\u01eb\u22121 ) + 1. Then, for all\nG \u2208 C, it holds\n!\n\nc\ns+1\nDa (G) <\nn\u03b4 +\n+ 1 log n + s + 3.\n\u03b4\n1\u2212\u01eb\nlog(\u01eb\u22121 )\n\n(11)\n\nProof. It is easy to see that, following Si\u2217 , Spoiler during the game makes at\nmost 2i + 1 alternations between G and G\u2032 . Similarly to the proof of Lemma 3.7,\nwe conclude from Lemma 5.2 that\nD2t+1 (G) <\n\nt\u22121\nX\n\nk(\u01ebi n) + (s + 1)t + log n + s + 3,\n\ni=0\n\nwhere\nt<\n\nn\nlog s+1\nlog n\n+\n1\n\u2264\nlog(\u01eb\u22121 )\nlog(\u01eb\u22121 )\n\n(the latter inequality by the condition \u01eb(s + 1) > 1). To obtain (11), it remains to\nP\ni\n\u03b4\n\u03b4t\n\u03b4\nnotice that 2t + 1 < a and t\u22121\n\u2737\ni=0 k(\u01eb n) = cn (1 \u2212 \u01eb )/(1 \u2212 \u01eb ).\n\nSeeking for applications of Lemma\n\u221a 5.3, we consider the following classes of graphs\nfor which \u01eb-separators of size O( n) are known.\n\u221a \u221a\nPlanar graphs. An efficient construction of 23 -separators of size 2 2 n is given\n\u221a\n\u221a\nin [14]. The constant 2 2 is improved to 32 2 in [2].\nGraphs of genus g (embeddable in a surface of genus g). An efficient construction\n\u221a\nof 32 -separators of size O( gn) is given in [7].\nGraphs\nwith no Kh minor. An efficient construction of 12 -separators of size\n\u221a\nh3/2 n is given in [1].\nTo see inclusions between these classes, note that planar graphs are, in other\nwords, graphs of genus 0, and that a graph of genus g cannot have a Kh minor if\n15\n\n\fg < (h \u2212 3)(h \u2212 4)/12. The Robertson-Seymour Graph Minor Theorem implies that\nevery proper class of graphs closed under minors is, for some h, contained in the\nclass of graphs with excluded Kh minor.\nUnfortunately, for the above classes no bound o(n) for the number of similar\nflaps is possible. We therefore need to put an additional restriction.\nLemma 5.4 Let sep be a separator for a class of graphs C. Let Cd denote the\nrestriction of C to connected graphs of degree at most d. Then sep is a separator\nfor Cd with at most d similar flaps.\nProof. Suppose that G \u2208 Cd and X = sep(G). Since G is connected, all Xflaps are connected by an edge to X. Pairwise similar X-flaps, by definition, are all\nconnected by an edge to the same vertex of X. The maximum number of such flaps\nis therefore at most d.\n\u2737\nTheorem 5.5 Let H(G) denote the smallest h such that a graph G does not have\na minor Kh . Then, for every connected G,\n\u221a\n\u221a\nD2 log n+1 (G) < (2 + 2)H(G)3/2 n + (\u2206(G) + 2)(log n + 1) + 1.\n(12)\n\u221a\nIn particular, if H(G) = O(1) and \u2206(G) = O( n/ log n), then\n\u221a\nD2 log n+1 (G) = O( n).\nIf G is connected planar, then\n\u221a \u221a\n\u2206(G) + 1\n9\u221a\n2 + 3 3) n +\nD2 log n/ log(3/2)+1 (G) < (\n+ 1 log n + \u2206(G) + 3. (13)\n2\nlog(3/2)\n!\n\nIf G is connected and has genus g, then\n\u2206(G) + 1\n\u221a \u221a\nD2 log n/ log(3/2)+1 (G) < c g n +\n+ 1 log n + \u2206(G) + 3,\nlog(3/2)\n!\n\n(14)\n\nwhere c is a constant.\nProof. Let us prove the bound (12). Fix an arbitrary connected graph G\nand denote h = H(G) and d = \u2206(G). Let C(G) consists of all connected induced\nsubgraphs of G. Clearly, every graph in C(G) has degree at most d and no\n\u221a minor\n1\n3/2\nn with\nKh . By [1] and Lemma 5.4, graphs in C(G) have 2 -separators of size h\nat most d similar flaps. Since C(G) is closed under connected induced subgraphs,\nthe separator is hereditary. Thus, Lemma 5.3 applies and completes the proof. The\nbounds (13) and (14) follow in the same way from the separator theorems of [2]\nand [7].\n\u2737\n\n16\n\n\fReferences\n[1] N. Alon, P. Seymour, R. Thomas. A separator theorem for nonplanar graphs.\nJ. Am. Math. Soc. 3(4):801\u2013808 (1990).\n[2] N. Alon, P. Seymour, R. Thomas. Planar separators. SIAM J. Discrete Math.\n7(2):184\u2013193 (1994).\n[3] J.-Y. Cai, M. F\u00fcrer, N. Immerman. An optimal lower bound on the number of\nvariables for graph identification. Combinatorica 12(4):389\u2013410 (1992).\n[4] H.-D. Ebbinghaus, J. Flum. Finite Model Theory. Springer Verlag, 2nd rev.\ned. (1999).\n[5] A. Ehrenfeucht. An application of games to the completeness problem for\nformalized theories. Fundam. Math. 49:129\u2013141 (1961).\n[6] R. Fra\u0131\u0308ss\u00e9. Sur quelques classifications des systems de relations. Publ. Sci.\nUniv. Alger 1:35\u2013182 (1954).\n[7] J. R. Gilbert, J. P. Hutchinson, R. E. Tarjan. A separator theorem for graphs\nof bounded genus. J. Algorithms 5:391\u2013407 (1984).\n[8] M. Grohe, Fixed-point logics on planar graphs. In: Proc. of the Ann. Conf. on\nLogic in Computer Science 6\u201315 (1998).\n[9] M. Grohe, Isomorphism testing for embeddable graphs through definability. In:\nProc. of the 32nd ACM Ann. Symp. on Theory of Computing (STOC) 63\u201372\n(2000).\n[10] F. Harary. Graph theory. Addison-Wesley, Reading MA (1969).\n[11] N. Immerman. Descriptive complexity. Springer-Verlag (1999).\n[12] N. Immerman, D. Kozen. Definability with bounded number of bound variables.\nInformation and Computation 83:121\u2013139 (1989).\n[13] C. E. Leiserson. Area-efficient graph layouts (for VLSI). Proc. of 21st Ann.\nSymp. on Foundations of Computer Science 270\u2013281 (1980).\n[14] R.J. Lipton, R. E. Tarjan. A separator theorem for planar graphs. SIAM J.\nAppl. Math. 36:177-189 (1979).\n[15] E. Pezzoli. Computational complexity of Ehrenfeucht-Fra\u0131\u0308ss\u00e9 games on finite\nstructures. In: Proc. of the CSL'98 Conf., G. Gottlob, K. Seyr Eds. Lecture\nNotes in Computer Science 1584, Springer-Verlag, 159\u2013170 (1999).\n[16] E. Pezzoli. On the computational complexity of type-two functionals and logical\ngames on finite structures. Ph. D. thesis. Stanford University.\n\n17\n\n\f[17] O. Pikhurko, H. Veith, O. Verbitsky.\nFirst order definability of\ngraphs: tight bounds on quantifier rank. Submitted (2003). Available at\nhttp://arXiv:math.CO/0311041\n[18] J. Spencer. The strange logic of random graphs. Springer Verlag (2001).\n\n18\n\n\f"}