{"id": "http://arxiv.org/abs/1011.4715v1", "guidislink": true, "updated": "2010-11-22T02:08:34Z", "updated_parsed": [2010, 11, 22, 2, 8, 34, 0, 326, 0], "published": "2010-11-22T02:08:34Z", "published_parsed": [2010, 11, 22, 2, 8, 34, 0, 326, 0], "title": "Treatment of Incompatible Initial and Boundary Data for Parabolic\n  Equations in Higher Dimension", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.4928%2C1011.5651%2C1011.3607%2C1011.1013%2C1011.3782%2C1011.2998%2C1011.5417%2C1011.4621%2C1011.6048%2C1011.1574%2C1011.0417%2C1011.1438%2C1011.5071%2C1011.3716%2C1011.2101%2C1011.3343%2C1011.2115%2C1011.5845%2C1011.4094%2C1011.2489%2C1011.0785%2C1011.5661%2C1011.3982%2C1011.3342%2C1011.6003%2C1011.6265%2C1011.5696%2C1011.5014%2C1011.6077%2C1011.2442%2C1011.5959%2C1011.1869%2C1011.5268%2C1011.1042%2C1011.4405%2C1011.4836%2C1011.0787%2C1011.0615%2C1011.4612%2C1011.5347%2C1011.1183%2C1011.0690%2C1011.5233%2C1011.5585%2C1011.0809%2C1011.0679%2C1011.1787%2C1011.1156%2C1011.1976%2C1011.0840%2C1011.3315%2C1011.4164%2C1011.1629%2C1011.0718%2C1011.4290%2C1011.6159%2C1011.0241%2C1011.1762%2C1011.0295%2C1011.1812%2C1011.2645%2C1011.3876%2C1011.1334%2C1011.0605%2C1011.4715%2C1011.6455%2C1011.1462%2C1011.4326%2C1011.4070%2C1011.0883%2C1011.1121%2C1011.5245%2C1011.5134%2C1011.6090%2C1011.5474%2C1011.2800%2C1011.1558%2C1011.4686%2C1011.4459%2C1011.0552%2C1011.0459%2C1011.0956%2C1011.0897%2C1011.6642%2C1011.1241%2C1011.4428%2C1011.3273%2C1011.1172%2C1011.2639%2C1011.3672%2C1011.1534%2C1011.1738%2C1011.5779%2C1011.1983%2C1011.1731%2C1011.5545%2C1011.4273%2C1011.1752%2C1011.4156%2C1011.6454%2C1011.5483&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Treatment of Incompatible Initial and Boundary Data for Parabolic\n  Equations in Higher Dimension"}, "summary": "A new method is proposed to improve the numeri- cal simulation of time\ndependent problems when the initial and boundary data are not compatible.\nUnlike earlier methods limited to space dimension one, this method can be used\nfor any space dimension. When both methods are applicable (in space dimen- sion\none), the improvements in precision are comparable, but the method proposed\nhere is not restricted by dimension.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.4928%2C1011.5651%2C1011.3607%2C1011.1013%2C1011.3782%2C1011.2998%2C1011.5417%2C1011.4621%2C1011.6048%2C1011.1574%2C1011.0417%2C1011.1438%2C1011.5071%2C1011.3716%2C1011.2101%2C1011.3343%2C1011.2115%2C1011.5845%2C1011.4094%2C1011.2489%2C1011.0785%2C1011.5661%2C1011.3982%2C1011.3342%2C1011.6003%2C1011.6265%2C1011.5696%2C1011.5014%2C1011.6077%2C1011.2442%2C1011.5959%2C1011.1869%2C1011.5268%2C1011.1042%2C1011.4405%2C1011.4836%2C1011.0787%2C1011.0615%2C1011.4612%2C1011.5347%2C1011.1183%2C1011.0690%2C1011.5233%2C1011.5585%2C1011.0809%2C1011.0679%2C1011.1787%2C1011.1156%2C1011.1976%2C1011.0840%2C1011.3315%2C1011.4164%2C1011.1629%2C1011.0718%2C1011.4290%2C1011.6159%2C1011.0241%2C1011.1762%2C1011.0295%2C1011.1812%2C1011.2645%2C1011.3876%2C1011.1334%2C1011.0605%2C1011.4715%2C1011.6455%2C1011.1462%2C1011.4326%2C1011.4070%2C1011.0883%2C1011.1121%2C1011.5245%2C1011.5134%2C1011.6090%2C1011.5474%2C1011.2800%2C1011.1558%2C1011.4686%2C1011.4459%2C1011.0552%2C1011.0459%2C1011.0956%2C1011.0897%2C1011.6642%2C1011.1241%2C1011.4428%2C1011.3273%2C1011.1172%2C1011.2639%2C1011.3672%2C1011.1534%2C1011.1738%2C1011.5779%2C1011.1983%2C1011.1731%2C1011.5545%2C1011.4273%2C1011.1752%2C1011.4156%2C1011.6454%2C1011.5483&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A new method is proposed to improve the numeri- cal simulation of time\ndependent problems when the initial and boundary data are not compatible.\nUnlike earlier methods limited to space dimension one, this method can be used\nfor any space dimension. When both methods are applicable (in space dimen- sion\none), the improvements in precision are comparable, but the method proposed\nhere is not restricted by dimension."}, "authors": ["Qingshan Chen", "Zhen Qin", "Roger Temam"], "author_detail": {"name": "Roger Temam"}, "author": "Roger Temam", "arxiv_comment": "This article has been accepted for publication in Math. Comp", "links": [{"href": "http://arxiv.org/abs/1011.4715v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1011.4715v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1011.4715v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1011.4715v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:1011.4715v1 [math.NA] 22 Nov 2010\n\nArticle to appear in Math. Comp.\n\nTREATMENT OF INCOMPATIBLE INITIAL AND\nBOUNDARY DATA FOR PARABOLIC EQUATIONS IN\nHIGHER DIMENSION\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nAbstract. A new method is proposed to improve the numerical simulation of time dependent problems when the initial and\nboundary data are not compatible. Unlike earlier methods limited\nto space dimension one, this method can be used for any space\ndimension. When both methods are applicable (in space dimension one), the improvements in precision are comparable, but the\nmethod proposed here is not restricted by dimension.\n\n1. Introduction\nWhen performing large scale numerical simulations for evolutionary\nproblems, we use most often initial and boundary conditions provided\nby approximations, by other simulations, or by experimental measurements. These data may not satisfy certain compatibility conditions\nverified by the solutions; thus various modifications deemed non essential are made on the data to overcome these difficulties. Such issues\nare extensively addressed in the literature; see for instance in geophysical fluid mechanics [3] or [27] which contains many allusions to this\ndifficulty; in classical fluid mechanics, see e.g. [7, 12, 13, 15, 16]; see\nalso [1] in chemistry and [28] in a general mathematical context.\nWe want to address here a less known difficulty of \"mathematical\"\nnature which, the specialists believe, will become very important as we\nmove to high resolution methods thanks to the increase of computing\npower and memory capacity of the computers. A very simple example of such a difficulty appears when solving in space dimension one\non (0, 1), the heat equation ut \u2212 uxx = 0 with boundary conditions\nu(0, t) = u(1, t) = 0 and initial condition u(x, 0) = 1. The solution exists and is unique (for t > 0) and the analytic expressions of u are provided in the literature (see e.g. [4]). This problem is simple enough that\nit can be solved satisfactorily by numerical methods, but the solution\nDate: August 30, 2018.\n\n1\n\n\f2\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\ndoes display singularities in the corner x = 0, t = 0 and x = 1, t = 0.\nFor this problem and for general parabolic equations, it is known from\nsemi-group theory [14, 22] or by using the analyticity in time of the\nsolutions (see [11]) that certain norms of \u2202u/\u2202t grow as a power of 1/t\nwhen t \u2192 0. It is believed that such singularities will affect large scale\ncomputations as our demand for better results increases. In fact it\nhas been observed by some authors that, when using spectral methods\nfor the space discretization, the spectral accuracy is lost if nothing is\nmade to address this singularity and a series of works resulted from this\nobservation; see e.g. [2, 3, 8, 9, 10], see also [5] for a nonlinear equation.\nThe mathematical difficulty studied in detail in e.g. [18, 19, 20, 23,\n24, 25] is the following; even if the initial and boundary data of an evolution problem are given C \u221e , the solution may not be C \u221e near t = 0.\nIn fact, k compatibility conditions between the data are needed for the\nsolution to be C k near t = 0 and hence an infinite number of compatibility conditions are needed for the solution to be C \u221e . Furthermore the\ninitial and boundary conditions that are compatible form a relatively\nsmall set (in an informal sense), so that most numerical simulations\nare done with data which are not compatible, generating a loss of accuracy near t = 0 if nothing is done. In the works mentioned above,\nmethods have been proposed to address the first or the first two incompatibilities. It is believed that dealing with one or two incompatibilities\nsubstantially improve the quality of the simulation and, in any case,\ndealing with more incompatibility conditions may become impractical.\nHowever a strict limitation of these works is that the proposed methods\nonly apply to space dimension one and, to the best of our knowledge,\nthere is (there was) no method available in dimension two or larger to\naddress this difficulty.\nAs we said, past works, on the computational side, have been devoted to space dimension one. This problem has been addressed in a\nseries of articles by Flyer, Boyd, Fornberg and Swarztrauber [2, 10, 8, 9]\nwho proposed a number of remedies in space dimension one for linear\nequations. Nonlinear equations in space dimension one were considered\nin [5].\nIn these articles, the authors introduce a correction term in the linear\nand nonlinear cases by setting\n(1.1)\n\nu = v + S,\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n3\n\nwhere S absorbs the incompatibilities between the initial and boundary data up to a certain order. Now, free of incompatibilities of lower\norders (the most severe ones), v is computed by an appropriate numerical procedure, such as finite differences, the Galerkin finite element\nmethod, spectral or pseudo\u2013spectral methods. As a final step, the\noriginal solution u is recovered through (1.1). This remedy procedure\neffectively reduces the errors at the spatio\u2013temporal corners during the\nshort initial transient period.\nFor dimensions higher than one, the construction of S, to correct for\nsingularities generated at t = 0 by incompatible data, remains an open\nproblem. A method to overcome this difficulty is proposed, analyzed\nand tested in this article.\nIn this article, we intend to study, from both a theoretical and numerical point of view, the incompatibility issue for the multi-dimensional\ntime-dependent linear parabolic equation:\n\n(1.2)\n\n\uf8f1\n\uf8f4\n\uf8f2 ut \u2212 \u03bd\u25b3u = f,\nu|t=0 = u0 ,\n\uf8f4\n\uf8f3\nu|\u2202\u03a9 = g.\n\nx \u2208 \u03a9 \u2282 Rd ,\n\nt \u2208 R+ ,\n\nWe believe that our method applies to more general parabolic equation, but we restrict ourselves to equation (1.2) in this article devoted\nto feasibility.\nThe method that we propose is based on the concept of penalty.\nWe replace in (1.2) the boundary value u|\u2202\u03a9 = g by u|\u2202\u03a9 = k \u03b5 . This\nboundary value k \u03b5 which depends on a parameter \u03b5 > 0 is such that\nk \u03b5 |t=0 = u0 |\u2202\u03a9 (see equations (2.1), (2.2) below), so that the first incompatibility has disappeared. Now k \u03b5 , through a penalty procedure with\nparameter \u03b5, is forced to rapidly vary from u0 |\u2202\u03a9 at t = 0 to the desired\nvalue, namely g. This is achieved through equation (2.2); initially kt\u03b5 is\nlarge, but it becomes rapidly of order 1, and then, by the first equation\n(2.2), k \u03b5 \u2212 g is of order \u03b5. It is easy of course to integrate equation\n(2.2) although an explicit solution is not available in the general case\nwhere g depends on time. The concept of penalty has been introduced\nin the mathematical literature by R. Courant [6]; it has been adapted\nto evolution problems by J. L. Lions in [21], a reference which contains\nmany evolution equations similar to (2.2) (Chapter 3, Sections 5 to 8);\n\n\f4\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nit is widely used in optimization 1; see also [26] (Chapter 1, Section\n6). In this work, we firstly present our approach in details and study\nit theoretically to prove the strong convergence of the method. Then\nwe implement it numerically on a number of examples. Because the\npenalty method does not depend on the properties of \u03a9, we believe\nthat this method can be applied to many systems with many different\ndomains \u03a9. The question that remains is the choice of \u03b5 > 0 small. In\noptimization theory, the choice of \u03b5 is usually made by trial and error\nand is not a major issue. It does not follow the \"intuitive\" idea that\nthe error becomes smaller as \u03b5 becomes smaller because of many other\ncontingent errors such as round-off and descretization errors. In general\nthe error becomes \"optimal\" for some value of \u03b5 and the method gives\nless good results for smaller or larger values of \u03b5. In our case (see Fig.\n6 and 7), at the initial steps, the error decreases sharply as \u03b5 increases\nand remains close to 0, then it becomes stable flat. At the final steps,\nthe error increases almost linearly as \u03b5 increases. With \u03b5 at about 0.1,\nthe initial error is minimized while the error at the final step is well\ncontrolled. In a short time period \u03b5 = 0.5 gives us smaller errors and\nagain after a short time period \u03b5 = 0.1 gives us a smaller errors. In\ngeneral the choice of \u03b5 really depends on our goals of the computation.\nThis article is organized as follows. In Section 2 we present the\nmethod and establish various approximation results. Then, in Section\n3 we present numerical results showing the efficiency of the method\nand comparing it to earlier methods. In Section 4 we present some\nconclusions and perspective of future developments.\n\n2. penalty method\n2.1. Perturbed problem (and the statement of the main result). We consider the system (1.2), where \u03bd > 0. If u0 |\u2202\u03a9 6= g(0),\nthen we face an incompatibility problem, in which case we consider a\nnew system instead, namely, for \u03b5 > 0 fixed,\n\uf8f1 \u03b5\n\u03b5\nx \u2208 \u03a9 \u2282 Rd , t \u2208 R+ ,\n\uf8f4\n\uf8f2 ut \u2212 \u03bd\u25b3u = f,\nu\u03b5 |t=0 = u0 ,\n(2.1)\n\uf8f4\n\uf8f3 \u03b5\nu |\u2202\u03a9 = k \u03b5 .\n1A search on Google with the words \"optimization, penalty\" produced 3,350,000\nentries.\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n\uf8f1\n\uf8f2 k \u03b5 + 1 (k \u03b5 \u2212 g) = 0,\nt\n\u03b5\n\uf8f3 k \u03b5 (0) = u | .\n\n(2.2)\n\n5\n\nt \u2208 R+ ,\n\n0 \u2202\u03a9\n\nIn this article, | * | is the L2 (\u03a9) norm, and k * k= |\u2207 * | is the H01 (\u03a9)\nnorm; for other norms, we will use the subscript notation.\nThe system (2.1)-(2.2) is actually decoupled and (2.2) is just an\nOrdinary Differential Equation with x \u2208 \u2202\u03a9 as a parameter. As we\n\u2202g\n1\nsee below, if we are given g, g \u2032 =\n\u2208 L2 (0, T ; H 2 (\u0393)), then we\n\u2202t\n1\nhave the existence and uniqueness of k \u03b5 in L2 (0, T ; H 2 (\u0393)) and furthermore, by the effect of the penalty term, (k \u03b5 \u2212 g)/\u03b5, k \u03b5 converges to\ng in suitable spaces as \u03b5 \u2192 0. Equations (2.1) is a heat equation with\nnon\u2013homogeneous boundary conditions, and we have the existence and\nuniqueness of a solution if the data are sufficiently regular. Then we\nhave the following theorem.\n1\n\nTheorem 2.1. Assume that we are given g \u2208 L\u221e (0, T ; H 2 (\u0393)) (\u0393 =\n1\n\u2202\u03a9), with gt \u2208 L2 (0, T ; H 2 (\u0393)), and u0 \u2208 H 1(\u03a9). Then (1.2) has a\nunique solution u \u2208 L2 (0, T ; H01(\u03a9)) \u2229 C([0, T ]; L2 (\u03a9)), and for each\n\u03b5 > 0, (2.1)-(2.2) has a unique solution u\u03b5 \u2208 L2 (0, T ; H 1(\u03a9))\u2229 C([0, T ];\n1\nL2 (\u03a9)), k \u03b5 \u2208 L2 (0, T ; H 2 (\u0393)). Furthermore, as \u03b5 \u2192 0,\n(2.3)\n\nu\u03b5 \u2192 u in L2 (0, T ; H \u22121(\u03a9)) strongly, and in\n\nC([t0 , T ]; H \u22122(\u03a9)) strongly, \u2200t0 > 0.\n\nRemark 2.1. We do not prove a strong convergence of u\u03b5 to u on all\nof [0, T ] in the L\u221e sense, and we do not expect such a convergence\nto occur since u has a singularity at t = 0. Alternatively one could\ncapture the singularity of u near t = 0 by using the methods of singular\nperturbation theory as in, e.g. Jung-Temam [17], which we do briefly\nin Section 2.3, and will also be studied elsewhere.\nBefore we prove Theorem 2.1, we will first prove the following lemma.\n1\n\n1\n\nLemma 2.1. If g \u2208 L\u221e (0, T ; H 2 (\u0393)) and g \u2032 \u2208 L2 (0, T ; H 2 (\u0393)),\n1\nthen there exists a unique k \u03b5 in L2 (0, T ; H 2 (\u0393)) satisfying (2.2), and\n1\n\u03b5\n2\n2\nas\nZ \u03b5 \u2192 0, k \u2192Z g in L (0, T ; H (\u0393)) strongly. Furthermore, as \u03b5 \u2192 0,\nt\n\n0\n\nt\n\nk \u03b5 (s)ds \u2192\n\n1\n\ng(s)ds in L2 (0, T ; H 2 (\u0393)) strongly.\n\ns\n\n\f6\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nProof. We explicitly solve the ODE system (2.2), and we obtain the\n1\nsolution k \u03b5 \u2208 L2 (0, T ; H 2 (\u0393)):\nZ t\ns\u2212t\n1\n\u03b5\n\u2212 \u03b5t \u03b5\n(2.4)\nk (t) = e k (0) +\ng(s)e \u03b5 ds.\n0 \u03b5\nThen we rewrite (2.2)1 in the form\n\n1\n(k \u03b5 \u2212 g)t + (k \u03b5 \u2212 g) = \u2212gt .\n\u03b5\n\n(2.5)\n\n1\n\nTaking the scalar product of (2.5) with k \u03b5 \u2212 g in H 2 (\u0393), we obtain\n1\n1d \u03b5\n|k \u2212 g|2 1 + |k \u03b5 \u2212 g|2 1 = \u2212(gt , k \u03b5 \u2212 g)\nH 2 (\u0393) \u03b5\nH 2 (\u0393)\n2 dt\n\u2264 |gt |H 21 (\u0393) |k \u03b5 \u2212 g|H 21 (\u0393)\n\n1\n\u03b5\n\u2264 |gt |2 1 + |k \u03b5 \u2212 g|2 1 .\n2\nH 2 (\u0393)\n2 H (\u0393) 2\u03b5\n\nHence\n1\nd \u03b5\n|k \u2212 g|2 1 + |k \u03b5 \u2212 g|2 1 \u2264 \u03b5|gt |2 1 .\n2\n(\u0393)\nH 2 (\u0393)\nH\nH 2 (\u0393)\ndt\n\u03b5\n\n(2.6)\n\nUsing the Gronwall inequality we obtain\n(2.7)\n\n|k \u03b5 \u2212 g|2\n\nt\n\n1\nH 2 (\u0393)\n\n(t) \u2264 e\u2212 \u03b5 |k \u03b5 \u2212 g|2\n\n1\n\nH 2 (\u0393)\n\n(0) + \u03b5|gt |2 2\n\n1\n\nL (0,T ;H 2 (\u0393))\n\n.\n\nWe integrate (2.7) over (0, T ), and we obtain (u0 \u2208 H 1 (\u03a9) 2)\n(2.8)\nZ T\n|k \u03b5 \u2212 g|2\n0\n\n1\nH 2 (\u0393)\n\nand hence\n\nT\n\ndt \u2264 \u03b5(1 \u2212 e\u2212 \u03b5 ) u0 |\u0393 \u2212 g(0)\n\n2\nH\n\n1\n2 (\u0393)\n\n+ \u03b5T |gt|2 2\n\n1\n\nL (0,T ;H 2 (\u0393))\n\n,\n\n\u221a\n|k \u03b5 \u2212 g|L2 (0,T ;H 12 (\u0393)) = O( \u03b5),\n\nwhich implies\n(2.9)\n\n1\n\nk \u03b5 \u2192 g strongly in L2 (0, T ; H 2 (\u0393)) as \u03b5 \u2192 0.\n\n2We do not address the question of minimal regularity of u , that is e.g. u \u2208\n0\n0\nL2 (\u03a9), which is not in the scope of this article. Indeed the problem of incompatible\ndata occurs already with very smooth data.\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n7\n\nIntegrating (2.5) from 0 to t, we obtain\nZ t\n(2.10)\n(k \u03b5 \u2212 g)ds = \u2212\u03b5(k \u03b5 \u2212 g)(t) \u2212 \u03b5g(t) + \u03b5u0 |\u2202\u03a9 ,\n0\n\nwhich yields\n(2.11)\nZ\nt\n\n\u03b5\n\n0\n\nk (s)ds \u2192\n\nZ\n\nt\n0\n\n1\n\ng(s)ds strongly in L2 (0, T ; H 2 (\u0393)) as \u03b5 \u2192 0.\n\nThe proof of Lemma 2.1 is complete.\n\u0003\n\u03b5\n\nZ\n\nt\n\nRemark 2.2. We could prove a stronger result namely, k \u2192 g,\nk \u03b5 (s)ds\n0\nZ t\n1\n\u2192\ng(s)ds strongly in Lq (0, T ; H 2 (\u0393)), for all 1 \u2264 q < \u221e. But in\n0\n\nthis article, q = 2 is enough for our needs. And for q = \u221e, from (2.7),\nwe obtain\n\u221a\n1\n(2.12)\nk \u03b5 \u2212 g = O( \u03b5) in L\u221e (t0 , T ; H 2 (\u0393)) f or \u2200t0 > 0,\n1\n\nand also from (2.10), because k \u03b5 \u2212g and g are bounded in L\u221e (0, T ; H 2 (\u0393)),\nwe obtain\nZ t\nZ t\n1\n\u03b5\n(2.13)\nk (s)ds \u2192\ng(s)ds strongly in L\u221e (0, T ; H 2 (\u0393)),\n0\n\n0\n\nthe norm of the difference being of order \u03b5.\n2.2. Convergence results for u\u03b5 . Since \u03a9 is smooth, there exists a\n1\nlifting operator L, linear continuous from H 2 (\u0393) to H 1 (\u03a9). We consider such an operator and set K \u03b5 = L(k \u03b5 ), G = L(g), and thus have\nby assumption G \u2208 L\u221e (0, T ; H 1(\u03a9)), Gt \u2208 L2 (0, T ; H 1(\u03a9)). So we\nimmediately infer from (2.9), (2.11), (2.12) and (2.13) that, as \u03b5 \u2192 0\n(2.14)\nK \u03b5 \u2192 G strongly in L2 (0, T ; H 1(\u03a9)) \u2229 L\u221e (t0 , T ; H 1(\u03a9)) \u2200t0 > 0,\n(2.15)\n\nZ\n\n0\n\nt\n\u03b5\n\nK (s)ds \u2192\n\nZ\n\nt\n\nG(s)ds strongly in L\u221e (0, T ; H 1(\u03a9)).\n\n0\n\nWe now prove Theorem 2.1.\nProof of Theorem 2.1. Set v \u03b5 = u\u03b5 \u2212 K \u03b5 ; then the system (2.1)\nyields\n\n\f8\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\n\uf8f1 \u03b5\n\u03b5\n\u03b5\n\u03b5\n\uf8f4\n\uf8f2 vt \u2212 \u03bd\u25b3v = f \u2212 Kt + \u03bd\u25b3K ,\nv \u03b5 |t=0 = u0 \u2212 K \u03b5 (0) = u0 \u2212 Lu0 |\u2202\u03a9 ,\n\uf8f4\n\uf8f3 v \u03b5 | = 0.\n\n(2.16)\n\n\u2202\u03a9\n\nIntegrating (2.16)1 from 0 to t, we obtain\n(2.17)\nZ t\nZ t\nZ t\n\u03b5\n\u03b5\n\u03b5\nv (t) \u2212 \u03bd\u25b3\nv (s)ds =\nf (s)ds \u2212 K (t) + \u03bd\u25b3\nK \u03b5 (s)ds + u0 .\n0\n\n\u03b5\n\nWe set V =\n\n0\n\nZ\n\n0\n\nt\n\u03b5\n\n\u03b5\n\nv (s)ds (withV (0) = 0), and F (t) =\n\n0\n\nZ\n\nt\n\nf (s)ds+u0;\n0\n\nso V \u03b5 solves the following system\n\uf8f1\nZ t\n\uf8f4\n\u03b5\n\u03b5\n\u03b5\n\uf8f4\nK \u03b5 (s)ds,\n\uf8f4\n\uf8f2 Vt \u2212 \u03bd\u25b3V = F \u2212 K + \u03bd\u25b3\n0\n(2.18)\n\u03b5\nV\n|\n=\n0,\n\uf8f4\nt=0\n\uf8f4\n\uf8f4\n\uf8f3 \u03b5\nV |\u2202\u03a9 = 0.\n\nWe take the scalar product of (2.18)1 with V \u03b5 in L2 (\u03a9) and find,\n(2.19)\nZ t\n1d \u03b52\n\u03b5 2\n\u03b5\n\u03b5\n\u03b5\n|V | + \u03bd k V k = (F, V ) \u2212 (K , V ) + \u03bd(\u25b3\nK \u03b5 (s)ds, V \u03b5 ).\n2 dt\n0\n\nWe can bound the terms in the right-hand-side of (2.19) as follows:\n\u03bd\n(2.20)\n(F, V \u03b5 ) \u2264 |F ||V \u03b5 | \u2264 c1 |F | k V \u03b5 k\u2264 c\u20321 |F |2 + k V \u03b5 k2 ,\n6\n(2.21) \u2212 (K \u03b5 , V \u03b5 ) \u2264 |K \u03b5 ||V \u03b5 | \u2264 c1 |K \u03b5 | k V \u03b5 k\u2264 c\u20322 |K \u03b5 |2 +\n\u03bd(\u25b3\n\nZ\n\n0\n\n(2.22)\n\nt\n\u03b5\n\n\u03b5\n\nZ\n\n\u03bd\nk V \u03b5 k2 ,\n6\n\nt\n\nK (s)ds, V ) = \u2212\u03bd(\u2207\nK \u03b5 (s)ds, \u2207V \u03b5 )\n0\nZ t\n\u2264\u03bdk\nK \u03b5 (s)ds kk V \u03b5 k\n0\nZ t\n\u03bd\n\u03b5 2\n\u2032\nK \u03b5 (s)ds k2 .\n\u2264 k V k +c3 k\n6\n0\n\nHere and below, the c, c\u2032 , ci , c\u2032i are various constants independent of\n\u03b5, which may be different at different places.\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n9\n\nCombining (2.19), (2.20), (2.21) and (2.22) gives\nd \u03b52\n|V | + \u03bd k V \u03b5 k2 \u2264 c\u20321 |F |2 + c\u20322 |K \u03b5 |2 + c\u20323 k\n(2.23)\ndt\n\nZ\n\nt\n\nK \u03b5 (s)ds k2 .\n\n0\n\nIntegrating (2.23) over (0, t), we obtain\n\u03b5\n\n(2.24)\n\n2\n\n|V (t)| + \u03bd\n\nZ\n\nt\n\u03b5\n\n0\n\n2\n\nk V k ds \u2264\n\n+ c\u20323\n\nt\n\nZ\n\nc\u20321\n\nZ\n\n2\n\n0\nt\n\n0\n\nZ\n\nt\n\n|F | ds +\n|K \u03b5 |2 ds\n0\nZ s\nk\nK \u03b5 (\u03c4 )d\u03c4 k2 ds.\nc\u20322\n\n0\n\nWe also integrate (2.23) over (0, T ), and obtain\n\u03b5\n\n(2.25)\n\n2\n\n|V (T )| + \u03bd\n\nZ\n\n0\n\nT\n\u03b5\n\n2\n\nk V k ds \u2264\n\nc\u20321\n\n+ c\u20323\n\nZ\n\nZ\n\nT\n\n0\nT\n\n0\n\nZ\n\nT\n\n|K \u03b5 |2 ds\n|F | ds +\n0\nZ s\nk\nK \u03b5 (\u03c4 )d\u03c4 k2 ds.\n\nIt follows from (2.14) and (2.15) that K \u03b5 and\n\n2\n\nc\u20322\n\n0\n\nZ\n\nt\n\nK \u03b5 (s)ds are bounded\n\n0\n\nin L2 (0, T ; H 1(\u03a9)), and thus (2.24), (2.25) yields:\n(2.26)\nV \u03b5 remains bounded in L\u221e (0, T ; L2 (\u03a9))\u2229L2 (0, T ; H01(\u03a9)) as \u03b5 \u2192 0.\n\u2032\n\nThus, there exists a subsequence V \u03b5 and V \u2208 L\u221e (0, T ; L2(\u03a9))\u2229L2 (0, T ;\nH01 (\u03a9)) such that, as \u03b5\u2032 \u2192 0,\n(2.27)\n\n\u2032\n\nV \u03b5 \u2192 V weakly in L2 (0, T ; H01(\u03a9)),\nand weak \u2212 star in L\u221e (0, T ; L2 (\u03a9)).\n\nUsing (2.14), (2.15) and (2.27), we can pass to the limit in (2.16)\nwith the sequence \u03b5\u2032 \u2192 0. We proceed as follows.\nFor all a \u2208 H01 (\u03a9), and \u03c6 in C 1 (0, T ) with \u03c6(T ) = 0, we multiply\n(2.18)1 by a\u03c6 and integrate over \u03a9 \u00d7 (0, T ); we obtain\n(2.28)\nZ T\nZ T\nZ T\n\u03b5\u2032\n\u2032\n\u03b5\u2032\n\u2212\n(V , a)\u03c6 (t)dt + \u03bd\n(\u2207V , \u2207a)\u03c6(t)dt =\n(F, a)\u03c6(t)dt\n0\n0\n0\nZ T\nZ T\nZ t\n\u2032\n\u03b5\u2032\n\u2212\n(K , a)\u03c6(t)dt \u2212 \u03bd\n(\u2207\nK \u03b5 (s)ds, \u2207a)\u03c6(t)dt.\n0\n\n0\n\n0\n\n\f10\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nPassing to the limit with (2.14), (2.15), (2.27), we find\n(2.29)\nZ T\nZ T\nZ T\n\u2032\n\u2212\n(V, a)\u03c6 (t)dt + \u03bd\n(\u2207V, \u2207a)\u03c6(t)dt =\n(F, a)\u03c6(t)dt\n0\n0\n0\nZ T\nZ T\nZ t\n\u2212\n(G, a)\u03c6(t)dt \u2212 \u03bd\n(\u2207\nG(s)ds, \u2207a)\u03c6(t)dt.\n0\n\n0\n\n0\n\nTaking \u03c6 \u2208 D(0, T ), we see that V satisfies\n(2.30)\nZ t\n(Vt , a) \u2212 \u03bd(\u25b3V, a) = (F \u2212 G + \u03bd\u25b3\nG(s)ds, a),\n0\n\n\u2200 a \u2208 H01 (\u03a9).\n\nNow we want to show that V (0) = 0.\nWe classically integrate (2.30) times \u03c6(t) over (0, T ) and we obtain:\n(2.31)\nZ T\nZ T\nZ T\nZ t\n\u2032\n\u2212\n(V, a)\u03c6 (t)dt + \u03bd\n(\u2207V, \u2207a)\u03c6(t)dt =\n(\u03bd\u25b3\nG(s)ds, a)\u03c6(t)dt\n0\n0\n0\n0\nZ T\n+\n(F \u2212 G, a)\u03c6(t)dt + (V (0), a)\u03c6(0).\n0\n\nBy comparing with (2.29), we find that\n(2.32)\n\n(V (0), a)\u03c6(0) = 0,\n\nfor every a \u2208 H01 (\u03a9) and every \u03c6 \u2208 C 1 ([0, T ]) with \u03c6(T ) = 0. This\nimplies V (0) = 0 as desired. Finally V satisfies\n\uf8f1\nZ t\n\uf8f4\n\uf8f4\nG(s)ds,\n\uf8f4\n\uf8f2 Vt \u2212 \u03bd\u25b3V = F \u2212 G + \u03bd\u25b3\n0\n(2.33)\nV |t=0 = 0,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\nV |\u2202\u03a9 = 0.\n\nRemark 2.3. Furthermore, we could prove that the whole sequence\nV \u03b5 \u2192 V weakly in L2 (0, T ; H01(\u03a9)), and weak star in L\u221e (0, T ; L2 (\u03a9)).\nIndeed, if not, arguing by contradiction, we could find a subsequence\n\u03b5i \u2192 0, such that\n(2.34)\n\nV \u03b5i 9 V in L2 (0, T ; H01(\u03a9)) weakly,\n\nL\u221e (0, T ; L2 (\u03a9)) weak \u2212 star.\n\nRepeating the argument above leading to (2.27), we could extract from\n\u03b5i a subsequence \u03b5\u2032i and find V\u0304 such that, as \u03b5\u2032i \u2192 0,\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n11\n\n\u2032\n\nV \u03b5i \u2192 V\u0304 in L2 (0, T ; H01(\u03a9)) weakly,\n\n(2.35)\n\nL\u221e (0, T ; L2 (\u03a9)) weak \u2212 star,\n\nwhere V\u0304 is the solution of (2.33). But the solution of (2.33) is unique;\nhence V = V\u0304 , and then (2.35) contradicts (2.34).\nBefore we finish the proof of the theorem, we now prove the following\nLemma.\nLemma 2.2 Under the assumptions of Theorem 2.1, with V, V \u03b5 being\nthe solutions of (2.33) and (2.18), we have, as \u03b5 \u2192 0,\n(2.36)\n\nV \u03b5 \u2192 V strongly in L2 (0, T ; H01(\u03a9)) \u2229 C([0, T ]; L2 (\u03a9)).\n\nProof. We subtract (2.18)1 from (2.33)1 , and obtain\n(2.37)\nZ t\nZ t\n\u03b5\n\u03b5\n\u03b5\nVt \u2212 Vt \u2212 \u03bd(\u25b3V \u2212 \u25b3V ) = K \u2212 G + \u03bd(\u25b3\nG(s)ds \u2212 \u25b3\nK \u03b5 (s)ds).\n0\n\n0\n\nWe then take the scalar product of (2.37) with V \u2212 V \u03b5 in L2 (\u03a9), and\nintegrate in time from 0 to t, and we obtain:\n(2.38)\nZ t\nZ t\n1\n\u03b5\n2\n\u03b5 2\n|(V \u2212 V )(t)| + \u03bd\nk V \u2212 V k ds =\n(K \u03b5 \u2212 G, V \u2212 V \u03b5 )ds\n2\n0\n0\nZ t\nZ t\nZ t\n(\u03bd\u25b3\nG(s)ds \u2212 \u03bd\u25b3\nK \u03b5 (s)ds, V \u2212 V \u03b5 )ds.\n0\n\n0\n\n0\n\nNow we set\n(2.39)\n\n1\n\u03bd\n\u03c7\u03b5 (t) = |(V \u2212 V \u03b5 )(t)|2 +\n2\n2\n\nZ\n\nt\n0\n\nk V \u2212 V \u03b5 k2 ds,\n\nand estimate the right-hand-side of (2.38) as follows:\n(2.40)\nZ t\nZ t\n\u03b5\n\u03b5\n(K \u2212 G, V \u2212 V )ds \u2264\n|K \u03b5 \u2212 G||V \u2212 V \u03b5 |ds\n0\n0\nZ t\n\u2264 c1\n|K \u03b5 \u2212 G| k V \u2212 V \u03b5 k ds\n0\nZ t\nZ T\n1\n1\n\u03b5\n2\nk V \u2212 V \u03b5 k2 ds) 2\n\u2264 c1 (\n|K \u2212 G| ds) 2 (\n0\n0\nZ t\nZ T\n\u03bd\nk V \u2212 V \u03b5 k2 ds,\n\u2264c\n|K \u03b5 \u2212 G|2 ds +\n4 0\n0\n\n\f12\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\n(2.41)\nZ t\n\nZ\n\ns\n\nZ\n\ns\n\nG(\u03c4 )d\u03c4 \u2212 \u25b3\nK \u03b5 (\u03c4 )d\u03c4, V \u2212 V \u03b5 )ds\n0\n0\nZ t Z s\n\u2264\u03bd\nk\n(G(\u03c4 ) \u2212 K \u03b5 (\u03c4 ))d\u03c4 kk V \u2212 V \u03b5 k ds\n0\n0\nZ T Z s\nZ\n\u03bd t\n\u2032\n\u03b5\n2\n\u2264c\nk\n(G \u2212 K )(\u03c4 )d\u03c4 k ds +\nk V \u2212 V \u03b5 k2 ds.\n4\n0\n0\n0\n\n\u03bd(\u25b3\n\n0\n\nCombining (2.40) and (2.41), we see that\nZ T Z s\nZ\n\u2032\n\u03b5\n2\n(2.42) \u03c7\u03b5 (t) \u2264 c\nk\n(G \u2212 K )(\u03c4 )d\u03c4 k ds + c\n0\n\n0\n\n0\n\nT\n\n|K \u03b5 \u2212 G|2 ds\n\nThe right-hand side of (2.42) converges to 0 as \u01eb converges to 0,\nbecause of (2.14) and (2.15), and so does \u03c7\u03b5 (t). For t = T , we find\nV \u03b5 \u2192 V strongly in L2 (0, T ; H01(\u03a9)) as \u03b5 \u2192 0,\n\n(2.43)\n\nand taking the supreme of (2.42) with respect to t, we see that\nV \u03b5 \u2192 V strongly in L\u221e (0, T ; L2 (\u03a9)) as \u03b5 \u2192 0.\n\n(2.44)\n\nThe lemma is proved.\n\n\u0003\n\nNow we apply Lemma 2.2 and obtain as \u03b5 \u2192 0,\n(2.45)\n\u25b3V \u03b5 \u2192 \u25b3V strongly in L2 (0, T ; H \u22121(\u03a9)) \u2229 C([0, T ]; H \u22122(\u03a9)),\nand from (2.15), we obtain as \u03b5 \u2192 0,\n(2.46) Z\nZ t\nt\n\u03b5\n\u25b3\nK (s)ds \u2192 \u25b3\nG(s)ds strongly in L\u221e (0, T ; H \u22121(\u03a9)),\n0\n\n0\n\nso after comparing (2.18)1 with (2.33)1 , we conclude that as \u03b5 \u2192 0,\n(2.47)\n\nVt\u03b5 \u2192 Vt strongly in L2 (0, T ; H \u22121(\u03a9)) and\n\nC([t0 , T ]; H \u22122) f or \u2200t0 > 0.\n\nNow we define v = Vt , and take the derivative on (2.33)1 , we obtain\nthat v solves the following system,\n\uf8f1\n\uf8f4\n\uf8f2 vt \u2212 \u03bd\u25b3v = f \u2212 Gt + \u03bd\u25b3G,\nv|t=0 = u0 \u2212 G(0),\n(2.48)\n\uf8f4\n\uf8f3 v| = 0.\n\u2202\u03a9\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n13\n\nSo (2.47) yields as \u03b5 \u2192 0,\n(2.49)\n\nv \u01eb \u2192 v strongly in L2 (0, T ; H \u22121(\u03a9)) and\n\nC([t0 , T ]; H \u22122) f or \u2200t0 > 0.\n\nThe final stage of the proof of Theorem 2.1 consists in reinterpreting\nthe results above that is (2.14), (2.15) and (2.49) in terms of the convergence of u\u03b5 = v \u03b5 + K \u03b5 towards u = v + G; we obtain precisely (2.3).\nTheorem 2.1 is proven.\n\u0003\nRemark 2.4. Similarly as Remark 2.2, we see that we also have u\u03b5 \u2192 u\nstrongly in Lq (0, T ; H \u22121(\u03a9)) for all 1 \u2264 q < \u221e.\n2.3. Boundary layer analysis for k \u03b5 . In the previous section, Lemma\n2.1 stated that under our assumptions, k \u03b5 strongly converges to g in\n1\nL2 (0, T ; H 2 (\u0393)), as \u03b5 \u2192 0. Here in order to better compare k \u03b5 and g,\nwe are going to study the boundary layer for the system (2.2).\nAlong the asymptotic analysis, we define the outer expansion k \u03b5 \u223c\n\n\u221e\nX\n\n\u03b5j k j . By formal identification at each power of \u03b5, we obtain\n\nj=0\n\n(2.50)\n\nk 0 = g,\n\nO(\u03b5\u22121) :\n\nktj + k j+1 = 0, \u2200j \u2265 0.\n\nO(\u03b5j ) :\n\nBy explicit calculations, we find:\nk j = (\u22121)j g (j) , \u2200j \u2265 0.\n\n(2.51)\n\nIt is clear that the functions k j of the outer expansion do not generally satisfy the initial condition in (2.2) in the case of interest here where\ng(0) 6= u0 |\u2202\u03a9 . To account P\nfor this discrepancy, we classically introduce\n\u03b5\nj j\nj\nj\nthe inner expansion k \u223c \u221e\nj=0 \u03b5 \u03b8 , where \u03b8 = \u03b8 (t), (t = t/\u03b5). Then\nwe find\n\u221e\nX\nj=0\n\n\u03b5\n\nj d\u03b8\n\nj\n\ndt\n\n+\n\n\u221e\nX\n\n\u03b5j \u03b8(t) = 0.\n\nj=0\n\nBy formal identification at each power of \u03b5, we obtain the following\nequations:\n(2.52)\n\nd\u03b8j\n+ \u03b8j (t) = 0, f or j \u2265 0.\ndt\n\n\f14\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nThe initial conditions that we choose are:\n\u03b80 (0) = u0 |\u2202\u03a9 \u2212 g(0),\n(2.53)\n\u03b8j (0) = \u2212k j (0) = (\u22121)j+1 g (j)(0), f or j \u2265 1.\nBy explicit calculations, we obtain:\nt\n\n\u03b8j = e\u2212 \u03b5 \u03b8j (0), f or j \u2265 0.\n\n(2.54)\n\nTo obtain the asymptotic error estimate, we set\nw\u03b5n = k \u03b5 \u2212 k\u03b5n \u2212 \u03b8\u03b5n ,\n\n(2.55)\nwhere\nk\u03b5n =\n\nn\nX\n\nj j\n\n\u03b5 k , \u03b8\u03b5n =\n\nj=0\n\nn\nX\n\n\u03b5j \u03b8 j .\n\nj=0\n\nNow we can conclude as follows.\n\n1\n\nTheorem 2.2 If g (n+1) \u2208 L2 (0, T ; H 2 (\u0393)) for n \u2265 0, and w\u03b5n is\ndefined in (2.55), then as \u03b5 \u2192 0\n1\n\nw\u03b5n = O(\u03b5n+1) in L2 (0, T ; H 2 (\u0393)),\n\n(2.56)\n\n1\n\n1\n\nw\u03b5n = O(\u03b5n+ 2 ) in L\u221e (0, T ; H 2 (\u0393)).\n\nProof. We firstly notice that w\u03b5n vanishes at t = 0. We insert then\n(2.55) into (2.2), and we find:\n(\n\u03b5(w\u03b5n )t + w\u03b5n = \u03b5n+1(\u22121)n+1 g (n+1) ,\n(2.57)\nw\u03b5n |t=0 = 0.\n1\n\nWe take the H 2 (\u0393) scalar product of (2.57)1 with w\u03b5n and integrate\nover [0, t]; we obtain\nZ t\nZ t\n\u03b5\n2\n2\n|w\u03b5n (s)| 1 ds =\n((\u2212\u03b5)n+1 g (n+1) , w\u03b5n )H 21 (\u0393) ds\n|w\u03b5n (t)| 1 +\n2 (\u0393)\nH\nH 2 (\u0393)\n2\n0\n0\nZ\nZ\n\u03b52(n+1) t (n+1)\n1 t\n2\n|w\u03b5n (s)| 12 ds +\n|g\n(s)|2 21 ds,\n\u2264\nH\nH (\u0393)\n(\u0393)\n2 0\n2\n0\n(2.58)\nZ T\nZ t\n2\n2(n+1)\n2\n\u03b5|w\u03b5n (t)| 1 +\n|g (n+1) (s)|2 1 ds.\n|w\u03b5n (s)| 1 ds \u2264 \u03b5\nH 2 (\u0393)\n\n0\n\nH 2 (\u0393)\n\n0\n\nH 2 (\u0393)\n1\n\nIf we set t = T in (2.58), we obtain w\u03b5n = O(\u03b5n+1) in L2 (0, T ; H 2 (\u0393)),\nand if we take the supremum of (2.58) over [0, T ], we obtain w\u03b5n =\n1\n1\nO(\u03b5n+ 2 ) in L\u221e (0, T ; H 2 (\u0393)).\nTheorem 2.3 has been proved.\n\u0003\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n15\n1\n\nRemark 2.5. If we additionally assume that gtt \u2208 L2 (0, T ; H 2 ) in Theorem 2.1, from (2.56), setting n = 1, we find\nw\u03b51 = k \u01eb \u2212 g + \u01ebgt \u2212 (u0 |\u2202\u03a9 \u2212 g(0))e\u2212t/\u03b5 + \u03b5gt (0)e\u2212t/\u03b5 = O(\u03b53/2 ),\n1\nin L\u221e (0, T ; H 2 (\u0393)). Then for any t0 > 0,\n(k \u03b5 \u2212 g)(t0 ) = \u2212\u03b5gt (t0 ) + O(\u03b53/2 ) + e.s.t.,\nwhere e.s.t. means exponentially small term (for all H m -norms).\nHence |(k \u03b5 \u2212g)(t0 )|H 21 = O(\u03b5), for \u2200t0 > 0 fixed. We now do similarly\nas (2.5)-(2.7) for kt\u03b5 \u2212 gt and integrate from t0 to t,\n(2.59) |kt\u03b5 \u2212 gt |2\n\nH\n\n1\n2 (\u0393)\n\n(t) \u2264 e\u2212\n\nt\u2212t0\n\u03b5\n\n|kt\u03b5 \u2212 gt |2\n\n1\n\nH 2 (\u0393)\n\n(t0 ) + \u03b5|gtt |2 2\n\n1\n\nL (0,T ;H 2 (\u0393))\n\n,\n\nwhich yields\n(2.60)\n\n\u221a\n1\nkt\u03b5 \u2212 gt = O( \u03b5) in L\u221e (t0 , T ; H 2 (\u0393)), \u2200t0 > 0.\n3. Numerical Results For the penalty method\n\n3.1. Approximations of k \u03b5 . In order to test the efficiency of the\nproposed penalty method, we will provide in this section and in the\nnext one (Sec. 3.3) some numerical results for system (2.2) with \u03a9 =\n(0, 1) \u00d7 (0, 1), and 0 \u2264 t \u2264 1; we set g(t) = sin(t) for all (x, y) \u2208 \u2202\u03a9,\nu0 (x, y) = sin( 5\u03c0\nx + 3\u03c0\n)sin( 5\u03c0\ny + 3\u03c0\n), in which case, we face the dis4\n4\n4\n4\ncrepancies all along the lines x = 0 and y = 0 (but no discrepancy\nalong the parts x = 1 or y = 1 of the boundary).\nWe start by testing the quality of the approximation of k \u03b5 inferred by\nn\nX\n\u03b5\nthe boundary layer analysis of Section 2.3; that is k \u223c\n\u03b5j (k j + \u03b8j ),\nj=0\n\nfor suitable \u03b5\u2032 s and n\u2032 s.\nBecause (2.2) is a 2D system which makes the graphing impossible\nalong the time axis, we restrict ourselves to follow the time evolution of\nthe exact and approximate function at one point of the boundary; for\nsimplicity we choose the corner (x, y) = (0, 0). We then plot in Figure\nn\nX\n\u03b5\n\u03b5\n1, g(t) (solid line) and k (dash\u2013dot line), k \u223c\n\u03b5j (k j + \u03b8j ) with\nj=0\n\nn = 0 or 1, and \u03b5 = 0.1 or 0.01. For n = 1, the proposed new scheme\ngives a good approximation of k \u03b5 .\n\n\f16\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\nn=0 and epsilon=0.1\n\nn=1 and epsilon=0.1\n\n1.5\n\n1.5\n\n1\n\n1\n\n0.5\n\n0.5\n\n0\n\n0\n(a)\n\n0.5\nTime\nn=0 and epsilon=0.01\n\n1\n\n1\n\n0\n\n0\n(b)\n\n0.5\nTime\nn=1 and epsilon=0.01\n\n1\n\n0\n(d)\n\n0.5\nTime\n\n1\n\n1.5\n\n0.8\n1\n\n0.6\n0.4\n\n0.5\n\n0.2\n0\n\n0\n(c)\n\n0.5\nTime\n\n1\n\n0\n\nFigure 1. (a) Boundary Layer Element with \u01eb =\n0.1, k \u01eb \u223c k 0 + \u03b80 , (b) Boundary Layer Element with\n\u03b5 = 0.1, k \u03b5 \u223c k 0 + \u03b80 + \u03b5k 1 + \u03b5\u03b81 , (c) Boundary Layer\nElement with \u03b5 = 0.01, k \u03b5 \u223c k 0 + \u03b80 , (d) Boundary Layer\nElement with \u03b5 = 0.01, k \u03b5 \u223c k 0 + \u03b80 + \u03b5k 1 + \u03b5\u03b81 .\n\nFig. 2 gives the L2 \u2212 and L\u221e \u2212 errors which stand respectively for\n1\n1\nthe L2 (0, T ; H 2 (\u0393)) and L\u221e (0, T ; H 2 (\u0393)) norms of the difference ben\nX\ntween the real solution k \u03b5 and the approximations\n\u03b5j (k j + \u03b8j ), as\nj=0\n\nthe number of time steps T , \u03b5 and n vary. It is clear that the smaller\n\u03b5 is, the smaller both errors are.\n\n3.2. A two-dimensional system in a square \u03a9. To verify the effectiveness of the penalty method, we use the finite elements method for\nthe spatial approximation of u. The Penalty Method is mainly aimed\nfor multi-dimensional time-dependent PDEs, so we consider the 2D\nsystem, as in (1.2):\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n\u22120.5\n\u22121\n\u22121.5\n\u22122\n\u22122.5\n\u22124\n\u22123\n\u22122\n\u22121\n(a) Logarithm of Epsilon (Base 10)\n\nn=0,T=100\nLogarithm of the Error (Base 10)\n\nLogarithm of the Error (Base 10)\n\nn=0,T=10\n0\n\n0.5\n0\n\u22120.5\n\u22121\n\u22121.5\n\u22122\n\u22122.5\n\u22124\n\u22123\n\u22122\n\u22121\n(b) Logarithm of Epsilon (Base 10)\n\n\u22122\n\n\u22124\n\u22126\n\n\u22128\n\u22124\n\u22123\n\u22122\n\u22121\n(c) Logarithm of Epsilon (Base 10)\n\nn=1,T=100\nLogarithm of the Error (Base 10)\n\nLogarithm of the Error (Base 10)\n\nn=1,T=10\n0\n\n17\n\n2\n0\n\u22122\n\u22124\n\u22126\n\u22128\n\u22124\n\u22123\n\u22122\n\u22121\n(d)Logarithm of Epsilon (Base 10)\n\nFigure 2. L2 (plot o)- and L\u221e (plot *)- error between\nthe boundary layer schemes and the real solution for \u03b5kt +\nk = g.\n\n(3.1)\n\n\uf8f1\n\u2202u\n\uf8f4\n\uf8f4\n\uf8f2 \u2202t \u2212 \u03bd(uxx + uyy ) = f,\n\uf8f4 u|\u2202\u03a9 = g,\n\uf8f4\n\uf8f3\nu|t=0 = u0 .\n\nwhere 0 \u2264 x \u2264 1, 0 \u2264 y \u2264 1, 0 \u2264 t \u2264 1.\n\n5\u03c0\n3\u03c0\n5\u03c0\n3\u03c0\nx+\n)sin( y +\n),\n4\n4\n4\n4\nso that g(0) 6= u0 |\u2202\u03a9 on the lines x = 0 and y = 0. So we face the incompatibility problem, namely the boundary conditions and the initial\ncondition do not match at these corners of the time and spatial axes.\nFor the test we set \u01eb = 0.1 in the penalty approximation (2.1)\u2013(2.2)\nof (3.1). In more general problems, we might have discontinuities at\nWe set \u03bd = 0.2, f = 0, g = 0, u0 = sin(\n\n\f18\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nsolution at t=1\n\nsolution at t=0.5\n\nsolution at t=0\n\n0.015\n\n0.1\n\n1\n\n0.08\n\n0.5\n\n0.01\n\n0.06\n0\n0.04\n\u22120.5\n\n0.005\n\n0.02\n\n\u22121\n1\n\n0\n1\n\n0\n1\n\n1\n0.5\n\n0.5\n\ny\n\n1\n0.5\ny\n\nx\n\n0 0\n\n1\n0.5\n\n0.5\n\n(a)\n\ny\n\nx\n\n0 0\n\n0.5\n0 0\n\nx\n\n(c)\n\n(b)\n\nFigure 3. The exact solution of the system in the\nsquare \u03a9 without applying the penalty method, at times\n0, 0.5 and 1 (Figures 3(a), 3(b), 3(c)).\nsection of the solution at y=0.6,t=0\n\nsection of the solution at y=0.6,t=0.02\n1\n\n0.5\n\nu(x,y,t) at y=0.6\n\nu(x,y,t) at y=0.6\n\n1\n\n0\n\u22120.5\n\u22121\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n0.5\n\n0\n\n\u22120.5\n\n1\n\n0\n\n0.2\n\n0.4\n\nx\n\n0.6\n\n0.6\n\n0.4\n0.2\n\n0.2\n\n0\n\n0\n\u22120.2\n\n0.4\n\n0.6\nx\n\n1\n\n0.4\n\n\u22120.2\n\n0.2\n\n0.8\n\nsection of the solution at y=0.6,t=0.08\n0.8\n\nu(x,y,t) at y=0.6\n\nu(x,y,t) at y=0.6\n\nsection of the solution at y=0.6,t=0.04\n0.8\n\n0\n\n0.6\nx\n\n0.8\n\n1\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nx\n\nFigure 4. The sections of the exact solution at y = 0.6\nwhen t is close to 0.\nthe space corners x = 0 or 1, y = 0 or 1. But since the function u0 is\nsmooth at the corners, these singularities do not occur here, at least at\n\n\fTREATMENT OF INCOMPATIBILITIES\n\nMaximum Comparative Error Applying\n\u22123 the Penalty Method\n\nMaximum Comparative Error for a\nShort Period of Time\n\n0.014\n\n1\n\nWithout Penalty Method\nWith Penalty Method\nMaximum Comparative Error\n\nMaximum Comparative Error\n\n0.008\n0.006\n0.004\n\nx 10\n\n0.9\n\n0.012\n0.01\n\n19\n\n0.8\n0.7\n0.6\n0.5\n0.4\n0.3\n0.2\n\n0.002\n0.1\n0\n\n0\n\n(a)\n\n0.05\nTime\n\n0.1\n\n0\n\n0\n\n(b)\n\n0.5\nTime\n\n1\n\nFigure 5. The comparative errors of the 2D system in\nthe L\u221e norm for \u03b5 = 0.1. (a) Maximum comparative\nerror for a short time period (in real value), (b) Maximum\ncomparative error when applying the Penalty Method\n(times 10\u22123 ).\nthe low orders.\nWe first plot the solution of system (3.1) without applying the penalty\nmethod. The solution is plotted in Fig. 3; (a) is the graph of the\napproximate solution at t = 0, (b) is the graph of the approximate\nsolution at t = 0.5, and (c) is the graph of the approximate solution\nat t = 1. The graph displays a sharp gradient around the corner of\nthe time\u2013space axis during an initial short period due to the incompatibility between the initial and boundary conditions there. In order\nto see the sharp gradient clearly and the changes of the gradient as\ntime evolves, we plot the sections (x \u2208 (0, 1), y = 0.6) of the solution\nat times close to 0; see Figure 4. It is clear that, at t = 0, we observe\nthe sharpest gradient at the time\u2013space corner and as time evolves, the\ngradient becomes smoother and smoother at that corner, until t = 0.08,\nwhen it is essentially flat.\nNext, to study the accuracy of the numerical method, we must measure the errors for the approximate solutions. Hence we compute the\n\n\f20\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\n3\n\nPenalty Error at Initial Steps\n\u22123\nx 10\n\nPenalty Error at Final Steps\n\u22124\nx 10\n\n2\n\nError at Final Steps\n\nError at Initial Steps\n\n2.5\n\n1.5\n\n1\n\n2\n\n1\n\n0.5\n\n0\n\n0\n\n0.5\nEpsilon\n\n(a)\n\n1\n\n0\n\n0\n(b)\n\n0.5\nEpsilon\n\n1\n\nFigure 6. The comparative errors for the 2D system\nin the L\u221e norm with variations of \u01eb with mesh \u25b3x =\n1\n1\n1\n, \u25b3y = 24\n, \u25b3t = 1000\n. (a) The error at initial step. (b)\n24\nThe error at final step. Note the factors 10\u22123 , 10\u22124 in\n(a), (b)\n\u22123\n\nMaximum Comparative Error\n\n1\n\nThe choice of epsilon\n\nx 10\n\nepsilon=0.1\nepsilon=0.5\nepsilon=0.8\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nFigure 7. The maximum comparative errors for the 2D\nsystem in square domain.\ncomparative errors which are the differences between two numerical solutions for the problem, one with the stated mesh sizes, and the other\none with a finer mesh. Then at each time step, we obtain the maximum error between the two meshes above; it is understood to be L\u221e\n\n\fTREATMENT OF INCOMPATIBILITIES\n\u22123\n\n1\n\nx 10\n\n21\n\nComparative Maximum Error at Each Time Step\ncoarse mesh\nfine mesh\n\n0.9\n\nComparative Maximum Error\n\n0.8\n0.7\n0.6\n0.5\n0.4\n0.3\n0.2\n0.1\n0\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTime\n\nFigure 8. The comparative errors for the 2D system\nin L\u221e sense at \u01eb = 0.1. The upper line is with mesh\n1\n1\n1\n\u25b3x = 24\n, \u25b3y = 24\n, \u25b3t = 1000\n, the lower line is with\n1\n1\n1\nmesh \u25b3x = 48\n, \u25b3y = 48\n, \u25b3t = 4000\ncomparative errors, or maximum comparative errors. In what follows,\nall the error terms are to be understood in this sense.\nWe plot the maximum comparative errors of the 2D system on Fig. 5.\nGraph (b) is the plot of the maximum comparative errors along the\nwhole time period if we apply the penalty method. Because the discrepancy happens at the time-space corner, we zoom into the left corner\nof graph (b) and compare it with the error when we do no apply the\npenalty method. In graph (a), the line with stars is the maximum\ncomparative errors with the penalty method applied, and the line with\ncircles is the maximum comparative errors without the penalty method.\nWe observe that the magnitude of the errors at the time-space corner\nis reduced by around one order by the penalty method.\nBecause we use finite differences method, so for the same \u03b5, if we\nhave a finer mesh, the maximum comparative error should be smaller.\nIn Fig. 8 we plot the error of the 2D system with \u03b5 = 0.1, the lower\ncurve with a finer mesh, the upper curve with a coarser mesh. The\nmagnitude of the errors are reduced by around 40%. So for a fixed \u03b5,\nthe finer the mesh is, the smaller the error is. We are also interested in\nthe decay of the maximum errors. The most interesting and informative comparison can be made between the decay rates of the maximum\nerrors at the initial and final time steps. In Fig. 9 (a), the maximum\n\n\f22\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nMaximum Error at the Initial Time Steps\n\u22121.5\n\nMaximum Error at the Final Time Steps\n\u22128.5\nWithout Penalty Method\nWith Penalty Method\n\nWithout Penalty Method\n\n\u22122\n\nWith Penalty Method\n\nlogarithm o the maximum error (base 10)\n\nlogarithm o the maximum error (base 10)\n\n\u22129\n\u22122.5\n\n\u22123\n\n\u22129.5\n\n\u22123.5\n\n\u221210\n\n\u22124\n\n\u22124.5\n\n\u221210.5\n\u22125\n\n\u22125.5\n\n1\n\n(a)\n\n1.5\nlogarithm of the number of the\nsegment in x (base 10)\n\n2\n\n\u221211\n\n1\n\n1.5\nlogarithm of the number of the\nsegment in x (base 10)\n(b)\n\n2\n\nFigure 9. Decay of the maximum errors. When we\napply the penalty method here \u03b5 = 0.1. (a) at the initial\nsteps, (b) at the final steps\nerrors at the initial time step are plotted against the grid resolution\nin the loglog scale. Without the penalty method, the maximum errors do not decrease as the grid refines, which demonstrates that the\nsingularity in the solution during the initial period is serious. With\nthe penalty method (\u03b5 = 0.1), the maximum errors decay at roughly\nthe second order. Fig. 9 (b) shows that, with and without applying\npenalty method, the maximum errors at the final steps (t=1) decay at\napproximately the second order.\n1\n1\n1\nNext, we fix the meshes at e.g. \u25b3x = 24\n, \u25b3y = 24\n, \u25b3t = 1000\n, and let\n\u03b5 vary. In Fig. 6, we plot the maximum comparative errors of system\n(3.1). At the initial steps, the error decreases sharply as \u03b5 increases and\nremains close to 0, then it becomes stable flat. At the final steps, the\nerror increases almost linearly as \u03b5 increases. With \u03b5 at about 0.1, the\ninitial error is minimized while the error at final step is well controlled.\nBut as Fig. 7 shows, in a short time period \u03b5 = 0.5 gives us smaller\n\n\fTREATMENT OF INCOMPATIBILITIES\n\nsolution at t=0\n\nsolution at t=0.5\n\n23\n\nsolution at t=1\n\u22123\n\nx 10\n0.5\n\n0.04\n\n2\n\n0.02\n\n1\n\n0\n\n0\n\n\u22120.02\n\n\u22121\n\n\u22120.04\n1\n\n\u22122\n1\n\n0\n\n\u22120.5\n1\n\n1\n\n1\n0\n\n0\ny\n\n0\n\n0\n\u22121 \u22121\n\n(a)\n\nx\n\ny\n\n\u22121 \u22121\n\n(b)\n\nx\n\n1\n0\ny\n\n0\n\u22121 \u22121\n\nx\n\n(c)\n\nFigure 10. The solution of the system in disk \u03a9 without applying the penalty method.\nerrors and again after a short time period \u03b5 = 0.1 gives us a smaller\nerror. In optimization theory, the choice of \u03b5 is usually made by trial\nand error and is not a major issue. It does not follow the \"intuitive\"\nidea that the error becomes smaller as \u03b5 becomes smaller because of\nmany other contingent errors such as round-off and descretization errors. In general the choice of \u03b5 depends on our goals of the computation.\n3.3. 2D system in a disk \u03a9. To further verify the effectiveness of\nthe penalty method we now test the results in a different domain. We\nnow choose a disk \u03a9 = {(x, y)|x2 + y 2 \u2264 1}. The 2D heat equations in\nthe polar coordinates x = rcos(\u03b8), y = rsin(\u03b8) where 0 \u2264 \u03b8 \u2264 2\u03c0, 0 \u2264\nr \u2264 1 read\n\uf8f1\n\u2202u\nur u\u03b8\u03b8\n\uf8f4\n\uf8f4\n\u2212 \u03bd(urr +\n+ 2 ) = f,\n\uf8f2\n\u2202t\nr\nr\n(3.2)\nu|\n=\nu\n,\nt=0\n0\n\uf8f4\n\uf8f4\n\uf8f3\nu|r=1 = g.\n\nConsider the 2D system (3.2), where 0 \u2264 t \u2264 1, and set \u03bd = 0.2, f =\n0, g = 0 and u0 (x, y) = xy, so that g(0) 6= u0 |\u2202\u03a9 . We also set \u03b5 = 0.1\nthe same as before. In this case, we face the singularities almost everywhere along the unit circle except at the points where x = 0 or y = 0.\n\n\f24\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\nSection of the solution at t=0\n\nSection of the solution at t=0.02\n\n0.8\n\n0.4\n\n0.6\n\n0.3\n\n0.4\n\n0.2\n\n0.2\n\n0.1\n\n0\n\n0\n\n0.5\n1\nr\nSection of the solution at t=0.04\n\n0\n\n0.4\n\n0.2\n\n0.3\n\n0.15\n\n0.2\n\n0.1\n\n0.1\n\n0.05\n\n0\n\n0\n\n0.5\nr\n\n1\n\n0\n\n0\n\n0.5\n1\nr\nSection of the solution at t=0.08\n\n0\n\n0.5\nr\n\nFigure 11. The section of the solution at \u03b8 =\nt is close to 0.\n\n1\n\n\u03c0\n4\n\nwhen\n\nThe effectiveness of this method will be verified with the following numerical results.\nWe first compute the solution of (3.2) without applying the penalty\nmethod. The solution is plotted in Fig. 10; (a) is the graph of the\nsolution at t = 0, (b) is the graph of the solution at t = 0.5, and (c)\nis the graph of the solution at t = 1. As we did for the system (3.1)\nfor the square, we plot in Fig. 11 the sections (r \u2208 (0, 1), \u03b8 = \u03c04 ) of\nthe solution at times close to 0. It is clear that, at t = 0, the graph\ndisplays a sharp gradient around the corner of the time\u2013space axis due\nto the discrepancy between the initial and boundary conditions there,\nand as time evolves, the gradient becomes smoother and smoother.\nTo study the error of the system in the disk \u03a9, we define the maximum comparative errors as for the square \u03a9. Hence we plot the L\u221e\nerrors for the 2D system for the disk \u03a9 on Fig. 12; graph (b) is the\nmaximum comparative error along the whole time period if we apply\nthe penalty method. Because the discrepancy happens at the timespace corner, we zoom into the left corner of graph (b) and compare it\nwith the error when we do not apply the penalty method. From graph\n\n\fTREATMENT OF INCOMPATIBILITIES\n\nThe Error in Both Methods in Short Time Period\n\n25\n\nThe Error Along the Whole Time Period\n\u22123\n\n0.025\n\n4\n\nWithout Penalty Method\nWith Penalty Method\n\nx 10\n\nWith the Penalty\nMethod\n\n3.5\nMaximum COmarative Error\n\nMaximum Comparative Error\n\n0.02\n\n0.015\n\n0.01\n\n3\n2.5\n2\n1.5\n1\n\n0.005\n0.5\n0\n\n0\n(a)\n\n0.05\nTime\n\n0.1\n\n0\n\n0\n(b)\n\n0.5\nTime\n\n1\n\nFigure 12. The maximum comparative error for Ordinary Finite Element and penalty method in L\u221e sense\nwith \u03b5 = 0.1\n(a), we observe that the magnitude of the errors at the time-space corner are reduced by a factor of 10 if we apply the penalty method.\nIn Fig.13, we plot the maximum comparative error for (3.2) with a\nfixed mesh at both initial and final steps. At the initial step, the error\ndecreases sharply as \u03b5 increases and remains close to 0, and then it\nbecomes flat. At the final step, the error increases almost linearly as\n\u01eb increases. The observation also leads to the following conclusion: at\nabout \u03b5 = 0.1, the initial error is minimized while the error at final\nstep is well controlled.\nAs for the previous example, we shall now look at how the singularity, induced by the compatibility between the initial and boundary\ndata, affects the convergence rates of the numerical scheme. In Fig.\n14 we plot the maximum errors, at the initial and final time steps,\nwith and without the penalty method, against the spatial resolution\nin the loglog scale. We see in Fig. 14 (a) that, without the penalty\nmethod, the maximum errors do not decrease as the grid refines, which\ndemonstrates that the singularity in the solution at the initial time\n\n\f26\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nErrors at Initial Step\n\n\u22123\n\n3.5\n\n0.03\n\nMaximum Comparative Error\n\nMaximum Comparative Error\n\nErrors at Final Step\n\n3\n\n0.025\n\n0.02\n\n0.015\n\n0.01\n\n0.005\n\n0\n\nx 10\n\n2.5\n\n2\n\n1.5\n\n1\n\n0.5\n\n0\n(a)\n\n0.2\n\n0.4\nEpsilon\n\n0.6\n\n0.8\n\n0\n\n0\n\n0.2\n\n(b)\n\n0.4\nEpsilon\n\n0.6\n\n0.8\n\nFigure 13. The maximum comparative errors for\npenalty method at both initial and final steps as \u03b5 vari1\n1\n1\nants with mesh \u25b3r = 10\n, \u25b3\u03b8 = 10\n, \u25b3T = 1000\n.\nstep is serious. With the penalty method, the maximum errors decay\nat roughly the second order. Fig. 14 (b) shows that, with and without\napplying penalty method, the maximum errors at the final steps (t=1)\ndecay at approximately the second order.\n3.4. Implementation in a 1D System. As we said in the Introduction the penalty method applies without any restriction on space dimension. However a number of methods have previously been proposed\nwhich only apply to space dimension one. Our aim is now to compare\nthe efficiency of the penalty method with some of the earlier methods;\nand therefore we can only consider the case of space dimension 1. More\nprecisely we will consider the Corrector Methods as proposed in [8]-[10]\nand compare them with the penalty method for the 1D system\n\n(3.3)\n\n\uf8f1\n\uf8f4\n\uf8f2 ut \u2212 \u03bduxx = 0,\nu(x, 0) = u0\n\uf8f4\n\uf8f3 u(0, t) = g (t),\n1\n\n0 < x < 1,\nu(1, t) = g2 (t).\n\n0 < t < 1,\n\n\fTREATMENT OF INCOMPATIBILITIES\n\nMaximum Error at the Initial Time Steps\n\u22122\n\n27\n\nMaximum Error at the Final Time Steps\n\u22123\nWithout Penalty Method\nWith Penalty Method\n\n\u22122.5\n\nWithout Penalty Method\n\n\u22123.5\nlogarithm o the maximum error (base 10)\n\nlogarithm o the maximum error (base 10)\n\nWith Penalty Method\n\n\u22123\n\n\u22123.5\n\n\u22124\n\n\u22124\n\n\u22124.5\n\n\u22124.5\n\n\u22125\n\n\u22125\n\u22125.5\n\n\u22126\n\n1\n\n1.5\nlogarithm of the number of the\nsegment in r (base 10)\n(a)\n\n2\n\n\u22125.5\n\n1\n\n1.5\nlogarithm of the number of the\n(b)\nsegment in r (base 10)\n\n2\n\nFigure 14. Decay of the maximum errors. When we\napply the penalty method here \u03b5 = 0.1. (a) at the initial\nsteps, (b) at the final steps\n5\u03c0\n3\u03c0\nHere we set u0 (x) = sin( x+ ), g1 (t) = 0, g2 (t) = 0, \u03bd = 0.2. For\n4\n4\nthe Penalty Method, we also set \u03b5 = 0.1, and for the Corrector Method,\nwe have the following choice of correctors [5]-[9] offering increasing\naccuracy:\n\uf8f1\n\uf8f4\n\uf8f2 0,\n(Procedure 1)\n(3.4)\nS = \u03b10 S0 ,\n\uf8f4\n\uf8f3\u03b1 S +\u03b1 S ,\n(Procedure 2)\n0 0\n1 1\nZ \u221e\ns2\n1\nwhere \u03b10 = g1 (0)\u2212u0 (0), \u03b11 = g1t (0)\u2212u0xx (0), S0 = \u221a\ne\u2212 4\u03bdt ds =\n\u03c0\u03bdt x\nZ t\nx\nS0 (x, \u03c4 )d\u03c4 . Here Procedure 1 absorbs the 0th\nerf c( \u221a ) and S1 =\n\u03bdt\n0\norder incompatibility (g1 (0) 6= u0 (0)), and Procedure 2 absorbs both\nthe 0th and 1st order incompatibilities (g1 (0) 6= u0 (0) and g1t (0) 6=\n\u03bdu0xx (0)).\n\n\f28\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\n\u22123\n\nx 10\n\nWithout Applying Any Methods\n\n\u22123\n\n1\n\n4.5\n\n0.9\n\n4\n\n0.8\n\n3.5\n\n0.7\n\nMaximum Comparative Error\n\nMaximum Comparative Error\n\n5\n\n3\n\n2.5\n\n2\n\n0.4\n\n1\n\n0.2\n\n0.5\n\n0.1\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nProcedure 1\nProcedure 2\nPenalty Method\n\n0.5\n\n0.3\n\n0\n\nCorrector Method vs Penalty Method\n\n0.6\n\n1.5\n\n0\n\nx 10\n\n0\n\n0\n\n0.01\n\n0.02\n\nTime\n\n0.03\n\n0.04\n\n0.05\n\nTime\n(b)\n\n(a)\n\nFigure 15. Comparative error of the two methods in\n1D system in L\u221e sense at \u03b5 = 0.1\nLet u = v + S; we see that v is the solution of the following equation\n\uf8f1\n\uf8f4\n\uf8f2 vt \u2212 \u03bdvxx = 0, 0 < x < 1, 0 < t < 1,\nv(x, 0) = u0 (x),\n(3.5)\n\uf8f4\n\uf8f3 v(0, t) = g (t) \u2212 S(0, t), v(1, t) = g (t) \u2212 S(1, t).\n1\n\n2\n\nWe choose to solve equation (3.5) by finite differences. Fig. 15\ngives the comparison between different methods (Penalty Method and\nCorrection Method). Figure 15 (a) gives us the maximum comparative error of system (3.3) without applying any methods. Figure 15\n(b) compares the two methods, zooming into the corner of the timespace domain where errors are the largest due to the incompatibility at\nt = 0. As expected Procedure 2 gives slightly better results than Procedure 1. Also the errors with the penalty method are larger than with\nboth procedures, but still of comparable magnitude whereas the errors\nwithout any procedure reach a pick about 6 times larger (4.8 \u00d7 10\u22123 vs\n0.8 \u00d7 10\u22123 ). Now we want to vary \u03b5 in this 1D system, Fig.16 shows\nthat if \u03b5 is too small as compared to the mesh, the Penalty Method\nwould not reduce the errors at the spatio-temporal corner, but if it is\n\n\fTREATMENT OF INCOMPATIBILITIES\n\nErrors as epsilon is variant\n\n\u22123\n\n8\n\n29\n\nx 10\n\nepsilon=0.05\nepsilon=0.01\n7\n\nMaximum Comparative Error\n\n6\n\n5\n\n4\n\n3\n\n2\n\n1\n\n0\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nTime\n\nFigure 16. The maximum comparative errors for the\n1D system in L\u221e sense along the time\nan appropriate small number, it could really reduce the errors by more\nthan 80%.\n4. Conclusion\nThe penalty method gives a way to solve the higher dimensional incompatibility problems. As expected, there exists a solution for system\n(1.2) which is continuous over [t0 , T ], for all t0 > 0.\nThe discrepancy occurs at the time-space corner; we are effectively\ninterested in the errors for the initial short time period. The numerical\nsimulations for the system with both a square \u03a9 and a disk \u03a9 yield\nsimilar results. At the spatio-temporal corner, the magnitudes of the\nerrors are reduced by about one order of magnitude by the penalty\nmethod. Tests are also conducted to study the effects of different values of \u03b5, the key parameter in the penalty method. We find that with\nan appropriate small value for \u03b5, the initial error can be minimized\n\n\f30\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\nwhile the error at final step is under well controlled.\nFinally, in space dimension one, when both methods are available\n(penalty method and correction procedures 1 and 2), the penalty method\ngives a slightly larger error than the Correction Procedures 1 and 2;\nbut the order of magnitude of the errors are comparable and they are\nall significantly smaller than the errors appearing when no correction\nprocedure is implemented .\n\nAcknowledgments\nThis work was partially supported by the National Science Foundation under the grants NSF-DMS-0604235, and DMS-0906440 and by\nthe Research Fund of Indiana University.\nAppendix: The user guide\nThe aim is to address the incompatibility issue for the multi-dimensional\ntime-dependent linear parabolic equation\n\uf8f1\nx \u2208 \u03a9 \u2282 Rd , t \u2208 R+ ,\n\uf8f4\n\uf8f2 ut \u2212 \u03bd\u25b3u = f,\nu|t=0 = u0 ,\n(4.1)\n\uf8f4\n\uf8f3\nu|\u2202\u03a9 = g.\nwhere u0 |\u2202\u03a9 6= g|t=0 . So we consider new system instead, namely, for\n\u03b5 > 0 fixed,\n\n(4.2)\n\n(4.3)\n\n\uf8f1 \u03b5\n\u03b5\n\uf8f4\n\uf8f2 ut \u2212 \u03bd\u25b3u = f,\nu\u03b5 |t=0 = u0 ,\n\uf8f4\n\uf8f3 \u03b5\nu |\u2202\u03a9 = k \u03b5 .\n\nx \u2208 \u03a9 \u2282 Rd ,\n\n\uf8f1\n\uf8f2 k \u03b5 + 1 (k \u03b5 \u2212 g) = 0,\nt\n\u03b5\n\uf8f3 k \u03b5 (0) = u | .\n\nt \u2208 R+ ,\n\nt \u2208 R+ ,\n\n0 \u2202\u03a9\n\nWe consider for instance the rectangle 0 \u2264 x \u2264 1, 0 \u2264 y \u2264 1 and 0 \u2264\nt \u2264 1. We consider the discretization meshes \u25b3x = 1/M, \u25b3y = 1/N\nand \u25b3t = 1/T , where M, N, T are integers. We use an explicit scheme\nto compute the numerical solution of the original system (4.1) and of\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n31\n\nthe modified system (4.2), (4.3), that is respectively:\n(4.4)\n\uf8f1 n+1\nn\nn\nn\nn\nn\nn\nn\n\uf8f4\n\uf8f4 ui,j \u2212 ui,j \u2212 \u03bd( ui+1,j + ui\u22121,j \u2212 2ui,j + ui,j+1 + ui,j\u22121 \u2212 2ui,j ) = f n ,\n\uf8f4\n\uf8f4\ni,j\n\uf8f4\n\u25b3t\n\u25b3x2\n\u25b3y 2\n\uf8f4\n\uf8f2\nf or 1 \u2264 i \u2264 N \u2212 1, 1 \u2264 j \u2264 M \u2212 1, 1 \u2264 n \u2264 T,\n\uf8f4\n\uf8f4\n\uf8f4\nuni,j |\u2202\u03a9 = gi,j (n\u25b3t)|\u2202\u03a9 , f or i = 0, N or j = 0, M,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 u0 = u (i\u25b3x, j\u25b3y), f or 0 \u2264 i \u2264 N, 0 \u2264 j \u2264 M.\ni,j\n\n0\n\nfor (4.1), and , for (4.2)-(4.3):\n(4.5)\n\uf8f1 n+1\nui,j \u2212 uni,j\nuni+1,j + uni\u22121,j \u2212 2uni,j uni,j+1 + uni,j\u22121 \u2212 2uni,j\n\uf8f4\nn\n\uf8f4\n\uf8f4\n\u2212 \u03bd(\n+\n) = fi,j\n,\n\uf8f4\n2\n2\n\uf8f4\n\u25b3t\n\u25b3x\n\u25b3y\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nf or 1 \u2264 i \u2264 N \u2212 1, 1 \u2264 j \u2264 M \u2212 1, 1 \u2264 n \u2264 T,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u03b5n\n\uf8f2 uni,j |\u2202\u03a9 = ki,j\n|\u2202\u03a9 , f or i = 0, N or j = 0, M,\n\n\uf8f4\nu0i,j = u0 (i\u25b3x, j\u25b3y), f or 0 \u2264 i \u2264 N, 0 \u2264 j \u2264 M,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u03b5n+1\n\u03b5n\n\uf8f4\nki,j\n\u2212 ki,j\n1 \u03b5n\n\uf8f4\n\uf8f4\n+ (ki,j\n\u2212 gi,j (n\u25b3t)) = 0, f or i = 0, N or j = 0, M, n \u2265 1,\n\uf8f4\n\uf8f4\n\uf8f4\n\u25b3t\n\u03b5\n\uf8f4\n\uf8f4\n\uf8f3 \u03b50\nki,j = u0 (i\u25b3x, j\u25b3y), f or i = 0, N or j = 0, M.\nReferences\n1. L.K. Bieniasz, A singularity correction procedure for digital simulation of\npotential-step chronoamperometric transients in one\u2013dimensional homogeneous\nreaction-diffusion systems, Electrochimica Acta 50 (2005), 3253\u20133261.\n2. John P. Boyd and Natasha Flyer, Compatibility conditions for time-dependent\npartial differential equations and the rate of convergence of Chebyshev and\nFourier spectral methods, Comput. Methods Appl. Mech. Engrg. 175 (1999),\nno. 3-4, 281\u2013309.\n3. J.P. Boyd and N. Flyer, Compatibility conditions for time-dependent partial\ndifferential equations and the rate of convergence of chebyshev and fourier spectral methods (english. english summary), Methods Appl. Mech. Eng. 175(3-4)\n(1999), 281\u2013309.\n4. John Rozier Cannon, The one-dimensional heat equation, Encyclopedia of\nMathematics and its Applications 23 (1984), xxv+483 pp.\n5. Qingshan Chen, Zhen Qin, and Roger Temam, Accurate numerical resolution\nof nonlinear evolution equations in the presence of corner singularities in space\ndimension 1, Comm. Comp. Phys. 9 (2011), no. 3, 568\u2013586.\n6. R. Courant, Variational methods for the solution of problems of equilibrium and\nvibrations, Bull. Amer. Math. Soc. 49 (1943), 1\u201323.\n7. M.S. Engelman, R.L. Sani, and P.M. Gresho, The implementation of normal\nand/or tangential boundary conditions in finite element codes for incompresible\nfluid flow, Int. J. Numer. Methods Fluids 2(3) (1982), 225\u2013238,76\u201308.\n\n\f32\n\nQINGSHAN CHEN, ZHEN QIN, AND ROGER TEMAM\n\n8. Natasha Flyer and Bengt Fornberg, Accurate numerical resolution of transients\nin initial-boundary value problems for the heat equation, J. Comput. Phys. 184\n(2003), no. 2, 526\u2013539.\n, On the nature of initial-boundary value solutions for dispersive equa9.\ntions, SIAM J. Appl. Math. 64 (2003/04), no. 2, 546\u2013564 (electronic).\n10. Natasha Flyer and Paul N. Swarztrauber, The convergence of spectral and finite\ndifference methods for initial-boundary value problems, SIAM J. Sci. Comput.\n23 (2002), no. 5, 1731\u20131751 (electronic).\n11. R. Foias, C.; Temam, Some analytic and geometric properties of the solutions\nof the evolution navier-stokes equations, J. Math. Pures Appl. 9 (1979), no. 3,\n339\u2013368.\n12. P.M. Gresho, Incompressible fluid-dynamics - some fundamental formulation\nissues, Annu. Rev. Fluid Mech. 23 (1991), 413\u2013453.\n13. P.M. Gresho and R.L. Sani, On pressure boundary-conditions for the incompressible navier-stokes equations, Int. J. Numer. Methods Fluds 7(10) (1987),\n1111\u20131145.\n14. D. Henry, Geometric theory of semilinear parabolic equations, Lecture Notes in\nMathematics, vol. 840, Springer-Verlag, Berlin, 1981.\n15. J.G Heywood, Auxiliary flux and pressure conditions for navier-stokes problems, in: Approximation mathods for navier-stokes problems ( proc.sympos.,\nuniv. paderborn, paderborn, 1979), Lecture Notes in Math. vol.771 (1980),\npp.223\u2013234.\n16. J.G.Heywood and R. Rannacher, Finite element approximation of the nonstationary navier-stokes problem. i. regularity of solutions and second-order error\nestimates for spatial discretization, SIAM J. Numer. Anal. 19(2) (1982), 275\u2013\n311.\n17. Chang-Yeol Jung and Roger Temam, Numerical approximation of twodimensional convection-diffusion equations with multiple boundary layers, Int.\nJ. Numer. Anal. Model. 2 (2005), no. 4, 367\u2013408.\n18. O. A. Lady\u017eenskaja, V. A. Solonnikov, and N. N. Ural\u2032 ceva, Linear and quasilinear equations of parabolic type, Translated from the Russian by S. Smith.\nTranslations of Mathematical Monographs, Vol. 23, American Mathematical\nSociety, Providence, R.I., 1968.\n19. O. Lady\u017eenskaya, On the convergence of Fourier series defining a solution of a\nmixed problem for hyperbolic equations, Doklady Akad. Nauk SSSR (N.S.) 85\n(1952), 481\u2013484 (Russian).\n20. O. A. Lady\u017eenskaya, On solvability of the fundamental boundary problems for\nequations of parabolic and hyperbolic type, Dokl. Akad. Nauk SSSR (N.S.) 97\n(1954), 395\u2013398.\n21. J.-L. Lions, Quelques m\u00e9thodes de r\u00e9solution des probl\u00e8mes aux limites non\nlin\u00e9aires, Dunod, 1969.\n22. A. Pazy, Semigroups of operators in Banach spaces, Equadiff 82 (W\u00fcrzburg,\n1982), Lecture Notes in Math., vol. 1017, Springer, Berlin, 1983, pp. 508\u2013524.\n23. Jeffrey B. Rauch and Frank J. Massey, III, Differentiability of solutions to hyperbolic initial-boundary value problems, Trans. Amer. Math. Soc. 189 (1974),\n303\u2013318.\n24. Stephen Smale, Smooth solutions of the heat and wave equations, Comment.\nMath. Helv. 55 (1980), no. 1, 1\u201312.\n\n\fTREATMENT OF INCOMPATIBILITIES\n\n33\n\n25. R. Temam, Behaviour at time t = 0 of the solutions of semilinear evolution\nequations, J. Differential Equations 43 (1982), no. 1, 73\u201392.\n, Navier-Stokes equations, AMS Chelsea Publishing, Providence, RI,\n26.\n2001, Theory and numerical analysis, Reprint of the 1984 edition.\n27. Kevin E. Trenberth, Climate system modeling, Translated from the Russian by\nS. Smith. Translations of Mathematical Monographs, Vol. 23, Press Syndicate\nof the University of Cambridge, New York, NY, USA, 1992.\n28. V.Thomee and L.Wahlbin, Convergence rates of parabolic difference schemes\nfor non-smooth data, Math.Comp. 28 (1974), 1\u201313.\n(QC) Department of Scientific Computing, The Florida State University, Tallahassee, FL 32306\nE-mail address: qchen3@fsu.edu\n(ZQ) The Institute for Scientific Computing and Applied Mathematics, Indiana University, Bloomington, IN 47405\nE-mail address: qinz@indiana.edu\n(RT) The Institute for Scientific Computing and Applied Mathematics, Indiana University, Bloomington, IN 47405\nE-mail address: temam@indiana.edu\n\n\fPenalty Error at Initial Step\n\nPenalty Error at Final Step\n\u22123.5\n\n\u22124\n\n\u22123\n\nError at Final Step (Base on log10)\n\nError at Initial Step (Base on log10)\n\n\u22122.5\n\n\u22123.5\n\n\u22124\n\n\u22124.5\n\n\u22125\n\u22122\n(a)\n\n\u22124.5\n\n\u22125\n\n\u22125.5\n\n\u22126\n\n\u22121.5\n\u22121\n\u22120.5\nEpsilon (Base on log10)\n\n0\n\n\u22126.5\n\u22122\n(b)\n\n\u22121.5\n\u22121\n\u22120.5\nEpsilon (Base on log10)\n\n0\n\n\f"}