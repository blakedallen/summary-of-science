{"id": "http://arxiv.org/abs/1102.1627v1", "guidislink": true, "updated": "2011-02-08T15:20:00Z", "updated_parsed": [2011, 2, 8, 15, 20, 0, 1, 39, 0], "published": "2011-02-08T15:20:00Z", "published_parsed": [2011, 2, 8, 15, 20, 0, 1, 39, 0], "title": "Non-orientable quasi-trees for the Bollobas-Riordan polynomial", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1102.0945%2C1102.2829%2C1102.0135%2C1102.3519%2C1102.1015%2C1102.4340%2C1102.5241%2C1102.2730%2C1102.4756%2C1102.3794%2C1102.3727%2C1102.3923%2C1102.1854%2C1102.0725%2C1102.5585%2C1102.1902%2C1102.3347%2C1102.4356%2C1102.0669%2C1102.3954%2C1102.0232%2C1102.3317%2C1102.0262%2C1102.2188%2C1102.5626%2C1102.2951%2C1102.4007%2C1102.3855%2C1102.3491%2C1102.0894%2C1102.2907%2C1102.3058%2C1102.4522%2C1102.5194%2C1102.3443%2C1102.3958%2C1102.2378%2C1102.3627%2C1102.1168%2C1102.4494%2C1102.4099%2C1102.3200%2C1102.0386%2C1102.4537%2C1102.3838%2C1102.3239%2C1102.2666%2C1102.2349%2C1102.1627%2C1102.2527%2C1102.5616%2C1102.2606%2C1102.2157%2C1102.3459%2C1102.0693%2C1102.0560%2C1102.2369%2C1102.3101%2C1102.1858%2C1102.0695%2C1102.0305%2C1102.4840%2C1102.2090%2C1102.1462%2C1102.0500%2C1102.5260%2C1102.1548%2C1102.0866%2C1102.5388%2C1102.2975%2C1102.0260%2C1102.3083%2C1102.0073%2C1102.0659%2C1102.0912%2C1102.4331%2C1102.2686%2C1102.5176%2C1102.4671%2C1102.2107%2C1102.2348%2C1102.4838%2C1102.5256%2C1102.0085%2C1102.2743%2C1102.0016%2C1102.3689%2C1102.0938%2C1102.0886%2C1102.1183%2C1102.4768%2C1102.1733%2C1102.5227%2C1102.2240%2C1102.5768%2C1102.4177%2C1102.2528%2C1102.3478%2C1102.0354%2C1102.1019%2C1102.5760&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Non-orientable quasi-trees for the Bollobas-Riordan polynomial"}, "summary": "We extend the quasi-tree expansion of A. Champanerkar, I. Kofman, and N.\nStoltzfus to not necessarily orientable ribbon graphs. We study the duality\nproperties of the Bollobas-Riordan polynomial in terms of this expansion. As a\ncorollary, we get a \"connected state\" expansion of the Kauffman bracket of\nvirtual link diagrams. Our proofs use extensively the partial duality of S.\nChmutov.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1102.0945%2C1102.2829%2C1102.0135%2C1102.3519%2C1102.1015%2C1102.4340%2C1102.5241%2C1102.2730%2C1102.4756%2C1102.3794%2C1102.3727%2C1102.3923%2C1102.1854%2C1102.0725%2C1102.5585%2C1102.1902%2C1102.3347%2C1102.4356%2C1102.0669%2C1102.3954%2C1102.0232%2C1102.3317%2C1102.0262%2C1102.2188%2C1102.5626%2C1102.2951%2C1102.4007%2C1102.3855%2C1102.3491%2C1102.0894%2C1102.2907%2C1102.3058%2C1102.4522%2C1102.5194%2C1102.3443%2C1102.3958%2C1102.2378%2C1102.3627%2C1102.1168%2C1102.4494%2C1102.4099%2C1102.3200%2C1102.0386%2C1102.4537%2C1102.3838%2C1102.3239%2C1102.2666%2C1102.2349%2C1102.1627%2C1102.2527%2C1102.5616%2C1102.2606%2C1102.2157%2C1102.3459%2C1102.0693%2C1102.0560%2C1102.2369%2C1102.3101%2C1102.1858%2C1102.0695%2C1102.0305%2C1102.4840%2C1102.2090%2C1102.1462%2C1102.0500%2C1102.5260%2C1102.1548%2C1102.0866%2C1102.5388%2C1102.2975%2C1102.0260%2C1102.3083%2C1102.0073%2C1102.0659%2C1102.0912%2C1102.4331%2C1102.2686%2C1102.5176%2C1102.4671%2C1102.2107%2C1102.2348%2C1102.4838%2C1102.5256%2C1102.0085%2C1102.2743%2C1102.0016%2C1102.3689%2C1102.0938%2C1102.0886%2C1102.1183%2C1102.4768%2C1102.1733%2C1102.5227%2C1102.2240%2C1102.5768%2C1102.4177%2C1102.2528%2C1102.3478%2C1102.0354%2C1102.1019%2C1102.5760&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We extend the quasi-tree expansion of A. Champanerkar, I. Kofman, and N.\nStoltzfus to not necessarily orientable ribbon graphs. We study the duality\nproperties of the Bollobas-Riordan polynomial in terms of this expansion. As a\ncorollary, we get a \"connected state\" expansion of the Kauffman bracket of\nvirtual link diagrams. Our proofs use extensively the partial duality of S.\nChmutov."}, "authors": ["Fabien Vignes-Tourneret"], "author_detail": {"name": "Fabien Vignes-Tourneret"}, "author": "Fabien Vignes-Tourneret", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/j.ejc.2010.12.005", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1102.1627v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1102.1627v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "31 pages, 11 figures", "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05C10, 05C31, 57M27", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1102.1627v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1102.1627v1", "journal_reference": "Europ. J. Comb., 32:510-532, 2011", "doi": "10.1016/j.ejc.2010.12.005", "fulltext": "Non-orientable quasi-trees\nfor the Bollob\u00e1s-Riordan polynomial\nFabien Vignes-Tourneretk\n\narXiv:1102.1627v1 [math.CO] 8 Feb 2011\n\nAbstract\nWe extend the quasi-tree expansion of A. Champanerkar, I. Kofman, and N. Stoltzfus to not necessarily orientable ribbon graphs. We study the duality properties of\nthe Bollob\u00e1s-Riordan polynomial in terms of this expansion. As a corollary, we get\na \"connected state\" expansion of the Kauffman bracket of virtual link diagrams.\nOur proofs use extensively the partial duality of S. Chmutov.\n\nKeywords: ribbon graph, quasi-tree, partial duality, Bollob\u00e1s-Riordan polynomial,\nKauffman bracket.\n\n1 Introduction\nRibbon graphs are a topological generalization of graphs. They can be described in (at\nleast) three different ways: as embedded graphs, as possibly non-orientable surfaces with\nboundary or as triples of permutations describing the vertices, the edges and their possible\ntwists (see fig. 1(a)). In the following, we will mainly adopt the surface point of view.\nIn 1954, W. Tutte defined a graph invariant [17], now named Tutte polynomial, which\nis a generalization of many other invariants such as the chromatic and flow polynomials.\nThe Tutte polynomial may be described either via a spanning subgraph expansion, a\nspanning tree expansion, or, recursively, by reduction relations. More recently, B. Bollob\u00e1s\nand O. Riordan defined a ribbon graph invariant which generalizes the Tutte polynomial.\nThe Bollob\u00e1s-Riordan polynomial also has three different possible definitions. The present\narticle focuses on one of them.\nIt turns out that, for ribbon graphs, the right topological generalization of a spanning\ntree is a quasi-tree. A quasi-tree is a spanning subribbon graph with only one boundary\ncomponent (or face). A. Champanerkar, I. Kofman, and N. Stoltzfus proved that the\nBollob\u00e1s-Riordan polynomial has a quasi-tree expansion [2]. Their work was restricted\nto orientable ribbon graphs. Our article aims at extending their expansion to the nonorientable case.\nVery recently, S. Chmutov defined a generalization of the usual Euler-Poincar\u00e9 (hereafter natural) duality for ribbon graphs [3]. His partial duality consists in forming the\nnatural dual but only with respect to a spanning sub(ribbon)graph. We find that this\nnew duality is an interesting, fruitful and promising framework for the study of ribbon\ngraphs and their invariants. In our opinion, the use of the partial duality simplifies the\nk\n\nUniversit\u00e9 Lyon 1, Institut Camille Jordan, B\u00e2t. Jean Braconnier\n43, bd du 11 novembre 1918, F-69622 Villeurbanne Cedex, France\ne-mail: Fabien.Vignes-Tourneret@math.univ-lyon1.fr\n\n\fformulation of the proofs presented in this article a lot.\nThe paper is organized as follows. In section 2, we recall the basic definitions of a ribbon graph and the partial duality. The spanning tree expansion of the Tutte polynomial\nrelies on a notion of activity of an edge with respect to a spanning tree. Section 3 defines\nthe generalization of Tutte's activities to adapt them to non-plane ribbon graphs and\nquasi-trees. The spanning tree expansion of the Tutte polynomial consists in a factorization of the monomials of the spanning subgraph expansion. To this end, the subgraphs are\ngrouped into packets, each of which is labelled by a spanning tree. In section 4, we group\nthe subribbon graph of a ribbon graph into packets, naturally associated with quasi-trees.\nSection 5 is devoted to the statement and proof of our main theorem, namely a quasi-tree\nexpansion of the Bollob\u00e1s-Riordan polynomial of not necessarily orientable ribbon graphs.\nWe also give the corresponding expansion for the multivariate version of this polynomial\n[12, 18]. In section 6, we recover the duality property of the Bollob\u00e1s-Riordan polynomial,\nnamely its invariance under partial duality at q := xyz 2 = 1 [3, 18], but in terms of its\nquasi-tree expansion. This allows us to get an alternative expression for this polynomial\nat q = 1.\nThe Kauffman bracket of a virtual link diagram and the Bollob\u00e1s-Riordan polynomial\nof ribbon graphs have been proven to be related to each other [3\u20135, 7]. As a consequence,\nthe quasi-tree expansion of the Bollob\u00e1s-Riordan polynomial allows to get such an expansion for the Kauffman bracket. In section 7, we translate this expansion into pure\n\"knot theoretical\" terms to get a connected state (ie a one-component state) expansion\nof the Kauffman bracket of a virtual link diagram. Finally, an appendix exemplifies the\nquasi-tree (resp. connected state) expansion of the Bollob\u00e1s-Riordan polynomial (resp.\nKauffman bracket).\nNote. During the publishing process, the author discovered that a quasi-tree expansion\nfor the (unsigned) Bollob\u00e1s-Riordan polynomial of non-orientable ribbon graphs has been\nderived by Ed Dewey [8]. His expansion is true for any w but does not make use of\nChmutov's partial duality.\n\n2 Partial duality of a ribbon graph\n2.1 Ribbon graphs\nA ribbon graph G is a (not necessarily orientable) surface with boundary represented as\nthe union of two sets of closed topological discs called vertices V (G) and edges E(G).\nThese sets satisfy the following:\n\u2022 vertices and edges intersect by disjoint line segment,\n\u2022 each such line segment lies on the boundary of precisely one vertex and one edge,\n\u2022 every edge contains exactly two such line segments.\nFigure 1(a) shows an example of a ribbon graph. Note that we allow the edges to\ntwist (giving the possibility for the surfaces associated with the ribbon graphs to be\n\n2\n\n\fnon-orientable). A priori an edge may twist more than once but the Bollob\u00e1s-Riordan\npolynomial only depends on the parity of the number of twists (this is indeed the relevant\ninformation for counting the boundary components of a ribbon graph), so that we will\nonly consider edges with at most one twist.\ne3 +\n\ne1 +\n\ne1 +\ne3\n\ne1\ne3 +\n\ne2 \u2212\n\ne2 \u2212\n\n(a) A signed ribbon graph\n\ne2\n\n(b) The combinatorial\nrepresentation\n\nFigure 1: Two representations of a ribbon graph\nDefinition 2.1 (Notations). Let G be a ribbon graph. In the rest of this article, we will\nuse the following notation:\n\u2022 v(G) = card V (G) is the number of vertices of G,\n\u2022 e(G) = card E(G) is the number of edges of G,\n\u2022 k(G) is its number of components,\n\u2022 r(G) = v(G) \u2212 k(G) is its rank,\n\u2022 n(G) = e(G) \u2212 r(G) is its nullity,\n\u2022 f (G) is its number of boundary components (faces),\n\u2022 for all E 0 \u2286 E(G), FE 0 is the spanning sub(ribbon) graph of G the edge-set of which\nis E 0 and\n\u2022 for all E 0 \u2286 E(G), E 0c := E(G) \\ E 0 .\nFor the construction of partial dual graphs, another (equivalent) representation of\nribbon graphs will be useful. It has been introduced in [3] and will be referred to hereafter\nas the \"combinatorial representation\". It can be described as follows: for any ribbon graph\nG, pick out an orientation of each vertex-disc and each edge-disc. The orientation of the\nedges induces an orientation of the line segments along which they intersect the vertices.\nThen draw all vertex-discs as disjoint circles in the plane oriented counterclockwise (say)\nbut for the edges, draw only the arrows corresponding to the orientation of the line\nsegments. Figure 1(b) gives the combinatorial representation of the graph of fig. 1(a).\nEach edge e \u2208 E(G) is represented as a pair of arrows which share the same label e.\nGiven a combinatorial representation, one reconstructs the corresponding ribbon graph\nas follows. Each circle of the representation is filled: this gives the vertex-discs. Let us\nconsider a couple ce of arrows with the same label (i.e. corresponding to the same edge).\nThese two arrows belong to the boundaries of vertices v1 and v2 , which may be equal. One\n\n3\n\n\fdraws an edge which intersects v1 and v2 along the arrows of ce . We now have to decide\nwhether this edge twists or not. This depends on the relative direction of the two arrows.\nActually there is a unique choice (twist or not) such that there exists an orientation of\nthe edge which reproduces the couple of arrows under consideration. So we proceed as\nexplained for each couple of arrows with a common label.\nLoops Unlike the graphs, the ribbon graphs may contain four different kinds of loops.\nA loop may be orientable or not, a non-orientable loop being a twisting edge. Let us\nconsider the general situations of fig. 2. The boxes A and B represent any ribbon graph\nsuch that the picture 2(a) (resp. 2(b)) describes any ribbon graph G with an orientable\n(resp. non-orientable) loop e at vertex v. A loop is said to be nontrivial if there is a\npath in G from A to B which does not contain v. If not the loop is called trivial [1].\n\nA\n\nv\n\nB\n\nA\ne\n\nv\n\nB\ne\n\n(a)\nAn\norientable loop\n\n(b)\nA\nnonorientable\nloop\n\nFigure 2: Loops in ribbon graphs\nA ribbon graph G is said to be signed if an element of {+, \u2212} is assigned to each\nedge. This is achieved via a function \u03b5G : E(G) \u2192 {\u22121, 1}.\n\n2.2 Partial duality\nS. Chmutov introduced a new \"generalized duality\" for ribbon graphs which generalizes\nthe usual notion of duality (see [3]). In [13], I. Moffatt renamed this new duality as \"partial duality\". We adopt this designation here. We now describe the construction of a\npartial dual graph and give a few properties of the partial duality.\nLet G be a ribbon graph and E 0 \u2286 E(G). Let FE 0 be the spanning subribbon graph\n0\nof G whose edge-set is E 0 . We will construct the dual GE of G with respect to the\nedge-set E 0 ; see fig. 3(a) for an example. The general idea is the following. We consider\nthe spanning subribbon graph FE 0 and mark it with arrows to keep track of the edges in\nE(G) \\ E 0 . Then we take the natural dual FE? 0 of the arrow-marked ribbon graph FE 0 .\nFinally we use the arrows on FE? 0 to redraw the edges in E(G) \\ E 0 [14].\nWe now describe the partial duality more precisely. Recall that each edge of G intersects one or two vertex-discs along two line segments. In the following, each time we\nwrite \"line segment\", we mean the intersection of an edge and a vertex.\n0\nWe actually construct the combinatorial representation of the partial dual GE of G.\nWe first choose an orientation for each edge of G. It induces an orientation of the boundaries of the edges. For each edge in E(G) \\ E 0 , and as was explained for the combinatorial\n\n4\n\n\frepresentation, we draw one arrow per oriented line segment at the boundary of that\nedge and in the direction of the orientation. For the edges in E 0 , we proceed differently.\nConsidering them as rectangles, they have two opposite sides that they share with one or\ntwo disc-vertices: these are the line segments defined above. But they also have two other\nopposite sides that we call \"long sides\". The chosen orientation induces an orientation\nof the long sides of the edges in E 0 ; see fig. 3(c) for an example. We draw an arrow on\neach long side of each edge in E 0 according to the chosen orientation. Now draw each\nboundary component of FE 0 as a circle with arrows corresponding to the edges of G.\n0\nThe result is the combinatorial representation of GE ; see figs. 3(d) and 3(e). Note that\n0\nG and GE are generally embedded into different surfaces (they may have different genera).\nAs in the case of the natural duality, and for any E 0 \u2286 E(G), there is a bijection\n0\n0\nbetween the edges of G and the edges of its partial dual GE . Let \u03c6 : E(G) \u2192 E(GE )\ndenote this bijection. We explain now how it is defined from the construction of the\npartial dual graph. As explained above, on each edge e \u2208 E(G), we draw two arrows\ncompatible with an arbitrarily chosen orientation of this edge. If e \u2208 E 0 , these arrows\nare drawn on the long sides of e. If e \u2208 E(G) \\ E 0 , they belong to the line segments\nalong which e intersects its end-vertices. Anyway we label this couple of arrows with\n\u03c6(e). Proceeding like that for all edges of G, we build the combinatorial representation\n0\nof the dual GE namely we get one circle per boundary component of the spanning subribbon graph FE 0 of G. On each of these circles, there are arrows which represent the\n0\n0\nedges of GE . For each couple ce0 of arrows that is for each edge e0 of GE , there exists\na unique e \u2208 E(G) such that ce0 bears the label \u03c6(e). The map \u03c6 is then clearly a bijection.\nFor signed graphs, the partial duality comes with a change of the sign function. The\nfunction \u03b5GE0 is defined by the following equations: for all e \u2208 E \\ E 0 , \u03b5GE0 (e) = \u03b5G (e)\nand for all e \u2208 E 0 , \u03b5GE0 (e) = \u2212\u03b5G (e).\nS. Chmutov proved among other things the following basic properties of the partial\nduality:\nLemma 2.1 ([3]) For any ribbon graph G and any subset of edges E 0 \u2286 E(G), we have\n0\n\n0\n\n\u2022 (GE )E = G,\n\u2022 GE(G) = G? and\n0\n\n0\n\n\u2022 let e \u2208\n/ E 0 ; then GE \u222a{e} = (GE ){e} .\nThe partial duality allows an interesting and fruitful definition of the contraction of\nan edge:\nDefinition 2.1 (Contraction of an edge [1]).\nLet G be a ribbon graph and e \u2208 E(G) any of its edges. We define the contraction of e by\nG/e :=G{e} \u2212 e.\n\n5\n\n(1)\n\n\fe2 \u2212\n\ne1 +\n\n(a) A ribbon graph G\nwith E 0 = {e1 }\ne02\n\ne2 \u2212\n\ne2\n\ne1 +\n\ne1\n\n(b) The combinatorial\nrepresentation of G\n\ne02\n\ne02 \u2212\ne01\n\ne01\n\ne01 \u2212\ne02\n\ne01\n\n(c) The boundary\ncomponent of FE 0\n\n(d) The combinatorial representa0\ntion of GE\n\ne01 \u2212\n\ne02 \u2212\n\n(e) The dual GE\n\n0\n\nFigure 3: Construction of a partial dual\n\nFrom the definition of the partial duality, one easily checks that, for an edge incident with\ntwo different vertices, the definition 2.1 coincides with the usual intuitive contraction of\nan edge. The contraction of a loop depends on its orientability; see figs. 4 and 5.\nDifferent definitions of the contraction of a loop have been used in the literature. One\ncan define G/e := G \u2212 e. In [10], S. Huggett and I. Moffatt give a definition which leads\nto surfaces which are no longer ribbon graphs. The definition 2.1 maintains the duality\nbetween contraction and deletion.\n\nA\n\nB\n\nA\n\ne\n\n\u2212\u2192\ne\n\nG{e}\n\nA ribbon graph G with an\norientable loop e\n\n\u2212\u2192\n\nA\n\nB\n\nG/e = G{e} \u2212 e\nFigure 4: Contraction of an orientable loop\n\n6\n\nB\n\n\fA\n\nA\n\nB\n\nB\n\n\u2212\u2192\ne\n\ne\n\n{e}\n\nA ribbon graph G with a\nnon-orientable loop e\n\nG\n\nA\n\n\u2212\u2192\n\nB\n\nG/e = G{e} \u2212 e\nFigure 5: Contraction of a non-orientable loop\n\n3 Activities with respect to a quasi-tree\nDefinition 3.1 (Quasi-tree [2, 6]). A quasi-tree Q is a ribbon graph with f (Q) = 1.\nLet G be a ribbon graph that is not necessarily orientable. The set of spanning subribbon\ngraphs of G which are quasi-trees is denoted by QG .\nA quasi-tree is a generalization of a spanning tree in the following sense. If G is a plane\nribbon graph, then QG is the set of spanning trees of G. For a non-plane ribbon graph\nG, QG contains the spanning trees of G and each quasi-tree contains a spanning tree.\nDefinition 3.2 (Crossing edges). Let G be a one-vertex ribbon graph. Let e, e0 \u2208 E(G)\nbe two edges of G. They intersect the vertex of G along line segments s1 (e), s2 (e), s1 (e0 )\nand s2 (e0 ). The edges e and e0 cross each other (written en\noe0 ) if, turning around the\nvertex of G (in any direction), one meets the line segments of e and e0 alternately, say\ns1 (e), s1 (e0 ), s2 (e), s2 (e0 ).\nFor example, in fig. 6(a), e1 o\nne2 , e1 o\nne3 but e2 and e3 do not cross each other.\ne1\n\ne1\n\ne2\ne2\n\ne3\n\ne3\n\n(b) Its dual G{e1 }\n\n(a) A ribbon graph G\n\nFigure 6: Crossing and linking edges\nIf Q is a quasi-tree of a ribbon graph G, the partial dual GE(Q) of G is a one-vertex\nribbon graph.\n\n7\n\n\fDefinition 3.3 (Linking edges). Let G be a ribbon graph and e, e0 \u2208 E(G) be two of\nits edges. Let Q be a quasi-tree in G. We say that e and e0 link each other (with respect\nto Q) if they cross each other in GE(Q) .\nOne of the quasi-trees of the ribbon graph of figure fig. 6(a) is F{e1 } . The edges e2 and e3\nlink each other with respect to F{e1 } : they cross each other in G{e1 } ; see fig. 6(b).\nRemark. In [2] the authors associated a chord diagram with any ribbon graph G and\nquasi-tree Q \u2208 QG . They defined two edges to link each other if their corresponding\nchords cross each other. This definition is actually the same as definition 3.3 as the circle\nof the chord diagram in [2] is the boundary of the unique vertex in GE(Q) .\nDefinition 3.4 (Activities with respect to a quasi-tree). Let G be a ribbon graph\nand Q \u2208 QG one of its quasi-trees. Let \u227a be a total order on the set E(G) of edges of G.\nAn edge e \u2208 E(G) is said to be live if it does not link any lower-ordered edge; otherwise\nit is dead. Moreover e is internal if it belongs to E(Q) and external otherwise.\nWe let I(Q) be the set of internally live edges of G (with respect to \u227a). Let Io (Q)\n(resp. In (Q)) be the set of internally live edges that form orientable (resp. non-orientablea )\nloops in GE(Q) . Obviously Io (Q) \u2229 In (Q) = \u2205 and I(Q) = Io (Q) \u222a In (Q). We define\nsimilarly E(Q), Eo (Q) and En (Q) for the externally live edges.\nFinally we let D(Q) be the set of internally dead edges of G with respect to Q and \u227a.\nOne easily checks that for plane ribbon graphs, definition 3.4 of live (resp. dead) edges\ncoincides with the definition of active (resp. inactive) edges in the spanning tree expansion\nof the Tutte polynomial [17]. In contrast, for non-plane ribbon graphs, those definitions\nare different. First of all there are more quasi-trees than spanning trees but even with\nrespect to a spanning tree the activities are different. Let us once more consider the\nexample of fig. 6(a) with e1 \u227a e2 \u227a e3 . The only spanning tree in G is F\u2205 (and G\u2205 = G).\nAll edges are externally active but I = D = \u2205, E = En = {e1 } and e2 , e3 are externally\ndead. With respect to the quasi-tree F{e1 } , we have I = In = {e1 }, D = \u2205 and e2 , e3 are\nexternally dead.\n\na\n\nAs v(GE(Q) ) = 1, any edge of GE(Q) is a loop. In the following, when we write that an edge is\norientable (or not) it always means \"as a loop in a certain GE(Q) \".\n\n8\n\n\f4 Binary tree of partial resolutions\nFollowing [2], we construct a rooted binary tree which allows us to group the spanning\nsubribbon graphs of a given connected ribbon graph into packets labelled by the quasitrees of G. The members of these packets are in one-to-one correspondence with the\nsubsets of orientable internally and externally live edges; see lemma 4.4.\n\n4.1 Partial resolutions and duality\nIn this section, we prove two lemmas about resolutions and quasi-trees. These lemmas\nwill be useful for the proof of lemma 4.4. The proofs below use Chmutov's partial duality.\nDefinition 4.1 (Resolutions). Let G be a ribbon graph. A resolution s of G is a map\nfrom E(G) into {0, 1}. Each resolution determines a spanning subribbon graph Hs such\nthat E(Hs ) := {e \u2208 E(G) : s(e) = 1}.\nA partial resolution \u03c1 of G is a map from E(G) into {0, 1, \u2217}. We define H\u03c1 to\nbe the spanning subribbon graph of G whose edge-set is {e \u2208 E(G) : \u03c1(e) = 1}. We let\nU (\u03c1) := {e \u2208 E(G) : \u03c1(e) = \u2217} be the set of unresolved edges. Each partial resolution\ndetermines a subset of the spanning subribbon graphs of G:\n[\u03c1] := {resolutions s of G : s(e) = \u03c1(e) if \u03c1(e) \u2208 {0, 1}}.\nLet F \u2286 G be a spanning subribbon graph of G. The number of faces of F equals the\nnumber of vertices of its natural dual F ? . But in the following it will be necessary to\nexpress this number in terms of the partial dual of G with respect to E(F ), namely\nf (F ) =v(F ? ) = v(GE(F ) ).\n\n(2)\n\nProposition 4.1 Let G be a ribbon graph and F, F 0 \u2286 G two spanning subribbon graphs\nof G. Let \u2206 := \u2206(F, F 0 ) = (E(F ) \u222a E(F 0 )) \\ (E(F ) \u2229 E(F 0 )). Then we have\n\u0001\nf (F 0 ) = v (GE(F ) \u2212 \u2206c )/\u2206 .\n(3)\n\u0010\n\u0001\u2206\n\u0001\u2206 \u0011\n0\n0\nProof. As in eq. (2), f (F 0 ) = v(GE(F ) ). But GE(F ) = GE(F ) so f (F 0 ) = v GE(F )\n=\n\u0010\n\u0011\n\u0001\n\u2206\nv GE(F ) \u2212 E(G) . Using E(G) = \u2206 \u222a \u2206c and for any ribbon graph G and any\n0\n\n0\n\nE\u00100 , E 00 \u2286 E(G) such \u0011\nthat E 0 \u2229 E 00 = \u2205, GE \u2212 E 00 = (G \u2212 E 00 )E , we have f (F 0 ) =\n\u0001\n\u0001\n\u2206\nv GE(F ) \u2212 \u2206c \u2212 \u2206 = v (GE(F ) \u2212 \u2206c )/\u2206 by definition 2.1.\n\u0003\nLemma 4.2 Let G be a ribbon graph and s a resolution of G such that Hs is a quasi-tree.\nLet e be an edge of G, not necessarily in E(Hs ). Let s0 be defined by\n(\ns\non E(G) \\ {e},\ns0 =\n(4)\n1 \u2212 s on {e}.\nIf e is a non-orientable loop in GE(Hs ) , then Hs0 is also a quasi-tree.\n\n9\n\n\fProof. We are going to use proposition 4.1 with F = Hs and F 0 = Hs0 . As e \u2208 Hs \u21d0\u21d2\ne\u2208\n/ Hs0 , \u2206 = {e}. F being a quasi-tree, GE(F ) is a one-vertex ribbon graph and GE(F ) \u2212\n\u2206c =: H 0 consists of the unique vertex of GE(F ) and the loop e. By proposition 4.1\nthe number of faces of F 0 equals the number of vertices of H 0 /\u2206. Proving that F 0 is a\nquasi-tree amounts to proving that H 0 /{e} is a one-vertex graph. By assumption e is\nnon-orientable in GE(Hs ) . It is then non-orientable in H 0 . Thanks to the definition 2.1,\nits contraction leads to a one-vertex ribbon graph.\n\u0003\nLemma 4.3 Let G be a ribbon graph and s a resolution of G such that Hs is a quasi-tree.\nLet e, e0 be two edges of G, not necessarily in E(Hs ). Let s0 be defined by\n(\ns\non E(G) \\ {e, e0 },\ns0 =\n(5)\n1 \u2212 s on {e, e0 }.\nIf e and e0 link each other with respect to Hs and at most one of them is a non-orientable\nloop in GE(Hs ) , then Hs0 is also a quasi-tree.\nProof. We distinguish between three cases: 1. e, e0 \u2208 E(Hs ), 2. neither e nor e0 belongs\nto E(Hs ) and 3. e \u2208 E(Hs ) and e0 \u2208\n/ E(Hs ) (or the converse). We are now going to use\nproposition 4.1 with F = Hs and F 0 = Hs0 . In the three cases, \u2206 = {e, e0 }. Hs = F being\na quasi-tree, GE(F ) is a one-vertex ribbon graph. Then GE(F ) \u2212 \u2206c consists of the vertex\nof GE(F ) and the two loops e and e0 . By assumption these link each other which means\nthat they cross each other in GE(F ) .\nWe have to consider two cases: 1. both e and e0 are orientable in GE(Hs ) , 2. one of\nthem is non-orientable, say e and the other one (e0 ) is orientable.\n1. The contraction of e gives two vertices linked by a bridge e0 . The contraction of e0\nis a single vertex.\n2. The contraction of e leads to a one-vertex ribbon graph with a single non-orientable\nloop e0 . The contraction of e0 leads to a single vertex and f (F 0 ) = 1.\n\u0003\n\n4.2 Binary tree\nDefinition 4.2 (Nugatory edges). Let G be a ribbon graph and \u03c1 one of its partial\nresolutions. Let e \u2208 E(G) and \u03c1e0 (resp. \u03c1e1 ) be the partial resolution of G obtained from\n\u03c1 by resolving e to be 0 (resp. 1). The edge e is called nugatory if [\u03c1e0 ] or [\u03c1e1 ] does not\ncontain any quasi-tree of G.\nFor any connected ribbon graph G and any total order on E(G), we now describe the\nconstruction of the binary tree T (G). Each of its nodes is a partial resolution of G. The\nconstruction essentially follows [2]. Let the root of T (G) be the totally unresolved partial resolution of G: for all e \u2208 E(G), \u03c1(e) = \u2217. We resolve edges, in the reverse order\n(starting with the highest edge), by changing \u2217 to 0 or 1. If an edge is nugatory, it is\nleft unresolved and we proceed to the next edge. For a given node \u03c1 in T (G), if e is not\nnugatory then the left child is \u03c1e0 and the right child is \u03c1e1 . We terminate this process at\na leaf when all subsequent edges are nugatory or all edges have been resolved.\n\n10\n\n\fLet us now give an example of such a binary tree. We consider the ribbon graph of\nfig. 6(a) with e1 \u227a e2 \u227a e3 . The associated binary tree is represented in fig. 7. Each node\nof the tree is a partial resolution; for instance \u221710 corresponds to \u03c1(e1 ) = \u2217, \u03c1(e2 ) = 1 and\n\u03c1(e3 ) = 0.\n000\n\n100\n\n\u221710\n\u221700\n\n\u2217\u22171\n\u2217\u22170\n\n\u2217\u2217\u2217\n\nFigure 7: A binary tree of partial resolutions\nBy construction, each leaf \u03c1 of such a binary tree T (G) is a partial resolution of G\nall the unresolved edges of which are nugatory. Therefore there exists a unique resolution\ns \u2208 [\u03c1] such that Hs is a quasi-tree. Indeed, let us consider a node of the binary tree\nT (G) i.e. a partial resolution \u03c3 of G. Let e be the edge to be tested at this node. If e is\nnugatory, either [\u03c30e ] or [\u03c31e ] contains a quasi-tree. If e is not nugatory, they both contain a\nquasi-tree. Thus, by induction, for each leaf \u03c1 of T (G), [\u03c1] contains at least one quasi-tree.\nLet us assume that it contains more than one quasi-tree. This would mean that there\nexists an unresolved edge e in \u03c1 such that both [\u03c1e0 ] and [\u03c1e1 ] contain a quasi-tree. But this\nis in contradiction with the fact that all unresolved edges of a leaf are nugatory.\nWe let Q\u03c1 be the unique quasi-tree in [\u03c1]. For each spanning subribbon graph Hs , s \u2208\n[\u03c1] we define QHs to be Q\u03c1 .\nLemma 4.4 Let G be a connected ribbon graph. Let \u03c1 be a leaf of T (G), and let Q\u03c1\nbe the corresponding quasi-tree. If e is unresolved in \u03c1 then e is orientable in GE(Q\u03c1 )\nand live with respect to Q\u03c1 . If e is resolved in \u03c1, it is either dead with respect to Q\u03c1 or\nnon-orientable in GE(Q\u03c1 ) and live.\nProof. Let e be an unresolved edge of a leaf \u03c1 of T (G). If e is non-orientable in GE(Q\u03c1 )\nthen by lemma 4.2 there exist two different resolutions in [\u03c1] corresponding to quasi-trees.\nThis contradicts the fact that e is nugatory. As a conclusion, nugatory edges are orientable in GE(Q\u03c1 ) .\nLet ei and ej be two unresolved edges in \u03c1, which are therefore nugatory and orientable in\nGE(Q\u03c1 ) . If ei o\nnej , by lemma 4.3, there exists two different resolutions in [\u03c1] corresponding\nto quasi-trees. This contradicts the fact that ei and ej are nugatory. Thus unresolved\nedges can only link resolved ones.\nSuppose ei is unresolved in \u03c1 and links a resolved edge ej with j \u227a i. Let s \u2208 [\u03c1] be\nthe resolution such that Hs = Q\u03c1 . The edge ei being unresolved in \u03c1, is orientable in\n\n11\n\n\fGE(Q\u03c1 ) , so we can apply lemma 4.3. Thus there exists another partial resolution s0 such\nthat f (Hs0 ) = 1. s0 is obtained from s by changing only s(ei ) and s(ej ).\nNow there exists a unique closest parent \u03c1e of \u03c1 in T (G) such that ej is a non-nugatory\ne\ne\nunresolved edge in \u03c1e. If s \u2208 [e\n\u03c10j ] (say) then s0 \u2208 [e\n\u03c11j ]. This implies that ei is not nugatory\nin \u03c1e and contradicts the assumption that j \u227a i because if that were the case and since\nedges are resolved in the reverse order, ei should be nugatory in \u03c1e. Thus if ei o\nnej , i \u227a j\nand ei is live.\nFinally, let ei be a resolved edge in \u03c1. If ei links an unresolved edge ej then by the\nprevious argument j \u227a i and ei is dead. So let us assume that ei only links resolved\nedges {ej }j\u2208R , R \u2282 {1, . . . , |E(G)|}. If there exists one j \u2208 R such that j \u227a i, ei is dead.\nSuppose therefore that for all j \u2208 R, i \u227a j. There exists a unique closest parent \u03c1e of\n\u03c1 in T (G) such that ei is a non-nugatory unresolved edge in \u03c1e. Edges are resolved in\nreverse order, so the ej 's, j \u2208 R are resolved in \u03c1e. Moreover both [e\n\u03c1e0i ] and [e\n\u03c1e1i ] contain\na quasi-tree. If ei is orientable and does not link an unresolved edge, it is an orientable\ntrivial loop in GE(Q\u03c1 ) \u2212 {ej }j\u2208R . Suppose that \u03c1 \u2208 [e\n\u03c1e0i ] (resp. [e\n\u03c1e1i ]). Then by proposition\nc\nproposition 4.1, and since \u2206 and \u2206 being disjoint, we can change the order of contraction\n\u03c1e0i ]), and f (Hs ) = v(GE(Q\u03c1 ) /\u2206 \u2212 \u2206c ) > 2 with ei \u2208 \u2206\nand deletion, for all s \u2208 [e\n\u03c1e1i ] (resp. [e\n\u03c1e1i ] does not contain any quasi-tree which\nand for all j \u2208 R, ej \u2208\n/ \u2206. Thus either [e\n\u03c1e0i ] or [e\ncontradicts the fact that ei is resolved. Therefore ei links an unresolved edge and is dead.\nNote finally that if R = \u2205 i.e. if ei does not link any edge, exactly the same reasoning\n\u03c1e0i ]) does not contain\n\u03c1e1i ] (resp. [e\n\u03c1e1i ]), [e\napplies as well. Namely, if ei \u2208 [e\n\u03c1e0i ] (resp. ei \u2208 [e\nany quasi-tree. This contradicts the fact that ei is resolved in \u03c1 and proves that ei links\nan unresolved edge.\n\u0003\nRemark. Concerning the last part of the preceding proof, if ei is non-orientable and only\nlinks higher-ordered edges, it does not need to link an unresolved edge to ensure that both\n\u03c11ei ] contain a quasi-tree. Thus non-orientable (resolved) edges may be live. For\n[e\n\u03c1e0i ] and [e\nexample, in the leaf 100 of the binary tree in fig. 7 (which corresponds to the graph of\nfig. 6(a)), the edge e1 is non-orientable, resolved and live.\nTo sum up this section, we have proven the following\nCorollary 4.5 Let G be a connected ribbon graph and SG its set of spanning subribbon\nS graphs. Given a total order on E(G), SG is in one-to-one correspondence with\nQ\u2208QG Io (Q) \u00d7 Eo (Q). Namely to each spanning subribbon graph F there corresponds\na unique quasi-tree QF . Then, there exists S \u2286 Io (QF ) \u222a Eo (QF ) such that E(F ) =\nD(QF ) \u222a In (QF ) \u222a S.\n\n12\n\n\f5 Non-orientable quasi-tree expansions\n5.1 The (signed) Bollob\u00e1s-Riordan polynomial\nThis section is devoted to the statement and proof of our main theorem, namely a quasitree expansion of the signed Bollob\u00e1s-Riordan polynomial of not necessarily orientable\nribbon graphs. For any subribbon graph F of G, we let t(F ) be 0 if F is orientable\nand 1 otherwise. Recall that for any ribbon graph G, the (unsigned) Bollob\u00e1s-Riordan\npolynomial is defined by [1]\nX\nR(G; x, y, z, w) =\n(x \u2212 1)r(G)\u2212r(F ) y n(F ) z (k\u2212f +n)(F ) wt(F )\n(6)\nF \u2286G\n\nconsidered as an element of the quotient of Z[x, y, z, w] by the ideal generated by w2 \u2212 w.\nS. Chmutov and I. Pak introduced an extension of the Bollob\u00e1s-Riordan polynomial at\nw = 1 [4]. It is a three-variable polynomial Rs defined on signed ribbon graphs. Recall\nthat a graph is said to be signed if to each of its edges, an element of {+, \u2212} is assigned.\nFor any signed ribbon graph G, let E+ (G) (resp. E\u2212 (G)) be the set of positive (resp.\nnegative) edges of G, and let e\u00b1 (G) be their respective cardinalities. For any spanning\nsubribbon graph F of G, let F denote the spanning subribbon graph of G with edge-set\nE(F )c . Let us finally define s(F ) := 21 (e\u2212 (F ) \u2212 e\u2212 (F )). The signed Bollob\u00e1s-Riordan\npolynomial is\nX\nRs (G; x + 1, y, z) =\nxk(F )\u2212k(G)+s(F ) y n(F )\u2212s(F ) z (k\u2212f +n)(F ) .\n(7)\nF \u2286G\n\ne x, y, z, 1) where G\ne is the underlying\nIf all the edges of G are positive, Rs (G; x, y, z) = R(G;\nunsigned ribbon graph in G.\nBefore stating our main theorem, we need to recall the definition of the rank polynomial\nof C. Godsil and G. Royle [9]. It is a four-variable polynomial defined on matroids.\nNevertheless, restricting ourselves to graphic matroids, we can easily deduce a version of\nthis polynomial for graphs.\nDefinition 5.1 (The Rank polynomial [9]). Let G be a graph (not a ribbon graph).\nThe rank polynomial is defined as follows:\nX\n(8)\nRa(G; \u03b1, \u03b2, \u03b3, \u03b4) =\n\u03b1e+ (F )+e\u2212 (F ) \u03b2 e+ (F )+e\u2212 (F ) \u03b3 k(F )\u2212k(G) \u03b4 n(F )\nF \u2286G\n\nwhere the sum runs over the spanning subgraphs of G.\nNote that the rank polynomial is homogeneous in \u03b1, \u03b2: the sum of the exponents of \u03b1\nand \u03b2 is constant and equals e(G). Thus we have\nRa(G; \u03b1, \u03b2, \u03b3, \u03b4) =\u03b1e(G) Ra(G; 1, \u03b2/\u03b1, \u03b3, \u03b4).\nThe rank polynomial is a generalization of the Tutte polynomial:\nX\nT (G; x, y) :=\n(x \u2212 1)k(F )\u2212k(G) (y \u2212 1)n(F ) = Ra(G; 1, 1, x \u2212 1, y \u2212 1).\nF \u2286G\n\n13\n\n(9)\n\n(10)\n\n\fThe signed and unsigned Bollob\u00e1s-Riordan polynomial s are multiplicative on disjoint\nunions of ribbon graphs, so we can restrict ourselves to connected ribbon graphs, without\nloss of generality.\nDefinition 5.2. Let G be a connected ribbon graph. For any total order on E(G) and\nany quasi-tree Q \u2208 QG , let GQ be the graph (not the ribbon graph) whose vertices are\nthe components of FD(Q)\u222aIn (Q) and whose edges are the internally live orientable edges\ne underlying G.\n(namely the elements of Io (Q)). In other words, consider the graph G\ne Then GQ := G/f\ne (D(Q)\u222aIn (Q))\nThere is obviously a bijection f between E(G) and E(G).\n(remember that, in a graph, the contraction of a loop consists in its deletion).\nTheorem 5.1 (Quasi-tree expansion) Let G be a connected signed ribbon graph. For\nany total order on E(G), the signed Bollob\u00e1s-Riordan polynomial is given by\nX\nRs (G; x + 1, y, z) =(x\u22121/2 y 1/2 ) e\u2212 (G)\nxe\u2212 (D(Q)\u222aIn (Q)) y n(FD(Q)\u222aIn (Q) )\u2212e\u2212 (D(Q)\u222aIn (Q))\nQ\u2208QG\n\nz\n\n(k\u2212f +n)(FD(Q)\u222aIn (Q) )\n\n(1 + x)e\u2212 (Eo (Q)) (1 + y)e+ (Eo (Q))\n\n(x1/2 y \u22121/2 )r(GQ )+e\u2212 (Io (Q)) Ra(GQ ; 1, x\u22121/2 y 1/2 , x1/2 y 1/2 , x1/2 y 1/2 z 2 )\n(11)\nwhere, for all E 0 \u2286 E(G), E\u00b1 (E 0 ) := E\u00b1 (G) \u2229 E 0 , and e\u00b1 (E 0 ) := |E\u00b1 (G) \u2229 E 0 |.\nCorollary 5.2 Let G be a connected ribbon graph. For any total order on E(G), the\nBollob\u00e1s-Riordan polynomial at w = 1 is given by\nX\ny n(FD(Q)\u222aIn (Q) ) z (k\u2212f +n)(FD(Q)\u222aIn (Q) ) (1 + y)|Eo (Q)| T (GQ ; x, yz 2 + 1)\nR(G; x, y, z, 1) =\nQ\u2208QG\n\nwhere T (GQ ) is the Tutte polynomial of GQ .\nBefore proving theorem 5.1, let us comment on the fact that, in corollary 5.2, we get a\nquasi-tree expansion only at w = 1. To extend our expansion to the full Bollob\u00e1s-Riordan\npolynomial (namely for any w), we would need in particular to relate the orientability of\nany subgraph to the orientability of FD\u222aIn . This has been done in [8].\nThe proof of theorem 5.1 relies on the following lemma:\nLemma 5.3 Let G be a connected ribbon graph. Let Q \u2208 QG be a quasi-tree in G. Given\na total order on E(G), and for any S = S1 \u222a S2 with S1 \u2282 Io (Q) and S2 \u2282 Eo (Q), we\nhave\n\u2022 k(FD(Q)\u222aIn (Q)\u222aS ) = k(FD(Q)\u222aIn (Q)\u222aS1 ) = k(W ), where W is the spanning subgraph of\nGQ , the edge-set of which is S1 ,\n\u2022 f (FD(Q)\u222aIn (Q)\u222aS ) = f (FD(Q)\u222aIn (Q) ) \u2212 |S1 | + |S2 |.\n\n14\n\n\fProof. The edges in S being orientable, the proof follows the one given in [2]. But we\nreformulate it in terms of S. Chmutov's duality.\nLet e \u2208 S2 . We want to prove that k(FD(Q)\u222aIn (Q)\u222aS ) = k(FD(Q)\u222aIn (Q)\u222aS\\{e} ) that is\nto say that e intersects only one component of FD(Q)\u222aIn (Q)\u222aS\\{e} . Clearly if e intersects\nonly one component of FD(Q)\u222aIn (Q)\u222aS1 , it does so a fortiori in FD(Q)\u222aIn (Q)\u222aS\\{e} . Then it is\nenough to prove that k(FD(Q)\u222aIn (Q)\u222aS1 \u222a{e} ) = k(FD(Q)\u222aIn (Q)\u222aS1 ). Actually we are going to\nprove an even stronger statement, namely that e only intersects one boundary component\nof FD(Q)\u222aIn (Q)\u222aS1 . This would obviously imply the desired result.\nThe boundary components of a ribbon graph are the vertices of its natural dual. We\nwill therefore prove that e is a loop in (FD(Q)\u222aIn (Q)\u222aS1 \u222a{e} )D(Q)\u222aIn (Q)\u222aS1 .\n(FD(Q)\u222aIn (Q)\u222aS1 \u222a{e} )D(Q)\u222aIn (Q)\u222aS1 =GE(Q) /S1 \u2212 (Eo (Q) \\ {e}) \u222a En (Q) \u222a D(Q)\n=:GE(Q) /S1 \u2212 A\n\n\u0001\n\n(12)\n(13)\n\nwith S1 := Io (Q) \\ S1 , D(Q) the set of externally dead edges and where we used E(Q) =\nD(Q) \u222a In (Q) \u222a Io (Q) and definition 2.1. Q being a quasi-tree, GE(Q) \u2212 A is a one-vertex\nribbon graph with edges in D(Q) \u222a In (Q) \u222a Io (Q) \u222a {e}. The edges in S1 \u222a {e} are all\nunresolved in the partial resolution \u03c1 of T (G) such that Q\u03c1 = Q. Therefore they do not\ncross each other in GE(Q) ; see the proof of lemma 4.4. As a consequence the edge e is still\na loop in GE(Q) /S1 and the first equality of the first item follows.\nThe proof that k(FD(Q)\u222aIn (Q)\u222aS1 ) = k(W ) is obvious from the definition 5.2 of GQ .\nLet us now prove the second statement of the lemma:\n\u0001\n?\nD(Q)\u222aIn (Q)\u222aS\nE(Q)\n\u222a\nS\n)\n(14)\nf (FD(Q)\u222aIn (Q)\u222aS ) =v(FD(Q)\u222aI\n)\n=\nv(G\n)\n=\nv\nG\n/(S\n1\n2\nn (Q)\u222aS\n\u0001\n(15)\nf (FD(Q)\u222aIn (Q) ) =v GE(Q) /Io (Q)\nBut the edges in Io (Q) \u222a Eo (Q) do not cross each other in GE(Q) (see the proof of\nlemma 4.4). Thus, given the definition 2.1 of the contraction of a loop, we have\nf (FD(Q)\u222aIn (Q)\u222aS ) =v(GE(Q) ) + |S1 | + |S2 |,\n\n(16)\n\nf (FD(Q)\u222aIn (Q) ) =v(GE(Q) ) + |S1 | + |S1 |\n\n(17)\n\nwhich implies f (FD(Q)\u222aIn (Q)\u222aS ) = f (FD(Q)\u222aIn (Q) ) \u2212 |S1 | + |S2 |.\n\n\u0003\n\nCorollary 5.4 Let G be a connected ribbon graph. Let Q \u2208 QG be a quasi-tree in G.\nGiven a total order on E(G) and for any S = S1 \u222a S2 with S1 \u2282 Io (Q) and S2 \u2282 Eo (Q),\nwe have\n\u2022 n(FD(Q)\u222aIn (Q)\u222aS ) = n(FD(Q)\u222aIn (Q) ) + n(W ) + |S2 |,\n\u2022 (k \u2212 f + n)(FD(Q)\u222aIn (Q)\u222aS ) = (k \u2212 f + n)(FD(Q)\u222aIn (Q) ) + 2n(W ).\n\n15\n\n\fProof. Using now lemma 5.3, we have\nn(FD(Q)\u222aIn (Q)\u222aS ) =(e \u2212 v + k)(FD(Q)\u222aIn (Q)\u222aS )\n=e(FD(Q)\u222aIn (Q)\u222aS1 ) + |S2 | \u2212 v(G) + k(FD(Q)\u222aIn (Q)\u222aS1 )\n=n(FD(Q)\u222aIn (Q)\u222aS1 ) + |S2 |,\n\n(18)\n(19)\n(20)\n\nn(W ) =e(W ) \u2212 v(W ) + k(W )\n=|S1 | \u2212 k(FD(Q)\u222aIn (Q) ) + k(FD(Q)\u222aIn (Q)\u222aS1 ),\n\n(21)\n(22)\n\nn(FD(Q)\u222aIn (Q)\u222aS1 ) =e(FD(Q)\u222aIn (Q) ) + |S1 | \u2212 v(G) + k(FD(Q)\u222aIn (Q)\u222aS1 )\n=e(FD(Q)\u222aIn (Q) ) \u2212 v(G) + k(FD(Q)\u222aIn (Q) )\n+ |S1 | \u2212 k(FD(Q)\u222aIn (Q) ) + k(FD(Q)\u222aIn (Q)\u222aS1 )\n=n(FD(Q)\u222aIn (Q) ) + n(W )\n\n(23)\n(24)\n(25)\n\nEquations (eq. (20)) and (eq. (25)) imply n(FD(Q)\u222aIn (Q)\u222aS ) = n(FD(Q)\u222aIn (Q) )+n(W )+|S2 |.\n(k \u2212 f + n)(FD(Q)\u222aIn (Q)\u222aS ) =k(FD(Q)\u222aIn (Q)\u222aS1 ) \u2212 f (FD(Q)\u222aIn (Q) ) + |S1 | \u2212 |S2 |\n+ n(FD(Q)\u222aIn (Q) ) + n(W ) + |S2 |\n=(k \u2212 f + n)(FD(Q)\u222aIn (Q) ) + k(FD(Q)\u222aIn (Q)\u222aS1 )\n\u2212 k(FD(Q)\u222aIn (Q) ) + |S1 | + n(W )\n=(k \u2212 f + n)(FD(Q)\u222aIn (Q) ) + 2n(W )\nwhich proves corollary 5.4.\n\n(26)\n(27)\n(28)\n\u0003\n\nProof of theorem 5.1. Thanks to corollary 4.5, the signed Bollob\u00e1s-Riordan polynomial\ncan be written as follows\nX\nX X\nRs (G; x + 1, y, z) =(x\u22121/2 y 1/2 )e\u2212 (G)\nxk(FD(Q)\u222aIn (Q)\u222aS )\u2212k(G)+e\u2212 (D(Q)\u222aIn (Q)\u222aS)\nQ\u2208QG S1 \u2282Io (Q) S2 \u2282Eo (Q)\n\ny n(FD(Q)\u222aIn (Q)\u222aS )\u2212e\u2212 (D(Q)\u222aIn (Q)\u222aS) z (k\u2212f +n)(FD(Q)\u222aIn (Q)\u222aS )\n\n(29)\n\nwhere S = S1 \u222a S2 . Using now lemma 5.3 and corollary 5.4, we have\nX\nRs (G; x + 1, y, z) =(x\u22121/2 y 1/2 )e\u2212 (G)\nxe\u2212 (D(Q)\u222aIn (Q)) y n(FD(Q)\u222aIn (Q) )\u2212e\u2212 (D(Q)\u222aIn (Q))\nQ\u2208QG\n\nz (k\u2212f +n)(FD(Q)\u222aIn (Q) )\n\nX\n\nxe\u2212 (S2 ) y e+ (S2 )\n\nxk(W )\u2212k(GQ )+e\u2212 (W ) (yz 2 )n(W ) y \u2212e\u2212 (W ) (30)\n\nW \u2286GQ\n\nS2 \u2286Eo (Q)\n\n=(x\u22121/2 y 1/2 )e\u2212 (G)\n\nX\n\nX\n\nxe\u2212 (D(Q)\u222aIn (Q)) y n(FD(Q)\u222aIn (Q) )\u2212e\u2212 (D(Q)\u222aIn (Q))\n\nQ\u2208QG\n\nz\n\n(k\u2212f +n)(FD(Q)\u222aIn (Q) )\n\nX\n\n(1 + x)e\u2212 (Eo (Q)) (1 + y)e+ (Eo (Q))\n\nxk(W )\u2212k(GQ )+e\u2212 (W ) (yz 2 )n(W ) y \u2212e\u2212 (W )\n\nW \u2286GQ\n\n16\n\n(31)\n\n\fwhere we used k(G) = k(GQ ) = 1. To conclude, it remains to prove that\nX\nxk(W )\u2212k(GQ )+e\u2212 (W ) (yz 2 )n(W ) y \u2212e\u2212 (W )\nW \u2286GQ\n\n=(x1/2 y \u22121/2 )r(GQ )+e\u2212 (Io (Q)) Ra(GQ ; 1, x\u22121/2 y 1/2 , x1/2 y 1/2 , x1/2 y 1/2 z 2 )\nwhich is easily checked from definition 5.1 of the rank polynomial.\n\n(32)\n\u0003\n\ncorollary 5.2 is a direct consequence of theorem theorem 5.1. It is indeed easily verified\nthat, if G is a signed ribbon graph with only positive edges, the right hand side of (eq. (11))\nreduces to the desired expression of corollary 5.2.\n\n5.2 The multivariate Bollob\u00e1s-Riordan polynomial\nMultivariate versions of (ribbon) graph polynomials consist in attaching a different indeterminate to each edge. The multivariate Bollob\u00e1s-Riordan polynomial is defined as\nfollows [12]: let G be a ribbon graph,\n\u0010 Y\n\u0011\nX\nZ(G; q, \u03b2, c) :=\nq k(F )\n\u03b2e cf (F )\n(33)\nF \u2286G\n\ne\u2208E(F )\n\nwhere \u03b2 = {\u03b2e : e \u2208 E(G)}. Let G be a graph; the multivariate Tutte polynomial is\ndefined as [16]\n\u0010 Y\n\u0011\nX\nk(F )\nZT (G; q, \u03b2) :=\nq\n(34)\n\u03b2e .\nF \u2286G\n\ne\u2208E(F )\n\nLemma 5.5 Let G be a connected ribbon graph. For any total order on E(G), the multivariate Bollob\u00e1s-Riordan polynomial Z is given by\n\u0011\n\u0010 Y\n\u0011\nY\nX \u0010\n\u03b2e cf (FD(Q)\u222aIn (Q) )\nZ(G; q, \u03b2, c) =\n(1 + c\u03b2e ) ZT (GQ ; q, \u03b2/c).\nQ\u2208QG\n\ne\u2208D(Q)\u222aIn (Q)\n\ne\u2208Eo (Q)\n\nProof. Thanks to corollary 4.5, the multivariate Bollob\u00e1s-Riordan polynomial can be\nwritten as follows\n\u0010\n\u0011\nX\nX X\nY\nk(FD(Q)\u222aIn (Q)\u222aS )\nq\nZ(G; q, \u03b2, c) =\n\u03b2e cf (FD(Q)\u222aIn (Q)\u222aS )\nQ\u2208QG S1 \u2282Io (Q) S2 \u2282Eo (Q)\n\ne\u2208D(Q)\u222aIn (Q)\u222aS\n\n(35)\nwhere S = S1 \u222a S2 . Using now lemma 5.3, we have\n\u0011\n\u0011\nX \u0010\nY\nX\u0010 Y\nf (FD(Q)\u222aIn (Q) )\nZ(G; q, \u03b2, c) =\n\u03b2e c\nc\u03b2e\nQ\u2208QG\n\n\u00d7\n\nX\n\nS2\n\ne\u2208D(Q)\u222aIn (Q)\u222aS\n\nq k(FD(Q)\u222aIn (Q)\u222aS1 )\n\nS1\n\n=\n\n\u00d7\n\ne\u2208S2\n\n\u0011\n\u03b2e /c\n\n(36)\n\ne\u2208S1\n\nX \u0010\nQ\u2208QG\n\n\u0010Y\n\n\u0011\n\u0010 Y\n\u0011\n\u03b2e cf (FD(Q)\u222aIn (Q) )\n(1 + c\u03b2e )\n\nY\ne\u2208D(Q)\u222aIn (Q)\u222aS\n\nX\nW \u2286GQ\n\nq k(W )\n\n\u0010 Y\n\ne\u2208Eo (Q)\n\n\u0011\n\u03b2e /c\n\n(37)\n\ne\u2208E(W )\n\nand the lemma follows.\n\n\u0003\n\n17\n\n\fIn [18] a multivariate extension of this signed polynomial has been defined and studied.\nIts invariance under the partial duality has also been proven in [18]. The multivariate\nsigned Bollob\u00e1s-Riordan polynomial is defined as follows:\n\u0010 Y\n\u0011\nX\n\u03b1e cf (F ) .\n(38)\nZs (G; q, \u03b1, c) :=\nq k(F )+s(F )\nF \u2286G\n\ne\u2208E+ (F )\n\u222aE\u2212 (F )\n\nIt is a multivariate generalization of Rs . Indeed if for any e \u2208 E(G), \u03b1e = yz and if we\nlet yz be the corresponding set, we have\nRs (G; x + 1, y, z) =x\u2212k(G) (yz)\u2212v(G) Zs (G; xyz 2 , yz, z \u22121 ).\n\n(39)\n\nThe multivariate polynomial Zs is actually related to the (unsigned) multivariate Bollob\u00e1sRiordan polynomial by\n\u0010 Y\n\u0011\nZs (G; q, \u03b1, c) =\nq \u22121/2 \u03b1e Z(G; q, \u03b2, c)\n(40)\ne\u2208E\u2212 (G)\n\n(\n\u03b1e\nwith \u03b2e =\nq\u03b1e\u22121\n\nif e is positive,\nif e is negative.\n\n(41)\n\nIt is then an easy exercise to get a quasi-tree expansion for the signed multivariate Bollob\u00e1s-Riordan polynomial from lemma 5.5.\n\n6 Duality properties\nIn this section, we first recover the duality property of the Bollob\u00e1s-Riordan polynomial,\nnamely its invariance at q = xyz 2 = 1 [3, 18], but via its quasi-tree expansion. As a\nconsequence, we get another expression for the Bollob\u00e1s-Riordan polynomial at q = 1.\nIn [3, 18], it has been proven that, for any signed ribbon graph G and any subset\nE \u2286 E(G) of edges,\n0\n\n0\n\nZs (G; 1, \u03b1, c) =Zs (GE ; 1, \u03b1, c),\n\n(42a)\n\nwhere Zs (G; xyz 2 , yz, z \u22121 ) :=xk(G) (yz)v(G) Rs (G; x + 1, y, z).\n\n(42b)\n\nTo prove equation (eq. (42a)), S. Chmutov first exhibited a bijection between the sub0\nribbon graphs of G and those of GE . Let us write SG for the set of spanning subribbon\ngraphs of G. The bijection is the following map:\n\u03c6 : SG \u2192SGE0\nF 7\u2192F 0 s.t. E(F 0 ) = E 0 \u2206E(F ),\nwhere \u2206 stands for the symmetric difference. Then, defining\nX\nZs (G; q, \u03b1, c) =:\nMG (F ; q, \u03b1, c),\nF \u2208SG\n\n18\n\n(43)\n\n(44)\n\n\fhe proved that MG (F ; 1, \u03b1, c) = MGE0 (\u03c6(F ); 1, \u03b1, c).\nThe quasi-tree expansion (eq. (11)) (or lemma 5.5) is a way to factorize some of the\nmonomials MG (F ), naturally associated with a single quasi-tree Q of G. Defining\nX\nZs (G; q, \u03b1, c) =:\nNG (Q; q, \u03b1, c),\n(45)\nQ\u2208QG\n\neach monomial NG (Q) is the sum of several MG (F )s. In the following, we prove that the\nbijection (eq. (43)) also preserves the NG (Q)s:\nLemma 6.1 For any signed ribbon graph G and any subset E 0 \u2286 E(G),\nNG (Q; 1, \u03b1, c) = NGE0 (\u03c6(Q); 1, \u03b1, c).\nIn the following,\nif P is a rational function in one variable, and for all A \u2286 E(G), we\nQ\nabbreviate e\u2208A P (\u03b1e ) as P (\u03b1)A .\nProof. First, note that, from lemma 5.5 and equation (eq. (40)),\n\u221a\nNG (Q; q, \u03b1, c) =:(\u03b1/ q)E\u2212 (G) \u03b1E+ (D\u222aIn (Q)) (q/\u03b1)E\u2212 (D\u222aIn (Q)) cf (FD\u222aIn (Q) )\n(1 + \u03b1c)E+ (Eo ) (1 + qc/\u03b1)E\u2212 (Eo ) ZR (GQ ; q, \u03b2/c),\n\n(46)\n\nwhere \u03b2 is given by equation (eq. (41)), so that\nZR (GQ ; q, \u03b2/c) :=\n\nX\n\nq k(F )+e\u2212 (F ) (\u03b1/c)E+ (F ) (\u03b1c)\u2212E\u2212 (F ) .\n\n(47)\n\nF \u2286GQ\n\nFor q = 1, we can explicitly perform the summation over the spanning subgraphs of GQ\nto get\nNG (Q; 1, \u03b1, c) =\u03b1E\u2212 (G)+E+ (D\u222aIn (Q))\u2212E\u2212 (D\u222aIn (Q))\u2212E\u2212 (Io \u222aEo (Q)) cf (FD\u222aIn (Q) )\u2212|Io (Q)|\n(1 + \u03b1c)E+ (Eo (Q))+E\u2212 (Io (Q)) (\u03b1 + c)E\u2212 (Eo (Q))+E+ (Io (Q)) .\n\n(48)\n\nTo prove the lemma, let us first prove that the bijection \u03c6 conserves the number of\nfaces:\n0\n\n0\n\n0\n\n0\n\nf (F 0 ) =v(F 0? ) = v((GE )E(F ) ) = v((GE )E \u2206E(F ) ) = v(GE(F ) ) = f (F ).\n0\n\n(49)\n\nThis implies that, if Q is a quasi-tree of G, then \u03c6(Q) is a quasi-tree of GE . Moreover,\nas defined in section section 3, an edge e \u2208 E(G) is live (resp. orientable) with respect\nto Q if it does not cross any lower-ordered edge (resp. if it is an orientable loop) in\n0\nGE(Q) . Then, an edge e \u2208 E(GE ) is live (resp. orientable) with respect to \u03c6(Q) if it\n0\ndoes not cross any lower-ordered edge (resp. if it is an orientable loop) in (GE )E(\u03c6(Q)) =\n0\n0\n(GE )E \u2206E(Q) = GE(Q) . Thus, the sets of orientable (resp. non-orientable) live (and dead)\n0\nedges with respect to Q in G and with respect to \u03c6(Q) in GE are the same. Nevertheless,\nas E(Q) and E(\u03c6(Q)) = E 0 \u2206E(Q) are different, some internal edges with respect to Q\nmay be external with respect to \u03c6(Q), and vice versa. For example, the (internal) edges of\n0\nGE with respect to F\u03c6(Q) (i.e. \u03c6(Q)) contain both internal edges (the ones in E(Q) \\ E 0 )\n\n19\n\n\fand external edges (the ones in E 0 \\ E(Q)) of G with respect to Q. In other words, having\nE(G) =(D \u222a Io \u222a In )(Q) \u222a (D \u222a Eo \u222a En )(Q),\nE(Q) =(D \u222a Io \u222a In )(Q)\n\n(50a)\n(50b)\n\nwhere D(Q) is the set of externally dead edges, we have\n(D \u222a D)(Q) =(D \u222a D)(\u03c6(Q)),\n(Io \u222a Eo )(Q) =(Io \u222a Eo )(\u03c6(Q)),\n(In \u222a En )(Q) =(In \u222a En )(\u03c6(Q)).\n\n(51a)\n(51b)\n(51c)\n\n\u0003\n\u0003 \u0002\n\u0002\n(D \u222a In )(\u03c6(Q)) = (D \u222a In )(Q) \\ E 0 \u222a (D \u222a En )(Q) \u2229 E 0 .\n\n(52)\n\nAnd more precisely,\n\nAlso remember that if G is a signed ribbon graph, and E 0 \u2286 E(G), for all e \u2208 E 0 , the sign\n0\nof e in GE is opposite to the sign of e in G; see section section 2.2. Thus\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\nE\u00b1 (D \u222a In )(\u03c6(Q)) =E\u00b1 (D \u222a In )(Q) \\ E 0 \u222a E\u2213 (D \u222a En )(Q) \u2229 E 0 .\n\n(53)\n\nSimilarly,\n\u0002\n\u0003 \u0002\n\u0003\nEo (\u03c6(Q)) = Eo (Q) \\ E 0 \u222a Io (Q) \u2229 E 0\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\nE\u00b1 Eo (\u03c6(Q)) =E\u00b1 Eo (Q) \\ E 0 \u222a E\u2213 Io (Q) \u2229 E 0 ,\n\u0002\n\u0003 \u0002\n\u0003\nIo (\u03c6(Q)) = Io (Q) \\ E 0 \u222a Eo (Q) \u2229 E 0\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\nE\u00b1 Io (\u03c6(Q)) =E\u00b1 Io (Q) \\ E 0 \u222a E\u2213 Eo (Q) \u2229 E 0 .\n\n(54)\n(55)\n(56)\n(57)\n\nBefore concluding our proof, we need to relate the number of faces of FD\u222aIn (\u03c6(Q)) \u2208 SGE0\nto the number of faces of FD\u222aIn (Q) \u2208 SG .\n\u0001\n0\n?\nf (FD\u222aIn (\u03c6(Q)) ) =v(FD\u222aI\n) = v (GE )D\u222aIn (\u03c6(Q))\n(58)\nn (\u03c6(Q))\n\u0001\n\u0001\nBut D \u222a In (\u03c6(Q)) = E 0 \u2206E(Q) \\ (Io (Q) \\ E 0 ) \u222a (Eo (Q) \u2229 E 0 ) , using E(Q) = (D \u222a Io \u222a\nIn )(Q), so\n0\n0\n0\n0 \u0001\nf (FD\u222aIn (\u03c6(Q)) ) =v (GE )(E \u2206E(Q))\\((Io (Q)\\E )\u222a(Eo (Q)\u2229E ))\n0\n0 \u0001\n=v (GE(Q) )((Io (Q)\\E )\u222a(Eo (Q)\u2229E )) = 1 + |Io (Q) \\ E 0 | + |Eo (Q) \u2229 E 0 |, (59)\n\nthanks to the fact that the edges in Io (Q) \u222a Eo (Q) do not cross each other in GE(Q) . With\nthe same kind of reasoning, we get\n\u0001\nf (FD\u222aIn (Q) ) =v (GE(Q) )Io (Q) = 1 + |Io (Q)| = 1 + |Io (Q) \\ E 0 | + |Io (Q) \u2229 E 0 |\n\n(60)\n\nand obtain\nf (FD\u222aIn (\u03c6(Q)) ) =f (FD\u222aIn (Q) ) \u2212 |Io (Q) \u2229 E 0 | + |Eo (Q) \u2229 E 0 |.\n\n20\n\n(61)\n\n\fWe are now ready to perform the last computation of this proof. We define Q0 := \u03c6(Q)\nand NGE0 (Q0 ; 1, \u03b1, c) =: \u03b1D\u03b1 cdc (1 + \u03b1c)D1 (\u03b1 + c)D2 with\n\u0001\n0\nD\u03b1 =E\u2212 (GE ) \u222a E+ (D \u222a In (Q0 )) \\ E\u2212 (D \u222a In (Q0 )) \u222a E\u2212 (Io \u222a Eo (Q0 )) ,\n(62a)\n0\ndc =f (FD\u222aIn (Q0 ) ) \u2212 |Io (Q )|,\n(62b)\n0\n0\nD1 =E+ (Eo (Q )) \u222a E\u2212 (Io (Q )),\n(62c)\n0\n0\nD2 =E\u2212 (Eo (Q )) \u222a E+ (Io (Q )).\n(62d)\nNow, using equations (55) and (57),\n\u0003\n\u0003\n\u0002\n\u0001\n\u0002\nD\u03b1 = E\u2212 (G) \u222a E+ (E 0 ) \\ E\u2212 (E 0 ) \u222a E+ (D \u222a In )(Q) \\ E 0 \u222a E\u2212 (D \u222a En )(Q) \u2229 E 0\n\u0003\n\u0002\n\u0003\n\u0002\n\\ E\u2212 (D \u222a In )(Q) \\ E 0 \u222a E+ (D \u222a En )(Q) \u2229 E 0\n\u0002\n\u0003\n\u0002\n\u0003\u0001\n\u222a E\u2212 (Io \u222a Eo )(Q) \\ E 0 \u222a E+ (Io \u222a Eo )(Q) \u2229 E 0 .\n(63)\n\u0002\n\u0003\n0\n0\n0\n0\nAs\n\u0002 0 E = E \u2229 E(G)\n\u0003 =\u0002 E \u2229 (D \u222a In \u222a I0 \u0003o \u222a Eo \u222a D \u222a En )(Q) , we have (D \u222a En )(Q) \u2229 E =\nE \\ (D \u222a In )(Q) \\ (Io \u222a Eo )(Q) \u2229 E , and\n\u0002\n\u0003\n\u0002\n\u0003\nD\u03b1 =E\u2212 (G) \u222a E+ (E 0 ) \u222a E+ (D \u222a In )(Q) \\ E 0 \u222a E\u2212 E 0 \\ (D \u222a In )(Q)\n\u0002\n\u0003\n\u0002\n\u0003\n\\ E+ E 0 \\ (D \u222a In )(Q) \u222a E\u2212 (E 0 ) \u222a E\u2212 (Io \u222a Eo )(Q) \u2229 E 0\n\u0002\n\u0003\n\u0002\n\u0003\u0001\n\u222a E\u2212 (D \u222a In )(Q) \\ E 0 \u222a E\u2212 (Io \u222a Eo )(Q) \\ E 0\n\u0001\n=E\u2212 (G) \u222a E+ (D \u222a In (Q)) \\ E\u2212 (D \u222a In (Q)) \u222a E\u2212 (Io \u222a Eo (Q)) .\n\n(64)\n(65)\n\nUsing eqs. (55) to (57) and (61),\ndc =f (FD\u222aIn (Q) ) \u2212 |Io (Q) \u2229 E 0 | + |Eo (Q) \u2229 E 0 | \u2212 |Io (Q) \\ E 0 | \u2212 |Eo (Q) \u2229 E 0 |\n=f (FD\u222aIn (Q) ) \u2212 |Io (Q)|,\n\n(66)\n(67)\n\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\nD1 =E+ Eo (Q) \\ E 0 \u222a E\u2212 Io (Q) \u2229 E 0 \u222a E\u2212 Io (Q) \\ E 0 \u222a E+ Eo (Q) \u2229 E 0\n=E+ (Eo (Q)) \u222a E\u2212 (Io (Q)),\n\n(68)\n(69)\n\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\nD2 =E\u2212 Eo (Q) \\ E 0 \u222a E+ Io (Q) \u2229 E 0 \u222a E+ Io (Q) \\ E 0 \u222a E\u2212 Eo (Q) \u2229 E 0\n=E\u2212 (Eo (Q)) \u222a E+ (Io (Q)).\n\n(70)\n(71)\n\nThis proves that NG (Q; 1, \u03b1, c) = NGE0 (\u03c6(Q); 1, \u03b1, c), meaning that the bijection (eq. (43))\nconserves independently each of the terms (i.e. the N (Q)0 s) of the quasi-tree expansion.\n0\nThis implies, of course, Z(G; 1, \u03b1, c) = Z(GE ; 1, \u03b1, c).\n\u0003\nThe preceding lemma shows that, given a ribbon graph G, a subset of edges E 0 and\na quasi-tree Q \u2208 QG , there exists a quasi-tree Q0 \u2208 QGE0 such that NG (Q; 1, \u03b1, c) =\nNGE0 (Q0 ; 1, \u03b1, c). The subribbon graph Q0 is such that E(Q0 ) = \u03c6(Q). But we can also\ninvert the logic: given a ribbon graph G, a quasi-tree Q \u2208 QG and a subset of edges\nA \u2286 E(G), there exists a subset E 0 such that the spanning subribbon graph Q0 with the\n0\nproperty that E(Q0 ) = A is a quasi-tree in GE and NG (Q; 1, \u03b1, c) = NGE0 (Q0 ; 1, \u03b1, c).\n\n21\n\n\f0\n\nWhatever subset A we choose, the bijection ensures that Q0 is a quasi-tree in GE . This\nmeans that we can fix A and deduce the set E 0 . A very simple case is A = \u2205: given\nQ \u2208 QG , in which partial dual of G is the empty set a quasi-tree? The answer is given by\nthe bijection \u03c6:\nE 0 \u2206E(Q) = \u2205 \u21d0\u21d2 E 0 = E(Q).\n\n(72)\n\nAnd we get: for any quasi-tree Q \u2208 QG , NG (Q; 1, \u03b1, c) = NGE(Q) (F\u2205 ; 1, \u03b1, c). In that\ncase, Q0 having\nno edge, the live (or dead) edges are necessarily external. Let us define\n\b\nLo (Q) := orientable live edges of GE(Q) with respect to F\u2205 .\nLemma 6.2 For any ribbon graph G, the quasi-tree expansion for Zs at q = 1 can be\nrewritten as follows:\nX\nE(Q)\nZs (G; 1, \u03b1, c) =c\n\u03b1e\u2212 (G ) (1 + \u03b1c)e+ (Lo (Q)) (1 + c/\u03b1)e\u2212 (Lo (Q)) .\n(73)\nQ\u2208QG\n\n7 The Kauffman bracket of a virtual link diagram\nIn [3], S. Chmutov unified several Thistlethwaite like theorems [4, 5, 7, 11, 15] (that is\ntheorems relating link and (ribbon) graph polynomials). He proved that the Kauffman\nbracket of a virtual link diagram L equals (an evaluation of) the signed Bollob\u00e1s-Riordan\npolynomial of a certain ribbon graph GsL ; see eq. (74). The latter is constructed from a\nstate s of L; see below and/or [3]. The equality is true for any state s.\n[L](A, B, d) = An(GL ) B r(GL ) dk(GL )\u22121 Rs (GsL ;\n\nAd\nBd 1\n+ 1,\n, ).\nB\nA d\n\n(74)\n\nThe new partial duality of S. Chmutov ensures the independence of the right hand side\nof (74) with respect to the state s.\nIn the previous sections, we obtained a quasi-tree expansion for the Bollob\u00e1s-Riordan\npolynomial. Thanks to equation (74), we can obviously get such an expansion for the\nKauffman bracket. Nevertheless, this expansion would be expressed in terms of parameters (number of vertices, edges etc) of the (subribbon graphs of the) ribbon graph GsL\nassociated with the state s of L. Here we would like to get a new expansion for the\nKauffman bracket, directly expressed in terms of the parameters of the states of L.\nCombining equations (eq. (74)) and (eq. (42b)), we get\ns\n\n[L](A, B, d) =Ae(GL ) d\u22121 Z(GsL ; 1, B/A, d).\n\n(75)\n\nNow, using the expansion (eq. (73)),\nX\n\u0001\ns\ns E(Q)\nB/A e\u2212 ((GL ) )\n[L](A, B, d) = Ae(GL )\nQ\u2208QGs\n\n(76)\n\nL\n\n1 + Bd/A\n\n22\n\n\u0001e+ (Lo (Q))\n\n1 + Ad/B\n\n\u0001e\u2212 (Lo (Q))\n\n.\n\n\fLet us now translate this expression into pure \"knot theoretical\" terms. For this, we need\nto recall how the ribbon graph GsL is built, out of the state s of the virtual link diagram\nL. The state s consists in a set of (possibly nested) circles, called state circles, which\nwrithe at the virtual crossings; see fig. 9(b) for an example. For each state of L, each\nclassical crossing is resolved i.e. at each classical crossing, one performs either an A- or\na B-splitting; see fig. 8. Now each resolved crossing consists of two parallel strands. In\nthe vicinity of each former classical crossing, place one arrow on each of these strands,\npointing in opposite directions, figure fig. 9(c). Label these two arrows with a common\nname and a sign: + if the former crossing has been resolved by an A-splitting and \u2212\notherwise. Then pull the state circles apart, untwisting them if needed. The result is the\ncombinatorial representation of the ribbon graph GsL , fig. 9(d).\n\n(a) An A-splitting\n\n(b) A B-splitting\n\nFigure 8: A- and B-splittings\n\n(a) A virtual version of\nthe Whitehead link\n\n(b) A state s of the link\nof fig. 9(a)\n\n2+\n\n1+\n\n3+\n\n(c) Placing the edgearrows\n3+\n3+\n\n3\n1+\n\n2+\n\n1+\n\n1\n2\n\n2+\n\n(e) The ribbon graph GsL\n\n(d) Combinatorial representation of GsL\n\nFigure 9: Construction of a GsL\n\n23\n\n\fThe Kauffman bracket and the Bollob\u00e1s-Riordan polynomial being related by equation\n(eq. (74)), there is a one-to-one correspondence between the states of a virtual link diagram\nL and the spanning subribbon graphs of GsL . First of all, given the construction of GsL ,\nthere is a bijection \u03ba between the crossings of L and the edges of GsL . Then, writing Cs0 6=s\nfor the set of crossings which are resolved differently in s and s0 , the bijection between\nthe states of L and the subribbon graphs of GsL is\n\u03c3 : s0 7\u2192 \u03c3(s0 ) = F \u2208 SGsL s.t. E(F ) = \u03ba(Cs0 6=s ).\n\n(77)\n\nAnother crucial point, noticed by S. Chmutov [3], is the fact that, given two states s and\n0\ns0 , the ribbon graphs GsL and GsL are dual to each other with respect to \u03ba(Cs6=s0 ):\n0\n\nGsL =(GsL )\u03ba(Cs6=s0 ) .\n\n(78)\n\nThis allows us to understand to which state a quasi-tree corresponds. Let us consider a\nstate s0 with only one state circle, hereafter called a connected state. The ribbon graph\n0\nGsL has only one vertex. But, by equation (eq. (78)), the partial dual of GsL with respect\nto \u03ba(Cs6=s0 ) has only one vertex, meaning that the subribbon graph of GsL , the edge-set of\nwhich is \u03ba(Cs6=s0 ), is a quasi-tree. In contrast, a quasi-tree Q defines a unique connected\nstate s0 by the equation E(Q) = \u03ba(Cs6=s0 ). Then the set of quasi-trees of GsL corresponds\nto the set of connected states of L.\nTo complete our translation of the expansion (eq. (76)), we now explain to which\ncrossings the orientable live edges correspond. Given a quasi-tree Q of GsL , Lo (Q) is the\nset of orientable live edges of (GsL )E(Q) with respect to F\u2205 . But there exists a unique\n0\nconnected state s0 = \u03c3 \u22121 (Q) such that (GsL )E(Q) = GsL . The state circle of s0 is the\n0\nboundary of the vertex of GsL . Then, to determine whether a crossing is live with respect\nto s0 , we mark the resolved crossings in s0 , as in the example of fig. 9(c). What we get is\na (possibly twisting) circle with 2n marks (n = number of crossings of L), labelled with n\ndifferent names. To decide whether a crossing c is live or not, turn around the state circle\nof s0 , starting at one of the two marks corresponding to c. Before reaching the second\nmark of c, we meet other labels. A label met twice, called paired, corresponds to an edge\n0\nin GsL which does not cross \u03ba(c) in GsL . In contrast, a label met only once, called single,\ncorresponds to an edge crossing \u03ba(c). Then c is live if, from one mark of c to the other,\nwe meet no single lower-ordered label. Otherwise, it is dead.\nFinally, a crossing c is orientable with respect to a connected state s0 if, from one\nmark of c to the other, we pass through virtual crossings an even number of times. For\nexample, with respect to the connected state of fig. 10, crossings 1 and 3 are orientable,\nwhereas crossing 2 is non-orientable.\n\n2+\n1\u2212\n3+\n\nFigure 10: A connected state\n\n24\n\n\fTo sum up, we have:\n\u2022 each quasi-tree Q \u2208 SGsL corresponds to a connected state s0 = \u03c3 \u22121 (Q),\n\u2022 e(GsL ) = n(L) is the number of crossings of L,\n\u2022 e+ ((GsL )E(Q) ) = aL (s0 ) is the number of A-splittings of s0 ,\n\u2022 e\u2212 ((GsL )E(Q) ) = bL (s0 ) is the number of B-splittings of s0 ,\n\u2022 e+ (Lo (Q)) =: |Lao (s0 )| is the number of live orientable crossings resolved by Asplittings in s0 ,\n\u2022 e\u2212 (Lo (Q)) =: |Lbo (s0 )| is the number of live orientable crossings resolved by Bsplittings in s0 .\nSo we get:\nLemma 7.1 (Connected state expansion) Let L be a virtual link diagram. For any\norder for the crossings of L, the Kauffman bracket can be rewritten as\nX\n\u0001|La (s0 )|\n\u0001|Lb (s0 )|\n0\n0\nAaL (s ) B bL (s ) 1 + Bd/A o\n[L](A, B, d) =\n1 + Ad/B o .\n(79)\nconnected\nstates s0 of L\n\nAcknowledgements I thank A. Champanerkar, I. Kofman and N. Stoltzfus for having\nexplained to me some details of their inspiring work [2]. I also acknowledge the anonymous\nreferee's work that led to this improved version.\n\n25\n\n\fA Examples\nA.1 The Bollob\u00e1s-Riordan polynomial\nWe give here an example of our quasi-tree expansion of the signed Bollob\u00e1s-Riordan\npolynomial of not necessarily orientable ribbon graphs. We choose the non-orientable\nsigned ribbon graph G of fig. 11. According to equation (eq. (7)), the signed Bollob\u00e1se1 +\n\ne4 \u2212\n\ne3 +\n\ne2 \u2212\n\nFigure 11: A non-orientable signed ribbon graph\nRiordan polynomial of G is\nRs (G; x + 1, y, z) = 1 + 3y + y 2 + xz + yz + 2xyz + y 2 z\n+ xy 2 z + xyz 2 + y 2 z 2 + xy 2 z 3 + x\u22121 y + x\u22121 y 2 .\n\n(80)\n\nWe now check that the quasi-tree expansion (eq. (11)) gives the same polynomial. To this\naim, according to theorem 5.1, we define\nX\nN (G, Q)S(GQ ),\n(81a)\nP (G; x, y, z) :=\nQ\u2208QG\n\nN (G, Q) :=(x\u22121/2 y 1/2 ) e\u2212 (G) xe\u2212 (D(Q)\u222aIn (Q)) y n(FD(Q)\u222aIn (Q) )\u2212e\u2212 (D(Q)\u222aIn (Q))\nz (k\u2212f +n)(FD(Q)\u222aIn (Q) ) (1 + x)e\u2212 (Eo (Q)) (1 + y)e+ (Eo (Q)) ,\nS(GQ ) :=(x\n\n1/2 \u22121/2 r(GQ )+e\u2212 (Io (Q))\n\ny\n\n)\n\n\u22121/2 1/2\n\nRa(GQ ; 1, x\n\ny\n\n1/2 1/2\n\n,x\n\ny\n\n(81b)\n1/2 1/2 2\n\n,x\n\ny\n\nz ). (81c)\n\nWe want to check that P (G; x, y, z) = Rs (G; x+1, y, z). Table table 1 lists the information\nnecessary for computing the polynomial P . We get\nP (G; x, y, z) = (1 + x\u22121 )y(1 + y) + 1 + y + (1 + x)y(1 + y)z\n+ x(1 + y)z + y(1 + yz 2 ) + xyz 2 + xy 2 z 3 .\n\n(82)\n\nWe easily see that the right hand sides of equations (eq. (80)) and (eq. (82)) are equal.\n\n26\n\n\f27\n\n{e2 , e4 }\n\n{e2 , e3 }\n\n{e4 }\n\n{e3 }\n\nE(Q)\n\n+\n\ne3\n\n\u2212\n\ne4\n\n+\n\ne3\n\n\u2212\n\ne4\n\ne4 \u2212\n\ne2 \u2212\n\ne1 +\n\ne3 +\n\ne1 +\n\ne2 \u2212\n\ne4 \u2212\n\ne1 +\n\ne2 \u2212\n\ne3 +\n\ne1 +\n\ne2 \u2212\n\nGE(Q)\n\n\u2205, {e2 }, {e4 }, {e1 }\n\n{e3 }, {e2 }, \u2205, {e1 }\n\n\u2205, \u2205, {e4 }, {e1 }\n\n{e3 }, \u2205, \u2205, {e1 }\n\nIo (Q), In (Q), D(Q), Eo (Q)\n\nxz(1 + y)\n\nx1/2 y 1/2 z(1 + y)\n\n(1 + y)\n\nx\u22121/2 y 1/2 (1 + y)\n\nN (G, Q)\n\nTable 1: Quasi-tree expansion of Rs (G)\n\ne3\n\ne3\n\nGQ\n\nContinued on next page\n\n1\n\nx1/2 y 1/2 + x\u22121/2 y 1/2\n\n1\n\nx1/2 y 1/2 + x\u22121/2 y 1/2\n\nS(GQ )\n\n\f28\n\n{e1 , e2 , e3 , e4 }\n\n{e2 , e3 , e4 }\n\n{e1 , e3 , e4 }\n\nE(Q)\n\n+\n\ne1\n\n+\n\ne1\n\ne4\n\n\u2212\n\ne1 +\n\ne2 \u2212\n\ne2 \u2212\n\ne4 \u2212\n\ne3 +\n\ne2 \u2212\n\ne3 +\n\ne4 \u2212\n\nGE(Q)\n\ne3 +\n\n\u2205, {e1 }, {e2 , e3 , e4 }, \u2205\n\n\u2205, \u2205, {e2 , e3 , e4 }, \u2205\n\n{e1 }, \u2205, {e3 , e4 }, \u2205\n\nIo (Q), In (Q), D(Q), Eo (Q)\n\nxy 2 z 3\n\nxyz 2\n\ny\n\nN (G, Q)\n\nTable 1: Quasi-tree expansion of Rs (G)\n\ne1\n\nGQ\n\n1\n\n1\n\n1 + yz 2\n\nS(GQ )\n\n\fA.2 The Kauffman bracket\nWe exemplify here the connected state expansion of the virtual version of the Whitehead\nlink of fig. 9(a). We label the crossings 1, 2 and 3 as in figures fig. 9(c) and fig. 10. We\nchoose the following order: 1 \u227a 2 \u227a 3. On one hand,\nX\n[L](A, B, d) =\nAaL (s) B bL (s) dcL (s)\u22121\n(83)\nstates s of L\n3\n2\n\nOn the other hand,\nX\n\n0\n\n=A d + 3A B + 2AB 2 + AB 2 d + B 3 .\n\n(84)\n\n\u0001|Lao (s0 )|\n\n(85)\n\n0\n\nAaL (s ) B bL (s ) 1 + Bd/A\n\n1 + Ad/B\n\n\u0001|Lbo (s0 )|\n\nconnected\nstates s0 of L\n2\n\n=A B(1 + Bd/A) + A2 B + AB 2 + A2 B(1 + Ad/B) + AB 2 + B 3 ,\nwhich is easily checked to be equal to (eq. (84)).\nTable 2: States of L\nState s\n\n+\n\n+\n\n(2, 1, 1)\n\n{1} , \u2205\n\n(2, 1, 1)\n\n\u2205, \u2205\n\n(1, 2, 1)\n\n\u2205, \u2205\n\n(2, 1, 1)\n\n\u2205, {1}\n\n\u2212\n\n+\n\n\u2212\n\n+\n\n+\n\n\u2212\n\n\u2212\n\n+\n\n+\n\n\u2212\n\n+\n\n(1, 2, 2)\n\n+\n\n\u2212\n\n\u2212\n\n\u2212\n\n\u2212\n\n(1, 2, 1)\n\n\u2205, \u2205\n\n(0, 3, 1)\n\n\u2205, \u2205\n\n+\n\n\u2212\n\n\u2212\n\nLao (s), Lbo (s)\n(if cL (s) = 1)\n\n(3, 0, 2)\n\n+\n\n+\n\n(aL (s), bL (s), cL (s))\n\n\u2212\n\n29\n\n(86)\n\n\fReferences\n[1] B. Bollob\u00e1s and O. Riordan. \"A polynomial of graphs on surfaces\". Math. Ann., 323:\n81\u201396, January 2002.\n[2] A. Champanerkar, I. Kofman, and N. Stoltzfus. \"Quasi-tree expansion for the Bollob\u00e1sRiordan-Tutte polynomial\". May 2007. arXiv:0705.3458.\n[3] S. Chmutov. \"Generalized duality for graphs on surfaces and the signed Bollob\u00e1s-Riordan\npolynomial\". J. Combinatorial Theory, Ser. B, 99 (3):617\u2013638, 2009. arXiv:0711.3490,\ndoi:10.1016/j.jctb.2008.09.007.\n[4] S. Chmutov and I. Pak. \"The Kauffman bracket of virtual links and the Bollob\u00e1s-Riordan\npolynomial\". Moscow Math. J., 7 (3):409\u2013418, 2007.\n[5] S. Chmutov and J. Voltz. \"Thistlethwaite's theorem for virtual links\". J. Knot Th. Ram.,\n17 (10):1189\u20131198, 2008. arXiv:0704.1310.\n[6] O. T. Dasbach, D. Futer, E. Kalfagianni, X.-S. Lin, and N. W. Stoltzfus. \"Alternating\nsum formulae for the determinant and other link invariants\". November 2006. arXiv:\nmath/0611025.\n[7] O. T. Dasbach, D. Futer, E. Kalfagianni, X.-S. Lin, and N. W. Stoltzfus. \"The Jones\npolynomial and graphs on surfaces\". J. Combinatorial Theory, Ser. B, 98:384\u2013399, 2008.\narXiv:math.GT/0605571.\n[8] E. Dewey. \"A quasitree expansion of the Bollob\u00e1s-Riordan polynomial\". Unpublished work,\navailable at http://www.math.wisc.edu/ dewey/.\n[9] C. Godsil and G. Royle. Algebraic Graph Theory. Graduate Texts in Mathematics. Springer,\n2001.\n[10] S. Huggett and I. Moffatt. \"Expansions for the Bollob\u00e1s-Riordan polynomial of separable\nribbon graphs\". Annals of Combinatorics, 2011. In press. arXiv:0710.4266.\n[11] L. H. Kauffman. \"A Tutte polynomial for signed graphs\". Discrete Appl. Math., 25:\n105\u2013127, 1989.\n[12] I. Moffatt. \"Knot invariants and the Bollob\u00e1s-Riordan polynomial of embedded graphs\".\nEuropean Journal of Combinatorics, 29:95\u2013107, 2008.\n[13] I. Moffatt. \"Partial Duality and Bollob\u00e1s and Riordan's Ribbon Graph Polynomial\". Discrete Mathematics, 310:174\u2013183, 2010. arXiv:0809.3014.\n[14] I. Moffatt. \"A characterization of partially dual graphs\". Journal of Graph Theory, 2011.\nPublished online. arXiv:0901.1868, doi:10.1002/jgt.20525.\n[15] M. Thistlethwaite. \"A spanning tree expansion for the jones polynomial\". Topology, 26:\n297\u2013309, 1987.\n[16] L. Traldi. \"A dichromatic polynomial for weighted graphs and link polynomials\".\nProc. AMS, 106:279\u2013286, 1989.\n\n30\n\n\f[17] W. T. Tutte. \"A contribution to the theory of chromatic polynomials\". Canad. J. Math.,\n6:80\u201391, 1954.\n[18] F. Vignes-Tourneret. \"The multivariate signed Bollob\u00e1s-Riordan polynomial\". Discrete\nMathematics, 309:5968\u20135981, 2009. arXiv:0811.1584, doi:10.1016/j.disc.2009.04.\n026.\n\n31\n\n\f"}