{"id": "http://arxiv.org/abs/0909.0891v2", "guidislink": true, "updated": "2009-11-12T07:24:19Z", "updated_parsed": [2009, 11, 12, 7, 24, 19, 3, 316, 0], "published": "2009-09-04T13:38:11Z", "published_parsed": [2009, 9, 4, 13, 38, 11, 4, 247, 0], "title": "Schematic Harder-Narasimhan Stratification", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.3555%2C0909.5281%2C0909.4619%2C0909.4914%2C0909.4424%2C0909.2215%2C0909.4322%2C0909.0219%2C0909.5043%2C0909.0134%2C0909.0373%2C0909.4207%2C0909.1179%2C0909.5362%2C0909.1336%2C0909.4966%2C0909.0790%2C0909.0483%2C0909.1467%2C0909.5136%2C0909.4103%2C0909.2088%2C0909.2017%2C0909.0791%2C0909.4697%2C0909.2871%2C0909.0093%2C0909.5381%2C0909.1103%2C0909.3841%2C0909.2485%2C0909.4944%2C0909.2577%2C0909.1178%2C0909.2688%2C0909.0223%2C0909.1990%2C0909.1394%2C0909.5174%2C0909.5007%2C0909.3510%2C0909.5390%2C0909.4840%2C0909.0050%2C0909.4927%2C0909.3272%2C0909.3757%2C0909.5336%2C0909.3248%2C0909.3470%2C0909.2047%2C0909.0924%2C0909.1450%2C0909.0119%2C0909.2006%2C0909.2484%2C0909.4828%2C0909.3968%2C0909.5433%2C0909.1095%2C0909.0171%2C0909.3504%2C0909.0901%2C0909.4810%2C0909.2569%2C0909.4320%2C0909.5512%2C0909.5423%2C0909.1473%2C0909.0423%2C0909.0335%2C0909.2341%2C0909.4362%2C0909.4653%2C0909.3101%2C0909.5636%2C0909.4667%2C0909.0699%2C0909.0392%2C0909.2967%2C0909.1761%2C0909.0350%2C0909.3348%2C0909.1588%2C0909.2933%2C0909.0891%2C0909.4021%2C0909.4461%2C0909.1027%2C0909.4091%2C0909.2163%2C0909.0104%2C0909.3279%2C0909.5204%2C0909.3261%2C0909.5003%2C0909.2245%2C0909.5495%2C0909.0870%2C0909.3542%2C0909.1105&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Schematic Harder-Narasimhan Stratification"}, "summary": "For any flat family of pure-dimensional coherent sheaves on a family of\nprojective schemes, the Harder-Narasimhan type (in the sense of Gieseker\nsemistability) of its restriction to each fiber is known to vary\nsemicontinuously on the parameter scheme of the family. This defines a\nstratification of the parameter scheme by locally closed subsets, known as the\nHarder-Narasimhan stratification.\n  In this note, we show how to endow each Harder-Narasimhan stratum with the\nstructure of a locally closed subscheme of the parameter scheme, which enjoys\nthe universal property that under any base change the pullback family admits a\nrelative Harder-Narasimhan filtration with a given Harder-Narasimhan type if\nand only if the base change factors through the schematic stratum corresponding\nto that Harder-Narasimhan type.\n  The above schematic stratification induces a stacky stratification on the\nalgebraic stack of pure-dimensional coherent sheaves. We deduce that coherent\nsheaves of a fixed Harder-Narasimhan type form an algebraic stack in the sense\nof Artin.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.3555%2C0909.5281%2C0909.4619%2C0909.4914%2C0909.4424%2C0909.2215%2C0909.4322%2C0909.0219%2C0909.5043%2C0909.0134%2C0909.0373%2C0909.4207%2C0909.1179%2C0909.5362%2C0909.1336%2C0909.4966%2C0909.0790%2C0909.0483%2C0909.1467%2C0909.5136%2C0909.4103%2C0909.2088%2C0909.2017%2C0909.0791%2C0909.4697%2C0909.2871%2C0909.0093%2C0909.5381%2C0909.1103%2C0909.3841%2C0909.2485%2C0909.4944%2C0909.2577%2C0909.1178%2C0909.2688%2C0909.0223%2C0909.1990%2C0909.1394%2C0909.5174%2C0909.5007%2C0909.3510%2C0909.5390%2C0909.4840%2C0909.0050%2C0909.4927%2C0909.3272%2C0909.3757%2C0909.5336%2C0909.3248%2C0909.3470%2C0909.2047%2C0909.0924%2C0909.1450%2C0909.0119%2C0909.2006%2C0909.2484%2C0909.4828%2C0909.3968%2C0909.5433%2C0909.1095%2C0909.0171%2C0909.3504%2C0909.0901%2C0909.4810%2C0909.2569%2C0909.4320%2C0909.5512%2C0909.5423%2C0909.1473%2C0909.0423%2C0909.0335%2C0909.2341%2C0909.4362%2C0909.4653%2C0909.3101%2C0909.5636%2C0909.4667%2C0909.0699%2C0909.0392%2C0909.2967%2C0909.1761%2C0909.0350%2C0909.3348%2C0909.1588%2C0909.2933%2C0909.0891%2C0909.4021%2C0909.4461%2C0909.1027%2C0909.4091%2C0909.2163%2C0909.0104%2C0909.3279%2C0909.5204%2C0909.3261%2C0909.5003%2C0909.2245%2C0909.5495%2C0909.0870%2C0909.3542%2C0909.1105&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "For any flat family of pure-dimensional coherent sheaves on a family of\nprojective schemes, the Harder-Narasimhan type (in the sense of Gieseker\nsemistability) of its restriction to each fiber is known to vary\nsemicontinuously on the parameter scheme of the family. This defines a\nstratification of the parameter scheme by locally closed subsets, known as the\nHarder-Narasimhan stratification.\n  In this note, we show how to endow each Harder-Narasimhan stratum with the\nstructure of a locally closed subscheme of the parameter scheme, which enjoys\nthe universal property that under any base change the pullback family admits a\nrelative Harder-Narasimhan filtration with a given Harder-Narasimhan type if\nand only if the base change factors through the schematic stratum corresponding\nto that Harder-Narasimhan type.\n  The above schematic stratification induces a stacky stratification on the\nalgebraic stack of pure-dimensional coherent sheaves. We deduce that coherent\nsheaves of a fixed Harder-Narasimhan type form an algebraic stack in the sense\nof Artin."}, "authors": ["Nitin Nitsure"], "author_detail": {"name": "Nitin Nitsure"}, "author": "Nitin Nitsure", "arxiv_comment": "Reason for re-submission: Minor error in the expository part is\n  corrected. Theorems and proofs are unchanged. 10 pages", "links": [{"href": "http://arxiv.org/abs/0909.0891v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0909.0891v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "14D20; 14D23; 14F05", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0909.0891v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0909.0891v2", "journal_reference": null, "doi": null, "fulltext": "Schematic Harder-Narasimhan Stratification\nNitin Nitsure\n\narXiv:0909.0891v2 [math.AG] 12 Nov 2009\n\nAbstract\nFor any flat family of pure-dimensional coherent sheaves on a family of\nprojective schemes, the Harder-Narasimhan type (in the sense of Gieseker\nsemistability) of its restriction to each fiber is known to vary semicontinuously\non the parameter scheme of the family. This defines a stratification of the\nparameter scheme by locally closed subsets, known as the Harder-Narasimhan\nstratification.\nIn this note, we show how to endow each Harder-Narasimhan stratum\nwith the structure of a locally closed subscheme of the parameter scheme,\nwhich enjoys the universal property that under any base change the pullback\nfamily admits a relative Harder-Narasimhan filtration with a given HarderNarasimhan type if and only if the base change factors through the schematic\nstratum corresponding to that Harder-Narasimhan type.\nThe above schematic stratification induces a stacky stratification on the\nalgebraic stack of pure-dimensional coherent sheaves. We deduce that coherent sheaves of a fixed Harder-Narasimhan type form an algebraic stack in the\nsense of Artin.\n\n2010 Math. Subj. Class. : 14D20, 14D23, 14F05.\n\n1. Introduction\nLet X be a projective scheme over a locally noetherian base scheme S, with a\nchosen relatively ample line bundle OX (1). Let E be a coherent sheaf on X which\nis flat over S, such that the restriction Es = E|Xs of E to the schematic fiber Xs\nof X over each s \u2208 S is a pure-dimensional sheaf of a fixed dimension d \u2265 0. For\nany s \u2208 S, let HN(Es ) denote the Harder-Narasimhan type of Es in the sense of\nGieseker semistability. With respect to a certain natural partial order on the set\nHNT of all possible Harder-Narasimhan types \u03c4 , the Harder-Narasimhan function\ns 7\u2192 HN(Es ) is known to be upper semicontinuous on S.\nIn this note, we prove that each level set S \u03c4 (E) of the Harder-Narasimhan function has a natural structure of a locally closed subscheme of S, with the following\nuniversal property: a morphism T \u2192 S factors via S \u03c4 (E) if and only if the pullback\nEt on Xt for each t \u2208 T is of type \u03c4 and the pullback family ET on X \u00d7S T admits a\nrelative Harder-Narasimhan filtration, that is, a filtration 0 \u2282 F1 \u2282 . . . \u2282 Fl = ET\nby coherent subsheaves such that the graded pieces Fi /Fi\u22121 are flat over T , which\nfor each t \u2208 T restricts to the Harder-Narasimhan filtration of Et on Xt .\n1\n\n\fAs a corollary, we deduce that sheaves of a fixed Harder-Narasimhan type form\nan algebraic stack in the sense of Artin.\nIn Section 2 we recall the basic definitions and results of Harder-NarasimhanShatz that we need. In Section 3 we prove our main result (Theorem 5), which gives\nnatural schematic structures on the Harder-Narasimhan strata. In Section 4, we\nshow (Theorem 8) that sheaves of a given Harder-Narasimhan type form an Artin\nalgebraic stack.\nThis work had its origin in questions arising from the proposal of Leticia BrambilaPaz to construct a moduli scheme for indecomposable unstable rank 2 vector bundles\non a curve, fixing their Harder-Narasimhan type and the dimension of their vector\nspace global endomorphisms. A construction of such a moduli scheme is given in\n[B-M-Ni], which uses special cases of the results proved here.\n\n2. The Harder-Narasimhan filtration and stratification\nLet Q[\u03bb] be the polynomial ring in the variable \u03bb. An element f \u2208 Q[\u03bb] is called\na numerical polynomial if f (Z) \u2282 Z. If a nonzero numerical polynomial f has\ndegree d, it can be uniquely expanded as f = (r(f )/d!)\u03bbd + lower degree terms,\nwhere r(f ) \u2208 Z. If f = 0 we put r(f ) = 0. There is a total order \u2264 on Q[\u03bb] under\nwhich f \u2264 g if f (m) \u2264 g(m) for all sufficiently large integers m. Let the set of all\nHarder-Narasimhan types, denoted by HNT, be the set consisting of all finite\nsequences (f1 , . . . , fp ) of numerical polynomials in Q[\u03bb], where p is allowed to vary\nover all integers \u2265 1, such that the following three conditions are satisfied.\n(1) We have 0 < f1 < . . . < fp in Q[\u03bb],\n(2) the polynomials fi are all of the same degree, say d, and\n(3) the following inequalities are satisfied\nf2 \u2212 f1\nfp \u2212 fp\u22121\nf1\n>\n> ... >\n.\nr(f1 )\nr(f2 ) \u2212 r(f1 )\nr(fp ) \u2212 r(fp\u22121 )\nGiven any x = (a, f ) and y = (b, g) in Z\u00d7Q[\u03bb], the segment joining x and y is\nthe subset xy \u2282 Z\u00d7Q[\u03bb], consisting of all (c, h) such that (c, h) = t(a, f )+(1\u2212t)(b, g)\nfor some t \u2208 Q with 0 \u2264 t \u2264 1. For any (f1 , . . . , fp ) in HNT, we define the\ncorresponding Harder-Narasimhan polygon to be the subset\nHNP(f1 , . . . , fp ) \u2282 Z \u00d7 Q[\u03bb]\nwhich is the union of the segments x0 x1 \u222a x1 x2 \u222a . . . \u222a xp\u22121 xp where x0 = (0, 0) and\nxi = (r(fi ), fi ) for 1 \u2264 i \u2264 p.\nA point (a, f ) \u2208 Z \u00d7 Q[\u03bb] is said to lie under another point (b, g) \u2208 Z \u00d7 Q[\u03bb] if\na = b in Z and f \u2264 g in Q[\u03bb]. A point (a, f ) \u2208 Z \u00d7 Q[\u03bb] is said to lie under the\n2\n\n\fpolygon HNP(g1 , . . . , gq ) if there exists some (b, g) \u2208 HNP(g1 , . . . , gq ) such that the\npoint (a, f ) lies under the point (b, g). There is a partial order \u2264 on HNT, under\nwhich (f1 , . . . , fp ) \u2264 (g1 , . . . , gq ) if for each 1 \u2264 i \u2264 p, the point (r(fi ), fi ) lies under\nHNP(g1 , . . . , gq ).\nWith the above numerical preliminaries, we now briefly recall the theory of\nHarder-Narasimhan-Shatz for filtrations and stratifications. For an exposition the\nreader can see, for example, the book of Huybrechts and Lehn [Hu-Le].\nLet Y be a projective scheme over a field k, together with an ample line bundle\nOY (1). For any coherent sheaf E on Y , we denote by P (E) \u2208 Q[\u03bb] the resulting\nP\nHilbert polynomial of E, defined by P (E)(m) = i (\u22121)i dimk H i (Y, E(m)). This is\na numerical polynomial, and the integer r(P (E)) is denoted simply by r(E) (this is\ncalled the rank of E). For a nonzero E, the degree d of P (E) equals the dimension\nof the support of E. A coherent sheaf E on Y is said to be pure-dimensional\nof dimension d if for every open subscheme U \u2282 Y and nonzero coherent subsheaf\nF \u2282 E|U , the support of F is of the same dimension d. A pure-dimensional coherent\nsheaf E is called semistable (in the sense of Gieseker) w.r.t. OY (1) if for all coherent\nsubsheaves F \u2282 E, we have r(E)P (F ) \u2264 r(F )P (E).\nWhen E is of pure dimension d \u2265 0 but not necessarily semistable, it admits a\nunique strictly increasing filtration 0 = HN0 (E) \u2282 HN1 (E) \u2282 . . . \u2282 HNl (E) = E\nby coherent subsheaves HNi (E) such that for each 1 \u2264 i \u2264 l, the graded piece\nGri (E) = HNi (E)/ HNi\u22121 (E) is semistable of pure dimension d, and the inequalities\nP (Grl (E))\nP (Gr1 (E))\n> ... >\nr(Gr1 (E))\nr(Grl (E))\nhold. This filtration is called the Harder-Narasimhan filtration of E (in the\nsense of Gieseker semistability). The first step HN1 (E) is called the maximal\ndestabilizing subsheaf of E. The integer l (also written as l(E)) is called as\nthe length of the Harder-Narasimhan filtration of E. In these terms, a nonzero\npure-dimensional sheaf is semistable if and only if its Harder-Narasimhan filtration\nis of length l(E) = 1. The ordered l(E)-tuple\nHN(E) = (P (HN1 (E)), . . . , P (HNl (E))) \u2208 HNT\nis called the Harder-Narasimhan type of E.\nIn his path-breaking paper [Sh], S.S. Shatz addressed the question of the variation\nof the Harder-Narasimhan type in a family. The set-up for this is as follows. Let S\nbe a locally noetherian scheme, and let \u03c0 : X \u2192 S be a projective scheme over S,\nwith a relatively ample line bundle OX (1). Let E be a coherent sheaf of OX -modules\nwhich is flat over S such each restriction Es to the schematic fiber Xs = \u03c0 \u22121 (s) is\npure-dimensional. The Harder-Narasimhan function of E is the function\n|S| \u2192 HNT : s 7\u2192 HN(Es )\n3\n\n\fwhere |S| denotes the underlying topological space of the scheme S. Shatz proved in\n[Sh] that HN(Es ) is upper-semicontinuous w.r.t. the partial order \u2264 on HNT defined\nabove (actually, HN-filtrations in the sense of \u03bc-semistability rather than Gieseker\nsemistability are considered in [Sh], but the proofs in the Gieseker semistability case\nare similar with obvious changes).\nRemark 1 In particular, for any \u03c4 \u2208 HNT, the corresponding level set\n|S|\u03c4 (E) = {s \u2208 |S| such that HN(Es ) = \u03c4 }\nis locally closed in |S|, the subset |S|\u2264\u03c4 (E) =\n|S|\u03c4 (E) is closed in |S|\u2264\u03c4 (E).\n\nS\n\n\u03b1\u2264\u03c4\n\n|S|\u03b1 (E) \u2282 |S| is open in |S|, and\n\nRemark 2 If (f1 , . . . , fp ) \u2208 HNT, then (f2 \u2212 f1 , . . . , fp \u2212 f1 ) is again in HNT.\nLet E be pure-dimensional on Y with HN(E) \u2264 (f1 , . . . , fp ) \u2208 HNT. If E \u2032 \u2282 E\nis a coherent subsheaf with P (E \u2032 ) = f1 , then we must have HN1 (E) = E \u2032 , that is,\nsuch an E \u2032 is automatically the maximal destabilizing subsheaf of E. The quotient\nE \u2032\u2032 = E/E \u2032 is pure-dimensional, with HN(E \u2032\u2032 ) \u2264 (f2 \u2212 f1 , . . . , fp \u2212 f1 ). Moreover,\nwe have HomY (E \u2032 , E \u2032\u2032 ) = 0.\nRemark 3 If (Y, OY (1)) is a projective scheme over a field k and if K any extension\nfield of k, then a coherent sheaf E on Y is semistable w.r.t. OY (1) if and only if\nits base-change EK = E \u2297k K to YK is semistable w.r.t. OYK (1) = OY (1) \u2297k K.\nConsequently, if E is any pure-dimensional sheaf on Y then the Harder-Narasimhan\nfiltration HNi (EK ) is just the pullback HNi (E) \u2297k K of the Harder-Narasimhan\nfiltration of E.\n\n3. Scheme structures on HN strata\nFor basic facts that we need from Grothendieck's theory of Quot schemes and\ntheir deformation theory, the reader can consult [Hu-Le], [F-G], [Ni 1] and [Ni 2].\nLemma 4 A morphism f : T \u2192 S between locally noetherian schemes is a closed\nembedding if (and only if ) f is proper, injective, unramified and induces an isomorphism k(f (t)) \u2192 k(t) of residue fields for all t \u2208 T .\nProof Note that f (T ) is closed in S, and f\u2217 OT is coherent. It only remains to show\nthat the homomorphism f # : OS \u2192 f\u2217 OT is surjective. It is enough to show it\nstalk-wise at all points of f (T ), so we can assume that S = Spec A where A is a\n4\n\n\fnoetherian local ring. Then by finiteness and injectivity of f , we have T = Spec B\nwhere B is a finite local A algebra, and f # : A \u2192 B is a local homomorphism which\nby assumption induces an isomorphism A/mA \u2192 B/mB on the residue fields, and\nmB = mA B by assumption of unramifiedness. Hence it follows by the Nakayama\nlemma that f # : A \u2192 B is surjective. \u0003\nLet X be a projective scheme over a locally noetherian base scheme S, with a\nchosen relatively ample line bundle OX (1). Let E be a coherent sheaf on X which\nis flat over S, such that the restriction Es = E|Xs of E to the schematic fiber\nXs of X over each s \u2208 S is a nonzero pure-dimensional sheaf of a fixed HN type\n\u03c4 = (f1 , . . . , fl ). A relative Harder-Narasimhan filtration of E is a filtration\n0 = E0 \u2282 E1 \u2282 . . . \u2282 El = E by coherent subsheaves on X, such that for each i\nwith 1 \u2264 i \u2264 l, the quotient Ei /Ei\u22121 is flat S, and for each s \u2208 S this filtration\nrestricts to give the Harder-Narasimhan filtration HNi (Es ) of Es .\nWe now come to the main result of this note.\nTheorem 5 (Main Theorem) Let X be a projective scheme over a locally noetherian scheme S, with a relatively ample line bundle OX (1). Let E be a coherent sheaf\non X which is flat over S, such that the restriction Es is a pure-dimensional sheaf\non Xs for each s \u2208 S. Let \u03c4 = (f1 , . . . , fl ) \u2208 HNT. Then we have the following.\n(1) Each Harder-Narasimhan stratum |S|\u03c4 (E) of E has a unique structure of a locally\nclosed subscheme S \u03c4 (E) of S, with the following universal property: a morphism\nT \u2192 S factors via S \u03c4 (E) if and only if the pullback ET on X \u00d7S T admits a relative\nHarder-Narasimhan filtration of type \u03c4 .\n(2) A relative Harder-Narasimhan filtration on E, if it exists, is unique.\n(3) For any morphism f : T \u2192 S of locally noetherian schemes, the schematic\nstratum T \u03c4 (ET ) \u2282 T for ET equals the schematic inverse image of S \u03c4 (E) under f .\nProof If l = 1, then we take S \u03c4 (E) to be the open subscheme of S consisting of all\ns such that Es is semistable with Hilbert polynomial f1 . We now argue by induction\non l \u2265 2. By Remark 1, all s with HN(Es ) \u2264 \u03c4 form an open subset |S|\u2264\u03c4 (E) of S,\nand |S|\u03c4 (E) is a closed subset of |S|\u2264\u03c4 (E). We give |S|\u2264\u03c4 (E) the unique structure of\nan open subscheme of S, which we denote by S \u2264\u03c4 (E). In what follows we will give\nthe closed subset |S|\u03c4 (E) a particular structure of a closed subscheme of S \u2264\u03c4 (E),\nwhich has the desired universal property.\nLet X \u2264\u03c4 be the inverse image of S \u2264\u03c4 = S \u2264\u03c4 (E) in X, and let OX \u2264\u03c4 (1) and E \u2264\u03c4\nbe the restrictions of OX (1) and E to X \u2264\u03c4 . Consider the relative Quot scheme\nfl \u2212f1 , O\n\n\u2264\u03c4 (1)\n\nQ = QuotE \u2264\u03c4 /X \u2264\u03c4X /S \u2264\u03c4\n5\n\n\fwith projection \u03c0 : Q \u2192 S \u2264\u03c4 . Then \u03c0 is projective, hence proper.\nLet q \u2208 Q represent a quotient q \u2032 : Eq \u2192 F on Xq . Then ker(q \u2032 ) = HN1 (Eq )\nby Remark 2. If q 7\u2192 s \u2208 S \u2264\u03c4 , then by Remark 3 the quotient q \u2032 is the pullback of\nthe quotient Es \u2192 Es / HN1 (Es ) which is defined over Xs . Hence the residue field\nextension k(s) \u2192 k(q) is trivial. By the uniqueness of HN1 (Es ), there exists at most\none such q over s. The fiber of \u03c0 : Q \u2192 S \u2264\u03c4 over s is the Quot scheme\nf \u2212f , O\n\n(1)\n\nXs\n.\n\u03c0 \u22121 (s) = QuotEls /X1s /k(s)\n\nBy a standard fact in the deformation theory for Quot schemes (see, for example,\nTheorem 3.11.(2) in [Ni 2]), its tangent space at q is given by\nTq (\u03c0 \u22121 (s)) = HomXq (ker(q \u2032 ), Eq / ker(q \u2032 )) = HomXq (HN1 (Eq ), Eq / HN1 (Eq ))\nwhich is zero by Remark 2. Hence \u03c0 : Q \u2192 S \u2264\u03c4 is unramified.\nIt now follows by Lemma 4 that \u03c0 : Q \u2192 S \u2264\u03c4 is a closed imbedding.\nNow consider the universal quotient sheaf EQ \u2192 E \u2032\u2032 on XQ = X \u00d7S Q. By\nRemark 2, for all q \u2208 Q the sheaf Eq\u2032\u2032 on Xq is pure-dimensional, with\nHN(Eq\u2032\u2032 ) \u2264 \u03c4 \u2032\u2032 = (f2 \u2212 f1 , . . . , fl \u2212 f1 ).\n\u2032\u2032\n\nIn particular, we have Q\u2264\u03c4 (E \u2032\u2032 ) = Q. The Harder-Narasimhan type \u03c4 \u2032\u2032 has length\n\u2032\u2032\nl \u2212 1, hence by induction on the length, the closed subset |Q|\u03c4 (E \u2032\u2032 ) of Q has\n\u2032\u2032\nthe structure of a closed subscheme Q\u03c4 (E \u2032\u2032 ) \u2282 Q which has the desired universal\nproperty for E \u2032\u2032 . We regard Q as a closed subscheme of S \u2264\u03c4 via \u03c0, and we finally\ndefine the closed subscheme S \u03c4 (E) \u2282 S \u2264\u03c4 by putting\n\u2032\u2032\n\nS \u03c4 (E) = Q\u03c4 (E \u2032\u2032 ) \u2282 Q \u2282 S \u2264\u03c4 .\nWe now show that S \u03c4 (E) so defined has the desired universal property. As \u03c4 \u2032\u2032 has\nlength l \u2212 1, by induction on the length, the restriction ES\u2032\u2032\u03c4 (E) of E \u2032\u2032 to X \u00d7S S \u03c4 (E)\nhas a unique relative Harder-Narasimhan filtration\n\u2032\u2032\n0 \u2282 E1\u2032\u2032 \u2282 . . . \u2282 El\u22121\n= ES\u2032\u2032\u03c4 (E)\n\nwith Harder-Narasimhan type \u03c4 \u2032\u2032 . For 2 \u2264 i \u2264 l, let Ei be the inverse image of\n\u2032\u2032\nEi\u22121\nunder the restriction of universal quotient EQ \u2192 E \u2032\u2032 to XS \u03c4 (E) . This defines\na relative Harder-Narasimhan filtration 0 \u2282 E1 \u2282 . . . \u2282 El = ES \u03c4 (E) of ES \u03c4 (E) over\nthe base S \u03c4 (E). In particular, if a morphism T \u2192 S factors via S \u03c4 (E) then the\npullback of this filtration gives a relative Harder-Narasimhan filtration over T .\nConversely, let f : T \u2192 S be a morphism such that the pullback ET on XT\nhas a relative Harder-Narasimhan filtration 0 = F0 \u2282 F1 \u2282 . . . \u2282 Fl = ET of type\n6\n\n\f\u03c4 . The quotient ET \u2192 ET /F1 has Hilbert polynomial fl \u2212 f1 over all t \u2208 T , so\nby the universal property of the Quot scheme Q, the morphism T \u2192 S factors via\nQ \u0592\u2192 S, inducing a morphism f \u2032 : T \u2192 Q. By Remark 2, the restriction of ET /F1 is\npure-dimensional on Xt for all t \u2208 T , and 0 = (F1 /F1 ) \u2282 (F2 /F1 ) \u2282 . . . \u2282 (Fl /F1 ) =\nET /F1 is a relative Harder-Narasimhan filtration of ET /F1 = (f \u2032 )\u2217 (E \u2032\u2032 ) over the\nbase T , with type \u03c4 \u2032\u2032 which has length l \u2212 1. Hence by induction, f \u2032 : T \u2192 Q factors\n\u2032\u2032\nvia Q\u03c4 (E \u2032\u2032 ) = S \u03c4 (E), as desired. This completes the proof of (1).\nNext we show the uniqueness of a relative Harder-Narasimhan filtration 0 =\nE0 \u2282 E1 \u2282 . . . \u2282 El = E over a base S, assuming such a filtration exists. As\n|S|\u03c4 (E) = |S|, we at least have S = S \u2264\u03c4 (E). With notation as above, we have\nshown that \u03c0 : Q \u2192 S \u2264\u03c4 is a closed imbedding, therefore \u03c0 admits at most one\nglobal section, which shows that E1 is unique. By inductive assumption on l, the\nquotient family E/E1 admits a unique relative Harder-Narasimhan filtration Fj , so\ndefining Ei \u2282 E to be the inverse image of Fi\u22121 under E \u2192 E/E1 for 2 \u2264 i \u2264 l,\nwe see that 0 = E0 \u2282 E1 \u2282 . . . \u2282 El = E is the only possible relative HarderNarasimhan filtration on E. This proves the statement (2).\nThe base-change property (3) for the schematic strata is a direct consequence of\nthe universal property (1). This completes the proof of the theorem.\n\u0003\nThe following immediate implication of Theorem 5 shows that when the HN type\nis constant over a reduced base scheme, the outcome is as nice as can be expected.\nCorollary 6 (Case of constant HN type over a reduced base) Let X be a\nprojective scheme over a locally noetherian base scheme S, with a chosen relatively\nample line bundle OX (1). Let E be a coherent sheaf on X which is flat over S,\nsuch that the restriction Es = E|Xs of E to the schematic fiber Xs of X over each\ns \u2208 S is a pure-dimensional sheaf of a fixed Harder-Narasimhan type \u03c4 \u2208 HNT.\nSuppose moreover that S is reduced. Then S = S \u03c4 , that is, E admits a unique\nrelative Harder-Narasimhan filtration.\n\n4. Moduli stack Coh\u03c4X/S\nFor basic terminology and conventions about stacks, we will follow the book [LMB] by Laumon and Moret-Bailly. In what follows, X will be a projective scheme\nover a locally noetherian base scheme S, with a chosen relatively ample line bundle\nOX (1), and \u03c4 = (f1 , . . . , fl ) will be any element of HNT.\nLet CohX/S denote the Artin algebraic stack over S of all flat families of coherent\nsheaves on X/S (see [L-MB] 2.4.4). In any such family, pure-dimensionality of all restriction to fibers is an open condition on the parameter scheme, pure-dimensionality\nis preserved by arbitrary base changes, and the base-change under a surjection is\n7\n\n\fpure-dimensional on all fibers if and only if the original is so. Hence pure-dimensional\ncoherent sheaves form an open algebraic substack Cohpure\nX/S \u2282 CohX/S .\n\u03c4\nWe will define the moduli stack CohX/S of pure-dimensional coherent sheaves of\ntype \u03c4 as a strictly full sub S-groupoid of Cohpure\nX/S , as follows. For any S-scheme T ,\npure\nwe say that an object E \u2208 CohX/S (T ) lies in Coh\u03c4X/S (T ) if and only if E admits a\nrelative Harder-Narasimhan filtration with constant type \u03c4 . This is clearly closed\nunder pullbacks f \u2217 : CohX/S (T ) \u2192 CohX/S (T \u2032 ) for all S-morphisms f : T \u2032 \u2192 T .\nTo prove that the S-groupoid Coh\u03c4X/S thus defined is a stack, we need the following property of effective descent.\nLemma 7 Let T be an S-scheme and let E be an object of CohX/S (T ). Let f : T \u2032 \u2192\nT be a faithfully flat quasi-compact morphism. If the pullback f \u2217 E is in Coh\u03c4X/S (T \u2032 ),\nthen E is in Coh\u03c4X/S (T ).\nProof Each Et , where t \u2208 T , is pure-dimensional with Harder-Narasimhan type \u03c4 ,\nas its pullback Et\u2032 is so for any t\u2032 \u2208 T \u2032 with t\u2032 7\u2192 t, and as T \u2032 \u2192 T is surjective. It\nnow only remains to construct a relative Harder-Narasimhan filtration of E. This\nwe do by showing that the relative Harder-Narasimhan filtration (Fi ) of the pullback\nET \u2032 descends under T \u2032 \u2192 T .\n\u2032\n\u2192 T . By Grothendieck's result on\nLet T \u2032\u2032 = T \u2032 \u00d7T T \u2032 with projections \u03c01 , \u03c02 : T \u2032\u2032 \u2192\neffective fpqc descent for quasicoherent subsheaves of the pullback of a quasicoherent\nsheaf, to show that the filtration descends to T we just have to show that the\n\u2032\n\u2192 T are identical.\npullbacks of the filtration under the two projections \u03c01 , \u03c02 : T \u2032\u2032 \u2192\nBut note that we have an identification \u03c01\u2217 (ET \u2032 ) = \u03c02\u2217 (ET \u2032 ) = ET \u2032\u2032 , under which\nthe pullbacks \u03c01\u2217 (Fi ) and \u03c02\u2217 (Fi ) are relative Harder-Narasimhan filtrations of ET \u2032\u2032 .\nHence these filtrations coincide by Theorem 5.\n\u0003\nTheorem 8 Let X be a projective scheme over a locally noetherian scheme S, with\na relatively ample line bundle OX (1). Let \u03c4 be any Harder-Narasimhan type. Then\nall flat families of pure-dimensional coherent sheaves on X/S with fixed HarderNarasimhan type \u03c4 form an algebraic stack Coh\u03c4X/S over S, which is a locally closed\nsubstack of the algebraic stack CohX/S of all flat families of coherent sheaves on\nX/S.\nProof The inclusion 1-morphism of S-groupoids \u03b8 : Coh\u03c4X/S \u0592\u2192 Cohpure\nX/S is fully\n\u03c4\nfaithful. Hence CohX/S is a pre-stack over S. By Lemma 7, the pre-stack Coh\u03c4X/S\nsatisfies effective fpqc descent, so it is a stack over S. We next prove that it is\nalgebraic.\n\u03c4\nGiven any E in Cohpure\nX/S (T ), let T (E) \u2282 T be the corresponding schematic\nHarder-Narasimhan stratum as given by Theorem 5. Let [E] : T \u2192 Cohpure\nX/S be the\n8\n\n\fclassifying 1-morphism of E. By Theorem 5 we have a natural isomorphism\n\u03c4\n\u223c \u03c4\nT \u00d7[E],Cohpure\n,\u03b8 CohX/S = T (E)\nX/S\n\nof S-groupoids, under which the projection of the fibered product to T corresponds\nto the imbedding of T \u03c4 (E) as a locally closed subscheme in T .\nThis shows the inclusion 1-morphism \u03b8 : Coh\u03c4X/S \u0592\u2192 CohX/S of stacks is a representable locally closed imbedding. Hence Coh\u03c4X/S is an algebraic stack over S, which\nis a locally closed substack of CohX/S .\n\u0003\nWe now come to the question of quasi-projectivity of Coh\u03c4X/S . For a given X/S,\nOX (1) and \u03c4 = (f1 , . . . , fl ), consider the following boundedness condition (*).\n(*) There exists a natural number N such that for any morphism Spec K \u2192 S where\nK is a field and any semistable coherent sheaf F on the base-change XK whose\nHilbert polynomial is equal to fi for any 1 \u2264 i \u2264 l, the sheaf F (N) = F \u2297 OXK (N)\nis generated by global sections, and all its cohomology groups H j (XK , F (N)) vanish\nfor j \u2265 1.\nBy the boundedness theorems of Maruyama-Simpson [Si] and Langer [La], the\ncondition (*) is indeed satisfied in many cases of interest, for example, when S is of\nfinite type over an algebraically closed field k of arbitrary characteristic.\nProposition 9 (Quasi-projectivity of Coh\u03c4X/S ) If the above boundedness condition (*) is satisfied, then the stack Coh\u03c4X/S admits an atlas U \u2192 Coh\u03c4X/S such that\nU is a quasi-projective scheme over S.\nProof If a coherent sheaf E is of type \u03c4 on XK for an S-field K, then by (*),\nE is a quotient of OXK (\u2212N)fl (N ) . Let Q be the relative Quot scheme over S\nwhich parameterizes all coherent quotient sheaves of OX (\u2212N)fl (N ) on fibers of\nX/S, with fixed Hilbert polynomial fl . Let E be the universal quotient sheaf on\nX \u00d7S Q. Let Qo \u2282 Q be the open subscheme consisting of all q \u2208 Q satisfying\nthe conditions that Eq is pure-dimensional, Eq (N) is generated by global sections,\nf (N )\nthe map H 0 (Xq , OXlq ) \u2192 H 0 (Xq , Eq (N)) induced by q is an isomorphism, and\nH i (Xq , Eq (N)) = 0 for all i \u2265 1 (each of these conditions is an open condition).\nLet Eo be the restriction of E to X \u00d7S Qo . Let Q\u03c4o (Eo ) be the locally closed\nsubscheme of Qo corresponding to the Harder-Narasimhan type \u03c4 , given by Theorem\n5. The classifying 1-morphism [Eo ] : Q\u03c4o (Eo ) \u2192 Coh\u03c4X/S of Eo is an atlas for Coh\u03c4X/S\n(that is, [Eo ] is a representable smooth surjection), as follows from the proof of\nTheorem 4.6.2.1 in Laumon and Moret-Bailly [L-MB]. As Q is projective over S, its\nlocally closed subscheme U is quasi-projective over S, as desired.\n\u0003\n\n9\n\n\fReferences\n[B-M-Ni] Brambila-Paz L., Mata, O. and Nitsure, N. : Endomorphisms and moduli\nfor unstable bundles. (Preprint, 2009).\n[F-G] Fantechi, B. and G\u00f6ttsche, L. : Local properties and Hilbert schemes of points.\nPart 3 of 'Fundamental Algebraic Geometry \u2013 Grothendieck's FGA Explained.', Fantechi et al, Math. Surveys and Monographs Vol. 123, American Math. Soc. (2005).\n[H-N] Harder, G. and Narasimhan, M.S. : On the cohomology groups of moduli\nspaces of vector bundles on curves. Math. Ann. 212 (1974/75), 215\u2013248.\n[Hu-Le] Huybrechts, D. and Lehn, M. : 'The Geometry of Moduli Spaces of Sheaves.'\nAspects of Mathematics 31, Vieweg (1997).\n[La] Langer, A. : Semistable sheaves in positive characteristic. Ann. of Math. (2)\n159 (2004), 251\u2013276.\n[L-MB] Laumon, G. and Moret-Bailly, L. : 'Champs alg\u00e9briques.' Springer (2000).\n[Ni 1] Nitsure, N. : Construction of Hilbert and Quot schemes. Part 2 of 'Fundamental Algebraic Geometry \u2013 Grothendieck's FGA Explained.', Fantechi et al, Math.\nSurveys and Monographs Vol. 123, American Math. Soc. (2005).\n[Ni 2] Nitsure, N. : Deformation theory for vector bundles. Chapter 5 of Moduli\nSpaces and Vector Bundles (edited by Brambila-Paz, Bradlow, Garcia-Prada and\nRamanan), London Math. Soc. Lect. Notes 359, Cambridge Univ. Press (2009).\n[Sh] Shatz, S.S. : The decomposition and specialization of algebraic families of vector\nbundles. Compositio Math. 35 (1977), no. 2, 163\u2013187.\n[Si] Simpson, C. Moduli of representations of the fundamental group of a smooth\nprojective variety -I. Publ. Math. I.H.E.S. 79 (1994), 47\u2013129.\nSchool of Mathematics,\nTata Institute of Fundamental Research,\nHomi Bhabha Road,\nMumbai 400 005,\nINDIA.\n\nnitsure@math.tifr.res.in\n\n04 Sep 2009\n\n10\n\n\f"}