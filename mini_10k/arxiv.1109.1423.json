{"id": "http://arxiv.org/abs/1109.1423v1", "guidislink": true, "updated": "2011-09-07T11:34:28Z", "updated_parsed": [2011, 9, 7, 11, 34, 28, 2, 250, 0], "published": "2011-09-07T11:34:28Z", "published_parsed": [2011, 9, 7, 11, 34, 28, 2, 250, 0], "title": "Implicitization of rational maps", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.3698%2C1109.1047%2C1109.4051%2C1109.1461%2C1109.1916%2C1109.0503%2C1109.3249%2C1109.6211%2C1109.5778%2C1109.6312%2C1109.6444%2C1109.2777%2C1109.6139%2C1109.5774%2C1109.1033%2C1109.0762%2C1109.6504%2C1109.5055%2C1109.5038%2C1109.1491%2C1109.4337%2C1109.4660%2C1109.5687%2C1109.2061%2C1109.2480%2C1109.2536%2C1109.0819%2C1109.6103%2C1109.4071%2C1109.4359%2C1109.5053%2C1109.3605%2C1109.3693%2C1109.5467%2C1109.3191%2C1109.6387%2C1109.5227%2C1109.3553%2C1109.6068%2C1109.4751%2C1109.2331%2C1109.1083%2C1109.2603%2C1109.6317%2C1109.1553%2C1109.5920%2C1109.0511%2C1109.0965%2C1109.3587%2C1109.4659%2C1109.3736%2C1109.5203%2C1109.4375%2C1109.2627%2C1109.4807%2C1109.6161%2C1109.0469%2C1109.0488%2C1109.5272%2C1109.2550%2C1109.3208%2C1109.1746%2C1109.4729%2C1109.6293%2C1109.4364%2C1109.6515%2C1109.3976%2C1109.4013%2C1109.6725%2C1109.4511%2C1109.4815%2C1109.5567%2C1109.0408%2C1109.1493%2C1109.3807%2C1109.3559%2C1109.4596%2C1109.5106%2C1109.3483%2C1109.2138%2C1109.6916%2C1109.3264%2C1109.6744%2C1109.2944%2C1109.1423%2C1109.2447%2C1109.4737%2C1109.6550%2C1109.0739%2C1109.1578%2C1109.3323%2C1109.4508%2C1109.6460%2C1109.1100%2C1109.3226%2C1109.5197%2C1109.2449%2C1109.3032%2C1109.2108%2C1109.0628%2C1109.3188&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Implicitization of rational maps"}, "summary": "Motivated by the interest in computing explicit formulas for resultants and\ndiscriminants initiated by B\\'ezout, Cayley and Sylvester in the eighteenth and\nnineteenth centuries, and emphasized in the latest years due to the increase of\ncomputing power, we focus on the implicitization of hypersurfaces in several\ncontexts. Our approach is based on the use of linear syzygies by means of\napproximation complexes, following [Bus\\'e Jouanolou 03], where they develop\nthe theory for a rational map $f:P^{n-1}\\dashrightarrow P^n$. Approximation\ncomplexes were first introduced by Herzog, Simis and Vasconcelos in [Herzog\nSimis Vasconcelos 82] almost 30 years ago. The main obstruction for this\napproximation complex-based method comes from the bad behavior of the base\nlocus of $f$. Thus, it is natural to try different compatifications of\n$A^{n-1}$, that are better suited to the map $f$, in order to avoid unwanted\nbase points. With this purpose, in this thesis we study toric compactifications\n$T$ for $A^{n-1}$. We provide resolutions $Z.$ for $Sym_I(A)$, such that\n$\\det((Z.)_\\nu)$ gives a multiple of the implicit equation, for a graded strand\n$\\nu\\gg 0$. Precisely, we give specific bounds $\\nu$ on all these settings\nwhich depend on the regularity of $\\SIA$. Starting from the homogeneous\nstructure of the Cox ring of a toric variety, graded by the divisor class group\nof $T$, we give a general definition of Castelnuovo-Mumford regularity for a\npolynomial ring $R$ over a commutative ring $k$, graded by a finitely generated\nabelian group $G$, in terms of the support of some local cohomology modules. As\nin the standard case, for a $G$-graded $R$-module $M$ and an homogeneous ideal\n$B$ of $R$, we relate the support of $H_B^i(M)$ with the support of\n$Tor_j^R(M,k)$.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.3698%2C1109.1047%2C1109.4051%2C1109.1461%2C1109.1916%2C1109.0503%2C1109.3249%2C1109.6211%2C1109.5778%2C1109.6312%2C1109.6444%2C1109.2777%2C1109.6139%2C1109.5774%2C1109.1033%2C1109.0762%2C1109.6504%2C1109.5055%2C1109.5038%2C1109.1491%2C1109.4337%2C1109.4660%2C1109.5687%2C1109.2061%2C1109.2480%2C1109.2536%2C1109.0819%2C1109.6103%2C1109.4071%2C1109.4359%2C1109.5053%2C1109.3605%2C1109.3693%2C1109.5467%2C1109.3191%2C1109.6387%2C1109.5227%2C1109.3553%2C1109.6068%2C1109.4751%2C1109.2331%2C1109.1083%2C1109.2603%2C1109.6317%2C1109.1553%2C1109.5920%2C1109.0511%2C1109.0965%2C1109.3587%2C1109.4659%2C1109.3736%2C1109.5203%2C1109.4375%2C1109.2627%2C1109.4807%2C1109.6161%2C1109.0469%2C1109.0488%2C1109.5272%2C1109.2550%2C1109.3208%2C1109.1746%2C1109.4729%2C1109.6293%2C1109.4364%2C1109.6515%2C1109.3976%2C1109.4013%2C1109.6725%2C1109.4511%2C1109.4815%2C1109.5567%2C1109.0408%2C1109.1493%2C1109.3807%2C1109.3559%2C1109.4596%2C1109.5106%2C1109.3483%2C1109.2138%2C1109.6916%2C1109.3264%2C1109.6744%2C1109.2944%2C1109.1423%2C1109.2447%2C1109.4737%2C1109.6550%2C1109.0739%2C1109.1578%2C1109.3323%2C1109.4508%2C1109.6460%2C1109.1100%2C1109.3226%2C1109.5197%2C1109.2449%2C1109.3032%2C1109.2108%2C1109.0628%2C1109.3188&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Motivated by the interest in computing explicit formulas for resultants and\ndiscriminants initiated by B\\'ezout, Cayley and Sylvester in the eighteenth and\nnineteenth centuries, and emphasized in the latest years due to the increase of\ncomputing power, we focus on the implicitization of hypersurfaces in several\ncontexts. Our approach is based on the use of linear syzygies by means of\napproximation complexes, following [Bus\\'e Jouanolou 03], where they develop\nthe theory for a rational map $f:P^{n-1}\\dashrightarrow P^n$. Approximation\ncomplexes were first introduced by Herzog, Simis and Vasconcelos in [Herzog\nSimis Vasconcelos 82] almost 30 years ago. The main obstruction for this\napproximation complex-based method comes from the bad behavior of the base\nlocus of $f$. Thus, it is natural to try different compatifications of\n$A^{n-1}$, that are better suited to the map $f$, in order to avoid unwanted\nbase points. With this purpose, in this thesis we study toric compactifications\n$T$ for $A^{n-1}$. We provide resolutions $Z.$ for $Sym_I(A)$, such that\n$\\det((Z.)_\\nu)$ gives a multiple of the implicit equation, for a graded strand\n$\\nu\\gg 0$. Precisely, we give specific bounds $\\nu$ on all these settings\nwhich depend on the regularity of $\\SIA$. Starting from the homogeneous\nstructure of the Cox ring of a toric variety, graded by the divisor class group\nof $T$, we give a general definition of Castelnuovo-Mumford regularity for a\npolynomial ring $R$ over a commutative ring $k$, graded by a finitely generated\nabelian group $G$, in terms of the support of some local cohomology modules. As\nin the standard case, for a $G$-graded $R$-module $M$ and an homogeneous ideal\n$B$ of $R$, we relate the support of $H_B^i(M)$ with the support of\n$Tor_j^R(M,k)$."}, "authors": ["Nicolas Botbol"], "author_detail": {"name": "Nicolas Botbol"}, "author": "Nicolas Botbol", "arxiv_comment": "PhD. Thesis of the author, from Universit\\'e de Paris VI and\n  Univesidad de Buenos Aires. Advisors: Marc Chardin and Alicia Dickenstein.\n  Defended the 29th september 2010. 163 pages 15 figures", "links": [{"href": "http://arxiv.org/abs/1109.1423v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1109.1423v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AC", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1109.1423v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1109.1423v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:1109.1423v1 [math.AG] 7 Sep 2011\n\nUNIVERSIDAD DE BUENOS AIRES\nFacultad de Ciencias Exactas y Naturales\nDepartamento de Matem\u00e1tica\n\nUNIVERSITE PIERRE ET MARIE CURIE\nSciences Math\u00e9matiques de Paris Centre\nInstitut de Math\u00e9matiques de Jussieu\n\nPhD. THESIS\nfrom:\nUNIVERSIDAD DE BUENOS AIRES &\nUNIVERSIT\u00c9 PIERRE ET MARIE CURIE\nAuthor:\nNicol\u00e1s Botbol\nFor the grade of:\nDOCTOR de la UNIVERSIDAD DE BUENOS AIRES,\nen el \u00e1rea de Ciencias Matem\u00e1ticas\nDOCTEUR de l'UNIVERSIT\u00c9 PIERRE ET MARIE CURIE,\nsp\u00e9cialit\u00e9 en Sciences Math\u00e9matiques.\nTitle:\nIMPLICITIZATION OF RATIONAL MAPS\nDefended the 29th September 2010 at 14h, UPMC, Paris, France.\nJury composed by:\nMarc Chardin\nAlicia Dickenstein\nDavid Cox\nJean-Pierre Jouanolou\nMonique Lejeune-Jalabert\nJoseph Oesterl\u00e9\nLaurent Bus\u00e9\n\nThesis Advisor\nThesis Advisor\nRapporteurs\nRapporteurs\nExaminateurs\nExaminateurs\nExaminateurs\n\n\f\fIMPLICITIZATION OF RATIONAL MAPS.\nMotivated by the interest in computing explicit formulas for resultants and\ndiscriminants initiated by B\u00e9zout, Cayley and Sylvester in the eighteenth and\nnineteenth centuries, and emphasized in the latest years due to the increase of\ncomputing power, we focus on the implicitization of hypersurfaces in several\ncontexts. Implicitization means, given a rational map f : An\u22121 99K An , to\ncompute an implicit equation H of the closed image im(f ). This is a classical problem and there are numerous approaches to its solution (cf. [SC95] and\n[Cox01]). However, it turns out that the implicitization problem is computationally difficult.\nOur approach is based on the use of linear syzygies by means of approximation complexes, following [BJ03], [BC05], and [Cha06], where they develop\nthe theory for a rational map f : Pn\u22121 99K Pn . Approximation complexes were\nfirst introduced by Herzog, Simis and Vasconcelos in [HSV83a] almost 30 years\nago.\nThe main obstruction for this approximation complex-based method comes\nfrom the bad behavior of the base locus of f . Thus, it is natural to try different\ncompatifications of An\u22121 , that are better suited to the map f , in order to\navoid unwanted base points. With this purpose, in this thesis we study toric\ncompactifications T for An\u22121 . First, we view T embedded in a projective\nspace. Furthermore, we compactify the codomain inside (P1 )n , to deal with\nthe case of different denominators in the rational functions defining f . We also\napproach the implicitization problem considering the toric variety T defined\nby its Cox ring, without any particular projective embedding. In all this cases,\nwe blow-up the base locus of the map and we approximate the Rees algebra\nReesA (I) of this blow-up by the symmetric algebra SymA (I). We provide\nresolutions Z\u2022 for SymA (I), such that det((Z\u2022 )\u03bd ) gives a multiple of the implicit\nequation, for a graded strand \u03bd \u001d 0. Precisely, we give specific bounds \u03bd\non all these settings which depend on the regularity of SymA (I). We also\ngive a geometrical interpretation of the possible other factors appearing on\ndet((Z\u2022 )\u03bd ).\nStarting from the homogeneous structure of the Cox ring of a toric variety, graded by the divisor class group of T , we give a general definition of\nCastelnuovo-Mumford regularity for a polynomial ring R over a commutative\nring k, graded by a finitely generated abelian group G, in terms of the support\nof some local cohomology modules. As in the standard case, for a G-graded Ri (M )\nmodule M and an homogeneous ideal B of R, we relate the support of HB\nR\nwith the support of Torj (M, k).\n\n\f\fIMPLICITISATION D'APPLICATIONS RATIONNELLES.\nMotiv\u00e9 par la recherche de formules explicites pour les r\u00e9sultants et les discriminants, qui remonte au moins aux travaux de B\u00e9zout, Cayley et Sylvester\nau XVIII\u00e8me et XIX\u00e8me si\u00e8cles et a donn\u00e9 lieu \u00e0 de nouveaux d\u00e9veloppements\ndans les derni\u00e8res ann\u00e9es en raison de l'augmentation de la puissance de calcul,\non se concentre sur l'implicitisation des hypersurfaces dans plusieurs contextes.\nImplicitisation signifie calculer une \u00e9quation implicite H de l'image ferm\u00e9e\nim(f ), \u00e9tant donn\u00e9e une application rationnelle f : A(n\u22121) 99K An . C'est un\nprobl\u00e8me classique et il y a de nombreuses approches (cf. [SC95] et [Cox01]).\nToutefois, il s'av\u00e8re que le probl\u00e8me d'implicitisation est difficile du point de\nvue du calcul.\nNotre approche est bas\u00e9e sur l'utilisation des syzygies lin\u00e9aires au moyen\ndes complexes d'approximation, en suivant [BJ03], [BC05], et [Cha06], o\u00f9 ils\nd\u00e9veloppent la th\u00e9orie pour une application rationnelle f : P(n\u22121) 99K Pn . Les\ncomplexes d'approximation ont d'abord \u00e9t\u00e9 introduits par Herzog, Simis et\nVasconcelos dans [HSV83a] il y a presque 30 ans.\nL'obstruction principale de la m\u00e9thode des complexes d'approximation vient\ndu mauvais comportement du lieu base de f . Ainsi, il est naturel d'essayer\ndiff\u00e9rentes compatifications de A(n\u22121) , qui sont mieux adapt\u00e9es \u00e0 f , afin d'\u00e9viter\ndes points base non d\u00e9sir\u00e9s. A cet effet, dans cette th\u00e8se on \u00e9tudie des compactifications toriques T de A(n\u22121) . Tout d'abord, on consid\u00e8re T plong\u00e9e dans\nun espace projectif. En outre, on compactifie le codomaine dans (P1 )n , pour\nfaire face aux cas des d\u00e9nominateurs diff\u00e9rents dans les fonctions rationnelles\nqui d\u00e9finissent f . On a \u00e9galement abord\u00e9 le probl\u00e8me implicitisation lorsque la\nvari\u00e9t\u00e9 torique T est d\u00e9finie par son anneau de Cox, sans un plongement projectif particulier. Dans tous ces cas, on \u00e9clate le lieu base de f et on approche\nl'alg\u00e8bre de Rees ReesA (I) par l'alg\u00e8bre sym\u00e9trique SymA (I). On fournit des\nr\u00e9solutions Z\u2022 de SymA (I), telle que det((Z\u2022 )\u03bd ) donne un multiple de l'\u00e9quation\nimplicite, pour \u03bd \u001d 0. Pr\u00e9cis\u00e9ment, on donne des bornes sp\u00e9cifiques \u03bd dans\ntous ces cas qui d\u00e9pendent de la r\u00e9gularit\u00e9 de SymA (I). On donne aussi une\ninterpr\u00e9tation g\u00e9om\u00e9trique des autres facteurs possibles qui apparaissent dans\ndet((Z\u2022 )\u03bd ).\nMotiv\u00e9 par la structure homog\u00e8ne de l'anneau Cox d'une vari\u00e9t\u00e9 torique,\ngradu\u00e9e par le groupe de classes de diviseurs de T , on donne une d\u00e9finition\ng\u00e9n\u00e9rale de r\u00e9gularit\u00e9 de Castelnuovo-Mumford pour un anneau de polyn\u00f4mes\nR sur un anneau commutatif k, gradu\u00e9 par un groupe ab\u00e9lien de rang fini G,\nen termes du support de certains modules de cohomologie locale. Comme dans\nle cas standard, pour un R-module M G-gradu\u00e9 et un id\u00e9al homog\u00e8ne B de\ni (M ) avec le support de TorR (M, k).\nR, on lie le support de HB\nj\n\n5\n\n\f\fIMPLICITACI\u00d3N DE APLICACIONES RACIONALES.\nMotivados por el inter\u00e9s en el c\u00e1lculo de f\u00f3rmulas expl\u0131\u0301citas para resultantes y\ndiscriminantes que viene desde B\u00e9zout, Cayley y Sylvester en los siglos XVIII y\nXIX, y enfatizado en los \u00faltimos a\u00f1os por el aumento del poder de c\u00f3mputo, nos\nconcentramos en la implicitaci\u00f3n de hipersuperficies en diversos contextos. Por\nimplicitaci\u00f3n entendemos que, dada una aplicaci\u00f3n racional f : An\u22121 99K An ,\ncalculamos una ecuaci\u00f3n impl\u0131\u0301cita H de la clausura de la imagen im(f ). \u00c9ste es\nun problema cl\u00e1sico con numerosas aproximaciones para su soluci\u00f3n (cf. [SC95]\ny [Cox01]). A pesar de esto, el problema de implicitaci\u00f3n es computacionalmente dif\u0131\u0301cil.\nNuestro enfoque se basa en el uso de sicigias lineales mediante complejos de\naproximaci\u00f3n, siguiendo [BJ03], [BC05], y [Cha06], donde los autores desarrollan la teor\u0131\u0301a para una aplicaci\u00f3n racional f : Pn\u22121 99K Pn . Los complejos de\naproximaci\u00f3n fueron introducidos por primera vez por Herzog, Simis y Vasconcelos en [HSV83a] hace casi 30 a\u00f1os.\nLa principal obstrucci\u00f3n para este m\u00e9todo basado en complejos de aproximaci\u00f3n proviene del mal comportamiento del lugar base de f . Luego, es natural\nbuscar diferentes compactificaciones de An\u22121 , que est\u00e9n mejor adaptadas a la\naplicaci\u00f3n f , con el fin de evitar puntos base no deseados. Con este objetivo,\nen esta tesis estudiamos compactificaciones t\u00f3ricas T para An\u22121 . Primero,\nvemos a T sumergida en un espacio proyectivo. M\u00e1s a\u00fan, compactificamos\nel codominio en (P1 )n , para tratar el caso en que las funciones racionales que\ndefinen a f tengan diferentes denominadores. Tambi\u00e9n abordamos el problema\nde implicitaci\u00f3n considerando la variedad t\u00f3rica T definida por su anillo de\nCox, sin una inmersi\u00f3n proyectiva particular. En todos estos casos, explotamos el lugar base de f y aproximamos al \u00e1lgebra de Rees de este blow-up\nReesA (I), mediante el \u00e1lgebra sim\u00e9trica SymA (I). Proveemos resoluciones Z\u2022\nde ReesA (I) tales que det((Z\u2022 )\u03bd ) da un m\u00faltiplo de la ecuaci\u00f3n impl\u0131\u0301cita, para\nuna capa graduada \u03bd \u001d 0. M\u00e1s precisamente, en todos estos casos damos\ncotas para \u03bd que dependen de la regularidad de SymA (I). Tambi\u00e9n damos\nuna interpretaci\u00f3n geom\u00e9trica para los posibles factores extras que aparecen\nen det((Z\u2022 )\u03bd ).\nComenzando desde la estructura homog\u00e9nea del anillo de Cox de la variedad\nt\u00f3rica, graduado por el grupo de clases de divisores de T , damos una definici\u00f3n\ngeneral de la regularidad de Castelnuovo-Mumford para anillos de polinomios\nR sobre un anillo conmutativo k, graduado por un grupo abeliano G finitamente generado, en t\u00e9rmino de los soportes de algunos m\u00f3dulos de cohomolog\u0131\u0301a\nlocal. Tal como en el caso est\u00e1ndar, dado un R-m\u00f3dulo M G-graduado y un\ni (M ) con el soporte de\nideal homog\u00e9neo B de R, relacionamos el soporte de HB\nR\nTorj (M, k).\n\n7\n\n\f\fI would like to thank\na mi directora Alicia et \u00e0 mon directeur Marc, for all they\nhave done for me, teaching, helping, suggesting. It was\nsimultaneously a pleasure and a honor;\na mis amigos de la facultad, por acompa\u00f1arme y facilitarme el trabajo durante estos a\u00f1os, sin su ayuda este\ntrabajo no hubiera sido posible. Al resto de mis amigos,\npor su apoyo incondicional. A Ale;\n\u00e0 mes amis conus en France, car vous avez faites qu'\u00eatre\nloin de chez moi soit agreable. Avec qui j'ai bien travaill\u00e9\net amus\u00e9;\nto all mathematicians that helped me constructing what I\nhave done in this science;\nA mi familia, a mis padres y a mi hermana. A Flor.\nGracias.\n\n9\n\n\f\fIntroduction\nThe interest in computing explicit formulas for resultants and discriminants goes back to\nB\u00e9zout, Cayley, Sylvester and many others in the eighteenth and nineteenth centuries. It has\nbeen emphasized in the latest years due to the increase of computing power. Under suitable\nhypotheses, resultants give the answer to many problems in elimination theory, including\nthe implicitization of rational maps. In turn, both resultants and discriminants can be seen\nas the implicit equation of a suitable map (cf. [DFS07]). Lately, rational maps appeared\nin computer-engineering contexts, mostly applied to shape modeling using computer-aided\ndesign methods for curves and surfaces.\nRational algebraic curves and surfaces can be described in several different ways, the most\ncommon being parametric and implicit representations. Parametric representations describe\nthe geometric object as the image of a rational map, whereas implicit representations describe it as the set of points verifying a certain algebraic condition, e.g. as the zeros of a\npolynomial equation. Both representations have a wide range of applications in Computer\nAided Geometric Design (CAGD), and depending on the problem one needs to solve, one\nor the other might be better suited. It is thus interesting to be able to pass from parametric\nrepresentations to implicit equations. This is a classical problem and there are numerous\napproaches to its solution (a good historical overview on this subject can be seen in [SC95]\nand [Cox01]). However, it turns out that the implicitization problem is computationally\ndifficult.\nA promising alternative suggested in [BD07] is to compute a so-called matrix representation\ninstead, which is easier to compute but still shares some of the advantages of the implicit\nequation. Let K be a field. For a given hypersurface H \u2282 Pn , a matrix M with entries in\nthe polynomial ring K[X0 , . . . , Xn ] is called a representation matrix of H if it is generically\nof full rank and if the rank of M evaluated in a point of Pn drops if and only if the point\nlies on H (see Chapter 3, also cf. [BDD09]). Equivalently, a matrix M represents H if\nand only if the greatest common divisor of all its minors of maximal size is a power of the\nhomogeneous implicit equation F \u2208 K[X0 , . . . , Xn ] of H .\nf\n\nIn the case of a planar rational curve C given by a parametrization of the form A1 99K A2 ,\n\n11\n\n\f\u0011\n\u0010\nf2 (s)\n, where fi \u2208 K[s] are coprime polynomials of degree d and K is a field, a\ns 7\u2192 ff13 (s)\n,\n(s) f3 (s)\n(linear) syzygy (or moving line) is a linear relation on the polynomials f1 , f2 , f3 , i.e. a linear\nform L = h1 X1 + h2 XP\n2 + h3 X3 in the variables X1 , X2 , X3 and with polynomial coefficients\nhi \u2208 K[s] such that\ni=1,2,3 hi fi = 0. We denote by Syz(f ) the set of all those linear\nsyzygies forms and for any integer \u03bd the graded part Syz(f )\u03bd of syzygies of degree at most\n\u03bd. To be precise, one should homogenize the fi with respect to a new variable and consider\nSyz(f ) as a graded module here. It is obvious that Syz(f )\u03bd is a finite-dimensional K-vector\nspace of dimension kP\n= k(\u03bd), obtained by solving a linear system. Let L1 , . . . , Lk be a basis\nof Syz(f )\u03bd . If Li = |\u03b1|=\u03bd s\u03b1 Li,\u03b1 (X1 , X2 , X3 ), we define the matrix M\u03bd = (Li,\u03b1 )1\u2264i\u2264k,|\u03b1|=\u03bd ,\nthat is, the coefficients of the Li with respect to a K-basis of K[s]\u03bd form the columns of the\nmatrix. Note that the entries of this matrix are linear forms in the variables X1 , X2 , X3 with\ncoefficients in the field K. Let F denote the homogeneous implicit equation of the curve and\ndeg(f ) the degree of the parametrization as a rational map. Intuitively, deg(f ) measures\nhow many times the curve is traced. It is known that for \u03bd \u2265 d \u2212 1, the matrix M\u03bd is a\nrepresentation matrix; more precisely: if \u03bd = d \u2212 1, then M\u03bd is a square matrix, such that\ndet(M\u03bd ) = F deg(f ) . Also, if \u03bd \u2265 d, then M\u03bd is a non-square matrix with more columns than\nrows, such that the greatest common divisor of its minors of maximal size equals F deg(f ) . In\nother words, one can always represent the curve as a square matrix of linear syzygies. One\ncould now actually calculate the implicit equation. We overview this subject more widely\nin Section 1.7.1.\nFor surfaces, matrix representations have been studied in [BDD09] for the case of 2-dimensional\nprojective toric varieties, and we will analyze it in detail in Chapter 3. Previous work had\nbeen done in this direction, with two main approaches: One allows the use of quadratic\nsyzygies (or higher-order syzygies) in addition to the linear syzygies, in order to be able to\nconstruct square matrices, the other one only uses linear syzygies as in the curve case and\nobtains non-square representation matrices.\nThe first approach using linear and quadratic syzygies (or moving planes and quadrics)\nhas been treated in [Cox03a] for base-point-free homogeneous parametrizations and some\ngenericity assumptions, when T = P2 . The authors of [BCD03] also treat the case of\ntoric surfaces in the presence of base points. In [AHW05], square matrix representations of\nbihomogeneous parametrizations, i.e. T = P1 \u00d7P1 , are constructed with linear and quadratic\nsyzygies, whereas [KD06] gives such a construction for parametrizations over toric varieties\nof dimension 2. The methods using quadratic syzygies usually require additional conditions\non the parametrization and the choice of the quadratic syzygies is often not canonical.\nThe second approach, developed in more detail in Section 1.7.2, even though it does not\nproduce square matrices, has certain advantages, in particular in the sparse setting that we\n\n12\n\n\fpresent. In previous publications, this approach with linear syzygies, which relies on the\nuse of the so-called approximation complexes has been developed in the case T = Pn , see\nfor example [BJ03], [BC05], and [Cha06], and T = P1 \u00d7 P1 in [BD07] for bihomogeneous\nparametrizations of degree (d, d). However, for a given affine parametrization f , these two\nvarieties T are not necessarily the best choice of a compactification, since they do not always\nreflect well the combinatorial structure of the polynomials defining the parametrization. We\nextend the method to a much larger class of varieties, namely toric varieties of dimension 2\n(cf. [BDD09], see also 3.4). We show that it is possible to choose a \"good\" toric compactification of (A\u2217 )2 depending on the input polynomials, which makes the method applicable\nin cases where it failed over P2 or P1 \u00d7 P1 . Also, it is significantly more efficient, leading to\nsmaller representation matrices.\nLater, in [Bot10], see Chapter 3, we gave different compactifications for the domain and the\ncodomain of an affine rational map f that parametrizes a hypersurface in any dimension\nand we show that the closure of the image of this map (with possibly some other extra\nhypersurfaces) can be represented by a matrix of linear syzygies, relaxing the hypothesis on\nthe base locus. More generally, we compactify An\u22121 into an (n \u2212 1)-dimensional projective\narithmetically Cohen-Macaulay subscheme of some PN . We studied one particular interesting compactification of An\u22121 which is the toric variety associated to the Newton polytope\nof the polynomials defining f .\nIn [Bot09b] and [Bot10] we considered a different compactifications for the codomain of f ,\n(P1 )n as is detailed in Chapter 4. We study the implicitization problem in this setting. This\nnew perspective allow to deal with parametric rational maps with different denominators.\nPrecisely, given f = ( fg11 , . . . , fgnn ) : An\u22121 99K An , we can naturally consider a map \u03c6 = ((f1 :\ng1 ) \u00d7 * * * (fn : gn )) : Pn\u22121 99K (P1 )n (cf. [Bot09b]). As we have remarked before, Pn\u22121 need\nnot be the best compactification of the domain of f , thus, in [Bot10] we extended this\nmethod the setting \u03c6 : T 99K (P1 )n where T is any arithmetically Cohen-Macaulay closed\nsubscheme of some PN . In this last context, we gave sufficient conditions, in terms of the\nnature of the base locus of the map, for getting a matrix representation of its closed image,\nwithout involving extra hypersurfaces (cf. Chapter 4).\nIn order to avoid a particular embedding of T in PN , we focused on the study of implicitization problem for toric varieties given by its Cox ring (see Section 2.4 or [Cox95]). This\nleaded to adapting the technique based on approximation complexes for more general graded\nrings and modules. In Chapter 6 we give a definition of Castelnuovo-Mumford regularity\nfor a commutative ring R graded by a finitely generated abelian group G, in terms of the\nsupport of some local cohomology modules. A very interesting example is that of Cox rings\nof toric varieties, where the grading is given by the Chow group of the variety acting on a\n\n13\n\n\fpolynomial ring. Thus, this allows to study the implicitization problem for general arithmetically Cohen Macaulay toric varieties without the need of an embedding, as we do in\nChapter 7.\n\n14\n\n\fOrganization\nCh. 1: Preliminaries on elimination theory and approximation complexes.\nCh. 2: Preliminaries on toric varieties.\nCh. 3: Implicitization for \u03c6 : T 99K Pn , by means of an embedding T \u2282 PN .\nCh. 4: Implicitization for \u03c6 : T 99K (P1 )n , by means of an embedding T \u2282 PN .\nCh. 5: Algorithmic approach for Chapters 3 and 4, and examples.\nCh. 6: Castelnuovo-Mumford regularity for G-graded rings, for G abelian group.\nCh. 7: Implicitization for \u03c6 : T 99K Pn , where T is defined by the Cox ring.\nCh. 8: Algorithm for \u03c6 : T 99K P3 following Chapter 3.\nCh. 9: Algorithm for \u03c6 : T 99K P3 following Chapter 7.\n\nChapter 1\n\nChapter 3\n\nChapter 2\n\nChapter 4\n\nChapter 6\n\nChapter 5\n\nChapter 7\n\nChapter 8\n\nChapter 9\n\nIn Chapter 1 we give a fast overview of the original technique of computing implicit equations\nfor projective rational maps by means of approximation complexes. Indeed, we introduce\nin Section 1.5 the notion of approximation complexes and of blow-up algebras in Section\n1.3, and we give basic results that we will use later in this thesis. As it was mentioned,\nthis approach with linear syzygies was first formulated for this purpose in [BJ03] an later\n\n15\n\n\fimproved in [BC05], [Cha06] and [BCJ09]. We give a more detailed outline of this method\nin Section 1.7.2.\nChapter 2 is mainly devoted to give an introduction to toric varieties. We recall some\nresults that we will need later, in order to generalize the implicitization methods for toric\ncompactifications. We develop this idea in Chapters 3, 4 and 7.\nIn Chapters 3 and 4 we adapt the method of approximation complexes to computing an\nimplicit equation of a parametrized hypersurface, focusing on different compactifications of\nthe domain T and of the codomain (Pn and (P1 )n ). We will always assume that T is a\n(n\u22121)-dimensional closed subscheme of PN with graded and Cohen-Macaulay n-dimensional\ncoordinate ring A.\nIn Chapter 3, we focus on the implicitization problem for a rational map \u03c6 : T 99K Pn\ndefined by n + 1 polynomials of degree d. We extend the method to maps defined over an\n(n \u2212 1)-dimensional Cohen-Macaulay closed scheme T , embedded in PN , emphasizing the\ncase where T is a toric variety. We show that we can relax the hypotheses on the base\nlocus by admitting it to be a zero-dimensional almost locally complete intersection scheme.\nImplicitization in codimension one is well adapted in this case, as is shown in Section 3.2 and\n3.3, following the spirit of many papers in this subject: [BJ03], [BCJ09], [BD07], [BDD09]\nand [Bot09b].\nIn order to consider more general parametrizations given by rational maps of the form\nf = ( fg11 , . . . , fgnn ) with different denominators g1 , . . . , gn , we develop in Chapter 4 the study\nof the (P1 )n compactification of the codomain. With this approach, we study following\n[Bot09b] and [Bot10], the method of implicitization of projective hypersurfaces embedded\nin (P1 )n . As in Chapters 1 and 3, we compute the implicit equation as the determinant of\na complex which coincides with the gcd of the maximal minors of the last matrix of the\ncomplex, and we make deep analysis of the geometry of the base locus.\nIn Chapter 5 we exemplify the results of Chapters 3 and 4, and we study in a more combinatorial fashion the size of the matrices obtained. We analyze, in both settings, how taking\nan homothety of the Newton polytope N (f ) can modify the size of the matrices M\u03bd . We\npresent several examples comparing our results with the previous ones. First, we show in a\nvery sparse setting the advantage of not considering the homogeneous compactification of\nthe domain when denominators are very different. We extend in the second example this\nidea to the case of a generic affine rational map in dimension 2 with fixed Newton polytope. In the last example we give, for a parametrized toric hypersurface of (P1 )n , a detailed\nanalysis of the relation between the nature of the base locus of a map and the extra factors\n\n16\n\n\fappearing in the computed equation. We finish this section by giving an example of how\nthe developed technique can be applied to the computation of sparse discriminants.\nIn order to avoid a particular embedding of T in PN , we focus in Chapter 7 on the study\nof the implicitization problem for toric varieties given by its Cox ring (see Section 2.4 or\nthe original source in [Cox95]). Motivated by this, in Chapter 6 we give a definition of\nCastelnuovo-Mumford regularity for a commutative ring R graded by a finitely generated\nabelian group G, in terms of the support of some local cohomology modules.\nIn Chapter 6 we give a definition of Castelnuovo-Mumford regularity for a commutative\nring R graded by a finitely generated abelian group G, in terms of the support of some\nlocal cohomology modules. This generalizes [HW04] and [MS04]. With this purpose, we\ndistinguish an ideal B of R, and we determine subsets of G where the G-graded modules\nHBi (R) are supported, this is, elements \u03b3 \u2208 G where HBi (R)\u03b3 6= 0. Also, we study the\nregularity of some particular rings, in particular, polynomial rings Zn -graded, and we show\nthat in these cases this notion of regularity coincides with the usual one. A very interesting\nexample is that of Cox rings of toric varieties, where the grading is given by the Chow group\nof the variety acting on a polynomial ring (cf. [Cox95]).\nLately, we establish, for a G-graded R-module M , a relation between the supports of the\nmodules HBi (M ) and the support of the Betti numbers of M , generalizing the well-known\nduality for the Z-graded case.\nIn Chapter 7 we present a method for computing the implicit equation of a hypersurface\ngiven as the image of a rational map \u03c6 : T 99K Pn , where T is an arithmetically CohenMacaulay toric variety defined by its Cox ring (see Section 2.4). In Chapters 3 and 4,\nthe approach consisted in embedding the space T in a projective space. The need of this\nembedding comes from the necessity of a Z-grading in the coordinate ring of T , in order to\nstudy its regularity. The aim of this chapter is to give an alternative to this approach: we\nstudy the implicitization problem directly, without an embedding in a projective space, by\nmeans of the results of Chapter 6. Indeed, we deal with the multihomogeneous structure\nof the coordinate ring S of T , and we adapt the method developed in Chapters 1, 3\nand 4 to this setting. The main motivations for our change of perspective are that it is\nmore natural to deal with the original grading on T , and that the embedding leads to\nan artificial homogenization process that makes the effective computation slower, as the\nnumber of variables to eliminate increases.\nChapter 8 and Chapter 9 are devoted to the algorithmic approach of both cases studied\nin Chapters 3 and 7. We show how to compute the sizes of the representation matrices\n\n17\n\n\fobtained in both cases by means of the Hilbert functions of the coordinate ring A and of its\nKoszul cycles.\n\n18\n\n\fContents\n1 Preliminaries on elimination theory\n1.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.2 The image of a rational map as a scheme . . . . . . . . . . .\n1.3 Blow-up algebras . . . . . . . . . . . . . . . . . . . . . . . .\n1.3.1 Rees algebras and symmetric algebras of an ideal . .\n1.3.2 d-sequences . . . . . . . . . . . . . . . . . . . . . . .\n1.4 Rees and Symmetric algebras of a rational map . . . . . . .\n1.5 Approximation complexes . . . . . . . . . . . . . . . . . . .\n1.6 Acyclicity of approximation complexes . . . . . . . . . . . .\n1.7 Implicitization . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.7.1 Moving curves and moving surfaces . . . . . . . . . .\n1.7.2 Implicitization by means of approximation complexes\n2 Preliminaries on toric varieties\n2.1 Divisors on toric varieties . . . . . . . . .\n2.2 Ample sheaves and support functions . .\n2.3 Projective toric varieties from a polytope\n2.4 The Cox ring of a toric variety . . . . . .\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n\n23\n23\n24\n27\n28\n29\n30\n31\n35\n36\n37\n41\n\n.\n.\n.\n.\n\n47\n47\n49\n51\n52\n\n3 Implicit equations of Toric hypersurfaces in projective space by means of an\nembedding\n3.1 Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n3.2 General setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n3.3 The implicitization problem . . . . . . . . . . . . . . . . . . . . . . . . . . .\n3.3.1 Homological algebra tools . . . . . . . . . . . . . . . . . . . . . . . .\n3.3.2 The representation matrix, the implicit equation, and the extraneous\nfactor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n3.4 The representation matrix for toric surfaces . . . . . . . . . . . . . . . . . .\n3.5 The special case of biprojective surfaces . . . . . . . . . . . . . . . . . . . . .\n3.6 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n55\n55\n56\n58\n60\n64\n66\n67\n70\n\n19\n\n\f3.7\n\nFinal remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n4 Implicit equations of toric hypersurfaces in multiprojective space\n4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n4.2 General setting . . . . . . . . . . . . . . . . . . . . . . . . . . .\n4.3 Tools from homological algebra . . . . . . . . . . . . . . . . . .\n4.4 The implicitization problem . . . . . . . . . . . . . . . . . . . .\n4.4.1 The implicit equation . . . . . . . . . . . . . . . . . . . .\n4.4.2 Analysis of the extraneous factors . . . . . . . . . . . . .\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n76\n\n.\n.\n.\n.\n.\n.\n\n79\n79\n80\n81\n85\n86\n88\n\n5 The algorithmic approach\n5.1 Hilbert and Ehrhart functions . . . . . . . . . . . . . . .\n5.2 Examples . . . . . . . . . . . . . . . . . . . . . . . . . .\n5.2.1 Implicit equations of dimension 2 and 3 . . . . . .\n5.2.2 The generic case . . . . . . . . . . . . . . . . . .\n5.2.3 A few example with artificial compactifications . .\n5.3 Applications to the computation of sparse discriminants .\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n95\n95\n97\n98\n102\n105\n109\n\n6 G-graded Castelnuovo Mumford Regularity\n6.1 Introduction. . . . . . . . . . . . . . . . . . . . . .\n6.2 Local Cohomology and graded Betti numbers . . .\n6.2.1 From Local Cohomology to Betti numbers .\n6.2.2 From Betti numbers to Local Cohomology .\n6.3 Castelnuovo-Mumford regularity . . . . . . . . . . .\n6.3.1 Regularity for Local Cohomology modules .\n6.4 Local cohomology of multigraded polynomial rings .\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n113\n113\n116\n118\n119\n121\n122\n125\n\n.\n.\n.\n.\n.\n.\n.\n\n131\n131\n132\n132\n135\n138\n141\n143\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n7 Implicit equation of multigraded hypersurfaces\n7.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n7.2 Commutative algebra tools . . . . . . . . . . . . . . . . . . . . .\n7.2.1 Regularity for commutative G-graded rings . . . . . . .\n7.2.2 G-graded polynomial rings and approximation complexes\n7.3 The implicitization of toric hypersurfaces . . . . . . . . . . . . .\n7.4 Multiprojective spaces and multigraded polynomial rings . . . .\n7.5 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n8 Algorithm1\n149\n8.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149\n8.2 Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151\n\n20\n\n\f8.3\n\nImplementation in Macaulay2 . . . . . . . . . . . . . . . . . . . . . . . . . . 153\n\n9 Algorithm2\n161\n9.1 Implementation in Macaulay2 . . . . . . . . . . . . . . . . . . . . . . . . . . 161\n9.1.1 Example 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161\n\n21\n\n\f\f1 Preliminaries on elimination theory\n1.1 Introduction\nIn this chapter we give a short summary of the articles written by Laurent Bus\u00e9, Marc\nChardin and Jean-Pierre Jouanolou on implicitization of projective hypersurfaces by means\nof approximation complexes [BJ03, BC05, Cha06, BCJ09]. There are many branches on\nmathematics and computer sciences where implicit equations of hypersurfaces are used and,\nhence, implicitization problems are involved. One of them is the interest in computer aided\ndesign (cf. [Hof89, GK03]).\nIn the beginning of the 80's, Hurgen Herzog, Aron Simis and Wolmer V. Vasconcelos developed the so called Approximation Complexes (cf. [HSV82, HSV83b, Vas94a]) for studying\nthe syzygies of the conormal module (cf. [SV81]).\nIn elimination theory approximation complexes were used for the first time by Laurent Bus\u00e9\nand Jean-Pierre Jouanolou in 2003 in order to propose a new alternative to the previous\nmethods (see [BJ03]). This new tool generalized the work of Sederberg and Cheng, on\n\"moving lines\" and \"moving surfaces\" introduced a few years before in [SC95, CSC98,\nZSCC03], giving also a theoretical framework.\nThe spirit behind the method based on approximation complexes consists in doing elimination theory by taking determinant of a graded strand of a complex. This idea is similar to\nthe one used for the computation of a Macaulay resultant of n homogeneous polynomials\nF1 , . . . , Fn in n variables, by means of taking determinant of a graded branch of a Koszul\ncomplex.\nThis resultant spans the annihilator of the quotient ring of A[X1 , . . . , Xn ] by I = (F1 , . . . , Fn )\nin big enough degree (bigger than its regularity). This annihilator can also be related to\nthe MacRae invariant of the coordinate ring A[X1 , . . . , Xn ]/I in the same degree \u03bd. This\ntheoretical method can become effective through the computation of the determinant of\nthe degree-\u03bd-strand of the Koszul complex of {F1 , . . . , Fn } (see [Nor76, Mac65, GKZ94,\nKM76]).\n\n23\n\n\fIn this case, we wish to give a closed formula for the implicit equation of the image of a\nrational map \u03c6 : Pn\u22122 99K Pn\u22121 , over a field K. We will assume at first that this image\ndefines a hypersurface in Pn\u22121 , and hence, \u03c6 is generically finite.\nIt is well known that a map between schemes gives rise to a map of rings that we will denote\nby h : K[T1 , . . . , Tn ] \u2192 A := K[X1 , . . . , Xn\u22121 ]. We will focus on computing the kernel of\nthis map h which is a principal prime ideal of the polynomial ring K[T1 , . . . , Tn ], and hence\nit describes the closed image of \u03c6.\n\n1.2 The image of a rational map as a scheme\nWe will describe henceforward in this chapter how to compute the implicit equation of the\nclosed image of a rational map \u03c6 : Pn\u22122 99K Pn\u22121 following the ideas of L. Bus\u00e9, M. Chardin\nand J.-P. Jouanolou. Let K be a commutative ring and A a Z-graded K-algebra. We will\nassume that \u03c6 = (f1 , . . . , fn ), where the polynomials fi \u2208 A are homogeneous of the same\ndegree d for all i = 1, . . . n. Let h be a morphism of graded K-algebras defined by\nh : K[T1 , . . . , Tn ] \u2192 A,\n\nTi 7\u2192 fi .\n\nThe map h induces a morphism of K-affine schemes\n[\n[\n\u03bc:\nD(fi ) \u2192\nD(Ti ) = AnK \\ {0},\n\n(1.1)\n\n(1.2)\n\nwhere D(fi ) := {p \u2208 Spec(A) : fi \u2208\n/ p} is an open set of Spec(A).\nAlso, given {fi }i=1,...n homogeneous of degree d, h is a graded morphism of graded algebras\n(where the grading is given by deg(Ti ) = 1 for all i = 1 . . . , n). Hence, h induces a morphism\nof K-projective schemes\n[\n[\n\u03c6:\nD+ (fi ) \u2192\nD+ (Ti ) = Pn\u22121\n(1.3)\nK ,\nwhere D+ (fi ) := {p \u2208 Proj(A) : fi \u2208\n/ p} is an open set of Proj(A).\nS\nS\nDenote by D(f) :=\nD(fi ) and D+ (f) :=\nD+ (fi ), the sets of definition of \u03bc and \u03c6\nrespectively, also D(f) = Spec(A) \\ V (f1 , . . . , fn ) and D+ (f) = Proj(A) \\ V (f1 , . . . , fn ).\nBefore getting into the results, we give some notations.\n\n24\n\n\fDefinition 1.2.1. We will denote by R the polynomial ring K[T1 , . . . , Tn ], and let I and J\nbe ideals of R and M an R-module. Define\n1. ann(J) = {f \u2208 R : f * J = 0}, the annihilator of J;\n2. (I :R J) = {f \u2208 R : f * J \u2282 I}, the colon ideal of I by J;\nS\n3. (I :R J \u221e ) = n\u2208N (I :R J n ), the saturation of I by J, also written T FJ (I);\n4. HJ0 (M ) = {m \u2208 M : m * J n = 0, \u2200n \u001d 0}, the 0-th local cohomology group of M with\nsupport on J.\nTheorem 1.2.2 ([BJ03, Thm 2.1]). Let I and J be the affine and projective sheafification\nof ker(h). We have that\nV (I )|AnK \\{0} = V (ker(h)\u223c )|AnK \\{0} = V ((ker(h) : (T1 , . . . , Tn )\u221e )\u223c )|AnK \\{0}\nand similarly with V (J ).\nLemma 1.2.3 ([BJ03, Rem 2.2]). We have\n0\nT F(T1 ,...,Tn ) (ker(h)) = {p \u2208 A[T1 , . . . , Tn ] : p(f1 , . . . , fn ) \u2208 H(f\n(A)}.\n1 ,...,fn )\n0\n(A) = 0, ker(h) = T F(T1 ,...,Tn ) (ker(h)); this means that ker(h)\nIn particular, when H(f\n1 ,...,fn )\nis saturated with respect to (T1 , . . . , Tn ) in K[T1 , . . . , Tn ].\n\nRecall that if I and J = (g1 , . . . , gs ) are ideals of R, then (I :R J \u221e ), is defined as\nJ m ) = {f \u2208 R : \u2203m \u2208 N, f.(g1 , . . . , gs )n \u2282 I}. We have that\n\nS\n\nm\u2208N (I :R\n\nRemark 1.2.4.\n(I :R J \u221e ) = {f \u2208 R : \u2203m \u2208 N, f.gim \u2208 I \u2200i}.\nPs\nm\nm\nm\n)\n\u2282\nJ\nand\nif\nf\n\u2208\nJ,\nf\n=\nThis is due to\nthe\nfact\nthat\n(g\n,\n.\n.\n.\n,\ng\n1\ns\ni=1 \u03b1j gj . Thus,\nPs\nP\ni1\nm(s\u22121)+1\nm(s\u22121)+1\nis\nP\nf\n= ( i=1 \u03b1i gi )\n=\nij =m(s\u22121)+1 \u03b1(i1 ,...,is ) g1 * * * gs that clearly belongs to\nm\nm\nm(s\u22121)+1\nm\n(g1 , . . . , gs ). Hence, J\n\u2282 (g1 , . . . , gsm ).\nRecall that \u03c6 : Proj(A) \u2192 Pn\u22121\nis the map induced by\nK\n\nh : K[T1 , . . . , Tn ] \u2192 A.\nLet U := D+ (f) be the open subscheme of definition of \u03c6, and Z := V (f1 , . . . , fn ) be the\nclosed subscheme of Proj(A) where the sections f1 , . . . , fn vanish. We will blowup Proj(A)\nalong Z.\n\n25\n\n\fWe will denote by \u03c01 and \u03c02 the two natural projections,\n\u001f\nBlI (Proj(A))\nN\n\n\u007f\n\n/ Proj(A) \u00d7\n\nK\n\nNNN\nNN\u03c0N2\n\u03c01\nNNN\nNN'\n\u000f\n\u03c6\n_\n_\n_\n_\n_/ Pn\u22121\nProj(A)\n\nn\u22121\nPK\n= Pn\u22121\nA\n\nK\n\n\u03c01\u22121 (U )\n\ncoincides with \u03c6 \u25e6 \u03c01 .\nP\nDefinition 1.2.5. Let ReesA (I) := i\u22650 I i ti be the Rees algebra of I = (f1 , . . . , fn ). Let\nA[T1 , . . . , Tn ] \u2192 A[t] be the map of A-algebras defined by Ti 7\u2192 fi t, in such a way that\ndeg(Ti ) = (1, 0) and deg(fi ) = (0, d), hence t is of total degree 1 \u2212 d.\nThe restriction of \u03c02 to \u03a9 :=\n\nThus, there is a short exact sequence 0 \u2192 J \u2192 A[T1 , . . . , Tn ] \u2192 ReesA (I) \u2192 0, where\nA[T1 ,...,Tn ]\nJ = ker(A[T1 , . . . , Tn ] \u2192 A[t]), namely, ReesA (I) \u223c\n.\n=\nJ\nProposition 1.2.6. The following diagram is commutative\n\u03a9 HH\n\nHH\nHH\u03c02\nHH\nHH\n#\n\u000f\n\u03c6\n/ Pn\u22121\nD+ (f)\n\n\u03c0 1 |\u03a9\n\nK\n\n\u22121\n\nwhere D+ (f) \u2282 Proj(A), \u03a9 := \u03c0 (D+ (f)) \u2282 BlI (Proj(A)) and \u03c01 |\u03a9 corresponds to the\nrestriction of \u03c0 : BlI (Proj(A)) \u2192 Proj(A) to the open set \u03a9.\nOne important difficulty is the deep understanding of the difference between I and J. We\nwill give a short example to illustrate this relation.\nExample 1.2.7. Let A be a commutative noetherian ring, f, g \u2208 A and ReesA (f, g) =\nA[f t, gt] \u2282 A[t].\n\nInvert f and define B = A[f \u22121 ][X, Y ]. Let X 0 = f \u22121 X \u2208 B and hence we get B =\nA[f \u22121 ][X 0 , Y ]. The element gX 0 \u2212 Y \u2208 B spans ker(B = A[f \u22121 ][X 0 , Y ] \u2192 A[f \u22121 ][t]),\ndefined as X 0 7\u2192 t and Y 7\u2192 gt. Since B, gX \u2212 f Y and gX 0 \u2212 Y coincide, f is not a zero\ndivisor modulo gX \u2212 f Y in A[X, Y ]. We see that (f, gX \u2212 f Y ) is a regular sequence in\nA[X, Y ]. Hence, the complex\nK\u2022 (gX \u2212 f Y, f ) : 0\n\n/A\n\n(\u2212f,gX\u2212f Y )\n\n/ A2\n\n(gX\u2212f Y,f )t\n\n/A\n\n/0\n\nis acyclic. Thus the first homology group of K\u2022 (gX \u2212 f Y, f ), (f : gX \u2212 f Y )/(f ), vanishes.\nHence, if (f, g) is a regular sequence, then the kernel of the map A[X, Y ] \u2192 ReesA (f, g) defined by X 7\u2192 f t and Y 7\u2192 gt is spanned by gX \u2212f Y . That is ReesA (f, g) \u223c\n= A[X, Y ]/(gX \u2212\nf Y ).\n\n26\n\n\fWe conclude that if I is spanned by a regular sequence (of length 2), then the Rees algebra\nReesA (I) is isomorphic to the symmetric algebra SymA (I), defined as\nSymA (I) =\n\nM\nn\u22650\n\nI \u2297n /(x \u2297 y \u2212 y \u2297 x)x,y\u2208I .\n\nThis can be generalized to a sequence (f1 , . . . , fn ) of length n. In the general case we get\nthat the ideal of relations J is spanned by the 2 \u00d7 2-minors of\n\u0012\n\u0013\nf1 * * * fn\n.\nT1 * * * Tn\nWe will deepen our understanding of the relationship between the symmetric algebra and\nthe Rees algebra in the following section. We will also see that in the particular context\nof implicitization theory applied to rational maps defined over a projective scheme, this\nsituation is never reached. Precisely, we cannot hope that the symmetric algebra and the\nRees algebra coincide, we can at most ask when they coincide modulo their torsion at the\nmaximal ideal m = (X1 , . . . , Xn ).\n\n1.3 Blow-up algebras\nHenceforward let K be an infinite integral domain with unity and let A be a commutative\nN-graded K-algebra. Take I = (f1 , . . . , fn ) an homogeneous ideal of A, where fi is an\nhomogeneous element of degree d. We will write I n for the usual multiplication of n elements\nof I for n \u2265 0, and I 0 := A. Denote I \u2297n := I \u2297A * * * \u2297A I n times for n \u2265 0, where I \u22970 := A.\nIn this part we will study presentations for the algebras ReesA (I) and gr, and the relation\nwith the symmetric algebras SymA (I) and SymA/I (I/I 2 ). All these algebras\nL\n1. ReesA (I) = n\u22650 I n ;\nL\n2. SymA (I) = n\u22650 I \u2297n /(x \u2297 y \u2212 y \u2297 x)x,y\u2208I ;\nL\n3. grA (I) = n\u22650 I n /I n+1 \u223c\n= A/I \u2297A ReesA (I);\nL\n4. SymA/I (I/I 2 ) = n\u22650 (I/I 2 )\u2297n /(x \u2297 y \u2212 y \u2297 x)x,y\u2208I \u223c\n= A/I \u2297A SymA (I).\nare called blow-up algebras, because they are closely related to the blow-up of a ring along\nan ideal.\n\n27\n\n\f1.3.1 Rees algebras and symmetric algebras of an ideal\nThe first idea for giving equations to describe the Rees algebra ReesA (I), is by means of\nthe linear syzygies of I = (f1 , . . . , fn ). Precisely, there is a presentation homogeneous ideal\nJ = J1 + J2 + * * * which represents the equations of ReesA (I), where Jr is the module\nspanned by the syzygies of r-products of f1 , . . . , fn .\n\u000f\n\nAssume\nI is of finite presentation 0 \u2192 Z \u2192 An \u2192 I \u2192 0, where Z = {(a1 , . . . , an ) :\nP\nai fi = 0} is the module of syzygies of I.\nThe map \u000f, induces a surjective morphism \u03b1 : A[T1 , . . . , Tn ] \u2192 SymA (I), defined in degree\n1 by \u03b1(Ti ) = fi . Denote J 0 := ker(\u03b1). Then, there is a presentation for SymA (I):\n\u03b1\n\n0 \u2192 J 0 \u2192 A[T1 , . . . , Tn ] \u2192 SymA (I) \u2192 0.\nIt can be shown that the ideal J 0 is generated by the linear form\n0,\n\nP\n\ni\n\n(1.4)\nai Ti such that\n\nP\n\ni\n\nai f i =\n\nConsider now the following presentation of the Rees algebra:\n\u03b2\n\n0 \u2192 J \u2192 A[T1 , . . . , Tn ] \u2192 ReesA (I) \u2192 0,\n\n(1.5)\n\nwhere the map \u03b2 : A[T1 , . . . , Tn ] \u2192 ReesA (I) is A-linear and defined by \u03b2(Ti ) = fi . Clearly\nthe ideal J is an homogeneous\nideal and P\nits component of degree 1 is J1 , which is the\nP\nA-module of linear forms\nai Ti such that\nai fi = 0. Thus J 0 is spanned by J1 .\nClosely related to this presentation of ReesA (I) there is one for the associated graded ring of\nI, grA (I), coming from the I-adic filtration * * * \u2282 I n+1 \u2282 I n \u2282 * * * \u2282 I 2 \u2282 I in A. Namely,\nsince ReesA (I) \u223c\n= A[T1 , . . . , Tn ]/J, there is an exact sequence\n0 \u2192 J + I \u2192 A[T1 , . . . , Tn ] \u2192 grA (I) \u2192 0.\n\n(1.6)\n\nWe describe J in terms of a presentation of I.\nWhen I is generated by a regular sequence {f1 , . . . , fn }, the Rees algebra coincides with the\n0\nsymmetric\nalgebra, and\n\u0012\n\u0013 the ideals J and J are spanned by the 2 \u00d7 2-minors of the matrix\nf1 * * * fn\nM=\n.\nT1 * * * Tn\nLet S be a polynomial ring I 0 an ideal of S, and take A = S/I 0 . Let I be an ideal of A. It\nis shown in [Vas94a] that\n\n28\n\n\fProposition 1.3.1. Let f1 , . . . , fn \u2208 S be n homogeneous polynomials of the same degree\nthat span I. Consider S[T1 , . . . , Tn ]. Then ReesA (I) \u223c\n= S[T1 , . . . , Tn ]/J, where J = (T1 \u2212\n0\n\u223c\nf1 t, . . . , Tn \u2212 fn t, I ) \u2229 S[T1 , . . . , Tn ] and grA (I) = S[T1 , . . . , Tn ]/(f1 , . . . , fn , J).\nP\nP\n0\nIt is a well known fact that J 0 = ( ai TP\ngi Ti , :\ni : (a1 , . . . , an ) \u2208 Z),. Explicitly, J = {\ngi = gi (T1 , . . . , Tn ) \u2208 A[T1 , . . . , Tn ], and\ngi (T1 , . . . , Tn )fi = 0}.\nDefinition 1.3.2. The relation type of I is the smallest integer s such that J = (J1 , . . . , Js ).\nThis number is independent of the generators chosen for I (cf. [Vas94a]). When s = 1, we\nsay that I is of linear type.\nObserve that since ReesA (I) is a commutative A-algebra, there exists a surjective map\n\u03c3 : SymA (I) \u2192 ReesA (I), given by \u03b2m : I \u2297m \u2192 I m defined as fi1 \u2297 * * * \u2297 fim 7\u2192 fi1 * * * fim .\nFrom the presentations of (1.4) and (1.5) for SymA (I) and ReesA (I) respectively we have\nthe following diagram:\n0\n0\n\n/J0\n\n\u001f\u007f\n= (J\n\u007f _ 1)\n\u000f \u007f\n/J \u001f\n\n/ A[T1 , . . . , Tn ] \u03b1\n\n/ Sym\n\n\u03b2\n\n\u000f\u000f\n\n/ A[T1 , . . . , Tn ]\n\nA (I)\n\n/0\n\n\u03c3\n\n/ ReesA (I)\n\n/0\n\nDenote by K := ker(\u03c3), hence K = J/J 0 , and K = 0 iff I is of linear type, equivalently, \u03c3\nis an isomorphism between ReesA (I) and SymA (I).\n\n1.3.2 d-sequences\nDefinition 1.3.3. Let x = {x1 , . . . , xn } be a sequence of elements of a ring A, let I =\n(x1 , . . . , xn ) be an ideal of A. We say that x is a:\n1. regular sequence in M , where M is an A-module, if:\na) (x1 , . . . , xn )M 6= M ;\nb) for all i = 1, . . . , n, xi is not a zero divisor in M/(x1 , . . . , xi\u22121 )M .\n2. d-sequence if:\na) x is a minimal system of generators of I;\nb) ((x1 , . . . , xi ) : xi+1 xk ) = ((x1 , . . . , xi ) : xk ) for all i = 1, . . . , n \u2212 1 and k \u2265 i + 1.\n\n29\n\n\f3. relative regular sequence if ((x1 , . . . , xi ) : xi+1 )\u2229I = (x1 , . . . , xi ) for all i = 1, . . . , n\u22121.\n4. proper sequence if xi+1 Hj (x1 , . . . , xi ; A) = 0 for all i = 1, . . . , n \u2212 1, j > 0, where\nHj (x1 , . . . , xi ; A) denote the j-th module of Koszul homology associated to the sequence {x1 , . . . , xi }.\nThese conditions are related in the following way:\nregular sequence \u21d2 d-sequence \u21d2 relative regular sequence \u21d2 proper sequence.\nLemma 1.3.4. Every ideal generated by a d-sequence is of linear type.\nProof. See [Vas94a].\n\n1.4 Rees and Symmetric algebras of a rational map\nAssume we have a rational map \u03c6 : Pn\u22122 99K Pn\u22121 defined by homogeneous polynomials\n{fi }i=1,...n of degree d. Let K be a commutative ring and A a Z-graded K-algebra. Denote\nby \u03b9 the map that sends K in A0 . The map \u03c6 defines a morphism of K-algebras h :\nK[T1S\n, . . . , Tn ] \u2192 S\nA, that maps Ti 7\u2192 fi . This map defines a morphism of affine\nS schemes\nn\n\u03bc : D(fi ) \u2192 D(Ti ) = AK \u2212 {0} and a map of projective schemes \u03c6 : D+ (fi ) \u2192\nS\nD+ (Ti ) = Pn\u22121\nK .\nWe have mentioned that \u03c6 also defines a graded map of A-algebras defined by Ti 7\u2192 fi * t,\nA[T1 ,...,Tn ]\n. The\ndefining the Rees algebra as a quotient of a polynomial ring: ReesA (I) \u223c\n=\nJ\nideal J can be described as J = (T1 \u2212 f1 * t, . . . , Tn \u2212 fn * t) \u2229 A[T1 , . . . , Tn ], using Proposition\n1.3.1.\nConsider the extended Rees algebra ReesA[t\u22121 ] (I) as a sub-A-algebra of A[t, t\u22121 ]. Denote\nu := t\u22121 , hence, \u03b7 : A[T1 , . . . , Tn , u] \u2192 A[u, u\u22121 ] is defined Ti 7\u2192 fi * u\u22121 .\n\nLemma 1.4.1. If J = (T1 \u2212 f1 * t, . . . , Tn \u2212 fn * t) \u2229 A[T1 , . . . , Tn ], then J = ((T1 u \u2212\nf1 , . . . , Tn u \u2212 fn ) : u\u221e ) \u2229 A[T1 , . . . , Tn ].\nIt can be seen that the kernel of the map h : K[T1 , . . . , Tn ] \u2192 A defined in (1.1) is given\nby\nker(h) = \u000f\u22121 ((T1 \u2212 f1 , . . . , Tn \u2212 fn )) = {g \u2208 K[T1 , . . . , Tn ] : g(f1 , . . . , fn ) = 0}.\n\n(1.7)\n\nWriting with i the inclusion map A[T1 , . . . , Tn ] ,\u2192 A[T1 , . . . , Tn , u] and by \u03b8 = i \u25e6 \u000f the\ncomposition, we have a description of ker(h)\n\n30\n\n\fLemma 1.4.2. ker(h) = \u03b8\u22121 ((T1 u \u2212 f1 , . . . , Tn u \u2212 fn ) : u\u221e ).\nIn [BJ03], the authors also proved that\nRemark 1.4.3. If K \u2282 A0 then ker(h) = ((T1 u \u2212 f1 , . . . , Tn u \u2212 fn ) : u\u221e ) \u2229 K[T1 , . . . , Tn ].\nMoreover, if K = A0 , deg(Ti ) = 0 and deg(t) = d \u2265 1, then K[T1 , . . . , Tn ] = (A[T1 , . . . , Tn , u])0\nand hence, ker(h) = ((T1 u \u2212 f1 , . . . , Tn u \u2212 fn ) : u\u221e )0 .\nNow, we can compute ker(h) from ker(\u03b2), defined in (1.5).\nProposition 1.4.4. Assume \u03b9 : K \u2192 A is the inclusion, then ker(h) = ker(\u03b2)\u2229K[T1 , . . . , Tn ] =\n((T1 u \u2212 f1 , . . . , Tn u \u2212 fn ) : u\u221e ) \u2229 K[T1 , . . . , Tn ]. Moreover if I 0 is an ideal of A such\nthat HI00 (A) = 0, then ker(\u03b2) = (ker(\u03b2) : (I 0 )\u221e ) and hence ker(h) = (ker(\u03b2) : (I 0 )\u221e ) \u2229\nK[T1 , . . . , Tn ].\n\n1.5 Approximation complexes\nApproximation complexes were defined by Herzog, Simis and Vasconcelos in [HSV83a] almost 30 years ago. We will give here a brief outline on these complexes and some of their\nbasic properties.\nConsider the two Koszul complexes over the ring A = K[X1 , . . . , Xn ] associated to the\nsequences f1 , . . . , fn and T1 , . . . , Tn respectively.\nK\u2022 (f1 , . . . , fn ; A[T1 , . . . , Tn ]) :\n\n*** \u2192\n\n1\n^\n\ndf\n\nA[T1 , . . . , Tn ]n \u2192 A[T1 , . . . , Tn ]\n\nthat will be denoted by K\u2022 (f; A[T]), and\nK\u2022 (T1 , . . . , Tn ; A[T1 , . . . , Tn ]) :\n\n*** \u2192\n\n1\n^\n\nd\n\nT\nA[T1 , . . . , Tn ]n \u2192\nA[T1 , . . . , Tn ]\n\nthat will be denoted by L\u2022 meaning K\u2022 (T; A[T]).\nIt is easy to verify that df \u25e6 dT \u2212 dT \u25e6 df = 0 giving rise to a double complex K\u2022\u2022 (f, T; A[T]).\nIn particular, dT induces a morphism between the cycles Zi , boundaries Bi and homologies\nHi of K\u2022 (f; A[T]). The complexes obtained having as objects, the cycles Zi , boundaries Bi\nand homologies Hi of K\u2022 (f; A[T]) with the induced differentials dt are called approximation\n\n31\n\n\fcomplexes of cycles, boundaries and homologies respectively, and denoted by Z\u2022 , B\u2022 , M\u2022\nrespectively.\nIt is easy to verify that H0 (Z\u2022 ) = A[T1 , . . . , Tn ]/dT (ker(df )) = SymA (I). Similarly, H0 (M\u2022 ) =\nSymA/I (I/I 2 ). hence, it is important to give acyclicity conditions for the complexes Z\u2022 and\nM\u2022 ., in order to provide resolutions to SymA (I) and SymA/I (I/I 2 ).\nOne important property of the approximation complexes is the following\nProposition 1.5.1. The modules Hi (Z\u2022 ), Hi (B\u2022 ) and Hi (M\u2022 ) are independent of the generators chosen for I, for all i.\nProof. Proposition 3.2.6 and Corollary 3.2.7 of [Vas94a]\nWe will denote by (Z\u2022 )t , (B\u2022 )t and (M\u2022 )t the t-graded strand of the complexes, considering\nthe degree on the variables T1 , . . . , Tn . We will write Ss for the component of degree s of\nSym(An ).\nSince dT has degree 1 on the variables Ti , we get for each t a subcomplex of Z\u2022\nd\n\nd\n\nd\n\nd\n\nT\nT\nT\nT\n(Z\u2022 )t : 0 \u2192 (Zn )t \u2192\n(Zn\u22121 )t \u2192\n*** \u2192\n(Z1 )t \u2192\n(Z0 )t \u2192 0.\n\nBy definition we can rewrite the module (Zi )t as Zi (K) \u2297A St\u2212i . Hence we get that\nd\n\nd\n\nd\n\nT\nT\nT\n(Z\u2022 )t : 0 \u2192 Zn (K) \u2297A St\u2212n \u2192\n*** \u2192\nZ1 (K) \u2297A St\u22121 \u2192\nZ0 (K) \u2297A St \u2192 0.\n\nd\n\nd\n\nd\n\nT\nT\nT\nSimilarly, (M\u2022 )t : 0 \u2192 Hn (K) \u2297A St\u2212n \u2192\n*** \u2192\nH1 (K) \u2297A St\u22121 \u2192\nH0 (K) \u2297A St \u2192 0.\n\nFinally, we propose a different notation fot the complex Z\u2022 that will be very convenient.\nObserve that the module Zi is an ideal of the i-th module of the Koszul complex K\u2022 (f; A[T]),\nwhere the maps have degree d on the grading of A. If we write the complex with the adequate\nshift, we get\ndf\n\ndf\n\ndf\n\ndf\n\nK\u2022 (f; A[T]) : 0 \u2192 Kn [\u2212dn] \u2192 Kn\u22121 [\u2212d(n \u2212 1)] \u2192 * * * \u2192 K1 [\u2212d] \u2192 A[T1 , . . . , Tn ] \u2192 0,\nHence, with this notation we have that the complex Z\u2022 has as objects Zi = Zi (K)[di] \u2297A\nA[T1 , . . . , Tn ].\n\n32\n\n\fLemma 1.5.2. Denote Hi0 (Z\u2022 ) for (Hi0 (Z\u2022 ))t = (Hi (Z\u2022 ))t if i \u2265 0 and t > 0; and (H00 (Z\u2022 ))0 =\n0. For all i and all t, the conexion morphism \u03b4 : (Hi (B\u2022 ))t \u2192 (Hi (Z\u2022 ))t+1 induces an iso\u223c\nmorphism \u03b4 0 : (Hi (B\u2022 ))t \u2192 (Hi0 (Z\u2022 ))t+1 .\nProof. The complex L\u2022 := K\u2022 (T; A[T]) with maps dT is exact since the sequence {T1 , . . . , Tn }\nis regular. In particular each homogeneous strand (L\u2022 )t is acyclic for all positive t. Hence,\n\u03b4\nfor all i, t > 0, (Hi (B\u2022 ))t \u2192 (Hi (Z\u2022 ))t+1 is an isomorphism. Denoting by \u03c0 the rightmost (non-zero) map of the long exact sequence of homology we get a short exact sequence\n\u03b4\n\u03b4\n\u03c0\n0 \u2192 H0 (B\u2022 ) \u2192 H0 (Z\u2022 ) \u2192 H0 (L\u2022 ) \u2192 0, that provides the isomorphism H0 (B\u2022 ) \u223c\n= ker(\u03c0).\nMoreover, (H0 (L\u2022 ))t = 0 iff t = 0 and (H0 (L\u2022 ))0 = A. Then, we get the conexion morphism\n\u223c\n\u03b4 : (Hi (B\u2022 ))t \u2192 (Hi (Z\u2022 ))t+1 induces an isomorphism \u03b4 0 : (Hi (B\u2022 ))t \u2192 (Hi0 (Z\u2022 ))t+1 .\nBy definition of Z\u2022 , B\u2022 y M\u2022 , for each t we have a graded short exact sequence of complexes\n0 \u2192 B\u2022 \u2192 Z\u2022 \u2192 M\u2022 \u2192 0, giving rise to a long exact sequence in homology. From Lemma\n1.5.2, we get\n\u2206\n\n\u2206\n\n0\n(Z\u2022 )(1) \u2192 * * *\n* * * \u2192 Hi+1 (M\u2022 ) \u2192 Hi0 (Z\u2022 )(1) \u2192 Hi (Z\u2022 ) \u2192 Hi (M\u2022 ) \u2192 Hi\u22121\n\u2206\n0\n* * * \u2192 H1 (M\u2022 ) \u2192 H0 (Z\u2022 )(1) \u2192 H0 (Z\u2022 ) \u2192 H0 (M\u2022 ) \u2192 0,\n\n(1.8)\n\n\u2206\n\n0\n(Z\u2022 ) stands for the composition of the connection morphism in the\nwhere Hi (M\u2022 ) \u2192 Hi\u22121\nlast exact sequence, with \u03b4 0 of Lemma 1.5.2. We get the following\n\nProposition 1.5.3. If Hi (M\u2022 ) = 0 then Hi (Z\u2022 ) = 0. In particular, if M\u2022 is acyclic, then\nZ\u2022 is also acyclic.\nProof. Using the long exact sequence we get that if Hi+1 (M\u2022 ) = Hi (M\u2022 ) = 0, then 0 =\nHi+1 (M\u2022 ) \u2192 Hi0 (Z\u2022 )(1) \u2192 Hi (Z\u2022 ) \u2192 Hi (M\u2022 ) = 0, hence Hi (Z\u2022 ) = 0.\nAgain from the long exact sequence we get Hi (Z\u2022 )(1) \u2192 Hi (Z\u2022 ) \u2192 Hi (M\u2022 ) is exact for all\nt and all i > 0. By hypothesis, Hi (M\u2022 ) = 0, Since A is noetherian, Hi (Z\u2022 ) is of finite type.\nSince the map Hi (Z\u2022 )(1) \u2192 Hi (Z\u2022 ) is given by the composition of the isomorphism \u03b4 0 with\n\u223c\nthe inclusion (B\u2022 )t in (Z\u2022 )t , then, we get an isomorphism Hi (Z\u2022 )(1) \u2192 Hi (Z\u2022 ). Hence, for\n\u223c\nall t (Hi0 (Z\u2022 ))t+1 \u2192 (Hi (Z\u2022 ))t . Iteratively, from (Hi (Z\u2022 ))\u22121 = 0 we get (Hi (Z\u2022 ))t = 0 for all\nt.\nFrom the long exact sequence of homologies\n\u2206\n\n\u03bb\n\n* * * \u2192 H1 ((M\u2022 )t ) \u2192 H00 ((Z\u2022 )t+1 ) \u2192 H0 ((Z\u2022 )t ) \u2192 H0 ((M\u2022 )t ) \u2192 0,\n\n33\n\n\fwe get\n\u2206\n\n\u03bb\n\n* * * \u2192 H1 ((M\u2022 )t ) \u2192 (SymA (I))t+1 \u2192 (SymA (I))t \u2192 (SymA/I (I/I 2 ))t \u2192 0,\n\n(1.9)\n\nwhere \u2206 is the connecting mapping (composed by \u03b4 0 ) and \u03bb is the downgrading mapping\n\u03b4 0\u22121\n\u03bb : (SymA (I))t+1 \u223c\n= (SymA (I))t ,.\n= (H00 (Z\u2022 ))t+1 \u2192 (H0 (B\u2022 ))t ,\u2192 (H0 (Z\u2022 ))t \u223c\nLet us go back to the relation between Rees algebras and Symmetric algebras. From the\nlong exact sequences arising from the short exact sequences of complexes 0 \u2192 B\u2022 \u2192 Z\u2022 \u2192\nM\u2022 \u2192 0 (1.8), we get a condition on the map \u03c3 : SymA (I) \u2192 ReesA (I) for being an\nisomorphism, namely, for I to be of linear type.\nFrom the long exact sequence (1.9) and the short exact sequence 0 \u2192 I n+1 \u2192 I n \u2192\nI n /I n+1 \u2192 0 we obtain the following commutative diagrama\n/ Sym\n\nH1 (M\u2022 )\n0\n\n/ Sym\n\n\u03bb\n\nA (I)\n\nA (I)\n\n\u000f\n\n\u000f\n\n/ ReesA (I)+\n\n\u03c0\n\n/ Sym\n\nA/I (I/I\n\n2\n\n)\n\n/0\n\n\u03b3\n\n\u03c3\n\n\u000f\n\n/ ReesA (I)\n\n/ gr\n\n/ 0.\n\nwhere ReesA (I)+ consists on the ideal of ReesA (I) with elements of positive degree.\n\u223c\n\nProposition 1.5.4. If H1 (M\u2022 ) = 0 then \u03c3 : SymA (I) \u2192 ReesA (I) is an isomorphism,\nnamely, I is of linear type.\nProof. If H1 (M\u2022 ) = 0 for each degree i we get a commutative diagram\n0\n0\n\n/ (Sym\n\nA (I))i+1\n\n\u000f\n\n\u03c3i+1\n\n/ (ReesA (I)+ )i+1\n\n\u03bb\n\n/ (Sym\n\nA (I))i\n\n\u000f\n\n\u03c3i\n\n/ (ReesA (I))i\n\nwhere \u03c30 : A = (SymA (I))0 \u2192 (ReesA (I))0 = A is the identity. Since \u03c30 \u25e6 \u03bb is injective,\nthen \u03c31 also is, hence, an isomorphism. Iteratively we get that \u03c3t is an isomorphism for all\nt.\nTheorem 1.5.5. If A is noetherian, and \u03c3 : SymA (I) \u2192 ReesA (I) is the map above and\n\u03b3 : SymA/I (I/I 2 ) \u2192 grA (I its reduction modulo I, then \u03c3 is an isomorphism iff \u03b3 is an\nisomorphism.\n\n34\n\n\fProof. Clearly, if \u03c3 is an isomorphism, then also its reduction modulo I. Conversely, from\nthe Snake Lemma applied to the diagram\n0\n0\n\n/ Ki+1\n\u000f\n\n/ Ki\n\n/ (Sym\n\nA (I))i+1\n\n/ (Sym\n\n\u000f\n\n\u03bbi+1\n\nA (I))i\n\n/ I i+1\n\n/\n\n\u000f\n/Ii\n/\n\n0\n0,\n\nwe get the short exact sequence 0 \u2192 Ki /\u03bbi+1 (Ki+1 ) \u2192 SymA/I (I/I 2 )i \u2192 grA (I)i \u2192 0. By\nhypotesis Ki = \u03bbi+1 (Ki+1 ) for i > 1. Since K is a finitely generated ideal of SymA (I), there\nexists n > 1 such that Ki+1 = SymA (I)1 Ki , for i \u2265 n. Applying \u03bb we get Ki = \u03bb(Ki+1 ) =\n\u03bb(SymA (I)1 Ki ) = IKi .\nLocalizing and using Nakayama lemma, we get that Ki = 0 for all i \u2265 n. By descendent\ninduction we can annihilate the rest of the components.\n\n1.6 Acyclicity of approximation complexes\nAssume that A is an N-graded noetherian ring. Dente by m := A+ =\n\nL\n\ni>0\n\nAi .\n\nRemark 1.6.1. Write K\u2022 for the Koszul complex K\u2022 (x; A). If I and m have the same\nradical then supp(Hi (K\u2022 )) \u2282 V (m), this is Hi (K\u2022 )p = 0 for p 6= m. Hence, we also have\nsupp(Hi (M\u2022 )) \u2282 V (m) and supp(Hi (Z\u2022 )) \u2282 V (m).\nLaurent Bus\u00e9 and Jean-Pierre Jouanolou proved in [BJ03] that:\nProposition 1.6.2. Let I = (x1 , . . . , xn ) be an ideal of A such that rad(I) = rad(m) and\nr = depth(m : A) \u2265 1. Then Hi (Z\u2022 ) = 0 for all i \u2265 max{1, n \u2212 r}. In particular if n \u2265 2\nand r \u2265 n \u2212 1, then Z\u2022 is acyclic.\nThis result states acyclicity when the ideals I and m have the same radical. Geometrically, if\nI stands for the base locus ideal of a rational map, this means, that the map is well-defined\neverywhere. Since the condition rad(I) = m is not ubiquitous, Bus\u00e9 and Jouanolou gave a\ngeneralization of this result, in the same article [BJ03].\nFirst, given an ideal J of a ring A denote by \u03bc(J) the minimum number of generators of\nJ.\n\n35\n\n\fDefinition 1.6.3. Let I be an ideal of a ring A. We say that I is a local complete intersection\n(LCI) in Proj(A) iff for all p \u2208 Spec(A) \\ V (m) we have \u03bc(Ip ) = depth(Ip : Ap ). We say that\nI is an almost local complete intersection (ALCI) in Proj(A) iff for all p \u2208 Spec(A) \\ V (m)\nwe have \u03bc(Ip ) + 1 = depth(Ip : Ap ).\nProposition 1.6.4. Let I = (f1 , . . . , fn ) be a LCI ideal of A. Take n \u2265 2, and assume that\ndepth(m : A) \u2265 n \u2212 1 and depth(I : A) = n \u2212 2. Then, the complex Z\u2022 associated to I is\nacyclic.\nLemma 1.6.5 ([BJ03, Lemma 4.10]). Let I = (f1 , . . . , fn ) be an ideal of A such that\ndepth(m : A) > depth(I : A) = r. Then Hm0 (Hn\u2212r (K\u2022 )) = 0.\nLemma 1.6.6 ([BJ03, Lemma 4.11]). Let I = (f1 , . . . , fn ) be an ideal of A. Write \u03b6 :=\n\u03bc(I) \u2212 depth(I : A) and for all p \u2208 Spec(A) \\ V (m) we have \u03b6p := \u03bc(Ip ) \u2212 depth(Ip : Ap ).\nThen\n1. for all i > \u03b6, Hi (M\u2022 ) = 0;\n2. for all p \u2208 Spec(A) \\ V (m) we have \u03b6 > \u03b6p , hence, H\u03b6 (M\u2022 ) = Hm0 (H\u03b6 (M\u2022 )).\nIn [HSV83a] it is proved that:\nTheorem 1.6.7. Let A be a ring and I an ideal of A. Consider the following statements:\n1. I is generated by a proper sequence;\n2. the complex Z\u2022 associated to I is acyclic.\nThen (a) implies (b). Moreover, if A is local, with maximal ideal m, with residue infinite\nfield K, or if A is graded such that A0 = K is an infinite field and m : A+ generated in\ndegree 1; then (a) and (b) are equivalent.\n\n1.7 Implicitization\nIn this section we will overview the implicitization problem in two perspective, focusing on\nthe second one. First, we will briefly introduce the method by Sederberg and Chen, later\ndeveloped in depth by Bus\u00e9, Cox and D'Andrea. This method consists in the so called\ntheory of moving curves and moving surfaces. We will see that this is a \"innocent\" way of\napproaching a very deep subject that involves sophisticated homological and commutative\nalgebra and geometry.\n\n36\n\n\fSecond, we will treat the implicitization problem by means of approximation complexes,\nwhere we will use all the algebraic tool we exposed in the sections before. This point\nof view has been developed by Bus\u00e9, Chardin and Jouanolou since the beginning of this\ncentury.\n\n1.7.1 Moving curves and moving surfaces\nIn this part, we will sketch some results on moving curves and moving surfaces obtained by\nSederberg and Chen in [SC95], and later more sophistificated approaches by Bus\u00e9, Cox and\nD'Andrea in [Cox01, Cox03a, D'A01, BCD03].\nWe will follow the classical notation by D. Cox. For a better reading, we will give a short\ndictionary. Denote by s, t, u the variables X1 , X2 , X3 , K = C and hence, the ring A =\nk[X1 , X2 , X3 ] or A = k[X1 , X2 ] will be R = C[s, t, u] or C[s, t] respectively. We will write\nx, y, z, w for T1 , T2 , T3 , T4 and a, b, c, d for the functions f1 , f2 , f3 , f4 . A, B, C, D will denote\nthe syzygies that we have written a, b, c, d, namely A * a + *Bb + C * c + D * d = 0 or\nA * a + B * b + C * c = 0, depending on the context. We will denote by k the degree of\nA, B, C, D.\nThe question we want to reply is: How to get an implicit equation F which defines the curve\nor the surface given parametrically by a, b, c, d.\n\nMoving curves\nAssume that \u03c6 : P1C \u2192 P2C is a map which has as image a plane curve. We will compute the\nimplicit equation of the image of \u03c6, given by \u03c6(s, t) = (a(s, t), b(s, t), c(s, t)), where a, b, c \u2208\nR = C[s, t] are homogeneous polynomials of degree k. First, assume that gcd(a, b, c) = 1.\nHence, \u03c6 has no base points. Sederberg et. al. have introduced in [SC95] and [CSC98] the\nidea of moving lines in P1 .\nLet x, y, z be homogeneous coordinates in P2 . A moving line consists in an equation\nA(s, t)x + B(s, t)y + C(s, t)z = 0\nwhere A, B, C \u2208 R are homogeneous polynomials of the same degree. We can see the\nformula above as a family of lines parametrized by (s, t) \u2208 P1 .\n\n37\n\n\fDefinition 1.7.1. We will say that the moving line A(s, t)x+B(s, t)y +C(s, t)z = 0 follows\nthe parametrization \u03c6(s, t) = (a(s, t), b(s, t), c(s, t)) if\nA(s, t)a(s, t) + B(s, t)b(s, t) + C(s, t)c(s, t) = 0\nfor all (s, t) \u2208 P1 .\nGeometrically, this means that the point (s, t) lies on a line. Algebraically, Definition 1.7.1\nsays that A, B, C is a syzygy in a, b, c, namely (A, B, C) \u2208 Syz(a, b, c), where Syz(a, b, c) \u2282\nR3 is the module of syzygies of (a, b, c).\nSince Syz(a, b, c) is a graded module, we write Syz(a, b, c)s for its s-strand. We will see that\nSyz(a, b, c)k\u22121 determines the implicit equation of the image of \u03c6.\n(a,b,c)\n\n3\nIndeed, consider the Koszul map given by (a, b, c), Rk\u22121\n\u2212\u2192 R2k\u22121 , which has degree k.\n3\nIts kernel is Syz(a, b, c)k\u22121 . Observe that dimC (Rk\u22121 ) = 3k, dimC (R2k\u22121 ) = 2k. Hence,\ndimC (Syz(a, b, c)k\u22121 ) = k if and only if the map given by (a, b, c) has maximal rank. Thus,\nwe can get k generator (moving lines) linearly independent following \u03c6. We will denote\nthem by:\nk\u22121\nX\nAi x + Bi y + Ci z =\nLi,j (x, y, z)sj tk\u22121\u2212j ,\ni = 0, . . . , k \u2212 1,\nj=0\n\nwhere the Li,j (x, y, z) are linear forms with coefficients in C.\nOne of the main results in this area is the following:\nTheorem 1.7.2. Let C be the image of \u03c6, and denote by e its degree. Then det(Li,j ) = \u03bbF e ,\nwhere \u03bb \u2208 C \u2212 {0} and F = 0 is the implicit equation of the curve C \u2282 P2 .\nThis can be seen for example in [Cox01, Cox03a].\nObserve that a, b, c heve degree k, the curve C is defined by \u03c6 which has degree k/e, where\ne = deg(\u03c6). Hence, deg(F e ) = k. On the other hand, the determinant of Theorem 1.7.2 has\nalso degree k, since the forms (Li,j ) are linear.\nWe will study this with some more algebra. Take I = (a, b, c) \u2282 R. There is an exact\nsequence\n(a,b,c)\n\n0 \u2192 Syz(a, b, c) \u2192 R(\u2212k)3 \u2212\u2192 I \u2192 0.\n\n38\n\n\fIn two variables, Hilbert syzygy theorem implies that Syz(a, b, c) is free. By the Hilbert\npolynomial we get\nSyz(a, b, c) \u223c\n= R(\u2212k \u2212 \u03bc1 ) \u2295 R(\u2212k \u2212 \u03bc2 ),\n\n\u03bc1 + \u03bc2 = k.\n\nHence, if we write \u03bc = \u03bc1 \u2264 \u03bc2 = k \u2212 \u03bc, then, there exist syzygies p, q \u2208 Syz(a, b, c) such\nthat Syz(a, b, c) = R.p \u2295 R.q where the degree of p is \u03bc and the degree of \u03bc is k \u2212 \u03bc. We\nsay that {p, q} is a \u03bc-bases of the parametrization \u03c6 : P1 \u2192 P2 .\nHence, we have the following free presentation of I\n(a,b,c)\n\n0 \u2192 R(\u2212k \u2212 \u03bc1 ) \u2295 R(\u2212k \u2212 \u03bc2 ) \u2192 R(\u2212k)3 \u2212\u2192 I \u2192 0.\n\n(1.10)\n\nThe existence of \u03bc-basis has many important consequences, namely,\nProposition 1.7.3. If C is the image of \u03c6, e = deg(\u03c6) and p, q form a \u03bc-basis of \u03c6. Then,\nRes(p, q) = F e , where F = 0 is the implicit equation of C \u2282 P2 .\nFrom the existence of a \u03bc-basis we can get important consequences about the regularity of\nthe ideal I = (a, b, c). From the free presentation (1.10) of I, we can prove that reg(I) =\n2k \u2212 \u03bc \u2212 1. Hence, a \u03bc-basis determines the regularity of an ideal.\nMoving surfaces\nIn this part, we will focus on the implicitization problem of surfaces in P3 . Take \u03c6 : P2 \u2192 P3 ,\ngiven by homogeneous polynomials a, b, c, d \u2208 R = C[s, t, u] of degree k. Assume, as before,\nthat a, b, c, d have no common zeroes, that is \u03c6 has no base points.\nThe analog of moving lines in P2 are moving planes in P3 . A moving plane is an equation\nA(s, t, u)x + B(s, t, u)y + C(s, t, u)z + D(s, t, u)w = 0,\nwhere x, y, z, w are homogeneous coordinates in P3 , and A, B, C, D are elements of R of the\nsame degree.\nDefinition 1.7.4. We say that a moving plane follows the parametrization \u03c6 if\nA(s, t, u)a(s, t, u) + B(s, t, u)b(s, t, u) + C(s, t, u)c(s, t, u) + D(s, t, u)d(s, t, u) = 0\nfor all (s, t, u) \u2208 P2 . That is, if and only if A, B, C, D \u2208 Syz(a, b, c, d).\n\n39\n\n\fWe will see that moving planes are not enough in order to get the implicit equation of the\nimage of \u03c6, it will be necessary the use of moving surfaces of higher degree. In this case, we\nwill consider moving quadrics, which are equations:\n(s, t, u)x2 + B(s, t, u)xy + * * * + I(s, t, u)zw + J(s, t, u)w2 = 0,\nwhere A, B, . . . , I, J are homogeneous elements of R of the same degree. A moving quadric\nfollows the parametrization when A, B, . . . , I, J \u2208 Syz(a2 , ab, . . . , cd, d2 ) \u2282 R10 .\nMoving planes and moving quadrics can be obtained as\n(a,b,c,d)\n\n4\nM P : Rk\u22121\n\u2212\u2192 R2k\u22121 ,\n10\nM Q : Rk\u22121\n\n(a2 ,ab,...,cd,d2 )\n\n\u2212\u2192\n\nand\n\nR3k\u22121\n\n4\nObserve that dimC (R2k\u22121 ) = k(2k + 1) and dimC (Rk\u22121\n) = 2k(k + 1). Hence, the space of\nmoving planes has dimension 2k(k + 1) \u2212 k(2k + 1) = k iff the map M P has maximal rank.\nSimilarly, the space of moving quadrics has dimension (k 2 + 7k)/2 iff M Q has maximal\nrank.\n\nRemark 1.7.5. Remark that each moving plane gives place to four moving quadrics, obtained by multiplication by the four variables x, y, z, w. Hence, if M P and M Q have maximal rank, then there are exactly (k 2 + 7k)/2 \u2212 4k = (k 2 \u2212 k)/2 moving quadric linearly\nindependent not coming from moving planes. Taking these (k 2 \u2212 k)/2 moving quadrics and\nthe k moving planes, we build a matrix M of size (k 2 + k)/2 \u00d7 (k 2 + k)/2, where:\n1. k rows correspond to the k moving planes of degree k \u2212 1;\n2. (k 2 \u2212 k)/2 rows come from the moving quadrics of degree k \u2212 1.\nWe get a similar result to Theorem 1.7.2:\nTheorem 1.7.6. Let \u03c6 : P2 \u2192 P3 be a rational map without base points, given by \u03c6(s, t, u) =\n(a(s, t, u), b(s, t, u), c(s, t, u), d(s, t, u)). Assume \u03c6 admits exactly k linearly independent\nmoving planes of degree k \u2212 1 following the parametrization. Then, the image of \u03c6 is given\nby det(M ) = 0, where M is the matrix in Remark 1.7.5.\nWe can rewrite this as follows. Let \u03c6 be a rational map given by homogeneous polynomials\nf1 , f2 , f3 , f4 of degree k. Write x1 , x2 , x3 for the variables s, t, u and by t1 , t2 , t3 , t4 the\nvariables x, y, z, w. Then, we write the moving planes as polynomials\na1 (x1 , x2 , x3 )t1 + a2 (x1 , x2 , x3 )t2 + a3 (x1 , x2 , x3 )t3 + a4 (x1 , x2 , x3 )t4\n\n40\n\n\fand the moving quadrics as\na1,1 (x1 , x2 , x3 )t21 + a1,2 (x1 , x2 , x3 )t1 t2 + * * * + a3,4 (x1 , x2 , x3 )t3 t4 + a4,4 (x1 , x2 , x3 )t24 ,\nwhere the ai and the ai,j are homogeneous polynomials. If we take k moving planes\nL1 , . . . , Lk and l = (k 2 \u2212 k)/2 moving quadrics Q1 , . . . , Ql of degree k \u2212 1 following the\nparametrization, we obtain a square matrix M corresponding to the map of C[x, y, z, w]modules\nLk\nLl\nt, u]\n\u2297 C[x, y, z, w]\ni=1 C[x, y, z, w] \u2295\nj=1 C[x, y, z, w] \u2192 C[s,\nPk k\u22121 CPl\n(p1 , . . . , pk , q1 , . . . , ql )\n7\u2192\ni=1 pi Li +\nj=1 qj Qj\nIt can be shown that is always possible to chose L1 , . . . , Ld and Q1 , . . . , Ql such that\ndet(M ) 6= 0 everywhere, and whose zeroes give the implicit equation of the image of \u03c6\nraised to its degree. Again, we identify C[s, t, u]k\u22121 with Cl , which permits \"hiding\" the\nvariables s, t, u in order to get expressions that only depend on x, y, z, w.\n\n1.7.2 Implicitization by means of approximation complexes\nRecall from our first sections, let K be a commutative ring, h a graded ring of K-graded\nalgebras, defined as:\nh : K[T1 , . . . , Tn ] \u2192 A,\nTi 7\u2192 fi ,\nthat induces a map of K-projective schemes\n\u03c6 : Proj(A) \\ V (f1 , . . . , fn ) =\n\n[\n\nD+ (fi ) \u2192\n\n[\n\nn\u22121\nD+ (Ti ) = PK\n.\n\nWe want to compute the closed image of \u03c6, called, \"scheme-theoretic image\" of \u03c6.\nFrom Lemma 1.2.2, the ker(h) defines the closure of the image of \u03c6. If J stands for ker(h)\u223c ,\nthen V (J ) = V ((ker(h) : (T1 , . . . , Tn )\u221e )\u223c ).\nIn this subsection we compute the implicit equation of V (J ) with a different point of view\nrespecto to the subsection above. Hence, assume K is a field, A is a polynomial ring in the\nvariables X1 , . . . , Xn\u22121 . Thus, the maps h and \u03c6 are rewritten:\nh : K[T1 , . . . , Tn ] \u2192 K[X1 , . . . , Xn\u22121 ], Ti 7\u2192 fi , and\n\u03c6 : Pn\u22122\n\\ V (f1 , . . . , fn ) =\nK\n\n[\n\nD+ (fi ) \u2192\n\n[\n\nn\u22121\nD+ (Ti ) = PK\n.\n\n41\n\n\fWe have a rational map\n\u03c6 : Pn\u22122\n99K Pn\u22121\n: (x1 : . . . : xn\u22121 ) 7\u2192 (f1 : . . . : fs )(x1 , . . . , xn\u22121 ).\nK\nK\n\n(1.11)\n\nn\u22121\nIf \u03c6 is generically finite, then im(\u03c6) is a hypersurface in PK\n, and the implicitization problem\nconsists in computing the equation that spans the principal ideal ker(h).\n\nDenote by I = (f1 , . . . , fn ), with fi of degree d. The grading on A is the standard grading\nwhere deg(Xi ) = 1. Finally, we write Z\u2022 , B\u2022 and M\u2022 for the approximation complexes\nassociated to I, defined in 1.5.\nNote: The aim of this section is to show that in the implicitization context we consider, the\ncomplex Z\u2022 is acyclic and gives a resolution for SymA (I). We will see that splitting\nthis complex in its homogeneous parts we can get the implicit equation by taking\ndeterminant of an appropriate strand [GKZ94, Appendix A].\nThe relation between this section and the sections above is given by the following result:\nTheorem 1.7.7 ([Bus06, Prop. 4.2]). If Hm0 (A) = 0, then,\nannK[T1 ,...,Tn ] (ReesA (I)\u03bd ) = ker(h), for all \u03bd \u2208 N.\nRemark that this always happens when A = K[X1 , . . . , Xn\u22121 ]. We get the following result\nthat relates annA (ReesA (I)\u03b7 ) with the local cohomology module Hm0 (ReesA (I)).\nLemma 1.7.8 ([Bus01, Prop. 1.2]). For a ring R and B = R[X1 , . . . , Xn\u22121 ]/I 0 , such that\nR \u2229 I 0 = 0, and let \u03b7 \u2208 N be such that Hm0 (B)\u03b7 = 0. Then\nannR (B\u03b7 ) = annR (B\u03b7+\u03bd ) = Hm0 (B)0 , for all \u03bd \u2208 N.\nIn order to get a generator for ker(h), is necessary to compute a resolution. In spite of this\ngood property of ReesA (I), there are no universal resolutions for ReesA (I). This is one of\nthe key points in our approach. Hence, we will approximate ReesA (I) by SymA (I), which,\nas we have seen, in several cases it is a good approximation. Henceforward, we will give\nconditions in order to compute ker(h) from SymA (I).\nRecall we have a Z2 -grading on A[T1 , . . . , Tn ], which transfers to a Z2 -grading in SymA (I)\nvia the presentation:\n\u03b1\n\n0 \u2192 J 0 \u2192 A[T1 , . . . , Tn ] \u2192 SymA (I) \u2192 0,\nwhere J 0 = {\n\n42\n\nP\n\ngi Ti :\n\nP\n\ngi fi = 0, gi \u2208 A[T1 , . . . , Tn ]}, as has been proven in Section 1.3.1.\n\n\fDenote by SymA (I)\u03bd the\nL \u03bd-graded strand of SymA (I), corresponding to the grading on A.\nPrecisely, SymA (I)\u03bd = t\u22650 A\u03bd Sym tA (I), where Sym tA (I) denotes the t-graded strand with\nrespect to the grading on the Ti 's.\nProposition 1.7.9 ([BJ03, Prop. 5.1]). Assume I is of linear type off V (m), and set \u03b7 \u2208 Z\nsuch that Hm0 (SymA (I))\u03bd = 0 for all \u03bd \u2265 \u03b7. Then\nannK[T1 ,...,Tn ] (SymA (I)\u03bd ) = ker(h), for all \u03bd \u2265 \u03b7.\nwe conclude the following result:\nCorollary 1.7.10. If Hm0 (SymA (I)\u03bd ) = 0 then,\nannK[T1 ,...,Tn ] (SymA (I)\u03bd ) \u2282 ker(h), for all \u03bd \u2265 \u03b7.\nWe will assume that the map \u03c6 : Proj(A) 99K PnK is generically finite, hence, \u03c6 defines\na hypersurface in PnK and thus, ker(h) is principal. Denote by H the irreducible implicit\nequation which defines the closure of im(\u03c6).\nFirst, we will assume that V (I) = V (m) in Spec(A), namely \u03c6 will have empty base locus.\nIf V (I) = \u2205 in Proj(A), from Proposition 1.6.2 we have that the complex Z\u2022 is acyclic since\ndepth(m : A) = n \u2212 1. Hence, it provides a resolution for SymA (I). Thus, we can compute\nker(h) as the MacRae invariant S(SymA (I)\u03bd ) which coincides with the determinant of (Z\u2022 )\u03bd ,\nfor \u03bd \u2265 \u03b7.\n\nTheorem 1.7.11 ([BJ03, Thm. 5.2]). Assume that rad(I) = rad(m). Let \u03b7 \u2208 Z is such that\nHm0 (SymA (I))\u03bd = 0 for all \u03bd \u2265 \u03b7. Then, the homogeneous strand of degree \u03bd of the complex\n0 \u2192 (Zn\u22121 )\u03bd \u2192 (Zn\u22122 )\u03bd \u2192 . . . \u2192 (Z1 )\u03bd \u2192 A\u03bd [T1 , . . . , Tn ]\nis H deg(\u03c6) , of degree dn\u22122 .\nWe deduce from Theorem 1.7.11 that:\nProposition 1.7.12. Under the hypothesis of Theorem 1.7.11, H deg(\u03c6) can be computed as\nthe gcd of the maximal minors of the map of K[T1 , . . . , Tn ]-modules\nd\n\nT\n(Z1 )\u03bd \u2192\nA\u03bd [T1 , . . . , Tn ], for all \u03bd \u2265 \u03b7.\n\nWe can give an specific bound for \u03b7. Recall that in the case of \"moving curves\" and\n\"moving surfaces\" the sizes of matrices could be computed a priori and were related to the\nthe regularity of the ring. In the same way, \u03b7 depends on intrinsic characteristic I.\n\n43\n\n\fProposition 1.7.13 ([BJ03, Prop. 5.5]). Let n \u2265 3 and assume that rad(I) = m. Then,\nHm0 (SymA (I))\u03bd = 0 for all \u03bd \u2265 (n \u2212 2)(d \u2212 1).\nWe will now overview the case where \u03c6 admits \"good\" base points. It is no know how to trear\nthis case in great generality, hence, we will assume that the base locus V (I) = V (f1 , . . . , fn ),\nis a locally complete intersection (LCI) in Proj(A) of codimension n \u2212 2. Thus, we have that\nV (I) \u2282 Pn\u22122\nis locally given by a regular sequence and depth(I : A) = n \u2212 2 < depth(m :\nK\nA) = n \u2212 1. From Proposition 1.6.4 we get that the complex Z\u2022 is acyclic. We conclude\nthat Z\u2022 is a resolution of SymA (I). We have the following result on implicitization:\nTheorem 1.7.14 ([BJ03, Thm. 5.7]). Let I = (f1 , . . . , fn ) be a LCI in Proj(A) of codimension n \u2212 2, and \u03c6 is generically finite. Let \u03b7 \u2208 Z be such that Hm0 (SymA (I))\u03bd = 0 for all\n\u03bd \u2265 \u03b7. Then, the determinant of the strand of degree \u03bd of the complex\n0 \u2192 (Zn\u22121 )\u03bd \u2192 (Zn\u22122 )\u03bd \u2192 . . . \u2192 (Z1 )\u03bd \u2192 A\u03bd [T1 , . . . , Tn ]\nis H deg(\u03c6) , of degree dn\u22122 \u2212 dimK \u0393(Proj(A)/I, OProj(A)/I ).\nWe obtain that:\nProposition 1.7.15. Under the hypothesis of Theorem 1.7.14, H deg(\u03c6) can be computed as\nthe gcd of the maximal minors of the map of K[T1 , . . . , Tn ]-modules\nd\n\nT\n(Z1 )\u03bd \u2192\nA\u03bd [T1 , . . . , Tn ], for all \u03bd \u2265 \u03b7.\n\nSimilar to Proposition 1.7.13, it is possible to give a bound for \u03b7 as is shown in the next\nresult:\nProposition 1.7.16 ([BJ03, Prop. 5.10]). Let n \u2265 3 and assume I = (f1 , . . . , fn ) is a LCI\nin Proj(A) of codimension n \u2212 2. Then, Hm0 (SymA (I))\u03bd = 0 for all \u03bd \u2265 (n \u2212 2)(d \u2212 1).\nNext, we present several results that extent the previous work, and that precede the work\nin this thesis. For an ideal I of a Z-graded K-algebra A, we denote\n\u000fI := indeg(I) = inf{\u03bd \u2208 Z : I\u03bd 6= 0}.\nTheorem 1.7.17. Let I = (f1 , . . . , fn ) be an ideal of A of codimension n \u2212 2 in Proj(A).\nLet \u03b7 := (n \u2212 1)(d \u2212 1) \u2212 \u000fI .\n1. The following statements are equivalent:\n\n44\n\n\fa) V (I) is locally defined by at most n \u2212 1 equations;\nb) Z\u2022 is acyclic;\nc) (Z\u2022 )\u03bd is acyclic for \u03bd \u001d 0.\n2. If Z\u2022 is acyclic, then:\ndet((Z\u2022 )\u03bd ) = S(SymA (I)\u03bd ) = H (deg(\u03c6)) G, for all \u03bd \u2265 \u03b7.\nwhere G 6= 0 is a constant polynomial iff V (I) is LCI in Proj(A).\n3. Moreover, following statements are equivalent:\na) V (I) is locally of linear type;\nb) V (I) is locally a complete intersection;\nc) Proj(SymA (I)) = Proj(ReesA (I));\nd) G = 1, that is, det((Z\u2022 )\u03bd ) = S(SymA (I)\u03bd ) = H (deg(\u03c6)) for all \u03bd \u2265 \u03b7.\nNote: Recall that we have that \u03b1 : A[T1 , . . . , Tn ] \u2192 SymA (I) is surjective, as A =\nK[X1 , . . . , Xn\u22121 ], we have that there exists an injective map Proj(SymA (I)) ,\u2192\nPn\u22121\n\u00d7 PnK . With the notation of Theorem 1.7.17 we have that\nK\nX\nS(SymA (I)\u03bd ) = (\u03c02 )\u2217 (Proj(SymA (I))) \u223c\ndx ),\n= K[T1 , . . . , Tn ](\u2212dn\u22122 +\nx\u2208V (I)\n\nfor all \u03bd \u2265 (n \u2212 1)(d \u2212 1) \u2212 \u000fI . This says that deg(G) is a sum of number that\nmeasure how far is V (I) from being LCI. Precisely,\nX\ndeg(G) =\n(ex \u2212 dx ),\nx\u2208V (I)\n\nwhere ex := e(Jx , Rx ) is the multiplicity in x and dx := dimAx /x*Ax (Ax /Ix ).\n\n45\n\n\f\f2 Preliminaries on toric varieties\nAll along this chapter we will follow [Ful93] and [CLS]. We assume that the reader is familiar\nwith the definition of (normal) toric varieties in terms of a rational polyhedral fan.\nAs usual, N and M denote dual lattices of rank n \u2212 1, which correspond respectively to the\none parameter subgroups and characters of the associated torus T = TN = Spec(K[M ]).\nHere K denotes a fixed field. We denote by h\u2212, \u2212i : M \u00d7 N \u2192 Z the natural pairing.\n\n2.1 Divisors on toric varieties\nA divisor on a toric variety which is invariant under the action of the torus admits an explicit\ncharacterization in terms of lattice objects. The aim of the present section is to summarize\nsuch powerful description.\nLet \u2206 be a rational polyhedral fan in the lattice N \u223c\n= Zn\u22121 and let T\u2206 be the corresponding\ntoric variety with torus T = Spec(K[M ]).\nIf we denote by \u2206(1) the set of rays of the fan, then each orbit O\u03c1 (of the action of T on T\u2206 )\ncorresponding to a ray \u03c1 in \u2206(1) is a torus of dimension n \u2212 2. The orbit closure D\u03c1 = O\u03c1\nhas then the same dimension n \u2212 2. It follows that to each ray \u03c1 corresponds an irreducible\nsubvariety of T\u2206 of codimension 1, i.e. a prime divisor on T\u2206 .\nP\nDefinition 2.1.1. A Weil divisor D =\nai Di on the toric variety T\u2206 is said to be T invariant if every prime divisor Di is invariant under the action of the torus T on T\u2206 .\nProposition 2.1.2. The T -invariant Weil divisors are exactly the divisors of the form\nP\n\u03c1\u2208\u2206(1) a\u03c1 D\u03c1 , ai \u2208 K.\nWe turn now our attention to T -invariant Cartier divisors.\nDefinition 2.1.3. A Cartier divisor D on a toric variety T\u2206 is said to be T -invariant if it\ncorresponds to a T -invariant Weil divisor.\n\n47\n\n\fWe start by giving a description of the Cartier divisor corresponding to a character of the\ntorus T . Since a character \u03c7u defines a non-zero rational function on the toric variety T\u2206 ,\nthen {(T\u2206 , \u03c7u )} is a Cartier divisor which we denote by div(\u03c7u ). For each ray \u03c1 \u2208 \u2206(1),\ndenote by n\u03c1 the corresponding minimal generator (i.e. the first lattice point along the ray,\nstarting from the vertex). The proof of the next three statements can be found in [Ful93,\npage 61].\nLemma 2.1.4. Let T\u2206 be a toric variety. Let u be an element of M and \u03c7u its corresponding\ncharacter, then ordD\u03c1 (\u03c7u ) = hu, n\u03c1 i for every \u03c1 \u2208 \u2206(1).\nu\nWe\nP deduce that the Weil divisor associated to the principal Cartier divisor {(T\u2206 , \u03c7 )} is\n\u03c1\u2208\u2206(1) hu, n\u03c1 i D\u03c1.\n\nFor affine toric varieties, a very strong result holds.\nTheorem 2.1.5. Let U\u03c3 be the affine toric variety of a cone \u03c3 in Zn\u22121 , then every T invariant Cartier divisor on U\u03c3 is of the form (U\u03c3 , \u03c7u ) for some character \u03c7u of the torus\nT . In particular, every T -invariant Cartier divisor on U\u03c3 is principal.\n\nTheorem 2.1.5 can be used to describe a T -invariant Cartier divisor D on a general toric\nvariety T\u2206 . Indeed, consider the open cover of T\u2206 given by the affine toric varieties U\u03c3 , as\n\u03c3 varies in \u2206. By the above theorem, for each \u03c3 \b\nwe can find an element u(\u03c3) such that the\n\u2212u(\u03c3)\nlocal equation of D on U\u03c3 is \u03c7\n, so that D = (U\u03c3 , \u03c7\u2212u(\u03c3) ) \u03c3\u2208\u2206 is the description of the\nT -invariant Cartier divisor D.\nWe can make use of Theorem 2.1.5 to determine when two T -invariant Cartier divisors are\nthe same. Since the group of Cartier divisors is embedded in the group of Weil divisors, two\nCartier divisors are identical if and only if their associated Weil\nare so. In particular\n\b divisors\nu\n0\nu0\n0\ntwo T -invariant Cartier divisors D = {(U\u03c3 , \u03c7 )} and D = (U\n\u03c3 , \u03c7 ) (for u and u in M )\nP\non an affine toric variety U\u03c3 are identical if and only if [D] = \u03c1\u2208\u2206(1) hu, n\u03c1 i D\u03c1 and [D0 ] =\nP\nP\n0\n0\n\u03c1\u2208\u2206(1) hu , n\u03c1 i D\u03c1 are identical. This happens if and only if\n\u03c1\u2208\u2206(1) hu \u2212 u , n\u03c1 i D\u03c1 = 0.\nThis last statement is equivalent to saying that u \u2212 u0 lies in \u03c3 \u22a5 \u2229 M , which is a sublattice\nof M . Therefore we have the following:\nProposition 2.1.6. There is a bijection between the set of T -invariant Cartier divisors on\nan affine toric variety U\u03c3 and the quotient lattice M /\u03c3 \u22a5 \u2229 M .\n\n48\n\n\f2.2 Ample sheaves and support functions\nIn this section we give a characterization of the sheaf associated to a T - invariant divisor.\nThis allows us to state two criteria for such a sheaf to be ample or very ample.\nRecall that the support supp(\u2206) of a fan \u2206 is defined to be the union of all its cones.\nDefinition 2.2.1. A function \u03c8 : supp(\u2206) \u2192 R is said to be a \u2206-linear support function if\nit is linear on each cone \u03c3 of \u2206, that is, on each cone it is determined by a linear function,\nand assumes integer values at lattice vectors, i.e. \u03c8(supp(\u2206) \u2229 N ) \u2282 Z. If there is no\npossibility of confusion, we call \u03c8 just a support function. A \u2206-linear support function \u03c8\nis said to be strictly convex if it is convex and the linear functions determined by different\ncones are different.\nLet now \u2206 be a rational polyhedral fan and T\u2206 the associated toric variety. Combining\n\b Theorem \u22a52.1.5 and Proposition 2.1.6, we see that a Cartier divisor is specified by\nu(\u03c3) \u2208 M /\u03c3 \u2229 M \u03c3\u2208\u2206 .\nProposition 2.2.2. There is a bijective correspondence between T -invariant Cartier divisors on a toric variety T\u2206 and \u2206-linear support functions.\nWe also have the following general result that will be used.\nLemma 2.2.3. Let T\u2206 be a toric variety and T = Spec(K[M ]) its torus. Let D be a\nT -invariant Cartier divisor and O(D) its associated sheaf. If we denote by O the structure\nsheaf of T\u2206 , then we have \u0393(T, O(D)) = \u0393(T, O).\nNote that K[M ] can be expressed\nsum K[M ] =\nL as a direct\nu\nlemma says that \u0393(T, O(D)) = u\u2208M K\u03c7 .\n\nL\n\nu\u2208M\n\nK\u03c7u , so the previous\n\nAssume the fan is complete, that is supp(\u2206) = NR . Using the description in Proposition 2.2.2, we can see that any T -invariant Cartier divisor D defines a polytope ND . Let\n\u03c8D be the support function defined by D, then, identifying vectors u of MR with linear\nfunctions from NR to R, we define ND to be\nND = {u \u2208 MR : u \u2265 \u03c8D on supp(\u2206)} .\n(2.1)\nP\nNow, identifying D with its corresponding Weil divisor [D] = a\u03c1 D\u03c1 , we can rewrite (2.1)\nas\nND = {u \u2208 MR : hu, n\u03c1 i \u2265 \u2212a\u03c1 \u2200\u03c1 \u2208 \u2206(1)}\n(2.2)\n\n49\n\n\fA priori, (2.2) only says that ND is a polyhedron (an intersection of closed half spaces), but\nit is shown in [Ful93, pp. 67], that ND is in fact bounded and therefore a polytope under\nour assumption that supp(\u2206) = NR .\nReciprocally, let N be a full dimensional lattice polytope in MR , and let \u2206(N ) be its normal\nfan. Two vectors v and v 0 belong to the interior of the same cone \u2206(N ) if and only if the\nlinear functions hv, \u2212i and hv 0 , \u2212i attain their minimum over N at the same face of N . The\ncones in this fan are in bijection with the domains of linearity of the associated support\nfunction (see 2.4), which is strictly convex. Let D = D\u03c8 be the T -invariant Cartier divisor\ncorresponding to a support function \u03c8 on the associated toric variety T\u2206(N ) , and let O(D)\nbe its associated sheaf.\nTheorem 2.2.4. With notation as above we have\nM\n\u0393(T\u2206 , O(D)) =\n\nK\u03c7u\n\nu\u2208ND \u2229M\n\nwhere ND is the polytope of (2.2).\nLet \u03c8 be a \u2206-linear support function, with \u2206(N ) the fan of a polytope N in MR , and let\nu(\u03c3) \u2208 MR such that \u03c8(v) = hu(\u03c3), vi for any v in \u03c3. In this case it is straightforward to\ncheck that \u03c8 is convex if and only if for every maximal cone \u03c3 of \u2206(N ) and v in supp(\u2206(N ))\nwe have hu(\u03c3), vi \u2265 \u03c8(v). Theorems 2.2.6 and 2.2.5 give a very explicit criterion in terms\nof the support function \u03c8D to determine when O(D) is ample or very ample.\nTheorem 2.2.5. Let T\u2206(N ) be the toric variety of a polytope N . Let D be the divisor\nassociated to a support function \u03c8, then O(D) is generated by its sections if and only if \u03c8\nis convex.\n\nDenote by PN the N -dimensional projective space over K. Let D be a T -invariant Cartier\ndivisor on a toric variety T\u2206 such that O(D) is generated by its sections. Choosing and\nordering a basis {\u03c7ui : ui \u2208 ND \u2229 M } gives a morphism\nfD : T\u2206 \u2192 PN : x \u2192 (\u03c7u0 (x), . . . , \u03c7uN (x))\n\n(2.3)\n\nwhere N + 1 = #(ND \u2229 M ). Such a mapping is a closed embedding if and only if the sheaf\nO(D) is very ample. As in the previous theorem, we can give a characterization of this\ncondition in terms of the support function \u03c8 of D.\nTheorem 2.2.6. . Let D be a T -invariant Cartier divisor on a toric variety T\u2206 , then\nO(D) is ample if and only if \u03c8D is strictly convex. Moreover, O(D) is very ample if and\nonly if \u03c8D is strictly convex and for every maximal cone \u03c3 of \u2206, the lattice points of the\ndual cone \u03c3 \u2228 \u2229 M are generated by {u \u2212 u(\u03c3) : u \u2208 ND \u2229 M }.\n\n50\n\n\fWe show now that every toric variety arising from a polytope is projective. This fact makes\nit possible to compare the two different constructions of a toric variety we have studied, and\nshow that they are indeed equivalent.\nLet N be a full dimensional lattice polytope in MR and \u2206(N ) its normal fan in NR .\nRecall that, the support of \u2206(N ) is such that supp(\u2206(N )) = NR . We define a function\n\u03c8N : supp(\u2206(N )) \u2192 R as\n\u03c8N (v) = inf {hu, vi : u \u2208 N } .\n(2.4)\nWe call this function the support function of N . This name makes sense since the support\nfunction \u03c8N of a lattice polytope N is a \u2206(N )-linear support function. Moreover, the\nsupport function \u03c8N of a lattice polytope N is strictly convex. Indeed, convexity follows\nfrom the definition, since inf {a + b : a \u2208 A, b \u2208 B} = inf {a : a \u2208 A} + inf {b : b \u2208 B} for\narbitrary sets A and B of real numbers.\nProposition 2.2.7. The toric variety of a polytope is projective.\nProof. Let N be a polytope in MR and T = TN the associated toric variety. The previous\nremark shows that the support function \u03c8N is strictly convex. Then, by Theorem 2.2.6,\n\u03c8N determines a divisor D on T whose associated sheaf O(D) is ample. By [Har77, Sec.\nII], there exists an integer such that the sheaf O(D)\u2297m on T is very ample. Since T is\ncomplete, in particular it is proper, so T is a proper algebraic variety admitting a very\nample sheaf. This shows that T is projective.\n\n2.3 Projective toric varieties from a polytope\nIn this section we review the construction of a projective toric variety associated to a lattice\npolytope N \u2282 MR \u223c\n= Rn\u22121 (see also [GKZ94]).\n\nLet A = N \u2229 M be the set of lattice points of N . Let K be a field and PN the projective\nN -space over K, where N + 1 is the cardinality of A. Write A = {\u03b10 , . . . , \u03b1N }, where\n\u03b1i = (\u03b1i,1 , . . . , \u03b1i,n\u22121 ) for i = 0, . . . , N . We have a map\n\u03c1A : (K\u2217 )n\u22121 ,\u2192 PN ,\n\u03b1\n\n\u03b1\n\n(2.5)\n\n\u03b1\n\n\u03b1\n\n0,n\u22121\nN,n\u22121\ndefined by \u03c1A (t1 , . . . , tn\u22121 ) = (t1 0,1 * * * tn\u22121\n: . . . : t1 N,1 * * * tn\u22121\n).\n\n\u03b1\n\n\u03b1\n\ni,n\u22121\nFor simplicity, we set t = (t1 , . . . , tn\u22121 ) and t\u03b1i = t1 i,1 * * * tn\u22121\n, hence\n\n\u03c1A : (K\u2217 )n\u22121 ,\u2192 PN : t 7\u2192 (t\u03b10 : . . . : t\u03b1N ).\n\n51\n\n\fThe Zariski closure of the image of \u03c1A in PN is called the projective toric variety TN\nassociated to N , and we will write T instead of TN when N is understood:\nTN := im(\u03c1A ).\n\n(2.6)\n\nA general affine variety V = Spec(R) is said to be normal if it is irreducible and its local\nrings OV,p at each p of V are integrally closed (cf. [CLS, Prop. 3.0.11]). This last condition\nis equivalent to the K-algebra R being integrally closed. In particular, the affine toric\nvariety U\u03c3 = Spec(K[\u03c3 \u2228 \u2229 M ]) associated to a rational polyhedral cone \u03c3 in NR is always\nirreducible. Moreover, U\u03c3 is normal because the corresponding monoid algebra K[\u03c3 \u2228 \u2229 M ]\nis an integrally closed ring.\nWe will give some important results about the normality.\nDefinition 2.3.1. A full dimensional lattice polytope N \u2282 MR is very ample if for every\nvertex m \u2208 N , the semigroup generated by the set N \u2229 M \u2212 m = {m0 \u2212 m : m0 \u2208 N \u2229 M }\nis saturated in M .\nTheorem 2.3.2 ([CLS, Thm. 2.2.11, Prop. 2.2.17 and Cor. 2.2.18]). Let N \u2286 MR be a full\ndimensional lattice polytope of dimension n \u2265 3, then k * N is normal for all k \u2265 n \u2212 2.\nMoreover, a normal lattice polytope N is very ample. Hence, if dim(N ) \u2265 2, then k * N is\nvery ample for all k \u2265 n \u2212 2. And if dim(N ) = 2, then N is very ample.\nThus, we have that every full dimensional lattice polygon N \u2286 R2 is normal.\nHaving established more than one definition of toric varieties, it makes sense to compare\nboth of them.\nTheorem 2.3.3 ([CLS, Prop. 3.1.6]). Let N \u2286 MR be a full dimensional lattice polytope.\nLet k \u2208 Z be such that k * N is very ample. Then Tk*N \u223c\n= T\u2206(N ) , where \u2206(N ) is the normal\nfan of N .\nWe will give yet another approach to toric varieties in the following section.\n\n2.4 The Cox ring of a toric variety\nOur main motivation in Chapter 6 for considering regularity in general G-gradings comes\nfrom toric geometry. Among G-graded rings, homogeneous coordinate rings of a toric\n\n52\n\n\fvarieties are of particular interest in geometry. When T is a toric variety, G := Cl(T ) is\nthe (torus-invariant) divisor class group of T , also called the Chow group of T . In this\ncase, the grading can be related geometrically with the action of this group on the toric\nvariety, and hence, the graded structure on the ring can be interpreted in terms of global\nsections of the structural sheaf of T and in terms of character and valuations.\nHenceforward, let \u2206 be a non-degenerate fan in the lattice N \u223c\n= Zn\u22121 , and let T be a toric\nvariety associated to \u2206. Write \u2206(i) for the set of i-dimensional cones in \u2206. As we recalled,\nthere is a bijection between the set \u2206(i) and the set of closed torus-invariant i-dimensional\nsubvarieties of T . In particular, each \u03c1 \u2208 \u2206(1) corresponds to the torus-invariant Weil\ndivisor D\u03c1 \u2208 Z\u2206(1) \u223c\n= Zn\u22121 .\nSuppose that \u03c11 , . . . , \u03c1s \u2208 \u2206(1) are one-dimensional cones of \u2206 and assume \u2206(1) spans\n\u03c1\nRn\u22121 . P\nAs before, n\u03c1i denotes the primitive generator of \u03c1i . There is a map M \u2192 Z\u2206(1) :\nm 7\u2192 si=1 hm, n\u03c1i i D\u03c1i . We will identify [D\u03c1i ] with a variable xi .\nThe torus-invariant divisor classes correspond to the elements of the cokernel Cl(T ) of this\nmap \u03c1, getting an exact sequence\n\u03c1\n\u03c0\n0 \u2192 Zn\u22121 \u223c\n= M \u2212\u2192 Zs \u2212\u2192 Cl(T ) \u2192 0.\n\nSet S := k[x1 . . . , xs ]. From the sequence above we introduce in S a Cl(T )-grading, which\nis coarser than the standard Zn\u22121 -grading.\nTo any non-degenerate toric variety T , we associate an homogeneous coordinate ring, called\nthe Cox ring of T (cf. [Cox95]). D. A. Cox defines (loc. cit.) the homogeneous coordinate\nring of T to be the polynomial ring S together\nwith the given Cl(T )-grading.\nWe next\nP\nQ\ndiscuss briefly this grading. A monomial xai i determines a divisor D = i ai D\u03c1i which\nwill be denoted by xD . For a monomial xD \u2208 S we define its degree as deg(xD ) = [D] \u2208\nCl(T ).\nCox remarks loc. cit. that the set \u2206(1) is enough for defining the graded structure of S, but\nthe ring S and its graded structure does not suffice for reconstructing the fan. In order to\nnot to lose the fan information, we consider the irrelevant ideal\n\uf8eb\n\uf8f6\nY\nB := \uf8ed\nxi : \u03c3 \u2208 \u2206\uf8f8 ,\nn\u03c1i \u2208\u03c3\n/\n\nwhere the product is taken over all the n\u03c1i such that the ray R\u22650 n\u03c1i is not contained as an\nedge in any cone \u03c3 \u2208 \u2206. Finally, the Cox ring of T will be the Cl(T )-graded polynomial\nring S, with the irrelevant ideal B.\n\n53\n\n\fGiven a Cl(T )-graded S-module P , Cox constructs a quasi-coherent sheaf P \u223c on T by\nlocalizing just as in the case of projective space, and he shows that finitely generated modules\ngive rise to coherent sheaves. It was shown by Cox (cf. [Cox95]) for simplicial toric varieties,\nand by Mustata in general (cf. [Mus02]), that every coherent OT -module may be written\nas P \u223c , for a finitely generated Cl(T )-graded S-module P .\nFor any Cl(T )-graded S-module P and any \u03b4 \u2208 Cl(T ) we may define P (\u03b4) to be the graded\nmodule with components P (\u03b4)\u000f = P\u03b4+\u000f and we set\nM\nH\u2217i (T , P \u223c ) :=\nH i (T , P (\u03b4)\u223c ).\n\u03b4\u2208Cl(T )\n\nWe have H 0 (T , OT (\u03b4)) = S\u03b4 , the homogeneous piece of S of degree \u03b4, for each \u03b4 \u2208 Cl(T ).\nIn fact each H\u2217i (T , OT ) is a Zn\u22121 -graded S-module. We can compute (cf. [Mus02, Prop.\n1.3]), for i > 0,\nH\u2217i (T , P \u223c ) \u223c\n(2.7)\n= HBi+1 (P ) := lim ExtiS (S/B j , S).\n\u2212\u2192\nj\n\nand an exact sequence 0 \u2212\u2192 HB0 (P ) \u2212\u2192 P \u2212\u2192 H\u22170 (T , P \u223c ) \u2212\u2192 HB1 (P ) \u2212\u2192 0.\nWe will use these results in Chapter 7, applied to the computation of implicit equations of\nimages of rational maps of toric hypersurfaces.\n\n54\n\n\f3 Implicit equations of Toric\nhypersurfaces in projective space by\nmeans of an embedding\n3.1 Introduction.\nIn this chapter we extend the method of computing an implicit equation of a parametrized\nhypersurface in Pn focusing on different compactifications of the domain T , following the\nideas of [Bot10]. Hereafter in this chapter we will always assume that T is embedded in\nPN , and its coordinate ring A is n-dimensional, graded and Cohen-Macaulay.\nIn Section 3.2 we give a fast overview on the general implicitization setting in codimension\none, following the spirit of many papers in this subject revised in Chapter 1 /cf. also [BJ03],\n[BCJ09], [BD07]), as well as in [BDD09] and [Bot10]. We begin by considering the affine\nsetting and we continue by considering the mentioned compactifications. We show in Section\n3.2 one important application which motivated our study: T is the toric compactification\ndefined from the Newton polytope of the polynomials defining the rational map.\nIn Section 3.3 we focus on the implicitization problem for a rational map \u03c6 : T 99K Pn\ndefined by n+1 polynomials of degree d. We extend the method for projective 2-dimensional\ntoric varieties developed in [BDD09] to a map defined over an (n \u2212 1)-dimensional CohenMacaulay closed scheme T embedded in PN . We show that we can relax the hypotheses of\n[BDD09] on the base locus by admitting it to be a zero-dimensional almost locally complete\nintersection scheme.\nPrecisely, as we have seen in Chapter 1, we associate a complex (Z\u2022 )\u2022 to the map \u03c6. Recall\nfrom Chapter 1, that the determinant D of Z\u2022 in degree \u03bd can be computed either as an\nalternating sum of subdeterminants of the differentials in Z\u03bd or as the greatest common\ndivisor of the maximal-size minors of the matrix M\u03bd : (Z1 )\u03bd \u2192 (Z0 )\u03bd associated to the\nright-most map of (Z\u2022 )\u03bd . Theorem 3.3.10, which can be considered the main result of\n\n55\n\n\fthis chapter, states that this gcd computes a power of the implicit equation (with some\nextraneous factor), in a good degree \u03bd.\n\n3.2 General setting\nThroughout this section we will give a general setting for the implicitization problem of hypersurfaces. Our aim is to analyze how far these techniques from homological commutative\nalgebra (syzygies and graded resolutions) can be applied.\nWrite Ak := Spec(K[T1 , . . . , Tk ]) for the k-dimensional affine space over K. Assume we are\ngiven a rational map\n\u0013\n\u0012\nfn\nf1\nn\u22121\nn\n,...,\n(s)\n(3.1)\nf :A\n99K A : s := (s1 , . . . , sn\u22121 ) 7\u2192\ng1\ngn\nwhere deg(fi ) = di and deg(gi ) = ei , and fi , gi without common factors for all i = 1, . . . n.\nObserve that this setting is general enough to include all classical implicitization problems.\nTypically all gi are assumed to be equal and a few conditions on the degrees are needed,\ndepending on the context.\nWe consider a rational map \u03c6 : T 99K Pn , where T is a suitable compactification of a\nsuitable dense open subset of An\u22121 , in such a way that the map f extends from T to Pn\nvia \u03c6 and that the closed image of f can be recovered from the closed image of \u03c6.\nAssume T can be embedded into some PN , and set A for the homogeneous coordinate ring\nof T . Since An\u22121 is irreducible, so is T , hence A is a domain. Assume also that the closure\nof the image of \u03c6 is a hypersurface in Pn , hence, ker(\u03c6\u2217 ) is a principal ideal, generated by\nthe implicit equation.\nMost of our results are stated for a general arithmetically Cohen-Macaulay scheme as domain. Nevertheless, the map (3.1) gives rise, naturally, to a toric variety T on the domain\n(cf. [KD06, Sect. 2], [Cox03b], and [GKZ94, Ch. 5 & 6]) associated to the following polytope\nN (f ).\nP\nDefinition 3.2.1. Given a polynomial h = \u03b1\u2208Zn\u22121 a\u03b1 t\u03b1 we define its Newton polytope,\nN (h), as the convex hull of the finite set {\u03b1 : a\u03b1 6= 0} \u2282 Zn\u22121 . Now, let f denote a map as\nin equation (3.1). We will write\n!\nn\n[\nN (f ) := conv\n(N (fi ) \u222a N (gi ))\ni=1\n\n56\n\n\fthe convex hull of the union of the Newton polytopes of all the polynomials defining the\nmap f .\nThere is a standard way of associating a semigroup SN to a polytope N \u2282 Rn\u22121 . Indeed,\ntake \u03b9 : Rn\u22121 ,\u2192 Rn : x 7\u2192 (x, 1), and define SN as the semigroup generated by the lattice\npoints in \u03b9(N ). Due to a theorem of Hochster, if SN is normal then the semigroup algebra\nK[SN ] is Cohen-Macaulay. Unluckily, it turns out that SN is in general not always normal.\nA geometric or combinatorial characterization of the normality of K[SN ] is one of the most\nimportant open problem in combinatorial algebra (cf [BGT97]).\nNote that mN \u00d7 {m} = {(p1 + * * * + pm , m) : pi \u2208 N } \u2282 SN \u2229 (Zn\u22121 \u00d7 {m}) for any m \u2208 N,\nbut in general these two sets are not equal. When this happens for all m \u2208 N, we say that\nthe polytope N is normal, equivalently (m * N ) \u2229 Zn\u22121 = m * (N \u2229 Zn\u22121 ) for all m \u2208 N, and\nin this case it follows that K[SN ] is Cohen-Macaulay.\nTheorem 3.2.2. Let N \u2286 MR be a full dimensional lattice polytope of dimension n\u22121 \u2265 2.\nThen m * N is normal for all m \u2265 n \u2212 2.\nWe refer the reader to [CLS, Thm. 2.2.11.] for a proof. We deduce that every full dimensional\nlattice polygon N \u2286 R2 is normal.\nIn this chapter we focus on the study of toric varieties by fixing an embedding. Changing\nN by a multiple l * N changes the embedding, hence, we will fix the polytope. Since we also\nneed Cohen-Macaulayness of the quotient ring by the corresponding toric ideal in several\nresults, we will assume throughout that N is normal.\nRemark 3.2.3. Given a map f as in Equation (3.1), we will always assume that N := N (f )\nis normal. Therefore, the coordinate ring A of T = T (N ) will be always Cohen-Macaulay,\nhence T \u2282 PN will be arithmetically Cohen-Macaulay (aCM). This is automatic when\nn \u2212 1 = 2.\nAs we recalled in Chapter 2, the polytope N (f ) defines an (n \u2212 1)-dimensional projective\ntoric variety T provided with an ample line bundle which defines an embedding: if N =\n#(N (f ) \u2229 Zn\u22121 ) \u2212 1 we have T \u2286 PN . Write \u03c1 for the embedding determined by this ample\nline bundle. We get that the map\n\u03c1\n\n(A\u2217 )n\u22121 ,\u2192 PN : (s) 7\u2192 (. . . : s\u03b1 : . . .),\n\n(3.2)\n\nwhere \u03b1 \u2208 N (f ) \u2229 Zn\u22121 , factorizes f through a rational map \u03c6 with domain T , that is\nf = \u03c6 \u25e6 \u03c1. We will show later in this chapter that by taking N 0 (f ) as the smallest lattice\n\n57\n\n\fcontraction of N (f ) (that is N 0 (f ) is a lattice polytope such that N (f ) = dN 0 (f ) and d \u2208 Z\nis as big as possible) the computation becomes essentially better.\nThe main reason for considering projective toric varieties associated to the Newton polytope\nN (f ) of f , is based on the following fact.\nRemark 3.2.4. Assume f is as in Equation (3.1), with g1 = * * * = gn . Write f0 := gi\nfor all i. Assume also that all fi are generic with Newton polytope N , and hence write\nN := N (fi ) for all i. Set N := #(N \u2229 Zn\u22121 ) \u2212 1 and let T \u2282 PN be the toric variety\nassociated to N . Write \u03c6 : T 99K Pn : T 7\u2192 (h0 : * * * : hn ) the map induced by f . Since the\ncoefficients are generic, the vector of coefficients of h0 , . . . , hn is not in V (ResN (h0 , . . . , hn ));\nwhere V (ResN (h0 , . . . , hn )) stands for the zero locus of the sparse resultant ResN (h0 , . . . , hn )\nassociated to h0 , . . . , hn and N . Hence, they have no common root in T . Thus, \u03c6 has empty\nbase locus in T .\nIf we take instead another lattice polytope \u00d1 strictly containing N , the fi will not be generic\nrelative to \u00d1 , and typically the associated map \u03c6\u0303 will have a non-empty base locus in the\ntoric variety T \u0303 associated to \u00d1 .\n\n3.3 The implicitization problem\nIn this section we focus on the computation of the implicit equation of a hypersurface in Pn ,\nparametrized by an (n \u2212 1)-dimensional arithmetically Cohen Macaulay (aCM) subscheme\nof some projective space PN . We generalize what we have seen in Chapter 1 following the\nideas of [BDD09] and [Bot10], etc., and we give a more general result on the acyclicity of\nthe approximation complex of cycles, by relaxing conditions on the base ring and on the\nbase locus.\nHenceforward in this section, let T be a (n \u2212 1)-dimensional projective aCM closed scheme\nover a field K, embedded in PN\nK , for some N \u2208 N. Write J the homogeneous defining ideal of\nT and A = K[T0 , . . . , TN ]/J for its CM coordinate ring. Set T := T0 , . . . , TN the variables\nin PN , and X the sequence T0 , . . . , Tn of variables in Pn .\nWe denote m := A+ = (T) \u2282 A, the maximal homogeneous irrelevant ideal of A.\nLet \u03c6 be a finite map defined over a relative open set U in T defining a hypersurface in Pn ,\ne.g. U = \u03a9:\n\u03c6\nPN \u2283 T 99K Pn : T 7\u2192 (h0 : * * * : hn )(T),\n(3.3)\n\n58\n\n\fwhere h0 , . . . , hn are homogeneous elements of A of degree d. Set h := h0 , . . . , hn . The map\n\u03c6 gives rise to a morphism of graded K-algebras in the opposite sense\n\u03c6\u2217\n\nK[T0 , . . . , Tn ] \u2212\u2192 A : Ti 7\u2192 hi (T).\n\n(3.4)\n\nSince ker(\u03c6\u2217 ) is a principal ideal in K[X], write H for a generator. We proceed as in Chapter\n1, [BJ03] or in [BDD09] to get a matrix (representation matrix) such that the gcd of its\nmaximal minors gives H deg(\u03c6) , or possibly, a multiple of it.\nDefinition 3.3.1. Let S \u2282 Pn be a hypersurface. A matrix M with entries in the polynomial ring K[X0 , . . . , Xn ] is called a representation matrix of S if it is generically of full\nrank and if the rank of M evaluated in a point p of Pn drops if and only if the point p lies\non S .\nRemark 3.3.2. Observe that if we start with an affine setting as in (3.1), T \u2282 PN can\nbe taken as the embedded toric variety associated to N 0 (f ). In the classical implicitization\nproblem it is common to suppose that gi = gj for all i and j, and deg(fi ) = deg(gi ) = d for\nall i. Hence, write f0 for any of the gi . This setting gives naturally rise to a homogeneous\ncompactification of the codomain, defined by the embedding\nj\n\nAn ,\u2192 Pn : x 7\u2192 (1 : x).\n\n(3.5)\n\nIt is clear that for f0 , . . . , fn taken as above, the map f : An\u22121 99K An of equation (3.1)\ncompactifies via \u03c1 and j to \u03c6 : T 99K Pn . It is important to note that im(f ) can be\nobtained from im(\u03c6) and vice-versa, via the classical (first variable) dehomogenization and\nhomogenization respectively. Finally, we want to give a matrix representation for a toric\nhypersurface of Pn given as the image of the toric rational map \u03c6 : T 99K Pn : T 7\u2192 (h0 :\n* * * : hn )(T).\nSince \u03c6 : T 99K Pn is not, in principle, defined everywhere in T , we set \u03a9 for the open set\nof definition of \u03c6. Precisely, we define\nDefinition 3.3.3. Let \u03c6 : T 99K Pn given by s 7\u2192 (h0 : * * * : hn )(s) The base locus of \u03c6 is\nthe closed subscheme of T\nX := Proj (A/(h0 , . . . , hn )) .\nWe call \u03a9 the complement of the base locus, namely \u03a9 := T \\ X. Let \u0393\u03a9 be the graph of\n\u03c6 inside \u03a9 \u00d7 Pn .\n\n59\n\n\f\u03c0\n\n1\nClearly \u0393\u03a9 \u2212\u2192\n\u03a9 is birational, which is in general not the case over X. As was shown in\n[Bot09b], the scheme structure of the base locus when we take (P1 )n as the codomain, can\nbe fairly complicated and extraneous factors may occur when projecting on (P1 )n via \u03c02\n(cf. 4). This motivates the need for a splitting of the base locus, giving rise to families of\nmultiprojective bundles over T .\n\nDue to this important difference between the projective and multiprojective case, we need\nto separate the study of the two settings. In the next section, we treat the case of Pn , and\nin Chapter 4 the case of (P1 )n . In both situations, we find a matrix representation of the\nclosed image of the rational map \u03c6, and we compute the implicit equation and extraneous\nfactors that occur.\nNext, we introduce the homological machinery needed to deal with the computations of the\nimplicit equations and the representation matrix of the hypersurface.\n\n3.3.1 Homological algebra tools\nIn this section we will study some properties of approximation complexes, introduced in\nChapter 1. Our aim is to get similar results in a new context: the ring A is the coordinate\nring of a toric variety, which is CM, but in general not Gorenstein. The non-Gorensteinness\ndim(A)\nmakes things more complicated since, for example, we cannot identify Hm\n(A) with \u03c9A\u2228 .\nWe will first brefly recall the definition of these complexes, just in order to fix a notation,\nand later prove that if the ideal I is LACI then the associated Z-complex is acyclic. Finally\nwe give a bound for the regularity of the symmetric algebra of I over A.\nFor simplicity, we denote by Ti the classes of each variable in the quotient ring A = K[T]/J.\nRecall that A is canonically graded, each variable having weight 1. Let I = (h0 , . . . , hn ) \u2282 A\nbe the ideal generated by the hi 's.\nMore precisely, we will see that the implicit equation of S can be recovered as the determinant of certain graded parts of the Z-complex we define below. We denote by Z\u2022\nthe approximation complex of cycles associated to the sequence h0 , . . . , hn of homogeneous\nelements of degree d over A (cf. [Vas94b]), as in the Definition 3.3.4.\nConsider the Koszul complex (K\u2022 (h, A), \u03b4\u2022 ) associated to h0 , . . . , hn over A and denote\nZi = ker(\u03b4i ), Bi = im(\u03b4i+1 ). It is of the form\nK\u2022 (h, A) :\n\n\u03b4n+1\n\n\u03b4\n\n\u03b4\n\n\u03b4\n\nn\n2\n1\nA[\u2212(n + 1)d] \u2212\u2192 A[\u2212nd]n+1 \u2212\u2192\n* * * \u2212\u2192\nA[\u2212d]n+1 \u2212\u2192\nA\n\nwhere the differentials are matrices such that every non-zero entry is \u00b1hi for some i.\n\n60\n\n\fV\nWrite Ki := i An+1 [\u2212i * d]. Since Zi \u2282 Ki , it keeps the shift in the degree. Note that with\nthis notation the sequence\n0 \u2192 Zi \u2192 Ki \u2192 Bi\u22121 \u2192 0\n(3.6)\nis exact graded, and no degree shift is needed.\nWe introduce new variables T0 , . . . , Tn with deg(Ti ) = 1. Since A is N-graded, A[X] inherits\na bigrading.\nDefinition 3.3.4. Denote by Zi = Zi [i * d] \u2297A A[X] the ideal of cycles in A[X], and write\n[\u2212] for the degree shift in the variables Ti and (\u2212) the one in the Ti . The approximation\ncomplex of cycles (Z\u2022 (h, A), \u000f\u2022 ), or simply Z\u2022 , is the complex\nZ\u2022 (h, A) :\n\n\u000f\n\n\u000fn\u22121\n\n\u000f\n\n\u000f\n\nn\n2\n1\n0 \u2212\u2192 Zn (\u2212n) \u2212\u2192\nZn\u22121 (\u2212(n \u2212 1)) \u2212\u2192 * * * \u2212\u2192\nZ1 (\u22121) \u2212\u2192\nZ0\n\n(3.7)\n\nwhere the differentials \u000f\u2022 are obtained by replacing hi by Ti for all i in the matrices of \u03b4\u2022 .\nRecall that H0 (Z\u2022 ) = A[X]/im(\u000f1 ) \u223c\n= SymA (I). Note that the degree shifts are with respect\nto the grading (\u2212) given by the Ti 's, while the degree shifts with respect to the grading of A\nare already contained in our definition of the Zi 's. From now on, when we take the degree\n\u03bd part of the approximation complex, denoted (Z\u2022 )\u03bd , it should always be understood to be\ntaken with respect to the grading [\u2212] induced by A.\nUnder certain conditions on the base locus of the map, this complex is acyclic and provides a free K[X]-resolutions of (SymA (I))\u03bd for all \u03bd. Hence, we focus on finding acyclicity\nconditions for the complex Z\u2022 . In this direction we have\nLemma 3.3.5. Let m \u2265 n be non-negative integers, A an m-dimensional graded CohenMacaulay ring and I = (h0 , . . . , hn ) \u2282 A is of codimension (hence depth) at least n \u2212 1 with\ndeg(hi ) = d for all i. Assume that X := Proj(A/I) \u2282 S is locally defined by n equations\n(i.e. locally an almost complete intersection). Then Z\u2022 is acyclic.\nProof. The proof follows ideas of [BC05, Lemma 2] and [BD07, Lemma 1]. Observe that the\nlemma is unaffected by an extension of the base field, so one may assume that K is infinite.\nBy [HSV83a, Theorem 12.9], we know that Z\u2022 is acyclic (resp. acyclic outside V (m)) if and\nonly if I is generated by a proper sequence (resp. X is locally defined by a proper sequence),\nsee Theorem 1.6.7. Recall that a sequence a1 , . . . , an of elements in a commutative ring B is\na proper sequence if ai+1 Hj (a1 , . . . , ai ; B) = 0 for i = 0, . . . , n \u2212 1 and j > 0, where the Hj 's\ndenote the homology groups of the corresponding Koszul complex (cf. Definition 1.3.3).\n\n61\n\n\fBy following the same argument of [BC05, Lemma 2] and since X is locally defined by n\nequations, one can choose h\u03030 , . . . , h\u0303n to be sufficiently generic linear combinations of the hi 's\nsuch that\n1. (h\u03030 , . . . , h\u0303n ) = (h0 , . . . , hn ) \u2282 A,\n2. h\u03030 , . . . , h\u0303n\u22122 is an A-regular sequence, hence h\u03030 . . . , h\u0303n\u22121 is a proper sequence in A,\n3. h\u03030 , . . . , h\u0303n\u22121 define X in codimension n \u2212 1.\nNote that this last condition is slightly more general (and coincides when m = n) than the\none in [BC05, Lemma 2]. Set J := (h\u03030 , . . . , h\u0303n\u22121 ) and write J um for the unmixed part of J\nof codimension n \u2212 1. Hence, observe that we obtain h\u0303n \u2208 J um .\nSince h\u0303n \u2208 J um , we show that h\u0303n H1 (h\u03030 , . . . , h\u0303n\u22121 ; A) = 0. Applying [BH93, Thm. 1.6.16]\nto the sequence h\u03030 , . . . , h\u0303n\u22121 , we obtain that H1 (h\u03030 , . . . , h\u0303n\u22121 ; A) \u223c\n= Extn\u22121\nA (A/J, A). Taking\n\u2022\nthe long exact sequence of ExtA (\u2212, A) coming from the short exact sequence 0 \u2192 J um /J \u2192\nA/J \u2192 A/J um \u2192 0, we get that\n***\n\nGF\n@A\n\n/\n\n/ Extn\u22121 (A/J, A)\n\num\nExtn\u22122\n/J, A)\nA (J\n\n/ Extn\u22121 (A/J um , A)\nA\n\n/\n\nA\n\num\nExtn\u22121\n/J, A)\nA (J\n\nED\nBC\n/\n\n***\n\nis exact. Since A is a Cohen-Macaulay noetherian graded ring, and J um /J is a m \u2212 (n \u2212 1)n\u22122\num\ndimensional A-module, Extn\u22121\n/J, A) and ExtA\n(J um /J, A) vanish (cf. [Mat89, Thm.\nA (J\n17.1]). Hence\nn\u22121\num\n\u223c\nExtn\u22121\n, A),\nA (A/J, A) = ExtA (A/J\num\nthus, since h\u0303n \u2208 J um , h\u0303n annihilates Extn\u22121\n, A), hence also h\u0303n annihilates H1 (h\u03030 , . . . , h\u0303n\u22121 ; A)\nA (A/J\nwhich finishes the proof.\n\nWe stress in the following remark one useful application of the previous Lemma 3.3.5.\nRemark 3.3.6. Let m \u2265 n be non-negative integers. Set T an arithmetically CohenMacaulay scheme over K embedded in some PN with coordinate ring A of affine dimension m.\nAssume we are given a rational map \u03c6 : T 99K Pn given by n + 1 homogeneous polynomials\nh0 , . . . , hn \u2208 A := K[T0 , . . . , TN ]/I(T ). Write Z\u2022 for the approximation complex of cycles\nassociated to the sequence h0 , . . . , hn . If the base locus of \u03c6, X \u2282 T , is locally defined by\nn equations, then Z\u2022 is acyclic, independent of m and N .\nWe translate Lemma 3.3.5 geometrically.\n\n62\n\n\fCorollary 3.3.7. Assume m = n is a non-negative integer. Let T be an (n\u22121)-dimensional\narithmetically CM closed subscheme of PN defined by a homogeneous ideal J, and coordinate\nring A = K[T]/J. Assume we are given a rational map \u03c6 : T 99K Pn given by n + 1\nhomogeneous polynomials h0 , . . . , hn \u2208 A of degree d. Write Z\u2022 for the approximation\ncomplex of cycles associated to the sequence h0 , . . . , hn . If the base locus of \u03c6, X \u2282 T ,\nis finite, and locally an almost complete intersection (defined by n equations), then Z\u2022 is\nacyclic.\nThe following result establishes a vanishing criterion on the graded strands of the local\ncohomology of SymA (I), which ensures that the implicit equation can be obtained as a\ngenerator of the annihilator of the symmetric algebra in that degree.\nSince A is a finitely generated graded Cohen Macaulay A-module of dimension n, Hmi (A) = 0\nfor all i 6= n and Hmn (A) = \u03c9A\u2228 , where (\u2212)\u2228 := \u2217 homA (\u2212, K) stands for the Matlis dualizing\nfunctor (cf. [BH93]). Write\nai (M ) := inf{\u03bc : (Hmi (M ))>\u03bc = 0}.\n\n(3.8)\n\n\u03b3 := an (A) = inf{\u03bc : (\u03c9A\u2228 )\u03bc = 0},\n\n(3.9)\n\nHence, we set\nand we conclude the following result.\nTheorem 3.3.8. Let A = K[T]/J be a CM graded ring of dimension n. Let I = (h0 , . . . , hn )\nbe a homogeneous ideal of A, with deg(hi ) = d for all i. Let X := Proj(A/I) \u2282 T be finite\nand locally an almost complete intersection. Set\n\u03bd0 := max{(n \u2212 2)d, (n \u2212 1)d \u2212 \u03b3},\n\n(3.10)\n\nthen Hm0 (SymA (I))\u03bd = 0 for all \u03bd \u2265 \u03bd0 .\nProof. For the bound on \u03bd, consider the two spectral sequences associated to the double\ncomplex Cm\u2022 (Z\u2022 ), both converging to the hypercohomology of Z\u2022 . The first spectral sequence\nstabilizes at step two with\n\u001a p\nHm (SymA (I)) for q = 0,\n0\np\n0 p\np\n\u221e Eq = 2 Eq = Hm (Hq (Z\u2022 )) =\n0\notherwise.\nThe second has first terms 001 Eqp = Hmp (Zq )[qd] \u2297A A[X](\u2212q). The comparison of the two\nspectral sequences shows that Hm0 (SymA (I))\u03bd vanishes as soon as (1 00 Epp )\u03bd vanishes for all p,\nin fact we have that\nend(Hm0 (SymA (I))) \u2264 max{end(1 00 Epp )} = max{end(Hmp (Zp )) \u2212 pd},\np\u22650\n\np\u22650\n\n63\n\n\fwhere we denote, for an A-module M , end(M ) = max{\u03bd | M\u03bd 6= 0}. Since Z0 \u223c\n= A we get\nHm0 (Z0 ) = 0. The sequence 0 \u2192 Zi+1 \u2192 Ki+1 \u2192 Bi \u2192 0 is graded exact (cf. Equation\n(3.6)), hence, from the long exact sequence of local cohomology for i = 0 (writing B0 = I)\nwe obtain\n* * * \u2192 Hm0 (I) \u2192 Hm1 (Z1 ) \u2192 Hm1 (K1 ) \u2192 * * * .\nAs I is an ideal of an integral domain, Hm0 (I) = 0, it follows from the local cohomology of A\nthat Hm1 (K1 ) = 0, hence Hm1 (Z1 ) vanishes. By construction, Zn+1 = 0 and Bn = im(dn ) '\nA[\u2212d]. Using the fact that Hmn (A)\u03bd = 0 for \u03bd \u2265 \u22121 (resp. \u03bd \u2265 0), we can deduce that\nHmn (Zn )\u03bd = Hmn (Bn )\u03bd = (\u03c9A\u2228 )[d] = 0 if \u03bd \u2265 d \u2212 \u03b3. Write\n\u000fp := end(1 00 Epp ) = end(Hmp (Zp )) \u2212 pd\nBy [Cha04, Cor. 6.2.v] end(Hmp (Zp )) \u2264 max0\u2264i\u2264n\u2212p {ap+i (A) + (p + i + 1)d} = max{nd, (n +\n1)d \u2212 \u03b3}, where \u03b3 := \u2212an (A) as above. Hence, \u000fp := max{(n \u2212 p)d, (n + 1 \u2212 p)d \u2212 \u03b3}. As\n\u000fp decreases when p increases, \u000fp \u2264 \u000f2 = max{(n \u2212 2)d, (n \u2212 1)d \u2212 \u03b3} which completes the\nproof.\nThis generalizes what we sketched in Chapter 1 according to [BJ03] and [BCJ09] and also, we\ngeneralize [BDD09] to general (n \u2212 1)-dimensional arithmetically Cohen-Macaulay schemes\nwith almost locally complete intersection base locus. Next, we recall how the homological\ntools developed in this part are applied for computing the implicit equation of the closed\nimage of a rational map.\n\n3.3.2 The representation matrix, the implicit equation, and the\nextraneous factor\nIt is well known that the annihilator above can be computed as the determinant (or MacRae\ninvariant) of the complex (Z\u2022 )\u03bd0 (cf. Chapter 1 and for example, [BJ03], [BCJ09], [Bot09b],\n[BDD09]). Hence, the determinant of the complex (Z\u2022 )\u03bd0 is a multiple of a power of the\nimplicit equation of S . Indeed, we conclude the following result.\nLemma 3.3.9. Let T be an (n \u2212 1)-dimensional arithmetically CM closed subscheme of PN\ndefined by a homogeneous ideal J, and coordinate ring A = K[T]/J. Let I = (h0 , . . . , hn )\nbe a homogeneous ideal of A, with deg(hi ) = d for all i. Take \u03c6 as in (3.3), and let X :=\nProj(A/I) \u2282 T , the base locus of \u03c6, be finite and locally an almost complete intersection.\nSet \u03bd0 := max{(n \u2212 2)d, (n \u2212 1)d \u2212 \u03b3}, then Hm0 (SymA (I))\u03bd = 0 and annK[X] (SymA (I)\u03bd ) \u2282\nker(\u03c6\u2217 ), for all \u03bd \u2265 \u03bd0 .\n\n64\n\n\fProof. The first part follows from 3.3.8. The proof of the second part can be taken verbatim\nfrom [BD07, Lemma 2].\nCorollary 3.3.10. Let T be an (n \u2212 1)-dimensional arithmetically CM closed subscheme of\nPN defined by a homogeneous ideal J, and coordinate ring A = K[T]/J. Let I = (h0 , . . . , hn )\nbe an homogeneous ideal of A, with deg(hi ) = d for all i. Let X := Proj(A/I) \u2282 T be finite\nand locally almost a complete intersection. Let \u03bd0 be as in (3.10). For any integer \u03bd \u2265 \u03bd0\nthe determinant D of the complex (Z\u2022 )\u03bd of K[X]-modules defines (up to multiplication with\na constant) the same non-zero element in K[X]. Moreover, D = F deg(\u03c6) G, where F is the\nimplicit equation of S .\nProof. It follows from Lemma 3.3.5, Lemma 3.3.9, and Theorem 4.3.5, by following the same\nlines of the proof of [BJ03, Thm. 5.2].\nBy [GKZ94, Appendix A], the determinant D can be computed either as an alternating\nproduct of subdeterminants of the differentials in (Z\u2022 )\u03bd or as the greatest common divisor\nof the maximal-size minors of the matrix M associated to the right-most map (Z1 )\u03bd \u2192 (Z0 )\u03bd\nof the Z-complex (cf. Definition 3.3.4). Note that this matrix is nothing else than the matrix\nM\u03bd of linear syzygies as described in the introduction; it can be computed with the same\n\u03c6\nalgorithm as in [BD07] or [BDD09]. Hence, if T 99K Pn is as in Corollary 3.3.10, the matrix\nM\u03bd of linear syzygies of h0 , . . . , hn in degree \u03bd \u2265 \u03bd0 is a representation matrix for the closed\nimage of \u03c6.\nAs was done by Bus\u00e9 et al. in [BCJ09, Sec. 2], we conclude that the the extraneous factor\nG can be described in terms of linear forms.\nProposition 3.3.11. If the field K is algebraically closed and X is locally generated by at\nmost n elements then, there exist linear forms Lx \u2208 K[X], and integers ex and dx such that\nG=\n\nY\nx\u2208X\n\nLexx \u2212dx \u2208 K[X].\n\nMoreover, if we identify x with the prime ideal in Spec(A) defining the point x, ex is the\nHilbert-Samuel multiplicity e(Ix , Ax ), and dx := dimAx /xAx (Ax /Ix ).\nProof. The proof goes along the same lines of [BCJ09, Prop. 5], just observe that [BCJ09,\nLemma 6] is stated for a Cohen-Macaulay ring as is A in our case.\n\n65\n\n\f3.4 The representation matrix for toric surfaces\nWe applied here in down to earth terms, the results above for the case of toric surfaces\nfollowing [BDD09]. It is a natural question how this kind of matrix representation can be\nused concretely to rational surfaces defined as the image of a map\nf\n\n3\nA2 99K A\n\u0013\n\u0012\nf1 (s, t) f2 (s, t) f3 (s, t)\n,\n,\n(s, t) 7\u2192\nf0 (s, t) f0 (s, t) f0 (s, t)\n\nwhere fi \u2208 K[s, t] are coprime polynomials of degree d. In order to put the problem in the\ncontext of graded modules, one first has to consider an associated projective map\n\u03c6\n\nT 99K P3\nP 7\u2192 (h0 (P ) : h1 (P ) : h2 (P ) : h3 (P ))\n\nwhere T is a 2-dimensional projective toric variety (for example P2 or P1 \u00d7 P1 ) with coordinate ring A and the hi \u2208 A are homogenized versions of their affine counterparts fi . In\nother words, as in Section 3.2, T is a suitable compactification of the affine space (A\u2217 )2\n[Cox03a, Ful93]. In this case, a linear syzygy (or moving plane) of the parametrization g is\na linear relation on the h0 , . . . , h3 , i.e. a linear form L = a0 X0 + a1 X1 + a2 X2 + a3 X3 in the\nvariables X0 , . . . , X3 with ai \u2208 K[s, t] such that\nX\nai hi = 0\n(3.11)\ni=0,...,3\n\nRecall that in the same way as for curves, one can set up the matrix M\u03bd of coefficients of the\nsyzygies in a certain degree \u03bd, but unlike the case of curves, it is in general not possible to\nchoose a degree \u03bd such that M\u03bd is a square matrix representation of the surface (cf. Chapters\n1.7 and 3.1).\nSince we are looking for a matrix representation, we will assume that the base locus X :=\nProj(A/I) is locally a complete intersection. Thus, we will get a symbolic matrix m\u03bd , whose\nrank drops at p if and only if p lies on the surface.\nTheorem 3.4.1 (Thm. 3.3.10). Suppose that X := Proj(A/I) \u2282 T has at most dimension\n0 and is locally a complete intersection. Let \u03b3 = inf{\u03bc : (\u03c9A\u2228 )\u03bc = 0}, be as in (3.9) and\n\u03bd0 = 2d\u2212\u03b3. For any integer \u03bd \u2265 \u03bd0 the determinant D of the complex (Z\u2022 )\u03bd of K[T ]-modules\ndefines (up to multiplication with a constant) the same non-zero element in K[X] and\nD = F deg(\u03c6)\nwhere F is the implicit equation of S .\n\n66\n\n\fBy Theorem 3.3.8, one can replace the bound in this result by the more precise bound\n\u03bd0 = max{d \u2212 \u03b3, 2d + 1 \u2212 indeg(Hm0 (\u03c9A /I.\u03c9A ))} if there is at least one base point.\nBy [GKZ94, Appendix A], as mentioned in Chapter 1, the determinant D can be computed\neither as an alternating sum of subdeterminants of the differentials in Z\u03bd or as the greatest\ncommon divisor of the maximal-size minors of the matrix M associated to the first map\n(Z1 )\u03bd \u2192 (Z0 )\u03bd . Note that this matrix is nothing else than the matrix M\u03bd of linear syzygies\nas described in the introduction; it can be computed with the same algorithm as in [BD07]\nby solving the linear system given by the degree \u03bd0 part of (3.11), cf. Chapter 8. As an\nimmediate corollary we deduce the following very simple translation of Theorem 3.3.10,\nwhich can be considered the main result of this section.\nCorollary 3.4.2. Let \u03c6 : T 99K P3 be a rational parametrization of the surface S \u2282 P3\ngiven by \u03c6 = (h0 : h1 : h2 : h3 ) with hi \u2208 A. Let M\u03bd be the matrix of linear syzygies of\nh0 , . . . , h3 in degree \u03bd \u2265 2d \u2212 \u03b3, i.e. the matrix of coefficients of a K-basis of Syz(\u03c6)\u03bd with\nrespect to a K-basis of A\u03bd . If \u03c6 has only finitely many base points, which are local complete\nintersections, then M\u03bd is a representation matrix for the surface S .\nWe should also remark that by [KD06, Prop. 1] (or [Cox01, Appendix]) the degree of the\nsurface S can be expressed in terms of the area of the Newton polytope and the HilbertSamuel multiplicities of the base points:\nX\ndeg(\u03c6)deg(S ) = Area(N (f )) \u2212\nep\n(3.12)\np\u2208V (h0 ,...,h3 )\u2282T\n\nwhere Area(N (f )) is twice the Euclidean area of N (f ), i.e. the normalized area of the\npolygon. For locally complete intersections, the multiplicity ep of the base point p is just\nthe vector space dimension of the local quotient ring at p.\n\n3.5 The special case of biprojective surfaces\nBihomogeneous parametrizations, i.e. the case T = P1 \u00d7 P1 , are particularly important\nin practical applications, so we will now make explicit the most important constructions in\nthat case and make some refinements.\nIn this section, we consider a rational parametrization of a surface S\nf\n\nP1 \u00d7 P1 99K P3\n(s : u) \u00d7 (t : v) 7\u2192 (f0 : f1 : f2 : f3 )(s, u, t, v)\n\n67\n\n\fwhere the polynomials f0 , . . . , f3 are bihomogeneous of bidegree (e1 , e2 ) with respect to the\nhomogeneous variable pairs (s : u) and (t : v), and e1 , e2 are positive integers. We make the\nsame assumptions as in the general toric case. Let d = gcd(e1 , e2 ), e01 = ed1 , and e02 = ed2 .\nSo we assume that the Newton polytope N (f ) is a rectangle of length e1 and width e2 and\nN 0 (f ) is a rectangle of length e01 and width e02 .\nSo P1 \u00d7 P1 can be embedded in Pm , m = (e01 + 1)(e02 + 1) \u2212 1 through the Segre-Veronese\nembedding \u03c1 = \u03c1e1 ,e2\n\u03c1\n\nP1 \u00d7 P1 ,\u2192 Pm\n0\n0\n(s : u) \u00d7 (t : v) 7\u2192 (. . . : si ue1 \u2212i tj v e2 \u2212j : . . .)\nWe denote by T its image, which is an irreducible surface in Pm , whose ideal J is generated\nby quadratic binomials. We have the following commutative diagram.\nf\nP1 \u00d7 P1 _ _ _v:/ P3\nv\n\u03c1\n\n\u000f v\n\n(3.13)\n\nv\nv \u03c6\n\nT\n\nwith \u03c6 = (h0 : . . . : h3 ), the hi being polynomials in the variables T0 , . . . , Tm of degree d.\nWe denote by A = K[T0 , . . . , Tm ]/J the homogeneous coordinate ring of T . We can give\nan alternative construction of the coordinate ring (cf. Section 2.4). Consider the N-graded\nK-algebra\nM\n\u0001\nK[s, u]ne01 \u2297K K[t, v]ne02 \u2282 K[s, u, t, v]\nS :=\nn\u2208N\n\nwhich is finitely generated by S1 as L\nan S0 -algebra. Then P1L\n\u00d7 P1 is the bihomogeneous\nspectrum Biproj(S) of S, since Proj( n\u2208N K[s, u]ne01 ) = Proj( n\u2208N K[t, v]ne02 ) = P1 . Write\nT i,j := T(e02 +1)i+j for i = 0, . . . , e01 and j = 0, . . . , e02 . The Segre-Veronese embedding \u03c1\ninduces an isomorphism of N-graded K-algebras\n\u03b8\n\nA \u2192\n\u2212 S\n0\n0\ni,j\nT\n7\u2192 si ue1 \u2212i tj v e2 \u2212j .\nThe implicit equation of S can be obtained by the method of approximation complexes by\ncomputing the kernel of the map\nK[X0 , . . . , X3 ] \u2192 A\nXi 7\u2192 hi\n\n68\n\n\fThe ring A is an affine normal semigroup ring and it is Cohen-Macaulay. It is Gorenstein if\nand only if e01 = e02 = 1 (or equivalently e1 = e2 ), which is the case treated in [BD07]. The\nideal J is easier to describe than in the general toric case (compare [Sul08, 6.2] for the case\ne02 = 2). The generators of J can be described explicitly. Denote\n\u0012 i,0\n\u0013\n0\nT\n. . . T i,e2 \u22121\nAi :=\n,\n0\nT i,1 . . . T i,e2\nthen the ideal J is generated by the 2-minors of the 4 \u00d7 e01 e02 -matrix below built from the\nmatrices Ai :\n\u0013\n\u0012\nA0 . . . Ae01 \u22121\n.\n(3.14)\nA1 . . . Ae01\nThe degree formula for this setting, which is a direct corollary of (3.12):\nX\ndeg(\u03c6)deg(S ) = 2e1 e2 \u2212\nep\np\u2208V (h0 ,...,h3 )\u2282T\n\nwhere as before ep is the multiplicity of the base point p.\nWe claim that it is better to choose the toric variety defined by N 0 (f ) instead of N (f ).\nLet us now give some explanations why this is the case. As we have seen, a bihomogeneous\nparametrization of bidegree (e1 , e2 ) gives rise to the toric variety T = P1 \u00d7P1 determined by\na rectangle of length e01 and width e02 , where e0i = edi , d = gcd(e1 , e2 ), and whose coordinate\nring can be described as\nM\n\u0001\nS :=\nK[s, u]ne01 \u2297K K[t, v]ne02 \u2282 K[s, u, t, v]\nn\u2208N\n\nInstead of this embedding of P1 \u00d7 P1 we could equally choose the embedding defined by\nN (f ), i.e. a rectangle of length e1 and width e2 , in which case we obtain the following\ncoordinate ring\nM\n\u015c :=\n(K[s, u]ne1 \u2297K K[t, v]ne2 ) \u2282 K[s, u, t, v]\nn\u2208N\n\nIt is clear that this ring also defines P1 \u00d7 P1 and we obviously have an isomorphism\n\u015cn ' Sd*n\nbetween the graded parts of the two rings, which means that the grading of \u015c is coarser\nand contains less information. It is easy to check that the above isomorphism induces an\n\n69\n\n\fisomorphism between the corresponding graded parts of the approximation complexes Z\u2022\ncorresponding to S and \u1e90\u2022 corresponding to \u015c, namely\n\u1e90\u03bd ' Zd*\u03bd\nIf the optimal bound in Theorem 3.3.10 for the complex Z is a multiple of d, i.e. \u03bd0 = d * \u03b7,\nthen the optimal bound for \u1e90 is \u03bd\u03020 = \u03b7 and we obtain isomorphic complexes in these degrees\nand the matrix sizes will be equal in both cases. If not, the optimal bound \u03bd\u03020 is the smallest\ninteger bigger than \u03bdd0 and in this case, the vector spaces in \u1e90\u03bd\u03020 will be of higher dimension\nthan their counterparts in Z\u03bd0 and the matrices of the maps will be bigger. An example of\nthis is given in the next section.\n\n3.6 Examples\nExample 3.6.1. We first treat some examples from [KD06]. Example 10 in the cited paper,\nwhich could not be solved in a satisfactory manner in [BD07], is a surface parametrized by\nf0\nf1\nf2\nf3\n\n=\n=\n=\n=\n\n(t + t2 )(s \u2212 1)2 + (\u22121 \u2212 st \u2212 s2 t)(t \u2212 1)2\n(t + t2 )(s \u2212 1)2 + (1 + st \u2212 s2 t)(t \u2212 1)2\n(\u2212t \u2212 t2 )(s \u2212 1)2 + (\u22121 + st + s2 t)(t \u2212 1)2\n(t \u2212 t2 )(s \u2212 1)2 + (\u22121 \u2212 st + s2 t)(t \u2212 1)2\n\nThe Newton polytope N 0 (f ) of this parametrization is\n3\nb\n\nb\n\n2b\n1\nb\n\n0b\n0\n\n1\n\n2\n\nWe can compute the new parametrization over the associated variety, which is given by\nlinear forms h0 , . . . , h3 , i.e. d = 1 (since there is no smaller homothety N 0 (f ) of N (f )) and\nthe coordinate ring is A = K[T0 , . . . , T8 ]/J where J is generated by 21 binomials of degrees 2\n\n70\n\n\fand 3. Recall that the 9 variables correspond to the 9 integer points in the Newton polytope.\nIn the optimal degree \u03bd0 = 1 as in Theorem 3.3.8, the implicit equation of degree 5 of the\nsurface S is represented by a 9 \u00d7 14-matrix, compared to a 15 \u00d7 15-matrix with the toric\nresultant method (from which a 11 \u00d7 11-minor has to be computed) and a 5 \u00d7 5-matrix with\nthe method of moving planes and quadrics. Note also that this is a major improvement of\nthe method in [BD07], where a 36 \u00d7 42-matrix representation was computed for the same\nexample.\nExample 3.6.2. Example 11 of [KD06] is similar to Example 10 but an additional term is\nadded, which transforms the point (1, 1) into a non-LCI base point. The parametrization is\n\nf0\n\n=\n\nf1\n\n=\n\nf2\n\n=\n\nf3\n\n=\n\n(t + t2 )(s \u2212 1)2 + (\u22121 \u2212 st \u2212 s2 t)(t \u2212 1)2 + (t + st + st2 )(s \u2212 1)(t \u2212 1)\n(t + t2 )(s \u2212 1)2 + (1 + st \u2212 s2 t)(t \u2212 1)2 + (t + st + st2 )(s \u2212 1)(t \u2212 1)\n\n(\u2212t \u2212 t2 )(s \u2212 1)2 + (\u22121 + st + s2 t)(t \u2212 1)2 + (t + st + st2 )(s \u2212 1)(t \u2212 1)\n(t \u2212 t2 )(s \u2212 1)2 + (\u22121 \u2212 st + s2 t)(t \u2212 1)2 + (t + st + st2 )(s \u2212 1)(t \u2212 1)\n\nThe Newton polytope has not changed, so the embedding as a toric variety and the coordinate ring A are the same as in the previous example. Again the new map is given by\nh0 , . . . , h3 of degree 1.\nAs in [KD06], the method represents (with \u03bd0 = 1) the implicit equation of degree 5 times\na linear extraneous factor caused by the non-LCI base point. While the Chow form method\nrepresents this polynomial as a 12 \u00d7 12-minor of a 15 \u00d7 15-matrix, our representation matrix\nis 9 \u00d7 13. Note that in this case, the method of moving lines and quadrics fails.\nExample 3.6.3. In this example, we will see that if the ring A is not Gorenstein, the\ncorrection term for \u03bd0 is different from indeg(I sat ), unlike in the homogeneous and the\nunmixed bihomogeneous cases. Consider the parametrization\nf0\nf1\nf2\nf3\n\n=\n=\n=\n=\n\n(s2 + t2 )t6 s4 + (\u22121 \u2212 s3 t4 \u2212 s4 t4 )(t \u2212 1)5 (s2 \u2212 1)\n(s2 + t2 )t6 s4 + (1 + s3 t4 \u2212 s4 t4 )(t \u2212 1)5 (s2 \u2212 1)\n(\u2212s2 \u2212 t2 )t6 s4 + (\u22121 + s3 t4 + s4 t4 )(t \u2212 1)5 (s2 \u2212 1)\n(s2 \u2212 t2 )t6 s4 + (\u22121 \u2212 s3 t4 + s4 t4 )(t \u2212 1)5 (s2 \u2212 1)\n\nWe will consider this as a bihomogeneous parametrization of bidegree (6, 9), that is we\nwill choose the embedding \u03c1 corresponding to a rectangle of length 2 and width 3. The\n\n71\n\n\factual Newton polytope N (f ) is smaller than the (6, 9)-rectangle, but does not allow a\nsmaller homothety. One obtains A = K[T0 , . . . , T11 ]/J, where J is generated by 43 quadratic\nbinomials and the associated hi are of degree d = 3. It turns out that \u03bd0 = 4 is the\nlowest degree such that the implicit equation of degree 46 is represented as determinant\nof Z\u03bd0 , the matrix of the first map being of size 117 \u00d7 200. So we cannot compute \u03bd0 as\n2d \u2212 indeg(I sat ) = 6 \u2212 3 = 3, as one might have been tempted to conjecture based on the\nresults of the homogeneous case. This is of course due to A not being Gorenstein, since the\nrectangle contains two interior points.\n\nLet us make a remark on the computation of the representation matrix. It turns out that\nthis is highly efficient. Even if we choose the non-optimal bound \u03bd = 6 as given in Theorem\n3.3.10, the computation of the 247 \u00d7 518 representation matrix is computed instantaneously\nin Macaulay2. Just to give an idea of what happens if we take higher degrees: For \u03bd = 30 a\n5551 \u00d7 15566-matrix is computed in about 30 seconds, and for \u03bd = 50 we need slightly less\nthan 5 minutes to compute a 15251 \u00d7 43946 matrix.\n\nIn any case, the computation of the matrix is relatively cheap and the main interest in lowering the bound \u03bd0 as much as possible is the reduction of the size of the matrix, not the time\nof its computation. This reduction improves the performance of algorithmic applications of\nour approach, notably to decide whether a given point lies in the parametrized surface.\n\nExample 3.6.4. In the previous example, we did not fully exploit the structure of N (f )\nand chose a bigger polygon for the embedding. Here is an example where this is necessary\nto represent the implicit equation without extraneous factors. Take (f0 , f1 , f2 , f3 ) = (st6 +\n2, st5 \u2212 3st3 , st4 + 5s2 t6 , 2 + s2 t6 ). This is a very sparse parametrization and we have N (f ) =\nN 0 (f ). The coordinate ring is A = K[T0 , . . . , T5 ]/J, where J = (T32 \u2212 T2 T4 , T2 T3 \u2212 T1 T4 , T22 \u2212\nT1 T3 , T12 \u2212 T0 T5 ) and the new base-point-free parametrization \u03c6 is given by (h0 , h1 , h2 , h3 ) =\n(2T0 + T4 , \u22123T1 + T3 , T2 + 5T5 , 2T0 + T5 ). The Newton polytope N (f ) looks as follows.\n\n72\n\n\f6\nb\n\nb\n\n5\n4\n3\n2\n1\n0b\n0\n\n1\n\n2\n\nFor \u03bd0 = 2d = 2 we can compute the matrix of the first map of (Z\u2022 )\u03bd0 , which is a 17 \u00d7 34matrix. The greatest common divisor of the 17-minors of this matrix is the homogeneous\nimplicit equation of the surface; it is of degree 6 in the variables X0 , . . . , X3 :\n2809X02 X14 + 124002X16 \u2212 5618X03 X12 X2 + 66816X0 X14 X2 + 2809X04 X22\n\u221250580X02 X12 X22 + 86976X14 X22 + 212X03 X23 \u2212 14210X0 X12 X23 + 3078X02 X24\n+13632X12 X24 + 116X0 X25 + 841X26 + 14045X03 X12 X3 \u2212 169849X0 X14 X3\n\u221214045X04 X2 X3 + 261327X02 X12 X2 X3 \u2212 468288X14 X2 X3 \u2212 7208X03 X22 X3\n+157155X0 X12 X23 X3 \u2212 31098X02 X23 X3 \u2212 129215X12 X23 X3 \u2212 4528X0 X24 X3\n\u221212673X25 X3 \u2212 16695X02 X12 X32 + 169600X14 X32 + 30740X03 X2 X32\n\u2212433384X0 X12 X2 X32 + 82434X02 X22 X32 + 269745X12 X22 X32 + 36696X0 X23 X32\n+63946X24 X32 + 2775X0 X12 X33 \u2212 19470X02 X2 X34 + 177675X12 X2 X33\n\u221285360X0 X22 X33 \u2212 109490X23 X33 \u2212 125X12 X34 + 2900X0 X2 X34\n+7325X22 X34 \u2212 125X2 X35\nAs in Example 3.6.3 we could have considered the parametrization as a bihomogeneous map\neither of bidegree (2, 6) or of bidegree (1, 3), i.e. we could have chosen the corresponding\nrectangles instead of N (f ). This leads to more complicated coordinate rings (20 resp. 7\nvariables and 160 resp. 15 generators of J) and to bigger matrices (of size 21 \u00d7 34 in both\ncases). Even more importantly, the parametrizations will have a non-LCI base point and the\nmatrices do not represent the implicit equation but a multiple of it (of degree 9). Instead,\nif we consider the map as a homogeneous map of degree 8, the results are even worse: For\n\u03bd0 = 6, the 28 \u00d7 35-matrix M\u03bd0 represents a multiple of the implicit equation of degree 21.\n\n73\n\n\fTo sum up, in this example the toric version of the method of approximation complexes\nworks well, whereas it fails over P1 \u00d7P1 and P2 . This shows that the extension of the method\nto toric varieties really is a generalization and makes the method applicable to a larger class\nof parametrizations.\nInterestingly, we can even do better than with N (f ) by choosing a smaller polytope. The\nphilosophy is that the choice of the optimal polytope is a compromise between two criteria:\n\u2022 The polytope should be as simple as possible in order to avoid that the ring A becomes\ntoo complicated.\n\u2022 The polytope should respect the sparseness of the parametrization (i.e. be close to\nthe Newton polytope) so that no base points appear which are not local complete\nintersections.\nSo let us repeat the same example with another polytope Q, which is small enough to reduce\nthe size of the matrix but which only adds well-behaved (i.e. local complete intersection)\nbase points:\n3b\nb\n\n2\n1\n0b\n0\n\n1\n\nThe Newton polytope N (f ) is contained in 2 * Q, so the parametrization will factor through\nthe toric variety associated to Q, more precisely we obtain a new parametrization defined\nby\n(h0 , h1 , h2 , h3 ) = (2T02 + T3 T4 , \u22123T0 T4 + T2 T4 , T1 T4 + 5T42 , 2T02 + T42 )\nover the coordinate ring A = K[T0 , . . . , T4 ]/J with J = (T22 \u2212 T1 T3 , T1 T2 \u2212 T0 T3 , T12 \u2212 T0 T2 ).\nThe optimal bound is \u03bd0 = 2 and in this degree the implicit equation is represented directly\nwithout extraneous factors by a 12 \u00d7 19-matrix, which is smaller than the 17 \u00d7 34 we had\nbefore.\n\n74\n\n\fExample 3.6.5. As we have seen, the size of the matrix representation depends on the\ngiven parametrization and as a preconditioning step it is often advantageous to choose a\nsimpler parametrization of the same surface, if that is possible. For example, approaches\nsuch as [Sch03] can be used to find a simpler reparametrization of the given surface and\noptimize the presented methods.\nAnother important factor to consider is that all the methods we have seen represent the\nimplicit equation to the power of the degree of the parametrization. On one hand, it can\nbe seen as an advantage that this piece of geometric information is encoded in the matrix\nrepresentation, but on the other hand, for certain applications one might be willing to\nsacrifice the information about the parametric degree in order to obtain smaller matrices.\nIf this is the case, there exist (for certain surface parametrizations) algorithms to compute\na proper reparametrization of the surface, e.g. [PD06], and in these cases it is highly\nadvisable to do so before computing the matrix representation, because this will allow us to\nrepresent the implicit equation directly instead of one of its powers, and the matrices will\nbe significantly smaller. Let us illustrate this with Example 2 from [PD06], which treats a\nparametrization f defined by\nf0\nf1\nf2\nf3\n\n=\n=\n=\n=\n\n(t4 + 2t2 + 5)(s4 + 1)\n(s4 t4 + 2s4 t2 + 5s4 + 2t4 + 4t2 + 11)(s4 + 1)\n(s4 t4 + 2s4 t2 + 5s4 + t4 + 2t2 + 6)\n\u2212(s4 t4 + 2s4 t2 + 5s4 + t4 + 2t2 + 3)(s4 + 1)\n\nThis is a parametrization of bidegree (8, 4) and its Newton polytope is the whole rectangle\nof length 8 and width 4, so we can apply the method of approximation complexes for P1 \u00d7P1 .\nWe obtain a matrix of size 45 \u00d7 59 representing FS16 , where\nFS = 2X0 X1 \u2212 X1 X2 \u2212 3X0 X3 \u2212 2X1 X3 + 3X32\nis the implicit equation and deg(f ) = 16. Using the algorithm presented in [PD06] one can\ncompute the following proper reparametrization of the surface S :\nf0\nf1\nf2\nf3\n\n=\n=\n=\n=\n\n(t \u2212 5)(s \u2212 1)\n\u2212(11 + st \u2212 5s \u2212 2t)(s \u2212 1)\n6 \u2212 t \u2212 5s + st\n(\u2212t + st \u2212 5s + 3)(s \u2212 1)\n\nThis parametrization of bidegree (2, 1) represents FS directly by a 6 \u00d7 11-matrix.\n\n75\n\n\f3.7 Final remarks\nRepresentation matrices can be efficiently constructed by solving a linear system of relatively\nsmall size (in our case dimK (A\u03bd+d ) equations in 4dimK (A\u03bd ) variables). This means that their\ncomputation is much faster than the computation of the implicit equation and they are thus\nan interesting alternative as an implicit representation of the surface.\nIn this chapter, we have extended the method of matrix representations by linear syzygies to\nthe case of rational surfaces parametrized over toric varieties (and in particular to bihomogeneous parametrizations). This generalization provides a better understanding of the method\nthrough the use of combinatorial commutative algebra. From a practical point of view, it\nis also a major improvement, as it makes the method applicable for a much wider range of\nparametrizations (for example, by avoiding unnecessary base points with bad properties)\nand leads to significantly smaller representation matrices. Let us sum up the advantages\nand disadvantages compared to other techniques to compute matrix representations (e.g.\nthe ones introduced in [KD06]). The most important advantages are:\n\u2022 The method works in a very general setting and makes only minimal assumptions on\nthe parametrization. In particular, it works well in the presence of base points.\n\u2022 Unlike the method of toric resultants, we do not have to extract a maximal minor of\nunknown size, since the matrices are generically of full rank.\n\u2022 The structure of the Newton polytope of the parametrization is exploited, so one\nobtains much better results for sparse parametrizations, both in terms of computation\ntime and in terms of the size of the representation matrix. Moreover, it subsumes\nthe known method of approximation complexes in the case of dense homogeneous\nparametrizations, in which case the methods coincide.\nDisadvantages of the method are the following.\n\u2022 Unlike with the toric resultant or the method of moving planes and surfaces, the\nmatrix representations are not square.\n\u2022 The matrices involved are generally bigger than with the method of moving planes\nand surfaces.\nIt is important to remark that those disadvantages are inherent to the choice of the method:\nA square matrix built from linear syzygies does not exist in general and it is an automatic\nconsequence that if one only uses linear syzygies to construct the matrix, it has to be bigger\nthan a matrix which also uses entries of higher degree. The choice of the method to use\n\n76\n\n\fdepends very much on the given parametrization and on what one needs to do with the\nmatrix representation.\n\n77\n\n\f\f4 Implicit equations of toric\nhypersurfaces in multiprojective space\nby means of an embeddings\n4.1 Introduction\nThe aim of this chapter is to compute the implicit equation of a hypersurface in (P1 )n ,\nparametrized by a toric variety. Assume we are given by a map\n\u0012\n\u0013\nf1\nfn\nn\u22121\nn\nf :A\n99K A : s := (s1 , . . . , sn\u22121 ) 7\u2192\n,...,\n(s),\n(4.1)\ng1\ngn\nwhere deg(fi ) = di and deg(gi ) = ei , and fi , gi without common factors for all i = 1, . . . n.\nIn Chapter 3 we studied the case where g1 = * * * = gn . In all cases, we can reduce in\ntheory all problems to this setting, by taking common denominator. However, there is also\na big spectrum of problems that are not well adapted to taking a common denominator.\nTypically this process enlarges the base locus of f . This also increases the number of\nmonomials and increasing the degree of the polynomials which could imply having a \"worse\"\ncompactification of the domain, forcing an embedding into a bigger projective space. For\nthese many reasons, taking common denominator could be considerably harmful for the\nalgorithmic approach.\nIn order\n\uf8fc more general parametrizations given by rational maps of the form\n\uf8f1 to consider\nf\nf\nf = \uf8f3 g11 , . . . , gnn \uf8fe with different denominators g1 , . . . , gn , we develop in this chapter the\nstudy of the (P1 )n compactification of the codomain. With this approach, we generalize, in\nthe spirit of [Bot09b], the method of implicitization of projective hypersurfaces embedded\nin (P1 )n to general hypersurfaces parametrized by any (n \u2212 1)-dimensional arithmetically\nCohen-Macaulay closed subscheme of PN . As in the mentioned articles, we compute the\nimplicit equation as the determinant of a complex, which coincides with the gcd of the\n\n79\n\n\fmaximal minors of the last matrix of the complex, and we give a deep study of the geometry\nof the base locus.\nSection 5.1 is devoted to the algorithmic approach of both cases studied in Chapter 3 and\n4. We show how to compute the dimension of the representation matrices obtained in both\ncases by means of the Hilbert functions of the ring A and its Koszul cycles. In the last part\nof this chapter, we show, for the case of toric parametrizations given from a polytope N (f )\n(cf. 3.2.1), how the interplay between homotheties of N (f ) and degree of the maps may\nlead to have smaller matrices.\nWe conclude by giving in section 5.2 several examples. First, we show in a very sparse\nsetting the advantage of not considering the homogeneous compactification of the domain\nwhen denominators are very different. We extend in the second example this idea to the\ncase of a generic affine rational map in dimension 2 with fixed Newton polytope. In the last\nexample we give, for a parametrized toric hypersurface of (P1 )n , a detailed analysis of the\nrelation between the nature of the base locus of a map and the extra factors appearing in\nthe computed equation.\n\n4.2 General setting\nThroughout this section, as in the previous chapter, we will write Ak := Spec(K[T1 , . . . , Tk ])\nfor the k-dimensional affine space over K. Assume we are given a rational map\n\u0013\n\u0012\nfn\nf1\nn\u22121\nn\n,...,\n(s)\n(4.2)\nf :A\n99K A : s := (s1 , . . . , sn\u22121 ) 7\u2192\ng1\ngn\nwhere deg(fi ) = di and deg(gi ) = ei without common factors. Observe that this setting is\ngeneral enough to include all classical implicitization problems. We consider in this chapter\nthe same toric compactification T of Chapter 3, but a different one for An : (P1 )n .\nAs in Chapter 3, we assume T can be embedded into some PN , and set A for the homogeneous coordinate ring of T . Since An\u22121 is irreducible, so is T , hence A is a domain. The\nmap (4.2) gives rise to a toric variety T on the domain (cf. Charpter 2 and 3) associated\nto the following polytope N (f ). Recall from Definition 3.2.1 that we will write\n!\nn\n[\nN (f ) := conv\n(N (fi ) \u222a N (gi ))\ni=1\n\n80\n\n\fthe convex hull of the union of the Newton polytopes of all the polynomials defining the\nmap f .\nRecall that the polytope N (f ) defines a (n \u2212 1)-dimensional projective toric variety T\nprovided with an ample line bundle which defines an embedding: for N = #(N (f )\u2229Zn\u22121 )\u22121\nwe can write T \u2286 PN (cf. Chapter 2 and Chapter 3). Write \u03c1 for the embedding determined\nby this ample line bundle. We get that the map\n\u03c1\n\n(A\u2217 )n\u22121 ,\u2192 PN : (s) 7\u2192 (. . . : s\u03b1 : . . .),\n\n(4.3)\n\nwhere \u03b1 \u2208 N (f ) \u2229 Zn\u22121 , factorizes f through a rational map with domain T . Hence, take\nT \u2282 PN the toric embedding obtained from N (f ) (according to Definition 3.2.1). The\nmulti-projective compactification of An is given by\n\u03b9\n\nAn ,\u2192 (P1 )n : (x1 , . . . , xn ) 7\u2192 (x1 : 1) \u00d7 * * * \u00d7 (xn : 1).\n\n(4.4)\n\nThus, f compactifies via \u03c1 and \u03b9 through T to \u03c6 : T 99K (P1 )n making the following\ndiagram commute:\n(A\u2217 )\u007f n\u22121\n\nf\n\n_\n\n/\n\nAn\u007f _\n\n\u03c1\n\n\u000f\n\n\u03c6\n\n\u000f\n\n(4.5)\n\n\u03b9\n\nT _ _ _ _/ (P1 )n\nThat is, \u03b9 \u25e6 f = \u03c6 \u25e6 \u03c1. We will consider henceforward in this chapter rational maps \u03c6 : T 99K\n(P1 )n , as defined in (4.5).\n\n4.3 Tools from homological algebra\nWe present here some basic tools of commutative algebra we will need for our purpose.\nRecall that in this chapter A = K[T0 , . . . , TN ]/J is the CM graded coordinate ring of an\n(n \u2212 1)-dimensional projective arithmetically Cohen Macaulay closed scheme T defined by\nJ in PN . Set T := T0 , . . . , TN the variables in PN , and X the sequence X1 , Y1 , . . . , Xn , Yn ,\nof variables in (P1 )n . Write m := A+ = (T) \u2282 A for the maximal irrelevant homogeneous\nideal of A. Denote R = A \u2297K K[X1 , Y1 , . . . , Xn , Yn ]. Assume we are given fi , gi , for\ni = 1, . . . , n, n pairs of homogeneous polynomials in A without common factors, satisfying\ndeg(fi ) = deg(gi ) = di for all i.\nWe associate to each pair of homogeneous polynomials fi , gi a linear form Li := Yi fi \u2212Xi gi in\nthe ring R := A[X] of bidegree (di , 1). Write K\u2022 for the Koszul complex K\u2022 (L1 , . . . , Ln ; R),\n\n81\n\n\fn\nassociated\nL to the sequence L1 , . . . , Ln and coefficients in R. The N -graded K-algebra B :=\ncoker( i R(\u2212di , \u22121) \u2192 R) is the multihomogeneous\ncoordinate ring of the incidence scheme\nN\n\u223c\n\u0393 = \u0393\u03a9 . It can be easily observed that B = A SymA (I (i) ) \u223c\n= R/(L1 , . . . , Ln ).\n\nWe defined in Section 1.5 approximation complexes. We will remark here the relation between approximation complexes and Koszul complex. Precisely, take f and g two homogeneous elements in A of degree d, and take A[X, Y ] the polynomial rings in two variables and\ncoefficients in A. According to the notation above, define L := Y * f \u2212 X * g \u2208 Ad [X, Y ]1 .\nProposition 4.3.1. If the sequence {f, g} is regular in A, then there exists a bigraded\nisomorphism of complexes Z\u2022 (f, g) \u223c\n= K\u2022 (L; A[X, Y ]).\nProof. Given the sequence {f, g} the approximation complex is:\n(x,y)\n\nZ\u2022 (f, g) : 0 \u2192 Z1 [d] \u2297A A[X, Y ](\u22121) \u2212\u2192 Z0 \u2297A A[X, Y ] \u2192 0.\nAs the sequence {f, g} is regular, H1 (K\u2022A (f, g)) = 0. Hence Z1 = (\u2212g, f )A \u223c\n= A by the\nA\nisomorphism a \u2208 A 7\u2192 (\u2212g * a, f * a) \u2208 Z1 , given by the left-most map of K\u2022 (f, g). Tensoring with A[X, Y ] we get an isomorphism of A-modules, Z1 \u223c\n= A[X, Y ]. Write K\u2022 for\nK\u2022 (L; A[X, Y ]), [\u2212] for the degree shift on the grading on A and (\u2212) the shift on X, Y . The\ncommutativity of the diagram\nZ\u2022 : 0\n\n/ Z1 [d] \u2297A\n\nA[X,\nY ](\u22121)\nO\n\n(x,y)\n\n\u03c8\u2297A 1A[X,Y ]\n\nK\u2022 : 0\n\n/ A[X, Y ][\u2212d](\u22121)\n\n/ Z0 [d] \u2297A\nO\n\nA[X, Y ]\n\n/0\n\n=\nL\n\n/ A[X, Y ]\n\n/ 0,\n\nshows that Z\u2022 (f, g) \u223c\n= K\u2022 (L; A[X, Y ])\nKeeping the same notation, we conclude the following result:\nCorollary 4.3.2. If the sequence {fi , gi } is regular for all i = 1, . . . , n. Then, there is an\nisomorphism of A-complexes\nn\nO\ni=1\n\nZ\u2022 (fi , gi ) \u223c\n= K\u2022 (L1 , . . . , Ln ; A[X]).\n\nThis fact corresponds to the idea that a map \u03c6 : T 99K (P1 )n is like having n maps\n\u03c6i : T 99K P1 given by each pair \u03c6i = (fi : gi ) whose product gives \u03c6. Each \u03c6i gives a map\nof rings \u03c6\u2217i : K[Xi , Yi ] \u2192 A whose tensor product gives \u03c6\u2217 .\n\n82\n\n\fRemark 4.3.3. Observe also that if the sequence L1 , . . . , Ln is regular in A[X], then\nK\u2022 (L1 , . . . , Ln ; A[X]) provides a resolution of B, that is H0 (K\u2022 ) = B.\nAs a consequence of Remark 4.3.3 and of Corollary 4.3.2, we can forget about approximation\ncomplexes all along this chapter, and focus on Koszul complexes.\nIn order to compute the representation matrix M\u03bd and the implicit equation of \u03c6, we need\nto be able to get acyclicity conditions for K\u2022 . Indeed, consider the following matrix\n\uf8eb\n\uf8f6\n\u2212g1 0 * * *\n0\n\uf8ec f1 0 * * *\n0 \uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n.. . .\n.. \uf8f7 \u2208 M at (A).\n\u039e = \uf8ec ...\n(4.6)\n.\n2n,n\n.\n. \uf8f7\n\uf8ec\n\uf8f7\n\uf8ed 0 0 * * * \u2212gn \uf8f8\n0 0 * * * fn\nHenceforward, we will write Ir := Ir (\u039e) for the ideal of A generated by the r \u00d7 r minors of\n\u039e, for 0 \u2264 r \u2264 r0 := min{n + 1, m}, and define I0 := A and Ir := 0 for r > r0 .\nA theorem due to L. Avramov gives necessary and sufficient conditions for (L1 , . . . , Ln ) to\nbe a regular sequence in R in terms of the depth the ideals of minors Ir . Precisely:\nTheorem 4.3.4 ([Avr81, Prop. 1]). The ideal (L1 , . . . , Ln ) is a complete intersection in R\nif and only if for all r = 1, . . . , n, codimA (Ir ) \u2265 n \u2212 r + 1.\nLn\nThe matrix (4.6) defines a map of A-modules \u03c8 : An \u2192 A2n \u223c\n= i=1 A[xi , yi ]1 , we verify that\nthe symmetric algebra SymA (coker(\u03c8)) \u223c\n= A[X]/(L1 , . . . , Ln ). Since SymA (coker(\u03c8)) = B\nis naturally multigraded, it can be seen as a subscheme of T \u00d7 (P1 )n . This embedding is\ndetermined by the natural projection A[X] \u2192 A[X]/(L1 , . . . , Ln ). In fact, the graph of \u03c6 is\nan (n \u2212 1)-dimensional irreducible component of Proj(SymA (coker(\u03c8))) \u2282 T \u00d7 (P1 )n which\nis a projective fiber bundle outside the base locus of \u03c6 in T .\nOur aim is to show that under certain conditions on the Li and on the ideals Ii , there exist an\nelement in K[X] that vanishes whenever L1 , . . . , Ln have a common root in T (cf. Theorems\n4.4.2 and 4.4.11). This polynomial coincides with the sparse resultant ResT (L1 , . . . , Ln ).\nWe will see that it is not irreducible in general, in fact, it is not only a power of the implicit\nequation, it can also have some extraneous factors, while the generic sparse resultant is\nalways irreducible. Those factors come from some components of the base locus of \u03c6 which\nare not necessarily a common root of all Li : it is enough that one of them vanishes at some\npoint p of T to obtain a base point of \u03c6. We will give sufficient conditions for avoiding\nextraneous factors.\n\n83\n\n\fWe compute the implicit equation of the closed image of \u03c6 as a factor of the determinant\nof (K\u2022 )(\u03bd,\u2217) , for certain degree \u03bd in the grading of A. As in [BDD09] the last map of this\ncomplex of vector spaces is a matrix M\u03bd that represents the closed image of \u03c6. Thus, we\nfocus on the computation of the regularity of B in order to bound \u03bd. Recall from Equation\n(3.9) that \u03b3 := inf{\u03bc : (\u03c9A\u2228 )\u03bc = 0}.\nTheorem 4.3.5. Suppose that A is Cohen-Macaulay and K\u2022 is acyclic. Then\n!\nX\nHm0 (B)\u03bd = 0 for all \u03bd \u2265 \u03bd0 =\ndi \u2212 \u03b3.\ni\n\nProof. Write Kq for the q-th object in K\u2022 . Consider the two spectral sequences associated\nto the double complex Cm\u2022 (K\u2022 ), both converging to the hypercohomology of K\u2022 . As K\u2022 is\nacyclic the first spectral sequence stabilizes at the E2 -term. The second one has as E1 -term\np\n00 p\n1 Eq = Hm (Kq ).\nSince H0 (K\u2022 ) = B (cf. Remark 4.3.3), the comparison of the two spectral sequences shows\nthat Hm0 (B)\u03bd vanishes as soon as (1 00 Epp )\u03bd vanishes for all p. In fact we have\nend(Hm0 (B)) \u2264 max{end(1 00 Epp )} = max{end(Hmp (Kp ))}.\np\u22650\n\np\u22650\n\nIt remains to observe that, since Kp =\nover K,\nmax{end(Hmp (Kp ))}\np\u22650\n\n=\n\nL\n\ni1 ,...,ip\n\nA(\u2212\n\nPp\n\nj=1\n\ndij ) \u2297K K[X](\u2212p) and K[X] is flat\n\nmax{ max {end(Hmp (A(\u2212\np\u22650 i1 ,...,ip\n\np\nX\n\ndij )))}}.\n\nj=1\n\nHence, as A is CM, we have\nend(Hmp (Kp ))\n\n\u001a\n=\n\nend(Hmn (\u03c9A\u2228 (\u2212\n0\n\nP\n\ni\n\ndi ))) for p = n,\notherwise.\n\nFinally, since (Hmn (\u03c9A\u2228 ))\u03bd = 0 for all \u03bd \u2265 \u2212\u03b3, we get\nX\nX\nX\nend(Hmn (\u03c9A\u2228 (\u2212\ndi ))) = end(Hmn (\u03c9A\u2228 ))) +\ndi <\ndi \u2212 \u03b3.\ni\n\ni\n\ni\n\nIn order to compute the representation matrix \u039e\u03bd and the implicit equation of \u03c6, we will\nget acyclicity conditions for K\u2022 from L. Avramov's Theorem (cf. 4.3.4). As we mentioned\nabove, this theorem gives necessary and sufficient conditions for (L1 , . . . , Ln ) to be a regular\n\n84\n\n\fsequence in R in terms of the depth of certain ideals of minors of the matrix \u039e := (mij )i,j \u2208\nMat2n,n (A) defined in (4.6).\nRecall that Ir := Ir (\u039e) for the ideal of A generated by the r \u00d7 r minors of \u039e, for 0 \u2264 r \u2264\nr0 := min{n + 1, m}, and that I0 := A and Ir := 0 for r > r0 . The following result relates\nboth algebraic and geometric aspects. It gives conditions in terms of the ideals of minors Ir ,\nfor the complex to being acyclic, and on the equation given by the determinant of a graded\nbranch for describing the closed image of \u03c6.\n\n4.4 The implicitization problem\nHere we generalize the work in [Bot09b]. Hereafter in this chapter, let T be a (n \u2212 1)dimensional projective arithmetically Cohen Macaulay closed scheme over a field K, embedded in PN\nK , for some N \u2208 N. Write A = K[T0 , . . . , TN ]/J for its CM graded coordinate ring,\nand let J denote the homogeneous defining ideal of T . Set T := T0 , . . . , TN the variables in\nPN , and X the sequence X1 , Y1 , . . . , Xn , Yn , of variables in (P1 )n . Write m := A+ = (T) \u2282 A\nfor the maximal irrelevant homogeneous ideal of A.\nLet \u03c6 be a finite map over a relative open set U of T defining a hypersurface in Pn :\n\u03c6\n\nPN \u2283 T 99K (P1 )n : T 7\u2192 (f1 : g1 ) \u00d7 * * * \u00d7 (fn : gn )(T),\n\n(4.7)\n\nwhere fi and gi are homogeneous elements of A of degree di , for i = 1, . . . , n. As in the\nsection before, this map \u03c6 gives rise to a morphism of graded K-algebras in the opposite\nsense\n\u03c6\u2217\nK[X] \u2212\u2192 A : Xi 7\u2192 fi (T), Yi 7\u2192 gi (T).\n(4.8)\nSince ker(\u03c6\u2217 ) is a principal ideal in K[X], write H for a generator. We proceed as in [Bot09b]\nto get a matrix such that the gcd of its maximal minors equals H deg(\u03c6) , or a multiple of it.\n\nAssume that we are given a rational map like the one in (4.2) with deg(fi ) = deg(gi ) = di ,\ni = 1, . . . , n. Take T \u2282 PN the toric embedding obtained from N (f ) cf. Definition 3.2.1.\nRecall from 4.4 that the multi-projective compactification is given by\n\u03b9\n\nAn ,\u2192 (P1 )n : (x1 , . . . , xn ) 7\u2192 (x1 : 1) \u00d7 * * * \u00d7 (xn : 1).\n\n(4.9)\n\nAs before, f compactifies via \u03c1 and \u03b9 through T to \u03c6 : T 99K (P1 )n as defined in (4.7),\nthat is \u03b9 \u25e6 f = \u03c6 \u25e6 \u03c1.\n\n85\n\n\f4.4.1 The implicit equation\nIn this part we gather together the facts about acyclicity of the complex K\u2022 , and the\ngeometric interpretation of the zeroes of the ideals of minors Ir . We show that under suitable\nhypotheses no extraneous factor occurs. One very important difference from Chapter 3, is\nthat the base locus of \u03c6 has always codimension 2, instead of being zero-dimensional. This\nmakes slightly more complicated the well understanding of the geometry of the base locus,\nand hence, the nature of the extraneous factor. In order to do this, we introduce some\nprevious notation, following that of [Bot09b].\nDenote by W the closed subscheme of T \u2282 PN given by the common zeroes of all 2n\npolynomials fi , gi , write I (i) for the ideal (fi , gi ) of A, and X the base locus of \u03c6 defined in\n4.10, namely\n!\n!\nX\nY\nW := Proj A/\nI (i) , and\nX := Proj A/\nI (i) .\n(4.10)\ni\n\ni\n\nDefinition 4.4.1. We call \u03a9 the complement of the base locus, namely \u03a9 := T \\ X. Let\n\u0393\u03a9 be the graph of \u03c6 or \u03c6 inside \u03a9 \u00d7 (P1 )n .\nP\nS\nSet \u03b1 \u2282 [1, n], write I (\u03b1) := j\u2208\u03b1 I (j) , and set X\u03b1 := Proj(A/I (\u03b1) ) and U\u03b1 := X\u03b1 \\ j \u2208\u03b1\n/ X{j} .\n\u22121\nIf U\u03b1 is non-empty, consider p \u2208 U\u03b1 , then dim(\u03c01 (p)) = |\u03b1|. As the fiber over U\u03b1 is\nequidimensional by construction, write\nE\u03b1 := \u03c01\u22121 (U\u03b1 ) \u2282 T \u00d7 (P1 )n\n\n(4.11)\n\nfor the fiber over U\u03b1 , which defines a multiprojective bundle of rank |\u03b1|. Consequently,\ncodim(E\u03b1 ) = n \u2212 |\u03b1| + (codimT (U\u03b1 )).\nRecall from Definition 4.4.1 that \u0393\u03a9 is the graph of \u03c6, and set \u0393 := Biproj(B), the incidence\nscheme of the linear forms Li . We show in the following theorem that under suitable\nhypothesis \u0393 = \u0393\u03a9 , and that \u03c02 (\u0393) = H the implicit equation of the closed image of \u03c6.\nTheorem 4.4.2. Let \u03c6 : T 99K (P1 )n be defined by the pairs (fi : gi ), not both being zero,\nas in (4.7).\nWrite for i = 1, . . . , n, Li := fi * Yi \u2212 gi * Xi and B := A[X]/(L1 , . . . , Ln ). Take\nP\n\u03bd0 = ( i di ) \u2212 \u03b3 as in Theorem 4.3.5.\n1. The following statements are equivalent:\na) K\u2022 is a free resolution of B;\n\n86\n\n\fb) codimA (Ir ) \u2265 n \u2212 r + 1 for all r = 1, . . . , n;\n!\n\u0011\n\u0010Q\nT\n(j)\nc) dim\n\u2264 r \u2212 2 for all r = 1, . . . , n.\nV\nj\u2208\u03b1 I\n\u03b1\u2282[1,n],|\u03b1|=r\n\n2. If any (all) of\u0001the items above are satisfied, then M\u03bd has generically maximal rank,\nnamely n\u22121+\u03bd\n. Moreover, if for all \u03b1 \u2282 [1, n], codimA (I (\u03b1) ) > |\u03b1|, then,\n\u03bd\ndet((K\u2022 )\u03bd ) = det(M\u03bd ) = H deg(\u03c6) ,\n\nfor \u03bd \u2265 \u03bd0 ,\n\nwhere det(M\u03bd ) and H is the irreducible implicit equation of the closed image of \u03c6.\nProof. (1a) \u21d4 (1b) follows from Avramov's Theorem 4.3.4.\n(1b) \u21d4 (1c) Note that each r\u00d7r-minor of M can be expressed as a product of r polynomials,\nwhere for each column we choose either f or g. Then, the ideal of minors involving the\ncolumns i1 , . . . , ir coincides with the ideal I (i1 ) * * * I (ir ) . Since we have assumed that for any\ni fi 6= 0 or gi 6= 0, the condition dim(V (I (1) * * * I (n) )) \u2264 n \u2212 2 is automatically satisfied.\n(1a) \u21d2 (2) is a classical result, first studied by J.-P. Jouanolou in [Jou95, \u00a73.5], reviewed\nin [GKZ94], and also used by L. Bus\u00e9, M. Chardin and J-P. Jouanolou, in their previous\narticles in the area.\nFor proving\nP the(j)second part of point 2, the hypotheses have been taken in such a way that\ncodimA ( j\u2208\u03b1 I ) > |\u03b1|, for all \u03b1 \u2282 [1, n], which implies that codimT (U\u03b1 ) > |\u03b1|, thus\ncodim(E\u03b1 ) > n = codim(\u0393\u03a9 ).\n`\nSet \u0393U := \u03b1 E\u03b1 , and observe that \u0393 \\ \u0393U = \u0393\u03a9 . Clearly, codim(\u0393U ) > n = codim(\u0393\u03a9 ) =\ncodim(\u0393\u03a9 ).\nSince Spec(B) is a complete intersection in A2n , it is unmixed and purely of codimension\nn. As a consequence, \u0393 6= \u2205 is also purely of codimension n. This and the fact that\ncodim(\u0393U ) > n implies that \u0393 = \u0393\u03a9 . The graph \u0393\u03a9 is irreducible hence \u0393 as well, and its\nprojection (the closure of the image of \u03c6) is of codimension-one.\nIt remains to observe that K\u2022 is acyclic, and H0 (K\u2022 ) \u223c\n= B (cf. Remark 4.3.3). Considering\nthe homogeneous strand of degree \u03bd > \u03b7 we get the following chain of identities (cf. [KM76]):\n[det((K\u2022 )\u03bd )] = divK[X] (H0 (K\u2022 )\u03bd )\n=P\ndivK[X] (B\u03bd )\n= p prime, codimK[X] (p)=1 lengthK[X]p ((B\u03bd )p )[p].\n\n87\n\n\fOur hypothesis were taken in such a way that only one prime occurs. Also since\n[det((K\u2022 )\u03bd )] = divK[X] (Res) = e * [q],\nfor some integer e and q := (H) \u2282 K[X], we have that\nX\nlengthK[X]p ((B\u03bd )p )[p] = e * [q],\np prime, codim(p)=1\n\nand so [det((K\u2022 )\u03bd )] = lengthK[X]q ((B\u03bd )q )[q]. Denote \u03ba(q) := K[X]q /q * K[X]q . Since \u0393 is\nirreducible, we have\nlengthK[X]q ((B\u03bd )q ) = dim\u03ba(q) (B\u03bd \u2297K[X]q \u03ba(q)) = deg(\u03c6),\nwhich completes the proof.\nRemark 4.4.3. We showed that the scheme \u03c02 (\u0393) is defined by the polynomial det(M\u03bd ),\nwhile the closed image of \u03c6 coincides with \u03c02 (\u0393\u03a9 ), hence the polynomial H divides det(M\u03bd ).\nMoreover, from the proof above we conclude that H deg(\u03c6) also divides det(M\u03bd ). And if [E\u03b1 ]\nis an algebraic cycle of T \u00d7 (P1 )n+1 of codimension n + 1, then [\u03c02 (E\u03b1 )] is not a divisor in\n(P1 )n+1 , and consequently det(M\u03bd ) has no other factor than H deg(\u03c6) .\nRemark 4.4.4. With the hypotheses of Theorem 4.4.2 part 2, assuming T = Pn\u22121 , denoting by degi the degree on the variables xi , yi and by degtot the total one, we have:\nQ\n1. degi (H)deg(\u03c6) = j6=i dj ;\nP Q\n2. degtot (H)deg(\u03c6) = i j6=i dj .\n\n4.4.2 Analysis of the extraneous factors\nTheorem 4.4.2 can be generalized (in the sense of [Bot09b, Sec. 4.2]) taking into account\nthe fibers in T \u00d7 (P1 )n that give rise to extraneous factors, by relaxing the conditions\nP (i) on\nthe ideals Ir stated\nQ in Theorem 4.4.2. Recall from (4.10) that\nP W := Proj(A/ i I ) and\nX := Proj(A/ i I (i) ), and that for each \u03b1 \u2282 [1, n], I (\u03b1) := j\u2208\u03b1 I (j) , X\u03b1 := Proj(A/I (\u03b1) )\nS\n\u22121\n1 n\nand U\u03b1 := X\u03b1 \\ j \u2208\u03b1\n/ X{j} . As was defined in (4.11), E\u03b1 := \u03c01 (U\u03b1 ) \u2282 T \u00d7 (P ) is a\nmultiprojective bundle of rank |\u03b1| over U\u03b1 , such that codim(E\u03b1 ) = n\u2212|\u03b1|+(codimT (U\u03b1 )).\nIn order to understand this, we will first analyze some simple cases, namely, where this\nphenomenon occurs over a finite set of points of the base locus; and later, we will deduce\nthe general implicitization result.\n\n88\n\n\fExample 4.4.5. Assume we are given a rational map \u03c6 : P2 99K P1 \u00d7 P1 \u00d7 P1 , where\n\u03c6(u : v : w) = (f1 (u, v, w) : g1 (u, v, w))\u00d7(f2 (u, v, w) : g2 (u, v, w))\u00d7(f3 (u, v, w) : g3 (u, v, w)),\nof degrees d, d0 and d00 respectively.\nWe may suppose that each of the pairs of polynomials {f1 , g1 }, {f2 , g2 } and {f3 , g3 } have no\ncommon factors. Then, the condition codimA (I (i) ) \u2265 2 is automatically satisfied. Assume\nalso that W = \u2205, this is, there are no common roots to all 6 polynomials.\nWe will show here that, if we don't ask for the \"correct\" codimension conditions, we could be\nimplicitizing some extraneous geometric objects. For instance, suppose that we take a simple\npoint p \u2208 V (I (1) + I (2) ) 6= \u2205. Consequently L1 (u, v, w, X) = L2 (u, v, w, X) = 0 for all choices\nof X. Nevertheless, L3 (u, v, w, X) = g3 (u, v, w)x3 \u2212 f3 (u, v, w)y3 = 0 imposes the nontrivial\ncondition g3 (p)x3 \u2212 f3 (p)y3 = 0 on (Z), hence there is one point q = (f3 (p) : g3 (p)) \u2208 P1\nwhich is the solution of this equation. We get \u03c01\u22121 (p) = {p} \u00d7 P1 \u00d7 P1 \u00d7 {q}. As we do not\nwant the reader to focus on the precise computation of this point q, we will usually write\n{\u2217} for the point {q} obtained as the solution of the only nontrivial equation.\nSuppose also that, for simplicity, V (I (1) +I (2) ) = {p}, V (I (1) +I (3) ) = \u2205, and V (I (2) +I (3) ) =\n\u2205. This says that if we compute \u03c02 (\u0393), then we get\n= \u03c02 (\u03c01\u22121 (\u03a9 \u222a X)) = \u03c02 (\u03c01\u22121 (\u03a9)) \u222a \u03c02 (\u03c01\u22121 (X)) =\n= \u03c02 (\u0393\u03a9 ) \u222a (\u03c02 ({p} \u00d7 P1 \u00d7 P1 \u00d7 {\u2217}) =\n= im(\u03c6) \u222a (P1 \u00d7 P1 \u00d7 {\u2217}),\n\n\u03c02 (\u0393)\n\nwhere X = Proj(A/\n\nQ\n\ni\n\nI (i) ) is the base locus of \u03c6 as in (4.10), and \u03a9 = Pn \\ X its domain.\n\nHence, det(K\u2022 (L1 , L2 , L3 )\u03bd ) = H deg(\u03c6) * G, where G = L3 (p). Indeed, observe that each time\nthere is only one extraneous hyperplane appearing (over a point p with multiplicity one),\nwhich corresponds to \u03c02 (\u03c01\u22121 (p)), then \u03c01\u22121 (p) is a closed subscheme of \u0393, defined by the\nequation L3 (p) = 0. Hence, we get that\ndet(K\u2022 (L1 , L2 , L3 )\u03bd ) = Hdeg(\u03c6) * L3 (p).\nWe will now generalize Theorem\nP 4.4.2 in the spirit of the example above. For each i \u2208\n{0, . . . , n} take X\u00ee := Proj(A/ j6=i I (j) ).\nProposition 4.4.6. Let \u03c6 : T 99K (P1 )n be a rational map that satisfies conditions (1a)(1c) of Theorem 4.4.2. Assume further that for all \u03b1 := {i0 , . . . , ik } \u2282 [1, n], with k < n \u2212 1,\ncodimA (I (\u03b1) ) > |\u03b1|. Then, there exist non-negative integers \u03bcp such that:\nResT (L1 , . . . , Ln ) = H\n\ndeg(\u03c6)\n\n*\n\nn Y\nY\n\nLi (p)\u03bcp .\n\ni=1 p\u2208X\u00ee\n\n89\n\n\fProof. Denote by \u03930 := \u0393\u03a9 the closure of the graph of \u03c6, \u0393 as before. From Remark 4.4.3,\nwe can write\nResA (L1 , . . . , Ln )\n,\nG :=\nH deg(\u03c6)\nthe extra factor. It is clear that G defines a divisor in (P1 )n with support on \u03c02 (\u0393 \\ \u03930 ).\nFrom the proof of Theorem 4.4.2, we have that \u0393 and \u03930 coincide outside X \u00d7 (P1 )n . As \u0393\nis defined by linear equations in the second group of variables, then \u0393 \\ \u03930 is supported on\na union of linear spaces over the points of X, and so, its closure is supported on the union\nof the linear spaces (\u03c01 )\u22121 (p) \u223c\n= {p} \u00d7 ((P1 )n\u22121 \u00d7 {\u2217}), where {\u2217} is the point (x : y) \u2208 P1\nsuch that Li (p, x, y) = 0 for suitable i. It follows that \u03c02 ((\u03c01 )\u22121 (p)) \u2282 V (Li ) \u2282 (P1 )n , and\nconsequently\nY\nG=\nLi (p)\u03bcp ,\np\u2208X\n\nfor some non-negative integers \u03bcp .\nLemma 4.4.7. Let \u03c6 : T 99K (P1 )n , be a rational map satisfying condition 1 in Theorem\n4.4.2. Then, for all \u03b1 \u2282 [1, n], codimA (I (\u03b1) ) \u2265 |\u03b1|.\nProof. To show this we will use Avramov's Theorem 4.3.4.PTake \u03b1 := {i1 , . . . , ik }P\u2282 [1, n] for\n1 \u2264 k \u2264 n. Denote by I the ideal I (i1 ) +* * *+I (in ) , I (\u03b1) = kj=1 I (ij ) and I ({\u03b1) = nl=k+1 I (il ) ,\nhence I = I (\u03b1) + I ({\u03b1) . As (L1 , . . . , Ln ) is a complete intersection in R, also is (Li1 , . . . , Lik )\nin A[xi1 , yi1 , . . . , xik , yik ]. Applying Avramov's Theorem 4.3.4 to the ideal (LI1 , . . . , Lik ), for\nr = 1 we have that codimA (I (\u03b1) ) \u2265 k = |\u03b1|.\nObserve that as I (\u03b1) is generated by a subset of the set of generators of I then I (\u03b1) is\nalso a complete intersection in R. Now, as it is generated by elements only depending on\nthe variables xij , yij for j = 1, . . . , k, we have that it is also a complete intersection in\nA[xi1 , yi1 , . . . , xik , yik ].\nWe define the basic language needed to describe the geometry of the base locus of \u03c6.\nDefinition 4.4.8. For each \u03b1 \u2282 [1, n], denote by \u0398 := {\u03b1 \u2282 [1, n] : codim(I (\u03b1) ) = |\u03b1|}.\nHence, let I (\u03b1) = (\u2229qi \u2208\u039b\u03b1 qi ) \u2229 q0 be a primary decomposition, where \u039b\u03b1 is the set of primary\nideals of codimension |\u03b1|, and codimA (q0 ) > |\u03b1|. Write X\u03b1,i := Proj(A/qi ) with qi \u2208 \u039b\u03b1 ,\nred\nand let X\u03b1,i\nbe the associated reduced variety.\nWrite \u03b1 := {i1 , . . . , ik } \u2282 [1, n], and denote by \u03c0\u03b1 : (P1 )n \u2192 (P1 )n\u2212|\u03b1| the projection given\nby\n\u03c0\u03b1 : (x1 : y1 ) \u00d7 * * * \u00d7 (xn : yn ) 7\u2192 (xik+1 : yik+1 ) \u00d7 * * * \u00d7 (xin : yin ).\n\n90\n\n\fSet P\u03b1 := \u03c0\u03b1 ((P1 )n ), and define \u03c6\u03b1 := \u03c0\u03b1 \u25e6 \u03c6 : T 99K P\u03b1 .\nDenote by W\u03b1 the base locus of \u03c6\u03b1 . Clearly W \u2282 W\u03b1 \u2282 X (cf. equation (4.10)). Denote\nU\u03b1 := T \\ W\u03b1 , the open set where \u03c6\u03b1 is well defined. Write \u03a9\u03b1 := X\u03b1 \u2229 U\u03b1 and \u03a9\u03b1,i :=\nX\u03b1,i \u2229 U\u03b1 . If \u03b1 is empty, we set \u03c0\u03b1 = Id(P1 )n , \u03c6\u03b1 = \u03c6, W\u03b1 = W and U\u03b1 = \u03a9\u03b1 = \u03a9.\nWe get a commutative diagram as follows\n\u007f\n\n\u001f\n\u03a9\u03b1 \u001f XXXXX/ XX\nX \u03b1\n\n\u007f\n/\n\n\u03c6\nT O_ _ _ _ _ _/ (P1 )n\n\nXXXXX\nO O\u03c6\nXXXXX\nO\u03b1\n\u03c0\u03b1\nXXXXX\nXXXXX O O\n\u03c6\u03b1 |\u03a9\u03b1\nXXXXXO' \u000f\u000f\n+ P :=\n\u03b1\n\n\u03c0\u03b1 ((P1 )n ) \u223c\n= (P1 )n\u2212|\u03b1| .\n\nRemark 4.4.9. Let p \u2208 T be a point, then there exist a unique pair (\u03b1, i) such that\np \u2208 \u03a9\u03b1,i . If p \u2208 W , then \u03b1 = \u2205 and no i is considered.\nProof. It is clear by definition of \u03a9\u03b1 that if p \u2208 W , then \u03b1 = \u2205 and no i needs to be\nconsidered. Hence, assume that p \u2208 T \\ W . Thus, we define \u03b1 := {i \u2208 [1, n] : fi (p) =\ngi (p) = 0} which is a non-empty subset of [1, n]. For this set \u03b1, define \u03c6\u03b1 according to\nDefinition 4.4.8, set W\u03b1 the base locus of \u03c6\u03b1 and X\u03b1 := Proj(A/I (\u03b1) ). By definition,\np \u2208 \u03a9\u03b1 := X\u03b1 \\ W\u03b1 . Since, in particular, p \u2208 X\u03b1 , it is one of its irreducible components that\nwe denote by X\u03b1,i following the notation of Definition 4.4.8. We conclude that p \u2208 \u03a9\u03b1,i :=\nX\u03b1,i \\ W\u03b1 , from which we obtain the (\u03b1, i) of the statement.\nIn the following lemma we define a multiprojective bundle of rank |\u03b1| over \u03a9\u03b1,i .\nLemma 4.4.10. For \u03c6 as in Theorem 4.4.2, and for each \u03b1 \u2208 \u0398 and each qi \u2208 \u039b\u03b1 , the\nfollowing statements are satisfied:\n1. \u03a9\u03b1,i is non-empty\n2. for all p \u2208 \u03a9\u03b1,i , dim(\u03c01\u22121 (p)) = |\u03b1|\n3. the restriction \u03c6\u03b1,i of \u03c6 to \u03a9\u03b1,i , defines a rational map\n\u03c6\u03b1,i : X\u03b1,i 99K P\u03b1 \u223c\n= (P1 )n\u2212|\u03b1| .\n\n(4.12)\n\n\u03c0\n\n1\n4. Z\u03b1,i := \u03c01\u22121 (\u03a9\u03b1,i ) \u2212\u2192\n\u03a9\u03b1,i defines a multiprojective bundle E\u03b1,i of rank |\u03b1| over \u03a9\u03b1,i .\n\n91\n\n\fS\nProof. Fix X\u03b1,i \u2282 X\u03b1 and write \u03b1 :=Si1 , . . . , ik . As \u03a9\u03b1,i = X\u03b1,i \\ j \u2208\u03b1\n/ X{j} it is an open\nsubset of X\u03b1,i . If \u03a9\u03b1,i = \u2205 then X\u03b1,i \u2282 j \u2208\u03b1\nX\n,\nand\nas\nit\nis\nirreducible,\nthere exists j such\n{j}\n/\n0\nthat X\u03b1,i \u2282 X{j} , hence X\u03b1,i \u2282 X{j} \u2229 X\u03b1 = X\u03b1\u222a{j} . Denote by \u03b1 := \u03b1 \u222a {j}, it follows\nthat dim(X\u03b10 ) \u2265 dim(X\u03b1,i ) = n \u2212 |\u03b1| > n \u2212 |\u03b10 |, which contradicts the hypothesis.\nLet p \u2208 \u03a9\u03b1,i , \u03c01\u22121 (p) = {p} \u00d7 {qik+1 } \u00d7 * * * \u00d7 {qin } \u00d7 (P1 )|\u03b1| , where the point qij \u2208 P1 is the\nonly solution to the nontrivial equation Lij (p, xij , yij ) = yij fij (p) \u2212 xij gij (p) = 0. Then we\ndeduce that dim(\u03c01\u22121 (p)) = |\u03b1|, and that \u03c6\u03b1,i : \u03a9\u03b1,i \u2192 P\u03b1 := \u03c0\u03b1 ((P1 )n ) \u223c\n= (P1 )n\u2212|\u03b1| given by\np \u2208 \u03a9\u03b1,i 7\u2192 {qik+1 } \u00d7 * * * \u00d7 {qin } \u2208 P\u03b1 , is well defined.\nThe last statement follows immediately from the previous ones.\nWe get the following result which generalizes Proposition 4.4.6.\nTheorem 4.4.11. Let \u03c6 : T 99K (P1 )n be defined by the pairs (fi : gi ), not both being zero,\nas in equation (4.7). Assume that codimA (Ir ) \u2265 n \u2212 r + 1 for all r = 1, . . . , n. Denote\nby H the irreducible implicit equation of the closure of its image. Then, there exist relative\nopen subsets, \u03a9\u03b1,i , of T such that the restriction \u03c6\u03b1,i of \u03c6 to \u03a9\u03b1,i defines a rational map\n\u03c6\u03b1,i : \u03a9\u03b1,i \u2192 P\u03b1 \u223c\n= (P1 )n\u2212|\u03b1| and positive integers \u03bc\u03b1,i such that:\nY\nResT (L0 , . . . , Ln ) = H deg(\u03c6) * (H\u03b1,i )\u03bc\u03b1,i *deg(\u03c6\u03b1,i ) .\n\u03b1,i\n\nProof. The proof of this result follows similar lines of that of [Bot09b, Thm. 22]. Recall\n\u0393 := Biproj(B), and set \u03930 := \u0393\u03a9 , the closure of the graph of \u03c6. Applying \u03c02 to the\ndecomposition \u0393 \\ \u0393U = \u03930 we see that [\u03c02 (\u0393U )] = [ResT (L0 , . . . , Ln )] \u2212 [\u03c02 (\u03930 )] is the\ndivisor associated to the extraneous factors. It is clear that [\u03c02 (\u0393U )] defines a principal\n0 ,...,Ln )\ndivisor in (P1 )n denote by G = ResTH(L\n, with support on \u03c02 (\u0393 \\ \u03930 ), and that \u0393 and \u03930\ndeg(\u03c6)\ncoincide outside X \u00d7 (P1 )n .\nBy Lemma 4.4.10, for each \u03b1 and each qi \u2208 \u2206\u03b1 \u2282 \u039b\u03b1 , \u03c6\u03b1,i defines a multiprojective bundle\nE\u03b1,i of rank |\u03b1| over \u03a9\u03b1,i .\nBy definition of \u2206\u03b1 , \u03c02 (E\u03b1,i ) is a closed subscheme of (P1 )n of codimension-one. Denoting\nred\nby [E\u03b1,i ] = \u03bc\u03b1,i * [E\u03b1,i\n] the class of E\u03b1,i as an algebraic cycle of codimension n in Pn\u22121 \u00d7 (P1 )n ,\nwe have (\u03c02 )\u2217 [E\u03b1,i ] = \u03bc\u03b1,i * (\u03c02 )\u2217 [E\u03b1,ired ] = \u03bc\u03b1,i * deg(\u03c6\u03b1,i ) * [p\u03b1,i ], where p\u03b1,i := (H\u03b1,i ).\nAs in Theorem 4.4.2, one has for \u03bd > \u03b7:\n[det((K\u2022 )\u03bd )] = divk[X] (H0 (K\u2022 )\u03bd )\n=P\ndivk[X] (B\u03bd )\n= p prime, codimk[X] (p)=1 lengthk[X]p ((B\u03bd )p )[p].\n\n92\n\n\fWe obtain that\n[det((K\u2022 )\u03bd )] =\n\nXX\n\nlengthk[X]p\u03b1,i ((B\u03bd )p\u03b1,i )[p\u03b1,i ] + lengthk[X](H) ((B\u03bd )(H) )[(H)].\n\n\u03b1\u2208\u0398 p\u03b1,i\n\nIn the formula above, for each p\u03b1,i we have\nlengthk[X]p\u03b1,i ((B\u03bd )p\u03b1,i ) = dimK(p\u03b1,i ) (B\u03bd \u2297k[X]p\u03b1,i K(p\u03b1,i )) = \u03bc\u03b1,i * deg(\u03c6\u03b1,i ),\nwhere K(p\u03b1,i ) := k[X]p\u03b1,i /p\u03b1,i * k[X]p\u03b1,i .\nConsequently we get that for each \u03b1 \u2208 \u0398, there is a factor of G, denoted by H\u03b1,i , that\ncorresponds to the irreducible implicit equation of the scheme theoretic image of \u03c6\u03b1,i , raised\nto a certain power \u03bc\u03b1,i * deg(\u03c6\u03b1,i ).\nRemark 4.4.12. Observe that if im(\u03c6\u03b1,i ) is not a hypersurface in P\u03b1 then deg(\u03c6\u03b1,i ) is 0,\nhence (H\u03b1,i )\u03bc\u03b1,i *deg(\u03c6\u03b1,i ) = 1. Thus \u03c6\u03b1,i does not give an extraneous factor.\n\n93\n\n\f\f5 The algorithmic approach\n5.1 Hilbert and Ehrhart functions\nIn this section we focus on the study of the size of the matrices M\u03bd obtained in the two\ncases: Pn and (P1 )n developed in Chapters 3 and 4 respectively. Let us analyze first the\ncase of Pn , thus, where we get a map \u03c6 : T 99K Pn as defined in (3.3). Assume also that the\nbase locus of \u03c6 is a zero-dimensional almost locally complete intersection scheme. Hence,\nthe associated Z-complex is acyclic. We have shown in Section 3.3 that the matrix M\u03bd is\nobtained as the right-most map of the (\u03bd, \u2217)-graded strand of the approximation complex\nof cycles Z\u2022 (h, A)(\u03bd,\u2217) :\nM\n\n0 \u2192 (Zn )(\u03bd,\u2217) (\u2212n) \u2192 (Zn\u22121 )(\u03bd,\u2217) (\u2212(n \u2212 1)) \u2192 * * * \u2192 (Z1 )(\u03bd,\u2217) (\u22121) \u2192\u03bd (Z0 )(\u03bd,\u2217) .\nGiven a graded A-module B, write hB (\u03bc) := dimK (B\u03bc ) for the Hilbert function of B at \u03bc.\nSince Zi = Zi [i * d] \u2297A A[X] = Zi [i * d] \u2297K K[X], (Zi )(\u03bd,\u2217) = (Zi [i * d])\u03bd \u2297K K[X], we have\nM\u03bd \u2208 MathA (\u03bd),hZ1 (\u03bd+d) (K[X]).\nConsider the (P1 )n compactification of the codomain, and assume we are given a map\n\u03c6 : T 99K (P1 )n as the one considered in (4.7), satisfying the conditions of Theorem 4.4.11.\nWe obtain the matrix M\u03b7 computed from the Koszul complex (K\u2022 )(\u03b7,\u2217) . Hence, the matrix\nM\u03b7 belongs to MathA (\u03b7),nhA (\u03b7\u2212d) (K[X]).\nBoth numbers hA (\u03bd) and hZ1 (\u03bd + d), in the projective and multiprojective setting, can be\ncomputed easily in Macaulay2. The cost of computation depends on the ring structure of\nA. When A is just any finitely generated N-graded Cohen-Macaulay K-algebra, finding\na precise theoretical estimate of these numbers would be very difficult. Also, the module\nstructure of Z1 can also be very intricate. Since it is a N-graded sub-A-module of An+1 , we\nhave hZ1 (\u03bd + d) \u2264 (n + 1)hA (\u03bd + d).\nAssume now that the ring A is the coordinate ring of a normal toric variety T defined\nfrom a polytope N , as mentioned in Section 3.2, and later in Remarks 3.3.2 and (4.4). In\n\n95\n\n\fthis setting, the situation above can be rephrased in a more combinatorial fashion. Let\nN be a (n \u2212 1)-dimensional normal lattice polytope, that is a full-dimensional normal\nconvex polytope in Rn\u22121 with vertices lying in Zn\u22121 . For any integer k \u2265 0, the multiple\nkN = {p1 + * * * + pk : pi \u2208 N } is also a lattice polytope, and we can count its lattice\npoints. The function taking each integer k \u2208 N to the number EN (k) = #((kN ) \u2229 Zn\u22121 )\nof lattice points in the polytope kN is the Ehrhart function of N (cf. [MS05]). Write\n+\nEN\n(k) = #relint((kN ) \u2229 Zn\u22121 ), the number of integer points in the interior of kN (cf. [Lat]\nfor a software for computing those numbers). It is known that there is an identification\n+\nbetween K[relint(C)] and \u03c9A , hence, this can be understood as EN\n(k) = h\u03c9A (k).\nLet C be the cone in Rn\u22121 \u00d7 R spanned in degree 1 by the lattice points in the polytope\nN , which is normal by assumption, hence A is Cohen-Macaulay (cf. 3.2.3). Assume N 0\nstands for some integer contraction of N which is also normal and take d \u2208 N such that\ndN 0 = N . Then A0 = K[N 0 ] its Cohen-Macaulay semigroup ring. As dN 0 = N , we\nhave that EN 0 (d\u03bc) = EN (\u03bc) for all \u03bc. Set \u03b3 := an (A) = inf{\u03bc : (\u03c9A\u2228 )\u03bc = 0} and\n\u03b3 0 := an (A0 ) = inf{\u03bc : (\u03c9A\u22280 )\u03bc = 0}. As (\u03c9A\u2228 )\u03bc = HomK (M\u2212\u03bc , K), we have that \u03b3 =\nmax{i : Ci contains no interior points}, where Ci := C \u2229 Zn\u22121 \u00d7 {i}, and similarly for \u03b3 0 .\nFor a deeper understanding we refer the reader to [BH93, Sec. 5].\nBoth A and A0 give rise to two different -but related- implicitization problems, the following\nresult gives a condition on the rings A and A0 to decide when it is algorithmically better to\nchoose one situation or the other.\nLemma 5.1.1. Take N , N 0 , d, \u03b3 and \u03b3 0 as above. Then\n1. \u03b3 \u2265 \u03b3 0 ;\n\n2. d(\u03b3 0 + 1) \u2265 \u03b3 + 1;\n\nProof. As d \u2265 1, we can assume N 0 \u2282 N , hence, the first item follows. For the second item,\nwe just need to observe that if \u03bcN \u2229 Zn is nonempty, then \u03bcdN 0 \u2229 Zn neither it is. Taking\n\u03bc the smallest positive integer with this property, and writing \u03b3 = \u03bc + 1, the second item\nfollows.\nRemark 5.1.2. Is not true in general that d(\u03b3 + 1) > \u03b3 0 + 1: take N as the triangle with\nvertices (3, 0), (0, 3), (0, 0) and N 0 the triangle with vertices (1, 0), (0, 1), (0, 0); hence d = 3,\n\u03b3 = 0, \u03b3 0 = 2. We obtain d(\u03b3 + 1) = 3 = \u03b3 0 + 1, which shows also that d\u03b3 need not be\nbigger than \u03b3 0 . It is neither true that d(\u03b3 + 1) = \u03b3 0 + 1, for instance, take N as the triangle\nwith vertices (4, 0), (0, 4), (0, 0) and N 0 as before. Observe that d(\u03b3 + 1) = 4(0 + 1) = 4 >\n\u03b3 0 + 1 = 2 + 1 = 3.\n\n96\n\n\fLemma 5.1.3. Take N be a normal polytope, let N 0 and d be such that dN 0 = N . Set\n\u03bd0 := (n \u2212 1) \u2212 \u03b3 (the bound established in 3.3.8), and \u03bd00 = d(n \u2212 1) \u2212 \u03b3 0 . Write \u03b4 :=\nd(\u03b3 + 1) \u2212 (\u03b3 0 + 1). Then EN (\u03bd0 ) > EN 0 (\u03bd00 ) if and only if \u03b4 > d \u2212 1.\nProof. We have seen that EN 0 (d\u03bd0 ) = EN (\u03bd0 ), hence, it is enough to compare EN 0 (d\u03bd0 ) and\nEN 0 (\u03bd00 ). Writing d\u03b3 = \u03b3 0 + \u03b4 \u2212 (d \u2212 1), we have\nEN 0 (d\u03bd0 ) = EN 0 (d(n \u2212 1) \u2212 d\u03b3) = EN 0 (d(n \u2212 1) \u2212 \u03b3 0 + \u03b4 \u2212 (d \u2212 1)),\nfrom where we deduce that EN (\u03bd0 ) > EN 0 (\u03bd00 ) if and only if \u03b4 > d \u2212 1.\nCorollary 5.1.4. Let f : An\u22121 99K An be a rational map as in (3.3) with normal polytope\nN := N (f ). Let N 0 be a normal polytope and d such that dN 0 = N . Let T and T 0\nbe the arithmetically Cohen-Macaulay toric varieties defined from N and N 0 respectively,\nand \u03c6 : T \u2282 PEN (1) 99K Pn and \u03c60 : T 0 \u2282 PEN 0 (1) 99K Pn . Take \u03bd0 , \u03bd00 and \u03b4 as above.\nAnd write M\u03bd0 and M\u03bd0 0 the representation matrices of im(\u03c6) and im(\u03c60 ) respectively. Then\n0\n#rows(M\u03bd0 ) > #rows(M\u03bd0 0 ) if and only if \u03b4 > d \u2212 1.\n0\n\nIn the second case, given a map \u03c6 : T 99K (P1 )n as in Theorem 4.4.11, we obtain the matrix\nM\u03bd as the right-most matrix from the Koszul complex (K\u2022 )(\u03bd,\u2217) :\nM\n\n\u03bd\n0 \u2192 A\u03bd\u2212nd \u2297K K[X](\u2212n) \u2192 * * * \u2192 (A\u03bd\u2212d )n \u2297K K[X](\u22121) \u2212\u2192\nA\u03bd \u2297K K[X] \u2192 0,\nL\nIt is clear that M\u03bd is a dimK (A\u03bd ) by dimK ((A\u03bd\u2212d )n ) matrix. As k\u22650 hCk iK = K[C] which is\ncanonically isomorphic to A, and also dimK (A\u03bd ) = EN (\u03bd) and dimK ((A\u03bd\u2212d )n ) = nEN (\u03bd \u2212d),\nhence\nM\u03bd \u2208 MatEN (\u03bd),nEN (\u03bd\u2212d) (K[X]).\n(5.1)\n\n5.2 Examples\nIn this section we show, in a few examples, how the theory developed in earlier sections\nworks. We first analyze two concrete examples of parametrized surfaces, given as the image\nof a rational map defined by rational functions with different denominators. There we show\nhow better is not to take common denominator, and regard their images in (P1 )3 and (P1 )4 .\nLater we show how the method is well adapted for generic rational affine maps.\n\n97\n\n\fIn the later part of this section we invoke a few examples treated by Bus\u00e9 and Chardin in\n[BC05]. The main idea of this part is showing that the method generalizes the techniques\ndeveloped loc. cit. and that in this more general setting we find no better contexts. This\ncomplements the argumentation of the authors that no better degrees can be found in these\ncases, by saying that no better domain or codomain compactifications can be found in\ngeneral in these particular cases.\n\n5.2.1 Implicit equations of dimension 2 and 3\nExample 5.2.1. We consider here an example of a very sparse parametrization where the\nmultihomogeneous compactification of the codomain is fairly better than the homogeneous\ncompactification. We have seen this sme example as Example 3.6.4 focusing on the projective\ncompactification of A3 . Take n = 3, and consider the affine map\n\u0013\n\u0012\nst6 + 3\nst6 + 4\nst6 + 2\n2\n3\n,\n,\n.\nf : A 99K A : (s, t) 7\u2192\nst5 \u2212 3st3 st4 + 5s2 t6 2 + s2 t6\nObserve that in this case there is no smallest multiple of the Newton polytope N (f ) with\ninteger vertices, hence, N (f ) = N 0 (f ) as can be seen in the picture below.\n6\nb\n\nb\n\n5\n4\n3\n2\n1\n0b\n\n0\n\n1\n\n2\n\nComputing in Macaulay2 we get that the homogeneous coordinate ring is\nA=\n\n98\n\n(T32\n\nk[T0 , . . . , T5 ]\n.\n\u2212 T2 T4 , T2 T3 \u2212 T1 T4 , T22 \u2212 T1 T3 , T12 \u2212 T0 T5 )\n\n\fWhen A3 is compactified into P3 we obtain from f a new map \u03c6 : T 99K P3 by replacing (s, t)\nby T0 , . . . , T5 , and taking a common denominator. We can easily see that taking common\ndenominator leads to polynomials of degree up to 23 and the Newton polytope of the four\nnew polynomials contains 26 integer points instead of 6. Again computing in Macaulay2,\nfor \u03bd0 = 2, the matrix M\u03bd has 351 rows and about 500 columns. It can be verified that\nthis compactification gives a base point which is not locally a complete intersection, but\nlocally an almost complete intersection, giving rise to extraneous factors. For more details,\nsee Example 3.6.4.\nOn the other hand, compactifying A3 into (P1 )3 we get the map\n\u03c6 : T 99K P1 \u00d7 P1 \u00d7 P1\n(T0 , . . . , T5 ) 7\u2192 (2T0 + T4 : \u22123T1 + T3 )(3T0 + T4 : T2 + 5T5 )(4T0 + T4 : 2T0 + T5 )\n\nComputations in Macaulay2 give that for \u03bd0 = 3 the matrix M\u03bd0 is of size 34 \u00d7 51. Since\nthere are no base points with two-dimensional fibers, we get no extraneous factors and\n, getting an equation of\nhence, H deg(\u03c6) can be computed as det((34\u00d734)-matrix)*det((1\u00d71)-matrix)\ndet((17\u00d717)-matrix)\ndegree (6, 6, 6). For computing the multidegree of the equation, it suffices to observe that\nthe total degree is 34 + 1 \u2212 17 = 18, since the coefficients on the matrices are all linear.\nMoreover, just by looking at \u03c6 we see that the degree on each pair of variables must coincide,\nhence, it has to be (6, 6, 6).\nExample 5.2.2. Assume we are given four tuples of polynomials fi , gi , for i \u2208 [1, 4], in\nthree variables s, t, u. Let them be f1 = s + tu2 , g1 = u2 , f2 = st, g2 = u2 , f3 = su2 ,\ng3 = t, f4 = stu2 , g4 = 1. They define a rational map f : A3 99K A4 given by (s, t, u) 7\u2192\n(f1 /g1 , f2 /g2 , f3 /g3 , f4 /g4 ).\nWe compactify A3 into the toric variety associated to the smallest multiple of the Newton\npolytope the input polynomials define. It is easy to see that this polytope N is a (1 \u00d7 1 \u00d7 2)parallelepiped, and T \u223c\n= (P1 )3 \u2282 P11 .\nIn order to detect the extraneous factor that occurs, consider the rational map\n\u03c6\u0303 : (P1 )3 99K (P1 )4\n(s : s0 ) \u00d7 (t : t0 ) \u00d7 (u : u0 ) 7\u2192 (f \u03031 : g\u03031 ) \u00d7 (f \u03032 : g\u03032 ) \u00d7 (f \u03033 : g\u03033 ) \u00d7 (f \u03034 : g\u03034 ),\nwhere (\u2212\u0303) means homogenizing with respect to the degree (1, 1, 2) with new variables s0 , t0\nand u0 .\nWe easily observe that the base locus has codimension 2, in fact many lines occur in the\nbase locus: There are\n\n99\n\n\f1. four lines L1 = (1 : 0) \u00d7 (t : t0 ) \u00d7 (1 : 0), L2 = (1 : 0) \u00d7 (t : t0 ) \u00d7 (0 : 1), L3 = (0 :\n1) \u00d7 (t : t0 ) \u00d7 (1 : 0), L4 = (0 : 1) \u00d7 (t : t0 ) \u00d7 (0 : 1);\n2. three lines L5 = (1 : 0) \u00d7 (1 : 0) \u00d7 (u : u0 ), L6 = (1 : 0) \u00d7 (0 : 1) \u00d7 (u : u0 ),\nL7 = (0 : 1) \u00d7 (1 : 0) \u00d7 (u : u0 ); and\n3. three lines L8 = (s : s0 ) \u00d7 (1 : 0) \u00d7 (1 : 0), L9 = (s : s0 ) \u00d7 (1 : 0) \u00d7 (0 : 1),\nL10 = (s : s0 ) \u00d7 (0 : 1) \u00d7 (0 : 1);\n4. 7 points of intersection of the previous lines: L1 \u2229 L5 \u2229 L8 = {(1 : 0) \u00d7 (1 : 0) \u00d7 (1 : 0)},\nL1 \u2229 L6 = {(1 : 0) \u00d7 (0 : 1) \u00d7 (1 : 0)}, L2 \u2229 L5 \u2229 L9 = {(1 : 0) \u00d7 (1 : 0) \u00d7 (0 : 1)},\nL2 \u2229 L6 \u2229 L10 = {(1 : 0) \u00d7 (0 : 1) \u00d7 (0 : 1)}, L3 \u2229 L7 \u2229 L8 = {(0 : 1) \u00d7 (1 : 0) \u00d7 (1 : 0)},\nL4 \u2229 L7 \u2229 L9 = {(0 : 1) \u00d7 (1 : 0) \u00d7 (0 : 1)} and L4 \u2229 L10 = {(0 : 1) \u00d7 (0 : 1) \u00d7 (0 : 1)}.\nOver those lines the fiber is of dimension 2, except over the points of intersection of them.\nIn the language of Section 4.2, we have that W = \u2205. The set \u0398 formed by the sets \u03b1 \u2282 [1, 4]\ngiving fibers of dimension |\u03b1|, is\n\u0398 = {{1, 2}, {1, 3}, {1, 4}, {2, 3}, {2, 4}, {3, 4}, {1, 2, 3}, {1, 3, 4}, {1, 2, 4}, {2, 3, 4}}.\nRecall that this does not imply that every \u03b1 \u2208 \u0398 will give an extraneous factor (cf. Remark\n4.4.12). We clarify this:\nAs we have mentioned, the base locus is a union of lines with non-trivial intersection. Take\n\u03b1 = {1, 2}. Set-theoretically X\u03b1 = L1 t L4 , and hence there are two irreducible components\nof X\u03b1 , namely X\u03b1,1 = L1 and X\u03b1,2 = L4 . The line X\u03b1,1 = L1 only intersects L5 , L6 and L8 ,\nhence\n\u03a9\u03b1,1 = L1 \\ (L5 \u2229 L6 \u2229 L8 ) = {(1 : 0) \u00d7 (t : t0 ) \u00d7 (1 : 0) : t 6= 0 and t0 6= 0}.\n\u03a9\u03b1,2 = L4 \\ (L7 \u2229 L9 \u2229 L10 ) = {(0 : 1) \u00d7 (t : t0 ) \u00d7 (0 : 1) : t 6= 0 and t0 6= 0}.\nSince \u03b1 = {1, 2}, the linear forms L1 (p, X) and L2 (p, X) vanish identically for all p \u2208 X\u03b1 ,\nwhile L3 (p, X) = f3 (p)Y3 \u2212 g3 (p)X3 = t0 Y3 and L4 (p, X) = tY4 for p \u2208 X\u03b1,1 . It is easy to\nnote that none of them vanish if and only if p \u2208 \u03a9\u03b1,1 . We get that L3 (p, X) = tX3 and\nL4 (p, X) = t0 X4 for p \u2208 X\u03b1,2 .\nFinally, for \u03b1 = {1, 2}, we obtain two multiprojective bundles E\u03b1,i over \u03a9\u03b1,i , for i = 1, 2,\n\u03c0\n\n1\nE\u03b1,1 : {(1 : 0) \u00d7 (t : t0 ) \u00d7 (1 : 0) \u00d7 (P1 )2 \u00d7 (t0 : 0) \u00d7 (t : 0) : t 6= 0, t0 6= 0} \u2212\u2192\n\u03a9\u03b1,1 ,\n\n\u03c0\n\n1\nE\u03b1,2 : {(0 : 1) \u00d7 (t : t0 ) \u00d7 (0 : 1) \u00d7 (P1 )2 \u00d7 (0 : t) \u00d7 (0 : t0 ) : t 6= 0, t0 6= 0} \u2212\u2192\n\u03a9\u03b1,2 .\n\n100\n\n\fObserve that im(\u03c6\u03b1,1 ) = P1 \u00d7 P1 \u00d7 (1 : 0) \u00d7 (1 : 0), hence it does not define a hypersurface.\nThus, \u03c6\u03b1,1 does not contribute with an extraneous factor. The same for \u03c6\u03b1,2 .\nThe situation is similar when \u03b1 \u2208 {{1, 3}, {1, 4}, {2, 3}, {2, 4}}, but quite different for \u03b1 =\n{3, 4}. Take \u03b1 = {3, 4}, the linear forms L3 (p, X) and L4 (p, X) vanish identically for all\np \u2208 X\u03b1 . Take X\u03b1,1 = L2 and X\u03b1,2 = L3 . Define \u03a9\u03b1,1 := L3 \\ {(0 : 1) \u00d7 (0 : 1) \u00d7 (1 : 0), (0 :\n1) \u00d7 (1 : 0) \u00d7 (1 : 0)}, and observe that \u03c6\u03b1,1 : \u03a9\u03b1,1 99K P\u03b1 defines a hypersurface given by\nthe equation (X2 = 0). Hence, when \u03b1 = {3, 4}, \u03c6\u03b1,1 does give an extraneous factor.\nNow, let us take \u03b1 = {1, 2, 3} in order to illustrate a different situation. Verifying with the 7\npoints listed above, we see that X\u03b1 = {(1 : 0) \u00d7 (0 : 1) \u00d7 (1 : 0)} \u222a {(0 : 1) \u00d7 (0 : 1) \u00d7 (0 : 1)}.\nHence, there are two irreducible components X\u03b1,1 = {(1 : 0) \u00d7 (0 : 1) \u00d7 (1 : 0)} and\nX\u03b1,2 = {(0 : 1) \u00d7 (0 : 1) \u00d7 (0 : 1)}, and clearly \u03a9\u03b1,i = X\u03b1,i for i = 1, 2. Thus, we get the\ntrivial bundles\n\u03c0\n\n1\nE\u03b1,1 : {(1 : 0) \u00d7 (1 : 0) \u00d7 (1 : 0) \u00d7 (P1 )3 \u00d7 (1 : 0) : t 6= 0 and t0 6= 0} \u2212\u2192\n\u03a9\u03b1,1 ,\n\n\u03c0\n\n1\nE\u03b1,2 : {(0 : 1) \u00d7 (0 : 1) \u00d7 (0 : 1) \u00d7 (P1 )3 \u00d7 (0 : 1) : t 6= 0 and t0 6= 0} \u2212\u2192\n\u03a9\u03b1,2 .\n\nThese two bundles give rise to the factors Y4 and X4 . We conclude with similar argumentation that the extraneous factor is\nG = Y12 X2 Y2 Y32 X4 Y4 .\nThe degree of the multihomogeneous resultant ResN (L1 , L2 , L3 , L4 ) in the coefficients of\neach Li , as polynomials in s, s0 , t, t0 , u and u0 , is equal to 3 * 1 * 1 * 2 = 6 for all i = 1, . . . , 4\nby [GKZ94, Prop. 2.1, Ch. 13]. So, the total degree of det((K\u2022 )\u03bd ) is 24 = 4 * 6. Indeed, t he\nirreducible implicit equation is\nH = X42 Y12 Y22 Y32 + 2X4 X2 X3 Y12 Y2 Y3 Y4 \u2212 X4 X12 X3 Y22 Y3 Y4 + X22 X32 Y12 Y42 ,\nand deg(\u03c6) = 2. Thus, det((K\u2022 )\u03bd ) = H 2 * G for \u03bd \u001d 0.\nLet us change now our analysis, and consider the (smallest multiple of) the Newton polytope\nN of fi and gi for i = 1, 2, 3, 4. We easily see that N is a parallelepiped with opposite\nextremes in the points (0, 0, 0) and (1, 1, 2). For a suitable labeling of the points in N \u2229 Z3\n\u03b9\nby {Ti }i=0,...,11 , we have that the toric ideal that defines the toric embedding of (A\u2217 )3 ,\u2192 P11\nis\nJ := I(T ) = (T9 T10 \u2212 T8 T11 , T7 T10 \u2212 T6 T11 , T5 T10 \u2212 T4 T11 , T3 T10 \u2212 T2 T11 , T1 T10 \u2212 T0 T11 , T92 \u2212\nT7 T11 , T8 T9 \u2212 T6 T11 , T5 T9 \u2212 T3 T11 , T4 T9 \u2212 T2 T11 , T3 T9 \u2212 T1 T11 , T2 T9 \u2212 T0 T11 , T82 \u2212 T6 T10 , T7 T8 \u2212\nT6 T9 , T5 T8 \u2212 T2 T11 , T4 T8 \u2212 T2 T10 , T3 T8 \u2212 T0 T11 , T2 T8 \u2212 T0 T10 , T1 T8 \u2212 T0 T9 , T5 T7 \u2212 T1 T11 , T4 T7 \u2212\n\n101\n\n\fT0 T11 , T3 T7 \u2212 T1 T9 , T2 T7 \u2212 T0 T9 , T5 T6 \u2212 T0 T11 , T4 T6 \u2212 T0 T10 , T3 T6 \u2212 T0 T9 , T2 T6 \u2212 T0 T8 , T1 T6 \u2212\nT0 T7 , T3 T4 \u2212 T2 T5 , T1 T4 \u2212 T0 T5 , T32 \u2212 T1 T5 , T2 T3 \u2212 T0 T5 , T22 \u2212 T0 T4 , T1 T2 \u2212 T0 T3 ).\nThis computation has been done in Macaulay2 using the code in Section [Bot09a].\nThe inclusion \u03b9 : (A\u2217 )3 ,\u2192 P11 defines a graded morphism of graded rings \u03b9\u2217 : K[T0 , . . . , T11 ]/J \u2192\nK[s, t, u]. This morphism maps T1 +T10 7\u2192 f1 , T7 7\u2192 g1 , T4 7\u2192 f2 , T7 7\u2192 g2 , T6 7\u2192 f3 , T5 7\u2192 g3 ,\nT0 7\u2192 f4 , and T11 7\u2192 g4 .\nHence, for \u03b1 = {1, 2}, we have that\nX\u03b1 = Proj(K[T0 , . . . , T11 ]/(J + (T1 + T10 , T4 , T7 ))).\nUsing Macaulay2, we can compute the primary decomposition of the radical ideal of (T1 +\nT10 , T4 , T7 ) in A := K[T0 , . . . , T11 ]/J, obtaining the two irreducible components X\u03b1,1 and\nX\u03b1,2 . Precisely,\nX\u03b1,1 = Proj(K[T0 , . . . , T11 ]/(J + (T10 , T8 , T7 , T6 , T4 , T2 , T1 , T0 ))), and\nX\u03b1,2 = Proj(K[T0 , . . . , T11 ]/(J + (T11 , T7 , T6 , T5 , T4 , T1 + T10 , T0 ))).\nAfter embedding (P1 )3 in P11 via \u03b9, we get that X\u03b1,1 = \u03b9\u2217 (L1 ) and X\u03b1,2 = \u03b9\u2217 (L2 ) which\ncoincides with the situation described above for T = P1 \u00d7 P1 \u00d7 P1 .\n\n5.2.2 The generic case\nIt was shown in [Bot09b] and [BDD09], that suitable compactifications of the source and\ntarget of f can really improve the computation time.\nWe give here a few examples of affine maps given by rational fractions with very different\ndenominators and as quotients of polynomials of different degree. In this case we see how\nthe different compactifications of the target can vary drastically the size of the matrices we\nobtain. This example is, in some sense nearer the generic case, where different denominators\noccur and the polynomials are not of the same degree. Hence, it is easy to construct a big\nfamily of examples just by modifying the one below.\n2\n\n2\n\n2 2\n\n2\n\n2\n\nt\ns +t\nExample 5.2.3. Take f : A2 99K A3 given by (s, t) 7\u2192 ( s st+t2 , ss2 +t\n). In order to be\n2,\ns2\n3\nable to compactify the target in P , we take common denominator. This process increases\nthe degrees of the maps by 3 and 4. This shows how \"fictitious\" can be in some cases to take\ncommon denominator. The consequences of this phenomena is that the Newton polytope\n\n102\n\n\fN one obtains from the new 4 polynomials is really big, in fact, it has 14 integer points.\nHence T embeds in P13 .\nIt is easy to see that N has no smaller contraction with integer vertices, hence the map \u03c6\none gets factorizing through T , is given by polynomials of degree 1 in 14 variables.\n\u03c6 : T 99K P3 : (T0 , . . . , T13 ) 7\u2192 (T1 + 2T6 + T13 : T12 : T0 + 2T4 + T10 : T4 + T10 ).\nAfter some computations one obtains that for \u03bd0 = 2, the matrix M\u03bd0 \u2208 Mat45,90 (K[X]) is\na matrix representation for the closed image of \u03c6. Hence, the gcd of the maximal minors\ngives the irreducible implicit equation of degree 7 up to a power of 2. Using the complex,\ndet(14\u00d714\u2212matrix)\n.\nthis polynomial can be computed as det(45\u00d745\u2212matrix).\ndet(45\u00d745\u2212matrix)\nAs we mentioned above, it is more natural in this case not to take common denominator.\nThus, consider the map \u03c6 that one obtains by factorizing f through T and then embedding\nA3 in (P1 )3 . It can be easily seen that the Newton polytope one gets has 6 integer points,\nhence, T embeds in P5 . Finally, one sees that the rational map \u03c6 is given by\n\u03c6 : P5 \u2283 T 99K P1 \u00d7 P1 \u00d7 P1 : (T0 , . . . , T5 ) 7\u2192 (T0 + T3 : T2 ) \u00d7 (T5 : T0 + T3 ) \u00d7 (T0 + T3 : T3 ).\nIt can be seen that in degree \u03b70 := 2 the complex (K\u2022 (L1 , L2 , L3 ; K[s, t, u][X]))(2,\u2217) permits to\ncompute M\u03b70 \u2208 Mat15,18 (K[X]), the matrix representation. Then, in this case, the square of\n.\nthe implicit equation can be computed as the gcd of its maximal minors or as det(15\u00d715\u2212matrix)\ndet(3\u00d73\u2212matrix)\nWe conclude that in a case where denominators are fairly different, it is notably better to\ncompactify the codomain of f into (P1 )3 .\nExample 5.2.4. This example shows how the methods work in the generic case with a\nfixed polytope. We begin by taking N a normal lattice polytope in Rn\u22121 . For the sake of\nclarity we will treat a particular case in small dimension. Hence, set n = 3, and consider N\nas in the drawing below. It will remain clear that this example can be generalized to any\ndimension and any normal polytope with integer vertices.\n3\n2b\n1b\n0\n0\n\nb\n\n1\n\nb\n\n2\n\n3\n\n103\n\n\fAssume we are given six generic polynomials f1 , f2 , f3 , g1 , g2 , g3 with support in N , hence\nwe get an affine rational map f : A2 99K A3 given by (s, t) 7\u2192 ( fg11 , fg22 , fg33 ). We write fi =\nP\nP\na b\na b\n(a,b)\u2208N U(a,b),i *s t , and gi =\n(a,b)\u2208N V(a,b),i *s t . Set U := {U(a,b),i , V(a,b),i : for all (a, b) \u2208\nN , and i = 1, 2, 3}, the set of coefficients, and define K := Z[U].\nNow we focus on computing the implicit equation of a convenient compactification for the\nmap. Let T be the toric variety associated to the Newton polytope N , embedded in P4 .\nWe will compare how the method works in the P3 and (P1 )3 compactifications of A3 with\ndomain T . One key point to remark is that these two maps have no base points, since we\nare taking the toric compactification associated to N and generic coefficients, hence, we will\nnot have any extraneous factors.\nIn the first case, we take common denominator obtaining four polynomials with generic\ncoefficients in the polytope 3N . If we consider the smallest multiple, we recover the polytope\nN , and maps of degree 3. We obtain in this case that f factorizes through T \u2282 P4 via\n\u03c6 : T 99K P3 , given by 4 polynomials of degree 3 in the variables T0 , . . . , T4 . From Lemma\n3.3.9, we take \u03bd0 := max{3, 6 \u2212 \u03b3}. Since 2N has integer interior points but N does not,\n\u03b3 = 1, thus \u03bd0 = 5. Now, since X is empty in T , from Lemma 3.3.5, the complex Z\u2022 is\nacyclic.\nFrom Theorem 3.3.10 we see that the implicit equation can be computed as the determinant\nof the complex (Z\u2022 )\u03bd for \u03bd \u2265 \u03bd0 , or as the gcd of the maximal minors of the right-most\nM\u03bd\nmap (Z1 )5 (\u22121) \u2212\u2192\n(Z0 )5 . We can easily compute the dimension of A5 , by the formula\n#(k * N ) = (k + 1)(k + 1 + k/2). When k = 5, we get #(5 * N ) = 51, hence (Z0 )5 = K51 [X].\nSince M\u03bd gives a surjective map, (Z1 )5 (\u22121) has dimension bigger than or equal to 51.\nInstead of taking common denominator, we can proceed by compactifying A3 into (P1 )3 .\nIn this case we get a map \u03c6 : T 99K (P1 )3 is given by 3 pairs of linear functions on the\nvariables T0 , . . . , T4 .\nFrom Theorem 4.3.5, we take \u03bd \u2265 \u03bd0 = 1+1+1\u22121 = 2. Now, since the polynomials fi and gi\nhave generic coefficients, hence Li := Yi fi \u2212Xi gi does as well, thus K\u2022 := K\u2022 (L1 , L2 , L3 ; A[X])\nis acyclic. From Lemma 4.4.2, the implicit equation can be computed as the determinant\nof the complex (K\u2022 )\u03bd for \u03bd \u2265 2, or as the gcd of the maximal minors of the right-most\nM2\nmap A31 [X](\u22121) \u2212\u2192\nA2 [X]. Since dim(A0 ) = 1, dim(A1 ) = 5 and dim(A2 ) = 12 we get\nM2\n3\nthe complex K [X](\u22122) \u2192 K15 [X](\u22121) \u2212\u2192\nK12 [X]. Thus, the implicit equation can be\n.\ncomputed as the gcd of the maximal minors of a (12 \u00d7 14)-matrix, or as det(12\u00d712-matrix)\ndet(3\u00d73-matrix)\n\n104\n\n\f5.2.3 A few example with artificial compactifications\nWe analyze here some small-dimensional examples that have been considered before by other\nauthors, where the method works fairly better with a homogeneous compactification of the\ncodomain. Finally, we illustrate that is much better not to take common denominator in\nthe generic case, by means of an example where denominators are different.\nExample 5.2.5. The first one is taken from [BC05, Ex. 3.3.1] as a base-point-free example.\nAssume we are given \u03c6 : P2 99K P3 : (s : t : u) 7\u2192 (g0 : g1 : g2 : g3 ), where g0 = s2 t, g1 =\nt2 u, g2 = su2 , g3 = s3 + t3 + u3 . In [BC05, Ex. 3.3.1] it is shown that \u03bd0 = 4 and no\nbetter bound can be considered. They deduce that M\u03bd0 \u2208 Mat24,15 (K[X0 , X1 , X2 , X3 ]),\nhence the implicit equation can be computed as the gcd of its maximal minors or as\ndet(15\u00d715\u2212matrix). det(3\u00d73\u2212matrix)\n.\ndet(9\u00d79\u2212matrix)\nNaturally, this problem can arise from many different affine settings. First, assume that u is\nthe homogenizing variable, and hence, the toric embedding would be A2 = {(s : t : 1)} \u2282 P2 .\nIn any of these cases, the Newton polytope is a triangle with vertices (0, 0), (3, 0) and (0, 3),\nhence every domain compactification will be a projective space. If we proceed by taking the\nembedding corresponding to the smallest homothety, this compactification is P2 . There are\nmany affine setting for which the projective compactification of the domain gives place to\nthe map we were given.\nAs a first approach, assume we consider fI : A2 99K A3 : (s, t) 7\u2192 ( ff03 , ff31 , ff23 ). The projective\ncodomain compactification is the one studied in [BC05, Ex. 3.3.1], hence we focus on the\nrational map\n\u03c6I : P2 99K P1 \u00d7 P1 \u00d7 P1 : (s : t : u) 7\u2192 (f0 : f3 ) \u00d7 (f1 : f3 ) \u00d7 (f2 : f3 ).\nIt is easy to verify that Avramov's conditions are satisfied, then the implicitization method\ndeveloped\nP3 in [Bot09b] can be applied. As all fi are of degree 3 (nothing gets simplified),\n\u03b70 :=\ni=1 (di \u2212 1) + 1 = 7. Introduce the variables X := {X1 , X2 , X3 , Y1 , Y2 , Y3 }, and\nthe linear forms L1 = f0 .Y1 \u2212 f3 .X1 , L2 = f1 .Y2 \u2212 f3 .X2 , L3 = f2 .Y3 \u2212 f3 .X3 . We have the\ncomplex (K\u2022 (L1 , L2 , L3 ; K[s, t, u][X]))(7,\u2217)\nM\n\n\u03bd\n(K\u2022 )(7,\u2217) : 0 \u2192 0 \u2192 (A1 )3 \u2297K K[X](\u22122) \u2192 (A4 )3 \u2297K K[X](\u22121) \u2212\u2192\nA7 \u2297K K[X] \u2192 0,\n\nSince dim((A1 )3 ) = 3.dim(A1 ) = 3.3 = 9, dim((A4 )3 ) = 3.dim(A4 ) = 3.15 = 45 and\ndim(A7 ) = 36, we get\nM\n\n\u03bd\n(K\u2022 )(7,\u2217) : 0 \u2192 0 \u2192 K9 [X](\u22122) \u2192 K45 [X](\u22121) \u2212\u2192\nK36 [X] \u2192 0,\n\n105\n\n\fhence, M\u03b70 \u2208 Mat36,45 (K[X]). Computing the gcd of its maximal minors or even as\ndet(36\u00d736\u2212matrix)\n, we get a multihomogeneous non-irreducible equation of multidegree (9, 9, 9)\ndet(9\u00d79\u2212matrix)\nthat gives the irreducible implicit equation of multidegree (6, 6, 6), and an extra factor\nG = Y13 Y23 Y33 (cf. Theorem 4.4.11).\nFor better understanding the nature of this extra factor, let us analyze the base locus of \u03c6I ,\nX. Observe that W = \u2205 and X = {q1 , q2 , q3 }, precisely, q1 = (1 : \u22121 : 0), q2 = (0 : 1 : \u22121)\nand q3 = (1 : 0 : \u22121). In the language of Section 4.4.2, \u0398 := {\u03b11 , \u03b12 , \u03b13 }, where \u03b11 = {1} \u2282\n{1, 2, 3}, \u03b12 = {2}, and \u03b13 = {3}, hence X\u03b1i := {qi }. Being this three sets irreducible and\ndisjoints, \u03a9\u03b1i = X\u03b1i . We have over each point qi a trivial multiprojective bundle E\u03b1i of rank\n2 isomorphic to P1 \u00d7 P1 . Clearly Yi is the irreducible implicit equation of \u03c02 (E\u03b1i ) \u2282 (P1 )3 ,\nand 3 the coefficient of the cycle (\u03c02 )\u2217 (E\u03b1i ).\nA different approach consists in considering the following affine map fII : A2 99K A3 :\n(s, t) 7\u2192 ( ff01 , ff20 , ff30 ). Simplifying, we get the following multiprojective setting\n\u03c6II : P2 99K P1 \u00d7 P1 \u00d7 P1 : (s : t : u) 7\u2192 (tu : s2 ) \u00d7 (u2 : st) \u00d7 (s3 + t3 + u3 : s2 t).\nAlso here, it is easy to verify that Avramov's hypotheses are verified, hence the implicitization method of [Bot09b] can be applied. We introduce the variables X := {X1 , X2 , X3 , Y1 , Y2 , Y3 },\nand the linear forms L1 = tu.Y1 \u2212 s2 .X1 , L2 = u2 .Y2 \u2212 st.X2 , L3 = (s3P\n+ t3 + u3 ).Y3 \u2212 s2 t.X3 .\nWe get that deg(L1 ) = deg(L2 ) = 2 and deg(L3 ) = 3, hence \u03b70 := 3i=1 (di \u2212 1) + 1 = 5.\nThe complex (K\u2022 (L1 , L2 , L3 ; K[s, t, u][X]))(5,\u2217) is\nM\n\n\u03bd\n(K\u2022 )(5,\u2217) : 0 \u2192 0 \u2192 (A20 \u2295A1 )\u2297K K[X](\u22122) \u2192 (A23 \u2295A2 )\u2297K K[X](\u22121) \u2212\u2192\nA5 \u2297K K[X] \u2192 0,\n\nand, since dim(A20 \u2295 A1 ) = 2 + 3 = 5, dim(A23 \u2295 A2 ) = 2.10 + 6 = 26 and dim(A5 ) = 21, it\nis isomorphic to\nM\n\n\u03bd\n(K\u2022 )(5,\u2217) : 0 \u2192 0 \u2192 K5 [X](\u22122) \u2192 K26 [X](\u22121) \u2212\u2192\nK21 [X] \u2192 0.\n\nThus, we get M\u03b70 \u2208 Mat21,26 (K[X]), and a multiple of the implicit equation can be computed\nas the gcd of its maximal minors or as det(21\u00d721\u2212matrix)\n. In this case, we get the irreducible\ndet(5\u00d75\u2212matrix)\nimplicit equation of multidegree (6, 6, 3) and a factor G = Y3 . Here, the extra factor occurs\ndue to the presence of a base point q = (0 : 1 : 0) that vanishes equations L1 and L2 , and\ngiving L3 (q, X) = t3 Y3 .\nWe can see that the method proposed in [BC05] seems to give smaller matrices, as was\npredicted for a problem coming from rational maps with the same denominator. In this\n\n106\n\n\fcase, the value \u03bd0 = 4 is the best bound for a problem like this, without base points; the\nadvantage it gives is that hence, no extra factors appear.\nOn the other hand, the method proposed in Chapter4 gives only two matrices, and it does\nnot involve the computation of the first, second and third syzygies needed for buildingup the approximation complex. With this setting we are also computing one extra factor\nthat appears due to the existence of base points with 2-dimensional fiber. Observe that\nin this last case, p = (0 : t : 0) forces L1 and L2 to vanish identically over p, and that\nL3 (p, X) = t3 .Y3 . From Theorem 4.4.11 we have that det((K\u2022 )(5,\u2217) ) = H deg(\u03c6II ) .Y3\u03bc , and\n\u03bc = 1.\nExample 5.2.6. This second example was taken from [BC05, Ex. 3.3.3] as a non-basepoint-free example. In the chapter the authors analyze the improvement of the bound, and\nhow, as they show in [BC05, Thm. 4.2], it decreases in presence of base points. Hence,\nassume we are given \u03c6 : P2 99K P3 , (s : t : u) 7\u2192 (g0 : g1 : g2 : g3 ), where g0 = su2 , g1 =\nt2 (s + u), g2 = st(s + u), g3 = tu(s + u). In [BC05, Ex. 3.3.3] they show that \u03bd0 = 4 can\nnow be lowered, taking as the best bound \u03bd0 = 2. They conclude that the implicit equation\n.\ncan be computed as det(6\u00d76\u2212matrix)\ndet(3\u00d73\u2212matrix)\nAlso in this example this problem can arrive from many different affine settings, so at first,\nlet us consider a multiprojective setting \u03c6I : P2 99K (P1 )3 . The idea is showing that even if\nP2 is not necessarily the \"best\" toric compactification of A2 , we can apply it in order to be\nin the setting of Chapter 4. Hence, consider \u03c6I defined as\n\u03c6I : P2 99K P1 \u00d7 P1 \u00d7 P1 : (s : t : u) 7\u2192 (su : t(s + u)) \u00d7 (t : u) \u00d7 (s : u).\nP\nWe have in degree \u03b70 := i (di \u2212 1) + 1 = 2 the complex (K\u2022 (L1 , L2 , L3 ; K[s, t, u][X]))(2,\u2217)\nand hence, M\u03b70 \u2208 Mat6,7 (K[X]), giving a multiple of the implicit equation as the gcd of its\ndet(6\u00d76\u2212matrix)\n.\nmaximal minors or as det(1\u00d71\u2212matrix)\nWith this setting we compute two extra factors that appear because of the presence of two\nbase points, p = (0 : t : 0) and q = (s : 0 : 0) having 2-dimensional fibers. Observe that\nL1 (p) = L3 (p) = 0, and that L2 (p, X) = t.Y2 ; and L1 (q) = L2 (q) = 0, and L3 (q, X) =\ns.Y3 . Hence, from Theorem 4.4.11 we have that det((K\u2022 )(2,\u2217) ) = H deg(\u03c6II ) .Y2\u03bc1 .Y3\u03bc2 , precisely\ndeg(\u03c6II ) = 1\u03bc1 = \u03bc2 = 1, and H has multidegree (1, 1, 1).\nWe will now choose a better compactification for A2 . Hence, define f : A2 99K A3 , as\nf (s, t) = fI (s : t : 1), the affine map of fI defined above. Considering both codomain\ncompactifications we obtain: First, the projective case, given by \u03c6II : P5 \u2283 T 99K P3 , given\nby (T0 : T1 : T2 : T3 : T4 : T5 ) 7\u2192 (T0 : T4 + T5 : T2 + T3 : T1 + T2 ), where T is the toric\nvariety associated to the Newton polytope of g, N (g). And second, the multiprojective\n\n107\n\n\fsetting \u03c6II : P3 \u2283 T 99K P1 \u00d7 P1 \u00d7 P1 , given by (T0 : T1 : T2 : T3 ) 7\u2192 (T1 : T2 + T3 ) \u00d7 (T2 :\nT0 ) \u00d7 (T1 : T0 ), where T is the toric variety associated to the Newton polytope of f , N (f ).\nHence T \u223c\n= P1 \u00d7 P1 , with it Segre embedding in P3 .\nFrom the map \u03c6II we obtain the matrix M\u03bd from the right-most map of the \u03bd graded strand\nof the approximation complex of cycles, for \u03bd0 = 1 (cf. Theorem 3.3.10). Computing the\ndimension of each module of cycle Zi [i * d] in Macaulay2 we get M\u03b70 \u2208 Mat6,10 (K[X]), hence\nthe implicit equation, of degree 3, can be computed as the gcd of its maximal minors or as\ndet(6\u00d76\u2212matrix). det(1\u00d71\u2212matrix)\n.\ndet(4\u00d74\u2212matrix)\nFinally\nlet us look at the case \u03c6II : T 99K P1 \u00d7 P1 \u00d7 P1 . We verify that in degree \u03b70 :=\nP\ni di \u2212\u03b3+1 = 3\u22122+1 = 2 (cf. Theorem 4.3.5), the complex (K\u2022 (L1 , L2 , L3 ; K[s, t, u][X]))(2,\u2217)\ngives M\u03b70 \u2208 Mat9,12 (K[X]), and thus a power of the implicit equation can be computed as\nthe gcd of its maximal minors or even as det(9\u00d79\u2212matrix)\n.\ndet(3\u00d73\u2212matrix)\nRemark 5.2.7. In the previous example we can appreciate that from the algorithmic point\nof view, considering the toric variety associated the Newton polytope of the defining polynomials, is not necessarily the most efficient choice in terms of the size of the matrices. In both\ncases, it seems to be a better option considering, as a polytope, the smallest contraction of\nthe triangle (3, 0), (0, 3), (0, 0), namely the triangle (1, 0), (0, 1), (0, 0).\n\nNewton polytope of g, N (g). Fig. (5.2.7)\n\n108\n\n\fNewton polytope of f , N (f ). Fig. (5.2.7)\nIt is clear that the toric variety it defines is T = P2 ; hence, the setting we consider is the\nmap \u03c6 : P2 99K P3 in the projective case, and \u03c6I : P2 99K (P1 )3 in the multiprojective one.\n\n5.3 Applications to the computation of sparse\ndiscriminants\nThe computation of sparse discriminants is equivalent to the implicitization problem for a\nparametric variety, to which we can apply the techniques developed in the previous sections.\nIn the situation described in [CD07], a rational map f : Cn 99K Cn given by homogeneous\nrational functions of total degree zero is associated to an integer matrix B of full rank. This\nis done in such a way that the corresponding implicit equation is a dehomogenization of a\nsparse discriminant of generic polynomials with exponents in a Gale dual of B.\nSuppose for instance that we take the matrix B below:\n\uf8eb\n\uf8f6\n1\n0\n0\n\uf8ec \u22122\n1\n0 \uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n1 \uf8f7\nB = \uf8ec 1 \u22122\n\uf8f7.\n\uf8ed 0\n1 \u22122 \uf8f8\n0\n0\n1\nIn this case, as the columns of B generate the affine relations of the lattice points {0, 1, 2, 3, 4}.\nThe closed image of the parametrization f is a dehomogenization of the classical discriminant of a generic univariate polynomial of degree 4. Explicitly, from the matrix we get the\nlinear forms l1 (u, v, w) = u, l2 (u, v, w) = \u22122u + v, l3 (u, v, w) = u \u2212 2v + w, l4 (u, v, w) =\nv \u2212 2w, l5 (u, v, w) = w (whose coefficients are read in the rows of B), and the polynomials\nf0 = l1 * l3 , g0 = l22 , f1 = l2 * l4 , g1 = l32 , f2 = l3 * l5 , g2 = l42 (the exponents of the linear\nforms are read from the columns of B) . This construction gives rise to the following rational\nmap:\nf : C3 99K C3\n, (\u22122u+v)(v\u22122w)\n, (u\u22122v+w)w\n).\n(u, v, w) 7\u2192 ( u(u\u22122v+w)\n(\u22122u+v)2\n(u\u22122v+w)2\n(v\u22122w)2\nFirst, we see that we can get a map from P2C because of the homogeneity of the polynomials.\nAlso, taking common denominator, we can have a map to P3C , this is:\nf : P2C 99K P3C\n(u : v : w) 7\u2192 (f0 : f1 : f2 : f3 ).\n109\n\n\fwhere f0 = (\u22122u + v)2 (u \u2212 2v + w)2 (v \u2212 2w)2 is the common denominator, f1 = u(u \u2212 2v +\nw)3 (v \u2212 2w)2 , f2 = (\u22122u + v)3 (v \u2212 2w)3 and f3 = (u \u2212 2v + w)w(\u22122u + v)2 (u \u2212 2v + w)2 .\nThe problem with this way of projectivizing is that, in general, we cannot implement the\ntheory developed by L. Bus\u00e9, M. Chardin, and J-P. Jouanolou, because typically the base\nlocus has unwanted properties, as a consequence of taking common denominator and because\nof combinatorial reasons.\nAs a possible way out, we propose in this work to consider the morphism of projective\nschemes given by:\n\u03c6 : P2 99K P1 \u00d7 P1 \u00d7 P1\n(u : v : w) 7\u2192 (f0 : g0 ) \u00d7 (f1 : g1 ) \u00d7 (f2 : g2 ).\nwhere f0 = u(u \u2212 2v + w), g0 = (\u22122u + v)2 , f1 = (\u22122u + v)(v \u2212 2w), g1 = (u \u2212 2v + w)2 ,\nf2 = (u \u2212 2v + w)w g2 = (v \u2212 2w)2 . For this particular example, we get that there are only\ntwo base points giving rise to an extra factor, namely p = (1 : 2 : 3) and q = (3 : 2 : 1). Is\neasy to see that those points give rise to two linear factors in the equation of the MacRae\ninvariant.\nFirst, we observe that this situation is better, because we are not adding common zeroes.\nMoreover, if a point (u : v : w) is a base point here, it also is in the two settings above: the\naffine and the projective case f .\nRemember also that in the n = 2 case, the condition required on the Koszul complex\nassociated to this map for being acyclic is that the variety X, defined as the common zeroes\nof all the 6 polynomials, be empty. In general, the conditions we should check are the ones\nimposed by the Avramov's theorem 4.3.4, as was shown in Theorem 4.4.2.\nNote also that if we want to state this situation in the language of approximation complexes,\nwe need only to replace K\u2022 by Z\u2022 , because we can assume that {fi , gi } are regular sequences,\ndue to the fact that gcd(fi , gi ) = 1.\nRemark 5.3.1. For a matrix like the B above, it is clear that the closed subvariety X is\nalways empty, due to the fact that all maximal minors of B are not zero, and the polynomials\ngi 's involve independent conditions. Then, the only common solution to l22 = l32 = l42 = 0 is\n(u, v, w) = (0, 0, 0), and so X = \u2205 in P2 . In this case, it is still better (from an algorithmic\napproach) to compute the discriminant of a generic polynomial of degree 4 in a single\nvariable and then dehomogenize, because, in our setting, the number of variables is bigger\nthan 1. But when the number of monomials of a sparse polynomial in many variables is not\nbig, this Gale dual approach for the computation of sparse discriminants provides a good\nalternative.\n\n110\n\n\fWe will give next an example where we show a more complicated case.\nExample 5.3.2. Let C be the matrix given by\n\uf8eb\n1 \u22127 \u22126\n\uf8ec \u22121\n4\n3\n\uf8ec\n\uf8ec\n0\n4\nC=\uf8ec 1\n\uf8ed 0\n1 \u22121\n\u22121\n2\n0\n\n\uf8f6\n\uf8f7\n\uf8f7\n\uf8f7.\n\uf8f7\n\uf8f8\n\nAs before, denoting by bi the i-th row of C, we get the linear forms li (u, v, w) = hbi , (u, v, w)i ,\nassociated to the row vectors bi of B, where h, i stands for the inner product in C3 . Then\nwe define the homogeneous polynomials f0 = l1 * l3 , g0 = l2 * l5 , f1 = l24 * l4 * l52 , g1 = l17 , f2 =\nl23 * l34 , f2 = l16 * l4 . And we obtain the following rational map:\n\u03c6 : P2 99K P1 \u00d7 P1 \u00d7 P1\n(u : v : w) 7\u2192 (f0 : g0 ) \u00d7 (f1 : g1 ) \u00d7 (f2 : g2 ).\nIt is easy to see that in this case the variety X is not empty, for instance the point p = (1 :\n1 : \u22121), defined by l1 = l2 = 0 belongs to X.\nAs was shown by M. A. Cueto and A. Dickenstein in [CD07, Lemma 3.1 and Thm. 3.4], we\ncan interpret the discriminant computed from the matrix C in terms of the dehomogenized\ndiscriminant associated to any matrix of the form C * M , where M is a square invertible\nmatrix with integer coefficients. That is, we are allowed to do operations on the columns of\nthe matrix C, and still be able to compute the desired discriminant in terms of the matrix\nobtained from C. In [CD07] they give an explicit formula for this passage.\nIn this particular case, we can multiply C from the right by a determinant 1 matrix M ,\nobtaining\n\uf8eb\n\uf8ec\n\uf8ec\nC *M =\uf8ec\n\uf8ec\n\uf8ed\n\n1 \u22127 \u22126\n\u22121\n4\n3\n1\n0\n4\n0\n1 \u22121\n\u22121\n2\n0\n\n\uf8f6\n\n\uf8eb\n\n\uf8eb\n\uf8f6\n\uf8ec\n\uf8f7\n1 12 \u22121\n\uf8ec\n\uf8f7\n\uf8f7 * \uf8ed 0 6 \u22121 \uf8f8 = \uf8ec\n\uf8ec\n\uf8f7\n\uf8ed\n\uf8f8\n0 5\n1\n\n1\n0\n0\n\u22121 \u22123\n0\n1 \u22128\n3\n0 11 \u22122\n\u22121\n0 \u22121\n\n\uf8f6\n\uf8f7\n\uf8f7\n\uf8f7.\n\uf8f7\n\uf8f8\n\nSimilar to what we have done before, we can see that the closed subvariety X associated to\nthe rational map that we obtain from the matrix C * M is empty. Observe that #V (I2 ) is\nfinite due to the fact that l2 = l4 = 0 or l3 = l4 = 0 or l3 = l5 = 0 should hold. Moreover\n\n111\n\n\fit is easy to verify that all maximal minors are nonzero, and this condition implies that\nany of the previous conditions define a codimension 2 variety, this is, a finite one. With\nthe notation of Chapter 4, a similar procedure works for seeing see that codimA (I3 ) \u2265 2.\nFinally the first part of Theorem 4.4.2 implies that the Koszul complex K\u2022 is acyclic and so\nwe can compute the Macaulay resultant as its determinant.\nMoreover, this property over the minors implies that codimA (I (i0 ) ) = 2 > k + 1 = 1 and\nthat codimA (I (i0 ) + I (i1 ) ) = 3 > k + 1 = 2. So, the second part of Theorem 4.4.2 tells us\nthat the determinant of the Koszul complex K\u2022 in degree greater than (2 + 8 + 3) \u2212 3 = 10\ndetermines exactly the implicit equation of the scheme theoretic image of \u03c6. Observe that,\nas was shown in [CD07, Thm. 2.5], for this map, we have that deg(\u03c6) = 1.\nWe remark that the process implemented for triangulating the matrix C via M is not\nalgorithmic for the moment.\n\n112\n\n\f6 G-graded Castelnuovo Mumford\nRegularity\n6.1 Introduction.\nCastelnuovo-Mumford regularity is a fundamental invariant in commutative algebra and\nalgebraic geometry. It is a kind of universal bound for important invariants of graded\nalgebras such as the maximum degree of the syzygies and the maximum non-vanishing\ndegree of the local cohomology modules.\nIntuitively, it measures the complexity of a module or sheaf. The regularity of a module\napproximates the largest degree of the minimal generators and the regularity of a sheaf\nestimates the smallest twist for which the sheaf is generated by its global sections. It has\nbeen used as a measure for the complexity of computational problems in algebraic geometry\nand commutative algebra (see for example [EG84] or [BM93]).\nOne has often tried to find upper bounds for the Castelnuovo-Mumford regularity in terms of\nsimpler invariants. The simplest invariants which reflect the complexity of a graded algebra\nare the dimension and the multiplicity. However, the Castelnuovo-Mumford regularity can\nnot be bounded in terms of the multiplicity and the dimension.\nAlthough the precise definition may seem rather technical. Indeed, the two most popular\ndefinitions of Castelnuovo-Mumford regularity are the one in terms of graded Betti numbers\nand the one using local cohomology.\nFor the first one, let k be a field, and let I be an homogeneous ideal in a polynomial ring\nR = k[x0 , ..., xn ] over a field k with characteristic zero. Consider the minimal free resolution\nof R/I as a graded R-module,\n*** \u2192\n\nM\nj\n\nR(\u2212di,j ) \u2192 * * * \u2192\n\nM\nj\n\nR(\u2212d1,j ) \u2192 R \u2192 R/I \u2192 0.\n\n113\n\n\fThen, the Castelnuovo-Mumford regularity of R/I is defined as\nreg(R/I) = max{di,j \u2212 i}.\ni,j\n\nL\nL\nIn general, for a finitely generated graded R-module M , write Fi = j R(\u2212di,j ) = j R[\u2212j]\u03b2ij ,\nfor a minimal free R-resolution of M and set p := pd(M ) = n \u2212 depth(M ). Observe that\nthe maps of F\u2022 \u2297R k are zero, thus, TorR\ni (M, k) = Hi (F\u2022 \u2297R k) = Fi \u2297R k and therefore\nR\nR\n\u03b2ij = dimk (Tori (M, k)j ). If Tori (M, k) 6= 0, set\nbi (M ) := max{\u03bc : TorR\ni (M, k)\u03bc 6= 0},\nelse, bi (M ) := \u2212\u221e. Hence bi (M ) is the maximal degree of a minimal generator of Fi , and\ntherefore of the module of i-th syzygies of M . The Castelnuovo-Mumford regularity is also\na measure of the maximal degrees of generators of the modules Fi :\nreg(M ) := max{bi (M ) \u2212 i}.\ni\n\nSecond, we can give two fundamental results that motivated defining Castelnuovo-Mumford\nregularity in terms of local cohomology: Grothendieck's theorem that asserts that Hmi (M ) =\n0 for i > dim(M ) and i < depth(M ), as well as the non vanishing of these modules for\ni = dim(M ) and i = depth(M ); and Serre's vanishing theorem that implies the vanishing\nof graded pieces Hmi (M )\u03bc for any i, and \u03bc \u001d 0. The Castelnuovo-Mumford regularity is a\nmeasure of this vanishing degree.\nIf Hmi (M ) 6= 0, set\n\nai (M ) := max{\u03bc|Hmi (M )\u03bc 6= 0},\n\nelse, set ai (M ) := \u2212\u221e. Then,\nreg(M ) := max{ai (M ) + i}.\ni\n\nThe maximum over the positive i's is also an interesting invariant:\ngreg(M ) := max{ai (M ) + i} = reg(M/Hm0 (M )).\ni>0\n\nThus, Castelnuovo-Mumford regularity measures more than the complexity of the ideal I\nand its syzygies. For more discussion on the regularity, refer to the survey of Bayer and\nMumford [BM93] or [Mum66].\n\n114\n\n\fAn interesting question is if one can give bounds for the regularity in terms of the degrees\nof generators of I. It turns out that such bounds are very sensitive to the singularities of\nthe projective scheme defined by I, and in general, are very hard to compute. Its value\nin bounding the degree of syzygies and constructing Hilbert schemes has established that\nregularity is an indispensable tool in both fields.\nThe aim of this paper is to develop a multigraded variant of Castelnuovo-Mumford regularity\nin the spirit of [MS04] and [HW04]. We work with modules over a commutative ring R\ngraded by a finitely generated abelian group G.\nOne motivation for studying regularity over multigraded polynomial rings comes from toric\ngeometry. For a simplicial toric variety X, the homogeneous coordinate ring, introduced\nin [Cox95], is a polynomial ring S graded by the divisor class group G of X. The dictionary linking the geometry of X with the theory of G-graded S-modules leads to geometric\ninterpretations and applications for multigraded regularity.\nIn [HW04] Hoffman and Wang define the concept of regularity for bigraded modules over\na bigraded polynomial ring motivated by the geometry of P1 \u00d7 P1 . They prove analogs of\nsome of the classical results on m-regularity for graded modules over polynomial algebras.\nIn [MS04] MacLagan and Smith develop a multigraded variant of Castelnuovo-Mumford\nregularity also motivated by toric geometry. They work with modules over a polynomial\nring graded by a finitely generated abelian group, in order to establish the connection with\nthe minimal generators of a module and its behavior in exact sequences. In this chapter,\nwe extend this work restating some of the results in [MS04].\nAs in the standard graded case, our definition of multigraded regularity involves the vanishing of graded components of local cohomology, following [HW04].\nOur notion of Multigraded Castelnuovo-Mumford regularity follows of existing ideas of\n[HW04] and [MS04]. In the standard graded case, it reduces to Castelnuovo-Mumford\nregularity (cf. [BM93]). When S is the homogeneous coordinate ring of a product of projective spaces, multigraded regularity is the weak form of bigraded regularity defined in\n[HW04].\nOne point we are interested in is that Castelnuovo-Mumford regularity establish a relation\nbetween the degrees of vanishing of local cohomology modules and the degrees where Tor\nmodules vanish. This provides a powerful tool for computing one region of Z in terms of\nthe other.\nIn this chapter, we deal with G-graded polynomial rings, where G is a finitely generated\nabelian group. We exploit some of the similarities we get in multigraded regularity with\n\n115\n\n\fstandard regularity, being able to compute the regions of G where local cohomology modules\nvanish in terms of the supports of Tor modules, and vice-versa.\nLet S be a commutative ring, G an abelian group and R := S[X1 , . . . , Xn ], with deg(Xi ) = \u03b3i\nand deg(s) = 0 for s \u2208 S. Consider B \u2286 (X1 , . . . , Xn ) a finitely generated graded R-ideal\nand C the monoid generated by {\u03b31 , . . . , \u03b3n }, we propose in Definition 6.3.1 that:\nFor \u03b3 \u2208 G, and for a homogeneous R-module M is weakly \u03b3-regular if\n[\n\u03b3 6\u2208\nSuppG (HBi (M )) + Ei .\ni\n\nWe also set that if further, M is weakly \u03b3 0 -regular for any \u03b3 0 \u2208 \u03b3 + C, then M is \u03b3-regular\nand\nreg(M ) := {\u03b3 \u2208 G | M is \u03b3\u2212regular}.\nWe deduce from the definition that reg(M ) is the maximal set S of elements in G such that\nS + C = S and M is \u03b3-regular for any \u03b3 \u2208 S.\n\n6.2 Local Cohomology and graded Betti numbers\nIn this chapter we develop a regularity theory for graded rings. Our aim is to give a more\ngeneral setting to that in [MS04] and [HW04], and to establish a clear relation between\nsupports of local cohomology modules with Tor modules and Betti numbers.\nThroughout this chapter let G be a finitely generated abelian group, and let R be a commutative G-graded ring with unit. Let B be a homogeneous ideal of R.\nRemark 6.2.1. Is of particular interest the case where R is a polynomial ring in n variables\nand G = Zn /K, is a quotient of Zn by some subgroup K. Note that, if M is a Zn -graded\nmodule over a Zn -graded ring, and G = Zn /K, we can give to M a G-grading coarser\nthan itsLZn -grading. For this, define the G-grading on M by setting, for each \u03b3 \u2208 G,\nM\u03b3 := d\u2208\u03c0\u22121 (\u03b3) Md .\nIn order to fix the notation, we state the following definitions concerning local cohomology of\ngraded modules, and support of a graded modules M on G. Recall that the cohomological\ndimension cdB (M ) of a module M is \u2212\u221e if M = 0 and max{i \u2208 Z : HBi (M ) = 0}\notherwise.\n\n116\n\n\fDefinition 6.2.2. Let M be a graded R-module, the support of the module M is SuppG (M ) :=\n{\u03b3 \u2208 G : M\u03b3 6= 0}.\nObserve that if F\u2022 is a free resolution of a graded module M , much information on the\nmodule can be read from the one of the resolution. Next we present a result that permits\ndescribing the support of a graded module M in terms of some homological information of a\ncomplex which need not be a resolution of M , but M is its first non-vanishing homology.\nDefinition 6.2.3. Let C\u2022 be a complex of graded R-modules. For all i, j \u2208 Z we define a\ncondition (Dij ) as above\nHBi (Hj (C\u2022 )) 6= 0 implies HBi+`+1 (Hj+` (C\u2022 )) = HBi\u2212`\u22121 (Hj\u2212` (C\u2022 )) = 0 for all ` \u2265 1.\n\n(Dij )\n\nWe have the following result on the support of the local cohomology modules of the homologies of C\u2022 .\nTheorem 6.2.4. Let C\u2022 be a complex of graded R-modules and i \u2208 Z. If (Dij ) holds, then\n[\nSuppG (HBi+k (Cj+k )).\nSuppG (HBi (Hj (C\u2022 ))) \u2282\nk\u2208Z\n\nProof. Consider the two spectral sequences that arise from the double complex C\u02c7B\u2022 C\u2022 of\ngraded R-modules.\nThe first spectral sequence has as second screen 02 Eji = HBi (Hj (C\u2022 )). Condition (Dij ) implies\nthat 0\u221e Eji = 02 Eji = HBi (Hj (C\u2022 )). The second spectral sequence has as first screen 001 Eji =\nHBi (Cj ).\nBy comparing both spectral sequences, we deduce that, for \u03b3 \u2208 G, the vanishing of\ni+`\n(HBi+k (Cj+k ))\u03b3 for all k implies the vanishing of (0\u221e Ej+`\n)\u03b3 for all `, hence the one of (HBi (Hj (C\u2022 )))\u03b3 .\n\nWe next give some cohomological conditions on the complex C\u2022 to imply (Dij ) of Definition\n6.2.3. Recall that for an R-module M we can compute\n\b\ncdB (M ) := min i : HB` (M ) = 0 for all i > ` ,\nwhich is called the cohomological dimension of M .\nRemark 6.2.5. Let C\u2022 be a complex of graded R-modules. Consider the following conditions\n\n117\n\n\f1. C\u2022 is a right-bounded complex, say Cj = 0 for j < 0 and, cdB (Hj (C\u2022 )) \u2264 1 for all\nj 6= 0.\n2. For some q \u2208 Z \u222a {\u2212\u221e}, Hj (C\u2022 ) = 0 for all j < q and, cdB (Hj (C\u2022 )) \u2264 1 for all j > q.\n3. Hj (C\u2022 ) = 0 for j < 0 and cdB (Hk (C\u2022 )) \u2264 k + i for all k \u2265 1.\nThen,\n(i) (1) \u21d2 (2) \u21d2 (Dij ) for all i, j \u2208 Z, and\n(ii) (3) \u21d2(Dij ) for j = 0.\nProof. For proving item (i), it suffices to show that (2) \u21d2 (Dij ) for all i, j \u2208 Z since (1) \u21d2 (2)\nis clear.\nLet ` \u2265 1.\nCondition (2) implies that HBi (Hj (C\u2022 )) = 0 for j > q and i 6= 0, 1 and for j < q. If\nHBi (Hj (C\u2022 )) 6= 0, either j > q and i \u2208 {0, 1} in which case j + ` > q and i + ` + 1 \u2265 2 and\ni \u2212 ` \u2212 1 < 0, or j = q in which case j + ` > q and i + ` + 1 \u2265 2 and j \u2212 ` < 0. In both\ncases the asserted vanishing holds.\nCondition (3) implies that HBi+`+1 (H` (C\u2022 )) = 0 and Hj\u2212` (C\u2022 ) = 0.\n\n6.2.1 From Local Cohomology to Betti numbers\nAssume R := S[X1 , . . . , Xn ] is a polynomial ring over a commutative ring S, deg(Xi ) = \u03b3i \u2208\nG for 1 \u2264 i \u2264 n and deg(s) = 0 for s \u2208 S. Set \u03b3 := (\u03b31 , . . . , \u03b3n ) \u2208 Gn .\nLet B \u2286 (X1 , . . . , Xn ) be a finitely generated graded R-ideal.\nDefinition 6.2.6. Set E0 := {0} and El := {\u03b3i1 + * * * + \u03b3il : i1 < * * * < il } for l 6= 0.\nObserve that if l < 0 or l > n, then El = \u2205. If \u03b3i = \u03b3 for all i, El = {l * \u03b3} when El 6= \u2205.\nNotation 6.2.7. For an R-module M , we denote by M [\u03b3 0 ] the shifted module by \u03b3 0 \u2208 G,\nwith M [\u03b3 0 ]\u03b3 := M\u03b3 0 +\u03b3 for all \u03b3 \u2208 G.\n\n118\n\n\fLet M be a graded R-module. Write K\u2022M := K\u2022 (X1 , . . . , Xn ; M ) for the Koszul complex of\nthe sequence (X1 , . . . , Xn ) with coefficients in M . We next establish a relationship between\nthe support of the local cohomologies of its homologies and graded Betti numbers of M .\nL\nThe Koszul complex K\u2022M is graded with KlM := i1 <***<il M [\u2212\u03b3i1 \u2212 * * * \u2212 \u03b3il ]. Let ZiM and\nBiM be the Koszul i-th cycles and boundaries modules, with the grading that makes the\ninclusions ZiM , BiM \u2282 KiM a map of degree 0 \u2208 G, and set HiM = ZiM /BiM .\nTheorem 6.2.8. Let M be a G-graded R-module. Then\n[\nSuppG (TorR\n(M,\nS))\n\u2282\n(SuppG (HBk (M )) + Ej+k ),\nj\nk\u22650\n\nfor all j \u2265 0.\nProof. Notice that HjM ' TorR\nj (M, S) is annihilated by B, hence has cohomological dimension 0 relatively to B. According to Remark 6.2.5 (case (1)), Theorem 6.2.4 applies and\nshows that\n[\n[\nSuppG (TorR\nSuppG (HB` (Kj+` )) =\n(SuppG (HBk (M )) + Ej+k ).\nj (M, S)) \u2282\n`\u22650\n\nk\u22650\n\n6.2.2 From Betti numbers to Local Cohomology\nIn this subsection we bound the support of local cohomology modules in terms of the\nsupport of Tor modules. This generalizes the fact that for Z-graded Castelnuovo-Mumford\nregularity, if ai (M ) + i \u2264 reg(M ) := maxi {bi (M ) \u2212 i}.\nWe keep same hypotheses and notation as in Section 6.2.1\nNext result gives an estimate of the support of local cohomology modules of a graded Rmodule M in terms of the supports of those of base ring and the twists in a free resolution.\nThis permits (combined with Lemma 6.2.10) to give a bound for the support of local cohomology modules in terms of Betti numbers.\nThe key technical point is that Lemma 6.2.10 part (1) and (2) give a general version of\nNakayama Lemma in order to relate 'shifts in a resolution' with support of Tor modules;\nwhile part (3) is devoted to give a 'base change lemma' in order to pass easily to localization.\n\n119\n\n\fTheorem 6.2.9. Let M be a graded\nL R-module and F\u2022 be a graded complex of free R-modules,\nwith H0 (F\u2022 ) = M . Write Fi =\nj\u2208Ei R[\u2212\u03b3ij ] and Ti := {\u03b3ij | j \u2208 Ei }. Let ` \u2265 0 and\nassume cdB (Hj (F\u2022 )) \u2264 ` + j for all j \u2265 1. Then,\nSuppG (HB` (M )) \u2282\n\n[\n\n(SuppG (HB`+i (R)) + Ti ).\n\ni\u22650\n\nProof. Lemma 6.2.5 (case (3)) shows that Theorem 6.2.4 applies for estimating the support of local cohomologies of H0 (F\u2022 ), and provides the quoted result as local cohomology\ncommutes with arbitrary direct sums\nSuppG (HBp (R[\u2212\u03b3])) = SuppG (HBp (R)) + \u03b3, and SuppG (\u2295i\u2208E Ni ) = \u222ai\u2208E SuppG (Ni )\nfor any set of graded modules Ni , i \u2208 E.\nLemma 6.2.10. Let M be a graded R-module.\n1. Let S be a field and let F\u2022 be a G-graded free resolution of a finitely generated module\nM . Then\nM\nR[\u2212\u03b3]\u03b2i,\u03b3 , and Ti = SuppG (TorR\nFi =\ni (M, S)).\n\u03b3\u2208Ti\n\n2. Assume that (S, m, k) is local. Then\nSuppG (TorR\ni (M, k)) \u2286\n\n[\n\nSuppG (TorR\nj (M, S)).\n\nj\u2264i\n\nProof. For Part (1) see [CJR11]. Part (3) follows from the fact that if (S, m, k) is local there\nR\nis an spectral sequence TorSp (TorR\nq (M, S), k) \u21d2 Torp+q (M, k) and the fact that S \u2282 R0 .\nCombining Theorem 6.2.9 with Lemma 6.2.10 (case (1)) one obtains:\nCorollary 6.2.11. Assume that S is a field and let M be a finitely generated graded Rmodule. Then, for any `,\n[\nSuppG (HB` (M )) \u2282 (SuppG (HB`+i (R)) + SuppG (TorR\ni (M, S))).\ni\u22650\n\nIf S is Noetherian, Lemma 6.2.10 (case (2)) implies the following:\n\n120\n\n\fCorollary 6.2.12. Assume that (S, m, k) is local Noetherian and let M be a finitely generated graded R-module. Then, for any `,\nS\nSuppG (HB` (M )) \u2282 i\u22650 (SuppG (HB`+i (R)) + SuppG (TorR\ni (M, k)))\nS\n`+i\n\u2282 i\u2265j\u22650 (SuppG (HB (R)) + SuppG (TorR\nj (M, S))).\nAfter passing to localization, Corollary 6.2.12 shows that:\nCorollary 6.2.13. Let M be a finitely generated graded R-module, with S Noetherian.\nThen, for any `,\n[\nSuppG (HB` (M )) \u2282\n(SuppG (HB`+i (R)) + SuppG (TorR\nj (M, S))).\ni\u2265j\u22650\n\nProof. Let \u03b3 \u2208 SuppG (HB` (M )). Then HB` (M )\u03b3 6= 0, hence there exists p \u2208 Spec(S) such\n`\n(M \u2297S Sp ) 6= 0. Applying Corollary 6.2.12 the result follows\nthat (HB` (M )\u03b3 ) \u2297S Sp = HB\u2297\nS Sp\nsince both the local cohomology functor and the Tor functor commute with localization in\nS, and preserves grading as S \u2282 R0 .\nNotice that taking G = Z and deg(Xi ) = 1, Corollaries 6.2.11, 6.2.12 and 6.2.13 give the\nwell know bound ai (M ) + i \u2264 maxi {bi (M ) \u2212 i}.\n\n6.3 Castelnuovo-Mumford regularity\nWe have mentioned in the beginning of this chapter that one point we are interested in\nremark is that Castelnuovo-Mumford regularity establishes a relation between the degrees\nof vanishing of local cohomology modules and the degrees where Tor modules vanish. It\nis clear that this provides a powerful tool for computing one region of Z in terms of the\nother.\nIn this section we give a definition for a G-graded R-module M and \u03b3 \u2208 G to be weakly\n\u03b3-regular or just \u03b3-regular, depending if \u03b3 is or is not on the shifted support of some local\ncohomology modules of M (cf. 6.3.1). This definition allows us to generalize the classical\nfact that weak regularity implies regularity.\nIn the later part of this section, in Theorem 6.3.3, we prove that for j \u2265 0, the supports of\nTorR\nj (M, S) does not meet the support of any shifted regularity region reg(M )+\u03b3 for \u03b3 moving on Ej . As we have mentioned in the introduction of this chapter, this result generalizes\nthe fact that when G = Z and the grading is standard, reg(M ) + j \u2265 end(TorR\nj (M, S)).\n\n121\n\n\f6.3.1 Regularity for Local Cohomology modules\nLet S be a commutative ring, G an abelian group and R := S[X1 , . . . , Xn ], with deg(Xi ) = \u03b3i\nand deg(s) = 0 for s \u2208 S. Let B \u2286 (X1 , . . . , Xn ) be a graded R-ideal and C be the monoid\ngenerated by {\u03b31 , . . . , \u03b3n }.\nDefinition 6.3.1. For \u03b3 \u2208 G, a graded R-module M is weakly \u03b3-regular if\n[\n\u03b3 6\u2208\nSuppG (HBi (M )) + Ei .\ni\n\nIf further M is weakly \u03b3 0 -regular for any \u03b3 0 \u2208 \u03b3 + C, then M is \u03b3-regular and\nreg(M ) := {\u03b3 \u2208 G | M is \u03b3\u2212regular}.\nIt immediately follows from the definition that reg(M ) is the maximal set S of elements in\nG such that S + C = S and M is weakly \u03b3-regular for any \u03b3 \u2208 S.\nLet {\u03b31 , . . . , \u03b3n } = {\u03bc1 , . . . , \u03bcp }, with \u03bci 6= \u03bcj for i 6= j. Denote by pi the ideal generated\nby the variables of degree \u03bci .\nThe following lemma generalizes the classical fact that weak regularity implies regularity\nunder some extra requirement.\nLemma 6.3.2. Assume that B \u2282 pi for every i. Let M be a graded R-module. If M is\nweakly \u03b3-regular and either HB0 (M )\u03b3+C = 0 or M is generated by elements whose degrees do\nnot belong to \u03b3 + C, then M is \u03b3-regular.\nProof. We induct on w(M ) := n \u2212 m, where m is the number of variables acting as 0 on M .\nLet i \u2208 {1, . . . , p}. We have to show that M is weakly (\u03b3 + \u03bci )-regular if one of the two\nconditions of the Lemma is satisfied. Assume that the variables Xj for j = j0i , . . . , jti are\nthe ones of degree \u03bci .\nIf w(M ) = 0, then M = 0 :M B = HB0 (M ). Further if M = HB0 (M ), both requirements are\nequivalent and the result follows as HBi (M ) = 0 for i > 0.\nOur statement is unchanged by faithfully flat extension and the Dedekind-Mertens Lemma\nshows that after making a polynomial extension S 0 := S[U1 , . . . Ut ] of S, the element fi :=\nXj0i + U1 Xj1i + * * * + Ut Xjti is a non-zero divisor on M/Hp0i (M ), hence on M 0 := M/HB0 (M ),\nas B \u2282 pi by hypothesis.\n\n122\n\n\fd\nNotice that w(M/fi M ) < w(M ) after identifying R/(fi ) with R0 := S 0 [X1 , . . . , X\nj0i , . . . , Xn ].\nFor any `, the exact sequence 0 \u2192 (0 :M (fi )) \u2192 M \u2192 M (\u03bci ) \u2192 (M/fi M )(\u03bci ) \u2192 0 gives\nrise to an exact sequence\nHB` (M ) \u2192 HB` (M )(\u03bci ) \u2192 HB` (M/fi M )(\u03bci ) \u2192 HB`+1 (M ).\nThe right part of the sequence shows that M/fi M is weakly \u03b3-regular, hence, by induction\nhypothesis, \u03b3-regular if M/fi M is generated by elements whose degrees do not belong to\n\u03b3 + C (for instance if M is so) and (M/fi M )/HB0 (M/fi M ) is \u03b3-regular in any case.\nFrom the left part of the sequence, we deduce that M is (\u03b3 + \u03bci )-regular if M is generated\nby elements whose degrees do not belong to \u03b3 + C and M/HB0 (M ) is (\u03b3 + \u03bci )-regular in any\ncase, which proves our claim.\nTheorem 6.3.3. Let M be a G-graded R-module. Then\n\\\n\\\n(reg(M ) + \u03b3) SuppG (TorR\nj (M, S)) = \u2205\n\u03b3\u2208Ej\n\nfor all j \u2265 0.\nWhen G = Z and the grading is standard, this reads with the usual definition of reg(M ) \u2208\nZ:\nreg(M ) + j \u2265 end(TorR\nj (M, S)).\n`\nProof. If \u03b3 \u2208 SuppG (TorR\nj (M, S)), then it follows from Theorem 6.2.8 that \u03b3 \u2208 SuppG (HB (M ))+\nEj+` for some `. Hence\n\n\u03b3 \u2212 \u03b3i1 \u2212 * * * \u2212 \u03b3ij+` \u2208 SuppG (HB` (M ))\nfor some i1 < * * * < ij+` . By definition it follows that if \u03bc \u2208 reg(M ) and t1 < * * * < t` , then\n\u03b3 \u2212 \u03b3i1 \u2212 * * * \u2212 \u03b3ij+` 6= \u03bc \u2212 \u03b3t1 \u2212 * * * \u2212 \u03b3t`\nin particular choosing tk := ij+k one has\n\u03b3 \u2212 \u03b3i1 \u2212 * * * \u2212 \u03b3ij 6\u2208 reg(M ).\n\nOn the other hand, Corollary 6.2.13 shows that :\n\n123\n\n\fProposition 6.3.4. Assume S is Noetherian, let M be a finitely generated G-graded Rmodule and set Ti := SuppG (TorR\ni (M, S)). Then, for any `,\n[\nSuppG (HB` (M ) + E` ) \u2282 (SuppG (HB`+i (R)) + E` + Tj ).\ni\u2265j\n\nIf further S is a field,\nSuppG (HB` (M ) + E` ) \u2282\n\n[\n(SuppG (HB`+i (R)) + E` + Ti ).\ni\n\nIn some applications it is useful to consider local cohomologies of indices at least equal to\nsome number, for instance positive values or values at least two. In view of Lemma 6.3.2,\nmost of the time weak regularity and regularity agrees in this case. We set :\n[\nreg` (M ) := {\u03b3 | \u2200\u03b3 0 \u2208 C, \u03b3 + \u03b3 0 6\u2208\nSuppG (HBi (M )) + Ei }.\ni\u2265`\n\nWith this notation, Proposition 6.3.4 implies the following\nTheorem 6.3.5. Assume S is Noetherian, let M be a finitely generated G-graded R-module\nand set Ti := SuppG (TorR\ni (M, S)). Then, for any `,\n\\\n\\\n\u03b3 \u2212 \u03b3 0 + C.\nreg`+i (R) + \u03b3 \u2212 \u03b3 0 \u2287 reg` (R) +\nreg` (M ) \u2287\nj\u2264i,\u03b3\u2208Tj ,\u03b3 0 \u2208Ei\n\nj\u2264i,\u03b3\u2208Tj ,\u03b3 0 \u2208Ei\n\nThe above intersection can be restricted to i \u2264 cdB (R) \u2212 `. If further S is a field,\n\\\n\\\nreg` (M ) \u2287\nreg`+i (R) + \u03b3 \u2212 \u03b3 0 \u2287 reg` (R) +\n\u03b3 \u2212 \u03b3 0 + C.\ni,\u03b3\u2208Ti ,\u03b3 0 \u2208Ei\n\ni,\u03b3\u2208Ti ,\u03b3 0 \u2208Ei\n\nWhen G = Z and the grading is standard, this reads with the usual definition of reg` (M ) \u2208\nZ:\nreg` (M ) \u2264 reg` (R) + max{end(TorR\ni (M, S)) \u2212 i}.\ni\n\nProof. If \u03bc 6\u2208 reg` (M ), by Proposition 6.3.4, there exists i \u2265 j such that\n\u03bc \u2208 SuppG (HB`+i (R)) + E` + Tj\nhence there exists \u03b3 0 \u2208 Ei and \u03b3 \u2208 Tj such that\n\n\u03bc + \u03b3 0 \u2212 \u03b3 \u2208 SuppG (HB`+i (R)) + Ei+` .\n\nTherefore \u03bc 6\u2208 reg`+i (R) + \u03b3 \u2212 \u03b3 0 .\n\n124\n\n\f6.4 Local cohomology of multigraded polynomial rings\nLet k be a commutative ring, s and m be fixed positive integers, r1 \u2264 * * * \u2264 rs non-negative\nintegers, and write xi = (xi,1 , . . . , xi,ri ) for 1 \u2264 i \u2264 s.\n\nDefineN\nRi := k[xi ], the standard Z-graded\npolynomial ring in the variables xi for 1 \u2264 i \u2264 s,\nN\nR =\nk Ri , and R(a1 ,...,as ) :=\nk (Ri )ai stands for its multigraded part of multidegree\n(a1 , . . . , as ).\nDefinition 6.4.1. We define \u0158i :=\n\n\u22121\n1\nk[x\u22121\ni,1 , . . . , xi,ri ].\nxi,1 ***xi,ri\n\nit \u2264 s, take \u03b1 = {i1 , . . . , it }, and set \u0158\u03b1 :=\n\n\u0010N\n\nj\u2208\u03b1\n\n\u0158j\n\n\u0011\n\nGiven integers 1 \u2264 i1 < * * * <\n\u0010N\n\u0011\n\u2297k\nR\nj .\nj \u2208\u03b1\n/\n\nN\nRemark 6.4.2. Observe that \u0158{i} \u223c\n= \u0158i \u2297k j6=i Rj .\nDefinition 6.4.3. Given integers 1 \u2264 i1 < * * * < it \u2264 s, take \u03b1 = {i1 , . . . , it }. For any\ninteger j write sg(j) := 1 if j \u2208 \u03b1 and sg(j) := 0 if j \u2208\n/ \u03b1. We define\nY\nQ\u03b1 :=\n(\u22121)sg(j) N \u2212 sg(j)rj ej \u2282 Zs ,\n1\u2264j\u2264s\n\nthe shift of the orthant whose coordinates {i1 , . . . , it } are negative and the rest are all\npositive. We set ai for the R-ideal generated by the elements in xi , B := a1 * * * as , a\u03b1 :=\nai1 + * * * + ait and |\u03b1| = ri1 + * * * + rit .\nLemma 6.4.4. For every \u03b1 \u2282 {1, . . . , s}, we have SuppZs (\u0158\u03b1 ) = Q\u03b1 .\nRemark 6.4.5. For \u03b1, \u03b2 \u2282 {1, . . . , s}, if \u03b1 6= \u03b2, then Q\u03b1 \u2229 Q\u03b2 = \u2205.\nLemma 6.4.6. Given integers 1 \u2264 i1 < * * * < it \u2264 s, let \u03b1 = {i1 , . . . , it }. There are graded\nisomorphisms of R-modules\nHa|\u03b1|\n(R) \u223c\n(6.1)\n= \u0158\u03b1 .\n\u03b1\nProof. Recall that for any ring S and any S-module M , if x1 , . . . , xn are variables, then\n\u001a\n0\nif i 6= n\ni\nH(x1 ,...,xn ) (M [x1 , . . . , xn ]) =\n(6.2)\n\u22121\n1\n\u22121\nM\n[x\n,\n.\n.\n.\n,\nx\n]\nfor\ni = n.\n1\nn\nx1 ***xn\nWe induct on |\u03b1|. The result is obvious for |\u03b1| = 1. Assume that |\u03b1| \u2265 2 and (6.1) holds\nfor |\u03b1| \u2212 1. Take I = ai1 * * * ait\u22121 and J = ait . There is a spectral sequence HJp (HIq (R)) \u21d2\np+q\n(R). By (6.2), HJp (R) = 0 for p 6= rit . Hence, the spectral sequence stabilizes in\nHI+J\nr\n|\u03b1|\u2212rit\n|\u03b1|\ndegree 2, and gives H it (H\n(R)) \u223c\n= H (R). The result follows by applying (6.2) with\nJ\n\nM=\n\n|\u03b1|\u2212r\nHI it (R),\n\nI\n\nI+J\n\nand inductive hypothesis.\n\n125\n\n\fLemma 6.4.7. With the above notations,\nM\nr +***+r\nHB` (R) \u223c\nHaii11+***+aiitt (R) \u223c\n=\n=\n1 \u2264 i1 < * * * < i t \u2264 s\nri1 + * * * + rit \u2212 (t \u2212 1) = `\n\nM\n\n\u0158\u03b1 .\n\n(6.3)\n\n\u03b1 \u2282 {1, . . . , s}\n|\u03b1| \u2212 (#\u03b1 \u2212 1) = `\n\nProof. The second isomorphism follows from 6.4.6. For proving the first isomorphism, we\ninduct on s. The result is obvious for s = 1. Assume that s \u2265 2 and (6.3) holds for\ns \u2212 1. Take I = a1 * * * as\u22121 and J = as . The Mayer-Vietoris long exact sequence of local\ncohomology for I and J is\n\u03c8`+1\n\n\u03c8\n\n`+1\n`\n`\n* * * \u2192 HI+J\n(R) \u2192` HI` (R) \u2295 HJ` (R) \u2192 HIJ\n(R) \u2192 HI+J\n(R) \u2192 HI`+1 (R) \u2295 HJ`+1 (R) \u2192 * * * .\n(6.4)\n`+1\n`\n`\n`\n`\n\u223c\nRemark that if ` < rs , then HJ (R) = HI+J (R) = HI+J (R) = 0. Hence, HB (R) = HI (R).\nWrite R\u0303 := R1 \u2297k * * * \u2297k Rs\u22121 . Since the variables xs does not appear on I, by flatness of\nRs and the last isomorphism, we have that HB` (R) \u223c\n= HB` (R\u0303) \u2297k Rs . In this case, the result\nfollows by induction.\n\nThus, assume ` \u2265 rs . We next show that the map \u03c8` in the sequence (6.4) is the zero map\np+q\nfor all `. Indeed, there is an spectral sequence HJp (HIq (R)) \u21d2 HI+J\n(R). Since HJp (R) = 0\n`\nfor p 6= rs , it stabilizes in degree 2, and gives HJrs (HI`\u2212rs (R)) \u223c\n(R). We have graded\n= HI+J\nisomorphisms\n\u223c `\u2212rs (R\u0303) \u2297k \u0158s ,\nHJrs (HI`\u2212rs (R)) \u223c\n= HJrs (HI`\u2212rs (R\u0303) \u2297k Rs ) \u223c\n= (HI`\u2212rs (R\u0303))[x\u22121\ns ] = HI\n\n(6.5)\n\nwhere the first isomorphism comes from flatness of Rs over k, the second isomorphism\nfollows from equation (6.2) taking M = HI`\u2212rs (R\u0303). By (6.5) and the inductive hypothesis\nwe have that.\nM\nri +***+rit\u22121\nHJrs (HI`\u2212rs (R)) \u223c\nHai11+***+ait\u22121\n(R\u0303) \u2297k \u0158s .\n(6.6)\n=\n1 \u2264 i1 < * * * < it\u22121 \u2264 s \u2212 1\nri1 + * * * + rit\u22121 \u2212 (t \u2212 2) = ` \u2212 rs\n\n`\n`\nNow, observe that the map (HI`\u2212rs (R\u0303))[x\u22121\ns ] \u2192 HI (R) \u2295 HJ (R) is graded of degree 0.\nRecall from Lemma 6.4.4 and 6.4.6, and Remark 6.4.5 we deduce SuppZs ((HI`\u2212rs (R\u0303))[x\u22121\ns ])\u2229\nSuppZs (HI` (R) \u2295 HJ` (R)) = \u2205. Thus, every homogeneous element on (HI`\u2212rs (R\u0303))[x\u22121\ns ] is\nnecessary mapped to 0.\n\nHence, for each `, we have a short exact sequence\n`\n0 \u2192 HI` (R) \u2295 HJ` (R) \u2192 HIJ\n(R) \u2192 HJrs (HI`+1\u2212rs (R)) \u2192 0.\n\n126\n\n(6.7)\n\n\fObserve that this sequence has maps of degree 0, and for each degree a \u2208 Zs the homogeneous strand of degree a splits. Moreover,\n`\n`\n`\nSuppZs ((HI`+1\u2212rs (R\u0303))[x\u22121\ns ]) t SuppZs (HI (R) \u2295 HJ (R)) = SuppZs (HIJ (R)).\n`\nNamely, every monomial in HIJ\n(R) eater comes from the module (HI`+1\u2212rs (R\u0303))[x\u22121\ns ] or it is\n`\n`\nmapped to HI (R) \u2295 HJ (R) injectively, splitting the sequence (6.7) of R-modules. Hence,\n\nHB` (R) \u223c\n= HI` (R) \u2295 HJ` (R) \u2295 HJrs (HI`+1\u2212rs (R)).\nNow, HI` (R) \u223c\n= HB` (R\u0303) \u2297k Rs , HJ` (R) = 0 if ` 6= rs and HJrs (R) = \u0158s . The result follows by\ninduction and equation (6.6).\nCorollary 6.4.8. Assume that (S, m, k) is local Noetherian and let M be a finitely generated\nG-graded R-module. Then, for any `,\nS\nSuppG (HB` (M )) \u2282 (SuppG (HB`+i (R)) + SuppG (TorR\ni (M, k)))\ni\u22650 \uf8eb\n\uf8f6\nS\nS\n\uf8ed\n\uf8f8.\n=\nQ{i1 ,...,it } + SuppG (TorR\ni (M, k))\ni\u22650\n\n1 \u2264 i1 < * * * < it \u2264 s\nri1 + * * * + rit \u2212 (t \u2212 1) = ` + i\n\nProof. Follows from Corollary 6.2.12 and Lemma 6.4.7.\nWhenever S is Noetherian, Corollary 6.2.13 provides an estimate of SuppG (HB` (M )) in\nterms of the sets SuppG (TorR\ni (M, S)).\nRecall that we have seen in Theorem 6.2.4 that if C\u2022 is a complex of graded R-modules,\nassuming (Dij ) we have that for all i \u2208 Z\n[\nSuppG (HBi (Hj (C\u2022 ))) \u2282\nSuppG (HBi+k (Cj+k )).\nk\u2208Z\n\nFor i = 1, . . . , m, take fi \u2208 R homogeneous of the same degree \u03b3 for all i. Let M be a\ngraded R-module. Denote by K\u2022M L\nthe Koszul complex K\u2022 (f1 , . . . , fm ; R) \u2297R M . The Koszul\ncomplex K\u2022M is graded with Ki := l0 <***<li R(\u2212i*\u03b3). Set HiM := Hi (K\u2022M ) the i-th homology\nmodule of K\u2022M .\nCorollary 6.4.9. If cdB (HiM ) \u2264 1 for all i > 0. Then, for all j \u2265 0\n[\nSuppG (HBi (HjM )) \u2282\n(SuppG (HBk (M )) + k * \u03b3) + (j \u2212 i) * \u03b3.\nk\u2208Z\n\n127\n\n\fProof. This L\nfollows by a change of variables in the index k in Lemma 6.2.4. Since C\u2022 is K\u2022M\nM\nand Ki := l0 <***<li M (\u2212i * \u03b3), we get that\nSuppG (HBi (HjM )) \u2282\n\n[\n\nM\nSuppG (HBk (Kk+j\u2212i\n)) =\n\nk\u2208Z\n\n[\n\n(SuppG (HBk (M )[\u2212(k + j \u2212 i) * \u03b3]).\n\nk\u2208Z\n\nThe conclusion follows from 6.2.7.\nRemark 6.4.10. In the special case where M = R, we deduce that if cdB (Hi ) \u2264 1 for all\ni > 0,\n[\nSuppG (HBi (Hj )) \u2282\n(SuppG (HBk (R)) + k * \u03b3) + (j \u2212 i) * \u03b3, for all i, j.\nk\u2208Z\n\nTake j = 0 and write I := (f1 , . . . , fm ), we get\nSuppG (HBi (R/I)) \u2282\n\n[\n\n(SuppG (HBk (R)) + (k \u2212 i) * \u03b3),\n\nfor all i.\n\nk\u2208Z\n\nExample 6.4.11. Let k be a field. Take R1 := k[x1 , x2 ], R2 := k[y1 , y2 , y3 , y4 ], and G := Z2 .\nWrite R := R1 \u2297k R2 and set deg(xi ) = (1, 0) and deg(yi ) = (0, 1) for all i. Set a1 := (x1 , x2 ),\na2 := (y1 , y2 , y3 , y4 ) and define B := a1 * a2 \u2282 R the irrelevant ideal of R, and m := a1 + a2 \u2282\nR, the ideal corresponding to the origin in Spec(R).\nFrom Lemma 6.4.7, it follows that\n1. HB2 (R) \u223c\n= \u0158{1} \u223c\n= Ha21 (R) = \u03c9R\u22281 \u2297k R2 ,\n2. HB4 (R) \u223c\n= \u0158{2} \u223c\n= Ha42 (R) = R1 \u2297k \u03c9R\u22282 ,\n3. HB5 (R) \u223c\n= \u0158{1,2} \u223c\n= Hm6 (R) = \u03c9R\u2228 ,\n4. HB` (R) = 0 for all ` 6= 2, 4 and 5.\nHence, we see that\n1. SuppG (HB2 (R)) = SuppG (\u01581 ) = Q{1} = \u2212N \u00d7 N + (\u22122, 0), .\n2. SuppG (HB4 (R)) = SuppG (\u01582 ) = Q{2} = N \u00d7 \u2212N + (0, \u22124), .\n3. SuppG (HB5 (R)) = SuppG (\u01581,2 ) = Q{1,2} = \u2212N \u00d7 \u2212N + (\u22122, \u22124), .\n\n128\n\n\f2\nSuppZ2 (HB\n(R))\n\n(-2,0)\n\n(0,0)\nb\n\n(-1,-3)\n\nb\n\n(-2,-4)\n\nb\n\n(0,-4)\n\n5\nSuppZ2 (HB\n(R))\n\n4\nSuppZ2 (HB\n(R))\n\nTake f1 , . . . , fm homogeneous elements of bidegree \u03b3, and write I := (f1 , . . . , fm ). Assume\ncdB (R/I) \u2264 1, hence cdB (Hi ) \u2264 1 for all i. We will compute reg(R/I).\nDefine for every \u03b3 \u2208 G,\nSB (\u03b3) :=\n\n[\n\n(SuppG (HBk (R)) + k * \u03b3).\n\n(6.8)\n\nk\u22650\n\nThus, in this case, we have\nSB (\u03b3) := (SuppG (HB2 (R)) + 2 * \u03b3) \u222a (SuppG (HB4 (R)) + 4 * \u03b3) \u222a (SuppG (HB5 (R)) + 5 * \u03b3)\n\nSince HB` (R) = 0 for all ` 6= 2, 4 and 5, from 6.4.10 we get that for all i, SuppG (HBi (R/I)) \u2282\nSB (\u03b3) \u2212 i * \u03b3. By definition, reg(R/I) \u2283 {SB (\u03b3). Take \u03b3 := (2, 5) just to draw it.\n\n129\n\n\f(3,22)\n\n(2,21)\n\nb\n\n(8,21)\nb\n\n(8,16)\n(2,10)\nb\n\nSB (\u03b3)\n\n130\n\n\f7 Implicit equation of multigraded\nhypersurfaces\n7.1 Introduction\nIn this chapter we present a method for computing the implicit equation of a hypersurface\ngiven as the image of a rational map \u03c6 : X 99K Pn , where X is a normal toric variety. In\nChapters 3 and 4, the approach consisted in embedding the space X in a projective space,\nvia a toric embedding. The need of the embedding comes from the necessity of a Z-grading\nin the coordinate ring of X , in order to study its regularity.\nThe aim of this chapter is to give an alternative to this approach: we study the implicitization problem directly, without an embedding in a projective space, by means of the results\nof Chapter 6. Indeed, we deal with the multihomogeneous structure of the coordinate ring\nS of X , and we adapt the method developed in Chapters 1, 3 and 4 to this setting. The\nmain motivations for our change of perspective are that it is more natural to deal with\nthe original grading on X , and that the embedding leads to an artificial homogenization\nprocess that makes the effective computation slower, as the number of variables to eliminate\nincreases.\nIn Definition 7.2.11 we introduce the \"good\" region in G where the approximation complex\nZ\u2022 and the\nS symmetric algebra SymR (I) has no B-torsion. Indeed, we define for \u03b3 \u2208 G,\nRB (\u03b3) := 0<k<min{m,cdB (R)} (SB (\u03b3) \u2212 k * \u03b3) \u2282 G. This goes in the direction of proving the\nmain theorem of this chapter, Theorem 7.3.4. Precisely, when X is a (d \u2212 1)-dimensional\nnon-degenerate toric variety over a field K, and S its Cox ring (cf. 2.4). For a rational\nmap \u03c6 : X 99K Pd defined by d + 1 homogeneous elements of degree \u03c1 \u2208 Cl(X ). If\ndim(V (I)) \u2264 0 in X and V (I) is almost a local complete intersection off V (B), we prove\nin Theorem 7.3.4 that,\ndet((Z\u2022 )\u03b3 ) = H deg(\u03c6) * G \u2208 K[T],\nfor all \u03b3 \u2208\n/ RB (\u03c1), where H stands for the irreducible implicit equation of the image of \u03c6,\nand G is relatively prime polynomial in K[T].\n\n131\n\n\fThis result can be compared with Theorem 4.4.11 and Corollary 3.3.10.\n\n7.2 Commutative algebra tools\n7.2.1 Regularity for commutative G-graded rings\nThroughout this chapter let G be a finitely generated abelian group, and let R be a commutative G-graded ring with unity. Let B be an homogeneous ideal of R. Take m a positive\ninteger and let f := (f0 , . . . , fm ) be a tuple of homogeneous elements of R, with deg(fi ) = \u03b3i ,\nand set \u03b3 := (\u03b30 , . . . , \u03b3m ). Write I = (f0 , . . . , fm ) for the homogeneous R-ideal generated\nby the fi .\nOur main motivation in Chapter 6 for considering regularity in general G-gradings comes\nfrom toric geometry. Among G-graded rings, homogeneous coordinate rings of a toric\nvarieties are of particular interest in geometry. When X is a toric variety, G := Cl(T )\nis the (torus-invariant) divisor class group of X . In this case, the grading can be related\ngeometrically with the action of this group on the toric variety. Thus, as we mentioned in\nRemark 6.2.1 is of particular interest the case where R is a polynomial ring in n variables\nand G = Zn /K, is a quotient of Zn by some subgroup K. Note that, if M is a Zn -graded\nmodule over a Zn -graded ring, and G = Zn /K, we can give to M a G-grading coarser\nthan itsLZn -grading. For this, define the G-grading on M by setting, for each \u03b3 \u2208 G,\nM\u03b3 := d\u2208\u03c0\u22121 (\u03b3) Md .\nIn this section we will present several results concerning vanishing of graded parts of certain modules. In our applications we will mainly focus on vanishing of Koszul cycles and\nhomologies. We recall here what the support of a graded modules M is. Recall from Definition 6.2.2 that for graded R-module M , we define the support of the module M on G as\nSuppG (M ) := {\u03b3 \u2208 G : M\u03b3 6= 0}.\nRecall that from Theorem 6.2.4 that for a complex C\u2022 of graded R-modules, for which one\nof the following holds\n1. For some q \u2208 Z, Hj (C\u2022 ) = 0 for all j < q and, cdB (Hj (C\u2022 )) \u2264 1 for all j > q.\n2. cdB (Hj (C\u2022 )) \u2264 1 for all j \u2208 Z.\n\nwe get that, for i = 0, 1,\nSuppG (HBi (Hj (C\u2022 ))) \u2282\n\n132\n\n[\nk\u2208Z\n\nSuppG (HBi+k (Cj+k )).\n\n\fWe have seen in that much of the information of the supports of the local cohomologies of the\nhomologies of a complex C\u2022 is obtained from the supports of the local cohomologies of the\ncomplex. For instance, if C\u2022 is a free resolution of a graded R-module Q, the supports of the\nlocal cohomologies of Q can be controlled in terms of the supports of the local cohomologies\nof the base ring R, and the shifts appearing in the Ci 's.\nIn order to lighten the reading of this chapter, following equation (6.8), we extend the\ndefinition as follows\nLet P be a graded R-module. For every \u03b3 \u2208 G, we define\n[\nSB (\u03b3; P ) :=\n(SuppG (HBk (P )) + k * \u03b3).\n\n(7.1)\n\nk\u22650\n\nWe will write SB (\u03b3) := SB (\u03b3; R) as in equation (6.8).\nRemark 7.2.1. Recall from Remark 6.2.7 that for an R-module P , we denote by P [\u03b3 0 ] the\nshifted module by \u03b3 0 \u2208 G, with P [\u03b3 0 ]\u03b3 := P\u03b3 0 +\u03b3 . Hence, SB (\u03b3; P [\u03b3 0 ]) = SB (\u03b3; P ) \u2212 \u03b3 0 .\nWe apply Theorem 6.2.4 and Remark 6.2.5 in the particular case where C\u2022 is the Koszul\ncomplex of a tuple f with coefficients in P , and we bound the support of the local cohomologies of its homologies in terms of the sets SB (\u03b3; P ).\nLet P be a G-graded R-module. Denote by K\u2022P the Koszul complex K\u2022 (f; R) \u2297R P . If the\nfi are G-homogeneous\nof the same degree \u03b3 for all i, the Koszul complex K\u2022P is G-graded\nL\nwith Ki := l0 <***<li R(\u2212i * \u03b3). Let ZiP and BiP be the Koszul i-th cycles and boundaries\nmodules, with the grading that makes the inclusions ZiP , BiP \u2282 KiP a map of degree 0 \u2208 G,\nand set HiP = ZiP /BiP .\nRecall that we have seen in Corollary 6.4.9 that if cdB (HiP ) \u2264 1 for all i > 0, then, for all\nj\u22650\nSuppG (HBi (HjP )) \u2282 SB (\u03b3; P ) + (j \u2212 i) * \u03b3.\nRecall from Remark 6.4.10 that\nRemark 7.2.2. If cdB (Hi ) \u2264 1 for all i > 0,\n[\nSuppG (HBi (Hj )) \u2282\n(SuppG (HBk (R)) + k * \u03b3) + (j \u2212 i) * \u03b3,\n\nfor all i, j.\n\nk\u2208Z\n\nTake j = 0 and write I := (f1 , . . . , fm ), we get\n[\n(SuppG (HBk (R)) + (k \u2212 i) * \u03b3),\nSuppG (HBi (R/I)) \u2282\n\nfor all i.\n\nk\u2208Z\n\n133\n\n\fThe next result determines the supports of Koszul cycles in terms of the sets SB (\u03b3).\nLemma 7.2.3. Assume f0 , . . . , fm \u2208 R are homogeneous elements of same degree \u03b3. Write\nI = (f0 , . . . , fm ). Fix a positive integer c. If cdB (R/I) \u2264 c, then the following hold\nS\n1. SuppG (H i (Zq )) \u2282 (SB (\u03b3) + (q + 1 \u2212 i) * \u03b3) \u222a ( k\u22650 SuppG (HBi+k (Hk+q )) * \u03b3), for i \u2264 c\nand all q \u2265 0.\n2. SuppG (H i (Zq )) \u2282 SB (\u03b3) + (q + 1 \u2212 i) * \u03b3, for i > c and all q \u2265 0.\nProof. Consider K\u2022\u2265q : 0 \u2192 Km+1 \u2192 Km \u2192 * * * \u2192 Kq+1 \u2192 Zq \u2192 0 the truncated Koszul\ncomplex. The double complex C\u02c7B\u2022 (K\u2022\u2265q ) gives rise to two spectral sequences. The first one\nhas second screen 02 Eji = HBi (Hj ). This module is 0 if i > c or if j > m + 1 \u2212 grade(I). The\nother one has as first screen\n\uf8f1 i\n\uf8f2 HB (Kj ) for all i > r, and j < q\n00 i\nHBi (Zq ) for q = j\n1 Ej =\n\uf8f3\n0\nfor all i \u2264 r, and j < q.\nFrom the second spectral sequence we deduce that if \u03b3 0 \u2208 G is such that HBi+k (Kq+k+1 )\u03b3 0\nvanishes for all k \u2265 0, then (00\u221e Eqi )\u03b3 0 = HBi (Zq )\u03b3 0 . Hence, if\n\u03b30 \u2208\n/\n\n[\n\nSuppG (HBi+k (Kk+q+1 )) =\n\nk\u22650\n\n[\n\n(SuppG (HBk+i (R)[\u2212(k + q + 1) * \u03b3]),\n\n(7.2)\n\nk\u22650\n\nthen (00\u221e Eqi )\u03b3 0 = HBi (Zq )\u03b3 0\nS\nComparing both spectral sequences, we have that for \u03b3 0 \u2208\n/ k\u22650 SuppG (HBi+k (Hk+q )), we\nget (00\u221e Eqi )\u03b3 0 = 0. This last condition is automatic for i > c, because HBi+k (Hk+q ) = 0 for all\nk \u2265 0.\nCorollary 7.2.4. Assume f0 , . . . , fm \u2208 R are homogeneous elements of degree \u03b3. Write\nI = (f0 , . . . , fm ). Fix an integer q. If cdB (R/I) \u2264 1, then the following hold\n1. for i = 0, 1, SuppG (H i (Zq )) \u2282 (SB (\u03b3) + (q \u2212 i) * \u03b3) \u222a (SB (\u03b3) + (q + 1 \u2212 i) * \u03b3).\n2. for i > 1, SuppG (H i (Zq )) \u2282 SB (\u03b3) + (q + 1 \u2212 i) * \u03b3.\nProof. Since SuppG (HBi+k (Hk+q )) \u2282 SB (\u03b3) + (q \u2212 i) * \u03b3, for all k \u2265 0, gathering together\nthis with equation (7.2) and Lemma 7.2.3, the result follows.\nRemark 7.2.5. We also have empty support for Koszul cycles in the following cases.\n\n134\n\n\f1. HB0 (Zp ) = 0 for all p if grade(B) 6= 0 and\n2. HB1 (Zp ) = 0 for all p if grade(B) \u2265 2.\nProof. The first claim follows from the inclusion Zp \u2282 Kp and the second from the exact\nsequence 0 \u2192 Zp \u2192 Kp \u2192 Bp\u22121 \u2192 0 that gives 0 \u2192 HB0 (Bp\u22121 ) \u2192 HB1 (Zp ) \u2192 HB1 (Kp ), with\nHB0 (Bp\u22121 ) as Bp\u22121 \u2282 Kp\u22121 .\n\n7.2.2 G-graded polynomial rings and approximation complexes\nWe treat in this part the case of a finitely generated abelian group G acting on a polynomial\nring R. Write R := K[X1 , . . . , Xn ]. Take H C Zn a normal subgroup of Zn and assume\nG = Zn /H. The group G defines a grading on R as was mentioned in 6.2.1.\nTake m + 1 homogeneous elements f := f0 , . . . , fm \u2208 R of fixed degree \u03b3 \u2208 G.\nL Set Il =\n(f0 , . . . , fm ) the homogeneous ideal of R defined by f. Recall that ReesR (I) := l\u22650 (It) \u2282\nR[t]. It is however important to observe that the grading in ReesR (I) is taken in such a way\nthat the natural map \u03b1 : R[T0 , . . . , Tm ] \u2192 ReesR (I) \u2282 R[t] : Ti 7\u2192 fi t is of degree zero, and\nhence (It)l \u2282 Rl\u03b3 \u2297K K[t]l .\nLet T := T0 , . . . , Tm be m + 1 indeterminates. There is a surjective map of rings \u03b1 : R[T] \u0010\nReesR (I) with kernel p := ker(\u03b1).\nRemark 7.2.6. Observe that p \u2282 R[T] isP\n(G\u00d7Z\u22650 )-graded,\nP hence set p(\u03bc;b) \u2282 R\u03bc \u2297K K[T]b ,\nand p(\u2217,0) = 0. Denote b := (p(\u2217,1) ) = ({ gi Ti : gi \u2208 R, gi fi = 0}). Usually b is called\nthe R[T]-ideal of syzygies and is written Syz(f).\nThe natural inclusion b \u2282 p gives a surjection \u03b2 : SymR (I) \u223c\n= R[T]/b\u0010R[T]/p \u223c\n= ReesR (I)\nthat makes the following diagram commute\n0\n0\n\n/ b\u007f\n\u000f\n\n/p\n\n_\n\n/ R[T]\n/ R[T]\n\n/ Sym\n\nR (I)\n\n\u03b1\n\n\u000f\u000f\n\n/0\n\n(7.3)\n\n\u03b2\n\n/ ReesR (I)\n\n/0\n\nV\nSet K\u2022 = K\u2022R (f) for the Koszul complex of f over the ring R. Write Ki := i R[\u2212i\u03b3]m+1 , and\nZi and Bi for the i-th module of cycles and boundaries respectively. We write Hi = Hi (f; R)\nfor the i-th Koszul homology module.\n\n135\n\n\fWe write Z\u2022 , B\u2022 and M\u2022 for the approximation complexes of cycles, boundaries and\nhomologies (cf. [HSV82], [HSV83b] and [Vas94b]). Define Zl = Zl [l\u03b3] \u2297R R[T], where\n(Zl [l\u03b3])\u03bc = (Zl )l\u03b3+\u03bc . Similarly we define Bl = Bl [l\u03b3] \u2297R R[T] and Ml = Hl [l\u03b3] \u2297R R[T],\nLet us recall some basic facts about approximation complexes that will be useful in the\nsequel. In particular, remind from Definition 1.3.2 that the ideal J \u2282 R is said to be of\nlinear type if SymR (I) \u223c\n= ReesR (I).\nDefinition 7.2.7. The sequence a1 , . . . , al in R is said to be a proper sequence if ai+1 Hj (a1 , . . . , ai ; R) =\n0, for all 0 \u2264 i \u2264 l, 0 < j \u2264 i.\nNotice that an almost complete intersection ideal is generated by a proper sequence.\nHenceforward, we will denote Hi := Hi (Z\u2022 ) for all i.\nLemma 7.2.8. With the notation above, the following statements hold:\n1. H0 = SymR (I).\n2. Hi is a SymR (I)-module for all i.\n3. If the ideal I can be generated by a proper sequence then Hi = 0 for i > 0.\n4. If I is generated by a d-sequence, then it can be generated by a proper sequence, and\nmoreover, I is of linear type.\nProof. For a proof of these facts we refer the reader to [Vas94b] or [HSV83b].\nAssume the ideal I = (f) is of linear type out of V (B), that is, for every prime q 6\u2283 B,\n(SymR (I))q = (ReesR (I))q . The key point of study is the torsion of both algebras as K[T]modules. Precisely we have the following result.\nLemma 7.2.9. With the notation above, we have\n1. annK[T] ((ReesR (I))(\u03bd,\u2217) ) = p \u2229 K[T] = ker(\u03c6\u2217 ), if R\u03bd 6= 0;\n2. if I is of linear type out of V (B) in Spec(R), then SymR (I)/HB0 (SymR (I)) = ReesR (I);\nProof. The first part follows from the fact that p is G \u00d7 Z-homogeneous and as ReesR (I)\nis a domain, there are no zero-divisors in R. By localizing at each point of Spec(R) \\ V (B)\nwe have the equality of the second item.\n\n136\n\n\fThis result suggest that we can approximate one algebra by the other, when they coincide\noutside V (B).\nLemma 7.2.10. Assume B \u2282 rad(I), then Hi is B-torsion for all i > 0.\nProof. Let p \u2208 Spec(R) \\ V (B). In particular p \u2208 Spec(R) \\ V (I), hence, (Hi )p = 0. This\nimplies that the complex M\u2022 (cf. [HSV83b]) is zero, hence acyclic, at localization at p. It\nfollows that (Z\u2022 )p is also acyclic [BJ03, Prop. 4.3].\n\nThis condition can be carried to a cohomological one, by saying cdB (R/I) = 0. Note that\nsince V (I) is empty in X , then V (I) \u2282 V (B) in Spec(R), then HBi (R/I) = 0 for i > 0.\nThus, this conditions can be relaxed by bounding cdB (R/I).\nWe now generalize Lemma 7.2.10 for the case when V (I) * V (B).\nWe will consider cdB (R/I) \u2264 1 for the sequel in order to have convergence at step 2 of the\nhorizontal spectral sequence.\nBefore getting into the next result, recall that Zq := Zq [q * \u03b3] \u2297K K[T]. It follows that\n\uf8f1\nfor k > 1,\n\uf8f2 SB (\u03b3) + (1 \u2212 k) * \u03b3\nk\nk\nSB (\u03b3) \u222a (SB (\u03b3) \u2212 \u03b3) for k = 1,\nSuppG (HB (Zq+k )) = SuppG (HB (Zq+k )) \u2212 q * \u03b3 \u2282\n\uf8f3\n(SB (\u03b3) + \u03b3) \u222a SB (\u03b3) for k = 0\n(7.4)\nObserve, that any of this sets on the right do not depend on q. Furthermore, if grade(B) \u2265 2,\nwe have seen in Remark 7.2.5 HB0 (Zp ) = HB1 (Zp ) = 0 for all p. hence, we define:\nDefinition 7.2.11. For \u03b3 \u2208 G, set\nRB (\u03b3) :=\n\n[\n\n(SB (\u03b3) \u2212 k * \u03b3) \u2282 G.\n\n0<k<min{m,cdB (R)}\n\nTheorem 7.2.12. Assume that grade(B) \u2265 2 and cdB (R/I) \u2264 1. Then, if \u03bc \u2208\n/ RB (\u03b3),\nHBi (Hj )\u03bc = 0,\n\nfor all i, j.\n\n137\n\n\fProof. Consider the two spectral sequences that arise from the double complex C\u02c7B\u2022 Z\u2022 . Since\nsupp(Hp ) \u2282 I, the first spectral sequence has at second screen 02 Eji = HBi Hj . The condition\ncdB (R/I) \u2264 1 gives that this spectral sequences stabilizes at the second step with\n\uf8f1\nHj\nfor i = 0 and j > 0,\n\uf8f4\n\uf8f4\n\uf8f2 1\nH\n(H\n)\nfor\ni = 1 and j > 0,\nj\n0\ni\n0 i\ni\nB\ni\n\u221e Ej = 2 Ej = HB Hj =\nH (SymR (I)) for j = 0, and all i\n\uf8f4\n\uf8f4\n\uf8f3 B\n0\notherwise.\nThe second spectral sequence has at first screen 001 Eji = HBi (Zj ). Since R[T] is R-flat,\nHBi (Zj ) = HBi (Zj [j\u03b3]) \u2297K K[T]. From and Remark 7.2.5 the top line vanishes for j > 0, as\nwell as the upper-left part.\nComparing both spectral sequences, we deduce that the vanishing of HBk (Zp+k )\u03bc for all k,\nimplies the vanishing of HBk (Hp+k )\u03bc for all k.\nFinally, from equation (7.4) we have that if \u03bc \u2208\n/ RB (\u03b3) (which do not depend on p), then\nwe obtain HBi (Hj )\u03bc = 0.\nLemma 7.2.13. Assume grade(B) \u2265 2, cdB (R/I) \u2264 1 and Ip is almost a local complete\nintersection for every p \u2208\n/ V (B). Then, for all \u03bc \u2208\n/ RB (\u03b3), the complex (Z\u2022 )\u03bc is acyclic and\n0\nHB (SymR (I))\u03bc = 0.\nProof. Since Ip is almost a local complete intersection for every p \u2208\n/ V (B), Z\u2022 is acyclic off\nV (B). Hence, Hq is B-torsion for all positive q. Since Hq is B-torsion, HBk (Hq ) = 0 for k > 0\nand HB0 (Hq ) = Hq . From Theorem 7.2.12 we have that (Hq )\u03bc = 0, and HB0 (H0 )\u03bc = 0.\n\n7.3 The implicitization of toric hypersurfaces\nIn this part we focus on the study of the closed image of rational maps defined over a toric\nvariety. This subject has been attacked in several articles with many different approaches.\nThe problem of computing the equations defining the closed image of a rational map is an\nopen research area with several applications.\nLet X be a non-degenerate toric variety over a field K, \u2206 be its fan in the lattice N \u223c\n= Zd\ncorresponding to X , and write \u2206(i) for the set of i-dimensional cones in \u2206 as before.\nDenote by S the Cox ring of X .\n\n138\n\n\fHenceforward we will focus on the study of the elimination theory as we have done in\nChapters 1 3 and 4 in a different context. This aim brings us to review some basic definitions\nand properties.\nAssume we have a rational map \u03c6 : X 99K Pm , defined by m + 1 homogeneous elements\nf := f0 , . . . , fm \u2208 S of fixed degree \u03c1 \u2208 Cl(X ). Precisely, any cone \u03c3 \u2208 \u2206 defines an\nopen affine set U\u03c3 (cf. [Cox95]), and two elements fi , fj define a rational function fi /fj\non some affine open set U\u03c3 , and this \u03c3 can be determine from the monomials appearing in\nfj . In particular, if X is a multiprojective space, then fi stands for a multihomogeneous\npolynomial of multidegree \u03c1 \u2208 Z\u22650 \u00d7 * * * \u00d7 Z\u22650 .\nWe recall that for any Cl(X )-homogeneous ideal J, ProjX (S/J) simply stands for the\ngluing of the affine scheme Spec((S/J)\u03c3 ) on every affine chart Spec(S\u03c3 ), to X . It can be\nsimilarly done to define from Cl(X ) \u00d7 Z-homogeneous ideals of S \u2297K K[T], subschemes\nof X \u00d7K Pd , and this projectivization functor will be denoted ProjX \u00d7Pm (\u2212). The gradedungraded scheme construction will be denoted by ProjX \u00d7Am+1 (\u2212). For a deep examination\non this subject, we refer the reader to [Ful93], and [Cox95].\nDefinition 7.3.1. Set I := (f0 , . . . , fn ) ideal of S. Define S := ProjX (S/I) and S red :=\nProjX (S/rad(I)), the base locus of \u03c6. denote by \u03a9 := X \\ S , the domain of definition of\n\u03c6.\nm\nLet \u03930 denote the graph of \u03c6 over \u03a9, and \u0393 := \u03930 its closure\nL in X l\u00d7P . Scheme-theoretically\nwe have \u0393 = ProjX \u00d7Pm (ReesR (I)), where ReesR (I) := l\u22650 (It) \u2282 S[t].\n\nRecall that the two surjections, S[T] \u2192 SymR (I) and \u03b2 : SymR (I) \u2192 ReesR (I), established\non Diagram 7.3, correspond to a chain of embedding \u0393 \u2282 \u03a5 \u2282 X \u00d7 Pm , where \u03a5 =\nProjX \u00d7Pm (SymR (I)).\n\nAssume the ideal I is of linear type off V (B), that is, for every prime q 6\u2283 B, (SymR (I))q =\n(ReesR (I))q . Since Sym and Rees commute with localization, ProjX \u00d7Pm (SymR (I)) = ProjX \u00d7Pm (ReesR\nthat is \u03a5 = \u0393 in X \u00d7 Pm . Moreover, ProjX \u00d7Am+1 (SymR (I)) and ProjX \u00d7Am+1 (ReesR (I)) coincide in X \u00d7 Am+1 . Recall that this in general does not imply that SymR (I) and ReesR (I)\ncoincide, in fact this is almost never true: as ReesR (I) is the closure of the graph of \u03c6 which\nis irreducible, it is an integral domain, hence, torsion free; on the other hand, SymR (I) is\nalmost never torsion free.\nRemark 7.3.2. Observe that it can be assumed without loss of generality that grade(B) \u2265\n2.\nLemma 7.3.3. If dim(V (I)) \u2264 0 in X , then cdB (S/I) \u2264 1.\n\n139\n\n\fProof. For any finitely generated S-module P and all i > 0, from Equation (2.7) H\u2217i (X , P \u223c ) \u223c\n=\nHBi+1 (P ). Applying this to P = S/I, for all \u03c1 \u2208 Cl(X ) we get that\nH i (X , (S/I)\u223c (\u03c1)) = H i (V (I), OV (I) (\u03c1)),\nthat vanishes for i > 0, since dimV (I) \u2264 0.\n\nTheorem 7.3.4. Let X be a (d \u2212 1)-dimensional non-degenerate toric variety over a field\nK, and S its Cox ring. Let \u03c6 : X 99K Pd be a rational map, defined by d + 1 homogeneous\nelements f0 , . . . , fd \u2208 S of fixed degree \u03c1 \u2208 Cl(X ). Denote I = (f0 , . . . , fd ). If dim(V (I)) \u2264\n0 in X and V (I) is almost a local complete intersection off V (B), then\ndet((Z\u2022 )\u03b3 ) = H deg(\u03c6) * G \u2208 K[T],\nfor all \u03b3 \u2208\n/ RB (\u03c1), where H stands for the irreducible implicit equation of the image of \u03c6,\nand G is relatively prime polynomial in K[T].\nProof. This result follows in the standard way, similar to the cases of implicitization problems in other contexts.\n\nRecall that \u0393 is the closure of the graph of \u03c6, hence, defined over \u03a9. The bihomogeneous\n\u03c0\n\u03c0\nstructure in S \u2297K K[T] gives rise to two natural scheme morphisms X \u21901 X \u00d7K Pd \u21922 Pd .\nIt follows directly that \u03c02 = \u03c01 \u25e6 \u03c6 over the graph of \u03c6, \u03c01\u22121 (\u03a9).\n\nFrom Corollary 7.3.4, the complex of OPd -modules (Z\u2022 )\u223c is acyclic over X \u00d7K Pd . We\nverify by localization that this complex has support in \u03a5, hence, H 0 (X \u00d7K Pd , (Z\u2022 )\u223c ) =\nH 0 (\u03a5, (Z\u2022 )\u223c ) = SymR (I). Naturally, G defines a divisor in Pd with support on \u03c02 (\u03a5 \\ \u0393),\nand \u03a5 and \u0393 coincide outside S \u00d7 Pd .\nFollowing [KM76], due to the choice of \u03b3 \u2208\n/ RB (\u03c1), one has:\n[det((Z\u2022 )\u03bd )] = div\nP K[X] (H0 (Z\u2022 )\u03b3 ) = divK[X] (SymR (I)\u03b3 )\n=\nlengthK[X]q ((SymR (I)\u03b3 )q )[q].\nq prime,\ncodimK[X] (q) = 1\n\nThus, for all \u03b3 \u2208\n/ RB (\u03c1), we obtain\n[det((Z\u2022 )\u03b3 )] = lengthK[X](H) ((SymR (I)\u03b3 )(H) )[(H)] +\n\nX\n\nlengthK[X]q ((SymR (I)\u03b3 )q )[q].\n\nq prime,\nV (q) 6\u2282 V (H)\ncodimK[X] (q) = 1\n\nIt follows that the first summand is the divisor associated to G, and the second one, the\ndivisor associated to H deg(\u03c6) .\n\n140\n\n\fWe next give a detailed description of the extra factor G, as given in [BCJ09, Prop. 5].\nRemark 7.3.5. Let X , S, \u03c6 : X 99K Pd , H and G be as in Theorem 7.3.4. If K is\nalgebraically closed, then G can be written as\nY\nG=\nLeqq \u2212lq .\nq prime, V (q) 6\u2282 V (H)\ncodimK[X] (q) = 1\n\nin K[T], where eq stands for the Hilbert-Samuel multiplicity of SymR (I) at q, and lq denotes\nlengthK[X]q .\nProof. The proof follows the same lines of that of [BCJ09, Prop. 5]. It is just important to\nobserve that [BCJ09, Lemma 6] is stated for a Cohen-Macaulay ring as is S for us.\nThe main idea behind this remark is that only non-complete intersections points in S yield\nthe existence of extra factors as in Chapters 1 and 3. If I is locally a complete intersection\nat q \u2208 S , then Iq is of linear type, hence, (SymR (I))q and (ReesR (I))q coincide. Thus,\nProjX \u00d7Pm (SymR (I)) and ProjX \u00d7Pm (ReesR (I)) coincide over q.\n\n7.4 Multiprojective spaces and multigraded polynomial\nrings\nIn this section we focus on the better understanding of the multiprojective case. Here we\ntake advantage of the particular structure of the ring. This will permit, as in Chapter 6, to\nprecise results to determine the regions of the vanishing of the local cohomology modules.\nThe problem of computing the implicit equation of a rational multiprojective hypersurface\nis surely the most important among toric cases of implicitization. The theory follows as a\nparticular case of the one developed in the section before, but many results can be better\nprecise, and better understood. In this case, the grading group is Zs , which permits a deeper\ninsight in the search for a \"good zone\" for \u03b3. The aim of this paragraph is to show that\nin this region, approximation complexes behave well enough, allowing the computation of\nthe implicit equation (perhaps with extra factors) as a determinant of a graded branch of a\nZ-complex, as we have done in Chapters 1 and 3.\nIn what follows for the rest of this section, we will follow the following convention. Let s and\nm be fixed positive integers, r1 \u2264 * * * \u2264 rs non-negative integers, and write xi = (xi0 , . . . , xiri )\n\n141\n\n\fN\nfor 1 \u2264 i \u2264 s. Let f0 , . . . , fm \u2208 K K[xi ] be multihomogeneous polynomials of multidegree\ndi on xi . Assume we are given a rational map\nY\n\u03c6:\nPri 99K Pm : x := (x1 ) \u00d7 * * * \u00d7 (xs ) 7\u2192 (f0 : * * * : fm )(x).\n(7.5)\n1\u2264i\u2264s\n\nP\nN\nTake m and ri such\nthat\nm\n=\n1\n+\nr\n.\nWrite\nR\n:=\nK[x\n]\nfor\n1\n\u2264\ni\n\u2264\ns,\nR\n=\ni\ni\ni\n1\u2264i\u2264s\nK Ri ,\nN\npart\nof\nmultidegree\n(a\n,\n.\n.\n.\n,\na\n).\nHence,\nand R(a1 ,...,as ) := K (Ri )ai stands for its bigraded\n1\ns\nQ\nri\ndimRi = ri + 1, and dimR\n=\nr\n+\ns,\nand\nP\n=\nMultiproj(R).\nSet\na\n:=\n(xi ), ideal\ni\n1\u2264i\u2264s\nP\nT\nof Ri , and take m := 1\u2264i\u2264s ai the irrelevant ideal of R, and B := 1\u2264i\u2264s ai the empty\nlocus of Multiproj(R). Set also I := (f0 , . . . , fm ) for the multihomogeneous ideal of R, and\nX = Multiproj(R/I) the base locus of \u03c6.\nQ\nri\nSet-theoretically, write V (I) for the base locus of \u03c6, and \u03a9 :=\n1\u2264i\u2264s P \\ V (I) the\ndomain of\nof \u03c6. Let \u03930 denote the graph of \u03c6 over \u03a9, and \u0393 := \u03930 its cloQ definition\nri\nsure in ( 1\u2264i\u2264s P ) \u00d7 Pm . Scheme-theoretically we have \u0393 = Multiproj(ReesR (I)), where\nL\nl\nReesR (I) :=\nl\u22650 (It) \u2282 R[t]. The grading in ReesR (I) is taken in such a way that the\nnatural map \u03b1 : R[T0 , . . . , Tm ] \u2192 ReesR (I) \u2282 R[t] : Ti 7\u2192 fi t is of degree zero, and hence\n(It)l \u2282 R(ld1 ,...,lds ) \u2297K K[t]l .\nRemark 7.4.1. From Lemma 7.3.3 we have that if dim(V (I)) \u2264 0 in Pr1 \u00d7 * * * \u00d7 Prs , then\ncdB (R/I) \u2264 1.\nRemark 7.4.2. It is clear that if \u03b3 \u2208 Ns , then, (SB (\u03b3) \u2212 k * \u03b3) \u2283 (SB (\u03b3) \u2212 (k + 1) * \u03b3) for\nall k \u2265 0. Thus, from Definition 7.2.11, we see that for all \u03b3 \u2208 Ns ,\nRB (\u03b3) = SB (\u03b3) \u2212 \u03b3.\nQ\nTheorem 7.3.4 and Remark 7.3.5 can be applied verbatim since 1\u2264i\u2264s Pri is a toric variety.\nWe have that\nQ\nTheorem 7.4.3. Let \u03c6 : 1\u2264i\u2264s Pri 99K Pm be a rational map, as in (7.5), defined by\nm + 1 homogeneous elements f0 , . . . , fm \u2208 SQof the same degree \u03c1 = (d0 , . . . , dm ). Denote\nI = (f0 , . . . , fm ). Assume dimV (I) \u2264 0 in 1\u2264i\u2264s Pri and V (I) is almost a local complete\nintersection off V (B). Then,\ndet((Z\u2022 )\u03b3 ) = H deg(\u03c6) * G \u2208 K[T],\nfor all \u03b3 \u2208\n/ RB (\u03c1), where H stands for the irreducible implicit equation of the image of \u03c6,\nand G is relatively prime polynomial in K[T].\n\n142\n\n\fMoreover, if K is algebraically closed, then G can be written as\nY\nG=\nLeqq \u2212lq .\nq prime, V (q) 6\u2282 V (H)\ncodimK[X] (q) = 1\n\nin K[T], where eq stands for the Hilbert-Samuel multiplicity of SymR (I) at q, and lq denotes\nlengthK[X]q .\nProof. Take RB (\u03c1) as in Definition 7.2.11. From Lemma 7.4.1 we have that cd(R/I) \u2264 1.\nThus, the result follows by taking \u03b3 \u2208\n/ RB (\u03c1) and using Theorem 7.3.4 and Remark 7.3.5.\n\n7.5 Examples\nExample 7.5.1. We will follow Example 6.4.11. Thus, let k be a field. Assume X is the\nbiprojective space P1K \u00d7 P3K . Take R1 := k[x1 , x2 ], R2 := k[y1 , y2 , y3 , y4 ], and G := Z2 . Write\nR := R1 \u2297k R2 and set deg(xi ) = (1, 0) and deg(yi ) = (0, 1) for all i. Set a1 := (x1 , x2 ),\na2 := (y1 , y2 , y3 , y4 ) and define B := a1 * a2 \u2282 R the irrelevant ideal of R, and m := a1 + a2 \u2282\nR, the ideal corresponding to the origin in Spec(R).\nRecall that\n1. HB2 (R) \u223c\n= \u0158{1} \u223c\n= Ha21 (R) = \u03c9R\u22281 \u2297k R2 ,\n2. HB4 (R) \u223c\n= \u0158{2} \u223c\n= Ha42 (R) = R1 \u2297k \u03c9R\u22282 ,\n3. HB5 (R) \u223c\n= \u0158{1,2} \u223c\n= Hm6 (R) = \u03c9R\u2228 ,\n4. HB` (R) = 0 for all ` 6= 2, 4 and 5.\nThus,\n1. SuppG (HB2 (R)) = SuppG (\u01581 ) = Q{1} = \u2212N \u00d7 N + (\u22122, 0), .\n2. SuppG (HB4 (R)) = SuppG (\u01582 ) = Q{2} = N \u00d7 \u2212N + (0, \u22124), .\n3. SuppG (HB5 (R)) = SuppG (\u01581,2 ) = Q{1,2} = \u2212N \u00d7 \u2212N + (\u22122, \u22124), .\nWe have seen that\n\n143\n\n\f2\nSuppZ2 (HB\n(R))\n\n(-2,0)\n\n(0,0)\nb\n\n(-1,-3)\n\nb\n\nb\n\n(-2,-4)\n\n(0,-4)\n\n5\nSuppZ2 (HB\n(R))\n\n4\nSuppZ2 (HB\n(R))\n\nRecall that f1 , . . . , fm are homogeneous elements of bidegree \u03b3, and I := (f1 , . . . , fm ).\nAssume cdB (R/I) \u2264 1, hence cdB (Hi ) \u2264 1 for all i. We have reg(R/I), and\nSB (\u03b3) = (SuppG (HB2 (R)) + 2 * \u03b3) \u222a (SuppG (HB4 (R)) + 4 * \u03b3) \u222a (SuppG (HB5 (R)) + 5 * \u03b3),\nas in the picture\n\n(3,22)\n\n(2,21)\n\nb\n\n(8,21)\nb\n\n(8,16)\n(2,10)\nb\n\nSB (\u03b3)\n\nRB (\u03b3) = SB (\u03b3) \u2212 \u03b3\nThus, we have that\n{RB (2, 5) = (N2 + (1, 17)) \u222a (N2 + (7, 12)).\n\n144\n\n\f(N2 + (1, 17)) \u222a (N2 + (7, 12))\n\n(1,17)\nb\n\n(7,12)\nb\n\nRB (2, 5)\nb\n\nConsider \u03c6 : P1 \u00d7 P3 99K P5 given by f0 , . . . , f5 \u2208 R homogeneous polynomials of bidegree\n(2, 5) \u2208 Z2 .\nTaking \u03bc \u2208\n/ RB (2, 5), the approximation complex of cycles associated to f0 , . . . , f5 in degree\n\u03bd is acyclic and Sym(f0 , . . . , f5 ) has no B-torsion. We conclude that we can compute the\nimplicit equation of \u03c6 as a factor of det((Z\u2022 )(\u03bc,\u2217) ) for \u03bc \u2208\n/ RB (2, 5).\nExample 7.5.2. Consider the rational map\nf\n\nP1 \u00d7 P1\n99K\nP3\n(s : u) \u00d7 (t : v) 7\u2192 (f1 : f2 : f3 : f4 )\n\n(7.6)\n\nwhere the polynomials fi = fi (s, u, t, v) are bihomogeneous of bidegree (2, 3) \u2208 Z2 given by\n\u2022 f1 = s2 t3 + 2sut3 + 3u2 t3 + 4s2 t2 v + 5sut2 v + 6u2 t2 v + 7s2 tv 2 + 8sutv 2 + 9u2 tv 2 +\n10s2 v 3 + suv 3 + 2u2 v 3 ,\n\u2022 f2 = 2s2 t3 \u2212 3s2 t2 v \u2212 s2 tv 2 + sut2 v + 3sutv 2 \u2212 3u2 t2 v + 2u2 tv 2 \u2212 u2 v 3 ,\n\u2022 f3 = 2s2 t3 \u2212 3s2 t2 v \u2212 2sut3 + s2 tv 2 + 5sut2 v \u2212 3sutv 2 \u2212 3u2 t2 v + 4u2 tv 2 \u2212 u2 v 3 ,\n\u2022 f4 = 3s2 t2 v \u2212 2sut3 \u2212 s2 tv 2 + sut2 v \u2212 3sutv 2 \u2212 u2 t2 v + 4u2 tv 2 \u2212 u2 v 3 .\n\nOur aim is to get the implicit equation of the hypersurface im(f ) of P3 . Let us start by\ndefining the parametrization f given by (f1 , f2 , f3 , f4 ).\nThus, let k be a field. Assume X is the biprojective space P1K \u00d7 P1K . Take R1 := k[x1 , x2 ],\nR2 := k[y1 , y2 ], and G := Z2 . Write R := R1 \u2297k R2 and set deg(xi ) = (1, 0) and deg(yi ) =\n(0, 1) for all i. Set a1 := (x1 , x2 ), a2 := (y1 , y2 ) and define B := a1 * a2 \u2282 R the irrelevant\nideal of R, and m := a1 + a2 \u2282 R, the ideal corresponding to the origin in Spec(R).\nRecall that\n\n145\n\n\f1. HB2 (R) \u223c\n= \u03c9R\u22281 \u2297k \u03c9R\u22282 ,\n\n2. HB3 (R) \u223c\n= Hm4 (R) = \u03c9R\u2228 ,\n= \u0158{1,2} \u223c\n3. HB` (R) = 0 for all ` 6= 2 and 3.\n\nThus,\n1. SuppG (HB2 (R)) = SuppG (\u01581 ) \u222a SuppG (\u01582 ) = Q{1} = \u2212N \u00d7 N + (\u22122, 0) \u222a N \u00d7 \u2212N +\n(0, \u22122).\n2. SuppG (HB3 (R)) = SuppG (\u01581,2 ) = Q{1,2} = \u2212N \u00d7 \u2212N + (\u22122, \u22122), .\nWe have seen that\n\n(-2,0)\n\n(0,0)\nb\n\n(-1,-1)\n\nb\n\n(-2,-2)\n\nb\n\n(0,-2)\n\nSB (2, 3) = (SuppG (HB2 (R)) + 2 * (2, 3)) \u222a (SuppG (HB3 (R)) + 3 * (2, 3)).\nHence,\nRB (2, 3) = (SuppG (HB2 (R)) + (2, 3)) \u222a (SuppG (HB3 (R)) + 2 * (2, 3)).\nThus,\n{RB (2, 3) = (N2 + (1, 5)) \u222a (N2 + (3, 2)).\nAs we can see in Example 9.1.1, a Macaulay2 computation gives exactly this region (illustrated below) as the acyclicity region for Z\u2022 .\n\n146\n\n\f(1,5)\n5\n\nb\n\n4\n\n(0,4)\n\nVanishing of\nlocal cohomology\n\nb\n\n(2,4)\n\n3\n\n(3,2)\n2\n\nb\n\n1\n\n(2,1)\n0\n\n.5\nNon-vanishing\nof\nlocal cohomology\n\n-1\n\nWhen \u03bd0 = (3, 2) or \u03bd0 = (1, 5), we get a complex\nM\u03bd\n\n0\n(Z\u2022 )\u03bd0 : 0 \u2192 0 \u2192 0 \u2192 K[X]12 \u2212\u2192\nK[X]12 \u2192 0.\n\nand, thus, det((Z\u2022 )\u03bd0 ) = det(M\u03bd0 ) \u2208 K[X]12 is an homogeneous polynomial of degree 12\nthat vanishes on the closed image of \u03c6.\n\n147\n\n\f\f8 A package for computing implicit\nequations from toric surfaces\n8.1 Introduction\nLet T be a two-dimensional projective toric variety, and let f : T 99K P3 be a generically\nfinite rational map. Hence, S := im(f ) \u2282 P3 is a hypersurface. In Chapter 3, following\n[BDD09] and [Bot10], we showed how to compute an implicit equation for S , assuming\nthat the base locus X of f is finite and locally an almost complete intersection. As we\nmentioned in Chapter 3, this is a further generalization of the results in Chapter 1, which\nfollows [BJ03, BC05, Cha06], on implicitization of rational hypersurfaces via approximation\ncomplexes; we also generalize [BD07].\nThis chapter corresponds to a recent sent article in collaboration with Marc Dohm, entiled\nA package for computing implicit equations of parametrizations from toric surfaces (cf.\n[BD10])\nWe showed in Section 3.3 and Section 3.4 how to compute a symbolic matrix of linear\nsyzygies M , called representation matrix of S , with the property that, given a point p \u2208 P3 ,\nthe rank of M (p) drops if p lies in the surface S . When the base locus X is locally a complete\nintersection, we get that the rank of M (p) drops if and only if p lies in the surface S.\nWe begin by recalling the notion of a representation matrix (see Definition 3.3.1).\nDefinition 8.1.1. Let S \u2282 Pn be a hypersurface. A matrix M with entries in the polynomial ring K[T0 , . . . , Tn ] is called a representation matrix of S if it is generically of full rank\nand if the rank of M evaluated in a point p of Pn drops if and only if the point p lies on S .\nIt follows immediately that a matrix M represents S if and only if the greatest common\ndivisor D of all its minors of maximal size is a power of a homogeneous implicit equation\nF \u2208 K[T0 , . . . , Tn ] of S . When the base locus is locally an almost complete intersection,\nwe can construct a matrix M such that D factors as D = F \u03b4 G where \u03b4 \u2208 N and G \u2208\n\n149\n\n\fK[T0 , . . . , Tn ]. In Section 3.4 we gave a description of the surface (D = 0). In this chapter\nwe present an implementation of our results in the computer aided software Macaulay2 [GS].\nFrom a practical point of view our results are a major improvement, as it makes the method\napplicable for a wider range of parametrizations (for example, by avoiding unnecessary base\npoints with bad properties) and leads to significantly smaller representation matrices.\nThere are several advantages of this perspective. The method works in a very general\nsetting and makes only minimal assumptions on the parametrization. In particular, as we\nhave mentioned, it works well in the presence of \"nice\" base points. Unlike the method of\ntoric resultants (cf. for example [KD06]), we do not have to extract a maximal minor of\nunknown size, since the matrices are generically of full rank. The monomial structure of the\nparametrization is exploited, in Section 3.2.1, following [Bot10], we defined\nDefinition 8.1.2. Given a list of polynomials f0 , . . . , fr , we define\nN (f0 , . . . , fr ) := conv(\n\nr\n[\n\ni=0\n\nN (fi )),\n\nthe convex hull of the union of the Newton polytopes of fi , and we will refer to this polytope\nas the Newton polytope of the list f0 , . . . , fr . When f denotes the rational map defining S ,\nwe will write N (f ) := N (f1 , f2 , f3 , f4 ), and we will refer to it as the Newton polytope of f .\nIn these terms, in our algorithm we fully exploit the structure of N (f ), so one obtains much\nbetter results for sparse parametrizations, both in terms of computation time and in terms\nof the size of the representation matrix. Moreover, it subsumes the known method of approximation complexes in the case of dense homogeneous parametrizations. One important\npoint is that representation matrices can be efficiently constructed by solving a linear system of relatively small size (in our case dimK (A\u03bd+d ) equations in 4dimK (A\u03bd ) variables). This\nmeans that their computation is much faster than the computation of the implicit equation\nand they are thus an interesting alternative as an implicit representation of the surface.\nOn the other hand, there are a few disadvantages. Unlike with the toric resultant or the\nmethod of moving surfaces (moving plane and quadrics), the matrix representations are\nnot square and the matrices involved are generally bigger than with the method of moving\nplanes and surfaces. It is important to remark that those disadvantages are inherent to the\nchoice of the method: A square matrix built from linear syzygies does not exist in general.\nIt is an automatic consequence of this fact, that if one only uses linear syzygies to construct\nthe matrix, it has to be a bigger matrix which has entries of higher degree (see [BCS09]).\nThe choice of the method to use depends very much on the given parametrization and on\nwhat one needs to do with the matrix representation.\n\n150\n\n\f8.2 Example\nExample 8.2.1. Here we give an example, where we fully exploit the structure of N (f ) that\nwe have already seen in 3.6.4. Take (f1 , f2 , f3 , f4 ) = (st6 + 2, st5 \u2212 3st3 , st4 + 5s2 t6 , 2 + s2 t6 ).\nThis is a very sparse parametrization, and we have in this case, there is no smaller lattice\nhomothety of N (f ). The coordinate ring is A = K[X0 , . . . , X5 ]/J, where J = (X32 \u2212\nX2 X4 , X2 X3 \u2212 X1 X4 , X22 \u2212 X1 X3 , X12 \u2212 X0 X5 ) and the new base-point-free parametrization\ng is given by (g1 , g2 , g3 , g4 ) = (2X0 + X4 , \u22123X1 + X3 , X2 + 5X5 , 2X0 + X5 ). The Newton\npolytope looks as follows.\n6\nb\n\nb\n\n5\n4\n3\n2\n1\n0b\n\n0\n\n1\n\n2\n\nFor \u03bd0 = 2d = 2 we can compute the matrix of the first map of the graded piece of degree\n\u03bd0 of the approximation complex of cycles (Z\u2022 )\u03bd0 , see for Example 3.6.4 (following [BDD09,\nSec 3.1]), which is a 17 \u00d7 34-matrix. The greatest common divisor of the 17-minors of this\nmatrix is the homogeneous implicit equation of the surface; it is of degree 6 in the variables\nT1 , . . . , T4 :\n\n2809T12 T24 + 124002T26 \u2212 5618T13 T22 T3 + 66816T1 T24 T3 + 2809T14 T32\n\n\u221250580T12 T22 T32 + 86976T24 T32 + 212T13 T33 \u2212 14210T1 T22 T33 + 3078T12 T34\n+13632T22 T34 + 116T1 T35 + 841T36 + 14045T13 T22 T4 \u2212 169849T1 T24 T4\n\n\u221214045T14 T3 T4 + 261327T12 T22 T3 T4 \u2212 468288T24 T3 T4 \u2212 7208T13 T32 T4\n\n+157155T1 T22 T33 T4 \u2212 31098T12 T33 T4 \u2212 129215T22 T33 T4 \u2212 4528T1 T34 T4\n\u221212673T35 T4 \u2212 16695T12 T22 T42 + 169600T24 T42 + 30740T13 T3 T42\n\n\u2212433384T1 T22 T3 T42 + 82434T12 T32 T42 + 269745T22 T32 T42 + 36696T1 T33 T42\n+63946T34 T42 + 2775T1 T22 T43 \u2212 19470T12 T3 T44 + 177675T22 T3 T43\n\n\u221285360T1 T32 T43 \u2212 109490T33 T43 \u2212 125T22 T44 + 2900T1 T3 T44 + 7325T32 T44\n\n\u2212125T3 T45\n\n151\n\n\fIn this example we could have considered the parametrization as a bihomogeneous map\neither of bidegree (2, 6) or of bidegree (1, 3), i.e. we could have chosen the corresponding\nrectangles instead of N (f ). This leads to a more complicated coordinate ring in 20 (resp. 7)\nvariables and 160 (resp. 15) generators of J and to bigger matrices (of size 21 \u00d7 34 in both\ncases). Even more importantly, the parametrizations will have a non-LCI base point and the\nmatrices do not represent the implicit equation but a multiple of it (of degree 9). Instead,\nif we consider the map as a homogeneous map of degree 8, the results are even worse: For\n\u03bd0 = 6, the 28 \u00d7 35-matrix M\u03bd0 represents a multiple of the implicit equation of degree 21.\nTo sum up, in this example the method of approximation complexes works well for suitable\ntoric varieties, whereas it fails over P1 \u00d7 P1 and P2 . This shows that the extension of the\nmethod to toric varieties really is a generalization and makes the method applicable to a\nlarger class of parametrizations.\nInterestingly, we can even do better than with N (f ) by choosing a smaller polytope. The\nphilosophy is that the choice of the optimal polytope is a compromise between two criteria:\nkeep the simplicity of the polytope in order not to make the ring A too complicated, and\nrespect the sparseness of the parametrization (i.e. keep the polytope close to the Newton\npolytope) so that no base points appear which are not local complete intersections.\nSo let us repeat the same example with another polytope Q, which is small enough to reduce\nthe size of the matrix but which only adds well-behaved (i.e. local complete intersection)\nbase points:\n3b\nb\n\n2\n1\n0b\n0\n\n1\n\nThe Newton polytope N (f ) is contained in 2 * Q, so the parametrization will factor through\nthe toric variety associated to Q, more precisely we obtain a new parametrization defined\nby\nh = (h1 , h2 , h3 , h4 ) = (2X02 + X3 X4 , \u22123X0 X4 + X2 X4 , X1 X4 + 5X42 , 2X02 + X42 )\n\n152\n\n\fover the coordinate ring A = K[X0 , . . . , X4 ]/J with J = (X22 \u2212 X1 X3 , X1 X2 \u2212 X0 X3 , X12 \u2212\nX0 X2 ) making the following diagram commute:\nf\n(A\u2217\u007f )_ 2 _ _ _z/< P3\nh\n\n\u000f z\n\nz\n\nz\n\nTQ\n\nThe optimal bound is \u03bd0 = 2 and in this degree the implicit equation is represented directly\nwithout extraneous factors by a 12 \u00d7 19-matrix, which is smaller than the 17 \u00d7 34 we had\nbefore.\n\n8.3 Implementation in Macaulay2\nIn this section we show how to compute a matrix representation and the implicit equation\nwith the method developed in Chapter 3, using the computer algebra system Macaulay2\n[GS]. We will explain the code along Example 8.2.1. As it is probably the most interesting\ncase from a practical point of view, we restrict our computations to parametrizations of\na toric surface. However, the method can be adapted to the n-dimensional toric case.\nMoreover, we are not claiming that our implementation is optimized for efficiency; anyone\ntrying to implement the method to solve computationally involved examples is well-advised\nto give more ample consideration to this issue. For example, in the toric case there are\nbetter suited software systems to compute the generators of the toric ideal J, see [4ti].\nFirst we load the package \"Maximal minors1 \"\ni1 : load \"maxminor.m2\"\n\nLet us start by defining the parametrization f given by (f1 , . . . , f4 ).\ni2\ni3\ni4\ni5\n1\n\n:\n:\n:\n:\n\nS=QQ[s,u,t,v];\ne1=2;\ne2=6;\nf1=s*u*t^6+2*u^2*v^6\n6\n2 6\n\nThe package \"maxminor.m2\" for Macaulay2\nhttp://mate.dm.uba.ar/~nbotbol/maxminor.m2.\n\ncan\n\nbe\n\ndownloaded\n\nfrom\n\nthe\n\nwebpage\n\n153\n\n\fo5 = s*u*t + 2u v\ni6 : f2=s*u*t^5*v-3*s*u*t^3*v^3\n5\n3 3\no6 = s*u*t v - 3s*u*t v\ni7 : f3=s*u*t^4*v^2+5*s^2*t^6\n2 6\n4 2\no7 = 5s t + s*u*t v\ni8 : f4=2*u^2*v^6+s^2*t^6\n2 6\n2 6\no8 = s t + 2u v\n\nWe construct the matrix associated to the polynomials and we relabel them in order to be\nable to automatize some procedures.\n\ni9 : F=matrix{{f1,f2,f3,f4}}\no9 = | sut6+2u2v6 sut5v-3sut3v3 5s2t6+sut4v2 s2t6+2u2v6 |\n1\n4\no9 : Matrix S <--- S\ni10 : f_1=f1;\ni11 : f_2=f2;\ni12 : f_3=f3;\ni13 : f_4=f4;\n\nWe define the associated affine polynomials FF i by specializing the variables u and v to\n1.\ni14 : for i from 1 to 4 do (\nFF_i=substitute(f_i,{u=>1,v=>1});\n)\n\nWe just change the polynomials FF i to the new ring S2.\n\ni15\no15\no15\ni16\n\n154\n\n:\n=\n:\n:\n\nS2=QQ[s,t]\nS2\nPolynomialRing\nfor i from 1 to 4 do (\nFF_i=sub(FF_i,S2);\n)\n\n\fThe reader can experiment with the implementation simply by changing the definition of\nthe polynomials and their degrees, the rest of the code being identical. We first set up the\nlist st of monomials si tj of bidegree (e01 , e02 ). In the toric case, this list should only contain\nthe monomials corresponding to points in the Newton polytope N 0 (f ).\ni17 : use S;\ni18 : st={};\ni19 : for i from 1 to 4 do (\nst=join(st,flatten entries monomials f_i);\n)\ni20 : l=length(st)-1;\ni21 : k=gcd(e1,e2)\no21 = 2\n\nWe compute the ideal J and the quotient ring A. This is done by a Gr\u00f6bner basis computation which works well for examples of small degree, but which should be replaced by\na matrix formula in more complicated examples. In the toric case, there exist specialized\nsoftware systems such as [4ti] to compute the ideal J.\ni24\no24\no24\ni25\ni26\n\n:\n=\n:\n:\n:\n\no26 :\ni27 :\no27 =\no27 :\ni28 :\no28 =\no28\ni29\ni30\ni31\no31\n\n:\n:\n:\n:\n=\n\no31 :\ni32 :\n\ni33 :\no33 =\n\nSX=QQ[s,u,t,v,w,x_0..x_l,MonomialOrder=>Eliminate 5]\nSX\nPolynomialRing\nX={};\nst=matrix {st};\n1\n8\nMatrix S <--- S\nF=sub(F,SX)\n| sut6+2u2v6 sut5v-3sut3v3 5s2t6+sut4v2 s2t6+2u2v6 |\n1\n4\nMatrix SX <--- SX\nst=sub(st,SX)\n| sut6 u2v6 sut5v sut3v3 s2t6 sut4v2 s2t6 u2v6 |\n1\n8\nMatrix SX <--- SX\nte=1;\nfor i from 0 to l do ( te=te*x_i )\nJ=ideal(1-w*te)\nideal(- w*x x x x x x x x + 1)\n0 1 2 3 4 5 6 7\nIdeal of SX\nfor i from 0 to l do (\nJ=J+ideal (x_i - st_(0,i))\n)\nJ= selectInSubring(1,gens gb J)\n| x_4-x_6 x_1-x_7 x_3^2-x_6x_7 x_2x_3-x_5^2 x_0x_3-x_2x_5\n\n155\n\n\fo33\ni34\no34\no34\ni35\no35\n\n:\n:\n=\n:\n:\n=\n\no35\ni36\no36\no36\n\n:\n:\n=\n:\n\n--------------------------------------------------------x_2^2-x_0x_5 x_5^3-x_0x_6x_7 x_3x_5^2-x_2x_6x_7 |\n1\n8\nMatrix SX <--- SX\nR=QQ[x_0..x_l]\nR\nPolynomialRing\nJ=sub(J,R)\n| x_4-x_6 x_1-x_7 x_3^2-x_6x_7 x_2x_3-x_5^2 x_0x_3-x_2x_5\n--------------------------------------------------------x_2^2-x_0x_5 x_5^3-x_0x_6x_7 x_3x_5^2-x_2x_6x_7 |\n1\n8\nMatrix R <--- R\nA=R/ideal(J)\nA\nQuotientRing\n\nNext, we set up the list ST of monomials si tj of bidegree (e1 , e2 ) and the list X of the\ncorresponding elements of the quotient ring A. In the toric case, this list should only\ncontain the monomials corresponding to points in the Newton polytope N (f ).\ni37\no37\no37\ni38\ni39\ni40\n\n: use SX\n= SX\n: PolynomialRing\n:\nST={};\n:\nX={};\n:\nfor i from 0 to l do (\nST=append(ST,st_(0,i));\nX=append(X,x_i);\n)\n\nWe can now define the new parametrization g by the polynomials g1 , . . . , g4 .\ni41 : X=matrix {X};\n1\n8\no41 : Matrix SX <--- SX\ni42 : X=sub(X,SX)\no42 = | x_0 x_1 x_2 x_3 x_4 x_5 x_6 x_7 |\n1\n8\no42 : Matrix SX <--- SXX=matrix {X};\ni43 : (M,C)=coefficients(F,Variables=>{s_SX,u_SX,t_SX,v_SX},Monomials=>ST)\no43 = (| sut6 u2v6 sut5v sut3v3 s2t6 sut4v2 s2t6 u2v6 |, {8} | 1 0 0 0 |)\n{8} | 0 0 0 0 |\n{8} | 0 1 0 0 |\n{8} | 0 -3 0 0 |\n\n156\n\n\f{8}\n{8}\n{8}\n{8}\n\n|\n|\n|\n|\n\n0\n0\n0\n2\n\n0\n0\n0\n0\n\n0\n1\n5\n0\n\n0\n0\n1\n2\n\n|\n|\n|\n|\n\no43 : Sequence\ni44 : G=X*C\no44 = | x_0+2x_7 x_2-3x_3 x_5+5x_6 x_6+2x_7 |\n1\n4\no44 : Matrix SX <--- SX\ni45 : G=matrix{{G_(0,0),G_(0,1),G_(0,2),G_(0,3)}}\no45 = | x_0+2x_7 x_2-3x_3 x_5+5x_6 x_6+2x_7 |\n1\n4\no45 : Matrix SX <--- SX\ni46 : G=sub(G,A)\no46 = | x_0+2x_7 x_2-3x_3 x_5+5x_6 x_6+2x_7 |\n1\n4\no46 : Matrix A <--- A\n\nIn the following, we construct the matrix representation M . For simplicity, we compute\nthe whole module Z1 , which is not necessary as we only need the graded part (Z1 )\u03bd0 . In\ncomplicated examples, one should compute only this graded part by directly solving a linear\nsystem in degree \u03bd0 . Remark that the best bound nu = \u03bd0 depends on the parametrization.\ni47\no47\no47\ni48\ni49\ni50\ni51\ni52\no52\ni53\no53\ni54\no54\ni55\n\n:\n=\n:\n:\n:\n:\n:\n:\n=\n:\n=\n:\n=\n:\n\nuse A\nA\nQuotientRing\nZ0=A^1;\nZ1=kernel koszul(1,G);\nZ2=kernel koszul(2,G);\nZ3=kernel koszul(3,G);\nnu=-1\n-1\nd=1\n1\nhfnu = 1\n1\nwhile hfnu != 0 do (\nnu=nu+1;\nhfZ0nu = hilbertFunction(nu,Z0);\nhfZ1nu = hilbertFunction(nu+d,Z1);\nhfZ2nu = hilbertFunction(nu+2*d,Z2);\nhfZ3nu = hilbertFunction(nu+3*d,Z3);\nhfnu = hfZ0nu-hfZ1nu+hfZ2nu-hfZ3nu;\n);\ni56 : nu\n\n157\n\n\fo56\ni57\no57\ni58\no58\ni59\no59\ni60\no60\ni61\no61\n\n=\n:\n=\n:\n=\n:\n=\n:\n=\n:\n=\n\n2\nhfZ0nu\n17\nhfZ1nu\n34\nhfZ2nu\n23\nhfZ3nu\n6\nhfnu\n0\n\ni62 : hilbertFunction(nu+d,Z1)-2*hilbertFunction(nu+2*d,Z2)+\n3*hilbertFunction(nu+3*d,Z3)\no62 = 6\ni63 : GG=ideal G\no63 = ideal (x + 2x , x - 3x , x + 5x , x + 2x )\n0\n7\n2\n3\n5\n6\n6\n7\no63 : Ideal of A\ni64 : GGsat=saturate(GG, ideal (x_0..x_l))\no64 = ideal 1\no64 : Ideal of A\ni65 : degrees gens GGsat\no65 = {{{0}}, {{0}}}\no65 : List\ni66 : H=GGsat/GG\no66 = subquotient (| 1 |, | x_0+2x_7 x_2-3x_3 x_5+5x_6 x_6+2x_7 |)\n1\no66 : A-module, subquotient of A\ni67 : degrees gens H\no67 = {{{0}}, {{0}}}\no67 : List\ni68 : S=A[T1,T2,T3,T4]\no68 = S\no68 : PolynomialRing\ni69 : G=sub(G,S);\n1\n4\no69 : Matrix S <--- S\ni70 : Z1nu=super basis(nu+d,Z1);\n4\n34\no70 : Matrix A <--- A\ni71 : Tnu=matrix{{T1,T2,T3,T4}}*substitute(Z1nu,S);\n1\n34\no71 : Matrix S <--- S\ni72 :\nlll=matrix {{x_0..x_l}}\n\n158\n\n\fo72 = | x_0 x_7 x_2 x_3 x_6 x_5 x_6 x_7 |\n1\n8\no72 : Matrix A <--- A\ni73 : lll=sub(lll,S)\no73 = | x_0 x_7 x_2 x_3 x_6 x_5 x_6 x_7 |\n1\n8\no73 : Matrix S <--- S\ni74 : ll={}\no74 = {}\no74 : List\ni75 : for i from 0 to l do { ll=append(ll,lll_(0,i)) }\ni76 : (m,M)=coefficients(Tnu,Variables=>ll,Monomials=>substitute(basis(nu,A),S));\ni77 : M;\n17\n34\no77 : Matrix S\n<--- S\n\nThe matrix M is the desired matrix representation of the surface S .\nWe can continue by computing the implicit equation and verifying the result by substituting\n\ni78\no78\no78\ni79\no79\no79\ni80\ni81\no81\no81\ni82\n\n:\n=\n:\n:\n=\n:\n:\n:\n=\n:\n:\n\nT=QQ[T1,T2,T3,T4]\nT\nPolynomialRing\nListofTand0 ={T1,T2,T3,T4}\n{T1, T2, T3, T4}\nList\nfor i from 0 to l do { ListofTand0=append(ListofTand0,0) };\np=map(T,S,ListofTand0)\nmap(T,S,{T1, T2, T3, T4, 0, 0, 0, 0, 0, 0, 0, 0})\nRingMap T <--- S\nN=MaxCol(p(M));\n17\n17\no82 : Matrix T\n<--- T\ni83 : Eq=det(N); factor Eq\n\nWe verify the result by substituting on the computed equation, the polynomials f1 to f4 .\ni85\no86\ni87\no87\n\n:use S; Eq=sub(Eq,S)\n: S\n: sub(Eq,{T1=>G_(0,0),T2=>G_(0,1),T3=>G_(0,2),T4=>G_(0,3)})\n= 0\n\n159\n\n\f\f9 A package for computing implicit\nequations from toric surfaces without\nan embedding\n9.1 Implementation in Macaulay2\nIn this section we show how to compute a matrix representation and the implicit equation\nwith the method developed in Chapter 7, following [Bot10], using the computer algebra\nsystem Macaulay2 [GS]. As it is probably the most interesting case from a practical point\nof view, we restrict our computations to parametrizations of a multigraded hypersurface.\nThis implementation allows to compute small examples for the better understanding of the\ntheory, but we are not claiming that this implementation is optimized for efficiency; anyone\ntrying to implement the method to solve computationally involved examples is well-advised\nto give more ample consideration to this issue.\n\n9.1.1 Example 1\nConsider the rational map\nf\n\nP1 \u00d7 P1\n99K\nP3\n(s : u) \u00d7 (t : v) 7\u2192 (f1 : f2 : f3 : f4 )\n\n(9.1)\n\nwhere the polynomials fi = fi (s, u, t, v) are bihomogeneous of bidegree (2, 3) \u2208 Z2 given\nby\n\u2022 f1 = s2 t3 + 2sut3 + 3u2 t3 + 4s2 t2 v + 5sut2 v + 6u2 t2 v + 7s2 tv 2 + 8sutv 2 + 9u2 tv 2 +\n10s2 v 3 + suv 3 + 2u2 v 3 ,\n\u2022 f2 = 2s2 t3 \u2212 3s2 t2 v \u2212 s2 tv 2 + sut2 v + 3sutv 2 \u2212 3u2 t2 v + 2u2 tv 2 \u2212 u2 v 3 ,\n\n161\n\n\f\u2022 f3 = 2s2 t3 \u2212 3s2 t2 v \u2212 2sut3 + s2 tv 2 + 5sut2 v \u2212 3sutv 2 \u2212 3u2 t2 v + 4u2 tv 2 \u2212 u2 v 3 ,\n\u2022 f4 = 3s2 t2 v \u2212 2sut3 \u2212 s2 tv 2 + sut2 v \u2212 3sutv 2 \u2212 u2 t2 v + 4u2 tv 2 \u2212 u2 v 3 .\nOur aim is to get the implicit equation of the hypersurface im(f ) of P3 .\nFirst we load the package \"Maximal minors\"\ni1 : load \"maxminor.m2\"\n\nLet us start by defining the parametrization f given by (f1 , f2 , f3 , f4 ).\ni2 : S=QQ[s,u,t,v,Degrees=>{{1,1,0},{1,1,0},{1,0,1},{1,0,1}}];\ni3 : e1=2;\ni4 : e2=3;\ni5 : f1=1*s^2*t^3+2*s*u*t^3+3*u^2*t^3+4*s^2*t^2*v+5*s*u*t^2*v+6*u^2*t^2*v+\n7*s^2*t*v^2+8*s*u*t*v^2+9*u^2*t*v^2+10*s^2*v^3+1*s*u*v^3+2*u^2*v^3;\ni6 : f2=2*s^2*t^3-3*s^2*t^2*v-s^2*t*v^2+s*u*t^2*v+3*s*u*t*v^2-3*u^2*t^2*v+\n2*u^2*t*v^2-u^2*v^3;\ni7 : f3=2*s^2*t^3-3*s^2*t^2*v-2*s*u*t^3+s^2*t*v^2+5*s*u*t^2*v-3*s*u*t*v^23*u^2*t^2*v+4*u^2*t*v^2-u^2*v^3;\ni8 : f4=3*s^2*t^2*v-2*s*u*t^3-s^2*t*v^2+s*u*t^2*v-3*s*u*t*v^2-u^2*t^2*v+\n4*u^2*t*v^2-u^2*v^3;\n\nWe construct the matrix associated to the polynomials and we relabel them in order to be\nable to automatize some procedures.\n\ni9 : F=matrix{{f1,f2,f3,f4}}\no9 = | s2t3+2sut3+3u2t3+4s2t2v+5sut2v+6u2t2v+7s2tv2+8sutv2+9u2tv2+10s2v3+\n-------------------------------------------------------------------suv3+2u2v3 2s2t3-3s2t2v+sut2v-3u2t2v-s2tv2+3sutv2+2u2tv2-u2v3\n-------------------------------------------------------------------2s2t3-2sut3-3s2t2v+5sut2v-3u2t2v+s2tv2-3sutv2+4u2tv2-u2v3\n--------------------------------------------------------------------2sut3+3s2t2v+sut2v-u2t2v-s2tv2-3sutv2+4u2tv2-u2v3|\n1\n4\no9 : Matrix S <--- S\n\n162\n\n\fThe reader can experiment with the implementation simply by changing the definition of\nthe polynomials and their degrees, the rest of the code being identical.\nAs we mentioned in Example 7.5.2, if R1 := k[x1 , x2 ], R2 := k[y1 , y2 , y3 , y4 ], and G := Z2 ,\nwriting R := R1 \u2297k R2 and setting deg(xi ) = (1, 0) and deg(yi ) = (0, 1) for all i, with\na1 := (x1 , x2 ), a2 := (y1 , y2 , y3 , y4 ) and B := a1 * a2 \u2282 R we have that:\n\n1. SuppG (HB2 (R)) = SuppG (\u01581 ) \u222a SuppG (\u01582 ) = Q{1} = \u2212N \u00d7 N + (\u22122, 0) \u222a N \u00d7 \u2212N +\n(0, \u22122).\n2. SuppG (HB3 (R)) = SuppG (\u01581,2 ) = Q{1,2} = \u2212N \u00d7 \u2212N + (\u22122, \u22122), .\n\n(-2,0)\n\n(0,0)\nb\n\n(-1,-1)\n\nb\n\n(-2,-2)\n\nb\n\n(0,-2)\n\nAnd thus,\nRB (2, 3) = (SuppG (HB2 (R)) + (2, 3)) \u222a (SuppG (HB3 (R)) + 2 * (2, 3)).\nObtaining\n{RB (2, 3) = (N2 + (1, 5)) \u222a (N2 + (3, 2)).\nAs we can see in Example 9.1.1, a Macaulay2 computation gives exactly this region (illustrated below) as the acyclicity region for Z\u2022 .\ni10 : nu={5,3,2};\n\n163\n\n\fAn alternative consists in taking\ni10 : nu={6,1,5};\n\n(1,5)\n5\n\nb\n\n4\n\n(0,4)\n\nVanishing of\nlocal cohomology\n\nb\n\n(2,4)\n\n3\n\n(3,2)\n2\n\nb\n\n1\n\n(2,1)\n0\n\n.5\nNon-vanishing\nof\nlocal cohomology\n\n-1\n\nAnyhow, it is interesting to test what happens in different bidegrees \u03bd \u2208 Z2 by just replacing\nthe desired degree in the code.\nIn the following, we construct the matrix representation M . For simplicity, we compute\nthe whole module Z1 , which is not necessary as we only need the graded part (Z1 )\u03bd0 . In\ncomplicated examples, one should compute only this graded part by directly solving a linear\nsystem in degree \u03bd0 .\ni11\ni12\ni13\ni14\n\n:\n:\n:\n:\n\nZ0=S^1;\nZ1=kernel koszul(1,F);\nZ2=kernel koszul(2,F);\nZ3=kernel koszul(3,F);\n\ni15 : d={e1+e2,e1,e2}\ni16 : hfZ0nu = hilbertFunction(nu,Z0)\no16 = 12\ni17 : hfZ1nu = hilbertFunction(nu+d,Z1)\no17 = 12\n\n164\n\n\fi18 : hfZ2nu = hilbertFunction(nu+2*d,Z2)\no18 = 0\ni19 : hfZ3nu = hilbertFunction(nu+3*d,Z3)\no19 = 0\ni20 : hfnu = hfZ0nu-hfZ1nu+hfZ2nu-hfZ3nu\no20 = 0\n\nThus, when \u03bd0 = (3, 2) or \u03bd0 = (1, 5), we get a complex\nM\u03bd\n\n0\n(Z\u2022 )\u03bd0 : 0 \u2192 0 \u2192 0 \u2192 K[X]12 \u2212\u2192\nK[X]12 \u2192 0.\n\nand, hence, det((Z\u2022 )\u03bd0 ) = det(M\u03bd0 ) \u2208 K[X]12 is an homogeneous polynomial of degree 12\nthat vanishes on the closed image of \u03c6. We compute here the degree of the MacRae's\ninvariant which gives the degree of det((Z\u2022 )\u03bd0 ).\ni21 :hilbertFunction(nu+d,Z1)-2*hilbertFunction(nu+2*d,Z2)+\n3*hilbertFunction(nu+3*d,Z3)\no21 = 12\ni22 : GG=ideal F\n2 3\n3\n2 3\n2 2\n2\n2 2\n2\n2\no22 = ideal (s t +2s*u*t +3u t +4s t v+5s*u*t v+6u t v+7s t*v +\n-----------------------------------------------------------2\n2\n2\n2 3\n3\n2 3\n2 3\n2 2\n2\n8s*u*t*v +9u t*v +10s v +s*u*v *2u v , 2s t -3s t v+s*u*t v-----------------------------------------------------------2 2\n2\n2\n2\n2\n2 2 3\n2 3\n3\n2 2\n3u t v-s t*v +3s*u*t*v +2u t*v -u v , 2s t -2s*u*t -3s t v+\n-----------------------------------------------------------2\n2 2\n2\n2\n2\n2\n2 2 3\n3\n5s*u*t v-3u t v+s t*v -3s*u*t*v +4u t*v -u v , -2s*u*t +\n-----------------------------------------------------------2 2\n2\n2 2\n2\n2\n2\n2\n2 2 3\n3s t v+s*u*t v-u t v-s t*v -3s*u*t*v +4u t*v -u v )\no22 : Ideal of S\ni23 : GGsat=saturate(GG, ideal(s,t)*ideal(u,v))\n\n165\n\n\f2 2\n2\n2 2\n2\n2\n2\n2\n2 2 3\no23 = ideal (3s t v-3s*u*t v-u t v-3s t*v +3s*u*t*v +2u t*v -u v ,\n-------------------------------------------------------------2 3\n2\n2 2\n2\n2\n2\n2\n2\n2 3\n9u t +42s*u*t v+28u t v+45s t*v -15s*u*t*v +19u t*v +30s v +\n-------------------------------------------------------------3\n2 3\n3\n2\n2\n2\n2 2\n2\n2 3\n3s*u*v +13u v , s*u*t -2s*u*t v-s t*v +3s*u*t*v -u t*v , s t -------------------------------------------------------------2\n2 2\n2\n2\n2\n2\n2 2 3\n4 2 4\ns*u*t v-2u t v-2s t*v +3s*u*t*v +2u t*v -u v , 30s*u*v -u v ,\n-------------------------------------------------------------2 4\n2 4\n2\n3 2 4\n3 2 4\n2\n3\n2 4\n15s v +14u v , u t*v -u v , 30s*u*t*v -u v , 15s t*v +14u v ,\n-------------------------------------------------------------2 2 2 2 4\nu t v -u v )\no23 : Ideal of S\ni24 : degrees gens GGsat\no24 = {{{0, 0, 0}}, {{5, 2, 3}, {5, 2, 3}, {5, 2, 3}, {5, 2, 3}, {6,\n-------------------------------------------------------------2, 4}, {6,2, 4}, {6, 2, 4}, {6, 2, 4}, {6, 2, 4}, {6, 2, 4}}}\no24 : List\ni25 : H=GGsat/GG\no25 = subquotient (| 3s2t2v-3sut2v-u2t2v-3s2tv2+3sutv2+2u2tv2-u2v3\n9u2t3+42sut2v+28u2t2v+45s2tv2-15sutv2+19u2tv2+30s2v3+3suv3+\n13u2v3 sut3-2sut2v-s2tv2+3sutv2-u2tv2 s2t3-sut2v-2u2t2v-2s2tv2+\n3sutv2+2u2tv2-u2v3 30suv4-u2v4 15s2v4+14u2v4 u2tv3-u2v4\n30sutv3-u2v4 15s2tv3+14u2v4 u2t2v2-u2v4 |, | s2t3+2sut3+3u2t3+\n4s2t2v+5sut2v+6u2t2v+7s2tv2+8sutv2+9u2tv2+10s2v3+suv3+2u2v3\n2s2t3-3s2t2v+sut2v-3u2t2v-s2tv2+3sutv2+2u2tv2-u2v3 2s2t3-2sut33s2t2v+5sut2v-3u2t2v+s2tv2-3sutv2+4u2tv2-u2v3 -2sut3+3s2t2v+\nsut2v-u2t2v-s2tv2-3sutv2+4u2tv2-u2v3 |)\n1\no25 : S-module, subquotient of S\ni26 : degrees gens H\no26 = {{{0, 0, 0}}, {{5, 2, 3}, {5, 2, 3}, {5, 2, 3}, {5, 2, 3}, {6,\n\n166\n\n\f-------------------------------------------------------------2, 4}, {6,2, 4}, {6, 2, 4}, {6, 2, 4}, {6, 2, 4}, {6, 2, 4}}}\no26 : List\n\nNow, we focus on the computation of the implicit equation as the determinant of the rightmost map. Precisely, we will build-up this map, and later extract a maximal minor for taking\nits determinant. It is clear that is in general not the determinant of the approximation\ncomplex in degree \u03bd, but a multiple of it. We could get the correct equation by taking\nseveral maximal minors and considering the gcd of its determinant. This procedure is much\nmore expensive, hence, we avoid it.\nThus, first, we compute the right-most map of the approximation complex in degree \u03bd\ni27 : R=S[T1,T2,T3,T4];\ni28 : G=sub(F,R);\n1\n4\no28 : Matrix R <--- R\n\nWe compute a matrix presentation for (Z1 )\u03bd in K1 :\ni29 :Z1nu=super basis(nu+d,Z1);\n4\n12\no29 : Matrix S <--- S\ni30 : Tnu=matrix{{T1,T2,T3,T4}}*substitute(Z1nu,R);\n1\n12\no30 : Matrix R <--- R\ni31 : lll=matrix {{s,t,u,v}}\no31 = | s t u v |\n1\n4\no31 : Matrix S <--- S\ni32 : lll=sub(lll,R)\n\n167\n\n\fo32 = | s t u v |\n1\n4\no32 : Matrix R <--- R\ni33 : ll={};\ni34 : for i from 0 to 3 do { ll=append(ll,lll_(0,i)) }\n\nNow, we compute the matrix of the map (Z1 )\u03bd \u2192 A\u03bd [T1 , T2 , T3 , T4 ]\ni35 : (m,M)=coefficients(Tnu,Variables=>ll,Monomials=>substitute(\nbasis(nu,S),R));\ni36 : M;\n12\n12\no36 : Matrix R\n<--- R\ni37 : T=QQ[T1,T2,T3,T4];\ni38 : ListofTand0 ={T1,T2,T3,T4};\ni39 : for i from 0 to 3 do { ListofTand0=append(ListofTand0,0) };\ni40 : p=map(T,R,ListofTand0)\no40 = map(T,R,{T1, T2, T3, T4, 0, 0, 0, 0})\no40 : RingMap T <--- R\ni41 :N=MaxCol(p(M));\n12\n12\no41 : Matrix T\n<--- T\n\nThe matrix M is the desired matrix representation of the surface S . We can continue by\ncomputing the implicit equation by taking determinant. As we mentioned, this is fairly\nmore costly. If we take determinant what we get is a multiple of the implicit equation. One\nwise way for recognizing which of them is the implicit equation is substituting a few points\nof the surface, and verifying which vanishes.\nPrecisely, here there is a multiple of the implicit equation (by taking several minors we erase\nextra factors):\n\n168\n\n\fi42 :Eq=det(N); factor Eq;\n\nWe verify the result by sustituting on the computed equation, the polynomials f1 to f4 . We\nverify that in this case, this is the implicit equation:\ni44 : use R; Eq=sub(Eq,R);\ni46 : sub(Eq,{T1=>G_(0,0),T2=>G_(0,1),T3=>G_(0,2),T4=>G_(0,3)})\no46 = 0\no46 : R\n\n169\n\n\f\fBibliography\n[4ti]\n\nTeam 4ti2, 4ti2 - a software package for algebraic, geometric and combinatorial\nproblems on linear spaces, http://www.4ti2.de.\n\n[AHW05] William A Adkins, Jerome W Hoffman, and Hao Hao Wang, Equations of parametric surfaces with base points via syzygies, J. Symbolic Comput 39 (2005),\nno. 1, 73\u2013101. MR MR2168242 (2006h:14066)\n[Avr81]\n\nLuchezar L Avramov, Complete intersections and symmetric algebras, J. Algebra\n73 (1981), no. 1, 248\u2013263. MR MR641643 (83e:13024)\n\n[BC05]\n\nLaurent Bus\u00e9 and Marc Chardin, Implicitizing rational hypersurfaces using approximation complexes, J. Symbolic Comput 40 (2005), no. 4-5, 1150\u20131168. MR\nMR2172855 (2006g:14097)\n\n[BCD03] Laurent Bus\u00e9, David Cox, and Carlos D'Andrea, Implicitization of surfaces in\nP3 in the presence of base points, J. Algebra Appl 2 (2003), no. 2, 189\u2013214. MR\nMR1980408 (2004f:14092)\n[BCJ09]\n\nLaurent Bus\u00e9, Marc Chardin, and Jean-Pierre Jouanolou, Torsion of the symmetric algebra and implicitization, Proc. Amer. Math. Soc 137 (2009), no. 6,\n1855\u20131865. MR MR2480264\n\n[BCS09]\n\nLaurent Bus\u00e9, Marc Chardin, and Aron Simis, Elimination and nonlinear equations of rees algebra, http://arxiv.org/abs/0911.2569 (2009).\n\n[BD07]\n\nLaurent Bus\u00e9 and Marc Dohm, Implicitization of bihomogeneous parametrizations\nof algebraic surfaces via linear syzygies, ISSAC 2007, ACM, New York, 2007,\npp. 69\u201376. MR MR2396186\n\n[BD10]\n\nNicol\u00e1s Botbol and Marc Dohm, A package for computing implicit equations of\nparametrizations from toric surfaces, arXiv:1001.1126 (2010).\n\n[BDD09] Nicol\u00e1s Botbol, Alicia Dickenstein, and Marc Dohm, Matrix representations for\ntoric parametrizations, Comput. Aided Geom. Design 26 (2009), no. 7, 757\u2013771.\nMR MR2569833\n\n171\n\n\f[BGT97] Winfried Bruns, Joseph Gubeladze, and Ng\u00f4 Vi\u00eat Trung, Normal polytopes, triangulations, and Koszul algebras, J. Reine Angew. Math 485 (1997), 123\u2013160.\nMR MR1442191 (99c:52016)\n[BH93]\n\nWinfried Bruns and J\u00fcrgen Herzog, Cohen-Macaulay rings, Cambridge Studies in\nAdvanced Mathematics, vol. 39, Cambridge University Press, Cambridge, 1993.\nMR MR1251956 (95h:13020)\n\n[BJ03]\n\nLaurent Bus\u00e9 and Jean-Pierre Jouanolou, On the closed image of a rational map\nand the implicitization problem, J. Algebra 265 (2003), no. 1, 312\u2013357. MR\nMR1984914 (2004e:14024)\n\n[BM93]\n\nDave Bayer and David Mumford, What can be computed in algebraic geometry?,\nComputational algebraic geometry and commutative algebra (Cortona, 1991),\nSympos. Math., XXXIV, Cambridge Univ. Press, Cambridge, 1993, pp. 1\u201348.\nMR MR1253986 (95d:13032)\n\n[Bot09a] Nicol\u00e1s Botbol, Code in macaulay2 for computing the toric embedding of (P1 )3 in\nP11 , http://mate.dm.uba.ar/ nbotbol/ (2009).\n[Bot09b]\n\n, The implicitization problem for \u03c6 : Pn 99K (P1 )n+1 , J. Algebra 322\n(2009), no. 11, 3878\u20133895. MR MR2556128\n\n[Bot10]\n\n, Compactifications of rational maps and the implicit equations of their\nimages, To appear in J. Pure and Applied Algebra. arXiv:0910.1340 (2010).\n\n[Bus01]\n\nLaurent Bus\u00e9, \u00c9tude du r\u00e9sultant sur une vari\u00e9t\u00e9 alg\u00e9brique. phd thesis, Universit\u00e9 de Nice Sophia-Antipolis (2001).\n\n[Bus06]\n\n, Elimination theory in codimension one and applications, INRIA research\nreport 5918. Notes of lectures given at the CIMPA-UNESCO-IRAN school in\nZanjan, Iran, July 9-22 2005 (2006), 47.\n\n[CD07]\n\nMar\u0131\u0301a Ang\u00e9lica Cueto and Alicia Dickenstein, Some results on inhomogeneous\ndiscriminants, Proceedings of the XVIth Latin American Algebra Colloquium\n(Spanish), Bibl. Rev. Mat. Iberoamericana, Rev. Mat. Iberoamericana, Madrid,\n2007, pp. 41\u201362. MR MR2500350\n\n[Cha04]\n\nMarc Chardin, Regularity of ideals and their powers., Insitut de Math\u00e9matiques\nde Jussieu Pr\u00e9publication 364 (2004).\n\n[Cha06]\n\n, Implicitization using approximation complexes, Algebraic geometry\nand geometric modeling, Math. Vis, Springer, Berlin, 2006, pp. 23\u201335. MR\nMR2279841 (2007j:14097)\n\n172\n\n\f[CJR11]\n\nMarc Chardin, Jean-Pierre Jouanolou, and Ahad Rahimi, The eventual stability\nof depth, associated primes and cohomology of a graded module.\n\n[CLS]\n\nDavid A Cox, John B. Little, and Hal\nhttp://www.cs.amherst.edu/ dac/toric.html.\n\n[Cox95]\n\nDavid A Cox, The homogeneous coordinate ring of a toric variety, J. Algebraic\nGeom 4 (1995), no. 1, 17\u201350. MR MR1299003 (95i:14046)\n\n[Cox01]\n\n, Equations of parametric curves and surfaces via syzygies, Symbolic computation: solving equations in algebra, geometry, and engineering (South Hadley,\nMA, 2000), Contemp. Math, vol. 286, Amer. Math. Soc, Providence, RI, 2001,\npp. 1\u201320. MR MR1874268 (2002i:14056)\n\nSchenck,\n\nToric varieties,\n\n[Cox03a] David Cox, Curves, surfaces, and syzygies, Topics in algebraic geometry and\ngeometric modeling, Contemp. Math, vol. 334, Amer. Math. Soc, Providence,\nRI, 2003, pp. 131\u2013150. MR MR2039970 (2005g:14113)\n[Cox03b]\n\n, What is a toric variety?, Topics in algebraic geometry and geometric\nmodeling, Contemp. Math, vol. 334, Amer. Math. Soc, Providence, RI, 2003,\npp. 203\u2013223. MR MR2039974 (2005b:14089)\n\n[CSC98]\n\nDavid A Cox, Thomas W Sederberg, and Falai Chen, The moving line ideal\nbasis of planar rational curves, Comput. Aided Geom. Design 15 (1998), no. 8,\n803\u2013827. MR MR1638732 (99h:14056)\n\n[D'A01]\n\nCarlos D'Andrea, Resultants and moving surfaces, J. Symbolic Comput. 31\n(2001), no. 5, 585\u2013602. MR MR1828705 (2002b:65027)\n\n[DFS07]\n\nAlicia Dickenstein, Eva Maria Feichtner, and Bernd Sturmfels, Tropical discriminants, J. Amer. Math. Soc 20 (2007), no. 4, 1111\u20131133 (electronic). MR\nMR2328718 (2008j:14095)\n\n[EG84]\n\nDavid Eisenbud and Shiro Goto, Linear free resolutions and minimal multiplicity,\nJ. Algebra 88 (1984), no. 1, 89\u2013133. MR MR741934 (85f:13023)\n\n[Ful93]\n\nWilliam Fulton, Introduction to toric varieties, Annals of Mathematics Studies,\nvol. 131, Princeton University Press, Princeton, NJ, 1993, The William H. Roever\nLectures in Geometry. MR MR1234037 (94g:14028)\n\n[GK03]\n\nRon Goldman and Rimvydas Krasauskas (eds.), Topics in algebraic geometry\nand geometric modeling, Contemporary Mathematics, vol. 334, American Mathematical Society, Providence, RI, 2003, Papers from the Workshop on Algebraic\n\n173\n\n\fGeometry and Geometric Modeling held at Vilnius University, Vilnius, July 29\u2013\nAugust 2, 2002. MR MR2046835 (2004j:00026)\n[GKZ94] Israel M Gel0 fand, Mikhail M Kapranov, and Aandrei V Zelevinsky, Discriminants, resultants, and multidimensional determinants, Mathematics: Theory\n& Applications, Birkh\u00e4user Boston Inc, Boston, MA, 1994. MR MR1264417\n(95e:14045)\n[GS]\n\nDaniel R Grayson and Michael E Stillman, Macaulay 2, a software system for\nresearch in algebraic geometry., http://www.math.uiuc.edu/Macaulay2/.\n\n[Har77]\n\nRobin Hartshorne, Algebraic geometry, Springer-Verlag, New York, 1977, Graduate Texts in Mathematics, No. 52. MR MR0463157 (57 #3116)\n\n[Hof89]\n\nChristoph Hoffmann, Geometric solid modeling: an introduction, Morgan Kaufmann publishers (1989).\n\n[HSV82]\n\nJ\u00fcrgen Herzog, Aron Simis, and Wolmer V Vasconcelos, Approximation complexes of blowing-up rings, J. Algebra 74 (1982), no. 2, 466\u2013493. MR MR647249\n(83h:13023)\n\n[HSV83a] J\u00fcrgen Herzog, Aaron Simis, and Wolmer V Vasconcelos, Koszul homology and\nblowing-up rings, Commutative algebra (Trento, 1981), Lecture Notes in Pure\nand Appl. Math, vol. 84, Dekker, New York, 1983, pp. 79\u2013169. MR MR686942\n(84k:13015)\n[HSV83b] J\u00fcrgen Herzog, Aron Simis, and Wolmer V Vasconcelos, Approximation complexes of blowing-up rings. II, J. Algebra 82 (1983), no. 1, 53\u201383. MR MR701036\n(85b:13015)\n[HW04]\n\nJerome W. Hoffman and Hao Hao Wang, Castelnuovo-Mumford regularity in\nbiprojective spaces, Adv. Geom. 4 (2004), no. 4, 513\u2013536. MR MR2096526\n(2006b:13032)\n\n[Jou95]\n\nJean-Pierre Jouanolou, Aspects invariants de l'\u00e9limination, Adv. Math 114\n(1995), no. 1, 1\u2013174. MR MR1344713 (96m:14001)\n\n[KD06]\n\nAmit Khetan and Carlos D'Andrea, Implicitization of rational surfaces using toric varieties, J. Algebra 303 (2006), no. 2, 543\u2013565. MR MR2255122\n(2007k:14126)\n\n[KM76]\n\nFinn Faye Knudsen and David Mumford, The projectivity of the moduli space\nof stable curves. I. Preliminaries on \"det\" and \"Div\", Math. Scand 39 (1976),\nno. 1, 19\u201355. MR MR0437541 (55 #10465)\n\n174\n\n\f[Lat]\n\nTeam Latte, Latte - a software dedicated to the problems of counting and detecting lattice points inside convex polytopes, and the solution of integer programs,\nhttp://www.math.ucdavis.edu/ latte/.\n\n[Mac65]\n\nRobert E MacRae, On an application of the Fitting invariants, J. Algebra 2\n(1965), 153\u2013169. MR MR0178038 (31 #2296)\n\n[Mat89]\n\nHideyuki Matsumura, Commutative ring theory, second ed., Cambridge Studies\nin Advanced Mathematics, vol. 8, Cambridge University Press, Cambridge, 1989,\nTranslated from the Japanese by M. Reid. MR MR1011461 (90i:13001)\n\n[MS04]\n\nDiane Maclagan and Gregory G Smith, Multigraded Castelnuovo-Mumford\nregularity, J. Reine Angew. Math. 571 (2004), 179\u2013212. MR MR2070149\n(2005g:13027)\n\n[MS05]\n\nEzra Miller and Bernd Sturmfels, Combinatorial commutative algebra, Graduate Texts in Mathematics, vol. 227, Springer-Verlag, New York, 2005. MR\nMR2110098 (2006d:13001)\n\n[Mum66] David Mumford, Lectures on curves on an algebraic surface, With a section by\nG. M. Bergman. Annals of Mathematics Studies, No. 59, Princeton University\nPress, Princeton, N.J., 1966. MR MR0209285 (35 #187)\n[Mus02]\n\nMircea Musta\u0163a, Vanishing theorems on toric varieties, Tohoku Math. J. (2) 54\n(2002), no. 3, 451\u2013470. MR MR1916637 (2003e:14013)\n\n[Nor76]\n\nDouglas G. Northcott, Finite free resolutions, Cambridge University Press, Cambridge, 1976, Cambridge Tracts in Mathematics, No. 71. MR MR0460383 (57\n#377)\n\n[PD06]\n\nSonia P\u00e9rez-D\u0131\u0301az, On the problem of proper reparametrization for rational curves\nand surfaces, Comput. Aided Geom. Design 23 (2006), no. 4, 307\u2013323. MR\nMR2218599 (2007a:14066)\n\n[SC95]\n\nTom Sederberg and Falai Chen, Implicitization using moving curves and surfaces,\nComputer Graphics Annual Conference Series 303 (1995), 301\u2013308.\n\n[Sch03]\n\nJosef Schicho, Simplification of surface parametrizations-a lattice polygon approach, J. Symbolic Comput. 36 (2003), no. 3-4, 535\u2013554, International Symposium on Symbolic and Algebraic Computation (ISSAC'2002) (Lille). MR\nMR2004041 (2004i:65015)\n\n[Sul08]\n\nSeth Sullivant, Combinatorial symbolic powers, J. Algebra 319 (2008), no. 1,\n115\u2013142. MR MR2378064 (2009c:13005)\n\n175\n\n\f[SV81]\n\nAron Simis and Wolmer V Vasconcelos, The syzygies of the conormal module,\nAmer. J. Math. 103 (1981), no. 2, 203\u2013224. MR MR610474 (82i:13016)\n\n[Vas94a]\n\nWolmer V Vasconcelos, Arithmetic of blowup algebras, London Mathematical\nSociety Lecture Note Series, vol. 195, Cambridge University Press, Cambridge,\n1994. MR MR1275840 (95g:13005)\n\n[Vas94b]\n\n, Arithmetic of blowup algebras, London Mathematical Society Lecture Note Series, vol. 195, Cambridge University Press, Cambridge, 1994. MR\nMR1275840 (95g:13005)\n\n[ZSCC03] Jianmin Zheng, Thomas W Sederberg, Eng-Wee Chionh, and David A Cox, Implicitizing rational surfaces with base points using the method of moving surfaces, Topics in algebraic geometry and geometric modeling, Contemp. Math.,\nvol. 334, Amer. Math. Soc., Providence, RI, 2003, pp. 151\u2013168. MR MR2039971\n(2005c:14082)\n\n176\n\n\f"}