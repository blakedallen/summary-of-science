{"id": "http://arxiv.org/abs/1111.6306v2", "guidislink": true, "updated": "2012-01-04T17:11:59Z", "updated_parsed": [2012, 1, 4, 17, 11, 59, 2, 4, 0], "published": "2011-11-27T22:18:06Z", "published_parsed": [2011, 11, 27, 22, 18, 6, 6, 331, 0], "title": "Control and Synchronization of Neuron Ensembles", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1111.5476%2C1111.3547%2C1111.6344%2C1111.4162%2C1111.7001%2C1111.7197%2C1111.1188%2C1111.4641%2C1111.6294%2C1111.2324%2C1111.5296%2C1111.1224%2C1111.3050%2C1111.7011%2C1111.1396%2C1111.1401%2C1111.0124%2C1111.0513%2C1111.0152%2C1111.4676%2C1111.1809%2C1111.1716%2C1111.6395%2C1111.2499%2C1111.6960%2C1111.5223%2C1111.5259%2C1111.1755%2C1111.1885%2C1111.4945%2C1111.0828%2C1111.4728%2C1111.3485%2C1111.2673%2C1111.7040%2C1111.6001%2C1111.3029%2C1111.2612%2C1111.1817%2C1111.3553%2C1111.0912%2C1111.3950%2C1111.6306%2C1111.4331%2C1111.1523%2C1111.1830%2C1111.5570%2C1111.4477%2C1111.3651%2C1111.1819%2C1111.7106%2C1111.7087%2C1111.4862%2C1111.4946%2C1111.5649%2C1111.6589%2C1111.0933%2C1111.4328%2C1111.0681%2C1111.6366%2C1111.2449%2C1111.2379%2C1111.7274%2C1111.2435%2C1111.4861%2C1111.5776%2C1111.0759%2C1111.4800%2C1111.7307%2C1111.6766%2C1111.1940%2C1111.6496%2C1111.0937%2C1111.6511%2C1111.3404%2C1111.0088%2C1111.7168%2C1111.4338%2C1111.3254%2C1111.7206%2C1111.2865%2C1111.6969%2C1111.6356%2C1111.2377%2C1111.6170%2C1111.3815%2C1111.0536%2C1111.2693%2C1111.6393%2C1111.3432%2C1111.3737%2C1111.2954%2C1111.2013%2C1111.4849%2C1111.3503%2C1111.6022%2C1111.5867%2C1111.2602%2C1111.5543%2C1111.3325%2C1111.0426&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Control and Synchronization of Neuron Ensembles"}, "summary": "Synchronization of oscillations is a phenomenon prevalent in natural, social,\nand engineering systems. Controlling synchronization of oscillating systems is\nmotivated by a wide range of applications from neurological treatment of\nParkinson's disease to the design of neurocomputers. In this article, we study\nthe control of an ensemble of uncoupled neuron oscillators described by phase\nmodels. We examine controllability of such a neuron ensemble for various phase\nmodels and, furthermore, study the related optimal control problems. In\nparticular, by employing Pontryagin's maximum principle, we analytically derive\noptimal controls for spiking single- and two-neuron systems, and analyze the\napplicability of the latter to an ensemble system. Finally, we present a robust\ncomputational method for optimal control of spiking neurons based on\npseudospectral approximations. The methodology developed here is universal to\nthe control of general nonlinear phase oscillators.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1111.5476%2C1111.3547%2C1111.6344%2C1111.4162%2C1111.7001%2C1111.7197%2C1111.1188%2C1111.4641%2C1111.6294%2C1111.2324%2C1111.5296%2C1111.1224%2C1111.3050%2C1111.7011%2C1111.1396%2C1111.1401%2C1111.0124%2C1111.0513%2C1111.0152%2C1111.4676%2C1111.1809%2C1111.1716%2C1111.6395%2C1111.2499%2C1111.6960%2C1111.5223%2C1111.5259%2C1111.1755%2C1111.1885%2C1111.4945%2C1111.0828%2C1111.4728%2C1111.3485%2C1111.2673%2C1111.7040%2C1111.6001%2C1111.3029%2C1111.2612%2C1111.1817%2C1111.3553%2C1111.0912%2C1111.3950%2C1111.6306%2C1111.4331%2C1111.1523%2C1111.1830%2C1111.5570%2C1111.4477%2C1111.3651%2C1111.1819%2C1111.7106%2C1111.7087%2C1111.4862%2C1111.4946%2C1111.5649%2C1111.6589%2C1111.0933%2C1111.4328%2C1111.0681%2C1111.6366%2C1111.2449%2C1111.2379%2C1111.7274%2C1111.2435%2C1111.4861%2C1111.5776%2C1111.0759%2C1111.4800%2C1111.7307%2C1111.6766%2C1111.1940%2C1111.6496%2C1111.0937%2C1111.6511%2C1111.3404%2C1111.0088%2C1111.7168%2C1111.4338%2C1111.3254%2C1111.7206%2C1111.2865%2C1111.6969%2C1111.6356%2C1111.2377%2C1111.6170%2C1111.3815%2C1111.0536%2C1111.2693%2C1111.6393%2C1111.3432%2C1111.3737%2C1111.2954%2C1111.2013%2C1111.4849%2C1111.3503%2C1111.6022%2C1111.5867%2C1111.2602%2C1111.5543%2C1111.3325%2C1111.0426&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Synchronization of oscillations is a phenomenon prevalent in natural, social,\nand engineering systems. Controlling synchronization of oscillating systems is\nmotivated by a wide range of applications from neurological treatment of\nParkinson's disease to the design of neurocomputers. In this article, we study\nthe control of an ensemble of uncoupled neuron oscillators described by phase\nmodels. We examine controllability of such a neuron ensemble for various phase\nmodels and, furthermore, study the related optimal control problems. In\nparticular, by employing Pontryagin's maximum principle, we analytically derive\noptimal controls for spiking single- and two-neuron systems, and analyze the\napplicability of the latter to an ensemble system. Finally, we present a robust\ncomputational method for optimal control of spiking neurons based on\npseudospectral approximations. The methodology developed here is universal to\nthe control of general nonlinear phase oscillators."}, "authors": ["Jr-Shin Li", "Isuru Dasanayake", "Justin Ruths"], "author_detail": {"name": "Justin Ruths"}, "author": "Justin Ruths", "arxiv_comment": "29 pages, 6 figures", "links": [{"href": "http://arxiv.org/abs/1111.6306v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1111.6306v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "nlin.AO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1111.6306v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1111.6306v2", "journal_reference": null, "doi": null, "fulltext": "1\n\nControl and Synchronization of Neuron\nEnsembles\narXiv:1111.6306v2 [math.OC] 4 Jan 2012\n\nJr-Shin Li, Isuru Dasanayake, and Justin Ruths\n\nAbstract\nSynchronization of oscillations is a phenomenon prevalent in natural, social, and engineering\nsystems. Controlling synchronization of oscillating systems is motivated by a wide range of applications\nfrom neurological treatment of Parkinson's disease to the design of neurocomputers. In this article, we\nstudy the control of an ensemble of uncoupled neuron oscillators described by phase models. We examine\ncontrollability of such a neuron ensemble for various phase models and, furthermore, study the related\noptimal control problems. In particular, by employing Pontryagin's maximum principle, we analytically\nderive optimal controls for spiking single- and two-neuron systems, and analyze the applicability of the\nlatter to an ensemble system. Finally, we present a robust computational method for optimal control of\nspiking neurons based on pseudospectral approximations. The methodology developed here is universal\nto the control of general nonlinear phase oscillators.\nIndex Terms\nSpiking neurons; Controllability; Optimal control; Lie algebra; Pseudospectral methods.\n\nI. I NTRODUCTION\nNatural and engineered systems that consist of ensembles of isolated or interacting nonlinear\ndynamical components have reached levels of complexity that are beyond human comprehension. These complex systems often require an optimal hierarchical organization and dynamical\nJ.-S. Li is with the Department of Electrical and Systems Engineering, Washington University, St. Louis, MO 63130 USA\n(e-mail: jsli@seas.wustl.edu).\nI. Dasanayake is with the Department of Electrical and Systems Engineering, Washington University, St. Louis, MO 63130\nUSA (e-mail: dasanayakei@seas.wustl.edu).\nJ. Ruths is with the Engineering Systems & Design Pillar, Singapore University of Technology & Design, Singapore (e-mail:\njustinruths@sutd.edu.sg).\nJanuary 5, 2012\n\nDRAFT\n\n\f2\n\nstructure, such as synchrony, for normal operation. The synchronization of oscillating systems\nis an important and extensively studied phenomenon in science and engineering [1]. Examples\ninclude neural circuitry in the brain [2], sleep cycles and metabolic chemical reaction systems in\nbiology [3], [4], [5], [6], semiconductor lasers in physics [7], and vibrating systems in mechanical\nengineering [8]. Such systems, moreover, are often tremendously large in scale, which poses\nserious theoretical and computational challenges to model, guide, control, or optimize them.\nDeveloping optimal external waveforms or forcing signals that steer complex systems to desired\ndynamical conditions is of fundamental and practical importance [9], [10]. For example, in neuroscience devising minimum-power external stimuli that synchronize or desynchronize a network\nof coupled or uncoupled neurons is imperative for wide-ranging applications from neurological\ntreatment of Parkinson's disease and epilepsy [11], [12], [13] to design of neurocomputers [14],\n[15]; in biology and chemistry application of optimal waveforms for the entrainment of weakly\nforced oscillators that maximize the locking range or alternatively minimize power for a given\nfrequency entrainment range [9], [16] is paramount to the time-scale adjustment of the circadian\nsystem to light [17] and of the cardiac system to a pacemaker [18].\nMathematical tools are required for describing the complex dynamics of oscillating systems\nin a manner that is both tractable and flexible in design. A promising approach to constructing\nsimplified yet accurate models that capture essential overall system properties is through the\nuse of phase model reduction, in which an oscillating system with a stable periodic orbit\nis modeled by an equation in a single variable that represents the phase of oscillation [17],\n[19]. Phase models have been very effectively used in theoretical, numerical, and more recently\nexperimental studies to analyze the collective behavior of networks of oscillators [20], [21],\n[22], [23]. Various phase model-based control theoretic techniques have been proposed to design\nexternal inputs that drive oscillators to behave in a desired way or to form certain synchronization\npatterns. These include multi-linear feedback control methods for controlling individual phase\nrelations between coupled oscillators [24] and phase model-based feedback approaches for\nefficient control of synchronization patterns in oscillator assemblies [10], [25], [26]. These\nsynchronization engineering methods, though effective, do not explicitly address optimality in\nthe control design process. More recently, minimum-power periodic controls that entrain an\noscillator with an arbitrary phase response curve (PRC) to a desired forcing frequency have\nbeen derived using techniques from calculus of variations [16]. In this work, furthermore, an\nJanuary 5, 2012\n\nDRAFT\n\n\f3\n\nefficient computational procedure was developed for optimal control synthesis employing Fourier\nseries and Chebyshev polynomials. Minimum-power stimuli with limited amplitude that elicit\nspikes of a single neuron oscillator at specified times have also been analytically calculated\nusing Pontryagin's maximum principle, where possible neuron spiking range with respect to the\nbound of the control amplitude has been completely characterized [27], [28]. In addition, chargebalanced minimum-power controls for spiking a single neuron has been thoroughly studied [29],\n[30].\nIn this paper, we generalize our previous work on optimal control of a single neuron [27], [28],\n[29] to consider the control and synchronization of a collection of neuron oscillators. In particular,\nwe investigate the fundamental properties and develop optimal controls for the synchronization\nof such type of large-scale neuron systems. In Section II, we briefly introduce the phase model\nfor oscillating systems and investigate controllability of an ensemble of uncoupled neurons for\nvarious phase models characterized by different baseline dynamics and phase response functions.\nThen, in Section III, we formulate optimal control of spiking neurons as steering problems and in\nparticular derive minimum-power and time-optimal controls for single- and two-neuron systems.\nFurthermore, we implement a multidimensional pseudospectral method to find optimal controls\nfor spiking an ensemble of neurons which reinforce and augment our analytic results.\nII. C ONTROL\n\nOF\n\nN EURON O SCILLATORS\n\nA. Phase Models\nThe dynamics of an oscillator are often described by a set of ordinary differential equations\nthat has a stable periodic orbit. Consider a time-invariant system\n\u1e8b = F (x, u),\n\nx(0) = x0 ,\n\n(1)\n\nwhere x(t) \u2208 Rn is the state and u(t) \u2208 R is the control, which has an unforced stable attractive\nperiodic orbit \u03b3(t) = \u03b3(t + T ) homeomorphic to a circle, satisfying \u03b3\u0307 = F (\u03b3, 0), on the periodic\norbit \u0393 = {y \u2208 Rn | y = \u03b3(t), for 0 \u2264 t < T } \u2282 Rn . This system of equations can be reduced\nto a single first order differential equation, which remains valid while the state of the full system\nstays in a neighborhood of its unforced periodic orbit [31]. This reduction allows us to represent\nthe dynamics of a weakly forced oscillator by a single phase variable that defines the evolution\n\nJanuary 5, 2012\n\nDRAFT\n\n\f4\n\nof the oscillation,\nd\u03b8\n= f (\u03b8) + Z(\u03b8)u(t),\ndt\n\n(2)\n\nwhere \u03b8 is the phase variable, f and Z are real-valued functions, and u \u2208 U \u2282 R is the external\nstimulus (control) [31], [32]. The function f represents the system's baseline dynamics and Z\nis known as the phase response curve (PRC), which describes the infinitesimal sensitivity of\nthe phase to an external control input. One complete oscillation of the system corresponds to\n\u03b8 \u2208 [0, 2\u03c0). In the case of neural oscillators, u represents an external current stimulus and f is\nreferred to as the instantaneous oscillation frequency in the absence of any external input, i.e.,\nu = 0. As a convention, a neuron is said to spike or fire at time T following a spike at time 0 if\n\u03b8(t) evolves from \u03b8(0) = 0 to \u03b8(T ) = 2\u03c0, i.e., spikes occur at \u03b8 = 2n\u03c0, where n = 0, 1, 2, . . ..\nIn the absence of any input u(t) the neuron spikes periodically at its natural frequency, while by\nan appropriate choice of u(t) the spiking time can be advanced or delayed in a desired manner.\nIn this article, we study various phase models characterized by different f and Z functions. In\nparticular, we investigate the neural inputs that elicit desired spikes for an ensemble of isolated\nneurons with different natural dynamics, e.g., different oscillation frequencies. Fundamental\nquestions on the controllability of these neuron systems and the design of optimal inputs that\nspike them arise naturally and will be discussed.\nB. Controllability of Neuron Ensembles\nIn this section, we analyze controllability properties of finite collections of neuron oscillators.\nWe first consider the Theta neuron model (Type I neurons) which describes both superthreshold\nand subthreshold dynamics near a SNIPER (saddle-node bifurcation of a fixed point on a periodic\norbit) bifurcation [33], [34].\n1) Theta Neuron Model: The Theta neuron model is characterized by the neuron baseline\ndynamics, f (\u03b8) = (1 + I) + (1 \u2212 I) cos \u03b8, and the PRC, Z(\u03b8) = 1 \u2212 cos \u03b8, namely,\n\u0003\nd\u03b8 \u0002\n= (1 + I) + (1 \u2212 I) cos \u03b8 + (1 \u2212 cos \u03b8)u(t),\ndt\n\n(3)\n\nwhere I is the neuron baseline current. If I > 0, then f (\u03b8) > 0 for all t \u2265 0. Therefore, in the\nabsence of the input the neuron fires periodically since the free evolution of this neuron system,\n\nJanuary 5, 2012\n\nDRAFT\n\n\f5\n\n2\u03c0\n\n\u03b8\n\n3\u03c0/2\n\n\u03c0\n\n\u03c0/2\n\n0\n\nFig. 1.\n\n0\n\n0.05\n\n0.1\n\n0.15\nt\n\n0.2\n\n0.25\n\n0.3142\n\nThe Free Evolution of a Theta Neuron. The baseline current I = 100, and hence it spikes periodically with angular\n\nfrequency \u03c9 = 20 and period T0 = \u03c0/10.\n\ni.e., \u03b8\u0307 = f (\u03b8), has a periodic orbit\n\u03b8(t) = 2 tan\u22121\n\n!\n\u221a\ntan[ I(t + c)]\n\u221a\n,\nI\n\nfor I > 0,\n\n(4)\n\n\u221a\n\u221a\nwith the period T0 = \u03c0/ I and hence the frequency \u03c9 = 2 I, where c is a constant depending\non the initial condition. For example, if \u03b8(0) = 0, then c = 0. Fig. 1 shows the free evolution\nof a Theta neuron with I = 100. This neuron spikes periodically at T0 = \u03c0/10 with angular\nfrequency \u03c9 = 2\u03c0/T = 20. When I < 0, then the model is excitable, namely, spikes can occur\nwith an appropriate input u(t). However, no spikes occur without any input u(t) as\n\u221a\n\u0012\n\u0013\n\u2212I(t + c)]\ntanh[\n\u22121\n\u221a\n\u03b8(t) = 2 tan\n, for I < 0,\n\u2212I\nand there are two fixed points (one of which is stable) for u(t) \u2261 0.\n\nNow we consider spiking a finite collection of neurons with distinct natural oscillation frequencies and with positive baseline currents. This gives rise to a steering problem of the finitedimensional single-input nonlinear control system, \u0398\u0307 = f (\u0398) + Z(\u0398)u(t), where \u0398 \u2208 \u03a9 \u2282 Rn ,\nf, Z : \u03a9 \u2192 Rn , and u \u2208 U \u2282 R. In the vector form, this system appears as\n\uf8ee\n\uf8f9 \uf8ee\n\uf8f9 \uf8ee\n\uf8f9\n\u03b8\u03071\n\u03b11 + \u03b21 cos \u03b81\n1 \u2212 cos \u03b81\n\uf8ef\n\uf8fa \uf8ef\n\uf8fa \uf8ef\n\uf8fa\n\uf8ef \u03b8\u0307 \uf8fa \uf8ef \u03b1 + \u03b2 cos \u03b8 \uf8fa \uf8ef 1 \u2212 cos \u03b8 \uf8fa\n2\n2 \uf8fa\n2 \uf8fa\n\uf8ef 2 \uf8fa \uf8ef 2\n\uf8ef\n\uf8ef . \uf8fa=\uf8ef\n\uf8fa+\uf8ef\n\uf8fa u(t),\n..\n..\n\uf8ef .. \uf8fa \uf8ef\n\uf8fa \uf8ef\n\uf8fa\n.\n.\n\uf8f0\n\uf8fb \uf8f0\n\uf8fb \uf8f0\n\uf8fb\n\u03b8\u0307n\n\u03b1n + \u03b2n cos \u03b8n\n1 \u2212 cos \u03b8n\nJanuary 5, 2012\n\n(5)\n\nDRAFT\n\n\f6\n\nin which \u03b1i = 1+Ii = 1+\u03c9i2 /4, \u03b2i = 1\u2212Ii = 1\u2212\u03c9i2 /4, and Ii > 0 for all i \u2208 N = {1, 2, . . . , n}.\nNote that \u03b1i + \u03b2i = 2 for all i \u2208 N . The ultimate proof of our understanding of neural systems\nis reflected in our ability to control them, hence a complete investigation of the controllability\nof oscillator populations is of fundamental importance. We now analyze controllability for the\nsystem as in (5), which determines whether spiking or synchronization of an oscillator ensemble\nby the use of an external stimulus is possible.\nBecause the free evolution of each neuron system \u03b8i , i \u2208 N , in (5) is periodic as shown in (4),\nthe drift term f causes no difficulty in analyzing controllability. The following theorem provides\nessential machinery for controllability analysis.\nTheorem 1: Consider the nonlinear control system\n\u1e8b(t) = f (x(t)) + u(t) g(x(t)),\n\nx(0) = x0 .\n\n(6)\n\nSuppose that f and g are vector fields on a manifold M. Suppose that {f, g} meet either of the\nconditions of Chow's theorem, and suppose that for each initial condition x0 the solution of\n\u1e8b(t) = f (x(t))\nis periodic with a least period T (x0 ) < P \u2208 R+ . Then the reachable set from x0 for (6) is\n{exp{f, g}LA }G x0 , where {f, g}LA denotes the Lie algebra generated by the vector fields f and\ng, and {exp{f, g}LA }G is the smallest subgroup of the diffeomorphism group, diff(M), which\ncontains exp t\u03b7 for all \u03b7 \u2208 {f, g}LA [35].\n\u0003\n\nProof. See Appendix A.\n\nThe underlying idea of this theorem for dealing with the drift is the utilization of periodic\nmotions along the drift vector field, f (x), to produce negative drift by forward evolutions for\nlong enough time. More details about Theorem 1 can be found in Appendix A. Having this\nresult, we are now able to investigate controllability of a neuron oscillator assembly.\nTheorem 2: Consider the finite-dimensional single-input nonlinear control system\n\u0398\u0307 = f (\u0398) + Z(\u0398)u(t),\n\nJanuary 5, 2012\n\n(7)\n\nDRAFT\n\n\f7\n\nwhere \u0398 = (\u03b81 , \u03b82 , . . . , \u03b8n )\u2032 \u2208 \u03a9 \u2282 Rn and the vector fields f, Z : \u03a9 \u2192 Rn are defined by\n\uf8ee\n\uf8ee\n\uf8f9\n\uf8f9\n\u03b11 + \u03b21 cos \u03b81\n1 \u2212 cos \u03b81\n\uf8ef\n\uf8ef\n\uf8fa\n\uf8fa\n\uf8ef \u03b1 + \u03b2 cos \u03b8 \uf8fa\n\uf8ef 1 \u2212 cos \u03b8 \uf8fa\n2\n2 \uf8fa\n2 \uf8fa\n\uf8ef 2\n\uf8ef\nf (\u0398) = \uf8ef\n\uf8fa , Z(\u0398) = \uf8ef\n\uf8fa,\n..\n..\n\uf8ef\n\uf8ef\n\uf8fa\n\uf8fa\n.\n.\n\uf8f0\n\uf8f0\n\uf8fb\n\uf8fb\n\u03b1n + \u03b2n cos \u03b8n\n1 \u2212 cos \u03b8n\n\nin which \u03b1i = 1 + Ii , \u03b2i = 1 \u2212 Ii , and Ii > 0 for all i \u2208 N = {1, 2, . . . , n}. The system as in\n(7) is controllable.\nProof. It is sufficient to consider the case where Ii 6= Ij for i 6= j and i, j \u2208 N , since otherwise\nthey present the same neuron system. Because Ii > 0 for all i \u2208 N , the free evolution, i.e.,\nu(t) = 0, of each \u03b8i is periodic for every initial condition \u03b8i (0) \u2208 R, as shown in (4), with the\n\u221a\n\u221a\nangular frequency \u03c9i = 2 Ii and the period Ti = \u03c0/ Ii . Therefore, the free evolution of \u0398 is\n\nperiodic with a least period or is recurrent (see Remark 1). We may then apply Theorem 1 in\ncomputing the reachable set of this system. Let\nadg h(\u0398) = [g, h](\u0398)\ndenote the Lie bracket of the vector fields g and h, both defined on an open subset \u03a9 of Rn .\nThen, the recursive operation is denoted as\nadkg h(\u0398) = [g, adgk\u22121h](\u0398)\nfor any k \u2265 1, setting ad0g h(\u0398) = h(\u0398). The Lie brackets of f and Z include\n\uf8f9\n\uf8ee\n(\u22121)k\u22121 2k (\u03b11 \u2212 \u03b21 )k\u22121 sin \u03b81\n\uf8fa\n\uf8ef\n\uf8ef (\u22121)k\u22121 2k (\u03b1 \u2212 \u03b2 )k\u22121 sin \u03b8 \uf8fa\n2\n2\n2\n\uf8fa\n\uf8ef\nadf2k\u22121 Z = \uf8ef\n\uf8fa,\n.\n\uf8fa\n\uf8ef\n..\n\uf8fb\n\uf8f0\nk\u22121 k\nk\u22121\n(\u22121) 2 (\u03b1n \u2212 \u03b2n )\nsin \u03b8n\n\uf8ee\n\uf8f9\n(\u22121)k\u22121 2k (\u03b11 \u2212 \u03b21 )k\u22121 (\u03b11 cos \u03b81 + \u03b21 )\n\uf8ef\n\uf8fa\n\uf8ef (\u22121)k\u22121 2k (\u03b1 \u2212 \u03b2 )k\u22121 (\u03b1 cos \u03b8 + \u03b2 ) \uf8fa\n2\n2\n2\n2\n2\n\uf8ef\n\uf8fa\nad2k\n\uf8fa,\nf Z = \uf8ef\n.\n\uf8ef\n..\n\uf8fa\n\uf8f0\n\uf8fb\nk\u22121 k\nk\u22121\n(\u22121) 2 (\u03b1n \u2212 \u03b2n ) (\u03b1n cos \u03b8n + \u03b2n )\n\n+\nn\nfor k \u2208 Z+ , positive integers. Thus, {f, adm\nf Z}, m \u2208 Z , spans R at all \u0398 \u2208 \u03a9 since \u03b1i \u2212 \u03b2i =\n\n\u03c9i2 /2 and \u03c9i are distinct for i \u2208 N . That is, every point in Rn can be reached from any initial\nJanuary 5, 2012\n\nDRAFT\n\n\f8\n+\ncondition \u0398(0) \u2208 \u03a9, hence the system (7) is controllable. Note that if \u0398 = 0, {ad2k\nf Z}, k \u2208 Z ,\n\nspans Rn .\n\n\u0003\n\nRemark 1: If there exist integers mi and nj such that the periods of neuron oscillators are\nrelated by mi Ti = nj Tj for all (i, j) pairs, i, j \u2208 N , then the free evolution of \u0398 is periodic\nwith a least period. If, however, such a rational number relation does not hold between any two\n\u221a\nperiods, e.g., T1 = 1 and T2 = 2, it is easy to see that the free evolution of \u0398 is almostperiodic [36] because the free evolution of each \u03b8i , i \u2208 N , is periodic. Hence, the recurrence\nof f in (7) together with the Lie algebra rank condition (LARC) described above guarantee the\ncontrollability.\nControllability properties for other commonly-used phase models used to describe the dynamics of neuron or other, e.g., chemical, oscillators can be shown in the same fashion.\n2) SNIPER PRC: The SNIPER phase model is characterized by f = \u03c9, the neuron's natural\noscillation frequency, and the SNIPER PRC, Z = z(1 \u2212 cos \u03b8), where z is a model-dependent\nconstant [33]. In the absence of any external input, the neuron spikes periodically with the period\nT = 2\u03c0/\u03c9. The SNIPER PRC is derived for neuron models near a SNIPER bifurcation which is\nfound for Type I neurons [34] like the Hindmarsh-Rose model [37]. Note that the SNIPER PRC\ncan be viewed as a special case of the Theta neuron PRC for the baseline current I > 0. This can\n\u221a\nbe seen through a bijective coordinate transformation \u03b8(\u03c6) = 2 tan\u22121 [ Ib tan(\u03c6/2 \u2212 \u03c0/2)] + \u03c0,\n\u03c6 \u2208 [0, 2\u03c0), applied to (3), which yields\n\nd\u03c6\ndt\n\n= \u03c9 + \u03c92 (1 \u2212 cos \u03c6)u(t), i.e., the SNIPER PRC with\n\nz = 2/\u03c9. The spiking property, namely, \u03b8(\u03c6 = 0) = 0 and \u03b8(\u03c6 = 2\u03c0) = 2\u03c0 is preserved under\nthe transformation and so is the controllability as analyzed in Section II-B1.\nMore specifically, consider a finite collection of SNIPER neurons with f (\u0398) = (\u03c91 , \u03c92 , . . . , \u03c9n )\u2032\nand Z(\u0398) = (z1 (1 \u2212 cos \u03b81 ), z2 (1 \u2212 cos \u03b82 ), . . . , zn (1 \u2212 cos \u03b8n ))\u2032 , where conventionally, zi = 2/\u03c9i\nfor i \u2208 N . Similar Lie bracket computations as in the proof of Theorem 2 result in, for\nk = 1, . . . , n,\n\u0001\u2032\nadf2k\u22121 Z = (\u22121)k\u22121 z1 \u03c912k\u22121 sin \u03b81 , . . . , (\u22121)k\u22121 zn \u03c9n2k\u22121 sin \u03b8n ,\n\u0001\u2032\nk\u22121\nad2k\nz1 \u03c912k cos \u03b81 , . . . , (\u22121)k\u22121 zn \u03c9n2k cos \u03b8n ,\nf Z = (\u22121)\n\nand thus span{f, Z}LA = Rn , since \u03c9i 6= \u03c9j for i 6= j. Therefore, the system of a network of\nSNIPER neurons is controllable.\n\nJanuary 5, 2012\n\nDRAFT\n\n\f9\n\n3) Sinusoidal PRC: In this case, we consider f (\u0398) = (\u03c91 , \u03c92 , . . . , \u03c9n )\u2032 and Z(\u0398) = (z1 sin \u03b81 ,\nz2 sin \u03b82 , . . . , zn sin \u03b8n )\u2032 , where \u03c9i > 0 and zi = 2/\u03c9i for i = 1, . . . , n. This type of PRC's with\nboth positive and negative regions can be obtained by periodic orbits near the super critical\nHopf bifurcation[31]. This type of bifurcation occurs for Type II neuron models like FitzhughNagumo model [38]. Controllability of a network of Sinusoidal neurons can be shown by the\nsame construction, from which\n\u0001\u2032\nadf2k\u22121 Z = (\u22121)k\u22121 z1 \u03c912k\u22121 cos \u03b81 , . . . , (\u22121)k\u22121 zn \u03c9n2k\u22121 cos \u03b8n ,\n\u0001\u2032\nk\n2k\nk\n2k\nad2k\nf Z = (\u22121) z1 \u03c91 sin \u03b81 , . . . , (\u22121) zn \u03c9n sin \u03b8n ,\n\nand then span{f, Z}LA = Rn for \u03c9i 6= \u03c9j , i 6= j. Therefore the system is controllable.\nIII. O PTIMAL C ONTROL\n\nOF\n\nS PIKING N EURONS\n\nThe controllability addressed above guarantees the existence of an input that drives an ensemble of oscillators between any desired phase configurations. Practical applications demand\nminimum-power or time-optimal controls that form certain synchronization patterns for a population of oscillators, which gives rise to an optimal steering problem,\n\nmin\ns.t.\n\nJ = \u03c6(T, \u0398(T )) +\n\nZ\n\nT\n0\n\nL(\u0398(t), u(t))dt\n\n\u0398\u0307(t) = f (\u0398) + Z(\u0398)u(t)\n\n(8)\n\n\u0398(0) = \u03980 , \u0398(T ) = \u0398d\n|u(t)| \u2264 M,\n\n\u2200 t \u2208 [0, T ],\n\nwhere \u0398 \u2208 Rn , u \u2208 R; \u03c6 : R \u00d7 Rn \u2192 R, denoting the terminal cost, L : Rn \u00d7 R \u2192 R, denoting\n\nthe running cost, and f, Z : Rn \u2192 Rn are Lipschitz continuous (over the respective domains)\nwith respect to their arguments. For spiking a neuronal population, for example, the goal is to\ndrive the system from the initial state, \u03980 = 0, to a final state \u0398d = (2m1 \u03c0, 2m2 \u03c0, . . . , 2mn \u03c0)\u2032 ,\nwhere mi \u2208 Z+ , i = 1, . . . , n. Steering problems of this kind have been well studied, for example,\nin the context of nonholonomic motion planning and sub-Riemannian geodesic problems [39],\n[40]. This class of optimal control problems in principle can be approached by the maximum\nprinciple, however, in most cases they are analytically intractable especially when the system is\nJanuary 5, 2012\n\nDRAFT\n\n\f10\n\nof high dimension, e.g., greater than three, and when the control is bounded, i.e., M < \u221e. In\nthe following, we present analytical optimal controls for single- and two-neuron systems and,\nfurthermore, develop a robust computational method for solving challenging optimal control\nproblems of steering a neuron ensemble. Our numerical method is based on pseudospectral\napproximations which can be easily extended to consider any topologies of neural networks, e.g.,\narbitrary frequency distributions and coupling strengths between neurons, with various types of\ncost functional.\nA. Minimum-Power Control of a Single Neuron Oscillator\nDesigning minimum-power stimuli to elicit spikes of neuron oscillators is of clinical importance, such as deep brain stimulation, used for a variety of neurological disorders including\nParkinson's disease, essential tremor, and Dystonia, and neurological implants of cardiac pacemakers, where mild stimulations and low energy consumption are required [12], [41]. Optimal\ncontrols for spiking a single neuron oscillator can be derived using the maximum principle. In\norder to illustrate the idea, we consider spiking a Theta neuron, described in (3), with minimum\nRT\npower. In this case, the cost functional is J = 0 u2 (t)dt, and the initial and target states are 0\nand 2\u03c0, respectively. We first examine the case when the control is unbounded.\n\nThe control Hamiltonian of this optimal control problem is defined by H = u2 +\u03bb(\u03b1+\u03b2 cos \u03b8+\nu \u2212 u cos \u03b8), where \u03bb is the Lagrange multiplier. The necessary conditions for optimality yield\n\n= \u03bb(\u03b2 \u2212 u) sin \u03b8, and u = \u2212 21 \u03bb(1 \u2212 cos \u03b8) by\n\u03bb\u0307 = \u2212 \u2202H\n\u2202\u03b8\n\n\u2202H\n\u2202u\n\n= 0. With these conditions, the\n\noptimal control problem is then transformed to a boundary value problem, which characterizes\nthe optimal trajectories of \u03b8(t) and \u03bb(t). We then can derive the optimal feedback law for spiking\na Theta neuron at the specified time T by solving the resulting boundary value problem,\np\n\u2212(\u03b1 + \u03b2 cos \u03b8) + (\u03b1 + \u03b2 cos \u03b8)2 \u2212 2\u03bb0 (1 \u2212 cos \u03b8)2\n\u2217\n,\nu (\u03b8) =\n1 \u2212 cos \u03b8\nwhere \u03bb0 = \u03bb(0), which can be obtained according to\nZ 2\u03c0\n1\np\nT =\nd\u03b8.\n(\u03b1 + \u03b2 cos \u03b8)2 \u2212 2\u03bb0 (1 \u2212 cos \u03b8)\n0\n\n(9)\n\n(10)\n\nMore details about the derivations can be found in Appendix B-1.\n\nNow consider the case when the control amplitude is limited, namely, |u(t)| \u2264 M, \u2200 t \u2208 [0, T ].\n\nIf the unbounded minimum-power control as in (9) satisfies |u\u2217 (\u03b8)| \u2264 M for all t \u2208 [0, T ], then\nJanuary 5, 2012\n\nDRAFT\n\n\f11\n1.2\n\n2\u03c0\n\n1\n\n\u03a4=4\n\n0.8\n\n3\u03c0/2\n\n\u03a4=8\n\n0.6\n\nPhase (\u03b8)\n\nControl (u(t))\n\n\u03a4=3\n\n\u03a4=3\n\n0.4\n\n\u03a4=4\n\u03a4=8\n\n\u03c0\n\n0.2\n\u03c0/2\n\n0\n\u22120.2\n\u22120.4\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n0.6\nTime (t/T)\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0\n0\n\n0.1\n\n0.2\n\n0.3\n\n(a)\nFig. 2.\n\n0.4\n\n0.5\n0.6\nTime (t/T)\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n(b)\n\n(a) Minimum-power controls, u\u2217M (t), for spiking a Theta neuron with \u03c9 = 1 at various spiking times that are smaller\n\n(T = 3, 4) and greater (T = 8) than the natural spiking time T0 = 2\u03c0 subject to M = 1. (b) The resulting optimal phase\ntrajectories following u\u2217M (t).\n\nthe amplitude constraint is inactive and obviously the optimal control is given by (9) and (10).\nHowever, if |u\u2217 (\u03b8)| > M for some \u03b8 \u2208 [0, 2\u03c0], then the optimal control u\u2217M is characterized by\n\nswitching between u\u2217 (\u03b8) and the bound M (see Appendix B-2),\n\uf8f1\n\uf8f4\n\u2217\n\uf8f4\n\uf8f4\n\uf8f2 \u2212M, u (\u03b8) < \u2212M\nu\u2217M (\u03b8) =\nu\u2217 (\u03b8), \u2212M \u2264 u\u2217 (\u03b8) \u2264 M\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 M,\nu(\u03b8)\u2217 > M,\n\n(11)\n\nwhere the parameter \u03bb0 for u\u2217 (\u03b8) in (9) is calculated according to the desired spiking time T by\nZ 2\u03c0\n1\nd\u03b8.\n(12)\nT =\n\u03b1 + \u03b2 cos \u03b8 + (1 \u2212 cos \u03b8)u\u2217M\n0\n\nThe detailed derivation of the control u\u2217M is given in Appendix B-2. Fig. 2 illustrates the\n\noptimal controls and the corresponding trajectories for spiking a Theta neuron with natural\noscillation frequency \u03c9 = 1, i.e., I = 0.25, \u03b1 = 1.25, and \u03b2 = 0.75, at various spiking times\nthat are smaller (T = 3, 4) and greater (T = 8) than the natural spiking time T0 = 2\u03c0 with the\ncontrol amplitude bound M = 1. Because the unconstrained minimum-power controls for the\ncases T = 4 < T0 and T = 8 > T0 , calculated according to (9), satisfy |u\u2217(\u03b8)| < M, there are\nno switchings in these two cases.\n\nJanuary 5, 2012\n\nDRAFT\n\n\f12\n\nB. Time-Optimal Control of Two Neuron Oscillators\nSpiking a neuron in minimum time, subject to a given control amplitude, can be solved in a\nstraightforward manner. Consider the phase model of a single neuron as in (2), it is easy to see\nthat for a given control bound M > 0, the minimum spiking time is achieved by the bang-bang\ncontrol\n\n\uf8f1\n\uf8f2 M,\nZ(\u03b8) \u2265 0\n\u2217\nut =\n\uf8f3 \u2212M, Z(\u03b8) < 0,\n\n(13)\n\nwhich keeps the phase velocity, \u03b8\u0307, at its maximum. The minimum spiking time with respect to\nM\nthe control bound M, denoted by Tmin\n, is then given by\nZ\nZ\n1\n1\nM\nd\u03b8 +\nd\u03b8,\nTmin =\nf (\u03b8) + Z(\u03b8)M\nf (\u03b8) \u2212 Z(\u03b8)M\n\n(14)\n\n\u03b8\u2208B\n\n\u03b8\u2208A\n\nwhere the sets A and B are defined as\nA = {\u03b8| Z(\u03b8) \u2265 0, 0 \u2264 \u03b8 \u2264 2\u03c0} ,\nB = {\u03b8| Z(\u03b8) < 0, 0 \u2264 \u03b8 \u2264 2\u03c0} .\nTime-optimal control of spiking two neurons is more involved, which can be formulated as in\nRT\n(8) with the cost functional J = 0 1dt and with\n\u0398\u0307(t) = f (\u0398) + Z(\u0398)u(t),\n\n(15)\n\nwhere\n\uf8ee\n\nf =\uf8f0\n\nf1\nf2\n\n\uf8f9\n\n\uf8ee\n\n\uf8fb=\uf8f0\n\n\u03b11 + \u03b21 cos \u03b81\n\u03b12 + \u03b22 cos \u03b82\n\n\uf8f9\n\n\uf8fb,\n\n\uf8ee\n\nZ=\uf8f0\n\nZ1\nZ2\n\n\uf8f9\n\n\uf8ee\n\n\uf8fb=\uf8f0\n\n1 \u2212 cos \u03b81\n1 \u2212 cos \u03b82\n\n\uf8f9\n\n\uf8fb.\n\n(16)\n\nOur objective is to drive the two-neuron system from the initial state \u03980 = (0, 0)\u2032 to the desired\nfinal state \u0398d = (2m1 \u03c0, 2m2 \u03c0)\u2032 with minimum time, where m1 , m2 \u2208 Z+ . The Hamiltonian for\nthis optimal control problem is given by\nH = \u03bb0 + h\u03bb, f + Zui,\n\n(17)\n\nwhere \u03bb0 \u2208 R and \u03bb \u2208 R2 are the multipliers that correspond to the Lagrangian and the system\n\ndynamics, respectively, and h , i denotes a scalar product in the Euclidean space E2 .\n\nProposition 1: The minimum-time control that spikes two Theta neurons simultaneously is\nbang-bang.\nJanuary 5, 2012\n\nDRAFT\n\n\f13\n\nProof. The Hamiltonian in (17) is minimized by the control,\n\uf8f1\n\uf8f2 M\nfor \u03c6(t) < 0,\nu(t) =\n\uf8f3 \u2212M for \u03c6(t) > 0,\n\n(18)\n\nwhere \u03c6 is the switching function defined by \u03c6 = h\u03bb, Zi. If there exists no non-zero time interval\nover which \u03c6 \u2261 0, then the optimal control is given by the bang-bang form as in (18), where\nthe control switchings are defined at \u03c6 = 0. We show by contradiction that maintaining \u03c6 = 0\nis not possible for any non-zero time interval. Suppose that \u03c6(t) = 0 for some non-zero time\ninterval, t \u2208 [\u03c41 , \u03c42 ], then we have\n\u03c6 =h\u03bb, Zi = 0,\n\n(19)\n\n\u03c6\u0307 =h\u03bb, [f, Z] i = 0,\n\n(20)\n\nwhere [f, Z] denotes the Lie bracket of the vector fields f and Z. According to (19) and (20),\n\u03bb is perpendicular to both vectors Z and [f, Z], where\n\uf8ee\n\uf8f9\n2 sin \u03b81\n\u2202f\n\u2202Z\n\uf8fb.\nf\u2212\nZ=\uf8f0\n[f, Z] =\n\u2202\u03b8\n\u2202\u03b8\n2 sin \u03b82\n\nSince \u03bb 6= 0 by the non-triviality condition of the maximum principle, Z and [f, Z] are linearly\ndependent on t \u2208 [\u03c41 , \u03c42 ]. One can easily show that these two vectors are linearly dependent\neither when \u03b81 = 2n\u03c0 and \u03b82 \u2208 R, \u03b81 \u2208 R and \u03b82 = 2n\u03c0, or \u03b81 = \u03b82 + 2n\u03c0 and \u03b82 \u2208 R, where\nn \u2208 Z. These three families of lines represent the possible paths in the state-space where \u03c6 can\nbe vanished for some non-trivial time-interval. Now we show that these are not feasible phase\ntrajectories that can be generated by a control. Suppose that (\u03b81 (\u03c4 ), \u03b82 (\u03c4 )) = (2n\u03c0, \u03b1) for some\n\u03c4 > 0 and for some n \u2208 Z, where \u03b1 \u2208 R. We then have \u03b8 \u03071 (\u03c4 ) = 2 6= 0, irrespective of any\ncontrol input. Hence, the system is immediately deviated from the line \u03b81 = 2n\u03c0. The same\nreasoning can be used for showing the case of \u03b82 = 2n\u03c0.\nSimilarly, if (\u03b81 (\u03c4 ), \u03b82 (\u03c4 )) = (\u03b1 + 2n\u03c0, \u03b1) for some \u03c4 > 0 and for some n \u2208 Z, in order for\nthe system to remain on the line (\u03b81 (t), \u03b82 (t)) = (\u03b82 + 2n\u03c0, \u03b82 ), it requires that \u03b8 \u03071 (t) = \u03b8 \u03072 (t) for\nt > \u03c4 . However, this occurs only when \u03b81 = 2m\u03c0 and \u03b82 = 2(n + m)\u03c0, where m \u2208 Z, since\n\u03b8 \u03071 \u2212 \u03b8 \u03072 = (I1 \u2212I2 )(1\u2212cos \u03b81 ). Furthermore, staying on these points is impossible with any control\n\ninputs since for \u03b81 (\u03c4 ) = 2m\u03c0 and \u03b82 (\u03c4 ) = 2(n+m)\u03c0, the phase velocities are \u03b8 \u03071 (\u03c4 ) = \u03b8 \u03072 (\u03c4 ) = 2,\nwhich immediately forces the system to be away from these points. Therefore, the system cannot\nJanuary 5, 2012\n\nDRAFT\n\n\f14\n\nbe driven along the path (\u03b82 + 2n\u03c0, \u03b82 ). This analysis concludes that \u03c6 = 0 and \u03c6\u0307 = 0 do not\nhold simultaneously over a non-trivial time interval.\n\n\u0003\n\nNow, we construct the bang-bang structure for time-optimal control of this two-neuron system\nand, without loss of generality, let \u03bb0 = 1.\nDefinition 1: We denote the vector fields corresponding to the constant bang controls u(t) \u2261\n\u2212M and u(t) \u2261 M by X = f \u2212 MZ and Y = f + MZ, respectively, and call the respective\ntrajectories corresponding to them as X- and Y - trajectories. A concatenation of an X-trajectory\nfollowed by a Y -trajectory is denoted by XY , while the concatenation in the reverse order is\ndenoted by Y X.\nDue to the bang-bang nature of the time-optimal control for this system, it is sufficient for\nus to calculate the time between consecutive switches, and then the first switching time can be\ndetermined by the end point constraint. The inter-switching time can be calculated following the\nprocedure described in [42], [43], [44].\nLet p and q be consecutive switching points, and let pq be a Y -trajectory. Without loss of\ngenerality, we assume that this trajectory passes through p at time 0 and is at q at time \u03c4 . Since p\nand q are switching points, the corresponding multipliers vanish against the control vector field\nZ at those points, i.e.,\nh\u03bb(0), Z(p)i = h\u03bb(\u03c4 ), Z(q)i = 0.\n\n(21)\n\nAssuming that the coordinate of p = (\u03b81 , \u03b82 )\u2032 , our goal is to calculate the switching time, \u03c4 , in\nterms of \u03b81 and \u03b82 . In order to achieve this, we need to compute what the relation h\u03bb(\u03c4 ), Z(q)i =\n0 implies at time 0. This can be obtained by moving the vector Z(q) along the Y -trajectory\nbackward from q to p through the pushforward of the solution \u03c9(t) of the variational equation\nalong the Y -trajectory with the terminal condition \u03c9(\u03c4 ) = Z(q) at time \u03c4 . We denote by etY (p)\nthe value of the Y -trajectory at time t that starts at the point p at time 0 and by (e\u2212tY )\u2217 the\nbackward evolution under the variational equation. Then we have\n\u03c9(0) = (e\u2212\u03c4 Y )\u2217 \u03c9(\u03c4 ) = (e\u2212\u03c4 Y )\u2217 Z(q) = (e\u2212\u03c4 Y )\u2217 Z(e\u03c4 Y (p)) = (e\u2212\u03c4 Y )\u2217 Z e\u03c4 Y (p).\nSince the \"adjoint equation\" of the maximum principle is precisely the adjoint equation to\nthe variational equation, it follows that the function t 7\u2192 h\u03bb(t), \u03c9(t)i is constant along the Y trajectory. Therefore, h\u03bb(\u03c4 ), Z(q)i = 0 also implies that\nh\u03bb(0), \u03c9(0)i = h\u03bb(0), (e\u2212\u03c4 Y )\u2217 Z e\u03c4 Y (p)i = 0.\nJanuary 5, 2012\n\n(22)\nDRAFT\n\n\f15\n\nSince \u03bb(0) 6= 0, we know from (21) and (22) that the two vectors Z(p) and (e\u2212\u03c4 Y )\u2217 Z e\u03c4 Y (p)\nare linearly dependent. It follows that\n\u03b3Z(p) = (e\u2212\u03c4 Y )\u2217 Z e\u03c4 Y (p),\n\n(23)\n\nwhere \u03b3 is a constant. We make use of a well-known Campbell-Baker-Hausdorff formula [45]\nto expand (e\u2212\u03c4 Y )\u2217 Z e\u03c4 Y (p), that is,\n(e\u2212\u03c4 Y )\u2217 Z e\u03c4 Y (p) = e\u03c4 adY (Z) =\nA straightforward computation of Lie brackets gives\n\n\u221e\nX\n\u03c4n\nn=0\n\nn!\n\nadnY Z.\n\n\uf8ee\n\nsin \u03b81\n\nadY Z = [Y, Z] = [f + MZ, Z] = [f, Z] = 2 \uf8f0\n\nsin \u03b82\n\nad2Y Z = [Y, [Y, Z]] = 2(f \u2212 AZ),\n\n\uf8f9\n\n\uf8fb,\n\nwhere A = diag {2(\u03b11 \u2212 2 + M), 2(\u03b12 \u2212 2 + M)}, and furthermore\nadY2n+1 Z = (\u22121)n 2n (A + MI)n [f, Z],\nadY2n+2 Z = (\u22121)n 2n+1 (A + MI)n (f \u2212 AZ).\nConsequently, we have\ne\u03c4 adY Z =Z+\n\nP\u221e \u03c4 2n+2\n\u03c4 2n+1\nn n\nn\nn n+1 (A+M I)n (f \u2212AZ),\nn=0 (2n+1)! (\u22121) 2 (A+M I) [f,Z]+ n=0 (2n+2)! (\u22121) 2\n\nP\u221e\n\nwhich is further simplified to\n\uf8ee\n\n\uf8ef\n\uf8ef\ne\u03c4 adY Z =\uf8ef\n\uf8f0\n\n\u03b11 +M \u2212(M \u2212\u03b21 ) cos \u03b81\nM \u2212\u03b21 \u2212(\u03b11 +M ) cos \u03b81\n+\n2(\u03b11 \u22121+M )\n2(\u03b11 \u22121+M )\n\ncos(2\u03c4\n\n\u221a\n\nM \u2212\u03b22 \u2212(\u03b12 +M ) cos \u03b82\n\u03b12 +M \u2212(M \u2212\u03b22 ) cos \u03b82\n+\n2(\u03b12 \u22121+M )\n2(\u03b12 \u22121+M )\n\ncos(2\u03c4\n\n\u221a\n\nsin \u03b81\n\u03b11 \u22121+M\n\n\u03b11 \u22121+M )+ \u221a\n\nsin \u03b82\n\u03b12 \u22121+M\n\n\u03b12 \u22121+M )+ \u221a\n\n\u221a\n\n\uf8f9\n\n\u03b11 \u22121+M ) \uf8fa\n\uf8fa\n\uf8fa.\n\uf8fb\n\u221a\nsin(2\u03c4 \u03b12 \u22121+M )\nsin(2\u03c4\n\nThis together with (23) yields\n\u0014\n\u221a\nM \u2212\u03b21 \u2212(\u03b11 +M ) cos \u03b81\n\u03b1 +M \u2212(M \u2212\u03b21 ) cos \u03b81\n+\ncos(2\u03c4 \u03b11 \u22121+M )+ \u221a\n(1\u2212cos \u03b82 ) 1 2(\u03b1 \u22121+M\n)\n2(\u03b1 \u22121+M )\n1\n\n1\n\nsin \u03b81\n\u03b11 \u22121+M\n\n\u0014\n\u221a\n\u03b1 +M \u2212(M \u2212\u03b22 ) cos \u03b82\nM \u2212\u03b22 \u2212(\u03b12 +M ) cos \u03b82\n=(1\u2212cos \u03b81 ) 2 2(\u03b1 \u22121+M\n+\ncos(2\u03c4 \u03b12 \u22121+M )+ \u221a\n)\n2(\u03b1 \u22121+M )\n2\n\n2\n\nsin(2\u03c4\n\nsin \u03b82\n\u03b12 \u22121+M\n\n\u221a\n\nsin(2\u03c4\n\n\u0015\n\u03b11 \u22121+M )\n\n\u221a\n\n\u0015\n\u03b12 \u22121+M ) .\n\n(24)\n\nThis equation characterizes the inter-switching along the Y -trajectory, that is, the next switching\ntime \u03c4 can be calculated given the system starting with (\u03b81 , \u03b82 ) evolving along the Y -trajectory.\nSimilarly, the inter-switching along the X-trajectory can be calculated by substituting M with\n\u2212M in (24).\nJanuary 5, 2012\n\nDRAFT\n\n\f16\n\nNote that the solution to (24) is not unique, and some of the solutions may not be optimal,\nwhich can be discarded in a systematic way. The idea is to identify those possible switching\npoints calculated from (24) with \u03c6 = 0 that also having the appropriate sign for \u03c6\u0307. We focus\non the case where f and Z are linearly independent, since the case for those being linearly\ndependent restricts the state space to be the curve\n(\u03b11 + \u03b21 cos \u03b81 )(1 \u2212 cos \u03b82 ) = (\u03b12 + \u03b22 cos \u03b82 )(1 \u2212 cos \u03b81 ).\nIf f and Z are linearly independent, then [f, Z] can be written as [f, Z] = k1 f + k2 Z, where\n2 sin \u03b81 (1 \u2212 cos \u03b82 ) \u2212 2 sin \u03b82 (1 \u2212 cos \u03b81 )\n,\n(\u03b11 + \u03b21 cos \u03b81 )(1 \u2212 cos \u03b82 ) \u2212 (\u03b12 + \u03b22 cos \u03b82 )(1 \u2212 cos \u03b81 )\n2 sin \u03b81 (\u03b11 + \u03b21 cos \u03b81 ) \u2212 2 sin \u03b82 (\u03b12 + \u03b22 cos \u03b82 )\n.\nk2 =\n(\u03b11 + \u03b21 cos \u03b81 )(1 \u2212 cos \u03b82 ) \u2212 (\u03b12 + \u03b22 cos \u03b82 )(1 \u2212 cos \u03b81 )\nk1 =\n\nAs a result, we can write \u03c6\u0307 = h\u03bb, [f, Z]i = k1 h\u03bb, f i + k2h\u03bb, Zi. Since we know that at switching\npoints \u03c6 = h\u03bb, Zi = 0, the Hamiltonian, as in (17), H = 0 and the choice of \u03bb0 = 1 makes\nh\u03bb, f i = \u22121. Therefore, at these points, we have \u03c6\u0307 = \u2212k1 , and the type of switching can be\ndetermined according to the sign of the function k1 . If k1 > 0, then it is an X to Y switch since\n\u03c6\u0307 < 0 and hence \u03c6 changes its sign from positive to negative passing through the switching\npoint, which corresponds to switch the control from \u2212M to M as in (18). Similarly, if k1 < 0,\nthen it is a Y to X switch. Therefore the next switching time will be the minimum non-zero\nsolution to the equation (24) that satisfy the above given rule. For example, suppose that the\nsystem is following a Y -trajectory starting with a switching point pi = (\u03b81i , \u03b82i )\u2032 . The possible\ninter-switching times {\u03c4i,j }, j = 1, . . . , n, with \u03c4i,1 < \u03c4i,2 < . . . < \u03c4i,n can then be calculated\n\naccording to (24) based on pi . Thus, the next switching point is pr = (\u03b81r , \u03b82r )\u2032 = e\u03c4i,r Y (pi ),\n\u03c4i,r = min{\u03c4i,1 , . . . , \u03c4i,n }, such that k1 (\u03b81r , \u03b82r ) < 0, which corresponds to an Y to X switch.\nNow in order to synthesize a time-optimal control, it remains to compute the first switching\n\ntime and switching point, since the consequent switching sequence can be constructed thereafter\nbased on the procedure described above. Given an initial state \u03980 = (0, 0)\u2032, the first switching\ntime and point p1 will be determined according to the target state, e.g., \u0398d = (2m1 \u03c0, 2m2 \u03c0)\u2032 ,\nwhere m1 , m2 \u2208 Z+ , in such a way that the optimal trajectory follows a bang-bang control\nderived based on p1 will reach \u0398d . Under this construction, we may end up with a finite number\nof feasible trajectories starting with either X- or Y -trajectory, which reach the desired terminal\nstate. The minimum time trajectory is then selected among them.\nJanuary 5, 2012\n\nDRAFT\n\n\f17\n\n4\u03c0\n\nk <0\n1\n\n0.5\n\nk1>0\nY\n\u03b8 (I =0.9)\n\nt\n\nControl (u )\n\n0.25\nX\n\n2\u03c0\n\n2\n\n2\n\n0\n\n\u22120.25\n\nY\n\n\u22120.5\n0\n\n1.0\n\n1.87\n\n3.0\nTime (t)\n\n3.56 4.0\n\n5.0\n\n5.61\n\n(a)\nFig. 3.\n\n0\n\n\u03c0\n\u03b8 ( I =0.3)\n1\n\n2\u03c0\n\n1\n\n(b)\n\n(a) Time optimal control for two Theta neuron system with I1 = 0.3 (\u03b11 = 1.3, \u03b21 = 0.7) and I2 = 0.9 (\u03b12 =\n\n1.9, \u03b22 = 0.1) to reach (2\u03c0, 4\u03c0) with the control bounded by M = 0.5 and (b) corresponding trajectories. The gray and white\nregions represent where k1 is negative and positive, respectively.\n\nFig. 3 illustrates an example of driving two Theta neurons time-optimally from (0, 0)\u2032 to\n(2\u03c0, 4\u03c0)\u2032 with the control bound M = 0.5, where the natural frequencies of the oscillators are\n\u03c91 = 1.1 (I1 = 0.3) and \u03c92 = 1.9 (I2 = 0.9) corresponding to \u03b11 = 1.3, \u03b21 = 0.7 and \u03b12 = 1.9,\n\u03b22 = 0.1. In this example, the time-optimal control has two switches at t = 1.87 and t = 3.56\nand the minimum time is 5.61.\nC. Simultaneous Control of Neuron Ensembles\nThe complexity of deriving optimal controls for higher dimensional systems, i.e., more than\ntwo neurons, grows rapidly, and it makes sense to find out how the control of two neurons\nrelates to the control of many. One may wonder whether it is possible to use a (optimal) control\nthat spikes two neurons to manipulate an ensemble of neurons whose natural frequencies lie\nbetween those of the two nominal systems. Of course, if trajectories of the neurons with different\nfrequencies have no crossings following a common control input, then the control designed for\nany two neurons guarantees to bound trajectories of all the neurons with their frequencies within\nthe range of these two nominal neurons, whose trajectories can then be thought of as the envelope\nof these other neuron trajectories. We now show that this is indeed the case.\nLemma 1: The trajectories of any two Theta neurons with positive baseline currents following\na common control input have no crossing points.\n\nJanuary 5, 2012\n\nDRAFT\n\n\f18\n\nProof. Consider two Theta neurons modeled by\n\u03b8 \u03071 = (1 + I1 ) + (1 \u2212 I1 ) cos \u03b81 + (1 \u2212 cos \u03b81 )u,\n\n\u03b81 (0) = 0,\n\n(25)\n\n\u03b8 \u03072 = (1 + I2 ) + (1 \u2212 I2 ) cos \u03b82 + (1 \u2212 cos \u03b82 )u,\n\n\u03b82 (0) = 0,\n\n(26)\n\nwith positive baseline currents, I1 , I2 > 0, and assume that \u03c91 < \u03c92 , which implies I1 < I2\nsince Ii =\n\n\u03c9i2\n,\n4\n\ni = 1, 2. In the absence of any control input, namely, u = 0, it is obvious\n\nthat \u03b81 (t) < \u03b82 (t) for all t > 0 since I1 < I2 . Suppose that \u03b81 (t) < \u03b82 (t) for t \u2208 (0, \u03c4 ) and\nthese two phase trajectories meet at time \u03c4 , i.e., \u03b81 (\u03c4 ) = \u03b82 (\u03c4 ). Then, we have \u03b8 \u03071 (\u03c4 ) \u2212 \u03b8 \u03072 (\u03c4 ) =\n(I1 \u2212 I2 )(1 \u2212 cos(\u03b81 (\u03c4 ))) \u2264 0 and the equality holds only when the neurons spike at time \u03c4 ,\n\ni.e., \u03b81 (\u03c4 ) = \u03b82 (\u03c4 ) = 2n\u03c0, n \u2208 Z+ . As a result, \u03b81 (\u03c4 + ) < \u03b82 (\u03c4 + ), because \u03b81 (\u03c4 ) = \u03b82 (\u03c4 ) and\n\u03b8 \u03071 (\u03c4 ) < \u03b8 \u03072 (\u03c4 ), and hence there exist no crossings between the two trajectories \u03b81 (t) and \u03b82 (t).\n\u0003\nNote that the same result as Lemma 1 holds and can be shown in the same fashion for both\nSinusoidal and SNIPER phase models, as described in Section II-B2 and II-B3, when the modeldependent constant z1 > z2 if \u03c91 < \u03c92 , which is in general the case. For example, in the SNIPER\nphase model, z conventionally takes the form z = 2/\u03c9 as presented in Section II-B2.\nThis critical observation extremely simplifies the design of external stimuli for spiking a\nneuron ensemble with different oscillation frequencies based on the design for two neurons with\nthe extremal frequencies over this ensemble. We illustrate this important result by designing\noptimal controls for two Theta and two Sinusoidal neurons employing the Legendre pseudospectral method, which will be presented in Section IV. Fig. 4 shows the optimized controls and\ncorresponding trajectories for Theta and Sinusoidal neurons with their frequencies \u03c9 belonging\nto [0.9, 1.1] and [1.0, 1.1], respectively. The optimal controls are designed based only on the\nextremal frequencies of these two ranges, i.e., 0.9 and 1.1 for the Theta neuron model and 1.0\nand 1.1 for the Sinusoidal model.\nThis design principle greatly reduces the complexity of finding controls to spike a large\nnumber of neurons. Although the optimal control for two neurons is in general not optimal for\nthe others, this method produces a good approximate optimal control. In the next section, we will\nintroduce a multivariate pseudospectral computational method for constructing optimal spiking\nor synchronization controls.\n\nJanuary 5, 2012\n\nDRAFT\n\n\f19\n\nIV. C OMPUTATIONAL O PTIMAL C ONTROL\n\nOF\n\nS PIKING N EURON N ETWORKS\n\nAs we move to consider the synthesis of controls for neuron ensembles, the analytic methods\nused in the one and two neuron case become impractical to use. As a result, developing\ncomputational methods to derive inputs for ensembles of neurons is of particular practical interest.\nWe solve the optimal control problem in (8) using a modified pseudospectral method. Global\npolynomials provide accurate approximations in such a method which has shown to be effective\nin the optimal ensemble control of quantum mechanical systems [46], [47], [48], [49]. Below\nwe outline the main concepts of the pseudospectral method for optimal control problems and\nthen show how it can be extended to consider the ensemble case.\nSpectral methods involve the expansion of functions in terms of orthogonal polynomial basis\nfunctions on the domain [\u22121, 1] (similar to Fourier series expansion), facilitating high accuracy\nwith relatively few terms [50]. The pseudospectral method is a spectral collocation method\nin which the differential equation describing the state dynamics is enforced at specific nodes.\nDeveloped to solve partial differential equations, these methods have been recently adopted to\nsolve optimal control problems [51], [52], [53]. We focus on Legendre pseudospectral methods\nand consider the transformed optimal control problem on the time domain [\u22121, 1].\nThe fundamental idea of the Legendre pseudospectral method is to approximate the continuous\nstate and control functions, \u0398(t) and u(t), by N th order Lagrange interpolating polynomials,\nIN \u0398(t) and IN u(t), based on the Legendre-Gauss-Lobatto (LGL) quadrature nodes, which are\ndefined by the union of the endpoints, {\u22121, 1}, and the roots of the derivative of the N th order\nLegendre polynomial. Note that the non-uniformity in the distribution of the LGL nodes and the\nhigh density of nodes near the end points are a key characteristic of pseudospectral discretizations\nby which the Runge phenomenon is effectively suppressed [54]. The interpolating approximations\nof the state and control functions, \u0398(t) and u(t) can be expressed as functions of the Lagrange\npolynomials, lk (t), [55]\n\u0398(t) \u2248 IN \u0398(t) =\nu(t) \u2248 IN u(t) =\n\nJanuary 5, 2012\n\nN\nX\n\n\u0398\u0304k lk (t),\n\n(27)\n\nk=0\n\nN\nX\n\n\u016bk lk (t).\n\nk=0\n\nDRAFT\n\n\f20\n\nThe derivative of IN \u0398(t) at the LGL node tj , j = 0, 1, . . . , N, is given by\nN\n\nN\n\nX\nX\nd\n\u0398\u0304k l\u0307k (tj ) =\nDjk \u0398\u0304k ,\nIN \u0398(tj ) =\ndt\nk=0\nk=0\n\nwhere Djk are elements of the constant (N + 1) \u00d7 (N + 1) differentiation matrix [50]. Finally,\nthe integral cost functional in the optimal control problem (8) can be approximated by the\nGauss-Lobatto integration rule, and we ultimately convert the optimal control problem into the\nfollowing finite-dimensional constrained minimization problem\nN\nT X 2\nmin\n\u016b wj\n2 j=0 j\n\ns.t.\n\nN\nX\n\nDjk \u0398\u0304k =\n\nk=0\n\ni\nTh\nf (\u0398\u0304j ) + \u016bj Z(\u0398\u0304j ) ,\n2\n\n(28)\n\n\u0398\u0304(\u22121) = 0,\n\u0398\u0304(1) = \u0398d ,\n\n\u2200 j \u2208 {0, 1, . . . , N},\n\nwhere \u0398d = (2m1 \u03c0, 2m2 \u03c0, . . . , 2mn \u03c0)\u2032 , mi \u2208 Z+ , i = 1, . . . , n, is the target state and wj are\nthe LGL weights given by\nwj =\n\n1\n2\n,\nN(N + 1) (LN (tj ))2\n\nin which LN is the N th order Legendre polynomial. Solvers for this type of constrained nonlinear\nprograms are readily available and straightforward to implement.\nRemark 2 (Extension to an infinite ensemble of neuron systems): The pseudospectral computational method can be readily extended to consider an infinite population of neurons, for instance,\nwith the frequency distribution over a closed interval, \u03c9 \u2208 [\u03c9a , \u03c9b ] \u2282 R+ . In such a case, the\nparameterized state function can be approximated by a two-dimensional interpolating polynomial,\nnamely, \u0398(t, \u03c9) \u2248 IN \u00d7N\u03c9 \u0398(t, \u03c9), based on the LGL nodes in the time t and the frequency \u03c9\ndomain. Similarly, the dynamics of the state can be expressed as an algebraic constraint and a\ncorresponding minimization problem can be formed [47].\nA. Optimized Ensemble Controls\nWe can now apply the above methodology to synthesize optimal controls for neuron ensembles.\nSince neurons modeled by the SNIPER PRC are special cases of the Theta neuron, here we\nJanuary 5, 2012\n\nDRAFT\n\n\f21\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\nFig. 4. The controls (top) and state trajectories (bottom) of Theta (left) and Sinusoidal (right) PRC neuron models (for \u03b1 = 1,\n\u03b2 = 0.1, T = 2\u03c0 in (29)). The Theta model is optimized for \u03c9 \u2208 [0.9, 1.1]. The Sinusoidal model is optimized for \u03c9 \u2208 [1.0, 1.1].\nThe gray states correspond to uncontrolled state trajectories, and provide a comparison for the synchrony improvement provided\nby the compensating optimized ensemble control.\n\nconsider Theta and Sinusoidal neuron models. The computational method outlined above permits\na flexible framework to optimize based on a very general cost functional subject to general\nconstraints. We illustrate this by selecting an objective of the type,\nZ T\n2\nJ = \u03b1k\u0398d \u2212 \u0398(T )k + \u03b2\nu2 (t)dt,\n\n(29)\n\n0\n\nwhich minimizes the terminal error and input energy with a relative scaling given by the constants\n\u03b1 and \u03b2. In highly complex problems, such as those given by ensemble systems as described\nin Remark 2, this scaling provides a tunable parameter that determines the trade-off between\nperformance and input energy.\nFig. 4 shows the optimized controls and corresponding trajectories for Theta and Sinusoidal\nneuron models for \u03b1 = 1, \u03b2 = 0.1, T = 2\u03c0, and \u03c9 belongs to [0.9, 1.1] and [1.0, 1.1] respectively.\nIn this optimization, the controls are optimized over the two neuron systems with extremal\nfrequencies, whose trajectories form an envelope, bounding the trajectories of other frequencies\nin between, as described in Section III-C. We are able to design compensating controls for the\nJanuary 5, 2012\n\nDRAFT\n\n\f22\n\n\u03c0\n\u03c0\n\n\u03c9=\n\n\u03c0\n\n\u03c9=\n\n\u03c0\n\n\u03c9=\n\u03c9=\n\n\u03c0\n\u03c9=\n\u03c0\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\nFig. 5. The controls and amplitude constrained controls, A \u2264 2.5, upper left and right respectively, of a Sinusoidal PRC neuron\nmodel driving five frequencies, (\u03c91 , \u03c92 , \u03c93 , \u03c94 , \u03c95 ) = (1, 2, 3, 4, 5), to the desired targets \u0398(T ) = (2\u03c0, 4\u03c0, 6\u03c0, 8\u03c0, 10\u03c0) when\nT = 2\u03c0 \u2212 0.5. These controls yield highly similar state trajectories (left, shown for unconstrained control) and spiking sequences\n(right, shown for constrained control), which corresponds to when the state trajectories cross multiples of 2\u03c0. Black coloring\nindicates a controlled state trajectory or spike sequence, whereas gray coloring indicates a trajectory or spike sequence without\ncontrol.\n\nentire frequency band solely by considering these upper and lower bounding frequencies. The\ncontrolled (black) and uncontrolled (gray) state trajectories clearly show the improvement in\nsimultaneous spiking of the ensemble of neurons. While a bound is necessary to provide in\npractice, the inclusion of the minimum energy term in the cost function serves to regularize the\ncontrol against high amplitude values.\nIn Fig. 5, we demonstrate the flexibility of the method to drive multiple Sinusoidal neurons\nto desired targets. In particular we seek to simultaneously spike five frequencies with widely\ndispersed frequency values at a time T different from their natural period. In this figure we\nconsider the frequencies (\u03c91 , \u03c92 , \u03c93, \u03c94 , \u03c95 ) = (1, 2, 3, 4, 5) and design controls to drive these\nsystems to (2\u03c0, 4\u03c0, 6\u03c0, 8\u03c0, 10\u03c0), respectively, at a time T = 2\u03c0 \u2212 0.5. Controls for minimum\nenergy (\u03b1 = 0, \u03b2 = 1) transfer can be designed for both the unconstrained and amplitude\nconstrained cases (shown for A \u2264 2.5). In both cases, the state trajectories and spike sequence\n(shown in the lower half of the figure) follow the same general pattern. The spike train shows\nthat the controls are able to advance the firing of each neuron so that all five spike simultaneously\n\nJanuary 5, 2012\n\nDRAFT\n\n\f23\n\n\u03c0\n\u03c0\n\n\u03c9=\n\n\u03c0\n\n\u03c9=\n\u03c9=\n\n\u03c0\n\n\u03c9=\n\u03c0\n\u03c9=\n\u03c0\n\nFig. 6.\n\n\u03c0\n\n\u03c0\n\n\u03c0\n\nThe controls and amplitude constrained controls, A \u2264 2, upper left and right respectively, of a Theta PRC neuron\n\nmodel driving five frequencies, \u03c9 = (\u03c91 , \u03c92 , \u03c93 , \u03c94 , \u03c95 ) = (1, 2, 3, 4, 5), to the desired targets \u0398(T ) = (2\u03c0, 4\u03c0, 6\u03c0, 8\u03c0, 10\u03c0)\nwhen T = 2\u03c0 \u2212 0.5. These controls yield highly similar state trajectories (left, shown for unconstrained control) and spiking\nsequences (right, shown for constrained control), which corresponds to when the state trajectories cross multiples of 2\u03c0. Black\ncoloring indicates a controlled state trajectory or spike sequence, whereas gray coloring indicates a trajectory or spike sequence\nwithout control.\n\nat the desired terminal time. Again the gray coloring indicates uncontrolled trajectories or spike\ntrains and offers a comparison of improvement in synchrony.\nSimilarly, Fig. 6 provides the same presentation as above for the minimum energy transfer for\nTheta neurons of the same frequencies to the same desired targets. In this case the constrained\ncontrol is limited to A \u2264 2.\nV. C ONCLUSION\nIn this paper, we considered the control and synchronization of a neuron ensemble described\nby phase models. We showed that this ensemble system is controllable for various commonlyused phase models. We also derived minimum-power and time-optimal controls for single and\ntwo neuron systems. The development of such optimal controls is of practical importance, for\nexample, in therapeutic procedures such as deep brain stimulation for Parkinson's disease and\ncardiac pacemakers for heart disease. In addition, we adopted a computational pseudospectral\nmethod for constructing optimal controls that spike neuron ensembles, which demonstrated the\nunderlying controllability properties of such neuron systems. The methodology resulting from this\nJanuary 5, 2012\n\nDRAFT\n\n\f24\n\nwork can be applied not only to neuron oscillators but also to any oscillating systems that can be\nrepresented using similar model reduction techniques such as biological, chemical, electrical, and\nmechanical oscillators. A compelling extension of this work is to consider networks of coupled\noscillators, whose interactions are characterized by a coupling function, H, acting between each\npair of oscillators. For example, in the well-known Kuramoto's model, the coupling between the\n(i, j)-pair is characterized by the sinusoidal function of the form H(\u03b8i , \u03b8j ) = sin(\u03b8i \u2212 \u03b8j ) [19].\nThe procedure presented in Theorem 2 can be immediately applied to examine controllability\nof interacting oscillators by investigating the recurrence properties of the vector field f + H,\nand the Lie algebra {f + H, Z}LA . Similarly, the pseudospectral method presented in Section\nIV and its extension addressed in Remark 2 can be employed to calculate optimal controls for\nspiking or synchronizing networks of coupled neurons with their natural frequencies varying on\na continuum.\nA PPENDIX A\nC HOW ' S T HEOREM\nTheorem 3: (Versions of Chow's Theorem) Let {f1 (x), f2 (x), . . . , fm (x)} be a collection of\nvector fields such that the collection {f1 (x), f2 (x), . . . , fm (x)}LA is\na) analytic on an analytic manifold M. Then given any point x0 \u2208 M, there exists a maximal\nsubmanifold N \u2282 M containing x0 such that {exp{xi }}G x0 = {exp{xi }LA }G x0 = N.\n\nb) C \u221e on a C \u221e manifold M with dim (span{fi (x)}LA ) constant on M. Then given any\npoint x0 \u2208 M, there exists a maximal submanifold N \u2282 M containing x0 such that\n{exp{xi }}G x0 = {exp{xi }LA }G x0 = N.\nFor more details, please see [35].\nA PPENDIX B\nO PTIMAL C ONTROL\n\nJanuary 5, 2012\n\nOF A\n\nS INGLE T HETA N EURON\n\nDRAFT\n\n\f25\n\n1) Unbounded Minimum-Power Control of a Theta Neuron: The minimum-power control of\na single Theta neuron is formulated as\nZ T\nmin\nu2 (t)dt,\n0\n\ns.t.\n\n\u03b8\u0307 = \u03b1 + \u03b2 cos \u03b8 + (1 \u2212 cos \u03b8)u(t),\n\u03b8(0) = 0,\n\n\u03b8(T ) = 2\u03c0.\n\nWe then can form the control Hamiltonian,\nH = u2 + \u03bb(\u03b1 + \u03b2 cos \u03b8 + u \u2212 u cos \u03b8),\n\n(30)\n\nwhere \u03bb is the Lagrange multiplier. The necessary conditions for optimality from the maximum\nprinciple yield\n\u03bb\u0307 = \u2212\n\n\u2202H\n= \u03bb(\u03b2 \u2212 u) sin \u03b8,\n\u2202\u03b8\n\n(31)\n\n\u2202H\n= 2u + \u03bb(1 \u2212 cos \u03b8) = 0.\n\u2202u\nThus, the optimal control u satisfies\n1\nu = \u2212 \u03bb(1 \u2212 cos \u03b8).\n2\n\n(32)\n\nWith (32) and (31), this optimal control problem is transformed to a boundary value problem,\nwhose solution characterizes the optimal trajectories,\n\u03bb\n\u03b8\u0307 = \u03b1 + \u03b2 cos \u03b8 \u2212 (1 \u2212 cos \u03b8)2 ,\n2\n2\n\u03bb\n\u03bb\u0307 = \u03bb\u03b2 + (1 \u2212 cos \u03b8) sin \u03b8,\n2\n\n(33)\n(34)\n\nwith boundary conditions \u03b8(0) = 0 and \u03b8(T ) = 2\u03c0, while \u03bb0 = \u03bb(0) and \u03bb(T ) are unspecified.\nAdditionally, since the Hamiltonian is not explicitly dependent on time, the optimal triple\n(\u03bb, \u03b8, u) satisfies H(\u03bb, \u03b8, u) = c, \u2200 0 \u2264 t \u2264 T , where c is a constant. Together with (32) and\n(30), this yields\n\u03bb(\u03b1 + \u03b2 cos \u03b8) \u2212\n\n\u03bb2\n(1 \u2212 cos \u03b8)2 = c.\n4\n\n(35)\n\nSince \u03b8(0) = 0, c = 2\u03bb0 , where \u03bb0 is undetermined. The optimal multiplier can be found by\nsolving the above quadratic equation (35), which gives\np\n2(\u03b1 + \u03b2 cos \u03b8) \u00b1 2 (\u03b1 + \u03b2 cos \u03b8)2 \u2212 2\u03bb0 (1 \u2212 cos \u03b8)\n\u03bb=\n,\n(1 \u2212 cos \u03b8)2\nJanuary 5, 2012\n\n(36)\nDRAFT\n\n\f26\n\nand then, from (33), the optimal phase trajectory follows\np\n\u03b8\u0307 = \u2213 (\u03b1 + \u03b2 cos \u03b8)2 \u2212 2\u03bb0 (1 \u2212 cos \u03b8).\n\nIntegrating (37), we find the spiking time T in terms of the initial condition \u03bb0 ,\nZ 2\u03c0\n1\np\nd\u03b8.\nT =\n2\n(\u03b1 + \u03b2 cos \u03b8) \u2212 2\u03bb0 (1 \u2212 cos \u03b8)\n0\n\n(37)\n\n(38)\n\nNote that we choose the positive sign in (37), which corresponds to forward phase evolution.\nTherefore, given a desired spiking time T of the neuron, the initial value \u03bb0 can be found via\nthe one-to-one relation in (38). Consequently, the optimal trajectories of \u03b8 and \u03bb can be easily\ncomputed by evolving (33) and (34) forward in time. Plugging (36) into (32), we obtain the\noptimal feedback law for spiking a Theta neuron at time T ,\np\n\u2212(\u03b1 + \u03b2 cos \u03b8) + (\u03b1 + \u03b2 cos \u03b8)2 \u2212 2\u03bb0 (1 \u2212 cos \u03b8)2\n\u2217\nu(t) =\n.\n1 \u2212 cos \u03b8\n\n(39)\n\n2) Bounded Minimum-Power Control of a Theta Neuron: Given the bound M on the control\namplitude, if |u\u2217 (t)| \u2264 M for all t \u2208 [0, T ], then the amplitude constraint is inactive and obviously\n\nthe bounded minimum-power control is given by (39) and (38). If, however, |u\u2217 (t)| > M for\nsome time interval, e.g., t \u2208 [t1 , t2 ] \u2282 [0, T ], which alternatively corresponds to |u\u2217 (\u03b8)| > M\n\nfor \u03b8(t1 ) = \u03b81 , \u03b8(t2 ) = \u03b82 , and \u03b8 \u2208 [\u03b81 , \u03b82 ] \u2282 [0, 2\u03c0], the amplitude constraint is active and the\noptimal control will depend on M. We first consider u\u2217 (\u03b8) > M for \u03b8 \u2208 [\u03b81 , \u03b82 ] and observe in\n\nthis case that u(\u03b8) = M is the minimizer of the Hamiltonian H as in (30), since H is convex in\nu. The Hamiltonian for this interval is then given by H = M 2 + \u03bb(\u03b1 + \u03b2 cos \u03b8 + M \u2212 M cos \u03b8).\nBecause, by the maximum principle, H is a constant along the optimal trajectory, the Lagrange\nmultiplier \u03bb is given by,\n\u03bb=\n\nc \u2212 M2\n,\n\u03b1 + \u03b2 cos \u03b8 + M \u2212 M cos \u03b8\n\n(40)\n\nwhich satisfies the adjoint equation (31). Therefore, u(\u03b8) = M is optimal for \u03b8 \u2208 [\u03b81 , \u03b82 ]. The\nvalue of the constant c = 2\u03bb0 can be determined by applying the initial conditions, \u03b8(0) = 0\nand \u03bb(0) = \u03bb0 to (30). Similarly, we can show that u(t) = \u2212M is optimal when u\u2217 (\u03b8) < \u2212M\nfor some \u03b8 \u2208 [\u03b83 , \u03b84 ] \u2282 [0, 2\u03c0]. Consequently, the constrained optimal control can be synthesized\naccording to (11) and (12).\nNote that the number of time intervals that |u\u2217 (\u03b8)| > M defines the number of switches in the\n\noptimal control law. Specifically, if |u\u2217 (\u03b8)| > M for n time intervals, then the optimal control\nJanuary 5, 2012\n\nDRAFT\n\n\f27\n\nwill have 2n switches. Here we consider the simplest case, where the optimal control has only\ntwo switches, which is actually the only case for the Theta neuron model. As a result, suppose\nthat u\u2217 (\u03b8) > M for only one time interval, and then there are two switching angles \u03b81 and \u03b82 at\nwhich u\u2217 (\u03b81 ) = u\u2217 (\u03b82 ) = M. These two conditions, together with (12), determine the unknown\nparameters \u03b81 , \u03b82 , and \u03bb0 that characterize the bounded optimal control, u\u2217M , as given in (11)\nfor the specified spiking time T . Note that the range of feasible spiking times is determined by\nthe bound of the control amplitude M. A complete characterization of possible spiking range\ncan be found in [27].\nR EFERENCES\n[1] S. Strogatz, Nonlinear Dynamics And Chaos: With Applications To Physics, Biology, Chemistry, And Engineering, 1st ed.,\nser. Studies in nonlinearity.\n\nWestview Press, 2001.\n\n[2] P. Uhlhaas and W. Singer, \"Neural synchrony in brain disorders: Relevance for cognitive dysfunctions and pathophysiology,\"\nNeuron, vol. 52, no. 1, pp. 155\u2013168, 2006.\n[3] F. Hanson, \"Comparative studies of firefly pacemakers,\" Federation proceedings, vol. 38, no. 8, pp. 2158\u20132164, 1978.\n[4] R. Mirollo and S. Strogatz, \"Synchronization of pulse-coupled biological oscillators,\" SIAM Journal on Applied Mathematics, vol. 50, no. 6, pp. 1645\u20131662, 1990.\n[5] G. Ermentrout and J. Rinzel, \"Beyond a pacemaker's entrainment limit: phase walk-through,\" American Journal of\nPhysiology - Regulatory, Integrative and Comparative Physiology, vol. 246, no. 1, 1984.\n[6] T. Nishikawa, N. Gulbahce, and A. E. Motter, \"Spontaneous reaction silencing in metabolic optimization,\" PLoS\nComputational Biology, vol. 4, no. 12, p. e1000236, 2008.\n[7] I. Fischer, Y. Liu, and P. Davis, \"Synchronization of chaotic semiconductor laser dynamics on subnanosecond time scales\nand its potential for chaos communication,\" Physical Review A, vol. 62, 2000.\n[8] I. Blekhman, Synchronization in science and technology.\n\nNew York: ASME Press translations, 1988.\n\n[9] T. Harada, H. Tanaka, M. Hankins, and I. Kiss, \"Optimal waveform for the entrainment of a weakly forced oscillator,\"\nPhysical Review Letters, vol. 105, no. 8, 2010.\n[10] I. Z. Kiss, C. G. Rusin, H. Kori, and J. L. Hudson, \"Engineering complex dynamical structures: Sequential patterns and\ndesynchronization,\" Science, vol. 316, no. 5833, pp. 1886\u20131889, 2007.\n[11] P. Ashwin and J. Swift, \"The dynamics of n weakly coupled identical oscillators,\" Journal of Nonlinear Science, vol. 2,\nno. 6, pp. 69\u2013108, 1992.\n[12] A. L. Benabid and P. Pollak, \"Long-term suppression of tremor by chronic stimulation of the ventral intermediate thalamic\nnucleus,\" Lnacent, vol. 337, pp. 403\u2013406, 1991.\n[13] S. Schiff, \"Controlling chaos in the brain,\" Nature, vol. 370, pp. 615\u2013620, 1994.\n[14] F. C. Hoppensteadt and E. M. Izhikevich, \"Synchronization of mems resonators and mechanical neurocomputing,\" IEEE\nTransactions On Circuits And Systems I-Fundamental Theory And Applications, vol. 48, no. 2, pp. 133\u2013138, 2001.\n[15] --, \"Synchronization of laser oscillators, associative memory, and optical neurocomputing,\" Physical Review E, vol. 62,\nno. 3, pp. 4010\u20134013, 2000.\n\nJanuary 5, 2012\n\nDRAFT\n\n\f28\n\n[16] A. Zlotnik and J.-S. Li, \"Optimal asymptotic entrainment of phase-reduced oscillators,\" in ASME Dynamic Systems and\nControl Conference, Arlington, VA, October 2011.\n[17] A. T. Winfree, The Geometry of Biological Time. Springer-Verlag, New York, 1980.\n[18] L. Glass, \"Cardiac arrhythmias and circle maps-a classical problem,\" Chaos, vol. 1, no. 1, pp. 13\u201319, 1991.\n[19] Y. Kuramoto, Chemical Oscillations, Waves, and Turbulence.\n\nNew York: Springer, 1984.\n\n[20] J. A. Acebron, L. L. Bonilla, C. J. P. Vicente, F. Ritort, and R. Spigler, \"The kuramoto model: A simple paradigm for\nsynchronization phenomena,\" Reviews Of Modern Physics, vol. 77, no. 1, pp. 137\u2013185, 2005.\n[21] I. Z. Kiss, Y. M. Zhai, and J. L. Hudson, \"Predicting mutual entrainment of oscillators with experiment-based phase\nmodels,\" Physical Review Letters, vol. 94, no. 24, p. 248301, 2005.\n[22] A. J. Preyer and R. J. Butera, \"Neuronal oscillators in aplysia californica that demonstrate weak coupling in vitro,\" Physical\nReview Letters, vol. 95, no. 13, p. 4, 2005.\n[23] J. C. B. T. I. Netoff, C. D. Acker and J. A. White, \"Beyond two-cell networks: experimental measurement of neuronal\nresponses to multiple synaptic inputs,\" Journal Of Computational Neuroscience, vol. 18, no. 3, pp. 287\u2013295, 2005.\n[24] T. Kano and S. Kinoshita, \"Control of individual phase relationship between coupled oscillators using multilinear feedback,\"\nPhysical Review E, vol. 81, p. 026206, 2010.\n[25] C. G. Rusin, H. Kori, I. Z. Kiss, and J. L. Hudson, \"Synchronization engineering: tuning the phase relationship between\ndissimilar oscillators using nonlinear feedback.\" Philosophical Transactions of the Royal Society A-Mathematical Physical\nAnd Engineering Sciences, vol. 368, no. 1918, pp. 2189\u20132204, 2010.\n[26] Y. Zhai, I. Z. Kiss, and J. L. Hudson, \"Control of complex dynamics with time-delayed feedback in populations of chemical\noscillators: Desynchronization and clustering,\" Ind. & Eng. Chem. Res., vol. 47, no. 10, pp. 3502\u20133514, 2008.\n[27] I. Dasanayake and J.-S. Li, \"Optimal design of minimum-power stimuli for phase models of neuron oscillators,\" Physical\nReview E, vol. 83, p. 061916, 2011.\n[28] --, \"Constrained minimum-power control of spiking neuron oscillators,\" in 50th IEEE Conference on Decision and\nControl, Orlando, FL, December 2011.\n[29] --, \"Charge-balanced minimum-power controls for spiking neuron oscillators,\" IEEE Transactions on Automatic Control\n(under review).\n[30] A. Nabi and J. Moehlis, \"Charge-balanced optimal input for phase models of spiking neurons,\" in Proc. ASME Dynamic\nSystem and Control Conference, 2009, pp. 278\u2013292.\n[31] E. Brown, J. Moehlis, and P. Holmes, \"On the phase reduction and response dynamics of neural oscillator populations,\"\nNeural Computation, vol. 16, no. 4, pp. 673\u2013715, 2004.\n[32] E. Izhikevich, Dynamical Systems in Neuroscience, ser. Neuroscience.\n\nMIT Press, 2007.\n\n[33] J. Moehlis, E. Brown, and H. Rabitz, \"Optimal inputs for phase models of spiking neurons,\" Journal of Computational\nand Nonlinear Dynamics, vol. 1, pp. 358\u2013367, 2006.\n[34] B. Ermentrout, \"Type I membranes, phase resetting curves, and synchrony,\" Neural Computation, vol. 8, no. 5, pp. 979\u2013\n1001, 1996.\n[35] R. Brockett, \"Nonlinear systems and differential geometry,\" Proceedings of the IEEE, vol. 64, no. 1, pp. 61\u201372, 1976.\n[36] B. M. Levitan and V. V. Zhikov, Almost periodic functions and differential equations. Cambridge: Cambridge University\nPress, 1982.\n[37] R. Rose and J. Haindmarsh, \"The assembly of ionic currents in a thalamic neuron i. the three-dimensional model,\" Proc.\nR. Soc. Lond. B, vol. 237, pp. 267\u201328, 1989.\n\nJanuary 5, 2012\n\nDRAFT\n\n\f29\n\n[38] J. Keener and J. Sneyd, Mathematical Physiology.\n\nNew York: Springer-Verlag, 1998.\n\n[39] S. Sastry and R. Montgomery, \"The structure of optimal controls for a steering problem,\" in Proc. IFAC Symposium on\nNonlinear Control Systems, 1992.\n[40] R. Montgomery, \"Optimal control of deformable bodies, isoholonomic problems and sub-riemannian geometry,\" in\nTechnical Report 05324-89, Mathematical Sciences Research Institute, 1989.\n[41] W. Marks, \"Deep brain stimulation for dystonia,\" Curr. Treat. Options Neurol., pp. 237\u2013243, 2005.\n[42] H. J. Sussmann, Time-Optimal Control in the Plane, in Feedback Control of Linear and Non-linear Systems, Lecture Notes\nin Control and Information Sciences.\n\nBerlin: Springer-Verlag, 1982.\n\n[43] --, \"The structure of time-optimal trajectories for single-input systems in the plane: The c\u221e nonsingular case,\" SIAM\nJ. Control Optim., vol. 25, pp. 433\u2013465, 2004.\n[44] D. Stefanatos, H. Schaettler, and J.-S. Li, \"Minimum-time frictionless atom cooling in harmonic traps,\" SIAM Journal on\nControl and Optimization, vol. 49, no. 6, pp. 2440\u20132462, 2011.\n[45] A. Isidodri, Nonlinear Control Systems.\n\nLondon: Springer, 1995.\n\n[46] J.-S. Li, J. Ruths, T.-Y. Yu, H. Arthanari, and G. Wagner, \"Optimal pulse design in quantum control: A unified computational\nmethod,\" Proceedings of the National Academy of Sciences, vol. 108, no. 5, pp. 1879\u20131884, 2011.\n[47] J. Ruths and J.-S. Li, \"A multidimensional pseudospectral method for optimal control of quantum ensembles,\" Journal of\nChemical Physics, vol. 134, p. 044128, 2011.\n[48] --, \"Optimal control of inhomogeneous ensembles,\" IEEE Transactions on Automatic Control: Special Issue on Control\nof Quantum Mechanical Systems (in press).\n[49] J. Ruths, A. Zlotnik, and J.-S. Li, \"Convergence of a pseudospectral method for optimal control of complex dynamical\nsystems,\" in 50th IEEE Conference on Decision and Control, Orlando, FL, December 2011.\n[50] C. Canuto, M. Y. Hussaini, A. Quarteroni, and T. A. Zang, Spectral Methods.\n\nBerlin: Springer, 2006.\n\n[51] G. Elnagar, M. A. Kazemi, and M. Razzaghi, \"The pseudospectral legendre method for discretizing optimal control\nproblems,\" IEEE Transactions on Automatic Control, vol. 40, no. 10, pp. 1793\u20131796, 1995.\n[52] M. Ross and F. Fahroo, \"Legendre pseudospectral approximations of optimal control problems,\" in New Trends in Nonlinear\nDynamics and Control, W. Kang, M. Xiao, and C. R. Borges, Eds. Berlin: Springer, 2003, pp. 327\u2013342.\n[53] F. Fahroo and I. Ross, \"Costate estimation by a legendre pseudospectral method,\" Journal of Guidance, Control, and\nDynamics, vol. 24, no. 2, pp. 270\u2013277, 2001.\n[54] B. Fornberg, A Practical Guide to Pseudospectral Methods.\n[55] G. Szego, Orthogonal Polynomials.\n\nJanuary 5, 2012\n\nCambridge University Press, 1998.\n\nNew York: American Mathematical Society, 1959.\n\nDRAFT\n\n\f"}