{"id": "http://arxiv.org/abs/0904.2834v2", "guidislink": true, "updated": "2009-11-01T11:49:41Z", "updated_parsed": [2009, 11, 1, 11, 49, 41, 6, 305, 0], "published": "2009-04-18T09:02:01Z", "published_parsed": [2009, 4, 18, 9, 2, 1, 5, 108, 0], "title": "Tropical and algebraic curves with multiple points", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0904.1745%2C0904.3700%2C0904.0148%2C0904.3857%2C0904.4627%2C0904.0727%2C0904.3514%2C0904.1238%2C0904.0514%2C0904.1977%2C0904.1522%2C0904.3865%2C0904.0546%2C0904.3393%2C0904.1331%2C0904.4889%2C0904.0233%2C0904.4243%2C0904.0368%2C0904.1641%2C0904.3882%2C0904.1206%2C0904.0769%2C0904.4759%2C0904.0024%2C0904.3066%2C0904.2472%2C0904.0904%2C0904.3843%2C0904.2552%2C0904.2216%2C0904.4520%2C0904.1930%2C0904.1701%2C0904.4660%2C0904.1240%2C0904.1782%2C0904.3214%2C0904.3458%2C0904.3921%2C0904.2250%2C0904.2352%2C0904.2320%2C0904.2236%2C0904.3925%2C0904.0735%2C0904.4611%2C0904.3731%2C0904.1376%2C0904.4745%2C0904.4638%2C0904.1784%2C0904.1300%2C0904.2100%2C0904.4149%2C0904.1043%2C0904.2543%2C0904.2986%2C0904.4518%2C0904.0415%2C0904.4507%2C0904.4327%2C0904.3482%2C0904.3338%2C0904.2390%2C0904.1631%2C0904.4411%2C0904.3952%2C0904.1413%2C0904.1892%2C0904.4328%2C0904.1538%2C0904.0433%2C0904.0724%2C0904.2834%2C0904.3658%2C0904.1380%2C0904.3001%2C0904.4886%2C0904.2093%2C0904.3898%2C0904.3257%2C0904.4760%2C0904.4229%2C0904.3435%2C0904.2887%2C0904.2094%2C0904.3074%2C0904.2603%2C0904.3135%2C0904.1987%2C0904.2110%2C0904.1808%2C0904.1405%2C0904.0789%2C0904.4403%2C0904.4094%2C0904.3014%2C0904.2451%2C0904.3989%2C0904.3839&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Tropical and algebraic curves with multiple points"}, "summary": "Patchworking theorems serve as a basic element of the correspondence between\ntropical and algebraic curves, which is a core of the tropical enumerative\ngeometry. We present a new version of a patchworking theorem which relates\nplane tropical curves with complex and real algebraic curves having prescribed\nmultiple points. It can be used to compute Welschinger invariants of non-toric\nDel Pezzo surfaces.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0904.1745%2C0904.3700%2C0904.0148%2C0904.3857%2C0904.4627%2C0904.0727%2C0904.3514%2C0904.1238%2C0904.0514%2C0904.1977%2C0904.1522%2C0904.3865%2C0904.0546%2C0904.3393%2C0904.1331%2C0904.4889%2C0904.0233%2C0904.4243%2C0904.0368%2C0904.1641%2C0904.3882%2C0904.1206%2C0904.0769%2C0904.4759%2C0904.0024%2C0904.3066%2C0904.2472%2C0904.0904%2C0904.3843%2C0904.2552%2C0904.2216%2C0904.4520%2C0904.1930%2C0904.1701%2C0904.4660%2C0904.1240%2C0904.1782%2C0904.3214%2C0904.3458%2C0904.3921%2C0904.2250%2C0904.2352%2C0904.2320%2C0904.2236%2C0904.3925%2C0904.0735%2C0904.4611%2C0904.3731%2C0904.1376%2C0904.4745%2C0904.4638%2C0904.1784%2C0904.1300%2C0904.2100%2C0904.4149%2C0904.1043%2C0904.2543%2C0904.2986%2C0904.4518%2C0904.0415%2C0904.4507%2C0904.4327%2C0904.3482%2C0904.3338%2C0904.2390%2C0904.1631%2C0904.4411%2C0904.3952%2C0904.1413%2C0904.1892%2C0904.4328%2C0904.1538%2C0904.0433%2C0904.0724%2C0904.2834%2C0904.3658%2C0904.1380%2C0904.3001%2C0904.4886%2C0904.2093%2C0904.3898%2C0904.3257%2C0904.4760%2C0904.4229%2C0904.3435%2C0904.2887%2C0904.2094%2C0904.3074%2C0904.2603%2C0904.3135%2C0904.1987%2C0904.2110%2C0904.1808%2C0904.1405%2C0904.0789%2C0904.4403%2C0904.4094%2C0904.3014%2C0904.2451%2C0904.3989%2C0904.3839&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Patchworking theorems serve as a basic element of the correspondence between\ntropical and algebraic curves, which is a core of the tropical enumerative\ngeometry. We present a new version of a patchworking theorem which relates\nplane tropical curves with complex and real algebraic curves having prescribed\nmultiple points. It can be used to compute Welschinger invariants of non-toric\nDel Pezzo surfaces."}, "authors": ["Eugenii Shustin"], "author_detail": {"name": "Eugenii Shustin"}, "author": "Eugenii Shustin", "arxiv_comment": "35 pages, 3 figures, numerous corrections are made, few illustrating\n  examples are added", "links": [{"href": "http://arxiv.org/abs/0904.2834v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0904.2834v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "14H20, 14N10", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0904.2834v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0904.2834v2", "journal_reference": null, "doi": null, "fulltext": "Tropical and algebraic curves with multiple points\nEugenii Shustin\nTo Oleg Yanovich Viro in occasion of his 60th birthday\n\narXiv:0904.2834v2 [math.AG] 1 Nov 2009\n\nAbstract\nPatchworking theorems serve as a basic element of the correspondence\nbetween tropical and algebraic curves, which is a core of the tropical enumerative geometry. We present a new version of a patchworking theorem which\nrelates plane tropical curves with complex and real algebraic curves having\nprescribed multiple points. It can be used to compute Welschinger invariants\nof non-toric Del Pezzo surfaces.\n\n1\n\nIntroduction\n\nThe patchworking construction in the toric context is originated in the Viro method\nsuggested in 1979-80 for obtaining real algebraic hypersurfaces with prescribed topology [19, 20, 21]. Later it was developed and applied to other problems, in particular,\nto the tropical geometry. Namely, it serves as in important step in the proof of a\ncorrespondence between tropical and algebraic curves which in turn is a core of the\nenumerative applications of the tropical geometry (see, for example, the foundational\nMikhalkin's work [9] and other versions and modifications in [10, 13, 15, 17]). We\ncontinue the latter line and present here a new patchworking theorem. The novelty\nof our version is that it allows one to patchwork algebraic curves with prescribed\nmultiple points, whereas the similar existing statements in tropical geometry apply\nonly to nonsingular or nodal curves.1\nThe cited results are restricted to the case of curves in toric varieties (for example,\nthe plane blown up in at most three points). Since the consideration of curves on\na blown up surface is equivalent to the study of curves with fixed multiple points\non the original surface, one can apply the tropical enumerative geometry to count\ncurves on the plane blown up at more than three points. This approach naturally\nleads to the question: What are the plane tropical curves which correspond (as nonArchimedean amoebas or logarithmic limits) to algebraic curves with fixed generic\nmultiple points on toric surfaces? The question appears to be more complicated\nthan that resolved in [9, 13], and no general answer is known so far.\n1\n\nRephrasing Selman Akbulut, who called Viro's disciples \"little Viro's\", our contribution is \"a\nlittle patchworking theorem\" descending from \"the great Viro's patchworking theorem\".\n\n1\n\n\fThe goal of the present paper is to prove a patchworking theorem for a specific\nsort of plane tropical curves, i.e. we show that each tropical curve in the chosen\nclass gives rise to an explicitly described set of algebraic curves on a given toric\nsurface, in a given linear system, of a given genus, and with a given collection of\nfixed points with prescribed multiplicities (Theorem 2, section 3). Furthermore, in\nthe real situation, we compute the contribution of the constructed curves to the\nWelschinger invariant (Theorem 3, section 3).\nIn fact, we do not know all the tropical curves, which may give rise to the above\nalgebraic curves, and, furthermore, we restrict our patchworking theorem to a statement which is sufficient to settle the two following problems:\n\u2022 to prove recursive formulas of the Caporaso-Harris type for the Welschinger\ninvariants of pP1 q2p0,2q , the quadric hyperboloid, blown up at two imaginary\npoints, and for P2pk,2lq , k 2l \u00a4 5, l \u00a4 1, the plane, blown up at k generic real\npoints and at l pairs of conjugate imaginary points [6];\n\u2022 to establish a new correspondence theorem between algebraic curves of a given\ngenus in a given linear system on a toric surface and some tropical curves, and\nfind new real tropical enumerative invariants of real toric surfaces [18].\nWe mention here an important consequence of the former result\nTheorem 1 ([6]) Let \u03a3 be one of the real Del Pezzo surfaces pP1 q2p0,2q or Pp2k,2lq ,\nk 2l \u00a4 5, l \u00a4 1, and let D \u0080 \u03a3 be a real ample divisor. Then the Welschinger\ninvariants W0 p\u03a3, D q, corresponding to the totally real configurations of points, are\npositive, and they satisfy the asymptotic relation\nlog W0 p\u03a3, nD q\nn\u00d18\nn log n\nlim\n\nlog GW0 p\u03a3, nD q\n\u0010 nlim\n\u0010 \u0001K\u03a3D ,\n\u00d18\nn log n\n\nwhere GW0 p\u03a3, D q are the genus zero Gromov-Witten invariants.\nA similar statement for all the real toric Del Pezzo surfaces except for pP1 q2p0,2q\nwas known before [4, 5].\nPreliminary notations and definitions. If P \u0080 Rn is a pure-dimensional\nlattice polyhedral complex, dim P \u0010 d \u00a4 n, by |P | we denote the lattice volume of\nP , counted so that the lattice volume of a d-dimensional lattice polytope \u2206 \u0080 Rn\nis the ratio of the Euclidean volume of \u2206 and of the minimal Euclidean volume of\na d-dimensional lattice simplex in the linear d-subspace of Rn , parallel to the affine\nd-space spanned by \u2206. In particular, |P | \u0010 #P if P is finite.\n\nGiven a lattice polyhedron \u2206, by TorK p\u2206q 2 we denote the toric variety over a\nfield K, associated with \u2206, and by L\u2206 we denote the tautological line bundle (i.e.\nthe bundle generated by the monomials z \u03c9 , \u03c9 P \u2206, as global sections). The divisors\n2\n\nWe omit subindex in the complex case writing simply Torp\u2206q.\n\n2\n\n\fTorK p\u03c3 q \u0080 TorK p\u2206q, corresponding to the facets (faces of codimension 1) \u03c3 of \u2206,\nwe call toric divisors. By TorK pB \u2206q we denote the union of all the toric divisors\nin TorK p\u2206q.\n\u0094\n\nThe main field we use is K \u0010 m\u00a51 Cppt1{m qq, the field of locally convergent\ncomplex Puiseux series possessing a non-Archimedean valuation\nVal : K\u0006\n\n\u00d1 R,\n\nVal\n\n\u0003\n \u0327\n\nar tr\n\n\u0010 \u0001 mintr\n\n: ar\n\n\u0018 0u .\n\nr\n\n\u0003\n\nDenote\nini\n\n \u0327\n\nar tr\n\n\u0010 av ,\n\nwhere v\n\n\u0010 \u0001Val\n\nr\n\n\u0003\n \u0327\n\nar tr\n\n.\n\nr\n\nThe field K is algebraically closed and contains a closed real subfield KR\n\u00b0\n\u00b0\nConjp r ar tr q \u0010 r ar tr .\n\n\u0010 FixpConjq,\n\nWe remind here the definition of Welschinger invariants [23], restricting ourselves\nto a particular situation. Let \u03a3 be a real unnodal (i.e. without p\u0001nq-curves,\nn \u00a5 2) Del Pezzo surface with a connected real part R\u03a3, and let D \u0080 \u03a3 be a real\nample divisor. Consider a generic configuration \u03c9 of c1 p\u03a3q\u0004 D \u0001 1 distinct real points\nof \u03a3. The set RpD, \u03c9 q of real (i.e. complex conjugation invariant) rational curves\nC P |D | passing through the points of \u03c9 is finite, and all these curves are nodal and\nirreducible. Put\n \u0327\nW p\u03a3, D, \u03c9 q \u0010\np\u00011qspC q ,\n\nP p\n\nC R D,\u03c9\n\nq\n\nwhere spC q is the number of solitary nodes of C (i.e. real points, where a local equation of the curve can be written over R in the form x2 y 2 \u0010 0). By Welschinger's\ntheorem [23], the number W p\u03a3, D, \u03c9 q does not depend on the choice of a generic\nconfiguration \u03c9, and hence we simply write W p\u03a3, D q, omitting the configuration in\nthe notation of this Welschinger invariant.\nIn what follows we shall use a generalized definition of the Welschinger sign of a\ncurve. Namely, let C be a real algebraic curve on a smooth real algebraic surface\n\u03a3, and let p \u0080 \u03a3 be a conjugation invariant finite subset. Assume that C has no\nsingular local branches (i.e. is an immersed curve). Then we define the Welschinger\nsign\n \u0327\nW\u03a3,ppC q \u0010 p\u00011qspC,\u03a3,pq , where spC, \u03a3, pq \u0010\nspC 1 , z q ,\n(1)\nz Sing C 1\n\nP\n\np q\n\nC 1 being the strict transform of C under the blow up of \u03a3 at p, and spC 1 , z q is the\nnumber of solitary nodes in a local \u03b4-const deformation of the singular point z of C 1\ninto \u03b4 pC 1 , z q nodes, where \u03b4 denotes the \u03b4-invariant of singularity (i.e., the maximal\npossible number of nodes in its deformation). It is evident that spC 1 , z q is correctly\ndefined modulo 2, and hence W\u03a3,ppC q is well-defined.\nOrganization of the material. In section 2, we set forth the geometry of plane\ntropical curves adapted to our purposes, completing with the definition of weights of\n3\n\n\ftropical curves which, in the complex case, designate the number of algebraic curves\nassociated with the given tropical curves in the further patchworking theorem, and,\nin the real case, the contribution of the real algebraic curves in the associated set\nto the Welschinger number. In section 3, we provide two patchworking theorems,\nthe complex and the real one, in which we explicitly construct algebraic curves\nassociated to the tropical curves under consideration.\nAcknowledgement. The author was supported by the grant no. 465/04 from\nthe Israel Science Foundation, a grant from the Higher Council for Scientific Cooperation between France and Israel, and a grant from the Tel Aviv University. This\nwork was completed during the author's stay at the Centre Interfacultaire Bernoulli,\n\u00c9cole Polytechnique F\u00e9d\u00e9rale da Lausanne and at Laboratoire Emile Picard, Universit\u00e9 Paul Sabatier, Toulouse. The author thanks the CIB-EPFL and UPS for the\nhospitality and excellent working conditions. Special thank are due to I. Itenberg,\nwho pointed out a mistake in the preliminary version of Theorem 3. Finally, I express my gratitude to the unknown referee for numerous remarks, corrections, and\nsuggestions.\n\n2\n\nParameterized plane tropical curves\n\nFor the reader's convenience, we remind here some basic definitions and facts about\ntropical curves, which we shall use in the sequel. The details can be found in\n[8, 9, 12].\n\n2.1\n\nDefinition\n\nAn abstract tropical curve is a compact graph \u0393 without divalent vertices and\n0\nisolated points such that \u0393 \u0010 \u0393z\u03938\n, where \u039308 is the set of univalent vertices, is a\nmetric graph whose closed edges are isometric to closed segments in R, and non0\nclosed edges \u0393-ends are isometric to rays in R or to R itself. Denote by \u0393 , resp.\n1\n\u03930 , the set of vertices of \u0393, resp. \u0393, and split the set \u0393 of edges of \u0393 into \u039318 , the\nset of the \u0393-ends, and \u03931 , the set of closed (finite length) edges of \u0393. The genus of\n\u0393 is g \u0010 b1 p\u0393q \u0001 b0 p\u0393q 1.\n\nA plane parameterized tropical curve (shortly PPT-curve) is a pair p\u0393, hq,\nwhere \u0393 is an abstract tropical curve and h : \u0393 \u00d1 R2 is a continuous map whose\nrestriction to any edge of \u0393 is a non-zero Z-affine map and which satisfies the following balancing and nondegeneracy conditions at any vertex v of \u0393: For each\nv P \u03930 ,\n \u0327\ndhv p\u03c4v peqq \u0010 0 ,\n(2)\n\nP\n\nP\n\n1\n\nv e, e \u0393\n\nand\n\nSpantdhv p\u03c4v peqq ; v\n4\n\nP e, e P \u03931u \u0010 R2 ,\n\n\fwhere \u03c4v peq is the unit tangent vector to an edge e at the vertex v. The degree of a\n1\nu, where\nPPT-curve p\u0393, hq is the unordered multi-set of vectors tdhp\u03c4 peqq : e P \u03938\n\u03c4 peq denotes the unit tangent vector of a \u0393-end e pointing to the univalent vertex.\nObserve that\n\n \u0327\ne\n\nP 8\n\ndhp\u03c4 peqq \u0010 0 ,\n\n(3)\n\n\u03931\n\nwhat immediately follows from the balancing condition (2). We shall also use\nanother form of the \u0393-end-balancing condition. For each \u0393-end e pick any point\nxe P hpez\u039308 q. Then\n \u0327\nxR\u03c0{2pdhp\u03c4 peqqq, xey \u0010 0 ,\n(4)\n\nP\n\n1\ne \u03938\n\nwhere R\u03c0{2 is the (positive) rotation by \u03c0 {2. This is an elementary consequence of\nthe stuff discussed in the next section: one can lift a PPT-curve to a plane algebraic\ncurve over a non-Archimedean field, consider the defining polynomial, and then use\nthe fact that the product of the roots of the (quasihomogeneous) truncations of this\npolynomial on the sides of its Newton polygon equals 1. We leave details to the\nreader.\nSince dhv pp\u03c4v peqq P Z2 , we have a well-defined positive weight function w : \u0393 \u00d1 Z\nin the relation dhv p\u03c4v peqq \u0010 w pequv peq with uv peq being the primitive integral tangent vector to hpeq, emanating from hpv q. In the sequel, when modifying tropical\ncurves we speak of changes of edge weights, which in terms of h and \u0393 means that\nh remains unchanged whereas the metric on the chosen edges is multiplied by a\nconstant.\n1\n\nObserve that a connected component of \u0393zF , where F is finite, naturally induces\na new PPT-curve (further on referred to as induced) when making the metric on\nthe non-closed edges of that component complete and respectively correcting the\nmap h on these edges. These induced curves and the unions of few of them, coming\nfrom the same \u0393zF , are called PPT-curves subordinate to p\u0393, hq.\n\nThe deformation space Mp\u0393, hq of a PPT-curve p\u0393, hq is obtained by variation\nof the length of the finite edges of \u0393 and combining h with shifts. It can be identified\nwith an open rational convex polyhedron in Euclidean space, and its closure Mp\u0393, hq\ncan be obtained by adding the boundary of that polyhedron which corresponds to\nPPT-curves with some edges e P \u03931 contracted into points.\n\nDeformation equivalent PPT-curves are often called to be of the same combinatorial type. The degree and the genus are invariants of the combinatorial type\nas well as the following characteristics. We call a PPT-curve p\u0393, hq\n\u2022 irreducible if \u0393 is connected,\n\u2022 simple if \u0393 is trivalent, and\n\u2022 pseudo-simple if, for any vertex v P \u03930 incident to m \u00a1 3 edges e1 , e2 , ..., em ,\nj \u00a4 m, and only two distinct vectors among\none has uv pe1 q \u0018 uv pej q, 1\nuv pe2 q, ..., uv pem q.\n5\n\n\fIn the latter case, an edge ei emanating from a vertex v P \u03930 of valency m \u00a1 3 is\ncalled simple, if uv pei q \u0018 uv pej q for all j \u0018 i, and is called multiple otherwise.\n\n2.2\n\nNewton polygon and its subdivision dual to a plane\ntropical curve\n\nGiven a PPT-curve Q \u0010 p\u0393, hq, the image T \u0010 hp\u0393q \u0080 R2 is a finite planar graph,\nwhich supports an embedded plane tropical curve (shortly EPT-curve) h\u0006 Q :\u0010\npT, h\u0006wq with the (edge) weight function\nh\u0006 w : T 1\n\n\u00d1 Z,\n\nh\u0006 w pE q \u0010\n\n \u0327\n\nP\n\n1\n\np q\u0081E\n\nw peq .\n\ne \u0393 , h e\n\nThe respective balancing condition immediately follows from (2). Furthermore,\nthere exists a convex lattice polygon \u2206 \u0080 R2 (different from a point) and a convex\npiece-wise linear function\nfT : R2\n\n\u00d1 R,\n\nf pxq \u0010 max 2 px\u03c9, xy\n\nP X\n\n\u03c9 \u2206 Z\n\nc\u03c9 q,\n\nx P R2 ,\n\n(5)\n\nsuch that\n\u2022 T is the corner locus of fT ,\n\u2022 for any two linearity domains D1 , D2 of fT , corresponding to linear functions\nin formula (5) with gradients \u03c91 , \u03c92 , respectively, and having a common edge\nE \u0010 D1 X D2 of T , it hods \u03c92 \u0001 \u03c91 \u0010 h\u0006 w pE q \u0004 upE q, where upE q is the\nprimitive integral vector orthogonal to E and directed from D1 to D2 .\nHere the polygon \u2206, called the Newton polygon of Q, is defined uniquely up to\na shift in R2 , and fT is defined uniquely up to addition of a linear affine function.\n\nThe Legendre dual to fT function \u03bdT : \u2206 \u00d1 R is convex piece-wise linear, and\nits linearity domains define a subdivision ST of \u2206 into convex lattice subpolygons.\nThis subdivision ST is dual to the pair pR2 , T q in the following way: there is 1-to-1\ncorrespondence between the faces of subdivision of R2 determined by T and the\nfaces of subdivision ST such that (i) the sum of the dimensions of dual faces is 2,\n(ii) the correspondence inverts the incidence relation, (iii) the dual edges of T and\nof ST are orthogonal, and the weight of an edge of T equals the lattice length of the\ndual edge of ST . In particular, If V \u0010 p\u03b1, \u03b2 q is a vertex of T , then \u2207\u03bdT \u0010 p\u0001\u03b1, \u0001\u03b2 q\nalong the dual polygon \u2206V of the subdivision ST .\n\nFurthermore, we can obtain an extra information on the subdivision ST out of\nthe original PPT-curve Q. Namely,\n\u2022 with each edge e P \u0393 we associate a lattice segment \u03c3e which is orthogonal to\nhpeq and satisfies |\u03c3e | \u0010 w peq,\n1\n\n6\n\n\f\u2022 with each vertex v P \u03930 we associate a convex lattice polygon \u2206v , whose sides\n1\nare suitable translates of the segments \u03c3e , e P \u0393 , v P e. Denote by \u03c3v,e the\nside of \u2206v , which is a translate of \u03c3e and whose outward normal is dhv p\u03c4v peqq.\nLet a polygon \u2206V of the subdivision ST be dual to a vertex V of T . Then (up to a\nshift)\n \u0327\n \u0327\n\u03c3e\n\u2206V \u0010\n\u2206v .\n(6)\n1\neP\u0393\np qXh\u00011 pV q\u0018H\n\nInt e\n\nP\np q\u0010\n\nv \u03930\nh v V\n\nIn this connection, we can speak on \u2207\u03bdT along the polygons \u2206v appearing in (6).\nA EPT curve T is called nodal, if the dual subdivision ST consists of triangles\nand parallelograms, i.e., when the non-trivalent vertices of T are locally intersections\nof two straight lines. A nodal EPT curve canonically lifts into a simple PPT curve\nwhen one resolves all nodes of the given curve.\n\n2.3\n\nCompactified tropical curves\n\nFor a given convex lattice polygon \u2206, different from a point, we define a compactification R2\u2206 of R2 in the following way. If dim \u2206 \u0010 2, we identify R2 with the\npositive orthant pR\u00a10 q2 by the coordinate-wise exponentiation, then identify pR\u00a10 q2\nwith the interior of R2\u2206 :\u0010 TorR p\u2206q \u0014 \u2206, the non-negative part of the real toric\nvariety TorR p\u2206q, via the moment map\n\u03bcpxq \u0010\n\n\u00b0\n\u03c9\n2 x \u03c9\n\u00b0\u03c9P\u2206XZ\n,\n\nP X\n\n\u03c9 \u2206\n\nZ2\n\nx\u03c9\n\nx P pR\u00a10 q2 .\n\nIf \u2206 is a segment, then we take \u22061 \u0010 \u2206 \u0002 \u03c3, \u03c3 being a transverse lattice segment,\nand define R2\u2206 as the quotient of R2\u22061 by contracting the sides parallel to \u03c3. We\nobserve that the rays in R2 , directed by an external normal u to a side \u03c3 of \u2206 and\nemanating from distinct points on a line, transverse to \u03c3, close up at distinct points\non the part of BpR2\u2206 q, corresponding to the interior of \u03c3 in the above construction3 .\nSo, we can naturally compactify a PPT-curve p\u0393, hq into p\u0393, hq, by extending h\nup to a map h : \u0393 \u00d1 R2\u2206 .\n\n2.4\n\nMarked tropical curves\n\nAn abstract tropical curve with n marked points is a pair p\u0393, Gq, where \u0393 is an\nabstract tropical curve and G \u0010 p\u03b31 , ..., \u03b3n q is an ordered n-tuple of distinct points\nof \u0393. We say that a marked tropical curve p\u0393, Gq is regular if each connected\ncomponent of \u0393zG is a tree containing precisely one vertex from \u039308 . Furthermore,\na marked tropical curve p\u0393, Gq is called\n3\n\nClearly, the rays directed by vectors distinct from any exterior normal to sides on \u2206 close up\nat respective vertices of R2\u2206 .\n\n7\n\n\f\u2022 end-marked, if G X \u03930\neach end,\n\n\u0010 H and the points of G lie on the ends of \u0393, one on\n\n\u2022 regularly end-marked, if G X \u03930\nand p\u0393, Gq is regular.\n\n\u0010 H, the points of G lie on the ends of \u0393,\n\nA parametrization of a (compact) plane tropical curves with marked points is\na triple p\u0393, G, hq, where p\u0393, Gq is a marked abstract tropical curve, and p\u0393, hq is\na PPT-curve. We define the deformation space Mp\u0393, G, hq \u0080 Mp\u0393, hq by fixing\nthe combinatorial type of the pair p\u0393, Gq (G being an ordered sequence). It can\nbe identified with a convex polyhedron in RN , where the coordinates designate the\ntwo coordinates of the image hpv q of a fixed vertex v P \u03930 , the lengths of the edges\ne P \u03931 , and the distances between the marked points lying inside edges of \u0393 to some\nfixed points inside these edges (chosen one on each edge), cf. [1]. Further on the\ndeformation type of a marked PPT-curve is called a combinatorial type.\nLemma 1 Let \u2206 be a convex lattice polygon, X \u0010 px1 , ..., xn q a sequence of points\nin R2\u2206 (not necessarily distinct). Then there exists at most one n-marked regular\nPPT-curve p\u0393, G, hq with the Newton polygon \u2206 and with a fixed combinatorial type,\nsuch that hp\u03b3i q \u0010 xi , \u03b3i P G, i \u0010 1, ..., n.\nProof. If such a marked PPT-curve exists, it is sufficient to uniquely restore each\nconnected component of \u0393zG, and hence, the general situation reduces to the case of\nan irreducible rational PPT-curve (a subordinate curve defined by such a connected\n0\ncomponent) with |\u03938\n| \u0001 1 \u0010 |\u039318| \u0001 1 marked univalent vertices. We proceed by\n1\n1\ninduction on |\u0393 |. The base of induction, i.e. the case |\u0393 | \u0010 1 is evident. Assume\n1\nthat |\u0393 | \u00a1 1.\nIf there are two \u0393-ends e1 , e2 with marked points that emanate from one vertex\nv P \u03930 and are mapped into the same straight line by h, then either hpe1 q \u0010 hpe2 q,\nin which case we replace e1 , e2 by one end of weight w pe1 q w pe2 q and respec1\ntively replace two marked points by one, thus, reducing |\u0393 | by 1 and keeping the\nirreducibility and the rationality of the tropical curve, or hpe1 q and hpe2 q are the\nopposite rays emanating from hpv q, in which case we remove the \u0393-end with lesser\n1\nweight, leaving the other with weight |w pe1q \u0001 w pe2 q|, thus, reducing |\u0393 | by 1 or 2.\nIf there are no \u0393-ends as above, from\n\n|\u03930| \u0001 |\u03931| \u0010 1\n|\u03930| \u00a4 |\u039318| \u0001 2.\n\nand 3 \u0004 |\u03930 | \u00a4 2 \u0004 |\u03931 |\n\n|\u039318|\n\nwe deduce that\nHence there are two non-parallel \u0393-ends with\nmarked points which merge to a common vertex v P \u03930 , which thereby is determined\nuniquely. So, we remove the above \u0393-ends and the vertex v from \u0393, then extend the\nother edges of \u0393 coming to v up to new ends and mark on them the points mapped\nto hpv q. Thus, the induction assumption completes the proof.\nl\n\n8\n\n\f2.5\n\nTropically generic configurations of points\n\nLet \u2206 be a convex lattice polygon, x \u0010 px1 , ..., xk q a sequence of distinct points in\nR2\u2206 such that xi P \u03c3i , 1 \u00a4 i \u00a4 r, where \u03c31 , ..., \u03c3r \u0080 R2\u2206 correspond to certain sides of\n\u2206, and xi P R2 \u0080 R2\u2206 , r i \u00a4 k. Let m \u0010 pm1 , ..., mk q be a sequence of non-negative\nintegers, called weights of the points x1 , ..., xk , respectively. A subconfiguration of\npx, mq is a configuration px, m1q with m1 \u00a4 m (component-wise).\nLet C be a combinatorial type of an irreducible end-marked PPT-curve with Newton polygon \u2206, with m \u0010 m1 ... mk \u0393-ends and marked points \u03b31 , ..., \u03b3m . A\nweighted configuration px, mq is called C-generic, if there is no end-marked irreducible PPT-curve p\u0393, G, hq of type C such that hpGq \u0010 px, mq, i.e.\nhp\u03b3i q \u0010 xi ,\n\n \u0327\n\nmj\n\ni\u00a4\n\nj i\n\n \u0327\n\n\u00a4\n\nmj ,\n\ni \u0010 1, ..., k .\n\nj i\n\nA weighted configuration px, mq is called \u2206-generic, if it together with all its subconfigurations is generic with respect to the combinatorial types of end-marked\nirreducible PPT-curves which have m \u00a4 |B \u2206 X Z2 | \u0393-ends and directing vectors of\nall edges orthogonal to integral segments in \u2206. A (non-weighted) configuration x is\ncalled \u2206-generic if all possible weighted configurations px, mq are \u2206-generic.\nLemma 2 The\n\u2206-generic\nconfigurations\nwith\nrational\ncoordinates\nx \u0010 px1 , ..., xk q \u0080 R2\u2206 such that xi P \u03c3i , 1 \u00a4 i \u00a4 r, xi P R2 , r\ni \u00a4 k,\n2 k \u0001r\nform a dense subset of \u03c31 \u0002 ... \u0002 \u03c3r \u0002 pR q .\nProof. Notice that there are only finitely many (up to the choice of edge weights)\ncombinatorial types of end-marked irreducible PPT-curves under consideration and\nonly finitely many weight collections m to consider. We shall prove that, for any\nsuch combinatorial type C of end-marked irreducible PPT-curves, the image of the\nnatural evaluation map Ev : MpC q \u00d1 \u03c31 \u0002 ... \u0002 \u03c3r \u0002 pR2 qk\u0001r is nowhere dense, and\nhence is a finite polyhedral complex of a positive codimension. This would suffice\nfor the proof of Lemma due to the aforementioned finiteness.\n\nThus, assuming that an end-marked irreducible curve p\u0393, G, hq of type C matches\na weighted rational configuration px, mq, we shall show that this imposes a nontrivial\nrelation on the coordinates of the points of x, and hence complete the proof. Clearly,\nany point xi P x lying on B R2\u2206 (\u2206 being the Newton polygon of p\u0393, G, hq) is a\nunivalent vertex for some ends of \u0393, whose h-images lie on the same straight line.\nSo, pushing all the points of x X B R2\u2206 along the corresponding lines, we can make\nx \u0080 R2 . Take an irrational vector a P R2 and pick the point xi P x with the\nmaximal value of the functional xa, xy. Notice that there are no vertex v P \u03930 with\nxa, hpvqy \u00a5 xa, xiy, since otherwise, due to the balancing condition (2), one would\nfind an end e of \u0393 with hpeq lying entirely in the half-plane xa, xy \u00a1 xa, xi y contrary\nthe the assumptions made. Hence, for each end e P \u039318 with hpeq passing through\nxi , we have xa, \u03c4 peqy \u00a1 0, which yields that\n \u0327\n\nP\nPpq\n\n1\ne \u03938\nxi h e\n\nme \u0004 dhp\u03c4 peqq \u0018 0\n\n9\n\n\ffor any positive integers me , and which finally implies that the coordinates of xi\nnontrivially enter relation (4).\nl\nLemma 3 Let x be a \u2206-generic configuration of points, Q \u0010 p\u0393, G, hq a marked\nregular PPT-curve with Newton polygon \u2206 which matches x. Then\n(i) phq\u00011 pxq \u0010 G;\n\n(ii) if K is a connected component of \u0393zG, then its edges can be oriented so that\n- the edges merging to marked points, emanate from these points,\n- the unmarked \u0393-end is oriented towards its univalent endpoint,\n- from any vertex v\n\nP K 0 emanates precisely one edge, and this edge is simple.\n\nRemark 4 It follows from Lemma 3 that if an edge of \u0393 is multiple for both of its\nendpoints and contains a marked point inside which matches a point x P x, then all\nthe other edges joining the same vertices contain marked points matching x.\nProof of Lemma 3. (i) Assume that there is a point \u03b3 P phq\u00011 pxqzG. It belongs\nto a component K of \u0393zG, which is a tree due to the regularity of the considered\nmarked tropical curve, and hence, is cut by \u03b3 into two trees K1 , K2 , and only one of\nthem, say K1 contains a \u0393-end free of marked points. Then, marking the new point\n\u03b3, we obtain that the irreducible (rational) PPT-curve induced by K2 is end-marked\nand matches a subconfiguration of x contrary to its \u2206-genericity.\n(ii) Observe that the image of the unmarked ray does not coincide with the image\nof any other edge of K, what immediately follows from the statement (i).\nNext we notice that, if p is a vertex of K, e a multiple edge merging to p,\nthen the connected component K peq of K ztpu, starting with the edge e does not\ncontain the unmarked K-end. Indeed, otherwise, we consider another edge e1 of\nK merging to p so that up pe1 q \u0010 up peq. Then we take the graph K zK peq, which\nafter a suitable modification of the weights of the edges of K pe1 q (the component of\nK ztpu starting with e1 ) induces an end-marked (rational) PPT-curve matching the\n\u2206-generic configuration x, thus, a contradiction.\nIt follows from the latter observation that K has no edge being multiple for both\nof its endpoints. Indeed, otherwise we would have two vertices v1 , v2 P K 0 , joined\nby an edge e P K 1 , multiple for both v1 and v2 , and then would obtain that the\nunmarked K-end is contained either in the component of K ztv1 u starting with e, or\nin the component of K ztv2 u starting with e, contrary to the above conclusion.\nFinally, we define an orientation of the edges of K, opposite to the required one.\nStart with the unmarked K-end and orient it towards its multivalent endpoint. In\nany other step, coming to a vertex v P K 0 along some edge, we orient all other edges\nmerging to v outwards. Since K is a tree, the orientation smoothly extends to all\nof its edges. The preceding observations confirm that any edge e oriented in this\nl\nmanner towards a vertex v P E is simple for v.\n10\n\n\f2.6\n\nWeights of marked pseudo-simple regular PPT-curves\n\nIn this section, Q \u0010 p\u0393, G, hq is always a regular marked pseudo-simple PPT-curve.\nDenote G8 \u0010 G X \u039308 and G0 \u0010 GzG8 , and put x \u0010 hpGq, x8 \u0010 hpG8 q. Throughout this section we assume that\n(T1) no edge of \u0393 is multiple for two vertices of \u0393,\n(T2) G0 does not contain vertices of valency\n\n\u00a1 3,\n\n(T3) x is \u2206-generic.\nIn particular, by Lemma 3, we have that phq\u00011 pxq \u0010 G.\n\nComplex weights. We define the complex weight of a PTT-curve Q \u0010\np\u0393, G, hq as\n1\n1\n1\nM pQ, v q \u0004\nM pQ, eq \u0004\nM pQ, \u03b3 q ,\nM pQq \u0010\n(7)\n\nP\n\nv \u03930\n\nP\n\ne \u03931\n\nP\n\n\u03b3 G\n\nwhere the values M pQ, v q, M pQ, eq, M pQ, \u03b3 q are computed along the following rules.\n(M1) M pQ, eq \u0010 w peq for each edge e P \u03931 .\n\n(M2) M pQ, \u03b3 q \u0010 1 for each \u03b3\n1\n\u03b3 P Gzp\u03930 Y \u039308 q, \u03b3 P e P \u0393 .\n\nP G X p\u03930 Y \u039308q, and M pQ, \u03b3 q \u0010 wpeq for each\n\nTo define M pQ, v q, v P \u03930 , introduce some notation: denote by \u2206v the lattice\ntriangle whose boundary is combined of the vectors dhp\u03c4v peqq, rotated clockwise by\n\u03c0 {2, where e runs over all the edges of \u0393 emanating from v. Next, we put:\n\nP \u03930 X G, then M pQ, vq \u0010 |\u2206v |.\n(M4) If v P \u03930 zG is trivalent, then it belongs to a connected component K of \u0393zG\n1\nwhich we orient as in Lemma 3(ii) and thus define two edges e1 , e2 P \u0393 merging to\nv. In this case we put M pQ, v q \u0010 |\u2206v |pw pe1qw pe2 qq\u00011 .\n(M5) Let v P \u03930 be of valency s r 1 \u00a1 3, where 1 \u00a4 r \u00a4 s, 2 \u00a4 s, and\nlet ei , i \u0010 1, ..., s r 1, be all the edges with endpoint v so that the edges ei ,\n1 \u00a4 i \u00a4 s, have a common directing vector uv pe1 q, the edges ei , s\ni \u00a4 s r,\nhave a common directing vector uv pes 1 q, and es r 1 is a simple edge emanating\n(M3) If v\n\nfrom v along the orientation of Lemma 3(ii). Consider a rational PPT-curve Qv\n\u0094\ninduced by the graph \u0393v \u0010 tv u Y is\u00101 r 1 ei \u0080 \u0393, pick auxiliary marked points\n\u03b3i P ei ztv u, i \u0010 1, ..., s r, in such a way that hp\u03b3i q \u0010 y 1 P R2 as 1 \u00a4 i \u00a4 s, and\nhp\u03b3i q \u0010 y 2 P R2 as s i \u00a4 s r. Then we replace y 1 (resp. y 2 ) by a generic set of\ndistinct points y 1 , ..., y s close to y 1 (resp. distinct points y s 1 , ..., y s r close to y 2 ),\nand take rational regularly end-marked PPT-curves of degree tdhp\u03c4v pei qqui\u00101,...,s r 1\nmatching the configuration y 1 , ..., y s r so that the h-image of the \u0393-end of weight\nw pei q with the directing vector uv pei q passes through the point y i , i \u0010 1, ..., s r\n(see Figure 1).4 By [9, Corollaries 2.24 and 4.12], the set T of these PPT-curves is\n4\n\nNotice that by construction there is a canonical 1-to-1 correspondence between the ends of Qv\nand the ends of any of the curves obtained in the deformation.\n\n11\n\n\fe1\n\nes\n\nes\n\n\u2746\n\u2746 \u03b31\n\u2746\n\u274d\u274d\n\u2746\n\u274d\n\u03b3s \u274d \u2746\n\u274d\u274d\n\u2746\n\u271f\n\u03b3s 1 \u271f\u271f\u2701\u2701\n\u271f\n\u2701\n\u271f\u271f\n\u2701\n1\n\u2701 \u03b3r\n\u2701\n\ner\n\n\u03931\n\n\u0393\ner\n\n\u2745\n\u2745\n\u2745\n\u2745\n\u2745\n\u2745\n\u2745\n\u2745\n\u2745\n\u271f\n\u2745 \u271f\n\ns 1\n\ns\n\ns\n\n\u00f9\u00f1\n\nh\n\n\u2744\n\nhpe1 q, ..., hpes q\n\n\u2745\n\u2745\n1\n\u2745 y\n\u2745\n\u2745\n\n\u2745\n\nhper\n\ns 1\n\nh1\n\n\u2744\n\n\u2745\n\u2745 y1\n\u2745\n\u2745\n\u2745\n\u2745\ny\u2745\ns \u2745\n\u2745\n\u271f\n\u2745 \u271f\n\nq\n\ny2\nhpes\n\n1\n\nys\n\n1\n\nyr\n\ns\n\nq, ..., hper sq\nFigure 1: Local deformation of a tropical curve in (M5)\n\nfinite, and they all are simple. Then put\nM pQ, v q \u0010\n\n \u0327\nQ1 T\n\nP\n\nM pQ1 q ,\n\n(8)\n\nwhere all terms M pQ1 q are computed by formula (7) and the rules (M1) -(M4).\nRemark 5 (1) We point out that the right-hand side of (8) does not depend on\nthe choice of the configuration py i qi\u00101,...,s r 1, what follows from [1, Theorem 4.8]\n(observe that the degree of the evaluation map as in [1, Definition 4.6] coincides\nwith the right-hand side of (8) in our situation). Slightly modifying the Mikhalkin\ncorrespondence theorem ([9, Theorem 1]), one can deduce that M pQ, v q as defined\nin (8) equals the number of complex rational curves C on the toric surface Torp\u2206v q\nsuch that\n\u2022 C belongs to the tautological linear system |L\u2206v |,\n\u2022 for each side \u03c3 of \u2206v , the intersection points of C with the toric divisor\nTorp\u03c3 q \u0080 Torp\u2206v q are in 1-to-1 correspondence with the \u0393-ends of the tropical\ncurves from T , orthogonal to \u03c3, C is nonsingular along Torp\u03c3 q, and the intersection multiplicities are respectively equal to the weights of the above \u0393-ends,\n12\n\n\f\u2022 C passes through a generic configuration of s\n\n1 points in Torp\u2206v q.\n\nr\n\nFurthermore, T consists of just one curve as r \u0010 1. Indeed, its dual subdivision of\nthe Newton triangle \u2206v must be as described above with the order of segments dual\nto the parallel \u0393-ends, which is determined uniquely by the disposition of the points\ny 1 , ..., y s .\n(2) If Q is simple (i.e. all the vertices of \u0393 are trivalent, then (7) gives\nM pQq \u0010 \u00b1\n\n\u00b1\n\nP\n\nv \u0393o\n\nP\n\n|\u2206v |\n\nPP\n\n1\n\u03b3 G8 , \u03b3 e \u03938\n\nw peq\n\n,\n\n(9)\n\nwhich generalizes Mikhalkin's weight introduced in [9, Definitions 2.16 and 4.15],\nand coincides with the multiplicity of a tropical curve from [1].\nReal weights. A PPT-curves Q \u0010 p\u0393, G, hq equipped with an additional structure, a continuous involution c : p\u0393, G, hq \u00fd and a subdivision G \u0010 RG Y IG\ninvariant with respect to c, is called real.\nClearly, I\u0393 :\u0010 \u0393zR\u0393, where R\u0393\n2\nI\u0393 interchanged by c.\n\n\u0007\n\n\u0010 Fix c\u0007\u0393 consists of two disjoint subsets I\u03931,\n\nGiven a real PPT-curve Q, we can construct a (usual) PPT-curve Q{c \u0010\nNotice that the weights of the edges obtained here by identify2\ning I\u0393 and I\u0393 are even. Conversely, given a (usual) PPT-curve Q \u0010 p\u0393, G, hq\n1\n1\nand a set I p\u0393 q \u0080 \u0393 , which includes only edges of even weight, we construct a real\n\u0094\n1\n1\nPPT-curve Q1 \u0010 p\u0393 , G1 , h q as follows: (i) put K \u0010 ePI p\u03931 q e and obtain the graph\n\np\u0393{c, G1{c, h{cq.\n1\n\n\u0393 by gluing up \u0393 with another copy K 1 of K at the vertices of \u0393, common for K\nand the closure of \u0393zK, (ii) the map h coincides on K and K 1 , whereas the weights\nof the doubled edges are divided by 2 in order to keep the balancing condition, (iii)\nthe points of G X K are respectively doubled to K 1 . Finally, define an involution c\non Q1 interchanging K and K 1 , and define a subdivision G1 \u0010 RG1 Y IG1 .\nWe shall consider only real PPT-curves with the following properties:\n\n(R1) R\u0393 is nonempty and has no one-point connected component,\n(R2) I\u0393 has only uni- and trivalent vertices (if nonempty),\n(R3) the marked points G0 X I\u0393 are not vertices of I\u0393,\n(R4) IGzI\u0393 is empty or consists of some trivalent vertices of \u0393,\n(R5) the closure of any component of I\u0393zG contains a point from IG.\nObserve that the closure of I\u0393 joins R\u0393 at vertices of valency \u00a1 3 (which are not\nin G by condition (T2)).\n\n13\n\n\fThe real weight of a real PPT-curve Q is defined as\nW pQq \u0010 p\u00011ql1 2l2 \u0004\n\n1\nv\n\nP\n\nW pQ, v q \u0004\n\n\u03930\n\n1\n\nP\n\nW pQ, eq \u0004\n\n1\n\n1\n\nP\n\nW pQ, \u03b3 q ,\n\n(10)\n\n\u03b3 G0\n\ne \u0393\n\n\u0010 |RG X2 I\u0393| , l2 \u0010 |IG X I\u03932| \u0001 b0 pI\u0393q ,\nwith W pQ, v q, W pQ, eq, W pQ, \u03b3 q computed along the following rules:\n(W1) For an edge e \u0080 R\u0393, put W pQ, eq \u0010 0 or 1 according as w peq is even or\nodd. For an edge e P \u03931 , e \u0080 I\u0393, put W pQ, eqW pQ, cpeqq \u0010 w peq. For an edge\ne P \u039318 , e \u0080 I\u0393, put W pQ, eq \u0010 1.\n(W2) For \u03b3 P G0 X R\u0393z\u03930 , put W pQ, \u03b3 q \u0010 1. For \u03b3 P RG X \u03930 , put W pQ, \u03b3 q \u0010 1.\nFor \u03b3 P IG, \u03b3 \u0010 v P \u03930 , put W pQ, \u03b3 q \u0010 |\u2206v |. For \u03b3 P G0 , \u03b3 P e \u0080 I\u0393, put\nW pQ, \u03b3 qM pQ, cp\u03b3 qq \u0010 w peq.\n(W3) For a vertex v P \u03930 X I\u0393, put W pQ, v qW pQ, cpv qq \u0010 p\u00011q|B\u2206 XZ | M pQ, v q\n(see condition (M4) for the definition of M pQ, v q). For a trivalent vertex v P \u03930 X R\u0393,\nput W pQ, v q \u0010 p\u00011q|Intp\u2206 qXZ | .\n(W4) For a four-valent vertex v P \u03930 incident to two simple edges from R\u0393 and\ntwo multiple edges e1 , e2 from I\u0393, put W pQ, v q \u0010 p\u00011q|Intp\u2206 qXZ | |\u2206v |{p2w pe1 qq.\n(W5) Let v P \u03930 be of valency \u00a1 3 incident to\nl1\n\nv\n\nv\n\n2\n\n2\n\n2\n\nv\n\n\u0080 R\u0393,\nedges ei \u0080 R\u0393, 1 i \u00a4 r1\n\n\u2022 a simple edge e1\n\u2022\n\n1\n\n2\n\n1, and e1i \u0080 I\u0393 , e2i \u0080 I\u0393 , 1 \u00a4 i \u00a4 s1 , for some\nnonnegative r1 , s1 , all with the same directing vector u1 \u0018 uv pe1 q, and\n\n1\n\n2\n\n\u2022 edges ei \u0080 R\u0393, r1 1 i \u00a4 r1 r2 1, and e1i \u0080 I\u0393 , e2i \u0080 I\u0393 , s1 i \u00a4 s1 s2 ,\nfor some nonnegative r2 , s2 such that r2 2s2 \u00a5 2, all with the same directing\nvector u2 \u0018 uv pe1 q, u1 .\nTake the real PPT-curve Qv induced by v and the edges emanating from v, correspondingly restrict on Qv the involution c, and introduce a finite c-invariant set of\nmarked points Gv picking up one point on each edge emanating from v but e1 . Consider the PPT-curve Qv {c and perform with it the deformation procedure described\nin (M5) (cf. Figure 1) getting a finite set of simple rational regularly end-marked\nr G,\nr \u0010 p\u0393,\nr r\nPPT-curves. Any curve Q\nhq from this set, we turn into a real PPT-curve.\nr\nNamely, first, we include into the set I p\u0393\n\nq all the \u0393-ends which correspond to the\nr 1 q in the following\n\u0393{c-ends of Qv from I\u0393v {c. Then we maximally extend the set I p\u0393\nr 1 q merge to a vertex p P \u0393\nr 0 , then the\ninductive procedure: if two edges f1 , f2 P I p\u0393\n1\nr q. Clearly, by construction,\nthird edge f3 , emanating from p should be added to I p\u0393\nr1 q are even; hence we can make a real PPT-curve\nthe weights of the edges e P I p\u0393\n1\n1\n1\n1\nQ1 \u0010 p\u0393 , G1 , h q, letting RG1 \u0010 G1 X R\u0393 , IG1 \u0010 G1 X I\u0393 . Denoting the final set of\n1\n\n14\n\n\freal PPT-curves by T and observing that their real weight W pQ1 q can be computed\nalong the above rules (W1) -(W4), we define\n \u0327\n\nW pQ, v q \u0010\n\nQ1 T\n\nP\n\nW pQ1 q .\n\nThe fact that the latter expression does not depend on the choice of the perturbation\nof the points y 1 , y 2 (cf. construction in (M5) and Figure 1) follows from a more\ngeneral statement proven in [18].\nRemark 6 (1) If c \u0010 Id, IG \u0010 H, and Q is simple, we obtain the well-known\nformula: W pQq \u0010 0 when \u0393 contains an even weight edge, and W pQq \u0010 p\u00011qa ,\n\u00b0\na \u0010 vP\u03930 |Intp\u2206v q X Z2 |, when all the edge weights of \u0393 are odd (cf. [9, Definition\n7.19] or [13, Proposition 6.1], where, in addition, deg Q consists of only primitive\nintegral vectors).\n(2) If Q is rational, Q{c is simple and G8 \u0010 RG X \u03930 \u0010 RG X I\u0393 \u0010 H, we\nobtain a generalization of [15, Formula (2.12)] (in version at arXiv:math/0406099).\nIndeed, if R\u0393 contains an edge of even weight, we obtain W pQq \u0010 0 in (10) due to\n(W1), and accordingly we obtain w pQ{cq \u0010 0 in [15, Section 2.5] (in the notations\ntherein). If R\u0393 contains only edges of odd weight, then [15, Formula (2.12)] reads\nw pQ{cq \u0010 p\u00011qa\n\n1\n\nb\n\n|\u2206v | \u0004\n\nP X\n\nv \u03930 IG\n\n1\n\n|\u2206v |\n\nPp { q XpI\u0393{cq\n\n2\n\nv \u0393 c\n\n0\n\n(11)\n\n\u00b0\n\nwith a \u0010 vPp\u0393{cq0 |Intp\u2206v q X Z2 |, b \u0010 |p\u0393{cq0 X pI\u0393{cq|, whereas in (10) we obtain\nl1 \u0010 0 by the assumption RG X I\u0393 \u0010 H, l2 \u0010 |p\u0393{cq0 XpI\u0393{cq| due to the rationality\nof Q and simplicity of Q{c, and, furthermore, taking into account that w peq \u0010\n2w pe1 q \u0010 2w pcpe1 qq for e \u0010 pe1 Y cpe1 qq{c P p\u0393cq1 , e1 P \u03931 , e1 \u0080 I\u0393, we compute the\nother factors in (10):\n1\n\nP\n\nW pQ, v q \u0010\n\nv \u03930\n\n1\n\nP z\n\np\u00011q|Intp\u2206 qXZ | \u0004\n\nv \u03930 I\u0393\n\np\u00011q|B\u2206 XZ | M pQ, vq\nv\n\n2\n\ntv,cpvquPp\u0393{cq0 XpI\u0393{cq\n\np\u00011q|Intp\u2206 qXZ | w|\u2206pevq|\n\n1\n\n\u0002\n\n1\n\n2\n\nv\n\nv\n\n2\n\nP X {\nP \u0080 { Pp { q1\n1\n1\np\u00011q|Intp\u2206v qXZ2 | \u0004 p\u00014q|p\u0393{cq0 XI\u0393{c| \u0004\n|\u2206v |\n\u0010\n0\nvPp\u0393{cq0\nvPp\u0393{cq XI\u0393{c\nv R\u0393 I\u0393 c\nv e I\u0393 c, e \u0393 c\n\n\u00022\u0001|R\u0393XI\u0393|\n\n1\n\nPp { q\n\n2\nw peq\n\n\u0080 {\n\ne \u0393 c 1 , e I\u0393 c\n\n1\n\nP\n\n1\n\ne \u0393\n\nW pQ, eq \u0010\n\n1\n\nPp { q\n\n\u0080 {\n\ne \u0393 c 1 , e I\u0393 c\n\n15\n\n1\n\nPp { q \u0080 {\nX { \u0018H\n\ne \u0393 c 1 , e I\u0393 c\ne G c\n\nw peq\n2\n\n2\n,\nw peq\n\n1\n\nPp { q \u0080 {\nX { \u0018H\n\ne \u0393 c 1 , e I\u0393 c\ne G c\n\nw peq\n,\n2\n\n\f1\n\nP\n\nW pQ, \u03b3 q \u0010\n\n\u03b3 G0\n\n1\n\nP X\n\n1\n\n|\u2206v |\n\nv IG R\u0393\n\nPp { q \u0080 {\nX { \u0018H\n\ne \u0393 c 1 , e I\u0393 c\ne G c\n\nw peq\n,\n2\n\nwhich altogether gives (with a, b from (11))\nW pQq \u0010 p\u00011qa\n\nb\n\n1\n\nP X\n\nv \u03930 IG\n\n3\n\n1\n\n|\u2206v | \u0004\n\nPp { q0 XpI\u0393{cq\n\n|\u2206v | \u0010 wpQ{cq .\n2\n\nv \u0393 c\n\nPatchworking theorem\n\n3.1\n\nPatchworking data\n\nCombinatorial-geometric part. In the notation of section 2.6, let Q \u0010 p\u0393, G, hq\nbe a pseudo-simple irreducible regular marked PPT-curve of genus g which has a\nnondegenerate Newton polygon \u2206 and which satisfies condition (T1)-(T3) of section\n2.6.\n\npm q\n\npdmq\n\npm q\n\nLet G0 split into disjoint subsets G0 \u0010 G0 Y G0 such that G0 X \u03930 \u0010 H and\npmq\npdmq\nhpG0 qX hpG0 q \u0010 H. We equip the points of G0 with the following multiplicities:\n\nP Gpmq , put mtp\u03b3 q \u0010 1,\nif \u03b3 P Gpdmq is a (trivalent) vertex of \u0393, put mtp\u03b3 q \u0010 p1, 1q,\nif \u03b3 P Gpdmq is not a vertex of \u0393, put mtp\u03b3 q \u0010 p1, 0q or p0, 1q.\n\n\u2022 if \u03b3\n\u2022\n\u2022\n\nIn the sequel, by Q\u0302 we denote the PPT-curve Q equipped with the subdivision\npmq\npdmq and the multiplicity function mtp\u03b3 q, \u03b3 P G as above.\nG0 \u0010 G0 Y G0\n0\nDefinition 7 A pair \u03b3, \u03b3 1 of distinct points in G0 is called special if hp\u03b3 q \u0010 hp\u03b3 1 q\n1\nand mtp\u03b3 q \u0010 mtp\u03b3 1 q. A pair of parallel multiple edges e, e1 P \u0393 emanating from a\nvertex v P \u03930 of valency \u00a1 3 is called special if there are disjoint open connected\nsubsets K, K 1 of \u0393ztv u such that\n- K contains the germ of e at v and the point \u03b3, K 1 contains the germ of e1 at v\nand the point \u03b3 1 ,\n- there is a homeomorphism \u03c6 : K\nA vertex v\n\n\u0007\n\n\u0007\n\n\u00d1 K 1 satisfying h\u0007K \u0010 h\u0007K 1 \u0005 \u03c6.\n\nP \u03930 incident to a special pair of edges is called special.\n\nThen we assume the following:\n(T4) The edges in special pairs have weight 1, and at least one of the simple edges\nemanating from a special vertex has weight 1.\n\n16\n\n\fmp\u03b31 q \u0010 mp\u03b32 q \u0010 1\n\nmp\u03b31 q \u0010 mp\u03b32 q \u0010 mp\u03b33 q \u0010 p1, 0q\nmp\u03b34 q \u0010 p0, 1q\n\u03b34\n\n\u03b32\u271f\u271fe\u271f\n\u2745\n2\n\u271f\n\u2745\n\u2745\u271f\u271f\nv\n\n\u03b31\n\n\u03b33\ne2\u271f\u271f\u271f \u2745\n\u2745\n\u2745\n\u2745\n\u271f\n\u2745 \u03b32\n\u2745\u271f\u271f\n\u2745\n\u2745\nv\ne1\n\u2745\n\u2745\n\u03b31 \u2745\n\ne1\n\nh\n\nh\n\n\u2744\n\n\u2744\n\n\u2745\n\u2745\n\u2745\n\n\u2745\n\u2745\n\u2745\n\n(a)\n\n\u2745\n\u2745\n\u2745\n\n(b)\n\nspecial pair of marked points p\u03b31 , \u03b32 q, special pair of edges pe1 , e2 q, special vertex v\nFigure 2: Illustration to Definition 7\n(T5) Let e, e1 be a special pair of edges emanating from a vertex v P \u03930 , and let\nK, K 1 be disjoint connected subsets of \u0393ztv u as in Definition 7; then K Y K 1\ncontains at most one special pair of points of G0 .\n(T6) A special pair of edges cannot be a pair of \u0393-ends and cannot be a pair of finite\nlength edges which end up at a special pair \u03b3, \u03b3 1 P \u03930 such that hp\u03b3 q \u0010 hp\u03b3 1 q\nand mtp\u03b3 q \u0010 mtp\u03b3 1 q \u0010 p1, 1q.\n(T7) Let a vertex v P \u03930 be a special vertex, and let te1 , ..., es u be a maximal (with\nrespect to inclusion) set of edges of \u0393 incident to v and such that\n\nP G0, 1 \u00a4 i \u00a4 s,\n- hp\u03b31 q \u0010 ... \u0010 hp\u03b3s q and mtp\u03b31 q \u0010 ... \u0010 mtp\u03b3s q.\n0\nSuppose that distpv, vi q \u00a4 distpv, vi 1 q, 1 \u00a4 i s, vi P \u0393 ztv u being the second\n- each edge ei contains a point \u03b3i\n\nvertex of ei . Then we require\n\n \u0327\n\ndistpv, \u03b31q \u00a1\n\n\u00a4\n\n\u0001\n\ndistp\u03b3i , vi q\n\n2 \u0004 distp\u03b3s\u00011 , vs\u00011 q .\n\n(12)\n\n1 i s 1\n\nNotice that, in condition (T7), at most one edge ei is a \u0393-end (cf. (T6)) and it\nmust be es .\nIntroduce also the semigroup\nZ8\n\u00a50\n\n\u0010 t\u03b1 \u0010 p\u03b11, \u03b12, ...q\n\n: \u03b1i\n\nP Z,\n\n\u03b1i\n\n\u00a5 0, i \u0010 1, 2, ... , |ti\n17\n\n: \u03b1i\n\n\u00a1 0u| 8u\n\n,\n\n\fequipped with two norms\n\n8\u0327\n\n}\u03b1}0 \u0010\n\n\u03b1i ,\n\n\u0010\n\n}\u03b1}1 \u0010\n\ni 1\n\nand the partial order\n\n\u03b1\u00a5\u03b2\n\n8\u0327\n\u0010\n\ni\u03b1i ,\n\ni 1\n\n\u001d\n\n\u03b1\u0001\u03b2\n\nP Z8\u00a50 .\n\n\u03c3\nFor each side \u03c3 of \u2206 introduce the vectors \u03b2 \u03c3 P Z8\n\u00a50 such that the coordinate \u03b2i of\n\u03c3\n0\n2\n\u03b2 equals the number of the univalent vertices v P \u03938 such that hpv q P \u03c3 \u0080 R\u2206 and\nw peq \u0010 i for the \u0393-end e merging to v, for all i \u0010 1, 2, ...\n\nAlgebraic part. Let \u03a3 \u0010 TorK p\u2206q. The coordinate-wise valuation map Val :\npK\u0006 q2 \u00d1 R2 naturally extends up to Val : \u03a3 \u00d1 R2\u2206. Let p \u0080 \u03a3 :\u0010 TorKp\u2206q be finite\nand satisfy Valppq \u0010 x \u0010 hpGq.5 Suppose that\n(A1) each point x P hpGpmq q \u0080 x has a unique preimage in p,\n(A2) the preimage of each point x\npoints p1,x, p2,x P p,\n\nP hpGpdmqq \u0080 x consists of an ordered pair of\n\n(A3) there is a bijection \u03c8 : p8 \u00d1 G8 , where p8 :\u0010 Val\u00011 px8 q, x8\nthat Valppq \u0010 hp\u03c8 ppqq, p P p8 ,\n\n\u0010 hpG8q, such\n\n(A4) the sequence p is generic among the sequences satisfying the above conditions.\nDefine the multiplicity function \u03bc : p X pK\u0006 q2\n\n\u00d1 Z\u00a10 such that:\n\n\u2022 for p P p X pK\u0006 q2 , Valppq \u0010 x P hpGm q, put\n\u03bcppq \u0010\n\n \u0327\n\n\u03b3 PGpmq , hp\u03b3 q\u0010x\n\nmtp\u03b3 q ,\n\n(13)\n\n\u2022 for the points p1,x, p2,x, where Valpp1,xq \u0010 Valpp2,xq \u0010 x P hpGpdmq q, put\n\u03bcpp1,xq \u0010 m1 , \u03bcpp2,xq \u0010 m2 ,\n\npm1 , m2q \u0010\n\n \u0327\n\n\u03b3 Gpdmq , h \u03b3\n\nP\n\np q\u0010x\n\nmtp\u03b3 q .\n\n(14)\n\nFrom this definition and from the count of the Euler characteristic of \u0393, we derive\n \u0327\n\npPpXpK\u0006 q2\n\n\u03bcppq\n\n|p8| \u0001 |\u039380 | \u0010 g \u0001 1 .\n\n(15)\n\nLet \u22061 \u0080 R2 be a convex lattice polygon such that there is another lattice polygon\n(or segment, or point) \u22062 satisfying \u22061 \u22062 \u0010 \u2206. Then we have a well defined\nline bundle L\u22061 on TorK p\u2206q. Let p1 \u0080 p and \u03bc1 : p1 X pK\u0006 q2 \u00d1 Z\u00a10 be such that\n\u03c3 1\n\u03c3\n\u03bc1 ppq \u00a4 \u03bcppq for all p P p1 . Let p\u03b2 \u03c3 q1 P Z8\n\u00a50 , \u03c3 \u0080 B \u2206, be such that p\u03b2 q \u00a4 \u03b2 for\nall sides \u03c3 of \u2206. We say that the tuple p\u22061 , g 1 , p1 , \u03bc1 , tp\u03b2 \u03c3 q1 u\u03c3\u0080B\u2206 q, where g 1 P Z\u00a50 ,\nis compatible, if\n5\n\nThis means, in particular, that the points of x have rational coordinates.\n\n18\n\n\f\u2022\n\u2022\n\u2022\n\n}p\u03b2 \u03c3 q1}1 \u0010 xc1pL\u22061 q, TorKp\u03c3qy for all sides \u03c3 of \u2206,\np\u03b2 \u03c3 q1i \u00a5 |tp P p1 X TorKp\u03c3q : \u03c8ppq \u0010 \u03b3 P e P \u039318, wpeq \u0010 iu| for all sides \u03c3 of\n\u2206 and all i \u0010 1, 2, ...,\ng 1 \u00a4 |Intp\u22061 X Z2 q|, and\n \u0327\n \u0327\n\u03bc1 ppq |p1 X p8 | \u0001\n}p\u03b2 \u03c3 q1}0 \u0010 g1 \u0001 1 .\np p1\n\nP XpK\u0006 q2\n\nIn view of (15) and |\u039308 | \u0010\nible.\n\n\u03c3\n\n\u00b0\n\u03c3\n\n\u0080B\u2206 }\u03b2\n\n\u03c3\n\n\u0080B\u2206\n\n}0 , the tuple p\u2206, g, p, \u03bc, t\u03b2 \u03c3 u\u03c3\u0080B\u2206 q is compat-\n\nFor any compatible tuple p\u22061 , g 1 , p1 , \u03bc1 , tp\u03b2 \u03c3 q1 u\u03c3\u0080B\u2206 q, introduce the set\nC p\u22061 , g 1 , p1 , m1 , tp\u03b2 \u03c3 q1 u\u03c3\u0080B\u2206 q of reduced irreducible curves C P |L\u22061 | passing through\np1 and such that\n\u2022 the points p P p1 X p8 are nonsingular for C, and\n\npC \u0004 TorKpB\u2206qqp \u0010 wpeq ,\nwhere \u03b3 \u0010 \u03c8 ppq P G8 , and e P \u039318 merges to \u03b3,\n\n\u2022 the local branches of C centered at the points of C X TorK pB \u2206q are smooth,\nand, for each side \u03c3 of \u2206 and each i \u0010 1, 2, ..., there are precisely p\u03b2 \u03c3 q1i local\nbranches P of C centered at C X TorK p\u03c3 q such that\n\npP \u0004 TorKp\u03c3qq \u0010 i ,\ni \u0010 1, 2, ...,\n\n\u00a4 g 1,\nat each point p P p1 X pK\u0006 q2 , the multiplicity of C is mtpC, pq \u00a5 \u03bc1 ppq.\n\n\u2022 C has genus\n\u2022\n\nWe now impose new conditions on the algebraic pathchworking data:\n(A5) For\nany\ncompatible\ntuple\np\u22061 , g1, p1, m1 , tp\u03b2 \u03c3 q1u\u03c3\u0080B\u2206 q, the set\n1\n1\n1\n1\n\u03c3 1\nis\nfinite,\nall\nthe\ncurves\nC\nP\nC p\u2206 , g , p , m , tp\u03b2 q u\u03c3\u0080B\u2206 q\n1\n1\n1\n1\n1\n\u03c3 1\nC p\u2206 , g , p , m , tp\u03b2 q u\u03c3\u0080B\u2206 q are immersed, have genus g , and have multiplicity mtpC, pq \u0010 m1 ppq at each point p P p1 X pK\u0006 q2 ; furthermore,\nH 1 pC \u03bd , JZ pC \u03bd qq \u0010 0 ,\n\n(16)\n\nwhere C \u03bd is the normalization and JZ pC \u03bd q is the (twisted with C \u03bd ) ideal\nsheaf of the zero-dimensional scheme Z \u0080 C \u03bd which contains the lift of\np and of the points of tangency of C and TorK pB \u2206q upon C \u03bd , and which\nhas length pC \u0004 TorK pB \u2206qqp at the lift of p P p X TorK pB \u2206q, and the length\npC \u0004 TorKpB\u2206qqz \u0001 1 at the lift of each point z P C X TorKpB\u2206qzp.\n19\n\n\fHere we verify the condition (A5) for the versions of the patchworking theorem\nused in [6, 18].\nLemma 8 Condition (A5) holds if\n\u2022 either \u03bcppq \u0010 1 for all p P p X pK\u0006 q2 ,\n\u2022 or the surface \u03a3 \u0010 TorK p\u2206q is one of P2 , P2k with 1 \u00a4 k \u00a4 3, pP1 q2 , the\nconfiguration p8 is contained in one toric divisor E of \u03a3, and\n\n|tp P p X pK\u0006 q2\n\n: \u03bcppq \u00a1 1u| \u00a4\n\n$\n'\n&4,\n'\n%\n\n5 \u0001 E 2 \u0001 k,\n3\n\n\u03a3 \u0010 P2 ,\n\u03a3 \u0010 P2k ,\n\u03a3 \u0010 pP1 q2 .\n\nMoreover, all the curves C in the considered sets are nonsingular along TorK pB \u2206q,\nare nodal outside p, and have ordinary singularity of order m1 ppq at each point\np P p1 X pK\u0006 q2 .\nProof. We prove the statement only for the original data p\u2206, g, p, m, t\u03b2 \u03c3 u\u03c3\u0080B\u2206 q,\nsince the other compatible tuples can be treated in the same way.\n\nP C p\u2206, g, p, m, t\u03b2 \u03c3 u\u03c3\u0080B\u2206 q satisfies\n\u03bcppq |C X TorpB \u2206q| \u0001 1 .\n(17)\n\nObserve that, in the first case, each curve C\n \u0327\np p K\u0006\n\u03bcp 1\n\nP Xp q2\np q\u00a1\n\nIn the second situation, except for finitely many lines or conics (which, of course, satisfy (A5)), the other curves obey (17) by Bezout theorem (just consider intersections\nwith suitable lines or conics - we leave this to the reader as a simple exercise).\n\nSo, we proceed further under the condition (17). Let p1 \u0010 tp P p X pK\u0006 q2 :\n\u03bcppq \u00a1 1u. Consider the family C 1 of reduced irreducible curves C 1 P |L\u2206 | of genus\nat most g, which have multiplicity \u00a5 \u03bcppq at each point p P p1 , whose local branches\ncentered along TorK pB \u2206q are nonsingular, and the number of such branches crossing\nthe toric divisor TorK p\u03c3 q \u0080 TorK p\u2206q with multiplicity i equals \u03b2i\u03c3 for all sides \u03c3 of\n\u2206 and all i \u0010 1, 2, ...\nThe classical deformation theory argument (see, for instance, [2, 3]) Zariski tangent space to C 1 at C P C :\u0010 C p\u2206, g, p, m, t\u03b2 \u03c3 u\u03c3\u0080B\u2206 q is naturally isomorphic to\nH 0 pC \u03bd , JZ pC \u03bd qq, where C \u03bd , JZ pC \u03bd q are defined in (A5). So, we have\ndeg Z\n\n\u0010\n\n \u0327\n\np p1\n\nP\n\n\u03bcppq\n\nC \u0004 TorK p\u2206q \u0001 |C X TorpB \u2206q| \u0010\n\n \u0327\n\np p1\n\nP\n\n\u03bcppq \u0001 CK\u03a3 \u0001 |C X TorpB \u2206q|\n\n\u0001CK\u03a3 \u0001 1 .\n\n(18)\n\nHence (see [2, 3]) H 1 pC \u03bd , JZ pC \u03bd qq \u0010 0, which yields\nh0 pC \u03bd , JZ pC \u03bd qq \u0010 C 2 \u0001 2\u03b4 pC q \u0001 deg Z \u0001 g pC q\n20\n\n1\n\n\f\u0010 \u0001CK\u03a3 2gpC q \u0001 2 \u0001 deg Z \u0001 gpC q 1\n \u0327\n\u0010 gpC q \u0001 1 |C X TorpB\u2206q| \u0001 \u03bcppq (15)\n\u0010 |pzp1 | \u0001 pg \u0001 gpC qq .\npPp1\n\n(19)\n\nSince pzp1 is a configuration of generic points (partly on TorK pB \u2206q), we derive that\ng pC q \u0010 g and that C is finite.\n\nFor the rest of the required statement, we assume that a curve C P C is either not\nnodal outside p, or has singularities on TorK pB \u2206q, or has at some point p P p XpK\u0006 q2\na singularity more complicated than an ordinary point of order \u03bcppq. Then (cf. the\nargument in the proof of [11, Proposition 2.4]) one can find a zero-dimensional\nscheme Z \u0080 Z 1 \u0080 C \u03bd of degree deg Z 1 \u0010 deg Z 1 such that the Zariski tangent\nspace to C 1 at C is contained in H 0 pC \u03bd , JZ 1 pC \u03bd qq. However, then one derives from\n(18) that deg Z 1 \u0001CK\u03a3 , and hence again H 1 pC \u03bd , JZ 1 pC \u03bd qq \u0010 0, which in view of\n(19) will lead to\nh0 pC \u03bd , JZ 1 pC \u03bd qq \u0010 |pzp1 | \u0001 1 ,\n\nl\n\nwhat finally implies the emptiness of C.\n\n3.2\n\nAlgebraic curves over K and tropical curves\n\nIf C P |L\u2206 | is a curve on the toric surface TorK p\u2206q, then the closure\nClpValpC X pK\u0006 q2 qqq \u0080 R2 supports an EPT-curve T with Newton polygon \u2206 (cf.\nsection 2.2) which is defined by a convex piece-wise linear function (5) coming from\na polynomial equation F pz q \u0010 0 of C in pK\u0006 q2 :\nF pz q \u0010\n\n \u0327\n\nP X\n\nA\u03c9 z \u03c9 ,\n\nA\u03c9\n\nP K,\n\nc\u03c9\n\n\u0010 ValpA\u03c9 q,\n\nz\n\nP pK\u0006q2 .\n\n(20)\n\n\u03c9 \u2206 Z2\n\nThe EPT-curve obtained does not depend on the choice of the defining polynomial\nof C and will be denoted by TroppC q.\nObserve also that the polynomial (20) can be written\nF pz q \u0010\n\n \u0327\n\nP X\n\na\u03c9\n\n\b\n\nO pt\u00a10 q t\u03bdT p\u03c9q z \u03c9\n\n\u03c9 \u2206 Z2\n\nwith the convex piece-wise linear function \u03bd : \u2206 \u00d1 R as in section 2.2 and the\ncoefficients a\u03c9 P C non-vanishing at the vertices of the subdivision ST of \u2206.\n\n3.3\n\nPatchworking theorems\n\nThe algebraically closed version.\nTheorem 2 Given the patchworking data, a PPT-curve Q\u0302 and a configuration\np, satisfying all the conditions of section 3.1, there exists a subset C pQ\u0302q \u0080\nC p\u2206, g, p, m, t\u03b2 \u03c3 u\u03c3\u0080B\u2206 q of M pQq curves C such that TroppC q \u0010 h\u0006 Q. Furthermore,\nfor any distinct (non-isomorphic) curves Q\u03021 and Q\u03022 , the sets C pQ\u03021 q and C pQ\u03022 q are\ndisjoint.\n21\n\n\fRemark 9 We would like to underline one useful consequence of Theorem 2: The\nPPT-curve Q and the multiplicities of its marked curves must satisfy the restrictions\nknown for the respective algebraic curves with multiple points.\nThe real version. In addition to all the above hypotheses, we assume the following:\n(R6) the configuration\n\u0007 p is Conj-invariant, ValpRpq\nRp :\u0010 FixpConj\u0007pq and Ip \u0010 pzpRpq,\n\nX ValpIpq \u0010 H,\n\nwhere\n\n(R7) the PPT-curve Q possesses a real structure c : Q \u00fd , G \u0010 RG Y IG such that\n(i) the bijection \u03c8 from (A3) takes G8 X RG into Rp X TorK pB \u2206q and takes\nG8 X IG into Ip X TorK pB \u2206q, respectively,\n(ii) hpGo X RGq \u0080 ValpRpq, hpG0 X IG X \u03930 q \u0080 ValpIpq,\n\n(iii) RG X Gpdmq X I\u0393 \u0010 H,\n\nP G0 X IG X I\u0393, mtp\u03b3 q \u0010 p1, 0q, then mtpcp\u03b3 qq \u0010 p0, 1q,\n(v) if e P \u039318 , e \u0080 R\u0393, then w peq is odd.\n(iv) if \u03b3\n\nTheorem 3 In the notations and hypotheses of Theorem 2 and under assumptions\n(R1)-(R7), the following holds\n \u0327\n\nP p q\n\nW\u03a3,ppC q \u0010 W pQq ,\n\n(21)\n\nC RC Q\u0302\n\nwhere RC pQ\u0302q is the set of the real curves in C pQ\u0302q, and W\u03a3,ppC q defined in (1).\n\n3.4\n\nProof of Theorem 2\n\nOur argument is as follows. First, we dissipate each multiple point p P p of multiplicity k \u00a1 1 into k generic simple points (in a neighborhood of p), and then, using\nthe known patchworking theorems ([13, Theorem 5] and [16, Theorem 2.4]6 ), obtain\nM pQq curves C P |L\u2206 | of genus g matching the deformed configuration q. After\nthat, we specialize the configuration q back into the original configuration p and\nshow that each of the constructed curves converges to a curve with multiple points\nand tangencies as asserted in Theorem 2.\nRemark 10 The deformation part of our argument works well in a rather more\ngeneral situation, whereas the degeneration part appears to be more problematic, and\nat the moment we do not have a unified approach to treat all possible degenerations\nwhich may lead to algebraic curves with multiple points.\n6\n\nThe complete proof is provided in [16].\n\n22\n\n\fFollowing [13, Section 3], we obtain the algebraic curves C over K as germs of\none-parameter families of complex curves C ptq , t P pC, 0q, with irreducible fibres C ptq ,\nt \u0018 0, of genus g and a reducible central fibre C p0q . The given data of Theorem 2\nprovide us with a collection of suitable central fibres C p0q out of which we restore\nthe families using the patchworking statement [13, Theorem 5].\nStep 1. We start with a simple particular case which later will serve as an\nelement of the proof in the general situation. Assume that Q is a rational, simple,\nregularly end-marked PPT-curve, h\u0006 Q \u0080 R2\u2206 is a (compactified) nodal embedded\n\nplane tropical curve, p \u0080 TorK pB \u2206q, G \u0010 G8 , x \u0010 x8 , and p \u00d1 x \u001c G are\nbijections. Here M pQq is given by formula (9), and this number of required rational\ncurves C \u0080 TorK p\u2206q is obtained by a direct application of [13, Theorem 5].\nVal\n\nh\n\nThe combinatorial part of the patchworking data for the construction of curves\nover K consist of the tropical curve Q which defines a piece-wise linear function\n\u03bd : \u2206 \u00d1 R and a subdivision S : \u2206 \u0010 \u22061 Y ... Y \u2206N (see section 2.2). The\nalgebraic part of the patchworking data includes the limit curves Ck \u0080 Torp\u2206k q, the\ndeformation patterns Ce associated with the (finite length edges) edges e P \u03931 (see\n[13, Section 5.1] and [16, Section 2.1]), and the refined conditions to pass through\nthe fixed points (see [13, Section 5.4] and [7, Section 2.5.9]).\nFirst, we orient the edges of \u0393 as in Lemma 3(ii). Then define complex polyno1\nmials fe , e P \u0393 , and fv , v P \u03930 , in the following inductive procedure. In the very\nbeginning, for the \u0393-ends e with marked points \u03b3, we define\nfe px, y q \u0010 p\u03b7 q xp \u0001 \u03be p y q qwpeq ,\n\n(22)\n\nwhere upeq \u0010 pp, q q and p\u03be, \u03b7 q are quasiprojective coordinates of the point inippq\non Torpeq \u0080 Torp\u2206q such that \u03b3 \u0010 \u03c8 ppq (here \u03c8 is the bijection from condition\n(A3) above). Define a linear order on \u03930 compatible with the orientation of \u0393. On\neach stage, we take the next vertex v P \u03930 and define fv and fe , where e is the\nedge emanation from v. Namely, the polynomials fe1 , fe2 associated with the two\nedges merging to v, determine points z1 P Torp\u03c31 q, z2 P Torp\u03c32 q on the surface\nTorp\u2206v q, \u03c31 , \u03c32 being the sides of \u2206v orthogonal to hpe1 q, hpe2 q, respectively, and\nwe construct a polynomial fv with Newton polygon \u2206v which defines an irreducible\nrational curve Cv \u0080 Torp\u2206v q, nonsingular along TorpB \u2206v q, crossing Torpei q at zi ,\ni \u0010 1, 2, and crossing Torpeq at one point z0 (at which one has pCv \u0004 Torpeqqz0 \u0010 w peq).\nBy [13, Lemma 3.5], up to a constant factor there are |\u2206v |{pw pe1qw pe2 qq \u0010 M pQ, v q\nchoices for such a polynomial fv . After that we define fe px, y q via (22) with \u03be, \u03b7 the\n(quasihomogeneous) coordinates of z0 in Torp\u03c3 q, where \u03c3 is the side of \u2206v orthogonal\nto hpeq. So, the limit curves Ck \u0080 Torp\u2206k q are Cv for the triangles \u2206k dual to hpv q,\n1\nand are given by fe1 fe2 , where e1 , e2 P \u0393 appear in the decomposition (6) of a\nparallelogram \u2206k .\nThe set of limit curves is completed by a set of deformation patterns (see [13,\nSections 3.5 and 3.6]) as follows. Namely, for each edge e P \u03931 with w peq \u00a1 1,\nthe deformation pattern is an irreducible rational curve Ce \u0080 Torp\u2206e q, where\n23\n\n\f\u2206e :\u0010 convtp0, 1q, p0, \u00011q, pw peq, 0qu, whose defining (Laurent) polynomial fe px, y q\nhas the zero coefficient of xwpeq\u00011 and the truncations to the edges rp0, 1q, pw peq, 0qs\nand rp0, \u00011q, pw peq, 0qs of \u2206e fitting the polynomials fv1 , fv2 , where v1 , v2 are the\nendpoints of e (see the details in [13, Sections 3.5 and 3.6]). Remind that, by [13,\nLemma 3.9] there are w peq \u0010 M pQ, eq suitable polynomials fe .\nThe conditions to pass through a given configuration p do not admit a refinement.\nIndeed, following [13, Section 5.4], we can turn a given fixed point p into p\u03be, 0q,\n\u03be \u0010 \u03be 0 O pt\u00a10 q P K, by means of a suitable toric transformation. Then, in [13,\nFormula (6.4.26)], the term with the power 1{m will vanish.7\nThe above collections of limit curves and deformation patterns coincide with those\nconsidered in [13], the transversality hypotheses of [13, Theorem 5] are verified in\n[13, Section 5.4]. Hence, each of the\n1\n\nP\n\nv \u03930\n\nM pQ, v q \u0004\n\n1\n\nP\n\nM pQ, eq \u0010 M pQq\n\ne \u03931\n\nabove patchworking data gives rise to a rational curve C \u0080 TorK p\u2206q as asserted in\nTheorem 2. Notice that all these curves are nodal by construction.\nStep 2. Now we come back to the general situation and deform the given configuration p into the following new configuration q.\n\nEach point p \u0010 p\u03beta ..., \u03b7tb ...q P p X pK\u0006 q2 with multiplicity \u03bcppq \u00a1 1\n(defined by (13) or (14)) we replace by \u03bcppq generic points in pK\u0006 q2 with the same\nvaluation image Valppq \u0010 p\u0001a, \u0001bq and the initial coefficients of the coordinates\nclose to \u03be, \u03b7 P C\u0006 , respectively. Furthermore, we extend the bijection \u03c8 from (A3)\nup to a map \u03c8 : q \u00d1 G in such a way that\n\u0007\n\n\u0010 h \u0005 \u03c8,\neach point \u03b3 P Gz\u03930 has a unique preimage, each point \u03b3 P G X \u03930 has precisely\n\n\u2022 Val\u0007q\n\u2022\n\ntwo preimages,\n\n\u2022 if \u03b3 P Gpdmq z\u03930 , hp\u03b3 q \u0010 x, then \u03c8 \u00011 p\u03b3 q is close to p1,x or to p2,x according as\nmtp\u03b3 q \u0010 p1, 0q or p0, 1q,\n\u2022 if \u03b3 P Gpdmq X \u03930 , hp\u03b3 q \u0010 x, then \u03c8 \u00011 p\u03b3 q consists of two points, one close to\np1,x and the other close to p2,x.\nNext we construct a set C 1 \u0080 C p\u2206, g, q, 1, t\u03b2 \u03c3 u\u03c3\u0080B\u2206 q of M pQq curves with the\ntropicalization h\u0006 Q. By Lemma 8, they are irreducible, nodal, of genus g, and with\nspecified tangency conditions along TorK pB \u2206q.\n7\n\nThe mentioned term contains \u03b7s0 , the initial coefficient of the second coordinate of p, and not\nas appears in the published text. The correction is clear, since in the preceding formula for \u03c4\none has just \u03b7s0 .\n\n\u03bes0\n\n24\n\n\fStep 3. Similarly to Step 1, we obtain the limit curves from a collection of\npolynomials in Crx, y s associated with the edges and vertices of the parameterizing\ngraph \u0393 of Q:\n(i) Let \u03b3 P Gz\u03930 lie on the edge e P \u0393 . Then we associate with the edge e a\npolynomial fe px, y q given by (22) with the parameters described in Step 1.\n1\n\n(ii) Let \u03b3 P G0 be a (trivalent) vertex v of \u0393. Then fv px, y q is a polynomial with\nNewton triangle \u2206v (see section 2.2) defining in Torp\u2206v q a rational curve Cv P |L\u2206v |,\nwhich crosses each toric divisor of Torp\u2206v q at one point, where it is nonsingular, and\nwhich passes through the two points inip\u03c8 \u00011 p\u03b3 qq. Observe that by [15, Lemma 2.4],\nup to a constant factor there are precisely |\u2206v | polynomials fv as above (though the\nassertion and the proof of [15, Lemma 2.4] are restricted to the real case, it works\nwell in the same manner in the complex case regardless the parity of the side length\nof \u2206v ).\n(iii) Edges emanating from a vertex v P \u03930 X G0 do not contain any other point of\nG due to the \u2206-general position, and we define polynomials fe for them by formula\n(22) where \u03be, \u03b7 are the (quasihomogeneous) coordinates of the intersection point of\nCv with Torp\u03c3 q, \u03c3 being the side of \u2206v orthogonal to hpeq.\n\n(iv) Pick a connected component K of \u0393zG and orient it as in Lemma 3(ii). Then\nwe inductively define polynomials for the vertices and closed edges of K: In each\nstage we define polynomials fv and fe for a vertex v and a simple closed edge e\nemanating from v, whereas the polynomials fe1 for all the edges e1 of K merging to\nv are given. Each of the latter polynomials defines a point on TorpB \u2206v q, and these\npoints are distinct. We denote their set by X. Then we choose a polynomial fv px, y q\nwith Newton triangle \u2206v defining an irreducible rational curve Cv \u0080 Torp\u2206v q which\n\u2022 is nonsingular along TorpB \u2206v q,\n\u2022 crosses TorpB \u2206v q at each point z P X with multiplicity w pe1 q, where the edge\n1\ne1 P \u0393 merging to v is associated with a polynomial fe1 which determines the\npoint z,\n\u2022 crosses TorpB \u2206v qzX at precisely one point z0 .\nNotice that z0 is the unique intersection point of Cv with the toric divisor\nTorp\u03c3 q \u0080 Torp\u2206v q, where \u03c3 is orthogonal to hpeq, and pCv \u0004 Torp\u03c3 qqz0 \u0010 w peq. We\nclaim that up to a constant factor there are precisely M pQ, v q polynomials fv as\nrequired.\nThe case of a trivalent vertex v was considered in Step 1. In general, observe\nthat the set of the required curves is finite, since we impose\n\npCv \u0004 TorpB\u2206v qq \u0001 1 \u0010 \u0001Cv KTorp\u2206 q \u0001 1\nconditions on the rational curves Cv P |L\u2206 |, and the conditions are independent by\nv\n\nv\n\nRiemann-Roch. The cardinality of this set does not depend neither on the choice\n25\n\n\fof a generic configuration of fixed points on TorpB \u2206v q, nor on the choice of an\nalgebraically closed ground field of characteristic zero. Thus, we consider the field\nK and pick the fixed points on TorK pB \u2206v q so that the valuation takes them injectively\nto a \u2206v -generic configuration in B R2\u2206v . Then the rule (M5) and the construction\nin Step 1 provide M pQ, v q curves as required. The fact that there are no other\ncurves in consideration follows from a slightly modified Mikhalkin's correspondence\ntheorem (for detail, see, for instance, [18]).\n\nWe then define fe px, y q via (22) with \u03be, \u03b7 the (quasihomogeneous) coordinates of\nz0 in Torp\u03c3 q.\nSummarizing we deduce that the number of choices of the curves Cv , v\n1\nCe , e P \u0393 , equals\n1\nM pQ, v q .\n\nP \u03930 , and\n\nP\n\nv \u03930\n\nStep 4. Now we define the limit curves, the deformation patterns, and the refined\nconditions to pass through fixed points.\n\nFor each polygon \u2206k of the subdivision S of \u2206, the limit curve Ck \u0080 Torp\u2206k q\nis defined by the product of the constructed above polynomials fv , fe corresponding\nto the summands in the decomposition (6) of \u2206k .\nThe deformation pattern for each edge e\nthe way described in Step 1.\n\nP \u03931 such that wpeq \u00a1 1 is defined in\n\nAt last, the condition to pass through a given point q P q such that \u03b3 \u0010 \u03c8 pq q P G\n1\nlies in the interior of an edge e P \u0393 with w peq \u00a1 1, admits a refinement (see [13,\nSection 5.4] and [7, Section 2.5.9]) which in its turn is defined up to the choice of a\n1\nw peq-th root of unity, where e P \u0393 contains \u03b3.\nSo, the total number of choices we made up to now is\n1\nv\n\nP\n\n\u03930\n\nM pQ, v q \u0004\n\n1\ne\n\nP\n\nM pQ, eq \u0004\n\n\u03931\n\n1\n\nP\n\nM pQ, \u03b3 q \u0010 M pQq .\n\n\u03b3 G\n\nStep 5. Let us verify the hypotheses of the patchworking theorem from [13, 16].\nFirst requirement to the limit curves (see [13], conditions (A), (B), (C) in section\n5.1, or [16], conditions (C1), (C2) in section 2.1) is ensured by the generic choice\nof inipq q, q P q. Namely, the limit curves do not contain multiple non-binomial\ncomponents (i.e. defined by polynomials with nondegenerate Newton polygons),\nany two distinct components of any limit curve Ck \u0080 Torp\u2206k q intersect transversally\nat non-singular points which all lie in the big torus pC\u0006 q2 \u0080 Torp\u2206k q, and, finally,\nthe intersection points of any component of a limit curve Ck with TorpB \u2206k q are\nnon-singular.\nThe main requirement is the transversality condition for the limit curves and\ndeformation patterns (see [13, Section 5.2] and [16, Section 2.2]), which is relative\nto the choice of an orientation of the edges of the underlying tropical curve. In\n26\n\n\f[13, 16], one considers an orientation of edges of the embedded plane tropical curve\n(cf. section 2.2), which in our setting is just h\u0006 pQq \u0080 R2 . Here we consider the\norientation of the edges of the connected components of \u0393zG as defined in Lemma\n3(ii). Since this orientation does not define oriented cycles and since the intersection\npoints of distinct components of any limit curve with the toric divisors are distinct,\nthe proof of [13, Theorem 5] and [16, Theorem 2.4] with the orientation of \u0393 is a\nword-for-word copy of the proof with the orientation of hp\u0393q. Moreover, comparing\nwith [13, 16], here we impose extra conditions to pass through the points inipq q,\nq P q.\nThe deformation patterns are transversal in the sense of [13, Definition 5.2],\ndue to [13, Lemma 5.5(ii)], where both the inequalities hold, since the deformation\npatterns are nodal ([13, Lemma 3.9]), and thus do not contribute to the left-hand\nside of the inequalities, whereas their right-hand sides are positive.\n\nThe transversality of a limit curve Ck \u0080 \u03a3k :\u0010 Torp\u2206k q in the sense of [13,\nDefinition 5.1] means the triviality (i.e. zero-dimensionality) of the Zariski tangent\nspace at Ck to the stratum in |L\u2206k | formed by the curves which split into the same\nnumber of rational components as Ck (i.e. the components of Ck do not glue up\nwhen deforming along such a stratum) each of them having the same number of\nintersection points with TorpB \u2206k q as the respective component of Ck and with the\nsame intersection number, and such that all but one of these intersection points\nare fixed. In other words the conditions imposed on each of the components of Ck\ndetermine a stratum with the one-point Zariski tangent space. Indeed, the above\nfixation of intersection numbers of a component C 1 of Ck and all but one intersection\npoints of C 1 with TorpB \u2206k q imposed \u0001C 1 K\u03a3k \u00011 conditions which all are independent\ndue to Riemann-Roch on C 1 .\nThus, [13, Theorem 5] applies, and each of the M pQq refined patchworking data\nconstructed above produces a curve C \u0080 TorK p\u2206q as asserted in Theorem 2.\n\nStep 6. Now we specialize the configuration q into p and prove that each of the\ncurves C P C 1 constructed above tends (in an appropriate topology) to some curve\n\u0108 P |L\u2206|.\nTo obtain the required limits, we introduce a suitable topology. Since the variation of q does not affect its valuation image, the same holds for the (variable) curves\nC 1 P C 1 , and hence one can fix once forever the function \u03bd : \u2206 \u00d1 R. Then, writing\neach coordinate of any point q P q as X \u0010 t\u0001ValpX q \u03a8q,X ptq and each coefficient of\nthe defining polynomials of C as A\u03c9 \u0010 t\u03bd p\u03c9q \u03a8\u03c9 ptq, and, assuming (without loss of\ngenerality) that all the exponents of t in the above coordinates and coefficients are\nintegral, we deal with the following topology in the space of the functions \u03c8\u03c9 ptq\nholomorphic in a neighborhood of zero: Take the C 0 topology in each subspace\nconsisting of the functions convergent in |t| \u00a4 \u03b5 and then define the inductive limit\ntopology in the whole space.\nq\n\nSo, we assume that the variation of q reduces to only variation of inipq q,\nwhereas the reminders of the corresponding series in t stay un-\n\nP q X pK\u0006 q2,\n\n27\n\n\fchanged.\n\nTo show that that the families of the curves C P C 1 have limits, we recall that their\ncoefficients appear as solutions to a system of analytic equations, which is soluble\nby the implicit function theorem due to the transversality of the initial (refined)\npatchworking data (cf. [13, 16]). Thus, to confirm the existence of the limits of the\ncurves C P C 1 , it is sufficient to show that the system of equations and the (refined)\npatchworking data have limits and the latter limit is transverse. In particular, we\nshall obtain that, in each coefficient A\u03c9 \u0010 t\u03bd p\u03c9q \u03a8\u03c9 ptq, \u03c9 P \u2206 X Z2 , the factor \u03a8\u03c9\nconverges uniformly in the family.\nWe start with analyzing the specialization of limit curves. Since the given tropical\n1\ncurve Q stays the same, we go through the curves Cv , v P \u03930 , and Ce , e P \u0393 .\n1\nClearly, the curves Ce , e P \u0393 , keep their form (22) with the parameters \u03be, \u03b7 possibly\nchanging as inipq q tends to inippq, p P p. Similarly, the curves Cv corresponding to\nthe vertices v P \u03930 of valency 3 remain as described in Step 1, i.e. nodal nonsingular\nalong TorpB \u2206v q, and crossing each toric divisor at one point. Furthermore, the\ncurves Cv corresponding to the non-special vertices v P \u03930 of valency \u00a1 3, remain\nas described in Step 3, paragraph (iv), since the intersection points of Cv with the\ntoric divisors which correspond to the edges of \u0393, merging to v, do not collate and\nremain generic in the specialization as they are not affected by possible collisions\nof the points inipq q, q P q. So, let us consider the case of a special vertex v P \u03930 .\nBy (T4) Cv cannot split into proper components, and hence specializes into an\nirreducible rational curve. Furthermore, the intersection points of Cv with the toric\ndivisors which correspond to the special edges may collate forming singular points,\ncenters of several smooth branches. So, finally, the transversality conditions for\nsuch a curve reduce to the fact, that the Zariski tangent space at Cv to the stratum\nin |L\u2206v | consisting of rational curves with given intersection points along the two\ntoric divisors which are related to the oriented edges of \u0393 merging to v, is zerodimensional. This is precisely the same stratum conditions as in Step 5, and the\nargument of Step 5 (Riemann-Roch on the rational curve Cv ) shows that all the\n\u0001Cv KTorp\u2206v q \u0001 1 conditions defining the stratum in the Severi variety parameterizing\nthe rational curves in |L\u2206v | are independent.\nNext, we notice that by assumption (T4) the possible collision of intersection\npoints of Cv with TorpB \u2206v q concerns only transverse intersection points (i.e. those\nwhich correspond to edges of weight 1), and hence does not affect neither the deformation patterns, nor the refined conditions to pass through p. Thus, each of the\ncurves C P C 1 degenerates into some curve \u0108 P |L\u2206 | which is given by polynomial\nwith coefficients A\u03c9 \u0010 t\u03bd p\u03c9q \u03a8\u03c9 ptq, \u03c9 P \u2206, containing factors \u03a8\u03c9 convergent uniformly\nin some neighborhood of 0 in C.\nRemark 11 (1) Observe that the genus of \u0108 does not exceed the genus of C.\n(2) Notice also that there is no need to study refinements of possible singular points appearing in the above collisions of the intersection points of Cv with\nTorpB \u2206v q. Indeed, the number of the transverse conditions we found equals the\nnumber of parameters - hence no any extra ramification is possible.\n28\n\n\fStep 7. Next we show that, at each point p\ncurve \u0108 has \u03bcppq local branches.\n\nP p with \u03bcppq \u00a1 1, the obtained\n\nConsidering the point p P pK\u0006 q2 as a family of points pptq P pC\u0006 q2 , t \u0018 0, we\nclaim that the curves \u0108 ptq \u0080 Torp\u2206q have \u03bcppq branches at pptq , t \u0018 0. For, we\nwill describe how glue up the limit curves forming \u0108 p0q when \u0108 p0q deforms into \u0108 ptq ,\nt \u0018 0. Our approach is to compare the above gluing with the gluing of the limit\ncurves in the deformation of C p0q into C ptq , t \u0018 0, where C P C 1 passes through the\nconfiguration q, and the comparison heavily relies on the one-to-one correspondence\nbetween the limit curves of \u0108 and C P C 1 established in Step 6.\nLet q 1 , ..., q s be all the points of the configuration q which appear in the dissipation of the point p P p (cf. Step 2), and let \u03b3i \u0010 \u03c8 pq i q, i \u0010 1, ..., s, be the\ncorresponding marked points on \u0393 so that \u03b3i P ei P \u03931 , i \u0010 1, ..., s. If the edges\nhpei q, hpej q intersect transversally at V \u0010 hp\u03b3i q \u0010 hp\u03b3j q, then V is a vertex of\nthe plane tropical curve h\u0006 pQq dual to a polygon \u2206V of the corresponding subdivision of \u2206. The components Ci , Cj \u0080 Torp\u2206V q the curve C p0q passing through\ninipq i q, inipq j q P pC\u0006 q2 \u0080 Torp\u2206V q, respectively, intersect transversally in pC\u0006 q2 , and\ntheir intersection points in pC\u0006 q2 do not smooth up in the deformation C ptq , t \u0018 0,\nand the same holds for the corresponding components \u0108i , \u0108j of \u0108 p0q meeting at\ninippq P pC\u0006 q2 \u0080 Torp\u2206V q, since the smoothing out of an intersection point inippq\nof \u0108i and \u0108j would raise the genus of \u0108 above the genus of C contrary to Remark\n11. Suppose that, in the above notation, hpei q and hpej q lie on the same straight\nline, but ei , ej have no vertex in common (see Figure 3(a)). We consider the case of\nfinite length edges ei , ej ; the case of ends can be treated similarly. Let vi , vi1 be the\nvertices of ei , and vj , vj1 be the vertices of ej . Their dual polygons \u2206vi , \u2206vi1 , \u2206vj , \u2206vj1\n(see section 2.2) have sides Ei , Ei1 , Ej , Ej1 orthogonal to hpei q. In the deformation\nC p0q \u00d1 C ptq , t \u0018 0, the limit curves Ci \u0080 Torp\u2206vi q and Ci1 \u0080 Torp\u2206vi1 q passing\nptq\nthrough inipq i q P TorpEi q \u0010 TorpEi1 q glue up forming a branch centered at q i ,\nand similarly the limit curves Cj \u0080 Torp\u2206vj q and Cj1 \u0080 Torp\u2206vj1 q passing through\n\nptq\n\ninipq j q P TorpEj q \u0010 TorpEj1 q glue up forming a branch centered at q j . The same\nhappens when C specializes into \u0108, q i , q j specialize into p, since again the aforementioned restriction g p\u0108 q \u00a4 g pC q does not allow the limit curves \u0108i , \u0108i1 glue up\nwith the limit curves \u0108j , \u0108j1 .\n\nThe remaining case to study is given by the tropical data described in condition\n(T7), section 3.1. Without loss of generality we can assume that all the edges e1 , ..., es\nhave a common vertex v and their h-images lie on the same line (see an example\nin Figure 3(b)). Applying an appropriate invertible integral-affine transformation,\nwe can make the edges e1 , ..., es horizontal and the point x \u0010 Valppq P R2 to be the\norigin. Correspondingly, v \u0010 p\u0001\u03b1, 0q, vi \u0010 p\u03b1i , 0q, i \u0010 1, ..., s, with 0 \u03b11 \u00a4 ... \u00a4\n\u03b1s \u00a4 8 and\n \u0327\n\u03b1\u00a1\n\u03b1i 2\u03b1s\u00011 .\n(23)\n\n\u00a4\n\n\u0001\n\n1 i s 1\n\nIn what follows we suppose that \u03b1s\ntreatment as the case of finite \u03b1s \" \u03b1.\n\n8.\n\n29\n\nThe case \u03b1s\n\n\u00108\n\nadmits the same\n\n\f\u274d\u274d\n\u274d\n\nv\n\ne1\ne\n\n\u274d\u274d\n\u274d\n\ne1\nes\n\nv\n\n\u03b31 \u03b3\n\n(a)\n\nvs\n\n(b)\n\n\u273b\n\ns\n\n\u03b31 v1\n\u03b3s\n\n\u273b\n\ns\n\n\u2702\u2745\n\u2702 \u2745\n\u2702\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2745\n\u2701\u2702\n\ns\n\n\u2732\n\n\u2702\u2745\n\u2702 \u2745\n\u2702\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2702\u2701\n\u2745\n\u2745\n\u2701\u2702\n\n1\n\ns\n\n(c)\n\n\u2732\n\n1\n\n(d)\n\nFigure 3: Illustration to Step 7 of the proof of Theorem 2\n\n30\n\n\fLet q i \u0010 \u03c8 \u00011 p\u03b3i q, 1 \u00a4 i \u00a4 s, be the points of the configuration q which appear\nin the deformation of the point p described in Step 2. Our assumptions yield that\np \u0010 p\u03be\n\nO pt\u00a10 q, \u03b7\n\nO pt\u00a10 qq,\n\nqi\n\n\u0010 p\u03bei\n\nO pt\u00a10 q, \u03b7i\n\nO pt\u00a10 qq, i \u0010 1, ..., s ,\n\nwith some \u03be, \u03b7 P C\u0006 , \u03bei close to \u03be, \u03b7i close to \u03b7, i \u0010 1, ..., s. Furthermore, the triangles\n\u2206v and \u2206vi dual to the vertices v and vi , 1 \u00a4 i \u00a4 s, respectively, have vertical edges\n\u03c3 \u0080 B \u2206v and \u03c3i \u0080 B \u2206vi , 1 \u00a4 i \u00a4 s, along which the function \u03bd (see section 2.2) is\nconstant. By assumptions (T4)-(T6), the limit curve Cv \u0080 Torp\u2206v q crosses the toric\ndivisor Torp\u03c3 q at the points \u03b71 , ..., \u03b7s with the total intersection multiplicity s, and\neach of the limit curves Cvi \u0080 Torp\u2206vi q, 1 \u00a4 i \u00a4 s, crosses the toric divisor Torp\u03c3i q\nat the unique point \u03b7i transversally, and the corresponding limit curve \u0108vi crosses\nTorp\u03c3i q at the point \u03b7 transversally, too.\nNow we move the points q 1 , ..., q s keeping their x-coordinates and making\n\npq1qy \u0010 ... \u0010 pqsqy \u0010 ppqy . As shown in Step 6, the curve C (depending on q1, ..., qs)\n\nconverges to a curve C 1 with the same Newton polygon, genus, and tropicalization,\nand the limit curves of C component-wise converge to limit curves of C 1 . Consider\nnow the polynomial Fr px, y q :\u0010 F 1 px, y ppqy q, where the polynomial F 1 px, y q defines\nthe curve C 1 . As in the refinement procedure described in [13, Section 3.4] or [7,\nr of Fr contains the fragment\nSection 2.5.8], the subdivision of the Newton polygon \u2206\nbounded by the triangle \u03b4 \u0010 convtp0, 0q, p1, sq, ps 1, 0qu (see Figure 3(d)) which\nr \u00d1 R takes the\nmatches the points q 1 , ..., q s . The corresponding function \u03bdr : \u2206\nvalues\n\u03bdrp0, 0q \u0010 \u03b1,\n\n\u03bdrp1, sq \u0010 0,\n\n\u03bdrpk, s\n\n1 \u0001 kq \u0010\n\n \u0327\n\n\u00a4\n\n\u03b1i , k\n\n\u0010 2, ..., s\n\n1,\n\n1 i k\n\nalong the incline part of B \u03b4. The tropical limit of Fr restricted to the above fragment\nconsists of a subdivision of \u03b4, determined by some extension of the function \u03bdr inside\n\u03b4, and of limit curves which must meet the following conditions:\n- these limit curves glue up into a rational curve (with Newton triangle \u03b4), since,\nin the original tropical curve, the spoken fragment corresponds to a tree (see Figure\n3(b));\n\n- the intersection points q of the curve C\u03b4 :\u0010 tFr\u03b4 \u0010 0u with the line x \u0010 ppqx\nsuch that Valpq qy \u00a4 0 converge to p as q 1 , ..., q s tend to p, where Fr\u03b4 is the sum of\nthe monomials of Fr matching the set \u2206 X Z2 , and the convergence is understood in\nthe topology of Step 6;\nr of length s lying inside the edge\n- the subdivision of \u03b4 contains a segment \u03c3\nrp0, 0q, ps 1, 0qs, along which the function \u03bdr is constant and such that the correrq intersects with the limit curves at the points \u03be1 , ..., \u03bes .\nsponding toric divisor Torp\u03c3\n\nThese restrictions and inequality (23) leave only one possibility the subdivision\nof \u03b4 shown in Figure 3(c,d) (the subdivision (c) for the case \u03b1 \u00a1 \u03b11 ... \u03b1s , and\nthe subdivision (d) for the case \u03b1 \u03b11 ... \u03b1s ). The limit curve C\u03b41 \u0080 Torp\u03b4 1 q for\na triangle \u03b4 1 \u0080 \u03b4 having a horizontal base splits into H p\u03b4 q distinct straight lines (any\n31\n\n\fof them crossing each toric divisor at one point), where H p\u03b4 1 q is the height. The\nlimit curve C\u03b41 \u0080 Torp\u03b4 1 q for a trapeze \u03b4 1 \u0080 \u03b4 splits into H p\u03b4 1 q straight lines as above\nand the suitable number of straight lines x \u0010 const (which reflect the splitting of the\ntrapeze into the Minkowski sum of a triangle with a horizontal segment). All the\nlimit curves are uniquely defined by the intersections with the toric divisors Torp\u03c3 1 q\nfor incline segments \u03c3 1 (in our construction, these data are determined by the points\nq ztq 1 , ..., q s u and by the condition pq 1 qy \u0010 ... \u0010 pq s qy \u0010 0) and by intersections with\nTorp\u03c3\nrq introduced above. When q 1 , ..., q s tend to p, the subdivision of \u03b4 remains\nunchanged, whereas the limit curves naturally converge component-wise. Then we\nimmediately derive that components of the limit curves passing through inippq do not\nglue up together in the deformation \u0108 ptq , t P pC, 0q, since otherwise the (geometric)\ngenus of \u0108 ptq , t \u0018 0, would jump above the genus of C which is impossible (see\nRemark 11).\nStep 8. By assumption (A5), section 3.1, the curves \u0108 \u0080 TorK p\u2206q are immersed,\nirreducible, of genus g, have multiplicity \u03bcppq at each point p P p XpK\u0006 q2 , and satisfy\nthe tangency conditions with TorK pB \u2206q as specified in the assertion of Theorem 2.\nIt remains to show that we have constructed precisely M pQq curves \u0108.\n\nIndeed, condition (16) implies that, for any dissipation of each point p P p XpK\u0006 q2\ninto \u03bcppq distinct points there exists a unique deformation of \u0108 into a curve C P C\nsuch that a priori prescribed branches of \u0108 at p will pass through prescribed points\nof the dissipation.\n\nFinally, we notice that the sets C pQ\u03021 q and C pQ\u03022 q are disjoint for distinct (nonisomorphic PPT-curves Q\u03021 , Q\u03022 . Indeed, the collections of limit curves as constructed\nin Steps 1 and 3 appear to be distinct for distinct curves Q\u03021 and Q\u03022 and the given\nl\nconfiguration p.\n\n3.5\n\nProof of Theorem 3\n\nThe curves C P RC pQ\u0302q constructed in the proof of Theorem 2 are immersed, and\nhence the formula (1) for the Welschinger weight applies, thus the left-hand side of\n(21) is well defined.\nNext we go through the proof of Theorem 2 counting the contribution to the\nright-hand side of (21).\nFirst, we deform the configuration p as described in Step 2, assuming that the\ndeformed configuration q is Conj-invariant and that the map \u03c8 : q \u00d1 G sends\nRq \u0010 q X FixpConjq to RG and sends Iq \u0010 q zRq to IG, respectively. In particular,\nif p P Rp, and the points Valppq is an image of r points of RG X R\u0393 and s pairs\nof points of RG X I\u0393, then p deforms into r real points and s pairs of imaginary\nconjugate points.\nNotice that the replacement of p by q causes a change of sign in the left-hand\nside of (21) and of the quantity of the real curves in count in the right-hand side of\n32\n\n\f(21). Right now we explain the change of sign: the dissipation of a real point p as in\nthe preceding paragraph means that, for each curve C P C 1 we count r real solitary\nnodes more in a neighborhood of p, since in the non-deformed situation, the point\np should be blown up for the computation of the Welschinger sign. This change is\nreflected in the sign p\u00011ql1 , l1 \u0010 |RG X I\u0393|{2, in the right-hand side of formula\n(10).\nNext we follow the procedure in Steps 3 and 4 of the proof of Theorem 2 and construct Conj-invariant collections of limit curves, deformation patterns, and refined\nconditions to pass through fixed points:\n\u2022 by [13, Proposition 8.1(i)] the existence of an even weight edge e P \u03931 , e \u0080 R\u0393\nannihilates the contribution to the Welschinger number, and hence by (R7)(v)\nwe can assume that all the edges e \u0080 R\u0393 have odd weight, in particular, with\nthe finite length edges e \u0080 R\u0393 one can associate a unique real deformation\npattern with an even number of solitary nodes (cf. [15, Lemma 2.3]),\n\u2022 the limit curves associated with the vertices of R\u0393 contribute as designated in\nrules (W2)-(W4) in section 2.6 (cf. [15, Lemmas 2.3, 2.4, and 2.5]),\n\u2022 the construction of limit curves and deformation patterns associated with the\n1\nvertices and edges of I\u0393 (a half of I\u0393), contributes as designated in rules\n(W1) -(W3) (cf. with the complex formulas in the proof of Theorem 2 and\n2\nwith [15, Section 2.5]), accordingly, the data associated with I\u0393 are obtained\nby the conjugation,\n\u2022 the refinement of the condition to pass through fixed points contributes as\ndesignated in rule (W2) as we have a unique refinement for \u03b3 P R\u0393 and w peq\n1\nrefinements for \u03b3 P e P I\u0393 .\nThe remaining step is to explain the factor 2l2 , l2 \u0010 p|IG X I\u0393| \u0001 b0 pI\u0393qq{2,\nin formula (10). Indeed, when constructing the limit curves associated with the\n1\nvertices of I\u0393 , we start with the respective fixed points which all are imaginary in\n1\nthe configuration q, and thus we choose a point in each of the |G X I\u0393 | \u0010 |G X I\u0393|{2\npairs of the corresponding points in q. Observe that, in the degeneration q \u00d1 p,\n|RG X I\u03931| pairs of imaginary points of q merge to real points in p, which leaves\nonly |IG X I\u0393|{2 choices in the original configuration p. After all, we factorize by\nthe interchange of the components of I\u0393, coming to the required factor 2l2 .\nl\n\nReferences\n[1] Gathmann, A., and Markwig, H.: The numbers of tropical plane curves through\npoints in general position. J. reine angew. Math. 602 (2007), 155\u2013177.\n\n33\n\n\f[2] Greuel, G.-M., and Karras, U.: Families of varieties with prescribed singularities. Compos. math. 69 (1989), no. 1, 83\u2013110.\n[3] Greuel, G.-M., and Lossen, C.: Equianalytic and equisingular families of curves\non surfaces. Manuscripta math. 91 (1996), no. 3, 323\u2013342.\n[4] Itenberg, I. V., Kharlamov, V. M., and Shustin, E. I.: Logarithmic equivalence of Welschinger and Gromov-Witten invariants. Russian Math. Surveys 59\n(2004), no. 6, 1093\u20131116.\n[5] Itenberg, I. V., Kharlamov, V. M., and Shustin, E. I.: New cases of logarithmic\nequivalence of Welschinger and Gromov-Witten invariants. Proc. Steklov Math.\nInst. 258 (2007), 65-73.\n[6] Itenberg, I., Kharlamov, V., and Shustin, E.: Recursive formulas and logarithmic asymptotics of Welschinger invariants of real non-toric Del Pezzo surfaces,\nin preparation.\n[7] Itenberg, I., Mikhalkin, G., and Shustin, E.: Tropical algebraic geometry/ Oberwolfach seminars, vol. 35. Birkhauser, 2007.\n[8] Mikhalkin, G.: Decomposition into pairs-of-pants for complex algebraic hypersurfaces. Topology 43 (2004), 1035\u20131065.\n[9] Mikhalkin, G.: Enumerative tropical algebraic geometry in R2 . J. Amer. Math.\nSoc. 18 (2005), 313\u2013377.\n[10] Nishinou, T., and Siebert, B.: Toric degenerations of toric varieties and tropical\ncurves. Duke Math. J. 135 (2006), no. 1, 1\u201351.\n[11] Orevkov, S., and Shustin, E.: Pseudoholomorphic, algebraically unrealizable\ncurves. Moscow Math. J. 3 (2003), no. 3, 1053\u20131083.\n[12] Richter-Gebert, J., Sturmfels, B., and Theobald, T.: First steps in tropical\ngeometry. Idempotent mathematics and mathematical physics, Contemp. Math.\n377, Amer. Math. Soc., Providence, RI, 2005, pp. 289\u2013317.\n[13] Shustin, E.: A tropical approach to enumerative geometry. Algebra i Analiz\n17 (2005), no. 2, 170\u2013214 (English translation: St. St. Petersburg Math. J. 17\n(2006), 343\u2013375).\n[14] Shustin, E.: On manifolds of singular algebraic curves. Selecta Math. Sov. 10,\nno. 1, 27\u201337 (1991).\n[15] Shustin, E.: A tropical calculation of the Welschinger invariants of real toric\nDel Pezzo surfaces. J. Alg. Geom. 15 (2006), no. 2, 285\u2013322 (corrected version\nat arXiv:math/0406099).\n\n34\n\n\f[16] Shustin, E.: Patchworking construction in the tropical enumerative geometry.\nSingularities and Computer Algebra, C. Lossen and G. Pfister, eds., Lond. Math.\nSoc. Lec. Notes Ser. 324, Proc. Conf. dedicated to the 60th birthday of G.-M.\nGreuel, Cambridge Univ. Press, 2006, pp. 273\u2013300.\n[17] Shustin, E.: Welschinger invariants of toric Del Pezzo surfaces with nonstandard real structures. Proc. Steklov Math. Inst. 258 (2007), 219\u2013247.\n[18] Shustin, E.: New enumerative invariants and correspondence theorems for plane\ntropical curves, in preparation.\n[19] Viro, O. Ya.: Gluing of plane real algebraic curves and construction of curves\nof degrees 6 and 7. Lect. Notes Math. 1060, Springer, Berlin etc., 1984, pp.\n187\u2013200.\n[20] Viro, O. Ya.: Real algebraic plane curves: constructions with controlled topology. Leningrad Math. J. 1 (1990), 1059\u20131134.\n[21] Viro, O. Ya.:\nPatchworking Real Algebraic Varieties. Preprint at\narXiv:math/0611382.\n[22] Viro, O.: Dequantization of Real Algebraic Geometry on a Logarithmic Paper. Proceedings of the 3rd European Congress of Mathematicians, Birkh\u00e4user,\nProgress in Math. 201, (2001), 135\u2013146.\n[23] Welschinger, J.-Y.: Invariants of real symplectic 4-manifolds and lower bounds\nin real enumerative geometry. Invent. Math. 162 (2005), no. 1, 195\u2013234.\nSchool of Mathematical Sciences\nRaymond and Beverly Sackler Faculty of Exact Sciences\nTel Aviv University\nRamat Aviv, 69978 Tel Aviv, Israel\n\nE-mail address: shustin@post.tau.ac.il\n\n35\n\n\f"}