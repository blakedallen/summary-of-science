{"id": "http://arxiv.org/abs/0904.1526v1", "guidislink": true, "updated": "2009-04-09T13:33:56Z", "updated_parsed": [2009, 4, 9, 13, 33, 56, 3, 99, 0], "published": "2009-04-09T13:33:56Z", "published_parsed": [2009, 4, 9, 13, 33, 56, 3, 99, 0], "title": "Kingman's coalescent and Brownian motion", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0904.2652%2C0904.3461%2C0904.1950%2C0904.0118%2C0904.3685%2C0904.4412%2C0904.4106%2C0904.1271%2C0904.3123%2C0904.4182%2C0904.3201%2C0904.4248%2C0904.1643%2C0904.1674%2C0904.2858%2C0904.3119%2C0904.1485%2C0904.1526%2C0904.3663%2C0904.4108%2C0904.3125%2C0904.4405%2C0904.1576%2C0904.0038%2C0904.2849%2C0904.0012%2C0904.4140%2C0904.3098%2C0904.1063%2C0904.2483%2C0904.0370%2C0904.1290%2C0904.2865%2C0904.2025%2C0904.2211%2C0904.3005%2C0904.0860%2C0904.3995%2C0904.3272%2C0904.3626%2C0904.1488%2C0904.2206%2C0904.2184%2C0904.0113%2C0904.2078%2C0904.3803%2C0904.1626%2C0904.4280%2C0904.2920%2C0904.0315%2C0904.2614%2C0904.1637%2C0904.3992%2C0904.3538%2C0904.0099%2C0904.2510%2C0904.0452%2C0904.2079%2C0904.2067%2C0904.0309%2C0904.1525%2C0904.3180%2C0904.1859%2C0904.4842%2C0904.2890%2C0904.0447%2C0904.4528%2C0904.1316%2C0904.1115%2C0904.3888%2C0904.3529%2C0904.1059%2C0904.1395%2C0904.2266%2C0904.4164%2C0904.0112%2C0904.0985%2C0904.3220%2C0904.0692%2C0904.2774%2C0904.0240%2C0904.4188%2C0904.0390%2C0904.0718%2C0904.1972%2C0904.3936%2C0904.3563%2C0904.2482%2C0904.4381%2C0904.0200%2C0904.4112%2C0904.2495%2C0904.3606%2C0904.0905%2C0904.1081%2C0904.3941%2C0904.0144%2C0904.4493%2C0904.4905%2C0904.4279%2C0904.3181&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Kingman's coalescent and Brownian motion"}, "summary": "We describe a simple construction of Kingman's coalescent in terms of a\nBrownian excursion. This construction is closely related to, and sheds some new\nlight on, earlier work by Aldous and Warren. Our approach also yields some new\nresults: for instance, we obtain the full multifractal spectrum of Kingman's\ncoalescent. This complements earlier work on Beta-coalescents by the authors\nand Schweinsberg. Surprisingly, the thick part of the spectrum is not obtained\nby taking the limit as $\\alpha \\to 2$ in the result for Beta-coalescents\nmentioned above. Other analogies and differences between the case of\nBeta-coalescents and Kingman's coalescent are discussed.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0904.2652%2C0904.3461%2C0904.1950%2C0904.0118%2C0904.3685%2C0904.4412%2C0904.4106%2C0904.1271%2C0904.3123%2C0904.4182%2C0904.3201%2C0904.4248%2C0904.1643%2C0904.1674%2C0904.2858%2C0904.3119%2C0904.1485%2C0904.1526%2C0904.3663%2C0904.4108%2C0904.3125%2C0904.4405%2C0904.1576%2C0904.0038%2C0904.2849%2C0904.0012%2C0904.4140%2C0904.3098%2C0904.1063%2C0904.2483%2C0904.0370%2C0904.1290%2C0904.2865%2C0904.2025%2C0904.2211%2C0904.3005%2C0904.0860%2C0904.3995%2C0904.3272%2C0904.3626%2C0904.1488%2C0904.2206%2C0904.2184%2C0904.0113%2C0904.2078%2C0904.3803%2C0904.1626%2C0904.4280%2C0904.2920%2C0904.0315%2C0904.2614%2C0904.1637%2C0904.3992%2C0904.3538%2C0904.0099%2C0904.2510%2C0904.0452%2C0904.2079%2C0904.2067%2C0904.0309%2C0904.1525%2C0904.3180%2C0904.1859%2C0904.4842%2C0904.2890%2C0904.0447%2C0904.4528%2C0904.1316%2C0904.1115%2C0904.3888%2C0904.3529%2C0904.1059%2C0904.1395%2C0904.2266%2C0904.4164%2C0904.0112%2C0904.0985%2C0904.3220%2C0904.0692%2C0904.2774%2C0904.0240%2C0904.4188%2C0904.0390%2C0904.0718%2C0904.1972%2C0904.3936%2C0904.3563%2C0904.2482%2C0904.4381%2C0904.0200%2C0904.4112%2C0904.2495%2C0904.3606%2C0904.0905%2C0904.1081%2C0904.3941%2C0904.0144%2C0904.4493%2C0904.4905%2C0904.4279%2C0904.3181&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We describe a simple construction of Kingman's coalescent in terms of a\nBrownian excursion. This construction is closely related to, and sheds some new\nlight on, earlier work by Aldous and Warren. Our approach also yields some new\nresults: for instance, we obtain the full multifractal spectrum of Kingman's\ncoalescent. This complements earlier work on Beta-coalescents by the authors\nand Schweinsberg. Surprisingly, the thick part of the spectrum is not obtained\nby taking the limit as $\\alpha \\to 2$ in the result for Beta-coalescents\nmentioned above. Other analogies and differences between the case of\nBeta-coalescents and Kingman's coalescent are discussed."}, "authors": ["J. Berestycki", "N. Berestycki"], "author_detail": {"name": "N. Berestycki"}, "author": "N. Berestycki", "links": [{"href": "http://arxiv.org/abs/0904.1526v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0904.1526v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "60J25; 60G15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0904.1526v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0904.1526v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0904.1526v1 [math.PR] 9 Apr 2009\n\nKingman's coalescent and Brownian motion.\nJulien Berestycki1 and Nathana\u00ebl Berestycki2\nDraft version - October 30, 2018\nAbstract\nWe describe a simple construction of Kingman's coalescent in terms\nof a Brownian excursion. This construction is closely related to, and\nsheds some new light on, earlier work by Aldous [3] and Warren [23].\nOur approach also yields some new results: for instance, we obtain the\nfull multifractal spectrum of Kingman's coalescent. This complements\nearlier work on Beta-coalescents by the authors and Schweinsberg [7].\nSurprisingly, the thick part of the spectrum is not obtained by taking\nthe limit as \u03b1 \u2192 2 in the result for Beta-coalescents mentioned above.\nOther analogies and differences between the case of Beta-coalescents\nand Kingman's coalescent are discussed.\n\n1. julien.berestycki@upmc.fr. Universit\u00e9 Paris VI - Pierre et Marie Curie,\nLaboratoire de Probabilit\u00e9s et Mod\u00e8les Al\u00e9atoires.\n2. N.Berestycki@statslab.cam.ac.uk. University of Cambridge, DPMMS, Statistical Laboratory.\n\n1\n\n\f1\n\nIntroduction and results\n\nLet (\u03a0t , t \u2265 0) be Kingman's coalescent. This is a Markov process taking its values\nin the set P of partitions of N = {1, . . .}, such that initially \u03a0(0) is the trivial\npartition composed exclusively of singletons, and such that each pair of blocks\nmerges at rate 1. Kingman's coalescent was introduced in 1982 by Kingman in his\nseminal paper [15]. A fascinating mathematical object in its own right, Kingman's\ncoalescent is also a cornerstone of mathematical population genetics, serving as\nthe basic model for genealogies in a well-mixed, selectively neutral population.\nIn this paper we provide a new, simple construction of Kingman's coalescent\nin terms of a Brownian excursion. We apply this construction to the study of some\nfine properties of this process, paying particular attention to its behaviour near\nthe beginning of time, when microscopic clusters coalesce into a finite number of\nmacroscopic ones. This phenomenon is known as coming down from infinity, and\nwe are able to describe the precise multifractal spectrum corresponding to clusters\nof atypical sizes at small times. Our construction is closely related to (and, in\nsome sense, almost implicit in) earlier work by Aldous [3], Warren [23] and others\n(see section 2 below). However, there are important differences, which will also be\ndiscussed in Section 2 (for instance, the aforementioned application could not have\nbeen deduced from these works). This paper complements the picture developed\nin [7] and [5] on the relation between coalescents, continuum random trees, and\nFleming-Viot type particle systems.\nWe now describe our construction of Kingman's coalescent. Let (Bt , t \u2265 0) be\nan excursion of Brownian motion conditioned to hit level 1. That is, let S\n\u03bd denote\n\u2217\nIt\u00f4's excursion measure on the space of continuous excursions \u03a9 := \u03b6>0 \u03a9\u03b6 ,\nwhere\n\u03a9\u03b6 := {f : [0, \u03b6] \u2192 R continuous, f (x) = 0 \u21d0\u21d2 x \u2208 {0, \u03b6}}.\n\nLet then (Bt , 0 \u2264 t \u2264 \u03b6) be a realization of \u03bd(*| sups>0 Bs \u2265 1). (With a slight\nabuse of notation, we may consider B to be a function defined on [0, \u221e) by declaring B(s) = 0 for all s \u2265 \u03b6.) Let {L(t, x)}t\u22650,x\u22650 denote a jointly continuous version\nof the local-time process of B, and define\nZx := L(\u03b6, x), x \u2265 0.\nThus Zx is the total local time accumulated at level x by the excursion (Bs , s \u2265 0).\nDefine a P-valued process (\u03a0u , 0 \u2264 u \u2264 1) as follows. Consider the set {\u03b5i }\u221e\ni=1 of\nexcursions of B above level 1, ordered according to their height: that is,\nsup \u03b51 (s) > sup \u03b52 (s) > . . .\ns>0\n\ns>0\n\nNow, fix 0 < u < 1, and consider the set of excursions {ek }1\u2264k\u2264N above level u\nreaching level 1, where N = N (u) is the number of such excursions. Note that for\n\n2\n\n\f\u03b52\n\n\u03b53\n\u03b54\n\nu\n\n\u03b51\n\n\u03b56 \u03b5\n5\n\n1\n\ne2\n\ne1\n\nFigure 1:\nConstruction in Theorem 1.\n({1, 2}, {3, 4, 5, 6}).\n\nIn this picture, we have:\n\n\u03a0u =\n\nevery i \u2265 1, \u03b5i belongs to exactly one excursion ek for some 1 \u2264 k \u2264 N , and let\n\u03c6u (i) = k \u2208 {1, . . . , N } be this index. Then define \u03a0u by declaring that for every\ni, j \u2265 1, i and j are in the same block of \u03a0u if and only if \u03c6u (i) = \u03c6u (j), that is,\nif and only if \u03b5i and \u03b5j fall into the same excursion ek for some k \u2264 N . Our main\nresult states that \u03a0u is in fact a time-change of Kingman's coalescent.\nTheorem 1. The process (\u03a0U (t) , t \u2265 0) has the same law as Kingman's coalescent,\nwhere for all t > 0,\n\u001b\n\u001a\nZ 1\n4\ndu > t .\n(1)\nU (t) = sup s > 0 :\ns Zu\nRemark 2.\n1. As the reader has surely guessed, the ordering of the excursions (\u03b5i )\u221e\ni=1 by\ntheir height is not crucial to this result, but is in the spirit of our use of the\nDonnelly-Kurtz lookdown approach (see section 3 and [7]).\n2. The time-change {U (t), t \u2265 0} satisfies the following properties: U (0) = 1,\nlimt\u2192\u221e U (t) = 0, and U is continuous and monotone decreasing.\n\n3\n\n\fAs promised at the beginning of this introduction, we now give some applications of Theorem 1 to the study of the small-time behaviour of Kingman's coalescent. Let (\u03bat , t \u2265 0) be Kingman's coalescent, and let\n1\n#{1 \u2264 i \u2264 n : i is in the same block as 1 in \u03bat }.\nn\u2192\u221e n\n\nF (t) = lim\n\n(2)\n\nF (t) is the frequency of the block containing 1 at time t, and the existence of the\nalmost sure limit in (2) (for all times simultaneously) follows from general theory\non coalescent processes and exchangeable partitions: see, e.g., Proposition 2.8 in\n[8]. In the same manner, one may define Fi (t) for all i \u2265 1 to be the asymptotic\nfrequency of the block containing i at time t, thus F (t) = F1 (t) in (2). The first\ncorollary gives us the behaviour of the typical block size near time zero. While\nthis result is well known, our proof is new. Along the way we also provide an\nalternative path to a result of Aldous concerning the asymptotic of the number of\nblocks with a given size.\nCorollary 3. As t \u2192 0,\n\n2F (t) d\n\u2212\u2192 E + E \u2032\nt\n\nd\n\nwhere \u2212\u2192 stands for convergence in distribution, and where E and E \u2032 are two\nindependent exponential variables with parameter 1.\nOur second application is, to the best of our knowledge, new. It concerns the\nexistence and the number of blocks (in the sense of Hausdorff dimensions to be\nspecified below) with atypical sizes as t \u2192 0, that is, blocks of size of order t\u03b3 with\n\u03b3 6= 1. It turns out that for \u03b3 < 1 (i.e., for anomalously large blocks) we have\nto look at a more precise, logarithmic, scale as there are almost surely no blocks\nwhose size will be t\u03b3 for small t. In particular, the sizes of the smallest and largest\nblocks at small time t > 0 are identified.\nFor this result, the framework introduced by Evans [13] is very convenient.\nConsider a random metric space (S, d), defined as follows. Define a distance d on\nN by declaring that for every i, j \u2265 1, d(i, j) is the time at which the integers i and\nj coalesce, and let S be the the completion of N with respect to d. It can be shown\nthat to every ball of radius t > 0 say, corresponds a unique block of the partition\n\u03bat . The space S is thus naturally endowed with a measure \u03b7 such that for every\nx \u2208 S and for every t > 0, \u03b7(x, t) := \u03b7(B(x, t)) is the asymptotic frequency of the\nblock of \u03bat associated with B(x, t). In this setting, the question mentioned above\nbecomes: are there points x \u2208 S such that \u03b7(B(x, t)) is approximately t\u03b3 as t \u2192 0,\nand if so, what is their Hausdorff dimension? Define for \u03b3 > 1\n\u001b\n\u001a\nlog(\u03b7(x, t))\n=\u03b3 .\n(3)\nSthin (\u03b3) = x \u2208 S : lim sup\nlog t\nt\u21920\n\n4\n\n\fThis set corresponds to points of S with atypically small \u03b7(x, t). For thick points,\nconsider for all \u03b8 \u2265 0,\n\u001a\n\u001b\n\u03b7(x, t)\nSthick (\u03b8) = x \u2208 S : lim sup\n=\u03b8 .\n(4)\nt\u21920 t| log t|\nTheorem 4.\n1. If 0 \u2264 \u03b8 \u2264 1 then\n\ndim Sthick (\u03b8) = 1 \u2212 \u03b8, a.s.\n\nWhen \u03b8 = 1, Sthick (\u03b8) 6= \u2205 almost surely, but if \u03b8 > 1 then Sthick (\u03b8) is empty\nalmost surely.\n2. If 1 < \u03b3 \u2264 2 then\n\n2\n\u2212 1, a.s.\n\u03b3\nIf \u03b3 > 2 then Sthin (\u03b3) = \u2205 a.s. but Sthin (2) 6= \u2205 almost surely.\ndim Sthin (\u03b3) =\n\nIt may be deduced from the above result that the Hausdorff dimension of S is\nequal to 1 almost surely, a result which was first proved by Evans [13]. This result\nshould be compared to Theorem 5 in [7] which describes the multifractal spectrum\nfor Beta(2 \u2212 \u03b1, \u03b1) coalescent, \u03b1 \u2208 (1, 2). Kingman's coalescent is a limit case for\nthis family and corresponds formally to the case \u03b1 = 2, since the Beta(2 \u2212 \u03b1, \u03b1)\ndistribution converges weakly to a Dirac mass at 0 when \u03b1 \u2192 2. Interestingly,\nonly the \"thin points\" side of the spectrum is obtained by taking a limit as \u03b1 \u2192 2\nin that result: at the power-law scale, the \"thick points\" part of the spectrum is\nempty, although the limit as \u03b1 \u2192 2 exists and is non-degenerate. For instance,\nhere the smallest block turns out to be of order t2 as t \u2192 0, while the largest block\nis of order t log(1/t). In the case of Beta-coalescents with parameter 1 < \u03b1 < 2,\n2\nthese quantities are respectively t\u03b1/(\u03b1\u22121) and t1/\u03b1 , which does not coincide with\nt log(1/t) when \u03b1 \u2192 2\u2212 .\nWe emphasize that the proof of Theorem 4 is in some sense purely conceptual:\nall the work consists of identifying Evans' metric space with a certain GaltonWatson tree (which here turns out to be the Yule tree), equipped with its branching\nmeasure. Theorem 4 then follows automatically from the results of Peter M\u00f6rters\nand Nan-Rueh Shieh [18, 19] on the multifractal spectrum of these measures. These\nresults themselves rely on elegant percolative methods introduced by R. Lyons [17].\n\n2\n\nPrevious results and discussion\n\nWe review some earlier results concerning the relation between Kingman's coalescent and Brownian processes. We start by discussing the ideas contained in [4]\n\n5\n\n\fand [23], which are most directly related to the representation of Theorem 1.\n\n2.1\n\nExcursions conditioned on their local time\n\nThe notion of continuum random tree (CRT) was developed by D. Aldous in his\nseminal papers [1, 2], in which a careful treatment of the correspondence between\nexcursions and continuum random trees is given. Particular attention is paid to the\nnormalized Brownian excursion and to the tree that it encodes through this correspondence. Early effort bore on the identification of the law of the tree spanned by\na finite number of leaves chosen suitably at random. Given an excursion function\ne \u2208 \u03a9\u2217 and p \u2208 N, let t1 , t2 , . . . , tp \u2208 (0, \u03b6) be pairwise distinct times, and define a\nplanar labelled tree with edge-lengths T = Tp (e, t1 , . . . , tp ) as follows.\n- T contains a root at height 0 and p leaves, with the height of the kth leaf\nbeing e(tk ).\n- The path from the root to the leaves j and k (1 \u2264 j 6= k \u2264 p) splits at height\ninf{e(s), s \u2208 (tj , tk )}.\n- At each branch point, branches are labelled \"left\" and \"right\".\nIt is further assumed that all branch points are distinct (i.e., branch points are\nbinary). Thus T has p \u2212 1 branch points. Le Gall [16] (see his Theorem 3) first\nidentified the distribution of Tp (e, t1 , . . . , tp ) on the space of trees when e is a\nnormalized Brownian excursion and the tk are independent and uniform random\nvariables on [0, \u03b6(e)] (and further gives the conditional distribution of e conditionally given the tree T ). Later on, Aldous [3] gave a decomposition result for\nthis distribution by identifying the conditional distribution of T given the local\ntime profile (lx , x \u2265 0) where lx is the total local time accumulated at x by e.\nThis conditional distribution is constructed from a certain inhomogeneous (i.e.,\ntime-dependent) coalescent process whose main ingredient is Kingman's coalescent. More precisely, this process is defined as follows. First, the height of the\nleaves (x1 , . . . , xp ) are i.i.d. samples from lx dx (which is a probability distribution\nbecause \u03b6(e) = 1 almost surely). Then, thinking of time as running from x = \u221e\ndown to x = 0 and the heights xi as being the birth times of particles, the law of\nT is such that as x decreases, the particles that are present merge pairwise, each\nindependently at rate 4/lx . In other words, the conditional distribution of T given\nl can be thought of as an inhomogeneous coalescent with immigration rate lx and\ncoalescing rate 4/lx . This result may be regarded as the continuum random tree\ncounterpart to Perkins' disintegration theorem in the context of superprocesses\n[21]. The proof of Aldous is based on a discrete approximation to the continuum\nrandom tree, but soon afterwards Warren [23] gave two alternative, direct proofs\n\n6\n\n\fof Aldous's result. The tools used in those arguments are closely related to earlier\nwork by Le Gall [16] and Warren and Yor [24].\nIt thus comes as no surprise that one can embed Kingman's coalescent into\na Brownian excursion. However, we emphasize that our construction is rather\ndifferent in that the tree which we consider is spanned by vertices at distance 1 from\nthe root, rather than by leaves selected uniformly at random. Moreover, it seems\ndifficult to use the description of T given above to deduce results about Kingman's\ncoalescent. On the other hand, as the reader will see, here these conclusions will\nfollow in a straightforward fashion once Theorem 1 is proved. Finally, we believe\nthat the computations leading up to Theorem 1 are new, and hope that the reader\nwill find them interesting in themselves.\n\n2.2\n\nAnalogies and differences with Beta-coalescents\n\nThe present paper complements earlier results of [6, 7], which focuses on small-time\nproperties of Beta -coalescents with parameter \u03b1 \u2208 (1, 2). Beta-coalescents are a\nfamily of \u039b-coalescent (i.e., coalescents with multiple collisions), where the measure\n\u039b is the density of a Beta(2 \u2212 \u03b1, \u03b1) random variable. (The interested reader may\nconsult [7] and references therein.) Kingman's coalescent constitutes a formal limit\ncase for the Beta-coalescents as \u03b1 \u2192 2 since the Beta(2 \u2212 \u03b1, \u03b1) converges weakly\nto the Dirac mass in zero as \u03b1 \u2192 2. It was proved in [7] that for all 1 < \u03b1 < 2,\nBeta-coalescents can be embedded in continuum stable random trees associated\nwith \u03b1-stable branching processes rather than Brownian motion. (An excellent\nintroduction to continuous random trees can be found in [10]). When \u03b1 = 2 the \u03b1stable branching process is the Feller diffusion, which is closely related to Brownian\nmotion. It is therefore natural to suspect a relation between Kingman's coalescent\nand Brownian motion.\nHowever, we emphasize that there is an essential difference between Theorem\n1 here and Theorem 1 in [7]. The analogue of Theorem 1 in [7] is the following.\nLet (Bs , s \u2265 0) be a reflecting Brownian motion and let \u03c41 = inf{t > 0 : L(t, 0) >\n1}, where L(t, x) is the joint local time process of B. Let v > 0 be such that\nv < sups\u2264\u03c41 B(s), and for all 0 \u2264 u \u2264 v, define a partition \u03a0vu in exactly the same\nway as in the construction given above Theorem 1, except that where we used the\nlevel 1 we now use level v: thus, here the excursions (\u03b5i )\u221e\ni=1 which we consider are\nthose above level v (instead of 1) and the ek are the excursions above u that reach\nv. Therefore, using this notation, the partition \u03a0u defined for Theorem 1 is simply\n\u03a01u (with, however, the difference that here B is not a single excursion).\nNow, for all t > 0, let\n\u001b\n\u001a\nZ s\n4Zu\u22121 du > t\nV (t) := inf s > 0 :\n0\n\n7\n\n\fwhere Zx = L(\u03c41 , x) for all x \u2265 0. (Note that V (t) < sups\u2264\u03c41 B(s)). Fix T > 0\nand for 0 \u2264 t \u2264 T , consider the partition\nV (T )\n\n\u03a0\u0302t := \u03a0V (T \u2212t) .\nWe can prove the following result:\nProposition 5. (\u03a0\u0302s , 0 \u2264 s \u2264 T ) has the same law as (\u03bas , 0 \u2264 s \u2264 T ), Kingman's\ncoalescent run for time T.\nObserve that the main difference between Proposition 5 and Theorem 1 is that\nhere the tree is spanned by vertices at a random distance V (T ) from the root of\nthe continuum random tree, while these vertices are at a deterministic distance\n1 in Theorem 1. This was the source of considerable technical difficulties in [7].\nAs the reader will see, the proof of Theorem 4 is much more straightforward than\nthat of Theorem 5 in [7].\nA direct proof of Proposition 5 is provided in Section 3. However, it could also\nbe deduced from Perkins' disintegration theorem together with Le Gall's excursion\nrepresentation of Dawson-Watanabe processes. For this, one must use the fact that\nthe empirical measure for an exchangeable system of particles fully determines the\nlaw of the individual trajectories.\nIn light of Theorem 1 and the above discussion, one can wonder if, conversely,\nTheorem 1 could not be extended to Beta-coalescents. Interestingly, we have rather\nstrong evidence that this cannot be true. Assuming that the construction was valid\nfor a Beta-coalescent, we would conclude that the number of blocks lost at every\ncollision would be an i.i.d. sequence. Indeed, from results in [10], one can see that\nthe tree spanned by vertices at a deterministic level (the \"reduced tree\") forms a\ntime-change of a Galton-Watson process. However, in that case the distribution of\nthe number of blocks involved at every collision must agree with the distribution\nin equation (10) of [6]. Simulations indicate that this is not the case for the final\ncollision. However, we are not aware of a rigorous proof that this cannot be true,\nalthough there are also some theoretical arguments in that direction. We note that\nthe essential reason for which the proof of Theorem 1 breaks down in the case \u03b1 < 2\nis that Brownian motion possesses an extra symmetry property (reflection about\na horizontal line) compared to the height process of other stable continuous-state\nbranching processes.\n\n2.3\n\nMore on duality.\n\nTheorem 1 brings to mind another result which relates Kingman's coalescent to the\nbehaviour of Yule processes. (As the reader will see in section 5, Yule processes are\n\n8\n\n\findeed embedded in the construction of Theorem 1). Consider the jump chain of\nKingman's coalescent i.e., the chain X(1), . . . , X(n), . . . where X(n) is the element\nof the nth simplex given by the block frequencies of Kingman's coalescent when\nit has n blocks. In [9], Bertoin and Goldschmidt show that this chain X can be\nrelated to the fragmentation chain obtained by taking a Yule process (Yt , t \u2265 0)\nand conditioning on {W = w > 0}, where W = limt\u2192\u221e e\u2212t Yt almost surely. This\nfragmentation process (Gt , t \u2265 0) is defined by considering how the mass w is\nbeing split between the children of an individual when it dies. More precisely,\nthe two children of this individual each give rise to their own independent Yule\nprocess Y (1) and Y (2) , say. To each one we can associate the corresponding random\nvariable W (1) and W (2) . Note that if \u03c4 is the time of the split, we must have\nW = e\u2212\u03c4 W (1) + e\u2212\u03c4 W (2) . Define the fragmentation process (Gt , t \u2265 0) by saying\nthat at time \u03c4 , the mass W splits into e\u2212\u03c4 W (1) and e\u2212\u03c4 W (2) , and so on as time\nevolves. If we do not condition on {W = w}, then G is a fragmentation in the\nsense that fragments evolve independently with individuals fragments behaving as\na rescaled copy of the original process. This is what is usually called a homogeneous\nfragmentation process (see, e.g., [8, Section 3.1]) but note that here the total mass\nis random. It is then natural to ask what happens when we condition on {W = w}\nto keep the total mass of this fragmentation deterministic. Theorem 3.1 of [9] then\nstates that if (Nt , t \u2265 0) is an independent Poisson process, then conditionally on\n{W = w},\nd\n\n{Glog(1+t) , t \u2265 0} = {wX(Nwt ), t \u2265 0}.\n\n(5)\n\nThat is, up to a time-change, the fragmentation G is the time-reversal of the jump\nchain of Kingman's coalescent. It is an open problem to decide whether a similar\nrepresentation exists for the case of Beta-coalescents. We indicate that Christina\nGoldschmidt [14] has recently computed explicitly the Martin boundary of the\ncontinuous Galton-Watson process (Yt , t \u2265 0) associated with the reduced tree\nat level 1 of a stable continuum random tree with index \u03b1. This can be used\nto describe explicitly the behaviour of Y (w) , where Y (w) denotes the process Y\nconditioned on {W = w}, (here again, W = limt\u2192\u221e e\u2212\u03bbt Yt and \u03bb = 1/(\u03b1 \u2212 1)).\nIn particular, from her result it follows that the transition rates of Y (w) are not\nindependent of the current state of Y (w) . Since it turns out that W = Z1 almost\nsurely, (Z1 being the quantity of local time of the stable CRT at level 1), it follows\nthat conditionally on {Z1 = z}, the number of children of individuals in the tree\nis not i.i.d. In particular, the above objection against the extension of Theorem 1\ndoes not hold here.\n\n9\n\n\f3\n3.1\n\nBrownian construction of Kingman's coalescent.\nProof of Theorem 1.\n\nProof. The proof we give is based on a few simple calculations with excursion\ntheory. For basic definitions and facts, we refer the reader to Chapter XII of [22].\nFix 0 < t < 1, and recall our notation Zx = L(\u03b6, x) for all x \u2265 0, where L(t, x)\nis the joint local time of a Brownian excursion (Bs , s \u2265 0) conditioned to exceed\nlevel 1. Define a filtration\n{Gu = \u03c3(Zs , u \u2264 s \u2264 1)}0\u2264u\u22641 .\n\n(6)\n\nIn parallel, define a family of \u03c3-algebras {Hu }0\u2264u\u22641 by putting\n\u0001\nHu = \u03c3 B\u03b1u (s) , s \u2265 0\n\n(7)\n\nwhere for all s > 0:\n\nu\n\n\u001a\n\n\u03b1 (s) := inf t > 0 :\n\nZ\n\n0\n\nt\n\n\u001b\n\n1{B\u03c4 >u} d\u03c4 > s .\n\nIn words Hu contains all the information about the trajectory above level u. It is\na tedious but easy exercise to see that {H1\u2212t }0\u2264t\u22641 is a filtration and Hu \u2287 Gu for\nall 0 \u2264 u \u2264 1. Let \u03b4 > 0, and let u = 1 \u2212 t. Define the event Ak,j (\u03b4) as follows.\nCall N the number of excursions above u which reach 1, and let (e1 , . . . eN ) be\nthese excursions with an order given by their height (as usual, we view each ei as\nan element of \u03a9\u2217 ). Let 1 \u2264 k, j \u2264 N and let\nAk,j (\u03b4) := {excursions ek and ej have coalesced at level u \u2212 \u03b4},\nwhere we say that ek and ej have coalesced at level u \u2212 \u03b4 if ek and ej are part of\na single excursion above level u \u2212 \u03b4 which reaches level 1.\nTo alleviate notations we also write A(\u03b4) when there is no risk of confusion.\nTheorem 1 follows from the following claim:\nP(Ak,j (\u03b4)|Gu ; N \u2265 max(j, k)) =\n\n4\n\u03b4 + o(\u03b4), a.s.\nZu\n\n(8)\n\nNote that to every excursion ei with 1 \u2264 i \u2264 n, we may associate a starting time\nti \u2208 [0, \u03b6] such that the excursion starts at time ti , that is: B(t + ti ) = u + ei (t), for\nall t \u2264 \u03b6(ei ). Assume without loss of generality that tj < tk . Among all excursions\nbelow level u, consider the subset of those excursions (e\u2032i , i \u2265 1) which separate ek\n\n10\n\n\f1\n\nu\nu \u2212 du\n\ntj\n\nt'1\n\nt' t\n2 k\n\nFigure 2: Between levels u and u\u2212du, excursions ej and ek (which start respectively\nat times tj and tk ) coalesce. For this to occur, the excursions below u starting at\ntime t\u20321 and t\u20322 must not reach below u \u2212 du.\nand ej , that is, whose starting time t\u2032i lies strictly in the interval (tj , tk ) (see Figure\n2). Observe that for ej and ek to coalesce by level u \u2212 \u03b4, it is both necessary and\nsufficient that:\ninf e\u2032i (s) > \u2212\u03b4, for all i \u2265 1.\n(9)\ns>0\n\nSince L(t, u) may only increase at times t such that Bt = u, it follows that\nthroughout ej , the local time at level u is constant, let lj be this quantity (thus,\nlj = L(tj , u)). Similarly, let lk be the local time at level u throughout excursion\nek , and let l = |lj \u2212 lk |. Then we claim that, conditionally on lj and lk , A(\u03b4) has\nprobability exp(\u2212l/(2\u03b4)). Indeed, by excursion theory and elementary properties\nof Brownian motion, we have that, conditionally on Hu ,\nX\n\u03b4(l\u2032i ,e\u2032i )\ni\u22651\n\nis a Poisson point process on [lj , lk ] \u00d7 \u03a9\u2217 with intensity 1{[lj ,lk ]} dl \u2297 \u03bd u (de), where\ndl is the one-dimensional Lebesgue measure, and \u03bd u is It\u00f4's excursion measure\nrestricted to negative excursions e \u2208 \u03a9\u2217 such that inf s>0 e(s) > \u2212u. It follows\nthat\nX\n\u03b4(l\u2032 ,inf s>0 e\u2032 (s))\ni\u22651\n\ni\n\ni\n\n11\n\n\fis a Poisson point process on [li , lj ]\u00d7R\u2212 with intensity dl1{l\u2208[li ,lj ]} \u22971{\u2212u\u2264h\u22640} dh/2h2 ,\nwhere z := Zu (see, e.g., (2.10) in Chapter XII of [22]). Thus,\nP(A(\u03b4)|Hu ) = exp(\u2212|lj \u2212 lk |/(2\u03b4)).\nNow, observe that, conditionally on Gu ,\nX\n\u03b4(li ,sup ei (s))\ns>0\ni\u22651\n\nis a Poisson point process on [0, z] \u00d7 R+ with intensity dl1{l\u2264z} \u2297 1{h\u22651\u2212u} dh/2h2 ,\nbecause ei are precisely the set of excursions above u that reach level 1. Therefore,\nusing elementary properties of Poisson processes, conditionally on Gu , and conditionally on {N \u2265 max(j, k)} (which we must assume if we are to talk about the\ncoalescence of ej and ek ), then lj and lk are two independent random variables\nuniformly distributed on [0, z] (this does not depend on the precise intensity of\nthe point process; all that is required is that the time-intensity is the Lebesgue\nmeasure and the space-intensity has no atom). In particular, conditionally on Gu\nand N \u2265 max(j, k), l := |lj \u2212 lk | may be written as:\nl = z|U \u2212 V |\nwhere U, V are uniform random variables on (0, 1) and z = Zu . Putting these\npieces together, we obtain:\nP(A(\u03b4)|Gu ; N \u2265 max(j, k)) = E[exp(\u2212z|U \u2212 V |/(2\u03b4))], a.s.\n\u0012\n\u0013\nZ 1Z 1\nz|x \u2212 y|\n=\ndxdy exp \u2212\na.s.\n2\u03b4\n0\n0\n\u0012\n\u0013\nZ 1 Z y\nz(y \u2212 x)\ndx exp \u2212\ndy\n=2\na.s.\n2\u03b4\n0\n0\nZ 1\n\u0010 zx \u0011\n\u0010 zy \u0011 Z y\na.s.\ndx exp\ndy exp \u2212\n=2\n2\u03b4\n2\u03b4\n0\n0\nZ 1\n\u0010 zy \u0011 2\u03b4\n\u0010 zy \u0011\ndy exp \u2212\n=2\n\u2212 1) a.s.\n(exp\n2\u03b4 z\n2\u03b4\n0\nZ\n\u0010 zy \u0011\n4\u03b4 1\n=\n] a.s.\ndy[1 \u2212 exp \u2212\nz 0\n2\u03b4\n\u0010 z\u0011\n4\u03b4 8\u03b42\n) a.s.\n\u2212 2 (1 \u2212 exp \u2212\n=\nz\nz\n2\u03b4\n4\u03b4\n=\n+ o(\u03b4) a.s.\nz\nas \u03b4 \u2192 0. This is precisely (8), and so this implies Theorem 1.\n\n12\n\n\f3.2\n\nProof of Proposition 5\n\nThe proof of Proposition 5 involves similar ideas to the proof of Theorem 1 above.\nHowever, the calculations become, somewhat surprisingly, slightly more complicated. In particular, there is a remarkable cancellation towards the end, which\nillustrates the following fact. Roughly speaking, we try to compute the rate at\nwhich the kth highest excursion at a current level u > 0 splits to give the k th and\nj th highest excursions, with j \u2265 k. We are trying to show that this rate is 4/Zu\nand is in particular independent of k and j. This may seem hard to believe at first:\nwhen splitting, it is easier to create an excursion of small size rather than large.\nHowever, the excursion heights accumulate near zero and therefore creating an\ninterval whose size falls exactly between the sizes of the nth smallest and n + 1th\nsmallest intervals also becomes harder when n tends to infinity. These two effects\nexactly compensate each other and imply the aforementioned result!\nFix k, j \u2265 1 and assume that k \u2264 j. Recall that here (Bs , s \u2264 \u03c41 ) is no longer\na single Brownian excursion but a collection of excursions which accumulate one\nunit of local time at level 0. We shall still denote by Zt = L(\u03c41 , t) the total local\ntime accumulated at level t by (Bs , 0 \u2264 s \u2264 \u03c41 ). Recall that, by the Ray-Knight\ntheorem (Theorem (2.3) in Chapter XI of [22]), (Zt , t \u2265 0) is the Feller diffusion,\ndefined by:\n(\n\u221a\ndZt = Zt dWt\nZ0 = 1\nwhere (Wt , t \u2265 0) is a standard Brownian motion. Let\n\u0001\nKu = \u03c3 B\u03b3 u (s) , s \u2265 0\n\n(10)\n\nwhere for all s > 0:\n\n\u001b\n\u001a\nZ t\n1{B\u03c4 \u2264u} d\u03c4 > s .\n\u03b3 (s) := inf t > 0 :\nu\n\n0\n\nIn words Ku contains all the information about the trajectory of B below level u.\nJust as in the proof of Theorem 1, {Kt }t>0 is a filtration. We wish to compute\nthe rate at which the j th excursion \"looks down\" on the kth excursion to adopt its\nlabel. We claim that, independently of k and j, and independently of Ht (defined\nin (7)) the infinitesimal rate at which this happens is:\nrate (j looks down on k) =\n\n4\n.\nZt\n\n(11)\n\nHere and in what follows, the event that j looks down on k means the following\nthing. Define a process {\u03bei (t), t \u2265 0}i\u22651 as follows. Initially, {\u03bei (0)}i\u22651 are i.i.d\n\n13\n\n\funiform (0, 1) random variables. We think of \u03bei (0) as the label of the ith highest\nexcursion of (Bs , 0 \u2264 s \u2264 \u03c41 ) above 0. As time evolves, \u03bei (t) keeps this interpretation, with \u03bei (t) being the label of the ith highest excursion above level t of\n(Bs , 0 \u2264 s \u2264 \u03c41 ). The rule of evolution is that when the level t increases, an\nexcursion may split into two parts. The highest of these two parts is necessarily\nstill ranked ith , while the second part has a larger rank j > i. In that case, we\nsay that j looks down on i. When this occurs, \u03bej (t+ ) becomes \u03bei (t\u2212 ), while for\nk \u2265 j, what was previously the kth excursion now becomes the (k + 1)th excursion:\nthus in that case, we define \u03bek+1 (t) = \u03bek (t\u2212 ). Visually, j adopts the label of i (it\nlooks down on it) and all labels corresponding to excursions with a higher rank are\npushed up by 1. Thus (11) tells us that, in the terminology of Donnelly and Kurtz,\n{\u03bei (t)}i\u22651 is a lookdown process with infinitesimal rate 4/Zt at time t, conditionally on (Zt , t \u2265 0). We do not need the full definition of these processes, which is\nsomewhat complicated, and can be found, for instance, in Chapter V of [12]. Thus\n(11) is exactly the Brownian analogue of Theorem 14 in [7], where further details\non this approach can be found. In particular, Proposition 5 follows directly from\n(11) and Lemma 5.6 in [12].\nWe give a direct proof of (11) based on calculations with It\u00f4's excursion measure. Fix a small \u03b4 > 0. For all t \u2265 0, let (et,i )i\u22651 be the excursions of B above\nlevel t ordered by their height (recall that et,i \u2208 \u03a9\u2217 for all t \u2265 0, i \u2265 1). For k \u2265 1,\nlet\nMk (t) = sup et,k (s).\ns>0\n\nA simple analysis of the construction shows that in time \u03b4 (that is, between times\ns and t := s + \u03b4), the j th excursion looks down on the kth excursion if there is a\nlocal minimum located within the kth highest excursion at level s \u2264 m \u2264 t = s + \u03b4\nsuch that of the two branches going out of this local minimum, one has a height\nequal to Mk (t\u2212 ) = Mk (t) and the other has a height hnew such that\nMj (t\u2212 ) < hnew < Mj+1 (t\u2212 ).\n\n(12)\n\nLet (ek (x), 0 \u2264 k \u2264 \u03b6) be this excursion. Given {Mk (t) = m}, ek has the law of\nan It\u00f4 excursion conditioned on the event: {supx\u2208(0,\u03b6) ek (x) = m}. For m > 0, let\nQ(m) denote the probability measure on C([0, \u221e)) defined by the conditioning of\n\u03bd given that {sups>0 e(s) = m}. Define:\nT\u03b41 = inf{x > 0 : ek (x) > \u03b4},\nTM = the unique x \u2265 0 such that ek (x) = Mk (t) = m,\nT\u03b42 = inf{x > TM : ek (x) < \u03b4}.\n\n14\n\n\fA\u03b4\n\nB\u03b4\n\nm\n\nm\n\ny\n\ny\n\nx\n\nx\n\n\u03b4\n\n\u03b4\n\nTM\n\nT\u03b41\n\nT\u03b42\n\nT\u03b41\n\nTM\n\nT\u03b42\n\nFigure 3: Events Ax,y on the left and Bx,y on the right\nWe note that (12) occurs if and only if the event AMj+1 ,Mj \u222a BMj+1 ,Mj occurs,\nwhere\n)\n(\nAx,y :=\n\n\u2203T\u03b41 < s < TM : x < sup ek (r) < y and ek (s) < \u03b4\nr\u2208[T\u03b41 ,s]\n\nand\nBx,y :=\n\n(\n\nx < sup ek (r) < y\nr\u2208[T\u03b42 ,\u03b6]\n\n)\n\n.\n\nFor future reference, we also let A = AMj+1 ,Mj and B = BMj+1 ,Mj .\nWe claim that\nP(A|Kt ) = P(B|Kt ) =\n\n2\u03b4\n+ o(\u03b4), a.s.\nZt\n\n(13)\n\nand that P(A \u2229 B|Kt ) = O(\u03b42 ), a.s., so that, up to terms of order o(\u03b4), P(A \u222a\nB|Kt ) = 4\u03b4/Zt , a.s., as required in (11). By time-reversal symmetry of the Brownian excursion, it is clear that P(A|Kt ) = P(B|Kt ) so we only do the calculations\nin the case B.\nThe key idea to compute P(B) is to use the Markov property at time T\u03b42 . (In\nfact an additional step is required, since under this conditioning ek is not exactly\nMarkov). Let m > 0 and let 0 < x < y < m be two fixed levels (we think of\ny = Mj and x = Mj+1 ). We claim that P(B) can be computed as follows:\n\u0012\n\u0013\nx\n\u03b4\n(m)\n1\u2212\n+ o(\u03b4)\n(14)\nQ (Bx,y ) =\nx\ny\n\n15\n\n\fIndeed, consider the unconditional problem first. Recall that the part of the trajectory of a Brownian excursion that comes after T\u03b41 is simply a Brownian motion\n(started from \u03b4) run until it hits zero. Let \u03b7 > 0 and let M be the event that,\nstarting from \u03b4, it reaches level m and from there returns to zero without reaching\nfurther than m + \u03b7. Starting from \u03b4, the probability of reaching m before hitting\n0 is \u03c6\u03b4 (m) = \u03b4/m by the standard gambler's ruin probability. Once there, the\nprobability of returning to 0 before hitting m + \u03b7 is \u03b7/(m + \u03b7). Thus\nP\u03b4 (M ) = \u03c6\u03b4 (m)\u03b7/m + o(\u03b7)\n\n(15)\n\nOn the other hand, the event that, started from \u03b4, both M and Bx,y occur can\nbe expressed, by using the strong Markov property at time T\u03b42 , as:\n\u0012\n\u0013\nx\n\u03b7 \u03b4\n\u03b4\n1\u2212\n+ o(\u03b7)\n(16)\nP (M \u2229 Bx,y ) = \u03c6\u03b4 (m)\nm\u2212\u03b4x\ny\nIn the above expression, the second term expresses the fact that the process, having\nreached distance m, only has to return to distance \u03b4 before reaching m + \u03b7. The\nthird term corresponds to hitting x before returning to zero, while the fourth\nand last term corresponds to the probability that, having reached level x, the\nprocess e reaches 0 before y. All these calculations involve the same gambler's\nruin probability already used above. Combining (15) with (16), we obtain as\nclaimed, up to terms of leading order \u03b4:\n\u0012\n\u0013\nx\n\u03b4\n(m)\n1\u2212\n+ o(\u03b4).\n(17)\nQ (Bx,y ) =\nx\ny\nHere the term in o(\u03b4) depends only on m = Mk (s). Rewriting (17), we find:\n\u0012\n\u0013\n1 1\n(m)\n\u2212\nQ (Bx,y ) = \u03b4\n+ o(\u03b4).\n(18)\nx y\nTaking the expectation:\nQ\n\n(m)\n\n\u0013\n1\n1\n\u2212\n+ o(\u03b4)\n(B) = \u03b4E\nMj (t) Mj+1 (t)\n= \u03b4[E(1/Mj (s)) \u2212 E(1/Mj+1 (s))] + o(\u03b4).\n\u0012\n\n(19)\n\nNow, observe that by the Markov property of the underlying continuous random\ntree, we have above level s a Poisson point process of excursions with intensity\nIt\u00f4's excursion measure n, run for a local time z = Zs . Thus, the number N>a of\nexcursions higher than some fixed level a > 0 is distributed as:\nN>a = Poisson(z/2a)\n\n16\n\n\fsince n(sup e > a) = 1/2a. Therefore,\nP(Mj (s) > a) = P(N>a \u2265 j)\n\n= 1 \u2212 e\u2212z/2a \u2212 . . . \u2212 e\u2212z/2a (z/2a)j\u22121 /(j \u2212 1)!\n\nfrom which it follows that Mj has a density equal to\nP(Mj \u2208 (a, a + da)) =\n\ne\u2212z/2a (z/2a)j\na(j \u2212 1)!\n\nThis implies:\nE(1/Mj ) \u2212 E(1/Mj+1 ) =\n=\n\n\u221e\n\n\u0003\n1 \u2212z/2a \u0002\ne\n(z/2a)j /a(j \u2212 1)! \u2212 (z/2a)j+1 /a(j)! da\na\n0\nZ\n\u0002\n\u0003\n1 \u221e 1 \u2212z/2a\ne\n(z/2a)j j/a \u2212 z/2a2 da\nj! 0 a\n\nZ\n\nusing the change of variable u = z/2a, we obtain:\n\u0013\n\u0012 Z \u221e\nZ \u221e\n1\n\u2212u j 2u\n\u2212u j 2u 2ju z\ne u\ndu +\ndu\ne u\n\u2212\nE(1/Mj ) \u2212 E(1/Mj+1 ) =\nj!\nz z 2u2\nz\n0\n0\nZ \u221e\nZ \u221e\n2\n2\n=\ne\u2212u uj+1 du \u2212\ne\u2212u uj du\nzj! 0\nz(j \u2212 1)! 0\n\u0012\n\u0013\nj!\n2 (j + 1)!\n\u2212\n=\nz\nj!\n(j \u2212 1)!\n2\n=\n.\nz\nThe cancellation of terms involving j is quite remarkable. Since z = Zt , we have\nthus proved the claim (13):\nP(B) = 2/Zt .\nAs explained before, this proves the claim (11).\n\n4\n\nProof of Corollary 3\n\nLet (Bs , 0 \u2264 s \u2264 \u03b6) be a Brownian excursion conditioned to reach 1, and let\n(\u03bat , t \u2265 0) be the realization of Kingman's coalescent described in Theorem 1.\nNote that by Theorem 1, one can obtain the frequencies of the blocks of \u03bat by\nsimply considering the excursions of B above level U (t) with a mass proportional\nto the quantity of local time that they accumulate at level 1. Thus, to prove\n\n17\n\n\fCorollary 3, the first step consists of computing the number of excursions above a\ngiven level u < 1 which carry a given amount of local time at 1. For 0 < u < 1,\nand x \u2265 0, let N (u, x) be the number of excursions above level 1 \u2212 u that carry a\nlocal time at 1 greater than x.\nLemma 6. We have the almost sure convergence:\n2u\nN (u, 2ux) \u2212\u2192 e\u2212x\nZ1\n\n(20)\n\nfor all x \u2265 0 as u \u2192 0.\nProof. To see this, observe that by excursion theory, N (u) := N (u, 0) is a Poisson\nrandom variable with mean Z1\u2212u /(2u). Moreover, conditionally on N (u, 0) =\nn, the n excursions that reach level 1 are i.i.d. realizations of the It\u00f4 measure\nconditioned to exceed level u. Now, it is well-known that such an excursion,\nupon reaching u, behaves afterwards as Brownian motion killed when returning to\n0, so by standard properties of Brownian motion local time (see Proposition 4.6\nchapter VI in [22]) we have that the amount of local time accumulated by such\nan excursion at level u is exponentially distributed with mean 2u. Therefore, by\nPoisson thinning, conditionally on Z1\u2212u = z,\n\u0011\n\u0010z\nd\n(21)\ne\u2212x/(2u) .\nN (u, x) = Poisson\n2u\nConsidering excursions with local time greater than 2ux, let\nXu =\n\n2uex\nN (u, 2ux).\nZ1\u2212u\n\nNote that, by almost sure continuity of Zs near s = 1, it suffices to prove that\nXu \u2212\u2192 1 almost surely as u \u2192 0. Next we recall the following standard Chernoff\nbound for a Poisson random variable Y with parameter \u03bc: for all h \u2265 0,\nP(Y > \u03bc(1 + \u03b4)) \u2264 e\u2212h\u03bc(1+\u03b4) E(ehY ) = exp(\u03bc(eh \u2212 1 \u2212 h) \u2212 h\u03bc\u03b4).\nSince eh \u2212 1 \u2212 h \u223c h2 /2 for h \u2192 0, we see that \u2212\u03bb = eh \u2212 1 \u2212 h \u2212 h\u03b4 < 0 for\nsufficiently small h. Thus, using (21), we are led to the estimate:\nP(|Xu \u2212 1| > \u03b4|Z1\u2212u = z) \u2264 Ce\u2212\u03bbz/2u\nfor some \u03bb > 0 and some C > 0. Taking the expectation in the above, we get\nP(|Xu \u2212 1| > \u03b4) \u2264 E(Ce\u2212\u03bbZ1\u2212u /2u ).\n\n18\n\n\fFor k \u2265 1, let uk = 1/k2 . Note that for 0 \u2264 s \u2264 1, Zs dominates stochastically\nan exponential random variable with mean 2s. Indeed, Zs is greater than the\nlocal time accumulated by B at level s after T1 , the hitting time of 1 by B. Since\n(BT1 +t , t \u2265 0) has the distribution of a Brownian motion started at 1 killed upon\nhitting zero, we may apply again Proposition 4.6 in Chapter VI of [22], the claim\nfollows. We deduce that\n\u221e\n\u221e Z \u221e \u2212\u03bbk 2 x \u2212x/(2\u22122/k 2 )\nX\nX\ne\ne\n2\nE(Ce\u2212k \u03bbZ1\u2212uk /2 ) \u2264 C\ndx\n2\n\u2212 2/k 2\n0\nk=2\n\nk=2\n\n\u2264C\n\n\u221e\nX\nk=2\n\n1\n< \u221e.\n\u03bbk 2 (2 \u2212 2/k2 ) + 1\n\nThus by the Borel-Cantelli lemma, we get that\nXuk \u2192 1 almost surely as k \u2192 \u221e.\n\n(22)\n\nNow, to obtain almost sure convergence for other values of u, let k be such that\nuk+1 < u \u2264 uk , and consider the process t 7\u2192 N (t, 2ux), t \u2208 [uk+1 , uk ]. Note that,\nfor a given size y \u2265 0 say, the difference |N (u, y) \u2212 N (uk , y)| is bounded by the\ntotal number of excursions that coalesce during the interval (uk+1 , uk ]. To see this\nobserve that u 7\u2192 N (u, y) evolves by jumps of size 1 (either two excursions that\nhad masses smaller than y coalesce to give birth to an excursion of mass at least\ny and the jump is positive, or two excursions of masses larger than y coalesce, in\nwhich case N (u, y) decreases by 1). Hence for each coalescence event in (uk+1 , uk ]\nthe process N (u, y) changes by at most 1.\nThus we have that for all u \u2208 [uk+1 , uk ]:\n|N (u, 2ux) \u2212 N (uk , 2ux)| \u2264 |N (uk+1 ) \u2212 N (uk )|.\nSince N (u, x) is monotone in x, we obtain that for every u \u2208 (uk+1 , uk ],\n|N (u, 2ux) \u2212 N (uk , 2uk x)| \u2264 |N (uk+1 ) \u2212 N (uk )| + |N (uk , 2ux) \u2212 N (uk , 2uk x)|\n\n\u2264 |N (uk+1 ) \u2212 N (uk )| + |N (uk , 2uk+1 x) \u2212 N (uk , 2uk x)|\n\n\u2264 2|N (uk+1 ) \u2212 N (uk )| + |N (uk+1 , 2uk+1 x) \u2212 N (uk , 2uk x)|\n= \u2206k ,\n\nsay, where we have set\n\u2206k := 2|N (uk+1 ) \u2212 N (uk )| + |N (uk+1 , 2uk+1 x) \u2212 N (uk , 2uk x)|.\n\n19\n\n(23)\n\n\fMultiplying by u and letting Xu\u2032 = uN (u, 2ux) (so that (20) is equivalent to\nXu\u2032 \u2192 Z1 e\u2212x /2 almost surely as u \u2192 0 for all x \u2265 0), we get:\nsup\nu\u2208(uk+1 ,uk ]\n\n|Xu\u2032 \u2212 Xu\u2032 k | =\n\u2264\n\nsup\nu\u2208(uk+1 ,uk ]\n\n+ (u \u2212 uk )N (uk , 2uk x)|\n\nsup\nu\u2208(uk+1 ,uk ]\n\n\u2264 uk \u2206k +\n\n|u(N (u, 2ux) \u2212 N (uk , 2uk x))\n{u\u2206k + |u \u2212 uk |N (uk , 2uk x)}\n\n|uk+1 \u2212 uk | \u2032\nXuk .\nuk\n\n(24)\n\nIt is plain that the second term on the right-hand side converges almost surely to 0.\nTo see that uk \u2206k \u2192 0 as well, it suffices to observe that by (22) applied respectively\nwith x = 0 and x > 0, we see that N (uk ) \u223c C1 k2 while N (uk , 2uk x) \u223c C1 k2 for\nsome random C1 , C2 > 0. It follows that both terms in the right-hand side of (23)\nare o(k2 ), i.e., uk \u2206k \u2192 0 almost surely. Thus the left-hand side of (24) converges\nto 0 as well, and this implies Xu\u2032 \u2192 Z1 e\u2212x /2 almost surely as u \u2192 0. This finishes\nthe proof of the lemma.\nWe trivially obtain from Lemma 6 a result first derived by D. Aldous in [4] (see\nhis equation (35)). Let K(t, x) be the number of blocks in Kingman's coalescent\nat time t that are greater than x.\nLemma 7. For every x \u2265 0, we have the almost sure convergence as t \u2192 0:\n\nt\nK(t, tx/2) \u2212\u2192 e\u2212x .\n(25)\n2\nProof. This is a trivial consequence of Theorem 1 and Lemma 6. Indeed, since\nevery block at time t corresponds to an excursion above level u with u = U (t) by\nTheorem 1, and since the mass of a block is given by the renormalized amount of\nlocal time it accumulates at level 1, one may write:\nK(t, tx/2) = N (u, y)\nwhere u = 1\u2212U (t) \u223c tZ1 /4 as t \u2192 0, and y = txZ1 /2. Therefore, using the almost\nsure convergence result in Lemma 6 and making the necessary cancellations, we\nobtain the desired estimate (25).\nCorollary 3 follows directly from (25), since if B(t) denotes the mass of a\nblock randomly chosen among the K(t, 0) blocks present at time t (uniformly at\nrandom), then P(B(t) > tx/2) = E(K(t, tx/2)/K(t, 0)) \u2212\u2192 e\u2212x by the Lebesgue\ndominated convergence theorem. It follows that:\n2B(t) d\n\u2212\u2192 E\nt\n\n20\n\n\fwhere E is an exponentially distributed random variable with mean 1. Now,\nobserve that the distribution of the frequency F (t) of the block containing 1 is\nnothing but a size-biased version of the law of B(t), that is, for every nonnegative\nBorel function f , we have (denoting B = B(t) and F = F (t)):\nE{f (F )} = E{Bf (B)}.\nBy considering for instance for every a > 0, P(F \u2264 a) = E(B1{B\u2264a} ), and the\nLebesgue convergence theorem, we conclude that as t \u2192 0,\nF d\n\u2212\u2192 \u00ca\n2t\nwhere \u00ca has a size-biased exponential distribution. That is, \u00ca has the distribution\nxe\u2212x dx which is a Gamma(2) distribution. Equivalently, \u00ca is the sum of two standard exponential random variables E + E \u2032 . This concludes the proof of Corollary\n3.\n\n5\n\nProof of Theorem 4\n\nThe main ingredient for the proof of Theorem 4 is the definition of reduced tree\nassociated with our Brownian excursion (Bs , 0 \u2264 s \u2264 \u03b6), and results about the\nmultifractal spectrum of the Branching measure of Galton Watson trees due to\nM\u00f6rters and Shieh[18]. Formally, the reduced tree T can be described by saying\nthat (Bs , 0 \u2264 s \u2264 \u03b6) encodes a continuum random tree T with a metric d and a\nroot o as in [1]. Each vertex z \u2208 T has a unique geodesic \u03b3z : [0, 1] \u2192 T that\nconnects it to o, such that if d(o, z) = \u03c1, then d(o, \u03b3z (t)) = \u03c1t for all 0 \u2264 t \u2264 1.\nWe define T by\n[\nT=\n\u03b3z ([0, 1]).\nz\u2208T :d(z,0)=1\n\nInformally, T is a continuum random tree obtained from T by taking away (\"pruning\") every vertex whose descendence does not reach distance 1 from the root.\nEquivalently, this is the tree which, at level 0 \u2264 u < 1, has as many branches\nas there are excursions above level u that reach level 1. Thus if we let |T(u)|\nbe the number of branches of T at level 0 \u2264 u < 1, then we have by definition\n|T(u)| = N (u), the number of excursions above u reaching level 1.\nThe process |T(u)| is a variant of a process already considered by Neveu and\nPitman in a seminal paper [20]. The key observation is that:\nd\n\n{|T(1 \u2212 e\u2212t )|, t \u2265 0} = {Yt , t \u2265 0},\n\n21\n\n(26)\n\n\fwhere {Yt , t \u2265 0} is a (rate 1) Yule process. This is a continuous-time GaltonWatson process where individuals die at rate 1 to give birth to exactly two offsprings. In fact, an even stronger property holds. Consider the random tree T\nobtained from T by applying the same exponential time-change as in (26). That\nis, for all z \u2208 T with d(z, o) = 1, define \u03b3z\u2032 (t) = \u03b3z (1 \u2212 e\u2212t ). Let\n[\nT :=\n\u03b3z\u2032 ([0, \u221e)).\n(27)\nz\u2208T :d(z,0)=1\n\nThen T is a Yule tree. We can thus define the boundary \u2202T of the tree T by\ntaking \u2202T to be the set of rays, i.e., the set of all non-backtracking T-valued paths\n(\u03b6(t), t \u2265 0) such that \u03b6(t) is at distance t from the root. The boundary \u2202T\nis naturally equipped with a measure \u03bc, called the branching measure, which is\ndefined as follows. Thanks to Kesten-Stigum theorem:\nd\n\ne\u2212t |T(t)| \u2212\u2192 W\n\n(28)\n\nwhere W > 0 almost surely. In the Yule case, W is well known to be an exponential\nrandom variable with mean 1. We next define a metric \u03b4 on \u2202T by declaring that\nfor \u03b6, \u03b6 \u2032 \u2208 \u2202T, \u03b4(\u03b6, \u03b6 \u2032 ) = e\u2212t where t is the time of the \"most recent common\nancestor\", that is, t = sup{s \u2265 0 : \u03b6(s) = \u03b6 \u2032 (s)}. (\u03b4 is the so-called genealogical\nmetric on \u2202T). A ball B of radius t for \u03b4 consists of all rays which pass through a\ngiven vertex z \u2208 T, at distance t from the root. The subtree containing z is itself\na Yule tree and hence the Kesten-Stigum theorem applies to it, let W (z) be the\nassociated Kesten-Stigum random variable as in (28). Then define\n\u03bc(B) = e\u2212t W (z).\nIt is easy to see that \u03bc satisfies the assumptions of Carath\u00e9odory's extension theorem (see, e.g., [11], p. 444) and hence defines a finite measure on \u2202T, with total\nmass \u03bc(\u2202T) = W (o). It will also be convenient to define the probability measure\n\u03bc\u266f (*) = \u03bc(*)/\u03bc(\u2202T).\nThen our key claim is that we can identify (\u2202T, \u03bc\u266f ) with Evans' metric space\n(S, \u03b7):\n(\u2202T, \u03bc\u266f ) \u21cb (S, \u03b7),\n(29)\nin the sense that we can find a continuous one-to-one map \u03a6 : S \u2192 \u2202T such that\nif x \u2208 S and \u03b6 = \u03a6(x),\n\u03b7{B(x, t)} = \u03bc\u266f {B(\u03b6, 1 \u2212 U (t))},\n\n(30)\n\nwhere U (t) is the time-change appearing in Theorem 1. To do this, we first define\n\u03a6 on the integers. For i \u2208 N, simply define \u03a6(i) to be the ray associated with\n\n22\n\n\fexcursion \u03b5i , where \u03b51 , \u03b52 , . . . are the excursions of B above level 1, ordered by\ntheir respective heights. The definition of \u03a6 is easily extended to x \u2208 S by taking\na suitable sequence xn \u2208 N with xn \u2192 x (see the proof of Theorem 5 in [7] for\nfurther details).\nHaving made the identification (30), it turns out that Theorem 4 is now an\neasy application of Theorem 1.2 in [18] and Theorem 1 in [19]. These results are\nderived for a discrete-time Galton-Watson tree T , and state the following. Assume\nthat T is a discrete-time Galton-Watson tree and that the number of offsprings L\nof an individual is such that for some r > 0, E(exp(rL)) = \u221e but E(exp(tL)) < \u221e\nif t < r, and L is unbounded. Then we have, by Theorem 1.2 in [18] (corresponding\nto the thick part of the spectrum), for all 0 \u2264 \u03b8 \u2264 a/r:\n\u001a\n\u001b\n\u03bc(B(\u03be, e\u2212n ))\ndim \u03be \u2208 \u2202T : lim sup\n= \u03b8 = a \u2212 r\u03b8,\n(31)\nm\u2212n n\nn\u2192\u221e\nwhere a = log E(L) and m = E(L). Moreover when \u03b8 = a/r the above set is\nnon-empty (see Lemma 3.3 (ii) in [18]). Assuming further that P(L = 1) > 0 (the\nSchr\u00f6der case) and letting \u03c4 = \u2212 log P(L = 1)/a we have, by Theorem 1 in [19],\n(corresponding to the thin part of the spectrum), for all a \u2264 \u03b8 \u2264 a(1 + 1/\u03c4 ):\n\u001b\n\u001a\na\n\u2212 log \u03bc(B(\u03be, e\u2212n ))\n= \u03b8 = a( (1 + \u03c4 ) \u2212 \u03c4 ).\n(32)\ndim \u03be \u2208 \u2202T : lim sup\nn\n\u03b8\nn\u2192\u221e\nMoreover when \u03b8 = a(1 + 1/\u03c4 ), the above set is non-empty almost surely. To use\nthese results in our case, let T be the discrete-time tree obtained by sampling T at\ndiscrete times 1, 2, . . ., so T is a discrete-time Galton-Watson process which belongs\nto the Schr\u00f6der class. The random variable W = W (o) is of course unchanged so it\nis an exponential random variable with mean 1 (note that W is only equal to half\nthe local time Z1 , corresponding to a \"one-sided\" L\u00e9vy approximation of Z1 from\nbelow: see, e.g., (1.11) and (1.19) in Chapter VI of [22]). The distribution of L is\nnot particularly nice to write down but it is unbounded and we may nonetheless\nidentify the parameters a, r and \u03c4 as follows. Note first that since W is exponential\nwith parameter 1, r = 1. Moreover, since\n{e\u2212t Yt , t \u2265 0} is a martingale\nwe obtain m = E(Y1 ) = E(L) = e, so a = log E(L) = 1. We obtain \u03c4 by computing\nP(L = 1) = e\u22121 since every individual branches at rate 1, and hence \u03c4 = 1 as\nwell. Using (30) together with (31) and (32), it is now straightforward to deduce\nTheorem 4. The details are left to the reader and are similar (in fact, much easier)\nthan the proof of Lemma 26 in [7]. Note in particular that, since the construction\nof Kingman's coalescent in Theorem 1 holds at a fixed deterministic level 1, we\navoid the use of Lemma 24 in [7].\n\n23\n\n\fAcknowledgements\nWe thank Christina Goldschmidt for sharing with us her thoughts about the Martin\nboundary of Galton-Watson trees, and we thank Ed Perkins for useful discussions.\nThis work started when J.B. was at Universit\u00e9 de Provence in Marseille, and N.B.\nwas a postdoc at University of British Columbia. J.B. thanks the Math department\nof UBC for their invitation, during which this work started.\n\nReferences\n[1] D. Aldous (1991). The continuum random tree I. Ann. Probab. 19, 1-28.\n[2] D. Aldous (1993). The continuum random tree III. Ann. Probab. 21, 248-289.\n[3] D. J. Aldous (1998). Brownian excusion conditioned on its local time. Elect.\nComm. in Probab., 3, 79\u201390.\n[4] D. Aldous (1999). Deterministic and stochastic models for coalescence (aggregation and coagulation): a review of the mean-field theory for probabilists.\nBernoulli, 5: 3\u201348.\n[5] J. Berestycki, N. Berestycki and V. Limic. (2008). Interpreting \u039b-coalescent\nspeed of coming down from infinity via particle representation of superprocesses. In preparation.\n[6] J. Berestycki, N. Berestycki and J. Schweinsberg (2005). Small-time behavior\nof beta-coalescents. Ann. Inst. H. Poincar\u00e9 (B) Probabilit\u00e9s et Statistiques,\n44:2, 214-238\n[7] J. Berestycki, N. Berestycki and J. Schweinsberg (2007). Beta-coalescents and\ncontinuous stable random trees. Ann. Probab. 35, 1835-1887.\n[8] J. Bertoin (2006). Random Fragmentation and Coagulation Processes. Cambridge Studies in Advanced Mathematics.\n[9] J. Bertoin and C. Goldschmidt (2004). Dual random fragmentation and coagulation and an application to the genealogy of Yule processes. In Mathematics\nand Computer Science III: Algorithms, Trees, Combinatorics and Probabilities. M. Drmota, P. Flajolet, D. Gardy, B. Gittenberger (Eds.), 295\u2013308.\n[10] T. Duquesne and J.-F. Le Gall (2002). Random Trees, L\u00e9vy Processes, and\nSpatial Branching Processes. Ast\u00e9risque 281.\n\n24\n\n\f[11] R. Durrett (2004). Probability: theory and examples. Duxbury advanced series, 3rd edition.\n[12] A. Etheridge (2000). An Introduction to Superprocesses. American Mathematical Society, University Lecture series, 20.\n[13] S. N. Evans. (2000). Kingman's coalescent as a random metric space. In\nStochastic Models: A Conference in Honour of Professor Donald A. Dawson (L. G. Gorostiza and B. G. Ivanoff eds.) Canadian Mathematical Society/American Mathematical Society.\n[14] C. Goldschmidt. Private communication.\n[15] J. F. C. Kingman (1982). The coalescent. Stoch. Proc. Appl. 13, 235\u2013248.\n[16] J.-F. Le Gall (1993). The uniform random tree in the Brownian excurion.\nProb. Th. Rel. Fields, 96, 369\u2013383.\n[17] R. Lyons (1990). Random walks and percolation on trees. Ann. Probab., 18,\n931\u2013958.\n[18] P. M\u00f6rters and N.-R. Shieh (2002). Thin and thick points for branching measure on a Galton-Watson tree. Statistics and Probability Letters 58, 13\u201322.\n[19] P. M\u00f6rters and N.-R. Shieh (2004). On the multifractal spectrum for branching measure on a Galton-Watson tree. Journal of Applied Probability 41, 1223\u2013\n1229.\n[20] J. Neveu and J. Pitman (1989). The branching process in a Brownian excursion. S\u00e9minaire de Probabilit\u00e9s XXIII, Lecture Notes Math. 1372:248\u2013257,\nSpringer.\n[21] E. A. Perkins (1991). Conditional Dawson-Watanabe superprocesses and\nFleming-Viot process. Seminar on Stochastic Processes. Birkhauser.\n[22] D. Revuz and M. Yor. Continuous martingales and Brownian motion.\nGrundlehren der mathematischen Wissenschaften, Vol. 293, Springer. 3rd edition, 1999.\n[23] J. Warren (1999). On a result of David Aldous concerning the trees in the\nconditioned excursion. Elect. Comm. in Probab. 4, 25\u201329.\n[24] J. Warren and M. Yor (1998). The Brownian burglar: conditioning Brownian\nmotion on its local time process. In J. Az\u00e9ma, M. Emery, M. Ledoux and M.\nYor, eds. S\u00e9minaire de Probabilit\u00e9s XXXII 328\u2013342, Springer, Lecture Notes\nin Math. 1686.\n\n25\n\n\f"}