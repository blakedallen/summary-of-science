{"id": "http://arxiv.org/abs/0906.3299v3", "guidislink": true, "updated": "2010-11-15T17:07:04Z", "updated_parsed": [2010, 11, 15, 17, 7, 4, 0, 319, 0], "published": "2009-06-18T17:26:15Z", "published_parsed": [2009, 6, 18, 17, 26, 15, 3, 169, 0], "title": "Filling the gap between Tur\u00e1n's theorem and P\u00f3sa's conjecture", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0906.4665%2C0906.0483%2C0906.0667%2C0906.2345%2C0906.3453%2C0906.4969%2C0906.4988%2C0906.0127%2C0906.3962%2C0906.2936%2C0906.3703%2C0906.2123%2C0906.2667%2C0906.5357%2C0906.1697%2C0906.3256%2C0906.5036%2C0906.3406%2C0906.0797%2C0906.4713%2C0906.3275%2C0906.5583%2C0906.2532%2C0906.5350%2C0906.4940%2C0906.4328%2C0906.1854%2C0906.4138%2C0906.3946%2C0906.1849%2C0906.2949%2C0906.0848%2C0906.2461%2C0906.1101%2C0906.2858%2C0906.0437%2C0906.3116%2C0906.1136%2C0906.1055%2C0906.3367%2C0906.5415%2C0906.5136%2C0906.3512%2C0906.0655%2C0906.1743%2C0906.3392%2C0906.0498%2C0906.4542%2C0906.3158%2C0906.3034%2C0906.0832%2C0906.2539%2C0906.3318%2C0906.4814%2C0906.0810%2C0906.1228%2C0906.5176%2C0906.3151%2C0906.1542%2C0906.3132%2C0906.5061%2C0906.3299%2C0906.2498%2C0906.1164%2C0906.3907%2C0906.4263%2C0906.5553%2C0906.1019%2C0906.0653%2C0906.3921%2C0906.0780%2C0906.2162%2C0906.2153%2C0906.2334%2C0906.5435%2C0906.5015%2C0906.4883%2C0906.3687%2C0906.4068%2C0906.4381%2C0906.0703%2C0906.1641%2C0906.1500%2C0906.0450%2C0906.0482%2C0906.4077%2C0906.4567%2C0906.1638%2C0906.2404%2C0906.1254%2C0906.1283%2C0906.1459%2C0906.5580%2C0906.2097%2C0906.0441%2C0906.4726%2C0906.4977%2C0906.0709%2C0906.0338%2C0906.0816%2C0906.4250&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Filling the gap between Tur\u00e1n's theorem and P\u00f3sa's conjecture"}, "summary": "Much of extremal graph theory has concentrated either on finding very small\nsubgraphs of a large graph (Turan-type results) or on finding spanning\nsubgraphs (Dirac-type results). In this paper we are interested in finding\nintermediate-sized subgraphs. We investigate minimum degree conditions under\nwhich a graph G contains squared paths and squared cycles of arbitrary\nspecified lengths. We determine precise thresholds, assuming that the order of\nG is large. This extends results of Fan and Kierstead [J. Combin. Theory Ser. B\n63 (1995), 55--64] and of Komlos, Sarkozy, and Szemeredi [Random Structures\nAlgorithms 9 (1996), 193--211] concerning the containment of a spanning squared\npath and a spanning squared cycle, respectively. Our results show that such\nminimum degree conditions constitute not merely an interpolation between the\ncorresponding Turan-type and Dirac-type results, but exhibit other interesting\nphenomena.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0906.4665%2C0906.0483%2C0906.0667%2C0906.2345%2C0906.3453%2C0906.4969%2C0906.4988%2C0906.0127%2C0906.3962%2C0906.2936%2C0906.3703%2C0906.2123%2C0906.2667%2C0906.5357%2C0906.1697%2C0906.3256%2C0906.5036%2C0906.3406%2C0906.0797%2C0906.4713%2C0906.3275%2C0906.5583%2C0906.2532%2C0906.5350%2C0906.4940%2C0906.4328%2C0906.1854%2C0906.4138%2C0906.3946%2C0906.1849%2C0906.2949%2C0906.0848%2C0906.2461%2C0906.1101%2C0906.2858%2C0906.0437%2C0906.3116%2C0906.1136%2C0906.1055%2C0906.3367%2C0906.5415%2C0906.5136%2C0906.3512%2C0906.0655%2C0906.1743%2C0906.3392%2C0906.0498%2C0906.4542%2C0906.3158%2C0906.3034%2C0906.0832%2C0906.2539%2C0906.3318%2C0906.4814%2C0906.0810%2C0906.1228%2C0906.5176%2C0906.3151%2C0906.1542%2C0906.3132%2C0906.5061%2C0906.3299%2C0906.2498%2C0906.1164%2C0906.3907%2C0906.4263%2C0906.5553%2C0906.1019%2C0906.0653%2C0906.3921%2C0906.0780%2C0906.2162%2C0906.2153%2C0906.2334%2C0906.5435%2C0906.5015%2C0906.4883%2C0906.3687%2C0906.4068%2C0906.4381%2C0906.0703%2C0906.1641%2C0906.1500%2C0906.0450%2C0906.0482%2C0906.4077%2C0906.4567%2C0906.1638%2C0906.2404%2C0906.1254%2C0906.1283%2C0906.1459%2C0906.5580%2C0906.2097%2C0906.0441%2C0906.4726%2C0906.4977%2C0906.0709%2C0906.0338%2C0906.0816%2C0906.4250&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Much of extremal graph theory has concentrated either on finding very small\nsubgraphs of a large graph (Turan-type results) or on finding spanning\nsubgraphs (Dirac-type results). In this paper we are interested in finding\nintermediate-sized subgraphs. We investigate minimum degree conditions under\nwhich a graph G contains squared paths and squared cycles of arbitrary\nspecified lengths. We determine precise thresholds, assuming that the order of\nG is large. This extends results of Fan and Kierstead [J. Combin. Theory Ser. B\n63 (1995), 55--64] and of Komlos, Sarkozy, and Szemeredi [Random Structures\nAlgorithms 9 (1996), 193--211] concerning the containment of a spanning squared\npath and a spanning squared cycle, respectively. Our results show that such\nminimum degree conditions constitute not merely an interpolation between the\ncorresponding Turan-type and Dirac-type results, but exhibit other interesting\nphenomena."}, "authors": ["Peter Allen", "Julia B\u00f6ttcher", "Jan Hladk\u00fd"], "author_detail": {"name": "Jan Hladk\u00fd"}, "author": "Jan Hladk\u00fd", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1112/jlms/jdr007", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0906.3299v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0906.3299v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "44 pages, 2 figures; small errors corrected", "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0906.3299v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0906.3299v3", "journal_reference": "J. Lond. Math. Soc. (2) 84, no. 2, 269-302 (2011)", "doi": "10.1112/jlms/jdr007", "fulltext": "FILLING THE GAP BETWEEN TUR\u00c1N'S THEOREM\nAND P\u00d3SA'S CONJECTURE\n\narXiv:0906.3299v3 [math.CO] 15 Nov 2010\n\nPETER ALLEN*, JULIA B\u00d6TTCHER\u2020, AND JAN HLADK\u00dd\u2021\nAbstract. Much of extremal graph theory has concentrated either on finding very small subgraphs of a large graph (Tur\u00e1ntype results) or on finding spanning subgraphs (Dirac-type results).\nIn this paper we are interested in finding intermediate-sized subgraphs. We investigate minimum degree conditions under which\na graph G contains squared paths and squared cycles of arbitrary\nspecified lengths. We determine precise thresholds, assuming that\nthe order of G is large. This extends results of Fan and Kierstead [J. Combin. Theory Ser. B 63 (1995), 55\u201364] and of Koml\u00f3s,\nSark\u00f6zy, and Szemer\u00e9di [Random Structures Algorithms 9 (1996),\n193\u2013211] concerning the containment of a spanning squared path\nand a spanning squared cycle, respectively. Our results show that\nsuch minimum degree conditions constitute not merely an interpolation between the corresponding Tur\u00e1n-type and Dirac-type results, but exhibit other interesting phenomena.\n\n1. Introduction\nOne of the main programmes of extremal graph theory is the study of\nconditions on the vertex degrees of a host graph G under which a target\ngraph H appears as a subgraph of G (which we denote by H \u2286 G).\nTur\u00e1n's theorem [21] is a prominent example for results of this type.\nr\u22122\nIt asserts that an average degree d(G) > r\u22121\nn forces the copy of a\ncomplete graph Kr in G (and that this is best possible), where here\nand throughout n is the number of vertices in the host graph G. More\ngenerally, the celebrated theorem of Erd\u0151s and Stone [5] implies that\nfor a fixed graph H the chromatic number \u03c7(H) of H determines the\naverage degree that is necessary to guarantee a copy of H: If H has\nDate: January 6, 2019.\n* DIMAP and Mathematics Institute, University of Warwick, Coventry, CV4\n7AL, United Kingdom. E-mail : P.D.Allen@warwick.ac.uk .\n\u2020Zentrum Mathematik, Technische Universit\u00e4t M\u00fcnchen, Boltzmannstrasse 3,\nD-85747 Garching bei M\u00fcnchen, Germany. E-mail : boettche@ma.tum.de .\n\u2021Department of Applied Mathematics, Faculty of Mathematics and Physics,\nCharles University, Malostransk\u00e9 n\u00e1m\u011bst\u0131\u0301 25, 118 00, Prague, Czech Republic and\nDIMAP and Department of Computer Science, University of Warwick, Coventry,\nCV4 7AL, United Kingdom. E-mail : honzahladky@gmail.com .\nPA was partially supported by DIMAP, EPSRC award EP/D063191/1, JB by\nDFG grant TA 309/2-1, JH by the Charles University grant GAUK 202-10/258009,\nby DAAD, by BAYHOST, and by DIMAP, EPSRC award EP/D063191/1.\n1\n\n\f2\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nr\u22122\nchromatic number \u03c7(H) = r and d(G) \u2265 ( r\u22121\n+ o(1))n, then H is a\nsubgraph of G. This settles the problem for fixed target graphs (with\nchromatic number at least 3), that is, graphs that are 'small' compared\nto the host graph.\n\nDirac's theorem [4], another classical result from the area, considers\ntarget graphs that are of the same order as the host graph, i.e., socalled spanning target graphs. Clearly, any average degree condition\non the host graph that enforces a connected spanning subgraph must\nbe trivial, and hence the average degree needs a suitable replacement\nin this setting. Here, the minimum degree is a natural candidate, and\nindeed, Dirac's theorem asserts that every graph G with minimum\ndegree \u03b4(G) > 12 n has a Hamilton cycle. This implies in particular\nthat G has a matching covering 2\u230an/2\u230b vertices.\nA 3-chromatic version of this matching result follows from a theorem by Corr\u00e1di and Hajnal [3]: the minimum degree condition \u03b4(G) \u2265\n2\u230an/3\u230b implies the existence of a so-called spanning triangle factor in G,\nthat is, a collection of \u230an/3\u230b vertex disjoint triangles. A well-known\nconjecture of P\u00f3sa (see, e.g., [6]) asserts that roughly the same minimum degree actually guarantees the existence of a connected supergraph of a spanning triangle factor. It states that any graph G with\n\u03b4(G) \u2265 23 n contains a spanning squared cycle Cn2 , where the square of\na graph, F 2 , is obtained from F by adding edges between all pairs of\nvertices with distance 2 in F . This can be seen as a 3-chromatic analogue of Dirac's theorem, which turned out to be much more difficult\nthan its 2-chromatic cousin.\nFan and Kierstead [7] proved an approximate version of P\u00f3sa's conjecture for large n. In addition they determined a sufficient and best\npossible minimum degree condition for the case that the squared cycle\nin P\u00f3sa's conjecture is replaced by a squared path Pn2, i.e., the square\nof a spanning path Pn .\nTheorem 1 (Fan & Kierstead [8]). If G is a graph on n vertices with\nminimum degree \u03b4(G) \u2265 (2n\u22121)/3, then G contains a spanning squared\npath Pn2.\nThe P\u00f3sa Conjecture was verified for large values of n by Koml\u00f3s,\nSark\u00f6zy, and Szemer\u00e9di [10]. The proof in [10] actually asserts the\nfollowing stronger result, which guarantees not only spanning squared\ncycles but additionally squared cycles of all lengths between 3 and n\nthat are divisible by 3.\nTheorem 2 (Koml\u00f3s, S\u00e1rk\u00f6zy & Szemer\u00e9di [10]). There exists an integer n0 such that for all integers n > n0 any graph G of order n and\n2\nminimum degree \u03b4(G) \u2265 32 n contains all squared cycles C3l\n\u2286 G with\n2\n3 \u2264 3l \u2264 n. If furthermore K4 \u2286 G, then Cl \u2286 G for any 3 \u2264 l \u2264 n\nwith l 6= 5.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n3\n\nFor squared cycles Cl2 with l not divisible by 3 the additional condition K4 \u2286 G is necessary because these target graphs are not 3colourable and hence a complete 3-partite graph shows that one cannot\nhope to force Cl2 unless \u03b4(G) \u2265 (2n+1)/3. If \u03b4(G) \u2265 (2n+1)/3, on the\nother hand, then Tur\u00e1n's Theorem asserts that G contains a copy of K4\nand hence Theorem 2 implies Cl2 \u2286 G for any 3 \u2264 l \u2264 n with l 6= 5.\nThe case l = 5 has to be excluded because C52 is the 5-chromatic K5 .\nIn this paper we address the question of what happens between these\ntwo extrema of target graphs with constant order and order n. We are\ninterested in essentially best possible minimum degree conditions that\nenforce subgraphs covering a certain percentage of the host graph.\nLet us start with a simple example. It is easy to see that every\ngraph G with minimum degree \u03b4(G) \u2265 \u03b4 for 0 \u2264 \u03b4 \u2264 21 n has a matching\ncovering at least 2\u03b4 vertices (see Proposition 12(a )). This gives a linear\ndependence between the forced size of a matching in the host graph and\nits minimum degree. A more general form of the result of Corr\u00e1di and\nHajnal [3] mentioned earlier is a variant of this linear dependence for\ntriangle factors.\nTheorem 3 (Corr\u00e1di & Hajnal [3]). Let G be a graph on n vertices\nwith minimum degree \u03b4(G) = \u03b4 \u2208 [ 21 n, 23 n]. Then G contains 2\u03b4 \u2212 n\nvertex disjoint triangles.\nThe main theorem of this paper is a corresponding result mediating\nbetween Tur\u00e1n's theorem and P\u00f3sa's conjecture. More precisely, our\naim is to provide exact minimum degree thresholds for the appearance\nof a squared path Pl2 and a squared cycle Cl2 .\nThere are at least two reasonable guesses one might make as to what\nminimum degree \u03b4(G) = \u03b4 will guarantee which length l = l(n, \u03b4) of\nsquared path (or longest squared cycle). On the one hand, the degree\nthreshold for a spanning squared path or cycle and for a spanning\ntriangle factor are approximately the same. So perhaps this remains\ntrue for smaller l: in light of Theorem 3 one could expect that l(n, \u03b4)\nwere roughly 3(2\u03b4(G) \u2212 n). This turns out to be far too optimistic.\nOn the other hand, proofs of preceding results dealing with spanning\nsubgraphs essentially combine greedy techniques with local changes.\nThey simply start to construct the desired subgraph in (almost) any\nlocation, and in the event of getting stuck change only a few of the\nvertices embedded so far; at no time do they scrap an entire halfconstructed object and start anew. It would not be unreasonable to\nbelieve that this technique also leads to best possible minimum degree conditions for large but not spanning subgraphs. Clearly, in the\ncase of (unsquared) paths such a greedy strategy provides a path of\nlength \u03b4(G) + 1. As G might be disconnected, however, it cannot guarantee longer paths if \u03b4(G) < n/2. For squared paths the following\n\n\f4\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nconstruction shows that with an arbitrary starting location one cannot hope for squared paths on more than 23 (2\u03b4(G) \u2212 n) vertices: If G\ncontains disjoint cliques C and C \u2032 of orders 2\u03b4 \u2212 n and n \u2212 \u03b4, and an\nindependent set I of order n \u2212 \u03b4 such that all vertices of C and C \u2032\nare connected to all vertices of I but not to other vertices of G, then\nit is not difficult to see that the longest squared path in G starting\nin an edge of C has length 32 (2\u03b4(G) \u2212 n). This could lead to the idea\nthat l(n, \u03b4) were approximately 32 (2\u03b4(G) \u2212 n). It is true that there\nare squared paths of this length in G-but this lower bound is almost\nalways excessively pessimistic. In other words, it turns out that one\nhas to carefully choose the 'region' of G to look for the desired squared\npath. Since spanning squared paths use all vertices of G this problem\ndoes not occur for these subgraphs.\nFor fixed n both guesses propose a linear dependence between \u03b4 and\nthe length l(n, \u03b4) of a forced squared path (or cycle). As we will see\nbelow l(n, \u03b4) as a function of \u03b4 behaves very differently: it is piecewise linear but jumps at certain points. (These jumps can be viewed\nas phase transitions for the appearance of squared paths or cycles.)\nTo make this precise we introduce the following functions. Given two\npositive integers n and \u03b4 with \u03b4 \u2208 ( 12 n, n \u2212 1], we define rp (n, \u03b4) to be\nthe largest integer r such that n \u2212 \u03b4 + \u230a\u03b4/r\u230b > \u03b4 and rc (n, \u03b4) to be the\nlargest integer r such that n \u2212 \u03b4 + \u2308\u03b4/r\u2309 > \u03b4. We then define\nm o\nnl\n1\n3\n\u2308\u03b4/r\n(n,\n\u03b4)\u2309\n+\n, n , and\nsp(n, \u03b4) := min\np\n2\n2\nnj\nk o\n(1)\n3\nsc(n, \u03b4) := min\n\u2308\u03b4/rc (n, \u03b4)\u2309 , n .\n2\nObserve that sc(n, \u03b4) \u2264 sp(n, \u03b4) and that for almost every \u03b1 \u2208 (0, 1)\nwe have limn\u2192\u221e sc(n, \u03b1n)/n = limn\u2192\u221e sp(n, \u03b1n)/n. The dependence\nbetween sp(n, \u03b4) and \u03b4 is illustrated in Figure 1.\nOur main theorem now states states that sp(n, \u03b4) and sc(n, \u03b4) are\nthe maximal lengths of squared paths and cycles, respectively, forced\nin an n-vertex graph G with minimum degree \u03b4. More generally, and in\naccordance with Theorem 2, we show that G also contains any shorter\nsquared cycle with length divisible by 3 (see (i ) of Theorem 4). We\nshall show below that these results are tight by explicitly constructing\nextremal graphs Gp (n, \u03b4) and Gc (n, \u03b4) for squared paths and cycles.\nWhile the extremal graphs of all previously discussed results are Tur\u00e1n\ngraphs (complete r-partite graphs, where r = 3 in the case of squared\npaths and cycles) the graphs Gp (n, \u03b4) and Gc (n, \u03b4) have a rather different structure. In fact they do contain squared cycles Cl2 for all\n3 \u2264 l \u2264 sc(n, \u03b4) with l 6= 5. If any one of these 'extra' squared cycles\nwith chromatic number 4 is not present in the host graph G, then (ii )\nof Theorem 4 guarantees even much longer squared cycles Cl2 in G,\nwhere l is a multiple of 3.\n\n\fPSfrag replacements\nBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\nn\n\n5\n\n3\n(2\u03b4\n2\n\n\u2212 n)\n4\u03b4 \u2212 2n\n6\u03b4 \u2212 3n\nsp(n, \u03b4)\n\n4n\n5\n\n3n\n5\n\n2n\n5\n\nn\n5\n\n0\n\nn\n2\n\n6n\n11\n\n5n\n9\n\n4n\n7\n\n\u03b4\n\n3n\n5\n\n2n\n3\n\nFigure 1. The behaviour of sp(n, \u03b4).\nTheorem 4. For any \u03bd > 0 there exists an integer n0 such that for\nall integers n > n0 and \u03b4 \u2208 [( 12 + \u03bd)n, 32 n] the following holds for all\nn-vertex graphs G with minimum degree \u03b4(G) \u2265 \u03b4.\n2\n(i ) Psp(n,\u03b4)\n\u2286 G and Cl2 \u2286 G for every l \u2208 N with 3 \u2264 l \u2264 sc(n, \u03b4)\nsuch that 3 divides l.\n(ii ) Either Cl2 \u2286 G for every l \u2208 N with 3 \u2264 l \u2264 sc(n, \u03b4) and l 6= 5,\nor Cl2 \u2286 G for every l \u2208 N with 3 \u2264 l \u2264 6\u03b4 \u2212 3n \u2212 \u03bdn such that 3\ndivides l.\nThe proof of this result relies on Szemer\u00e9di's Regularity Lemma1 and\nis presented together with the main lemmas in Section 2. Theorem 4\ncannot be extended to all values of \u03b4(G) with \u03b4(G)\u2212 12 n = o(n) because\nfor infinitely many\n\u221a values of m there are C4 -free graphs F on m vertices\nwith \u03b4(F ) \u2265 21 m (see [18]). Then, letting G be the n-vertex graph\n\u221a\nobtained from F by adding an independent set I on m\u2212\u230a 21 m\u230b vertices\nand inserting\nall edges between F and I, it is easy to see that \u03b4(G) >\n1\u221a\n1\nn + 5 n but G does not contain a copy of C62 .\n2\nThe following extremal graphs show that the bounds in (i ) and (ii )\nof Theorem 4 are tight (see also Figure 2). For (ii ) consider the\ncomplete tripartite graph Kn\u2212\u03b4,n\u2212\u03b4,2\u03b4\u2212n . Clearly, this graph has minimum degree \u03b4 and does not contain Cl2 for any l \u2265 3 not divisible by 3 or l \u2265 3(2\u03b4 \u2212 n). For the first part of (i ), let Gp (n, \u03b4)\n1We\n\nrefer to [14] for a survey on applications of the Regularity Lemma on graph\nembedding problems.\n\n\f6\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nbe the n-vertex graph obtained from the disjoint union of an independent set Y on n \u2212 \u03b4 vertices and r := rp (n, \u03b4) cliques X1 , . . . , Xr\nwith |X1 | \u2264 * * * \u2264 |Xr | \u2264 |X1 | + 1 on a total of \u03b4 vertices, by inserting\nall edges between Y and Xi for each i \u2208 [r]. It is easy to check that\n\u03b4(Gp (n, \u03b4)) = \u03b4. Moreover any squared path Pm2 \u2286 Gp (n, \u03b4) contains\nvertices from at most one clique Xi . As Y is independent and Pm2\nhas independence number \u2308m/3\u2309 we have \u230a2m/3\u230b \u2264 \u2308\u03b4/rp (n, \u03b4)\u2309 and\nthus m \u2264 \u230a 12 (3\u2308\u03b4/rp (n, \u03b4)\u2309 + 1)\u230b = sp(n, \u03b4). For the second part\nof (i ), we construct the graph G\u2032c (n, \u03b4) in the same way as Gp (n, \u03b4)\nbut with r := rc (n, \u03b4) and with |Xi | = \u2308\u03b4/r\u2309 for all i \u2208 [r]. To obtain\nan n-vertex graph Gc (n, \u03b4) from G\u2032c (n, \u03b4) choose vi in Xi arbitrarily for\neach i \u2208 [r] and identify all vi with i \u2264 r\u2308\u03b4/r\u2309 \u2212 \u03b4. Again Gc (n, \u03b4) has\n2\nminimum degree \u03b4, any squared cycle Cm\nin Gc (n, \u03b4) touches only one\nof the Xi , and hence m \u2264 sc(n, \u03b4).\n\nPSfrag replacements\n\nn\u2212\u03b4\n\nn\u2212\u03b4\n\nn\u2212\u03b4\n\nn\u2212\u03b4\n2\u03b4 \u2212 n\n\nGp (n, \u03b4)\n\nGc (n, \u03b4)\n\nKn\u2212\u03b4,n\u2212\u03b4,2\u03b4\u2212n\n\nFigure 2. The extremal graphs, for the case rp (n, \u03b4) =\nrc (n, \u03b4) = 4.\n\nBefore closing this introduction let us remark that similar phenomena to those described in Theorem 4 are observed with simple paths\nand cycles. Every graph with minimum degree \u03b4 contains a path of\nlength \u2308n/\u230an/(\u03b4 + 1)\u230b\u2309, and the extremal graph is a vertex disjoint\nunion of cliques. This follows from an easy adjustment of the proof\nof Dirac's theorem. Improving on results of Nikiforov and Schelp [17]\nthe first author proved the following theorem in [1]. The methods used\nfor obtaining this result are quite different from those applied in this\npaper. In particular they do not rely on the Regularity Lemma.\nTheorem 5 (Allen [1]). Given an integer k \u2265 2 there is n0 such that\nwhenever n \u2265 n0 and G is an n-vertex graph with minimum degree\n\u03b4 \u2265 n/k, the following are true.\n(i ) G contains Ct for every even 4 \u2264 t \u2264 \u2308n/(k \u2212 1)\u2309,\n(ii ) if G does not contain a cycle of every length from \u230a2n/\u03b4\u230b \u2212 1\nto \u2308n/(k \u2212 1)\u2309 inclusive then G does contain Ct for every even\n4 \u2264 t \u2264 2\u03b4.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n7\n\n2. Main lemmas and proof of Theorem 4\nOur proof of Theorem 4 combines the Stability Method pioneered\nby Simonovits [19], the Regularity Method which pivots around the\njoint application of Szemer\u00e9di's celebrated Regularity Lemma [20], and\nthe so-called Blow-up Lemma by Koml\u00f3s, S\u00e1rk\u00f6zy and Szemer\u00e9di [11].\nThe combination of these three methods has proved useful for a variety of exact embedding results and was applied for example in [10].\nHowever, this well-established technique provides only a rather loose\nframework for proofs of this kind. For our application we will embellish this framework with a new concept, which we call the connected\ntriangle components of a graph.\nIn this section we explain how we use connected triangle components,\nthe Regularity Method, and the Stability Method. We first provide the\nnecessary definitions, formulate our main lemmas (whose proofs are\nprovided in the remaining sections of this paper), and sketch how they\nwork together in the proof of Theorem 4. The details of this proof are\nthen presented at the end of this section.\nNotation. For a graph G we write V (G) and E(G) to denote its vertex\nset and edge set, respectively, and set v(G) = |V (G)|, e(G) = |E(G)|\nand e(X, Y ) = |{xy \u2208 E(G) : x \u2208 X, y \u2208 Y }| for sets X, Y \u2286 V (G).\nThe graph G[X] is the subgraph of G induced by X. The neighbourhood of a vertex v in G is denoted by \u0393(v) and \u0393(u, v) is the common\nneighbourhood of u, v \u2208 V (G). For an edge uv = e \u2208 E(G) we also\nwrite \u0393(e) = \u0393(u, v). The minimum degree of G is denoted by \u03b4(G)\nand for two sets X, Y \u2286 V (G) we define \u03b4Y (X) = minx\u2208X |\u0393(x) \u2229 Y |\nand \u03b4G (X) = \u03b4V (G) (X).\nWhen we say that a statement S(\u01eb, \u01eb\u2032 ) holds for positive real numbers\n\u03b5 \u226b \u03b5\u2032 , then we mean that, given an arbitrary \u03b5 > 0, we can find an\n\u01eb\u2032\u2032 > 0 such that S(\u01eb, \u01eb\u2032 ) holds for all \u01eb\u2032 \u2208 (0, \u01eb\u2032\u2032 ].\n\nConnected triangle components and triangle factors. Connected\ntriangle components and connected triangle factors are the main protagonists in the proof of Theorem 4. Roughly speaking, in a connected\ntriangle component we can start in an arbitrary triangle and reach each\nother triangle by \"walking\" through a sequence of triangles, and a connected triangle factor is a collection of vertex disjoint triangles each\npair of which is connected in this way.\nTo make this precise, let G = (V, E) be a graph. A triangle walk\nin G is a sequence of edges e1 , . . . , ep in G such that ei and ei+1 share\na triangle of G for all i \u2208 [p \u2212 1]. We say that e1 and ep are triangle\nconnected in G. A triangle component of G is a maximal set of edges\nC \u2286 E such that every pair of edges in C is triangle connected. Observe\nthat this induces an equivalence relation on the edges of G, but a\nvertex may be part of many triangle components. In addition a triangle\ncomponent does not need to form an induced subgraph of G in general.\n\n\f8\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nThe vertices of a triangle component Ci are all vertices v such that some\nedge uv of G is contained in Ci . We define the size |C| of a triangle\ncomponent C to be the number of vertices of C.\nA triangle factor T in a graph G is a collection of vertex disjoint\ntriangles in G. T is a connected triangle factor if all edges of T are in\nthe same triangle component of G. We define the size of T to be the\nnumber of vertices covered by T . We let CTF(G) denote the maximum\nsize of a connected triangle factor in G. It is not difficult to check for\nexample that any connected triangle factor in Gp (n, \u03b4) contains only\nvertices of at most one of the cliques Xi (cf. the definition of Gp (n, \u03b4)\nbelow Theorem 4) and of the independent set Y . Hence\n(2)\n\n\u0016\n\n\u0017\nsp(n, \u03b4)\nCTF Gp (n, \u03b4) = 3\n.\n3\n\u0001\n\nSuppose that a graph G contains a square-path of length l. Then\nobviously, CTF(G) \u2265 3\u230al/3\u230b. Thus, (2) together with Theorem 4(i )\nsays that Gp (n, \u03b4) minimises CTF among all graphs of order n and\nminimum degree \u03b4.\nWe will usually find that the number of vertices in a triangle component and the size of a maximum connected triangle factor in that\ncomponent are quite different. As we will explain next, for the purposes of embedding squared paths and squared cycles, it is the size of\na connected triangle factor that is important.\nThe Regularity Method. The Regularity Lemma provides a partition of a dense graph that is suitable for an application of the Blow-up\nLemma, which is an embedding result for large host graphs. In order\nto formulate the versions of these two lemmas that we will use, we first\nintroduce some terminology.\nLet G = (V, E) be a graph and \u03b5, d \u2208 (0, 1]. For disjoint nonempty\nU, W \u2286 V the density of the pair (U, W ) is d(U, W ) = e(U, W )/|U||W |.\nA pair (U, W ) is \u03b5-regular if |d(U \u2032 , W \u2032) \u2212 d(U, W )| \u2264 \u03b5 for all U \u2032 \u2286 U\nand W \u2032 \u2286 W with |U \u2032 | \u2265 \u03b5|U| and |W \u2032 | \u2265 \u03b5|W |. An \u03b5-regular partition\n \u0307 1 \u222a \u0307 . . . \u222aV\n \u0307 k of V with |V0 | \u2264 \u03b5|V |, |Vi | = |Vj | for\nof G is a partition V0 \u222aV\nall i, j \u2208 [k], and such that for all but at most \u03b5k 2 pairs (i, j) \u2208 [k]2 ,\nthe pair (Vi , Vj ) is \u03b5-regular.\nGiven some 0 < d < 1 and a pair of disjoint vertex sets (Vi , Vj ) in a\ngraph G, we say that (Vi , Vj ) is (\u03b5, d)-regular if it is \u03b5-regular and has\n \u0307 1 \u222a \u0307 . . . \u222aV\n \u0307 k\ndensity at least d. We say that an \u03b5-regular partition V0 \u222aV\nof a graph G is an (\u03b5, d)-regular partition if the following is true. For\nevery 1 \u2264 i \u2264 k, and every vertex v \u2208 Vi , there are at most (\u03b5 + d)n\nedges incident to v which are not contained in (\u03b5, d)-regular pairs of\nthe partition.\n \u0307 1 \u222a \u0307 . . . \u222aV\n \u0307 k of a graph G, we\nGiven an (\u03b5, d)-regular partition V0 \u222aV\ndefine a graph R, called the reduced graph of the partition of G, where\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n9\n\nR = (V (R), E(R)) has V (R) = {V1 , . . . , Vk } and Vi Vj \u2208 E(R) whenever (Vi , Vj ) is an (\u03b5, d)-regular pair. We will usually omit the partition,\nand simply say that G has (\u03b5, d)-reduced graph R. We call the partition\nclasses Vi with i \u2208 [k] clusters of G. Observe that our definition of the\nreduced graph\nS R implies that for T \u2286 V (R) we can for example refer\nto the set T , which is a subset of V (G).\nThe celebrated Szemer\u00e9di Regularity Lemma [20] states that every\nlarge graph has an \u03b5-regular partition with a bounded number of parts.\nHere we state the so-called degree form of this lemma (see, e.g., [13,\nTheorem 1.10]).\nLemma 6 (Regularity Lemma, degree form). For every \u03b5 > 0 and\nevery integer m0 , there is m1 such that for every d \u2208 [0, 1] every graph\nG = (V, E) on n \u2265 k1 vertices has an (\u03b5, d)-reduced graph R on m\nvertices with m0 \u2264 m \u2264 m1 .\nFor our purpose it is convenient to work with even a different version\nof the regularity lemma, which takes into account that we are dealing\nwith graphs of high minimum degree. This lemma is an easy corollary\nof Lemma 6. A proof can be found, e.g., in [16, Proposition 9].\nLemma 7 (Regularity Lemma, minimum degree form). For all \u03b5, d,\n\u03b3 with 0 < \u03b5 < d < \u03b3 < 1 and for every m0 , there is m1 such that\nevery graph G on n > m1 vertices with \u03b4(G) \u2265 \u03b3n has an (\u03b5, d)-reduced\ngraph R on m vertices with m0 \u2264 m \u2264 m1 and \u03b4(R) \u2265 (\u03b3 \u2212 d \u2212 \u03b5)m.\nThis lemma asserts that the reduced graph R of G \"inherits\" the high\nminimum degree of G. We shall use this property in order to reduce\nthe original problem of finding a squared path (or cycle) in an n-vertex\ngraph with minimum degree \u03b3n to the problem of finding an arbitrary\nconnected triangle factor of a certain size in an m-vertex graph R with\nminimum degree (\u03b3 \u2212d\u2212\u03b5)m. The new problem is much less particular\nabout the required subgraph than the original one and hence easier to\nattack (see Lemma 9).\nThis kind of reduction is made possible by the Blow-up Lemma.\nRoughly, this lemma asserts that a bounded degree graph H can be\nembedded into a graph G with reduced graph R if there is a homomorphism from H to a subgraph S of R which does not \"overfill\" any\nof the clusters in S. In our setting we apply this lemma with S = K3\nand conclude that for each triangle t of a connected triangle factor T\nin R we find a squared path in G that almost fills the clusters of G\ncorresponding to t. By using the fact that T is triangle connected it\nis then possible to connect these squared paths into squared paths or\ncycles of the desired overall length. In addition, the Blow-up Lemma\nallows for some control about the start- and end-vertices of the path\nthat is constructed in this way (cf. Lemma 8(iii )).\n\n\f10\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nThe following lemma summarises this embedding technique, which\nis also implicit, e.g., in [10]. For completeness we provide a proof of\nthis lemma in the appendix.\nLemma 8 (Embedding Lemma). For all d > 0 there exists \u03b5el > 0\nwith the following property. Given 0 < \u03b5 < \u03b5el , for every mel \u2208 N\nthere exists nel \u2208 N such that the following hold for any graph G on\nn \u2265 nel vertices with (\u03b5, d)-reduced graph R\u2032 on m \u2264 mel vertices.\nn\n2\n(i ) C3l\n\u2286 G for every l \u2208 N with 3l \u2264 (1 \u2212 d) CTF(R\u2032 ) m\n.\n\u2032\n(ii ) If K4 \u2286 C for each triangle component C of R , then Cl2 \u2286 G\nn\n.\nfor every l \u2208 N \\ {5} with 3 \u2264 l \u2264 (1 \u2212 d) CTF(R\u2032 ) m\nFurthermore, let T be a connected triangle factor in a triangle component C of R with K4 \u2286 C, let u1 v1 , u2 v2 \u2208 E(G) be disjoint edges, and\nsuppose that there are (not necessarily disjoint) edges X1 Y1 , X2 Y2 \u2208 C\nn\nsuch that the edge ui vi has at least 2d m\ncommon neighbours in each\ncluster Xi and Yi for i = 1, 2. Then\nn\n, such\n(iii ) Pl2 \u2286 G for every l \u2208 N with 6(m + 2)3 < l < (1 \u2212 d)|T | m\n2\nthat Pl starts in u1 , v1 and ends in u2 , v2 (in\nS those orders) and\nat most (\u03b5 + d)n vertices of Pl2 are not in T .\n\nThe copies of K4 that are required in this lemma play a crucial r\u00f4le\nwhen embedding squared cycles which are not 3-chromatic.\n\nThe Stability Method. The strategy we just described leaves us with\nthe task of finding a big connected triangle factor T in the reduced\ngraph R of G. However, there is one problem with this approach: The\nproportion \u03c4 of R covered by T is roughly equal to the proportion\nof G covered by the squared path P that we obtain from the Embedding Lemma (Lemma 8). However, as explained above, the relative\nminimum degree \u03b3R = \u03b4(R)/|V (R)| of R is in general slightly smaller\nthan \u03b3G = \u03b4(G)/|V (G)|, but the extremal graphs for squared paths\nand connected triangle factors are the same. It follows that we cannot\nexpect that \u03c4 is larger than the proportion a maximum squared path\ncovers in a graph with relative minimum degree \u03b3R , and hence smaller\nthan the proportion we would like to cover for relative minimum degree \u03b3G .\nConsequently we need to be more ambitious and shoot for a bigger\nconnected triangle factor in R than we can expect for this minimum\ndegree (cf. Lemma 9 (S1) and (S2)). This will of course not always be\npossible, but it will only fail if R (and hence G) is 'very close' to the\nextremal graph Gp (|V (R)|, \u03b4(R)) (and hence also to Gc (|V (R)|, \u03b4(R)))\nin which case we will say that R is near-extremal (cf. Lemma 9 (S3)).\nThis approach is called the Stability Method and the following lemma\nstates that it is feasible for our purposes. This lemma additionally\nguarantees copies of K4 as required by the Embedding Lemma. We\nformulate this lemma for graphs G, but use it on the reduced graph R\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n11\n\nlater. Its proof does not rely on the Regularity Lemma and is given in\nSection 3.\nLemma 9 (Stability Lemma). Given \u03bc > 0, for any sufficiently small\n\u03b7 > 0 there exists n0 such that if G has n > n0 vertices and \u03b4(G) =\n\u03b4 \u2208 (( 12 + \u03bc)n, 2n\u22121\n), then either\n3\n(S1) CTF(G) \u2265 3(2\u03b4 \u2212 n), or\n), or\n(S2) CTF(G) \u2265 min(sp(n, \u03b4 + \u03b7n), 11n\n20\n(S3) G has an independent set of size at least n\u2212\u03b4\u221211\u03b7n whose removal\n19\ndisconnects G into components, each of size at most 10\n(2\u03b4 \u2212 n).\nMoreover, in cases (S2) and (S3) each triangle component of G contains\na K4 .\nBy the discussion above, it remains to handle the graphs with nearextremal reduced graph. For these graphs we have a lot of structural\ninformation which enables us to show directly that they contain the\nsquared paths and squared cycles we desire, as the following lemma\ndocuments. The proof of this lemma is provided in Section 4. In this\nproof we shall again make use of the embedding lemma, Lemma 8.\nAccordingly Lemma 10 inherits the upper bound mel on the number\nof clusters from Lemma 8.\nLemma 10 (Extremal Lemma). For every \u03bd > 0, given 0 < \u03b7, d <\n10\u22128 \u03bd 4 there exists \u03b50 > 0 such that for every 0 < \u03b5 < \u03b50 and every\nmel , there exists N such that the following holds. Suppose that\n(i ) G is an n-vertex graph with n > N and \u03b4(G) = \u03b4 > n2 + \u03bdn,\n(ii ) R is an (\u03b5, d)-reduced graph of G of order m \u2264 mel ,\n(iii ) each triangle component of R contains a copy of K4 .\n \u0307 1 \u222aB\n \u0307 2 \u222a \u0307 * * * \u222aB\n \u0307 k with k \u2265 2,\n(iv ) V (R) = I \u222aB\n(v ) I is an independent set with |I| \u2265 (n \u2212 \u03b4 \u2212 11\u03b7n)m/n,\n(vi ) for each i \u2208 [k] we have 0 < |Bi | \u2264 19m(2\u03b4 \u2212 n)/(10n), and for\nevery j \u2208 [k] \\ {i} there are no edges between Bi and Bj in R.\n2\nThen G contains Psp(n,\u03b4)\nand Cl2 for each l \u2208 [3, sc(n, \u03b4)] \\ {5}.\nIt is interesting to notice that, although the two functions sp(n, \u03b4)\nand sc(n, \u03b4) are different-their jumps as \u03b4 increases occur at slightly\ndifferent values-they are similar enough that the Stability Lemma\ncovers them both. We will only need to distinguish between squared\npaths and squared cycles when we examine the near-extremal graphs.\nProof of Theorem 4. With this we have all the ingredients for the\nproof of our main theorem, which uses the Regularity Lemma (in form\nof Lemma 7) to construct a regular partition with reduced graph R of\nthe host graph G, the Stability Lemma (Lemma 9) to conclude that R\neither contains a big connected triangle factor or is near-extremal, the\nEmbedding Lemma (Lemma 8) to find long squared paths and cycles\n\n\f12\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nin G in the first case, and the Extremal Lemma (Lemma 10) in the\nsecond case.\nProof of Theorem 4. We require our constants to satisfy\n\u03bd \u226b \u03bc \u226b \u03b7 \u226b d \u226b \u03b5 > 0,\nwhich we choose, given \u03bd, as follows. First, we choose \u03bc := \u03bd/2. We\nthen choose \u03b7 > 0 to be small enough for both Lemma 9 and Lemma 10.\nNow we set d > 0 to be small enough for Lemma 10 and such that d \u2264\n\u03bd/10 and d \u2264 \u03b7/10. For this d Lemma 8 then produces a constant \u03b5el .\nWe choose \u03b5 > 0 to be smaller than min{\u03b5el , \u03bd/10} and sufficiently\nsmall for Lemma 10. We choose m0 to be sufficiently large to apply\nLemma 9 to any graph with at least m0 vertices. We then choose\nmel such that Lemma 7 guarantees the existence of an (\u03b5, d)-regular\npartition with at least m0 and at most mel parts. Finally we choose\nn0 > nel to be sufficiently large for both Lemma 8 and Lemma 10.\nLet n > n0 and \u03b4 \u2208 (n/2 + \u03bdn, n \u2212 1]. Let G be any n-vertex graph\n2\nwith \u03b4(G) \u2265 \u03b4. Observe that it suffices to show that Psp(n,\u03b4)\n\u2286 G\nand that (ii ) of Theorem 4 holds. We first apply Lemma 7 to G to\nobtain an (\u03b5, d)-reduced graph R on m0 \u2264 m \u2264 mel vertices. Let\n\u03b4 \u2032 = \u03b4(R) \u2265 (\u03b4/n \u2212 d \u2212 \u03b5)m > m/2 + \u03bcm. Then we apply Lemma 9\nto R. There are three possibilities.\nFirst, we could find that CTF(R) \u2265 3(2\u03b4 \u2032 \u2212 m). In this case by\nLemma 8 we are guaranteed that for every integer l\u2032 with 3l\u2032 < (1 \u2212\n2\nd) CTF(R)n/m we have C3l\nBy choice of d and \u03b5 we have\n\u2032 \u2286 G.\n\u2032\n(1 \u2212 d) * 3(2\u03b4 \u2212 m)n/m > 6\u03b4 \u2212 3n \u2212 \u03bdn. Noting that Pl2 \u2286 Cl2 we\n2\nconclude that Psp(n,\u03b4)\n\u2286 G and Cl2 \u2286 G for each integer l \u2264 6\u03b4\u22123n\u2212\u03bdn\nsuch that 3 divides l, i.e., the second case of Theorem 4(ii ) holds.\nSecond, we could find that CTF(R) \u2265 min(sp(m, \u03b4 \u2032 + \u03b7m), 11m\n) and\n20\nthat every triangle component of R contains a copy of K4 . By Lemma 8\nwe are guaranteed that for every l \u2208 [6, (1 \u2212 d) CTF(R)n/m] \\ {5} we\nhave Cl2 \u2286 G. By choice of \u03b7 and d we have (1 \u2212 d) CTF(R)n/m >\n2\nsp(n, \u03b4) \u2265 sc(n, \u03b4), so we have Psp(n,\u03b4)\n\u2286 G and for each integer l \u2208\n2\n[3, sc(n, \u03b4)] \\ {5} we have Cl \u2286 G, i.e., the first case of Theorem 4(ii )\nholds.\nThird, we could find that R is near-extremal. Then R contains an\nindependent set on at least m \u2212 \u03b4 \u2032 \u2212 11\u03b7m vertices whose removal\ndisconnects R into components of size at most 19\n(2\u03b4 \u2032 \u2212 m), and each\n10\ntriangle component of R contains a copy of K4 . But now G satisfies\n2\nthe conditions of Lemma 10. It follows that G contains Psp(n,\u03b4)\nand for\n2\neach l \u2208 [3, sc(n, \u03b4)] \\ {5} the graph G contains Cl , i.e., the first case\nof Theorem 4(ii ) holds.\n\u0003\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n13\n\n3. Triangle Components and the proof of Lemma 9\nIn this section we provide a proof of our stability result for connected triangle factors, Lemma 9. Distinguishing different cases, we\nanalyse the sizes and the structure of the triangle components in the\ngraph G under study. Before we give more details about our strategy\nand a sketch of the proof, we introduce some additional definitions and\nprovide a preparatory lemma (Lemma 11).\nLet G be a graph with triangle components C1 , . . . , Cr . The interior\nint(G) of G is the set of vertices of G which are in more than one of the\ntriangle components. For a component Ci , the interior of Ci , written\nint(Ci ), is the set of vertices of Ci which are in int(G). The remaining\nvertices of Ci are called the exterior \u2202(Ci ). That is, \u2202(Ci ) is formed\nby the set of vertices of Ci which are in no other triangle component\nof G. To give an example, by definition the graph Gp (n, \u03b4) has rp (n, \u03b4)\ntriangle components; its interior is the independent set Y (using the\nnotation of the construction of Gp (n, \u03b4) on page 6 in Section 1), with\nthe component exteriors being the cliques X1 , . . . , Xr .\nThe following lemma collects some observations about triangle components.\nLemma 11. Let G be an n-vertex graph with \u03b4(G) = \u03b4 > n/2. Then\n(a ) each triangle component C of G satisfies |C| > \u03b4,\n(b ) for distinct triangle components C, C \u2032 we have e(\u2202(C), \u2202(C \u2032 )) = 0,\n(c ) for each triangle component C, each vertex u of C, and U :=\n{v : uv \u2208 C}, the minimum degree in G[U] is at least 2\u03b4 \u2212 n and\nhence |G[U]| \u2265 2\u03b4 \u2212 n + 1.\nProof. To see (a ) let M be the vertices of a maximal clique in C (clearly\n|M| \u2265 3). If u and v are in M, and x is a common neighbour of u and v,\nthen x is also in C. Thus vertices of G \\ C are adjacent to at most 1\nvertex of M and vertices of C are adjacent to at most |M| \u2212 1 vertices\nof M, by maximality of M. This gives the inequality\n|M|\u03b4 \u2264\n\nX\n\nm\u2208M\n\nd(m) \u2264\n\nX\nx\u2208C\n\n(|M| \u2212 1) +\n\nX\n\n1\n\nx\u2208C\n/\n\nand hence |M|\u03b4 \u2212 n \u2264 (|M| \u2212 2)|C|. Since n < 2\u03b4 we have |C| > \u03b4 as\nrequired.\nSince \u03b4 > n/2, we have that \u0393(u, u\u2032) 6= \u2205 for any two vertices u\nand u\u2032 . Now, if u \u2208 \u2202(C), u\u2032 \u2208 \u2202(C \u2032 ), x \u2208 \u0393(u, u\u2032), and uu\u2032 was an\nedge, then uu\u2032x would form a triangle. Then u and u\u2032 would be together\nin some triangle component C \u2032\u2032 , contradicting the fact that they are in\nthe exterior. Therefore, the assertion (b ) follows.\nMoreover, for an edge uv of C we have \u0393(u, v) \u2286 C as C is a triangle\ncomponent. Since |\u0393(u, v)| \u2265 2\u03b4 \u2212 n we get (c ).\n\u0003\n\n\f14\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nNow let us sketch the proof of Lemma 9. Lemma 11(a ) states that\ntriangle components cannot be too small. However, it is not solely\nthe size of the triangle components we are interested in: we want to\nfind a triangle component that contains many vertex disjoint triangles.\nAt this point, Lemma 11(c ) comes into play. It asserts that certain\nspots in a triangle component induce a graph with minimum degree\n2\u03b4 \u2212 n. In the proof of Lemma 9 we shall usually (i.e., for many values\nof \u03b4) use this fact in order to find a big matching M in such spots\n(Proposition 12(a ) below asserts that this is possible). Clearly all edges\nin such a matching are triangle connected and hence it will remain to\nextend M to a set of vertex disjoint triangles. For this purpose we will\nanalyse the size of the common neighbourhood \u0393(u, v) of an edge uv\nin M. We will usually find that \u0393(u, v) is so big that a simple greedy\nstrategy allows us to construct the triangles. For estimating \u0393(u, v)\nwe will often use the following technique: We find a large set X such\nthat neither u nor v has neighbours in X. This implies |\u0393(u, v)| \u2265\n2\u03b4 \u2212 (n \u2212 |X|). Observe that Lemma 11(b ) implies that \u2202(C) can serve\nas X if both u, v \u2208 \u2202(C \u2032 ) for some triangle components C and C \u2032 .\nThe strategy we just described works for most values of \u03b4 below 53 n\n(we describe the exceptions below). For \u03b4 \u2265 53 n however, the greedy\ntype argument fails, the reason being that we usually bound the common neighbourhood of an edge used in the argument above by 4\u03b4 \u2212 2n.\nBut for \u03b4 \u2265 35 n we might have sp(n, \u03b4) > 4\u03b4 \u2212 2n (see Figure 1). We\nsolve this problem by using a different strategy in this range of \u03b4. We\nwill still start with a big connected matching M as before, but use a\nHall-type argument to extend M to a triangle factor T . More precisely,\nwe find M in the exterior of some triangle component and then consider for each edge uv of M all common neighbours of uv in int(G).\nThe Hall-type argument then permits us to find distinct extensions for\nthe edges of M. To make this argument work we use the fact that in\nthis range of \u03b4 the set int(G) is an independent set.\nWe indicated earlier that there are some exceptional values of \u03b4 that\nrequire special treatment: namely \u03b4 close to 53 n and 47 n. Observe that\nin both ranges the number of triangle components of Gp (n, \u03b4) changes\n(from 2 to 3 for 35 n, and from 3 to 4 for 74 n) and thus the value sp(n, \u03b4) as\na function in \u03b4 jumps (see Figure 1). Roughly speaking, the reason that\nthese two ranges need to be treated separately is that again sp(n, \u03b4) is\nnot substantially smaller than 4\u03b4 \u2212 2n here, but we also do not know\nnow that int(G) is an independent set. For dealing with these values\nof \u03b4 we will use a somewhat technical case analysis which we provide\nat the end of this section (as proof of Fact 17).\nAs explained above, we will apply the following simple observations\nabout matchings in graphs of given minimum degree.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n15\n\nProposition 12.\n(a ) Let G = (X, E) be a graph with minimum degree \u03b4. Then G has\na matching covering 2 min(\u03b4, \u230a|X|/2\u230b) vertices.\n \u0307 E) be a bipartite graph with parts A and B, such\n(b ) Let G = (A\u222aB,\nthat every vertex in A has degree at least a and every vertex in B\nhas degree at least b. Then G has a matching covering 2 min(a +\nb, |A|, |B|) vertices.\nProof. We first prove (a ). Let M be a maximum matching in G, and\nassume that M contains less than min(\u03b4, \u230a|X|/2\u230b) edges. In particular, there are two vertices x, y \u2208 X not covered by M. Clearly, all\nneighbours of x and y are covered by M.\nWe claim that there is an edge uv in M with xu, yv \u2208 E. Indeed,\nsuppose that this is not the case. Then |e \u2229 \u0393(x)| + |e \u2229 \u0393(y)| \u2264 2 for\neach e \u2208 M. We therefore have\nX\n\u03b4 + \u03b4 \u2264 |\u0393(x)| + |\u0393(y)| =\n(|e \u2229 \u0393(x)| + |e \u2229 \u0393(y)|) \u2264 2|M| ,\ne\u2208M\n\ncontradicting the fact that \u03b4 > |M|.\nNow, let uv \u2208 M be an edge as in the claim above. Since xu, yu \u2208 E\nwe get that x, u, v, y is an M-augmenting path, a contradiction.\nNext we prove (b ). Let M be a maximum matching in G. We are\ndone unless there are vertices u \u2208 A and v \u2208 B not contained in M.\nThere cannot be an edge xy \u2208 M such that uy and xv are edges of G\nby maximality of M, since then u, y, x, v was an M-augmenting path.\nBut u has at least a neighbours in V (M)\u2229B, and v at least b neighours\nin V (M) \u2229 A, so there must be at least a + b edges in M.\n\u0003\nBefore turning to the proof of Lemma 9 let us quickly collect some\nanalytical data about sp(n, \u03b4) and rp (n, \u03b4) =: r. It is not difficult to\ncheck that\n(r + 1)n \u2212 r\nrn \u2212 r + 1\n\u2264\u03b4<\nand\n2(r + 1) \u2212 1\n2r \u2212 1\n(3)\nn\u2212\u03b4\n\u03b4+1\n\u2264r<\n.\n2\u03b4 \u2212 n + 1\n2\u03b4 \u2212 n + 1\nFor the proof of Lemma 9 it will be useful to note in addition that\ngiven \u03bc > 0, for every 0 < \u03b7 < \u03b70 = \u03b70 (\u03bc), there is n1 = n1 (\u03b7) such\nthat the following holds for all n \u2265 n1 . For all \u03b4, \u03b4 \u2032 > n2 + \u03bcn, where \u03b4\n11\nn, and where \u03b4 \u2032 is such that we have\nis such that sp(n, \u03b4 + \u03b7n) \u2264 20\n\u2032\n\u2032\nrp (n, \u03b4 ) \u2265 3 and either rp (n, \u03b4 ) \u2265 5 or rp (n, \u03b4 \u2032 ) = rp (n, \u03b4 \u2032 + \u03b7n), we\nhave\n\u0010\n\u0011\n3\n\u03b4 + 3\u03b7n\n\u03b4\n(4) sp(n, \u03b4 + \u03b7n) \u2264 min\n\u2212 2,\n\u22122 ,\n2\nrp (n, \u03b4 + \u03b7n) \u2212 1\nrp (n, \u03b4 + \u03b7n)\n(5)\n\nsp(n, \u03b4 + \u03b7n) \u2264\n\n19\n20\n\n* 3(2\u03b4 \u2212 n) \u2212 2 \u2264 6\u03b4 \u2212 3n \u2212 100\u03b7n,\n\nsp(n, \u03b4 \u2032 + \u03b7n) \u2264 4\u03b4 \u2032 \u2212 2n,\n\nand\n\n\f16\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nwhich follows immediately from the definition of sp(n, \u03b4) in (1) (see\nalso Figure 1).\n1\nProof of Lemma 9. Given \u03bc and any 0 < \u03b7 < min( 1000\n, \u03b70 (\u03bc), 2\u03bc2/3),\nwhere \u03b70 (\u03bc) is as above (4), let n0 := max(n1 (\u03b7), 2/\u03b7) with n1 (\u03b7) as\nabove (4). Let n \u2265 n0 . This in particular means that we may assume\nthe inequalities (4) and (5) in what follows. Define \u03b3 := \u03b4/n, and\nr := rp (n, \u03b4) and r \u2032 := rp (n, \u03b4 + \u03b7n).\nIf G has only one triangle component then Theorem 3 guarantees\nthat CTF(G) \u2265 6\u03b4 \u2212 3n and so we are in Case (S1). Thus we may\nassume in the following that G has at least two triangle components.\nThen Lemma 11(a ) implies that int(C) 6= \u2205 for any triangle component C.\nSuppose that C is a triangle component of G which does not contain\na copy of K4 . Let u be a vertex of C, and U := {v : uv \u2208 C}. By\nLemma 11(c ) we have \u03b4(G[U]) \u2265 2\u03b4 \u2212 n. Because C contains no\ncopy of K4 , U contains no triangle. By Tur\u00e1n's theorem we have |U| \u2265\n2(2\u03b4\u2212n), and so by Proposition 12(a ) the set U contains a matching M\nwith 2\u03b4 \u2212 n edges. Finally we choose greedily for each e \u2208 M a distinct\nvertex v \u2208 V (G) such that ev is a triangle. Since U is triangle free all\nthese vertices must lie outside U, and since |\u0393(e)| \u2265 2\u03b4 \u2212 n we cannot\nfail to find distinct vertices for each edge. This yields a set T of 2\u03b4 \u2212 n\nvertex-disjoint triangles which are all in C. So CTF(G) \u2265 6\u03b4 \u2212 3n\nand we are in case (S1). Henceforth we assume that every triangle\ncomponent of G contains a copy of K4 .\nWe continue by considering the case 3n\u22122\n\u2264 \u03b4 < 2n\u22121\n. The following\n5\n3\nobservation readily implies the lemma in this range, as we will see in\nFact 14.\n\nFact 13. If \u03b4(G) \u2265 ( 53 \u2212 2\u03b7)n, G has exactly 2 triangle components,\nint(G) is independent, and either | int(G)| < n\u2212\u03b4\u221211\u03b7n or the exterior\n19\nX of the triangle component with most vertices satisfies |X| \u2265 10\n(2\u03b4 \u2212\n11\nn), then CTF(G) \u2265 min(sp(n, \u03b4 + \u03b7n), 20 n).\nProof of Fact 13. First, by Lemma 11(b ) a vertex x \u2208 X cannot have\nneighbours in the exterior of the other triangle component, so \u0393(x) \u2286\nX \u222a int(G). Thus \u03b4(G[X]) \u2265 \u03b4 \u2212 | int(G)|, which by Proposition 12(a )\nmeans that there is a matching M in G[X] with\n(6)\n\n|M| = min(\u03b4 \u2212 | int(G)|, \u230a|X|/2\u230b)\n\nedges.\nWe aim to pair off edges of M with vertices of int(G) to form a\nsufficiently large number of vertex-disjoint triangles. To see that a\ntriangle factor resulting from this process will be connected, observe\nthat all edges of M are in X, and since X is a triangle component\nexterior, the edges of M are triangle connected. To form triangles from\nedges of M and vertices of int(G), we introduce an auxiliary bipartite\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n17\n\ngraph H with vertex set M \u222a \u0307 int(G), where uv \u2208 M is adjacent in H\nto w \u2208 int(G) iff uvw is a triangle of G. Every vertex of X has at\nleast \u03b4 \u2212 |X| neighbours in int(G), and so every edge of M has at least\na := 2(\u03b4 \u2212 |X|) \u2212 | int(G)| common neighbours in int(G). At the same\ntime, since int(G) is independent, every vertex of int(G) has at least\n\u03b4 \u2212 (n \u2212 | int(G)| \u2212 |X|) neighbours in X, of which all but |X| \u2212 2|M|\nmust be in M. So every vertex of int(G) must have at least\nb := \u03b4\u2212(n\u2212| int(G)|\u2212|X|)\u2212(|X|\u22122|M|)\u2212|M| = \u03b4\u2212n+| int(G)|+|M|\nedges of M in its neighbourhood. By Proposition 12(b ) there is a\nmatching in H on at least min(a + b, |M|, | int(G)|) edges, and hence a\nconnected triangle factor in G with so many triangles. Observe that\na + b = 2\u03b4 \u2212 2|X| \u2212 | int(G)| + \u03b4 \u2212 n + | int(G)| + |M|\n(7)\n= 3\u03b4 \u2212 n \u2212 2|X| + |M| .\n\nSince there are two triangle components in G, there is a vertex u\nin a triangle component exterior which is not X. Therefore u has no\nneighbour in X, so |X| < n \u2212 \u03b4. Since \u03b4 \u2265 ( 53 \u2212 2\u03b7)n, by (7) we have\na + b > |M| \u2212 10\u03b7n .\n\n(8)\n\nFurthermore,\n\nif |X| \u2264 ( 52 \u2212 3\u03b7)n ,\n\n(9)\n\nthen a + b \u2265 |M| .\n\n1\nBy Lemma 11(a ) we have | int(G)| \u2265 2\u03b4 \u2212 n \u2265 n5 \u2212 4\u03b7n. Since \u03b7 \u2264 1000\nwe have\n3n\n11n\n3| int(G)| \u2265\n\u2212 12\u03b7n >\n.\n5\n20\nif we find a matching in H covering\nThus we have CTF(G) \u2265 11n\n20\nint(G). It remains, then, to check that we have\n11\n(10)\n3 min(a + b, |M|) \u2265 min(sp(n, \u03b4 + \u03b7n), n).\n20\nWe distinguish two cases.\nCase 1: a+b < |M|. By (9) this forces |X| > ( 52 \u22123\u03b7)n. Since we have\n|M| = min(\u03b4 \u2212 | int(G)|, \u230a|X|/2\u230b) by (6), there are two possibilities. If\n|M| = \u230a|X|/2\u230b then we have\n(8) j |X| k\nn\n11n\na+b \u2265\n\u2212 10\u03b7n > \u2212 12\u03b7n >\n,\n2\n5\n60\nwhich proves (10) in this subcase. If, on the other hand, |M| =\n\u03b4 \u2212 | int(G)|, then we use that int(G) is independent, which implies\nint(G) \u2264 n \u2212 \u03b4 and thus\n(8)\n\na + b \u2265 |M| \u2212 10\u03b7n = \u03b4 \u2212 | int(G)| \u2212 10\u03b7n \u2265 2\u03b4 \u2212 n \u2212 10\u03b7n\n(5)\n\n\u2265\n\n1\n3\n\nsp(n, \u03b4 + \u03b7n) ,\n\nwhich proves (10) in this subcase.\n\n\f18\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nCase 2: a + b \u2265 |M|. In this case, H contains a matching of size |M|,\nso we have CTF(G) \u2265 3|M| = 3 min(\u03b4 \u2212 | int(G)|, \u230a|X|/2\u230b). Again\nthere are two possibilities, depending on |M|. If |M| = \u03b4 \u2212 | int(G)|, we\nare done by (5) exactly as before. If, on the other hand, |M| = \u230a|X|/2\u230b,\nthen (10) holds (and hence we are done) unless\n\u0001\n11\n(11)\n3\u230a |X|\n\u230b < min sp(n, \u03b4 + \u03b7n), 20\nn .\n2\nWe now assume (11) in order to derive a contradiction, and make a\nfinal subcase distinction.\n11\nn. Then r \u2032 \u2265 2 and hence (11)\nFirst assume that sp(n, \u03b4 + \u03b7n) < 20\nand (1) imply\n|X| < 21 (\u03b4 + \u03b7n) + 3 <\n\n51\n\u03b4\n100\n\n<\n\n19\n(2\u03b4\n10\n\n\u2212 n) ,\n\n1\n. Furthermore, since G has two\nbecause \u03b4 \u2265 ( 35 \u2212 2\u03b7)n and \u03b7 \u2264 1000\ntriangle components whose exterior is of size at most X by assumption\nwe have | int(G)| > n \u2212 2|X| = n \u2212 \u03b4 \u2212 \u03b7n \u2212 6, a contradiction to the\nthe conditions of Fact 13.\nNow assume that sp(n, \u03b4 + \u03b7n) \u2265 11\nn. Then we have \u03b4 > ( 32 \u2212 2\u03b7)n.\n20\n19\nBy Lemma 11(a ) we have |X| \u2264 n\u2212\u03b4 < ( 31 +2\u03b7)n and so |X| < 10\n(2\u03b4\u2212\nn). Further | int(G)| \u2265 n \u2212 2|X| \u2265 2\u03b4 \u2212 n > n3 \u2212 4\u03b7n > n \u2212 \u03b4 \u2212 11\u03b7n,\nwhich again contradicts the conditions of Fact 13.\n\u0003\n\nFact 14. Lemma 9 is true for\n\n3n\u22122\n5\n\n\u2264\u03b4<\n\n2n\u22121\n.\n3\n\nProof of Fact 14. Observe that in this range r = 2. Assume G has an\nedge uv in int(G), let x be a common neighbour of u and v and C\nbe the triangle component containing ux and vx. Since uv \u2208 int(G)\nthere are edges uy and vz of G outside C. The sets \u0393(u, y), \u0393(v, z) and\n{u, v, x, y, z} are pairwise disjoint, and x is not adjacent to \u0393(u, y) \u222a\n\u0393(v, z) \u222a {y, z}. So \u03b4 \u2264 d(x) \u2264 (n \u2212 1) \u2212 2(2\u03b4 \u2212 n) \u2212 2 which is\nonly possible when \u03b4 \u2264 (3n \u2212 3)/5, a contradiction. Thus int(G)\nis an independent set, which implies | int(G)| \u2264 n \u2212 \u03b4. Hence, by\nLemma 11(a ), G cannot have more than two triangle components. In\nparticular, all vertices in int(G) lie in both triangle components of G.\nSo if | int(G)| \u2265 n \u2212 \u03b4 \u2212 11\u03b7n then int(G) is the desired large independent set for Case (S3). If moreover all triangle component exteriors\n19\nare of size 10\n(2\u03b4 \u2212 n) at most we are in Case (S3). Otherwise (if\nint(G) is small or a triangle component exterior is large) Fact 13 gives\n11\nn) which is Case (S2).\n\u0003\nCTF(G) \u2265 min(sp(n, \u03b4 + \u03b7n), 20\nFor the remainder of the proof, we suppose \u03b4 < 3n\u22122\nand accordingly\n5\nr \u2265 3 and r \u2032 \u2265 2. For dealing with this case we first establish two\nauxiliary facts. The first one captures the greedy technique for finding\na large connected triangle factor that we sketched in the beginning of\nthis section. We will use this technique throughout the rest of the\nproof.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n19\n\nFact 15. If there are two sets U1 , U2 \u2286 V (G) such that no vertex in\nU1 has a neighbour in U2 , all edges in G[U1 ] are triangle connected and\n\u03b4(G[U1 ]) \u2265 \u03b41 then CTF(G) \u2265 min(3\u230a|U1 |/2\u230b, 3\u03b41, 2\u03b4 \u2212 n + |U2 |).\nProof of Fact 15. By Proposition 12(a ) we can find a matching M \u2032\nin U1 covering\nmin(2\u230a|U1 |/2\u230b, 2\u03b41)\n\nvertices. Let M be a subset of M \u2032 covering min(2\u230a|U1 |/2\u230b, 2\u03b41 , (4\u03b4 \u2212\n2n + 2|U2 |)/3) vertices. For each edge e \u2208 M in turn we pick greedily\na common neighbour of e outside both M and the previously chosen\ncommon neighbours to obtain a set T of disjoint triangles. For any\nx, y \u2208 U1 we have |\u0393(x, y)| \u2265 2\u03b4 \u2212 (n \u2212 |U2 |). We claim that this\nimplies that T can be constructed, covering all of M. Indeed, in each\nstep of the greedy procedure we have strictly more than 2\u03b4\u2212(n\u2212|U2 |)\u2212\n3|M| \u2265 0 common neighbours of e \u2208 M available. Hence T covers at\nleast min(3\u230a|U1 |/2\u230b, 3\u03b41, 2\u03b4 \u2212 n + |U2 |) vertices. Note further that T\nis a connected triangle factor because all edges in G[U1 ] are triangle\nconnected.\n\u0003\nBelow, our goal will be to show that int(G) is an independent set.\nThe following fact prepares us for this step.\nFact 16. Let uv be an edge in int(G). Unless r \u2032 = 2 at least one vertex,\nu or v, is contained in at most r \u2032 \u2212 1 triangle components.\nProof of Fact 16. Let C1 be the triangle component containing uv \u2208\nint(G) along with the (non-empty) common neighbourhood \u0393(u, v)\n(and perhaps some other neighbours of u or v separately). Suppose\nthat C 6= C1 , and u is a vertex of C. Then by Lemma 11(c ), there are\nat least 2\u03b4 \u2212n+ 1 neighbours x of u such that the edge ux is in C. Now\nsuppose that u lies in at least r \u2032 \u22121 triangle components other than C1 .\nIt follows that there is a set Uu \u2286 \u0393(u) of vertices x such that ux is not\nin C1 , with |Uu | \u2265 (r \u2032 \u2212 1)(2\u03b4 \u2212 n + 1), since no edge lies in two distinct\ntriangle components. Suppose furthermore that v too lies in at least\nr \u2032 \u2212 1 triangle components other than C1 . Then there exists an analogously defined set Uv . Since all vertices of \u0393(u, v) form triangles of C1\nwith u and v, the three sets \u0393(u, v), Uu and Uv are pairwise disjoint,\nand thus |Uu \u222a Uv | \u2265 (2r \u2032 \u2212 2)(2\u03b4 \u2212 n + 1). Now given any x \u2208 \u0393(u, v),\nsince ux and vx are both in C1 , x cannot be adjacent to any vertex\nof Uu \u222a Uv . But then \u03b4 \u2264 d(x) < n \u2212 (2r \u2032 \u2212 2)(2\u03b4 \u2212 n + 1) which is\nequivalent to 2r \u2032 \u2212 2 < (n \u2212 \u03b4)/(2\u03b4 \u2212 n + 1). By (3) the right-hand side\nis at most r and thus we get 2r \u2032 \u2212 2 < r. Since r \u2264 r \u2032 + 1 however this\nis a contradiction unless r \u2032 \u2264 2.\n\u0003\nWe assume from now on, that\n(12)\n\nCTF(G) < sp(n, \u03b4 + \u03b7n) ,\n\n\f20\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nthat is, we are not in Cases (S1) or (S2). Our aim is to conclude\nthat then (\u2217) int(G) is an independent set and that its vertices are\ncontained in at least r \u2032 triangle components. It turns out, however,\nthat we need to consider the cases r = r \u2032 + 1 = 3 and r = r \u2032 + 1 = 4\n(i.e., the cases when the minimum degree \u03b4 is just a little bit below 53 n\nand 47 n, respectively) separately. Unfortunately these two cases, which\nare treated by Fact 17, require a somewhat technical case analysis,\nwhich we prefer to defer to the end of the section.\nFact 17. If r = r \u2032 + 1 = 3 or r = r \u2032 + 1 = 4 then int(G) is an\nindependent set all of whose vertices are contained in at least r \u2032 triangle\ncomponents.\nAssuming this fact is true we can deduce (\u2217) for all values r \u2265 3 as\nfollows.\nFact 18. The set int(G) is an independent set (and hence of size at\nmost n \u2212 \u03b4) all of whose vertices are contained in at least r \u2032 triangle\ncomponents.\nProof of Fact 18. Recall that we have r \u2265 3 at this point of the proof.\nMoreover, the cases r = r \u2032 + 1 = 3 and r = r \u2032 + 1 = 4 are handled by\nFact 17. So we assume we are not in these cases; in particular, r \u2032 \u2265 3.\nWe will show that then each vertex of int(G) is contained in at least r \u2032\ntriangle components. Once we establish this, Fact 16 implies that there\nare no edges in int(G) and so int(G) is an independent set as desired.\nTo prove that each vertex of int(G) is contained in at least r \u2032 triangle\ncomponents we assume the contrary and show that then CTF(G) \u2265\nsp(n, \u03b4 + \u03b7n), a contradiction to (12). Indeed, let w \u2208 int(G) and suppose that there are k > 1 triangle components C1 , . . . , Ck containing w.\nFor i \u2208 [k] let Ui be the set of neighbours u of w such that uw \u2208 Ci .\nBy Lemma 11(c ) we have \u03b4(G[Ui ]) \u2265 2\u03b4 \u2212 n and |Ui | \u2265 2\u03b4 \u2212 n + 1.\nSuppose that U1 is the largest of the Ui . No vertex in U1 has a\nneighbour in U2 , since the components are distinct. In addition, all\nedges in G[U1 ] are triangle connected, because U1 \u2286 \u0393(w). Therefore\nFact 15 implies that there is a connected triangle factor T in G covering\nmin(3\u230a|U1 |/2\u230b, 3(2\u03b4 \u2212 n), 2\u03b4 \u2212 n + |U2 |) \u2265 min(3\u230a|U1 |/2\u230b, 4\u03b4 \u2212 2n) vertices. If w lies only in r \u2032 \u2212 1 triangle components then |U1 | \u2265 \u03b4/(r \u2032 \u2212 1)\nand therefore T covers at least min(3\u230a\u03b4/(2r \u2032 \u2212 2)\u230b, 4\u03b4 \u2212 2n) vertices.\nNow since (4) holds, we have 32 \u03b4/(r \u2032 \u2212 1) \u2212 2 \u2265 sp(n, \u03b4 + \u03b7n). Since\nr \u2265 r \u2032 \u2265 3 and we have excluded the case r = r \u2032 +1 = 4, by (5) we have\n4\u03b4 \u2212 2n \u2265 sp(n, \u03b4 + \u03b7n). It follows that T covers at least sp(n, \u03b4 + \u03b7n)\nvertices, in contradiction to (12).\n\u0003\nFact 19. We are in Case (S3).\nProof of Fact 19. Fact 18 tells us that int(G) is an independent set. By\nLemma 11(a ) and the fact that \u03b4 > n \u2212 \u03b4 we have that every triangle\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n21\n\ncomponent in G has an exterior, and by Lemma 11(b ) that there are\nno edges between any triangle component exteriors. Hence, to show\nthat we are in Case (S3), it is enough to prove that\n19\n(13) | int(G)| := \u03b1 \u2265 n \u2212 \u03b4 \u2212 11\u03b7n\nand\n|X1 | \u2264 (2\u03b4 \u2212 n)\n10\nfor the biggest triangle component exterior X1 in G. Suppose for a\ncontradiction that this is not the case. We first claim that this forces\nG to have exactly r \u2032 triangle components.\nIndeed, assume G has k \u2265 r \u2032 + 1 triangle components. Each of these\ncomponents C has vertices in its exterior \u2202(C), and so by Lemma 11(b )\nthe minimum degree of G implies |\u2202(C)| \u2265 \u03b4\u2212\u03b1+1 \u2265 2\u03b4\u2212n+1. We let\nthese triangle component exteriors be X1 , . . . , Xk , with X1 being the\n \u0307 k \u222a \u0307 int(G)|, we have (r \u2032 + 1)(\u03b4 \u2212 \u03b1) + \u03b1 <\nbiggest. Since n = |X1 \u222a \u0307 . . . \u222aX\nn. We distinguish two cases.\nCase 1: (13) fails because \u03b1 < n \u2212 \u03b4 \u2212 11\u03b7n. Then we obtain\n(r \u2032 + 1)\u03b4 < n + r \u2032 \u03b1 < n + r \u2032 (n \u2212 \u03b4 \u2212 11\u03b7n)\n\n= (r \u2032 + 1)n \u2212 (9r \u2032 \u2212 1)\u03b7n \u2212 r \u2032 \u03b4 \u2212 (2r \u2032 + 1)\u03b7n .\n\nStraightforward manipulation gives\n(r \u2032 + 1)n \u2212 (9r \u2032 \u2212 1)\u03b7n\n\u03b4 + \u03b7n <\n.\n2(r \u2032 + 1) \u2212 1\nSince (9r \u2032 \u2212 1)\u03b7n \u2265 9r \u2032 \u2212 1 \u2265 r \u2032 this contradicts (3) applied to r \u2032 =\nrp (n, \u03b4 + \u03b7n).\n19\n(2\u03b4 \u2212 n). Let x be any verCase 2: (13) fails because |X1 | > 10\ntex in X2 . Since x has at least \u03b4 neighbours, none of which are in\n \u0307 3 \u222a \u0307 . . . \u222aX\n \u0307 k , we have\nX1 \u222aX\n19\n1 + \u03b4 + (2\u03b4 \u2212 n) + (k \u2212 2)(2\u03b4 \u2212 n + 1) \u2264 n , hence\n10\n19\n(2\u03b4 \u2212 n) + (r \u2032 \u2212 1)(2\u03b4 \u2212 n) < n \u2212 \u03b4 .\n10\nBy (3) we have r \u2032 \u2265 (n \u2212 \u03b4 \u2212 \u03b7n)/(2\u03b4 + 2\u03b7n \u2212 n + 1). Combined with\nthe last inequality, this gives\n9\nn \u2212 \u03b4 \u2212 \u03b7n\n(2\u03b4 \u2212 n) +\n(2\u03b4 \u2212 n) < n \u2212 \u03b4\n10\n2\u03b4 \u2212 n + 1 + 2\u03b7n\nNow provided that \u03b7 < 2\u03bc2 /3, and since 2\u03b4 \u2212 n \u2265 2\u03bcn, we have\n(2\u03b4 \u2212 n + 2\u03b7n + 1)(1 \u2212 \u03bc) < 2\u03b4 \u2212 n + 3\u03b7n \u2212 \u03bc(2\u03b4 \u2212 n)\n\u2264 2\u03b4 \u2212 n + 3\u03b7n \u2212 2\u03bc2 n < 2\u03b4 \u2212 n ,\n\nand we obtain 95 \u03bcn+(1\u2212\u03bc)(n\u2212\u03b4 \u2212\u03b7n) < n\u2212\u03b4 which is a contradiction\nsince n \u2212 \u03b4 < n/2 and \u03b7 < \u03bc.\nHence, if (13) fails, then G has indeed exactly r \u2032 triangle components.\nNow we use this fact in order to derive a contradiction to (12). Observe that, if r \u2032 = 2, and accordingly \u03b4 \u2265 ( 53 \u2212 2\u03b7)n, then Fact 13\n\n\f22\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nimplies that (13) holds, because according to (12) we have CTF(G) <\nsp(n, \u03b4 + \u03b7n). In the remainder we assume r \u2032 \u2265 3.\nSince every vertex in X1 has neighbours only in X1 and int(G), and\n| int(G)| \u2264 n \u2212 \u03b4, we have \u03b4(G[X1 ]) \u2265 2\u03b4 \u2212 n. Furthermore, since\n \u0307 3| \u2265\nno vertex in X1 has neighbours in either X2 or X3 , and |X2 \u222aX\n2(2\u03b4 \u2212 n + 1), we can apply Fact 15 to obtain\n\u0001\nCTF(G) \u2265 min 3\u230a|X1 |/2\u230b, 3(2\u03b4 \u2212 n), 2\u03b4 \u2212 n + 2(2\u03b4 \u2212 n + 1)\n\u0001\n= min 3\u230a|X1 |/2\u230b, 3(2\u03b4 \u2212 n) .\n\nNow by (5), CTF(G) \u2265 3(2\u03b4 \u2212 n) is a contradiction to (12), so to\ncomplete our proof it remains to show that if (13) fails, then CTF(G) \u2265\n3\u230a|X1 |/2\u230b is also a contradiction to (12). Again, we distinguish two\ncases.\nCase 1: (13) fails because \u03b1 < n \u2212 \u03b4 \u2212 11\u03b7n. Since X1 is the largest\nexterior, we have |X1 | \u2265 (\u03b4 + 11\u03b7n)/r \u2032. But we have by (4) that\nj \u03b4 + 11\u03b7n k\n3 \u03b4 + 3\u03b7n\nsp(n, \u03b4 + \u03b7n) \u2264\n\u2212\n2\n<\n3\n,\n2 r\u2032\n2r \u2032\nso that CTF(G) \u2265 3\u230a|X1 |/2\u230b is indeed a contradiction to (12).\n19\n(2\u03b4 \u2212 n). Then CTF(G) \u2265\nCase 2: (13) fails because |X1 | > 10\n57\n3\u230a|X1 |/2\u230b \u2265 20\n(2\u03b4 \u2212 n) \u2212 2, which by (5) is a contradiction to (12), as\ndesired.\n\u0003\n\nThis completes, modulo the proof of Fact 17, the proof of Lemma 9.\n\u0003\nIt remains to show Fact 17. Note that we can use all facts from the\nproof of Lemma 9 that precede Fact 17. We will further assume that\nall constants and variables are set up as in this proof.\nProof of Fact 17. Recall that we assumed (12), i.e., CTF(G) < sp(n, \u03b4+\n\u03b7n), in this part of the proof of Lemma 9. We distinguish two cases.\nCase 1: r = 3 and r \u2032 = 2. In this case \u03b4(G) \u2208 [( 35 \u2212 2\u03b7)n, ( 35 + \u03b7)n].\nTrivially each vertex of int(G) is contained in at least r \u2032 = 2 triangle\ncomponents. Suppose for a contradiction that there is an edge uv in\nint(G). Let x be a common neighbour of u and v, and C be the triangle\ncomponent containing the triangle uvx. Let U1 := {y : uy \u2208 C} and\nV1 := {y : vy \u2208 C} and let U2 := \u0393(u)\\U1 and V2 := \u0393(v)\\V1 . Observe\nthat U2 \u2229 V2 = \u2205.\n \u0307 2 . It follows\nBy definition x is not in, and has no neighbour in, U2 \u222aV\n2\n \u0307 2 | < n\u2212\u03b4 \u2264 ( 5 +2\u03b7)n. On the other hand, by Lemma 11(c ),\nthat |U2 \u222aV\nwe have |U2 |, |V2 | > 2\u03b4 \u2212 n \u2265 15 n \u2212 4\u03b7n, and thus\n\u0003\n\u0002\n|U2 |, |V2| \u2208 ( 51 \u2212 4\u03b7)n, ( 15 + 6\u03b7)n .\n\nSince d(u) \u2265 \u03b4 \u2265 ( 53 \u2212 2\u03b7)n, we have |U1 | \u2265 \u03b4 \u2212 |U2 | \u2265 ( 52 \u2212 8\u03b7)n. But\nno vertex in U2 is adjacent to any vertex in U1 . This implies that every\nvertex in U2 is adjacent to all but at most n \u2212 \u03b4 \u2212 |U1 | \u2264 10\u03b7n vertices\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n23\n\n1\noutside U1 . Since \u03b7 < 1000\nwe have |U2 | > 20\u03b7n, so \u03b4(G[U2 ]) > |U2 |/2,\nand by Proposition 12(a ), U2 contains a matching Mu with \u230a|U2 |/2\u230b\nedges. Since each vertex of U2 has at most 10\u03b7n non-neighbours outside U1 , each pair of vertices has common neighbourhood covering all\nbut at most 20\u03b7n vertices of V (G) \\ U1 . In particular, the common\nneighbourhood of each edge of Mu covers all but at most 20\u03b7n vertices of V (G) \\ U1 . Similarly, V2 contains a matching Mv with \u230a|V2 |/2\u230b\nedges, and the common neighbourhood of each edge covers all but at\nmost 20\u03b7n vertices of V (G) \\ V1 .\nSince 20\u03b7n < |U2 |/4 and U2 \u2229 V1 = \u2205, the common neighbourhood\nof each edge of Mv contains more than half of the edges of Mu . By\n \u0307 v are in\nsymmetry, the reverse is also true. Thus all edges in Mu \u222aM\n \u0307 v has\nthe same triangle component of G. Finally, each edge of Mu \u222aM\n1\n \u0307\nat least \u03b4 \u2212 10\u03b7n \u2212 |U2 \u222aV2 | \u2265 ( 5 \u2212 24\u03b7)n common neighbours out \u0307 2 . Choosing greedily for each edge of Mu \u222aM\n \u0307 v in succession\nside U2 \u222aV\n \u0307\ndistinct common neighbours outside U2 \u222aV2 , we obtain a connected triangle factor with min(\u230a|U2 |/2\u230b + \u230a|V2 |/2\u230b, ( 51 \u2212 24\u03b7)n) = ( 15 \u2212 24\u03b7)n\ntriangles. But then CTF(G) \u2265 ( 53 \u2212 72\u03b7)n > n/2 > sp(n, \u03b4 + \u03b7n),\na contradiction to (12). This proves Fact 17 for the case r = 3 and\nr \u2032 = 2.\nCase 2: r = 4 and r \u2032 = 3. This implies that ( 74 \u2212 2\u03b7)n \u2264 \u03b4(G) \u2264\n( 47 + \u03b7)n, and consequently sp(n, \u03b4 + \u03b7n) < ( 27 + 2\u03b7)n. We first prove\ntwo statements about the structure of G which are forced by (12).\n(\u03a8) If a vertex u has sets of neighbours U, U \u2032 on edges in exactly two\ndifferent triangle components with |U| \u2265 |U \u2032 | then ( 71 \u2212 4\u03b7)n <\n|U \u2032 | < ( 71 + 6\u03b7)n and ( 37 \u2212 8\u03b7)n < |U| < ( 37 + 2\u03b7)n.\n\nProof of (\u03a8). For the lower bound on |U \u2032 |, observe that by (c ) of\nLemma 11 we have \u03b4(G[U \u2032 ]) \u2265 2\u03b4 \u2212 n \u2265 ( 17 \u2212 4\u03b7)n. To obtain the\nupper bound, again by Lemma 11(c ) we have \u03b4(G[U]) \u2265 2\u03b4 \u2212 n, and\nsince the sets U and U \u2032 are neighbours of u in different triangle components C and C \u2032 , there are no edges from U to U \u2032 . Furthermore, since\nany edge in G[U] forms a triangle with u using an edge from u to U,\nall edges in G[U] are in C. Now by Fact 15 we have\nCTF(G) \u2265 min(3\u230a|U|/2\u230b, 3(2\u03b4 \u2212 n), 2\u03b4 \u2212 n + |U \u2032 |) .\n\nSince |U| \u2265 \u03b4/2 we have 3\u230a|U|/2\u230b \u2265 ( 37 \u2212 3\u03b7)n \u2212 2 > sp(n, \u03b4 + \u03b7n).\nBy (5) we have 3(2\u03b4 \u2212 n) > sp(n, \u03b4 + \u03b7n). Because (12) holds, we\nhave 2\u03b4 \u2212 n + |U \u2032 | < sp(n, \u03b4 + \u03b7n) < ( 72 + 2\u03b7)n, and therefore |U \u2032 | <\n( 71 + 6\u03b7)n. Now the claimed lower and upper bounds on |U| follow from\nU = \u0393(u) \\ U \u2032 , and from the fact that no vertex in U \u2032 has a neighbour\nin U, respectively.\n\u0003\n(\u039e) If a vertex u has sets of neighbours U1 , U2 , U3 on edges in exactly\n4\n4\nthree different triangle components then ( 21\n+ 2\u03b7)n > |Ui | > ( 21\n\u2212\n6\u03b7)n for i \u2208 [3].\n\n\f24\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nProof of (\u039e). Assume that U1 is the largest of the three sets. By (c )\nof Lemma 11 we have \u03b4(G[Ui ]) \u2265 2\u03b4 \u2212 n \u2265 ( 17 \u2212 4\u03b7)n for each i, so\n|Ui | > ( 71 \u2212 4\u03b7)n for each i. As in the previous case, there can be no\n \u0307 3 , and all edges in U1 are triangle-connected.\nedge from U1 to U2 \u222aU\nThus by Fact 15 we have\n\u0001\n \u0307 3| .\nCTF(G) \u2265 min 3\u230a|U1 |/2\u230b, 3(2\u03b4 \u2212 n), 2\u03b4 \u2212 n + |U2 \u222aU\nNow since sp(n, \u03b4 + \u03b7n) < ( 73 \u2212 10\u03b7)n and (12) holds, we have\n\n2\n3\u230a|U1 |/2\u230b < sp(n, \u03b4 + \u03b7n) \u2264 ( + 2\u03b7)n\n7\n4\nwhich implies |U1 | < ( 21 + 2\u03b7)n. Since |U2 |, |U3| \u2264 |U1 | this completes\nthe desired upper bounds. The lower bounds follow from |U1 | + |U2 | +\n\u0003\n|U3 | \u2265 \u03b4 \u2265 ( 74 \u2212 2\u03b7)n.\nNext we show that\n(\u0398) int(G) is an independent set.\nProof of (\u0398). Assume for a contradiction that there is an edge uv \u2208\nint(G). By Fact 16 one of the vertices of this edge, say u, is in only 2\ntriangle components. Let its neighbours be U1 and U2 in these two\ntriangle components, and let the neighbours of v be partitioned into\nsets V1 , . . . , Vk according to the triangle component containing the edge\nto v. Assume further that \u0393(u, v) \u2286 U1 \u2229 V1 , so that U2 , V2 , . . . , Vk are\npairwise disjoint. Let x \u2208 \u0393(u, v). Since x has neighbours in neither U2\nnor V2 , and since by Lemma 11(c ) we have |V2 | > ( 71 \u22124\u03b7)n, we conclude\nthat \u03b4 \u2264 d(x) \u2264 n \u2212 1 \u2212 |U2 | \u2212 |V2 |. In particular, |U2 | < ( 73 \u2212 8\u03b7)n\nbecause \u03b4 \u2265 ( 74 \u2212 2\u03b7)n, and therefore by (\u03a8) we have\n\n1\n1\n( \u2212 4\u03b7)n < |U2 | < ( + 6\u03b7)n .\n7\n7\nNext we want to derive analogous bounds for |V2 |. For this purpose we\nfirst show that k = 2.\nIndeed, if we had k = 3, then by (\u039e)\nd(x) \u2264 n \u2212 1 \u2212 |U2 | \u2212 |V2 | \u2212 |V3 |\n\n4\n10\n\u2264 n \u2212 1 \u2212 ( 71 \u2212 4\u03b7)n \u2212 2( 21\n\u2212 6\u03b7)n < ( 21\n+ 16\u03b7)n < \u03b4 ,\n\nand this contradicts \u03b4(G) \u2265 \u03b4. Similarly, if k \u2265 4, then by Lemma 11(c )\nwe have |Vi | \u2265 ( 17 \u2212 4\u03b7)n for each i, and hence\nd(x) \u2264 n \u2212 1 \u2212 |U2 | \u2212 |V2 | \u2212 |V3 | \u2212 |V4 | < ( 73 + 16\u03b7)n < \u03b4 ,\n\nwhich too is a contradiction. It follows that k = 2 as claimed.\nHence, we can argue analogously as before (for U2 ) that |V2 | > ( 73 \u2212\n8\u03b7) would contradict d(x) \u2265 \u03b4. Consequently, by (\u03a8) we have\n1\n1\n( \u2212 4\u03b7)n < |V2 | < ( + 6\u03b7)n .\n7\n7\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n25\n\nWe now argue that this yields a contradiction to (12) in much the\nsame way as we argued in the r = r \u2032 + 1 = 3 case. Every vertex\nof U2 is adjacent to all but at most n \u2212 |U1 | \u2212 \u03b4 \u2264 10\u03b7n vertices of\nV (G)\\U1 . Since |U2 | > 20\u03b7n, by Proposition 12(a ) there is a matching\nMu in U2 covering all but at most one vertex of U2 . Each edge of\nMu has at least \u03b4 \u2212 10\u03b7n \u2265 ( 74 \u2212 12\u03b7)n common neighbours outside\nU1 . Similarly, in V2 there is a matching Mv covering all but at most\none vertex of V2 , each edge of which has at least ( 74 \u2212 12\u03b7)n common\nneighbours outside V1 . Since \u0393(u, v) = U1 \u2229 V1 , we have U1 \u2229 V2 = \u2205.\nIt follows that every edge of Mv has more than half of the edges of Mu\n \u0307 v are triangle\nin its common neighbourhood, and thus the edges Mu \u222aM\n \u0307\nconnected. Choosing greedily for each edge in Mu \u222aMv in succession\n \u0307 v , we obtain a connected\na distinct common neighbour outside Mu \u222aM\n \u0307 v.\ntriangle factor with as many triangles as there are edges in Mu \u222aM\n1\n3\nSince |U2 |, |V2| > ( 7 \u2212 4\u03b7)n, we have CTF(G) > ( 7 \u2212 12\u03b7)n \u2212 3 >\nsp(n, \u03b4 + \u03b7n), contradicting (12). This completes the proof that int(G)\nis an independent set.\n\u0003\nIt remains to show that each vertex u \u2208 int(G) is contained in at\nleast r \u2032 = 3 triangle components. Assume for a contradiction that\nthis is not the case and that some vertex u is only contained in 2\ntriangle components, C and C \u2032 . Let U and U \u2032 , respectively, be the\nneighbours of u on edges in C and C \u2032 . Without loss of generality |U| \u2265\n|U \u2032 |. Because int(G) is an independent set, U and U \u2032 are contained in\nthe exteriors of C and C \u2032 . By Lemma 11(b ) there are thus no edges\nbetween U and \u2202(C \u2032 ). By Lemma 11(c ) we have \u03b4(G[U]) \u2265 2\u03b4 \u2212 n,\nand since U \u2286 \u2202(C) every edge of G[U] is in C. It follows that we may\napply Fact 15 to obtain\n\u0001\nCTF(G) \u2265 min 3\u230a|U|/2\u230b, 3(2\u03b4 \u2212 n), 2\u03b4 \u2212 n + |\u2202(C \u2032 )| .\n\nSince |U| \u2265 \u03b4/2 we have 3\u230a|U|/2\u230b \u2265 ( 73 \u2212 3\u03b7)n \u2212 2 > sp(n, \u03b4 + \u03b7n).\nBy (5) we have 3(2\u03b4 \u2212n) > sp(n, \u03b4 + \u03b7n). Since (12) holds, we conclude\nthat 2\u03b4 \u2212 n + |\u2202(C \u2032 )| < sp(n, \u03b4 + \u03b7n) < ( 27 + 2\u03b7)n, and therefore\n|\u2202(C \u2032 )| < ( 71 + 6\u03b7)n.\nNow any vertex in \u2202(C \u2032 ) has neighbours only in \u2202(C \u2032 )\u222a \u0307 int(G), and\ntherefore | int(G)| \u2265 \u03b4 \u2212 |\u2202(C \u2032 )| \u2265 ( 37 \u2212 8\u03b7)n. The vertex u has neighbours only in U \u2032 \u2286 \u2202(C \u2032 ) and U, and therefore\n|U| \u2265 \u03b4 \u2212 |U \u2032 | \u2265 \u03b4 \u2212 |\u2202(C \u2032 )| \u2265 ( 37 \u2212 8\u03b7)n .\n\nBy Lemma 11(c ) we have \u03b4(G[U]) \u2265 2\u03b4 \u2212 n \u2265 ( 17 \u2212 4\u03b7)n, and since\n|U| > ( 27 \u22128\u03b7)n we obtain by Proposition 12(a ) a matching M in U with\nat least ( 71 \u22124\u03b7)n edges. Now each vertex in int(G) is adjacent to all but\nat most n \u2212 \u03b4 \u2212 | int(G)| \u2264 10\u03b7n vertices outside int(G). In particular,\neach vertex in int(G) is adjacent to all but at most 10\u03b7n vertices of M,\nand is therefore a common neighbour of all but at most 10\u03b7n edges\n\n\f26\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nof M. We now match greedily vertices of int(G) with distinct edges\nof M forming triangles. Since | int(G)| > |M|, we will be forced to\nhalt only when we come to a vertex x \u2208 int(G) which is not a common\nneighbour of any remaining edge of M, i.e., when we have used all but\nat most 10\u03b7n edges of M. It follows that we obtain a triangle factor T\nwith at least ( 71 \u2212 14\u03b7)n triangles. Since each triangle uses an edge of\nM \u2286 G[U] \u2286 G[\u2202(C)], T is a connected triangle factor, and we have\nCTF(G) \u2265 ( 73 \u2212 42\u03b7)n > sp(n, \u03b4 + \u03b7n) in contradiction to (12).\n\u0003\n4. Near-extremal graphs\nIn this section we provide the proof of Lemma 10. To prepare this\nproof we start with two useful lemmas. The first will be used to construct squared paths and squared cycles from simple paths and cycles.\nLemma 20. Given a graph G, let T = (t1 , t2 , . . . , t2l ) be a path in\nG and W a set of vertices disjoint from T . Let Q1 = (t1 , t2 ), Qi =\n(t2i\u22123 , t2i\u22122 , t2i\u22121 , t2i ) for all 1 < i \u2264 l, and Ql+1 = (t2l\u22121 , t2l ). If there\nexists an ordering \u03c3 of [l + 1] such that for each i the vertices in Q\u03c3(i)\nhave at least i common neighbours in W , then there is a squared path\n(q1 , t1 , t2 , q2 , t3 , t4 , q3 , . . . , t2l , ql+1 )\nin G, with qi \u2208 W for each i, using every vertex of T .\nIf T is a cycle on 2l vertices we let instead Q1 = (t2l\u22121 , t2l , t1 , t2 ),\nQi = (t2i\u22123 , t2i\u22122 , t2i\u22121 , t2i ) for all 1 < i \u2264 l, and \u03c3 be an ordering\non [l]. Then, under the same conditions, we obtain a squared cycle C3l2 .\nProof. We need only ensure that for each i one can choose qi such that qi\nis a common neighbour of Qi and the qi are distinct. This is possible by\nchoosing for each i in succession q\u03c3(i) to be any so far unused common\nneighbour of Q\u03c3(i) .\n\u0003\nThe second lemma is a variant on Dirac's theorem and permits us\nto construct paths and cycles of desired lengths which keep some 'bad'\nvertices far apart.\nLemma 21. Let H be a graph on h vertices and B \u2286 V (H) be of\nsize at most h/100. Suppose that every vertex in B has at least 9|B|\nneighbours in H, and every vertex outside B has at least h/2+9|B|+10\nneighbours in H. Then for any given 3 \u2264 l \u2264 h we can find a cycle Tl\nof length l in H on which no four consecutive vertices contain more\nthan one vertex of B. Furthermore, if x and y are any two vertices not\nin B and 5 \u2264 l \u2264 h, we can find an l-vertex path Tl whose endvertices\nare x and y on which no four consecutive vertices contain more than\none vertex of B \u222a {x, y}.\nProof. If we seek a path in H from x to y then we create a 'dummy\nedge' between x and y. If we seek a cycle, let xy be any edge of H \u2212 B.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n27\n\nFirst we construct a path P in H covering B with the desired property. Let B = {b1 , b2 , . . . , b|B| }. For each 1 \u2264 i \u2264 |B| \u2212 1, choose a\nvertex ui \u2208 H \u2212 B adjacent to bi and a vertex vi \u2208 H \u2212 B adjacent\nto bi+1 . Because both ui and vi have h/2 + 9|B| + 10 neighbours in H,\nthey have at least 18|B| + 20 common neighbours. At most 3|B| of\nthese are either in B or amongst the chosen uj , vj , and so we can find\na so far unused vertex wi adjacent to ui and vi . Since we require only\n|B| \u2212 1 vertices w1 , . . . , w|B|\u22121 we can pick the vertices greedily.\nWe let v0 be yet another vertex adjacent to b1 , and u|B| adjacent\nto b|B| , and choose any further vertices w0 , v0 , w|B| , u|B| such that\nP = (x, y, u0, w0, v0 , b1 , u1 , w1 , v1 , b2 , . . . , v|B|\u22121, b|B| , u|B| , w|B| , v|B| )\nis a path on 4|B| + 5 vertices.\nNow we let P \u2032 be a path extending P in H of maximum length. We\nclaim that P \u2032 is in fact spanning. Suppose not: let u be an end-vertex\nof P \u2032 and v a vertex not on P \u2032 . Since P \u2032 is maximal every neighbour\nof u is on P \u2032 , so v(P \u2032) > h/2 + 9|B| + 10. If there existed an edge u\u2032 v \u2032 of\nP \u2032 \u2212 P with u\u2032u and v \u2032 v edges of H, with v \u2032 closer to u on P \u2032 than u\u2032 ,\nthen we would have a longer path extending P in H. Counting the\nedges leaving u and v yields a contradiction.\nFinally we let u and v be the end-vertices of the spanning path P \u2032 .\nIf uv is an edge of H, or if u\u2032 v \u2032 is an edge of P \u2032 \u2212 P , with u\u2032 nearer\nto u on P \u2032 than v \u2032 , such that uv \u2032 and u\u2032 v are edges of H, then we\nobtain a cycle T spanning H and containing P as a subpath. Again\nedge counting reveals that such an edge must exist.\nTo obtain a cycle Tl with h \u2212 |B| \u2212 2 \u2264 l < h we take u to be an\nend-vertex of the path T \u2212 P and v its successor on T \u2212 P . If we can\nfind two further vertices u\u2032 and v \u2032 on T \u2212 P (in that order from u along\nT \u2212 P ) with h \u2212 l vertices between them and with uu\u2032 and vv \u2032 edges\nof H then we would obtain a cycle Tl of length l. Again simple edge\ncounting reveals that such a pair of vertices exists. To obtain a cycle Tl\nwith 3 \u2264 l < h \u2212 |B| \u2212 2 we note that H \u2212 B has minimum degree\nh/2 + 8|B| + 10 > (h \u2212 |B|)/2 + 1 and thus contains a cycle of every\npossible length using the edge xy.\nThe cycle Tl satisfies the condition that no four consecutive vertices\ncontain more than one vertex of B, since either it preserves P as a\nsubpath or it contains no vertices of B at all. Similarly the path from x\nto y within Tl satisfies the required conditions.\n\u0003\nBefore embarking upon the proof of Lemma 10 we give an outline\nof the method. We recall that the Szemer\u00e9di partition supplied to the\nLemma is essentially the extremal structure. We shall show that the\nunderlying graph either also has an extremal structure, or possesses\nfeatures which actually lead to longer squared paths and cycles than\nrequired for the conclusion of the Lemma. This is complicated by the\nfact that the Szemer\u00e9di partition is insensitive both to mis-assignment\n\n\f28\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nof a sublinear number of vertices and to editing of a subquadratic number of edges: we must assume, for example, that although the\nS vertex\nset I in the reduced graph R is independent, the vertexSset I may\nfail to contain some vertices of G with no neighbours in I, and may\ncontain a small number of edges meeting every vertex. However, observe that S\nby the definition of an (\u03b5, d)-regular partition,\nS there are no\nvertices of I with more than (\u03b5 + d)n neighbours in I. Fortunately,\nit is possible to apply the following strategy in this case.\nS\nWe start by separating those vertices with 'few' neighbours in I,\nwhich we shall collect in a set W , and those with 'many'. We are then\nable to show (as Fact 23 S\nbelow) that,\nS if there are two vertex disjoint\nedges in W , then the sets B1 and B2 are in the same triangle component of G ('unexpectedly', since B1 and B2 are in different triangle\ncomponents in R). We shall show that in this case it is possible to construct very long squared paths and cycles by making use of Lemma 8.\nHence we can assume that there are not two disjoint edges in W ,\nwhich in turn implies that W is almost independent and will give us\nrather precise control about the size of W . In addition, the minimum\ndegree condition will guarantee that almost every edge from W to the\nremainder of G is present. We would like to then say that in V (G) \\ W\nwe can find a long path, which together with vertices from W forms\na squared path (and similarly for squared cycles). Unfortunately since\nG[W, V (G) \\ W ] is not necessarily a complete bipartite graph, this\nstatement is not obviously true: although by definition no vertex outside W has very few neighbours in W , it is certainly possible that two\nvertices outside W could fail to have a common neighbour in W . But\nthe statement is true for a path possessing sufficiently nice properties-\nspecifically, satisfying the conditions of Lemma 20-and the purpose\nof Lemma 21 is to provide paths and cycles with those nice properties.\nThe remainder of our proof, then, consists of setting up conditions for\nthe application of Lemma 21.\nProof of Lemma 10. Given \u03bd > 0, suppose the parameters \u03b7 > 0 and\nd > 0 satisfy the following inequalities.\n\u03bd4\n\u03bd4\nand\nd\n\u2264\n108\n108\nGiven d > 0, Lemma 8 returns a constant \u03b5el > 0. We set\n\n(14)\n\n(15)\nGiven mel\n(16)\n\n\u03b7\u2264\n\n\u0001\n\u03bd4\n\u03b50 = min\n,\n\u03b5\n.\nel\n108\nand 0 < \u03b5 < \u03b50 , Lemma 8 returns a constant nel . We set\n\u0001\nN = max 1000m4el, 100\u03b7 \u22121\u03bd \u22121 , nel .\n\n \u0307 1 \u222a \u0307 . . . \u222aB\n \u0307 k satisfy condiNow let G, R, and the partition V (R) = I \u222aB\ntions (i )\u2013(vi ) of the lemma.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n29\n\nIf \u03b4(G) = \u03b4 \u2265 2n\u22121\nthen we can appeal to Theorem 1 to find a\n3\nthen we can appeal to Theorem 2\nspanning squared path in G; if \u03b4 \u2265 2n\n3\n2\nto find Cl for each l \u2208 [3, n] \\ {5}. Therefore, the definition of sp(n, \u03b4)\nand sc(n, \u03b4) imply that we may assume \u03b4 < 2n/3 in the following, and\nthat we only need to find\n(17)\n\nsquared paths and squared cycles of length at most 11n/20.\n\nWe now start by investigating the sizes of I and of the Bi . Define\n\u03b4 = (\u03b4/n \u2212 d \u2212 \u03b5)m. Since R is an (\u03b5, d)-reduced graph we have\n\u2032\n\n(18)\n\n\u03b4(R) \u2265 \u03b4 \u2032 = (\u03b4/n \u2212 d \u2212 \u03b5)m .\n\nObserve that moreover\n\n\u0010\n\u0011\n\u03b4\n(19)\n|I| \u2264 m \u2212 \u03b4 \u2264 1 \u2212 + d + \u03b5 m ,\nn\nby (v ) because clusters in I have \u03b4 \u2032 neighbours outside I in R. For\ni \u2208 [k], fix a cluster C \u2208 Bi . By assumption (vi ) C has neighbours\nonly in Bi \u222a I in R. Since\n\u2032\n\n\u03b4 \u2032 \u2264 deg(C) = deg(C, Bi \u222a I) \u2264 deg(C, Bi ) + |I| \u2264 deg(C, Bi ) + m \u2212 \u03b4 \u2032 ,\nwe have\n\n\u0001\nm\n|Bi | > deg(C, Bi ) \u2265 2\u03b4 \u2032 \u2212 m \u2265\n2(\u03b4 \u2212 dn \u2212 \u03b5n) \u2212 n\nn\n\u0001\nm\n2\u03b4 \u2212 n \u2212 (d + \u03b5)n .\n=\nn\nNow since 2\u03b4 \u2212 n \u2265 2\u03bdn by (i ), we conclude from (14) and (15) that\n2m(2\u03b4 \u2212 n)\n4\n(20)\n|Bi | \u2265\n\u2265 \u03bdm .\n3n\n3\nWe next show that each Bi is part of exactly one triangle component\nof R.\nFact 22. For each 1 \u2264 i \u2264 k the following holds. All edges in R[Bi ]\nare triangle connected in R.\nProof of Fact 22. By assumption (vi ) we have\n(21)\n\n|Bi | \u2264 19m(2\u03b4 \u2212 n)/(10n) \u2264 39(2\u03b4 \u2032 \u2212 m)/20 ,\n\nwhere the second inequality comes from (14) and (15). Since we have\n\u03b4R (Bi ) \u2265 2\u03b4 \u2032 \u2212 m > |Bi |/2, the graph R[Bi ] is connected. It follows\nthat if there are two edges in R[Bi ] which are not triangle-connected,\nthen there are two adjacent edges in R[Bi ] with this property. That\nis, there are vertices P , Q and Q\u2032 of Bi such that P Q is in triangle\ncomponent C and P Q\u2032 is in triangle component C \u2032 with C 6= C \u2032 .\nWe now show that there are at least 2\u03b4 \u2032 \u2212m edges leaving P in R[Bi ]\nwhich are in C. There are two possibilities. First, suppose there are no\nC-edges from P to I. In this case, the common neighbourhood \u0393(P Q)\nmust lie entirely in Bi . Every vertex of \u0393(P Q) makes a C-edge with P ,\nand we have |\u0393(P Q)| \u2265 2\u03b4 \u2032 \u2212 m as required. Second, suppose that\n\n\f30\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nthere is a C-edge P P \u2032 with P \u2032 \u2208 I. Since I is an independent set in R,\nthe set \u0393(P P \u2032) lies entirely within Bi , and has size at least 2\u03b4 \u2032 \u2212 m.\nAgain, every edge from P to \u0393(P P \u2032) is a C-edge, as desired.\nBy the identical argument, there are at least 2\u03b4 \u2032 \u2212 m edges leaving P\nin R[Bi ] which are in C \u2032 . Since no edge is in both C and C \u2032 , there are\nat least 2(2\u03b4 \u2032 \u2212 m) edges leaving P in R[Bi ], so |Bi | \u2265 2(2\u03b4 \u2032 \u2212 m). This\ncontradicts (21). It follows that all edges of Bi are triangle connected,\nas desired.\n\u0003\nWe next\nS define a set W of those vertices in G which\nS have few neighbours in I. The intuition is that W consists of I and\n\u221a only a few\nmore vertices of G. To simplify notation, we set \u03be = 4 \u03b5 + d + 11\u03b7.\nBy (14) and (15), we have\n\u03be \u2264 \u03bd/100 .\n\n(22)\n\nLetSW be the vertices of G which do not have more than \u03ben neighbours\nin I. Since \u03be > d + \u03b5, by the independence\nof I and by the definition\nS\nof an (\u03b5, d)-regular partition, we have I \u2286 W . By assumption (v )\nwe have |I| \u2265 (n \u2212 \u03b4 \u2212 11\u03b7n)m/n. Hence every edge in W has at least\n\u0010\n[ \u0011 \u03b4 \u2212 (2\u03b4 \u2212 n)\n(23)\n2(\u03b4 \u2212 \u03ben) \u2212 n \u2212 | I| >\n16\nS\ncommon neighbours outside I, where we use assumption (i ) that\n2\u03b4 \u2212 n > 2\u03bdn, (14) and (22).\nBy this observation, the next fact implies that we are done if there\nare two vertex disjoint edges in W .\nFact 23. If u1 v1 and u2 v2 are vertex disjoint edges of G such that for\ni = 1, 2 S\nthe edge ui vi has at least \u03b4 \u2212 (2\u03b4 \u2212 n)/16 common neighbours\n2\noutside I, then G contains Psp(n,\u03b4)\nand Cl2 for each l \u2208 [3, sc(n, \u03b4)] \\\n{5}.\n\nProof of Fact 23. Let D \u2032 be the set of clusters C \u2208 V (R) \\ I such\nthat u1 v1 has at most 2dn/m common neighbours in C. By the hypothesis,\nS u1 v1 has at least \u03b4 \u2212 (2\u03b4 \u2212 n)/16 common neighbours outside I. Of these, at most \u03b5n are in the exceptional\nset V0 of the\nS\nregular partition, and at most 2dn|DS\u2032|/m are in D \u2032 . The remaining\ncommon neighbours must all lie in (V (R) \\ (I \u222a D \u2032 ), and hence we\nhave the inequality\n\u03b4\u2212\n\n2\u03b4 \u2212 n\n2dn|D \u2032|\nn\n\u2212 \u03b5n \u2212\n\u2264 (m \u2212 |I| \u2212 |D \u2032 |)\n16\nm\nm\n(v )\n\n\u2264 n \u2212 (n \u2212 \u03b4 \u2212 11\u03b7n) \u2212 |D \u2032 |\n\nSimplifying this, we obtain\n2\u03b4 \u2212 n\nn \u2212 2dn \u2032\n|D | \u2264 11\u03b7n + \u03b5n +\n,\nm\n16\n\nn\n.\nm\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n31\n\nand by (14) and (15), we get |D \u2032 | \u2264 (2\u03b4 \u2212 n)m/(14n).\nNow let D be the set of clusters C \u2208 V (R) \\ I such that either\nu1 v1 or u2 v2 has at most 2dn/m common neighbours in C. The same\nanalysis holds for u2 v2 , so we obtain\n(2\u03b4 \u2212 n)m\n.\n7n\nTherefore, we conclude from (20) that B1 \\ D 6= \u2205. Take X \u2208 B1 \\ D\narbitrarily. We have\n\u0010\n\u0011\n(vi )\n(19)\n\u03b4\ndeg(X, B1 ) \u2265 deg(X) \u2212 |I| \u2265 \u03b4 \u2032 \u2212 |I| \u2265 \u03b4 \u2032 \u2212 1 \u2212 + d + \u03b5 m\nn\n\u0011\n\u0010\n\u0011\n(18) \u0010 \u03b4\n\u03b4\n\u2212d\u2212\u03b5 m\u2212 1\u2212 +d+\u03b5 m\n\u2265\nn\nn\n(14),(15) 1\n(24)\nm\n\u2265\n> |D| .\n(2\u03b4 \u2212 n)\n2\nn\nThus there exists a cluster Y \u2208 \u0393(X)\u2229(B1 \\D). Hence we have clusters\nX, Y \u2208 B1 \\D such that XY \u2208 E(R). Analogously, we can find clusters\nX \u2032 , Y \u2032 \u2208 B2 \\ D such that X \u2032 Y \u2032 \u2208 E(R).\nSince \u03b4R (B1 ), \u03b4R (B2 ) \u2265 \u03b4 \u2032 \u2212 |I| \u2265 2\u03b4 \u2032 \u2212 m, we can find greedily a\nmatching M in R[B1 \u222a B2 ] with \u03b4 \u2032 \u2212 |I| edges. Since every cluster\nin I has at most m \u2212 |I| \u2212 \u03b4 \u2032 non-neighbours outside I, every cluster\nin I forms a triangle with at least |M| \u2212 (m \u2212 |I| \u2212 \u03b4 \u2032 ) = 2\u03b4 \u2032 \u2212 m\nedges of M. In addition, by assumption (v ), (14), and since \u03b4 < 2n/3\nwe have |I| > ( 31 \u2212 11\u03b7)m \u2265 41 m. Therefore we may choose greedily\nclusters in I to obtain a set T of at least\nn\n\b\n1 o\nmin 2\u03b4 \u2032 \u2212 m, |I| \u2265 min 2\u03b4 \u2032 \u2212 m, m\n4\nvertex-disjoint triangles formed from edges of M and clusters of I.\nLet T1 be the triangles of T contained in B1 \u222aI, and T2 those contained\nin B2 \u222a I.\nBy Fact 22, since each triangle in T1 contains an edge of B1 , all\ntriangles in T1 are in the same triangle component as the edge XY .\nSimilarly all the triangles in T2 are in the same triangle component as\nthe edge X \u2032 Y \u2032 .\nNoting that \u03b5 satisfies (15) and n > N satisfies (16), we can apply\nLemma 8 with X1 = X2 = X, Y1 = Y2 = Y to find a squared path\nstarting with u1 v1 and finishing with u2 v2 using the triangles T1 . Similarly, using Lemma 8 with X1 = X2 = X \u2032 , Y1 = Y2 = Y \u2032 we find a\nsquared path (intersecting the first only at u1 , v1 , u2 , and v2 ) starting with u2 v2 and finishing with u1 v1 using the triangles T2 . Choosing appropriate lengths for these squared paths and concatenating\nthem we get a squared cycle Cl2 in G, for any 36(mel + 2)3 \u2264 l \u2264\n3(1 \u2212 d) min{2\u03b4 \u2032 \u2212 m, m/4}n/m. Applying Lemma 8 to the copy of K4\nin B1 directly we obtain Cl2 for each l \u2208 [3, 3n/m] \\ {5}. By (16) we\n(24)\n\n|D| \u2264\n\n\f32\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nhave 3n/m > 36(mel + 2)3 , and by (5), (14), (15), and (17) we have\n3(1\u2212d)(2\u03b4 \u2032 \u2212m)n/m > sp(n, \u03b4) \u2265 sc(n, \u03b4) and 3(1\u2212d)n/4 \u2265 11n/20 >\n2\nsp(n, \u03b4) \u2265 sc(n, \u03b4). It follows that G contains both Psp(n,\u03b4)\nand Cl2 for\neach l \u2208 [3, sc(n, \u03b4)] \\ {5} as required.\n\u0003\nBy (23), if there are two vertex disjoint edges in W , then we are\ndone by Fact 23. Thus we assume in the following that no such two\nedges exist. This implies that there are two vertices in W which meet\nevery edge in W\nS. Since neither of these two vertices has more than \u03ben\nneighbours in I \u2286 W , while |I| > ( 31 \u2212 11\u03b7)m by (v ) and because\n\u03b4 < 2n/3, there is a vertex in W adjacent to no vertex of W . We\nconclude that\n[\n(25)\nn \u2212 \u03b4 \u2212 11\u03b7n \u2264 | I| \u2264 |W | \u2264 n \u2212 \u03b4.\nS\nOur next goal is to extract from each set Bi a large set Ai of\nvertices which are adjacent to almost all vertices in W and are such that\nG[Ai ] has minimum degree somewhat above |Ai |/2. Because at least\n|W |\u03b4 \u2212 2|W | edges leave W , the total number of non-edges between W\nand V (G) \\ W is at most\n(25)\n\n|W ||V (G) \\ W | \u2212 |W |(\u03b4 \u2212 2) \u2264 (n \u2212 \u03b4)(\u03b4 + 11\u03b7n \u2212 \u03b4 + 2) \u2264 11\u03b7n2 + 2n .\nIn particular, by the definition of \u03be, by (14) and (16),\n\b\n(26)\nv \u2208 V (G) \\ W : deg(v, W ) < |W | \u2212 \u03be 2n \u2264 \u03be 2 n .\n\nIn addition, by assumption (vi ) we have |Bi | \u2264 19m(2\u03b4 \u2212 n)/(10n),\nwhich together with \u03b4 \u2264 2n/3, (14), (15) and (22) implies\n[\n19\n19\nBi \u2264 (2\u03b4 \u2212 n) \u2264 \u03b4 < \u03b4 \u2212 \u03ben \u2212 (d + \u03b5)n .\n(27)\n10\n20\nHowever, by assumption\nS (vi ) and the definition of an (\u03b5, d)-regular\npartition,\nvertices\nin\nBi send at most (d + \u03b5)n edges to V (G) \u2212\nS\nS\nBi \u2212 I. It follows from the definition of W that\n[\nBi \u2229 W = \u2205\nfor all i \u2208 [k] .\nS\nFurthermore, (14), (15) and (22) imply that v \u2208 Bi has at least\n(25)\n(27) [\n(28) \u03b4 \u2212 |W | \u2212 (d + \u03b5)n \u2265 2\u03b4 \u2212 n \u2212 (d + \u03b5)n > | Bi |/2 + 32\u03be 2 n\nS\nneighbours in Bi .\nS\nNow, for each i \u2208 [k] we let Ai be the set of vertices in Bi which\nare adjacent to at least |W |\u2212\u03be 2 n vertices of W . In the rest of this paragraph we determine some important properties of the sets Ai . By (26)\nwe have\n[ [ \u0001\n(29)\nBi \\ Ai \u2264 \u03be 2n\nfor all i \u2208 [k] .\ni\u2208[k]\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n33\n\nBut the vertices which are neither in WS nor any of the sets Ai must be\neither in the exceptional set V0 or in Bi \\ Ai for some i. Hence we\nhave\n[ [ \u0001\nV0 \u222a\n(30)\nBi \\ Ai \u2264 \u03b5n + \u03be 2 n < 2\u03be 2 n .\ni\u2208[k]\n\nAccordingly (28) implies that\n(31)\n\n\u03b4(G[Ai ]) \u2265 |Ai |/2 + 30\u03be 2 n ,\n\nand since |Bi | > \u03b4 \u2032 \u2212 |I| \u2265 2\u03b4 \u2032 \u2212 m we have\n[\nn\n(32) |Ai | \u2265 | Bi | \u2212 2\u03be 2n \u2265 (1 \u2212 \u03b5) |Bi | \u2212 2\u03be 2 n \u2265 2\u03b4 \u2212 n \u2212 3\u03be 2 n\nm\nfor each i \u2208 [k], where we used the definition of \u03be, (14), 15, and (18) in\nthe last inequality.\nIn the remainder of the proof we utilize the sets Ai in order to find\nthe desired squared path and squared cycles. We start by showing that\nwe obtain squared cycles on l vertices for each l \u2208 [3, 23 |A1 |] \\ {5}. To\nsee this note first that\u0002by Lemma 21 (with\n\u0003 B = \u2205) we find in A1 a copy\nn\n\u2032\n\u2032\nof C2l for each 2l \u2208 4, min{|A1 |, 2 4 } . By the definition of A1 every\nquadruple of consecutive vertices on such a cycle has at least |W |\u22124\u03be 2n\ncommon neighbours in W , and by the definition of \u03be, (14), (15), and\n(25) we have |W | \u2212 4\u03be 2 n \u2265 n/4. Hence we can apply Lemma 20 to G\nand W to square this cycle. This gives us squared cycles of lengths l\nwith\nn3\nn o (17) 3\n= |A1 |\n|A1 |, 3\n3 \u2264 l \u2264 min\n2\n4\n2\nsuch that l is divisible by three, but not of lengths not divisible by\nthree.\n2\n2\n\u2032\nIf we seek a squared cycle C3l\n\u2032 +1 or C3l\u2032 +2 (with 3l + 2 6= 5) then\nwe need to perform a process which we will call parity correction and\nwhich we explain in the following two paragraphs. We shall use this\nparity correction process also in all remaining steps of the proof to\nobtain squared cycles of lengths not divisible by 3.\nFor obtaining a squared cycle of length 3l\u2032 + 1 we proceed as follows. We pick (using Tur\u00e1n's theorem) a triangle abc in A1 and clone\nthe vertex b, i.e., we insert a dummy vertex b\u2032 into G with the same\nadjacencies as b. Then we apply Lemma 21 to A1 \u2212 {b} to find a path\nP = (a, p2 , p3 , . . . , p2l\u2032 \u22121 , c) on 2l\u2032 vertices whose end-vertices are a and\nc. Finally we apply Lemma 20 to the path bP b\u2032 , taking Q1 = (b, a),\nQ2 = (b, a, p2 , p3 ) as the first quadruple and thereafter every other set of\nfour consecutive vertices on P , finishing with (p2l\u2032 \u22122 , p2l\u2032 \u22121 , c, b\u2032 ). This\nyields a squared path (q1 , b, a, . . . , c, b\u2032 ) on 3(l\u2032 +1) vertices, which gives\na squared cycle (b, a, . . . , c) in G (without q1 and the clone vertex b\u2032 )\non 3l\u2032 + 1 vertices as required.\n\n\f34\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nIf we seek a squared cycle of length 3l\u2032 + 2 with l\u2032 > 1 on the other\nhand, then we perform a similar process, except that we identify not\none triangle in A1 but two triangles abc, xyz connected with an edge cx\n(which we obtain by the Erd\u0151s-Stone theorem). We apply Lemma 21\nto find a path P = (a, . . . , z) in A1 \\ {b, c, y, z} on 2l\u2032 vertices. We\nthen apply Lemma 20 once to the path bP y and once to (b, c, x, y).\nOmitting the first vertex on each of the resulting squared paths and\n2\nconcatenating, we get a squared cycle C3l\n\u2032 +2 .\nHence we do indeed obtain squared cycles Cl2 for all l \u2208 [3, 32 |A1 |] \\\n{5}. It remains to show that we can also find Cl2 for all l with 23 |A1 | \u2264\n2\nl \u2264 sc(n, \u03b4) and that we can find Psp(n,\u03b4)\n.\nFor this purpose, we first re-incorporate the vertices that are neither\nin W nor in any of the sets Ai by examining in which of the Ai they\nhave many neighbours. More precisely, for each i \u2208 [k], we let Xi\nbe Ai together with all vertices in V (G) \\ W which are adjacent to at\nleast 30\u03be 2n vertices of Ai . Because every vertex in V (G) \\ W has at\nleast \u03b4 \u2212 |W | neighbours outside W , by (25) every vertex in G \u2212 W is\nin Xi for at least one i. Moreover, by the definition\nof an (\u03b5, d)-regular\nS\npartition, assumption (vi ) and since Aj \u2286 Bj , we have for all j \u2208 [k]\nwith j 6= i that\nAj \u2229 Xi = \u2205 .\n\n(33)\n\nHence it follows from (30) that\n(34)\n\n|Xi | < |Ai | + 2\u03be 2n\n\nand\n\n|X1 \u2212 A1 | \u2264 2\u03be 2n .\n\nWe finish the proof by distinguishing three cases.\nCase 1: |Xi \u2229Xj | \u2265 2 for some i 6= j. Let v1 and v2 be distinct vertices\nof Xi \u2229 Xj . Let u1 and u2 be distinct neighbours in Ai of v1 and v2\nrespectively, and similarly y1 and y2 in Aj . Applying Lemma 21 to Ai\nwe can find a path from u1 to u2 of length l\u2032 for any 4 \u2264 l\u2032 \u2264 |Ai | \u2212 2.\nWe can find a similar path in Aj from y1 to y2 . Concatenating these\npaths with v1 and v2 we can find a 2l\u2032 -vertex cycle T2l\u2032 in X1 \u222a X2 for\nany 10 \u2264 2l\u2032 \u2264 |Ai | + |Aj | \u2212 2. There are no quadruples of consecutive\nvertices on T2l\u2032 using both v1 and v2 . The four quadruples that use\neither v1 or v2 each have at least (\u03be \u22123\u03be 2)n > 100k common neighbours\nin W , where the inequality follows from (16), (22), from\n(35)\n\nk \u2264 \u03bd \u22121 ,\n\nand from \u03be \u2212 3\u03be 2 > 0. All other quadruples have at least |W | \u2212 4\u03be 2n\ncommon neighbours in W . So applying Lemma 20 we obtain a squared\ncycle on 3l\u2032 vertices. Again it is possible to perform parity corrections\n(prior to applying Lemma 21) so that in this case we have Cl2 \u2286 G for\nevery l \u2208 [3, 23 (|Ai | + |Aj | \u2212 10)] \\ {5}. By (32), we have sc(n, \u03b4) \u2264\nsp(n, \u03b4) < 32 (|Ai | + |Aj | \u2212 10).\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n35\n\nCase 2: for some i every vertex of Ai is adjacent to at least one\nvertex outside Xi \u222a W . Since\n(20) 4\n(29) [\n(22)\n(22),(35)\nBi \u2212 \u03be 2 n \u2265 \u03bd(1 \u2212 \u03b5)n \u2212 \u03be 2 n \u2265 13\u03ben > 31k\u03be 2n\n|Ai | \u2265\n3\nwe can certainly find j 6= i such that there are 31\u03be 2n vertices in Ai\nall adjacent to vertices of Xj \\ Xi . Since no vertex of Xj \\ Xi is adjacent to 30\u03be 2n vertices of Ai (by definition of Xi ), we find two disjoint\nedges u1 v1 and u2 v2 from u1 , u2 \u2208 Ai to v1 , v2 \u2208 Xj . Choosing distinct\nneighbours y1 of v1 and y2 of v2 in Aj and applying the same reasoning\nas in the previous case we are done.\nCase 3: for each i 6= j we have |Xi \u2229 Xj | \u2264 1, and for each i some\nvertex in Ai is adjacent only to vertices in W \u222a Xi . Thus |Xi | \u2265\n\u03b4 \u2212 |W | + 1 for each i. We now first focus on finding a squared path\non sp(n, \u03b4) vertices in G, and then turn to the squared cycles which\nwill complete the proof. If for some i 6= j we have |Xi \u2229 Xj | = 1 then\nwe obtain a squared path of the desired length as in Case 1. There we\nrequired two vertices in Xi \u2229 Xj to obtain a squared cycle (which must\nreturn to its start), but one vertex suffices for a squared path to cross\nfrom Xi to Xj .\nSo, assume that the sets Xi are all disjoint. It follows that k \u2264\n(n \u2212 |W |)/(\u03b4 \u2212 |W | + 1). Since |W | \u2264 n \u2212 \u03b4 by (25), this implies\nk\u2264\n\nn \u2212 (n \u2212 \u03b4)\n\u03b4\n=\n.\n\u03b4 \u2212 (n \u2212 \u03b4) + 1\n2\u03b4 \u2212 n + 1\n\nNow if k \u2265 rp (n, \u03b4) + 1 then we would have\nrp (n, \u03b4) + 1 \u2264 k \u2264\nand so\n\n\u03b4\n,\n2\u03b4 \u2212 n + 1\n\nn\u2212\u03b4\u22121\n,\n2\u03b4 \u2212 n + 1\nn\u2212\u03b4\n, so\nbut by (3) we have rp (n, \u03b4) \u2265 2\u03b4\u2212n+1\nrp (n, \u03b4) \u2264\n\nk \u2264 rp (n, \u03b4) .\nThus the largest of the sets Xi , say X1 , has at least\n(36)\n\n|X1 | \u2265\n\nn \u2212 |W | (25) \u03b4\n\u03b4\n\u2265\n\u2265\nk\nk\nrp (n, \u03b4)\n\nvertices.\nWe now want to apply Lemma 21 with H = G[X1 ] and 'bad' vertices\nB = X1 \u2212 A1 . Note that by (34) there are at most 2\u03be 2 n vertices in\nB = X1 \u2212 A1 , and so we have\n(34)\n\n(22)\n\n|B| \u2264 2\u03be 2n \u2264\n\n|H|\n\u03bd\u03b4 (35) \u03b4\n\u2264\n\u2264\n.\n100\n100k\n100\n\n\f36\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nMoreover, \u03b4(H) = \u03b4(G[X1 ]) \u2265 30\u03be 2n by definition of X1 , and therefore\nevery vertex in B has at least 30\u03be 2 n \u2265 9 * 2\u03be 2n \u2265 9|B| neighbours in H.\nIn addition, vertices v in H \u2212 B \u2286 A1 satisfy\n(34) |X1 |\n|A1 |\n+ 30\u03be 2n >\n+ 25\u03be 2n\n2\n2\n(16) |H|\n|H|\n=\n+ 25\u03be 2n \u2265\n+ 9|B| + 10 .\n2\n2\n(31)\n\ndeg(v, X1 ) \u2265\n\nHence we can indeed apply Lemma 21, to obtain a path T covering\nmin{X1 , n/2} vertices on which every quadruple of consecutive vertices\ncontains at most one 'bad' vertex. Finally we want to apply Lemma 20\nto the graph G[X1 \u222aW ] and the cycle T with the following ordering \u03c3 of\nthe quadruples of consecutive vertices in T : \u03c3 is such that all quadruples containing vertices from B come first, followed (by an arbitrary\nordering of) all other quadruples. There are at most 2*2\u03be 2 n quadruples\ncontaining vertices from B = X1 \u2212 A1 , and by the definition of A1 and\nof W , each of them has at least (\u03be \u2212 3\u03be 2 )n \u2265 \u03be 2 n common neighbours\nin W . All remaining quadruples have, by the definition of A1 , by (25)\nand since \u03b4 \u2264 2n/3, at least |W |\u22124\u03be 2 n \u2265 n4 \u2265 12 min{|X1|, n2 } common\nneighbours in W . Hence, we can indeed apply Lemma 20 to obtain a\nsquared path on at least 32 min{|X1 |, n/2} \u2265 sp(n, \u03b4) vertices, where\nthe inequality follows from the definition of sp(n, \u03b4), from (17), and\nfrom (36).\nAt last, we show that we can find in G the desired long squared\ncycles in Case 3. Assume first that there is a cycle of sets (relabelling\nthe indices if necessary) X1 , X2 , . . . , Xs for some 3 \u2264 s \u2264 k such that\nXi \u2229 Xi+1 mod s = {vi } for each i, and the vi are all distinct, then for\neach i we may choose neighbours ui \u2208 Ai and yi in Ai+1 mod s of vi ,\nand we may insist that all these 3s vertices are distinct. Similarly as\nbefore we can apply Lemma 21 to each G[Ai ] in turn and concatenate\nthe resulting paths, in order to find a cycle T2l\u2032 for every 8s \u2264 2l\u2032 \u2264\n|A1 |+|AS\n2 | on which there are no quadruples using more than one vertex\noutside i Ai . Again (checking the conditions similarly as before) we\nmay apply Lemma 20 to T2l\u2032 to obtain a squared cycle on 3l vertices.\nFinally by performing parity corrections we obtain Cl2 for every l \u2208\n[3, 32 (|A1 | + |A2 |)] \\ {5}.\nP\nIf there exists no such cycle of sets, then ki=1 |Xi | \u2264 n\u2212|W | + k \u22121.\nSince we have also |Xi | \u2265 \u03b4 \u2212 |W | + 1 for each i and |W | \u2264 n \u2212 \u03b4, it\nfollows from the definition of rc (n, \u03b4) (by establishing a relation similar\nto (3)) that k \u2264 rc (n, \u03b4), and by averaging, that the largest of the\nsets Xi , say X1 , contains at least 2 sc(n, \u03b4)/3 vertices. As before, we\ncan apply Lemma 21 to X1 to obtain a cycle T2l\u2032 for each 4 \u2264 2l\u2032 \u2264 |X1 |\non which the 'bad' vertices from B = X1 \u2212 A1 are separated, and apply\n\u2032\n2\nLemma 20 to it to obtain a squared cycle C3l\n\u2032 for each 6 \u2264 3l \u2264 sc(n, \u03b4)\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n37\n\nas required. Again the parity correction procedure is applicable, so we\nget Cl2 for every l \u2208 [3, sc(n, \u03b4)] \\ {5}.\n\u0003\n5. Concluding remarks\nThe proof of Theorem 4. Our results were most difficult to prove\nfor \u03b4 \u2248 4n/7. This is somewhat surprising given the experience from\nthe partial and perfect packing results of Koml\u00f3s [9] and K\u00fchn and\nOsthus [15]. In the setting of these results it becomes steadily more\ndifficult to prove packing results as the minimum degree of the graph\n(and hence the required size of a packing) increases, with perfect packings as the most difficult case. Yet in our setting it is relatively easy\nto prove our results when the minimum degree condition is large. This\ndifference occurs because we have to embed triangle-connected graphs;\nas the minimum degree increases the possibilities for bad behaviour\nwhen forming triangle-connections are reduced.\nThis is paralleled by the behaviour of K4 -free graphs: For any minimum degree \u03b4(G) > 2v(G)/3 the graph G is not K4 -free. However, if\n\u03b4(G) > 5v(G)/8 then by the Andr\u00e1sfai-Erd\u0151s-S\u00f3s theorem [2] the K4 free graph G is forced to be tripartite, while for smaller values of \u03b4(G)\nthere exist more possibilities.\nExtremal graphs. It is straightforward to check (from our proofs)\nthat up to some trivial modifications the graphs Gp (n, \u03b4) and Gc (n, \u03b4)\nare the only extremal graphs. We believe that the graph Gp (n, \u03b4) remains extremal for squared paths even when \u03b4 is not bounded away\nfrom n/2, although as noted in Section 1 the same is not true for Gc (n, \u03b4)\nand squared cycles.\nHowever it is not the case that the only extremal graph excluding\nsome Cl2 of chromatic number four is Kn\u2212\u03b4,n\u2212\u03b4,2\u03b4\u2212n (cf. (ii ) of our main\ntheorem, Theorem 4). Let us briefly explain this. Suppose l is not\ndivisible by three. Since Cl2 has no independent set on more than \u230al/3\u230b\nvertices, whenever we remove an independent set from Cl2 we must\nleave some three consecutive vertices, which form a triangle. Now\nsuppose that we can find a graph H on \u03b4 vertices with minimum degree\n2\u03b4 \u2212 n which is both triangle-free and contains no even cycle on more\nthan 2(2\u03b4 \u2212 n) vertices. Then the graph G obtained by adding an\nindependent set of size n \u2212 \u03b4 to H, all of whose vertices are adjacent to\nall of H, contains no squared cycle of length indivisible by three and\nno squared cycle with more than 3(2\u03b4 \u2212 n) vertices.\nTo mention one possible H, take \u03b4 = 6n\nand let H be obtained\n11\nas follows. We take the disjoint union of three copies of Kn/11,n/11\nand fix a bipartition. Now we add three vertex disjoint edges within\none of the two partition classes, one between each copy of Kn/11,n/11 .\nThe resulting triangle-free graph has no even cycle leaving any copy of\n\n\f38\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nKn/11,n/11 . Hence all even cycles have at most 2n\nvertices. However, it\n11\n6n\nhas odd cycles of up to 11 \u2212 3 vertices.\nLong squared cycles. Theorem 5 (ii ) states that if any of various\nodd cycles are excluded from G we are guaranteed even cycles of every\nlength up to 2\u03b4(G), whereas the equivalent statement in our Theorem 4\ncontains an error term. We believe this error term can be removed, but\nat the cost of significantly more technical work, requiring both a new\nversion of the stability lemma and new extremal results.\nHigher powers of paths and cycles. We note that Theorem 2 has\na natural generalisation to higher powers of cycles, the so called P\u00f3saSeymour Conjecture. This conjecture was proved for all sufficiently\nlarge n by Koml\u00f3s, S\u00e1rk\u00f6zy and Szemer\u00e9di [12]. We conjecture a natural generalisation of Theorem 4 for higher powers of paths and cycles.\n(k)\nGiven k, n and \u03b4, we construct an n-vertex graph Gp (n, \u03b4) by partitioning the vertices into an 'interior' set of l = (k \u2212 1)(n \u2212 \u03b4) vertices\nupon which we place a complete balanced k \u2212 1-partite graph, and an\n'exterior' set of n \u2212 l vertices upon which we place a disjoint union of\n\u230a(n \u2212 l)/(\u03b4 \u2212 l + 1)\u230b almost-equal cliques. We then join every 'interior'\n(k)\nvertex to every 'exterior' vertex. We construct Gc (n, \u03b4) similarly, permitting the cliques in the 'exterior' vertices to overlap in cut-vertices\nof the 'exterior' set if this reduces the size of the largest clique while\npreserving the minimum degree \u03b4.\nConjecture 24. Given \u03bd > 0 and k there exists n0 such that whenever\nn \u2265 n0 and G is an n-vertex graph with \u03b4(G) = \u03b4 > k\u22121\nn + \u03bdn, the\nk\nfollowing hold.\n(k)\n(i ) If Plk \u2286 Gp (n, \u03b4) then Plk \u2286 G.\n(k)\nk\nk\n(ii ) If C(k+1)l\n\u2286 Gc (n, \u03b4) for some integer l, then C(k+1)l\n\u2286 G.\n(k)\n\n(iii ) If Clk \u2286 Gc (n, \u03b4) with \u03c7(Clk ) = k + 2 and Clk 6\u2286 G for some\nk\ninteger l, then C(k+1)l\n\u2286 G for each integer l < k\u03b4\u2212(k\u22121)n\u2212\u03bdn.\n\nIt seems likely that again the \u03bdn error term in the last statement is\nnot required, but again (at least for powers of cycles) it is required in\nthe minimum degree condition.\nAcknowledgement\nThis project was started at DocCourse 2008, organised by the research training group Methods for Discrete Structures, Berlin. In particular, we would like to thank Mihyun Kang and Mathias Schacht for\norganising this nice event.\nReferences\n1. P. Allen, Minimum degree conditions for cycles, (2009), submitted.\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n39\n\n2. B. Andr\u00e1sfai, P. Erd\u0151s, and V. T. S\u00f3s, On the connection between chromatic\nnumber, maximal clique and minimal degree of a graph, Discrete Math. 8\n(1974), 205\u2013218.\n3. K. Corr\u00e1di and A. Hajnal, On the maximal number of independent circuits in\na graph, Acta Math. Acad. Sci. Hungar. 14 (1963), 423\u2013439.\n4. G. A. Dirac, Some theorems on abstract graphs, Proc. London Math. Soc. (3)\n2 (1952), 69\u201381.\n5. P. Erd\u0151s and A. H. Stone, On the structure of linear graphs, Bull. Amer. Math.\nSoc. 52 (1946), 1087\u20131091.\n6. P. Erd\u0151s, Problem 9, Theory of Graphs and its Applications (Proc. Sympos. Smolenice, 1963) (M. Fiedler, ed.), Publ. House Czechoslovak Acad. Sci.,\nPrague, 1964, p. 159.\n7. G. Fan and H. A. Kierstead, The square of paths and cycles, J. Combin. Theory\nSer. B 63 (1995), no. 1, 55\u201364.\n8.\n, Hamiltonian square-paths, J. Combin. Theory Ser. B 67 (1996), no. 2,\n167\u2013182.\n9. J. Koml\u00f3s, Tiling Tur\u00e1n theorems, Combinatorica 20 (2000), no. 2, 203\u2013218.\n10. J. Koml\u00f3s, G. N. S\u00e1rk\u00f6zy, and E. Szemer\u00e9di, On the square of a Hamiltonian\ncycle in dense graphs, Random Structures Algorithms 9 (1996), no. 1-2, 193\u2013\n211.\n, Blow-up lemma, Combinatorica 17 (1997), no. 1, 109\u2013123.\n11.\n12.\n, Proof of the Seymour conjecture for large graphs, Annals of Combinatorics 2 (1998), 43\u201360.\n13. J. Koml\u00f3s and M. Simonovits, Szemer\u00e9di's regularity lemma and its applications\nin graph theory, Combinatorics, Paul Erd\u0151s is eighty, Vol. 2 (Keszthely, 1993),\nBolyai Soc. Math. Stud., vol. 2, J\u00e1nos Bolyai Math. Soc., Budapest, 1996,\npp. 295\u2013352.\n14. D. K\u00fchn and D. Osthus, Embedding large subgraphs into dense graphs, Surveys in Combinatorics (S. Huczynka, J. Mitchell, and C. Roney-Dougal, eds.),\nCambridge University Press, 2009, pp. 137\u2013167.\n15. D. K\u00fchn and D. Osthus, The minimum degree threshold for perfect graph packings, Combinatorica 29 (2009), 65\u2013107.\n16. D. K\u00fchn, D. Osthus, and A. Taraz, Large planar subgraphs in dense graphs, J.\nComb. Theory, Ser. B 95 (2005), no. 2, 263\u2013282.\n17. V. Nikiforov and R. H. Schelp, Cycle lengths in graphs with large minimum\ndegree, Journal of Graph Theory 52 (2006), no. 2, 157\u2013170.\n18. I. Reiman, \u00dcber ein Problem von K. Zarankiewicz, Acta Math. Acad. Sci. Hungar. 9 (1958), 269\u2013273.\n19. M. Simonovits, A method for solving extremal problems in graph theory, stability\nproblems, Theory of Graphs (Proc. Colloq., Tihany, 1966), Academic Press,\n1968, pp. 279\u2013319.\n20. E. Szemer\u00e9di, Regular partitions of graphs, Probl\u00e8mes combinatoires et th\u00e9orie\ndes graphes (Orsay, 1976), Colloques Internationaux CNRS, vol. 260, CNRS,\n1978, pp. 399\u2013401.\n21. P. Tur\u00e1n, Eine Extremalaufgabe aus der Graphentheorie, Mat. Fiz. Lapok 48\n(1941), 436\u2013452.\n\nAppendix A. Proof of Lemma 8\nFor the proof of Lemma 8 we apply the following version (which is\na special case) of the Blow-up Lemma of Koml\u00f3s, S\u00e1rk\u00f6zy and Szemer\u00e9di [11].\n\n\f40\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nLemma 25 (Blow-up Lemma [11]). Given fixed c, d > 0, there exist\n\u03b50 > 0 and nbl such that for any 0 < \u03b5 < \u03b50 the following holds.\n \u0307 2 \u222aV\n \u0307 3\nLet H be any graph on at least nbl vertices with V (H) = V1 \u222aV\n1\nand |Vi | \u2265 6 |V (H)|, in which each bipartite graph H[Vi , Vj ] is (3\u03b5, d)regular and furthermore \u03b4Vi (Vj ) \u2265 21 d|Vi | for each 1 \u2264 i, j \u2264 3.\nLet F be any subgraph of the complete tripartite graph with parts\nV1 , V2 and V3 such that the maximum degree of F is at most four.\nAssume further, that at most four vertices xi (i \u2208 [4]) of F are endowed\nwith sets Cxi \u2286 Vj such that xi \u2208 Vj and |Cxi | \u2265 c|Vj |\nThen there is an embedding \u03c8 : V (F ) \u2192 V (H) of F into H with\n\u03c8(xi ) \u2208 Cxi for i \u2208 [4].\nWe also say that the xi in Lemma 25 are image restricted to Cxi .\nProof of Lemma 8. Given d, we let c = d2 /4. Now Lemma 25 gives\nvalues \u03b50 > 0 and nbl . We choose \u03b5el = min(\u03b50 , d2 /24). Given \u03b5 < \u03b5el\nand mel we choose\n\u0012\n\u0013\n6m4\nnel = max 2mel nbl ,\n.\n\u03b5\nLet n \u2265 nel , let G be an n-vertex graph, and let R\u2032 be an (\u03b5, d)-reduced\ngraph of G on m \u2264 mel vertices.\n\u2032\nFix a set T \u2032 = {T1\u2032 , . . . , TCTF(R\n\u2032 )/3 } of vertex-disjoint triangles in a\n\u2032\ntriangle component of R covering CTF(R\u2032 ) vertices. For each triangle\n\u2032\n\u2032\n\u2032\nTi\u2032 = Xi,1\nXi,2\nXi,3\nwe may by regularity for each j \u2208 [3] remove at\n\u2032\n\u2032\nmost \u03b5|Xi,j | vertices from Xi,j\nto obtain a set Xi,j such that each pair\n(Xi,j , Xi,k ) is not only (2\u03b5, d)-regular but also satisfies \u03b4Xi,k (Xi,j ) \u2265\n(d \u2212 3\u03b5)|Xi,k |. We let R be the (2\u03b5, d)-reduced graph corresponding\n\u2032\nto the new vertex partition given by replacing each Xi,j\nwith Xi,j ;\n\u2032\nthen every edge of R carries over to R, and we let T be the set of\nCTF(R\u2032 )/3 vertex disjoint triangles in R corresponding to T \u2032 . We set\nr = CTF(R\u2032 )/3.\nOur strategy now is as follows. We shall first fix a collection of\nsuitable triangle walks W1 , . . . , Wr\u22121 and W \u2032 in R. Next, for each of\n\u21c0\nthese triangle walks W = (E1 , E2 , . . .) we do the following. Let U1 V1 be\n(a suitable) orientation of the first edge E1 of W . We shall construct\n\u21c0\na sequence Q(W, U1 V1 ) of vertices of R whose first two vertices are U1\nand V1 , in that order, and which has the property that every vertex in\nthe sequence is adjacent to the two preceding vertices (as is the case\n\u21c0\nfor a squared path). Then we use this sequence Q(W, U1 V1 ) to obtain\na squared path in G following W , whose first two vertices are in U1\nand V1 . Finally, connecting suitable paths appropriately will lead to a\nproof of (i ), (ii ), and (iii ).\nWe first construct the triangle walks W1 , . . . , Wr\u22121 and W \u2032 . For each\n1 \u2264 i \u2264 r \u2212 1 let Wi be a fixed triangle walk in R whose first edge\nis in Ti and whose last is in Ti+1 . We suppose (repeating edges in the\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n41\n\ntriangle walk Wi if necessary) that each triangle walk Wi contains at\nleast ten edges, that the first edge of Wi+1 is not the same as the last\nedge of Wi , and such that each walk\n\u0001 with more than\u2032 ten edges is of\nm\nminimal length. We have |Wi | \u2264 2 for each i. Let W be the triangle\nwalk obtained by concatenating W1 , . . . , Wr\u22121 .\n\u21c0\nNext, we describe how to construct the sequence Q(W, A1 B1 ) for\n\u21c0\nany triangle walk W = (E1 , E2 , . . .) in R and any orientation A1 B1 of\n\u21c0\nits first edge E1 . We construct Q(W, A1 B1 ) iteratively as follows. Let\nQ1 = (A1 , B1 ). Now for each 2 \u2264 i \u2264 |W | successively, we define Qi\nas follows. The last two vertices Ai\u22121 , Bi\u22121 of Qi\u22121 are an orientation\nof Ei\u22121 . If Ei = Ai\u22121 Bi we create Qi by appending (Bi , Ai\u22121 ) to Qi\u22121 ;\nif Ei = Bi\u22121 Bi we append (Bi , Ai\u22121 , Bi\u22121 , Bi ) to Qi\u22121 to create Qi . At\neach step the final two vertices of Qi are an orientation of Ei . Furthermore every vertex of Qi is adjacent in R to the two vertices preceding\n\u21c0\nit in Qi . Finally, we let Q(W, A1 B1 ) = Q|W | .\nWe shall need the following observations concerning the lengths of\nsequences constructed in this way. It is easy to check by induction\nthat for any triangle walk W with at least two edges whose first edge\nis U1 V1 , we have\n\u21c0\n\n\u21c0\n\n|Q(W, U1 V1 )| + |Q(W, V1 U1 )| \u2261 1 mod 3 .\n\n(37)\n\nNow consider the concatenation W \u2032 of the walks Wi . Let U1 V1 be the\n\u21c0\nfirst edge of W1 . If we construct Q(W \u2032 , U1 V1 ) then the first edge Ui Vi\n\u21c0\nand the last edge Ui\u2032 Vi\u2032 of each Wi obtains an orientation, say Ui Vi\n\u21c0\nand Ui\u2032 Vi\u2032 . Clearly, there are sequences Q\u0303i of vertices in Ti for 1 < i < r,\n\u21c0\nsuch that Q(W \u2032 , V1 U1 ) is the concatenation of\n\u21c0\n\n\u21c0\n\n\u21c0\n\nQ(W1 , V1 U1 ), Q\u03032 , Q(W2 , V2 U2 ), . . . , Q\u0303r\u22121 , Q(Wr\u22121 , Vr\u22121 Ur\u22121 ) .\n\u2032\n\u2032\nFurther we let Q\u03031 = T1 \u2212 U1 V1 and Q\u0303r = Tr \u2212 Ur\u22121\nVr\u22121\n. We define\nfi = |Q\u0303i | mod 3 for i \u2208 [r]. Together with (37) we obtain\nX\n\u0001\n\u21c0\n\u21c0\n\u21c0\n|Q(Wi , Vi Ui )| + fi \u2261 1 mod 3\n|Q(W \u2032 , U1 V1 )| + |Q(W1 , V1 U1 )| +\n1<i<r\n\nand hence\n(38)\n\n\u21c0\n\n|Q(W \u2032 , U1 V1 )| +\n\nX\n\ni\u2208[r\u22121]\n\n\u0001\n\u21c0\n|Q(Wi , Vi Ui )| + fi + fr \u2261 0 mod 3 .\n\nThis will enable us to construct cycles of lengths divisible by three\nlater.\nIn order to construct squared paths in G from short vertex sequences\nin R we use the following fact.\nFact 26. Let X1 , X2 , X3 be vertices of R (not necessarily distinct),\nand Z be any set of at most 2\u03b5|X1 | vertices of G. Suppose that X1 X2\n\n\f42\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nand X1 X3 are edges of R. Suppose furthermore that we have two vertices u and v of G such that u and v have at least (d\u22122\u03b5)2 |X1 | common\nneighbours in X1 , and v has at least (d \u2212 2\u03b5)|X2| neighbours in X2 .\nThen there is a vertex w \u2208 X1 \u2212 Z adjacent to u and v such that v\nand w have at least (d \u2212 2\u03b5)2 |X2 | common neighbours in X2 and w has\nat least (d \u2212 2\u03b5)|X3| neighbours in X3 .\nProof of Fact 26. Let W be the set of common neighbours of u and v\nin X1 . Since X1 X2 \u2208 E(R), at most 2\u03b5|X1 | vertices of W have fewer\nthan (d \u2212 2\u03b5)|\u0393(v) \u2229 X2 | \u2265 (d \u2212 2\u03b5)2 |X2 | common neighbours with v\nin X2 . Since X1 X3 \u2208 E(R) at most 2\u03b5|X1| vertices of W have fewer\nthan (d \u2212 2\u03b5) neighbours in X3 . Finally since 6\u03b5|X1 | < (d \u2212 2\u03b5)2 |X1 |\nwe can find a vertex of W \\ Z satisfying the desired properties.\n\u0003\nWith these buiding bricks at hand we can now turn to the proofs of\n(i ), (ii ), and (iii ).\n2\nProof of (i ), i.e., G contains C3l\nfor each 3l \u2264 (1 \u2212 d) CTF(R)n/m:\n2\nWhen l \u2264 (1 \u2212 d)n/m we have C3l\n\u2286 K(1\u2212d)n/m,(1\u2212d)n/m,(1\u2212d)n/m and\n2\nthus by Lemma 25 we can find C3l as a subgraph of G (whose vertices\nare in T1 , with no restrictions required). Otherwise we use the following\nstrategy. Let UV be the first edge of the triangle walk W1 .\nOur first goal will be to construct a squared path P \u2032 in G which\n'connects' T1 to T2 , T2 to T3 , and so on. For this purpose we choose\ntwo adjacent vertices u and v of G in U and V respectively, such that u\nand v have (d \u2212 2\u03b5)2n/m common neighbours in both the third vertex\n\u21c0\nof T1 and the third vertex of Q(W \u2032 , UV ), such that v has (d \u2212 2\u03b5)n/m\n\u21c0\nneighbours in the fourth vertex of Q(W \u2032 , UV ), and such that u has\n(d \u2212 2\u03b5)n/m neighbours in V . This is possible by the regularity of the\nvarious pairs. (Observe that the required sizes for the neighbourhoods\nand joint neighbourhoods are chosen large enough for an application\nof Lemma 25 in the triangle T1 .) Now we apply Fact 26 with the\n\u21c0\nvertices u and v and the third, fourth and fifth vertices of Q(W \u2032 , UV )\n\u21c0\nto obtain a third vertex v \u2032 in the third vertex of Q(W \u2032 , UV ) such that u\nand v are adjacent to v \u2032 . By repeatedly applying Fact 26 we construct a\nsequence of vertices P \u2032 (starting with u, v, v \u2032), where the ith vertex of P \u2032\n\u21c0\nis in the ith set of Q(W \u2032 , UV ) and is adjacent to its two predecessors,\nand where the vertices are all distinct (noting that 3|W \u2032| < \u03b5n/m).\nThus P \u2032 is a squared path running from T1 to Tr\u22121 following all the\ntriangle walks Wi .\nIn addition we construct similarly (and without re-using vertices) for\neach 1 \u2264 i \u2264 r \u2212 1 a squared path Pi following the triangle walk Wi .\nHowever, this time we use the opposite orientation for the first edge:\n\u21c0\n\u21c0\nthat is, instead of constructing P1 from Q(W1 , UV ) we use Q(W1 , V U ),\nand similarly for each Pi we use the opposite orientation of the first\nedge of Wi to that used in P \u2032 . Again, for each Pi we insist that the\n\n\fBETWEEN TUR\u00c1N'S THEOREM AND P\u00d3SA'S CONJECTURE\n\n43\n\nfirst two vertices have suitable neighbourhoods in Ti , and the last two\nin Ti+1 , for an application of Lemma 25 in these triangles. Again, this\nis possible by regularity.\nWe note that the total number\nof vertices on all of these squared\n\u0001\npaths is not more than 6m m2 < \u03b5n/m. Finally, we remove from T1\nall vertices of P = P \u2032 \u222a P1 \u222a * * * \u222a Pr\u22121 . Since at most \u03b5n/m vertices\nare removed, and each cluster of T1 has size at least (1 \u2212 3\u03b5)n/m, even\nafter removal all three pairs remain (3\u03b5, d)-regular and each cluster still\nhas size at least (1 \u2212 4\u03b5)n/m.\nThus the conditions of Lemma 25 are satisfied, and hence we may\nembed a squared path S1 into T1 , with the four restrictions that its first\nvertex is a common neighbour of the first two vertices of P \u2032 , its second\na neighbour of the first vertex of P \u2032 , its penultimate vertex a neighbour\nof the first vertex of P1 and its final vertex a common neighbour of the\nfirst two vertices of P1 (noting that by choice of the first two vertices\nof P \u2032 and of P1 the sets to which these vertices are restricted are indeed\nof size cn/m because c = d2 /4). In this way we can construct a squared\npath on 3l1 + f1 vertices for any integer l1 \u2208 [10, (1 \u2212 d)n/m] (since\n3 * 4\u03b5 < d), where f1 \u2208 {0, 1, 2} is as defined above (38). Similarly\nwe may apply Lemma 25 to each Ti (2 \u2264 i \u2264 r), after removing P\nfrom Ti , to obtain squared paths Si of length 3li + fi for any integer\nli \u2208 [10, (1 \u2212 d)n/m].\nFinally S = P \u2032 \u222a S1 \u222a P1 \u222a . . . \u222a Pr\u22121 \u222a Sr forms a squared cycle\nin G. It follows from (38) that the length of S is divisible by three.\n2\nWe conclude that indeed S = C3k\n, where we may choose any integer k\n3\nwith 3k \u2208 [6m , (1 \u2212 d) CTF(R)n/m], as required.\nProof of (ii ): When every triangle component of R contains K4\nwe also want to obtain squared cycles whose lengths are not divisible\nby three. Observe that if ABCD is a copy of K4 in R, then the vertex sequences ABC, ABCDABC and ABCDABCDABC each start\nand end with the same pair. Hence, with the help of Fact 26, these sequences can be used to construct squared paths in G of length 3 (which\nis 0 mod 3), length 7 (1 mod 3), and length 11 (2 mod 3).\nWe construct Cl2 for l \u2208 [3, 20] \\ {5} within a copy of K4 in R\ndirectly (by the above methods). To obtain Cl2 with 21 \u2264 l \u2264 3(1 \u2212\nd)n/m we remove at most 2\u03b5n/m vertices from each of A, B and C\nto obtain a triangle satisfying the conditions of Lemma 25, construct a\nshort path in A, B, C, D following the appropriate vertex sequence for\nl mod 3 and apply Lemma 25 to obtain Cl2 . Finally, to obtain longer\nsquared cycles we perform the same construction as above, with the\nexception that W \u2032 is any triangle walk to and from a copy of K4 , and\n\u21c0\nso Q(W \u2032 , UV ) may be taken (using one of the three vertex sequences\nabove) to have any desired number of vertices modulo three (and not\nmore than 2m2 in total).\n\n\f44\n\nPETER ALLEN, JULIA B\u00d6TTCHER, AND JAN HLADK\u00dd\n\nProof of (iii ): Lastly, when we are required to construct a squared\npath between two specified edges u1 v1 (with 2dn/m common neighbours in both X1 and Y1 ) and u2 v2 (with 2dn/m common neighbours\nin both X2 and Y2 ) using triangles T in R, we apply the identical strategy, noting that the conditions on u1 v1 and u2 v2 are already suitable\nfor an application of Fact 26.\n\u0003\n\n\f"}