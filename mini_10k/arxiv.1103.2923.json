{"id": "http://arxiv.org/abs/1103.2923v1", "guidislink": true, "updated": "2011-03-15T14:37:40Z", "updated_parsed": [2011, 3, 15, 14, 37, 40, 1, 74, 0], "published": "2011-03-15T14:37:40Z", "published_parsed": [2011, 3, 15, 14, 37, 40, 1, 74, 0], "title": "Estimation of Saturation of Permanent-Magnet Synchronous Motors Through\n  an Energy-Based Model", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1103.5522%2C1103.0378%2C1103.5393%2C1103.0149%2C1103.3641%2C1103.0238%2C1103.1216%2C1103.2919%2C1103.4704%2C1103.3250%2C1103.2787%2C1103.4943%2C1103.0399%2C1103.3955%2C1103.5499%2C1103.5946%2C1103.2573%2C1103.1562%2C1103.4284%2C1103.4053%2C1103.2970%2C1103.2676%2C1103.0005%2C1103.2923%2C1103.6235%2C1103.3180%2C1103.1903%2C1103.3660%2C1103.6166%2C1103.5125%2C1103.4649%2C1103.1144%2C1103.3374%2C1103.5188%2C1103.0464%2C1103.3732%2C1103.5764%2C1103.1045%2C1103.6173%2C1103.6051%2C1103.2991%2C1103.5937%2C1103.6075%2C1103.1760%2C1103.2879%2C1103.1868%2C1103.4483%2C1103.1564%2C1103.6192%2C1103.3709%2C1103.0979%2C1103.1167%2C1103.2281%2C1103.4158%2C1103.0208%2C1103.2584%2C1103.0466%2C1103.5466%2C1103.3029%2C1103.5320%2C1103.4246%2C1103.1399%2C1103.3464%2C1103.1982%2C1103.4155%2C1103.0003%2C1103.6077%2C1103.2753%2C1103.0451%2C1103.3398%2C1103.0275%2C1103.4666%2C1103.2601%2C1103.4606%2C1103.5483%2C1103.5277%2C1103.3169%2C1103.1241%2C1103.2252%2C1103.2130%2C1103.0956%2C1103.2603%2C1103.0774%2C1103.1640%2C1103.0590%2C1103.0967%2C1103.2279%2C1103.2974%2C1103.2282%2C1103.2113%2C1103.4611%2C1103.4707%2C1103.3058%2C1103.3899%2C1103.3354%2C1103.1504%2C1103.0656%2C1103.2198%2C1103.4333%2C1103.6209%2C1103.5617&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Estimation of Saturation of Permanent-Magnet Synchronous Motors Through\n  an Energy-Based Model"}, "summary": "We propose a parametric model of the saturated Permanent-Magnet Synchronous\nMotor (PMSM) together with an estimation method of the magnetic parameters. The\nmodel is based on an energy function which simply encompasses the saturation\neffects. Injection of fast-varying pulsating voltages and measurements of the\nresulting current ripples then permit to identify the magnetic parameters by\nlinear least squares. Experimental results on a surface-mounted PMSM and an\ninteroir magnet PMSM illustrate the relevance of the approach.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1103.5522%2C1103.0378%2C1103.5393%2C1103.0149%2C1103.3641%2C1103.0238%2C1103.1216%2C1103.2919%2C1103.4704%2C1103.3250%2C1103.2787%2C1103.4943%2C1103.0399%2C1103.3955%2C1103.5499%2C1103.5946%2C1103.2573%2C1103.1562%2C1103.4284%2C1103.4053%2C1103.2970%2C1103.2676%2C1103.0005%2C1103.2923%2C1103.6235%2C1103.3180%2C1103.1903%2C1103.3660%2C1103.6166%2C1103.5125%2C1103.4649%2C1103.1144%2C1103.3374%2C1103.5188%2C1103.0464%2C1103.3732%2C1103.5764%2C1103.1045%2C1103.6173%2C1103.6051%2C1103.2991%2C1103.5937%2C1103.6075%2C1103.1760%2C1103.2879%2C1103.1868%2C1103.4483%2C1103.1564%2C1103.6192%2C1103.3709%2C1103.0979%2C1103.1167%2C1103.2281%2C1103.4158%2C1103.0208%2C1103.2584%2C1103.0466%2C1103.5466%2C1103.3029%2C1103.5320%2C1103.4246%2C1103.1399%2C1103.3464%2C1103.1982%2C1103.4155%2C1103.0003%2C1103.6077%2C1103.2753%2C1103.0451%2C1103.3398%2C1103.0275%2C1103.4666%2C1103.2601%2C1103.4606%2C1103.5483%2C1103.5277%2C1103.3169%2C1103.1241%2C1103.2252%2C1103.2130%2C1103.0956%2C1103.2603%2C1103.0774%2C1103.1640%2C1103.0590%2C1103.0967%2C1103.2279%2C1103.2974%2C1103.2282%2C1103.2113%2C1103.4611%2C1103.4707%2C1103.3058%2C1103.3899%2C1103.3354%2C1103.1504%2C1103.0656%2C1103.2198%2C1103.4333%2C1103.6209%2C1103.5617&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We propose a parametric model of the saturated Permanent-Magnet Synchronous\nMotor (PMSM) together with an estimation method of the magnetic parameters. The\nmodel is based on an energy function which simply encompasses the saturation\neffects. Injection of fast-varying pulsating voltages and measurements of the\nresulting current ripples then permit to identify the magnetic parameters by\nlinear least squares. Experimental results on a surface-mounted PMSM and an\ninteroir magnet PMSM illustrate the relevance of the approach."}, "authors": ["AlKassem Jebai", "Francois Malrait", "Philippe Martin", "Pierre Rouchon"], "author_detail": {"name": "Pierre Rouchon"}, "author": "Pierre Rouchon", "arxiv_comment": "IEMDC-2011 (preliminary version)", "links": [{"href": "http://arxiv.org/abs/1103.2923v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1103.2923v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.SY", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.ins-det", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1103.2923v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1103.2923v1", "journal_reference": null, "doi": null, "fulltext": "Estimation of Saturation of Permanent-Magnet\nSynchronous Motors Through an Energy-Based\nModel\narXiv:1103.2923v1 [math.OC] 15 Mar 2011\n\nAl Kassem Jebai\u2217, Fran\u00e7ois Malrait\u2020 , Philippe Martin\u2217 and Pierre Rouchon\u2217\n\u2217 Mines\n\nParisTech, Centre Automatique et Syst\u00e8mes, 60 Bd Saint-Michel, 75272 Paris cedex 06, France\nEmail: {al-kassem.jebai, philippe.martin, pierre.rouchon}@mines-paristech.fr\n\u2020 Schneider Electric, STIE, 33, rue Andr\u00e9 Blanchet, 27120 Pacy-sur-Eure, France\nEmail: francois.malrait@schneider-electric.com\n\nAbstract-We propose a parametric model of the saturated\nPermanent-Magnet Synchronous Motor (PMSM) together with\nan estimation method of the magnetic parameters. The model\nis based on an energy function which simply encompasses the\nsaturation effects. Injection of fast-varying pulsating voltages\nand measurements of the resulting current ripples then permit\nto identify the magnetic parameters by linear least squares.\nExperimental results on a surface-mounted PMSM and an\ninteroir magnet PMSM illustrate the relevance of the approach.\n\nmethod of the magnetic parameters is proposed and rigorously\njustified: fast-varying pulsating voltages are impressed to the\nmotor with rotor locked; they create current ripples from\nwhich the magnetic parameters are estimated by linear least\nsquares. In section IV experimental results on two kinds of\nmotors (with surface-mounted and interior magnets) illustrate\nthe relevance of the approach.\n\nIndex Terms: Permanent magnet synchronous motor, magnetic circuit modeling, magnetic saturation, energy-based modeling, cross-magnetization\n\nPMSM\nA. Energy-based model\nThe electrical subsystem of a two-axis PMSM expressed in\nthe synchronous d \u2212 q frame reads\nd\u03b8\nd\u03c6d\n= ud \u2212 Rid + \u03c6q\n(1)\ndt\ndt\nd\u03c6q\nd\u03b8\n= uq \u2212 Riq \u2212 (\u03c6d + \u03c6m ),\n(2)\ndt\ndt\nwhere \u03c6d , \u03c6m are the direct-axis flux linkages due to the\ncurrent excitation and to the permanent magnet, and \u03c6q is the\nquadrature-axis flux linkage; ud , uq are the impressed voltages\nand id , iq are the currents; \u03b8 is the rotor (electrical) position\nand R is the stator resistance. The currents can be expressed\nin function of the flux linkages thanks to a suitable energy\nfunction H(\u03c6d , \u03c6q ) by\n\nI. I NTRODUCTION\nSensorless control of Permanent-Magnet Synchronous Motors (PMSM) at low velocity remains a challenging task.\nMost of the existing control algorithms rely on the motor\nsaliency, both geometric and saturation-induced, for extracting\nthe rotor position from the current measurements through\nhigh-frequency signal injection [1], [2]. However some magnetic saturation effects such as cross-coupling and permanent\nmagnet demagnetization can introduce large errors on the\nrotor position estimation [3], [4]. These errors decrease the\nperformance of the controller. In some cases they may cancel\nthe rotor total saliency and lead to instability. It is thus\nimportant to correctly model the magnetic saturation effects,\nwhich is usually done through d-q magnetizing curves (flux\nversus current). These curves are usually found either by finite\nelement analysis FEA or experimentally by integration of\nthe voltage equation [5], [6]. This provides a good way to\ncharacterize the saturation effects and can be used to improve\nthe sensorless control of the PMSM [7], [8]. However the FEA\nor the integration of the voltage equation methods are not so\neasy to implement and do not provide an explicit model of the\nsaturated PMSM.\nIn this paper a simple parametric model of the saturated\nPMSM is introduced (section II); it is based on an energy function [9], [10] which simply encompasses the saturation and\ncross-magnetization effects. In section III a simple estimation\n\nII. A N\n\nENERGY- BASED MODEL FOR THE SATURATED\n\nid = \u22021 H(\u03c6d , \u03c6q )\n\n(3)\n\niq = \u22022 H(\u03c6d , \u03c6q ),\n\n(4)\nth\n\nwhere \u2202k H denotes the partial derivative w.r.t. the k variable,\nsee [9], [10]; without loss of generality H(0, 0) = 0.\nFor an unsaturated PMSM this energy function reads\n1 2\n1 2\n\u03c6 +\n\u03c6\nHl (\u03c6d , \u03c6q ) =\n2Ld d 2Lq q\nwhere Ld and Lq are the motor self-inductances, and we\nrecover the usual linear relations\n\u03c6d\nid = \u22021 H(\u03c6d , \u03c6q ) =\nLd\n\u03c6q\niq = \u22022 H(\u03c6d , \u03c6q ) =\n.\nLq\n\n\fNotice the expression for H should respect the symmetry\nof the PMSM w.r.t the direct axis, i.e.\nH(\u03c6d , \u2212\u03c6q ) = H(\u03c6d , \u03c6q ),\n\n(5)\n\nwhich is obviously the case for Hl . Indeed, (1)-(2) is left\nunchanged by the transformation\n(\u03c6\u2032d , u\u2032d , i\u2032d , \u03c6\u2032q , u\u2032q , i\u2032q , \u03b8\u2032 ) := (\u03c6d , ud , id , \u2212\u03c6q , \u2212uq , \u2212iq , \u2212\u03b8);\nthis implies\n\u22021 H(\u03c6\u2032d , \u03c6\u2032q ) = \u22021 H(\u03c6d , \u03c6q )\n\u22022 H(\u03c6\u2032d , \u03c6\u2032q ) = \u2212\u22022 H(\u03c6d , \u03c6q ),\ni.e.\n\u22021 H(\u03c6d , \u2212\u03c6q ) = \u22021 H(\u03c6d , \u03c6q )\n\u22022 H(\u03c6d , \u2212\u03c6q ) = \u2212\u22022 H(\u03c6d , \u03c6q ).\n(a) \u03c6d (id , iq = Constant)\n\nTherefore\ndH\n(\u03c6d , \u2212\u03c6q ) = \u22021 H(\u03c6d , \u2212\u03c6q )\nd\u03c6d\n= \u22021 H(\u03c6d , \u03c6q )\ndH\n=\n(\u03c6d , \u03c6q )\nd\u03c6d\ndH\n(\u03c6d , \u2212\u03c6q ) = \u2212\u22022 H(\u03c6d , \u2212\u03c6q )\nd\u03c6q\n= \u22022 H(\u03c6d , \u03c6q )\ndH\n(\u03c6d , \u03c6q ).\n=\nd\u03c6q\nIntegrating these relations yields\nH(\u03c6d , \u2212\u03c6q ) = H(\u03c6d , \u03c6q ) + cd (\u03c6q )\nH(\u03c6d , \u2212\u03c6q ) = H(\u03c6d , \u03c6q ) + cq (\u03c6d ),\nwhere cd , cq are functions of only one variable. But this makes\nsense only if cd (\u03c6q ) = cq (\u03c6d ) = c with c constant. Since\nH(0, 0) = 0, c = 0, which yields (5).\nB. Parametric description of magnetic saturation\nMagnetic saturation can be accounted for by considering\na more complicated magnetic energy function H, having Hl\nfor quadratic part but including also higher-order terms. From\nexperiments saturation effects are well captured by considering\nonly third- and fourth-order terms, hence\nH(\u03c6d , \u03c6q ) = Hl (\u03c6d , \u03c6q )\n+\n\n3\nX\ni=0\n\ni\n\u03b13\u2212i,i \u03c63\u2212i\nd \u03c6q +\n\n4\nX\n\ni\n\u03b14\u2212i,i \u03c64\u2212i\nd \u03c6q .\n\n(b) \u03c6q (id = Constant, iq )\nFig. 1.\n\nFlux-current magnetization curves (IPM)\n\nFrom (3)-(4) and (6) the currents are then explicitly given by\nid = \u22021 H(\u03c6d , \u03c6q )\n\u03c6d\n+ 3\u03b13,0 \u03c62d + \u03b11,2 \u03c62q + 4\u03b14,0 \u03c63d + 2\u03b12,2 \u03c6d \u03c62q\n=\nLd\niq = \u22022 H(\u03c6d , \u03c6q )\n\u03c6q\n=\n+ 2\u03b11,2 \u03c6d \u03c6q + 2\u03b12,2 \u03c62d \u03c6q + 4\u03b10,4 \u03c63q ,\nLq\n\n(7)\n\n(8)\n\ni=0\n\nThis is a perturbative model where the higher-order terms appear as corrections of the dominant term Hl . The 9 coefficients\n\u03b1ij together with Ld , Lq are motor dependent. But (5) implies\n\u03b12,1 = \u03b10,3 = \u03b13,1 = \u03b11,3 = 0, so that the energy function\neventually reads\nH(\u03c6d , \u03c6q ) = Hl (\u03c6d , \u03c6q ) + \u03b13,0 \u03c63d + \u03b11,2 \u03c6d \u03c62q\n+ \u03b14,0 \u03c64d + \u03b12,2 \u03c62d \u03c62q + \u03b10,4 \u03c64q . (6)\n\nwhich are the flux-current magnetization curves. Fig. 1 shows\nexamples of these curves in the more familiar presentation of\nfluxes w.r.t currents obtained by numerically inverting (3)-(4);\nthe motor is the IPM of section IV.\nThe model of the saturated PMSM is thus given by (1)-(2)\nand (7)-(8). It is in state form with \u03c6d , \u03c6q as state variables.\nThe magnetic saturation effects are represented by the 5\nadditional parameters \u03b13,0 , \u03b11,2 , \u03b14,0 , \u03b12,2 , \u03b10,4 .\n\n\fC. Model with id , iq as state variables\nThe model of the saturated PMSM is often expressed with\nid , iq as state variables, e.g. [5]. Starting with flux-current\nmagnetization curves in the form\n\u03c6d = \u03a6d (id , iq )\n\n(9)\n\n\u03c6q = \u03a6q (id , iq )\n\n(10)\n\nand differentiating w.r.t time, (1)-(2) then becomes\ndid\ndt\ndid\nLqd (id , iq )\ndt\nwhere\n\u0012\nLdd (id , iq )\nLqd (id , iq )\n\nLdd (id , iq )\n\ndiq\nd\u03b8\n= ud \u2212 Rid + \u03c6q\ndt\ndt\ndiq\nd\u03b8\n+ Lqq (id , iq )\n= uq \u2212 Riq \u2212 (\u03c6d + \u03c6m ),\ndt\ndt\n\n+ Ldq (id , iq )\n\nLdq (id , iq )\nLqq (id , iq )\n\n\u0013\n\n\u0012\n\u2202 \u03a6 (i , i )\n= 1 d d q\n\u22021 \u03a6q (id , iq )\n\n\u0013\n\u22022 \u03a6d (id , iq )\n.\n\u22022 \u03a6q (id , iq )\n\nThough not always acknowledged Ldq and Lqd should be\nequal. Indeed, plugging (3)-(4) into (9)-(10) gives\n\u0001\n\u03c6d = \u03a6d \u22021 H(\u03c6d , \u03c6q ), \u22022 H(\u03c6d , \u03c6q )\n\u0001\n\u03c6q = \u03a6q \u22021 H(\u03c6d , \u03c6q ), \u22022 H(\u03c6d , \u03c6q ) .\n\nTaking the total derivative of both sides of these equations\nw.r.t. \u03c6d and \u03c6q then yields\n\u0012\n\u0013 \u0012\n\u0013\n1 0\nLdd \u220211 H + Ldq \u220212 H Ldd \u220221 H + Ldq \u220222 H\n=\n0 1\nLqd \u220211 H + Lqq \u220212 H Lqd \u220221 H + Lqq \u220222 H\n\u0012\n\u0013\u0012\n\u0013\nLdd Ldq\n\u220211 H \u220221 H\n=\n.\n\u220212 H \u220222 H\nLqd Lqq\nSince \u220212 H = \u220221 H the second matrix in the last line is\nsymmetric, hence the first; in other words Ldq = Lqd .\nTo do that with the model of section II-B the nonlinear\nequations (7)-(8) must be inverted. Rather than doing that\nexactly, we take advantage of the fact the coefficients \u03b1i,j are\nexperimentally small. At first order w.r.t. the \u03b1i,j we obviously\nhave \u03c6d = Ld id + O(|\u03b1i,j |) and \u03c6q = Lq iq + O(|\u03b1i,j |).\nPlugging these expressions into (7)-(8) we easily find\n\u03c6d = Ld id \u2212 3\u03b13,0 L2d i2d \u2212 \u03b11,2 L2q i2q \u2212 4\u03b14,0 L3d i3d\n\u0001\n2\n(11)\n\u2212 2\u03b12,2 Ld L2q id i2q + O(|\u03b1i,j | )\n\u03c6q = Lq iq \u2212 2\u03b11,2 Ld Lq id iq \u2212 2\u03b12,2 L2d Lq i2d iq\n\u0001\n2\n\u2212 4\u03b10,4 L3q i3q + O(|\u03b1i,j | ).\n\n(12)\n\nFinally,\n\nLdd (id , iq ) =\nLdq (id , iq ) =\nLqq (id , iq ) =\nIII. A\n\n\u0001\n\nLd 1 \u2212 6\u03b13,0 Ld id \u2212 12\u03b14,0 L2d i2d \u2212 2\u03b12,2 L2q i2q\nLqd (id , iq ) = \u22122LdL2q iq (\u03b11,2 + 2\u03b12,2 Ld id )\n\u0001\nLq 1 \u2212 2\u03b11,2 Ld id \u2212 2\u03b12,2 L2d i2d \u2212 12\u03b10,4 L2q i2q .\n\nPROCEDURE FOR ESTIMATING THE MAGNETIC\nPARAMETERS\n\nA. Principle\nTo estimate the 7 magnetic parameters in the model, we\npropose a procedure which is rather easy to implement and\n\nFig. 2.\n\nExperimental illustration of equation (15): time response of id\n\nreliable. With the rotor locked in the position \u03b8 = 0, we inject\nfast-varying pulsating voltages\nud (t) = \u016bd + u\ned f (\u03a9t)\nuq (t) = \u016bq + u\neq f (\u03a9t),\n\n(13)\n(14)\n\nid (t) = \u012bd + eid F (\u03a9t) + O( \u03a912 )\niq (t) = \u012bq + eiq F (\u03a9t) + O( 12 ),\n\n(15)\n\nwhere \u016bd , \u016bq , u\ned , u\neq , \u03a9 are constant and f is a periodic function with zero mean. The pulsation \u03a9 is chosen large enough\nw.r.t. the motor electric time constant. It can then be shown,\nsee section III-C, that after an initial transient\n\n\u03a9\n\n(16)\n\n\u016b\nwhere \u012bd = \u016bRd , \u012bq = Rq , eid , eiq are constant and F is the\nprimitive of f with zero mean (F has clearly the same period\nas f ); fig. 2 shows for instance the current id obtained for\nthe SPM of section IV when starting from id (0) = 0 and\napplying a square signal ud with \u03a9 = 500Hz, \u016bd = 23V\nand u\ned = 30V . On the other hand using the saturation model\nthe amplitudes eid , eiq of the current ripples turn out to be\n\u0010e\nd\neid = 1 u\n+ 2\u03b12,2 Lq \u012bq (2Ld \u012bd u\neq + Lq \u012bq u\ned )\n\u03a9 Ld\n\u0011\n+ 12\u03b14,0 L2d \u012b2d u\ned + 6\u03b13,0 Ld \u012bd u\ned + 2\u03b11,2 Lq \u012bq u\neq (17)\n\u0010e\nq\neiq = 1 u\n+ 2\u03b12,2 Ld \u012bd (2Lq \u012bq u\ned + Ld \u012bd u\neq )\n\u03a9 Lq\n\u0011\n+ 12\u03b10,4 L2q \u012b2q u\neq + 2\u03b11,2 (Ld \u012bd u\neq + Lq \u012bq u\ned ) .\n(18)\n\nAs eid , eiq can easily be measured experimentally, these expressions provide a means to identify the magnetic parameters from experimental data obtained with various values\nof \u016bd , \u016bq , u\ned , u\neq .\nB. Estimation of the parameters\n\nSince combinations of the magnetic parameters always\nenter (17)-(18) linearly, they can be estimated by simple linear\nleast squares; moreover by suitably choosing \u016bd , \u016bq , u\ned , u\neq ,\nthe whole least squares problem for the 7 parameters can be\nsplit into several problems involving fewer parameters:\n\n\f\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\nwith \u016bd = \u016bq = 0, hence \u012bd = \u012bq = 0, and u\ned = 0\n(resp. u\neq = 0) equation (17) (resp. equation (18)) reads\n\u0010\ned\neq \u0011\n1u\n1u\nLd =\nresp. Lq =\n(19)\n\u03a9 eid\n\u03a9 eiq\n\nPlugging (27)-(28) with t =\nalong powers of \u03a91 then yields\n\n\u03c4\n\u03a9\n\ninto (7)-(8), and expanding\n\nwith \u016bq = 0, hence \u012bq = 0, and u\neq = 0, (17) reads\n\u0013\n\u0012\n1\ned\n2 2\neid = u\n(20)\n+ 6\u03b13,0 Ld \u012bd + 12\u03b14,0 Ld \u012bd .\n\u03a9 Ld\n\n\u0012\nF (\u03a9t) u\ned\nid (t) = \u012bd +\neq\ned + 2\u03b11,2 \u03c6\u0304q u\n+ 6\u03b13,0 \u03c6\u0304d u\n\u03a9\nLd\n\u0013\neq + \u03c6\u03042q u\ned ) +O( \u03a912 )\ned + 2\u03b12,2 (2\u03c6\u0304d \u03c6\u0304q u\n+ 12\u03b14,0 \u03c6\u03042d u\n\u0012\neq\nF (\u03a9t) u\n+ 2\u03b11,2 (\u03c6\u0304d u\neq + \u03c6\u0304q u\ned )\niq (t) = \u012bq +\n\u03a9\nLq\n\u0013\neq + O( \u03a912 ),\neq ) + 12\u03b10,4 \u03c6\u03042q u\ned + \u03c6\u03042d u\n+ 2\u03b12,2 (2\u03c6\u0304d \u03c6\u0304q u\n\nwith \u016bd = 0, hence \u012bd := 0, and u\ned = 0, (17)-(18) read\n\nwhere \u012bd = id (\u03c6\u0304d , \u03c6\u0304q ) and \u012bq = iq (\u03c6\u0304d , \u03c6\u0304q ) There remains\nto express \u03c6\u0304d , \u03c6\u0304q in function of \u012bd , \u012bq . Rather than exactly\ninverting the nonlinear equations (7)-(8), we take advantage\nof the fact the coefficients \u03b1i,j are experimentally small. At\nfirst order w.r.t. the \u03b1i,j we have \u03c6d = Ld id + O(|\u03b1i,j |) and\n\u03c6q = Lq iq + O(|\u03b1i,j |). Using this in the previous equations\n2\nand neglecting O( \u03a912 ) and O(|\u03b1i,j | ) terms we eventually\nfind (15)-(18). Using directly (11)-(12) yields of course the\nsame result.\n\nNotice (18) reads eiq = 0 hence provides no information\nwith \u016bd = 0, hence \u012bd := 0, and u\neq = 0, (17)-(18) read\n\u0011\ned \u0010 1\neid = u\n(21)\n+ 2\u03b12,2 L2q \u012b2q\n\u03a9 Ld\nud\neiq = 2e\n\u03b11,2 Lq \u012bq\n(22)\n\u03a9\nuq\neid = 2e\n\u03b11,2 Lq \u012bq\n\u03a9\n\u0011\n\u0010\neq 1\neiq = u\n+ 12\u03b10,4 L2q \u012b2q .\n\u03a9 Lq\n\n(23)\n\n(24)\n\nLd (resp. Lq ) is then immediately determined from (19);\n\u03b13,0 and \u03b14,0 are jointly estimated by least squares from (20);\n\u03b12,2 , \u03b11,2 and \u03b10,4 are separately estimated by least squares\nfrom respectively (21), (22)-(23) and (24).\nC. Justification of section III-A\nThe assertions of section III-A can be rigorously justified\nby a straightforward application of second-order averaging\nof differential equations [11, p. 40]. Indeed the electrical\nsubsystem (1)-(2) with locked rotor (i.e. d\u03b8\ndt = 0) and input\nvoltages (13)-(13) reads when setting \u03c4 = \u03a9t\n\u0001\nd\u03c6d\n1\n\u016bd + u\ned f (\u03c4 ) \u2212 Rid (\u03c6d , \u03c6q )\n(25)\n=\nd\u03c4\n\u03a9\n\u0001\nd\u03c6q\n1\n\u016bq + u\neq f (\u03c4 ) \u2212 Riq (\u03c6d , \u03c6q ) .\n(26)\n=\nd\u03c4\n\u03a9\nThis system is in the so-called standard form for averaging,\nwith a right hand-side periodic in \u03c4 and \u03a91 as a small\nparameter. Therefore its solution is given by\nu\ned\nF (\u03c4 ) + O( \u03a912 )\n\u03a9\nu\neq\n\u03c6q (\u03c4 ) = \u03c60q (\u03c4 ) + F (\u03c4 ) + O( \u03a912 ),\n\u03a9\n\n\u03c6d (\u03c4 ) = \u03c60d (\u03c4 ) +\n\n(27)\n(28)\n\nwhere (\u03c60d , \u03c60q ) is the solution of the system\n\nd\u03c60d\n= \u016bd \u2212 Rid (\u03c60d , \u03c60q )\ndt\nd\u03c60q\n= \u016bq \u2212 Riq (\u03c60d , \u03c60q )\ndt\nobtained by averaging the right-hand\nside of (25)-(26). After\n\u0001\nan initial transient \u03c60d (\u03c4 ), \u03c60q (\u03c4 ) asymptotically reaches the\nconstant value (\u03c6\u0304d , \u03c6\u0304q ) determined by \u016bd = Rid (\u03c6\u0304d , \u03c6\u0304q ) and\n\u016bq = Riq (\u03c6\u0304d , \u03c6\u0304q ).\n\nIV. E XPERIMENTAL R ESULTS\nA. Experimental setup\nThe methodology of section III is tested on an interior\nmagnet PMSM (IPM) and a surface-mounted PMSM (SPM)\nwith rated parameters listed below. The setup consists of an\nindustrial inverter with a 400V DC bus and a 4kHz PWM\nswitching frequency, 3 dSpace boards (DS1005 PPC Board,\nDS2003 A/D Board, DS4002 Timing and Digital I/O Board)\nand a host PC. The measurements were sampled also at 4kHz.\nPole pairs\nRated power\nRated current\nRated speed\nRated torque\nResistance\n\nIPM\n6\n200 W\n1.2 A\n1800 rpm\n1.06 N.m\n12.15 \u03a9\n\nSPM\n2\n1200 W\n3.4 A\n400 rpm\n29 N.m\n6.69 \u03a9\n\nB. Experimental results\nWith the rotor locked in the position \u03b8 = 0, a square wave\nvoltage with frequency \u03a9 = 500Hz and constant amplitude\nu\ned or u\neq (30V for the IPM, 40V for the SPM) is applied\nto the motor. But for the determination of Ld , Lq where\n\u016bd = \u016bq = 0, several runs are performed with various \u016bd\n(resp. \u016bq ) such that \u012bd (resp. \u012bq ) ranges from \u22122A to +2A\nwith a 0.3A increment (IPM), or from \u22128A to 8A with a\n0.5A increment (SPM). The estimated parameters are listed\nbelow; the uncertainty in the estimation stems from a \u00b110mA\nuncertainty in the current measurements.\n\n\fFig. 3.\n\n(a) IPM\n\n(a) IPM\n\n(b) SPM\n\n(b) SPM\n\nMeasured values (circles) and fitted curve (solid line) for (20).\n\nLd (mH)\nLq (mH)\n\u03b13,0 (A.W b\u22122 )\n\u03b11,2 (A.W b\u22122 )\n\u03b14,0 (A.W b\u22123 )\n\u03b12,2 (A.W b\u22123 )\n\u03b10,4 (A.W b\u22123 )\n\nIPM\n91.9 \u00b1 5\n45.8 \u00b1 1\n7.70 \u00b1 0.11\n5.35 \u00b1 0.61\n19.42 \u00b1 1.34\n22.18 \u00b1 2.80\n6.62 \u00b1 0.42\n\nSPM\n155.4 \u00b1 10\n58.6 \u00b1 2\n5.01 \u00b1 0.11\n4.83 \u00b1 0.27\n1.83 \u00b1 0.28\n8.76 \u00b1 1.03\n1.18 \u00b1 0.17\n\nThe good agreement between the fitted curves and the\nmeasurements is demonstrated for instance for (20) on Fig. 3\nand for (22) on Fig. 4. Notice (20) illustrates saturation on a\nsingle axis, while (22) illustrates cross-saturation.\nC. Validation\nThe estimation procedure relies on (20)\u2013(24), with either\n\u012bd 6= or , i.e. current vectors with angles 0\u25e6 , 90\u25e6 , 180\u25e6 , 270\u25e6.\nTo check the validity of the model tests were conducted with\ncurrent vectors with various angles and magnitudes on the\n\nFig. 4.\n\nMeasured values (circles) and fitted curve (solid line) for (22).\n\nq\nwhole operating (|i| = i2d + i2q ranging from 0A to 2A with a\n0.3A increment for the IPM, and from 0A to 5.5A with a 0.5A\nincrement for the SPM). Fig. 5 shows for instance the results\nfor a 60\u25e6 current angle; there is a good agreement between\nthe measured values and those predicted by the model.\nAs a kind of cross-validation we also examined the currents\ntime responses to large voltage steps. Fig. 6 shows the good\nagreement between the measurements and the time response\nobtained by simulating the model with the estimated parameters; it also shows the differences with the simulated response\nwhen the saturation effects are omitted. Fig. 7 shows the\ngood agreement also between the \"measured\" flux values (i.e.\nobtained by integrating the measured currents and voltages)\nand the flux values obtained by simulation.\nV. C ONCLUSION\nA simple parametric magnetic saturation model for the\nPMSM with a simple identification procedure based on high-\n\n\fFig. 6.\n\nTime response of id to large step voltages in ud (IPM).\n\n(a) Interior-magnet PMSM\n\nFig. 7.\n\n(b) Surface mounted PMSM\n\n[5]\n\nFig. 5. Measured values (circles) compared to model-predicted values (solid\nline) for a 60\u25e6 current angle.\n[6]\n\nfrequency voltage injection have been introduced. Experimental tests on two kinds of PMSM (IPM and SPM) demonstrate\nthe relevance of the approach. This model can be fruitfully\nused to design a sensorless control scheme at low velocity.\n\n[7]\n\n[8]\n\nR EFERENCES\n[1] J. H. Jang, S. K. Sul, J. I. Ha, K. Ide, and M. Sawamura, \"Sensorless\ndrive of surface-mounted permanent-magnet motor by high-frequency\nsignal injection based on magnetic saliency,\" IEEE T. Ind. Appl., vol. 39,\nno. 4, pp. 1031\u20131039, 2003.\n[2] M. J. Corley and R. D. Lorenz, \"Rotor position and velocity estimation\nfor a salient-pole permanent magnet synchronous machine at standstill\nand high speeds,\" IEEE T. Ind. Appl., vol. 34, no. 4, pp. 784\u2013789, 1998.\n[3] P. Guglielmi, M. Pastorelli, and A. Vagati, \"Cross-saturation effects in\nIPM motors and related impact on sensorless control,\" IEEE T. Ind.\nAppl., vol. 42, no. 6, pp. 1516\u20131522, 2006.\n[4] N. Bianchi, S. Bolognani, and A. Faggion, \"Predicted and measured\nerrors in estimating rotor position by signal injection for salient-pole\n\n[9]\n[10]\n\n[11]\n\nSaturation curve \u03c6d \u2212 id (IPM).\n\nPM synchronous motors,\" in IEEE Int. Electric Machines and Drives\nConf., 2009, pp. 1565\u20131572.\nB. \u0160tumberger, G. \u0160tumberger, D. Dolinar, A. Hamler, and M. Trlep,\n\"Evaluation of saturation and cross-magnetization effects in interior\npermanent-magnet synchronous motor,\" IEEE T. Ind. Appl., vol. 39,\nno. 5, pp. 1264\u20131271, 2003.\nG. \u0160tumberger, B. Polajzer, B. \u0160tumberger, M. Toman, and D. Dolinar,\n\"Evaluation of experimental methods for determining the magnetically\nnonlinear characteristics of electromagnetic devices,\" IEEE T. Magnetics, vol. 41, no. 10, pp. 4030\u20134032, 2005.\nZ. Zhu, Y. Li, D. Howe, and C. Bingham, \"Compensation for rotor\nposition estimation error due to cross-coupling magnetic saturation in\nsignal injection based sensorless control of PM brushless AC motors,\"\nin IEEE Int. Electric Machines Drives Conf., vol. 1, 2007, pp. 208\u2013213.\nP. Guglielmi, M. Pastorelli, G. Pellegrino, and A. Vagati, \"Positionsensorless control of permanent-magnet-assisted synchronous reluctance\nmotor,\" IEEE T. Ind. Appl., vol. 40, no. 2, pp. 615\u2013622, 2004.\nD. Basic, F. Malrait, and P. Rouchon, \"Euler-Lagrange models with\ncomplex currents of three-phase electrical machines and observability\nissues,\" IEEE T. Automat. Contr., vol. 55, no. 1, pp. 212\u2013217, 2010.\nD. Basic, A. K. Jebai, F. Malrait, P. Martin, and P. Rouchon, \"Using\nHamiltonians to model saturation in space vector representations of\nAC electrical machines,\" in Advances in the theory of control, signals\nand systems with physical modeling, ser. Lecture Notes in Control and\nInformation Sciences, J. L\u00e9vine and P. M\u00fcllhaupt, Eds. Springer, 2011,\npp. 41\u201348.\nJ. A. Sanders, F. Verhulst, and J. Murdock, Averaging methods in nonlinear dynamical systems, 2nd ed., ser. Applied Mathematical Sciences.\nSpringer, 2007, no. 59.\n\n\f\f"}