{"id": "http://arxiv.org/abs/math-ph/0508067v3", "guidislink": true, "updated": "2006-02-14T16:22:07Z", "updated_parsed": [2006, 2, 14, 16, 22, 7, 1, 45, 0], "published": "2005-08-31T15:12:19Z", "published_parsed": [2005, 8, 31, 15, 12, 19, 2, 243, 0], "title": "On the average principle for one-frequency systems", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math-ph%2F0508040%2Cmath-ph%2F0508030%2Cmath-ph%2F0508034%2Cmath-ph%2F0508009%2Cmath-ph%2F0508059%2Cmath-ph%2F0508016%2Cmath-ph%2F0508051%2Cmath-ph%2F0508058%2Cmath-ph%2F0508005%2Cmath-ph%2F0508022%2Cmath-ph%2F0508056%2Cmath-ph%2F0508044%2Cmath-ph%2F0508049%2Cmath-ph%2F0508027%2Cmath-ph%2F0508060%2Cmath-ph%2F0508035%2Cmath-ph%2F0508011%2Cmath-ph%2F0508007%2Cmath-ph%2F0508029%2Cmath-ph%2F0508012%2Cmath-ph%2F0508018%2Cmath-ph%2F0508021%2Cmath-ph%2F0508067%2Cmath-ph%2F0508065%2Cmath-ph%2F0508041%2Cmath-ph%2F0508063%2Cmath-ph%2F0508068%2Cmath-ph%2F0508026%2Cmath-ph%2F0508037%2Cmath-ph%2F0508053%2Cmath-ph%2F0508047%2Cmath-ph%2F0508045%2Cmath-ph%2F0508019%2Cmath-ph%2F0508003%2Cmath-ph%2F0508042%2Cmath-ph%2F0508013%2Cmath-ph%2F0508006%2Cmath-ph%2F0508066%2Cmath-ph%2F0603032%2Cmath-ph%2F0603059%2Cmath-ph%2F0603066%2Cmath-ph%2F0603058%2Cmath-ph%2F0603024%2Cmath-ph%2F0603031%2Cmath-ph%2F0603041%2Cmath-ph%2F0603017%2Cmath-ph%2F0603014%2Cmath-ph%2F0603037%2Cmath-ph%2F0603009%2Cmath-ph%2F0603043%2Cmath-ph%2F0603079%2Cmath-ph%2F0603057%2Cmath-ph%2F0603053%2Cmath-ph%2F0603038%2Cmath-ph%2F0603028%2Cmath-ph%2F0603060%2Cmath-ph%2F0603016%2Cmath-ph%2F0603074%2Cmath-ph%2F0603052%2Cmath-ph%2F0603013%2Cmath-ph%2F0603078%2Cmath-ph%2F0603034%2Cmath-ph%2F0603073%2Cmath-ph%2F0603063%2Cmath-ph%2F0603070%2Cmath-ph%2F0603022%2Cmath-ph%2F0603042%2Cmath-ph%2F0603054%2Cmath-ph%2F0603001%2Cmath-ph%2F0603015%2Cmath-ph%2F0603011%2Cmath-ph%2F0603049%2Cmath-ph%2F0603048%2Cmath-ph%2F0603076%2Cmath-ph%2F0603077%2Cmath-ph%2F0603080%2Cmath-ph%2F0603056%2Cmath-ph%2F0603046%2Cmath-ph%2F0603026%2Cmath-ph%2F0603084%2Cmath-ph%2F0603081%2Cmath-ph%2F0603068%2Cmath-ph%2F0603051%2Cmath-ph%2F0603012%2Cmath-ph%2F0603019%2Cmath-ph%2F0603035%2Cmath-ph%2F0603006%2Cmath-ph%2F0603083%2Cmath-ph%2F0603003%2Cmath-ph%2F0603029%2Cmath-ph%2F0603027%2Cmath-ph%2F0603018%2Cmath-ph%2F0603036%2Cmath-ph%2F0603025%2Cmath-ph%2F0603047%2Cmath-ph%2F0603021%2Cmath-ph%2F0603067%2Cmath-ph%2F0603007%2Cmath-ph%2F0603065%2Cmath-ph%2F0603030%2Cmath-ph%2F0603020&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the average principle for one-frequency systems"}, "summary": "We consider a perturbed integrable system with one frequency, and the\napproximate dynamics for the actions given by averaging over the angle. The\nclassical theory grants that, for a perturbation of order epsilon, the error of\nthis approximation is O(epsilon) on a time scale O(1/epsilon), for epsilon ->\n0. We replace this qualitative statement with a fully quantitative estimate; in\ncertain cases, our approach also gives a reliable error estimate on time scales\nlarger than 1/epsilon. A number of examples are presented; in many cases our\nestimator practically coincides with the envelope of the rapidly oscillating\ndistance between the actions of the perturbed and of the averaged systems.\nFairly good results are also obtained in some \"resonant\" cases, where the\nangular frequency is small along the trajectory of the system. Even though our\nestimates are proved theoretically, their computation in specific applications\ntypically requires the numerical solution of a system of differential\nequations. However, the time scale for this system is smaller by a factor\nepsilon than the time scale for the perturbed system. For this reason,\ncomputation of our estimator is faster than the direct numerical solution of\nthe perturbed system; the estimator is rapidly found also in cases when the\ntime scale makes impossible (within reasonable CPU times) or unreliable the\ndirect solution of the perturbed system.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math-ph%2F0508040%2Cmath-ph%2F0508030%2Cmath-ph%2F0508034%2Cmath-ph%2F0508009%2Cmath-ph%2F0508059%2Cmath-ph%2F0508016%2Cmath-ph%2F0508051%2Cmath-ph%2F0508058%2Cmath-ph%2F0508005%2Cmath-ph%2F0508022%2Cmath-ph%2F0508056%2Cmath-ph%2F0508044%2Cmath-ph%2F0508049%2Cmath-ph%2F0508027%2Cmath-ph%2F0508060%2Cmath-ph%2F0508035%2Cmath-ph%2F0508011%2Cmath-ph%2F0508007%2Cmath-ph%2F0508029%2Cmath-ph%2F0508012%2Cmath-ph%2F0508018%2Cmath-ph%2F0508021%2Cmath-ph%2F0508067%2Cmath-ph%2F0508065%2Cmath-ph%2F0508041%2Cmath-ph%2F0508063%2Cmath-ph%2F0508068%2Cmath-ph%2F0508026%2Cmath-ph%2F0508037%2Cmath-ph%2F0508053%2Cmath-ph%2F0508047%2Cmath-ph%2F0508045%2Cmath-ph%2F0508019%2Cmath-ph%2F0508003%2Cmath-ph%2F0508042%2Cmath-ph%2F0508013%2Cmath-ph%2F0508006%2Cmath-ph%2F0508066%2Cmath-ph%2F0603032%2Cmath-ph%2F0603059%2Cmath-ph%2F0603066%2Cmath-ph%2F0603058%2Cmath-ph%2F0603024%2Cmath-ph%2F0603031%2Cmath-ph%2F0603041%2Cmath-ph%2F0603017%2Cmath-ph%2F0603014%2Cmath-ph%2F0603037%2Cmath-ph%2F0603009%2Cmath-ph%2F0603043%2Cmath-ph%2F0603079%2Cmath-ph%2F0603057%2Cmath-ph%2F0603053%2Cmath-ph%2F0603038%2Cmath-ph%2F0603028%2Cmath-ph%2F0603060%2Cmath-ph%2F0603016%2Cmath-ph%2F0603074%2Cmath-ph%2F0603052%2Cmath-ph%2F0603013%2Cmath-ph%2F0603078%2Cmath-ph%2F0603034%2Cmath-ph%2F0603073%2Cmath-ph%2F0603063%2Cmath-ph%2F0603070%2Cmath-ph%2F0603022%2Cmath-ph%2F0603042%2Cmath-ph%2F0603054%2Cmath-ph%2F0603001%2Cmath-ph%2F0603015%2Cmath-ph%2F0603011%2Cmath-ph%2F0603049%2Cmath-ph%2F0603048%2Cmath-ph%2F0603076%2Cmath-ph%2F0603077%2Cmath-ph%2F0603080%2Cmath-ph%2F0603056%2Cmath-ph%2F0603046%2Cmath-ph%2F0603026%2Cmath-ph%2F0603084%2Cmath-ph%2F0603081%2Cmath-ph%2F0603068%2Cmath-ph%2F0603051%2Cmath-ph%2F0603012%2Cmath-ph%2F0603019%2Cmath-ph%2F0603035%2Cmath-ph%2F0603006%2Cmath-ph%2F0603083%2Cmath-ph%2F0603003%2Cmath-ph%2F0603029%2Cmath-ph%2F0603027%2Cmath-ph%2F0603018%2Cmath-ph%2F0603036%2Cmath-ph%2F0603025%2Cmath-ph%2F0603047%2Cmath-ph%2F0603021%2Cmath-ph%2F0603067%2Cmath-ph%2F0603007%2Cmath-ph%2F0603065%2Cmath-ph%2F0603030%2Cmath-ph%2F0603020&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We consider a perturbed integrable system with one frequency, and the\napproximate dynamics for the actions given by averaging over the angle. The\nclassical theory grants that, for a perturbation of order epsilon, the error of\nthis approximation is O(epsilon) on a time scale O(1/epsilon), for epsilon ->\n0. We replace this qualitative statement with a fully quantitative estimate; in\ncertain cases, our approach also gives a reliable error estimate on time scales\nlarger than 1/epsilon. A number of examples are presented; in many cases our\nestimator practically coincides with the envelope of the rapidly oscillating\ndistance between the actions of the perturbed and of the averaged systems.\nFairly good results are also obtained in some \"resonant\" cases, where the\nangular frequency is small along the trajectory of the system. Even though our\nestimates are proved theoretically, their computation in specific applications\ntypically requires the numerical solution of a system of differential\nequations. However, the time scale for this system is smaller by a factor\nepsilon than the time scale for the perturbed system. For this reason,\ncomputation of our estimator is faster than the direct numerical solution of\nthe perturbed system; the estimator is rapidly found also in cases when the\ntime scale makes impossible (within reasonable CPU times) or unreliable the\ndirect solution of the perturbed system."}, "authors": ["Carlo Morosi", "Livio Pizzocchero"], "author_detail": {"name": "Livio Pizzocchero"}, "author": "Livio Pizzocchero", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1088/0305-4470/39/14/012", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/math-ph/0508067v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math-ph/0508067v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "LaTeX, 37 pages, 18 figures. Some style rearrangements. To appear in\n  J.Phys.A", "arxiv_primary_category": {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "nlin.SI", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "70K65, 70K70, 34C29, 70H09, 37J40", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math-ph/0508067v3", "affiliation": "Universita' di Milano", "arxiv_url": "http://arxiv.org/abs/math-ph/0508067v3", "journal_reference": "J.Phys.A: Math.Gen. 39 (2006), 3673-3702", "doi": "10.1088/0305-4470/39/14/012", "fulltext": "arXiv:math-ph/0508067v3 14 Feb 2006\n\nOn the average principle\nfor one-frequency systems.\nCarlo Morosi1, Livio Pizzocchero2\n1\n\nDipartimento di Matematica, Politecnico di Milano,\nP.za L. da Vinci 32, I-20133 Milano, Italy\ne\u2013mail: carmor@mate.polimi.it\n2\nDipartimento di Matematica, Universit\u00e0 di Milano\nVia C. Saldini 50, I-20133 Milano, Italy\nand Istituto Nazionale di Fisica Nucleare, Sezione di Milano, Italy\ne\u2013mail: livio.pizzocchero@mat.unimi.it\n\nAbstract\nWe consider a perturbed integrable system with one frequency, and the\napproximate dynamics for the actions given by averaging over the angle. A\nclassical qualitative result states that, for a perturbation of order \u03b5, the error\nof this approximation is O(\u03b5) on a time scale O(1/\u03b5), for \u03b5 \u2192 0. We replace\nthis with a fully quantitative estimate; in certain cases, our approach also\ngives a reliable error estimate on time scales larger than 1/\u03b5. A number\nof examples are presented; in many cases, our estimator practically coincides\nwith the envelope of the rapidly oscillating distance between the actions of the\nperturbed and of the averaged systems. Fairly good results are also obtained\nin some \"resonant\" cases, where the angular frequency is small along the\ntrajectory of the system.\nEven though our estimates are proved theoretically, their computation in specific applications typically requires the numerical solution of a system of differential equations. However, the time scale for this system is smaller by a\nfactor \u03b5 than the time scale for the perturbed system. For this reason, computation of our estimator is faster than the direct numerical solution of the\nperturbed system; the estimator is rapidly found also in cases when the time\nscale makes impossible (within reasonable CPU times) or unreliable the direct\nsolution of the perturbed system.\n\nKeywords: Slow and fast motions, perturbations, averaging method.\nAMS 2000 Subject classification: 70K65, 70K70, 34C29, 70H09, 37J40.\n\n\f1\n\nIntroduction.\n\nThe averaging method is a classical tool to analyse dynamical systems with fast\nangular variables: the idea is to average over the angles, to obtain an approximate\nevolution law for the slow variables (from now on, called the actions). Many applications are physically relevant; so, error estimates for this technique on long time\nscales have an obvious interest.\nConcerning these estimates, the case of one angle is the simplest one due to the\nstructure of its \"resonances\", which are produced only by the vanishing of the angular frequency. However, this one-frequency case covers non trivial situations: for\nexample, it includes the perturbed Kepler problem, appearing in applications such\nas the dynamics of a satellite around an oblate planet and/or in presence of dragging\n(see [7] and references therein).\nThe classical theory for the one-frequency case states that, under a perturbation O(\u03b5)\nof a dynamical system with one angle and many actions, the difference between the\nactions of the perturbed and of the averaged systems is O(\u03b5) on a time scale O(1/\u03b5),\nfor \u03b5 \u2192 0: see [1] [2] [3] [4] [7] (the two last references are also useful for general\nhistorical and bibliographical information). This is a qualitative result; the n-th\norder extensions of the averaging method proposed in the literature [4] are usually\ntreated at the same qualitative level, the conclusion being that some reminder term\nis O(\u03b5n ) on a time scale O(1/\u03b5). To get these O(\u03b5) or O(\u03b5n ) bounds, one generally\nwrites a number of quite rough majorizations, often containing unspecified constants\nbut sufficient to obtain a linear integral inequality for the reminder; the latter is used\nto obtain the wanted bounds through the Gronwall Lemma.\nOf course, the previously mentioned results are not fully satisfactory if one aims to\nobtain precise numerical values from the error analysis; the situation is especially\nuncomfortable near resonances, i.e., when the time evolution carries the system close\nto a zero of the angular frequency.\nIn this paper we show that working carefully, and avoiding unnecessary simplifications, it is possible to derive fully quantitative and precise error estimates for the\nstandard (n = 1) averaging method, for a (small) fixed \u03b5: this requires to solve\na nonlinear integral inequality, or a related differential equation, coupled to a set\nof auxiliary differential equations. In typical cases, this is done numerically; however, the treatment of the above system of equations is much less expensive than\nthe direct numerical solution of the action-angle evolution equations; in fact, to get\ninformation on an interval [0, U/\u03b5) it suffices to solve the previously mentioned set\nof equations on the interval [0, U).\nTo our knowledge, a quantitative error analysis for the averaging method has been\npreviously proposed in [8]; however, in this reference the attention is mainly focused\non specific applications, admitting a simple analytical treatment, rather than on a\ngeneral scheme. In a broader sense, the present paper has some connection with [6];\nin the cited reference, a quantitative analysis has been proposed for a rather general\n1\n\n\fclass of approximation methods for the evolution equations (in abstract Banach\nspaces, so to include the case of evolutionary PDEs).\n1A. A precise setting of the problem. Let us be given an open set \u039b of Rd\n(the space of the actions) and the one-dimensional torus T:\n\u039b = {I = (I i )i=1,...,d} \u2282 Rd ,\n\nT := R/(2\u03c0Z) = {\u03b8} .\n\n(1.1)\n\nWe fix some initial data\nI0 \u2208 \u039b ,\n\n\u03b80 \u2208 T\n\nand consider the perturbed one-frequency system\n\u001a\ndI/dt = \u03b5f (I, \u0398) ,\nd\u0398/dt = \u03c9(I) + \u03b5g(I, \u0398) ,\n\n(1.2)\n\nI(0) = I0 ,\n\u0398(0) = \u03b80\n\n(1.3)\n\nfor two unknown functions I : t 7\u2192 I(t) \u2208 \u039b, \u0398 : t 7\u2192 \u0398(t) \u2208 T. This Cauchy\nproblem contains the unperturbed frequency\n\u03c9 \u2208 C m (\u039b, R) ,\n\n\u03c9(I) 6= 0 for all I \u2208 \u039b ;\n\n(1.4)\n\nthe perturbation is governed by a parameter \u03b5 > 0, and by two functions\nf = (f i )i=1,...,d \u2208 C m (\u039b \u00d7 T, Rd ),\n\ng \u2208 C m (\u039b \u00d7 T, R),\n\n(1.5)\n\n(I, \u03b8) 7\u2192 f (I, \u03b8), g(I, \u03b8) ;\n\nthroughout the paper, for technical reasons it is assumed that m > 2.\nFrom now on \"the solution (I, \u0398) of (1.3)\" means the maximal solution in the future,\ni.e., the one with the largest domain of the form [0, T ), T \u2208 (0, +\u221e] (of course, this\ndomain generally depends on the initial data). Any expression like \"the solution\n(I, \u0398) exists on D\" means that D is a subset of [0, T ). It is hardly the case to\nobserve that I, \u0398 are C m+1 functions.\nThe averaged system associated to (1.3) is the Cauchy problem\ndJ\n= f (J) ,\nd\u03c4\nm\n\nd\n\nf = (f i ) \u2208 C (\u039b, R ) ,\n\nJ(0) = I0 ,\n1\nI\u2192\n7 f (I) :=\n2\u03c0\n\n(1.6)\nZ\n\nd\u03b8 f (I, \u03b8) ;\nT\n\nthe unknown is a function J : \u03c4 7\u2192 J(\u03c4 ) \u2208 \u039b. In the same language as before, we\nstipulate that \"the solution J of (1.6)\" means the maximal one in the future; again,\nwe have a C m+1 function.\nThe system (1.6) will be compared with (1.3) for \u03c4 = \u03b5t, i.e., interpreting \u03c4 as a\nrescaled time; if (I, \u0398) is the solution of (1.3) and J is the solution of (1.6) with the\nsame datum I0 as in (1.3), the aim is to evaluate the difference t 7\u2192 I(t) \u2212 J(\u03b5t).\n2\n\n\fThe classical result on this subject is an estimate\n|I(t) \u2212 J(\u03b5 t)| 6 C\u03b5\n\nfor t \u2208 [0, 1/\u03b5) ,\n\n(1.7)\n\nholding for all sufficiently small \u03b5, under suitable technical conditions (especially,\na lower bound |\u03c9(I)| > c > 0 on a convenient domain); in the above, C is a\nconstant independent of \u03b5. In principle, one could obtain for C a (very complicated)\nexpression, for example evaluating all the constants in the derivation of (1.7) by [1];\nhowever, the explicit bound obtained in this way is not satisfactory, since in typical\nexamples it largely overestimates the difference I(t) \u2212 J(\u03b5t) .\n1B. Contents of the paper. Throughout the paper, the parameter \u03b5 is fixed\nin (0, +\u221e); of course, our statements are interesting mainly if \u03b5 is small (and are\naccompanied by comments which assume this). Our aim is to perform an accurate\nanalysis of the distance between I and J; this will ultimately yield a bound\n|I(t) \u2212 J(\u03b5t)| 6 \u03b5 n(\u03b5t)\n\nfor t \u2208 [0, U/\u03b5) ,\n\n(1.8)\n\nwhere n : \u03c4 7\u2192 n(\u03c4 ) fulfils an integral inequality, or a related differential equation,\nfor \u03c4 within an interval [0, U). (As we will show, the existence of J, n and some more\nauxiliary functions for \u03c4 \u2208 [0, U) grants the existence of the solution (I, \u0398) of (1.3)\nfor t \u2208 [0, U/\u03b5)).\nTypically, the estimator n must be computed solving numerically the above mentioned differential equation; however, this is much less expensive than the numerical\nsolution of (1.3), because n depends on the \"slow\" time variable \u03c4 = \u03b5t and thus\nmust be determined on an interval of length U to get an estimate for t \u2208 [0, U/\u03b5)\n(these considerations can be extended to all the auxiliary functions required in this\napproach). In the examples we will present, the function t 7\u2192 \u03b5n(\u03b5t) obtained\nin this way often coincides with the \"envelope\" of the rapidly oscillating function\nt 7\u2192 |I(t) \u2212 J(\u03b5t)|, giving practically the best possible bound of the form (1.8). Our\nbound turns out to be fairly good also in some resonant cases (where \u03c9 vanishes\nat the boundary of \u039b and the actions are close to it, either initially or over long\ntimes). As expected, in each example the CPU time for the computation of n is\nmuch shorter than the CPU time for the direct solution of (1.3).\nIf U \u2243 1, Eq. (1.8) can be regarded as a quantitative formulation of the classical\ntheory, involving the time scales 1 and 1/\u03b5. However, in certain cases our approach\nworks as well for U \u226b 1, yielding accurate estimates for|I(t)\u2212J(\u03b5t)| on the extremely\nlarge interval [0, U/\u03b5); one can even jump to the time scales U \u2243 1/\u03b5, U/\u03b5 \u2243 1/\u03b52.\nThe general setting of our approach is described in Section 2, where we use systematically the function\n1\nt 7\u2192 L(t) := [I(t) \u2212 J(\u03b5t)] .\n(1.9)\n\u03b5\nAfter introducing a set of auxiliary functions and differential equations, in Lemma\n2.1 we obtain an exact integral equation for L; then, in Proposition 2.4 we derive an\n3\n\n\fintegral inequality and show that any solution \u03c4 7\u2192 n(\u03c4 ) of this inequality gives a\nbound |L(t)| < n(\u03b5t). For practical purposes, it is convenient to relate the integral\ninequality for n to a differential equation, which is the subject of Proposition 2.5;\nthe solution n of the differential equation gives a bound |L(t)| 6 n(\u03b5t), which is\nequivalent to Eq.(1.8).\nThe subsequent Section 3 summarizes the path to n, and discusses tests for the\nefficiency of this estimator. The final Section 4 is devoted to the examples: we\nmention, in particular, the van der Pol equation, a resonant case inspired by Arnold,\nand Euler's equations for a rigid body under a damping moment linear in the angular\nvelocity (which also manifest a resonance).\nTo simplify our exposition, many technical aspects are treated in the Appendices.\nIn particular: Appendices A, B and C contain the proofs of Lemmas 2.1, 2.3 and\nProposition 2.5, respectively; Appendices D and E illustrate the computation of\nsome auxiliary functions required by the examples of Section 4.\nThe examples presented in this paper are relatively simple, since their purpose is\nmainly to test the effectiveness of the method. We postpone to later works (now\nin progress) the treatment of slightly harder applications, in particular the already\nmentioned satellite dynamics.\n\n2\n\nMain results.\n\n2A. Some notations. i) Vectors of Rd are written with upper indices: X =\n(X i )i=1,...,d . We use the spaces Tpq (Rd ) of (p, q)-tensors over Rd , especially for\n(p, q) = (1, 1), (2, 0) and (1, 2); tensors of these three types are represented as families\ni\n) (i, j, k = 1, ..., d).\nof real coefficients A = (Aji ), B = (B ij ), C = (Cjk\nd\n1\nd\n2\nd\nLet X, Y \u2208 R , A , D \u2208 T1 (R ), B \u2208 T0 (R ), C \u2208 T12 (Rd ). We define the products\nXY \u2208 T20 (Rd ), A X \u2208 Rd , A D \u2208 T11 (Rd ), C X \u2208 T11 (Rd ), C B \u2208 Rd by\n(XY )ij := X i Y j ,\n\n(A X)i := Aki X k ,\n\n(A D)ij := Aki Djk ,\n\n(2.1)\n\ni\n(C B)i := Ckl\nB kl\n\ni\nXk ,\n(C X)il = Ckl\n\n(with the Einstein's summation convention over repeated indices; XX will be written\nX 2 ). We note that A D is the ordinary product of A and D as matrices; 1d , A \u22121\n\u2208 T11 (Rd ) will denote the identity matrix, and the inverse matrix of A . The vector\n(C X)Y = C (XY ) will be written C XY .\nAll the considered tensor spaces can be equipped with an inner product \u2022 and\nwith the corresponding Euclidean norm | |. If X, Y \u2208 Rd , A , D \u2208 T11 (Rd ) and\nC , E \u2208 T12 (Rd ),\nX \u2022 Y :=\n\nd\nX\ni=1\n\ni\n\ni\n\nXY ,\n\nA \u2022D =\n\nd\nX\n\nAji\n\ni,j=1\n\nDji\n\n,\n\nC \u2022 E :=\n\nd\nX\n\ni,j,k=1\n\n4\n\ni\ni\n,\nEjk\nCjk\n\n(2.2)\n\n\f|X| :=\n\n\u221a\n\nX \u2022X ,\n\n|A | :=\n\n\u221a\n\nA \u2022A ,\n\n|C | :=\n\n\u221a\n\nC \u2022C .\n\nii) Recalling that \u039b \u2282 Rd is open, let h : \u039b \u2192 Rd be C l . If l > 1 or l > 2,\nrespectively, the Jacobian and the Hessian of h at a point I are\n\u0012 i \u0013\n\u0012 2 i\n\u0013\n\u22022h\n\u2202h\n\u2202h\n\u2202 h\n1\nd\n(I) :=\n(I) \u2208 T1 (R ) ;\n(I) :=\n(I) \u2208 T12 (Rd ) . (2.3)\n\u2202I\n\u2202I j\n\u2202I 2\n\u2202I j \u2202I k\nLet us introduce the set (open in Rd \u00d7 Rd ).\n\u039b\u2020 := {(I, \u03b4I) \u2208 \u039b \u00d7 Rd | [I, I + \u03b4I] \u2208 \u039b}\n\n(2.4)\n\n(with [I, I + \u03b4I] denoting the segment of Rd with the indicated extremes. For h as\nbefore and l > 1 or l > 2, respectively, there are functions G \u2208 C l\u22121 (\u039b\u2020 , T11 (Rd ))\nand H \u2208 C l\u22122 (\u039b\u2020 , T12 (Rd )) such that\nh(I + \u03b4I) = h(I) + G (I, \u03b4I)\u03b4I ,\n\n(2.5)\n\n\u2202h\n1\n(I)\u03b4I + H (I, \u03b4I)\u03b4I 2 ,\nHjki (I, \u03b4I) = Hkji (I, \u03b4I) . (2.6)\n\u2202I\n2\nIf d = 1, the above equations can be solved for G , H and determine them uniquely.\nIf d > 1, the above equations for G , H have many solutions; in any dimension,\nexplicit solutions are given by the integral formulas\nZ 1\nZ 1\n\u22022h\n\u2202h\n(I\n+\nx\u03b4I)\n,\nH\n(I,\n\u03b4I)\n:=\n2\n(I + x\u03b4I) (2.7)\ndx(1\n\u2212\nx)\nG (I, \u03b4I) :=\ndx\n\u2202I\n\u2202I 2\n0\n0\nh(I + \u03b4I) = h(I) +\n\n(for h of polynomial or rational type, G and H can be obtained more directly from\nthe expression of h(I + \u03b4I)).\nIn an obvious way, for a function h : \u039b \u00d7 T \u2192 Rd , we can define the derivatives\n(\u2202h/\u2202I )(I, \u03b8) \u2208 T11 (Rd ), (\u2202h/\u2202\u03b8)(I, \u03b8) \u2208 Rd , (\u2202 2 h/\u2202I 2 )(I, \u03b8) \u2208 T12 (Rd ) .\n\niii) The average of aR C l function h : \u039b \u00d7 T \u2192 Rd is the C l function h : \u039b \u2192 Rd ,\nI 7\u2192 h(I) := 1/(2\u03c0) T d\u03b8 h(I, \u03b8); this notation has been already used in Eq. (1.6),\nwith h = f .\n2B. The main Lemma: an integral equation for L. We consider the perturbed\nand averaged systems (1.3) (1.6), for fixed \u03b5 > 0 and initial data I0 , \u03b80 .\nThe integral equation we are going to derive will be the basic identity yielding our\nestimates on |L(t)|; it involves a number of auxiliary functions, to be introduced as\nthe construction goes on.\nFirst of all, s \u2208 C m (\u039b \u00d7 T, Rd ) and p \u2208 C m\u22121 (\u039b \u00d7 T, Rd ) are the functions such\nthat\n\u2202s\n\u2202s\n\u2202s\n, s=0;\nf+\ng.\n(2.8)\np :=\nf =f +\u03c9\n\u2202\u03b8\n\u2202I\n\u2202\u03b8\n5\n\n\fThe function s, which has a preminent role in estimates on |L|, is defined by (2.8)\nin an implicit way; an explicit formula is (1 )\nZ \u03b8\n1\nz(I, \u03b8) :=\n(2.9)\ns=z\u2212z ,\nd\u03b8\u2032 (f (I, \u03b8\u2032) \u2212 f (I)) .\n\u03c9(I) 0\nAnother function to be used hereafter is the Jacobian\nnow on, U stands for an element of (0, +\u221e].\n\n\u2202f\n\u2208 C m\u22121 (\u039b, T11 (Rd )). From\n\u2202I\n\n2.1 Lemma. Suppose the solution J of (1.6) exists for \u03c4 \u2208 [0, U). Denote with\nR : [0, U) \u2192 T11 (Rd ), \u03c4 7\u2192 R(\u03c4 ) and K : [0, U) \u2192 Rd , \u03c4 7\u2192 K(\u03c4 ) the solutions of\ndR\n\u2202f\n=\n(J) R ,\nd\u03c4\n\u2202I\n\nR(0) = 1d ;\n\n(2.10)\n\ndK\n\u2202f\nK(0) = 0\n(2.11)\n=\n(J) K + p(J) ,\nd\u03c4\n\u2202I\n(these exist and are C m ; R(\u03c4 ) is an invertible matrix for all \u03c4 \u2208 [0, U), and K(\u03c4 ) =\nR\u03c4\nR\u03c4\n\u2202f\nR(\u03c4 ) 0 d\u03c4 \u2032 R(\u03c4 \u2032 )\u22121 p(J(\u03c4 \u2032 )). For d = 1, R(\u03c4 ) = exp 0 d\u03c4 \u2032\n(J(\u03c4 \u2032 )) \u2208 (0, +\u221e)).\n\u2202I\nFurthermore, assume that the solution (I, \u0398) of the perturbed system (1.3) exixts for\nt \u2208 [0, U/\u03b5), with (J(\u03b5t), I(t) \u2212 J(\u03b5t)) \u2208 \u039b\u2020 . Finally, define\nL : [0, U/\u03b5) \u2192 Rd ,\n\nt 7\u2192 L(t) :=\n\n1\n[I(t) \u2212 J(\u03b5t)] .\n\u03b5\n\n(2.12)\n\nThen, for t \u2208 [0, U/\u03b5) it is\nL(t) = s(I(t), \u0398(t)) \u2212 R(\u03b5t) s(I0 , \u03b80 ) \u2212 K(\u03b5t)+\n\n(2.13)\n\n\u0011\n\u0010\n\u2202f\n(J(\u03b5t)) v(I(t), \u0398(t)) +\n\u2212\u03b5 w(I(t), \u0398(t)) \u2212\n\u2202I\nZ t\n\u0010\n\u2202f\n+ \u03b52 R(\u03b5t)\ndt\u2032 R\u22121 (\u03b5t\u2032 ) u(I(t\u2032 ), \u0398(t\u2032 )) \u2212\n(J(\u03b5t\u2032 ))(w + q)(I(t\u2032 ), \u0398(t\u2032 ))+\n\u2202I\n0\n\u0011\n1\n\u2212M (J(\u03b5t\u2032 ))v(I(t\u2032 ), \u0398(t\u2032 )) \u2212 G (J(\u03b5t\u2032 ), \u03b5L(t\u2032 ))L(t\u2032 ) + H (J(\u03b5t\u2032 ), \u03b5L(t\u2032 )) L(t\u2032 )2 .\n2\nd\nm\nm\u22121\nIn the above, v \u2208 C (\u039b\u00d7T, R ), q, w \u2208 C\n(\u039b\u00d7T, Rd ), u \u2208 C m\u22122 (\u039b\u00d7T, Rd ), and\nM \u2208 C m\u22122 (\u039b, T11 (Rd )) are the functions uniquely defined by the following equations:\ns=\u03c9\n1\n\nR\u03b8\n\n\u2202v\n,\n\u2202\u03b8\n\nv(I, \u03b80 ) = 0\n\nfor all I \u2208 \u039b;\n\n(2.14)\n\nhere, 0 means integration along any path in T from 0 to \u03b8; the integral depends only on\nthe extremes, because the integrand has zero average. The same could be said for other integrals\nappearing later.\n\n6\n\n\fq :=\np=p+\u03c9\n\n\u2202w\n,\n\u2202\u03b8\n\n\u2202v\n\u2202v\nf+\ng;\n\u2202I\n\u2202\u03b8\n\n(2.15)\n\nw(I, \u03b80 ) = 0 for all I \u2208 \u039b ;\n\n(2.16)\n\n\u2202w\n\u2202w\nf+\ng;\nu :=\n\u2202I\n\u2202\u03b8\n\n\u22022f\nM := 2 f \u2212\n\u2202I\n\n\u0012\n\n\u2202f\n\u2202I\n\n\u00132\n\n.\n\n(2.17)\n\nFurthermore, G \u2208 C m\u22122 (\u039b\u2020 , T11 (Rd )) and H \u2208 C m\u22122 (\u039b\u2020 , T12 (Rd )) are two functions\nfulfilling Eq.s (2.5) for h = p and (2.6) for h = f : so, for (I, \u03b4I) \u2208 \u039b\u2020 ,\np(I + \u03b4I) = p(I) + G (I, \u03b4I)\u03b4I ,\n\n(2.18)\n\n1\n\u2202f\n(I)\u03b4I + H (I, \u03b4I)\u03b4I 2 , Hjki (I, \u03b4I) = Hkji (I, \u03b4I) . (2.19)\n\u2202I\n2\nProof. It is obtained by a long computation, where the functions s, ...., H appear\ngradually. See the Appendix A.\n\u22c4\nf (I + \u03b4I) = f (I) +\n\nRemarks. i) The above definitions must be understood in terms of the previous\ntensor notations; for example, the equivalent formulation in components of Eq.\nR\u03b8 \u2032\n\u22022f i\n\u2202f i \u2202f k\n\u22121\n.\nOf\ncourse\nv(I,\n\u03b8)\n=\n\u03c9\n(I)\nd\u03b8 s(I, \u03b8\u2032 ),\n(2.17) is Mji = k j f k \u2212 k\n\u03b80\n\u2202IR \u2202I\n\u2202I \u2202I j\n\u03b8\nw(I, \u03b8) = \u03c9 \u22121(I)) 0 d\u03b8\u2032 (p(I, \u03b8\u2032 ) \u2212 p(I)).\nii) If we write I(t) = J(\u03b5t) + \u03b5L(t), (2.13) becomes an integral equation for L. Most\nof the terms therein are slow, i.e., depend on \u03b5t: the exceptions are L itself and\nthe angle \u0398. The subsequent step after this Lemma will be to infer from (2.13)\nan integral inequality involving only the slow time variable \u03b5t; we note that, even\nthough the integral in Eq. (2.13) is multiplied by \u03b52 , this term appears to be of\norder \u03b5 if we consider \u03b5t\u2032 as the integration variable. In any case, the presence of a\nsmall factor \u03b5 in front of the integral allows us to use for it fairly rough estimates.\n2C. A second Lemma: an integral inequality for |L|. Throughout this paragraph we assume that the solution J of the averaged system exists on [0, U), and\ndefine R, K via Eq.s (2.10), (2.11). B(I, \u033a) denotes the open ball in Rd of center I\nand radius \u033a; we furtherly suppose the following.\ni) There is a function \u03c1 \u2208 C([0, U), [0, +\u221e]) such that\nB(J(\u03c4 ), \u03c1(\u03c4 )) \u2282 \u039b\n\nfor \u03c4 \u2208 [0, U) .\n\n(2.20)\n\nWe denote with \u0393\u03c1 the subgraph of \u03c1, i.e.,\n\u0393\u03c1 := {(\u03c4, r) | \u03c4 \u2208 [0, U), r \u2208 [0, \u03c1(\u03c4 )) } .\n\n(2.21)\n\nii) There are functions\na, b, c, d, e \u2208 C(\u0393\u03c1 , [0, +\u221e))\n7\n\n(2.22)\n\n\fsuch that, for any \u03c4 \u2208 [0, U), \u03b4J \u2208 B(0, \u03c1(\u03c4 )) and \u03b8 \u2208 T,\n|s(J(\u03c4 ) + \u03b4J, \u03b8) \u2212 R(\u03c4 )s(I0 , \u03b80 ) \u2212 K(\u03c4 )| 6 a(\u03c4, |\u03b4J|) ,\nw(J(\u03c4 ) + \u03b4J, \u03b8) \u2212\n\n\u2202f\n(J(\u03c4 )) v(J(\u03c4 ) + \u03b4J, \u03b8)\n\u2202I\n\nu(J(\u03c4 ) + \u03b4J, \u03b8) \u2212\n\n6 b(\u03c4, |\u03b4J|) ,\n\n(2.23)\n(2.24)\n\n\u2202f\n(J(\u03c4 ))(w + q)(J(\u03c4 ) + \u03b4J, \u03b8)+\n\u2202I\n\n\u2212M (J(\u03c4 ))v(J(\u03c4 ) + \u03b4J, \u03b8) 6 c(\u03c4, |\u03b4J|) ,\n\n(2.25)\n\n|G (J(\u03c4 ), \u03b4J)| 6 d(\u03c4, |\u03b4J|) ,\n\n(2.26)\n\n|H (J(\u03c4 ), \u03b4J)| 6 e(\u03c4, |\u03b4J|)\n\n(2.27)\n\n(note that (J(\u03c4 ), \u03b4J) \u2208 \u039b\u2020 , by the convexity of the sphere). The functions c, d, e are\nassumed to be non decreasing with respect to the second variable:\n(\u03c4, r), (\u03c4, r \u2032) \u2208 \u0393\u03c1 , r 6 r \u2032\n\n\u21d2\n\nc(\u03c4, r) 6 c(\u03c4, r \u2032 ) ,\n\n(2.28)\n\nand similarly for d, e. Given a, b, c, d, e, we define the functions\n\u03b1 \u2208 C(\u0393\u03c1 , [0, +\u221e)),\n\n\u03b1(\u03c4, r) := a(\u03c4, r) + \u03b5b(\u03c4, r) ,\n\n(2.29)\n\n1\n\u03b3(\u03c4, r, l) := c(\u03c4, r) + d(\u03c4, r)l + e(\u03c4, r)l2 . (2.30)\n2\nWe can now write the integral inequality for the function t 7\u2192 |L(t)|, with L as in\n(2.12).\n\u03b3 \u2208 C(\u0393\u03c1 \u00d7 [0, +\u221e), [0, +\u221e)),\n\n2.2 Lemma Assume that the solution (I, \u0398) of the perturbed system exists on\n[0, U/\u03b5), and that |L(t)| < \u03c1(\u03b5t)/\u03b5 for all t \u2208 [0, U/\u03b5). Then\nZ t\n2\n|L(t)| 6 \u03b1(\u03b5t, \u03b5|L(t)|) + \u03b5 |R(\u03b5t)|\ndt\u2032 |R\u22121 (\u03b5t\u2032 )| \u03b3(\u03b5t\u2032, \u03b5|L(t\u2032 )|, |L(t\u2032 )|) .\n(2.31)\n0\n\nProof. We take the norm of both sides in Eq. (2.13). To estimate the right hand\nside, we use some Schwarz inequalities and Eq.s (2.23\u20132.27) with \u03b4J = I(t)\u2212J(\u03b5t) =\n\u03b5L(t); then, the thesis follows from the definitions (2.29) (2.30) of \u03b1 and \u03b3.\n\u22c4\n2D. A third Lemma, on integral inequalities. To go on, we need a general\nresult on a class of integral inequalities; we state it at an abstract level, forgetting\nmomentarily the function |L|.\n\n8\n\n\f2.3 Lemma. Let T \u2208 (0, +\u221e], \u03b4 \u2208 C([0, T ), [0, +\u221e]) and\n\u039e := {(t, l) | t \u2208 [0, T ), l \u2208 [0, \u03b4(t)) },\n\n(2.32)\n\nH := {(t, t\u2032 , l) | t \u2208 [0, T ) , t\u2032 \u2208 [0, t], (t\u2032 , l) \u2208 \u039e } .\nConsider two functions \u03be \u2208 C(\u039e, [0, +\u221e)) and \u03b7 \u2208 C(H, [0, +\u221e)), the latter non\ndecreasing in the last variable: \u03b7(t, t\u2032 , l\u2032 ) 6 \u03b7(t, t\u2032 , l) for (t, t\u2032 , l) \u2208 H and l\u2032 \u2208 [0, l].\nFurthermore, let l \u2208 C([0, T ), [0, +\u221e)) and v \u2208 C([0, T ), (0, +\u221e)) be such that\ngraph l, graph v \u2282 \u039e, and\nZ t\nl(0) = 0 ,\nl(t) 6 \u03be(t, l(t)) +\ndt\u2032 \u03b7(t, t\u2032 , l(t\u2032 )) ,\n(2.33)\n0\n\nv(t) > \u03be(t, v(t)) +\n\nZ\n\nt\n\ndt\u2032 \u03b7(t, t\u2032 , v(t\u2032 ))\n\n(2.34)\n\n0\n\nfor all t \u2208 [0, T ). Then\nl(t) < v(t)\n\nfor all t \u2208 [0, T ) .\n\nProof. It adapts the one of a similar result in [5]; see the Appendix B.\n\n(2.35)\n\u22c4\n\n2E. The main Proposition. Throughout this paragraph we still assume that the\nsolution J of the averaged system exists on [0, U), and define R, K via Eq.s (2.10)\n(2.11). We also assume there is a set of functions \u03c1, a, b, c, d, e as in paragraph 2C;\n\u03b1 and \u03b3 are defined consequently, as indicated therein.\n2.4 Proposition. Assume that there is a function n \u2208 C([0, U), (0, +\u221e)) such\nthat, for all \u03c4 \u2208 [0, U),\nn(\u03c4 ) < \u03c1(\u03c4 )/\u03b5 ,\n(2.36)\nZ \u03c4\nn(\u03c4 ) > \u03b1(\u03c4, \u03b5n(\u03c4 )) + \u03b5|R(\u03c4 )|\nd\u03c4 \u2032 |R\u22121 (\u03c4 \u2032 )| \u03b3(\u03c4 \u2032 , \u03b5n(\u03c4 \u2032 ), n(\u03c4 \u2032 )) .\n(2.37)\n0\n\nThen, the solution (I, \u0398) of the perturbed system exists on [0, U/\u03b5); furthermore,\ndefining L as in Eq. (2.12) we have\n|L(t)| < n(\u03b5t)\n\nfor all t \u2208 [0, U/\u03b5).\n\n(2.38)\n\nProof. Let us recall that (I, \u0398) is the maximal solution of (1.3), and denote its\ndomain with [0, V /\u03b5); for the moment, this merely defines the coefficient V \u2208 (0, +\u221e]\n(which can depend on \u03b5 and be large, small, etc.). To go on, we provisionally put\nU \u2032 := min(V, U) ;\n9\n\n(2.39)\n\n\fone of our aims is to show that U \u2032 = U, but this will be established only in the\nsecond step of the proof. We also define L as in Eq. (2.12), but on the domain\n[0, U \u2032 /\u03b5).\nStep 1. One has\n|L(t)| < n(\u03b5t)\nfor all t \u2208 [0, U \u2032 /\u03b5) .\n(2.40)\n\nTo show this, we write the integral inequality (2.37) with \u03c4 = \u03b5t, \u03c4 \u2032 = \u03b5t\u2032 ; this gives\nZ t\n2\nn(\u03b5t) > \u03b1(\u03b5t, \u03b5n(\u03b5t)) + \u03b5 |R(\u03b5t)|\ndt\u2032 |R\u22121 (\u03b5t\u2032 )| \u03b3(\u03b5t\u2032 , \u03b5n(\u03b5t\u2032 ), n(\u03b5t\u2032 ))\n(2.41)\n0\n\nfor all t \u2208 [0, U/\u03b5), and a fortiori for t \u2208 [0, U \u2032 /\u03b5).\nOn the other hand, Lemma 2.2 can be applied with the constant U therein replaced\nby U \u2032 , because (I, \u0398) is defined on [0, U \u2032 /\u03b5) and J is defined on [0, U \u2032 ); thus, Eq.\n(2.31) for |L(t)| holds for t \u2208 [0, U \u2032 /\u03b5). Now, we apply Lemma 2.3 with\nT :=\n\u03be(t, l) := \u03b1(\u03b5t, \u03b5l) ,\n\nU\u2032\n,\n\u03b5\n\n\u03b4(t) := \u03c1(\u03b5t)/\u03b5,\n\n(2.42)\n\n\u03b7(t, t\u2032 , l) := \u03b52 |R(\u03b5t)| |R\u22121(\u03b5t\u2032 )| \u03b3(\u03b5t\u2032 , \u03b5l, l) ,\n\nl(t) := |L(t)| ,\n\nv(t) := n(\u03b5t) ;\n\nof course, the initial condition l(0) = 0 holds because I(0) = I0 = J(0). Lemma 2.3\ngives l(t) < v(t), which is just the relation (2.40).\nStep 2. It is\nU\u2032 = U\n(2.43)\n(thus (I, \u0398) exists on [0, U/\u03b5), and the inequality of Step 1 holds on this interval).\nIt suffices to show that V > U; to this purpose we suppose V < U, and infer a\ncontradiction. Indeed, let us put\nK := {(t, I) \u2208 [0, V /\u03b5] \u00d7 Rd | |I \u2212 J(\u03b5t)| 6 \u03b5n(\u03b5t)} .\n\n(2.44)\n\nThis is a closed subset of R \u00d7 Rd ; it is bounded, since t 7\u2192 J(\u03b5t), t 7\u2192 n(\u03b5t) are\nbounded functions on [0, V /\u03b5]. Thus, K is a compact subset of R \u00d7 Rd . We note\nthat (t, I) \u2208 K implies I \u2208 B(J(\u03b5t), \u03b5n(\u03b5t)) \u2282 B(J(\u03b5t), \u03c1(\u03b5t)) \u2282 \u039b (recall Eq.s (2.36)\nand (2.20)); thus, K \u2282 [0, V /\u03b5] \u00d7 \u039b.\nThe previous considerations ensure compactness of K \u00d7 T \u2282 R \u00d7 \u039b \u00d7 T; due to\nStep 1, we have graph (I, \u0398) \u2282 K \u00d7 T . The inclusion into a compact set and a\nstandard continuation principle for ordinary differential equations [9] imply that the\nsolution (I, \u0398) can be extended to an interval larger than [0, V /\u03b5). This contradicts\nour maximality assumption, and concludes the proof.\n\u22c4\n2F. A differential reformulation of the previous results. For practical applications, and especially for the numerical implementation of our scheme by standard\n10\n\n\fpackages, it is convenient to replace the integral inequality (2.37) for n with a differential equation related to it. This equation is presented hereafter, and will be\nthe basis of all applications discussed in the next sections; it is supplemented by an\ninitial condition, defined implicitly by a fixed point problem.\nIn the sequel we keep the assumptions at the beginning of paragraph 2E, but we\nrequire some more regularity on the functions a, b, c, d, e fulfilling Eq.s (2.23\u20132.27),\nnamely,\na, b \u2208 C 2 (\u0393\u03c1 , R) ,\nc, d, e \u2208 C 1 (\u0393\u03c1 , R) ;\n(2.45)\nso, the functions \u03b1, \u03b3 in Eq.s (2.29) (2.30) are, respectively, of class C 2 and C 1 .\n\n2.5 Proposition. i) Assume there are real numbers l\u2217 , M > 0 and \u03c3 > 0 such\nthat\n\u03a3 := [l\u2217 \u2212 \u03c3, l\u2217 + \u03c3] \u2282 (0, \u03c1(0)/\u03b5) ,\n(2.46)\nM < 1/\u03b5 ,\n\n\u2202\u03b1\n(0, \u03b5l) 6 M\n\u2202r\n\nfor l \u2208 \u03a3 ,\n\n|\u03b1(0, \u03b5l\u2217) \u2212 l\u2217 | + \u03b5M\u03c3 < \u03c3 .\n\n(2.47)\n(2.48)\n\nThen, the map l 7\u2192 \u03b1(0, \u03b5l) sends the interval \u03a3 into itself and is therein contractive\nwith Lipschitz constant \u03b5M. So, there is a unique l0 \u2208 \u03a3 solving the fixed point\nequation\n\u03b1(0, \u03b5l0 ) = l0 .\n(2.49)\nii) With l0 as above, let m, n \u2208 C 1 ([0, U), R) solve the Cauchy problem\ndm\n= |R\u22121 | \u03b3(*, \u03b5n, n) ,\nm(0) = 0 ,\n(2.50)\nd\u03c4\n\u0013\n\u0011\u22121 \u0012 \u2202\u03b1\ndn \u0010\n\u2202\u03b1\ndR \u0001\n\u22121\n\u22121\nm ,\n= 1\u2212\u03b5\n(*, \u03b5n)\n(*, \u03b5n) + \u03b5|R||R | \u03b3(*, \u03b5n, n) + \u03b5|R|\nR\u2022\nd\u03c4\n\u2202r\n\u2202\u03c4\nd\u03c4\nn(0) = l0 ,\n\n(2.51)\n\nwith the domain conditions\n\u2202\u03b1\n(*, \u03b5n) < 1/\u03b5\n\u2202r\n\n0 < n < \u03c1/\u03b5 ,\n\n(2.52)\n\n(note that (2.50) implies m > 0; in the above, \u2022 is the inner product of Eq. (2.2)).\nThen, the solution (I, \u0398) of the perturbed system exists on [0, U/\u03b5) and (with L as\nin (2.12))\n|L(t)| 6 n(\u03b5t)\nfor all t \u2208 [0, U/\u03b5).\n(2.53)\nProof. It is found in the Appendix C, after a necessary lemma.\n\n11\n\n\u22c4\n\n\f3\n\nA summary of the method, and how to test it.\n\n3A. The main steps to implement the scheme of the previous section. In\nthe approach we have outlined, the steps to be performed are the following ones.\ni) Compute f and the functions s, p, ..., M , G , H of Eq.s (2.8) (2.14\u20132.19).\nii) Determine the solution J of Eq. (1.6), on some interval [0, U); solve Eq.s (2.10)\n(2.11) for R, K on the same interval.\niii) Find a set of functions \u03c1, a, b, c, d, e as in paragraph 2C, so as to fulfil the inequalities (2.23\u20132.27); from them, define the functions \u03b1, \u03b3 via Eq.s (2.29) (2.30).\nIn the subsequent steps, we make on a, ..., e the assumptions (2.45).\niv) Determine l0 , solving the fixed point problem (2.49).\nv) Search for functions m, n fulfillfing Eq.s (2.50) (2.51), with the domain conditions\n(2.52). If these equations and (1.6) have solutions on some interval [0, U), we can\ngrant existence on [0, U/\u03b5) for the solution (I, \u0398) of (1.3), and we know that L(t) :=\n(I(t) \u2212 J(\u03b5t))/\u03b5 fulfils on this interval the bound |L(t)| 6 n(\u03b5t).\n\nHere are some general comments on the practical implementation of the previous\nsteps (these will also be useful to introduce the examples of the next section).\ni) Of course, the computation of f , s, p, ..., M is more or less difficult depending on f ,\ng and \u03c9, concerning especially the integrals over \u03b8. These computations can involve\nspecial functions (it should be noted that, in many examples coming from mechanics, f , g and \u03c9 are themselves special functions). Generally, the determination of\nf , s, p, ..., M is simple when, for fixed I, f and g are trigonometric polynomials in\n\u03b8. Concerning G and H , see the remarks that follow Eq.s (2.5) (2.6).\nii) The determination of J, R, K will be analytical in the symplest cases, and otherwise\nnumerical.\niii) For the implementation of our scheme, the functions b, c, d, e are slightly less\nimportant than a; in fact, they are always multiplied by the small parameter \u03b5\nwhenever they appear in steps iii) iv) v). For this reason, it is important to compute\na estimating as accurately as possible the left hand side in Eq. (2.23); as for b, ..., e,\nin many cases one can accept rougher majorizations for the left hand sides of Eq.s\n(2.24\u20132.27).\nIn many applications, such as in the examples of the next section, the functions\na, b, .., e will have the form\na(\u03c4, r) := b\na(J(\u03c4 ), R(\u03c4 ), K(\u03c4 ), r), b(\u03c4, r) := bb(J(\u03c4 ), r), ..., e(\u03c4, r) = b\ne(J(\u03c4 ), r)\n\n(3.1)\n\nbb \u2208 C 2 (\u03a5,\nb R) ,\n\n(3.2)\n\ndepending on certain known functions\n\nwith domains\n\nb R) ,\nb\na \u2208 C 2 (\u2206,\n\nb \u2282 Rd \u00d7 T1 (Rd ) \u00d7 Rd \u00d7 R open,\n\u2206\n1\n\n12\n\nbb\nb R) ,\nb\nc, d,\ne \u2208 C 1 (\u03a5,\n\nb \u2282 Rd \u00d7 R open such that\n\u03a5\n\n(3.3)\n\n\fb ,\n(J(\u03c4 ), R(\u03c4 ), K(\u03c4 ), r) \u2208 \u2206\n\nOf course, in this case it is\n\nb for all (\u03c4, r) \u2208 \u0393\u03c1 .\n(J(\u03c4 ), r) \u2208 \u03a5\n\n\u03b1(\u03c4, r) = \u03b1\nb(J(\u03c4 ), R(\u03c4 ), K(\u03c4 ), r) ,\n\n\u03b3(\u03c4, r, l) = \u03b3b(J(\u03c4 ), r, l) ,\n\nb R) and \u03b3b \u2208 C 1 (\u03a5\nb \u00d7 R, R) are defined by\nwhere \u03b1\nb \u2208 C 2 (\u2206,\n\n\u03b1\nb(J, R, K, r) := b\na(J, R, K, r) + \u03b5bb(J, r) ,\n\nb r)l + 1 eb(J, r)l2 .\n\u03b3 (J, r, l) := b\nb\nc(J, r) + d(J,\n2\nFurthermore, the derivative \u2202\u03b1/\u2202\u03c4 in Eq. (2.51) is given by\n\u2202\u03b1\nb\ndJ\n\u2202\u03b1\nb\ndR\n\u2202\u03b1\nb\ndK\n\u2202\u03b1\n(*, r) =\n(J, R, K, r) \u2022\n+\n(J, R, K, r) \u2022\n+\n(J, R, K, r) \u2022\n\u2202\u03c4\n\u2202J\nd\u03c4\n\u2202R\nd\u03c4\n\u2202K\nd\u03c4\n\n(3.4)\n\n(3.5)\n(3.6)\n\n(3.7)\n\nwith \u2202 \u03b1\nb/\u2202R := (\u2202 \u03b1\nb/\u2202Rji ), etc. In these situations, the function \u03c4 7\u2192 \u03c1(\u03c4 ) determining the domain of a, ..., e will often depend on \u03c4 through J, i.e., \u03c1(\u03c4 ) = \u03c1b(J(\u03c4 )).\nThe structure (3.1) for a, b, etc. appears naturally in cases where these functions can\nbe obtained maximizing the left hand sides of Eq.s (2.23), (2.24), etc. by analytical\nmeans.\nIn more complicated situations, one could consider the possibility to determine a, b,\netc., maximising the left hand sides of Eq.s (2.23), (2.24), etc. by numerical (or\npartially numerical) techniques. These would give tables of numerical maxima, to\nbe subsequently interpolated by elementary functions to get a, b, etc. . A second\npossibility is to derive the evolution equation for the maximum points of interest\nas function of \u03c4 , to be coupled with the other differential equations in our general\nframework; this approach should work if there are no bifurcations.\nBoth possibilities outlined above are especially interesting for the function a, since\nthis requires the greatest accuracy; however, they will be investigated elsewhere.\niv) The fixed point l0 in (2.49) is given by the standard iterative formula l0 =\nlimn\u2192+\u221e ln , where ln := \u03b1(0, \u03b5ln\u22121) and l1 is chosen arbitrarily in \u03a3. One can\ncompute numerically the sequence (ln ) up to a sufficiently large value n = N, and\nthen assume l0 \u2243 lN . (2 )\nv) Even in cases where all the other functions have known analytical expressions,\nthe differential equations (2.50) (2.51) for m, n will be typically too difficult to be\nsolved analytically. So, a numerical treatment will be necessary.\nIf we do not have analytical expressions for J, R, K, it may be convenient to regard Eq.s (1.6) (2.10) (2.11) (2.50) (2.51) as a coupled system for the unknowns\nJ, R, K, m, n, to be solved numerically on a chosen interval [0, U).\nBy the standard theory of contractions, |l0 \u2212 lN | 6 (\u03b5M )N \u22121 |l2 \u2212 l1 |/(1 \u2212 \u03b5M ), where M is\nthe constant in Proposition 2.5.\n2\n\n13\n\n\f3B. The \"N-operation\". Let us fix the attention on the simple situations where\nthe functions f , s, ..., H have known analytical expressions and a, b, c, d, e have the\nform (3.1), depending on known functions b\na, ..., b\ne. It is not difficult to write a\nprogram of general use for these situations, which computes the fixed point l0 and\nthe functions J, R, K, m, n solving numerically the equations (2.49) (1.6) (2.11)\n(2.50) (2.51). From now on, the computation of l0 , J, ..., n by such a program, for\ne (and I0 , \u03b80 , U), will be referred to as the N-operation. Of course, the\ngiven f , ..., b\nmain outcomes of this operation are the solution J of the averaged system and the\nfunction n binding |L(t)|.\nWe have written a general program for the above purpose, using the MATHEMATICA system. Concerning Eq.(2.51) for n, in this program the derivative \u2202\u03b1/\u2202\u03c4 is\nexpressed via Eq. (3.7); the derivatives dJ/d\u03c4, dK/d\u03c4 and dR/d\u03c4 which occur in\n(3.7) and (2.51) are expressed via Eq.s (1.6) (2.10) (2.11) (MATHEMATICA is also\nuseful, in the symbolic mode, to produce the input of the above program, i.e., the\nfunctions f , ..., b\ne; this will appear from the examples of the next section).\n\n3C. Testing the effectiveness of the previous method: the \"L-operation\".\nBy the L-operation we mean, essentially, the computation of L by direct numerical\nsolution of the perturbed system on [0, U/\u03b5). To avoid misunderstandings, we stress\nthat in the present framework the purpose of the L-operation is merely to check the\nreliability of the estimate |L(t)| 6 n(\u03b5t) produced by the N-operation, and to prove\nquantitatively that the direct solution of the perturbed system is generally much\nslower than N. When U/\u03b5 is very large, the L-operation may be impossible within\nreasonable times; an example will be given in the next Section (see Figure 3f, and\nthe explanations for it). Of course, the main usefulness of the N-operation is just\nthe treatment of these cases!\nTo be precise, the L-operation is the numerical determination of J, L, \u0398 in the following way. First, the function \u03c4 \u2208 [0, U) \u2192 J(\u03c4 ) is obtained solving the averaged\nsystem (1.6) for J; then, the functions t \u2208 [0, U/\u03b5) \u2192 L(t), \u0398(t) are determined\nsolving their exact evolution equations derived from (1.3) (1.6), i.e.,\n\u001a\n(dL/dt)(t) = f (J(\u03b5t) + \u03b5L(t), \u0398(t)) \u2212 f (J(\u03b5t)),\nL(0) = 0 ,\n(3.8)\n(d\u0398/dt)(t) = \u03c9(J(\u03b5t)) + \u03b5g(J(\u03b5t) + \u03b5L(t), \u0398(t)),\n\u0398(0) = \u03b80 .\n\nIt is easy to write a MATHEMATICA program that computes numerically J, L, \u0398\nfor given f, g, \u03c9, I0 , \u03b80 .\nWhen the L-operation can performed within reasonable times, it can be used to test\nthe N-procedure along these lines:\ni) one compares the graph of the estimator n (an N-output) with the graph of the\nfunction |L| (an L- output);\nii) one also compares the CPU times TN, TL for the two operations.\nThese tests are presented in the next section; they are based on the programs mentioned here and in paragraph 3B. In most examples, the estimator n practically\n14\n\n\fcoincides with the envelope of the rapidly oscillating graph of |L|; furthermore, TN\nis generally smaller than TL by one or more orders of magnitude.\n\n4\n\nExamples.\n\nIn any example we consider, the initial condition for the angle is always\n\u03b80 := 0 .\n\n(4.1)\n\nGiven f , g and \u03c9, the functions f , s, ..., G , H and \u03c1, a, ..., e are computed explicitly\nfor all I0 (and U). After this, specific choices are made for I0 , U and \u03b5, and the Noperation is performed; to test the accuracy of the method, the L-operation is also\nperformed and some comparisons are made, as suggested at the end of the previous\nsection. The results are summarized in the figures which conclude the section. Each\nfigure gives the graph of the estimator n(\u03c4 ) provided by N for \u03c4 \u2208 [0, U); it also\ngives the graph of |L(\u03c4 /\u03b5)| in the same interval (except one case, where L has not\nbeen possible within reasonable times).\nFigures referring to an example are labelled by the same number and by a letter\n(so, Fig.s 1a, 1b and 1c refer to Example 1). The legend of each figure specifies the\nchoices of I0 , \u03b5, U, and the CPU times TN, TL (in seconds) in the execution of the\ntwo operations (3 ).\nIn the chosen examples, one derives simple analytical expressions for the functions\nJ, R, K but not for m, n. However, with the view of a general comparison between\nthe N- and L-operations, all examples have been treated by the general MATHEMATICA programs mentioned in paragraphs 3B-3C, which solve numerically all the\ndifferential equations involved. Therefore, the reported times TN, TL include contributions from the determination of J, R, K. In any case, the analytical expressions\nof these functions are written for completeness.\nFor each example:\ni) the auxiliary functions s, ..., H , \u03c1, a, ..., e are reported in a table. All the related\ncomputations are analytical; the most lengthy have been performed using MATHEMATICA in the symbolic mode.\nii) The function \u03c1 always gives the distance of J(\u03c4 ) from the boundary of the actions\nspace \u039b.\niii) Some details on the computation of the functions a and b, c are given in the\nAppendices D and E, respectively. The expressions for d, e follow trivially from the\nones for G , H in the corresponding tables.\nExample 1: the van der Pol equation. This is a system of the form (1.3) for\n(I, \u0398), with\nd := 1 ,\n\u039b := (0, +\u221e) ,\n\u03c9(I) := \u22121 ,\n(4.2)\n3\n\nof course these times, depending on the PC employed, are merely indicative.\n\n15\n\n\fI2\n1\u2212I\nI\nI\nsin(2\u03b8) \u2212 sin(4\u03b8) .\nf (I, \u03b8) := I(1 \u2212 ) \u2212 I cos(2\u03b8) + cos(4\u03b8), g(I, \u03b8) :=\n2\n2\n2\n4\n\u221a\n\u221a\nThe functions x := 2I cos \u0398, v := 2I sin \u0398 fulfil the equations \u1e8b = v, v\u0307 =\n\u2212x \u2212 \u03b5 (x2 \u2212 1)v, yielding the familiar van der Pol equation \u1e8d + x + \u03b5 (x2 \u2212 1)\u1e8b = 0.\nIt is found that\nI\nf (I) = I(1 \u2212 ) ;\n(4.3)\n2\nthe auxiliary functions s, v, ..., H of paragraph 2B are reported in Table 1 (4 ).\nThe averaged system (1.6) has the solution\nJ(\u03c4 ) =\n\n2I0\nI0 + (2 \u2212 I0 ) e\u2212\u03c4\n\n(4.4)\n\nfor \u03c4 \u2208 [0, +\u221e), tending to 2 for \u03c4 \u2192 +\u221e : this long time behavior is the manifestation, in the averaging approximation, of the well known limit cycle of the van\nder Pol equation (J(\u03c4 ) also exists for some or all \u03c4 < 0, but we are not interested in\nthis fact). The Cauchy problems (2.10), (2.11) for the unknown real functions R, K\nhave solutions\n4e\u2212\u03c4\nR(\u03c4 ) =\n,\nK(\u03c4 ) = 0\n(4.5)\n(I0 + (2 \u2212 I0 ) e\u2212\u03c4 )2\nfor \u03c4 \u2208 [0, +\u221e). From now on, \u03c4 is confined to an interval [0, U) (and, of course, U\nwill be chosen finite in the subsequent numerical computations).\nOur next step is to construct functions \u03c1, a, ..., e as in paragraph 2C; these are also reported in Table 1 (5 ). All the functions a, ..., e are C \u221e in (\u03c4, r), and non decreasing in\nr; they have the form a(\u03c4, r) = b\na(J(\u03c4 ), r), b(\u03c4, r) = bb(J(\u03c4 ), r), ..., e(\u03c4, r) = eb(J(\u03c4 ), r),\nwhere b\na, bb, b\nc are read from the Table and db := 0, b\ne := 1 everywhere; this corresponds to a special case of Eq. (3.1). Similar remarks could be made for the other\nExamples, but will be no longer repeated.\n\nComments on this example and the figures. Figures 1a, 1b, 1c refer to the initial\ndata I0 = 1/2 or I0 = 4, one below and the other above the critical value I = 2 (i.e.,\nthe limit cycle in the averaging approximation); U is 10 or 200. The ratio TN/TL\nis between 1/150 and 1/40, in the three cases. Due to the limit cycle, one expects\n4\n\nWe note that the domain \u039b\u2020 of G , H is made of pairs (I, \u03b4I) as indicated in Table 1. In all\nthe other examples, \u039b\u2020 can be read as well from the tables.\n5\nThe functions b, c constructed in this way could be replaced by appropriate, simpler majorants reducing the \"confidence interval\" [0, J(\u03c4 )) for r; for example, one could redefine \u03c1(\u03c4 ) :=\nmin(J(\u03c4 ), 1/10) and infer upper bounds for b, c by means of the inequalities rk 6 r/10k\u22121 , for\nk = 2, 3, ..., holding for r \u2208 [0, \u03c1(\u03c4 )). These upper bounds are fairly simple, since they depend linearly on r; of course, their use is correct if one checks a posteriori that 0 < \u03b5 n(\u03c4 ) < min(J(\u03c4 ), 1/10)\nfor all \u03c4 \u2208 [0, U ). However, to perform the N-operation in all cases presented in the figures we have\nused directly the complicated expressions in Table I, since these are easily handled by MATHEMATICA.\n\n16\n\n\fTable 1. Auxiliary functions for Example 1.\nFor I \u2208 (0, +\u221e), \u03b8 \u2208 T and \u03b4I \u2208 (\u2212I, +\u221e):\n\u0011\n\u0011\nI\u0010\nI \u0010\ns(I, \u03b8) =\n4 sin(2\u03b8)\u2212I sin(4\u03b8) , v(I, \u03b8) = \u2212\n8\u2212I \u22128 cos(2\u03b8)+I cos(4\u03b8) ,\n8\u0010\n32\n\u0011\nI\n2\np(I, \u03b8) =\n(4 \u2212 2I \u2212 I ) sin(2\u03b8) + I(I \u2212 4) sin(4\u03b8) + I 2 sin(6\u03b8) ,\np(I) = 0 ,\n8\n\u0010\n\u0011\nI\n2\n2\n2\n16 \u221210I + 2I \u2212(16 \u2212I ) cos(2\u03b8) + I(10 \u22122I) cos(4 \u03b8) \u2212I cos(6\u03b8) ,\nq(I, \u03b8) = \u2212\n32 \u0010\nI\nw(I, \u03b8) = \u2212\n24 \u2212 24I \u2212 I 2 \u2212 6(4 \u2212 2I \u2212 I 2 ) cos(2\u03b8) + 3I(4 \u2212 I) cos(4\u03b8) \u2212\n\u0011 96\n2I 2 cos(6\u03b8) ,\nI \u0010\nu(I, \u03b8) = \u2212\n64 \u2212 120I + 36I 2 + I 3 + (\u221264 + 64I + 50I 2 \u2212 12I 3 ) cos(2\u03b8)+\n128\n\u0011\n2\n2\n3\n+4I(14 \u2212 17I \u2212 I ) cos(4\u03b8) + 6I (\u22123 + 2I) cos(6\u03b8) + 3I cos(8\u03b8) ,\n1\nM (I) = \u22121 + I \u2212 I 2 ,\nG (I, \u03b4I) = 0,\nH (I, \u03b4I) = \u22121 .\n2\nFor \u03c4 \u2208 [0, U), \u03c1(\u03c4 ) := J(\u03c4 ).\nFor \u03c4 \u2208 [0, U) and r \u2208 [0, J(\u03c4 )) :\n\u00111/2\n1\u0010\n,\n\u2212 2 + 10(J + r)2 + (J + r)4 + 2(1 + 2(J + r)2 )3/2\na(\u03c4, r) :=\nJ=J(\u03c4 )\n8\n1\u0010\n120J 6 + 12J 5 (23 + 56r) + 3J 4 (192 + 474r + 517r 2 )+\nb(\u03c4, r) :=\n96\n+12J 3 r(72 + 180r + 157r 2 ) + 6J 2 r 2 (372 + 530r + 231r 2) + 12Jr 3 (216 + 213r + 46r 2)+\n\u00111/2\n,\n+r 4 (1404 + 690r + 91r 2)\nJ=J(\u03c4 )\n1 \u0010\nc(\u03c4, r) :=\n6512J 8 + 24J 7 (671 + 2096r) + 24J 6 (1693 + 5484r + 6956r 2) + 8J 5 \u00d7\n384\n\u00d7(1812 + 31188r + 39375r 2 + 38726r 3) + 12J 4 (768 + 4436r + 61358r 2 + 37966r 3 +\n29997r 4) + 8J 3 r(4680 + 39948r + 125584r 2 + 62193r 3 + 35046r 4) + 12J 2 r 2 (1824+\n+52152r + 61180r 2 + 37311r 3 + 12021r 4) + Jr 3 (119808 + 445536r + 425592r 2 +\n\u00111/2\n,\n210995r 3 + 41976r 4) + 4r 4 (21600 + 33024r + 30127r 2 + 10383r 3 + 1377r 4)\nJ=J(\u03c4 )\n\nd(\u03c4, r) := 0 ,\n\ne(\u03c4, r) := 1 .\n\n17\n\n\f|L(\u03c4 /\u03b5)| to be bounded on the whole interval [0, +\u221e); this fact is reproduced very\nwell by our estimator n(\u03c4 ), that appears to approach a constant value for large \u03c4\n(see in particular Figure 1c).\nExample 2: a case with action-dependent frequency. We choose\nd=1,\n\n\u039b := (0, +\u221e) ,\n\nf (I, \u03b8) := \u03baI 2 (1 \u2212 cos(2\u03b8)) ,\n\n\u03c9(I) := I ,\n\ng(I, \u03b8) := \u03baI 2 (1 + cos(2\u03b8)) ,\n\n(4.6)\n\u03ba \u2208 {\u00b11} .\n\nIt is\nf (I) = \u03baI 2 ,\n\n(4.7)\n\nand the auxiliary functions s, v, ..., H are reported in Table 2. Let us comment on\nthe vanishing of \u03c9 for I \u2192 0. Our framework shows this \"resonance\" to be false:\nin fact, even though Eq.s (2.8) (2.14) (2.16) for s, v, w contain a factor 1/\u03c9, in this\ncase none of these functions is singular for I \u2192 0, since f, g vanish in this limit more\nrapidly than \u03c9.\nThe averaged system (1.6) is fulfilled with\n\u001a\nI0\n1/I0 if \u03ba = +1,\nJ(\u03c4 ) =\nfor \u03c4 \u2208 [0, W\u03ba,I0 ), W\u03ba,I0 :=\n(4.8)\n+\u221e if \u03ba = \u22121.\n1 \u2212 \u03ba\u03c4 I0\nEq.s (2.10) (2.11) for R, K have solutions\nR(\u03c4 ) =\n\n1\n,\n(1 \u2212 \u03baI0 \u03c4 )2\n\nK(\u03c4 ) =\n\n\u03baI02 log(1 \u2212 \u03baI0 \u03c4 )\n60\n2(1 \u2212 \u03baI0 \u03c4 )2\n\n(4.9)\n\non the same domain. In the sequel we assume \u03c4 \u2208 [0, U), with U 6 W\u03ba,I0 ; the\nfunctions \u03c1 (the same of Example 1) and a, b, c, d, e are also reported in Table 2.\nComments on this example and the figures. Fig.s 2a, 2b and 2c refer to the case\n\u03ba = 1, while Fig.s 2d and 2e refer to \u03ba = \u22121; the initial datum is always I0 = 1. The\ntwo cases are radically different: in fact, according to Eq. (4.8), the solution J(\u03c4 ) of\nthe averaged system diverges for \u03c4 \u2192 1\u2212 if \u03ba = 1, whereas for \u03ba = \u22121 it is defined\nfor arbitrarily large \u03c4 and vanishes for \u03c4 \u2192 +\u221e. The figures seem to indicate a\nsimilar behaviour for the function \u03c4 7\u2192 |L(\u03c4 /\u03b5)|; this behaviour is reproduced very\nwell by our estimator n(\u03c4 ), which remains close to the envelope of |L(\u03c4 /\u03b5)| even for\n\u03ba = 1 and \u03c4 close to 1 (see, in particular, Fig.s 2a and 2c).\n\n18\n\n\fTable 2. Auxiliary functions for Example 2.\nFor I \u2208 (0, +\u221e), \u03b8 \u2208 T and \u03b4I \u2208 (\u2212I, +\u221e) :\n\u03ba\n\u03ba\ns(I, \u03b8) = \u2212 I sin(2\u03b8) ,\nv(I, \u03b8) = \u2212 (1 \u2212 cos(2\u03b8)) ,\n2\n4\n\u0011\n1\n1 2\u0010\np(I, \u03b8) = \u2212 I 2I +4 I cos(2\u03b8)+2 sin(2\u03b8)+2I cos(4 \u03b8)\u2212sin(4 \u03b8) , p(I) = \u2212 I 3 ,\n4\n2\n\u0011\n1 2\u0010\nq(I, \u03b8) = \u2212 I 2 sin(2\u03b8) + sin(4 \u03b8) ,\n4 \u0010\n\u0011\n1\nw(I, \u03b8) = \u2212 I 3 \u2212 4 cos(2\u03b8) + 8I sin(2\u03b8) + cos(4 \u03b8) + 2I sin(4 \u03b8) ,\n16 \u0010\n\u03ba\nu(I, \u03b8) = \u2212 I 2 16 I 2 + 10 + (40 I 2 \u2212 15) cos(2\u03b8) + 40I sin(2\u03b8)+\n32\n\u0011\n2\n+(32 I + 6) cos(4 \u03b8) \u2212 8 I sin(4 \u03b8) + (8 I 2 \u2212 1) cos(6 \u03b8) \u2212 8 I sin(6 \u03b8) ,\n1\nH (I, \u03b4I) := 2\u03ba .\nM (I) = 6I 2 ,\nG (I, \u03b4I) := \u2212 (3I 2 + 3I\u03b4I + \u03b4I 2 ) ,\n2\nFor \u03c4 \u2208 [0, U), \u03c1(\u03c4 ) := J(\u03c4 ).\nFor \u03c4 \u2208 [0, U) and r \u2208 [0, J(\u03c4 )) :\n1\na(\u03c4, r) := (J(\u03c4 ) + r) \u2212 K(\u03c4 ) ,\n2\n1 \u0010\nb(\u03c4, r) := \u221a 50J 4 + (55 + 200r)J 3 + (38 + 85r + 300r 2)J 2 + (65 + 33r + 200r 2)Jr+\n8 2\n\u00111/2\n,\n+(32 + 27r + 50r 2 )r 2\nJ=J(\u03c4 )\n1 \u0010\nc(\u03c4, r) := \u221a 4608J 8 +(3904+36864r)J 7 +(1520+23296r+129024r 2)J 6 +(1856+\n16 2\n+5696r+ 57792r 2+ 258048r 3)J 5 + (4853+ 5352r+ 10032r 2+ 76160r 3+ 322560r 4)J 4 +\n+(3086+ 7824r+ 11008r 2 + 56000r 3 + 258048r 4)J 3 r + (1862+ 2976r+ 9808r 2+\n+21504r 3 + 129024r 4)J 2 r 2 + (1024+ 2312r+ 5440r 2 + 7168r 3 + 36864r 4)Jr 3 +\n\u00111/2\n,\n+(512+ 752r+ 1296r 2 + 1280r 3 + 4608r 4)r 4\n1\nd(\u03c4, r) := (3J 2 + 3Jr + r 2 )J=J(\u03c4 ) ,\n2\n\nJ=J(\u03c4 )\n\ne(\u03c4, r) := 2 .\n\n19\n\n\fTable 3. Auxiliary functions for Example 3.\nFor I \u2208 (0, +\u221e), \u03b8 \u2208 T and \u03b4I \u2208 (\u2212I, +\u221e) :\n1\n1\ns(I, \u03b8) = \u2212 sin \u03b8 ,\nv(I, \u03b8) = \u2212 2 (1 \u2212 cos \u03b8) ,\nI\nI\n1\np(I) = 0 ,\np(I, \u03b8) = 2 (2 sin \u03b8 \u2212 sin(2\u03b8)) ,\n2I\nq(I, \u03b8)\n1\nw(I, \u03b8) =\n,\nq(I, \u03b8) = 3 (3 \u2212 4 cos \u03b8 + cos(2\u03b8)) ,\nI\n4\n3\nu(I, \u03b8) = 4 (\u221210 + 15 cos \u03b8 \u2212 6 cos(2\u03b8) + cos(3\u03b8)) ,\n8I\nM (I) = 0 ,\nG (I, \u03b4I) := 0 ,\nH (I, \u03b4I) := 0 .\nFor \u03c4 \u2208 [0, U), \u03c1(\u03c4 ) := J(\u03c4 ).\nFor \u03c4 \u2208 [0, U) and r \u2208 [0, J(\u03c4 )) :\n2\n1\n,\nb(\u03c4, r) :=\n,\na(\u03c4, r) :=\nJ(\u03c4 ) \u2212 r\n(J(\u03c4 ) \u2212 r)3\nd(\u03c4, r) := 0 ,\ne(\u03c4, r) := 0 .\n\nc(\u03c4, r) :=\n\n12\n,\n(J(\u03c4 ) \u2212 r)4\n\nExample 3: a truly resonant case. Let us pass to a case where the vanishing of\n\u03c9 for I \u2192 0 gives rise to singularities for s, v, w and other auxiliary functions. We\nassume\nd=1,\n\u039b := (0, +\u221e) ,\n\u03c9(I) := I ,\n(4.10)\nf (I, \u03b8) := 1 \u2212 cos \u03b8 ,\n\ng(I, \u03b8) := 0 .\n\nThis example is considered in [4] [7] to introduce the subject of resonances; it is\ninspired by a two-frequency example in [2]. In this case,\nf (I) = 1 ;\n\n(4.11)\n\nthe functions s, ...., G , H are reported in Table 3. The averaged system (1.6) has\nthe solution\nJ(\u03c4 ) = I0 + \u03c4\n(4.12)\n\u2202f\n=0\nfor \u03c4 \u2208 [0, +\u221e). Eq.s (2.10) (2.11) for R, K are very simple in this case, since\n\u2202I\nand p = 0; this implies\nR(\u03c4 ) = 1 ,\nK(\u03c4 ) = 0 .\n(4.13)\nFrom now on, \u03c4 \u2208 [0, U); the functions \u03c1, a, b, c, d, e are reported in Table 3.\n\nComments on this example and the figures. The resonance for I \u2192 0+ could be\nexpected to give problems for initial data I0 close to zero (these problems should\nappear mainly for small \u03c4 , since Eq. (4.12) for J shows a departure from the resonance as \u03c4 grows). As a matter of fact, the estimator n approximates well the\n20\n\n\fenvelope of |L(\u03c4 /\u03b5)| even for small \u03c4 and data fairly close to zero, such as I0 = 1/2 :\nthe agreement is rather good for \u03b5 = 10\u22122 (Fig.s 3a and 3b) and very good for\n\u03b5 = 10\u22123 (Fig.s 3c and 3d).\nThe agreement between n and the envelope of |L| is very good even for \u03b5 = 10\u22122 , if\nwe consider the larger datum I0 = 2 (Fig.3e). Fig.3f refers to the same situation on\nthe larger interval \u03c4 \u2208 [0, 200). The statement on TL in the legend means that the\nnumerical computation of L was interrupted after 240 seconds, when the package\nhad not yet produced a result; note that, on the contrary, the N-operation for the\nsame interval is very fast.\nExample 4: damped Euler's top. We consider the system (1.3), with\nd = 2,\n\n\u039b := {I = (I 1 , I 2 ) | I 1 , I 2 \u2208 (0, +\u221e)},\n\n\u03c9(I) = I 1 I 2 ,\n\n\u0001\nf (I, \u03b8) := \u2212 I 1 (\u03bb1 + \u03bc cos(2\u03b8)), \u2212I 2 (\u03bb2 \u2212 \u03bc cos(2\u03b8) ,\n\n(4.14)\n\ng(I, \u03b8) := \u03bc sin(2\u03b8) ;\n\nthis depends on three real coefficients \u03bc, \u03bb1, \u03bb2 for which we assume\n\u03bb1 > 0 ,\n\n\u2212\u03bb1 < \u03bc < \u03bb1 ,\n\n\u03bb2 > \u2212\u03bb1 .\n\n(4.15)\n\nThis system is related to Euler's equations for the components p, q, r of the angular\nvelocity of an axially symmetric top, in presence of weak damping. More precisely,\nassume that the moment of the damping forces is a linear function of the angular\nvelocity, and that the linear operator expressing this dependence has a diagonal\nmatrix \u2212\u03b5 diag(E, F, G) in the reference system in which the inertia operator has\nthe form diag(A, A, C), with A, C, E, F, G, \u03b5 \u2208 (0, +\u221e) (6 ). Then, Euler's equations\nare\nA\u1e57 + (C \u2212 A)qr = \u2212\u03b5Ep ,\n\nAq\u0307 \u2212 (C \u2212 A)pr = \u2212\u03b5F q ,\n\nC \u1e59 = \u2212\u03b5Gr .\n\n(4.16)\n\nGiven this system, we define \u03bc, \u03bb1 , \u03bb2 through the equations\nE = A(\u03bc + \u03bb1 ) ,\n\nF = A(\u03bb1 \u2212 \u03bc) ,\n\nG = C(\u03bb1 + \u03bb2 ) ,\n\n(4.17)\n\nwhich imply the inequalities (4.15). Now, if (I, \u0398) = (I1 , I2 , \u0398) is such that \u0130 =\n\u03b5f (I, \u0398) and \u0398\u0307 = \u03c9(I) + \u03b5g(I, \u0398), the functions\np := I1 cos \u0398 ,\n\nq := I1 sin \u0398 ,\n\nr :=\n\nA\nI1 I2\nC\u2212A\n\n(4.18)\n\nfulfil Euler's equations (4.16).\nLet us return to (4.14). This implies\n\n6\n\nf (I) = (\u2212\u03bb1 I 1 , \u2212\u03bb2 I 2 ) ;\n\n(4.19)\n\nOf course, quantities like A, ..., G, the time t, etc., can be treated as real numbers, because we\nsuppose to have fixed all the necessary physical units.\n\n21\n\n\fthe functions s, ..., G , H are reported in Table 4. The averaged system has the\nsolution\nJi (\u03c4 ) = I0i e\u2212\u03bbi \u03c4\n(i = 1, 2)\n(4.20)\nfor \u03c4 \u2208 [0, +\u221e). Eq.s (2.10) (2.11) for the 2 \u00d7 2 matrix function R and for the\n2-component function K have the solutions\nR(\u03c4 ) = diag(e\u2212\u03bb1 \u03c4 , e\u2212\u03bb2 \u03c4 ) ,\n\nK(\u03c4 ) = (0, 0) .\n\n(4.21)\n\nFrom now on, \u03c4 is confined as usually to an interval [0, U). The functions \u03c1, a, ..., e\nfor this example are reported in Table 4; the length of the expressions of b, c is\nmainly due to the need for covering all possible values of \u03bb1 , \u03bb2 , \u03bc.\nComments on this example and the figures. In this case the main difficulty is the\nfact, following from (4.20) (4.15), that J1 (\u03c4 ) J2 (\u03c4 ) = I01 I02 e\u2212(\u03bb1 +\u03bb2 )\u03c4 is small for large\n\u03c4 . On the other hand, \u03c9(I) vanishes for I 1 I 2 \u2192 0, and in this limit many auxiliary\nfunctions diverge; so, the averaged system falls exponentially into a resonance.\nIn this situation one expects a rapid growth of |L|, which is in fact confirmed by\nFig.s 4a-4d; the same figures show that our estimator n(\u03c4 ) approximates well the\nenvelope of |L(\u03c4 /\u03b5)| on [0, U], when U is of the order of the unity. In Fig. 4d, a good\nagreement between |L(\u03c4 /\u03b5)| and |n(\u03c4 )| is attained on the longest interval among the\nfour pictures (namely, for \u03c4 \u2208 [0, 3)). This is because we take, simultaneously, the\nlargest value for I01 I02 and the lowest values for \u03b5 and \u03bb1 + \u03bb2 .\n\nTable 4. Auxiliary functions for Example 4.\nFor I = (I 1 , I 2 ) \u2208 (0, +\u221e)2, \u03b8 \u2208 T and \u03b4I = (\u03b4I 1 , \u03b4I 2 ) \u2208 (\u2212I 1 , +\u221e) \u00d7 (\u2212I 2 , +\u221e) :\n\u0012\n\u0013\n\u0012\n\u0013\n\u03bc\n1 1\n\u03bc\n1 1\n2\ns(I, \u03b8) = sin(2\u03b8) \u2212 2 , 1 ,\nv(I, \u03b8) = 1 2 sin \u03b8 \u2212 2 , 1 ,\n2\nI\nI\n2I I \u0013\nI I\n\u0012\n\u03bc sin(2\u03b8)\n\u03bb2 + \u03bc cos(2\u03b8) \u03bb1 + 3\u03bc cos(2\u03b8)\np(I) = (0, 0) ,\np(I, \u03b8) =\n\u2212\n,\n,\n2 \u0012\nI2\nI1\n\u0013\n\u03bc sin2 \u03b8\n2\u03bb2 + 2\u03bc + \u03bb1 + \u03bc cos(2\u03b8) \u03bb2 + 2\u03bc + 2\u03bb1 + 3\u03bc cos(2\u03b8)\nq(I, \u03b8) =\n\u2212\n,\n,\n2I 1 I 2\nI2\nI1\n22\n\n\f\u0012\n\u0013\n\u03bb2 + \u03bc cos2 \u03b8 \u03bb1 + 3\u03bc cos2 \u03b8\n\u03bc sin2 \u03b8\n\u03bc sin2 \u03b8\n\u2212\n,\nu(I,\n\u03b8)\n=\n,\n\u00d7\nw(I, \u03b8) =\n2I 1 I 2\nI2\nI1\n4 I 1I 2\n\u0010 4\u03bb2 + 6\u03bb \u03bc + 2\u03bb \u03bb + \u03bc\u03bb + \u03bc(4\u03bb + 3\u03bc + \u03bb ) cos(2\u03b8) + 3\u03bc2 cos2 (2\u03b8)\n2\n2 1\n1\n2\n1\n,\n\u00d7 \u2212 2\nI2\n3\u03bb2 \u03bc + 2\u03bb2 \u03bb1 + 10\u03bc\u03bb1 + 4\u03bb21 + 3\u03bc(\u03bb2 + 5\u03bc + 4\u03bb1 ) cos(2\u03b8) + 15\u03bc2 cos2 (2\u03b8) \u0011\n,\nI\u00121\n\u0013\n\u0013\n\u0012\n\u2202f\n\u2212\u03bb21\n0\n\u2212\u03bb1\n0\n, G (I, \u03b4I) = 0, H (I, \u03b4I) = 0 .\n, M (I) =\n(I) =\n0 \u2212\u03bb22\n0 \u2212\u03bb2\n\u2202I\nFor \u03c4 \u2208 [0, U), \u03c1(\u03c4 ) := min(J1 (\u03c4 ), J2 (\u03c4 )).\nFor \u03c4 \u2208 [0, U) and r \u2208 [0, J(\u03c4 )) :\n\u0012\n\u00131/2\n1\n1\n|\u03bc|\n+\na(\u03c4, r) :=\n;\n2 (J1 (\u03c4 ) \u2212 r)2 (J2 (\u03c4 ) \u2212 r)2\n\n\u00011/2\nb11 J1 (\u03c4 )2 + b22 J2 (\u03c4 )2 + b1 J1 (\u03c4 )r + b2 J2 (\u03c4 )r + b0 r 2\nb(\u03c4, r) := |\u03bc|\n,\n8(J1 (\u03c4 ) \u2212 r)2 (J2 (\u03c4 ) \u2212 r)2\nb11 := 16(\u03bb21 + \u03bb22 ) + \u03bb1 (12\u03bb2 + 20|\u03bb2 |) + 2(\u03bb1 + \u03bb2 )\u03bc + 4(\u03bb1 + |\u03bb2 |)|\u03bc| + \u03bc2 ,\nb22 := 16(\u03bb21 + \u03bb22 ) + \u03bb1 (12\u03bb2 + 20|\u03bb2 |) + 6(\u03bb1 + \u03bb2 )\u03bc + 12(\u03bb1 + |\u03bb2 |)|\u03bc| + 9\u03bc2 ,\nb1 := 32(\u03bb21 + \u03bb22 ) + 64\u03bb1 |\u03bb2 | + 12(\u03bb1 + |\u03bb2 |)|\u03bc| + 2\u03bc2 ,\nb2 := 32(\u03bb21 + \u03bb22 ) + 64\u03bb1 |\u03bb2 | + 36(\u03bb1 + |\u03bb2 |)|\u03bc| + 18\u03bc2 ,\nb0 := 16(\u03bb21 + \u03bb22 ) + \u03bb1 (12\u03bb2 + 20|\u03bb2 |) + 4(\u03bb1 + \u03bb2 )\u03bc + 14(\u03bb1 + |\u03bb2 |)|\u03bc| + 9\u03bc2 ;\n\u00011/2\nc11 J1 (\u03c4 )2 + c22 J2 (\u03c4 )2 + c1 J1 (\u03c4 )r + c2 J2 (\u03c4 )r + c0 r 2\nc(\u03c4, r) := |\u03bc|\n,\n32(J1 (\u03c4 ) \u2212 r)2 (J2 (\u03c4 ) \u2212 r)2\nc11 := 1024(\u03bb41 + \u03bb42 ) + 6144\u03bb21 \u03bb22 + 512(\u03bb21 + \u03bb22 )\u03bb1 (3\u03bb2 + 5|\u03bb2|) + 640(\u03bb31 + \u03bb32 )\u03bc+\n+896(\u03bb31 +|\u03bb2 |3 )|\u03bc|+1920(\u03bb1 +\u03bb2 )\u03bb1 \u03bb2 \u03bc+2688(\u03bb1 +|\u03bb2 |)\u03bb1 |\u03bb2 ||\u03bc|+704(\u03bb21 +\u03bb22 )\u03bc2 +\n+32\u03bb1 (17\u03bb2 + 27|\u03bb2|)\u03bc2 \u2212 24(\u03bb1 + \u03bb2 )\u03bc3 + 264(\u03bb1 + |\u03bb2 |)|\u03bc|3 + 27\u03bc4 ,\nc22 := 1024(\u03bb41 + \u03bb42 ) + 6144\u03bb21 \u03bb22 + 512(\u03bb21 + \u03bb22 )\u03bb1 (3\u03bb2 + 5|\u03bb2|) + 384(\u03bb31 + \u03bb32 )\u03bc+\n+1408(\u03bb31 +|\u03bb2 |3 )|\u03bc|+1152(\u03bb1 +\u03bb2 )\u03bb1 \u03bb2 \u03bc+4224(\u03bb1 +|\u03bb2 |)\u03bb1 |\u03bb2 ||\u03bc|+2816(\u03bb21 +\u03bb22 )\u03bc2 +\n+32\u03bb1 (21\u03bb2 + 155|\u03bb2|)\u03bc2 + 120(\u03bb1 + \u03bb2 )\u03bc3 + 1800(\u03bb1 + |\u03bb2 |)|\u03bc|3 + 675\u03bc4 ,\nc1 := 2048(\u03bb41 + \u03bb42 ) + 12288\u03bb21\u03bb22 + 8192(\u03bb21 + \u03bb22 )\u03bb1 |\u03bb2 | + 3072(\u03bb31 + |\u03bb2 |3 )|\u03bc|+\n+9216(\u03bb1 +|\u03bb2 |)\u03bb1 |\u03bb2 ||\u03bc|+1408(\u03bb21 +\u03bb22 )\u03bc2 +2816\u03bb1|\u03bb2 |\u03bc2 +576(\u03bb1 +|\u03bb2 |)|\u03bc|3 +54\u03bc4 ,\nc2 := 2048(\u03bb41 + \u03bb42 ) + 12288\u03bb21\u03bb22 + 8192(\u03bb21 + \u03bb22 )\u03bb1 |\u03bb2 | + 3584(\u03bb31 + |\u03bb2 |3 )|\u03bc|+\n+10752(\u03bb1 + |\u03bb2 |)\u03bb1 |\u03bb2 ||\u03bc| + 5632(\u03bb21 + \u03bb22 )\u03bc2 + 11264\u03bb1|\u03bb2 |\u03bc2 + 3840(\u03bb1 + |\u03bb2|)|\u03bc|3 +\n1350\u03bc4 ,\nc0 := 1024(\u03bb41 + \u03bb42 ) + 6144\u03bb21\u03bb22 + 512(\u03bb21 + \u03bb22 )\u03bb1 (3\u03bb2 + 5|\u03bb2 |) + 512(\u03bb31 + \u03bb32 )\u03bc+\n+2048(\u03bb31 +|\u03bb2 |3 )|\u03bc|+1536(\u03bb1 +\u03bb2 )\u03bb1 \u03bb2 \u03bc+6144(\u03bb1 +|\u03bb2 |)\u03bb1 |\u03bb2 ||\u03bc|+2816(\u03bb21 +\u03bb22 )\u03bc2 +\n+32\u03bb1 (19\u03bb2 + 157|\u03bb2|)\u03bc2 + 48(\u03bb1 + \u03bb2 )\u03bc3 + 1872(\u03bb1 + |\u03bb2 |)|\u03bc|3 + 675\u03bc4 ;\nd(\u03c4, r) := 0 ;\ne(\u03c4, r) := 0 .\n\n23\n\n\f1.4\n\n3.5\n\n1.2\n\n3\n\n1\n\n2.5\n\n0.8\n\n2\n\n0.6\n\n1.5\n\n0.4\n\n1\n\n0.2\n\n0.5\n\n4\n\n2\n\n6\n\n8\n\u22122\n\n10\n\n4\n\n2\n\nFigure 1a. I0 = 1/2, \u03b5 = 10 , U = 10.\nGraphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)|. TN = 0.062s,\nTL = 3.2s.\n\n6\n\n8\n\n10\n\n\u22122\n\nFigure 1b. I0 = 4, \u03b5 = 10 , U = 10.\nGraphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)|. TN = 0.078s,\nTL = 3.0s.\n\n3.5\n\n175\n3\n\n150\n2.5\n\n125\n\n2\n\n100\n\n1.5\n\n75\n\n1\n\n50\n\n0.5\n\n25\n50\n\n100\n\n150\n\u22122\n\n200\n\n0.2\n\nFigure 1c. I0 = 4, \u03b5 = 10 , U = 200.\nGraphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)|. TN = 0.45s,\nTL = 67s.\n\n0.4\n\n0.6\n\n0.8\n\u22122\n\nFigure 2a. \u03ba = 1,I0 = 1,\u03b5 = 10 ,U = 0.9.\nGraphs of n(\u03c4 ), |L(\u03c4 /\u03b5)| (note that J(\u03c4 ) \u2192\n+\u221e for \u03c4 \u2192 1\u2212 ). TN = 0.032s, TL = 0.36s.\n200\n\n2.5\n150\n\n2\n1.5\n\n100\n\n1\n50\n\n0.5\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.76 0.78\n\nFigure 2b. \u03ba = 1,I0 = 1,\u03b5 = 10\u22122 (as in\nFig.2a). Graphs of n(\u03c4 ), |L(\u03c4 /\u03b5)| in a detailed view, for \u03c4 \u2208 [0, 0.5].\n24\n\n0.82 0.84 0.86 0.88\n\n0.9\n\nFigure 2c. \u03ba = 1,I0 = 1,\u03b5 = 10\u22122 (as in\nFig.2a). Graphs of n(\u03c4 ), |L(\u03c4 /\u03b5)| in a detailed view, for \u03c4 \u2208 [0.75, 0.9].\n\n\f0.5\n\n0.005\n0.4\n\n0.004\n0.3\n\n0.003\n0.2\n\n0.002\n\n0.1\n\n0.001\n\n2\n\n4\n\n6\n\n8\n\u22122\n\n10\n\n120\n\nFigure 2d. \u03ba = \u22121,I0 = 1,\u03b5 = 10 ,U = 200.\nTN = 0.078s, TL = 0.58s. Graphs of n(\u03c4 ),\n|L(\u03c4 /\u03b5)| in a detailed view, for \u03c4 \u2208 [0, 10].\n\n1.5\n\n1.5\n\n1\n\n1\n\n0.5\n\n0.5\n\n6\n\n8\n\u22122\n\n10\n\n0.2\n\nFigure 3a. I0 = 1/2, \u03b5 = 10 , U = 10.\nGraphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)|. TN = 0.23s,\nTL = 0.95s.\n\n1.5\n\n1.5\n\n1\n\n1\n\n0.5\n\n0.5\n\n6\n\n8\n\u22123\n\n10\n\n0.2\n\nFigure 3c. I0 = 1/2, \u03b5 = 10 , U = 10.\nGraphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)|. TN = 0.23s,\nTL = 12s.\n25\n\n0.4\n\n0.6\n\n1\n\n0.8\n\nFigure 3b. I0 = 1/2, \u03b5 = 10 (as in\nFig.3a). Graphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)| in a\ndetailed view, for \u03c4 \u2208 [0, 1).\n2\n\n4\n\n200\n\n\u22122\n\n2\n\n2\n\n180\n\nFigure 2e. \u03ba = \u22121,I0 = 1,\u03b5 = 10 (as\nin Fig.2d). Graphs of n(\u03c4 ), |L(\u03c4 /\u03b5)| in a\ndetailed view, for \u03c4 \u2208 [100, 200].\n2\n\n4\n\n160\n\n\u22122\n\n2\n\n2\n\n140\n\n0.4\n\n0.6\n\n1\n\n0.8\n\u22123\n\nFigure 3d. I0 = 1/2, \u03b5 = 10 (as in\nFig.3c). Graphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)| in a\ndetailed view, for \u03c4 \u2208 [0, 1).\n\n\f0.5\n\n0.5\n\n0.4\n\n0.4\n\n0.3\n\n0.3\n\n0.2\n\n0.2\n\n0.1\n\n0.1\n\n2\n\n4\n\n6\n\n8\n\n10\n\n50\n\n\u22122\n\nFigure 3e. I0 = 2, \u03b5 = 10 , U = 10.\nGraphs of n(\u03c4 ) and |L(\u03c4 /\u03b5)|. TN = 0.16s,\nTL = 1.2s.\n\n100\n\n150\n\u22122\n\n200\n\nFigure 3f. I0 = 2, \u03b5 = 10 , U = 200.\nGraph of n(\u03c4 ). TN = 0.28s, TL > 240s.\n\n1.5\n\n1\n\n1.25\n\n0.8\n\n1\n0.6\n\n0.75\n0.4\n\n0.5\n0.2\n\n0.25\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n0.2\n\n\u22121, I01\n\nFigure 4a. \u03bc = 1, \u03bb1 = 2, \u03bb2 =\n= 4,\nI02 = 4, \u03b5 = 10\u22122, U = 1. Graphs of n(\u03c4 ) and\n|L(\u03c4 /\u03b5)|. TN = 0.047s, TL = 1.7s.\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n2, \u03bb2 = \u22121, I01\n\nFigure 4b. \u03bc = 1, \u03bb1 =\n= 4,\nI02 = 1, \u03b5 = 10\u22122, U = 1. Graphs of n(\u03c4 ) and\n|L(\u03c4 /\u03b5)|. TN = 0.047s, TL = 0.44s.\n\n1\n4\n\n0.8\n3\n\n0.6\n2\n\n0.4\n1\n\n0.2\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n0.5\n\n\u22121, I01\n\nFigure 4c. \u03bc = 1, \u03bb1 = 2, \u03bb2 =\n= 4,\n2\n\u22123\nI0 = 1, \u03b5 = 10 , U = 1. Graphs of n(\u03c4 ) and\n|L(\u03c4 /\u03b5)|. TN = 0.047s, TL = 4.2s.\n26\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n1\n\u03bc = 1, \u03bb1 = 1.1, \u03bb2 = \u22121, I0 = 4,\n\u22123\n\nFigure 4d.\nI02 = 4, \u03b5 = 10 , U = 3. Graphs of n(\u03c4 ) and\n|L(\u03c4 /\u03b5)|. TN = 0.046s, TL = 99s.\n\n\fA\n\nAppendix. Proof of Lemma 2.1.\n\nFirst of all, the Cauchy problem (2.10) has a (unique) solution on [0, U), and this\nis C m , because we have a linear differential equation for R, with a C m\u22121 matrix\n\u2202f\nfunction \u03c4 7\u2192\n(J(\u03c4 )). The invertibility of R(\u03c4 ) follows from the Wronskian identity\n\u2202I\nR\u03c4\n\u2202f\n(J(\u03c4 \u2032 )) and from the initial condition R(0) = 1d ;\ndet R(\u03c4 ) = det R(0) exp 0 d\u03c4 \u2032 tr\n\u2202I\nthe d = 1 expression of R is obvious. The statements on K that follow Eq. (2.11) are\nalso elementary (as for the C m regularity, note that p(J) is a C m\u22121 function of \u03c4 ).\nTo go on, we introduce the short-hand notations\nJ, R, K,\n\ndJ\ndJ\n, etc. \u2261 the functions t 7\u2192 J(\u03b5t) , R(\u03b5t) , K(\u03b5t) ,\n(\u03b5t) , etc. ;\nd\u03c4\nd\u03c4\n\n(A.1)\n\nin the same spirit, for h : \u039b \u00d7 T \u2192 Rd and k : \u039b \u2192 Rd we also intend\nh, k, k(J) \u2261 the functions t 7\u2192 h(I(t), \u0398(t)) , t 7\u2192 k(I(t)) , t 7\u2192 k(J(\u03b5t)) .\nIn these notations, one has L = (I \u2212 J)/\u03b5 and Eq.s (1.3) (1.6) imply\n\u0012\n\u0013\n1 dI\ndJ\ndL\n= f \u2212 f (J) ;\n=\n\u2212\u03b5\ndt\n\u03b5 dt\nd\u03c4\n\n(A.2)\n\n(A.3)\n\nwe continue dividing the argument in steps.\nStep 1. One has\ndL\n\u2202s\n\u2202f\n1\n=\u03c9\n+ \u03b5 (J) L + \u03b52 H (J, \u03b5L) L2 .\ndt\n\u2202\u03b8\n\u2202I\n2\n\n(A.4)\n\nIn fact, Eq. (A.3) and the first Eq. (2.8) imply\ndL\n\u2202s\n=\u03c9\n+ f \u2212 f (J) ;\ndt\n\u2202\u03b8\n\n(A.5)\n\nnow, it suffices to recall that I = J + \u03b5L and use Eq. (2.19) with (I, \u03b4I) replaced by\n(J, \u03b5L) .\nStep 2. For each function h \u2208 C 1 (\u039b \u00d7 T, Rd ), it is\n\u03c9\n\n\u0010 \u2202h\ndh\n\u2202h \u0011\n\u2202h\n=\n\u2212\u03b5\nf+\ng .\n\u2202\u03b8\ndt\n\u2202I\n\u2202\u03b8\n\n(A.6)\n\nThis follows easily from\n\u2202h dI \u2202h d\u0398\n\u2202h\n\u2202h\ndh\n=\n+\n=\u03b5 f+\n(\u03c9 + \u03b5g) .\ndt\n\u2202I dt \u2202\u03b8 dt\n\u2202I\n\u2202\u03b8\n27\n\n(A.7)\n\n\fStep 3. One has\n\u03c9\n\n\u2202s\nds\ndw\n=\n\u2212\u03b5\n\u2212 \u03b5p(J) + \u03b52 (u \u2212 G (J, \u03b5L)L) .\n\u2202\u03b8\ndt\ndt\n\n(A.8)\n\nTo prove this, we note that Eq. (A.6) with h = s and the definition (2.15) of p give\n\u03c9\n\nds\n\u2202s\n=\n\u2212 \u03b5p .\n\u2202\u03b8\ndt\n\n(A.9)\n\nOn the other hand, Eq.s (2.16) (A.6) with h = w and the definition (2.17) of u imply\np=p+\u03c9\n\n\u2202w\ndw\n=p+\n\u2212 \u03b5u ;\n\u2202\u03b8\ndt\n\n(A.10)\n\nfurthermore, Eq. (2.18) with (I, \u03b4I) replaced by (J, \u03b5L) gives\np = p(J) + \u03b5 G (J, \u03b5L) L .\n\n(A.11)\n\nInserting Eq. (A.11) into (A.10), and the result into (A.9), we get the equality (A.8).\nStep 4. One has\n\u2202f\nds\ndw\n1\ndL\n\u2212 \u03b5 (J)L =\n\u2212\u03b5\n\u2212 \u03b5p(J) + \u03b52 (u \u2212 G (J, \u03b5L)L + H (J, \u03b5L)L2 ) . (A.12)\ndt\n\u2202I\ndt\ndt\n2\nThis follows immediately from Eq. (A.4) and from the equality (A.8).\nIntroducing the next steps. Eq. (A.12) is an equality involving total derivatives,\nand nonderivative terms proportional to \u03b5 or \u03b52 . Our aim is to obtain an equality\nfor L involving only total derivatives and nonderivative terms proportional to \u03b52 ;\ndue to the structure of the terms in \u03b5 of Eq. (A.12), this result can be achieved\nusing the functions R and K. In the sequel we will derive some identities involving\nR, where the operator R(d/dt)R\u22121 plays a major role; inserting these relations into\nEq. (A.12) (and factoring out R) we will finally obtain an identity with the desired\nstructure, where the nonderivative terms are confined to the order \u03b52 .\nStep 5. One has\ndR\u22121\n\u2202f\n= \u2212\u03b5R\u22121 (J) .\n(A.13)\ndt\n\u2202I\nFor each C 1 function X : [0, U/\u03b5) \u2192 Rd , t 7\u2192 X(t), this implies\n\u2202f\nd\ndX\n\u2212 \u03b5 (J)X = R (R\u22121 X) .\ndt\n\u2202I\ndt\n\n(A.14)\n\nEq. (A.13) follows from the relation\n0=\n\ndR \u22121\ndR\u22121\n\u2202f\ndR\u22121\nd\n(RR\u22121 ) =\nR +R\n= \u03b5 (J) + R\n,\ndt\ndt\ndt\n\u2202I\ndt\n28\n\n(A.15)\n\n\fwhere, in the last passage, we have used Eq. (2.10) to express dR/dt = \u03b5dR/d\u03c4 .\nHaving extablished (A.13), we consider any function X as above and note that\n\u2202f\ndX\ndR\u22121\ndX dR\u22121\ndX\n\u2212 \u03b5 (J)X =\n+R\nX = R(R\u22121 +\nX) ,\ndt\n\u2202I\ndt\ndt\ndt\ndt\n\n(A.16)\n\nwhence Eq. (A.14).\nStep 6. One has\ndL\n\u2202f\nd\n\u2212 \u03b5 (J)L = R (R\u22121 L) ,\ndt\n\u2202I\ndt\n\n\u03b5\n\ndw\nd\n\u2202f\n= \u03b5R (R\u22121 w) + \u03b52 (J)w ,\ndt\ndt\n\u2202I\n\nd\n\u03b5p(J) = R (R\u22121 K)\ndt\n\u0012\n\u0013\nd\nd \u22121 \u0001\n\u2202f\nds\n\u22121 \u2202f\nR s + \u03b5R\nR\n=R\n(J)v \u2212 \u03b52 (M (J)v +\n(J)q) ,\ndt\ndt\ndt\n\u2202I\n\u2202I\n\n(A.17)\n(A.18)\n(A.19)\n\n(note that the right hand sides of Eq.s (A.17-A.19) all appear in Eq. (A.12)).\nEq.s (A.17) are mere applications of the general identity (A.14) with X = L and\nX = w (i.e., the function w(I, \u0398)), respectively. Eq. (A.18) follows writing (A.14)\nwith X = K, and expressing dK/dt = \u03b5dK/d\u03c4 via Eq. (2.11) . The derivation of Eq.\n(A.19) is a bit longer. First of all, from Eq. (A.14) with X = s we infer\nds\nd\n\u2202f\n= R (R\u22121 s) + \u03b5 (J)s ;\ndt\ndt\n\u2202I\n\n(A.20)\n\n\u2202f\n(J)s as R\u00d7 a total derivative, plus terms of the first\n\u2202I\norder in \u03b5. To this purpose, we write s in terms of v via Eq. (2.14), and then use\nEq. (A.6) with h = v; this gives\n\nto continue, we will reexpress\n\n\u0010 \u2202v\n\u2202v\ndv\n\u2202v \u0011 dv\ns=\u03c9\n=\n\u2212\u03b5\nf+\ng =\n\u2212 \u03b5q ,\n\u2202\u03b8\ndt\n\u2202I\n\u2202\u03b8\ndt\n\n(A.21)\n\nthe last passage following from the definition (2.15) of q. This implies\n\u0012\n\u0012\n\u0013\n\u0013\n\u2202f\n\u2202f\ndv\n\u2202f\nd \u2202f\nd \u2202f\n\u2202f\n(J)s =\n(J) \u2212\u03b5 (J)q =\n(J)v \u2212\n(J) v\u2212\u03b5\n(J)q . (A.22)\n\u2202I\n\u2202I\ndt\n\u2202I\ndt \u2202I\ndt \u2202I\n\u2202I\n\u2202f\n(J) v and Eq. (1.6) give, respectively,\n\u2202I\n\u0012\n\u0012\n\u0013\n\u0013\n\u0012\n\u00132\nd \u2202f\nd\n\u2202f\n\u22121 \u2202f\nR\n(J) v = R\n(J) v + \u03b5\n(J) v ;\n(A.23)\ndt \u2202I\ndt\n\u2202I\n\u2202I\n\nOn the other hand, Eq. (A.14) with X =\n\n29\n\n\fd\ndt\n\n\u0012\n\n\u2202f\n(J)\n\u2202I\n\n\u0013\n\n=\n\n\u22022f\ndJ\n\u22022f\n(J)\n=\n\u03b5\n(J) f (J) .\n\u2202I 2\ndt\n\u2202I 2\n\n(A.24)\n\nSubstituting Eq.s (A.23-A.24) into (A.22), and recalling the definition (2.17) of M ,\nwe finally get\n\u0012\n\u0012\n\u0013\n\u0013\n\u2202f\nd\n\u2202f\n\u22121 \u2202f\n2\nR\n(J) v \u2212 \u03b5 M (J) v +\n(J) q ;\n(A.25)\n\u03b5 (J)s = \u03b5R\n\u2202I\ndt\n\u2202I\n\u2202I\ninserting this result into Eq. (A.20), we obtain the desired relation (A.19).\nStep 7. One has\nd \u22121\nd\n\u2202f\nd \u22121\n(R L) =\n(R (s \u2212 K)) \u2212 \u03b5 ( R\u22121 (w \u2212\n(J)v) )+\ndt\ndt\ndt\n\u2202I\n+\u03b52 R\u22121 ( u \u2212\n\n(A.26)\n\n\u2202f\n1\n(J)(w + q) \u2212 M (J)v \u2212 G (J, \u03b5L)L + H (J, \u03b5L)L2 ) .\n\u2202I\n2\n\n\u2202f\n(J)L, ds/dt, \u03b5dw/dt,\n\u2202I\n\u03b5p(J) via Eq.s (A.17-A.18). Multiplying both sides by R\u22121 , we obtain Eq. (A.26).\nStep 8. Conclusion of the proof. We integrate Eq. (A.26) from 0 to t, explicitating\nthe dependence of all objects on I, \u0398, J, t and taking into account the initial conditions for I, \u0398, J, R, K, as well as the relations L(0) = 0, v(I, \u03b80 ) = w(I, \u03b80 ) = 0. This\ngives an expression for R\u22121 (\u03b5t) L(t): multiplying by R(\u03b5t), we get the thesis (2.13).\n\nTo prove this, we return to (A.12) and reexpress dL/dt \u2212 \u03b5\n\nB\n\nAppendix. Proof of Lemma 2.3.\n\nAs anticipated, we are inspired by the proof of a similar statement in [5] (see Chapter\nXII, \u00a7 23, Theorem 1); therefore we merely sketch the argument. Let us define\nT := {t1 \u2208 (0, T ) | l(t) < v(t) for all t \u2208 [0, t1 ) } ,\n\nT1 := sup T .\n\n(B.1)\n\n(Note that (2.34) and (2.33) give v(0) > \u03be(0, v(0)) > 0 = l(0); so, by continuity, T\nis nonempty). In the sequel we will assume T1 < T , and infer a contradiction.\nFrom (B.1), it is clear that l(T1 ) 6 v(T1 ). We cannot have l(T1 ) < v(T1 ) since this,\nby continuity, would be against the definition of T1 ; thus\nl(T1 ) = v(T1 ) .\n\n(B.2)\n\nOn the other hand, the assumptions of the Lemma and (B.2) imply\nl(T1 ) 6(1) \u03be(T1 , l(T1 ))+\n\nZ\n\nT1\n\u2032\n\n\u2032\n\n\u2032\n\ndt \u03b7(T1 , t , l(t )) =(2) \u03be(T1 , v(T1 ))+\n\n0\n\nZ\n\n0\n\n30\n\nT1\n\ndt\u2032 \u03b7(T1 , t\u2032 , l(t\u2032 )) 6\n\n\f6(3) \u03be(T1 , v(T1 )) +\n\nZ\n\nT1\n\ndt\u2032 \u03b7(T1 , t\u2032 , v(t\u2032 )) <(4) v(T1 ) ,\n\n(B.3)\n\n0\n\nwhich gives again a contradiction. (For better clarity: the relations (1)(2)(3)(4)\nfollow, respectively, from (2.33), (B.2), the monotonicity of \u03b7 and (2.34)).\n\nC\n\nAppendix. Proof of Proposition 2.5.\n\nWe begin with a Lemma; this holds under the same assumptions written at the\nbeginning of paragraph 2E, before stating Proposition 2.4.\nC.1 Lemma. Assume that there is a family of functions n\u03b4 \u2208 C([0, U\u03b4 ), (0, +\u221e)),\nlabelled by a parameter \u03b4 \u2208 (0, \u03b4\u2217 ], such that the following holds:\ni) U\u03b4 \u2192 U for \u03b4 \u2192 0+ ;\nii) for all \u03b4 \u2208 (0, \u03b4\u2217 ] and \u03c4 \u2208 [0, U\u03b4 ), it is\nn\u03b4 (\u03c4 ) < \u03c1(\u03c4 )/\u03b5 ,\nZ \u03c4\nn\u03b4 (\u03c4 ) = \u03b4 + \u03b1(\u03c4, \u03b5n\u03b4 (\u03c4 )) + \u03b5|R(\u03c4 )|\nd\u03c4 \u2032 |R\u22121 (\u03c4 \u2032 )| \u03b3(\u03c4 \u2032 , \u03b5n\u03b4 (\u03c4 \u2032 ), n\u03b4 (\u03c4 \u2032 )) ;\n\n(C.1)\n(C.2)\n\n0\n\niii) for each fixed \u03c4 \u2208 [0, U), the limit n(\u03c4 ) := lim\u03b4\u21920+ n\u03b4 (\u03c4 ) exists in [0, +\u221e) (note\nthat \u03c4 \u2208 [0, U\u03b4 ) for sufficiently small \u03b4, due to i)).\nThen the solution (I, \u0398) of the perturbed system exists on [0, U/\u03b5) and\n|L(t)| 6 n(\u03b5t)\n\nfor all t \u2208 [0, U/\u03b5).\n\n(C.3)\n\nProof. Of course, ii) implies\nn\u03b4 (\u03c4 ) > \u03b1(\u03c4, \u03b5n\u03b4 (\u03c4 )) + \u03b5|R(\u03c4 )|\n\nZ\n\n0\n\n\u03c4\n\nd\u03c4 \u2032 |R\u22121 (\u03c4 \u2032 )| \u03b3(\u03c4 \u2032 , \u03b5n\u03b4 (\u03c4 \u2032 ), n\u03b4 (\u03c4 \u2032 ))\n\n(C.4)\n\nfor all \u03b4 \u2208 (0, \u03b4\u2217 ] and \u03c4 \u2208 [0, U\u03b4 ). Therefore, Proposition 2.4 can be applied to the\nfunction n\u03b4 on the interval [0, U\u03b4 ); this implies that (I, \u0398) exists on [0, U\u03b4 /\u03b5), and\n|L(t)| < n\u03b4 (\u03b5t)\n\nfor all t \u2208 [0, U\u03b4 /\u03b5).\n\nNow, sending \u03b4 to zero and using iii) we easily obtain the thesis.\n\n(C.5)\n\u22c4\n\nWe now pass to Proposition 2.5. So, we have the assumptions at the beginning of\nparagraph 2E, strengthened by the smoothness requirements (2.45) for a, b, c, d, e .\nProof of Proposition 2.5. For the sake of brevity, we put\n\u03b10 : \u03a3 \u2192 R,\n\nl 7\u2192 \u03b10 (l) := \u03b1(0, \u03b5l)\n31\n\n(C.6)\n\n\fand extend this definition to any \u03b4 > 0 setting\n\u03b1\u03b4 : \u03a3 \u2192 R ,\n\nl 7\u2192 \u03b1\u03b4 (l) := \u03b10 (l) + \u03b4 .\n\n(C.7)\n\nWe proceed in several steps.\nStep 1. For each \u03b4 > 0, \u03b1\u03b4 is a contractive map. In fact, for all l, l\u2032 \u2208 \u03a3, we have\n|\u03b1\u03b4 (l) \u2212 \u03b1\u03b4 (l\u2032 )| = \u03b5\n\n\u2202\u03b1\n(0, \u03b5l) |l \u2212 l\u2032 | 6 \u03b5M|l \u2212 l\u2032 | .\n\u2202r\n\n(C.8)\n\nBut \u03b5M < 1 by the first inequality (2.47), so the thesis is proved.\nStep 2. There is \u03b4\u2217 > 0 such that, for all \u03b4 \u2208 [0, \u03b4\u2217 ], \u03b1\u03b4 sends \u03a3 into itself. In fact,\nfor any \u03b4 > 0 and l \u2208 \u03a3,\n|\u03b1\u03b4 (l) \u2212 l\u2217 | = |\u03b10 (l) + \u03b4 \u2212 l\u2217 | 6 |\u03b10 (l) \u2212 \u03b10 (l\u2217 )| + |\u03b10 (l\u2217 ) \u2212 l\u2217 | + \u03b4 6\n6 \u03b5M|l \u2212 l\u2217 | + |\u03b10 (l\u2217 ) \u2212 l\u2217 | + \u03b4 6 \u03b5M\u03c3 + |\u03b10 (l\u2217 ) \u2212 l\u2217 | + \u03b4 ,\n\n(C.9)\n\nwhere the second inequality follows from Eq. (C.8) with \u03b4 = 0. Now, let us define\n\u03b4\u2217 := (1 \u2212 \u03b5M)\u03c3 \u2212 |\u03b10 (l\u2217 ) \u2212 l\u2217 | ,\n\n(C.10)\n\nand note that \u03b4\u2217 > 0 by (2.48). For \u03b4 \u2208 [0, \u03b4\u2217 ] and l \u2208 \u03a3, Eq.s (C.9), (C.10) imply\n|\u03b1\u03b4 (l) \u2212 l\u2217 | 6 \u03c3, i.e., \u03b1\u03b4 (l) \u2208 \u03a3.\nStep 3. For all \u03b4 \u2208 [0, \u03b4\u2217 ], the map \u03b1\u03b4 has a unique fixed point l\u03b4 \u2208 \u03a3, which\ndepends continuously on \u03b4. Existence and uniqueness of the fixed point follows\nfrom the Banach theorem on contractions; to prove continuity we note that, for all\n\u03b4, \u03b4 \u2032 \u2208 [0, \u03b4\u2217 ],\n|l\u03b4 \u2212 l\u03b4\u2032 | = |\u03b1\u03b4 (l\u03b4 ) \u2212 \u03b1\u03b4\u2032 (l\u03b4\u2032 )| = |\u03b10 (l\u03b4 ) + \u03b4 \u2212 \u03b10 (l\u03b4\u2032 ) \u2212 \u03b4 \u2032 | 6\n\n(C.11)\n\n6 |\u03b10 (l\u03b4 ) \u2212 \u03b10 (l\u03b4\u2032 )| + |\u03b4 \u2212 \u03b4 \u2032 | 6 \u03b5M|l\u03b4 \u2212 l\u03b4\u2032 | + |\u03b4 \u2212 \u03b4 \u2032 | ,\nthe last inequality depending on (C.8) with \u03b4 = 0. This implies\n|l\u03b4 \u2212 l\u03b4\u2032 | 6\n\n|\u03b4 \u2212 \u03b4 \u2032 |\n;\n1 \u2212 \u03b5M\n\n(C.12)\n\nso the map \u03b4 7\u2192 l\u03b4 is Lipschitz, and a fortiori continuous.\nStep 4. Proving the thesis of i). This follows from Step 3, with \u03b4 = 0.\nStep 5. Proving the thesis of ii). For any \u03b4 \u2208 [0, \u03b4\u2217 ], let l\u03b4 be as in Step 3. From the\nstandard continuity theorems for the solutions of a parameter-dependent Cauchy\nproblem, we know that there is a family (U\u03b4 , m\u03b4 , n\u03b4 )\u03b4\u2208(0,\u03b4\u2217 ] with the following properties a) b):\n\n32\n\n\fa) for all \u03b4 \u2208 (0, \u03b4\u2217 ], it is m\u03b4 , n\u03b4 \u2208 C 1 ([0, U\u03b4 ), R); furthermore, these functions fulfil\nthe equations\ndm\u03b4\n= |R\u22121 |\u03b3(*, \u03b5n\u03b4 , n\u03b4 ) ,\nm\u03b4 (0) = 0 ,\n(C.13)\nd\u03c4\n\u0013\n\u0011\u22121 \u0012 \u2202\u03b1\ndn\u03b4 \u0010\n\u2202\u03b1\ndR \u0001\n\u22121\n\u22121\nm\u03b4 ,\n= 1\u2212\u03b5\n(*, \u03b5n\u03b4 )\n(*, \u03b5n\u03b4 ) + \u03b5|R||R | \u03b3(*, \u03b5n\u03b4 , n\u03b4 ) + \u03b5|R|\nR\u2022\nd\u03c4\n\u2202r\n\u2202\u03c4\nd\u03c4\nn\u03b4 (0) = l\u03b4\n\n(C.14)\n\nwith the domain conditions\n0 < n\u03b4 < \u03c1/\u03b5 ,\n\n\u2202\u03b1\n(*, \u03b5n\u03b4 ) < 1/\u03b5 .\n\u2202r\n\n(C.15)\n\nb) One has\nU\u03b4 \u2192\u03b4\u21920+ U, n\u03b4 (t) \u2192\u03b4\u21920+ n(t), m\u03b4 (t) \u2192\u03b4\u21920+ m(t) for all t \u2208 [0, U),\n\n(C.16)\n\nwhere m, n are as stated in ii).\nLet us consider the pair m\u03b4 , n\u03b4 for any \u03b4 \u2208 (0, \u03b4\u2217 ]. Then, integrating (C.13),\nZ \u03c4\nm\u03b4 (\u03c4 ) =\nd\u03c4 \u2032 |R\u22121 (\u03c4 \u2032 ) |\u03b3(\u03c4 \u2032 , \u03b5n\u03b4 (\u03c4 \u2032 ), n\u03b4 (\u03c4 \u2032 ))\nfor \u03c4 \u2208 [0, U\u03b4 ).\n(C.17)\n0\n\nFurthermore, from Eq. (C.14) we infer\n\u0013\n\u0011 dn \u0012 \u2202\u03b1\n\u0010\ndR \u0001\n\u2202\u03b1\n\u03b4\n\u22121\n\u22121\nm\u03b4 =\n\u2212\n(*, \u03b5n\u03b4 ) + \u03b5|R||R | \u03b3(*, \u03b5n\u03b4 , n\u03b4 ) + \u03b5|R|\nR\u2022\n0 = 1\u2212\u03b5 (*, \u03b5n\u03b4 )\n\u2202r\nd\u03c4\n\u2202\u03c4\nd\u03c4\n\u0012\n\u0013\n\u0011 dn\n\u0010\n\u2202\u03b1\ndm\u03b4\nd|R|\n\u2202\u03b1\n\u03b4\n\u2212\n(*, \u03b5n\u03b4 ) + \u03b5|R|\n+\u03b5\nm\u03b4 ;\n(C.18)\n= 1 \u2212 \u03b5 (*, \u03b5n\u03b4 )\n\u2202r\nd\u03c4\n\u2202\u03c4\nd\u03c4\nd\u03c4\nthe\n\u221a last passage depends on Eq. (C.13) for m\u03b4 , and from the identity d|R|/d\u03c4 =\nd R \u2022 R/d\u03c4 = |R|\u22121 (R \u2022 dR/d\u03c4 ). The result (C.18) can be rephrased as\n0=\n\nd\n(n\u03b4 \u2212 \u03b1(*, \u03b5n\u03b4 ) \u2212 \u03b5|R|m\u03b4 ) ;\nd\u03c4\n\n(C.19)\n\nthe constant value of the above function can be computed setting \u03c4 = 0, and is\nn\u03b4 (0) \u2212 \u03b1(0, \u03b5n\u03b4 (0)) = l\u03b4 \u2212 \u03b1(0, \u03b5l\u03b4 ) = l\u03b4 \u2212 \u03b10 (l\u03b4 ) = \u03b4\n\n(C.20)\n\n(recall the initial condition in (C.14), Eq.s (C.6) (C.7) and Step 3, giving l\u03b4 =\n\u03b1\u03b4 (l\u03b4 ) = \u03b10 (l\u03b4 ) + \u03b4). Therefore,\nn\u03b4 (\u03c4 ) \u2212 \u03b1(\u03c4, \u03b5n\u03b4 (\u03c4 )) \u2212 \u03b5|R(\u03c4 )| m\u03b4 (\u03c4 ) = \u03b4\n\nfor \u03c4 \u2208 [0, U\u03b4 ) .\n\n(C.21)\n\nFrom Eq.s (C.21) and (C.17), we see that n\u03b4 fulfils Eq. (C.2) of Lemma C.1. Due to\nEq. (C.16) on the limit for \u03b4 \u2192 0+ , from Lemma C.1 we finally obtain the thesis. \u22c4\n33\n\n\fD\n\nAppendix. The functions a of the examples.\n\nExample 1. One must determine a function fulfilling Eq. (2.23) for \u03c4 \u2208 [0, U),\n\u03b4J \u2208 (\u2212J(\u03c4 ), J(\u03c4 )) and \u03b8 \u2208 T. Neither K nor R (nor the initial datum) play a\nsignificant role in this computation, since K = 0, s(I0 , \u03b80 ) = 0 and R(\u03c4 ) appears in\nEq. (2.23) as a multiplier for the second of these vanishing terms. In conclusion, to\nobtain a we can simply bind |s(J(\u03c4 ) + \u03b4J, \u03b8)| in terms of J(\u03c4 ) and r := |\u03b4J|.\nConsider any point I \u2208 \u039b; of course,\n\u0012\n\u00131/2\n2\nmax |s(I, \u03b8)| = max s (I, \u03b8)\n.\n(D.1)\n\u03b8\u2208T\n\n\u03b8\u2208T\n\nDerivating with respect\nto \u03b8, one finds that the maximum of s2 is attained for\n\u221a\ncos2 \u03b8 = 1/2 + (1 \u2212 1 + 2I 2 )/(4I); by elementary computations, this gives\nmax |s(I, \u03b8)| = a(I) ,\n\u03b8\u2208T\n\n(D.2)\n\nwhere a is the C \u221e , strictly increasing function given by\n\u00011/2\n1\na : (0, +\u221e) \u2192 (0, +\u221e) , I 7\u2192 a(I) :=\n\u2212 2 + 10I 2 + I 4 + 2(1 + 2I 2 )3/2\n. (D.3)\n8\nLet \u03c4 \u2208 [0, U), \u03b4J \u2208 (\u2212J(\u03c4 ), J(\u03c4 )), \u03b8 \u2208 T and r := |\u03b4J|. Then,\n|s(J(\u03c4 ) + \u03b4J, \u03b8)| 6 a(J(\u03c4 ) + \u03b4J) 6 a(J(\u03c4 ) + r) ;\n\n(D.4)\n\nthe last term above is just the function a(\u03c4, r) of Table 1.\nExample 2. We refer again to Eq. (2.23); as in the previous example, R(\u03c4 ) plays\nno role, since it appears in Eq. (2.24) as a multiplier for the term s(I0 , \u03b80 ) = 0. A\nsimple computation gives\n\u03ba\n|s(J(\u03c4 ) + \u03b4J, \u03b8) \u2212 K(\u03c4 )| = | \u2212 (J(\u03c4 ) + \u03b4J) sin(2\u03b8) \u2212 K(\u03c4 )| 6\n(D.5)\n2\n1\n1\n6 (J(\u03c4 ) + |\u03b4J|) + |K(\u03c4 )| = (J(\u03c4 ) + |\u03b4J|) \u2212 K(\u03c4 ) ;\n2\n2\nthis means that Eq. (2.23) is fulfilled by the function a in the Table 2.\nExample 3. Again, R and K play no role in the analysis of Eq. (2.23) and it suffices\nto bind |s(J(\u03c4 ) + \u03b4J, \u03b8)| in terms of r := |\u03b4J|. Clearly,\n1\n1\n|s(J(\u03c4 ) + \u03b4J, \u03b8)| 6\n6\n;\n(D.6)\n|J(\u03c4 ) + \u03b4J|\nJ(\u03c4 ) \u2212 r\n\ntherefore, Eq. (2.23) is fulfilled by the function of Table 3.\nExample 4. In the left hand side of Eq. (2.23), the terms K(\u03c4 ) and s(I0 , \u03b80 ) are\nzero; so, to find a we must bind |s(J(\u03c4 ) + \u03b4J, \u03b8)| in terms of r := |\u03b4J|. Maximization\nwith respect to \u03b8 can be done analytically; as a final result, Eq. (2.23) is fulfilled\nby the function a in Table 4.\nIn each example, the function a determined as above gives an accurate bound on\nthe left hand side of Eq. (2.23).\n34\n\n\fE\n\nAppendix. The functions b, c of the examples.\n\ni) In comparison with a, the functions b, c, d, e in Eq.s (2.24\u20132.27) can be constructed\nusing rougher majorizations, see the comments in paragraph 3A. Here we fix the\nattention on b and c, since the functions d, e of the examples are obtained trivially.\nii) In all the examples, to find b and c we must essentially derive a majorant for an\nexpressions of the form h(J(\u03c4 ), \u03b4J, \u03b8), where h(J, \u03b4J, \u03b8) is a trigonometric polynomial\nin \u03b8, whose coefficients are polynomials in J and \u03b4J. The majorant should depend\nonly on J(\u03c4 ) and |\u03b4J|; so, the problem is reduced to finding a function k such that\nh(J, \u03b4J, \u03b8) 6 k(J, r)\n\nfor \u03b8 \u2208 T and r := |\u03b4J| .\n\n(E.1)\n\nLet us exemplify this situation in the construction of b; computations for c are quite\nsimilar.\n\u00012\n\u2202f\n(J(\u03c4 )) v(J(\u03c4 ) + \u03b4J, \u03b8) ,\nExample 1. To find b we can bind w(J(\u03c4 ) + \u03b4J, \u03b8) \u2212\n\u2202I\nwhich has the form h(J(\u03c4 ), \u03b4J, \u03b8) with h a polynomial as above; the square root of\nthe majorant k(J(\u03c4 ), r) is b(\u03c4, r).\nExample 2. This computation is very similar to the one for Example 1.\nExample 3. The left hand side of Eq. (2.24) is\n\u2202f\n(J(\u03c4 ))v(J(\u03c4 ) + \u03b4J, \u03b8)| =\n\u2202I\n3 \u2212 4 cos \u03b8 + cos(2\u03b8)\n2\n2\n=\n6\n6\n3\n3\n4(J(\u03c4 ) + \u03b4J)\n(J(\u03c4 ) + \u03b4J)\n(J(\u03c4 ) \u2212 r)3\n|w(J(\u03c4 ) + \u03b4J, \u03b8) \u2212\n\n(E.2)\n.\nr=|\u03b4J|\n\nExample 4. In this case,\n|w(J(\u03c4 ) + \u03b4J, \u03b8) \u2212\n\nh(J(\u03c4 ), \u03b4J, \u03b8)\n\u2202f\n(J(\u03c4 )) v(J(\u03c4 ) + \u03b4J, \u03b8)|2 = 1\n(E.3)\n\u2202I\n(J (\u03c4 ) + \u03b4J 1 )4 (J2 (\u03c4 ) + \u03b4J 2 )4\n\nwith h a polynomial as before. After finding for h a bound of the form (E.1), we\ncombine it with the obvious relation (Ji (\u03c4 ) + \u03b4J i )\u22124 6 (Ji (\u03c4 ) \u2212 r)\u22124 for r := |\u03b4J|;\nthe square root of the final majorant is b(\u03c4, r).\niii) Up to now, we have not explained how to get elementary bounds of the form\n(E.1) on a polynomial h. Here we illustrate a general procedure (computations to\napply it in Examples 1-4 are generally too tedious to be made by hand, but are\neasily implemented on MATHEMATICA).\niii a) In the expression of h(J, \u03b4J, \u03b8), if d = 1 we put \u03b4J = r cos \u03c8 with \u03c8 = 0 or \u03c0;\nif d = 2, we set \u03b4J = (r cos \u03c8, r sin \u03c8) with \u03c8 \u2208 T.\niii b) Now, h(J, \u03b4J, \u03b8) has the form of a trigonometric polynomial in \u03b8, \u03c8 with\ncoefficients depending on J. We write this in a canonical form, reexpressing any\nterm in \u03b8 and \u03c8 as a linear combination of sines and cosines (e.g., cos4 \u03b8 sin(2\u03b8)2 =\n(1/32)(5 + 4 cos(2\u03b8) \u2212 4 cos(4\u03b8) \u2212 4 cos(6\u03b8) \u2212 cos(8\u03b8)).\niii c) As a final step, we bind each summand of h using the relations | cos |, | sin | 6 1.\n35\n\n\fAcknowledgments. We gratefully acknowledge the anonymous referees for useful\nsuggestions about the style and organization of the paper.\nThis work has been partially supported by the GNFM of Istituto Nazionale di Alta\nMatematica and by MIUR, Research Project Cofin/2004 \"Metodi geometrici nella\nteoria delle onde non lineari e applicazioni\".\n\nReferences\n[1] V.I. Arnold, Mathematical methods of classical mechanics, Springer-Verlag,\nNew York (1978).\n[2] V.I. Arnold, Geometrical methods in the theory of ordinary differential equations, Springer-Verlag, New York (1983).\n[3] N.N. Bogoliubov, Y.A. Mitropolski, Asymptotic methods in the theory of nonlinear oscillations, Gordon and Breach, New York (1961).\n[4] P. Lochak, C. Meunier, Multiphase averaging for classical systems, SpringerVerlag, New York (1988).\n[5] D.S. Mitrinovic, J.E. Pecaric, A.M. Fink, Inequalities involving functions and\ntheir integrals and derivatives, Kluwer, Dordrecht (1991).\n[6] C.Morosi, L.Pizzocchero, On approximate solutions of semilinear evolution\nequations, Rev.Math.Phys. 16, 383-420 (2004).\n[7] J.A. Sanders, F. Verhulst, Averaging methods in nonlinear dynamical systems,\nSpringer-Verlag, New York (1985).\n[8] D.R. Smith, Singular perturbation theory, Cambridge Univ. Press, Cambridge\n(1985).\n[9] E. Zeidler, Non linear functional analysis and its applications II/B. Nonlinear\nmonotone operators, Springer-Verlag, New York (1990).\n\n36\n\n\f"}