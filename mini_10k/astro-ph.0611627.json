{"id": "http://arxiv.org/abs/astro-ph/0611627v1", "guidislink": true, "updated": "2006-11-20T15:01:03Z", "updated_parsed": [2006, 11, 20, 15, 1, 3, 0, 324, 0], "published": "2006-11-20T15:01:03Z", "published_parsed": [2006, 11, 20, 15, 1, 3, 0, 324, 0], "title": "Optimising Optimal Image Subtraction", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0611578%2Castro-ph%2F0611771%2Castro-ph%2F0611938%2Castro-ph%2F0611300%2Castro-ph%2F0611565%2Castro-ph%2F0611189%2Castro-ph%2F0611761%2Castro-ph%2F0611900%2Castro-ph%2F0611498%2Castro-ph%2F0611907%2Castro-ph%2F0611584%2Castro-ph%2F0611711%2Castro-ph%2F0611747%2Castro-ph%2F0611513%2Castro-ph%2F0611451%2Castro-ph%2F0611537%2Castro-ph%2F0611529%2Castro-ph%2F0611702%2Castro-ph%2F0611084%2Castro-ph%2F0611525%2Castro-ph%2F0611874%2Castro-ph%2F0611785%2Castro-ph%2F0611235%2Castro-ph%2F0611434%2Castro-ph%2F0611776%2Castro-ph%2F0611156%2Castro-ph%2F0611018%2Castro-ph%2F0611463%2Castro-ph%2F0611775%2Castro-ph%2F0611096%2Castro-ph%2F0611614%2Castro-ph%2F0611124%2Castro-ph%2F0611433%2Castro-ph%2F0611798%2Castro-ph%2F0611405%2Castro-ph%2F0611547%2Castro-ph%2F0611432%2Castro-ph%2F0611311%2Castro-ph%2F0611325%2Castro-ph%2F0611214%2Castro-ph%2F0611600%2Castro-ph%2F0611459%2Castro-ph%2F0611424%2Castro-ph%2F0611762%2Castro-ph%2F0611065%2Castro-ph%2F0611617%2Castro-ph%2F0611511%2Castro-ph%2F0611574%2Castro-ph%2F0611789%2Castro-ph%2F0611013%2Castro-ph%2F0611791%2Castro-ph%2F0611367%2Castro-ph%2F0611595%2Castro-ph%2F0611593%2Castro-ph%2F0611121%2Castro-ph%2F0611872%2Castro-ph%2F0611400%2Castro-ph%2F0611628%2Castro-ph%2F0611219%2Castro-ph%2F0611928%2Castro-ph%2F0611466%2Castro-ph%2F0611918%2Castro-ph%2F0611483%2Castro-ph%2F0611579%2Castro-ph%2F0611605%2Castro-ph%2F0611056%2Castro-ph%2F0611904%2Castro-ph%2F0611719%2Castro-ph%2F0611562%2Castro-ph%2F0611564%2Castro-ph%2F0611532%2Castro-ph%2F0611563%2Castro-ph%2F0611597%2Castro-ph%2F0611577%2Castro-ph%2F0611824%2Castro-ph%2F0611073%2Castro-ph%2F0611314%2Castro-ph%2F0611381%2Castro-ph%2F0611808%2Castro-ph%2F0611606%2Castro-ph%2F0611103%2Castro-ph%2F0611649%2Castro-ph%2F0611249%2Castro-ph%2F0611450%2Castro-ph%2F0611810%2Castro-ph%2F0611218%2Castro-ph%2F0611746%2Castro-ph%2F0611923%2Castro-ph%2F0611886%2Castro-ph%2F0611318%2Castro-ph%2F0611737%2Castro-ph%2F0611083%2Castro-ph%2F0611062%2Castro-ph%2F0611922%2Castro-ph%2F0611556%2Castro-ph%2F0611627%2Castro-ph%2F0611838%2Castro-ph%2F0611831%2Castro-ph%2F0611724%2Castro-ph%2F0611932%2Castro-ph%2F0611360&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Optimising Optimal Image Subtraction"}, "summary": "Difference imaging is a technique for obtaining precise relative photometry\nof variable sources in crowded stellar fields and, as such, constitutes a\ncrucial part of the data reduction pipeline in surveys for microlensing events\nor transiting extrasolar planets. The Optimal Image Subtraction (OIS) algorithm\npermits the accurate differencing of images by determining convolution kernels\nwhich, when applied to reference images of particularly good quality, provide\nexcellent matches to the point-spread functions (PSF) in other images of the\ntime series to be analysed. The convolution kernels are built as linear\ncombinations of a set of basis functions, conventionally bivariate Gaussians\nmodulated by polynomials. The kernel parameters must be supplied by the user\nand should ideally be matched to the PSF, pixel-sampling, and S/N of the data\nto be analysed. We have studied the outcome of the reduction as a function of\nthe kernel parameters using our implementation of OIS within the TRIPP package.\n  From the analysis of noise-free PSF simulations as well as test images from\nthe ISIS OIS package, we derive qualitative and quantitative relations between\nthe kernel parameters and the success of the subtraction as a function of the\nPSF sizes and sampling in reference and data images and compare the results to\nthose of implementations in the literature. On this basis, we provide\nrecommended parameters for data sets with different S/N and sampling.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0611578%2Castro-ph%2F0611771%2Castro-ph%2F0611938%2Castro-ph%2F0611300%2Castro-ph%2F0611565%2Castro-ph%2F0611189%2Castro-ph%2F0611761%2Castro-ph%2F0611900%2Castro-ph%2F0611498%2Castro-ph%2F0611907%2Castro-ph%2F0611584%2Castro-ph%2F0611711%2Castro-ph%2F0611747%2Castro-ph%2F0611513%2Castro-ph%2F0611451%2Castro-ph%2F0611537%2Castro-ph%2F0611529%2Castro-ph%2F0611702%2Castro-ph%2F0611084%2Castro-ph%2F0611525%2Castro-ph%2F0611874%2Castro-ph%2F0611785%2Castro-ph%2F0611235%2Castro-ph%2F0611434%2Castro-ph%2F0611776%2Castro-ph%2F0611156%2Castro-ph%2F0611018%2Castro-ph%2F0611463%2Castro-ph%2F0611775%2Castro-ph%2F0611096%2Castro-ph%2F0611614%2Castro-ph%2F0611124%2Castro-ph%2F0611433%2Castro-ph%2F0611798%2Castro-ph%2F0611405%2Castro-ph%2F0611547%2Castro-ph%2F0611432%2Castro-ph%2F0611311%2Castro-ph%2F0611325%2Castro-ph%2F0611214%2Castro-ph%2F0611600%2Castro-ph%2F0611459%2Castro-ph%2F0611424%2Castro-ph%2F0611762%2Castro-ph%2F0611065%2Castro-ph%2F0611617%2Castro-ph%2F0611511%2Castro-ph%2F0611574%2Castro-ph%2F0611789%2Castro-ph%2F0611013%2Castro-ph%2F0611791%2Castro-ph%2F0611367%2Castro-ph%2F0611595%2Castro-ph%2F0611593%2Castro-ph%2F0611121%2Castro-ph%2F0611872%2Castro-ph%2F0611400%2Castro-ph%2F0611628%2Castro-ph%2F0611219%2Castro-ph%2F0611928%2Castro-ph%2F0611466%2Castro-ph%2F0611918%2Castro-ph%2F0611483%2Castro-ph%2F0611579%2Castro-ph%2F0611605%2Castro-ph%2F0611056%2Castro-ph%2F0611904%2Castro-ph%2F0611719%2Castro-ph%2F0611562%2Castro-ph%2F0611564%2Castro-ph%2F0611532%2Castro-ph%2F0611563%2Castro-ph%2F0611597%2Castro-ph%2F0611577%2Castro-ph%2F0611824%2Castro-ph%2F0611073%2Castro-ph%2F0611314%2Castro-ph%2F0611381%2Castro-ph%2F0611808%2Castro-ph%2F0611606%2Castro-ph%2F0611103%2Castro-ph%2F0611649%2Castro-ph%2F0611249%2Castro-ph%2F0611450%2Castro-ph%2F0611810%2Castro-ph%2F0611218%2Castro-ph%2F0611746%2Castro-ph%2F0611923%2Castro-ph%2F0611886%2Castro-ph%2F0611318%2Castro-ph%2F0611737%2Castro-ph%2F0611083%2Castro-ph%2F0611062%2Castro-ph%2F0611922%2Castro-ph%2F0611556%2Castro-ph%2F0611627%2Castro-ph%2F0611838%2Castro-ph%2F0611831%2Castro-ph%2F0611724%2Castro-ph%2F0611932%2Castro-ph%2F0611360&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Difference imaging is a technique for obtaining precise relative photometry\nof variable sources in crowded stellar fields and, as such, constitutes a\ncrucial part of the data reduction pipeline in surveys for microlensing events\nor transiting extrasolar planets. The Optimal Image Subtraction (OIS) algorithm\npermits the accurate differencing of images by determining convolution kernels\nwhich, when applied to reference images of particularly good quality, provide\nexcellent matches to the point-spread functions (PSF) in other images of the\ntime series to be analysed. The convolution kernels are built as linear\ncombinations of a set of basis functions, conventionally bivariate Gaussians\nmodulated by polynomials. The kernel parameters must be supplied by the user\nand should ideally be matched to the PSF, pixel-sampling, and S/N of the data\nto be analysed. We have studied the outcome of the reduction as a function of\nthe kernel parameters using our implementation of OIS within the TRIPP package.\n  From the analysis of noise-free PSF simulations as well as test images from\nthe ISIS OIS package, we derive qualitative and quantitative relations between\nthe kernel parameters and the success of the subtraction as a function of the\nPSF sizes and sampling in reference and data images and compare the results to\nthose of implementations in the literature. On this basis, we provide\nrecommended parameters for data sets with different S/N and sampling."}, "authors": ["Holger Israel", "Frederic V. Hessman", "Sonja Schuh"], "author_detail": {"name": "Sonja Schuh"}, "author": "Sonja Schuh", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1002/asna.200610703", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/astro-ph/0611627v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/astro-ph/0611627v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "10 pages, 6 figures. Accepted for publication in Astronomische\n  Nachrichten / Astronomical Notes", "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/astro-ph/0611627v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/astro-ph/0611627v1", "journal_reference": null, "doi": "10.1002/asna.200610703", "fulltext": "Astron. Nachr. / AN 000, No. 00, 1 \u2013 10 (0000) / DOI ...\n\nOptimising Optimal Image Subtraction\nHolger Israel1,2,\u22c6 , Frederic V. Hessman1 , and Sonja Schuh1\n1\n2\n\nInstitut f\u00fcr Astrophysik G\u00f6ttingen, Universit\u00e4t G\u00f6ttingen, Friedrich-Hund-Platz 1, 37077 G\u00f6ttingen, Germany\nArgelander-Institut f\u00fcr Astronomie, Universit\u00e4t Bonn, Auf dem H\u00fcgel 71, 53121 Bonn, Germany\n\narXiv:astro-ph/0611627v1 20 Nov 2006\n\nReceived ..., accepted ...\nKey words\n\nmethods: data analysis \u2013 techniques: image processing \u2013 techniques: photometric\n\nDifference imaging is a technique for obtaining precise relative photometry of variable sources in crowded stellar fields\nand, as such, constitutes a crucial part of the data reduction pipeline in surveys for microlensing events or transiting extrasolar planets. The Optimal Image Subtraction (OIS) algorithm of Alard & Lupton (1998) permits the accurate differencing\nof images by determining convolution kernels which, when applied to reference images with particularly good seeing and\nsignal-to-noise (S/N ), provide excellent matches to the point-spread functions (PSF) in other images of the time series to\nbe analysed. The convolution kernels are built as linear combinations of a set of basis functions, conventionally bivariate\nGaussians modulated by polynomials. The kernel parameters, mainly the widths and maximal degrees of the basis function\nmodel, must be supplied by the user. Ideally, the parameters should be matched to the PSF, pixel-sampling, and S/N of\nthe data set or individual images to be analysed. We have studied the dependence of the reduction outcome as a function\nof the kernel parameters using our new implementation of OIS within the IDL-based T RIPP package. From the analysis\nof noise-free PSF simulations of both single objects and crowded fields, as well as the test images in the Isis OIS software\npackage, we derive qualitative and quantitative relations between the kernel parameters and the success of the subtraction\nas a function of the PSF widths and sampling in reference and data images and compare the results to those of other\nimplementations found in the literature. On the basis of these simulations, we provide recommended parameters for data\nsets with different S/N and sampling.\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\n1 Introduction\nMany astrophysical experiments rely on the precise determination of lightcurves from sources which are either weak,\nweakly variable, and/or situated in densely populated backgrounds. Prominent examples are the detection of extrasolar\nplanets via the transit technique, gravitational microlensing,\nand supernova searches. As these events are intrinsically\nrare, dedicated large-scale surveys have only become feasible due to automated reduction and photometry of large\namounts of CCD data. An overview of microlensing surveys (O GLE, E ROS, M ACHO, M OA, and P LANETS) is given\nin Dominik et al. (2002) and the references cited therein.\nWhenever stellar point spread functions (PSFs) overlap,\nthe determination of the background correction for aperture\nphotometry is difficult at best and heavy blending of stellar profiles renders the assignment of flux to one source or\nanother ambiguous or even impossible. Iterative deblending\nmethods of different kinds have been implemented and are\nin wide use: photometry packages like DAOPHOT (Stetson\n1987) or SE XTRACTOR (Bertin & Arnouts 1996) succeed in\nobtaining a high level of precision. Nevertheless, their accuracy decreases as the degree of blending increases and in the\ndensest Galactic fields, it is impossible to deblend without\nadditional information.\n\u22c6 Corresponding author:\ne-mail: hisrael@astro.physik.uni-goettingen.de\n\nIf the source is variable and the background is (roughly)\nconstant, then changes in brightness \u2013 if not the absolute\nbrightness \u2013 can be measured if one can successfully subtract the non-variable background by taking the difference\nbetween the images, corrected for any differences in scale\nand seeing; such an analysis is called Difference Imaging.\nIf the images of a time series are compared against a reference image taken from the same series, the difference images obtained by adequately subtracting the reference image should be empty of any signal except for a few variable\nobjects protruding from the background as positive or negative brightness variations. Their flux relative to the value\ndefined by the reference can then be measured by more classical aperture photometry. For difference imaging to work,\nthe PSFs in the reference image and in data image thus have\nto be matched exactly. Gould (1996) and Tomaney & Crotts\n(1996) first attempted difference imaging by adapting the\ndata image to a reference given by the broadest PSF. As this\ndeconvolution method deteriorates image quality, it worked\nonly with the highest S/N data. The nonlinear PSF fitting\nintroduced by Kochanski, Tyson & Fischer (1996) was more\nrobust but numerically time-consuming.\nTo date, the most successful difference imaging algorithm is O PTIMAL I MAGE S UBTRACTION (OIS) first suggested by Alard & Lupton (1998; hereafter AL98) and implemented in their I SIS pipeline. Starting with Alard (1999),\nit has successfully been applied in many different kinds of\nphotometric surveys: microlensing campaigns (Alcock et\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\n\f2\n\nH. Israel, F.V. Hessman & S. Schuh: Optimising Optimal Image Subtraction\n\nal. 1999); surveys for variable stars (Olech et al. 1999); supernova searches (Mattila & Meikle 2001); transit planet\nsearches (Mall\u00e9n-Onalas et al. 2003); etc.\nOptimal Image Subtraction determines convolution kernels which transform reference images into the data images\nvia a linear least-squares fit to a pre-defined set of basis\nfunctions, cleverly avoiding the problems of non-linear fits\nto the parameters of a particular PSF form. The reference\nimage is either that with the best seeing (and S/N ) or a\ncoaddition of several good images. Because of its linearity,\nOIS permits the processing of whole images and hence uses\nall available information.\nAlthough the convolution kernels are linear combination\nof pre-defined basis functions, there are still \"external\" parameters which have to be supplied before the fitting procedure can be started; these parameters are explained in detail\nin Section 2. We investigate the dependence of difference\nimage quality on the values of these parameters in Sections\n3 and 4 using different sets of simulated data and conclude\nwith an outlook in section 5.\n\n2 Optimal Image Subtraction\n2.1 The OIS algorithm\nStrictly speaking, the algorithm presented by AL98 does not\nmatch PSFs but whole images: the convolution of the reference image R(x, y) with a suitable kernel K(u, v) results\nin a model image J(x, y) which represents the best approximation in the sense of \u03c72 -fitting to the data image I(x, y).\nThe background differences S(x, y) between the images are\nalso fitted simultaneously:\n.\nI(x, y) = J(x, y) = R(x, y) \u2297 K(u, v) + S(x, y). (1)\nWhile OIS thus does not require any isolated stellar PSF to\nbe retrievable out of the blended profiles in the images, it\nis still more accurate the more distinguishable sources the\nimages contain1 .\nThe convolution kernel K(x, y) is a linear combination\nof basis functions B (i) (u, v) with u and v denoting the PSF\nkernel coordinates:\nNpsf \u22121\n\nK(u, v) =\n\nX\n\na(i) B (i) (u, v) .\n\n(2)\n\ni=0\n\nThe model image is then:\nNpsf \u22121\n\nJ(x, y) =\n\nX\ni=0\n\n\u0010\n\u0011\na(i) R(x, y) * B (i) (u, v) +S(x, y) . (3)\n\nThe convolution being linear, the model images can be expressed by the same fit parameters (a(i) ) as a linear combination of Npsf kernel and Nbg background basis images\nNpsf+Nbg\u22121\n\nJ(x, y) =\n\nX\n\na(i) C (i) (x, y)\n\n(4)\n\ni=0\n\n1 In real life, relatively isolated stars remain indispensable for image\nregistration in the existing photometry pipelines.\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\nwith a total number of N = Npsf + Nbg free parameters.\nInserting eq. 4 into the definition of the \u03c72 estimator\nand approximating the pixel count errors \u03c3(x, y) to be normally distributed, one obtains a linear system of equations,\nthe normal equations:\nc= M*a\n\n(5)\n\nwith a being the vector of N fit parameters. The elements\nof the vector c and matrix M are defined as follows:\n\u0011\nX\u0010\n\u2032\nMii\u2032 =\n\u03c3(x, y)\u22122 * C (i ) (x, y) * C (i) (x, y) , (6)\nx,y\n\n\u0011\nX\u0010\n\u03c3(x, y)\u22122 * I(x, y) * C (i) (x, y) .\nci =\n\n(7)\n\nx,y\n\n2.2 Basis functions according to Alard & Lupton\nThere is no mandatory choice for any particular OIS basis functions. AL98 define their basis functions B (i) (x, y)\nas Gaussians of G different fixed widths (bg ) multiplied by\npolynomials in kernel coordinates:\n\u0013\n\u0012 2\nu + v2\n(i)\n* uj v k .\n(8)\nB (u, v) = exp \u2212\n2b2g\nFor the exponents j and k, the relations 0 \u2264 j, k \u2264 dg\nand 0 \u2264 j + k \u2264 dg hold, where dg is the maximal degree of the g-th basic Gaussian component. The multi-index\ni = (g, j, k) comprises the indices running over the basic\nGaussians and the polynomial exponents. The widths bg determine how much a PSF's width increases upon convolution with the respective kernel and are therefore called\nbroadening parameters. Together with the maximal degrees\ndg , the bg are the external parameters to be supplied beforehand. Further adjustments can be made to the number G of\nGaussian components and the size M of the array representing the convolution kernel for computation. The background\ndifference between reference and data image is expanded\ninto a polynomial in pixel coordinates with a maximal degree dbg defined the same way as the (dg ). Thus, the basis\nimages are the following:\n\u0010 2 2\u0011\n(\n+v\nuj v k i < Npsf\nR(x, y)\u2297exp u\u22122b\n2\n(i)\ng\n(9)\nC (x, y) =\nxj y k\ni \u2265 Npsf .\nIn the framework of an improved algorithm, allowing\nfor a spatial variation of the convolution kernel over the chip\nto model PSF variations, Alard (2000) redefined the basis\nfunctions by subtracting the i = 0 function from every other\nbasis function of nonzero integral. Our difference imaging\npipeline within the IDL T RIPP package (see below) follows\nthe latter definition of the basis functions. Further independent implementations of OIS in the literature share the definition of basis functions from AL98 or Alard (2000): e.g.\nWo\u017aniak (2000; hereafter W00); Bond et al. (2001); G\u00f6ssl\n& Riffeser (2002; hereafter GR02).\n\nwww.an-journal.org\n\n\fAstron. Nachr. / AN (0000)\n\n2.3 Difference Imaging in the T RIPP package\nThe Time Resolved Image Photometry Package, T RIPP, is\nan IDL data reduction package for the automated processing of large CCD time series. Up to now, it has mainly been\nused for differential photometry with a clearly defined object of interest. Difference image analysis, by focusing on\nthe detection of variable sources in crowded (and mostly\nlarger) fields, brings somewhat complementary specifications into play. We have added to the T RIPP pipeline, as\ndescribed in Schuh et al. (2003), an alternative branch of\ndata flow. New top-level routines have been added for the\ninterpolation of all images to a common coordinate grid,\nthe actual PSF matching and image subtraction as well as\nimage coaddition. Shared information, e.g. the external parameters, is provided by an adaptation of the log file control\nfrom the original pipeline.\nBefore resampling an image to the reference grid, saturated pixels and pixels too close to an image edge to use\nthem for convolution are detected and stored in a bad pixel\nmask. Pixels in the new grid to which those bad pixels in\nthe original grid contribute are flagged in the final bad pixel\nmask and left out in the computation of the \u03c72 function.\nThe sums in eqs. (6) and (7) are evaluated on rectangular subframes of the data images, similar to the methods of\nAL98 and Alard (2000). In the normal (fast) mode, one single convolution kernel is obtained from the combined data\nin all subframes. In order to account for spatial PSF variation or regions of particular interest, the user can choose to\ndetermine \"local\" kernels for some or all of the subframes\nwhich then rely only on local PSF information.\nVariable sources are identified by running an adaptation of the DAOPHOT find function (Stetson 1987) on a\nweighted sum of difference images. For these significantly\nvariable sources, flux differences to the reference frame are\nmeasured by T RIPP aperture photometry of the difference\nimages. The flux scale in the difference images is that of the\nreference frame; thus, difference lightcurves may be calibrated by aperture photometry of the reference.\nThe following investigations on the outcome of difference imaging runs using different sets of external parameters have been carried out using the T RIPP difference imaging pipeline. In some analyses, detailed below, simulated\nimages from the Alard & Lupton I SIS package were processed. The consistency between results from T RIPP and the\nI SIS pipeline (written in C) was assessed by running both\ncodes with the same parameters over those images. Except\nfor the more elaborate handling of edges in T RIPP, the resulting difference images are similar to the level of showing\nthe same noise pattern from residuals of source subtraction.\n\n3 The vectors of maximal degrees\n3.1 The maximal degrees and number of parameters\nThe number of free parameters is determined by the maximal degrees of the modifying polynomials for the G Gauswww.an-journal.org\n\n3\n\nsian components of the convolution kernel. With \u2206(n) =\nP\nn\nk=1 k being the n-th triangular number, the number of parameters associated with a vector (d1 , . . . , dG ) of maximal\nPG\ndegrees is g=1 \u2206(dg + 1). (This can be verified by counting the possible combinations for j and k in eq. (8).) The\nsimultaneous fit of the differential background adds further\nparameters. The benefit in \u03c72red of using higher numbers N\nof basis functions must be traded against the runtime of the\ndifference imaging code. The N \u00d7 N normal equation matrix and N -element vector representing the linear problem\nof \u03c72 -fitting lead to a quadratic increase of computations\nwith parameter number. Thus, the relation between the \u03c72red\nand n is of practical importance.\n3.2 The simulated point spread functions\nThe crucial element of OIS is matching one PSF onto the\nother by applying an appropriate convolution kernel. In absence of intrinsic variability, a data image containing an\nisolated stellar profile should ideally be reproduced by the\nmodel image resulting from PSF matching such that the difference image will show zero flux. The fit's \u03c72 therefore is\na direct measure of the residuals from PSF matching.\nMany of our tests on the OIS algorithm have been carried out using simulated test data of single objects. Both\nreference and data images for each set contain a single PSF\nwithout noise in a 64 \u00d7 64 pixel frame. Because our investigations are of the influence of external parameters and not\nthe quality of OIS on realistic data per se, neither intensity\nand position offsets between images nor noise have been\nintroduced in those data.\nWhile the reference PSF was chosen to be pure Gaussian by construction, the data profile function consists of a\nweighted sum of a Gaussian and a Lorentzian function with\nthe same center position: in terms of its radial distance r, it\nis given by\n\u0012\n\u0013\nr2\n\u03b6\n\u03a6(r) = (1\u2212\u03b6)*exp \u2212 2 +\n(10)\n2\n2sG\n1 + (r/sL )\nwith sG and sL being the width scales of the Gaussian and\nLorentzian component, respectively. Throughout this article, the width of a profile function will be defined as the geometric mean\u0001of the standard deviations s of fitting Gaussian\nexp r2 /2s2 along the Cartesian axes. Adopting \u03b6 = 0.2 is\na reasonable representation of a seeing profile with a central core and weak extended wings; we will refer to this\nPSF as LORENTZ 20. The LORENTZ 20 widths were chosen to be sG = 1.2sref and sL = 1.5sref , with sref the\nwidth of the Gaussian reference peak. This yields a relation\nsdat = 1.22sref between the final widths in both images.\nDue to its Lorentzian shape at large centroid distances r,\nan isolated LORENTZ 20 PSF can be measured at radii where\nit would be completely dominated by noise under realistic circumstances. To localise the PSF, we multiplied the\nLORENTZ 20 PSF with an Gaussian envelope function in\nnoise-free simulations. It confines the PSF to the size of the\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\n\f4\n\nH. Israel, F.V. Hessman & S. Schuh: Optimising Optimal Image Subtraction\n\nFig. 1 Dependence of the reduced \u03c72 on displacements\nbetween frames, i.e. residuals of improper image registration. The curves represent the results for different samplings using the LORENTZ 20 crowded field simulations discussed in sec. 4.3. The sampling in the data frame was\nsdat = 1.95 px in the continuous curve, sdat = 2.85 px in the\ndashed curve, and sdat = 3.6 px in the dash-dotted one while\nthe sampling is sref = 1.8 px in the reference frame.\n\nFig. 2 The minimal reduced \u03c72 for the LORENTZ 20 data\nin the parameter range 0.5 \u2264 b1 \u2264 4.0 pixels as a function of\nthe number N of free parameters given by the maximal degrees assigned to the Gaussian kernel components of different width: G = 3 (crosses); and G = 4 (diamonds). Results\nfor the triplets d = (4, 3, 2) (W00), d = (6, 4, 2) (GR02)\nand d = (6, 4, 3) (AL98) are represented by the initials of\nthe respective authors.\nkernel without changing the relevant central part of the profile.\n3.3 The number of free parameters\nIn reductions of perfectly aligned test data, basis function\nwith an odd number either for j or k contribute nothing to\nthe kernel solution. In real data, these odd basis functions\npermit to process irregular or asymmetric PSFs or can shift\nthe PSF centroid and thus compensate for any residual mis-\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\nalignment between images. Test reductions for which an artificial displacement between reference and data frame had\nbeen introduced showed little increase in \u03c72red for misalignments < 1 px compared to the case of perfect image registration (fig. 1).2 Increasing a maximal degree from even to\nodd is found to decrease \u03c72red less than increasing in from\nodd to even. For that reason, we will only consider even dg .\nIn the implementations discussed in literature (AL98;\nW00; GR02), the number of Gaussian components is G = 3;\nfeaturing decreasing maximal degrees dg with increasing\nbroadening parameters bg . Kernel components having high\npolynomial exponents are larger in extent than basis functions with lower exponents while the most important part of\nthe PSF model is the center. Therefore, in our study, the dg\ndecrease or remain constant with increasing bg .\nWe tested the effects of diverse vectors of maximal degrees (dg ) using T RIPP. Figure 2 shows the minima of \u03c72red\nfound in the interval 0.5 px \u2264 b1 \u2264 4.0 px as a function of\nthe number N of free parameters for all vectors of G = 3 or\nG = 4. Results from similar runs using the vectors suggested\nby AL98, W00, and GR02 have been added and marked by\nthe authors' initials.3\nThe most noticeable feature in fig. 2 are three points at\nsignificantly higher \u03c72red than most of the others. These belong to d = (2, 2, 0) at N = 13, d = (2, 2, 2) at N = 18, and\nd = (4, 2, 0) at N = 22. Note that the vector d = (2, 2, 2, 0)\n(case c in fig. 2) yields a much better \u03c72red at N = 19. As\na rule of thumb, at least 20 parameters are needed for sufficient complexity of the set of basis function to match point\nspread functions. Beyond this threshold, \u03c72red rather slowly\nimproves with increasing n. Between N \u2248 30 and N \u2248 50,\nthe use of four widths seems to yield better results than having G = 3, while there is no difference for larger N .\nThe efficiency of a certain choice for (dg ) can be estimated considering \u03c72red /N 2 . The maximal values for this\nquantity are obtained for those vectors denoted a to e in\nfig. 2. This selection also shows that extending (dg ) by a\nmaximal degree of zero (a pure Gaussian basis function)\nwill improve \u03c72red , as demonstrated by comparing the solutions d = (2, 2, 2, 0) vs. d = (2, 2, 0) with just one additional parameter.\nThe five most efficient vectors have maximal degrees\ndg \u2264 4. This corresponds to j = 2, k = 2 being the last qualitatively different distribution of flux enhancements and depressions in the convolution kernel to be added with increasing maximal degree. This implies that a further reduction\nin the PSF matching residuals via a higher number of\nfitted parameters can be most easily obtained by using\nmore Gaussian widths and maximal degrees up to four.\nIn the rest of this article, we will investigate d = (4, 2, 2) in\ngreater detail.\n2 This means that one could \u2013 in principle \u2013 skip the image registration\nif the offset between images is sufficiently small and constant.\n3 Due to the noise-free nature of LORENTZ 20 data, the absolute scale of\n\u03c72red is not defined, but can still be used as a relative measure of goodness\nas a function of sample size and parameter number.\n\nwww.an-journal.org\n\n\fAstron. Nachr. / AN (0000)\n\n5\n\nFig. 3 Reduced \u03c72 for d = (4, 2, 2) as a function of minimum Gaussian kernel width b1 obtained for LORENTZ 20 data,\nkernel spacing parameter \u03b2 = 1.5, 2.0, 2.5, 3.0, and reference PSF's widths sref increasing in steps of 0.1 px from sref =\n1.2 px (uppermost line) to 4.0 px (lowermost at b1 = 0.5 px). The corresponding data PSF widths runs from sdat = 1.44 px\n(uppermost) to 4.28 px (lowermost), with step sizes ranging from 0.22 to 0.08 px. The convolution kernel size was fixed at\nm = 19 px. Asterisks: positions of the local minima at highest b1 for each sampling. Diamonds: approximate values for b1\nusing G = 1, d = 0 as in eq. (12).\n\n4 The kernel widths\n4.1 Kernel widths and PSF sampling\nIf the number of widths of the kernel components is G = 3\nor larger, the parameter space of broadening parameters \u2013\nnot to mention the whole space for arbitrary (dg ) \u2013 becomes\ncomplicated. The different values for the G widths (bg ) used\nin the literature have been arbitrarily selected by the different authors, based on their own experience.\nIn order to test their selection systematically (and in anticipation of the main result of this section result that \u03c72red\ndoes not depend too sensitively on the (bg )), we adopted\nthe following system: instead of choosing G broadenings\nindependently, we assume they are related by a geometrical\nseries such that\nbg = b1 * \u03b2 g\u22121 ,\n\ng = 1, . . . , G .\n\n(11)\n\nThere remain b1 , the minimum kernel width, and \u03b2, the kernel spacing parameter, as independent external parameters.\n\nwww.an-journal.org\n\nThe choice of a geometrical series can again be justified by\nthe approximately Gaussian nature of a PSF with a steep\nintensity gradient near its centroid and wings that fade out\nsuper-exponentially into the background.\nIf the PSF's were perfect Gaussians of widths sref in the\nreference image and sdat > sref in the data peak, the convolution kernel mapping the reference onto the data would\nalso be a Gaussian of width\nq\nb = s2dat \u2212 s2ref .\n(12)\n\nThis simple relation can be used as a \"first-guess\" value of\nb1 . Given G \u2265 1 Gaussian components and the LORENTZ 20\nPSF the dependence of the optimal value for b1 using the\ngeometrical spacing (eq. 11) is more complex than the simple relation in (eq. 12). For four kernel spacing parameters\nbetween \u03b2 = 1.5 and \u03b2 = 3.0, values of \u03c72red against b1 are\npresented in fig. 3: the graphs show how the locations of\nlocal minima in \u03c72red move with changes in PSF width for\nwidths of the reference PSFs from sref = 1.2 px to 4.0 px in\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\n\f6\n\nH. Israel, F.V. Hessman & S. Schuh: Optimising Optimal Image Subtraction\n\nFig. 4 Reduced \u03c72 as a function of minimum Gaussian kernel width b1 obtained from reduction of LORENTZ 20 PSFs at\nfour fixed reference image samplings sref = 1.5 px, 2.0 px, 2.5 px, and 3.0 px. The respective panels show \u03c72red (b1 ) for a\nsubset of the data images from fig. 3 with samplings sdat \u2248 sref . A fiducial value of sdat is given in the plots along with the\naverage difference between consecutive data image samplings. The kernel spacing parameter is fixed at \u03b2 = 2.0 while the\nmaximal degrees and kernel size are set to d = (4, 2, 2) and M = 19 px (as in fig. 3).\nsteps of 0.1 px and associated data PSFs from sdat = 1.44 px\nto 4.28 px. As a consequence of limiting the peak's extent\nby a Gaussian envelope function of constant width, there is\nno fixed relation between sref and sdat and the steps in sdat\ndecrease towards wider peaks.\nKeeping in mind that PSF shapes look more Gaussian at\nhigh sdat in this data set, one can evaluate general properties of the \u03c72red (b1 ) curves. Smaller PSF widths correspond\nto seeing conditions more favourable for precise photometry. On the other hand, on a CCD with its fixed physical pixel size, these peaks are poorly sampled by their discrete measurements. Sparsely sampled peaks impose harder\nconstraints on PSF fitting than well-sampled ones. With increasing PSF width, the convex shape of the \u03c72 (b1 ) curve\nhas three minima. The global minima in \u03c72red , generally located towards the highest b1 and denoted by asterisks in\nfig. 3, can lead to a drastic shift in the optimal value for\nopt\nbopt\n1 over a narrow range in sdat . At higher samplings, b1 ,\nreaches its maximum and reapproaches the secondary minimum located near b1 = 1.0 px nearly independent of sdat .\nThis effect is not by the changes in data PSF shape and\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\nwidth evoked by the envelope function: first guess values\nfor bopt\n1 derived from eq. (12) and marked by diamonds only\nstart to turn at much higher sdat near the bottom of the plots.\nComparing the results for the chosen values of \u03b2, we\nfind the most pronounced differences at low samplings. For\nincreasing \u03b2, the \u03c72red valley at sdat = 1.44 px widens towards lesser values of b1 and arrives to be flat for \u03b2 =\n3.0. The observation that larger \u03b2 correspond to lower optimal values for b1 and tend to result in lower gradients of\n\u03c72red (b1 ) can easily be understood as an effect from higher\nvalues for b2 and b3 accompanying a given b1 . This can also\nbe seen from sudden increases of \u03c72red with b1 which occur\nwhenever a maximum of a basis function contributing relevantly to the kernel solution starts to fall onto an edge of the\nkernel array upon incrementing b1 . Such function will then\nstart to act as an additional fitting function to the differential background but no longer to the actual PSF matching.\nFigure 3 shows that edges in \u03c72red (b1 ) appear at smaller b1\nthe higher the value of \u03b2, especially for intermediate PSF\nwidths. We find the choice of \u03b2 to be uncritical with \u03b2 > 2.0,\nwww.an-journal.org\n\n\fAstron. Nachr. / AN (0000)\n\nwith higher \u03b2 allowing a more convenient reduction of narrow PSFs.\nFigure 4 shows the \u03c72red from similar reductions at fixed\nsamplings in the reference frame. The overall \u03c72red optimum\nis found at a data sampling sdat slightly larger than sref .\nNote the ability of the basis system to build image sharpening kernels yielding a more peaked PSF. Our results indicate\nthat a 20% reduction of PSF width is possible at a reasonable \u03c72red ; a feature frequently used for PSF matching of\ngood seeing frames which will be stacked to produce a less\nnoisy \"super-reference\" for subsequent difference imaging.\nAs expected, the location of the minimum moves towards higher b1 with increasing sdat at a given sref . In addition, we find optimal minimum widths bopt\n= 0.8 px at\n1\n=\n2.2\npx\nat\ns\n= 3.0 px.\nsref = 1.5 px increasing to bopt\nref\n1\nShape and width of the \u03c72red valley both depend on sampling\nof the reference frame and the sampling difference between\nreference and data image.\nThe detailed structure of the course of \u03c72 (b1 ), especially bopt\n1 , depends on the individual images to be matched.\nTherefore, after a comparison of several setups, we only discuss the more robust qualitative features here. It should be\nmentioned, that changing the kernel size M not only reduces \u03c72 but alters the curves for a given sdat to a flatter\nshape with respect to b1 which resembles that found for\nbroader peaks4 . We adopted M = 19 from AL98.\nIn further tests including image registration by interpolation, the minimum value of \u03c72red drastically increases for\ndata samplings sdat < 1.2 px, relatively independent of sref .\nInterpolation errors dominate the reduction outcome, thus\nlimiting the utility of OIS for these undersampled data.\n4.2 Crowded field tests using ISIS 2 data\nIn order to assess the parameter dependence of difference\nimaging quality in a more realistic (and easily reproducible)\nform, we utilised a series of 50 simulated crowded field observations contained within the I SIS package as test images.\nThese data, hereafter referred to as the ISIS 2 set, show a\nnearly linear decrease in seeing with index spanning a range\nfrom s = 1.8 px to s = 3.2 px. We took the first image as the\nreference and every fourth of the further ones as data images. Averaging \u03c72red over the subseries of the latter twelve\nimages, the difference imaging quality for different choices\nof b1 and \u03b2 are presented in fig. 5.\nThe \u03c72red (b1 ) curves show little variation with the tested\n\u03b2 except for b1 < 0.8 px, where there is a steep growth in\n\u03c72red for \u03b2 = 1.5 and, to a lesser extent, for \u03b2 = 2.0 as all\nthree broadenings get small relative to the PSF difference.\nWith an optimal value around b1 \u2248 1.0 px, parameters in the\ninterval 0.7 px \u2264 b1 \u2264 1.6 px yield similarly good results.\nFor the higher three values of \u03b2 a secondary minimum at a\nsmaller b1 exists.\n4 To properly sample the kernel's center element an odd number should\nbe chosen for M .\n\nwww.an-journal.org\n\n7\n\nFig. 5 Reduced \u03c72 as a function of b1 for a simulated\ntime series consisting of every fourth image in the ISIS 2\ndata set and maximal degrees d = (4, 2, 2). The average over the twelve non-reference images in the series is\ndenoted by h\u03c72red i. Curves resulting from T RIPP difference\nimaging runs with four different \u03b2 factors as well and\nbroadening parameters b = (0.7, 2.0, 4.0) (AL98), b =\n(0.78, 1.35, 2.34) (W00), and b = (1.0, 3.0, 9.0) (GR02)\nare plotted.\nOverplotted in fig. 5 are results from T RIPP using d =\n(4, 2, 2) with broadenings taken from the literature: b =\n(0.7, 2.0, 4.0) (AL98); b = (0.78, 1.35, 2.34) (W00); and\nb = (1.0, 3.0, 9.0) (GR02). By construction, the latter falls\non the \u03b2 = 3.0\n\u221a curve while W00 employs a geometric spacing of \u03b2 \u2248 3. The AL98 parameters do not follow a multiplicative relation, but the corresponding \u03c72red value is very\nclose to the ones for those \u03b2 yielding a comparable vector.\nAll of these models come close to the minimum found in\nour simulations with AL98's b1 = 0.7 px marking the lower\nlimit for advisable b1 .\nWith a wider \u03c72red valley and its minimum at bopt\n1 \u2248 2.5,\nthe ISIS 2 reductions differ significantly from the LORENTZ\nresults for a width of the data PSF of sdat \u2248 3.0 px which\nis found in the poorer sampled ISIS 2 images. On the other\nhand, the agreement to the LORENTZ 20 model at sref =\n2.0 px and \u03b2 = 2.0 is fairly good (see fig. 4) . This can be\nexplained by the fact that, in current implementations of difference imaging, one set of parameters is chosen for reducing the whole time series comprising images obtained under varying observational circumstances or even collected\nfrom several telescopes (as in collaborative microlensing\nsurveys). Given that situation, the averaging selects for the\n(bg ) equalising the subtraction residuals over the full observed PSF range.\nA closer inspection of the data shows that the overall\ncourse of the averaged \u03c72red is determined by the images\nwith best seeing next to the reference image. Their reduction requires slim convolution kernels and thus small b1 . In\norder to obtain the best possible lightcurve, a low \u03c72red is\nespecially desirable for images of high quality. This means\napplying a small b1 to the whole data set. Small values of\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\n\f8\n\nH. Israel, F.V. Hessman & S. Schuh: Optimising Optimal Image Subtraction\n\nb1 \u2248 1.0 px may not be optimal for wide data PSF relative\nto the reference, but the loss in terms of \u03c72red compared to\nthe minimum is not large. Therefore, the (bg ) can be determined by optimising them for the most sensitive data image\nof best seeing. As a positive side effect, the success of a\ncertain set of (bg ) can be deduced from a test run on only\ntwo images: the reference image and a further good seeing\nexposure.\n4.3 Crowded field tests using LORENTZ 20 data\nDivergent dependences on b1 for ISIS 2 and LORENTZ 20\ndata may partly be caused by the obvious differences between LORENTZ 20 and ISIS 2 profiles: ISIS 2 PSFs are of\npurely Gaussian shape and are highly blended, while the\nunblended PSF of our test images have extended Lorentzian\nwings, cut off by an Gaussian envelope.\nWe investigated the relative importance of these effects\nin reductions of a simulated time series of images featuring\nLORENTZ 20 PSFs at about the same level of crowding as in\nISIS 2. Three series of 1+12 images at different S/N ratios\nwere created using sdat = 1.8 px in the reference images and\nan increment of +0.15 px with each higher index in a series.\nThus, roughly the same seeing range as in ISIS 2 is covered.\nThe average S/N integrated over an aperture centered on a\nrelatively isolated star was set at 220 in the highest quality\ncase and reduced to 100 and 30 for the other ones.\nFigure 6 shows how \u03c72red depends on b1 for the highest\nand lowest seeing images out of the twelve data images and\nthe averages over the whole series for the S/N = 220 and\nS/N = 100 cases. Values of \u03c72red were normalised to the\nminimum for the specific S/N and sample subset to be able\nto present the results for different grades of seeing in the\nsame plot. The S/N = 30 curves resemble their counterparts\nof intermediate quality with features smoothed out by the\nlarger random component.\nIn the high S/N data set, the \u03c72red averaged over the\ncomplete sample follows the best seeing data image curve\nand with 0.7 px \u2264 b1 \u2264 1.8 px displays a similar interval\nof nearly optimal minimum kernel widths as their \u03b2 = 2.0\nand \u03b2 = 3.0 counterparts from the ISIS 2 series (fig. 5). The\nshape of the curves \u03c72red (b1 ) for the best and worst seeing\nimages reproduces quite nicely the results found at both \u03b2\nfor isolated LORENTZ 20 peaks of similar reference and data\nsampling. In particular, for the best seeing results at \u03b2 = 2.0,\nthe positions of the minima agree quite well with the ones\nfor the isolated sdat = 2.0 px and sref = 2.02 px (upper right\npanel in fig. 4).\nComparing the heavily blended ISIS 2 and LORENTZ 20\ndata allows us to estimate the influence of PSF shape on the\ndifference imaging parameters. While pure Gaussian PSFs\nyield a relatively simple dependence \u03c72red (b1 ), the multiple\nminima found with LORENTZ 20 data seem related to their\nmore complex PSF structure. Nevertheless, both data sets\nhave in common the range of usable b1 . Blending itself appears to have only a minor influence on the choice of b1 .\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\nTable 1 Summary of the recommended settings for OIS\nexternal parameters.\n\nSituation\n\nMaximal\ndegrees\n(dg )\n\nGeneral\nRecommendation\nSmall seeing\ndifferences\nto reference\nGood\noverall\nseeing\nImproved\nprecision\nrequired\n\ne.g.\n(4, 2, 2),\n(2, 2, 2, 2)\ne.g.\n(4, 2, 2),\n(2, 2, 2, 2)\ne.g.\n(4, 2, 2),\n(2, 2, 2, 2)\ne.g.\n(6, 4, 2),\n(4, 4, 2, 2)\n\nMinimum\nkernel width\nb1\n(px)\n\nKernel spacing\nparameter\n\u03b2\n\n0.7 . . . 1.2\n\n1.5 . . . 3.0\n\n\u2248 0.7\n\n1.5 . . . 3.0\n\n0.7 . . . 1.2\n\n\u2248 3.0\n\n0.7 . . . 1.2\n\n1.5 . . . 3.0\n\nWith increasing level of noise, the optimum in \u03c72red for\nthe best seeing data image is found at larger b1 , while for\nthe poorest seeing image it becomes less pronounced. These\ntendencies are probably caused by the less clearly defined\nPSF in noisy images. It is unclear whether differences between the \u03c72 levels for the same image at different \u03b2 in the\nright panel of fig. 6 represent an artefact of the simulation.\n\n5 Conclusion and outlook\nOptimal image subtraction following the AL98 setup requires about n & 20 parameters for successful subtraction of\nconstant sources (fig. 2). The improvement with increasing\nnumber of parameters is marginal; the most efficient choices\nfor (dg ) are given in sec. 3.3. A larger number G of principal\nGaussian should be favoured over maximal degrees dg > 4.\nThe choice of kernel widths mainly depends on the differences in PSF widths between reference and data images,\nwith eq. (12) giving a crude estimate. Given a sampling of\nthe data image sdat & 1.5 px, the \u03c72red of the reduction does\nnot depend critically on the (bg ). Multiplicative spacing of\nkernel widths proves to be useful, with 1.5 \u2264 \u03b2 \u2264 3.0 nearly\nequally recommendable. Due to a small range in widths,\nvalues of \u03b2 < 1.5 should not be used. For small differences\nbetween reference and data samples, high values of \u03b2 yield\na wider and thus more comfortable interval of low \u03c72red .\nDifference imaging has, up to now, applied a single set\nof kernel widths to a whole time series, comprising exposures of different seeing. Parameters should then be chosen\nto achieve preferentially good reductions for high quality\nimages showing a small sampling difference to the reference. As outlined in sec. 4.2, this demands for minimum\nkernel widths in the interval 0.7 px < b1 < 1.2 px able\nto model minute PSF differences. At even smaller b1 , basis function themselves become undersampled leading to a\nhigher \u03c72red . As a guideline for the user of OIS, these results\nwww.an-journal.org\n\n\fAstron. Nachr. / AN (0000)\n\n9\n\nReduced \u03c72 as a function of S/N and minimum kernel width b1 for a simulated time series of highly blended\nLORENTZ 20 PSF's. Shown are \u03c72red averaged over twelve images with linearly increasing PSF widths (solid curves) as\nwell as for the best (long dashes) and worst (dash-dot) seeing data images. Note that, with decreasing S/N , the differences\nbetween reductions of good and poor sampling images are also reduced. Adding further noise increasingly flattens out the\n\u03c72red (b1 ) curves.\n\nFig. 6\n\nare summarised in table 1. One can, in principle, go on to\ndefine customised (bg ) for individual images or groups of\nimages to further optimise \u03c72red .\nEfforts towards this direction are likely to be impeded by\nthe difficulty of deriving quantitative results on the effects\nof the parameters. The deeper reason is that the AL98 basis\nfunctions produce elements in the matrix M and the vector\nc from eqs. (6) and (7) typically spanning > 5 decades, independent of the input images. Although T RIPP makes use\nof the advantages of singular value decomposition, small\nchanges in the image data may in some cases lead to significantly different \u03c72red values. This instability coexists with\nthe general features presented above. Because this problem\narises from large numbers introduced by the multiplication\nwith polynomials of pixel indices in the ad hoc definitions\nin (eq. 9), it should be fruitful to look for alternative definitions of basis functions. Orthogonal functions \u2013 e.g. the\ndecomposition of the PSF into shapelets (Refregier 2003) \u2013\nmight have the double advantages of minimising the number of parameters needed and simultaneously allowing for\na wider class of PSF corrections to be applied by optimal\n\nwww.an-journal.org\n\nimage subtraction. The matching of seeing conditions with\nits subtleties continues to be a nontrivial problem which solution holds many scientific and numerical insights.\nAcknowledgements. H.I. likes to thank Stefan Dreizler for the motivation and support of the investigations on difference imaging\nwhich resulted in this article.\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\n\f10\n\nH. Israel, F.V. Hessman & S. Schuh: Optimising Optimal Image Subtraction\n\nReferences\nAlard, C., Lupton, R. H.: 1998, ApJ 503, 325 (AL98)\nAlard, C.: 1999, A&A 343, 10\nAlard, C.: 2000, A&AS 144, 363\nAlcock, C., Allsman, R. A., Alves, D., et al.: 1999, ApJ 521, 602\nBertin, E., Arnouts, S.: 1996, A&AS 117, 393\nBond, I. A., Abe, F., Dodd, R. J., et al.: 2001, MNRAS 327, 868\nDominik, M., Albrow, M. D., Beaulieu, J.-P., et al.: 2002, Planetary\nand Space Sciences 50, 299\nG\u00f6ssl, C. A., Riffeser, A.: 2002, A&A 381, 1095 (GR02)\nGould, A.: 1996, ApJ 470, 201\nKochanski, G. P., Tyson, J. A., Fischer, P.: 1996, AJ 111\nMall\u00e9n-Ornalas, G., Seager, S., Yee, H. K. C., Minitti, D., Gladders, M. D., Mall\u00e9n-Fullerton, G. M., Brown, T. M.: 2003,\nApJ 582, 1123\nMattila, S., Meikle, W. P. S.: 2001, MNRAS 324, 325\nOlech, A., Wo\u017aniak, P. R., Alard, C., Kaluzny, J., Thompson, I. B.:\n1999, MNRAS 310, 759\nRefregier A.: 2003, MNRAS 338, 35\nSchuh, S., Dreizler, S., Deetjen, J. L., G\u00f6hler, E.: 2003,\nBaltic Astronomy 12, 167\nStetson, P. B.: 1987, PASP 99, 191\nTomaney, A. B., Crotts, A. P. S.: 1996, AJ 112, 2872\nWo\u017aniak, P. R.: 2000, Acta Astronomica 50, 421 (W00)\n\nc 0000 WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim\n\nwww.an-journal.org\n\n\f"}