{"id": "http://arxiv.org/abs/0911.1575v1", "guidislink": true, "updated": "2009-11-09T02:10:09Z", "updated_parsed": [2009, 11, 9, 2, 10, 9, 0, 313, 0], "published": "2009-11-09T02:10:09Z", "published_parsed": [2009, 11, 9, 2, 10, 9, 0, 313, 0], "title": "Formulas for the Laplace Transform of Stopping Times based on Drawdowns\n  and Drawups", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0911.5589%2C0911.0319%2C0911.4420%2C0911.1744%2C0911.1670%2C0911.0757%2C0911.3411%2C0911.4051%2C0911.4042%2C0911.4342%2C0911.5061%2C0911.4122%2C0911.0852%2C0911.2677%2C0911.0755%2C0911.1533%2C0911.0559%2C0911.2430%2C0911.4212%2C0911.1016%2C0911.0637%2C0911.2355%2C0911.4410%2C0911.5345%2C0911.4267%2C0911.3128%2C0911.1238%2C0911.3102%2C0911.4906%2C0911.0840%2C0911.3729%2C0911.5664%2C0911.1389%2C0911.1267%2C0911.2317%2C0911.2136%2C0911.3187%2C0911.3757%2C0911.0939%2C0911.5511%2C0911.5142%2C0911.3873%2C0911.3104%2C0911.3513%2C0911.2216%2C0911.3648%2C0911.3110%2C0911.3693%2C0911.3064%2C0911.5154%2C0911.3863%2C0911.4938%2C0911.1256%2C0911.5704%2C0911.0934%2C0911.1666%2C0911.4417%2C0911.2033%2C0911.3944%2C0911.3234%2C0911.0724%2C0911.0825%2C0911.4208%2C0911.1242%2C0911.2168%2C0911.3811%2C0911.3232%2C0911.1108%2C0911.3938%2C0911.1634%2C0911.5409%2C0911.3748%2C0911.3715%2C0911.2858%2C0911.1061%2C0911.3587%2C0911.2444%2C0911.2950%2C0911.4798%2C0911.1197%2C0911.2378%2C0911.3502%2C0911.5011%2C0911.0076%2C0911.4184%2C0911.0835%2C0911.2965%2C0911.0567%2C0911.3420%2C0911.2242%2C0911.2410%2C0911.3711%2C0911.4714%2C0911.4948%2C0911.0010%2C0911.4055%2C0911.1321%2C0911.5253%2C0911.1575%2C0911.0922%2C0911.2190&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Formulas for the Laplace Transform of Stopping Times based on Drawdowns\n  and Drawups"}, "summary": "In this work we study drawdowns and drawups of general diffusion processes.\nThe drawdown process is defined as the current drop of the process from its\nrunning maximum, while the drawup process is defined as the current increase\nover its running minimum. The drawdown and the drawup are the first hitting\ntimes of the drawdown and the drawup processes respectively. In particular, we\nderive a closed-form formula for the Laplace transform of the probability\ndensity of the drawdown of a units when it precedes the drawup of b units. We\nthen separately consider the special case of drifted Brownian motion, for which\nwe derive a closed form formula for the above-mentioned density by inverting\nthe Laplace transform. Finally, we apply the results to a problem of interest\nin financial risk-management and to the problem of transient signal detection\nand identification of two-sided changes in the drift of general diffusion\nprocesses.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0911.5589%2C0911.0319%2C0911.4420%2C0911.1744%2C0911.1670%2C0911.0757%2C0911.3411%2C0911.4051%2C0911.4042%2C0911.4342%2C0911.5061%2C0911.4122%2C0911.0852%2C0911.2677%2C0911.0755%2C0911.1533%2C0911.0559%2C0911.2430%2C0911.4212%2C0911.1016%2C0911.0637%2C0911.2355%2C0911.4410%2C0911.5345%2C0911.4267%2C0911.3128%2C0911.1238%2C0911.3102%2C0911.4906%2C0911.0840%2C0911.3729%2C0911.5664%2C0911.1389%2C0911.1267%2C0911.2317%2C0911.2136%2C0911.3187%2C0911.3757%2C0911.0939%2C0911.5511%2C0911.5142%2C0911.3873%2C0911.3104%2C0911.3513%2C0911.2216%2C0911.3648%2C0911.3110%2C0911.3693%2C0911.3064%2C0911.5154%2C0911.3863%2C0911.4938%2C0911.1256%2C0911.5704%2C0911.0934%2C0911.1666%2C0911.4417%2C0911.2033%2C0911.3944%2C0911.3234%2C0911.0724%2C0911.0825%2C0911.4208%2C0911.1242%2C0911.2168%2C0911.3811%2C0911.3232%2C0911.1108%2C0911.3938%2C0911.1634%2C0911.5409%2C0911.3748%2C0911.3715%2C0911.2858%2C0911.1061%2C0911.3587%2C0911.2444%2C0911.2950%2C0911.4798%2C0911.1197%2C0911.2378%2C0911.3502%2C0911.5011%2C0911.0076%2C0911.4184%2C0911.0835%2C0911.2965%2C0911.0567%2C0911.3420%2C0911.2242%2C0911.2410%2C0911.3711%2C0911.4714%2C0911.4948%2C0911.0010%2C0911.4055%2C0911.1321%2C0911.5253%2C0911.1575%2C0911.0922%2C0911.2190&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this work we study drawdowns and drawups of general diffusion processes.\nThe drawdown process is defined as the current drop of the process from its\nrunning maximum, while the drawup process is defined as the current increase\nover its running minimum. The drawdown and the drawup are the first hitting\ntimes of the drawdown and the drawup processes respectively. In particular, we\nderive a closed-form formula for the Laplace transform of the probability\ndensity of the drawdown of a units when it precedes the drawup of b units. We\nthen separately consider the special case of drifted Brownian motion, for which\nwe derive a closed form formula for the above-mentioned density by inverting\nthe Laplace transform. Finally, we apply the results to a problem of interest\nin financial risk-management and to the problem of transient signal detection\nand identification of two-sided changes in the drift of general diffusion\nprocesses."}, "authors": ["Hongzhong Zhang", "Olympia Hadjiliadis"], "author_detail": {"name": "Olympia Hadjiliadis"}, "author": "Olympia Hadjiliadis", "links": [{"href": "http://arxiv.org/abs/0911.1575v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0911.1575v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-fin.RM", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "stat.TH", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0911.1575v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0911.1575v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "Submitted to the Annals of Applied Probability\narXiv: math.PR/0000000\n\narXiv:0911.1575v1 [math.PR] 9 Nov 2009\n\nFORMULAS FOR THE LAPLACE TRANSFORM OF\nSTOPPING TIMES BASED ON DRAWDOWNS AND\nDRAWUPS\nBy Hongzhong Zhang\u2020 and Olympia Hadjiliadis\u2217,\u2020,\u2021\nGraduate Center\u2020 and Brooklyn College\u2021 , C.U.N.Y.\nIn this work we study drawdowns and drawups of general diffusion processes. The drawdown process is defined as the current drop\nof the process from its running maximum, while the drawup process is\ndefined as the current increase over its running minimum. The drawdown and the drawup are the first hitting times of the drawdown and\nthe drawup processes respectively. In particular, we derive a closedform formula for the Laplace transform of the probability density of\nthe drawdown of a units when it precedes the drawup of b units. We\nthen separately consider the special case of drifted Brownian motion,\nfor which we derive a closed form formula for the above-mentioned\ndensity by inverting the Laplace transform. Finally, we apply the results to a problem of interest in financial risk-management and to the\nproblem of transient signal detection and identification of two-sided\nchanges in the drift of general diffusion processes.\n\n1. Introduction. In this paper we derive the Laplace transform of the\nprobability density of the drawdown of a units when it precedes the drawup\nof b units for a general diffusion process. The drawdown process is defined\nas the current drop of the process from its running maximum, while the\ndrawup process is defined as the current increase over its running minimum. The drawdown and the drawup are then the first hitting times of the\ndrawdown and the drawup processes respectively. The derivation is first accomplished in the case that a = b, by drawing the connection of the relevant\nevent to the range process. We then consider the case a 6= b and derive the\nLaplace transform through path decomposition. A key element in the above\nderivation is a function related to the first hitting times of the underlying\ndiffusion process. We then consider the special case of drifted Brownian motion with drift \u03bc and volatility \u03c3. In this case we are able to invert the\nLaplace transform and derive the density of the drawdown of a units when\nit precedes the drawup of b units, which we denote by p(\u03bc) (t; a, b). Finally,\nwe discuss the applications of the results to a problem of interest in finan\u2217\n\nCorresponding author\nAMS 2000 subject classifications: Primary 60G40; secondary 60J60\nKeywords and phrases: Drawdowns and Drawups; Diffusion Process; Stopping Time\n\n1\n\n\f2\n\nH. ZHANG AND O.HADJILIADIS\n\ncial risk-management and to the problem of transient signal detection and\nidentification of two-sided changes in the drift of general diffusion processes.\nOur results extend the work of Taylor [23] and Lehoczky [13]. Taylor\n[23] derives the joint Laplace transform of the drawdown and the maximum\nstopped at the drawdown in a drifted Brownian motion model. Lehoczky\n[13] extends the above result in the case of a diffusion process. However,\nnone of these results relate the drawdown to the drawup. In a recent paper\nof Salminen & Vallois [21], the joint distribution of the maximum drawdown\nand the maximum drawup processes is studied in a drifted Brownian motion\nmodel; yet it is not possible to extract information on the joint distribution\nof the drawdown and the drawup from this paper. In Hadjiliadis & Vecer\n[10], a closed-form formula is derived for the probability that the drawdown\nprecedes the drawup in a drifted Brownian motion model. This result is later\nextended to diffusion processes in Pospisil, Vecer & Hadjiliadis [19]. In Zhang\n& Hadjiliadis [27], the authors obtain the probability that the drawup of a\nunits precedes the drawdown of equal units in a drifted Brownian motion\nmodel in a finite time-horizon. However, the approach used there only applies to a drifted Brownian motion model, cannot be extended to a general\ndiffusion process, and does not work in the general case a 6= b. In this paper,\nwe supersede these limitations through the Laplace transform method.\nDrawdown processes have been extensively used in the financial riskmanagement literature. Grossman & Zhou [7], Cvitanic & Karatzas [5],\nChekhlov, Uryasev & Zabarankin [4] studied portfolio optimization under\nconstraints on the drawdown process. Magdon-Ismail et. al. [14] determined\nthe distribution of the maximum drawdown process of Brownian motion,\nbased on which they described another time-adjusted measure of performance known as the the Calmar ratio (see [15]). Meilijson [16] proved that\nthe drawdown can be viewed as the optimal exercise time of a certain type\nof look-back American put option. Other works which describe drawdown\nprocesses as dynamic measures of risk include Vecer [24, 25], Pospisil & Vecer [18], Pospisil, Vecer & Xu [20], Zhang & Hadjiliadis [27]. An overview of\nthe existing techniques for analysis of market crashes as well as a collection\nof empirical studies of the drawdown process and the maximum drawdown\nprocess please refer to Sornette [22].\nDrawdown processes do not only provide dynamic measures of risk, but\ncan also be viewed as measures of \"relative regret\". Similarly drawup processes can be viewed as measures of \"relative satisfaction\". Thus the a drawdown or a drawup of a certain number of units may signal the time in which\nan investor may choose to change his/her investment position depending\non his/her perception of future moves of the market and his/her risk aver-\n\n\fDRAWDOWNS AND DRAWUPS\n\n3\n\nsion. Using the results in our paper we are able to calculate the probability\nthat a relative drawdown of (100 \u00d7 \u03b1)% occurs before a relative drawup of\n(100 \u00d7 \u03b2)% in a finite time-horizon. On the other hand, a digital option\non the event that the relative drawdown occurs before the relative drawup\ncould also be seen as a means of protection. Our paper provides a closedform formula for the risk-neutral price of this digital option at time 0 both\nin the case of an infinite maturity and in the case of a finite maturity.\nDrawdown and drawup processes have also been used in the problem of\nquickest detection of abrupt changes in a stochastic process. More specifically, consider the situation in which a diffusion process is sequentially observed. At some unknown point in time, possibly as a result of the onset of\na signal, the dynamics of the process change abruptly in one of two possible opposite directions in the drift. Drawdowns and drawups then provide\na detection mechanism of the change point for each of the possible changes.\nThey are known as CUSUM stopping times in the statistics literature, and\ntheir properties have been extensively studied (see Barnard [1], Dobben [6],\nBissell [2], Woodall [26], Hadjiliadis & Moustakides [9], Khan [12], and Poor\n& Hadjiliadis [17]). A challenging problem in engineering is the detection\nand identification of such signals when they are only present for a finite period of time. These signals are known as transient signals. Using the results\nin this paper, it is possible to derive closed-form formulas for the probability of misidentification of the direction of the change in the drift when the\nsignal has exponential life. Moreover, using our results for drifted Brownian\nmotion, we derive this probability when the transient signal is present for a\nfinite period of time T .\nThe paper is structured in the following way: definitions and a fundamental lemma are introduced in Section 2. In Section 3, we derive the Laplace\ntransform of the drawdown of a units when it precedes the drawup of b units,\nin the cases a = b (Theorem 3.1), a > b (Theorem 3.2) and a < b (Theorem\n3.3). A special case of a drifted Brownian motion model is discussed in Section 4, where we also derive the closed-form density p(\u03bc) (t; a, b) by analytical\ninversion of the Laplace transform. We then present applications of our results in a problem of risk-management and the problem of transient signal\ndetection and identification of two-sided alternatives in Section 5. Finally,\nwe conclude with some closing remarks in Section 6.\n2. Drawdown and Drawup processes. We begin with a mathematical definition of a drawdown and a drawup in a diffusion model and present\nthe fundamental lemma.\nConsider an interval I = (l, r), where \u2212\u221e \u2264 l < r \u2264 \u221e. Let (\u03a9, F, P )\n\n\f4\n\nH. ZHANG AND O.HADJILIADIS\n\nbe a probability space, {Bt ; t \u2265 0} a Brownian motion, and {Xt ; t \u2265 0} the\nunique strong solution of the following stochastic differential equation:\n(2.1)\n\ndXt = \u03bc(Xt )dt + \u03c3(Xt )dBt , X0 = x \u2208 I,\n\nwhere Xt \u2208 I for all t \u2265 0, and \u03c3(u) > 0 for all u \u2208 I. We will use Px (*) to\ndenote P (*|X0 = x).\nThe drawdown and drawup processes are defined respectively as\n(2.2)\n\nDDt =\n\n(2.3)\n\nsup Xs \u2212 Xt ,\n\n0\u2264s\u2264t\n\nDUt = Xt \u2212 inf Xs .\n0\u2264s\u2264t\n\nThe drawdown of a units and the drawup of b units are then defined respectively as\n(2.4)\n(2.5)\n\nTD (a) = inf{t \u2265 0|DDt = a}, a > 0,\nTU (b) = inf{t \u2265 0|DUt = b}, b > 0,\n\nwhere, by convention, we assume that inf \u03c6 = \u221e.\nIn the following section, we derive the main results in this paper. We need\nthe following fundamental lemma to finish the proofs.\nLemma 1. Let us denote by \u03c4u , u \u2208 I, the first hitting time of the process\n{Xt ; t \u2265 0} to u. That is,\n\u03c4u = inf{t > 0|Xt = u},\nFor y \u2264 x \u2264 z and \u03bb \u2265 0, define\n(2.6)\nThen\n(2.7)\n\nh\n\nEx e\u2212\u03bb\u03c4y * 1{\u03c4y <\u03c4z }\n\nlX (y, z; x, \u03bb) =\n\ni\n\n:= lX (y, z; x, \u03bb).\n\ng(x; \u03bb)h(z; \u03bb) \u2212 g(z; \u03bb)h(x; \u03bb)\ng(y; \u03bb)h(z; \u03bb) \u2212 g(z; \u03bb)h(y; \u03bb)\n\nwith g(*; \u03bb) and h(*; \u03bb) being any two independent solutions of the ordinary\ndifferential equation\n(2.8)\n\n\u2202f\n1 2 \u22022f\n\u03c3 (u) 2 + \u03bc(u)\n= \u03bbf.\n2\n\u2202u\n\u2202u\n\nProof. See [13], page 603.\n\n\fDRAWDOWNS AND DRAWUPS\n\n5\n\n3. Mathematical Results. In this section we derive formulas for the\nLaplace transform of the probability density of the drawdown of a units when\nit precedes the drawup of b units, for any a, b > 0 satisfying x \u00b1 a, x \u00b1 b \u2208\nI \u0304 = [l, r]. We have\nh\n\n(3.1) Ex e\u2212\u03bbTD (a) * 1{TD (a)<TU (b)}\n\ni\n\n=\n\nZ\n\n0\n\n\u221e\n\ne\u2212\u03bbt Px (TD (a) \u2208 dt, TU (b) > t).\n\nIn the sequel we denote the Laplace transform (3.1) by LX\nx (\u03bb; a, b).\n3.1. The case of a = b > 0. We determine LX\nx (\u03bb; a, a) for a > 0 in this\nparagraph.\nTheorem 3.1.\n(3.2)\n\nFor a > 0 and \u03bb > 0, we have\n\nLX\nx (\u03bb; a, a) =\n\nZ\n\nx\n\nx\u2212a\n\n\u2202 X\nl (u, u + a; x, \u03bb)du.\n\u2202a\n\nProof. First, it is easily seen that for t > 0 and a > 0,\n(3.3)\n\n{TD (a) \u2208 dt, TU (a) > t} = {\u03c1(a) \u2208 dt, x \u2212 a < Xt < x},\n\nwhere \u03c1(a) is the first hitting time of the range process\n(3.4)\n\n\u03c1(a) = inf{t > 0|Rt = a},\n\nwith\n(3.5)\n\nRt := sup Xs \u2212 inf Xs = DUt + DDt .\ns\u2264t\n\ns\u2264t\n\nSo it suffices to determine\nh\n\ni\n\nEx e\u2212\u03bbt * 1{TD (a)\u2208dt,TU (a)>t,Xt =u} ,\nfor all x \u2212 a < u < x. For this purpose observe that for any t > 0, a > 0 and\nx \u2212 a < u < x,\n{TD (a) \u2208 dt, TU (a) > t, Xt = u} = {\u03c4u \u2208 dt, sup Xs = u + a},\ns\u2264t\n\n\f6\n\nH. ZHANG AND O.HADJILIADIS\n\nwhich suggests that for any \u03bb > 0,\nh\n\nEx e\u2212\u03bbTD (a) * 1{TD (a)<TU (a),XT\n=\n=\n\nZ\n\n\u221e\n\nZ0\u221e\n0\n\nZ\n\n\u221e\n\n=u}\nD (a)\n\nh\n\ni\n\ne\u2212\u03bbt * Ex 1{TD (a)\u2208dt,TU (a)>t,Xt =u}\nh\n\ne\u2212\u03bbt * Ex 1{\u03c4u \u2208dt,sups\u2264t Xs =u+a}\n\ni\n\ni\n\nh\ni\n\u2202\nEx 1{\u03c4u \u2208dt,sups\u2264t Xs <u+a}\n\u2202a\n0\nZ \u221e\ni\nh\n\u2202\nEx 1{\u03c4u =dt,\u03c4u+a >t}\ne\u2212\u03bbt *\n=\n\u2202a\n0\nh\ni\n\u2202\n=\nEx e\u2212\u03bb\u03c4u * 1{\u03c4u <\u03c4u+a } .\n\u2202a\n\n=\n\ne\u2212\u03bbt *\n\nFrom Lemma 1 it follows that\nh\n\n(3.6) Ex e\u2212\u03bbTD (a) * 1{TD (a)<TU (a),XT\n\nD (a)\n\n=u}\n\ni\n\n=\n\n\u2202 X\nl (u, u + a; x, \u03bb).\n\u2202a\n\nThen integration of the above identity over the interval (x \u2212 a, a) in u yields\n(3.2) and completes the proof of the theorem.\n3.2. The case of a > b > 0. We determine LX\nx (\u03bb; a, b) for a > b > 0 in\nthis paragraph. To prove the main result we need following proposition.\nProposition 1.\ndefine\n\nFor b > 0, c < u satisfying c, u + b \u2208 I, and \u03bb > 0,\nh\n\ni\n\nHuX (\u03bb; b, c) := Eu e\u2212\u03bb\u03c4c * 1{\u03c4c <TU (b)} .\n\n(3.7)\nThen\n\nHuX (\u03bb; b, c) = exp\n\n(3.8)\n\n\u0014Z\n\nu\nc\n\n\u2202\n\u2202w\n\n\u0015\n\nlX (v, v + b; w, \u03bb)dv .\nw=v\n\nProof. We follow the idea of [8], [13], , and partition the interval [c, u]\ninto k subintervals {[vi , vi\u22121 ]; 1 \u2264 i \u2264 k} with u = v0 > v1 > . . . > vk = c.\nLet \u2206k = max1\u2264i\u2264k (vi\u22121 \u2212 vi ) and assume \u2206k \u2192 0 as k \u2192 \u221e. As a discrete\napproximation to HuX (\u03bb; b, c) defined by (3.7), compute\n\u0014\n\n\u2212\u03bb\n\nEu e\n=\n\nk\nY\n\ni=1\n\nPk\n\n(\u03c4 \u2212\u03c4vi\u22121 )\ni=1 vi\n\nh\n\n* 1{after\ni\n\nEvi\u22121 e\u2212\u03bb\u03c4vi * 1{\u03c4vi <\u03c4v +b } ,\ni\n\n\u03c4vi\u22121 ,Xt hits vi before increasing to vi +b,1\u2264i\u2264k }\n\n\u0015\n\n\f7\n\nDRAWDOWNS AND DRAWUPS\n\nwhere the last equality follows from the strong Markov property.\nIt will be shown that as k \u2192 \u221e and \u2206k \u2192 0, the limit of above expression\nexists and does not depend on the particular sequence of partition chosen\nand hence is equal to HuX (\u03bb; b, c).\nBy Lemma 1,\nk\nY\n\nh\n\n\u2212\u03bb\u03c4vi\n\nEvi\u22121 e\n\ni=1\n\n* 1{\u03c4v\n\ni <\u03c4vi +b\n\n}\n\ni\n\nk\nY\n\n=\n\nlX (vi , vi + b; vi\u22121 , \u03bb).\n\ni=1\n\nTaking log gives us\nk\nX\n\n=\n=\n=\n\ni=1\nk\nX\n\ni=1\nk\nX\n\ni=1\nk\nX\n\ni=1\nu\n\n\u2192\n\nZ\n\nc\n\nh\n\ni\n\nlog lX (vi , vi + b; vi\u22121 , \u03bb)\nh\n\ni\n\nlog lX (vi , vi + b; vi , \u03bb) + lX (vi , vi + b; vi\u22121 , \u03bb) \u2212 lX (vi , vi + b; vi , \u03bb)\nh\n\ni\n\nlog 1 + lX (vi , vi + b; vi\u22121 , \u03bb) \u2212 lX (vi , vi + b; vi , \u03bb)\n\u2202\n\u2202w\n\u2202\n\u2202w\n\nw=vi\n\nlX (vi , vi + b; w, \u03bb) * (vi\u22121 \u2212 vi ) + O(\u2206k )\nas \u2206k \u2192 0+ ,\n\nlX (v, v + b; w, \u03bb)dv,\nw=v\n\nfrom which we obtain\nHuX (\u03bb; b, c) = exp\n\n\u0014Z\n\nu\nc\n\n\u2202\n\u2202w\n\n\u0015\n\nlX (v, v + b; w, \u03bb)dv .\nw=v\n\nThis completes the proof of Proposition 1.\nNow let us state and prove the main result in this paragraph.\nTheorem 3.2.\n(3.9)\n\nLX\nx (\u03bb; a, b)\n\nFor a > b > 0 and \u03bb > 0, we have\n=\n\nZ\n\nx\n\nx\u2212b\n\n\u2202 X\nl (u, u + b; x, \u03bb) * HuX (\u03bb; b, u \u2212 a + b)du.\n\u2202b\n\nProof. Any path in the event {TD (a) < TU (b)} has the decomposition\n1. {Xt ; 0 \u2264 t \u2264 TD (b)};\n2. {Xt+TD (b) ; 0 \u2264 t \u2264 TD (a) \u2212 TD (b)}.\n\n\f8\n\nH. ZHANG AND O.HADJILIADIS\n\nConditioning on XTD (b) = u, the process in 2. starts at u, and decreases to\nu \u2212 a + b before it incurs the drawup of b units occurs. This gives rise to the\nrepresentation\n(3.10)\n\nTD (a) = TD (b) + \u03c4u\u2212a+b \u25e6 \u03b8(TD (b)).\n\nTherefore, for x \u2212 b < u < x,\ne\u2212\u03bbTD (a) * 1{TD (a)<TU (b),XT\n\nD (b)\n\n\u2212\u03bb[TD (b)+\u03c4u\u2212a+b *\u03b8(TD (b))]\n\n= e\n\n=u}\n\n* 1{TD (a)<TU (b),XT\n\nD (b)\n\n= e\u2212\u03bbTD (b) * 1{TD (b)<TU (b),XT\n{z\n\n|\n\nD (b)\n\n=u}\n\n=u}\n\n}\n\nbefore TD (b)\n\n\u00d7 e\u2212\u03bb\u03c4u\u2212a+b \u25e6\u03b8(TD (b)) * 1{\u03c4u\u2212a+b \u25e6\u03b8(TD (b))<TU (b)\u25e6\u03b8(TD (b))} .\n\n(3.11)\n\n|\n\n{z\n\n}\n\nafter TD (b)\n\nTo get the expectation of the above expression under Ex [*], we first compute\nits conditional expectation under Eu [*|FTD (b) ]. By the strong Markov property, the factor \"before TD (b)\" is deterministic under Eu [*|FTD (b) ], and the\nfactor \"after TD (b)\" has conditional expectation\nh\n\nEu e\u2212\u03bb\u03c4u\u2212a+b \u25e6\u03b8(TD (b)) * 1{\u03c4u\u2212a+b \u25e6\u03b8(TD (b))<TU (b)\u25e6\u03b8(TD (b))} | FTD (b)\ni\n\nh\n\n= Eu e\u2212\u03bb\u03c4u\u2212a+b * 1{\u03c4u\u2212a+b <TU (b)} ,\n\ni\n\nwhich, by Proposition 1, is equal to HuX (\u03bb; b, u \u2212 a + b). Taking the expectation of (3.11) under Ex [*], and using (3.6), we obtain\n\u0014\n\n\u2212\u03bbTD (a)\n\nEx e\nh\n\n* 1{TD (a)<TU (b),XT\n\nD (b)\n\n= Ex e\u2212\u03bbTD (b) * 1{TD (b)<TU (b),XT\n(3.12) =\n\nD (b)\n\n=u}\n\n=u}\n\ni\n\n\u0015\n\n* HuX (\u03bb; b, u \u2212 a + b)\n\n\u2202 X\nl (u, u + b; x, \u03bb) * HuX (\u03bb; b, u \u2212 a + b).\n\u2202b\n\nThe integration of the above identity over the interval (x \u2212 b, x) in u yields\n(3.9) and completes the proof of Theorem 3.2.\n3.3. The case of b > a > 0. We determine LX\nx (\u03bb; a, b) for b > a > 0 in\nthis paragraph. To prove the main result we need the following proposition.\n\n\f9\n\nDRAWDOWNS AND DRAWUPS\n\nProposition 2.\n\u03bb > 0, define\n\nFor any a > 0 and x \u2208 I satisfying x \u2212 a \u2208 I, and\n\n(3.13)\n\nJxX (\u03bb; a) := Ex e\u2212\u03bbTD (a) .\n\nh\n\nThen\n\ni\n\nJxX (\u03bb; a)\n=\u2212\n\nZ\n\n\u221e\n\nx\n\n1I (u) *\n\n\u2202\n\u2202w\n\nw=u\n\nlX (u \u2212 a, u; w, \u03bb) * e\u2212\n\nRu\n\n\u2202\nlX (v,v\u2212a;w,\u03bb)dv\nx \u2202w w=v\n\n|\n\ndu.\n\nProof. See [13], page 602.\nNow let us state and prove the main result in this paragraph.\nTheorem 3.3.\nLX\nx (\u03bb; a, b)\n\n=\n\n(3.14)\n\nFor b > a > 0 and \u03bb > 0, we have\nZ\n\nx+a\n\n\u2202 2x\u2212X\nl\n(2x \u2212 v, 2x \u2212 v + a; x, \u03bb)\n\u2202a\nx\n2x\u2212X\nX\n\u00d7H2x\u2212v\n(\u03bb; a, 2x \u2212 v \u2212 b + a) * Jv+b\u2212a\n(\u03bb; a).\nJxX (\u03bb; a)\n\n\u2212\n\ndv\n\nProof. First, it is easily seen that for b \u2265 a > 0,\nLX\nx (\u03bb; a, b)\n\nJxX (\u03bb; a)\n\n=\n\n\u0014\n\n\u2212\u03bbTD (a)\n\n\u2212 Ex e\n\n* 1\b\n\nsups\u2264TD (a) DUs \u2265b\n\n\u0015\n\n.\n\nTherefore, to prove (3.14), it suffices to show that\n\u0014\n\n\u2212\u03bbTD (a)\n\nEx e\n\n* 1\b\n\nsups\u2264T\n\nD (a)\n\nDUs \u2265b\n\n(3.15)\n\n\u0015\n\nZ\n\nx+a\n\n\u2202 2x\u2212X\nl\n(2x \u2212 v, 2x \u2212 v + a; x, \u03bb)\n\u2202a\nx\n2x\u2212X\nX\n\u00d7H2x\u2212v\n(\u03bb; a, 2x \u2212 v \u2212 b + a) * Jv+b\u2212a\n(\u03bb; a).\n=\n\ndv\n\nTo do so we observe that for b \u2265 a,\nh\n\n(3.16)Ex e\u2212\u03bbTD (a) * 1{supt\u2264T\n\nD (a)\n\nDUt \u2265b}\n\ni\n\nh\n\ni\n\n= Ex e\u2212\u03bbTD (a) * 1{TU (b)<TD (a)} .\n\nAnd we are going to calculate the right hand side of (3.16) in the sequel.\nConsider the path decomposition for any path in the event {TU (b) <\nTD (a)}. We have\n1. {Xt ; 0 \u2264 t \u2264 TU (b)};\n2. {Xt+TU (b) ; 0 \u2264 t \u2264 TD (a) \u2212 TU (b)}.\n\n\f10\n\nH. ZHANG AND O.HADJILIADIS\n\nIntuitively, before time TU (b), the process experiences no drawdown of a\nunits and the first drawup of b units occurs at TU (b), when the process also\nreaches a new maximum; thereafter, the process has a drawdown of a units\nat time TD (a). Thus for any path in the event {TU (b) < TD (a)} we have\n(3.17)\n\nTD (a) = TU (b) + TD (a) \u25e6 \u03b8(TU (b)).\n\nTherefore, for b \u2265 a and x < v < x + a,\nh\n\nEx e\u2212\u03bbTD (a) * 1{supt\u2264T\n\n(3.18)\n\nh\n\nD (a)\n\nDUt \u2265b,XTU (a) =v}\n\n\u2212\u03bbTU (b)+TD (a)\u25e6\u03b8(TU (b))\n\n= Ex e\n\n* 1{supt\u2264T\n\nD\n\n\uf8ee\n\n\uf8ef\n\uf8ef\n\uf8f0|\n\n= Ex \uf8efe\u2212\u03bbTU (b) * 1{TU (b)<TD (a),XT\n\n=v}\nU (a)\n\n{z\n\nh\n\n(a) DUt \u2265b,XTU (a) =v}\n\n= Ex e\u2212\u03bbTU (b) * 1{TU (b)<TD (a),XT\nh\n\nafter TU (b)\n\nU\n\nh\n\nh\n\ne\u2212\u03bbTD (a)\ni\n\nX\n* Jv+b\u2212a\n(\u03bb; a)\n(a) =v}\n\n= Ex e\u2212\u03bbTU (b) * 1{TU (b)<TD (a),XT\n\n=v}\nU (a)\n\n\uf8fa\n\uf8fa\n\uf8fb\n\nU (b))\n\u00d7 |e\u2212\u03bbTD (a)\u25e6\u03b8(T\n{z\n}\uf8fa\n\n=v} Ev+b\u2212a\nU (a)\n\n= Ex e\u2212\u03bbTU (b) * 1{TU (b)<TD (a),XT\n\ni\n\n\uf8f9\n\n}\n\nbefore TU (b)\n\ni\n\ni\n\nii\n\nX\n* Jv+b\u2212a\n(\u03bb; a),\n\nwhere the third equality follows from the strong Markov property. The expectation in the last line can be determined as follows. Note that for the\nprocess {Yt = 2x \u2212 Xt , t \u2265 0},\n\u2032\n\ndYt = \u2212\u03bc(2x \u2212 Yt )dt + \u03c3(2x \u2212 Yt )dBt , Y0 = x\n\u0010\n\n\u2032\n\nwith Bt = \u2212Bt , the vector of random variables TDY (b), TUY (a), 2x \u2212 YT Y (a)\n\u0010\n\nD\n\n\u0011\n\nhas the same law as the vector of random variables TD (a), TU (b), XTU (a)\nfor {Xt ; t \u2265 0} under Ex [*]. So we know from (3.12) that\nh\n\nEx e\u2212\u03bbTU (b) * 1{TU (b)<TD (a),XT\n\n(3.19)\n\n\u0014\n\nU (a)\n\n=v}\n\nY\n\n= Ex e\u2212\u03bbTD (b) * 1{T Y (b)<T Y (a),Y\nD\n\nU\n\nT Y (a)\nD\n\ni\n\n1\n\n\u0011\n\nfor Xt\n\n=2x\u2212v}\n\n\u0015\n\nfor Yt\n\n\u2202 2x\u2212X\n2x\u2212X\nl\n(2x \u2212 v, 2x \u2212 v + a; x, \u03bb) * H2x\u2212v\n(\u03bb; a, 2x \u2212 v \u2212 b + a).\n\u2202a\nThe integration of (3.18) over the interval (x, x + a) in v yields (3.15) and\ncompletes the proof of Theorem 3.3.\n=\n\nWe now proceed to treat separately the case of a drifted Brownian motion\nmodel.\n1\n\nY\nTD\n(b) and TUY (a) are the drawdown and drawup of the process {Yt ; t \u2265 0} respectively.\n\n\f11\n\nDRAWDOWNS AND DRAWUPS\n\n4. A study of Brownian motion. In this section, we apply the results\nin Theorem 3.1, Theorem 3.2 and Theorem 3.3 to a drifted Brownian motion\nmodel and calculate the probability density of the drawdown of a units when\nit precedes the drawup of b units.\nFirst it is easily seen that I = (\u2212\u221e, \u221e) in a drifted Brownian motion\nmodel. The function lX (y, z; x, \u03bb) for Xt = x + \u03bct + \u03c3Wt can be found in [3]\npage 295:\nlX (y, z; x, \u03bb) =\n\n(4.1)\n\np\n\nsinh[(z \u2212 x)S\u03bc,\u03c3 (\u03bb)] \u03bc(y\u2212x)\ne \u03c32 ,\nsinh[(z \u2212 y)S\u03bc,\u03c3 (\u03bb)]\n\nwhere S\u03bc,\u03c3 (\u03bb) = (2\u03bb/\u03c3 2 ) + (\u03bc2 /\u03c3 4 ). Thus the Laplace transforms in Theorem 3.1, Theorem 3.2 and Theorem 3.3 can be calculated explicitly as:\n1. a = b > 0:\nLX\n0 (\u03bb; a)\n\n\uf8f1 \u03bca \u0002\n\u2212\nS\u03bc,\u03c3 (\u03bb) \uf8f2 e \u03c32 S\u03bc,\u03c3 (\u03bb) coth[aS\u03bc,\u03c3 (\u03bb)] +\n(2\u03bb/\u03c3 2 ) \uf8f3\nsinh[aS\u03bc,\u03c3 (\u03bb)]\n)\n\n=\n\n(4.2)\n\n\u2212\n\nS\u03bc,\u03c3 (\u03bb)\nsinh2 [aS\u03bc,\u03c3 (\u03bb)]\n\n\u03bc\u0003\n\u03c3\n\n;\n\n2. a > b > 0:\nX\nLX\n0 (\u03bb; a, b) = L0 (\u03bb; b) * exp [T\u03bc,\u03c3 (\u03bb; b)(a \u2212 b)] ,\n\n(4.3)\nwhere\n\nT\u03bc,\u03c3 (\u03bb; b) = \u2212\n\n(4.4)\n\n\u03bc\n\u2212 S\u03bc,\u03c3 (\u03bb) coth[bS\u03bc,\u03c3 (\u03bb)];\n\u03c32\n\n3. b > a > 0:\n(4.5)\n\nh\n\ni\n\n\u2212X\nT\u2212\u03bc,\u03c3 (\u03bb;a)(b\u2212a)\nLX\n* J0X (\u03bb; a),\n0 (\u03bb; a, b) = 1 \u2212 L0 (\u03bb; a) * e\n\nwhere\n\n\u03bca\n\nJ0X (\u03bb; a)\n\n=\n\nS\u03bc,\u03c3 (\u03bb)e\u2212 \u03c32\nS\u03bc,\u03c3 (\u03bb) cosh[aS\u03bc,\u03c3 (\u03bb)] \u2212 (\u03bc/\u03c3 2 ) sinh[aS\u03bc,\u03c3 (\u03bb)]\n\u03bca\n\n(4.6)\n\nS\u03bc,\u03c3 (\u03bb; a)e\u2212 \u03c32\n1\n= \u2212\n*\n.\nsinh[aS\u03bc,\u03c3 (\u03bb; a)] T\u2212\u03bc,\u03c3 (\u03bb; a)\n\nOne can easily obtain several known results from (4.2), (4.3) and (4.5).\nFirst, by letting \u03bb \u2192 0+ , the formulas coincide with the probability results\nin Hadjiliadis & Vecer [10]. Second, by letting b \u2192 \u221e in (4.5), one obtains\nthe Laplace transform of TD (a), J0X (\u03bb; a).\nMoreover, we can invert (4.3) analytically to obtain the density P (TD (a) \u2208\ndt, TU (b) > t) for any a \u2265 b > 0. In fact we have\n\n\f12\n\nH. ZHANG AND O.HADJILIADIS\n\nTheorem 4.1.\na \u2265 b > 0, then\np\n\n(\u03bc)\n\nDefine p(\u03bc) (t; a, b)dt = P (TD (a) \u2208 dt, TU (b) > t) for\n\u0015\n\u0014\n\u221e\nX\n(m + n + 1)! 2(a \u2212 b) m\n2 \u2212 \u03bc22t \u2212 \u03bc(a\u2212b)\n2\n\u03c3\n\u221a\ne 2\u03c3\nt\n(m + 1)!m!n!\n\u03c3 t\nm,n=0\n\n(t; a, b) =\n\n\u0014\n\n\u03bcb\n\n\u0015\n\n\u03bcb\n\n(1)\n(2)\n(3)\n\u00d7 2Fm,n\n(t) \u2212 e\u2212 \u03c32 Fm,n\n(t) \u2212 \u03b4n e\u2212 \u03c32 Fm\n(t)\n\n\u0015\n\u0014\n\u221e\nX\n(m + n + 1)! 2\u03bc(a \u2212 b) m\n2\u03bc2 \u2212 \u03bc(a\u2212b)\n2\n\u03c3\n+ 2 e\n\u00d7\n\u03c3\n(m + 1)!m!n!\n\u03c32\nm,n=0\n\u0014\n\n(4.7)\n\n(\u03bc)\n\n\u03bcb\n\n(\u2212\u03bc)\n\n(\u03bc)\n\nGm+n+ 1 (t) + (\u22121)m Gm+n+ 1 (t) \u2212 e\u2212 \u03c32 Gm+n+1 (t)\n2\n\n\u03bcb\nm \u2212 \u03c32\n\n\u2212(\u22121) e\n\n2\n\n\u0015\n\n(\u2212\u03bc)\nGm+n (t)\n\n,\n\nwhere \u03b4n is the Kronecker delta and\n\" \u221a #2k\n\u230a m+1\n\u0015\n\u0014\n2 \u230b\nX\n\u03bc t\n(m+1\u22122k) (2m + 2n + 1)b + a\n\u221a\n=\n,\n\u03c6\n\u03c3\n\u03c3 t\nk=0\n\" \u221a #\n\u0015\n\u0015\n\u0014\nm+1\nX \u03bc t k\u0014\n+ 1)b + a\n(2)\n(m+1\u2212k) 2(m + n \u221a\nkm+n+2\nFm,n (t) =\n\u03c6\n1 + (\u22121)\n\u03c3\nn+1\n\u03c3 t\nk=0\n\"\n#\n\u221a\nk\n\u0015\n\u0014\nm+1\nX\n\u03bc t\n2mb + a\n(3)\n\u221a\n,\n\u2212\nFm\n(t) =\n\u03c6(m+1\u2212k)\n\u03c3\n\u03c3 t\nk=0\n(1)\nFm,n\n(t)\n\n(\u03bc)\nGm\n(t) =e\n\n\u03bc(2mb+a)\n\u03c32\n\n\u03a6\n\n\u0014\n\n\u0015\n\n2mb + a + \u03bct\n\u221a\n,\n\u03c3 t\n\nwith \u03c6 and \u03a6 being the standard normal probability density and cumulative\ndistribution respectively. \u03c6(k) is the k-th derivative of \u03c6.\nProof. We start by rewriting (4.3) in a more tractable way,\n(4.8)\n\nZ\n\n0\n\n\u2212b\n\n\u03bcu\n\ndue \u03c32\n\nS\u03bc,\u03c3 (\u03bb) sinh[(\u2212u)S\u03bc,\u03c3 (\u03bb)]\n* exp [T\u03bc,\u03c3 (\u03bb; b)(a \u2212 b)] .\nsinh2 [bS\u03bc,\u03c3 (\u03bb)]\n\nBy using the first formula on page 643 of [3], in their notation, we obtain\nthe inverse Laplace transform of the integrand in (4.8)\n\u03c3 2 \u2212 \u03bc22t + \u03bc(u+b\u2212a)\n\u03c32\ne 2\u03c3\n[es\u03c32 t (1, 2, b, u, a \u2212 b) \u2212 es\u03c32 t (1, 2, b, \u2212u, a \u2212 b)] .\n2\n\n\f13\n\nDRAWDOWNS AND DRAWUPS\n\nAfter some simple manipulation, the above expression becomes\n\u03bc2 t\n\n(4.9)\n\u001a\n\n\u03bc(u+b\u2212a)\n\n2e\u2212 2\u03c32 + \u03c32\n\u221a\n\u03c3 t3\n\u0015\n\n\u0014\n\n\u0014\n\u0015\n\u221e\nX\n(m + n + 1)! 2(a \u2212 b) m\n\n(m + 1)!m!n!\nm,n=0\n\n\u221a\n\u03c3 t\n\n\u0014\n\n(2m + 2n + 1)b + a \u2212 u\n(2m + 2n + 1)b + a + u\n\u221a\n\u221a\n\u2212 \u03c6(m+2)\n\u03c3 t\n\u03c3 t\nFormula (4.7) follows from integration of (4.9) over (\u2212b, 0) in u.\n\u03c6(m+2)\n\n\u0015\u001b\n\n\u00d7\n\n.\n\nOne can let a = b in (4.9) to get a similar joint probability density as that\nin Proposition 1 of [27].\nSimilarly, we can invert (4.5) analytically to get the joint density\nP (TD (a) \u2208 dt, sup DUs \u2208 a + dz) =\ns\u2264t\n\n\u2202 (\u03bc)\np (t; a, a + z)dtdz\n\u2202z\n\n\u2200a, z > 0.\n\nIn particular we have\nTheorem 4.2. For a Brownian motion with constant drift \u03bc and constant volatility \u03c3, any a, z > 0, we have\n\u03bc2 t\n\n\u03bc(z\u2212a)\n\n\u2202 (\u03bc)\n4e\u2212 2\u03c32 + \u03c32\n\u221a\np (t; a, a + z) = \u2212\n\u2202z\n\u03c3 t3\nh\n\n\u0013\n\u0012\n\u221e\nX\n(m + n + 2)!\n2z m\n\nm,n=0\n\n\u221a\n\u03c3 t\n\n(m + 2)!m!n!\n\n\u03bca\n\n\u03bca\n\ni\n\n(1)\n(2)\n(3)\n\u00d7 2Fm,n\n(t, z) \u2212 e \u03c32 Fm,n\n(t, z) \u2212 \u03b4n e \u03c32 Fm\n(t, z)\n\n\u2212\n\u0014\n\n\u0013\n\u0012\n\u221e\nX\n4\u03bc3 \u03bc(z\u2212a)\n(m + n + 2)! 2\u03bcz m\n\u03c32\n\u00d7\ne\n\u03c34\n(m + 2)!m!n! \u03c3 2\nm,n=0\n(\u03bc)\n\n\u03bca\n\n(\u2212\u03bc)\n\n(\u03bc)\n\nGm+n+ 1 (t, z) \u2212 (\u22121)m Gm+n+ 1 (t, z) \u2212 e \u03c32 Gm+n (t, z)\n2\n\nm\n\n+(\u22121) e\n\n(4.10)\n\n2\n\n\u03bca\n\u03c32\n\ni\n\n(\u2212\u03bc)\nGm+n+1 (t, z)\n\nwhere\n\n\" \u221a #2k\n\u230a m+2\n\u0015\n\u0014\n2 \u230b\nX\n\u03bc t\n(2m + 2n + 3)a + z\n\u221a\n,\n=\n\u03c6(m+2\u22122k)\n\u03c3\n\u03c3\nt\nk=0\n\" \u221a #\n\u0015\n\u0015\n\u0014\nm+2\nX \u03bc t k\u0014\nm + n + 3 (m+2\u2212k) (2m + 2n + 4)a + z\n(2)\nk\n\u221a\nFm,n (t, z) =\n\u03c6\n(\u22121) +\n\u03c3\nn+1\n\u03c3 t\nk=0\n\" \u221a #\n\u0015\n\u0014\nm+2\nX \u03bc t k\n(2m + 2)a + z\n(3)\n\u221a\nFm (t, z) =\n,\n\u03c6(m+2\u2212k)\n\u03c3\n\u03c3 t\nk=0\n(1)\nFm,n\n(t, z)\n\n(\u03bc)\nGm\n(t, z) =e\n\n\u03bc[2(m+1)a+z]\n\u03c32\n\n\u03a6\n\n\u0014\n\n\u0015\n\n2(m + 1)a + z + \u03bct\n\u221a\n.\n\u03c3 t\n\n\f14\n\nH. ZHANG AND O.HADJILIADIS\n\nProof. We start from the equality\nLX\n0 (\u03bb; a, b)\nT\u2212\u03bc,\u03c3 (\u03bb;a)(b\u2212a) X\n=J0X (\u03bb; a) \u2212 L\u2212X\nJ0 (\u03bb; a)\n0 (\u03bb; a)e\n\n=J0X (\u03bb; a)\n\n\u2212\n\n=LX\n0 (\u03bb; a) +\n\nX\nL\u2212X\n0 (\u03bb; a)J0 (\u03bb; a)\n\nZ\n\n0\n\ndu\n\n\u2212a\n\nZ\n\nb\u2212a\n\ndz\n\n+\n\nS\u03bc,\u03c3 (\u03bb; a)L\u2212X\n0 (\u03bb; a)\n\u03bca\n\u03c32\n\nZ\n\nb\u2212a\n\n0\nsinh[aS\u03bc,\u03c3 (\u03bb; a)]e\n2\n[S\u03bc,\u03c3 (\u03bb; a)] sinh[(\u2212u)S\u03bc,\u03c3 (\u03bb; a)]\n3\n\n0\n\nsinh [aS\u03bc,\u03c3 (\u03bb; a)]e\n\n\u03bc(u+a)\n\u03c32\n\neT\u2212\u03bc,\u03c3 (\u03bb;a)z dz\neT\u2212\u03bc,\u03c3 (\u03bb;a)z\n\nBy using the first formula on page 643 of [3], the integrand in the last line\nhas inverse Laplace transform\n\u03c3 2 \u2212 \u03bc22t \u2212 \u03bc(u\u2212z+a)\n\u03c32\n[es\u03c32 t (2, 3, a, u, z) \u2212 es\u03c32 t (2, 3, a, \u2212u, z)].\ne 2\u03c3\n2\nAfter some simple manipulation, the above expression becomes\n\u03bc2 t\n\n(4.11)\n\u001a\n\n(m+3)\n\n\u03c6\n\n\u03bc(u\u2212z+a)\n\u03c32\n\n4e\u2212 2\u03c32 \u2212\n\u03c3 2 t2\n\u0014\n\n\u0015\n\n\u221e\nX\n\n(m + n + 2)!\n(m\n+ 2)!m!n!\nm,n=0\n\u0014\n\n\u0012\n\n2z\n\u221a\n\u03c3 t\n\n\u0013m\n\n(2m + 2n + 3)a + z + u\n(2m + 2n + 3)a + z \u2212 u\n\u221a\n\u221a\n\u2212 \u03c6(m+3)\n\u03c3 t\n\u03c3 t\n\n\u00d7\n\n\u0015\u001b\n\n.\n\nThe integration of (4.11) over (\u2212a, 0) in u yields (4.10) and completes the\nproof.\n5. Application.\n5.1. Relative drawdowns and relative drawups of stock prices. Consider\nthe case of a stock with geometric Brownian motion dynamics under a probability measure P :\n(5.1)\n\ndSt = \u03bcSt dt + \u03c3St dWt , S0 = 1.\n\nUsing Theorem 4.1 and Theorem 4.2, we are in the position to address\nthe following question:\nWhat is the probability that this stock would drop by (100\u00d7\u03b1)%\nfrom its historical high before it incurs a rise of (100 \u00d7 \u03b2)% from\nits historical low in a pre-specified plan horizon T ?\nFirst observe that\n(5.2)\n\nd log St = \u03bddt + \u03c3dWt , log S0 = 0,\n\n\fDRAWDOWNS AND DRAWUPS\n\n15\n\nwhere \u03bd = \u03bc \u2212 12 \u03c3 2 represents the logarithm of the return of the stock.\nNow define the running maximum and the running minimum of the stock\nprocess {St }\nMt = sup Ss ,\n\nNt = inf Ss .\ns\u2264t\n\ns\u2264t\n\nWe also let UD (\u03b1) be the first time the stock drops by (100 \u00d7 \u03b1)% from its\nhistorical high and UR (\u03b2) the first time that the stock rises by an amount\nequal to (100 \u00d7 \u03b2)% from its historical low. That is,\n(5.3)\n\nUD (\u03b1) = inf{ t \u2265 0| St = (1 \u2212 \u03b1)Mt },\n\n(5.4)\n\nUR (\u03b2) = inf{ t \u2265 0| St = (1 + \u03b2)Nt }.\n\nThus, it is possible to calculate the exact expression for the probability\nthat a percentage relative drop of (100 \u00d7 \u03b1)% precedes a relative rise of\n(100 \u00d7 \u03b2)% by noticing that\n(\n\n(5.5)\n\nUD (\u03b1) = TD (\u2212 log(1 \u2212 \u03b1))\n.\nUR (\u03b2) = TU (log(1 + \u03b2))\n\nAnd this probability can be calculated explicitly as\nP (UD (\u03b1) \u2227 T < UR (\u03b2) \u2227 T ) =\n\nZ\n\n0\n\nT\n\np(\u03bd) (t; \u2212 log(1 \u2212 \u03b1), log(1 + \u03b2))dt.\n\nMoreover, a digital option on the event that the relative drawdown precedes the relative drawup can also be perceived as a means of protection\nagainst adverse movements in the market. In particular, the discounted payoff of this digital option can be written as\nP O(\u03b1, \u03b2) = e\u2212rt * 1{UD (\u03b1)\u2208dt,UR (\u03b2)>t} * 1{t\u2264T } ,\n\n(5.6)\n\nwhere r > 0 is the risk-free interest rate and T is the maturity of the option.\nUnder a risk-neutral measure Q, the stock price and its logarithm have\nthe following dynamics respectively,\n(5.7)\n\ndSt = rSt dt + \u03c3St dWt , S0 = 1,\n\n(5.8)\n\nd log St = \u03bd dt + \u03c3dWt , log S0 = 0,\n\n\u2032\n\n\u2032\n\nwhere \u03bd = r \u2212 12 \u03c3 2 .\nUsing (5.5) and our results we are able to derive the risk-neutral price at\ntime 0 of this digital option:\n\n\f16\n\nH. ZHANG AND O.HADJILIADIS\n\nIn the case of a perpetual option (see [11]), the risk-neutral price of the\ndigital option is already given by the Laplace transform (4.2), (4.3) and\n(4.5). In particular,\nS\nQ[P O(\u03b1, \u03b2)] = Llog\n(r; \u2212 log(1 \u2212 \u03b1), log(1 + \u03b2)).\n0\n\nIn the case of a finite life option maturing at time T < \u221e, we can apply the\ndensities (4.7) and (4.10) to calculate the risk-neutral price.\n1. (1 \u2212 \u03b1)(1 + \u03b2) \u2264 1:\n(5.9) Q[P O(\u03b1, \u03b2)] =\n\nZ\n\n0\n\nT\n\n\u2032\n\ne\u2212rt p(\u03bd ) (t; \u2212 log(1 \u2212 \u03b1), log(1 + \u03b2))dt;\n\n2. \u03b4 = (1 \u2212 \u03b1)(1 + \u03b2) > 1:\n(5.10) Q[P O(\u03b1, \u03b2)] \u2212 Q[P O(\u03b1, \u03b1/(1 \u2212 \u03b1))]\n=\n\nZ\n\nT\n\n\u2212rt\n\ne\n0\n\n\"Z\n\nlog \u03b4\n\n0\n\n#\n\n\u2202 (\u03bd \u2032 )\np (t; \u2212 log(1 \u2212 \u03b1), \u2212 log(1 \u2212 \u03b1) + z)dz dt.\n\u2202z\n\n5.2. The problem of transient signal detection and identification of two\nsided changes. In this example, we present the problem of transient signal\ndetection and identification of two-sided changes in the drift of a general\ndiffusion process. More specifically, we give the formulas for the probabilities\nof misidentifying the direction of the signal both in the case of exponential\nlife transient signals and in the case of deterministic life transient signals.\nIn particular, let {Xt , t \u2265 0} be a diffusion process with the initial value\nX0 = x and the following dynamics up to a deterministic time \u03c4 :\n(5.11)\n\ndXt = \u03c3(Xt )dWt ,\n\nt \u2264 \u03c4.\n\nFor t > \u03c4 , the process evolves according to one of the following stochastic\ndifferential equations:\n(5.12)\n\ndXt = \u03bc(Xt )dt + \u03c3(Xt )dWt\n\n(5.13)\n\ndXt = \u2212\u03bc(Xt )dt + \u03c3(Xt )dWt\n\nt > \u03c4,\nt > \u03c4,\n\nwith initial condition y = X\u03c4 .\nThe time of the regime change, \u03c4 , is deterministic but unknown. We\nobserve the process {Xt , t \u2265 0} sequentially and our goal is to detect the\ntime of onset of the signal, as well as possibly identity its direction, before\nthe signal disappears.\n\n\fDRAWDOWNS AND DRAWUPS\n\n17\n\nLet us denote by Px\u03c4,+ and Px\u03c4,\u2212 the probability measures generated on\nthe space of continuous functions C[0, \u221e) by the process {Xt , t \u2265 0}, if the\nregime changes at time \u03c4 from (5.11) to (5.12) and from (5.11) to (5.13),\nrespectively.\nIn this context suppose that the drawdown of a units, TD (a), can be used\nas a means of detecting the change in the dynamics of {Xt , t \u2265 0} from\n(5.11) to (5.13). Then the drawup of b units, TU (b) may be used as a means\nof detecting the change in the dynamics of {Xt , t \u2265 0} from (5.11) to (5.12).\nFor example, in the case that \u03bc(*) = \u03bc > 0, it is easy to see that the drawup\ncould be used as a means of detecting a change from (5.11) to (5.12), while\nthe drawdown would provide a means of detecting a change from (5.11) to\n(5.13). In particular, T (a, b) = min{TD (a), TU (b)}, also known as the twosided CUSUM (see Khan [12]), has been extensively used as a means of\ndetecting two-sided alternatives in the drift (see Barnard [1], Dobben [6],\nBissell [2], Woodall [26], and Poor & Hadjiliadis [17]). In the special case in\nwhich \u03bc(*) = \u03bc > 0 and there is no reason to believe that a change from\n(5.11) to (5.13) is more or less likely than a change from (5.11) to (5.12),\nit is natural to use thresholds a = b. However, in the general case different\nthresholds a and b could be used.\nIn many applications in engineering, the life of the signal after its onset is\noften limited. The lifetime of the signal is also random and may not depend\non the dynamics of the underlying process. In the case of exponential life\ntransient signals, the signals are present (after \u03c4 ) for a period of time \u03b6,\nwhere \u03b6 is an independent exponentially distributed random variable with\nparameter \u03bb > 0. Theorems 3.1, 3.2 and 3.3 can be used to compute the\nprobability of sequential misidentification of the signal in the case that the\nonset of the signal occurs at time 0. More specifically,\nPx0,+ (TD (a)\n\n\u2227 \u03b6 < TU (b) \u2227 \u03b6) =\n=\n\n(5.14)\n\n=\n\nZ\n\n0\n\nZ\n\n\u221e\n\u221e\n\nPx0,+ (TD (a) \u2227 t < TU (b) \u2227 t) * \u03bbe\u2212\u03bbt dt\ne\u2212\u03bbt Px0,+ (TD (a) \u2208 dt, TU (b) > t)dt\n\n0\n0,+\nLX\n(\u03bb; a, b),\nx\n\nwhere X 0,+ follows (5.12) with \u03c4 = 0, expresses the probability that an alarm\nindicating that the regime switched to (5.13) will occur before \u03b6 and an alarm\nindicating that the regime switched to (5.13) while in fact (5.12) is the true\nregime. Thus (5.14) can be seen as the probability of a misidentification.\nMoreover, in the case that the density of the random variable X\u03c4 admits a\n\n\f18\n\nH. ZHANG AND O.HADJILIADIS\n\nclosed-form representation, we can also compute\nZ\n\n(5.15)\n=\n\nZ\n\nPy\u03c4,+ (TD (a) \u25e6 \u03b8(\u03c4 ) \u2227 \u03b6 < TU (b) \u25e6 \u03b8(\u03c4 ) \u2227 \u03b6)fX\u03c4 (y|x)dy\nLX\ny\n\n0,+\n\n(\u03bb, a, b)fX\u03c4 (y|x)dy,\n\nwhich can be interpreted as the aggregate probability (or unconditional\nprobability) of a misidentification for any given change-point \u03c4 .\nIn the case of deterministic life transient signals, the signals are present\n(after \u03c4 ) for a finite period of time T . Using Theorem 4.1 we are still able\nto compute the probability of misidentification for Brownian motion (\u03c3(*) =\n\u03c3 > 0, \u03bc(*) = \u03bc). More specifically,\n(5.16)\n\nPx\u03c4,+ (TD (a)\n\n\u25e6 \u03b8(\u03c4 ) \u2227 T < TU (a) \u25e6 \u03b8(\u03c4 ) \u2227 T ) =\n\nZ\n\nT\n\np(\u03bc) (t; a, a)dt,\n\n0\n\nexpresses the probability of misidentification for any given change-point \u03c4 .\n6. Conclusion. In this paper we derive a closed-form expression for the\nLaplace transform of the drawdown of a units when it precedes the drawup\nof b units for a general diffusion process. We then derive the probability density of a drawdown when it precedes a drawup in the special case of a drifted\nBrownian motion model by inverting the Laplace transform. Although several authors in the literature have studied drawdowns and drawups ([23],\n[13], [10], [19], [21], [27]), this paper summarizes the probabilistic properties\nof a drawdown on the event that it precedes a drawup for a general diffusion\nprocess. These results are of practical interest in two main areas: financial\nrisk-management and transient signal detection and identification.\nReferences.\n[1] BARNARD, G. (1959). Control charts and stochastic processes, Journal of the Royal\nStatistical Society: B 21 239-257.\n[2] BISSEL, A. (1969). Cusum techiniques for quality control, Applied Statistics 18 1-30.\n[3] BORODIN, A.N. and SALMINEN, P. (2002). Handbook of Brownian Motion - Facts\nand Formulae, second edition.\n[4] CHEKHLOV, A., URYASEV, S. and ZABARANKIN, M. (2005). Drawdown measure\nin portfolio optimization, International Journal of Theoretical and Applied Finance\n8/1 13-58.\n[5] CVITANIC, J. and KARATZAS, I. (1995). On portfolio optimization under drawdown\nconstraints, IMA Lecture Notes in Mathematics and Applications 65 77-88.\n[6] VAN Dobben DE BRUYN, D. S. (1968). Cumulative sum tests: theory and practice,\nHafner, New York.\n[7] GROSSMAN, S. J. and ZHOU, Z. (1993). optimal investment strategies for controlling\ndrawdowns, Mathematical Finance 3/3 241-276.\n\n\fDRAWDOWNS AND DRAWUPS\n\n19\n\n[8] HADJILIADIS, O., HERNANDEZ-DEL-VALLE, G. and STAMOS, I. (2009). A comparison of 2-CUSUM stopping rules for quickest detection of two-sided alternatives\nthrough the derivation of the mean of a general 2-CUSUM, Sequential Analysis 28\n92-114.\n[9] HADJILIADIS, O. and MOUSTAKIDES, G. V. (2006). Optimal and asymptotically\noptimal CUSUM rule for change point detection in the Brownian motion model with\nmultiple alternatives, Theory of Probability and its Applications 50/1 131-144.\n[10] HADJILIADIS, O. and VECER, J. (2006). Drawdowns preceding rallies in a Brownian motion process, Quatitative Finance 6/5 403-409.\n[11] KARATZAS, I. and SHREVE, S. (2001). Methods of Mathematical Finance, SpringerVerlag, New York.\n[12] KHAN, R.A. (2008). Distributional properties of CUSUM stopping times, Sequential\nAnalysis 27/4 420-434.\n[13] LEHOCZKY, J.P. (1977). Formulas for stopped diffusion processes with stopping\ntimes based on the maximum, Annals of Probability 5/4 601-607.\n[14] MAGDON-ISMAIL, M., ATIYA, A., PRATAP, A. and ABU-MOSTAFA, Y. (2004).\nOn the maximum drawdown of a Brownian motion, Journal of Applied Probability\n41/1 147-161.\n[15] MAGDON, M. and ATIYA, A. (2004). Maximum drawdown, Risk 17/10 99-102.\n[16] MEILIJSON, I. (2003). The time to a given drawdown in Brownian motion, Seminaire\nde Probabilit\u00e9s XXXVII 94-108.\n[17] POOR, H. V. and HADJILIADIS, O. (2008). Quickest Detection, Cambridge University Press, Cambridge, UK.\n[18] POSPISIL, L. and VECER, J. (2007). Portfolio sensitivities to the\nchanges in the maximum and the maximum drawdown, submitted 2008.\nhttp://www.stat.columbia.edu/\u223cvecer/portfsens.pdf\n[19] POSPISIL, L., VECER, J. and HADJILIADIS, O. (2009). Formulas for stopped\ndiffusion processes with stopping times based on drawdowns and drawups, Stochastic\nProcesses and Their Applications.\n[20] POSPISIL, L., VECER, J., and XU, M. (2008). Tradeable measures of risk, submitted\n2008. http://www.stat.columbia.edu/\u223c vecer/RiskMeasures37.pdf\n[21] SALMINEN, P. and VALLOIS, P. (2007). On maximum increase and decrease of\nBrownian motion, Annales de l'institut Henri Poincare (B) Probability and Statistics\n43/6 655-676.\n[22] SORNETTE, D. (2003). Why stock markets crash: critical events in complex financial\nsystems, Princeton University Press: Princeton NJ.\n[23] TAYLOR, H. M. (1975). A stopped Brownian motion formula, Annals of Probability\n3/2 234-246.\n[24] VECER, J. (2006). Maximum drawdown and directional trading. Risk 19/12 88-92.\n[25] VECER, J. (2007). Preventing portfolio losses by hedging maximum drawdown,\nWilmott 5/4 1-8.\n[26] WOODALL, W. H. (1984). On the Markov chain approach to the two-sided CUSUM\nprocedure, Technometrics 26 41-46.\n[27] ZHANG, H. and HADJILIADIS, FO. (2009). Drawdowns and rallies in a finite timehorizon, Methodology and Computing in Applied Probability special issue.\nDepartment of Mathematics\n365 Fifth Avenue\nNew York, NY 10016\nE-mail: hzhang3@gc.cuny.edu\nohadjiliadis@brooklyn.cuny.edu\n\n\f"}