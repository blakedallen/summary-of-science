{"id": "http://arxiv.org/abs/1012.0753v1", "guidislink": true, "updated": "2010-12-03T14:43:07Z", "updated_parsed": [2010, 12, 3, 14, 43, 7, 4, 337, 0], "published": "2010-12-03T14:43:07Z", "published_parsed": [2010, 12, 3, 14, 43, 7, 4, 337, 0], "title": "An asymptotic approximation of the marginal likelihood for general\n  Markov models", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1012.2732%2C1012.5325%2C1012.4350%2C1012.1718%2C1012.0919%2C1012.1335%2C1012.3823%2C1012.4280%2C1012.1692%2C1012.5837%2C1012.3816%2C1012.5332%2C1012.2994%2C1012.5828%2C1012.1654%2C1012.5315%2C1012.0572%2C1012.1905%2C1012.2265%2C1012.0851%2C1012.0109%2C1012.0946%2C1012.3962%2C1012.4254%2C1012.3889%2C1012.1869%2C1012.2849%2C1012.1355%2C1012.0546%2C1012.4597%2C1012.5233%2C1012.1054%2C1012.2246%2C1012.2319%2C1012.1092%2C1012.3842%2C1012.2966%2C1012.1006%2C1012.2278%2C1012.5686%2C1012.5946%2C1012.0881%2C1012.5226%2C1012.3848%2C1012.1817%2C1012.4094%2C1012.3817%2C1012.4167%2C1012.0837%2C1012.1564%2C1012.0077%2C1012.4677%2C1012.0755%2C1012.0448%2C1012.0936%2C1012.3332%2C1012.5881%2C1012.0273%2C1012.3248%2C1012.5252%2C1012.2539%2C1012.3608%2C1012.0483%2C1012.0812%2C1012.1939%2C1012.5919%2C1012.1458%2C1012.5933%2C1012.2321%2C1012.2356%2C1012.3926%2C1012.4533%2C1012.2467%2C1012.4440%2C1012.3440%2C1012.1509%2C1012.1144%2C1012.1272%2C1012.5727%2C1012.2413%2C1012.0297%2C1012.4291%2C1012.3551%2C1012.3463%2C1012.2086%2C1012.1487%2C1012.5910%2C1012.4498%2C1012.2402%2C1012.1508%2C1012.4027%2C1012.3600%2C1012.0211%2C1012.0753%2C1012.3784%2C1012.0058%2C1012.1371%2C1012.2279%2C1012.1874%2C1012.2499%2C1012.0173&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "An asymptotic approximation of the marginal likelihood for general\n  Markov models"}, "summary": "The standard Bayesian Information Criterion (BIC) is derived under regularity\nconditions which are not always satisfied by the graphical models with hidden\nvariables. In this paper we derive the BIC score for Bayesian networks in the\ncase of binary data and when the underlying graph is a rooted tree and all the\ninner nodes represent hidden variables. This provides a direct generalization\nof a similar formula given by Rusakov and Geiger for naive Bayes models. The\nmain tool used in this paper is a connection between asymptotic approximation\nof Laplace integrals and the real log-canonical threshold.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1012.2732%2C1012.5325%2C1012.4350%2C1012.1718%2C1012.0919%2C1012.1335%2C1012.3823%2C1012.4280%2C1012.1692%2C1012.5837%2C1012.3816%2C1012.5332%2C1012.2994%2C1012.5828%2C1012.1654%2C1012.5315%2C1012.0572%2C1012.1905%2C1012.2265%2C1012.0851%2C1012.0109%2C1012.0946%2C1012.3962%2C1012.4254%2C1012.3889%2C1012.1869%2C1012.2849%2C1012.1355%2C1012.0546%2C1012.4597%2C1012.5233%2C1012.1054%2C1012.2246%2C1012.2319%2C1012.1092%2C1012.3842%2C1012.2966%2C1012.1006%2C1012.2278%2C1012.5686%2C1012.5946%2C1012.0881%2C1012.5226%2C1012.3848%2C1012.1817%2C1012.4094%2C1012.3817%2C1012.4167%2C1012.0837%2C1012.1564%2C1012.0077%2C1012.4677%2C1012.0755%2C1012.0448%2C1012.0936%2C1012.3332%2C1012.5881%2C1012.0273%2C1012.3248%2C1012.5252%2C1012.2539%2C1012.3608%2C1012.0483%2C1012.0812%2C1012.1939%2C1012.5919%2C1012.1458%2C1012.5933%2C1012.2321%2C1012.2356%2C1012.3926%2C1012.4533%2C1012.2467%2C1012.4440%2C1012.3440%2C1012.1509%2C1012.1144%2C1012.1272%2C1012.5727%2C1012.2413%2C1012.0297%2C1012.4291%2C1012.3551%2C1012.3463%2C1012.2086%2C1012.1487%2C1012.5910%2C1012.4498%2C1012.2402%2C1012.1508%2C1012.4027%2C1012.3600%2C1012.0211%2C1012.0753%2C1012.3784%2C1012.0058%2C1012.1371%2C1012.2279%2C1012.1874%2C1012.2499%2C1012.0173&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The standard Bayesian Information Criterion (BIC) is derived under regularity\nconditions which are not always satisfied by the graphical models with hidden\nvariables. In this paper we derive the BIC score for Bayesian networks in the\ncase of binary data and when the underlying graph is a rooted tree and all the\ninner nodes represent hidden variables. This provides a direct generalization\nof a similar formula given by Rusakov and Geiger for naive Bayes models. The\nmain tool used in this paper is a connection between asymptotic approximation\nof Laplace integrals and the real log-canonical threshold."}, "authors": ["Piotr Zwiernik"], "author_detail": {"name": "Piotr Zwiernik"}, "author": "Piotr Zwiernik", "links": [{"href": "http://arxiv.org/abs/1012.0753v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1012.0753v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "stat.TH", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "62H05, 62E15 (Primary) 60K99, 62F99 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1012.0753v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1012.0753v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "AN ASYMPTOTIC APPROXIMATION OF THE MARGINAL\nLIKELIHOOD FOR GENERAL MARKOV MODELS\n\narXiv:1012.0753v1 [math.ST] 3 Dec 2010\n\nPIOTR ZWIERNIK\n\nAbstract. The standard Bayesian Information Criterion (BIC) is derived under regularity conditions which are not always satisfied by the graphical models\nwith hidden variables. In this paper we derive the BIC score for Bayesian networks in the case of binary data and when the underlying graph is a rooted tree\nand all the inner nodes represent hidden variables. This provides a direct generalization of a similar formula given by Rusakov and Geiger for naive Bayes\nmodels. The main tool used in this paper is a connection between asymptotic\napproximation of Laplace integrals and the real log-canonical threshold.\n\n1. Introduction\nA key step in Bayesian approach to learning graphical models is to compute\nthe marginal likelihood of the data, i.e. the observed likelihood function averaged\nover the parameters with respect to the prior distribution. Given a fully observed\nsystem the theory of graphical models provides a simple way to obtain the marginal\nlikelihood (see e.g. [5], [8]). However, when some of the variables in the system are\nhidden (i.e. never observed), the exact determination of the marginal likelihood is\ntypically intractable (e.g. [4], [5]). Therefore, there is a need to develop efficient\napproximate techniques for computing the marginal likelihood.\nIn this paper we focus on large sample approximations for the marginal likelihood\ncalled the BIC approximation. Let M be a parametric discrete model and X (N ) =\nX 1 , . . . , X N be a random sample from M of size N . By Z(N ) we denote the\nmarginal likelihood and by L(\u03b8; X (N ) , M) = P(X (N ) |M, \u03b8) the observed likelihood\nfunction. Thus\nZ\n(1)\nZ(N ) = P(X (N ) |M) =\nL(\u03b8; X (N ) , M)\u03c6(\u03b8)d\u03b8,\n\u0398\n\nwhere \u03b8 denotes the model parameters, \u0398 \u2286 Rd is the parameter space, and \u03c6(\u03b8)\nis a prior distribution on \u0398 given model M.\nIn statistical theory to obtain the BIC approximation we usually require that\nthe observed likelihood is maximized over a unique point in the interior of the\nparameter space. For the class of problems for which this assumption is satisfied\nSchwarz [18] showed that as N \u2192 \u221e\n(2)\n\nd\nlog Z(N ) = `\u02c6N \u2212 log N + O(1),\n2\n\nwhere `\u02c6N is the maximum value of the log-likelihood and d = dim \u0398. The same\napproximation works if the observed likelihood is maximized over a finite number\nKey words and phrases. BIC, marginal likelihood, singular models, tree models, Bayesian\nnetworks, Laplace integrals, real canonical threshold.\n1\n\n\f2\n\nPIOTR ZWIERNIK\n\nFigure 1. The case when the observed likelihood is maximized\nover a finite number of points.\nof points. Geometrically, for large sample sizes function Z(N ) concentrates around\nthe maxima (see Figure 1). This enables us to apply the Laplace approximation\nlocally in the neighborhood of each maximum.\nIt can be proved (see Proposition 2.7) that the above formula can be generalized\nfor the case when the set over which the likelihood is maximized forms a sufficiently\nregular compact subset of the ambient space (see Figure 2). We denote this subset\nb In this case as N \u2192 \u221e\nby \u0398.\nd \u2212 d0\n(3)\nlog Z(N ) = `\u02c6N \u2212\nlog N + O(1),\n2\nb Note that in our case \u0398\nb is a set of zeros of a real analytic\nwhere d0 = dim \u0398.\nfunction. Therefore it will be always a semi-analytic set, i.e. given by {g1 (\u03b8) \u2265\n0, . . . , gr (\u03b8) \u2265 0}, where gi are all analytic functions. It follows that the dimension\nis well defined (see [3, Remark 2.12]).\nIn the case of models with hidden variables for some data sets the locus of the\npoints maximizing the likelihood may not be sufficiently regular. In this case the\nlikelihood will have a different asymptotic behavior around the singular points and\nrelatively more mass of the marginal likelihood integral will be related to neighborhoods of singular points (see Figure 3). For these points we cannot use the\nLaplace approximation. Nevertheless the computation of the BIC approximation is\nstill possible by using the results of Watanabe [21] and linking this to some earlier\nworks of Arnold, Varchenko and collaborators (see e.g. [1]). This approximation\nwill differ from the standard BIC formula. First, the coefficient of log N can be\n0\ndifferent from \u2212 d\u2212d\n2 . Second, we sometimes obtain an additional log log N term\naffecting the asymptotics (see Theorem 2.3).\nIn this paper we consider an important model class with large number of hidden\nvariables called the general Markov model. This model class is extensively used\nin phylogenetics (e.q. [19, Chapter 8]) and in casuality analysis (e.g. [15]). The\ngeneral Markov model is a Bayesian network on a tree. Thus let T = (V, E) be\na tree with the vertex set V and the edge set E. Let T r denote a tree rooted in\nr, i.e. a tree with one distinguished vertex r and all the edges directed away from\nr. Let Y = (Yv )v\u2208V be a collection of binary random variables indexed by the\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n3\n\nFigure 2. The case when the observed likelihood is maximized\nover an infinite but smooth subset given by xy = 1 for x, y \u2208\n[\u22121, 1].\n\nFigure 3. The case when the observed likelihood is maximized\nover a singular subset given by xy = 0 for x, y \u2208 [\u22121, 1].\nset of vertices of T . We assume that all the inner nodes represent hidden random\nvariables. Hence the general Markov model, denoted by MT , is a family of marginal\ndistributions over the vector of random variables representing the leaves of T .\nA surprising fact proved in this paper is that, given the sample proportions lie\nwithin the model class, the zeros in the sample covariance matrix of the vector\nof observed random variables completely determine the asymptotics for the model\nMT . In this paper following [16] we always assume:\n(A1): The prior distribution \u03c6 : \u0398 \u2192 R is strictly positive, bounded and\nsmooth on \u0398.\n(A2): There exists N0 such that p\u0302(N ) = p\u0302 \u2208 M for all N > N0 and p\u0302 has\npositive entries.\nb = [\u03bc\u0302ij ] let l2 denote the number of inner\nFor a given sample covariance matrix \u03a3\nnodes v of T such that for each triple i, j, k of leaves separated in T by v we have\n\n\f4\n\nPIOTR ZWIERNIK\n\n\u03bc\u0302ij \u03bc\u0302ik \u03bc\u0302jk = 0 but there exist leaves i, j separated by v such that \u03bc\u0302ij 6= 0. Here we\nsay that two nodes u, v of T are separated by another node w if w lies on the unique\npath between u and v. We define a degenerate node as an inner nodes v such that\nfor any two leaves i, j separated by v we have \u03bc\u0302ij = 0. All other nodes are called\nnondegenerate. We denote by ne the number of edges of T and by nv the number\nof its nodes.\nTheorem 1.1. Let T r be a rooted tree with n leaves representing binary random\nvariables X1 , . . . , Xn and assume that their joint distribution lies in the general\nMarkov model MT . Let X (N ) be N independent realizations of this vector and let\np\u0302(N ) the corresponding sample proportions. With assumptions (A1) and (A2), if\nthere are no degenerate nodes then as N \u2192 \u221e\nnv + ne \u2212 2l2\nlog N + O(1),\nlog Z(N ) = `\u02c6N \u2212\n2\nwhere `\u02c6N is the maximum log-likelihood value.\nIn general if there are degenerate nodes the computations of the BIC approximation are much harder because the likelihood in this case maximizes over a singular\nsubset of the parameter space. In this paper we obtain a closed form formula for\nthe BIC approximation in the case of trivalent trees, i.e. the trees such that each\ninner node has valency three. This is provided in Theorem 1.2 which together with\nTheorem 1.1 are the main results of this paper.\nLet l3 denote the number of inner nodes v such that for every i, j \u2208 [n] such that\nthe path between i and j crosses v we have that \u03bc\u0302ij 6= 0.\nTheorem 1.2. Let T = (V, E) be a rooted trivalent tree with n \u2265 3 leaves and root\nr. Let X = (X1 , . . . , Xn ) be a binary random vector representing the leaves of T\nand assume that the joint distribution of X lies in MT . Let X (N ) be a random\nsample given by N independent realization of X and p\u0302(N ) the corresponding sample\nproportions. With assumptions (A1) and (A2) if r is degenerate but all its neighbors\nare not, then as N \u2192 \u221e\nlog Z(N ) = `\u02c6N \u2212\n\n3n + l2 + 5l3 \u2212 1\nlog N + O(1).\n4\n\nIn all other cases as N \u2192 \u221e\n3n + l2 + 5l3\nlog N + c log log N + O(1),\n4\nwhere c \u2265 0. Moreover c = 0 always if r is nondegenerate or if r and all its\nneighbors are degenerate.\nlog Z(N ) = `\u02c6N \u2212\n\nFollowing [16] the main method of proof is to change the coordinates of the\nmodels so that the induced parameterization becomes simple. This gives us a much\nbetter insight into the model structure (see [25], [24]). Since the BIC approximation\nis invariant with respect to these changes the reparameterized problem still gives\nthe solution to the original question. The main analytical tool is the real logcanonical threshold (e.g. [17], [21]). This is an important geometric invariant\nwhich in certain cases can be computed in a relatively simple way using discrete\ngeometry. The relevance of this invariant to the BIC approximation is given by\nTheorem 2.3. Techniques developed in this paper can be applied to obtain the BIC\napproximation also in the non-trivalent case.\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n5\n\nThe paper is organized as follows. In Section 2 we provide the theory of asymptotic approximation of the marginal likelihood integrals. This theory allows us\nto approximate marginal likelihood without the standard regularity assumptions.\nTheorem 2.3 links these concepts with the real log-canonical threshold which allows\nus to use simple algebraic arguments. In Section 3 we define Bayesian networks on\nrooted trees. We also obtain some simple result on the BIC approximation in the\ncase when the observed likelihood is maximised over a sufficiently smooth subset\nof the parameter space. This gives a simple proof of Theorem 1.1. The proof of\nTheorem 1.2 is more technical and so divided it into three main steps. By Theorem 2.3 to obtain the asymptotic approximation we need to compute a certain real\nlog-canonical threshold. In the first step, in Section 4, following [11] we introduce\nthe concept of the real log-canonical threshold of an ideal. Theorem 4.2 reduces\nour computations to the real log-canonical threshold of an ideal induced by the\nparametrization of the given model. This result applies for general discrete statistical models. Theorem 4.6 gives an additional reduction which can be obtained\nonly for tree models. Second step is given in Section 5 where we show that the\ncomputations can be reduced to two distinct cases. One of them is the case already\nconsidered in Section 3. The second case is more complicated and requires to use\nthe method of Newton diagrams. We analyze this case in Section 6. Finally in\nSection 7 we combine all the results.\n2. Asymptotics of marginal likelihood integrals\nIn this section we introduce the real log-canonical threshold and link it with\nthe problem of asymptotic approximation of Laplace integrals. We present how\nthis enables us to obtain the BIC approximation in the case of a general class of\nstatistical models.\n2.1. The real log-canonical threshold. Given \u03b80 \u2208 Rd , let A\u03b80 (Rd ) be the\nring of real-valued functions f : Rd \u2192 R that are analytic at \u03b80 . Given a subset\n\u0398 \u2282 Rd , let A\u0398 (Rd ) be the ring of real functions analytic at each point \u03b80 \u2208 \u0398.\nIf f \u2208 A\u0398 (Rd ), then for every \u03b80 \u2208 \u0398, f can be locally represented as a power\nd\nd\nseries centered at \u03b80 . Denote by A\u2265\n\u0398 (R ) the subset of A\u0398 (R ) consisting of all\nnon-negative functions. Usually the ambient space is clear from the context and in\nthis case we omit it in our notation writing A\u03b80 and so on. We assume that \u0398 \u2286 Rd\nis a compact and semianalytic set of dimension d, i.e. \u0398 = {x \u2208 Rd : g1 (x) \u2265\n0, . . . , gl (x) \u2265 0}, where gi are analytic functions.\nDefinition 2.1 (The real log-canonical threshold). Given a compact semianalytic\nd\nset \u0398 \u2286 Rd such that dim \u0398 = d, a real analytic function f \u2208 A\u2265\n\u0398 (R ) and a smooth\nd\npositive function \u03c6 : R \u2192 R, consider the zeta function defined as\nZ\n(4)\n\u03b6(z) =\nf (\u03b8)\u2212z \u03c6(\u03b8)d\u03b8.\n\u0398\n\nThis function is extended to a meromorphic function in z on the entire complex\nline (c.f. Theorem 2.4 in [21]). The real log-canonical threshold of f denoted by\nrlct\u0398 (f ; \u03c6) is the smallest pole of \u03b6(z). By mult\u0398 (f ; \u03c6) we denote the multiplicity of this pole. By convention if \u03b6(z) has no poles then rlct\u0398 (f ; \u03c6) = \u221e and\nmult\u0398 (f ; \u03c6) = d. If \u03c6(\u03b8) \u2261 1 then we omit \u03c6 in the notation writing rclt\u0398 (f ) and\nmult\u0398 (f ). Define RLCT\u0398 (f ; \u03c6) to be the pair (rlct\u0398 (f ; \u03c6), mult\u0398 (f ; \u03c6)), and we\norder these pairs so that (r1 , m1 ) > (r2 , m2 ) if r1 > r2 , or r1 = r2 and m1 < m2 .\n\n\f6\n\nPIOTR ZWIERNIK\n\nTo show that the real log-canonical threshold is well defined we need to show\nthat if \u03b6(z) has poles then the minimal pole always exists. This is easy to see if f\nand \u03c6 are monomial functions as in the example below.\n1\nd\nExample 2.2. Let f : Rd \u2192 R such that f (x) = x2u = x2u\n* * * x2u\nand \u03c6(x) =\n1\nd\nhd\nh1\nh\nd\nd\nx = x1 * * * xd where u, h \u2208 N . If \u0398 = [\u2212\u000f, \u000f] is an \u000f-box around the origin in\nRd then the zeta function in (4) becomes\nZ Y\nd\nd\nY\n1\n\u03b6(z) =\n,\nxhi i \u22122ui z dx = C(\u000f)\n1\n+\nh\n\u2212 2ui z\ni\n\u0398 i=1\ni=1\n\nwhere C(\u000f) is a constant depending on \u000f. Hence the poles of \u03b6(z) are positive\ni\nrational functions given by 1+h\n2ui for i = 1, . . . , d. In this case the smallest pole is\ngiven by the minimal of these numbers and the multiplicity is given by the number\nof times the minimum occurred.\nThe computation of poles and their multiplicities of \u03b6(z) is linked to the asymptotic expansion of the Laplace integral\nZ\n(5)\nI(N ) =\ne\u2212N f (\u03b8) \u03c6(\u03b8)d\u03b8,\n\u0398\n\nfor large values of the parameter N . This theory was independently developed in\nSection 7.2 in [1] and Section 2.4 and Section 6.2 in [21]. The following theorem\ngives this relation. In Section 2.2 we show how it can be used to obtain the BIC approximation under a fairly general statistical setting which will be later specialized\nto general Markov models for binary data.\nd\nTheorem 2.3. Let \u0398 be a compact semianalytic subset of Rd and f \u2208 A\u2265\n\u0398 (R ).\nLet I(N ) be defined as in (5). Then as N \u2192 \u221e\n\nlog I(N ) = \u2212rlct\u0398 (f ; \u03c6) log N + (mult\u0398 (f ; \u03c6) \u2212 1) log log N + O(1).\n\u221a\nProof. This is a special case of Theorem 4.2 in [11] such that r = 1 and f1 = f . \u0003\nTo compute the real log-canonical threshold we split integral in (4) into a sum\nof finitely many integrals over small neighbourhoods \u03980 of some points \u03b80 \u2208 \u0398. We\ncan always do this using a partition of unity since \u0398 is compact (see e.g. \u00a716, [13]).\nFor each of the local integrals we use Hironaka's theorem stated below to reduce it\nto a locally monomial case which can be easily dealt with as in Example 2.2. The\nversion of Hironaka's theorem we are going to use in this paper was first formulated\nin [2].\nTheorem 2.4 (Hironaka's theorem). Let f : Rd \u2192 R be a real analytic function in\nthe neigborhood of the origin such that f (0) = 0. Then there exists a neighborhood of\nthe origin W and a proper real analytic map \u03c0 : U \u2192 W where U is a d-dimensional\nreal analytic manifold such that\n(1) The map \u03c0 is an isomorphism between U \\ U0 and W \\ W0 , where W0 =\n{x \u2208 W : f (x) = 0} and U0 = {u \u2208 U : f (\u03c0(u)) = 0}.\n(2) For an arbitrary point P \u2208 U0 , there is a local coordinate system u =\n(u1 , . . . , ud ) of U in which P is the origin and\nf (\u03c0(u)) = a(u)ur11 * * * urdd ,\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n7\n\nwhere a(u) is a nowhere vanishing function on this local chart and r1 , . . . , rd\nare nonnegative integers, and the Jacobian determinant of x = \u03c0(u) is\n\u03c0 0 (u) = b(u)uh1 1 * * * uhd d ,\nwhere again b(u) 6= 0 and h1 , . . . , hd are nonnegative integers.\nMoreover \u03c0 can be always obtained as a composition of blow-ups along smooth\ncenters.\nFor the construction of the blow-up see for example Section 3.5 in [21].\nThe local computations are performed as follows. Let \u03b80 \u2208 \u0398 and let W0 be\nany sufficiently small open ball around \u03b80 in Rd . Then, by Theorem 2.4 in [21],\nRLCTW0 (f ; \u03c6) does not depend on the choice of W0 and hence it is denoted by\nRLCT\u03b80 (f ; \u03c6). Formally for this local computation we consider f centered at \u03b80 ,\ni.e. the function f (\u03b8 + \u03b80 ). If f (\u03b80 ) 6= 0 then RLCTW0 (f ; \u03c6) = (\u221e, d) and hence\nwe can constrain only to points \u03b80 such that f (\u03b80 ) = 0. In this case by Hironaka's\ntheorem\nZ\nZ\nXZ\n\u2212z\n\u2212z\n(f (\u03b8)) \u03c6(\u03b8)d\u03b8 =\n(f (\u03b8 + \u03b80 )) \u03c6(\u03b8 + \u03b80 )d\u03b8 =\nuh\u22122rz c\u03b2 (u)du,\nW\n\nW0\n\n\u03b2\n\nU\u03b2\n\nwhere W is the neighbourhood W0 translated to the origin and the (finite) sum\nis over all local charts as in the theorem such that they cover \u03c0 \u22121 (W ) and c\u03b2 are\nnowhere vanishing functions on U\u03b2 . Then for each of the charts we do computations\ni\nas in Example 2.2. Consequently rlct\u03b80 (f ; \u03c6) = min\u03b2 mini 1+h\n2ri and\nmult\u03b80 (f ; \u03c6) = max #{i \u2208 {1, . . . , d} :\n\u03b2\n\n1 + hi\n= rlct\u03b80 (f ; \u03c6)}.\n2ri\n\nIn particular rltc\u0398 (f ; \u03c6) is always a positive rational number and mult\u0398 (f ; \u03c6) is\na nonnegative integer which shows that Definition 2.1 makes sense. Moreover by\nTheorem 2.4 in [21] the real log-canonical threshold does not depend on the triple\n(W, U, \u03c0).\nThe local computations give the answer to the global question since by [11,\nProposition 2.5] the set of pairs RLCT\u03980 (f ; \u03c6) for \u03b80 \u2208 \u0398 has a minimum and\n(6)\n\nRLCT\u0398 (f ; \u03c6) = min RLCT\u03980 (f ; \u03c6),\n\u03b80 \u2208\u0398\n\nwhere \u03980 = W0 \u2229 \u0398. For each \u03b80 \u2208 \u0398 to compute RLCT\u03980 (f ; \u03c6) we consider\ntwo cases. If \u03b80 lies in the interior of \u0398 then we can assume \u03980 = W0 and hence\nRLCT\u03980 (f ; \u03c6) = RLCT\u03b80 (f ; \u03c6). If \u03b80 \u2208 bd(\u0398), where bd(\u0398) denotes the boundary of \u0398, the computations may change significantly because the real log-canonical\nthreshold depends on the boundary conditions (c.f. Example 2.7 in [11]). Nevertheless it can be showed that at least if there exists an open subset U \u2286 Rd such\nd\nthat U \u2283 \u0398 and f \u2208 A\u2265\nU (R ) then\n(7)\n\nRLCT\u03980 (f ) \u2265 RLCT\u03b80 (f ).\n\nFor in this case\nZ\n(f (\u03b8))\nW0\n\n\u2212z\n\nZ\nd\u03b8 =\n\n(f (\u03b8))\n\u03980\n\n\u2212z\n\nZ\nd\u03b8 +\n\n(f (\u03b8))\u2212z d\u03b8\n\nW0 \\\u03980\n\nwhich implies that\nRLCT\u03b80 (f ) = min{RLCT\u03980 (f ), RLCTW0 \\\u03980 (f )}.\n\n\f8\n\nPIOTR ZWIERNIK\n\nd\n\u22121\nb\nIf f \u2208 A\u2265\n(0). By definition 2.1, RLCT\u03b80 (f ) = (\u221e, d) for\n\u0398 (R ), then let \u0398 := f\nb and hence we can restrict ourselves to points in \u0398.\nb Therefore, whenever\nall \u03b80 \u2208\n/\u0398\nb\n\u0398 6= \u2205 we have\n\n(8)\n\nRLCT\u0398 (f ) = min RLCT\u03980 (f ).\nb\n\u03b80 \u2208\u0398\n\nRemark 2.5. Note that there is a substantial difference between the real logcanonical threshold and the log-canonical threshold which is an important invariant\nused in algebraic geometry (see e.g. [10, Section 9.3.B]). Let f \u2208 R[x1 , . . . , xd ]\nbe a polynomial with real coefficients. By fC we denote its complexification, i.e.\nthe same polynomial but as an element of C[x1 , . . . , xd ]. Saito [17] showed that\nrlct(f ) \u2265 lct(fC ). As an example let f (x, y, z) = x2 + y 2 + z 2 . By Koll\u00e1r [9, Example 8.15] we have lct0 (fC ) = 1 and we can easily show that over the real numbers\na single blow-up at the origin (see e.g. [21, Section 3.5]) allows us to compute the\npoles of \u03b6(z) (c.f. Proposition 3.3 in [17]) giving rlct0 (f ) = 3/2.\n2.2. The marginal likelihood. Let X be a discrete random variable with values\nin [m] for some m \u2265 1. A distribution of X is given by (p(X = 1), . . . , p(X = m)).\nDenoting p(X = i) by pi we associate each probability distribution for X with a\npoint p = (p1 , . . . , pm ) in the probability simplex\n\u2206m\u22121 = {x \u2208 Rm : xi \u2265 0,\n\nm\nX\n\nxi = 1}.\n\ni=1\n\nBy definition a model for X is a family of points in \u2206m\u22121 . The model analysed\nin this paper is a special case of a parametric algebraic statistical models defined\nas an image in \u2206m\u22121 of a polynomial mapping p : \u0398 \u2192 \u2206m\u22121 , where \u0398 \u2286 Rd is\ncalled the parameter space (see e.g. Chapter 1, [14]). We define M = p(\u0398). Note\nthat for a given integer N every point q \u2208 \u2206m\u22121 gives a multinomial distribution\nMult(N, q). Hence given a fixed N we can naturally associate \u2206m\u22121 with the\nmultinomial model and hence M can be treated as a submodel of the multinomial\nmodel.\nLet X (N ) = (X 1 , . . . , X N ) denote N independent observations of X and let (Ni )\n(N )\nfor i \u2208 [m] be the sufficient statistic given by the sample counts. Let p\u0302(N ) = [p\u0302i ]\n(N )\ndenote the sample proportions p\u0302i = Ni /N . Given that the observations in X (N )\nare independent we can write the logarithm of the marginal likelihood Z(N ) as\na function of p\u0302(N ) . Let `(p(\u03b8); X) = log L(\u03b8; X) be the log-likelihood for a single\nobservation. Then the observed log-likelihood of the data can be rewritten as\nX\n(9)\n`N (p(\u03b8)) =\nN\u03b1 log p\u03b1 (\u03b8) = N `(p(\u03b8); p\u0302(N ) ).\n\u03b1\u2208{0,1}n\n\nIf the sample proportions p\u0302(N ) lie in the interior of the probability simplex then\nthe likelihood function for the multinomial model as a function of the probabilities\nis always maximized over p\u0302(N ) . Hence if p\u0302(N ) \u2208 M the likelihood function constrained to M is also maximized at p\u0302. It follows that with assumption (A2) the\nmaximum likelihood estimates for sufficiently large N are given as all the points in\nb = p\u22121 (p\u0302) \u2282 \u0398.\nthe parameter space mapping to p\u0302 which we denote by \u0398\nFor given p\u0302 define the normalized log-likelihood as a function f : \u0398 \u2192 R\n(10)\n\nf (\u03b8) = f (p(\u03b8); p\u0302) = `(p\u0302; p\u0302) \u2212 `(p(\u03b8); p\u0302) \u2265 0.\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n9\n\nThen Z(N ) in (1) can be rewritten as exp(`\u02c6N ) * I(N ), where\nZ\n(11)\nI(N ) =\nexp {\u2212N f (\u03b8))} \u03c6(\u03b8)d\u03b8.\n\u0398\n\nThe logarithm of the marginal likelihood can be written as log Z(N ) = `\u02c6N +\n\u22121\nb\nlog I(N ), where `\u02c6N = `N (p\u0302). By construction f \u2208 A\u2265\n(0) = p\u22121 (p\u0302) = \u0398.\n\u0398 and f\nBy Theorem 2.3 to obtain the asymptotic approximation for log I(N ), and hence\nalso for log Z(N ), we need to compute RLCT\u0398 (f ; \u03c6).\nRemark 2.6. Note that we are interested in the approximation of the observed\nmarginal likelihood not in the expected one. Therefore, we cannot immediately\napply the main result of Watanabe as stated in Theorem 1.1 in [11] (for a discussion\nsee [22]).\nIn our analysis of general Markov models we distinguish two cases: the smooth\nb = M \u2229 \u0398 and the singular\ncase when there exists a smooth manifold M such that \u0398\ncase. The smooth case is simple to deal with. We can use the real log-canonical\nthreshold to show that the BIC approximation in (2) generalizes to the case when\nb is a sufficiently regular subset of \u0398 given in (3). We make this precise in the\n\u0398\nfollowing proposition.\nd\nProposition 2.7. Let f \u2208 A\u2265\n\u0398 (R ) be the normalized log-likelihood in (10). Given\n(A1) and (A2) assume that p\u0302 = p\u0302(N ) \u2208 M is such that there exists a smooth\nb = M \u2229 \u0398. Then as N \u2192 \u221e\nmanifold M \u2286 Rd satisfying \u0398\nd \u2212 d0\nlog N + O(1),\nlog Z(N ) = `\u02c6N \u2212\n2\nb\nwhere d0 = dim \u0398.\n\nProof. By assumption (A1) there exist two constants c, C > 0 such that c < \u03c6(\u03b8) <\nC on \u0398. Therefore\nZ\nZ\n\u2212z\nc (f (\u03b8)) d\u03b8 < \u03b6(z) < C (f (\u03b8))\u2212z d\u03b8\n\u0398\n\n\u0398\n\nand it follows that RLCT\u0398 (f ; \u03c6) = RLCT\u0398 (f ). By Theorem 2.3 it suffices to prove\nthe following lemma which generalises Proposition 3.3 in [17].\nd\nLemma 2.8. Let \u0398 \u2282 Rd be a compact semianalytic set and f \u2208 A\u2265\n\u0398 (R ). If\nd\nb\nb\nthere exists a smooth manifold M \u2286 R such that \u0398 = M \u2229 \u0398 and \u03b80 \u2208 \u0398 then\n0\n0\nb\nRLCT\u03b80 (f ) = RLCT\u0398 (f ) = ( d\u2212d\n2 , 1) where d = dim \u0398.\n\nTo prove this recall that the real log-canonical threshold RLCT\u03b80 (f ) does not\nb = M \u2229 \u0398 and M\ndepend on the choice of a neighborhood W0 of \u03b80 . Since \u0398\nb\nis a smooth manifold it follows that for each point \u03b80 of \u0398 there exists an open\nneighborhood W0 of \u03b80 in Rd with local coordinates w1 , . . . , wd centered at \u03b80\nsuch that the local equation of X is w12 + * * * + wc2 = 0, where c = d \u2212 d0 . A\nsingle blow-up \u03c0 at the origin satisfies all the conditions of Hironaka's Theorem\nsince in the new coordinates over one of the charts f (\u03c0(u)) = u21 a(u) where a(u) is\nnowhere vanishing and \u03c0 0 (u) = uc\u22121\n1 . For other charts the situation is the same and\nhence RLCT\u03b80 (f ) = (c/2, 1). Since by (6) RLCT\u0398 (f ) = min\u03b80 \u2208\u0398 RLCTW0 \u2229\u0398 (f ) it\nsuffices to show that if \u03b80 is a boundary point of \u0398 then RLCTW0 \u2229\u0398 (f ) \u2265 (c/2, 1).\nBut this follows from (7) and the fact that RLCT\u03b80 (f ) = (c/2, 1) as \u03b80 is a smooth\npoint of M . The lemma is hence proved.\n\u0003\n\n\f10\n\nPIOTR ZWIERNIK\n\n3. General Markov models\nIn this section we formally define the general Markov model and give the asymptotic approximation for the marginal likelihood in the smooth case which is given\nby Theorem 1.1.\n3.1. Definition of the model class. All random variables considered in this\npaper are assumed to be binary with values in either 0 or 1. Let T r = (V, E) be\na rooted tree. Recall that ne = |E| and nv = |V |. For any e = (k, l) \u2208 E we say\nthat k and l are adjacent and k is aTparent of l and we denote it by k = pa(l).\nFor every \u03b2 \u2208 {0, 1}V let p\u03b2 = P( v\u2208V {Yv = \u03b2v }). A Markov process on a\nrooted tree T r is a sequence Y = (Yv )v\u2208V of random variables such that for each\n\u03b2 = (\u03b2v )v\u2208V \u2208 {0, 1}V\nY (v)\n(r)\n(12)\np\u03b2 (\u03b8) = \u03b8\u03b2r\n\u03b8\u03b2v |\u03b2pa(v) ,\nv\u2208V \\r\n(v)\n\u03b8\u03b2v |\u03b2pa(v)\n\n(r)\n\nwhere\n= P(Yv = \u03b2v |Ypa(v) = \u03b2pa(v) ) and \u03b8\u03b2r = P(Yr = \u03b2r ). In a more\nstandard statistical language these models are just fully observed Bayesian networks\n(v)\n(v)\non rooted trees. Since \u03b80|i + \u03b81|i = 1 for all v \u2208 V and i = 0, 1 then the Markov\nprocess on T r defined by Equation (12) has exactly 2ne + 1 free parameters in the\n(r)\nvector \u03b8: one for the root distribution \u03b81 and two for each edge (u, v) \u2208 E given\n(v)\n(v)\nby \u03b81|0 and \u03b81|1 and the vector of all parameters is denoted by \u03b8. The parameter\nspace is \u0398T = [0, 1]2ne +1 . Henceforth we usually omit the root r in the notation\nwriting T to denote the rooted tree T r .\nThe general Markov model on T is induced from the Markov process on T by\nassuming that all the inner nodes represent hidden random variables. Hence we\nconsider induced marginal probability distributions over the leaves of T . The set of\nleaves is denoted by L. We assume that T has n leaves and hence we can associate\nL with [n] with some arbitrary numbering of the leaves. Let Y = (X, H) where\nX = (X1 , . . . , Xn ) denotes the variables represented by the leaves of T and H\ndenotes the vector of variables represented by inner nodes, i.e. X = (Yv )v\u2208L and\nH = (Yv )v\u2208V \\L . We define the general Markov model MT to be the model in the\nprobability simplex \u22062n \u22121 obtained by summing out in (12) all possible values of\nthe inner nodes. By definition MT is the image of the map p : \u0398T \u2192 \u22062n \u22121 given\nby\nX (r) Y (v)\n(13)\np\u03b1 (\u03b8) =\n\u03b8\u03b2r\n\u03b8\u03b2v |\u03b2pa(v) for any \u03b1 \u2208 {0, 1}L ,\nH\n\nv\u2208V \\r\n\nwhere H is the set of all vectors \u03b2 = (\u03b2v )v\u2208V such that (\u03b2v )v\u2208L = \u03b1. For a more\ndetailed treatment see Chapter 8 in [19].\nb = [\u03bc\u0302ij ] \u2208 Rn\u00d7n be the covariance\n3.2. The smooth case. For p\u0302 \u2208 MT let \u03a3\nmatrix of the random vector represented by the leaves of T . In [25] we show that\nb T is determined by zeros in \u03a3.\nb We say that that an\nthe geometry of the p\u0302-fiber \u0398\nedge e \u2208 E is isolated relative to p\u0302 if \u03bc\u0302ij = 0 for all i, j \u2208 [n] such that e \u2208 E(ij),\nb \u2286 E we\nwhere E(ij) denotes the set of edges in the path joining i and j. By E\nb\nb\ndenote the set of all edges of T which are isolated relative to p\u0302. By T = (V, E \\ E)\nb\nwe denote the forest obtained from T by removing edges in E.\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n11\n\nb and E\\E.\nb For two edges e, e0 with either {e, e0 } \u2282 E\nb\nWe now define relations on E\n0\n0\n0\n0\nb write e \u223c e if either e = e or e and e are adjacent and all the\nor {e, e } \u2282 E \\ E\nedges that are incident with both e and e0 are isolated relative to p\u0302. Let us now take\nb to form an equivalence\nthe transitive closure of \u223c restricted to pairs of edges in E\nb\nrelation on E. Similarly, take the transitive closure of \u223c restricted to the pairs of\nb to form an equivalence relation in E \\ E.\nb We will let [E]\nb and [E \\ E]\nb\nedges in E \\ E\nb\nb\ndenote the set of equivalence classes of E and E \\ E respectively.\nBy the construction all the inner nodes of T have either degree zero in Tb or the\ndegree is strictly greater than one. We say that a node v \u2208 V is non-degenerate with\nrespect to p\u0302 if either v is a leaf of T or deg v \u2265 2 in Tb. Otherwise we say that the\nnode is degenerate with respect to p\u0302. Note that this coincides with the definition\nof a degenerate node given in the introduction. The set of all nodes which are\ndegenerate with respect to p\u0302 is denoted by Vb .\nProposition 3.1 ([25], Theorem 5.4). Let T be a tree with n leaves. Let p\u0302 \u2208 MT\nand let Tb be defined as above. If each of the inner nodes of T has degree at least\nb T is a manifold with corners and dim \u0398\nb T = 2l2 , where l2 is the\ntwo in Tb then \u0398\nb\nnumber of nodes which have degree two in T .\nFor the case covered by Proposition 3.1 we obtain a way to compute the asymptotic approximation for the marginal likelihood.\nProposition 3.2. Let p\u0302 \u2208 MT be such that each inner node of T has degree at\nleast two in Tb and let f be the normalized likelihood defined by (10). Then\n\u0013\n\u0012\nnv + ne \u2212 2l2\n,1 .\nRLCT\u0398T (f ) =\n2\nProof. Since every inner node of T has degree at least two in Tb then by Proposition\nb T = M \u2229 \u0398T and\n3.1 there exists a smooth manifold M \u2286 Rnv +ne such that \u0398\nb\ndim \u0398 = 2l2 . The result follows from Proposition 2.7 and the fact that dim \u0398T =\nnv + ne .\n\u0003\nBy Theorem 2.3, Proposition 3.2 implies Theorem 1.1 since l2 in its statement\nis exactly the number of inner nodes v such that the degree of v in Tb is two.\nRemark 3.3. Theorem 1.1 is still true if (A1) is replaced by the assumption that\nthe prior distribution is bounded on \u0398T and there exists an open subset of \u0398T with\nb T where the prior is strictly positive. In particular\na non-empty intersection with \u0398\n(v)\n(v)\n(v)\n(v)\n(v)\nwe can use conjugate Beta priors \u03b81|i \u223c Beta(\u03b1i , \u03b2i ) as long as \u03b1i , \u03b2i \u2265 1.\n4. The ideal-theoretic approach\nIn this section we define the real log-canonical threshold of an ideal. Theorem 4.2\ntranslated the problem of finding the real log-canonical threshold of the normalized\nlog-likelihood into algebra. We then analyse the case of general Markov models. In\nTheorem 4.6 we apply a useful change of coordinates which enables us to deal with\nthe singular case in a more efficient.\n\n\f12\n\nPIOTR ZWIERNIK\n\n4.1. The real log-canonical threshold of an ideal. Let f1 , . . . , fr \u2208 A\u0398 then\nthe ideal generated by f1 , . . . , fr is denoted by\nhf1 , . . . , fr i = {f \u2208 A\u0398 : f (\u03b8) =\n\nr\nX\n\nhi (\u03b8)fi (\u03b8), hi \u2208 A\u0398 }.\n\ni=1\n\nFollowing [11] we generalize the notion of the real log-canonical thresholds to the\nideal I = hf1 , . . . , fr i. This mirrors the analytic definition of the log-canonical\nthreshold of an ideal (see e.g. [10, Section 9.3.D]). By definition\n(14)\n\nRLCT\u0398 (I; \u03c6) = RLCT\u0398 (hf1 , . . . , fr i; \u03c6) := RLCT\u0398 (f ; \u03c6),\n\nwhere f (\u03b8) = f12 (\u03b8) + * * * + fr2 (\u03b8). By Proposition 4.5 in [11] the real log-canonical\nthreshold does not depend P\non the choice of generators. We say that I = hf1 , . . . , fr i\nis R-nondegenerate if f =\nfi2 is R-nondegenerate as given by Definition 6.5.\nThe following important proposition enables us to use the full power of the idealtheoretic approach.\nProposition 4.1. Let f, g \u2208 A\u0398 (Rd ) and let I be an ideal in A\u0398 (Rd ). Then\ni: Let \u03c1 : \u03a9 \u2192 \u0398 be a proper real analytic isomorphism. Denote \u03c1\u2217 I = {f \u25e6 \u03c1 :\nf \u2208 I} be the pullback of I on A\u03a9 . Then,\nRLCT\u0398 (I; \u03c6) = RLCT\u03a9 (\u03c1\u2217 I; (\u03c6 \u25e6 \u03c1)|\u03c10 |),\nwhere |\u03c10 | denotes the Jacobian of \u03c1.\nii: If \u03c6 is positive and bounded on \u0398 then\nRLCT\u0398 (I; \u03c6) = RLCT\u0398 (I).\niii: If there exist constants c, c0 > 0 such that c g(\u03b8) \u2264 f (\u03b8) \u2264 c0 g(\u03b8) for every\n\u03b8 \u2208 \u0398 then RLCT\u0398 (f ) = RLCT\u0398 (g).\niv: Let I = hf1 , . . . , fr i and J = hg1 , . . . , gr i where gi = ui fi for i = 1, . . . , r\nand there exist positive constants c, C such that c < ui (\u03b8) < C for all \u03b8 \u2208 \u0398\nand for all i = 1, . . . , r. Then RLCT\u0398 (I) = RLCT\u0398 (J).\nProof. The first result is a direct consequence of Proposition 4.7, [11]. The second\nand the third follow easily from the interpretation of the real log-canonical threshold\nand its multiplicity as coefficients in the asymptotic approximation of I(N ) in (5).\nThe last statement follows from the third.\n\u0003\nIn the statistical context given in Section 2.2, expressing this problem in the\nlanguage of ideals simplifies reductions.\nTheorem 4.2. Let p = (p1 , . . . , pm ) : \u0398 \u2192 \u2206m\u22121 be a polynomial mapping and\nM = p(\u0398) be the statistical model of X \u2208 [m]. For a given p\u0302 \u2208 M define\n(15)\n\nI = hp1 (\u03b8) \u2212 p\u03021 , . . . , pm (\u03b8) \u2212 p\u0302m i \u2282 A\u0398 .\n\nLet f denote the normalized likelihood defined by (10) and \u03c6 the prior distribution\non \u0398 satisfying (A1). Then we have that\n(16)\n\nRLCT\u0398 (f ; \u03c6) = RLCT\u0398 (I; \u03c6) = RLCT\u0398 (I).\n\nProof. The first equation follows essentially the same lines as the proof of Theorem\n1.2 in [11]. The second equation follows from Proposition 4.1 ii.\n\u0003\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n13\n\n4.2. A reparameterization of the model. To realize how the formulation in\nterms of the ideals may be useful we first need to introduce a new generating set for\nthe ideal I in (15). By Proposition 4.5 in [11] this does not affect our computations.\nThen we take a pullback of I under a polynomial isomorphism. We note that this\nis the algebraized version of the analytic reductions applied in [16].\nFollowing [25] we perform a change of coordinates on the model space and parameter space. Let T be a tree with n leaves. In this case the change of the\ngenerating set for I is induced by the following series of transformations. First\nwe express the raw probabilities p\u03b1 for \u03b1 \u2208 {0, 1}n in terms of a new system of\nvariables given by the non-central moments \u03bb\u03b1 = EX \u03b1 . This change is a simple\nn\nn\nlinear map fp\u03bb : R2 \u2192 R2 with the determinant equal to one. Thus \u03bb = fp\u03bb (p)\nis defined as follows\nX\np\u03b2\nfor any \u03b1 \u2208 {0, 1}n ,\n(17)\n\u03bb\u03b1 =\n\u03b1\u2264\u03b2\u22641\n\nwhere 1 denotes here the vector of ones and the sum is over all binary vectors \u03b2\nsuch that \u03b1 \u2264 \u03b2 \u2264 1 in the sense that \u03b1i \u2264 \u03b2i \u2264 1 for all i = 1, . . . , n. To define\nthe next change of coordinates we change indexing of the non-central moments in\nsuch a way that \u03bb\u03b1 for \u03b1 \u2208 {0, 1}n is denoted by \u03bbA for A \u2286 [n] where i \u2208 A if and\nonly if \u03b1i = 1. The linearity of the expectation implies that the central moments\ncan be expressed in terms of the non-central moments. We have\n(18)\n\n\u03bcI =\n\nX\nJ\u2286I\n\n(\u22121)|J| \u03bbI\\J\n\nY\n\n\u03bbi\n\nfor I \u2286 [n], |I| \u2265 2.\n\ni\u2208J\n\nMoreover, there is an algebraic isomorphism between the non-central moments \u03bbI\nfor all non-empty I \u2286 [n] and\n\u0001 \u03bbi = EXi supplemented with all the\nQ all the means\ncentral moments \u03bcI = E\n(X\n\u2212\n\u03bb\n)\nfor I \u2208 [n]\u22652 , where [n]\u2265k denotes all\ni\ni\ni\u2208I\nsubsets of [n] with at least k elements (see Appendix A in [25]). In particular we\nobtain in this way a change of coordinates from the non-central moments \u03bbI for\nI \u2286 [n] to the central moments supplemented by the means.\nTo specify the last change of coordinates we need some basic combinatorics. We\ndefine a partially ordered set (or poset) \u03a0T of all partitions of the set of leaves [n]\nobtained by removing some inner edges of T and considering connected components\nof the resulting forest. The elements of \u03a0T are partitions \u03c0 = B1 | * * * |Bk where\neach Bi is called a block of \u03c0. The ordering on this poset is induced from the\nordering on the poset of all partitions on [n] (see Example 3.1.1.d, [20]). Thus for\n\u03c0 = B1 | * * * |Bk and \u03bd = C1 | * * * |Cl we write \u03c0 \u2264 \u03bd if and only if every block of \u03c0 is\ncontained in one of the blocks of \u03bd.\nFor any poset \u03a0 we define its M\u00f6bius function m : \u03a0 \u00d7 \u03a0 \u2192 R (c.f. [20, Chapter\n3]) by setting\nm(\u03c0, \u03c0) = 1 for every \u03c0 \u2208 \u03a0 and m(\u03c0, \u03bd) = \u2212\n\nX\n\nmI (\u03c0, \u03b4).\n\n\u03c0\u2264\u03b4\u2264\u03bd\n\nFor any I \u2286 [n] we define T (I) as the minimal subtree of T containing I in its\nvertex set. By mI we denote the M\u00f6bius function of \u03a0T (I) and by 1\u0302I the maximal\none-block partition of \u03a0T (I) .\n\n\f14\n\nPIOTR ZWIERNIK\n\nThe last system of coordinates is given by n means \u03bbi for i \u2208 1, . . . , n and \u03baI for\nall I \u2208 [n]\u22652 , where\nY\nX\nmI (\u03c0, 1\u0302I )\n\u03bcB .\n(19)\n\u03baI =\nB\u2208\u03c0\n\n\u03c0\u2208\u03a0T (I)\n\nWe note that in particular \u03baij = \u03bcij for all i, j \u2208 [n]. This change of coordinates,\nfrom probabilities p\u03b1 for \u03b1 \u2208 {0, 1}n to (\u03bbi , \u03baI ) for i = P\n1, . . . , n and I \u2208 [n]\u22652 is\ndenoted by fp\u03ba . It is an algebraic isomorphism given that \u03b1 p\u03b1 = 1 (see Appendix\nA, [25]). The new set of coordinates is called the system of tree cumulants.\nExample 4.3. Consider the quartet tree model, i.e. the hidden tree Markov model\ngiven by the graph in Figure 4. The tree cumulants are given by 15 coordinates:\n\n3b\n\n1b\nbc\n\nr\n\na bc\nb\n\nb\n\n2\n\n4\n\nFigure 4. A quartet tree\n\u03bbi = EXi for i = 1, 2, 3, 4 and \u03baI for I \u2208 [4]\u22652 . We have \u03baij = \u03bcij = Cov(Xi , Xj )\nfor 1 \u2264 i < j \u2264 4 and \u03baijk = \u03bcijk for all 1 \u2264 i < j < k \u2264 4. However tree\ncumulants of higher order cannot be equated to corresponding central moments\nbut only expressed as functions of them. Thus in this case by (19)\n\u03ba1234 = \u03bc1234 \u2212 \u03bc12 \u03bc34 .\nThe next step is to change the coordinates on the parameter space of the model.\nDefine the following set of nv + ne parameters. For every directed edge (u, v) \u2208 E\nlet\n(20)\n\n(v)\n\n(v)\n\n\u03b7u,v = \u03b81|1 \u2212 \u03b81|0 and\nsv = 1 \u2212 2\u03bbv\n\nfor each v \u2208 V,\n\nwhere \u03bbv = EYv is a polynomial in the original parameters \u03b8. Let (r, v1 , . . . , vk , v)\nbe a directed path in T . Then\nX\n(v)\n(v )\n\u03bbv =\n\u03b81|\u03b1k \u03b8\u03b1kk|\u03b1k\u22121 * * * \u03b8\u03b1(r)\n.\nr\n\u03b1\u2208{0,1}k+1\n\nWe denote the new parameter space by \u03a9T and the coordinates by \u03c9 = ((sv ), (\u03b7u,v ))\nfor v \u2208 V, (u, v) \u2208 E.\nSimple linear constraints defining \u0398T become only slightly more complicated\nwhen expressed in the new parameters. The choice of parameter values is not\nfree anymore in the sense that constraints for each of the parameters involve other\nparameters. \u03a9T is given by sr \u2208 [\u22121, 1] and for each (u, v) \u2208 E (c.f. Equation (19)\nin [25])\n(21)\n\n\u2212(1 + sv ) \u2264 (1 \u2212 su )\u03b7u,v \u2264 (1 \u2212 sv )\n\u2212(1 \u2212 sv ) \u2264 (1 + su )\u03b7u,v \u2264 (1 + sv ).\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n15\n\nSince T is a tree then 2ne + 1 = nv + ne and hence dim \u03a9T = dim \u0398T . The change\nof parameters defined above is denoted by f\u03b8\u03c9 : \u0398T \u2192 \u03a9T . It is a polynomial\nisomorphism with the inverse denoted by f\u03c9\u03b8 (see [25, Section 4]). Recall that for\nI \u2286 [n] by T (I) = (V (I), E(I)) we denote the subtree of T spanned on I. Let r(I)\ndenote the root of T (I). Then for instance if T is the quartet tree in Figure 4 then\nfor T (34): E(34) = {(a, 3), (a, 4)} and r(34) = a. The parameterization of MT\nin the system of tree cumulants is given as a map \u03c8T : \u03a9T \u2192 fp\u03ba (\u22062n \u22121 ) by the\nfollowing proposition.\nProposition 4.4 (Proposition 4.1 in [25]). Let T = (V, E) be a rooted trivalent\ntree with n leaves. Then for each i = 1, . . . , n one has \u03bbi = 12 (1 \u2212 si ) and\nY\nY\n1\nv\u22122\nsdeg\n(22)\n\u03baI (\u03c9) = (1 \u2212 s2r(I) )\n\u03b7u,v for all I \u2208 [n]\u22652 ,\nv\n4\nv\u2208V (I)\\I\n\n(u,v)\u2208E(I)\n\nwhere the degree of v \u2208 V (I) is considered in the subtree T (I).\nWe obtain the following diagram where the induced parameterisation \u03c8T is given\nin the bottom row.\n(23)\n\nfT\n\n\u0398\nO T\nf\u03c9\u03b8\n\n\u000f\n\n/ \u22062n \u22121\nO\nf\u03bap\n\nf\u03b8\u03c9\n\n\u000f\n\nfp\u03ba\n\n\u03a9T _ _ _ _ _ _/ KT\n\u03c8T\n\nLet I denote the pullback of the ideal I \u2286 A\u0398T to the ideal in A\u03a9T induced by f\u03b8\u03c9 .\n\u2217\nb T = f\u03b8\u03c9 (\u0398\nb T ) as a subset\nI = {f \u25e6 f\u03c9\u03b8 : f \u2208 I}. The ideal describes \u03a9\nThus I = f\u03c9\u03b8\nof \u03a9T . The pullback of I satisfies\n\uf8f6\n\uf8eb\nX\nh\u03baI (\u03c9) \u2212 \u03ba\u0302I i\uf8f8 ,\n(24)\nI = h\u03bb1 \u2212 \u03bb\u03021 , . . . , \u03bbn \u2212 \u03bb\u0302n i + \uf8ed\nI\u2208[n]\u22652\n\nwhere \u03bb\u0302i and \u03ba\u0302I are the corresponding coordinates of fp\u03ba (p\u0302). Here the sum of ideals\nresults in another ideal with the generating set which is the sum of generating sets\nof the summands.\nFor local computations we use the following reduction.\nProposition 4.5 (Proposition 4.6 in [11]). Let I \u2286 Ax0 (Rm ), J \u2286 Ay0 (Rn ) be two\nideals. If RLCTx0 (I) = (\u03bbx , mx ) and RLCTy0 (J) = (\u03bby , my ) then\nRLCT(x0 ,y0 ) (I + J) = (\u03bbx + \u03bby , mx + my \u2212 1).\nTheorem 4.6. Let T be a rooted tree with n leaves and p\u0302 \u2208 MT . Let I be the ideal\ndefined by (15) and I the ideal defined by (24). Then\n(25)\n\nRLCT\u0398T (I) = RLCT\u03a9T (I) = min RLCT\u03a90 (I),\nbT\n\u03c90 \u2208\u03a9\n\nwhere \u03a90 is a sufficiently small neighborhood of \u03c90 in \u03a9T . Let J =\nbT\n\u03ba\u0302I i then for every \u03c90 \u2208 \u03a9\n\u0010n \u0011\n(26)\nRLCT\u03c90 (I) =\n, 0 + RLCT\u03c90 (J ).\n2\n\nP\n\nI\u2208[n]\u22652 h\u03baI (\u03c9)\u2212\n\n\f16\n\nPIOTR ZWIERNIK\n\nProof. Since f\u03c9\u03b8 is an isomorphism with a constant Jacobian then the first part of\nthe theorem follows from Proposition 4.1 (i).\nLet W be an \u000f-box around \u03c90 . If T is rooted in an inner leaf then by Proposition\n4.4 the ideal J does not depend on s1 , . . . , sn . Since for every i = 1, . . . , n the\nexpression \u03bbi \u2212 \u03bb\u0302i depends only on si then\nn\nRLCT\u03c90 (h\u03bb1 \u2212 \u03bb\u03021 , . . . , \u03bbn \u2212 \u03bb\u0302n i) = ( , 1),\n2\nwhich can be easily checked (see e.g. Proposition 3.3 in [17]). Equation (26) follows\nfrom Proposition 4.5.\nNow assume that T is rooted in one of the leaves. In this case both h\u03bb1 \u2212\n\u03bb\u03021 , . . . , \u03bbn \u2212 \u03bb\u0302n i and J depend on sr because \u03baI (\u03c9) = (1 \u2212 s2r )fI (\u03c9) for some\nmonomial fI (\u03c9) whenever r \u2208 I. Therefore we cannot use Proposition 4.5 directly.\nHowever, by assumption (A2) s0i \u2208 (\u22121, 1) for i = 1, . . . , n. Hence for each \u03c90\nand a sufficiently small \u000f one can find two positive constants c(\u000f), C(\u000f) such that\nc(\u000f) \u2264 1 \u2212 s2r \u2264 C(\u000f) in W . By Proposition 4.1 (iv) the real log canonical threshold\nof J in W is equal to the real log-canonical threshold of a an ideal with generators\ninduced from the generators of J by replacing each 1 \u2212 s2r by 1. Now again (26)\nfollows from Proposition 4.5.\n\u0003\n\n5. The main reduction step\nIn this section we show that the computations can be reduced to two main cases.\nFirst, when p\u0302 is such that \u03ba\u0302ij 6= 0 for all i, j \u2208 [n]. Second, when p\u0302 is such that\n\u03ba\u0302ij = 0 for all i, j \u2208 [n]. Moreover, the second case is reduced to computations for\nmonomial ideals which are usually amenable to various combinatorial techniques.\nLet T be a trivalent tree with n \u2265 3 leaves and let p\u0302 \u2208 MT . If all the equivalence\nb are singletones or [E]\nb is empty, which is equivalent to the fact that\nclasses in [E]\nevery inner node has degree at least two in Tb, then Theorem 1.1 gives us the\nasymptotic approximation for the marginal likelihood. Thus let assume that there\nb Let T1 , . . . , Tk denote trees representing the\nis at least one nontrivial class in [E].\nb\nequivalence classes in [E] and let S1 , . . . , Sm denote trees induced by the connected\nb Let L1 , . . . Lk denote the sets of leaves of T1 , . . . , Tk . For\ncomponents of E \\ E.\neach Si i = 1, . . . , m by Remark 5.2 (iv) in [25] its set of leaves denoted by [ni ] is a\nsubset of [n]. We illustrate this notation using the graph below where the dashed\nb\nedges represent edges in E.\nb\nb\n\nb\nbc\n\nT2\n\nS1\n\nbc\n\nS2\nbc\nbc\nb\nb\n\nbc\nbc\nb\n\nT3\nbc\n\nb\nbc\nb\nb\n\nS3\n\nT1\nb\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n17\n\nLemma 5.1. Let T = (V, E) be a trivalent rooted tree with n \u2265 4 leaves and let\nP\nb T then\np\u0302 \u2208 MT . Let J = I\u2208[n]\u22652 h\u03baI (\u03c9) \u2212 \u03ba\u0302I i. If \u03c90 \u2208 \u03a9\n(27) RLCT\u03c90 (J ) =\n\nm\nX\n\nRLCT\u03c90 (J (Si )) +\n\ni=1\n\nk\nX\n\nRLCT\u03c90 (J (Ti )) + (0, 1 \u2212 m \u2212 k),\n\ni=1\n\nP\nP\nwhere J (Si ) = I\u2208[ni ]\u22652 h\u03baI (\u03c9)\u2212\u03ba\u0302I i for i = 1, . . . , m and J (Ti ) = w,w0 \u2208Li h\u03baww0 (\u03c9)i\nfor i = 1, . . . , k.\nP\nP\nProof. We first show that I:\u03ba\u0302I =0 h\u03baI (\u03c9)i = i,j:\u03ba\u0302ij =0 h\u03baij (\u03c9)i. The inclusion \"\u2287\"\nis clear. We now show \"\u2286\". First note that for every I \u2208 [n]\u22652 if \u03ba\u0302I = 0 then either\n\u03b7e0 = 0 for an edge e \u2208 E(I) or s2r(I) = 1. It is easy to check there exist i, j \u2208 I\nsuch that such that \u03ba\u0302ij = 0 and the r(ij) = r(I). It follows by Proposition 4.4 that\n\u03baI (\u03c9) = \u03baij (\u03c9)f (\u03c9) for a polynomial f (\u03c9) and therefore the inclusion \"\u2286\" is also\ntrue. This implies\nm\nX\nX\nX\nX\nJ =\nh\u03baI (\u03c9) \u2212 \u03ba\u0302I i +\nh\u03baI (\u03c9)i =\nJ (Si ) +\nh\u03baij (\u03c9)i.\nI:\u03ba\u0302I 6=0\n\nI:\u03ba\u0302I =0\n\ni,j:\u03ba\u0302ij =0\n\ni=1\n\nbT\nHence to proof the lemma it suffices to show that for every \u03c90 \u2208 \u03a9\nm\nX\nX\nJ (Si ) +\nh\u03baij (\u03c9)i)\n(28)\nRLCT\u03c90 (\ni=1\n\ni,j:\u03ba\u0302ij =0\n\nis equal to the right hand side of (27).\nb then by definition there exist i, j \u2208 [n] such that \u03ba\u0302ij 6= 0 and\nIf e \u2208 E \\ E\ne \u2208 E(ij). Since by Proposition 4.4 \u03ba\u0302ij = \u03b7e0 f (\u03c90 ) for a polynomial f then in\nb\nparticular \u03b7e0 6= 0. It follows that for a sufficiently small \u000fQfor each E 0 \u2286 E \\ E\none can find positive constants c(\u000f), C(\u000f) such that c(\u000f) \u2264 e\u2208E 0 \u03b7e \u2264 C(\u000f) holds\nin the \u000f-box around \u03c90 . Similarly if v \u2208\n/ Vb (c.f. Section 3.2) then there exist\npositive constants d(\u000f), D(\u000f) such that d(\u000f) \u2264 (1 \u2212 s2v ) \u2264 D(\u000f) in the \u000f-box around\n\u03c90 . It follows by Proposition 4.1 (iv) that in computations of the real log-canonical\nthreshold in (28) each \u03baij (\u03c9) can be replaced by\nY\n(29)\n(1 \u2212 s2r(ij) )\u03b4r(ij)\n\u03b7e\nb\ne\u2208E(ij)\u2229E\n\nwhere \u03b4r(ij) = 1 if r(ij) \u2208 Vb and \u03b4r(ij) = 0 otherwise. Thus in (28) we can replace\nP\nP\nQ\nthe ideal i,j:\u03ba\u0302ij =0 h\u03baij (\u03c9)i by the ideal J1 = i,j: \u03ba\u0302ij =0 h(1\u2212s2r(ij) )\u03b4r(ij) e\u2208E(ij)\u2229Eb \u03b7e i.\nHowever, if we define\n(30)\n\nJ2 =\n\nk\nX\nX\ni=1 w,w0 \u2208Li\n\nh(1 \u2212 s2r(ww0 ) )\u03b4r(ww0 )\n\nY\n\n\u03b7e i\n\ne\u2208E(ww0 )\n\nthen it can be checked that J1 = J2 . To show this fix j = 1, . . . , k and w, w0 \u2208 Lj .\nNote that by construction each of w, w0 either has degree two in Tb or is a leaf of T .\nb there exist i, j \u2208 [n] such that E(ij) \u2229 E\nb = E(ww0 ).\nHence by the definition of E\nIt follows that each generator in (30) is also in the set of generators of J1 and\nhence J2 \u2286 J1 . To show the opposite inclusion note that if E(ij) intersects with\nmore than one component T1 , . . . , Tk then the corresponding generator in (29) is a\nproduct of some generators in (30) and hence it lies in J2 .\n\n\f18\n\nPIOTR ZWIERNIK\n\nSince the generators of every J (Si ) for i = 1, . . . , m and every\nX\nY\nh(1 \u2212 s2r(ww0 ) )\u03b4r(ww0 )\n\u03b7e i\nw,w0 \u2208Lj\n\ne\u2208E(ww0 )\n\nfor j = 1, . . . , k involve disjoint sets of variables then by Proposition 4.5 the term\nin (28) is equal to\nm\nX\n\nk\nY\nX\nX\nRLCT\u03c90 (J (Si ))+\n\u03b7e i)+(0, 1\u2212m\u2212k).\nRLCT\u03c90 (\nh(1\u2212s2r(ww0 ) )\u03b4r(ww0 )\n\ni=1\n\nw,w0 \u2208Lj\n\ni=1\n\ne\u2208E(ww0 )\n\nIt can be easily checked that by Proposition 4.1 (iv) for each i = 1, . . . , k\nX\nY\nRLCT\u03c90 (\nh(1 \u2212 s2r(ww0 ) )\u03b4r(ww0 )\n\u03b7e i) = RLCT\u03c90 (J (Ti ))\nw,w0 \u2208Li\n\ne\u2208E(ww0 )\n\nwhich finishes the proof.\n\n\u0003\n\n6. The case of zero covariances\nIn this subsection we assume that \u03ba\u0302ij = 0 for all i, j \u2208 [n]. The aim is to prove\nthe following proposition.\nProposition 6.1. Let T be a trivalent tree with n 6= 3 P\nleaves rooted in r \u2208 V . Let\np\u0302 \u2208 MT be such that \u03ba\u0302ij = 0 for all i, j \u2208 [n]. Let J = i,j\u2208[n] h\u03baij (\u03c9)i. Then\nn\nmin RLCT\u03c90 (J ) = ( , m),\n4\n\nbT\n\u03c90 \u2208\u03a9\n\nwhere m = 1 if either r is a leaf of T or r together with all its neighbors are all\ninner nodes of T . In all other cases we cannot obtain an explicit bound for m and\nhence m \u2265 1.\nP\nThere is no coincidence in the fact that J here denotes i,j\u2208[n] h\u03baij (\u03c9)i and in\nP\nSection 5 it denotes I\u2208[n]\u22652 h\u03baI (\u03c9) \u2212 \u03ba\u0302I i. In fact if \u03ba\u0302ij = 0 for all i, j \u2208 [n] then\nthese two ideals are equal (see the beginning of the proof of Lemma 5.1).\nThe strategy of the proof of Proposition 6.1 is as follows. First in Section 6.1 we\nb T over\nshow that the local computations can be restricted to a special subset of \u03a9\nwhich J can be replaced by a monomial ideal. Then in Section 6.2 we present the\nmethod to compute real log-canonical threshold of a monomial ideal. We use this\nmethod in Section 6.3.\n6.1. The deepest singularity. First we note that the ideal J in Proposition\n6.1 depends on sv for v \u2208 V only through the value of s2v . It follows that the\ncomputations can be reduced only to points satisfying sv \u2265 0 for all inner nodes v\nof T . Henceforth in this section we always assume this is the case. We define the\nb T as\ndeepest singularity of \u03a9\n(31)\n\nb deep := {\u03c9 \u2208 \u03a9\nb T : \u03b7e = 0 for all e \u2208 E,\nb sv = 1 for all v \u2208 Vb }.\n\u03a9\n\nb = E and Vb is equal to the set\nWe note that since \u03ba\u0302ij = 0 for all i, j \u2208 [n] then E\nb\nof all inner nodes of T and \u03a9deep is an affine subspace constrained to \u03a9T .\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n19\n\nProposition 6.2. Let T be a tree with n leaves. Let p\u0302 \u2208 MT such that \u03ba\u0302ij = 0 for\nall i, j \u2208 [n]. Then\n(32)\n\nmin RLCT\u03c90 (J ) =\n\nbT\n\u03c90 \u2208\u03a9\n\nmin\nb deep\n\u03c90 \u2208\u03a9\n\nRLCT\u03c90 (J ).\n\nb T is a\nProof. We build on the proof of Theorem 5.8 in [25]. We first show that \u03a9\nunion of affine subspaces constrained to \u03a9T with a common intersection given by\nb deep . Let V0 \u2286 Vb and E0 \u2286 E\nb and\n\u03a9\n(33)\n\nb T : sv = 1 for all v \u2208 V0 , \u03b7u,v = 0 for all (u, v) \u2208 E0 }.\n\u03a9(V0 ,E0 ) = {\u03c9 \u2208 \u03a9\n\nb if for every point \u03c9 in \u03a9(V ,E ) and for every\nWe say that (V0 , E0 ) is minimal for \u03a3\n0\n0\ni, j \u2208 [n] \u03baij (\u03c9) = 0 and furthermore that (V0 , E0 ) is minimal with such a property\n(with respect to inclusion on both coordinates). We now show that the p\u0302-fiber\nsatisfies\n[\nbT =\n(34)\n\u03a9\n\u03a9(V ,E ) .\n0\n\n(V0 ,E0 )\n\n0\n\nmin.\n\nb T then \u03baij (\u03c9) = \u03ba\u0302ij = 0\nThe first inclusion \"\u2286\" follows from the fact that if \u03c9 \u2208 \u03a9\nfor all i, j \u2208 [n]. Therefore \u03c9 \u2208 \u03a9(V0 ,E0 ) for some minimal (V0 , E0 ). The second\ninclusion is obvious.\nEach \u03a9(V0 ,E0 ) is a union of 2|V0 | an affine subspace in R|V |+|E| , denoted by\nM(V0 ,E0 ) , constrained to \u03a9T . Let S denote the intersection lattice of all M(V0 ,E0 )\nfor (V0 , E0 ) minimal (c.f. Section 3.1 in [7]) with ordering denoted by \u2264. For each\ni \u2208 S let M (i) denote the corresponding intersection and define\n[\n(35)\nSi = M (i) \\\nM (j) .\nj<i\n\nIn this way we obtain an S-induced decomposition of R|V |+|E| .\nBy [10, Example 9.3.17] the function \u03c9 7\u2192 rlct\u03c9 (f ) is lower semicontinuous (the\nargument used there works over the real numbers). This means that for every \u03c90 \u2208\n\u03a9T and \u000f > 0 there exists a neighborhood U of \u03c90 such that rlct\u03c90 (f ) \u2264 rlct\u03c9 (f ) + \u000f\nfor all \u03c9 \u2208 U . Since the set of values of the real log-canonical threshold is discrete\nb T and any sufficiently small neighborhood W0 of\nthis means that for every \u03c90 \u2208 \u03a9\n\u03c90 one has rlct\u03c90 (f ) \u2264 rlct\u03c9 (f ) for all \u03c9 \u2208 W0 . Since for any neighborhood W0 of\nb deep we have W0 \u2229 Si 6= \u2205 for all i \u2208 S then necessarily the minimum of the\n\u03c90 \u2208 \u03a9\nreal log-canonical threshold is attained for a point from the deepest singularity. \u0003\nProposition 6.2 shows that in the singular case we can restrict our analysis to\nb deep . Often however we also consider points in a bigger set\nthe neighborhood of \u03a9\nb 0 = {\u03c9 \u2208 \u03a9\nb T : \u03b7u,v = 0 for all (u, v) \u2208 E}.\nb\n\u03a9\nb deep lies on the boundary of \u03a9T but \u03a9\nb 0 also contains internal points of\nNote that \u03a9\n\u03a9T which will be crucial for some of the arguments later.\nLemma\nP 6.3. Assume that p\u0302 \u2208 MT is such that \u03ba\u0302ij = 0 for all i, j \u2208 [n]. Let\nJ = i,j\u2208[n] h\u03baij (\u03c9)i and J (\u03c90 ) be the ideal J translated to the origin. Then for\nb0\nevery \u03c90 \u2208 \u03a9\n(36)\n\nRLCT0 (J (\u03c90 )) = RLCT0 (J 0 ),\n\n\f20\n\nPIOTR ZWIERNIK\n\nwhere J 0 is a monomial ideal such that each \u03baij (\u03c9 + \u03c90 ) in the set of generators of\nJ (\u03c90 ) is replaced either by\nQ\nsr(ij) (u,v)\u2208E(ij) \u03b7u,v if s0r(ij) = 1, or by\nQ\nif s0r(ij) 6= 1.\n(u,v)\u2208E(ij) \u03b7u,v\nb 0 then by Proposition 4.4\nProof. Let i, j \u2208 [n] and assume that \u03c90 \u2208 \u03a9\nY\n1\n\u03baij (\u03c9 + \u03c90 ) = (1 \u2212 (sr(ij) + s0r(ij) )2 )\n\u03b7e .\n4\ne\u2208E(ij)\n\ns0r(ij)\n\nIf\n6= 1 for a sufficiently small \u000f > 0 there exist positive constants c(\u000f), C(\u000f)\nsuch that c(\u000f) < 1 \u2212 (sr(ij) + s0r(ij) )2 < C(\u000f) for sr(ij) \u2208 (\u2212\u000f, \u000f). Therefore by\nProposition 4.1 (iv) we can replace this term in (36) with 1. If s0r(ij) = 1 rewrite\n1 \u2212 (1 + s2r(ij) )2 as \u2212sr(ij) (2 + sr(ij) ). For a sufficiently small \u000f we can find two\npositive constants c(\u000f), C(\u000f) such that c < 2 + sr(ij) < C whenever sr(ij) \u2208 (\u2212\u000f, \u000f).\nAgain by Proposition 4.1 (iv) we can replace this term with 1. This proves equation\n(36).\n\u0003\nSince J 0 is a monomial ideal then by Corollary 5.3 in [11] we can compute\nRLCT0 (J 0 ) using the method of Newton diagrams. We present this method in the\nfollowing subsection.\n6.2. Newton diagram method. Given an analytic function f \u2208 A0 (Rd ) we pick\nlocal coordinates x = (x1 , . . . , xd ) in a neighborhood of the origin.\nP This allows\nus to represent f as a power series in x1 , . . . , xd such that f (x) = \u03b1 c\u03b1 x\u03b1 . The\nexponents of terms of the polynomial f are vectors in Nd . The Newton polyhedron\nof f denoted by \u0393+ (f ) is the convex hull of the subset\n{\u03b1 + \u03b10 : c\u03b1 6= 0, \u03b10 \u2208 Rd\u22650 }.\nA subset \u03b3 \u2282 \u0393+ (f ) is a face of \u0393+ (f ) if there exists \u03b2 \u2208 Rd such that\n\u03b3 = {\u03b1 \u2208 \u0393+ (f ) : h\u03b1, \u03b2i \u2264 h\u03b10 , \u03b2i for all \u03b10 \u2208 \u0393+ (f )}.\nP\nIf \u03b3 is a subset of \u0393+ (f ) then we define f\u03b3 (x) = \u03b1\u2208\u03b3\u2229Nd c\u03b1 x\u03b1 . The principal part\nof f is by definition the sum of all terms of f supported on all compact faces of\n\u0393+ (f ).\nExample 6.4. Let f (x, y) = x3 + 2xy + 6x2 y + 3x4 y + y 2 . Then the Newton\ndiagram looks as follows\n4\n\n3\n2\n1\n\n\u0393+(f )\nb\n\nb\n\nb\n\n1\n\n2\n\nb\n\nb\n\n3\n\n4\n\n5\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n21\n\nwhere the dots correspond to the terms of f . There are only two bounded facets of\n\u0393+ (f ) and the principal part of f is equal to f (x, y) = x3 + xy + y 2 .\nDefinition 6.5. The principal part of the power series f with real coefficients is\nR-nondegenerate if for all compact faces \u03b3 of \u0393+ (f )\n\u001a\n\u001b\n\u2202f\u03b3\n\u2202f\u03b3\nn\n(37)\nx\u2208R :\n(x) = * * * =\n(x) = 0 \u2286 {\u03c9 \u2208 Rn : x1 * * * xn = 0} .\n\u2202x1\n\u2202xn\nFrom the geometric point of view this condition means that the singular locus of\nthe hypersurface defined by f\u03b3 (x) = 0 lies outside of (R\u2217 )n for all compact faces \u03b3\nof \u0393+ (f ).\nThe following theorem shows that if the principal part of f is R-nondegenerate\nand f \u2208 A\u2265\n\u0398 it greatly facilitates the computations in Theorem 2.3. An example of\nan application of these methods in statistical analysis can be found in [23].\nd\nTheorem 6.6 (Theorem 5.6, [11]). Let f \u2208 A\u2265\n0 (R ) and f (0) = 0. If the principal\n1\npart of f is R-nondegenerate then RLCT0 (f ) = ( t , c) where t is the smallest number\nsuch that the vector (t, . . . , t) hits the polyhedron \u0393+ (f ) and c is the codimension\nof the face it hits.\n\nLet now f \u2208 A\u2265\n\u03b80 such that f (\u03b80 ) = 0. We can then center f at \u03b80 obtaining\n\u2265\na function in A0 . If f is nonnegative then we can use Theorem 6.6 to compute\nRLCT\u03b80 (f ). Note that this theorem in general will not give us RLCT\u03980 (f ) if 0 is\na boundary point of \u0398. For a discussion see [1, Section 8.3.4] and Example 2.7 in\n[11].\nb 0 let \u03b4 = \u03b4(\u03c90 ) \u2208\n6.3. Proof of Proposition 6.1. Let n \u2265 4. For each \u03c90 \u2208 \u03a9\nV\n0\n{0, 1} denote the indicator vector satisfying \u03b4v = 1 if sv = 1 and \u03b4v = 0 otherwise.\nIn particular \u03b4i = 0 for all i = 1, . . . , n because the leaves are assumed to be\nnon-degenerate. Let V\u03b4 = Rne +|\u03b4| = R|\u03b4| \u00d7 Rne be a real space with variables\nrepresenting the edges (xe )e\u2208E and nodes (yv ) for all v such that \u03b4v = 1. With\nsome arbitrary numbering of the nodes and edges we order the variables as follows:\nb 0 we reduced our\ny1 \u227a * * * \u227a y|\u03b4| \u227a x1 \u227a * * * \u227a xne . In Lemma 6.3 for each \u03c90 \u2208 \u03a9\n0\n0\ncomputations to the analysis of RLCT0 (J ) where J has a simple monomial form.\nLet Q\u03b4 be a polynomial on \u03a9T defined as a sum of squares of generators of J 0 . In\nparticular RLCT0 (J 0 ) = RLCT0 (Q\u03b4 ). The exponents of terms of the polynomial\nQ\u03b4 (\u03c9) are vectors in {0, 2}ne +|\u03b4| . We have that\nX 2\u03b4r(ij)\nY\n2\n(38)\nQ\u03b4 (\u03c9) =\nsr(ij)\n\u03b7u,v\n.\ni,j\u2208[n]\n\n(u,v)\u2208E(ij)\n\nIf f is a polynomial then the convex hull of the exponents of the terms in the sum\nis called the Newton polytope and denoted \u0393(f ). Since each term of Q\u03b4 corresponds\nto a path between two leaves then the construction of the Newton polytope \u0393(Q\u03b4 ) \u2282\nV\u03b4 gives a direct relationship between paths in T and points generating the polytope.\nConvex combinations of points corresponding to paths give rise to points in the\npolytope. Let E0 \u2286 E be the subset of edges of T such that one of the ends is in\nthe set of leavesP\nof T . We call these edges terminal. Note that each point generating\n\u0393(Q\u03b4 ) satisfies e\u2208E0 xe = 4. This follows from the fact that each of these points\ncorresponds to a path between two leaves in T and every such a path need to cross\n\n\f22\n\nPIOTR ZWIERNIK\n\nexactly two terminal edges. Consequently each point of \u0393(Q\u03b4 ) needs to satisfy this\nequation as well. The induced facet of the Newton polyhedron \u0393+ (Q\u03b4 ) is given as\nX\nxe = 4}\n(39)\nF0 = {(y, x) \u2208 \u0393+ (Q\u03b4 ) :\ne\u2208E0\n\nP\n\nand each point of \u0393+ (Q\u03b4 ) satisfies e\u2208E0 xe \u2265 4.\nThe following lemma proves a part of Proposition 6.1.\nLemma 6.7 (The real log-canonical threshold of I). Let T be a trivalent tree with\nb 0 then rclt0 (J 0 ) = n .\nn leaves where n 6= 3. If \u03c90 \u2208 \u03a9\n4\nProof. If n = 2 then since s01 , s02 6= 1 by Lemma 6.3 we have that\n1\n2\nRLCT\u03c90 (J ) = RLCT\u03c90 (h\u03ba12 (\u03c9)i) = RLCT0 (\u03b712\n) = ( , 1).\n2\nTherefore Proposition 6.1 holds in this case. Now assume that n \u2265 4. By Theorem\n6.6 we have to show that t = 4/n is the smallest t such that the vector (t, . . . , t)\nhits \u0393+ (Q\u03b4 ). To show that 4/n1 \u2208 \u0393+ (Q\u03b4 ) we construct a point q \u2208 \u0393(Q\u03b4 ) such\nthat q \u2264 4/n1 coordinatewise. The point is constructed as follows.\nConstruction 6.8. Let T = (V, E) be a trivalent rooted tree with n \u2265 4 leaves.\nWe present two constructions of networks of paths between the leaves of T .\nThe first construction is for the case when \u03b4r = 1. In this case in particular T is\nrooted in an inner node. If n = 4 then the network consists of the two paths within\ncherries counted with multiplicity two.\n1\na\n\n2\n\n1\n\n4\n\n3\nb\n\n4\n\n3\n2\n\n5\n\na\n\nb\n\n5\n\nEach of the paths corresponds to a point in \u0393(Q\u03b4 ). We order the coordinates\nof V\u03b4 = R5+|\u03b4| by ya \u227a yb \u227a x1 \u227a * * * \u227a x5 where ya , yb are included only if\n\u03b4a , \u03b4b = 1. For example the point corresponding to the path involving edges e1 and\ne2 is (2, 0; 2, 2, 0, 0, 0). The barycenter of the points corresponding to all the four\npaths in the network is (1, 1; 1, 1, 0, 1, 1) both if T is rooted in a or b.\nIf n > 4 then we build the network recursively. Assume that T is rooted in an\ninner node a and pick an inner edge (a, b). Label the edges incident with a and b\nas for the quartet tree above and consider the subtree given by the quartet tree.\nDraw four paths as on the picture above. Let v be any leaf of the quartet subtree\nwhich is not a leaf of T and label the two additional edges incident with v by e6\nand e7 . Now we extend the network by adding e6 to one of the paths terminating\nin v and e7 to the other. Next we add an additional path involving only e6 and e7\nlike on the picture below. By construction v is the root of the additional path. We\nextend the network cherry by cherry until it covers all terminal edges.\n1\n2\n\na\n\n1\n\n4\n\n3\nb\n\n4\n\n3\n\n5\n\nv\n6\n\n2\n\na\n\nb\n\n5\n\nv\n\n7\n6\n\n7\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n23\n\nNote that we have made some choices building up the network and hence the\nconstruction is not unique. However, each of the inner nodes is always a root of\nat least one and at most two paths. Moreover, each edge is covered at most twice\nand each terminating edge is covered exactly two times. We have n pathsPin the\nn\nnetwork, all representing points of \u0393(Q\u03b4 ) denoted by q1 , . . . , qn . Let q = n1 i=1 qi\nthen q \u2208 \u0393(Q\u03b4 ) is given by xab = 0, xe = 4/n for all e \u2208 E \\ (a, b). The other\ncoordinates by construction satisfy ya = 4/n, yb = 4/n if \u03b4b = 1, and yv = 2/n for\nall v \u2208 V \\ {a, b} such that \u03b4v = 1.\nIf \u03b4r = 0 then we proceed as follows. For n = 4 consider a network of all the\npossible paths all counted with multiplicity one apart from the cherry paths (paths\nof length two) counted with multiplicity two. This makes eight paths and each\nedge is covered exactly four times. With the order of the coordinates as above the\ncoordinates of the point representing the barycenter of all paths in the network\nsatisfy xe = 1 for all e \u2208 E and yv = 1/2 for all v such that \u03b4v = 1. This\nconstruction generalizes recursively in a similar way as the one for T rooted in an\ninner node. We always have 2n paths and each edge is covered exactly four times.\nThe network induces a point q \u2208 \u0393(Q\u03b4 ) with coordinates given by yv = 2/n for all\nv \u2208 V such that \u03b4v = 1 and xe = 4/n for e \u2208 E. (This finishes the construction.)\nThe point 4/n 1 lies in \u0393+ (Q\u03b4 ). This follows from Construction 6.8 and the\nfact that the constructed point q \u2208 \u0393(Q\u03b4 ) satisfies\nq \u2264 n4 1. Moreover, for any\nP\ns < 4/n the point s(1, . . . , 1) does not satisfy e\u2208E0 xe \u2265 4 and hence it cannot\nbe in \u0393+ (Q\u03b4 ). It follows that 4/n is the smallest t such that t1 \u2208 \u0393+ (Q\u03b4 ) and\ntherefore rlct0 (J 0 ) = n/4. We note that the result does not depend on \u03b4.\n\u0003\nTo compute the multiplicity of the real log-canonical threshold of Q\u03b4 we have to\nget a better understanding of the polyhedron \u0393+ (Q\u03b4 ). According to Theorem 6.6\nwe need to find the codimension of the face of \u0393+ (Q\u03b4 ) hit by 4/n1. First we find\nthe hyperplane representation of the Newton polytope \u0393(Q\u03b4 ) reducing the problem\nto a simpler but equivalent one.\nDefinition 6.9 (A pair-edge incidence polytope). Let T = (V, E) be a trivalent\ntree with n \u2265 4 leaves. We define a polytope Pn \u2282 Rne , where ne = 2n \u2212 3, as a\nconvex combination of points (qij )i,j\u2208[n] where k-th coordinate of qij is one if the\nk-th edge is in the path between i and j and there is zero otherwise. We call Pn a\npair-edge incidence polytope by analogy to the pair-edge incidence matrix defined\nby Mihaescu and Pachter [12, Definition 1].\nThe reason to study the pair-edge incidence polytope is that its structure can\nbe handled easily and this can be shown to be affinely equivalent to \u0393(Q\u03b4 ). This\nis immediate if \u03b4 = (0, . . . , 0) since Q0 = 2Pn . For an arbitrary \u03b4 fix a rooting r of\nT and define a linear map fr : Rne \u2192 R|\u03b4| as follows. For each v \u2208 V \\ r such that\n\u03b4v = 1 set\nyv = 1/2(xvch1 (v) + xvch2 (v) \u2212 xpa(v)v ),\nwhere ch1 (v), ch2 (v) denotes the two children of v. If \u03b4r = 1 then set\nyr = 1/2(xrch1 (r) + xrch2 (r) + xrch3 (r) ).\nIt can be easily checked that for a map (id \u00d7 fr ) : Rne \u2192 Rne \u00d7 R|\u03b4| one has\n(id \u00d7 fr )(2Pn ) = \u0393(Q\u03b4 ). This follows from the fact that for each point yr = 2 if\n\n\f24\n\nPIOTR ZWIERNIK\n\nand only if the path crosses r and for any other node yv = 2 if and only if the path\ncrosses v and v is the root of the path, i.e. if the path crosses both children of v.\nLemma 6.10. Let Pn \u2282 Rne be a pair-edge incidence polytope for a trivalent tree\nwith n leaves where n \u2265 4. Then dim(Pn ) = ne \u22121 =P2n\u22124. Hence the codimension\nof Pn is one. The unique equation defining Pn is e\u2208E0 xe = 2. For each inner\nnode v \u2208 V let e1 (v), e2 (v), e3 (v) denote the three adjacent edges. Then exactly\n3(n \u2212 2) facets define Pn and they are given by\n(40)\n\nxe1 (v) + xe2 (v) \u2212 xe3 (v) \u2265 0,\n\nxe2 (v) + xe3 (v) \u2212 xe1 (v) \u2265 0,\n\nand xe3 (v) + xe1 (v) \u2212 xe2 (v) \u2265 0\n\nfor all v \u2208 V .\n\u0001\nProof. Let Mn be the pair-edge incidence matrix, i.e. a n2 \u00d7 ne matrix with\nrows corresponding to the points defining Pn . By Lemma 1 in [12] the matrix has\nfull rank and hence Pn has codimension one in Rne . Moreover since each path\nnecessarily\nPcrosses two terminal edges then each point generating Pn satisfies the\nequation e\u2208E0 xe = 2 and hence this is the equation defining the affine subspace\ncontaining Pn .\nNow we show that the inequalities give a valid facet description for Pn . This can\nbe checked directly for n = 4 (e.g. using Polymake [6]). Assume thisP\nis true for all\nk < n. By Qn we will define the polytope defined by the equation e\u2208E0 xe = 2\nand 3(n \u2212 2) inequalities given by (40). It is obvious that Pn \u2286 Qn since all points\ngenerating Pn satisfy the equation and the inequalities. We show that the opposite\ninclusion also holds.\nConsider any cherry {e1 , e2 } \u2282 E in the tree given by two leaves denoted by\n1, 2 and the separating inner node a. Note that the inequalities in (40) imply in\nparticular that xe \u2265 0 for all e \u2208 E. Define a projection \u03c0 : Rne \u2192 Rne \u22122 on\nthe coordinates related to all the edges apart from the two in the cherry. We have\nb n\u22121 , where Pb = conv{0, P } is a cone with the base given by P . The\n\u03c0(Qn ) = Q\nprojection \u03c0(Qn ) is described by all the triples of inequalities for all the inner nodes\napart from the one incident with the cherry and the defining equation becomes an\ninequality\nX\nxe \u2264 2.\ne\u2208E0 \\{e1 ,e2 }\n\nDenote the edge incident with e1 , e2 by e3 and the related coordinates of x by\nx1 , x2 , x3 . The three inequalities involving x1 and x2 do not affect the projection\nsince they imply that\nmax{x1 \u2212 x2 , x2 \u2212 x1 } \u2264 x3 \u2264 x1 + x2\nand hence in particular if x1 = x2 the constraint becomes [0, 2x1 ]. Consequently\nthe set given by x1 + x2 \u2212 x3 \u2265 0, x1 + x3 \u2212 x2 \u2265 0, x2 + x3 \u2212 x1 \u2265 0 projects down\nb n\u22121 is contained in the nonnegative orthant there are no\nto R\u22650 . However since Q\nadditional constraints\nP on x3 . Inequalities in Equation (40) define a polyhedral cone\nand the equation e\u2208E0 \\{e1 ,e2 } xe = t for t \u2265 0 cuts out a bounded slice of the\nb n\u22121 .\ncone which is equal to t * Pn\u22121 . The sum of all these for t \u2208 [0, 2] is exactly Q\nb\nb\nSince Qn\u22121 = Pn\u22121 by induction then each \u03c0(x)\nP is a convex combination of the\npoints generating Pn\u22121 and zero,Pi.e. \u03c0(x) =\ncij pij where the sum is over all\ni 6= j \u2208 {a, 3, . . . , n} and cij \u2265 0,\ncij \u2264 1.\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n25\n\nLet x \u2208 Qn . Since \u03c0(x) \u2208 Pbn\u22121 we can write it as the linear combination above.\nNext we lift this combination back to Qn and show that any such a lift has to lie\nin Pn . This would imply that in particular x \u2208 Pn . Let y denote a lift of \u03c0(x) to\nQn . We have\n\u0010\nX\nX \u0011\ny=\ncij rij + 1 \u2212\ncij r0 ,\nwhere rij is a lift of \u03c0(pij ) and r0 is a lift of the origin. It suffices to show that each\nrij and r0 necessarily lie in Pn .\nConsider the following three cases. First if pij \u2208 Pn\u22121 is such that x3 = 0\nthen sum of all the other coordinates related\nPto the terminal edges is two since\nPn\u22121 = Qn\u22121 and Qn\u22121 satisfy the equation e\u2208E0 \\{e1 ,e2 } xe = 2. Hence if we lift\n\u03c0(pij ) to Qn then x3 = 0 and\nx1 + x2 \u2265 0,\n\nx1 \u2212 x2 \u2265 0,\n\nx2 \u2212 x1 \u2265 0\n\nby plugging x3 = 0 into P\nthe three inequalities for the node a. But since rij must\nalso satisfy the equation e\u2208E0 xe = 2 and since we already have\nX\nxe = 2\ne\u2208E0 \\{e1 ,e2 }\n\nthen x1 + x2 = 0 and hence x1 = x2 = 0. Consequently, rij is a vertex of Pn .\nSecond if pij is a vertex of Pn\u22121 such that x3 = 1 then the sum of all the other\ncoordinates of pij related to the terminal edges is one and hence since the lift is in\nQn we have x1 + x2 = 1. The additional inequalities give that x1 , x2 \u2265 0. Hence\nin this case rij is a convex combination of two points in Pn - one corresponding\nto a path finishing in one of the edges and the other in the other. Finally, we can\neasily check that zero lifts uniquely to a point in Pn corresponding to the path\nE(12). Indeed, from the equation defining Qn we have x1 + x2 = 2 and from the\ninequalities since x3 = 0 we have x1 = x2 = 1. Therefore every lift y of \u03c0(x) to Qn\ncan be written as a convex combination of points generating Pn and hence y \u2208 Pn .\nConsequently x \u2208 Pn and hence Qn \u2286 Pn .\n\u0003\nLemma 6.10 shows that Pn has an extremely simple structure. The inequalities\ngive a polyhedral cone and the equation cuts out the polytope Pn as a slice of this\ncone. The result gives us also the representation of \u0393(Q\u03b4 ) in terms of the defining\nequations and inequalities.\nProposition 6.11 (Structure of \u0393(Q\u03b4 )). Polytope \u0393(Q\u03b4 ) \u2282 V\u03b4 is given as an\nintersection of the sets defined by the inequalities in (40) together with |\u03b4| + 1\nequations given by\n(41)\n\n2yv = xvch1 (v) + xvch2 (v) \u2212 xpa(v)v\n2yr = xrch1 (r) + xrch2 (r) + xrch3 (r)\nP\ne\u2208E0 xe = 4.\n\nfor all v 6= r such that \u03b4v = 1,\nif \u03b4r = 1, and\n\nFrom this we can partially understand the structure of \u0393+ (Q\u03b4 ). First note that\n\u0393+ (f ) = \u0393(f ) + Rd\u22650 , where the plus denotes the Minkowski sum. The Minkowski\nsum of two polyhedra is by definition\n\u03931 + \u03932 = {x + y \u2208 Rd : x \u2208 \u03931 , y \u2208 \u03932 }.\nLemma 6.12. Let \u0393 \u2282 Rn\u22650 be a polytope and let \u0393+ be the Minkowski sum of \u0393\nP\nand the standard cone Rn\u22650 . Then all the facets of \u0393+ are of the form i ai xi \u2265 c\nwhere ai \u2265 0 and c \u2265 0.\n\n\f26\n\nPIOTR ZWIERNIK\n\nNow we are ready to compute multiplicities of the real log-canonical threshold\nRLCT0 (Q\u03b4 ). This completes the proof of Proposition 6.1.\nLemma 6.13 (Computing multiplicities). Let T be a trivalent tree with n \u2265 4\nleaves and rooted in r. Let p\u0302 \u2208 MT be such that \u03ba\u0302ij = 0 for all i, j \u2208 [n] and\nb 0 . Let \u03b4 = \u03b4(\u03c90 ) be such that \u03b4v = 1 if s0 = 1 and it is zero otherwise.\n\u03c90 \u2208 \u03a9\nv\nDefine Q\u03b4 (\u03c9) as in (38). If either \u03b4r = 0 or \u03b4r = 1 and \u03b4v = 1 for all (r, v) \u2208 E\nthen mult0 (Q\u03b4 ) = 1.\nProof. A standard result for Minkowski sums says that each face of a Minkowski\nsum of two polyhedra can be decomposed as a sum of two faces of the summands\nand this decomposition is unique. Each facet of \u0393+ (Q\u03b4 ) is decomposed as a face\nne +|\u03b4|\nof the standard cone R\u22650\n\u2282 V\u03b4 plus a face of \u0393(Q\u03b4 ). We say that a face of\nn +|\u03b4|\n\ne\n\u0393(Q\u03b4 ) induces a facet of \u0393+ (Q\u03b4 ) if there exists a face of the standard cone R\u22650\nsuch that the Minkowski sum of these two faces gives a facet of \u0393+ (Q\u03b4 ). However,\nsince the dimension \u0393(Q\u03b4 ) is lower than the dimension of the resulting polyhedron\nit turns out that one face of \u0393(Q\u03b4 ) can induce more than one facet of \u0393+ (Q\u03b4 ). In\nparticular \u0393(Q\u03b4 ) itself induces more than one facet and one of them is F0 given by\n(39).\nEvery facet\n+ (Q\u03b4 ) containing 4/n1 after normalizing the coefficients to sum\nP of \u0393P\nto n, i.e.\n\u03b1\n+\nv\nv\ne \u03b2e = n, is of the form\nX\nX\n(42)\n\u03b1v yv +\n\u03b2e xe \u2265 4,\n\nv\n\ne\n\nwhere by Lemma 6.12 we can assume that \u03b1v , \u03b2e \u2265 0.\nOur approach can be summarized as follows. Using Construction 6.8 we provide\nne +|\u03b4|\ncoordinates of a point q \u2208 \u0393(Q\u03b4 ) such that 4/n1 lies on the boundary of q +R\u22650\n.\nThen 4/n1 can only lie on faces of \u0393+ (Q\u03b4 ) induced by faces of \u0393(Q\u03b4 ) containing q.\nFirst, assume that \u03b4r = 0 which corresponds to the case when the root r represents a non-degenerate random variable. Consider the point q \u2208 \u0393(Q\u03b4 ) induced by\nthe network of 2n paths given in Construction 6.8. Since xe = 4/n for all e \u2208 E\nthen from the description of \u0393(Q\u03b4 ) in Lemma 6.11 we can check that all defining\ninequalities are strict for this point. Therefore q lies in the interior of \u0393(Q\u03b4 ). Therefore, the only facets of \u0393+ (Q\u03b4 ) containing q are these induced by \u0393(Q\u03b4 ) itself. The\nequation defining a facetPinduced by \u0393(Q\u03b4 ) has to be obtained as a combination of\nthe defining equations: e\u2208E0 xe = 4 and |\u03b4| equations\n(43)\n\n2yv \u2212 xvch1 (v) \u2212 xvch2 (v) + xpa(v)v = 0\n\nfor all v \u2208 V such that \u03b4v = 1. We check possible combinations such that the form\nof the induced inequality as given in (42) is attained. The first inequality, defining\nF0 , is already of this form (c.f. equation (39)). The sum of all the coefficients is\nn since there are n terminal edges. Any other facet has to be obtained by adding\nto the first equation (since the right hand side in (42) is 4) a non-negative (since\nthe coefficients in front of yv need to be non-negative) combination of equations in\n(43). However, since the sum of the coefficients in (43) is +1 this contradicts the\nassumption that the sum of coefficients in the defining inequality is n. Consequently,\nif \u03b4r = 0 the codimension of the face hit by 4/n1 is 1 and hence by Theorem 6.6\nwe have that mult0 (Q\u03b4 ) = 1.\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n27\n\nSecond, if \u03b4r = 1 and \u03b4v = 1 for all children of r in T then since all the nodes\nadjacent to r (denote them by a, b, c) are inner we have three different ways of\nconducting the construction of the n-path network in Lemma 6.8 (by omitting each\nof the incident edges). Hence we get three different points and their barycenter\nsatisfies xra = xrb = xrc = 8/3n and xe = 4/n for all the other edges; yr = 4/n,\nya = yb = yc = 8/3n and yv = 2/n for all the other inner nodes. Denote this\npoint by q. By the facet description of \u0393(Q\u03b4 ) derived in Proposition 6.11 we can\ncheck that this point cannot lie in any of the facets defining \u0393(Q\u03b4 ) and hence it is\nan interior point of the polytope. As in the first case it means that the facets of\n\u0393+ (Q\u03b4 ) containing q are induced by \u0393(Q\u03b4 ). By Proposition 6.11 the affine span is\ngiven by the equation defining F0 , the equations (43) for all inner edges v apart\nfrom the root and in addition for the root we have\n(44)\n\n2yr \u2212 xra \u2212 xrb \u2212 xrc = 0.\n\nSince the sum of coefficients in the above equation isPnegative we cannot use the\nsame argument as in the first case. Instead we add to e\u2208E0 xe = 4 a non-negative\ncombination\nPof equations in (43) each with coefficient tv \u2265 0 and then add (44) with\ncoefficient v6=r tv . The sum of coefficients in the resulting equation will be n by\nP\nconstruction. The coefficient of xra is ta \u2212 v6=r tv . Since it has to be non-negative\nit follows that tv = 0 for all v apart from a. However, by checking the coefficient of\nxrb one deduces that tv = 0 for all inner nodes v. Consequently the only possible\nfacet of \u0393+ (Q\u03b4 ) containing 4/n1 is F0 and hence again mult0 (Q\u03b4 ) = 1.\n\u0003\n7. Proof of Theorem 1.2\nIn this section we complete the proof of Theorem 1.2. We split the proof into\nthree steps.\nStep 1. To approximate log Z(N ) it suffices to approximate log I(N ), where I(N )\nis given by (11) because log Z(N ) = `\u02c6N + log I(N ). By Theorem 2.3 equivalently\nwe can compute RLCT\u0398T (f ; \u03c6), where f is the normalized log-likelihood and \u03c6 is\nthe prior distribution satisfying (A1). By Theorem 4.2 and Theorem 4.6 this real\nlog-canonical threshold is equal to RLCT\u03a9T (I), where I is the ideal given by (24).\nStep 2. We compute separately RLCT\u03a9T (I) in the case when n = 3. If T is rooted\nin the inner node the approximation for log Z(N ) follows from Theorem 4 in [16].\nb = E, which in [16] corresponds to the type 2 singularity, then\nThus if E\n(45)\nlog Z(N ) = `\u02c6N \u2212 2 log N + O(1) or\nRLCT\u03a9 (I) = (2, 1).\nT\n\nSince all the neighbours of the root are leaves and hence by (A2) they are nondegenerate we need only to make sure that the first equation in Theorem 1.2 gives\nb =1\n(45). This follows from the fact that l2 = 0 and l3 = 0. In the case when |E|\n(type 1 singularity) we have\n5\n5\nRLCT\u03a9T (I) = ( , 1).\nlog Z(N ) = `\u02c6N \u2212 log N + O(1) or\n2\n2\nb=\u2205\nThe second equation in Theorem 1.2 holds since l2 = 1, l3 = 0 and c = 0. If E\nwe have\n7\n7\nRLCT\u03a9T (I) = ( , 1),\nlog Z(N ) = `\u02c6N \u2212 log N + O(1) or\n2\n2\nwhich again is true since l2 = 0, l3 = 1 and c = 0.\n\n\f28\n\nPIOTR ZWIERNIK\n\nNow assume that T is rooted in a leaf, say 1. If there exists i, j = 1, 2, 3 such\nb \u2264 1) then Vb = \u2205 and by Proposition 3.2\nthat \u03ba\u0302ij 6= 0 (or |E|\nlog Z(N ) = `\u02c6N \u2212\n\n7 \u2212 2l2\n+ O(1)\n2\n\nor\n\nRLCT\u03a9T (I) = (\n\n7 \u2212 2l2\n, 1).\n2\n\nb = E then by Theorem 4.6 for every \u03c90 \u2208 \u03a9\nbT\nIf E\n3\nRLCT\u03c90 (I) = ( , 0) + RLCT\u03c90 (J ).\n2\nb0\nMoreover, by Lemma 6.3, for every \u03c90 \u2208 \u03a9\nRLCT\u03c90 (J ) = RLCT0 (h\u03b71,h \u03b7h,2 , \u03b71,h \u03b7h,3 , s\u03b4hh \u03b7h,2 \u03b7h,3 i),\nwhere \u03b4h = 1 if s0h = 1 and \u03b4h = 1 otherwise. It can be checked directly by using\nthe Newton diagram method and Theorem 6.6 that RLCT\u03c90 (J ) = ( 43 , 1) both if\nb 0 such that\n\u03b4h = 0 and \u03b4h = 1 and hence RLCT\u03c90 (I) = ( 49 , 1). Since the points in \u03a9\n0\nsh 6= 1 lie in the interior of \u03a9T then for these points RLCT\u03c90 (I) = RLCT\u03a90 (I)\nwhere \u03a90 is a neighborhood of \u03c90 in \u03a9T . Hence by (8) we have that\nRLCT\u03a9T (I) = min RLCT\u03a90 (I) \u2264\nbT\n\u03c90 \u2208\u03a9\n\nmin\nb 0 \u2229int(\u03a9T )\n\u03c90 \u2208\u03a9\n\n9\nRLCT\u03a90 (I) = ( , 1).\n4\n\nOn the other hand by (7) and then Proposition 6.2\nRLCT\u03a9T (I) \u2265 min RLCT\u03c90 (I) \u2265\nbT\n\u03c90 \u2208\u03a9\n\nmin\nb deep\n\u03c90 \u2208\u03a9\n\n9\nRLCT\u03c90 (I) = ( , 1).\n4\n\nIt follows that\n(46)\n\n9\nlog Z(N ) = `\u02c6N \u2212 log N + O(1)\n4\n\nor\n\n9\nRLCT\u03a9T (I) = ( , 1),\n4\n\nwhich gives the the second equation in Theorem 1.2 since in this case l2 = l3 = c =\n0.\nStep 3, Case 1. Assume now that n \u2265 4 and r \u2208\n/ Vb . In this case every Ti for\ni = 1, . . . , k is rooted in one of its leaves. Hence rlct\u03c90 (J (Ti )) = |Li |/4 for every\ni = 1, . . . k. If |Li | =\n6 3 this follows from Proposition 6.1. If |Li | = 3 it follows from\nb 0 we have that\nCase 2 above. By Lemma 5.1 and Proposition 3.2, for every \u03c90 \u2208 \u03a9\nm\nk\nX\nn\nniv + nie \u2212 ni \u2212 2l2i X |Li |\n+\n,\nrlct\u03c90 (I) = ( , 0) +\n2\n2\n4\ni=1\ni=1\n\nwhere niv , nie , l2i are respectively the number of vertices, edges and and degree\ntwo nodes in Tb of Si ; and Li is the set of leaves of Ti . We use three simple\nP i\nformulas:\nn = l1 + l2 + l3 (i.e. only degree zero nodes of Tb do not lie in\nP i iv\nb\nb\nthe\nP Si 's), i ne = |E \\ E| (i.e. E \\ E is the set of all edges of all the Si 's) and\ni |Li | = l2 + n \u2212 l1 (i.e. the leaves of all the Ti 's are precisely the degree two nodes\nof Tb and these leaves of T which havePdegree zero). Moreover for any graph with\nthe vertex set V and the edge set E, v\u2208V deg(v) = 2ne (see e.g. Corollary 1.2.2\nb\nin [19]). Therefore with the formula applied for Tb we have l1 + 2l2 + 3l3 = 2|E \\ E|.\n1\nUsing these four formulas we show that rlct\u03c90 (I) = 4 (3n+l2 +5l3 ). Moreover, since\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n29\n\nb 0 then by Lemma 6.13 mult0 (J (Ti )) = 1 for every \u03c90 \u2208 \u03a9\nb 0.\n\u03b4r = 0 for all \u03c90 \u2208 \u03a9\nTherefore,\n\u0012\n\u0013\n1\n(47)\nRLCT\u03c90 (I) =\n(3n + l2 + 5l3 ), 1 .\n4\nb0\nNow we show that RLCT\u03a9T (I) also has the same form. Let \u03c92 be a point in \u03a9\nb deep . Equation (47) is true both if\nsuch that sv 6= 1 for all v \u2208 V and let \u03c91 \u2208 \u03a9\n\u03c90 = \u03c91 and \u03c90 = \u03c92 and hence RLCT\u03c91 (I) = RLCT\u03c92 (I). However, since \u03c92 is\nan inner point of \u03a9T it follows, from the definition of RLCT\u03a9T (I) as the minimum\nover all points in \u03a9T , that\nRLCT\u03a9T (I) \u2264 RLCT0 (I\u03c92 ).\nOn the other hand by (7) and Proposition 6.2\nRLCT0 (I\u03c91 ) = min RLCT0 (I\u03c90 ) \u2264 min RLCT\u03a90 (I\u03c90 ) = RLCT\u03a9T (I).\nbT\n\u03c90 \u2208\u03a9\n\nbT\n\u03c90 \u2208\u03a9\n\nTherefore, if r \u2208\n/ Vb then in fact RLCT\u03a9T (I) = ( 41 (3n + l2 + 5l3 ), 1) and hence\n1\nZ(N ) = `\u02c6N \u2212 (3n + l2 + 5l3 ) log N + O(1).\n4\nHence in this case the main formula in Theorem 1.2 is proved since c = 0.\nStep 3, Case 2. Let now n \u2265 4 and r \u2208 Vb . Let 1 \u2264 j \u2264 k be such that r is\nb 0 . For all i 6= j Ti is rooted in one of its leaves.\nan inner node of Tj and \u03c90 \u2208 \u03a9\nTherefore, by Lemma 6.7, Lemma 6.13 and Step 2 above for all i 6= j we have that\nRLCT\u03c90 (J (Ti )) = (|Li |/4, 1). It remains to compute RLCT\u03c90 (J (Tj )). If |Lj | = 3\nthen RLCT\u03c90 (J (Tj )) = (1/2, 1) = ((|Lj | \u2212 1)/4, 1) by the Step 2 above (c.f. (45)).\nTherefore in this case the computations are the same as in Step 3, Case 1 but with\na difference of 41 in the real log-canonical threshold. Therefore we obtain\n1\nZ(N ) = `\u02c6N \u2212 (3n + l2 + 5l3 \u2212 1) log N + O(1).\n4\nHowever, if |Lj | \u2265 4 then by Lemma 6.7 rlct0 (J (Tj )) = |Lj |/4 and hence as in\nPk\nStep 3, Case 1 we have i=1 rlct0 (J\u03c90 (Ti )) = 14 (n \u2212 l1 + l2 ). Therefore\nrlct\u03a9T (I) =\n\n1\n(3n + l2 + 5l3 ).\n4\n\nWe compute the multiplicity by considering different subcases. If all the neighbours\nb deep we have that \u03b4r = 1 and \u03b4v = 1\nof r are degenerate then for all points \u03c90 \u2208 \u03a9\nfor all neighbours v or r. It follows from Lemma 6.13 that mult\u03c90 (J (Tj )) = 1 and\nhence mult\u03a9T (I) = 1. Therefore,\n1\nZ(N ) = `\u02c6N \u2212 (3n + l2 + 5l3 ) log N + O(1).\n4\nOtherwise we do not have explicit bounds on the multiplicity. Since mult\u03a9T (I) \u2265 1\nthen\n1\nZ(N ) = `\u02c6N \u2212 (3n + l2 + 5l3 ) log N + (m \u2212 1) log log N + O(1),\n4\nwhere m \u2265 1. This finishes the proof of Theorem 1.2.\n\u0003\n\n\f30\n\nPIOTR ZWIERNIK\n\nAcknowledgments\nI am especially grateful to Shaowei Lin for a number of helpful comments and\nfor introducing me to the theory of log-canonical thresholds. I also want to thank\nDiane Maclagan for helpful discussions.\nReferences\n[1] V. I. Arnold, S. M. Guse\u0131\u0306n-Zade, and A. N. Varchenko, Singularities of differentiable\nmaps, vol. II, Birkh\u00e4user, 1988.\n[2] M. F. Atiyah, Resolution of singularities and division of distributions, Communications on\nPure and Applied Mathematics, 23 (1970), pp. 145\u2013150.\n[3] E. Bierstone and P. D. Milman, Semianalytic and subanalytic sets, Publications\nMath\u00e9matiques de l'IH\u00c9S, 67 (1988), pp. 5\u201342.\n[4] D. M. Chickering and D. Heckerman, Efficient approximations for the marginal likelihood\nof Bayesian networks with hidden variables, Machine Learning, 29 (1997), pp. 181\u2013212.\n[5] G. F. Cooper and E. Herskovits, A Bayesian method for the induction of probabilistic\nnetworks from data, Machine learning, 9 (1992), pp. 309\u2013347.\n[6] E. Gawrilow and M. Joswig, Geometric reasoning with polymake. arXiv:math.CO/0507273,\n2005.\n[7] M. Goresky and R. MacPherson, Stratified Morse theory, vol. 14 of Ergebnisse der Mathematik und ihrer Grenzgebiete (3) [Results in Mathematics and Related Areas (3)], SpringerVerlag, Berlin, 1988.\n[8] D. Heckerman, D. Geiger, and D. M. Chickering, Learning Bayesian networks: The\ncombination of knowledge and statistical data, Machine learning, 20 (1995), pp. 197\u2013243.\n[9] J. Koll\u00e1r, Singularities of pairs, in Proceedings of Symposia in Pure Mathematics, vol. 62,\n1997, pp. 221\u2013288.\n[10] R. Lazarsfeld, Positivity in algebraic geometry, A Series of Modern Surveys in Mathematics,\nSpringer Verlag, 2004.\n[11] S. Lin, Asymptotic Approximation of Marginal Likelihood Integrals. arXiv:1003.5338, March\n2010. submitted.\n[12] R. Mihaescu and L. Pachter, Combinatorics of least-squares trees, Proceedings of the\nNational Academy of Sciences of the United States of America, 105 (2008), p. 13206.\n[13] J. R. Munkres, Analysis on manifolds, Addison-Wesley Publishing Company Advanced\nBook Program, Redwood City, CA, 1991.\n[14] L. Pachter and B. Sturmfels, eds., Algebraic statistics for computational biology, Cambridge University Press, New York, 2005.\n[15] J. Pearl and M. Tarsi, Structuring causal trees, J. Complexity, 2 (1986), pp. 60\u201377. Complexity of approximately solved problems (Morningside Heights, N.Y., 1985).\n[16] D. Rusakov and D. Geiger, Asymptotic model selection for naive Bayesian networks, J.\nMach. Learn. Res., 6 (2005), pp. 1\u201335 (electronic).\n[17] M. Saito, On real log canonical thresholds. arXiv:0707.2308, 2007.\n[18] G. Schwarz, Estimating the dimension of a model, Annals of Statistics, 6 (1978), pp. 461\u2013\n464.\n[19] C. Semple and M. Steel, Phylogenetics, vol. 24 of Oxford Lecture Series in Mathematics\nand its Applications, Oxford University Press, Oxford, 2003.\n[20] R. P. Stanley, Enumerative combinatorics. Volume I, no. 49 in Cambridge Studies in Advanced Mathematics, Cambridge University Press, 2002.\n[21] S. Watanabe, Algebraic Geometry and Statistical Learning Theory, no. 25 in Cambridge\nMonographs on Applied and Computational Mathematics, Cambridge University Press, 2009.\nISBN-13: 9780521864671.\n[22] S. Watanabe, Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable\nInformation Criterion in Singular Learning Theory, Arxiv preprint arXiv:1004.2316, (2010).\n[23] K. Yamazaki and S. Watanabe, Newton diagram and stochastic complexity in mixture of\nbinomial distributions, in Algorithmic learning theory, vol. 3244 of Lecture Notes in Comput.\nSci., Springer, Berlin, 2004, pp. 350\u2013364.\n[24] P. Zwiernik and J. Q. Smith, The semialgebraic description of tree models for binary data.\narXiv:0904.1980, May 2010.\n\n\fAPPROXIMATION OF THE MARGINAL LIKELIHOOD FOR TREE MODELS\n\n31\n\n[25] P. Zwiernik and J. Q. Smith, Tree-cumulants and the geometry of binary tree models.\narXiv:1004.4360, 2010. to appear in Bernoulli.\nPiotr Zwiernik, University of Warwick, Department of Statistics, CV7AL, Coventry,\nUK.\nE-mail address: p.w.zwiernik@warwick.ac.uk\n\n\f"}