{"id": "http://arxiv.org/abs/0812.0672v1", "guidislink": true, "updated": "2008-12-03T09:17:18Z", "updated_parsed": [2008, 12, 3, 9, 17, 18, 2, 338, 0], "published": "2008-12-03T09:17:18Z", "published_parsed": [2008, 12, 3, 9, 17, 18, 2, 338, 0], "title": "Group actions on geodesic Ptolemy spaces", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0812.4802%2C0812.4915%2C0812.4755%2C0812.3235%2C0812.0290%2C0812.2367%2C0812.2901%2C0812.0672%2C0812.2352%2C0812.4577%2C0812.3175%2C0812.4979%2C0812.3358%2C0812.2886%2C0812.2651%2C0812.2533%2C0812.2380%2C0812.4475%2C0812.2563%2C0812.1496%2C0812.1614%2C0812.0254%2C0812.3529%2C0812.2266%2C0812.3572%2C0812.3103%2C0812.4440%2C0812.3335%2C0812.2394%2C0812.3120%2C0812.1476%2C0812.2243%2C0812.2093%2C0812.4821%2C0812.3503%2C0812.0627%2C0812.3399%2C0812.1103%2C0812.0968%2C0812.4059%2C0812.3055%2C0812.3116%2C0812.2559%2C0812.3755%2C0812.2304%2C0812.1142%2C0812.4651%2C0812.1657%2C0812.4871%2C0812.4445%2C0812.0582%2C0812.2899%2C0812.1027%2C0812.1247%2C0812.1390%2C0812.3174%2C0812.4725%2C0812.4478%2C0812.3172%2C0812.1371%2C0812.4579%2C0812.0540%2C0812.0077%2C0812.1725%2C0812.2345%2C0812.1919%2C0812.3927%2C0812.1717%2C0812.3917%2C0812.3812%2C0812.2258%2C0812.3076%2C0812.0736%2C0812.1014%2C0812.2145%2C0812.3356%2C0812.1985%2C0812.3898%2C0812.3635%2C0812.1321%2C0812.0596%2C0812.3019%2C0812.3254%2C0812.0897%2C0812.3738%2C0812.5019%2C0812.4300%2C0812.2981%2C0812.1834%2C0812.2386%2C0812.1075%2C0812.1744%2C0812.0455%2C0812.2097%2C0812.2204%2C0812.3196%2C0812.2841%2C0812.0878%2C0812.1468%2C0812.3637%2C0812.0061&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Group actions on geodesic Ptolemy spaces"}, "summary": "In this paper we study geodesic Ptolemy metric spaces $X$ which allow proper\nand cocompact isometric actions of crystallographic or, more generally, virtual\npolycyclic groups. We show that $X$ is equivariantly rough isometric to a\nEuclidean space.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0812.4802%2C0812.4915%2C0812.4755%2C0812.3235%2C0812.0290%2C0812.2367%2C0812.2901%2C0812.0672%2C0812.2352%2C0812.4577%2C0812.3175%2C0812.4979%2C0812.3358%2C0812.2886%2C0812.2651%2C0812.2533%2C0812.2380%2C0812.4475%2C0812.2563%2C0812.1496%2C0812.1614%2C0812.0254%2C0812.3529%2C0812.2266%2C0812.3572%2C0812.3103%2C0812.4440%2C0812.3335%2C0812.2394%2C0812.3120%2C0812.1476%2C0812.2243%2C0812.2093%2C0812.4821%2C0812.3503%2C0812.0627%2C0812.3399%2C0812.1103%2C0812.0968%2C0812.4059%2C0812.3055%2C0812.3116%2C0812.2559%2C0812.3755%2C0812.2304%2C0812.1142%2C0812.4651%2C0812.1657%2C0812.4871%2C0812.4445%2C0812.0582%2C0812.2899%2C0812.1027%2C0812.1247%2C0812.1390%2C0812.3174%2C0812.4725%2C0812.4478%2C0812.3172%2C0812.1371%2C0812.4579%2C0812.0540%2C0812.0077%2C0812.1725%2C0812.2345%2C0812.1919%2C0812.3927%2C0812.1717%2C0812.3917%2C0812.3812%2C0812.2258%2C0812.3076%2C0812.0736%2C0812.1014%2C0812.2145%2C0812.3356%2C0812.1985%2C0812.3898%2C0812.3635%2C0812.1321%2C0812.0596%2C0812.3019%2C0812.3254%2C0812.0897%2C0812.3738%2C0812.5019%2C0812.4300%2C0812.2981%2C0812.1834%2C0812.2386%2C0812.1075%2C0812.1744%2C0812.0455%2C0812.2097%2C0812.2204%2C0812.3196%2C0812.2841%2C0812.0878%2C0812.1468%2C0812.3637%2C0812.0061&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper we study geodesic Ptolemy metric spaces $X$ which allow proper\nand cocompact isometric actions of crystallographic or, more generally, virtual\npolycyclic groups. We show that $X$ is equivariantly rough isometric to a\nEuclidean space."}, "authors": ["Thomas Foertsch", "Viktor Schroeder"], "author_detail": {"name": "Viktor Schroeder"}, "author": "Viktor Schroeder", "arxiv_comment": "20 pages, 1 figure", "links": [{"href": "http://arxiv.org/abs/0812.0672v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0812.0672v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.MG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.MG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "53C20; 53C24", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0812.0672v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0812.0672v1", "journal_reference": null, "doi": null, "fulltext": "Group actions on geodesic Ptolemy spaces\n\narXiv:0812.0672v1 [math.MG] 3 Dec 2008\n\nThomas Foertsch, Viktor Schroeder\u2217\nMay 30, 2018\n\nAbstract\nIn this paper we study geodesic Ptolemy metric spaces X which\nallow proper and cocompact isometric actions of crystallographic or,\nmore generally, virtual polycyclic groups. We show that X is equivariantly rough isometric to a Euclidean space.\n\n1\n\nIntroduction\n\n1.1\n\nStatement of Results\n\nA metric space X is called a Ptolemy metric space, if the inequality\n|xy||uv| \u2264 |xu| |yv| + |xv| |yu|\n\n(1)\n\nis satisfied for all x, y, u, v \u2208 X.\nIn this paper we study subgroups \u0393 \u2282 ISO(X) of the isometry group of\ngeodesic Ptolemy spaces X, which act properly and cocompactly on X. Our\nmotivation to study these spaces is described in Subsection 1.3.\nWe adopt the notation of [BH](p.131) and call an action proper, if for\nevery x \u2208 X there is a number r > 0 such that the set {\u03b3 \u2208 \u0393 | |x \u03b3(x)| < r}\nis finite. An action is cocompact, if there is a compact subset K \u2282 X, such\nthat X = \u0393K. Since X allows a proper and cocompact action by isometries,\nX is complete and, since X is geodesic, it is indeed a proper metric space,\ni.e. closed distance balls are compact (see [BH] p. 132, 8.4(1)).\nThe fact that X is a proper metric space is used essentially in our paper.\nWe recall that a group \u0393 is called crystallographic if, for some n \u2208 N, \u0393\nis isomorphic (as an abstract group) to a discrete, cocompact subgroup of\nthe isometry group ISO(Rn ). The number n is then called the rank of \u0393. A\n\u2217\n\nBoth authors are supported by the Swiss National Science Foundation, grant 200021115919\n\n1\n\n\fmap \u03c6 : X \u2192 Y between metric spaces is called roughly isometric, if there\nexists a constant A \u2265 0 such that for all x, x\u2032 \u2208 X we have\n|xx\u2032 | \u2212 A \u2264 |\u03c6(x)\u03c6(x\u2032 )| \u2264 |xx\u2032 | + A.\n\n(2)\n\nIf, in addition, for all y \u2208 Y there exits x \u2208 X with |y \u03c6(x)| \u2264 A, we call \u03c6\na rough isometry.\nTheorem 1.1. Let X be a geodesic Ptolemy metric space and let \u0393 \u2282\nISO(X) be a crystallographic group of rank n acting properly and cocompactly on X. Then there exists a continuous rough isometry \u03c6 : X \u2192 Rn ,\nwhich is equivariant with respect to the group operation, i.e. \u03c6(\u03b3x) = \u03b3\u03c6(x),\nwhere \u0393 acts on Rn by isometries with compact quotient.\nIn the case that X is a topological manifold we can say more.\nTheorem 1.2. Let X be a geodesic Ptolemy metric space which is in addition a topological manifold. Assume that \u0393 \u2282 ISO(X) is a crystallographic\ngroup of rank n which acts properly and cocompactly on X. Then there\nactually exists an equivariant isometry \u03c6 : X \u2192 Rn .\nThe methods of the proof in connection with the results in [CS] give\nalso the following general structure result for abelian groups operating on\nPtolemy spaces:\nTheorem 1.3. Let X be a geodesic Ptolemy metric space and let \u0393 \u2282\nISO(X) act properly and cocompactly on X. Then every free abelian subgroup of \u0393 is straight in \u0393.\nTo define the notion of straightness we recall the word norm | |\u0393 of a\nfinitely generated group. Let {\u03b31 , . . . , \u03b3k } be a set of generators of \u0393. Then\nfor \u03b3 \u2208 \u0393, |\u03b3|\u0393 is defined as the length of the shortest word in the \u03b3i and \u03b3i\u22121\nrepresenting \u03b3. This norm depends on the choice of generators. However,\nas it is easy to see, different sets of generators give rise to equivalent norms.\nThat is, if | |1\u0393 and | |2\u0393 are such norms, then there exists a constant c \u2265 1 such\nthat (1/c)|\u03b3|1\u0393 \u2264 |\u03b3|2\u0393 \u2264 c|\u03b3|1\u0393 for all \u03b3 \u2208 \u0393. A finitely generated subgroup\n\u03930 \u2282 \u0393 is called straight in \u0393, if | |\u03930 and | |\u0393 are equivalent norms on \u03930 .\nThis notion is independent of the choice of generators on \u03930 and \u0393.\nAs a consequence of Theorem 1.3 we can generalize our result to the\naction of virtual polycyclic groups. A group is called polycyclic, if it admits\na finite chain of subgroups G0 \u2282 G1 \u2282 * * * Gl , such that G0 is the trivial\nsubgroup and Gl = G, such that Gi /Gi\u22121 is cyclic. Equivalently a group is\npolycyclic if it is solvable and every subgroup is finitely generated. A group\nis called virtual polycyclic if it contains a polycyclic subgroup of finite index.\nIn particular crystallographic groups are virtual polycyclic.\n2\n\n\fCorollary 1.4. Theorem 1.1 and Theorem 1.2 hold also if \u0393 \u2282 ISO(X) is\nassumed to be virtual polycyclic. In particular if a virtual polycyclic group\nacts properly and cocompactly on a geodesic Ptolemy space then there exists\na homomorhism \u0393 \u2192 ISO(Rn ) with finite kernel such that the image is a\ncrystallographic group.\nAt the end of the introduction we state a result, which we need in the\nproof and which is of independent interest, see Section 2.\nTheorem 1.5. A proper, geodesic Ptolemy metric space is strictly distance\nconvex.\nIt is a pleasure to thank Alexander Lytchak for many inspiring discussions.\n\n1.2\n\nOutline of the main ideas, Ptolemy versus CAT(0)\n\nAll the above results are well known if the space X is a CAT(0) space.\nA CAT(0)-space is Ptolemy (see [FLS]). It is an open question if proper\nPtolemy metric spaces are CAT(0) (we remark that there are nonlocally\ncompact Ptolemy spaces which are not CAT(0), see [FLS]). To be very\nconcrete, we do not even know, whether the flat strip theorem of CAT(0)spaces (see e.g. [BH] p.182) holds for Ptolemy metric spaces: Assume that\nd is a distance function on the set X = R \u00d7 [0, 1], such that (X, d) is a\ngeodesic Ptolemy space, the topology on (X, d) coincides with the standard\ntopology, the curves t 7\u2192 (t, i) are geodesics parameterized by arclength\nfor i = 0, 1 and d((t, 0), (t, 1)) \u2264 A for some constant A. Question: Is\n(X, d) isometric to a flat strip R \u00d7 [0, D]? We do not know the answer even\nunder the additional assumption that the translation map T : X \u2192 X,\nT (t, s) = (t + 1, s) is an isometry. In the case of CAT(0) spaces the flat strip\ntheorem follows from the fact that the distance function t 7\u2192 d(c(t), c\u2032 (t)) is\nconvex for geodesics c, c\u2032 : [a, b] \u2192 X. We also remark that the convexity of\nthe function t 7\u2192 d(c(t), c\u2032 (t)) is the essential tool to obtain the analogous\nresults of Theorem 1.1 and Theorem 1.2 in the CAT(0)-case. Since we do\nnot have this convexity, our proof in the Ptolemy case is very different.\nWe outline our main ideas: Our proof relies on a weaker form of convexity. In geodesic Ptolemy metric spaces the distance function d(p, .) to a\npoint p \u2208 X is convex. As a consequence also Busemann functions are convex. We show (in the setting of Theorem 1.2) that the Busemann function\nof an axis of an element \u03b1 \u2208 \u0393\u2217 \u2282 \u0393 (where \u0393\u2217 is the maximal abelian subgroup of \u0393) is indeed an affine function. We can show that there are enough\naffine functions to separate points. Thus we can apply the main theorem of\n[HL] to obtain that X is isometric to a convex subset of a normed vector\nspace. Finally we have to use the Theorem of Schoenberg [Sch] to see that\nX is isometric to a Euclidean space. In the setting of Theorem 1.1 we need\nsuitable modifications.\n3\n\n\fWe should mention that the result and parts of its proof have some\nanalogy to the \"Hopf conjecture\" and its proof in [BuI]. Compare in this\ncontext also [Bu] and the discussion in [G],p.43 ff.\n\n1.3\n\nMotivation and outlook\n\nAt the end of this introduction we give an idea why we investigate geodesic\nPtolemy spaces. Our motivation was the study of the boundary of CAT(\u22121)\nspaces. On the ideal boundary \u2202\u221e Y of a CAT(\u22121)-space Y , Bourdon [B]\nintroduced a distance function \u03c1o , depending on a point o \u2208 Y . A similar\nmetric \u03c1\u03c9 on \u2202\u221e Y \\ {\u03c9} was introduced by Hamenst\u00e4dt [Ha], where the\nmetric depends on a point \u03c9 \u2208 \u2202\u221e Y and a Busemann function for this point.\nThe metrics \u03c1o , \u03c1\u03c9 are all M\u00f6bius equivalent. For a detailed description\ncompare [FS].\nLet us describe the elements of M\u00f6bius geometry on metric spaces. Let\nX be a metric space, where |xy| is the distance of x and y. To a quadruple\n(x, y, z, w) \u2208 X 4 \\ D (where D is the diagonal of points where one entry\nappears 3 or 4 times), we associate the cross ratio triple\ncrt(x, y, z, w) = (|xy| |zw| : |xz| |yw| : |xw| |yz|) \u2208 RP 2 .\nSimilar to the classical crossratio there are six reasonable definitions by permuting the entries. A map f : X \u2192 Y is called a M\u00f6bius map, if it is injective and for all quadruples from X 4 \\D we have crt(f (x), f (y), f (z), f (w)) =\ncrt(x, y, z, w). This definition is equivalent to the usual definition using the\nclassical cross ratio. Let \u2206 \u2282 RP 2 be the subset of points (a : b : c),\nsuch that the three numbers |a|, |b|, |c| satisfy the triangle inequality. Then\nX is a Ptolemy metric space, if and only if for all allowed quadruples\ncrt(x, y, z, w) \u2208 \u2206. Therefore the Ptolemy condition is in a natural way\na M\u00f6bius invariant condition. In a certain sense the Ptolemy condition is\nthe natural condition for involutive geometry: note that a metric space X is\nPtolemy if and only if for all points x \u2208 X the map \u03c1x : X\\{x}\u00d7X\\{x} \u2192 R,\n|yz|\n\u03c1x (y, z) = |yx|\n|zx| is a metric (see also [BFW]).\nIn [FS] we made the observation that the Bourdon and Hamenst\u00e4dt\nmetrics on \u2202\u221e Y are Ptolemy for CAT(\u22121)-spaces Y and the isometries of Y\nextend to M\u00f6bius maps on \u2202\u221e Y . In Ptolemy metric spaces one can naturally\ndefine the notion of a circle (in the generalized sense, i.e. a circle or a line).\nRecall that the classical Ptolemy theorem states that four points x, y, z, w\n(in the Euclidean plane or more generally in Rn ) lie on a circle (or a line) if\nand only if crt(x, y, z, w) \u2208 \u2202\u2206, where \u2202\u2206 is the set of points (a : b : c) with\nequality in the triangle inequality. Thus let us define\nDefinition 1.6. Let X be a Ptolemy space. A circle in X is a continuous\nmap f : S 1 \u2192 X, such that for all x, y, z, w \u2208 S 1 we have equality in the\nPtolemy inequality, i.e. crt(f (x), f (y), f (z), f (w)) \u2208 \u2202\u2206.\n4\n\n\fIt then turns out that for points x, y, z, w \u2208 S 1 , which are ordered cyclically on S 1 (i.e. y and w lie in different components of S 1 \\ {x, z}), we\nhave equality of the form |f (x)f (y)| |f (z)f (w)| + |f (y)f (z)| |f (w)f (x)| =\n|f (x)f (z)| |f (w)f (y)|. Note that this notion of a circle is obviously M\u00f6bius\ninvariant and thus circles are preserved by M\u00f6bius maps.\nNow one can reformulate a result of Bourdon (see [B]) in the following\nway: Let Y be a CAT(\u22121)-space and consider \u2202\u221e Y as a Ptolemy space with\nsome Bourdon or Hamenst\u00e4dt metric. Let f : S 1 \u2192 \u2202\u221e Y be a circle, then\nthere exists a totally geodesic subspace Y0 \u2282 Y isometric to H2 , such that\n\u2202\u221e Y0 is the image of f . Indeed the circles in \u2202\u221e Y correspond 1 \u2212 1 to the\nboundaries of isometrically embedded hyperbolic planes in Y .\nThis is one motivation to study Ptolemy spaces with many circles. If we\nlook to our definition of a circle, a circle through infinity should just be a\nproper map f : R \u2192 X such that for all allowed quadruples x, y, z, w \u2208 R\nwe have crt(f (x), f (y), f (z), f (w)) \u2208 \u2202\u2206. For arbitrary but fixed x, y, z\nand w \u2192 \u221e this implies that (|f (x)f (y)| : |f (x)f (z)| : |f (y)f (z)|) \u2208 \u2202\u2206.\nEquivalently, this condition says that f : R \u2192 X is a geodesic line (not\nnecessarily parameterized proportionally to arclength). From this viewpoint\nit is also natural to study Ptolemy spaces with many lines.\n\n2\n\nConvexity\n\nLet X be a metric space. By |xy| we denote the distance between points\nx, y \u2208 X. Unless otherwise stated, we will parameterize geodesics proportionally to arclength. Thus a geodesic in X is a map c : I \u2192 X with\n|c(t)c(s)| = \u03bb|t \u2212 s| for all s, t \u2208 I and some constant \u03bb \u2265 0. A metric space\nis called geodesic if every pair of points can be joined by a geodesic. In the\nsequal X will always denote a geodesic metric space. For x, y \u2208 X we denote\nby m(x, y) = {z \u2208 X | |xz| = |zy| = 12 |xy|} the set of midpoints of x and y.\nA subset C \u2282 X is convex, if for x, y \u2208 C also m(x, y) \u2282 C.\nA function f : X \u2192 R is convex (resp. affine), if for all geodesics\nc : I \u2192 X the map f \u25e6 c : I \u2192 R is convex (resp. affine).\nThe space X is called distance convex if for all p \u2208 X the distance\nfunction dp = | * p| to the point p is convex. It is called strictly distance\nconvex, if the functions t 7\u2192 (dp \u25e6c)(t) are strictly convex whenever c : I \u2192 X\nis a geodesic with |c(t) c(s)| > ||p c(t)|\u2212|p c(s)|| for all s, t \u2208 I. This definition\nis natural, since the restriction of dp to a geodesic segment containing p is\nnever strictly convex. The Ptolemy property easily implies (see [FLS]):\nLemma 2.1. A geodesic, Ptolemy metric space is distance convex.\nAs a consequence, we obtain that for Ptolemy metric spaces local geodesics\nare geodesics. Here we call a map c : I \u2192 X a local geodesic, if for all t \u2208 I\nthere exists a neighborhood t \u2208 I \u2032 \u2282 I, such that c|I \u2032 is a geodesic.\n5\n\n\fLemma 2.2. If X is distance convex, then every local geodesic is globally\nminimizing.\nProof. Assume the contrary, then there is a local geodesic c : [0, b] \u2192 X, such\nthat there exists a \u2208 (0, b) such that for p = c(0) we have |p c(a \u2212 \u03b5)| = a \u2212 \u03b5\nfor all \u03b5 \u2265 0 but |p c(a + \u03b5)| < a + \u03b5 for \u03b5 > 0. The distance convexity\napplied to dp and the minimizing geodesic c|[a\u2212\u03b5,a+\u03b5] implies that |pc(a)| < a,\na contradiction.\nIn [FLS] we gave examples of Ptolemy metric spaces which are not\nstrictly distance convex. However, if the space is proper, then the situation is completely different.\nTheorem 1.5. A proper, geodesic Ptolemy metric space is strictly distance\nconvex.\nBefore we prove this result, we derive some consequences. The first\ncorollary has already been proved in [FLS].\nCorollary 2.3. (see also [FLS]) Let X be a proper, geodesic Ptolemy space.\nThen for x, y \u2208 X there exists a unique midpoint m(x, y) \u2208 X. The midpoint\nfunction m : X \u00d7 X \u2192 X is continuous.\nProof. Assume that there are midpoints m1 , m2 \u2208 m(x, y). Let m be a\nmidpoint of m1 and m2 . If m1 6= m2 , then the strict distance convexity\naccording to Theorem 1.5 implies |xm| < |xmi | = 12 |xy|, and |ym| < |ymi | =\n1\n2 |xy|, which is a contradiction. The uniqueness of the midpoint function\ntogether with the properness easily imply the continuity of m.\nCorollary 2.4. Let X be a proper, geodesic Ptolemy space, and let K \u2282 X\nbe a compact subset. Then there exists a unique closed ball Br (p) of minimal\nradius, such that K \u2282 Br (p).\nProof. The existence of such a ball of minimal radius is clear. We have to\nprove the uniqueness. Assume that K \u2282 Br (p1 ) \u2229 Br (p2 ), with p1 6= p2 .\nLet m be the midpoint of p1 and p2 . If q \u2208 K, then |qpi | \u2264 r and the\nstrict convexity of the distance function implies |qm| < r. By compactness\nK \u2282 Br\u2032 (m) for some r \u2032 < r contradicting the minimality of r.\nCorollary 2.5. Let X be a proper, geodesic Ptolemy space, and A \u2282 X\nbe a closed and convex subset. Then there exists a continuous projection\n\u03c0 : X \u2192 A.\nProof. The strict convexity of the distance function easily implies with a\nsimilar argument as in the proof above, that for given x \u2208 X, there exists a\nunique a \u2208 A, with |ax| minimal. One easily checks that this projection is\ncontinuous.\n6\n\n\fRemark 2.6. For CAT(0) spaces this projection is always 1-Lipschitz. We\ndo not know if \u03c0 is 1-Lipschitz for general proper geodesic Ptolemy spaces.\nThe strict convexity of the distance function together with the properness\nimplies easily\nCorollary 2.7. Let X be a proper, geodesic Ptolemy space and let x, y \u2208 X.\nThen there exists a unique geodesic cxy : [0, 1] \u2192 X from x to y and the map\nX \u00d7 X \u00d7 [0, 1] \u2192 X, (x, y, t) 7\u2192 cxy (t) is continuous.\nAs a consequence X is contractible. Indeed for the choice of a basepoint\no \u2208 X the map \u03c1 : X \u00d7 [0, 1] \u2192 X, \u03c1t (x) = cox (t) is a contraction.\nCorollary 2.8. Let X be a complete, geodesic Ptolemy space. If X is a topological manifold, then every geodesic is extendable. Thus for every geodesic\nsegment c : I \u2192 X there exists a geodesic c\u0304 : R \u2192 X with c\u0304|I = c.\nProof. Let c : I \u2192 X be a geodesic defined on some interval I \u2282 R, which\ncan not be extended. We have to show that I = R. If c is a constant map,\nthen it can be extended trivially. Thus I consists of more than one point\nand c is not a constant geodesic. Since X is complete, we see that I is\n(after obvious reparameterization) of the form [0, a] with a > 0 or of the\nform (\u2212\u221e, a] for some a > 0. In both cases the geodesic c|[0,a] : [0, a] \u2192 X\ncan not be extended over its endpoint c(a), since otherwise also c could be\nextended by Lemma 2.2. Let o = c(0) and x = c(a). The nonextendability of\nc|0,a] implies that for every point y \u2208 X \\ {x}, the point x is not contained in\ncoy ([0, 1]). Thus \u03c1 defines also a retraction \u03c1|X\\{x} : X\\{x}\u00d7[0, 1] \u2192 X\\{x},\nand hence X as well as X \\ {x} are contractible. This is in contradiction to\nthe fact that Hn (X, {x}, Z) = Z, since X is a manifold.\nWe now prove Theorem 1.5. We start with a simple observation.\nLemma 2.9. If \u03b1, \u03b2, a, b are real numbers with \u03b1 + \u03b2, a, b \u2265 0, then\n\u03b1b + \u03b2a \u2265 (\u03b1 + \u03b2) min{a, b} \u2212 |a \u2212 b| min{|\u03b1|, |\u03b2|}.\n\n(3)\n\nProof. We assume without loss of generality, that a \u2264 b. Then b = a + c,\nwhere c = |a \u2212 b| \u2265 0. We compute \u03b1b + \u03b2a = (\u03b1 + \u03b2)a + c\u03b1. If \u03b1 \u2265 0,\nthen our estimate holds trivially. If \u03b1 < 0, then the assumption implies that\n|\u03b1| = min{|\u03b1|, |\u03b2|} and c\u03b1 = \u2212|a \u2212 b| min{|\u03b1|, |\u03b2|}.\nProof of Theorem 1.5: Note that in order to prove Theorem 1.5 it\nsuffices to prove the\nClaim: Let X be a proper, geodesic, Ptolemy metric space. Let further\np, x, y \u2208 X be points with\n|px| \u2212 |py| < |xy|.\n7\n\n(4)\n\n\fThen there exists a midpoint m of x and y such that |pm| < 12 [|px| + |py|].\nIndeed, since a geodesic Ptolemy metric space is distance convex by\nLemma 2.1, the claim implies the uniqueness of midpoints and therefore the\nvalidity of Theorem 1.5.\nIn order to prove the claim, we set\n\u03b7 :=\n\n||px| \u2212 |py||\n.\n|xy|\n\nThus, 0 \u2264 \u03b7 < 1 by assumption (4). Let s := 12 [|px| + |py|] and let \u03c4 :=\nas well as \u03c1 := |py|\ns . Thus, 0 < \u03c4, \u03c1 < 2 and \u03c4 + \u03c1 = 2.\n\n|px|\ns\n\nWe first make the additional assumption that \u03c4 and \u03c1 are very close\ntogether, i.e., both are very close to 1. Namely we assume that\nmin\n\nn1 1o\nmin{\u03c4, \u03c1}\n1\n\u2212 \u03b7\n,\n\u2265 (1 \u2212 \u03b7).\n\u03c4 \u03c1\n\u03c4\u03c1\n2\n\n(5)\n\nClearly this assumption holds for \u03c1 = 1 = \u03c4 (and hence \u03b7 = 0), and at first\nreading one might as well consider this special case. We will now prove the\nclaim under the Assumption (5). Later we will reduce the general case to\nthis special situation.\nChoose geodesics \u03b3px , \u03b3py : [0, s] \u2212\u2192 X connecting p to x and y, parameterized proportionally to arclength. For every t \u2208 [0, s] let \u03c1s\u2212t : [0, 2] \u2212\u2192 X\nbe a geodesic connecting \u03b3px (s \u2212 t) to \u03b3py (s \u2212 t), parameterized proportionally to arclength. Since X is proper, there exists a sequence tn \u2208 (0, s),\ntn \u2212\u2192 0, such that \u03c3s\u2212tn (1) \u2212\u2192 m, where m is some midpoint of x and y.\nThe distance convexity of geodesic, Ptolemy metric spaces implies |pm| \u2264\n1\n2 [|px| + |py|]. To prove our claim, we assume equality and will finally reach\na contradiction.\nThus we assume |pm| = 21 [|px| + |py|] = s.\nWe set\nsn := s \u2212 tn ,\nmn := \u03c3sn (1),\nb\u2212\nn := |xn m|,\na+\nn := |ymn |\n\nxn := \u03b3px (sn ),\nln := |xn yn |,\na\u2212\nn := |yn m|,\nand\n\nn\u2192\u221e\n\nyn := \u03b3py (sn ),\nl := |xy|,\nb+\nn := |xmn |,\n\u03c6n := |mn m|.\n\nSince mn \u2192 m we have \u03c6n \u2212\u2192 0.\nBy simple triangle inequality, the Ptolemy inequality for {p, xn , m, yn } and\nthe sum of the Ptolemy inequalities for {xn , x, m, mn } and {mn , m, y, yn },\n8\n\n\fPSfrag replacements\n\ny\n\n\u03c1tn\nyn\na+\nn\n\n\u03c1sn\n\nl/2\na\u2212\nn\n\nln /2\n\n\u03c6n\n\nm\n\nmn\np\n\n\u2212\nbn\n\nl/2\n\nln /2\n\nb+\nn\n\n\u03c4 sn\n\u03c4 tn\n\nxn\n\nx\n\nFigure 1: The figure visualizes the notation in the proof of Theorem 1.5.\nwe obtain the inequalities\n+ \u2265 l,\na+\nn + bn\n\n(I)\n\n\u2212\n(II) a\u2212\nn \u03c4 sn + bn \u03c1sn \u2265 ln (sn + tn ) as well as\n\u2212\n+ \u2212 \u2264\na+\nn an + bn bn\n\n(III)\n\nlln\n2\n\n+ 2tn \u03c6n .\n\nNow the distance convexity 2.1 yields\nb\u2212\nn \u2264\n\n1\n1\n1\n(\u03c4 tn + |xn y|) \u2264 (\u03c4 tn + \u03c1 tn + ln ) = ln + tn\n2\n2\n2\n\n1\nand similiarly a\u2212\nn \u2264 2 ln + tn . These inequalities together with the triangle\n1\n1\n\u2212\n\u2212\n\u2212\ninequality a\u2212\nn + bn \u2265 ln also yield bn \u2265 2 ln \u2212 tn as well as an \u2265 2 ln \u2212 tn .\nln\nln\n\u2212\n\u2212\nHence we obtain |an \u2212 2 | \u2264 tn and |bn \u2212 2 | \u2264 tn .\nl\nl\n+\nIn the same way, we deduce |a+\nn \u2212 2 | \u2264 tn and |bn \u2212 2 | \u2264 tn .\nThus, passing to appropiate subsequences, we find A\u2212 , B \u2212 , A+ , B + \u2208 (\u22122, 2),\nsuch that\n\na\u2212\nn =\n\nln\n2\n\na+\nn =\n\nl\n2\n\n+\n+\n\nA\u2212\n\u03c4 tn\nA+\n\u03c4 tn\n\n+ o(tn ),\n+ o(tn ),\n\nb\u2212\nn =\n\nln\n2\n\nb+\nn =\n\nl\n2\n\n+\n+\n\nB\u2212\n\u03c1 tn\nB+\n\u03c1 tn\n\n+ o(tn ),\n+ o(tn ),\n\nand\n|\n\nA\u2212\nB\u2212\nA+\nB+\n|, |\n|, |\n|, |\n| \u2264 1.\n\u03c4\n\u03c1\n\u03c4\n\u03c1\n\nThe inequalities (I), (II) and (III) above now yield\n9\n\n(6)\n\n\fA+\n\u03c4\n\n(I \u2032 )\n(II \u2032 )\n(III \u2032 )\n\n+\n\nB+\n\u03c1\n\n\u2265 0,\n\nA\u2212 + B \u2212 \u2265\nA\u2212\n\u03c4\n\n+\n\nA+\n\u03c4\n\n+\n\nB\u2212\n\u03c1\n\n+\n\nB+\n\u03c1\n\nl\ns\n\nas well as\n\n\u2264 0.\n\nBut Lemma 2.9, the inequalities (6), inequality (II \u2032 ), |\u03c4 \u2212 \u03c1| =\ninequality (5) also yield\nA\u2212\nB\u2212\n+\n\u03c4\n\u03c1\n\nl\ns\u03b7\n\nand\n\nn1 1o\nn\no\n1 1\n\u2212\n,\n\u2212\nmin |A\u2212 |, |B \u2212 |\n\u03c4 \u03c1\n\u03c1 \u03c4\nn1 1o\nn o\n|\u03c4 \u2212 \u03c1|\nl\n\u2212\nmin\n,\nmin \u03c4, \u03c1\ns\n\u03c4 \u03c1\n\u03c1\u03c4\nl1\n(1 \u2212 \u03b7) > 0,\ns2\n\n\u2265 (A\u2212 + B \u2212 ) min\n\u2265\n\u2265\n\nwhich contradicts to the simultanious validity of the inequalies (I \u2032 ), and\n(III \u2032 ).\nFinally we have to get rid of the assumption that \u03c1 and \u03c4 are close\n0 | \u2212 |py2 | |\ntogether. Consider some arbitrary p, y0 , y2 with \u03b7 := | |py|y\n< 1. Con0 y2 |\nsider a geodesic [0, 2] \u2192 X, t 7\u2192 yt from y0 to y2 parameterized proportionally to arclength. If |p y1 | < s0 = 12 ( |py0 | + |py2 | ), we are done. Thus we\nassume |p y1 | = s0 which then implies by Lemma 2.1 that t 7\u2192 |p yt | is affine.\nAs a consequence we see that\n| |p y1\u2212t | \u2212 |p y1+t | |\n=\u03b7\n|y1\u2212t y1+t |\nis constant. Thus if we take as a new triple the points p, y1\u2212t , y1+t for some\nt > 0, then the corresponding \u03b7 is the same as for the original triple. Now\nwe can choose t > 0 sufficiently small, such that for y0\u2032 := y1\u2212t , y2\u2032 := y1+t\nand \u03c1\u2032 s0 = |py0\u2032 |, \u03c4 \u2032 s0 = |py2\u2032 | the estimate (5) holds (this is possible, since\n\u03b7 is fixed and \u03c1\u2032 , \u03c4 \u2032 tend to 1 for t \u2192 0). Thus by the above argument,\nthere exists a midpoint y1\u2032 of y0\u2032 and y2\u2032 with |p y1\u2032 | < s0 . Clearly y1\u2032 is also a\nmidpoint of y0 and y2 and we are done.\n\u0003\n\n3\n\nNormed Vector Spaces\n\nWe recall some facts about normed vector spaces which we will use in the\nsequel.\nLet (V, k * k) be a normed vector space. A line in V is a map c : R \u2192 V\nof the form c(t) = a + tb, where b 6= 0. A line is always a geodesic, however\nif the normball is not strictly convex, there are other geodesics. We call\n10\n\n\fa subset C \u2282 V line-convex, if for x, y \u2208 C also the segment [0, 1] \u2192 V ,\nt 7\u2192 ty + (1 \u2212 t)x is contained in C. We use the notion line-convex since\nit differs from the notion of convexity as defined in Section 2 for normed\nspaces with non strictly (line)-convex normball.\nLet \u03b3 \u2208 ISO(V ), then a line c : R \u2192 V parameterized by arclength is\ncalled an axis of \u03b3, if \u03b3c(t) = c(t + L) for some L > 0. If \u03b3 has an axis, then\nwe denote with Ax(\u03b3) \u2282 V the set of points, which lie on axes of \u03b3. Then\nAx(\u03b3) is a closed, line-convex subset of V . If \u03b1 \u2208 ISO(X) commutes with\n\u03b3, then Ax(\u03b3) is \u03b1-invariant.\nEssential for our argument is the following result of Schoenberg [Sch]\nTheorem 3.1. A normed vector space (V, k * k) is a Ptolemy space, if and\nonly if it is an inner product space.\nUsing asymptotic cones, it is not difficult to prove\nLemma 3.2. If a normed vector space is rough isometric to a Ptolemy space,\nthen it is a Ptolemy space.\nTherefore we obtain\nCorollary 3.3. If a normed vector space (V, k * k) is rough isometric to a\nPtolemy space, then it is an inner product space.\n\n4\n\nBusemann functions\n\nIn this section X allways denotes a geodesic Ptolemy space. Let c : [0, \u221e) \u2192\nX be a geodesic ray parameterized by arclength. As usual we define the\nBusemann function bc (x) = limt\u2192\u221e (|xc(t)| \u2212 t). Since bc is the limit of the\nconvex functions dc(t) \u2212 t, it is convex.\nThe following proposition implies that, in a Ptolemy space, rays with\nsublinear distance to each other define (up to a constant) the same Busemann functions.\nProposition 4.1. Let X be a Ptolemy space, let c1 , c2 : [0, \u221e) \u2192 X be rays\nwith Busemann functions bi := bci , and assume limt\u2192\u221e 1t |c1 (t)c2 (t)| = 0.\nThen (b1 \u2212 b2 ) is constant.\nProof. Let p, q \u2208 X and let Pi (t) = |pci (t)|, Qi (t) = |qci (t)|. We define\nPi\u2032 (t), Q\u2032i (t), such that Pi (t) = t + Pi\u2032 (t) and Qi (t) = t + Q\u2032i (t). Hence we\nhave bi (p) = lim Pi\u2032 (t) and bi (q) = lim Q\u2032i (t). Since X is Ptolemy, the three\nnumbers P1 (t)Q2 (t), P2 (t)Q1 (t), |c1 (t)c2 (t)| |pq| satisfy the triangle inequality. The assumption limt\u2192\u221e 1t |c1 (t)c2 (t)| = 0 now implies\n1\n(P1 (t)Q2 (t) \u2212 P2 (t)Q1 (t)) = 0\nt\u2192\u221e t\nlim\n\n11\n\n\fand hence\nlim (P1\u2032 (t) + Q\u20322 (t) \u2212 P2\u2032 (t) \u2212 Q\u20321 (t)) = 0.\n\nt\u2192\u221e\n\nThe last limit implies (b1 \u2212 b2 )(p) = (b1 \u2212 b2 )(q).\n\nLet now c : R \u2192 X be a geodesic line parameterized by arclength. Let\n: [0, \u221e) \u2192 X be the rays c+ (t) = c(t) and c\u2212 (t) = c(\u2212t). Let further\n\u00b1\nb := bc\u00b1 .\nThe following follows easily.\n\nc\u00b1\n\nLemma 4.2. (b+ + b\u2212 ) \u2265 0 and (b+ + b\u2212 ) = 0 on the line c.\nWe now consider these Busemann functions for lines with sublinear distance.\nProposition 4.3. Let c1 , c2 : R \u2192 X be lines with limt\u2192\u221e 1t |c1 (t)c2 (t)| = 0\n\u2212\n+\n\u2212\nand limt\u2192\u221e 1t |c1 (\u2212t)c2 (\u2212t)| = 0. Then (b+\n1 + b1 ) = (b2 + b2 ).\n\u2212\n\u2212\n+\nProof. By Proposition 4.1 we have that (b+\n1 \u2212 b2 ) and (b1 \u2212 b2 ) are constant\n\u2212\n+\n\u2212\n+\nwhich implies that (b1 + b1 \u2212 b2 \u2212 b2 ) = a for some constant a. We show\n\u2212\nthat a = 0. If p1 \u2208 c1 (R), then by Lemma 4.2 (b+\n1 + b1 )(p1 ) = 0 and\n+\n+\n\u2212\n(b2 + b2 )(p1 ) \u2265 0. Thus a \u2264 0. If p2 \u2208 c2 (R), then (b2 + b\u2212\n2 )(p2 ) = 0 and\n+\n\u2212\n(b1 + b1 )(p2 ) \u2265 0. Thus a \u2265 0.\n\n5\n\nGroups operating on X\n\nIn this section X always denotes a geodesic Ptolemy metric space. Let\n\u0393 \u2282 ISO(X) be a subgroup of the isometry group operating properly and\ncocompactly on X. As already stated in the introduction, this implies that\nX is proper and in particular complete. An element \u03b3 \u2208 \u0393 is a torsion\nelement, if \u03b3 m = id for some m \u2265 1. To an element \u03b3 \u2208 \u0393 we associate\nthe displacement function d\u03b3 (x) := |x \u03b3x|. A geodesic line is called an axis\nof an element \u03b3, if there exists some L > 0 such that \u03b3c(t) = c(t + L) for\nall t \u2208 R. We always parametrize lines by arclength. By Ax(\u03b3) := {x \u2208\nX|x lies on an axis of \u03b3} we denote the union of all axes of \u03b3.\nLemma 5.1. (1) d\u03b3 assumes the minimum min d\u03b3 \u2265 0.\n(2) min d\u03b3 = 0 if and only if \u03b3 is a torsion element.\n(3) If \u03b3 is not torsion, then Ax(\u03b3) = {x \u2208 X|d\u03b3 (x) is minimal }.\n(4) If c1 , c2 are axis of \u03b3, then |c1 (t)c2 (t)| is bounded.\n(5) If \u03b1 commutes with \u03b3 and c is an axis of \u03b3, then also \u03b1c is an axis\nof \u03b3.\n12\n\n\fProof. (1) is standard. See e.g. the proof of Lemma 2.1. in [CS].\n(2) If min d\u03b3 = 0, then \u03b3 has a fixed point. Since \u0393 operates properly,\n\u03b3 is a torsion element. If \u03b3 is torsion, then, for given x \u2208 X, the orbit\nK = {\u03b3 m (x)|m \u2208 Z} is a \u03b3-invariant compact set. By Corollary 2.4, there\nexists a unique p \u2208 X, such that K \u2282 Br (p), where r is minimal. Then p is\nfixed by \u03b3, hence min d\u03b3 = 0.\n(3) Let \u03b3 be a nontorsion element. Let L = min d\u03b3 > 0 be the minimum\nof the displacement function. Let x \u2208 X with d\u03b3 (x) = L. Let c : R \u2192\nX be the piecewise geodesic with c(nL) = \u03b3 n (x). Note that c( 2n+1\n2 L) =\n2n+1\n)L)\n=\nc((\n)L)).\nThus\nm(\u03b3 n (x), \u03b3 n+1 (x)) and hence \u03b3c(( 2n\u22121\n2\n2\nd\u03b3 (c((\n\n2n \u2212 1\n2n + 1\n2n \u2212 1\n)L)) \u2264 |c(\nL)c(nL)| + |c(nL)c(\nL)| = L.\n2\n2\n2\n\nBy minimality of L we have equality which implies that c|[ 2n\u22121 L, 2n+1 L] is\n2\n2\nminimizing. Thus since also c|[nL,(n+1)L] is minimizing, c is locally minimizing and hence a geodesic by Lemma 2.2. Thus c is an axis of \u03b3.\nAssume now that c : R \u2192 X is an axis with \u03b3c(t) = c(t + L), L > 0.\nWe show that L = min d\u03b3 . Let therefore x \u2208 X and let a = d(x, c(0)). By\ntriangle inequality\nmL = |c(0)\u03b3 m c(0)| \u2264 |c(0)x| + |x\u03b3 m x| + |\u03b3 m x \u03b3 m c(0)| \u2264 a + m d\u03b3 (x) + a.\nHence mL \u2264 2a + m d\u03b3 (x) for all m, which implies d\u03b3 (x) \u2265 L.\n(4) Since c1 , c2 are axes parameterized by arclength, we have |c1 (t +\nL)c2 (t + L)| = |c1 (t)c2 (t)|.\n(5) If \u03b1 commutes with \u03b3 and \u03b3c(t) = c(t+L), then \u03b3(\u03b1c(t)) = \u03b1(\u03b3c(t)) =\n\u03b1c(t + L), hence also \u03b1 \u25e6 c is an axis of \u03b3.\nLet now \u03b3 be a nontorsion element of \u0393. We define b\u03b3 = bc , where c is\nan axis of \u03b3. Since two axis have bounded distance, b\u03b3 is well defined up\n\u00b1\nto a constant by Proposition 4.3. More generally we define b\u00b1\n\u03b3 = bc and\n+\n\u2212\nB\u03b3 = b\u03b3 + b\u03b3 . Note that B\u03b3 is well defined and does not depend on the\nchoice of an axis by Proposition 4.1.\nLemma 5.2. (1) If \u03b1 commutes with \u03b3, then b\u03b3 (\u03b1(x)) \u2212 b\u03b3 (x) is constant\n(in x).\n(2) b\u03b3 (\u03b3(x)) \u2212 b\u03b3 (x) = min d\u03b3 .\n(3) B\u03b3 = 0 on all axes of \u03b3.\n(4) B\u03b3 \u22121 = B\u03b3 and B\u03b3 (\u03b1(x)) = B\u03b1\u22121 \u03b3\u03b1 (x) for all \u03b1 \u2208 \u0393.\nProof. (1) If \u03b1 commutes with \u03b3 and c : R \u2192 X is an axis of \u03b3, then also\n\u03b1\u22121 \u25e6 c is an axis of \u03b3 and hence in bounded distance to c. Thus b\u03b1\u22121 \u25e6c and\nbc differ by a constant by Proposition 4.1. Since bc (\u03b1x) = b\u03b1\u22121 \u25e6c (x) we otain\nthe result.\n(2) Because of (1) we need to compute the equality only for x = c(0)\nwhere c is an axis of \u03b3. Since \u03b3c(0) = c(L) with L = min d\u03b3 we are done.\n13\n\n\f(3) is merely a reformulation of Lemma 4.2.\n(4) follows from an easy computation.\n\nNow the proof of Theorem 1.3 follows from the arguments in Section III\nof [CS]. The essential tool for the proof in that paper was Corollary 2.6\nwhich corresponds exactly to our Lemma 5.2. One can easily check that the\nproof in the cited paper transfers word by word to the present situation.\n\n6\n\nAffine functions\n\nLet X be a geodesic metric space. Recall that for x, y \u2208 X we denote by\nm(x, y) = {z \u2208 X | d(x, z) = d(z, y) = 21 d(x, y)} the set of midpoints of x\nand y. A map f : X \u2192 Y between two geodesic metric spaces is called\naffine, if for all x, y \u2208 X, we have f (m(x, y)) \u2282 m(f (x), f (y)). Thus a\nmap is affine if and only if it maps geodesics parameterized proportionally\nto arclength into geodesics parameterized proportionally to arclength. An\naffine map f : X \u2192 R is called an affine function. Note that this definition\ncoincides with the definition given in Section 2\nGiven a geodesic metric space X, we set\nA\u2032 (X) := {f : X \u2192 R| f affine and Lipschitz}.\nA\u2032 (X) is a Banachspace, where kf k is the optimal Lipschitz constant. We\nset A(X) := A\u2032 (X)/ \u223c, where f \u223c g if (f \u2212 g) is constant. By [f ] we denote\nthe equivalence class of f . Then also A(X) is a Banachspace, where k[f ]k =\nkf k. The group ISO(X) acts on A\u2032 (X) (and A(X)) by linear isometries via\n\u03b3(f )(x) = f (\u03b3 \u22121 (x)) (resp. \u03b3([f ]) = [\u03b3(f )]). Let A\u2217 (X) be the Banach dual\nspace of A(X) with the norm\nk\u03c1k = sup[f ]\u2208A(X)\n\n|\u03c1([f ])|\n.\nk[f ]k\n\nAlso ISO(X) operates linearly on A\u2217 by isometries via \u03b3(\u03c1)([f ]) = \u03c1(\u03b3 \u22121 ([f ])).\nFor x, y \u2208 X let E(x, y) \u2208 A\u2217 (X) be the evaluation map E(x, y)([f ]) =\nf (x) \u2212 f (y). It follows directly from the definitions that kE(x, y)k \u2264 |xy|.\nFor \u03b3 \u2208 ISO(X) we have kE(\u03b3(x), \u03b3(y))k = kE(x, y)k.\nFor a given basepoint o \u2208 X consider the subset Eo = {E(x, o)|x \u2208 X} \u2282\n\u2217\nA , and the map\nAo : X \u2192 Eo ,\nx 7\u2192 E(x, o).\nIf x, y \u2208 X and z \u2208 m(x, y) then for all [f ] \u2208 A we have\n1\n1\n1\nE(z, o)[f ] = f (z) \u2212 f (o) = (f (x) + f (y)) \u2212 f (o) = ( E(x, o) + E(y, o))[f ].\n2\n2\n2\n14\n\n\fThus Ao is affine and maps the geodesics in X to lines in Eo \u2282 A\u2217 . In\nparticular Eo is a line-convex subset of A\u2217 . Since kE(x, o) \u2212 E(y, o)k =\nkE(x, y)k \u2264 |xy| we see that Ao is 1-Lipschitz.\nWe consider the map ao : ISO(X) \u2192 ISO(Eo ) given by ao (\u03b3)(E(x, o)) :=\nE(\u03b3x, o). Indeed a0 (\u03b3) is an affine isometric operation, since\nkE(\u03b3x, o) \u2212 E(\u03b3y, o)k = kE(\u03b3x, \u03b3y)k = kE(x, y)k = kE(x, o) \u2212 E(y, o)k.\nWith respect to this affine operation the map Ao is ISO(X)-equivariant, i.e.\nAo (\u03b3x) = ao (\u03b3)Ao (x). The isometries ao (\u03b3) map lines in Eo to lines in Eo .\nWe remark that this affine action of ISO(X) on Eo is not the restriction of\nthe linear action of ISO(X) on A\u2217 to the subset Eo .\nWe recollect all this information in the following\nLemma 6.1. If X is a geodesic metric space, then the map Ao : X \u2192 Eo is\na surjective, affine, 1-Lipschitz and ISO(X)-equivariant map of X onto the\nline-convex subset Eo \u2282 A\u2217 .\nDefinition 6.2. We say that affine functions separate points on X, if for\ndifferent x, y \u2208 X there exists f \u2208 A\u2032 (X) with f (x) 6= f (y).\nNote that affine functions separate points if and only if the map Ao is\ninjective. In this case we have the following strong result of Hitzelberger\nand Lytchak [HL].\nTheorem 6.3. If affine functions separate points, then Ao : X \u2192 Eo is an\nisometry.\n\n7\n\nProof of Theorems 1.1, 1.2 and Corollary 1.4\n\nIn this section we assume that X is a geodesic Ptolemy space and \u0393 \u2282\nISO(X) is a crystallographic group operating properly and cocompactly on\nX. Recall that under these assumptions X is proper.\nRecall the following characterization of crystallographic groups, (see [W],\nTheorem 3.2.9).\nA group \u0393 is crystallographic, if and only if \u0393 has a normal, free abelian\nsubgroup \u0393\u2217 of finite rank and finite index in \u0393 which is maximal abelian in\n\u0393. In that case, \u0393\u2217 is unique.\nNote that \u0393\u2217 \u2243 Zn , since \u0393\u2217 is free of finite rank. Since \u0393\u2217 has finite\nindex, \u0393\u2217 also operates cocompactly on X. Let \u03b1 \u2208 \u0393\u2217 \\ id , let c be an axis\n\u00b1\nof \u03b1 and let b\u00b1\n\u03b1 = bc be the corresponding Busemann functions. It follows\n\u2212\n\u2217\n\u2217\nfrom Lemma 5.2 that the function B\u03b1 = b+\n\u03b1 + b\u03b1 is \u0393 invariant. Since \u0393\nacts cocompactly the function B\u03b1 is bounded.\nProof. (of Theorem 1.2) We now assume in addition that X is a manifold.\nThus by Corollary 2.8 all geodesics in X can be extended. Thus the bounded\n15\n\n\fconvex functions B\u03b1 are constant for all \u03b1 \u2208 \u0393\u2217 \\ id. Since B\u03b1 (x) = 0 for a\n\u2212\npoint on an axis of \u03b1, we have that B\u03b1 = 0 on X. Thus B\u03b1 = b+\n\u03b1 + b\u03b1 is in\n\u00b1\nparticular affine, and since the b\u00b1\n\u03b1 are convex, the functions b\u03b1 are actually\naffine.\nSince Ao maps geodesics in X to lines in Eo and since all geodesics are\nextendable, the image Eo is an affine subspace of A\u2217 .\nWe will use the following fact which follows immediately from the cocompactness of \u0393\u2217 : there exists a constant C1 > 0, such that for all p, q \u2208 X\nthere exists \u03b1 \u2208 \u0393\u2217 with |p\u03b1(q)| \u2264 C1 .\nWe now show that the affine functions separate points. Let therefore\nx, y \u2208 X with x 6= y. We first assume that |xy| > 6C1 . Then there exists\n\u03b1 \u2208 \u0393\u2217 \\ id, such that |\u03b1(x)y| \u2264 C1 . There also exists an axis c : R \u2192 X of \u03b1\nsuch that |xc(0)| \u2264 C1 (this follows since for any axis c\u2032 of \u03b1 and any \u03b3 \u2208 \u0393\u2217 ,\nalso \u03b3 \u25e6 c\u2032 is an axis of \u03b1). Consider now the affine function b\u03b1 . Since b\u03b1\nis 1-Lipschitz, we have |b\u03b1 (x) \u2212 b\u03b1 (c(0))| \u2264 C1 , |b\u03b1 (\u03b1c(0)) \u2212 b\u03b1 (\u03b1x)| \u2264 C1 ,\n|b\u03b1 (\u03b1x) \u2212 b\u03b1 (y)| \u2264 C1 , and |b\u03b1 (\u03b1c(0))b\u03b1 (c(0))| = |c(0)\u03b1(c(0))| by Lemma\n5.2 (2). Thus\n|b\u03b1 (x) \u2212 b\u03b1 (y)| \u2265 |c(0)\u03b1(c(0))| \u2212 3C1 \u2265 |xy| \u2212 6C1 > 0,\nwhich shows that x, y are separated by b\u03b1 .\nLet now x, y \u2208 X be arbitrary with x 6= y. Let c : R \u2192 X be the unit\nspeed geodesic with c(0) = x and c(\u03c4 ) = y for \u03c4 = |xy|. Let s > 6C1 and\ny \u2032 = c(s). By the above argument there exists an affine function f , with\nf (x) 6= f (y \u2032 ). Thus the affine function f \u25e6 c is not constant, and hence\nf (x) 6= f (y).\nSince affine functions separate points, the map Ao : X \u2192 Eo is an isometry by the Hitzelberger Lytchak Theorem. Thus Eo is an affine subspace\nof the normed vector space A\u2217 which is in addition a Ptolemy space. By\nSchoenbergs result it is an inner product space and hence isometric to the\nstandard Rn , where n = dim X.\nWe now turn to the proof of Theorem 1.1. We assume that a crystallographic group operates properly and cocompactly on the geodesic Ptolemy\nspace X.\nLet X \u2032 \u2282 X be a nonempty, closed, convex and \u0393-invariant subset, which\nis minimal with respect to these properties. Since \u0393 operates cocompactly\non X, it is easy to show, that such minimal set X \u2032 exists. Namely, consider\nan arbitrary chain {Aj }j\u2208J of such sets. Then this\nT chain is bounded by the\nnonempty, closed, convex and \u0393-invariant set Aj . In order to see that\nthis set is nonempty, just take a compact, fundamental region K of \u0393 and\nconsider the intersections Aj \u2229 K, j \u2208 J. Since K is a T\ncompact fundamental\nregion, and the Aj are \u0393-invariant, it follows that Aj 6= \u2205. Now the\nexistence of a minimal set X \u2032 follows from Zorn's Lemma.\n16\n\n\fBy Corollary 2.5 there exists a continuous projection \u03c0 : X \u2192 X \u2032 . This\nprojection is \u0393-equivariant and since \u0393 operated cocompactly on X as well\nas on X \u2032 , there exists a constant C \u2265 0 such that |x \u03c0(x)| \u2264 C for all x \u2208 X\nand hence \u03c0 is a rough isometry. Thus we have to prove the theorem only\nfor X \u2032 . Thus we can suppose that X satisfies the following additional\nAssumption: If W \u2282 X is a nonempty closed convex and \u0393-invariant\nsubset, then W = X.\nLemma 7.1. For all x \u2208 X and for all \u03b1 \u2208 \u0393\u2217 \\ id we have\n(1) B\u03b1 (x) = 0 and hence the functions b\u00b1\n\u03b1 are affine.\n(2) Ao (x) \u2208 Ax(ao (\u03b1)).\nProof. Let W \u2282 X be the subset of all x \u2208 X such that (1) and (2) hold for\nall \u03b1 \u2208 \u0393\u2217 \\ id. We have to show that W = X.\nSince B\u03b1 is a continuous convex function, the condition (1) is closed and\nconvex. Since Ax(ao (\u03b1)) is a closed line-convex subset and Ao is continuous,\nalso condition (2) is closed and convex. Since \u0393\u2217 is a normal subgroup of \u0393,\n(1) and (2) describe a \u0393-invariant condition. Thus W is closed convex and\n\u0393-invariant.\nWe now show that W is not empty. To prove this, let W \u2032 \u2282 X be a\nnonempty, closed, convex and \u0393\u2217 -invariant subset, which is minimal with\nthese properties. Since \u0393\u2217 operates (as a finite index subgroup of \u0393) cocompactly on X, it follows as above, that such minimal set W \u2032 exists. We\nshow that W \u2032 \u2282 W and hence W is not empty. Let \u03b1 \u2208 \u0393\u2217 \\ id. Since \u0393\u2217\nis abelian, the convex function B\u03b1 is \u0393\u2217 -invariant and hence {B\u03b1 = 0} is\nclosed, convex and \u0393\u2217 -invariant.\nNow the function d\u03b1 assumes a minumum on the subset W \u2032 , hence there\nexists an axis c : R \u2192 W \u2032 of \u03b1.\nThus it follows from Lemma 5.2 (3) that W \u2032 \u2229 {B\u03b1 = 0} =\n6 \u2205. This shows\n\u2032\n\u2032\nthat W \u2282 {B\u03b1 = 0}, since W was assumed to be minimal and {B\u03b1 = 0}\nis closed, convex and \u0393\u2217 -invariant.\nRecall that Ao maps geodesics to lines or to a point. We show that Ao \u25e6c(t) =\nE(c(t), o) is actually a complete line. Since B\u03b1 is constant and hence affine,\n\u00b1\nalso the functions b\u00b1\n\u03b1 are affine. Since b\u03b1 are not constant on c(t), the map\nt 7\u2192 E(c(t), o) is also not constant. It follows that Ao \u25e6 c is a complete line\nwhich is ao (\u03b1)-invariant and hence an axis of ao (\u03b1). Since \u0393\u2217 is abelian, the\nset C := Ax(ao (\u03b1)) \u2282 Eo is closed, line-convex and ao (\u0393\u2217 )-invariant. Hence\n\u2217\n\u2032\n\u22121\nA\u22121\no (C) is closed, convex and \u0393 -invariant. By minimality W \u2282 Ao (C),\n\u2032\nwhich implies that for x \u2208 W , we have Ao (x) \u2208 Ax(ao (\u03b1)). Thus we have\nshown that W \u2032 \u2282 W and hence W 6= \u2205. By the additional assumption\nW = X.\nLemma 7.2. The map Ao : x 7\u2192 E(x, o) is a rough isometry.\nProof. We know already that Ao is 1-Lipschitz.\n17\n\n\fWe use arguments which are very similar to the arguments in the proof of\nTheorem 1.2. Again \u0393\u2217 operates cocompactly on X, and hence there exists\nC1 > 0 such that for all p, q \u2208 X there exists \u03b1 \u2208 \u0393\u2217 with |p\u03b1(q)| \u2264 C1 .\nLet now x, y \u2208 X with |xy| > 6C1 , and choose \u03b1 \u2208 \u0393\u2217 exactly as in the\nproof of Theorem 1.2.\nThen\nkE(x, o)\u2212E(y, o)k = kE(x, yk \u2265 kE(x, y)([b\u03b1 ])k = |b\u03b1 (x)\u2212b\u03b1 (y)| \u2265 |xy|\u22126C1 ,\nwhere the arguments are exactly as above. The claim follows.\nLemma 7.3. Eo is an affine subspace of A\u2217 with dim(Eo ) = rank(\u0393\u2217 ).\nProof. By the above Lemma all ao (\u03b1), \u03b1 \u2208 \u0393\u2217 \\ id operate as translations on\nthe set Eo . Thus the line-convex hull of a0 (\u0393\u2217 )E(x, o) is an affine subspace\nHx \u2282 Eo of dimension equal to rank(\u0393\u2217 ) for all x \u2208 X. Note that all Hx\nare parallel to each other. Since \u0393\u2217 is a finite index normal subgroup of\n\u0393. there are finitely many points x0 , . . . , xk \u2208 X, such that \u0393 leaves the\nset Hxo , . . . , Hxk invariant. The line-convex hull of these subspaces defines\na finite dimensional affine subspace V of A\u2217 , and the group ao (\u0393) leaves\nthis space invariant and operates affinely on V , i.e. maps lines to lines.\nSince ao (\u0393) also maps parallels of Hx to parallels of Hx , ao (\u0393) also operates\naffinely on the quotient space V /Hxo , and has on that space a finite orbit\n[x0 ], . . . , [xk ]. Therefore this operation has a fixed point [v] which is contained in the line-convex hull of [x0 ], . . . , [xk ]. This implies that there exists\nan affine subspace H parallel to Hxo which is ao (\u0393)-invariant and which is\ncontained in the line-convex hull of Hxo , . . . , Hxk . Thus H is in the image\nof Ao .\nLet W = A\u22121\no (H). Then W \u2282 X is a nonempty convex \u0393-invariant\nsubset, and hence W = X by our additional assumption. It follows that\nfor all x \u2208 X, Hx \u2282 H and by dimension reasons Hx = H. It follows that\nEo = H, which proves the Lemma.\nThus we see that Ao : X \u2192 Eo is a \u0393-equivariant rough isometry. By\nLemma 7.3 Eo is a normed vector space which is rough isometric to the\nPtolemy space X. By the Corollary 3.3 to Schoenbergs result, we see that\nEo is an inner product space and hence we obtain Theorem 1.1.\nFinally we prove Corollary 1.4:\nLet \u0393 be a virtual polycyclic group. Let \u03a0 \u2282 \u0393 be a polycyclic subgroup\nof finite index. By a theorem of Hirsch (see e.g. [R] p.139), \u03a0 contains a\ntorsion free solvable subgroup \u03a3 of finite index. Then also \u03a3 operates cocompactly on X and by Theorem 1.3 all abelian subgroups of \u03a3 are straight.\nNote further that all abelian subgroups of \u03a3 are finitely generated, since \u03a0\nis polycyclic. Now a torsion free solvable group, such that all abelian subgroups are finitely generated and straight is a crystallographic group by [CS]\n18\n\n\fLemma 4.3. Thus \u03a3 and hence also \u0393 contains a free abelian subgroup \u03a3\u2217 of\nfinite index and finite rank. It follows that \u0393 has also a normal free abelian\nsubgroup \u0393\u2217 of finite index and finite rank. But this fact is the only property\nof \u0393 which we needed in the proof of Theorems 1.1 and 1.2.\nAt the end we pose an\nOpen Question: Let \u0393 be a crystallographic group operating properly\nand cocompactly on a geodesic Ptolemy space X. Does there exist a totally\ngeodesic flat Euclidean subspace F \u2282 X which is \u0393-invariant?\n\nReferences\n[B]\n\nM. Bourdon, Sur le birapport au bord des CAT(\u22121)-espaces Inst.\nHautes \u00c9tudes Sci. Publ. Math. No. 83 (1996), 95\u2013104.\n\n[BH]\n\nM. Bridson& A. Haefliger, Metric spaces of non-positive curvature Grundlehren der Mathematischen Wissenschaften 319 SpringerVerlag, Berlin, 1999. xxii+643 pp.\n\n[BFW] S.M. Buckley, K. Falk and D.J. Wraith, Ptolemaic and CAT(0),\npreprint\n[Bu]\n\nD. Burago, Periodic Metrics, Adv. Soviet Math. 9 (1992), 205\u2013210.\n\n[BuI]\n\nD. Burago and S. Ivanov, Riemannian tori without conjugate points,\nGAFA 4 no. 3 (1994), 259\u2013269.\n\n[CS]\n\nCh. Croke and V. Schroeder, The fundamental group of compact\nmanifolds without conjugate points, Comment. Math. Helvetici 61\n(1986), 161\u2013175. Free available via http://www.math.ch/swissdml/.\n\n[FLS] Th. Foertsch, A. Lytchak and V. Schroeder, Nonpositive curvature\nand the Ptolemy inequality, Int. Math. Res. Not. IMRN 2007, no. 22,\n15 pp.\n[FS]\n\nTh. Foertsch and V. Schroeder, Hyperbolicity, CAT(\u22121)-spaces and\nthe Ptolemy Inequality, to appear in Math. Annalen.\n\n[G]\n\nM. Gromov, Asymptotic invariants of infinite groups, Geometric\ngroup Theory, Proc. of the Symposium held in Susses 1991, Vol.\n2, edited by A. Niblo and M.Roller, Cambridge Univ. Press 1993\n\n[Ha]\n\nU. Hamenst\u00e4dt, A new description of the Bowen-Margulis measure,\nErgodic Theory Dynam. Systems 9 (1989), 455\u2013464\n\n[HL]\n\nP. Hitzelberger and A. Lytchak, Spaces with many affine functions,\nProc. AMS 135, Number 7 (2007), 2263\u20132271.\n19\n\n\f[R]\n\nD. Robinson, Finiteness conditions and generalized soluble groups,\nPart 2, Springer, Berlin Heidelberg New York, 1972.\n\n[Sch]\n\nI. J. Schoenberg, A remark on M. M. Day's characterization of innerproduct spaces and a conjecture of L. M. Blumenthal, Proc. Amer.\nMath. Soc. 3 (1952), 961\u2013964.\n\n[W]\n\nJ. Wolf, Spaces of constant curvature, McGraw-Hill, New York, 1967.\n\nThomas Foertsch,\nMathematisches Institut,\nUniversit\u00e4t Bonn,\nBeringstr. 1,\nD-53115 Bonn, Deutschland\nfoertsch@math.uni-bonn.de\n\nViktor Schroeder,\nInstitut f\u00fcr Mathematik,\nUniversit\u00e4t Z\u00fcrich,\nWinterthurer Strasse 190,\nCH-8057 Z\u00fcrich, Switzerland\nvschroed@math.unizh.ch\n\n20\n\n\f"}