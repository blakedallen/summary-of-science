{"id": "http://arxiv.org/abs/1104.0272v1", "guidislink": true, "updated": "2011-04-01T22:25:17Z", "updated_parsed": [2011, 4, 1, 22, 25, 17, 4, 91, 0], "published": "2011-04-01T22:25:17Z", "published_parsed": [2011, 4, 1, 22, 25, 17, 4, 91, 0], "title": "Space-time FLAVORS: finite difference, multisymlectic, and\n  pseudospectral integrators for multiscale PDEs", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.3318%2C1104.4906%2C1104.1697%2C1104.0914%2C1104.0129%2C1104.5617%2C1104.4880%2C1104.3933%2C1104.1780%2C1104.3227%2C1104.5324%2C1104.4671%2C1104.5126%2C1104.4175%2C1104.4897%2C1104.0887%2C1104.3493%2C1104.1068%2C1104.1619%2C1104.3355%2C1104.1783%2C1104.3252%2C1104.3048%2C1104.4447%2C1104.2257%2C1104.4085%2C1104.1071%2C1104.2204%2C1104.3126%2C1104.3149%2C1104.1741%2C1104.0120%2C1104.3526%2C1104.4450%2C1104.0734%2C1104.0575%2C1104.0464%2C1104.5080%2C1104.2129%2C1104.5105%2C1104.3031%2C1104.5447%2C1104.0944%2C1104.4351%2C1104.5327%2C1104.0287%2C1104.3600%2C1104.1898%2C1104.5488%2C1104.4980%2C1104.0205%2C1104.2028%2C1104.4057%2C1104.4825%2C1104.0473%2C1104.1608%2C1104.5490%2C1104.1027%2C1104.1766%2C1104.1342%2C1104.1103%2C1104.3084%2C1104.5633%2C1104.1617%2C1104.1462%2C1104.1922%2C1104.3166%2C1104.2074%2C1104.4448%2C1104.0555%2C1104.4225%2C1104.5333%2C1104.5698%2C1104.5470%2C1104.4410%2C1104.1317%2C1104.0261%2C1104.4660%2C1104.4574%2C1104.0350%2C1104.0594%2C1104.0799%2C1104.2878%2C1104.4366%2C1104.0126%2C1104.0272%2C1104.1611%2C1104.2447%2C1104.4498%2C1104.0177%2C1104.3462%2C1104.5646%2C1104.5078%2C1104.2386%2C1104.3687%2C1104.2098%2C1104.4991%2C1104.3661%2C1104.2245%2C1104.3402%2C1104.4976&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Space-time FLAVORS: finite difference, multisymlectic, and\n  pseudospectral integrators for multiscale PDEs"}, "summary": "We present a new class of integrators for stiff PDEs. These integrators are\ngeneralizations of FLow AVeraging integratORS (FLAVORS) for stiff ODEs and SDEs\nintroduced in [Tao, Owhadi and Marsden 2010] with the following properties: (i)\nMultiscale: they are based on flow averaging and have a computational cost\ndetermined by mesoscopic steps in space and time instead of microscopic steps\nin space and time; (ii) Versatile: the method is based on averaging the flows\nof the given PDEs (which may have hidden slow and fast processes). This\nbypasses the need for identifying explicitly (or numerically) the slow\nvariables or reduced effective PDEs; (iii) Nonintrusive: A pre-existing\nnumerical scheme resolving the microscopic time scale can be used as a black\nbox and easily turned into one of the integrators in this paper by turning the\nlarge coefficients on over a microscopic timescale and off during a mesoscopic\ntimescale; (iv) Convergent over two scales: strongly over slow processes and in\nthe sense of measures over fast ones; (v) Structure-preserving: for stiff\nHamiltonian PDEs (possibly on manifolds), they can be made to be\nmulti-symplectic, symmetry-preserving (symmetries are group actions that leave\nthe system invariant) in all variables and variational.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.3318%2C1104.4906%2C1104.1697%2C1104.0914%2C1104.0129%2C1104.5617%2C1104.4880%2C1104.3933%2C1104.1780%2C1104.3227%2C1104.5324%2C1104.4671%2C1104.5126%2C1104.4175%2C1104.4897%2C1104.0887%2C1104.3493%2C1104.1068%2C1104.1619%2C1104.3355%2C1104.1783%2C1104.3252%2C1104.3048%2C1104.4447%2C1104.2257%2C1104.4085%2C1104.1071%2C1104.2204%2C1104.3126%2C1104.3149%2C1104.1741%2C1104.0120%2C1104.3526%2C1104.4450%2C1104.0734%2C1104.0575%2C1104.0464%2C1104.5080%2C1104.2129%2C1104.5105%2C1104.3031%2C1104.5447%2C1104.0944%2C1104.4351%2C1104.5327%2C1104.0287%2C1104.3600%2C1104.1898%2C1104.5488%2C1104.4980%2C1104.0205%2C1104.2028%2C1104.4057%2C1104.4825%2C1104.0473%2C1104.1608%2C1104.5490%2C1104.1027%2C1104.1766%2C1104.1342%2C1104.1103%2C1104.3084%2C1104.5633%2C1104.1617%2C1104.1462%2C1104.1922%2C1104.3166%2C1104.2074%2C1104.4448%2C1104.0555%2C1104.4225%2C1104.5333%2C1104.5698%2C1104.5470%2C1104.4410%2C1104.1317%2C1104.0261%2C1104.4660%2C1104.4574%2C1104.0350%2C1104.0594%2C1104.0799%2C1104.2878%2C1104.4366%2C1104.0126%2C1104.0272%2C1104.1611%2C1104.2447%2C1104.4498%2C1104.0177%2C1104.3462%2C1104.5646%2C1104.5078%2C1104.2386%2C1104.3687%2C1104.2098%2C1104.4991%2C1104.3661%2C1104.2245%2C1104.3402%2C1104.4976&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a new class of integrators for stiff PDEs. These integrators are\ngeneralizations of FLow AVeraging integratORS (FLAVORS) for stiff ODEs and SDEs\nintroduced in [Tao, Owhadi and Marsden 2010] with the following properties: (i)\nMultiscale: they are based on flow averaging and have a computational cost\ndetermined by mesoscopic steps in space and time instead of microscopic steps\nin space and time; (ii) Versatile: the method is based on averaging the flows\nof the given PDEs (which may have hidden slow and fast processes). This\nbypasses the need for identifying explicitly (or numerically) the slow\nvariables or reduced effective PDEs; (iii) Nonintrusive: A pre-existing\nnumerical scheme resolving the microscopic time scale can be used as a black\nbox and easily turned into one of the integrators in this paper by turning the\nlarge coefficients on over a microscopic timescale and off during a mesoscopic\ntimescale; (iv) Convergent over two scales: strongly over slow processes and in\nthe sense of measures over fast ones; (v) Structure-preserving: for stiff\nHamiltonian PDEs (possibly on manifolds), they can be made to be\nmulti-symplectic, symmetry-preserving (symmetries are group actions that leave\nthe system invariant) in all variables and variational."}, "authors": ["Molei Tao", "Houman Owhadi", "Jerrold E. Marsden"], "author_detail": {"name": "Jerrold E. Marsden"}, "author": "Jerrold E. Marsden", "links": [{"href": "http://arxiv.org/abs/1104.0272v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1104.0272v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1104.0272v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1104.0272v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "Space-time FLAVORS: finite difference, multisymlectic, and\npseudospectral integrators for multiscale PDEs\nMolei Tao, Houman Owhadi, Jerrold E. Marsden\n\narXiv:1104.0272v1 [math.NA] 1 Apr 2011\n\nOctober 23, 2018\n\nAbstract\nWe present a new class of integrators for stiff PDEs. These integrators are\ngeneralizations of FLow AVeraging integratORS (FLAVORS) for stiff ODEs and\nSDEs introduced in [32] with the following properties: (i) Multiscale: they are based\non flow averaging and have a computational cost determined by mesoscopic steps\nin space and time instead of microscopic steps in space and time; (ii) Versatile:\nthe method is based on averaging the flows of the given PDEs (which may have\nhidden slow and fast processes). This bypasses the need for identifying explicitly\n(or numerically) the slow variables or reduced effective PDEs; (iii) Nonintrusive: A\npre-existing numerical scheme resolving the microscopic time scale can be used as\na black box and easily turned into one of the integrators in this paper by turning\nthe large coefficients on over a microscopic timescale and off during a mesoscopic\ntimescale; (iv) Convergent over two scales: strongly over slow processes and in the\nsense of measures over fast ones; (v) Structure-preserving: for stiff Hamiltonian\nPDEs (possibly on manifolds), they can be made to be multi-symplectic, symmetrypreserving (symmetries are group actions that leave the system invariant) in all\nvariables and variational.\n\n1\n\nIntroduction\n\nMulti-scale PDEs can be divided into two (possibly over-lapping) categories: PDEs\nwith highly oscillating or rough coefficients and PDEs with large (or stiff) coefficients.\nClassical numerical methods are usually: (i) stable but arbitrarily inaccurate for the\nformer category (consider, for instance, a finite element method for the elliptic operator \u2212 div(a\u2207) with a rapidly changing coefficient a \u2208 L\u221e ), or (ii) unstable for the\nlatter category. Accurate numerical methods for the former category, called numerical\nhomogenization methods, are, in absence of local ergodicity or scale separation, based\non the compactness of the solution space (we refer, for instance, to [26, 2, 27]). Numerical methods for the latter category are, in essence, based on the existence of slow and\nfast variables (or components) [14]. When fast variables converge toward Dirac (single\npoint) distributions, asymptotic-preserving schemes [15] allow for simulations with large\ntime steps. We also refer to [18, 25] for multi-scale transport equations and hyperbolic\nsystems of conservation laws with stiff diffusive relaxation. Well-identified slow variables\n1\n\n\fcan be simulated with large time-steps using the two-scale structure of the original stiff\nPDEs (we refer to [1] and [12] for existing examples; slow variables satisfy a non-stiff\nPDE that can be identified in analogy to equations (A.9) and (A.13) of [32]; we also\nrefer to [14] for a definition of slow variables).\nIn this paper, we consider the second category of PDEs and propose a generalization of FLow AVeraging integratORS (FLAVORS) (introduced in [32] for stiff ODEs\nand SDEs) to stiff PDEs. Multi-scale integrators for stiff PDEs are obtained without\nthe identification of slow variables by turning on and off stiff coefficients in single-step\n(legacy) integrators (used as black boxes) and alternating microscopic and mesoscopic\ntime steps (Subsection 2.2). We illustrate the generality of the proposed strategy by applying it to finite difference methods in Section 2, multi-symplectic integrators in Section\n3, and pseudospectral methods in Section 4 (although we have not done so in this paper,\nthe proposed strategy can also be applied to finite element methods or finite volume\nmethods). The convergence of the proposed strategy, after semi-discretization in space,\nis analyzed in Subsection 5.1, where a non-asymptotic error bound indicates the twoscale convergence ([32], i.e., strong with respect to hidden slow variables and weak with\nrespect to hidden fast variables) of PDE-FLAVORS. As illustrated by numerical (Figure\n2) and theoretical results (Section 5), an explicit tuning ((h/\u000f)2 \u001c H \u001c h/\u000f) between\nmicroscopic h and mesoscopic (H) time-steps and the stiff parameter 1/\u000f is necessary\nand sufficient for convergence. We also show in Section 6 that applying the FLAVOR\nstrategy to characteristics leads to accurate approximations of solutions of stiff PDEs.\nThese results, along with those of [32], diverge from the concept that, in situations\nwhere the slow variables are not linear functions of the original variables, multiscale\nalgorithms \"do not work\" \"if the slow variables are not explicitly identified and made\nuse of \" (page 2 of [13]).\n\n2\n2.1\n\nFinite difference and space-time FLAVOR mesh\nSingle-scale method and limitation\n\nConsider a multiscale PDE:\nF (1, \u000f\u22121 , x, t, u(x, t), ux (x, t), ut (x, t), uxx (x, t), uxt (x, t), utt (x, t), . . .) = 0\n\n(1)\n\nwhere F is a given function (possibly nonlinear), \u000f is a small positive real parameter and\nx and t are spatial and temporal coordinates.\nTo obtain a numerical solution of (1), the simplest single-scale finite difference approach employs a uniform rectangular mesh with time step length h and space step length\nk, and approximates the solution u at its values at discrete grid points. Differential operators will be approximated by finite differences; for instance, according to forward space\nforward time rules: ux (ik, jh) \u2248 (ui+1,j \u2212ui,j )/k and ut (ik, jh) \u2248 (ui,j+1 \u2212ui,j )/h, where\nuij is the numerical solution at discrete grid point with space index i and time index\nj. After this discretization, the original PDE is approximated by a finite dimensional\nalgebraic system, which can be solved to yield the numerical solution.\n2\n\n\fOf course, a necessary condition for obtaining stability and accuracy in the numerical\nsolution is that h and k have to be small enough. A quantitative statement on how\nsmall they need to be will depend on the specific PDE and discretization. For 1D\nlinear advection equations ux \u2212 aut = 0 and forward time forward space discretizations,\nthe h < k/a CFL condition [11] has to be met to ensure stability, which is also a\nneccessary condition for accuracy [19]. Intuitively, the CFL condition guarantees that\ninformation does not propagate faster than what the numerical integrator can handle.\nThe Von Neumann stability analysis [9] helps determine analogous CFL conditions for\nlinear equations with arbitrary discretizations. The stability of numerical schemes for\ngeneral nonlinear equations remains a topic of study. We refer to [31] for additional\ndiscussions on single-scale finite difference schemes. In general, the presence of a stiff\ncoefficient \u000f\u22121 in equation (1) requires h and k to scale with \u000f in order to guarantee the\nstability of numerical integration schemes. This makes the numerical approximation of\nthe solution of (1) computationally untractable when \u000f is close to 0.\n\n2.2\n\nMultiscale FLAVORization and general methodology\n\nFLAVORs are multiscale in the sense that they accelerate computation by adopting\nboth larger time and space steps. A finite difference scheme can be FLAVORized by\nemploying two rules:\n\nFigure 1: Mesh used by FLAVORS. A uniform mesoscopic space step is used and two alternating small\nand mesoscopic time steps are used. Stiffness is turned on in red regions and turned off otherwise.\n\n3\n\n\fFirst, instead of a uniform mesh, use a mesh as depicted in Figure 1, in which a\nuniform spatial grid corresponds to a mesoscopic space step K that does not scale with\n\u000f, and an alternating temporal grid corresponds to two time steps, microscopic h (scaling\nwith \u000f) and mesoscopic H \u2212h (H independent from \u000f). It is worth mentioning that when\nusing this non-uniform mesh, grid sizes have to be taken into consideration when derivatives are approximated by finite differences. 1st-order derivatives are straightforward to\nobtain, and we refer to Section 3 for approximations of higher order derivatives.\nSecond, the stiff parameter \u000f\u22121 should be temporarily set to be 0 (i.e., turned off)\nwhen the current time step is the mesoscopic H \u2212 h; if the small time step h is used\ninstead, the large value of \u000f\u22121 needs to be restored, or in other words, stiffness should\nbe turned on again.\nThe rule of thumb is that k and h should be chosen such that the integration of (1)\nwith these step sizes and stiffness turned on is stable and accurate. On the other hand,\nthere is another pair of step size values such that the same integration with stiffness\nturned off is stable and accurate, and K and H should be chosen to be an order of\nmagnitude smaller than these values. FLAVORS does not require a microscopic k, but\nonly a mesoscopic space-step K, a microscopic time-step h, and a mesoscopic time-step\nH.\nThe intuition is as follows: adopt the point of view of semi-discrete approach for\nPDE integration, in which space is discretized first and the PDE is approximated by a\nsystem of ODEs. The integration (in the time) of the resulting finite dimensional ODE\nsystem can be accelerated by applying the FLAVOR strategy to any legacy scheme\n(used as a black box). Turning on and off stiff coefficients in the legacy scheme and\nalternating microscopic time steps (stiffness on) with mesoscopic time steps (stiffness\non) preserves the symmetries of that scheme and at the same time induces an averaging\nof the dynamic of (possibly hidden) slow variables with respect to the fast ones. With\nthis strategy, the FLAVORized scheme advances in mesoscopic time steps without losing\nstability. The (possibly hidden) slow dynamic is captured in a strong sense, while the fast\none is captured only in the (weak) sense of measures. A rigorous proof of convergence\nof the proposed method relies on the assumption of existence of (possibly hidden) slow\nvariables and of local ergodicity of (possibly hidden) fast variables (we refer to Section 5).\nIt is important to observe that the proposed method does not require the identification\nof slow variables.\n\n2.3\n\nExample: conservation law with Ginzburg-Landau source\n\nConsider a specific stiff PDE:\nut + f (u)x = \u000f\u22121 u(1 \u2212 u2 )\n\n(2)\n\nin which f (u) = sin u and 0 < \u000f \u001c 1. Use the boundary condition of u(x = 0, t) =\nu(x = L, t) and the initial condition of u(x, t = 0) = sin(\u03c0x). This system contains two\nscales: the fast process corresponds to u quickly converging towards 1 or \u22121, and the\nslow process corresponds to the front (with steep gradients) separating u > 0 from u < 0\npropagating at an O(1) velocity.\n4\n\n\fWe will FLAVORize the following Lax-Friedrichs finite difference scheme:\n\u0010\n\u0011\n(\nu\n\u2212u\nui+1,j+1 = \u016bi+1,j \u2212 h fu (\u016bi+1,j ) i+2,j2k i,j + \u000f\u22121 \u016bi+1,j (1 \u2212 \u016b2i+1,j )\n\u016bi+1,j\n\n,\n\nui+2,j +ui,j\n2\n\n(3)\n\nwhere ui,j = ui+L/k,j and ui,1 = sin (\u03c0(i \u2212 1)k). If the domain of integration is restricted\nto [0, L]\u00d7[0, T ], then i = 1, 2, . . . , bL/kc+1, and j = 1, 2, . . . , bT /hc+1. We use h = 0.1\u000f\nand k = 0.2\u000f for our purposes, both of which we found numerically at the order of the\nstability limit. In our experiment, we chose \u000f = 2 * 10\u22123 , and therefore h = 0.0002 and\nk = 0.0004.\nThe FLAVORized version of this scheme is:\n\u0010\n\u0011\n\uf8f1\nui+2,j \u2212ui,j\n\u22121 \u016b\n2\n\uf8f4\n\u0169\n=\n\u016b\n\u2212\nh\nf\n(\u016b\n)\n+\n\u000f\n(1\n\u2212\n\u016b\n)\ni+1,j\ni+1,j\nu\ni+1,j\ni+1,j\n\uf8f4\ni+1,j\n2K\n\uf8f2\n(4)\n\u016bi+1,j\n, (ui+2,j + ui,j )/2\n\u0010\n\u0011\n\uf8f4\n\uf8f4\n\u0169i+2,j +\u0169i,j\n\u0169i+2,j +\u0169i,j \u0169i+2,j \u2212\u0169i,j\n\uf8f3u\n=\n\u2212 (H \u2212 h) f (\n)\ni+1,j+1\n\nu\n\n2\n\n2\n\n2K\n\nwhere ui,j = ui+L/K,j and ui,1 = sin (\u03c0(i \u2212 1)K). If the domain of integration is restricted to [0, L] \u00d7 [0, T ], then i = 1, 2, . . . , bL/Kc + 1, and j = 1, 2, . . . , bT /Hc + 1. We\nuse the same h as before, and choose H = 0.005 and K = 0.01, which ensures that the\nstability of the integration remains independent of \u000f.\nErrors of FLAVOR based on Lax-Friedrichs with different H and h values are computed by comparing the results to a benchmark Lax-Friedrichs integration with fine steps\nh = 0.1\u000f and k = 0.2\u000f. More precisely, we calculated the distance between two vectors\nrespectively corresponding to FLAVOR and Lax-Friedrichs integrations, which contain\nordered u(x, t) values on the intersection of FLAVOR and Lax-Friedrichs meshes (which\nis in fact the FLAVOR mesh as long as H is a multiple of 0.1\u000f). 1-norm is used and\nnormalized by the number of discrete points to mimic the L1 norm for the continuous\nsolution. Experimental settings are \u000f = 2 * 10\u22123 , L = 2 and T = 2. As we can see\nin Figure 2, FLAVOR is indeed uniformly convergent in the sense that the error scales\nwith H, as long as h takes an appropriate value. This is not surprising, because we have\nalready proven in the ODE case that the error is bounded by a function of H (uniformly\n\u00012\nin \u000f) as long as h\u000f \u001c H \u001c h/\u000f, and this error can be made arbitrarily small as H \u2193 0\n(notice H can still be much larger than \u000f as \u000f \u2193 0).\nAlso, a typical run of FLAVOR (H = 0.005 and K = 0.01) in comparison to the\nbenchmark (h = 0.0002 and k = 0.0004) is shown in Figure 3. FLAVOR captured\nthe slow process strongly in the sense that it obtained the correct speeds of both steep\ngradients' propagations (up to arithmetic error and fringing). In this setting, FLAVOR\nachieves a HK\n2hk = 312.5 fold acceleration. It is worth restating that both spatial and\ntemporal step lengths of FLAVOR are mesocopic, whereas the counterparts in a single\nscale finite difference method have to be both microscopic for stability. The computational gain by FLAVOR will go to infinity as \u000f \u2192 0, and this statement will be true for\nall FLAVOR examples shown in this paper.\n\n5\n\n\fL1 distance between ux,t by FLAVOR and benchmark\n\n1\n0.8\n\nerror\n\n0.6\n0.4\n0.2\n0\n0.01\n0.008\n\n2\n0.006\n\n1.5\n0.004\n\n1\n0.002\n\n0.5\n0\n\nH\n\n0\nh/\u03b5\n\nFigure 2: Errors of FLAVOR based on Lax-Friedrichs as a function of H and h. H samples multiples\nof 0.1\u000f, starting from 2x to 50x with 1x increment, and h ranges from 0.01\u000f to 3\u000f with 0.01\u000f increment.\nErrors with magnitude bigger than 1 are not plotted, for they indicate unstable integrations.\n\n3\n3.1\n\nMultisymplectic integrator for Hamiltonian PDEs\nSingle-scale method\n\nWe refer to [7, 21, 22] for a discussion on the geometry of Hamiltonian PDEs (e.g.,\nmulti-symplectic structure). We will now recall the Euclidean coordinate form of a\nHamiltonian PDE:\nMzt + Kzx = \u2207z H(z)\n(5)\nwhere z(x, t) is a n-dimensional vector, M and K are arbitrary skew-symmetric matrices\non Rn , and H : Rn \u2192 R is an arbitrary smooth function. The solution preserves the\nmulti-symplectic structure in the following sense:\n\u2202t \u03b9(U, V ) + \u2202x \u03ba(U, V ) = 0\n\n(6)\n\nwhere \u03b9 and \u03ba are differential 2-forms defined by\n\u03b9(x, y) = hMx, yi and \u03ba(x, y) = hKx, yi\n\n6\n\n(7)\n\n\fFLAVOR\n\n1\n\n1\n\n0.5\n\n0.5\nu(x,t)\n\nu(x,t)\n\nSingle scale finite difference\n\n0\n\n0\n\n\u22120.5\n\n\u22120.5\n\n\u22121\n2\n\n\u22121\n2\n2\n\n1.5\n\n1.5\n\n1\n\n1\n\n0.5\nx\n\n2\n\n1.5\n\n1.5\n\n1\n\n0.5\n\n0.5\n0\n\n0\n\n1\n\nx\n\nt\n\n0.5\n0\n\n0\n\nt\n\nFigure 3: Numerical solutions to (2) by Lax-Friedrichs (left, Eq. 3) and its FLAVORization (right,\nEq. 4).\n\nand U and V are two arbitrary solutions to the variational equation (the solution is\nidentified with dz : R2 7\u2192 Rn ):\nMdzt + Kdzx = Dzz H(z)dz,\n\ndz(x, t) \u2208 Rn\n\n(8)\n\nPreservation of multi-symplecticity can be partially and intuitively interpreted as a conservation of infinitesimal volume in the jet bundle, which generalizes the conservation of\nphase space volume in Hamiltonian ODE settings to field theories.\nA broad spectrum of PDEs fall in the class of Hamiltonian PDEs, including generalized KdV, nonlinear Schr\u00f6dinger models, nonlinear wave equations, atmospheric flows,\nfluid-structure interactions, etc. [4, 3, 6, 7]. We also refer to [8] and references therein\nfor surveys on numerical recipes, and to [20] for an application to numerical nonlinear\nelastodynamics.\nHamiltonian PDEs (5) can be viewed as Euler-Lagrange equations for field theories,\nwhich are obtained by applying Hamilton's principle (i.e., a variational principle of\n\u03b4S/\u03b4z = 0) to the following action:\nZZ\nS(z(*, *)) =\nL(z, zt , zx ) dt dx\n(9)\nwhere the Lagrangian density is given by\n1\n1\nL(z, zt , zx ) = hMzt , zi + hKzx , zi \u2212 H(z)\n2\n2\n\n(10)\n\nThis variational view of Hamiltonian PDEs will intrinsically guarantee the preservation of multi-symplecticity, and there will be a field generalization of Noether's theorem,\nwhich ensures conservation of momentum maps corresponding to symmetries.\nNumerically, instead of discretizing the equations (5), we prefer the approach of variational integrators because they are intrinsically multi-symplectic and therefore structurepreserving [21, 22, 23, 20]. These integrators are obtained as follows: first discretize the\n7\n\n\faction (9) using quadratures, then apply variational principle to the discrete action\n(which depends on finitely many arguments), and finally, solve the algebraic system\nobtained from the variational principle, i.e., the discrete Euler-Lagrange equations.\nFor an illustration, consider a nonlinear wave equation:\nutt \u2212 uxx = V 0 (u)\n\n(11)\n\nwith periodic boundary condition u(x + L, t) = u(x, t) and compatible initial conditions\nu(x, t = 0) = f (x) and ut (x, t = 0) = g(x). Suppose we are interested in the solution in\na domain [0, L] \u00d7 [0, T ].\nRewrite the high order PDE as a system of first order PDEs (notice these covariant\nequations can be obtained through an intrinsic procedure, which works on manifolds as\nwell [5]):\nvt \u2212 wx = V 0 (u)\n\n(12)\n\nut = v\n\n(13)\n\nux = w\n\n(14)\n\nThe corresponding Lagrangian density is:\n1\n1\nL = u2t \u2212 u2x + V (u)\n2\n2\n\n(15)\n\nUsing a forward time forward space approximation, we obtain the following discrete\nLagrangian:\n#\n\" \u0012\n\u00132\n\u0012\n\u00132\nu\n\u2212\nu\nu\n\u2212\nu\n1\n1\ni,j+1\ni,j\ni+1,j\ni,j\n\u2212\n+ V (ui,j )\n(16)\nLdi,j , hij kij\n2\nhij\n2\nkij\n\u0014\n\u0015\nZ tj+1 =tj +hij Z xi+1 =xi +kij\n1 2 1 2\n\u2248\nu \u2212 u + V (u)\n(17)\ndx\ndt\n2 t 2 x\nxi\ntj\nwhere space step kij and time step hij define a rectangular grid of size kij \u00d7 hij . The\nsimplest single-scale choice would be kij = k and hij = h for some k and h.\nAs a consequence, the continuous action S is approximated by a discrete action:\nSd =\n\nN X\nM\nX\n\nLd\u03b1,\u03b2 \u2248 S =\n\nZZ\nL dt dx\n\n(18)\n\n\u03b1=1 \u03b2=1\n\nand Hamilton's principle of least action \u03b4Sd = 0 gives\nN M\n\u2202 XX d\nL\u03b1,\u03b2 = 0\n\u2202ui,j\n\n(19)\n\n\u03b1=1 \u03b2=1\n\nfor 1 \u2264 i \u2264 N and 1 \u2264 j \u2264 M , where N and M are such that\nP\nand M\n\u03b2=1 h\u03b1\u03b2 = T for any \u03b1.\n8\n\nPN\n\n\u03b1=1 k\u03b1\u03b2\n\n= L for any \u03b2\n\n\fTaking derivative with respect to ui,j , we obtain the following discrete Euler-Lagrange\nequations:\nui,j \u2212 ui,j+1\nui,j \u2212 ui+1,j\nui,j \u2212 ui,j\u22121\nui,j \u2212 ui\u22121,j\n\u2212uij\n+hij kij V 0 (ui,j )+ki,j\u22121\n\u2212hi\u22121,j\n=0\nhij\nkij\nhi,j\u22121\nki\u22121,j\n(20)\nThe system of above equations is explicitly solvable when equipped with boundary\nconditions and initial conditions; for instance, below is a consistent discretization of the\ncontinuous version:\n\uf8f1\nu = ui+N,j\n\u2200i, j\n\uf8f4\n\uf8f4\n\u0010P ,\n\u0011\n\uf8f2 i,j\ni\nui,1 = f\n\u2200i\n(21)\n\u03b1=1 k\u03b11 ,\n\u0011\n\u0010P\n\uf8f4\n\uf8f4\ni\n\uf8f3u = u + h g\nk\n, \u2200i\n\nkij\n\ni,2\n\ni,1\n\ni1\n\n\u03b1=1\n\n\u03b12\n\nThis numerical receipt is convergent. In fact, multi-symplectic integrators obtained\nfrom variational principles can be viewed as special members of finite difference methods,\nwhose error analysis is classical.\nWe wish to point out that the above procedure works for any Hamiltonian PDEs\nof form (5). Also, notice that high-order derivatives are dealt with in an intrinsic way\nregardless of whether mesh is uniform.\n\n3.2\n\nFLAVORization of multi-symplectic integrators\n\nNow consider a multiscale Hamiltonian PDE\nM(1, \u000f\u22121 )zt + K(1, \u000f\u22121 )zx = \u2207z H(1, \u000f\u22121 , z)\n\n(22)\n\nAny single-scale multi-symplectic integrator can be FLAVORized (to achieve computational acceleration) by using the following strategy: (i) Use the two-scale mesh\nillustrated in Figure 1, and (ii) Turn off large coefficients when taking mesoscopic timesteps. Unlike FLAVORizing a general finite difference scheme, we FLAVORize the action\nSd instead of the PDE. Specifically, choose\n\uf8f1\n\uf8f4\n\u2200i, j\n\uf8f2kij = K,\n(23)\nhij = h,\n\u2200i and odd j\n\uf8f4\n\uf8f3\nhij = H \u2212 h, \u2200i and even j\nand let \u000f\u22121 = 0 in Ldi,j for even j's and all i's, while the large value of \u000f\u22121 is kept in Ldi,j\nfor odd j's and all i's. h and H correspond to a small and a mesoscopic time-step, and\nK corresponds to a mesoscopic space-step; the same rule of thumb for choosing them in\nSection 2 applies.\nAfter applying the discrete Hamilton's principle, the resulting discrete Euler Lagrangeequations corresponding to a multi-symplectic integrator will still be (20), except that\nstiffness is turned off in half of the grids. Multisymplecticity is automatically gained,\nbecause the updating equations originate from a discrete variational principle [21].\n9\n\n\f3.3\n\nExample: multiscale Sine-Gordon wave equation\n\nConsider a specific nonlinear wave equation (11) in which V (u) = \u2212 cos(\u03c9u) \u2212 cos(u).\nIf \u03c9 = 0, this corresponds to Sine-Gordon equation, which has been studied extensively\ndue to its soliton solutions and its relationships with quantum physics (for instance, as\na nonlinear version of Klein-Gordon equation). We are interested in the case in which\n\u03c9 (identified with \u000f\u22121 ) is big, so that a separation of timescale exhibits.\nArbitrarily choose L = 2 and use periodic boundary condition u(x + L, t) = u(x, t),\nand let initial condition be u(x, 0) = sin(2\u03c0x/L) and ut (x, 0) = 0. Denote total simulation time by T . Use the FLAVOR mesh (23). In order to obtain a stable and accurate\nnumerical solution, k and h have to be o(1/\u03c9), and K and H need to be o(1).\nSingle scale 1st order multisymplectic: \u03c9=20\n\nFLAVOR: \u03c9=20\n\n1\n\n1\n\n0.5\n\n0.5\n\n0\n\n0\n\n\u22120.5\n\n\u22120.5\n\n\u22121\n2\n\n\u22121\n2\n1.5\n\n10\n8\n\n1\n\n10\n\n4\n\n0.5\nx\n\n1.5\n\n0\n\n6\n4\n\n0.5\n\n2\n0\n\n8\n\n1\n\n6\n\nx\n\nt\n\n0\n\n2\n0\n\nt\n\nFigure 4: Numerical solutions to multiscale Sine-Gordon equation by single-scale 1st-order multisymplectic integrator (left) and its FLAVORization (right). For clarity, the surface plots (but not\nsimulations) use the same mesh size.\n\nA comparison between the benchmark of the single-scale forward time forward space\nmulti-symplectic integrator (Eq. 20 with hij = h and kij = k) and its FLAVORization\n(Eq. 20 with mesh (23) and V 0 (u) = \u03c9 sin(\u03c9u) + sin(u) for odd j and V 0 (u) = sin(u)\nfor even j) is presented in Figure 4. \u03c9 = 20, k = L/20/\u03c9 and h = k/2, and K = L/40\nand H = K/2. It is intuitive to say that the slow process of wave propagation is wellapproximated by FLAVOR, although the fast process of local fluctuation is not captured\nin the strong sense. Error quantification is not done, because what the slow and fast\nprocesses are is not rigorously known here. HK/2hk = 50-fold acceleration is obtained\nby FLAVOR.\nReaders familiar with the splitting theory of ODEs [24] might question whether\nh\nFLAVORS are equivalent to an averaged stiffness of \u03c9\u0303 = \u03c9 H\n(which corresponds \u03c9\u0303 = 2\nin the numerical experiment described above). The answer is no, because the equivalency\ngiven by the splitting theory is only local. In fact, the same single-scale forward time\nforward space multi-symplectic integration of the case \u03c9 = 2 is shown in Figure 5, which\n\n10\n\n\fSingle scale 1st order multisymplectic: \u03c9=2\n\n1.5\n1\n0.5\n0\n\u22120.5\n\u22121\n\u22121.5\n2\n1.5\n\n10\n8\n\n1\n\n6\n4\n\n0.5\nx\n\n0\n\n2\n0\n\nt\n\nFigure 5: Numerical solutions to multiscale Sine-Gordon equation with the 'equivalent' stiffness by\nsingle-scale 1st-order multi-symplectic integrator. For clarity, the surface plot (but not the simulation)\nuses the same mesh size (as in Figure 4).\n\nis clearly distinct from the FLAVOR result in Figure 4. Moreover, because of the eC\u03c9T\nerror term, changing stiffness alone will not result in a converging method (and result\nin a O(1) error on slow variables).\n\n4\n4.1\n\nPseudospectral methods\nSingle-scale method\n\nConsider a PDE\nut (x, t) = Lu(x, t)\n\n(24)\n\nwith periodic boundary condition u(x, t) = u(x + L, t) and initial condition u(x, 0) =\nf (x), where L is a differential operator involving only spatial derivatives.\nThe Fourier collocation method approximates the solutions by the truncated Fourier\nseries:\nX\nuN (x, t) =\nan (t)ein2\u03c0x/L\n(25)\n|n|\u2264N/2\n\nand solves for an (t)'s by requiring the PDE to hold at collocation points yj :\n\u2202t uN (yj , t) \u2212 LuN (yj , t) = 0\n\n(26)\n\nThis yields N ODEs, which can be integrated by any favorite ODE solver. Of course,\nspecific choices of collocations points will affect the numerical approximation. Oftentimes, the simplest choice of yj = Lj/N, j = 0, . . . , N \u2212 1 is used, and in this case, the\nmethod is also called a pseudospectral method. We refer to [17] for additional details on\nFourier collocation methods. It is worth mentioning that pseudospectral methods can\nalso be multi-symplectic when applied to Hamiltonian PDEs [10].\n11\n\n\f4.2\n\nFLAVORization of pseudospectral methods\n\nWhen the PDE is stiff (for instance, when L contains a large parameter \u000f\u22121 ), FLAVORS\ncan be employed to integrate the stiff ODEs (which will still contain \u000f\u22121 ) resulting from\na pseudospectral discretization.\nSimilarly, for the FLAVORization of a pseudospectral method, it is sufficient to\nchoose N \u001d L instead of N \u001d \u000f\u22121 L, i.e., the space-step can be coarse (K = o(1)).\nFor time stepping, alternatively switching between h = o(\u000f) and H \u2212 h for a mesoscopic\nH = o(1) is again needed, and stiffness has to be turned off over the mesoscopic step of\nH \u2212 h. In a sense, we are still using the same FLAVOR 'mesh' (Figure 1), except that\nhere we do not discretize space, but instead truncate Fourier series to resolve the same\nspatial grid size.\n\n4.3\n\nExample: a slow process driven by a non-Dirac fast process\n\nConsider the following system of PDEs\n\uf8f1\n2\n\uf8f4\n\uf8f2ut + ux \u2212 q = 0\nqt + qx \u2212 p = 0\n\uf8f4\n\uf8f3\npt + px + \u03c9 2 q = 0\n\n(27)\n\nwith periodic boundary conditions u(x, t) = u(x+L, t), q(x, t) = q(x+L, t), and p(x, t) =\np(x + L, t), and initial conditions u(x, 0) = f u (x), q(x, 0) = f q (x), and p(x, 0) = f p (x).\nThe integration domain is restricted to [0, T ] \u00d7 [0, L]. The stiffness \u000f\u22121 is identified with\n\u03c9 2 . We choose the initial condition of f u (x) = f q (x) = cos(2\u03c0x/L) and f p (x) = 0.\nIn this system, q and p correspond to a fast process, which is a field theory version\nof a harmonic oscillator with high frequency \u03c9. u is a slow process, into which energy is\npumped by the fast process in a non-trivial way.\nWe have chosen to FLAVORize (27) because it does not fall into the (simpler) category of systems with fast processes converging towards Dirac (single point support)\ninvariant distributions [15].\nWe use the classical 4th order Runga-Kutta scheme (see, for instance, [16]) for the\n(single-step) time integration of the pseudospectrally discretized system of ODEs (26).\n2\n(t) 7\u2192 \u00e3u,p,q\n(t + h) its numerical flow over a microscopic time step\nWrite \u03c6h\u03c9 : \u00e3u,q,p\nn\nn\nh (consisting of four sub-steps), where \u00e3u,q,p\n(t) are numerical approximations to the\nn\nFourier coefficients in (25), for the unknowns u, q and p at an arbitrary time t. Then,\n2\nthe corresponding FLAVOR update over a mesoscopic time step H will be \u03c60H\u2212h \u25e6 \u03c6\u03c9h ,\nwhich consists of eight sub-steps.\nWe present in Figure 6 and Figure 7 a comparison between the benchmark of singlescale pseudospectral simulation and its FLAVORization. It can be seen that the slow\nprocess of u is captured in strong (point-wise) sense, whereas the fast process of q is only\napproximated in a weak sense (i.e. as a measure, in the case, wave shape and amplitude\nare correct, but not the period). We choose L = 2, T = 10 and \u03c9 = 1000. The singlestep integration uses N = 20 and h = 0.1/\u03c9 (notice that this is already beyond the\n12\n\n\fPseudospectral: slow process\n\nFLAVOR: slow process\n\n5\n\n4\n\n4\n\n3\n\n3\nu\n\n6\n\n5\n\nu\n\n6\n\n2\n\n2\n\n1\n\n1\n\n0\n\n0\n\n\u22121\n10\n\n\u22121\n10\n2\n1.5\n\n5\n\n2\n1.5\n\n5\n\n1\n\n1\n\n0.5\nt\n\n0\n\n0\n\n0.5\nt\n\nx\n\n0\n\n0\n\nx\n\nFigure 6: Single-scale (left) and multiscale pseudospectral (right) integrations of slow u in system (27).\nPlotting mesh for the single-scale simulation is coarser than its computation mesh.\nstability/accuracy region of a single-scale finite difference, since the space step does not\ndepend on 1/\u03c9; the spectral method is more stable/accurate for a large space-step), and\nFLAVOR uses N = 20, h = 1/\u03c9 2 and H = 0.01. H/2h = 50-fold acceleration is achieved\nby FLAVOR.\n\n5\n5.1\n\nConvergence analysis\nSemi-discrete system\n\nAll FLow AVeraging integratORS described in previous sections are illustrations of the\nfollowing (semi-discrete) strategy: first, space is discretized or interpolated; next, spatial\ndifferential operators are approximated by algebraic functions of finitely many spatial\nvariables; finally, the resulting system of ODEs is numerically integrated by a corresponding ODE-FLAVOR [32]. In this section, we will use the semi-discrete ODE system\nas an intermediate link to demonstrate that these PDE-FLAVORS are convergent to\nthe exact PDE solution under reasonable assumptions (in a strong sense with respect\nto (possibly hidden) slow variables and in the sense of measures with respect to fast\nvariables).\nMore precisely, consider a spatial mesh (vector) MS = [x1 , x2 , . . .], a temporal mesh\n(vector) MT = [t1 , t2 , . . .], and a domain mesh (matrix) M = MS \u00d7 MT . Examples of\nthese meshes include the FLAVOR mesh MS = [K, 2K, . . . , N K] and MT = [h, H, H +\nh, 2H, . . . , (M \u2212 1)H, (M \u2212 1)H + h, M H], and a usual single-scale (step) integration\nmesh MS = [k, 2k, . . . , L] and MT = [h, 2h, . . . , T ] (recall the domain size is L = N K\nby T = M H). We will use the FLAVOR mesh throughout this section. We will compare\nthe solution of the PDE (28) with the solution obtained with the FLAVOR strategy at\nthese discrete points.\n\n13\n\n\fPseudospectral: fast process\n\nFLAVOR: fast process\n\n1.5\n\n1\n\n1\n\n0.5\n\n0.5\n\n0\n\nq\n\nq\n\n1.5\n\n\u22120.5\n\n0\n\u22120.5\n\n\u22121\n\n\u22121\n\n\u22121.5\n10\n\n\u22121.5\n10\n2\n1.5\n\n5\n\n2\n1.5\n\n5\n\n1\n\n1\n\n0.5\nt\n\n0\n\n0\n\n0.5\nt\n\nx\n\n0\n\n0\n\nx\n\nFigure 7: Single-scale (left) and multiscale pseudospectral (right) integrations of fast q in system (27).\nPlotting mesh for the single-scale simulation is coarser than its computation mesh. The same color does\nnot indicate the same value in these two plots.\nFor simplicity, assume the PDE of interest is 1st-order in time derivative:\nut (x, t) = F (1, \u000f\u22121 , x, t, u(x, t), ux (x, t), . . .)\n\n(28)\n\nObserve that a PDE (1) with higher-order time derivatives can be written as a system\nof 1st-order (in time derivatives) PDEs.\nNow consider a consistent discretization of PDE (28) with space step K and time\nstep h (we refer to Page 20 of [31] for a definition of the notion of consistency, which\nintuitively means vanishing local truncation error). Letting h \u2193 0 in this discretization,\nwe obtain a semi-discrete system (continuous in time and discrete in space). This semidiscrete system is denoted by the following system of ODEs, with approximated spatial\nderivatives:\n\uf8f1\n\u22121\n\uf8f4\n\uf8f4u\u03071 (t) = f1 (u1 , u2 , . . . , uN , \u000f , t)\n\uf8f4\n\uf8f4\n\uf8f2u\u0307 (t) = f (u , u , . . . , u , \u000f\u22121 , t)\n2\n2 1 2\nN\n(29)\n\uf8f4\n*\n*\n*\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3u\u0307 (t) = f (u , u , . . . , u , \u000f\u22121 , t)\nN\nN 1 2\nN\nAssuming existence and uniqueness of an exact C 1 strong solution u to the PDE (28),\nand writing u(MSi , t) its values at the spatial discretization points, we define for each i\nthe following remainder:\nRi (\u000f\u22121 , t) ,\n\n\u2202u\n(MSi , t) \u2212 fi (u(MS1 , t), u(MS2 , t), . . . , u(MSN , t), \u000f\u22121 , t)\n\u2202t\n\n(30)\n\nwhich is a real function of t indexed by \u000f\u22121 .\nThen, ui (t) approximates the exact solution u(MSi , t) evaluated at grid points in the\nsense that these remainders vanish as \u000f\u22121 K \u2193 0 (where K := MSi \u2212 MSi\u22121 ):\n\n14\n\n\fLemma 5.1. Assume that F in (28) satisfies\n|F (1, \u000f\u22121 , x, t, u(x, t), ux (x, t), . . .)| \u2264 (1 + \u000f\u22121 )|F (1, 1, x, t, u(x, t), ux (x, t), . . .)|\n\n(31)\n\nAssume that the fi in (29) satisfy similar inequalities. Then, there exists a constant Ci\nindependent from \u000f, h, H or K, such that for bounded t and u\n|Ri (\u000f\u22121 , t)| \u2264 (1 + \u000f\u22121 )Ci K\n\n(32)\n\nRemark 5.1. (31) is true, for instance, in cases where\nF (1, \u000f\u22121 , x, t, u(x, t), . . .) = F0 (x, t, u(x, t), . . .) + \u000f\u22121 F1 (x, t, u(x, t), . . .).\n\n(33)\n\nProof. The linear scaling with K in (32) immediately follows from the definition of\nconsistency, and the parameter 1 + \u000f\u22121 in (32) has its origin (31).\nRemark 5.2. The consistency of finite difference methods can be easily shown using\nTaylor expansions. For instance, applying a Taylor expansion to the solution of ut \u2212\n\u000f\u22121 ux = a(u) leads to\n\u0010\nu((i + 1)K, jh) \u2212 u(iK, jh)\nu(iK, (j + 1)h) =u(iK, jh) + h \u000f\u22121\nK\n\u0011\n\u0001\n+ O(K) + a(u(iK, jh)) + O(h2 )\n\n(34)\n\nwhich implies\n\u2202\nu((i + 1)K, t) \u2212 u(iK, t)\nu(iK, t) = \u000f\u22121\n+ a(u(iK, t)) + \u000f\u22121 O(K)\n\u2202t\nK\n\n(35)\n\ni (t)\nand naturally establishes the correspondence of fi (u1 , . . . , uN , \u000f\u22121 , t) = \u000f\u22121 ui+1 (t)\u2212u\n+\nK\n\u22121\na(ui (t)) and Ri = \u000f O(K) for a 1st-order finite difference scheme. Notice that the\nremainders are still stiff, but we will see later that this is not a problem, since they\ncan be handled by ODE-FLAVORs. The consistency of pseudospectral method can be\nshown similarly using Fourier analysis.\n\nWith Ri defined in (30), consider the following system of ODEs:\n\uf8f1\n\u22121\n\u22121\n\uf8f4\n\uf8f2u\u03071 (t) = f1 (u1 , u2 , . . . , uN , \u000f , t) + R1 (\u000f , t)\n***\n\uf8f4\n\uf8f3\nu\u0307N (t) = fN (u1 , u2 , . . . , uN , \u000f\u22121 , t) + RN (\u000f\u22121 , t)\n\n(36)\n\nwith initial condition ui (0) = u(MSi , 0). Obviously, its solution (ui (t))1\u2264i\u2264N is the exact\nPDE solution sampled at spatial grid points, i.e., ui (t) = u(MSi , t).\nWe will now establish the accuracy of PDE-FLAVOR by showing that an ODEFLAVOR integration of (36) leads to an accurate approximation of (ui (t))1\u2264i\u2264N . Since\n15\n\n\fspace (with fixed width L) is discretized by N grid points, we use the following (normalized by N ) norm in our following discussion (suppose vi (t) = v(MSi , t) for a function\nv):\n1\nk[v1 (t), v2 (t), . . . , vN (t)]k ,\nk[v1 (t), v2 (t), . . . , vN (t)]k1\n(37)\nN\nObserve that if v(*, t) is Riemann integrable, then\nlim [v(MS1 , t), v(MS2 , t), . . . , v(MSN , t)] \u2192\n\nK\u21930\n\n1\nkv(*, t)kL1\nL\n\n(recall L = N K is fixed),\n(38)\n\nand hence the norm (37) does not blow up or vanish as N \u2192 \u221e.\n\n5.2\n\nSufficient conditions for convergence, ODE-FLAVORS, and twoscale convergence of PDE-FLAVORS\n\nWe will now prove the accuracy of PDE-FLAVORs under the assumption of existence\nof (possibly hidden) slow and locally ergodic fast variables. The convergence of PDEFLAVORs will be expressed using the notion of two-scale flow convergence introduced\nin [32] (corresponding to a strong convergence with respect to slow variables and weak\none with respect to fast ones).\nCondition 5.1. Assume that the ODE system (36) satisfies the following conditions:\n1. (Existence of hidden slow and fast variables): There exists a (possibly time-dependent)\ndiffeomorphism \u03b7 t : [u1 (t), . . . , uN (t)] 7\u2192 [x(t), y(t)] from RN onto RN \u2212p \u00d7 Rp with\nuniformly bounded C 1 , C 2 derivatives with respect to ui 's and t, and such that for\nall \u000f > 0, (x(t), y(t)) satisfies\n(\n\u1e8b(t) = f (x(t), y(t), t)\n,\n(39)\n\u1e8f(t) = \u000f\u22121 g(x(t), y(t), t)\nwhere f and g have bounded C 1 derivatives with respect to x, y and t.\n2. (Local ergodicity of vast variables): There exists a family of probability measures\n\u03bct (x, dy) on Rp indexed by x \u2208 RN \u2212p and t \u2208 R, and a family of positive functions\nT 7\u2192 E t (T ) satisfying limT \u2192\u221e E t (T ) = 0 for all bounded t, such that for all\nx0 , y0 , t0 , T bounded and \u03c6 uniformly bounded and Lipschitz, the solution to\n\u1e8et = g(x0 , Yt , t0 )\n\nY0 = y 0\n\n(40)\n\nsatisfies\nZ\nZ\n\u0001\n1 T\n\u03c6(Ys )ds \u2212\n\u03c6(y)\u03bct0 (x0 , dy) \u2264 \u03c7t0 k(x0 , y0 )k E t0 (T )(k\u03c6kL\u221e + k\u2207\u03c6kL\u221e )\nT 0\nRp\n(41)\nt\nt\n0\nwhere r 7\u2192 \u03c7 (r) is bounded on compact sets, and \u03bc has bounded derivative with\nrespect to t in total variation norm.\n16\n\n\fUnder Conditions 5.1, the computation of the solution of PDE (28) can be accelerated by applying the FLAVOR strategy to a single-scale time integration of its semidiscretization (29).\nWrite \u03a6\u03b1t,t+\u03c4 the numerical flow of a given (legacy) ODE integrator for (29):\n\u03a6\u03b1t,t+\u03c4 : [\u01691 (t), . . . , \u0169N (t)] 7\u2192 [\u01691 (t + \u03c4 ), . . . , \u0169N (t + \u03c4 )] ,\n\n(42)\n\nwhere \u0169i (s) approximates ui (s) for all s, \u03c4 is the integration time step, and \u03b1 is a\ncontrollable parameter that replaces the stiff parameter \u000f\u22121 in (29) and takes values of\n\u000f\u22121 (stiffness 'on') or 0 (stiffness 'off').\nDefinition 5.1 (ODE-FLAVORS). The FLow AVeraging integratOR associated with\n\u03a6 is defined as the algorithm simulating the process:\n[\u016b1 (t), . . . , \u016bN (t)]\n1\n1\n1 \u0001\n\u0001\n\u0001\n\u000f\n\u000f\n\u000f\n\u25e6 * * * \u25e6 \u03a60H+h,2H \u25e6 \u03a6H,H+h\n\u25e6 \u03a60h,H \u25e6 \u03a60,h\n([u1 (0), . . . , uN (0)])\n= \u03a60(k\u22121)H+h,kH \u25e6 \u03a6(k\u22121)H,(k\u22121)H+h\n\n(43)\nwhere (the number of steps) k is a piece-wise constant function of t satisfying kH \u2264\nt < (k + 1)H, h is a microscopic time step resolving the fast timescale (h \u001c \u000f), H is a\nmesoscopic time step independent of the fast timescale satisfying h \u001c \u000f \u001c H \u001c 1 and\nh\nh\n( )2 \u001c H \u001c\n\u000f\n\u000f\n\n(44)\n\nCondition 5.2. Consider the legacy ODE integrator with one-step update map \u03a6\u03b1t,t+\u03c4\nintroduced in (42). Suppose there exists constants C > 0 and H0 > 0 independent of N\nand \u03b1, such that for any \u03c4 \u2264 H0 min(1/\u03b1, 1) and bounded vector [u1 , . . . , uN ],\nk\u03a6\u03b1t,t+\u03c4 (u1 , . . . , uN ) \u2212 [u1 , . . . , uN ] \u2212 \u03c4 [f1 (u1 , . . . , uN , \u03b1, t), . . .\n. . . , fN (u1 , . . . , uN , \u03b1, t)]k \u2264 C\u03c4 2 (1 + \u03b1)2 ,\n\n(45)\n\nCondition 5.2 corresponds to the assumption that the integrator \u03a6\u03b1t,t+\u03c4 is consistent\nfor (29).\nObserve that we are integrating (29) but not (36), since the remainders Ri 's are apriori unknown unless the exact PDE solution is known. However, the following lemma\nimplies that the FLAVORization of this integration is in fact convergent to the solution\nof (36), even though Ri 's are possibly stiff.\nLemma 5.2. Assume that \u03a6\u03b1t,t+\u03c4 , introduced in (42), satisfies Condition 5.2. Let h\nand H be the time steps used in the FLAVORization 5.1. If h \u001c \u000f, H \u001c h/\u000f, and\nK = O(H), then\nk\u03a6\u03b1t,t+\u03c4 (u1 , . . . , uN ) \u2212 [u1 , . . . , uN ] \u2212 \u03c4 [f1 (u1 , . . . , uN , \u03b1, t) + R1 (\u03b1, t), . . .\n. . . , fN (u1 , . . . , uN , \u03b1, t) + RN (\u03b1, t)]k \u2264 C\u03c4 2 (1 + \u03b1)2\nwhere \u03c4 = h when \u03b1 = \u000f\u22121 and \u03c4 = H \u2212 h when \u03b1 = 0.\n17\n\n(46)\n\n\fProof. By Condition 5.2, we have\nk\u03a6\u03b1t,t+\u03c4 (u1 , . . . , uN ) \u2212 [u1 , . . . , uN ] \u2212 \u03c4 [f1 (u1 , . . . , uN , \u03b1, t), . . .\n. . . , fN (u1 , . . . , uN , \u03b1, t)]k \u2264 C\u03c4 2 (1 + \u03b1)2\n\n(47)\n\nfor any \u03c4 \u2264 min(1/\u03b1, 1)H0 . In addition, Lemma 5.1 gives a bound on the remainders:\nwhen \u03b1 = \u000f\u22121 , there exists a constant C\u0303 > 0 independent of N and \u000f\u22121 , such that for\nall i,\n|\u03c4 Ri (\u000f\u22121 , t)| \u2264 \u03c4 C\u0303K\u000f\u22121\n(48)\nBecause we use \u03c4 = h in this case and K \u001c \u000f\u22121 \u03c4 , the above is bounded by \u03c4 C\u0303(\u0108\u000f\u22121 \u03c4 )\u000f\u22121 \u2264\nC\u03c4 2 (1 + \u03b1)2 for some constants \u0108 \u001c 1 and C = C\u0303 \u0108. When \u03b1 = 0 on the other hand,\nthere exists a constant C\u0303 > 0 such that for all i\n|\u03c4 Ri (\u000f\u22121 , t)| \u2264 \u03c4 C\u0303K\n\n(49)\n\nBecause K = O(H) and we use \u03c4 = H \u2212 h = O(H) in this case, the above is bounded by\n\u03c4 C\u0303 \u0108\u03c4 \u2264 C\u03c4 2 (1 + \u03b1)2 for some constants \u0108 and we let C = C\u0303 \u0108. Notice that the value\nof K is fixed in both cases but \u03c4 has different values: the flow map used in FLAVOR\nassociated with \u03b1 = 0 is the one with mesoscopic step \u03a60t+h,t+H , i.e., \u03c4 = H \u2212 h; when\n\u22121\n\n\u03b1 = \u000f\u22121 on the other hand, the flow map is \u03a6\u000ft,t+h and \u03c4 = h. Finally, the triangle\ninequality gives\nk\u03a6\u03b1t,t+\u03c4 (u1 , . . . , uN ) \u2212 [u1 , . . . , uN ] \u2212 \u03c4 [f1 (u1 , . . . , uN , \u03b1, t) + R1 (\u03b1, t), . . .\n. . . , fN (u1 , . . . , uN , \u03b1, t) + RN (\u03b1, t)]k \u2264 k\u03a6\u03b1t,t+\u03c4 (u1 , . . . , uN ) \u2212 [u1 , . . . , uN ]\u2212\nN\n1 X\n\u03c4 [f1 (u1 , . . . , uN , \u03b1, t), . . . , fN (u1 , . . . , uN , \u03b1, t)]k +\n|\u03c4 Ri (\u03b1, t)| \u2264 2C\u03c4 2 (1 + \u03b1)2 ,\nN\ni=1\n\n(50)\nwhich finished the proof after absorbing the coefficient 2 into C.\nWe also need the usual regularity and stability assumptions to prove the accuracy of\nFLAVORS for (36).\nCondition 5.3. Assume that\n1. f1 , f2 , . . . , fN are Lipschitz continuous.\n2. For all bounded initial condition [u1 (0), . . . , uN (0)]'s, the exact trajectories\n([u1 (t), . . . , uN (t)])0\u2264t\u2264T (i.e., solution to (36)) are uniformly bounded in \u000f.\n3. For all bounded initial condition [u1 (0), . . . , uN (0)]'s, the numerical trajectories\n([\u016b1 (t), . . . , \u016bN (t)])0\u2264t\u2264T (defined by (43)) are uniformly bounded in \u000f, 0 < H \u2264\nH0 , h \u2264 min(H0 \u000f, H).\n\n18\n\n\fThe following theorem shows the two-scale flow convergence (strong on slow variables\nx and in the sense of measures on fast ones y, see [32]) of FLAVORs under the above\nconditions.\nTheorem 5.1. Consider FLAVOR trajectories in Definition 5.1. Under Conditions 5.1,\n5.2 and 5.3, there exist C > 0, \u0108 > 0 and H0 > 0 independent from \u000f\u22121 and N , such\nthat for K/\u0108 < H < H0 , h < H0 \u000f and t > 0,\nkx(t) \u2212 [\u03b7 t ]x (\u016b1 (t), . . . , \u016bN (t))k \u2264 CeCt \u03c71 (u1 (0), . . . , uN (0), \u000f, H, h)\n\n(51)\n\nand for all bounded and uniformly Lipschitz continuous test functions \u03c6 : RN 7\u2192 R,\n1\n\u2206t\n\nZ\n\nt+\u2206t\n\nZ\n\u03c6([\u016b1 (s), . . . , \u016bN (s)]) ds \u2212\n\n\u03c6([\u03b7 t ]\u22121 (x(t), y))\u03bct (x(t), dy)\n\nRp\n\nt\n\n\u2264 \u03c72 (u1 (0), . . . , uN (0), \u000f, H, h, \u2206t, t)(k\u03c6kL\u221e + k\u2207\u03c6kL\u221e )\n\n(52)\n\nwhere \u03c71 and \u03c72 are bounded functions converging towards zero as \u000f \u2264 H/(C ln H1 ),\n\u000f\nh 2 1\nh\n\u000f \u2193 0, h H \u2193 0 and ( \u000f ) H \u2193 0 (and \u2206t \u2193 0 for \u03c72 ).\nRecall notations: N K = L is the fixed spatial width, [\u03b7 t ]x and [\u03b7 t ]\u22121 respectively\ndenote the x (slow) component and the inverse of the diffeomorphism \u03b7 t (defined in\nCondition 5.1), x(t) = [\u03b7 t ]x (u1 (t), . . . , uN (t)) corresponds to the slow component of the\nexact PDE solution sampled at grid points. ui (t) and \u016bi (t) represent the exact and the\nFLAVOR approximation of the solution to the semi-discrete system with the remainders\n(36).\nProof. The proof of Theorem 5.1 is analogous to that of Theorem 1.2 of [32] (which will\nnot be repeated here). The proof requires (46), which is guarantied from Condition 5.2\nby Lemma 5.2. It is easy to check that the slow dependence on time of f , g, \u03b7 and \u03bc\ndoes not affect the proof given in [32].\nRemark 5.3. Condition 5.2 implies that the constant C in Theorem 5.1 does not depend\non N or K. This is important because although using a finer mesh leads to a smaller K\nand a larger N = L/K, Condition 5.2 (which is equivalent to the accuracy of the semidiscrete approximation of the PDE) ensures that, as long as K = O(H) and h \u001d \u000fH,\nthe constant C in the error bounds on the slow component (51) and the fast component\n(52) will not blow up.\nRemark 5.4. Observe that the application of the FLAVOR strategy does not require the\nidentification of the diffeomorphism \u03b7 (which may depend on the spatial discretization).\n\n6\n\nOn FLAVORizing characteristics\n\nThe convergence result of the previous section is based on the semi-discretization of\nthe original PDE. PDEs and ODEs are also naturally connected via the method of\n19\n\n\fcharacteristics, and henceforth it is natural to wonder whether a numerical integration\nof those characteristics by FLAVORs would lead to an accurate approximation of the\nsolution of the original PDE. The answer to this question will be illustrated by analyzing\nthe following (generic) PDE:\n(\nF (Du, u, q, \u000f\u22121 ) = 0, q \u2208 U\n(53)\nu(q) = \u03b3(q),\nq\u2208\u0393\nwhere U \u2282 Rd is the domain in which solution is defined, \u0393 and \u03b3 define initial/boundary\nconditions.\nThe following condition corresponds to assuming that characteristics are well-posed.\nCondition 6.1. Assume that\n1. The PDE F (Du, u, q, \u000f\u22121 ) = 0 admits characteristics:\nq\u0307 = f (q, z, \u000f\u22121 )\n\n(54)\n\n\u017c = g(q, z)\n\n(55)\n\nu(q(t)) = z(t)\n\n(56)\n\nwhere q \u2208 U is a vector corresponding to coordinates of characteristics in the\ndomain of the PDE, and z corresponds to the unknown's value along the characteristics.\n2. For arbitrary \u000f, any point in U is reachable from the initial condition via one and\nonly one characteristics.\nThe following conditions correspond to the assumption of existence of (possibly hidden) slow and locally ergodic fast variables for those characteristics.\nCondition 6.2. Consider ODE (54). Assume that:\n1. There exists a z-dependent diffeomorphism \u03b7 z : q 7\u2192 [x, y] from Rd onto Rd\u2212p \u00d7 Rp\nwith uniformly bounded C 1 , C 2 derivatives with respect to both q and t, such that\n(x, y) satisfies (with z(t) given by (55))\n(\n\u1e8b = f1 (x, y, z)\n(57)\n\u1e8f = \u000f\u22121 f2 (x, y, z)\nwhere f1 , f2 , and g have bounded C 1 derivatives with respect to x, y and z, and\nu([\u03b7 z ]\u22121 (x, y)) has bounded C 1 derivatives with respect to the (slow) variables x\nand z.\n2. There exists a family of probability measures \u03bcz (x, dy) on Rp indexed by x \u2208 Rd\u2212p\nand z \u2208 R, as well as a family of positive functions T \u2192\n7\nE z (T ) satisfying\n20\n\n\flimT \u2192\u221e E z (T ) = 0, such that for all x0 , y0 , z0 , T bounded and \u03c6 uniformly bounded\nand Lipschitz, the solution to\n\u1e8et = f2 (x0 , Yt , z0 )\n\nY0 = y0\n\n(58)\n\nsatisfies\nZ\nZ\n\u0001\n1 T\n\u03c6(y)\u03bcz0 (x0 , dy) \u2264 \u03c7z0 k(x0 , y0 )k E z0 (T )(k\u03c6kL\u221e + k\u2207\u03c6kL\u221e )\n\u03c6(Ys )ds \u2212\nT 0\nRp\n(59)\nwhere r 7\u2192 \u03c7z0 (r) is bounded on compact sets, and \u03bcz has bounded derivative with\nrespect to z in total variation norm.\nThe second item of Condition 6.2 corresponds to the assumption that the fast variable\ny is locally ergodic with respect to a family of measures \u03bc drifted by the slow variables\nx and z.\nThe following lemma shows that, under the above conditions, the solution of PDE\n(53) is nearly constant on the orbit of the fast components (y) of the characteristics.\nLemma 6.1. Under Conditions 6.1 and 6.2, for any fixed constant C1 (independent of\n\u000f\u22121 ), there exists a constant C2 independent of \u000f\u22121 , such that for any 0 \u2264 t1 \u2264 C1 ,\n0 \u2264 t2 \u2264 C1 and (fixed) x0 and z0 ,\n\u0001\n\u0001\nu [\u03b7 z0 ]\u22121 (x0 , Y (t1 )) \u2212 u [\u03b7 z0 ]\u22121 (x0 , Y (t2 )) \u2264 C2 \u000f\n(60)\nwhere Y (t1 ) and Y (t2 ) are two points on the orbit of \u1e8e (t) = f2 (x0 , Y (t), z0 ).\nProof. Under Conditions 6.1 and 6.2, it is known (we refer for instance to [29] or to\nTheorem 14, Section 3 of Chapter II of [30] or to [28]) that x and z converge as \u000f \u2192 0\ntowards x\u0303 and z\u0303 defined as the solution to the following ODEs with initial condition x0\nand z0\n(\nR\nx\u0303 \u0307 = f1 (x\u0303, y, z\u0303)\u03bcz\u0303 (x\u0303, dy)\nR\n(61)\nz\u0303 \u0307 = g([\u03b7 z\u0303 ]\u22121 (x\u0303, y), z\u0303)\u03bcz\u0303 (x\u0303, dy)\nTherefore, writing y(t) the solution of \u1e8f = \u000f\u22121 f2 (x\u0303, y, z\u0303), we have as \u000f \u2192 0\nu([\u03b7 z\u0303(t) ]\u22121 (x\u0303(t), y(t))) \u2192 z\u0303(t)\n\n(62)\n\nNow, taking the time derivative of \u00fb = u \u25e6 \u03b7 \u22121 , we obtain\n\u00fbx x\u0303 \u0307 + \u00fby \u1e8f + \u00fbz z\u0303 \u0307 = z\u0303 \u0307 + \u1e58(\u000f)\n\n(63)\n\nwhere R(\u000f) is a function of t that goes to 0 as \u000f \u2192 0.\nFurthermore,\n\u1e8e (t) = f2 (x0 , Y (t), z0 )\n\u2202f2\n\u2202f2\n\u2202f2\n(x\u0303(\u000ft) \u2212 x0 ) +\n(z\u0303(\u000ft) \u2212 z0 ) +\n(y(\u000ft) \u2212 Y (t))\n\u2202 x\u0303\n\u2202 z\u0303\n\u2202y\n+ o(\u000f) + o(y(\u000ft) \u2212 Y (t))\n\n= f2 (x\u0303(\u000ft), y(\u000ft), z\u0303(\u000ft)) +\n\n21\n\n\fBy Taylor expansion, x\u0303(\u000ft) \u2212 x0 and z\u0303(\u000ft) \u2212 z0 are obviously O(\u000f). Applying Gronwall's\nlemma, we also obtain that y(\u000ft) \u2212 Y (t) = O(\u000f). Therefore,\n\u1e8e (t) = f2 (x\u0303(\u000ft), y(\u000ft), z\u0303(\u000ft)) + O(\u000f) = \u000f\u1e8f(t) + o(\u000f)\n\n(64)\n\nCombining Eq. 63 with Eq. 64, we obtain\nZ t2\nZ t2\n\u0001\n\u0001\n\u22121\nu \u03b7 (x0 , Y (t1 )) \u2212 u \u03b7 (x0 , Y (t2 )) =\n\u00fby * \u1e8e (t) dt = \u000f\n\u00fby * \u1e8f dt + o(\u000f)\nt1\nt1\n\u0012Z t2\n\u0013\nt2\n \u0307\n \u0307\n \u0307\n+ o(\u000f)\n(65)\n=\u000f\n(z\u0303 \u2212 \u00fbx x\u0303 \u2212 \u00fbz z\u0303) dt + R(\u000f)\n\u22121\n\nt1\n\nt1\n\n \u0307 \u00fbt and z\u0303 \u0307 are bounded, and R(\u000f) is vanishing (and hence bounded), we\nSince \u00fbx , x\u0303,\nconclude that the right hand side is O(\u000f).\nCondition 6.3. Assume that the domain U is bounded (independently from \u000f\u22121 ).\nLemma 6.2. If Conditions 6.1, 6.2, and 6.3 hold, then every point in U is reachable by\na characteristics from the initial condition in bounded time (independently from \u000f\u22121 ).\nProof. From Condition 6.1, we already know that every point is reachable, and therefore\nit suffices to show that hitting times do not blow up as \u000f \u2192 0. Since x(*) converges to\nx\u0303(*) (see proof of Lemma 6.1), by considering the x component of the characteristics\n(projected by \u03b7), it becomes trivial to show that the hitting time converges to a fixed\nvalue (and hence, does not blow up). Using Condition 6.3, we conclude that that any\npoint in U can be hit in (uniformly) bounded time from the initial condition.\nAnalogously to the Integrator 5.1, a legacy integrator for (54) and (55) can be FLAVORized, and shown to be convergent under regularity and stability conditions (analogous to Condition 5.3) requiring f1 , f2 and g to be Lipschitz continuous and q\u0303(t) and\nz\u0303(t) to be bounded. The convergence result is analogous to Theorem 5.1, modulo the\nfollowing change of notation: the slow index is now z instead of t, the original coordinates are q instead of ui , the vector field of the original coordinates is f instead of\nfi , and the dynamics of the slow index comes from the non-trivial drift of \u017c = g(q, z)\ninstead of the trivial \u1e6b = 1. We define \u0169(q\u0303(t)) := z\u0303(t) for all t on each FLAVORized\ncharacteristics [q\u0303(t), z\u0303(t)]. Naturally, \u0169 is only defined at discrete points in the domain\nU . These discrete points, however, densely 'fill' the space in the sense that (as shown by\nthe proof of the following theorem) FLAVORied characteristics remain very close to exact characteristics (x components are close in Euclidean distance, and y components are\nclose as well in terms of orbital distance induced by the infimum of point-wise Euclidean\ndistances).\nBy the two-scale convergence theorem, we can quantify: the strong convergence of\nthe slow coordinate of the characteristics and the unknown's value along the characteristics, and the weak convergence of fast coordinate of the characteristics. Finally, these\nsingle characteristics' ODE approximation error bounds can be transferred to the PDE\napproximation error bounds by considering the entire family of characteristics starting\nfrom all points (in initial condition).\n22\n\n\fTheorem 6.1. Write \u0169(q\u0303) the solution obtained by FLAVORizing all characteristics.\nUnder Conditions 6.1, 6.2, 6.3, the consistency and regularity and stability Conditions\ncorresponding to Conditions 5.2 and 5.3 (with the change of notation described above),\nthere exist a constant C independent of \u000f\u22121 and q0 \u2208 \u0393, such that\n|\u0169(q\u0303) \u2212 u(q\u0303)| \u2264 C\u03c71 (q0 , \u03b3(q0 ), \u000f, \u03b4, \u03c4 )(1 + \u03c72 (q0 , \u03b3(q0 ), \u000f, \u03b4, \u03c4, T, t))\n\n(66)\n\nfor any q\u0303 on any FLAVORized characteristics, where q0 \u2208 \u0393 and \u03b3(q0 ) correspond to the\ninitial condition that leads to q\u0303 via a FLAVORized characteristics, and \u03c71 and \u03c72 are\nvanishing error bound functions.\nRemark 6.1. When \u0393 is compact (such as in the case of periodic boundary condition),\n\u03c71 and \u03c72 can be further chosen to be independent of q0 (hence q\u0303) by taking a supremum\nover \u0393.\nProof. By Condition 6.1, all q \u2208 U can be traced back to q0 \u2208 \u0393 through a characteristics. By Lemma 6.2, characteristics starting from q0 reach q in bounded time T .\nUsing the two-scale convergence of the FLAVORization of these characteristics (a result\nanalogous to Theorem 5.1), we deduce that the approximation error associated with z\u0303T\n(on FLAVORized characteristics) can be bounded C\u03c71 (with respect to the true value\nu(q) = zT , the error CeCT has been replaced by C because T is bounded).\nNow observe that q\u0303T 6= qT , where q\u0303T is the coordinate of the FLAVORized characteristics starting from q0 . As before, let [xT , yT ] = \u03b7(qT ) and [x\u0303T , \u1ef9T ] = \u03b7(q\u0303T ). The\nerror on the slow component is kxT \u2212 x\u0303T k \u2264 C\u03c71 . The possible large error on the fast\ncomponent is not a problem because we can look for a near-by point on the fast orbit\nwith introducing only an O(\u000f) error on the unknown's value (Lemma 6.1):\n(\nu(\u03b7(xT , yT )) = u(\u03b7(xT , yT\u2217 )) + O(\u000f)\n(67)\nyT\u2217 = arg minYt |\u1e8et =f (xT ,Yt ) k\u1ef9T \u2212 Yt k\nSince kx\u0303T \u2212 xt k is small, the local ergodic measures that represent the orbits given by\n\u1e8et = f (xT , Yt ) and \u1e8et = f (x\u0303T , Yt ) will be small: k\u03bc(xT , dy) \u2212 \u03bc(x\u0303T , dy)kT.V. \u2264 C\u03c71 \u03c72 is\nby chain rule. Because \u1ef9T is on the orbit of \u1e8et = f (x\u0303T , Yt ), we will have kyT\u2217 \u2212 \u03b7 y (q\u0303T )k \u2264\nC\u03c71 \u03c72 .\nAll together, we obtain\n|\u0169(q\u0303T ) \u2212 u(q\u0303T )| = |z\u0303T \u2212 u(q\u0303T )|\n\u2264 |z\u0303T \u2212 u(q)| + |u(qT ) \u2212 u(q\u0303T )|\n\u2264 C\u03c71 + Ck\u2207(u \u25e6 \u03b7)k\u221e (kxT \u2212 \u03b7 x (q\u0303T )k + kyT \u2212 \u03b7 y (q\u0303T )k)\n\u2264 C\u03c71 + C(\u03c71 + \u03c71 \u03c72 ) = C\u03c71 + C\u03c71 \u03c72\n\n(68)\n\nRemark 6.2. To keep the presentation concise, we have written C all constants that\ndo not depend on essential parameters.\n23\n\n\fRemark 6.3. As shown above, u will be captured strongly. Du, on the other hand,\ndepends on a derivative with respect to the fast variable, and therefore will only be\nconvergent in a weak sense.\nRelevance to an error analysis for PDE-FLAVORS The above result guarantees the convergence of FLAVORized characteristics. It is also possible to establish an\nerror bound on the difference between a specific PDE-FLAVOR discretization and the\napproximation given by the above FLAVORized characteristics (and hence prove the\nconvergence of this specific PDE-FLAVOR discretization). Such an error bound could\nbe obtained by first transforming FLAVORized characteristics to PDE-FLAVOR grid\npoints via interpolating functions, and then using the fact that coordinate transformations do not affect the efficiency of FLAVORS. For the sake of conciseness, we did not\nelaborate on this point here.\n\n7\n\nAcknowledgement\n\nThis work is supported by NSF grant CMMI-092600. We thank Guo Luo for stimulating\ndiscussions and Sydney Garstang for proofreading the manuscript.\n\nReferences\n[1] Z. Artstein, C. W. Gear, I. G. Kevrekidis, M. Slemrod, and E. S. Titi,\nAnalysis and computation of a discrete kdv-burgers type equation with fast dispertion\nand slow diffusion. arXiv:0908.2752, 2009.\n[2] L. Berlyand and H. Owhadi, Flux norm approach to finite dimensional homogenization approximations with non-separated scales and high contrast, Archives for\nRational Mechanics and Analysis, 198 (2010), pp. 677\u2013721.\n[3] T. J. Bridges, A geometric formulation of the conservation of wave action and\nits implications for signature and the classification of instabilities, Proc. Roy. Soc.\nLond. A, 453 (1997), pp. 1365\u20131395.\n[4] T. J. Bridges, Multi-symplectic structures and wave propagation, Math. Proc.\nCamb. Phil. Soc., 121 (1997), pp. 147\u2013190.\n[5] T. J. Bridges, Canonical multi-symplectic structure on the total exterior algebra\nbundle, Proc. Roy. Soc. Lond. A, 462 (2006), pp. 1531\u20131551.\n[6] T. J. Bridges and G. Derks, Unstable eigenvalues and the linearization about\nsolitary waves and fronts with symmetry, Proc. Roy. Soc. Lond. A, 455 (1999),\npp. 2427\u20132469.\n\n24\n\n\f[7] T. J. Bridges and S. Reich, Multi-symplectic integrators: numerical schemes for\nHamiltonian PDEs that conserve symplecticity, Phys. Lett. A, 284 (2001), pp. 184\u2013\n193.\n[8] T. J. Bridges and S. Reich, Numerical methods for Hamiltonian PDEs, J. Phys.\nA, 39 (2006), pp. 5287\u20135320.\n[9] J. G. Charney, R. Fj\u00d6rtoft, and J. von Neumann, Numerical integration of\nthe barotropic vorticity equation, Tellus, 2 (1950), pp. 237\u2013254.\n[10] J.-B. Chen, Symplectic and multisymplectic Fourier pseudospectral discretizations\nfor the Klein\u2013Gordon equation, Lett. Math. Phys., 75 (2006), pp. 293\u2013305.\n[11] R. Courant, K. Friedrichs, and H. Lewy, \u00dcber die partiellen Differenzengleichungen der mathematischen Physik, Math. Ann., 100 (1928), pp. 32\u201374.\n[12] W. E, B. Engquist, X. Li, W. Ren, and E. Vanden-Eijnden, Heterogeneous\nmultiscale methods: a review, Commun. Comput. Phys., 2 (2007), pp. 367\u2013450.\n[13] W. E, D. Liu, and E. Vanden-Eijnden, Nested stochastic simulation algorithms\nfor chemical kinetic systems with multiple time scales, J. Comput. Phys., 221 (2007),\npp. 158\u2013180.\n[14] B. Engquist and Y.-H. Tsai, Heterogeneous multiscale methods for stiff ordinary\ndifferential equations, Math. Comp., 74 (2005), pp. 1707\u20131742 (electronic).\n[15] F. Filbet and S. Jin, A class of asymptotic preserving schemes for kinetic equations and related problems with stiff sources, (2010). arXiv:0905.1378. Accepted by\nJ. Comput. Phys.\n[16] E. Hairer, S. P. N\u00f8rsett, and G. Wanner, Solving ordinary differential equations. I, vol. 8 of Springer Series in Computational Mathematics, Springer-Verlag,\nBerlin, second ed., 1993. Nonstiff problems.\n[17] J. S. Hesthaven, S. Gottlieb, and D. Gottlieb, Spectral Methods for TimeDependent Problems, vol. 21 of Cambridge Monographs on Applied and Computational Mathematics, Cambridge University Press, United Kingdom, 2007.\n[18] S. Jin, L. Pareschi, and G. Toscani, Uniformly accurate diffusive relaxation\nschemes for multiscale transport equations, SIAM J. Numer. Anal., 38 (2000),\npp. 913\u2013936 (electronic).\n[19] P. Lax and R. Richtmyer, Survey of the stability of linear finite difference equations, Comm. Pure Appl. Math., 9 (1956), pp. 267\u2013293.\n[20] A. Lew, J. Marsden, M. Ortiz, and M. West, Asynchronous variational integrators, Arch. Ration. Mech. Anal., 167 (2003), pp. 85\u2013146.\n\n25\n\n\f[21] J. E. Marsden, G. W. Patrick, and S. Shkoller, Multisymplectic geometry,\nvariational integrators, and nonlinear PDEs, Commun. Math. Phys., 199 (1998),\npp. 351\u2013395.\n[22] J. E. Marsden and S. Shkoller, Multisymplectic geometry, covariant hamiltonians, and water waves, Math. Proc. Camb. Phil. Soc., 125 (1999), pp. 553\u2013575.\n[23] J. E. Marsden and M. West, Discrete mechanics and variational integrators,\nActa Numerica, (2001), pp. 357\u2013514.\n[24] R. McLachlan, G. Reinout, and W. Quispel, Splitting methods, Acta Numerica, (2002), pp. 341\u2013434.\n[25] G. Naldi and L. Pareschi, Numerical schemes for hyperbolic systems of conservation laws with stiff diffusive relaxation, SIAM J. Numer. Anal., 37 (2000),\npp. 1246\u20131270 (electronic).\n[26] H. Owhadi and L. Zhang, Metric-based upscaling, Comm. Pure Appl. Math., 60\n(2007), pp. 675\u2013723.\n[27]\n\n, Localized bases for finite dimensional homogenization approximations with\nnon-separated scales and high-contrast, (2010). arXiv:1011.0986.\n\n[28] G. A. Pavliotis and A. M. Stuart, Multiscale methods, vol. 53 of Texts in\nApplied Mathematics, Springer, New York, 2008. Averaging and homogenization.\n[29] J. A. Sanders and F. Verhulst, Averaging methods in nonlinear dynamical\nsystems, vol. 59 of Applied Mathematical Sciences, Springer-Verlag, New York,\n1985.\n[30] A. Skorokhod, Asymptotic methods in the theory of stochastic differential equations, vol. 78 of Translations of Mathematical Monographs, American Mathematical\nSociety, Providence, RI, 1989. Translated from the Russian by H. H. McFaden.\n[31] J. C. Strikwerda, Finite difference schemes and partial differential equations,\nSociety for Industrial and Applied Mathematics, 2nd ed., 2004.\n[32] M. Tao, H. Owhadi, and J. E. Marsden, Nonintrusive and structure preserving\nmultiscale integration of stiff ODEs, SDEs and Hamiltonian systems with hidden\nslow dynamics via flow averaging, Multiscale Model. Simul., 8 (2010), pp. 1269\u2013\n1324.\n\n26\n\n\f"}