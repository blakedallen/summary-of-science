{"id": "http://arxiv.org/abs/1005.0272v1", "guidislink": true, "updated": "2010-05-03T12:32:23Z", "updated_parsed": [2010, 5, 3, 12, 32, 23, 0, 123, 0], "published": "2010-05-03T12:32:23Z", "published_parsed": [2010, 5, 3, 12, 32, 23, 0, 123, 0], "title": "Security of high speed quantum key distribution with finite detector\n  dead time", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1005.5483%2C1005.0785%2C1005.2156%2C1005.1641%2C1005.4344%2C1005.5127%2C1005.4221%2C1005.5052%2C1005.1532%2C1005.0829%2C1005.3754%2C1005.4273%2C1005.3268%2C1005.1357%2C1005.5593%2C1005.2673%2C1005.4136%2C1005.5200%2C1005.0272%2C1005.0194%2C1005.5194%2C1005.0683%2C1005.1134%2C1005.2629%2C1005.3072%2C1005.4896%2C1005.0915%2C1005.2965%2C1005.3220%2C1005.4158%2C1005.5235%2C1005.5080%2C1005.4585%2C1005.2610%2C1005.1404%2C1005.2473%2C1005.2758%2C1005.0051%2C1005.0344%2C1005.2296%2C1005.2414%2C1005.5188%2C1005.1518%2C1005.3345%2C1005.1673%2C1005.4160%2C1005.5351%2C1005.5459%2C1005.3365%2C1005.1157%2C1005.4517%2C1005.3792%2C1005.2914%2C1005.3481%2C1005.2435%2C1005.0961%2C1005.4285%2C1005.3836%2C1005.2005%2C1005.3598%2C1005.3934%2C1005.4887%2C1005.2447%2C1005.3416%2C1005.4803%2C1005.1341%2C1005.4125%2C1005.4091%2C1005.0563%2C1005.5300%2C1005.3667%2C1005.3688%2C1005.1394%2C1005.0190%2C1005.1334%2C1005.1877%2C1005.0246%2C1005.1407%2C1005.3370%2C1005.1423%2C1005.5220%2C1005.1999%2C1005.0047%2C1005.2607%2C1005.0277%2C1005.0128%2C1005.3398%2C1005.0851%2C1005.3924%2C1005.2294%2C1005.4689%2C1005.5314%2C1005.0183%2C1005.0754%2C1005.5564%2C1005.2687%2C1005.2885%2C1005.3675%2C1005.1675%2C1005.4227%2C1005.5363&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Security of high speed quantum key distribution with finite detector\n  dead time"}, "summary": "The security of a high speed quantum key distribution system with finite\ndetector dead time \\tau is analyzed. When the transmission rate becomes higher\nthan the maximum count rate of the individual detectors (1/\\tau ), security\nissues affect the algorithm for sifting bits. Analytical calculations and\nnumerical simulations of the Bennett-Brassard BB84 protocol are performed. We\nstudy Rogers et al.'s protocol (introduced in \"Detector dead-time effects and\nparalyzability in high-speed quantum key distribution,\" New J. Phys. 9 (2007)\n319) in the presence of an active eavesdropper Eve who has the power to perform\nan intercept-resend attack. It is shown that Rogers et al.'s protocol is no\nlonger secure. More specifically, Eve can induce a basis-dependent detection\nefficiency at the receiver's end. Modified key sifting schemes that are secure\nin the presence of dead time and an active eavesdropper are then introduced. We\nanalyze and compare these secure sifting schemes for this active Eve scenario,\nand calculate and simulate their key generation rate. It is shown that the\nmaximum key generation rate is 1/(2\\tau ) for passive basis selection, and\n1/\\tau for active basis selection. The security analysis for finite detector\ndead time is also extended to the decoy state BB84 protocol.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1005.5483%2C1005.0785%2C1005.2156%2C1005.1641%2C1005.4344%2C1005.5127%2C1005.4221%2C1005.5052%2C1005.1532%2C1005.0829%2C1005.3754%2C1005.4273%2C1005.3268%2C1005.1357%2C1005.5593%2C1005.2673%2C1005.4136%2C1005.5200%2C1005.0272%2C1005.0194%2C1005.5194%2C1005.0683%2C1005.1134%2C1005.2629%2C1005.3072%2C1005.4896%2C1005.0915%2C1005.2965%2C1005.3220%2C1005.4158%2C1005.5235%2C1005.5080%2C1005.4585%2C1005.2610%2C1005.1404%2C1005.2473%2C1005.2758%2C1005.0051%2C1005.0344%2C1005.2296%2C1005.2414%2C1005.5188%2C1005.1518%2C1005.3345%2C1005.1673%2C1005.4160%2C1005.5351%2C1005.5459%2C1005.3365%2C1005.1157%2C1005.4517%2C1005.3792%2C1005.2914%2C1005.3481%2C1005.2435%2C1005.0961%2C1005.4285%2C1005.3836%2C1005.2005%2C1005.3598%2C1005.3934%2C1005.4887%2C1005.2447%2C1005.3416%2C1005.4803%2C1005.1341%2C1005.4125%2C1005.4091%2C1005.0563%2C1005.5300%2C1005.3667%2C1005.3688%2C1005.1394%2C1005.0190%2C1005.1334%2C1005.1877%2C1005.0246%2C1005.1407%2C1005.3370%2C1005.1423%2C1005.5220%2C1005.1999%2C1005.0047%2C1005.2607%2C1005.0277%2C1005.0128%2C1005.3398%2C1005.0851%2C1005.3924%2C1005.2294%2C1005.4689%2C1005.5314%2C1005.0183%2C1005.0754%2C1005.5564%2C1005.2687%2C1005.2885%2C1005.3675%2C1005.1675%2C1005.4227%2C1005.5363&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The security of a high speed quantum key distribution system with finite\ndetector dead time \\tau is analyzed. When the transmission rate becomes higher\nthan the maximum count rate of the individual detectors (1/\\tau ), security\nissues affect the algorithm for sifting bits. Analytical calculations and\nnumerical simulations of the Bennett-Brassard BB84 protocol are performed. We\nstudy Rogers et al.'s protocol (introduced in \"Detector dead-time effects and\nparalyzability in high-speed quantum key distribution,\" New J. Phys. 9 (2007)\n319) in the presence of an active eavesdropper Eve who has the power to perform\nan intercept-resend attack. It is shown that Rogers et al.'s protocol is no\nlonger secure. More specifically, Eve can induce a basis-dependent detection\nefficiency at the receiver's end. Modified key sifting schemes that are secure\nin the presence of dead time and an active eavesdropper are then introduced. We\nanalyze and compare these secure sifting schemes for this active Eve scenario,\nand calculate and simulate their key generation rate. It is shown that the\nmaximum key generation rate is 1/(2\\tau ) for passive basis selection, and\n1/\\tau for active basis selection. The security analysis for finite detector\ndead time is also extended to the decoy state BB84 protocol."}, "authors": ["Viacheslav Burenkov", "Bing Qi", "Ben Fortescue", "Hoi-Kwong Lo"], "author_detail": {"name": "Hoi-Kwong Lo"}, "author": "Hoi-Kwong Lo", "arxiv_comment": "18 pages, 7 figures", "links": [{"href": "http://arxiv.org/abs/1005.0272v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1005.0272v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1005.0272v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1005.0272v1", "journal_reference": null, "doi": null, "fulltext": "Security of high speed quantum key distribution with finite\ndetector dead time\nViacheslav Burenkov1,5, Bing Qi2,3, Ben Fortescue4 and Hoi-Kwong Lo1,2,3\n1\n\nDepartment of Physics, University of Toronto, Toronto, Ontario, M5S 1A7, Canada\nCenter for Quantum Information and Quantum Control, University of Toronto, Toronto,\nOntario, Canada\n3\nDepartment of Electrical and Computer Engineering, University of Toronto, Ontario, M5S\n3G4, Canada\n4\nInstitute for Quantum Information Science, University of Calgary, Alberta, T2N 1N4,\nCanada\n2\n\nEmail: viacheslav.burenkov@utoronto.ca\nAbstract. The security of a high speed quantum key distribution system with finite detector dead time\n\uf074 is analyzed. When the transmission rate becomes higher than the maximum count rate of the\nindividual detectors (1/\uf074), security issues affect the algorithm for sifting bits. Analytical calculations\nand numerical simulations of the Bennett-Brassard BB84 protocol are performed. We study Rogers et\nal.'s protocol (introduced in \"Detector dead-time effects and paralyzability in high-speed quantum key\ndistribution,\" New J. Phys. 9 (2007) 319) in the presence of an active eavesdropper Eve who has the\npower to perform an intercept-resend attack. It is shown that Rogers et al.\u201fs protocol is no longer\nsecure. More specifically, Eve can induce a basis-dependent detection efficiency at the receiver\u201fs end.\nModified key sifting schemes that are secure in the presence of dead time and an active eavesdropper\nare then introduced. We analyze and compare these secure sifting schemes for this active Eve\nscenario, and calculate and simulate their key generation rate. It is shown that the maximum key\ngeneration rate is 1/(2\uf074) for passive basis selection, and 1/\uf074 for active basis selection. The security\nanalysis for finite detector dead time is also extended to the decoy state BB84 protocol.\n\nContents\n1.\n2.\n3.\n4.\n5.\n6.\n\nIntroduction\nSystem model and Rogers et al.\u201fs algorithm\nProblems with Rogers et al.\u201fs algorithm with active Eve\nSecure sifting schemes\nDecoy state BB84\nConclusions\nAcknowledgements\nReferences\n5\n\nAuthor to whom any correspondence should be addressed.\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\n1. Introduction\nQuantum key distribution (QKD) [1,2] can be used to expand a secret key (random bit string) between\ntwo distant parties, Alice and Bob. The security of the key is guaranteed by the laws of quantum\nmechanics; the process of measuring a quantum system generally disturbs it, thus allowing Alice and Bob\nto detect the presence of an eavesdropper, Eve. For a review of QKD, see [3-5].\nQKD is unconditionally secure [6-8] and BB84 [1] is a commonly used QKD protocol. It can be used in\nits original form or supplemented by the use of decoy states [9-11] for improved performance.\nAs the length of the secret key needs to be as long as the message for secure one-time-pad encryption, the\nsecret key generation rate is a crucial figure of merit. As such, there has been a lot of recent progress in\nexperimental high speed QKD [12,13]. It is generally true that increasing the transmission rate increases\nthe secret key generation rate. However, since most realistic single photon detectors have a property\ncalled dead time \u2013 the time interval right after a detection, during which a detector recovers and cannot\ndetect another incoming photon \u2013 certain security assumptions may be violated if transmission rates are\nincreased inattentively. In this paper we consider the security of a high speed QKD system with finite\ndetector dead time, in the regime where the transmission rate is so high that photons can arrive at Bob\u201fs\ndetectors while one or more detectors are still recovering from previous detection events. This work\nbuilds on the earlier work by D. Rogers et al. [14]. Monte-Carlo simulations of the BB84 protocol were\nperformed to extend the security analysis to include an active Eve capable of interfering with the signals.\nIn section 2, we describe the model and a sifting algorithm proposed by Rogers et al., for secure operation\nin the passive Eve scenario. In section 3, we show that this algorithm is no longer secure when Eve is able\nto perform an intercept-resend attack. In section 4, we analyze sifting schemes that are secure in this\nactive Eve scenario and compare the sifted bit rate of these algorithms. Section 5 extends the sifted key\nrate analysis to the decoy-state BB84 protocol. Section 6 contains our concluding remarks.\n2. System model and Rogers' algorithm\nWe consider polarization encoded BB84 protocol, with a passive polarization detection scheme [3] shown\nin figure 1. Notice that there are two bases:\n1) rectilinear (consisting of vertically and horizontally polarized photons) and\n2) diagonal (consisting of 45-degree and 135-degree polarized photons).\n\nFigure 1. Passive polarization detection optics. A 50-50 beam splitter (BS) performs basis selection and\nthe combination of half waveplate (HWP) and polarizing beam splitters (PBS) perform the polarization\nmeasurement in two bases: basis 1 (V-H) and basis 2 (-45 \u030a, +45 \u030a).\n2\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nThe idealized gain \uf068 is given by the overall transmission and detection efficiency [15]:\n\n\uf068 \uf03d t AB\uf068 Bob \uf03d t ABt Bob\uf068 D ,\n\n(1)\n\nwhere\ntAB = channel transmittance\n\uf068Bob = efficiency of Bob\u201fs system\ntBob = Bob\u201fs internal transmittance\n\uf068D = detection efficiency.\nThe channel transmittance can be expressed as:\n\u03b1l\n\ntAB = 10\u221210 ,\n\n(2)\n\nwhere \uf061 is the loss coefficient in dB/km and l is the channel distance in km.\nThe list of assumptions about the QKD system is provided below.\nExcept for Sections 5 and 6, the source is assumed to be a perfect single photon source. A number of\nrandomly and uniformly chosen signals sent by Alice are erased to model the loss in the quantum channel.\nFibre loss \uf061 is about 0.2 dB/km at the telecom wavelength of 1550 nm. As such, a typical loss for a 100\nkm length of fibre in current experiments is of the order of 20 dB.\nThe detector model is as follows. We assume detectors have a dead time \uf074. In Si-APDs, during the dead\ntime, the bias voltage across the p-n junction is below the breakdown threshold and as such, another\nphoton cannot be detected [16]. This limits their counting rate to 1/\uf074. In our simplified model, we assume\nthat an active detector will detect an incoming signal with some maximum constant detection efficiency\n\uf068D, which drops instantaneously to 0 after a detection event, and undergoes an instantaneous transition\nback to \uf068D after the dead time \uf074 (see figure 2).\n\nFigure 2. Detection dead time model. The detector undergoes an instantaneous transition from some\nconstant maximum value \uf068D to 0% efficiency upon being hit by a photon and instantly back again after a\ndead time \uf074.\nFor Silicon SPADs the typical dead time is of the order of 100 ns [16], which is the value used in our\nsimulations. All four detectors are assumed to have the same dead time. We further assume that a photon\n3\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nthat strikes the detector while it is recovering does not extend the recovery time, nor has any effect\nwhatsoever [17]. This makes individual detectors non-paralyzable systems [18]. Finally, it is assumed that\nthere are no dark counts (except for sections 5 and 6) and the channel is noiseless.\nIn this section, it is assumed that Eve is passive. In other words, she does not interfere with the quantum\nsignals but she can \u201elisten\u201f to the classical channel so that she has full information about the classical\ntransmission from Bob to Alice (bases used and time of detections) and Alice to Bob (which detections to\nsift).\nGenerally, as the transmission rate increases, the sifted key rate increases. However, since the detectors\nhave a finite dead time \uf074, there comes a point where the transmission rate \uf072 (in terms of number of\ntransmissions per second) is so high that it exceeds the maximum counting rate of the individual detectors\n(1/\uf074), so that photons can arrive at Bob while one or more of his detectors are recovering from previous\ndetection events. If two detection events occur in the same basis within one dead time window, they\nnecessarily correspond to two different bits [19]. This leads to correlations in the sifted bit string, which is\nan obvious security flaw. Each \u201eclosely-spaced\u201f detection sequence can thus produce at most a single\nsifted bit.\nRogers et al. [14] proposed a sifting algorithm with the goal of allowing the system to work in the highspeed regime without compromising the security of the key. The hope is that the key can be generated at a\nrate higher than 1/(2\uf074) \u2013 the maximum key rate achievable by deactivating all detectors upon any detector\nfiring, as we will discuss in section 4.\nRogers et al.\u201fs algorithm can be defined as follows. Each basis is treated individually; the status of the\ntwo detectors in the other basis is irrelevant. A basis is considered active if both detectors in that basis are\nactive at the expected photon arrival time, given by the probability P0,0. Only in this case the subsequent\ndetection sequence will be accepted. For an accepted detection sequence, the probability of sifting a bit\nfrom it depends on whether Alice and Bob used the same basis at least once, and ranges from 0.5 (for a\nsingle detection) up to 1 (for a very long detection sequence).\nIt is useful to consider a quantity k, the number of transmission periods per dead time, defined by k = \uf072\uf074,\nwhere \uf072 is the transmission rate. The transition between the standard and the high-speed regimes occurs at\nk = 1, irrespective of channel loss. Rogers et al. [14] showed that the probability of a basis being active,\nand thus capable of sifting a bit, tends to zero as k (and the transmission rate) tend to infinity. This means\nthat high-speed QKD systems are paralyzable counting systems. This phenomenon occurs from the\ncollective behaviour of a pair of detectors in a given basis which lock up.\nIncreasing the transmission rate tends to lock up the detectors in each basis, resulting in a long string of\nclosely spaced detections which allow at most one bit to be sifted. This effect reduces and eventually\noutweighs the advantage of transmitting at a higher rate. The point where these balance gives rise to an\noptimum transmission rate that maximizes sifted bit rate production. Plotting the log of transmission rate\nvs sifted key rate shows a Bell-like curve. That is to say, the sifted key rate reaches a maximum value at\nthe optimal transmission rate, after which further increases in transmission rate actually hinder sifted key\nproduction. This maximum key rate achievable with Rogers et al.\u201fs algorithm is considerably higher than\n1/(2\uf074), given approximately by 1.43/(2\uf074) [14].\n4\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\n3. Problems with Rogers et al.'s algorithm with active Eve\nRogers et al. paper [14] considers a purely passive Eve who can only \u201elisten\u201f. Such an assumption is\nclearly not valid in any realistic setting where the channel is noisy and Eve can be active. We extend the\nanalysis by introducing an Eve that can perform an intercept-resend attack.\nThe intercept-resend attack is a simple, yet effective, attack that involves Eve intercepting Alice\u201fs photons\nindividually, measuring them in one of two bases used by Alice and Bob, and sending new photons to\nBob according to the outcome of her measurement. Eve gains information at the cost of introducing\nquantum bit errors.\nEve has the ability to intercept any (or all) pulses, and resend one of Alice\u201fs states at will (also single\nphotons), or none at all (blocking the signal). Eve is assumed to have a 4-detector set-up like Bob, but her\ndetectors have infinitesimal dead time.\nIn what follows, we will show that Rogers et al.\u201fs sifting algorithm can no longer be considered secure.\nThis is because Eve can force Bob\u201fs detection efficiency to be basis-dependent. To illustrate this, consider\na simple attack by Eve that goes as follows. Eve blocks Alice's pulses 1,2,...,N (where N is a large\nnumber). In their place, she sends N pulses all in the \"vertical\" polarization state. Summing over the\ncorresponding detection events, the probability of basis 1 (rectilinear) being active is higher than the\nprobability of basis 2 (diagonal) being active. When N is large enough we reach the stationary\ndistribution. Although this specific attack can be easily detected by Alice and Bob in practice (because\nEve's N \"vertical\" photons will cause a high error rate), notice that Eve may lower the error rate she\nintroduces by performing the attack on only part of the signals. Here comes a key point: Eve's ability to\nintroduce basis-dependent detection efficiency violates a fundamental assumption in security proofs\n[8,20-22]. Note that for repetition rate smaller than 1/\uf074, both bases are active with equal probability.\nA simulation was carried out to test for basis dependence on Bob\u201fs side in the case of this simple attack,\nwith finite detector dead times. The probability P0,0 of both detectors being active in each basis was\ncalculated using Rogers et al.\u201fs algorithm for a large number of pulses. See figure 3.\n\nFigure 3. A simple intercept-resend attack can force a basis dependence of detector efficiency.\nNormalized transmission rate k = 10, channel loss = 3 dB, detection efficiency \uf068D = 100%. In the lowspeed regime both bases would be active 100% of the (expected photon arrival) time.\n5\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nThe result is that basis one is considerably more active than basis two. Note that the ratio of P0,0 for basis\n2 to P0,0 for basis 1 (equal to 0.67 above) is independent of the number of pulses sent as long as the\nnumber is large, and it is therefore not a transient effect caused by detectors starting off in the active state.\nIt is instructive to see how this basis dependence varies with k. We want to derive the dependence of P0,0\non k for each basis. For basis 2, P0,0 has already been derived in (8) of Ref. [14], and we quote the result\nhere:\n\uf02d1\n\n\uf0e9\n\uf0e6 ( 2 p) 2 \uf0f6\uf0f9\n\uf0e6 2p \uf0f6\n\uf0f7 ,\n\uf0f7\uf0f7 \uf02b (k ' 2 \uf02dk ' )\uf0e7\nP0,0 (basis 2) \uf03d \uf0ea1 \uf02b (2k ' )\uf0e7\uf0e7\n\uf0e7 1 \uf02d 2 p \uf0f7\uf0fa\uf0fa\n\uf0ea\uf0eb\n\uf0e81 \uf02d 2 p \uf0f8\n\uf0e8\n\uf0f8\uf0fb\n\n(3)\n\nwhere p is the probability that a particular detector produces a sifted bit on a given clock cycle and k\u201f is\nthe number of transmission periods per dead time. More concretely, for BB84 with four detectors,\n\np \uf03d\uf068 / 8 ,\n\n(4)\n\nwhere \uf068 is the idealized gain defined in (1), and the factor of 1/8 accounts for the correct basis choice\n(1/2) and the specific detector clicking (1/4). The definition of the normalized transmission rate used by\nRogers et al. [14] is slightly different than in this paper. To account for this, (3) has to be adjusted by\nreplacing k' with k' = (k \u2013 1). Note that (3) applies only at integer values of k'.\nIn Ref. [14], (3) above was derived for the case where Eve is passive and thus, in each basis, Bob receives\na random bit on average. Notice that, in our case Eve always sends a vertical photon. Nonetheless, for\nbasis 2, Bob also receives a random bit. Therefore, the derivation in Ref. [14] carries over directly here.\nTo find P0,0 for basis 1 we only need to find the probability of detector 1 being active, since detector 2 is\nalways active. The basis, at any discrete point (expected photon arrival time), is either active or passive.\nLet us assume for the moment that the detection system comprises only of basis 1. Then, the probability\nof a click given that the basis is active is given by the idealized gain for one basis \uf0681. Similarly, the\nprobability of the basis remaining active is given by 1 \u2013 \uf068 1:\nP(click | active) \uf03d \uf0681\nP(no click | active ) \uf03d 1 \uf02d \uf0681\n\n(5)\n\nOnce in a passive state, the detection system will evolve in a unique way through a series of passive states\nand take (k \u2013 1) steps to return to the active state. From the active state, the system at the next step can\neither remain active (if photon is lost), or become passive (if detector 1 is hit) and begin to recover.\nWe can therefore write the following equations that govern the evolution of the system in the stationary\nstate, where Pa is the probability that the detection system is active and Ppn is the probability that the\nsystem is in the passive state after n steps:\n\nPa \uf03d Pp( k \uf02d1) \uf02b Pa (1 \uf02d \uf0681 )\nPp1 \uf03d Pa\uf0681\n\n6\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nPp 2 \uf03d Pp1\n\n(6)\n\n\u205e\n\nPp( k \uf02d1) \uf03d Pp( k \uf02d2) .\nWe also know that the system must be in one of these states at any point, and since there are a total of\n(k \u2013 1) equally likely passive states, we have\n1 \uf03d Pa \uf02b (k \uf02d 1) Pp1 \uf03d Pa \uf02b (k \uf02d 1) Pa\uf0681 ,\n\nwhich gives\n\nPa \uf03d\n\n1\n.\n1 \uf02b (k \uf02d 1)\uf0681\n\n(7)\n\nHowever, there are two bases. Since only half of the photons that reach Bob will go to basis 1, we modify\n(7) by noting that \uf0681 = (1/2)\uf068, where \uf068 is the idealized gain defined by (1). This gives the probability P0,0\nthat basis 1 is active (and hence capable of sifting bits):\n\nP0,0 (basis 1) \uf03d\n\n1\n.\n1 \uf02b 0.5(k \uf02d 1)\uf068\n\n(8)\n\nWe can now see how P0,0 changes with k for the two different bases while Eve is doing the simple\nintercept-resend attack described above. Figure 4(a) shows both the results of Monte Carlo simulations\nand theoretical results (given by (3) and (8)) derived using Markov chain arguments. Note that the\ntheoretical values apply only at integer values of k. Figure 3 is a snapshot of figure 4(a) for k = 10. It is\nalso interesting to see how the ratio of P0,0 for basis 2 to P0,0 for basis 1 varies with k, for the same values\nof \uf068 and p. See figure 4(b).\n\n7\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nFigure 4. (a) Basis dependence worsens with increasing k. Both bases become less active, but basis 2\nbecomes less active at a higher rate than basis 1. \uf068 = 0.5 (channel loss = 3 dB), so that p = 1/16 (as\ndefined in (4)).\n(b) Ratio of P0,0 for basis 2 to P0,0 for basis 1 decreases from 1 gradually to 0 with increasing k.\n\n8\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nThe ratio of P0,0 for basis 2 to P0,0 for basis 1 drops gradually to 0 with increasing k from the initial value\nof 1 in the slow speed regime at k = 1.\nFigures 4(a) and 4(b) clearly show how detection efficiency becomes more basis-dependent with\nincreasing k. The reason for the difference between the two bases is as follows. The two detectors\u201f dead\nperiods in basis 2 gradually move out of sync with respect to each other after a series of independent\nclicks and recoveries. The chance of basis 2 being active and capable of sifting bits drops as the detectors\ntend to recover at different times. It becomes increasingly unlikely to have both detectors recovering at\nabout the same time for higher values of k. Basis 1 on the other hand never gets locked up and always\nsifts bit value 1 when (an active) detector 1 is hit. At k = 1 both bases are always active. As k increases,\nthe % of time each basis is active drops as one would expect, but basis 2 suffers from the extra effect of\ndetectors locking up, which is more prevalent for higher values of k.\nWe see that for Rogers et al.\u201fs algorithm detection efficiency is basis dependent:\nP0,0 (basis 1) \uf0b9 P0,0 (basis 2) .\n\nThis contradicts security proof assumptions [8,20-22]. Therefore, the current sifting algorithm is\npotentially no longer safe. Attacks attempting to exploit detection efficiency mismatch exist [23-25].\n4. Secure sifting schemes\nWe have investigated alternative sifting algorithms to see if it is still possible to have secure operation for\na finite dead time QKD system in the presence of the most general attack based on the dead time model\nwe consider, assuming the original system without dead time is secure. Some of these are described\nbelow.\nAlgAllActive\nThis is a purely software implementation and the algorithm only sifts a bit if all four detectors are active.\nIt removes the aforementioned basis dependence, and the sifted bit string is secure. It is simple to\nimplement as the detectors are free-running.\nAlgDeactivate\nIn this scheme, all detectors are actively disabled (or pulses actively blocked) every time any one of the\nfour detectors is hit [19]. This prevents any bit sifting unless all detectors are active. Again, the basis\ndependence is removed, and the algorithm is secure. The maximum key rate achievable is 1/(2\uf074); the\nfactor of 1/\uf074 comes from the maximum count rate of the individual detectors, and the factor of 1/2 comes\nfrom the fact Alice and Bob only use the right basis half the time. As this scheme involves the active\ndisablement of all detectors, it requires an active component for its implementation.\nAlg4state\nThis scheme [26,27] is different from all other considered above in that it requires only two detectors.\nConsider the phase-encoded BB84 version of this design. (This is more practical compared to the\npolarization-encoded version of this design as high-speed phase modulators are readily available). Bob\nactively selects the measurement basis for each incoming pulse. In addition, he determines which of the\ntwo detectors represents which bit value (0 or 1) for each pulse, by randomly selecting the phase\n9\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nmodulation from a set of four values (0, \u03c0/2, \u03c0, 3\u03c0/2) instead of the usual two (0, \u03c0/2). A diagram\nrepresenting the detection system is shown below in figure 5.\n\nFigure 5. Schematic diagram of the detection system for phase-encoded version of Alg4state. BS =\nbeamsplitter, PM = phase modulator, det 1 and det 2 = detectors 1 and 2.\nAll detections for which Alice and Bob\u201fs bases match are sifted. As such, as k goes to infinity, it achieves\nthe highest sifted key rate of all the algorithms, equal to 1/\uf074. The disadvantage is that the scheme involves\nmore complicated modulation and requires extra random numbers.\n\nWe want to compare the sifted key rate achievable by these different algorithms. To derive the probability\nPa of a detection system being active for both AlgDeactivate and Alg4State, we follow the procedure\noutlined in section 3.\nFor AlgDeactivate, an active detection system constitutes all four detectors being active. The moment any\none of them fires, the detection system becomes passive. Pa(AlgDeactivate) is therefore simply given by:\n\nPa (AlgDeacti vate) \uf03d\n\n1\n,\n1 \uf02b (k \uf02d 1)\uf068\n\n(9)\n\nwhere \uf068 is the gain, defined by the probability of a click on any of the detectors given that the detection\nsystem is active.\nOnly those detection events where Alice and Bob used the same bases will contribute to the sifted key,\nwhich means half of the total detection events for BB84. The sifted bit rate for AlgDeactivate is therefore\ngiven by:\nR(AlgDeacti vate) \uf03d 1\u20442 (number of clicks per second) \uf03d 1\u20442 \uf072Pa (AlgDeacti vate) P(click | active)\n\n\uf03d 1\u20442 \uf072Pa (AlgDeacti vate)\uf068 .\n\n10\n\n(10)\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nNote that the idealized gain \uf068 is independently present in both the formula for Pa in (9) and the formula\nfor the sifted bit rate R in (10). Once we have an expression for Pa, we still need to account for channel\nloss to calculate the sifted bit rate R. Consider the simple example where \uf068 = 0 (all signals lost), so that Pa\n= 1, and R = 0.\nFor Alg4State, since all detections in which Alice and Bob choose the same basis are sifted, it is easiest to\nconsider the two detectors individually. An active detection system consists of a specific detector being\nactive. The situation is therefore completely analogous to the derivation in section 3, and Pa(Alg4State) is\nsimply given by:\n\nPa (Alg4State ) \uf03d\n\n1\n.\n1 \uf02b 0.5(k \uf02d 1)\uf068\n\n(11)\n\nwhere \uf068 is the gain, defined by the probability of a click of a specific detector. The sifted bit rate for\nAlg4State is given by combining the bit rate from each of these two detectors:\nR(Alg4State ) \uf03d 1\u20442 \uf072Pa (Alg4State )\uf068 .\n\n(12)\n\nThe factor of a half comes from three factors; 1/2 for Alice and Bob using the same basis in BB84, 1/2 to\naccount for the photon hitting the correct one of the two detectors in an individual detection system, and\nfinally a factor of 2 since there are effectively two independent detection systems. Again, we have to\ninclude the factor of \uf068 to account for channel loss when calculating the sifted bit rate.\nThe graph below (figure 6) shows the sifted key rate as a function of the transmission rate for the different\nalgorithms. The simulation results are based on the Monte Carlo method, while the theoretical formulas\nare derived above. Note that the theoretical values apply only at integer values of k.\n\n11\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nFigure 6. Comparison of key rates for different sifting algorithms. \uf068 = 0.5 (channel loss = 3 dB), dead\ntime \uf074 = 100 ns, detection efficiency \uf068D = 100%. The graph shows there is an optimum value for\ntransmission for AlgAllActive to achieve the maximum sifted key rate. AlgDeactivate gives a higher key\nrate than AlgAllActive for all values of k higher than 1. Alg4state gives a higher key rate than\nAlgDeactivate for all values of k higher than 1.\nThe graph shows that the three algorithms are equivalent in the low-speed regime up to k = 1 (10 MHz on\nthe graph since \uf074 = 100 ns). AlgDeactivate gives a higher key rate than AlgAllActive for all values of k\nabove 1. Alg4state gives a higher key rate than AlgDeactivate for all values of k above 1. The maximum\nkey rate using AlgAllActive is achieved by transmitting in the high-speed regime (at a value of k greater\nthan 1), but not too much (exact value of k depends on the dead time and channel loss).\nAlgDeactivate and Alg4state do not have a peak transmission rate, but instead tend towards a constant\nvalue, given by 1/(2\uf074) and 1/\uf074, respectively, as expected. There is no peak because in both cases the\ndetectors do not get locked up and so the detection system is not paralyzable.\n5. Decoy State BB84\nSo far we have considered a single photon source on Alice\u201fs side. Now we move onto a more realistic\nscenario which includes imperfections in the source and detectors.\nSingle photon sources are not yet practical for high speed QKD. So, weak coherent pulses (WCP) are\noften used. Using WCP as the source drastically reduces performance of BB84 due to multi-photon events\nwhich are susceptible to the photon number splitting attack [21].This has led to the development of the\n\n12\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\ndecoy state method [9-11], which allows for efficient performance even with an attenuated laser as the\nsource.\nIn decoy state BB84, Alice uses more than one photon number distribution. One of these photon number\ndistributions is optimized for the key rate. These events, called signals, constitute most of the pulses sent\nby Alice. She also sends events, called decoys, created with different linearly independent photon number\ndistributions. Since Alice knows which events belong to each distribution, Alice and Bob can measure the\ngains (overall probability of a photon detection event for incoming pulses) for each distribution\nindependently. This linear set of equations is used to ultimately calculate a lower bound on the key rate.\nCrucially, Eve must not be able to distinguish between n-photon events arising from different\ndistributions.\nDecoy state BB84 is now commonly used in practice after the initial experiments a few years ago [28-32].\nIt is interesting to analyze the security and performance of decoy state BB84 in the framework of finite\ndetector dead time. To mitigate the effects of dead time we consider using AlgDeactivate.\nIn section 4, we derived the probability Pa(AlgDeactivate) that a detection system is active for\nAlgDeactivate (all four detectors are active), and hence capable of sifting bits. It is given by (9). This\nderivation assumes a perfect source and detectors with no false counts. We can now adjust this to account\nfor WCP source with \uf06d being the average photon number per pulse, and other imperfections such as\nbackground rate Y0 (including dark counts and stray light).\nLet us for the moment ignore the effects of dead time and consider standard decoy state protocols. We\nwill return to the subject of dead time later. It is useful to define the following quantities [15]. The singlephoton gain Q1 (the joint probability that Bob\u201fs detector clicks, and that the triggering event was a singlephoton) is given by\nQ1 \uf03d Y1 \uf06de \uf02d \uf06d ,\n\n(13)\n\nwhere \uf06d is the average photon number per pulse and Y1 is the single-photon yield (the conditional\nprobability of a detection at Bob\u201fs side given that Alice sends a single-photon state), given by\nY1 \uf040 Y0 \uf02b \uf068 ,\n\n(14)\n\nwhere Y0 is the background count rate.\nThe overall gain Q\uf06d (overall detection probability summed over all individual gains) is given by\n\nQ\uf06d \uf03d Y0 \uf02b 1 \uf02d e \uf02d\uf068\uf06d .\n\n(15)\n\nThe overall quantum bit error rate (QBER) E\uf06d is given by\n\ne0Y0 \uf02b edet (1 \uf02d e \uf02d\uf068\uf06d )\n,\nE\uf06d \uf03d\nQ\uf06d\n13\n\n(16)\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nwhere e0 is the error of the background (taken to be 0.5) and edet is the probability that a photon triggered\nan erroneous detector (caused by e.g. optical misalignment).\nThe single-photon error rate e1 (error rate conditioned on single-photon events) is given by\n\ne1 \uf03d\n\ne0Y0 \uf02b edet\uf068\n.\nY1\n\n(17)\n\nLet us now return to the subject of dead time. We can now modify (9) by replacing \uf068 with Q\uf06d, to account\nfor WCP source and background rate Y0:\nPa (decoy) \uf03d\n\n1\n.\n1 \uf02b (k \uf02d 1)Q\uf06d\n\n(18)\n\nNote that Pa(decoy) goes to 0 as k goes to infinity. Provided that we consider the asymptotic limit of an\ninfinitely long key and the case where the fraction of states used as decoys is negligible, we can use the\nfollowing method to calculate the secure key rate of decoy BB84 with finite detector dead time:\n1) Calculate the na\u00efve key rate Rn by assuming dead time \uf074 = 0,\n2) Calculate the actual key rate R by simply multiplying the na\u00efve rate by Pa(decoy):\nR \uf03d Pa (decoy)Rn .\n\n(19)\n\nThe na\u00efve secure key rate Rn (in the asymptotic limit of an infinitely long key and without dead time) is\ngiven by [15]:\nRn \uf03d q{Q1[1 \uf02d H 2 (e1 )] \uf02d Q\uf06d f ( E \uf06d ) H 2 ( E \uf06d )} ,\n\n(20)\n\nwhere q depends on the implementation (taken to be 0.5 for the BB84 protocol due to the fact that Alice\nand Bob use different bases half the time), f(x) is the bi-directional error correction inefficiency (taken to\nbe 1.22) and H2(x) = \u2212xlog2x \u2212 (1 \u2212 x)log2(1 \u2212 x) is the binary Shannon entropy function.\nThe actual secure rate (per bit) with dead time is therefore given by:\nR \uf03d Pa (decoy) q{Q1[1 \uf02d H 2 (e1 )] \uf02d Q\uf06d f ( E \uf06d ) H 2 ( E \uf06d )} .\n\n(21)\n\nTogether with \u201eGYS\u201f parameters from an experiment in Ref. [33], we can calculate the lower bound on\nthe actual secure key rate using (21) above. Note that in the actual GYS experiment [33] the standard\nBB84 protocol was used with InGaAs avalanche photodiodes operating in gated mode, while the\ntransmission rate was just 2 MHz, so dead time effects were not significant. The value of \uf06d is taken to be\noptimized for the given parameters. All the simulation parameters are summarized in table 1.\n\n\uf074 (ns)\n\n\uf06d\n\n100ns\n\n0.48\n\nTable 1. Key parameters used in the simulation.\nedet\nY0\ne0\nl\n0.21\n50km\n0.033\n1.7 x 10-6\n0.5\n\n\uf061 (dB/km)\n\n14\n\n\uf068Bob\n0.045\n\nf\n1.22\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\nFigure 7 shows how the transmission rate affects the secure key rate both for standard decoy BB84\n(without dead time effects), and decoy BB84 with dead time effects accounted for with AlgDeactivate.\n\nFigure 7. Graph showing how increasing the transmission rate affects the secure key rate. The dashed\ngreen line shows the na\u00efve rate relation for standard decoy BB84, without any dead time effects taken into\naccount. The solid blue line shows the actual secure key rate achievable taking dead time effects into\naccount using AlgDeactivate.\nAt lower transmission rates, the two schemes yield the same secure key rate which scales linearly with\ntransmission rate as expected. The two start to deviate as dead time effects become important. The secure\nkey rate (per second) with the AlgDeactivate scheme (solid blue line) levels off as expected, and is given\nby:\n(22)\nR \uf03d \uf072Pa (decoy)Rn ,\nwhere \uf072 is the transmission rate. As \uf072 goes to infinity, the secure key rate R approaches the limiting value\nof Rn/\uf074Q\uf06d .\nIt should be noted that working with transmission rates of the order of 100 GHz might be problematic.\nWhile this high-speed phase modulation is already possible technologically (and QKD with clock rates of\n10 GHz has been demonstrated [34]), the timing jitter of current detectors would be a limiting factor for\nthe possible transmission rate. Even a small 50 ps jitter would limit the rate to approximately 10 GHz.\n\n15\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\n6. Conclusions\nSecurity concerns associated with detector dead times for QKD systems operating at transmission rates\nhigher than the maximum count rates of detectors (1/\uf074) can limit the production rate of sifted bits. Rogers\net al. [14] have proposed a sifting algorithm incorporating these dead time effects that is secure in the case\nwhere Eve is completely passive. Monte-Carlo simulations of a BB84-type QKD system with finite\ndetector dead times were performed and extended to include an active eavesdropper, capable of\ninterfering with the quantum channel. It was shown that the sifting algorithm proposed in Rogers et al.\u201fs\npaper [14] is susceptible to intercept-resend attacks by Eve and is no longer secure because Eve is able to\ninduce basis-dependent detector efficiency. The importance of detectors\u201f dead periods going out of sync\nwith each other and thus being incapable of sifting bits was highlighted. Modified sifting schemes\n(AlgAllActive, AlgDeactivate and Alg4State) were analyzed and compared. It was shown that a modified\nsifting algorithm that is secure \u2013 which sifts a bit only when all four detectors are active(AlgAllActive) \u2013\nis worse in terms of maximum sifted key rate than a scheme in which all four detectors are disabled when\nany one of them fires (AlgDeactivate). The advantage of AlgAllActive is that it does not require any\nactive components. The four-state protocol (Alg4state) with two detectors still achieves the highest key\nrate (1/\uf074) but requires more complicated modulation and extra random numbers.\nThe security analysis was extended to the decoy-state BB84 protocol, and the secure key generation rate\nanalyzed in the context of finite detector dead time.\nAs detectors and detection techniques improve, detector dead time is expected to be significantly reduced.\nCommercial Si-based products can achieve a dead time of 45 ns around 800 nm [35]. A dead time of just\n1.93 ns has recently been reported with InGaAs detectors [36]. However, the dead time problem is still\nimportant to consider as the dead time could also be due to electronics in components such as the time\ninterval analyzer (TIA) [37]. The effect of detector dead time on the security of the differential phase shift\nprotocol [38] has also been analyzed [39].\nFuture directions could include a more realistic detector dead time model, including a gradual recovery to\nmaximum efficiency, dark counts and afterpulsing. Ignoring double click events, security can still be\nproved for a gradual recovery [40] with, for example, Alg4state. The dead time of different detectors\nwould also not be the same in practice. Eve\u201fs ability to control the dead time to her advantage could open\nup new avenues for attack.\nThe important lesson here is the need to check carefully the operations of components of a QKD system\n(in this case the detection system) and make sure that it is properly described by the security model.\nAcknowledgements\nSupport of the funding agencies CIFAR, CIPI, Connaught, CRC, MITACS, NSERC, QuantumWorks and\nthe University of Toronto is gratefully acknowledged.\nReferences\n1. Bennett C H and Brassard G 1984 Quantum cryptography: public key distribution and coin tossing Proc. IEEE\nInt. Conf. on Computers (Bangalore, India)\n2. Ekert A 1991 Quantum cryptography based on Bell\u201fs theorem Phys. Rev. Lett. 67 661-3\n3. Gisin N, Ribordy G, Tittel W and Zbinden H 2002 Quantum cryptography Rev. Mod. Phys. 74 145-95\n4. Lo H-K and Zhao Y 2009 Quantum cryptography Enc. of Complexity and Systems Science 8 7265-89 (New York:\nSpringer)\n\n16\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\n5. Scarani V, Bechmann-Pasquinucci H, Cerf N J, Dusek M, Lutkenhaus N and Peev M 2009 The security of\npractical quantum key distribution Rev. Mod. Phys. 81 1301-50\n6. Mayers D 2001 Unconditional security in quantum cryptography J. ACM 48 351-406\n7. Lo H-K and Chau H 1999 Unconditional security of quantum key distribution over arbitrarily long distances\nScience 283 2050-6\n8. Shor P and Preskill J 2000 Simple proof of security of the BB84 quantum key distribution protocol Phys. Rev.\nLett. 85 441-4\n9. Hwang W Y 2003 Quantum key distribution with high loss: towards global secure communication Phys. Rev.\nLett. 91 057901\n10. Lo H-K, Ma X and Chen K 2005 Decoy state quantum key distribution Phys. Rev. Lett. 94 230504\n11. Wang X B 2005 Beating the photon-number-splitting attack in practical quantum cryptography Phys. Rev.\nLett. 94 230503\n12. Zhang Q et al. 2009 Megabits secure key rate quantum key distribution New J. Phys. 11 045010\n13. Dixon A R, Yuan Z L, Dynes J F, Sharpe A W and Shields A J 2008 Gigahertz decoy quantum key distribution\nwith 1 Mbit/s secure key rate Opt. Express 16 18790-7\n14. Rogers D J, Bienfang J C, Nakassis A, Xu H and Clark C W 2007 Detector dead-time effects and paralyzability\nin high-speed quantum key distribution New J. Phys. 9 319\n15. Ma X, Qi B, Zhao Y and Lo H-K 2005 Practical decoy state for quantum key distribution Phys. Rev. A 72\n012326\n16. Ghioni M, Giudice A, Cova S and Zappa F 2003 High-rate quantum key distribution at short wavelength:\nperformance analysis and evaluation of silicon single photon avalanche diodes J. Mod. Opt. 50 2251-69\n17. Hobel M and Ricka J 1994 Dead-time and afterpulsing correction in multiphoton timing with nonideal detectors\nRev. Sci. Instrum. 65 2326-36\n18. Knoll G F 1979 Radiation Detection and Measurement (New York: Wiley)\n19. Xu H, Ma L, Bienfang J C and Tang X 2006 Influence of avalanche-photodiode dead time on the security of\nhigh-speed quantum-key distribution system CLEO/QELS 2006 (San Jose, CA, USA)\n20. Inamori H, Lutkenhaus N and Mayers D 2007 Unconditional security of practical quantum key distribution Eur.\nPhys. J. D 41 599-627\n21. Gottesman D, Lo H-K, Lutkenhaus N and Preskill J 2004 Security of quantum key distribution with imperfect\ndevices Quantum Inform. Comput. 4 325-60\n22. Koashi M 2006 Unconditional security proof of quantum key distribution and the uncertainty principle J. Phys.\nConf. Ser. 36 98 (Preprint quant-ph/0505108)\n23. Makarov V, Anisimov A and Skaar J 2006 Effects of detector efficiency mismatch on security of quantum\ncryptosystems Phys. Rev. A 74 022313\n24. Qi B, Fung C-H F, Lo H-K and Ma X 2007 Time-shift attack in practical quantum cryptosystems Quantum\nInform. Comput 7 73-82\n25. Zhao Y, Fung C-H F, Qi B, Chen C and Lo H-K 2008 Experimental demonstration of time-shift attack against\npractical quantum key distribution systems Phys. Rev. A 78 042333\n26. Nielsen P M, Schori C, Sorensen J L, Salvail L, Damgard I and Polzik E 2001 Experimental quantum key\ndistribution with proven security against realistic attacks J. Mod. Opt. 48 1921-42\n27. LaGasse M J 2005 Secure use of a single single-photon detector in a QKD system US patent application\n20050190922\n28. Zhao Y, Qi B, Ma X, Lo H-K and Qian L 2006 Experimental quantum key distribution with decoy states Phys.\nRev. Lett. 96 070502\n29. Zhao Y, Qi B, Ma X, Lo H-K and Qian L 2006 Simulation and implementation of decoy state quantum key\ndistribution over 60km telecom fiber Proc. IEEE ISIT 2094-8\n30. Schmitt-Manderbach T et al. 2007 Experimental demonstration of free-space decoy-state quantum key\ndistribution over 144km Phys. Rev. Lett. 98 010504\n31. Rosenberg D, Harrington J W, Rice P R, Hiskett P A, Peterson C G, Hughes R J, Lita A E, Nam S W and\nNordholt J E 2007 Long-distance decoy-state quantum key distribution in optical fiber Phys. Rev. Lett. 98 010503\n32. Dynes J F, Yuan Z L, Sharpe A W and Shields A J 2007 Practical quantum key distribution over 60 hours at an\noptical fiber distance of 20km using weak and vacuum decoy pulses for enhanced security Opt. Express 15 8465-71\n33. Gobby C, Yuan Z L and Shields A J 2004 Quantum key distribution over 122km of standard telecom fibre Appl.\nPhys. Lett. 84 3762-4\n\n17\n\n\fSecurity of high speed quantum key distribution with finite detector dead time\n\n34. Takesue H, Nam S W, Zhang Q, Hadfield R H, Honjo T, Tamaki K and Yamamoto Y 2007 Quantum key\ndistribution over a 40-dB channel loss using superconducting single-photon detectors Nature Photon. 1 343-8\n35. http://www.idquantique.com/Scientific-Instrumentation/id100-series-single-photon.html\n36. Dixon A R, Dynes J F, Yuan Z L, Sharpe A W, Bennett A J and Shields A J 2009 Ultrashort dead time of\nphoton-counting InGaAs avalanche photodiodes Appl. Phys. Lett. 94 231113\n37. Private communication with Zhao Y\n38. Inoue K, Waks E and Yamamoto Y 2002 Differential phase shift quantum key distribution Phys. Rev. Lett. 89\n037902\n39. Curty M, Tamaki K and Moroder T 2008 Effect of detector dead times on the security evaluation of differentialphase-shift quantum key distribution against sequential attacks Phys. Rev. A 77 052321\n40. Fung C-H F, Tamaki K, Qi B, Lo H-K and Ma X 2009 Security proof of quantum key distribution with detection\nefficiency mismatch Quantum Inform. Comput. 9 0131-65\n\n18\n\n\f"}