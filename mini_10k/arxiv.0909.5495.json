{"id": "http://arxiv.org/abs/0909.5495v1", "guidislink": true, "updated": "2009-09-30T04:54:34Z", "updated_parsed": [2009, 9, 30, 4, 54, 34, 2, 273, 0], "published": "2009-09-30T04:54:34Z", "published_parsed": [2009, 9, 30, 4, 54, 34, 2, 273, 0], "title": "Electronic damping of molecular motion at metal surfaces", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.3555%2C0909.5281%2C0909.4619%2C0909.4914%2C0909.4424%2C0909.2215%2C0909.4322%2C0909.0219%2C0909.5043%2C0909.0134%2C0909.0373%2C0909.4207%2C0909.1179%2C0909.5362%2C0909.1336%2C0909.4966%2C0909.0790%2C0909.0483%2C0909.1467%2C0909.5136%2C0909.4103%2C0909.2088%2C0909.2017%2C0909.0791%2C0909.4697%2C0909.2871%2C0909.0093%2C0909.5381%2C0909.1103%2C0909.3841%2C0909.2485%2C0909.4944%2C0909.2577%2C0909.1178%2C0909.2688%2C0909.0223%2C0909.1990%2C0909.1394%2C0909.5174%2C0909.5007%2C0909.3510%2C0909.5390%2C0909.4840%2C0909.0050%2C0909.4927%2C0909.3272%2C0909.3757%2C0909.5336%2C0909.3248%2C0909.3470%2C0909.2047%2C0909.0924%2C0909.1450%2C0909.0119%2C0909.2006%2C0909.2484%2C0909.4828%2C0909.3968%2C0909.5433%2C0909.1095%2C0909.0171%2C0909.3504%2C0909.0901%2C0909.4810%2C0909.2569%2C0909.4320%2C0909.5512%2C0909.5423%2C0909.1473%2C0909.0423%2C0909.0335%2C0909.2341%2C0909.4362%2C0909.4653%2C0909.3101%2C0909.5636%2C0909.4667%2C0909.0699%2C0909.0392%2C0909.2967%2C0909.1761%2C0909.0350%2C0909.3348%2C0909.1588%2C0909.2933%2C0909.0891%2C0909.4021%2C0909.4461%2C0909.1027%2C0909.4091%2C0909.2163%2C0909.0104%2C0909.3279%2C0909.5204%2C0909.3261%2C0909.5003%2C0909.2245%2C0909.5495%2C0909.0870%2C0909.3542%2C0909.1105&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Electronic damping of molecular motion at metal surfaces"}, "summary": "A method for the calculation of the damping rate due to electron-hole pair\nexcitation for atomic and molecular motion at metal surfaces is presented. The\ntheoretical basis is provided by Time Dependent Density Functional Theory\n(TDDFT) in the quasi-static limit and calculations are performed within a\nstandard plane-wave, pseudopotential framework. The artificial periodicity\nintroduced by using a super-cell geometry is removed to derive results for the\nmotion of an isolated atom or molecule, rather than for the coherent motion of\nan ordered over-layer. The algorithm is implemented in parallel, distributed\nacross both ${\\bf k}$ and ${\\bf g}$ space, and in a form compatible with the\nCASTEP code. Test results for the damping of the motion of hydrogen atoms above\nthe Cu(111) surface are presented.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.3555%2C0909.5281%2C0909.4619%2C0909.4914%2C0909.4424%2C0909.2215%2C0909.4322%2C0909.0219%2C0909.5043%2C0909.0134%2C0909.0373%2C0909.4207%2C0909.1179%2C0909.5362%2C0909.1336%2C0909.4966%2C0909.0790%2C0909.0483%2C0909.1467%2C0909.5136%2C0909.4103%2C0909.2088%2C0909.2017%2C0909.0791%2C0909.4697%2C0909.2871%2C0909.0093%2C0909.5381%2C0909.1103%2C0909.3841%2C0909.2485%2C0909.4944%2C0909.2577%2C0909.1178%2C0909.2688%2C0909.0223%2C0909.1990%2C0909.1394%2C0909.5174%2C0909.5007%2C0909.3510%2C0909.5390%2C0909.4840%2C0909.0050%2C0909.4927%2C0909.3272%2C0909.3757%2C0909.5336%2C0909.3248%2C0909.3470%2C0909.2047%2C0909.0924%2C0909.1450%2C0909.0119%2C0909.2006%2C0909.2484%2C0909.4828%2C0909.3968%2C0909.5433%2C0909.1095%2C0909.0171%2C0909.3504%2C0909.0901%2C0909.4810%2C0909.2569%2C0909.4320%2C0909.5512%2C0909.5423%2C0909.1473%2C0909.0423%2C0909.0335%2C0909.2341%2C0909.4362%2C0909.4653%2C0909.3101%2C0909.5636%2C0909.4667%2C0909.0699%2C0909.0392%2C0909.2967%2C0909.1761%2C0909.0350%2C0909.3348%2C0909.1588%2C0909.2933%2C0909.0891%2C0909.4021%2C0909.4461%2C0909.1027%2C0909.4091%2C0909.2163%2C0909.0104%2C0909.3279%2C0909.5204%2C0909.3261%2C0909.5003%2C0909.2245%2C0909.5495%2C0909.0870%2C0909.3542%2C0909.1105&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A method for the calculation of the damping rate due to electron-hole pair\nexcitation for atomic and molecular motion at metal surfaces is presented. The\ntheoretical basis is provided by Time Dependent Density Functional Theory\n(TDDFT) in the quasi-static limit and calculations are performed within a\nstandard plane-wave, pseudopotential framework. The artificial periodicity\nintroduced by using a super-cell geometry is removed to derive results for the\nmotion of an isolated atom or molecule, rather than for the coherent motion of\nan ordered over-layer. The algorithm is implemented in parallel, distributed\nacross both ${\\bf k}$ and ${\\bf g}$ space, and in a form compatible with the\nCASTEP code. Test results for the damping of the motion of hydrogen atoms above\nthe Cu(111) surface are presented."}, "authors": ["J. R. Trail", "M. C. Graham", "D. M. Bird"], "author_detail": {"name": "D. M. Bird"}, "author": "D. M. Bird", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/S0010-4655(01)00177-1", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0909.5495v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0909.5495v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "10 pages, 3 figures", "arxiv_primary_category": {"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.mtrl-sci", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0909.5495v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0909.5495v1", "journal_reference": "Comp. Phys. Comm. 137, 163 (2001)", "doi": "10.1016/S0010-4655(01)00177-1", "fulltext": "Electronic damping of molecular motion at metal surfaces\nJ. R. Trail,\u2217 M. C. Graham, and D. M. Bird\n\narXiv:0909.5495v1 [physics.comp-ph] 30 Sep 2009\n\nDepartment of Physics, University of Bath, Bath BA2 7AY, UK\n(Dated: January, 2001)\nA method for the calculation of the damping rate due to electron-hole pair excitation for atomic\nand molecular motion at metal surfaces is presented. The theoretical basis is provided by Time\nDependent Density Functional Theory (TDDFT) in the quasi-static limit and calculations are performed within a standard plane-wave, pseudopotential framework. The artificial periodicity introduced by using a super-cell geometry is removed to derive results for the motion of an isolated\natom or molecule, rather than for the coherent motion of an ordered over-layer. The algorithm is\nimplemented in parallel, distributed across both k and g space, and in a form compatible with the\nCASTEP code. Test results for the damping of the motion of hydrogen atoms above the Cu(111)\nsurface are presented.\nPACS numbers: 34.50.Dy, 79.20.Rf, 82.65.Pa, 71.15.Ap\n\nI.\n\nINTRODUCTION\n\nConsiderable progress has been made in recent years in understanding the fundamental processes involved in gassurface interactions. This has been based on the parallel developments of large-scale electronic structure calculations\nbased on density functional theory, combined with multi-dimensional quantum and classical analysis of the dynamics\n[1]. Despite these advances there remains one key area that is still largely unexplored and poorly understood; the\nprocess of energy dissipation into substrate degrees of freedom. Although this is known to be of central importance\nin many situations [2], there exist no 'real' calculations to date for the energy loss to either phonons or electrons in\nthe surface.\nIn particular there have been a number of recent experiments that have shown convincing evidence that energy\ndissipation by the creation of electron-hole pairs is a significant effect in gas-surface dynamics. Gostein et al [3]\ncarried out a detailed state-to-state analysis of H2 scattering from Pd(111) and showed that, for example, in the\nvibrational relaxation of (\u03bd = 1, J = 1) to (\u03bd = 0, J = 5) an average of 120 meV is lost to the substrate during\nthe scattering event, presumably to electron-hole pair formation. Nienhaus and co-workers [4] measured directly the\nhot electrons and holes created at Ag and Cu surfaces by the adsorption of thermal hydrogen and deuterium in the\nform of 'chemicurrents' in a Schottky diode. Finally, Huang et al [5] have studied NO scattering from Au(111) and\nhave concluded that the main sink of energy for the vibrational relaxation of \u03bd = 2 molecules is the surface, with the\nstrong dependence of the de-excitation probability on incident energy providing evidence that an electron-hole pair\nmechanism is the dominant factor.\nWe carry out a calculation of the ground state properties of an interacting surface/molecule system using a planewave basis and a super-cell geometry, and use these results to evaluate the friction coefficient associated with the\nmotion of a molecule at a chosen position and in a direction of choice. This is achieved using the well established\n'Golden Rule' expression [6, 7, 8] that may be obtained by applying Time Dependent Density Functional Theory\n(TDDFT) together with a quasi-static limit [7], or less stringently by applying the Golden Rule directly to the\navailable Kohn-Sham states [6]. Essentially the theory is as described by Hellsing and Persson [7] or Liebsch [8]. The\nsuper-cell method has the advantage that it retains the continuous spectrum of one-electron excitations, unlike cluster\nmodels [9], and this is important for the interactions considered here. In first principles calculations of moleculesurface systems a super-cell of sufficient size is usually chosen to prevent any significant interaction between the\nadsorbates in neighbouring super-cells. When considering electron-hole pair excitation a slightly more subtle effect\nmust be taken into account, arising from the enforced periodicity of the perturbation that produces the electron-hole\npairs. We are primarily interested in the energy loss by electron-hole pair excitation due to the motion of an isolated\nmolecule interacting with the surface, whereas the super-cell geometry will naturally describe the damping of an\nordered over-layer. For the periodic system, conservation of crystal momentum prevents transitions occurring that\nwill occur for an isolated molecule interacting with the surface. Results for an isolated molecule are derived from the\n\n\u2217 Electronic\n\naddress: jrt32@cam.ac.uk\n\n\f2\navailable periodic perturbation, and a significant difference is found between the energy loss behaviour of the periodic\nand isolated systems.\nTo test our method we investigate the friction coefficient of an H atom above the hcp hollow site of a Cu(111) surface.\nSpin is included explicitly in the Kohn-Sham theory using the gradient corrected local spin density approximation for\nexchange-correlation (LSDA-GC). In the next section the evaluation of the dynamic self-energy and friction coefficient\nfrom Kohn-Sham results using a plane-wave basis is described. In section III the implementation of this as a parallel\nalgorithm is described, along with a brief description of the performance of the algorithm. Results for H/Cu(111) are\ndiscussed in section IV, and section V is the conclusion.\nII.\n\nTHEORY\n\nThe experimentally measurable energy loss spectrum for a particular mode is directly related to the dynamic selfenergy, \u039b(\u03c9). Since we are interested in the energy loss, the imaginary part of this self-energy is the required quantity\nand this can be expressed using [7]\n2\n\u2032\n2\u03c0e2 X X\nh\u03c8kn |\u03c6eff (r, \u03c9)|\u03c8kn\u2032 i\nM\nk,k\u2032 n,n\u2032\n\u0010\n\u0011\n\u2032\n\u2032\n\u00d7 f (\u01ebnk ) \u2212 f (\u01ebnk\u2032 ) \u03b4(~\u03c9 \u2212 \u01ebnk + \u01ebnk\u2032 )\n\nIm \u039b(\u03c9) =\n\n(1)\n\nwhere \u03c8kn and \u01ebnk are the Kohn-Sham wavefunctions and energies resulting from a density-functional description of\nthe ground state, and f (\u01eb) is the Fermi-Dirac occupation function. Spin degeneracy is assumed in Eq. (1), hence the\nfactor of 2; the extension to spin polarised systems is straightforward. The effective field, \u03c6eff , is the TDDFT effective\nfield with contributions from the field of the displaced nuclei, the Coulomb field of the induced charge density and\na contribution from exchange-correlation. Equation (1) can be derived by direct application of the Golden-Rule and\na single electron approximation [6], or through TDDFT with the assumption of a slow time-dependent perturbation\n(see [7] and [10] for more clarification of the role of TDDFT).\nEquation (1) provides the rate of energy loss of a mode of frequency \u03c9 due to the excitation of electron-hole pairs\nas \u03c4 \u22121 = Im \u039b(\u03c9)/\u03c9. Taking the quasi-static limit \u03c9 \u2192 0 results in the rate of energy loss for the motion of the atom,\nand this can be expressed as the friction coefficient \u03b7 defined via the standard Langevin equation. For motion in the\ndirection \u0125, \u03b7 is given by (see Hellsing and Persson [7], or Plihal and Langreth [11])\n\u03b7=\n= 2\u03c0~\n\nM lim\u03c9\u21920 Im \u039b(\u03c9)/\u03c9\nP\n\nk,k\u2032\n\nP\n\nn,n\u2032\n\n\u2032\n\n2\n\n\u2032\n\nh\u03c8kn |\u0125.\u2207V |\u03c8kn\u2032 i \u03b4(\u01ebF \u2212 \u01ebnk )\u03b4(\u01ebF \u2212 \u01ebnk\u2032 )\n\n(2)\n\nwhere \u01ebF is the Fermi energy, M is the mass of the molecule, and \u0125.\u2207V is the static limit of \u2212e\u03c6eff given by the\nderivative of the Kohn-Sham self-consistent potential in the direction \u0125.\nEquation (2) is evaluated using wavefunctions of the form\n1 X n\n\u03c8kn (r) = unk eik.r = \u221a\nC (k)ei(k+g).r\nV0 g g\n\n(3)\n\nwhere V0 is the volume of the super-cell, and only the wavefunctions sampled at a finite number of k points in the\nirreducible wedge of the Brillouin Zone are available. The change in the Kohn-Sham potential due to the motion of\nan isolated atom is not directly available from a super-cell calculation, but we can obtain the change due the motion\nKS\nof a periodic lattice of atoms, \u03b4Vlattice\n, as a finite difference.\nA.\n\nObtaining the interaction of an isolated molecule from that of an over-layer\n\nTo calculate the dynamic interaction of an isolated molecule with a surface within a super-cell geometry care must\nbe taken with the interpretation of Eq. (1). If \u0125.\u2207V is obtained directly as a periodic function, drastic consequences\nresult - the integral becomes zero for k 6= k\u2032 . This is due to the super-cell geometry enforcing a conservation of crystal\nmomentum that would be correct for describing the interaction of a real over-layer of molecules in coherent motion,\nbut is not physically realistic for the aperiodic single molecule/surface system that concerns us here. In light of this\nKS\nwe must obtain the change in the Kohn-Sham potential due to the motion of an isolated molecule, \u03b4Visolated\n, from\n\n\f3\nKS\nthe change due to the coherent motion of an over-layer, \u03b4Vlattice\n. The relationship between the two can be found by\napplying linear response theory [12]. Although the theory is given here for a local pseudopotential, the generalisation\nto non-local pseudopotentials is straightforward.\nWe begin by considering the change in the total pseudopotential, \u03b4\u03c6(r), due to an infinitesimal change in the\nposition of the atom in each super-cell, \u03b4ux (l). With the pseudopotential due to an atom at x denoted Vpseudo (r \u2212 x)\nthis takes the form\nX\n\u03b4\u03c6(r) =\n\u2207Vpseudo (r \u2212 x \u2212 l).\u03b4ux (l),\n(4)\nl\n\nwhere l is a lattice vector. The change in the Kohn-Sham potential can be obtained from \u03b4\u03c6 via the static inverse\n\u2032\ndielectric function, \u01eb\u22121\nKS (r, r ) that corresponds to the original Kohn-Sham calculation [13]. This gives\nZ\nKS\n\u2032\n\u2032 3 \u2032\n\u03b4Vlattice\n(r) = \u01eb\u22121\n(5)\nKS (r, r )\u03b4\u03c6(r )d r\nor\nKS\n\u03b4Vlattice\n(r) =\n\nX\n\nRx (r, l).\u03b4ux (l)\n\n(6)\n\nl\n\nwhere\nRx (r, l) =\n\nZ\n\n\u2032\n\u2032\n3 \u2032\n\u01eb\u22121\nKS (r, r )\u2207Vpseudo (r \u2212 x \u2212 l)d r\n\n(7)\n\nis the derivative of the Kohn-Sham potential with respect to the change in the position of an atom at x + l.\nKS\n(r), the change in the Kohn-Sham potential due to the change in the\nFor an isolated atom we require \u03b4Visolated\n\u2032\nposition of an atom at x. The formally correct way to obtain this is to obtain \u01eb\u22121\nKS (r, r ) from the original DFT\ncalculation (for an example of this type of calculation see Godby et al [14]), obtain Rx (r, l), and use this to evaluate\nKS\n\u03b4Visolated\n(r) = Rx (r, 0).\u03b4ux (0).\n\n(8)\n\nHowever, provided Rx (r, l) is well localised around the site of the perturbed atom such that there is little overlap\nbetween the responses to the motion of atoms in adjacent unit cells we may take\nX\nKS\n\u03b4Visolated\n(r) \u2248 \u0398(r)\nRx (r, l).\u03b4ux (l)\n(9)\nl\n\nKS\n\u2248 \u0398(r)\u03b4Vlattice\n(r)\n\nwhere \u0398(r) = 1 within a Wigner-Seitz cell centred on the perturbed atom, and is zero elsewhere.\nFrom the super-cell calculation the Kohn-Sham potential for the atom at x \u00b1 h is evaluated to obtain \u0125.\u2207V as\nKS\n\u03b4Visolated\n\u03b4|ux (0)|\n\u0001\n\u0398(r)\nKS\nKS\n[Vlattice\n\u2212 \u01ebF ]x+h \u2212 [Vlattice\n\u2212 \u01ebF ]x\u2212h\n\u2248\n2|h|\n\n\u0125.\u2207V =\n\n(10)\n\nwhere the variation of the zero of the Kohn-Sham potential has been corrected for using the Fermi energy associated\nwith the self-consistent results for each atomic position.\nEquation (10) will be accurate providing the response is isolated within the Wigner-Seitz cell centred on the\nKS\nperturbed atom (or, equivalently, Vlattice\n(r) is negligible at the border of this Wigner-Seitz cell), and |h| is small\nenough. In practice Eq. (10) corresponds to reducing the volume of integration in Eq. (1) from the entire lattice to\none Wigner-Seitz cell. In section IV the consequences of considering the motion of an isolated atom, as described above,\nare investigated by comparing results with those obtained by treating the motion as that of an ordered over-layer of\natoms.\nB.\n\nEvaluation for a plane-wave basis\n\nA plane-wave calculation results in a set of Kohn-Sham states on a finite grid (in real space or reciprocal space)\nsampled at a finite number of k points and for a finite number of bands, hence we must obtain the discrete equivalent\n\n\f4\nof Eq. (2) to evaluate \u03b7. It is also desirable to apply the space-group symmetry to reduce the number of k points\nthat must be considered. This is achieved as follows.\nFirst Eq. (1) is discretised using a uniform grid of k points throughout the 1st Brillouin Zone, and a conventional\nsmearing function\nIm \u039b(\u03c9) =\n\n2\n\u2032\n2\u03c0e2 1 X X\nh\u03c8kn |\u03c6eff (r, \u03c9)|\u03c8kn\u2032 i\n2\nM N\nk,k\u2032 n,n\u2032\n\u0010\n\u0011\n\u2032\n\u2032\n\u00d7 f (\u01ebnk ) \u2212 f (\u01ebnk\u2032 ) \u03b4\u0303(~\u03c9 \u2212 \u01ebnk + \u01ebnk\u2032 )\n\n(11)\n\nwhere N is the number of k points, f (\u01eb) is the Fermi-Dirac occupation function, and \u2212\u03b4\u0303(x) is the derivative of the\n'squashed Fermi-Dirac' [15] function used for occupation numbers in the original Kohn-Sham calculation. \u03b4\u0303(x) is\ngiven by\n\u0013\n\u0012\nq\n1 y\n1\n1 |x|\n1\n\u03b4\u0303(x) =\nexp\n\u2212 y2 , y = \u2206\n+\n(12)\nt\n2\n\u2206t\n2\np\nwhere \u2206 is an energy parameter describing the width of the function, and t = \u03c0/2.\nTo obtain \u03b7 we take lim\u03c9\u21920 Im \u039b(\u03c9)/\u03c9, resulting in\n\u03b7 = 2\u03c0~\n\n\u0011\n2\u0010\n\u2032\n1 XX\nn\nn\u2032\nn\nn\u2032\nf\n(\u01eb\n)\n\u2212\nf\n(\u01eb\n)\nh\u03c8\n|\n\u0125.\u2207V\n|\u03c8\ni\n\u03b4\u0303 \u2032 (\u01ebnk \u2212 \u01ebnk\u2032 )\n\u2032\n\u2032\nk\nk\nk\nk\n2\nN\n\u2032\n\u2032\n\n(13)\n\nk,k n,n\n\nwhere \u2212\u03b4\u0303 \u2032 (x) is the 2nd derivative of the 'squashed Fermi-Dirac' function, and we have taken the static limit of \u03c6eff .\nEquation (13) reduces to Eq. (2) in the zero temperature and continuum limit. It is important to note that Eq. (2)\ncannot be directly discretised by replacing the \u03b4(x) functions with \u03b4\u0303(x) as this corresponds to taking the continuum\nand zero temperature limits before discretisation. This would result in the inclusion of a contribution to \u03b7 from\ntransitions that should not be present (such as from a state to itself).\nNext we reduce the k points that must be considered to those within the irreducible wedge of the Brillouin Zone\nusing the space-group of the lattice. Since the set of k points possess point group symmetry Eq. (13) immediately\ntakes the form\n\u03b7 = 2\u03c0~\n\nIW\n\u0011\n2\u0010\n1 XXX\nn\nn\u2032\nn\nn\u2032\n)\n\u2212\nf\n(\u01eb\nf\n(\u01eb\n)\nh\u03c8\n|\n\u0125.\u2207V\n|\u03c8\ni\n\u2032\n\u2032\n\u2032\nk\nk\nPk\nP k\nNS2\n\u2032\n\u2032\n\u2032\nS,S k,k n,n\n\n\u2032\n\n\u00d7\u03b4\u0303 \u2032 (\u01ebnk \u2212 \u01ebnk\u2032 )wk wk\u2032\n\n(14)\n\nwhere IW denotes a sum over points in the irreducible wedge, and S,S \u2032 are space-group operators composed of a\nunitary transformation, P , and a non-symmorphic translation, w. The number of operators in the space-group is\ndenoted by NS , and wk = Nk /N where Nk is the number of distinct k points in the entire Brillouin Zone created\nby applying the complete set of NS space group operators to the point k in the irreducible wedge. There are no\nsymmetry operators associated with the eigenvalues since \u01ebnk = \u01ebnP k . Transforming the integrand in real space by S \u2032\u22121\nand using the identity [16]\nS\u03c8kn (r) = \u03c8kn (P r + w) = \u03c8Pn k (r)\n\n(15)\n\nresults in\n\u03b7 = 2\u03c0~\n\nIW\n\u0011\n2\u0010\n\u2032\n\u2032\n1 XXX\nf (\u01ebnk ) \u2212 f (\u01ebnk\u2032 )\nh\u03c8Pn k |\u0125.\u2207V |\u03c8kn\u2032 i\nNS\n\u2032\n\u2032\nS k,k n,n\n\n\u2032\n\n\u00d7\u03b4\u0303 \u2032 (\u01ebnk \u2212 \u01ebnk\u2032 )wk wk\u2032\n\n(16)\n\nwhere repeated sums over the same operator are removed and \u0125.\u2207V is required to possess the space-group symmetry\ncorresponding to the available k points. This requirement means that the original Kohn-Sham calculations must be\nperformed with symmetry low enough to allow the motion of the atom in the direction we are interested in, even\nif the instantaneous position of the atom\ncorresponds\nsymmetry. In practise we also only calculate the\n\u0010\n\u0011 to a higher\n\u2032\n\u2032\nquantities within the sum where the f (\u01ebnk ) \u2212 f (\u01ebnk\u2032 ) \u03b4\u0303 \u2032 (\u01ebnk \u2212 \u01ebnk\u2032 ) factor is greater than some small value, preventing\n\n\f5\n\nai\n\nO\n\nFIG. 1: For an atom at O integration must be performed over the Wigner-Seitz unit cell centred at O (dashed line). For the\nparallelogram (which represents the originally chosen unit cell) the function \u0125.\u2207V is not localised within the unit cell, and\ndoes not possess space-group symmetry.\n\nthe cost of calculating matrix elements that make negligible contribution to \u03b7 and limiting the sum to a finite number\nof bands.\nFor the the motion of an over-layer of atoms, where \u0125.\u2207V is periodic, a similar treatment results in\n\u03b7k=k\u2032 = 2\u03c0~\n\nIW X\nX\nk n,n\u2032\n\n\u2032\n\nh\u03c8kn |\u0125.\u2207V |\u03c8kn i\n\n2\n\n\u0010\n\u0011\n\u2032\n\u2032\nf (\u01ebnk ) \u2212 f (\u01ebnk ) \u03b4\u0303 \u2032 (\u01ebnk \u2212 \u01ebnk )wk\n\n(17)\n\nwhere only k = k\u2032 transitions contribute.\nIn order to obtain the matrix elements we require the Kohn-Sham states corresponding to the images of the\navailable k points under transformation by a point group operator, \u03c8Pn k . Transforming \u03c8kn in reciprocal space gives\nus the coefficients of each \u03c8Pn k , and this is achieved by applying Eq. (15) to Eq. (3) and projecting out the required\ncoefficients to give\nCgn (P k) = CPn \u22121 g (k)e\u2212i(P k+g).w .\n\n(18)\n\nThe wavefunctions in real space are then obtained using a FFT\nunk = FFT[Cgn (k)]\n\n(19)\n\nand the required integrals are evaluated as sums over a unit cell (this is analytically correct for a plane-wave basis).\nThis cell must be chosen such that \u0125.\u2207V is negligible at its borders and such that the 'truncated' potential possesses\nthe correct space-group symmetry. As mentioned previously the ideal choice is a Wigner-Seitz cell centred at the\ninteracting atom, as is shown schematically in Fig. 1 for a 2d hexagonal unit cell with the atom of interest at O.\nTo perform the sum it is necessary to divide the integration volume into different regions Xi such that transforming\nregion Xi by a vector ai constructs the Wigner-Seitz cell from the original unit cell. The matrix element then takes\nthe form\nX 1 X\n\u2032\nn\u2032\ni(k\u2032 \u2212P k).(rj +ai )\nh\u03c8Pn k |\u0125.\u2207V |\u03c8kn\u2032 i =\nun\u2217\n(20)\nP k (rj )\u0125.\u2207V (rj )uk\u2032 (rj )e\nN\nr\ni\nj\nwhere \u0125.\u2207V and the wavefunctions are available over a grid of Nr real space points, rj .\nIt should be noted that for an isolated atom the integral is carried out over one unit cell as a consequence of \u0125.\u2207V\nbeing localised in that cell, whereas for the coherent motion of an over-layer the integral is carried out over one unit\ncell as a consequence of the periodicity of the integrand. Hence, to evaluate \u03b7k=k\u2032 the rearrangement of Eq. (20) is\nnot necessary.\n\n\f6\n\nfgg1\n\nfgg2\n\nfkg1\n\n1\n\n1 + NG\n\nfkg2\n\n2\n\n2 + NG\n\nNG \u0002 Pfgg\n\nFIG. 2: Distribution of data across processors - each box is one processor and contains the processor number. Columns are\nprocessors that hold data for subregions of real or reciprocal space, and rows are processors that hold data for subsets of k\npoints.\n\nIII.\n\nIMPLEMENTATION AS A PARALLEL ALGORITHM\n\nWe are interested in large scale systems, hence a parallel implementation of both the original Kohn-Sham calculation\nand the evaluation of \u03b7 is desirable. Multiprocessor algorithms for plane-wave Kohn-Sham methods are available, so\nwe describe the latter only.\nFirst we consider the distribution of data between the Np available processors. These are divided into NG groups\nof P {g} processors, and the k points are distributed equally between these groups of processors. Data specific to a k\npoint is stored on the associated group. The g points are then distributed across the P {g} processors in each group,\nand data associated with each g point held on the associated processor. Data that is not dependent on k is the same\nfor each group but distributed across processors within the group, and data that is not dependent on g is the same\nwithin each group but distributed across groups. This distribution is shown figuratively in Fig. 2, where the k points\nin the nth group are denoted {k}n , and the g vectors on the nth processor in each group are denoted {g}n .\nWavefunctions in real space are obtained by a parallel FFT, so real space points are distributed as for reciprocal\nspace points, and this FFT is performed in parallel across all processors in each group. As efficient parallel FFT\nalgorithms are available and a distributed sum is trivial these sections of the algorithm parallelise well. The integral\nmust also be must be summed over pairs of k points, with each point in a different group, and it is this part of\nthe algorithm that requires a large amount of waiting and communication, and is not as efficient. The algorithm for\nevaluation of Eq. (16) takes the following form, with the current processor in group i.\n[t] for n := 1, Nbands\nfor k \u2208 {k}i\nfor S \u2208 Space-group\nCgn (P k) :=Transform[Cgn (k)]\nunP k (r) := FFT[Cgn (P k)]\nfor n\u2032 := 1, Nbands\nfor m := 1, NG\nfor k\u2032 \u2208 {k}i\n\u2032\n\n\u2032\n\nIf m = i then unk\u2032 (r) := FFT[Cgn (k\u2032 )]\n\n\f7\n\u2032\n\n\u2032\n\nBcast unk\u2032 (r), k\u2032 , wk\u2032 , \u01ebnk\u2032 from group m to all groups\nn\u2032\ni(k\u2032 \u2212P k).(r+a)\nSum un\u2217\nover group i\nP k (r)\n\u0010 \u0125.\u2207V uk\u2032 (r)e\n\u0011\n\u2032\nn\nn\n\u2032 n\nn\u2032\nEvaluate f (\u01ebk ) \u2212 f (\u01ebk\u2032 ) \u03b4\u0303 (\u01ebk \u2212 \u01ebk\u2032 )\nAdd contribution\nto \u03b7 using\n\u0010\n\u0011 weights \u2032\n\u2032\nwk ,wk\u2032 , f (\u01ebnk ) \u2212 f (\u01ebnk\u2032 ) \u03b4\u0303 \u2032 (\u01ebnk \u2212 \u01ebnk\u2032 )\nend\nend\nend\nend\nend\nend\nSum \u03b7 over all groups\nThe subprogram Transform: obtains the image of the wavefunction in reciprocal space, as defined by Eq. (18).\nIt takes the following form, where the current processor is in the group associated with k, and holds vectors {g}i\nTransform:\nfor m := 1, P {g}\nBcast {g,Cgn (k)}m from mth to all processors in group\nfor g \u2208 {g}i\nIf P \u22121 g \u2208 {g}m then Cgn (P k) := CPn \u22121 g (k)e\u2212i(P k+g).w\nend\nend\nreturn Cgn (P k)\nIt is useful to know the scaling of this algorithm with respect to the distribution of data across the processors,\n(NG , P {g}), and the number of processors available Np = NG \u00d7 P {g}. The time taken for a reasonably large system\nis dominated by the time spent carrying out the FFT contained within the inner loop (or waiting for another group\nto broadcast the result of this FFT) and is given by\n2\ntk \u221d Ns Nbands\nNk2\n\n1\nP {g}tFFT (P {g})\nNp\n\n(21)\n\nwhere tFFT (M ) is the time taken to carry out a parallel FFT on M processors. The speedup of the parallel FFT\nwith increasing number of processors is complex and depends on the architecture of the parallel system [17], but some\ngeneral conclusions about how this effects the performance of the entire algorithm can be made. If a linear speedup\nof the FFT with respect to the available processors (P {g}) occured then the total run time would be independent\nof the distribution of the processors among k and g points. However, the actual speedup will be worse than linear\ndue to the communication times, so for a given Np the best efficiency is achieved when the k points are distributed\namongst as many processors as possible, or P {g} is as small as possible.\nIV.\n\nRESULTS\n\nTest calculations have been carried out for a H atom moving above the hcp hollow site of a Cu(111) surface. This\nsystem has been chosen for its simplicity (although we note that spin polarisation is needed to obtain the correct\nelectronic structure at larger atom-surface separations) and because of its relevance to the chemicurrent experiment\nof Nienhaus et al [4]. The surface is modelled by a five-layer slab, with a vacuum gap equivalent to another five layers.\nA 2 \u00d7 2 in-plane super-cell is used - tests show that the deformation potential caused by the displacement of H atoms\nis well localised within this unit cell. A spin-polarised version of the PW91 functional is used for exchange-correlation\neffects ([18], and references therein), a Troullier-Martins [19] pseudopotential is used for Cu, and H is represented by\na Coulomb potential. The plane-wave, pseudopotential code CASTEP is used to obtain the self-consistent potentials\nand Kohn-Sham states that are required for the calculation of the matrix elements in Eq. (16). Calculations are\nperformed with a plane-wave cut-off of 830 eV, 54 k-points are included in the full surface Brillouin zone, and a Fermi\n\n\f8\nT\n(K)\n46\n231\n463\n926\n1389\n1852\n2315\n\n\u2206T\n(eV)\n0.01\n0.05\n0.10\n0.20\n0.30\n0.40\n0.50\n\n\u03b7\u2191 + \u03b7\u2193 \u03b7k=k\u2032 ,\u2191 + \u03b7k=k\u2032 ,\u2193\n(meV ps \u00c5\u22122 )\n1.578\n1.364\n1.576\n1.361\n1.570\n1.308\n1.551\n1.217\n1.532\n1.166\n1.525\n1.146\n1.536\n1.151\n\nTABLE I: Variation of friction coefficient with temperature, \u2206 = 0.5 eV\n\nsurface broadening of 0.25 eV is used. In order to test the convergence of the method we present results for the H\natom 2.5 \u00c5 above the surface, and with \u0125 perpendicular to the surface.\nTo obtain the perturbative field, \u0125.\u2207V , calculations are performed with H at x\u00b1h. Equation (10) is then applied to\nthe resulting self-consistent potentials to obtain \u0125.\u2207V . The finite difference introduces two errors in the final result.\nFirst a quadratic error is introduced by the finite difference itself, and second any small errors in the Kohn-Sham\npotentials are magnified for small |h|. It follows that |h| must be carefully chosen to be small enough to minimise\nthe first of these errors, but large enough to minimise the second. Tests for a number of |h| suggest that |h| = 0.02\n\u00c5 results in a quadratic error \u2248 0.1% and an error due to noisy Kohn-Sham potentials of \u2248 1.0%. Quantifying the\nlatter of these is not straightforward, hence a pessimistic estimate has been given.\nEq. (16) was evaluated using the algorithm described in section III. If the factor\n\u0010 With these\u2032 parameters\n\u0011\nn\nn\n\u2032 n\nn\u2032\nf (\u01ebk ) \u2212 f (\u01ebk\u2032 ) \u03b4\u0303 (\u01ebk \u2212 \u01ebk\u2032 ) in Eq. (16) was less than 10\u22123 the contribution to \u03b7 was not calculated, increasing\nthe efficiency of the calculation. Enough bands are included for the highest energy bands at each k point to be\ndiscarded.\nTwo parameters remain, which describe the temperature of the system, and how the discretisation of k space is\ndealt with through the smearing, \u2206. The temperature enters through the Fermi-Dirac occupation functions in Eq.\n(16), and may be chosen to take any value. For the metallic system considered here a weak temperature dependence\nis expected, so the zero-temperature limit is the quantity of interest. We chose to use a 'squashed Fermi-Dirac'\ndistribution, f \u0303(x), related to the function defined in Eq. (12) by\nf \u0303(x) = 1 \u2212\n\nZ\n\nx\u2212\u01ebF\n\n\u03b4\u0303(x)dx.\n\n(22)\n\n\u2212\u221e\n\nIf \u2206T is the width associated with \u03b4\u0303(x) then the properties of the \u221a\nsystem are very close to those of a system described\nby a Fermi-Dirac distribution with a temperature given by \u2206T /( 2\u03c0kB ), where kB is the Boltzmann constant.\nTable I shows results for \u03b7 summed over both spins, calculated over a range of temperatures for \u2206 = 0.5 eV (this is\ndiscussed below) and for both the isolated atom (\u03b7\u2191 + \u03b7\u2193 , see Eq. (16)) and the coherent over-layer (\u03b7k=k\u2032 ,\u2191 + \u03b7k=k\u2032 ,\u2193 ,\nsee Eq. (17)). Results for an isolated atom are weakly dependent on temperature, and we take \u2206T = 0.1 eV to\nrepresent the low temperature limit. For the coherent over-layer the temperature dependence is stronger, which is\nunderstandable since a greater proportion of the available (band to band) transitions are expected to be of higher\nenergy.\nThe approximation that requires the most attention is the discretisation of k space and the reintroduction of a\ncontinuum through smearing. As described in section II we derive a continuous self-energy function using the \u03b4\u0303(x) of\nEq. (12) with width \u2206, and extract the linear behaviour of this function close to zero energy. For a given set of k\npoints we must find a value of \u2206 large enough for the approximate self-energy to have converged to a linear function\nnear zero energy. This critical \u2206 must be small enough (and so the density of the k point mesh must be high enough)\nto avoid the higher energy structure of the self-energy influencing the structure close to zero energy.\nResults were calculated as above, with \u2206T = 0.1 eV and \u2206 ranging from 0.05 to 1.0 eV. These are shown in Fig.\n3 for both the isolated atom and coherent over-layer. For the isolated atom \u03b7 shows good convergence by \u2206 = 0.6\neV, and this value is low enough to conserve the structure of the self-energy. Convergence has not been achieved for\nthe coherent over-layer, and the strong variation of the friction coefficient with \u2206 in this range suggests that the 54\nk-points are insufficient to achieve convergence for this system. This difference in the convergence behaviour is due\n\n\f9\n\n\u0011\n\n(meV ps \u0017\nA 2)\n\n1.5\n1\n0.5\n0\n\n0\n\n0.2\n\n0.4\n0.6\n\u0001 (eV)\n\n0.8\n\n1\n\nFIG. 3: Convergence of friction coefficient with the 'smearing parameter' \u2206. Results are given for \u2206T = 0.1 eV (T = 463 K).\nThe solid line shows the friction coefficient for an isolated atom above the surface, \u03b7 = \u03b7\u2191 + \u03b7\u2193 , whereas the dashed line shows\nthe friction coefficient for an over-layer of atoms in coherent motion, \u03b7k=k\u2032 ,\u2191 + \u03b7k=k\u2032 ,\u2193 .\n\nto far fewer transitions being available in the coherent over-layer system due to the k = k\u2032 condition, and so fewer\ntransitions to approximate a continuous self-energy.\nV.\n\nCONCLUSION\n\nAn ab initio method has been presented that allows the evaluation of the friction due to electron-hole pair creation\nexperienced by an isolated molecule in motion near a metal surface. The approach described combines Kohn-Sham\nsuper-cell methods employing a plane-wave basis with a description of the electron-hole pair creation process via\nTDDFT. Results have been presented for a H atom above a Cu(111) surface, and convergence of the calculations has\nbeen tested. We find a significant difference in the results for motion of an isolated atom and those for a coherent\nover-layer of atoms, both in the physical properties of the system and in their numerical calculation. Since the\ncalculation is relatively expensive to perform for systems of interest an efficient parallel implementation of method\nhas been given.\nWe wish to thank M. Persson and S. Holloway for useful discussions.\n\n[1]\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n[8]\n[9]\n[10]\n[11]\n[12]\n[13]\n[14]\n\nD.M. Bird, P.A. Gravil, Surface Science 377-379, (1997) 555.\nG.R. Darling, S. Holloway, Rep. Prog. Phys. 58, (1995) 1595.\nM. Gostein, E. Watts, G.O. Sitz, Phys. Rev. Lett. 79, (1997) 2891.\nH. Nienhaus H, H.S. Bergh, B. Gergen, A. Majumdar, W.H. Weinberg, E.W. McFarland, Phys. Rev. Lett. 82, (1999) 446.\nY. Huang Y, A.M. Wodtke, H. Hou, C.T. Rettner, D.J. Auerbach, Phys. Rev. Lett. 84, (2000) 2985.\nG. Grimvall, The Electron Phonon Interaction in Metals. North-Holland, Amsterdam, 1981.\nB. Hellsing, M. Persson, Physica Scripta 29 (1984) 360.\nA. Liebsch, Phys. Rev. B55 (1997) 13263.\nM. Head-Gordon, J.C. Tully, Phys. Rev. B46 (1992) 1853.\nM.Y. Amusia, V.R. Shaginyan, Phys. Lett. A250, (1998) 157.\nM. Plihal, D.C. Langreth, Phys. Rev. B58 (1998) 2191.\nE.K.U. Gross, W. Kohn, Phys. Rev. Lett. 55, (1985) 2850.\nJ.C. Inkson, Many-Body Theory of Solids (Plenum Press, New York, 1986).\nR.W. Godby, M. Schluter, L.J. Sham, Phys. Rev. B37, (1988) 10159.\n\n\f10\n[15] J.A. White, D.M. Bird, M.C. Payne, Phys. Rev. B53, (1996) 1667.\n[16] S.L. Altmann, Band Theory of Solids: An Introduction from the Point of View of Symmetry (Oxford University Press,\nOxford, 1991).\n[17] A. Gupta, V. Kumar. IEEE T. Parall. Distr. 4 (1993) 922.\n[18] J.P. Perdew, K. Burke, M. Ernzerhof, Phys. Rev. Lett. 77, (1996) 3865.\n[19] N. Troullier, J. Martins, Phys. Rev. B43,(1991) 1993.\n\n\f"}