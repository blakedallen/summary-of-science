{"id": "http://arxiv.org/abs/1109.6410v1", "guidislink": true, "updated": "2011-09-29T06:23:00Z", "updated_parsed": [2011, 9, 29, 6, 23, 0, 3, 272, 0], "published": "2011-09-29T06:23:00Z", "published_parsed": [2011, 9, 29, 6, 23, 0, 3, 272, 0], "title": "Billiard complexity in the hypercube", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.2051%2C1109.6079%2C1109.1873%2C1109.2823%2C1109.3829%2C1109.2933%2C1109.3023%2C1109.0627%2C1109.1857%2C1109.3842%2C1109.3583%2C1109.5448%2C1109.5769%2C1109.5790%2C1109.5322%2C1109.5343%2C1109.3136%2C1109.6005%2C1109.4261%2C1109.2820%2C1109.1826%2C1109.5169%2C1109.3057%2C1109.6391%2C1109.4317%2C1109.0694%2C1109.1798%2C1109.6804%2C1109.0948%2C1109.5572%2C1109.1667%2C1109.6930%2C1109.4533%2C1109.5398%2C1109.0534%2C1109.6316%2C1109.1627%2C1109.1859%2C1109.5564%2C1109.6256%2C1109.0319%2C1109.3666%2C1109.2296%2C1109.6820%2C1109.4145%2C1109.4405%2C1109.0842%2C1109.4362%2C1109.1513%2C1109.3406%2C1109.2964%2C1109.0999%2C1109.4850%2C1109.3140%2C1109.5459%2C1109.4330%2C1109.3290%2C1109.4204%2C1109.2524%2C1109.4167%2C1109.2260%2C1109.0873%2C1109.2234%2C1109.6135%2C1109.4270%2C1109.3351%2C1109.2278%2C1109.2182%2C1109.5194%2C1109.1289%2C1109.5589%2C1109.2887%2C1109.6321%2C1109.6685%2C1109.4140%2C1109.3813%2C1109.1082%2C1109.4787%2C1109.0640%2C1109.1356%2C1109.3009%2C1109.0054%2C1109.2977%2C1109.3712%2C1109.4438%2C1109.2757%2C1109.6156%2C1109.4431%2C1109.3306%2C1109.2255%2C1109.3810%2C1109.0237%2C1109.1794%2C1109.6546%2C1109.5425%2C1109.4230%2C1109.5961%2C1109.5383%2C1109.1329%2C1109.1571%2C1109.6410&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Billiard complexity in the hypercube"}, "summary": "We consider the billiard map in the hypercube of $\\mathbb{R}^d$. We obtain a\nlanguage by coding the billiard map by the faces of the hypercube. We\ninvestigate the complexity function of this language. We prove that $n^{3d-3}$\nis the order of magnitude of the complexity.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.2051%2C1109.6079%2C1109.1873%2C1109.2823%2C1109.3829%2C1109.2933%2C1109.3023%2C1109.0627%2C1109.1857%2C1109.3842%2C1109.3583%2C1109.5448%2C1109.5769%2C1109.5790%2C1109.5322%2C1109.5343%2C1109.3136%2C1109.6005%2C1109.4261%2C1109.2820%2C1109.1826%2C1109.5169%2C1109.3057%2C1109.6391%2C1109.4317%2C1109.0694%2C1109.1798%2C1109.6804%2C1109.0948%2C1109.5572%2C1109.1667%2C1109.6930%2C1109.4533%2C1109.5398%2C1109.0534%2C1109.6316%2C1109.1627%2C1109.1859%2C1109.5564%2C1109.6256%2C1109.0319%2C1109.3666%2C1109.2296%2C1109.6820%2C1109.4145%2C1109.4405%2C1109.0842%2C1109.4362%2C1109.1513%2C1109.3406%2C1109.2964%2C1109.0999%2C1109.4850%2C1109.3140%2C1109.5459%2C1109.4330%2C1109.3290%2C1109.4204%2C1109.2524%2C1109.4167%2C1109.2260%2C1109.0873%2C1109.2234%2C1109.6135%2C1109.4270%2C1109.3351%2C1109.2278%2C1109.2182%2C1109.5194%2C1109.1289%2C1109.5589%2C1109.2887%2C1109.6321%2C1109.6685%2C1109.4140%2C1109.3813%2C1109.1082%2C1109.4787%2C1109.0640%2C1109.1356%2C1109.3009%2C1109.0054%2C1109.2977%2C1109.3712%2C1109.4438%2C1109.2757%2C1109.6156%2C1109.4431%2C1109.3306%2C1109.2255%2C1109.3810%2C1109.0237%2C1109.1794%2C1109.6546%2C1109.5425%2C1109.4230%2C1109.5961%2C1109.5383%2C1109.1329%2C1109.1571%2C1109.6410&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We consider the billiard map in the hypercube of $\\mathbb{R}^d$. We obtain a\nlanguage by coding the billiard map by the faces of the hypercube. We\ninvestigate the complexity function of this language. We prove that $n^{3d-3}$\nis the order of magnitude of the complexity."}, "authors": ["Nicolas Bedaride", "Pascal Hubert"], "author_detail": {"name": "Pascal Hubert"}, "author": "Pascal Hubert", "arxiv_comment": "18 pages, 3 figures", "links": [{"href": "http://arxiv.org/abs/1109.6410v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1109.6410v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "37A35, 37C35, 05A16, 11N37, 28D", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1109.6410v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1109.6410v1", "journal_reference": "Annales de l'institut Fourier. 2007, 57 (3) 719-738", "doi": null, "fulltext": "BILLIARD COMPLEXITY IN THE HYPERCUBE\nNICOLAS BEDARIDE, PASCAL HUBERT\n\narXiv:1109.6410v1 [math.DS] 29 Sep 2011\n\nABSTRACT. We consider the billiard map in the hypercube of Rd .\nWe obtain a language by coding the billiard map by the faces of the hypercube. We investigate the complexity function of this language. We\nprove that n3d\u22123 is the order of magnitude of the complexity.\nRESUME: On consid\u00e8re l'application du billard dans le cube de Rd .\nOn code cette application par les faces du cube. On obtient un langage,\ndont on cherche \u00e0 \u00e9valuer la complexit\u00e9. On montre que l'ordre de\ngrandeur de cette fonction est n3d\u22123 .\n\nKeywords: Symbolic dynamic, billiard, words, complexity function.\nMots-cl\u00e9s: Dynamique symbolique, billard, mots, complexit\u00e9.\nAMS codes: 37A35 ; 37C35; 05A16; 11N37; 28D.\nComplexit\u00e9 du billard cubique multi-dimensionnel.\n1. Introduction\nA billiard ball, i.e. a point mass, moves inside a polyhedron P with unit\nspeed along a straight line until it reaches the boundary \u2202P , then it instantaneously changes direction according to the mirror law, and continues\nalong the new line.\nLabel the faces of P by symbols from a finite alphabet A whose cardinality\nequals the number of faces of P . Either we consider the set of billiard orbits\nin a fixed direction, or we consider all orbits.\nIn both cases the orbit of a point corresponds to a word in the alphabet\nA and the set of all the words is a language. We define the complexity of\nthe language, p(n), by the number of words of length n that appears in this\nsystem. We call the complexity of an infinite trajectory the directional complexity: it does not depend on the initial point under suitable hypotheses.\nWe denote it by p(n, \u03c9) (where \u03c9 is the initial direction of the trajectory),\nand the other one the global complexity or to short simply the complexity.\nHow complex is the game of billiard inside a polygon or a polyhedron ? The\nonly general result about complexity function is that the billiard in a polygon has zero entropy [GKT95] [Kat87], and thus the two complexities grow\nsub-exponentially. For the convex polyhedron the same fact is true [Bed05].\nIt is possible to compute the complexity for rational polygons (a polygon\nis rational if the angles between sides are rational multiples of \u03c0). For the\ndirectional complexity the first result is in the famous paper of Morse and\nHedlund [MH40], and it has been generalized to any rational polygon by\nHubert [Hub95]. This directional complexity is always linear in n.\nFor the global complexity in the square coded by two letters, Mignosi\nfound an explicit formula see [Mig91], [BP93]. Then Cassaigne, Hubert and\n1\n\n\f2\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nTroubetzkoy [CHT02] proved that p(n)/n3 has a lower and an upper bound,\nin the case of rational convex polygons, and the first author generalized\nthis result to the case of non convex rational polygons [Bed03]. Moreover,\nfor some regular polygons they showed that p(n)/n3 has a limit, and then\ncalculated it. But even for the hexagon we are not able to obtain an equivalent statement: we must use the result of Masur that gives the order of\nmagnitude of the number of saddle connections [Mas90].\nIn the polyhedral case much less is known. The directional complexity,\nin the case of the cube, has been computed by Arnoux, Mauduit, Shiokawa\nand Tamura [AMST94] and generalized to the hypercube by Baryshnikov\n[Bar95]; see also [Bed06] for a generalization. Moreover, in [Bed03] the\ncomputation has been done in the case of some right prisms whose bases\ntile the plane. For those polyhedra the directional complexity is always\nquadratic in n. In the current article we compute the global complexity for\nthe hypercube of Rd coded with d letters.\nTheorem 1. Let p(n, d) be the complexity of the language associated to the\nhypercubic billiard (coded with d letters). Then there exists C1 , C2 \u2208 R+\nsuch that\nC1 n3d\u22123 \u2264 p(n, d) \u2264 C2 n3d\u22123 .\nRemark 2. In the proof some constants appear in the inequalities. We\ndenote them all by the same letter C.\nMoreover we will use the term \"cube\" even if d is greater than three.\n1.1. Overview of the proof. The proof of [CHT02] is based on the fact\nthat the complexity is related to the number of generalized diagonals. A\ngeneralized diagonal is an orbit segment which starts and ends on a vertex\nof the polygon (or an edge of the polyhedron). If we wish to apply this technique to the hypercube, however, a generalized diagonal is not necessarily\nassociated to a single word, so that we must modify the proof. First we\nshow that the complexity is related to the number of words that appear in\none diagonal, see Section 3. Next we begin to count the numbers of those\nwords. We split the estimates between several parts. Section 5 is devoted\nto obtaining the upper bound by a general geometric argument. In Section\n6 we establish the lower bound by an induction on the dimension d.\n2. Background\n2.1. Billiard. In this section we recall some definitions: Let P be a polyhedron, the billiard map is called T and it is defined on a subset of \u2202P \u00d7RP d\u22121 .\nThis space is called the phase space.\n\u2022 We will call a face of the cube a face of dimension d \u2212 1. If we use a\nface of smaller dimension we will state the dimension.\nWe define a partition P of the phase space on d sets by the following\nmethod: the boundary of P is partitioned into d sets by identifying the\nn\n_\nparallel faces of the cube. Then we consider the partition Pn =\nT \u2212i P.\ni=0\n\nDefinition 3. The complexity of the billiard map, denoted p(n, d), is the\nnumber of atoms of Pn .\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n3\n\n\u2022 The unfolding of a billiard trajectory: Instead of reflecting the trajectory in the face we reflect the cube and follow the straight line. Thus we\nconsider the tiling of Rd by Zd , and the associated partition into cubes of\nedges of length one. In the following when we use the term \"face\" we mean\na face of one of those cubes.\nThe following lemma is very useful in the following.\nLemma 4. Consider an orthogonal projection on a face of the cube. The\northogonal projection of a billiard map is a billiard map inside a cube of\ndimension equal to the dimension of the face.\n2.2. Combinatorics.\nDefinition 5. Let A be a finite set called the alphabet. By a language L\nover A we always mean a factorial extendable language: a language is a\ncollection of sets (Ln )n\u22650 where the only element of L0 is the empty word,\nand each Ln consists of words of the form a1 a2 . . . an where ai \u2208 A and such\nthat for each v \u2208 Ln there exist a, b \u2208 A with av, vb \u2208 Ln+1 , and for all\nv \u2208 Ln+1 if v = au = u0 b with a, b \u2208 A then u, u0 \u2208 Ln .\nThe complexity function p : N \u2192 N is defined by p(n) = card(Ln ).\nFirst we recall a well known result of Cassaigne concerning combinatorics\nof words [Cas97].\nDefinition 6. Let L(n) be a factorial extendable language. For any n \u2265 1\nlet s(n) := p(n + 1) \u2212 p(n). For v \u2208 L(n) let\nml (v) = card{u \u2208 \u03a3, uv \u2208 L(n + 1)},\nmr (v) = card{w \u2208 \u03a3, vw \u2208 L(n + 1)},\nmb (v) = card{u \u2208 \u03a3, w \u2208 \u03a3, uvw \u2208, L(n + 2)}.\nA word is called right special if mr (v) \u2265 2. A word is called left special if\nml (v) \u2265 2 and it is called bispecial if it is right and left special. Let BL(n)\nbe the set of the bispecial words.\nCassaigne [Cas97] has shown:\nLemma 7. Let L be a language such that ml (v) \u2265 1, mr (v) \u2265 1 for all\nwords v \u2208 L. Then the complexity satisfies\nX\n\u2200n \u2265 1 s(n + 1) \u2212 s(n) =\ni(v),\nv\u2208BL(n)\n\nwhere i(v) = mb (v) \u2212 mr (v) \u2212 ml (v) + 1.\nFor the proof of the lemma we refer to [Cas97] or [CHT02].\nRemark 8. If we code the billiard map by the sequence of faces hit in a\ntrajectory, and if we associate the same letter to the parallel faces of the\ncube the two definitions of complexity coincide, i.e p(n, d) = p(n).\n\n\f4\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\n2.3. Geometry. We recall the Euler's formula.\nLemma 9. [Ful98] Let P be a simply connected polyhedron of Rd . Let Ni\nbe the number of faces of P of dimension i, then we have\nd\u22121\nX\n\n(\u22121)i Ni = 1 \u2212 (\u22121)d .\n\ni=0\n\nRemark 10. In the following sections, we will use this formula for some\nalgebraic manifolds of degree 2, but for simplicity we will always mean a\npolyhedron and hyperplanes, since the proofs are the same.\nNow we prove the following result.\nLemma 11. Suppose (Hi )i\u2264n is a sequence of hyperplanes of Rx and let\n(Qi )i\u2208I be the connected components of Rx \\ H1 \u222a * * * \u222a Hn . Then there exists\nC(x) > 0 such that:\ncardI \u2264 C(x)nx .\nProof. We will prove the assumption by induction on x. The induction hypothesis states that it is true for all i < x.\nThe hyperplanes (Hi ) induce a cellular decomposition of Rx . We will\ndenote Ni the number of cells of dimension i for 0 \u2264 i \u2264 x. We remark that\ncardI = Nx . We begin by obtaining an upper bound for Ni for 0 \u2264 i < d.\nWe will see later that this is sufficient to finish the proof.\n\u2022 Computation of N0 . We denote H = {H1 , . . . , Hn }, and consider the\nmap\n\u03c60 : Hx \u2192 {vertices} \u222a \u2205\n(\nHi1 \u2229 * * * \u2229 Hix If it is a point\n\u03c60 : (Hi1 , . . . , Hix ) 7\u2192\n\u2205 otherwise\nThis map is surjective, thus we deduce N0 \u2264 nx . Hence the induction is\ntrue for x = 1.\n\u2022 Let Ei the set of subspaces of dimension i which form the cells of dimension i of the cellular decomposition. We denote Ei = card(Ei ).\nThen the map\nHx\u2212i \u2192 Ei \u222a \u2205\n(\nHj1 \u2229 * * * \u2229 Hjx\u2212i if dimHj1 \u2229 * * * \u2229 Hjx\u2212i = x\n(Hj1 , . . . , Hjx\u2212i ) 7\u2192\n\u2205 otherwise\nis surjective by definition of the partition. We deduce for all i \u2264 x \u2212 1:\nEi \u2264 nx\u2212i .\nNow it remains to know into how many pieces \uf8f1\neach space of dimension i is\n\uf8f4\n\uf8f2F\ncut. Let F \u2208 Ei and H \u2208 H, we have F \u2229 H = or , where X is a subset\n\uf8f4\n\uf8f3\nX\nof codimension 1 contained in F .\nThe hyperplanes which partition F do not contain F , thus their trace on F\nis of codimension one. Thus the problem is reduced to compute the number\nof connected components of the partition of F by m \u2264 n hyperplanes.\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n5\n\nThe induction hypothesis implies that NF \u2264 C(i)ni . Then\nmaxF \u2208Ei EF \u2264 c(i)ni .\nWe deduce\nNi \u2264 nx\u2212i c(i)ni \u2264 c(i)nx .\nEuler's formula implies\nNx \u2264 1 +\n\nx\u22121\nX\n\nC(i)nx .\n\ni=0\n\nNx \u2264 Cnx .\nThe induction process has been completed.\n\n\u0003\n\nCorollary 12. Let P be a polyhedron of Rx , let (Hi )i\u2264n be a sequence of\nhyperplanes, and let (Qi )i\u2208I be the connected components of P \\H1 \u222a* * *\u222aHn .\nThen there exists C(x, P ) > 0 such that:\ncardI \u2264 C(x, P )nx .\nProof. We can apply the same proof in the case where P is a polyhedron: it\nsuffices to add the hyperplanes which form the boundary of P . In this case\nonly the constant C changes.\n\u0003\nRemark 13. If we consider algebraic equations of bounded degree (by \u03b4),\nthe same proof works since an intersection of such manifolds has a bounded\nnumber of connected components, and since the Euler characteristic takes a\nfinite number of values (see Remark 10), only depending on x and \u03b4.\n2.4. Number theory. A general reference for this section is [HW79].\nDefinition 14. Let n be an integer, the invertible elements of Z/nZ are\ndenoted by (Z/nZ)\u2217 , and the cardinality of this set is denoted \u03c6(n), which\nis called the Euler's function.\nDefinition 15. The Moebius function \u03bc is defined by\n\u03bc(1) = 1,\n\u03bc(p1 ..pk ) = (\u22121)k ,\n\u03bc(n) = 0,\n\npi \u2208 P\n\ndistinct primes,\n\nif n has a square factor.\n\nThe multiplicative functions \u03c6, \u03bc are linked by the following classical property:\nLemma 16. For all positive integer n the following holds:\n(\nX\n1\nif n = 1,\n\u03bc(d) =\n0\nelse,\nd|n\n\n\u03c6(n) X \u03bc(d)\n=\n.\nn\nd\nd|n\n\nNow we use the above Lemma to obtain the following result.\n\n\f6\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nLemma 17. For all integer p \u2265 1, there exists a C > 0 such that for all n\nthe following holds:\nX\nSl \u2265 Cnp+2 ,\nl\u2264n\n\nX\n\nwhere Sl =\n\np\n\nm .\n\nm\u2264l\ngcd(m,l)=1\n\nWe give a proof of the Lemma for the sake of the completeness. The\ninteger part is denoted by E().\nProof. By Lemma 16 we have\nX\nSl =\n\nmp =\n\nm\u2264l\ngcd(m,l)=1\n\nX X\n\n\u03bc(d)mp ,\n\nm\u2264l d|m,d|l\n\nX\n\nSl =\n\n\u03bc(d)k p dp ,\n\nk\u2264l/d\n\nl\nl\nl\n\u03bc(d)dp [Cp+1 ( )p+1 + Cp ( )p + O( )p\u22121 ],\nd\nd\nd\nd|l\nX\nX\nX\nSl = Cp+1 lp+1\n\u03bc(d)/d + Cp lp\n\u03bc(d) + lp\u22121 [\n\u03bc(d)O(1/d)],\nSl =\n\nX\n\nd|l\n\nd|l\n\nd|l\n\nThen we have\n|\n\nX\n\n\u03bc(d)O(1/d)| \u2264 C ln d,\n\nd|l\n\nand by Lemma 16:\nX\n\n\u03bc(d) = 0\n\nif l 6= 1.\n\nd|l\n\nWe deduce\nSl = Cp+1 lp+1\n\nX\n\nX\n\nX\n\n\u03bc(d)/d + O(lp\u22121 ln l).\n\nd|l\n\nX\n\nSl =\n\nl\u2264n\n\nX\n\nCl\n\np+1\n\nl\u2264n\n\nSl =\n\nl\u2264n\n\nX\n\nC\u03bc(d)/d\n\nSl = C\n\nX\nd\u2264n\n\nSl = C\n\nl\u2264n\n\nO(lp\u22121 ln l),\n\nX\n\nn\n\n0p+1 p+1\n\nd\n\n+ O(np ln n),\n\nn0 \u2264n/d\n\nl\u2264n\n\nX\n\nX\nl\u2264n\n\nd|l\n\nd\u2264n\n\nX\n\n\u03bc(d)/d +\n\nX\n\nn\n\u03bc(d)dp E( )p+2 + O(np ln l),\nd\n\n\u03bc(d)dp [\n\nd\u2264n\n\nn\nn\n\u2212 { }]p+2 + O(np ln l),\nd\nd\n\nn\nn\n\u03bc(d)dp [( )p+2 + O(( )p+1 )] + O(np ln l),\nd\nd\nl\u2264n\nd\u2264n\nX\nX\nX\nSl = Cnp+2\n\u03bc(d)/d2 + Cnp+1\n\u03bc(d)/d + O(np ln l),\nX\n\nSl = C\n\nX\n\nl\u2264n\n\nX\nl\u2264n\n\nd\u2264n\np+2\n\nSl = Cn\n\nX\nd\u2264n\n\nd\u2264n\n2\n\n\u03bc(d)/d + n\n\np+1\n\nO(log n) + O(np ln l).\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n7\n\nThe series of general term \u03bc(d)/d2 is absolutely convergent and its sum is\n1\n\u03b6(2) which is positive [HW79], thus we deduce:\nX\nSl \u2265 Cnp+2 .\nl\u2264n\n\n\u0003\n3. Preliminary results\nDefinition 18. A diagonal \u03b3A,B between two faces A, B of the cubic tesselation, of dimensions less than d \u2212 2, is the set of (oriented) segments which\nstart from A and stop in B.\nDefinition 19. We introduce the following order on the faces : two faces A\nand B verify A < B if and only if : each oriented segment, from A to B,\nis such that in the unfolding, the associated vector has positive coefficients.\nThe diagonals are of several types due to the dimension of A, B. We call a\ndiagonal between the faces A, B a positive diagonal if we have B > A. If we\nattach a superscript + to an object, then it will consist of positive diagonals.\nDefinition 20. We say that two faces A, B are at combinatorial length n\nif each orbit segment between A, B passes through n cubes. We denote the\nlength by d(A, B) = n.\nThis definition can be made since we are in the hypercube. In other\npolyhedron it is not well defined.\nDefinition 21. If the faces A, B of the cubic tesselation fulfill d(A, B) = n\nthen the diagonal \u03b3A,B is of combinatorial length n. We denote the set of\nthese diagonals by Diag(n).\n\nB\n\nA\nd(A,B)=6\n\nFigure 1. Words of billiard\nNotations. In the following we only consider diagonals of combinatorial\nlength n whose initial segment is in the cube [0, 1]d . If a diagonal is a positive\ndiagonal, it implies that the final edge is in R+ d .\nWe denote the fact that an orbit in the diagonal \u03b3 has code v by v \u2208 \u03b3.\nWe consider the bispecial words such that, in the unfolding, the associated\ntrajectories are in R+ d , and not in one of the d coordinates planes, we denote\nthese words by BL(n, d)+ .\n\n\f8\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nFigure 2. Words of billiard\nIn the following we call octant a proper subspace of Rd of the form I1 \u00d7\n* * * \u00d7 Id where Ii is equal to R\u2212 or to R+ .\nDefinition 22. Let v be a billiard word, we define the cell of v, by the subset\n{(m, \u03c9) \u2208 \u2202P \u00d7 RP d\u22121 } such that for all 0 \u2264 i \u2264 |v| \u2212 1, T i (m, \u03c9) \u2229 \u2202P is\nin the face labelled by vi .\nThe aim of this section is to show:\nProposition 23. With the preceding notations, there exists C > 0 such that\nX\nX\n1\ni(v) =\ni(v 0 ) + O(|s(n + 1, d \u2212 1) \u2212 s(n, d \u2212 1)|),\nd\n2\n+\n0\nv\u2208BL(n,d)\n\nv \u2208BL (n,d)\n\nX\n\nX\n\n\u03b3\u2208Diag(n) v\u2208\u03b3\n\n1\u2264\n\nX\n\ni(v 0 ) \u2264 C\n\nBL+ (n,d)\n\nX\n\nX\n\n1,\n\n\u03b3\u2208Diag(n) v\u2208\u03b3\n\nwhere s(n, d) = p(n + 1, d) \u2212 p(n, d).\nFor the proof we need the following lemmas.\nLemma 24. We consider a word v in L(n, d) with n \u2265 2, consider the unfolding of the billiard trajectories which are coded by v and start inside the\ncube [0; 1]d . Then for all i, 2 \u2264 i \u2264 n, there exists only one face corresponding to the letter vi .\nProof. First we consider the intersection of the cell of v with RP d\u22121 . This\nset is a proper subset of an octant since n \u2265 2. Now we make the proof\nby contradiction. We consider the first times j where two different faces\nappear. There exist two lines starting form a face (corresponding to vj\u22121 )\nwhich pass through these two different faces. These faces are different but\nare coded by the same letter, thus they are in two different hypercubes.\nThus the two directions are in different octant, contradiction.\n\u0003\nIn this figure we show two billiard words in the square. The path represents the faces at length n of the initial square. In the figure we have n = 3.\nThe two words are coded by 001 and 101, if we code the horizontal lines by\n0, and the vertical lines by 1.\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n9\n\nLemma 25. Let v be a word in BL(n, d)+ , then there exists only one positive\ndiagonal associated to this word.\nProof. If we study the unfolding of a trajectory associated to v, the fact\nthat we consider only words in BL(n, d)+ (and not in BL(n, d)) implies that\nthere are at most d choices for the suffix of v in the octant Rd+ (a suffix is a\nletter l such that vl is a word), and the same result for the prefix.\nWe consider the faces related to the suffix letter. We claim that these\nfaces have a non-empty intersection: By Lemma 24 these faces are in a\nsame hypercube. They correspond to different letters of the coding, thus\nthese faces intersect (by definition of the coding). The claim is proved.\nThose faces have a non-empty intersection, if we consider the same intersection with the prefix, we have built a diagonal associated to this word,\nand by construction it is unique.\n\u0003\nDefinition 26. We call discontinuity a set of points X = {(m, \u03c9), m \u2208 A}\nin the phase space such that A is a face, and such that their orbits intersect\nanother face of dimension d \u2212 2.\nLet us remark that a discontinuity is of dimension at most 2(d \u2212 1), and\nthat a diagonal is in the intersection of two discontinuities.\nLemma 27. Consider a diagonal \u03b3 between two faces A, B of dimensions\ni, j. Then for all word v \u2208 \u03b3, see Notations, we have\nd2 \u2265 i(v) \u2265 1.\nProof. Consider a bispecial billiard word v, the cell of v in the phase space\nis an open set. It means that if a trajectory has v for coding, a small\nperturbation of v has still v for coding.\nA face of dimension d \u2212 2 is at the intersection of two faces of dimension\nd\u22121, thus the face of dimension j is at the intersection of at least d\u2212j faces,\nand we deduce mr (v) \u2265 d\u2212j by perturbation. The same method shows that\nml (v) \u2265 d \u2212 i. Now by definition of diagonal, see Definition 18, the diagonal\nis in the interior of the cell of v in the phase space. Moreover the cell of v is\nan open set. Now consider a segment [a; b] inside the diagonal with a \u2208 A.\nThere exists an open set near a such that for all a0 inside the segment [a0 ; b]\nis still coded by v. Now there exists a neighborhood of b such that for all\nb0 the segment [a0 ; b0 ] has v for coding. This implies mb (v) = mr (v)ml (v).\nFinally we obtain i(v) = (ml (v) \u2212 1)(mr (v) \u2212 1) \u2265 1. The other inequality\nis obvious.\n\u0003\n3.1. Proof of Proposition\n23. First we remark that the symmetries of\nP\nRd implies that v\u2208BL(n,d) i(v) is the same for each octant.\nNow we are interested in the bispecial words which are neither in BL(n, d)+\nnor in one of the symmetric sets. Their unfolding is in [0, 1]d\u22121 \u00d7 R+ . Thus\nfor each coordinates plane their number is equal to the number of bispecial\nwords of the cube of dimension d \u2212 1. Lemma 7 implies:\nX\ni(v) \u2264 C|s(n + 1, d \u2212 1) \u2212 s(n, d \u2212 1)| C \u2208 R.\n+\nv \u2208BL(n,d)\n/\n\n\f10\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nWe consider the map\nf : BL(n, d)+ \u2192 Diag + (n)\nf : v 7\u2192 \u03b3\nLemma 25 implies that f is well defined and onto, thus\nX\ncard(f \u22121 (\u03b3)).\ncard(BL(n, d)+ ) =\n\u03b3\u2208Diag(n)\n\nThen we obtain\nX\nBL(n,d)+\n\ni(v 0 ) =\n\nX\n\nX\n\ni(v).\n\n\u03b3\u2208Diag(n) v\u2208\u03b3\n\nNow we must bound i(v) for each v \u2208 \u03b3. This is a consequence of Lemma\n27.\n4. Equations of diagonals\nIn these section we give in Lemma 28 the equations of a diagonal, we\ndeduce in Proposition 29 that several diagonals can not overlay, and we\nfinish the section by a description of the diagonals of fixed combinatorial\nlength. Remark that these equations are homogeneous in \u03c9.\nLemma 28. Let A, B two faces of dimension d \u2212 2, we consider\n\u03b3A,B = {(m, \u03c9) \u2208 Rd \u00d7 R\u2217 d , m \u2208 A, m + R\u03c9 \u2229 B 6= \u2205}.\nThen \u03b3A,B has one of the following equation\n(1) \u2022 n\u03c9i = p\u03c9j , with n, p \u2208 N.\ni\n(2) \u2022 mi + n\u03c9\n\u03c9j = p with n, p \u2208 N.\n(3) \u2022 \u03c9j mi \u2212 \u03c9i mj = n\u03c9i + p\u03c9j with n, p \u2208 N.\nProof. First we can assume that the point m \u2208 A have coordinates of the\nfollowing form\n\uf8eb\n\uf8f6\nm1\n\uf8ec .. \uf8f7\n\uf8ec . \uf8f7\n\uf8ec\n\uf8f7\n\uf8ecmd\u22122 \uf8f7 .\n\uf8ec\n\uf8f7\n\uf8ed 0 \uf8f8\n0\nThen each point of B have two coordinates equal to integers n, p. Thus its\ncoordinates are of the form:\n\uf8f6\n\uf8eb\nb1\n\uf8ec .. \uf8f7\n\uf8ec . \uf8f7\n\uf8ec\n\uf8f7\n\uf8ec n \uf8f7\n\uf8ec . \uf8f7\n\uf8f7\nB:\uf8ec\n\uf8ec .. \uf8f7 .\n\uf8f7\n\uf8ec\n\uf8ec p \uf8f7\n\uf8ec . \uf8f7\n\uf8ed .. \uf8f8\nbd\u22122\nIf the line m + R\u03c9 intersects B it means that there exists \u03bb such that\nm + \u03bb\u03c9 \u2208 B. Then there are three choices, depending on the position of n, p\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n11\n\nin the coordinates.\n\u2022 If n, p are at positions d \u2212 1, d we obtain a system of the form\n(\n\u03bb\u03c9d\u22121 = n\n\u03bb\u03c9d = p\nThis gives equation (1).\n\u2022If n is at a position i less or equal than d \u2212 2, and p is at position d \u2212 1\nor d, we obtain\n(\n\u03bb\u03c9d\u22121 = p\nmi + \u03bb\u03c9i = n\nThis gives the second equation.\n\u2022 If n and p are at position less than d \u2212 2, we are in case (3).\n\n\u0003\n\nProposition 29. Let A, B, Ci , i = 1 . . . l be l + 2 faces of dimension d \u2212 2.\nWe deduce the equivalence\n[\n\u03b3A,B =\n\u03b3A,Ci \u21d0\u21d2 A, B, Ci are contained in a hyperplane of Rd .\ni\n\nProof. We consider the three functions which appear in Lemma 28.\n\uf8f1\n\uf8f4\n\uf8f2f (\u03c9) = n\u03c9i \u2212 p\u03c9j ,\ni\ng(m, \u03c9) = mi + n\u03c9\n\u03c9j = p,\n\uf8f4\n\uf8f3\nh(m, \u03c9) = \u03c9j mi \u2212 \u03c9i mj \u2212 (n\u03c9i + p\u03c9j ).\nThe diagonals \u03b3A,B , \u03b3A,Ci have equations of the type f, g, h by preceding\nLemma (with different n, p, i, j). Remark that these equations are quadratic\nin the variables m, \u03c9. Thus these maps are analytic.\nWe compute the jacobian of these maps, it gives\n\uf8f1\n\u0010\n\u0011\n\uf8f4\ndf\n=\n.\n.\n.\n0\n.\n.\n.\n||\n.\n.\n.\nn\n*\n*\n*\n\u2212\np\n.\n.\n.\n\uf8f4\n\uf8f4\n\uf8f2\n\u0010\n\u0011\ndg = 0 . . . \u03c9j . . . || . . . n . . . mi \u2212 p . . .\n\uf8f4\n\u0010\n\u0011\n\uf8f4\n\uf8f4\n\uf8f3dh = 0 . . . \u03c9j . . . \u2212\u03c9i . . . || . . . \u2212mi \u2212 n . . . mi \u2212 p . . .\nNow without loss of generality we treat the case l = 1. The sets \u03b3A,B , \u03b3A,C\nare equal if and only if two of the preceding functions are equal on a set of\npositive measure. It implies that the linear forms are proportional. Assume\nthat two different forms are proportional (for example df and dg). It implies\nthat mi = 0, thus the equality is true on an hyperplane, and they are not\nequal on a set of positive measure. Thus the only possibility is that the two\nequations are of the same type (i.e two equations df or two equations dg).\nThen the same argument shows that the equality of two equations of the\ntype dg or dh implies that (m, \u03c9) lives on a set of zero measure. Thus the\nonly possibility is the equality of two vectors df . And it is equivalent to the\nfact that A, B, C belong to the same hyperplane.\n\u0003\n\n\f12\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nLemma 30. Let A, B be two faces of dimension less or equal than d \u2212 2.\nAssume A, B are at combinatorial length n, and that the elements of A are\nof the form\n\uf8eb\n\uf8f6\nm1\n\uf8ec .. \uf8f7\n\uf8ec . \uf8f7\n\uf8ec\n\uf8f7\n\uf8ecmd\u22122 \uf8f7 .\n\uf8ec\n\uf8f7\n\uf8ed 0 \uf8f8\n0\nThen we have:\n\u2022Either A, B are in a subspace of dimension d \u2212 2 then points of B are of\nthe form\n\uf8eb\n\uf8f6\nb1\n\uf8ec .. \uf8f7\n\uf8ec . \uf8f7\n\uf8ec\n\uf8f7\n\uf8ec bd\u22122 \uf8f7 ,\n\uf8ec\n\uf8f7\n\uf8ednd\u22121 \uf8f8\nnd\nwith nd\u22121 , nd \u2208 N, gcd(nd\u22121 , nd ) = 1 and\n\nd\u22122\nX\n\nE(bi ) + nd\u22121 + nd = n\n\ni=1\n\n\u2022 Or the points of B have the following coordinates:\n\uf8eb\n\uf8f6\nb1\n\uf8ec .. \uf8f7\n\uf8ec . \uf8f7\n\uf8ec\n\uf8f7\n\uf8ec ni \uf8f7\n\uf8ec . \uf8f7\n\uf8f7\n(i, j) 6= (d \u2212 1, d) \uf8ec\n\uf8ec .. \uf8f7 ,\n\uf8ec\n\uf8f7\n\uf8ec nj \uf8f7\n\uf8ec . \uf8f7\n\uf8ed .. \uf8f8\nbd\u22122\nwith ni , nj \u2208 N and\n\nd\u22122\nX\n\nE(bl ) + ni + nj = n.\n\nl=1\n\nProof. \u2022 First of all we consider the faces of dimension d \u2212 1 which are at\ncombinatorial length n of A. We claim that the points (bi )i\u2264d of these faces\nd\nX\nverify\nE(bi ) = n.\ni=1\n\nThe proof is made by induction on n. It is clear for n = 1, now consider\na billiard trajectory of length n, it means that just before the last face we\nintersect another face of the same cube. These face is at combinatorial\nlength n \u2212 1, and we can apply the induction process. Now consider a\npoint of these faces, denote by (ci )i\u2264d its coordinates. We verify easily that\nd\u22122\nd\nX\nX\nE(bi ) \u2212\nE(ci ) = 1 for all point b, c. This finishes the proof of the\ni=1\n\ni=1\n\nclaim. In this figure the path represents the faces at length n of the initial\nsquare. In the figure we have n = 3.\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n13\n\nFigure 3. Length of billiard words\nA trajectory between A and B is a diagonal if the trajectory does not\nintersect another face. It means that \u03b3A,B must not be the union of \u03b3A,Ci ,\nwhere Ci are at length less than n from A. We use Proposition 29 which\nimplies that the only bad case is when A, B are on a same hyperplane. Thus\nthe second point of the Lemma is proved.\nNow assume A, B are contained in a hyperplane. The fixed coordinates\nof all points in A and B are at the same places. Then we project on the\nplane generated by these coordinates. The diagonal projects on a line. This\nline does not contain integer points. Thus we obtain the primality condition.\n\u0003\nCorollary 31. We deduce that there exists C > 0 such that\ncardDiag(n) \u2264 Cnd\u22121 .\nProof. A diagonal \u03b3A,B can be of several forms among the dimension of\nthe faces. Since a face of dimension d \u2212 1 has a bounded number of faces\nof dimension less than d \u2212 1 in its boundary, we can reduce to count the\ndiagonals between faces of dimension d \u2212 1. Then the number of diagonals is\nbounded by a constant C(d) times the number of diagonals between faces of\ndimension d \u2212 2. The preceding Lemma shows that we have the inequality\ncardDiag(n) \u2264 Ccard{(ni )1\u2264i\u2264d , ni \u2208 N|\n\nd\nX\n\nni = n}.\n\ni=1\n\ncardDiag(n) \u2264 Cnd\u22121 .\n\u0003\n5. Upper bound\nIn this section we show\n\n\f14\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nTheorem 32. There exists C > 0 such that\ns(n, d) \u2264 Cn3d\u22124 .\nLemma 33. Let A, B two faces of dimension less than d \u2212 2, then the set\n\u03b3A,B is of dimension less than 2(d \u2212 2).\nFor all k, for all subset I of N of cardinality k, there exists\nT C(k) > 0 such\nthat for all (Ai )i\u2208I faces of dimension less than d \u2212 2, i,j\u2208I \u03b3Ai ,Aj has at\nmost C(k, d) connected components.\nProof. The first part is a consequence of lemma 28. Indeed A is of dimension\nless than d \u2212 2, the directions lives in RP d\u22121 which is of dimension d \u2212 1\nand the manifold has one equation.\nFor the second part we use again Lemma 28. The equation of these sets are\npolynomial equation of bounded degree (2), and a theorem of [Ful98] (Ex\n8.4.5) finishes the proof.\n\u0003\nProposition 34. There exists C > 0 such that for all A, B faces of dimension less than d \u2212 2, at combinatorial length n, we have\nX\n1 \u2264 Cn2d\u22124 .\nv\u2208\u03b3A,B\n\nProof. We consider the cell related to \u03b3A,B . This space is partitioned with\nseveral discontinuities. The number of sets of the partition is equal to the\nnumber of words v in \u03b3A,B . First if a discontinuity does not partition, we\nprolong it. It gives an upper bound for the number of words. Then we\nconsider the partition made by two discontinuities, Lemma 33 implies that\nthe number of connected components is bounded by C. Then we apply\nCorollary 12 with Cn hyperplanes (in fact algebraic varieties of degree at\nmost 2 see Remark 13), and x = 2(d \u2212 2) due to the first part of Lemma\n33.\n\u0003\n5.1. Proof of Theorem 32. We make an induction on d. If d = 2 it is a\nconsequence of [Mig91] or [BP93], or [CHT02].\nBy Proposition 23 we deduce\nX\nX X\ni(v) \u2264 2d [\n1 + s(n + 1, d \u2212 1)].\nv\u2208BL(n,d)\n\n\u03b3\u2208Diag(n) v\u2208\u03b3\n\nThen the preceding proposition shows\nX\nX\ni(v) \u2264 2d [\nCn2d\u22124 + s(n + 1, d \u2212 1)].\nv\u2208BL(n,d)\n\n\u03b3\u2208Diag(n)\n\nCorollary 31 implies that card(Diag(n)) \u2264 nd\u22121 , we deduce\nX\ni(v) \u2264 2d [Cn3d\u22125 + s(n + 1, d \u2212 1)],\nv\u2208BL(n,d)\n\nBy induction we deduce\ns(n + 1, d) \u2212 s(n, d) \u2264 C[n3d\u22125 + n3d\u22127 ].\ns(n, d) \u2264 Cn3d\u22124 .\nThe induction is proved.\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\n15\n\n6. Lower bound\nWe prove\nTheorem 35. There exists C > 0 such that for all n:\ns(n + 1, d) \u2212 s(n, d) \u2265 Cn3d\u22125 .\nThe proof is made by induction on d. It is clear for d = 2 due to [Mig91]\nor [BP93] or [CHT02], assume it is true for i \u2264 d \u2212 1.\nDefinition 36. Let A, B two faces of dimension less than d \u2212 2, we denote\n~ B.\n~\nby CA,B the vector space generated by A,\nd\nLet \u03c0 : R \u2192 CA,B be the orthogonal projection.\nConsider a trajectory of a fixed diagonal, it is coded by a word v, the\nimage of the trajectory by \u03c0 is a billiard trajectory, due to Lemma 4. Thus\nthe map \u03c0 can be extended to words, we denote it again by \u03c0.\n\u03c0\n\n\u03b3 \u2212\u2212\u2212\u2212\u2192 \u03c0(\u03b3)\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6\u03c6\n\u03c6y\ny\nv \u2212\u2212\u2212\u2212\u2192 \u03c0(v)\n\u03c0\n\nThe map \u03c0 consists to erase some letters, due to Lemma 4.\n6.1. Projection and language. The aim of this section is to prove\nProposition 37. We have\n[\n[\n{\u03c0(v), v \u2208 \u03b3A,B } =\nL(i, d \u2212 1).\ni\u2264n\u22121\n\n\u03b3A,B \u2208Diag(n)\n\nProof. The inclusion\n\n[\n\n{\u03c0(v), v \u2208 \u03b3A,B } \u2282\n\n\u03b3A,B \u2208Diag(n)\n\n[\n\nL(i, d \u2212 1).\n\ni\u2264n\u22121\n\nis a consequence of Lemma 4. To prove the second inclusion we need:\nLemma 38. Let i \u2264 n \u2212 1, and let v \u2208 L(i, d \u2212 1) be a billiard word between\ntwo faces A, B 0 of dimension d \u2212 2. There exists a face B of dimension d \u2212 2\nsuch that:\nd(A, B) = n,\n\u03b3A,B is a diagonal,\n\u03c0A,B (B) = B 0 .\nProof. By Lemma 30, we can always lift the face B 0 in a face B with\nd(A, B) = n. We just have to translate B 0 to the coordinate xd = n \u2212 i.\nThe only point to prove is that the trajectories between A, B form a diagonal. We make a proof by contradiction. Then each trajectory between\nA, B intersects another face Ci . It implies that \u03b3A,B is cover by some \u03b3A,Ci .\nContradiction with Proposition 29.\n\u0003\nNow the proof of the Proposition is a simple consequence of this lemma\nand of Lemma 4.\n\u0003\n\n\f16\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nCorollary 39. For any diagonal \u03b3 we have\nX\nX\n1.\n1\u2265\nv\u2208\u03b3\n\nv\u2208\u03c0(\u03b3)\n\nProof. By preceding Lemma, a word of \u03c0(\u03b3) can be lift in a word of \u03b3. In\nother word the map \u03c0 is surjective on the billiard words.\n\u0003\n6.2. Proof of Theorem 35. We fix the face A as in Lemma 28. By Lemma\n30 the coordinates (n1 , . . . , nd ) of B can be of two types:\nn1 + * * * + nd = n, gcd(nd\u22121 , nd ) = 1\n\nor;\n\nn1 + * * * + nd = n.\nDefinition 40. We denote these setsPof diagonals by Diag1 (n) and Diag2 (n).\nLet \u03b3 be a diagonal, the number\nv\u2208\u03b3 1 is denoted by f (n1 , . . . , nd ) or\ng(n1 , . . . , nd ) if \u03b3 is in Diag1 (n) or not.\nDue to Proposition 23 we must compute\nX X\nX=\n1.\n\u03b3\u2208Diag(n) v\u2208\u03b3\n\nBy Corollary 39 we can write this sum as\nX\nX\nX=\n1+\n\u03b3\u2208Diag1 (n) v\u2208\u03b3\n\nX\n\nX=\n\nf (n1 , . . . , nd ) +\n\n\u03b3\u2208Diag1 (n)\n\nX\n\nX\n\n1.\n\n\u03b3\u2208Diag2 (n) v\u2208\u03b3\n\nX\n\ng(n1 , . . . , nd ).\n\n\u03b3\u2208Diag2 (n)\n\nNow we use the projection \u03c0:\nBy Lemma 30 and 39 we deduce\nX\nX\nX\u2265\n[f (n1 , . . . , nd\u22122 )\u03c7(nd , nd\u22121 ) + g(n1 , . . . , nd )],\nnd ,nd\u22121 n1 ,...,nd\u22122\n\n(\n1 if gcd(nd , nd\u22121 ) = 1\nwhere \u03c7(nd , nd\u22121 ) =\n0 either\nNow Proposition 37 implies that\nX\n[f (n1 , . . . , nd\u22121 ) + g(n1 , . . . , nd\u22121 )] = p(n, d \u2212 1).\nn1 +***+nd\u22121 =n\n\nThis can be written as\nX\nX\n\n[f (n1 , . . . , nd\u22121 ) + g(n1 , . . . , nd\u22121 )] = p(n, d \u2212 1).\n\nnd\u22121 \u2264n n1 +***+nd\u22122 =n\u2212nd\u22121\n\nX\n\n[f (n1 , . . . , nd\u22121 ) + g(n1 , . . . , nd\u22121 )] = s(nd\u22121 , d \u2212 1).\n\nn1 +***+nd\u22122 =n\u2212nd\u22121\n\nThen we deduce\nX\nX\u2265\n\nX\n\n[f (n1 , . . . , nd\u22122 ) + g(n1 , . . . , nd )]\u03c7(nd\u22121 , nd ),\n\nnd ,nd\u22121 n1 ,...,nd\u22122\n\nX\u2265\n\nXX\n\nX\n\nnd nd\u22121 n1 ,...,nd\u22122\n\n[f (n1 , . . . , nd\u22122 ) + g(n1 , . . . , nd )]\u03c7(nd\u22121 , nd ),\n\n\fBILLIARD COMPLEXITY IN THE HYPERCUBE\n\nX\n\nX\u2265\n\nX\n\n17\n\ns(nd \u22121, d \u2212 1)\u03c7(nd , nd\u22121 ).\n\nnd \u2264n nd\u22121 \u2264n\u2212nd\n\nThen the induction hypothesis shows that\n|s(n + 1, d \u2212 1) \u2212 s(n, d \u2212 1)| \u2265 n3d\u22128 .\nIt implies a lower bound on s(n, d \u2212 1).\nX\nX\n(nd\u22121 )3d\u22127 \u03c7(nd , nd\u22121 ).\nX\u2265\nnd \u2264n nd\u22121 \u2264n\u2212nd\n\nX\u2265\n\nX\n\nX\n\n(nd\u22121 )3d\u22127 \u03c7(n \u2212 nd , nd\u22121 ).\n\nnd \u2264n nd\u22121 \u2264nd\n\nX\u2265\n\nX\n\nX\n\nnd \u2264n\n\nnd\u22121 \u2264nd\ngcd(nd\u22121 ,nd )=1\n\n(nd\u22121 )3d\u22127 .\n\nWe apply Lemma 17 with p = 3d \u2212 7 and obtain:\nX \u2265 Cn3d\u22125 .\nNow by Proposition 23 we have\ns(n + 1, d) \u2212 s(n, d) \u2265 CX + O(s(n, d \u2212 1) \u2212 s(n, d \u2212 1)).\nWe apply again the induction to obtain a lower bound for the error term\nof Proposition 23. This term is bounded by n3d\u22128 . Thus we have\ns(n + 1, d) \u2212 s(n, d) \u2265 Cn3d\u22125 \u2212 n3d\u22128 .\ns(n + 1, d) \u2212 s(n) \u2265 Cn3d\u22125 .\nThe proof by induction is finished.\n7. Proof of the main theorem\nWe just have to join Theorems 32 and 35. \u0003\nAcknowledgment We would like to thank Christian Mauduit, who worked\non an earlier version of this paper. Moreover we would like to thank Joel\nRivat for useful discussions.\nReferences\n[AMST94] P. Arnoux, C. Mauduit, I. Shiokawa, and J. Tamura. Complexity of sequences\ndefined by billiard in the cube. Bull. Soc. Math. France, 122(1):1\u201312, 1994.\n[Bar95]\nYu. Baryshnikov. Complexity of trajectories in rectangular billiards. Comm.\nMath. Phys., 174(1):43\u201356, 1995.\n[Bed03]\nN. Bedaride. Billiard complexity in rational polyhedra. Regul. Chaotic Dyn.,\n8(1):97\u2013104, 2003.\n[Bed05]\nN. Bedaride. Entropy of polyhedral billiard. submitted, 2005.\n[Bed06]\nN. Bedaride. A generalization of Baryshnikov's formula. Preprint, 2006.\n[BP93]\nJ. Berstel and M. Pocchiola. A geometric proof of the enumeration formula for\nSturmian words. Internat. J. Algebra Comput., 3(3):349\u2013355, 1993.\n[Cas97]\nJ. Cassaigne. Complexit\u00e9 et facteurs sp\u00e9ciaux. Bull. Belg. Math. Soc. Simon\nStevin, 4(1):67\u201388, 1997. Journ\u00e9es Montoises (Mons, 1994).\n[CHT02] J. Cassaigne, P. Hubert, and S. Troubetzkoy. Complexity and growth for polygonal billiards. Ann. Inst. Fourier (Grenoble), 52(3):835\u2013847, 2002.\n[Ful98]\nWilliam Fulton. Intersection theory. Springer-Verlag, 2:xiv+470, 1998.\n\n\f18\n\n[GKT95]\n[Hub95]\n[HW79]\n[Kat87]\n[Mas90]\n[MH40]\n[Mig91]\n\nNICOLAS BEDARIDE, PASCAL HUBERT\n\nG. Gal0 perin, T. Kr\u00fcger, and S. Troubetzkoy. Local instability of orbits in\npolygonal and polyhedral billiards. Comm. Math. Phys., 169(3):463\u2013473, 1995.\nP. Hubert. Complexit\u00e9 de suites d\u00e9finies par des billards rationnels. Bull. Soc.\nMath. France, 123(2):257\u2013270, 1995.\nG. H. Hardy and E. M. Wright. An introduction to the theory of numbers. The\nClarendon Press Oxford University Press, New York, fifth edition, 1979.\nA. Katok. The growth rate for the number of singular and periodic orbits for\na polygonal billiard. Comm. Math. Phys., 111(1):151\u2013160, 1987.\nH. Masur. The growth rate of trajectories of a quadratic differential. Ergodic\nTheory Dynam. Systems, 10(1):151\u2013176, 1990.\nM. Morse and G. A. Hedlund. Symbolic dynamics II. Sturmian trajectories.\nAmer. J. Math., 62:1\u201342, 1940.\nF. Mignosi. On the number of factors of Sturmian words. Theoret. Comput.\nSci., 82(1, Algorithms Automat. Complexity Games):71\u201384, 1991.\n\nF\u00e9d\u00e9ration de recherches des unit\u00e9s de math\u00e9matiques de Marseille, Laboratoire d'Analyse Topologie et Probabilit\u00e9s UMR 6632 , Avenue Escadrille\nNormandie Niemen 13397 Marseille cedex 20, France\nE-mail address: nicolas.bedaride@univ-cezanne.fr, hubert@cmi.univ-mrs.fr\n\n\f"}