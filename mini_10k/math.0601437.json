{"id": "http://arxiv.org/abs/math/0601437v1", "guidislink": true, "updated": "2006-01-18T13:35:08Z", "updated_parsed": [2006, 1, 18, 13, 35, 8, 2, 18, 0], "published": "2006-01-18T13:35:08Z", "published_parsed": [2006, 1, 18, 13, 35, 8, 2, 18, 0], "title": "Return times, recurrence densities and entropy for actions of some\n  discrete amenable groups", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0601755%2Cmath%2F0601017%2Cmath%2F0601599%2Cmath%2F0601082%2Cmath%2F0601156%2Cmath%2F0601303%2Cmath%2F0601284%2Cmath%2F0601347%2Cmath%2F0601340%2Cmath%2F0601380%2Cmath%2F0601614%2Cmath%2F0601218%2Cmath%2F0601038%2Cmath%2F0601581%2Cmath%2F0601174%2Cmath%2F0601309%2Cmath%2F0601211%2Cmath%2F0601417%2Cmath%2F0601176%2Cmath%2F0601448%2Cmath%2F0601183%2Cmath%2F0601344%2Cmath%2F0601685%2Cmath%2F0601315%2Cmath%2F0601640%2Cmath%2F0601480%2Cmath%2F0601564%2Cmath%2F0601455%2Cmath%2F0601406%2Cmath%2F0601604%2Cmath%2F0601499%2Cmath%2F0601510%2Cmath%2F0601487%2Cmath%2F0601546%2Cmath%2F0601109%2Cmath%2F0601551%2Cmath%2F0601456%2Cmath%2F0601037%2Cmath%2F0601506%2Cmath%2F0601084%2Cmath%2F0601644%2Cmath%2F0601102%2Cmath%2F0601497%2Cmath%2F0601373%2Cmath%2F0601248%2Cmath%2F0601395%2Cmath%2F0601447%2Cmath%2F0601482%2Cmath%2F0601246%2Cmath%2F0601411%2Cmath%2F0601634%2Cmath%2F0601577%2Cmath%2F0601630%2Cmath%2F0601121%2Cmath%2F0601217%2Cmath%2F0601181%2Cmath%2F0601545%2Cmath%2F0601465%2Cmath%2F0601712%2Cmath%2F0601221%2Cmath%2F0601024%2Cmath%2F0601454%2Cmath%2F0601697%2Cmath%2F0601105%2Cmath%2F0601601%2Cmath%2F0601576%2Cmath%2F0601201%2Cmath%2F0601668%2Cmath%2F0601041%2Cmath%2F0601651%2Cmath%2F0601696%2Cmath%2F0601737%2Cmath%2F0601752%2Cmath%2F0601353%2Cmath%2F0601606%2Cmath%2F0601056%2Cmath%2F0601074%2Cmath%2F0601076%2Cmath%2F0601131%2Cmath%2F0601090%2Cmath%2F0601437%2Cmath%2F0601355%2Cmath%2F0601185%2Cmath%2F0601235%2Cmath%2F0601222%2Cmath%2F0601023%2Cmath%2F0601368%2Cmath%2F0601208%2Cmath%2F0601194%2Cmath%2F0601603%2Cmath%2F0601744%2Cmath%2F0601402%2Cmath%2F0601722%2Cmath%2F0601314%2Cmath%2F0601531%2Cmath%2F0601673%2Cmath%2F0601433%2Cmath%2F0601675%2Cmath%2F0601537%2Cmath%2F0601255%2Cmath%2F0601263&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Return times, recurrence densities and entropy for actions of some\n  discrete amenable groups"}, "summary": "Results of Wyner and Ziv and of Ornstein and Weiss show that if one observes\nthe first k outputs of a finite-valued ergodic process, then the waiting time\nuntil this block appears again is almost surely asymptotic to $2^{hk}$, where\n$h$ is the entropy of the process. We examine this phenomenon when the allowed\nreturn times are restricted to some subset of times, and generalize the results\nto processes parameterized by other discrete amenable groups.\n  We also obtain a uniform density version of the waiting time results: For a\nprocess on $s$ symbols, within a given realization, the density of the initial\n$k$-block within larger $n$-blocks approaches $2^{-hk}$, uniformly in $n>s^k$,\nas $k$ tends to infinity. Again, similar results hold for processes with other\nindexing groups.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0601755%2Cmath%2F0601017%2Cmath%2F0601599%2Cmath%2F0601082%2Cmath%2F0601156%2Cmath%2F0601303%2Cmath%2F0601284%2Cmath%2F0601347%2Cmath%2F0601340%2Cmath%2F0601380%2Cmath%2F0601614%2Cmath%2F0601218%2Cmath%2F0601038%2Cmath%2F0601581%2Cmath%2F0601174%2Cmath%2F0601309%2Cmath%2F0601211%2Cmath%2F0601417%2Cmath%2F0601176%2Cmath%2F0601448%2Cmath%2F0601183%2Cmath%2F0601344%2Cmath%2F0601685%2Cmath%2F0601315%2Cmath%2F0601640%2Cmath%2F0601480%2Cmath%2F0601564%2Cmath%2F0601455%2Cmath%2F0601406%2Cmath%2F0601604%2Cmath%2F0601499%2Cmath%2F0601510%2Cmath%2F0601487%2Cmath%2F0601546%2Cmath%2F0601109%2Cmath%2F0601551%2Cmath%2F0601456%2Cmath%2F0601037%2Cmath%2F0601506%2Cmath%2F0601084%2Cmath%2F0601644%2Cmath%2F0601102%2Cmath%2F0601497%2Cmath%2F0601373%2Cmath%2F0601248%2Cmath%2F0601395%2Cmath%2F0601447%2Cmath%2F0601482%2Cmath%2F0601246%2Cmath%2F0601411%2Cmath%2F0601634%2Cmath%2F0601577%2Cmath%2F0601630%2Cmath%2F0601121%2Cmath%2F0601217%2Cmath%2F0601181%2Cmath%2F0601545%2Cmath%2F0601465%2Cmath%2F0601712%2Cmath%2F0601221%2Cmath%2F0601024%2Cmath%2F0601454%2Cmath%2F0601697%2Cmath%2F0601105%2Cmath%2F0601601%2Cmath%2F0601576%2Cmath%2F0601201%2Cmath%2F0601668%2Cmath%2F0601041%2Cmath%2F0601651%2Cmath%2F0601696%2Cmath%2F0601737%2Cmath%2F0601752%2Cmath%2F0601353%2Cmath%2F0601606%2Cmath%2F0601056%2Cmath%2F0601074%2Cmath%2F0601076%2Cmath%2F0601131%2Cmath%2F0601090%2Cmath%2F0601437%2Cmath%2F0601355%2Cmath%2F0601185%2Cmath%2F0601235%2Cmath%2F0601222%2Cmath%2F0601023%2Cmath%2F0601368%2Cmath%2F0601208%2Cmath%2F0601194%2Cmath%2F0601603%2Cmath%2F0601744%2Cmath%2F0601402%2Cmath%2F0601722%2Cmath%2F0601314%2Cmath%2F0601531%2Cmath%2F0601673%2Cmath%2F0601433%2Cmath%2F0601675%2Cmath%2F0601537%2Cmath%2F0601255%2Cmath%2F0601263&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Results of Wyner and Ziv and of Ornstein and Weiss show that if one observes\nthe first k outputs of a finite-valued ergodic process, then the waiting time\nuntil this block appears again is almost surely asymptotic to $2^{hk}$, where\n$h$ is the entropy of the process. We examine this phenomenon when the allowed\nreturn times are restricted to some subset of times, and generalize the results\nto processes parameterized by other discrete amenable groups.\n  We also obtain a uniform density version of the waiting time results: For a\nprocess on $s$ symbols, within a given realization, the density of the initial\n$k$-block within larger $n$-blocks approaches $2^{-hk}$, uniformly in $n>s^k$,\nas $k$ tends to infinity. Again, similar results hold for processes with other\nindexing groups."}, "authors": ["Michael Hochman"], "author_detail": {"name": "Michael Hochman"}, "author": "Michael Hochman", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1007/BF02916754", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/math/0601437v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0601437v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "To appear in Journal d'Analyse Mathematique", "arxiv_primary_category": {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "37A50, 37A15, 37A35, 28D15, 28D20", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0601437v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0601437v1", "journal_reference": "Journal dAnalyse Mathematique, Volume 100 (2006), Issue 1, pp 1-51", "doi": "10.1007/BF02916754", "fulltext": "arXiv:math/0601437v1 [math.DS] 18 Jan 2006\n\nRETURN TIMES, RECURRENCE DENSITIES AND ENTROPY FOR\nACTIONS OF SOME DISCRETE AMENABLE GROUPS\nMICHAEL HOCHMAN\nAbstract. It is a theorem of Wyner & Ziv and Ornstein & Weiss that if one observes the initial k\nsymbols X0 , . . . , Xk\u22121 of a typical realization of a finite valued ergodic process with entropy h, the\nwaiting time until this sequence appears again in the same realization grows asymptotically like 2hk\n[7, 12]. A similar result for random fields was obtained in [8]: in this case one observes cubes in Zd\ninstead of initial segments.\nIn the present paper we describe generalizations of this. We examine what happens when the set\nof possible return times is restricted: Fix an increasing sequence of sets of possible times {Wn } and\ndefine Rk to be the first n such that X0 , . . . , Xk\u22121 recurs at some time in Wn . It turns out that\n|WRk | cannot drop below 2hk asymptotically. We obtain conditions on the sequence {Wn } which\nensure that |WRk | is asymptotically equal to 2hk .\nWe consider also recurrence densities of initial blocks and derive a uniform Shannon-McMillanBreiman theorem: Informally, if Uk,n is the density of recurrences of the block X0 , . . . , Xk\u22121 in\nX\u2212n , . . . , Xn then Uk,n grows at a rate of 2hk , uniformly in n. We examine the conditions under\nwhich this is true when the recurrence times are again restricted to some sequence of sets {Wn }\nThe above questions are examined in the general context of finite-valued processes parameterized\nby discrete amenable groups. We show that many classes of groups have time-sequences {Wn } along\nwhich return times and recurrence densities behave as expected. An interesting feature here is that\nthis can happen also when the time sequence lies in a small subgroup of the parameter group.\n\n1. Introduction\n1.1. Background. Let {Xn }n\u2208Z be an ergodic process with values in some finite set \u03a3, defined on\na probability space (\u03a9, F, P ). Let h denote the entropy of the process. For a realization x = (xn )n\u2208Z\nof the process and for each k consider the finite word x0 x1 . . . xk\u22121 obtained by viewing x through\nthe \"window\" consisting of coordinates 0, 1, . . . , k. The first backward recurrence time of this word\nis defined as\nRk\u2212 (x) = min{n : n > 0 and x\u2212n+i = xi for all 0 \u2264 i < k}\nSet Rk\u2212 (x) = \u221e if the sequence x0 x1 . . . xk\u22121 does not appear again in the past portion of x.\n1\nIn [12], A. Wyner and J. Ziv proved that k1 log Rk\u2212 \u2192 h in probability and lim supk 2k+1\nlog Rk\u2212 \u2264 h\nalmost surely. This result was strengthened by D. Ornstein and B. Weiss, who proved in [7] that in\n1\n\n\f2\n\nMichael Hochman\n\nfact\n(1.1)\n\nlim\n\nk\u2192\u221e\n\n1\nlog Rk\u2212 (\u03c9) = h\nk\n\nalmost surely.\nWyner and Ziv's definition of Rk\u2212 uses the past and future in an asymmetric fashion, but in\n[7] Ornstein and Weiss also define a more symmetric quantity, and prove a related limit result,\nwhich they later generalized in [8] to the case of Zd processes, or so-called random fields. These\nare families of random variables {Xu }u\u2208Zd which are stationary with respect to \"time shifts\" in Zd .\nIn this setting, the patterns we are trying to match, and the sets in which we look for recurrences\nof patterns, are based on the cubes Fn = [\u2212n; n]d (here and throughout, we denote the integer\nsegment {i, i + 1 . . . , j} for i < j by [i; j]). For a realization x = (xu )u\u2208Zd of the process, we obtain\na \"pattern\" on the cube Fk , which we denote x(Fk ), by coloring each v \u2208 Fk with the color xv . The\nfirst recurrence time of the Fk -pattern x(Fk ) is defined to be the first index n for which we observe\nthe pattern x(Fk ) centered at some point in Fn other than the origin. To be precise,\n(\n)\nfor some v 6= 0 in [\u2212n; n]d\nRk (\u03c9) = min n\nxv+u = xu for every u \u2208 Fk\nor Rk (\u03c9) = \u221e if the pattern does not recur. Then according to [8], with probability 1\n(1.2)\n\nlim\n\nk\u2192\u221e\n\nd\nlog Rk (\u03c9) = h\n(2k + 1)d\n\n(in [8] there is also a proof for patterns based on the cubes [0; n]d ).\nOur goal in this paper is to describe several generalizations of these phenomena for processes\nindexed by other amenable groups, though many of the results are new even for Z-processes\n\n1.2. Notation and preliminaries. Recall that a discrete countable group G is amenable if there\nexists a sequence of finite subsets {Fn } of G which are asymptotically invariant, ie for all g \u2208 G,\nlim\n\nn\u2192\u221e\n\n|Fn \u2206 gFn |\n= 0.\n|Fn |\n\n\b\n\u221e\nFor example, the sequence [\u2212n; n]d n=1 in Zd has this property. Such sequences are called F\u00f8lner\nsequences. Asymptotic invariance is equivalent to the following statement: for every finite K \u2286 G,\nit holds that\n1\n|{f \u2208 Fn : Kf \u2286 Fn }| = 1.\nlim\nn\u2192\u221e |Fn |\nThere are other equivalent definitions of amenability, some of which have a more analytic flavor,\nbut these will not interest us here; see eg [2].\n\n\fReturn times, recurrence densities and entropy\n\n3\n\nFor G a discrete amenable group we consider an ergodic process {Xg }g\u2208G taking values in a finite\nset \u03a3, defined on a standard probability space (\u03a9, F, P ). We will always assume that the process\narises from an ergodic measure preserving free left action of G on \u03a9, denoted (g, \u03c9) 7\u2192 g\u03c9, and from\na measurable function X : \u03a9 \u2192 \u03a3 such that Xg (\u03c9) = X(g\u03c9). We denote by h the entropy of the\nprocess.\nIt is convenient to associate the elements \u03c9 \u2208 \u03a9 with the \u03a3-colorings of G they induce: g 7\u2192 Xg (\u03c9).\nWe will often denote elements of \u03a9 by the letter x to emphasize this point of view, and write x(g)\nfor Xg (x). For x \u2208 \u03a9 and E \u2286 G we denote by x(E) the coloring of E by colors from \u03a3 given by\ng 7\u2192 x(g), and let [x(E)] \u2208 F be the atom\n[x(E)] = {x\u2032 \u2208 \u03a9 : \u2200f \u2208 E x\u2032 (f ) = x(f )}.\nMore generally, if \u03c6 \u2208 \u03a3E is a coloring of E by \u03a3, we write [\u03c6] for the atom defined by \u03c6\n[\u03c6] = {x \u2208 \u03a9 : \u2200f \u2208 E x(f ) = \u03c6(f )}\nand for \u03a6 \u2286 \u03a3Fn we set\n[\u03a6] =\n\n[\n\n[\u03c6].\n\n\u03c6\u2208\u03a6\n\nIt is known that the ergodic and entropy theorems hold along certain F\u00f8lner sequences. The\nweakest condition known to ensure this is\nDefinition 1.1. A F\u00f8lner sequence {Fn } in G is tempered if for some constant C independent of\nS\nn, |( k<n Fk\u22121 )Fn | \u2264 C|Fn | for every n.\n(We extend the group operations to sets in the usual manner, so AB = {ab : a \u2208 A , b \u2208 B},\netc).\nThroughout this paper, {Fn } will denote a tempered F\u00f8lner sequence which also satisfies |Fn | \u2265 n.\nIt is not hard to see that if G is an infinite group any F\u00f8lner sequence in G has a tempered\nsubsequence satisfying this.\nFor a tempered F\u00f8lner sequence, the ergodic theorem states that for every f \u2208 L1 (\u03a9, F, P ),\nZ\n1 X\nlim\nf (g\u03c9) = f dP\nn\u2192\u221e |Fn |\ng\u2208Fn\n\nalmost everywhere and in L1 .\nThe entropy of a process {Xh }g\u2208G is defined as in the case of Z-processes by\n1\nH({Xg }g\u2208Fk )\nk\u2192\u221e |Fk |\n\nh = lim\n\n\f4\n\nMichael Hochman\n\nwhere H(*) is the usual entropy function defined for any finite-valued random variable. For a\ndiscussion of entropy theory of amenable processes see [11].\nFor such processes, the Shannon-McMillan-Breiman (SMB) theorem states that for {Fn } a tempered sequence,\n1\nlog P ([x(Fn )]) \u2192 h\n|Fn |\nfor almost every x \u2208 \u03a9. In this generality, these theorems are due to E. Lindenstrauss [5]; see also\n[11] and [6].\n1.3. Return times. In the return-time theorems stated above for Z and Zd processes a single\nF\u00f8lner sequence {Fn } (segments or cubes) was used both to define the \"shape\" of the patterns whose\nrepetitions we are looking for and as the shape of the domain in which we seek these repetitions.\nThere is no reason for the same sequence to play both these roles, and it will be useful to separate\nthem. In our formulation of the problem we will consider two sequences of finite subsets of G: {Fn }\n(F for F\u00f8lner) which will serve as the shape of the patterns, and {Wn } (W for window) which will\nserve as the set within which we search for repetitions. Throughout, {Fn } will be a tempered F\u00f8lner\nsequence satisfying |Fn | \u2265 n. The properties we demand of {Wn } will vary.\nWe will be interested in the recurrence of Fk -patterns in the windows Wn . We say that x(Fk )\nrepeats at a point f \u2208 G if f x \u2208 [x(Fk )], ie if f x(g) = x(g) for every g \u2208 Fk . If x(Fk ) repeats at f ,\nwe say that the repetition is disjoint from Fk (or from x(Fk )) if Fk \u2229 Fk f = \u2205.\nDefine\n)\n(\nthere exists a disjoint\n(F,W )\nRk (x) = Rk\n(x) = min n\nrepetition of x(Fk ) in Wn\nor Rk (x) = \u221e if the set on the right in empty.\nRemarks.\n(1) Rk (x) is the first \"return index\" of x to [x(Fk )], excluding recurrences which intersect the\noriginal pattern x(Fk ). In this respect our definition differs from the definition for the case\nG = Zd from [8] described in the previous section, where it is not required that the repetition\nbe disjoint from the original occurrence of the pattern.\n(2) We require only that the \"center\" of the repetition f to be in Wn . We do not require the\nwhole of the repetition to be in Wn , ie we do not require Fk f \u2286 Wn . Note that in the\nknown cases of cubes, Fn , Wn = [\u2212n; n]d \u2286 Zd , requiring that the repetition of x(Fk ) be\ncompletely contained in WRk does not change the asymptotic behavior of Rk . In general,\nhowever, the definitions are not equivalent. Indeed it is not necessary that any translate of\nFk be contained in any Wn .\n\n\fReturn times, recurrence densities and entropy\n\n5\n\n(3) In what follows we will be working with several different sequences and then the notation\n(F,W )\nwill be used to emphasize the dependence on {Fn } and {Wn }.\nRk\n(4) If {Fn } is any sequence (not necessarily F\u00f8lner) and {Wn } is a tempered F\u00f8lner sequence\n(F,W )\n(x) is finite almost surely. In other cases it is\nthen the ergodic theorem implies that Rk\nnot clear that Rk < \u221e, and for general window sequence this may not be the case.\nRk is not a very \"stable\" quantity, and even when finite we cannot hope for its growth rate to\nprovide any significant information about the process, since it strongly reflects the indexing of the\nsequence {Wn }. For any G-process and choice of {Fn } and {Wn }, the value of Rk may be arbitrarily\nincreased simply by allowing repetitions in the Wn 's, or decreased by thinning the window sequence\nout. A better measure of return time is the volume (=size) of the window set in which the repetition\nis observed. We therefore define\n(F,W )\n= |WR(F,W ) |\nTk = Tk\nk\n\nor Tk = \u221e if Rk = \u221e, and set\n\u2217\nT \u2217 = T(F,W\n) = lim sup\nk\u2192\u221e\n\n(F,W )\n\nT\u2217 = T\u2217\n\n= lim inf\nk\u2192\u221e\n\n1\n(F,W )\nlog Tk\n|Fk |\n\n1\n(F,W )\n.\nlog Tk\n|Fk |\n\nZd\n\nThe aforementioned result for\ncan be given in terms of Tk , since for Wn = [\u2212n; n]d , the size of\nWRk is (2Rk + 1)d ; the result then is equivalent to T \u2217 = T\u2217 = h.\nOne half of the Zd return-time theorem is true in the following very general form, which provides\nnew information even about Z processes:\nTheorem 1.2. Let G be a countable amenable group and {Xg }g\u2208G a finite-valued ergodic G-process.\nIf {Fn } is a tempered F\u00f8lner sequence in G and {Wn } an increasing sequence of finite subsets of G,\nthen for almost every x,\n(F,W )\n\nT\u2217\n\n(x) = lim inf\nk\u2192\u221e\n\n1\n(F,W )\n(x) \u2265 h.\nlog Tk\n|Fk |\n\nOne might hope that the bound T \u2217 \u2264 h is also true; if it were, we would have lim |F1k | log Tk = h.\nThis need not be true for general window sequences. The asymmetry between T\u2217 and T \u2217 , which\ndoes not appear in the special cases examined in [8], is not due to some shortcoming of our methods,\nbut is inherent in the problem. To begin with, in order for the upper bound to hold, at the very least\nsome growth condition must be imposed on {Wn }. For example if we set Fn = Wn = [0; 2|Fn\u22121 | ] \u2286 Z\nthen |Fn+1 | > 2|Fn | so |F1n | log Tk \u2265 1 is always true, even if h < 1. We therefore cannot hope for a\ngood upper bound on the growth rate of Tk if we do not restrict the growth of the window sequence\n{Wn }.\n\n\f6\n\nMichael Hochman\n\nEven if the sequence {Wn } grows slowly, the inequality T \u2217 \u2264 h need not hold. For a simple\nexample, consider the process of alternating sequences of 0s and 1s with equal probabilities for\nobserving 0 or 1 at any given place, so the possible realizations are . . . 0101010 . . . and . . . 1010101 . . ..\nThis process is clearly ergodic and has entropy 0. If we take Fn = [\u2212n; n] and Wn to be sets\ncontaining only odd integers, eg Wn = [\u2212n, n] \u2229 (2Z + 1), then Rk = \u221e for every realization. In\nthis example {Wn } is of course not a F\u00f8lner sequence; in section 2.7 we show that the upper bound\nmay fail even when {Wn } are \"almost\" segments and possess extremely good properties which are\nknown to be sufficient for the ergodic and SMB theorems to hold.\nIn order to state our results about T \u2217 we will require {Wn } to have some additional combinatorial\nproperties, which will play a role, in various forms, also in the density theorems stated below.\nDefinition 1.3. Let {Wn } be some sequence of finite subsets of G. A sequence of right-translates\n{Wn(i) fi }Ii=1 (fi \u2208 G) is called incremental if\n(1) n(1) \u2265 n(2) \u2265 . . . \u2265 n(I).\n(2) fi \u2208\n/ \u222aj<i Wn(j) fj for 1 \u2264 i \u2264 I.\nDefinition 1.4. Let {Wn } be a sequence of finite subsets of G with 1G \u2208 Wn . {Wn } is filling with\nconstant C (or C-filling) if for every incremental sequence {Wn(i) fi } it holds that | \u222a Wn(i) fi | \u2265\nP\nC |Wn(i) fi |. A set W is individually C-filling if for every incremental sequence {W fi } it holds\nP\nthat | \u222a W fi | \u2265 C |W fi |.\n\nThe statement that {Wn } is filling means, informally, this: suppose one tries to cover G with\ntranslates of the Wn , using a \"greedy\" algorithm, that is, putting down some translate of a Wn , then\nanother (possibly smaller) Wk over a point not yet covered, etc. Note that we allow the different\ntranslates to intersect. Then if you stop after finitely many steps, the size of what has in fact been\ncovered will be proportional to the total of the sizes of the Wn 's used up until that stage.\n1\nA fixed set W is filling with constant |W\n| because in an incremental sequence each point is covered\nat most |W | times, but generally sequences {Wn } containing infinitely many different sets will not\nbe filling, as demonstrated by the sequence {[0; n]}\u221e\nn=1 in Z (though not filling, this is a tempered\nF\u00f8lner sequence). On the other hand one can verify that {[\u2212n; n]}\u221e\nn=1 is filling in Z. Still another\nexample is the sequence {[\u2212n; n] \u2229 2Z} in Z which is filling but not a F\u00f8lner sequence.\nFrom these examples it should be clear that the notion of being filling is rather delicate, and not\nrelated directly to amenability. In particular, note that while a F\u00f8lner sequence is in some sense a\nlarge subset of the group, a filling sequence can be small, eg contained in a proper subgroup.\n\nDefinition 1.5. An increasing sequence {Wn } of finite subsets of G with 1G \u2208 Wn is quasi-filling\nP |Wn|\u2212\u03b1\nif each Wn is Cn -filling and\n< \u221e for every \u03b1 > 0.\nCn\n\n\fReturn times, recurrence densities and entropy\n\n7\n\nNote that in general filling sequences need not be quasi filling.\nTheorem 1.6. Let G be a countable amenable group and {Xg }g\u2208G a finite-valued ergodic G-process.\nIf {Fn } is a tempered F\u00f8lner sequence in G and {Wn } either a filling or a quasi-filling sequence\nlog |Wn |\nsuch that limn log\n|Wn\u22121 | = 1, then\nT \u2217 = lim sup\nk\u2192\u221e\n\n1\n(F,W )\n\u2264h\nlog Tk\n|Fk |\n\nalmost surely.\nCorollary 1.7. If {Fn }, {Wn } satisfy the conditions of theorem 1.6 and 4.3, then\n1\n(F,W )\nlog Tk\n=h\nk\u2192\u221e |Fk |\nlim\n\nalmost surely.\nIt is interesting to note that in [8], the return times theorem was proved also for the case Fn =\nWn = [0; n]d \u2286 Zd , which is not covered by our results, because {[0; n]d } is not (quasi) filling. We\nwill not discuss this here.\n1.4. Recurrence densities. As we have seen, if {Wn } grows too swiftly it may not be possible\nfor T \u2217 \u2264 h to hold, because the first Wn within which we observe x(Fk ) may be too large compared\nto Fk . To compensate for this, one expects that the number of times the pattern x(Fk ) appears in\nWn will grow along with |Wn |.\nAnother way of looking at it is this: Suppose {Fn } , {Wn } are sequences such that the return times\n(F,W )\n\u2192 h. If {Wn } grows slowly enough, then one sees\ntheorem of the last section holds: |F1k | log Tk\nfrom the return time theorem that the density of recurrences of x(Fk ) in WRk (x)\u22121 is approximately\n2\u2212h|Fk | , since only the central copy of the pattern exists. Now suppose in addition that {Wn } is\nitself a tempered F\u00f8lner sequence; since by the SMB theorem the probability of the atom [x(Fk )]\nis approximately 2\u2212h|Fk | , the ergodic theorem tells us that for large enough n (depending on k\nand x) the frequency with which x(Fk ) repeats in x(Wn ) is approximately equal to the probability\nof the atom [x(Fk )]. So we see that for large k, the density of recurrences of x(Fk ) in x(Wn ) is\nclose to 2\u2212h|Fk | both when n is small (but large enough for the question to be meaningful) and for\nlarge enough n. However, neither the return-time theorem nor the ergodic theorem give us any\ninformation about what happens for intermediate values of n.\nWe define the recurrence frequency of x(Fk ) in x(Fn ) to be\n\uf8fc\n\uf8f1\n\uf8f4\n\uf8f4\n1\n\u2208\nE\n\u2286\nW\n,\nthe\ncollection\nG\nn\n\uf8fd\n\uf8f2\n1\n(F,W )\nUk,n (x) = Uk,n (x) =\nmax |E| {Fk f }f \u2208E is pairwise disjoint,\n\uf8f4\n\uf8f4\n|Wn |\n\uf8fe\n\uf8f3\nand x(Fk ) repeats at f\n\n\f8\n\nMichael Hochman\n\nand\n\n1\n(F,W )\nlog Uk,n\n|Fk |\nn\nk\u2192\u221e\n1\n1\n(F,W )\n= lim inf inf \u2212\nlog(Uk,n \u2212\n).\nk\u2192\u221e n\n|Fk |\n|Wn |\n\nU \u2217 = U (F,W )\u2217 = lim sup sup \u2212\n(F,W )\n\nU\u2217 = U\u2217\nRemarks:\n\n(1) The quantity Uk,n was defined as the (maximal) density of disjoint repetitions of x(Fk ) in\nWn , one of which is the original pattern. One may attempt to define Uk,n differently, eg\nby counting every repetition or counting every repetition disjoint from the original pattern\n(but not mutually disjoint). These variations are discussed in more detail in sections 3.1\nand 4.5.\n(2) The reason for the correction factor \u2212 |W1n| in the definition of U\u2217 is that our goal is to prove\nU\u2217 \u2265 h, but in our definition of Uk,n we allowed the \"central\" copy of x(Fk ) to be counted.\nThis being the case, we cannot expect the observed frequency Uk,n to drop below 2\u2212h|Fk | if\nthe size |Wn | is not on the order of 2h|Fk | .\nAs in the case of T \u2217 , in order to prove U\u2217 = U \u2217 = h we need some assumptions about the combinatorial properties of the window sequence {Wn }. For the bound U \u2217 \u2264 h, it is enough that {Wn }\nbe filling (definition 1.4 above):\nTheorem 1.8. Let G be a countable amenable group and {Xg }g\u2208G a finite-valued ergodic G-process.\nLet {Fn } be a tempered F\u00f8lner sequence in G. If {Wn } is a filling sequence, then\nU \u2217 = lim sup sup \u2212\nk\u2192\u221e\n\nn\n\n1\n(F,W )\nlog Uk,n \u2264 h\n|Fk |\n\nalmost surely.\nSee also theorem 3.3 below for a slightly weaker version which applies to quasi-filling sequences.\nFor the lower bound U\u2217 \u2265 h we need an even stronger notion of \"filling up space\":\nDefinition 1.9. An increasing sequence {Wn } of finite subsets of G with 1G \u2208 Wn is said to be\n\b\nincompressible with constant C (or C-incompressible) if for any incremental sequence Wn(i) fi ,\nthe number of the sets Wn(i) fi containing 1G is at most C. A finite set W \u2286 G containing 1G is\nindividually C-incompressible if for any incremental sequence {W fi }, the number of the sets W fi\ncontaining 1G is at most C.\nClearly the condition that 1G be in at most C sets is equivalent to requiring that every g \u2208 G is\ncontained in at most C sets. It follows that a C-incompressible sequence is C1 -filling.\nAny finite set W containing 1G is |W |-incompressible. Ascending sequences of subgroups, and\nascending centered cubes in Zd , are examples of incompressible sequences (see also section 2).\n\n\fReturn times, recurrence densities and entropy\n\n9\n\nWe also need the following:\nDefinition 1.10. Let {Fn }, {Wn } be sequences of finite subsets of G. A sequence {Yn } of finite\nsubsets of G is called an interpolation sequence for {Fn }, {Wn } if\n(1) {Yn } is filling.\n(2) There exists a constant C such that if |Wn | \u2265 |Yk | then |Yk Wn | \u2264 C|Wn |.\n(3) For every pair of real numbers 0 \u2264 \u03b1 < \u03b2, for every large enough n there is an index k such\nthat 2\u03b1|Fn | \u2264 |Yk | \u2264 2\u03b2|Fn | .\nIn the case where Fn = Wn , we say simply that {Yk } is an interpolation sequence for {Fn }.\nNote that {Fn } appears only in condition (3) of the definition, and will be satisfied automatically\nlog |Yn |\n(for any sequence {Fn }) if limn log\n|Yn\u22121 | = 1.\nAs an example, one may consider the sequence {[\u2212n; n]} of intervals in Z, which is its own\ninterpolation sequence. In fact if G contains an element of infinite order, and we identify the\ninfinite-cyclic group it generates with Z, then segments in this subgroup can often serve as an\ninterpolation sequence for a suitably chosen window sequence in G. We come back to this in section\n2.6.\nTheorem 1.11. Let G be a countable amenable group and {Xg }g\u2208G a finite-valued ergodic Gprocess. Let {Fn } be a tempered F\u00f8lner sequence in G. Let {Wn } be an incompressible sequence. If\nthere exists an interpolation sequence for {Fn }, {Wn }, then\n(F,W )\n\nU\u2217\n\n= lim inf inf \u2212\nk\u2192\u221e\n\nn\n\n1\n1\n(F,W )\nlog(Uk,n \u2212\n)\u2265h\n|Fk |\n|Wn |\n\nalmost surely.\nSince T\u2217 \u2265 h almost surely, we have U\u2217 = lim inf k inf n \u2212 |F1k | log Uk,Rk (ie the correction term may\nbe dropped), so\nCorollary 1.12. If {Fn },{Wn } are as in theorem 1.11, then\nlim \u2212\nk\n\n1\n(F,W )\nlog Uk,Rk = h\n|Fk |\n\nalmost surely.\nA slightly weaker condition than incompressibility is the following:\nDefinition 1.13. Let {Wn } be an increasing sequence of finite subsets of G containing 1G , and suppose that each Wn is individually C-incompressible (for the same C). {Wn } is quasi-incompressible\nif for every \u03bb > 0 and large enough k, for every n > k the Wk boundary of Wn is at most a |Wk |\u2212\u03bb\n\n\f10\n\nMichael Hochman\n\nfraction of Wn , ie\n\n1\n{f \u2208 Wn : Wk f 6\u2286 Wn } \u2264 |Wk |\u2212\u03bb .\n|Wn |\n\nNote that with this definition, an incompressible sequence may not be quasi-incompressible.\nTheorem 1.14. Let G be a countable amenable group and {Xg }g\u2208G a finite-valued ergodic Gprocess. Let {Fn } be a tempered F\u00f8lner sequence and {Wn } a quasi-incompressible sequence in G.\nIf there exists an interpolation sequence for {Fn }, {Wn }, then for almost every x,\n(F,F )\n\nU\u2217\n\n(x) = lim inf inf \u2212\nk\u2192\u221e\n\nn\n\n1\n1\n(F,F )\nlog(Uk,n (x) \u2212\n) \u2265 h.\n|Fk |\n|Fn |\n\nRemark. We have not required in any of the theorems that {Wn } be a F\u00f8lner sequence. In fact one\nmay verify that if H < G and {Wn } is a sequence of subsets of H satisfying one of the various filling\nproperties described above (except for the property of the existence of an interpolation sequence),\nthen the property continues to hold when {Wn } is viewed as a sequence of subsets of G. This\nmeans that the recurrence phenomena we have described can often be observed when one counts\nrepetitions in a subgroup of G. We will come back to this in more detail in section 2.6 below.\nThe rest of this paper is organized as follows. In section 2 we discuss various ways to construct\ngood window sequences and classes of groups in which there exist good window sequences, with\nrespect to which the recurrence phenomena hold. We also give an example showing that other\nplausible combinatorial properties of {Wn } do not ensure that the upper bounds for T \u2217 and U \u2217\nhold. In section 3 we prove the upper bounds T \u2217 , U \u2217 \u2264 h. In section 4 we prove the lower bound\nT\u2217 \u2265 h, whose proof has a different flavor than the others, and U\u2217 \u2265 h, which depends strongly on\nthe lower bound T\u2217 \u2265 h. Finally in section 5 we state some open questions.\nAcknowledgement. The results in this paper are part of the author's MA thesis, conducted under\nthe guidance of Prof. B. Weiss, whom I would like to thank for all his patience and good advice.\n\n2. Constructions, examples and counterexamples\nIn this section we will examine the problem of the existence of good window sets. We consider\ntwo questions: When do good window sets exist at all, and when do \"large\" window sets exist. By\nlarge we mean window sequences which are themselves F\u00f8lner sequences. We also give an example\nwhich shows that, while the filling properties may not be strictly necessary for our theorems to\nhold, other combinatorial conditions on the window sequence, which are known to be sufficient for\nother pointwise theorems, are not sufficient for upper bounds on return times and densities.\n\n\fReturn times, recurrence densities and entropy\n\n11\n\n2.1. General constructions. Before going into concrete examples we examine how good window\nand interpolation sequences can be constructed from other sequences.\nLemma 2.1. Suppose {Wn\u2032 } is C \u2032 -incompressible in G\u2032 and {Wn\u2032\u2032 } is C \u2032\u2032 -incompressible in G\u2032\u2032 . Set\nWn = Wn\u2032 \u00d7 Wn\u2032\u2032 . The {Wn } is incompressible in G = G\u2032 \u00d7 G\u2032\u2032 .\nProof. Clearly {Wn } is increasing and 1G \u2208 Wn for all n. Suppose {Wn(i) gi Ii=1 } is incremental\n\u2032 g\u2032\nand 1G \u2208 \u2229i Wn(i) gi ; we must show that I is bounded. Write gi = (gi\u2032 , gi\u2032\u2032 ). Since 1G\u2032 \u2208 \u2229i Wn(i)\ni\n\u2032\u2032 g \u2032\u2032 , it suffices to show that there is a C such that if I > C then either there is\nand 1G\u2032\u2032 \u2208 \u2229i Wn(i)\ni\n\u2032\n\n\u2032\n\u2032 }C +1 incremental or there is a\na subsequence {i(1), . . . , i(C \u2032 + 1)} \u2286 {1, . . . , I} with {Wn(i(j))\ngi(j)\ni=1\n\u2032\u2032\n\n\u2032\n\u2032 }C +1 incremental.\nsubsequence {i(1), . . . , i(C \u2032\u2032 + 1)} \u2286 {1, . . . , I} with {Wn(i(j))\ngi(j)\ni=1\nWe prove this claim by induction on C \u2032 + C \u2032\u2032 . To be precise, we claim that for each pair C \u2032 , C \u2032\u2032\nthere is a number \u03b1(C \u2032 , C \u2032\u2032 ) such that if {Wn(i) gi }Ii=1 is an incremental sequence in G of length\nI > \u03b1(C \u2032 , C \u2032\u2032 ) then either its projection on the first coordinate has an incremental subsequence of\nlength greater than C \u2032 or its projection on the second coordinate has an incremental subsequence\nof length C \u2032\u2032 . Clearly\n\u03b1(C \u2032 , 1) = C \u2032 \u03b1(1, C \u2032\u2032 ) = C \u2032\u2032 \u03b1(1, 1) = 1.\n\b\nI\nFor the induction step, let Wn(i) gi i=1 be incremental in G. Write\no\no\nn\nn\n\u2032\u2032\n\u2032\n/ Wn(1)\ng1\u2032\u2032\nU1 = 1 < i \u2264 I : gi\u2032 \u2208\n/ Wn(1)\ng1\u2032 , U2 = 1 < i \u2264 I : gi\u2032\u2032 \u2208\n\b\nclearly U1 \u222a U2 = {2, . . . , I}. If |U1 | > \u03b1(C \u2032 \u2212 1, C \u2032\u2032 ) or |U2 | > \u03b1(C \u2032 , C \u2032\u2032 \u2212 1) then Wn(i) gi has\na subsequence of the type we desire. But one of these relations will certainly hold if |U1 \u222a U2 | >\n\u03b1(C \u2032 \u2212 1, C \u2032\u2032 ) + \u03b1(C \u2032 , C \u2032\u2032 \u2212 1), so we can set\n\n\u03b1(C \u2032 , C \u2032\u2032 ) = \u03b1(C \u2032 \u2212 1, C \u2032\u2032 ) + \u03b1(C \u2032 , C \u2032\u2032 \u2212 1) + 1.\n\n\u0003\n\nThe point here is that we obtain a \"large\" incompressible sequence in G\u2032 \u00d7 G\u2032\u2032 . \"Small\" sequences\nexist since an incompressible sequence in G\u2032 (or G\u2032\u2032 ) is incompressible in G\u2032 \u00d7 G\u2032\u2032 with the natural\nembedding. Note that if {Wn\u2032 } , {Wn\u2032\u2032 } are F\u00f8lner sequences in G\u2032 , G\u2032\u2032 respectively then {Wn\u2032 \u00d7 Wn\u2032\u2032 }\nis F\u00f8lner in G\u2032 \u00d7 G\u2032\u2032 .\nIn [10] it was shown how certain properties of F\u00f8lner sequences can be pulled up through exact\nsequences. We rematk that we do not know whether the existence of filling or incompressible F\u00f8lner\nsequences in K and G/K for a normal subgroup K of G implies that such sequences exist in G,\nalthough it seems unlikely that this is the case (again, the sequence in K has the same good filling\nproperties in G, but is not F\u00f8lner).\nThe requirement that {Wn } be C-filling (or C-incompressible) is a property of the entire sequence,\nand in particular implies that each Wn is C-filling (C-incompressible) as an individual set. The\n\n\f12\n\nMichael Hochman\n\nexistence of a constant C such that each Wn is C-filling (C-incompressible) does not imply that the\nsame about the sequence. One can, however, sometimes pass to a subsequence of the {Wn } which\nwill be filling.\n\nLemma 2.2. Suppose {Wn } is an increasing sequence of finite subsets of G with 1G \u2208 Wn such\nthat\n(1) {Wn } is a F\u00f8lner sequence.\n(2) For some constant C, each Wn is individually C-filling.\n\b\nThen there exists a subsequence Wn(i) which is filling.\nProof. Since {Wn } is a F\u00f8lner sequence, we may select a subsequence {Wn(i) } with the property\nthat\n\b\n1\nC\ng \u2208 Wn(i) : Wn(i\u22121) g \u2286 Wn(i) \u2265 .\n|Wn(i) |\n2\n\n\u2032 f }J\nWrite Wi\u2032 = Wn(i) ; we claim that {Wi\u2032 } is filling. Suppose that {Wi(j)\nj j=1 is an incremental sequence. Let I(1) > . . . > I(N ) be all the values of i(1), . . . , i(J), and let Jk = {1 \u2264 j \u2264 J : I(j) = k}.\nSince WI(1) is C-filling, we have\nX\n[\n|WI1 fj |.\nWI(1) fj | \u2265 C\n|\nj\u2208J1\n\nj\u2208J1\n\nLet\nE1 = {g \u2208\n\n[\n\nWI(1) fj : WI(2) g \u2286\n\n[\n\n|E1 | \u2265 |\n\n[\n\nWI(1) fj | \u2212 |{g \u2208\n\nX\n\n|WI(1) fj | \u2212\n\n[\n\nWI(1) fj }|\n\nj\u2208J1\n\nXC\n|W fj |\n2 I(1)\n\nj\u2208J1\n\nj\u2208J1\n\n=\n\nWI(1) fj : WI(2) g 6\u2286\n\nj\u2208J1\n\nj\u2208J1\n\n\u2265 C\n\nWI(1) fj }\n\nj\u2208J1\n\nj\u2208J1\n\nthen\n\n[\n\nC X\n|WI(1) fj |\n2\nj\u2208J1\n\nso\n|\n\n[\n\nj\u2208J1\n\nWI(1) fj \\\n\n[\n\nj\u2208J2 \u222a...\u222aJN\n\nWi(j) fj | \u2265 |E1 | \u2265\n\nC X\n|WI1 fj |\n2\nj\u2208J1\n\n\fReturn times, recurrence densities and entropy\n\n13\n\nS\nwhich means that the fraction of j\u2208J1 WI(1) fj which is not contained in any of the \"lower levels\"\nP\nis at least C2 j\u2208J1 |WI(1) fj |. Repeating this argument for I(1), . . . , I(N ) we obtain\n|\n\n[\n\n1\u2264j\u2264J\n\nWi(j) fj | \u2265\n\nC X\n|Wi(j) fj |.\n2\n\n\u0003\n\n1\u2264j\u2264J\n\nThe following is proved similarly:\nLemma 2.3. Suppose {Wn } is an increasing sequence of finite subsets of G with 1G \u2208 Wn such\nthat\n(1) {Wn } is a F\u00f8lner sequence.\n(2) For some constant C, each Wn is C-incompressible.\nThen there exists a subsequence {Wn(i) } which is quasi-incompressible .\nThe last construction in this section deals with the existence of interpolation sequences.\nLemma 2.4. Let {Fn } be an increasing tempered F\u00f8lner sequence. Suppose {Yn } is increasing and\nfilling. Then there exists a subsequence {Fn(i) } of {Fn } such that the sequence Yn is an interpolation\nsequence for {Fn(i) }.\nFor the sequence {Yn } to be useful, {Fn } must fulfill the hypothesis of theorem 1.11 and so {Fn }\nmust also be incompressible or quasi-incompressible; but this is not necessary for the proof of the\nlemma.\nProof. Let {[\u03b1i , \u03b2i ]}\u221e\ni=1 be an enumeration of the rational intervals, 0 \u2264 \u03b1i < \u03b2i . We select Fn(k)\nand sets Zi,k = Ym(i,k) (1 \u2264 i < k) inductively in k, as follows: Given k and assuming that we have\ndefined Fn(j) and Zi,j for every 1 \u2264 i < j < k, we select Fn(k) and Zi,k for 1 \u2264 i < k so that\n(a)\n(b)\n(c)\n(d)\n\nZi,k satisfies 2\u03b1i |Fn(k\u22121) | \u2264 |Zi,k | \u2264 2\u03b2i |Fn(k\u22121) | .\nFn(k) is large enough that for all i < k it holds that |Fn(k) | < 2\u03b1i |Fn(k) | .\nS\n|( i<k\u22121 Zi,k\u22121 )Fn(k) | \u2264 2|Fn(k) |.\nn(k) is large enough so that for 1 \u2264 i \u2264 k and every n > n(k) there exists m such that\n2\u03b1i |Fn | < |Ym | < 2\u03b2i |Fn| .\n\nOne then verifies that {Zi,k } is an interpolation sequence for {Fn(k) }. Briefly, (a) ensures that\n(3) of the definition of interpolation sequences holds, while (b) and (c) ensure condition (2), and\n(d) makes it possible to continue the construction ((a) is possible for k because for j < k we chose\nWn(j) to satisfy (d) ).\n\u0003\n2.2. The groups Z and Zd . In the case of Z, any increasing sequence of symmetric intervals {In }\nis 2-incompressible. This is simple to verify.\n\n\f14\n\nMichael Hochman\n\nNext, Zd is the product of Z with itself d times, we know from lemma 2.1 that incompressible\nsequences exist. In fact,\n(i)\n\nProposition 2.5. If {In }\u221e\nn=1 are increasing sequences of symmetric intervals, i = 1, . . . , d, then\n(1)\n(d)\nthe sets Wn = In \u00d7 . . . \u00d7 In form an 2d -incompressible sequence.\nLemma 2.1 gives a poorer estimate for the constant. That the constant 2d is correct (and optimal)\nfor such sequences can be established directly.\nWe will call sets of the form in the proposition boxes. If {Wn } is an increasing symmetric sequence\nof boxes, then it is easy to see that for any n we can find boxes Wn = Yn,0 \u2286 . . . \u2286 Yn,k(n) = Wn+1\nsuch that |Yn,i+1 |/|Yn,i | \u2264 2. Ordering all the Yn,i in a single increasing sequence {Ym }, we obtain\na filling sequence which grows at most exponentially. It is easy to verify that |Wn + Ym | \u2264 2d |Wn |\nwhenever |Wn | \u2265 |Ym |; so {Ym } is an interpolation sequence for {Wn }. This gives\nProposition 2.6. For G = Zd , any increasing sequence {Wn } of boxes and any tempered F\u00f8lner se(F,W )\n(F,W )\nlog |Wn+1 |\n\u2217\n= U(F,W\n\u2265 h and U\u2217\nquence {Fn } (and in particular Fn = Wn ), T\u2217\n) = h. If limn log |Wn | =\n(F,W )\n\n1 then T\u2217\n\n\u2217\n= T(F,W\n) = h.\n\nThis is essentially a reformulation of the results from [8].\nOne can show that certain increasing sequences of symmetric convex sets in Zd are incompressible\nas well.\nd\n2.3. The group Z\u221e . Consider the group Z\u221e = \u2295\u221e\nn=1 Z. Identify the subgroups Z \u00d7 {(0, 0 . . .)} \u2286\nZ\u221e with Zd in the obvious way.\n\nProposition 2.7. Let A \u2286 Zd have full dimension (ie hAi is of abelian rank d). If A is Cincompressible then C > d.\nProof. For a set A \u2286 Qd , we say that u \u2208 Qd is an extreme point of A if it is an extreme point of\nconvQ A.\nWe prove the following: If A \u2286 Qd is finite and has dim hAi = d, and 0 is an extreme point of\nA, then there exists a set {u1 , . . . , ud+1 } \u2286 \u2212A such that {A + ui }d+1\ni=1 is incremental. In this case,\nclearly 0 \u2208 \u2229(A + ui ), so A cannot be C-incompressible for C \u2264 d.\nThe proof is by induction on d. For d = 1 the claim is trivial: take a1 = 0 and a2 \u2208 A \\ {0}.\nNow suppose we have proved it for d \u2212 1. Let A \u2286 Qd be as in the claim. Set E = ext conv A,\nso by assumption 0 \u2208 E. Since A is d-dimensional, so is E. Select a linearly independent set\na1 , . . . , ad\u22121 \u2208 E \\ {0}. Write V = spanQ {a1 , . . . , ad\u22121 }, and assume {ai } was selected so that A is\non one side of the subspace V , ie there is a linear functional \u039b with \u039b(A) \u2286 Q+ and V = ker \u039b.\n\n\fReturn times, recurrence densities and entropy\n\n15\n\nConsider A\u2032 = A \u2229 V . This is a finite set of full dimension in V containing 0 as an extreme point.\nTherefore there exist u1 , . . . , ud \u2208 \u2212A\u2032 with {A\u2032 + ui }di=1 incremental. Clearly {A + ui }di=1 is also\nincremental. Now we need only note that for any u \u2208 A \\ A\u2032 , we have that \u2212u \u2208\n/ \u222adi=1 A + ui because\n\u039b(u) < 0 whereas \u039b(a + ui ) = \u039b(a) + 0 \u2265 0 for all a \u2208 A and i = 1, . . . , d. Thus {u1 , u2 , . . . , ud , \u2212u}\nis the set we are looking for. This completes the induction step.\nThe proposition now follows from the fact that it holds for A iff it holds for every translate of A,\nand we can always translate A so that 0 is an extreme point.\n\u0003\nCorollary 2.8. There are no incompressible F\u00f8lner sequences in Z\u221e .\nProof. If {Fn } is a F\u00f8lner sequence in Z\u221e then for any d, Fn must be eventually d-dimensional.\n\n\u0003\n\nIt seems likely that there is a similar bound on how filling a d-dimensional set in Zd can be, and\nthis would imply that there are no filling F\u00f8lner sequences in Z\u221e , but we do not have a proof.\nOn the bright side, there do exist quasi-filling F\u00f8lner sequences in Z\u221e , as we now demonstrate.\n(i)\n(1)\n(d(n))\nSuppose In \u2286 Z are symmetric segments and Wn = In \u00d7 . . . \u00d7 In\n\u2286 Z\u221e is an increasing\n\u2212d(n)\nsequence of finite-dimensional boxes. We know that each set Wn is 2\n-filling in Zd(n) and it\nfollows that the same is true as subsets of Z\u221e . In order for {Wn } to be quasi filling, we must have\nX\n2d(n) * |Wn |\u2212\u03b1 < \u221e\nn\n\nfor every \u03b1 > 0. For this it is enough that {Wn } grow exponentially and d(n) = O(log |Wn |). We\nwould also like {Wn } to be a tempered F\u00f8lner sequence. Such a sequence can easily be constructed.\nFor example, we may take\n2\n2\nWn = [\u22122n ; 2n ][log n] .\n\n{Wn } is then an increasing quasi-filling F\u00f8lner sequence. For temperedness it suffices to check that\n\u22121\nWn | \u2264 C|Wn |. We have\n|Wn\u22121\n2\n\n2\n\n2\n\n2\n\n\u22121\nWn = [\u22122n \u2212 2(n\u22121) , 2n + 2(n\u22121) ][log n]\nWn\u22121\n\nso\n\u22121\n|Wn\u22121\nWn |\n\u2264\n|Wn |\n\n2\n\n2\n\n2 * (2n + *2(n\u22121) ) + 1\n2\n2 * 2n + 1\n\u0001[log n]\n\u2264 1 + 2\u22122n+2\n\u2192 1.\n\nOne also readily verifies that {Wn } satisfies\n\nlog |Wn+1 |\nlog |Wn |\n\n![log n]\n\n\u2264\n\n\u2192 1. We therefore have\n\nProposition 2.9. There exists a tempered F\u00f8lner sequence {Wn } in Z\u221e such that for any tempered\n(F,W )\n\u2217\n= T(F,W\nsequence {Fn } (and in particular Fn = Wn ) we have T\u2217\n) = h.\n\n\f16\n\nMichael Hochman\n\n2.4.\nLocally finite groups. G is locally finite if every finitely generated subgroup is finite.\nSince we only consider countable groups this is equivalent to saying that there are finite subgroups\nG1 < G2 < . . . whose union is all of G.\nIt is easy to see that such a sequence {Gn }\u221e\nn=1 is 1-incompressible (and hence 1-filling). Translates\nof Gi 's are just cosets, so if f \u2208\n/ Gi g then Gi f \u2229 Gi g = \u2205. Thus if {Gn(i) gi }Ii=1 is incremental, the\nGn(i) gi are pairwise disjoint, so every f \u2208 G belongs to at most one translate. Such a sequence\n{Gn } is also clearly a tempered F\u00f8lner sequence, since every g \u2208 G is eventually a member of Gn\nfor large enough n.\nIf in addition {Gi } grows slowly enough, then {Gi } is its own interpolation sequence. Thus\nProposition 2.10. If G1 < G2 < . . . and G = \u222aGi , then for Fk = Wk = Gk we have that T\u2217 \u2265 h\n|Gi+1 |\n\u2217\n\u2217\nand U \u2217 \u2264 h. If in addition log\nlog |Gi | \u2192 1 then T\u2217 = T = h and U\u2217 = U = h.\nIn the case where {Gi } grows too quickly to be its own interpolation sequence, we can still show\n\b\nthat for a suitably chosen subsequence Gi(k) there exists an interpolation sequence. This is based\non\nTheorem. (P. Hall and C. R. Kulatilaka, [4]) Every infinite locally finite group has an infinite\nabelian subgroup\nTo use the theorem we need\nProposition 2.11. An infinite locally finite abelian group A possesses an increasing sequence of\nfinite subsets (Yn )\u221e\nn=1 each of which is indivdually 4-incompressible and |Yn\u22121 | < |Yn | \u2264 2|Yn\u22121 |.\nProof. We can find finite subgroups 1 < . . . < An < . . . A such that An+1 /An is cyclic. Thus\nAn+1 = A\u2032n+1 \u2295 Cn+1 and An = A\u2032n+1 \u2295 kn Cn+1 for Cn+1 some cyclic group and kn \u2208 N. Let Zn,i\nbe a 2-incompressible sequence in Cn+1 ; then Yn,i = An \u222a (A\u2032n+1 \u00d7 Zn,i ) is 4-incompressible, and\nordering all the Yn,i by inclusion gives the desired sequence.\n\u0003\nNow if G is locally finite, and A < G an infinite abelian group, we can find a slowly-growing\nsequence (Yn ) of finite subsets of A each of which is 4-incompressible. Thus (Yn ) enjoys the same\nproperties as subsets of G, and we may apply lemma 2.4 to obtain\nProposition 2.12. For any locally finite group G = \u222a\u221e\nn=1 Gn there exists a sequence Gn(i) such that\nfor Fi = Gn(i) ,\n(F,F )\n\nU\u2217\n\n\u2217\n= U(F,F\n) = h.\n\nWe remark that in order to obtain an interpolation sequence in G one does not need the full force\nof the Hall-Kulatilaka theorem, but can rather use the fact that for every N there is a K such that\n\n\fReturn times, recurrence densities and entropy\n\n17\n\nevery finite group H with |H| > K has an abelian subgroup of size at least N , and therefore infinite\nlocally finite groups have arbitrarily large abelian subgroups. This can be proved by elementary\nmethods.\n2.5. Groups with polynomial growth. Let G be a finitely generated group and \u0393 \u2286 G a finite\nset of generators. For convenience we assume throughout that \u0393 is symmetric, ie that \u0393 = \u0393\u22121 . For\nevery element g \u2208 G define the length of g (with respect to \u0393) by\nl\u0393 (g) = min{k : g \u2208 \u0393k }\nso l\u0393 (g) is the least number of elements of \u0393 which need be multiplied together to give g.\nIt is easy to check that\nd\u0393 (g1 , g2 ) = l\u0393 (g1\u22121 g2 )\ndefines a left invariant metric on G (this is just the shortest distance metric on G's Cayley graph).\nThe ball of radius n in this metric centered at the unit element of G is\nBn\u0393 = {g \u2208 G : l\u0393 (g) \u2264 n}.\nThe growth function of G (with respect to \u0393) is defined by\n\u03b3\u0393 (n) = |Bn\u0393 | = #{g \u2208 G : l\u0393 (g) \u2264 n}.\nA finitely generated group G is said to have polynomial growth if its growth function \u03b3\u0393 is\nbounded by a polynomial, and subexponential growth if n1 log \u03b3\u0393 (n) \u2192 0. The property of having\npolynomial/subexponential growth is really a property of the group and does not depend on the\nparticular generating set \u0393. To see this, let \u03931 , \u03932 be two finite generating sets for G as above.\nThen there is an N for which \u03931 \u2286 (\u03932 )N , so (\u03931 )n \u2286 (\u03932 )N n . This means that\nl\u03931 (g) \u2264 N l\u03932 (g)\nand so\n\u03b3\u03931 (n) \u2264 \u03b3\u03932 (N n).\nFrom this, and the fact that the roles of \u03931 and \u03932 are interchangeable, it follows that \u03b3\u03931 is\nbounded from above by a polynomial p(x) of degree d iff \u03b3\u03932 is also (though not necessarily the\nsame polynomial), and similarly n1 log \u03b3\u03931 (n) \u2192 0 iff n1 log \u03b3\u03932 (n) \u2192 0.\nThough formally finite groups have polynomial growth, we will assume from here on that our\ngroups are infinite. We also assume that \u0393 is a fixed finite symmetric generating set for G and write\n\u03b3 for \u03b3\u0393 and Bn for Bn\u0393 .\nOne can show using elementary methods that groups with subexponential growth are amenable.\nIndeed,\n\n\f18\n\nMichael Hochman\n\nProposition 2.13. There is a subset I \u2286 N of density 1 such that {Bi }i\u2208I is a F\u00f8lner sequence.\nProof. For suppose that \u03b3 grows subexponentially. We will find a subsequence {Bnk }\u221e\nk=1 of balls\nwhich is a F\u00f8lner sequence.\nWrite \u03b1(n) = \u03b3(n+1)\n\u03b3(n) and for \u03b5 > 0 set I\u03b5 = {n \u2208 N : \u03b1(n) \u2265 1 + \u03b5}. Since \u03b3 grows subexponentially, for every \u03b5 > 0, I\u03b5 must have zero density; ie\n1\n|I\u03b5 \u2229 [0; n]| = 0.\nn+1\nChoose Nk growing very rapidly such that\nlim\n\nn\u2192\u221e\n\n1\n|I \u2229 [0; Nk ]| < 1/k.\nNk + 1 1/k\nAnd define I = \u222ak (I1/k \u2229 [Nk\u22121 ; Nk ]). Since if n is such that \u03b1(n) \u2265 1 \u2212\n|gBn \u2206Bn | \u2264 |Bn+1 \\ gBn | + |Bn+1 \\ Bn | \u2264\n\n1\nk\n\nthen gBn \u2286 Bn+1 and\n\n2\n|Bn |.\nk\n\nWe see that (Bn )n\u2208I is F\u00f8lner, and clearly I has density 1.\n\n\u0003\n\nWe will need the following stronger fact:\nTheorem. ([1] and [3]) If G = h\u0393i has polynomial growth then there is an integer d and constants\nc1 , c2 such that c1 nd \u2264 \u03b3\u0393 (n) \u2264 c2 nd .\nThis implies that\n\n2d c2\n|Bn |\nc1\nso the F\u00f8lner sequence from the proposition is in fact tempered.\nWe also conclude that every ball Bn is 4d c2 /c1 incompressible. For suppose that {Bn gi }N\ni=1 is\nincremental and 1G \u2208 \u2229i Bn gi . Then {Bn/2 gi } is a disjoint collection contained in B2n gi so\n|Bn\u22121 Bn | = |Bn2 | \u2264 c2 (2n)d \u2264\n\nN\n\nX\nn\nN * c1 ( )d \u2264 N * \u03b3n/2 =\n\u03b3n/2 \u2264 \u03b32n \u2264 c2 (2n)d\n2\ni=1\n\nand therefore N \u2264\nWe thus get\n\nc2 d\nc1 4 .\n\nProposition 2.14. If G has polynomial growth there is a F\u00f8lner sequence {Fn } such that\nh almost surely.\n\n1\n|Fn |\n\n(F,F )\n\nlog Tk\n\nUsing the construction from 2.2 and 2.4 we also get\n\u2217\nProposition 2.15. If G has polynomial growth there is a F\u00f8lner sequence {Fn } such that U(F,F\n) =\n(F,F )\n\nU\u2217\n\n= h almost surely.\n\n\u2192\n\n\fReturn times, recurrence densities and entropy\n\n19\n\nWe also note that by Gromov's theorem [3] every infinite group G with polynomial growth has\nan element of inifinite order, so the next section applies.\n2.6. Recurrence in subgroups. It is simple to verify that all the various filling-type properties\ndescribed so far are preserved in moving from subgroup to supergroup. This immediately gives\nProposition 2.16. If H < G and {Wn } is a filling or quasi-filling sequence in H then for any\n(F,W )\nlog |Wn+1 |\n\u2217\n\u2217\n= T(F,W\nF\u00f8lner sequence {Fn } in G, U(F,W\n) = h.\n) \u2264 h. If in addition log |Wn | \u2192 1 the T\u2217\nTo obtain the same result for U\u2217 , more care is needed, because one cannot automatically transfer\nan interpolation sequence from a subgroup to supergroup; this is due to the fact that condition\n(3) of the definition of interpolation sequences (definition 1.10) depends on the F\u00f8lner sequence\ninvolved, and not only on the window sequence, and the F\u00f8lner sequences in the supergroup are\nquite different from those in the subgroup. However, if {Yn } satisfies (1) and (2) of the definition\nlog |Yn |\nof interpolation sequences with respect some to {Wn } and in addition limn\u2192\u221e log\n|Yn\u22121 | = 1, then\n(3) of the definition of interpolation sequences is satisfied for any sequence {Fn }, and so {Yn } is an\ninterpolation sequence in G for {Fn }, {Wn } for any sequence {Fn } in G. This gives\nProposition 2.17. If H < G and {Wn } is an increasing incompressible sequence in H, and there\n|Wn+1 |\nexists a sequence {Yn } satisfying (1) and (2) of definition 1.10 and such that log\nlog |Wn | \u2192 1, then\n(F,W )\n\nfor any F\u00f8lner sequence {Fn } in G we have U (F,W )\u2217 = U\u2217\n\n= h.\n\nCorollary 2.18. If G contains an element of infinite order then there exist in G window sequences\n(F,W )\n(F,W )\n= T (F,W )\u2217 = h.\n= U (F,W )\u2217 = T\u2217\n{Wn } for which for any tempered F\u00f8lner sequence {Fn }, U\u2217\nProof. If hgi \u223c\n= Z take Wn = [\u2212n; n] \u2286 hgi; since {Wn } is incompressible in Z the same is true in\nG, and it is its own interpolation sequence.\n\u0003\nWe remark that in the case that {Wn } is contained in some proper subgroup H of G, although\nwe are looking at recurrence in H, the patterns we are looking at come from a F\u00f8lner sequence in G,\nwhich is not contained in H. We emphasize that these results do not follow from an application of\nour recurrence theorems to the H-process which arises from the restriction of the G-action to H; in\nfact the H-process derived from an ergodic G-process need not be ergodic, and even if it is it need\nnot have the same entropy as the original process. This observation means that we cannot weaken\nthe requirement that Fn be a F\u00f8lner sequence. If for example {Fn } were a F\u00f8lner sequence in some\nproper subgroup H of G, our results as applied to the H-process and the ergodic component to\nwhich x belongs would show that U\u2217 , U \u2217 etc. do converge, but their value depends on x and may\nbe different from the entropy of the original process.\n\n\f20\n\nMichael Hochman\n\n2.7. Return times and densities may misbehave for \"nice\" window sequences which\naren't filling. It is natural to wonder which of the theorems about return times and densities are\ntrue under weaker conditions than those stated, and in particular whether the requirement that\n{Wn } be filling may not be replaced with a weaker condition. One condition which has been used\nsuccessfully in the proof of other pointwise theorems is that of being a Templeman sequence, ie an\nincreasing F\u00f8lner sequence with |Wn\u22121 Wn | \u2264 C|Wn | (note that this is implies temperedness of the\nsequence {Wn }). In this section we show that even a stronger condition is not enough, and that\nthe almost-certain bound\n1\n(F,F )\nlim inf inf \u2212\nlog Uk,n (x) \u2264 h\nn\nk\n|Fk |\nmay fail even if {Fn } is a symmetric, increasing Templeman sequence of all orders, ie for all d there\nis a constant Cd such that |(Fn )d | \u2264 Cd |Fn | for all n.\nLet S 1 = {z \u2208 C : |z| = 1} be the unit circle in the complex plane and let T z = e2\u03c0i\u03b8 z be an\nirrational rotation, ie \u03b8 \u2208 R \\ Q. Let X : S 1 \u2192 {0, 1} be the map z 7\u2192 sgn Im z, and consider the\nprocess Xn = T n X defined on S 1 when S 1 is equipped with Lebesgue measure. It is well known that\nthis process is ergodic and has zero entropy. Our goal here is to construct a sequence of increasing,\nsymmetric finite sets Fn \u2286 Z such that {Fn } is Templeman of all orders and |Fn | = 2n, but for\n(F,F )\n(F,F )\nwhich there is a sequence of indices ki such that Tki (z) > 2|Fki | for every z \u2208 S 1 , so |F1k | log Tk\ndoes not converge even in probability to the entropy. This implies that the asymptotic upper bound\n(F,F )\nfor inf n \u2212 |F1k | log Uk,n fails as well.\nLet \u03b5n \u0581 0 be a decreasing sequence of positive numbers such that for every z \u2208 S 1 , if 0 < |k| < n\nthen |T k z \u2212 z| > \u03b5n . For any z0 \u2208 S 1 one can find such an \u03b5n , since T has no periodic orbits. Since\nT is an isometry of S 1 such a choice of \u03b5n is good for all z \u2208 S 1 if it is good for z0 .\nLet ln be an increasing sequence of positive integers such that any realization (X\u2212ln (z), . . . , Xln (z))\ndetermines z up to a distance of \u03b5n . More precisely, we require that if z, z \u2032 \u2208 S 1 satisfy Xk (z) =\nXk (z \u2032 ) for all \u2212n \u2264 k \u2264 n then |z \u2212 z \u2032 | < \u03b5n . Such ln exist because if we denote by P the partition\nof S 1 determined by X then \u2228l\u2212l T n P partitions S 1 into segments whose length tends to 0 as l \u2192 0.\nFinally, write\nn\no\nJn = k \u2208 Z : |z \u2212 T k z| > \u03b5n (for any or all z \u2208 S 1 ) .\nNote that Jn are symmetric (because T is an isometry) and that since \u03b5n are decreasing, Jn \u2286 Jn+1 .\nAlso note that if I = [a; b] \u2286 Z then\nk, m \u2208 I \\ Jn \u21d2 |z \u2212 T k\u2212m z| = |T k z \u2212 T m z| < 2\u03b5n\nand so if \u03b5n\u2032 > 2\u03b5n then n\u2032 < |k \u2212 m|. Thus if |I| < n\u2032 then |Jn \u2229 I| \u2265 |I| \u2212 1. It follows that the\nrelative density of Jn in any segment I of length n\u2032 \u2212 1 is at least 1 \u2212 n\u20321\u22121 .\n\n\fReturn times, recurrence densities and entropy\n\n21\n\nWe define the sets Fn inductively. At each stage we obtain Fn from Fn\u22121 by appending to Fn\u22121\nsome symmetric pair of numbers \u00b1m. Given Fn and a symmetric set E \u2286 Z, when we will say that\nwe \"add E to Fn \" we will mean that over several stages we add to Fi the smallest pair of numbers\n(in absolute value) in E \\ Fi until E is exhausted or some condition is met.\nWe start with F0 = \u2205 and add to it the segment [\u2212l1 ; l1 ] to obtain the sequence F1 , . . . , Fk1 . We\nnow add J1 until we obtain a set Fn1 such that |Fn1 | > 2|Fk1 | . Now we add [\u2212l2 ; l2 ] to Fn1 and\nobtain Fk2 ; then add J2 to Fk2 until we obtain a set Fn2 with |Fn2 | > 2|Fk2 | . We proceed in this\nmanner, alternately adding [l\u2212i ; li ] to obtain Fki and then Ji to obtain Fni with |Fni | > 2|Fki | .\nThe sequence {Fn } thus constructed is clearly increasing and symmetric, and satisfies |Fn | = 2n.\nNext, we claim that Tki (z) > 2|Fki | for every z \u2208 S 1 . To see that this is true for all i, note that\nz(Fki ) determines z up to \u03b5i because [\u2212li ; li ] \u2286 Fki , while for every m \u2208 Fni \\ Fki we have m \u2208 Ji ,\nso |z \u2212 T m z| > \u03b5i . Therefore T m z([\u2212li ; li ]) 6= z([\u2212li ; li ]) and this forces T m z(Fki ) 6= z(Fki ). Since\n|Fni | > 2|Fki | , this proves the claim.\nn|\nAs for {Fn } being Templeman, it suffices to show that limn\u2192\u221e max F|F\n= 1; this implies\nn \u2212min Fn\nd\nboth that {Fn } is a F\u00f8lner sequence, and that |Fn | \u2264 Cd |Fn | for some constant Cd , for all n. But\nthis follows from our remarks about the relative density of Jn in certain segments.\nWe remark that it seems to be more difficult to construct an example of such a sequence {Fn } for\nwhich the lower bound for Uk,n fails. Perhaps the lower bound U\u2217 \u2265 h holds more generally than\nthe upper bound, as happens in the case of Tk . we have so far been unable to determine whether\nthis is so.\n3. Upper bounds for return times and densities\nIn this section we prove the upper bounds T \u2217 \u2264 h and U \u2217 \u2264 h as described in the introduction.\n3.1. The upper bound for U \u2217 . We begin with some further remarks about the definition of\nUk,n . Recall that in section 1.4 we defined Uk,n to be size of the maximal collection of repetitions of\nx(Fk ) in x(Wn ) satisfying (a) the collection includes the trivial repetition x(Fk ) itself, and (b) the\nmembers of the collection are pairwise disjoint. If we drop these restriction we obtain the quantity\n(F,W )\n\nVk,n (x) = Vk,n\n\n(x) =\n\n1\n#{f \u2208 Wn : x(Fk ) repeats at f }\n|Wn |\n\nwhich is related to Uk,n by\n(3.1)\n\nUk,n \u2264 Vk,n \u2264 |Fk\u22121 Fk |Uk,n \u2264 |Fk |2 Uk,n .\n\nThe middle inequality is due to the fact that from any collection of right translates of Fk we can\nobtain a pairwise disjoint sub-collection at least |F \u221211 F | the size of the original collection which\nk\n\nk\n\nincludes any single prescribed member of the original collection (which in our case we take to be\n\n\f22\n\nMichael Hochman\n\nthe set Fk , representing the original pattern). From this relation we see that in order to prove that\nU \u2217 \u2264 h, it suffices to prove that V \u2217 = lim supn supk \u2212 |F1k | log Vk,n \u2264 h.\nThe key lemma which makes filling sequences special is the following, which states that if a set\nE has a low \"local\" density with respect to {Wn } then it has a low \"global\" density:\nLemma 3.1. Suppose {Wn } is a C-filling sequence and E \u2286 G finite. If for each f \u2208 E there is\nan index n(f ) such that |W 1 | |Wn(f ) f \u2229 E| \u2264 \u03b1 then\nn(f )\n\n\u03b1\n|E|\n\u2264 .\n| f \u2208E Wn(f ) f |\nC\nNote that we always have 0 < C \u2264 1.\n\nS\n\nProof. Order E by decreasing value of n(*): E = {f1 , . . . , fI } and write n(fi ) = n(i). We select\n\b\na subsequence fi(j) \u2286 {f1 , . . . , fI } inductively. Set i(1) = 1 and let i(j) be the first index such\nS\nS\nthat fi(j) \u2208\n/ k<j Wn(k) fk ; the process ends after J steps when E \u2286 Jj=1 Wn(i(j)) fi(j) (recall that\n\b\nJ\n1G \u2208 Wn for each n, since {Wn } is filling). Clearly Wn(i(j)) fi(j) j=1 is incremental. Now\n|E| \u2264\n\nJ\nX\n\n|Wn(i(j)) fi(j) \u2229 E| \u2264 \u03b1\n\nJ\nX\n\nJ\n\n|Wn(i(j)) | \u2264\n\nj=1\n\nj=1\n\n\u03b1 [\nWn(i(j)) fi(j) |\n|\nC\nj=1\n\n(the middle inequality is because by hypothesis |Wn(i) fi \u2229 E| \u2264 \u03b1|Wn(i) | for every i = 1, . . . , I and\nthe last because {Wn } is C-filling). Since\nJ\n[\n\nj=1\n\nthe lemma follows.\n\nWn(i(j)) fi(j) \u2286\n\nI\n[\n\nWn(i) fi\n\ni=1\n\n\u0003\n\nWe apply lemma 3.1 in the following situation: Consider an ergodic G-process defined on (\u03a9, F, P )\nwith entropy h. Suppose x \u2208 \u03a9, k < L << N are fixed, and \u03c6 : Fk \u2192 \u03a3 is some Fk pattern. Let E\nbe the set of repetitions of \u03c6 in x(FN ) with the additional property that near them \u03c6 repeats not\nfrequently enough with respect to Vk,n :\n)\n(\nf x \u2208 [\u03c6] and there exists n(f ) \u2264 L\nE = f \u2208 FN\n.\ns.t. Vk,n(f ) (f x) < 2\u2212(h+\u03b5)|Fk |\nSince for any f \u2208 E we have f x \u2208 [\u03c6] and |W 1 | |E \u2229 Wn(f ) f | < 2\u2212(h+\u03b5)|Fk | , from the lemma we see\nn(f )\nthat\n1 \u2212(h+\u03b5)|Fk |\n1\n|E| <\n*2\n.\n| \u222af \u2208E Wn(f ) f |\nC\n\n\fReturn times, recurrence densities and entropy\n\n23\n\nIf we assume that N is large enough so that |(\u222an\u2264L Wn )FN | \u2264 2|FN | (this happens eventually since\n{Fn } is a F\u00f8lner sequence), then since \u222af \u2208E Wn(f ) f \u2286 (\u222an\u2264L Wn )FN , we see that\n1\n2\n2 \u2212(h+\u03b5)|Fk |\n|E| \u2264\n|E| <\n*2\n.\n|FN |\n| \u222af \u2208E Wn(f ) f |\nC\nGiven some \u03a6 \u2286 \u03a3Fk and repeating this argument for every \u03c6 \u2208 \u03a6 we have\n)\n(\nf x \u2208 [\u03a6] and there exists n(f ) \u2264 L\n2 \u2212(h+\u03b5)|Fk |\n1\n<\n# f \u2208 FN\n*2\n* |\u03a6|.\n\u2212(h+\u03b5)|F\n|\nk\n|FN |\nC\ns.t. Vk,n(f ) (f x) < 2\nTheorem 3.2. If {Fn } is a tempered F\u00f8lner sequence and if {Wn } is filling, then\nU \u2217 (x) = lim sup sup \u2212\nk\u2192\u221e\n\nn\n\n1\n(F,W )\nlog Uk,n (x) \u2264 h\n|Fk |\n\nalmost surely.\nProof. It is enough to prove that\nV \u2217 = lim sup sup \u2212\nk\n\nn\n\n1\nlog |Vk,n | \u2264 h\n|Fk |\n\nalmost surely. Suppose to the contrary that for some \u03b5 > 0 and measurable non-null set B \u2286 \u03a9, for\nevery x \u2208 B\n1\n(F,W )\nlog Vk,n (x) > h + \u03b5.\nlim sup sup \u2212\n|Fk |\nn\nk\u2192\u221e\nLet P (B) > p > 0. Then from the SMB theorem, there is a measurable subset B0 \u2286 B, P (B0 ) > p,\na sequence {\u03a6k } of sets \u03a6k \u2286 \u03a3Fk and integer L1 such that for k > L1 it holds that |\u03a6k | \u2264\n2(h+\u03b5/2)|Fk | , and x(Fk ) \u2208 \u03a6k for any x \u2208 B0 . It may further be assumed that for some L2 >> L1 ,\nfor any x \u2208 B0 there are indices k(x), n(x) with L1 \u2264 k(x) \u2264 L2 and n(x) \u2264 L2 such that\nVk(x),n(x) (x) < 2\u2212(h+\u03b5)|Fk(x) | .\nChoose N very large with respect to L2 so that FN is very WL2 -invariant, and large enough so\nthat there is an x \u2208 \u03a9 such that\n1\n#{f \u2208 FN : f x \u2208 B0 } > p\n|FN |\n(by the ergodic theorem such x's are bound to exist for N large enough).\nFix x \u2208 \u03a9 for which the above holds. For f \u2208 FN such that f x \u2208 B0 , write k(f ) = k(f x),\nn(f ) = n(f x). Define\nE = {f \u2208 FN : f x \u2208 B0 },\nEk = {f \u2208 FN : f x \u2208 B0 and k(f ) = k}.\n\n\f24\n\nMichael Hochman\n\n2\nClearly E \u2286 (\u222aL\nk=L1 Ek ), so by our choice of x we should have\n\n1\n| \u222a Ek | \u2265 p.\n|FN |\nOn the other hand, according to the discussion after lemma 3.1,\n1\n2\n2\n|Ek | \u2264 2\u2212(h+\u03b5)|Fk | |\u03a6k | \u2264 (2\u2212\u03b5/2 )|Fk |\n|FN |\nC\nC\nso that\n1\n1\n| \u222a Ek | =\n|FN |\n|FN |\n\n(3.2)\n\nX\n\n|Ek | \u2264 C \u2032 * (2\u2212\u03b5/2 )FL1\n\nL1 <k<L2\n\nfor some constant C \u2032 depending only on \u03b5, so if L1 was chosen large enough with respect to \u03b5 (recall\nour assumption that that |Fn | \u2265 n), this is less than p, a contradiction.\n\u0003\nEsssencially the same proof gives us\nTheorem 3.3. Let {Fn } be a tempered F\u00f8lner sequence in G. If {Wn } is a sequence such that Wn\nP\n2\u2212\u03b1|Fk |\nis Cn -filling and {n(k)} is a sequence of integers such that \u221e\nk=1 Cn(k) < \u221e for every \u03b1 > 0, then\nfor almost every x,\n1\n(F,W )\nlog Uk,n(k) (x) \u2264 h.\nlim sup \u2212\n|Fk |\nk\u2192\u221e\nThe proof uses the fact that lemma 3.1 has an analogue when {Wn } is replaced with a single\nf \u2229E|\n< \u03b1 for every f \u2208 E then\nC-filling set W , namely that if for a finite subset E \u2286 G we have |W|W\n|\n|E|\n|W E|\n\n\u2264\n\n\u03b1\nC\n\n(to see this, apply the lemma with Wn = W ). Using this the proof now follows exactly\nP 2\u2212\u03b1|Fk |\nthe lines of the proof of theorem 3.2; the relation\nCn(k) < \u221e is used to show that the middle\nterm of equation (3.2) is small when L1 is large enough.\n(F,W )\n\n3.2. The upper bound for T \u2217 . In order for Tk\nto be meaningful the window sequence {Wn }\nmust grow slowly enough to detect a too-soon return. What slowly means here is that for every h\nthere exist window sets of size approximately 2h|Fk | for large enough k. One condition which ensures\n|Wn+1 |\nthis without reference to the sequence {Fn } is that log\nlog |Wn | \u2192 1. With this condition in place, one\ncan deduce the bound for T \u2217 from the bound for U \u2217 :\nLemma 3.4. Suppose {Wn } is an increasing sequence such that\nU \u2217 (x) \u2264 h then T \u2217 (x) \u2264 h.\n\nlog |Wn+1 |\nlog |Wn |\n\n\u2192 1. For x \u2208 \u03a9, if\n\nProof. If Tk (x) = |WRk (x) | > 2(h+\u03b5)|Fk | for infinitely many k, then the growth condition implies that\n|WRk (x)\u22121 | \u2265 2(h+\u03b5/2)|Fk | for infinitely many k. But for such a k the only occurence of x(Fk ) in\n\n\fReturn times, recurrence densities and entropy\n\n25\n\nWRk (x)\u22121 is the original pattern, so |Uk,Rk (x)\u22121 (x)| \u2264 2\u2212(h+\u03b5/2)|Fk | for infinitely many k, which is\nimpossible because U \u2217 (x) \u2264 h.\n\u0003\nTheorem 3.5. Let {Wn } be a quasi-filling sequence satisfying\n\u2217\nF\u00f8lner sequence {Fn }, T(F,W\n) \u2264 h almost surely.\nProof. Let \u03b5 > 0. Define\n\nlog |Wn+1 |\nlog |Wn |\n\n\u2192 1. Then for any tempered\n\nn\no\nn(k) = min n : |Wn | > 2(h+\u03b5)|Fk | .\n\nFor \u03b1 > 0 we have, since {Wn } is quasi-filling, that\nX 2\u2212\u03b1|Fk |\nCn(k)\n\nX 1\nX |Wn(k) |\u2212\u03b1/(h+\u03b5)\n(h+\u03b5)|Fk | \u2212\u03b1/(h+\u03b5)\n\u2264\n(\n2\n)\n\u2264\n<\u221e\nCn(k)\nCn(k)\n\nand this now gives, via theorem 3.3, that\n\nlim sup\nk\n\n1\n(F,W )\nlog Uk,n(k) (x) \u2264 h\n|Fk |\n\nalmost surely. This in turn implies that T \u2217 \u2264 h almost surely, by reasoning like that of the lemma\n3.4 above.\n\u0003\n4. Lower bounds on return times and densities\nIn this section we prove the bounds T\u2217 \u2265 h and U\u2217 \u2265 h. The bound T\u2217 \u2265 h is proved by\nconstructing a code for the process which beats entropy if T\u2217 6\u2265 h. This is close in spirit to the\nproof of T\u2217 \u2265 h originally given by Ornstein and Weiss for the cases G = Z and G = Zd , but some\nnew combinatorial machinery is needed to make the construction possible for general groups and\ngeneral window sets. We first give a brief description of the coding ideas we will need, and then\nexplain the combinatorics and detailed construction of the code. We conclude with the proof of the\nbound U\u2217 \u2265 h, which relies both on the filling ideas used in the last section and on the lower bound\nT\u2217 \u2265 h.\n4.1. Coding and entropy. For completeness we take a detour and discuss the connection between\nentropy and efficient coding of a process.\nA useful characterization of the entropy of a process is as the lower bound of all achievable coding\nrates for the process. An Fn -code is a map c : \u03a3Fn \u2192 {0, 1}\u2217 = \u222an\u22650 {0, 1}n . Thus c encodes each\npattern \u03c6 : Fn \u2192 \u03a3 in a binary string (=sequence) c(\u03c6), which is called the codeword associated\nwith \u03c6. If c is an injection the coding is said to be invertible or faithful. For x \u2208 \u03a9 and an Fn -code\nc, we write c(x) instead of c(x(Fn )). If cn is an Fn -code, we say that {cn } is an {Fn }-code. {cn } is\ninvertsble if every cn is.\n\n\f26\n\nMichael Hochman\n\nThe number of bits (=symbols) in the codeword c(\u03c6) of \u03c6 is called the length of the codeword\nc(\u03c6) and is denoted by l(c(\u03c6)). Note that the codeword length of different patterns may vary. For\nan Fn -code c and process {Xg }, the average number of bits per symbol used by the code is the\nR\nquantity \u03c1(c) = |F1n | l(c(x))dP (x); this is the average number of bits used in the c-encoding of a\nrandom pattern x(Fn ), normalized by the number of symbols in the Fn -pattern x(Fn ).\nFor r \u2265 0, we say that r is an achievable coding rate for the process {Xg } if there exists an\ninvertable {Fn }-code {cn } such that lim sup \u03c1(cn ) \u2264 r. This means we can represent arbitrarily\nlarge patterns from the process using approximately r bits for every symbol of the pattern. The\ncoding rate of the process {Xg } is the infimum of achievable coding rates:\nR = inf {r \u2265 0 : r is an achievable coding rate for the process {Xg }} .\nIt is not hard to see that the coding rate of a process is the same as the process entropy h\n(incidentally, this shows that R does not depend on the sequence {Fn }). To see that R \u2265 h, let {cn }\nbe a sequence of invertable codes such that lim supn\u2192\u221e \u03c1(cn ) < r. Then there is some \u03b5 > 0 such\nthat for infinitely many n there is a measurable set An \u2286 \u03a9 with P (An ) \u2265 \u03b5, and |F1n| l(cn (x)) < r\nfor every x \u2208 An . Since cn is an injection, and for every x \u2208 An we have l(cn (x)) \u2264 r|Fn |, we have\n[\n{cn (x) : x \u2208 An } \u2286\n{0, 1}k\nk<r|Fn |\n\nP\n\nso every x \u2208 An belongs to at most one k\u2264r|Fn| 2k \u2264 2 * 2r|Fn | Fn -atoms. The Shannon-McMillan\ntheorem now implies that h \u2264 r.\nTo see that h \u2265 R we formulate the following simple lemma, which enables us to turn a nonfaithful code sequence into a faithful code sequence.\nLemma 4.1. Suppose that {cn } is a sequence of Fn -codes and \u03a6n \u2286 \u03a3Fn is such that cn |\u03a6n is an\ninjection and |F1n | l(cn (\u03c6)) \u2264 r for every \u03c6 \u2208 \u03a6n . Assume also that P ([\u03a6n ]) \u2192 1. Then R \u2264 r.\nProof. Let en be an enumeration coding of \u03a3Fn , ie it assigns to \u03c6 \u2208 \u03a3Fn a binary string representing\nthe index of \u03c6 in some fixed enumeration of \u03a3Fn . The code en is faithful. Now define a code {\u0109n }\nby\n(\n0cn (\u03c6) \u03c6 \u2208 \u03a6n\n\u0109n (\u03c6) =\n1en (\u03c6) \u03c6 \u2208\n/ \u03a6n\n{\u0109n } is clearly an invertible code. Moreover,\n(\n1\n1\n1\n|Fn | + |Fn | l(cn (\u03c6)) \u03c6 \u2208 \u03a6n\nl(\u0109n (\u03c6)) =\n1\n|Fn |\n\u03c6\u2208\n/ \u03a6n\n|Fn | + \u2308log |\u03a3|\u2309\n\n\fReturn times, recurrence densities and entropy\n\nso,\n\n27\n\nZ\n1\nl(\u0109n (x))dP\n\u03c1(b\ncn ) =\n|Fn |\n1\n\u2264\n+ r * P ([\u03a6n ]) + \u2308log |\u03a3|\u2309 P (\u03a9 \\ [\u03a6n ])\n|Fn |\n\u2192 r\n\nas desired.\n\n\u0003\n\nIf we choose \u03a6n \u2286 \u03a3Fn in such a way that |F1n | log |\u03a6n | \u2192 h and P ([\u03a6n ]) \u2192 1, choose cn to be\nan enumeration coding of \u03a6n and define it arbitrarily of \u03a3Fn \\ \u03a6n , then the lemma implies that\n\u03c1(b\ncn ) \u2264 h + \u03b5 for every \u03b5 > 0, so R \u2264 h.\nWe conclude this section with a combinatorial lemma which will be used later. Its importance\nis that it enables us to describe small random subsets of Fn at a low rate by using an enumeration\ncode.\nLemma 4.2. Let 0 < \u03bb < 1/2 and F a finite set. The number of subsets of F whose size is at most\n\u03bb|F | is bounded by 2\u03b4(\u03bb)|F | , where lim\u03bb\u21920 \u03b4(\u03bb) = 0.\nProof. The number of such subsets is\nX \u0012|Fn |\u0013\nm<\u03bb|Fn |\n\nm\n\n\u2264 2(\u2212\u03bb log \u03bb\u2212(1\u2212\u03bb) log(1\u2212\u03bb))|F | .\n\nThe bound follows from Stirling's formula; or see [9, p. 52] for an elementary proof.\n\n\u0003\n\n4.2. The lower bound for T\u2217 (Part I). In this section we begin the proof of\nTheorem 4.3. If {Fn } is a tempered sequence and {Wn } is an increasing sequence of finite subsets\nof G, then\n1\n(F,W )\n(F,W )\n= lim inf\nT\u2217\nlog Tk\n\u2265h\nk\u2192\u221e |Fk |\nalmost surely.\nWe will need some notation.\nDefinition 4.4. Let {Fn } be a fixed sequence. A cover \u03bd is a collection of sets of the form Fn f for\nsome n \u2208 N and f \u2208 G. The set E \u2286 G of f 's such that some Fn f is represented in \u03bd is called the\nset of centers of \u03bd and is denoted by dom \u03bd. We also say then that \u03bd is a cover over E.\nIt would be more precise to say that a cover \u03bd over E is a collection of pairs (n, f ) \u2208 N \u00d7 E,\nbecause we wish to allow more than one set Fn f over each f \u2208 E, and also since the set Fn f does\n\n\f28\n\nMichael Hochman\n\nnot, in general, determine n and f uniquely. However, it is more convenient to think of \u03bd as a\n(multi)set with elements of the form Fn f , and this is what we will do.\nWe write \u222a\u03bd for the union of members of \u03bd. When we wish to specify the elements of \u03bd by name,\nP\nwe will write \u222a\u03bd Fn f , \u03bd |Fn f |, etc. This is imprecise because the index n depends on f but we\nomit this when convenient.\nFix {Fn } and {Wn }. Let x \u2208 \u03a9, f \u2208 G and n \u2208 N, and suppose Rn (f x) < \u221e. There then exists\nan element f \u2032 \u2208 G at which f x(Fn ) repeats, and is closest to f with respect to {Wn }. To be precise,\nthere is an f \u2032 such that\n(1) f \u2032 x \u2208 [f x(Fn )] (ie the Fn -pattern at f in x repeats in f \u2032 ).\n(2) f \u2032 f \u22121 \u2208 WRn (f x) (ie the offset from f to f \u2032 is in WRn (f (x)) ).\nIn general there may be more than one f \u2032 with these properties. For fixed x and n, we assume some\nchoice has been made, and denote this element by f x,n .\nFor a set Fn f such that Rn (f x) < \u221e, we write (Fn f )x = Fn f n,x . The (partial) map Fn f 7\u2192\n(Fn f )x is called the displacement arising from x. Strictly speaking, the map Fn f 7\u2192 (Fn f )x is\nnot well defined since the set Fn f does not uniquely determine n and f . However, n and f will\nalways be clear from the context so no confusion should arise. Finally, for a cover \u03bd such that\nRn (f x) < \u221e for every Fn f \u2208 \u03bd we write \u03bd x = {(Fn f )x : Fn f \u2208 \u03bd}. Thus \u03bd x is a cover over the set\n{f x,n : Fn f \u2208 \u03bd}. One should think of the displacement \u03bd x of \u03bd as the cover obtained from \u03bd by\nmoving each set Fn f \u2208 \u03bd to one of the nearest repetitions of the pattern induced on it by x.\nWe will only be working with covers \u03bd and x \u2208 \u03a9 such that Rn (f x) < \u221e for every Fn f \u2208 \u03bd, and\navoid further mention of this fact.\nWe can now state the idea behind the proof of theorem 4.3. Suppose by way of contradiction\nthat P (T\u2217 < h \u2212 \u03b5) > p > 0. We will try to construct an FN -code cN which beats entropy. By the\nergodic theorem, for almost every x and large N at least a p-fraction of the f \u2208 FN are such that\nTn (f x) \u2264 2(h\u2212\u03b5)|Fn | for some n = n(f ) \u2208 N. In order to describe the pattern x(Fn f ) it is enough\nto describe the pattern x(Fn f x,n) and the element f x,nf \u22121 . Since the latter is in WRn (f x) and this\nset is of size at most 2(h\u2212\u03b5)|Fn | , we can describe it in approximately (h \u2212 \u03b5)|Fn | bits. Thus if the\npattern x(Fn f x,n) were known, the pattern x(Fn f ) could be coded in h \u2212 \u03b5 bits per symbol.\nLet E \u2286 FN be the set of f \u2208 FN for which there exists such an n(f ) with Rn(f ) (f x) \u2264 h \u2212 \u03b5.\n\b\nLet \u03bd = Fn(f ) f f \u2208E . If it should happen that (a) the collection \u03bd is pairwise disjoint, (b) \u222a\u03bd is\ndisjoint from \u222a\u03bd x , (c) we can code x(FN \\ \u222a\u03bd) at, say h + p\u03b5/2 bits per symbol, and (d) \u222a\u03bd is at\nleast a p-fraction of FN , then the discussion above shows that we can code x(\u222a\u03bd) at around h \u2212 \u03b5\nbits per symbol. Given that the above hold, we can then code x(FN ) at a rate of h \u2212 p\u03b5/2 bits per\nsymbol.\n\n\fReturn times, recurrence densities and entropy\n\n29\n\nConditions (c) and (d) are not to difficult: (d) would follow from (a) and the fact that E is a\np-fraction of FN , and (c) can be achieved because FN \\ \u222a\u03bd can be mostly covered by entropy-typical\nsets when N is large, and a standard argument then gives that x(FN \\ \u222a\u03bd) can be coded at a little\nmore than h bits per symbol. The difficulty in realizing this outline is that in (a) and (b) cannot in\ngeneral be achieved.\nThe proof of the return times theorem for Z and Zd given in [8] avoids this problem by allowing\nthe elements of \u03bd and \u03bd x to intersect arbitrarily, and employs a more elaborate coding scheme which\nuses the order structure of Zd in an essential way. This method doesn't generalize to other groups.\nFor our proof we will drop the disjointness requirements (a) and (b) and instead require only\n\"almost disjointness\". To be precise,\nDefinition 4.5. Let \u03b5 > 0. A sequence {Hi }i\u2208I of finite subsets of G are said to be \u03b5-disjoint if\nthere exist subsets Hi\u2032 \u2286 Hi such that {Hi\u2032 }i\u2208I are pairwise disjoint and |Hi\u2032 | \u2265 (1 \u2212 \u03b5)|Hi |. We say\nthat a cover \u03bd is \u03b5-disjoint if the collection {Fn f \u2208 \u03bd} is \u03b5-disjoint.\nIf {Hi }Ii=1 has the property that for each i \u2264 I, |Hi \u2229 (\u222aj<i Hj )| \u2264 \u03b5|Hi | then the collection is\n\u03b5-disjoint; simply set Hi\u2032 = Hi \\ \u222aj<i Hj .\nAn important property of \u03b5-disjoint collections is that the size of their union is almost the sum\nof their sizes. To be precise, let {Hi }i\u2208I be \u03b5-disjoint and Hi\u2032 \u2286 Hi as in the definition. Then we\nhave\n[\n[\nX\nX\n|\nHi | \u2265 |\nHi\u2032 | =\n|Hi\u2032 | \u2265 (1 \u2212 \u03b5)\n|Hi |.\ni\u2208I\n\ni\u2208I\n\ni\u2208I\n\ni\u2208I\n\nClearly for two \u03b5-disjoint collections {Di } and {Ej }, if Di \u2229 Ej = \u2205 for every i, j then {Di } \u222a {Ej }\nis an \u03b5-disjoint collection; and so for any funion of pairwise disjoint \u03b5-disjoint collections.\n\b\nDefinition 4.6. For x \u2208 \u03a9 and a cover \u03bd = Fn(i) fi\npair (\u03bd, \u03bd x ) are \u03b5-disjoint if for every 1 \u2264 i \u2264 I,\nFn(i) fi \u2229\n\n[\n\nj<i\n\nI\ni=1\n\nFn(j) fj \u222a Fn(j) fj\n\nover E = {f1 , . . . , fI }, we say that the\n\n\u0001x \u0001\n\n\u2264 \u03b5|Fn(i) fi |.\n\nAccording to the discussion before the definition, if (\u03bd, \u03bd x ) is \u03b5-disjoint then \u03bd is \u03b5-disjoint. Note\nthat in order for the statement that (\u03bd, \u03bd x ) is \u03b5-disjoint to be meaningful, the set of centers of \u03bd\nmust be linearly ordered.\nThe point of this definitions is the following:\n\b\nI\nLemma 4.7. Let 0 < \u03b5 < 12 , x \u2208 \u03a9 and suppose \u03bd = Fn(i) fi i=1 is a cover over E = {f1 , . . . , fI }\nsuch that (\u03bd, \u03bd x ) is \u03b5-disjoint. Then there exists a set A \u2286 \u222a\u03bd satisfying |A| < 2\u03b5| \u222a \u03bd| and such\n\n\f30\n\nMichael Hochman\n\nthat, given the patterns x(\u222a\u03bd x \\ \u222a\u03bd) and x(A), and given the map fi 7\u2192 f x,n(i) , we can reconstruct\nthe pattern x(\u222a\u03bd).\nProof. Set\nHi = Fn(i) fi \\\n\n[\n\n(Fn(j) fj )x .\n\nj<i\n\nSince\n\n(\u03bd, \u03bd x )\n\nis \u03b5-disjoint, |Hi | \u2265 (1 \u2212 \u03b5)|Fn(i) |, and for j > i we have (Fn(i) fi )x \u2229 Hj = \u2205. Define\nA = (\u222a\u03bd) \\\n\nI\n[\n\nHi .\n\ni=1\n\nUsing the fact that \u03bd is \u03b5-disjoint (since (\u03bd, \u03bd x ) is) ,\nX\n\u03b5\n|A| < \u03b5\n|Fn(i) fi | \u2264\n| \u222a \u03bd| \u2264 2\u03b5| \u222a \u03bd|.\n1\u2212\u03b5\n\nIt remains to show that given x(A), x(\u222a\u03bd x \\ \u222a\u03bd) and the map f 7\u2192 f x,n(f ) we can deduce x(\u222a\u03bd).\nWe claim that for any i if we know x(\u222aj<i Fn(j) fj ) then we can deduce x(Fn(i) fi ); this will\nx,n(i)\n\nx,n(i)\n\ncomplete the proof. Since fi\nx(Fn(i) ) = fi x(Fn(i) ), and we know fi and fi\n, it suffices to show\nx\nthat we can deduce x((Fn(i) fi ) ). Now since by assumption we already know x(\u222aj<i Fn(j) fj ), and\nS\nsince Fn(i) fi \u2229 (Fn(i) fi )x = \u2205, all we need do is find x((Fn(i) fi )x \u2229 j>i Fn(j) fj ). But this is known,\nS\nsince (Fn(i) fi )x \u2229 j>i Fn(j) fj \u2286 A, and we know x(A).\n\u0003\n\nIn order to use the lemma 4.7 to produce good codes we need to know how to produce large\ncovers \u03bd such that (\u03bd, \u03bd x ) is \u03b5-disjoint. We address this next.\n4.3. Disjointification lemmas. Our methods in this section follow those in [11].\nWe first need some more notation. If \u03bd, \u03bc are covers, their join is\n\u03bd \u2228 \u03bc = {Fn f : Fn f \u2208 \u03bd or Fn f \u2208 \u03bc}\n\n(we use this notation instead of the more natural \u03bd \u222a \u03bc to avoid confusion with the set \u222a\u03bd defined\nW\nabove in 4.4). The join of several covers \u03bd1 , . . . , \u03bdk is denoted by ki=1 \u03bdi .\nThe restriction of a cover \u03bd over E to a subset of E \u2032 \u2286 E is denoted by \u03bd|E \u2032 = {Fn f \u2208 \u03bd : f \u2208 E \u2032 }.\nWe say that \u03bc is a subcover of \u03bd if \u03bc \u2286 \u03bd, ie if Fn f \u2208 \u03bd whenever Fn f \u2208 \u03bc. Thus if \u03bd is a cover over\nE and E \u2032 \u2286 E we have \u03bd|E \u2032 \u2286 \u03bd.\nWe also write min \u03bd = min {n : Fn f \u2208 \u03bd}, and similarly max \u03bd.\nDefinition 4.8. Let {Fn } be a F\u00f8lner sequence. The blowup of Fn is Fn+ = (\u222ak<n Fk\u22121 )Fn . For a\ncover \u03bd, write \u222a+ \u03bd = \u222a\u03bd Fn+ f .\nThe point of this is that if Fk f and Fn g are two translates with k < n, then f \u2208\n/ Fn+ g iff\nFk f \u2229Fn g = \u2205. Thus if Fk f is a set and \u03bd some cover, and k < min \u03bd, then f \u2208\n/ \u222a+ \u03bd iff Fk f \u2229(\u222a\u03bd) = \u2205.\n\n\fReturn times, recurrence densities and entropy\n\n31\n\nFor a F\u00f8lner sequence {Fn }, the condition |Fn+ | \u2264 C|Fn | is equivalent to saying that {Fn } is\ntempered with constant C.\nThe following properties will be useful. They state that if {Fn } is tempered then the size of \u222a+ \u03bd,\n\u222a(\u03bd \u2228 \u03bd x ) and \u222a+ (\u03bd \u2228 \u03bd x ) are at most a constant times the size of \u222a\u03bd, assuming some disjointness\ncriteria from \u03bd or (\u03bd, \u03bd x ).\nLemma 4.9. Suppose {Fn } is tempered with constant C. If \u03bd is an \u03b5-disjoint cover then | \u222a+ \u03bd| \u2264\nC\n1\u2212\u03b5 | \u222a \u03bd|.\nProof. We have\n| \u222a+ \u03bd| = |\n\n[\n\nFn+ f | \u2264\n\n\u03bd\n\nX\n\n|Fn+ f | \u2264 C\n\n\u03bd\n\nX\n\n|Fn f | \u2264\n\n\u03bd\n\nC\n| \u222a \u03bd|\n1\u2212\u03b5\n\n(the last inequality follows from the fact that \u03bd is \u03b5-disjoint).\nLemma 4.10. If (\u03bd, \u03bd x ) is \u03b5-disjoint then | \u222a (\u03bd \u2228 \u03bd x )| \u2264\n2C\nwith constant C then | \u222a+ (\u03bd \u2228 \u03bd x )| \u2264 1\u2212\u03b5\n| \u222a \u03bd|.\n\n2\n1\u2212\u03b5 | \u222a \u03bd|.\n\n\u0003\nIf in addition {Fn } is tempered\n\nProof. If (\u03bd, \u03bd x ) is \u03b5-disjoint then it is clear from the definitions that \u03bd is \u03b5-disjoint. We therefore\nhave\nX\nX\n2\n| \u222a (\u03bd \u2228 \u03bd x )| \u2264\n(|Fn f | + |(Fn f )x |) = 2\n|Fn f | \u2264\n| \u222a \u03bd|.\n1\u2212\u03b5\n\u03bd\n\u03bd\n\nIf {Fn } is tempered with constant C,\n\n| \u222a+ (\u03bd \u2228 \u03bd x )| \u2264 2\n\nX\n\u03bd\n\n|Fn+ f | \u2264 2C\n\nX\n\u03bd\n\n|Fn f | \u2264\n\n2C\n| \u222a \u03bd|.\n1\u2212\u03b5\n\n\u0003\n\nA cover \u03bd over E is constant if for some n0 every member of \u03bd is of the form Fn0 f . We then say\nW\nthat \u03bd is an n0 -cover. For any cover \u03bd, we can write \u03bd as \u03bd = Ii=1 \u03bdi where each \u03bdi is a constant\ni-cover. We say that \u03bdi is the i-th level of \u03bd, and that {\u03bdi } is the decomposition of \u03bd into levels.\nFinally, we say that a cover \u03bd over E is simple if for each f \u2208 E there is exactly one n such that\nFn f \u2208 \u03bd. Any cover \u03bd over E has a simple subcover over E.\nThe first step in proving that large covers \u03bd exist such that (\u03bd, \u03bd x ) is \u03b5-disjoint is the following\nlemma.\nLemma 4.11. Let 0 < \u03b5 < 21 and x \u2208 \u03a9. Let \u03bd be a cover over a set E. Then there exists a simple\n\u03b5\n|E|.\nsubcover \u03bc \u2286 \u03bd over a set E \u2032 = {f1 , . . . , fI } \u2286 E such that (\u03bc, \u03bcx ) is \u03b5-disjoint and | \u222a \u03bc| \u2265 8+2C\nProof. With regards the requirement that \u03bc be simple, we merely note that we can replace \u03bd with\na simple subcover of \u03bd and proceed from there.\nWe first prove the lemma under the assumption that \u03bd is constant and then proceed to the general\ncase.\n\n\f32\n\nMichael Hochman\n\nSuppose \u03bd is a constant n-cover over E. We will show that there exists E \u2032 \u2286 E such that for\n\u03bc = \u03bd|E \u2032 we have (\u03bc, \u03bcx ) is \u03b5-disjoint and | \u222a \u03bc| \u2265 8\u03b5 |E|. Let E \u2032 = {f1 , . . . , fI } \u2286 E be a maximal set\nsuch that for \u03bc = \u03bd|E \u2032 , (\u03bc, \u03bcx ) is \u03b5-disjoint. Set D = \u222a(\u03bc \u2228 \u03bcx ). If |D \u2229 E| > 21 |E| then by lemma\n4.10,\n1\u2212\u03b5\n1\n1\n1\n| \u222a \u03bc| \u2265\n|D| \u2265 |D| \u2265 |D \u2229 E| > |E|\n2\n4\n4\n8\nso we are done. Otherwise |D \u2229 E| \u2264 21 |E|. Then by minimality, for each f \u2208 E \\ D it must hold\nthat |Fn f \u2229 D| \u2265 \u03b5|Fn |. Since each g \u2208 D can lie in at most |Fn | right translates of Fn , we have\n|D| \u2265 |F1n | * \u03b5|D \\ E| * |Fn | \u2265 2\u03b5 |E|, so\n1\u2212\u03b5\n(1 \u2212 \u03b5)\u03b5\n\u03b5\n|D| \u2265\n|E| \u2265 |E|.\n2\n4\n8\nW\nReturning to the case where the \u03bd is not constant, let \u03bd = Ii=1 \u03bdi be the levels of \u03bd. Since \u03bd is\nsimple, the set of centers of \u03bdi and \u03bdj are disjoint fro i 6= j. We define inductively for i = I down to\ni = 1 subcovers \u03bci of \u03bdi over sets Ei\u2032 = {fi1 , . . . , fiM (i) } such that (\u03bci , \u03bcxi ) is \u03b5-disjoint, as follows:\nAssume we have defined \u03bcj for j > i and define\n\b\n\u0001\n\u03bdi\u2032 = Fi f \u2208 \u03bdi : Fi f \u2229 \u222a(\u03bcj \u2228 \u03bcxj ) = \u2205 for every j > i .\n| \u222a \u03bc| \u2265\n\nThis is equivalent to saying that \u03bdi\u2032 = \u03bdi |Ei , where\n[\n\u0001\nEi = dom \u03bdi \\\n\u222a+ (\u03bcj \u2228 \u03bcxj ) .\nj>i\n\nNow apply the one-level case proved above to \u03bdi\u2032 to obtain a subcover \u03bci which is the restriction of\n\u03bdi to Ei\u2032 = {fi1 , . . . , fiM (i) } \u2286 Ei .\nFinally, set E \u2032 = \u222aEi\u2032 , and order E \u2032 as in\nE \u2032 = {fi }M\ni=1 = {fI1 , . . . , fIM (I) , . . . , f11 , . . . , f1M (1) }\n(note that the Ei\u2032 are pairwise disjoint), and define \u03bc = \u222a\u03bci = \u03bd|E \u2032 .\nIt is easy to verify from the construction that (\u03bc, \u03bcx ) is \u03b5-disjoint. We must verify that \u222a\u03bc is\nlarge enough. Write D = \u222a+ (\u03bc \u2228 \u03bcx ) and note that Ei \u2287 dom \u03bdi \\ D so\n\u222ai Ei \u2287 (\u222ai dom \u03bdi ) \\ D = E \\ D.\nHence\n| \u222a \u03bc| =\n\nI\nX\ni=1\n\n| \u222a \u03bci |\n\n\fReturn times, recurrence densities and entropy\n\n33\n\nwhich by the definition of \u03bci and the one-level case proved at the beginning implies\nI\n\n| \u222a \u03bc| \u2265\n\n\u03b5X\n|Ei |\n8\ni=1\nI\n\n\u2265\n\u2265\n\u2265\n\n\u03b5 [\nEi |\n|\n8\ni=1\n\u03b5\n(|E| \u2212 |D|)\n8\n\u03b5\n2C\n(|E| \u2212\n| \u222a \u03bc|)\n8\n1\u2212\u03b5\n\nthe last inequality since by lemma 4.10 we have |D| \u2264\n\n2C\n1\u2212\u03b5 | \u222a\n\n\u03bc|. After rearranging this is\n\n8\n2C \u22121\n\u03b5\n| \u222a \u03bc| \u2265 ( +\n) |E| \u2265\n|E|.\n\u0003\n\u03b5 1\u2212\u03b5\n8 + 2C\nNext, we want to get rid of the \u03b5 in the constant on the right hand side of the last inequality. For\nthis, the idea is to apply the last lemma repeatedly to several \"layers\" of covers. If we arrange that\nthe covers are invariant enough with respect to each other, we can at each stage obtain a subcover\nwith size almost a fixed fraction of the size of what remains after the last stage, and repeating this\nenough times we will get a large fraction of E.\nDefinition 4.12. For fixed {Fn }, \u03b5 > 0, if m < n are integers we write m \u227a\u03b5 n if for all n\u2032 \u2265 n\n|(\u222ai\u2264m Fi\u22121 )Fn\u2032 | \u2264 (1 + \u03b5)|Fn\u2032 |. For covers \u03bd1 , \u03bd2 we write \u03bd1 \u227a\u03b5 \u03bd2 if max \u03bd1 \u227a\u03b5 min \u03bd2 .\nIt is easy to verify that the relation \u227a\u03b5 is transitive. As an example of the relation \u227a\u03b5 , note that\nif {Fn } is (1 + \u03b5)-tempered, then i \u227a\u03b5 (i + 1) for all i. Also note that for any F\u00f8lner sequence {Fn }\nand for any m and \u03b5, m \u227a\u03b5 n is true for large enough n.\nDefinition 4.13. For n \u2208 N and \u03b5 > 0, let\nFn(\u03b5) = (\n\n[\n\nFi\u22121 )Fn .\n\ni:i\u227a\u03b5 n\n(\u03b5)\n\nFor a cover \u03bd let \u222a\u03b5 \u03bd = \u222a{Fn f : Fn f \u2208 \u03bd}.\n(\u03b5)\n\nBy definition of the \u227a\u03b5 relation, |Fn | \u2264 (1 + \u03b5)|Fn |. The following lemmas are proved like 4.9\nand 4.10:\nLemma 4.14. If \u03bd is an \u03b5-disjoint cover, then | \u222a\u03b5 \u03bd| \u2264\n|(\u222a\u03b5 \u03bd) \u222a (\u222a\u03b5 \u03bd x )| \u2264\n\n2(1+\u03b5)\n1\u2212\u03b5 | \u222a\n\n\u03bd|.\n\n1+\u03b5\n1\u2212\u03b5 |\n\n\u222a \u03bd|, and if (\u03bd, \u03bd x ) is \u03b5-disjoint then\n\n\f34\n\nMichael Hochman\n\nProposition 4.15. Let 0 < \u03b5 < 21 and x \u2208 \u03a9. Then there exists an integer N such that for any\nW\nsequence of N covers \u03bd1 \u227a\u03b5 \u03bd2 \u227a\u03b5 . . . \u227a\u03b5 \u03bdN over E there a exists simple subcover \u03bc \u2286 N\nk=1 \u03bdk such\n1\nx\nthat (\u03bc, \u03bc ) is \u03b5-disjoint and | \u222a \u03bc| \u2265 8 |E|.\n\nW\nProof. We will describe a subcover \u03bc \u2286 N\nk=1 \u03bdk , and show that if N was large enough to begin\nwith, the desired properties hold.\nThe proof is similar to lemma 4.11. Define inductively, from i = N down to i = 1, subcovers \u03bci\nof \u03bdi defined over sets Ei\u2032 = {fi1 , . . . , fiM (i) } \u2286 E as follows: Assuming we have defined \u03bcj , Ej\u2032 for\nj > i, set\n[\n\u0001\ndom \u03bcj \u222a (\u222a\u03b5 (\u03bcj \u2228 \u03bcxj )\nEi = E \\\nj\u2265k\n\n\u03bdi\u2032\n\nEi\u2032\n\nand = \u03bdi |Ei . \u03bci and\nare obtained by and applying lemma 4.11 to \u03bdi\u2032 . Finally, define E \u2032 = \u222ai\u2264I Ei\u2032\nand order E \u2032 as in lemma 4.11\nE \u2032 = {fi }M\ni=1 = {fI1 , . . . , fIM (I) , . . . , f11 , . . . , f1M (1) }\n\n(as before the Ei\u2032 are pairwise disjoint). Set \u03bc = \u222a\u03bcj It is easy to verify from the construction that\n\u03bc is simple and (\u03bc, \u03bcx ) is \u03b5-disjoint. We now show that | \u222a \u03bc| \u2265 18 |E|.\nSet D = \u222a\u03b5 (\u03bc \u2228 \u03bcx ). Then |D| \u2264 2(1+\u03b5)\n1\u2212\u03b5 | \u222a \u03bc|. Also, clearly | dom \u03bc| \u2264 | \u222a \u03bc| because \u03bc is \u03b5-disjoint.\nThus for each i = 1, . . . , N ,\n|Ei | \u2265 |E| \u2212 |D| \u2212 | dom \u03bc|\n2(1 + \u03b5)\n+ 1)| \u222a \u03bc\n\u2265 |E| \u2212 (\n1\u2212\u03b5\n3\u2212\u03b5\n\u2265 |E| \u2212\n| \u222a \u03bc|\n1\u2212\u03b5\nso by lemma 4.11\n| \u222a \u03bc| =\n\nN\nX\n\n| \u222a \u03bci | \u2265\n\ni=1\n\n\u2265\n\nN\nX\ni=1\n\n\u2265\n\nN\nX\ni=1\n\n\u2265\n\n\u03b5\n|Ei |\n8 + 2C\n3\u2212\u03b5\n\u03b5\n(|E| \u2212\n| \u222a \u03bc|)\n8 + 2C\n1\u2212\u03b5\n\n\u03b5N\n3\u2212\u03b5\n(|E| \u2212\n| \u222a \u03bc|)\n8 + 2C\n1\u2212\u03b5\n\n\fReturn times, recurrence densities and entropy\n\n35\n\nand after rearranging this is\n| \u222a \u03bc| \u2265\n\n\u0012\n\n8 + 2C\n(3 \u2212 \u03b5)\n+\n\u03b5N\n(1 \u2212 \u03b5)\n\n\u0013\u22121\n\n|E|\n\nfor N large enough this is greater than 81 |E|\n\n\u0003\n\nWe will also need the following lemma, which can be proved by the same techniques as above. It\nwas first proved by E. Lindenstrauss in [5], or see [11] for a different approach more similar to ours.\nLemma 4.16. Let 0 < \u03b5 < 12 . Then there exists an integer N such that for any sequence of N\nW\ncovers \u03bd1 \u227a\u03b5 \u03bd2 \u227a\u03b5 . . . \u227a\u03b5 \u03bdN over E, there exists a simple subcover \u03bd \u2286 N\ni=1 \u03bdi such that \u03bd is\n\u03b5-disjoint and | \u222a \u03bd| \u2265 (1 \u2212 2\u03b5)|E|.\nWe end this section with a combinatorial result akin to lemma 4.2:\nLemma 4.17. (Number of \u03b5-disjoint covers) Let L < N and 0 < \u03b5 < 12 . Then the number of\nsimple \u03b5-disjoint covers \u03bd with centers in FN , min \u03bd > L and \u222a\u03bd \u2286 FN is at most 2\u03c1(\u03b5,L)|FN | , where\nlimL\u2192\u221e \u03c1(\u03b5, L) = 0, uniformly in \u03b5.\n\b\nI\nProof. Each cover \u03bd = Fn(i) fi i=1 of the type we are interested in is determined by its centers\n{f1 , . . . , fI } and the values of n(i) for i = 1, . . . , I. If \u03bd is \u03b5-disjoint and \u222a\u03bd \u2286 FN , we have\n|FN | \u2265 | \u222a \u03bd| \u2265 (1 \u2212 \u03b5)\n\nI\nX\n\n|Fn(i) fi | \u2265 (1 \u2212 \u03b5) * I * L\n\ni=1\n\n1\n(1\u2212\u03b5)L |FN |.\n\nsince |Fn f | \u2265 n and min \u03bd > L. Thus I \u2264\nSince we only consider simple covers, the\nnumber of possible sets of centers for such \u03b5-disjoint covers \u03bd with centers in FN is bounded by the\n1\nnumber of subsets of size at most (1\u2212\u03b5)a\n|FN | of |FN |, which by lemma 4.2 is bounded above by\nL\n1\n\u03b4( (1\u2212\u03b5)L\n)|FN |\n\n2\n\n.\n\nWe now calculate how many \u03b5-disjoint covers \u03bd exist which satisfy our assumptions and have\n\b\nI\ndom \u03bd = E for some fixed set E. We use a coding argument: Given \u03bd = Fn(i) fi i=1 as above, we\nwrite down the values n(i) in binary notation in some pre-determined order (eg fix an order on G\nand write n(i) down according to the order of the fi ). In order to decode the resulting concatenated\nsequence of 0s and 1s we must insert \"punctuation\" into the resulting concatenation of numbers.\nWe therefore code each binary digit 0 as 00 and each 1 as 11, and terminate each number with the\npair 01. Using this scheme, we can clearly recover \u03bd from E and the codeword. In order to code\nn(i) in this manner we use 2 log n(i) + 2 bits. Recalling that we always assume |Fn | \u2265 n, the length\n\n\f36\n\nMichael Hochman\n\nof the resulting codeword is\nI\nI\nX\nX\n(2 + 2 log |Fn(i) fi |)\n(2 log n(i) + 2) \u2264\ni=1\n\ni=1\n\n\u2264 2*I +2\n\nI\nX\n\n|Fn(i) |\n\ni=1\n\n\u2264\n\nlog |Fn(i) |\n|Fn(i) |\nI\n\n2\nlog L X\n|FN | + 2 *\n|Fn(i) fi |\n(1 \u2212 \u03b5)L\nL\ni=1\n\n\u2264\n\u2264\n(\n\n2\n\n+\n\nlog L\n\n2 log L | \u222a Fn(i) fi |\n2\n|FN | +\n*\n(1 \u2212 \u03b5)L\nL\n1\u2212\u03b5\n2 log L\n2\n|FN | +\n|FN |.\n(1 \u2212 \u03b5)L\n(1 \u2212 \u03b5)L\n\n)|F |\n\nThus there are at most 2 (1\u2212\u03b5)L) (1\u2212\u03b5)L N such covers over a fixed set E.\nPutting this all together, we see that the number of \u03b5-disjoint covers \u03bd with min \u03bd > L and\n\u222a\u03bd \u2286 FN is at most\n\u0013\n\u0013\n\u0012\n\u0012\n1\n2\n2 log L\n+ \u03b4(\n)+\n|FN |\nexp ln 2 *\n(1 \u2212 \u03b5)L\n(1 \u2212 \u03b5)L\n(1 \u2212 \u03b5)L\nwhich proves the lemma.\n\n\u0003\n\n4.4. Proof of the lower bound for T\u2217 (Part II).\n(F,W )\n\n<\nProof. (of theorem 4.3) Fix {Fn },{Wn } and the (Xg )g\u2208G , defined on (\u03a9, F, P ). Suppose P (T\u2217\nh \u2212 \u03b5) > p > 0. We are going to use lemma 4.15 to construct a sequence {cn } of Fn -codes such that\neventually almost surely x(Fn ) can be reconstructed from cn (x), and\np\n1\nl(cn (x)) \u2264 h \u2212 \u03b5.\n|Fn |\n5\nThis would contradict the fact that entropy is a lower bound for the achievable coding rates (section\n4.1), since we can proceed as in lemma 4.1 and turn {cn } into a faithful code with the same rate.\nFix a \u03b7 > 0 and a series {\u03a6n } of sets of entropy-typical Fn -patterns, \u03a6n \u2286 \u03a3Fn , such that for\nevery \u03c6 \u2208 \u03a6,\n2\u2212(h+\u03b7)|Fn | \u2264 P ([\u03c6]) \u2264 2\u2212(h\u2212\u03b7)|Fn |\nand x \u2208 [\u03a6n ] eventually almost surely. For x \u2208 \u03a9 and N fixed, consider the pattern x(FN ); the\ncodeword cN (x) depends only on this pattern, and is constructed as follows:\n\n\fReturn times, recurrence densities and entropy\n\n37\n\nStep 1: Consider the sets Fk f \u2286 FN such that Tk (f x) < 2(h\u2212\u03b5/2)|Fk | , and from this collection\ntry to extract a cover \u03bc such that (\u03bc, \u03bcx ) is \u03b7-disjoint and very large. To be precise, we\nrequire that | \u222a \u03bc| \u2265 p8 |FN |. However, we try to choose \u03bc so that the next step is possible:\nStep 2: Consider the sets Fk f \u2286 FN for which f x \u2208 [\u03a6k ], and from this collection try to\nextract an \u03b7-disjoint cover \u03bd which is also disjoint from \u222a\u03bc. We choose \u03bd as large as\npossible; we require that \u222a\u03bd and \u222a\u03bc together cover all but a 3\u03b7-fraction of FN .\nStep 3: If we cannot find \u03bc, \u03bd as in steps 1,2 with the required sizes, we define cN (x) to be\nthe empty word.\nStep 4: Otherwise, let A1 be the set guarenteed by lemma 4.7 when applied to \u03bc, so A1 \u2286 \u222a\u03bc\nand |A1 | < 2\u03b7| \u222a \u03bc| \u2264 2\u03b7|FN |, and A1 has the property that if pattern x1 (A \u222a (\u222a\u03bcx )) is\nknown and if the elements f x,k are known for every Fk f \u2208 \u03bc then x(\u222a\u03bc) can be deduced.\nAlso, let A2 = FN \\ ((\u222a\u03bc) \u222a (\u222a\u03bd)).\nStep 5: Now define (assuming steps 1 and 2 were successful) cn (x) = \u03b31 \u03b32 \u03b33 , where\n\u2022 \u03b31 encodes the pattern x(A1 \u222a A2 ).\n\u2022 \u03b32 encodes the pattern x(\u222a\u03bd).\n\u2022 \u03b33 encodes the cover \u03bc along with the elements f x,k for each Fk f \u2208 \u03bc.\nIt is clear from the definition of A1 that if steps 1,2 succeeded then we can reconstruct x(FN ) from\ncN (x). It remains to show that for almost every x, steps 1 and 2 will succeed for large enough N ,\nand that in this case the encoding, as described in step 5, can be carried out in such a way that\nl(cN (x)) \u2264 (h \u2212 p/10)|FN |.\nWe begin by showing that for large enough N , steps 1 and 2 will succeed. Fix integers M, L to\nbe determined later, and select a sequence of intervals {[ai ; bi ]}2L\ni=1 such that a1 = M , bi \u227a\u03b7 ai+1\nand\n(1) For a set of x \u2208 \u03a9 with probability greater than p there exist indices mi (x) \u2208 [ai ; bi ] such\nthat Tmi (x) (x) \u2264 h \u2212 \u03b5 for each i.\n(2) For a set of x \u2208 \u03a9 with probability greater than 1 \u2212 \u03b7 there exist indices ni (x) \u2208 [ai ; bi ] such\nthat x \u2208 \u03a6ni (x) for each i.\nSuch a sequence is easy to construct using the ergodic theorem, the fact that P (T\u2217 \u2264 h \u2212 \u03b5) > p,\nand our choice of {\u03a6n }; we omit the details.\nFrom the pointwise ergodic theorem and the asymptotic invariance of {Fn }, for almost every\nx \u2208 \u03a9 it holds for large enough N that\n\uf8f1\n\uf8fc\n\uf8f4\n\uf8f4\nfor\nL\n+\n1\n\u2264\ni\n\u2264\n2L\nthere\nexist\nindices\n\uf8f2\n\uf8fd\n1\n(4.1)\n# f \u2208 FN mi (f ) \u2208 [ai ; bi ] with Tmi (f ) (f x) \u2264 h \u2212 \u03b5\n>p\n\uf8f4\n|FN | \uf8f4\n\uf8f3\n\uf8fe\nx\nFmi (f ) f \u2286 FN and (Fmi (f ) f ) \u2286 FN\n\n\f38\n\nMichael Hochman\n\n(4.2)\n\n\uf8f1\n\uf8f4\n\uf8f2\n1\n# f \u2208 FN\n|FN | \uf8f4\n\uf8f3\n\nfor 1 \u2264 i \u2264 L there exist indices\nni (f ) \u2208 [ai ; bi ] with\nf x \u2208 \u03a6ni (f ) and Fni (f ) f \u2286 FN\n\n\uf8fc\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8fe\n\n> 1 \u2212 \u03b7.\n\nFor x, N such that the above holds, let mi (f ) and ni (f ) be as in (4.1) and (4.2).\n\b\nLet E1 \u2286 FN be the set described in 4.1, and \u03bci = Fmi (f ) f f \u2208E , so we have covers \u03bci over E1 .\n1\nNote that \u03bc1 \u227a\u03b7 \u03bc2 \u227a\u03b7 . . . \u227a\u03b7 \u03bcL by our choice of [ai ; bi ]; so assuming L was chosen large enough\nW\nwe can apply lemma 4.16 to \u03bc1 , . . . , \u03bcL and obtain a simple subcover \u03bc \u2286 L\ni=1 \u03bci over some set\n1\n\u2032\nx\nE1 = {f1 , . . . , fI } \u2286 E1 such that (\u03bc, \u03bc ) is \u03b7-disjoint and | \u222a \u03bc| \u2265 8 |E1 |, which means that\np\n| \u222a \u03bc| \u2265 |FN |.\n8\n\b\nLet E2 \u2286 FN be the set described in 4.2, and \u03bdi = Fni (f ) f f \u2208E , so we have covers \u03bdi over E2 .\n2\nAs with the \u03bci , we have \u03bd1 \u227a\u03b7 \u03bd2 \u227a\u03b7 . . . \u227a\u03b7 \u03bdL , and furthermore \u03bdL \u227a\u03b7 \u03bc. Let \u03bdi\u2032 be the restriction\nof \u03bdi to E2 \\ \u222a\u03b7 \u03bc, so each member set of \u03bdi\u2032 is disjoint from \u222a\u03bc. Assuming L is large enough we apply\nW\n\u03b7\n\u2032\n\u2032\nlemma 4.16 and obtain an \u03b7-disjoint simple subcover \u03bd \u2286 L\ni=1 \u03bdi over some set E2 \u2286 E2 \\ (\u222a \u03bc)\nsuch that | \u222a \u03bd| \u2265 (1 \u2212 2\u03b7)|E2 \\ (\u222a\u03b7 \u03bc)|. We then have\n\u0013\n\u0012\n1+\u03b7\n| \u222a \u03bc| .\n| \u222a \u03bd| \u2265 (1 \u2212 2\u03b7) (|E2 | \u2212 | \u222a\u03b7 \u03bc|) \u2265 (1 \u2212 2\u03b7) (1 \u2212 \u03b7)|FN | \u2212\n1\u2212\u03b7\nBy construction \u03bc, \u03bd are disjoint, and putting the last two paragraphs together, we have\n| \u222a (\u03bc \u2228 \u03bd)| = | \u222a \u03bc| + | \u222a \u03bd| \u2265\n1+\u03b7\n)| \u222a \u03bc| + (1 \u2212 2\u03b7)(1 \u2212 \u03b7)|FN | \u2265 (1 \u2212 3\u03b7)|FN |.\n1\u2212\u03b7\nThus all but a 3\u03b7-fraction of FN is covered by \u03bc \u222a \u03bd, and we have shown that for almost every x,\nfor large enough N there exist \u03bc, \u03bd as required by steps 1 and 2 of the coding construction.\nWe complete the proof by giving a more detailed description of the encoding of cN (x) (in the\ncase where steps 1,2 succeeded) by specifying exactly how to construct \u03b31 , \u03b32 , \u03b33 , and show that the\ncodeword length is indeed bounded by (h \u2212 p/5)|FN |.\nRecall the functions \u03b4(*) and \u03c1(*, *) defined in lemmas 4.2 and 4.17 respectively. In the estimates\nbelow we ignore rounding errors; the reader may verify that these may be taken into account without\ndisrupting the proof.\nFix x, N so that steps 1,2 of the construction succeeded. Let \u03bc, \u03bd, A1 , A2 be as in the construction.\nWrite H = A1 \u222a A2 . The word \u03b31 will first encode the set H and then the values x(f ) for f \u2208 H.\nThe former takes \u03b4(5\u03b7)|FN | bits, because by lemma 4.2 we can costruct a list of all 2\u03b4(5\u03b7)|Fn | subsets\nof Fn with size at most 5\u03b7|Fn | and then describe H by giving its index in the list. Next, using some\n\u2265 (1 \u2212 (1 \u2212 2\u03b7)\n\n\fReturn times, recurrence densities and entropy\n\n39\n\nfixed ordering of G (which induces an order on H), we write down the symbols x(f ) for f \u2208 H.\nFor this we need an additional |H| log \u03a3 \u2264 (5\u03b7 log \u03a3)|FN | bits. So all together x(H) can be coded\nin (\u03b4(5\u03b7) + 5\u03b7 log \u03a3)|FN | bits.\nThe word \u03b32 will be coded by specifying first the cover \u03bd and then the values x(Fk f ) for Fk f \u2208 \u03bd.\nThe first task is accomplished using \u03c1(\u03b7, M )|FN | bits by lemma 4.17. Now for each Fk f \u2208 \u03bd,\naccording to some fixed order, we record the pattern x(Fk f ) by giving the index of the pattern\nx(Fk f ) in \u03a6k . This requires (h + \u03b7)|Fk | bits by our choice of {\u03a6n }, because |\u03a6k | \u2264 2(h+\u03b7)|Fk | , and\nbecause by the definition of \u03bd, f x \u2208 [\u03a6k ] whenever Fk f \u2208 \u03bd. Thus to describe all the patterns\nx(Fk f ) for Fk f \u2208 \u03bd, we need\nX\nX\nh+\u03b7\n(h + \u03b7)|Fk f | = (h + \u03b7)\n|Fk f | \u2264\n| \u222a \u03bd|\n1\u2212\u03b7\n\u03bd\n\u03bd\n\nbits. All together, we see that we can code \u03b32 with at most \u03c1(\u03b7, M )|FN | + h+\u03b7\n1\u2212\u03b7 | \u222a \u03bd| bits.\nThe word \u03b33 is coded by first describing \u03bc and then, for each Fk f \u2208 \u03bc, we describe f x,k . The\nformer is again achieved with \u03c1(\u03b7, M )|FN | bits (the same calculation as above applies), while the\nlatter requires at most (h \u2212 \u03b5)|F\u03bc(f ) | bits for each Fk f \u2208 \u03bc, by definition of f x,k . Note that this is\nwhere we use the assumption that {Wn } is increasing: for if it were not, then in order to record\nf x,k we would need to specify also which set Wn it is from. In other words, we would need to record\nRk (f x), and this could be expensive (there is no upper bound on Rk (f x)). However, since {Wn }\nis increasing, we can assume that f x,k comes from the largest set Wn satisfying |Wn | < 2(h\u2212\u03b5)|Fk | ).\nThus estimating as we did for \u03b32 we find that \u03b33 can be coded in\nX\nh\u2212\u03b5\n\u03c1(\u03b7, M )|FN | + (h \u2212 \u03b5)\n|Fk f | \u2264 \u03c1(\u03b7, M )|FN | +\n| \u222a \u03bc|\n1\u2212\u03b7\n\u03bc\nbits.\nPutting all this together, we find\nl(cN (x)) = l(\u03b31 ) + l(\u03b32 ) + l(\u03b33 )\n\uf8f1\n(\u03b4(7\u03b7) + 5\u03b7 log \u03a3) |FN |+ \u0011\n\uf8f4\n\uf8f4\n\uf8f2 \u0010\n+ \u03c1(\u03b7, M )|FN | + h+\u03b7\n\u2264\n1\u2212\u03b7 | \u222a \u03bd|\u0011\n\u0010\n\uf8f4\n\uf8f4\n\uf8f3 + \u03c1(\u03b7, M )|F | + h\u2212\u03b5 | \u222a \u03bc|\nN\n\n\u2264\n\n(\n\n1\u2212\u03b7\n\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8f4\n\uf8fe\n\n(\u03b4(7\u03b7) + 5\u03b7 log \u03a3 + 2\u03c1(\u03b7, M )) |FN |+\n\u03b5\u2212\u03b7\n+ h+\u03b7\n1\u2212\u03b7 |(\u222a\u03bd) \u222a (\u222a\u03bc)| \u2212 1\u2212\u03b7 | \u222a \u03bc|\n\n\u2264 (h + \u03c4 (\u03b7, M ))|FN | \u2212\n\n\u03b5\u2212\u03b7 p\n* |FN |\n1\u2212\u03b7 8\n\n)\n\n\f40\n\nMichael Hochman\n\nwhere \u03c4 (\u03b7, M ) \u2192 0 as M \u2192 \u221e uniformly in \u03b7. So for M large enough and \u03b7 small enough we have\np\nl(cN (x)) \u2264 (h \u2212 \u03b5)|FN |.\n10\nThis completes the proof.\n\u0003\n\n4.5. The lower bound for U\u2217 . In this section we prove that\n1\n1\n(F,W )\nlog(Uk,n (x) \u2212\n)\u2265h\n|Fk |\n|Wn |\nalmost surely if {Fn },{Wn } satisfy the conditions of theorem 1.11.\nAs was already mentioned in the introduction, the correction term \u2212 |W1n| in the definition of U\u2217\nis necessary because Uk,n counts the central pattern x(Fk ); without it, if for instance 1G \u2208 W1 , we\nwould have for every k that Uk,1 \u2265 |W11 | , and this implies U\u2217 = 0 for any process.\nIn the previous section, we defined the quantities Vk,n and V \u2217 , and showed that U \u2217 = V \u2217 . We\nmay analogously define\n1\n1\nlog(Vk,n \u2212\n)\nV\u2217 = lim inf inf \u2212\nn\nk\n|Fk |\n|Wn |\nas a version of U\u2217 which counts all repetitions of x(Fk ) in x(Wn ), but we cannot, as was the case\nwith V \u2217 , show that U\u2217 = V\u2217 , because when the correction factor is taken into account, if we compare\nUk,n \u2212 |W1n| with Vk,n \u2212 |W1n| as in equation 3.1, we find that all we can say is\n(F,W )\n\nU\u2217\n\n(x) = lim inf inf \u2212\n\nUk,n \u2212\n\n1\n1\n1\n|Fk |2\n\u2264 Vk,n \u2212\n\u2264 |Fk |2 (Uk,n \u2212\n)+\n|Wn |\n|Wn |\n|Wn |\n|Wn |\n\nk\u2192\u221e\n\nn\n\nand this gives us U\u2217 \u2265 V\u2217 but not the reverse inequality.\nFurthermore, the fact that Uk,n does not count repetitions of x(Fk ) which intersect Fk is necessary\nfor our proof that U\u2217 \u2265 h; the proof cannot be adapted to the case of V\u2217 . The importance of the\nrequirement that Uk,n not count the repetition which intersect the original pattern stems from the\nfollowing observation, which is used in an essential way in the proof: For almost every x, for large\nenough k, Uk,n (x) = 0 unless |Wn | > 2(h\u2212\u03b5)|Fk | . This follows from the fact that if Uk,n (x) > 1 then\nthere is within Wn a repetition of x(Fk ) disjoint from Fk , and so Rk (x) \u2264 n, which in turn implies\nTk (x) \u2264 |Wn | (we will assume that {Wi } is increasing); now use the fact that for large enough k, by\ntheorem 4.3, Tk (x) > 2(h\u2212\u03b5)|Fk | . In the case of Vk,n , if Vk,n > 1 it may be because of a repetition of\nx(Fk ) which intersects Fk , and this argument fails. Thus we can't allow repetitions which intersect\nFk to be counted in Uk,n because Rk was defined as the first repetition of x(Fk ) disjoint from Fk . If,\nhowever, we were able to prove an analogue of T\u2217 \u2265 h (theorem 4.3) for the case where Rk counts all\nrepetitions in Wn of x(Fk ), including those intersecting Fk , then the proof below would work just as\n\n\fReturn times, recurrence densities and entropy\n\n41\n\nwell for V\u2217 . This version of theorem 4.3 is true, for instance, in the case of Wn = [\u2212kn ; kn ]d \u2286 Zd .\nThis was proved in [8].\nOne can, however, define\n)\n(\n1G \u2208 E \u2286 Wn and if 1G 6= f \u2208 E then\n1\n.\nmax |E|\nV\u0302k,n (x) =\n|Wn |\nFk \u2229 Fk f = \u2205 , and f x \u2208 [x(Fk )]\nThen we have that\nUk,n \u2212\n\n1\n1\n1\n\u2264 V\u0302k,n \u2212\n\u2264 |Fk |2 (Uk,n \u2212\n)\n|Wn |\n|Wn |\n|Wn |\n\nand so V\u0302\u2217 = lim inf k\u2192\u221e inf n \u2212 |F1k | log(V\u0302k,n (x) \u2212\n\n1\n|Wn | )\n\n= U\u2217 .\n(F,W )\n\n\u2265h\nOur proof that U\u2217 \u2265 h is based on the bound T\u2217 \u2265 h. It is not hard to see that U\u2217\n(F,W )\n(F,W )\n(F,W )\nimplies T\u2217\n\u2265 h. We would like to show the reverse, namely, that U\u2217\n< h implies T\u2217\n< h.\n1\n\u2212(h\u2212\u03b5)|F\n|\nk\nThe idea behind the proof is that from the relation Uk,n (x) \u2212 |Wn | > 2\n, which means that\nthere are \"too many\" repetitions of x(Fk ) in Wn , we can sometimes deduce that many of the points\ng \u2208 Wn at which x(Fk ) repeats are such that another repetition of the same pattern appears \"too\nclose\" to g. If we could show this, we can appeal to the fact that T\u2217 \u2265 h to obtain a contradiction.\nOne problem here is that the window sets Wn may be unsuitable for capturing the idea of \"too\nclose\". This will happen if the sequence {Wn } grows too quickly, and in this case we will not be\n(F,W )\n. We therefore introduce a second window sequence\nable to obtain a contradiction through Tk\n(F,Y )\n{Yn }, which will grow slowly enough that with respect to {Yn }, a drop of Tk\nbelow entropy\ncan be observed. We will show that for a nice enough sequence {Yn }, if with positive probability\n(F,Y )\n(F,W )\n\u2265 h, which is impossible.\n< h \u2212 \u03b5 is true, then it is not almost surely true that T\u2217\nU\u2217\nWe recall the following definitions, which were given in the introduction:\nDefinition. Let {Fn }, {Wn } be sequences of finite subsets of G. An increasing sequence {Yn } of\nfinite subsets of G is called an interpolation sequence for {Fn }, {Wn } if\n(1) {Yn } is filling and increasing .\n(2) If |Wn | \u2265 |Ym | then |Ym Wn | \u2264 C|Wn | for some constant C.\n(3) For every pair of real numbers 0 \u2264 \u03b1 < \u03b2, for every large enough n there is an index k such\nthat 2\u03b1|Fn | \u2264 |Yk | \u2264 2\u03b2|Fn | .\nThe main lemma we will need about interpolation sequences is that too frequent recurrence of\n(F,Y )\n(f x) is too small for many f \u2208 Wn .\nx(Fk ) in x(Wn ) implies that Tk\nLemma 4.18. Let Y be 1/C-filling and E \u2286 W \u2286 G finite sets. Suppose that |Y W | \u2264 C|W |. If\n|E|\n|W | \u2265 \u03b1 then\n1\n\u03b2\n| {f \u2208 E : |Y f \u2229 E| > \u03b2} | \u2265 \u03b1 \u2212 C 2\n.\n|W |\n|Y |\n\n\f42\n\nMichael Hochman\n\nProof. Let E\u2212 = {f \u2208 E : |Y f \u2229 E| \u2264 \u03b2}, and let {Y fi }Ii=1 be an incremental cover of E\u2212 with\nfi \u2208 E\u2212 . Then by the basic lemma 3.1 we have that\n|E\u2212 |\n\u03b2\n\u2264C\n| \u222ai Y fi |\n|Y |\nsince \u222ai Y fi \u2286 Y W we have\n\n\u03b2\n\u03b2\n|Y W | \u2264 C 2\n|W |\n|Y |\n|Y |\n\u001a\n\u001b\n1\n|Y f \u2229 E|\n1\n\u03b2\n| f \u2208E :\n>\u03b2 |=\n(|E| \u2212 |E\u2212 |) \u2265 \u03b1 \u2212 C 2\n.\n|W |\n|Y |\n|W |\n|Y |\n|E\u2212 | \u2264 C\n\nso\n\n\u0003\n\nCorollary 4.19. Let 0 < \u03b4 < \u03b5/2, and let {Yn } be an interpolation sequence for {Fn } , {Wn }. If\n(F,W )\nfor some k, n and x \u2208 \u03a9 we have Uk,n (x) \u2265 2(h\u2212\u03b5)|Fk | , and if |Wn | > 2(h\u2212\u03b4)|Fk | , then if k is large\nenough,\n)\n(\nf x \u2208 [x(Fk )] and\n1\n1\n| > 2\u2212(h\u2212\u03b5)|Fk | .\n| f \u2208 Wn\n(F,Y )\n(h\u2212\u03b5/2)|F\n|\nk\n|Wn |\n2\n(f x) < 2\nTk\nProof. Set E = {f \u2208 Wn : f x \u2208 [x(Fk )]} and \u03b2 = |Fk |2 . For k large enough there exists an m such\nthat\n2(h\u22122\u03b5/3)|Fk | \u2264 |Ym | \u2264 2(h\u2212\u03b5/2)|Fk |\nSince |Wn | > 2(h\u2212\u03b4)|Fk | , we have |Ym Wn | \u2264 C|Wn |, so by the lemma (with \u03b1 = 2\u2212(h\u2212\u03b5)|Fk | )\n1 \b\n| f \u2208 E : |Ym f \u2229 E| > |Fk2 | | \u2265\n|Wn |\n\n1\n\u2265 2\u2212(h\u2212\u03b5)|Fk | \u2212 C 2 |Fk |2 2\u2212(h\u22122\u03b5/3)|Fk | \u2265 2\u2212(h\u2212\u03b5)|Fk |\n2\nfor k large enough. Now note that if for some f \u2208 E we have |Ym f \u2229 E| > |Fk |2 then at least one of\n(F,Y )\nthe repetitions of f x(Fk ) within f x(Ym ) is disjoint from f x(Fk ), so Tk\n(f x) \u2264 |Ym | < 2(h\u2212\u03b4)|Fk | .\nThis completes the proof.\n\u0003\nThe second requirement we make of {Wn } is that it be incompressible. We recall the definition:\nDefinition. An increasing sequence {Wn } of finite subsets of G with 1G \u2208 Wn is said to be\n\b\nincompressible with constant C (or C-incompressible) if for any incremental sequence Wn(i) fi ,\nthe number of the sets Wn(i) fi containing 1G is at most C.\n\nAn incompressible sequence {Wn } is filling; if {Wn } is incompressible with constant C then it\nwill be filling with constant C1 , since for a collection {Wn(i) fi }i\u2208I as above, each g \u2208 \u222ai\u2208I Fn(i) fi\nbelongs to at most C of the sets Wn(i) fi . Incompressible sequences are superior to filling sequences\nbecause of the following observation: If {Wn } is incompressible and {Wn(i) fi }Ii=1 is incremental,\n\n\fReturn times, recurrence densities and entropy\n\n43\n\nthen for any finite A \u2286 G, we have\n[\n1 X\n|A \u2229 Wn(i) fi |.\n|A \u2229\nWn(i) fi | \u2265\nC\n1\u2264i\u2264I\n\ni\u2208I\n\nThis is because every a \u2208 A is counted at most C times in the sum on the right.\nThe property of incompressibility is equivalent to the following property, which may be described\nas being filling relative to arbitrary subsets of G:\n\b\nI\nLemma 4.20. Let {Wn } be incompressible, H1 , H2 \u2286 G and suppose Wn(i) fi i=1 is an incremental\nsequence such that for each i = 1, . . . , I we have that\n\u03b1\u2264\nThen\n\n|H1 \u2229 Wn(i) fi |\n\u2264 \u03b2.\n|H2 \u2229 Wn(i) fi |\n\n|H1 \u2229 (\u222ai Wn(i) fi )|\n\u03b1\n\u2264\n< C\u03b2\nC\n|H2 \u2229 (\u222ai Wn(i) fi )|\n\n(this remains true for \u03b1 = 0 or \u03b2 = \u221e) .\nIt is not difficult to see that if {Wn } satisfies the conclusion of the lemma then it is incompressible.\nProof. We show for instance the lower bound.\n1 P\n|H1 \u2229 Wn(i) fi |\n|H1 \u2229 (\u222ai Wn(i) fi )|\nC\n\u2265 P\n\u2265\n|H2 \u2229 (\u222ai Wn(i) fi )|\n|H2 \u2229 Wn(i) fi |\n\n(we use here the fact that {Wn } is\n\u2265\n\n1\nC -filling)\n\n|H1 \u2229 Wn(i) fi |\n\u03b1\n1 X |H2 \u2229 Wn(i) fi |\nP\n\u2265 .\n*\nC\n|H\n\u2229\nW\nf\n|\nC\n|H\n\u2229\nW\nf\n|\n2\n2\nn(i) i\nn(i) j\nj\n\n\u0003\n\ni\n\nTheorem 4.21. Let Fn be a tempered F\u00f8lner sequence, {Xg }g\u2208G an ergodic process with entropy h.\nLet {Wn } be an incompressible sequence. If there exists an interpolation sequence for {Fn } , {Wn }.\nThen\n1\n(F,W )\nlim inf inf \u2212\nlog Uk,n (x) \u2265 h.\nk\u2192\u221e n\n|Fk |\nProof. Suppose the theorem is false. Then there is a set B \u2286 \u03a9 with P (B) > p > 0 such that for\nevery x \u2208 B,\n1\n(F,W )\nlim sup sup \u2212\nlog Uk,n (x) \u2264 h \u2212 \u03b5\n|Fk |\nn\nk\u2192\u221e\nfor some \u03b5 > 0. Let {\u03a6n } be a sequence of sets of words, \u03a6n \u2286 \u03a3Fn , such that\n1\nlog |\u03a6n | \u2192 h\n|Fn |\n\n\f44\n\nMichael Hochman\n\nand x \u2208 [\u03a6n ] eventually almost surely. Fix L very large; we may assume that x \u2208 [\u03a6n ] for every for\nn \u2265 L and x \u2208 B. We may also assume that L was chosen large enough that |\u03a6k | \u2264 2(h+\u03b4)|Fk | for\nk > L.\nFor every x \u2208 B there exists an index k(x) > L and an index n(x) such that\nUk(x),n(x) (x) \u2265 2\u2212(h\u2212\u03b5)|Fk(x) |\nand without loss of generality we may assume that for every x \u2208 B we have n(x) \u2264 M for some integer M . We further assume, increasing L if necessary, that for every x \u2208 B, |Wn(x) | > 2(h\u2212\u03b5/4)|Fk(x) | ,\n(F,W )\n\n\u2265 h almost surely.\nbecause T\u2217\nLet x \u2208 \u03a9 be typical in the sense that the ergodic theorem holds for B and every [\u03a6k ], L \u2264 k \u2264 M .\nBy the ergodic theorem, we can choose N large enough so that\n1\n| {f \u2208 FN : f x \u2208 B} | > p.\n|FN |\nFor f \u2208 FN such that f x \u2208 B, we will write for brevity k(f ) = k(f x) and n(f ) = n(f x).\nStep 1: Fix L \u2264 k \u2264 M and \u03c6 \u2208 \u03a6k , and let\nH = {f \u2208 FN : f x \u2208 [\u03c6]} , E = {f \u2208 H : f x \u2208 B , k(f ) = k} .\n(F,W )\n\nIf f \u2208 E then Uk,n(f ) (f x) \u2265 2\u2212(h\u2212\u03b5)|Fk | . Some of the points g \u2208 Wn(f ) f at which \u03c6 repeats will\nbelong to E as well, and some won't. Write E + for the set of f \u2208 E for which \"many\" of the\nrepetitions of \u03c6 in Wn(f ) f are in E:\n\u001a\n\u001b\n1\n+\n\u2212(h\u2212\u03b5/2)|Fk |\nE = f \u2208E :\n|W\nf \u2229 E| \u2265 2\n|Wn | n(f )\nand\n\n\u001a\nE =E\\E = f \u2208E :\n\u2212\n\n+\n\n\u001b\n1\n\u2212(h\u2212\u03b5/2)|Fk |\n|W\nf \u2229 E| < 2\n.\n|Wn | n(f )\n(F,Y )\n\n< 2\u2212(h+\u03b5/4)|Fk | . Let\nWe are interested in the elements of FN for which Tk\no\nn\n(F,Y )\n(f x) < 2\u2212(h+\u03b5/2)|Fk | .\nD = f \u2208 H : Tk\nNow if f \u2208 E + , then by lemma 4.19 we have that\n\n1\n|(E \u2229 Wn(f ) f ) \u2229 D| \u2265 |E \u2229 Wn(f ) f |.\n2\n\n\fReturn times, recurrence densities and entropy\n\n45\n\n\b\nI\nSelect an incremental cover Wn(fi ) fi i=1 of E + with fi \u2208 E + . For each i we have that the relative\ndensity of D \u2229 E in Wn(fi ) fi is at least half the density of E, so from lemma 4.20 we see that\n|(E \u2229 D) \u2229 (\u222aWn(fi ) fi )|\n1\n\u2265\n|E \u2229 (\u222aWn(fi ) fi )|\n2C\n\n(4.3)\n\nand therefore, since E + \u2286 \u222aWn(fi ) fi , we have\n|E \u2229 D| \u2265\n\n(4.4)\n\n1\n|E + |.\n2C\n\nOn the other hand, if f \u2208 E \u2212 , we have that the number of elements of H in Wn(f ) f is at least\n2(\u03b5/2)|Fk | times the number of elements of E in Wn(f ) f , so\n|Wn(f ) f \u2229 D| \u2265\n\n1\n1\n|Wn(f ) f \u2229 H| \u2265 2(\u03b5/2)|Fk | * |E \u2229 Wn(f ) f |.\n2\n2\n\n\b\nNow select an incremental cover Wn(fi ) fi\n\nI\ni=1\n\nof E \u2212 . From lemma we have\n\n|D \u2229 (\u222aWn(fi ) fi )|\n1 (\u03b5/2)|Fk |\n\u2265\n2\n|E \u2229 (\u222aWn(fi ) fi )|\n2C\n\n(4.5)\n\nand therefore, since E \u2212 \u2286 \u222aWn(fi ) fi , we have\n|D| \u2265\n\n(4.6)\n\n1 (\u03b5/2)|Fk | \u2212\n2\n|E |.\n2C\n\nWe now face two alternatives:\n(1) If |E + | \u2265 12 |E| then equation 4.4 gives us\n|E \u2229 D| \u2265\n\n1\n1\n|E + | \u2265\n|E|.\n2C\n4C\n\n(2) Otherwise, if |Ek\u03c6,\u2212 | > 12 |Ek\u03c6 |, equation 4.6 gives\n|D| \u2265\n\n1 (\u03b5/2)|Fk |\n1 (\u03b5/2)|Fk | \u2212\n2\n|E | \u2265\n2\n|E|.\n2C\n4C\n\nStep 2: For fixed k and \u03c6 \u2208 \u03a3Fk write D \u03c6 , E \u03c6 for the sets D, E of step 1, thus making explicit the\ndependence on \u03c6 which was previously suppressed. Note that the collections {D \u03c6 }\u03c6\u2208\u03a6k , {E \u03c6 }\u03c6\u2208\u03a6k\n1\nare pairwise disjoint. For each \u03c6 \u2208 \u03a6k we have by the above that either (a) |E \u03c6 \u2229 D \u03c6 | \u2265 4C\n|E \u03c6 |\n1 (\u03b5/2)|Fk |\nor (b) |D \u03c6 | \u2265 4C\n2\n|E \u03c6 |. Let \u03a6+\nk \u2286 \u03a6k be the set of \u03c6's for which the first alternative holds,\n\u2212\nand \u03a6k its complement in \u03a6k . There are again two alternatives:\n(1) | \u222a\u03c6\u2208\u03a6+ E \u03c6 | \u2265 12 | \u222a\u03c6\u2208\u03a6k E \u03c6 |. In this case\nk\n[\n[\n|\n(E \u03c6 \u2229 D \u03c6 )| \u2265 |\n(E \u03c6 \u2229 D \u03c6 )| =\n\u03c6\u2208\u03a6k\n\n\u03c6\u2208\u03a6+\nk\n\n\f46\n\nMichael Hochman\n\n=\n\nX\n\n|E \u03c6 \u2229 D \u03c6 | \u2265\n\n\u03c6\u2208\u03a6+\nk\n\n1 X\n|E \u03c6 | =\n4C\n+\n\u03c6\u2208\u03a6k\n\n1 [ \u03c6\n1 [ \u03c6\n=\n|\n|\nE |.\nE |\u2265\n4C\n8C\n+\n\u03c6\u2208\u03a6k\n\n\u03c6\u2208\u03a6k\n\n(2) | \u222a\u03c6\u2208\u03a6\u2212 E \u03c6 | >\nk\n\n1\n2 | \u222a\u03c6\u2208\u03a6k\n\nE \u03c6 |. In this case\n[\n[\nD\u03c6 | \u2265 |\n|\nD\u03c6 | =\n\u03c6\u2208\u03a6\u2212\nk\n\n\u03c6\u2208\u03a6k\n\n=\n\nX\n\n|D \u03c6 | \u2265\n\n\u03c6\u2208\u03a6\u2212\nk\n\n\u2265\n\n1 (\u03b5/2)|Fk |\n2\n|\n4C\n\n1 (\u03b5/2)|Fk | X\n2\n|E \u03c6 | =\n4C\n\u2212\n\u03c6\u2208\u03a6k\n\n[\n\nE\u03c6| \u2265\n\n\u03c6\u2208\u03a6+\nk\n\n1 (\u03b5/2)|Fk | [ \u03c6\n2\n|\nE |.\n8C\n\u03c6\u2208\u03a6k\n\nStep 3: We now let k vary between L and M . Write Ek = \u222a\u03c6\u2208\u03a6k E \u03c6 and Dk = \u222a\u03c6\u2208\u03a6k D \u03c6 . Note\nthat\nEk = {f \u2208 FN : f x \u2208 B and k(f ) = k}\no\nn\n(F,Y )\n(f x) < 2(h\u2212\u03b5/2)|Fk |\nDk = f \u2208 FN : f x \u2208 [\u03a6k ] and Tk\n\nso {Ek }L\u2264k\u2264M are pairwise disjoint, but {Dk }L\u2264k\u2264M need not be. We saw in step (2) that for each\n1 (\u03b5/2)|Fk |\n1\n|Ek | or (b) |Dk | \u2265 8C\n2\n|Ek |. Write\nL \u2264 k \u2264 M , either (a) |Ek \u2229 Dk | \u2265 8C\n\u001a\n\u001b\n1 (\u03b5/2)|Fk |\nJ = k : L \u2264 k \u2264 M and |Dk | \u2265\n2\n|Ek | .\n8C\nLet k \u2208 J. If |Ek | \u2265 16C * 2\u2212(\u03b5/2)|Fk | |FN | we would have\n\n1 (\u03b5/2)|Fk |\n2\n|Ek | \u2265 2|FN |.\n8C\nHowever, Dk \u2286 (\u222aL\u2264k\u2264M Wk ) |FN | and the latter set, if N is large enough, has size strictly less than\n2|FN |, so the inequality |Dk | \u2265 2|FN | is impossible. Thus for N large enough, if k \u2208 J it must be\nthat |Ek | \u2264 16C * 2\u2212(\u03b5/2)|Fk | |FN |, so\n|Dk | \u2265\n\nM\n1 [\n16C X \u2212(\u03b5/2)|Fk |\np\n1 X\n|\n|Ek | \u2264\n2\n\u2264\nEk | =\n|FN |\n|FN |\n|Fn |\n2C|FN |\nk\u2208J\n\nk\u2208J\n\nk=L\n\nfor L large enough. Therefore,\n[\n1 X\n1 [\n1\n|Ek \u2229 Dk | \u2265\n|\n|\nEk \u2229 Dk | =\nDk | \u2265\n|FN |\n|FN |\n|FN |\nL\u2264k\u2264M\n\nk \u2208J\n/\n\nk \u2208J\n/\n\n\fReturn times, recurrence densities and entropy\n\n47\n\nX\n[\n1\n1\n|Ek | =\n|\nEk | =\n8C|FN |\n8C|FN |\nk \u2208J\n/\nk \u2208J\n/\n[\n[\n1\n1\n=\n|\n|\nEk | \u2212\nEk | \u2265\n8C|FN |\n8C|FN |\n\u2265\n\nL\u2264k\u2264M\n\nby assumption,\n\nS\n\n1\n|FN |\n\nL\u2264k\u2264M\n\nk\u2208J\n\nEk \u2265 p, so\n\np\np\np\n\u2212\n=\n.\n8C\n16C\n16C\np\nBut this is impossible, since it implies that at least a 16C\n-fraction of f \u2208 FN are such that\n\u2265\n\n(F,Y )\n\n(f x) < 2(h\u2212\u03b5/2)|Fk | . Since L was arbitrarily large, this contradicts the fact that\ninf L\u2264k\u2264M Tk\n(F,Y )\n\u2265 h a.s.. This completes the proof.\n\u0003\nT\u2217\nIn order to prove the theorem for {Wn } a quasi-incompressible sequence (definition 1.13) we need\nan analogue of lemma 4.20. This lemma is used in the proof in step (1) to justify equations 4.3\nand 4.5. Recalling what occurred there, we had fixed k and \u03c6 \u2208 \u03a3Fk and considered a set E \u2286 FN\n(F,W )\nof points f such that Uk,n(f ) (f x) < 2\u2212(h\u2212\u03b5)|Fk | . Note that the right-hand side of this inequality\ndepends only on k. Furthermore, one of our assumptions was that |Wn(f ) | > 2(h\u2212\u03b5/2)|Fk | for f \u2208 E.\nIt is not hard to see that under these conditions a version of lemma 4.20 is valid, assuming that the\nWn\u22121 -boundary of Wn is small, in a manner depending on k, for all n such that |Wn | > 2(h\u2212\u03b5/2)|Fk | ,\nand this is just what quasi-incompressibility means. We omit the details.\n5. Open questions\nIn conclusion we would like mention several problems which remain unresolved.\nThe method of proof of the fact that T\u2217 \u2265 h made it necessary that in the definition of Rk we\nrequire that a repetition of the pattern x(Fk ) be \"counted\" only if it is disjoint from the original\npattern. This definition affects also the definition of Uk,n and the results about U\u2217 . In the case of\nG = Zd studied in [8] no such restriction was necessary.\nQuestion. If we define\n(F,W )\n\nRk\n\n(x) = inf{n : there exists 1G 6= f \u2208 Wn s.t f x \u2208 x(Fk )}\n\nand Tk = |WRk |, when is it true that\n\n1\n|Fk |\n\nlog Tk \u2265 h ?\n\nFor the upper bounds T \u2217 \u2264 h and U \u2217 \u2264 h to hold, we saw that it is necessary to require some\nspecial properties of the window sets, eg that they be (quasi) filling. We have seen that such\nsequences exist in many cases, but we have no information about the case of non-locally-finite\ntorsion groups:\n\n\f48\n\nMichael Hochman\n\nQuestion. Do all groups possess (quasi) filling/incompressible sequences? What classes of groups\nhave (quasi) filling/incompressible F\u00f8lner sequences?\nAnother issue is, under what conditions, milder than those given, does the bound U\u2217 \u2265 h hold?\nFor one thing, the dependence on an interpolation sequence would seem to be an artifact of the\nproof, and perhaps can be removed. It is also not impossible that the requirement that {Wn } be\nincompressible might be weakened to being filling, or perhaps even completely done away with; the\nfact that T\u2217 \u2265 h for very general window sequences, and that we have not yet found a counterexample\nof the type in section 2.7 for the lower bound U\u2217 \u2265 h, gives some hope that this might be true.\nQuestion. Can weaker conditions on the window sequence be found which ensure the bound U\u2217 \u2265 h?\nReferences\n[1] H. Bass. The degree of polynomial growth of finitely generated nilpotent groups. Proc. London Math. Soc. (3),\n25:603\u2013614, 1972.\n[2] Frederick P. Greenleaf. Invariant means on topological groups and their applications. Van Nostrand Reinhold Co.,\nNew York-Toronto, Ont.-London, 1969.\n[3] Mikhail Gromov. Groups of polynomial growth and expanding maps. Publ. Math. IH\u00c9S, 53:53\u201373, 1981.\n[4] P. Hall and C. R. Kulatilaka. A property of locally finite groups. J. London Math. Soc., 39:235\u2013239, 1964.\n[5] Elon Lindenstrauss. Pointwise theorems for amenable groups. Inventiones Mathematicae, 146:259\u2013295, June 2001.\n[6] Donald Ornstein and Benjamin Weiss. The Shannon-McMillan-Breiman theorem for a class of amenable groups.\nIsrael Journal of Mathematics, 44(1):53\u201361, 1983.\n[7] Donald Ornstein and Benjamin Weiss. Entropy and data compression schemes. IEEE Transactions on Information\nTheory, 39(1):78\u201383, January 1993.\n[8] Donald Ornstein and Benjamin Weiss. Entropy and recurrence rates for stationary random fields. IEEE Transactions on Information Theory, 48(6):1694\u20131697, June 2002.\n[9] Paul Shields. The ergodic theory of discrete sample paths, volume 13 of Graduate Studies in Mathematics, ISSN\n1065-7339. American Mathematical Society, 1996.\n[10] Benjamin Weiss. Monotileable amenable groups. Amer. Math. Soc. Transl, 202:257\u2013262, 2001.\n[11] Benjamin Weiss. Actions of amenable groups. In Topics in dynamics and ergodic theory, volume 310 of London\nmathematical society Lecture Notes Series. Cambridge university press, 2003.\n[12] A. Wyner and J. Ziv. Some asymptotic properties of the entropy of a stationary ergodic data source with\napplications to data compression. IEEE Transactions on Information Theory, 35:1250\u20131258, November 1989.\nE-mail address: mhochman@math.huji.ac.il\nCurrent address: Einstein Institute of Mathematics, Edmond J. Safra Campus, Givat Ram, The Hebrew University\nof Jerusalem Jerusalem, 91904, Israel\n\n\f"}