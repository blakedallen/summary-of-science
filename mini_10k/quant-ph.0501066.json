{"id": "http://arxiv.org/abs/quant-ph/0501066v3", "guidislink": true, "updated": "2005-09-30T14:49:22Z", "updated_parsed": [2005, 9, 30, 14, 49, 22, 4, 273, 0], "published": "2005-01-13T04:21:15Z", "published_parsed": [2005, 1, 13, 4, 21, 15, 3, 13, 0], "title": "The Symmetric Group Defies Strong Fourier Sampling: Part II", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=quant-ph%2F0501008%2Cquant-ph%2F0501049%2Cquant-ph%2F0501147%2Cquant-ph%2F0501159%2Cquant-ph%2F0501072%2Cquant-ph%2F0501173%2Cquant-ph%2F0501164%2Cquant-ph%2F0501137%2Cquant-ph%2F0501179%2Cquant-ph%2F0501036%2Cquant-ph%2F0501118%2Cquant-ph%2F0501050%2Cquant-ph%2F0501122%2Cquant-ph%2F0501043%2Cquant-ph%2F0501006%2Cquant-ph%2F0501111%2Cquant-ph%2F0501019%2Cquant-ph%2F0501069%2Cquant-ph%2F0501073%2Cquant-ph%2F0501150%2Cquant-ph%2F0501154%2Cquant-ph%2F0501059%2Cquant-ph%2F0501109%2Cquant-ph%2F0501079%2Cquant-ph%2F0501060%2Cquant-ph%2F0501025%2Cquant-ph%2F0501115%2Cquant-ph%2F0501108%2Cquant-ph%2F0501110%2Cquant-ph%2F0501064%2Cquant-ph%2F0501094%2Cquant-ph%2F0501020%2Cquant-ph%2F0501101%2Cquant-ph%2F0501055%2Cquant-ph%2F0501007%2Cquant-ph%2F0501184%2Cquant-ph%2F0501010%2Cquant-ph%2F0501057%2Cquant-ph%2F0501176%2Cquant-ph%2F0501177%2Cquant-ph%2F0501180%2Cquant-ph%2F0501182%2Cquant-ph%2F0501117%2Cquant-ph%2F0501116%2Cquant-ph%2F0501062%2Cquant-ph%2F0501166%2Cquant-ph%2F0501042%2Cquant-ph%2F0501146%2Cquant-ph%2F0501132%2Cquant-ph%2F0501022%2Cquant-ph%2F0501035%2Cquant-ph%2F0501143%2Cquant-ph%2F0501037%2Cquant-ph%2F0501039%2Cquant-ph%2F0501103%2Cquant-ph%2F0501149%2Cquant-ph%2F0501054%2Cquant-ph%2F0501009%2Cquant-ph%2F0501144%2Cquant-ph%2F0501134%2Cquant-ph%2F0501095%2Cquant-ph%2F0501160%2Cquant-ph%2F0501003%2Cquant-ph%2F0501104%2Cquant-ph%2F0501024%2Cquant-ph%2F0501105%2Cquant-ph%2F0501077%2Cquant-ph%2F0501048%2Cquant-ph%2F0501034%2Cquant-ph%2F0501075%2Cquant-ph%2F0501041%2Cquant-ph%2F0501119%2Cquant-ph%2F0501121%2Cquant-ph%2F0501083%2Cquant-ph%2F0501145%2Cquant-ph%2F0501135%2Cquant-ph%2F0501012%2Cquant-ph%2F0501169%2Cquant-ph%2F0501171%2Cquant-ph%2F0501170%2Cquant-ph%2F0501127%2Cquant-ph%2F0501161%2Cquant-ph%2F0501098%2Cquant-ph%2F0501172%2Cquant-ph%2F0501136%2Cquant-ph%2F0501107%2Cquant-ph%2F0501029%2Cquant-ph%2F0501066%2Cquant-ph%2F0501011%2Cquant-ph%2F0501033%2Cquant-ph%2F0501068%2Cquant-ph%2F0501148%2Cquant-ph%2F0501088%2Cquant-ph%2F0501001%2Cquant-ph%2F0501016%2Cquant-ph%2F0501125%2Cquant-ph%2F0501178%2Cquant-ph%2F0501162%2Cquant-ph%2F0501061%2Cquant-ph%2F0501097%2Cquant-ph%2F0501130&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Symmetric Group Defies Strong Fourier Sampling: Part II"}, "summary": "Part I of this paper showed that the hidden subgroup problem over the\nsymmetric group--including the special case relevant to Graph\nIsomorphism--cannot be efficiently solved by strong Fourier sampling, even if\none may perform an arbitrary POVM on the coset state. In this paper, we extend\nthese results to entangled measurements. Specifically, we show that the hidden\nsubgroup problem on the symmetric group cannot be solved by any POVM applied to\npairs of coset states. In particular, these hidden subgroups cannot be\ndetermined by any polynomial number of one- or two-register experiments on\ncoset states.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=quant-ph%2F0501008%2Cquant-ph%2F0501049%2Cquant-ph%2F0501147%2Cquant-ph%2F0501159%2Cquant-ph%2F0501072%2Cquant-ph%2F0501173%2Cquant-ph%2F0501164%2Cquant-ph%2F0501137%2Cquant-ph%2F0501179%2Cquant-ph%2F0501036%2Cquant-ph%2F0501118%2Cquant-ph%2F0501050%2Cquant-ph%2F0501122%2Cquant-ph%2F0501043%2Cquant-ph%2F0501006%2Cquant-ph%2F0501111%2Cquant-ph%2F0501019%2Cquant-ph%2F0501069%2Cquant-ph%2F0501073%2Cquant-ph%2F0501150%2Cquant-ph%2F0501154%2Cquant-ph%2F0501059%2Cquant-ph%2F0501109%2Cquant-ph%2F0501079%2Cquant-ph%2F0501060%2Cquant-ph%2F0501025%2Cquant-ph%2F0501115%2Cquant-ph%2F0501108%2Cquant-ph%2F0501110%2Cquant-ph%2F0501064%2Cquant-ph%2F0501094%2Cquant-ph%2F0501020%2Cquant-ph%2F0501101%2Cquant-ph%2F0501055%2Cquant-ph%2F0501007%2Cquant-ph%2F0501184%2Cquant-ph%2F0501010%2Cquant-ph%2F0501057%2Cquant-ph%2F0501176%2Cquant-ph%2F0501177%2Cquant-ph%2F0501180%2Cquant-ph%2F0501182%2Cquant-ph%2F0501117%2Cquant-ph%2F0501116%2Cquant-ph%2F0501062%2Cquant-ph%2F0501166%2Cquant-ph%2F0501042%2Cquant-ph%2F0501146%2Cquant-ph%2F0501132%2Cquant-ph%2F0501022%2Cquant-ph%2F0501035%2Cquant-ph%2F0501143%2Cquant-ph%2F0501037%2Cquant-ph%2F0501039%2Cquant-ph%2F0501103%2Cquant-ph%2F0501149%2Cquant-ph%2F0501054%2Cquant-ph%2F0501009%2Cquant-ph%2F0501144%2Cquant-ph%2F0501134%2Cquant-ph%2F0501095%2Cquant-ph%2F0501160%2Cquant-ph%2F0501003%2Cquant-ph%2F0501104%2Cquant-ph%2F0501024%2Cquant-ph%2F0501105%2Cquant-ph%2F0501077%2Cquant-ph%2F0501048%2Cquant-ph%2F0501034%2Cquant-ph%2F0501075%2Cquant-ph%2F0501041%2Cquant-ph%2F0501119%2Cquant-ph%2F0501121%2Cquant-ph%2F0501083%2Cquant-ph%2F0501145%2Cquant-ph%2F0501135%2Cquant-ph%2F0501012%2Cquant-ph%2F0501169%2Cquant-ph%2F0501171%2Cquant-ph%2F0501170%2Cquant-ph%2F0501127%2Cquant-ph%2F0501161%2Cquant-ph%2F0501098%2Cquant-ph%2F0501172%2Cquant-ph%2F0501136%2Cquant-ph%2F0501107%2Cquant-ph%2F0501029%2Cquant-ph%2F0501066%2Cquant-ph%2F0501011%2Cquant-ph%2F0501033%2Cquant-ph%2F0501068%2Cquant-ph%2F0501148%2Cquant-ph%2F0501088%2Cquant-ph%2F0501001%2Cquant-ph%2F0501016%2Cquant-ph%2F0501125%2Cquant-ph%2F0501178%2Cquant-ph%2F0501162%2Cquant-ph%2F0501061%2Cquant-ph%2F0501097%2Cquant-ph%2F0501130&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Part I of this paper showed that the hidden subgroup problem over the\nsymmetric group--including the special case relevant to Graph\nIsomorphism--cannot be efficiently solved by strong Fourier sampling, even if\none may perform an arbitrary POVM on the coset state. In this paper, we extend\nthese results to entangled measurements. Specifically, we show that the hidden\nsubgroup problem on the symmetric group cannot be solved by any POVM applied to\npairs of coset states. In particular, these hidden subgroups cannot be\ndetermined by any polynomial number of one- or two-register experiments on\ncoset states."}, "authors": ["Cristopher Moore", "Alexander Russell"], "author_detail": {"name": "Alexander Russell"}, "author": "Alexander Russell", "arxiv_comment": "18 pages; v2: fix typos, v3: adds technical lemma and revises Lemma\n  19", "links": [{"href": "http://arxiv.org/abs/quant-ph/0501066v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/quant-ph/0501066v3", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.CC", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/quant-ph/0501066v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/quant-ph/0501066v3", "journal_reference": null, "doi": null, "fulltext": "The Symmetric Group Defies Strong Fourier Sampling: Part II\n\narXiv:quant-ph/0501066v3 30 Sep 2005\n\nCristopher Moore\nmoore@cs.unm.edu\nDepartment of Computer Science\nUniversity of New Mexico\n\nAlexander Russell\nacr@cse.uconn.edu\nDepartment of Computer Science and Engineering\nUniversity of Connecticut\nFebruary 1, 2008\nAbstract\n\nPart I of this paper showed that the hidden subgroup problem over the symmetric group-including\nthe special case relevant to Graph Isomorphism-cannot be efficiently solved by strong Fourier sampling,\neven if one may perform an arbitrary POVM on the coset state. In this paper, we extend these results\nto entangled measurements. Specifically, we show that the case of the hidden subgroup problem which\nis relevant to Graph Isomorphism cannot be solved by any polynomial number of experiments on oneor two-register coset states.\n\n1\n\nIntroduction: the hidden subgroup problem\n\nMany problems of interest in quantum computing can be reduced to an instance of the Hidden Subgroup\nProblem (HSP). This is the problem of determining a subgoup H of a group G given oracle access to a\nfunction f : G \u2192 S with the property that\nf (g) = f (hg) \u21d4 h \u2208 H .\nEquivalently, f is constant on the cosets of H and takes distinct values on distinct cosets.\nAll known efficient solutions to the problem rely on the standard method or the method of Fourier\nsampling [3], described below.\nStep 1. Prepare two registers, the first in a uniform superposition over the elements of G and the second\nwith the value zero, yielding the state\n1 X\n|gi \u2297 |0i .\n\u03c81 = p\n|G| g\u2208G\n\nStep 2. Query (or calculate) the function f defined on G and XOR it with the second register. This\nentangles the two registers and results in the state\n1 X\n\u03c82 = p\n|gi \u2297 |f (g)i .\n|G| g\u2208G\n\nStep 3. Measure the second register. This puts the first register in a uniform superposition over one of f 's\nlevel sets, i.e., one of the cosets of H, and disentangles it from the second register. If we observe the\nvalue f (c), we have the state \u03c83 \u2297 |f (c)i where\nX\n1\n\u03c83 = |cHi = p\n|chi .\n|H| h\u2208H\n1\n\n\fStep 4. Carry out the quantum Fourier transform on \u03c83 and measure the result.\nThe result of Step 3 above is the coset state |cHi, where c is chosen uniformly from G. Expressing this\nas a mixed state, let\n1 X\n\u03c1H =\n|cHi hcH| .\n|G|\nc\u2208G\n\nWe shall focus on the hidden conjugate problem, where the hidden subgroup is a random conjugate H g =\ng \u22121 Hg of a known (non-normal) subgroup H. It was shown in the first part of this paper that when G = S2n ,\nthe symmetric group on 2n letters, and H is a the subgroup generated by the involution (1 2) . . . (2n \u2212 1 2n),\nthe outcome of any measurement on \u03c1H is nearly independent of the random choice of g \u2208 Sn . In particular,\nno polynomial number of coset state experiments can determine such a hidden subgroup with non-negligible\nprobability.\nIt is known, however, that a measurement exists to determine hidden subgroups of a group G from\nk = poly log |G| independent copies of \u03c1H . In light of the discussion above, this measurement cannot, in\ngeneral, be a product measurement: it must involve entangled measurement operators. In this paper, we\nextend the framework of part I to such entangled measurements, showing that for the subgroup H of S2n\ndescribed above, the result of any measurement of the two-coset state \u03c1H g \u2297 \u03c1H g is nearly independent\nof g. In particular, no polynomial number of two-register coset-state experiments can determine H with\nnon-negligible probability.\nRelated work. Both Simon's and Shor's seminal algorithms rely on the standard method over an Abelian\ngroup. In Simon's problem [29], G = Zn2 and f is an oracle such that, for some y, f (x) = f (x + y) for all\nx; in this case H = {0, y} and we wish to identify y. In Shor's factoring algorithm [28] G is the group Z\u2217n\nwhere n is the number we wish to factor, f (x) = rx mod n for a random r < n, and H is the subgroup of\nZ\u2217n whose index is the multiplicative order of r. (Note that in Shor's algorithm, since |Z\u2217n | is unknown, the\nFourier transform is performed over Zq for some q = poly(n); see [28] or [10, 11].)\nFor such abelian instances; it is not hard to see that a polynomial number (i.e., polynomial in log |G|)\nof experiments of this type determine H. In essence, each experiment yields a random element of the dual\nspace H \u22a5 perpendicular to H's characteristic function, and as soon as these elements span H \u22a5 they, in\nparticular, determine H.\nWhile the nonabelian hidden subgroup problem appears to be much more difficult, it has very attractive\napplications. In particular, solving the HSP for the symmetric group Sn would provide an efficient quantum\nalgorithm for the Graph Automorphism and Graph Isomorphism problems (see e.g. Jozsa [17] for a review).\nAnother important motivation is the relationship between the HSP over the dihedral group with hidden shift\nproblems [4] and cryptographically important cases of the Shortest Lattice Vector problem [23].\nSo far, algorithms for the HSP are only known for a few families of nonabelian groups, including wreath\nproducts Zk2 \u2240 Z2 [24]; more generally, semidirect products K \u22c9 Zk2 where K is of polynomial size, and\ngroups whose commutator subgroup is of polynomial size [16]; \"smoothly solvable\" groups [7]; and some\nsemidirect products of cyclic groups [14]. Ettinger and H\u00f8yer [5] provided another type of result, by showing\nthat Fourier sampling can solve the HSP for the dihedral groups Dn in an information-theoretic sense. That\nis, a polynomial number of experiments gives enough information to reconstruct the subgroup, though it is\nunfortunately unknown how to determine H from this information in polynomial time.\nTo discuss Fourier sampling for a nonabelian group G, one needs to develop the Fourier transform over\nG. For abelian groups, the Fourier basis functions are homomorphisms \u03c6 : G \u2192 C such as the familiar\nexponential function \u03c6k (x) = e2\u03c0ikx/n for the cyclic group Zn . In the nonabelian case, there are not enough\nsuch homomorphisms to span the space of all C-valued functions on G; to complete the picture, one introduces\nrepresentations of the group, namely homomorphisms \u03c1 : G \u2192 U(V ) where U(V ) is the group of unitary\nmatrices acting on some C-vector space V of dimension d\u03c1 . It suffices to consider irreducible representations,\nnamely those for which no nontrivial subspace of V is fixed by the various operators \u03c1(g). Once a basis for\neach irreducible \u03c1 is chosen, the matrix elements \u03c1ij provide an orthogonal basis for the vector space of all\nC-valued functions on G.\n2\n\n\fPThe quantum Fourier transform then consists of transforming (unit-length) vectors in C[G] =\n{ g\u2208G \u03b1g |gi | \u03b1g \u2208 C} from the basis {|gi | g \u2208 G} to the basis {|\u03c1, i, ji} where \u03c1 is the name of an\nirreducible representation and 1 \u2264 i, j \u2264 d\u03c1 index a row and column (in a chosen basis for V ). Indeed,\nthis transformation can be carried out efficiently for a wide variety of groups [2, 13, 21]. Note, however,\nthat a nonabelian group G does not distinguish any specific basis for its irreducible representations which\nnecessitates a rather dramatic choice on the part of the transform designer. Indeed, careful basis selection\nappears to be critical for obtaining efficient Fourier transforms for the groups mentioned above.\nPerhaps the most fundamental question concerning the hidden subgroup problem is whether there is\nalways a basis for the representations of G such that measuring in this basis (in Step 4, above) provides\nenough information to determine the subgroup H. This framework is known as strong Fourier sampling.\nPart I of this article answers this question in the negative, showing that natural subgroups of Sn cannot\nbe determined by this process; in fact, it shows this for an even more general model, where we perform\nan arbitrary positive operator-valued measurement (POVM) on coset states |cHi. We emphasize that this\nresult includes the most important special cases of the nonabelian HSP, as they are those to which Graph\nIsomorphism naturally reduces. Namely, as in [12] we focus on order-2 subgroups of the form {1, m}, where\nm is an involution consisting of n/2 disjoint transpositions; then if we fix two rigid connected graphs of size\nn/2 and consider permutations of their disjoint union, then the hidden subgroup is of this form if the graphs\nare isomorphic and trivial if they are not.\nThe next logical step is to consider multi-register algorithms, in which we prepare multiple coset states\nand subject them to entangled measurements. Ettinger, H\u00f8yer and Knill [6] showed that the HSP on arbitrary groups can be solved information-theoretically with a polynomial number of registers, although their\nalgorithm\ntakes exponential time for most groups of interest. Kuperberg [20] devised a subexponential\n\u221a\n(2O( log n) ) algorithm for the HSP on the dihedral group Dn that works by performing entangled measurements on two registers at a time, and Bacon, Childs, and van Dam [1] have determined the optimal\nmultiregister measurement for the dihedral group.\nWhether a similar approach can be taken for the symmetric group is a major open question. In this\npaper, we take a step towards answering this question by showing that if we perform arbitrary entangled\nmeasurements over pairs of registers, distinguishing\nH = {1, m} from the trivial group in Sn requires a\n\u221a\nsuperpolynomial number (specifically, e\u03a9( n/ log n) ) of experiments.\n\n2\n\nTwo combinatorial representations\n\nWith apologies to the reader, we will rely on the introductory sections of Part I rather than repeating them\nhere. However, here we introduce two combinatorial representations that will be extremely useful to us.\nb denote a collection of unitary representations of G consisting of exactly one from\nFor a group G, we let G\neach isomorphism class. We let C[G] denote the group algebra of G; this is the |G|-dimensional vector space\nof formal sums\nnX\no\n\u03b1g * g | \u03b1g \u2208 C\ng\n\nequipped with the unique inner product for which hg, hi is equal to one when g = h and zero otherwise. (Note\nthat C[G] is precisely the Hilbert space of a single register containing a superposition of group elements.)\nWe introduce two combinatorial representations related to the group algebra. The first is the regular\nrepresentation R, given by the permutation action of G on itself. Then R is the representation R : G \u2192\nU(C[G]) given by linearly extending left multiplication, R(g) : h 7\u2192 gh. It is not hard to see that its character\n\u03c7R is given by\n(\n|G| g = 1 ,\n\u03c7R (g) =\n0\ng 6= 1 ,\nb Thus R contains d\u03c1 copies of each irreducible \u03c1 \u2208 G,\nb\nin which case we have h\u03c7R , \u03c7\u03c1 iG = d\u03c3 for each \u03c1 \u2208 G.\nP\n2\nand counting dimensions on each side of this decomposition implies |G| = \u03c1\u2208Gb d\u03c1 .\n3\n\n\fThe other combinatorial representation we will rely on is the conjugation representation C, given by the\nconjugation action of G on C[G]. Specifically, C : G \u2192 U(C[G]) is the map obtained by linearly extending\nthe rule C(g) : h 7\u2192 ghg \u22121 . While the decomposition of C into irreducibles is, in general, unknown, one does\nhave the decomposition\nM\nX\nC=\n\u03c1 \u2297 \u03c1\u2217 and therefore \u03c7C (g) =\n\u03c7\u03c1 (g)\u03c7\u03c1 (g)\u2217 .\n(2.1)\nb\n\u03c1\u2208G\n\nb\n\u03c1\u2208G\n\nHere \u03c1\u2217 denotes the complex conjugate representation of \u03c1, which acts on vectors u\u2217 as \u03c1\u2217 (g)u = (\u03c1(g)u)\u2217 .\nWe also note that an elementary argument shows that\n\u03c7C (g) =\n\n|G|\n,\n|[g]|\n\nwhere [g] = {h\u22121 gh | h \u2208 G} denotes the conjugacy class of g.\n\n3\n3.1\n\nBackground from Part I\nThe structure of the optimal measurement\n\nAs in Part I, we focus on the special case of the hidden subgroup problem called the hidden conjugate problem\nin [22]. Here there is a (non-normal) subgroup H, and we are promised that the hidden subgroup is one of\nits conjugates, H g = g \u22121 Hg for some g \u2208 G; the goal is to determine which.\nThe most general possible measurement in quantum mechanics is a positive operator-valued measurement\n(POVM). Part I of this paper establishes that the optimal POVM for the Hidden Subgroup Problem on a\nsingle coset state consists of measuring the name \u03c1 of the irreducible representation, followed by a POVM\non the vector space V on which \u03c1 acts. In the special case of a von Neumann measurement, this corresponds\nto measuring the row of \u03c1 in some orthonormal basis; in general it consists of measuring according to some\nover-complete basis, or frame, B = {b} with positive real weights ab that obeys the completeness condition\nX\n(3.1)\nab \u03c0b = 1 ,\nb\n\nwhere \u03c0b denotes the projection onto the unit length vector b. We remark that the frame B weighted\naccording to a is energy-conserving in the sense that\nX\nX\na(b)\u03c0b (x)i =\nab k\u03c0b (x)k2 .\nkxk2 = hx, 1xi = hx,\nb\n\nb\n\nDuring Fourier sampling, the probability we observe \u03c1, and the conditional probability that we observe\na given b \u2208 B, are given by\nP (\u03c1) =\nP (\u03c1, b) =\n\nwhere \u03a0H is the projection operator 1/|H|\nand P (\u03c1, bj ) is given by\n\nP\n\nh\u2208H\n\nd\u03c1 |H|\nrk \u03a0H\n|G|\n\n(3.2)\n\naj\n\n(3.3)\n\nk\u03a0H bk\nrk \u03a0H\n\n2\n\n\u03c1(h). In the case where H is the trivial subgroup, \u03a0H = 1d\u03c1\n\nP (\u03c1, b) =\n\nab\n.\nd\u03c1\n\n(3.4)\n\nWe call this the natural distribution on the frame B = {b}. In the case that B is an orthonormal basis,\nab = 1 and this is simply the uniform distribution. This probability distribution over B changes for a\nconjugate H g in the following way:\n2\nk\u03a0H gbk\nP (\u03c1, b) = aj\nrk \u03a0H\n4\n\n\f2\n\nwhere we write gb for \u03c1(g)b. It is not hard to show that, for any b \u2208 V , the expected value of k\u03a0H (gb)k ,\nover the choice of g \u2208 G, is rk \u03a0H /d\u03c1 .\n\n3.2\n\nThe expectation and variance of an involution projector\n\nThe following lemmas are proved in Part I; we repeat them here for convenience.\nLemma 1. Let \u03c1 be a representation of a group G acting on a space V and let b \u2208 V . Let m be an element\nchosen uniformly from a conjugacy class I of involutions. If \u03c1 is irreducible, then\nExpm hb, mbi =\nIf \u03c1 is reducible, then\nExpm hb, mbi =\n\n\u03c7\u03c1 (I)\n2\nkbk .\ndim \u03c1\n\nX \u03c7\u03c3 (I)\n2\nk\u03a0\u03c1\u03c3 bk .\ndim\n\u03c3\n\u03c3\u227a\u03c1\n\nLemma 2. Let \u03c1 be a representation of a group G acting on a space V and let b \u2208 V . Let m be an element\nchosen uniformly at random from a conjugacy class I of involutions. Then\nX \u03c7\u03c3 (I)\n2\n\u2217\n2\nExpm |hb, mbi| =\n\u03a0\u03c1\u2297\u03c1\n(b \u2297 b\u2217 )\n.\n\u03c3\ndim \u03c3\n\u03c3\u227a\u03c1\u2297\u03c1\u2217\nGiven an involution m and the hidden subgroup H = {1, m}, let \u03a0m = \u03a0H denote the projection operator\ngiven by\nv + mv\n.\n\u03a0m v =\n2\n2\nThen the expectation and variance of k\u03a0m bk are given by the following lemma.\nLemma 3. Let \u03c1 be an irreducible representation acting on a space V and let b \u2208 V . Let m be an element\nchosen uniformly at random from a conjugacy class I of involutions. Then\n\u0013\n\u0012\n1\n\u03c7\u03c1 (I)\n2\n2\nExpm k\u03a0m bk =\nkbk 1 +\n(3.5)\n2\ndim \u03c1\n2\n\u2217\n1 X \u03c7\u03c3 (I)\n2\nVarm k\u03a0m bk \u2264\n\u03a0\u03c1\u2297\u03c1\n(b \u2297 b\u2217 )\n.\n(3.6)\n\u03c3\n4 \u03c3\u227a\u03c1\u2297\u03c1\u2217 dim \u03c3\nFinally, we point out that since\n2\n\nExpm k\u03a0m bk = kbk\nwe have\n\n3.3\n\nrk \u03a0m\n1\n=\ndim \u03c1\n2\n\n2\n\nrk \u03a0m\ndim \u03c1\n\n\u0012\n\u0013\n\u03c7\u03c1 (I)\n1+\n.\ndim \u03c1\n\n(3.7)\n\nThe representation theory of the symmetric group\n\nWe will use several specific properties of the symmetric group Sn and its asymptotic representation theory;\nwe refer the reader to Section 5 of Part I for more background and notation. Recall that the irreducible\nrepresentations S \u03bb of Sn are labeled by Young diagrams \u03bb, and that the number of irreducible representations\nis the partition number p(n), which obeys\n\u221a\np\n(3.8)\np(n) < e\u03b4 n where \u03b4 = \u03c0 2/3 .\nWe denote the dimension and character of S \u03bb as d\u03bb and \u03c7\u03bb respectively. Recall also that the Plancherel\ndistribution assigns the probability d2\u03c1 /|G| to each irreducible representation \u03c1. Then we will rely on the\nfollowing results of Vershik and Kerov.\n5\n\n\fcn according to the Plancherel distribution. Then there exist\nTheorem 4 ([30]). Let S \u03bb be chosen from S\npositive constants c1 and c2 for which\nh\n\u221a \u221a\n\u221a \u221a i\nlim Pr e\u2212c1 n n! \u2264 d\u03bb \u2264 e\u2212c2 n n! = 1 .\nn\u2192\u221e\n\nTheorem 5 ([30]). There exist positive constants \u010d and \u0109 such that for all n \u2265 1,\n\u221a \u221a\n\u221a \u221a\ne\u2212\u010d n n! \u2264 max d\u03bb \u2264 e\u2212\u0109 n n! .\ncn\nS \u03bb \u2208S\n\nIn Part I we prove the following:\n\ncn .\nLemma 6. Let S \u03bb be chosen according to the Plancherel distribution on S\nh\n\u221a \u221a i\n\u221a\np\n1. Let \u03b4 = \u03c0 2/3 as in (3.8). Then for sufficiently large n, Pr d\u03bb \u2264 e\u2212\u03b4 n n! < e\u2212\u03b4 n .\n2. Let 0 < c < 1/2. Then Pr[d\u03bb \u2264 ncn ] = n\u2212\u03a9(n) .\n\nFinally, we will also apply Roichman's [25] estimates for the characters of the symmetric group:\nDefinition 1. For a permutation \u03c0 \u2208 Sn , define the support of \u03c0, denoted supp(\u03c0), to be the cardinality of\nthe set {k \u2208 [n] | \u03c0(k) 6= k}.\nTheorem 7 ([25]). There exist constants b > 0 and 0 < q < 1 so that for n > 4, for every conjugacy class\nC of Sn , and every irreducible representation S \u03bb of Sn ,\n\u03c7\u03bb (C)\n\u2264\nd\u03bb\n\n\u0012\n\u0010 \u03bb \u03bb\u2032 \u0011\u0013b*supp(C)\n1\nmax q, , 1\n,\nn n\n\nwhere supp(C) = supp(\u03c0) for any \u03c0 \u2208 C.\nIn our application, we take n to be even and consider involutions m in the conjugacy class of elements\nconsisting of n/2 disjoint transpositions, M = Mn = {\u03c3 ((12)(34) * * * (n \u2212 1 n)) \u03c3 \u22121 | \u03c3 \u2208 Sn }. Note that\neach m \u2208 Mn is associated with one of the (n \u2212 1)!! perfect matchings of n things, and that supp(m) = n.\n\n3.4\n\nStrong Fourier sampling on one register\n\nThe main result of Part I is the following.\nTheorem 8. Let B = {b} be a frame with weights {ab } satisfying the completeness condition (3.1) for\nan irreducible representation S \u03bb . Given the hidden subgroup H = {1, m} where m is chosen uniformly at\nrandom from M , let Pm (b) be the probability that we observe the vector b conditioned on having observed\nthe representation name S \u03bb , and let N be the natural distribution (3.4) on B. Then there is a constant \u03b4 > 0\nsuch that for sufficiently large n, with probability at least 1 \u2212 e\u2212\u03b4n in m and \u03bb, we have\nkPm \u2212 N k1 < e\u2212\u03b4n .\n2\n\nThe proof strategy is to bound Varm k\u03a0m bk using Lemma 3, and apply Chebyshev's inequality to\nconclude that it is almost certainly close to its expectation. Recall, however, that our bounds on the variance\n2\nof k\u03a0m bk depend on the decomposition of S \u03bb \u2297(S \u03bb )\u2217 is into irreducibles and, furthermore, on the projection\n\u2217\nof b \u2297 b into these irreducible subspaces. Matters are somewhat complicated by the fact that certain S \u03bc\nappearing in S \u03bb \u2297 (S \u03bb )\u2217 may contribute more to the variance than others. While Theorem 7 allows us to\nbound the contribution of those constituent irreducible representations S \u03bc for which \u03bc1 and \u03bc\u20321 are much\nsmaller than n, those which violate this condition could conceivably contribute large terms to the variance\nestimates. Fortunately, in this single coset case, the total fraction of the space S \u03bb \u2297 (S \u03bb )\u2217 , dimensionwise,\n6\n\n\fconsisting of such S \u03bc is small with overwhelming probability. Despite this, we cannot preclude the possibility\n2\nthat for a specific vector b, the quantity Var k\u03a0m bk is large, as b may project solely into spaces of the type\ndescribed above. On the other hand, as these troublesome spaces amount to a small fraction of S \u03bb \u2297 (S \u03bb )\u2217 ,\nonly a few b can have this property.\nSpecifically, let 0 < c < 1/4 be a constant, and let \u039b = \u039bc denote the collection of Young diagrams \u03bc\nwith the property that either \u03bc1 \u2265 (1 \u2212 c)n or \u03bc\u20321 \u2265 (1 \u2212 c)n. Then Part I establishes the following upper\nbounds on the cardinality of \u039b and the dimension of any S \u03bc with \u03bc \u2208 \u039b:\n\nLemma 9. Let p(n) denote the number of integer partitions of n. Then |\u039b| \u2264 2cnp(cn), and d\u03bc < ncn for\nany \u03bc \u2208 \u039b.\n\ncn ;\nAs a result, the representations associated with diagrams in \u039b constitute a negligible fraction of S\nspecifically, from Lemma 6, part 2, the probability that a \u03bb drawn according to the Plancherel distribution\nfalls into \u039b is n\u2212\u03a9(n) . The following lemma shows that this is also true for the distribution P (\u03c1) induced on\ncn by weak Fourier sampling the coset state |Hi.\nS\nLemma 10. Let d < 1/2 be a constant and let n be sufficiently large. Then there is a constant \u03b3 > 0 such\nthat we observe a representation S \u03bb with d\u03bb \u2265 ndn with probability at least 1 \u2212 n\u2212\u03b3n .\nOn the other hand, for a representation S \u03bc with \u03bc \u2208\n/ \u039b, Theorem 7 implies that\n\u0001bn\n\u03c7\u03bc (M )\n\u2264 max(q, 1 \u2212 c)\n\u2264 e\u2212\u03b1n\n\u03bc\nd\n\n(3.9)\n\nfor a constant \u03b1 \u2265 bc > 0. Thus the contribution of such an irreducible to the variance estimate of Lemma 3\nis exponentially small. The remainder of the proof of Theorem 8 uses a combination of Chebyshev's and\nMarkov's inequalities to bound the total variation distance between Pm and the natural distribution.\n\n4\n\nVariance and decomposition for multiregister experiments\n\nWe turn now to the multi-register case, where Steps 1, 2 and 3 are carried out on k independent registers.\nThis yields a state in C[Gk ], i.e.,\n|c1 Hi \u2297 * * * \u2297 |ck Hi\n\nwhere the ci are uniformly random coset representatives. The symmetry argument of Section 3 of Part I\napplies to each register, so that the optimal measurement is consistent with first measuring the representation\nname in each register. However, the optimal measurement generally does not consist of k independent\nmeasurements on this tensor product state; rather, it is entangled, consisting of measurement in a basis\nwhose basis vectors b are not of the form b1 \u2297 * * * \u2297 bk . As mentioned above, for the dihedral groups\nin particular, a fair amount is known: Ip [15] showed that the optimal measurement for two registers is\nentangled, Kuperberg [20] showed that an entangled measurement yields a subexponential-time algorithm for\nthe hidden subgroup problem, and Bacon, Childs and van Dam [1] have calculated the optimal measurement\non k registers.\nExtending the results of part I to this case involving multiple coset states will proceed in three steps:\n\u2022 In Section 4.1, we generalize the expectation and variance bounds of Lemma 3 to the algebra C[Gk ],\nviewed as a representation of G.\n\u2022 As in the single register proof, we must control the decomposition of the representations that appear\nin the expressions for expectation and variance. Unfortunately, the naive bounds applied in part I\n(relying on the fact that h\u03c7\u03c3 , \u03c7\u03c1 \u03c7\u03c4 iG \u2264 d\u03c3 for irreducible representations \u03c1, \u03c3, and \u03c4 ) are insufficient\nfor controlling these decompositions. In Section 4.2, we show how to bound the decomposition of these\nrepresentations on average.\n\u2022 Finally, in Section 5, we show how to apply these results to eliminate the possibility of solving the HSP\nover Sn with any polynomial number of two-register experiments on coset states.\n7\n\n\f4.1\n\nVariance for Fourier sampling product states\n\nWe begin by generalizing Lemmas 1, 2, and 3 of Part I to the multi-register case. The reasoning is analogous\nto that of Section 4 of Part I; the principal difficulty is notational, and we ask the reader to bear with us.\nWe assume we have measured the representation name on each of the registers, and that we are currently\nin an irreducible representation of Gk labeled by \u03c11 \u2297 * * *\u2297 \u03c1k . Given a subset I \u2286 {1, . . . , k}, we can separate\nthis tensor product into the registers inside I and those outside, and then decompose the product of those\ninside I into irreducibles \u03c3:\nO\nO\n\u03c1i\n\u03c11 \u2297 * * * \u2297 \u03c1k =\n\u03c1i \u2297\ni\u2208I\n\nM\n\n=\n\ni\u2208I\n/\n\naI\u03c3 \u03c3\n\n\u03c3\u227a\u2297i\u2208I \u03c1i\n\n!\n\n\u2297\n\nO\n\n\u03c1i\n\ni\u2208I\n/\n\nwhere aI\u03c3 is the multiplicity of \u03c3 in \u2297i\u2208I \u03c1i . Now given an irrep \u03c3, let \u03a0I\u03c3 denote the projection operator\nonto the subspace acted on by\nO\n\u03c1i .\naI\u03c3 \u03c3 \u2297\ni\u2208I\n/\n\n\u03a0I\u03c3\n\nIn other words,\nprojects the registers in I onto the subspaces isomorphic to \u03c3, and leaves the registers\n{i}\noutside I untouched. Note that in the case where I is a singleton we have \u03a0\u03c1i = 1.\nAs before, the hidden subgroup is H = {1, m} for an involution m chosen at random from a conjugacy\nclass M . However, we now have, in effect, the subgroup H k \u2282 Gk , and summing over the elements of H k\ngives the projection operator \u03a0H k = \u03a0\u2297k\nm . The probability we observe an (arbitrarily entangled) basis vector\nb \u2208 \u03c11 \u2297 * * * \u2297 \u03c1k is then\n2\n\u03a0\u2297k\nm b\n.\n(4.1)\nPm (b) =\nrk \u03a0\u2297k\nm\nWhen we calculate the expectation of this over m, we will find ourselves summing the following quantity\nover the subsets I \u2286 {1, . . . , k}:\nX \u03c7\u03c3 (M )\n2\nE I (b) =\n\u03a0I\u03c3 b\n(4.2)\ndim\n\u03c3\n\u03c3\u227a\u2297\n\u03c1\ni\u2208I\n\n\u2205\n\ni\n\n2\n\nwith E (b) = kbk (since an empty tensor product gives the trivial representation).\nFor the variance, we will find ourselves dealing with pairs of subsets I1 , I2 \u2286 {1, . . . , k} and decompositions\nof the form\n\uf8f6\n! \uf8eb\nO\nO\nO\nO\n(\u03c11 \u2297 * * * \u2297 \u03c1k ) \u2297 (\u03c1\u22171 \u2297 * * * \u2297 \u03c1\u2217k ) =\n\u03c1i \u2297\n\u03c1\u2217i \u2297 \uf8ed\n\u03c1\u2217i \uf8f8\n\u03c1i \u2297\ni\u2208I1\n\n\uf8eb\n\n= \uf8ed\n\n\u03c3\u227a\n\ni\u2208I2\n\nN\n\ni\u2208I\n\nM\n\u03c1i \u2297\n\nN\n\ni\u2208I\n/ 1\n\ni\u2208I2\n\n\u03c1\u2217\ni\n\n\uf8f6\n\ni\u2208I\n/ 2\n\n\uf8eb\n\naI\u03c31 ,I2 \u03c3 \uf8f8 \u2297 \uf8ed\n\nO\n\ni\u2208I\n/ 1\n\n\u03c1i \u2297\n\nO\n\ni\u2208I\n/ 2\n\n\uf8f6\n\n\u03c1\u2217i \uf8f8\n\njust as we considered \u03c1 \u2297 \u03c1\u2217 in the one-register case. We can then define a projection operator \u03a0I\u03c31 ,I2 onto\nthe subspace acted on by\n\uf8f6\n\uf8eb\nO\nO\n\u03c1\u2217i \uf8f8\naI\u03c31 ,I2 \u03c3 \u2297 \uf8ed\n\u03c1i \u2297\ni\u2208I\n/ 1\n\ni\u2208I\n/ 2\n\nand we define the following quantity,\n\nE I1 ,I2 (b) =\n\u03c3\u227a\n\nN\n\ni\u2208I\n\nX\n\u03c1i \u2297\n\nN\n\ni\u2208I2\n\n\u03c1\u2217\ni\n\n8\n\n\u03c7\u03c3 (M )\n\u03a0I\u03c31 ,I2 (b \u2297 b\u2217 )\ndim \u03c3\n\n2\n\n(4.3)\n\n\f4\n\nwith E \u2205,\u2205 (b) = kbk .\nWe can now state the following lemma. The reader can check that (4.5) corresponds exactly to Equation\n(4.3) of part I in the one-register case.\nLemma 11. Let b \u2208 \u03c11 \u2297 * * * \u2297 \u03c1k and let m be an element chosen uniformly from a conjugacy class M of\ninvolutions. Then\n\uf8f6\n\uf8eb\nX\n1 \uf8ed\n2\n\u2297k\nE I (b)\uf8f8\n(4.4)\n1+\nExpm \u03a0m\nb\n=\n2k\nVarm \u03a0\u2297k\nm b\n\n2\n\n=\n\n1\n4k\n\nI\u2286{1,...,k}:I6=\u2205\n\nX\n\nI1 ,I2 \u2286{1,...,k}:I1 ,I2 6=\u2205\n\nE I1 ,I2 (b) \u2212 E I1 (b)E I2 (b)\u2217 .\n\n(4.5)\n\nProof. Let mI denote the operator that operates on the ith\nN register by m for each i \u2208 I and leaves the other\nregisters unchanged. This acts on b as \u03c4 (m) where \u03c4 = i\u2208I \u03c1i (m), and Lemma 1 implies that\nExpm hb, mI bi = E I (b) .\n\nThen (4.4) follows from the observation that\n\u03a0\u2297k\nm b=\n\n1\n2k\n\nX\n\nmI b\n\nI\u2286{1,...,k}\n\nand so\n\u2297k\nExpm \u03a0m\nb\n\n2\n\n= Expm hb, \u03a0\u2297k\nm bi =\n\n1\n2k\n\nX\n\nI\u2286{1,...,k}\n\nExpm hb, mI bi =\n\n1\n2k\n\nX\n\nE I (b) .\n\nI\u2286{1,...,k}\n\nSeparating out the term E \u2205 (b) = kbk2 completes the proof of (4.4).\nSimilarly, let the operator mI1 \u2297 mI2 act on b \u2297 b\u2217 by multiplying the ith register of b by\nNm whenever\niN\u2208 I1 , and multiplying the ith register of b\u2217 whenever i \u2208 I2 . Then it acts as \u03c4 (m) where \u03c4 = i\u2208I1 \u03c1i (m)\u2297\n\u2217\ni\u2208I2 \u03c1i (m), and Lemma 1 implies\nExpm hb \u2297 b\u2217 , (mI1 \u2297 mI2 )(b \u2297 b\u2217 )i = E I1 ,I2 (b) .\n\nThen analogous to Lemmas 2 and 3, the second moment is\nExpm \u03a0\u2297k\nm b\n\n4\n\n\u2217\n\u2297k \u2217\n= Expm hb, \u03a0\u2297k\nm bihb , \u03a0m b i\n\n\u2297k\n\u2217\n= Expm hb \u2297 b\u2217 , (\u03a0\u2297k\nm \u2297 \u03a0m )(b \u2297 b )i\nX\n1\nExpm hb \u2297 b\u2217 , (mI1 \u2297 mI2 )(b \u2297 b\u2217 )i\n=\nn\n4\n\n=\n\n1\n4n\n\nI1 ,I2 \u2286{1,...,k}\n\nX\n\nE I1 ,I2 (b)\n\nI1 ,I2 \u2286{1,...,k}\n\nand so the variance is\nVarm \u03a0\u2297k\nm b\n\n2\n\n=\n=\n\nExpm \u03a0\u2297k\nm b\nX\n1\n4k\n\n4\n\nI1 ,I2 \u2286{1,...,k}\n\n\u0010\n\u2297k\n\u2212 Expm \u03a0m\nb\n\n\u0011\n2 2\n\nE I1 ,I2 (b) \u2212 E I1 (b)E I2 (b)\u2217 .\n\nFinally, (4.5) follows from the fact that the two terms in the sum cancel whenever I1 or I2 is empty.\n9\n\n\f4.2\n\nThe associated Clebsch-Gordan problem\n\nThe expressions E I (b) and E I1 ,I2 (b) above depend on the decomposition of representations of the form\n\uf8eb\n\uf8f6\nO\nO\nO\nO\nO\n\u03c1i \u2297\n\u03c1\u2217i = \uf8ed\n\u03c1\u2217i \uf8f8 \u2297\n\u03c1i \u2297\n(\u03c1i \u2297 \u03c1\u2217i ) .\ni\u2208I1\n\ni\u2208I2\n\ni\u2208I2 \\I1\n\ni\u2208I1 \\I2\n\ni\u2208I1 \u2229I2\n\nMoreover, since the Plancherel distribution is symmetric with respect to conjugation, this is a tensor product\nof |I1 \u25b3I2 | representations \u03c1i with |I1 \u2229 I2 | representations \u03c3j \u2297 \u03c3j\u2217 , where both the \u03c1i and the \u03c3j are chosen\naccording to the Plancherel distribution. This motivates the following definition.\nb k and \u03c3 = (\u03c31 , . . . , \u03c3l ) \u2208 G\nbl , let\nDefinition 2. For non-negative integers k and l and \u03c1 = (\u03c11 , . . . , \u03c1k ) \u2208 G\nV (\u03c1, \u03c3) denote the representation\nl\nk\nO\nO\n(\u03c3j \u2297 \u03c3j\u2217 ) .\n\u03c1i \u2297\ni=1\n\nj=1\n\nOf particular interest is the dimensionwise fraction of such representations consisting of low-dimensional\nirreducibles. For these representations, the naive decomposition results of Equation (6.4) of Part I no longer\nsuffice to obtain nontrivial estimates. Fortunately, the combinatorial representations R and C discussed in\nSection 2 can be used to control the structural properties of these tensor products on average. We will apply\nthis machinery in Section 5 to control general two-register experiments.\nRecall that the multiplicity of an irreducible representation \u03c4 in the decomposition of a representation V\ninto irreducibles is the inner product h\u03c7\u03c4 , \u03c7V iG , and that [g] denotes the conjugacy class of g.\nb and let \u03c1 and \u03c3 be random variables taking values in G\nbk and G\nb l , respectively, so\nLemma 12. Fix \u03c4 \u2208 G\nthat each \u03c1i and \u03c3j is independently distributed according to the Plancherel distribution. Then\nExp\u03c1,\u03c3\n\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) G\ndim V (\u03c1, \u03c3)\n\n=\n\nExp\u03c1,\u03c3\n\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) G\ndim V (\u03c1, \u03c3)\n\n\u2264\n\nd\u03c4\n|G|\n\nif k > 0 ,\n\nd\u03c4 X 1\n|G| g |[g]|l\n\nif k = 0 .\n\nProof. The two permutation representations R and C will play a special role in the analysis: in particular,\nwe will see that the expectation of interest can be expressed in terms of these combinatorial characters.\nSpecifically,\n\uf8f6\n#\n!\uf8eb\n\"\nX X Y d2\u03c1\nY d2\u03c3j h\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) iG\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) G\ni\n\uf8ed\n\uf8f8\n=\nExp\u03c1,\u03c3\n(4.6)\ndim V (\u03c1, \u03c3)\n|G|\n|G|\ndim V (\u03c1, \u03c3)\ni\nj\nbl\nb k \u03c3\u2208G\n\u03c1\u2208G\n!\nX X Y\n1\n=\n(4.7)\nd\u03c1i h\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) iG\n|G|k+l\ni\nl\nk\nb\nb\n\u03c1\u2208G \u03c3\u2208G\n\uf8f6+\n!\uf8eb\n*\nY\nX\nX\nY\n1\n(4.8)\nd\u03c1i \u03c7\u03c1i \uf8ed \u03c7\u03c3j \u03c7\u2217\u03c3j \uf8f8\n\u03c7\u03c4 ,\n=\n|G|k+l\nj\ni\nbl\nb k \u03c3\u2208G\n\u03c1\u2208G\n\n1\n\u03c7\u03c4 , \u03c7kR \u03c7lC\n=\n|G|k+l\n\nG\n\n(4.9)\n\nG\n\nQ\nQ\nV (\u03c1, \u03c3)Qis i d\u03c3i * j d2\u03c3j and the\nwhere the equality of line (4.7) follows from the fact that the dimension of Q\nequality of line (4.8) follows from the fact that the character of V (\u03c1, \u03c3) is i \u03c7\u03c1i j \u03c7\u03c3j \u03c7\u2217\u03c3j .\n10\n\n\fRecall that for any representation \u03c5 we have \u03c7\u03c5 (1) = d\u03c5 . As \u03c7R is a multiple of the delta function \u03b4g ,\nwhenever k > 1 we have h\u03c7\u03c4 , \u03c7kR \u03c7lC iG = d\u03c4 |G|k+l\u22121 and\n\"\n#\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) G\nd\u03c4\nExp\u03c1,\u03c3\n=\n.\ndim V (\u03c1, \u03c3)\n|G|\nOn the other hand, when k = 0 we have\n#\n\"\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3) G\n1\n=\nExp\u03c1,\u03c3\n\u03c7\u03c4 , \u03c7lC\ndim V (\u03c1, \u03c3)\n|G|l\n=\n\u2264\n\nG\n\n=\n\n1 X \u2217\n\u03c7 (g)\u03c7lC (g)\n|G|l+1 g \u03c4\n\n1\n1 X \u2217\n|G|l\n1 X \u2217\n\u03c7\u03c4 (g)\n\u03c7\u03c4 (g)\n=\nl\nl\nl+1\n|G|\n|G| g\n|[g]|\n|[g]|\ng\nd\u03c4 X 1\n,\n|G| g |[g]|l\n\nwhere the last inequality follows from the fact that |\u03c7\u03c4 (g)| \u2264 d\u03c4 for all g.\nP\nl\nNow note that the sum\ng 1/ |[g]| can also be written as a sum over the conjugacy classes C. In\nparticular, if l \u2265 2,\nX 1\nX 1\nX 1\n\u2264\n.\n=\nl\nl\u22121\n|C|\n|C|\ng |[g]|\nC\nC\nIn the case of the symmetric group Sn , the next lemma shows that this quantity is in fact 1 + o(1).\nP\nLemma 13. Given a partition \u03bb = (\u03bb1 , . . . , \u03bbt ) with i \u03bbi = n and \u03bbi \u2265 \u03bbi+1 for all i, let C\u03bb denote the\nconjugacy class of Sn consisting of permutations with cycle structure \u03bb. Then\nX 1\n= 1 + o(1) .\n|C\u03bb |\n\u03bb\n\nProof. First note that if we group the \u03bbi into blocks consisting of \u03c41 1s, \u03c42 2s, and so on (such that\nthen the size of the conjugacy class is given by\n\nP\n\ni \u03c4i i\n\n= n)\n\nn!\nQ\n|C\u03bb | = Q\n( i \u03c4i !) ( i \u03bbi )\n\nsince we can cyclically permute the elements of each cycle, and permute cycles of the same size with each\nother. Thus\n!\n!\nY\nX 1 Y\nX 1\n.\n(4.10)\n\u03bbi\n\u03c4i !\n=\n|C\u03bb |\nn!\ni\ni\n\u03bb\n\n\u03bb\n\nNow suppose that the conjugacy class consists of elements with support s, i.e., with \u03c41 = n \u2212 s fixed points.\nSince we can specify such a partition with a partition of s objects, the number of such partitions is at most\np(s). Moreover we have\nY\nY\n\u03c4i ! = (n \u2212 s)!\n\u03c4i ! \u2264 (n \u2212 s)! (s/2)!\ni\n\nand\n\ni\u22652\n\nY\ni\n\n\u03bbi =\n\nY\n\n\u03bb>1\n\n\u03bb \u2264 es/e .\n\n11\n\n\fsince this is true for any set of reals \u03bb \u2265 0 such that\n\nP\n\n\u03bb = s. Then (4.10) becomes\n\nn\nX 1\nX\n(n \u2212 s)! (s/2)!\n\u2264\np(s)es/e\n|C\u03bb | s=0\nn!\n\n(4.11)\n\n\u03bb\n\nNow, for s >\n\nand for s \u2264\n\n\u221a\nn, we have\n\n(n \u2212 s)! (s/2)!\n1 (s/2)!\n(s/2)!\n= n\u0001\n\u2264\n<\nn!\ns!\ns!\ns\n\n\u221a\nn, for sufficiently large n a stronger bound holds,\n\n\u0012\n\n2s\ne\n\n\u0013\u2212s/2\n\n\u2264 n\u2212s/4\n\n(4.12)\n\n\u221a\n( n/2)s/2\n(n \u2212 s)! (s/2)!\n\u2264 n\u22123s/4 .\n\u2264\nn!\n(n \u2212 s)s\n\nThus (4.12) holds for all s. Using the absurdly crude bound p(s) es/e < 4s , (4.11) then becomes\nn\nX 1\nX\n1\n= 1 + O(n\u22121/4 ) .\n\u2264\nn\u2212s/4 4s <\n\u22121/4\n|C\u03bb | s=0\n1\n\u2212\n4n\n\u03bb\n\nP\nOn the other hand, if l = 1 then the sum g 1/ |[g]| is simply the number of conjugacy classes. Therefore,\nin the case of the symmetric group, we have the following corollary of Lemma 12.\nCorollary 14. Let G = Sn and k, l, \u03c1, and \u03c3 as in Lemma 12. Then for any irreducible character \u03c7\u03c4 ,\nExp\u03c1,\u03c3\n\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3)\n\nSn\n\ndim V (\u03c1, \u03c3)\n\n\u2264 (1 + o(1))\n\nd\u03c4\nn!\n\nunless k = 0 and l = 1, in which case\nExp\u03c1,\u03c3\n\n4.3\n\n\u03c7\u03c4 , \u03c7V (\u03c1,\u03c3)\n\nSn\n\ndim V (\u03c1, \u03c3)\n\n\u2264\n\nd\u03c4 p(n)\n.\nn!\n\nA transverse projection lemma\n\nAs a final technical preparatory element, we record a projection lemma concerning the relationship between\ntensor powers of bases and \"transverse\" subspaces.\nLemma 15. Let U and Y be finite-dimensional Hilbert spaces and let B be an orthonormal basis for U \u2297 Y .\nLet W be a subspace of U \u2297 U \u2217 and \u03a0W be the projection operator onto W . Then\nX\n|(\u03a0W \u2297 1Y \u2297Y \u2217 )(b \u2297 b\u2217 )|2 \u2264 dim Y \u00d7 dim W .\nb\u2208B\n\nProof. Since \u03a0W can be written as a sum of one-dimensional projection operators, it suffices to establish the\nlemma in the case where dim W = 1. Let {ui } be an orthonormal basis for U . Then we can write \u03a0W = \u03a0w\nwhere\nX\naij (ui \u2297 u\u2217j ) .\nw=\ni,j\n\n12\n\n\fNow let {zk } be an orthonormal basis for Y . Then\nX\n|(\u03a0w \u2297 1Y \u2297Y \u2217 )(b \u2297 b\u2217 )|2 =\n|hw \u2297 (zk \u2297 zl\u2217 ), b \u2297 b\u2217 i|2\nk,l\n\n=\n\nai,j (ui \u2297\n\nX X\n\nai,j hui \u2297 zk , bi u\u2217j \u2297 zl\u2217 , b\u2217\n\nk,l\n\n=\n\n2\n\nX X\n\nk,l\n\ni,j\n\ni,j\n\n\u2264\n\n=\n\nX\n\ni\n\ni,l\n\n*\n\n\u2297 (zk \u2297\n\nzl\u2217 ), b\n\n\u2217\n\n\u2297b\n2\n\nX X\nk,l\n\nu\u2217j )\n\nX\nj\n\n2\n\n|hui \u2297 zk , bi|\n\n!\n\nai,j u\u2217j \u2297 zl\u2217 , b\u2217\n\n\uf8eb\n\uf8ecX X\nai,j u\u2217j \u2297 zl\u2217 , b\u2217\n\uf8ed\ni\n\n+\n\n2\n\nj\n\n2\n\n\uf8f6\n\uf8f7\n\uf8f8\n\nwhere we used the Cauchy-Schwartz inequality in the fourth line. Summing over all b \u2208 B then gives\nX\n\nb\u2208B\n\n|(\u03a0w \u2297 1Y \u2297Y \u2217 )(b \u2297 b\u2217 )| \u2264\n2\n\n=\n\nX\ni,j\n\n2\n\nX X\ni,l\n\nj\n\n2\n\nai,j u\u2217j \u2297 zl\u2217\n\n|aij | dim Y = dim Y ,\n\nas desired.\n\n5\n\nTwo registers are insufficient for the symmetric group\n\nIn this section we show that no polynomial number of two-register experiments can distinguish the involutions we have been considering in Sn from each other or from the trivial subgroup. As in Section 4, we\nassume we have measured the representation name on each of the two registers, and that we observed the\nirreducible representations S \u03bb and S \u03bc . For simplicity we present the proof for von Neumann measurements;\nthe generalization to arbitrary frames {b} proceeds exactly as in the proof of Theorem 8.\nTheorem 16. Let B = {b} be an orthonormal basis for S \u03bb \u2297 S \u03bc . Given the hidden subgroup H = {1, m}\nwhere m is chosen uniformly at random from M , let Pm (b) be the probability that we observe the vector b\nconditioned on having observed the representation names S \u03bb and S \u03bc , and let U be the uniform distribution\n\u221a\non B. Then there is a constant \u03b4 > 0 such that for sufficiently large n, with probability at least 1\u2212e\u2212\u03b4 n/ log n\nin m, \u03bb and \u03bc, we have\n\u221a\nkPm \u2212 U k1 < e\u2212\u03b4 n/ log n .\nProof. For k = 2, Lemma 11 specializes to the following:\n\uf8eb\nX\n1\n2\n\uf8ed1 +\nExpm \u03a0\u22972\n=\nm b\n4\nVarm \u03a0\u22972\nm b\n\n2\n\n=\n\n1\n16\n\nI\u2286{\u03bb,\u03bc}:I6=\u2205\n\nX\n\nE I (b)\uf8f8\n\nI1 ,I2 \u2286{\u03bb,\u03bc}:I1 ,I2 6=\u2205\n\n13\n\n\uf8f6\n\nE I1 ,I2 (b) \u2212 E I1 (b)E I2 (b)\u2217 .\n\n(5.1)\n(5.2)\n\n\fAs before, S \u03bb and S \u03bc are chosen with the distribution P (\u03c1). Since this is exponentially close to the Plancherel\ndistribution [12], we can use Lemma 12 to calculate the expectations over \u03bb and \u03bc of E I (b) and E I1 ,I2 (b) with\nnegligible error. We will then show that E I (b) and E I1 ,I2 (b) are superpolynomially small with the stated\nprobability, for all but a small fraction of basis vectors b, namely those that project into low-dimensional\nrepresentations. As in Theorem 8, we will then use Markov's inequality to control the number of these basis\nvectors and use Chebyshev's inequality to control the rest, and thus bound the total distance kPm \u2212 U k1 .\nHowever, the analysis, at least when |I1 | = |I2 | = 2, is more delicate than for the one-register case. As\nbefore, we exclude a set of low-dimensional representations \u039b, but now we restrict \u039b to Young diagrams with\nwidth or height extremely close to n. Specifically, let c > 0 be a constant to be determined below, and let\n\u039b = \u039bc be the set of Young diagrams \u03bd such that\n\u221a\nmax(\u03bd1 , \u03bd1\u2032 ) \u2265 n \u2212 c n/ ln n .\n/ \u039b,\nAnalogously to (3.9), Theorem 7 provides the following bound on the characters \u03c7\u03bd for \u03bd \u2208\n\u03c7\u03bd (M )\n\u2264\nd\u03bd\n\n\u0012\n\n1\u2212 \u221a\n\nc\nn ln n\n\n\u0013bn\n\n\u221a\n\n< e\u2212\u03b1\n\nn/ ln n\n\n(5.3)\n\nwhere \u03b1 = bc > 0. The size and dimension of \u039b is bounded by the following lemma.\n\u221a\n\u221a\n\u221a\n\u221a\nP\nLemma 17. |\u039b| = eo( n) and d\u03bd < ec n for any \u03bd \u2208 \u039b. Therefore, \u03bd\u2208\u039b (d\u03bd )2 < e2c n+o( n) .\n\u221a\nProof. The proof of Lemma 9 applies, except now |\u039b| < 2xp(x) where x = c n/ ln n.\nThen the next lemma shows that with high probability in \u03bb and \u03bc, E I (b) is superpolynomially small for\nall b \u2208 B. (Indeed, it is exponentially small for all but a few b, but we give this statement for simplicity.)\ncn . Let I \u2286 {\u03bb, \u03bc},\nLemma 18. Let S \u03bc and S \u03bb be distributed according to the Plancherel distribution in S\n\u221a\nI 6= \u2205. There is a constant \u03b3 > 0 such that for sufficiently large n, with probability 1 \u2212 e\u2212\u03b3 n , E I (b) \u2264\n\u221a\ne\u2212\u03b1 n/ ln n for all b \u2208 B.\nI\n\u03bb\n\u03bb\nProof. The case when |I| = 1 is identical\n\u221a to the one-register case, since then E (b) = \u03c7 (M )/d . Lemma 6\n\u2212\u03b4 n\nimplies \u03bb \u2208\n/ \u039b with probability 1 \u2212 e\n, and (5.3) completes the proof of this case.\nFor the case |I| = 2, it suffices to ensure that S \u03bb \u2297 S \u03bc contains no low-dimensional representations. Let\n\u03bd \u2208 \u039b; then by Lemma 12 and Lemma 17, the expected multiplicity of S \u03bd in S \u03bb \u2297 S \u03bc is\n\nExp\u03bb,\u03bc h\u03c7\u03bd , \u03c7\u03bb \u03c7\u03bc iSn = Exp\u03bb,\u03bc d\u03bb d\u03bc\n\n\u221a\n\u221a\nh\u03c7\u03bd , \u03c7\u03bb \u03c7\u03bc iSn\n\u2264 e\u22122\u0109 n d\u03bd \u2264 e(c\u22122\u0109) n\n\u03bb\n\u03bc\nd d\n\nwhere \u0109 is the constant appearing in Theorem 5. Thus if c < \u0109, Lemma 17\n\u221a and Markov's inequality imply\nthat the probability any S \u03bd with \u03bd \u2208 \u039b appears in S \u03bb \u2297 S \u03bc is at most e\u2212\u0109 n . If none do, then (5.3) and the\n\u03bd\n\u03bd\nfact that E I \u2264 max\u03bd \u2208\u039b\n/ |\u03c7 (M )/d | complete the proof with \u03b3 = \u0109.\ncn and I1 , I2 \u2282 {\u03bb, \u03bc}, recall Definition 2 and let\nFor the variance estimates, for each S \u03bb , S \u03bc \u2208 S\nV [I1 , I2 ] = V (I1 \u25b3I2 , I1 \u2229 I2 ) ,\n\nwhere I1 \u25b3I2 is the symmetric difference. (We abuse notation here, allowing, e.g., the set I1 \u25b3I2 to stand for\nthe tuple of representations S \u03bb with \u03bb \u2208 I1 \u25b3I2 .) For the variance calculation, as in the single-register case,\nlet L[I1 , I2 ] \u2282 V [I1 , I2 ] be the subspace consisting of copies of representations S \u03bd with \u03bd \u2208 \u039b, and let \u03a0L[I1 ,I2 ]\nbe the projection operator onto this subspace; note that the projection oerator in (4.3) is \u03a0L[I1 ,I2 ] \u2297 1, where\n1 acts on V [I1 , I2 ]. We will abbreviate L = L[I1 , I2 ] and V = V [I1 , I2 ] when the parameters are clear from\ncontext. Then the following lemma bounds the dimension of this subspace.\n\n14\n\n\fcn and let I1 , I2 \u2286\nLemma 19. Let S \u03bb and S \u03bc be distributed according to the Plancherel distribution in S\n{\u03bb, \u03bc}, \u221a\nI1 , I2 6= \u2205. There is a constant \u03b2 > 0 such that for sufficiently large n, with probability at least\n1 \u2212 e\u2212\u03b2 n ,\nX\n\u221a\n(\u03a0L[I1 ,I2 ] \u2297 1)(b \u2297 b\u2217 ) \u2264 e\u2212\u03b2 n |B| .\nb\u2208B\n\nProof. If |I1 | = |I2 | = 1 and\nI1 6= I2 , then the proof of the previous lemma shows that L is in fact empty\n\u221a\nwith probability 1 \u2212 e\u2212\u03a9( n) . When I1 = I2 and |I1 | = 1, however, this is not true; taking I1 = I2 = {\u03bb},\nS \u03bb \u2297 (S \u03bb )\u2217 contains exactly one copy of the trivial representation. However, applying Lemma 15 (with\nU = S \u03bb , Y = S \u03bc , and W = L), Corollary 14, Theorem 5, Lemma 17, and (3.8) gives\n1 X\nd\u03bc dim L\n(\u03a0L \u2297 1)(b \u2297 b\u2217 ) = Exp\u03bb,\u03bc\nExp\u03bb,\u03bc\n|B|\n|B|\nb\u2208B\n1 X \u03bd \u03bd\n= Exp\u03bb,\u03bc \u03bb\nd h\u03c7 , (\u03c7\u03bb )2 iSn\nd\n\u03bd\u2208\u039b\n\nd p(n) X \u03bd 2\n(d )\nn!\n\u03bb\n\n\u2264 Exp\u03bb,\u03bc\n\u2264\n\ne\n\n\u03bd\u2208\u039b\n\u221a\n\u221a\n(\u2212\u0109+\u03b4+2c) n+o( n)\n\n\u221a\nn!\n\n= n\u2212\u03a9(n)\n\nwhere we recall that |B| = d\u03bc d\u03bb and dim V = (d\u03bb )2 .\nWhen |I1 | = 2 and |I2 | = 1, e.g. I1 = {\u03bb, \u03bc} and I2 = {\u03bb}, then dim V = (d\u03bb )2 d\u03bc . Applying Lemma 12\nand taking into account the fact that 1 acts on a space of dimension d\u03bc , we have\n1 X\nd\u03bc dim L\n(\u03a0L \u2297 1)(b \u2297 b\u2217 ) = Exp\u03bb,\u03bc\nExp\u03bb,\u03bc\n|B|\n|B|\nb\u2208B\n1 X \u03bd \u03bd\n= Exp\u03bb,\u03bc \u03bb\nd h\u03c7 , (\u03c7\u03bb )2 \u03c7\u03bc iSn\nd\n\u2264 Exp\u03bb,\u03bc\n\u2264e\n\n\u03bd\u2208\u039b\n\u03bb \u03bc X\n\nd d\nn!\n\n(d\u03bd )2\n\n\u03bd\u2208\u039b\n\u221a\n\u221a\n(\u22122\u0109+2c) n+o( n)\n\n< e\u2212\u0109\n\n\u221a\nn\n\nif we set c < \u0109/2. The case when |I2 | = 2 and |I1 | = 1 is identical.\nFinally, we consider the case when |I1 | = |I2 | = 2. Now dim V = (d\u03bb )2 (d\u03bc )2 , and Corollary 14 gives\n1 X\ndim L\n(\u03a0L \u2297 1)(b \u2297 b\u2217 ) = Exp\u03bb,\u03bc\nExp\u03bb,\u03bc\n|B|\n|B|\nb\u2208B\n1 X \u03bd \u03bd\n= Exp\u03bb,\u03bc \u03bb \u03bc\nd h\u03c7 , (\u03c7\u03bb )2 iSn\nd d\n\u03bd\u2208\u039b\n\n\u2264 (1 + o(1)) Exp\u03bb,\u03bc\n\u221a\n\u2212\u0109 n\n\nd\u03bb d\u03bc X \u03bd 2\n(d )\nn!\n\u03bd\u2208\u039b\n\nwhich, as in the previous case, is less than e\nif we set c < \u0109/2.\nThus, in all three cases we have\n\u221a\n1 X\n(\u03a0L \u2297 1)(b \u2297 b\u2217 ) < e\u2212\u0109 n .\nExp\u03bb,\u03bc\n|B|\nb\u2208B\n\nBy Markov's inequality, the probability that dim L > e\u2212(\u0109/2)\ncompletes the proof.\n15\n\n\u221a\nn\n\n|B| is at most e\u2212(\u0109/2)\n\n\u221a\n\nn\n\n. Thus setting \u03b2 < \u0109/2\n\n\fNow, let E0 denote the following event:\n\u0001\n1. max |\u03c7\u03bb (M )/d\u03bb |, |\u03c7\u03bc (M )/d\u03bc | \u2264 e\u2212\u03a9(n) ,\n\u221a\n\n2. E I (b) = e\u2212\u03b1 n/ ln n for all b \u2208 B and all I \u2282 {\u03bb, \u03bc}, and\n\u221a\nP\n\u2217\n\u2212\u03b2 n\n3.\n|B| for each I1 , I2 \u2282 {\u03bb, \u03bc} with I1 6= \u2205 and I2 6= \u2205.\nb\u2208B (\u03a0L \u2297 1)(b \u2297 b ) \u2264 e\n\u221a\n\nAs a consequence of (3.9) and Lemmas 10, 18 and 19, E0 occurs with probability 1\u2212e\u2212\u03a9( n) . In what follows\nwe condition on E0 . This will allow us to control the three principal parameters that determine the total\n\u22972\n\u22972\nvariation distance between Pm and the uniform distribution: rk \u03a0\u22972\nm , Expm [\u03a0m (b)], and Varm [\u03a0m (b)].\n\u22972\n\u22972\n\u03bb\n\u03bc\nConsidering rk \u03a0m , note that the rank of \u03a0m restricted to a representation S \u2297 S is the product of\nthe ranks of \u03a0m restricted to S \u03bb and S \u03bc ; then (3.7), and item 1 of E0 give\n\u0012\n\u0013\u0012\n\u0013\n\u0011\n\u03c7\u03bc (M )\n\u03c7\u03bb (M )\n|B| \u0010\nd\u03bc d\u03bb\n\u22972\n(5.4)\n1+\n1 + e\u2212\u03a9(n) .\n1\n+\n=\nrk \u03a0m\n=\n\u03bc\n\u03bb\n4\nd\nd\n4\nAs for the expectation Expm [\u03a0\u22972\nm (b)], in light of (5.1) and item 2 of E0 , we conclude that for each b \u2208 B,\nExpm \u03a0\u22972\nm b\n\n2\n\n\u2212\n\n\u221a\n1\n\u2264 3e\u2212\u03b1 n/ ln n .\n4\n\n(5.5)\n\nFinally, we focus on the variance. Define BL \u2282 B to be the\nset of basis vectors b such that for some\n\u221a\n\u2217 2\n\u2212(\u03b2/2) n\nnontrivial I1 , I2 \u2282 {\u03bb, \u03bc}, (\u03a0L[I1 ,I2 ] \u2297 1)(b \u2297 b ) \u2265 e\n. Then since item 3 of E0 holds for each of\nthe 32 = 9 pairs of nonempty subsets I1 , I2 , we have\n\u221a\n\u221a X X\n|BL | \u2264 e(\u03b2/2) n\n(\u03a0L[I1 ,I2 ] \u2297 1)(b \u2297 b\u2217 ) \u2264 9e\u2212(\u03b2/2) n |B| .\nI1 ,I2 b\u2208B\n\nObserve that for any b \u2208 B \\ BL , Equations (5.2), (5.3), and item 2 of E0 give\n2\n\n\u22972\nb\nVarm \u03a0m\n\n\u2264\n\n\u221a\n\u221a\n\u221a \u0011\n9 \u0010 \u2212\u03b1\u221an/ ln n\ne\n+ e\u22122\u03b1 n/ ln n + e\u2212(\u03b2/2) n < e\u2212\u03b1 n/ ln n .\n16\n\nThen Chebyshev's inequality gives\nh\n2\n\u22972\nPr\n\u03a0\u22972\n\u2212 Expm \u03a0m\nb\nm b\n\n2\n\n\u2265 e\u2212(\u03b1/3)\n\n\u221a\n\nn/ ln n\n\ni\n\n\u2264 e\u2212(\u03b1/3)\n\n\u221a\nn/ ln n\n\n.\n\n(5.6)\n\n(5.7)\n\nAnalogous to Theorem 8, let Bbad \u2282 B \\ BL denote the subset of basis vectors for which the event of (5.7)\nis violated. (As in the one-register case, while BL depends only on the choice of \u03bb and \u03bc, Bbad depends also\non m.) Let E1 denote the event\n\u221a\n|Bbad | < e\u2212(\u03b1/6) n/ ln n |B| .\n\u221a\n\nThen (5.7) and Markov's inequality imply that E1 occurs with probability 1 \u2212 e\u2212(\u03b1/6) n/ ln n .\n2\nSo, finally, recall that Pm (b) = \u03a0\u22972\n/rk \u03a0\u22972\nm (b)\nm and let P (b) denote the distribution P (b) =\nExpm [Pm (b)]. We separate Pm \u2212 P 1 into contributions from basis vectors outside and inside BL \u222a Bbad :\nPm \u2212 P\n\n1\n\n=\n\nX\n\nb\u2208B\n/ L \u222aBbad\n\nPm (b) \u2212 P (b) +\n\nX\n\nb\u2208BL \u222aBbad\n\nPm (b) \u2212 P (b) .\n\nThe first sum is taken only over vectors b for which\n\u03a0\u22972\nm (b)\n\n2\n\n\u2212 Expm \u03a0\u22972\nm (b)\n\n16\n\n2\n\n< e\u2212(\u03b1/3)\n\n\u221a\nn/ ln n\n\n.\n\n(5.8)\n\n\fThen conditioning on E0 and E1 , the rank estimate of (5.4) implies that\n\u221a\n\nX\n\nb\u2208B\n/ L \u222aBbad\n\n\u221a\n\n\u221a\ne\u2212(\u03b1/3) n/ ln n\n4e\u2212(\u03b1/3) n/ ln n\n\u2212(\u03b1/3) n/ ln n\nPm (b) \u2212 P (b) \u2264\n.\n<\n8e\n*\n|B|\n=\n1 + e\u2212\u03a9(n)\nrk \u03a0\u22972\nm\n\n(5.9)\n\nOn the other hand, conditioning on E0 and E1 we have\n\u0011\n\u0010\n\u221a\n\u221a\n\u221a\n|BL \u222a Bbad | \u2264 9e\u2212(\u03b2/2) n + e\u2212(\u03b1/6) n/ ln n |B| < 2e\u2212(\u03b1/6) n/ ln n |B| ,\n\nand then (5.4) and (5.5) imply that the total expected probability of the basis vectors in BL \u222a Bbad is\n\u0012\n\u0013\n2\nX\nX\n\u221a\nExpm \u03a0\u22972\n|BL \u222a Bbad |\n1\nm (b)\n\u2212\u03b1 n/ ln n\n\u2264\n*\nP (b) =\n+\n3e\n4\nrk \u03a0\u22972\nrk \u03a0\u22972\nm\nm\nb\u2208BL \u222aBbad\n\nb\u2208BL \u222aBbad\n\u221a\n\u2212(\u03b1/6) n/ ln n\n\n\u2264 2e\nThen we must have\n\nX\n\nb\u2208B\n/ L \u222aBbad\n\nand hence, by (5.9),\nX\n\nb\u2208B\n/ L \u222aBbad\n\n(1 + o(1)) < 3e\u2212(\u03b1/6)\n\nP (b) > 1 \u2212 3e\u2212(\u03b1/6)\n\nPm (b) > 1 \u2212 3e\u2212(\u03b1/6)\n\nand so\n\nX\n\n\u221a\nn/ ln n\n\n\u2212 8e\u2212(\u03b1/3)\n\nPm (b) < 4e\u2212(\u03b1/6)\n\n\u221a\nn/ ln n\n\n.\n\n(5.10)\n\n\u221a\nn/ ln n\n\n\u221a\nn/ ln n\n\n\u221a\nn/ ln n\n\n> 1 \u2212 4e\u2212(\u03b1/6)\n\n\u221a\nn/ ln n\n\n.\n\nb\u2208BL \u222aBbad\n\nCombining this with (5.10) bounds the second sum in (5.8),\nX\n\u221a\nPm (b) \u2212 P (b) < 7e\u2212(\u03b1/6) n/ ln n .\n\n(5.11)\n\nb\u2208BL \u222aBbad\n\nThen combining (5.8), (5.9) and (5.11),\nPm \u2212 P\n\n< 8e\u2212(\u03b1/6)\n\n1\n\u221a\n\u2212\u03a9( n)\n\n\u221a\nn/ ln n\n\n\u221a\n\n\u221a\n\nwith probability at least Pr[E0 \u2227 E1 ] \u2265 1 \u2212 e\n\u2212 e\u2212(\u03b1/6) n/ ln n > 1 \u2212 2e\u2212(\u03b1/6) n/ ln n .\nFinally, it remains to be proved that P is, with high probability, close to the uniform distribution U on\nB. But this follows from (5.4) and (5.5); conditioning on E0 , we have\nP \u2212U\n\n1\n\n\u2264\n\nX Expm \u03a0\u22972\nm b\n\nb\u2208B\n\nrk\n\n\u03a0\u22972\nm\n\n2\n\n\u2212\n\n\u221a\n1\n< 12e\u2212\u03b1 n/ ln n (1 + e\u2212\u03a9(n) ) .\n|B|\n\nWe complete the proof by setting \u03b4 < \u03b1/6 and invoking the triangle inequality.\n\n6\n\nConclusion\n\nThe reader will notice that our current machinery cannot extend to three or more registers when applied to\nthe symmetric group, as the representations of Sn have typical dimension equal to (n!)1/2\u2212o(1) . However,\nwe have been very pessimistic in our analysis; in particular, we have assumed that vectors of the form b \u2297 b\nproject into low-dimensional representations, S \u03bd with \u03bd \u2208 \u039b, as much as possible. Perhaps a more detailed\nunderstanding of how these vectors lie inside the decomposition of V (\u03c1, \u03c3) into irreducibles would allow one\nto prove that this hidden subgroup problem requires entangled measurements over \u03a9(log |G|) = \u03a9(n log n)\ncoset states. Therefore, we make the following conjecture.\n17\n\n\fConjecture 1. Let B = {b} with weights {ab } be a complete frame for S \u03bb1 \u2297 * * * \u2297 S \u03bbk . Given the hidden\nsubgroup H = {1, m} where m is chosen uniformly at random from M , and a coset state |c1 Hi \u2297 * * * \u2297 |ck Hi\non k registers, let Pm (b) be the probability that we observe the vector b conditioned on having observed the\nrepresentation names {S \u03bbi }, and let U be the natural distribution on B. Then for all c > 0, with probability\n1 \u2212 o(n\u2212c ) in m and {S \u03bbi }, we have\nkPm \u2212 U k1 = o(n\u2212c )\nunless k = \u03a9(n log n).\n\nAcknowledgments.\nThis work was supported by NSF grants CCR-0093065, PHY-0200909, EIA-0218443, EIA-0218563, CCR0220070, and CCR-0220264. We are grateful to Denis Th\u00e9rien, McGill University, and Bellairs Research\nInstitute for organizing a workshop at which this work began; to Dorit Aharonov, Daniel Rockmore, Leonard\nSchulman, and Umesh Vazirani for helpful conversations; to Sean Hallgren, Martin R\u00f6tteler and Pranab Sen\nfor identifying a flaw in an earlier draft; and to Tracy Conrad and Sally Milius for their support and tolerance.\nC.M. also thanks Rosemary Moore for providing a larger perspective.\n\nReferences\n[1] David Bacon, Andrew Childs, and Wim van Dam. Optimal measurements for the dihedral hidden\nsubgroup problem. Preprint, quant-ph/0501044 (2005).\n[2] Robert Beals. Quantum computation of Fourier transforms over symmetric groups. Proc. 29th Annual\nACM Symposium on the Theory of Computing, pages 48\u201353, 1997.\n[3] Ethan Bernstein and Umesh Vazirani. Quantum complexity theory (preliminary abstract). Proc. 25th\nAnnual ACM Symposium on the Theory of Computing, pages 11\u201320, 1993.\n[4] Wim van Dam, Sean Hallgren, and Lawrence Ip. Quantum algorithms for some hidden shift problems.\nProc. 14th ACM-SIAM Symposium on Discrete Algorithms, pages 489\u2013498, 2003.\n[5] Mark Ettinger and Peter H\u00f8yer. On quantum algorithms for noncommutative hidden subgroups.\nPreprint, quant-ph/9807029 (1998).\n[6] Mark Ettinger and Peter H\u00f8yer and Emmanuel Knill. The quantum query complexity of the hidden\nsubgroup problem is polynomial. Information Processing Letters, to appear.\n[7] Katalin Friedl, G\u00e1bor Ivanyos, Fr\u00e9d\u00e9ric Magniez, Miklos Santha, and Pranab Sen. Hidden translation\nand orbit coset in quantum computing. Proc. 35th ACM Symposium on Theory of Computing, 2003.\n[8] William Fulton and Joe Harris. Representation Theory: A First Course. Number 129 in Graduate Texts\nin Mathematics. Springer-Verlag, 1991.\n[9] Michelangelo Grigni, Leonard J. Schulman, Monica Vazirani, and Umesh Vazirani. Quantum mechanical\nalgorithms for the nonabelian hidden subgroup problem. Proc. 33rd ACM Symposium on Theory of\nComputing, pages 68\u201374, 2001.\n[10] Lisa Hales and Sean Hallgren. Quantum Fourier sampling simplified. Proc. 31st Annual ACM Symposium on Theory of Computing, 1999.\n[11] Lisa Hales and Sean Hallgren. An improved quantum Fourier transform algorithm and applications.\nProc. 41st Annual Symposium on Foundations of Computer Science, 2000.\n\n18\n\n\f[12] Sean Hallgren, Alexander Russell, and Amnon Ta-Shma. Normal subgroup reconstruction and quantum\ncomputation using group representations. Proc. 32nd ACM Symposium on Theory of Computing, pages\n627\u2013635, 2000.\n[13] Peter H\u00f8yer. Efficient quantum transforms. Preprint, quant-ph/9702028 (1997).\n[14] Yoshifumi Inui and Fran\u00e7ois Le Gall. An efficient algorithm for the hidden subgroup problem over a\nclass of semi-direct product groups. Proc. EQIS 2004.\n[15] Lawrence Ip. Shor's algorithm is optimal. Preprint, 2004.\n[16] G\u00e1bor Ivanyos, Fr\u00e9d\u00e9ric Magniez, and Miklos Santha. Efficient quantum algorithms for some instances\nof the non-abelian hidden subgroup problem. Int. J. Found. Comput. Sci. 14(5): 723\u2013740, 2003.\n[17] Richard Jozsa. Quantum factoring, discrete logarithms and the hidden subgroup problem. Preprint,\nquant-ph/0012084 (2000).\n[18] Julia Kempe and Aner Shalev. The hidden subgroup problem and permutation group theory. Preprint,\nquant-ph/0406046 (2004).\n[19] S. V. Kerov. Asymptotic representation theory of the symmetric group and its applications in analysis.\nTranslated by N. V. Tsilevich. Volume 219 in Translations of Mathematical Monographs. American\nMathematical Society, 2003.\n[20] Greg Kuperberg. A subexponential-time quantum algorithm for the dihedral hidden subgroup problem.\nPreprint, quant-ph/0302112 (2003).\n[21] Cristopher Moore, Daniel Rockmore, and Alexander Russell. Generic quantum Fourier transforms.\nProc. 15th Annual ACM-SIAM Symposium on Discrete Algorithms, pages 778\u2013787, 2004.\n[22] Cristopher Moore, Daniel Rockmore, Alexander Russell, and Leonard Schulman. The value of basis\nselection in Fourier sampling: hidden subgroup problems for affine groups. Proc. 15th Annual ACMSIAM Symposium on Discrete Algorithms, pages 1113\u20131122, 2004.\n[23] Oded Regev. Quantum computation and lattice problems. Proc. 43rd Symposium on Foundations of\nComputer Science, pages 520\u2013530, 2002.\n[24] Martin Roetteler and Thomas Beth. Polynomial-time solution to the hidden subgroup problem for a\nclass of non-abelian groups. Preprint, quant-ph/9812070 (1998).\n[25] Yuval Roichman. Upper bound on the characters of the symmetric groups. Inventiones Mathematicae,\n125:451\u2013485, 1996.\n[26] Steven Roman. Advanced Linear Algebra. Number 135 in Graduate Texts in Mathematics. Springer,\n1992.\n[27] Jean-Pierre Serre. Linear Representations of Finite Groups. Number 42 in Graduate Texts in Mathematics. Springer-Verlag, 1977.\n[28] Peter W. Shor. Polynomial-time algorithms for prime factorization and discrete logarithms on a quantum\ncomputer. SIAM Journal on Computing, 26(5):1484\u20131509, 1997.\n[29] Daniel R. Simon. On the power of quantum computation. SIAM Journal on Computing, 26(5):1474\u2013\n1483, 1997.\n[30] A. M. Vershik and S. V. Kerov. Asymptotic behavior of the maximum and generic dimensions of\nirreducible representations of the symmetric group. Funk. Anal. i Prolizhen, 19(1):25\u201336, 1985; English\ntranslation, Funct. Anal. Appl., 19:21\u201331, 1989.\n\n19\n\n\f"}