{"id": "http://arxiv.org/abs/1009.5806v1", "guidislink": true, "updated": "2010-09-29T08:42:54Z", "updated_parsed": [2010, 9, 29, 8, 42, 54, 2, 272, 0], "published": "2010-09-29T08:42:54Z", "published_parsed": [2010, 9, 29, 8, 42, 54, 2, 272, 0], "title": "Density quantization method in the optimal portfolio choice with partial\n  observation of stochastic volatility", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.1394%2C1009.4339%2C1009.4581%2C1009.0889%2C1009.5365%2C1009.0816%2C1009.1535%2C1009.4639%2C1009.6138%2C1009.2726%2C1009.3901%2C1009.3881%2C1009.5071%2C1009.4931%2C1009.3388%2C1009.5436%2C1009.3145%2C1009.4755%2C1009.1136%2C1009.5545%2C1009.4578%2C1009.0413%2C1009.1760%2C1009.2606%2C1009.2121%2C1009.4932%2C1009.5223%2C1009.1406%2C1009.1191%2C1009.1366%2C1009.4371%2C1009.5870%2C1009.1851%2C1009.0950%2C1009.3751%2C1009.3165%2C1009.0100%2C1009.5363%2C1009.0449%2C1009.0186%2C1009.0877%2C1009.3712%2C1009.4332%2C1009.5583%2C1009.1915%2C1009.3222%2C1009.1310%2C1009.5035%2C1009.5879%2C1009.0347%2C1009.5872%2C1009.4758%2C1009.1968%2C1009.3125%2C1009.4962%2C1009.5275%2C1009.1469%2C1009.5000%2C1009.3732%2C1009.3086%2C1009.0870%2C1009.0929%2C1009.4944%2C1009.1083%2C1009.4448%2C1009.3827%2C1009.5447%2C1009.5450%2C1009.0979%2C1009.3774%2C1009.5927%2C1009.2111%2C1009.2227%2C1009.0549%2C1009.5824%2C1009.3028%2C1009.3021%2C1009.3891%2C1009.5023%2C1009.1033%2C1009.1553%2C1009.5995%2C1009.2831%2C1009.5806%2C1009.0597%2C1009.4511%2C1009.5028%2C1009.1148%2C1009.2940%2C1009.4834%2C1009.3410%2C1009.0161%2C1009.4283%2C1009.5740%2C1009.5173%2C1009.2473%2C1009.5821%2C1009.0508%2C1009.3213%2C1009.0729%2C1009.5614&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Density quantization method in the optimal portfolio choice with partial\n  observation of stochastic volatility"}, "summary": "Computational aspects of the optimal consumption and investment with the\npartially observed stochastic volatility of the asset prices are considered.\nThe new quantization approach to filtering - density quantization - is\nintroduced which reduces the original infinite dimensional state space of the\nproblem to the finite quantization set. The density quantization is embedded\ninto the numerical algorithm to solve the dynamic programming equation related\nto the portfolio optimization.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.1394%2C1009.4339%2C1009.4581%2C1009.0889%2C1009.5365%2C1009.0816%2C1009.1535%2C1009.4639%2C1009.6138%2C1009.2726%2C1009.3901%2C1009.3881%2C1009.5071%2C1009.4931%2C1009.3388%2C1009.5436%2C1009.3145%2C1009.4755%2C1009.1136%2C1009.5545%2C1009.4578%2C1009.0413%2C1009.1760%2C1009.2606%2C1009.2121%2C1009.4932%2C1009.5223%2C1009.1406%2C1009.1191%2C1009.1366%2C1009.4371%2C1009.5870%2C1009.1851%2C1009.0950%2C1009.3751%2C1009.3165%2C1009.0100%2C1009.5363%2C1009.0449%2C1009.0186%2C1009.0877%2C1009.3712%2C1009.4332%2C1009.5583%2C1009.1915%2C1009.3222%2C1009.1310%2C1009.5035%2C1009.5879%2C1009.0347%2C1009.5872%2C1009.4758%2C1009.1968%2C1009.3125%2C1009.4962%2C1009.5275%2C1009.1469%2C1009.5000%2C1009.3732%2C1009.3086%2C1009.0870%2C1009.0929%2C1009.4944%2C1009.1083%2C1009.4448%2C1009.3827%2C1009.5447%2C1009.5450%2C1009.0979%2C1009.3774%2C1009.5927%2C1009.2111%2C1009.2227%2C1009.0549%2C1009.5824%2C1009.3028%2C1009.3021%2C1009.3891%2C1009.5023%2C1009.1033%2C1009.1553%2C1009.5995%2C1009.2831%2C1009.5806%2C1009.0597%2C1009.4511%2C1009.5028%2C1009.1148%2C1009.2940%2C1009.4834%2C1009.3410%2C1009.0161%2C1009.4283%2C1009.5740%2C1009.5173%2C1009.2473%2C1009.5821%2C1009.0508%2C1009.3213%2C1009.0729%2C1009.5614&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Computational aspects of the optimal consumption and investment with the\npartially observed stochastic volatility of the asset prices are considered.\nThe new quantization approach to filtering - density quantization - is\nintroduced which reduces the original infinite dimensional state space of the\nproblem to the finite quantization set. The density quantization is embedded\ninto the numerical algorithm to solve the dynamic programming equation related\nto the portfolio optimization."}, "authors": ["Grzegorz Ha\u0142aj"], "author_detail": {"name": "Grzegorz Ha\u0142aj"}, "author": "Grzegorz Ha\u0142aj", "arxiv_comment": "33 pages", "links": [{"href": "http://arxiv.org/abs/1009.5806v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1009.5806v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-fin.CP", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-fin.CP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-fin.PM", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "91G10, 91G60", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1009.5806v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1009.5806v1", "journal_reference": null, "doi": null, "fulltext": "Density quantization method in the optimal portfolio\nchoice with partial observation of stochastic volatilityI\n\narXiv:1009.5806v1 [q-fin.CP] 29 Sep 2010\n\nGrzegorz Halaj\nBank Pekao SA, ALM Office, Warsaw\nPostdoc fellow at the Fields Institute, Toronto\n\nAbstract\nComputational aspects of the optimal consumption and investment with the\npartially observed stochastic volatility of the asset prices are considered. The\nnew quantization approach to filtering \u2013 density quantization \u2013 is introduced\nwhich reduces the original infinite dimensional state space of the problem to\nthe finite quantization set. The density quantization is embedded into the\nnumerical algorithm to solve the dynamic programming equation related to\nthe portfolio optimization.\nKeywords: Optimal portfolio, partial observation, filtering, density\nquantization\n1. Introduction\nThe optimal investment portfolio and consumption path choice have been\nstudied extensively for about 5 decades but still poses computational difficulties. The standard Merton-like investment problem evolved into many\nresearch fields and one of them are the partial observation models studied\nby Lakner [15], Pham and Quenez [19], Sass and Haussmann [21], Stettner\n[24], Baghery and \u00d8ksendal [1], Halaj [13], Brendle [6]. Those models are\nimbedded into the control theory framework with partial information [4]. In\nthe case of portfolio choice in the partial observation, the investor does not\nI\n\nDISCLAIMER: The paper may contain personal views or opinions of the author that\nare not necessarily those of the Bank Pekao SA\nEmail address: grzegorz.halaj@n-s.pl (Grzegorz Halaj)\n\n\u2013\u2013\n\nNovember 5, 2018\n\n\fobserve all the factors defining the dynamics of the market. Hence, the optimal strategies are not only functions of the state variables like the wealth\nof the investor, but depend on investor's beliefs about the true value of asset prices and economic factors [24]. Those beliefs are represented by the\nprobability distribution of values of the factors given available information\non the market. This makes the value function of the investor to be defined on\nthe infinite dimensional state space. Following the quantization approach we\nintroduced the numerical method to solve the related dynamic programming\nequation.\nThe partial observation shows up in the portfolio models in two forms.\nThe first one is related to trend parameters of assets prices, the second one to\nvolatility. Models with an unobserved trend are usually easy to reformulate\nin a full observation setting (eg. by the change of measure approach the drift\nparameter of diffusion price processes vanish). The portfolio problems with\nunknown volatility are, however, more realistic and we assumed in our model\nthat the volatility of stocks is unobserved, also driven by some unobserved\neconomic factors. This is a standard assumption in advanced models of\nvolatility [2, 12].\nWe consider the numerical approximation of the solution to the following consumption and investment problem. For clarity of the presentation\nof the main idea we postpone the rigorous assumptions to the section 1.2.\nLet us denote by T the set {0, 1, . . . , T } \u2282 N \u2229 {0}. We consider the probability space (\u03a9, F, P) and the discrete filtration F : = {Ft }t\u2208T . On F we\ndefine N sequences of the IID random variables {\u000fi (t)}t\u2208T , i \u2208 {1, . . . , N },\neach of which has a positive density \u03c6. By {r(t)}t\u2208T we denote a process of\nthe interest rates in the economy, constant within the periods [t, t + 1] and\nby {S0 (t)}t\u2208T we denote the bank account process given by the recurrence\nS0 (0) = 1 and \u2200n > 0 S0 (t + 1) = (1 + r(t))S0 (t).\nWe assume that the process of the economic factors measuring the economic situation is denoted by {Y (t)}t\u2208T and given by the following equation:\nY (0) = y0\n\nY (t + 1) = Y (t) + \u03b1 (\u0233 \u2212 Y (t)) + \u03c3Y \u03be(t + 1),\n\n(1)\n\nwhere (\u03be(t))t\u2208T is the IID sequence of K-dimensional random variables, each\nwith positive density \u03c8. \u03c3Y is the full-rank K \u00d7 K matrix. The tradable\nassets on the market have the following dynamics for i \u2208 {1, . . . , N }:\nSi (t + 1) = Si (t) exp (\u03bc(Y (t + 1)) + \u03c3(Y (t + 1))\u000fi (t + 1)) .\n2\n\n(2)\n\n\fThere are two types of shocks on the market: the idiosyncratic \u000f which are\nasset (eg. company) specific and the systemic \u03be which influence all the risky\nassets on the market.\nThe investor (and consumer at the same time) have preferences characterized by utility functions u : RK \u00d7 R+ \u2192 R and uT : RK \u00d7 R+ \u2192 R.\nThe return from investment in the asset Si in t for [t, t + 1] is denoted by\n. The logarithmic return is denoted Ril (t) = ln(Ri (t)). The\nRi (t + 1) = SiS(t+1)\ni (t)\nwealth of the investor starting with capital x0 and investing \u03c0 : = {\u03c0(t)|t \u2208 T}\nand consuming c : = {c(t)|t \u2208 T} is defined by:\nX(t+1) =\n\nN\nX\n\n\u03c0i (t)\n\ni=1\n\nN\nX\nSi (t + 1)\n+(X(t)\u2212\n\u03c0i (t)\u2212c(t))(1+r(t)),\nSi (t)\ni=1\n\nX(0) = x0 .\n\n(3)\nThe investor observes only the prices Si of the securities so his information is described by filtration FS = {FtS }t\u2208T where FtS : = \u03c3({Si (s)|i \u2208\n{1, . . . , N }, s \u2264 t}). It is equivalent to observing FlR : = \u03c3({Ril (s)|i \u2208\n{1, . . . , N }, s \u2264 t}) generated by log-returns from investment in S which\nis more convenient for our purpose. The investor wants to optimize his utility from consumption and his terminal wealth. She maximizes the functional\nJ : A(x) \u2192 R given by:\n(T \u22121\n)\nX\nJ(c, \u03c0) = E\n\u03b4 t u(c(t)) + \u03b4 T uT (Y (T ), X c,\u03c0 (T )) ,\n(4)\nt=1\n\nwhere T is the time horizon and A(x) is the set of the admissible controls\n(c, \u03c0)\nn\nA(x) = ((c(0), . . . , c(T \u2212 1)), (\u03c0(0), . . . , \u03c0(T \u2212 1))|\n(c(t), \u03c0(t)) \u2212 FtlR\u2212measurable;\nN\no\nX\nc,\u03c0\n\u03c0i (t) \u2264 X (t) \u2212 c(t) .\n\n0 \u2264 c(t) \u2264 X c,\u03c0 (t);\n\ni=1\n\nThe solution maximizing J is given by the special form of dynamic programming.\n(\n)\n\u0010\n\u0011\nV (t, x, %) = sup u(c\u0304) + \u03b4EV t + 1, x(R\u0302l (t + 1)), %t+1 (t + 1, R\u0302l (t + 1))\nA(x)\n\n3\n\n\fThe arguments t and x refer to usual time and current wealth state space\nvariables (like in Bertsekas [5]). The variable \u03c1 measures the distribution of\na random variable which is precisely defined in section 2 and corresponds\nto the process Y . Unlike in the full observation stochastic control in which\ncase the value function at time t depends on the realization of Y (t), the\npartial observation allows the investor to assess only the most likely value of\nY (t) given the history of the asset prices. That is the intuition behind the\ndependence of V on the whole distribution of Y given FtS .\nThe lack of closed form solutions to consumption/investment problems\ngives rise to research on numerical simulation methods to be applied to models with partial observation. The numerical procedure has to be designed\nin a special way to account for the natural high complexity of the state\nspace of stochastic control. The literature does not give many examples of\napproximate solutions to the stochastic control with filtering. Runggaldier\nand Stettner [20] discretize transition probabilities and Desai et al. [10] proposed a particle filtering method to discretize a dynamic programming equation. There are numerous studies of numerical methods of filtering equations\nthemselves. The Zakai equations which describe densities of unobserved parameters evolving in time as new information arrives to the market can be\nsolved by means of the so-called particle filter methods [9]. Filter equations\nin discrete time can be estimated with the so-called quantization [16, 17, 18].\nIn the related paper Corsi et al. [8] also proposed the scheme to solve the\ndynamic programming equation of the partially observed control problem\napplying markovian quantization and approximated the given Markov Chain\nby the transition probability matrix. In this way, infinite dimensional random variables can be approximated by a finite set of point in an optimal way.\nWe modified the standard quantization techniques to develop a different approach \u2013 density quantization \u2013 and we applied it to our control problem.\nBasically, the main idea is to find the optimal quantization set directly in\nthe set of the unnormalized densities of the filter. In other words, the density\nquantization set is the set of the appropriately selected unnormalized density functions. It proved to be successful in recursively solving the dynamic\nprogramming equation.\nThe paper is organized as follows: First, we present the mathematical\nmodel of the market and decision making. Second, we show the influence\npartial information can exert on consumption of an investor in a simplistic\ntheoretical example. Third, we rewrite the partially observed problem in\na full observation setting, applying the change of measure approach and\n4\n\n\fwe solve it using the dynamic programming. Fourth, we define the density\nquantization and we show how the investment/consumption problem can be\nsolved numerically. Finally, we illustrate the application of the developed\nnumerical method in the example of the market model.\n1.1. Notation.\n\u2022 Mn\u00d7m - the set of matrices M with n rows and m columns.\n\u2022 B n (F) - the set of Borel functions f : \u03a9 \u00d7 RK \u2192 R, f (\u03c9, *) \u2208 Ln (RK ).\n\u2022 \u03c6\u03bc,\u03c3 (x) - Gaussian density i.e.\n\u03c6\u03bc,\u03c3 (x) =\n\n1\n(2\u03c0)N/2 (det(\u03a3))1/2\n\n1\nexp(\u2212 (x \u2212 \u03bc)T \u03a3\u22121 (x \u2212 \u03bc)),\n2\n\nwhere \u03bc is mean and \u03a3 : = \u03c3\u03c3 > is covariance matrix.\n\u2022 vol(A) - volume of a set A \u2208 Rn .\nP\n\u2022 diam(A) = sup(x,y)\u2208A\u00d7A ( 1\u2264i\u2264n |xi \u2212 yi |2 )1/2 .\n\u2022 Ac - completion of set A.\n1.2. Main technical assumptions.\nTo show convergence of solutions\nof approximate problem to the original one we need 3 assumptions for \u03c6 and\n\u03c8.\n[A0] \u03c3(*) is bounded from\n0, i.e. \u2203\u03c3min > 0 such that \u2200y \u2208 RK \u03c3(y) > \u03c3min .\nR\n[A1] u and uT satisfy RN \u00d7RK (\u03c6(x)+\u03c8(y))(u(exp(x))+uT (exp(x), y))dxdy <\n\u221e.\nR\n1\n[A2] For every y \u2208 RN and a < 1, RK \u03c6( z\u2212y\n) \u03c6(y)\ndz < L\u03a6 .\na\n[A0] and [A2] are necessary to show convergence of the numerical scheme.\n[A1] guarantees the integrability in the dynamic programming equations.\n2. Filtering\nThe most fundamental task to be done before applying the standard\ndynamic programming toolkit to our consumption/investment selection is to\ntransform the problem into the complete observation one. We apply changing\nof reference measure techniques similarly to Krishnamurthy and Le Gland\n5\n\n\f[14], Elliot and Miao [12], Stettner [24]. After that, in the section 3, we\ntransform the classical dynamic programming equation to make it suitable\nfor our portfolio problem.\nFor each t \u2208 T we define a random variable\n\u0010\n\u0011\n\u0001\n\u22121\n\u22121\n(l)\n\u03c8\n\u03c3\n[Y\n(t)\n\u2212\nY\n(t\n\u2212\n1)\n\u2212\n\u03b1(\u0233\n\u2212\nY\n(t\n\u2212\n1))]\nY\n\u03c6 \u03c3 (Y (t))[R (t) \u2212 \u03bc(Y (t))]\n\u03bbt =\n.\ndet(\u03c3(Y (t)))\u03c6(R(l) (t))\ndet(\u03c3Y )\u03c8(Y (t))\nQ\nLet us construct a process \u039b in the following way: \u039bt : = ts=1 \u03bbs .\nThe process \u039b defines a new measure \u2013 the reference measure P\u0304. Let us\ndefine the filtration FlR,Y : \u03c3({Rl (s), Y (s)|i \u2208 {1, . . . , N }, s \u2264 t}). For each\nt \u2208 T, its restriction to FtlR,Y is defined:\ndP\ndP\u0304\n\nFtlR,Y\n\n= \u039bt .\n\nTo study properties of stochastic processes under P\u0304 we extensively use the\ngeneralized Bayes formula: for (F, P)-measurable Z\n\u0003\n\u0002\n\u0003\nY\n\u0003 \u0112 [\u039bt Z| FtY\n\u0003 E \u039b\u22121\nt Z Ft\nY\nY\n\u0003 and E [Z| Ft =\n\u0002\n.\n(5)\n\u0112 [Z| Ft =\n\u0112 [\u039bt | FtY ]\nE \u039b\u22121\nFtY\nt\nWe assume that there exists a function-valued process % : \u03a9 \u00d7 T \u00d7 RK \u2192\nL (R) satisfying for a L2 Borel function f we have\nZ\n\u0003\nlR\n\u0112 [\u039bt f (Y )| Ft =\nf (z)%t (z)dz, t \u2208 T.\n(6)\n2\n\nRK\n\nFor a given t the object %t is the conditional unnormalized density of Y .\nWe look for the recursive equation for % which \u2013 combining with the Bayes\nformula 5 \u2013 would give the tractable expression for filters used in the optimization. It makes the numerical simulation of the optimal consumption/investment strategies easier.\nThe main result of the section, relying on independence of Y and Rl under\nP\u0304 is given in the following theorem.\nTheorem 2.1. Let us denote\n\u0010\n\u0011\n\u22121\n(l)\n\u03c6 \u03c3 (z)[R (t) \u2212 \u03bc(z)]\n\u03a6(z, Rl (t)) : =\ndet(\u03c3(z))\n\u0010\n\u0011\n\u03c8 \u03c3Y\u22121 [z \u2212 Y (t \u2212 1) \u2212 \u03b1(\u0233 \u2212 Y (t \u2212 1))]\n\u03a8(z, Y (t \u2212 1)) : =\n.\ndet(\u03c3Y )\n6\n\n\fThe process % satisfies the recursion\nZ\n\u03a6(z, Rl (t))\n\u03a8(z, y)%t\u22121 (y)dy.\n%t (z) =\n\u03c6(Rl (t)) RK\n\n(7)\n\nProof: (see appendix Appendix A)\nNote that\nR\n\u0003\nK f (z)%t (z)dz\nE [f (Y (t))| FtlR = RR\n.\n% (z)dz\nRK t\nThis representation allows us to rewrite the original problem to the full observation control. Since \u039b is a martingale then \u2013 similarly to Runggaldier\nand Stettner [20] \u2013 we obtained\n( T\n)\nX\nt\nT\nc,\u03c0\n\u03b4 u(c(t)) + \u03b4 uT (Y (T ), X (T ))\nJ(c, \u03c0) = \u0112\u039bT\nt=1\n\n=\n\n=\n\nT\nX\nt=1\nT\nX\n\n\u0003\n\u0002\n\u0003\n\u0002\n\u0112 \u039bt \u03b4 t u(c(t)) + \u0112 \u039bT \u03b4 T uT (Y (T ), X c,\u03c0 (T ))\n\u0002 \u0002\n\u0003\u0003\n\u0002 \u0002\n\u0003\u0003\n\u0112 \u0112 \u039bt \u03b4 t u(c(t)) FtlR + \u0112 \u0112 \u039bT \u03b4 T uT (Y (T ), X c,\u03c0 (T )) FTlR\n\nt=1\n\n= \u0112\n\n( T\nX\n\n\u03b4 t u(c(t)) + \u03b4 T\n\nZ\n\nt=1\n\n)\nuT (z, X c,\u03c0 (T ))%T (z)dz\n\n.\n\n(8)\n\nRK\n\nIn this way all the processes used in the equation 8 are observed, i.e. adapted\nto the filtration generated by the observed process Rl .\nRemark 2.1. There is an analogical way of solving the filters in the continuous time. The density of the filter is described by the so-called Zakai\nequation. For instance, Bene\u0161 et al. [3] showed the existence of the solution\nto the Zakai equation in the theoretical case and Carmona and Ludkovsky [7]\nused this equation in the financial setting.\n3. Dynamic programming\nAfter transcribing the original problem to a Markov one we can formulate\na dynamic programming equation for the optimal wealth of an investor. Unfortunately, this is an infinite-dimensional problem since the value functional\nof the optimization is a function on the space of the random densities.\n7\n\n\fLet At (x) be the set of the admissible controls of the portfolio starting\nat time t from wealth x (initial at t) i.e.\nAt (x) : = {((c(t), c(t + 1), . . . , c(T )), (\u03c0(t), \u03c0(t + 1), . . . , \u03c0(T )) |(c, \u03c0) \u2208 A(x)} .\nThe optimal value V at time t \u2208 T with the initial wealth x and the updated\ndensity % of the unobserved process at t is defined V : T \u00d7 R \u00d7 B 2 (F) \u2192 R\n\"T \u22121\n#\nZ\nX\n\u03b4 s\u2212t u(c(s)) + \u03b4 T \u2212t\nuT (z, X c,\u03c0 (T ))%T (z)dz FtlR ,\nV (t, x, %) : = sup \u0112\n(c,\u03c0)\u2208At (x)\n\nRK\n\ns=t\n\nfor X c,\u03c0 (t) \u2261 x and %t \u2261 %. The previous section gives\n\u0014Z\n\u0015 Z\nc,\u03c0\nlR\nuT (z, X (T ))%T (z)dz FT =\nV (T, x, %) = \u0112\nuT (z, x)%(z)dz.\nRK\n\nRK\n\nLemma 3.1. The following backward recursion holds for V and t < T :\n(\nZ\nN\n\u0010\nX\nV (t, x, %) =\nsup\nu(c\u0304) + \u03b4\nV t + 1,\n\u03c0\u0304i R\u0302i +\nN |0\u2264c\u0304\u2264x,\n{(c\u0304,\u03c0\u0304)\u2208R\u00d7R\nP\n1\u2264i\u2264N \u03c0\u0304i \u2264x}\n\n+(x \u2212\n\nN\nX\n\nRN\n\n\u03c0\u0304i \u2212 c\u0304)(1 + r(t)), %t+1\n\ni=1\nN\n\u0011Y\n\ni=1\n\n)\n\u03c6(R\u0302i )dR\u03021 * ... * dR\u0302N (9)\n\ni=1\n\nand\nsup J(c, \u03c0) = V (0, x0 , \u03c8).\n(c,\u03c0)\u2208A\n\nProof: It is straightforward that the identity 10 hold.\n\n8\n\n(10)\n\n\flR\nBy definition, FtlR -measurability of (c(t), \u03c0(t)) and FtlR \u2282 Ft+1\n\nV (t, x, %) =\n\nsup\n\nZ\nT\nn hX\ns\u2212t\nT \u2212t\n\u0112\n\u03b4 u(c(s)) + \u03b4\n\n(c,\u03c0)\u2208At (x)\n\n=\n\nsup\n\nuT (z, X\n\nc,\u03c0\n\n)%T (z)dz\n\nRK\n\ns=t\n\ns=t+1\n\n\u03b4\n\nT \u2212(t+1)\n\nZ\nuT (z, X\n\nc,\u03c0\n\n)%T (z)dz\n\n)%T (z)dz\n\nlR\nFt+1\n\nT\nn\nh h X\nu(c(t)) + \u03b4 \u0112 \u0112\n\u03b4 s\u2212(t+1) u(c(s)) +\n\n(c,\u03c0)\u2208At (x)\n\ns=t+1\n\n\u03b4\n\nT \u2212(t+1)\n\nZ\nuT (z, X\n\nc,\u03c0\n\nRK\n\n=\n\nsup\n\nio\n\nFtlR\n\nRK\n\nsup\n\nio\n\nT\nn\nh X\nu(c(t)) + \u03b4 \u0112\n\u03b4 s\u2212(t+1) u(c(s)) +\n\n(c,\u03c0)\u2208At (x)\n\n=\n\nFtlR\n\nn\n\ni\nio\nlR\nFt\nio\n\nh\nu(c(t)) + \u03b4 \u0112 V (t + 1, \u03ba(x, c(t), \u03c0(t), Rl (t + 1)), %t+1 ) FtlR\n\n(c,\u03c0)\u2208At (x)\n\nUsing definition of \u039bt , it is easy to check that Ril (t + 1) has the density \u03c6\nunder the measure P\u0304 . Let us define\n\u03ba(t, x\u0302, \u0109, \u03c0\u0302, R\u0302) =\n\nN\nX\n\n\u03c0\u0302i e\n\nR\u0302i\n\n+ (x\u0302 \u2212\n\nsup\n\n\u03c0\u0302i \u2212 \u0109)(1 + r(t)).\n\ni=1\n\ni=1\n\n=\n\nN\nX\n\nn\nh \u0010\nu(c(t)) + \u03b4 \u0112 V t + 1, \u03ba(x, c(t), \u03c0(t), Rl (t + 1)),\n\n(c,\u03c0)\u2208At (x)\n\n\u03a6(*, Rl (t + 1))\n\u03c6(Rl (t + 1))\nsup\n(c\u0304,\u03c0\u0304)\u2208A(x)\n\nZ\nn\nu(c\u0304) + \u03b4\n\nZ\nRK\n\n\u0011\nio\n\u03a8(*, y)%t\u22121 (y)dy FtlR\n\n\u0010\n\nV t + 1, \u03ba(x, c\u0304, \u03c0\u0304, R\u0302),\n\nRN\n\n\u03a6(*, R\u0302)\n\u03c6(R\u0302)\n\nZ\n\u03a8(*, y)%t\u22121 (y)dy\nRK\n\nN\n\u0011Y\n\no\n\u03c6(R\u0302i )dR\u03021 * ... * dR\u0302N .\n\ni=1\n\n2\n\n9\n\n\f3.1. Quantization.\nThe set B 2 (F) is infinite dimensional. Hence, V in\nthe form of the equation 9 cannot be computed numerically. It has to be\napproximated by a sequence of the functionals V\u0302 on the finite state space. It\nis a very complex numerical problem. To this end, Runggaldier and Stettner\n[20] proposed the scheme for the numerical filtering based on the Hidden\nMarkov Model approach. They discretized the infinite-dimensional equation\nof the transition probabilities on the finite state space and then could solve\nthe dynamic programming equation on the set of vectors in RM . The grid\nwas chosen arbitrarily. The partition in this grid method is straightforward\nbut easily gets untractable as the number of nodes in the partition of the\ncodomain increases. With only 5 grids the number of the approximate value\nfunctions, which has to be computed amounts to 55 = 3125. 20 grids give\n104857600000000000000000000 variants!\nA much more applicable extension of this approach is the density quantization introduced to limit the number of the unnormalized densities in the\nset of arguments of the value function and to optimize the structure of the\ngrid.\nTo reduce dimensionality of our problem from the infinite to finite space\nwe follow the idea proposed by Stettner [24]. We discretize the codomain of\nthe densities %. We take a partition of each coordinate of RK , i.e. for the coor(j)\n(j)\n(j)\n(j)\ndinate j we take the set of mn increasing real numbers {zn (1), . . . , zn (mn )}.\nWe approximate random densities % by the functional on the grid\nK\nY\nK\nZn : =\n{zn(j) (1), . . . , zn(j) (m(j)\nn )} \u2282 R .\nj=1\n\nQ\n(j)\n(j)\nThe cubes Bn (k1 , . . . , kK ) : = K\nj=1 [zn (kj ), zn (kj + 1)] give the partition of\nthe support of \u03c1t . The sum of the sets Bn is denoted\n[\nBn =\nBn (k1 , . . . , kK ).\n(i)\n\n{(k1 ,...,kK )|1\u2264ki <mn }\n\nWe assume that\nlim vol(Bn ) = +\u221e,\n\nn\u2192+\u221e\n\n\u22001 \u2264 j \u2264 K\n\nlim\n\nmax\n\nn\u2192+\u221e i\u2208{1,...,m(j) \u22121}\nn\n\n10\n\n|zn(j) (i + 1) \u2212 zn(j) (i))| = 0.\n\n\fSimilarly, we define the partition of the codomain of \u03c1t : Gn : = {gn (1), . . . , gn (mn )}\nsuch that gn (i + 1) > gn (i), limn\u2192\u221e gn = \u221e and maxi |gn (i + 1) \u2212 gn (i)| \u2192 0\nas n tends to +\u221e.\nThe idea of the quantization is to focus attention on the set of density\nfunctions and to project all random densities on this set. Unlike in the\ngrid method where the projections are made inside every subset Bn on the\ngrid Gn , the number of outcomes can be quite small. Intuitively, under\nmild conditions the densities form a \"tight\" family of functions and many\nof them are very close to each other (in sup norm). There is no point in\ndistinguishing between them since they lead to similar value functions. The\nidea of quantization gave fruitful results in finding transition probabilities for\nnonlinear filters considered by Pag\u00e8s et al. [17]. It happens to be useful in\nthe dynamic programming as well.\nThe fundamental idea of the approach is to project random densities\non a set of functions that have only finitely many values and vanish at all\npoint sufficiently distant from 0. The set of functions will be called density\nquantization set (or shortly \u2013 quantization set).\nDefinition 3.1 (Density quantization set). Any set of functions q : RK \u2192\n(i)\nGn , which are constant on the sets Bn (k1 , . . . , kK ), ki \u2208 {1, . . . , mn } and are\nequal to 0 on Bcn is called density quantization set and is denoted Qn . The\nnumber of elements of the set Qn \u2013 #Qn \u2013 is denoted Nn and tends to +\u221e\nwith n \u2192 +\u221e.\nn\nThe projection ProjQ\nZn of a random density % on Qn is defined\nn\nProjQ\nZn [%] : = argmin{q\u2208Qn }\n\nmax\n(i)\n{(k1 ,...,kK )|1\u2264ki \u2264mn }\n\n|%(\u03c9, zn(1) (k1 ), . . . , zn(K) (kK ))\u2212\nq(zn(1) (k1 ), . . . , zn(K) (kK ))|.\n\nThe proper behavior of density quantization is guaranteed by the so-called\nZador Theorem [17]\nTheorem 3.1. Let X be n-dimensional random variable such that X \u2208 L2+\u03b4 ,\n\u03b4 > 0, with density fn . Let QK \u2282 Rn and the projection ProjQK : R \u2192 QK\nbe defined as ProjQK [x] = arg minq\u2208QK kq \u2212 xk. Then\n\u0012Z\n\u0013 n+2\nn\nn\n2\n2\n\u2212n\nfn (x) n+2 dx\n,\nDn (QK ) : =\nmin\nEkX\u2212ProjQK (X)k \u2264 K Jn *\n{QK |#QK =K}\n\nwhere Jn '\n\nRn\n\nn\n.\n2\u03c0e\n\n11\n\n\fThe quantity Dn (Qn ) is called the distortion of the quantization.\nThe straightforward application of the Zador Theorem gives very slow\nconvergence. The structure of the stock market model allows to show that,\nin fact, the numerical scheme have much better properties if we assume Lipschitz continuity of \u03a6(z, *)/\u03c6(*).\n(R)\nLet us discretize the space of values of R and consider the set Qn : =\n{r\u03041 , . . . , r\u0304n |r\u0304i \u2208 RN }. Let the function %\u0304 be defined as\nZ\n%\u0304(z, R\u0304) : = \u03a6(z, R\u0304)/\u03c6(R\u0304)\n\u03a8(z, y)%(y)dy.\nRK\n\nFrom now on, we can think about Gn as of the set generated implicitly by\n(R)\nQn , i.e.\nGn \u2261 {%\u0304(zn(j) (l), r\u0304i )|j \u2208 {1, . . . , n}, l \u2208 {1, . . . , m(j)\nn }, i \u2208 {1, . . . , n}}.\n(R)\n\nThe quantization set from definition 3.1, corresponding to Qn is denoted\nQQn(R) . The set of all the sets Qn is denoted SQ . A separate discretization\nis defined for the portfolio process X, but in the standard way followed in\nthe numerical solving of the dynamic programming equations (in the full\nobservation setting or even in the deterministic setting). The projection set\nX\nis QX\nn = {x1 , . . . , xn } and the set of the projection sets is denoted S .\nLet us define the sequence of functionals Vb on T \u00d7 R \u00d7 B 1 (F) as\nZ\nb\nuT (z, x)%(z)dz\nV (T, x, %) =\nRN\n\b\nVb (t, x, %) = sup u(c) + \u03b4 \u0112Vb (t + 1, ProjQX [xc,\u03c0 (R)], ProjQ [%(R)])(11)\nc,\u03c0\u2208A(t)\n\nNote that\nV (T, x, %) = Vb (T, x, %)\nfor x \u2208 QX and % \u2208 Q. In the following part of the subsection we showed\nthat Vb approximates V .\nFor brevity, if it does not lead to confusion, let us denote x\nb : = ProjQX [x]\nand %b: = ProjQ [%].\nLemma 3.2. If uT (*, z) is L2 -Lipschitz continuous and bounded by L1 then\nZ\n2\n2\nb\n|%1 (z) \u2212 %b2 (z)|dz + 2L22 |x1 \u2212 x\nb2 |.\n|V (T, x1 , %1 ) \u2212 V (T, x2 , %2 )| \u2264 2L1\nRK\n\n12\n\n\fProof:\nZ\nZ\n2\n2\nb\n|V (T, x1 , %1 ) \u2212 V (T, x2 , %2 )| =\nu(x1 , z)%1 (z)dz \u2212\nu(b\nx2 , z)b\n%2 (z)dz <\nRK\nRK\nZ\n|u(x1 , z)%1 (z) \u2212 u(x1 , z)b\n%2 (z) + u(x1 , z)b\n%2 (z) \u2212 u(b\nx2 , z)b\n%2 (z)|2 dz \u2264\nRK Z\nb2 |2 .\n(12)\n2L21\n|%1 (z) \u2212 %b2 (z)|2 dz + 2L22 |x1 \u2212 x\nRK\n\n2\nDefinition 3.2. The value function v is (\u000f, c0 , c1 )-Lipschitz continuous if\nand only if there exist constants c0 and c1 such that for each pair (x1 , x2 ) and\n(%1 , %2 )\nZ\n2\n2\n|v(x1 , %1 ) \u2212 vb(x2 , %2 )| < \u000f + c0 |x1 \u2212 x2 | + c1\n|%1 (z) \u2212 %2 (z)|2 dz.\nRK\n\nLemma 3.3. Let %\u0304(z, *) be Lipschitz continuous and is p-decaying for p > N\ni.e.\n\u2203az > 0 %\u0304(z, x) < az |x|\u2212p .\n\u0001K\nLet us assume that vol(B(~k)) \u2264 M0 . Let us denote the distribution of\n1\n\n(c\u0304,\u03c0\u0304)\n\n(c\u0304,\u03c0\u0304)\n\nn\n\n1\n\nx1 (R) by fX\u03c0\u0304 1 \u2208 L 3 and x2 (R) by fX\u03c0\u0304 2 \u2208 L 3 . Then, for (\u000f, Lx , L% )Lipschitz continuous function V\nerr n : =\n\n(c\u0304,\u03c0\u0304)\n\nmin\n\n{QX \u2208S X |#QX =n}\n\n\u0112 V (t, x1\n\n(R), %1 (R))\u2212\n\n{Q\u2208SQ |#Q=n}\n2\nQ\n(c\u0304,\u03c0\u0304)\nVb (t, ProjQX [x2 (R)], ProjZnQ [%2 (R)]) \u2264\nZ\n2\n2\n2 2\n2Lx (1 + r(t)) |x1 \u2212 x2 | + 2L% L\u03a6 L\u03a8\n|%1 (z) \u2212 %2 (z)|2 dz +\nK\nR\n\u0012Z\n\u00133\n\u0012\n\u0013K+1\n\u221a\n1\nM0\n\u22122\n2\nLx n J1 *\nfX (x) 3 dx + 2L% LR K\n+\nn\nR\n\u0012Z\n\u0013 NN+2\nN\n2\nM N \u2212p\nK \u2212N\nmax\nN\n+2\ndx\n4L% M0 n JN\nfzk (x)\n+ 2L% az vN 0\n+ \u000f,\np\u22121\nRN\n\nwhere\nvN =\n\n\uf8f1\n\uf8f2\n\uf8f3\n\nN \u22122\n\n(2\u03c0) 2 +1\n,\n(N \u2212p)(N \u22122)!!\nN \u22121\nN \u22123\n2 2 +1 \u03c0 2\n\n(N \u2212p)(N \u22122)!!\n\n13\n\nif N = 2k\n\n, if N = 2k + 1\n\n\fand fzmax\nis density of %(R)(zk ) for k such that\nk\n(\u0012Z\nk = arg maxi\nRN\n\nN\n(x) N +2 dx\nfzmax\ni\n\n\u0013 NN+2 )\n.\n\nProof: By Lipschitz continuity of V and the the inequality |a\u2212b|2 \u2264 2a2 +2b2\n(c\u0304,\u03c0\u0304)\n\n\u2206V : = |V (t, x1\n\n(c\u0304,\u03c0\u0304)\n\n\u000f + 2Lx |x1\n\n(c\u0304,\u03c0\u0304)\n4Lx |x1 (R)\n\nZ\n4L%\n\n(c\u0304,\u03c0\u0304)\n\n(R), %1 (R)) \u2212 Vb (t, ProjQX [x2\n(c\u0304,\u03c0\u0304)\n\n(R) \u2212 ProjQ [x2\n(c\u0304,\u03c0\u0304)\nx2 (R)|2\n\n(R)]|2 + 2L%\n\n4L%\n\nQ\n\nRK\n\n|%(R)(z) \u2212 ProjZnQ [%(R)](z)|2 dz \u2264\n\n(c\u0304,\u03c0\u0304)\n4Lx |x2 (R)\n\n(c\u0304,\u03c0\u0304)\n\n\u2212 ProjQX [x2 (R)]|2 +\nXZ\n2\n|%2 (R)(z) \u2212 gk |2 dz +\n|%1 (R)(z) \u2212 %2 (R)(z)| dz + 4L%\n\u2212\n\n+\n\nRK\n\nZ\n\nQ\n\n(R)], ProjZnQ [%2 (R)])|2 \u2264\n\nZ\n\n~k\u2208K\u0302n\n\nB(~k)\n\n%(R)2 (z)dz\n\nBcn\n\nfor a set of gk s, gk \u2208 Gn .\nFirstly, let us make an easy observation that\n(c\u0304,\u03c0\u0304)\n\n|x1\n\n(c\u0304,\u03c0\u0304)\n\n(R) \u2212 x2\n\n(R)|2 = (1 + r(t))|x1 \u2212 x2 |2 .\n\nSecondly, we can use the quantization on QX to estimate the approximation\n(c\u0304,\u03c0\u0304)\n(c\u0304,\u03c0\u0304)\nof the random variable x2 (R) with ProjQX [x2 (R)]. Since x(c\u0304,\u03c0\u0304) (R) is the\nsum of the random variables of the form pi exp(R), R \u223c \u03c6(*), then from the\nZador theorem (see theorem 3.1) we get\nmin\n\n(c\u0304,\u03c0\u0304)\n\n{QX \u2208S X |#QX =n}\n\n\u0112|x2\n\n(c\u0304,\u03c0\u0304)\n\n(R) \u2212 ProjQX [x2\n\u22122\n\nmax\n\n(p1 ,...,pN )\u2208[0,x2 ]N\n(e)\n\n\u0012Z\n\nn J1\n\n(R)]|2 \u2264\n\nfXp12,...,pN (x)\n\n\u0001 31\n\n\u00133\ndx\n\n,\n\n(13)\n\nR\n\n(e)\n\nwhere fXp12,...,pN (*) : = (\u03c6p1 \u2217 ... \u2217 \u03c6pN )(*) is the convolution of densities of the\nrandom variables pi exp(R). The maximum always exists and we skipped the\njustification to the remark 3.1. We denoted the corresponding fXp12,...,pN by\nfX .\n\n14\n\n\fThirdly, by the assumption [A2]\nZ\n\n|%1 (R)(z) \u2212 %2 (R)(z)|2 dz =\n\nRK\n\n\u00152\nZ\n\u03a6(z, R(l) )\n\u03a8(z, y)%1 (y)dy \u2212\n\u03a8(z, y)%2 (y)dy dz \u2264\n\u03c6(R(l) ) RK\nRK\n\u0012Z\n\u00132\nZ\n\u03a62 (z, R(l) )\n2\n2 2\ndzL\u03a8\n|%1 (y) \u2212 %2 (y)| dy \u2264 L\u03a6 L\u03a8\n|%1 (z) \u2212 %2 (z)|2 dz\n\u03c62 (R(l) )\nRK\nRK\n\n\u0014\n\nZ\nRK\n\nZ\nRK\n\n\u03a6(z, R(l) )\n\u03c6(R(l) )\n\nZ\n\nFinally, since %2 (R) is globally Lipschitz continuous (there is a common\nLipschitz constant LR for all R(\u03c9)),\nZ\nZ\n2\n|%2 (R)(z) \u2212 gk | dz \u2264 2\n|%2 (R)(z) \u2212 %2 (R)(zn )|2 dz+\nB(~k)\n\nB(~k)\n\n2vol(B(~k))|%2 (R)(zn ) \u2212 gn |2 \u2264 2L2R vol(B(~k))diam(B(~k))2 +\n2vol(B(~k))|%2 (R)(zn ) \u2212 gn |2\nThen,\nZ\n\n|%1 (z) \u2212 %2 (z)|2 dz+\nRK\n\u00133\n\u0012Z\n1\n2\n2\n\u22122\n~\n~\n2L% LR vol(B(k))diam(B(k)) + 2Lx n J1\n(fX (x)) 3 dx +\nR\n\uf8ee\n\uf8f9\nZ\nX\n2\uf8fb\n2 \uf8f0\n~\nmin\nvol(B(k))|%(R)(zk ) \u2212 gk | + 2L%\n%(R)2 (z)dz.\n4L% E\n\nerr n \u2264 \u000f + 2Lx (1 + r(t))|x1 \u2212 x2 | +\n\n{Q\u2208SQ |#Q=n}\n\n2L% L2\u03a6 L2\u03a8\n\nBcn\n\n~k\u2208K\u0302n\n\nP\nThe sign \" \" can be swapped with \"min\" since for each 2 elements of the\nsum, the minimum is calculated with respect to 2 different arguments. Zador\n\n15\n\n\fTheorem and assumption on B(~k) imply\nZ\n\n|%1 (z) \u2212 %2 (z)|2 dz\nerr n \u2264 \u000f + 2Lx (1 + r(t)) |x1 \u2212 x2 | +\nRK\n\u0012Z\n\u00133\n\u0012\n\u0013K\n\u0013\n\u0012\n\u221a\n1\nM0\nM0\n\u22122\n2\nLx n J1 *\nfX (x) 3 dx + 2L% LR\n* K\n+\nn\nn\nR\n\u0013K\n\u0013 NN+2\n\u0012\nZ\nX \u0012Z\nN\n2\nM0\n\u2212N\nN\n+2\nfzk (x)\nn JN *\ndx\n+ 2L%\n%(R)2 (z)dz\n4L%\nn\nN\nc\nR\nB\nn\n~k\u2208K\u0302n\nZ\n\u2264 \u000f + 2Lx (1 + r(t))2 |x1 \u2212 x2 |2 + 2L% L2\u03a6 L2\u03a8\n|%1 (z) \u2212 %2 (z)|2 dz\nRK\n\u0012\n\u0013K+1\nZ \u0010\n\u0011\n\u221a\n3\n1\nM0\n\u22122\n2\nLx n J1 *\nfX (x) 3 dx + 2L% LR K\n+\nn\nRK\n\u0013 NN+2\n\u0012Z\nZ\nN\n2\nK \u2212N\nmax\n4L% M0 n JN\n+ 2L% az\n|x|\u2212p dx\nfzk (x) N +2 dx\n2\n\n2\n\n2L% L2\u03a6 L2\u03a8\n\n[M0 ,+\u221e)N\n\nRN\n\nThe calculation of the constant vN is left to the Appendix.\n\n2\n\nR\n(e)\nRemark 3.1. The minimum with respect to pi s in formula 13 R (((\u03c6p1 \u2217 ... \u2217\n1\n(e)\n\u03c6pN ))(x)) 2 dx always exists. Let us show it in the case of N = 2. The other\ncases are analogous.\nWe have\nZ\n\u0001 12\n(e)\ndx\nF (p1 , p2 ) : =\n((\u03c6(e)\n\u2217\n...\n\u2217\n\u03c6\n))(x)\np1\np2\nR\n\nZ \u0012Z\n=\nR\n\nR\n\n1 (e)\n\u03c6\np1 p2\n\n\u0012\n\n(e)\n\nx\u2212z\np1\n\n\u0013\n\n(e)\n\n\u03c6\n\n\u0012\n\nz\np2\n\n\u0013 21\n\n\u0013\ndz\n\ndx\n\n(14)\n\nand obviously, by the definition of \u03c6p , F (0, p2 ) = F (p1 , 0) = 0. It is\nstraightforward that F is continuous on the compact set [p\u03041 , x1 ] \u00d7 [p\u03042 , x2 ]\nand f |[p\u03041 ,x1 ]\u00d7[p\u03042 ,x2 ] attains the maximum.\nTo show that F has maximum on [0, x1 ] \u00d7 [0, x2 ] it is sufficient to prove\nthat F has negative (and continuous) partial derivatives on (0, p\u03041 )\u00d7(0, p\u03042 ), for\nsome p\u03041 and p\u03042 . Let us concentrate on the partial derivative with respect to p1 .\nFirstly, we majorize \u03c6(e) by an integrable function \u03c6\u0302(e) with the monotone tails\nin the sense that for every i \u03c6\u0302(e) (x1 , . . . , xi\u22121 , *, xi+1 , . . . , xN ) is increasing\n16\n\n\ffor sufficiently large negative arguments and decreasing for sufficiently large\npositive ones. It is always possible for the bounded density function. For\nsome mild conditions we can swap the derivative and integrals.\n\u0012\n\u0012 \u0013 \u0013\u2212 12\n\u0012Z\n\u0013\nZ\nz\n1\n1 (e) x \u2212 z\n\u2202F (p1 , p2 )\n(e)\n=\n\u03c6\u0302\n\u03c6\u0302\ndz\n*\n\u2202p1\np1\np2\nR 2\nR p1 p2\n\u0012\n\u0012\n\u0012 \u0013\n\u0014\n\u0013\n\u0013\n\u0015\nZ\n1\nx \u2212 z x \u2212 z (e) z\n1 (e) x \u2212 z\n(e)\n*\n\u2212 2 \u03c6\u0302\n\u2212 \u2207\u03c6\u0302\n\u03c6\u0302\ndzdx.\np1\np1\np1\np31\np2\nR p2\nThe expression in the square brackets is negative for sufficiently small p1 .\nThe first\u0010 component\nis always\nnegative. If xi \u2212 zi \u2265 0 than for p1 large\n\u0011\n\u0010\n\u0011\n(e) x\u2212z\nxi \u2212zi\n\u2207\u03c6\u0302i\n\u2264 0. On the other hand, xi \u2212 zi < 0 implies\nenough\np1\np1\n\u0012\n\u0013\n\u0012\n\u0013\nxi \u2212 zi\nx\u2212z\n(e)\n\u2207\u03c6\u0302i\n> 0.\np1\np1\nThus, on [0, p\u03041 ] \u00d7 [0, p\u03042 ], F is bounded by a function that has the maximum\nvalue. This completes the proof.\nA direct consequence of lemma 3.2 is the following estimate of the approximation error of the algorithm.\nTheorem 3.2. For uT (*, z) Lu -Lipschitz continuous and uT (*, *) bounded by\n(b)\nLu ,\nT\n\n1\u2212\u03b4\nCn,M0 +\n|V (0, x, %) \u2212 Vb (0, x\nb, %b)|2 < \u03b4\n1\u2212\u03b4\n(1)\nLT |x\n\n2\n\n\u2212x\nb| +\n\n(2)\nLT\n\nZ\n\n|%(z) \u2212 %b(z)|2 dz, (15)\n\nRK\n\nwith\nCn,M0\n\n\u0012Z\n\n\u22122\n\nLu n J1 *\n\n:=\n\n1\n3\n\n\u00133\n\nfX (x) dx\n\n+\n\n2\n2L(b)\nu LR\n\n\u221a\n\n\u0012\nK\n\nR\nK\n4L(b)\nu M0 n\n\n(1)\nLT\n(2)\nLT\n\n:= 2\n\nT +1 T\n\n:= 2\n\nT +1 T\n\n\u03b4\n\n\u03b4\n\nL2u\n\n2\n\u2212N\n\n\u0012Z\nJN\nRN\n\nfzmax\n(x)\nk\n\nT\nY\n(1 + r(t)),\n\nt=1\n\u0001\n(b) 2\nLu\n\n2T\nL2T\n\u03a6 L\u03a8 .\n\n17\n\nN\nN +2\n\n\u0013 NN+2\ndx\n\nM0\nn\n\n\u0013K+1\n+\n\nM0N \u2212p\n+ 2L(b)\na\nv\nu z N\np\u22121\n\n!\n,\n\n\fProof: Let us suppose that the projections \"b*\" realizes the minimal error over\nthe set of projection sets and V (t + 1, *, *) is (\u000f, Lx , L% )-Lipschitz continuous.\nIn this case, applying lemma 3.2,\n|V (t, x, %) \u2212 Vb (t, x\nb, %b)|2\nn\n\u0010\nu(c) + \u03b4 \u0112V (t + 1, x(R), %(R)) \u2212\n\u2264\nsup\n(c,\u03c0)\u2208At (x)\u222aAt (b\nx)\n\no\u00112\n[\n[\nb\n+u(c) \u2212 \u03b4 \u0112V (t + 1, x(R), %(R))\n\u001b\n2\n[\n[\nb\n\u2264\nsup\n\u03b4 \u0112 V (t + 1, x(R), %(R)) \u2212 V (t + 1, x(R), %(R))\n(c,\u03c0)\u2208At (x)\u222aAt (b\nx)\nZ\n2\n2\n2 2\n= \u03b4\u000f + \u03b4Cn,M0 + 2\u03b4Lx (1 + r(t)) |x \u2212 x\nb| + 2\u03b4L% L\u03a6 L\u03a8\n|%(z) \u2212 %b(z)|2 dz.\n\u001a\n\nRK\n\nThus, V (t, *, *) is (\u03b4\u000f + \u03b4Cn,M0 , 2\u03b4Lx (1 + r(t))2 , 2\u03b4L% L2\u03a6 L2\u03a8 )-Lipschitz continuous. By induction the proof is completed.\n2\n4. Numerical illustration\nWe show the performance of the algorithm for an arbitrary parametrization of the model. We consider the market for only one risky asset with the\nstochastic volatility driven by the one dimensional process y. Even in this\ncase, the computation of the optimal consumption / investment paths is very\nmuch time consuming for the algorithm implemented on a regular computer1 .\nWe assume that the dynamics of the market specified in general terms in\nthe subsection 1 is given by the following system of the three equations:\nS0 (t + 1)\nS1 (t + 1)\nS1 (0)\nY (t + 1)\nY (0)\n\n=\n=\n=\n=\n=\n\n(1 + 0.03)t+1 ,\n\b\nS1 (t) exp 0.05 + 0.25(1 \u2212 0.75 exp{\u2212Y (t + 1)2 })\u000f(t + 1) ,\n6.00,\n0.80 * Y (t) + 0.20\u03be(t + 1),\n1.50.\n(16)\n\nThe risk-free interest rate (the bank account interest) is equal to 3%. We\nassume that the mean log rate of return from the risky asset is 5%. The\n1\n\n1.6MHz dual core processor with 2GB RAM.\n\n18\n\n\f8\n4\n\nS_1\n\n12\n\nFigure 1: A trajectory of the price process and underlying parameter y, i.e. trajectory of\nthe stochastic volatility.\n\n\u22120.2\n\u22120.8\n\ny\n\n0.4\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\ntime\n\n\u25cf\n\u25cf\u25cf\n\u25cf \u25cf\u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\u25cf\n\u25cf\n\u25cf\u25cf\n\u25cf\u25cf\n\u25cf \u25cf\u25cf\n\u25cf\u25cf\n\u25cf \u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf \u25cf\n\u25cf\n\u25cf\u25cf \u25cf \u25cf\u25cf\n\u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf \u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf \u25cf\n\u25cf \u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\u25cf\n\u25cf\u25cf \u25cf \u25cf \u25cf\u25cf\n\u25cf\u25cf\n\u25cf \u25cf\n\u25cf\n\u25cf\u25cf \u25cf\u25cf \u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf\u25cf\n\u25cf \u25cf\u25cf\u25cf \u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf \u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\nSource: own calculations\n\nvolatility of the risky asset can vary a lot in the model. It can be as large\nas almost 16% for Y (t) = 0.8 and as low as 6% if Y (t) = 0.0. For the\nparametrization in the equation 16 trajectories of Y usually oscillates within\n-0.8 and 0.8 bounds.\nThe variability of Y is visibly reflected into the volatility of S1 . A sample\ntrajectory of S1 is shown on figure 1.\nThe utility functions meeting the requirements of boundedness and Lipschitz continuity demanded in the assumptions of the theorem 3.2 (in fact\nthe lemma 3.2) were chosen to be the following:\n\u0012\nuT (y, x) =\n\n2 exp(\u2212y)x\n1 + 2 exp(\u2212y)x\n\n\u00130.5\n\n\u0012\nand u(x) = 0.25\n\nx\n2+x\n\n\u00130.5\n. (17)\n\nThis are the utility function of the so-called IRRA type, i.e. the increasing\nrelative risk aversion.\nThe numerical algorithm to calculate the approximate optimal consumption / investment strategies was based on the backwards dynamic programming equation 11. We compute Vb recursively for 10 points of time with the\ntime horizon T = 10. At each point of time equation 11 give us the estimates\nof the consumption c and the investment \u03c0 maximizing his joint utility.\n19\n\n\f2\n0\n\n1\n\nQ_ZERO\n\n3\n\n4\n\nFigure 2: The initial quantization set Q0n (top graph) and the approximation of the optimal\nquantization set in the stochastic gradient descent methods in 500 steps (bottom graph)\n\n\u22121.5\n\n\u22121.0\n\n\u22120.5\n\n0.0\n\n0.5\n\n1.0\n\n1.5\n\n0.5\n\n1.0\n\n1.5\n\n2\n0\n\n1\n\nQ_OPT\n\n3\n\n4\n\nZns\n\n\u22121.5\n\n\u22121.0\n\n\u22120.5\n\n0.0\n\nSource: own calculations\n\nKeeping in mind the complexity of the calculation of Vb (t, x\nb, %b) based on\nb\nV (t+1, *, *) we have to chose a limited number of nodes for the portfolio value\nx and the beliefs %. To make the calculation tractable, we assume that the\nquantization set of the portfolio process X is QX : = {0.00, 0.25, 0.50, . . . , 9.75, 10.00}.\nThe investor's beliefs described by the unnormalized densities are projected\non the appropriate quantization.\nSince the minimal error in the approximate algorithm described by the\nrecursion 11 is realized for the optimally chosen quantization set we apply the\nstochastic gradient descent algorithm to find the optimal structure (compare\nPag\u00e8s and Pham [18]). We start with the initial arbitrary set of the densities\nQ0n evaluated at the points from Zn : = {\u22121.50, \u22121.45, \u22121.40, . . . , 1.45, 1.50}.\nWe choose the parameters \u2013 the mean and the standard deviation \u2013 to be\nthe equidistant point on the real line, i.e. the mean took values in the set\n{\u22121.50, \u22121.25, . . . , 1.50} and the standard deviation in the set {0.1, 0.3, 0.5, 0.7, 0.9}.\nThe densities are presented on figure 2, top panel.\nThe procedure requires to construct the incremental function H which\ndefines the corrections of Q0n leading in the limit to the optimal quantization\nset. The incremental function is derived by the formal differentiation under\n\u0112 of the distortion function Dn (Q) for a given realization r\u0302 of return Rl .\n20\n\n\f2\n0\n\n1\n\nQ_ESS\n\n3\n\n4\n\nFigure 3: The selection of the essential elements of the quantization set Q500\n(25 out of\nn\n65 elements)\n\n\u22121.5\n\n\u22121.0\n\n\u22120.5\n\n0.0\n\n0.5\n\n1.0\n\n1.5\n\nZns\n\nSource: own calculations\n\nNamely, in the special case of 1-dimensional process Y any quantization set\nQ can be represented by the matrix from Mn\u00d7mn where (k, m) element is\ndefined as the value of the kth element of the set Q evaluated at the mth\nargument from Zn . Then, the function H : Mn\u00d7mn \u00d7 R \u2192 Mn\u00d7mn is defined\nas\n\u2202\nHk,m (Q, r\u0302) : =\n%(zk , r\u0302) (%(zk , r\u0302) \u2212 gm (k)) .\n\u2202r\u0302\nSince in the example the densities \u03c6 and \u03c8 in the example are smooth then the\nderivative of % is well-defined. Then\n{\u03b2i }i\u2208N satisfying\nP for a given sequence\nP 2\nthe usual regularity conditions ( \u03b2i = \u221e and\n\u03b2i < \u221e) the following\nsequence of the quantization sets converge to the optimal one (see Shapiro\nand Wardi [22] for convergence results):\n\b\nm\nl\nQm+1\n= max Qm\nn\nn + \u03b2m+1 H(Qn , R (\u03c9m+1 )), 0 .\nApplying this recursive procedure for Qm\nn with 500 iterations of m we obtain the modified set Q500\nwhich\nis\ngraphically\npresented on figure 2, bottom\nn\n500\npanel. Firstly, one crucial advantage of Qn is the reduction of the domain\nof the densities from the initial [\u22121.5, 1.5] to [\u22120.5, 0.5] where they are essentially different from 0. This decreases the dimensionality of the numerical\nproblem since the same number of points Zn can be denser allocated on the\nsmaller interval [\u22120.5, 0.5]. Secondly, we can drop the densities from Q500\nn\nwhich are very similar to each other and we take into account only a subset\n500\nif the densities. Namely, we apply the following procedure:\nQess\nn \u2282 Qn\n500\n1. Qess\nn : = Qn ; eps=0.1;\n2. REPEAT i\n\n21\n\n\fFigure 4: Evolution of beliefs with prior at time T \u2212 9 equal to the normal distribution\nwith mean 0.1 and standard deviation 0.2\n0.08\n0.06\n0.04\n0.02\n\n0.07\n0.06\n0.05\n0.04\n0.03\n0.02\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n0.004\n0.003\n0.002\n0.001\n\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\nT\u2212 8\n\nT\u2212 7\n\n\u25cf\n\n\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n0.6\n0.5\n0.4\n0.3\n0.2\n0.1\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\n0.09\n0.08\n0.07\n0.06\n0.05\n0.04\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\n\u25cf\n\u25cf\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\n0.35\n0.30\n0.25\n0.20\n0.15\n0.10\n\n\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\nT\u2212 3\n\n\u25cf\u25cf\n\n\u25cf\n\n0.15\n\u25cf\n\n0.10\n\n\u25cf\n\u25cf\n\n\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\u25cf\u25cf\n\n0.20\n\n\u25cf\n\n\u25cf\u25cf\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\nT\u2212 4\n\n\u25cf\n\n\u25cf\n\u25cf\n\n\u25cf\n\n\u25cf\n\n\u25cf\n\nT\u2212 6\n\n\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\nT\u2212 5\n0.25\n0.20\n0.15\n0.10\n0.05\n\n\u25cf\u25cf\n\n\u25cf\n\u25cf\u25cf\n\n0.008\n0.006\n0.004\n0.002\n\n\u25cf\n\u25cf\n\n0.05\n\n\u25cf\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\u25cf\n\n\u25cf\u25cf\n\n\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\n\n\u25cf\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\n\u22120.45 \u22120.15 0.1 0.3 0.5\n\nT\u2212 2\n\nT\u2212 1\n\nT\u2212 0\n\nNote: Each box shows a density which is recursively obtained using equation 7, i.e.\nthe density on the box T \u2212 n is obtained from the formula 7 with %T \u2212n\u22121 equal to\nthe density from the box T \u2212 n \u2212 1 and %T \u22129 \u2261 \u03c60.1,0.2 .\nSource: own calculations\n\n3. Chose\na pair of densities q1 \u2208 Q\u0304ess and q2 \u2208 Q\u0304ess ;\nP\n|q1 (z)\u2212q2 (z)|\n\nPn\n4. IF z\u2208Z\nz\u2208Zn |q1 (z)|\n5. i:=i+1;\n6. UNTIL i==5000;\n\ness\n<eps THEN Qess\nn : = Qn /{q2 };\n\nthe application of which gives the quantization set consisting of 25 unnormalized densities.\nIt should be underlined that functions % representing the beliefs about\nY , described by recursion 7, are not necessarily densities. They are unnormalized densities. An example of the evolution of beliefs is presented on the\nfigure 4.\nThe number of nodes of the portfolio values, which is 41, multiplied by\nthe number of the densities in the density quantization set equal to 25 gives\n1025 arguments of Vb (t, *, *).\nSearching for the optimal consumption and investment for a given point\nof time t, the current wealth x\u0304 and the beliefs about the unobserved factors\ndriving the volatility on the market, we discretize the space of investors deci22\n\n\fFigure 5: Distribution of the optimal consumption for different points of time\n\n1.25\n\n1.1\n0.35\n\nconsumption (units),T\u22124\n\nconsumption (units),T\u22122\n\n0.09\n\n0.09\n\n0.06\n\n0.03\n\n800\n600\n400\n200\n0\n0\n\n0.24\n\n0.18\n\n0.12\n\n0\n\n0.06\n\nconsumption (units),T\u22123\n\n0.2\n\n0.05\n\n0.6\n\n0.45\n\nconsumption (units),T\u22125\n500\n400\n300\n200\n100\n0\n\n0.06\n\nconsumption (units),T\u22126\n800\n600\n400\n200\n0\n\nconsumption (units),T\u22127\n800\n600\n400\n200\n0\n\n0.3\n\n0.75\n\n0.45\n\n0.6\n\n800\n600\n400\n200\n0\n\n0.95\n\n0.8\n\n1.38\n\nconsumption (units),T\u22128\n800\n600\n400\n200\n0\n\n0.03\n\nconsumption (units),T\u22129\n\n1.32\n\n600\n500\n400\n300\n200\n100\n0\n1.26\n\n2\n\n700\n600\n500\n400\n300\n200\n100\n0\n\n0\n\n1000\n800\n600\n400\n200\n0\n\nconsumption (units),T\u22121\n\nNote: histograms for 1000 simulation of the risky asset dynamics. T \u2212 n means n\ntime periods before the time horizon T .\nSource: own calculation\n\nsions. We were looking for the maximum expected value of the value function\nVb (t+1, xc,\u03c0 (t+1), %t+1 ) among c \u2208 {0.00x\u0304, 0.05x\u0304, 0.10x\u0304, . . . , 0.95x\u0304, 1.00x\u0304} and\n\u03c0 \u2208 {0.00x\u0304, 0.05x\u0304, 0.10x\u0304, . . . , 0.95x\u0304, 1.00x\u0304}.\nThe four main components of the solution of the numerical optimization\nwere presented: the consumption, the investment in the risky asset and the\nrisk-free asset and the value of the optimal portfolio. Assuming that the\ninvestor possesses 6 units of the initial capital we generated his wealth paths\nalong the estimated consumption and investment policies. We perform 1000\nsimulations of the risky asset prices and we construct the corresponding consumption and investment paths according to the approximate optimal policy.\nThe results of the simulation suggest that the optimally behaving investor\nconsume about half of the initial wealth during the first two periods and then\ngradually decreases the consumption rate (see figure 5). In the period t = 6\nthe investor is left with less then 1 units of wealth. In the last three periods\nhe consumes only about 0.1 units of his portfolio, almost irrespective of the\nmarket situation (i.e. independent of the evolution of the risky asset prices).\nConversely, his investment decisions are much more dependent on the\nmarket trends and on the time of decision making. His stronger beliefs about\n23\n\n\fFigure 6: Distribution of the optimal investment into the risky asset for different points\nof time\n\nrisky asset (units), T\u22128\n\nrisky asset (units), T\u22126\n\n0.9\n\n0.6\n\nrisky asset (units), T\u22127\n\n0.00\n\n1000\n800\n600\n400\n200\n0\n0.00\n\n0.00\n\n1000\n800\n600\n400\n200\n0\n\nrisky asset (units), T\u22125\n\nrisky asset (units), T\u22124\n\n0.00\n\n1000\n800\n600\n400\n200\n0\n0.00\n\n1000\n800\n600\n400\n200\n0\n0.00\n\n1000\n800\n600\n400\n200\n0\n\n0\n\n1.8\n\n1.2\n\n0\n\nrisky asset (units), T\u22129\n1000\n800\n600\n400\n200\n0\n\n600\n500\n400\n300\n200\n100\n0\n0.6\n\n1\n\n800\n600\n400\n200\n0\n\n0.3\n\n1000\n800\n600\n400\n200\n0\n\nrisky asset (units), T\u22123\n\nrisky asset (units), T\u22122\n\nrisky asset (units), T\u22121\n\nNote: histograms for 1000 simulation of the risky asset dynamics. T \u2212 n means n\ntime periods before the time horizon T .\nSource: own calculation\n\nunfavorable volatility (about y) decrease his propensity to invest into the\nrisky asset. The investor allocates quite a small part of his wealth in the\nrisky project S1 only in the first two periods (see figure 6). The closer to the\nterminal time T the more he is inclined to allocate his current wealth into\nthe risk-free asset S0 (see figure 7). As the figure 8 indicates, the terminal\nwealth reaches almost 0 units.\nEven though the set of beliefs seems to be only roughly approximated\nby 30 density functions, the simulation reflects the behavior of a rational investor in a quite reasonable and intuitive way. However, the computational\nburden of the numerical procedure makes it difficult to support investment\ndecisions on a market for multiple assets unless the complexity of the stochastic volatility part of the model is substantially reduced. In fact the minimal\nerror of the estimate of the value function V that can be attained in the\nnumerical example and given by the constant Cn.M0 multiplied by the factor\nT\n(see theorem 3.2) is equal to 0.81 which is about 12% of the utility of\n\u03b4 1\u2212\u03b4\n1\u2212\u03b4\nthe initial wealth.\nHowever, the proposed quantization framework follows the promising av-\n\n24\n\n\fFigure 7: Distribution of the optimal investment into the risk-free asset for different points\nof time\n\nrisk\u2212free asset (units), T\u22128\n300\n250\n200\n150\n100\n50\n0\n\nrisk\u2212free asset (units), T\u22125\n150\n100\n50\n0\n\nrisk\u2212free asset (units), T\u22122\n\n2.2\n\n1.6\n0.45\n\n0.3\n\n0.09\n\n0.06\n\n0.03\n\n0.12\n\n0.09\n\n0.06\n\n0\n\nrisk\u2212free asset (units), T\u22123\n\nrisk\u2212free asset (units), T\u22124\n150\n100\n50\n0\n\n0.03\n\n0.18\n\n0.12\n\n0\n\n0.06\n\n150\n100\n50\n0\n\n0.15\n\n0\n\n0.8\n\n0.5\n\n0.65\n\n0.2\n\nrisk\u2212free asset (units), T\u22126\n\nrisk\u2212free asset (units), T\u22127\n300\n250\n200\n150\n100\n50\n0\n\n0.35\n\n1.4\n\n1.1\n\n0.8\n\n0.5\n\n400\n300\n200\n100\n0\n\n1\n\n2.4\n\n1.8\n\n1.2\n\n0\n\n0.6\n\n2\nrisk\u2212free asset (units), T\u22129\n\n0.4\n\n600\n500\n400\n300\n200\n100\n0\n\n400\n300\n200\n100\n0\n\n0\n\n1000\n800\n600\n400\n200\n0\n\nrisk\u2212free asset (units), T\u22121\n\nNote: histograms for 1000 simulation of the risky asset dynamics. T \u2212 n means n\ntime periods before the time horizon T .\nSource: own calculation\nFigure 8: Distribution of the optimal value of portfolio for different points of time\n\nportf. value (units),T\u22127\n\n1.44\n\n1.41\n\n1.38\n\n1.35\n\nportf. value (units),T\u22123\n\n0.02\n\n0.02\n\n0.01\n\n0.01\n\n0.01\n\n0.04\n\n0.03\n\n0.02\n\n0.02\n\n0.01\n\n0\n\nportf. value (units),T\u22121\n\n0\n\n25\n20\n15\n10\n5\n0\n0.01\n\n0\n0.01\n0.01\n0.02\n0.02\n0.03\n0.04\n0.04\n0.05\n0.05\nportf. value (units),T\u22122\n\n1.32\n\n0.01\n0.02\n0.04\n0.05\n0.06\n0.08\n0.1\n0.11\n\n0.41\n\n0.38\n\n0.35\n\n0.32\n\nportf. value (units),T\u22124\n40\n30\n20\n10\n0\n\n0\n\nportf. value (units),T\u22125\n14\n12\n10\n8\n6\n4\n2\n0\n\nportf. value (units),T\u22126\n20\n15\n10\n5\n0\n\n0.28\n\n0.74\n\n0.71\n\n0.68\n\n0.65\n\n0.62\n\n0.59\n\n40\n30\n20\n10\n0\n\n1.29\n\n1.26\n\n2.28\n\n2.25\n\n2.22\n\n2.19\n\n2.16\n\n2.1\n\nportf. value (units),T\u22128\n2.0\n1.5\n1.0\n0.5\n0.0\n\n3.0\n2.5\n2.0\n1.5\n1.0\n0.5\n0.0\n2.13\n\n3.66\n\n3.65\n\n3.63\n\n3.62\n\n3.6\n\n3.59\n\n3.0\n2.5\n2.0\n1.5\n1.0\n0.5\n0.0\n3.57\n\n5\n4\n3\n2\n1\n0\n\nportf. value (units),T\u22120\n\nNote: histograms for 1000 simulation of the risky asset dynamics. T \u2212 n means n\ntime periods before the time horizon T .\nSource: own calculation\n\n25\n\n\fenue of research on the portfolio optimization under the partial observation of\nthe stochastic volatility. It shows that the nonlinear filtering can be tractable\neven in the dynamic programming setting. From the financial point of view,\nthe incomplete information is a very important driver of the market dynamics\nand its influence on the economic agents' optimal choice is worse studying.\nCertainly, a more efficient numerical implementation of the algorithm is required.\n5. Conclusions\nWe solved the dynamic optimal consumption/investment strategy under\npartial observation of economic factors determining asset price movements\nby means of the numerical method. The special variation of the quantization\ntechnique reduced the originally infinite dimensional problem to the finite\nstate space exercise. We successfully developed the algorithm to solve the\nconsumption / investment problem on the stylized market for 2 tradable\nassets and 1 unhedgable economic factor.\nThe extension of the paper can be devoted to a study of the stability of the\nalgorithm solving numerically the optimal portfolio choice with consumption.\nThe first important question remains how the results of the simulation change\nbetween two different sets of randomly generated asset returns. The second\none could be related to the size of quantization set that would in practice\ngive an assumed accuracy of numerical optimal strategies.\nWe transformed the partial observation to the full observation problem,\nassuming that the shocks affecting prices and economic factors are independents. However, existing methods of stochastic volatility estimation [11] do\nnot need shocks to be orthogonal. It would be interesting to develop a model\nof consumption/investment with imperfect observation and correlation of\nvolatility and idiosyncratic shocks in the asset price movements.\nAppendix A. Filters\nThe following lemma is the most crucial in obtaining filters of partially\nobserved processes. It states that Y s and Ril s are independent in (F lR , P\u0304).\nAfter disentangling Y from Rl , the evolution of the variable Y can be reformulated to a recursive equation of measures on (\u03a9, FlR ).\nLemma Appendix A.1. The processes Y and Rl are independent in F lR\nunder P\u0304.\n26\n\n\fProof: Let us take two Borel functions f1 and f2 . Then\n\u0002\n\u0003\nl\nlR\n\u0002\n\u0003\nE \u039b\u22121\nt f1 (Y (t))f2 (R (t)) Ft\u22121\nl\nlR\n\u0003\n\u0002\n\u0112 f1 (Y (t))f2 (R (t)) Ft\u22121 =\nlR\nE \u039b\u22121\nFt\u22121\nt\n\u0002\n\u0003\nl\nlR\nE \u03bb\u22121\nt f1 (Y (t))f2 (R (t)) Ft\u22121\n\u0003\n\u0002\n=\n(A.1)\nlR\nE \u03bb\u22121\nFt\u22121\nt\n\u22121 \u22121\n\u22121\nY\nsince \u039b\u22121\nt = \u03bbt \u039bt\u22121 and \u039bt\u22121 is Ft\u22121 -measurable. For brevity \u1ef9 : = Y (t \u2212 1).\nLet us take the denominator in A.1 and\n\u0002\n\u0003\nlR\nE \u03bb\u22121\nFt\u22121\n=\nt\n\uf8ee\n\uf8f9\n(l)\ndet(\u03c3(Y (t)))\u03c6(R (t))\ndet(\u03c3Y )\u03c8(Y (t))\nlR \uf8fb\n\u0011 \u0010\n\u0011 Ft\u22121\n=E\uf8f0 \u0010\n\u22121\n\u22121\n(l)\n\u03c6 \u03c3 (Y (t))[R (t) \u2212 \u03bc(Y (t))] \u03c8 \u03c3Y [Y (t) \u2212 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9)]\n#\n\"\n\u0001\n\u0001\n\u03c6 \u03bc(Y (t)) + \u03c3(Y (t))\u000f(t) \u03c8 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9) + \u03c3Y \u03be(t)\nlR\nFt\u22121\n.\n=E\ndet(\u03c3 \u22121 (Y (t)))\u03c6 (\u000f(t))\ndet(\u03c3Y\u22121 )\u03c8(\u03be(t))\n\nPut\n\u0001\n\u03c8 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9) + \u03c3Y \u03be(t)\np1 : =\n.\ndet(\u03c3Y\u22121 )\u03c8(\u03be(t))\nThen\n#\n#\n\u0001\n\u03c6 \u03bc(Y (t)) + \u03c3(Y (t))\u000f(t)\nlR\nlR\n\u03c3(Ft\u22121\n, FtY ) Ft\u22121\n.\n= E p1 E\ndet(\u03c3 \u22121 (Y (t)))\u03c6 (\u000f(t))\n\"\n\nlR\nE \u03bb\u22121\nFt\u22121\nt\n\n\u0002\n\n\u0003\n\n\"\n\nlR\nThe variable \u000f(t) is independent of Ft\u22121\nso we can integrate with respect to\nthe density \u03c6\n\" Z\n#\n\u0001\n\u0002 \u22121 lR \u0003\n\u03c6 \u03bc(Y (t)) + \u03c3(Y (t))\u02c6\u000f\nlR\nE \u03bbt Ft\u22121 = E p1\n\u03c6(\u02c6\u000f)d\u02c6\u000f Ft\u22121\n.\n\u22121 (Y (t)))\u03c6 (\u02c6\ndet(\u03c3\n\u000f\n)\nN\nR\n\n27\n\n\fBy changing variables with\n\u0398(\u02c6\u000f) = \u03c3 \u22121 (Y (t))\u02c6\u000f, with a\nR the diffeomorphism\nR\ngiven fixed \u03c9, as follows \u0398(RN ) G(\u02c6\u000f)d\u02c6\u000f = RN (\u0398 \u25e6 G)(\u02c6\u000f) det(\u03980 (\u02c6\u000f))d\u02c6\u000f we get\n\u0014 Z\n\u0015\n\u0002 \u22121 lR \u0003\n\u0001\nlR\nE \u03bbt Ft\u22121 = E p1\n\u03c6 \u03bc(Y (t)) + \u000f\u02c6 d\u02c6\u000f Ft\u22121\nRN\n#\n#\n\" \"\n\u0001\n\u03c8 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9) + \u03c3Y \u03be(t)\nlR\nY\nlR\n=E E\n\u03c3(Ft\u22121\n, Ft\u22121\n) Ft\u22121\ndet(\u03c3Y\u22121 )\u03c8(\u03be(t))\n\"Z\n#\n\u0001\n\u03c8 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9) + \u03c3Y \u03be\u02c6\n\u02c6 \u03be\u02c6 F lR \u2261 1,\n=E\n\u03c8(\u03be)d\nt\u22121\n\u22121\n\u02c6\nK\ndet(\u03c3Y )\u03c8(\u03be)\nR\nlR\n.\nobserving that \u03be(t) is independent of Ft\u22121\nLet us take\n\u0002\n\u0003\nl\nlR\nE \u03bb\u22121\nt f1 (Y (t))f2 (R (t)) Ft\u22121 =\n#\n\"\n\u0001\n\u03c6\n\u03bc(Y\n(t)))\n+\n\u03c3(Y\n(t))\u000f(t)\nlR\nFt\u22121\n= E p1 f1 (Y (t))f2 (Rl (t))\ndet(\u03c3 \u22121 (Y (t)))\u03c6 (\u000f(t))\n#\n\"\n\"\n#\n\u0001\n\u03c6\n\u03bc(Y\n(t))\n+\n\u03c3(Y\n(t))\u000f(t)\nlR\nlR\n.\n= E p1 f1 (Y (t))E f2 (Rl (t))\n\u03c3(Ft\u22121\n, FtY ) Ft\u22121\ndet(\u03c3 \u22121 (Y (t)))\u03c6 (\u000f(t))\nlR\ngives\nA similar argument about independence of \u000f(t) and Ft\u22121\n\u0002\n\u0003\nl\nlR\nE \u03bb\u22121\nt f1 (Y (t))f2 (R (t)) Ft\u22121 =\n#\n\"\n\u0001\nZ\n\u03c6 \u03bc(Y (t)) + \u03c3(Y (t))\u02c6\u000f\nlR\nd\u02c6\u000f Ft\u22121\n= E f1 (Y (t))p1\nf2 (\u03bc(Y (t)) + \u03c3(Y (t))\u02c6\u000f)\n\u22121\ndet(\u03c3 (Y (t)))\nRN\n\nand after the diffeomorphic change of variables\n\u0002\n\u0002\n\u0003 lR \u0003\nlR\n= E f1 (Y (t))p1 E f2 (Rl (t)) Ft\u22121\nFt\u22121\n\"\n#\n\u0001\n\u0003\n\u03c8 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9) + \u03c3Y \u03be(t) \u0002\nlR\nlR\n= E f1 (Y (t))\nE f2 (Rl (t)) Ft\u22121\nFt\u22121\n\u22121\ndet(\u03c3Y )\u03c8(\u03be(t))\n#\n\"Z\n\u0001\n\u02c6\n\u0003\n\u0002\n\u03c8\n\u1ef9\n\u2212\n\u03b1(\u0233\n\u2212\n\u1ef9)\n+\n\u03c3\n\u03be\nY\nlR\nlR\n\u02c6\n=E\nf1 (\u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9) + \u03c3Y \u03be)\nd\u03be\u02c6 * E f2 (Rl (t)) Ft\u22121\nFt\u22121\n\u22121\ndet(\u03c3Y )\nRK\n\u0003 lR \u0003\n\u0002 \u0002\n\u0003\n\u0002\nlR\nlR\n= E E f1 (Y (t)) Ft\u22121\n* E f2 (Rl (t)) Ft\u22121\nFt\u22121\n\u0002\n\u0003\n\u0002\n\u0003\nlR\nl\nlR\n= E f1 (Y (t)) Ft\u22121 * E f2 (R (t)) Ft\u22121 .\n28\n\n\fTaking f1 (z) = 1A (z) and f2 (z) = 1B (z) for A, B \u2208 FtlR we obtained\n\u0001\n\u0002\n\u0003\nlR\nP {Rl (t) \u2208 A} \u2229 {Y (t) \u2208 B} Ft\u22121\n= E f1 (Rl (t))f2 (Y (t)) FtlR =\n\u0001\n\u0001\n\u0003\n\u0003\n\u0002\nlR\nlR\n.\nP Y (t) \u2208 B Ft\u22121\n= E f1 (Rl (t)) FtlR E [f2 (Y (t))| FtlR = P Rl (t) \u2208 A Ft\u22121\n2\nProof: [Theorem 2.1] For an arbitrary Borel function f let us take\nZ\n\u0003\nf (z)%t (z)dz = \u0112 [\u039bt f (Y (t))| FtlR =\nRK\n\u0010\n\u0011 \u0010\n\u0011\n\uf8ee\n\uf8f9\n\u22121\n\u22121\n(l)\n\u03c6 \u03c3 (Y (t))[R (t) \u2212 \u03bc(Y (t))] \u03c8 \u03c3Y [Y (t) \u2212 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9)]\n= \u0112 \uf8f0\u039bt\u22121\nf (Y (t)) FtlR \uf8fb\n(l)\ndet(\u03c3(Y (t)))\u03c6(R (t))\ndet(\u03c3Y )\u03c8(Y (t))\n\u0010\n\u0011\n\uf8ee\n\uf8ee\n\u03c6 \u03c3 \u22121 (Y (t))[R(l) (t) \u2212 \u03bc(Y (t))]\n\uf8f0\n\uf8f0\n= \u0112 \u039bt\u22121 E\ndet(\u03c3(Y (t)))\u03c6(R(l) (t))\n\u0010\n\u0011\n\uf8f9\n\uf8f9\n\u03c8 \u03c3Y\u22121 [Y (t) \u2212 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9)]\nY\nf (Y (t)) \u03c3(FtlR , Ft\u22121\n)\uf8fb FtlR \uf8fb\ndet(\u03c3Y )\u03c8(Y (t))\n\u0010\n\u0011 \u0010\n\u0011\n\uf8ee\n\uf8f9\nZ \u03c6 \u03c3 \u22121 (z)[R(l) (t) \u2212 \u03bc(z)] \u03c8 \u03c3 \u22121 [z \u2212 \u1ef9 \u2212 \u03b1(\u0233 \u2212 \u1ef9)]\nY\nf (z)\u03c8(z)dy FtlR \uf8fb .\n= \u0112 \uf8f0\u039bt\u22121\n(l)\ndet(\u03c3(z))\u03c6(R\n(t))\ndet(\u03c3\n)\u03c8(z)\nK\nY\nR\nThe inner process is the function of Y (t \u2212 1) and \u039bt\u22121 so we can integrate\nwith respect to %t\u22121 (z) in the following\n\u0013\nZ\nZ \u0012Z\n\u03a6(z, Rl (t))\nf (z)%t (z)dz =\n\u03a8(z, y)f (z)dz %t\u22121 (y)dy\nl\nRK\nRK\nRK \u03c6(R (t))\n\u0012Z\n\u0013\nZ\n\u03a6(z, Rl (t))\n=\nf (z)\n\u03a8(z, y)%t\u22121 (y)dy dz.\n\u03c6(Rl (t))\nRK\nRK\nSince f is the arbitrary function the identity 7 holds.\n2\nAppendix B. The constant vN in the error estimate in lemma 3.3\nChanging the limits of integration in the integral\nZ\n|x|\u2212p dx\n[M0 ,+\u221e)N\n\n29\n\n\fto the polar ones with\n\uf8ee\n\uf8f9\nw cos \u03b11 cos \u03b12 cos \u03b13 . . . cos \u03b1N \u22121\n\uf8ef w sin \u03b11 cos \u03b12 cos \u03b13 . . . cos \u03b1N \u22121 \uf8fa\n\uf8ef\n\uf8fa\n\uf8ef\n\uf8fa\nw\nsin\n\u03b1\ncos\n\u03b1\n.\n.\n.\ncos\n\u03b1\n2\n3\nN\n\u22121\n\uf8ef\n\uf8fa\nF (w, \u03b11 , . . . , \u03b1N ) = \uf8ef\n\uf8fa\n..\n\uf8ef\n\uf8fa\n.\n\uf8ef\n\uf8fa\n\uf8f0\nw sin \u03b1N \u22122 cos \u03b1N \u22121 \uf8fb\nw sin \u03b1N \u22121\nwe obtain\nZ\n\nZ\n\n\u2212p\n\nr\u2212p | det F 0 |dwd\u03b11 \u03b12 . . . \u03b1N \u22121 =\nZ\ncos \u03b12 d\u03b12 . . .\n(cos \u03b1N \u22121 )N \u22122 d\u03b1N \u22121 .\n\n|x| dx =\n[M0\n\n[M0 ,+\u221e)\u00d7[0,2\u03c0]\u00d7[\u2212 \u03c02 \u03c02 ]N \u22122\n\n,+\u221e)N\n\nZ\n\n\u2212p\n\nw w\n\nN \u22121\n\n[M0 ,+\u221e)\n\nZ\n\nZ\n1d\u03b11\n\n[0,2\u03c0]\n\n[\u2212 \u03c02\n\n\u03c0\n]\n2\n\n[\u2212 \u03c02\n\n\u03c0\n]\n2\n\nR\u03c0\nLet us denote In : = \u22122\u03c0 cosn tdt. Note that I0 = \u03c0 and I1 = 2. Integrating\n2\nby parts\nZ \u03c0\nZ \u2212\u03c0\n\u03c0\n2\n2\n2\nn\u22121\nn\u22121\ncos t cos\ntdt = sin t cos\nt \u03c0+\nsin2 t cosn\u22122 tdt\n\u22122\n\n\u2212 \u03c02\n\n\u2212 \u03c02\n\nIn = 0 + nIn\u22121 \u2212 nIn ,\n\n(B.1)\n\nthus\nn!!\n\u03c0,\n(n + 1)!!\nn!!\n.\nn = 2k + 1 \u21d2 In = 2\n(n + 1)!!\nn = 2k \u21d2 In =\n\nThen\nvN\n\nN \u22121 Z\n2\u03c0 Y\n=\n(cos t)j\u22121 dt\nN \u2212 p j=2 [\u2212 \u03c02 , \u03c02 ]\n\n=\n\n=\n\nN \u22122\n2\u03c0 Y jmod2 (j+1)mod2 j!!\n2\n\u03c0\nN \u2212 p j=1\n(j + 1)!!\n(\nN \u22122\n2\u03c0\n(2\u03c0) 2 ,\nif N = 2k\n(N \u2212p)(N \u22122)!!\nN \u22123\nN \u22123\n2\u03c0\n2 2 \u03c0 2 +1 ,\n(N \u2212p)(N \u22122)!!\n\n30\n\nif N = 2k + 1\n\n(B.2)\n\n\fAcknowledgements\nThe paper is an extension of the part of my doctoral thesis completed under supervision of Prof Lukasz Stetter. I would like to thank the participants\nof the Third General AMAMEF Conference \"Advances in Mathematical Finance\", May 5-10, 2008, Pitesti, Romania, for their valuable comments to the\npreliminary results which were presented there. I also expresses my gratefulness to Tom Hurd and the Fields Institute in Toronto for invitation to\nthe postdoctoral program and the financial support that contributed a lot to\nessentially improving and finishing the paper. Many thanks to my wife Ania\nfor the interminable support in my research.\nReferences\n[1] F. Baghery, B. \u00d8ksendal A maximum principle for stochastic control\nwith partial information. Stochastic Analysis and Applications 25 (2007)\n705\u2013717.\n[2] O.E. Barndorff-Nielsen, E. Nicolato, N. Shephard, Some recent developments in stochastic volatility modelling, Quantitative Finance 2(1)\n(2002) 11\u201323.\n[3] V. Bene\u0161, I. Karatzas, D. Ocone, H. Wang, Control with Partial Observations and an Explicit Solution of Mortensen's Equation, Applied\nMathematical Optimisation, 49 (2002) 217\u2013239.\n[4] A. Bensoussan, Stochastic Control of Partially Observable Systems,\nCambridge University Press, Cambridge, 1992.\n[5] D. Bertsekas, Dynamic Programming and Stochastic Control, New York:\nAcademic Press, 1976.\n[6] S. Brendle, Portfolio Selection under Partial Observation and Filtering, preliminary version of working paper, Prinston University (2005)\nhttp://papers.ssrn.com/sol3/papers.cfm?abstract_id=590362.\n[7] R. Carmona, M. Ludkovski, Convenience yield model with partial observations and exponential utility, Princeton working paper (2004).\n\n31\n\n\f[8] M. Corsi, H. Pham, W. Runggaldier, Numerical approximation by quantization of control problems in finance under partial observations, Mathematical modeling and numerical methods in finance, in A. Bensoussan, Q. Zhang (Eds.), Handbook of Numerical analysis (special volume),\n2008.\n[9] P. Del Moral, J. Jacod, Ph. Protter, The Monte-Carlo methods for filtering with discrete time observations, Probability Theory and Related\nFields 120 (2001) 346\u2013368.\n[10] R. Desai, T. Lele., F. Viens, A Monte-Carlo method for portfolio optimization under partially observed stochastic volatility, IEEE International Conference on Computational Intelligence for Financial Engineering, Proceedings 2003.\n[11] G. Durham, Monte Carlo methods for estimating, smoothing and filtering one- and two-factor stochastic volatility models, Journal of Econometrics 133 (2007) 273\u2013305.\n[12] R. Elliot, H. Miao, Stochastic Volatility Model with Filtering, Stochastic\nAnalysis and Applications 24 (2006) 661\u2013683.\n[13] G. Halaj, Risk-based decisions on the asset structure of a bank under\neconomic information, Applied Mathematical Finance 15(4) (2008) 305\u2013\n329.\n[14] V. Krishnamurthy, F. Le Gland, the Discretization of Continuous-Time\nFilters and Smoothers for HMM Parameter Estimation, IEEE Transactions on Information Theory 42(3) (1996) 593\u2013605.\n[15] P. Lakner, Utility maximization with partial information, Stochastic\nProcesses and their Application 56 (1995) 247\u2013273.\n[16] G. Pag\u00e8s, H. Pham, J. Printemps, An Optimal Markovian Quantization\nAlgorithm for Multidimensional Stochastic Control Problems, Stochastics and Dynamics 4(4) (2004) 501\u2013545.\n[17] G. Pag\u00e8s, H. Pham, J. Printemps, Optimal quantization methods and applications to numerical problems in finance, in: S. Rachev (Ed.), Handbook on Numerical Methods in Finance, Birkhauser, Boston, 2004, pp.\n253\u2013298.\n32\n\n\f[18] G. Pag\u00e8s, H. Pham, Optimal quantization methods for nonlinear filtering\nwith discrete-time observations, Bernoulli 11(5) (2005) 893-\u2013932.\n[19] H. Pham, M.-C. Quenez, Optimal Portfolio in Partially Observed\nStochastic Volatility Models, The Annals of Applied Probability 11(1)\n(2001) 210\u2013238.\n[20] W. Runggaldier, L. Stettner, Approximation of Discrete Time Partially\nObserved Control Problems, Applied Mathematics Monographs CNR,\nPisa, 1994.\n[21] J. Sass, U.G. Haussmann, Optimizing the terminal wealth under partial information: The drift process as a continuous time Markov chain,\nFinance and Stochastics 8 (2004) 553\u2013577.\n[22] A. Shapiro, Y. Wardi, Convergence Analysis of Gradient Descent\nStochastic Algorithms, Journal of optimization theory and applications\n91(2) (1996) 439\u2013454.\n[23] H. S\u00f8rensen, Simulated Likelihood Approximations for Stochastic Volatility Models, Scandinavian Journal of Statistics 30(2) (2003) 257\u2013276.\n[24] L. Stettner, Risk-Sensitive Portfolio Optimization With Completely and\nPartially Observed Factors, IEEE Transactions on Automatic Control\n49(3) (2004) 457\u2013464.\n\n33\n\n\f"}