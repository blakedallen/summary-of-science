{"id": "http://arxiv.org/abs/astro-ph/0506751v1", "guidislink": true, "updated": "2005-06-30T10:21:26Z", "updated_parsed": [2005, 6, 30, 10, 21, 26, 3, 181, 0], "published": "2005-06-30T10:21:26Z", "published_parsed": [2005, 6, 30, 10, 21, 26, 3, 181, 0], "title": "Spectral analysis of early-type stars using a genetic algorithm based\n  fitting method", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0506337%2Castro-ph%2F0506374%2Castro-ph%2F0506616%2Castro-ph%2F0506022%2Castro-ph%2F0506510%2Castro-ph%2F0506167%2Castro-ph%2F0506188%2Castro-ph%2F0506473%2Castro-ph%2F0506632%2Castro-ph%2F0506077%2Castro-ph%2F0506750%2Castro-ph%2F0506262%2Castro-ph%2F0506324%2Castro-ph%2F0506578%2Castro-ph%2F0506633%2Castro-ph%2F0506584%2Castro-ph%2F0506287%2Castro-ph%2F0506266%2Castro-ph%2F0506023%2Castro-ph%2F0506248%2Castro-ph%2F0506529%2Castro-ph%2F0506560%2Castro-ph%2F0506268%2Castro-ph%2F0506751%2Castro-ph%2F0506758%2Castro-ph%2F0506545%2Castro-ph%2F0506601%2Castro-ph%2F0506679%2Castro-ph%2F0506342%2Castro-ph%2F0506617%2Castro-ph%2F0506252%2Castro-ph%2F0506451%2Castro-ph%2F0506688%2Castro-ph%2F0506709%2Castro-ph%2F0506332%2Castro-ph%2F0506637%2Castro-ph%2F0506321%2Castro-ph%2F0506640%2Castro-ph%2F0506067%2Castro-ph%2F0506444%2Castro-ph%2F0506142%2Castro-ph%2F0506580%2Castro-ph%2F0506433%2Castro-ph%2F0506481%2Castro-ph%2F0506659%2Castro-ph%2F0506618%2Castro-ph%2F0506186%2Castro-ph%2F0506647%2Castro-ph%2F0506274%2Castro-ph%2F0506609%2Castro-ph%2F0506012%2Castro-ph%2F0506281%2Castro-ph%2F0506019%2Castro-ph%2F0506756%2Castro-ph%2F0506500%2Castro-ph%2F0506389%2Castro-ph%2F0506745%2Castro-ph%2F0506346%2Castro-ph%2F0506384%2Castro-ph%2F0506096%2Castro-ph%2F0506318%2Castro-ph%2F0506362%2Castro-ph%2F0506503%2Castro-ph%2F0506412%2Castro-ph%2F0506461%2Castro-ph%2F0506754%2Castro-ph%2F0506064%2Castro-ph%2F0506634%2Castro-ph%2F0506526%2Castro-ph%2F0506296%2Castro-ph%2F0506278%2Castro-ph%2F0506701%2Castro-ph%2F0506460%2Castro-ph%2F0506056%2Castro-ph%2F0506653%2Castro-ph%2F0506195%2Castro-ph%2F0506192%2Castro-ph%2F0506437%2Castro-ph%2F0506583%2Castro-ph%2F0506408%2Castro-ph%2F0506267%2Castro-ph%2F0506150%2Castro-ph%2F0506006%2Castro-ph%2F0506538%2Castro-ph%2F0506232%2Castro-ph%2F0506170%2Castro-ph%2F0506254%2Castro-ph%2F0506233%2Castro-ph%2F0506377%2Castro-ph%2F0506179%2Castro-ph%2F0506658%2Castro-ph%2F0506135%2Castro-ph%2F0506306%2Castro-ph%2F0506722%2Castro-ph%2F0506615%2Castro-ph%2F0506692%2Castro-ph%2F0506295%2Castro-ph%2F0506236%2Castro-ph%2F0506336%2Castro-ph%2F0506054%2Castro-ph%2F0506544&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Spectral analysis of early-type stars using a genetic algorithm based\n  fitting method"}, "summary": "We present the first automated fitting method for the quantitative\nspectroscopy of O- and early B-type stars with stellar winds. The method\ncombines the non-LTE stellar atmosphere code FASTWIND from Puls et al. (2005)\nwith the genetic algorithm based optimizing routine PIKAIA from Charbonneau\n(1995), allowing for a homogeneous analysis of upcoming large samples of\nearly-type stars (e.g. Evans et al. 2005). In this first implementation we use\ncontinuum normalized optical hydrogen and helium lines to determine\nphotospheric and wind parameters. We have assigned weights to these lines\naccounting for line blends with species not taken into account, lacking\nphysics, and/or possible or potential problems in the model atmosphere code. We\nfind the method to be robust, fast, and accurate. Using our method we analysed\nseven O-type stars in the young cluster Cyg OB2 and five other Galactic stars\nwith high rotational velocities and/or low mass loss rates (including 10lac,\nzeta Oph, and tau Sco) that have been studied in detail with a previous version\nof FASTWIND. The fits are found to have a quality that is comparable or even\nbetter than produced by the classical ``by eye'' method. We define errorbars on\nthe model parameters based on the maximum variations of these parameters in the\nmodels that cluster around the global optimum. Using this concept, for the\ninvestigated dataset we are able to recover mass-loss rates down to ~6d-8\nMsun/yr to within an error of a factor of two. Comparison of our derived\nspectroscopic masses with those derived from stellar evolutionary models are in\nvery good agreement, i.e. based on the limited sample that we have studied we\ndo not find indications for a mass discrepancy.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0506337%2Castro-ph%2F0506374%2Castro-ph%2F0506616%2Castro-ph%2F0506022%2Castro-ph%2F0506510%2Castro-ph%2F0506167%2Castro-ph%2F0506188%2Castro-ph%2F0506473%2Castro-ph%2F0506632%2Castro-ph%2F0506077%2Castro-ph%2F0506750%2Castro-ph%2F0506262%2Castro-ph%2F0506324%2Castro-ph%2F0506578%2Castro-ph%2F0506633%2Castro-ph%2F0506584%2Castro-ph%2F0506287%2Castro-ph%2F0506266%2Castro-ph%2F0506023%2Castro-ph%2F0506248%2Castro-ph%2F0506529%2Castro-ph%2F0506560%2Castro-ph%2F0506268%2Castro-ph%2F0506751%2Castro-ph%2F0506758%2Castro-ph%2F0506545%2Castro-ph%2F0506601%2Castro-ph%2F0506679%2Castro-ph%2F0506342%2Castro-ph%2F0506617%2Castro-ph%2F0506252%2Castro-ph%2F0506451%2Castro-ph%2F0506688%2Castro-ph%2F0506709%2Castro-ph%2F0506332%2Castro-ph%2F0506637%2Castro-ph%2F0506321%2Castro-ph%2F0506640%2Castro-ph%2F0506067%2Castro-ph%2F0506444%2Castro-ph%2F0506142%2Castro-ph%2F0506580%2Castro-ph%2F0506433%2Castro-ph%2F0506481%2Castro-ph%2F0506659%2Castro-ph%2F0506618%2Castro-ph%2F0506186%2Castro-ph%2F0506647%2Castro-ph%2F0506274%2Castro-ph%2F0506609%2Castro-ph%2F0506012%2Castro-ph%2F0506281%2Castro-ph%2F0506019%2Castro-ph%2F0506756%2Castro-ph%2F0506500%2Castro-ph%2F0506389%2Castro-ph%2F0506745%2Castro-ph%2F0506346%2Castro-ph%2F0506384%2Castro-ph%2F0506096%2Castro-ph%2F0506318%2Castro-ph%2F0506362%2Castro-ph%2F0506503%2Castro-ph%2F0506412%2Castro-ph%2F0506461%2Castro-ph%2F0506754%2Castro-ph%2F0506064%2Castro-ph%2F0506634%2Castro-ph%2F0506526%2Castro-ph%2F0506296%2Castro-ph%2F0506278%2Castro-ph%2F0506701%2Castro-ph%2F0506460%2Castro-ph%2F0506056%2Castro-ph%2F0506653%2Castro-ph%2F0506195%2Castro-ph%2F0506192%2Castro-ph%2F0506437%2Castro-ph%2F0506583%2Castro-ph%2F0506408%2Castro-ph%2F0506267%2Castro-ph%2F0506150%2Castro-ph%2F0506006%2Castro-ph%2F0506538%2Castro-ph%2F0506232%2Castro-ph%2F0506170%2Castro-ph%2F0506254%2Castro-ph%2F0506233%2Castro-ph%2F0506377%2Castro-ph%2F0506179%2Castro-ph%2F0506658%2Castro-ph%2F0506135%2Castro-ph%2F0506306%2Castro-ph%2F0506722%2Castro-ph%2F0506615%2Castro-ph%2F0506692%2Castro-ph%2F0506295%2Castro-ph%2F0506236%2Castro-ph%2F0506336%2Castro-ph%2F0506054%2Castro-ph%2F0506544&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present the first automated fitting method for the quantitative\nspectroscopy of O- and early B-type stars with stellar winds. The method\ncombines the non-LTE stellar atmosphere code FASTWIND from Puls et al. (2005)\nwith the genetic algorithm based optimizing routine PIKAIA from Charbonneau\n(1995), allowing for a homogeneous analysis of upcoming large samples of\nearly-type stars (e.g. Evans et al. 2005). In this first implementation we use\ncontinuum normalized optical hydrogen and helium lines to determine\nphotospheric and wind parameters. We have assigned weights to these lines\naccounting for line blends with species not taken into account, lacking\nphysics, and/or possible or potential problems in the model atmosphere code. We\nfind the method to be robust, fast, and accurate. Using our method we analysed\nseven O-type stars in the young cluster Cyg OB2 and five other Galactic stars\nwith high rotational velocities and/or low mass loss rates (including 10lac,\nzeta Oph, and tau Sco) that have been studied in detail with a previous version\nof FASTWIND. The fits are found to have a quality that is comparable or even\nbetter than produced by the classical ``by eye'' method. We define errorbars on\nthe model parameters based on the maximum variations of these parameters in the\nmodels that cluster around the global optimum. Using this concept, for the\ninvestigated dataset we are able to recover mass-loss rates down to ~6d-8\nMsun/yr to within an error of a factor of two. Comparison of our derived\nspectroscopic masses with those derived from stellar evolutionary models are in\nvery good agreement, i.e. based on the limited sample that we have studied we\ndo not find indications for a mass discrepancy."}, "authors": ["M. R. Mokiem", "A. de Koter", "J. Puls", "A. Herrero", "F. Najarro", "M. R. Villamariz"], "author_detail": {"name": "M. R. Villamariz"}, "author": "M. R. Villamariz", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1051/0004-6361:20053522", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/astro-ph/0506751v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/astro-ph/0506751v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "24 pages, 19 figures, accepted by A&A", "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/astro-ph/0506751v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/astro-ph/0506751v1", "journal_reference": null, "doi": "10.1051/0004-6361:20053522", "fulltext": "Astronomy & Astrophysics manuscript no. ga \u0307ostars\n(DOI: will be inserted by hand later)\n\nNovember 15, 2018\n\nSpectral analysis of early-type stars using a\ngenetic algorithm based fitting method\nM. R. Mokiem1 , A. de Koter1 , J. Puls2 , A. Herrero3,4 , F. Najarro5 , and M. R. Villamariz3\n\narXiv:astro-ph/0506751v1 30 Jun 2005\n\n1\n2\n3\n4\n\n5\n\nAstronomical Institute Anton Pannekoek, University of Amsterdam, Kruislaan 403, 1098 SJ Amsterdam, The Netherlands\nUniversit\u00e4ts-Sternwarte M\u00fcnchen, Scheinerstr. 1, D-81679 M\u00fcnchen, Germany\nInstituto de Astrof\u0131\u0301sica de Canarias, E-38200, La Laguna, Tenerife, Spain\nDepartamento de Astrof\u0131\u0301sica, Universidad de La Laguna, Avda. Astrof\u0131\u0301sico Francisco S\u00e1nchez, s/n, E-38071 La Laguna,\nSpain\nInstituto de Estructura de la Materia, Consejo Superior de Investigaciones Cient\u0131\u0301ficas, CSIC, Serrano 121, E-28006 Madrid,\nSpain\n\nReceived / Accepted\nAbstract. We present the first automated fitting method for the quantitative spectroscopy of O- and early B-type stars with\nstellar winds. The method combines the non-LTE stellar atmosphere code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 from Puls et al. (2005) with the genetic\nalgorithm based optimizing routine \uf770\uf769\uf76b\uf761\uf769\uf761 from Charbonneau (1995), allowing for a homogeneous analysis of upcoming large\nsamples of early-type stars (e.g. Evans et al. 2005). In this first implementation we use continuum normalized optical hydrogen\nand helium lines to determine photospheric and wind parameters. We have assigned weights to these lines accounting for line\nblends with species not taken into account, lacking physics, and/or possible or potential problems in the model atmosphere\ncode. We find the method to be robust, fast, and accurate. Using our method we analysed seven O-type stars in the young\ncluster Cyg OB2 and five other Galactic stars with high rotational velocities and/or low mass loss rates (including 10 Lac,\n\u03b6 Oph, and \u03c4 Sco) that have been studied in detail with a previous version of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764. The fits are found to have a quality that\nis comparable or even better than produced by the classical \"by eye\" method. We define errorbars on the model parameters\nbased on the maximum variations of these parameters in the models that cluster around the global optimum. Using this concept,\nfor the investigated dataset we are able to recover mass-loss rates down to \u223c 6 \u00d7 10\u22128 M\u2299 yr\u22121 to within an error of a factor\nof two, ignoring possible systematic errors due to uncertainties in the continuum normalization. Comparison of our derived\nspectroscopic masses with those derived from stellar evolutionary models are in very good agreement, i.e. based on the limited\nsample that we have studied we do not find indications for a mass discrepancy. For three stars we find significantly higher\nsurface gravities than previously reported. We identify this to be due to differences in the weighting of Balmer line wings\nbetween our automated method and \"by eye\" fitting and/or an improved multidimensional optimization of the parameters. The\nempirical modified wind momentum relation constructed on the basis of the stars analysed here agrees to within the error bars\nwith the theoretical relation predicted by Vink et al. (2000), including those cases for which the winds are weak (i.e. less than\na few times 10\u22127 M\u2299 yr\u22121 ).\nKey words. methods: data analysis - line: profiles - stars: atmospheres - stars: early-type - stars: fundamental parameters -\n\nstars: mass loss\n\n1. Introduction\nUntil about a decade ago detailed analysis of the photospheric\nand wind properties of O-type stars was limited to about 40 to\n50 stars divided over the Galaxy and the Magellanic Clouds\n(see e.g. Puls et al. 1996; see also Repolust, Puls, & Herrero\n2004). The reason that at that time only such a limited number\nof objects had been investigated is related in part to the fact that\nconsiderable effort was directed towards improving the physics\nof the non-local thermodynamic equilibrium (non-LTE) model\natmospheres used to analyse massive stars. Notable develSend offprint requests to: M.R. Mokiem,\ne-mail: mokiem@science.uva.nl\n\nopments have been the improvements in the atomic models\n(e.g. Becker & Butler 1992), shock treatment (Pauldrach et al.\n2001), clumping (Hillier 1991; Hillier & Miller 1999), and the\nimplementation of line blanketing (e.g. Hubeny & Lanz 1995;\nHillier & Miller 1998; Pauldrach et al. 2001). To study the effects of these new physics a core sample of \"standard\" O-type\nstars has been repeatedly re-analysed. A second reason, that\nis at least as important, is the complex, and time and CPU\nintensive nature of these quantitative spectroscopic analyses.\nTypically, at least a six dimensional parameter space has to\nbe probed, i.e. effective temperature, surface gravity, helium\nto hydrogen ratio, atmospheric microturbulent velocity, massloss rate, and a measure of the acceleration of the transonic\n\n\f2\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\noutflow. Rotational velocities and terminal outflow velocities\ncan be determined to considerable accuracy by means of external methods such as rotational (de-) convolution methods\n(e.g. Howarth et al. 1997) and SEI-fitting of P-Cygni lines (e.g.\nGroenewegen & Lamers 1989), respectively. To get a good\nspectral fit it typically requires tens, sometimes hundreds of\nmodels per individual star.\nIn the last few years the field of massive stars has seen\nthe fortunate development that the number of O-type stars that\nhave been studied spectroscopically has been doubled (e.g.\nCrowther et al. 2002; Herrero et al. 2002; Bianchi & Garcia\n2002; Bouret et al. 2003; Hillier et al. 2003; Garcia & Bianchi\n2004; Martins et al. 2004; Massey et al. 2004; Evans et al.\n2004). The available data set of massive O- and early B-type\nstars has recently again been doubled, mainly through the advent of multi-object spectroscopy. Here we explicitly mention the VLT-FLAMES Survey of Massive Stars (Evans et al.\n2005) comprising over 100 hours of VLT time. In this survey\nmulti-object spectroscopy using the Fibre Large Array MultiElement Spectrograph (FLAMES) has been used to secure over\n550 spectra (of which in excess of 50 are spectral type O) in\na total of seven clusters distributed over the Galaxy and the\nMagellanic Clouds.\nThis brings within reach different types of studies that so\nfar could only be attempted with a troublingly small sample\nof stars. These studies include establishing the mass loss behaviour of Galactic stars across the upper Hertzsprung-Russell\ndiagram, from the weak winds of the late O-type dwarfs (of\norder 10\u22128 M\u2299 yr\u22121 ) to the very strong winds of early O-type\nsupergiants (of order 10\u22125 M\u2299 yr\u22121 ); determination of the massloss versus metallicity dependence in the abundance range\nspanned by Small Magellanic Cloud to Galactic stars; placing\nconstraints on the theory of massive star evolution by comparing spectroscopic mass determinations and abundance patterns\nwith those predicted by stellar evolution computations, and the\nstudy of (projected) spatial gradients in the mass function of\nO- and B-type stars in young clusters, as well as such spatial\ngradients in the initial atmospheric composition of these stars.\nTo best perform studies such as listed above not only requires a large set of young massive stars, it also calls for\na robust, homogeneous and objective means to analyse such\ndatasets using models that include state-of-the-art physics. This\nessentially requires an automated fitting method. Such an automated method should not only be fast, it must also be sufficiently flexible to be able to treat early-type stars with widely\ndifferent properties (e.g. mass-loss rates that differ by a factor\nof 103 ). Moreover, it should apply a well defined fitting criterium, like a \u03c72 criterium, allowing it to work in an automated\nand reproducible way.\nTo cope with the dataset provided by the VLT-FLAMES\nSurvey and to improve the objectivity of the analysis, we\nhave investigated the possibility of automated fitting. Here we\npresent a robust, fast, and accurate method to perform automated fitting of the continuum normalized spectra of O- and\nearly B-type stars with stellar winds using the fast performance\nstellar atmosphere code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 (Puls et al. 2005) combined\nwith a genetic algorithm based fitting method. This first implementation of an automated method should therefore be seen as\n\nan improvement over the standard \"by eye\" method, and not as\na replacement of this method. The improvement lies in the fact\nthat with the automated method large data sets (tens or more\nstars), spanning a wide parameter space, can be analysed in a\nrepeatable and homogeneous way. It does not replace the \"by\neye\" method as our automated fitting method still requires a\nby eye continuum normalization as well as a human controlled\nline selection. This latter should address the identification and\nexclusion of lines that are not modeled (i.e. blends), as well as\nintroduce information on lacking physics and/or possible or potential problems in the model atmosphere code. Future implementations of an automated fitting method may use the absolute spectrum, preferably over a broad wavelength range. This\nwould eliminate the continuum rectification problem, however,\nit will require a modeling of the interstellar extinction. In this\nway one can work towards a true replacing of the \"by eye\"\nmethod by an automated approach.\nIn Sect. 2 we describe the genetic algorithm method and\nimplementation, and we provide a short r\u00e9sum\u00e9 of the applied\nunified, non-LTE, line-blanketed atmosphere code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 \u2013\nwhich is the only code to date for which the method described\nhere is actually achievable (in the context of analysing large\ndata sets). To test the method we analyse a set of 12 early type\nspectra in Sect. 3. We start with a re-analysis of a set of seven\nstars in the open cluster Cyg OB2 that have been studied by\nHerrero et al. (2002). The advantage of focusing on this cluster\nis that it has been analysed with a previous version of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764,\nallowing for as meaningful a comparison as is possible, while\nstill satisfying our preference to present a state-of-the-art analysis. The analysis of Cyg OB2 has the added advantage that all\nstars studied are approximately equidistant. To test the performance of our method outside the parameter range offered by\nthe Cyg OB2 sample we have included an additional five wellstudied stars with either low density winds and/or very high\nrotational velocities. In Sect. 4 we describe our error analysis method for the multidimensional spectral fits obtained with\nthe automated method. A systematic comparison of the obtained parameters with previously determined values is given\nin Sect. 5. Implications of the newly obtained parameters on\nthe properties of massive stars are discussed in Sect. 6. In the\nlast section we give our conclusions.\n\n2. Automated fitting using a genetic algorithm\n\n2.1. Spectral line fitting as an optimization problem\nSpectral line fitting of early-type stars is an optimization problem in the sense that one tries to maximize the correspondence\nbetween a given observed spectrum and a synthetic spectrum\nproduced by a stellar atmosphere model. Formally speaking\none searches for the global optimum, i.e. best fit, in the parameter space spanned by the free parameters of the stellar atmosphere model by minimizing the differences between the observed and synthesized line profiles.\nUntil now the preferred method to achieve this minimization has been the so called fitting \"by eye\" method. In this\nmethod the best fit to the observed spectrum of a certain object is determined in an iterative manner. Starting with a first\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nguess for the model parameters a spectrum is synthesized. The\nquality of the fit to the observed spectrum is determined, as\nis obvious from the methods name, by an inspection by eye.\nBased on what the person performing the fit sees, for instance,\nwhether the width of the line profiles are reproduced correctly,\ncombined with his/her experience and knowledge of the model\nand the object, the model parameters are modified and a new\nspectrum is synthesized. This procedure is repeated until the\nquality of the fit determined by eye cannot be increased anymore by modifying the model parameters.\nIt can be questioned whether a fit constructed with the fitting \"by eye\" method corresponds to the best fit possible, i.e.\nthe global optimum. Reasons for this are, i) the restricted size\nof parameter space that can be investigated, both in terms of\nnumber of free parameters as well as absolute size of the parameter domain that can investigated with high accuracy, ii) the\nlimited number of free parameters that are changed simultaneously, and iii) biases introduced by judging the quality of a line\nfit by eye. The importance of the first point lies in the fact that\nin order to assure that the global optimum is found, a parameter space that is as large as possible should be explored with\nthe same accuracy for all parameters in the complete parameter space. If this is not the case the solution found will likely\ncorrespond to a local optimum.\nThe argument above becomes stronger in view of the second point. Spectral fitting is a multidimensional problem in\nwhich the line profile shapes depend on all free parameters simultaneously, though to a different extent. Consequently, the\nglobal optimum can only be found if all parameters are allowed to vary at the same time. The use of fit diagrams (e.g.\nKudritzki & Simon 1978; Herrero et al. 1992) does not resolve\nthis issue. These diagrams usually only take variations in T eff\nand log g into account, neglecting the effects of other parameters, like microturbulence (e.g. Smith & Howarth 1998;\nVillamariz & Herrero 2000) and mass loss (e.g. [Fig. 5 of]\nMokiem et al. 2004), on the line profiles.\nThe last point implies that, strictly speaking, fitting \"by\neye\" cannot work in a reproducible way. There is no uniform\nwell defined method to judge how well a synthetic line profile fits the data by eye. More importantly, it implies that there\nis no guarantee that the synthetic line profiles selected by the\neye, correspond to the profiles which match the data the best.\nThis predominantly increases the uncertainty in the derivation\nof those parameters that very sensitively react to the line profile\nshape, like for instance the surface gravity.\nThe new fitting method presented here does not suffer from\nthe drawbacks discussed above. It is an automated method capable of global optimization in a multi-dimensional parameter\nspace of arbitrary size (Sect. 2.5). As it is automated, it does not\nrequire any human intervention in finding the best fit, avoiding\npotential biases introduced by \"by eye\" interpretations of line\nprofiles. The method described here consists of two main components. The first component is the non-LTE stellar atmosphere\ncode \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764. Section 2.4 gives an overview of the capabilities\nof the code and the assumptions involved. The second component is the genetic algorithm (GA) based optimizing routine\n\uf770\uf769\uf76b\uf761\uf769\uf761 from Charbonneau (1995), which is responsible for optimizing the parameters of the \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models. For the tech-\n\n3\n\nnical details of this routine and more information on GAs we\nrefer to the cited paper and references therein. Here we will suffice with a short description of GAs and a description of the GA\nimplementation with respect to optimization of spectral fits.\n\n2.2. The genetic algorithm implementation\nGenetic algorithms represent a class of heuristic optimization\ntechniques, which are inspired by the notion of evolution by\nmeans of natural selection (Darwin 1859). They provide a\nmethod of solving optimization problems by incorporating this\nbiological notion in a numerical fashion. This is achieved by\nevolving the global solution over subsequent generations starting from a set of randomly guessed initial solutions, so called\nindividuals. Selection pressure is imposed in between generations based on the quality of the solutions, their so called fitness. A higher fitness implies a higher probability the solution\nwill be selected for reproduction. Consequently, only a selected\nset of individuals will pass on their \"genetic material\" to subsequent new generations.\nTo create the new generations discussed above GAs require\na reproduction mechanism. In its most basic form this mechanism consists of two genetic operators. These are the crossover\noperator, simulating sexual reproduction, and the mutation operator, simulating copying errors and random effects affecting\na gene in isolation. An important benefit of these two operators is the fact that they also introduce new genetic material\ninto the population. This allows the GA to explore new regions of parameters space, which is important in view of the\nexistence of local extremes. When the optimization runs into\na local optimum, these two operators, where usually mutation has the strongest effect, allow for the construction of individuals outside of this optimum, thereby allowing it to find\na path out of the local optimum. This capability to escape local extremes, consequently, classifies GAs as global optimizers and is one of the reasons they have been applied to many\nproblems in and outside astrophysics (e.g. Metcalfe et al. 2000;\nGibson & Charbonneau 1998).\nUsing an example we can further illustrate the GA optimization technique. Lets assume that the optimization problem\nis the minimization of some function f . This function has n\nvariables, serving as the genetic building blocks, spanning a\nn dimensional parameter space. The first step in solving this\nproblem is to create an initial population of individuals, which\nare sets of n parameters, randomly distributed in parameter\nspace. For each of these individuals the quality of their solution\nis determined by simply calculating f for the specific parameter values. Now selection pressure is imposed and the fittest\nindividuals, i.e. those that correspond to the lowest values of f ,\nare selected to construct a new generation. As the selected individuals represent the fittest individuals from the population,\nevery new generation will consist of fitter individuals, leading\nto a minimization of f , thereby, solving the optimization problem.\nWith the previous example in mind we can explain our implementation of the GA for solving the optimization problem\nof spectral line fitting, with the following scheme. We start out\n\n\f4\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nwith a first generation of a population of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models randomly distributed in the free parameter space (see Sect. 2.5).\nFor each of these models it is determined how well an observed\nspectrum is fitted by calculating the reduced chi squared, \u03c72red,i ,\nfor each of the fitted lines i. The fitness F, of a model is then\ndefined as the inverted sum of the \u03c72red,i 's, i.e.\n\uf8eb N\n\uf8f6\u22121\n\uf8ec\uf8ec\uf8ecX 2 \uf8f7\uf8f7\uf8f7\nF \u2261 \uf8ec\uf8ec\uf8ed \u03c7red,i \uf8f7\uf8f7\uf8f8 ,\n\n(1)\n\ni\n\nwhere N corresponds to the number of lines evaluated. The\nfittest models are selected and a new generation of models is\nconstructed based on their parameters. From this generation the\nfitnesses of the models are determined and again from the fittest\nindividuals a new generation is constructed. This is repeated\nuntil F is maximized, i.e. a good fit is obtained.\nIn terms of quantifying the fit quality Eq. (1) does not represent a unique choice. Other expressions for the fitness criterium, for instance, the sum of the inverted \u03c72red,i 's of the individual lines, or the inverted \u03c72red of all the spectral points evaluated, also produce the required functionality of an increased\nfitness with an increased fit quality. We have chosen this particular form based on two of its properties. Firstly, the evaluation of the fit quality of the lines enter into the expression\nindividually, ensuring that, regardless of the number of points\nin a certain line, all lines are weighted equally. This allows as\nwell for weighting factors for individual lines, which express\nthe quality with which the stellar atmosphere synthesizes these\nlines (cf. Sect. 3.2). Secondly, using the inverted sum of the\n\u03c72red,i 's instead of the sum of the inverted \u03c72red,i 's avoids having\na single line, which is fitted particularly well, to dominate the\nsolution. Instead the former form demands a good fit of all lines\nsimultaneously.\n\n2.3. Parallelization of the genetic algorithm\nThe ability of global optimization of GAs comes at a price.\nFinding the global minimum requires the calculation of many\ngenerations. In Sect. 2.6 we will show that for the spectra studied in this paper, the evaluation of more than a hundred generations is needed to assure that the global optimum is found. For\na typical population size of \u223c70 individuals, this comes down\nto the calculation of \u223c7000 \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models. With a modern\n3 GHz processor a single \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 model (aiming at the analysis of hydrogen and helium lines) can be calculated within five\nto ten minutes. Consequently, automated fitting on a sequential\ncomputer would be unworkable.\nTo overcome this problem, parallelization of the \uf770\uf769\uf76b\uf761\uf769\uf761 routine is necessary. This parallelization is inspired by the work\nof Metcalfe & Charbonneau (2003). Consequently, our parallel version is very similar to the version of these authors. The\nmain difference between the two versions, is an extra parallelization of the so called elitism option in the reproduction\nschemes (see Metcalfe & Charbonneau). This was treated in a\nsequential manner in the Metcalfe & Charbonneau implementation and has now been parallelized as well.\nDue to the strong inherent parallelism of GAs, the parallel version of our automated fitting method scales very well\n\nwith the number of processors used. Test calculations showed\nthat for configurations in which the population size is an integer\nmultiple of the number of processors the sequential overhead is\nnegligible. Consequently, the runtime scales directly with the\ninverse of the number of processors. Thus enabling the automated fitting of spectra.\n\n2.4. The non-LTE model atmosphere code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764\nFor modeling the optical spectra of our stars we use the latest\nversion of the non-LTE, line-blanketed atmosphere code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 for early-type stars with winds. For a detailed description\nwe refer to Puls et al. (2005). Here we give a short overview of\nthe assumptions made in this method. The code has been developed with the emphasis on a fast performance (hence its name),\nwhich makes it currently the best suited (and realistically only)\nmodel for use in this kind of automated fitting methods.\n\uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 adopts the concept of \"unified model atmospheres\", i.e. including both a pseudo-hydrostatic photosphere\nand a transonic stellar wind, assuring a smooth transition between the two. The photospheric density structure follows from\na self-consistent solution of the equation of hydrostatic equilibrium and accounts for the actual temperature stratification and\nradiation pressure. The temperature calculation utilizes a fluxcorrection method in the lower atmosphere and the thermal balance of electrons in the outer atmosphere (with a lower cut-off\nat T min = 0.5T eff ). In the photosphere the velocity structure,\nv(r), corresponds to quasi-hydrostatic equilibrium; outside of\nthis regime, in the region of the sonic velocity and in the supersonic wind regime it is prescribed by a standard \u03b2-type velocity\nlaw, i.e.\n\u0012\nr\u25e6 \u0013\u03b2\n,\nv(r) = v\u221e 1 \u2212\nr\n\n(2)\n\nwhere v\u221e is the terminal velocity of the wind. The parameter\nr\u25e6 is used to assure a smooth connection, and \u03b2 is a measure of\nthe flow acceleration.\nThe code distinguishes between explicit elements (in our\ncase hydrogen and helium) and background elements (most importantly: C, N, O, Ne, Mg, Si, S, Ar, Fe, Ni). The explicit elements are used as diagnostic tools and are treated with high\nprecision, i.e. by detailed atomic models and by means of comoving-frame transport for the line transitions. The H \uf769 and\nHe \uf769\uf769 model atoms consist of 20 levels each; the He \uf769 model includes levels up to and including n = 10, where levels with\nn \u2265 8 have been packed. The background ions are included to\nallow for the effects of line-blocking (treated in an approximate\nway by using suitable means for the corresponding line opacities) and line-blanketing. Occupation numbers and opacities of\nboth the explicit and the most abundant background ions are\nconstrained by assuming statistical equilibrium. The only difference between the treatment of these types of ions is that for\nthe background ions the Sobolev approximation is used in describing the line transfer (accounting for the actual illumination\nradiation field).\nAbundances of the background elements are taken from the\nsolar values provided by Grevesse & Sauval (1998, and refer-\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nences therein). The He/H ratio is not fixed and can be scaled\nindependently from the background element abundances.\nA comparison between the optical H and He lines as synthesized by \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 and those predicted by the independent\ncomparison code \uf763\uf76d\uf766\uf767\uf765\uf76e (Hillier & Miller 1998) show excellent agreement, save for the He \uf769 singlet lines in the temperature\nrange between 36 000 and 41 000 K for dwarfs and between\n31 000 and 35 000 K for supergiants, where \uf763\uf76d\uf766\uf767\uf765\uf76e predicts\nweaker lines. We give account of this discrepancy, and therefore of an increased uncertainty in the reproduction of these\nlines, by introducing weighting factors, which for the He \uf769 singlets of stars in these ranges are lower (cf. Sect. 3.2).\n\n5\n\nboundaries for T eff are set based on the spectral type and luminosity class of the studied object. Usually the size of this range\nis set to approximately 5000 K. The log g range is delimited\nso that the implied stellar mass lies between reasonable boundaries. For instance for the B1 I star Cyg OB2 #2 the adopted T eff\nrange together with its absolute visual magnitude imply a possible range in R\u22c6 of [11.5:12.0]R\u2299. For the automated fit we set\nthe minimum and maximum log g to 3.1 and 3.8, respectively,\nwhich sets the corresponding mass range that will be investigated to [5.0:25.2] M\u2299 . For the mass loss rate we adopt a conservative range of at least one order of magnitude. As example\nfor the analysis of Cyg OB2 #2 we adopted lower and upper\nboundaries of 4 \u00d7 10\u22128 and 2 \u00d7 10\u22126 M\u2299 yr\u22121 , respectively.\n\n2.5. Fit parameters\nThe main parameters which will be determined from a spectral\nfit using \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 are the effective temperature T eff , the surface\ngravity g, the microturbulent velocity vturb , the helium over hydrogen number density YHe , the mass loss rate \u1e40 and the exponent of the beta-type velocity law \u03b2. These parameters span the\nfree parameter space of our fitting method. The stellar radius,\nR\u22c6 , is not a free parameter as its value is constrained by the\nabsolute visual magnitude MV . To calculate R\u22c6 we adopt the\nprocedure outlined in Kudritzki (1980), i.e.\n5 log R/R\u2299 = 29.57 \u2212 (MV \u2212 V) ,\n\n(3)\n\nwhere V is the visual flux of the theoretical model given by\nZ \u221e\n\u2212 2.5 log\nF\u03bb S \u03bb d\u03bb .\n(4)\n0\n\nIn the above equation S \u03bb is the V-filter function of\nMatthews & Sandage (1963) and F\u03bb is the theoretical stellar\nflux. Note that as R\u22c6 is an input parameter, F\u03bb is not known\nbefore the \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 model is calculated. Therefore, during the\nautomated fitting we approximate F\u03bb by a black body radiating\nat T = 0.9T eff (cf. Markova et al. 2004). After the fit is completed we use the theoretical flux from the best fit model to calculate the non approximated stellar radius. Based on this radius\nwe rescale the mass loss rate using the invariant wind-strength\nparameter Q (Puls et al. 1996; de Koter et al. 1997)\nQ=\n\n\u1e40\n3\n\n.\n\n(5)\n\n(v\u221e R\u22c6 ) 2\n\nThe largest difference between the approximated and final stellar radius for the objects studied here, is \u223c2 percent. The corresponding rescaling in \u1e40 is approximately three percent.\nThe projected rotation velocity, vr sin i, and terminal velocity of the wind are not treated as free parameters. The value of\nvr sin i is determined from the broadening of weak metal lines\nand the width of the He \uf769 lines. For v\u221e we adopt values obtained from the study of ultraviolet (UV) resonance lines, or, if\nnot available, values from calibrations are used.\nOur fitting method only requires the size of the free parameter domain to be specified. For the objects studied in this paper\nwe keep the boundaries between which the parameters are allowed to vary, fixed for vturb , YHe and \u03b2. The adopted ranges,\nrespectively, are [0, 20] km s\u22121 , [0.05, 0.30] and [0.5, 1.5]. The\n\n2.6. Formal tests of convergence\nBefore we apply our automated fitting method to real spectra, we first test whether the method is capable of global optimization. For this we perform convergence tests using synthetic\ndata. The main goal of these tests is to determine how well and\nhow fast the input parameters, used to create the synthetic data,\ncan be recovered with the method. The speed with which the\ninput parameters are recovered, i.e. the number of generations\nneeded to find the global optimum, can then be used to determine how many generations are needed to obtain the best fit for\na real spectrum. In other words, when the fit has converged to\nthe global optimum.\nThree synthetic datasets, denoted by A, B and C, were created with the following procedure. First, line profiles of Balmer\nhydrogen lines and helium lines in the optical blue and H\u03b1\nin the red calculated by \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 were convolved with a rotational broadening profile. Table 1 lists the parameters of the\nthree sets of models as well as the projected rotational velocity used. A second convolution with a Gaussian instrumental\nprofile was applied to obtain a spectral resolution of 0.8 \u00c5 and\n1.3 \u00c5 for, respectively, the H\u03b1 line and all other lines. These\nvalues correspond to the minimum resolution of the spectra fitted in Sect. 3. Finally, Gaussian distributed noise, corresponding to a signal to noise value of 100, was added to the profiles.\nDataset A represents an O3 I star with a very dense stellar wind\n( \u1e40 = 10\u22125 M\u2299 yr\u22121 ), while set B is that of an O5.5 I with a\nmore typical O-star mass loss. The last set C is characteristic\nfor a B0 V star with a very tenuous wind of only 10\u22128 M\u2299 yr\u22121 .\nFrom the synthetic datasets we fitted nine lines, three hydrogen, three neutral helium and three singly ionized helium\nlines, corresponding to the minimum set of lines fitted for a\nsingle object in Sect. 3. The fits were obtained by evolving a\npopulation of 72 \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models over a course of 200 generations. In this test and throughout the remainder of the paper we\nuse \uf770\uf769\uf76b\uf761\uf769\uf761 with a dynamically adjustable mutation rate, with the\nminimum and maximum mutation rate set to the default values\n(see Charbonneau & Knapp 1995). Selection pressure, i.e. the\nweighting of the probability an individual will be selected for\nreproduction based on its fitness, was also set to the default\nvalue.\nTable 1 lists the parameter ranges in which the method was\nallowed to search, i.e. the minimum and maximum values al-\n\n\f6\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nTable 1. Input parameters of the formal test models (\"In\" column) and parameters obtained with the automated fitting method by\nfitting synthetic data created from these models (\"Out\" column). Results were obtained by evolving a population of 72 \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764\nmodels over 200 generations.\n\nSet A\nIn\n\nSearch\nrange\n\nOut\n\nSet B\nIn\n\nSearch\nrange\n\nOut\n\nSearch\nrange\n\nOut\n\nSpectral type\n\nO3 I\n\nT eff [kK]\n\n45.0\n\n[42, 47]\n\n45.0\n\n37.5\n\n[35, 40]\n\n37.6\n\n30.0\n\n[28, 34]\n\n29.9\n\nlog g [cm s ]\n\n3.80\n\n[3.5, 4.0]\n\n3.84\n\n3.60\n\n[3.3, 3.9]\n\n3.57\n\n4.00\n\n[3.7, 4.3]\n\n3.95\n\nR\u22c6 [R\u2299 ]\nlog L\u22c6 [L\u2299 ]\n\n17.0\n\n-\n\n4.67\n\n\u22122\n\nO5.5 I\n\nSet C\nIn\n\n20.0\n\n6.03\n\n\u22121\n\nvturb [km s ]\n\nB0 V\n\n-\n\n5.85\n\n8.0\n-\n\n5.0\n\n[0, 20]\n\n5.9\n\n10.0\n\n[0, 20]\n\n9.7\n\n15.0\n\n[0, 20]\n\n14.8\n\n0.15\n\n[0.05, 0.30]\n\n0.15\n\n0.10\n\n[0.05, 0.30]\n\n0.10\n\n0.10\n\n[0.05, 0.30]\n\n0.10\n\n\u1e40 [10 M\u2299 yr ]\n\u03b2\n\n10.0\n\n[1.0, 20.0]\n\n9.3\n\n5.0\n\n[1.0, 10.0]\n\n5.3\n\n0.01\n\n[0.001, 0.2]\n\n0.008\n\n1.20\n\n[0.5, 1.5]\n\n1.18\n\n1.00\n\n[0.5, 1.5]\n\n0.99\n\n0.80\n\n[0.5, 1.5]\n\n0.93\n\nv\u221e [km s\u22121 ]\n\n2500\n\n-\n\n2200\n\n-\n\n2000\n\n-\n\n150\n\n-\n\n120\n\n-\n\n90\n\n-\n\nYHe\n\u22126\n\n\u22121\n\n\u22121\n\nvr sin i [km s ]\n\nlowed for the parameters of the \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models. As v\u221e and\nvr sin i are not free parameters these were set equal to the input\nvalues.\nIn all the three test cases the automated method was able to\nrecover the global optimum. Table 1 lists the parameters of the\nbest fit models obtained by the method in the \"Out\" columns.\nCompared to the parameters used to create the synthetic data,\nthere is very good agreement. Moderate differences (of a 1520% level) are found for vturb recovered from dataset A and\nfor the wind parameters \u03b2 and \u1e40 recovered from dataset C.\nThis was to be expected. In the case of the wind parameters\nthe precision with which information about these parameters\ncan be recovered from the line profiles decreases with decreasing wind density (e.g. Puls et al. 1996). Still, the precision with\nwhich the wind parameters are recovered for the weak wind\ndata set C, is remarkable.\nA similar reasoning applies for the microturbulent velocity recovered from data set A. For low values of the microturbulence, i.e. vturb < vth , thermal broadening will dominate\nover broadening due to microturbulence. This decreases the\nprecision with which this parameter can be recovered from the\nline profiles. Realizing that in case of this dataset for helium\nvth \u2248 14 km s\u22121 , again, the precision with which vturb is recovered, is impressive.\nTo illustrate how quickly and how well the input parameters are recovered Fig. 1 shows the evolution of the fit parameters during the fit of synthetic dataset B. Also shown, as a grey\ndashed line, is the fitness of the best fitting model found, during the run. This fitness is normalized with respect to the fitness\nof the model used to create the synthetic data (the data being\nthe combination of this model and noise). Note that the final\nmaximum normalized fitness found by the method exceeds 1.0,\nwhich is due to the added noise allowing a further fine tuning\nof the parameters by the GA based optimization. As can be\n\nseen in this figure the method modifies multiple parameters simultaneously to produce a better fit. This allows for an efficient\nexploration of parameter space and, more importantly, it allows\nfor the method to actually find the global optimum.\nIn the case of dataset B finding the global optimum required\nonly a few tens of generations (\u223c30). For the other two datasets\nall save one parameter were well established within this number of generations. To establish the very low value of vturb in\ndataset A and the very low \u1e40 in dataset C required \u223c100 generations. We will adopt 150 generations to fit the spectra in\nSect. 3. One reason, obviously, is that to safeguard that the\nglobal optimum is found. A second reason, however, is that it\nassures that the errors on the model parameters that we determine are meaningful (i.e. it assures that the error on the error is\nmodest).\nWe consider doing such a formal test as performed above\nas part of the analysis of a set of observed spectra, as the exact\nnumber of generations required is, in principle, a function of\ne.g. the signal-to-noise ratio and the spectral resolution. Also,\nspecial circumstances may play a role, such as potential nebular\ncontamination (in which case the impact of removing the line\ncores from the fit procedure needs to be assessed).\n\n3. Spectral analysis of early-type stars\nIn this section we apply our fitting method to seven stars in the\nopen cluster Cyg OB2, previously analysed by Herrero et al.\n(2002) and five \"standard\" early-type stars, 10 Lac, \u03c4 Sco,\n\u03b6 Oph, HD 15629 and HD 217086, previously analysed by various authors.\n\n3.1. Description of the data\nTable 2 lists the basic properties of the data used for the analysis. All spectra studied have a S/N of at least 100. The spectral\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n39\n\n7\n\n3.6\n1.0\n\nTeff [kK]\n\n-2\n\nlogg [cm s ]\n\n1.0\n0.9\n38\n0.8\n\n0.9\n3.5\n0.8\n\n0.7\n\n0.7\n\n37\n\n3.4\n0\n\n25\n\n50\n\n75\n\n0\n\n7.0\n\n50\n\n1.0\n\n-1\n\ndM/dt [10 Msun yr ]\n\n25\n\n75\n\n1.2\n\n6.0\n\n1.0\n0.9\n\n-6\n\n\u03b2\n\n0.9\n1.0\n\n0.8\n\n5.0\n\n0.8\n\n0.7\n\n0.7\n\n4.0\n\n0.8\n0\n\n25\n\n50\n\n75\n\n0\n\n0.14\n\n25\n\n50\n\n75\n\n12.0\n\n-1\n\n0.12\n\n1.0\nvturb [km s ]\n\n1.0\n\nYHe\n\n0.9\n0.8\n\n0.10\n\n8.0\n0.9\n0.8\n\n4.0\n\n0.7\n0.08\n\n0.7\n0.0\n\n0\n\n25\n\n50\n\n75\n\ngeneration\n\n0\n\n25\n\n50\n\n75\n\ngeneration\n\nFig. 1. Evolution of the best fitting model parameters for formal test B. From the 200 generation run only the first 75 generations\nare shown. For this specific data set the location of the global optimum is found within 50 generations. This is indicated by the\nhighest fitness found during the run, which is shown as a grey dashed line and is scaled to the right vertical axis. The fitness is\nnormalized with respect to the fitness of the model used to create the synthetic data (the data being this model plus noise).\nresolution of the data in the blue (regions between \u223c4000 and\n\u223c5000 \u00c5) and the red (region around H\u03b1) is given in Tab. 2.\nThe optical spectra of the stars in Cyg OB2 were obtained\nby Herrero et al. (1999) and Herrero et al. (2000). Absolute\nvisual magnitudes of the Cyg OB2 objects were adopted\nfrom Massey & Thompson (1991), and correspond to a distance modulus of 11.2m . Note that for object #8A Tab. 7 in\nMassey & Thompson contains an incorrect V0 value of 4.08m .\nThis should have been 4.26m conform the absorption given in\nthis table and the visual magnitude in their Tab. 2. For vr sin i\nvalues determined by Herrero et al. (2002) are used, with the\nexception of objects #8A and #10. For these we found that\nthe He \uf769 and metal lines are somewhat better reproduced if\nwe adopt vr sin i that are higher by \u223c35% and \u223c10%, respectively. Terminal flow velocities of the wind have been obtained\nfrom UV spectra obtained with Hubble Space Telescope (cf.\nHerrero et al. 2001). Data of HD 15629, HD 217086 and \u03b6 Oph\nare from Herrero et al. (1992) and Herrero (1993). For MV , v\u221e\nand vr sin i values given by Repolust et al. (2004) are adopted.\nThe distances to these objects are based on spectroscopic parallaxes, except for \u03b6 Oph which has a reliable Hipparcos distance\n(Schr\u00f6der et al. 2004).\nThe spectrum of 10 Lac was obtained by Herrero et al.\n(2002). The absolute visual magnitude of this star is from\n\nHerrero et al. (1992). For v\u221e we adopted the minimum value\nwhich is approximately equal to the escape velocity at the stellar surface of this object. For the projected rotational velocity\nwe adopt 35 km s\u22121 . The blue spectrum of \u03c4 Sco is from Kilian\n(1992). The red region around H\u03b1 was observed by Zaal et al.\n(1999). For \u03c4 Sco we also adopt the Hipparcos distance. This\ndistance results in an absolute visual magnitude which is rather\nlarge for the spectral type of this object, but is in between the\nMV adopted by Kilian (1992) and Humphreys (1978). For the\nprojected rotational velocity a value of 5 km s\u22121 was adopted.\n\n3.2. Lines selected for fitting and weighting scheme\nFor the analysis \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 will fit the hydrogen and helium spectrum of the investigated objects. Depending on the wavelength\nrange of the available data, these lines comprise for hydrogen\nthe Balmer lines H\u03b1, H\u03b2, H\u03b3 and H\u03b4; for He \uf769 the singlet lines at\n4387 and 4922 \u00c5, the He \uf769 triplet lines at 4026, which is blended\nwith He \uf769\uf769, 4471 and 4713 \u00c5; and finally for He \uf769\uf769 the lines at\n4200, 4541 and 4686 \u00c5.\nFor an efficient and reliable use of the automated method\nwe have to incorporate into it the expertise that we have developed in the analysis of OB stars. The method has to take into\naccount that some lines may be blended or that they cannot\n\n\f8\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nTable 2. Basic parameters of the early type stars studied here. Spectral types are taken from Massey & Thompson (1991),\nWalborn (1972, 1973) and Conti & Alschuler (1971). Blue and red resolution, respectively, correspond to the region between\n\u223c4000 and \u223c5000 \u00c5 and the region around H\u03b1.\n\nStar\n\nSpectral\nType\n\nMV\n\nBlue\nresolution [\u00c5]\n\nRed\nresolution [\u00c5]\n\nCyg OB2 #7\n\nO3 If\u2217\n\n\u22125.91\n\n0.6\n\n0.8\n\n105\n\n3080\n\nCyg OB2 #11\n\nO5 If+\n\n\u22126.51\n\n1.3\n\n0.8\n\n120\n\n2300\n\nCyg OB2 #8C\n\nO5 If\n\n\u22125.61\n\n1.3\n\n0.8\n\n145\n\n2650\n\nCyg OB2 #8A\n\nO5.5 I(f)\n\n\u22126.91\n\n0.6\n\n0.8\n\n130\n\n2650\n\nCyg OB2 #4\n\nO7 III((f))\n\n\u22125.44\n\n1.3\n\n0.8\n\n125\n\n2550\n\nCyg OB2 #10\n\nO9.5 I\n\n\u22126.86\n\n0.6\n\n0.8\n\n95\n\n1650\n\nCyg OB2 #2\n\nB1 I\n\n\u22124.64\n\n0.6\n\n0.8\n\n50\n\n1250\n\nHD 15629\n\nO5 V((f))\n\n\u22125.50\n\n0.6\n\n0.8\n\n90\n\n3200\n\nHD 217086\n\nO7 Vn\n\n\u22124.50\n\n0.6\n\n0.8\n\n350\n\n2550\n\n10 Lac\n\nO9 V\n\n\u22124.40\n\n0.6\n\n0.6\n\n35\n\n1140\n\n\u03b6 Oph\n\nO9 V\n\n\u22124.35\n\n0.6\n\n0.8\n\n400\n\n1550\n\n\u03c4 Sco\n\nB0.2 V\n\n\u22123.10\n\n0.2\n\n0.2\n\n5\n\n2000\n\nTable 3. Line weighting scheme adopted for different spectral\ntypes and luminosity classes for the objects fitted in this paper.\nLate, mid and early spectral type correspond to, respectively,\n[O2-O5.5], [O6-O7.5] and [O8-B1]. The weights are implemented in the fitness definition according to Eq. (6) and have\nvalues of 1.0, 0.5 and 0.25 in case of h, m and l, respectively.\n\nDwarfs\nLate Mid Early\n\nSuper Giants\nLate Mid Early\n\nH Balmer\n\nh\n\nh\n\nh\n\nh\n\nh\n\nh\n\nHe \uf769 singlets\n\nh\n\nl\n\nl\n\nh\n\nl\n\nl\n\nHe \uf769 4026\n\nh\n\nh\n\nh\n\nh\n\nh\n\nh\n\nHe \uf769 4471\n\nh\n\nh\n\nh\n\nl\n\nm\n\nh\n\nHe \uf769 4713\n\nh\n\nh\n\nh\n\nh\n\nh\n\nh\n\nHe \uf769\uf769 4686\n\nh\n\nm\n\nm\n\nm\n\nm\n\nm\n\nHe \uf769\uf769 4541\n\nh\n\nh\n\nh\n\nh\n\nh\n\nh\n\nHe \uf769\uf769 4200\n\nm\n\nm\n\nm\n\nm\n\nm\n\nm\n\nbe completely reproduced by the model atmosphere code for\nwhatever reason For example, the so-called \"generalized dilution effect\" Voels et al. (1989), present in the He \uf769 \u03bb4471 line in\nlate type supergiants, that is still lacking an explanation.\nTo that end we have divided the stars in two classes\n(\"dwarfs\" and \"supergiants\", following their luminosity class\nclassification1 ), and three groups in each class (following spectral types). We have then a total of six stellar groups, and\n1\n\nFor the one giant in our sample, Cyg OB2 #4, we have adopted\nthe line weighting scheme for dwarfs.\n\nvr sin i\n[km s\u22121 ]\n\nv\u221e\n[km s\u22121 ]\n\nhave assigned the spectral lines different weights depending\non their behaviour in each stellar group. This behaviour represents the expertise from years of \"by eye\" data analysis that\nis being translated to the method. Three different weights are\nassigned to each line: high, to lines very reliable for the analysis; medium, and low. The implementation of these weights\ninto the fitness definition is given by\n\uf8f6\u22121\n\uf8eb N\n\uf8f7\uf8f7\n\uf8ec\uf8ec\uf8ecX\n2\n(6)\nF \u2261 \uf8ec\uf8ec\uf8ed wi \u03c7red,i \uf8f7\uf8f7\uf8f7\uf8f8 ,\ni\n\nwhere the parameter wi corresponds to the weight of a specific\nline.\nTable 2 gives the weights assigned to each line in each stellar group. We will only briefly comment on the low or medium\nweights. He \uf769 singlets are assigned a low weight for mid-type\nstars because of the singlet differential behaviour found between \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 and \uf763\uf76d\uf766\uf767\uf765\uf76e (Puls et al. 2005), while they are\nvery weak for early-type stars. In these two cases therefore we\nprefer to rely on the triplet He \uf769 \u03bb4471 line. To this line, however, a low weight is assigned at late-type Supergiants because\nof the above mentioned dilution effect.\nHe \uf769\uf769 \u03bb4686 is only assigned a medium weight (except for\nlate type dwarfs), as this line is not always completely consistent with the mass-loss rates derived from Halpha. He \uf769\uf769 \u03bb4200\nis sometimes blended with N \uf769\uf769\uf769 \u03bb4200, and sometimes it is not\ncompletely consistent with the rest of the He \uf769\uf769 lines. He \uf769 and\nHe \uf769\uf769 lines at 4026 \u00c5 do overlap, but for both lines we find a\nconsistent behaviour.\nThe highest weight is therefore given to the Balmer lines\nplus the He \uf769\uf769 \u03bb4541 and the He \uf769/He \uf769\uf769 4026 lines, which define\nthe He ionization balance with He \uf769 \u03bb4471 or the singlet He \uf769\nlines. Note however that, as discussed above, all lines fit simultaneously in a satisfactory way for our best fitting models.\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\n9\n\nTable 4. Results obtained for the investigated early type stars using GA optimized spectral fits. The spectra were fitted by\nevolving a population of 72 \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models over a course of 150 generations. Spectroscopic masses Ms are calculated with the\ngravities corrected for centrifugal acceleration log gc . Evolutionary masses Mev are from Schaller et al. (1992). The error bars on\nthe derived parameters are given in Tab. 5 and are discussed in Sect. 4.\n\nStar\nCyg OB2 #7\n\n45.8\n\n3.93\n\n3.94\n\nR\u22c6\n[R\u2299 ]\n14.4\n\nCyg OB2 #11\n\n36.5\n\n3.62\n\n3.63\n\n22.1\n\nCyg OB2 #8C\n\n1)\n\nT eff\n[kK]\n\n41.8\n\nlog g\n[cm s\u22122 ]\n\n3.73\n\nlog gc\n[cm s\u22122 ]\n\n3.74\n\n13.3\n\nlog L\u22c6\n[L\u2299 ]\n5.91\n\n0.21\n\n5.89\n\n0.10\n\n5.69\n\nYHe\n\n0.13\n\nvturb\n[km s\u22121 ]\n19.9\n\n\u1e40\n[M\u2299 yr\u22121 ]\n9.98*10\u22126\n\n19.8\n\n7.36*10\u22126\n\n0.5\n\n\u22126\n\n3.37*10\n\n\u22125\n\n0.77\n\nMs\n[M\u2299 ]\n65.1\n\nMev\n[M\u2299 ]\n67.8\n\n1.03\n\n75.9\n\n55.6\n\n0.85\n\n36.0\n\n49.2\n\n\u03b2\n\nCyg OB2 #8A\n\n38.2\n\n3.56\n\n3.57\n\n25.6\n\n6.10\n\n0.14\n\n18.3\n\n1.04*10\n\n0.74\n\n89.0\n\n74.4\n\nCyg OB2 #4\n\n34.9\n\n3.50\n\n3.52\n\n13.7\n\n5.40\n\n0.10\n\n18.9\n\n8.39*10\u22127\n\n1.16\n\n22.4\n\n32.5\n\nCyg OB2 #10\n\n29.7\n\n3.23\n\n3.24\n\n29.9\n\n5.79\n\n0.08\n\n17.0\n\n2.63*10\u22126\n\n1.05\n\n56.0\n\n45.9\n\nCyg OB2 #2\n\n28.7\n\n3.56\n\n3.57\n\n11.3\n\n4.88\n\n0.08\n\n16.5\n\n1.63*10\u22127\n\n0.801)\n\n17.0\n\n18.7\n\nHD 15629\n\n42.0\n\n3.81\n\n3.82\n\n12.6\n\n5.64\n\n0.10\n\n8.6\n\n9.28*10\u22127\n\n1.18\n\n37.8\n\n47.4\n\n\u22127\n\nHD 217086\n\n38.1\n\n3.91\n\n4.01\n\n8.30\n\n5.11\n\n0.09\n\n17.1\n\n2.09*10\n\n1.27\n\n25.7\n\n28.5\n\n10 Lac\n\n36.0\n\n4.03\n\n4.03\n\n8.27\n\n5.01\n\n0.09\n\n15.5\n\n6.06*10\u22128\n\n0.801)\n\n26.9\n\n24.9\n\n\u03b6 Oph\n\n32.1\n\n3.62\n\n3.83\n\n8.9\n\n4.88\n\n0.11\n\n19.7\n\n1.43*10\u22127\n\n0.801)\n\n19.5\n\n20.3\n\n\u03c4 Sco\n\n31.9\n\n4.15\n\n4.15\n\n5.2\n\n4.39\n\n0.12\n\n10.8\n\n6.14*10\u22128\n\n0.801)\n\n13.7\n\n16.0\n\nassumed fixed value\n\n3.3. Fits and comments on the individual analysis\nIn the following we will present the fits that were obtained by\nthe automated method for our sample of 12 early type stars,\nand comment on the individual analysis of the objects. Listed\nin Tab. 4 are the values determined for the six free parameters\ninvestigated and quantities derived from these.\n\n3.3.1. Analysis of the Cyg OB2 stars\nThe Cyg OB2 objects studied here were previously analysed\nby Herrero et al. (2002, hereafter HPN). We opted to reanalyse these stars (to test our method) as these stars have equal\ndistances and have been analysed in a homogeneous way using (an earlier version of) the same model atmosphere code. In\nSect. 5 we will systematically compare our results with those\nobtained by HPN. Here, we will incidentally discuss the agreement if this turns out to be relatively poor or if the absolute\nvalue of a parameter seems unexpected, and we wanted to test\npossible causes for the discrepancy.\nCyg OB2 #7 The best fit obtained with our automated fitting\n\nmethod for Cyg OB2 #7 is shown in Fig. 2. For all hydrogen\nlines fitted, including H\u03b4 not shown here, and all He \uf769\uf769 lines the\nfits are of very good quality. Note that given the noise level the\nfits of the He \uf769 lines are also acceptable.\nInteresting to mention is the manner in which the He \uf769 and\nHe \uf769\uf769 blend at 4026 \u00c5 is fitted. At first sight, i.e. \"by eye\", it\nseems that the fit is of poor quality, as the line wings of the\nsynthetic profile runs through \"features\" which might be attributed to blends of weak photospheric metal lines. However,\nthe broadest of these features have a half maximum width of\n\n\u223c70 km s\u22121 , which is much smaller than the projected rotational velocity of 105 km s\u22121 . Consequently, these features are\ndominated by pure noise.\nCompared to the investigation of HPN we have partial\nagreement between the derived parameters. The mass loss rate,\nT eff and to a lesser degree \u03b2 agree very well. For log g and\nthe helium abundance we find, however, large differences. The\nlog g value obtained here is \u223c0.2 dex larger, which results in\na spectroscopic mass of 65.1 M\u2299 . A value which is in good\nagreement with the evolutionary mass of 67.8 M\u2299 .\nThe helium abundance needed to fit this object is 0.21,\nwhich is considerably lower than the value obtained by HPN,\nwho found an abundance ratio of 0.31. This large value still\ncorresponds to a strong helium surface enrichment. An interesting question we need to address, is whether this is a real\nenrichment and not an artifact that is attributable to a degeneracy effect of T eff and YHe . The latter can be the case, as no\nHe \uf769 lines are present in the optical spectrum of Cyg OB2 #7.\nThis issue can be resolved with our fitting method by refitting\nthe spectrum with a helium abundance fixed at a lower value\nthan previously obtained. If T eff and YHe are truly degenerate\nthis would again yield a good fit, however for a different T eff .\nShown as dotted lines in Fig. 2 are the results of refitting\nCyg OB2 #7 with a helium abundance fixed at the solar value.\nFor this lower YHe a T eff that is lower by \u223c2.1 kK was obtained.\nThis was to be expected as for this temperature regime He \uf769\uf769\uf769\nis the dominant ionization stage. When consequently YHe is reduced a reduction of the temperature is required to fit the He \uf769\uf769\nlines. The reduction of T eff obtained is the maximum for which\nstill a good fit of the hydrogen lines is possible and the He \uf769\nlines do not become too strong. More importantly, in Fig. 2 it\nis shown that even with this large reduction of T eff the He \uf769\uf769\n\n\f10\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b3\n\nH\u03b2\n\nH\u03b1\n\n1.00\n\n1.00\n\n1.10\n\n0.90\n\n0.90\n\n1.05\n\nHeI + HeII 4026\n\nHeI 4387\n1.02\n\n1.00\n\n0.95\n0.80\n\n1.00\n\n1.00\n\n0.80\n\n0.90\n0.70\n4340\n\n4350\n\n0.98\n\n0.95\n\n0.70\n4330\n\n4850\n\nHeI 4471\n\n4860\n\n4870\n\n6520\n\nHeI 4922\n\n1.02\n\n1.02\n\n1.00\n\n1.00\n\n6560\n\n6600\n\n4020\n\nHeII 4200\n\n4025\n\n4030\n\nHeII 4541\n\n1.00\n\n1.10\n0.90\n\n0.98\n4472\n\n4476\n\n4392\n\nHeII 4686\n\n1.05\n\n0.90\n\n4468\n\n4388\n\n1.15\n\n1.00\n\n0.95\n\n0.98\n\n4384\n\n0.80\n\n0.85\n4915\n\n4920\n\n4925\n\n4190\n\n4200\n\n4210\n\n1.00\n4530\n\n4540\n\n4550\n\n4680\n\n4690\n\n4700\n\nFig. 2. Comparison of the observed line profiles of Cyg OB2 #7 with the best fit obtained by the automated fitting method\n(dashed lines). Note that the He \uf769\uf769 line at 6527.1 \u00c5 is not included in the fit and, therefore, disregarded by the automated method.\nHorizontal axis gives the wavelength in \u00c5. Vertical axises give the continuum normalized flux and are scaled differently for each\nline. In this figure the dotted lines correspond to a fit obtained for a helium abundance fixed at 0.1. See text for further comments.\nH\u03b3\n\nH\u03b2\n\n1.00\n\nH\u03b1\n\nHeI 4387\n1.01\n\n1.20\n\n1.00\n\n0.90\n\nHeI 4471\n\n1.00\n1.00\n\n1.10\n0.90\n\n0.96\n0.99\n\n0.80\n\n1.00\n0.80\n\n0.92\n\n0.98\n\n0.70\n0.90\n4330\n\n4340\n\n4350\n\n4850\n\nHeI 4922\n\n4860\n\n4870\n\n6520\n\nHeII 4200\n\n1.01\n\n6560\n\n6600\n\n4384\n\nHeII 4541\n\n1.00\n\n4468\n\n4472\n\n4476\n\n1.15\n\n0.95\n\n1.10\n\n0.95\n0.90\n\n0.99\n\n4392\n\nHeII 4686\n\n1.00\n\n1.00\n\n4388\n\n1.05\n\n0.90\n0.85\n\n0.98\n4915\n\n4920\n\n4925\n\n4190\n\n4200\n\n4210\n\n1.00\n4530\n\n4540\n\n4550\n\n4680\n\n4690\n\n4700\n\nFig. 3. Same as Fig. 2, however for Cyg OB2 #11\nlines cannot be fitted. This implies that T eff and YHe are not\ndegenerate and the obtained helium enrichment is real.\n\nobject in terms of its modified wind momentum (cf. Sect. 5.4)\nis in better accord with that of the bulk of the stars investigated\nin this paper.\n\nCyg OB2 #11 Figure 3 shows the fit to Cyg OB2 #11. In gen-\n\neral all lines are reproduced correctly. There is a slight under prediction of the cores of H\u03b3 and He \uf769\uf769 \u03bb4541, a problem\nthat was also pointed out by Herrero et al. (1992) and HPN.\nPossibly this is due to too much filling in of the predicted\nprofiles by wind emission. Part of the He \uf769\uf769 \u03bb4541 discrepancy might be related to problems in the theoretical broadening\nfunctions (see Repolust et al. 2005).\nThe parameters obtained for this object, with exception of\n\u1e40, are in agreement with the parameters derived by HPN. With\nour automated method a mass loss rate lower by \u223c0.1 dex was\nobtained. Note that due to this lower value the behaviour of this\n\nCyg OB2 #8C The best fit for Cyg OB2 #8C is shown in\n\nFig. 4. Again, with exception of the mass loss rate, the parameters we obtain for this object are in good agreement with the\nfindings of HPN. We do find a small helium abundance enhancement, whereas HPN found a solar value.\nTo fit the P Cygni type profile of He \uf769\uf769 at 4686 \u00c5, the automated method used a \u1e40 which, compared to these authors,\nwas higher by approximately 0.15 dex. This higher value for\nthe mass loss rate results in a H\u03b1 profile which, at first sight,\nlooks to be filled in too much by wind emission. To assess\nwhether this could correspond to a significant overestimation of\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b3\n\nH\u03b2\n\n1.00\n\nH\u03b1\n\nHeI 4387\n\n1.00\n\n0.90\n\n0.80\n\n0.80\n\nHeI 4471\n\n1.01\n\n1.00\n0.90\n\n11\n\n0.95\n\n1.00\n\n0.98\n\n1.00\n\n0.90\n0.96\n0.99\n\n0.70\n\n0.85\n\n0.70\n4330\n\n4340\n\n4350\n\n4850\n\nHeI 4922\n\n4860\n\n4870\n\n6540\n\nHeII 4200\n\n1.01\n\n1.00\n\n1.00\n\n0.95\n\n6560\n\n6580\n\n4384\n\nHeII 4541\n\n4388\n\n4392\n\n4468\n\n4472\n\n4476\n\nHeII 4686\n1.05\n\n1.00\n\n0.95\n1.00\n0.90\n0.90\n0.99\n\n0.95\n\n0.85\n4915\n\n4920\n\n4925\n\n4190\n\n4200\n\n4210\n\n4530\n\n4540\n\n4550\n\n4680\n\n4690\n\n4700\n\nFig. 4. Same as Fig. 2, however for Cyg OB2 #8C. Shown with a dotted line for H\u03b1 and He \uf769\uf769 \u03bb4686 are the line profiles of a\nmodel with a 0.05 dex lower \u1e40, which \"by eye\" fits the core of H\u03b1. See text for further comments.\nH\u03b4\n\nH\u03b3\n\nH\u03b2\n\n1.00\n\n1.00\n\n0.90\n\n0.90\n\nH\u03b1\n\n1.00\n\n1.05\n\n0.90\n\n1.00\n\n0.80\n\n0.95\n\nHeI 4387\n1.02\n\n1.00\n0.80\n\n0.80\n\n0.70\n0.70\n\n0.90\n\n0.70\n4090\n\n4100\n\n4110\n\n4330\n\nHeI 4471\n\n4340\n\n4350\n\n4850\n\nHeI 4922\n\n4860\n\n4870\n\n0.98\n6530\n\nHeII 4200\n\n1.02\n\n6590\n\n4384\n\nHeII 4541\n\n4388\n\n4392\n\nHeII 4686\n\n1.00\n\n1.00\n\n1.00\n\n6560\n\n1.05\n0.95\n1.00\n\n0.96\n\n0.90\n\n1.00\n\n0.90\n0.92\n\n0.95\n\n0.98\n4468\n\n4472\n\n4476\n\n0.85\n4915\n\n4920\n\n4925\n\n0.80\n4190\n\n4200\n\n4210\n\n4530\n\n4540\n\n4550\n\n4680\n\n4690\n\n4700\n\nFig. 5. Same as Fig. 2, however for Cyg OB2 #8A. The dotted lines correspond to a model with a \u1e40 higher by 0.04 dex. This\nmass loss rate was obtained by fitting the best fit model, found by the automated method, \"by eye\" to the H\u03b1 core. Even though\nthe fit obtained with the higher \u1e40 results in a fit of H\u03b1 which is more pleasing to the eye in the line core, this higher mass loss\nrate does not describe this object the best. This can be seen best from the reduced fit quality of the other hydrogen Balmer lines\nand the severe mismatch of He \uf769 \u03bb4471. See text for further comments.\nthe mass loss rate, we lowered \u1e40 in the best fit model by hand\nuntil the core of H\u03b1 was fitted. In Fig. 4 the resulting line profiles are shown as a dotted line for H\u03b1 and He \uf769\uf769 \u03bb4686, which\nfor this fit are the lines which visibly reacted to the change in\nmass loss rate. To obtain this fit \"by eye\" of the H\u03b1 core, a\nreduction of \u1e40 with merely 0.05 dex was required, showing\nthat the mass loss rate was not overestimated by the automated\nmethod. Note that for this lower mass loss rate the fit of the\nHe \uf769\uf769 \u03bb4686 becomes significantly poorer.\n\nCyg OB2 #8A De Becker et al. (2004) report this to be a O6 I\n\nand O5.5 III binary system, therefore the derived parameters,\nin particular the spectroscopically determined mass, should be\n\ntaken with care. However, as this paper also aims to test automated fitting we did pursue the comparison of this object with\nHPN, who also treated the system assuming it to be a single\nstar.\nWe obtained a good fit for all lines except for the problematic He \uf769\uf769 \u03bb4686 line. The best fit is shown in Fig. 5. Again the\nH\u03b1 core is not fitted perfectly. To determine how significant this\nsmall discrepancy is, we fitted the H\u03b1 core in a similar manner\nas for Cyg OB2 #8C. To obtain a good fit \"by eye\" we find that\n\u1e40 has to be increased by 0.04 dex, indicating the extreme sensitivity of H\u03b1 to \u1e40 in this regime. The profiles corresponding\nto the increased mass loss rate model are shown in Fig. 5 as\ndotted lines. It is clear that not only the \"classical\" wind lines\n\n\f12\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b3\n\nH\u03b2\n\n1.00\n\n1.00\n\n0.90\n\n0.90\n\nH\u03b1\n\nHeI 4387\n\n1.00\n\n1.00\n0.95\n0.98\n\n0.90\n0.80\n\nHeI 4471\n1.00\n\n0.90\n\n0.80\n0.96\n\n0.70\n\n0.85\n\n0.80\n\n0.70\n\n0.94\n4330\n\n4340\n\n4350\n\n4850\n\nHeI 4713\n\n4860\n\n4870\n\n6540\n\nHeI 4922\n\n1.00\n\n6560\n\n6580\n\n4384\n\nHeII 4200\n\n1.00\n\n1.00\n\n0.96\n\n0.95\n\n0.92\n\n0.90\n\n0.98\n\n4388\n\n4392\n\nHeII 4541\n\n0.96\n\n4472\n\n4476\n\nHeII 4686\n\n1.00\n\n1.00\n\n0.95\n\n0.95\n\n0.90\n\n0.94\n\n4468\n\n0.90\n\n0.85\n4708\n\n4712\n\n4716\n\n4918\n\n4922\n\n4926\n\n4190\n\n4200\n\n4210\n\n4530\n\n4540\n\n4550\n\n4675\n\n4685\n\n4695\n\nFig. 6. Same as Fig. 2, however for Cyg OB2 #4.\nH\u03b3\n\nH\u03b2\n\n1.00\n\n1.00\n\n0.90\n\n0.90\n\n0.80\n\n0.80\n\n0.70\n\n0.70\n\nH\u03b1\n\nHeI 4387\n\n1.04\n\n1.00\n\n1.00\n\n4350\n\n4850\n\nHeI 4713\n\n4860\n\n4870\n\n0.80\n\n0.90\n\n0.92\n4340\n\n0.90\n\n0.95\n\n0.96\n\n4330\n\nHeI 4471\n1.00\n\n0.70\n\n0.85\n6540\n\nHeI 4922\n\n6560\n\n6580\n\n4384\n\nHeII 4200\n\n4388\n\n4392\n\n4468\n\nHeII 4541\n\n4472\n\n4476\n\nHeII 4686\n\n1.00\n\n1.00\n\n1.00\n0.95\n\n0.90\n\n0.97\n\n0.90\n\n1.00\n\n1.00\n\n0.96\n\n0.95\n\n0.94\n4710\n\n4713\n\n4716\n\n0.90\n\n0.92\n\n0.80\n4919\n\n4922\n\n4925\n\n4195\n\n4200\n\n4205\n\n4538\n\n4542\n\n4546\n\n4680\n\n4688\n\n4696\n\nFig. 7. Same as Fig. 2, however for Cyg OB2 #10. The emission feature in the core of H\u03b1 was not included in the fit. A subsequent\ntest which did include this feature in the fit yielded the same parameters except for a small increase of \u1e40 with 0.04 dex.\nreact strongly to \u1e40. All synthetic hydrogen Balmer line profiles\nshow significant filling in due to wind emission for an increased\nmass loss, deteriorating the fit quality. Also the He \uf769 \u03bb4471 line\nshows a decrease in core strength which is comparable to the\ndecrease in the H\u03b1 core. This reconfirms that in order to selfconsistently determine the mass loss rate all lines need to be\nfitted simultaneously. Therefore, a small discrepancy in the H\u03b1\ncore between the observed and synthetic line profile should not\nbe considered a decisive reason to reject a fit.\nExcept for YHe the obtained parameters agree with the results of HPN within the errors given by these authors. Similar\nto Cyg OB2 #8C we find a small helium enhancement.\n\nwe assigned a relatively low weight to this line, for reasons\nexplained in Sect. 3.2.\nThe parameters obtained from the fit agree well with the\nvalues of HPN, with exception of \u03b2, for which we find a value\nhigher by \u223c0.2. Note that HPN used a fixed value for \u03b2 to obtain their fit, whereas in this case the automated method selfconsistently derived this parameter.\nThe spectroscopic mass implied by the obtained log g\nvalue is significantly smaller than the evolutionary mass of\nCyg OB2 #4. However, within the error bars (Sect. 4) the two\nmasses agree with each other.\nCyg OB2 #10 In the final fit for this object, shown in Fig. 7,\n\nCyg OB2 #4 The final fit to the spectrum of Cyg OB2 #4 is\n\npresented in Fig. 6. We obtained good fits for all lines, with\nexception of the helium singlet at 4922 \u00c5, for which the core is\npredicted too strong. However, recall that for this spectral type\n\nthere are two problematic lines. First, for the He \uf769\uf769 \u03bb4686 line\nthe core is predicted too strong. Even though compared to HPN\nthe situation has improved considerably, the current version\nof \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 still has difficulties predicting this line. Second,\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b3\n\nH\u03b2\n\nH\u03b1\n\n1.00\n\n1.00\n\nHeI 4387\n\nHeI 4471\n1.00\n\n1.00\n\n1.00\n\n0.90\n\n0.80\n\n0.80\n\n13\n\n0.80\n\n0.80\n0.80\n\n0.60\n0.60\n\n0.60\n0.70\n4330\n\n4340\n\n4350\n\n4850\n\nHeI 4713\n\n4860\n\n4870\n\n6540\n\nHeI 4922\n\n1.00\n\n6560\n\n6580\n\n0.60\n4384\n\nHeII 4200\n\n1.00\n\n1.02\n\n0.90\n\n1.00\n\n4388\n\n4392\n\n4468\n\nHeII 4541\n\n4472\n\n4476\n\nHeII 4686\n1.00\n\n1.00\n0.95\n\n0.99\n\n0.90\n0.80\n\n0.98\n\n0.98\n0.90\n\n0.70\n\n0.80\n4710\n\n4713\n\n4716\n\n0.96\n4919\n\n4922\n\n4925\n\n0.97\n4190\n\n4200\n\n4210\n\n4530\n\n4540\n\n4550\n\n4680\n\n4685\n\n4690\n\nFig. 8. Same as Fig. 2, however for Cyg OB2 #2. Shown with dotted lines for H\u03b1 is the line profile of the best fit model with a \u1e40\nlower by a factor of 3. See text for further comments.\nthe predicted He \uf769 \u03bb4471 is too weak. Possibly this is connected to the generalized dilution effect, for which we refer to\nRepolust et al. (2004) for a recent discussion.\nIn Fig. 7 we also see that the H\u03b1 core of Cyg OB2 #10\nexhibits an emission feature. For this analysis we assumed that\nis was nebular and, consequently, excluded it from the fit. To\ntest what the effect would be if this assumption was incorrect, a\nfit was made with this feature included in the profile. It turned\nout that the only parameter which was affected in this test was\n\u1e40, which showed a small increase of 0.04 dex.\nCyg OB2 #2 For Cyg OB2 #2 the automated method could\n\nnot self-consistently determine \u03b2. Therefore, we fixed its value\nat a theoretically predicted \u03b2 = 0.8 (cf. Pauldrach et al. 1986).\nIn Fig. 8 the best fit is shown. We obtained good fits for all\nlines. However, in the case of He \uf769 \u03bb4471 we do see a small\nunder prediction of the forbidden component at 4469 \u00c5, which\nis likely related to incorrect line-broadening functions.\nFor log g and \u1e40 the obtained fit parameters differ considerably from the findings of HPN. We first focus on mass loss for\nwhich we obtain the relatively low rate of 1.63 \u00d7 10\u22127 M\u2299 yr\u22121\nwith an error bar in the logarithm of this value of \u22120.15 and\n+0.12 dex (see Tab. 5), given the quoted value of \u03b2. Our \u1e40\nvalue is approximately a factor two higher than the mass loss\nrate obtained by HPN. These authors noted that it was not possible to well constrain the mass loss rate of such a weak wind.\nGiven the relatively modest errors indicated by our automated\nfitting method, we conclude that at least in principle our technique allows to determine mass loss rates of winds as weak as\nthat of Cyg OB2 #2. We have added the phrase \"in principle\"\nas it assumes the notion of beta and a very reliable continuum\nnormalization, which is in this is case different from the one\nused by HPN for the He \uf769\uf769 4541, He \uf769\uf769 4686 and H\u03b1 lines. If this\ncan not be assured, then systematic errors may dominate over\nthe characteristic fitting error and the mass loss may be much\nless well constrained. Assuming the continuum location to be\n\nreliable, we illustrate the sensitivity of the spectrum to mass\nloss rates of \u223c10\u22127 M\u2299 yr\u22121 by reducing the mass loss by a factor of three. The H\u03b1 profile of this reduced mass loss model is\nshown in Fig. 8 as a dotted line. Comparison of these two cases\nshows that for winds of order 10\u22127 M\u2299 yr\u22121 the line still contain\nconsiderable \u1e40 information. Interestingly, if we would not take\ninto consideration the line core of H\u03b1 in our fitting method, we\nstill recover the quoted mass loss to within three percent. We\nnote that for our higher mass loss this object appears to behave\nwell in the wind momentum luminosity relation (see Sect. 5.4),\nwhereas HPN signal a discrepancy when using their estimated\n\u1e40 value.\nThe log g value obtained in this study is 0.36 dex larger than\nthe value obtained \"by eye\" by HPN. Judging from the very\ngood fits obtained, there is no indication that the automated fit\noverestimated the gravity. The spectroscopic mass of 17.0 M\u2299\nimplied by the larger log g value, is also in good agreement\nwith the evolutionary mass of Cyg OB2 #2, which is 18.7 M\u2299 .\n\n3.3.2. Analysis of well studied dwarf OB-stars\nWe have also reanalysed five well known and well studied\ndwarf OB-stars, sampling the range of O spectral sub-types,\nin order to probe a part of parameter space that is not well covered by the Cyg OB2 stars. HD 217086 and \u03b6 Oph, for instance,\nare fast rotators with vr sin i = 350 and 400 km s\u22121 respectively\n(see also Tab. 2). 10 Lac is a slow rotator, and \u03c4 Sco is a very\nslow rotator. The latter two stars also feature very low mass loss\nrates, moreover, the actual \u1e40 values of these stars are much debated (see Martins et al. 2004). HD 15629 is selected because\nit appears relatively normal.\nHD 15629 Apart from a slight over-prediction of the core\n\nstrength in He \uf769\uf769 \u03bb4200, a very good fit was obtained for this\nobject. The final fit is presented in Fig. 9. This object has recently been studied by Repolust et al. (2004, hereafter RPH).\n\n\f14\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b4\n\nH\u03b3\n\nH\u03b2\n\n1.00\n\n1.00\n\n1.00\n\n0.80\n\n0.80\n\n0.80\n\n0.60\n\n0.60\n4090\n\n4100\n\n4110\n\nHeI 4387\n\n1.00\n\n1.01\n\n0.90\n\n1.00\n\n0.80\n\n0.99\n\n0.60\n4330\n\nHeI 4471\n\n4340\n\n4350\n\n4850\n\nHeI 4922\n\n1.00\n\nH\u03b1\n\n4860\n\n4870\n\n6540\n\nHeII 4200\n\n1.01\n\n1.00\n\n1.00\n\n0.95\n\n0.99\n\n0.90\n\n6560\n\n6580\n\nHeII 4541\n\n4392\n\n1.00\n\n0.90\n\n0.98\n\n4388\nHeII 4686\n\n1.00\n\n0.96\n\n0.92\n\n4384\n\n0.90\n\n0.80\n\n0.85\n\n0.80\n4467\n\n4471\n\n4475\n\n4917\n\n4921\n\n4925\n\n4190\n\n4200\n\n4210\n\n4530\n\n4540\n\n4550\n\n4675\n\n4685\n\n4695\n\nFig. 9. Same as Fig. 2, however for HD 15629.\nH\u03b4\n\nH\u03b3\n\nH\u03b2\n\n1.00\n\n1.00\n\n1.00\n\n0.90\n\n0.90\n\n0.90\n\nH\u03b1\n\nHeI 4387\n\n1.00\n1.00\n0.90\n\n0.80\n\n0.80\n\n0.80\n\n0.98\n0.80\n\n4080\n\n4100\n\n4120\n\n4320\n\nHeI 4471\n\n4340\n\n4360\n\n4840\n\nHeI 4922\n\n1.00\n\n4860\n\n4880\n\nHeII 4200\n\n1.00\n\n1.00\n\n0.98\n\n0.96\n\n0.96\n\n0.92\n\n0.94\n\n4471\n\n4479\n\n4914\n\n4922\n\n4930\n\n4190\n\n4200\n\n6560\n\n6580\n\n4380\n\nHeII 4541\n\n0.97\n\n4463\n\n6540\n\n4210\n\n1.00\n\n0.96\n\n0.95\n\n0.92\n\n0.90\n4540\n\n4400\n\nHeII 4686\n\n1.00\n\n4530\n\n4390\n\n4550\n\n4675\n\n4685\n\n4695\n\nFig. 10. Same as Fig. 2, however for HD 217086.\nCompared to the parameters obtained by these authors, we find\ngood agreement except for T eff , \u1e40 and \u03b2. Note that in contrast\nto this study we do not find a helium deficiency. However, the\ndifference of 0.02 with respect to the solar value obtained here\nis within the error quoted by RPH.\nThe difference in wind parameters can be explained by the\nvalue of \u03b2 = 0.8 assumed by RPH. Our self-consistently derived value for \u03b2 = 1.18. As the effect of \u03b2 on the spectrum is\nconnected to the mass loss rate through the velocity law and the\ncontinuity equation, the lower \u1e40 obtained with the automated\nmethod is explained.\nThe 1.5 kK increase of T eff compared to RPH can be attributed to the improved fit quality and the increase in log g of\n0.1 dex. An increase in log g implies an increase in electron\ndensity, resulting in an increase in the recombination rate. The\nstrength of both the He \uf769 and He \uf769\uf769 lines depend on this rate, as\nthe involved levels are mainly populated through recombination. Consequently, as He \uf769\uf769\uf769 is the dominant ionization stage in\n\nthe atmosphere of HD 15629 the strength of the He \uf769 and He \uf769\uf769\nlines will increase when the recombination rate increases. To\ncompensate for this increase in line strength an increase in T eff ,\ndecreasing the ionization fractions of He \uf769 and He \uf769\uf769, is necessary.\nHD 217086 With a projected rotational velocity of 350 km s\u22121\n\nthis object can be considered to be a fast rotator, and our analysis of this object will show how well the automated method can\nhandle large vr sin i. In Fig. 10 the best fit obtained with our\nmethod is presented. We find that the large projected rotational\nvelocity does not pose any problem for the method, i.e. the fit\nquality of all the lines fitted is very good.\nWith respect to the obtained parameters, again, these can\nbe compared to the work of RPH. In this comparison we find\nconsiderable differences for T eff and log g and a small difference for YHe . The effective temperature found by the automated\nmethod is 2.1 kK higher. This is a significant increase, but\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b3\n\nH\u03b2\n\nH\u03b1\n\nHeI 4387\n\n1.00\n\n1.00\n\n1.00\n\n1.00\n\n0.80\n\n0.80\n\n0.80\n\n0.90\n\n0.60\n\n0.60\n\n0.60\n\n4320\n\n4340\n\n4360\n\n4840\n\nHeI 4713\n\n4860\n\n4880\n\nHeI 4471\n1.00\n\n0.80\n\n0.80\n0.60\n6540\n\nHeI 4922\n\n6560\n\n6580\n\n4384\n\nHeII 4200\n\n4388\n\n4392\n\n4466\n\nHeII 4541\n\n4471\n\n4476\n\nHeII 4686\n1.00\n\n1.00\n\n1.00\n\n15\n\n1.00\n\n1.00\n0.90\n\n0.95\n\n0.95\n\n0.90\n\n0.80\n0.80\n\n0.90\n\n0.90\n0.80\n\n0.85\n\n0.70\n\n0.60\n\n0.85\n4711\n\n4713\n\n4715\n\n4919\n\n4922\n\n4925\n\n4190\n\n4200\n\n4210\n\n4530\n\n4540\n\n4550\n\n4680\n\n4685\n\n4690\n\nFig. 11. Same as Fig. 2, however for 10 Lac.\nH\u03b3\n\nH\u03b2\n\n1.00\n\nH\u03b1\n\n1.00\n\nHeI 4387\n\nHeI 4471\n\n1.00\n\n1.00\n1.00\n\n0.90\n\n0.90\n\n0.95\n\n0.90\n0.80\n\n0.97\n\n0.80\n\n0.90\n0.94\n\n0.80\n4325\n\n4340\n\n4355\n\n4845\n\nHeI 4713\n\n4860\n\n4875\n\n6540\n\nHeI 4922\n\n6580\n\n4380\n\nHeII 4200\n\n4390\n\n4400\n\n4460\n\nHeII 4541\n\n4470\n\n4480\n\nHeII 4686\n1.00\n\n1.00\n\n1.00\n\n6560\n\n1.00\n\n1.00\n0.98\n\n0.98\n\n0.96\n\n0.96\n\n0.92\n4704\n\n4712\n\n4720\n\n0.98\n\n0.98\n\n0.96\n0.94\n\n0.96\n0.96\n4910\n\n4920\n\n4930\n\n4185\n\n4200\n\n4215\n\n4530\n\n4540\n\n4550\n\n4675\n\n4685\n\n4695\n\nFig. 12. Same as Fig. 2, however for \u03b6 Oph.\nwhen the log g value obtained here is considered, this can be\nexplained in a similar manner as the T eff increase of HD 15629.\nThe best fit is obtained with a log g value that is 0.29 dex\nhigher than the value from RPH. Judging from the line profiles\nin Fig. 10 there is no evidence for an overestimation of log g.\nThis higher log g removes the discrepancy with the calibration\nof Markova et al. (2004) found by RPH (see Fig. 17 in RPH).\nWe also note that, similar to Cyg OB2 #2, the increased log g\nimplies a spectroscopic mass which agrees well with the evolutionary mass of HD 217086 (cf. Tab. 4). This is not the case\nfor the value determined by RPH, which points to a clear discrepancy.\nThe considerable helium abundance enhancement found by\nRPH is not reproduced by the automated method. Even though\nthis object is a rapid rotator, our fit indicates a normal, i.e. solar,\nhelium abundance.\n\n10 Lac Like in the case of Cyg OB2 #2, and for the remaining\n\nobjects, the wind is too weak to self-consistently determine \u03b2.\nTherefore, again a value of \u03b2 = 0.8 was assumed.\nThe photospheric parameters obtained for 10 Lac agree\nvery well with the results of HPN. The best fit to the observed spectrum is shown in Fig. 11. Whereas HPN find that the\nmass loss rate cannot be constrained and only an upper limit of\n10\u22128 M\u2299 yr\u22121 is found, the automated method was able to selfconsistently determine \u1e40 at 6\u00d710\u22128 M\u2299 yr\u22121 , though with large\nerror bars (see Tab. 5). Our error bar indicates that \u1e40 may be\nan order of magnitude lower, i.e. it may still be consistent with\nthe HPN result.\nVarious other authors have determined the mass loss rate\nof 10 Lac using different methods. These determinations range\nfrom up to 2 \u00d7 10\u22127 (Howarth & Prinja 1989) down to 2 \u00d7\n10\u22129 M\u2299 yr\u22121 (Martins et al. 2004). Consequently, compared\nto these independent determinations no conclusive answer can\nbe given to the question whether the \u1e40 derived from the opti-\n\n\f16\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\nH\u03b3\n\nH\u03b2\n\n1.00\n\n1.00\n\n0.80\n\n0.80\n\nH\u03b1\n\nHeI 4387\n\nHeI 4471\n1.00\n\n1.00\n\n1.00\n\n0.90\n0.80\n0.80\n0.80\n0.60\n\n0.60\n\n0.60\n\n0.70\n0.60\n4325\n\n4340\n\n4355\n\n4845\n\nHeI 4713\n\n4860\n\n4875\n\n6540\n\nHeI 4922\n\n6560\n\n6580\n\n4384\n\nHeII 4200\n\n4388\n\n4392\n\nHeII 4541\n\n4472\n\n4476\n\nHeII 4686\n\n1.00\n\n1.00\n\n4468\n\n1.00\n1.00\n\n1.00\n\n0.95\n\n0.97\n\n0.90\n0.90\n\n0.80\n0.80\n\n0.80\n\n0.60\n\n0.70\n\n0.94\n\n0.90\n4711\n\n4713\n\n4715\n\n4918\n\n4922\n\n4926\n\n4195\n\n4200\n\n4205\n\n4530\n\n4540\n\n4550\n\n4680\n\n4685\n\n4690\n\nFig. 13. Same as Fig. 2, however for \u03c4 Sco.\ncal spectrum is correct. We conclude that the mass loss rate of\n10 Lac is anomalously low when placed into context with the\nother dwarfs stars studied here. For instance, the dwarfs \u03b6 Oph\nand HD 217086, which have luminosities that are, respectively,\nlower and higher by \u223c0.1 dex, both exhibit a mass loss rate\nhigher by several factors. In Sect. 5.4 we will discuss this further in terms of the wind-momentum luminosity relation.\n\n\u03b6 Oph The large vr sin i of 400 km s\u22121 was not a problem to\nobtain a good fit. In Fig. 12 the best fit for \u03b6 Oph is presented. With the exception of the helium abundance, the comparison with the results of RPH yields very good agreement.\nNote that the mass loss rate obtained by these authors is an\nupper limit, whereas in this study \u1e40 could be derived selfconsistently. With respect to YHe we do not find any evidence\nfor a significant overabundance of helium, in agreement with\nVillamariz & Herrero (2005).\n\n\u03c4 Sco The best fit for \u03c4 Sco is presented in Fig. 13. All lines,\nincluding H\u03b4, which is not shown here, are reproduced accurately. The photospheric parameters we obtained can be compared to the work of Sch\u00f6nberner et al. (1988) and Kilian et al.\n(1991) who both studied \u03c4 Sco using plane parallel models. Kilian et al. found T eff =31.7 kK and log g=4.25, whereas\nSch\u00f6nberner et al. obtained T eff =33.0 kK and log g=4.15. The\ndifference in T eff between the two studies is explained by the\nfact that in the latter analysis no line blanketing was included\nin the models. Therefore, we prefer to compare our T eff to the\nformer investigation, which agree very well. In terms of the\ngravity we find good agreement with the second study. The\nvalue obtained by Kilian et al. seems rather high. Given the almost perfect agreement between the synthetic line profiles and\nthe observations in Fig. 13, the reason for this discrepancy is\nunclear. On a side note, more recently Repolust et al. (2005)\nanalysed the infrared spectrum of this object. Their findings do\nconfirm our lower value, but could not reproduce the enhanced\n\nhelium abundance we find, due to a lack of observed infrared\nHe \uf769\uf769 lines.\nIn the recent literature the mass loss rate usually adopted\nfor \u03c4 Sco is 9 \u00d7 10\u22129 M\u2299 yr\u22121 , which is considerably smaller\nthan the 6.14 \u00d7 10\u22128 M\u2299 yr\u22121 obtained in this study. However,\nthe former mass loss rate is an average value determined by\nde Jager et al. (1988), based on the mass loss rates independently found by Gathier et al. (1981) and Hamann (1981).\nBased on the UV resonance lines, these two studies, respectively, determined \u1e40 to be 7.4 \u00d7 10\u22128 and 1.3 \u00d7 10\u22129 M\u2299 yr\u22121 .\nSo, they differ by more than a factor of 50. The mass loss rate\nobtained with the automated method is in reasonable agreement\nwith that obtained by Gathier et al.. Our higher value is also\nsupported by the study of the infrared spectrum of \u03c4 Sco by\nRepolust et al. (2005) who find \u1e40 \u2243 2\u00d710\u22128 M\u2299 yr\u22121 . Detailed\nfitting of Br\u03b1 will likely clarify this issue.\n\n4. Error analysis\nHere we will introduce our method of estimating errors on the\nparameters derived with the automated method. This method\nis based on properties of the distribution of the fitnesses of the\nmodels in parameter space, which may seem conceptually different from classical approaches of defining error bars (and in\na sense it is). However, we will demonstrate for the case of\n10 Lac that our error definition is very comparable to what is\nroutinely done in fit diagram approaches.\n\n4.1. Fit diagrams\nIn a fit diagram method the error bar on T eff and log g is derived by investigating the simultaneous behaviour of these two\nparameters. In panel a of Fig. 14 the fit diagram of 10 Lac is\npresented adopting for all other parameters (save T eff and log g)\nthe best fit values obtained in our automated fitting. This diagram was constructed by calculating a grid of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models\nin the T eff -log g plane, and evaluating for every line for every\nT eff which model, i.e. log g, fits this line the best. The loca-\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n5.5\n\n400\n\nHeII 4200\n\n4.5\n\nHeII 4541\n\nFitness\n\nlogg [cm s\u22122]\n\n5.0\n\n500\n\nH\u03b1\nH\u03b2\nH\u03b3\n\nHeI 4387\nHeI 4471\nHeI 4713\nHeI 4922\n\n17\n\nHeII 4686\n\n4.0\n3.5\n\n300\n200\n100\n\na\n\nb\n\n3.0\n\n0\n30\n\n32\n\n34\n\n36\nTeff [kK]\n\n38\n\n40\n\n42\n\n30\n\n250\n\n32\n\n34\n\n36\nTeff [kK]\n\n38\n\n40\n\n42\n\n1200\n\nc\n\nd\n1000\n\n200\n#models\n\n#models\n\n800\n150\n100\n\n600\n400\n\n50\n\n200\n\n0\n\n0\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nFitness\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\nTeff [kK]\n\nFig. 14. Panel a: fit diagram of T eff and log g for 10 Lac. Panel b: Fitness as a function of T eff for log g = 4.0. Panel c: Fitness\ndistribution of the models calculated during the fitting run of the automated method. Panel d: Distribution of T eff in the models\nlocated within the global optimum. The maximum variation of T eff within the global optimum, which corresponds to the error\nestimate of this parameter, is \u223c900 K.\ntion where the resulting fit curves intersect, corresponds to the\nbest fit. This best fit yields T eff = 36 000 K and log g = 4.0.\nNote that this result was obtained without the use of our automated method. The error can now be estimated by estimating\nthe dispersion of the fit curves around this location. In panel a\nof Fig. 14 this is indicated by a box around the best fit location. The corresponding error estimates are 1000 K in T eff and\n0.1 dex in log g.\n\nThe method described above cannot be applied to our automated fitting method due to two reasons. First, as we have\ndefined the fit quality according to Eq. (1), this definition of\nfitness compresses the fit curves of all individual lines in the\nfit diagram to a single curve. In Fig. 14 this curve is shown as\na thick dashed line. Although the curve runs through the best\nfit point, no information about the dispersion of the solutions\naround this point can be derived from it. The second reason\nlies in the multidimensional character of the problem of line\nfitting. If one would want to properly estimate the error taking this multidimensionality in to account, a fit diagram should\nbe constructed with a dimension equal to the number of free\nparameters evaluated. In case of our fits this translates to the\nconstruction of a six dimensional fit diagram.\n\n4.2. Optimum width based error estimates\nEven though we have argued that fit diagrams cannot be used\nwith our fitting method, it is possible to construct an error estimate which is analogous to the use of these diagrams and does\ntake the multidimensionality of the problem into account. This\ncan be done by first realizing that the error box shown in Fig. 14\nessentially is a measure of the width of the optimum in parameter space, i.e. it defines the region in which models are located\nwhich approximately have the same fit quality. This is illustrated in panel b. There we show the one-dimensional fitness\nfunction in the T eff -log g plane for log g = 4.0. Indicated with\ndashed lines is the error in T eff estimated using the fit diagram\nof 10 Lac. Confined between these lines is the region which\ncorresponds to the optimum as defined by the error box in panel\na. Consequently, the difference between maximum and minimum fitness in this region defines the width of the optimum.\nReturning to the general case, we can now invert the reasoning and state that the error estimate for a given parameter is\nequal to the maximum variation of this parameter in the group\nof best fitting models, i.e. the models located within the error\nbox. Consequently, in the automated fitting method by defining\na group of best fitting models, the error estimates for all free\nparameters can be determined.\nWe define the group of best fitting models as the group\nof models that lie within the global optimum. Put differently,\n\n\f18\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nTable 5. Error estimates for fit parameters obtained using the automated fitting method and parameters derived from these.\nDenoted by \uf76e\uf764 are errors in vturb that reach up to the maximum allowed value of vturb and, therefore, are formally not defined.\nUncertainties in the fit parameters result from the optimum width based error estimates method. See text for details and discussion.\n\nStar\nCyg OB2 #7\nCyg OB2 #11\nCyg OB2 #8C\nCyg OB2 #8A\nCyg OB2 #4\nCyg OB2 #10\nCyg OB2 #2\nHD 15629\nHD 217086\n10 Lac\n\u03b6 Oph\n\u03c4 Sco\n\n\u2206T eff\n[kK]\n\n\u2206log gc\n[cm s\u22122 ]\n\n\u22121.0\n+1.5\n\u22120.6\n+0.4\n\u22121.3\n+1.1\n\u22120.4\n+1.7\n\u22120.3\n+1.5\n\u22120.8\n+1.0\n\u22120.8\n+1.2\n\u22120.3\n+0.7\n\u22120.5\n+0.9\n\u22120.9\n+0.8\n\u22120.7\n+0.7\n\u22120.8\n+0.5\n\n\u22120.08\n+0.06\n\u22120.07\n+0.13\n\u22120.10\n+0.14\n\u22120.05\n+0.13\n\u22120.04\n+0.21\n\u22120.12\n+0.16\n\u22120.14\n+0.13\n\u22120.05\n+0.07\n\u22120.08\n+0.07\n\u22120.12\n+0.13\n\u22120.05\n+0.16\n\u22120.14\n+0.09\n\n\u2206R\u22c6\n[R\u2299 ]\n\u00b10.7\n\n\u2206 log L\u22c6\n[L\u2299 ]\n\n\u2206YHe\n\n\u2206vturb\n[km s\u22121 ]\n\n\u2206 log \u1e40\n[M\u2299 yr\u22121 ]\n\n\u2206\u03b2\n\n\u2206Ms\n[M\u2299 ]\n\n\u2206Mev\n[M\u2299 ]\n\n\u00b10.07\n\n\u00b11.1\n\n\u00b10.05\n\n\u00b10.7\n\n\u00b10.07\n\n\u22120.02\n+0.03\n\u22120.01\n+0.03\n\u22120.02\n+0.04\n\u22120.04\n+0.04\n\u22120.02\n+0.03\n\u22120.02\n+0.03\n\u22120.01\n+0.03\n\u22120.01\n+0.03\n\u22120.02\n+0.02\n\u22120.02\n+0.02\n\u22120.02\n+0.04\n\u22120.02\n+0.04\n\n\u221214.9\n+ND\n\u22124.0\n+ND\n\u22120.2\n+10.9\n\u221217.7\n+ND\n\u22123.0\n+ND\n\u22127.0\n+ND\n\u22122.3\n+2.4\n\u22128.4\n+7.6\n\u22124.9\n+2.9\n\u22123.8\n+4.1\n\u22126.2\n+ND\n\u22122.2\n+2.4\n\n\u22120.05\n+0.03\n\u22120.03\n+0.06\n\u22120.07\n+0.04\n\u22120.07\n+0.03\n\u22120.10\n+0.05\n\u22120.13\n+0.08\n\u22120.15\n+0.12\n\u22120.13\n+0.10\n\u22120.12\n+0.18\n\u22120.98\n+0.39\n\u22120.28\n+0.15\n\u22120.99\n+0.22\n\n\u22120.04\n+0.09\n\u22120.05\n+0.02\n\u22120.05\n+0.10\n\u22120.04\n+0.11\n\u22120.05\n+0.21\n\u22120.15\n+0.19\n\n\u221215\n+12\n\u221215\n+27\n\u221210\n+14\n\u221215\n+32\n\u22123\n+15\n\u221219\n+26\n\u22127\n+6\n\u221213\n+14\n\u221210\n+10\n\u221216\n+16\n\u22127\n+11\n\u22126\n+4\n\n\u22127\n+7\n\u22123\n+4\n\u22124\n+4\n\u221210\n+8\n\u22123\n+3\n\u22124\n+4\n\u22121\n+2\n\u22125\n+7\n\u22123\n+3\n\u22122\n+4\n\u22122\n+2\n\u22121\n+1\n\n\u00b11.3\n\n\u00b10.09\n\n\u00b10.7\n\n\u00b10.09\n\n\u00b11.5\n\n\u00b10.07\n\n\u00b10.6\n\n\u00b10.08\n\n\u00b11.9\n\n\u00b10.12\n\n\u00b11.2\n\n\u00b10.13\n\n\u00b11.7\n\n\u00b10.17\n\n\u00b11.3\n\n\u00b10.13\n\n\u00b10.5\n\n\u00b10.09\n\nthe width of the global optimum in terms of fitness, defines\nthe group of best fitting models. Identifying and, consequently,\nmeasuring this width is facilitated by the nature of the GA, i.e.\nselected reproduction, incorporated in our fitting method. Due\nto this selected reproduction the exploration through parameter space results in a mapping of this space in which regions\nof high fit quality, i.e. the regions around local optima and the\nglobal optimum, are sampled more intensively. Consequently,\nif we would rank all models of all generations calculated during a fitting run according to their fitness, the resulting distribution will peak around the locations of the optima. In case of\nthe global optimum the width of this peak, starting from up to\nthe maximum fitness found, is, analogous to the width of the\nerror box used in a fit diagram, a direct measure of the width of\nthe optimum. Consequently, this width depends on the quality\nof the data, i.e. it will be broader or narrower for, respectively,\nlow and high signal to noise, and on the degeneracy between\nthe fit parameters. Therefore, the error estimates of the individual parameters are equal to the maximum variations of these\nparameters for all models contained in the peak corresponding\nto the global optimum.\n\nIn panel c of Fig. 14 the distribution of the models according to their fitness calculated during the fitting run of 10 Lac\nusing the automated method is shown. The fitnesses are normalized with respect to the highest fitness and only the top half\nof the distribution is shown. In this distribution two peaks are\nclearly distinguishable. The most pronounced peak is located\nat F \u2248 0.9 and corresponds to the region around the global optimum. A second peak, corresponding to a region around a secondary optimum, is located at F \u2248 0.83. To derive the error on\nthe fit parameters we estimate the total width of the global op-\n\n\u22120.10\n+0.27\n\u22120.25\n+0.16\n\n-\n\ntimum for 10 Lac to be \u223c0.152, i.e. the range of F = 0.85...1.0\ncorresponds to the width of the optimum. In panel d of Fig. 14\nwe show the resulting distribution of T eff of the models within\nthis global optimum. In this figure we see that the maximum\nvariation, hence the error estimate, is \u223c900 K, which is in\ngood agreement with the value derived using the fit diagram\nof 10 Lac. For log g we also find an error estimate of \u223c0.1 dex,\nwhich is also very similar to the value obtained with this diagram. The exact values as well as error estimates for all fit\nparameters of all objects are given in Tab. 5. It is important\nto note that our error analysis method also allows for an error\nestimate of parameters to which the spectrum does not react\nstrongly. For 10 Lac this is clearly the case for the mass loss\nrate, for which we find large error bars.\n\n4.3. Derived parameters\nIn Tab. 5 the errors on the derived parameters were calculated\nbased on the error estimates of the fit parameters. Here we will\nelaborate on their derivation.\nThe error in the stellar radii is dominated by the uncertainty in the absolute visual magnitude. In case of the\nCyg OB2 objects we adopt these to be 0.1m conform the work\nof Massey & Thompson (1991). For HD 15629, HD 217086\nand \u03b6 Oph we use the uncertainty as given by RPH of 0.3m .\nThe distance to 10 Lac and \u03c4 Sco was measured by Hipparcos.\nTherefore, for these two objects we adopt the error based\non this measurement, which, respectively, is 0.4 and 0.2m .\nTogether with the uncertainty in T eff the uncertainty in R\u22c6 is\n2\nIn general this is not a fixed number. Considering all programme\nstars we find the width of the global optimum to be within the range\n\u223c0.1 to \u223c0.2.\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\n19\n\n1.10\n0.4\n\n0.2\n\u2206log g\n\nTeff ratio\n\n1.05\n\n1.00\n\n0.0\n\n-0.2\n\n0.95\n\n-0.4\n0.90\n30.0\n\n35.0\n\n40.0\n\n45.0\n\n3.2\n\n3.4\n\n3.6\n\nTeff (kK)\n\nFig. 15. Comparison of the effective temperatures obtained using automated fits (horizontal axis) and \"by eye\" fits. On the\nvertical axis the ratio of automated relative to \"by eye\" temperature determination is given. The dashed lines correspond\nto a four percent error usually adopted for \"by eye\" determined\nvalues.\n\n3.8\n\n4.0\n\n4.2\n\nlog g\n\nFig. 16. Gravities obtained with automated fits (horizontal axis)\nare compared to gravities determined from \"by eye\" fits. The\nvertical axis gives the difference of the logarithm of the two\ngravity determinations. Indicated by dashed lines are the 0.1\ndex errors usually adopted for gravities determined \"by eye\".\n\n5.1. Effective temperature\ncalculated according to Eq. (8) of RPH, where we used the\nlargest absolute uncertainty in T eff for a given object.\nTo correct the surface gravity for centrifugal forces, a correction conform Herrero et al. (1992) was applied to the gravity\ndetermined from the spectral fits. This corrected value is given\nin Tab. 4. As shown by RPH this correction has a non negligible effect on the error in the resulting log gc . Consequently, we\nused their estimate to calculate the total error estimate of log gc\nas given in Tab. 5. Using this error together with the uncertainty\nin R\u22c6 the resulting uncertainty in the spectroscopic mass was\ncalculated.\nFor the calculation of the uncertainty in the stellar luminosity, we consistently adopted the largest absolute error in T eff .\nThe resulting \u2206 log L\u22c6 as well as the uncertainty in T eff have\nan effect on the evolutionary mass. We have estimated errors\nfor this quantity using the error box spanned by \u2206 log L\u22c6 and\n\u2206 log T eff .\n\n5. Comparison with previous results\nIn this section we will compare the results obtained with our automated fitting method with those from \"by eye\" fits (relevant\nreferences to the comparison studies are given in the previous\nsection). This does not constitute a one-to-one comparison of\nthe automated and \"by eye\" approach as this would require the\nuse of identical model atmosphere codes as well as the same set\nof spectra, moreover, with identical continuum normalization.\nPotential differences can therefore not exclusively be attributed\nto the less bias sensitive automated fitting method. However, as\nwe have applied our method to a sizeable sample of early type\nstars, the automated nature of it does assure that it is the most\nhomogeneous study to date, i.e. without at least some of the\nbiases involved in conventional analyses.\n\nIn Fig. 15 a comparison of the effective temperatures determined in this study with T eff values obtained with \"by eye\" fits,\nis presented. Indicated with dashed lines are the four percent\nerrors usually adopted for \"by eye\" fitted spectra. With the exception of the outlier HD 217086 at 38.1 kK, the agreement is\nvery good and no systematic trend is visible. From this plot we\ncan conclude that the T eff obtained with the automated fit is at\nleast as reliable as the temperatures determined in the conventional way.\n\n5.2. Gravities\nIn many cases the gravity obtained with the automated procedure is significantly higher than the values obtained with the\nconventional \"by eye\" fitted spectra. This is shown in Fig. 16,\nwhere we show as a function of the gravities obtained in this\nstudy the differences with the \"by eye\" determined values.\nIndicated with dashed lines in this figure is the 0.1 dex error\nin log g that is often assigned to a \"by eye\" fitting of the hydrogen Balmer line wings. It is important to note that this plot\nshows that there is no obvious trend in the differences, i.e. there\nappears no systematic increase as a function of log g present.\nIt is clear, however, that there are three outliers for which\nprevious gravity determinations yield values that are at least\n0.2 dex lower. These are in order of increasing gravity (as\ndetermined in this study): Cyg OB2 #2, Cyg OB2 #7 and\nHD 217086. For all three cases, previous spectroscopic mass\ndeterminations result in values that are about a factor of two\nless than the corresponding evolutionary masses. One reason\nfor these discrepant gravity values can be traced to a difference\nbetween automated and \"by eye\" fitting. In \"by eye\" fitting, it\nis custom to prohibit the theoretical line flux in the wings of\nBalmer lines \u2013 specifically that at the position in the observed\nline wing where the profile curvature is maximal \u2013 to be be-\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nlow that of the observed flux. This constraint has been used by\nHPN for the Cyg OB2 stars; for HD 217086, we could not verify whether this was the case. The automated method does not\napply this constraint. Therefore, as it strives for a maximum fitness, it tends to fit the curve through the signal noise as much\nas possible. This yields a higher gravity.\nA second reason is connected to the multidimensional nature of the optimization problem. \"By eye\" fitting may not find\nthe optimum fit, as in general it can not simultaneously deal\nin a sufficiently adequate way with all the free parameters of\nthe problem. Consequently, some of the \"by eye\" fitted spectra do not correspond to the best fit possible. A good example\nin which this appears to be the case is HD 217086. With the\nautomated fit we not only obtained a gravity that is higher by\n\u223c0.3 dex, but also an effective temperature higher by 2.1 kK\ncompared to the results of RPH. Consequently, as the ionization structure of the atmosphere depends heavily on this temperature, so does the gravity one obtains from a spectral fit\nfor this temperature. As RPH obtained a gravity for a significantly lower effective temperature, the gravity obtained from\ntheir spectral fit likely corresponds to the value from a local\noptimum in parameter space.\n\n5.3. Helium abundance and microturbulence\nThis analysis is the first in which the helium abundance and the\nmicroturbulent velocity have been treated as continuous free\nparameters. In the studies of HPN and RPH only two possible\nvalues for the microturbulent velocity were adopted. For the helium abundance an initial solar abundance was adopted, which\nwas modified when no satisfying fit could be obtained for this\nabundance. Consequently, a comparison with these studies as\nwas done for e.g. the gravities, is not possible. Instead we will\nonly discuss whether the obtained values of these parameters\nare reasonable and comment on possible correlations with other\nparameters.\nThe helium abundances given in Tab. 4 show that no extreme values were needed by the fitting method to obtain a\ngood fit. An exception to this may be YHe =0.21 obtained for\nCyg OB2 #7. However, as discussed earlier this value is still\nsignificantly smaller than the YHe =0.3 obtained by HPN. With\nrespect to a possible relation between the helium abundance\nand other parameters, only a small correlation between T eff and\nYHe is found for the supergiants. For these objects it appears\n(cf. Tab. 4) that the helium abundance increases with increasing effective temperature. However, as we only analysed six\nsupergiants further investigation using a larger sample needs to\nbe undertaken.\nAlso for the microturbulent velocities no anomalous values\nwere needed to fit the spectra. The large error bars in the turbulent velocity quoted in Tab. 5, especially for the supergiants,\nshow that the profiles are not very sensitive to this parameter. This is consistent with the study of Villamariz & Herrero\n(2000) and RPH. The \uf76e\uf764 entries given on some of the positive\nerrors in the table indicate that they reach up to the maximum\nallowed value of vturb , which is 20 km s\u22121 . Therefore, they are\nformally not defined. The fact that some of the small scale tur-\n\n0.8\n0.6\n0.4\n\u2206 log dM/dt\n\n20\n\n0.2\n0.0\n-0.2\n-0.4\n-0.6\n-0.8\n-7.2\n\n-6.8\n\n-6.4\n\n-6.0\n\n-5.6\n\n-5.2\n\n-4.8\n\nlog dM/dt\n\nFig. 17. Difference between mass loss rate obtained by the automated method (given by the horizontal) axis and values determined by eye. A typical 0.15 dex error is indicated by the\ndashed lines. The two outliers at log \u1e40 \u2243 \u22127.2 and and log \u1e40 \u2243\n\u22126.8, respectively, correspond to 10 Lac and Cyg OB2 #2.\nbulent velocities are close to this maximum value may indicate\nthat they represent lower limits, though, again, this likely reflects that they are poorly constraint.\nNo correlation of the microturbulence with any of the other\nparameters is found. In particular not between vturb and log g\nand vturb and YHe . Various authors have hinted at such a correlation (e.g. Kilian 1992).\n\n5.4. Wind parameters\nThe straightforward comparison of the mass loss rates obtained\nwith the automated method with values determined from spectral fits \"by eye\" is shown in Fig. 17. With exception of \u03c4 Sco\nat log \u1e40 = \u22127.2, for which the mass loss rate determined by\nGathier et al. (1981) from UV line fitting serves as a comparison, all mass loss rates are compared to values determined\nfrom H\u03b1 fitting. For this comparison we assume an error of\n0.15 dex in the \"by eye\" determined values. This uncertainty\ncorresponds to a typical error obtained from H\u03b1 fitting and is\nshown in Fig. 17 as a set of dashed lines. With exception of\n10 Lac and \u03c4 Sco, for which the mass loss rate determination\nis uncertain, this error is also comparable to the errors obtained\nwith the automated method.\nTwo objects show a relative increase in \u1e40 which is much\nlarger than the typical error. These are 10 Lac at log \u1e40 \u2243 \u22127.3\nand Cyg OB2 #2 at log \u1e40 \u2243 \u22126.8. In the case of the latter we\nshowed that the increase is due to a more efficient use of wind\ninformation stored in the line profiles by the automated method,\nwhich improves the relation of Cyg OB2 #2 with respect to the\nwind-momentum relation (see Sect. 6.2).\nWith respect to 10 Lac we already mentioned that a range\nof more than two orders of magnitude in mass loss rate has\nbeen found in different studies. Here we have made the comparison with the upper limit found by HPN, which corresponds\nto one of the lowest \u1e40 determined for this object. If we would\nhave compared our findings to the higher value obtained by\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\n30\n\n100\n29\n\n80\n\nlog MWM\n\nEvolutionary Mass (Msun)\n\n120\n\n21\n\n60\n\n28\n27\n\n40\n26\n\n20\n\n25\n\n0\n0\n\n20\n\n40\n60\n80\n100\nSpectroscopic Mass (Msun)\n\n120\n\n4\n\n4.5\n\n5\n\n5.5\n\n6\n\n6.5\n\nlog(L/L )\n\nFig. 18. Spectroscopic masses derived in this study compared\nto evolutionary masses from Schaller et al. (1992). With the\ngravities obtained from the automated fits no mass discrepancy\nis found and no systematic deviation between the spectroscopically derived masses and the evolutionary predicted masses can\nbe observed.\n\nFig. 19. Modified wind momentum (MWM) in units of\n[g cm s\u22122 R\u2299 ] of the objects fitted with the automated method\n(solid dots). The solid line, giving the wind-momentum luminosity relation (WLR), corresponds to the regression of the\nmodified wind momenta. Given by the dashed line is the predicted WLR of Vink et al. (2000).\n\nHowarth & Prinja (1989), 10 Lac would be at \u2206 \u1e40 = \u22120.5, i.e.\nthe situation in Fig. 17 would be reversed. Consequently, the\nlarge difference for 10 Lac shown in this figure can not be assigned to an error in the automated method, but rather reflects\nour limited understanding of this object.\nAll in all, we can conclude that the general agreement between mass loss rates obtained with the automated method and\n\"by eye\" determinations is very good.\n\ncalculated with the gravities obtained in this study, with masses\nderived by interpolating evolutionary tracks of Schaller et al.\n(1992). It is clear that with the new gravities the situation is\nvery satisfying. All objects have spectroscopic and evolutionary masses which agree within the error bars.\nFor stars with masses below 50 M\u2299 a milder form of the\nmass discrepancy (as found by RPH; see their Fig. 20) could\nstill be present, but with the present data no systematic offset\nbetween the two mass scales can be appreciated. Though we\nfeel it may be premature to conclude that the present analysis\nshows that the mass discrepancy has been resolved, our results\npoint to a clear improvement.\n\n6. Implications for the properties of massive stars\nWith our automated method we have analysed a sizeable sample of early type stars in a homogeneous way, which allows\na first discussion of the implications the newly obtained parameters may have on the mass and modified wind-momentum\nluminosity relation (WLR) of massive stars. A thorough discussion however needs to be based on a much larger sample,\ntherefore at this point we keep the discussion general and the\nconclusions tentative.\n\n6.1. On the mass discrepancy\nThe so called mass discrepancy was first noticed by\nHerrero et al. (1992). These authors found that the spectroscopic masses, i.e. masses calculated from the spectroscopically determined gravity, were systematically smaller than the\nmasses predicted by evolutionary calculations. The situation\nimproved considerably with the use of unified stellar atmosphere models (e.g. Herrero et al. 2002). However, as pointed\nout by Repolust et al. (2004) for stars with masses lower than\n50 M\u2299 still a milder form of a mass discrepancy appears to\npersist.\nDoes the automated fitting method, employing the latest\nversion of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764, help in resolving the mass discrepancy?\nIn Fig. 18 we present a comparison of the spectroscopic masses\n\n6.2. Wind-momentum luminosity relation\nThe modified stellar wind momentum (MWM) versus luminosity relation offers a meaningful way to compare observed wind\nproperties with aspects and predictions of the theory of line\ndriven winds (see Kudritzki & Puls 2000 for a comprehensive\ndiscussion). Without going into any detail, the modified wind\nmomentum Dmom = \u1e40v\u221e R1/2\n\u22c6 is predicted to be a power law of\nstellar luminosity.\nlog Dmom = x log(L\u22c6 /L\u2299 ) + log D\u25e6 ,\n\n(7)\n\nwhere x, the inverse of the slope of the line-strength distribution function corrected for ionization effects (Puls et al. 2000),\nis expected to be a function of spectral type and metal abundance, and D\u25e6 is a function of metallicity and possibly luminosity class (Markova et al. 2004). The advantageous property\nof Dmom is that it is not very sensitive to the stellar mass.\nThe limited number of stars studied in this paper is clearly\ninsufficient to disentangle subtleties in the Dmom vs. L\u22c6 relation. However, it is interesting to compare the observed and\npredicted modified wind momentum, as well as to discuss the\nlocation of 10 Lac \u2013 a notorious outlier.\n\n\f22\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nFigure 19 shows this comparison between derived and theoretical modified wind momentum. Using all programme stars\nto construct an empirical linear curve in the units of this diagram gives the following relation\nlog Dmom = (1.88 \u00b1 0.09) log(L\u22c6 /L\u2299 ) + (18.59 \u00b1 0.52) .\n\n(8)\n\nWithin the given errors this relation is equal to the theoretical WLR predicted by Vink et al. (2000), who found x = 1.83\nand log Dmom = 18.68. Note that the low luminosity objects\n(log L\u22c6 /L\u2299 . 5.5) also follow the average relation. Therefore,\nthe newly obtained mass loss rates do not show the discrepancy\nfound by Puls et al. (1996) and Kudritzki & Puls (2000), but\nconfirm the work of RPH. These authors found the low luminosity objects to follow the general trend, based on upper limits\nthey obtained for the mass loss rates, whereas our new method\nis sensitive enough to determine these self-consistently.\nIn order to investigate the effect of the anomalously low\nDmom obtained for 10 Lac, we also constructed a WLR excluding this object. We found that for this new relation the parameters x and log D\u25e6 only changed with \u223c0.02 and \u223c0.01, respectively, reflecting the large error bars found for this object.\nPrevious investigations by Markova et al. (2004) and RPH\nhave found the WLR to be as function of luminosity class.\nWhereas the former study finds a steeper WLR for the supergiants compared to the dwarfs, the latter finds the opposite\n(though RPH remark that the subset of Cyg OB2 stars seem\nto behave more in accordance with the theoretical result). In\nour sample no obvious separation is visible. In particular note\nthe two objects overlapping at log L\u22c6 /L\u2299 = 4.9 in Fig. 19,\nwhich are the dwarf \u03b6 Oph and the supergiant Cyg OB2 #2.\nTo investigate a possible separation in more detail, a separate\nWLR was constructed for the Cyg OB2 supergiants. The resulting values of the parameters obtained are x = 1.79 \u00b1 0.14\nand log D\u25e6 = 19.12 \u00b1 0.80. The decrease in x qualitatively confirms the work of Markova et al.. However, we have to realize\nthat our sample might be too small from a statistical point of\nview to be able to firmly conclude whether a real separation\nexists. Therefore, this question has to be postponed until we\nhave analysed a larger sample.\n\n7. Summary, conclusions and future work\nWe have presented the first method for the automated fitting of\nspectra of massive stars with stellar winds. In this first implementation, a set of continuum normalized optical spectral lines\nis fitted to predictions made with the fast performance non-LTE\nmodel atmosphere code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 by Puls et al. (2005). The fitting method itself is based on the genetic algorithm \uf770\uf769\uf76b\uf761\uf769\uf761 by\nCharbonneau (1995), which was parallelized in order to handle\nthe thousands of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 models which have to be calculated\nfor an automated fit. Concerning the automated method we can\ndraw the following conclusions:\ni) The method is robust. In applying the method to a number of formal tests, to the study of seven O-type stars in\nCyg OB2, and to five Galactic stars including extreme rotators and/or stars with weak winds (few times 10\u22128 M\u2299 yr\u22121 )\nthe fitting procedure did not encounter convergence problems.\n\nii) Using the width of the global optimum in terms of fitness,\ndefining the group of best fitting models, we are able to define error estimates for all of the six free parameters of the\nmodel (T eff , log g, helium over hydrogen abundance, vturb ,\n\u1e40 and \u03b2). These errors compare well with errors adopted\nin \"by eye\" fitting methods.\niii) For the investigated dataset our automated fitting method\nrecovers mass-loss rates down to \u223c 6 \u00d7 10\u22128 M\u2299 yr\u22121 to\nwithin an error of a factor of two. We point out that even\nfor such low mass-loss rates it is not only the core of the\nhydrogen H\u03b1 line that is a mass-loss diagnostics. When ignoring this core the GA still recovers \u1e40, showing that the\nGA is also sensitive to indirect effects of a change in \u1e40\non the atmospheric structure as a whole. However, for the\nmethod to fully take advantage of this information a very\naccurate continuum normalization is required.\niv) Though we have so far tested our method for O-type stars\nand early B-type dwarf stars, the method can also be applied to B and A supergiants when atomic models of diagnostic lines (such as Si \uf769\uf769\uf769 and Si \uf769\uf776) are implemented into\nthe analysis.\nWe have re-investigated seven O-type stars in the young cluster Cyg OB2 and compared our results with the study by\nHerrero, Puls, & Najarro (2002). The HPN study uses an earlier version of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 and a \"by eye\" fitting procedure. The\nonly difference between the two studies in terms of the treatment of the free parameters is that HPN did not treat the microturbulent velocity and the hydrogen over helium abundance\nratio as continuous free parameters. Instead, they opted to adopt\nin case of the former two possible values only. In case of the\nlatter an initial solar abundance was adopted which was modified in case no satisfying fit could be obtained with this solar\nabundance. We have also compared the results of an automated\nfitting to five early-type dwarf stars to further investigate the\nrobustness of our method for stars with high rotational velocities and/or low mass loss rates. With respect to weak winds we\nrefer to conclusion iii. Regarding large vr sin i values, we find\nthat these do not pose problems for the automated method. This\nis reflected in conclusion i. Concerning the spectral analysis of\nthe entire sample we can draw the following conclusions:\nv) For almost all parameters we find excellent agreement with\nthe results of HPN and RPH, which, we note, make use\nof a previous version of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 and an independent continuum normalization. The quality of our fits (in terms of\nfitness, which is a measure for the \u03c72 of the lines) is even\nbetter than obtained in these prior studies.\nvi) In three cases we find a significantly higher surface gravity\n(by up to 0.36 dex). We identify two possible causes for this\ndifference that may be connected to the difference between\nautomated and \"by eye\" fitting. First, comparison of the two\nmethods indicates that in fitting the Balmer line wings the\nlatter method places essentially infinite strength to the observed flux at the point of maximum curvature of the wing\nprofile. The automated method does not do this. Second, as\nthe automated method is a multidimensional optimization\nmethod it may simply find a better fit to the overall spec-\n\n\fM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\ntrum. In at least one case this implied a higher temperature\nand significantly higher gravity.\nvii) A comparison of our derived masses with those predicted\nby evolutionary calculations does not show any systematic discrepancy. Such a discrepancy was first noted by\nHerrero et al. (1992), though was partly resolved when\nmodel atmospheres improved (e.g. see HPN). Still, with\nstate-of-the-art models a mild form of a mass discrepancy\nremained for stars with masses below 50 M\u2299 (e.g. see\nRPH). The automated fitting approach in combination with\nthe improved version of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 does not find evidence for\na mass discrepancy, although we remark that a truly robust\nconclusion, particularly for stars between 20 and 50 solar\nmasses, may require the investigation of a larger sample.\nviii) The empirical modified wind momentum relation constructed on the basis of the twelve objects analysed in this\nstudy agree to within the error bars with the theoretical\nMWM relations based on the Vink et al. (2000) predictions\nof mass loss rates.\nThis first implementation of a genetic algorithm combined\nwith the fast performance code \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764 already shows the\nhigh potential of automatic spectral analysis. With the current\nrapid increase in observations of early-type massive stars the\nneed for an automated fitting method is evident. We will first\nuse our method to analyse the \u223c100 O-type and early B-type\nstars observed in the VLT large programme FLAMES Survey\nof Massive Stars (Evans et al. 2005) in the Galaxy and the\nMagellanic Clouds in a homogeneous way. Future development of the automated fitting method is likely to be in conjunction with the further development of \uf766\uf761\uf773\uf774\uf777\uf769\uf76e\uf764. Improvements\nwill include the modeling of: near-infrared lines (see e.g.\nLenorzer et al. 2004 and Repolust et al. 2005), optical CNO\nlines (see e.g. Trundle et al. 2004), and possibly UV resonance\nlines. Additional model parameters that may be constrained\nwithin an automated approach include a depth dependent profile for the microturbulent velocity and small scale clumping.\nWithin the current implementation, most likely the method will\nalso be able to constrain the terminal flow velocity of A-type\nsupergiants (McCarthy et al. 1997; Kudritzki et al. 1999).\nAcknowledgements. We would like to thank Chris Evans, Ian Hunter,\nStephen Smartt and Wing-Fai Thi for constructive discussions, and\nMichiel Min for sharing his insights in automated fitting. M.R.M. acknowledges financial support from the NWO Council for Physical\nSciences. F.N. acknowledges PNAYA2003-02785-E and AYA200408271-C02-02 grants and the Ramon y Cajal program.\n\nReferences\nBecker, S. R. & Butler, K. 1992, A&A, 265, 647\nBianchi, L. & Garcia, M. 2002, ApJ, 581, 610\nBouret, J.-C., Lanz, T., Hillier, D. J., et al. 2003, ApJ, 595, 1182\nCharbonneau, P. 1995, ApJS, 101, 309\nCharbonneau, P. & Knapp, B. 1995, NCAR Technical Note 418+IA\nConti, P. S. & Alschuler, W. R. 1971, ApJ, 170, 325\nCrowther, P. A., Hillier, D. J., Evans, C. J., et al. 2002, ApJ, 579, 774\nDarwin, C. 1859, On the Origin of Species by Means of Natural\nSelection (John Murray, London)\nDe Becker, M., Rauw, G., & Manfroid, J. 2004, A&A, 424, L39\n\n23\n\nde Jager, C., Nieuwenhuijzen, H., & van der Hucht, K. A. 1988,\nA&AS, 72, 259\nde Koter, A., Heap, S. R., & Hubeny, I. 1997, ApJ, 477, 792\nEvans, C. J., Crowther, P. A., Fullerton, A. W., & Hillier, D. J. 2004,\nApJ, 610, 1021\nEvans, C. J., Smart, S. J., Lee, J. K., et al. 2005, A&A, 437, 467\nGarcia, M. & Bianchi, L. 2004, ApJ, 606, 497\nGathier, R., Lamers, H. J. G. L. M., & Snow, T. P. 1981, ApJ, 247,\n173\nGibson, S. E. & Charbonneau, P. 1998, J. Geophys. Res., 103, 14511\nGrevesse, N. & Sauval, A. J. 1998, Space Science Reviews, 85, 161\nGroenewegen, M. A. T. & Lamers, H. J. G. L. M. 1989, A&AS, 79,\n359\nHamann, W.-R. 1981, A&A, 100, 169\nHerrero, A. 1993, Space Science Reviews, 66, 137\nHerrero, A., Corral, L. J., Villamariz, M. R., & Mart\u0131\u0301n, E. L. 1999,\nA&A, 348, 542\nHerrero, A., Kudritzki, R. P., Vilchez, J. M., et al. 1992, A&A, 261,\n209\nHerrero, A., Puls, J., Corral, L. J., Kudritzki, R. P., & Villamariz, M. R.\n2001, A&A, 366, 623\nHerrero, A., Puls, J., & Najarro, F. 2002, A&A, 396, 949\nHerrero, A., Puls, J., & Villamariz, M. R. 2000, A&A, 354, 193\nHillier, D. J. 1991, A&A, 247, 455\nHillier, D. J., Lanz, T., Heap, S. R., et al. 2003, ApJ, 588, 1039\nHillier, D. J. & Miller, D. L. 1998, ApJ, 496, 407\nHillier, D. J. & Miller, D. L. 1999, ApJ, 519, 354\nHowarth, I. D. & Prinja, R. K. 1989, ApJS, 69, 527\nHowarth, I. D., Siebert, K. W., Hussain, G. A. J., & Prinja, R. K. 1997,\nMNRAS, 284, 265\nHubeny, I. & Lanz, T. 1995, ApJ, 439, 875\nHumphreys, R. M. 1978, ApJS, 38, 309\nKilian, J. 1992, A&A, 262, 171\nKilian, J., Becker, S. R., Gehren, T., & Nissen, P. E. 1991, A&A, 244,\n419\nKudritzki, R. & Puls, J. 2000, ARA&A, 38, 613\nKudritzki, R.-P. 1980, A&A, 85, 174\nKudritzki, R. P., Puls, J., Lennon, D. J., et al. 1999, A&A, 350, 970\nKudritzki, R. P. & Simon, K. P. 1978, A&A, 70, 653\nLenorzer, A., Mokiem, M. R., de Koter, A., & Puls, J. 2004, A&A,\n422, 275\nMarkova, N., Puls, J., Repolust, T., & Markov, H. 2004, A&A, 413,\n693\nMartins, F., Schaerer, D., Hillier, D. J., & Heydari-Malayeri, M. 2004,\nA&A, 420, 1087\nMassey, P., Bresolin, F., Kudritzki, R. P., Puls, J., & Pauldrach,\nA. W. A. 2004, ApJ, 608, 1001\nMassey, P. & Thompson, A. B. 1991, AJ, 101, 1408\nMatthews, T. A. & Sandage, A. R. 1963, ApJ, 138, 30\nMcCarthy, J. K., Kudritzki, R., Lennon, D. J., Venn, K. A., & Puls, J.\n1997, ApJ, 482, 757\nMetcalfe, T. S. & Charbonneau, P. 2003, Journal of Computational\nPhysics, 185, 176\nMetcalfe, T. S., Nather, R. E., & Winget, D. E. 2000, ApJ, 545, 974\nMokiem, M. R., Mart\u0131\u0301n-Hern\u00e1ndez, N. L., Lenorzer, A., de Koter, A.,\n& Tielens, A. G. G. M. 2004, A&A, 419, 319\nPauldrach, A., Puls, J., & Kudritzki, R. P. 1986, A&A, 164, 86\nPauldrach, A. W. A., Hoffmann, T. L., & Lennon, M. 2001, A&A, 375,\n161\nPuls, J., Kudritzki, R.-P., Herrero, A., et al. 1996, A&A, 305, 171\nPuls, J., Springmann, U., & Lennon, M. 2000, A&AS, 141, 23\nPuls, J., Urbaneja, M. A., Venero, R., et al. 2005, A&A, 435, 669\nRepolust, T., Puls, J., Hanson, M. M., Kudritzki, R.-P., & Mokiem,\n\n\f24\n\nM. R. Mokiem et al.: Spectral analysis using a genetic algorithm based fitting method\n\nM. R. 2005, A&A, accepted\nRepolust, T., Puls, J., & Herrero, A. 2004, A&A, 415, 349\nSchaller, G., Schaerer, D., Meynet, G., & Maeder, A. 1992, A&AS,\n96, 269\nSch\u00f6nberner, D., Herrero, A., Becker, S., et al. 1988, A&A, 197, 209\nSchr\u00f6der, S. E., Kaper, L., Lamers, H. J. G. L. M., & Brown, A. G. A.\n2004, A&A, 428, 149\nSmith, K. C. & Howarth, I. D. 1998, MNRAS, 299, 1146\nTrundle, C., Lennon, D. J., Puls, J., & Dufton, P. L. 2004, A&A, 417,\n217\nVillamariz, M. R. & Herrero, A. 2000, A&A, 357, 597\nVillamariz, M. R. & Herrero, A. 2005, A&A, accepted\nVink, J. S., de Koter, A., & Lamers, H. J. G. L. M. 2000, A&A, 362,\n295\nVoels, S. A., Bohannan, B., Abbott, D. C., & Hummer, D. G. 1989,\nApJ, 340, 1073\nWalborn, N. R. 1972, AJ, 77, 312\nWalborn, N. R. 1973, AJ, 78, 1067\nZaal, P. A., de Koter, A., Waters, L. B. F. M., et al. 1999, A&A, 349,\n573\n\n\f"}