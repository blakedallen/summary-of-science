{"id": "http://arxiv.org/abs/0909.3826v2", "guidislink": true, "updated": "2009-11-30T14:34:22Z", "updated_parsed": [2009, 11, 30, 14, 34, 22, 0, 334, 0], "published": "2009-09-21T17:58:03Z", "published_parsed": [2009, 9, 21, 17, 58, 3, 0, 264, 0], "title": "Continuity of Optimal Control Costs and its application to Weak KAM\n  Theory", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.2074%2C0909.2996%2C0909.1080%2C0909.4482%2C0909.1330%2C0909.2724%2C0909.3947%2C0909.4829%2C0909.4964%2C0909.3457%2C0909.0716%2C0909.3000%2C0909.5310%2C0909.1874%2C0909.2663%2C0909.5615%2C0909.2394%2C0909.3814%2C0909.0981%2C0909.5243%2C0909.3926%2C0909.3106%2C0909.5600%2C0909.1944%2C0909.2075%2C0909.0927%2C0909.4333%2C0909.2762%2C0909.3080%2C0909.0704%2C0909.3538%2C0909.0871%2C0909.5115%2C0909.0044%2C0909.2568%2C0909.3133%2C0909.4302%2C0909.1727%2C0909.3719%2C0909.1592%2C0909.5066%2C0909.3915%2C0909.3787%2C0909.3826%2C0909.1497%2C0909.3044%2C0909.3361%2C0909.4981%2C0909.3807%2C0909.2922%2C0909.0312%2C0909.0110%2C0909.5271%2C0909.1701%2C0909.3590%2C0909.0256%2C0909.4100%2C0909.1956%2C0909.2775%2C0909.1025%2C0909.2621%2C0909.0095%2C0909.0761%2C0909.0649%2C0909.4077%2C0909.1526%2C0909.1645%2C0909.4438%2C0909.1627%2C0909.1049%2C0909.2739%2C0909.3020%2C0909.4936%2C0909.3714%2C0909.1607%2C0909.2146%2C0909.3486%2C0909.2223%2C0909.4353%2C0909.3116%2C0909.3507%2C0909.3737%2C0909.5143%2C0909.3904%2C0909.5026%2C0909.2294%2C0909.2736%2C0909.2536%2C0909.4400%2C0909.0063%2C0909.4128%2C0909.2952%2C0909.5161%2C0909.3405%2C0909.5227%2C0909.3202%2C0909.5234%2C0909.3544%2C0909.4248%2C0909.2604%2C0909.1753&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Continuity of Optimal Control Costs and its application to Weak KAM\n  Theory"}, "summary": "We prove continuity of certain cost functions arising from optimal control of\naffine control systems. We give sharp sufficient conditions for this\ncontinuity. As an application, we prove a version of weak KAM theorem and\nconsider the Aubry-Mather problems corresponding to these systems.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.2074%2C0909.2996%2C0909.1080%2C0909.4482%2C0909.1330%2C0909.2724%2C0909.3947%2C0909.4829%2C0909.4964%2C0909.3457%2C0909.0716%2C0909.3000%2C0909.5310%2C0909.1874%2C0909.2663%2C0909.5615%2C0909.2394%2C0909.3814%2C0909.0981%2C0909.5243%2C0909.3926%2C0909.3106%2C0909.5600%2C0909.1944%2C0909.2075%2C0909.0927%2C0909.4333%2C0909.2762%2C0909.3080%2C0909.0704%2C0909.3538%2C0909.0871%2C0909.5115%2C0909.0044%2C0909.2568%2C0909.3133%2C0909.4302%2C0909.1727%2C0909.3719%2C0909.1592%2C0909.5066%2C0909.3915%2C0909.3787%2C0909.3826%2C0909.1497%2C0909.3044%2C0909.3361%2C0909.4981%2C0909.3807%2C0909.2922%2C0909.0312%2C0909.0110%2C0909.5271%2C0909.1701%2C0909.3590%2C0909.0256%2C0909.4100%2C0909.1956%2C0909.2775%2C0909.1025%2C0909.2621%2C0909.0095%2C0909.0761%2C0909.0649%2C0909.4077%2C0909.1526%2C0909.1645%2C0909.4438%2C0909.1627%2C0909.1049%2C0909.2739%2C0909.3020%2C0909.4936%2C0909.3714%2C0909.1607%2C0909.2146%2C0909.3486%2C0909.2223%2C0909.4353%2C0909.3116%2C0909.3507%2C0909.3737%2C0909.5143%2C0909.3904%2C0909.5026%2C0909.2294%2C0909.2736%2C0909.2536%2C0909.4400%2C0909.0063%2C0909.4128%2C0909.2952%2C0909.5161%2C0909.3405%2C0909.5227%2C0909.3202%2C0909.5234%2C0909.3544%2C0909.4248%2C0909.2604%2C0909.1753&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We prove continuity of certain cost functions arising from optimal control of\naffine control systems. We give sharp sufficient conditions for this\ncontinuity. As an application, we prove a version of weak KAM theorem and\nconsider the Aubry-Mather problems corresponding to these systems."}, "authors": ["A. Agrachev", "P. Lee"], "author_detail": {"name": "P. Lee"}, "author": "P. Lee", "arxiv_comment": "23 pages, 1 figures, added explanations in the proofs of the main\n  theorem and the example", "links": [{"href": "http://arxiv.org/abs/0909.3826v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0909.3826v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "35F21; 49L25", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0909.3826v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0909.3826v2", "journal_reference": null, "doi": null, "fulltext": "arXiv:0909.3826v2 [math.OC] 30 Nov 2009\n\nCONTINUITY OF OPTIMAL CONTROL COSTS AND ITS\nAPPLICATION TO WEAK KAM THEORY\nANDREI AGRACHEV AND PAUL W.Y. LEE\nAbstract. We prove continuity of certain cost functions arising from optimal\ncontrol of affine control systems. We give sharp sufficient conditions for this continuity. As an application, we prove a version of weak KAM theorem and consider\nthe Aubry-Mather problems corresponding to these systems.\n\n1. Introduction\nIntegrability of Hamiltonian systems has been a subject of considerable interest\nfor several decades. One way to understand the dynamics of such systems is to find\na family of smooth solutions, called generating functions, to the time-independent\nHamilton-Jacobi equation. These generating functions define symplectic transformations which transform the given completely integrable Hamiltonian system to a\nmuch simpler one that are easily solvable.\nOn the contrary, if the Hamiltonian system is not completely integrable, then it\nis natural to ask whether one can solve the Hamilton-Jacobi equation in certain\nweak sense. This is accomplished in, what is known as, the weak KAM theorem\nunder certain assumptions on the Hamiltonian. More precisely, let L : T M \u2192 R be\na Lagrangian defined on the tangent bundle T M of a compact manifold M which\nsatisfies the following conditions:\n(1) the restriction of the Lagrangian L to each tangent space has positive definite\nHessian,\n(2) L(x, v) \u2265 C|v|2 + K for some Riemannian metric | * | and some constants\nK, C > 0.\nLet H : T \u2217 M \u2192 R be the corresponding Hamiltonian defined by the Legendre\ntransform:\nH(x, \u03b1) = sup [\u03b1(v) \u2212 L(x, v)].\nv\u2208Tx M\n\nThe following is the weak KAM theorem mentioned above. It was first proven in\n[12] when M is a torus and was extended to all compact manifolds in [8] (see also\n[10] for a version related to vakonomic mechanics).\nThe first author was supported by PRIN and the second author was supported by the NSERC\npostdoctoral fellowship.\n1\n\n\f2\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nTheorem 1.1. Under the above assumptions, there exists a unique constant h such\nthat the Hamilton-Jacobi equation\n(1.1)\n\nH(x, dfx ) = \u2212h,\n\nhas a viscosity solution.\nIn order to give the definition of viscosity solution, we first recall the concepts of\nsub- and super- differentials. If f is a continuous function on a manifold M, then\nthe sub-differential d\u2212 fx of the function f at a point x is the subset of the cotangent\nspace Tx\u2217 M defined by the following: a co-vector p in the cotangent space Tx\u2217 M is\ncontained in the sub-differential d\u2212 fx of f at x if there exists a smooth function g\ndefined in a neighborhood O of x such that dgx = p and g touches f from above. By\ng touching from above, we mean that f (x) = g(x) and f (y) \u2264 g(y) for all y in the\nset O. The super-differential d+ f of f is defined in a similar way with the function g\ntouching from below instead. Let G : R \u00d7 T \u2217 M \u2192 R be a continuous function, then\na continuous function f is called a sub-solution to the equation G(f (x), x, p) = 0 if\nfor each p in the sub-differential d\u2212 fx ,\nG(f (x), x, p) \u2264 0.\nSimilarly, f is a super-solution if for each p in the super-differential d+ fx ,\nG(f (x), x, p) \u2265 0.\nIf f is both a super and a sub-solution, then it is called a viscosity solution (see [6]\nfor various different characterizations of the sub-differential and viscosity solution).\nIn this paper, we study weak KAM theorem corresponding to Hamiltonians which\narise from certain optimal control problems. More precisely, let X0 , X1 , ..., Xn be\nsmooth vector fields on a compact manifold M of dimension m and consider the\nfollowing family of ODEs, called control-affine system:\nn\nX\n(1.2)\n\u1e8b(t) = F (x(t), u(t)) := X0 (x(t)) +\nui (t)Xi (x(t)),\ni=1\n\nn\n\nwhere u(*) := (u1 (*), ..., un (*)) : [0, T ] \u2192 R are essentially bounded measurable\nfunctions, called controls, and solutions to (1.2) are Lipschitz curves in M, called\nadmissible paths.\nLet L : M \u00d7Rn \u2192 R be a smooth function, called Lagrangian. The optimal control\ncost cT corresponding to the above control affine system (1.2) and Lagrangian L is\nthe following function:\nZ T\n(1.3)\ncT (x, y) = inf\nL(x(t), u(t))dt,\n0\n\nwhere the infimum is taken over all pairs (x(*), u(*)) which satisfies the affine control\nsystem (1.2) and the boundary conditions x(0) = x and x(T ) = y.\nSince there may exist points which are not connected by any admissible path,\nthe above cost function is not always well-defined without additional assumptions.\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n3\n\nWe recall that a family of vector fields {X1 , ..., Xn } is said to be k-generating if\nthe vector fields Xi and their iterated Lie brackets up to k \u2212 1 order spanned each\ntangent space in T M. More precisely, the following holds for each point x in the\nmanifold M\nTx M = span{[Xi1 , [Xi2 , ..., [Xil\u22121 , Xil ]]](x) | 1 \u2264 ij \u2264 n, 1 \u2264 l \u2264 k}.\nThe family {X1 , ..., Xn } is bracket generating if it is k-generating for some k. If we\nassume that the family {X1 , ..., Xn } is bracket generating, then any two points can\nbe connected by an admissible path [2]. Therefore, under this assumption, the cost\ncT in (1.3) is well-defined for any T > 0 and any points x,y on the manifold M.\nIn this paper, we prove continuity of the optimal control cost cT under some\ngrowth and convexity conditions on the Lagrangian L (see Theorem 3.2). A simple\nuseful corollary of the general continuity result is as follows:\nTheorem 1.2. Assume that the Lagrangian L and the vector fields X1 , ..., Xn satisfy\nthe following conditions:\n(1) C1 |u|q + K1 \u2264 L(x, u) \u2264 C2 |u|2 + K2 ,\n(2) | \u2202L(x,u)\n| \u2264 C3 |u|2,\n\u2202x\n(3) the Hessian of L in the u variable is positive definite, and\n(4) {X1 , ..., Xn } is 3-generating\nfor some constants C1 , C2 , C3 , K1 , K2 > 0 and some constant q > 1. Then the cost\nfunction (t, x, y) 7\u2192 ct (x, y) defined in (1.3) is continuous.\nAs an application, we prove a version of the weak KAM theorem corresponding\nto the above optimal control cost c. More precisely, let H : T \u2217 M \u2192 R be the\nHamiltonian function defined by\n(1.4)\n\nH(x, \u03b1x ) = sup [\u03b1x (F (x, u)) \u2212 L(x, u)]\nu\u2208U\n\nNote that the Hamiltonian H is, in general, neither fiberwise strictly convex nor\ncoercive, which are basic assumptions on the classical weak KAM theory (see [9]).\nTheorem 1.3. (Weak KAM Theorem) If we make the same assumptions as in\nTheorem 1.2, then there exists a unique constant h such that the Hamilton-Jacobi\nequation (1.1) has a viscosity solution.\nThe structure of this paper is as follows. In Section 2, we give a counter example\nshowing that the 3-generating condition in Theorem 1.2 is essential. Section 3 and\nSection 4 are devoted to the proof of Theorem 1.2 and 1.3, respectively. In Section\n5, we study a generalization of the Aubry-Mather problem to the present setting.\n2. Example\nAssume that M is two-dimensional and the control system has the form:\n\u1e8b1 = u1 ,\n\n\u1e8b2 = x21 + u2 xk1 ,\n\n\f4\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nin some local coordinate chart. The family of vector fields X1 (x1 , x2 ) = (1, 0) and\nX2 (x1 , x2 ) = (0, xk1 ) is (k + 1)-generating but not k-generating. In this section, we\nshow that the cost function c1 corresponding to the Lagrangian L(x, u) = 21 (u21 + u22 )\nis not continuous if k \u2265 3. This shows that the 3-generating assumption in Theorem\n1.2 is essential. More precisely,\nProposition 2.1. Assume that k \u2265 3. Then the cost function c1 corresponding to\nthe above control system and Lagrangian satisfies\nc1 ((0, w), (0, w)) = 0,\n\nc1 ((0, w), (0, z)) \u2265 K\n\nfor some constant K > 0, all w, and all z < 0. In particular, the cost function c1 is\nnot continuous.\nProof. According to the result in [5], the cost function c1 is much better than continuous (in fact semiconcave) at (x, y) if the points x and y are not connected by\nabnormal minimizers (see [1] or below for the definitions of normal and abnormal\nminimizers). Therefore, let us apply Pontryagin maximum principle and find candidates for which the cost function c1 is not continuous.\nLet Hu\u03bd be the Hamiltonian function defined by\nHu\u03bd (x, p) = p(F (x, u)) + \u03bdL(x, u).\nBy applying Pontryagin maximum principle (see, for instance, [1]), any minimizer\n(x(*), u(*)) of the minimization problem in (1.3) satisfies\n\u2202Hu\u03bd\n\u2202H \u03bd\n\u2202Hu\u03bd\n(2.5)\n\u1e8bi =\n, \u1e57i = \u2212 u ,\n=0\n\u2202pi\n\u2202xi\n\u2202ui\nfor some curve p(*) and some constant \u03bd such that (\u03bd, p(t)) 6= 0. Moreover, \u03bd can be\nchosen to be either 0 or \u22121. A minimizer (x(*), u(*)) is abnormal if the corresponding\n\u03bd in the Pontryagin maximum principle is 0. It is normal if \u03bd = \u22121. Note that a\nminimizer can both be normal and abnormal.\nIn the present case, the Hamiltonian Hu\u03bd is given by\n\u03bd\nHu\u03bd (x, p) = p1 u1 + p2 x21 + p2 u2xk1 + (u21 + u22 ).\n2\nFor the abnormal case \u03bd = 0, (2.5) becomes\n\u1e8b1 = u1 ,\n\n\u1e8b2 = x21 + u2 xk1 ,\n\n\u1e572 = 0,\n\np1 = 0,\n\np2 xk1 = 0.\n\nBy Pontryagin maximum principle, p1 and p2 cannot be equal to zero simultaneously\nsince \u03bd = 0. It follows that x1 \u2261 0 and x2 \u2261 x2 (0). The corresponding controls to all\nthese paths are all given by the zero control u \u2261 0. It follows that c1 ((0, w), (0, w)) =\n0 for any w and these are candidates for discontinuities of the cost c1 .\nNext, we show that c1 ((0, w), (0, z)) \u2265 K for some constant K > 0 and for all\nz < w. For this, we consider the case \u03bd = \u22121. In this case, the Hamiltonian is given\nby\n1\nHu\u22121 (x, p) = p1 u1 + p2 x21 + p2 u2 xk1 \u2212 (u21 + u22 ).\n2\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n5\n\nIt follows from (2.5) that we have\n(2.6)\n\n1\n1\n2\n2\nH := Hu\u22121 (x, p) = p21 + x2k\n1 p2 + x1 p2 ,\n2\n2\n\u1e8b1 = p1 , \u1e572 = 0, u1 = p1 , u2 = xk1 p2 .\n\nIf we assume that x(0) = (0, w) and x(1) = (0, z) with z < w, then it follows from\n(2.6) that the cost c1 ((0, w), (0, z)) for going from (0, w) to (0, z) is estimated by\nZ\nZ\n1 1 2\n1 1 2\n2k 2\n(2.7)\np + x1 p2 dt \u2265\np dt.\nc1 ((0, w), (0, z)) =\n2 0 1\n2 0 1\nSince p2 is a constant of motion, we can fix p2 and look at the phase portrait of\nthe system\n\u1e8b1 = p1 , \u1e571 = \u2212kx12k\u22121 p22 \u2212 2x1 p2\n\n(see Figure 1). The cost c((0, w), (0, z)) in (2.7) can be estimated from below by the\narea enclosed by the level set H = 0. More precisely,\nZ \u03ba\n(2.8)\nc((0, w), (0, z)) \u2265\np1 (x1 , p2 )dx1 ,\n0\n\n\u0011 1\n\u0010\n2 2k\u22122\n2\n2\nwhere p1 (x, p2 ) is defined implicitly by 12 p21 + 12 x2k\nis\np\n+x\np\n=\n0\nand\n\u03ba\n=\n\u2212\n1 2\n1 2\np2\nthe positive zero of the function p1 (x1 , p2 ). Note that p2 < 0. Indeed, H(x(t), p(t))\nis constant, we have H(x(t), p(t)) = Hu\u22121 (x(0), p(0)) \u2265 0. It follows that p2 (t) =\np2 (0) \u2264 0.\nIf we do a change of variable x1 = \u03baz, then we have\nZ \u03ba\nZ \u03ba\n\u00011\n2 2\ndx1\np1 (x1 , p2 )dx1 \u2265\n\u22122x21 p2 \u2212 x2k\n1 p2\n0\n0\n(2.9)\nZ 1\nk\u22123\nk+1\n1\n2k\u22122\n= 2 2k\u22122 (\u2212p2 )\n(z 2 \u2212 z 2k ) 2 dz.\n0\n\nOn the other hand, by Figure 1 and (2.6), we have\n\u0012\n\u0013 1\nZ\nZ\nZ\n1 1 2\n1\n2 2k\u22122\n1 1\n1\n(2.10)\n\u1e8b1 dt \u2265\n\u2212\n.\np dt \u2265\n|p1 |dt \u2265\n2 0 1\n2 0\n2 {t|\u1e8b1 (t)\u22650}\n2\np2\nIf we combine (2.7), (2.8), (2.9), and (2.10), then we get\n(\u0012\n)\n\u0013 1\nk\u22123\n1 2k\u22122\nc((0, w), (0, z)) \u2265 C max\n\u2212\n, (\u2212p2 ) 2k\u22122\np2\n\nfor some constant C > 0.\nIt follows that the cost c((0, w), (0, z)) is bounded below by a positive constant\nindependent of p2 if k \u2265 3 and this finishes the proof of the result.\n\u0003\n\n\f6\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nFigure 1. Phase portrait of the example (level sets of the Hamiltonian H)\n3. Continuity of Optimal Control Costs\nIn this section, we will state and prove the general continuity result (Theorem 3.2)\nmentioned in the introduction. To do this, let us introduce some notations. If Xt is\na, possibly time-dependent, vector field, then the corresponding flow \u03c6t defined by\n\u03c60 (x) = x and dtd \u03c6t (x) = Xt (\u03c6t (x)) is denoted by\nZ t\n\u2212\n\u2192\n\u03c6t = exp\nXs ds.\n0\n\nWe define the endpoint map\n\nEndTx0\n\np\n\n: L ([0, T ], U) \u2192 M by\nZ T\n\u2212\n\u2192\nT\nEndx0 (u(*)) = exp\nFu(s) ds(x0 ),\n0\n\nP\nwhere Fu is the vector field defined by Fu (x) = F (x, u) = X0 (x) + ni=1 ui Xi (x).\nLet us first fixed a control u(*). The first goal is to show that the control system is\nlocally controllable. It means that we can reach any point near the point EndTx0 (u(*))\nby adding a small control v(*) to the fixed one u(*). The first idea is to replace the\ncontrol system (1.2) with drift X0 by one without drift. However, the control vector\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n7\n\nfields X1 , ..., Xn will become time dependent in the new control system. This is\naccomplished in Lemma 3.1. Recall that if P : M \u2192 M is a diffeomorphism and X\nis a vector field on M, then the pull back vector field P \u2217 X is the vector field defined\nby P \u2217X = dP \u22121 (X \u25e6 P ).\nLemma 3.1. Let git be the time-dependent vector field defined by\n\u0012\n\u0013\u2217\nZ t\n\u2212\n\u2192\nt\ngi := exp\nFu(s) ds Xi .\n0\n\nThen\n\nEndTx0 (u(*)\n\n\u2192\n+ v(*)) = \u2212\nexp\n\nZ\n\nT\n\n\u2192\nFu(t) dt \u25e6 \u2212\nexp\n\n0\n\nZ\n\nT\n0\n\nn\nX\n\nvi (t)git dt(x0 ).\n\ni=1\n\n\u2192RtF\n\u2192 R t F ds, respectively.\nProof. Let Qt and Rt be the flows \u2212\nexp\nds and \u2212\nexp\n0 u(s)+v(s)\n0 u(s)\nLet Pt be the flow defined by Qt = Rt \u25e6 Pt . If we differentiate the above equation,\nthen we get\nFu(t)+v(t) \u25e6 Qt = Q\u0307t = \u1e58t \u25e6 Pt + dRt (\u1e56t ) = Fu(t) \u25e6 Qt + dRt (\u1e56t ).\nAfter simplifying the above equation, we get \u1e56t = dRt\u22121 (Fv(t) \u25e6 Qt ) = (Rt )\u2217 Fv(t) \u25e6 Pt\nand this completes the proof.\n\u0003\nRecall that we want to show local controllability by varying v(*). In Lemma 3.1,\nwe have decompose the endpoint map Endx0 (u(*) + v(*)) into two parts. The first\n\u2192 R T F dt is independent of the varying control v(*) and it is a diffeomorpart \u2212\nexp\nu(t)\n0\nphism.\nTherefore,\nit is enough to show local controllability for the second term\n\u2212\n\u2192 R T Pn v (t)g t dt(x ) which is the endpoint map to a new control system\nexp\n0\ni\ni=1 i\n0\n(3.11)\n\n\u1e8b =\n\nn\nX\n\nvi (t)git .\n\ni=1\n\nNote that this is a system with no drift but with time dependent control vector\nfields git as mentioned earlier.\nBefore proceeding to the proof of local controllability of the system (3.11), let us\nstate the main result of this section which includes Theorem 1.2 as a corollary.\nTheorem 3.2. Assume that the Lagrangian L and the family of vector fields\n{g1t , ..., gnt |t \u2208 [0, T ]}\nsatisfy the following conditions:\n(1) C1 |u|q + K1 \u2264 L(x, u) \u2264 C2 |u|p + K2 ,\n(2) | \u2202L(x,u)\n| \u2264 C3 |u|2,\n\u2202x\n(3) the Hessian of L in the u variable is positive definite, and\n(4) {g1t , ..., gnt | t \u2208 [0, T ]} is k-generating, \u2200u(*),\nfor some constants C1 , C2 , C3 , K1 , K2 > 0 and some constant q > 1. Suppose further\nthat one of the followings is satisfied:\n\n\f8\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\n(1) k = 3 and p \u2264 2, or\n(2) k > 3, p < k\u22122\n.\nk\u22123\nThen the cost function (t, x, y) 7\u2192 ct (x, y) defined in (1.3) is continuous.\nGoing back to the local controllability issue of the system (3.11), let us denote the\nendpoint map to the new system by \u03a6T : Lp ([0, T ], U) \u00d7 M \u2192 M. More precisely,\nZ TX\nn\n\u2212\n\u2192\nT\n\u03a6 (v(*), x) := exp\nvi (t)git dt(x).\n0\n\ni=1\n\nIf the control vector fields git in the above new system is time independent, then\nlocal controllability follows from the Chow-Rashevskii theorem (see for instance\n[13]). More precisely, we will need the following lemma for which the proof will be\ngiven for completeness. Recall that if X, Y are two vector fields, then the vector\nfield adX Y is defined by adX Y = [X, Y ].\n\nLemma 3.3. Let g1 , ..., gn which are time-independent family of vector fields. Then\nthere exists piecewise constant control w(*) for which w(t) has only one nonzero\ncomponent for each t and such that\n!\n!\nZ T\nn\nX\n\u2212\n\u2192\nf exp\n\u01eb\nwi (t)gi dt(x0 ))\n(3.12)\n0\ni=1\n= f (x0 ) + \u01ebk (adg1 ...adgk\u22121 gk )f (x0 ) + o(\u01ebk )\n\nas \u01eb \u2192 0 for every smooth function f .\nProof. Let Pt\u01eb and Q\u01ebt be the flows corresponding to the control system (1.2) with\ncontrols \u01ebw P and \u01ebw Q , respectively. More precisely,\n!\n!\nZ t\nZ t\nn\nn\nX\nX\n\u2192\n\u2192\nPt\u01eb (x0 ) = \u2212\nexp\n\u01eb\nwiP (s)gi ds, Q\u01ebt (x0 ) = \u2212\nexp\n\u01eb\nwiQ (s)gi ds.\n0\n\ni=1\n\n0\n\ni=1\n\nMoreover, assume that there are vector fields X and Y such that the flows Pt\u01eb and\nQ\u01ebt satisfy\nf (Pt\u01eb (x0 )) = f (x0 ) + \u01ebXf (x0 ) + o(\u01eb),\n\nf (Q\u01ebt (x0 )) = f (x0 ) + \u01ebk Y f (x0 ) + o(\u01ebk )\n\nfor all smooth functions f .\nNext, we define a control w\u0304 which is the concatenation of the controls w P , w Q ,\n\u2212w P , and \u2212w Q .\n\uf8f1\n\u2212w P (t)\nif 0 \u2264 t \u2264 T\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\u2212w Q (t \u2212 T ) if T < t \u2264 2T\nw\u0304(t) =\n\uf8f4\nw P (t \u2212 2T )\nif 2T < t \u2264 3T\n\uf8f4\n\uf8f4\n\uf8f3 Q\nw (t \u2212 3T )\nif 3T < t \u2264 4T.\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n9\n\nIt follows that\n!\n!\nZ 4T\nn\nX\n\u2192\nf \u2212\nexp\n\u01eb\nw\u0304i (s)gi ds(x0 ) = f (Q\u01ebT \u25e6 PT\u01eb \u25e6 (Q\u01ebT )\u22121 \u25e6 (PT\u01eb )\u22121 (x0 )).\n0\n\ni=1\n\nLet h(\u01eb1 , \u01eb2 ) = f (Q\u01ebT2 \u25e6 PT\u01eb1 \u25e6 (Q\u01ebT2 )\u22121 \u25e6 (PT\u01eb1 )\u22121 (x0 )) and we want to consider the\nexpansion of the function h(\u01eb, \u01eb) in the parameter \u01eb. Note that PT0 = Q0T is the\nidentity transformation. It follows that the zeroth order term of the expansion of\nh(\u01eb, \u01eb) in \u01eb is f (x0 ). In fact, the following is true.\n(3.13)\n\nh(\u01eb1 , 0) = h(0, \u01eb2 ) = f (x0 ).\n\nBy definition of the flow Q\u01ebt , we have \u2202\u01ebi f (Q\u01ebt )\nfollows that \u2202\u01ebi2 h\n\n\u01eb2 =0\n\n\u01eb=0\n\n= 0 for all i = 1, ..., k \u2212 1. It\n\n= 0 for each such i. Therefore, except the zeroth order term,\n\nany term of order less than k in the expansion of h vanishes. However, by (3.13),\nthe k-th order vanishes as well. Therefore, we consider the (k + 1)-th order term.\nMoreover, by the same argument, the only nontrivial (k + 1)-th order term is given\nby \u2202\u01eb1 \u2202\u01ebk2 h\n. A computation shows the following\n\u01eb1 =\u01eb2 =0\n\n\u2202\u01ebk+1 h(\u01eb, \u01eb)\n\n\u01eb=0\n\n= (k + 1)\u2202\u01eb1 \u2202\u01ebk2 h(\u01eb1 , \u01eb2 )\n\n\u01eb1 =\u01eb2 =0\n\n= (k + 1)[Y, X]f (x0 ).\n\nIn conclusion, we have shown that\n!\n!\nZ 4T\nn\nX\n\u01ebk+1\n\u2192\n[Y, X]f (x0 ) + o(\u01ebk+1 ).\nf \u2212\nexp\n\u01eb\nw\u0304i (s)gi ds(x0 ) = f (x0 ) +\nk!\n0\ni=1\n\nBy rescaling time and multiplying the control w\u0304 by a constant, we have a control\nw which satisfies\n!\n!\nZ T\nn\nX\n\u2212\n\u2192\n\u01eb\nwi (s)gi ds(x0 ) = f (x0 ) + \u01ebk+1 [Y, X]f (x0 ) + o(\u01ebk+1 ).\n(3.14) f exp\n0\n\ni=1\n\nNote that if the controls w P and w Q are piecewise constant and have only one\nnonzero component for each time t, then so is w by construction.\nIf we let the control w P and w Q be the constant controls defined by wiP (t) = \u03b4i,i1\nand wiQ (t) = \u03b4i,i2 for each t, then (3.14) shows that\n!\n!\nZ T\nn\nX\n\u2192\nexp\n\u01eb\nwi (s)gi ds(x0 ) = f (x0 ) + \u01eb2 [gi2 , gi1 ]f (x0 ) + o(\u01eb2 ).\nf \u2212\n0\n\ni=1\n\nThis proves the lemma for the case k = 2. The rest follows from induction using\n(3.14).\n\u0003\nThe second idea is to take a control given by Lemma 3.3, rescale it so that it is\nconcentrated on a smaller and smaller time interval, and put the rescaled controls to\nthe place where the vector fields g1t , ..., gnt are bracket generating. This way we obtain\n\n\f10\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nlocal controllability as in Chow-Rashevskii theorem. Here we need the conditions\non the numbers k and p to make sure that the rescaled controls stay small. This\nsecond idea will be achieved in Proposition 3.4 below. To do this, let us consider\nthe curves t 7\u2192 git (x0 ) contained in the tangent space Tx0 M. Let I be an interval in\n[0, T ] with the property that any subinterval I \u2032 contained in I satisfies\nspan{g1t (x0 ), ..., gnt (x0 )|t \u2208 I \u2032 } = span{g1t (x0 ), ..., gnt (x0 )|t \u2208 I}.\nProposition 3.4. Let \u03c4 be a Lebesgue point of the control u(*) contained in the\ninterval I and assume that either\n(1) k = 3 and p \u2264 2, or\n(2) k > 3, p < k\u22122\n.\nk\u22123\nThen there exists \u03b1, \u03b2 > 0 and a family of controls v \u01eb (*) which converges to 0 in Lp\nand such that\nZ T\nT\n\u01eb\nk(\u03b2\u2212\u03b1)\nf (\u03a6 (v (*)), x0 ) = f (x0 ) + \u01eb\nadgi\u03c4 ...adgi\u03c4 (gi\u03c4k )f (x0 )ds + o(\u01ebk(\u03b2\u2212\u03b1) ),\n1\n\n0\n\nk\u22121\n\nas \u01eb \u2192 0, for any smooth function f .\n\nProof. By Lemma 3.3, there is a piecewise constant control w(*) for which w(t) has\nonly one nonzero component for each t and such that\n!\n!\nZ T\nn\nX\n\u2192\nf \u2212\nexp\n\u01eb\nwi (t)gi\u03c4 dt(x0 ))\n0\n(3.15)\ni=1\n= f (x0 ) + \u01ebk (adgi\u03c4 ...adgi\u03c4\n1\n\nk\u22121\n\ngi\u03c4k )f (x0 ) + o(\u01ebk )\n\nas \u01eb \u2192 0. Note that \u03c4 is fixed and gi\u03c4 is a time independent vector field.\nLet 0 = t0 \u2264 t1 \u2264 ... \u2264 tl = T be a partition such that the restriction w|[ti\u22121 ,ti ) of\nthe control w(*) to the subinterval [ti\u22121 , ti ) is constant and there is only one nonzero\ncomponent. We suppose that the ki -th component of w|[ti\u22121 ,ti ) is nonzero and this\nnonzero component is equal to ci .\nWe need to create more freedom in our controls for later use (Lemma 3.5 to be\nprecise). Let v(*) be a control of the form v(*) = w(*) + \u03b1(*) such that \u03b1j |[ti ,ti+1 ) \u2261 0\nRt\nRt\nif j 6= ki and tii+1 \u03b1ki (s)ds = 0. It follows from (3.15) and tii+1 \u03b1ki (s)ds = 0 that\n(3.16)\n\nf\n\n\u2212\n\u2192\nexp\n\nZ\n\nT\n\n\u01eb\n\n0\n\nn\nX\n\nvi (t)gi\u03c4\n\ni=1\n\nk\n\n= f (x0 ) + \u01eb (adgi\u03c4 ...adgi\u03c4\n1\n\n!\n\nk\u22121\n\ndt(x0 ))\n\n!\n\ngi\u03c4k )f (x0 ) + o(\u01ebk ).\n\nNext, we rescale the control v(*) as mentioned earlier. Let Gs,v :=\nlet\n(\n\u01eb\u2212\u03b1 v((t \u2212 \u03c4 )/\u01eb\u03b2 ) if t \u2208 (\u03c4, \u03c4 + \u01eb\u03b2 )\nv \u01eb (t) =\n0\notherwise.\n\nPn\n\ni=1\n\nvi gis and\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n11\n\nThen we have\n\u0012\nZ\n\u2212\n\u2192\nf exp\n\nT\n\nGs,v\u01eb (s) ds(x0 )\n\n0\n\n=f\n\n\u2212\n\u2192\nexp\n\nZ\n\n\u03c4 +\u01eb\u03b2\n\nZ\n\nT\n\n\u0013\n\nGs,v\u01eb (s) ds(x0 )\n\n\u03c4\n\n=f\n\n\u2212\n\u2192\nexp\n\n\u01eb\u03b2\u2212\u03b1\n\n0\n\n\u0012\nZ\n\u2212\n\u2192\n= f exp\n\nn\nX\n\n!\n\n\u01eb\u03b2 s+\u03c4\n\nvi (s)gi\n\nds(x0 )\n\ni=1\n\nT\n\u03b2\u2212\u03b1\n\n\u01eb\n\n!\n\n\u0013\n\nG\u01eb\u03b2 s+\u03c4,v(s) ds(x0 ) .\n\n0\n\nBy using the asymptotic expansion in [1, section 2.4.4], the above equation becomes\n\u0013\n\u0012\nZ T\n\u2212\n\u2192\nGs,v\u01eb (s) ds(x0 )\nf exp\n0\n\n(3.17)\n\n= f (x0 ) +\n\nk Z\nX\n\n0\u2264s1 \u2264...\u2264si\u2264T\n\ni=1\n\nk(\u03b2\u2212\u03b1)\n\n+ o(\u01eb\n\n\u01ebi(\u03b2\u2212\u03b1) G\u01eb\u03b2 s1 +\u03c4,v(s1 ) ...G\u01eb\u03b2 si +\u03c4,v(si ) f (x0 )ds1 ...dsi +\n\n).\n\nas \u01eb \u2192 0.\nLet Ii be the term\nIi (v(*)) :=\n\nZ\n\nG\u01eb\u03b2 s1 +\u03c4,v(s1 ) ...G\u01eb\u03b2 si +\u03c4,v(si ) f (x0 )ds1 ...dsi\n0\u2264s1 \u2264...\u2264si \u2264T\n\nin the expansion (3.17).\nRT\nLet us first deal with the term I1 (v(*)) = 0 G\u01eb\u03b2 s+\u03c4,v(s) f (x0 )ds. For this, let\ngi\u03c4 +\u01ebs = gi\u03c4 + Zi\u01eb,s . Let us recall that v(*) = w(*) + \u03b1(*) and \u03b1j \u2261 0 if j 6= ki .\nT\n\nI1 (v(*)) =\n\nZ\n\nT\n\n=\n\nZ\n\n=\n\nZ\n\n0\n\n(3.18)\n\n0\n\n0\n\nn\nX\n\n\u03b2\n\nvi (s)gi\u03c4 +\u01eb s f (x0 )ds\n\ni=1\n\nn\nX\n\ni=1\nn\nT X\ni=1\n\nvi (s)gi\u03c4 f (x0 )ds\n\n+\n\nvi (s)gi\u03c4 f (x0 )ds +\n\nZ\n\nT\n\nn\nX\n\n0 i=1\nn\nX Z ti\ni=1\n\n(wi (s) + \u03b1i (s))Zi\u01eb,sf (x0 )ds\n\nti\u22121\n\n(ci + \u03b1ki (s))Zk\u01eb,s\nf (x0 )ds.\ni\n\nThe next lemma says that we can choose \u03b1 to get rid of the last term of the above\nequation.\n\n\f12\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nR ti \u01eb\nLemma 3.5. There exists \u01eb0 > 0 and \u03b1\u01eb (*) in L2 such that ti\u22121\n\u03b1ki (s)ds = 0 and\nZ TX\nn\n\u01eb\n(3.19)\nI1 (w(*) + \u03b1 (*)) =\nvi (s)gi\u03c4 f (x0 )ds\n0\n\ni=1\n\n\u01eb\n\nfor all 0 < \u01eb < \u01eb0 . Moreover, \u03b1 goes to 0 in L2 as \u01eb goes to 0.\n\nProof of Lemma 3.5. Recall that we need \u03b1\u01eb (*) to satisfy the conditions\nZ ti\nZ ti\n\u01eb\n(3.20)\n\u03b1ki (s)ds = 0,\n(ci + \u03b1k\u01eb i (s))Zk\u01eb,s\nf (x0 )ds = 0.\ni\nti\u22121\n\nti\u22121\n\nfor all smooth functions f and for all i. Consider local coordinates around the point\nx0 and suppose that Zk\u01eb,s\n= (Zk\u01eb,s\n, ..., Zk\u01eb,s\n) in this local coordinates. Then the\ni\ni ,1\ni ,m\nconditions in (3.20) is the same as that \u03b1k\u01eb i (*) orthogonal to the constant functions\nand ci + \u03b1k\u01eb i (*) is orthogonal to Zk\u01eb,*i in L2 ([ti\u22121 , ti ]) for each i. Let Vi be the finite\ndimensional subspace of L2 ([ti\u22121 , ti ]) defined by\nVi\u01eb := span{Zk\u01eb,*i ,1 , ..., Zk\u01eb,*i,m }.\nA linear algebra argument shows that \u03b1\u01eb (*) which satisfy the conditions (3.20)\nexist if Vi\u01eb does not contain any nonzero constant function. Therefore, we assume\nthat\nm\nX\naj Zk\u01eb,s\n=c\ni ,j\nj=1\n\nfor some constants a1 , ..., am , c, for all s in [ti\u22121 , ti ], and for some i. We are going to\nshow that c must be zero and this finishes the proof of the lemma.\nThe above equation means that (Zk\u01eb,s\n, ..., Zk\u01eb,s\n) is contained in the affine space\ni ,1\ni ,m\nP\nm\nm\n{z \u2208 R | i=1 ai zi = c} for almost all s in the interval\nPm [ti\u22121 , ti ]. Therefore,\n\u01eb,s\nd\nd\nm\n( ds\nZk\u01eb,s\n,\n...,\nZ\n)\nis\ncontained\nin\nthe\nsubspace\n{z\n\u2208\nR\n|\ni=1 ai zi = 0} for each s\nds ki ,m\ni ,1\nin the interval [ti\u22121 , ti ]. Let us choose \u01eb0 such that \u03c4 + t\u01eb is contained in the interval\nI for each t in [0, T ] and for all \u01eb < \u01eb0 . Then it follows from the definition\nof the\nP\nd\nd\n\u01eb,s\na\nz\nZ1\u01eb,s (x0 ), ..., ds\nZm\n(x0 )) is contained in {z \u2208 Rm | m\ninterval I that ( ds\ni=1 i i = 0}\n\u01eb,s\n\u01eb,s\nfor almost all s in [0, T ]. Therefore, (Zki,1 (x0 ), ..., Zki ,m (x0 )) is contained in the affine\nP\n\u01eb,0\n\u01eb,0\nspace {z \u2208 Rm | m\ni=1 ai zi = c} for all s in [0, T ]. However, (Zki ,1 , ..., Zki ,m ) = 0, so\nc = 0 and this finishes the proof of the lemma.\n\u0003\nFor the rest of the proof, we write v(*) = w(*)+\u03b1\u01eb(*) and suppress the \u01eb-dependence\non v to avoid complicated notation.\n\nLemma 3.6.\nIk (v(*)) =\nas \u01eb \u2192 0.\n\nZ\n\nn\nX\n\n0\u2264s1 \u2264...\u2264sk \u2264T i ,...,i =1\n1\nk\n\nvi1 (s1 )...vik (sik )gi\u03c41 ...gi\u03c4k f (x0 )ds1 ...dsk + o(1)\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n13\n\nProof of Lemma 3.6. This follows immediately from the definition of G\u03c4,v . Indeed,\nIk (v(*))\nZ\n:=\n\n0\u2264s1 \u2264...\u2264sk \u2264T\n\n(3.21)\n\n=\n=\n\nG\u01eb\u03b2 s1 +\u03c4,v(s1 ) ...G\u01eb\u03b2 sk +\u03c4,v(sk ) f (x0 )ds1 ...dsk\nn\nX\n\nZ\n\n0\u2264s1 \u2264...\u2264sk \u2264T i ,...,i =1\n1\nk\nZ\nn\nX\n0\u2264s1 \u2264...\u2264sk \u2264T i ,...,i =1\n1\nk\n\nvi1 (s1 )...vik (sk )gi\u03c41+\u01eb\n\n\u03b2s\n\n1\n\n...gi\u03c4k+\u01eb\n\n\u03b2s\n\nk\n\nf (x0 )ds1 ...dsk\n\nvi1 (s1 )...vik (sik )gi\u03c41 ...gi\u03c4k f (x0 )ds1 ...dsk + o(1).\n\n\u0003\n\nIf we combine Lemma 3.5 and Lemma 3.6 with (3.17) and assume that 3\u03b2 \u2212 2\u03b1 >\nk(\u03b2 \u2212 \u03b1) > 0, then we have\n\u0012\nZ\n\u2212\n\u2192\nf exp\n\nT\n\nGs,v\u01eb (s) ds(x0 )\n\n0\n\n= f (x0 ) +\n\nk\nX\n\n\u0013\n\n\u01ebi(\u03b2\u2212\u03b1) Ii (w(*) + \u03b1\u01eb (*)) + O(\u01ebk(\u03b2\u2212\u03b1) )\n\ni=1\n\n= f (x0 ) +\n\nk\nX\n\nj(\u03b2\u2212\u03b1)\n\n\u01eb\n\nn\nX\n\nZ\n\n0\u2264s1 \u2264...\u2264sj \u2264T i ,...,i =1\n1\nj\n\nj=1\n\n+ o(\u01ebk(\u03b2\u22122\u03b1) )\n\nvi1 (s1 )...vij (sij )gi\u03c41 ...gi\u03c4j f (x0 )ds1 ...dsj\n\nas \u01eb \u2192 0.\nBy (3.16), the above becomes\n\u0012\nZ\n\u2212\n\u2192\nf exp\n\nT\n\nGs,v\u01eb (s) ds(x0 )\n\n0\n\n=f\n\n\u2212\n\u2192\nexp\n\nT\n\nZ\n\n\u01eb\u03b2\u2212\u03b1\n\n0\nk(\u03b2\u2212\u03b1)\n\n= f (x0 ) + \u01eb\n\nn\nX\n\n\u0013\n\n!\n\nvi (t)gi\u03c4 dt\n\n+ o(\u01ebk(\u03b2\u2212\u03b1) )\n\ni=1\n(ad\u03c4gi ...adgik\u22121 gik )f (x0 )\n1\n\n+ o(\u01ebk(\u03b2\u2212\u03b1) ).\n\n\f14\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nFinally, we need v \u01eb (*) converges to 0 in Lp . Indeed, by the definition of v \u01eb (*), we\nhave\n\u0013p\n\u0012\nZ T\nZ \u03c4 +\u01eb\u03b2\nt\u2212\u03c4\n\u01eb\np\n\u2212\u03b1\ndt\n|v (t)| dt =\n\u01eb v\n\u01eb\u03b2\n0\n\u03c4\nZ 1\n=\n|v (s)|p \u01eb\u03b2\u2212\u03b1p ds\n0\nZ 1\n=\n|w (s) + \u03b1\u01eb (s)|p \u01eb\u03b2\u2212\u03b1p ds.\n0\n\nSince w(*) is in L\u221e and \u03b1\u01eb (*) is in L2 , v \u01eb (*) converges to 0 in Lp if \u03b2 \u2212 \u03b1p > 0 and\np \u2264 2.\nIn conclusion, if we can choose \u03b1 and \u03b2 such that the following three conditions\nare satisfied, then the conclusion of the theorem holds.\n3\u03b2 \u2212 2\u03b1 > k(\u03b2 \u2212 \u03b1) > 0,\n\n\u03b2 \u2212 \u03b1p > 0,\n\np \u2264 2.\n\nIt is not hard to check that these inequalities are satisfied under the assumptions\nof the proposition.\n\u0003\nThe local controllability of the control system follows using Proposition 3.4 and\nimplicit function theorem as in the Chow-Rashevskii theorem. Finally, the continuity of the cost follows from the local controllability and standard arguments as in\n[5].\nProof of Theorem 3.2. Lower semi-continuity of the cost can be proved in the same\nway as in [5]. To prove upper semi-continuity, we let (x1 , y1, t1 ), (x2 , y2 , t2 ), ... be a\nsequence of points which converges to (x, y, T ) and limi\u2192\u221e cti (xi , yi ) = r. We want\nto show that cT (x, y) \u2265 r.\nAssume that this is not the case. Let u(*) and x(*) be a control and the trajectory associated to this control, respectively, such that x(0) = x, x(T ) = y and\nRT\nL(x(s), u(s))ds < r. Recall that the family of vector fields {g1t , ..., gnt |t \u2208 [0, T ]}\n0\nis k-generating. Therefore, we can find vector fields V1 , ..., Vk from the the set\no\nn\nadgit ...adgit 1 \u2264 ij \u2264 n, 0 \u2264 t \u2264 T, 0 \u2264 l \u2264 k .\n1\n\nl\n\nwhich span the tangent space Tx M. We also assume that Vi is defined by the Lie\nbrackets of \u03bai vector fields of the form gj\u03c4i . By perturbation, we can assume \u03c4i 6= \u03c4j\nfor i 6= j and that each \u03c4i satisfies the condition in Theorem 3.4. Therefore, by\nTheorem 3.4, there is a family of control wi,\u01eb (*) such that\nZ T\nT\n\u03bai (\u03b2\u2212\u03b1)\nVi f (x0 )ds + o(\u01eb\u03bai (\u03b2\u2212\u03b1) ).\nf (\u03a6 (wi,\u01eb (*), x0 )) = f (x0 ) + \u01eb\n0\n\nNote that from the proof of Proposition 3.4, we can assume that wi,\u01ebi is supported\nin a small interval Ji around \u03c4i by taking (\u01eb1 , ..., \u01ebn ) small enough. Moreover, we can\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n15\n\nassume that the intervals Ji are disjoint. We define the map \u03a8 : M \u00d7 Rn \u00d7 (0, \u221e) \u2192\nM by\n\u03a8(x, \u01eb1 , ..., \u01ebn , T ) = \u03a6T (w1,\u01eb1 /\u03ba1 (\u03b2\u2212\u03b1) ) \u25e6 \u03a6T (w2,\u01eb2 /\u03ba2 (\u03b2\u2212\u03b1) ) \u25e6 ... \u25e6 \u03a6T (wn,\u01ebn/\u03ban (\u03b2\u2212\u03b1) )(x).\nSince\n\nd\nd\u01ebi\n\n\u01ebi =0\n\n\u03a8 = Vi , the map \u03a8 is of full rank at the point (x, 0, ..., 0, T ). It\n\nfollows from implicit function theorem that there exists a map \u03c8 : U1 \u2192 U2\nfrom a neighborhood U1 of (x, y, T ) to a neighborhood U2 of (0, ..., 0) such that\n\u03a8(z1 , \u03c8(z1 , z2 , t), t) = z2 for all pairs (z1 , z2 , t) in the set U1 .\nLet (\u01ebi1 , ..., \u01ebin ) = \u03c8(xi , yi , ti ) and let v i (*) be the control defined by v i (t) = wj,\u01ebij (t)\nand 0 otherwise. v i (*) is well defined if (\u01ebi1 , ..., \u01ebin ) is close enough to (0, ..., 0). Let\nxi (*) be a curve in M which satisfies (1.2) with control v i (*). We know that v i (*)\nconverges strongly in Lp to 0 and xi (*) converges uniformly to x(*).\nAssume, without loss of generality, that u(t) = 0 for all t > T . Then\nZ\n\nti\n\ni\n\nL(x (s), u(s) + v (s))ds \u2212\n\nZ\n\nT\n\nL(x(s), u(s))ds\nZ ti\nZ ti\ni\ni\n\u2264\nL(x (s), u(s) + v (s))ds \u2212\nL(x(s), u(s) + v i (s))ds +\n0\n0\nZ \u03c4i\nZ \u03c4i\n+\nL(x(s), u(s) + v i (s))ds \u2212\nL(x(s), u(s))ds +\n0\n\n(3.22)\n\ni\n\n0\n\n+\n\n0\n\n0\n\nT\n\nZ\n\nmax{L(x(s), u(s) + vi (s)), L(x(s), u(s))}ds ,\n\nti\n\nwhere \u03c4i = min{T, ti }.\nSince L(x, u) \u2264 C2 |u|p + K2 , ti converges to T , and the sequence u(*) + v i (*)\nconverges to u(*) in Lp , we have\nZ\n\nT\n\nmax{L(x(s), u(s) + v i (s)), L(x(s), u(s))}ds\n\nti\n\n(3.23)\n\n\u2264\n\nZ\n\nT\n\nmax{C2 |u(s) + v i (s)|p \u2212 K2 , C2 |u(s)|p \u2212 K2 }ds\n\nti\n\n\u21920\nas i \u2192 \u221e.\nRecall that | \u2202L\n| \u2264 C3 |u|2, where the norm is taken with respect to certain Rie\u2202x\nmannian metric. Let d be the corresponding Riemannian distance function. Then\n\n\f16\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nwe have\nZ\n\nti\n\ni\n\ni\n\nL(x (s), u(s) + v (s))ds \u2212\n\n0\n\n(3.24)\n\nZ\n\nti\n\nL(x(s), u(s) + v i (s))ds\n\n0\n\nti\n\nZ\n\nL(xi (s), u(s) + v i (s))ds \u2212 L(x(s), u(s) + v i (s)) ds\n0\nZ ti\n2\ni\n\u2264 sup d(x (s), x(s))\nC3 u(s) + v i (s) ds\n\n\u2264\n\ns\n\n0\n\n\u21920\n\nas i \u2192 \u221e.\n\nBy construction of the control v i (*), we know that the indicator function I{t|vi (t)6=0}\nconverges to zero almost everywhere. It follows that\nZ \u03c4i\nZ \u03c4i\ni\nL(x(s), u(s) + v (s))ds \u2212\nL(x(s), u(s))ds\n0\n0\nZ \u03c4i\n(3.25)\n\u2264\nI{t|vi (t)6=0} ( L(x(s), u(s) + v i (s)) + |L(x(s), u(s))|)ds\n0\n\n\u2192 0\n\nas i \u2192 \u221e.\n\nTherefore, if we combine (3.22), (3.23), (3.24), and (3.25), then we have\nZ ti\nZ T\ni\ni\nlim\nL(x (s), u(s) + v (s))ds =\nL(x(s), u(s))ds < r.\ni\u2192\u221e\n\n0\n\n0\n\nOn the other hand,\nlim\n\ni\u2192\u221e\n\nZ\n\nti\n\nL(xi (s), u(s) + v i (s))ds \u2265 lim cti (xi , yi ) = r.\ni\u2192\u221e\n\n0\n\nTherefore, this gives a contradiction and we finish the proof of upper semicontinuity of the function (t, x, y) 7\u2192 ct (x, y).\n\u0003\n\n4. Optimal Control and Weak KAM Theorem\nIn this section, we give a proof of Theorem 1.3 using some ideas from [3] and [4].\nMore precisely, we will prove the following.\nTheorem 4.1. Assume that the function (t, x, y) 7\u2192 ct (x, y) defined by (1.3) is\ncontinuous and the manifold M is compact, then there exists a unique constant h\nsuch that the Hamilton-Jacobi-Bellman equation (1.1) has a viscosity solution.\nWe start the proof by introducing the Lax-Oleinik semigroup:\n(4.26)\n\nSt f (y) = inf [ct (x, y) + f (x)].\nx\u2208M\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n17\n\nTheorem 4.2. Assume that the function (t, x, y) 7\u2192 ct (x, y) defined by (1.3) is\ncontinuous. Then, for each function f , the function (t, x) 7\u2192 St f (x) is continuous\non (0, \u221e) \u00d7 M. Moreover, it is a viscosity solution to the Hamilton-Jacobi-Bellman\nequation \u2202t f + H(x, \u2202x f ) = 0 on (0, \u221e) \u00d7 M.\nProof. Continuity of the function St f follows immediately from that of ct and compactness of the manifold M. The fact that it is a viscosity solution follows as in\n[7].\n\u0003\nThe following theorem is a continuous version of [4, Lemma 9] and the proof is\nsimilar.\nTheorem 4.3. Assume that the function (t, x, y) 7\u2192 ct (x, y) is continuous and the\nmanifold M is compact. Then, for each a > 0, the family {ct |t \u2265 a} is equicontinuous. Moreover, there exists constants h and K such that\n|ct (x, y) \u2212 ht| \u2264 K\nfor all t \u2265 a and all x, y in M.\nProof. The function (t, x, y) 7\u2192 ct (x, y) is uniformly continuous on [a, b] \u00d7 M \u00d7 M\nfor some constants b > 2a > 0. So, given \u01eb > 0, there is a \u03b4 > 0 such that\n|c\u03c4 (x1 , y1 ) \u2212 c\u03c4 (x2 , y2 )| < \u01eb/2\nwhenever d(x1 , x2 ) < \u03b4, d(y1 , y2) < \u03b4 and a < \u03c4 < b.\nAssume that t \u2265 a. Since b > 2a, there is a partition 0 = t0 \u2264 t1 \u2264 t2 \u2264 ... \u2264 tl = t\nsuch that a < ti+1 \u2212 ti < b. Assume that ct (x1 , y1 ) \u2265 ct (x2 , y2) and let x2 =\nP\nz0 , z1 , ..., zl = y2 be points on the manifold M such that ct (x2 , y2) = li=1 cti (zi\u22121 , zi ).\nThen we have\nct (x1 , y1) \u2212 ct (x2 , y2)\n\u2264 ct1 \u2212t0 (x1 , z1 ) \u2212 ct1 \u2212t0 (x2 , z1 ) + ctl \u2212tl\u22121 (zl\u22121 , y1 ) \u2212 ctl \u2212tl\u22121 (zl\u22121 , y2)\n<\u01eb\nwhenever d(x1 , x2 ) < \u03b4 and d(y1 , y2 ) < \u03b4. It follows that {ct |t \u2265 a} is an equicontinuous family.\nLet Mt = supx,y ct (x, y) and mt = inf x,y ct (x, y), where the supremum and the\ninfimum are taken over all pairs of points of the manifold M. Let t1 and t2 be two\npositive numbers and let z be a point on the manifold M such that ct1 +t2 (x, y) =\nct1 (x, z) + ct2 (z, y). It follows from this Mt1 +t2 \u2264 Mt1 + Mt2 . Similarly, mt satisfies\nmt1 +t2 \u2265 mt1 + mt2 . It follows that the infimum of the function Mt t is finite. Indeed,\nm\nm\nif the infimum of Mt t is \u2212\u221e, then so is mt t . But note that ktkt00 \u2265 t0t0 for all positive\ninteger k. This gives a contradiction. It follows that M := inf t Mt t is finite. Given\nM\n\u01eb > 0, we find t0 such that t0t0 < M + \u01eb. Every t > t0 can be decompose into\nt = kt0 + s, where t0 \u2264 s \u2264 2t0 . It follows that\nMt\nkMt0 + Ms\nMt0 kt0\nMs\nkt0\nMs\nM\u2264\n\u2264\n=\n+\n< (M + \u01eb)\n+\n.\nt\nt\nt0 kt0 + s\nt\nkt0 + s\nt\n\n\f18\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nBy continuity of the cost c, we know that Ms is bounded. It follows that from this\nand the above inequality that\nMt\nlim\n= M.\nt\u2192\u221e t\nSimilarly, we also have\nmt\nlim\n= m.\nt\u2192\u221e t\nFinally, it follows from equicontinuity of the family {ct |t \u2265 a} that Mt \u2212 mt \u2264 C for\nsome constant C and for all t \u2265 a. Therefore, h := M = m.\n\u0003\nLemma 4.4. Assume that the function (t, x, y) 7\u2192 ct (x, y) is continuous and the\nmanifold M is compact. Let f be a bounded function, then the family S := {St f \u2212\nht|t \u2265 a} is uniformly bounded and equicontinuous.\nProof. According to Lemma 4.3, the family {ct |t \u2265 a} is equicontinuous. So, for\neach \u01eb > 0, there is a \u03b4 > 0 such that for all t \u2265 a\n|ct (x1 , y1 ) \u2212 ct (x2 , y2 )| < \u01eb/2\nwhenever d(x1 , x2 ) < \u03b4 and d(y1, y2 ) < \u03b4.\nBy definition of St f , we can find, for each \u01eb > 0, a point zt such that\nSt f (x2 ) > ct (zt , x2 ) + f (zt ) \u2212 \u01eb/2.\nIt follows that\nSt f (x1 ) \u2212 St f (x2 ) < ct (zt , x1 ) + f (zt ) \u2212 ct (zt , x2 ) \u2212 f (zt ) + \u01eb/2 < \u01eb.\nSince the above equation holds for all \u01eb and all t \u2265 a, we conclude that the family\nS is equicontinuous.\nFix a point x in M. For each \u01eb > 0, let z be a point in M such that\nct (z, x) + f (z) \u2265 St f (x) > ct (z, x) + f (z) \u2212 \u01eb.\nTherefore, by Theorem 4.3, we have\nK + sup {f (y)} \u2265 St f (x) \u2212 ht > \u2212K + inf {f (y)} \u2212 \u01eb\ny\u2208M\n\ny\u2208M\n\nfor some constant K > 0. We conclude from this that S is uniformly bounded.\n\n\u0003\n\nDefine the function f \u0304 by\nf \u0304(x) = inf [St f (x) \u2212 ht].\nt\u2265a\n\nIt follows from Lemma 4.4 that f \u0304 is bounded. The following theorem taken from [9]\ntogether with Theorem 4.2 and Lemma 4.4 finish the proof of the existence part of\nTheorem 4.1. We give a sketch of the proof here.\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n19\n\nTheorem 4.5. Assume that there exists a constant h such that the family S :=\n{St f \u2212 ht|t \u2265 a} is uniformly bounded and equicontinuous, then St f \u0304 \u2212 ht converges\nuniformly to a function f \u0303. Moreover, it satisfies\nSt f \u0303 \u2212 ht = f \u0303.\nProof. By applying St to the definition of f \u0304, it is not hard to see that St f \u0304 \u2212 ht \u2265 f \u0304.\nSince St is order preserving, we can apply St again to this inequality to shows that\nt 7\u2192 St f \u0304(x) \u2212 ht is increasing for each x in M. It follows from this and Lemma 4.4\nthat St f \u0304(x) \u2212 ht converges uniformly to a continuous function f \u0303. We apply once\nagain St to the definition of f \u0303 and use the continuity of the semigroup St , we get\nSt f \u0303 \u2212 kt = f \u0303.\n\u0003\nFinally, we finish the uniqueness of the constant h as a corollary of Theorem 4.3.\nCorollary 4.6. Assume that the function (t, x, y) 7\u2192 ct (x, y) is continuous and the\nmanifold M is compact. Let h be as in Theorem 4.3 and let f be a function which\nsatisfies St f \u2212 kt = f for some number k, then k = h.\nProof. For each natural number n, let zn be points in M which satisfies\ncn (zn , x) + f (zn ) \u2265 f (x) + kn = Sn f (x) \u2265 cn (zn , x) + f (zn ) \u2212\n\n1\n.\nn\n\nNote that the function f is continuous and lim cn (znn ,x) = h. It follows that if\nn\u2192\u221e\nwe divide the above inequality by n and let n goes to infinity, we get k = h as\nclaimed.\n\u0003\n\n5. Optimal Transportation and Weak KAM Theorem\nLet \u03bc and \u03bd be two Borel probability measures. Consider the cost function defined\nin (1.3) and the following Monge-Kantorovich problem of optimal transportation:\n(5.27)\n\nCT (\u03bc, \u03bd) = inf\n\u03a0\n\nZ\n\ncT (x, y)d\u03a0(x, y)\n\nM \u00d7M\n\nwhere the infimum is taken over all measures on M \u00d7 M with marginals \u03bc and \u03bd.\nThat is, if \u03c01 , \u03c02 : M \u00d7 M \u2192 M are the projections onto the first and second entries,\nthen \u03c01\u2217 \u03a0 = \u03bc and \u03c02\u2217 \u03a0 = \u03bd.\nThe above problem (5.27) admits a dual version given by\nZ\nZ\n(5.28)\nIT (\u03bc, \u03bd) = sup\ng(x)d\u03bd(x) \u2212\nf (x)\u03bc(x),\nM\n\nM\n\nwhere the supremum is taken over all pairs of functions (f, g) which satisfy g(y) \u2212\nf (x) \u2264 cT (x, y).\nThe following theorem is the well known result in [11]. See also [14, 15].\n\n\f20\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nTheorem 5.1. Assume that the function cT is continuous, then the infimum in\n(5.27) and the supremum in (5.28) is achieved. Moreover, for any optimal measure\n\u03a0 of (5.27) and any pair of functions (f, g) that maximizes (5.28), we have that \u03a0\nis concentrated on the set {(x, y) \u2208 M \u00d7 M|g(y) \u2212 f (x) = cT (x, y)} and CT (\u03bc, \u03bd) =\nIT (\u03bc, \u03bd).\nNote that if (f, g) maximizes (5.28), then so is (f, ST f ). We define\n(5.29)\n\n\u03b1T := inf\n\u03bc\n\n1\nCT (\u03bc, \u03bc),\nT\n\nwhere the infimum is taken over all Borel probability measures on M.\nThe following lemma can be proved in same way as in [3, Lemma 33].\nLemma 5.2. There exists a measure \u03bc which achieves the infimum in (5.29).\nThe next theorem is a generalization of a result [3] which gives another characterization of the number h in Theorem 1.3.\nTheorem 5.3. Under the assumptions in Theorem 1.3, we have \u03b1T = h for each\nT > 0.\nFollowing [4], we call measures \u03a0 on the space M \u00d7M generalized Mather measure\nif \u03c01\u2217 \u03a0 = \u03c02\u2217 \u03a0 and\nZ\n1\ncT (x, y)d\u03a0(x, y) = h.\nT M \u00d7M\n\nThe following corollary describes the support of the generalized Mather measures.\n\nCorollary 5.4. Suppose that we make the same assumptions as in Theorem 1.3 and\nlet g be a function which satisfies St g = g + ht. If \u03a0 is a generalized Mather measure\nwhich satisfies\nZ\n1\ncT (x, y)d\u03a0(x, y) = h,\nT M \u00d7M\nthen the support of \u03a0 is contained in the set\n\n{(x, y)|cT (x, y) = g(y) \u2212 g(x) + hT }.\nProof. Let \u03bc = \u03c01\u2217 \u03a0 = \u03c02\u2217 \u03a0. Then\nZ\nZ\nCT (\u03bc, \u03bc) = hT =\nST gd\u03bc \u2212\ngd\u03bc \u2264 IT (\u03bc, \u03bc) = CT (\u03bc, \u03bc).\nM\n\nM\n\nIt follows that the support of \u03a0 is contained in\n{(x, y)|cT (x, y) = ST g(y) \u2212 g(x)}.\n\u0003\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n21\n\nProof of Theorem 5.3. Let g be a function which satisfies St g = g + ht and let \u03bc be\na minimizer corresponding to the minimization problem of \u03b1T in (5.29). It follows\nfrom Theorem 5.1 that\nZ\nZ\n(5.30)\n\nT \u03b1T = CT (\u03bc, \u03bc) = IT (\u03bc, \u03bc) \u2265\n\nST gd\u03bc \u2212\n\nM\n\ngd\u03bc = hT\n\nM\n\nfor all T > 0.\nFor the proof of the following lemma, we follow closely [4, Lemma 7].\n\nLemma 5.5. Let \u03bd1 and \u03bd2 be two Borel probability measures and let 0 \u2264 s \u2264 T ,\nthen there exists a Borel probability measure \u03bd such that\nCT (\u03bd1 , \u03bd2 ) = Cs (\u03bd1 , \u03bd) + CT \u2212s (\u03bd, \u03bd2 ).\nRProof. By Theorem 5.1, we can find measures\nR \u03a01 , \u03a02 on M \u00d7M such that Cs (\u03bd1 , \u03bd) =\nc (x, y)d\u03a01 (x, y) and CT \u2212s (\u03bd, \u03bd2 ) = M \u00d7M cT \u2212s (x, y)d\u03a02(x, y). By disintegraM \u00d7M s\ntion of measures, there are measures \u03bcy1 and \u03bcx2 such that d\u03a01 (x, y) = d\u03bcy1 (x)d\u03bd(y)\nand d\u03a02 (x, y) = d\u03bcx2 (y)d\u03bd(x). Let \u03bc be the measure defined by\nZ\nZ\nf (x, y)d\u03a0(x, y) =\nf (x, y)d\u03bcz1(x)d\u03bcz2 (y)d\u03bd(z).\nM \u00d7M\n\nM \u00d7M \u00d7M\n\nIt is not hard to check that the marginals of \u03a0 are \u03bd1 and \u03bd2 . Therefore, we get\nZ\nCT (\u03bd1 , \u03bd2 ) \u2264\ncT (x, y)d\u03a0(x, y)\nM \u00d7M\nZ\n\u2264\ncs (x, z) + cT \u2212s (z, y)d\u03bcz1(x)d\u03bcz2 (y)d\u03bd(z)\nZM \u00d7M \u00d7M\nZ\n=\ncs (x, z)d\u03a01 (x, z) +\ncT \u2212s (z, y)d\u03a02 (z, y)\nM \u00d7M\n\nM \u00d7M\n\n= Cs (\u03bd1 , \u03bd) + CT \u2212s (\u03bd, \u03bd2 ).\n\nLet P be the set of pairs of Borel probability measures (\u03bd1 , \u03bd2 ) which satisfies the\nconclusion of the lemma. It is not hard to see that (\u03b4x , \u03b4y ) is contained in P, where\n\u03b4x is the Dirac mass at x. Indeed, let x(*) : [0, T ] \u2192 M be an admissible path which\nsatisfy x(0) = x, x(T ) = y and achieve the infimum in (1.3). Then,\n(5.31)\n\nCs (\u03b4x , \u03b4x(s) ) + CT \u2212s (\u03b4x(s) , \u03b4y ) = cs (x, x(s)) + cT \u2212s (x(s), y)\n= cT (x, y) = CT (\u03b4x , \u03b4y ).\n\nTo finish the proof, it remains to notice that the set P is convex and weak-\u2217\nclosed. Therefore, the result follows from approximation by delta masses.\n\u0003\nNow let \u03bd be a measure which satisfies CN T (\u03bd, \u03bd) = \u03b1N T . It follows from Lemma\n5.5 that there exists Borel probability measures \u03bd = \u03bc0 , \u03bc1 , ..., \u03bcN = \u03bd such that\nCN T (\u03bd, \u03bd) =\n\nN\nX\ni=1\n\nCT (\u03bci\u22121 , \u03bci ).\n\n\f22\n\nANDREI AGRACHEV AND PAUL W.Y. LEE\n\nSince IT is convex and so is CT . Therefore,\n1\n1\nCN T (\u03bd, \u03bd) \u2265 CT (\u03bc\u0303, \u03bc\u0303) \u2265 \u03b1T \u2265 h,\nNT\nT\nP\nwhere \u03bc\u0303 = N1 N\ni=1 \u03bci .\nFinally, it follows from Theorem 4.3 that lim\n\n1\nN \u2192\u221e N T\n\nthe proof.\n\nCN T (\u03bd, \u03bd) = h. This finishes\n\u0003\n\nReferences\n[1] A. A. Agrachev, Y. L. Sachkov: Control Theory from the Geometric Viewpoint, Springer,\n2004\n[2] P. Brunovsk\u00fd, C. Lobry: Controllabilit\u00e9 Bang-Bang, controllabilit\u00e9 diff\u00e9rentiable, et perturbation des syst\u00e8mes nonlin\u00e9aires. Ann. Mat. Pura Appl., 1975, v.105, 93-119\n[3] P. Bernard, B. Buffoni: Optimal mass transportation and Mather theory, J. Eur. Math. Soc.\n(JEMS) 9 (2007), no. 1, 85\u2013121\n[4] P. Bernard, B. Buffoni: Weak KAM pairs and Monge-Kantorovich duality. Asymptotic analysis and singularities - elliptic and parabolic PDEs and related problems, 397-420, Adv. Stud.\nPure Math., 47-2, Math. Soc. Japan, Tokyo, 2007\n[5] P. Cannarsa, L. Rifford: Semiconcavity results for optimal control problems admitting no\nsingular minimizing controls, Ann. Inst. H. Poincar\u00e9 Anal. Non Lin\u00e9aire, 25(4):773-802, 2008\n[6] P. Cannarsa, C. Sinestrari: Semiconcave functions, Hamilton-Jacobi equations, and optimal\ncontrol, Birkh\u00e4user, Boston, 2004.\n[7] L. C. Evans: Partial differential equations. Graduate Studies in Mathematics, 19. American\nMathematical Society, Providence, RI, 1998\n[8] A. Fathi: Th\u00e9orm\u0300e KAM faible et the\u00e9orie de Mather sur les syst\u00e8mes lagrangiens, C. R.\nAcad. Sci. Paris S\u00e9r. I Math., 324(9): 1043-1046, 1997\n[9] A. Fathi: The Weak KAM Theorem in Lagrangian Dynamics, 10th prelimiary version\n[10] D. Gomes: Hamilton-Jacobi methods for vakonomic mechanics, NoDEA Nonlinear Differential Equations Appl. 14 (2007), no. 3-4, 233\u2013257.\n[11] L. Kantorovich: On the translocation of masses, C.R. (Doklady) Acad. Sci. URSS(N.S.), 37,\n1942, 199-201\n[12] P-L Lions, G. Papanicolaou, S.R.S. Varadhan: Homogenization of Hamilton-Jacobi equation,\nunpublished preprint, 1987.\n[13] R. Montgomery: A tour of subriemannian geometries, their geodesics and applications. Mathematical Surveys and Monographs, 91. American Mathematical Society, Providence, RI, 2002\n[14] C. Villani: Topics in Mass Transportation, AMS, Providence, Rhode Island, 2003\n[15] C. Villani: Optimal Transport: old and new, Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences], 338. Springer-Verlag, Berlin,\n2009\nE-mail address: agrachev@sissa.it\nInternational School for Advanced Studies via Beirut 4 - 34014, Trieste, Italy\nand Steklov Mathematical Institute, ul. Gubkina 8, Moscow, 119991 Russia\nE-mail address: plee@math.berkeley.edu\n\n\fCONTINUITY OF OPTIMAL CONTROL COST AND WEAK KAM THEORY\n\n23\n\nDepartment of Mathematics, University of California at Berkeley, 970 Evans\nHall #3840 Berkeley, CA 94720-3840 USA\n\n\f"}