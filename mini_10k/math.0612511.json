{"id": "http://arxiv.org/abs/math/0612511v2", "guidislink": true, "updated": "2008-02-08T15:02:21Z", "updated_parsed": [2008, 2, 8, 15, 2, 21, 4, 39, 0], "published": "2006-12-18T13:09:03Z", "published_parsed": [2006, 12, 18, 13, 9, 3, 0, 352, 0], "title": "Functional equations for zeta functions of groups and rings", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0612630%2Cmath%2F0612417%2Cmath%2F0612539%2Cmath%2F0612429%2Cmath%2F0612052%2Cmath%2F0612022%2Cmath%2F0612006%2Cmath%2F0612657%2Cmath%2F0612708%2Cmath%2F0612594%2Cmath%2F0612169%2Cmath%2F0612680%2Cmath%2F0612591%2Cmath%2F0612634%2Cmath%2F0612485%2Cmath%2F0612575%2Cmath%2F0612066%2Cmath%2F0612342%2Cmath%2F0612445%2Cmath%2F0612733%2Cmath%2F0612801%2Cmath%2F0612752%2Cmath%2F0612862%2Cmath%2F0612667%2Cmath%2F0612057%2Cmath%2F0612302%2Cmath%2F0612053%2Cmath%2F0612493%2Cmath%2F0612447%2Cmath%2F0612477%2Cmath%2F0612122%2Cmath%2F0612305%2Cmath%2F0612324%2Cmath%2F0612175%2Cmath%2F0612035%2Cmath%2F0612779%2Cmath%2F0612585%2Cmath%2F0612616%2Cmath%2F0612762%2Cmath%2F0612772%2Cmath%2F0612432%2Cmath%2F0612789%2Cmath%2F0612520%2Cmath%2F0612827%2Cmath%2F0612852%2Cmath%2F0612552%2Cmath%2F0612532%2Cmath%2F0612196%2Cmath%2F0612646%2Cmath%2F0612506%2Cmath%2F0612809%2Cmath%2F0612715%2Cmath%2F0612422%2Cmath%2F0612791%2Cmath%2F0612692%2Cmath%2F0612838%2Cmath%2F0612389%2Cmath%2F0612322%2Cmath%2F0612524%2Cmath%2F0612511%2Cmath%2F0612386%2Cmath%2F0612799%2Cmath%2F0612749%2Cmath%2F0612834%2Cmath%2F0612304%2Cmath%2F0612162%2Cmath%2F0612857%2Cmath%2F0612362%2Cmath%2F0612556%2Cmath%2F0612135%2Cmath%2F0612178%2Cmath%2F0612675%2Cmath%2F0612225%2Cmath%2F0612574%2Cmath%2F0612377%2Cmath%2F0612277%2Cmath%2F0612019%2Cmath%2F0612363%2Cmath%2F0612014%2Cmath%2F0612670%2Cmath%2F0612111%2Cmath%2F0612046%2Cmath%2F0612320%2Cmath%2F0612771%2Cmath%2F0612759%2Cmath%2F0612668%2Cmath%2F0612755%2Cmath%2F0612098%2Cmath%2F0612248%2Cmath%2F0612618%2Cmath%2F0612375%2Cmath%2F0612156%2Cmath%2F0612346%2Cmath%2F0612458%2Cmath%2F0612562%2Cmath%2F0612224%2Cmath%2F0612565%2Cmath%2F0612571%2Cmath%2F0612177%2Cmath%2F0612348%2Cmath%2F0612382&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Functional equations for zeta functions of groups and rings"}, "summary": "We introduce a new method to compute explicit formulae for various zeta\nfunctions associated to groups and rings. The specific form of these formulae\nenables us to deduce local functional equations. More precisely, we prove local\nfunctional equations for the subring zeta functions associated to rings, the\nsubgroup, conjugacy and representation zeta functions of finitely generated,\ntorsion-free nilpotent (or $\\T$-)groups, and the normal zeta functions of\n$\\T$-groups of class 2. In particular we solve the two problems posed in\n\\cite[Section 5]{duSG/06}. We deduce our theorems from a `blueprint result' on\ncertain $p$-adic integrals which generalises work of Denef and others on\nIgusa's local zeta function. The Malcev correspondence and a Kirillov-type\ntheory developed by Howe are used to `linearise' the problems of counting\nsubgroups and representations in $\\T$-groups, respectively.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0612630%2Cmath%2F0612417%2Cmath%2F0612539%2Cmath%2F0612429%2Cmath%2F0612052%2Cmath%2F0612022%2Cmath%2F0612006%2Cmath%2F0612657%2Cmath%2F0612708%2Cmath%2F0612594%2Cmath%2F0612169%2Cmath%2F0612680%2Cmath%2F0612591%2Cmath%2F0612634%2Cmath%2F0612485%2Cmath%2F0612575%2Cmath%2F0612066%2Cmath%2F0612342%2Cmath%2F0612445%2Cmath%2F0612733%2Cmath%2F0612801%2Cmath%2F0612752%2Cmath%2F0612862%2Cmath%2F0612667%2Cmath%2F0612057%2Cmath%2F0612302%2Cmath%2F0612053%2Cmath%2F0612493%2Cmath%2F0612447%2Cmath%2F0612477%2Cmath%2F0612122%2Cmath%2F0612305%2Cmath%2F0612324%2Cmath%2F0612175%2Cmath%2F0612035%2Cmath%2F0612779%2Cmath%2F0612585%2Cmath%2F0612616%2Cmath%2F0612762%2Cmath%2F0612772%2Cmath%2F0612432%2Cmath%2F0612789%2Cmath%2F0612520%2Cmath%2F0612827%2Cmath%2F0612852%2Cmath%2F0612552%2Cmath%2F0612532%2Cmath%2F0612196%2Cmath%2F0612646%2Cmath%2F0612506%2Cmath%2F0612809%2Cmath%2F0612715%2Cmath%2F0612422%2Cmath%2F0612791%2Cmath%2F0612692%2Cmath%2F0612838%2Cmath%2F0612389%2Cmath%2F0612322%2Cmath%2F0612524%2Cmath%2F0612511%2Cmath%2F0612386%2Cmath%2F0612799%2Cmath%2F0612749%2Cmath%2F0612834%2Cmath%2F0612304%2Cmath%2F0612162%2Cmath%2F0612857%2Cmath%2F0612362%2Cmath%2F0612556%2Cmath%2F0612135%2Cmath%2F0612178%2Cmath%2F0612675%2Cmath%2F0612225%2Cmath%2F0612574%2Cmath%2F0612377%2Cmath%2F0612277%2Cmath%2F0612019%2Cmath%2F0612363%2Cmath%2F0612014%2Cmath%2F0612670%2Cmath%2F0612111%2Cmath%2F0612046%2Cmath%2F0612320%2Cmath%2F0612771%2Cmath%2F0612759%2Cmath%2F0612668%2Cmath%2F0612755%2Cmath%2F0612098%2Cmath%2F0612248%2Cmath%2F0612618%2Cmath%2F0612375%2Cmath%2F0612156%2Cmath%2F0612346%2Cmath%2F0612458%2Cmath%2F0612562%2Cmath%2F0612224%2Cmath%2F0612565%2Cmath%2F0612571%2Cmath%2F0612177%2Cmath%2F0612348%2Cmath%2F0612382&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We introduce a new method to compute explicit formulae for various zeta\nfunctions associated to groups and rings. The specific form of these formulae\nenables us to deduce local functional equations. More precisely, we prove local\nfunctional equations for the subring zeta functions associated to rings, the\nsubgroup, conjugacy and representation zeta functions of finitely generated,\ntorsion-free nilpotent (or $\\T$-)groups, and the normal zeta functions of\n$\\T$-groups of class 2. In particular we solve the two problems posed in\n\\cite[Section 5]{duSG/06}. We deduce our theorems from a `blueprint result' on\ncertain $p$-adic integrals which generalises work of Denef and others on\nIgusa's local zeta function. The Malcev correspondence and a Kirillov-type\ntheory developed by Howe are used to `linearise' the problems of counting\nsubgroups and representations in $\\T$-groups, respectively."}, "authors": ["Christopher Voll"], "author_detail": {"name": "Christopher Voll"}, "author": "Christopher Voll", "arxiv_comment": "37 pages, revised version, to appear in Ann. of Math", "links": [{"href": "http://arxiv.org/abs/math/0612511v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0612511v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.GR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.GR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11M41, 20E07, 11S40", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0612511v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0612511v2", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0612511v2 [math.GR] 8 Feb 2008\n\nFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS\nOF GROUPS AND RINGS\nCHRISTOPHER VOLL\nAbstract. We introduce a new method to compute explicit formulae for\nvarious zeta functions associated to groups and rings. The specific form\nof these formulae enables us to deduce local functional equations. More\nprecisely, we prove local functional equations for the subring zeta functions associated to rings, the subgroup, conjugacy and representation zeta\nfunctions of finitely generated, torsion-free nilpotent (or T -)groups, and\nthe normal zeta functions of T -groups of class 2. In particular we solve\nthe two problems posed in [9, Section 5]. We deduce our theorems from\na 'blueprint result' on certain p-adic integrals which generalises work of\nDenef and others on Igusa's local zeta function. The Malcev correspondence and a Kirillov-type theory developed by Howe are used to 'linearise'\nthe problems of counting subgroups and representations in T -groups, respectively.\n\n1. Introduction\nZeta functions of groups were introduced by Grunewald, Segal and Smith\nin the 1980s as a tool to study the subgroup growth of finitely generated\ngroups. In [14] the zeta function of a finitely generated group G was defined\nas the Dirichlet series\nX\n(1)\n\u03b6G (s) =\n|G : H|\u2212s ,\nH\u2264G\n\nwhere s is a complex variable and the sum ranges over the finite index subgroups of G. Grunewald, Segal and Smith derived results on the zeta functions of finitely generated, torsion-free nilpotent (or T -)groups G, and went\non to consider variants of (1). These include a T -group's normal zeta function counting only normal subgroups of finite index, and the conjugacy zeta\nfunction counting subgroups up to conjugacy. They also developed an analogous theory for rings. (In the current paper, by a ring we mean a finitely\ngenerated abelian group with a bi-additive product.) The ideal zeta function\nof a ring, for instance, generalises the classical Dedekind zeta function of a\nnumber field. Much of the subsequent developments in the theory of zeta\nDate: October 9, 2018.\n2000 Mathematics Subject Classification. 11M41, 20E07, 11S40.\nKey words and phrases. Subgroup growth, representation growth, nilpotent groups,\nIgusa's local zeta function, p-adic integration, local functional equations, Kirillov theory.\n1\n\n\f2\n\nCHRISTOPHER VOLL\n\nfunctions of groups and rings is documented in the monograph [24] and in\nthe report [9].\nOnly comparatively recently, Hrushovski and Martin ([17]) started to investigate representation zeta functions of T -groups, enumerating (twist-isoclasses\nof) finite-dimensional complex characters.\nAll the zeta functions mentioned so far have the property that they satisfy\nan Euler product decomposition into local factors, indexed by the primes. For\nexample, for a T -group G we have\nY\n\u03b6G (s) =\n\u03b6G,p (s),\np prime\n\nP\n\n\u2212s enumerates finite p-power index subwhere \u03b6G,p (s) =\nH\u2264p G |G : H|\ngroups. All these local zeta functions are known to be rational functions\nin the parameter p\u2212s with integer coefficients ([14], [17]). In many cases they\nexhibit a remarkable symmetry: For instance, it had been observed (cf., e.g.,\n[9]) that the local factors of all zeta functions of T -groups G for which explicit\nformulae are known satisfy a local functional equation of the form\n\n\u03b6G,p (s)|p\u2192p\u22121 = (\u22121)a pb\u2212cs \u03b6G,p (s),\n\n(2)\n\nfor almost all primes p and suitable integers a, b, c depending only on the\nHirsch length of G. Here p \u2192 p\u22121 denotes a formal inversion of the local\nparameter p, which we shall now explain.\nThe prime example is the case of G = Zn . It is known from [14, Proposition\n1.1] that\nn\u22121\nY\n\u03b6(s \u2212 i),\n\u03b6G (s) =\n\nwhere \u03b6(s) =\nequation\n\nQ\n\ni=0\n\n1\np prime 1\u2212p\u2212s\n\nn\u22121\nY\ni=0\n\nis the Riemann zeta function. The functional\n\nn\u22121\nY\n1\n1\n\u2212ns\nn (n\n)\n2\n=\n(\u22121)\np\n\u2212(i\u2212s)\n1 \u2212 pi\u2212s\n1\u2212p\ni=0\n\nof the local factor at the prime p is easily seen to hold for all primes. Here, as\nwell as in all other cases in which explicit formulae are known to date, the local\nzeta functions \u03b6G,p (s) are in fact rational functions in p\u2212s and p, and the left\nhand side of (2) denotes the rational function obtained by formally inverting\nboth of these two parameters. This 'uniformity' in the prime p, however, is not\ntypical: Results of du Sautoy and Grunewald ([8]) show that the dependence\nof the local (normal) zeta functions of T -groups on the primes will, in general,\nreflect the variation of the number of Fp -points of certain algebraic varieties\ndefined over Fp , which may be far from polynomial in the prime p (see also [6]\nand [7]). In [31] we produced examples of normal zeta functions of T -groups of\nnilpotency class 2 (or T2 -groups) which exhibit functional equations similar\nto (2) and which are not uniform. Indeed, the local factors of these zeta\nfunctions are rational functions in p\u2212s , whose coefficients involve the numbers\nbV (p) of Fp -rational points of certain smooth projective varieties V over Fp\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n3\n\nwhich are, in general, not polynomials in p. By the Weil conjectures, these\nnumbers may be expressed as alternating sums of Frobenius eigenvalues. The\noperation p \u2192 p\u22121 is performed by inverting these eigenvalues. In the special\n('uniform') case that the bV (p) are in fact polynomials in p, this specialises\nto an inversion of the prime p.\nOnly a single example of a representation zeta function of a T -group seems\nto have appeared in print so far: In [17] Hrushovski and Martin derive a\nformula for the representation zeta function of the discrete Heisenberg group\nin terms of the Riemann zeta function and its inverse (cf. Example 1.2).\nAccording to du Sautoy and Segal, to find an explanation for the phenomenon of local functional equations for zeta functions of groups and rings is\n\"one of the most intriguing open problems in this area\" ([11, p. 274]). In the\ncurrent paper we prove that local functional equations hold for (almost all\nfactors of) the following zeta functions:\n(A)\n(B)\n(C)\n(D)\n\nzeta functions of rings (and, as a corollary, of T -groups),\nconjugacy zeta functions of T -groups,\nnormal zeta functions of T2 -groups and\nrepresentation zeta functions of T -groups.\n\nBy proving (A) and (C) we solve Problems 5.1 and 5.2 posed in [9]. In\nits given generality, (C) is best possible: It is known that the normal zeta\nfunctions of nilpotent groups of class 3 may or may not satisfy local functional\nequations (cf. [13]). To determine the exact scope of this intriguing symmetry\nfor ideal zeta functions of rings remains a challenging open problem.\nWe achieve our results by showing that all of the above-mentioned zeta\nfunctions may be expressed in terms of certain p-adic integrals, generalising Igusa's local zeta function. Given a non-constant polynomial f (y) \u2208\nZ[y1 , . . . , ym ], its associated Igusa local zeta function is the p-adic integral\nZ\n|f (y)|s |dy|,\nZm\np\n\nwhere s is a complex variable, | | stands for the p-adic absolute value and\n|dy| denotes the (additive) Haar measure on Zm\np , the affine m-space over the\np-adic integers Zp . This p-adic integral is closely related to the Poincar\u00e9 series\ncounting p-adic points on the hypersurface defined by f (cf. [4]). We prove\nfunctional equations for these integrals by generalising results by Denef and\nothers on Igusa's local zeta function.\nThe integrals considered in the present paper are quite different from the\n'cone integrals' introduced by du Sautoy and Grunewald in [8] (see Section 1.2\nfor further details).\n1.1. Detailed statement of results. Let L be a ring. Its (subring) zeta\nfunction is defined to be the Dirichlet series\nX\n\u03b6L (s) =\n|L : H|\u2212s ,\nH\u2264L\n\n\f4\n\nCHRISTOPHER VOLL\n\nwhere the sum ranges over all subrings H of finite index in L, and s is\na complex variable. This zeta function decomposes naturally as an Euler\nproduct, indexed by the primes:\nY\n\u03b6L (s) =\n\u03b6L,p (s),\np prime\n\nwhere \u03b6L,p (s) = \u03b6L\u2297Zp (s). Grunewald, Segal and Smith proved in [14] that\neach local factor is a rational function in p\u2212s with integral coefficients. Our\nfirst main Theorem is\nTheorem A. Let L be a ring of torsion-free rank n. Then there are smooth\nprojective varieties Vt , t \u2208 {1, . . . , m}, defined over Q, and rational functions\nWt (X, Y ) \u2208 Q(X, Y ) such that for almost all primes p the following hold.\n(a) Denoting by bt (p) the number of Fp -rational points of Vt , the reduction\nmod p of Vt , we have\n(3)\n\n\u03b6L,p (s) =\n\nm\nX\n\nbt (p)Wt (p, p\u2212s ).\n\nt=1\n\n(b) Setting bt (p\u22121 ) := p\u2212 dim(Vt ) bt (p) the following functional equation\nholds:\n(4)\n\nn\n\n\u03b6L,p (s)|p\u2192p\u22121 = (\u22121)n p( 2 )\u2212ns \u03b6L,p (s).\n\nThe novelty of this result is that it allows us to deduce the equations (4).\nIn [8], du Sautoy and Grunewald gave formulae akin to (3) for, inter alia,\nthe local factors of \u03b6L (s). Their proof depends on a representation of local\nzeta functions through certain p-adic integrals called 'cone integrals' which\nin general will not satisfy functional equations like (4). See [13, Chapter 4]\nfor a discussion of functional equations for cone integrals.\nGiven a ring L we cannot, in general, pin down the primes p which have to\nbe excluded in Theorem A. On the other hand, any prime p will be among\nthe primes for which Theorem A, applied to the ring pL, makes no assertion.\nWe also note that the definition in part (b) of Theorem A is consistent with\nour above explanation of the operation p \u2192 p\u22121 . Indeed, by the Weil conjectures, the numbers bt (p) may be expressed as alternating sums of Frobenius\neigenvalues. These complex numbers satisfy certain symmetries which are\nreflected by the functional equations for the Weil zeta functions of the varieties Vt . Had the expressions bt (p\u22121 ) been defined as the numbers obtained\nfrom inverting these eigenvalues, the identities bt (p\u22121 ) = p\u2212 dim(Vt ) bt (p) would\nfollow from these symmetries (see the remarks preceding Theorem 2.3 for details).\nExample 1.1. Theorem A applies in particular to the zeta functions of 'simple' Lie algebras over Z such as sl(d, Z). The only such Lie algebra for which\na functional equation as in (4) had been previously established is L = sl(2, Z)\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n(cf. [12]1):\n\u03b6L (s) = \u03b6(s)\u03b6(s \u2212 1)\u03b6(2s \u2212 1)\u03b6(2s \u2212 2)(1 + 3 * 21\u22122s \u2212 23\u22123s )\n\nY\n\n5\n\n(1 \u2212 p1\u22123s ).\n\np6=2\n\nIn fact, sl(2, Z) seems to be the only non-soluble Lie ring whose subring zeta\nfunction has been computed explicitly. Note that the functional equation fails\nfor p = 2. A similar phenomenon may occur if one studies the zeta function\nof a Zp -algebra: In [21] Klopsch computes the zeta function of a maximal Zp order in a central simple Qp -division algebra of index 2. The fact that this\nzeta function does not satisfy a functional equation of the form (4) reflects\nthe fact that it is not the 'generic' local factor of the zeta function of a ring.\nKlopsch and the present author have unified and generalised the above\nexamples. In [22] they gave a formula for the zeta function of an arbitrary\n3-dimensional Zp -Lie algebra, based on the proof of Theorem A.\nAn important corollary of Theorem A is to the theory of zeta functions\nof finitely generated, torsion-free nilpotent (or T -) groups. In [14, Theorem\n4.1] it was shown that, given a T -group G of Hirsch length n, there is a Lie\nsubring L = L(G), lying as a full Z-lattice in an n-dimensional Lie algebra\nL(G) over Q such that for almost all primes p\n(5)\n\n\u03b6G,p (s) = \u03b6L,p (s).\n\nThus we obtain\nCorollary 1.1. Let G be a T -group of Hirsch length n. For all but finitely\nmany primes p\nn\n\u03b6G,p (s)|p\u2192p\u22121 = (\u22121)n p( 2 )\u2212ns \u03b6G,p (s).\nTheorem A is itself an instance of an application of a 'reciprocity' result\n(Corollary 2.3 to Theorem 2.3) establishing certain functional equations for\na family of p-adic integrals. Theorem 2.3 may be viewed as a generalisation\nof Stanley's 'reciprocity theorem for linear homogeneous diophantine equations' ([28, Theorem 4.6.14]), which we now briefly explain. Given a set of\nsimultaneous linear homogeneous diophantine equations in n indeterminates,\nsay, one may encode their non-negative (positive) solutions in a rational generating function E(x) (E(x), respectively), where x = (x1 , . . . , xn ) is a vector\nof formal variables. More precisely, one defines\nX\nX\nx\u03b1 ,\nE(x) :=\nx\u03b1 and E(x) :=\n\u03b1\u2208Nn\n0 \u2229C\n\n\u03b1\u2208Nn \u2229C\n\nwhere \u03b1 = (\u03b11 , . . . , \u03b1n ), x\u03b1 = x\u03b11 1 . . . x\u03b1nn and C is the cone of all nonnegative real solutions to the given set of equations. Stanley's reciprocity\ntheorem states that, if E(x) 6= 0, then\nE(1/x) = (\u22121)dim C E(x).\n1The denominator of P (2\u2212s ) in [9, Equation (7)] should read 1 \u2212 21\u22123s .\n\n\f6\n\nCHRISTOPHER VOLL\n\nOur generalisation is obtained using (a variant of) Stanley's result and an\nexplicit formula of the form (3) for the integrals in question (Corollary 2.1\nof Theorem 2.2). This formula in turn is inspired by and generalises work\nof Denef ([3]), Denef and Meuser ([5]) and Veys and Zuniga-Galindo ([29])\non Igusa's local zeta function. While Igusa's local zeta functions associated\nto homogeneous polynomial mappings may be expressed as integrals over\nprojective space, the p-adic integrals considered in the current paper reduce to\nintegrals over the complete flag variety GLn /B, where B is a Borel subgroup.\nn\nIn a sense this explains the factor p( 2 ) in (4).\nA variant of the problem of counting subgroups consists in counting subgroups only up to conjugacy. Let G be a T -group. The conjugacy zeta\nfunction of a T -group G is defined as\nX\ncc\n(s) =\n|G : H|\u2212s |CG (H)|\u22121\n\u03b6G\nH\u2264G\n\nwhere |CG (H)| is the size of the conjugacy class of H. It is known ([14,\ncc (s) also has an Euler product decomposition into\nRemark on p. 189]) that \u03b6G\ncc\nlocal factors \u03b6G,p (s) which are all rational in p\u2212s . By applying the results of\nSection 2 we shall prove\nTheorem B. Let G be a T -group of Hirsch length n. For all but finitely\nmany primes p\nn\ncc\ncc\n(s).\n\u03b6G,p\n(s)|p\u2192p\u22121 = (\u22121)n p( 2 )\u2212ns \u03b6G,p\n\nAs a third application of our rather technical 'blueprint result' Theorem 2.2\nand its applications we deduce functional equations for normal zeta functions\nof T2 -groups. The normal zeta function of a T -group G is defined as\nX\n\u22b3\n\u03b6G\n(s) =\n|G : H|\u2212s\nH\u22b3G\n\nwhere the sum ranges over the normal subgroups H of finite index in G. It\nalso satisfies an Euler product decomposition. We prove\n\nTheorem C. Let G be a T2 -group of Hirsch length n with centre Z(G) such\nthat G/Z(G) has torsion-free rank d. For all but finitely many primes p\nn\n\n\u22b3\n\u22b3\n\u03b6G,p\n(s)|p\u2192p\u22121 = (\u22121)n p( 2 )\u2212(d+n)s \u03b6G,p\n(s).\n\nAs mentioned above, a functional equation may or may not hold for normal\nzeta functions of class greater than three. See [13, Chapter 2] for examples\nand [13, Theorem 4.44] for a conjectural form in case it does hold.\nThe fourth and last application in this paper of Theorem 2.2 and its consequences is concerned with representation zeta functions of T -groups, which\nwe shall now explain. Given a T -group G, we denote by Rn (G) the set of\nn-dimensional complex characters of G. Given \u03c31 , \u03c32 \u2208 Rn (G), we say that\n\u03c31 and \u03c32 are twist\u2013equivalent if there exists a linear character \u03c7 \u2208 R1 (G)\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n7\n\nsuch that \u03c31 = \u03c7\u03c32 . The classes of this equivalence relation are called twistisoclasses. We say that a character \u03c3 of a representation \u03c1 of G factors\nthrough a finite quotient of G if \u03c1 factors through it. The set Rn (G) has\nthe structure of a quasi\u2013affine complex algebraic variety whose geometry was\nanalysed by Lubotzky and Magid in [23]. They proved\nTheorem [23, Theorem 6.6] Let G be a T -group. For every n \u2208 N there is a\nfinite quotient G(n) of G such that every n-dimensional irreducible character\nof G is twist-equivalent to one that factors through G(n). In particular, the\nnumber of twist-isoclasses of irreducible n-dimensional characters is finite.\nLet us call this number an . The representation zeta function of G is defined\n(cf. [17]) by\n\u221e\nX\nirr\nan n\u2212s .\n(s) :=\n\u03b6G\nn=1\n\nIt follows from the above theorem and [2, (10.33)] that the function n 7\u2192 an\nis multiplicative and thus\nY\nirr\nirr\n\u03b6G\n(s) =\n\u03b6G,p\n(s),\np prime\n\nwhere\nirr\n\u03b6G,p\n(s) :=\n\n\u221e\nX\n\napn p\u2212sn .\n\nn=0\n\nExample 1.2. ([17, Example 8.12], [25, Theorem 5]) Let\nH = hx1 , x2 , y|[x1 , x2 ] = y, all other [ , ] triviali\nbe the discrete Heisenberg group. Then\nirr\n\u03b6H\n(s) =\n\n\u221e\nX\n\nn=1\n\n\u03c6(n)n\u2212s =\n\nY 1 \u2212 p\u2212s\n\u03b6(s \u2212 1)\n=\n,\n\u03b6(s)\n1 \u2212 p1\u2212s\np prime\n\nwhere \u03c6 denotes the Euler totient function.\nBy a model-theoretic result of Hrushovski and Martin [17, Theorem 8.4],\nthe local representation zeta functions of a T -group are known to be rational\nirr (s) in terms of\nfunctions in p\u2212s with integer coefficients. By expressing \u03b6G,p\np-adic integrals to which Theorem 2.2 is applicable we shall prove\nTheorem D. Let G be a T -group with derived group G\u2032 = [G, G] of Hirsch\nlength n. Then for almost all primes p\nirr\nirr\n(s).\n\u03b6G,p\n(s)|p\u2192p\u22121 = pn \u03b6G,p\n\n\f8\n\nCHRISTOPHER VOLL\n\n1.2. Outline of methodology and related work. We briefly describe how\nwe relate the problems solved in Theorems A, B, C and D to problems about\np-adic integrals.\nTo count the subrings of p-power index in a ring L of rank n, we observe\nthat it is enough to keep track of the index of the largest Zp -subalgebra of\nL \u2297 Zp in each given homothety class of lattices in the p-adic vector space Qnp .\nUsing the action of the group \u0393 := GLn (Zp ) on the set of homothety classes,\nwe show that the latter problem reduces to counting polynomial congruences\nin finite quotients of \u0393. This counting problem translates into the problem\nof computing a p-adic integral in very much the same fashion as the problem\nof counting polynomial congruences in affine space translates to the problem of computing Igusa's local zeta function (cf. [4, Section 1.2]). It proved\nhelpful to think of homothety classes of lattices as the vertices of the BruhatTits building of SLn (Qp ), and to partition the vertex set into finitely many\nparts according to their position relative to the 'root class' [L \u2297 Zp ]. As\nwe remarked above, this approach differs decisively from the 'cone integrals'\nintroduced by du Sautoy and Grunewald in [8]. Their analysis rests on a\nbasis dependent parametrisation of p-power index subrings of a given ring in\nterms of upper-triangular matrices over the p-adic integers satisfying certain\ndivisibility conditions ('cone conditions').\nTo count subgroups up to conjugacy in a T -group G we use the fact that,\nfor almost all primes p,\ncc\ncc\n\u03b6G,p\n(s) = \u03b6L,p\n(s),\nwhere L = L(G) is the Lie ring associated to G (cf. the remark preceding\nCorollary 1.1), and\nX\ncc\n\u03b6L,p\n(s) =\n|L \u2297 Zp : H|\u2212s |L \u2297 Zp : NL\u2297Zp (H)|\u22121 ,\nH\u2264L\u2297Zp\n\nwhere H ranges over the subalgebras of L \u2297 Zp of finite index and NL\u2297Zp (H)\nis the normaliser of H in L \u2297 Zp . We thus have to keep track both of the\nlargest subring of L \u2297 Zp in each given homothety class and of the class'\nnormaliser. The index of the latter is given by the index of a system of\nlinear congruences. Enumerating these indices, in turn, may be achieved by\ncounting the elementary divisors of matrices of linear forms, encoding the\ngroup's commutator structure. In Proposition 2.2 we show that, slightly\nmore generally, the generating functions enumerating elementary divisors of\nmatrices of polynomial forms of the same degree may be expressed in terms\nof p-adic integrals associated to degeneracy loci of these matrices, to which\nCorollary 2.4 is applicable.\nIn order to count normal subgroups in class-2-nilpotent groups we develop\nan idea first introduced in [30]. There it was shown that it suffices to evaluate\na weight function on the set of homothety classes of lattices in the centre\nZ(L\u2297Zp) of the Zp -Lie algebra L\u2297Zp , where L is the associated Lie ring. The\nweight associated to a vertex in the appropriate affine Bruhat-Tits building\ncorresponding to a given class is again given by the index of a system of linear\ncongruences.\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n9\n\nAs mentioned above, the validity of our main Theorems A and C had been\nknown in many special cases. We refer the reader to the numerous examples\ncollected in [13]. In this research monograph du Sautoy and Woodward also\npresent a conjecture on functional equations for cone integrals that would\nexplain functional equations for normal zeta functions of nilpotent of class\ngreater than 2.\nThe key to Theorem D is to use 'Kirillov-theory' developed by Howe [16]\nto translate the problem of counting irreducible representations of G to the\nproblem of counting co-adjoint orbits in the dual of the Lie algebra associated to G by the Malcev correspondence. We use the fact \u2013 also established\nby Howe \u2013 that the sizes of co-adjoint orbits may be expressed in terms of\nthe indices of the radicals of certain anti-symmetric forms on the Lie algebra. These may also be described in terms of elementary divisors of matrices\nencoding the structure of the Lie algebra.\nRepresentation zeta functions of nilpotent groups have not been studied\nuntil fairly recently, and [17] seems to be the only reference so far on this\ntopic. The idea of using Kirillov-theory to study representation zeta functions\nof groups, however, has been successfully employed before. Jaikin-Zapirain\nproved in [19] the rationality of representation zeta functions for certain compact p-adic analytic groups using a Kirillov-type correspondence developed\nby Howe ([15]) for these groups. In [17] Hrushovski and Martin suggest that\nJaikin-Zapirain's work may be adapted to prove rationality of local representation zeta functions for T -groups, too.\nAmong the variants of the zeta function (1) of a T -group G considered\n\u2227 (s), enumerating subgroups of finite index\nin [14] is also the zeta function \u03b6G\nwhose profinite completion is isomorphic to the profinite completion of G.\nIn [10] du Sautoy and Lubotzky proved a functional equations for the local\n\u2227 (s) for a class of T -groups. Their work is based on a reduction\nfactors of \u03b6G\nof the problem of computing these zeta functions to the problem of computing certain p-adic integrals over the group's algebraic automorphism group,\ngeneralising work of Igusa's ([18]). The functional equation for the local factors of these zeta functions arises from a symmetry in the root system of the\nassociated Weyl groups. An argument of this kind (albeit only for the Weyl\ngroups of type A) is also used in the present paper to deduce Corollary 2.3.\n\u2227 (s) (for reasonably large classes\nWe do not know whether the zeta functions \u03b6G\nof T -groups) may be described by the p-adic integrals studied in the current\npaper. In [1] Berman extends the approach taken in [10], proving uniformity\nand local functional equations for these zeta functions for a wider class of\nnilpotent groups than previously considered.\nThe fact that we have to disregard finitely many primes in most of our\nresults has two reasons: Firstly, our Theorems 2.1 and 2.2 upon which Theorem 2.3 and its corollaries are based are valid only for primes for which a\ncertain principalisation of ideals has good reduction. Secondly, we are forced\nto ignore finitely many primes in order to transfer between the T -group G\nand its associated Lie algebra.\n\n\f10\n\nCHRISTOPHER VOLL\n\n1.3. Layout of the paper and notation. In Section 2 we first develop, in\nTheorems 2.1 and 2.2, explicit formulae for certain families of p-adic integrals\ngeneralising Igusa's local zeta function. These two results \u2013 which may be\nunderstood as close analogues of Theorems 2 and 3 in [5] \u2013 form the technical\ncore of the paper. We use them to establish, in Theorem 2.3, an 'inversion\nproperty' enjoyed by the p-adic integrals considered. In Corollaries 2.3 and 2.4\nwe exploit this property to deduce functional equations for certain linear\ncombinations of the p-adic integrals in question. The remainder of the paper\nis dedicated to showing how Theorem 2.2 may be used as a template to\ndescribe various kinds of zeta functions. In the second part of Section 2 we\ngive a first application of this idea to the problem of counting elementary\ndivisors of matrices of forms (Proposition 2.2). In the four subsections of\nSection 3 we prove Theorems A, B, C and D, respectively.\nWe use the following notation.\nN\nI = {i1 , . . . , il }<\nI0\n[k]\n[l, k]\n\u0001\na\nb\u0001\na\nb X\n\nn\u0001\n\nI X\n\nSn\nMt\nZp\nQp\n[\u039b]\nK\nR\nP\nK\nF\n\u03b4P\n\nthe set {1, 2, . . . } of natural numbers\nthe set I of natural numbers i1 < * * * < il\nthe set I \u222a {0} for I \u2286 N\nthe set {1, . . . , k}, k \u2208 N\nthe set {l, . . . , k}, k, l \u2208 N\nthe binomial coefficient for a, b \u2208 N0\nQ\na\u2212i )/(1 \u2212 X b\u2212i ),\nthe polynomial b\u22121\ni=0 (1 \u2212 X\nwhere a, b \u2208 N0 with a \u2265 b\nNote: The q-binomial coefficient or Gaussian\n\u0001\npolynomial ab q gives the number of\nsubspaces of dimension b in Faq .\n\u0001\n\u0001\nil \u0001\nthe polynomial inl\n. . . ii21 X ,\nil\u22121\nX\n\nX\n\nfor n \u2208 N, I = {i1 , . . . , il }< \u2286 [n \u2212 1]\n\u0001\nNote: nI q gives the number of flags of type I in Fnq .\nthe symmetric group on n letters\nthe transpose of a matrix M\nthe ring of p-adic integers (p a prime)\nthe field of p-adic numbers\nthe homothety class Q\u2217p \u039b of a (full) lattice \u039b in Qnp\na finite extension of the field Qp\nthe valuation ring of K\nthe maximal ideal of R\nthe residue field R/P , of cardinality q\na number field\nthe 'Kronecker delta' which is equal to 1 if\nthe property P holds and equal to 0 otherwise.\n\nGiven a set f of polynomials and a polynomial g, we write gf for {gf | f \u2208 f },\nand (f ) for the polynomial ideal generated by f .\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n11\n\n2. Functional equations for some p-adic integrals\n2.1. A blueprint result. In this section we study a family of p-adic integrals generalising Igusa's local zeta functions. We first introduce some more\nnotation. Let p be a prime and K be a finite extension of the field Qp of\np-adic numbers. Let R = RK denote the valuation ring of K, P = PK the\nmaximal ideal of R, and K the residue field R/P . The cardinality of K will\nbe denoted by q.\nFor x \u2208 K, let v(x) = vP (x) \u2208 Z \u222a {\u221e} denote the P -adic valuation\nof x, and |x| := q \u2212v(x) . For a finite set S of elements of K, we set kSk :=\nmax{|s| | s \u2208 S}. Fix k, m, n \u2208 N. For each \u03ba \u2208 [k], let (f\u03ba\u03b9 )\u03b9\u2208I\u03ba be a finite\nfamily of finite sets of polynomials in K[y1 , . . . , ym ], and let x1 , . . . , xn\u22121 be\nindependent variables. Also, for i \u2208 [n \u2212 1] we fix non-negative integers ei \u03ba\u03b9 .\nFor a set I = {i1 , . . . , il }< \u2286 [n \u2212 1], \u03ba \u2208 [k], we set\n!\n[ Y e\nxi i \u03ba\u03b9 f\u03ba\u03b9 (y).\ng\u03ba,I (x, y) =\ni\u2208I\n\n\u03b9\u2208I\u03ba\n\nRm\n\nLet W \u2286\nbe a subset which is a union of cosets mod P m and s =\n(s1 , . . . , sk ) be independent complex variables. We then define\nZ\nY\nkg\u03ba,I (x, y)ks\u03ba |dxI ||dy|\n(6)\nZW,K,I (s) :=\nP l \u00d7W \u03ba\u2208[k]\n\nwhere |dxI | = |dxi1 \u2227 * * * \u2227 dxil | is the Haar measure on K l normalised so that\nRl has measure 1 (and thus P l has measure q \u2212l ), and |dy| = |dy1 \u2227 * * * \u2227 dym |\nis the (normalised) Haar measure on K m . It is well-known that ZW,K,I (s) is\na rational function in q \u2212s\u03ba , \u03ba \u2208 [k], with integral coefficients.\nWe now assume that the polynomials constituting the sets f\u03ba\u03b9 are in fact\ndefined over a number field F . We may consider the local zeta functions\nZW,K,I (s) for all non-archimedean completions K of F . In the remainder\nof this section we shall derive formulae for ZW,K,I (s), valid for almost all\ncompletions K of F under this and further assumptions. They are essentially\nbased on the formulae Denef gave for Igusa's local zeta function\nZ\n|f (y)|s |dy|\nZ(s) =\nRm\n\nin [3, Theorem 3.1], using the concept of resolution of singularities for the hypersurface defined by f . In the case where the single polynomial f is replaced\nby a finite set of polynomials f , Veys and Zuniga-Galindo ([29, Theorem 2.10])\ngave an analogous formula, using instead the concept of principalisation of\nideals, which we briefly recall.\nTheorem [33, Theorem 1.0.1] Let I be a sheaf of ideals on a smooth algebraic\nvariety X. There exists a principalisation (Y, h) of I, that is, a sequence\nh\n\nh\n\nh\n\n1\n\u03b9\nr\nX = X0 \u2190\u2212\nX1 \u2190\u2212 * * * \u2190\u2212\nX\u03b9 \u2190\u2212 * * * \u2190\u2212\nXr = Y\n\nof blow-ups h\u03b9 : X\u03b9 \u2192 X\u03b9\u22121 of smooth centres C\u03b9\u22121 \u2282 X\u03b9\u22121 such that\n\n\f12\n\nCHRISTOPHER VOLL\n\na) The exceptional divisor E\u03b9 of the induced morphism h\u03b9 = h\u03b9 \u25e6 * * * \u25e6 h1 :\nX\u03b9 \u2192 X has only simple normal crossings and C\u03b9 has simple normal\ncrossings with E\u03b9 .\nb) Setting h = hr \u25e6 * * * \u25e6 h1 , the total transform h\u2217 (I) is the ideal of\ne If the subscheme determined\na simple normal crossing divisor E.\ne is an N-linear\nby I has no components of codimension one, then E\ncombination of the irreducible components of the divisor Er .\nAlso recall the definition [3, Definition 2.2 (mutatis mutandis)] of a principalisation (Y, h) with good reduction mod P if I and (Y, h) are defined over a\np-adic field K. Note that, given a principalisation (Y, h) for I defined over a\nnumber field F , (Y, h) will have good reduction mod P (where P is the maximal ideal in the ring of integers of the completion of F at K) for almost all\nmaximal ideals P of the ring of integers of F (this is essentially [3, Theorem\n2.4]).\nSpecifically, let (Y, h), h : Y \u2192 Am , be a principalisation of the ideal\nY\n(f\u03ba\u03b9 )\nI=\n\u03ba\u2208[k], \u03b9\u2208I\u03ba\n\nwhere (f ) denotes the ideal generated by the finite set f of polynomials. We\nset V := Spec(F[y]/I) and V\u03ba\u03b9 := Spec(F[y]/(f\u03ba\u03b9 )). Then, denoting by Et ,\nt \u2208 T , the irreducible components of (h\u22121 (V))red , we have\nX\n(7)\nh\u22121 (V) =\nNt Et ,\nt\u2208T\n\n\u22121\n\n(8)\n\nh\n\n(V\u03ba\u03b9 ) =\n\nX\n\nNt \u03ba\u03b9 Et ,\n\nt\u2208T\n\nsay, for suitable non-negative integers Nt , Nt \u03ba\u03b9 . Note that, for every t \u2208 T ,\nX\nNt \u03ba\u03b9 .\nNt =\n\u03ba\u2208[k], \u03b9\u2208I\u03ba\n\nSimilarly we denote by \u03bdt \u2212 1 the multiplicity of Et in the divisor of h\u2217 (dy1 \u2227\n* * * \u2227 dym ). The numbers (Nt \u03ba\u03b9 , \u03bdt )t\u2208T, \u03ba\u2208[k], \u03b9\u2208I\u03ba will be called the numerical\ndata of the principalisation (Y, h).\nTheorem 2.1. Suppose that all the sets f\u03ba\u03b9 are integral (i.e. contained in\nR[y]) and do not define the zero ideal mod PK , and that (Y, h) has good\nreduction mod PK . Then\nZW,K,I (s) =\n\n(1 \u2212 q \u22121 )|I| X\ncU,W (q)(q \u2212 1)|U | \u039eU,I (q, s),\nqm\nU \u2286T\n\nwhere\ncU,W (q) = |{a \u2208 Y (K)| a \u2208 Eu (K) \u21d4 u \u2208 U and h(a) \u2208 W }|\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n13\n\n(where denotes reduction mod P and W = {(y1 , . . . , ym )| (y1 , . . . , ym ) \u2208\nW }|) and\n(9)\nP\nP\nP\nP\nP\nX\nq \u2212 i ni \u2212 u \u03bdu mu \u2212 \u03ba s\u03ba min\u03b9\u2208I\u03ba { i ei \u03ba\u03b9 ni + u Nu \u03ba\u03b9 mu } .\n\u039eU,I (q, s) =\n(mu )u\u2208U \u2208N|U |\n(ni )i\u2208I \u2208Nl\n\nExample 2.1. If l = 0 and, for each \u03ba \u2208 [k], |I\u03ba | = 1, Theorem 2.1 reduces\nto (a multivariable version of) Vey's and Zuniga-Galindo's generalisation [29,\nTheorem 2.10] to polynomial mappings of Denef's explicit formula [3, Theorem 2] for Igusa's local zeta function associated to a single polynomial. Notice\nin particular that in this case\nP\nP\nX\nY Xu\n\u039eU,\u2205(q, s) =\nq u mu (\u2212\u03bdu \u2212 \u03ba Nu\u03ba s\u03ba ) =\n1 \u2212 Xu\n|U |\nu\u2208U\n\n(mu )u\u2208U \u2208N\n\nP\n\nfor Xu := q \u2212\u03bdu \u2212 \u03ba Nu\u03ba s\u03ba , where we write Nu\u03ba for Nu \u03ba\u03b9 . Also compare Example 2.2 for the other 'extremal case' \u039e\u2205,I (q, s).\nProof. The proof is analogous to the one of [3, Theorem 3.1] (=[5, Theorem\n2]), with the concept of resolution of singularities replaced by the concept of\nprincipalisation of ideals. We adopt \u2013 mutatis mutandis \u2013 Denef's notation\nand just explain how the proof differs from his. Let a be a closed point of Y ,\nand thus also of Ye . Let Ta = {t \u2208 T | a \u2208 Et } = {t1 , . . . , tr }< , say. Define\nH = {b \u2208 Y (K)| h(b) \u2208 Rm } and recall the definition of the 'reduction\nmod P '-map \u03b8 : H \u2192 Y (K). In the regular local ring OYe ,a , there exist\nirreducible elements \u03b31 , . . . , \u03b3m such that, on \u03b8 \u22121 (a), for all \u03ba \u2208 [k], \u03b9 \u2208 I\u03ba ,\nkf\u03ba\u03b9 \u25e6 hk =|\u03b31 |Nt1 \u03ba\u03b9 . . . |\u03b3r |Ntr \u03ba\u03b9 and\n|h\u2217 (dy1 \u2227 . . . dym )| =|\u03b31 |\u03bdt1 \u22121 | . . . |\u03b3r |\u03bdtr \u22121 |d\u03b31 \u2227 * * * \u2227 d\u03b3m |.\nSetting d\u03b3 := d\u03b31 \u2227 * * * \u2227 d\u03b3m we define\nZa,I (s)\n:=\n\n=\n=\n\nZ\nZ\n\nY\n\nmax\n\nP l \u00d7\u03b8 \u22121 (a) \u03ba\u2208[k] \u03b9\u2208I\u03ba\n\nY\n\nmax\n\nP l+m \u03ba\u2208[k] \u03b9\u2208I\u03ba\n\n1)r+l\n\n(q \u2212\nq m+l\n\n\uf8f1\n\uf8f2Y\n\uf8f3\n\n\uf8f1\n\uf8f2Y\n\uf8f3\n\nX\n\nY\n\n|xi |ei \u03ba\u03b9\n\ni\u2208I\n\n|\u03b3\u03c1 |Nt\u03c1 \u03ba\u03b9\n\n\u03c1\u2208[r]\n\n|xi |ei \u03ba\u03b9\n\ni\u2208I\n\nY\n\n|y\u03c1 |Nt\u03c1 \u03ba\u03b9\n\n\u03c1\u2208[r]\n\nq\u2212\n\nP\n\nP\n\na\u2208Y (K) Za,I (s).\nh(a)\u2208W\n\n\u03bdt mt \u2212\n\nP\n\n\uf8fe\n\nni \u2212\n\nt\n\n\uf8fe\n\n\uf8fcs \u03ba\n\uf8fd Y\n\nP\n\ni\n\n\uf8fcs\u03ba\n\uf8fd Y\n\n\u03ba s\u03ba\n\n|\u03b3\u03c1 |\u03bdt\u03c1 \u22121 |dxI ||d\u03b3|\n\n\u03c1\u2208[r]\n\n|y\u03c1 |\u03bdt\u03c1 \u22121 |dxI ||dy|\n\n\u03c1\u2208[r]\n\nP\nP\nmin\u03b9\u2208I\u03ba { i ei \u03ba\u03b9 ni + t Nt \u03ba\u03b9 mt }\n\n.\n\n\u2208Nr\n\n(mt )t\u2208Ta\n(ni )i\u2208I \u2208Nl\n\nThis suffices as ZW,K,I (s) =\n\n\u0003\n\n\f14\n\nCHRISTOPHER VOLL\n2\n\nWe now make the further assumption that m = n2 . We identify K n with\nMatn (K) and assume that the ideals (f\u03ba\u03b9 ), \u03ba \u2208 [k], \u03b9 \u2208 I\u03ba , are B(F )-invariant,\nwhere B(F ) is the group of F -rational points of the Borel subgroup of uppertriangular matrices in G = GLn , acting on K[y11 , y12 , . . . , ynn ] by matrixmultiplication from\nQ the right. Let (Y, h), h : Y \u2192 G/B be a principalisation\nof the ideal I = \u03ba,\u03b9 (f\u03ba\u03b9 ). Denoting, similar to the above, by V the subvariety\nof G/B(K) defined by I and by V\u03ba\u03b9 the subvariety defined by (f\u03ba\u03b9 ) yields\nnumerical data (Nt \u03ba\u03b9 , \u03bdt )t\u2208T, \u03ba\u2208[k], \u03b9\u2208I\u03ba defined by formulae analogous to (7)\nand (8) above. We shall study the integral\nZI (s) := ZW,K,I (s)\nfor W = \u0393 = GLn (R) for almost all completions K of F . Note that the Haar\nmeasure \u03bc\u2032 on the compact topological group \u0393 coincides with the additive\n2\n2\nHaar measure \u03bc induced from Rn (and normalised such that \u03bc(Rn ) = 1), as\n\u03bc\u2032 = | det |\u2212n \u03bc = \u03bc. This will be important in later applications as it implies,\nfor example, that all the cosets of a finite index subgroup \u0393\u2032 \u2264 \u0393 have measure\n\u03bc(\u0393)/|\u0393 : \u0393\u2032 |, with \u03bc(\u0393) = (1 \u2212 q \u22121 ) . . . (1 \u2212 q \u2212n ).\nTheorem 2.2. Suppose that, in addition to the above assumptions, none of\nthe ideals (f\u03ba\u03b9 ) is equal to the zero ideal mod PK , and that (Y, h) has good\nreduction mod PK . Then\nZI (s) =\n\n(1 \u2212 q \u22121 )|I|+n X\ncU (q)(q \u2212 1)|U | \u039eU,I (q, s),\nn\n(\n)\nq 2\nU \u2286T\n\nwhere each cU (q) is the number of K-rational points of EU \\ \u222aV )U EV (EU :=\n\u2229u\u2208U Eu ) and \u039eU,I (q, s) is defined as in (9) above.\nProof. The proof follows closely the spirit of the proof of [5, Theorem 3]. In\nbK (s), defined\nfact, our function ZI (s) is a close analogue of the function Z\non [5, p. 1140]. We write \u0393 as a disjoint union of sets\n\n\u0393\u03c3 = {x \u2208 \u0393| x \u2208 B(Fq )\u03c3B(Fq )},\nS\n\u03c3 \u2208 Sn , where GLn (Fq ) = \u03c3\u2208Sn B(Fq )\u03c3B(Fq ) is the Bruhat decomposition\n(here \u03c3 \u2208 Sn is identified with the respective permutation matrix in GLn (Fq )).\nThus\nX\nZ\u0393\u03c3 ,K,I (s).\nZI (s) =\n\u03c3\u2208Sn\n\nThere is an obvious map \u03b3 : \u0393 \u2192 G/B(K), and, by our invariance assumption\non the ideals (f\u03ba\u03b9 ), the value of the integrand of ZI (s) at a point (x, y) \u2208 P l \u00d7\u0393\nonly depends on x and \u03b3(y). By taking the measure \u03c9 on G/B(K) which\nn\ninduces the Haar measure on the unit ball R( 2 ) of each affine chart satisfying\nn\nn\n\u03c9(a + P ( 2 ) ) = q \u2212( 2 ) and noting that \u03bc(B) = (1 \u2212 q \u22121 )n , we obtain\nZ\nY\nZ\u0393\u03c3 ,K,I (s) = (1 \u2212 q \u22121 )n\nkg\u03ba,I (x, y)ks\u03ba |dxI |d\u03c9,\nP l \u00d7V\u03c3 \u03ba\u2208[k]\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n15\n\nwhere V\u03c3 = \u03b3(\u0393\u03c3 ). The projective\nvariety G/B may be covered by varieties\n\u0001\nU\u03c3 , isomorphic to affine n2 -space, indexed by the elements of the symmetric\ngroup Sn , such that each V\u03c3 is contained in U\u03c3 and is a union of cosets\nn\nmod P ( 2 ) . Theorem 2.1 may thus be applied to the restriction (Y \u03c3 , h\u03c3 )\nof (Y, h), a principalisation of the ideal defining the restriction of V to U\u03c3\n(Y \u03c3 = h\u22121 (U \u03c3 ), h\u03c3 = h|Y \u03c3 ), with good reduction mod P . We obtain\nZ\nY\n(1 \u2212 q \u22121 )l X\ncU,\u03c3 (q)(q \u22121)|U | \u039eU,I (q, s),\nkg\u03ba,I (x, y)ks\u03ba |dxI |d\u03c9 =\nn\nP l \u00d7V\u03c3 \u03ba\u2208[k]\nq(2)\nU \u2286T\nwhere\n\u03c3\n\ncU,\u03c3 (q) = |{a \u2208 Y (K)| a \u2208 Eu (K) \u21d4 u \u2208 U and h(a) \u2208 V\u03c3 }|.\nThe\nP result follows since, if a \u2208 Y (K), then h(a) is in exactly one V\u03c3 . Thus\n\u0003\n\u03c3\u2208Sn cU,\u03c3 (q) = |{a \u2208 Y (K)| a \u2208 Eu (K) \u21d4 u \u2208 U }| = cU (q).\nWe now consider the normalised integrals\nfI (s) :=\nZ\n\n(10)\n\nZI (s)\n.\n(1 \u2212 q \u22121 )|I| \u03bc(\u0393)\n\nCorollary 2.1. For U \u2286 T , let bU (q) denote the number of K-rational points\nof EU . Then\nX\nX\nfI (s) = |G/B(Fq )|\u22121\nbU (q)\n(\u22121)|U \\V | (q \u2212 1)|V | \u039eV,I (q, s).\n(11)\nZ\nU \u2286T\n\nV \u2286U\n\nProof. This follows immediately from the formula given for\u0001 ZI (s) in Theon\nand from the\nrem 2.2, Definition (10), the fact that |G/B(Fq )| = [n\u22121]\nq\nidentity\nX\ncV (q) =\n(\u22121)|U \\V | bU (q).\nV \u2286U \u2286T\n\n\u0003\n\nBefore we proceed we consider a very special case.\nExample 2.2. Assume that, for all \u03ba \u2208 [k], |I\u03ba | = 1 and that all f\u03ba\u03b9 = {1}.\nWe write ei\u03ba for ei \u03ba\u03b9 . We have\nP\nP\nY Xi\nX\n,\n\u039e\u2205,I (q, s) =\nq i ni (\u22121\u2212 \u03ba ei\u03ba s\u03ba ) =\n1 \u2212 Xi\nl\ni\u2208I\n\n(ni )i\u2208I \u2208N\n\nP\n\nwith Xi = q \u22121\u2212 \u03ba ei\u03ba s\u03ba . Also note that b\u2205(q) = |G/B(Fq )| and that bU (q) =\nXi\nfI (s) = Q\n0 if U 6= \u2205. Thus Z\ni\u2208I 1\u2212Xi . It is trivial to verify the 'inversion\nproperty'\nX\nfJ (s),\nfI (s)|q\u2192q\u22121 = (\u22121)|I|\nZ\n(12)\nZ\nJ\u2286I\n\n\f16\n\nCHRISTOPHER VOLL\n\nas\n\nY\ni\u2208I\n\nX Y Xj\nXi\u22121\n|I|\n=\n(\u22121)\n.\n1 \u2212 Xj\n1 \u2212 Xi\u22121\nJ\u2286I j\u2208J\n\nIn the remainder of the current section we shall show that equation (12)\nholds under the premises of Theorem 2.2. To give meaning to the left-most\nterm in (12) in general we have to explain what we mean by bU (q \u22121 ) (the\nfI (s) being rational functions\nother constituents of the expression (11) for Z\n\u2212s\n\u2212s\nin q and q 1 , . . . , q \u0001k ). Recall\n\u0001 that by properties of the Weil zeta functions\nn\nassociated to the 2 \u2212 |U | -dimensional smooth projective varieties EU it\nis known that\n2((n\n)\u2212|U |)\ntU,r\n2X\nX\nr\n\u03b1U,r,j\n(\u22121)\nbU (q) =\nr=0\n\nj=1\n\nfor suitable non-negative integers tU,r and non-zero complex numbers \u03b1U,r,j ,\nwith the property that, for each U , r, the multisets\nn\no\n\u03b1U,r,j | j \u2208 [tU,2((n)\u2212|U |)\u2212r ]\n2\n\nand\n\n(\n\n)\nn\nq ( 2 )\u2212|U |\nj \u2208 [tU,r ]\n\u03b1U,r,j\n\ncoincide (cf., e.g., [5, Proof of Theorem 4]). This motivates the definition\n(13)\n\nn\n2\n\nbU (q \u22121 ) := q \u2212(( )\u2212|U |) bU (q) =\n\n2((n\n\u2212|U |)\n2)\n\nX\n\n(\u22121)r\n\nr=0\n\ntU,r\nX\n\n\u03b1\u22121\nU,r,j .\n\nj=1\n\nWe shall prove\nTheorem 2.3. Under the assumptions of Theorem 2.2, the following 'inversion properties' hold:\nX\nfJ (s)\nfI (s)|q\u2192q\u22121 = (\u22121)|I|\nZ\n(IP)\n\u2200I \u2286 [n \u2212 1] : Z\nJ\u2286I\n\nProof. To see what happens to the (rational) functions \u039eV,I (q, s) in expression (11) if we formally invert the prime power q, we employ a result of\nStanley:\nProposition 2.1. Let L\u03c3\u03c4 (n), \u03c3 \u2208 [s], \u03c4 \u2208 [t], be Z-linear forms in the\nvariables n1 , . . . , nr and X1 , . . . , Xr , Y1 , . . . , Ys independent variables, and set\nX Y n\u03c1 Y min\u03c4 \u2208[t]{L\u03c3\u03c4 (n)}\nY\u03c3\nX\u03c1\nZ \u25e6 (X, Y) :=\nn\u2208Nr \u03c1\u2208[r]\n\nZ(X, Y) :=\n\nX Y\n\nn\u2208Nr0 \u03c1\u2208[r]\n\n\u03c3\u2208[s]\n\nn\n\nX\u03c1 \u03c1\n\nY\n\n\u03c3\u2208[s]\n\nmin\u03c4 \u2208[t] {L\u03c3\u03c4 (n)}\n\nY\u03c3\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n17\n\nThen\nZ \u25e6 (X\u22121 , Y \u22121 ) = (\u22121)r Z(X, Y).\nProof. The proof of [28, Theorem 4.6.14] carries through to this slightly more\ngeneral situation, provided one chooses a triangulation of Nr that refines a\nsubdivision into rational polyhedral cones eliminating the 'min'-terms in the\nsum defining Z(X, Y).\n\u0003\nCorollary 2.2. For all I \u2286 [n \u2212 1], V \u2286 T ,\n\u039eV,I (q, s)|q\u2192q\u22121 = (\u22121)|V |+|I|\n\n(14)\n\nX\n\n\u039eW,J (q, s).\n\nW \u2286V,J\u2286I\n\nWe record the following simple fact:\nLemma 2.1. For all U \u2286 T, J \u2286 [n \u2212 1],\nX\nX\n\u039eW,J (q, s) =\n(15)\n(\u22121)|U \\V | (1 \u2212 q \u22121 )|V |\nW \u2286V\n\nV \u2286U\n\nq \u2212|U |\n\nX\n\n(\u22121)|U \\V | (q \u2212 1)|V | \u039eV,J (q, s).\n\nV \u2286U\n\nThe proof is a simple computation. We can now deduce\nn\nX\n(\u22121)|I| q ( 2 ) X\nf\nbU (q \u22121 )\n(\u22121)|U \\V | (1 \u2212 q \u22121 )|V | *\nZI (s)|q\u2192q\u22121 =\n|G/B(Fq )|\nU \u2286T\nV \u2286U\nX\n\u039eW,J (q, s)\n(11), (14)\n\nW \u2286V,J\u2286I\n\n=(\u22121)|I|\n\nX\n\n|G/B(Fq )|\u22121\n\n(\u22121)|U \\V | (1 \u2212 q \u22121 )|V |\n\nV \u2286U\n\n=(\u22121)|I|\n\nX\n\n|G/B(Fq )|\u22121\n\nX\n\nX\n\n\u039eW,J (q, s)\n\n(13)\n\nW \u2286V\n\nbU (q)*\n\nU \u2286T\n\nJ\u2286I\n\nX\n\nq |U | bU (q)*\n\nU \u2286T\n\nJ\u2286I\n\nX\n\nX\n\n(\u22121)|U \\V | (q \u2212 1)|V | \u039eV,J (q, s)\n\n(15)\n\nV \u2286U\n\n|I|\n\n=(\u22121)\n\nX\n\nJ\u2286I\n\nfJ (s).\nZ\n\n(11)\n\nThis completes the proof of Theorem 2.3.\n\u0003\n\u0001\nRecall that the polynomials nI X were introduced at the end of the introduction. We define\nX \u0012n \u0013\ne\nfI (s).\n(16)\nZ(s) =\nZ\nI q\u22121\nI\u2286[n\u22121]\n\nTo prove Theorems A, B and C we shall need\n\n\f18\n\nCHRISTOPHER VOLL\n\nCorollary 2.3. Under the assumptions of Theorem 2.2, the following functional equation holds:\nn\n\nn\u22121 ( 2 ) e\ne\nq Z(s).\nZ(s)|\nq\u2192q \u22121 = (\u22121)\n\n(17)\n\nProof. This follows from the proof of [32, Corollary 2]. Note that Theorem 2.2\nprovides the required analogue of [32, Lemma 6].\n\u0003\nTheorem D will follow from Proposition 2.2 of the next section which is in\nturn a special case of the following straightforward corollary.\nCorollary 2.4. Under the assumptions of Theorem 2.2, for any i \u2208 [n \u2212 1],\n\u0010\n\u0010\n\u0011\n\u0011\nn f\nf\u2205(s) + (1 \u2212 q \u2212n )Z\ng\ng\n(18) Z\nZ\u2205(s) + (1 \u2212 q \u2212n )Z\n{i} (s) |q\u2192q \u22121 = q\n{i} (s) .\n\n2.2. A first application: Counting elementary divisors. We show how\nthe problem of counting elementary divisors of matrices of forms may be\nreduced to the problem of computing p-adic integrals of the form studied in\nthe previous section, associated to the polynomials describing the degeneracy\nloci of these matrices. The main result of this subsection \u2013 Proposition 2.2 \u2013\nwill be needed to prove Theorem D in Section 3.4.\nAgain, let K be a p-adic field with valuation ring R, whose maximal ideal\nis denoted by P . Let R be an e \u00d7 f -matrix (with e \u2265 f , say) of polynomials\nRij (Y) \u2208 R[Y1 , . . . , Yn ]. We make the assumption on R that, whenever\ny = (y1 , . . . , yn ) \u2208 Rn is a vector with y 6= 0, at least one entry of R(y) is\nnon-zero. For a non-negative integer N and a vector yP N \u2208 (R/P N )n we\nsay that R(yP N ) has elementary divisor type m (written \u03bd(R(yP N )) = m)\nif m = (m1 , . . . , mf ), mi \u2208 [0, N ], m1 \u2264 * * * \u2264 mf , and there are matrices\n\u03b2 \u2208 GLe (R/P N ), \u03b3 \u2208 GLf (R/P N ) such that\n\uf8eb m\n\uf8f6\nq 1\n\uf8ec\n\uf8f7\n..\n\uf8ec\n\uf8f7\n.\n\u03b2R(yP N )\u03b3 \u2261 \uf8ec\n\uf8f7 mod P N .\nm\n\uf8ed\nq f \uf8f8\nFor m \u2208 Nf0 we set\nNN,R,m :=\n\no\nn\nyP N \u2208 (R/P N )n | yP N 6= 0, \u03bd(R(yP N )) = m .\n\nNote that NN,R,m = 0 unless 0 = m1 \u2264 * * * \u2264 mf \u2264 N (the necessity of\nm1 = 0 being a consequence of our assumption on R). Given, in addition,\na g \u00d7 h-submatrix S of R (WLOG g \u2265 h) defined by choosing g rows and h\ncolumns of R, and an h-tuple n we define\n\u001b\n\u001a\n\u03bd(R(yP N )) = m,\nN\nN n\nNN,R,S,m,n := yP \u2208 (R/P ) | y 6= 0,\n.\n\u03bd(S(yP N )) = n\nAgain, NN,R,S,m,n = 0 unless 0 = m1 \u2264 * * * \u2264 mf \u2264 N and n1 \u2264 * * * \u2264 nh .\nWe suppress the subscripts R and S if they are clear from the context.\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n19\n\nGiven complex variables r1 , . . . , rf , s1 , . . . , sh , we define the generating\nfunction\nP\nP\nX\nP (r, s) = PR,S,K (r, s) =\nNN,m,n q \u2212 i\u2208[f ] (N \u2212mi )ri \u2212 j\u2208[h] (N \u2212nj )sj .\nN \u2208N0\nm\u2208Nf0 ,n\u2208Nh\n0\n\nWe now assume that the matrix R is in fact defined over a number field F ,\nthat its entries are all homogeneous of the same degree and that the above\nassumption on R is satisfied for almost all completions K of F for which\nall Rij (Y) \u2208 RK [Y]. We consider such a 'good' completion K and drop\nthe subscript K. For i \u2208 [f ]0 , let \u03c1i denote the set of i-minors of R. The\npolynomials \u03c1i define the (rk \u2264 i \u2212 1)-locus (or i-th degeneracy locus) of\nR(Y). Similarly, let \u03c3 j , j \u2208 [h]0 , denote the set of j-minors of S. Let\nk := max{i \u2208 [f ]0 | (\u03c1i ) 6= (0)}\n\nand\n\nl := max{j \u2208 [h]0 | (\u03c3 j ) 6= (0)}.\n\nNote firstly that \u03c10 = \u03c3 0 = {1}, secondly that, by our assumption on R,\nk \u2265 1, thirdly that 0 \u2264 l \u2264 k and fourthly that P (r, s) is really a function in\nthe variables r1 , . . . , rk , s1 , . . . , sl :\nP\nP\nX\n(19)\nP (r, s) =\nNN,m,n q \u2212 \u03ba\u2208[k](N \u2212m\u03ba )r\u03ba \u2212 \u03bb\u2208[l] (N \u2212n\u03bb )s\u03bb\nN \u2208N0\nm\u2208Nk0 ,n\u2208Nl0\n\nwhere we set, given m = (m1 , . . . , mk ) and n = (n1 , . . . , nl ),\nNN,m,n := NN,(m1 ,...,mk ,N,...,N ),(n1 ,...,nl ,N,...,N ) .\nFor I \u2286 {1} and W = \u0393 = GLn (R) as above, consider the p-adic integral\n(20)\nZI (r, e\nr, s, e\ns, t) :=\n\nZ\n\n|x|I| |t\n\nP |I| \u00d7\u0393\n\nY\n\nY\n\nk\u03c1\u03ba (y1 ) \u222a x|I| \u03c1\u03ba\u22121 (y1 )kr\u03ba k\u03c1\u03ba\u22121 (y1 )kre\u03ba *\n\n\u03ba\u2208[k]\n\nk\u03c3 \u03bb (y1 ) \u222a x|I| \u03c3 \u03bb\u22121 (y1 )ks\u03bb k\u03c3 \u03bb\u22121 (y1 )kse\u03bb |dxI ||dy|,\n\n\u03bb\u2208[l]\n\nwhere y1 denotes the first column of the matrix y \u2208 \u0393.\nRemark 2.1. Whilst artificial, the formulation of ZI as an integral over\nP |I| \u00d7 \u0393 rather than over P |I| \u00d7 Rn \\ P n serves to make it fit the 'blueprint'\nTheorem 2.2 provided in the previous section.\nWe now set, for m = (m1 , . . . , mk ) \u2208 Nk0 , n = (n1 , . . . , nl ) \u2208 Nl0 and N \u2208 N\n\b\n\u03bcN,m,n = \u03bc (x, y) \u2208 P \u00d7 \u0393| v(x) = N, \u03bd(R(y1 P N )) = m, \u03bd(S(y1 P N )) = n\n\nand ZI (r, s, t) := ZI (r, \u2212r, s, \u2212s, t). Note that, by definition, \u03bcN,m,n = 0\nunless 0 \u2264 m1 \u2264 * * * \u2264 mk \u2264 N and n1 \u2264 * * * \u2264 nl \u2264 N . By definition of the\n\n\f20\n\nCHRISTOPHER VOLL\n\npolynomials \u03c1\u03ba , \u03c3 \u03bb , we have\nf\u2205(r, s, t) = 1),\nZ\u2205(r, s, t) = \u03bc(\u0393) (and thus, by (10), Z\nP\nP\nX\n\u03bcN,m,n q \u2212tN \u2212 \u03ba r\u03ba m\u03ba \u2212 \u03bb s\u03bb n\u03bb .\nZ{1} (r, s, t) =\n\n(21)\n(22)\n\nN \u2208N\nm\u2208Nk0 ,n\u2208Nl0\n\nTheorem 2.2 is applicable to ZI , I \u2286Q{1}, together\nQ with a principalisation\n(Y, h), h : Y \u2192 G/B, of the ideal I = \u03ba\u2208[k] (\u03c1\u03ba ) \u03bb\u2208[l] (\u03c3 \u03bb ). Indeed, B(F )invariance is a consequence of the fact that the entries of R were all assumed\nto be homogeneous of the same degree.\nThe following crucial lemma relates the numbers \u03bcN,m,n with the data\nNN,m,n we would like to capture:\nLemma 2.2. For N \u2208 N\nNN,m,n =\n\n(23)\nRecall that\n\nn\u0001\n1 q \u22121\n\nn\u0001\n1 q \u22121\n\n\u03bc(\u0393)\n\n\u03bcN,m,n q N (n+1) .\n\n= (1 \u2212 q \u2212n )/(1 \u2212 q \u22121 ).\n\nProof. Let \u0393{1},N denote the group\n(\n!)\n\u2217\n\u03b31\nq N \u2217 \u03b3n\u22121\nwhere \u03b3i stands for a matrix in \u0393i = GLi (R), \u2217 for an arbitrary matrix with\nentries in R, and q N \u2217 for a matrix of the appropriate size with entries in q N R,\nrespectively. Then the set\n\b\n(x, y) \u2208 P \u00d7 \u0393| v(x) = N, \u03bd(R(y1 P N )) = m, \u03bd(S(y1 P N )) = n\n\nmay be written as a disjoint union of the |\u0393 : \u0393{1},N | sets\n\b\n(x, y) \u2208 P \u00d7 \u03b3\u0393{1},N | v(x) = N, \u03bd(R(y1 P N )) = m, \u03bd(S(y1 P N )) = n\n\nwhere \u03b3 runs through a complete set of coset representatives of \u0393/\u0393{1},N . The\nmeasure of each of these sets is either zero or equals (1 \u2212 q \u22121 )q \u2212N \u03bc(\u0393{1},N ).\n\u2032\nThe latter happens NN,m,n\ntimes, where\no\nn\n\u2032\nNN,m,n\n= y1 \u2208 Pn\u22121 (R/P N )| y1 6= 0, \u03bd(R(y1 )) = m, \u03bd(S(y1 )) = n .\n\u2032\nClearly NN,m,n = (1 \u2212 q \u22121 )q N NN,m,n\n. Using the identity\n\u0012 \u0013\nn\n\u03bc(\u0393)/\u03bc(\u0393{1},N ) =\nq N (n\u22121)\n1 q\u22121\n\nwe obtain\n\u2032\n\u03bcN,m,n = NN,m,n\n(1 \u2212 q \u22121 )q \u2212N \u03bc(\u0393{1},N ) = NN,m,n\n\nas claimed.\n\n\u0001\n\n\u03bc(\u0393)\n\nn\nN (n+1)\n1 q \u22121 q\n\n\u0003\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\nLemma 2.2 yields\nf\u2205(\u2212r, \u2212s,\nP (r, s) \u2212 1 = P (r, s) \u2212 Z\n=\n\nX\n\nNN,m,n q \u2212\n\nX\n\nX\n\ns\u03bb \u2212 n \u2212 1)\n\u03bb\nP\n\u03ba\u2208[k] (N \u2212m\u03ba )r\u03ba \u2212 \u03bb\u2208[l] (N \u2212n\u03bb )s\u03bb\nr\u03ba +\n\n\u03ba\nP\n\n21\n\n(21)\n(19)\n\nN \u2208N\nm\u2208Nk0 ,n\u2208Nl0\n\n=\n\nn\u0001\n1 q \u22121\n\n*\n\u03bc(\u0393)\nX\n\n\u03bcN,m,n q N (n+1\u2212\n\nP\n\n\u03ba r\u03ba \u2212\n\nP\n\n\u03bb s\u03bb )+\n\nP\n\n\u03ba\n\nm\u03ba r\u03ba +\n\nP\n\n\u03bb\n\nn\u03bb s \u03bb\n\n(23)\n\nN \u2208N\nm\u2208Nf0 ,n\u2208Nh\n0\n\n=\n\nn\u0001\n1 q \u22121\n\n\u03bc(\u0393)\n\nZ{1} (\u2212r, \u2212s,\n\nX\n\u03ba\n\n= (1 \u2212 q \u2212n )Zg\n{1} (\u2212r, \u2212s,\n\nFrom Corollary 2.4 we deduce\n\nr\u03ba +\n\nX\n\u03ba\n\nX\n\u03bb\n\nr\u03ba +\n\ns\u03bb \u2212 n \u2212 1)\n\nX\n\ns\u03bb \u2212 n \u2212 1).\n\n(22)\n(10)\n\n\u03bb\n\nProposition 2.2. For all but finitely many completions K of F , the following\nfunctional equation holds:\nPR,S,K (r, s)|q\u2192q\u22121 = q n PR,S,K (r, s).\n3. Applications to zeta functions of groups and rings\n3.1. Zeta functions of rings. In this section we prove Theorem A. Let L be\na ring of torsion-free rank n. In fact, without loss of generality we may assume\nthat L is additively isomorphic to Zn . Let p be a prime. Multiplication in L is\na bi-additive mapping \u03b2 : Zn \u00d7Zn \u2192 Zn , which extends to \u03b2p : Znp \u00d7Znp \u2192 Znp ,\ninducing a Zp -algebra structure on Lp := L \u2297 Zp . We shall give a formula for\nthe local zeta functions\nX\n|Lp : H|\u2212s ,\n\u03b6L,p (s) =\nH\u2264Lp\n\nwhere H runs over the subalgebras of finite index in Lp , valid for almost all\nprimes p, in terms of the p-adic integrals studied in Section 2. More precisely,\ne\nwe shall show that \u03b6L,p (s) is expressible in terms of functions Z(s),\ndefined\nas in (16), to which Corollary 2.3 is applicable.\nWrite L = Zl1 \u2295 * * * \u2295 Zln . We consider the n \u00d7 n-matrix of Z-linear forms\nP\n\nR(y) = (Lij (y)) \u2208 Matn (Z[y]),\n\nwhere Lij (y) := k\u2208[n] \u03bbkij yk , encoding the structure constants \u03bbkij of L with\nP\nrespect to the chosen basis, that is li lj = k\u2208[n] \u03bbkij lk . Let Ci denote the\nmatrix of the linear map given by right-multiplication with the generator li .\nA full sublattice \u039b in (Lp , +) corresponds to a coset \u0393M , where \u0393 = \u0393n =\nGLn (Zp ) and the rows of the matrix M = (mij ) \u2208 GLn (Qp ) \u2229 Matn (Zp ),\n\n\f22\n\nCHRISTOPHER VOLL\n\nthe set of integral n \u00d7 n-matrices with non-zero determinant, encode the\ncoordinates of generators for \u039b with respect to the chosen basis. Denote by\nMi the i-th row of M . It is not hard to check (cf. the proof of [8, Theorem 5.5])\nthat \u039b is a Zp -subalgebra of Lp if and only if\nX\nCr mjr \u2208 hMk | k \u2208 [n]iZp .\n(24)\n\u2200i, j \u2208 [n] : Mi\nr\u2208[n]\n\nRather than trying to analyse the restrictions condition (24) imposes on the\nentries of suitable upper-triangular representatives of the coset \u0393M as in [8],\nwe base our analysis on the following two basic observations.\nThe first point is that every homothety class of lattices \u039b in (Lp , +) contains\na largest subalgebra \u039b0 , and the subalgebras in this class are exactly the\nmultiples pm \u039b0 , m \u2208 N0 . We thus have\nX\n|Lp : \u039b0 |\u2212s ,\n(25)\n\u03b6L,p (s) = (1 \u2212 p\u2212ns )\u22121\n[\u039b]\n\nwhere \u039b0 denotes the largest subalgebra in the homothety class [\u039b] = [\u039b0 ].\nThe second observation is that it is easy to check condition (24) if M\nhappens to be a diagonal matrix. With respect to the given basis, \u0393M may\nnot admit a diagonal representative. By the elementary divisor theorem,\nhowever, it does contain a representative of the form M = D\u03b1\u22121 , where\n\u03b1 \u2208 \u0393,\nD = D(I, r0 ) = pr0 diag(p\n|\n|\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\n,...,p\n{z\ni1\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\n}\n\n{z\nil\n\n, . . . , pril , . . . , pril , 1, . . . , 1)\n}\n\nfor a set I = {i1 , . . . , il }< \u2286 [n\u22121] and a vector (r0 , ri1 , . . . , ril ) =: r0 \u2208 N0 \u00d7Nl\n(both depending only on \u0393M ). We say that \u039b has type (I, r0 ). We call \u039b\nmaximal (in its homothety class) if r0 = 0. We say that the homothety class\n[\u039b] has type (I, r), r = (ri1 , . . . , ril ) \u2208 Nl , \u2013 written \u03bd([\u039b]) = (I, r) \u2013 if its\nmaximal element has type (I, (0, ri1 , . . . , ril )). By slight abuse of notation we\nmay also say that a lattice \u039b has type I if \u03bd([\u039b]) = (I, r) for some integral\nvector r, and that a homothety class [\u039b] has type I if any of its elements does.\nIn this case we write \u03bd([\u039b]) = I. We shall denote by \u03b1j the j-th column of\nthe matrix \u03b1 and by Dii the i-th diagonal entry of D. Note that \u03b1 is only\nunique up to right-multiplication by an element of\n\uf8f1\uf8eb\n\uf8f6\uf8fc\n\u03b3i1\n\u2217\n...\n\u2217\n\u2217\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8ec\n\uf8f4\n\uf8f4\n\uf8f7\uf8f4\n.\n.\n\uf8f4\nr\n.\n.\n\uf8f4\uf8ec\n\uf8f4\n\uf8f7\uf8f4\n.\np i1 \u2217\n\u03b3i2 \u2212i1\n.\n\uf8f4\n\uf8f2\uf8ec\n\uf8fd\n\uf8f7\uf8f4\n\uf8ec\n\uf8f7\n.\n.\nri2\n.\n.\n\u0393I,r := Stab\u0393 (\u0393D) = \uf8ec pri1 +ri2 \u2217\n.\np \u2217\n\u2217\n. \uf8f7\n\uf8ec\n\uf8f4\n\uf8f7\uf8f4\n\uf8f4\n\uf8ec\n\uf8f4\n\uf8f4\n\uf8f7\uf8f4\n.\n.\n\uf8f4\n.\n.\n\uf8f4\n\uf8f4\n\uf8ed\n\uf8f8\uf8f4\n.\n.\n\u03b3\n\u2217\n\uf8f4\n\uf8f4\ni\n\u2212i\nl\nl\u22121\n\uf8f4\n\uf8f4\n\uf8f3\n\uf8fe\nri1 +***+ril\nri2 +***+ril\nril\np\n\u2217 p\n\u2217 ...\np \u2217\n\u03b3n\u2212il\nwhere \u03b3\u03b9 stands for a matrix in \u0393\u03b9 , \u2217 for an arbitrary matrix with entries\nin Zp , and pr \u2217 for a matrix with entries in pr Zp of the appropriate sizes,\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n23\n\nrespectively. Thus there is a 1 \u2212 1-correspondence between lattice classes [\u039b]\nof type (I, (ri1 , . . . , ril )) and cosets \u03b1\u0393I,r . Furthermore\n(26)\n\u0012 \u0013\nP\nn\n|{[\u039b]| \u03bd([\u039b]) = (I, r)}| = |\u0393 : \u0393I,r | = \u03bc(\u0393)/\u03bc(\u0393I,r ) =\np \u03b9\u2208I r\u03b9 \u03b9(n\u2212\u03b9) ,\nI p\u22121\nwhere, as usual, \u03bc denotes the Haar measure on \u0393 normalised so that \u03bc(\u0393) =\n(1 \u2212 p\u22121 ) . . . (1 \u2212 p\u2212n ). As we have noted above it coincides with the additive\n2\nHaar measure on Matn (Zp ) \u223c\n= Znp , normalised so that \u03bc(Matn (Zp )) = 1.\nIt is now straightforward to check that (24) is equivalent to\n(27)\n\n\u2200i \u2208 [n] : DR<\n(i) (\u03b1)D \u2261 0\n\nmod Dii ,\n\n\u22121\ni\n\u22121 t\nwhere R<\n(i) (\u03b1) := \u03b1 R(\u03b1 )(\u03b1 ) . It is easy to verify that condition (27) is\nequivalent to\nr0 +\n\u2200i, r, s \u2208 [n] : (R<\n(i) (\u03b1))rs p\n\nP\n\ns\u2264\u03b9\u2208I\n\nr\u03b9 +\n\nP\n\nr\u2264\u03b9\u2208I\n\nr\u03b9 +\n\nP\n\ni>\u03b9\u2208I\n\nr\u03b9\n\n\u2261 0 mod p\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\nwhich may in turn be reformulated as\n(28)\n\uf8fc\n\uf8f1\n\uf8fd\n\uf8f2X\nX\nX\nX\nX\nr\u03b9 \u2212min\nr0 \u2265\nr\u03b9 + virs (\u03b1)| (i, r, s) \u2208 [n]3 ,\nr\u03b9 +\nr\u03b9 +\nr\u03b9 ,\n\uf8fe\n\uf8f3\n\u03b9\u2208I\ni>\u03b9\u2208I\nr\u2264\u03b9\u2208I\ns\u2264\u03b9\u2208I\n\u03b9\u2208I\n{z\n}\n|\n=:m([\u039b])\n\n\u0011\no\n\u0010\n|\u03b9\n\u2264\ni,\n\u03c1\n\u2265\nr,\n\u03c3\n\u2265\ns\n.\n(\u03b1))\nwhere virs (\u03b1) := min vp (R<\n\u03c1\u03c3\n(\u03b9)\nn\n\nRemark 3.1. Whilst it might seem more natural to replace the inequalities\nin this definition of virs (\u03b1) by equalities, the present formulation is preferable\nas it allows us to translate the counting problem into the language developed\nin Section 2.\nNote that the right hand side of (28) depends only on the homothety class\nof \u039b and is neatly separated in terms that depend on the type (I, r) of [\u039b] and\nterms that depend solely on \u03b1. The subalgebra \u039b0 is characterised by equality\nin (28). As we shall see, this formulation of the 'subalgebra condition' (24)\ntherefore enables us to express the p-th local zeta function of L in terms of\np-adic integrals on (pZp )|I| \u00d7 \u0393, I \u2286 [n \u2212 1].\nBy (25) it suffices to compute\nX\nX\nX\n(29)\nA< (s) :=\n|Lp : \u039b0 |\u2212s =\n|Lp : \u039b0 |\u2212s .\n[\u039b]\n\nI\u2286[n\u22121] \u03bd([\u039b])=I\n\nFor a fixed I = {i1 , . . . , il }< \u2286 [n \u2212 1], we set\n\n|\n\n{z\n\n=:A<\nI (s)\n\n<\nNI,r,m\n:= |{[\u039b]| \u03bd([\u039b]) = (I, r), m([\u039b]) = m}|\n\n}\n\n\f24\n\nCHRISTOPHER VOLL\n\nwith m([\u039b]) defined as in (28). Thus\nP\nP\nX\nX\n<\nA<\np\u2212s \u03b9\u2208I \u03b9r\u03b9\nNI,r,m\np\u2212sn( \u03b9\u2208I r\u03b9 \u2212m)\nI (s) =\n=\n\n(30)\n\nr=(ri1 ,...,ril )\u2208Nl\nP\nX\n\u2212s \u03b9\u2208I r\u03b9 (\u03b9+n)\n\np\n\nr\u2208Nl\n\nX\n\nm\u2208N0\n\n<\nNI,r,m\npsnm.\n\nm\u2208N0\n\nAs in the proof of Proposition 2.2 we shall design a p-adic integral to\ndescribe the generating functions A<\nI (s). Consider the p-adic integral ZI (s) =\nZW,Qp ,I (s1 , . . . , sn ) defined as in Section 2 with k = n, m = n2 , W = \u0393 and\nset\n3\nfirs (y) ={(R<\n(\u03b9) (y))\u03c1\u03c3 | \u03b9 \u2264 i, \u03c1 \u2265 r, \u03c3 \u2265 s}, (i, r, s) \u2208 [n] ,\n)\n!\n(\n[\nY \u03b4\u03b9\u2265r +\u03b4\u03b9\u2265s +\u03b4\u03b9<i\nY\nx\u03b9\nx\u03b9 \u222a\nfirs (y),\ngn,I (x, y) =\n\u03b9\u2208I\n\n(31)\n\ng\u03ba,I (x, y) =\n\n(\nY\n\nx\u03b4\u03b9 \u03b9\u03ba\n\n\u03b9\u2208I\n\n)\n\n(i,r,s)\u2208[n]3\n\n\u03b9\u2208I\n\n, \u03ba \u2208 [n \u2212 1].\n\nThe ideals (firs (y)) can easily be seen to be B(Qp )-invariant. Without loss of\ngenerality we may assume that none of them equals the zero ideal (otherwise\nwe just omit the respective ideal), and, by omitting at most finitely many\nprimes, we may assume that this also holds mod p. (Note that we may well\nhave to omit all the (firs (y)). This happens when the ring structure is trivial.)\nThus Theorems 2.2\nQ and 2.3 and their Corollaries apply to a principalisation\nfor the ideal I = irs (firs (y)) with good reduction mod p. Note that\nP\nX\nX\n\u2212sn m\n\u03bc<\n(32) ZI< (s) := ZI (s) = ZI ((s\u03b9 )\u03b9\u2208I , sn ) =\n,\np\u2212 \u03b9\u2208I s\u03b9 r\u03b9\nI,r,m p\nr\u2208Nl\n\nwhere\n\nm\u2208N0\n\nn\no\nl\n\u03bc<\n=\n\u03bc\n(x,\ny)\n\u2208\n(pZ\n)\n\u00d7\n\u0393|\nv\n(x\n)\n=\nr\n,\nm(x,\ny)\n=\nm\n,\np\np\n\u03b9\n\u03b9\nI,r,m\n\nwith\n\nm(x, y) :=\n\uf8fc\n\uf8f1\n\uf8fd\n\uf8f2X\nX\nX\nX\nmin\nvp (x\u03b9 ) +\nvp (x\u03b9 ) + virs (y)| (i, r, s) \u2208 [n]3 .\nvp (x\u03b9 ) +\nr\u03b9 ,\n\uf8fe\n\uf8f3\n\u03b9\u2208I\n\ni>\u03b9\u2208I\n\nr\u2264\u03b9\u2208I\n\ns\u2264\u03b9\u2208I\n\n<\nAgain we need a lemma to relate the numbers \u03bc<\nI,r,m to the data NI,r,m we\nare trying to understand.\n\nLemma 3.1.\n(33)\n<\nNI,r,m\n\n=\n\n\u03bc<\nI,r,m\n(1 \u2212 p\u22121 )l p\u2212\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\n\u03bc(\u0393I,r )\n\n=\n\n(1\n\nn\u0001\nP\nI p\u22121\n<\n\u03b9\u2208I r\u03b9 (\u03b9(n\u2212\u03b9)+1) .\n\u03bc\np\nI,r,m\n\u2212 p\u22121 )l \u03bc(\u0393)\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\nProof. The set\n\nn\n\n(x, y) \u2208 (pZp )l \u00d7 \u0393| vp (x\u03b9 ) = r\u03b9 , m(x, y) = m\n\n25\n\no\n\nmay be written as a disjoint union of the |\u0393 : \u0393I,r | sets\nn\no\n(x, y) \u2208 (pZp )l \u00d7 \u03b3\u0393I,r | vp (x\u03b9 ) = r\u03b9 , m(x, y) = m\n\nwhere \u03b3 runs through a complete set of coset representatives forP\u0393/\u0393I,r . The\nmeasure of each of these sets is either zero or equal to (1\u2212p\u22121 )l p\u2212 \u03b9\u2208I r\u03b9 \u03bc(\u0393I,r ).\nThe latter happens if and only if \u03b3\u0393I,r corresponds to a lattice of type (I, r)\nsuch that m([\u039b]) = m. This proves the first equality. The second equality is\nan immediate consequence of (26).\n\u0003\nLemma 3.1 allows us to express the generating functions (30) in terms of\nthe p-adic integrals (32). Indeed,\nA<\nI (s) =\n\nX\n\nr\u2208Nl\n\n=\n\n(1\n\np\u2212s\n\u0001\n\nP\n\n\u03b9\u2208I\n\nr\u03b9 (\u03b9+n)\n\nn\nI p\u22121\n\u2212 p\u22121 )l \u03bc(\u0393)\n\nX\n\n<\nNI,r,m\npsnm\n\n(30)\n\nm\u2208N0\n\nX\n\np\u2212\n\nP\n\nr\nn\u0001\nI p\u22121\nZ < ((s(\u03b9\n\u2212 p\u22121 )l \u03bc(\u0393) I\n\n\u03b9\u2208I\n\nr\u03b9 (s(\u03b9+n)\u2212\u03b9(n\u2212\u03b9)\u22121)\n\nX\n\nsnm\n\u03bc<\n(33)\nI,r,m p\n\nm\n\n+ n) \u2212 \u03b9(n \u2212 \u03b9) \u2212 1)\u03b9\u2208I , \u2212sn)\n(1\n\u0012 \u0013\nn\n=\nZf< ((s(\u03b9 + n) \u2212 \u03b9(n \u2212 \u03b9) \u2212 1)\u03b9\u2208I , \u2212sn).\nI p\u22121 I\n=\n\n(32)\n(10)\n\nTheorem A follows now from equations (25) and (29), and Corollary 2.3.\n3.2. Conjugacy zeta functions of nilpotent groups. In this section we\nprove Theorem B. As mentioned in the introduction, it suffices to compute\nX\ncc\n|Lp : H|\u2212s |Lp : NLp (H)|\u22121\n(34)\n\u03b6L,p\n(s) =\nH\u2264Lp\n\nfor almost all primes p, where L = L(G), Lp = L \u2297 Zp and NLp (H) = {l \u2208\nLp | [H, l] \u2264 H} is the normaliser of H in Lp .\nRemark 3.2. It was pointed out, e.g. in [34, Section 3.8], that, whilst (34)\nmight be used to define local 'conjugacy' zeta functions for arbitrary rings,\nthey might not encode the solutions to any actual counting problem unless\nLp = L \u2297 Zp for a nilpotent Lie ring L. It is for that reason that we formulate Theorem B in terms of T -groups G, bearing in mind that its proof is\nimmediately reduced to a computation in the Lie ring L(G) that draws upon\nneither the nilpotency nor the Lie property of L(G).\nAlong the lines of the 'first observation' in the proof of Theorem A we use\nthe fact that, for a subring H of Lp , the normaliser NLp (H) is an invariant\n\n\f26\n\nCHRISTOPHER VOLL\n\nof the homothety class [H] of H. We may thus write NLp ([H]) for NLp (H).\nResuming the notation of the proof of Theorem A we have\n(35)\n\nLp \u2265 NLp ([H]) \u2265 \u039b0 \u2265 p\u039b0 \u2265 p2 \u039b0 \u2265 . . .\n\n(H \u2208 {pm \u039b0 | m \u2208 N0 }). In addition to recording the index |Lp : \u039b0 | as we\nrun over homothety classes [\u039b] of lattices in Qnp , we now have to control the\nindex |Lp : NLp ([\u039b])|. We shall see that this index, too, might be expressed\nin terms of congruences involving the type (I, r) and coset \u03b1\u0393I,r determining\n[\u039b] = [\u039b0 ], similar to the congruences (27). To compute their index requires\nus to control the elementary divisors of certain matrices. A similar problem\nwas considered in Section 2.2; the problem we will have to solve in Section 3.3\nis also of this kind (though slightly simpler). We resume the notation from\nSection 3.1. From (35) we deduce\nX\ncc\n|Lp : \u039b0 |\u2212s |Lp : NLp ([\u039b])|\u22121 .\n\u03b6L,p\n(s) = (1 \u2212 p\u2212ns )\u22121\n[\u039b]\n\nUsing a fixed basis to identify Lp with Znp we may express the condition\nx \u2208 NLp ([H]) in a similar fashion to (24). If M is any matrix whose rows\nMk encode the coordinates of generators for any element of [\u039b], a vector\nx = (x1 , . . . , xn ) \u2208 Znp is in NLp ([\u039b]) if and only if\nX\n(36)\n\u2200i \u2208 [n] : x\nCr mir \u2208 hMk | k \u2208 [n]iZp .\nr\u2208[n]\n\nUsing the correspondence between lattice classes and pairs ((I, r), \u03b1\u0393I,r ), condition (36) may be reformulated as\n(37)\n\n\u2200i \u2208 [n] : xRcc\n(i) (\u03b1)D \u2261 0 mod Dii ,\n\ni\n\u22121 t\nr0\nwhere Rcc\n(i) (\u03b1) := R(\u03b1 )(\u03b1 ) and D = D(I, r). We note that the scalar p\nin D cancels in (37); we may thus assume r0 = 0. Condition (37) is then\nequivalent to\n\n(38)\n\n\u2200i \u2208 [n] : xRcc\n(i) (\u03b1)Dp\n\nP\n\n\u03b9<i r\u03b9\n\n\u2261 0 mod p\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\n.\n\nSetting\ncc\nRcc (\u03b1) = (Rcc\n(1) (\u03b1)| . . . |R(n) (\u03b1)),\n\nDcc (I, r) = diag(D, . . . , D , pri1 D, . . . , pri1 D, . . . , p\n|\n{z\n}\n| {z } |\ni1\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\ni2 \u2212i1\n\nn2\n\nD, . . . , p\n{z\nn\u2212il\n\nn2 -matrix\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\nD ),\n}\n\n(where 'diag' refers to the diagonal\n\u00d7\nbuilt from n scalar multiples of the diagonal n \u00d7 n-matrix D), (38) may in turn be reformulated\nas\n(39)\n\nxRcc (\u03b1)Dcc (I, r) \u2261 0\n\nmod p\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\nTo keep track of the index of NLp ([\u039b]), the full sublattice of Lp \u223c\n= Znp of\ncc\nn\nsolutions to (39), we introduce an invariant \u03bd ([\u039b]) \u2208 N0 as follows. We say\nthat \u03bd cc ([\u039b]) = m = (m1 , . . . , mn ) \u2208 Nn0 if\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n27\n\n\u2022 the matrix Rcc (\u03b1)Dcc (I, r) has elementary divisor type\ne = (m\nm\ne 1, . . . , m\ne n)\n\n(i.e. there are matrices\u0001 \u03b2 \u2208 \u0393n , \u03b3 \u2208 \u0393n2 such that \u03b2Rcc (\u03b1)Dcc (I, r)\u03b3 =\ne 1 , . . . , pm\ne n )|0 and m\ne i \u2208 N0 \u222a {\u221e}, m\ne\b1 \u2264 * * * \u2264 m\ne n ) and\ndiag(pm\nP\nfor each\n\u2022 m = (m1 , . . . , mn ) is defined by mi = min\nr\n,\nm\ne\ni\n\u03b9\u2208I \u03b9\ni \u2208 [n].\nThe index |Lp : NLp ([\u039b])| equals\np\n\nP\n\ni\u2208[n]\n\nP\n\n(\n\n\u03b9\u2208I\n\nr\u03b9 \u2212mi )\n\n.\n\nAs in Section 3.1 it is helpful to write\nX\nAcc (s) :=\n|Lp : \u039b0 |\u2212s |Lp : NLp ([\u039b])|\u22121\n[\u039b]\n\n=\n\nX\n\nX\n\n|Lp : \u039b0 |\u2212s |Lp : NLp ([\u039b])|\u22121 .\n\nI\u2286[n\u22121] \u03bd([\u039b])=I\n\n|\n\n{z\n\n}\n\n=:Acc\nI (s)\n\nFor a fixed I = {i1 , . . . , il }< \u2286 [n \u2212 1], we set\n\ncc\nNI,r,m,m\n:= |{[\u039b]| \u03bd([\u039b]) = (I, r), m([\u039b]) = m, \u03bd cc ([\u039b]) = m}|\n\nwith m([\u039b]) defined as in (28). We thus have\nAcc\nI (s)\n=\n\nX\n\np\u2212s\n\nP\n\nr\u2208Nl\n\n(40)\n\n=\n\nX\n\nr\u2208Nl\n\np\n\nP\n\n\u03b9\u2208I\n\n\u03b9\u2208I\n\n\u03b9r\u03b9\n\nX\n\nP\n\ncc\nNI,r,m,m\np\u2212sn(\n\nm\u2208N0\nm\u2208Nn\n0\nr\u03b9 (\u2212s(\u03b9+n)\u2212n)\n\nX\n\n\u03b9\u2208I\n\nr\u03b9 \u2212m)\u2212\n\ncc\nNI,r,m,m\npsnm+\n\nP\n\nP\n\nP\n\ni\u2208[n] (\n\ni\u2208[n]\n\nmi\n\n\u03b9\u2208I\n\nr\u03b9 \u2212mi )\n\n.\n\nm\u2208N0\nm\u2208Nn\n0\n\nAs in Section 3.1 we shall show that the generating functions Acc\nI (s) may be\nexpressed in terms of the p-adic integrals to which the results of Section 2 may\nbe applied. In order to control the invariant \u03bd cc ([\u039b]) we need to parametrise\nthe minors of the matrix Rcc (y) in a suitable way. This motivates the following combinatorial definitions.\nLet Matn ({0, 1}) denote the P\nset of n \u00d7 n-matrices with entries in {0, 1},\ncc\nand Sj,n = {S \u2208 Matn ({0, 1})| r,s Srs = j}. We introduce a partial order\ncc by saying that, given S, T \u2208 S cc , T \u0016 S if,\non Sj,n\nj,n\nP\nP\nP\nP\nfor all r \u2208 [n]:\nT\n\u2265\nS\u03c1\u03c3 and,\n\u03c1\u03c3\n\u03c1\u2264r\n\u03c3\u2208[n]\n\u03c1\u2264r\nP\nP\nP\nP\u03c3\u2208[n]\nfor all s \u2208 [n]:\n\u03c3>s\n\u03c1\u2208[n] S\u03c1\u03c3 .\n\u03c3>s\n\u03c1\u2208[n] T\u03c1\u03c3 \u2265\nPictorially speaking, this amounts to saying that the matrix T may be obtained from the matrix S by moving some of the non-zero entries towards\ncc and a n\u00d7n2 -matrix M = (M | . . . |M ),\n'north-east'. Given a matrix S \u2208 Sj,n\n1\nn\nMi \u2208 Matn (Zp ), a j \u00d7 j-submatrix of M of column-type S is a submatrix obtained by choosing j rows of M and the s-th column of Mr if and only if\n\n\f28\n\nCHRISTOPHER VOLL\n\ncc , we set\nSrs = 1. For S \u2208 Sj,n\n(41)\ncc\nfj,S\n(y) = {det(N )| N a j \u00d7 j-submatrix of Rcc (y) of column-type T \u0016 S}\n\nand define the monomial\ncc\nMS,I\n(x) =\n\nY\n\nP\n\nx\u03b9\n\n\u03c1>\u03b9\n\nPn\n\n\u03c3=1 S\u03c1\u03c3 +\n\nP\n\n\u03c3\u2264\u03b9\n\nPn\n\n\u03c1=1\n\nS\u03c1\u03c3\n\n.\n\n\u03b9\u2208I\n\nWe set\ncc\nfj,I\n(x, y) =\n\n[\n\ncc\ncc\nMS,I\n(x)fj,S\n(y).\n\ncc\nS\u2208Sj,n\n\nNow we define, using the sets of polynomials g\u03ba,I (x, y) introduced in (31),\nZ\nY\ncc\ne\nkg\u03ba,I (x, y)ks\u03ba *\ns) =\ns, e\nZI (s, e\n(pZp )l \u00d7W \u03ba\u2208[n]\n\n(42)\n\nY\n\ncc\nkfj,I\n(x, y)\n\n\u222a\n\nY\n\u03b9\u2208I\n\nj\u2208[n]\n\nx\u03b9\n\n!\n\ne\ncc\ncc\nfj\u22121,I\n(x, y)ksej kfj\u22121,I\n(x, y)ksej\n\n!\n\n|dxI ||dy|.\n\ncc (x)|M cc (x) if T \u0016 S. We therefore could have\nRemark 3.3. Note that MT,I\nS,I\nkept definition (41) simpler by replacing 'T \u0016 S' by 'S', without changing the\nintegral ZIcc . The extra complication ensures that the results from Section 2\nare applicable.\ncc ,\nWe leave it to the reader to verify that, for each j \u2208 [n] and S \u2208 Sj,n\ncc (y)) is B(Q )-invariant. Therefore the Theorems 2.2 and 2.3\nthe ideal (fj,S\np\ne\ns). Note that\nand their corollaries are applicable to the integral ZIcc (s, e\ns, e\ncc\ncc\ne\ne\nZ (s, e\ns, e\ns) = Z ((s\u03b9 )\u03b9\u2208I , sn , e\ns, e\ns). We set\nI\n\n\u03bccc\nI,r,m,m\n\nI\n\n= \u03bc{(x, y) \u2208 (pZp )l \u00d7 W |\u03bdp (x\u03b9 ) = r\u03b9 , m(x, y) = m, \u03bd cc (x, y) = m}.\n\nHere \u03bd cc (x, y) = m = (m1 , . . . , mn ) if, for each i \u2208 [n],\n)\n(\nX\nvp (x\u03b9 ), m\nei ,\nmi = min\n\u03b9\u2208I\n\ne = (m\nwhere m\ne 1, . . . , m\ne n ) is the elementary divisor type of the matrix\nRcc (y)Dcc (I, (vp (x\u03b9 ))\u03b9\u2208I ).\n\nThen\nZIcc ((s\u03b9 )\u03b9\u2208I , sn , e\ns) := ZIcc ((s\u03b9 )\u03b9\u2208I , sn , e\ns, \u2212e\ns)\nP\nP\nX\nX\n\u2212sn m\u2212 i\u2208[n] e\nsi mi\n\u2212 \u03b9\u2208I s\u03b9 r\u03b9\n=\n\u03bccc\n.\np\nI,r,m,m p\nr\u2208Nl\n\nm\u2208N0\nm\u2208Nn\n\ncc\nAs in (33) we want to relate the numbers \u03bccc\nI,r,m,m with the integers NI,r,m,m .\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\nLemma 3.2.\ncc\nNI,r,m,m\n\n(43)\n\n=\n\n(1 \u2212\n\n29\n\nn\u0001\nP\nI p\u22121\ncc\n\u03b9\u2208I r\u03b9 (\u03b9(n\u2212\u03b9)+1) .\n\u03bc\np\nI,r,m,m\np\u22121 )l \u03bc(\u0393)\n\nProof. Analogous to the proof of Lemma 3.1.\n\n\u0003\n\nThus\nAcc\nI (s)\n=\n\nX\n\np\n\nP\n\n\u03b9\u2208I\n\nr\u03b9 (\u2212s(\u03b9+n)\u2212n)\n\nr\u2208Nl\n\n=\n\n(1 \u2212\n\nn\u0001\nI p\u22121\n*\np\u22121 )l \u03bc(\u0393)\nX P\n\np\n\nX\n\ncc\nNI,r,m,m\npsnm+\n\n(1 \u2212\n\ni\u2208[n]\n\nmi\n\n(40)\n\nm\u2208N0 ,\nm\u2208Nn\n0\n\n\u03b9 r\u03b9 (\u2212s(\u03b9+n)+\u03b9(n\u2212\u03b9)+1\u2212n)\n\nX\n\nsnm+\n\u03bccc\nI,r,m,m p\n\nP\n\ni\u2208[n]\n\nmi\n\n(43)\n\nm,m\n\nr\u2208Nl\n\n=\n\nP\n\nn\u0001\nI p\u22121\n*\np\u22121 )l \u03bc(\u0393)\n\nZIcc ((s(\u03b9 + n) \u2212 \u03b9(n \u2212 \u03b9) \u2212 1 + n)\u03b9\u2208I , \u2212sn, \u22121, . . . , \u22121)\n\u0012 \u0013\nn\ncc ((s(\u03b9 + n) \u2212 \u03b9(n \u2212 \u03b9) \u2212 1 + n)\ng\n=\nZ\n\u03b9\u2208I , \u2212sn, \u22121, . . . , \u22121).\nI p\u22121 I\n\n(42)\n(10)\n\nTheorem B now follows from Corollary 2.3.\n\n3.3. Normal zeta functions of class-2-nilpotent groups. In this section\nwe prove Theorem C. Let G be a T2 -group as in the statement of the theorem.\nWithout loss of generality we may assume that G/Z(G) and Z(G) are torsionfree abelian groups of rank d and d\u2032 , respectively (so n = d + d\u2032 ), and that G\nadmits a presentation\nX\n\u03bbkij hk , \u03bbkij \u2208 Z, all other [ , ] triviali.\nG = hg1 , . . . , gd , h1 , . . . , hd\u2032 | [gi , gj ] =\nk\u2208[d]\n\n(Note that we used additive notation for expressions in the abelian group G\u2032 .)\nThus we obtain a matrix\n\nM(y) := (Lij (y)) \u2208 Matd (Z[y])\nP\nof linear forms Lij (y) := k\u2208[d] \u03bbkij yk , encoding the commutator structure of\nG. By disregarding at most finitely many further primes we may also assume\n\u2032\n\u2032\nthat p does not divide M(\u03b1) whenever \u03b1 \u2208 Zdp \\ pZdp .\nWe begin our argument as in [31, Section 3], albeit with slightly different\nnotation. Note, however, that we do not require the assumption that Z(G) =\nG\u2032 . By [31, Lemma 1] and its corollary, it suffices to compute a functional\nequation for the generating function\nX\nA\u22b3 (s) =\nA\u22b3I (s),\nI\u2286[d\u2032 \u22121]\n\n\f30\n\nCHRISTOPHER VOLL\n\nwhere\n\nX\n\nA\u22b3I (s) =\n\n|Z(Lp ) : \u039b|d\u2212s |Lp : X(\u039b)|\u2212s .\n\n\u03bd([\u039b])=I\n\nHere the sum ranges over homothety classes of maximal lattices \u039b of type2 I\nin the centre Z(Lp ) of the Zp -algebra\nLp := (G/Z(G) \u2295 Z(G)) \u2297 Zp ,\n\u2032\n\nand X(\u039b)/\u039b = Z(Lp /\u039b). We identify Z(Lp ) with Zdp using the basis {h1 , . . . , hd\u2032 }.\nThe index |Lp : X(\u039b)| is the index in Lp /Z(Lp ) \u223c\n= Zdp of a system of linear\ncongruences which we now describe (cf. [30, \u00a72.2]). Let [\u039b] be of type (I, r),\nI = {i1 , . . . , il }< \u2286 [d\u2032 \u2212 1], r = (ri1 , . . . , ril ) \u2208 Nl , corresponding to the coset\n\u03b1\u0393I,r \u2208 \u0393d\u2032 /\u0393I,r as in the proof of Theorem A. We set\n\u0011\n\u0010\n\u22b3\n1\nd\u2032\n(44)\nM (\u03b1) = M(\u03b1 )| . . . |M(\u03b1 ) ,\nD\u22b3 (I, r) = diag(1, . . . , 1, pri1 , . . . , pri1 , . . . , p\n|\n{z\n}\n| {z } |\ndi1\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\nd(d\u2032 \u2212il )\n\nd(i2 \u2212i1 )\n\nThe system of linear congruences under consideration is\nxM\u22b3 (\u03b1)D\u22b3 (I, r) \u2261 0\n\n(45)\n\nmod p\n\nP\n\n,...,p\n{z\n\n\u03b9\u2208I\n\nr\u03b9\n\nP\n\n\u03b9\u2208I\n\nr\u03b9\n\n).\n}\n\n.\n\nThe solutions to this system form a full lattice in Lp /Z(Lp ). To keep track\nof its index we define the invariant \u03bd \u2032 ([\u039b]) \u2208 Nd0 as follows. We say that\n\u03bd \u2032 ([\u039b]) = m = (m1 , . . . , md ) if\n\u2022 the matrix M\u22b3 (\u03b1)D\u22b3 (I, r) has elementary divisor type\ne = (m\nm\ne 1, . . . , m\ne d)\n\nand\nP\ne i } for each\n\u2022 m = (m1 , . . . , mn ) is defined by mi = min{ \u03b9\u2208I r\u03b9 , m\ni \u2208 [n].\nThe index of the system (45) equals\np\n\nP\n\nj\u2208[d]\n\nP\n\n(\n\n\u03b9\u2208I\n\nr\u03b9 \u2212mj )\n\n.\n\nBy defining\n\u22b3\nNI,r,m\n:= |{[\u039b]| \u03bd([\u039b]) = (I, r), \u03bd \u2032 ([\u039b]) = m}|\n\u22b3\n(note that NI,r,m\n6= 0 implies m1 = 0, as p 6 |M\u22b3 (\u03b1)) we obtain a formula for\nA\u22b3I (s) that is analogous to (30):\nP\nP\nP\nX\nX\n\u22b3\nA\u22b3I (s) =\nNI,r,m\np\u2212s j\u2208[d] ( \u03b9\u2208I r\u03b9 \u2212mj )\np(d\u2212s) \u03b9\u2208I r\u03b9 \u03b9\nr\u2208Nl\n\n(46)\n\n=\n\nX\nr\n\np\n\nP\n\n\u03b9\u2208I\n\nm\u2208Nd0\n\nr\u03b9 (\u2212s(d+\u03b9)+\u03b9d)\n\nX\n\n\u22b3\nNI,r,m\nps\n\nP\n\nj\u2208[d]\n\nmj\n\n.\n\nm\n\n2Note that the definition of a lattice's type given in [31] differs from the one in the\n\ncurrent paper in so far as I is replaced by d\u2032 \u2212 I = {d\u2032 \u2212 i| i \u2208 I}.\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n31\n\nAs in Section 3.1 we shall show that the generating function A\u22b3I (s) may be\nexpressed in terms of a p-adic integral to which the results of Section 2 can\nbe applied. We shall need some more notation.\nGiven the d \u00d7 dd\u2032 -matrix M = (M1 | . . . |Md\u2032 ), Mi \u2208 Matd (Zp ), a j \u00d7 j\u2032 P\nsubmatrix of M of column-type S = (\u03c31 , . . . , \u03c3d\u2032 ) \u2208 Nd0 , i\u2208[d\u2032 ] \u03c3i = j, is a\nsubmatrix obtained by choosing j rows of M and \u03c3i columns\nP in the 'block'\n\u22b3 = {(\u03c3 , . . . , \u03c3 \u2032 )|\nMi for each i \u2208 [d\u2032 ]. We denote by Sj,d\n\u2032\n1\nd\ni\u2208[d\u2032 ] \u03c3i = j} the\n\u22b3 , we write\nset of possible such column-types. Given S = (\u03c3i ), T = (\u03c4i ) \u2208 Sj,d\n\u2032\nP\nP\n\u2032\n\u22b3\nT \u0016 S if, for all i \u2208 [d ], \u03b9\u2264i \u03c4\u03b9 \u2265 \u03b9\u2264i \u03c3\u03b9 . For S \u2208 Sj,d\u2032 , we set\n(47)\n\u22b3\nfj,S\n(y) = {det(N )| N a j \u00d7 j-submatrix of M(y) of column-type T \u0016 S}.\nP\nQ\n\u2032 \u03c3\u03ba\n\u22b3\nWe define the monomial MS,I (x) = \u03b9\u2208I x\u03b9 \u03b9<\u03ba\u2208[d ] and set\n[\n\u22b3\n\u22b3\n\u22b3\n(x, y) =\nfj,I\nMS,I\n(x)fj,S\n(y).\n\u22b3\nS\u2208Sj,d\n\u2032\n\nWe are now ready to define\nZI\u22b3 (t, s, e\ns)\nY\n\n=\n\nZI\u22b3 ((t\u03b9 )\u03b9\u2208I , s2 , . . . , sd , se2 , . . . , sed )\n\n\u22b3\nkfj,I\n(x, y)\n\n\u222a\n\nY\n\u03b9\u2208I\n\nj\u2208[2,d]\n\nx\u03b9\n\n!\n\n=\n\nZ\n\nY\n\n(pZp )l \u00d7W \u03b9\u2208I\n\n\u22b3\n\u22b3\nfj\u22121,I\n(x, y)ksj kfj\u22121,I\n(x, y)ksej\n\n|x\u03b9 |t\u03b9 *\n!\n\n|dxI ||dy|.\n\n\u22b3 (x)|M \u22b3 (x) if T \u0016 S. We could have kept\nRemark 3.4. Note that MT,I\nS,I\ndefinition (47) simpler by replacing 'T \u0016 S' by 'S'. The extra complication\nensures that the results from Section 2 are applicable. Note also that we\n\u22b3 (x, y)k =\nare not losing anything by omitting the factor for j = 1, as kf0,I\n\u22b3 (x, y)k = 1 for all x \u2208 (pZ )l , y \u2208 W .\nkf1,I\np\n\u22b3 ,\nWe leave it to the reader to verify that, for each j \u2208 [d] and S \u2208 Sj,d\n\u2032\n\u22b3\nthe ideal (fj,S (y)) is B(Qp )-invariant. Therefore Theorems 2.2, 2.3 and their\ncorollaries are applicable. We set\n\n\u03bc\u22b3I,r,m = \u03bc{(x, y) \u2208 (pZp )l \u00d7 W | vp (x\u03b9 ) = r\u03b9 , \u03bd \u2032 (x, y) = m},\nP\ne where m\ne\nwhere \u03bd \u2032 (x, y) = m = (m1 , . . . , md ) \u2208 Nd0 if m = min{ \u03b9\u2208I r\u03b9 , m}\nis the elementary divisor type of the matrix M\u22b3 (y)D\u22b3 (I, (vp (x\u03b9 ))\u03b9\u2208I ). Note\nthat \u03bc\u22b3I,r,m 6= 0 implies m1 = 0. Then\n(48)\nP\nP\nX\nX\nZI\u22b3 ((t\u03b9 )\u03b9\u2208I , s) := ZI\u22b3 ((t\u03b9 )\u03b9\u2208I , s, \u2212s) =\n\u03bc\u22b3I,r,mp\u2212 j\u2208[2,d] sj mj .\np\u2212 \u03b9\u2208I t\u03b9 r\u03b9\nr\u2208Nl\n\nLemma 3.3.\n(49)\n\n\u22b3\nNI,r,m\n=\n\n(1 \u2212\n\nm\u2208Nd0\n\nd\u2032 \u0001\nP\n\u2032\nI p\u22121\n\u22b3\n\u03b9\u2208I r\u03b9 (\u03b9(d \u2212\u03b9)+1) .\n\u03bc\np\nI,r,m\n\u22121\nl\np ) \u03bc(\u0393)\n\n\f32\n\nCHRISTOPHER VOLL\n\nProof. Analogous to the proof of Lemma 3.1.\n\n\u0003\n\nThus\nA\u22b3I (s)\n=\n\nX\n\np\n\nr\n\n=\n\n(1 \u2212\n\nP\n\n\u03b9\u2208I\n\nr\u03b9 (\u2212s(d+\u03b9)+\u03b9d)\n\nd\u2032 \u0001\nI p\u22121\n*\np\u22121 )l \u03bc(\u0393)\nX P\n\np\n\n\u0001\n\n\u03b9\u2208I\n\nX\n\n\u22b3\nNI,r,m\nps\n\nP\n\nj\u2208[d]\n\nmj\n\n(46)\n\nm\n\nr\u03b9 (\u2212s(d+\u03b9)+\u03b9(d\u2032 +d\u2212\u03b9)+1)\n\nr\n\nd\u2032\nI p\u22121\nZI ((s(d\np\u22121 )l \u03bc(\u0393)\n\nX\n\n\u03bc\u22b3I,r,m(p\u2212s )\u2212\n\nP\n\nj\u2208[d]\n\nmj\n\n(49)\n\nm\n\n=\n+ \u03b9) \u2212 \u03b9(d + d\u2032 \u2212 \u03b9) \u2212 1)\u03b9\u2208I , \u2212s, . . . , \u2212s)\n(1 \u2212\n\u0012 \u2032\u0013\nd\nfI ((s(d + \u03b9) \u2212 \u03b9(d + d\u2032 \u2212 \u03b9) \u2212 1)\u03b9\u2208I , \u2212s, . . . , \u2212s).\nZ\n=\nI p\u22121\n\n(48)\n(10)\n\nTheorem C now follows from Corollary 2.3.\n\n3.4. Representation zeta functions of T -groups. In this section we recall some of Howe's work [16] on irreducible representations of T -groups and\nco-adjoint orbits and prove Theorem D.\nIf G is a group and H \u2264 G is a subgroup we say that H is saturated if\ngn \u2208 H implies g \u2208 H for all g \u2208 G. Denote by Hs the smallest saturated\nsubgroup of G containing H (this is called the isolator of H in [26, Chapter 8,\nSection A]). Clearly, if H \u22b3 G, H = Hs if and only if G/H is torsion-free.\nNow let G be a T -group. Recall (cf., for example, [26, Chapter 6]) that,\nby the Malcev correspondence, there is a Lie algebra LG (Q) over Q, of dimension equal to h(G), the Hirsch length of G, and an injective mapping\nlog : G \u2192 LG (Q), such that spanQ (log(G)) = LG (Q). In general L := log(G)\nwill fail to be a Lie subring (or even just a lattice). However, by replacing G\nby a subgroup of finite index, if necessary, we may assume it is a Lie subring ([14], Section 4) and even that [L, L] \u2286 c!L, where c is the nilpotency\nclass of L (or G), i.e. that L (and G) are elementarily exponentiable (e.e.) in\nirr (s) for all but finitely\nHowe's nomenclature. As we are looking to study \u03b6G,p\nmany primes, there is no harm in descending to a subgroup H of finite index\nin G. Indeed, for all p and all n, there is a 1 \u2212 1 \u2013 correspondence between\ntwist isoclasses of irreducible characters of degree pn and p-admissible twist\nbp , the pro-p-completion of G ([17], Lemma 8.5).\nisoclasses of degree pn of G\n\u223c\nb\nb\nHowever, Gp = Hp if p 6 | |G : H|.\nFor a T -group G, denote by (G(i) ) the group's lower central series, defined\nby G(1) = G, G(i+1) = [G(i) , G], i \u2265 2. We say that G 6= {1} has nilpotency\nclass c (or is step-c-nilpotent) if G(c) 6= {1} but G(c+1) = {1}. Similarly,\nwe denote by (L(i) ) the lower central series of the Lie algebra L, defined\nby L(1) = L, L(i+1) = [L(i) , L], i \u2265 2, and we hope that there will be no\nconfusion between group commutators and Lie brackets. It is well-known\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n33\n\nthat log induces a bijection between L(i) and G(i) , i \u2208 [c]. We write G\u2032 for\nG(2) , and L\u2032 for L(2) . By Z(L) we denote the centre of L.\nc and\nFor a sublattice M \u2286 L = log(G), denote its dual Hom(M, C\u2217 ) by M\nb\u2192M\nc, \u03c8 7\u2192 \u03c8|M the restriction to M . We say that \u03c8 \u2208 L\nb is rational\nby rM : L\non M if rM (\u03c8) is a torsion element. Clearly \u03c8 is rational on M if and only\nif \u03c8 is rational on Ms if and only if \u03c8(nM ) = 1 for some n \u2208 N.\nRecall that the adjoint action Ad of G on L is given by\n(50)\n\nl 7\u2192 l + [log \u03b3, l] + (higher terms),\n\nwhere we omitted Lie terms of degree \u2265 3. These may be computed in terms\nof the Baker-Campbell-Hausdorff-formula. This element F (X, Y ) \u2208 Lb{X,Y } ,\nthe completion of the free Lie algebra on the symbols X and Y , provides the\nsolution to\nexp(F (x, y)) = exp(x) exp(y).\nThe Baker-Campbell-Hausdorff-formula allows us therefore to recover the\ngroup structure on the Lie algebra (cf. [20, Chapter 9] and [27, V.3.4 and\nb is thus given by\nIV.7]). By (50), the co-adjoint action Ad\u2217 of G on L\nAd\u2217 \u03b3(\u03c8)(l) = \u03c8(l)\u03c8([log \u03b3, l])\u03c8(higher terms).\n\nb we define a bi-additive, anti-symmetric form B\u03c8 : L\u00d7L \u2192 C\u2217 by\nGiven \u03c8 \u2208 L\nsetting B\u03c8 ((l1 , l2 )) = \u03c8([l1 , l2 ]). We say that a subalgebra P \u2264 L polarises B\u03c8\nif B\u03c8 |P \u00d7P = 1 and it is a maximal additive subgroup with respect to this\nproperty. Note that any such additive subgroup contains the radical Rad\u03c8 =\n{l \u2208 L| \u03c8([l, L]) = 1} of B\u03c8 .\nb the isotropy subgroup G\u03c8 of \u03c8\nLemma [16, Lemmata 1\u20134] Given \u03c8 \u2208 L,\n\u2217\nb is\nunder Ad G is an e.e. subgroup of G and log G\u03c8 = Rad\u03c8 . If \u03c8 \u2208 L\n\u2217\n2\nAd G-invariant, then \u03c8 defines a one-dimensional character on G. The\nb under the co-adjoint action Ad\u2217 of G is finite if and only\norbit of \u03c8 \u2208 L\nb is rational on log G\u2032 then there are e.e.\nif \u03c8 is rational on log G\u2032s . If \u03c8 \u2208 L\ns\npolarising subalgebras P for B\u03c8 . They have finite index in L satisfying |L :\nP | = |P : Rad\u03c8 |.\nTheorem [16, Theorem 1(a)] Let G be an e.e. T -group and set L = log G,\nb and \u03c8 \u2208 \u03a9. Let N be\nL\u2032s = log G\u2032s . Let \u03a9 be a finite Ad\u2217 G-orbit in L,\nthe period of \u03c8 and assume N to be odd. A finite-dimensional irreducible\nrepresentation U\u03a9 may be associated to \u03a9 in the following manner: Let P be\nan e.e. polarising subalgebra for B\u03c8 , set \u03a0 = exp P and \u03c8\u0303 := \u03c8|\u03a0 , a linear\n1/2\ncharacter on \u03a0. Put U\u03a9 := IndG\n\u03a0 \u03c8\u0303. Then\nP the dimension of U\u03a9 is |\u03a9| ,\n1\nand the character of U\u03a9 is \u03be\u03a9 = |\u03a9|1/2 \u03c6\u2208\u03a9 \u03c6. All representations of the\n\\\u2032 , V defined modulo N G := exp(N * L), N odd, are\nform \u03c7 \u2297 V , \u03c7 \u2208 G/G\ns\nrealised in this manner.\n\n\f34\n\nCHRISTOPHER VOLL\n\nCorollary 3.1. For almost all primes p,\nX\nirr\n(51)\n\u03b6G,p\n(s) =\n|L : Rad\u03c8 |\u2212s/2 |L : L\u03c8,2 |\u22121 ,\nc\u2032\n\u03c8\u2208L\ns\n\u03c8 rational of\np-power period\n\nwhere L\u03c8,2 = {l \u2208 L|\u03c8([l, L\u2032s ]) = 1}.\nProof. For primes p not dividing 2|G\u2032s : G\u2032 |, Howe's theorem yields that we\ncount every p-power degree twist-isoclass at least once when we sum |G :\nG\u03c8 |\u2212s/2 over the rational characters \u03c8 of L\u2032s of p-power period. By further\nexcluding finitely many primes, we may assume that |G : G\u03c8 | = |L : Rad\u03c8 |\n(cf. [14, Lemma 4.8], in which it is established that log induces an indexpreserving correspondence between p-power index subgroups of G and ppower index subalgebras of L away from a finite number of primes). Hereby\nwe overcount every orbit by exactly the index |G : G\u03c8,2 |, where G\u03c8,2 = {\u03b3 \u2208\nG|\u03c8([log \u03b3, L\u2032s ]) = 1} is the stabiliser of \u03c8 under the coadjoint action of G on\nthe restriction of characters to L\u2032s . (Note that this index is always equal to 1\nif G is class-2-nilpotent.) Again at the cost of at most finitely many primes\nwe may assume |G : G\u03c8,2 | = |L : L\u03c8,2 |.\n\u0003\nHowe's parametrisation of irreducible representations allows us to prove\nProposition 3.1. Let G be a T -group. Then there are matrices S \u2282 R of\nhomogeneous Q-linear forms such that, for almost all primes p,\nirr\n\u03b6G,p\n(s) = PR,S,Qp (s/2, . . . , s/2; 1, . . . , 1),\n\nwhere PR,S,Qp is the generating function defined in Section 2.2. Proposition 2.2 is applicable for n = h(G\u2032 ).\nTheorem D clearly follows from this.\nProof. We aim to express both factors in the summands of (51) in terms of\nelementary divisors of matrices of linear forms. Recall that L is additively\nisomorphic to Zh , where h is the Hirsch length of G. Without loss of generality\nwe may assume that L\u2032 is saturated in L, and that L\u2032 \u2229 Z(L) is saturated in\nZ(L) (otherwise we disregard finitely many primes). We fix a Z-basis\n{x1 , . . . , xd , xd+1 , . . . , xd+m , xd+m+1 , . . . , xd+n }\n{z\n}\n|\nof L such that\n\n|\n\n{z\n\nL\u2032 \u2229Z(L)\n\nL\u2032\n\n}\n\n{xd+1 , . . . , xd+n } is a Z-basis for L\u2032\n{xd+m+1 , . . . , xd+n } is a Z-basis for L\u2032 \u2229 Z(L).\nThe Lie bracket induces an anti-symmetric, bi-additive mapping\n\u03b2 : L/(L\u2032 \u2229 Z(L)) \u00d7 L/(L\u2032 \u2229 Z(L)) \u2192 L\u2032\n\u0001\nl1 (L\u2032 \u2229 Z(L)), l2 (L\u2032 \u2229 Z(L)) 7\u2192 [l1 , l2 ]\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n35\n\nWe may express this map in terms of our chosen basis as follows. For 1 \u2264\ni, j \u2264 d + m, let\nX\n[xi , xj ] =\n\u03bbijk xd+k , \u03bbijk \u2208 Q.\nk\u2208[n]\n\nLet R = (Rij ) denote the (d + m) \u00d7 (d + m)-matrix of linear forms\nRij (Y) =\n\nX\n\n\u03bbijk Yk \u2208 Q[Y1 , . . . , Yn ].\n\nk\u2208[n]\n\nBy S we denote the submatrix of R consisting of the last m columns of R.\nBy further disregarding finitely many primes if necessary we may assume\nthat p divides none of the denominators of the \u03bbijk (so that we may reduce\nmod p), and that, given y \u2208 Znp , R(y) is not zero unless y = 0 \u2208 Fnp . We\ndenote by Ci , i \u2208 [d + m], the matrices of the additive maps L/(L\u2032 \u2229 Z(L)) \u2192\nL\u2032 , x(L\u2032 \u2229Z(L)) 7\u2192 [x, xi ] with respect to these bases. For a given non-negative\ninteger N \u2208 N0 we identify the set\no\nn\n\u03a8pN := \u03c8 \u2208 Lb\u2032 | the period of \u03c8 equals pN\n\nwith Zn /pN Zn\n\u0001\u00d7\nZn /pN Zn to\n\n\u0001\u00d7\n\n:= (Z/pN )n \\ (pZ/pN )n by sending l = (l1 , . . . , ln ) \u2208\n\n\u03c8(b1 , . . . , bn ) = exp\n\n2\u03c0i\n\nP\n\ni\u2208[n] li bi\n\npN\n\nWith these identifications we obtain\n\n!\n\n, b = (b1 , . . . , bn ) \u2208 Lb\u2032 .\n\nk = (k1 , . . . , kd+m ) \u2208 Rad\u03c8 /Z(L) \u21d4\u2200\u03b3 \u2208 G : \u03c8\n\n\u0010hX\n\nki xi , log \u03b3\n\ni\u0011\n\n=1\n\n\u21d4\u2200j \u2208 [d + m] : k Cj lt \u2261 0 mod pN\n(52)\n\n\u21d4k R(l) \u2261 0\n\nmod pN\n\nand\nk = (k1 , . . . , kd+m ) \u2208 L\u03c8,2 /Z(L) \u21d4\u2200\u03b3 \u2208 G\u2032 : \u03c8\n\n\u0010hX\n\nki xi , log \u03b3\n\ni\u0011\n\n=1\n\n\u21d4\u2200j \u2208 [d + 1, d + m] : k Cj lt \u2261 0 mod pN\n(53)\n\n\u21d4k S(l) \u2261 0\n\nmod pN .\n\nIn order to use the congruence conditions (52) and (53) for an effective comirr (s), we need to enumerate the (p-parts of) the elementary\nputation of \u03b6G,p\ndivisors of the matrices R(l) and S(l) as l runs through the sets \u03a8pN , N \u2208 N.\n\n\f36\n\nCHRISTOPHER VOLL\n\nBy Corollary 3.1 we may write\nX\nirr\n\u03b6G,p\n(s) =\n|L : Rad\u03c8 |\u2212s/2 |L : L\u03c8,2 |\u22121\nN \u2208N0\n\u03c8\u2208\u03a8pN\n\n=\n\nX\n\nNN,m,n q \u2212\n\nP\n\ns/2 \u2212\ni\u2208[d+m] (N \u2212mi )\n\nP\n\nj\u2208[m] (N \u2212nj )\n\nN \u2208N0\nm\u2208N0d+m , n\u2208Nm\n0\n\n=PR,S,Qp (s/2, . . . , s/2; 1, . . . , 1).\n\u0003\nAcknowledgements. I started work on this paper when I was a guest at\nthe Max-Planck-Institut f\u00fcr Mathematik in Bonn, Germany. I continued it\nas a guest at the Chaire de Math\u00e9matiques Alg\u00e9briques Discr\u00e8tes at the EPF\nLausanne, Switzerland. I gratefully acknowledge both institution's support\nand hospitality. I am particularly obliged to Laurent Bartholdi, my host in\nLausanne, and to the Fond National Suisse, which jointly funded my stay\nthere. Thanks are due to Benjamin Klopsch for frequent inspiring discussions. I wish to thank Benjamin Martin for making Hrushovski's and his\npreprint [17] available to me, and to Willem Veys for alerting me to [29].\nMark Berman's and Ulrich Voll's comments on previous versions helped a\ngreat deal to improve the presentation of this paper. I am particularly grateful to Mark Berman for his help with proof-reading.\nReferences\n[1] M.N. Berman, Uniformity and functional equations for local zeta functions of Q-split\nalgebraic groups, preprint, 2006.\n[2] C.W. Curtis and I. Reiner, Methods of representation theory, with applications to finite\ngroups and orders, vol. 1, John Wiley & Sons, 1981.\n[3] J. Denef, On the degree of Igusa's local zeta function, Amer. J. Math. 109 (1987), no. 6,\n991\u20131008.\n, Report on Igusa's local zeta function, S\u00e9minaire Bourbaki 43 (1990-91),\n[4]\nno. 201-203, 359\u2013386.\n[5] J. Denef and D. Meuser, A functional equation of Igusa's local zeta function, Amer. J.\nMath. 113 (1991), no. 6, 1135\u20131152.\n[6] M.P.F. du Sautoy, A nilpotent group and its elliptic curve: non-uniformity of local zeta\nfunctions of groups, Israel J. Math. 126 (2001), 269\u2013288.\n[7]\n, Counting subgroups in nilpotent groups and points on elliptic curves, J. Reine\nAngew. Math. 549 (2002), 1\u201321.\n[8] M.P.F. du Sautoy and F.J. Grunewald, Analytic properties of zeta functions and subgroup growth, Ann. of Math. 152 (2000), 793\u2013833.\n[9]\n, Zeta functions of groups and rings, Proceedings of the International Congress\nof Mathematicians, Madrid, August 22\u201330, 2006, vol. II, European Mathematical Society, 2006, pp. 131\u2013149.\n[10] M.P.F. du Sautoy and A. Lubotzky, Functional equations and uniformity for local zeta\nfunctions of nilpotent groups, Amer. J. Math. 118 (1996), no. 1, 39\u201390.\n[11] M.P.F. du Sautoy and D. Segal, Zeta functions of groups, New horizons in pro-p groups,\nProgr. Math., Birkhaeuser, Boston MA, 2000, pp. 249\u2013286.\n[12] M.P.F. du Sautoy and G. Taylor, The zeta function of sl2 and resolution of singularities., Math. Proc. Cambridge Philos. Soc 132 (2002), no. 1, 57\u201373.\n\n\fFUNCTIONAL EQUATIONS FOR ZETA FUNCTIONS OF GROUPS AND RINGS\n\n37\n\n[13] M.P.F. du Sautoy and L. Woodward, Zeta functions of groups and rings, Lecture Notes\nin Mathematics 1925, Springer Verlag, 2008.\n[14] F.J. Grunewald, D. Segal, and G.C. Smith, Subgroups of finite index in nilpotent groups,\nInvent. Math. 93 (1988), 185\u2013223.\n[15] R.E. Howe, Kirillov theory for compact p-adic groups, Pacific J. Math. 73 (1977), no. 2,\n365\u2013381.\n, On representations of discrete, finitely generated, torsion-free, nilpotent\n[16]\ngroups, Pacific J. Math. 73 (1977), no. 2, 281\u2013305.\n[17] E. Hrushovski and B. Martin, Zeta functions from definable equivalence relations,\npreprint, 2004.\n[18] J.-I. Igusa, Universal p-adic zeta functions and their functional equations, Amer. J.\nMath. 111 (1989), 671\u2013716.\n[19] A. Jaikin-Zapirain, Zeta function of representations of compact p-adic analytic groups,\nJ. Amer. Math. Soc. 19 (2006), no. 19, 91\u2013118.\n[20] E.I. Khukhro, p-automorphisms of finite p-groups, London Mathematical Society Lecture Note Series 146, Cambridge University Press, 1998.\n[21] B. Klopsch, Zeta functions related to the pro-p group SL1 (\u2206p ), Math. Proc. Cambridge\nPhilos. Soc. 135 (2003), 45\u201357.\n[22] B. Klopsch, C. Voll, Zeta functions of 3-dimensional p-adic Lie algebras, Oberwolfach\nPreprints OWP 2007-10.\n[23] A. Lubotzky and A.R. Magid, Varieties of representations of finitely generated groups,\nMem. Amer. Math. Soc. 58 (1985), no. 336, xi+117 pp.\n[24] A. Lubotzky and D. Segal, Subgroup growth, Birkh\u00e4user Verlag, 2003.\n[25] C. Nunley and A.R. Magid, Simple representations of the integral Heisenberg group,\nContemp. Math. 82 (1989), 89\u201396.\n[26] D. Segal, Polycyclic groups, Cambridge Tracts in Mathematics 82, CUP, 1983.\n[27] J.-P. Serre, Lie algebras and Lie groups, Second edition, Lecture Notes in Mathematics\n1500, Springer Verlag, 1992.\n[28] Richard P. Stanley, Enumerative combinatorics, Cambridge Studies in Advanced Mathematics, 49, vol. 1, Cambridge University Press, 1997.\n[29] W. Veys and W.A. Zuniga-Galindo, Zeta functions for analytic mappings, logprincipalization of ideals, and Newton polyhedra, Trans. Amer. Math. Soc. 306 (2008),\n2205\u20132227.\n[30] C. Voll, Zeta functions of groups and enumeration in Bruhat-Tits buildings, Amer. J.\nMath. 126 (2004), 1005\u20131032.\n[31]\n, Functional equations for local normal zeta functions of nilpotent groups, Geom.\nFunc. Anal. (GAFA) 15 (2005), 274\u2013295, with an appendix by A. Beauville.\n, Counting subgroups in a family of nilpotent semidirect products, Bull. London\n[32]\nMath. Soc. 38 (2006), 743\u2013752.\n[33] J. Wlodarczyk, Simple Hironaka resolution in characteristic zero, J. Amer. Math. Soc.\n18 (2005), no. 4, 779\u2013822.\n[34] L. Woodward, Zeta functions of groups: computer calculations and functional equations, Ph.D. thesis, University of Oxford, 2005.\nEmail: C.Voll.98 at cantab.net\nSchool of Mathematics, University of Southampton, Highfield, SO17 1BJ,\nUnited Kingdom.\n\n\f"}