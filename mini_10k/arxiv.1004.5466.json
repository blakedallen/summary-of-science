{"id": "http://arxiv.org/abs/1004.5466v1", "guidislink": true, "updated": "2010-04-30T08:18:42Z", "updated_parsed": [2010, 4, 30, 8, 18, 42, 4, 120, 0], "published": "2010-04-30T08:18:42Z", "published_parsed": [2010, 4, 30, 8, 18, 42, 4, 120, 0], "title": "On computing factors of cyclotomic polynomials", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1004.3720%2C1004.4490%2C1004.0818%2C1004.1447%2C1004.5217%2C1004.1885%2C1004.2682%2C1004.2197%2C1004.0011%2C1004.0776%2C1004.5220%2C1004.1744%2C1004.1311%2C1004.5363%2C1004.5557%2C1004.5519%2C1004.3370%2C1004.4655%2C1004.2925%2C1004.1670%2C1004.1166%2C1004.0802%2C1004.2983%2C1004.2905%2C1004.0224%2C1004.4348%2C1004.0744%2C1004.0629%2C1004.0729%2C1004.1985%2C1004.3624%2C1004.3442%2C1004.3812%2C1004.0353%2C1004.1493%2C1004.3989%2C1004.3538%2C1004.5033%2C1004.4373%2C1004.1876%2C1004.2302%2C1004.2228%2C1004.1613%2C1004.4072%2C1004.1967%2C1004.0964%2C1004.1274%2C1004.3569%2C1004.5165%2C1004.0887%2C1004.5057%2C1004.4330%2C1004.3573%2C1004.2627%2C1004.2283%2C1004.3699%2C1004.4876%2C1004.2459%2C1004.2465%2C1004.4829%2C1004.3282%2C1004.3328%2C1004.0726%2C1004.4101%2C1004.0214%2C1004.3672%2C1004.3895%2C1004.2096%2C1004.5199%2C1004.4605%2C1004.1329%2C1004.4521%2C1004.4485%2C1004.1098%2C1004.5476%2C1004.1148%2C1004.4899%2C1004.3401%2C1004.5223%2C1004.1229%2C1004.1657%2C1004.5428%2C1004.3244%2C1004.4796%2C1004.3263%2C1004.0683%2C1004.0390%2C1004.2819%2C1004.3078%2C1004.5342%2C1004.4540%2C1004.4783%2C1004.1347%2C1004.4984%2C1004.4919%2C1004.3030%2C1004.1634%2C1004.5466%2C1004.3601%2C1004.3974%2C1004.1104&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On computing factors of cyclotomic polynomials"}, "summary": "For odd square-free n > 1 the n-th cyclotomic polynomial satisfies an\nidentity of Gauss. There are similar identity of Aurifeuille, Le Lasseur and\nLucas. These identities all involve certain polynomials with integer\ncoefficients. We show how these coefficients can be computed by simple\nalgorithms which require O(n^2) arithmetic operations and work over the\nintegers. We also give explicit formulae and generating functions for the\npolynomials, and illustrate the application to integer factorization with some\nnumerical examples.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1004.3720%2C1004.4490%2C1004.0818%2C1004.1447%2C1004.5217%2C1004.1885%2C1004.2682%2C1004.2197%2C1004.0011%2C1004.0776%2C1004.5220%2C1004.1744%2C1004.1311%2C1004.5363%2C1004.5557%2C1004.5519%2C1004.3370%2C1004.4655%2C1004.2925%2C1004.1670%2C1004.1166%2C1004.0802%2C1004.2983%2C1004.2905%2C1004.0224%2C1004.4348%2C1004.0744%2C1004.0629%2C1004.0729%2C1004.1985%2C1004.3624%2C1004.3442%2C1004.3812%2C1004.0353%2C1004.1493%2C1004.3989%2C1004.3538%2C1004.5033%2C1004.4373%2C1004.1876%2C1004.2302%2C1004.2228%2C1004.1613%2C1004.4072%2C1004.1967%2C1004.0964%2C1004.1274%2C1004.3569%2C1004.5165%2C1004.0887%2C1004.5057%2C1004.4330%2C1004.3573%2C1004.2627%2C1004.2283%2C1004.3699%2C1004.4876%2C1004.2459%2C1004.2465%2C1004.4829%2C1004.3282%2C1004.3328%2C1004.0726%2C1004.4101%2C1004.0214%2C1004.3672%2C1004.3895%2C1004.2096%2C1004.5199%2C1004.4605%2C1004.1329%2C1004.4521%2C1004.4485%2C1004.1098%2C1004.5476%2C1004.1148%2C1004.4899%2C1004.3401%2C1004.5223%2C1004.1229%2C1004.1657%2C1004.5428%2C1004.3244%2C1004.4796%2C1004.3263%2C1004.0683%2C1004.0390%2C1004.2819%2C1004.3078%2C1004.5342%2C1004.4540%2C1004.4783%2C1004.1347%2C1004.4984%2C1004.4919%2C1004.3030%2C1004.1634%2C1004.5466%2C1004.3601%2C1004.3974%2C1004.1104&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "For odd square-free n > 1 the n-th cyclotomic polynomial satisfies an\nidentity of Gauss. There are similar identity of Aurifeuille, Le Lasseur and\nLucas. These identities all involve certain polynomials with integer\ncoefficients. We show how these coefficients can be computed by simple\nalgorithms which require O(n^2) arithmetic operations and work over the\nintegers. We also give explicit formulae and generating functions for the\npolynomials, and illustrate the application to integer factorization with some\nnumerical examples."}, "authors": ["Richard P. Brent"], "author_detail": {"name": "Richard P. Brent"}, "author": "Richard P. Brent", "arxiv_comment": "21 pages. An old Technical Report, submitted for archival purposes.\n  For further details, see http://wwwmaths.anu.edu.au/~brent/pub/pub135.html", "links": [{"href": "http://arxiv.org/abs/1004.5466v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1004.5466v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11-04 (Primary) 05A15, 11T06, 11T22, 11T24, 11Y05, 11Y16, 12-04,\n  12E10, 12Y05 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "G.1.0; G.2.1", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1004.5466v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1004.5466v1", "journal_reference": "Mathematics of Computation 61 (1993), 131-149.", "doi": null, "fulltext": "On computing factors of cyclotomic polynomials\u2217\n\narXiv:1004.5466v1 [math.NT] 30 Apr 2010\n\nRichard P. Brent\nComputer Sciences Laboratory\nAustralian National University\nCanberra, ACT 0200\nReport TR-CS-92-13\nSeptember 1992\nIn memory of\nDerrick H. Lehmer\n1905\u20131991\n\nAbstract\nFor odd square-free n > 1 the cyclotomic polynomial \u03a6n (x) satisfies the identity of Gauss\n4\u03a6n (x) = A2n \u2212 (\u22121)(n\u22121)/2 nBn2 .\nA similar identity of Aurifeuille, Le Lasseur and Lucas is\n\u03a6n ((\u22121)(n\u22121)/2 x) = Cn2 \u2212 nxDn2\nor, in the case that n is even and square-free,\n\u00b1\u03a6n/2 (\u2212x2 ) = Cn2 \u2212 nxDn2 ,\nHere An (x), . . . , Dn (x) are polynomials with integer coefficients. We show how these coefficients can be computed by simple algorithms which require O(n2 ) arithmetic operations\nand work over the integers. We also give explicit formulae and generating functions for\nAn (x), . . . , Dn (x), and illustrate the application to integer factorization with some numerical examples.\n1991 Mathematics Subject Classification. Primary 11-04, 05A15; Secondary 11T06, 11T22,\n11T24, 11Y16, 12-04, 12E10, 12Y05,\nKey words and phrases. Aurifeuillian factorization, class number, cyclotomic field, cyclotomic polynomial, Dirichlet series, exact computation, Gauss's identities, generating functions, integer factorization, Lucas's identities, Newton's identities.\n\n\u2217\n\nCopyright c 1992\u20132010, R. P. Brent.\n\nrpb135 typeset using LATEX\n\n\f1\n\nIntroduction\n\nFor integer n > 0 let \u03a6n (x) denote the cyclotomic polynomial\n(x \u2212 \u03b6 j ),\n\n(1)\n\n\u03a6d (x),\n\n(2)\n\n(xd \u2212 1)\u03bc(n/d) .\n\n(3)\n\nY\n\n\u03a6n (x) =\n\n0<j\u2264n\n(j,n)=1\n\nwhere \u03b6 is a primitive n-th root of unity. Clearly\nxn \u2212 1 =\n\nY\nd|n\n\nand the M\u00f6bius inversion formula [13] gives\n\u03a6n (x) =\n\nY\nd|n\n\nEquation (1) is useful for theoretical purposes, but (3) is more convenient for computation\nas it leads to a simple algorithm for computing the coefficients of \u03a6n (x) or evaluating \u03a6n (x) at\ninteger arguments using only integer arithmetic. If n is square-free the relations\n\u03a6n (x) =\n\n\u001a\n\nx \u2212 1,\n\u03a6n/p (xp )/\u03a6n/p (x),\n\nif n = 1;\nif p|n, p prime;\n\n(4)\n\ngive another convenient recursion for computing \u03a6n (x).\nAlthough \u03a6n (x) is irreducible over Z (see for example [29]), \u03a6n (x) may be reducible over\ncertain quadratic fields. For example,\n4\u03a65 (x) = (2x2 + x + 2)2 \u2212 5x2 ,\n\n(5)\n\n4\u03a6n (x) = A2n \u2212 (\u22121)(n\u22121)/2 nBn2 .\n\n(6)\n\n\u0010 \u221a \u0011\n\u221a\nso \u03a65 (x) has factors x2 + 1\u00b12 5 x + 1 whose coefficients are algebraic integers in Q[ 5].\nFor odd square-free n > 1 the cyclotomic polynomial \u03a6n (x) satisfies the identity\n\nGauss [12] proved (6) for odd prime n; the generalization to other odd square-free n is due to\nDirichlet [11]. Related identities of Aurifeuille and Le Lasseur [2] are\n\u03a6n ((\u22121)(n\u22121)/2 x) = Cn2 \u2212 nxDn2\n\n(7)\n\n\u03a6n/2 (\u2212x2 ) = Cn2 \u2212 nxDn2\n\n(8)\n\nfor odd square-free n, and\nfor even square-free n > 2. For a proof, see Lucas [22] or Schinzel [26].\nIn (6\u20138), An (x), . . . , Dn (x) are polynomials with integer coefficients, and without loss of\ngenerality we can assume that An (x)/2, Bn (x), Cn (x) and Dn (x) are monic. In Section 3 we\nshow how the coefficients of An , . . . , Dn can be computed by simple algorithms which require\nO(n2 ) arithmetic operations and work entirely over the integers.\nIn Section 1.1 we summarize our notation for future reference. Some numerical examples\nare given in Sections 1.2\u20131.3, and Newton's identities are discussed in Section 1.4. Then, in\nSection 2, we discuss the theoretical basis for the algorithms. The results for An and Bn are\nknown (though perhaps forgotten) \u2013 they may be found in Dirichlet [11]. We present them in\nSection 2.2 for the sake of completeness and to aid the reader in understanding the results for\nCn and Dn .\n2\n\n\fThe algorithms are presented in Section 3. The algorithm (Algorithm D) for computing\nAn and Bn is essentially due to Dirichlet [11], who illustrated it with some numerical examples\nbut did not state it in general terms. The algorithm (Algorithm L) for computing Cn and Dn\nappears to be new. In Section 3.3 we comment briefly on Stevenhagen's algorithm [27] and\ncompare it with Algorithm L.\nFinally, in Section 4 we give some explicit formulas for An (x), . . . , Dn (x). These may\nbe regarded as generating functions if x is an indeterminate, or may be used to compute\nAn (x), . . . , Dn (x) for given argument x. In the special case x = 1 the results \u221a\nfor An (1), Bn (1)\nreduce to known formulas involving the class number of the quadratic field Q[ \u00b1n].\nOne application of cyclotomic polynomials is to the factorization of integers of the form\nan \u00b1 bn : see for example [6, 7, 8, 9, 15, 16, 24, 26, 27]. If x = m2 n for any integer m, then (7\u20138)\nare differences of squares, giving rational integer factors of xn \u00b1 1. Examples may be found in\nSection 4.4. For the reader interested in integer factorization, our most significant results are\nAlgorithm L of Section 3.2 and Theorem 3 of Section 4.4.\n\n1.1\n\nNotation\n\nUnless qualified by \"algebraic\", the term \"integer\" means a rational integer. x usually denotes\nan indeterminate, occasionally a real or complex variable.\n\u03bc(n) denotes the M\u00f6bius function, \u03c6(n) denotes Euler's totient function, and (m, n) denotes\nthe greatest common divisor of m and n. For definitions and properties of these functions, see\nfor example [13]. Note that \u03bc(1) = \u03c6(1) = 1.\n(m|n) denotes the Jacobi symbol1 except that, as is usual for the Kronecker symbol2 , (m|n)\nis defined as 0 if (m, n) > 1. Thus, when specifying a condition such as (m|n) = 1 we may omit\nthe condition (m, n) = 1.\nn denotes a positive integer (square-free from Section 2.2 on). For given n, we define integers\nn\u2032 , s and s\u2032 as follows:\n\u001a\nn, if n = 1 mod 4;\n\u2032\nn =\n2n, otherwise.\ns=\n\n\u001a\n\n\u22121,\n+1,\n\nif n = 3 mod 4;\notherwise.\n\ns\u2032 =\n\n\u001a\n\n\u22121, if n = 5 mod 8;\n+1, otherwise.\n\nIt is convenient to write gk for (k, n) and gk\u2032 for (k, n\u2032 ).\nDefine\n\u001a\n\u03a6n (sx),\nif n is odd;\nFn (x) =\n\u03c6(n/2)\n2\n(\u22121)\n\u03a6n/2 (\u2212x ), if n is even.\n\n(9)\n\nThus we can write (7\u20138) as\nFn (x) = Cn2 \u2212 nxDn2 .\n\n(10)\n\nThe factor (\u22121)\u03c6(n/2) in the definition of Fn is only relevant if n = 2, and ensures that (10) is\nvalid for n = 2 (with C2 (x) = x + 1, D2 (x) = 1). The Aurifeuillian factors of Fn (x) are\n\u221a\nFn+ (x) = Cn (x) + nxDn (x)\nand\nFn\u2212 (x) = Cn (x) \u2212\n1\n\n\u221a\nnxDn (x).\n\nSee, for example, Riesel [24]. To avoid ambiguity, we never write the Jacobi symbol as\nwithout parentheses means that m divides n.\n2\nSee, for example, Landau [18].\n\n3\n\nm\nn\n\n\u0001\n\n. Note that m|n\n\n\fFrom (10) we have Fn (x) = Fn\u2212 (x)Fn+ (x). We may write Fn\u00b1 for one of Fn+ , Fn\u2212 .\n\u221a\np We sometimes need to specify a particular complex square root. If m < 0 then m means\ni |m|.\nd is usually the degree of a polynomial, while D is the discriminant of a quadratic form. For\nodd square-free n we always have D = sn, so D = 1 mod 4.\nSome additional notation is introduced in Section 1.4.\n\n1.2\n\nExamples\n\nTaking n = 15, we have\n\u03a615 (x) =\n\n(x15 \u2212 1)(x \u2212 1)\n= x8 \u2212 x7 + x5 \u2212 x4 + x3 \u2212 x + 1,\n(x5 \u2212 1)(x3 \u2212 1)\nA15 (x) = 2x4 \u2212 x3 \u2212 4x2 \u2212 x + 2,\nB15 (x) = x3 \u2212 x,\n\nC15 (x) = x4 + 8x3 + 13x2 + 8x + 1,\nD15 (x) = x3 + 3x2 + 3x + 1,\nand the reader may easily verify that (6) and (7) are satisfied. As an example of (8), for n = 14\nwe have\nx14 + 1\n= x12 \u2212 x10 + x8 \u2212 x6 + x4 \u2212 x2 + 1,\nF14 (x) = \u03a67 (\u2212x2 ) = 2\nx +1\nC14 (x) = x6 + 7x5 + 3x4 \u2212 7x3 + 3x2 + 7x + 1,\nand\nD14 (x) = x5 + 2x4 \u2212 x3 \u2212 x2 + 2x + 1.\n\n1.3\n\nThe identities of Beeger and Schinzel\n\nTaking n = 5 in (7) we obtain\n\u03a65 (x) = (x2 + 3x + 1)2 \u2212 5x(x + 1)2 ,\n\u221a\n\u221a\nso \u03a65 (x2 ) has factors x4 + 3x2 + 1 \u00b1 5(x3 + x) in Q[ 5]. Replacing x by x3 we obtain factors\nof \u03a65 (x6 ). Now\n\u03a615 (x2 ) = \u03a65 (x6 )/\u03a65 (x2 ),\n\u221a\nand by division (taking the factors with opposite signs of 5) we obtain factors\n\u221a\nx8 + 2x6 + 3x4 + 2x2 + 1 \u00b1 5(x7 + x5 + x3 + x)\nof \u03a615 (x2 ). Thus\n\u03a615 (x) = (x4 + 2x3 + 3x2 + 2x + 1)2 \u2212 5x(x3 + x2 + x + 1)2 .\n\n(11)\n\n\u221a\nThis is\n\u221a not of the form (10) because it gives a factorization of \u03a615 (\u00b1x) over Q[ \u00b15] instead\nof Q[ \u221315]. Instead, (11) is an example of the more general identities of Beeger [3] and\nSchinzel [26]. These identities can all be obtained in a similar manner from (10), so in the\napplication to integer factorization they do not give any factors which could not be found from\nseveral applications of (10) and some greatest common divisor calculations. For this reason we\nhave restricted our attention to identities of the form (6) and (10).\n\n4\n\n\f1.4\n\nNewton's identities\n\nLet\nP (x) =\n\nd\nY\n\nd\nX\n\n(x \u2212 \u03bej ) =\n\nj=1\n\naj xd\u2212j\n\nj=0\n\nbe a polynomial of degree d with arbitrary roots \u03bej and coefficients a0 = 1, a1 , . . . , ad .\nFor k > 0, define\npk =\n\nd\nX\n\n\u03bejk .\n\n(12)\n\nj=1\n\nNewton (1707)3 showed how to express the elementary symmetric functions a1 , a2 , . . . in terms\nof the sums of powers p1 , p2 , . . .\nWe may find a1 , . . . , ad by solving a lower triangular linear system of special form [28].\nWriting the solution explicitly in the form of a linear recurrence, we have\nkak = \u2212\n\nk\u22121\nX\n\npk\u2212j aj\n\n(13)\n\nj=0\n\nfor k = 1, . . . , d. An alternative expression for ak as a determinant may be obtained by applying\nCramer's rule to the lower triangular system. However, for computational purposes (13) is more\nconvenient.\nIn Section 4 we use the following generating function [25] for (a0 , a1 , . . .):\nxd P (1/x) =\n\nd\nX\n\nj=0\n\n\uf8eb\n\naj xj = exp \uf8ed\u2212\n\n\u221e\nX\n\nj=1\n\n\uf8f6\n\npj xj /j \uf8f8\n\n(14)\n\nDifferentiating both sides of (14) and equating coefficients shows that (13) and (14) are formally\nequivalent. An independent proof of (14) is the following: for sufficiently small x we have\nd\n\nln(x P (1/x)) =\n\nd\nX\n\nk=1\n\nln(1 \u2212 \u03bek x) = \u2212\n\nd X\n\u221e\nX\n\n\u03bekj xj /j\n\nk=1 j=1\n\n=\u2212\n\n\u221e\nX\n\nj=1\n\nd\nX\n\nk=1\n\n\u03bekj\n\n!\n\nxj /j = \u2212\n\n\u221e\nX\n\npj xj /j.\n\nj=1\n\nIn all our applications of (14) the pj are bounded, so the infinite series converges for |x| < 1.\nIn the following, pj and aj are not fixed, but depend on the particular polynomial under\nconsideration at the time. This should not cause any confusion.\n\n2\n\nTheoretical Basis for the Algorithms\n\nOur idea is to compute sums of powers of certain roots of the polynomials occurring on the left\nside of (6) and (10), and then use Newton's identities in the form (13) to compute the coefficients\nof An , . . . , Dn .\n\n2.1\n\nCyclotomic polynomials\n\nFirst consider the computation of the coefficients of the cyclotomic polynomial \u03a6n (x) for n > 1.\nThis is presented to illustrate a simple case of the technique; in practice it is more efficient to\ncompute \u03a6n (x) from (3).\n3\nSee Turnbull [28], where the notation sk is used in place of our pk . It would be confusing to use Turnbull's\nnotation because we have used s and s\u2032 for other purposes. Note that our pk are not generally prime numbers.\n\n5\n\n\fLet \u03b6 be a primitive n-th root of unity. To apply Newton's identities we need to evaluate\npk =\n\n\u03b6 jk\n\nX\n\n(15)\n\n0<j<n\n(j,n)=1\n\nfor k = 1, 2, . . . , \u03c6(n). This problem is well-known4 .\nIf n is prime the problem is easy: from\n1 + \u03b6 + \u03b6 2 + * * * + \u03b6 n\u22121 =\n\n1 \u2212 \u03b6n\n= 0,\n1\u2212\u03b6\n\nwe have p1 = \u22121. Moreover, for any k with (k, n) = 1, the map z 7\u2192 z k merely permutes\n{\u03b6, . . . , \u03b6 n\u22121 }, so pk = p1 .\nNow consider the general case, n not necessarily prime. From (3) it is clear that p1 = \u03bc(n).\nLet gk = (k, n). If gk = 1 then the same argument as before shows that pk = p1 . If gk > 1 then\nthe sum (15) defining pk consists of \u03c6(n)/\u03c6(n/gk ) copies of a sum of primitive (n/gk )-th roots\nof unity. Thus, the result is\n\u03bc(n/gk )\u03c6(n)\npk =\n.\n(16)\n\u03c6(n/gk )\nUsing (16) the coefficients a1 , . . . , a\u03c6(n) of \u03a6n (x) may be evaluated from the recurrence (13).\nAs an application of (14) and (16) we prove two Lemmas which give upper bounds on\n|\u03a6n (x)| and |Fn (x)| for complex x outside the unit circle. Here Fn (x) is the modified cyclotomic\npolynomial defined by (9). Lemma 2 is used in Section 4.4.\nLemma 1 If |x| \u2265 R > 1 then\n|\u03a6n (x)| < R\n\n\u03c6(n)\n\n1\n.\nexp\nR\u22121\n\u0013\n\n\u0012\n\nProof\nLet d = \u03c6(n). From (14) with x replaced by 1/x, we have\n\uf8eb\n\n\u03a6n (x)/xd = exp \uf8ed\u2212\n\nbut from (16) we have\n\n\u221e\nX\n\nj=1\n\n\uf8f6\n\npj x\u2212j /j \uf8f8 ,\n\n|pj | \u2264 gj \u2264 min(j, n),\nso\nd\n\n\uf8eb\n\n|\u03a6n (x)/x | < exp \uf8ed\n\n\u221e\nX\n\nR\n\nj=1\n\nThis completes the proof.\n\n\uf8f6\n\n\u2212j \uf8f8\n\n1\n= exp\n.\nR\u22121\n\u0012\n\n\u0013\n\n\u2737\n\nLemma 2 If n > 1 is square-free and |x| \u2265 R > 1 then\n|Fn (x)| < R\u03c6(2n) exp\n\n\u0012\n\n1\n.\nR\u22121\n\u0013\n\n4\nIf \u03b6 = e2\u03c0i/n then our pk is \"Ramanujan's sum\" cn (k), in the notation of Ramanujan [23] or Chapter 26 of\nDavenport [10].\n\n6\n\n\fProof\nFrom the definition (9) of Fn (x),\ndeg Fn =\n\n\u001a\n\n\u03c6(n),\n2\u03c6(n/2),\n\nif n is odd;\nif n is even;\n\nso it is easy to see that\ndeg Fn = \u03c6(2n)\nin both cases. The bound on |Fn (x)| follows from Lemma 1 applied to \u03a6n (\u00b1x) if n is odd, and\nfrom Lemma 1 applied to \u03a6n/2 (\u2212x2 ) if n is even.\n\u2737\n\n2.2\n\nThe identity of Gauss\n\nFrom now on we assume that n > 1 is square-free. In this subsection we also assume that n is\nodd. Consider the polynomial\nY\n(x \u2212 \u03b6 j )\n(17)\nGn (x) =\n0<j<n\n(j|n)=1\n\nof degree \u03c6(n)/2, where \u03b6 = e2\u03c0i/n is a primitive n-th root of unity. The particular choice of\nprimitive root is only significant for the sign of the square root of sn appearing in the equations\nbelow.\nFrom Dirichlet [11],\n\u221a\n2Gn (x) = An (x) \u2212 snBn (x),\n(18)\nwhere An and Bn are as in (6), and s is defined in Section 1.1. Since n is odd, we have\ns = (\u22121|n) = (\u22121)(n\u22121)/2 .\nDefine\n\u221a\n(19)\n2G\u0303n (x) = An (x) + snBn (x),\nso Gauss's identity (6) may be written as\n\u03a6n (x) = Gn (x)G\u0303n (x).\n\n(20)\n\nThe sums of k-th powers of roots of Gn (x) are\npk =\n\nX\n\n\u03b6 jk .\n\n(21)\n\n0<j<n\n(j|n)=1\n\nLet gk = (k, n). Then\n2pk =\n\n\u001a\n\n\u221a\n\u03bc(n) + (k|n) sn, if gk = 1;\n\u03bc(n/gk )\u03c6(gk ),\notherwise.\n\n(22)\n\nThe result (22) is essentially due to Dirichlet [11], but we sketch a proof. If gk = 1, then (22)\nfollows from the discussion in Section 2.1 (where pk has a different meaning!) and the classical\nresult that the Gaussian sum\nX\n(j|n)\u03b6 j\n0<j<n\n\n\u221a\nis sn. On the other hand, if gk > 1, observe that (gk , n/gk ) = 1 because n is square-free.\nThus, we can write the summation index j in (21) in the form j = j0 gk + j1 (n/gk ), and (j|n) =\n(j1 |gk )(j0 |(n/gk )). Since jk = j0 gk k mod n, \u03b6 jk is independent of j1 , and it follows that the\nsum (21) defining pk consists of \u03c6(gk )/2 copies of a complete sum of primitive (n/gk )-th roots\nof unity. Thus, (22) follows as in the proof of (16).\n7\n\n\fAlthough (22) has been written with two cases for the sake of clarity, our convention that\n(k|n) = 0 if (k, n) > 1 implies that the expression\n\u221a\n(23)\n2pk = \u03bc(n/gk )\u03c6(gk ) + (k|n) sn\n\u221a\nis valid in both cases. Similarly for G\u0303n (x), with the sign of sn \u221a\nin (23) reversed.\n\u221a\nObserve that pk \u2208 Q[ n] is real if n = 1 mod 4, but pk \u2208 Q[ \u2212n] is complex if gk = 1 and\nn = 3 mod 4.\nUsing (22), the coefficients of Gn (x), and hence of An (x) and Bn (x), may be evaluated from\nthe recurrence (13). Moreover, it is possible to perform the computation using only integer\narithmetic. Details are given in Section 3.\n\n2.3\n\nThe identities of Aurifeuille, Le Lasseur and Lucas\n\nHere we assume that n > 1 is square-free, but not necessarily odd. Recall the definitions of n\u2032 ,\ns and s\u2032 from Section 1.1.\n\u2032\nLet \u03b6 = e\u03c0i/n be a primitive 2n\u2032 -th root of unity. The particular choice of primitive root is\nonly significant for the sign of the square root in (29). Consider the polynomial\nLn (x) =\n\nY\n\nj\u2208Sn\n\nwhere\nSn =\n\n(x \u2212 \u03b6 j ),\n\n\uf8f1\n\u2032\n\u2032\nj\n\uf8f2 {j | 0 < j < 2n , (j, n ) = 1, (j|n) = (\u22121) },\n\uf8f3\n\n{j | 0 < j < 2n\u2032 , (j, n\u2032 ) = 1, (n|j) = 1},\n\n(24)\n\nif n = 1 mod 4;\n(25)\notherwise.\n\nObserve that Ln (x) has degree \u03c6(n\u2032 ) = \u03c6(2n). Also, j \u2208 Sn iff 2n\u2032 \u2212j \u2208 Sn , so the coefficients\n\u221a\nof Ln (x) are real. In fact, from (29) below, they are in Q[ n]. We later use the fact that Ln (x)\nis symmetric.\nSchinzel [26] essentially shows (with a different notation) that\n\u221a\n(26)\nLn (x) = Cn (x2 ) \u2212 s\u2032 x nDn (x2 )\nwhere Cn (x) and Dn (x) are the polynomials of (10). Define\n\u221a\nL\u0303n (x) = Ln (\u2212x) = Cn (x2 ) + s\u2032 x nDn (x2 ),\n\n(27)\n\nso after a change of variable (10) may be written as\nFn (x2 ) = Ln (x)L\u0303n (x).\n\u221a\n\u221a\nClearly Fn\u2212 (x) = Ln (s\u2032 x) and Fn+ (x) = L\u0303n (s\u2032 x).\nLet gk\u2032 = (k, n\u2032 ). The sums pk of k-th powers of roots of Ln (x) are\n\u221a\n\u001a\nif k is odd;\n(n|k)s\u2032 n,\npk =\n\u2032\n\u2032\n\u2032\n\u03bc(n /gk )\u03c6(gk ) cos ((n \u2212 1)k\u03c0/4) , if k is even.\n\n(28)\n\n(29)\n\nObserve that the cosine in (29) is 0 or \u00b11, and depends only on n mod 4 and k/2 mod 4.\nThe proof of (29) is similar to that of (22), but tedious because of the number of cases to be\nconsidered. Thus, we omit the details.\nUsing (29), the coefficients of Ln (x), and hence of Cn (x) and Dn (x), may be evaluated from\nthe recurrence (13). Details are given in Section 3.\n\n8\n\n\f3\n\nAlgorithms\n\nIn this section we use the analytic results of Section 2 to derive efficient algorithms for computing\nthe coefficients of the polynomials An , . . . , Dn .\n\n3.1\n\nAn algorithm for computing An and Bn\n\nConsider the computation of An and Bn for odd square-free n. Our notation is the same as in\nSection 2.2. Write\nAn (x) =\n\nd\nX\n\n\u03b1j xd\u2212j ,\n\nd\nX\n\n\u03b2j xd\u2212j ,\n\nj=0\n\nBn (x) =\n\nj=0\n\nwhere d = \u03c6(n)/2, \u03b10 = 2, \u03b20 = 0, \u03b21 = 1.\nRecall the definition (21) of pk . For k > 0 we have, from (23),\n\u221a\n2pk = qk + rk sn,\nwhere qk and rk are integers given by\nqk = \u03bc(n/gk )\u03c6(gk )\n\n(30)\n\nrk = (k|n).\n\n(31)\n\nand\nUsing (13) and (18), we obtain the recurrences\n\u03b1k =\n\nX\n1 k\u22121\n(snrk\u2212j \u03b2j \u2212 qk\u2212j \u03b1j )\n2k j=0\n\n(32)\n\nX\n1 k\u22121\n(rk\u2212j \u03b1j \u2212 qk\u2212j \u03b2j )\n2k j=0\n\n(33)\n\nand\n\u03b2k =\n\nfor k = 1, 2, . . . , d. The algorithm is now clear:\nAlgorithm D (for Dirichlet)\n1. Evaluate qk and rk for k = 1, . . . , d using (30\u201331).\n2. Set \u03b10 \u2190 2 and \u03b20 \u2190 0.\n3. Evaluate \u03b1k and \u03b2k for k = 1, . . . , d using (32\u201333).\nComments on Algorithm D\n1. (32\u201333) should give exact integer results; in practice a sum not divisible by 2k is a symptom\nof integer overflow.\n2. The operation count can be reduced by a factor of close to four if advantage is taken of\nthe following properties of An and Bn :\n\n9\n\n\fAn is anti-symmetric if its degree d = \u03c6(n)/2 is odd, otherwise An is symmetric (except\nfor the trivial case A3 (x) = 2x + 1). Thus, we may use\n\u03b1k = (\u22121)d \u03b1d\u2212k\nif 2k > d and n > 3.\nBn /x is antisymmetric if n is composite and n = 3 mod 4, otherwise Bn /x is symmetric.\nThus, we may use\n\u001a\n\u03b2d\u2212k ,\nin the symmetric case;\n\u03b2k =\n\u2212\u03b2d\u2212k , in the anti-symmetric case.\nUsing these properties, the recurrences (32\u201333) need only be applied for k \u2264 max(1, \u230ad/2\u230b).\nExample\nConsider the case n = 15 as in Section 1.2. We have s = \u22121, d = \u03c6(15)/2 = 4. Thus\nq1 = q2 = q4 = \u03bc(15)\u03c6(1) = 1, q3 = \u03bc(5)\u03c6(3) = \u22122,\nr1 = (1|15) = 1, r2 = (2|15) = (2|3)(2|5) = 1, r3 = (3|15) = 0, r4 = (4|15) = 1.\nq3 , q4 , r3 , and r4 are not required if we use symmetry.\nThe initial conditions are \u03b10 = 2 and \u03b20 = 0. The recurrences (32\u201333) give\n\u03b11 = (\u221215r1 \u03b20 \u2212 q1 \u03b10 )/2 = \u22121,\n\u03b21 = (r1 \u03b10 \u2212 q1 \u03b20 )/2 = 1,\n\u03b12 = (\u221215r2 \u03b20 \u2212 15r1 \u03b21 \u2212 q2 \u03b10 \u2212 q1 \u03b11 )/4 = \u22124,\n\u03b22 = (r2 \u03b10 + r1 \u03b11 \u2212 q2 \u03b20 \u2212 q1 \u03b21 )/4 = 0.\nUsing symmetry of An (x) and anti-symmetry of Bn (x)/x, or continuing with the recurrences (32\u201333), we obtain \u03b13 = \u03b11 = \u22121, \u03b23 = \u2212\u03b21 = \u22121, \u03b14 = \u03b10 = 2, \u03b24 = \u2212\u03b20 = 0. Thus\nA15 (x) = 2x4 \u2212 x3 \u2212 4x2 \u2212 x + 2 and B15 (x) = x3 \u2212 x, as expected.\n\n3.2\n\nAn algorithm for computing Cn and Dn\n\nConsider the computation of Cn and Dn for square-free n > 1. Define n\u2032 , s, s\u2032 and Ln as in\nSection 2.3, and d = \u03c6(n\u2032 )/2. Thus deg Ln = 2d, deg Cn = d, and deg Dn = d \u2212 1. From (26) it\nis enough to compute the coefficients ak of Ln (x). In order to work over the integers, we define\n\u001a \u2032\n\u221a\ns pk / n, if k is odd;\nqk =\npk ,\nif k is even;\nwhere pk is the sum of k-th powers of roots of Ln (x). Thus, from (29),\nqk =\n\n\u001a\n\n(n|k),\nif k is odd;\n\u03bc(n\u2032 /gk\u2032 )\u03c6(gk\u2032 ) cos ((n \u2212 1)k\u03c0/4) , otherwise.\n\nIf\nCn (x) =\n\nd\nX\n\n\u03b3j xd\u2212j\n\nj=0\n\nand\nDn (x) =\n\nd\u22121\nX\nj=0\n\n10\n\n\u03b4j xd\u22121\u2212j ,\n\n(34)\n\n\fthen, from (26),\n\u03b3k = a2k\nand\n\n\u221a\n\u03b4k = \u2212s\u2032 a2k+1 / n.\n\nIn particular, \u03b30 = \u03b40 = 1. Using (13) we obtain\n\u03b3k =\nand\n\u03b4k =\n\nX\n1 k\u22121\n(nq2k\u22122j\u22121\u03b4j \u2212 q2k\u22122j \u03b3j )\n2k j=0\n\uf8eb\n\n(35)\n\n\uf8f6\n\nk\u22121\nX\n\n1 \uf8ed\n\u03b3k +\n(q2k+1\u22122j \u03b3j \u2212 q2k\u22122j \u03b4j )\uf8f8\n2k + 1\nj=0\n\n(36)\n\nfor k = 1, 2, . . .\nWe may use the fact that Cn (x) and Dn (x) are symmetric to reduce the number of times the\nrecurrences (35\u201336) need to be applied. An algorithm which incorporates this refinement is:\nAlgorithm L (for Lucas)\n1. Evaluate qk for k = 1, . . . , d using (34).\n2. Set \u03b30 \u2190 1 and \u03b40 \u2190 1.\n3. Evaluate \u03b3k for k = 1, . . . , \u230ad/2\u230b and \u03b4k for k = 1, . . . , \u230a(d \u2212 1)/2\u230b using (35\u201336).\n4. Evaluate \u03b3k for k = \u230ad/2\u230b + 1, . . . , d using \u03b3k = \u03b3d\u2212k .\n5. Evaluate \u03b4k for k = \u230a(d + 1)/2\u230b, . . . , d \u2212 1 using \u03b4k = \u03b4d\u22121\u2212k .\nExample\nConsider the case n = 15 as in Section 1.2. We have n\u2032 = 2n = 30, s\u2032 = 1, d = \u03c6(30)/2 = 4.\nThus\nq1 = (15|1) = 1,\nq2 = \u03bc(15)\u03c6(2) cos(7\u03c0) = \u22121,\nq3 = (15|3) = 0,\nq4 = \u03bc(15)\u03c6(2) cos(14\u03c0) = 1.\nThe initial conditions are \u03b30 = \u03b40 = 1. The recurrences (35\u201336) give\n\u03b31 = (15q1 \u03b40 \u2212 q2 \u03b30 )/2 = 8,\n\u03b41 = (\u03b31 + q3 \u03b30 \u2212 q2 \u03b40 )/3 = 3,\n\u03b32 = (15q3 \u03b40 + 15q1 \u03b41 \u2212 q4 \u03b30 \u2212 q2 \u03b31 )/4 = 13.\nUsing symmetry we obtain \u03b33 = \u03b31 = 8, \u03b34 = \u03b30 = 1, \u03b42 = \u03b41 = 3, and \u03b43 = \u03b40 = 1. Thus\nC15 (x) = x4 + 8x3 + 13x2 + 8x + 1 and D15 (x) = x3 + 3x2 + 3x + 1, as expected.\n\n11\n\n\f3.3\n\nStevenhagen's algorithm\n\nStevenhagen [27] gives an algorithm for computing the polynomials Cn (x) and Dn (x). His\nalgorithm depends on the application of the Euclidean algorithm to two polynomials with integer\ncoefficients and degree O(n). Cn (x) and Dn (x) may be computed as soon as a polynomial of\ndegree \u2264 \u03c6(n)/2 is generated by the Euclidean algorithm. Thus, the algorithm requires O(n2 )\narithmetic operations, the same order5 as our Algorithm L.\nUnfortunately, Stevenhagen's algorithm suffers from a well-known problem of the Euclidean\nalgorithm [14] \u2013 although the initial and final polynomials have small integer coefficients, the\nintermediate results grow exponentially large. When implemented in 32-bit integer arithmetic\nwe found that Stevenhagen's algorithm failed due to integer overflow for n = 35.\nAlgorithm L does not suffer from this problem. It is easy to see from the recurrences (35\u2013\n36) that intermediate results can grow only slightly larger than the final coefficients \u03b3k and \u03b4k .\nA straightforward implementation of Algorithm L can compute Cn and Dn for all square-free\nn < 180 without encountering integer overflow in 32-bit arithmetic. When it does eventually\noccur, overflow is easily detected because the division by 2k in (35) or by 2k + 1 in (36) gives a\nnon-integer result.\n\n4\n\nExplicit expressions for An, . . . , Dn\n\nWe now use (14) to give generating functions for the coefficients of An , . . . , Dn . The generating\nfunctions can be used to evaluate the coefficients of An (x), . . . , Dn (x) in O(n log n) arithmetic\noperations, via the fast power series algorithms of Section 5 of Brent and Kung [5]. Also, where\nthe generating functions converge, they give explicit formulas which can be used to compute\nAn (x), . . . , Dn (x) at particular arguments x. However, it is often more efficient to compute the\ncoefficients of the polynomials by the algorithms of Section 3 and then evaluate the polynomials\nby Horner's rule.\nThe generating functions may be written in terms of certain analytic functions fn and gn ,\nwhich we now define.\n\n4.1\n\nThe analytic functions fn and gn\n\nFor odd square-free n > 1 and |x| \u2264 1, define\nfn (x) =\n\n\u221e\nX\n\n(j|n)\n\nj=1\n\nxj\n.\nj\n\n(37)\n\nSimilarly, for square-free n > 1 and |x| \u2264 1, define\ngn (x) =\n\n\u221e\nX\n\nj=0\n\n(n | 2j + 1)\n\nx2j+1\n.\n2j + 1\n\n(38)\n\nObserve that gn (x) is an odd function, so gn (\u2212x) = \u2212gn (x).\n\u221a\n\u221a\nIt follows from (46) and (57) below that exp( snfn (x)) and exp(2 ngn (x)) are rational\nfunctions with zeros and poles at certain roots of unity. From these representations it follows\nthat the analytic continuations outside the unit circle are given by\n\u001a\n\nfn (x) = fn (1/x),\nfn (x) + fn (1/x) = 2fn (1),\n\nif n = 1 mod 4;\nif n = 3 mod 4;\n\n(39)\n\n5\nThe complexity of both algorithms can be reduced to O(n(log n)2 ) arithmetic operations by standard \"divide\nand conquer\" techniques [1, 4], but this is not of practical significance.\n\n12\n\n\fand\ngn (x) = gn (1/x).\n\n(40)\n\nThe functions fn (x) and gn (x) are closely related. For example, taking the odd terms in the\nsum (37) and using the law of quadratic reciprocity, we obtain\n\u221a \u221a\nfn (x) \u2212 fn (\u2212x) = 2gn (x s)/ s.\nSuch identities are a consequence of relationships between the polynomials\n\u221a Gn (x) and Ln (x).\nfn (1) is related to the class number h(D) of the quadratic field Q[ D] with discriminant\nD = sn. In the notation of Davenport [10], fn (1) = L\u22121 (1) = L(1) = L(1, \u03c7), where \u03c7(j) = (j|n)\nis the real, nonprincipal Dirichlet character appearing in (37). Known results [10, 18, 19, 30] in\nthe case n = 3 mod 4 (so D = \u2212n) are\n(n\u22121)/2\nX\nX\n\u03c0\n2\u03c0\n\u2212\u03c0 n\u22121\n\u221a\n(j|n)j =\n(j|n) = \u221a h(\u2212n) > 0.\nfn (1) = 3/2\n(2 \u2212 (2|n)) n j=1\nw n\nn\nj=1\n\nHere\n\n(41)\n\n6, if n = 3;\n2, if n = 3 mod 4, n > 3\n\u221a\nis the number of roots of unity in Q[ D]. Since h(\u2212n) is an integer and h(\u22123) = 1, we have\n\u221a\n\u001a\n\u221a\n(\u22121 + \u22123)/2, if n = 3;\n(42)\nexp(2i nfn (1)) =\n1,\nif n = 3 mod 4, n > 3.\nw=\n\n\u001a\n\nIn the case n = 1 mod 4, we have D = n, and\nln \u03b5\n(43)\nfn (1) = \u221a h(n).\nn\n\u221a\nHere \u03b5 is the \"fundamental unit\", i.e. \u03b5 = (|u| + n|v|)/2, where\u221a(u, v) is a minimal nontrivial\n2\n2\nsolution\n\u221a of u \u2212 nv = 4. For example, if n = 5 then \u03b5 = (3 + 5)/2, h(5) = 1 and f5 (1) =\n(ln \u03b5)/ 5 = 0.4304 . . .\n\n4.2\n\nThe polynomials An and Bn\n\nLet n > 3 be odd and square-free. We exclude n = 3 to avoid the special case in (42), but the\nresults apply with minor modifications when n = 3. Let s, Gn , G\u0303n be as in Section 2.2, and\nd = \u03c6(n)/2. Recall that\nY\n(x \u2212 \u03b6 j )\n(44)\nGn (x) =\n0<j<n\n(j|n)=1\n\nand\nG\u0303n (x) =\n\nY\n\n0<j<n\n(j|n)=\u22121\n\n(x \u2212 \u03b6 j ).\n\n(45)\n\nFrom (14) and (23), we have\n\u221a\nG\u0303n (1/x)/Gn (1/x) = exp( snfn (x)).\n\n(46)\n\nAlso, from (44),\n(\u2212x)d Gn (1/x) =\n\nY\n\n0<j<n\n(j|n)=1\n\n(\u03b6 j x \u2212 1) =\n\n13\n\nY\n\n0<j<n\n(j|n)=1\n\n\u03b6 j (x \u2212 \u03b6 \u2212j ),\n\n(47)\n\n\fso\n\nn\u22121\nY\n\n(48)\n\n(j|n)j.\n\n(49)\n\nGn (1/x)/G\u0303n (1/x) = \u03b6 \u03c3\n\nj=1\n\nwhere\n\u03c3=\n\n(x \u2212 \u03b6 \u2212j )(j|n) ,\n\nn\u22121\nX\nj=1\n\nIf n = 1 mod 4 then by grouping the terms for j and n \u2212 j (j < n/2) in (49) we have n|\u03c3. If\nn = 3 mod 4 then, from (41), we have \u03c3 = \u2212nh(\u2212n) so again n|\u03c3. Thus, in both cases \u03b6 \u03c3 = 1,\nand from (48) we have\nGn (1/x)/G\u0303n (1/x) =\n\n\u001a\n\nGn (x)/G\u0303n (x), if n = 1 mod 4;\nG\u0303n (x)/Gn (x), if n = 3 mod 4.\n\n(50)\n\nIt follows from (46) that\n\n\u221a\n(51)\nG\u0303n (x)/Gn (x) = exp(s snfn (x)).\n\u221a\nWe see from (46) or (51) that, as claimed above, exp( snfn (x)) is a rational function. It has\nzeros at \u03b6 j , (j|n) = \u2212s; and poles at \u03b6 j , (j|n) = +s. From (20) and (51), taking a square root,\nwe obtain\n!\n\u221a\nq\n\u2212s sn\nfn (x)\n(52)\nGn (x) = \u03a6n (x) exp\n2\np\n\nIf (52) is interpreted as a generating function for Gn (x) then \u03a6n (x) and fn (x) should be\ninterpreted as power series in x, and the correct sign of the square root is positive. On the\nother hand, if (52) is regarded as an exact expression for Gn (x), then the sign of the square root\nis positive for real x, because Gn (x) and \u03a6n (x) have no real roots, and the exponential never\nvanishes, so a change in sign would contradict the continuity of Gn (x). An extension of this\nargument shows that the same branch of the square root must be taken in any simply-connected,\nclosed region which does not contain any of the zeros of \u03a6n (x). (We omit similar comments\nbelow.)\nFrom (52) we easily deduce the corresponding expressions for An (x) = Gn (x) + G\u0303n (x) and\n\u221a\nBn (x) = (G\u0303n (x) \u2212 Gn (x))/ sn. We state the results as a Theorem:\nTheorem 1 For odd, square-free n > 3, the polynomials An (x) and Bn (x) occurring in Gauss's\nidentity (6) are\n!\n\u221a\nq\nsn\nfn (x)\n(53)\nAn (x) = 2 \u03a6n (x) cosh\n2\nand\n\ns\n\nBn (x) = 2\n\n\u03a6n (x)\nsinh\nsn\n\n\u221a\n\n!\n\nsn\nfn (x) .\n2\n\n(54)\n\nRemark\nIf n = 3 mod 4, so s = \u22121, then it is natural to replace cosh(iz) by cos(z) in (53) and sinh(iz)\nby i sin(z) in (54), giving\n!\n\u221a\nq\nn\nAn (x) = 2 \u03a6n (x) cos\nfn (x)\n(55)\n2\nand\n\ns\n\nBn (x) = 2\n\n\u03a6n (x)\nsin\nn\n14\n\n\u221a\n\n!\n\nn\nfn (x) .\n2\n\n(56)\n\n\fExample\nConsider the case n = 15. We expand the right side of (55) as a power series in x, keeping\nenough terms to find A15 (x) without using symmetry. From Section 1.2 we have\n\u03a615 (x) = 1 \u2212 x + x3 \u2212 x4 + x5 \u2212 x7 + x8 ,\nso\nq\n\n\u03a615 (x) = 1 \u2212\n\nAlso,\n\nx x2 7x3 37x4\n\u2212\n+\n\u2212\n+ ***\n2\n8\n16\n128\n\nf15 (x) = x +\nso\ncos\n\n\u221a\n\nand\nq\n\n!\n\n15\nf15 (x)\n2\n\n2 \u03a615 (x) cos\n\nx2 x4 x7\n+\n\u2212\n+ ***\n2\n4\n7\n\n=1\u2212\n\n15x2\n15x3 15x4\n\u2212\n+\n+ ***\n8\n8\n128\n\n!\n\u221a\n15\nf15 (x) = 2 \u2212 x \u2212 4x2 \u2212 x3 + 2x4 + * * * ,\n2\n\nwhich is A15 (x) + O(x5 ) as expected. We can ignore the O(x5 ) term (which in fact vanishes)\nsince we know that deg A15 (x) = \u03c6(15)/2 = 4.\nA reader who attempts similar computations for larger n will soon be convinced that Algorithm D of Section 3.1 is more convenient, if only because all intermediate results are integers\nand there is an easy check on the accuracy of the inner product accumulations.\nUsing (41\u201343) and the fact (an immediate consequence of (4)) that\n\u03a6n (1) =\n\n\u001a\n\nn, if n is prime;\n1, for other square-free n > 1;\n\nwe can verify that (46) and (51\u201356) give sensible\nresults in the case x = 1. For example, we\n\u221a\n\u221a\nhave h(\u221215) = 2, so f15 (1) = 2\u03c0/ 15 and cos( 215 f15 (1)) = cos(\u03c0) = \u22121. Thus (55) gives the\ncorrect value \u22122 of A15 (1).\n\n4.3\n\nThe polynomials Cn and Dn\n\nWe now consider the analogues of (53\u201354) for the Lucas polynomials Cn and Dn . The argument\nis similar to that of Section 4.2, but simpler because the polynomial Ln (x) is symmetric, which\nleads to the simple functional equation (40) for gn (x).\nAssume that n > 1 is square-free, and adopt the notation of Section 2.3. Using (29) in the\ngenerating function (14), we have\n\u221a\n\u0001\nL\u0303n (1/x)/Ln (1/x) = exp 2s\u2032 ngn (x) .\n(57)\n\u221a\nThis shows that exp(2 ngn (x)) is a rational function. From\nL\u0303n (1/x)/Ln (1/x) = L\u0303n (x)/Ln (x)\nwe deduce the functional equation (40), which gives the analytic continuation of gn (x) outside\nthe unit circle. We may also write (57) more simply as\n\u221a\n\u0001\n(58)\nL\u0303n (x)/Ln (x) = exp 2s\u2032 ngn (x) .\nFrom (28) and (58), taking a square root, we obtain\nLn (x) =\n\n\u0001\n\u221a\nFn (x2 ) exp \u2212s\u2032 ngn (x) .\n\nq\n\n15\n\n(59)\n\n\fTheorem 2 Let n > 1 be square-free. The Aurifeuillian factors Fn\u00b1 (x) = Cn (x) \u00b1\nof Fn (x) are given by\nq\n\u221a \u0001\n\u221a\nFn\u00b1 (x) = Fn (x) exp \u00b1 ngn ( x) .\nAlso,\n\nCn (x) =\n\nq\n\nDn (x) =\n\ns\n\nand\n\nFn (x) cosh\n\n\u221a\n\n\u221a \u0001\nngn ( x)\n\n\u221a\n\nnxDn (x)\n(60)\n(61)\n\n\u221a\n\u221a \u0001\nFn (x)\nsinh ngn ( x) .\nnx\n\n(62)\n\nProof\nRecall that the Aurifeuillian factors Fn\u00b1 (x) = Cn (x) \u00b1\nThus (60) follows from (59). Since\n\n\u221a\n\u221a\nnxDn (x) of Fn (x) are Ln (\u00b1 x).\n\nLn (x) + Ln (\u2212x) = 2Cn (x2 )\nand\n\n\u221a\nLn (x) \u2212 Ln (\u2212x) = \u22122s\u2032 x nDn (x2 ),\n\nwe easily deduce (61\u201362).\n\n4.4\n\n\u2737\n\nApplication to integer factorization\n\nIn this section we illustrate how the results of Sections 3.2 and 4.3 can be used to obtain factors\nof integers of the form an \u00b1 bn . Our examples are for illustrative purposes, so are small enough\nto be verified by hand. Many larger examples can be found in [6, 7].\nAs usual, n > 1 is a square-free integer. Recall the definition of Fn (x) from Section 1.1.\nNote that the polynomial Fn (x) is a factor of xn \u00b1 1 (where the sign is \"\u2212\" if n = 1 mod 4, and\n\"+\" otherwise).\n\u221a\nIf x has the form m2 n, where m is a positive integer, then nx = mn is an integer, and\nthe Aurifeuillian factors Fn\u00b1 (x) = Cn (x) \u00b1 mnDn (x) give integer factors of Fn (x), and hence of\nxn \u00b1 1 = m2n nn \u00b1 1. For example, if m = nk , we obtain factors of n(2k+1)n \u00b1 1.\nMore generally, if m = p/q is rational, we obtain rational factors of xn \u00b1 1 = p2n q \u22122n nn \u00b1 1,\nand thus integer factors of p2n nn \u00b1 q 2n . We consider one example later, but for the moment we\ncontinue to assume that m is an integer.\nBefore giving numerical examples, we state explicitly how the results of Section 4.3 can be\nused to compute Fn\u00b1 (m2 n).\nTheorem 3 Let m, n be positive integers, n > 1 square-free, x = m2 n, and \u03bb = \u03c6(2n)/2 .\nThen the Aurifeuillian factors Fn\u00b1 (x) of Fn (x) are given by\nFn\u2212 (x) = \u230aF\u0302 + 1/2\u230b\nand\nFn+ (x) = Fn (x)/Fn\u2212 (x),\nwhere\nF\u0302 =\n\n\uf8eb\n\n\uf8f6\n\nX (n | 2j + 1)\n1 \u03bb\u22121\n\uf8f8.\nFn (x) exp \uf8ed\u2212\nm j=0 (2j + 1)xj\n\nq\n\n16\n\n\fProof\n\u221a\nFrom (60), using the functional equation (40) and the power series (38) for gn (1/ x), we\nhave\n\uf8f6\n\uf8eb\n\u221e\nq\nX\n(n\n|\n2j\n+\n1)\n1\n\uf8f8.\nFn\u2212 (x) = Fn (x) exp \uf8ed\u2212\nm j=0 (2j + 1)xj\n\nThus, we only have to show that the error incurred by truncating the power series after \u03bb terms\nis less than 1/2 in absolute value, i.e. that |F\u0302 \u2212 Fn\u2212 | < 1/2.\nIf x < 5 we must have m = 1, n = 2 or 3, x = n, \u03bb = 1. In both cases Fn\u2212 (n) = 1 and it is\neasy to verify that 1/2 < F\u0302 < 3/2. Thus, from now on we assume that x \u2265 5.\nLet\n\u221e\n(n | 2j + 1)\n1 X\n.\nt=\nm j=\u03bb (2j + 1)xj\nSince m \u2265 1, \u03bb \u2265 1, x \u2265 5, and the Jacobi symbol is 0 or \u00b11, we have\n|t| \u2264\n\n\u221e\nX\n\nx\u2212j\n\u2264\n(2j + 1)\nj=\u03bb\n\nso\n|t| \u2264 5\n\n\u221a\n\n\u0012\n\n1\n1\n1\n+\n+\n+ * * * x\u2212\u03bb\n3 5 * 5 7 * 52\n\u0013\n\n!\n\u221a !\n1+ 5\n\u2212 1 x\u2212\u03bb < 0.3802x\u2212\u03bb .\n5 ln\n2\n\n(63)\n\nIn particular, |t| < 0.3802/x < 0.08, so\n| exp(t) \u2212 1| <\nNow F\u0302 = Fn\u2212 exp(t), so\n\n0.3802x\u2212\u03bb\n|t|\n<\n< 0.4x\u2212\u03bb .\n1 \u2212 |t|/2\n0.96\n\n|F\u0302 \u2212 Fn\u2212 | = Fn\u2212 | exp(t) \u2212 1|.\n\n(64)\n\n(65)\n\nApplying Lemma 2 of Section 2.1 with R = 5 gives\nFn (x) < exp(1/4)x\u03c6(2n) ,\nbut \u03c6(2n) = 2\u03bb and Fn\u2212 is the smaller factor of Fn , so\nFn\u2212 (x) \u2264\n\nq\n\nFn (x) < exp(1/8)x\u03bb .\n\n(66)\n\nFrom (64\u201366) we finally obtain the bound\n\n|F\u0302 \u2212 Fn\u2212 | < 0.4 exp(1/8) < 0.5,\nwhich completes the proof.\n\n\u2737\n\nSince the argument of the exponential in Theorem 3 is \u22121/m+O(1/n) as n \u2192 \u221e, we have the\nfollowing result, which sheds some light on the ratio of the Aurifeuillian factors. (The Corollary\nstrictly follows from Theorem 3 only if m is an integer, but from the proof of Theorem 3 it is\nclear that the Corollary is also valid for rational m.)\nCorollary 1 Let x = m2 n where m > 0 is rational n > 1 is an integer. Consider m fixed as\nn \u2192 \u221e through square-free values. Then the Aurifeuillian factors Fn\u00b1 (x) of Fn (x) satisfy\nFn+ (x)/Fn\u2212 (x) = exp(2/m) + O(1/n).\n\n17\n\n\fExamples\n1. To start with a simple example, consider n = 2, m = 2, so x = m2 n = 8 and \u03bb = 1. In\nTheorem 3 we have F2 (x) = x2 + 1 = 65,\nF\u0302 =\n\nq\n\nF2 (x) exp(\u22121/m) =\n\n\u221a\n\n65 exp(\u22121/2) = 4.89 * * *\n\nand rounding to the nearest integer gives the factor 5 of 65.\n2. A similar but less trivial example is n = 2, m = 25 , x = m2 n = 211 . Here F2 (x) =\nx2 + 1 = 222 + 1 and\nF\u0302 =\n\nq\n\nF2 (x) exp(\u22121/m) =\n\np\n\n222 + 1 exp(\u22122\u22125 ) = 1984.98 * * *\n\nwhich on rounding gives the factor F2\u2212 = 1985 of 222 + 1. By division we find F2+ = 2113, so\nthe complete factorization is 222 + 1 = 5 * 397 * 2113 .\n3. Now consider n = 5, m = 3, so x = m2 n = 45 and \u03bb = \u03c6(10)/2 = 2. In this case\nF5 (x) = \u03a65 (x) = (x5 \u2212 1)/(x \u2212 1) = 4193821,\nF\u0302 =\n\nq\n\n1\n1\nF5 (x) exp \u2212 +\nm 3m3 n\n\u0012\n\n\u0013\n\n=\n\n\u221a\n\n4193821 exp(\u2212134/405) = 1470.99924 * * *\n\nand rounding to the nearest integer gives the factor 1471 of F5 (x). By division we obtain the\nother factor 2851. In this example, but not in general, the Aurifeuillian factors are prime.\n4. Now consider a composite n, say n = 15. To keep the arithmetic easy we take m = 1, so\nx = 15 and\nF15 (x) = \u03a615 (\u2212x) = x8 + x7 \u2212 x5 \u2212 x4 \u2212 x3 + x + 1 = 2732936641.\nThe example in Section 3.2 shows how we can use Algorithm L to compute\nC15 (x) = x4 + 8x3 + 13x2 + 8x + 1\nand\nD15 (x) = x3 + 3x2 + 3x + 1.\nEvaluating the polynomials, we find\nC15 (15) = 80671, D15 (15) = 4096,\nso the Aurifeuillian factors of F15 (15) are 80671 \u00b1 15 * 4096. This gives 19231 and 142111,\nwhich can easily be verified to be factors of 1515 + 1. The \"algebraic\" factors (153 + 1)/16 and\n(155 + 1)/16 allow us to complete the factorization:\n1515 + 1 = 24 * 31 * 211 * 1531 * 19231 * 142111\nAlternatively, instead of evaluating C15 (15) and D15 (15), we can use Theorem 3. We have\n\u03bb = \u03c6(15)/2 = 4. Since (15|3) = (15|5) = 0 and (15|7) = 1, the computation gives\nF\u0302 =\n\n1\nF15 (x) exp \u22121 \u2212 3\n7n\n\nq\n\n\u0012\n\n\u0013\n\n= 19231.00217 * * *\n\nand rounding to the nearest integer gives the factor 19231 of F15 (15).\n\n18\n\n\f5. To conclude, we give an example where m = p/q is rational but not an integer. Consider\n\u221a\nn = 7, p = 2, q = 5, so x = p2 n/q 2 = 28/25 and nx = pn/q = 14/5. We have\nF7 (x) = \u03a67 (\u2212x) =\n\nx7 + 1\n287 + 257\n=\nx+1\n53 * 256\n\n\u221a\nTheorem 3 is not applicable. Because x is close to 1, the series for g7 (1/ x) converges rather\nslowly, and we need to take at least 35 terms to obtain sufficient accuracy. However, using\nAlgorithm L we easily find that\nC7 (x) = x3 + 3x2 + 3x + 1, D7 (x) = x2 + x + 1,\nso Horner's rule gives\nC7 (x) = 148877/56 , D7 (x) = 2109/54 ,\n\n\u221a\nand C7 (x) \u00b1 nxD7 (x) gives 296507/56 and 1247/56 . Thus, we have obtained factors 296507\nand 1247 of (257 + 287 )/53. The larger factor is prime, so it is easy to deduce the complete\nfactorization\n257 + 287 = 29 * 43 * 53 * 296507\nAcknowledgements\nThanks are due to Brendan McKay for suggesting the use of the generating function (14),\nto Emma Lehmer and an anonymous referee for helpful comments on the exposition, to Hans\nRiesel for his kind assistance with the solution of exercise A6.2 of [24], and to Sam Wagstaff and\nHugh Williams for providing copies of several references which were difficult to find in Australia.\n\nReferences\n[1] A. V. Aho, J. E. Hopcroft and J. D. Ullman, The Design and Analysis of Computer Algorithms, Addison-Wesley, Menlo Park, Calif., 1974, Chapter 8.\n[2] A. Aurifeuille and H. Le Lasseur, see [20], page 276, or [21], page 785.\n[3] N. G. W. H. Beeger, \"On a new quadratic form for certain cyclotomic polynomials\", Nieuw\nArch. Wisk. (2), 23 (1951), 249-252.\n[4] R. P. Brent, F. G. Gustavson and D. Y. Y. Yun, \"Fast solution of Toeplitz systems of\nequations and computation of Pad\u00e9 approximants\", J. Algorithms 1 (1980), 259-295.\n[5] R. P. Brent and H. T. Kung, \"Fast algorithms for manipulating formal power series\",\nJ. ACM 25 (1978), 581-595.\n[6] R. P. Brent and H. J. J. te Riele, Factorizations of an \u00b1 1, 13 \u2264 a < 100, Report NMR9212, Department of Numerical Mathematics, Centrum voor Wiskunde en Informatica,\nAmsterdam, June 1992.\n[7] J. Brillhart, D. H. Lehmer, J. L. Selfridge, B. Tuckerman and S. S. Wagstaff, Jr., Factorizations of bn \u00b1 1, b = 2, 3, 5, 6, 7, 10, 11, 12 up to high powers, second edition, American\nMathematical Society, Providence, Rhode Island, 1988.\n[8] A. J. C. Cunningham, \"Factorisation of N = y y \u2213 1 and xxy \u2213 y xy \", Messenger of Math.\n(2), 45 (1915), 49-75.\n[9] A. J. C. Cunningham and H. J. Woodall, Factorisation of y n \u2213 1, y = 2, 3, 5, 6, 7, 10, 11, 12\nup to high powers (n), Hodgson, London, 1925.\n19\n\n\f[10] H. Davenport, Multiplicative Number Theory, second edition (revised by H. L. Montgomery), Springer-Verlag, New York, 1980.\n[11] P. G. Lejeune Dirichlet, Vorlesungen \u00fcber Zahlentheorie, fourth edition, Friedr. Vieweg &\nSohn, Braunschweig, 1894, Chapter 5 and Supplement 7.\n[12] C. F. Gauss, Disquisitiones Arithmeticae, G. Fleischer, Leipzig, 1801, Art. 356-357.\nReprinted in Carl Friedrich Gauss Werke, Band 1, Georg Olms Verlag, Hildesheim, 1981.\n[13] G. H. Hardy and E. M. Wright, An Introduction to the Theory of Numbers, fifth edition,\nClarendon Press, Oxford, 1984, Ch. 16.\n[14] D. E. Knuth, The Art of Computer Programming, Volume 2: Seminumerical Algorithms\n(second edition), Addison-Wesley, Menlo Park, 1981, Chapter 3.\n[15] M. Kraitchik, \"D\u00e9composition de an \u00b1 bn en facteurs dans le cas o\u00f9 nab est un carr\u00e9 parfait\navec une table des d\u00e9compositions num\u00e9riques pour toutes les valeurs de a et b inf\u00e9rieures\n\u00e0 100\", Gauthiers-Villars, Paris, 1922.\n[16] M. Kraitchik, Recherches sur la Th\u00e9orie des Nombres, Volume 1, Gauthiers-Villars, Paris,\n1924.\n[17] M. Kraitchik, Introduction \u00e0 la Th\u00e9orie des Nombres, Gauthiers-Villars, Paris, 1952.\n[18] Edmund Landau, Vorlesungen \u00fcber Zahlentheorie, Band 1(1): Aus der elementaren und\nadditiven Zahlentheorie, Leipzig, 1927. English translation: Elementary Number Theory,\nChelsea, New York, 1958.\n[19] Serge Lang, Cyclotomic Fields I and II, combined second edition, Graduate Texts in Mathematics 126, Springer-Verlag, New York, 1990.\n[20] E. Lucas, \"Th\u00e9or\u00e8mes d'arithm\u00e9tique\", Atti. R. Acad. Sc. Torino 13 (1877-8), 271-284.\n[21] E. Lucas, \"Sur la s\u00e9rie r\u00e9currente de Fermat\", Bull. Bibl. Storia Sc. Mat. e Fis. 11 (1878),\n783-789.\n[22] E. Lucas, \"Sur les formules de Cauchy et de Lejeune-Dirichlet\", Ass. Fran\u00e7aise pour l'Avanc.\ndes Sci., Comptes Rendus 7 (1878), 164-173.\n[23] S. Ramanujan, \"On certain trigonometrical sums and their applications in the theory of\nnumbers\", Trans. Cambridge Philos. Soc. 22, 13 (1918), 259-276. Reprinted in Collected\nPapers of Srinivasa Ramanujan (edited by G. H. Hardy, P. V. Seshu Aiyar and B. M.\nWilson), Cambridge Univ. Press, 1927.\n[24] Hans Riesel, Prime Numbers and Computer Methods for Factorization, Birkh\u00e4user, Boston,\n1985.\n[25] John Riordan, An Introduction to Combinatorial Analysis, Princeton University Press, New\nJersey, 1978, Ch. 2, exercise 27.\n[26] A. Schinzel, \"On the primitive prime factors of an \u2212 bn \", Proc. Cambridge Philos. Soc. 58\n(1962), 555-562. MR 26#1280\n[27] Peter Stevenhagen, \"On Aurifeuillian factorizations\", Nederl. Akad. Wetensch. Indag.\nMath. 49 (1987), 451-468. MR 89a:11015\n\n20\n\n\f[28] H. W. Turnbull, Theory of Equations (fifth edition), Oliver and Boyd, Edinburgh, 1952,\nSec. 32.\n[29] B. L. van der Waerden, Algebra, Vol. 1 (English translation by Fred Blum, fifth edition),\nFrederick Ungar, New York, 1953, Ch. 7.\n[30] L. C. Washington, Introduction to Cyclotomic Fields, Graduate Texts in Mathematics 83,\nSpringer-Verlag, New York, 1982.\n\n21\n\n\f"}