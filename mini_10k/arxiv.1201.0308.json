{"id": "http://arxiv.org/abs/1201.0308v2", "guidislink": true, "updated": "2012-02-06T16:31:01Z", "updated_parsed": [2012, 2, 6, 16, 31, 1, 0, 37, 0], "published": "2011-12-31T21:11:53Z", "published_parsed": [2011, 12, 31, 21, 11, 53, 5, 365, 0], "title": "On the combinatorics of sparsification", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1201.3264%2C1201.2863%2C1201.6040%2C1201.4725%2C1201.5630%2C1201.5510%2C1201.6416%2C1201.4734%2C1201.3770%2C1201.2097%2C1201.1799%2C1201.2545%2C1201.4395%2C1201.1309%2C1201.2360%2C1201.5337%2C1201.2417%2C1201.0821%2C1201.5657%2C1201.5645%2C1201.3468%2C1201.0776%2C1201.1020%2C1201.1211%2C1201.4267%2C1201.1041%2C1201.5350%2C1201.4873%2C1201.2280%2C1201.2154%2C1201.1591%2C1201.3793%2C1201.5637%2C1201.2289%2C1201.0175%2C1201.4977%2C1201.3445%2C1201.5673%2C1201.3799%2C1201.1428%2C1201.5203%2C1201.1995%2C1201.5909%2C1201.1918%2C1201.0671%2C1201.1671%2C1201.3241%2C1201.2051%2C1201.0263%2C1201.3117%2C1201.1023%2C1201.5602%2C1201.2814%2C1201.1793%2C1201.0961%2C1201.4769%2C1201.0081%2C1201.2174%2C1201.5973%2C1201.3058%2C1201.5788%2C1201.2234%2C1201.0540%2C1201.2748%2C1201.0023%2C1201.3781%2C1201.0977%2C1201.4635%2C1201.6482%2C1201.1375%2C1201.0639%2C1201.2809%2C1201.3464%2C1201.4241%2C1201.1109%2C1201.3409%2C1201.4741%2C1201.5971%2C1201.2485%2C1201.0667%2C1201.5894%2C1201.5604%2C1201.5415%2C1201.5802%2C1201.3882%2C1201.5502%2C1201.1119%2C1201.0308%2C1201.0590%2C1201.6327%2C1201.2153%2C1201.3753%2C1201.5493%2C1201.4979%2C1201.4647%2C1201.0029%2C1201.6341%2C1201.6144%2C1201.0341%2C1201.2003%2C1201.4955&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the combinatorics of sparsification"}, "summary": "Background: We study the sparsification of dynamic programming folding\nalgorithms of RNA structures. Sparsification applies to the mfe-folding of RNA\nstructures and can lead to a significant reduction of time complexity. Results:\nWe analyze the sparsification of a particular decomposition rule, $\\Lambda^*$,\nthat splits an interval for RNA secondary and pseudoknot structures of fixed\ntopological genus. Essential for quantifying the sparsification is the size of\nits so called candidate set. We present a combinatorial framework which allows\nby means of probabilities of irreducible substructures to obtain the expected\nsize of the set of $\\Lambda^*$-candidates. We compute these expectations for\narc-based energy models via energy-filtered generating functions (GF) for RNA\nsecondary structures as well as RNA pseudoknot structures. For RNA secondary\nstructures we also consider a simplified loop-energy model. This combinatorial\nanalysis is then compared to the expected number of $\\Lambda^*$-candidates\nobtained from folding mfe-structures. In case of the mfe-folding of RNA\nsecondary structures with a simplified loop energy model our results imply that\nsparsification provides a reduction of time complexity by a constant factor of\n91% (theory) versus a 96% reduction (experiment). For the \"full\" loop-energy\nmodel there is a reduction of 98% (experiment).", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1201.3264%2C1201.2863%2C1201.6040%2C1201.4725%2C1201.5630%2C1201.5510%2C1201.6416%2C1201.4734%2C1201.3770%2C1201.2097%2C1201.1799%2C1201.2545%2C1201.4395%2C1201.1309%2C1201.2360%2C1201.5337%2C1201.2417%2C1201.0821%2C1201.5657%2C1201.5645%2C1201.3468%2C1201.0776%2C1201.1020%2C1201.1211%2C1201.4267%2C1201.1041%2C1201.5350%2C1201.4873%2C1201.2280%2C1201.2154%2C1201.1591%2C1201.3793%2C1201.5637%2C1201.2289%2C1201.0175%2C1201.4977%2C1201.3445%2C1201.5673%2C1201.3799%2C1201.1428%2C1201.5203%2C1201.1995%2C1201.5909%2C1201.1918%2C1201.0671%2C1201.1671%2C1201.3241%2C1201.2051%2C1201.0263%2C1201.3117%2C1201.1023%2C1201.5602%2C1201.2814%2C1201.1793%2C1201.0961%2C1201.4769%2C1201.0081%2C1201.2174%2C1201.5973%2C1201.3058%2C1201.5788%2C1201.2234%2C1201.0540%2C1201.2748%2C1201.0023%2C1201.3781%2C1201.0977%2C1201.4635%2C1201.6482%2C1201.1375%2C1201.0639%2C1201.2809%2C1201.3464%2C1201.4241%2C1201.1109%2C1201.3409%2C1201.4741%2C1201.5971%2C1201.2485%2C1201.0667%2C1201.5894%2C1201.5604%2C1201.5415%2C1201.5802%2C1201.3882%2C1201.5502%2C1201.1119%2C1201.0308%2C1201.0590%2C1201.6327%2C1201.2153%2C1201.3753%2C1201.5493%2C1201.4979%2C1201.4647%2C1201.0029%2C1201.6341%2C1201.6144%2C1201.0341%2C1201.2003%2C1201.4955&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Background: We study the sparsification of dynamic programming folding\nalgorithms of RNA structures. Sparsification applies to the mfe-folding of RNA\nstructures and can lead to a significant reduction of time complexity. Results:\nWe analyze the sparsification of a particular decomposition rule, $\\Lambda^*$,\nthat splits an interval for RNA secondary and pseudoknot structures of fixed\ntopological genus. Essential for quantifying the sparsification is the size of\nits so called candidate set. We present a combinatorial framework which allows\nby means of probabilities of irreducible substructures to obtain the expected\nsize of the set of $\\Lambda^*$-candidates. We compute these expectations for\narc-based energy models via energy-filtered generating functions (GF) for RNA\nsecondary structures as well as RNA pseudoknot structures. For RNA secondary\nstructures we also consider a simplified loop-energy model. This combinatorial\nanalysis is then compared to the expected number of $\\Lambda^*$-candidates\nobtained from folding mfe-structures. In case of the mfe-folding of RNA\nsecondary structures with a simplified loop energy model our results imply that\nsparsification provides a reduction of time complexity by a constant factor of\n91% (theory) versus a 96% reduction (experiment). For the \"full\" loop-energy\nmodel there is a reduction of 98% (experiment)."}, "authors": ["Fenix W. D. Huang", "Christian M. Reidys"], "author_detail": {"name": "Christian M. Reidys"}, "author": "Christian M. Reidys", "arxiv_comment": "27 pages, 12 figures", "links": [{"href": "http://arxiv.org/abs/1201.0308v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1201.0308v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "32Q55", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1201.0308v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1201.0308v2", "journal_reference": null, "doi": null, "fulltext": "arXiv:1201.0308v2 [math.CO] 6 Feb 2012\n\nOn the combinatorics of sparsification\nFenix W.D. Huang1 and Christian M. Reidys\u22171\n1 Department\n\nof Mathematic and Computer science, University of Southern Denmark, Campusvej 55, DK-5230 Odense M, Denmark\n\nEmail: Fenix W.D. Huang - fenixprotoss@gmail.com; Christian M. Reidys\u2217 - duck@santafe.edu;\n\u2217 Corresponding\n\nauthor\n\nAbstract\nBackground: We study the sparsification of dynamic programming folding algorithms of RNA structures.\nSparsification applies to the mfe-folding of RNA structures and can lead to a significant reduction of time complexity.\nResults: We analyze the sparsification of a particular decomposition rule, \u039b\u2217 , that splits an interval for RNA\nsecondary and pseudoknot structures of fixed topological genus. Essential for quantifying the sparsification is the\nsize of its so called candidate set. We present a combinatorial framework which allows by means of probabilities of\nirreducible substructures to obtain the expected size of the set of \u039b\u2217 -candidates. We compute these expectations\nfor arc-based energy models via energy-filtered generating functions (GF) for RNA secondary structures as well\nas RNA pseudoknot structures. For RNA secondary structures we also consider a simplified loop-energy model.\nThis combinatorial analysis is then compared to the expected number of \u039b\u2217 -candidates obtained from folding\nmfe-structures. In case of the mfe-folding of RNA secondary structures with a simplified loop energy model our\nresults imply that sparsification provides a reduction of time complexity by a constant factor of 91% (theory)\nversus a 96% reduction (experiment). For the \"full\" loop-energy model there is a reduction of 98% (experiment).\nConclusions: Our result show that the polymer-zeta property, describing the probability of an irreducible\nstructure over an interval of length m does not hold for RNA structures. As a result sparsification of the \u039b\u2217 decomposition rule does not lead to a linear reduction of the set of candidates. We show that under general\nassumptions the expected number of \u039b\u2217 -candidates is \u0398(n2 ), the constant reduction being in the range of 95%.\nThe sparsification of the \u039b\u2217 -decomposition rule for RNA pseudoknotted structures of genus 1 leads to an expected\nnumber of candidates of \u0398(n2 ). The effect of sparsification is sensitive to the employed energy model.\n1\n\n\fBackground\nAn RNA sequence is a linear, oriented sequence of the nucleotides (bases) A,U,G,C. These sequences \"fold\"\nby establishing bonds between pairs of nucleotides. Bonds cannot form arbitrarily: a nucleotide can at most\nestablish one Watson-Crick base pair A-U or G-C or a wobble base pair U-G, and the global conformation\nof an RNA molecule is determined by topological constraints encoded at the level of secondary structure,\ni.e., by the mutual arrangements of the base pairs [1].\nSecondary structures can be interpreted as (partial) matchings in a graph of permissible base pairs [2].\nThey can be represented as diagrams, i.e. graphs over the vertices 1, . . . , n, drawn on a horizontal line with\nbonds (arcs) in the upper halfplane. In this representation one refers to a secondary structure without\ncrossing arcs as a simple secondary structure and pseudoknot structure, otherwise, see Figure 1.\n76\n\n3'\n\n5'\n70\n\n(A)\n60\n10\n\n50\n\n20\n30\n\n1\n\n40\n\n20\n\n10\n\n60\n\n50\n\n40\n\n30\n\n70\n\n5'\n10\n\n(B)\n20\n\n30\n1\n\n40\n\n10\n\n20\n\n30\n\n40\n\n48\n\n3' 48\n\nFigure 1: RNA structures as planar graphs and diagrams. (A) an RNA secondary structure and (B) an RNA\npseudoknot structure.\n\nFolded configurations are energetically somewhat optimal. Here energy means free energy, which is\ndominated by the loops forming between adjacent base pairs and not by the hydrogen bonds of the individual\nbase pairs [3]. In addition sterical constraints imply certain minimum arc-length conditions for minimum\n2\n\n\ffree energy configurations [4]. In particular, only configurations without isolated bonds and without bonds of\nlength one (formed by immediately subsequent nucleotides) are observed in RNA structures. In this paper,\noptimize a problem we meas maximize the score but not to minimize the free energy.\nFor a given RNA sequence polynomial-time dynamic programming (DP) algorithms can be devised,\nfinding such minimal energy configurations. The most commonly used tools predicting simple RNA secondary\nstructure mfold [5] and the Vienna RNA Package [6], are running at O(N 2 ) space and O(N 3 ) time solution.\nIn the following we omit \"simple\" and refer to secondary structures containing crossing arcs as pseudoknot\nstructures.\nGeneralizing the matrices of the DP-routines of secondary structure folding [5,6] to gap-matrices [7], leads\nto a DP-folding of pseudoknotted structures [7] (pknot-R&E) with O(n4 ) space an O(n6 ) time complexity.\nThe following references provide a certainly incomplete list of DP-approaches to RNA pseudoknot structure\nprediction using various structure classes characterized in terms of recursion equations and/or stochastic\ngrammars: [7\u201319]. The most efficient algorithm for pseudoknot structures is [14] (pknotsRG) having O(n2 )\nspace and O(n4 ) time complexity. This algorithm however considers only a few types of pseudoknots.\nRNA secondary structures are exactly structures of topological genus zero [20]. The topological classification of RNA structures [21\u201323] has recently been translated into an efficient DP algorithm [19]. Fixing the\ntopological genus of RNA structures implies that there are only finitely many types, the so called irreducible\nshadows [23].\nSparsification is a method tailored to speed up DP-algorithms predicting mfe-secondary structures [24,25].\nThe idea is to prune certain computation paths encountered in the DP-recursions, see Figure 2. To make\nthe key point, let us consider the case of RNA secondary structure folding. Here sparsification reduces the\nDP-recursion paths to be based on so called candidates. A candidate is in this case an interval, for which\nthe optimal solution cannot be written as a sum of optimal solutions of sub-intervals, see Figure 3. Tracing\nback these candidates gives rise to \"irreducible\" structures and the crucial observation is here that these\nirreducibles appear only at a low rate. This means that there are only relatively few candidates, which in\nturn implies a significant reduction in time and space complexity.\nSparsification has been applied in the context of RNA-RNA interaction structures [26] as well as RNA\npseudoknot structures [27]. In difference to RNA secondary structures, however, not every decomposition\nrule in the DP-folding of RNA pseudoknot structures is amendable to sparsification. By construction, sparsification can only be applied for calculating mfe-energy structures. Since the computation of the partition\nfunction [12, 28] needs to take into account all sub-structures, sparsification does not work.\n3\n\n\fi\n\nk k+1\n\nLi,k\n\nq q+1\n\nj\n\nLk+1,q\n\nLq+1,j\nLk+1,j\n\nLi,q\n\nFigure 2: Sparsification of secondary structure folding. Suppose the optimal solution Li,j is obtained from the\noptimal solutions Li,k , Lk+1,q and Lq+1,j . Based on the recursions of the secondary structures, Li,k and Lk+1,q\nproduce an optimal solution of Li,q . Similarly, Lk+1,q and Lq+1,j produce an optimal solution of Lk+1,j . Now, in\norder to obtain an optimal solution of Li,j it is sufficient to consider either the grouping Li,q and Lq+1,j or Li,k and\nLk+1,j .\n\ni\n\nj\n\nk1\n\n(A)\n\ni\n\nk2\n\n(B)\n\nj\n\ni\n\nk3\n\nj\n\n(C)\n\nFigure 3: What sparsification can and cannot prune: (A) and (B) are two computation paths yielding the same\noptimal solution. Sparsification reduces the computation to path (A) where Si,k1 is irreducible. (C) is another\ncomputation path with distinct leftmost irreducible over a different interval, hence representing a new candidate that\ncannot be reduced to (A) by the sparsification.\n\nFor the mfe-folding of RNA secondary structures considerable attention has been paid in order to validate\nthat the set of candidates is small. The idea here is that irreducibles are contained in short, \"rainbow\"-like\narcs. To be precise, the gain is O(n), if secondary structure satisfy the so called polymer-zeta property [29,30]:\nThe latter quantifies the probability of an arc of length m to be \u2264 b m\u2212c , where b > 0, c > 1. Note that\nthese arcs confine in case of secondary structures irreducible structures, that is arcs and irreducibility are\ntightly connected.\nIn pseudoknotted RNA structures however, we have crossing arcs and the associated notion of irreducible\nstructures differs significantly from that of RNA secondary structures. The polymer-zeta property is theoretically justified by means of modeling the 2D folding of a polymer chain as a self-avoiding walk (SAW)\nin a 2D lattice [31]. More evidence of the polymer-zeta property for RNA secondary structures has been\ncollected via the NCBI database [32] of mfe-RNA structures.\nIn this paper we study the sparsification of the decomposition rule \u039b\u2217 that splices an interval [25, 27] in\n4\n\n\fthe context of the DP-folding of RNA pseudoknot structures of fixed topological genus. Our paper provides\na combinatorial framework to quantify the effects of sparsifying the \u039b\u2217 -decomposition rule.\nWe shall prove that the candidate set [24, 25, 27] is indeed small. Our argument is based on assuming a\nspecific distribution of irreducible structures within mfe-structures. Namely we assume these irreducibles to\nP\nappear with probability f \u2217 (n, j)/f (n, j), where we assume e to be a fixed parameter and F(z, e) = fn,j z n ej\n\nto be a bivariate (energy-filtered) generating function whose associated generation function of irreducibles\nP \u2217 n j\nis F\u2217 (z, e) = fn,j\nz e .\n\nWhile this energy-filtration seems to be reparameterization of the notion of \"stickiness\" [33], it is really\n\nfundamentally different. This becomes clear when considering loop-based energies which distinguishes energy\nand arcs. Clearly when folding random sequences one weights the latter around 6/16, reminiscent of the\nprobability of two given positions to be compatible. The energy however is fairly independent as it really\ndepends on the particular loop-type.\nWe obtain these energy-filtered GFs also for RNA pseudoknot structures of fixed topological genus. This\nprovides new insights into the improvements of the sparsification of the concatenation-rule \u039b\u2217 in the presence\nof cross serial interactions. Our observations complement the detailed analysis of Backofen [25,27]. We show\nthat although for pseudoknot structures of fixed topological genus [22, 23] the effect of sparsification on\nthe global time complexity is still unclear, the decomposition rule that splits an interval can be sped up\nsignificantly.\n\nSparsification\nThe general idea of sparsification [24, 25, 27] is following: let V = {v1 , v2 , . . .} be a set whose elements vi are\nunions of pairwise disjoint intervals. Let furthermore Lv denote an optimal solution (a positive number or\nscore) of the DP-routine over v. By assumption Lv is recursively obtained. Suppose the optimal solution Lv\n \u0307 2 \u222av\n \u0307 3 . Then, under certain circumstances, the DP-routine\nis given by Lv = Lv1 + Lv2 + Lv3 , where v = v1 \u222av\nmay interpret Lv either as (Lv1 + Lv2 ) + Lv3 or as Lv1 + (Lv2 + Lv3 ), see Figure 4. To be precise, this\nsituation is encountered iff\n \u0307 2 via \u039b2 and Lv is\n\u2022 there exists an optimal solution Lv1\u2032 for a sub-structure over v1\u2032 where v1\u2032 = v1 \u222av\nobtained from Lv1\u2032 and Lv3 via \u039b1 ,\n \u0307 3 via \u039b3 and Lv is\n\u2022 there exists an optimal solution Lv2\u2032 for a sub-structure over v2\u2032 where v2\u2032 = v2 \u222av\nobtained by Lv1 and Lv2\u2032 via \u039b1 .\n\n5\n\n\fGiven a decomposition\nLv = Lv1 + Lv2 +Lv3 ,\n| {z }\n\u039b2\n\n{z\n\n|\n\n}\n\n\u039b1\n\nwe call \u039b2 s-compatible to \u039b1 if there exists a decomposition rule \u039b3 such that\nLv = Lv1 + Lv2 + Lv3 .\n| {z }\n\u039b3\n\n{z\n\n|\n\n}\n\n\u039b1\n\nNote that if \u039b2 is s-compatible to \u039b1 then \u039b3 is s-compatible to \u039b1 . To summarize\nDefinition 1. (s-compatible) Suppose Lv is the optimal solution for Sv over v, Lv = Lv1\u2032 + Lv3 under\ndecomposition rule \u039b1 . Lv1 is obtained from two optimal solutions Lv1 and Lv2 under rule \u039b2 . Then \u039b2 is\ncalled s-compatible to \u039b1 if there exist some rule \u039b3 such that Lv2\u2032 = Lv2 + Lv3 and Lv = Lv1 + Lv2\u2032 .\n\nLv\n\nLv\nL1\n\nL1\n\nL v'\n\nL v'\n\n2\n\n1\n\nL2\n\nLv\n\n1\n\nL3\n\nLv\n\n2\n\nLv\n\nLv\n\n1\n\n3\n\nLv\n\n2\n\nLv\n\n3\n\nFigure 4: Sparsification: Lv is alternatively realized via Lv1 and Lv2\u2032 , or Lv1\u2032 and Lv3 . Thus it is sufficient to only\nconsider one of the computation paths.\nFigure 4 depicts two such ways that realize the same optimal solution Lv . Sparsification prunes any such\nmultiple computations of the same optimal value.\nWe next come to the important concept of candidates. The latter mark the essential computation paths\nfor the DP-routine.\nDefinition 2. (Candidates) Suppose Lv is an optimal solution. We call v is a \u039b-candidate if for any v1 ( v\n \u0307 2 , we have\nobtained by \u039b and v = v1 \u222av\nLv > Lv1 + Lv2\nand we shall denote the set of \u039b-candidates set by Q\u039b .\nLemma 1. [24, 27] Suppose \u039b2 is s-compatible to \u039b1 then any optimal solution Lv can be obtained via\n\u039b2 -candidates.\n6\n\n\fBy construction a \u039b2 -candidate v is a union of disjoint intervals such that its optimal solution Lv cannot\nbe obtained via a \u039b2 -splitting. This optimal solution allows to construct a non-unique arc-configuration (substructure) over v [5,6] and the above \u039b2 -splitting consequently translates into a splitting of this sub-structure.\nThis connects the notion of \u039b2 -candidates with that of sub-structures and shows that a \u039b2 -candidate implies\nan sub-structure that is \u039b2 -irreducible.\nIn the case of sparsification of RNA secondary structures we have one basic decomposition rule \u039b\u2217 acting\non intervals, namely \u039b\u2217 splices an interval into two disjoint, subsequent intervals. The implied notion of a\n\u039b\u2217 -irreducible sub-structure is that of a sub-structure nested in an maximal arc, where maximal refers to\nthe partial order (i, j) \u2264 (i\u2032 , j \u2032 ) iff i\u2032 \u2264 i \u2227 j \u2264 j \u2032 . This observation relates irreducibility to that or arcs and\nfollowing this line of thought [24] identifies a specific property of polymer-chains introduced in [29, 30] to be\nof relevance for the size of candidate sets:\nDefinition 3. (Polymer-zeta property) Let P (i, j) denotes the probability of a structure over an interval\n[i, j] under some decomposition rule \u039b. Then we say \u039b follows the polymer-zeta property if P (i, j) = bm\u2212c\nfor some constant b, c > 0.\nThis property is theoretically justified by means of modeling the 2D folding of a polymer chain as a\nself-avoiding walk (SAW) in a 2D lattice [31].\n\nRNA secondary structures\nIn this section we recall some results of [24,25] on the sparsification of RNA secondary structures. Secondary\nstructure satisfies a simple recursion which gives the optimal solution over [i, j] by Li,j = max{Vi,j , Wi,j },\nwhere Vi,j denotes the optimal solution in which (i, j) is a base pair, and Wi,j denotes the optimal solution\nobtained by adding the optimal solutions of two subsequent intervals, respectively. Note that the optimal\nsolution over a single vertex is denoted by Li,i . We have the recursion equation for Vi,j and Wi,j :\n(\u039b1 )\n\nVi,j\n\n(\u039b2 ) Wi,j\n\n= Li+1,j\u22121 + f (i, j),\n=\n\nmax {Li,k + Lk+1,j },\n\ni<k<j\n\nwhere f (i, j) is the score when (i, j) form a base pair, see Figure. 5. In case two positions, i,j in the sequence\nare incompatible then we have f (i, j) = \u2212\u221e.\nAn interval [i, j] is a \u039b\u2217 -candidate if the optimal solution over [i, j] is given by Li,j = Vi,j > Wi,j . Indeed,\n\u2217\n\n[i, j] is a candidate iff [i, j] is in the candidate set of \u039b\u2217 , and we denote the set Q\u039b by Q. Suppose the\n\n7\n\n\fL\ni\n\n=\nj\n\nV\ni\n\nmax\n\nV\ni\n\ni i+1\n\n{\n\nW\nj i\n\nj\n\nL\n\n=\nj\n\n{\n\nW\nj-1 j\n\ni\n\n=\n\nmax\ni<k<=j\n\nj\n\n{\n\nL\ni\n\nL\nk k+1\n\nj\n\n{\n\nFigure 5: The recursion solving the optimal solution for secondary structures.\noptimal solution Wi,j is given by Wi,j = Li,q + Lq+1,j and suppose we have Li,q = Li,k + Lk+1 . Then since\n[i, q] is not a candidate, Lemma 1 shows that we can compute Wi,j = Li,k +Lk+1,j , where [i, k] is a candidate.\nAccordingly, the recursion for Wi,j can be based on candidates, i.e. Wi,j = max[i,k]\u2208Q {Li,k + Lk+1,j }.\nClearly, the bottleneck for computing the recursion is the calculation of Wi,j , which requires O(n3 ) time.\nApplying sparsification, this recursion is based on candidates [i, k]. Suppose we have Z such candidates,\nthen the time complexity reduces to O(nZ), since the optimal solution is necessarily based on a candidate.\nOnce the latter is identified the expression Lk+1,j requires only O(n) time complexity. In the worst case, Q\ncontains O(n2 ) elements.\nThe polymer-zeta property however implies that the expectation of Z is given by\n\nPn\n\ni\u22651\n\nP\n\nj=i\n\nb(j \u2212 i)\u2212c\n\nwhere b and c are constants and c > 1. We can conclude from the polymer-zeta property that Z = O(n)\nand accordingly the runtime reduces to O(n) * O(n) = O(n2 ).\nRNA pseudoknot structures\nSparsification can also be applied to the DP-algorithm folding RNA structures with pseudoknots [27]. In\ncontrast to the decomposition rule \u039b\u2217 that spliced an interval into two subsequent intervals, we encounter in\nthe grammar for pseudoknotted structures additional more complex decomposition rules [7]. As shown in [27]\nthere exist some decomposition rules which are not s-compatible and which can accordingly not be sparsified\nat all, see Figure 6. For instance, given a decomposition rule \u039b in pknot-R&E subsequent decomposition\nrules which are s-compatible to \u039b are referred to as split type of \u039b [27].\nIn the following we will study RNA pseudoknot structures of fixed topological genus, see Section Diagrams, surfaces and some generating functions for details. An algorithm folding such pseudoknot\nstructures, gfold, has been presented in [19]. The decomposition rules that appear in gfold are reminiscent\nto those of pknot-R&E but as they restrict the genus of sub-structures the iteration of gap-matrices is severely\n\n8\n\n\frestricted and the effect of sparsification of these decompositions is significantly smaller.\n\ni\n\nk\n\nq\n\n(A)\n\nj\n\ni\n\nk\n\nj\n\nr\n\nq\n\nt\n\n(B)\n\ns\n\ni\n\nk\n\nq\n\nj\n\nr\n\nt\n\nv\n\ns\n\n(C)\n\nFigure 6: Decomposition rules for pseudoknot structures of fixed genus. (A) three decompositions via the rule \u039b\u2217 ,\nwhich is s-compatible to itself. We show that for \u039b\u2217 we obtain a linear reduction in time complexity. (B) three\ndecomposition rules \u039b1 , \u039b2 , \u039b3 where \u039b2 , \u039b3 are s-compatible to \u039b1 . A quantification of the candidate set is not\nimplied by the polymer-zeta property. (C) three decomposition rules \u039b1 , \u039b2 , \u039b3 where \u039b2 , \u039b3 are not s-compatible\nto \u039b1 .\n\nIn the following, we restrict our analysis to the decomposition rule \u039b\u2217 which splices an interval into two\nsubsequent intervals. Expressed in combinatorial language, \u039b\u2217 cuts the backbone of an RNA pseudoknot\nstructure of fixed genus g over one interval without cutting a bond.\n\nMethods\nDiagrams and genus filtration\nIn this section we recall some facts about diagrams and pass from diagrams to surfaces in order to be able to\nformulate what we mean by an RNA pseudoknot structure of fixed genus g. Most of this section is derived\nfrom [23, 34] with the exception of Lemma 2 and Theorem 2, which are new and key for the subsequent\nanalysis of \u039b\u2217 -candidates.\nA diagram is a labeled graph over the vertex set [n] = {1, . . . , n} in which each vertex has degree \u2264 3,\nrepresented by drawing its vertices in a horizontal line. The backbone of a diagram is the sequence of\nconsecutive integers (1, . . . , n) together with the edges {{i, i + 1} | 1 \u2264 i \u2264 n \u2212 1}. The arcs of a diagram,\n(i, j), where i < j, are drawn in the upper half-plane. We shall distinguish the backbone edge {i, i + 1} from\nthe arc (i, i + 1), which we refer to as a 1-arc. A stack of length l is a maximal sequence of \"parallel\" arcs,\n((i, j), (i + 1, j \u2212 1), . . . , (i + (l \u2212 1), j \u2212 (l \u2212 1))) and is also referred to as a l-stack, see Figure 7.\nWe shall consider diagrams as fatgraphs, G, that is graphs G together with a collection of cyclic orderings,\ncalled fattenings, one such ordering on the half-edges incident on each vertex. Each fatgraph G determines an\noriented surface F (G) [35,36] which is connected if G is and has some associated genus g(G) \u2265 0 and number\nr(G) \u2265 1 of boundary components. Clearly, F (G) contains G as a deformation retract [37]. Fatgraphs were\nfirst applied to RNA secondary structures in [38] and [39].\nA diagram G hence determines a unique surface F (G) (with boundary). Filling the boundary components\n9\n\n\f1\n\n10\n\n30\n\n20\n\n40\n\nFigure 7: RNA structures and diagram representation. A diagram over {1, . . . , 40}. The arcs (1, 21) and (11, 33)\nare crossing and the dashed arc (9, 10) is a 1-arc which is not allowed. This structure contains 3 stacks with length\n7, 4 and 6, from left to right respectively.\n\nwith discs we can pass from F (G) to a surface without boundary. Euler characteristic, \u03c7, and genus, g, of\nthis surface is given by \u03c7 = v \u2212 e + r and g = 1 \u2212 12 \u03c7, respectively, where v, e, r is the number of discs,\nribbons and boundary components in G, [37]. The genus of a diagram is that of its associated surface without\nboundary and a diagram of genus g is referred to as g-diagram.\nA g-diagram without arcs of the form (i, i + 1) (1-arcs) is called a g-structure. A g-diagram that contains\nonly vertices of degree three, i.e. does not contain any vertices not incident to arcs in the upper halfplane,\nis called a g-matching. A stack of length \u03c4 is a maximal sequence of \"parallel\" arcs,\n((i, j), (i + 1, j \u2212 1), . . . , (i + \u03c4, j \u2212 \u03c4 )).\nA diagram is called irreducible, if and only if it cannot be split into two by cutting the backbone without\ncutting an arc.\nLet cg (n) and dg (n) denote the number of g-matchings and g-structures having n-arcs and n vertices,\nrespectively, with GF\nCg (z) =\n\n\u221e\nX\n\ncg (n)z n\n\nDg (z) =\n\nn=0\n\n\u221e\nX\n\ndg (n)z n .\n\nn=0\n\nThe GF Cg (z) has been computed the context of the virtual Euler characteristic of the moduli-space of curves\nin [34] and Dg (z) can be derived from Cg (z) by means of symbolic enumeration [23]. The GF of genus zero\ndiagrams C0 (z) is wellknown to be the GF of the Catalan numbers, i.e., the numbers of triangulations of a\npolygon with (n + 2) sides,\nC0 (z) =\n\n1\u2212\n\n\u221a\n1 \u2212 4z\n.\n2z\n\nAs for g \u2265 1 we have the following situation [23]\nTheorem 1. Suppose g \u2265 1. Then the following assertions hold\n\n10\n\n\f(a) Dg (z) is algebraic and\nDg (z) =\n\nz2\n\n1\nCg\n2\nz \u2212z+1\n\n(z 2 \u2212 z + 1)2\n\n!\n\n.\n\n(1)\n\nIn particular, we have for some constant ag depending only on g and \u03b3 \u2248 2.618:\n1\n\n[z n ]Dg (z) \u223c ag n3(g\u2212 2 ) \u03b3 n .\n\n(2)\n\n(b) the bivariate GF of g-structures over n vertices, containing exactly m arcs, Eg (z, t), is given by\n\u0012\n\u0013\n1\nt z2\nEg (z, t) = 2\n.\nDg\ntz \u2212 z + 1\n(t z 2 \u2212 z + 1)2\n\n(3)\n\nIrreducible g-structures\nIn the context of \u039b\u2217 -candidates we observed that irreducible substructures are of key importance. It is\naccordingly of relevance to understand the combinatorics of these structures. To this end let D\u2217g (z) =\nP\u221e\n\u2217\nn\nn=0 Dg (n)z denote the GF of irreducible g-structures.\nLemma 2. For g \u2265 0, the GF D\u2217g (z) satisfies the recursion\nD\u22170 (z) = 1 \u2212\nD\u2217g (z)\n\n= \u2212\n\n1\nD0 (z)\n\n(D\u22170 (z) \u2212 1)Dg (z) +\n\nPg\u22121\n\ng1 =1\n\nD\u2217g1 (z)Dg\u2212g1 (z)\n\nD0 (z)\n\n.\n\nFor a proof of Lemma 2, see Section Proofs.\nTheorem 2. For g \u2265 1 we have\n(a) the GF of irreducible g-structures over n vertices is given by\n\u0012\n\u0013\nUg (u)\nVg (u)\n\u2217\n2\nDg (z) = (z \u2212 z + 1)\n,\n1 +\n(1 \u2212 4u)3g\u22121\n(1 \u2212 4u)3g\u2212 2\nwhere u =\n\nz2\n(z 2 \u2212z+1)2 ,\n\n(4)\n\nUg (z) and Vg (z) are both polynomials with lowest degree at least 2g, and Ug (1/4),\n\nVg (1/4) 6= 0. In particular, for some constant kg > 0 and \u03b3 \u2248 2.618:\n1\n\nD\u2217g (n) \u223c kg n3(g\u2212 2 ) \u03b3 n .\n\n(5)\n\n(b) the bivariate GF of irreducible g-structures over n vertices, containing exactly m arcs, E\u2217g (z, t), is given\nby\nE\u2217g (z, t)\nwhere v =\n\ntz 2\n(tz 2 \u2212z+1)2 .\n\n2\n\n= (tz \u2212 z + 1)\n\n\u0012\n\nUg (v)\n1\n\n(1 \u2212 4v)3g\u2212 2\n\nVg (v)\n+\n(1 \u2212 4v)3g\u22121\n\nWe shall postpone the proof of Theorem 2 to Section Proofs.\n11\n\n\u0013\n\n,\n\n(6)\n\n\fThe main result\nIn Section Sparsification we observed that sparsification applies to the decomposition rule \u039b\u2217 , which effectively splices off an irreducible sub-structure (diagram). This notion of \u039b\u2217 -irreducibility is indeed compatible\nby the notion of combinatorial irreducibility introduced in Section Diagrams, surfaces and some generating functions, see Figure 8. An optimal solution for the original structure is obtained from an optimal\nsolution of the spliced, \u039b\u2217 -irreducible, sub-structure and an optimal solution for the remaining sub-structure.\n\n1\n\n10\n\n20\n\n30\n\n40\n\nFigure 8: Irreducibility relative to a decomposition rule: the rule \u039b\u2217 splitting Si,j to Si,k and Sk+1,j , S1,40 is not\n\u039b\u2217 -irreducible, while S1,25 and S28,40 are. However, for the decomposition rule \u039b2 , which removes the outmost arc,\nS28,40 is not \u039b2 -irreducible while S1,25 is.\n\nFolded configurations are energetically optimal and dominated by the stacking of adjacent base pairs [3],\nas well as minimum arc-length conditions [4] discussed before.\nIn the following we mimic some form of minimum free energy g-structures: inspired by the Nussinov\nenergy model [40] we consider the weight of a g-structure over n vertices to be given by \u03b7 l , where l is the\nnumber of arcs for some \u03b7 \u2265 1 [33]. Note that the case \u03b7 = 1 corresponds to the uniform distribution, i.e. all\ng-structure have identical weight.\nThis approach requires to keep track of the number of arcs, i.e. we need to employ bivariate GF. In\nTheorem 1 (b) we computed this bivariate GF and in Theorem 2 (b) we derived from this bivariate GF\nE\u2217g (z, t), the GF of irreducible g-structures over n vertices containing l arcs.\nThe idea now is to substitute for the second indeterminant, t, some fixed \u03b7 \u2208 R. This substitution induces\nthe formal power series\nDg,\u03b7 (z) = Eg (z, \u03b7),\nwhich we regard as being parameterized by \u03b7. Obviously, setting \u03b7 = 1 we recover Dg (z), i.e. we have\nDg (z) = Dg,1 (z) = Eg (z, 1). Note that for \u03b7 > 1/4, the polynomial \u03b7z 2 \u2212 z + 1 has no real root. Thus we\nhave for \u03b7 > 1/4 the asymptotics\n1\n\ndg,\u03b7 (n) \u223c ag,\u03b7 n3(g\u2212 2 ) \u03b3\u03b7n\n\n1\n\nand d\u2217g,\u03b7 (n) \u223c kg,\u03b7 n3(g\u2212 2 ) \u03b3\u03b7n ,\n12\n\n(7)\n\n\fwith identical exponential growth rates as long as the supercritical paradigm [41] applies, i.e. as long as \u03b3\u03b7 ,\nthe real root of minimal modulus of\n\u0012\n1\n\u03b7z 2 \u2212z+1 .\n\nis smaller than any singularity of\n\n\u03b7 z2\n2\n(\u03b7 z \u2212 z + 1)2\n\n\u0013\n\n=\n\n1\n,\n4\n\nIn this situation \u03b7 affects the constant ag,\u03b7 and the exponential\n1\n\ngrowth rate \u03b3\u03b7 but not the sub-exponential factor n3(g\u2212 2 ) . The latter stems from the singular expansion\nof Cg (z). Analogously, we derive the \u03b7-parameterized family of GF D\u2217g,\u03b7 (z) = E\u2217g (z, \u03b7). Assuming a\nrandom sequence has on average a probability at most 6/16 to form a base pair we fix in the following\n\u03b7 = 6e/16 \u2248 1.0125, where e is the Euler number. By abuse of notation we will omit the subscript \u03b7\nassuming \u03b7 = 6e/16.\nThe main result of this section is that the set of \u039b\u2217 -candidates is small. To put this size into context we\nnote that the total number of entries considered for the \u039b\u2217 -decomposition rule is given by\n\u03a9(n) =\n\nn\nX\n\n(n \u2212 m + 1).\n\nm=1\n\nTheorem 3. Suppose an mfe g-structure over an interval of length m is irreducible with probability\nd\u2217g (m)/dg (m), then the expected number of candidates of g-structures for sequences of lengths n satisfies\nEg (n) = \u0398(n2 )\nand furthermore, setting Eg (n) = Eg (n)/\u03a9(n) we have\nEg (n) \u223c d\u2217g (n)/dg (n) \u223c bg ,\nwhere bg > 0 is a constant.\nWe provide an illustration of Theorem 3 in Figure 9.\nProof. We proof the theorem by quantifying the probability of [i, j] being a \u039b\u2217 -candidate. In this case any\n(not necessarily unique) sub-structure, realizing the optimal solution Li,j , is \u039b\u2217 -irreducible, and therefore\nan irreducible structure over [i, j].\nLet m = (j \u2212 i + 1), by assumption, the probability that [i, j] is a candidate conditional to the existence\nof a substructure over [i, j] is given by\nP\u2217 ([i, j] | [i, j] is a candidate ) =\n\n13\n\nd\u2217g (m)\n,\ndg (m)\n\n(8)\n\n\fE0(n)\n\nE1(n)\n\nn\n\n(A)\n\n(B)\n\nn\n\nFigure 9: The expected number of candidates for secondary and 1-structures, E0 (n) and E1 (n): we compute\nthe expected number of candidates obtained by folding 100 random sequences for secondary structures (A)(solid)\nand 1-structures (B)(solid). We also display the theoretical expectations implied by Theorem 3 (A)(dashed) and\n(B)(dashed).\nNote that P\u2217 ([i, j] | [i, j] is a candidate ) does not depend on the relative location of the interval but only on\nthe interval-length. Let Pg (m) = d\u2217g (m)/dg (m), then according to Theorem 1,\n1\n\n(1 \u2212 \u01eb)ag m3(g\u2212 2 ) \u03b3 m\n1\n\n(1 \u2212 \u01eb)kg m3(g\u2212 2 ) \u03b3 m\n\n1\n\n\u2264\n\ndg (m) \u2264 (1 + \u01eb)ag m3(g\u2212 2 ) \u03b3 m ,\n\n\u2264\n\nd\u2217g (m) \u2264 (1 + \u01eb)kg m3(g\u2212 2 ) \u03b3 m ,\n\n1\n\nfor m \u2265 m0 where m0 > 0 and 0 < \u01eb < 1 are constants. On the one hand\n1\n\nPg (m) =\n\nd\u2217g (m)\nag\n(1 + \u01eb)ag m3(g\u2212 2 ) \u03b3 m\n= (1 + \u01eb\u2032 )\n= (1 + \u01eb\u2032 )bg ,\n\u2264\n1\ndg (m)\nkg\n(1 \u2212 \u01eb)kg m3(g\u2212 2 ) \u03b3 m\n\n(9)\n\nwhere bg = ag /kg > 0 is a constant. On the other hand, we have\n1\n\nPg (m) =\n\nd\u2217g (m)\n(1 \u2212 \u01eb)ag m3(g\u2212 2 ) \u03b3 m\nag\n= (1 \u2212 \u01eb\u2032\u2032 )bg .\n\u2265\n= (1 \u2212 \u01eb\u2032\u2032 )\n1\ndg (m)\nkg\n(1 + \u01eb)kg m3(g\u2212 2 ) \u03b3 m\n\n(10)\n\nSetting \u01eb = max{\u01eb\u2032 , \u01eb\u2032\u2032 }, we can conclude that Pg (m) \u223c d\u2217g (m)/dg (m), see Fig. 10.\nWe next study the expected number of candidates over an interval of length m. To this end let\nXm = |{[i, j] | [i, j] is a \u039b\u2217 -candidate of length m }|.\nThe expected cardinality of the set of \u039b\u2217 -candidates of length m = (j\u2212i+1) encountered in the DP-algorithm\nis given by\nEg (Xm )\n\n\u2264\n\n(n \u2212 (m \u2212 1)) Pg (m),\n\n14\n\n\fP0(m)\n\nP1(m)\n\nm\n\nm\n\n(A)\n\n(B)\n\nFigure 10: The probability distribution of P0 (m) (A) and P1 (m) (B).\nsince there are n \u2212 (m \u2212 1) starting points for such an interval [i, j]. Therefore, by linearity of expectation,\nfor sufficiently large m > m0 , Pg (m) \u2264 (1 + \u01eb)bg with \u01eb being a small constant. Thus we have\nm0\nn\nX\nX\nX\nEg (n) = Eg (\nXm ) \u2264\n(n \u2212 m + 1).\n(n \u2212 m + 1)Pg (m) + (1 + \u01eb)bg\nm\n\n(11)\n\nm=m0\n\nm=1\n\nConsequently, the expected size of the \u039b\u2217 -candidate set is \u0398(n2 ). We proceed by comparing the expected\nnumber of candidates of a sequence with length n with \u03a9(n),\nPn\nPm0\nEg (n)\nm=m0 (n \u2212 m + 1)\nm=1 (n \u2212 m + 1)Pg (m) + (1 + \u01eb)bg\nPn\n\u2264\n\u03a9(n)\nm=1 (n \u2212 m + 1)\nPm0\n(P\n(m)\n\u2212 (1 + \u01eb)bg )(n \u2212 m + 1)\ng\n\u2264 (1 + \u01eb)bg + m=1 Pn\nm=1 (n \u2212 m + 1)\nk*n\n\u2264 (1 + \u01eb)bg + 2 .\nn\nFor sufficient large n \u2265 n0 , Eg (n)/\u03a9(n) \u2264 (1 + \u01eb\u2032 )bg . Furthermore\nPn\nP m0\nEg (n)\nm=m0 (n \u2212 m + 1)\nm=1 (n \u2212 m + 1)Pg (m) + (1 \u2212 \u01eb)bg\nPn\n\u2265 (1 \u2212 \u01eb)bg ,\n\u2265\n\u03a9(n)\nm=1 (n \u2212 m + 1)\n\nfrom which we can conclude Eg (n)/\u03a9(n) \u223c d\u2217g (m)/dg (m) \u223c bg and the theorem is proved.\nLoop-based energies\n\nIn this section we discuss the more realistic loop-based energy model of RNA secondary structure folding. To\nbe precise we evoke here instead of two trivariate GFs F(z, t, v) and F\u2217 (z, t, v) counting secondary structures\nover n vertices that filter energy and arcs.\nThis becomes necessary since the loop-based model distinguishes between arcs and energy. The \"cancelation\" effect or reparameterization of stickiness [33] to which we referred to before does not appear in this\n15\n\n\fcontext. Thus we need both an arc- as well as an energy-filtration.\nA further complication emerges. In difference to the GFs Eg (z, t) and E\u2217g (z, t) the new GFs are not\nsimply obtained by formally substituting (tz 2 /((tz 2 \u2212 z + 1)2 ) into the power series Dg (z) and D\u2217g (z) as\nbivariate terms. The more complicated energy model requires a specific recursion for irreducible secondary\nstructures.\nThe energy model used in prediction secondary structure is more complicated than the simple arc-based\nenergy model. Loops which are formed by arcs as well as isolated vertexes between the arcs are considered\nto give energy contribution. Loops are categorized as hairpin loops (no nested arcs), interior loops (including\nbulge loops and stacks) and multi-loops (more than two arc nested), see Figure 11. An arbitrary secondary\nstructure can be uniquely decomposed into a collection of mutually disjoint loops. A result of the particular\nenergy parameters [3] is that the energy model prefers interior loops, in particular stacks (no isolated vertex\nbetween two parallel arc), and disfavors multi-loops. Base on this observation, we give a simplified energy\nmodel for a loop \u03bb contained in secondary structure by\n\u2022 f (\u03bb) = \u22120.5 if l is a hairpin loop,\n\u2022 f (\u03bb) = 1 if l is an interior loop,\n\u2022 f (\u03bb) = \u22125 if l is a multi-loop,\nwhere \u03bb is a loop. The weight for a secondary structure \u03b4 accordingly is given by\nf (\u03b4) =\n\nX\n\nf (\u03bb).\n\n(12)\n\n\u03bb\u2208\u03b4\n\n...\n(A)\n\n...\n\n(B)\n\n...\n(C)\n\nFigure 11: Diagram representation of loop types: (A) hairpin loop, (B) interior loop, (C) multi-loop.\nLet F\u22170 (z) and F0 (z) be the GFs obtained by setting t = e and v = 6/16 in F\u2217 (z, t, v) and F(z, t, v),\nwhere e is the Euler number. This means we find a suitable parameterization which brings us back to a\nsimple univariate GF.\n\n16\n\n\fLemma 3. The weight function of RNA secondary structures, F\u22170 (z), satisfies\nF\u22170 (z) =\n\n6\n6 0.5 2 z\ne z\n+ e1 z 2\n16\n1 \u2212 z 16\n\n\u0012\n\n1\n1\u2212z\n\n\u00132\n\nF\u22170 (z) +\n\n\u0010\n\n1\nF\u22170 (z) 1\u2212z\n\n\u00112\n\n6 \u22125 2\n1\ne z\n1 1 \u2212 z.\n16\n1 \u2212 F\u22170 (z) 1\u2212z\n\n(13)\n\nand F\u2217 (z) is uniquely determined by the above equation. Furthermore\nF0 (z) =\n\n1\n1\n1 .\n1 \u2212 z 1 \u2212 F\u22170 (z) 1\u2212z\n\n(14)\n\nProof. We first consider the GF F\u22170 (z) whose coefficient of z n denotes the total weight of irreducible secondary\nstructures over n vertexes, where (1, n) is an arc. Thus it gives a term 6/16z 2. Isolated vertex lead to the\nterm\nzp\n\n\u221e\nX\n\nzi = zp\n\ni=0\n\n1\n,\n1\u2212z\n\nwhere p denotes the minimum number of isolated vertexes to be inserted. Depending on the types of loops\nformed by (i, n), we have\n\u2022 hairpin loops:\n\nz\n1\u2212z ,\n\n\u2022 interior loops: F\u22170 (z)\n\n\u0010\n\n1\n1\u2212z\n\n\u00112\n\n,\n\n\u2022 multi-loops: there are at least two irreducible substructures, as well as isolated vertices, thus\n\u0010\n\u00112\n1\n\u0013i\n\u2217\n\u221e \u0012\nF\n(z)\nX\n0\n1\u2212z\n1\n1\n1\nF\u22170 (z)\n=\n1 1 \u2212 z.\n1 \u2212 z i=2\n1\u2212z\n1 \u2212 F\u22170 (z) 1\u2212z\nWe compute\n\nF\u22170 (z) =\n\n\uf8eb\n\n6 \uf8ec 0.5 2 z\n+ e1 z 2\n\uf8ede z\n16\n1\u2212z\n\n\u0012\n\n1\n1\u2212z\n\n\u00132\n\nF\u22170 (z) + e\u22125 z 2\n\n\u0010\n\n1\nF\u22170 (z) 1\u2212z\n\n1\u2212\n\n\u00112\n\n1\nF\u22170 (z) 1\u2212z\n\n\uf8f6\n\n1 \uf8f7\n\uf8f8,\n1\u2212z\n\nwhich establishes the recursion. The uniqueness of the solution as a power series follows from the fact that\neach coefficient can evidently be recursively computed.\nAn arbitrary secondary structure can be considered as a sequence of irreducible substructure with certain\nintervals of isolated vertexes. Thus\n\u221e\n1 X 1\n1\n1\nF0 (z) =\nF\u2217 (z) =\n1 .\n1 \u2212 z i=0 1 \u2212 z 0\n1 \u2212 z 1 \u2212 F\u22170 (z) 1\u2212z\n\n17\n\n\fLemma 4. F\u22170 (z) and F0 (z) have the same singular expansion.\n3\n\nf0\u2217 (n) \u223c \u03b1n\u2212 2 \u03b3 n ,\n\nand\n\n3\n\nf0 (n) \u223c \u03b2n\u2212 2 \u03b3 n ,\n\n(15)\n\nwhere \u03b1 \u2248 0.24 and \u03b2 \u2248 2.88 are constants and \u03b3 \u2248 2.1673\nProof. Solving eq. 13 we obtain a unique solution for F\u22170 (z) whose coefficient are all positive. Observing\nthe dominant singularity of F\u22170 (z) it is \u03c1 \u2248 0.4614. F0 (z) is a function of F\u22170 (z) and we examine the real\n1\nroot of minimal modulus of 1 \u2212 F\u22170 (z) 1\u2212z\n= 0 is bigger than \u03c1. Then by the supercritical paradigm [41]\n\napplying, F0 (z) and F\u22170 (z) have identical exponential growth rates. Furthermore, F\u22170 (z) and F0 (z) have the\n3\n\nsame sub-exponential factor n\u2212 2 , hence the lemma.\nTheorem 4. Suppose an mfe secondary structure over an interval of length m is irreducible with probability\nP0 (m) =\n\nf0\u2217 (m)\nf0 (m) ,\n\nthen the expected number of candidates for sequences of lengths n is\nE0 (n) = \u0398(n2 )\n\nand furthermore, setting Eg (n) = Eg (n)/\u03a9(n), we have\nE0 (n) \u223c f0\u2217 (n)/f0 (n) \u223c b,\nwhere b = \u03b1/\u03b2 \u2248 0.08.\nProof. By Lemma 4 we have f0\u2217 (m)/f0 (m) \u223c b where b is a constant. The proof is completely analogous to\nthat of Theorem 3.\nWe show the distribution of P0 (m) and E0 (n) in Figure 12.\n\nResults and Discussion\nIn this paper we quantify the effect of sparsification of the particular decomposition rule \u039b\u2217 . This rule splits\nand interval and thereby separates concatenated substructures. The sparsification of \u039b\u2217 alone is claimed\nto provide a speed up of up to a linear factor of the DP-folding of RNA secondary structures [24]. A\nsimilar conclusion is drawn in [26] where the sparsification of RNA-RNA interaction structures is shown\nto experience also a linear reduction in time complexity. Both papers [24, 26] base their conclusion on the\nvalidity of the polymer-zeta property discussed in Section Sparsification.\nFor the folding of pseudoknot structures there may however exist non-sparsifiable rules in which case\nthe overall time complexity is not reduced. The key object here is the set of candidates and we provide an\n18\n\n\fE0(n)\n\nP0(m)\n\n(A)\n\nm\n\n(B)\n\nn\n\nFigure 12: The distribution of P0 (m) (A) and E0 (n) obtained by folding 100 random sequences on the loop-based\nmodel (B)(solid), as well as the theoretical expectation implied by Theorem 4 (B)(dashed).\n\nanalysis of \u039b\u2217 -candidates by combinatorial means. In general, the connection between candidates, i.e. unions\nof disjoint intervals and the combinatorics of structures is actually established by the algorithm itself via\nbacktracking: at the end of the DP-algorithm a structure is being generated that realizes the previously\ncomputed energy as mfe-structure. This connects intervals and sub-structures.\nSo, does polymer-zeta apply in the context of RNA structures? In fact polymer-zeta would follow if the\nintervals in question are distributed as in uniformly sampled structures. This however, is far from reasonable,\ndue to the fact that the mfe-algorithm deliberately designs some mfe structure over the given interval. What\nthe algorithm produces is in fact antagonistic to uniform sampling. We here wish to acknowledge the help\nof one anonymous referee in clarifying this point.\nOur results clearly show that the polymer-zeta property, i.e. the probability of an irreducible structure\nover an interval of length m satisfies a formula of the form\nP(there exists an irreducible structure over [1, m]) = b m1+c ,\n\nwhere b, c > 0.\n\n(16)\n\ndoes not apply for RNA structures. The theoretical findings from self-avoiding walks [30] unfortunately do\nnot allow to quantify the expected number of candidates of the \u039b\u2217 -rule in RNA folding.\nThat the polymer-zeta property does not hold for RNA has also been observed in the context of the limit\ndistribution of the 5'-3' distances of RNA secondary structures [42]. Here it is observed that long arcs, to\nbe precise arcs of lengths O(n) always exist. This is of course a contradiction to eq. (16).\nThe key to quantification of the expected number of candidates is the singularity analysis of a pair of\nenergy-filtered GF, namely that of a class of structures and that of the subclass of all such structures that\nare irreducible. We show that for various energy models the singular expansions of both these functions\n19\n\n\fare essentially equal\u2013modulo some constant. This implies that the expected number of candidates is \u0398(n2 )\nand all constants can explicitly be computed from a detailed singularity analysis. The good news is that\ndepending on the energy model, a significant constant reduction, around 95% can be obtained. This is in\naccordance with data produced in [25] for the mfe-folding of random sequences. There a reduction by 98%\nis reported for sequences of length \u2265 500.\nOur findings are of relevance for numerous results, that are formulated in terms of sizes of candidate\nsets [27]. These can now be quantified. It is certainly of interest to devise a full fledged analysis of the\nloop-based energy model. While these computations are far from easy our framework shows how to perform\nsuch an analysis.\nUsing the paradigm of gap-matrices Backofen has shown [27] that the sparsification of the DP-folding\nof RNA pseudoknot structures exhibits additional instances, where sparsification can be applied, see Fig. 6\n(B). Our results show that the expected number of candidates is \u0398(n2 ), where the constant reduction is\naround 90%. This is in fact very good new since the sequence length in the context of RNA pseudoknot\nstructure folding is in the order of hundreds of nucleotides. So sparsification of further instances does have\nan significant impact on the time complexity of the folding.\n\nProofs\nIn this section, we prove Lemma 2 and Theorem 2.\nP\nP\u230a n2 \u230b\nProof for Lemma 2: let D(z, u) and D\u2217 (z, u) be the bivariate GF D(z, u) = n\u22650 g=0\ndg (n)z n ug ,\nn\nP\nP\u230a 2 \u230b \u2217\nand D\u2217 (z, u) = n\u22651 g=0\ndg (n)z n ug . Suppose a structure contains exactly j irreducible structures, then\nD(z, u) =\n\nX\n\nR(z, u)j =\n\nj\u22650\n\n1\n1 \u2212 R(z, u)\n\n(17)\n\n1\n,\nD(z, u)\n\n(18)\n\nand\nD\u2217g (z) = [ug ]D\u2217 (z, u) = \u2212[ug ]\n1\n. Let F(z, u) =\nas well as D\u22170 (z) = 1 \u2212 [u0 ] D(z,u)\n\nwhence for g \u2265 1,\n\ng\nX\n\nP\n\nn\u22650\n\nP\n\ng\u22650 fg (n)z\n\ng \u2265 1,\n\nn g\n\nu =\n\n1\nD(z,u) .\n\nFg1 (z)Dg\u2212g1 (z) = [ug ]F(z, u)D(z, u) = 0,\n\nThen F(z, u)D(z, u) = 1,\n\n(19)\n\ng1 =0\n\nand F0 (z)D0 (z) = 1, where Fg (z) =\nF0 (z) =\n\n1\nD0 (z)\n\nand\n\nP\n\nn\u22650 fg (n)z\n\nFg (z) = \u2212\n\nPg\u22121\n\ng1 =0\n\nn\n\n1\n= [ug ]F(z, u) = [ug ] D(z,u)\n. Furthermore, we have\n\nFg1 (z)Dg\u2212g1 (z)\nD0 (z)\n20\n\n,\n\ng \u2265 1,\n\n(20)\n\n\fwhich implies D\u22170 (z) = 1 \u2212 F0 (z) = 1 \u2212\nD\u2217g (z)\n\n1\nD0 (z)\n\n= \u2212Fg (z) = \u2212\n\nand\n\n(D\u22170 (z) \u2212 1)Dg (z) +\n\nPg\u22121\n\ng1 =1\n\nD\u2217g1 (z)Dg\u2212g1 (z)\n\nD0 (z)\n\n.\n\n(21)\n\nProof for Theorem 2 Let [n]k denotes the set of compositions of n having k parts, i.e. for\u03c3 \u2208 [n]k we\nPk\nhave \u03c3 = (\u03c31 , . . . , \u03c3k ) and i=1 \u03c3i = n.\nClaim.\n\n\uf8eb\ng\u22121\nX (\u22121)g+2\u2212j\nD\n(z)\ng+1\n\uf8ed\n+\nD\u2217g+1 (z) =\ng+2\u2212j\nD0 (z)2\nD\n(z)\n0\nj=0\n\nX\n\n\u03c3\u2208[g+1]g+1\u2212j\n\ng+1\u2212j\nY\ni=1\n\nWe shall prove the claim by induction on g. For g = 1 we have\nD\u22171 (x) =\n\nD1 (z)\n\n\uf8f6\n\nD\u03c3i (z)\uf8f8 .\n\n(22)\n\n2,\n\n(23)\n\n(D0 (z))\n\nwhence eq. (22) holds for g = 1. By induction hypothesis, we may now assume that for j \u2264 g, eq. (22) holds.\nAccording to Lemma 2, we have\nD\u2217g+1 (z)\n\n=\n=\n\n\u2212\n\n(D\u22170 (z) \u2212 1)Dg+1 (z) +\n\nPg\n\ng1 =1\n\nD\u2217g1 (z)Dg+1\u2212g1 (z)\n\nD0 (z)\n\ng\nX\n\nDg+1 (z)\n\u2212\nD0 (z)2\ng\n\n1\n\nWe next observe\n\n\uf8eb\n\n\uf8ed Dg1 (z) +\nD0 (z)3\n=1\n\ngX\n1 \u22122\nj=0\n\ng1 +1\u2212j\n\n\uf8eb\n\n(\u22121)\n\uf8ed\nD0 (z)g1 +2\u2212j\n\ngY\n1 \u2212j\n\nX\n\n\u03c3\u2208[g1 ]g1 \u2212j i=1\n\n\uf8eb\ng\nX\nDg1 (z)\n(\u22121)g+2\u2212(g\u22121) \uf8ed\n\u2212\nDg+1\u2212g1 (z) =\nD0 (z)3\nD0 (z)g+2\u2212(g\u22121)\ng =1\n\nX\n\n\u03c3\u2032 \u2208[g+1]\n\n1\n\nD\u03c3i (z)\uf8f8\uf8f8 Dg+1\u2212g1 (z).\n\ng+1\u2212(g\u22121)\n\ng+1\u2212(g\u22121)\n\nand setting h = g1 \u2212 j we obtain,\n\nY\n\ni=1\n\n=\n\n\u03c3 \u2208[g+1]h+1\n\ng\u22122\nX\nj=0\n\ng+2\u2212j\n\n\uf8eb\n\n(\u22121)\n\uf8ed\nD0 (z)g+2\u2212j\n\nX\n\n\u03c3\u2032 \u2208[g+1]\n\n21\n\ng+1\u2212j\n\ng+1\u2212j\nY\ni=1\n\n\uf8f6\n\nD\u03c3i\u2032 (z)\uf8f8 .\n\n\uf8f6\n\nD\u03c3i\u2032 (z)\uf8f8 ,\n\n\uf8eb\n\uf8f6\ng gX\ngY\n1 \u22122\n1 \u2212j\nX\n(\u22121)g1 +1\u2212j \uf8ed X\n\u2212\nD\u03c3i (z)\uf8f8 Dg+1\u2212g1 (z)\ng1 +2\u2212j\nD\n(z)\n0\ng1 =1 j=0\n\u03c3\u2208[g1 ]g1 \u2212j i=1\n\uf8f6\n\uf8eb\ng1\ng X\nh\nX\n(\u22121)h+2 \uf8ed X Y\nD\u03c3i (z)\uf8f8 Dg+1\u2212g1 (z)\n=\nh+2\nD\n(z)\n0\ng1 =1 h=2\n\u03c3\u2208[g1 ]h i=1\n\uf8eb\n\uf8f6\n\uf8f6\n\uf8eb\ng\ng\nh\nX\n(\u22121)h+2 \uf8ed X \uf8ed X Y\nD\u03c3i (z)\uf8f8 Dg+1\u2212g1 (z)\uf8f8\n=\nD0 (z)h+2\ng1 =h \u03c3\u2208[g1 ]h i=1\nh=2\n\uf8f6\n\uf8eb\ng\nh+1\nX (\u22121)h+2\nY\nX\n\uf8ed\nD\u03c3i\u2032 (z)\uf8f8\n=\nD0 (z)h+2\n\u2032\ni=1\nh=2\n\nand setting j = g \u2212 h\n\n\uf8f6\uf8f6\n\n(24)\n\n\fConsequently, the Claim holds for any g \u2265 1.\nFor any g \u2265 1, we have [23]\nDg (z) =\n\nz2\n\n1\nPg (u)\n,\n\u2212 z + 1 (1 \u2212 4u)3g\u22121/2\n\nD0 (z) =\n\nz2\n\n2\n1\n\u221a\n,\n\u2212 z + 1 (1 + 1 \u2212 4u)\n\nwhere Pg (u) is a polynomial with integral coefficients of degree at most (3g \u22121), Pg (1/4) 6= 0, [u2g ]Pg (u) 6= 0\nand [uh ]Pg (u) = 0 for 0 \u2264 h \u2264 2g \u2212 1. Let u =\n\nz2\n(z 2 \u2212z+1)2 ,\n\nthe Claim provides in this context the following\n\ninterpretation of D\u2217g (z)\nPg (u)\n1\nD\u2217g (z) =\n2\nz \u2212z+1\n(1 \u2212 4u)3g\u22121/2\n\n\u0012\n\n1+\n\nQ\nP\n\u221a\n\u221a\n\u00132 g\u22122\nX \u0012 1 + 1 \u2212 4u \u0013g+1\u2212j \u03c3\u2208[g]g\u2212j g\u2212j\n1 \u2212 4u\ni=1 P\u03c3i (u)\n\u2212\n,\n+\ng\u2212j\n3g\u2212\n2\n2\n2\n(1 \u2212 4u)\nj=0\n(25)\n\nand\nQg\u2212j\n\u221a\n\u0013g+1\u2212j P\n1 \u2212 4u\ni=1 P\u03c3i (u)\n\u03c3\u2208[g]g\u2212j\n\u2212\ng\u2212j\n2\n(1 \u2212 4u)3g\u2212 2\nj=0\nQ\nP\ng\u22122\nX \u0012 1 \u0013g+1\u2212j \u0012g + 1 \u2212 j \u0013 \u03c3\u2208[g]g\u2212j g\u2212j\nX g+1\u2212j\ni=1 P\u03c3i (u)\n\u2212\ng\u2212j+k\n2\nk\n(1 \u2212 4u)3g\u2212 2\nj=0 k=0\nQ\nP\ng\u22122\nX \u0012 1 \u0013g+1\u2212j \u0012g + 1 \u2212 j \u0013 \u03c3\u2208[g]g\u2212j g\u2212j\nX 2g+1\u22122j\ni=1 P\u03c3i (u)\n\u2212\n.\ns\n2\ns\u2212g+j\n(1 \u2212 4u)3g\u2212 2\nj=0 s=g\u2212j\n\ng\u22122\nX\u0012\n\n=\n\n=\n\n1+\n\nAs 0 \u2264 j \u2264 g \u2212 2 and g \u2212 j \u2264 s \u2264 2g + 1 \u2212 2j, we have s \u2265 2. Consequently we arrive at\nUg (u)\n1\nVg (u)\n,\nD\u2217 (z) =\n+\nz2 \u2212 z + 1 g\n(1 \u2212 4u)3g\u22121\n(1 \u2212 4u)3g\u22121/2\n\n(26)\n\nwhere\nPg (u) Pg (u)(1 \u2212 4u)\n+\n4\n4\n\uf8eb\n\u0013g+1\u2212j \u0012\n\u0013\n\u0012\ng\u22122\nX\nX\ng+1\u2212j \uf8ed X\n1\n+\n\u2212\n2\ns\u2212g+j\nj=0 g\u2212j\u2264s\u22642g+1\u22122j\n\nUg (u) =\n\n\u03c3\u2208[g]g\u2212j i=1\n\ns is odd\n\nand\n\ng\u2212j\nY\n\n\uf8f6\n\nP\u03c3i (u)\uf8f8 (1 \u2212 4u)\n\ns\u22121\n2\n\n,\n\n\uf8f6\n\uf8f6\n\uf8eb\n\uf8eb\n\u0012\n\u00133\n\u00133\n\u0012\n2\n2\nX Y\n1\n1 \uf8ed X Y\nPg (u)\n\uf8ed\nP\u03c3i (u)\uf8f8 + 3 \u2212\nP\u03c3i (u)\uf8f8 (1 \u2212 4u)\n+ \u2212\nVg (u) =\n2\n2\n2\n\u03c3\u2208[g]2 i=1\n\u03c3\u2208[g]2 i=1\n\uf8f6\n\uf8eb\n\u0012\n\u0013\n\u0012\n\u0013\ng\u22123\ng\u2212j\ng+1\u2212j\nX\nX\ns\u22122\n1\ng+1\u2212j \uf8ed X Y\n+\n\u2212\nP\u03c3i (u)\uf8f8 (1 \u2212 4u) 2 .\n2\ns\n\u2212\ng\n+\nj\nj=0 g\u2212j\u2264s\u22642g+1\u22122j\ni=1\n\u03c3\u2208[g]g\u2212j\n\ns is even\n\nWe have for \u03c3 \u2208 [g]k , k \u2265 1\n\n\uf8eb\n\n[uh ] \uf8ed\n\nk\nX Y\n\n\u03c3\u2208[g]k i=1\n\n\uf8f6\n\nP\u03c3i (u)\uf8f8 =\n22\n\nk\nX Y\n\n\u03c3\u2208[g]k i=1\n\n[uhi ]P\u03c3i (u),\n\n\fwhere\n\nPk\n\ni=1\n\nhi = h, hi \u2265 0. Then we obtain that\n\uf8f6\n\uf8eb\nk\nX Y\nP\u03c3i (u)\uf8f8 = 0,\n[uh ] \uf8ed\n\n0 \u2264 h \u2264 2g \u2212 1.\n\n\u03c3\u2208[g]k i=1\n\nSince [uhi ]P\u03c3i (u) = 0, hi \u2264 2\u03c3i \u2212 1, [u2\u03c3i ]P\u03c3i (u) 6= 0 and\n\nPk\n\ni=1\n\n(27)\n\n\u03c3i = g. Thus for 0 \u2264 h \u2264 2g \u2212 1,\n\n[uh ]Ug (u) = 0 and [uh ]Vg (u) = 0.\n\n(28)\n\nAs shown in [23] we have\nPg (1/4) =\n\n\u0393 (g \u2212 1/6) \u0393 (g + 1/2) \u0393 (g + 1/6) 9g 4\u2212g\n6\u03c0 3/2 \u0393 (g + 1)\n\n(29)\n\nand we obtain Ug (1/4) = Pg (1/4)/4. Furthermore,\n\uf8f6\n\uf8f6\n\uf8eb\n\uf8eb\n\u00133\n\u0012\ng\u22121\n2\nY\nX\nX\nPg (1/4)\n1\n1 \uf8ed\nVg (1/4) =\nP\u03c3i (1/4)\uf8f8 = \uf8ed4Pg (1/4) \u2212\nPj (1/4)Pg\u2212j (1/4)\uf8f8 6= 0.\n+ \u2212\n2\n2\n8\ni=1\nj=1\n\u03c3\u2208[g]2\n\nWe can recruit the computation of [23] in order to observe 4Pg (1/4) \u2212\n\nPg\u22121\nj=1\n\nPj (1/4)Pg\u2212j (1/4) 6= 0. In\n\norder to compute the bivariate GF, E\u2217g (z, t), we only need to replace in eq. (22) Dg (z) by Eg (z, t) and the\nproof is completely analogous.\n\nAuthor's contributions\nFenix W.D. Huang and Christian M. Reidys contributed equally to research and manuscript.\n\nAcknowledgements\nWe want to thank Thomas J.X. Li for discussions and comments. We want to thank an anonymous referee\nfor pointing out an incorrect assumption of first version of this paper. His comments have led to a much\nimproved version of the paper.\n\n23\n\n\fReferences\n1. Bailor MH, Sun X, Al-Hashimi HM: Topology Links RNA Secondary Structure with Global Conformation, Dynamics, and Adaptation. Science 2010, 327:202\u2013206.\n2. Tabaska JE, Cary RB, Gabow HN, Stormo GD: An RNA folding method capable of identifying pseudoknots and base triples. Bioinformatics 1998, 14:691\u2013699.\n3. Mathews D, Sabina J, Zuker M, Turner D: Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure. J. Mol. Biol. 1999, 288:911\u2013940.\n4. Smith T, Waterman M: RNA secondary structure. Math. Biol. 1978, 42:31\u201349.\n5. Zuker M: On finding all suboptimal foldings of an RNA molecule. Science 1989, 244:48\u201352.\n6. Hofacker IL, Fontana W, Stadler PF, Bonhoeffer LS, Tacker M, Schuster P: Fast Folding and Comparison\nof RNA Secondary Structures. Monatsh. Chem. 1994, 125:167\u2013188.\n7. Rivas E, Eddy SR: A Dynamic Programming Algorithm for RNA Structure Prediction Including\nPseudoknots. J. Mol. Biol. 1999, 285:2053\u20132068.\n8. Uemura Y A Hasegawa, Kobayashi S, Yokomori T: Tree adjoining grammars for RNA structure prediction. Theor. Comp. Sci. 1999, 210:277\u2013303.\n9. Akutsu T: Dynamic programming algorithms for RNA secondary structure prediction with pseudoknots. Discr. Appl. Math. 2000, 104:45\u201362.\n10. Lyngs\u00f8 RB, Pedersen CN: RNA pseudoknot prediction in energy-based models. J. Comp. Biol. 2000,\n7:409\u2013427.\n11. Cai L, Malmberg RL, Wu Y: Stochastic modeling of RNA pseudoknotted structures: a grammatical\napproach. Bioinformatics 2003, 19 S1:i66\u2013i73.\n12. Dirks RM, Pierce NA: A partition function algorithm for nucleic acid secondary structure including\npseudoknots. J. Comput. Chem. 2003, 24:1664\u20131677.\n13. Deogun JS, Donis R, Komina O, Ma F: RNA secondary structure prediction with simple pseudoknots. In\nProceedings of the second conference on Asia-Pacific bioinformatics (APBC 2004), Australian Computer Society\n2004:239\u2013246.\n14. Reeder J, Giegerich R: Design, implementation and evaluation of a practical pseudoknot folding\nalgorithm based on thermodynamics. BMC Bioinformatics 2004, 5:104.\n15. Li H, Zhu D: A New Pseudoknots Folding Algorithm for RNA Structure Prediction. In COCOON\n2005, Volume 3595. Edited by Wang L, Berlin: Springer 2005:94\u2013103.\n16. Matsui H, Sato K, Sakakibara Y: Pair stochastic tree adjoining grammars for aligning and predicting\npseudoknot RNA structures. Bioinformatics 2005, 21:2611\u20132617.\n17. Kato Y, Seki H, Kasami T: RNA Pseudoknotted Structure Prediction Using Stochastic Multiple\nContext-Free Grammar. IPSJ Digital Courier 2006, 2:655\u2013664.\n18. Chen HL, Condon A, Jabbari H: An O(n5 ) Algorithm for MFE Prediction of Kissing Hairpins and\n4-Chains in Nucleic Acids. J. Comp. Biol. 2009, 16:803\u2013815.\n19. Reidys CM, Huang FWD, Andersen JE, Penner RC, Stadler PF, Nebel ME: Topology and prediction of\nRNA pseudoknots. Bioinformatics 2011, 27:1076\u20131085.\n20. Waterman MS: Secondary structure of single-stranded nucleic acids. Adv. Math. (Suppl. Studies) 1978,\n1:167\u2013212.\n21. Orland H, Zee A: RNA folding and large N matrix theory. Nuclear Physics B 2002, 620:456\u2013476.\n22. Bon M, Vernizzi G, Orland H, Zee A: Topological Classification of RNA Structures. J. Mol. Biol. 2008,\n379:900\u2013911.\n23. Andersen JE, Penner RC, Reidys CM, Waterman MS: Topological classification and enumeration of RNA\nstructrues by genus. J. Math. Biol. 2011. [Submitted].\n24. Wexler Y, Zilberstein C, Ziv-Ukelson M: A study of accessible motifs and RNA complexity. J. Comput.\nBiol. 2007, 14(6):856\u2013872.\n\n24\n\n\f25. Backofen R, Tsur D, Zakov S, Ziv-Ukelson M: Sparse RNA folding: Time and space efficient algorithms.\nJ. Disc. Algor. 2011, 9(1):12\u201331.\n26. Salari R, M\u00f6hl M, Will S, Sahinalp C, Backofen R: Time and space efficient RNA-RNA interaction\nprediction via sparse folding. Proc. of RECOMB 2010, 6044:473\u2013490.\n27. M\u00f6hl M, Salari R, Will S, Backofen R, Sahinalp SC: Sparsification of RNA structure prediction including\npseudoknots. Algorithms Mol. Biol. 2010, 5:39.\n28. McCaskill JS: The equilibrium partition function and base pair binding probabilities for RNA secondary structure. Biopolymers 1990, 29:1105\u20131119.\n29. Kafri Y, Mukamel D, Peliti L: Why is the DNA Denaturation Transition First Order? Phys. Rev. Lett.\n2000, 85:4988\u20134991.\n30. Kabakcioglu A, Stella AL: A scale-free network hidden in the collapsing polymer. Phys. .Rev. E 2005,\n72:055102.\n31. Vanderzande C: Lattic models of polymers. Cambridge University Press New York 1998.\n32. NCBI database[http://www.ncbi.nlm.nih.gov/guide/dna-rna/#downloads ].\n33. Nebel ME: Investigation of the Bernoulli model for RNA secondary structures. Bull. math. biol. 2003,\n66(5):925\u2013964.\n34. Zagier D: On the distribution of the number of cycles of elements in symmetric groups. Nieuw Arch.\nWisk. IV 1995, 13:489\u2013495.\n35. Loebl M, Moffatt I: The chromatic polynomial of fatgraphs and its categorification. Adv. Math. 2008,\n217:1558\u20131587.\n36. Penner RC, Knudsen M, Wiuf C, Andersen JE: Fatgraph models of proteins. Comm. Pure Appl. Math. 2010,\n63:1249\u20131297.\n37. Massey WS: Algebraic Topology: An Introduction. Springer-Veriag, New York 1967.\n38. Penner RC, Waterman MS: Spaces of RNA secondary structures. Adv. Math. 1993, 101:31\u201349.\n39. Penner RC: Cell decomposition and compactification of Riemann's moduli space in decorated Teichm\u00fcller theory. In Woods Hole Mathematics-perspectives in math and physics. Edited by Tongring N, Penner\nRC, Singapore: World Scientific 2004:263\u2013301. [ArXiv: math. GT/0306190].\n40. Nussinov R, Piecznik G, Griggs JR, Kleitman DJ: Algorithms for Loop Matching. SIAM J. Appl. Math.\n1978, 35:68\u201382.\n41. Flajolet P, Sedgewick R: Analytic Combinatorics. Cambridge University Press New York 2009.\n42. Han HSW, Reidys CM: The 5'-3' distance of RNA secondary structures. J. Comput. Biol. [Submitted,\ne-print arXiv:1104.3316v2].\n\nFigures\nFigure 1 - RNA structures as planar graphs and diagrams\n(A) an RNA secondary structure and (B) an RNA pseudoknot structure.\n\nFigure 2 - Sparsification of secondary structure folding\nSuppose the optimal solution Li,j is obtained from the optimal solutions Li,k , Lk+1,q and Lq+1,j . Based on\nthe recursions of the secondary structures, Li,k and Lk+1,q produce an optimal solution of Li,q . Similarly,\nLk+1,q and Lq+1,j produce an optimal solution of Lk+1,j . Now, in order to obtain an optimal solution of\nLi,j it is sufficient to consider either the grouping Li,q and Lq+1,j or Li,k and Lk+1,j .\n25\n\n\fFigure 3 - What sparsification can and cannot prune\nWhat sparsification can and cannot prune: (A) and (B) are two computation paths yielding the same\noptimal solution. Sparsification reduces the computation to path (A) where Si,k1 is irreducible. (C) is\nanother computation path with distinct leftmost irreducible over a different interval, hence representing a\nnew candidate that cannot be reduced to (A) by the sparsification.\n\nFigure 4 - Sparsification\nSparsification: Lv is alternatively realized via Lv1 and Lv2\u2032 , or Lv1\u2032 and Lv3 . Thus it is sufficient to only\nconsider one of the computation paths.\n\nFigure 5 - The recursion solving the optimal solution for secondary structures\nThe recursion solving the optimal solution for secondary structures.\n\nFigure 6 - Decomposition rules for pseudoknot structures of fixed genus\n(A) three decompositions via the rule \u039b\u2217 , which is s-compatible to itself. We show that for \u039b\u2217 we obtain a\nlinear reduction in time complexity. (B) three decomposition rules \u039b1 , \u039b2 , \u039b3 where \u039b2 , \u039b3 are s-compatible\nto \u039b1 . A quantification of the candidate set is not implied by the polymer-zeta property. (C) three decomposition rules \u039b1 , \u039b2 , \u039b3 where \u039b2 , \u039b3 are not s-compatible to \u039b1 .\n\nFigure 7 - RNA structures and diagram representation\nA diagram over {1, . . . , 40}. The arcs (1, 21) and (11, 33) are crossing and the dashed arc (9, 10) is a 1-arc\nwhich is not allowed. This structure contains 3 stacks with length 7, 4 and 6, from left to right respectively.\n\nFigure 8 - Irreducibility relative to a decomposition rule\nthe rule \u039b\u2217 splitting Si,j to Si,k and Sk+1,j , S1,40 is not \u039b\u2217 -irreducible, while S1,25 and S28,40 are. However,\nfor the decomposition rule \u039b2 , which removes the outmost arc, S28,40 is not \u039b2 -irreducible while S1,25 is.\n\nFigure9 -The expected number of candidates for secondary and 1-structures E0 (n) and E1 (n)\nwe compute the expected number of candidates obtained by folding 100 random sequences for secondary\nstructures (A)(solid) and 1-structures (B)(solid). We also display the theoretical expectations implied by\nTheorem 3 (A)(dashed) and (B)(dashed).\n\n26\n\n\fFigure10- The probability distribution of P0 (m) and P1 (m)\nThe probability distribution of P0 (m) (A) and P1 (m) (B)\n\nFigure11 -Diagram representation of loop types\n(A) hairpin loop, (B) interior loop, (C) multi-loop.\n\nFigure12 -The distribution of P0 (m) (A) and E0 (n)\nThe distribution of P0 (m) (A) and E0 (n) obtained by folding 100 random sequences on the loop-based model\n(B)(solid), as well as the theoretical expectation implied by Theorem 4 (B)(dashed).\n\n27\n\n\f"}