{"id": "http://arxiv.org/abs/1112.2193v1", "guidislink": true, "updated": "2011-12-09T19:47:27Z", "updated_parsed": [2011, 12, 9, 19, 47, 27, 4, 343, 0], "published": "2011-12-09T19:47:27Z", "published_parsed": [2011, 12, 9, 19, 47, 27, 4, 343, 0], "title": "Making QCD Lattice Data Accessible and Organized through Advanced Web\n  Interfaces", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1112.2066%2C1112.0986%2C1112.1273%2C1112.5419%2C1112.4668%2C1112.1519%2C1112.5094%2C1112.4585%2C1112.0068%2C1112.6203%2C1112.0861%2C1112.4053%2C1112.4036%2C1112.0757%2C1112.0772%2C1112.3349%2C1112.3120%2C1112.6242%2C1112.0781%2C1112.1532%2C1112.3781%2C1112.2724%2C1112.2185%2C1112.4448%2C1112.4385%2C1112.2219%2C1112.4884%2C1112.3129%2C1112.0474%2C1112.3611%2C1112.3885%2C1112.2276%2C1112.0282%2C1112.1176%2C1112.0073%2C1112.2193%2C1112.1990%2C1112.3493%2C1112.0844%2C1112.5549%2C1112.3892%2C1112.3304%2C1112.3291%2C1112.3621%2C1112.4522%2C1112.6070%2C1112.6318%2C1112.5773%2C1112.1535%2C1112.2993%2C1112.0808%2C1112.2070%2C1112.3835%2C1112.4912%2C1112.1964%2C1112.6048%2C1112.3714%2C1112.1810%2C1112.5663%2C1112.1458%2C1112.2843%2C1112.4255%2C1112.1006%2C1112.6217%2C1112.4940%2C1112.1778%2C1112.2160%2C1112.1080%2C1112.5762%2C1112.4558%2C1112.0354%2C1112.1397%2C1112.3194%2C1112.3873%2C1112.2604%2C1112.4617%2C1112.4069%2C1112.2710%2C1112.3469%2C1112.1855%2C1112.4376%2C1112.4348%2C1112.5807%2C1112.6215%2C1112.0157%2C1112.5735%2C1112.3050%2C1112.2810%2C1112.6031%2C1112.6295%2C1112.5577%2C1112.1676%2C1112.3068%2C1112.3968%2C1112.0843%2C1112.4122%2C1112.2595%2C1112.0639%2C1112.0311%2C1112.4366%2C1112.3344&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Making QCD Lattice Data Accessible and Organized through Advanced Web\n  Interfaces"}, "summary": "The Gauge Connection at qcd.nersc.gov is one of the most popular repositories\nof QCD lattice ensembles. It is used to access 16TB of archived QCD data from\nthe High Performance Storage System (HPSS) at the National Energy Research\nScientific Computing Center (NERSC). Here, we present a new web interface for\nqcd.nersc.gov which allows physicists to browse and search the data, as well as\ndownload individual files or entire ensembles in batch. Our system\ndistinguishes itself from others because of its ease of use and web based\nworkflow.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1112.2066%2C1112.0986%2C1112.1273%2C1112.5419%2C1112.4668%2C1112.1519%2C1112.5094%2C1112.4585%2C1112.0068%2C1112.6203%2C1112.0861%2C1112.4053%2C1112.4036%2C1112.0757%2C1112.0772%2C1112.3349%2C1112.3120%2C1112.6242%2C1112.0781%2C1112.1532%2C1112.3781%2C1112.2724%2C1112.2185%2C1112.4448%2C1112.4385%2C1112.2219%2C1112.4884%2C1112.3129%2C1112.0474%2C1112.3611%2C1112.3885%2C1112.2276%2C1112.0282%2C1112.1176%2C1112.0073%2C1112.2193%2C1112.1990%2C1112.3493%2C1112.0844%2C1112.5549%2C1112.3892%2C1112.3304%2C1112.3291%2C1112.3621%2C1112.4522%2C1112.6070%2C1112.6318%2C1112.5773%2C1112.1535%2C1112.2993%2C1112.0808%2C1112.2070%2C1112.3835%2C1112.4912%2C1112.1964%2C1112.6048%2C1112.3714%2C1112.1810%2C1112.5663%2C1112.1458%2C1112.2843%2C1112.4255%2C1112.1006%2C1112.6217%2C1112.4940%2C1112.1778%2C1112.2160%2C1112.1080%2C1112.5762%2C1112.4558%2C1112.0354%2C1112.1397%2C1112.3194%2C1112.3873%2C1112.2604%2C1112.4617%2C1112.4069%2C1112.2710%2C1112.3469%2C1112.1855%2C1112.4376%2C1112.4348%2C1112.5807%2C1112.6215%2C1112.0157%2C1112.5735%2C1112.3050%2C1112.2810%2C1112.6031%2C1112.6295%2C1112.5577%2C1112.1676%2C1112.3068%2C1112.3968%2C1112.0843%2C1112.4122%2C1112.2595%2C1112.0639%2C1112.0311%2C1112.4366%2C1112.3344&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Gauge Connection at qcd.nersc.gov is one of the most popular repositories\nof QCD lattice ensembles. It is used to access 16TB of archived QCD data from\nthe High Performance Storage System (HPSS) at the National Energy Research\nScientific Computing Center (NERSC). Here, we present a new web interface for\nqcd.nersc.gov which allows physicists to browse and search the data, as well as\ndownload individual files or entire ensembles in batch. Our system\ndistinguishes itself from others because of its ease of use and web based\nworkflow."}, "authors": ["Massimo Di Pierro", "James Hetrick", "Shreyas Cholia", "David Skinner"], "author_detail": {"name": "David Skinner"}, "author": "David Skinner", "links": [{"href": "http://arxiv.org/abs/1112.2193v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1112.2193v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "hep-lat", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "hep-lat", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.DL", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1112.2193v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1112.2193v1", "arxiv_comment": null, "journal_reference": "Lattice 2011 Proceedings", "doi": null, "fulltext": "Making QCD Lattice Data Accessible and Organized\nthrough Advanced Web Interfaces\n\nMassimo Di Pierro\u2217\n\nSchool of Computing - DePaul University - Chicago\nE-mail: mdipierro@cs.depaul.edu\n\nJames Hetrick\n\nUniversity of the Pacific\nE-mail: jhetrick@pacific.edu\n\nShreyas Cholia\nLawrence Berkely Laboratory\nE-mail: scholia@lbl.gov\n\nDavid Skinner\n\nLawrence Berkely Laboratory\nE-mail: deskinner@lbl.gov\nThe Gauge Connection at qcd.nersc.gov is one of the most popular repositories of QCD\nlattice ensembles. It is used to access 16TB of archived QCD data from the High Performance\nStorage System (HPSS) at the National Energy Research Scientific Computing Center (NERSC).\nHere, we present a new web interface for qcd.nersc.gov which allows physicists to browse and\nsearch the data, as well as download individual files or entire ensembles in batch. Our system\ndistinguishes itself from others because of its ease of use and web based workflow.\n\nXXIX International Symposium on Lattice Field Theory\nJuly 10-16 2011\nSquaw Valley, Lake Tahoe, California\n\u2217 Speaker.\n\nc Copyright owned by the author(s) under the terms of the Creative Commons Attribution-NonCommercial-ShareAlike Licence.\n\ufffd\n\nhttp://pos.sissa.it/\n\n\fnersc\n\nMassimo Di Pierro\n\n1. Introduction\nThe Gauge Connection Lattice QCD data archive has been operated by the National Energy\nResearch Scientific Computing [6] (NERSC) center since 1998. With over 16TBytes of data, the\nNERSC archive is one of the largest public repositories of lattice gauge ensembles. Its popularity\nhas largely been due to the ease-of-use of its web interface compared to more complex grid based\ntools.\nWe are now updating the Gauge Connection to provide a number of modern features, while\nmaintaining the simplicity and ease-of-use of the original. We are adding the ability to search data\nusing tags. We are also providing capabilities to move data easily between the archive and the\nuser's computer, or between two remote computers using both web and grid tools. The archive\nis now database driven and its pages are dynamically generated in order to facilitate access to the\nmost recent local and remote data. It provides some visulization of the data. New data can easily\nbe uploaded to the archive where it is automatically discovered and cataloged.\nThe archive can now deliver data in a variety of file formats (including ILDG [5], single and\ndouble precision, and FermiQCD [3]) by translating data on the fly after download. We have\ndesigned the new website to provide additional capabilities beyond data access, including wiki\ncapabilities to annotate the data and link external work derived the from archive data (derived data,\nsoftware, tutorials, and publications).\nEach gauge ensemble is also associated with a discussion forum allowing registered users to\nadd their own comments. The archive has a more sophisticated access control mechanism and\nusers can have four possible roles: administrators (can manage every aspect), editors (can edit the\nwiki pages linked to the data), registered users (can download data and comment) and anonymous\nvisitors (can browse the wiki pages and query the data by tags). User management is greatly\nsimplified through the use of a single-sign-on service that allows the user to log in with an existing\nidentity from an external OpenID provider like Google or Yahoo.\n\n2. Backend Architecture\nThe NERSC data is stored on the High Performance Storage System (HPSS), a hierarchical\ntape storage system designed to manage and access multiple petabytes of data at high speeds [?].\nHPSS stores 16 terabytes of Lattice QCD data, mostly generated by the MILC [4] Collaboration.\nHPSS exposes different data access interfaces including a custom command line client (HSI), a C\nAPI, an FTP interface, a parallel FTP interface, as well as a GridFTP interface that can be used via\nGlobus Online. We leverage the HPSS FTP interface to provide web access to the Lattice QCD\ndata.\nThe system performs nightly introspection of the folder structure (through the HSI and FTP\ninterfaces), reproduces this folder structure in the database, automatically tags data by parsing the\nfile names, groups files with similar name patterns, and publishes the data online. For each folder\nin HPSS a corresponding web page is generated dynamically. The web structure has the same\nhierarchy as the folder structure on the HPSS backend.\nThe new web interface is designed to mimic the iPhone interface and works on both regular\nbrowsers and mobile devices.\n2\n\n\fnersc\n\nMassimo Di Pierro\n\nFigure 1: The main web page for qcd.nersc.gov allows browsing and searching for gauge ensembles.\n\nFigure 2: The left image show statics by tags. The right image shows topoligical change images from\nrepresentative elements of various selected ensembles.\n\n3\n\n\fnersc\n\nMassimo Di Pierro\n\nFigure 3: The image shows the page corresponding to a folder. The name of the folder is on top, followed\nby a folder description (optional) and by the tags applied to the folder. Files in the folder are grouped by\ntheir prefix (pattern). Patterns are shown at the bottom, above users' comments.\n\nEvery page on the QCD site is editable using a wiki syntax similar to wikipedia and registered\nusers can comment on the pages. Both the wiki and comments allow Latex syntax for formulas.\nGauge ensembles can be searched by direct browsing of the folder structure or by tag (contributing collaboration, lattice size, beta value, dynamical quark masses, etc.). The system generates\ninteractive charts with statistics by tags.\nSome ensembles have been processed off-line to generate meta-data such as a topological\ncharge densities and have been linked to images and movies of said topological charge density.\nThe system is data agnostic and can, in principle, store other data besides gauge ensembles. For\nexample, it can store quark propagators and eigenvalues, examples of which are already in the\nsystem. The system uses standard third party web analytics tools to track usage and to geo-tag\nvisitors on a map.\nHere is how a simple file access workflow works. The user logs in to the Gauge Connection\nwebsite (fig. 1) and searches for a desired dataset (fig. 2). When the user finds the ensemble that\nhe/she wants (fig. 3), the user click on the appropriate file to download it. The system checks that\nthe user is logged in, and then pulls the data from tape through the HPSS FTP server. Once the\ndata is available (the tape has been mounted in HPSS), it is streamed back directly to the client\nbrowser. Alternatively the user can copy the link to the page for the entire ensemble and pass it to a\ncommand line script (provided) that will download every file in the ensemble, one by one, in batch,\nconverting on the fly to the desired format.\n\n3. Frontend Architecture\nThe system is based on web2py [2], a framework for rapid development of secure database\ndriven web applications. It is written in Python and supports many standard databases including\nSqlite, MySQL, PostgreSQL, Oracle, MSSQL, Informix, DB2, Sybase, Firebird, and Google Bit\nTable using a Databae Abstracion Layer (DAL). The DAL generates SQL dynamically and as\nneeded.\n4\n\n\fnersc\n\nMassimo Di Pierro\n\nThe system uses jQuery Mobile for page layout and a custom JavaScript library for charting.\nIt uses the Google Chart API for Latex rendering and the Janrain web service for Single Sign On.\nThe visualizations of topological charge density are produced offline using Visit (LLNL) and\nthe FermiQCD Visualization Toolkit.\nThe system has a modular Model-View-Controller design which separates the data representation from the data presentation and from the application workflow. This makes the code compact\nand easy to maintain. It includes a web based IDE, a web based database management tool and\ninternationalization capabilities.\nThe complete model for the system consists of just a few lines of code used to describe the\ndata that is stored:\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n# r e p r e s e n t s a f o l d e r i n HPSS\ndb.define_table( ' c a t a l o g _ f o l d e r ',\nField( ' r o o t _ i d ', ' r e f e r e n c e c a t a l o g _ f o l d e r '),\nField( ' p a t h '),\nField( ' t i t l e '),\nField( ' h e a d e r ', ' t e x t '),\nField( ' f o o t e r ', ' t e x t '),\nField( ' p a t t e r n _ i g n o r e '),\nField( ' p a t t e r n _ g r o u p '),\nField( ' comments ', ' b o o l e a n ',default=True))\n# a t a g t o be a p p l i e d t o a f o l d e r\ndb.define_table( ' t a g ',\nField( ' name '),\nField( ' r o o t _ i d ', ' r e f e r e n c e c a t a l o g _ f o l d e r '))\n# a f i l e contained in a folder\ndb.define_table( ' c a t a l o g _ f i l e ',\nField( ' r o o t _ i d ', ' r e f e r e n c e c a t a l o g _ f o l d e r '),\nField( ' f i l e n a m e '),\nField( ' md5 '),\nField( ' p a t t e r n '),\nField( ' e x t e n s i o n '),\nField( ' s i z e ', ' d e c i m a l ( 2 0 , 0 ) '),\nField( ' mtime ', ' d a t e t i m e '))\n\nEach Field has a name and a type.\nA dispatcher function maps web pages into function calls. These functions are defined in the\ncontroller. For example, all web pages of the form\nhttp://.../root/<path>\nCorrespond to a <path> in the file system and they are mapped into the following function:\n1 @cache(request.env.path_info,60)\n2 def root():\n3\npath = ' / '.join(request.args)\n4\n(d,t,f) = (db.catalog_folder, db.tag, db.catalog_file)\n5\nquery = (d.path==path) if path else (d.root_id==0)\n6\npage = db(query).select().first() or redirect(URL( ' e r r o r '))\n7\ntags = db(t.root_id==page.id).select()\n8\nsubfolders = db(d.root_id==page.id).select()\n9\npatterns = db(f.root_id==page.id).select(\n10\nf.pattern,f.id.count(),f.size.sum(),\n11\nf.mtime.year(), groupby=f.pattern,orderby=f.pattern)\n12\nreturn locals()\n\n5\n\n\fnersc\n\nMassimo Di Pierro\n\nFigure 4: The system administrative interface.\n\nThis code parses the URL in the request for the path, defines some local variables (d,t,f)\nreferencing the tables, builds a query to fetch the content of the folder: the path, the tags, the\nsubfolders and the patterns (i.e. groups of files with the same prefix). At statements follow\nthe DAL syntax:\n1 variable = db(query).select(what,how)\n\nThe @cache(...) decorator instructs the framework to cache each page for 60 seconds.\nThis means the if a page is requested more the once every 60 seconds, it will not hit the database\nmore then one time. This results in better performance.\nThe system enforces different types of access control. It provides a web based administrative\ninterface only accessible to managers (fig. 4. All downloads require user login.\nThe system itself is not domain specific and has no knowledge about QCD files and conventions. The domain specific knowledge is in a separate script that runs in background and populates\nthe database from the file/folder structure. This means the system can be used to publish data of a\ndifferent nature with minimal work. The system retains the original ability to download individual\nfiles using the web interface. Since these files can be big, the download requires login in order to\nprevent Denial of Service attacks.\nThe system exposes RESTful web services APIs based on the JSON protocol which can be\nused to access the data programmatically. Some gauge ensembles are comprised of thousands of\nfiles. To download them in batch we provide a script qcdutils_get.py, written in Python with\nno dependencies, available from [1].\nIn this example we use the script to dowload all files in the demo ensemble:\n1\n2\n3\n4\n5\n\n$ qcdutils_get.py http://qcd.nersc.gov/nersc/api/files/demo\nhttp://qcd.nersc.org/nersc/api/files/demo\ntarget folder: demo\ntotal files to download: 1\ndownloading demo.nersc\n\n6\n\n\fnersc\n\nMassimo Di Pierro\n\n6 demo.nersc 100% |# # # # # # # # # # # # # # # # | Time : 0 0 : 0 0 : 0 0 6 5 4 . 5 2 K / s\n7 completed download: 1/1\n\nWe now ask the script to convert all data from NERSC to ILDG(32bits):\n1 $ qcdutils_get.py --convert ildg --float demo/demo.nersc\n2 converting: demo/demo.nersc -> demo/demo.nersc.ildg\n3\n(precision: f, size: 4x8x8x8)\n4 100% |# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # |\n\nqcdutils keeps an internal log of all the operations completed to avoid duplication of work. It\nremebers what was downloaded/converted and where things are. We can ask qcdutils for a log\nof the completed tasks:\n1 $ qcdutils_get.py demo/qcdutils.catalog.db\n2 demo.nersc created on 2011-06-17T13:42:30.876812\n3\n[14e7cf9106bfcc16388aeac285ccdad9]\n4 demo.nersc.ildg created on 2011-06-17T13:42:34.424604\n5\n[5a1ae13ddd5cab7ddfe1b17454822ff5]\n\n4. Conclusions and Outlook\nThe system allows the user to register any URL and dynamically generates buttons that, when\npressed, pass a link to the data at the associated URL. This allows for the creation of third party\nweb services that can feed data directly from the new NERSC web interface allowing for decentralization of services. We can provide tools to help create such services. For example, we can build\nworkflows that interface the data archive with a batch queue on a large computational system.\nWe envision a future when the different research groups will provide their computing capabilities and their lattice QCD algorithms as web services for the consumption of other members in the\ncollaboration. The NERSC site provides more than just data for these collaborations - it also offers\nan infrastructure to register those third party services in a transparent way.\nAcknowledgements\nThis work was funded by Department of Energy grant DEFC02-06ER41441 and by National\nScience Foundation grant 0970137.\n\nReferences\n[1] Massimo Di Pierro. qcdutils, 2010.\n[2] Massimo Di Pierro. web2py website, 2010.\n[3] Massimo Di Pierro and Jonthan M. Flynn. Lattice QFT with FermiQCD. PoS, LAT2005:104, 2006.\n[4] S. Gottlieb. Benchmarking and tuning the MILC code on clusters and supercomputers. Nuclear\nPhysics B Proceedings Supplements, 106:1031\u20131033, 2001.\n[5] C. Maynard. International Lattice Data Grid: Turn on, plug in,and download. In Symposium on Lattice\nField Theory, 2009.\n[6] U.S. DOE. Nersc website, 2010.\n\n7\n\n\f"}