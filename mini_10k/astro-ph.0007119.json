{"id": "http://arxiv.org/abs/astro-ph/0007119v1", "guidislink": true, "updated": "2000-07-10T16:08:07Z", "updated_parsed": [2000, 7, 10, 16, 8, 7, 0, 192, 0], "published": "2000-07-10T16:08:07Z", "published_parsed": [2000, 7, 10, 16, 8, 7, 0, 192, 0], "title": "N-body simulations of self-gravitating gas in stationary fragmented\n  state", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0007250%2Castro-ph%2F0007433%2Castro-ph%2F0007038%2Castro-ph%2F0007458%2Castro-ph%2F0007252%2Castro-ph%2F0007054%2Castro-ph%2F0007273%2Castro-ph%2F0007028%2Castro-ph%2F0007364%2Castro-ph%2F0007067%2Castro-ph%2F0007136%2Castro-ph%2F0007156%2Castro-ph%2F0007174%2Castro-ph%2F0007059%2Castro-ph%2F0007079%2Castro-ph%2F0007198%2Castro-ph%2F0007307%2Castro-ph%2F0007118%2Castro-ph%2F0007446%2Castro-ph%2F0007361%2Castro-ph%2F0007431%2Castro-ph%2F0007294%2Castro-ph%2F0007237%2Castro-ph%2F0007393%2Castro-ph%2F0007154%2Castro-ph%2F0007414%2Castro-ph%2F0007193%2Castro-ph%2F0007119%2Castro-ph%2F0007428%2Castro-ph%2F0007183%2Castro-ph%2F0007019%2Castro-ph%2F0007357%2Castro-ph%2F0007295%2Castro-ph%2F0007341%2Castro-ph%2F0007405%2Castro-ph%2F0007145%2Castro-ph%2F0007186%2Castro-ph%2F0007045%2Castro-ph%2F0007462%2Castro-ph%2F0007311%2Castro-ph%2F0007269%2Castro-ph%2F0007325%2Castro-ph%2F0007040%2Castro-ph%2F0007338%2Castro-ph%2F0007244%2Castro-ph%2F0007441%2Castro-ph%2F0007290%2Castro-ph%2F0007243%2Castro-ph%2F0007176%2Castro-ph%2F0007424%2Castro-ph%2F0007066%2Castro-ph%2F0007060%2Castro-ph%2F0007449%2Castro-ph%2F0007326%2Castro-ph%2F0007135%2Castro-ph%2F0007050%2Castro-ph%2F0007240%2Castro-ph%2F0007013%2Castro-ph%2F0007368%2Castro-ph%2F0007229%2Castro-ph%2F0007106%2Castro-ph%2F0007201%2Castro-ph%2F0007464%2Castro-ph%2F0007113%2Castro-ph%2F0007095%2Castro-ph%2F0007128%2Castro-ph%2F0007036%2Castro-ph%2F0007403%2Castro-ph%2F0007391%2Castro-ph%2F0007400%2Castro-ph%2F0007161%2Castro-ph%2F0007139%2Castro-ph%2F0007293%2Castro-ph%2F0007232%2Castro-ph%2F0007008%2Castro-ph%2F0007075%2Castro-ph%2F0007015%2Castro-ph%2F0007478%2Castro-ph%2F0007130%2Castro-ph%2F0007022%2Castro-ph%2F0007253%2Castro-ph%2F0007355%2Castro-ph%2F0007177%2Castro-ph%2F0007363%2Castro-ph%2F0007350%2Castro-ph%2F0007375%2Castro-ph%2F0007470%2Castro-ph%2F0007084%2Castro-ph%2F0007432%2Castro-ph%2F0007425%2Castro-ph%2F0007020%2Castro-ph%2F0007209%2Castro-ph%2F0007288%2Castro-ph%2F0007188%2Castro-ph%2F0007230%2Castro-ph%2F0007210%2Castro-ph%2F0007204%2Castro-ph%2F0007301%2Castro-ph%2F0007263%2Castro-ph%2F0007285%2Castro-ph%2F0007279&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "N-body simulations of self-gravitating gas in stationary fragmented\n  state"}, "summary": "The interstellar medium is observed in a hierarchical fractal structure over\nseveral orders of magnitude in scale. Aiming to understand the origin of this\nstructure, we carry out numerical simulations of molecular cloud fragmentation,\ntaking into account self-gravity, dissipation and energy input. Self-gravity is\ncomputed through a tree code, with fully or quasi periodic boundary conditions.\nEnergy dissipation is introduced through cloud-cloud ineslatic collisions.\nSeveral schemes are tested for the energy input. It appears that energy input\nfrom galactic shear allows to achieve a stationary clumped state for the gas,\navoiding final collapse. When a stationary turbulent cascade is established, it\nis possible to derive meaningful statistical studies on the data such as the\nfractal dimension of the mass distribution.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0007250%2Castro-ph%2F0007433%2Castro-ph%2F0007038%2Castro-ph%2F0007458%2Castro-ph%2F0007252%2Castro-ph%2F0007054%2Castro-ph%2F0007273%2Castro-ph%2F0007028%2Castro-ph%2F0007364%2Castro-ph%2F0007067%2Castro-ph%2F0007136%2Castro-ph%2F0007156%2Castro-ph%2F0007174%2Castro-ph%2F0007059%2Castro-ph%2F0007079%2Castro-ph%2F0007198%2Castro-ph%2F0007307%2Castro-ph%2F0007118%2Castro-ph%2F0007446%2Castro-ph%2F0007361%2Castro-ph%2F0007431%2Castro-ph%2F0007294%2Castro-ph%2F0007237%2Castro-ph%2F0007393%2Castro-ph%2F0007154%2Castro-ph%2F0007414%2Castro-ph%2F0007193%2Castro-ph%2F0007119%2Castro-ph%2F0007428%2Castro-ph%2F0007183%2Castro-ph%2F0007019%2Castro-ph%2F0007357%2Castro-ph%2F0007295%2Castro-ph%2F0007341%2Castro-ph%2F0007405%2Castro-ph%2F0007145%2Castro-ph%2F0007186%2Castro-ph%2F0007045%2Castro-ph%2F0007462%2Castro-ph%2F0007311%2Castro-ph%2F0007269%2Castro-ph%2F0007325%2Castro-ph%2F0007040%2Castro-ph%2F0007338%2Castro-ph%2F0007244%2Castro-ph%2F0007441%2Castro-ph%2F0007290%2Castro-ph%2F0007243%2Castro-ph%2F0007176%2Castro-ph%2F0007424%2Castro-ph%2F0007066%2Castro-ph%2F0007060%2Castro-ph%2F0007449%2Castro-ph%2F0007326%2Castro-ph%2F0007135%2Castro-ph%2F0007050%2Castro-ph%2F0007240%2Castro-ph%2F0007013%2Castro-ph%2F0007368%2Castro-ph%2F0007229%2Castro-ph%2F0007106%2Castro-ph%2F0007201%2Castro-ph%2F0007464%2Castro-ph%2F0007113%2Castro-ph%2F0007095%2Castro-ph%2F0007128%2Castro-ph%2F0007036%2Castro-ph%2F0007403%2Castro-ph%2F0007391%2Castro-ph%2F0007400%2Castro-ph%2F0007161%2Castro-ph%2F0007139%2Castro-ph%2F0007293%2Castro-ph%2F0007232%2Castro-ph%2F0007008%2Castro-ph%2F0007075%2Castro-ph%2F0007015%2Castro-ph%2F0007478%2Castro-ph%2F0007130%2Castro-ph%2F0007022%2Castro-ph%2F0007253%2Castro-ph%2F0007355%2Castro-ph%2F0007177%2Castro-ph%2F0007363%2Castro-ph%2F0007350%2Castro-ph%2F0007375%2Castro-ph%2F0007470%2Castro-ph%2F0007084%2Castro-ph%2F0007432%2Castro-ph%2F0007425%2Castro-ph%2F0007020%2Castro-ph%2F0007209%2Castro-ph%2F0007288%2Castro-ph%2F0007188%2Castro-ph%2F0007230%2Castro-ph%2F0007210%2Castro-ph%2F0007204%2Castro-ph%2F0007301%2Castro-ph%2F0007263%2Castro-ph%2F0007285%2Castro-ph%2F0007279&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The interstellar medium is observed in a hierarchical fractal structure over\nseveral orders of magnitude in scale. Aiming to understand the origin of this\nstructure, we carry out numerical simulations of molecular cloud fragmentation,\ntaking into account self-gravity, dissipation and energy input. Self-gravity is\ncomputed through a tree code, with fully or quasi periodic boundary conditions.\nEnergy dissipation is introduced through cloud-cloud ineslatic collisions.\nSeveral schemes are tested for the energy input. It appears that energy input\nfrom galactic shear allows to achieve a stationary clumped state for the gas,\navoiding final collapse. When a stationary turbulent cascade is established, it\nis possible to derive meaningful statistical studies on the data such as the\nfractal dimension of the mass distribution."}, "authors": ["B. Semelin", "F. Combes"], "author_detail": {"name": "F. Combes"}, "author": "F. Combes", "arxiv_comment": "LaTeX 10 pages, 7 figures. To be published in A&A. A version with\n  nicer figure is available\n  http://wwwusr.obspm.fr/departement/demirm/perso/semelin/semelin.html", "links": [{"href": "http://arxiv.org/abs/astro-ph/0007119v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/astro-ph/0007119v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/astro-ph/0007119v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/astro-ph/0007119v1", "journal_reference": null, "doi": null, "fulltext": "A&A manuscript no.\n(will be inserted by hand later)\n\nASTRONOMY\nAND\nASTROPHYSICS\n\nYour thesaurus codes are:\n02.08.1 02.20.1 09.03.1; 09.07.1; 09.11.1; 09.19.1;\n\narXiv:astro-ph/0007119v1 10 Jul 2000\n\nN-body simulations of self-gravitating gas in stationary\nfragmented state\nB. Semelin and F. Combes\nObservatoire de Paris, DEMIRM, 61 Av. de l'Observatoire, F-75014, Paris, France\nReceived XX XX, 1999; accepted XX XX, 2000\n\nAbstract. The interstellar medium is observed in a hierarchical fractal structure over several orders of magnitude\nin scale. Aiming to understand the origin of this structure,\nwe carry out numerical simulations of molecular cloud\nfragmentation, taking into account self-gravity, dissipation\nand energy input. Self-gravity is computed through a tree\ncode, with fully or quasi periodic boundary conditions.\nEnergy dissipation is introduced through cloud-cloud ineslatic collisions. Several schemes are tested for the energy\ninput. It appears that energy input from galactic shear allows to achieve a stationary clumped state for the gas,\navoiding final collapse. When a stationary turbulent cascade is established, it is possible to derive meaningful statistical studies on the data such as the fractal dimension\nof the mass distribution.\nKey words: Physical processes: Hydrodynamics \u2013 Physical processes: Turbulence \u2013 ISM: clouds \u2013 ISM: general \u2013\nISM: kinematics and dynamics \u2013 ISM: structure\n\n1. Introduction\nFrom many studies over the last two decades, it has\nbeen established that the interstellar medium (ISM) has a\nclumpy hierarchical structure, approaching a fractal structure independent of scale over 4 to 6 orders of magnitude\nin sizes (Larson 1981, Scalo 1985, Falgarone et al 1992,\nHeithausen et al 1998). The structure extends up to giant molecular clouds (GMC) of 100 pc scale, and possibly\ndown to 10 AU scale, as revealed by HI absorption VLBI\n(Diamond et al 1989, Faison et al 1998) or extreme scattering events in quasar monitoring (Fiedler et al. 1987,\nFiedler et al. 1994). It is not yet clear which mechanism is\nthe main responsible for this structure; it could be driven\nby turbulence, since the Reynolds number is very high, or\nself-gravity, since clouds appear to be virialized on most\nof the scales, with the help of magnetic fields, differential\nrotation, etc...\nOne problem of the ISM turbulence is that the relative\nvelocities of clumps are supersonic, leading to high dissipaSend offprint requests to: B. Semelin\n\ntion, and short lifetime of the structures. An energy source\nshould then be provided to maintain the turbulence. It\ncould be provided by star formation (stellar winds, bipolar flows, supernovae, etc... Norman & Silk 1980). However, the power-law relations observed between size and\nline-width, for example, are the same in regions of starformation or quiescent regions, either in the galactic disk,\nor even outside of the optical disk, in the large HI extensions, where very little star formation occurs. In these\nlast regions alternative processes of energy input must be\navailable. A first possibilty is the injection by the galactic\nshear. Additionally, since there is no heating sources in\nthe gas, the dense cold clumps should be bathing at least\nin the cosmological background radiation, at a temperature of 3K (Pfenniger & Combes 1994). In any case, in a\nnearly isothermal regime, the ISM should fragment recursively (e.g. Hoyle 1953), and be Jeans unstable at every\nscale, down to the smallest fragments, where the cooling\ntime becomes of the same order as the collapse time, i.e.\nwhen a quasi-adiabatic regime is reached (Rees 1976).\nIn this work, we try to investigate the effect of selfgravity through N-body simulations. We are not interested\nin star formation, but essentially in the fractal structure\nformation, that could be driven essentially by gravity (e.g.\nde Vega et al. 1996). Our aim is to reach a quasi-stationary\nstate, where there is statistical equilibrium between coalescence and fragmentation of the clouds. This is possible\nwhen the cooling (energy dissipated through cloud collisions, and subsequent radiation) is compensated by an\nenergy flux due to external sources : cosmic rays, star formation, differential shear... Previous simulations of ISM\nfragmentation have been performed to study the formation of condensed cores, some with isolated boundary conditions (where the cloud globally collapses and forms stars,\ne.g. Boss 1997, Burkert et al. 1997), or in periodic boundary conditions (Klessen 1997, Klessen et al. 1998). The\nlatter authors assume that the cloud at large scale is stable, supported by turbulence, or other processes. They\nfollow the over-densities in a given range of scales, and\nschematically stop the condensed cores as sink particles\nwhen they should form structures below their resolution.\nWe also adopt periodic boundary conditions, since numer-\n\n\f2\n\nSemelin & Combes: Simulations of self-gravitating gas\n\nical simulations are very limited in their scale dynamics,\nand we can only consider scales much smaller than the\nlarge-scale cut-off of the fractal structure. We are also\nlimited by our spatial resolution: the smallest scale considered is far larger than the physical small-scale cut-off\nof the structures. Our dynamics is computed within this\nrange of scales.\nOur goal is to achieve long enough integration time for\nthe system to reach a stationary state, stationary in a statistical sense. This state should have its energy confined\nin a narrow domain, thus presenting the density contrasts\nof a fragmented medium while avoiding gravitational collapse after a few dynamical times. Only when those conditions are fulfilled, can we try to build a meaningful model\nof the gas. Let us consider for example the turbulence\nconcepts.\nTheoretical attempts have been made to describe the\ninterstellar medium as a turbulent system. While dealing\nwith a system both self-gravitating and compressible, the\nstandard approach has been to adapt Kolmogorov picture\nof incompressible turbulence. The first classical assumption is that the rate of energy transfer between scales is\nconstant within the so-called inertial range. This inertial\nrange is delimited by a dissipative scale range at small\nscales and a large scale where energy is fed into the system. In the case of the interstellar medium, the energy\nsource can be the galactic shear, or the galactic magnetic\nfield, or, on smaller scales, stellar winds and such. In this\nclassical picture of turbulence, one derives the relation\nvL \u223c L1/3 , where vL is the velocity of structures on scale\nL. If we consider now that the structures are virialized at\nall scales, we get the relation \u03c1L \u223c L\u22124/3 , where \u03c1L is the\ndensity of structures on scale L. This produces a fractal\ndimension D = 1.66. A more consistent version is to take\ncompressibility into account in Kolmogorov cascade; then\n3\n\u03c1L vL\n/L \u223c cst. Adding virialization, we get the relations\nvL \u223c L3/5 and \u03c1L \u223c L\u22124/5 . This produces the fractal dimension D = 2.2. It should be emphasized again that all\nthese scenarios assume a quasi-stationary regime.\nHowever, numerical simulations of molecular cloud\nfragmentation have been, so far, carried out in dissipative\nschemes which allow for efficient clumping (e.g Klessen\net al 1998, Monaghan & Lattanzio 1991). As such, they\ndo not reach stationary states. Our approach is to add\nan energy input making up for the dissipative loss. After\nrelaxation from initial conditions we attempt to reach a\nfragmented but non-collapsing state of the medium that\ndoes not decay into homogeneous or centrally condensed\nstates. It is then meaningful to compute the velocity and\ndensity fields power spectra and test the standard theoretical assumptions. It is also an opportunity to investigate\nthe possible fractal structure of the gas. Indeed, starting\nfrom a weakly perturbed homogeneous density field, the\nformation time of a fractal density field independent of the\ninitial conditions is at the very least of the order of the\nfree-fall time, and more likely many times longer. A long\n\nintegration time should permit full apparition of a fractal\nmass distribution, independent of the initial conditions.\nThis program encounters both standard and specific\ndifficulties. Galaxies clustering as well as ISM clumping\nrequire large density contrasts, that is to say high spatial\nresolution in numerical simulations. This point is tackled,\nbe it uneasily, by adaptative-mesh algorithms or tree algorithms, or multi-scale schemes (P3 M). Another problem\nis the need for higher time resolution in collapsed region.\nThis is CPU-time consuming or is dealt with by multiple time steps. This point is of primary sensitivity in our\nsimulation since we need to follow accurately the internal\ndynamics of the clumps and filaments to avoid total energy divergence. Finally we need a long integration time to\nreach the stationary state. This is directly in competition\nfor CPU-time with spatial resolution for given computing\nresources.\n2. Numerical methods\n2.1. Self-gravity\nIn our simulation we use N-body dynamics with a hierarchical tree algorithm and multipole expansion to compute\nthe forces, as designed by Barnes & Hut (1986, 1989).\nThe number of particles is between 10 000 and 120 000\nparticles. We are limited by the fact that we need long\nintegration time in our study.\nWithin the N-body framework the tree algorithm is a\nN ln(N ) search algorithm picking the closest neighbours\nfor exact force computation and sorting farther out particles in hierarchical boxes for multipole expansion. The size\nof the boxes used in the expansion is set, for the contribution of a given region to the force, by a control parameter\n\u03b8 defining the maximal angular size of the boxes seen from\nthe point where the force is computed. Typical values used\nfor \u03b8 are 0.5 to 1.0. Multipole expansion is carried out to\nquadrupole terms. As usual a short distance softening is\nused in the contribution of the closest particle to the interaction. The softening length is taken as \u223c 1/10 of the\ninter-particle distance of the homogeneous state.\n2.2. Boundary conditions\nThere are two ways to erase the finite size effect and avoid\nspherical collapse in a N-body simulation. We can choose\neither quasi-periodic boundary conditions or fully periodic\nboundary conditions following Ewald method (Hernquist\net al 1991). In quasi-periodic conditions the interaction of\ntwo particles is computed between the first particle and\nthe closest of all the replicas of the other particle. The\nreplicas are generated in the periodization of the simulation box to the whole space. In the fully periodic conditions, the first particle interacts with all the replicas of the\nother one. The relevance of each method will be discussed\nin section 3.1. We will compare them for simple free-falls\nusing the fractal dimension as diagnosis.\n\n\fSemelin & Combes: Simulations of self-gravitating gas\n\n2.3. Time integration and initial conditions\nThe integration is carried out through a multiple time\nsteps leap-frog scheme. Making a Keplerian assumption\nabout the orbits of the particles, we have the following\nrelation between time step and the local interparticle dis3\ntance: \u03b4\u03c4 \u223c (\u03b4l) 2 . In a fractal medium, the exponent could\nbe different. We do not take this into account since it\nwould lead us to modify the integration scheme dynamically according to the fractal properties of the system. As\nthe tree sorts particles in cells of\u221asize 2n d0 according to\nthe local density, we should use (2 2)n \u03b4t0 time steps. For\nsimplicity we are using 3n \u03b4t0 . Then, n different time steps\nallow us to follow the dynamics with the same accuracy\nover regions with density contrasts as high as 23(n\u22121) .\nWe will use several types of initial conditions. The\nusual power law for the density power spectrum will be\nused for the free falls. It is usually implemented by using\nZel'dovitch approximation which is valid before first shell\ncrossing for a pressureless perfect fluid. The validity range\nof this approximation is difficult to assess in an N-body\nsimulation. We use a similar implementation that does not\nhowever extend to non-linear regimes but also gives density power spectra with the desired shapes. A gaussian\nvelocity field is chosen with a specified power spectrum\nPv (k) \u223c k \u03b1\u22122 , then the particles are positioned at the\nnodes of a grid and displaced according to the velocity\nfield with one time step. The resulting density fluctuations spectrum is P\u03c1 (k) \u223c k \u03b1 according to the matter\nconservation.\n2.4. Gas physics\nThere can be several modelizations for the ISM: either it\nis considered as a continuous and fluid medium and simulated through gas hydrodynamics (with pressure, shocks,\netc..) or, given the highly clumped nature of the interstellar medium, and its highly inhomogeneous structure\n(density variations over 6 orders of magnitude), it can be\nconsidered as a collection of dense fragments, that dissipate their relative energy through collisions. Our choice of\nparticle dynamics assumes that each particle stands for a\nclump and neglects the interclump medium. Another reason is that we expect a fractal distribution of the masses.\nThis means a non-analytical density field which is not to\nbe easily handled by hydrodynamical codes.\nThe dissipation enters the dynamics through a gridless sticky particles collision scheme. The collision round\nis periodically computed every 1 to 10 time steps. The\nfrequency of this collision round is one way to adjust the\nstrength of the dissipation. Since, as the precise collision\nschemes will reveal , we adopt a statistical treatment of\nthe dissipation, it is not necessary to compute the collision\nround at each time step. Two schemes are investigated.\nThe first uses the tree search to find a candidate to collision with a given particle, in a sphere whose radius rc is\n\n3\n\na fixed parameter. Inelastic collisions are then computed,\ndissipating energy but conserving linear momentum. In\nthe second scheme, each particle has a probability to collide proportional to the inverse of the local mean collision\ntime. If it passes the probability test, the collision is computed with the most suitable neighbour. In this second\nscheme, dissipation may occur even in low density regions;\nin the first it occurs only above a given density threshold.\nIn practice this implies that, in the first scheme, dissipation happens only at small scales, while in the second, it\nhappens on all scales but is still stronger at small scales.\nSpecial attention must be paid to the existence of a\nsmall scale cutoff in the physics of the system. Indeed, at\nvery small scale ( \u223c 20 AU ), the gas is quasi-adiabatic. Its\ncooling time is then much longer than the isothermal free\nfall time at the same scale. Moreover, the mean collision\ntime between clumps at this scale, in a fractal medium, is\nmuch shorter than the cooling time. As a result, collisions\ncompletely prevent the already slowed down processes of\ncollapse and fragementation in the quasi-adiabatic gas: the\nfractal structure is broken at the corresponding scale. To\ntake these phenomena into account in our simulation, we\nneed to introduce a large-density cutoff. This is achieved\nby computing elastic or super-elastic collisions at scale\n< 0.5rc , instead of inelastic collisions. The practical implementation follows the same procedure as for the first\ninelastic collision scheme. In the case of super-elastic collisions, the overall energy balance is still negative at small\nscales (due to a volume effect), however we do introduce a\nmechanism of energy injection at small scale. This choice\ncan be furthermore justified by physical considerations.\nWhen there is no energy provided by star formation\n(for example in the outer parts of galaxies, where gas extends radially much beyond the stellar disk), the gas is\nonly interacting with the intergalactic radiation field, and\nthe cosmic background radiation. The latter provides a\nminimum temperature for the gas, and plays the role of a\nthermostat (at the temperature of 2.76K at zero redshift).\nThe interaction between the background and the gas can\nonly occur at the smallest scale of the fragmentation of the\nmedium, corresponding to our small scale cutoff; the radiative processes involve hydrogen and other more heavy\nelements (Combes & Pfenniger 1997). To maintain the\ngas isothermal therefore requires some energy input at the\nsmallest scale.\nSeveral schemes for the energy input have been tried.\nReinjection at small scale through added thermal motion\nhas proved unable to sustain the system in any other state\nthan an homogeneous one. Then, turning to the turbulent point of view, we have tried reinjection at large scale.\nTwo main methods have been tested; reinjection through\na large scale random force field, and reinjection through\nthe action of the galactic shear. Their effect will be discussed in section 5.\nFinally, the statistical properties of the system can be\ndescribed in many different way. We will use the correla-\n\n\f4\n\nSemelin & Combes: Simulations of self-gravitating gas\n\ntion fractal dimension as diagnosis. Definition and example of application of this tool are given in the appendix.\n3. Simple 3-D free falls\n3.1. The choice of the boundary conditions\nA fractal structure such as observed in the ISM or in the\ngalaxies distribution obeys a statistical translational invariance. If we run simulations with vacuum boundary\ncondition, this invariance is grossly broken. On the other\nhand the quasi-periodic or fully-periodic conditions restore this invariance to some extent. They have been used\nin cosmological simulations. Hernquist et al (1991) have\ncompared the two models to analytical results and found\nthat the fully-periodic model simulates more accurately\nthe self-gravitating gas in an expanding universe. This is in\nagreement with expectations, since uniform expansion is\nautomatically included in a fully-periodic model, while it\nis not in a quasi-periodic one. Klessen (1996,1998) applied\nEwald method to simulations of the interstellar medium.\nThis is not natural since expansion is necessary to validate Ewald method. Nevertheless one can argue that the\ndynamics is not altered by the use of Ewald method in\nregions with high density contrasts.\nHernquist's study was on the dynamics of the modes.\nWe are more interested in the fractal properties. As far as\nwe are concerned the question is wether the same initial\nconditions produce the same fractal properties in a cosmological framework (fully-periodic conditions) and in a\nISM framework (quasi-periodic conditions). We will try to\nanswer this question in section 3.3.\n3.2. The choice of the initial conditions\nThe power spectrum of the density fluctuations is most\ncommonly described as a power law in cosmological simulations. Then, different exponents in the power law produce different fractal dimensions. The comoslogist can\nhope to find the fractal dimension from observations and\ngo back to the initial power spectrum. In the case of the\ninterstellar medium however, it is unlikely that the fractal\ndimension is the result of initial conditions since the lifetime of the medium is much longer than the dynamical\ntime of the structures. In this regard, all initial conditions\nshould be erased and produce the same fractal dimension. We will check whether this is the case for power law\ndensity spectra with different exponents. Simple free falls\nwith such initial conditions will allow the comparison between the two types of periodic boundary conditions and\nwill allow us to compare between 3D and 2D models and\ndifferent dissipation schemes.\n\nconditions for two different power law exponents: \u03b1 = \u22121\nand \u03b1 = \u22122. About 120 000 particles were used in the\nsimulations. The time evolution of the particle distribution for \u03b1 = \u22122 and fully periodic condition is plotted in\nFig. 1. If we compare the qualitative aspect of the matter\ndistribution with those found in SPH simulations (Klessen\n1998), a difference appears. Filaments are less present in\nthis N-body simulation than in SPH simulations. We believe that this is due to the strongly dissipative nature\nof SPH simulations. Indeed filaments form automaticaly,\neven without gravity, with P (k) \u223c k \u22122 initial conditions\nfor the density field. Then, the strong dissipation of SPH\ncodes is necessary to retain them; N -body codes seem to\nshow that gravity by itself is not enough.\n3.3.1. Fractal dimension\nFor each of the four simulations, the fractal dimension as\na function of scale has been computed at different times\nof the free fall. Results are summarized in Fig. 2.\nThe fractal dimension of a mathematical fractal would\nappear either as an horizontal straight line or as a curve\noscillating around the fractal dimension if the fractal has\nno randomization (like a Cantor set). For our system, it\nappears that at sufficiently early stages of the free fall, and\nfor scales above the dissipative cutoff, the matter distribution is indeed fractal. However the dimension goes down\nwith time to reach values of 2 for \u03b1 = \u22122, and between\n2 and 2.5 for \u03b1 = \u22121. This is the fractal dimension for\nthe total density, not for the fluctuations only. Stabilization of the fractal dimension marginally happens before\nthe dissipation breaks the fractal.\nOne conclusion is however reasonable: as far as the\nfractal dimension is concerned, the difference between\nfully-periodic boundary conditions and quasi-periodic\nboundary conditions is not important. The deviation is\na bit stronger in the \u03b1 = \u22121 case, which is understandable since \u03b1 = \u22121 produces weaker density contrasts in\nthe initial conditions than \u03b1 = \u22122 and so the dynamics is\nless decoupled from the expansion. The effect of this conclusion is that we will not use the fully-periodic boundary\nconditions in further simulations since they require more\nCPU time and have no physical ground in the ISM framework. Clump mass spectra are given in appendix B.\n4. Simple 2-D free falls\nWe consider a 2-D system where particles have only two\ncartesian space coordinates but still obey a r12 interaction\nforce.\n4.1. Motivations for the two dimensional study\n\n3.3. Simulations and results\nThe four first simulations are free falls from power law initial conditions in either fully or quasi-periodic boundary\n\nTurning to 2-D simulations allows access, for given computing resources, to a wider scale-range of the dynamics.\nOr, for given computing resources and a given scale-range,\n\n\fSemelin & Combes: Simulations of self-gravitating gas\n\n5\n\nFig. 1. Time evolution over about 0.5 free fall time. The initial conditions are density fluctuations with power spectrum\nP (k) \u223c k\u22122 . The simulation contains 117649 (493 ) particles.\n\n\f6\n\nSemelin & Combes: Simulations of self-gravitating gas\n\n\u03b1\n\n\u03b1\n\n\u03b1\n\n\u03b1\n\nFig. 2. The fractal dimension of the matter distribution is plotted as a function of the log of the scale at different times of the\nfree fall in four different conditions described under the curves. \u03b1 designates the exponent of the power law of the density power\nspectrum. Curves are labeled from early to late states.\n\nto larger integration times. The later is what we will need\nin the simulation with energy injection. In practice we will\nchoose to use 104 particles in 2-D simulations to access\nboth a larger integration time and a wider scale range.\nIndeed, between a 3-D simulation with N = 105 particles and a 2-D simulation with 104 particles one improves\n1\n1\nthe scale range from [1, N 3 = 46] to [1, N 2 = 100]. At\nthe same time one can increase the integration-time by a\nfactor of \u223c 10 at equal CPU cost.\nWe can also add a physical reason to these computational justifications. The simulations with an energy injection aim to describe the behaviour of molecular clouds in\nthe thin galatic disk. This medium has a strong anisotropy\nbetween the two dimensions in the galactic plane and the\nthird one. As such it is a suitable candidate for a bidimensional modeling.\nMoreover, studying a bidimensional system will allow\nus to check how the fractal dimension, dependent or not\nof the initial conditions, is affected by dimension of the\nspace.\n\n4.2. Simulations with 2 different dissipative schemes\nHere again initial conditions with a power law density\npower spectrum are used. Exponent \u03b1 = \u22122 is chosen\nto allow a comparison with the 3-D simulations. Boundary conditions are quasi-periodic. We have carried out two\nsimulations with the two different dissipative schemes de-\n\n\u03b1\n\n\u03b1\n\nFig. 3. Fractal dimension as function of scale at different stages of the time evolution. The simulations are twodimensionnal with 10609 particles. The dissipative scheme\nis modified between the two simulations according to the\ndescription in sec 2.4 .\n\nscribed in section 2.4 . The fractal dimensions at different\nstages of each of these two simulations are shown in Fig. 3.\n\n\fSemelin & Combes: Simulations of self-gravitating gas\n\nIn both simulations the fractal dimension of the homogeneous initial density field is 2 at scales above mean\ninter-particle distance and 0 below. Then the density fluctuations develop and the fractal dimension goes down to\nabout 1.5 \u2212 1.6 in both simulations. This value was not\nreached in 3-D simulations. This shows that the dimension\nof the space has an influence on the fractal dimension of a\nself-gravitating system evolved from initial density fields\nwith a power law power spectrum. Indeed spherical configurations are favoured in 3 dimensions and may produce\na different type of fractal than cylindrical configurations\nwhich are favored in two dimensions.\nAnother point is that the fractal dimension of the system at small scales is indeed sensitive to the dissipative\nscheme. The second scheme even alters the fractality of\nlarge scales. So even if we believe that the fractality of a\nself-gravitating system is controlled by gravity, we must\nkeep in mind the fact that the dissipation has an influence on the result. In this regard, discrepancies should appear between N -body simulations including SPH or other\ncodes.\nThe clump mass spectra are not conclusive due to insufficient number of clumps formed with 10609 particles.\n5. 2-D simulations with an energy source\nAs already stated, the ISM is a dissipative medium. Structures radiate their energy in a time-scale much shorter\nthan the GMCs typical life time inferred from observations. Therefore we are led to provide an energy source in\nthe system to obtain a life time longer than the free fall\ntime.\n\n7\n\nWe would like to emphasize that, in all the cases just\nmentioned, the existence of super-elastic collisions at very\nshort distances, are not at all able to avoid the collapse\nof \"blackholes\". They are indeed beaten by inelastic collisions which happen more frequently. Thus the density\ncutoff introduced by superelastic collision, is not able all\nby itself to sustain or destroy clumps.\nOnly one of the schemes we have tested avoids the\nblackhole/homogeneity duality. In this scheme, energy is\nprovided by the galactic shear. It produces an inhomogeneous state whose life time does not appear to be limited\nby a final collapse in the simulations. We now describe\nthis scheme in detail.\n5.2. Modelisation of the galactic shear\nThe idea is to consider the simulation box as a small part\nof a bigger system in differential rotation. The dynamics\nof such a sub-system has been studied in the field of planetary systems formation (Wisdom and Tremaine 1988).\nToomre (1981) and recently Hubert and Pfenniger (1999)\nhave applied it to galactic dynamics.\nThe simulation box is a rotating frame with angular\nspeed \u03a90 which is the galactic angular speed at the center of the box. Coriolis force acts on the particles moving in the box. An additional external force arises from\nthe discrepancy between the inertial force and the local\nmean gravitational attraction of the galaxy. The balance\nbetween these two forces is achieved only at points that\nare equally distant from the galactic center as the center\nof the box. Let us consider a 2-dimensional case. If y is\nthe orthoradial direction, and x the radial direction the\nequations of motion are written:\n\n5.1. The choice of the energy source\nDifferent types of sources are invoked to provide the necessary energy input: stellar winds, shock waves, heating\nfrom a thermostat, galatic shear... We have tested several\npossibilities.\nOur first idea was to model an interaction with a thermostat by adding periodically a small random component\nto the velocity field. We have tried to add it either to all\nthe particles or only to the particle in the cool regions.\nIf enough energy is put into this random injection, the\nmono-clump collapse is avoided. However the resulting final state is not fractal, nor does it show density structures\non several different scales. It consists in a few condensed\npoints, like \"blackholes\", in a hot homogeneous phase.\nThe second idea is to model a generic large scale injection by introducing a large scale random force field. We\nhave tried stationary and fluctuating fields. It is possible\nin this scheme, by tuning the input and the dissipation,\nto lengthen the medium life time in an \"interesting\" inhomogenous state by a factor 2 or 3. However the final state,\nafter a few dynamical times, is the same as for thermal input.\n\n\u00ff = \u22122\u03a90 \u1e8b + Fy\n\u1e8d = 2\u03a90 \u1e8f \u2212 2\u03a90 r0\n\nd\u03a9\ndr\n\nx + Fx\nr0\n\nThe Fx,y are the projections of the internal gravitational\nforces. The shear force acting in the radial direction is able\nto inject into the system energy taken from the rotation\nof the galaxy as a whole.\nSome modifications must also be brought to the\nboundary condition. It is not consistent with the differential rotation to keep a strict spatial periodicity. To take\ndifferential rotation into account, layers of cells at different\nradii must slide according to the variation of the galactic\nangular speed between them. One particle still interacts\nwith the closest of the replicas of another particle (including the particle itself). This is sketched on Fig. 4.\n5.3. Results\nWe have computed simulations in two dimensions with\n10609 particles. The direction orthogonal to the galactic\n\n\f8\n\nSemelin & Combes: Simulations of self-gravitating gas\n\nShear speed\n\nGalactic\nRotation\nGalactic center\nSimulation\ndirection\nBox\n\ntion of the stripes. These two structures are not created\nby the exact same dynamical processes.\nIt must also be noted that the shear plays a direct role\nat large scale (of the order of 10 pc), where the galactic\ntidal forces are comparable to the self-gravity forces of\nthe corresponding structures. But since the structures are\nfragmenting hierarchically, it is expected that its effect\npropagates and cascades down to the smallest scales.\n5.3.2. Fractal analysis\n\nShear speed\n\nFig. 4. Effect of the galactic shear on the periodic conditions. The layers of cells have a relative drifting speed.\n\ndisk is not taken into account. A tuning between dissipation rate and shear strength is necessary to obtain a\nstructured but non collapsing configuration. However it is\nnot a fine tuning at all. We found out that, in a range of\nvalues of the shear, the dissipation adapts itself to compensate the energy input so that we didn't encounter any\nlimitation in the life time of the medium. The simulations\nhave been carried out over more than 20 free-fall times.\nSnapshots from a simulation are plotted in Fig. 5.\n5.3.1. Formation of persistent structures\nWe can see that tilted stripes appear in the density field.\nThis structure appears also in simulations by Toomre\n(1981) and Hubert and Pfenniger (1999). The new feature\nis the intermittent appearance of dense clumps within the\nstripes. Theses clumps remain for a few free fall times of\nthe total system, then disappear, torn apart by the shear.\nThis phenomenon is unknown in the simple free fall simulations where a clump, once formed, gets denser and more\nmassive with time. It also appeared that the tearing of\nthe clumps by the shear happens only if super-elastic collisions enact an efficient density cut-off. If we use elastic\ncollisions only, below the dissipation scale, thus enacting\na less efficient density cut-off, the clumps persist. However\nthey do not collapse to the dense blackhole states encountered with different large scale energy input schemes. So\nthe combination of the galactic shear and super-elastic collisions below the dissipation scale is necessary to obtain\ndestroyable clumps, while the shear alone produces rather\nstable clumps, and the super-elastic collisions alone cannot avoid complete collapse.\nWhile we cannot consider the density field as a fractal\nstruture, it is indeed the beginning of a hierarchical fragmentation since we have two levels of structures. However\nthe stripes are mainly the result of the shear. On the other\nhand the clumps are the simple gravitational fragmenta-\n\nThe fractal dimension of the medium is plotted at different\ntimes in Fig. 6. Two characteristic scales are clearly visible. At large scale, the scale of the stripes, the dimension\nis about 1.9 with some fluctuations in time. At small scale,\nthe dimension fluctuates strongly due to the appearance\nand disappearance of clumps. This shows through the appearance of a bump at the clump size. This size is about\nthe dissipation scale. It is important to mention that the\nsmall scale range, while under the cutoff of the initial homogeneous condition, is not under our dynamical resolution. The mean inter-particle distance decreases from its\ninitial value and is consistently followed by the N -body\ndynamics.\n5.3.3. Effect of the initial conditions\nWe have already emphasized that in GMC simulations,\nthe resulting structure should be independent of the initial\nconditions. We have performed the simulation for various\nvalues of the exponant of the power spectrum. In the range\n[\u22120.5, 0.5] the long time behaviour is the one described\nabove, thus satisfying the required independence. However, for more steep spectrum value like -2, the medium\ntend to collapse early into large clumps, thereby preventing the shear to act efficiently.\nWe see that the behaviour is independent of the initial\nconditions as long as the continuity of the medium at scale\nlarger than the GMC size (the clump size in the simulation) is not broken so that the shear can act to sustain the\nGMC against collapse.\n6. Discussion and Conclusion\nWe have shown that, in simulations without energy input, the evolution of the fractal dimension depends on\nthe initial conditions and also, to some extent, on the\ndissipation schemes. Then we have investigated the effects of an energy input on the dynamics of the system.\nThis input is necessary to prevent the total collapse of\nthe system. Moreover, we do not want the input to destroy the inhomogeneous fractal structure of the medium,\nas done by random reinjections (thermal bath, random\nforce field). Among the solutions we have tested, only the\nhighly regular force field provided by the galactic shear\npreserves an inhomogeneous state. However this state is\n\n\fSemelin & Combes: Simulations of self-gravitating gas\n\nquite strongly constrained by the geometry of the shear.\nStripes appear as a result. Interestingly, clumps are formed\nin these stripes and can be destroyed if we have an efficient\nenough density cutoff .\nThis state does not have a well-defined fractal dimension. Stripes are the effect of a large scale action on the\nsystem and within our dynamic range in scale, we cannot\nget rid of this boundary effect. If we had more resolution,\nthe clumps could fragment, and we might reach a scale\ndomain free of boundary effects. One of our prospects is\nto follow the inner dynamic of a clump with simulations in\nrecursive sub-boxes going down in scale. This can produce\na great dynamic scale range but only in a small region of\nspace.\nAppendix A: Computing the fractal dimension\nBy fractal dimension we mean more accurately the correlation fractal dimension. We will use the notation Df ,\ndefined as follows : if we consider a fractal set of points\nof equal weight located at xj , the fractal dimension of the\nensemble obeys the relation :\n\nlim r\n\nr\u21920\n\nDf\n\n= lim\n\nr\u21920\n\n*\n\nXZ\nj\n\n\u03b4(x \u2212 xj )dx\n\n|x\u2212xi |<r\n\n+\n\n.\ni\n\nThe brackets stand for an ensemble average. In computational applications and in physical systems, the r \u2192 0\nlimit is not reached. However the relation should hold at\nscales where the boundary effects created by the finite size\nof the system are negligible.\nIn practice, for a non-fractal ensemble of points, Df\nusually depends on r (but not always). For a fractal it is\nindependent of r, or at least it oscillates around a mean\nvalue. The latter case can happen for a set with a strong\nscale periodicity like the Cantor set. Examples are given in\nFig. A.1. As the above remarks show, Df is not a definitive\ncriterion of fractality.\nAccording to the definition, the computation of the\nfractal dimension is based on the following method. rDf\nis the mean mass in a sphere of radius r centered on a\nparticle. This mass is actually computed for each particle\nusing the tree search, then it is averaged and the value\nDf (r) is derived. The average can be made on a subset\nof points to lower the computation cost, the result is then\nnoisier.\nAppendix B: Clump mass spectrum\nAlthough the results are not very conclusive, we give\nthe mass distribution of the clumps in the 3-D simple\nfreefall, to allow comparison with observational data and\nother numerical simulations. Plotting log10 (N ) against\nlog10 (m), the slope infered from observation data is \u22120.5.\nThus the clump mass spectrum behaves as a power law :\ndN\n\u22121.5\n.\ndm \u223c m\n\n9\n\nFig. B.1. Clump mass spectra for two values of \u03b1 at different\nevolution times. The given time-unit is about 1/10 of the free\nfall time. At t = 5. the spectra show a \u22120.38 \u00b1 0.03 slope for\n\u03b1 = \u22121 and a \u22120.18 \u00b1 0.03 for \u03b1 = \u22122.\nTo produce the mass spectrum, the first step is to define individual clumps. We have used an algorithm very\nsimilar to the one proposed by Williams et al (1994). We\ncompute the density field from an interpolation of the distribution of the particles with a cloud-in-cell scheme. It\nshould be mentione d that this procedure tends to produce an artificially high number of very small clumps associated to isolated particles or pair of particules which\nshould not be considered as clumps at all.\nOn Fig. B.1 the clump mass spectrum is given at different times of the evolution and for the two types of initial\nconditions (\u03b1 = \u22121 , \u22122). Quasi-periodic boundary conditions are used. As time increases, as we can see, the clump\nmass spectrum slope decreases to reach \u22120.38 \u00b1 0.03 for\n\u03b1 = \u22121 and \u22120.18 \u00b1 0.03 for \u03b1 = \u22122. At later times,\nthe power law is broken by the final dissipative collapse.\nAccording to this diagnosis, the case \u03b1 = \u22121 is closer to\nthe observed values. However, once again, this simulation\nprovides only a transient state which is unlikely to be a\ngood model of a GMC.\nReferences\nBarnes J., Hut P.: 1986, Nature 324, 446\nBarnes J., Hut P.: 1989, ApJS 70, 389\nBoss A.: 1997, ApJ 483, 309\nBurkert A., Bate M.R., Bodenheimer P.: 1997, MNRAS 289,\n497\nCombes F., Pfenniger D.: 1997, A&A 327, 453\nde Vega H., Sanchez N., Combes F.: 1996, Nature 383, 53\nDiamond P.J., Goss W.M., Romney J.D. et al: 1989, ApJ 347,\n302\nFaison M.D., Goss W.M., Diamond P.J., Taylor G.B.: 1998,\nAJ 116, 2916\nFalgarone E., Puget J-L., Perault M.: 1992, A&A 257, 715\nFiedler R.L., Dennison B., Johnston K., Hewish A.: 1987, Nature 326, 6765\nFiedler R.L., Pauls T., Johnston K., Dennison B.: 1994, ApJ\n430, 595\nFleck R.C.: 1981, ApJ 246, L151\nHeithausen A., Bensch F., Stutzki J., Falgarone E., Panis J.F.:\n1998, A&A 331, L65\nHernquist L., Bouchet F., Suto Y.: 1991, ApJS 75, 231\nHoyle F.: 1953, ApJ 118, 513\nHuber D., Pfenniger D.: 1999, astro-ph/9904209, to be published in the proceedings of The Evolution of Galaxies on\nCosmological Timescale, eds. J.E. Beckman & T.J. Mahoney, Astrophysics and Space Science.\nKlessen R. S.: 1997, MNRAS , 11\nKlessen R. S., Burkert A., Bate M.R: 1998, ApJ 501, L205\nKlessen R. S., Burkert A.: 1999, astro-ph/9904090 submitted\nto ApJ.\n\n\f10\n\nSemelin & Combes: Simulations of self-gravitating gas\n\nLarson R.B.: 1981, MNRAS 194, 809\nMonaghan J.J., Lattanzio J.C.: 1991, ApJ 375, 177\nNorman C.A., Silk J.: 1980, ApJ 238, 158\nPfenniger D., Combes F.: 1994, A&A 285, 94\nRees M.J., 1976, MNRAS 176, 483\nScalo J.M.: 1985, in \"Protostars and Planets II\", ed. D.C. Black\nand M.S. Matthews, Univ. of Arizona Press, Tucson, p. 201\nToomre A.: 1981, in \"The Structure and Evolution of Normal\nGalaxies\", eds. Fall S.M. and Lynden-Bell D., Cambridge\nUniv. Press, p. 111\nWisdom J.,Tremaine S., 1988, Astron. J., 95, 925\nWilliams J. P.,De Geus E. J., Blitz L.: 1994, ApJ 428,693\n\n\fSemelin & Combes: Simulations of self-gravitating gas\n\n11\n\nFig. 5. 2-D simulation with 10609 particles over 20 free fall times of the total system. The different smapshots are\ntaken at periodic time interval. The galactic center is toward the bottom of the boxes. Sliding replicas of the central\nbox are shown for continuation\n\n\f12\n\nSemelin & Combes: Simulations of self-gravitating gas\n\nFig. 6. Fractal dimension computed at different epochs matching those of fig 5.\n\n\fSemelin & Combes: Simulations of self-gravitating gas\n\n13\n\nFig. A.1. The fractal correlation dimension is plotted as a function of the scale for two different sets of points : the first (not\nfractal) set is an isothermal sphere and a second is a fractal cantor-like set build recursively on 8 levels with a small part of\nrandomization. This shows that Df independent of r is neither a sufficient nor a mecessary condition of fractality\n\n\f"}