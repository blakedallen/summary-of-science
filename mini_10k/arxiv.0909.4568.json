{"id": "http://arxiv.org/abs/0909.4568v1", "guidislink": true, "updated": "2009-09-24T22:28:10Z", "updated_parsed": [2009, 9, 24, 22, 28, 10, 3, 267, 0], "published": "2009-09-24T22:28:10Z", "published_parsed": [2009, 9, 24, 22, 28, 10, 3, 267, 0], "title": "Electron density and transport in top-gated graphene nanoribbon devices:\n  First-principles Green function algorithms for systems containing large\n  number of atoms", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.2319%2C0909.0053%2C0909.3229%2C0909.3890%2C0909.2382%2C0909.3905%2C0909.3321%2C0909.3676%2C0909.1326%2C0909.4533%2C0909.0991%2C0909.4269%2C0909.5669%2C0909.5170%2C0909.4003%2C0909.5048%2C0909.4105%2C0909.1766%2C0909.5480%2C0909.5486%2C0909.0117%2C0909.4093%2C0909.2237%2C0909.4064%2C0909.4989%2C0909.0329%2C0909.3225%2C0909.0576%2C0909.5416%2C0909.0651%2C0909.0793%2C0909.4664%2C0909.1994%2C0909.1697%2C0909.4568%2C0909.1217%2C0909.0347%2C0909.2327%2C0909.4012%2C0909.4669%2C0909.1987%2C0909.3290%2C0909.0463%2C0909.2184%2C0909.3004%2C0909.2104%2C0909.1854%2C0909.3083%2C0909.1056%2C0909.1628%2C0909.0076%2C0909.1032%2C0909.5419%2C0909.2682%2C0909.1395%2C0909.1718%2C0909.0886%2C0909.1647%2C0909.1869%2C0909.3421%2C0909.2166%2C0909.2028%2C0909.3656%2C0909.3809%2C0909.4086%2C0909.1904%2C0909.3753%2C0909.2783%2C0909.5164%2C0909.4379%2C0909.3865%2C0909.1091%2C0909.1797%2C0909.5240%2C0909.3222%2C0909.3763%2C0909.1658%2C0909.2270%2C0909.3838%2C0909.0992%2C0909.4515%2C0909.0208%2C0909.0277%2C0909.1500%2C0909.1529%2C0909.3730%2C0909.1212%2C0909.5372%2C0909.2641%2C0909.1355%2C0909.5638%2C0909.4403%2C0909.3067%2C0909.0634%2C0909.0370%2C0909.3932%2C0909.3393%2C0909.5557%2C0909.1833%2C0909.3203%2C0909.4452&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Electron density and transport in top-gated graphene nanoribbon devices:\n  First-principles Green function algorithms for systems containing large\n  number of atoms"}, "summary": "The recent fabrication of graphene nanoribbon (GNR) field-effect transistors\nposes a challenge for first-principles modeling of carbon nanoelectronics due\nto many thousand atoms present in the device. The state of the art quantum\ntransport algorithms, based on the nonequilibrium Green function formalism\ncombined with the density functional theory (NEGF-DFT), were originally\ndeveloped to calculate self-consistent electron density in equilibrium and at\nfinite bias voltage (as a prerequisite to obtain conductance or current-voltage\ncharacteristics, respectively) for small molecules attached to metallic\nelectrodes where only a few hundred atoms are typically simulated. Here we\nintroduce combination of two numerically efficient algorithms which make it\npossible to extend the NEGF-DFT framework to device simulations involving large\nnumber of atoms. We illustrate fusion of these two algorithms into the\nNEGF-DFT-type code by computing charge transfer, charge redistribution and\nconductance in zigzag-GNR/variable-width-armchair-GNR/zigzag-GNR two-terminal\ndevice covered with a gate electrode made of graphene layer as well. The total\nnumber of carbon and edge-passivating hydrogen atoms within the simulated\ncentral region of this device is ~7000. Our self-consistent modeling of the\ngate voltage effect suggests that rather large gate voltage might be required\nto shift the band gap of the proposed AGNR interconnect and switch the\ntransport from insulating into the regime of a single open conducting channel.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.2319%2C0909.0053%2C0909.3229%2C0909.3890%2C0909.2382%2C0909.3905%2C0909.3321%2C0909.3676%2C0909.1326%2C0909.4533%2C0909.0991%2C0909.4269%2C0909.5669%2C0909.5170%2C0909.4003%2C0909.5048%2C0909.4105%2C0909.1766%2C0909.5480%2C0909.5486%2C0909.0117%2C0909.4093%2C0909.2237%2C0909.4064%2C0909.4989%2C0909.0329%2C0909.3225%2C0909.0576%2C0909.5416%2C0909.0651%2C0909.0793%2C0909.4664%2C0909.1994%2C0909.1697%2C0909.4568%2C0909.1217%2C0909.0347%2C0909.2327%2C0909.4012%2C0909.4669%2C0909.1987%2C0909.3290%2C0909.0463%2C0909.2184%2C0909.3004%2C0909.2104%2C0909.1854%2C0909.3083%2C0909.1056%2C0909.1628%2C0909.0076%2C0909.1032%2C0909.5419%2C0909.2682%2C0909.1395%2C0909.1718%2C0909.0886%2C0909.1647%2C0909.1869%2C0909.3421%2C0909.2166%2C0909.2028%2C0909.3656%2C0909.3809%2C0909.4086%2C0909.1904%2C0909.3753%2C0909.2783%2C0909.5164%2C0909.4379%2C0909.3865%2C0909.1091%2C0909.1797%2C0909.5240%2C0909.3222%2C0909.3763%2C0909.1658%2C0909.2270%2C0909.3838%2C0909.0992%2C0909.4515%2C0909.0208%2C0909.0277%2C0909.1500%2C0909.1529%2C0909.3730%2C0909.1212%2C0909.5372%2C0909.2641%2C0909.1355%2C0909.5638%2C0909.4403%2C0909.3067%2C0909.0634%2C0909.0370%2C0909.3932%2C0909.3393%2C0909.5557%2C0909.1833%2C0909.3203%2C0909.4452&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The recent fabrication of graphene nanoribbon (GNR) field-effect transistors\nposes a challenge for first-principles modeling of carbon nanoelectronics due\nto many thousand atoms present in the device. The state of the art quantum\ntransport algorithms, based on the nonequilibrium Green function formalism\ncombined with the density functional theory (NEGF-DFT), were originally\ndeveloped to calculate self-consistent electron density in equilibrium and at\nfinite bias voltage (as a prerequisite to obtain conductance or current-voltage\ncharacteristics, respectively) for small molecules attached to metallic\nelectrodes where only a few hundred atoms are typically simulated. Here we\nintroduce combination of two numerically efficient algorithms which make it\npossible to extend the NEGF-DFT framework to device simulations involving large\nnumber of atoms. We illustrate fusion of these two algorithms into the\nNEGF-DFT-type code by computing charge transfer, charge redistribution and\nconductance in zigzag-GNR/variable-width-armchair-GNR/zigzag-GNR two-terminal\ndevice covered with a gate electrode made of graphene layer as well. The total\nnumber of carbon and edge-passivating hydrogen atoms within the simulated\ncentral region of this device is ~7000. Our self-consistent modeling of the\ngate voltage effect suggests that rather large gate voltage might be required\nto shift the band gap of the proposed AGNR interconnect and switch the\ntransport from insulating into the regime of a single open conducting channel."}, "authors": ["Denis A. Areshkin", "Branislav K. Nikolic"], "author_detail": {"name": "Branislav K. Nikolic"}, "author": "Branislav K. Nikolic", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevB.81.155450", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0909.4568v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0909.4568v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "19 pages, 8 PDF figures, PDFLaTeX", "arxiv_primary_category": {"term": "cond-mat.mes-hall", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.mes-hall", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0909.4568v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0909.4568v1", "journal_reference": "Phys. Rev. B 81, 155450 (2010).", "doi": "10.1103/PhysRevB.81.155450", "fulltext": "Electron density and transport in top-gated graphene nanoribbon devices: First\nprinciples Green function algorithms for systems containing large number of atoms\nDenis A. Areshkin and Branislav K. Nikoli\u0107\n\narXiv:0909.4568v1 [cond-mat.mes-hall] 24 Sep 2009\n\nDepartment of Physics and Astronomy, University of Delaware, Newark, DE 19716-2570, USA\nThe recent fabrication of graphene nanoribbon (GNR) field-effect transistors poses a challenge\nfor first-principles modeling of carbon nanoelectronics due to many thousand atoms present in the\ndevice. The state of the art quantum transport algorithms, based on the nonequilibrium Green function formalism combined with the density functional theory (NEGF-DFT), were originally developed\nto calculate self-consistent electron density in equilibrium and at finite bias voltage (as a prerequisite to obtain conductance or current-voltage characteristics, respectively) for small molecules\nattached to metallic electrodes where only a few hundred atoms are typically simulated. Here we\nintroduce combination of two numerically efficient algorithms which make it possible to extend the\nNEGF-DFT framework to device simulations involving large number of atoms. Our first algorithm\noffers an alternative to the usual evaluation of the equilibrium part of electron density via numerical\ncontour integration of the retarded Green function in the upper complex half-plane. It is based on\nthe replacement of the Fermi function f (E) with an analytic function f \u0303(E) coinciding with f (E)\ninside the integration range along the real axis, but decaying exponentially in the upper complex\nhalf-plane. Although f \u0303(E) has infinite number of poles, whose positions and residues are determined analytically, only a finite number of those poles have non-negligible residues. We also discuss\nhow this algorithm can be extended to compute the nonequilibrium contribution to electron density,\nthereby evading cumbersome real-axis integration (within the bias voltage window) of NEGFs which\nis very difficult to converge for systems with large number of atoms while maintaining current conservation. Our second algorithm combines the recursive formulas with the geometrical partitioning\nof an arbitrary multi-terminal device into non-uniform segments in order to reduce the computational complexity of the retarded Green function computation by evaluating only its submatrices\nrequired for electron density or transmission function. We illustrate fusion of these two algorithms\ninto the NEGF-DFT-type code by computing charge transfer, charge redistribution and conductance in zigzag-GNR|variable-width-armchair-GNR|zigzag-GNR two-terminal device covered with\na gate electrode made of graphene layer as well. The total number of carbon and edge-passivating\nhydrogen atoms within the simulated central region of this device is ' 7000. Our self-consistent\nmodeling of the gate voltage effect suggests that rather large gate voltage ' 3 eV might be required\nto shift the band gap of the proposed AGNR interconnect and switch the transport from insulating\ninto the regime of a single open conducting channel.\nPACS numbers: 73.63.-b, 71.15.-m, 85.35.-p, 81.05.Uw\n\nI.\n\nINTRODUCTION\n\nThe recent discovery of graphene1 -a single layer of\ngraphite representing first truly two-dimensional crystal2 -has opened new avenues for carbon nanoelectronics.3,4 The limits on continued scaling of present siliconbased electronics are set by the fundamental physical effects5 (such as quantum tunneling of carriers through the\ngate insulator and through the body-to-drain junction;\ndependence of the subthreshold behavior on temperature;\nand discrete doping effects), the most detrimental being\npower dissipated in various leakage mechanisms. This\nis especially dangerous for minimal field-effect transistor\n(FET) dimensions and oxide thicknesses. Following the\ndiscovery of carbon nanotubes (CNTs), which are rolled\nup sheets of graphene, the exploration of carbon nanoelectronics over the past decade as a strong contender to\naging silicon technology has been centered around semiconducting CNTs as the new type of channel for FET\nthat also makes possible unconventional transistor designs.3\nSingle-wall CNTs bring their unique features into na-\n\nnoelectronics arena, such as ballistic transport or diffusion with very long mean free paths, high mobility at\nroom temperature due to suppressed electron\u2013acousticphonon scattering, current carrying capacities of the order of 109 A/cm2 , and one of the largest known specific\nstiffness.3 However, full integration of CNTs into complex high-performance nanoelectronic devices has been\nthwarted by several unresolved issues, such as: (i) electronic inhomogeneity where random mixture of semiconducting and metallic CNT (due to uncontrolled distribution of diameters and chirality in current synthesis methods) degrade device performance; (ii) difficulty in aligning and patterning through standard lithography methods suitable for high-volume production because of CNTs\nnot being flat; and (iii) extreme sensitivity to minute\nchanges in their local chemical environment.6\nGraphene shares many of the features of CNT, offering large critical current densities7 and intrinsic mobility\nlimit ' 2\u00d7105 cm2 /Vs at room temperature being higher\nthan any of the known inorganic semiconductors.8 Such\nhigh mobility promises near-ballistic transport and ultrafast switching. Thus, from its inception,7 application of\n\n\f2\ngraphene in FET devices has been a major experimental\nendeavor.9,10\nHowever, all graphene-FETs fabricated with wide\nsheets9,10 have poor ratio of on-state current Ion to\noff-state current Ioff due to the bulk graphene samples\nbehaving as a zero gap semiconductor. Nevertheless,\nrecent breakthrough fabrication (via chemical derivation,11 STM tip drawing12 and CNT unrolling13,14 ) of\nsub-10-nm-wide graphene nanoribbons (GNRs), all of\nwhich are semiconducting, has led to the development\nof GNRFETs15 with Ion /Ioff ratio up to 106 which is\nsuitable for logic devices.\nMoreover, unusual band structure of graphene has generated a plethora of proposals to create devices that have\nno analog in silicon-based electronics. The new functionality brought by the GNR electronic structure,16 such\nas \"valley valves\"17 or difference in transmission properties of reflectionless 120\u25e6 and highly reflective 60\u25e6 turns\nmade of GNRs with zigzag edges,18 can only be captured\nby quantum transport analysis. At the same time, equilibrium interatomic charge transfer and chemical doping by different atoms19,20,21 or atomic groups22 that\npassivate GNR edges require to model explicitly atomistic structure and corresponding charge density within\nthe device. These tasks are beyond the scope of popular tight-binding models17,23,24 (projected onto the basis\nof single pz -orbital per carbon atom), or even simpler\ncontinuous Weyl Hamiltonian describing massless Dirac\nfermions as low-energy quasiparticles close to the charge\nneutrality point.2 Furthermore, in the nonequilibrium\nstate driven by the finite bias voltage one has to compute self-consistently charge redistribution and the corresponding electric potential in order to keep the gauge\ninvariance25 of the I-V characteristics26 intact.\nFinally, virtually every experiment on graphene employees gate electrodes to move the Fermi level away from\nthe charge neutrality point or shift conduction from elec-\n\n1\n\u03c1=\u2212\n\u03c0\n\ntron to hole carriers, so that self-consistent computation\nof the inhomogeneous charge distribution27,28,29 induced\nby the gate voltage and its highly non-trivial effects on\nthe band structure of GNRs27,29,30 is necessary to understand device performance (rather than using unrealistic constant shift of the on-site potential to simulate\nthe presence of the gate electrode in the tight-binding\nmodels17 ).\nThus, the prime candidate capable of handling\nall of these issues within a unified quantum transport framework31,32 is the nonequilibrium Green function (NEGF) formalism33 combined with the density\nfunctional theory (DFT) in standard approximation\nschemes34 (such as LDA, GGA, or B3LYP) for its\nexchange-correlation potential. The sophisticated algorithms35,36,37,38,39,40,41,42,43,44 developed to implement\nthe NEGF-DFT framework over the past decade can be\nencapsulated by the iterative self-consistent loop:33\nnin (r) \u21d2 DFT \u2192 HKS [n(r)] \u21d2 NEGF \u2192 nout (r). (1)\nThe loop starts from the initial input electron density nin (r) \u21d2 employs some standard DFT code34\n(typically in the basis set of finite-range orbitals\nfor the valence electrons which allows for faster\nnumerics and unambiguous partitioning of the system into \"central region\" and the semi-infinite\nideal leads) to get the single particle Kohn-Sham\nHamiltonian\nHKS [n(r)] = \u2212~2 \u22072 /2m + V eff (r)\neff\n[V (r) = VH (r) + Vxc (r) + Vext (r) is the DFT meanfield potential due to other electrons with VH (r) being\nthe Hartree and Vxc (r) the exchange-correlation contribution; Vext (r) is the external potential] \u21d2 inversion\nof HKS [n(r)] yields the retarded Green function Gr (E)\nwhose integration over energy determines the density\nmatrix via NEGF-based formula:\n\n+\u221e\n+\u221e\nZ\nZ\n1\nr\ndE Im [G (E)]f (E \u2212 \u03bcR ) \u2212\ndE Gr (E) * Im [\u03a3L (E)] * Ga (E) [f (E \u2212 \u03bcL ) \u2212 f (E \u2212 \u03bcR )] = \u03c1eq + \u03c1neq .\n\u03c0\n\u2212\u221e\n\n\u2212\u221e\n\n(2)\nThe matrix elements n(r) = hr|\u03c1|ri are the new electron density as the starting point of the next iteration.\nThis procedure is repeated until the convergence criterion\n||\u03c1out \u2212 \u03c1in || < \u03b4 is reached, where \u03b4 \u001c 1 is a tolerance\nparameter.\nThe representation of the retarded Green function in\nthe local orbital basis requires to compute the inverse\nmatrix\nGr (E) = [E \u2212 HKS [n(r)] \u2212 \u03a3(E)]\u22121 .\n\n(3)\n\nThe advanced Green function matrix is defined as\n\nGa (E) = [Gr (E)]\u2020 .\nThe non-Hermitian matrix\n\u03a3(E) = \u03a3L (E) + \u03a3R (E) is the sum of the retarded selfenergy matrices introduced by the \"interaction\" with\nthe left [\u03a3L (E)] and the right [\u03a3R (E)] leads. These\nself-energies determine escape rates of electrons from\nthe central region into the semi-infinite ideal leads,\nso that an open quantum system can be viewed as\nbeing described by the (non-Hermitian) Hamiltonian\nHopen = HKS [n(r)] + \u03a3(E).\nThe NEGF post-processing of the converged result of\nDFT calculations makes it possible to obtain the current\n\n\f3\nthrough a two-terminal device in terms of the Landauertype formula33\n\nI(Vds ) =\n\n2e\nh\n\n+\u221e\nZ\ndE T (E, Vds )[f (E \u2212 \u03bcL ) \u2212 f (E \u2212 \u03bcR )].\n\u2212\u221e\n\n(4)\nThis integrates the self-consistent transmission function\n\b\nT (E, Vds ) = Tr \u0393R (E, Vds )GrS,1 \u0393L (E, Vds )Ga1S , (5)\nfor electrons injected at energy E to propagate from the\nleft to the right electrode under the source-drain applied\nbias voltage \u03bcL \u2212 \u03bcR = eVds . Here GrS,1 is the submatrix\nof Gr whose elements hS|\u011cr |1i connect orbitals in the\nfirst lead supercell (layer denoted as 1) of the extended\ncentral region \"sample + portion of the electrodes\" to the\nlast lead supercell (layer denoted as S) of the simulated\nregion.\nThe matrices \u0393L,R (E) = i[\u03a3L,R (E) \u2212 \u03a3\u2020L,R (E)] =\n\u22122Im \u03a3L,R (E) account for the level broadening due to\nthe coupling to the leads.33 A usual assumption about\nthe leads is that the effect of the bias voltage can be\ntaken into account by a rigid shift of their electronic\nstructure, so that \u03a3L,R (E, Vds ) = \u03a3L,R (E \u2213 eVds /2, 0)\nand \u0393L,R (E, Vds ) = \u0393L,R (E \u2213 eVds /2, 0) are computed\nin equilibrium and then the shift \u00b1eVds /2 is applied to\ntheir electronic structure to mimic the applied bias. The\nenergy window for the integral in Eq. (4) is defined by\nthe difference of Fermi functions f (E \u2212 \u03bcL ) \u2212 f (E \u2212 \u03bcR )\nof macroscopic reservoirs into which semi-infinite ideal\nleads terminate. The formula (4) is valid only for\ncoherent transport, i.e., assuming absence of dephasing46 due electron-phonon or electron-electron interactions (beyond those captured by the mean-field treatment44,45 ).\nThus, the most demanding computational task of\nthe NEGF-DFT framework is the self-consistent evaluation of the density matrix \u03c1 whose different algorithmic steps have the following31 computational complexity47 in terms of the number of atoms N :48 (i) the\ncomputation nin (r) \u2192 V eff (r) of the effective potential\nfor HKS [n(r)] has complexity O(N log N ); (ii) the second step, V eff (r) \u2192 HKS [n(r)], has complexity O(N );\n(iii) usual computation of all elements of the retarded\nGreen function, HKS [n(r)] \u2192 Gr , requires O(N 3 ) operations; (iv) Gr \u2192 \u03c1 scales as O(N ); and (v) the final step \u03c1 \u2192 nout (r) also has complexity O(N ). Obviously, the bottleneck is set by the retarded Green\nfunction computation. Since NEGF-DFT computational\ncodes35,36,37,38,39,40,41,43 are developed and tested for\nsmall molecules attached to metallic electrodes (where\nthey are successful when coupling between the molecule\nand the electrodes is strong enough to diminish Coulomb\nblockade effects32 ), they typically evaluate all elements of\nGr by inverting through Eq. (3) the Hamiltonian of the\nextended molecule region. Because this has to be done\nrepeatedly through self-consistent loop (1), the number\n\nof atoms in the extended central region \"molecule + portion of the electrodes\" that can be simulated is limited\nto few hundreds. This bottleneck also prevents realistic\nmodeling of single or multiple49 gate electrodes-instead\nof an additional layer of atoms covering portion of the\ncentral region, one typically employs a uniform electric\nfield in the direction perpendicular to the transport.50,51\nA more subtle reason for the failure of conventionally\nimplemented NEGF-DFT codes when applied to systems\ncontaining large number of atoms is the integration in the\nsecond term \u03c1neq in Eq. (2) which must be performed\nalong the real axis since the integrand is not analytic\nanywhere in the complex plan. Although this integration is restricted by the Fermi functions to a segment of\nthe order of the applied bias voltage, a very fine integration grid must be used to capture locations of subband\nedges (introduced by semi-infinite leads) and broadened\nmolecule orbitals where sharp peaks in the integrand occur. This problem is exacerbated in devices containing large number of atoms where the increasing number\nof such sharp peaks-due to van Hove singularities in\nthe density of states of the leads or quasi-bound states\npresent when different contacts throughout the device are\nnot perfectly transparent-can make it virtually impossible to converge \u03c1neq .\nThe present approach in NEGF-DFT algorithms to\ndeal with this issue is to move the line of integration\nslightly into the complex plane. However, this effectively\nadds small imaginary part i\u03b7 to the Hamiltonian Hopen\nwhich, therefore, does not conserve current. For example, direct application of this procedure to experimental graphene devices, such as 100 nm long GNRFET of\nRef. 15, would lead to substantial difference between the\ntotal current in the left and the right leads. This issue\nis rarely discussed in the usual NEGF-DFT treatment of\ntransport through relatively short molecules where such\nviolation of current conservation is small.\nSome recent attempts to solve it, such as locating\nthe peaks due to quasibound states and patching the\nnon-equilibrium density matrix integral,52,53 cannot be\napplied to large systems with many such peaks. The\npeaks can be broadened by physical dephasing mechanisms due to electron-electron44,45 or electron-phonon interactions,46 but this drastically changes the NEGF-DFT\napproach by requiring additional and computationally\nvery expensive self-consistent loops to calculate extra\nself-energy functionals33,44,45 due to interactions within\nthe device for which the sparsity of the Hamiltonian matrix Hopen becomes irrelevant.\nRecent efforts49,52,53,54,55,56 to replace some of the\nalgorithms within the NEGF part of the NEGF-DFT\nscheme, such as unfavorable computational complexity\nof brute force matrix inversion54 or the real-axis integration52,53 in \u03c1neq , have still not led to self-consistent\nelectron density and transport calculations for systems\ncomposed of more than about a thousand of atoms.49\nHere we introduce modified NEGF-DFT scheme which\nis based on our novel algorithm for the integrations in\n\n\f4\nEq. (2) combined with the partitioning the nanostructure\nof arbitrary shape into slices containing much smaller\nnumber of atoms. The Green function matrices of these\nslices, needed to obtain the electron density within the\nslice, are computed recursively with much more favorable computational complexity than O(N 3 ). The number of iteration steps within the self-consistent loop is\nfurther reduced, in the case of nanodevices in equilibrium or in quasi-equilibrium situations (e.g., due to by\nnon-zero gate voltage and zero or linear response bias\nvoltage), via modified Broyden mixing scheme for input\nand output charge density. We demonstrate the capability of our computational code, termed CANNES (carbon nanoelectronics simulator), to treat multi-terminal\nstructures containing large number of atoms by computing the self-consistent electron density and conductance\nin the presence of the gate voltage in a graphene nanodevice whose extended central region is composed of ' 7000\ncarbon and hydrogen atoms.\n\nThe paper is organized as follows. Sec. II elaborates\non the \"pole summation\" algorithm for computing integrals in \u03c1. In Sec. III we demonstrate efficiency of\nour approach by setting up a three-terminal FET-type\ndevice whose source and drain electrodes are made of\nzigzag graphene nanoribbon (ZGNR) source and drain\nelectrodes while its channel is an armchair GNR (AGNR)\nof variable width and with sizable energy gap. The third\nelectrode is gate modeled as a rectangularly-shaped layer\nof carbon atoms covering the FET channel. The dangling\nbonds of all graphene layers are terminated by hydrogen\natoms. The DFT part of the calculation is carried out\nusing the self-consistent environment-dependent tightbinding model (SC-EDTB) with four orbitals per carbon\natom and one orbital per hydrogen atom, which is specifically tailored to simulate eigenvalue spectra, electron\ndensities and Coulomb potential distributions for carbonhydrogen nanostructures.57,58 The combination of \"pole\nsummation\" algorithm with the recursive Green function\nformulas allows us to compute in Sec. III intricate electric\npotential distribution in the space around ZGNR-AGNRZGNR FET device, as well as to demonstrate how much\nvoltage has to be applied on the gate electrode to push\nthe device from the off-state due to the gap of AGNR into\nan on-state enabled by a single transport channel crossing\nthe Fermi level. The computed source-drain conductance\nas a function of the gate voltage also demonstrates that\neven at zero gate voltage there is a difference between\nthe non-self-consistent and self-consistent conductance,\nwhere the latter takes into account charge transfer between different atomic species or different segments of\nthe device. We conclude in Sec. IV.\n\nII.\n\nSELF-CONSISTENT ALGORITHMS FOR\nELECTRON DENSITY\n\nWe rewrite the equilibrium contribution to the density\nmatrix (2):\n1\n\u03c1eq (\u03bc, T ) = \u2212\n\u03c0\n\n+\u221e\nZ\n\ndE Im [Gr (E)]f (\u03bc, T, E),\n\n(6)\n\nEmin\n\nin the form which emphasizes its dependence on the\nchemical potential \u03bc and temperature T , as well as that\nthe lower limit of integration is the lowest energy at which\nIm [Gr (Emin )] 6= 0. As long as the end-point Emin is selected36,43 below the bottom of the valence band edge,\nthere are no further poles in the integrand, and thus the\nexpression is exact. Although this looks obvious, it is\nimportant to point out that if the value |Emin | is too\nsmall, and there are poles left outside of the contour,\nthe corresponding poles will not be included in the integration. This causes charge to erroneously disappear\nfrom the system, which typically initiates an avalanche\neffect, pushing the poles even further out, and even more\ncharge is lost, until the system is totally void of electrons.\nWhen this occurs, the calculation will actually converge\ntrivially, but to a physically incorrect solution.\nSince diagonal matrix elements of Gr (E) are a rapidly\nvarying function of energy, a direct integration along\nthe real axis would be rather ineffective since its numerical accuracy is not sufficient to achieve convergence\nof the self-consistent electron density. Instead, present\nNEGF-DFT computational codes35,36,43 deform the integration contour into the upper complex half-plane\nIm [E] > 0, where the retarded Green function is much\nsmoother. This is allowed since Gr (E) is analytic in the\nupper complex half-plane (all of its poles are slightly displaced below the real axis).\nThe thick white line in Fig. 1 designates typically chosen35,36,39,43 integration contour. It consists of a semicircular part SC and a horizontal line L parallel to the\nreal axis on the right which is positioned to enclose specific number Npoles of the Fermi function poles z (n) while\nensuring that SC and L are sufficiently far away from\nthe real axis so that the Green function is smooth over\nboth of these two segments [the main variation of the integrand on L comes from the Fermi function f (E) which,\ntherefore, can be used as a weight function in the quadrature36,43 ]. The final expression for \u03c1eq obtained in this\nprocedure (using the Cauchy residue theorem for the\nclosed contour SC + L + vertical segment from L to\nthe real axis + portion of the real axis) is:\n\uf8ee\nZ\n1\n\uf8f0\n\u03c1eq = \u2212 Im\ndE Gr (E)f (\u03bc, T, E)\n\u03c0\nSC+L\n\uf8f9\nNpoles\nX\n\u2212 2\u03c0ikB T\nGr (z (n) )\uf8fb ,\n(7)\nn\n\n\f5\n\nFIG. 1: (Color online) The density plot of the absolute value of f \u0303(E) in the upper complex half-plane. Lighter color denotes\ngreater value of | f \u0303 |. Solid black corresponds to zero, while gray color inside the dotted rectangle represents unity. White\ndots denote the poles with their size being roughly proportional to the absolute value of the residue. Poles running along AB,\n(n)\n(n)\nBC, and CD edges of the rectangle correspond to z (n) , z\u0303Im , and z\u0303Re , respectively. Thick white curve denotes the integration\n36,43\ncontour traditionally used in NEGF-DFT computational codes.\nTop insets are 3D plots of Re [f \u0303] and Im [f \u0303] in the upper\ncomplex half-plane.\n\nwhere the smoothness of Gr (E) on SC + L contour is\nexploited to perform the approximate integration in the\nfirst term by using a quadrature with a small number of\npoints.36,43\nObviously, it would be advantageous to compute integral in Eq. (6) precisely and without worrying about\nproper selection of parameters for positioning SC and\nL, via a simple summation over a finite set of complex\nenergies akin to the second term of Eq. (7). Here we\nintroduce such an algorithm which makes possible virtually exact evaluation of \u03c1eq by \"pole summation.\" This\nalgorithm is discussed separately for high temperatures\n(and/or valence electrons) in Sec. II A and low temperatures (and/or core electrons) in Sec. II B.\n\nA.\n\nHigh temperature and/or valence electrons\n\nThe algorithm for equilibrium density matrix computation discussed in this Section can be used when the\ninequality\n(\u03bc \u2212 Emin )/kB T . 103 ,\n\n(8)\n\nis satisfied. If Eq. (8) is not satisfied, a slightly more\nelaborate algorithm described in the next Sec. II B is\nneeded. Let us define the desired precision through the\nnon-negative number p, such that the magnitude of the\nrelative error is \u03b4 \u2264 e\u2212p . In most cases the machine precision roughly corresponds to p = 30, while the practical\nrange of p is usually between 21 and 27.\nWe start by introducing a function f \u0303\nf \u0303(\u03bc, \u03bc\u0303Re , \u03bc\u0303Im , T, T\u0303Re , T\u0303Im , E) = f (i\u03bc\u0303Im , iT\u0303Im , E) \u00d7\n\u0010\n\u0011\nf (\u03bc, T, E) \u2212 f (\u03bc\u0303Re , \u2212T\u0303Re , E) ,\n(9)\nwhere all its arguments except E are limited to real domain and satisfy the following inequalities (kB is the\nBoltzmann constant and i2 = \u22121):\nT\u0303Re > 0, T\u0303Im > 0,\n\n(10a)\n\n\u03bc\u0303Re 6 Emin \u2212 pkB T\u0303Re ,\n\n(10b)\n\n\u03bc\u0303Im > pkB T\u0303Im .\n\n(10c)\n\nThe choice of parameters given by Eq. (10) guarantees\nthat for real E \u2265 Emin the function f \u0303 deviates from f by\n\n\f6\nno more than \u03b4. Therefore the replacement of f with f \u0303\nin the integrand of Eq. (6) will result in the relative error\nless than \u03b4. In the following we assume that p \u2265 21 so\nthat \u03b4 \u2264 10\u22129 .\nThus, for all practical purposes we can state that (all\narguments except E are omitted for brevity)\n\n\u03c1eq\n\n\uf8ee +\u221e\n\uf8f9\nZ\n1\n= \u2212 Im \uf8f0\ndE Gr (E)f \u0303(E)\uf8fb .\n\u03c0\n\nresidues:\n\u03c1eq\n\n(n)\n\nwhere the set {Zj } is comprised of only those {z\u0303Im },\n(n)\n{z (n) }, and {z\u0303Re } poles which satisfy\n\n(11)\n\n(n)\n\n(n)\n\n| f (\u03bc, T, z\u0303Im ) \u2212 f (\u03bc\u0303Re , \u2212T\u0303Re , z\u0303Im ) | \u2265 e\u2212p , (17a)\n\n\u2212\u221e\n\n| f (i\u03bc\u0303Im , iT\u0303Im , z (n) ) | \u2265 e\u2212p ,\n\nThe poles and residues of the first term in the product\non the right-hand side of Eq. (9) are given by\n(n)\nz\u0303Im\n\n\uf8ee\n\uf8f9\nNpole\nh\ni\nX\n1\n2\u03c0i Res f \u0303(z)\nGr (Zj )\uf8fb , (16)\n= \u2212 Im \uf8f0\n\u03c0\nz=Zj\nj=1\n\n= i\u03bc\u0303Im + \u03c0kB T\u0303Im (2n + 1),\n\nh\ni\nRes f (i\u03bc\u0303Im , iT\u0303Im , z)\n\n(n)\n\nz=z\u0303Im\n\n(12a)\n\n= \u2212ikB T\u0303Im . (12b)\n\nwhere n is an integer. Similarly, the poles and residues\nof f (\u03bc, T, E) in the second term are\nz (n) = \u03bc + \u03c0ikB T (2n + 1),\nRes [f (\u03bc, T, z)]z=z(n) = \u2212kB T,\n\n(13a)\n(13b)\n\nand for f (\u03bc\u0303Re , \u2212T\u0303Re , E) they are\n(n)\n\nz\u0303Re = \u03bc\u0303Re + \u03c0ikB T\u0303Re (2n + 1),\nh\ni\nRes f (\u03bc\u0303Re , \u2212T\u0303Re , z)\n= kB T\u0303Re .\n(n)\n\n(14a)\n(14b)\n\nz=z\u0303Re\n\nInequalities (10) provide sufficient freedom to prevent\n(m)\n(n)\nthe coincidence of the poles z (j) , z\u0303Im , and z\u0303Re (\u2200 j, m,\nand n). Thus, f \u0303 only has first order poles with residues\ngiven by:\nh\ni\n= \u2212ik T\u0303Im \u00d7\nRes f \u0303(z)\n(n)\nz=z\u0303Im\n\u0011\n\u0010\n(n)\n(n)\n(15a)\nf (\u03bc, T, z\u0303Im ) \u2212 f (\u03bc\u0303Re , \u2212T\u0303Re , z\u0303Im ) ,\nh\ni\nRes f \u0303(z)\n= \u2212kB T f (i\u03bc\u0303Im , iT\u0303Im , z (n) ) , (15b)\nz=z (n)\nh\ni\n(n)\nRes f \u0303(z)\n= \u2212kB T f (i\u03bc\u0303Im , iT\u0303Im , z\u0303Re ) . (15c)\n(n)\nz=z\u0303Re\n\nIn the upper complex half-plane the residues (15a) decay\n(n)\nexponentially if Re(z\u0303Im ) lies outside the interval [\u03bc\u0303Re , \u03bc],\nand the residues (15b), (15c) decay exponentially if the\n(n)\nimaginary component of the poles z (n) or z\u0303Re exceeds\n\u03bc\u0303Im . Thus, for any given p only the limited number of\npoles {Zj }, j \u2208 {1, Npole } have non-negligible residues.\nIf one replaces the real axis integration in Eq. (11)\nby the integration along the semi-circular contour of the\nsufficiently large radius in the upper complex half-plane,\nthe contour contribution to the integral is zero, and the\ncontribution from the poles is solely from {Zj }. The\nintegral (11) is computed as the sum over all non-zero\n\n|\n\n(n)\nf (i\u03bc\u0303Im , iT\u0303Im , z\u0303Re )\n\n| \u2265e\n\n\u2212p\n\n,\n\n(17b)\n(17c)\n\nrespectively, in order to keep the relative error below e\u2212p .\nFor values of Emin and T obeying the inequality (8)\nand 21 \u2264 p \u2264 30 the number of relevant poles Npole is\nmoderate. For example, it is safe to chose Emin = \u221227 eV\nfor valence electrons in a hydro-carbon system (note that\nthis value for Emin is measured from the vacuum level).\nThen, at room temperature the ratio (8) is around 700,\nand for p = 21 the minimal number of required poles for\nparameters satisfying Eq. (10) equals 76. Decreasing p\ndown to machine precision raises the minimal number of\npoles to 96.\nFigure 1 shows the density plot of f \u0303 corresponding\nto p = 21 and Emin = \u221227 eV used to compute selfconsistent electron within the graphene nanodevice example of Sec. III. The minimal number of poles Npole is\nobtained as follows. We consider T\u0303Im and T\u0303Re as free parameters, and the minimum allowed \u03bc\u0303Re and \u03bc\u0303Im are obtained from equalities in constraints imposed by Eq. (10).\nThen, the number of poles z (n) is approximately twice the\nvalue of \u03bc\u0303Im divided by the inter-pole distance\nNAB =\n\n2\u03bc\u0303Im\n,\n2\u03c0kB T\n\n(18)\n\nand the approximate numbers of poles along the lines CB\nand DC in Fig. 1 are\n\u03bc \u2212 \u03bc\u0303Re + pkB T\u0303Re + pkB T\n,\n2\u03c0kB T\u0303Im\n2\u03bc\u0303Im\n,\n=\n2\u03c0kB T\u0303Re\n\nNCB =\n\n(19a)\n\nNDC\n\n(19b)\n\nrespectively. The optimal values of T\u0303Im and T\u0303Re are obtained by minimizing Npole = NAB + NCD + NDC in the\nspace of these two parameters. A small T\u0303Re and \u03bc\u0303Im adjustment, subject to constraints (10), is made afterwards\nto place the line CD right in between the two poles on\nlines AB and DC (cf. Figs. 1 and 2). This is done to\nensure that the poles are not too close to each other,\notherwise a large numerical errors may occur.\nB.\n\nLow temperature and/or full core simulations\n\nThe minimum number of poles Npole is scaled by the\ntemperature and the energy interval \u03bc \u2212 \u03bc\u0303Re . In order to\n\n\fHaL\n\nIm@ED HeV L\n\n7\n\nNumber of Poles: 185\n\nHbL\n\nIm@ED HeV L\n\nD2\n\nNumber of Poles: 121\n\nHcL\n\nIm@ED HeV L\n\nD1\n\nNumber of Poles: 117\n\n-25\n\n-20\n\n-15\n\n-10\n\n-5\n\n0\n\nRe@ED HeV L\n\nFIG. 2: (Color online) The poles with non-zero residues for the same system shown in Fig. 1 but at kB T = 0.003 eV: (a) poles\nof f \u0303; (b) poles of F\u0303 (2) ; and (c) poles of F\u0303 (3) . Circular zoomed-out regions depict dense pole arrangement at energies close to\nthe chemical potential \u03bc.\n\nreduce Npole , it is desirable to have as large spacing be(n)\ntween the poles z\u0303Im as possible. According to Eq. (10c),\nincreasing T\u0303Im for the given p means the increase of \u03bc\u0303Im .\nThe increase of \u03bc\u0303Im in turn increases the length of the\nsegment AB, and hence the number of poles z (n) to be\nsummed. On the other hand, reducing the number of\nz (n) (i.e., decreasing |AB|=\u03bc\u0303Im ), will bring the line CD\ncloser to the real axis, so to prevent deviation of f \u0303 from\nunity on the real axis requires to decrease T\u0303Im . The latter\n(n)\nincreases the number of poles z\u0303Im along the line CD.\nThe simple solution to this problem is to break the\ninterval between \u03bc\u0303Re and \u03bc into several sub-intervals,\nand apply the scheme presented in Sec. II A to each subinterval. For example, if the original interval is split into\ntwo sub-intervals, the substitution for f \u0303 is\nF\u0303 (2) (\u03bc, \u03bc\u0303Re1,2 , \u03bc\u0303Im1,2 , T, T\u0303Re1,2 , T\u0303Im1,2 , E) =\nf \u0303(\u03bc, \u03bc\u0303Re , \u03bc\u0303Im , T, T\u0303Re , T\u0303Im , E) +\n1\n\n1\n\n1\n\nC.\n\n1\n\nf \u0303(\u03bc\u0303Re1 , \u03bc\u0303Re2 , \u03bc\u0303Im2 , T\u0303Re1 , T\u0303Re2 , T\u0303Im2 , E),\n\nEq. (20). The poles running along the line D1 D2 are the\nsame for the first and second term in Eq. (20).\nThe minimization of the total number of poles Npole\nis performed analogously to Eqs. (18) and (19). For F\u0303 (2)\nthe optimization parameters are T\u0303Re1 , T\u0303Re2 , T\u0303Im1 , and\nT\u0303Im1 . The starting point for the conjugate gradient minimization is T\u0303Re1 = 10 \u00d7 T and \u03bc\u0303Im2 = 10 \u00d7 \u03bc\u0303Im1 , so that\nthe optimized parameters fit this order of magnitude relationship. Indeed, the size of the integration intervals in\nFig. 2(b) and 2(c) increases by an order of magnitude\nfrom right to left. For this reason Npole grows logarithmically with increasing ratio (\u03bc \u2212 Emin )/kB T . That is,\ndepending on p, approximately 30 to 40 extra poles are\nrequired for each decade of this ratio increase (i.e., per\norder of magnitude in temperature reduction).\nApproximate real axis integration of\nnon-analytic functions\n\n(20)\n\nwhere T < T\u0303Re1 < T\u0303Re2 ;\n\u03bc\u0303Re2 < \u03bc\u0303Re1 < \u03bc;\nand\n\u03bc\u0303Im1 < \u03bc\u0303Im2 . The parameters \u03bc\u0303Re1,2 , \u03bc\u0303Im1,2 , T\u0303Re1,2 ,\nand T\u0303Im1,2 ensure the required precision by satisfying\nthe constraints similar to Eq. (10):\n\u03bc\u0303Re2 6 Emin \u2212 pkB T\u0303Re2 ,\n\n(21a)\n\n\u03bc\u0303Im1 > pkB T\u0303Im1 , \u03bc\u0303Im2 > pkB T\u0303Im2 .\n\n(21b)\n\nFigure 2(b) illustrates these concepts. Poles forming the\nleft (smaller) and the right (bigger) rectangles are associated respectively with the first and the second term in\n\nThe concepts presented in Sec. II A allow for efficient\nand exact evaluation of the Gr (E) moments in the interval bounded by two Fermi functions. This property can\nbe used for systematic approximation of Ga (E) with the\nfunction G\u0303a (E) such that G\u0303a (E) \u2248 Ga (E) on the real\naxis, and which is analytic in the upper complex halfplane. This approximation can be used to transform the\nnon-analytic integrands to analytic functions.\nAn obvious applications of this idea to NEGF-DFT\nframework would be the computation of nonequilibrium\ncontribution \u03c1neq to the density matrix in Eq. (2). Be-\n\n\f8\n\n\u03bc0 = \u03bcR , \u03bcM = \u03bcL , \u03bcm = \u03bcR + m\u2206\u03bc,\n\n(22)\n\nwhere we assume for simplicity that \u2206\u03bc = 2kB T . Then\n\u03c1neq in Eq. (2) can be rewritten as\n\u03c1neq\n\n+\u221e\nM Z\nX\n=\ndE Gr (E) * Im [\u03a3(E)] * Ga (E) \u00d7\n\nIm@ED\n\n\u039cm-1\n\n\u039em\n\n\u008e\n\u039cIm\n\n\u039cm\n2\u03a0kT\n\ncause the functions Gr (E) and Ga (E) in the integrand\nof \u03c1neq are non-analytic below and above the real axis,\nrespectively, the integrand is non-analytic function in the\nentire complex energy plane. Thus, no integration contour deformation akin to Fig. 1 can be exploited to avoid\ndirect integration along the real axis to obtain \u03c1neq . On\nthe other hand, such direct integration along the real axis\nis computationally expensive due to the need for very fine\nintegration grids.52,53 As discussed in Sec. I, integration\nmay not even converge when the integrand becomes too\nspiky with numerous closely spaced sharp peaks for devices containing large number of atoms.\nLet us divide the interval [\u03bcR , \u03bcL ] into M subintervals\nof equal size \u2206\u03bc\n\nRe@ED\n\n\u03a0kT\nFIG. 3:\n(Color online) Poles of the function\nf \u0303(\u03bcm , \u03bcm\u22121 , \u03bc\u0303Im , T, T, T\u0303Im , z) used to evaluate the integral in Eq. (26). For a chosen precision set by p = 23, the\ncontribution from 28 poles has to be summed. Three poles\nof f (\u03bcm , T, z) are marked with the red empty circles. The\nvalues of the retarded Green function at most of the poles\n(d)\nshown are reused to compute matrices Mn in Eq. (25) for\nn 6= m, so that the average number of Green functions to be\ncomputed per interval equals 3.\n\nm=1\u2212\u221e\n\n[f (\u03bcm , T, E) \u2212 f (\u03bcm\u22121 , T, E)] .\n\n(23)\n\nFor each interval [\u03bcm\u22121 , \u03bcm ] in the sum (23) we approximate Gr (E) by the power expansion with respect to the deviation from the center of the interval\n\u03bem = (\u03bcm\u22121 + \u03bcm )/2\nGrm (E) \u2248 G\u0303rm (E) =\n\nK\nX\n\n(\u03ba)\ngm\n\u00d7 (E \u2212 \u03bem )\u03ba ,\n\n(24)\n\n\u03ba=0\n(\u03ba)\n\nwhere gm are constant matrices. We require that the\n(d)\nmoments Mm up to order D for G\u0303rm and Grm coincide\nM(d)\nm\n\n+\u221e\nZ\n\u2261\ndE Gr (E)(E \u2212 \u03bem )d \u00d7\n\nFigure 3 shows the poles of f \u0303 from Eq. (26) for the case\np = 23, \u03bc\u0303Im = 3\u03c0kB T , and T\u0303Im = T /\u03c0. Even though the\nnumber of poles to be summed per every moment equals\n28, the number of points per integration interval \u2206\u03bc at\nwhich Gr (E) needs to be calculated is 3 because the values of Gr (E) at different poles are reused in computation\n(d)\nof the moments at different intervals. Thus, Mm is computed similarly to Eq. (16), with the only difference being\nthat Gr (Zj ) is now replaced by Gr (Zj )(Zj \u2212 \u03bem )d .\n(\u03ba)\n\nBecause matrices gm do not depend on energy, the\nintegrals in the second term of Eq. (25)\n\n\u2212\u221e\n\n[f (\u03bcm , T, E) \u2212 f (\u03bcm\u22121 , T, E)] =\n+\u221e\nZ\nK\nX\n(\u03ba)\ngm\n\u00d7 (E \u2212 \u03bem )\u03ba+d \u00d7\ndE\n\u2212\u221e\n\n\u03a5\u03ba\n\n+\u221e\nZ\n\u2261\ndE (E \u2212 \u03bem )\u03ba \u00d7\n\u2212\u221e\n\n[f (\u03bcm , T, E) \u2212 f (\u03bcm\u22121 , T, E)] ,\n\n\u03ba=0\n\n[f (\u03bcm , T, E) \u2212 f (\u03bcm\u22121 , T, E)] ,\n\n(27)\n\n(25)\n\nwhere d \u2282 [0, D].\nThe first integral in Eq. (25) can be computed accurately as\n+\u221e\nZ\ndE Gr (E)(E \u2212 \u03bem )d \u00d7\n\u2212\u221e\n\ncan be computed analytically. Here we provide example\nsolution of this problem for D = 2 (the solutions for\nD > 2 are similar to this). The integrals \u03a5\u03ba are non-zero\nwhen \u03ba is even integer. For example, assuming \u2206\u03bc =\n2kB T they are\n\u0001\n2\n(kB T )3 1 + \u03c0 2 ,\n3\n\u0001\n3 + 10\u03c0 2 + 7\u03c0 4 .\n\n\u03a50 = 2kB T, \u03a52 =\n\n[f (\u03bcm , T, E) \u2212 f (\u03bcm\u22121 , T, E)] =\n+\u221e\nZ\ndE Gr (E)(E \u2212 \u03bem )d \u00d7\n\n\u03a54 =\n\n2\n(kB T )5\n15\n\n(28)\n\n\u2212\u221e\n\nf \u0303(\u03bcm , \u03bcm\u22121 , \u03bc\u0303Im , T, T, T\u0303Im , E).\n\n(26)\n\n(\u03ba)\n\nThen, to satisfy Eq. (25) for d = 0, 1, 2, matrices gm\n\n\f9\nshould be chosen as\n(2)\n\n(0)\n\n(0)\ngm\n=\n\nM m \u03a52 \u2212 M m \u03a54\n,\n\u03a522 \u2212 \u03a50 \u03a54\n\n(1)\ngm\n=\n\nMm\n,\n\u03a52\n\n(2)\ngm\n=\n\nM m \u03a50 \u2212 M m \u03a52\n.\n\u2212\u03a522 \u2212 \u03a50 \u03a54\n\n(29a)\n\n(1)\n\n(29b)\n\n(2)\n\n(0)\n\n(29c)\n\nThe analytic continuation of G\u0303a (E) into the upper complex half-plane is simply\nG\u0303am (z) =\n\n2 h\nX\n\n(\u03ba)\ngm\n\ni\u2020\n\n\u00d7 (z \u2212 \u03bem )\u03ba .\n\n(30)\n\n\u03ba=0\n\nThen Eq. (23) becomes\n\u03c1neq =\n\nM\n\u0001\n1 X\n\u03a9m \u2212 \u03a9\u2020m ,\n2i m=1\n\n(31)\n\nwhere\n\u03a9m\n\n+\u221e\nZ\n=\ndE Gr (E) * \u03a3(E) * G\u0303a (E) \u00d7\n\u2212\u221e\n\n[f (\u03bcm , T, E) \u2212 f (\u03bcm\u22121 , T, E)] .\n\n(32)\n\nThe integrand in Eq. (32) is now analytic in the upperhalf plane and can be evaluated through our \"pole summation\" algorithm discussed in Sections II A and II B.\nThe algorithm presented in this Section is actually\nmore computationally expensive than the usually implemented36,39,43 real axis integration to get \u03c1neq since for\nevery interval one needs to compute the retarded Green\nfunction at three different points instead of one, as shown\nin Fig. 3. Nonetheless, the benefit of this approach\nis in systematic approximation by exact match of the\nGreen function moments which can evade insufficiently\nfine integration grid or, most importantly, uncontrolled\nusage36,42,43 of the real-axis infinitesimal Hopen + i\u03b7 that\nleads to serious current non-conservation in long devices\nbeyond molecular electronics scale. For example, a very\nlarge system poorly coupled to its contacts may have several sharp peaks within 10 meV interval. None of the\nadaptive real-axis integration methods52,53 can properly\naccount for these peaks if the integration step equals 10\nmeV, while the moments-matching algorithm has capability to capture the contribution from these peaks to the\nintegral.\nIII. EXAMPLE: FIRST-PRINCIPLES\nMODELING OF TOP-GATED GNR-BASED\nNANOELECTRONIC DEVICES\n\nFrom the very outset, the discovery of graphene\nhas been intimately connected to attempts to fabricate\n\ncarbon-based planar FETs.7 Since FETs produced using micron-size graphene sheets as channels have poor\nIon /Ioff . 10 ratio, the pursuit of FETs suitable for digital electronics applications has shifted toward fabrication of GNRs with large band gaps11 ' 0.4 eV. Their\nband gap can be engineered by transverse quantum confinement effects in the case of AGNR (where the gap\nis additionally affected by the increased hopping integral between the pz -orbitals on carbon atoms around\nthe armchair edge caused by slight changes in atomic\nbonding length in the presence of edge passivating hydrogen59 ) or by staggered sublattice potential arising\ndue to non-zero spin polarization around zigzag edges\nof ZGNR.26,59,60,61,62\nThe very recent experiments11,12,13,14,15 have demonstrated that all sub-10-nm-wide GNRs are semiconducting. Since band gaps due to edge magnetic ordering in\nZGNR are easily destroyed at room temperature,61 by\nfinite current under nonequilibrium bias voltage conditions,26 or by impurities and vacancies along the edge,62\nwe assume that AGNRs are essential ingredient to introduce sizable band gap in graphene nanodevices operating\nat room temperature, as confirmed also by recent tunneling spectroscopy.63\nThe fabricated GNRFETs thus far have utilized metallic source and drain electrodes where Schottky barrier\n(SB) is introduced at the contact between metallic electrode (typically Pd with high work function) and GNR,\nso that the current is modulated by carrier tunneling\nprobability through SB at contacts. On the other hand,\nplanar structure of graphene is envisaged to make possible all-graphene electronic circuits patterned from either\na single graphene plane or multiple planes separated by\nlayers of insulating material.18\nAny all-graphene circuit concept will require both active FETs and passive elements for wiring individual circuit elements. Although ZGNR can be expected to be\nmetallic at room temperature, the wiring based on them\nis nontrivial issue because only few specific ZGNR patterns have close to ideal conductance and can transmit\nelectron flux without losses.18 Furthermore, at finite bias\nvoltage ZGNRs can open a band gap if they are mirror\nsymmetric with respect to the midplane between the two\nzigzag edges.19\n\nA.\n\nThree-terminal device setup\n\nOur FET-type device setup, based on the combination\nof ZGNR source and drain metallic electrodes and semiconducting AGNR channel in between them, is shown\nin Fig. 4 The source and drain have different widths and\nare modeled as semi-infinite ideal ZGNRs leads. The size\nof the AGNR band gap is an oscillating function of the\nribbon width. The width variation causing AGNR to\nswitch between small and large gaps equals to just a single C-C bond length, which was found to greatly affect\nthe transfer characteristics (current I vs. gate voltage\n\n\f10\n\nFIG. 4: (Color online) Graphical depiction of the atomic\nstructure of simulated nanodevice composed of two narrow\ngraphene layers. The lower graphene layer contains two\nunidirectional ZGNRs of different width, which act as the\nsource and drain metallic electrodes, sandwiching semiconducting AGNR of variable width as the FET channel. The\ntop graphene layer plays the role of a gate electrode, covering all of the AGNR channel region, and has the shape of a\nrectangle that is sufficiently large to have negligible band gap.\nThe interlayer distance is 3.35 \u00c5, which corresponds to the interlayer spacing in graphite.64 The hydrogen atoms (red dots)\npassivate edges of both layers, whose internal carbon atoms\n(blue) form defect free finite-size honeycomb lattice. Dark\nand light colored transverse segments, which have variable\nshape as one moves from the source to the drain electrode,\nare used to mark odd and even slices of the partitioned system. Each slice i = 1,. . . ,S is described by the Hamiltonian\nmatrix Hi,i , all of which are stored in computer memory together with matrices Hi,i+1 describing the coupling between\nadjacent slices i and i + 1.\n\nVgs at fixed source-drain bias Vds ) in the recent study24\nof several FET concepts with AGNR channel. Because\ncutting graphene with atomic precision in order to obtain\nuniform device performance is currently not an option,\nthe variable width AGNR seems to be the simplest realistic path toward making a short semiconducting fragment.\nAbove the semiconducting \"active region\" we place a\ngraphene rectangle, which is assumed to have no electrical contact with the ZGNR-AGNR-ZGNR structure\nbelow it. This may be achieved by placing boron-nitride\ninsulating layer in between.\nWe note that the recent analysis24 (using NEGF for\nsimple pz -orbital tight-binding model, which is selfconsistently coupled to a three-dimensional Poisson\nsolver for treating the electrostatics) of dual-gate Schottky barrier GNRFETs, with uniform width AGNR channels and several different types of graphene- or nongraphene-based source and drain electrodes, has singled\nout ZGNR-AGNR-ZGNR device concept as an optimal\none with high enough Ion /Ioff ratio and advantageous\n\nfeatures of ZGNR metallic contacts.\nThe usage of wide graphene sheets as the channel of\nFET is conceptually difficult because depending on the\nposition of the Fermi level graphene possesses either electron or hole conductivity making it impossible to produce\nregions depleted of mobile charge carriers. At the same\ntime, the concept of GNR devices allows to build both\nnormally-OFF and normally-ON transistors based solely\non the device geometries.17,18 One of the main benefits\nof graphene in nanoelectronics is its one-atom-thickness\nwhich leads to very low parasitic capacitance, and therefore allows terahertz cut-off frequencies for all-graphene\ndevices and circuits. So far both the experiments15 and\nquantum transport simulations23,24 have been focused\non GNRFETs whose channel is long and narrow semiconducting GNR attached to metallic source and drain\n(such as Pd) contacts while being controlled by metallic top-gate shifting the band gap. Although such transistors play an important role in studying GNR properties, they compromise the main purpose of nanoelectronic devices-the speed. The parasitic gate-substrate\nor gate-source (drain) capacitances27,29,30 for such hybrid\nmetal-graphene structure are orders of magnitude higher\nthan capacitance of the channel, and thus substantially\ndecrease the transistor speed. Exploring all-graphene nanoelectronic devices to reach the optimal speed limit is\none of the primary motivations for the design concept\nshown in Fig. 4.\n\nB.\n\nSystem partitioning and the recursive Green\nfunction algorithm\n\nThe retarded Green function matrix Gr (E), as the central NEGF quantity in phase-coherent transport regime\nwhich yields electron density through Eq. (2) and current\nvia Eq. (4), can be computed by direct matrix inversion in Eq. (3). However, the computational complexity\nO(N 3 ) of this operation makes it virtually impossible for\npresent NEGF-DFT codes (which typically perform this\nbrute force operation) to be applied to systems containing large number of atoms.31 Thus, first-principles simulation of transport in large systems can be accomplished\nonly if relevant elements of Gr (E) can be obtained via\nalgorithms that scale linearly with increasing length of assumed quasi-one-dimensional (Q1D) device geometry.31\nIn fact, since only a much smaller submatrix of Gr (E)\ndetermines transport properties given by Eq. (4), the recursive Green function algorithms65 (in serial or parallel\nimplementation66 ) have commonly been used to compute\nthe submatrix GrS,1 and obtain the transmission properties of mesoscopic devices.65 They are based on using\nthe Dyson equation, GrC = Gr0 + Gr0 VGrC , to build the\nGreen-function slice by slice, so that the dimensions of\nthe matrices that have to be inverted are strongly reduced (Gr0 is the Green function of some region of the\ndevice with one of the leads attached, V is the hopping\nmatrix between that region and adjacent slice, and GrC is\n\n\f11\nthe Green function of the coupled system lead + region\n+ slice).\nThis type of algorithms have also been extended54,67,68,69,70 to obtain other submatrices of Gr\nneeded to compute local quantities within the simulated\nregion, such as Gri,i or Gri,i+1 which define the electron\ndensity within slice i or spatial profile of local currents\nbetween slices i and i + 1, respectively. Although it is\noften considered55 that standard or extended recursive\nGreen function algorithms can be applied only to Q1D\ntwo-terminal devices, some alternative approaches which\ninvert smaller matrices than the full device Hamilto-\n\n\uf8eb\n\nHKS\n\nH1,1\n\nH1,2\n..\n.\n\n0\n\nnian Hopen to build the Green function of multi-terminal\nnanostructures of arbitrary geometrical shape have also\nbeen introduced recently.55,70\nThe key issue for a successful inclusion of the recursive Green function formulas into NEGF-DFT codes is\nnot the specific set of equations, which is very similar in\ndifferent approaches, but the ability to make a consistent\npartition of a system of arbitrary shape and with many\nattached electrodes into slices described by much smaller\nmatrices Hi,i . The full Hamiltonian matrix can then be\nwritten as\n\n0\n\n***\n\n0\n\n\uf8ec \u2020\n\uf8ecH\n***\n***\n***\n0\n\uf8ec 1,2\n\uf8ec .\n..\n\uf8ec .. H\n0\n***\n.\ni\u22121,i\u22121 Hi\u22121,i\n\uf8ec\n\uf8ec .\n..\n\u2020\n\uf8ec\n.\n=\uf8ec .\nHi\u22121,i\nHi,i\nHi,i+1\n***\n.\n\uf8ec .\n..\n\uf8ec .\n0\nH\u2020i,i+1 Hi+1,i+1\n***\n.\n\uf8ec .\n\uf8ec\n..\n\uf8ec\n.\n\uf8ed 0\n***\n***\n***\nHS\u22121,S\n0\n0\n0\n***\nH\u2020S\u22121,S HS,S\n\nsince due to the finite range of basis functions in the\ntransport direction the size of the slices can always be\nchosen so large that only neighboring ones are coupled\nthrough each other via the hopping matrices Hi,i+1 .\nAn example of the solution to this primarily geometrical problem is illustrated using the device setup in Fig. 4.\nOur algorithm here starts from the bitmap image of the\ndevice \u2192 converts the image into a finite-size honeycomb\nlattice \u2192 then attempts to partition the device within a\nloop until consistent set of slices is achieved across the\nwhole device. The final result-a set of slices of nonuniform shape (in contrast to typical columns of sites\northogonal to the axis of the device when recursive algorithm is applied to two-terminal Q1D devices of simple\nshape68,69 )-is shown in Fig. 4 as dark and light colored\nsegments of the honeycomb lattice.\nEach slice is described by a matrix Hi,i containing\nthe interactions between atoms within the layer i (i =\n1,. . . ,S). The size of the matrix Hi,i is Ni \u00d7 Ni , where\nNi is the total number of atomic orbitals for all atoms in\nthe slice i. These matrices are much smaller than H, and\n\n\uf8f6\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7.\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f8\n\n(33)\n\nare stored in memory at the beginning of the calculation\ntogether with matrices Hi,i+1 .\nStarting from the set of matrices Hi,i and Hi,i+1 , we\nimplement the simplest recursive Green function algorithm aimed at getting Gri,i from which we can compute\nthe density matrix \u03c1i of slice i by replacing Gr in Eq. (2)\nwith Gri,i . The retarded Green function Gri,i of each slices\nis given by:\ni,i\n\u22121\nGri,i (E) = [EIi,i \u2212 Hi,i \u2212 \u03a3i,i\n.\nL (E) \u2212 \u03a3R (E)]\n\n(34)\n\ni,i\nwhere \u03a3i,i\nL (E) and \u03a3R (E) are the self-energies due to the\nrest of the device on the left and on the right, respectively,\nattached to slice i (Ii,i is the unit matrix of the same size\nas Hi,i ).\nThe self-energies \u03a3i,i\nL (E) generated by the left side of\nthe device attached to slide i are computed through the\nrecursive formula which starts from the self-energy of the\nleft semi-infinite ideal electrode, \u03a3L (E \u2212 eUL ) = H\u20200,1 *\nr\ngL\n(E \u2212 eUL ) * H0,1 , and proceeds through\n\n\f12\n\n\u2020\n\u22121\n\u03a31,1\n* H1,2 ,\nL (E) = H1,2 * [EI1,1 \u2212 H1,1 \u2212 \u03a3L (E \u2212 eUL )]\n\n\u03a32,2\nL (E)\n\n=\n\nH\u20202,3\n\n* [EI2,2 \u2212 H2,2 \u2212\n\n\u22121\n\u03a31,1\nL (E)]\n\n(35a)\n\n* H2,3 ,\n\n(35b)\n\n..\n.\n. = ..\n\u03a3S\u22121,S\u22121\n(E)\nL\n\n=\n\nH\u2020S\u22121,S\n\n(35c)\n* [EIS\u22121,S\u22121 \u2212 HS\u22121,S\u22121 \u2212\n\nr\nHere gL\n(E) is portion of the retarded Green function\nof the isolated lead connecting atoms in the edge principal layer that is coupled to the extended central region via H0,1 . The same recursion starts from the right\nsemi-infinite ideal electrode to generate the self-energies\n\u03a3i,i\nR (E), where the self-energy of the right semi-infinite\nr\nideal electrode, \u03a3R (E \u2212 eUR ) = HS,S+1 * gR\n(E \u2212 eUR ) *\n\u2020\nHS,S+1 , and the Hamiltonian HS,S of the first slice S\non the right side of the extended central region are used\nto construct the starting equation of the recursion analogous to Eq. (35a).\nWe note here that the usual simplification in\nNEGF-DFT codes is to treat the extended central region\nout of equilibrium while electronic structure of the ideal\nsemi-infinite leads is computed in equilibrium, thereby\nignoring the self-consistent response of the leads to the\ncurrent. Although it has been pointed out71 that this approximation can be incompatible with asymptotic charge\nneutrality, this is rarely taken into account. Instead\nof assuming that the equilibrium band structure of the\nleads is rigidly shifted by the bias voltage \u2213eVds /2 applied between the macroscopic reservoirs to which they\nare attached, we use \u2213eUL,R satisfying eVds /2 \u2265 eUL >\neUR \u2265 \u2212eVds /2 as the shifts of the lead on-site energies, \u03a3L,R (E, Vds ) = \u03a3L,R (E \u2213 eUL,R , 0). Here the potential eUL,R is adjusted after each iteration within the\nself-consistency loop if the total charge on slices 1 and S\n(obtained from Tr \u03c11 and Tr \u03c1S respectively) is found to\ndeviate from the neutral state charge.\nAfter the self-consistency is reached, the transmission\nT (E, Vds ) in Eq. (4) is computed from the submatrix\nGrS,1 obtained recursively via the Dyson equation by\nstarting from the known retarded Green function Gr11\n(34) of the first slice on the left:\n\u22121\nGri,1 = [EIi,i \u2212 Hi,i \u2212 \u03a3i,i\n* H\u2020i\u22121,i * Gri\u22121,1 . (36)\nR (E)]\n\nThus, the computational complexity of the retarded\nGreen function evaluation is reduced from O(N 3 ) for the\n3\n3\nfull matrix inversion to 3N\u0304i (S \u2212 1) + N\u0304i S operations,\nwhere N\u0304i is the average number of atoms within the slice\ni. This means that the time required to obtain all relevant submatrices Gri,i and GrS,1 for the NEGF-DFT algorithm scales linearly O(S) with increasing the length\nof the device (i.e., the number of slices S).\nThe recursive Green function algorithm helps to resolve only one of the two key problems in the application\nof NEGF-DFT to large devices. The other one discussed\n\n\u03a3S\u22122,S\u22122\n(E)]\u22121\nL\n\n* HS\u22121,S .\n\n(35d)\n\nin Sec. I-numerous sharp peaks in the integrand of \u03c1neq\nthat render real axis integration non-convergent-can\nbe solved in principle by including the interactions44,45\nwithin the simulated region capable of washing out the\nquantum interference effects (that are, anyhow, seldom\nobserved in devices at room temperature). For example, the inclusion of electron-electron correlation effects\nwithin the GW approximation was demonstrated45 to\nbroaden or remove sharp features in the NEGFs for test\nsystems (such as a chain of gold atoms).\nIn the presence of such dephasing processes, one has\nto resort to the full NEGF formalism33 whose core quantities are the retarded Gr and the lesser G< Green\nfunction describing the density of available quantummechanical states and how electrons occupy those quantum states, respectively. Both Green functions can be\nobtained from the contour-ordered Green function defined for any two time values that lie along the KadanoffBaym-Keldysh time contour.33 In addition to the retarded \u03a3leads and the lesser \u03a3<\nleads self-energy due to\nattached electrodes, the full formalism requires to compute self-energy functionals due to many-body interactions within the sample, \u03a3int and \u03a3<\nint , while using conserving approximation44 for their expression in terms of\nGr and G< .\nIn the phase-coherent transport regime, \u03a3int = 0 and\n\u03a3<\nint = 0, so that the lesser self-energy of non-interacting\n(i.e., mean-field or Kohn-Sham) quasiparticles can be expressed solely in terms of the retarded self-energies of the\nleads\n\u03a3<\nleads (E) = if (E \u2212\u03bcL )\u0393L (E)+if (E \u2212\u03bcR )\u0393R (E). (37)\nThen the Keldysh equation\n<\na\nG< (E) = Gr (E) * [\u03a3<\nleads (E) + \u03a3int (E)] * G (E), (38)\n\nallows to eliminate G< as independent NEGF and express the corresponding density matrix\nZ\n1\n\u03c1=\ndE G< (E),\n(39)\n2\u03c0i\nusing only Gr (E) and \u03a3leads (E), as shown explicitly by\nEq. (2).\nOn the other hand, even the simplest phenomenological NEGF models of dephasing, such as\n\"momentum-conserving\" choice \u03a3int (E) = dGr (E) and\n<\n\u03a3<\nint (E) = dG (E) (d measures the dephasing strength)\n\n\f13\nproposed in Ref. 46, require to solve Eq. (3) and Eq. (38)\nas a system of coupled matrix equations involving full\nsize matrices in the Hilbert space of the simulated device region. For example, in the case of the dephasing\nmodel of Ref. 46, this means iterative solving of Eq. (3),\nwith Gr0 = [E \u2212 H \u2212 \u03a3rleads (E)]\u22121 as the initial guess,\nand then using converged Gr to solve Eq. (38) as the\nSylvester equation of matrix algebra. Obviously, in this\ncase the sparse nature of H-matrix in Eq. (33) and the\ncorresponding recursive Green function formulas become\nirrelevant for reducing the time it takes to obtain all\nrelevant NEGFs in a single step of the self-consistent\nloop (1).\nMore realistic description of interactions with the extended central region is far more computationally demanding.44,45 Thus, the only route toward first-principles\nmodeling of transport through large devices is to remain\nwithin the phase-coherent transport regime and develop\nalgorithms that can resolve problems in the convergence\nof integration in \u03c1neq along the real axis, as discussed in\nSec. II C or by Refs. 52,53.\n\nC.\n\nQuasi-Non-Equilibrium Model\n\nThe DFT part of our simulation, which constructs the\nHamiltonian of the central region as an input for NEGF\npost-processing to obtain the device transport properties, is performed by using the SC-EDTB model.57,58\nThis model accounts for atomic polarization and interatomic charge transfer in a standard DFT-like fashion\nwhile making it possible to use a minimal basis set of four\nGaussian orbitals per carbon and one orbital per hydrogen atom. The usage of such minimal basis set allows us\nto reduce the size of matrices Hi,i and Hi,i+1 discussed\nin Sec. III B without loosing any of the important aspects\nof ab initio input about carbon-hydrogen systems. This\nmakes SC-EDTB highly advantageous when treating systems with large number of atoms.\nConceptually, SC-EDTB can be viewed as the pseudopotential DFT scheme with each atom having its own\natomic orbital basis set adjustable to the local atomic\nenvironment around this atom. It is a hybrid of the\nnon-self-consistent environment-dependent tight-binding\nmodel72 and a Gaussian-based DFT scheme. Such adaptive behavior adequately compensates for the low precision of the minimal orthogonal basis set. In practice, SC-EDTB implements the environment dependence\nas the parametrization of Hamiltonian matrix elements\nwith respect to the atomic environment, rather than the\nparametrization of the atomic basis set. For example,\nthe parameterized part of Hamiltonian matrix elements\nfor the atom near the edge of the nanoribbon will be different from the respective matrix elements in the middle\nof the strip. Similarly, the in-plane Hamiltonian matrix\nelements for a single graphene layer will be different from\nthe respective matrix elements in a graphene bilayer.\nThe SC-EDTB Hamiltonian matrix elements are the\n\nsums of parameterized adaptive \"TB-like\" and nonadaptive \"true DFT\" contributions. The former mainly\naccounts for the covalent bonding, while the latter describes interatomic charge transfer, atomic dipole polarization, and on-site variation of exchange potential.\nThe extensive comparison of SC-EDTB with large basis set DFT calculations indicates that SC-EDTB produces more precise and transferable results than minimal\nbasis set pseudo-potential DFT schemes. At the same\ntime, SC-EDTB is faster than minimal basis set pseudopotential DFT due to: (i) faster computation of matrix\nelements; (ii) unit overlap matrix (i.e. orthogonal basis\nset); and (iii) smaller number of components used for the\ndescription of electron density (SC-EDTB uses ten independent components, s2 , spx , spy , spz , p2x , p2y , p2z , px py ,\npx pz , py pz , to describe the electron density at a given\ncarbon atom). This allows us not only to capture the\ninteratomic charge transfer, but also to account for the\ndipole polarization.\nThe compact description of electron density makes\npossible efficient combination of SC-EDTB with convergence acceleration schemes for both equilibrium and nonequilibrium cases, as discussed in Sec. A. The more detailed specification of electron density provided by standard DFT codes in local density (or some other) approximation34 will decrease the computation efficiency,\nbut will not affect the simulation of graphene devices\nwhose operation is based on charge transfer at the scale\nlarger than carbon-carbon bond length. To accommodate systems composed of tens of thousands atoms,\nthe SC-EDTB part of our NEGF-DFT computational\ncode also includes the possibility of multipole expansion of Coulomb potential and parallelization on distributed/shared memory systems.\nDespite 5 \u00c5 cutoff radius for the orbitals used in\nSC-EDTB, the coupling Hamiltonian matrix elements\nbetween the top and the bottom graphene layers of the\nsystem depicted in Fig. 4 have to be masked with zeros to simulate insulating layer in between. This causes\nthe nonequilibrium density matrix (2) in the presence of\nthe gate voltage Vgs to evolve into two equilibrium integrals (6)\n1\n\u03c1 quasi (\u03bc, Vgs , T ) = \u2212\nneq\n\u03c0\n\n+\u221e\nZ\ndE Im [Gr (E)]f (\u03bc, T, E)\n\u2212\u221e\n\n+\u221e\nZ\n1\n\u2212\ndE Im [Grgate (E)] {f (\u03bc + eVgs , T, E)\n\u03c0\n\u2212\u221e\n\n\u2212 f (\u03bc, T, E)} ,\n\n(40)\n\neach of which is evaluated through our \"pole summation\" algorithm encoded by the formula (16). Here Grgate\nrefers to the Green function matrix Eq. (3) computed\nfor the whole device, but whose all elements associated\nwith atoms in the lower source-channel-drain layer are\nmasked with zeros. That is, only those matrix elements\nwhich correspond to the gate layer are allowed to be non-\n\n\f14\nzero. We assume that the self-consistency of the recursive Green function algorithm + Broyden mixing scheme\n(see Appendix A) is reached when ||nout \u2212 nin || < 10\u22125 ,\nwhere the elements of the electron density vector n are\nextracted from the diagonal blocks of the corresponding\nout\n\u03c1out\nquasi and \u03c1 quasi matrices [as discussed in Sec. III B, only\nneq\n\nneq\n\ntheir diagonal blocks are computed from recursively generated submatrices Gri,i (E) of the retarded Green function].\n\nD.\n\nResults and Discussion\n\nWe first assume zero gate voltage and plot in Fig. 5\nthe self-consistent Hartree potential27 computed via the\nPoisson equation with net charge density due to charging of carbon atoms as the source term. The potential\nprofiles are evaluated within the planes that are parallel\nto two graphene layers in Fig. 4 and positioned in the\nregion between them. The inhomogeneous profiles are\ncaused by charge transfer between hydrogen and carbon\natoms. Furthermore, it is important to emphasize that\nthere is approximately 100 meV difference between the\nFermi levels of the wide \u03bcwide and narrow \u03bcnarrow source\nand drain ZGNR electrodes, respectively, in the bottom\ngraphene layer of the device in Fig. 4. This is caused by\ndifferent ratios of carbon atoms to hydrogen atoms passivating the zigzag edges in GNRs of different widths. That\nis, the edge hydrogen atoms effectively dope the nanoribbon19,20,21 where the level of doping depends on its size\nand geometry. To account for this, the equilibrium Fermi\nlevel of the whole setup \u03bc = (\u03bcwide + \u03bcnarrow )/2 used in\nEq. (40) is assumed to be the average of \u03bcwide and narrow\n\u03bcnarrow . Such compensation of the difference in the Fermi\nlevels requires a small built-in electric field in our model.\nRoom-temperature (T = 300 K) operation is assumed in\nall Figures in this Section.\nThen we apply voltage eVgs = 1 eV to the gate electrode in Fig. 6 and plot the full three-dimensional spatial\nprofile of the electric potential. Further increase of the\ngate voltage to eVgs = 3 eV leads to potential (within a\ngeometrical plane in between two graphene layers) shown\nin Fig. 7. The self-consistent atomistic level simulation\ncaptures the potential variation in the transverse direction of the GNRs, as well as possible modifications of\nthe band structure of GNRs with increasing gate voltage.27,29,30\nIn both Figures, we find that the chosen portion of\nmetallic ZGNR electrodes attached to the AGNR channel to form the \"extended central region\",36,39,43 encompassing ' 7000 carbon and hydrogen atoms for selfconsistent electron density and potential calculations, is\nactually not large enough (despite many ZGNR supercells included into the extended central region) to completely screen the effect of the applied electric field via the\ntop gate electrode. This is signified by the color of the\nCoulomb potential at the boundaries (marked by horizontal white lines in Fig. 7) of the \"extended central\n\nregion\" not being identical to the color of the uniform\npotential along the semi-infinite leads. The total uncompensated charge at the boundary is approximately 0.03 e\nfor eVgs = 1 eV and 0.07 e for eVgs = 3 eV.\nAnother feature conspicuous in Fig. 7 is that the onsite potential shift experienced by carbon atoms in the\nlower layer is much smaller than expected from the applied bias voltage. This unusual screening capability\nof insulating AGNR channel can be attributed to the\npresence of short segments of metallic AGNR due to either particular width of such segments (we do not relax\nthe coordinates and edge bonds which is necessary to\nmake all three types of AGNR insulating59 ) or doping by\nevanescent modes73 that decay from ZGNR electrodes\ninto AGNR channel thereby generating metal induced\ngap states74 (localized at the ZGNR|AGNR interface).24\nThis is also reflected in the conductance of our device-to\nshift the band gap of variable-width AGNR by 0.5 eV and\nbring it into single channel conducting regime demands a\nrater large gate voltage eVgs ' 3 eV (when compared to\neVgs ' half-the-band-gap required to turn uniform semiconducting AGNR into a single channel conductor27 ), as\nshown by the source-drain conductance computed as the\nfunction of Vgs in Figs. 8(b)\u2013(d).\nThe metallic behavior of ZGNR electrodes is characterized by the non-zero density of states and finite (zero\ntemperature) conductance at the Fermi level EF . We\nnote that in simple nearest-neighbor tight-binding models17 the conductance of infinite ZGNR around the charge\nneutral (Dirac) point EF = 0 is quantized G = GQ\n(GQ = 2e2 /h is the conductance quantum for spindegenerate transport) due to a single open conducting\nchannel (i.e., transverse propagating mode) defined by\nthe overlap of edge-localized wave functions.2,16 On the\nother hand, in DFT description (that can be mimicked by\nsingle pz -orbital tight-binding models which include third\nnearest-neighbor hopping16 ) more complicated subband\nstructure of ZGNR leads to three open conducting channels16 around EF = 0 and G = 3GQ quantized conductance for semi-infinite source and drain ZGNR electrodes.\nThis is confirmed in the context of our NEGF-DFT approach by Fig. 8(a).\nComparing Fig. 8(a) with Fig. 8(b), which are both\nobtained at Vgs = 0 V, highlights the importance of\nself-consistent electron density computation, even in the\nabsence of gate voltage effects. We find a marked difference in two panels between the position of the gap\nregion [over which the transmission function T (E, 0) in\nEq. (5) is zero] and conductance oscillations outside of it.\nThe conductance in Fig. 8(a) was obtained without computing charge transfer effects, and could be reproduced\nby popular non-self-consistent tight-binding models16,17\nwithout resorting to full NEGF-DFT formalism.\n\n\f15\n\nFIG. 5: (Color online) Contour plot of the Hartree potential for zero applied gate voltage (Vgs = 0 V) in the planes which\nare 0.7 \u00c5 (left panel) and 0.5 \u00d7 3.35 \u00c5 (right panel) above the lower graphene layer of the system depicted in Fig. 4. White\nhorizontal lines in the ZGNR electrode regions mark the boundaries of the extended central region \"AGNR channel + portion\nof ZGNR electrodes\" composed of ' 7000 atoms (for which the retarded Green function is evaluated to obtain electron density\nand electric potential through the self-consistent loop).\n\nIV.\n\nCONCLUDING REMARKS\n\nThe modeling of realistic multi-terminal graphene nanoelectronic devices requires quantum transport methods\nthat can capture effects of its highly unusual electronic\nproperties2,16 and their dependence on detailed device\ngeometry,17,18 as well as charge transfer (in equilibrium)\nand charge redistribution (out of equilibrium) effects on\natomistic scale. While quantum transport approaches\nbased on simple pre-defined Hamiltonians17 cannot handle all of these issues, the NEGF-DFT framework, which\ngenerates the self-consistent Hamiltonian of the device\nprior to the calculation of conductance or I-V characteristics, offers a proper methodology for first-principles mod-\n\neling of electron transport involving accurate quantumchemical description of atomic scale geometry.\nHowever, NEGF-DFT simulations thus far have been\nlimited31 to rather small systems, such as short molecules\nconnected to metallic electrodes. Here we address several obvious31 and more subtle (Sec. I) impediments\nthat have to be resolved to make possible the application of NEGF-DFT codes to devices containing many\nthousand atoms: (i) computational complexity of the\nretarded Green function calculation, as the main time\nlimiting part of the simulation when full Hamiltonian\nmatrix is inverted, should scale linearly with the system\nsize; (ii) integration of NEGFs to get the equilibrium\nand nonequilibrium part of the density matrix has to be\n\n\f16\n\nFIG. 6: (Color online) Contour plot of the Hartree potential\nin the plane 0.2 \u00c5 above the lower graphene layer when the\napplied gate voltage is eVgs = 1 eV. The semiconducting region is shifted by approximately 0.35 eV. The potential spikes\npointing downwards correspond to the hydrogen atoms. Positive potential spikes associated with carbon atoms in the C-H\ndipole pairs are truncated to make a clear view of the potential inside the conducting channel. Note that the potential\naxis points downwards.\n\nperformed in a way (especially in the case of nonequilibrium contribution) which ensures convergence despite\nsharp peaks (due to assumed phase-coherent transport of\nnon-interacting quasiparticles) along the real axis whose\nnumber increases substantially in large systems; and (iii)\nthe convergence of the self-consistent loop, which repeatedly evaluates (i) and (ii), should be accelerated with\nproper mixing scheme of previous iterative steps that is\ncompatible with solution of problems in (i) and (ii).\nThe algorithms presented here extend the NEGF-DFT\nmethodology to systems containing large number of\natoms through a combination of:\n(1) The \"pole summation\" algorithm for the exact integration of the retarded Green function in\nthe expression for the equilibrium part of the density matrix offers an alternative to standard numerical contour integration by replacing the Fermi\nfunction f (E) with the analytic function f \u0303(E),\nwhich coincides with f (E) inside the integration\nrange along the real axis but decays exponentially\nin the upper complex half-plane. Only a finite\nnumber Npole of its poles, which can be found\nanalytically, has non-negligible residues, so that\nPNpole\n\u03c1eq = Im j=1\n\u03b1j Gr (Zj ) where \u03b1j are scalars\ngiven by simple analytical expressions in Eq. (16).\nThe typical value of Npole for valence electrons at\nroom temperature is 80, and it increases with the\ntemperature decrease with an approximate rate of\n40 extra poles per order of magnitude in tempera-\n\nFIG. 7: (Color online) Contour plot of the Hartree potential for the applied gate voltage eVgs = 3 eV in the plane\n0.7 \u00c5 above the lower graphene layer. White horizontal lines\naround the ZGNR electrodes mark the boundaries of the extended central region \"AGNR channel + portion of ZGNR\nelectrodes\" composed of ' 7000 atoms.\n\nture reduction.\n(2) Possible application of the \"pole summation\"\nalgorithm to tackle the problem of difficult-toconverge integration of NEGFs along the real-axis\n(due to numerous sharp peaks in the integrand\nwhich would be impossible to locate and handle\nindividually52,53 for devices contains large number\nof atoms) to obtain \u03c1neq after its non-analytic integrand in the entire complex plane is approximated\nwith an analytic function in the upper complex\nplane, so that the same type of summation can be\nperformed as in the case of \u03c1eq integral.\n(3) The recursive Green function formulas which,\n\n\f17\n\nG H2e2 \u0090hL\n\n3\n\n1\n\nG H2e2 \u0090hL\n\n3\n2\n\nG H2e2 \u0090hL\n\n0.0\n\n1.0\n\neVgs = 0.0 eV\n\nHbL\n\n0.0\n\n1.0\n\neVgs = 1.0 eV\n\nHcL\n\n0.0\n\n1.0\n\neVgs = 3.0 eV\n\nHdL\n\n0.0\n\n1.0\n\n-1.0\n\n1\n\n3\n2\n\n-1.0\n\n1\n\n3\n\nG H2e2 \u0090hL\n\nHaL\n\n2\n\n2\n\n-1.0\n\n1\n0\n-1.0\n\nE-EF HeV L\n\nFIG. 8: (Color online) The non-self-consistent (a) and selfconsistent (b)\u2013(d) source-drain conductance (at linear response bias voltage Vds ) of the nanodevice depicted in Fig. 4\nas a function of energy. The conductances are obtained in the\nabsence (a), (b) or presence (c), (d) of the gate voltage Vgs ,\nwhere charge redistribution is computed self-consistently in\nall three cases (b)\u2013(d) [unlike in (a)]. The solid and dashed\nrectangular lines in panel (a) show the conductance quantization of the infinite source (wide nanoribbon, solid line) and\ndrain (narrow nanoribbon, dashed line) ZGNR electrodes, respectively. The Fermi level in the case of unbiased gate corresponds to E = 0.\n\nassuming proper geometrical decomposition of the\nlattice of the device into slices of irregular shape for\narbitrary nanostructure geometry, makes it possible to reduce scaling of the required computing time\nfrom O(N 3 ) for the full Hamiltonian matrix inversion in the single iteration of the self-consistent loop\nto linear scaling O(S) [S is the number of slices in\nthe transport direction] of the computation of only\nthe diagonal blocks of the retarded Green function\nthat yield the electron density within the slice.\nIn the case of equilibrium or quasi-equilibrium (such\nas generated by non-zero gate voltage and zero or linear\nresponse bias voltage) situations, we additionally accelerate convergence of the self-consistent loop for the density\nmatrix by using the modified Broyden scheme discussed\nin Appendix A, which is compatible with the recursive\nGreen function algorithm and mixes input and output\n\nelectron density from all previous iterations to generate\ninput density for the next iteration step.\nWe illustrate the numerical efficiency of the combination of these algorithms for NEGF part of the\ncalculation by integrating it with the DFT code\n(based on the minimal basis set-four localized orbitals per carbon atom and one per hydrogen-tailored\nfor carbon-hydrogen systems) to simulate gate voltage\neffects in all-graphene FET-type device. Our simulated ZGNR|variable-width-AGNR|ZGNR device is composed of ' 7000 atoms and employs AGNR of variable\nwidth (kept below 10 nm) as a realistic semiconductor\nchannel accessible to present nanofabrication technology.11,12,13,14 The device does not require atomic precision in controlling the width and the corresponding band\ngap when uniform sub-10-nm wide AGNR are used, while\nexploiting advantageous24 ZGNR source and drain electrodes. We also use square-shaped gate electrode covering the channel which is made of graphene as well.\nThe self-consistent evaluation of the electron density and\nCoulomb potential is required to capture inhomogeneous\ncharge distribution and modification of the GNR band\nstructure with increasing gate voltage.27,29,30 This reveals that rather large gate voltage is required to shift\nthe band gap of variable-width AGNR channel and bring\nthis type of top-gated GNRFET into a window of single\nopen transverse propagating mode with low scattering\nand heat dissipation.\nThe computation of self-consistent electron density\nand electrostatic potential, as the crucial aspect of\nNEGF-DFT approach to quantum transport modeling, is\nindispensable to properly take into account gate voltage\neffects or to ensure the gauge invariance25 of the I-V characteristics in far from equilibrium transport.26 In addition, we also demonstrate notable difference between the\nzero-bias transmission (i.e., linear response conductance)\nof non-self-consistent and self-consistent modeling. This\ncan be attributed to charge transfer effects between edge\npassivating hydrogen atoms and carbon atoms, where\nsuch edge doping also affects the position of the Fermi\nlevel of isolated GNRs of different size and geometry.\n\nAcknowledgments\n\nFinancial support from NSF under Grant No.\nECCS 0725566 is gratefully acknowledged.\n\nAPPENDIX A: BROYDEN MIXING SCHEME\nFOR CONVERGENCE ACCELERATION OF THE\nSELF-CONSISTENT LOOP\n\nThe recursive Green function algorithm discussed in\nSec. III B drastically reduces the computational complexity of a single iteration step within the self-consistent\nloop (1). Another important ingredient of algorithms\nthat can handle systems with large number of atoms is\n\n\f18\nto combine the recursive techniques with the convergence\nacceleration scheme based on proper mixing of quantities\nfound in previous steps to produce the input for the next\nstep.\nThe simplest mixing scheme takes certain fraction \u03b5 of\nthe output electron density nout\nm from the previous step\nm and the remaining fraction (1 \u2212 \u03b5) from the corresponding input nin\nm to produce input for the next step,\nin\nout\nnin\n=\n(1\n\u2212\n\u03b5)n\nm + \u03b5nm . Finding the optimal value\nm+1\nfor the mixing parameter, typically \u03b5 \u223c 0.1 \u2212 0.01, depends on the nature of the system (such as, insulating vs.\nmetallic or isolated vs. attached to semi-infinite leads).\nThis can require few thousand iteration steps to satisfy\nin\n\u22125\nthe convergence criterion ||nout\nwe employ\nm \u2212nm || < 10\nin our simulation.\nThe more sophisticated mixing schemes employ Pulay44 or Broyden75,76,77 algorithms to mix several previous steps, where the quantities mixed can be the density\nmatrix or Hamiltonian and Green functions44 (which can\nbe more efficient for open multi-terminal systems where\nthe central region does not have a fixed number of electrons). For a small bias voltage, the self-consistency can\nbe achieved by applying the Broyden convergence acceleration method which has two major advantages. First,\nthe modified second Broyden method76,77 is compatible\nwith the recursive Green function method discussed in\nSec. III B. Second, the Broyden method adds O(N ) extra operations, so that the single iteration is not slowed\ndown. However, the reduction of the number of iterations\nachieved by the Broyden method is appreciable.\nThe Broyden method works well when the correlation between the electron density and the potential is\nlocal, i.e., when the local potential distortion results\nin a local self-consistent density change. On the other\nhand, in the case of non-local correlations the Broyden\nmethod performance rapidly deteriorates. The nonequilibrium electron density in the coherent ballistic approx-\n\n1\n\n2\n\n3\n4\n\n5\n6\n\n7\n\n8\n\n9\n\n10\n\nA. K. Geim and K. S. Novoselov, Nature Mater. 6, 183\n(2007).\nA. H. C. Neto, F. Guinea, N. M. R. Peres, K. S. Novoselov,\nand A. K. Geim, Rev. Mod. Phys. 81, 109 (2009).\nP. Avouris, Phys. Today 62(1), 34 (2009).\nM. Burghard, H. Klauk, and K. Kern, Adv. Mater. 21, 1\n(2009).\nR. W. Keyes, Rep. Progr. Phys. 68, 2701 (2005).\nP. Avouris, Z. Chen, and V. Perebeinos, Nature Nano. 2,\n605 (2007).\nK. S. Novoselov, A. K. Geim, S. V. Morozov, D. Jiang,\nY. Zhang, S. V. Dubonos, I. V. Grigorieva, and A. A.\nFirsov, Science 306, 666 (2004).\nJ.-H. Chen, C. Jang, S. Xiao, M. Ishigami, and M. S.\nFuhrer, Nature Nano. 3, 206 (2008).\nI. Meric, M. Y. Han, A. F. Young, B. Ozyilmaz, P. Kim,\nand K. L. Shepard, Nature Nano. 3, 654 (2008).\nY.-M. Lin, K. A. Jenkins, A. Valdes-Garcia, J. P. Small,\nD. B. Farmer, and P. Avouris, Nano Lett. 9, 422 (2009).\n\nimation constitutes the perfect example when the Broyden method fails. The reason for this is that electronpotential correlations becomes completely non-local-the\nchange of the potential at one contact can shut off the\nelectron flux through the entire system and cause the\nsystem-wide electron density redistribution. Thus, in farfrom-equilibrium cases other mixing schemes have to be\nused.26,36\nIn particular, the modified second Broyden\nmethod76,77 is compatible with the recursive Green\nfunction method discussed in Sec. III B, and makes it\npossible to reduce the number of iteration steps to the\norder of \u223c 10. In this scheme, an input electron density\nfor iteration m + 1 is constructed from the set of input\nand output densities generated in all previous iterations:\n\nnin\nm+1\n\n=\n\nnin\nm\n\n\u2212 \u03b5Fm \u2212\n\nm\nX\n\nWj * [\u03a6j ]T * Fm , (A1a)\n\nj=2\n\nnout\nm\n\nnin\nm,\n\nFm =\n\u2212\nin\nWi = \u2212\u03b5(Fi \u2212 Fi\u22121 ) + nin\ni \u2212 ni\u22121\n\u2212\n\ni\u22121\nX\n\nWj * [\u03a6j ]T * (Fi \u2212 Fi\u22121 ),\n\n(A1b)\n\n(A1c)\n\nj=2\n\n[\u03a6i ]T =\n\n(Fi \u2212 Fi\u22121 )T\n.\n(Fi \u2212 Fi\u22121 )T * (Fi \u2212 Fi\u22121 )\n\n(A1d)\n\nout\nHere nin\nm , nm , Fm , Wj , and \u03a6j comprise a relatively\nsmall set of vectors to be stored in computer memory.\nThe compatibility of this modified Broyden scheme with\nthe recursive Green function algorithm of Sec. III B stems\nfrom the fact that only diagonal blocks of Gr , required to\nconstruct vectors in Eq. (A1), are computed recursively\nwithout knowing the full Green function needed in some\nother mixing schemes.26,44\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n19\n\n20\n\nX. Li, X. Wang, L. Zhang, S. Lee, and H. Dai, Science 319,\n1229 (2008).\nL. Tapaszt\u00f3, G. Dobrik, P. Lambin, and L. P. Bir\u00f3, Nature\nNano. 3, 397 (2008).\nL. Jiao, L. Zhang, X. Wang, G. Diankov, and H. Dai, Nature 458, 877 (2009).\nD. V. Kosynkin, A. L. Higginbotham, A. Sinitskii, J. R.\nLomeda, A. Dimiev, B. K. Price, and J. M. Tour, Nature\n458, 872 (2009).\nX. R. Wang, Y. J. Ouyang, X. L. Li, H. L. Wang, J. Guo,\nand H. J. Dai, Phys. Rev. Lett. 100, 206803 (2008).\nA. Cresti, N. Nemec, B. Biel, G. Niebler, F. Triozon,\nG. Cuniberti, and S. Roche, Nano Research 1, 361 (2008).\nA. Rycerz, J. Tworzydlo, and C. W. J. Beenakker, Nature\nPhys. 3, 172 (2007).\nD. Areshkin and C. White, Nano Lett. 7, 3253 (2007).\nZ. Li, H. Qian, J. Wu, B.-L. Gu, and W. Duan, Phys. Rev.\nLett. 100, 206802 (2008).\nS. Dutta and S. K. Pati, J. Phys. Chem. B 112, 1333\n\n\f19\n\n21\n\n22\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n43\n\n44\n\n45\n\n46\n\n47\n48\n\n49\n\n50\n\n(2008).\nB. Biel, F. Triozon, X. Blase, and S. Roche, Nano Lett. 9,\n2725 (2009).\nG. Lee and K. Cho, Phys. Rev. B 79, 165440 (2009).\nY. Ouyang, Y. Yoon, and J. Guo, IEEE Trans. Electron\nDevices 54, 2223 (2007).\nG. Liang, N. Neophytou, M. S. Lundstrom, and D. E.\nNikonov, Nano Lett. 8, 1819 (2008).\nT. Christen and M. B\u00fcttiker, Europhys. Lett. 35, 523\n(1996).\nD. A. Areshkin and B. K. Nikoli\u0107, Phys. Rev. B 79, 205430\n(2009).\nJ. Fern\u00e1ndez-Rossier, J. J. Palacios, and L. Brey, Phys.\nRev. B 75, 205441 (2007).\nP. G. Silvestrov and K. B. Efetov, Phys. Rev. B 77, 155436\n(2008).\nA. Shylau, J. Klos, and I. Zozoulenko, preprint\narXiv:0907.1040.\nJ. Guo, Y. Yoon, and Y. Ouyang, Nano Lett. 7, 1935\n(2007).\nK. Stokbro, J. Phys.: Condens. Matter 20, 064216 (2008).\nM. Koentopp, C. Chang, K. Burke, and R. Car, J. Phys.:\nCondens. Matter 20, 083203 (2008).\nH. Haug and A.-P. Jauho, Quantum Kinetics in Transport\nand Optics of Semiconductors, 2nd Ed. (Springer, Berlin,\n2007).\nC. Fiolhais, F. Nogueira, and M. Marques, Eds., A Primer\nin Density Functional Theory (Springer, Berlin, 2003).\nJ. Taylor, H. Guo, and J. Wang, Phys. Rev. B 63, 245407\n(2001).\nM. Brandbyge, J.-L. Mozos, P. Ordej\u00f3n, J. Taylor, and\nK. Stokbro, Phys. Rev. B 65, 165401 (2002).\nY. Xue, S. Datta, and M. A. Ratner, Chem. Phys. 281,\n151 (2002).\nJ. J. Palacios, A. J. P\u00e9rez-Jim\u00e9nez, E. Louis, E. Sanfabi\u00e1n,\nand J. A. Verg\u00e9s, Phys. Rev. B 66, 035322 (2002).\nS.-H. Ke, H. U. Baranger, and W. Yang, Phys. Rev. B 70,\n085410 (2004).\nA. Pecchia and A. Di Carlo, Rep. Progr. Phys. 67, 1497\n(2004).\nF. Evers, F. Weigend, and M. Koentopp, Phys. Rev. B 69,\n235411 (2004).\nS. V. Faleev, F. L\u00e9onard, D. A. Stewart, and M. van Schilfgaarde, Phys. Rev. B 71, 195422 (2005).\nA. R. Rocha, V. M. Garc\u0131\u0301a-Su\u00e1rez, S. Bailey, C. Lambert,\nJ. Ferrer, and S. Sanvito, Phys. Rev. B 73, 085414 (2006).\nK. S. Thygesen and A. Rubio, Phys. Rev. B 77, 115333\n(2008).\nP. Darancet, A. Ferretti, D. Mayou, and V. Olevano, Phys.\nRev. B 75, 075102 (2007).\nR. Golizadeh-Mojarad and S. Datta, Phys. Rev. B 75,\n081301 (2007).\nS. Mertens, Comp. Sci. Eng. 4, 31 (2002).\nThe size of relevant matrices HKS [n(r)] and Gr is actually\nPNspecies\nNs \u00d7 Norbitals where Norbitals is the number of\ns=1\nlocalized valence electron orbitals per atom type s.\nH. H. B. S\u00f8rensen, P. C. Hansen, D. E. Petersen, S. Skelboe, and K. Stokbro, Phys. Rev. B 79, 205322 (2009).\nS.-H. Ke, H. U. Baranger, and W. Yang, Phys. Rev. B 71,\n113401 (2005).\n\n51\n\n52\n\n53\n\n54\n\n55\n\n56\n57\n\n58\n\n59\n\n60\n\n61\n\n62\n\n63\n64\n\n65\n\n66\n\n67\n\n68\n\n69\n\n70\n\n71\n\n72\n\n73\n\n74\n\n75\n\n76\n\n77\n\nH. He, R. Pandey, and S. P. Karna, Nanotechnology 19,\n505203 (2008).\nR. Li, J. Zhang, S. Hou, Z. Qian, Z. Shen, X. Zhao, and\nZ. Xue, Chem. Phys. 336, 127 (2007).\nH. J. Choi, M. L. Cohen, and S. G. Louie, Phys. Rev. B\n76, 155420 (2007).\nA. Pecchia, G. Penazzi, L. Salvucci, and A. Di Carlo, New\nJ. Phys. 10, 065022 (2008).\nK. Kazymyrenko and X. Waintal, Phys. Rev. B 77, 115119\n(2008).\nE. Polizzi, Phys. Rev. B 79, 115112 (2009).\nD. A. Areshkin, O. A. Shenderova, J. D. Schall, S. P.\nAdiga, and D. W. Brenner, J. Phys.: Condens. Matter\n16, 6851 (2004).\nD. A. Areshkin, O. A. Shenderova, J. D. Schall, and D. W.\nBrenner, Molecular Simulation 31, 585 (2005).\nY.-W. Son, M. L. Cohen, and S. G. Louie, Phys. Rev. Lett.\n97, 216803 (2006).\nL. Pisani, J. A. Chan, B. Montanari, and N. M. Harrison,\nPhys. Rev. B 75, 064418 (2007).\nO. V. Yazyev and M. I. Katsnelson, Phys. Rev. Lett. 100,\n047209 (2008).\nB. Huang, F. Liu, J. Wu, B.-L. Gu, and W. Duan, Phys.\nRev. B 77, 153411 (2008).\nK. A. Ritter and J. Lyding, Nature Materials 8, 235 (2009).\nL. A. Girifalco and R. A. Lad, J. Chem. Phys. 25, 693\n(1956).\nD. K. Ferry and S. M. Goodnick, Transport in Nanostructures (Cambridge University Press, Cambridge, 1999).\nP. Drouvelis, P. Schmelcher, and P. Bastian, J. Comp.\nPhys. 215, 741 (2006).\nA. Cresti, R. Farchioni, G. Grosso, and G. P. Parravicini,\nPhys. Rev. B 68, 075306 (2003).\nG. Metalidis and P. Bruno, Phys. Rev. B 72, 235304\n(2005).\nA. Lassl, P. Schlagheck, and K. Richter, Phys. Rev. B 75,\n045346 (2007).\nB. K. Nikoli\u0107, L. P. Z\u00e2rbo, and S. Souma, in The Oxford\nHandbook of Nanoscience and Technology: Frontiers and\nAdvances, Eds. A. V. Narlikar and Y. Y. Fu (Oxford University Press, Oxford, 2010); preprint arXiv:0907.4122.\nH. Mera, P. Bokes, and R. W. Godby, Phys. Rev. B 72,\n085311 (2005).\nM. S. Tang, C. Z. Wang, C. T. Chan, and K. M. Ho, Phys.\nRev. B 53, 979 (1996).\nP. Pomorski, C. Roland, and H. Guo, Phys. Rev. B 70,\n115408 (2004).\nAlthough metal induced gap states do not affect the transmission for long channel devices at linear response bias\nvoltage, they are expected to contribute to tunneling currents, particularly in short channel devices. In fact, they\ncan also affect longer channel devices by enhancing scattering processes under high source-drain bias voltage.\nK. Ohno, K. Esfarjani, and Y. Kawazoe, Computational\nMaterials Science: From Ab Initio to Monte Carlo Methods\n(Springer, Berlin, 2000).\nD. Singh, H. Krakauer, and C. S. Wang, Phys. Rev. B 34,\n8391 (1986).\nS. Ihnatsenka, I. V. Zozoulenko, and M. Willander, Phys.\nRev. B 75, 235307 (2007).\n\n\f"}