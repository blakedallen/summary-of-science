{"id": "http://arxiv.org/abs/1105.0627v1", "guidislink": true, "updated": "2011-05-03T16:30:25Z", "updated_parsed": [2011, 5, 3, 16, 30, 25, 1, 123, 0], "published": "2011-05-03T16:30:25Z", "published_parsed": [2011, 5, 3, 16, 30, 25, 1, 123, 0], "title": "Linkage disequilibrium under recurrent bottlenecks", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1105.2730%2C1105.4447%2C1105.5376%2C1105.5991%2C1105.6370%2C1105.3636%2C1105.1407%2C1105.4225%2C1105.2366%2C1105.5357%2C1105.2925%2C1105.0547%2C1105.5242%2C1105.4486%2C1105.6232%2C1105.3746%2C1105.2824%2C1105.2116%2C1105.5771%2C1105.2848%2C1105.0598%2C1105.2157%2C1105.3274%2C1105.4474%2C1105.3361%2C1105.0386%2C1105.0326%2C1105.5856%2C1105.0030%2C1105.3702%2C1105.2168%2C1105.5870%2C1105.4120%2C1105.3295%2C1105.3961%2C1105.2548%2C1105.5135%2C1105.0489%2C1105.4122%2C1105.5185%2C1105.2696%2C1105.2086%2C1105.3533%2C1105.4091%2C1105.3309%2C1105.1207%2C1105.5472%2C1105.2375%2C1105.4938%2C1105.4164%2C1105.4676%2C1105.4659%2C1105.3526%2C1105.6287%2C1105.0955%2C1105.3431%2C1105.6122%2C1105.1032%2C1105.1394%2C1105.4814%2C1105.5582%2C1105.1168%2C1105.5685%2C1105.5180%2C1105.2629%2C1105.1142%2C1105.4730%2C1105.3405%2C1105.1857%2C1105.4235%2C1105.3340%2C1105.6050%2C1105.2040%2C1105.6056%2C1105.0688%2C1105.3018%2C1105.3868%2C1105.2612%2C1105.0536%2C1105.3687%2C1105.0899%2C1105.5039%2C1105.4971%2C1105.2827%2C1105.4260%2C1105.4932%2C1105.3920%2C1105.1632%2C1105.4140%2C1105.5852%2C1105.1978%2C1105.1696%2C1105.1277%2C1105.0916%2C1105.1243%2C1105.4856%2C1105.6093%2C1105.0627%2C1105.6170%2C1105.1850%2C1105.6371&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Linkage disequilibrium under recurrent bottlenecks"}, "summary": "Understanding patterns of selectively neutral genetic variation is essential\nin order to model deviations from neutrality, caused for example by different\nforms of selection. Best understood is neutral genetic variation at a single\nlocus, but additional insights can be gained by investigating genetic variation\nat multiple loci. The corresponding patterns of variation reflect linkage\ndisequilibrium and provide information about the underlying multi-locus gene\ngenealogies. The statistical properties of two-locus genealogies have been\nintensively studied for populations of constant census size, as well as for\nsimple demographic histories such as exponential population growth, and single\nbottlenecks. By contrast, the combined effect of recombination and sustained\ndemographic fluctuations is poorly understood. Addressing this issue, we study\na two-locus Wright-Fisher model of a population subject to recurrent\nbottlenecks. We derive coalescent approximations for the covariance of the\ntimes to the most recent common ancestor at two loci. We find, first, that an\neffective population-size approximation describes the numerically observed\nlinkage disequilibrium provided that recombination occurs either much faster or\nmuch more slowly than the population size changes. Second, when recombination\noccurs frequently between bottlenecks but rarely within bottlenecks, we observe\nlong-range linkage disequilibrium. Third, we show that in the latter case, a\ncommonly used measure of linkage disequilibrium, sigma_d^2 (closely related to\nr^2), fails to capture long-range linkage disequilibrium because constituent\nterms, each reflecting long-range linkage disequilibrium, cancel. Fourth, we\nanalyse a limiting case in which long-range linkage disequilibrium can be\ndescribed in terms of a Xi-coalescent process allowing for simultaneous\nmultiple mergers of ancestral lines.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1105.2730%2C1105.4447%2C1105.5376%2C1105.5991%2C1105.6370%2C1105.3636%2C1105.1407%2C1105.4225%2C1105.2366%2C1105.5357%2C1105.2925%2C1105.0547%2C1105.5242%2C1105.4486%2C1105.6232%2C1105.3746%2C1105.2824%2C1105.2116%2C1105.5771%2C1105.2848%2C1105.0598%2C1105.2157%2C1105.3274%2C1105.4474%2C1105.3361%2C1105.0386%2C1105.0326%2C1105.5856%2C1105.0030%2C1105.3702%2C1105.2168%2C1105.5870%2C1105.4120%2C1105.3295%2C1105.3961%2C1105.2548%2C1105.5135%2C1105.0489%2C1105.4122%2C1105.5185%2C1105.2696%2C1105.2086%2C1105.3533%2C1105.4091%2C1105.3309%2C1105.1207%2C1105.5472%2C1105.2375%2C1105.4938%2C1105.4164%2C1105.4676%2C1105.4659%2C1105.3526%2C1105.6287%2C1105.0955%2C1105.3431%2C1105.6122%2C1105.1032%2C1105.1394%2C1105.4814%2C1105.5582%2C1105.1168%2C1105.5685%2C1105.5180%2C1105.2629%2C1105.1142%2C1105.4730%2C1105.3405%2C1105.1857%2C1105.4235%2C1105.3340%2C1105.6050%2C1105.2040%2C1105.6056%2C1105.0688%2C1105.3018%2C1105.3868%2C1105.2612%2C1105.0536%2C1105.3687%2C1105.0899%2C1105.5039%2C1105.4971%2C1105.2827%2C1105.4260%2C1105.4932%2C1105.3920%2C1105.1632%2C1105.4140%2C1105.5852%2C1105.1978%2C1105.1696%2C1105.1277%2C1105.0916%2C1105.1243%2C1105.4856%2C1105.6093%2C1105.0627%2C1105.6170%2C1105.1850%2C1105.6371&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Understanding patterns of selectively neutral genetic variation is essential\nin order to model deviations from neutrality, caused for example by different\nforms of selection. Best understood is neutral genetic variation at a single\nlocus, but additional insights can be gained by investigating genetic variation\nat multiple loci. The corresponding patterns of variation reflect linkage\ndisequilibrium and provide information about the underlying multi-locus gene\ngenealogies. The statistical properties of two-locus genealogies have been\nintensively studied for populations of constant census size, as well as for\nsimple demographic histories such as exponential population growth, and single\nbottlenecks. By contrast, the combined effect of recombination and sustained\ndemographic fluctuations is poorly understood. Addressing this issue, we study\na two-locus Wright-Fisher model of a population subject to recurrent\nbottlenecks. We derive coalescent approximations for the covariance of the\ntimes to the most recent common ancestor at two loci. We find, first, that an\neffective population-size approximation describes the numerically observed\nlinkage disequilibrium provided that recombination occurs either much faster or\nmuch more slowly than the population size changes. Second, when recombination\noccurs frequently between bottlenecks but rarely within bottlenecks, we observe\nlong-range linkage disequilibrium. Third, we show that in the latter case, a\ncommonly used measure of linkage disequilibrium, sigma_d^2 (closely related to\nr^2), fails to capture long-range linkage disequilibrium because constituent\nterms, each reflecting long-range linkage disequilibrium, cancel. Fourth, we\nanalyse a limiting case in which long-range linkage disequilibrium can be\ndescribed in terms of a Xi-coalescent process allowing for simultaneous\nmultiple mergers of ancestral lines."}, "authors": ["E. Schaper", "A. Eriksson", "M. Rafajlovic", "S. Sagitov", "B. Mehlig"], "author_detail": {"name": "B. Mehlig"}, "author": "B. Mehlig", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1534/genetics.111.134437", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1105.0627v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1105.0627v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "34 pages, 7 figures", "arxiv_primary_category": {"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1105.0627v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1105.0627v1", "journal_reference": "Genetics 190, 217 (2012)", "doi": "10.1534/genetics.111.134437", "fulltext": "Linkage disequlibrium under recurrent bottlenecks\nE. Schapera,\u2217 , A. Erikssonb , M.Rafajlovica , S. Sagitovc , and B. Mehliga\na Department of\n\nPhysics, University of Gothenburg, SE-41296 Gothenburg, Sweden\n\nb Department of\n\nZoology, University of Cambridge, Cambridge, UK\n\narXiv:1105.0627v1 [q-bio.PE] 3 May 2011\n\nc Mathematical\n\nSciences, Chalmers University of Technology and University of\n\nGothenburg, SE-41296 Gothenburg, Sweden\n\n\u2217\n\nPresent address: Institute of Computational Science, ETH, CH-8092 Z\u00fcrich, Switzerland and Swiss Institute\n\nof Bioinformatics, CH-1015 Lausanne, Switzerland\n\n1\n\n\fAbstract\nUnderstanding patterns of selectively neutral genetic variation is essential in order to\nmodel deviations from neutrality, caused for example by different forms of selection.\nBest understood is neutral genetic variation at a single locus, but additional insights can\nbe gained by investigating genetic variation at multiple loci. The corresponding patterns\nof variation reflect linkage disequilibrium and provide information about the underlying\nmulti-locus gene genealogies. The statistical properties of two-locus genealogies have\nbeen intensively studied for populations of constant census size, as well as for simple\ndemographic histories such as exponential population growth, and single bottlenecks. By\ncontrast, the combined effect of recombination and sustained demographic fluctuations is\npoorly understood. Addressing this issue, we study a two-locus Wright-Fisher model of a\npopulation subject to recurrent bottlenecks. We derive coalescent approximations for the\ncovariance of the times to the most recent common ancestor at two loci. We find, first, that\nan effective population-size approximation describes the numerically observed linkage\ndisequilibrium provided that recombination occurs either much faster or much more slowly\nthan the population size changes. Second, when recombination occurs frequently between\nbottlenecks but rarely within bottlenecks, we observe long-range linkage disequilibrium.\nThird, we show that in the latter case, a commonly used measure of linkage disequilibrium,\n\n\u03c3d2 (closely related to r\u03022 ), fails to capture long-range linkage disequilibrium because\nconstituent terms, each reflecting long-range linkage disequilibrium, cancel. Fourth, we\nanalyse a limiting case in which long-range linkage disequilibrium can be described in\nterms of a Xi-coalescent process allowing for simultaneous multiple mergers of ancestral\nlines.\n\nKeywords: Recurrent bottlenecks, linkage disequilibrium, recombination, gene histories, single nucleotide polymorphism, Kingman's coalescent, Xi-coalescent\n\n2\n\n\fI. INTRODUCTION\n\nGenetic variation at single neutral loci has been investigated in great detail for population models under different demographic processes, such as population expansions, single bottlenecks, or\ngenetic hitchhiking caused by nearby selective sweeps (see for example (Eriksson et al., 2008) for\na review of such models). All of of these models, either with non-overlapping generations, such as\nthe Wright-Fisher model (Fisher, 1930/1999; Wright, 1931), or with continuous reproduction and\nmortality, such as the Moran model (Moran, 1958), have in common the underlying assumption\nof random mating.\nReal biological populations exhibit abundance fluctuations on both short and long time scales,\ncaused by e. g. environmental and ecological changes. Such size fluctuations in the form of repeated bottlenecks are characteristic of populations expanding into new territories: examples include the human out-of-Africa scenario (Liu et al., 2006; Ramachandran et al., 2005), the accompanying expansion of the parasite Plasmodicum falciparum causing severe malaria (Tanabe et al.,\n2010), and the recolonization by the marine snail Littorina saxatilis of Sweden's west coast\narchipelago (Johannesson, 2003). It is common practice to accommodate such fluctuations in\nthe theory by using an effective population size instead of the census population size (see (Ewens,\n1982) for a review of different measures of the effective population size).\nRecent research has highlighted the importance of two competing time scales in the context\nof effective population-size approximations: the coalescent time scale (which is inversely proportional to the population size and reflects the time to the most recent common ancestor (MRCA) in\npopulations with constant population size), and the time scale of the population-size fluctuations.\nClearly, relatively slow demographic fluctuations can be ignored and the effective population size\ncan be approximated by the initial population size (Sj\u00f6din et al., 2005). In the opposite case of very\nfrequent demographic fluctuations, it has been argued (Crow and Kimura, 1970; Wright, 1938)\nthat genetic variation of a population with varying population size is well described in terms of\na population with constant population size Neff , given by the harmonic average of the population\nsize N\u03c4 in generation \u03c4 :\nNeff = lim\n\nT \u2192\u221e\n\nT\n\n1 \u0011\u22121\n.\nT \u03c4\u2211\n=0 N\u03c4\n\n\u00101\n\n(1)\n\nSee (Jagers and Sagitov, 2004; Sj\u00f6din et al., 2005; Wakeley and Sargsyan, 2009) for recent developments of this concept.\n\n3\n\n\fThus, for both fast and slow demographic fluctuations, the statistical properties of gene genealogies agree with those of the constant population-size model. By contrast, when both time\nscales are of the same order, it has been shown (Eriksson et al., 2010; Kaj and Krone, 2003;\nNordborg and Krone, 2003; Sj\u00f6din et al., 2005) that the distribution of total branch lengths in\nsamples of one-locus gene genealogies does not in general agree with that predicted by the standard coalescent approximation. Especially, when subject to periodic fluctuations, the total branch\nlength of gene genealogies may exhibit a maximum for periods matching the coalescent time scale\n(Eriksson et al., 2010). In summary, the effect of population-size fluctuations upon genetic variation of a single locus is well understood.\nBut how do population-size fluctuations affect multi-locus patterns of genetic variation on the\nsame chromosome? Such patterns are influenced by recombination. Genetic recombination introduces a new time scale which is inversely proportional to the probability of recombination r\nbetween a pair of loci in a single generation.\nGenetic recombination plays an important role in shaping empirically observed multi-locus patterns of genetic variation in biological populations. Measures of linkage disequilibrium (LD) quantify the degree of association of genetic variation at pairs of loci on the same chromosome. Common measures of LD, such as r\u03022 (Hill and Robertson, 1968), and its approximation \u03c3d2 (McVean,\n2002; Ohta and Kimura, 1971), depend upon the frequencies of alleles at two loci. These measures are thus closely related to the covariance of the times (i. e. the number of generations) to the\nMRCA of the underlying gene genealogies (McVean, 2002).\nIn order to illustrate this concept, we show in Fig. 1 our results of the Wright-Fisher dynamics\n(grey lines) of a population experiencing recurrent bottlenecks, with random durations and separations between bottlenecks. Panels a and b show results for two different sets of parameters.\nDetails are given in Section II. The single-locus properties of a similar model were studied by\nSj\u00f6din et al. (2005) and also by Eriksson et al. (2010). Each grey line in Fig. 1 shows the covariance of the times to the MRCA for two chromosomes at two loci, as a function of genetic distance\nalong the chromosomes, corresponding to a single realisation of the sequence of bottlenecks, D\n(averaged over all pairs of loci the same distance apart). The red lines are the averages of the\ncovariances within each panel. In panel a, the bottlenecks happen frequently and have a short\nduration; in this case, the single-locus properties are expected to be in good agreement with those\nof a population with the constant effective population size, given by the harmonic time average,\nEq. (1), of the population size N\u03c4 . For such populations, the coalescent approximation predicts\n4\n\n\f(Griffiths, 1981; Hudson, 1983, 1990)\ncov[ta(i j) ,tb(i j) ] = x2eff\n\nRxeff + 18\n,\n(Rxeff )2 + 13Rxeff + 18\n\n(2)\n\nwhere ta(i j) and tb(i j) are the times to the MRCA of two loci (called a and b), in a sample of two\nchromosomes (denoted by i and j). Moreover, R = 2N0 r is the scaled recombination rate, and\nxeff = Neff /N0 is the effective population size relative to N0 , the population size at the present time.\nUnits of time are chosen so that \u03c4 = \u230atN0\u230b, and \u230atN0 \u230b is the largest integer not larger than tN0 .\nEffective population-size approximations, according to Eq. (2), are shown as dashed lines in Fig. 1.\nIn Fig. 1a we observe good agreement between Eq. (2) and the average covariance of the times\nto the MRCA obtained numerically. However, in Fig. 1b, Eq. (2) agrees with our numerically\nobtained covariance only for short genetic distances. For large genetic distances, by contrast, the\nnumerical results show that the covariance decreases much more slowly than expected according\nto Eq. (2). Thus, the results shown in Fig. 1b imply long-range LD in two-locus gene genealogies.\nThe examples shown in Fig. 1 open many questions in relation to multi-locus gene-genealogies.\nWhat are the conditions for the effective population-size approximation to be valid in the multilocus case? Why does it fail when these conditions are not met? How significant are deviations of\nthe exact result from the effective population-size approximation? Why does long-range linkage\nappear in some cases? How large are fluctuations around the covariance of the coalescent times,\naveraged over an ensemble of gene-genealogies and over different demographic histories? What\nis the significance of the fluctuations around such averages for data analysis?\nThe aim of this paper is to provide answers to the above questions, by computing the covariance of the times to the MRCA under a model of recurrent bottlenecks introduced in Section\nII. Our analysis enables us to qualitatively and quantitatively determine the effects of fluctuating\npopulation size on the two-locus statistics in terms of the time scales of population-size fluctuations, of coalescence, and of recombination. Using both a numerical and an analytical approach,\nwe estimate the range of validity of the coalescent effective population-size approximation for the\ntwo-locus case. We find that the coalescent effective population-size approximation inevitably fails\nfor large recombination rates: the failure is sometimes minor (as in the case shown in Fig. 1a) and\nsometimes significant (as in the case shown in Fig. 1b). By taking different limits of the parameters of the model, we provide both qualitative and quantitative understanding of how the constant\neffective population-size approximation may fail. Finally, when bottlenecks are severe, we show\n5\n\n\fthat gene genealogies can be approximated by those of a constant-sized population with simultaneous multiple pairwise coalescent events (the so-called Xi-coalescent described by Schweinsberg\n(2000) and M\u00f6hle and Sagitov (2001)). Last but not least, we demonstrate that \u03c3d2 is surprisingly\nlittle affected by the long-range covariances.\n\nII. MODEL\n\nWe use a Wright-Fisher model of a population of chromosomes, to trace the ancestry of L loci\non a pair of chromosomes backwards in time, until the most recent common ancestor of each locus\nis found. In each generation \u03c4 , a set of parents is chosen randomly from the previous generation.\nGenetic recombination of a pair of chromosomes occurs independently with probability r between\neach adjacent pair of loci.\nTo investigate the role of population-size fluctuations, we consider a model of recurrent bottlenecks in which the population size can take one of two values, N0 or xN0 . Here xN0 is the\npopulation size in the bottlenecks, and 0 < x < 1. The probability of changing the population size,\ngoing one generation back in time, depends on the current population size. The switching probability is p and q when the current population size is N0 and xN0 , respectively. Hence, the expected\ndurations of the high and the low population-size phases are 1/p and 1/q generations, respectively.\nThe population size in the first generation is taken to be N0 . We note that for the one-locus case,\nsuch a model has been investigated by Sj\u00f6din et al. (2005) and also by Eriksson et al. (2010).\nFig. 2 illustrates population-size fluctuations in this recurrent bottleneck model (panels a and\nb) and examples of gene genealogies of two loci (called a and b) in a sample of two chromosomes\n(panels c and d). In panels c and d, generations with low population size (xN0 ) are marked with\nyellow, otherwise the population size is N0 . Each chromosome is represented by a pair of lines\n(red and blue lines correspond to loci a and b, respectively). In the generations where a common\nancestor is found for a pair of ancestral lines, or a recombination between two loci occurs, the\nchromosomes are represented by circles instead of lines. The MRCA of a locus is shown as a\nfilled circle. In some cases recombination causes the ancestry of one locus to become associated\nwith a chromosome that lacks direct descendants in the sample (grey circles). The ancestries of\nsuch segments of DNA are irrelevant to the gene genealogy of the sample, and these ancestral lines\nare not traced further.\n\n6\n\n\fIII. COVARIANCE OF THE TIMES TO THE MRCA FOR TWO INDIVIDUALS\n\nAs Fig. 1 shows, the covariance of the times to the MRCA at two loci (called a and b) depends\non the particular sequence of bottlenecks in the history of the population. Let covD [ta(i j) ,tb(i j) ]\ndenote the covariance conditional on the demographic history D. In the following, we average the\nconditional covariance over random demographic histories to obtain (see red lines in Fig. 1):\nhcovD [ta(i j),tb(i j) ]i = hhta(i j)tb(i j) |Di \u2212 hta(i j) |Dihtb(i j) |Dii\n= hta(i j)tb(i j) i \u2212 hhta(i j)|Di2 i ,\n\n(3)\n\nwhere h. . .|Di denotes the expectation conditional on the particular demographic history D. In\nthe second equality we have used that the expected times to the MRCA are the same for both loci.\nNote that the averaged conditional covariance is not the same as the unconditional covariance of\nthe times to the MRCA for the full process (given by hta(i j)tb(i j) i \u2212 hta(i j)i2 ).\nWe now derive an approximate expression for hcovD [ta(i j) ,tb(i j) ]i using the coalescent approximation (Kingman, 1982), valid in the limit of large population sizes. Thus, in the following\ncalculations, we assume N0 \u226b 1, and xN0 \u226b 1. As is usual in coalescent calculations, it is convenient to scale the rates p and q in the Wright-Fisher model by a suitable representative of the\npopulation size. Defining the rates \u03bb = pN0 , and \u03bbB = qxN0 allows us to express the probability\nfor two lines to coalesce between two consecutive bottlenecks as (1 + \u03bb )\u22121. Correspondingly, the\nprobability for two lines to coalesce during a single bottleneck is given by (1 + \u03bbB )\u22121 . The units of\ntime are chosen so that \u03c4 = \u230atN0 \u230b, we take R = 2N0 r as the scaled recombination rate as mentioned\nin the introduction. In these units we denote the population size at time t by N(t), indicating that\nin the limit of N0 \u2192 \u221e, t becomes a continuous variable.\nWe find the following expression for the term hhta(i j)|Dihtb(i j) |Dii \u2261 hhta(i j)|Di2 i, occurring\nin Eq. (3):\nhhta(i j) |Di2 i =\n\n\u03bbB (2x\u03bb + \u03bbB + 3) + x\u03bb (x\u03bb + x + 2) + 2\n.\n(\u03bb + \u03bbB + 1)(\u03bb + \u03bbB + 2)\n\n(4)\n\nDetails of the derivation of this result are summarised in Appendix A.\nIn order to evaluate the remaining term in Eq. (3), hta(i j)tb(i j) i, we adapt the method described\nby Eriksson and Mehlig (2004) for calculating the covariance of the times to the MRCA at two\nloci, to the present model of recurrent bottlenecks. As can be seen in Fig. 2c, d, there are only a\nsmall number of possible combinations of ancestral lines in gene genealogies of two loci for two\n7\n\n\fchromosomes. Thus, we can write down a Markov process for how states of the ancestral lines\nchange along the gene genealogy. The corresponding graph is shown in Fig. 3, where the vertices\nrepresent states (combinations of ancestral lines), and the edges represent transitions between the\nstates (the transition rates w ji from i to j are shown along the edges from i to j). The vertices\nlabeled by a prime correspond to states in a bottleneck.\nFollowing Eriksson and Mehlig (2004) we note that the expectation hta(i j)tb(i j) i is determined\nby a six-dimensional sub-graph of the graph shown in Fig. 3, consisting of the vertices 1, 2, 3, 1\u2032, 2\u2032 ,\nand 3\u2032 . Let M be the corresponding 6 \u00d7 6 transition matrix. Its off-diagonal elements are given by\nthe transition rates, w ji , from state i to state j. The diagonal elements Mii are equal to the negative\nsum of the rates of all edges leaving node i in the graph, i. e. Mii = \u2212 \u2211 j6=i M ji . At the present time\n(t = 0), the system is in state 1 in the graph. This is represented by the vector\nh\niT\nv= 1 0 0 0 0 0 ,\n\n(5)\n\nwhere T denotes the transpose. It is convenient to combine the transition rates w ji into vectors and\nmatrices as follows:\nh\ni\n\u22121\nu= 1 0 0 x\n0 0 ,\n\uf8ee\n\uf8f9\n0 2 2 0 0\n0\n\uf8fb,\nQ=\uf8f0\n\u22121\n\u22121\n0 0 0 0 2x\n2x\n\uf8f9\n\uf8ee\n\u22121\n\u03bbB x\n\u2212(\u03bb + 1)\n\uf8fb,\nK=\uf8f0\n\u03bb\n\u2212(\u03bbB + 1)x\u22121\ni\nh\n\u22121\n.\nc= 1 x\n\n(6)\n\nIn terms of these vectors and matrices we can write (Eriksson and Mehlig, 2004)\nhta(i j)tb(i j) i =\n\nZ \u221e\n0\n\ndt1 t12 u eMt1 v +\n\nZ \u221e\n0\n\ndt1\n\nZ \u221e\nt1\n\ndt2 t1t2 c eK(t2 \u2212t1 ) Q eMt1v ,\n\n(7)\n\nwhere t1 and t2 are the first and second coalescent events, respectively (i. e. min(ta(i j) ,tb(i j) ) and\nmax(ta(i j) ,tb(i j) )). The first term corresponds to a common MRCA of loci a and b (i. e. a transition\nfrom states 1 or 1\u2032 to state 5), and the second to different MRCA (transitions from states 2 or 3 to\nstate 4, or from states 2\u2032 or 3\u2032 to state 4\u2032 , followed by a transition to state 5). The matrix K describes\n8\n\n\fthe change in the population size due to recurrent bottlenecks, whereas the vector c contains the\ncoalescent rates in each population-size regime. Both M and K have negative real eigenvalues.\nHence, the integrals in Eq. (7) can be evaluated in terms of matrix inverses (Eriksson and Mehlig,\n2004):\n\b\nhta(i j)tb(i j) i = 2uu (\u2212M)\u22123 v + 2cc (\u2212K)\u22122 (\u2212K)\u22121 Q + Q (\u2212M)\u22121 (\u2212M)\u22122 v .\n\n(8)\n\nCombining Eqs. (4) and (8) yields\nhcovD [ta(i j) ,tb(i j) ]i =\n\nR3C3 + R2C2 + RC1 +C0\n,\nR4 D4 + R3 D3 + R2 D2 + RD1 + D0\n\n(9)\n\nwhere the coefficients Ci and Di are functions of parameters x, \u03bb and \u03bbB given in Appendix C.\nWe now discuss three special limits of this result. First, when the time to the first bottleneck\nis much longer than the expected times to the MRCA for two chromosomes at two loci in the\nlarge population-size regime (i. e. \u03bb \u226a 1), the subsequent bottlenecks are irrelevant to the mean\ncovariance. In this case, Eq. (9) reduces to Eq. (2), the expression valid in the case of constant\npopulation size with xeff = 1.\nSecond, assume that the population-size fluctuations are rapid compared to all other processes\n(this case is described by taking the limit \u03bb \u2192 \u221e and \u03bbB \u2192 \u221e in such a way that the ratio \u03bb /\u03bbB is\nkept constant). Keeping only the leading order of \u03bb and \u03bbB in the numerator and the denominator\nof (9) yields Eq. (2), with xeff = (x\u03bb + \u03bbB )/(\u03bb + \u03bbB ). This is the harmonic time average (1) of\nN\u03c4 /N0 in the recurrent bottleneck model.\nThird, we consider the case of severe bottlenecks (x \u226a 1). Because the expected duration of a\nbottleneck is given by x\u03bbB\u22121 , this regime implies that bottlenecks are typically of short duration.\nSuch demographic histories can occur during range expansions, where small groups of animals\nrepeatedly colonize new areas (examples of this kind are given in the introduction). This case can\nbe treated analytically by taking the leading order of x\u22121 in the numerator and denominator of\nEq. (9). We find:\nhcovD [ta(i j) ,tb(i j) ]i \u2248\n\nR2 A2 + RA1 + A0\n,\nR2 B2 + RB1 + B0\n\n(10)\n\nwhere Ai and Bi are functions of parameters \u03bb and \u03bbB given in Appendix C. Note that this function\n\n9\n\n\freaches a plateau for large values of R:\nhcovD [ta(i j) ,tb(i j) ]i \u2248\n=\n\nA2\nB2\n\n(11)\n\n2\u03bbB (1 + \u03bbB )\u03bb\n.\n(1 + \u03bbB + \u03bb )(2 + \u03bbB + \u03bb )(9(2 + \u03bb ) + \u03bbB (27 + 8\u03bb + \u03bbB (10 + \u03bbB + \u03bb )))\n\nThis expression implies long-range linkage disequilibrium since the right hand side does not depend upon R.\n\nIV. COMPARISON OF THE COALESCENT CALCULATIONS TO THE WRIGHT-FISHER SIMULATIONS\n\nIn order to further illustrate the role of the relevant time scales of genetic drift and recombination in shaping LD, we compare the full coalescent result, Eq. (9), and the different limiting cases\nconsidered in Section III, to the average covariance calculated from the Wright-Fisher simulations.\nThe comparisons are shown in Fig. 4.\nThe parameters used in Fig. 4a correspond to rapid population-size fluctuations (the second\nexample described in the previous section). As can be seen in Fig. 4a, the agreement between\nthe numerical result (red line) and the approximation (2) (dashed line) is good for a wide range of\nrecombination rates. A small disagreement appears at large values of R, more precisely at R \u2248 100.\nThis discrepancy is expected, as at such large recombination rates, the population-size fluctuations\nare no longer rapid compared to the process of recombination. In summary, in the case of rapid\npopulation-size fluctuations, the results of the Wright-Fisher simulations are well approximated\nby Eq. (2) as long as genetic recombination does not occur too frequently.\nFig. 4b shows results for parameters corresponding to severe bottlenecks (the third example\ndescribed in the previous section). As we noted already in the introduction, this case exhibits longrange linkage disequilibrium which cannot be accurately described by the effective populationsize approximation (2). We observe that the average covariance curve can be divided into three\nregions where the curve behaves qualitatively differently. First, for very small recombination\nrates, the covariance can be approximated using the harmonic average effective population size.\nThis is expected since, in this region, the population-size fluctuations are fast compared to the\nprocess of recombination. Second, the constant effective population-size approximation breaks\ndown when R \u2248 \u03bb = 10. For recombination rates larger than this value, by contrast, recombination\n10\n\n\foccurs frequently between bottlenecks but rarely within, and multiple coalescent events during\nbottlenecks become frequent. Since the bottlenecks are short in this regime, this may lead to longrange LD. In this regime, the covariance is approximated by Eq. (10). We observe that, for a\nlarge range of recombination rates, Eq. (10) is in excellent agreement with both the full coalescent\nresult, Eq. (9), and the simulations. Third, we see that the agreement between Eq. (10) and the\nfull coalescent result breaks down when recombination events can no longer be ignored in the\nbottlenecks (i. e. when R is of the same order as the rate of leaving a bottleneck, \u03bbB x\u22121 , or larger).\nFor still larger recombination rates, only the full coalescent result agrees with the Wright-Fisher\nsimulations. The slight deviations between the Wright-Fisher simulations and the coalescent result\n(9), visible in Fig. 4, are discussed in the concluding section.\n\nV. THE EFFECT OF RECURRENT BOTTLENECKS UPON \u03c3d2\n\nIn the previous sections we have shown how sustained population-size fluctuations in the form\nof recurrent bottlenecks give rise to long-range linkage disequilibrium, measured by the covariance (3) of the times to the MRCA. An important question is how such population-size fluctuations\naffect more common measures of linkage disequilibrium such as, for example, r\u03022 , and its approximation, \u03c3d2 (McVean, 2002; Ohta and Kimura, 1971). In this section we discuss the effect of\nrecurrent bottlenecks upon \u03c3d2 . While the covariance of the times to the MRCA is obtained by\ncomparing two chromosomes, the measure \u03c3d2 is computed in a large sample of chromosomes. In\nthe following we consider the limit of infinite sample size. In this limit, and in terms of the expectations and covariances conditional on the demographic history D, Eq. (9) in (McVean, 2002)\nbecomes:\n\n\u03c3d2 =\n\n*\n\ncovD [ta(i j) ,tb(i j) ] \u2212 2covD [ta(i j) ,tb(ik) ] + covD [ta(i j) ,tb(kl) ]\nhta(i j) |Di2 + covD [ta(i j) ,tb(kl) ]\n\n+\n\n.\n\n(12)\n\nAs before, a and b denote two loci, and i, j, k, and l refer to four different chromosomes in a large\nsample. The main properties of this measure are determined by how the numerator depends on the\nrecombination rate (McVean, 2002). In order to simplify the analysis, we therefore focus on the\nexpected value of the numerator, i. e.\nhcovD [ta(i j) ,tb(i j) ]i \u2212 2hcovD [ta(i j) ,tb(ik) ]i + hcovD [ta(i j) ,tb(kl) ]i.\n\n11\n\n\fThe covariance hcovD [ta(i j) ,tb(i j) ]i is given by Eq. (9). The covariances hcovD [ta(i j) ,tb(ik) ]i and\nhcovD [ta(i j) ,tb(kl) ]i can be calculated in the same way as Eq. (9) was obtained, but starting from\ndifferent initial conditions (Eriksson and Mehlig, 2004; McVean, 2002). In our Markov representation, this corresponds to taking v = [0 1 0 0 0 0]T and v = [0 0 1 0 0 0]T , respectively, in\nEq. (7).\nFig. 5 shows the relation between the covariances hcovD [ta(i j),tb(i j) ]i (blue lines),\nhcovD [ta(i j) ,tb(ik) ]i (red lines), and hcovD [ta(i j),tb(kl) ]i (green lines). As can be seen, in a region\nof low values of R each covariance is well approximated by the corresponding constant effective\npopulation-size approximation, as explained in Section III. Note that in the case shown in panel\nb, all three covariances exhibit a plateau at the same level, in approximately the same range of R\nvalues. Thus, the linear combination of covariances in the numerator of \u03c3d2 cancel an enhancement\nrelative to the effective population-size approximation. This is the reason why the plateau, present\nin each covariance, does not show in the numerator of \u03c3d2 . In other words, the information about\nthe sustained population-size fluctuations is not preserved in \u03c3d2 .\n\nVI. DISCUSSION\n\nThe aim of this paper was to provide an understanding on how sustained random populationsize fluctuations influence gene-history correlations. Our conclusions are based on both analytical\nand numerical calculations, which we find to agree well. Using the particular population-size\nmodel, depicted in Fig. 2a, we have derived an exact result for the covariance of the times to the\nMRCA of two loci, Eq. (9). We have discussed three particular limits of our result. First, if the\nexpected times to the MRCA of two loci are less than the expected time to the most recent bottleneck, our model reduces to the constant population-size model with the effective population size\nequal to the population size at the present time. Second, if the population size fluctuates much\nfaster than the remaining two processes (coalescence and recombination), the coalescent effective\npopulation-size approximation again works well, but with the effective population size given by\nthe harmonic average (1). These two cases are consistent with earlier findings of investigations\nof single-locus properties of populations which exhibit population-size variations (Eriksson et al.,\n2010; Sj\u00f6din et al., 2005). In the third case, bottlenecks are severe (large difference in population\nsizes in and between bottlenecks) and the time between bottlenecks is assumed to be brief. In this\ncase, the result of the simulations depends on the relation between the time scale of recombina12\n\n\ftion and the time scale of population-size changes. When recombination is the slowest process\n(i. e. when the recombination rate is sufficiently small), the coalescent effective population-size\napproximation (with the effective population size given by the harmonic average (1)) is a good\napproximation (this is essentially the same as in the second case). Conversely, when recombination is the fastest process, the covariance is approximately 1/R (same as in the first case). Finally,\nwhen recombination is intermediate, slow enough that recombination events during bottlenecks\nare rare, but fast enough to decorrelate gene genealogies between bottlenecks, the covariance exhibits a plateau. The plateau corresponds to an enhanced covariance of the times to the MRCA,\nwith respect to that expected in the effective constant population-size case. Thus, in this case, pairs\nof distant loci are expected to exhibit a high degree of linkage.\nThese conclusions rely on analysing covariances averaged over different demographic histories.\nThis raises the question how typical such averages are. In other words, how large are the fluctuations around the average? Fig. 1 shows that in the case of severe bottlenecks, the fluctuations\naround the mean covariance are much higher than, for example, in the case of fast population-size\nfluctuations. This can be explained as follows: in the case of severe bottlenecks, the times to the\nMRCA of both loci are determined by the time to the bottleneck that hosts two pairwise mergers\n(for very strong bottlenecks, this is simply the time to the first bottleneck).\nThe coalescent approximations employed in this paper assume large population sizes. While we\ngenerally find very good agreement between the coalescent approximations and the Wright-Fisher\ndynamics, we observe some deviations, in particular for severe bottlenecks and large recombination rates. The coalescent approximations assume that the time between two recombination events\nis exponentially distributed. However, this is only accurate in the limit of small recombination\nrates, r. Because the relevant parameter is R = 2N0 r, by increasing N0 we reach a better agreement\nbetween the corresponding analytical and numerical results in the range of values of R shown in\nFigs. 1 and 4. We have made additional simulations to confirm that this is the case (not shown).\nIt is worth mentioning that the result for the case of severe bottlenecks (x \u226a 1), Eq. (10),\ncan be understood in terms of the so-called Xi-coalescent approximation. Xi-coalescents form a\nbroad family of gene-genealogical models allowing for simultaneous multiple pairwise coalescent\nevents (mergers). The Kingman coalescent is a special case, allowing only for pairwise mergers.\nSee (M\u00f6hle and Sagitov, 2001; Schweinsberg, 2000) for detailed descriptions of the family of Xicoalescents. In the case of severe bottlenecks (x \u226a 1), coalescent events during a bottleneck may\nappear as simultaneous multiple mergers (as pointed out also by Birkner et al. (2009)). We show\n13\n\n\fin Appendix C how the Markov process with simultaneous multiple mergers is obtained in this\ncase, and compute the corresponding transition rates w ji . This provides an alternative way of\nderiving Eq. (10). More importantly, it provides insight into why the plateau forms. It turns out\nthat the plateau arises as a direct consequence of simultaneous multiple mergers. We note that\nthis means that long-range gene-history correlations are also expected in other situations where\nsimultaneous multiple mergers are important. Examples are populations with strongly skewed\nreproduction laws, or populations subject to selective sweeps.\nWe conclude with the observation that \u03c3d2 , a measure of LD, fails to show the plateaus present\nin its constituent covariances (this was observed already in (Eriksson and Mehlig, 2004) for the\ncase of a single, recent bottleneck). Because of the close link between \u03c3d2 and r\u03022 , a common measure of LD (McVean, 2002), this casts doubt on the suitability of such measures for characterising\nLD (another example is the measure HR2 (Sabatti and Risch, 2002)), in populations that may have\nbeen subject to recent population bottlenecks and range expansions. A more accurate approach, especially for detecting long-range LD, may be to estimate the covariance of the times to the MRCA\ndirectly. For example, simulations show that the covariance of the number of mutations in small\nwindows (e. g. a few hundred nucleotides long) can be used to estimate the covariance of the times\nto the MRCA (Eriksson and Mehlig, 2004). However, it remains to investigate which observables\nare most suitable for detecting long-range dependencies in the underlying gene genealogies for\nmore general demographic histories.\nAcknowledgements. Support by Swedish Research Council grants, the G\u00f6ran Gustafsson stiftelse, and by the Centre for Theoretical Biology at the University of Gothenburg are gratefully\nacknowledged. AE was supported by a Philip Leverhume Award and a Biotechnology and Biological Sciences Research Council grant (BB/H005854/1).\n\nReferences\nBirkner, M., Blath, J., M\u00f6hle, M., Steinr\u00fccken, M., Tams, J., 2009. A modified lookdown construction for\nthe xi-fleming-viot process with mutation and populations with recurrent bottlenecks. ALEA 6, 25\u201361.\nCrow, J. F., Kimura, M., 1970. An introduction to population genetics theory. Harper & Row, London,\ndiscussion of linkage equilibrium on p. 50.\nEriksson, A., Fernstrom, P., Mehlig, B., Sagitov, S., 2008. An accurate model for genetic hitchhiking.\nGenetics 178 (1), 439\u2013451.\n\n14\n\n\fEriksson, A., Mehlig, B., 2004. Gene-history correlation and population structure. Physical Biology 1, 220\u2013\n228.\nEriksson, A., Mehlig, B., Rafajlovic, M., Sagitov, S., 2010. The total branch length of sample genealogies\nin populations of variable size. Genetics 186, 601\u2013611\nEwens, W., 1982. The concept of the effective population size. Theor. Popul. Biol. 21, 373\u2013378.\nFisher, R. A., 1930/1999. The Genetical Theory of Natural Selection, variorum Edition. Oxford University\nPress.\nGriffiths, R. C., 1981. Neutral 2-locus multiple allele models with recombination. Theor. Pop. Biol. 19,\n169\u2013186.\nHill, W. G., Robertson, A., 1968. Linkage disequilibrium in finite populations. TAG Theoretical and Applied\nGenetics 38, 226\u2013231, 10.1007/BF01245622.\nURL http://dx.doi.org/10.1007/BF01245622\nHudson, R. R., 1983. Properties of a neutral allele model with intragenic recombination. Theoretical Population Biology 23, 183\u2013201.\nHudson, R. R., 1990. Gene genealogies and the coalescent process. Oxford Surveys in Evolutionary Biology\n7, 1\u201344.\nJagers, P., Sagitov, S., 2004. Convergence to the coalescent in populations of substantially varying size.\nJournal of Applied Probability 41 (1), 368\u2013378.\nJohannesson, K., 2003. Evolution in littorina: ecology matters. Journal of Sea Research 49 (2), 107\u2013117.\nKaj, I., Krone, S., 2003. The coalescent process in a population with stochastically varying size. J. Appl.\nProb. 40, 33\u201348.\nKingman, J. F. C., 1982. The coalescent. Stochastic Processes and their Applications 13, 235\u2013248.\nLiu, H., Prugnolle, F., Manica, A., Balloux, F., Aug 2006. A geographically explicit genetic model of\nworldwide human-settlement history. Am. J. Hum. Genet. 79 (2), 230\u20137.\nMcVean, G., 2002. A genealogical interpretation of linkage disequilibrium. Genetics 162, 987 \u2013 991.\nM\u00f6hle, M., Sagitov, S., 2001. A classification of coalescent processes for haploid exchangeable population\nmodels. Ann. Probab. 29, 156\u20132.\nMoran, P. A. P., 1958. Random processes in genetics. Proc. Cambridge Philos. Soc. 54, 60\u201371.\nNordborg, M., Krone, S., 2003. Modern Developments in Population Genetics: The Legacy of Gustave\nMal\u00e9cot. Oxford University Press, Oxford, pp. 194\u2013232.\nOhta, T., Kimura, M., 1971. Linkage disequilibrium between two segregating nucleotide sites under the\n\n15\n\n\fsteady flux of mutations in a finite population. Genetics 68 (4), 571\u2013580.\nRamachandran, S., Deshpande, O., Roseman, C., Rosenberg, N., Feldman, M., Cavalli-Sforza, L., Nov.\n2005. Support from the relationship of genetic and geographic distance in human populations for a serial\nfounder effect originating in Africa. Proceedings of the National Academy of Sciences of the United\nStates of America 102 (44), 15942\u201315947.\nSabatti, C., Risch, N., Apr 2002. Homozygosity and linkage disequilibrium. Genetics 160 (4), 1707\u201319.\nSagitov, S., 2003. Convergence to the coalescent with simultanous multiple mergers. J. Appl. Probab 36,\n1116\u20131125.\nSagitov, S., Mehlig, B., Rafajlovic, M., Eriksson, A., 2011. Coalescent algorithms for populations with\nskewed reproduction, recurrent bottlenecks and selective sweeps. In preparation.\nSchweinsberg, J., 2000. Coalescents with simultaneous multiple collisions. Electron. J. Probab. 5, 1\u201355.\nSj\u00f6din, P., Kaj, I., Krone, S., Lascoux, M., Nordborg, M., 2005. On the meaning and existence of an\neffective population size. Genetics 169 (2), 1061\u20131070.\nTanabe, K., Mita, T., Jombart, T., Eriksson, A., Horibe, S., Palacpac, N., Ranford-Cartwright, L., Sawai, H.,\nSakihama, N., Ohmae, H., Nakamura, M., Ferreira, M. U., Escalante, A. A., Prugnolle, F., Bj\u00f6rkman, A.,\nF\u00e4rnert, A., Kaneko, A., Horii, T., Manica, A., Kishino, H., Balloux, F., Jul 2010. Plasmodium falciparum\naccompanied the human expansion out of Africa. Curr Biol 20 (14), 1283\u20139.\nWakeley, J., Sargsyan, O., 2009. Extensions of the coalescent effective population size. Genetics 181, 341\u2013\n345.\nWright, S., 1931. Evolution in Mendelian populations. Genetics 16, 97\u2013159.\nWright, S., 1938. Size of a population and breeding structure in relation to evolution. Science 87, 430\u2013431.\n\n16\n\n\fAppendix A: Calculation of hhta(i j) |Di2 i\n\nIn this Appendix we calculate hhta(i j) |Di2 i using a recursion. The resulting expression for\nhhta(i j) |Di2 i was used in evaluating Eq. (3). In the Wright-Fisher model, let \u03be and \u03beB be the\nexpected times to the MRCA (i. e. N0 hta(i j) |Di, as in Section III) for bottleneck sequences starting\noutside and in the bottleneck, respectively. Furthermore, let y = N0\u22121 and yB = (xN0 )\u22121 (note that\nyy\u22121\nB = x). Furthermore, let \u03b7 and \u03b7B be independent stochastic variables which are unity with\nprobability p and q, respectively, and are zero otherwise. We have\n\n\u03be = 1 + (1 \u2212 y)[(1 \u2212 \u03b7 )\u03be \u2032 + \u03b7\u03beB\u2032 ] ,\n\u03beB = 1 + (1 \u2212 yB )[(1 \u2212 \u03b7B )\u03beB\u2032 + \u03b7B \u03be \u2032 ] ,\n\n(A1)\n\nwhere \u03be \u2032 and \u03beB\u2032 have the same distribution as \u03be and \u03beB , respectively, but are statistically independent. Taking the expected value of both sides, one obtains a linear system of equations for h\u03be i and\nh\u03beB i. Solving this system yields\np(1 \u2212 y) + q(1 \u2212 yB ) + yB\n,\nyyB + pyB (1 \u2212 y) + qy(1 \u2212 yB )\np(1 \u2212 y) + q(1 \u2212 yB ) + y\n.\nh\u03beB i =\nyyB + pyB (1 \u2212 y) + qy(1 \u2212 yB )\nh\u03be i =\n\n(A2)\n(A3)\n\nIn order to calculate hta(i j) |Di2 , we use Eq. (A1) to write:\n\n\u03be 2 = 1 + 2(1 \u2212 y)[(1 \u2212 \u03b7 )\u03be \u2032 + \u03b7\u03beB\u2032 ] + (1 \u2212 y)2(1 \u2212 \u03b7 )2 \u03be \u20322 + (1 \u2212 y)2 \u03b7 2 \u03beB\u20322 ,\n\u03beB2 = 1 + 2(1 \u2212 yB )[(1 \u2212 \u03b7B )\u03beB\u2032 + \u03b7B \u03be \u2032 ] + (1 \u2212 yB )2 (1 \u2212 \u03b7B )2 \u03beB\u20322 + (1 \u2212 yB )2 \u03b7B2 \u03be \u20322 .\n\n(A4)\n\nNote that the terms containing \u03be \u2032 \u03beB\u2032 are absent because they contain factors \u03b7 (1 \u2212 \u03b7 ) or \u03b7B (1 \u2212\n\n\u03b7B ), and \u03b7 and \u03b7B are either zero or unity. Taking the expected value of both sides of these\nequations, and using the property of independence, one again obtains a linear system that can be\nsolved for h\u03be 2 i and h\u03beB2 i:\nh\u03be 2 i = 1 + 2(1 \u2212 y)[(1 \u2212 p)h\u03be i + ph\u03beBi] + (1 \u2212 y)2 (1 \u2212 p)h\u03be 2i + (1 \u2212 y)2 ph\u03beB2 i ,\nh\u03beB2 i = 1 + 2(1 \u2212 yB )[(1 \u2212 q)h\u03beBi + qh\u03be i] + (1 \u2212 yB)2 (1 \u2212 q)h\u03beB2i + (1 \u2212 yB )2 qh\u03be 2 i .\n\n17\n\n(A5)\n\n\fTo leading order in N0\u22121 , the solution to Eq. (A5) is:\nh\u03be 2 i = N02 hhta(i j) |Di2 i = N02\n\n\u03bbB (\u03bbB + 3 + 2\u03bb x) + \u03bb x(\u03bb x + x + 2) + 2\n.\n(\u03bbB + \u03bb + 1) (\u03bbB + \u03bb + 2)\n\n(A6)\n\nEq. (A6) corresponds to the result (4) given in Section III. Alternatively, Eq. (A6) can be derived\nusing Eq. (20) in (Eriksson et al., 2010).\n\nAppendix B: Coefficients Ci , Di , Ai , Bi in formulae (9) and (10)\n\nIn this Appendix we list the coefficients appearing in Eqs. (9) and (10). The coefficients appearing in Eq. (9) are given by:\nC0 =36x5 (\u03bbB + \u03bb + 3) (\u03bbB + \u03bb + 6) (\u03bbB (\u03bbB (\u03bbB + 2x\u03bb + \u03bb + 4)\n+ \u03bb (x((x + 2)\u03bb + x + 6) + 1) + 5) + x\u03bb (x(\u03bb + 1)(\u03bb + 3) + 2) + 2) ,\nC1 =2x5 (\u03bbB (\u03bbB (\u03bbB (\u03bbB (\u03bbB + 3x(\u03bb + 9) + 2\u03bb + 13) + (3x(x + 2) + 1)\u03bb 2\n+ (x(55x + 76) + 29)\u03bb + 252x + 59) + x3 \u03bb (\u03bb + 1)(\u03bb + 27)\n+ 2x2 \u03bb (\u03bb (3\u03bb + 58) + 213) + x(\u03bb (\u03bb (3\u03bb + 80) + 370) + 801) + 2\u03bb (8\u03bb + 55) + 119)\n+ x3 \u03bb (\u03bb + 1)(\u03bb + 21)(2\u03bb + 9) + x2 \u03bb (\u03bb (\u03bb (3\u03bb + 76) + 452) + 903)\n+ x(\u03bb (\u03bb (31\u03bb + 226) + 647) + 1044) + (3\u03bb + 4)(5\u03bb + 27))\n+ x(\u03bb (x2 (\u03bb + 1)(\u03bb + 3)(\u03bb + 6)(\u03bb + 15) + x(5\u03bb + 18)(\u03bb (3\u03bb + 16) + 33)\n+ 44\u03bb + 270) + 468) + 18(\u03bb + 2)) ,\nC2 =x5 (\u03bbB (\u03bbB (x\u03bbB (3\u03bbB + 2x(4\u03bb + 9) + 4(\u03bb + 7)) + x(x2 \u03bb (7\u03bb + 39)\n+ 10x(\u03bb (\u03bb + 7) + 9) + \u03bb (\u03bb + 25) + 89) + 4\u03bb )\n+ x(2x3 \u03bb (\u03bb + 1)(\u03bb + 9) + x2 \u03bb (\u03bb (8\u03bb + 65) + 129)\n+ 2x(\u03bb + 2)2 (\u03bb + 18) + \u03bb (9\u03bb + 55) + 116) + 4\u03bb )\n+ x(x(\u03bb (2x2 (\u03bb + 1)(\u03bb + 3)(\u03bb + 6) + x(\u03bb (\u03bb (\u03bb + 22) + 83) + 102)\n+ 4\u03bb 2 + 42\u03bb + 96) + 72) + 26(\u03bb + 2))) ,\nC3 =x7 (\u03bbB + \u03bb + 2) (\u03bbB (\u03bbB + 2x\u03bb + 3) + x\u03bb (x\u03bb + x + 2) + 2) ,\n\n18\n\n(B1)\n\n\fD0 =36x5 (\u03bbB + \u03bb + 1) 2 (\u03bbB + \u03bb + 2) (\u03bbB + \u03bb + 3) (\u03bbB + \u03bb + 6) ,\nD1 =2x5 (\u03bbB + \u03bb + 1)(\u03bbB + \u03bb + 2)(\u03bbB (\u03bbB (13\u03bbB + 13(x + 2)\u03bb + 27x + 130)\n+ 13(2x + 1)\u03bb 2 + 157(x + 1)\u03bb + 9(19x + 39))\n+ 13x(\u03bb + 1)(\u03bb + 3)(\u03bb + 6) + 9(\u03bb + 2)(3\u03bb + 13)) ,\nD2 =x5 (\u03bbB + \u03bb + 1)(\u03bbB + \u03bb + 2)(\u03bbB (\u03bbB (2\u03bbB + 4x\u03bb + 39x + 2\u03bb + 20)\n+ x(2x(\u03bb (\u03bb + 8) + 9) + 4\u03bb 2 + 86\u03bb + 247) + 16\u03bb + 54)\n+ 2x2 (\u03bb + 1)(\u03bb + 3)(\u03bb + 6) + 13x(\u03bb + 2)(3\u03bb + 13) + 18(\u03bb + 2)) ,\nD3 =x6 (\u03bbB + \u03bb + 1) (\u03bbB + \u03bb + 2) 2 (3\u03bbB + x(3\u03bb + 13) + 13) ,\nD4 =x7 (\u03bbB + \u03bb + 1) (\u03bbB + \u03bb + 2) 2 .\n\n(B2)\n\nThe coefficients appearing in Eq. (10) are given by:\nA0 =18(\u03bbB + 1) (\u03bbB + \u03bb + 3) (\u03bbB + \u03bb + 6) (\u03bbB (\u03bbB + \u03bb + 3) + 2) ,\n\u0010\n\u0011\n\u0001\nA1 = (\u03bbB + 1) \u03bbB \u03bbB (\u03bbB2 + 2(\u03bb + 6)\u03bbB + \u03bb (\u03bb + 27) + 47) + \u03bb (15\u03bb + 83) + 72 + 18(\u03bb + 2) ,\nA2 =2\u03bbB (\u03bbB + 1)\u03bb ,\n\nB0 =18 (\u03bbB + \u03bb + 1) 2 (\u03bbB + \u03bb + 2) (\u03bbB + \u03bb + 3) (\u03bbB + \u03bb + 6) ,\n\u0010\n\u0011\n\u0001\nB1 = (\u03bbB + \u03bb + 1) (\u03bbB + \u03bb + 2) \u03bbB 13\u03bbB (\u03bbB + 2(\u03bb + 5)) + \u03bb (13\u03bb + 157) + 351 + 9(\u03bb + 2)(3\u03bb + 13) ,\nB2 = (\u03bbB + \u03bb + 1) (\u03bbB + \u03bb + 2) (\u03bbB (\u03bbB (\u03bbB + \u03bb + 10) + 8\u03bb + 27) + 9(\u03bb + 2)) .\n\n(B3)\n\nAppendix C: Severe bottlenecks: connection to the Xi-coalescent\n\nIn this Appendix, we turn our attention to a special case of population-size fluctuations: recurrent severe bottlenecks, that is x \u2192 0. As we now show, single-locus gene genealogies in this limit\nare well approximated by the Xi-coalescent approximation (see also (Sagitov et al., 2011)).\nConsider fixed values of \u03bb and \u03bbB and take the limit of x \u2192 0. Recall that the rate of leaving\na bottleneck is given by x\u22121 \u03bbB . Thus, as x is being decreased, and \u03bbB is kept constant, the time\nbetween coalescent events hosted by a single bottleneck becomes shorter, ultimately leading to a\nfailure of the Kingman coalescent approximation. In the limit of x \u2192 0, multiple pairwise mergers\n\n19\n\n\fin a bottleneck appear as a single simultaneous multiple merger. It turns out that one-locus gene\ngenealogies in this case are well approximated by the Xi-coalescent approximation.\nWe show here that, in the case of severe bottlenecks, applying the Xi-coalescent approximation\nyields Eq. (10) for the mean covariance hcovD [ta(i j) ,tb(i j) ]i. Our method for calculating the term\nhta(i j)tb(i j) i is described in the main text (see Eq. (7) in Section III). But in the Xi-coalescent\napproximation, described in this appendix, the Markov process is different than the one described\nin Section III. The corresponding graph is shown in Fig. 6. It consists of the same five states\n1, . . ., 5 shown in Fig. 3, but in Fig. 6 the states in bottlenecks are omitted, since the time system\nspends in a single bottleneck is short. The corresponding transition rates, w ji , from state i to j, are\nlisted in Fig. 6. In the following, we show how the rates w ji can be derived using the Xi-coalescent\napproximation. These rates determine the matrix M, and vectors u , and Q , as well as K and c,\nappearing in Eq. (7).\n\n1. Formulae for w ji under the Xi-coalescent approximation\n\nIn a severe bottleneck, l incoming lines are allowed to coalesce almost instantaneously into\nb \u2264 l \u2212 1 outgoing lines. Note that in Kingman's coalescent case one has b = l \u2212 1. In the Xicoalescent, by contrast, l lines are partitioned into b families, such that ki families are of size\ni = 1, . . . , l (see an illustration in Fig. 7). By construction, the following condition must be satisfied:\nl\n\nl\n\nl = \u2211 iki , b = \u2211 ki .\n\n(C1)\n\ni=1\n\ni=1\n\nIn our model, the collision rate \u03c6{l;k1 ,...,kl } of l lines colliding into a particular partition\n{l; k1 , . . . , kl }, such that Eq. (C1) is satisfied, is given by:\n\n\u03c6{l;k1 ,...,kl } = 1{b=l\u22121} + \u03bb \u039e{l;k1 ,...,kl }\n\n(C2)\n\nwhere the first term stands for the Kingman coalescent, and the second term corresponds to the\ncontribution from multiple mergers which occur at a rate \u03bb . Given the probability, Clb , that during\na bottleneck l lines collide into b lines, \u039e{l;k1 ,...,kl } can be calculated according to:\n\u039e{l;k1 ,...,kl } = Clb p{l;k1 ,...,kl } .\n\n20\n\n\fwhere p{l;k1 ,...,kl } is the probability of observing a particular partition {l; k1 , . . ., kl } of l lines. As\nshown by Kingman (1982), it is given by:\n(l \u2212 b)!b!(b \u2212 1)! l\np{l;k1 ,...,kl } =\n(i!)ki .\n\u220f\nl!(l \u2212 1)!\ni=1\nThe probability Clb is calculated as follows. Assume that l lines enter a bottleneck. The probability that the bottleneck hosts l \u2212 b coalescent events can be obtained in two steps. First, the\ntotal coalescent time needed to arrive from l to b lines should be less than or equal to the duration\nof the bottleneck. Second, the arrival at a state with b \u2212 1 lines must occur after the end of the\nbottleneck. For simplicity, we choose here to measure time in units of the population size during\nthe bottleneck so that the coalescent rate is unity as in the standard coalescent case. In these units,\nthe time in the bottleneck is exponentially distributed, with the parameter \u03bbB . Accordingly, the\nfollowing expression for Clb is obtained:\nl\n\u03bbB\nClb = b\u0001\n\u220f\n2 + \u03bbB i=b+1\n\ni\u0001\n2\n\ni\u0001\n2 + \u03bbB\n\n.\n\nThe rate \u03c6{l;k1 ,...,kl } , given in Eq. (C2), is conditional on a particular partition. Thus the total\ncollision rate of l lines into any of partitions of type {l; k1 , . . . , kl } is given by:\ntot\n\u03c6{l;k\n1 ,...,kl }\n\n\u0012 \u0013\nl\n1\n+ \u03bb Clb p{l;k1 ,...,kl } S{l;k1 ,...,kl } ,\n=\n2 {b=l\u22121}\n\n(C3)\n\nwhere S{l;k1 ,...,kl } denotes the number of possible ways of collisions of l lines into a partition\n{l; k1 , . . . , kl }, such that restrictions in Eq. (C1) hold. It is given by (Sagitov, 2003):\nS{l;k1 ,...,kl } =\n\nl!\n\u220fli=1 (i!)ki ki !\n\n.\n\nIt follows from the latter expression that in the case of the standard coalescent, one has\n\u0001\nS{l;l\u22122,1,0...,0} = 2l , as expected.\nThe graph corresponding to the Markov process in the limit described in the beginning of\n\nthis appendix, consists of five states 1, . . . , 5 (see Fig. 6). We now show how the corresponding\ntransition rates between states 1, . . . , 5 can be derived from Eq. (C3).\nWe observe that a collision of type {2; 0, 1} describes a transition from either state 1 or 4, to 5.\n\n21\n\n\fIt follows:\ntot\nw51 = w54 = \u03c6{2;0,1}\n.\n\n(C4)\n\nState 2 consists of three chromosomal lines. A collision of a particular pair of lines, among the\nthree lines, results in a transition from 2 to 1, while a collision of either of the two remaining pairs\nof lines results in a transition from 2 to 4. Because a collision of a pair of lines among three lines\nis of type {3; 1, 1, 0}, we obtain the corresponding transition rates:\n1 tot\nw12 = \u03c6{3;1,1,0}\n,\n3\n2 tot\n.\nw42 = \u03c6{3;1,1,0}\n3\n\n(C5)\n(C6)\n\nA collision of all three lines of state 2 leads to a transition from state 2 to 5 at the rate:\ntot\nw52 = \u03c6{3;0,0,1}\n.\n\n(C7)\n\nNow consider transitions from state 3. It consists of four ancestral lines. We analyse first a collision\nof a single pair of lines, that is a collision of type {4; 2, 1, 0, 0}. There are in total six different ways\nto pair lines: four choices describe a transition from state 3 to 2, and the remaining two lead to a\ntransition from 3 to 4. Thus, we have:\n2 tot\n.\nw23 = \u03c6{4;2,1,0,0}\n3\n\n(C8)\n\nFurther, there are three possibilities for simultaneous collisions of two pairs of lines. Two possibilities result in a transition from 3 to 1, and one leads to a transition from 3 to 5 (see Fig. 2d).\nIt is also possible to obtain a collision of three lines, in which case the transition from 3 to 4 is\nobserved. Further, a collision of all four lines results in a transition from 3 to 5. Thus, we obtain\nthe following transition rates:\n2 tot\n,\nw13 = \u03c6{4;0,2,0,0}\n3\n1 tot\ntot\nw43 = \u03c6{4;2,1,0,0}\n+ \u03c6{4;1,0,1,0}\n,\n3\n1 tot\ntot\n+ \u03c6{4;0,0,0,1}\n.\nw53 = \u03c6{4;0,2,0,0}\n3\n\n22\n\n(C9)\n(C10)\n(C11)\n\n\fThe remaining non-vanishing rates, w21 = R, and w32 = R/2, describe recombination transitions\nfrom state 1 to 2, and from 2 to 3.\ntot\nIn Tab. I, we summarise the formulae for p{l;k1 ,...,kl } , S{l;k1 ,...,kl } , Clb , and \u03c6{l;k\n, for\n1 ,...,k }\nl\n\nl = 2, 3, 4 lines. Using the formulae in this table, the transition rates under the Xi-coalescent\napproximation can be calculated explicitly, in terms of the parameters \u03bb , \u03bbB , and x.\n\n2. Obtaining Eq. (10) under the Xi-coalescent approximation\n\nThe transition rates w ji , obtained in the previous subsection, can be used for calculating\nhta(i j)tb(i j) i according to the method explained in Section III. This calculation requires the elements of the 3 \u00d7 3 matrix M. We find that the non-zero off-diagonal elements of M are given\nby:\nM12 = 1 + \u03bb \u03bbB (1 + \u03bbB )(3 + \u03bbB )\n\n\u0001\u22121\n\n,\n\nM13 = 4\u03bb \u03bbB (1 + \u03bbB )(3 + \u03bbB )(6 + \u03bbB )\nM21 = 2M32 = R ,\nM23 = 4 + 4\u03bb \u03bbB (3 + \u03bbB )(6 + \u03bbB )\n\n\u0001\u22121\n\n\u0001\u22121\n\n.\n\n,\n\n(C12)\n\nand the diagonal elements are given by:\nMii = \u2212 \u2211 M ji , for i = 1, 2, 3 .\nj6=i\n\n23\n\n(C13)\n\n\fFurther:\n\uf8ee\n\n1 + \u03bb (1 + \u03bbB\n\n\uf8f9T\n\n)\u22121\n\n\uf8ef\n\uf8ef\nu=\uf8ef\n\uf8f0\n\n2\u03bb (9 + \u03bbB ) (1 + \u03bbB )(3 + \u03bbB )(6 + \u03bbB )\n\n\uf8ef\n\uf8ef\nQ=\uf8ef\n\uf8f0\n\n\uf8fa\n\uf8fa\n\uf8fa ,\n2(1 + \u03bb \u03bbB (1 + \u03bbB )(3 + \u03bbB ) )\n\u0001\u22121 \uf8fb\n2(1 + \u03bb \u03bbB (7 + \u03bbB ) (1 + \u03bbB )(3 + \u03bbB )(6 + \u03bbB ) )\n\n\uf8ee\n\n3\u03bb (1 + \u03bbB )(3 + \u03bbB )\n\n0\n\n\u0001\u22121\n\n\uf8fa\n\uf8fa\n\uf8fa ,\n\u0001\u22121 \uf8fb\n\n\u0001\u22121\n\n\uf8f9T\n\nK = \u22121 ,\nc=1.\n\n(C14)\n\nNote that M, u , Q , K and c have dimensions different from those in Section III. The reason is\nthat in the limit x \u2192 0, the case described in this appendix, the states in bottlenecks are omitted.\nCombining Eq. (7) with Eqs. (C12)-(C14) yields Eq. (10). This shows that the covariance of\nthe times to the MRCA in the case of severe bottlenecks can be derived using the Xi-coalescent\napproximation.\n\n24\n\n\fAppendix: Figures\n\n25\n\n\fcovD [ta(i j),tb(i j) ]\n\nPSfrag replacements\n\nc\nd\n\na\n\n0.1\n0.01\n\n0.01\n\n0.001\n\n0.001\n\n0.0001\n\n0.0001\n\n0.00001\n0.1\n\n10\n\n1000\n\nb\n\n0.1\n\n100000\n\nR\n\n0.00001\n0.1\n\n10\n\n1000\n\n100000\n\nR\n\nFIG. 1 The covariance of the times to the MRCA at two loci, in a sample of two chromosomes in a\npopulation subject to repeated bottlenecks (details in Section II). (a) Rapid population-size fluctuations.\nFisher-Wright simulations for ten random population-bottleneck sequences with \u03bb = 100, x = 0.1, \u03bbB = 10,\nand N0 = 105 (grey lines). Each grey line is obtained by first generating a random sequence of bottlenecks,\nand then averaging over an ensemble of 1000 gene genealogies. The red line shows the covariance averaged\nover demographic histories. The dashed line shows the result of the effective population-size approximation,\nEq. (2). (b) Same, but for severe bottlenecks. Fisher-Wright simulations for fifteen randomly generated\nsequences of bottlenecks, with parameters \u03bb = 10, x = 5 * 10\u22124 , \u03bbB = 10, and N0 = 106 . Averaging is done\nover an ensemble of 100 gene genealogies.\n\n26\n\n\ffrag replacements\n\na\n\nb\n\nN0\nN(t)\n\nN(t)\n\nN0\nxN0\n\nExp(\u03bb )\n\nExp(\u03bbx )\nxN0\nt\n\n0\n\nt\n\n0\n\nc\n\nd\n\nPeriod of low\npopulation size\nAncestral line\nChromosome\nLocus a\nMRCA of locus a\nLocus b\n\nal not ancestral\n\nMRCA of locus b\nMaterial not ancestral\n\n1\n\n2\n\n4\n\n5\n\n1\n\n2\n\n3\n\n5\n\nto loci a and b\n\nFIG. 2 Panels a and b show two realisations of the population-size curve, N(t), backwards in time (t = 0\ndenotes the present time). Initially, the population size is N0 . Going backwards in time, the population size\nrandomly jumps between two values, N0 and xN0 (x < 1), with the transition rates \u03bb (from N0 to xN0 ) and\n\u03bbx \u2261 x\u22121 \u03bbB (from xN0 to N0 ). Panels c and d show schematically corresponding ancestral histories of two\nloci (blue and red empty circles correspond to two loci, called a and b) subject to genetic recombination\nin a sample of two chromosomes. The yellow background depicts a time during which a population was\nsubject to a bottleneck. Two joint circles depict two loci in the same chromosome. States 1, . . . , 5 denote\nthe possible states of the system (they are explained in detail in Fig. 3). Grey circles denote genetic material\nnot ancestral to the sampled loci. Blue and red filled circles indicate that the corresponding loci have found\ntheir most recent common ancestor. Note that bottlenecks can host multiple coalescent events (mergers). In\nthe case of severe bottlenecks such multiple mergers appear as if instantaneous on the time scale of the gene\ngenealogy. An example is shown in panel d: an almost instantaneous transition from state 3 to state 5.\n\n27\n\n\fPSfrag replacements\n\n5\n\nx\u22121\n2x \u22121\n\n4'\n\n\u03bbx\n\n1\n\n1\n\n\u03bb\n\ngroup\n1, 1\u2032\n\nx\u22121\n\n\u03bbx\n\n1'\n\n1\n\n4\n\n2\n\n2x\u22121\n\n2\n\nR/2\n\n\u03bbx\n\n\u03bb\n\n3\n\n3'\n\n2, 2\u2032\n\n\u03bb\n\nR\n\n4\nR/2\n4x\u22121\n\nR\n\n1\n\n2\n\n\u03bb\n\nx\u22121\n\n3, 3\u2032\n4, 4\u2032\n\n\u03bbx\n2'\n\n5\n\nstate\nai bi , a j b j\nai b j , a j bi\nai \u25e6, \u25e6bi , a j b j\nai bi , a j \u25e6, \u25e6b j\nai \u25e6, \u25e6b j , a j bi\nai b j , a j \u25e6, \u25e6bi\nai \u25e6, \u25e6bi , a j \u25e6, \u25e6b j\nai \u2022, a j \u2022\n\u2022bi , \u2022b j\n\u2022\u2022\n\nFIG. 3 Left: a graph showing the states and transition rates determining the ancestral history of two loci\nin a sample of two chromosomes, under the population model introduced in Section II. States where the\npopulation is in a bottleneck are marked with a prime. The final state is denoted by 5 (in this state it does\nnot matter whether the population is in a bottleneck or not). Arrows indicate transitions between states. The\ncorresponding transition rates from state i to j, w ji , are displayed next to the lines. Note that \u03bbx \u2261 \u03bbB x\u22121 .\nRight: a table of possible states of the system. Two loci considered are denoted by a and b, and the\ncorresponding chromosomes are indicated by i and j. Empty circles denote genetic material not ancestral\nto sampled loci, and full circles denote the MRCA of a locus.\n\n28\n\n\fhcovD [ta(i j) ,tb(i j) ]i\n\nPSfrag replacements\n\nc\nd\n\na\n\n0.1\n0.01\n\n0.01\n\n0.001\n\n0.001\n\n0.0001\n\n0.0001\n\n0.00001\n0.1\n\n10\n\n1000\n\nb\n\n0.1\n\n100000\n\nR\n\n0.00001\n0.1\n\n10\n\n1000\n\n100000\n\nR\n\nFIG. 4 The covariance of the times to the MRCA of two loci averaged over random population-size histories. (a) The red line shows the average covariance corresponding to \u03bb = 100, x = 0.1, \u03bbB = 10, and\nN0 = 105 , determined numerically from Fisher-Wright simulations (same as in Fig. 1a). The solid lines\nshow our exact result, Eq. (9), and the dashed lines show the coalescent effective population-size approximation, Eq. (2). The numerical result deviates from the effective population-size approximation when the\nrecombination time-scale is the smallest (R > 100). (b) The same as in a, but for the short bottleneck\ncase: \u03bb = 10, x = 5 * 10\u22124 , \u03bbB = 10, and N0 = 106 . The dashed-dotted line denotes the result of Eq. (10),\ncorresponding to the Xi-coalescent approximation.\n\n29\n\n\fSfrag replacements\n\n100\n\n100\n\nhcovD [ta,tb ]i\n\na\n\nb\n\n10\u22122\n\n10\u22122\n\n10\u22124\n\n10\u22124\n\n10\u22126 \u22122\n10\n\n100\n\n102\n\nR\n\n104\n\n10\u22126 \u22122\n10\n\n106\n\n100\n\n102\n\nR\n\n104\n\n106\n\nFIG. 5 The relation between the covariances hcovD [ta(i j) ,tb(i j) ]i (blue lines), hcovD [ta(i j) ,tb(ik) ]i (red lines),\nand hcovD [ta(i j) ,tb(kl) ]i (green lines). In panels a and b, the values of the parameters \u03bb , \u03bbB , and x, are the\nsame as in Fig. 1a and Fig. 1b, respectively. Exact results are shown as solid lines, whereas results obtained\nwithin the effective population-size approximation are shown as dashed lines.\n\n30\n\n\fw12 = 1 + \u03bb \u03bbB (1 + \u03bbB )(3 + \u03bbB)\n\n5\n4\n\n3\n\n1\n\n2\n\n\u0001\u22121\n\n\u0001\u22121\nw13 = 4\u03bb \u03bbB (1 + \u03bbB )(3 + \u03bbB )(6 + \u03bbB )\nw21 = 2w32 = R\n\u0001\u22121\nw23 = 4(1 + \u03bb \u03bbB (3 + \u03bbB )(6 + \u03bbB ) )\n\u0001\u22121\nw42 = 2(1 + \u03bb \u03bbB (1 + \u03bbB )(3 + \u03bbB ) )\n\nw43 = 2(1 + \u03bb \u03bbB (7 + \u03bbB ) (1 + \u03bbB )(3 + \u03bbB )(6 + \u03bbB )\nw51 = w54 = 1 + \u03bb (1 + \u03bbB )\u22121\n\u0001\u22121\nw52 = 3\u03bb (1 + \u03bbB )(3 + \u03bbB )\n\nw53 = 2\u03bb (9 + \u03bbB ) (1 + \u03bbB )(3 + \u03bbB )(6 + \u03bbB)\n\n\u0001\u22121\n\n)\n\n\u0001\u22121\n\nFIG. 6 Left: a graph showing the states of the system in the limit x \u2192 0, and possible transitions between\nthem. States 1, . . . , 5 are explained in Fig. 3. Note that in this graph three colored arrows appear, denoting\nthe simultaneous multiple mergers. They appear in this case because of the short time the system spends\nin a single bottleneck (see Fig. 2b). By contrast, they are forbidden in the constant population-size case.\nRight: exact formulae for the transition rates, w ji , from i to j (the corresponding entries of the matrix M,\nand vectors u , and Q are calculated using these rates) in terms of the parameters \u03bb and \u03bbB .\n\n31\n\n\fa\nN(t)\n\nN0\n\nPSfrag replacements\n\nxN0\npresent\n\nt b\n\nl=4\n\nb=1\n\nFIG. 7 (a) Realisation of a population-size history curve, N(t). (b) Partition of ancestral lines. Shown\nis a collision of l = 4 lines (at the entrance of the bottleneck, indicated by the yellow background), into\nb = 1 line. When the bottleneck is short, the three pairwise mergers during the bottleneck appear as a single\ninstantaneous event.\n\n32\n\n\fAppendix: Tables\n\n33\n\n\fC21 =\n\n1\n1+\u03bbB\n\np{2;0,1} = 1\n\nS{2;0,1} = 1\n\nC31 =\n\n3\n(1+\u03bbB )(3+\u03bbB )\n3\u03bbB\n(1+\u03bbB )(3+\u03bbB )\n18\n(1+\u03bbB )(3+\u03bbB )(6+\u03bbB )\n18\u03bbB\n(1+\u03bbB )(3+\u03bbB )(6+\u03bbB )\n\np{3;0,0,1} = 1\n\nS{3;0,0,1} = 1\n\n1\n3\n\nS{3;1,1,0} = 3\n\nC32 =\nC41 =\nC42 =\n\np{3;1,1,0} =\n\np{4;0,0,0,1} = 1\n\nS{4;0,0,0,1} = 1\n\n1\n6\n1\n9\n1\n6\n\nS{4;1,0,1,0} = 4\n\np{4;1,0,1,0} =\np{4;0,2,0,0} =\n\nC43 =\n\n6\u03bbB\n(3+\u03bbB )(6+\u03bbB )\n\np{4;2,1,0,0} =\n\nS{4;0,2,0,0} = 3\nS{4;2,1,0,0} = 6\n\ntot\n= 1 + 1+\u03bb\u03bb\n\u03c6{2;0,1}\nB\n\n3\u03bb\n(1+\u03bbB )(3+\u03bbB )\n\u03bbB\ntot\n= 3 + (1+\u03bb3\u03bb)(3+\n\u03c6{3;1,1,0}\n\u03bbB )\nB\n18\u03bb\ntot\n\u03c6{4;0,0,0,1} = (1+\u03bbB )(3+\u03bbB )(6+\u03bbB )\n12\u03bb \u03bbB\ntot\n= (1+\u03bb )(3+\n\u03c6{4;1,0,1,0}\n\u03bbB )(6+\u03bbB )\nB\n6\u03bb \u03bbB\ntot\n= (1+\u03bb )(3+\n\u03c6{4;0,2,0,0}\n\u03bbB )(6+\u03bbB )\nB\n6\u03bb \u03bbB\ntot\n\u03c6{4;2,1,0,0} = 6 + (3+\u03bbB )(6+\u03bbB )\ntot\n=\n\u03c6{3;0,0,1}\n\nTABLE I Formulae necessary to explicitly calculate the transition rates w ji , listed in the graph in Fig. 6,\naccording to Eqs. (C4)-(C11).\n\n34\n\n\f"}