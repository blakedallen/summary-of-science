{"id": "http://arxiv.org/abs/0903.1949v1", "guidislink": true, "updated": "2009-03-11T11:04:35Z", "updated_parsed": [2009, 3, 11, 11, 4, 35, 2, 70, 0], "published": "2009-03-11T11:04:35Z", "published_parsed": [2009, 3, 11, 11, 4, 35, 2, 70, 0], "title": "A 3D radiative transfer framework: IV. spherical & cylindrical\n  coordinate systems", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.0369%2C0903.3015%2C0903.3640%2C0903.3568%2C0903.1296%2C0903.2398%2C0903.3127%2C0903.3344%2C0903.2572%2C0903.3586%2C0903.1987%2C0903.3966%2C0903.2982%2C0903.0550%2C0903.4775%2C0903.1442%2C0903.1374%2C0903.0475%2C0903.0755%2C0903.4796%2C0903.0746%2C0903.1441%2C0903.1482%2C0903.1995%2C0903.0596%2C0903.0896%2C0903.2969%2C0903.2263%2C0903.3311%2C0903.1034%2C0903.1557%2C0903.0112%2C0903.4368%2C0903.4982%2C0903.4261%2C0903.3146%2C0903.4588%2C0903.0322%2C0903.3832%2C0903.2078%2C0903.5323%2C0903.0370%2C0903.4112%2C0903.2939%2C0903.0858%2C0903.1565%2C0903.2030%2C0903.0253%2C0903.3538%2C0903.1241%2C0903.4890%2C0903.3708%2C0903.1672%2C0903.1166%2C0903.4038%2C0903.2306%2C0903.4646%2C0903.3876%2C0903.0982%2C0903.2707%2C0903.0169%2C0903.2664%2C0903.2101%2C0903.5107%2C0903.3413%2C0903.4770%2C0903.1397%2C0903.3131%2C0903.4613%2C0903.4825%2C0903.2351%2C0903.0612%2C0903.2952%2C0903.2319%2C0903.3400%2C0903.3145%2C0903.3030%2C0903.5355%2C0903.0424%2C0903.2043%2C0903.3809%2C0903.4645%2C0903.1801%2C0903.1699%2C0903.3817%2C0903.0639%2C0903.4574%2C0903.0285%2C0903.4506%2C0903.0297%2C0903.4783%2C0903.5010%2C0903.4766%2C0903.2986%2C0903.3275%2C0903.4263%2C0903.4844%2C0903.0503%2C0903.1949%2C0903.2979%2C0903.5505&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A 3D radiative transfer framework: IV. spherical & cylindrical\n  coordinate systems"}, "summary": "We extend our framework for 3D radiative transfer calculations with a\nnon-local operator splitting methods along (full) characteristics to spherical\nand cylindrical coordinate systems. These coordinate systems are better suited\nto a number of physical problems than Cartesian coordinates. The scattering\nproblem for line transfer is solved via means of an operator splitting (OS)\ntechnique. The formal solution is based on a full characteristics method. The\napproximate $\\Lambda$ operator is constructed considering nearest neighbors\nexactly. The code is parallelized over both wavelength and solid angle using\nthe MPI library. We present the results of several test cases with different\nvalues of the thermalization parameter for the different coordinate systems.\nThe results are directly compared to 1D plane parallel tests. The 3D results\nagree very well with the well-tested 1D calculations.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.0369%2C0903.3015%2C0903.3640%2C0903.3568%2C0903.1296%2C0903.2398%2C0903.3127%2C0903.3344%2C0903.2572%2C0903.3586%2C0903.1987%2C0903.3966%2C0903.2982%2C0903.0550%2C0903.4775%2C0903.1442%2C0903.1374%2C0903.0475%2C0903.0755%2C0903.4796%2C0903.0746%2C0903.1441%2C0903.1482%2C0903.1995%2C0903.0596%2C0903.0896%2C0903.2969%2C0903.2263%2C0903.3311%2C0903.1034%2C0903.1557%2C0903.0112%2C0903.4368%2C0903.4982%2C0903.4261%2C0903.3146%2C0903.4588%2C0903.0322%2C0903.3832%2C0903.2078%2C0903.5323%2C0903.0370%2C0903.4112%2C0903.2939%2C0903.0858%2C0903.1565%2C0903.2030%2C0903.0253%2C0903.3538%2C0903.1241%2C0903.4890%2C0903.3708%2C0903.1672%2C0903.1166%2C0903.4038%2C0903.2306%2C0903.4646%2C0903.3876%2C0903.0982%2C0903.2707%2C0903.0169%2C0903.2664%2C0903.2101%2C0903.5107%2C0903.3413%2C0903.4770%2C0903.1397%2C0903.3131%2C0903.4613%2C0903.4825%2C0903.2351%2C0903.0612%2C0903.2952%2C0903.2319%2C0903.3400%2C0903.3145%2C0903.3030%2C0903.5355%2C0903.0424%2C0903.2043%2C0903.3809%2C0903.4645%2C0903.1801%2C0903.1699%2C0903.3817%2C0903.0639%2C0903.4574%2C0903.0285%2C0903.4506%2C0903.0297%2C0903.4783%2C0903.5010%2C0903.4766%2C0903.2986%2C0903.3275%2C0903.4263%2C0903.4844%2C0903.0503%2C0903.1949%2C0903.2979%2C0903.5505&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We extend our framework for 3D radiative transfer calculations with a\nnon-local operator splitting methods along (full) characteristics to spherical\nand cylindrical coordinate systems. These coordinate systems are better suited\nto a number of physical problems than Cartesian coordinates. The scattering\nproblem for line transfer is solved via means of an operator splitting (OS)\ntechnique. The formal solution is based on a full characteristics method. The\napproximate $\\Lambda$ operator is constructed considering nearest neighbors\nexactly. The code is parallelized over both wavelength and solid angle using\nthe MPI library. We present the results of several test cases with different\nvalues of the thermalization parameter for the different coordinate systems.\nThe results are directly compared to 1D plane parallel tests. The 3D results\nagree very well with the well-tested 1D calculations."}, "authors": ["Peter H. Hauschildt", "E. Baron"], "author_detail": {"name": "E. Baron"}, "author": "E. Baron", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1051/0004-6361/200911661", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0903.1949v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0903.1949v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "A&A, in press", "arxiv_primary_category": {"term": "astro-ph.IM", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph.IM", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "astro-ph.SR", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0903.1949v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0903.1949v1", "journal_reference": null, "doi": "10.1051/0004-6361/200911661", "fulltext": "c ESO 2018\n\nAstronomy & Astrophysics manuscript no. phh\nSeptember 25, 2018\n\nA 3D radiative transfer framework: IV. spherical & cylindrical\ncoordinate systems\n\narXiv:0903.1949v1 [astro-ph.IM] 11 Mar 2009\n\nPeter H. Hauschildt1 and E. Baron1,2,3\n1\n2\n3\n\nHamburger Sternwarte, Gojenbergsweg 112, 21029 Hamburg, Germany; yeti@hs.uni-hamburg.de\nDept. of Physics and Astronomy, University of Oklahoma, 440 W. Brooks, Rm 100, Norman, OK 73019 USA; baron@ou.edu\nComputational Research Division, Lawrence Berkeley National Laboratory, MS 50F-1650, 1 Cyclotron Rd, Berkeley, CA 947208139 USA\n\nReceived date Accepted date\nABSTRACT\n\nAims. We extend our framework for 3D radiative transfer calculations with a non-local operator splitting methods along (full) characteristics to spherical and cylindrical coordinate systems. These coordinate systems are better suited to a number of physical problems\nthan Cartesian coordinates.\nMethods. The scattering problem for line transfer is solved via means of an operator splitting (OS) technique. The formal solution is\nbased on a full characteristics method. The approximate \u039b operator is constructed considering nearest neighbors exactly. The code is\nparallelized over both wavelength and solid angle using the MPI library.\nResults. We present the results of several test cases with different values of the thermalization parameter for the different coordinate\nsystems. The results are directly compared to 1D plane parallel tests. The 3D results agree very well with the well-tested 1D calculations.\nConclusions. Advances in modern computers will make realistic 3D radiative transfer calculations possible in the near future.\nKey words. Radiative transfer \u2013 Scattering\n\n1. Introduction\nIn Hauschildt & Baron (2006, hereafter: Paper I),\nBaron & Hauschildt (2007, hereafter: Paper II) and\n(Hauschildt & Baron 2008, hereafter: Paper III) we described a\nframework for the solution of the radiative transfer equation for\nscattering continua and lines in 3D (when we say 3D we mean\nthree spatial dimensions, plus three momentum dimensions) for\nthe time independent, static case using full characteristics based\non voxels in Cartesian coordinates. Cartesian coordinates are\nby no means an optimal choice for many 3D physical systems,\nfor example supernova atmospheres are better described in\n3D spherical and accretion disks are better described in 3D\ncylindrical coordinates. These coordinate systems make it a\nlittle harder and computationally more expensive to track the\ncharacteristics through the curvilinear voxel grid, however,\nthis is more than overcompensated by the higher efficiency of\nvoxel usage, for example consider putting a roughly spherical\nstructure where density and composition vary strongly with\nradius into a Cartesian coordinate system cube.\nWe describe our method, its rate of convergence, and present\ncomparisons to our well-tested 1-D calculations.\n\nare discussed in detail in Papers I and II and will not be repeated\nhere.\nWe use a \"full characteristics\" approach that completely\ntracks a set of characteristics of the radiative transfer equation\nfrom the inner or outer boundary through the computational domain to their exit voxels and takes care that each voxel is hit\nby at least one characteristic per solid angle. One characteristic\nis started at each boundary voxel and then tracked through the\nvoxel grid until it leaves the other boundary. The direction of a\nbundle of characteristics is determined by a set of solid angles\n(\u03b8, \u03c6) which correspond to a normalized momentum space vector (p x , py , pz ).\nIn contrast to the case of Cartesian coordinates the volumes\nof the voxels can be vastly different in spherical and Cartesian\ncoordinate systems. Therefore, tracking a characteristic across\nthe voxel grid is done using an adaptive stepsize control along\nthe characteristic so that a characteristic steps from one voxel to\nits neighbor in the direction of the characteristic. In addition, we\nmake sure that each voxel is hit by at least one characteristic for\neach solid angle, which is important for the inner (small radii)\nvoxels.\nThe code is parallelized as described in Papers I and II.\n\n2. Method\n\n3. spherical coordinates\n\nIn the following discussion we use notation of Papers I \u2013 III. The\nbasic framework and the methods used for the formal solution\nand the solution of the scattering problem via operator splitting\n\n3.1. Testing environment\n\nWe use the framework discussed in Paper I and II as the baseline\nfor the line transfer problems discussed in this paper. Our basic\n\n\f2\n\nHauschildt and Baron: 3D radiative transfer framework IV\n\nsetup is similar to that discussed in Paper II. We use a sphere\nwith a grey continuum opacity parameterized by a power law in\nthe continuum optical depth \u03c4std . The basic model parameters are\n\n3.2. Results\n\n1. Inner radius rc = 1010 cm, outer radius rout = 2 \u00d7 1010 cm\n(large test case) or rout = 1.1 \u00d7 1010 cm (small test case).\n\u22124\n2. Minimum optical depth in the continuum \u03c4min\nand\nstd = 10\nmax\n8\nmaximum optical depth in the continuum \u03c4std = 10 .\n3. Constant temperature with T eff = 104 K, therefore, the\nPlanck function B is also constant.\n\u2212\n4. Outer boundary condition Ibc\n\u2261 0 and diffusion inner boundary condition for all wavelengths.\n5. Continuum extinction \u03c7c = C/r6 , with the constant C fixed\nby the radius and optical depth grids, for the continuum tests,\n\u03c7c = C for the line transfer tests\n6. Parameterized coherent & isotropic continuum scattering by\ndefining\n\nIn Fig. 1 we show the results for 3D continuum transfer with\n3D spherical coordinates for various values of the thermalization\nparameter \u01ebc . The results are compared to 1D results (full line).\nIn all cases, the agreement is excellent, even for the case with\n\u01ebc = 10\u22126 . Compared to paper I the agreement is better, this is\ncaused by the better discretization of a spherical configuration in\nspherical coordinates, rather than fitting a sphere into a Cartesian\ngrid. It illustrates the importance of adapted coordinate systems\nto obtain the optimal mix between computational efficiency and\nnumerical accuracy.\n\n\u03c7c = \u01ebc \u03bac + (1 \u2212 \u01ebc )\u03c3c\nwith 0 \u2264 \u01ebc \u2264 1. \u03bac and \u03c3c are the continuum absorption and\nscattering coefficients.\nThis problem is used because the results can be directly compared with the results obtained with a 1D spherical radiation\ntransport code (Hauschildt 1992) to assess the accuracy of the\nmethod. The sphere is put at the center of the 3D grid. The radial\ngrid in the 3D coordinates is logarithmic in \u03c4std and has, therefore, highly variable spacing in r. In 3D spherical coordinates\n(r, \u03b8c , \u03c6c ) (note: the subscript c indicates a coordinate in order to\ndistinguish with the solid angle \u03a9 = (\u03b8, \u03c6)) we use regular grid\nin (\u03b8c , \u03c6c ) with resolutions given below. In the tests with cylindrical coordinates (\u03c1, \u03c6c , z) we use a regular grid in z and \u03c6c and\na variable grid in \u03c1. The solid angle space was discretized in\n(\u03b8, \u03c6) with n\u03b8 = n\u03c6 if not stated otherwise. In the following we\ndiscuss the results of various tests. In all tests we use the full\ncharacteristics method for the 3D RT solution.\nThe line of the simple 2-level model atom is parameterized\nby the ratio of the profile averaged line opacity \u03c7l to the continuum opacity \u03c7c and the line thermalization parameter \u01ebl . For the\ntest cases presented below, we have used \u03c7c = const, \u01ebc = 1, and\na grey temperature structure. We set \u03c7l /\u03c7c = 106 to simulate a\nstrong line, with varying \u01ebl (see below). With this setup, the optical depths as seen in the line range from 10\u22122 to 106 . We use 32\nwavelength points to model the full line profile, including wavelengths outside the line for the continuum. We did not require\nthe line to thermalize at the center of the test configurations, this\nis a typical situation for a full 3D configuration as the location\n(or even existence) of the thermalization depths becomes more\nambiguous than in the 1D case.\nIn the following we discuss the results of various tests.\nUnless otherwise stated, the tests were run on parallel computers\nusing 4 to 512 CPUs (depending on the test). In spherical coordinates we use a voxel grid with (nr , n\u03b8c , n\u03c6c ) = (65, 33, 65) voxels,\nthis corresponds to an angular resolution of about 5.5 degrees in\n\u03b8c and \u03c6c . Projected on the surface of the Earth, this means that\nEurope is covered by about 43 voxels. The spherical test cases\nuse incoming intensities of zero at the outside (Rmax ) and I = B\nat the inside ((Rmin ).\n\n3.2.1. Continuum tests\n\nGood coverage of the solid angle is important for 3D transfer.\nThe 1D code automatically adjusts the angle coverage related to\nthe geometry of the configuration, however, in the 3D code the\nsolid angles have to be prescribed. In Fig. 2 we demonstrate the\nimportance of solid angle sampling for a 'small' test case with\n\u01ebc = 10\u22124 . The plots show the ratio J/B as function of radial\noptical depth for various solid angle samplings and for all (\u03c6c , \u03b8c )\ncompared to the 1D results. It is immediately clear that for the\n'small' test case a solid angle sampling of 642 points or more\nis reasonable, but that 162 or less points result in a considerable\nscatter of the results. This result does not depend strongly on the\nradial extension of the configuration, as shown in Fig. 3.\nThe convergence rate of the nearest neighbor \u039b\u2217 (33 neighbor\nvoxels are considered in the \u039b\u2217 , see Paper I for details) with Ng\nacceleration is virtually identical to that of the 1D tri-diagonal\n\u039b\u2217 case, cf. Fig. 4. The importance of a non-local \u039b\u2217 for good\nconvergence in the 3D case can be seen by comparing the results obtained with a local (diagonal) \u039b\u2217 . Its convergence with\nNg acceleration is actually worse than that of the non-local \u039b\u2217\nwithout Ng acceleration. The excellent convergence of the nonlocal \u039b\u2217 can be used to reduce the computing time by using a\nless stringent convergence criterion that still gives results accurate enough for a particular application. One has to be careful to\nbe not too aggressive in relaxing the convergence criterion. This\nis highlighted in Fig. 5 where the results for the large test case are\nshown for different combinations of \u039b\u2217 with Ng acceleration and\ndifference convergence limits. It is obvious that the combination\nof Ng acceleration and a relatively large convergence limit with\na local (diagonal) \u039b\u2217 is not acceptable, whereas the same convergence limit (10\u22122 maximum relative change of J) with a nonlocal (nearest neighbor) \u039b\u2217 gives usable results even without Ng\nacceleration. Setting a convergence limit of 10\u22124 gives reasonable results in all test cases and can reduce computing time by\nabout 50%.\nWith 128 MPI processes on the SGI ICE system of the\nH\u00f6chstleistungs Rechenzentrum Nord (HLRN) the continuum\ntest with \u01eb = 10\u22124 and nr = n\u03c6 = 65 and n\u03b8 = 33 spatial points\nand 2562 solid angle points requires 16 iterations and 1543 s\nwallclock time, where a formal solution takes about 80 s, the\nconstruction of the non-local \u039b\u2217 about 140 s and about 1.6 s are\nused for the solution of the operator splitting step. For the same\ncase with 642 solid angles the total wallclock time is 230 s. The\nmemory requirements are about 45MB/process.\n\n\fHauschildt and Baron: 3D radiative transfer framework IV\n\n3.2.2. Line tests\n\nIn Fig. 6 we show the results of a comparison of the ratio of the\nline mean intensities J \u0304 and the Planck function B for the 'large'\ntest case and various values of \u01ebl . The 1D comparison models\nassume a diffusive inner boundary condition, whereas the 3D\nmodels use I = B as the boundary condition for the inner boundary. Therefore, the models will differ close to the inner boundary. Away from the inner boundary the results of the 1D and 3D\ncalculations agree very well with each other. The number of iterations required to reach a prescribed accuracy is similar to the\ncontinuum tests described above. This shows that the quality of\nthe 3D calculations match the 1D results, which is very important for future applications.\nIn Figs. 7 and 8 we show the flux vectors of the outermost\nvoxels (outermost radius, all (\u03b8c , \u03c6c ) points) for the line transfer\ncase with \u01ebl = 1 and for different numbers of solid angle points.\nIn the test case, the radial component of the flux vector Fr should\nbe the only non-zero component as in spherical symmetry both\nF\u03b8 and F\u03c6 are zero. The figures show that this is indeed the case\nif a large enough number of solid angle points is used in the calculation, if the number is too small, F\u03b8 and F\u03c6 can have errors of\nabout 10% and Fr scatters considerably around the 1D comparison. For 5122 solid angle points, the scatter of Fr is too small\nto be seen in the plot and F\u03b8 and F\u03c6 are smaller than 1% of Fr\nover the whole surface of the spherical grid. This highlights the\nnecessity of having enough solid angle points to obtain good accuracy. Fig. 9 shows Fr compared to the 1D results for a number\nof values of \u01ebl . In all cases the results agree very well with each\nother, showing the good numerical accuracy of the 3D code. The\nresults of these tests are valid only for the test cases, therefore,\na similar test should be performed for each \"real\" 3D configuration individually in order to make sure that enough solid angles\nare used for the accuracy requirements of each individual problem.\nWith 512 MPI processes on the SGI ICE system of the\nHLRN the line test with \u01ebl = 10\u22124 and nr = n\u03c6 = 65 and\nn\u03b8 = 33 spatial points, 32 wavelength points and 2562 solid angle points requires 30 iterations and 20287 s wallclock time and\nfor the same case with 642 solid angles the total wallclock time\nis 1400 s. In both cases we used 32 \"clusters\" with 16 MPI processes each so that for each wavelength 16 MPI processes work\non a formal solution (see paper II for details).\n\n4. Cylindrical coordinates\nThe setup for the test of the code in cylindrical coordinates is essentially identical to the tests of the spherical coordinate system\nversion. However, describing a spherically symmetric objects\nin cylindrical coordinates is non-optimal and we expect results\ncomparable to those presented in papers I and II. The cylindrical\ncoordinate system version of the code allows for different maps\nin \u03c1 and z for flexibility describing objects with nearly cylindrical symmetry.\nThe differences in the basic setup compared to the spherical\ncoordinates tests are\n1. inner radius rc = 1010 cm, outer radius rout = 11 \u00d7 1010 cm.\n2. linear radial grid.\n\n3\n\n3. Continuum extinction \u03c7c = C/r5 , with the constant C fixed\nby the radius and optical depth grids, for the continuum tests,\n\u03c7c = C for the line transfer tests.\nAll other test parameters are the same as above.\n4.1. Results\n\nFor the cylindrical coordinate tests we show just the results of\na standard test discussed in Paper I and above for the spherical case with \u01eb = 10\u22122 . The results for the continuum test case\nare presented in Fig. 10. The results agree reasonably well with\nthe 1D test case, comparable to the results described in Paper\nI. The reason for this is that describing a sphere in cylindrical\ncoordinates is not an ideal use of this coordinate system, therefore much higher grid resolution is required to reach reasonable\naccuracy (the results for grids with n\u03c1 = n\u03b8 = nz = 64 are substantially worse). As for the test cases in spherical coordinates\nthe resolution in solid angles is very important for accurate results. The convergence behavior is the same as in the case of\nspherical coordinates.\n\n5. Conclusions\nWe have discussed the extension of our 3D framework to 3D\nspherical and cylindrical coordinate systems. These coordinates\nare better suited than Cartesian coordinates for problems that are\napproximately spherical (e.g., supernova envelopes) or cylindrical (e.g., protoplanetary disks). The convergence properties and\nthe accuracy of the solutions are comparable to the 1D solution\nfor the test cases discussed here. These additional coordinate\nsystems allow for more general use with higher internal accuracy while using less memory than the purely Cartesian coordinate system.\nThe next step in the development of the 3D framework is to\nadd the treatment of velocity fields in the observer's frame and\nthe co-moving frame. The latter will be important for applications with relativistic velocity fields, e.g., supernovae, while the\nformer is interesting for modeling the spectra of convective flow\nmodels.\nAcknowledgements. This work was supported in part by by NASA grants\nNAG5-3505 and NAG5-12127, NSF grants AST-0307323, and AST-0707704,\nand US DOE Grant DE-FG02-07ER41517, as well as DFG GrK 1351 and\nSFB 676. Some of the calculations presented here were performed at the\nH\u00f6chstleistungs Rechenzentrum Nord (HLRN); at the NASA's Advanced\nSupercomputing Division's Project Columbia, at the Hamburger Sternwarte\nApple G5 and Delta Opteron clusters financially supported by the DFG and the\nState of Hamburg; and at the National Energy Research Supercomputer Center\n(NERSC), which is supported by the Office of Science of the U.S. Department\nof Energy under Contract No. DE-AC03-76SF00098. We thank all these institutions for a generous allocation of computer time.\n\nReferences\nBaron, E. & Hauschildt, P. H. 2007, A&A, 468, 255\nHauschildt, P. H. 1992, JQSRT, 47, 433\nHauschildt, P. H. & Baron, E. 2006, A&A, 451, 273\nHauschildt, P. H. & Baron, E. 2008, A&A, 490, 873\n\n\f4\n\nHauschildt and Baron: 3D radiative transfer framework IV\n\nFig. 1. The ratio of the mean intensity J and the Planck function\nB as function of the radial optical depth \u03c4std for the 'large' test\ncase in spherical coordinates and different values \u01ebc . The optical\ndepth is measured along the radius r.\n\nFig. 2. Effect of solid angle resolution on the results of the 3D\ncalculations. The plots show the results for the 'small' continuum test case in spherical coordinates with \u01ebc = 10\u22124 and for\nvarious solid angle resolutions with \u03bd\u03b8 = n\u03c6 from (256, 256) to\n(8, 8). Full line: results of the 1D calculation, dots: results from\nthe 3D calculations.\n\nFig. 3. Effect of solid angle resolution on the results of the 3D\ncalculations in spherical coordinates. The plots show the results\nfor the 'large' continuum test case with \u01ebc = 10\u22124 and for various\nsolid angle resolutions with \u03bd\u03b8 = n\u03c6 from (256, 256) to (8, 8).\nFull line: results of the 1D calculation, dots: results from the 3D\ncalculations.\n\nFig. 4. Convergence behavior for the 'large' continuum test case\nin spherical coordinates with \u01ebc = 10\u22124 for various combinations\nof local/non-local \u039b\u2217 and Ng acceleration. 'NN' indicates the\nnon-local nearest neighbor \u039b\u2217 operator, 'diagonal' the local \u039b\u2217 .\nFor comparison the results for the 1D spherical code and the 3D\nlambda iterations are also plotted.\n\n\fHauschildt and Baron: 3D radiative transfer framework IV\n\n5\n\nFig. 5. Effects of relaxing the convergence criterions on the results of the 3D calculations in spherical coordinates. The plots\nshow the results for the 'large' continuum test case with \u01ebc =\n10\u22124 and for various convergence limits for nearest neighbor\n(NN) and diagonal (Diag) \u039b\u2217 operators with and without Ng\nacceleration. The numbers are the maximum allowed relative\nchange over all voxels used to halt the iterations. Full line: results\nof the 1D calculation, dots: results from the 3D calculations.\n\nFig. 7. Flux vectors in the outermost voxels for the line transfer test in spherical coordinates with \u01ebl = 1 and 642 solid angle\npoints. The top panel shows the radial component Fr of the voxel\nflux vector compared to the results for the 1D comparison calculation. The middle and bottom panels show the ratio of the polar\nF\u03b8 and azimuthal F\u03c6 flux components to Fr , respectively.\n\nFig. 6. The ratio of the line mean intensity J \u0304 and the Planck\nfunction B as function of the radial optical depth \u03c4std for the\n'large' test case in spherical coordinates for different values of\n\u01ebl . The optical depth is measured along the radius r.\n\n\f6\n\nHauschildt and Baron: 3D radiative transfer framework IV\n\nFig. 10. Results for an example of a grey radiative transfer calculation for a sphere in cylindrical 3D coordinates for \u01eb = 10\u22122\nwith n\u03c1 = n\u03b8 = nz = 64 and 642 solid angle points. The results of\nthe 1D calculations are shown for comparison with \u2217 symbols.\n\nFig. 8. Flux vectors in the outermost voxels for the line transfer test in spherical coordinates with \u01ebl = 1 and 5122 solid angle\npoints. The top panel shows the radial component Fr of the voxel\nflux vector compared to the results for the 1D comparison calculation. The middle and bottom panels show the ratio of the polar\nF\u03b8 and azimuthal F\u03c6 flux components to Fr , respectively.\n\nFig. 9. Radial components Fr of the flux vectors in the outermost\nvoxels for the line transfer tests in spherical coordinates with\n\u01ebl = 1, 10\u22122, 10\u22124 , 10\u22128 and 2562 solid angle points. The results\nof the 1D calculations are shown for comparison.\n\n\f"}