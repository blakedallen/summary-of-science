{"id": "http://arxiv.org/abs/1104.4938v1", "guidislink": true, "updated": "2011-04-26T14:50:58Z", "updated_parsed": [2011, 4, 26, 14, 50, 58, 1, 116, 0], "published": "2011-04-26T14:50:58Z", "published_parsed": [2011, 4, 26, 14, 50, 58, 1, 116, 0], "title": "A note on higher-dimensional magic matrices", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.4122%2C1104.3875%2C1104.1934%2C1104.1597%2C1104.0896%2C1104.3321%2C1104.5212%2C1104.2373%2C1104.0163%2C1104.2075%2C1104.0758%2C1104.4687%2C1104.3812%2C1104.4481%2C1104.4099%2C1104.3241%2C1104.3278%2C1104.4805%2C1104.5581%2C1104.0228%2C1104.0611%2C1104.3682%2C1104.1412%2C1104.3702%2C1104.0880%2C1104.2610%2C1104.2243%2C1104.4060%2C1104.5183%2C1104.4092%2C1104.1031%2C1104.3027%2C1104.3703%2C1104.0892%2C1104.1484%2C1104.2115%2C1104.4922%2C1104.3284%2C1104.1456%2C1104.5086%2C1104.5246%2C1104.4585%2C1104.4343%2C1104.4435%2C1104.0211%2C1104.0626%2C1104.2655%2C1104.5295%2C1104.5339%2C1104.3966%2C1104.1967%2C1104.1390%2C1104.3546%2C1104.3344%2C1104.0119%2C1104.3338%2C1104.0229%2C1104.4460%2C1104.2736%2C1104.5034%2C1104.0597%2C1104.4401%2C1104.0810%2C1104.1232%2C1104.1314%2C1104.2456%2C1104.0035%2C1104.2166%2C1104.2885%2C1104.1188%2C1104.2880%2C1104.4892%2C1104.0585%2C1104.3873%2C1104.1989%2C1104.1927%2C1104.1638%2C1104.4306%2C1104.4372%2C1104.3799%2C1104.5322%2C1104.2626%2C1104.2169%2C1104.4950%2C1104.2316%2C1104.2470%2C1104.4322%2C1104.2221%2C1104.2208%2C1104.4155%2C1104.5329%2C1104.2260%2C1104.3236%2C1104.4224%2C1104.0507%2C1104.3880%2C1104.5173%2C1104.1581%2C1104.4275%2C1104.2466%2C1104.4938&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A note on higher-dimensional magic matrices"}, "summary": "We provide exact and asymptotic formulae for the number of unrestricted,\nrespectively indecomposable, $d$-dimensional matrices where the sum of all\nmatrix entries with one coordinate fixed equals 2.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.4122%2C1104.3875%2C1104.1934%2C1104.1597%2C1104.0896%2C1104.3321%2C1104.5212%2C1104.2373%2C1104.0163%2C1104.2075%2C1104.0758%2C1104.4687%2C1104.3812%2C1104.4481%2C1104.4099%2C1104.3241%2C1104.3278%2C1104.4805%2C1104.5581%2C1104.0228%2C1104.0611%2C1104.3682%2C1104.1412%2C1104.3702%2C1104.0880%2C1104.2610%2C1104.2243%2C1104.4060%2C1104.5183%2C1104.4092%2C1104.1031%2C1104.3027%2C1104.3703%2C1104.0892%2C1104.1484%2C1104.2115%2C1104.4922%2C1104.3284%2C1104.1456%2C1104.5086%2C1104.5246%2C1104.4585%2C1104.4343%2C1104.4435%2C1104.0211%2C1104.0626%2C1104.2655%2C1104.5295%2C1104.5339%2C1104.3966%2C1104.1967%2C1104.1390%2C1104.3546%2C1104.3344%2C1104.0119%2C1104.3338%2C1104.0229%2C1104.4460%2C1104.2736%2C1104.5034%2C1104.0597%2C1104.4401%2C1104.0810%2C1104.1232%2C1104.1314%2C1104.2456%2C1104.0035%2C1104.2166%2C1104.2885%2C1104.1188%2C1104.2880%2C1104.4892%2C1104.0585%2C1104.3873%2C1104.1989%2C1104.1927%2C1104.1638%2C1104.4306%2C1104.4372%2C1104.3799%2C1104.5322%2C1104.2626%2C1104.2169%2C1104.4950%2C1104.2316%2C1104.2470%2C1104.4322%2C1104.2221%2C1104.2208%2C1104.4155%2C1104.5329%2C1104.2260%2C1104.3236%2C1104.4224%2C1104.0507%2C1104.3880%2C1104.5173%2C1104.1581%2C1104.4275%2C1104.2466%2C1104.4938&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We provide exact and asymptotic formulae for the number of unrestricted,\nrespectively indecomposable, $d$-dimensional matrices where the sum of all\nmatrix entries with one coordinate fixed equals 2."}, "authors": ["Peter J. Cameron", "Christian Krattenthaler", "Thomas W. M\u00fcller"], "author_detail": {"name": "Thomas W. M\u00fcller"}, "author": "Thomas W. M\u00fcller", "arxiv_comment": "AmS-LaTeX, 9 pages", "links": [{"href": "http://arxiv.org/abs/1104.4938v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1104.4938v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "Primary 05A15, Secondary 05A16 05A19 05B15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1104.4938v1", "affiliation": "Queen Mary", "arxiv_url": "http://arxiv.org/abs/1104.4938v1", "journal_reference": "Austral. J. Combin. 50 (2011), 205-215", "doi": null, "fulltext": "A NOTE ON HIGHER-DIMENSIONAL MAGIC MATRICES\n\narXiv:1104.4938v1 [math.CO] 26 Apr 2011\n\nPeter J. Cameron\u2020 , Christian Krattenthaler\u2021 , and Thomas W. M\u00fcller\u2020\n\u2020\n\nSchool of Mathematical Sciences,\nQueen Mary & Westfield College, University of London,\nMile End Road, London E1 4NS, United Kingdom.\nWWW: http://www.maths.qmw.ac.uk/~pjc/\nWWW: http://www.maths.qmw.ac.uk/~twm/\n\u2021\n\nFakult\u00e4t f\u00fcr Mathematik, Universit\u00e4t Wien,\nNordbergstrasse 15, A-1090 Vienna, Austria.\nWWW: http://www.mat.univie.ac.at/~kratt\n\nAbstract. We provide exact and asymptotic formulae for the number of unrestricted,\nrespectively indecomposable, d-dimensional matrices where the sum of all matrix entries with one coordinate fixed equals 2.\n\n1. Introduction\nWe begin by recalling the notion of a magic matrix:1 this is a square matrix m =\n(mi,j )1\u2264i,j\u2264n with non-negative integral entries such that all row and column sums are\nequal to the same non-negative integer. If this non-negative integer is s, then we call\nsuch a matrix s-magic. The enumeration of s-magic squares has a long history, going\nback at least to MacMahon [15, \u00a7404\u2013419]. A good account of the enumerative theory\nof magic squares can be found in [18, Sec. 4.6], with many pointers to further literature.\nFor more recent work, see for instance [4, 8].\nLet [n] denote the standard n-set {1, 2, . . . , n}. There are two obvious ways of generalising s-magic matrices to higher dimensions:\n(G1) All line sums are equal. Given a positive integer d, a d-dimensional matrix\nm : [n]d \u2192 N0 (where N0 denotes the set of non-negative integers) is called\ns-magic if\nX\nm(\u03c91 , \u03c92 , . . . , \u03c9d ) = s\n(1.1)\n\u03c9i \u2208[n]\n\nfor all fixed \u03c91 , . . . , \u03c9i\u22121 , \u03c9i+1, . . . , \u03c9d \u2208 [n], and all i = 1, 2, . . . , d.\n\n2000 Mathematics Subject Classification. Primary 05A15; Secondary 05A16 05A19 05B15.\nKey words and phrases. higher-dimensional magic matrices, labelled combinatorial structures, multisort species, exponential principle.\n\u2021\nResearch partially supported by the Austrian Science Foundation FWF, grants Z130-N13 and\nS9607-N13, the latter in the framework of the National Research Network \"Analytic Combinatorics\nand Probabilistic Number Theory\".\n1\nStrictly speaking, the correct term here would be \"s-semi-magic,\" since we do not require diagonals\nto sum up to the same number as the rows and columns, see e.g. [4]. However, here and in what follows\nwe prefer the term \"magic\" for the sake of brevity.\n1\n\n\f2\n\n(G2) All hyperplane sums are equal. Given a positive integer d, a d-dimensional\nmatrix m : [n]d \u2192 N0 is called s-magic if\nX\nm(\u03c91 , \u03c92 , . . . , \u03c9d ) = s\n(1.2)\n\u03c91 ,...,\u03c9i\u22121 ,\u03c9i+1 ,...,\u03c9d \u2208[n]\n\nfor all fixed \u03c9i \u2208 [n], and all i = 1, 2, . . . , d.\nGeneralisation (G1) appears already in the literature, see e.g. [1, 4]. For d = 3 and\ns = 1, these objects are equivalent to Latin squares counted up to isotopy: the roles\nof rows, columns, and symbols of the corresponding Latin square are played by the\nfirst, second, and third coordinate, respectively, and the entry in position (\u03c91 , \u03c92 ) of\nthe Latin square is \u03c93 if and only if m(\u03c91 , \u03c92 , \u03c93 ) = 1.\nGeneralisation (G2) appears in the literature (in more general form) as contingency\ntables in statistics; there are Markov chain methods for approximate counting of these,\nas well as some remarkable asymptotic estimates, see [11, 9, 13, 19, 10]. Indeed, these\nresults suggest that the counting problem for (G2) is much easier than for (G1). (We\nare grateful to a referee for this information and the references.)\nThe present note focusses on the second generalisation. Hence, from now on, whenever we use the term \"s-magic,\" this is understood in the sense of (G2).\nCounting higher-dimensional magic matrices is made more difficult (than the already\ndifficult case of 2-dimensional magic matrices) by the fact that the analogue of Birkhoff's\nTheorem (cf. [5] or [2, Corollary 8.40]; it says that any 2-dimensional s-magic matrix\ncan be decomposed in a sum of permutation matrices, that is, 1-magic matrices) fails for\nthem. For example, the 3-dimensional 2-magic matrix with ones in positions (1, 1, 1),\n(1, 2, 3), (2, 1, 2), (2, 2, 1), (3, 3, 2) and (3, 3, 3) is not the sum of two 1-magic matrices.\nAs we demonstrate in this note, it is however possible to count the 2-magic matrices\nof any dimension. Our first result is a recurrence relation for the number un (d) of\nindecomposable d-dimensional 2-magic matrices of size n (see Corollary 3 in Section 4).\nThis recurrence is used in Proposition 4 to derive, for fixed d \u2265 3, an asymptotic\nformula for un (d). In order to go from indecomposable matrices to unrestricted ones,\nwe observe that the d-dimensional 2-magic matrices may be viewed as a d-sort species in\nthe sense of Joyal [14] which obeys the (d-sort) exponential principle. Let wn (d) denote\nthe number of all d-dimensional 2-magic matrices of size n. The exponential principle\ncan then be applied to relate the numbers wn (d) to the numbers un (d), see (3.5) (for\nd = 2) and (6.1) (for d \u2265 2). This relation is used in Theorem 5 to find, for fixed d \u2265 3,\nan asymptotic estimate for the numbers wn (d) as well. Exact and asymptotic formulae\nfor un (d) and wn (d) for d = 2 are presented in Section 3. We remark in passing that\na simple counting argument shows that the obvious interpretation of the matrices in\nGeneralisation (G1) as a d-sort species does not satisfy the exponential principle, not\neven under the - in a sense - minimal axiomatics of [7].\n2. Indecomposable 2-magic matrices and fixed-point-free involutions\nA d-dimensional matrix m : [n]d \u2192 N0 is called decomposable, if there exist non-empty\n(1)\n(1)\n(2)\n(2)\n(d)\n(d)\nsubsets B1 , B2 , B1 , B2 , . . . , B1 , B2 of [n] with\n(1)\n\n(1)\n\n(2)\n\n(2)\n\n(d)\n\n(d)\n\nB1 \u2210 B2 = B1 \u2210 B2 = * * * = B1 \u2210 B2 = [n]\n(\u2210 denoting disjoint union) and\n(1)\n\n(2)\n\n(d)\n\n|B1 | = |B1 | = * * * = |B1 |,\n\n\fA NOTE ON HIGHER-DIMENSIONAL MAGIC MATRICES\n\nsuch that m(\u03c91 , \u03c92 , . . . , \u03c9d) 6= 0 only if either\n(1)\n\n(2)\n\n(d)\n\n(1)\n\n(2)\n\n(d)\n\n3\n\n(\u03c91 , \u03c92 , . . . , \u03c9d ) \u2208 B1 \u00d7 B1 \u00d7 * * * \u00d7 B1\n\nor\n\n(\u03c91 , \u03c92 , . . . , \u03c9d ) \u2208 B2 \u00d7 B2 \u00d7 * * * \u00d7 B2 ,\notherwise it is called indecomposable.2 (In less formal language: there exist reorderings\nof the lines of the matrix such that m attains a block form.) The integer n is called the\nsize of m.\nLet un (d) denote the number of indecomposable d-dimensional 2-magic matrices of\nsize n. Note that an indecomposable 2-magic matrix with an entry 2 has size 1. So it\nis enough to consider zero-one matrices.\nThe purpose of this section is to relate the numbers un (d) to another sequence of\nnumbers vn (d) counting certain tuples of fixed-point-free involutions on a set with 2n\nelements. More precisely, let\nt1 = (1, 2)(3, 4) * * * (2n \u2212 1, 2n)\n\n(2.1)\n\nbe the standard fixed-point-free involution on the set [2n]. Then we define vn (d) to be\nthe number of choices of d\u22121 fixed-point-free involutions t2 , . . . , td on [2n] such that the\ngroup G = ht1 , t2 , . . . , td i generated by t1 , t2 , . . . , td is transitive. (For example, when\nn = 2, there are just three fixed-point-free involutions on {1, 2, 3, 4}, viz., (1, 2)(3, 4),\n(1, 3)(2, 4) and (1, 4)(2, 3), any two of which generate a transitive group. So v2 (d) =\n3d\u22121 \u2212 1.)\nWe have the following relation.\nLemma 1. For all integers n, d > 1, we have\nun (d) = 2\u2212n (n!)d\u22121 vn (d).\n\n(2.2)\n\nProof. Let m be an indecomposable d-dimensional 2-magic matrix of size n, where\nn > 1. Then m is a zero-one matrix, and it contains 2n entries equal to 1, the rest\nbeing zero. Number the positions of the 1's in m from 1 to 2n in such a way that the\npositions with first coordinate j are numbers 2j \u2212 1 and 2j for j = 1, . . . , n. (There are\n2n ways to do this, since for each j we can choose arbitrarily which of the two 1's has\nnumber j \u2212 1.) Then, for i = 1, . . . , d, let ti be the fixed-point-free involution whose\ncycles are the pairs of numbers in {1, . . . , 2n} indexing positions of 1's with the same\ni-th coordinate. Note that t1 is the involution defined in (2.1).\nWe claim that the subgroup G of S2n generated by t1 , . . . , td is transitive if and only\nif the matrix m is indecomposable. For this, note that the 1's whose labels belong to\na cycle of ti have the same i-th coordinate. So, if m is decomposable, and the 1 with\n(1)\n(d)\nlabel 1 belongs to B1 \u00d7 * * * \u00d7 B1 , then an easy induction shows that any 1 whose\nlabel is in the same orbit belongs to this set, so that G is intransitive. Conversely, if\nG is intransitive, then the coordinates of the 1's whose labels belong to a G-orbit give\nrise to a decomposition of m.\nSo each matrix gives rise to 2n such d-tuples of involutions. Thus, the number of\npairs consisting of a matrix and a corresponding sequence of permutations is 2n un (d).\nFor instance, the example of a matrix failing the analogue of Birkhoff's Theorem\ngiven in the Introduction, with the entries numbered in the order given, produces the\nthree permutations (1, 2)(3, 4)(5, 6), (1, 3)(2, 4)(5, 6) and (1, 4)(2, 6)(3, 5).\n2We\n\nwarn the reader that for d = 2 this does not reduce to the notion of decomposability of matrices\nin linear algebra since there rows and columns are reordered by the same permutation. Yet another\ndefinition of indecomposability occurs in [1].\n\n\f4\n\nConversely, let t1 , . . . , td be fixed-point-free involutions on the set {1, . . . , 2n} which\ngenerate a transitive group, where t1 is the standard involution defined in (2.1). Number\nthe cycles of each ti from 1 to n such that the cycle (2j\u22121, 2j) of t1 has number j. (There\nare (n!)d\u22121 such numberings.) Now construct a d-dimensional matrix m as follows: for\nk = 1, . . . , 2n, if k lies in cycle number \u03c9i of ti , then m(\u03c91 , \u03c92 , . . . , \u03c9d ) = 1; all other\nentries are zero. Then m is 2-magic. Consequently, each sequence of permutations\ngives rise to (n!)d\u22121 matrices; and the number of pairs consisting of a matrix and a\ncorresponding sequence of permutations equals (n!)d\u22121 vn (d).\nComparing these two expressions, we obtain (2.2), as required.\n\u0003\nRemark. We note that u1(d) = v1 (d) = 1 for all d. Hence, Formula (2.2) is false for\nn = 1.\n3. Computation of un (2) and wn (2)\nThe number wn (2) of 2-dimensional 2-magic matrices of size n has been addressed\nearlier by Anand, Dumir and Gupta in [3, Sec. 8.1]. They found the generating function\nformula\nX\nzn\nwn (2)\n= (1 \u2212 z)\u22121/2 ez/2 .\n(3.1)\n2\n(n!)\nn\u22650\nThis gives the explicit formula\n\nwn (2) =\n\n\u0013\nn \u0012\nX\n2k\nk=0\n\nk\n\n(n!)2\n.\n2n\u2212k (n \u2212 k)!\n\n(3.2)\n\nSingularity analysis (cf. [12, Ch. VI]) applied to (3.1) then yields the asymptotic formula\nr\n\u0012\n\u0012 \u0013\u0013\ne\n1\n2\n1+O\n,\nas n \u2192 \u221e.\n(3.3)\nwn (2) = (n!)\n\u03c0n\nn\nThe number un (2) of indecomposable 2-dimensional 2-magic matrices of size n can\nalso be computed explicitly. One way is to observe that, by Birkhoff's Theorem (cf.\n[5] or [2, Corollary 8.40]), a 2-magic matrix m is the sum of two permutation matrices,\nsay p1 and p2 . If m is indecomposable, then the pair {p1 , p2 } is uniquely determined.\nPremultiplying by p\u22121\n1 , we obtain a situation where p1 is the identity; indecomposability\nforces p2 to be the permutation matrix corresponding to a cyclic permutation, since a\ncycle of p2 not containing all points would provide a decomposition of m. So there are\nn! (n \u2212 1)! choices for (p1 , p2 ), and half this many choices for m (assuming, as we may,\nthat n > 1). Note that this formula gives half the correct number for n = 1. So we\nhave\n(\n1,\nif n = 1,\nun (2) = 1\n(3.4)\nn!\n(n\n\u2212\n1)!,\nif\nn\n>\n1.\n2\nAlternatively, we may observe that 2-dimensional 2-magic matrices may be seen as a\n2-sort species in the sense of Joyal [14] (see also [6, Def. 4 on p. 102]), with the row\nindices and the column indices forming the two sets on which the functor defining the\nspecies operates. Hence, by the exponential principle for 2-sort species [14, Prop. 20]\n(see also [6, Sec. 2.4]), we have\n!\nX\nX\nzn\nzn\n= exp\n.\n(3.5)\nun (2)\nwn (2)\n2\n2\n(n!)\n(n!)\nn\u22651\nn\u22650\n\n\fA NOTE ON HIGHER-DIMENSIONAL MAGIC MATRICES\n\n5\n\nCombining this with (3.1), we find that\n\u0013\n\u0012\nX\nz 1\n1\nzn\n.\n= + log\nun (2)\n2\n(n!)\n2\n2\n1\n\u2212\nz\nn\u22651\nExtraction of the coefficient of z n then leads (again) to (3.4).\n4. A recurrence relation for vn (d)\nIn this section we prove a recurrence relation for the numbers vn (d) (see Section 2 for\ntheir definition). By Lemma 1, this affords as well a recurrence relation for the numbers\nun (d).\nProposition 2. The numbers vn (d) satisfy v1 (d) = 1 and\n\u0013\nn \u0012\nX\nn\u22121\n((2n \u2212 2k \u2212 1)!!)d\u22121 vk (d) = ((2n \u2212 1)!!)d\u22121 ,\nk\u22121\nk=1\n\nn > 1.\n\n(4.1)\n\nHere, (2n \u2212 1)!! = 1 * 3 * 5 * * * (2n \u2212 1) is the product of the first n odd positive integers\nfor n > 0, and, by convention, (\u22121)!! = 1.\nProof. Recall that (2n \u2212 1)!! is the number of fixed-point-free involutions on a set of\nsize 2n. (This is a special case of the general formula\nn!\nai\ni=1 i ai !\n\nQn\n\nfor the number of permutations in Sn with ai cycles of length i for i = 1, . . . , n.) The\nnumber of choices of involutions t1 , t2 , . . . , td , where t1 is as in (2.1), such that the orbit\ncontaining 1 of the group they generate has size 2k is\n\u0013\n\u0012\nn\u22121\n((2n \u2212 2k \u2212 1)!!)d\u22121 vk (d),\nk\u22121\n\nsince we can choose in order\n(i) k \u2212 1 of the n \u2212 1 cycles of t1 other than (1, 2) such that the elements not fixed\nby all of these k \u2212 1 transpositions together with {1, 2} form the desired orbit,\nO say;\n(ii) d \u2212 1 fixed-point-free involutions on O which, together with the restriction of t1\nto O, generate a transitive group;\n(iii) d \u2212 1 arbitrary fixed-point-free involutions on the complement of O.\nSumming these values shows that the numbers vn (d) satisfy the desired recurrence. \u0003\nCorollary 3. For all integers d > 1, the numbers un (d) satisfy u1 (d) = 1 and\n((2n \u2212 3)!!)\n\nd\u22121\n\n\u0013\u0012\n\u0013d\u22121\nn \u0012\nX\n(2n \u2212 2k \u2212 1)!!\nn\u22121\n+\n2k uk (d) = ((2n \u2212 1)!!)d\u22121 ,\nk\n\u2212\n1\nk!\nk=2\n\nn > 1.\n\nRemarks. (1) In the case d = 2, we have seen in (3.4) that un (2) = n!(n \u2212 1)!/2 for\nn > 1, so that\nvn (2) = 2n\u22121 (n \u2212 1)! = (2n \u2212 2)!!,\n\n\f6\n\nd\nn=1 n=2 n=3 n=4\nn=5\nn=6\n2 indec\n1\n1\n6\n72\n1440\n43200\n0-1\n0\n1\n6\n90\n2040\n67950\nall\n1\n3\n21\n282\n6210\n202410\n3 indec\n1\n8\n900 359424 370828800 820150272000\n0-1\n0\n8\n900 366336 378028800 833156928000\nall\n1\n12 1152 431424 427723200 920031955200\nTable 1. Indecomposable, zero-one and arbitrary d-dimensional 2-magic\nmatrices of size n\nwhere (2n \u2212 2)!! is the product of the even integers up to 2n \u2212 2 (with 0!! = 1 by\nconvention). Substituting this in (4.1), we have proved the somewhat curious looking\nidentity\n\u0013\nn \u0012\nX\nn\u22121\n(2n \u2212 2k \u2212 1)!! (2k \u2212 2)!! = (2n \u2212 1)!!\nk\n\u2212\n1\nk=1\n\nfor n > 1.\nWe remark that this identity has an interpretation in terms of hypergeometric functions, for which we refer to [16], in particular, (1.7.7), Appendix (III.4). The left-hand\nside is\n\u0014\n\u0015\n\u2212n + 1, 1\nn\u22121\n2\n(1/2)n\u22121 * 2 F1\n;1 ,\n\u2212n + 12\nand the identity is an instance of the Chu\u2013Vandermonde identity.\n\n(2) For d > 2, we have not been able to solve the recurrence explicitly. However, it\nis easy to calculate terms in the sequences, and we can describe their asymptotics (see\nSections 5 and 6).\nTable 1 gives counts of all indecomposable matrices, all zero-one matrices, and all\nnon-negative integer matrices, with dimension d and hyperplane sums 2. The sequences\nfor d = 2 are numbers A010796, A001499, and A000681 in the On-Line Encyclopedia\nof Integer Sequences [17]. For d = 3, they are A112578, A112579 and A112580.\n5. Asymptotics of the numbers un (d)\nThis section provides the preparation for the determination of the asymptotics of the\nnumbers wn (d) for d \u2265 3 in the next section. Our goal here is to establish an asymptotic\nestimate for the sequence un (d) with fixed d \u2265 3.\nProposition 4. For fixed d \u2265 3, we have\n\nun (d) \u223c 2\u2212dn ((2n)!)d\u22121 ,\n\nas n \u2192 \u221e.\n\nProof. By Lemma 1, we have un (d) = (n!)d\u22121 vn (d)/2n for n > 1, so it suffices to show\nthat\nvn (d) \u223c ((2n \u2212 1)!!)d\u22121 .\n\nWe will use the estimates\n\np\n\n2(n + 1) \u2264\n\n\u221a\n2n n!\n\u22642 n\n(2n \u2212 1)!!\n\n\fA NOTE ON HIGHER-DIMENSIONAL MAGIC MATRICES\n\n7\n\nfor n \u2265 1. With cn = 2n n!/(2n \u2212 1)!!, we have cn+1 /cn = (2n + 2)/(2n + 1), and\nboth inequalities are easily proved by induction. From these estimates, we obtain the\ninequality\n\u00131/2\n\u0012 \u0013\u0012\n(2n \u2212 1)!!\n(k + 1)(n \u2212 k + 1)\nn\n\u2265\n.\n(5.1)\n(2k \u2212 1)!! (2n \u2212 2k \u2212 1)!!\nn\nk\n\u0012\u0012 \u0013\u0013\nn\n.\nTo simplify our formulae, we denote the left-hand side of this inequality by\nk\nNow, by Proposition 4.1, vn (d) satisfies the recurrence\n\u0013\nn\u22121 \u0012\nX\nn\u22121\nd\u22121\n((2n \u2212 2k \u2212 1)!!)d\u22121 vk (d),\nn > 1.\nvn (d) = ((2n \u2212 1)!!)\n\u2212\nk\u22121\nk=1\n\nClearly vn (d) \u2264 ((2n \u2212 1)!!)d\u22121 . We show that vn (d) \u2265 ((2n \u2212 1)!!)d\u22121 (1 \u2212 O(1/n)), an\nestimate which, in view of the above recurrence, follows if we can show that\n\u0013 \u0012\u0012 \u0013\u0013\u2212(d\u22121)\n\u0012 \u0013\nn\u22121 \u0012\nX\nn\n1\nn\u22121\n=O\nL :=\n.\nk\nk\u22121\nn\nk=1\nUsing (5.1), we have\n\n\u0013(d\u22121)/2\n\u0013\u0012 \u0013\u2212(d\u22121) \u0012\nn\u22122 \u0012\nX\nn\nn\nn\u22121 n\nL\u2264\n+\n(2n \u2212 1)d\u22121 k=2 k \u2212 1\n(k + 1)(n \u2212 k + 1)\nk\n\u0012 \u0013\u2212(d\u22122) \u0012\n\u0013(d\u22121)/2\nn\u22122\nX\nk n\nn\nn\n+\n.\n\u2264\n(2n \u2212 1)d\u22121 k=2 n k\n(k + 1)(n \u2212 k + 1)\n\u0001\n\u0001\nSince k/n < 1, n/(k + 1)(n \u2212 k + 1) < 1/2, and nk \u2265 n2 , and there are fewer than\nn \u2212 1 terms in the sum, the second term is at most\nn\u2212(d\u22122) (n \u2212 1)\u2212(d\u22123) * 2d\u22122 * 2\u2212(d\u22121)/2 \u2264\n\n1\n,\nn\n\nas required.\n\n\u0003\n6. Asymptotics of the numbers wn (d)\n\nRecall that wn (d) and un (d) are the numbers of unrestricted, respectively indecomposable, d-dimensional 2-magic matrices of size n. Using the exponential principle,\nwe can relate the sequence (wn (d))n\u22650 to the sequence (un (d))n\u22650 for each fixed d, see\n(6.1) below. This relationship combined with the fact that the sequence (un (d))n\u22650\ngrows sufficiently rapidly for d \u2265 3 (Proposition 4 says that it grows very roughly like\n((2n)!)d\u22121 ) allows us to conclude that, for d \u2265 3, wn (d) and un (d) grow at the same\nrate.\nTheorem 5. For fixed d \u2265 3, we have\n\nwn (d) \u223c 2\u2212nd ((2n)!)d\u22121 ,\n\nas n \u2192 \u221e.\n\nProof. Generalising the argument at the end of Section 3, we observe that d-dimensional\n2-magic matrices may be seen as a d-sort species in the sense of Joyal [14] (see also [6,\nDef. 4 on p. 102]), with the row indices and the column indices forming the two set on\n\n\f8\n\nwhich the functor defining the species operates. Hence, by the exponential principle for\nd-sort species [14, Prop. 20] (see also [6, Sec. 2.4]), we have\n!\nX\nX\nzn\nzn\nwn (d)\n= exp\nun (d)\n.\n(n!)d\n(n!)d\nn\u22650\nn\u22651\n\nIf we now differentiate both sides of this equation with respect to z and subsequently\nmultiply both sides by z, then we obtain\n!\n!\nX\nX\nX\nzn\nzn\nzn\nexp\n=\nun (d)\nnun (d)\nnwn (d)\n(n!)d\n(n!)d\n(n!)d\nn\u22651\nn\u22651\nn\u22650\n!\n!\nX\nX\nzn\nzn\n.\nwn (d)\n=\nnun (d)\nd\nd\n(n!)\n(n!)\nn\u22650\nn\u22651\nComparison of coefficients of z n on both sides then leads to the relation\n\u0012 \u0013d\nn\u22121\nX\nk n\nwn (d) = un (d) +\nuk (d)wn\u2212k (d).\nk\nn\nk=1\n\n(6.1)\n\nAs we said at the beginning of this section, our goal is to show that wn (d) grows\nasymptotically at the same rate as un (d). Hence, putting wn (d) = un (d) + xn (d), we\nhave to show that xn (d) = o(un (d)). We assume inductively that\nxm (d) \u2264 2\u2212m ((2m \u2212 1)!!)d\u22121 (m!)d\u22121\n\nfor all m between 2 and n \u2212 1; the induction starts since we have x1 (d) = x2 (d) = 0.\nNow, using the inductive hypothesis with the recurrence relation (6.1), we have\n\u0012 \u0013d \u0012\u0012 \u0013\u0013\u2212(d\u22121) \u0012 \u0013\u2212(d\u22121)\nn\u22121\nX\nxn (d)2n\nn\nn\nk n\n\u22642\nd\u22121\nd\u22121\nk\nk\n((2n \u2212 1)!!) (n!)\nn k\nk=1\n\u0012 \u0013\u2212(d\u22122) \u0012\n\u0013(d\u22121)/2\nn\u22121\nX\nn\nk n\n\u22642\nn k\n(k + 1)(n \u2212 k + 1)\nk=1\n\u2264 (21/2 n)\u2212(d\u22123) ,\n\nwhich establishes the result if d > 3. For d = 3, this inequality gives the inductive step\n(that is, that the left-hand side is at most 1); the fact that it is o(1) for large n is proved\nby an argument like that in the proof of Proposition 4.\n\u0003\nAcknowledgment. The authors are grateful to a referee for some helpful information on\ncontingency tables.\nReferences\n[1] M. Ahmed, J. A. De Loera and R. Hemmecke, Polyhedral cones of magic cubes and squares, in:\nDiscrete and Computational Geometry. The Goodman\u2013Pollack Festschrift (B. Aronov, S. Basu,\nJ. Pach and M. Sharir, eds.), Springer\u2013Verlag, Berlin, Algorithms Comb. 25, 2003, pp. 25\u201341.\n[2] M. Aigner, Combinatorial Theory, Springer\u2013Verlag, Berlin, 1979.\n[3] H. Anand, V. C. Dumir, and H. Gupta, A combinatorial distribution problem, Duke Math. J. 33\n(1966), 757\u2013769.\n[4] M. Beck, M. Cohen, J. Cuomo and P. Gribelyuk, The number of \"magic\" squares, cubes, and\nhypercubes, Amer. Math. Monthly 110 (2003), 707\u2013717.\n[5] G. Birkhoff, Tres observaciones sobre el \u00e1lgebra lineal, Univ. Nac. Tucum'an Rev. Ser. A 5 (1946),\n147\u2013150.\n\n\fA NOTE ON HIGHER-DIMENSIONAL MAGIC MATRICES\n\n9\n\n[6] F. Bergeron, G. Labelle, and P. Leroux, Combinatorial Species and Tree-Like Structures, Cambridge University Press, Cambridge, 1998.\n[7] P. J. Cameron, C. Krattenthaler and T. W. M\u00fcller, Decomposable functors and the exponential\nprinciple, II, S\u00e9minaire Lotharingien Combin. 61A (2011), Article B61Am, 38 pages.\n[8] J. A. De Loera, F. Liu and R. Yoshida, A generating function for all semi-magic squares and the\nvolume of the Birkhoff polytope, J. Algebraic Combin. 30 (2009), 113\u2013139.\n[9] J. A. De Loera and S. Onn, The complexity of three-way statistical tables, SIAM J. Comput. 33\n(2004), 819\u2013836 (electronic).\n[10] J. A. De Loera and S. Onn, All linear and integer programs are slim 3-way transportation programs, SIAM J. Optim. 17 (2006), 806\u2013821 (electronic).\n[11] P. Diaconis and A. Gangolli, Rectangular arrays with fixed margins, in Discrete Probability and\nAlgorithms (D. Aldous, P. Diaconis, J. Spencer, and J. M. Steele (eds.), IMA Vol. Math. Appl.,\nSpringer, New York, pp.15\u201341.\n[12] P. Flajolet and R. Sedgewick, Analytic Combinatorics, Cambridge University Press, Cambridge,\n2009.\n[13] S. Ho\u015ften and S. Sullivant, Gr\u00f6bner bases and polyhedral geometry of reducible and cyclic models,\nJ. Combinatorial Theory Ser. A 100 (2002), 277\u2013301.\n[14] A. Joyal, Une th\u00e9orie combinatoire des s\u00e9ries formelles, Adv. in Math. 42 (1981), 1\u201382.\n[15] P. A. MacMahon, Combinatory Analysis, vol. 2, Cambridge University Press, 1916; reprinted by\nChelsea, New York, 1960.\n[16] L. J. Slater, Generalized Hypergeometric Functions, Cambridge University Press, Cambridge, 1966.\n[17] N. J. A. Sloane (editor), The On-Line Encyclopedia of Integer Sequences, available at\nhttp://www.research.att.com:80/~njas/sequences/.\n[18] R. P. Stanley, Enumerative Combinatorics, vol. 1, Wadsworth & Brooks/Cole, Pacific Grove,\nCalifornia, 1986; reprinted by Cambridge University Press, Cambridge, 1998.\n[19] B. Sturmfels, Gr\u00f6bner Bases and Convex Polytopes, University Lecture Series 8, Amer. Math.\nSoc., Providence, RI, 1996.\nSchool of Mathematical Sciences, Queen Mary & Westfield College, University of\nLondon, Mile End Road, London E1 4NS, United Kingdom.\nWWW: http://www.maths.qmw.ac.uk/~pjc/, http://www.maths.qmw.ac.uk/~twm/.\nFakult\u00e4t f\u00fcr Mathematik, Universit\u00e4t Wien, Nordbergstrasse 15, A-1090 Vienna,\nAustria. WWW: http://www.mat.univie.ac.at/~kratt.\n\n\f"}