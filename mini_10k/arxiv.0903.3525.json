{"id": "http://arxiv.org/abs/0903.3525v3", "guidislink": true, "updated": "2010-06-01T11:27:47Z", "updated_parsed": [2010, 6, 1, 11, 27, 47, 1, 152, 0], "published": "2009-03-20T19:09:09Z", "published_parsed": [2009, 3, 20, 19, 9, 9, 4, 79, 0], "title": "Security of quantum key distribution with arbitrary individual\n  imperfections", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.0885%2C0903.5045%2C0903.0035%2C0903.3352%2C0903.5489%2C0903.3700%2C0903.2567%2C0903.0262%2C0903.3928%2C0903.1505%2C0903.4753%2C0903.2579%2C0903.2712%2C0903.1002%2C0903.1262%2C0903.1243%2C0903.4017%2C0903.0240%2C0903.2784%2C0903.3188%2C0903.2777%2C0903.1918%2C0903.0339%2C0903.3820%2C0903.4805%2C0903.5245%2C0903.2590%2C0903.0406%2C0903.3439%2C0903.0747%2C0903.0577%2C0903.5365%2C0903.3204%2C0903.0448%2C0903.2794%2C0903.2160%2C0903.4102%2C0903.1719%2C0903.5519%2C0903.0498%2C0903.2630%2C0903.3510%2C0903.2484%2C0903.5180%2C0903.2963%2C0903.4687%2C0903.2149%2C0903.4564%2C0903.1836%2C0903.3088%2C0903.4780%2C0903.0043%2C0903.4169%2C0903.4968%2C0903.1114%2C0903.0948%2C0903.0591%2C0903.2569%2C0903.1377%2C0903.1684%2C0903.3952%2C0903.5426%2C0903.0557%2C0903.4095%2C0903.1599%2C0903.3497%2C0903.4769%2C0903.2638%2C0903.3531%2C0903.0071%2C0903.2995%2C0903.0567%2C0903.3525%2C0903.5103%2C0903.2907%2C0903.3078%2C0903.5028%2C0903.2853%2C0903.1516%2C0903.1544%2C0903.4899%2C0903.4365%2C0903.4384%2C0903.4595%2C0903.2971%2C0903.3035%2C0903.0166%2C0903.5162%2C0903.3067%2C0903.0595%2C0903.1644%2C0903.0041%2C0903.3142%2C0903.0660%2C0903.4111%2C0903.4373%2C0903.2587%2C0903.0682%2C0903.0489%2C0903.0701%2C0903.3901&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Security of quantum key distribution with arbitrary individual\n  imperfections"}, "summary": "We consider the security of the Bennett-Brassard 1984 (BB84) protocol for\nQuantum Key Distribution (QKD), with arbitrary individual imperfections\nsimultaneously in the source and detectors. We provide the secure key\ngeneration rate, and show that only two parameters must be bounded to ensure\nsecurity; the basis dependence of the source and a detector blinding parameter.\nThe system may otherwise be completely uncharacterized and contain large\nlosses.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.0885%2C0903.5045%2C0903.0035%2C0903.3352%2C0903.5489%2C0903.3700%2C0903.2567%2C0903.0262%2C0903.3928%2C0903.1505%2C0903.4753%2C0903.2579%2C0903.2712%2C0903.1002%2C0903.1262%2C0903.1243%2C0903.4017%2C0903.0240%2C0903.2784%2C0903.3188%2C0903.2777%2C0903.1918%2C0903.0339%2C0903.3820%2C0903.4805%2C0903.5245%2C0903.2590%2C0903.0406%2C0903.3439%2C0903.0747%2C0903.0577%2C0903.5365%2C0903.3204%2C0903.0448%2C0903.2794%2C0903.2160%2C0903.4102%2C0903.1719%2C0903.5519%2C0903.0498%2C0903.2630%2C0903.3510%2C0903.2484%2C0903.5180%2C0903.2963%2C0903.4687%2C0903.2149%2C0903.4564%2C0903.1836%2C0903.3088%2C0903.4780%2C0903.0043%2C0903.4169%2C0903.4968%2C0903.1114%2C0903.0948%2C0903.0591%2C0903.2569%2C0903.1377%2C0903.1684%2C0903.3952%2C0903.5426%2C0903.0557%2C0903.4095%2C0903.1599%2C0903.3497%2C0903.4769%2C0903.2638%2C0903.3531%2C0903.0071%2C0903.2995%2C0903.0567%2C0903.3525%2C0903.5103%2C0903.2907%2C0903.3078%2C0903.5028%2C0903.2853%2C0903.1516%2C0903.1544%2C0903.4899%2C0903.4365%2C0903.4384%2C0903.4595%2C0903.2971%2C0903.3035%2C0903.0166%2C0903.5162%2C0903.3067%2C0903.0595%2C0903.1644%2C0903.0041%2C0903.3142%2C0903.0660%2C0903.4111%2C0903.4373%2C0903.2587%2C0903.0682%2C0903.0489%2C0903.0701%2C0903.3901&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We consider the security of the Bennett-Brassard 1984 (BB84) protocol for\nQuantum Key Distribution (QKD), with arbitrary individual imperfections\nsimultaneously in the source and detectors. We provide the secure key\ngeneration rate, and show that only two parameters must be bounded to ensure\nsecurity; the basis dependence of the source and a detector blinding parameter.\nThe system may otherwise be completely uncharacterized and contain large\nlosses."}, "authors": ["\u00d8ystein Mar\u00f8y", "Lars Lydersen", "Johannes Skaar"], "author_detail": {"name": "Johannes Skaar"}, "author": "Johannes Skaar", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevA.82.032337", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0903.3525v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0903.3525v3", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "quant-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0903.3525v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0903.3525v3", "arxiv_comment": null, "journal_reference": "Phys. Rev. A 82, 032337 (2010)", "doi": "10.1103/PhysRevA.82.032337", "fulltext": "Security of quantum key distribution with arbitrary individual imperfections\n\u00d8ystein Mar\u00f8y,1, 2, \u2217 Lars Lydersen,1, 2 and Johannes Skaar1, 2\n1\nDepartment of Electronics and Telecommunications,\nNorwegian University of Science and Technology, NO-7491 Trondheim, Norway\n2\nUniversity Graduate Center, NO-2027 Kjeller, Norway\n(Dated: November 9, 2018)\n\nWe consider the security of the Bennett-Brassard 1984 (BB84) protocol for quantum key distribution, with arbitrary individual imperfections simultaneously in the source and detectors. We\nprovide the secure key generation rate, and show that three parameters must be bounded to ensure\nsecurity; the basis dependence of the source, a detector blinding parameter, and a detector leakage\nparameter. The system may otherwise be completely uncharacterized and contain large losses.\n\narXiv:0903.3525v3 [quant-ph] 1 Jun 2010\n\nPACS numbers: 03.67.Dd\n\nI.\n\nINTRODUCTION\n\nQuantum Key Distribution (QKD) is a method for distributing a secure key to two communicating parties, Alice and Bob. The most common QKD protocol, BB84\n[1], has been proved secure by a number of approaches,\nsome of which include different kinds of imperfections in\nthe equipment [2\u20137]. The ultimate goal of QKD security\nanalysis is to take all kinds of imperfections into account,\nat least those that cannot be eliminated completely by\na suitable design of the setup. So far, most of the available security proofs for BB84 consider imperfections at\nthe source or detector separately. An exception is the\nwork by Gottesman et. al. [5], which treats the security\nin the presence of source flaws and a squashing detector\nwith certain, limited imperfections. Also of interest is\nthe paper by Hayashi [8], which combines finite length\nkey analysis with photon number imperfections at the\nsource. Proving security for a realistic system with arbitrary imperfections, simultaneously in the source, channel, and detectors, has so far been an open problem.\nA particularly suitable approach for practical QKD is\nto limit the assumptions about the equipment. By considering entanglement-based protocols with detectors in\nboth ends of the system [9], one can prove security in\na rather general setting [10], assuming collective attacks\nand individual imperfections [11]. While these protocols\nand security proofs are promising, they do not necessarily provide security for realistic devices. All realistic\nsystems have large losses due to the channel and limited\ndetector efficiencies. An eavesdropper Eve may use imperfect detection efficiencies to effectively control Bob's\nbasis choice [12, 13]. Using this detection-loophole, she\nmay perform the identical measurement as Bob to obtain\na perfect copy of the key [26].\nIn this work we will prove security for BB84 with any\ncombination of individual imperfections as well as channel losses. By individual imperfections we mean that\nthe operation of the devices for a particular signal is in-\n\n\u2217 Electronic\n\naddress: oystein.maroy@iet.ntnu.no\n\ndependent of earlier signals. To obtain such generality,\nwe describe the actual physics in the protocol, rather\nthan using e.g. squashing models with \"tagging\". Thus,\nthe detectors are described as a basis-dependent quantum operation on the actual state space, in front of a\nthree-outcome measurement (\"0\", \"1\", and \"vacuum\").\nDescribing the detector in this way also enables an elegant solution to the problem of combining errors in the\ndetectors and errors in the source.\nTo get around the detection loophole, we anticipate\nthat at least two parameters must be known or bounded\nabout the system; one for the source and one for the\ndetectors. Our proof is formulated with two such parameters; the basis dependence of the source and a detector blinding parameter. In addition to these parameters,\nwe include a third parameter quantifying leakage from\nBob's detectors. Once these parameters are bounded,\nthe system may contain bit and basis leakage from Alice, multimode behavior, basis-dependent misalignments,\nlosses, nonlinearities, basis-dependent threshold detectors with detector efficiency mismatch and information\nleakage, dark counts, etc. In that sense, our proof offers the generality of the entanglement-based scenarios\n[11], applies to realistic scenarios with loss, and provides\nuniversal composable security against the most general\nattacks.\nII.\n\nPROTOCOL\n\nConsider the following BB84-like protocol, the actual\nprotocol. Alice chooses basis a = Z or a = X randomly\naccording to some probability distribution and prepares\nthe state |\u03c7a i, where\np\n\u221a\n|\u03c7Z i = pZ |0i|\u03b20 i + 1 \u2212 pZ |1i|\u03b21 i,\n(1a)\np\n\u221a\n|\u03c7X i = pX |+i|\u03b2+ i + 1 \u2212 pX |\u2212i|\u03b2\u2212 i.\n(1b)\nHere pZ and pX are probabilities, |0i, |1i are some\u221aorthonormal qubit basis states, and |\u00b1i = (|0i \u00b1 |1i)/ 2.\nAlice measures the qubit in the a-basis (this measurement can be delayed to the end of the protocol). She\nrepeats the procedure to obtain a large number of \"\u03b2\n\n\f2\nstates\", which are sent via Eve to Bob. These \u03b2 states\ninclude any system that is correlated to Alice's system\nand to which Eve has access. Note that Eve is free to\nsend anything to Bob, including parts of \u03b2 and/or any\nstate of her own choice. Depending on Alice's source\nthe four different \u03b2-states will differ in photon number\nstatistics, polarization, wavelength, etc. Any leakage in\nnon-photonic side channels will also be included in these\nstates. With no loss of generality, the \u03b2-states are assumed pure; if they were mixed, we could simply purify\nthem, sending the auxiliary, purifying system to Eve.\nFor each state received by Bob, he chooses a \"basis\"\nvariable b according to some probability distribution and\nconducts measurements Mb . The measurements Mb have\nthree outcomes, \"0\", \"1\", and \"vacuum\". When he obtains \"0\" or \"1\" he publicly acknowledges receipt. After\ntransmission, Alice and Bob broadcast a and b. When\nb = X they openly compare their measurement results\nto estimate the fraction qX of nonvacuum events at Bob\nwhen a = X, the corresponding error rate \u03b4X , and the\nfraction qph of nonvacuum events when a = Z. After\nthis estimation only the n states for which a = b = Z\nare kept. Discarding all events where Bob detected \"vacuum\", Alice and Bob each end up with nqZ bits. Alice's\nbits are the raw key.\nWe will now summarize Koashi's generic framework\nfor security proofs [14, 15]. Imagine a virtual experiment\nwhere Alice measures her final nqZ qubits (corresponding to the raw key) in the X-basis instead of Z-basis. In\nthis virtual experiment, instead of measuring MZ , Bob\nnow tries to predict the outcome of Alice's measurement.\nTo do this, he may do whatever is permitted by quantum\nmechanics, as long as he does not alter the information\ngiven to Eve. Let HvirtX (A|B = \u03bc) denote the entropy of\nAlice's result, given measurement result \u03bc in Bob's prediction. Let HvirtX (A|B = \u03bc) \u2264 H for some constant\nH. Since the uncertainty after Bob's prediction is less\nthan H, the entropic uncertainty relation [16] suggests\nthat anyone (including Eve) cannot predict the outcome\nof a Z-basis measurement by Alice with less entropy than\nnqZ \u2212 H. This indicates that Alice can extract nqZ \u2212 H\nbits of secret key. The quantity H is to be found from\nthe estimated parameters qX , \u03b4X , and qph [27]. The detailed proof [14] of the fact that Alice can extract nqZ \u2212H\nbits of secret key is based upon the universal, composable security definition, and considers the actual privacy\namplification protocol by universal hashing.\nTo ensure that Bob has the identical key, we note that\nit does not matter to Eve what Bob does (as long as he\ngives the same receipt acknowledgment information); he\ncan as well measure MZ . Then Bob obtains the identical\nraw key from his measurement result and nqZ h(\u03b4Z ) extra\nbits of error correction information from Alice, consuming nqZ h(\u03b4Z ) of previous established secure key. Here\nh(*) is the binary Shannon entropy function, and the error rate \u03b4Z can be estimated by sacrificing a subset of\nthe raw key (whose size we can neglect in the asymptotic\nlimit n \u2192 \u221e). We therefore obtain the asymptotic net\n\nsecure key generation rate\nRZ \u2265 1 \u2212 H/nqZ \u2212 h(\u03b4Z ).\n\nIII.\n\n(2)\n\nINDIVIDUAL IMPERFECTIONS IN THE\nDETECTORS\n\nWe first consider the situation where Alice's source is\nperfect (|\u03c7X i = |\u03c7Z i) and Bob's detectors can be subject to any kind of individual imperfections. With the\nunderstanding that Bob chooses his bit randomly for coincidence counts [3, 5], his detectors can be modeled by\na basis-dependent quantum operation (EZ and EX ) in\nfront of a measurement with three possible outcomes:\n\"0\", \"1\", and \"vacuum\". Note that there is no need to\nrequire a squash model [5, 17, 18] in our proof as Bob's\nbasis selector is included into the basis-dependent quantum operation.\nIn addition to the optical modes, there may also be\nother relevant degrees of freedom in the detector. For\nexample, dark counts are caused by physical processes\ninternally in the detector. Thus we consider an extended\nstate space consisting of the Fock space of all optical\nmodes in addition to the state space associated with\n\"electronic\" degrees of freedom inside the detectors. Pessimistically, we let Eve control all degrees of freedom.\nThe quantum operations EZ and EX are decomposed\nas follows: First there is a basis-dependent quantum operation (FZ and FX ) acting on the Fock space associated\nwith all optical modes. This operation contains Bob's basis selector. The operations FZ and FX are assumed passive in the sense that if vacuum is incident to all modes,\nthere will also be vacuum at the output. Then there is\nanother quantum operation F describing interaction between the photonic state and internal degrees of freedom\nin the detectors, see Fig. 1. The quantum operation F\nmay be active in the sense that even though vacuum is\nincident to all optical modes, there may be nonvacuum\ndetections. When the optical modes contain the vacuum\nstate, we can (pessimistically) assume that Eve has full\ncontrol over Bob's detectors through F; in other words,\nshe controls the dark counts directly with the \"electronic\"\nmodes. The quantum operation F is assumed to be independent of Bob's basis choice. This assumption is natural\nas Bob's basis choice does not influence internal degrees\nof freedom in the detector. In other words, when Eve\nemits the vacuum in all optical modes, Bob's basis choice\nwill not affect the detection statistics.\nTo achieve a completely general detector model, we\nshould not only let Eve control the detectors; in addition\nwe must let information return to Eve. Consider the case\nwhere Bob has chosen the Z-basis. In the most general\ncase the information leakage is quantum, i.e., a part of\nthe total Hilbert space is given directly to Eve. Replacing\nthis part of the Hilbert space by some standard state\n\u03c32 , we can quantify the leakage \u000fZ by the trace distance\n\n\f3\n\u03c3\n\n\u03c1\n\n\u03c31 \u2297 \u03c32\n\nAlice's bit\n\nFrom Eve\nbasis b\n\"0\"\n\"1\"\n\"vacuum\"\n\nFb\nF\n\nFrom Eve\n\nReversal\n\nEZ\n\nEX\n\n\"0\"\n\"1\"\n\"vacuum\"\n\nTo Eve\n\nFIG. 2: Bob's setup for virtual X-basis prediction. The\noptical and electronic modes are denoted by a single line in\nthis figure.\n\n\u03c32\nEb\n\nP, I \u2212 P\n\nQ, I \u2212 Q\n\nTo Eve\n\nFIG. 1: Bob's detectors consist of a basis-dependent quantum\noperation (EZ = F \u25e6 FZ and EX = F \u25e6 FX ) in front of a\nthree-outcome measurement. The fact that Eve gets arrival\ninformation from Bob is included through a dedicated vacuum\nmeasurement preceding Bob's three-outcome measurement.\nOn the input side of F, the lower line contains the electronic\nmodes of the detector, while on the output side of F, the\nlower line indicates the part of the Hilbert space leaked to\nEve. Alice's classical bit, indicated in the upper part of the\nfigure, is included in the state \u03c3.\n\nD(*, *) as follows:\n\u000fZ = min max D(\u03c3, \u03c31 \u2297 \u03c32 ).\n\u03c32\n\n\u03c1\n\n(3)\n\nHere \u03c1 is any state at Bob's input (including Alice's part\nof the system, see Fig. 1), \u03c3 is the state of Alice and\nBob before leakage, and \u03c31 = Tr2 (\u03c3) is the state of the\nremaining Hilbert space after leakage. Note that these\ndensity operators refer to a single signal, not the entire\nblock of n signals. The parameter \u000fZ measures the correlation between the leaked quantum state and the state\nof Alice and Bob, maximized over states sent by Eve.\nMore precisely, \u000fZ is the maximum probability that the\nactual state before leakage can be distinguished from the\nstate where the leaked part is replaced by the standard\nstate \u03c32 [19]. Eq. (3) has another very useful physical\ninterpretation: Choose a fixed \u03c32 , dependent on EZ , but\nindependent of the state coming from Eve. For any \u03c3,\nthe probability of a measurement result of \u03c31 \u2297 \u03c32 deviates no more than \u000fZ from the corresponding probability\nwhen measuring \u03c3 [19].\nAlthough we now have a general detector model, we\nadd one little feature. In the actual protocol, Eve gets\nto know whether a particular signal was detected. This\ncan be included as an extra projective measurement with\nprojectors P and I \u2212 P , where I \u2212 P is a projector onto\nthe subspace corresponding to detection result \"vacuum\"\nin Bob's measurement. Clearly this addition does not\ndisturb Bob's measurement statistics. The composed\nmeasurement consisting of EZ followed by this projective measurement will be referred to as Eve's vacuum\nmeasurement. It can be described by some POVM elements E and I \u2212E, where I \u2212E corresponds to detection\nresult \"vacuum\" at Bob. Including Eve's vacuum mea-\n\nsurement separately, rather than absorbing it into the\nquantum leakage (3), leads to a better rate. The reason\nis that the information from the vacuum measurement\nis classical and available to Bob, as opposed to general,\nleaked quantum information.\nHaving described the model, we now turn to the security analysis. As before, Alice extracts the key in the\nZ-basis. In Koashi's security proof, Bob wants to predict\nthe outcome of a virtual X-basis measurement by Alice.\nIn this virtual prediction there is only one important restriction: Bob is not allowed to alter the information\ngoing to Eve. Thus Eve's vacuum measurement must be\nretained.\nThe setup used by Bob to perform the virtual X-basis\nprediction is depicted in Fig. 2. The state from Eve\nis incident to a first vacuum measurement, Bob's vacuum measurement, a projective measurement with certain projectors Q and I \u2212 Q, corresponding to results\n\"nonvacuum\" and \"vacuum\", respectively. Then it goes\nthrough the quantum operation EZ , and leaks partially\nback to Eve. The remaining part is measured by Eve's\nvacuum measurement, and sent through a reversal operation. The goal of the reversal operation is to reverse the\neffect of the vacuum measurement, so that the combined\noperation consisting of Eve's vacuum measurement and\nthe reversal operation is identity, with a certain probability. Finally, the quantum operation EX and Bob's\nthree-outcome measurement are applied.\nTo analyze Bob's virtual prediction, we note the following observations. The quantum operation EZ can be\nviewed as a unitary operation on an extended state space.\nMoreover, since Bob's reversal operation does not have\nto be realizable in practice (only in principle) we may\nassume that Bob has access to any extra degrees of freedom used to \"unitarize\" EZ . He does not have access to\nthe quantum state leaked to Eve; however, the leakage\ndisturbs the probabilities of Bob's prediction by no more\nthan \u000fZ . Therefore, for the moment we can ignore the\nleakage, taking it into account in the final expression for\nthe key rate.\nTo proceed, we need the following results.\nLemma 1 (Koashi and Ueda [20]). Let E, acting on\na Hilbert space H, be a POVM element associated with\nsome measurement M . If any state in some subspace Q \u2286 H is measured with M , the measured state\n\n\f4\ncan be reversed to the original state, with maximum\njoint probability of outcome E and successful reversal\ninf |\u03a6i\u2208Q,h\u03a6|\u03a6i=1 h\u03a6|E|\u03a6i. It is possible to know when the\nreversal is successful or not.\nLemma 2 The output of a quantum operation Eb is measured with projectors P0 , P1 , and I \u2212P0 \u2212P1 , corresponding to detection results \"0\", \"1\", and \"vacuum\", respectively, or alternatively, with P \u2261 P0 + P1 and I \u2212 P . Let\nI \u2212 Q be a projector onto an input subspace of Eb that\nleads to detection result \"vacuum\" with certainty. The\nmeasurement statistics are not changed by the presence\nof a projective measurement {Q, I \u2212 Q} before Eb .\nProof: Lemma 2 is not as trivial as it may appear at first\nsight since states in the support of Q may also lead to detection result \"vacuum\". Thus the measurement before\nEb gives extra information. Nevertheless, the quantum\noperation Eb can be viewed as a unitary transformation\non an extended Hilbert space, with a standard state as\nauxiliary input. Clearly, it does not matter if we measure the extra degrees of freedom at the output. This\nmeasurement can be constructed so that the total output measurement distinguishes between input states in\nthe support of Q or I \u2212 Q. Then, an input measurement\n{Q, I \u2212 Q} is redundant.\nMore precisely, the unitary operator can be chosen\nsuch that the projective measurement at the output is\nimplemented as a measurement of a single qutrit in the\ncomputational basis. Thus it transforms\n|01 i|0iaux \u2192 |vi|\u03c81 i,\n|02 i|0iaux \u2192 |vi|\u03c82 i,\n\n(4a)\n(4b)\n\nand\n|11 i|0iaux \u2192 |vi|\u03c6v1 i + |0i|\u03c601 i + |1i|\u03c611 i,\n\n|12 i|0iaux \u2192\n\n|vi|\u03c6v2 i\n\n+\n\n|0i|\u03c602 i\n\n+\n\n|1i|\u03c612 i,\n\n(5a)\n(5b)\n\netc. Here |0i i and |1i i are bases for the support of I \u2212 Q\nand Q, respectively, |0iaux is the auxiliary standard state,\nand |0ih0| = P0 , |1ih1| = P1 , and |vihv| = I\u2212P0 \u2212P1 . The\n\u03c8- and \u03c6-vectors are (not necessarily normalized) states\nof the remaining part of the output state space. Since\nh1i |0j i = 0, we have h\u03c6vi |\u03c8j i = 0 for any i, j. Thus, by a\nmeasurement of the \u03c8 or \u03c6 part of the output state space\nin addition to the qutrit, we can distinguish between the\n|0i i states and |1i i states. \u0003\nWe define the projector I \u2212 Q so as to project onto\nvacuum in all photonic modes, and onto the biggest subspace of the \"electronic\" modes that gives detection result \"vacuum\" in Eve's vacuum measurement. The orthogonal subspace, which is the support of Q, is denoted\nQ. Lemma 2 ensures that Bob's vacuum measurement\ndoes not change the statistics of Eve's vacuum measurement. When Eve's vacuum measurement gives result\n\"vacuum\", or the reversal operation is not successful,\nthe reversal operation is assumed to output a state in\n\nthe support of I \u2212 Q. Thus in these cases the output of\nBob's virtual prediction is \"vacuum\" with certainty.\nIf the outcome of Bob's vacuum measurement is \"vacuum\", the outcome of Eve's vacuum measurement is\n\"vacuum\", and the reversal operation is successful with\ncertainty. Suppose the outcome of Bob's vacuum measurement is \"nonvacuum\". According to Lemma 1,\nthe maximum joint probability of result E in Eve's\nvacuum measurement and successful reversal is \u03b7Z =\ninf |\u03a6i\u2208Q,h\u03a6|\u03a6i=1 h\u03a6|E|\u03a6i. When result E and the reversal\nis successful (and Bob knows when it is), the statistics of\nBob's measurement compared to Alice's virtual X-basis\nmeasurement will be identical to that of Alice's and Bob's\nordinary parameter estimation in the X-basis, except for\nany disturbance by Bob's vacuum measurement. According to Lemma 2 such disturbance does not exist. The\nnumber of detection events E in Eve's vacuum measurement is nqZ ; of these nqX \u03b7Z is successfully reversed and\ndetected as \"0\" or \"1\" in Bob's virtual prediction. Thus\nwe obtain H \u2264 (nqZ \u2212 nqX \u03b7Z ) + nqX \u03b7Z h(\u03b4X ), which\ngives us the rate\nRZ \u2265 \u03b7Z qX /qZ (1 \u2212 h(\u03b4X )) \u2212 h(\u03b4Z ).\n\n(6)\n\nThe parameter \u03b7Z = inf |\u03a6i\u2208Q,h\u03a6|\u03a6i=1 h\u03a6|E|\u03a6i is the\nminimum probability that a state in Q gives result E by\nEve. This parameter has a clear physical interpretation.\nWhen vacuum is incident to the optical modes, recall\nthat with no loss of generality we may assume that Eve\nhas full control of the detectors through the \"electronic\"\nmodes. Then there are no losses of her excitation in\nthe \"electronic\" modes through the quantum operation\nF. Thus, we identify \u03b7Z as the minimum probability\nthat a nonvacuum photonic state is detected by Bob. In\nother words, 1 \u2212 \u03b7Z is the maximum probability that a\nnonvacuum photonic state is absorbed in the detectors\nand detected as vacuum in the actual setup (Fig. 1).\nSo far we have ignored the effect of any quantum\nleakage from the detectors. Parameterizing the leakage by (3), \u000fZ quantifies the maximum deviation of any\nmeasurement probabilities. In the absence of leakage,\nthe probabilities of correct and incorrect predictions are\nqX \u03b7Z (1 \u2212 \u03b4X ) and qX \u03b7Z \u03b4X , respectively, while the probability of vacuum result is 1 \u2212 qX \u03b7Z . When there is leakage, in the worst case these probabilities are changed to\nqX \u03b7Z (1 \u2212 \u03b4X ) \u2212 \u000fZ , qX \u03b7Z \u03b4X + \u000fZ \u2212 \u03be, and 1 \u2212 qX \u03b7Z + \u03be,\nrespectively. Here \u03be is an unknown parameter satisfying\n0 \u2264 \u03be \u2264 \u000fZ . Of the nqZ nonvacuum results in Eve's\nvacuum measurement, there are n(qX \u03b7Z \u2212 \u03be) nonvacuum\nresults in Bob's virtual prediction. This leads to\nH \u2264 nqZ \u2212 n(qX \u03b7Z \u2212 \u03be)\n\u0012\n\u0013\nqX \u03b7Z \u03b4X + \u000fZ \u2212 \u03be\n+ n(qX \u03b7Z \u2212 \u03be)h\nqX \u03b7Z \u2212 \u03be\n\u0012\n\u0013\n\u000fZ\n\u2264 nqZ \u2212 nqX \u03b7Z + nqX \u03b7Z h \u03b4X +\n.\nqX \u03b7Z\n\n(7)\n\nThe last inequality in (7) can be found after some algebra\nusing the facts that h(u) \u2212 h(u \u2212 \u2206) \u2265 h0 (u)\u2206 for \u2206 \u2265 0\n\n\f5\nand u \u2264 1/2, and h0 (u)(1 \u2212 u) \u2265 1 for u \u2264 0.277. Here\nwe have set u = \u03b4X + qX\u000fZ\u03b7Z .\n\nfollowing conditional probabilities.\np(t = 0|c = 1) = qX (1 \u2212 \u03b4X )\np(t = 0|c = 0) = qph (1 \u2212 \u03b4ph )\np(t = 1|c = 1) = qX \u03b4X\np(t = 1|c = 0) = qph \u03b4ph\np(t = 2|c = 1) = 1 \u2212 qX\np(t = 2|c = 0) = 1 \u2212 qph .\n\nThis gives the rate\n\u0014\n\u0012\n\u0013\u0015\nqX\n\u000fZ\nRZ \u2265 \u03b7Z\n1 \u2212 h \u03b4X +\n\u2212 h(\u03b4Z ),\nqZ\nqX \u03b7Z\n\n(8)\n\nfor \u03b4X + qX\u000fZ\u03b7Z \u2264 0.277. An expression for the rate,\nalso valid for 0.277 \u2264 \u03b4X + qX\u000fZ\u03b7Z \u2264 0.5, can be derived\nstraightforwardly; however, this regime is only relevant\nfor very small \u03b4Z , and large \u03b4X and/or qX\u000fZ\u03b7Z .\n\nIV.\n\nINDIVIDUAL IMPERFECTIONS IN THE\nENTIRE SYSTEM\n\nFrom the previous section we note that when the reversal operation is successful (and Bob knows when it\nis), the measurement statistics in the prediction becomes\nidentical to the statistics if Bob measured in the Xbasis. This makes it possible to consider simultaneous imperfections at the source and detector. We may\nthen consider the case where Alice creates a general\nstate \u03c1a depending on the basis choice a. The basis dependence of the source is characterized by the fidelity\n1\n\u221a\n\u221a\nF (\u03c1Z , \u03c1X ) \u2261 Tr( \u03c1Z \u03c1X \u03c1Z ) 2 . We let this dependence\nbe bounded by a parameter \u2206 defined by F \u2265 1 \u2212 2\u2206.\nBy Uhlmann's theorem there exist purifications, |\u03c7a i of\n\u03c1a , such that h\u03c7Z | \u03c7X i = 1 \u2212 2\u2206. We note that |\u03c7a i can\nbe expressed as in Eq. (1).\nAgain, we first ignore the detector leakage, taking it\ninto account in the final expression for the rate. Since\nBob wants to predict Alice's virtual X-basis measurement on |\u03c7Z i, the parameters \u03b4X and qX in (6) must be\nreplaced with \u03b4ph and qph respectively. Here \u03b4ph is the\nerror rate when Alice measures her part of |\u03c7Z i in the\nX-basis and Bob measures his part using MX .\nIn BB84 such a measurement is not actually performed, but \u03b4ph can be bounded from the measured error\nand transmission rates. We expand the statistical argument from [14] to include \"vacuum\" as a possible measurement result. Assume that for the systems used in the\nrandom sampling Alice chooses her basis by measuring a\nquantum coin in the Z-basis. Then these systems\n\u221a can be\ndescribed by state |\u03a8i = (|\u03c7Z i |0i + |\u03c7X i |1i)/ 2, with\nthe last system being that of the quantum coin.\nWe then consider the situations where Alice and Bob\nboth conduct X-basis measurements. For each measurement a variable t is assigned the value t = 0 if their\nresults are the same, t = 1 if there is an error, and t = 2\nif Bob gets no result. Alice then measures her quantum\ncoin in the Z-basis, getting the result c. We obtain the\n\n(9a)\n(9b)\n(9c)\n(9d)\n(9e)\n(9f)\n\nAssuming that the systems used to estimate error and\ntransmission rates are randomly chosen, the probabilities\ngiven c = 0 are also valid for the systems used to extract\nthe raw key.\nNow assume that for some states Alice measure the\ncoin in the X-basis getting measurement result c\u0304. Note\nthat\nX\np(t = j)p(c\u0304 = 1|t = j) = \u2206.\n(10)\nj\n\nUsing (9), (10) and the bound [21]\n(1 \u2212 2p(c\u0304 = 1|t = j))2 + (1 \u2212 2p(c = 0|t = j))2 \u2264 1\nwe find\n1 \u2212 2\u2206 \u2264\n=\n\nq\n\n+\n\nq\n\nXp\np(t = j|a = Z)p(t = j|a = X)\n\n(11)\n\nj\n\nqX (1 \u2212 \u03b4X )qph (1 \u2212 \u03b4ph ) +\n\np\n\nqX \u03b4X qph \u03b4ph\n\n(1 \u2212 qX )(1 \u2212 qph ).\n\n\u03b4ph can now be taken to be the maximal value for which\nthe inequality is obeyed.\nSimilarly to the analysis in the previous section, we\ncan include detector leakage by modifying the detection\nprobabilities. As in (8), the leakage is accounted for by\nadding a term proportional to the leakage parameter \u000fZ ,\n\u03b4\u0303ph \u2264 \u03b4ph +\n\n\u000fZ\n.\nqph \u03b7Z\n\n(12)\n\nWe have arrived at our main result.\nTheorem 1 In BB84 the basis-dependence of Alice's\nsource is bounded by F (\u03c1X , \u03c1Z ) \u2265 1 \u2212 2\u2206. Bob's detectors are modeled by a passive, basis-dependent quantum\noperation (FZ and FX ) acting on the multimode photonic\nstate, followed by a basis-independent quantum operation\n(F) describing interaction with internal degrees of freedom in the physical detector, followed by a measurement\nwith three outcomes \"0\", \"1\", and \"vacuum\". Suppose\nEve controls the photonic modes and the internal degrees\nof freedom in the detectors, and that a quantum state\nleaks back to Eve from the detectors. Then the asymptotic secure key generation rate for key extraction in the\nZ-basis satisfies\nh\ni\nRZ \u2265 \u03b7Z qph /qZ 1 \u2212 h(\u03b4\u0303ph ) \u2212 h(\u03b4Z ),\n(13)\n\n\f6\nprovided \u03b4\u0303ph \u2264 0.277. Here \u03b4Z is the estimated error rate\nin the Z-basis, \u03b4\u0303ph is given by (11) and (12), 1\u2212\u03b7Z is the\nmaximum probability that a non-vacuum photonic state\nis detected as \"vacuum\", and qph /qZ is the ratio between\nthe detection rates for Bobs measurements MX and MZ\ngiven that Alice sends in the Z-basis.\nThe rate (13) is valid for any kinds of individual imperfections and loss. The parameters qX , qZ , qph , \u03b4X , and\n\u03b4Z are estimated directly in the protocol, while \u2206, \u03b7Z ,\nand \u000fZ characterize the practical setup.\nV.\n\n0.15\n\n0.1\n\u2206/q\n\n0.05\n\n\u03b7Z=0.1\n\nDISCUSSION OF RESULTS\n\nIn this discussion we assume that the quantum channel\nis symmetric with respect to loss i.e. qX = qph = qZ \u2261 q.\nThis will be approximately true for most setups. We\nalso assume no information returned to Eve from the\ndetectors, \u000fZ = 0, anticipating that such errors could\nbe avoided by modifying the setup.\nIn this case (11) reduces to\nq\np\n2\u2206\n\u2265 1 \u2212 (1 \u2212 \u03b4X )(1 \u2212 \u03b4ph ) \u2212 \u03b4X \u03b4ph\n(14)\nq\nand the estimated worst possible error rate is:\n(\n1\n\u2206\n\u2206\n\u03b4ph = min\n, \u03b4X + 8\n(1 \u2212 )(1 \u2212 2\u03b4X )\n2\nq\nq\ns\n!)\n\u2206\n\u2206\n(1 \u2212 )\u03b4X (1 \u2212 \u03b4X )\n+\nq\nq\n\n0\n0\n\n\u03b7Z=0.5\n\n0.02\n\n\u03b7Z=1\n\n0.04\n\n\u03b4\n\n0.06\n\n0.08\n\n0.1\n\n1\n\u2206/q=0.05\n\n\u2206/q=0.01\n\n\u2206/q=0\n\n0.8\n\n0.6\n\u03b7Z\n0.4\n\n0.2\n\n(15)\n0\n0\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n\n0.1\n\n\u03b4=0.001\n\n\u03b4=0\n\n\u03b4\n\nWe see that errors in the source are more critical when\nthe transmission is low. This is due to Eves control of\nthe channel, which let her pass to Bob only the systems\nwhere her operation has given her the most information\nfor the least disturbance. If the source is perfect, \u2206 = 0,\nloss in the channel does not affect the secret key rate.\nThe upper limit on\u221a the source error for which key gain\n2\u22121\n\u221a\nis possible is \u2206\nq \u2264 2 2 \u2248 0.146. This is independent of\nthe detector parameter \u03b7Z , as long as it is nonzero, but\ndemands error rates equal to zero. For larger error rates\nthe limit depends heavily on \u03b7Z , Fig. 3.\nChannel loss and imperfect sources only contributes\nto an increase in \u03b4ph . A better estimate of \u03b4ph would\nincrease the rate. This is related to the method of decoy states [22\u201324], where Alice instead of producing \u03c1Z ,\nsometimes produces a decoy state with a different mean\nphoton number. From the transmission and error rates\nfor this state, Alice and Bob are able to derive a stricter\nbound on \u03b4ph effectively reducing RZ 's dependence of\nchannel loss. To generalize this method, using decoy\nstates where other properties of the signal state are varied, might prove useful when operating with an imperfect source. However creating such states may require\nthe detailed output statistics of the source, and might be\nexperimentally difficult in general.\n\n1\n\u03b4=0.07\n\n\u03b4=0.01\n\n0.8\n\n0.6\n\u03b7Z\n0.4\n\n0.2\n\n0\n0\n\n0.04\n\n0.08\n\u2206 /q\n\n0.12\n\n0.16\n\nFIG. 3: Plots showing the security bounds RZ = 0 for different values of \u03b7Z , \u03b4, and \u2206\n. The security bound is found\nq\nby setting RZ = 0 in (13). Positive key gain is possible for\nparameter values to the left of the curves. We have assumed\n\u000fZ = 0, \u03b4X = \u03b4Z = \u03b4 and qX = qph = qZ = q.\n\n\f7\nConsidering the special case of a perfect source, our\nrate is larger than the rate proved for restricted detector\nflaws in previous literature [6, 7]. Key gain is possible\nh(\u03b4Z )\nfor \u03b7Z \u2264 1\u2212h(\u03b4\n. Unlike previous results, our rate apX)\nplies to all relevant, individual imperfections at the detectors; for example, mode coupling including misalignments and multiple reflections, nonlinearities, mode dependent losses and detector efficiency mismatch, and any\nbasis dependence of those effects. Moreover it applies to\nthreshold detectors with dark counts.\nNote that the detector blinding parameter \u03b7Z is not\nsupposed to contain the transmission efficiency of the\nchannel. Generally one should factorize EZ = \u1ebcZ \u25e6 E\nand EX = \u1ebcX \u25e6 E to put as much as possible of the imperfections into the basis-independent operation E. By\nabsorbing E into Eve and treating \u1ebcZ and \u1ebcX as the new\nimperfections, \u03b7Z will be maximal. For example, for the\ncase where reduced detector efficiencies can be described\nas beamsplitters in front of ideal detectors, and if there\nis no coupling between modes associated with different\nlogical bits, \u03b7Z is the minimum ratio between the two\ndetection efficiencies [7]. For detectors that cannot be\nmodeled by beamsplitters in front of ideal detectors, our\nsecurity proof clearly shows the danger associated with\nthe possibility of detector blinding [13]: If the detection\nprobability of a nonvacuum state is zero, our proof predicts zero key rate. For the case where the detectors can\n\nonly be partially blinded, our proof can predict positive\nrate.\nReturning to the general case, the rate is dependent on\n\u2206, \u03b7Z , and \u000fZ , in addition to estimated parameters. For\na specific QKD setup, \u2206 and \u000fZ must be upper bounded,\nand \u03b7Z and must be lower bounded. How to deal with\nthis in practice, is an interesting question for future research.\n\n[1] C. H. Bennett and G. Brassard, in Proceedings of IEEE\nInternational Conference on Computers, Systems, and\nSignal Processing (IEEE Press, New York, Bangalore,\nIndia, 1984), pp. 175\u2013179.\n[2] D. Mayers, in Proceedings of Crypto \u030196, edited by\nN. Koblitz (Springer, New York, 1996), vol. 1109, pp.\n343\u2013357.\n[3] H. Inamori, N. L\u00fctkenhaus, and D. Mayers, e-print\nquant-ph/0107017 (2001).\n[4] M. Koashi and J. Preskill, Phys. Rev. Lett. 90, 057902\n(2003).\n[5] D. Gottesman, H.-K. Lo, N. L\u00fctkenhaus, and J. Preskill,\nQuantum Information & Computation 4, 325 (2004).\n[6] C.-H. F. Fung, K. Tamaki, B. Qi, H.-K. Lo, and X. Ma,\nQuantum Information & Computation 9, 131 (2009).\n[7] L. Lydersen and J. Skaar, Quant. Inf. Comp 10, 0060\n(2010).\n[8] M. Hayashi, Phys. Rev. A 76, 012329 (2007).\n[9] A. K. Ekert, Phys. Rev. Lett. 67, 661 (1991).\n[10] J. Barrett, L. Hardy, and A. Kent, Phys. Rev. Lett. 95,\n010503 (2005).\n[11] A. Ac\u0131\u0301n, N. Brunner, N. Gisin, S. Massar, S. Pironio, and\nV. Scarani, Phys. Rev. Lett. 98, 230501 (2007).\n[12] V. Makarov, A. Anisimov, and J. Skaar, Physical Review\nA 74, 022313 (2006), ibid. 78, 019905 (2008).\n[13] V. Makarov, New J. Phys. 11, 065003 (2009).\n[14] M. Koashi, New Jornal of Physics 11, 045018 (2009).\nM. Koashi, e-print quant-ph/0505108v1 (2005).\n[15] M. Koashi, e-print quant-ph/0609180 (2006).\n\n[16] H. Maassen and J. B. M. Uffink, Phys. Rev. Lett. 60,\n1103 (1988).\n[17] N. J. Beaudry, T. Moroder, and N. L\u00fctkenhaus, Phys.\nRev. Lett. 101, 093601 (2008).\n[18] T. Tsurumaru and K. Tamaki, Phys. Rev. A 78, 032302\n(2008).\n[19] M. A. Nielsen and I. L. Chuang, Quantum computation\nand quantum information (Cambridge University Press,\nCambridge, 2000).\n[20] M. Koashi and M. Ueda, Phys. Rev. Lett. 82, 2598\n(1999).\n[21] K. Tamaki, M. Koashi, and N. Imoto, Phys. Rev. Lett.\n90, 167904 (2003).\n[22] W. Y. Hwang, Phys. Rev. Lett. 91, 057901 (2003).\n[23] H.-K. Lo, X. F. Ma, and K. Chen, Phys. Rev. Lett. 94,\n230504 (2005).\n[24] X.-B. Wang, Phys. Rev. Lett. 94, 230503 (2005).\n[25] H.-K. Lo and H. F. Chau, Science 283, 2050 (1999).\n[26] For any protocol, Bob's basis choice (or more generally,\nmeasurement setting) must be random and come from a\ntrusted random number generator; otherwise Eve could\nperform the same measurement as Bob to obtain a perfect\ncopy of his result.\n[27] The Z-basis error rate \u03b4Z is not needed to ensure that\nAlice's key is secret; thus there is no need to invoke the\nclassicalization argument [25] regarding statistics of measurements involved in the simultaneous estimation of \u03b4X\nand \u03b4Z .\n\nVI.\n\nCONCLUSION\n\nWe have proved security for arbitrary, individual imperfections in a BB84 system. The detector model includes a basis dependent quantum operation, possibly\nwith quantum leakage back to Eve, followed by a threeoutcome measurement with outcomes \"0\", \"1\", and \"vacuum\". Such a general detector model can describe detector efficiency mismatch, nonlinear blindable behavior,\nresponse to multiple modes, mode coupling and multiple\nreflections, misalignments, back-reflection leakage, nonoptical leakage, etc. By reversal of the receipt acknowledgment measurement on Bob's side (Eve's vacuum measurement), we show how to treat the general case with\na lossy channel and general, individual imperfections at\nthe source, combined with the flawed detector.\n\n\f"}