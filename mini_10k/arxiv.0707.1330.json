{"id": "http://arxiv.org/abs/0707.1330v1", "guidislink": true, "updated": "2007-07-09T20:01:33Z", "updated_parsed": [2007, 7, 9, 20, 1, 33, 0, 190, 0], "published": "2007-07-09T20:01:33Z", "published_parsed": [2007, 7, 9, 20, 1, 33, 0, 190, 0], "title": "Proving the triviality of rational points on Atkin-Lehner quotients of\n  Shimura curves", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0707.0973%2C0707.2088%2C0707.2381%2C0707.0906%2C0707.4589%2C0707.0589%2C0707.0980%2C0707.4576%2C0707.3643%2C0707.2607%2C0707.4296%2C0707.1411%2C0707.4464%2C0707.3975%2C0707.1740%2C0707.3933%2C0707.3507%2C0707.1088%2C0707.1582%2C0707.1058%2C0707.4096%2C0707.4562%2C0707.3531%2C0707.1641%2C0707.0039%2C0707.1831%2C0707.0819%2C0707.3829%2C0707.2520%2C0707.0064%2C0707.0200%2C0707.2799%2C0707.3562%2C0707.0078%2C0707.1373%2C0707.3959%2C0707.0188%2C0707.4158%2C0707.0812%2C0707.4059%2C0707.3542%2C0707.2059%2C0707.0046%2C0707.1694%2C0707.2198%2C0707.4509%2C0707.4191%2C0707.2560%2C0707.3969%2C0707.3383%2C0707.2790%2C0707.4294%2C0707.1298%2C0707.1471%2C0707.2123%2C0707.1321%2C0707.2263%2C0707.4177%2C0707.1810%2C0707.2802%2C0707.2115%2C0707.4129%2C0707.0879%2C0707.4551%2C0707.0113%2C0707.4418%2C0707.2241%2C0707.3306%2C0707.1330%2C0707.3634%2C0707.4211%2C0707.0418%2C0707.3689%2C0707.1422%2C0707.2236%2C0707.3663%2C0707.1529%2C0707.4338%2C0707.1036%2C0707.2472%2C0707.3775%2C0707.1585%2C0707.2497%2C0707.4184%2C0707.0476%2C0707.0490%2C0707.3425%2C0707.1064%2C0707.0084%2C0707.2640%2C0707.4271%2C0707.4628%2C0707.1941%2C0707.1993%2C0707.1118%2C0707.3137%2C0707.4324%2C0707.1606%2C0707.3855%2C0707.0989%2C0707.3676&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Proving the triviality of rational points on Atkin-Lehner quotients of\n  Shimura curves"}, "summary": "In this paper we give a method for studying global rational points on certain\nquotients of Shimura curves by Atkin-Lehner involutions. We obtain explicit\nconditions on such quotients for rational points to be ``trivial'' (coming from\nCM points only) and exhibit an explicit infinite family of such quotients\nsatisfying these conditions.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0707.0973%2C0707.2088%2C0707.2381%2C0707.0906%2C0707.4589%2C0707.0589%2C0707.0980%2C0707.4576%2C0707.3643%2C0707.2607%2C0707.4296%2C0707.1411%2C0707.4464%2C0707.3975%2C0707.1740%2C0707.3933%2C0707.3507%2C0707.1088%2C0707.1582%2C0707.1058%2C0707.4096%2C0707.4562%2C0707.3531%2C0707.1641%2C0707.0039%2C0707.1831%2C0707.0819%2C0707.3829%2C0707.2520%2C0707.0064%2C0707.0200%2C0707.2799%2C0707.3562%2C0707.0078%2C0707.1373%2C0707.3959%2C0707.0188%2C0707.4158%2C0707.0812%2C0707.4059%2C0707.3542%2C0707.2059%2C0707.0046%2C0707.1694%2C0707.2198%2C0707.4509%2C0707.4191%2C0707.2560%2C0707.3969%2C0707.3383%2C0707.2790%2C0707.4294%2C0707.1298%2C0707.1471%2C0707.2123%2C0707.1321%2C0707.2263%2C0707.4177%2C0707.1810%2C0707.2802%2C0707.2115%2C0707.4129%2C0707.0879%2C0707.4551%2C0707.0113%2C0707.4418%2C0707.2241%2C0707.3306%2C0707.1330%2C0707.3634%2C0707.4211%2C0707.0418%2C0707.3689%2C0707.1422%2C0707.2236%2C0707.3663%2C0707.1529%2C0707.4338%2C0707.1036%2C0707.2472%2C0707.3775%2C0707.1585%2C0707.2497%2C0707.4184%2C0707.0476%2C0707.0490%2C0707.3425%2C0707.1064%2C0707.0084%2C0707.2640%2C0707.4271%2C0707.4628%2C0707.1941%2C0707.1993%2C0707.1118%2C0707.3137%2C0707.4324%2C0707.1606%2C0707.3855%2C0707.0989%2C0707.3676&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper we give a method for studying global rational points on certain\nquotients of Shimura curves by Atkin-Lehner involutions. We obtain explicit\nconditions on such quotients for rational points to be ``trivial'' (coming from\nCM points only) and exhibit an explicit infinite family of such quotients\nsatisfying these conditions."}, "authors": ["Pierre Parent", "Andrei Yafaev"], "author_detail": {"name": "Andrei Yafaev"}, "author": "Andrei Yafaev", "arxiv_comment": "25 pages. To appear in Mathematische Annalen", "links": [{"href": "http://arxiv.org/abs/0707.1330v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0707.1330v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0707.1330v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0707.1330v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:0707.1330v1 [math.NT] 9 Jul 2007\n\nProving the triviality of rational points on\nAtkin-Lehner quotients of Shimura curves\nPierre Parent and Andrei Yafaev\nAbstract\nIn this paper we give a method for studying global rational points on certain quotients\nof Shimura curves by Atkin-Lehner involutions. We obtain explicit conditions on such quotients for rational points to be \"trivial\" (coming from CM points only) and exhibit an explicit\ninfinite family of such quotients satisfying these conditions.\n\n1 Introduction.\nThe study of points on Shimura curves rational over number fields or, more precisely, finding\nfamilies of such curves whose only rational points are special (or CM) is an interesting problem\nfor several reasons. One reason is that these curves may provide non-trivial examples of violation\nof the Hasse principle accounted for by the Brauer-Manin obstruction. This question was the\nmain motivation for [31], [27], [29] and [30].\nAnother motivation is the question of scarcity of possible endomorphism algebras of abelian\nvarieties over Q of GL2 -type. Let us explain this in more detail, following the introduction to\n[5]. One says that an abelian variety A over Q is of GL2 -type if the endomorphism algebra\nQ \u2297 EndQ (A) is a number field of degree dim(A). In loc. cit. the authors formulate the following conjecture (attributed to Coleman, also made by Clark and Mazur): for g any positive integer,\nthe number of isomorphism classes of Q-endomorphism algebras of g-dimensional abelian varieties of GL2 -type is finite. We refer to loc. cit. for more details on this and just mention that\nthe \"GL2 -type\" hypothesis in the conjecture is motivated by a conjecture of Ribet predicting that\nabelian varieties over Q of GL2 -type are modular: in the latter case, the extended experimental\nknowledge available on modular abelian varieties gives evidence supporting the conjecture. Note\nalso that, as Ribet himself has shown, his conjecture follows from Serre's conjecture on modularity of mod p representations, and that a proof of this conjecture has recently been announced by\nKhare et al. For g = 1, the theory of complex multiplication, plus the classical result that there\n1\n\n\fis only a finite number of quadratic imaginary orders with class number 1, show that Coleman's\nconjecture is true. For g \u2265 2 very little is known. When g = 2 the endomorphism algebras that\nmay occur are orders in either M2 (Q), or M2 (K) for K an imaginary quadratic field (in these\ncases the abelian surfaces are geometrically reducible), or (in the irreducible case) a quadratic\nfield or an indefinite division quaternion algebra over Q (see [5], introduction and references\ntherein).\nThe diophantine study of Shimura curves allows to address the question of excluding this\nlatter case of (potential) quaternionic multiplication, as these curves are coarse moduli spaces for\nabelian surfaces endowed with a geometric action of some order in a quaternion algebra. Indeed\nif D is an integer which is the product of an even number of distinct primes and m is a square-free\ninteger, we say that the pair (D, m) is of GL2 -type if there is an abelian surface A over Q such\n\u221a\nthat EndQ (A)\u2297Q = Q( m) and EndQ (A)\u2297Q = BD (the quaternion algebra ramified at primes\ndividing D). Let X D be the Shimura curve over Q attached to a maximal order in BD (denoted\nby XD in [5]), and if n is a divisor of D, let wn be the Atkin-Lehner involution associated to n.\nRecall that a point on these curves is said to be a special (or CM) point if the underlying abelian\nsurface A is isogenous to a square of an elliptic curve having complex multiplication by a field K\n(in which case EndQ (A) \u2297 Q \u2243 M2 (K) contains any rational quaternion algebra split over K).\nWith the above notations Rotger proves the following result: if (D, m) is a pair of GL2 -type over\nQ, then m|D and X D /wm (Q) is non-trivial, i.e. contains a non-special point (see [25], Theorem\n4.4).\nIt has long been known that X D (Q) is empty (in fact X D (R) = \u2205). More generally the results\nof Jordan, Livn\u00e9, Ogg, Shimura and some others give a description of the set of local points on\nShimura curves and their Atkin-Lehner quotients. Their results provide necessary conditions for\nX D /wm to have local points everywhere, and this leads to the following (see [27], Theorem 3.1):\n\nTheorem 1.1 If X D /wm (Q) 6= \u2205, then either m = D or m =\u0010D/p\n\u0011 for some p dividing D .\nq\nFurthermore if (D, m) = (pq, q) for two odd primes p and q then p = \u22121 and either:\n\n1. p \u2261 3 mod 4, or\n2. p \u2261 1 mod 4 and q \u2261 3 mod 4.\nThe case m = D is one of the main questions addressed by P. Clark in [6]. Unfortunately, the\nmethod we develop in this paper does not work in this case. The reason is that our method relies,\nin a crucial way, on the existence of a non-trivial rank zero quotient of the jacobian of the curve.\nConsiderations of the sign of the functional equation of L-functions show that the jacobian of\n2\n\n\fthe curve X D /wD has no non-trivial rank-zero quotient (at least if one believes in the Birch and\nSwinnerton-Dyer conjecture).\nHowever in the case where m = D/p, there is no obstruction to the existence of such a\nquotient coming from the sign of the functional equation. Let X be the curve X D /wm . We\nare interested in determining whether X(Q) is \"trivial\" (in the sense that it consists only of\nspecial points). Our strategy follows the lines of the paper [22] of the first author, with several\nnew ingredients. More precisely a local study as in [21], section 1, leads to considering two\nsubcases that Ogg calls \"ramifi\u00e9\" and \"non-ramifi\u00e9\" (see loc. cit., p. 204 et seq.) that correspond\nrespectively to the two cases at the end of the above theorem. For technical reasons it is easier\nto push our methods further in the latter (\"non-ramifi\u00e9\") case, and we limit ourselves to this case\nin this paper. For a given pair (pq, q) one can in principle verify, by computation, whether our\nconditions are satisfied. However in this article we were not able to make our method work for\ninfinitely many qs. We nevertheless conclude our paper by exhibiting an infinite family of AtkinLehner quotients of Shimura curves whose only possible rational points are trivial in the above\nsense, although these curves may have local points at every prime of bad reduction. (Actually,\none can also check that in our family, there are no Q-rational special points either, so the set of\nrational points is empty; see section 6). As far as we know, this was previously known for finitely\nmany curves only (but see also Rotger's result discussed below).\nWe close this introduction by discussing a recent result, similar to the one obtained in this\narticle. After the present paper was completed we learned from V. Rotger that he could also\nprove the triviality of rational points in infinite families of Atkin-Lehner quotients of Shimura\ncurves, but in the \"ramifi\u00e9\" case quoted above, more precisely for pairs (pq, q) as in the first case\nof Theorem 1.1 (see [26], Theorem 1.2). His methods are totally different from ours: he uses the\nmodular interpretation of the points on the Shimura curves and analyzes the Galois representations provided by torsion points of the corresponding abelian surfaces. Note that our results are\ncomplementary as we focus on the \"non-ramifi\u00e9\" case. In fact, as Rotger himself pointed out\nto us, it follows from his work that in this latter case the field of definition of modular points is\ndifferent from the field of moduli, i.e. the Q-valued points correspond to abelian surfaces that\ncannot be defined over Q. On the other hand, our methods do not use the modular interpretation\nof the points, so they cover cases that cannot be tackled by Rotger's techniques.\n\n1.2 The strategy.\nWe now sketch our method. Suppose that D is a product of two primes D = pq and m is q. Let\nX := X pq /wq be as above and suppose that there is a point P in X(Q). Assume that we are in\nthe case 2 of Theorem 1.1. Consider the model of X over Zp given by the Cherednik-Drinfeld\n3\n\n\ftheorem and let X\u0303 be the regular model of X obtained by blowing-up at singular points. Looking\nat the specialization of P in X\u0303 at p, one sees as in [21], p. 205, that P specializes precisely to an\nexceptional component coming from a blow-up of a singular point of width 2 in the special fiber\nof X, i.e. a singular point having \"multiplication by i\". The same is true for wp (P ), therefore the\nspecializations of our two rational points P and wp (P ) belong to the smooth locus of the same\nsm\ninto the N\u00e9ron model\nexceptional component at p. Let \u03c6P be the Albanese embedding of X/Z\np\nof its jacobian J defined by \u03c6P (Q) = (Q) \u2212 (P ). Let Xp+1,Q be the curve (p + 1)\u03c6P (XQ ) in JQ .\nAssuming that p is much larger than q we prove that Xp+1,Q has, at least locally, a smooth\nmodel around 0Fp , and the points (p + 1)\u03c6P (P ) and (p + 1)\u03c6P (wp (P )) coincide in Xp+1 (Fp ).\nThis is the content of sections 2 and 3. We hope that the description we give here of the asymptotic shape (as the discriminant increases) of the graph of special fibers of Shimura curves, and\ntherefore of the component groups of their jacobians, can be of independent interest.\nNext we consider the natural map \u03a8P from X to the \"winding quotient\" Je of J. We prove\nas in [22] that, if one can find on the graph of X a closed path \"made\" of Gross-Heegner vectors\ncontaining the component of P (Fp ), then \u03a8P is a formal immersion at our point PFp . This is\nproved in section 5, using the results of section 4. As p + 1 is prime to p, the same is true for the\nmap from Xp+1 to Je at (p + 1)\u03c6P (P )Fp . The classical argument of Mazur's method now applies,\ngiving that (p + 1)\u03c6P (P ) = (p + 1)\u03c6P (wp (P )) in Xp+1 (Q), so (p + 1)((P ) \u2212 (wp (P ))) = 0\nin J(Q). This means that either P = wp (P ), in which case P is indeed a special point, or X\nhas gonality less than p + 1. If q is larger than 245 this contradicts Abramovich's bound on the\ngonality of Shimura curves, and this argument concludes the proof (see Theorem 5.3).\nOne sees from the above sketch that one of the main problems is to construct a \"closed path\nmade of Gross-Heegner vectors containing the component of P (Fp ) on the graph of X\". This is\nwhat we do in the last section for a fixed q = 251, and p ranging through an infinite set of primes\nsatisfying certain congruences.\nAcknowledgments.\nWe are grateful to Bas Edixhoven, Qing Liu, Victor Rotger and Emmanuel Ullmo for instructive\ndiscussions on the subject of this paper. We thank the referee for useful comments and\nsuggestions.\n\n2 Admissible curves and their jacobians.\nWe start by recalling the notion of admissible curve in the sense of Jordan and Livn\u00e9, and some of\ntheir basic properties. The theorem of Cherednik and Drinfeld implies that the Shimura curves\n\n4\n\n\fand their Atkin-Lehner quotients have natural models which are admissible curves at primes\ndividing their discriminant. For more details we refer to [17], section 3, or [24], section 2.\nLet p be a prime number and K a p-adic field with ring of integers O, uniformizer \u03c0 and\nresidue field k. Let X be a proper and flat curve over O. We say that X is admissible if its\ngeneric fiber XK is smooth over K, its special fiber Xk is potentially (i.e., after a finite extension\nof k) a union of projective lines with reduced normal crossings, and each singularity of Xk has\na local equation xy = \u03c0 e where e \u2265 1 is some integer called the width of the singularity. The\ncurve X is regular at a singular point if and only if the width of this point is 1. From an arbitrary\nadmissible curve X one obtains a regular one X\u0303 by making successive blow-ups at the singular\npoints. This leads to replacing a singularity of width e by a chain of e \u2212 1 projective lines whose\nintersections points have width 1. We write X sm for the largest open subset of X which is smooth\nover O.\nThe fiber Xk of an admissible curve is combinatorially described by its dual graph, which\nwe denote by G(Xk ). Recall that this is the unoriented graph whose vertices V are the components of Xk , and whose edges E are the singular points of Xk : an edge links two vertices if\nthe corresponding singular point is the intersection point of the two corresponding components.\nOne endows each edge with a length, which is defined to be the width of the corresponding\nsingularity.\nThe neutral component Pic0 (Xk ) of the Picard scheme of Xk is a torus whose character\ngroup is isomorphic to the homology group H1 (G(Xk ), Z). It follows from the above that the\nregularization of Xk amounts to replacing each edge of length e in G(Xk ) by a chain of e edges of\nlength 1. This shows that H1 (G(Xk ), Z) and H1 (G(X\u0303k ), Z) are canonically isomorphic. There is\na canonical Euclidean pairing (the monodromy pairing) on H1 (G(Xk ), Z) which is deduced from\nthe pairing on ZE defined by hei , ej i = width(ei )\u22121 \u03b4i,j (here \u03b4 denotes the Kronecker symbol).\nThe following proposition explicits the isomorphism Pic0 (Xk ) \u2243 H1 (G(Xk ), Z) \u2297 Gm of [15],\n12.3.7.\nProposition 2.1 Let X be an admissible curve over O as above and let Xk be its special fibre. Let\nC0 be a component of Xk , and H be the subgroup of Pic0 (Xk ) consisting of linear equivalence\nclasses of Weil divisors of degree zero on Xk whose support is contained in the smooth locus\nC0sm of C0 . Let {Ci }, i = 1, . . . , n be the set of connected components of Xk \\C0sm . For each i let\nAij , j = 1, . . . , ni be the set of singular points of C0 \u2229 Ci . Let x be a coordinate function on the\nrational curve C0 .\nThere is a k -isomorphism from Pic0 (Xk ) to T1 \u00d7 * * * \u00d7 Tn \u00d7 T , where the Ti 's and T are\nP\nP\ntori with dim(Ti ) = ni \u2212 1, such that any element r (Pr ) \u2212 r (Qr ) of H is mapped to\nQ\nQ\nx(Aij )\u2212x(Pr )\ni1 )\u2212x(Qr )\n(( r x(A\n*\n)\n)\n\u00d7 1 in ( ni=1 Ti (k)) \u00d7 T (k).\nx(Aij )\u2212x(Qr ) x(Ai1 )\u2212x(Pr ) 2\u2264j\u2264ni 1\u2264i\u2264n\n5\n\n\fProof. Let D be a divisor on Xk . Let fD be a function on the normalization of Xk having\ndivisor D|C on each component C(\u2243 P1k ). Let B be a basis of H1 (G(Xk ), Z). One associates to\nQ\nD the element ( hi ,h=P hi (fD (s(hi ))/fD (t(hi ))))h\u2208B of H1 (G(Xk ), Z) \u2297Gm , where the symbol\nP\nh = hi denotes the path h consisting of successive edges hi , and s(hi ), t(hi ) denote the points\nof Xk corresponding to the source and target of hi respectively (with respect to some fixed\norientation on the graph).\nAs H1 (G(Xk ), Z) = \u22951\u2264i\u2264n H1 (G(Ci \u222a C0 ), Z), we can suppose without loss of generality that n = 1. We have H1 (G(Xk ), Z) = H1 (G \u2032 , Z) \u2295 H1 (G(C1 ), Z) where G \u2032\nis the graph of some sub-curve C \u2032 of Xk , and this splitting induces a decomposition\nPic0 (Xk ) \u2243 H1 (G \u2032 , Z) \u2297 Gm \u00d7 H1 (G(C1 ), Z) \u2297 Gm . The subgroup H is mapped isomorphically\nto the first factor, and has trivial image in the second. Indeed, as above, we associate to an eleP\nment D = r (Pr ) \u2212 (Qr ) of H a function fD on Xk defined by fD \u2261 1 on the complement of\nQ x\u2212x(Pr )\non C0 . The map sending D to (fD (A1,j )/fD (A1,1 ))2\u2264j\u2264n1 identifies\nC0 and fD (x) = r x\u2212x(Q\nr)\nn1 \u22121\nH with Gm .\n\u0003\nThis proposition describes the Albanese images of an admissible curve in its jacobian. We\nare now interested in models of the multiples of these images. More precisely, letting X be an\nadmissible curve over Spec(O), we let JK := Jac(XK ) and J be its N\u00e9ron model over Spec(O).\nLet P and P0 be two points of X(O). Call \u03c6 : X sm \u2192 J the Albanese embedding defined by\n\u03c6(Q) := (Q) \u2212 (P0 ). For any integer n the image of XK by n * \u03c6K in the generic fiber of J is\na proper curve over K which we call Xn,K . Following [11], section 9, we say that a point on an\nadmissible curve is non-disconnecting if the special fiber of the curve deprived from this point\nremains connected.\nProposition 2.2 Assume the following:\n\n1. the points P and P0 specialize to the same component C0 of Xk ;\n2. the component C0 intersects other components at two singular points only, which are nondisconnecting;\n3. \u03c6(XK ) \u2229 JK [n] = {0};\n4. the image of X by \u03c6 has no non-trivial n-torsion in the component group of J , i.e. if\nC 6= C0 is a component of Xk then n * \u03c6(C sm ) 6\u2286 Jk0 .\nThen there is a smooth model of Xn,K over O, i.e. a smooth Spec(O)-scheme Xn of relative\ndimension 1 such that Xn \u00d7Spec(O) Spec(K) = Xn,K , which contains n * \u03c6(P )(Spec(O)) and\nn * \u03c6(P0 )(Spec(O)).\n6\n\n\fProof. Let J 0 be the neutral component of J and let Pic0 (X) be the usual functor from the\ncategory of Spec(O)-schemes to the category of groups which associates to S the group of\ninvertible sheaves having degree 0 on every component of X \u00d7Spec(O) S. As X is semistable\nover O the scheme J 0 is semiabelian, so it represents Pic0 (X) (see [23], proof of Th\u00e9or\u00e8me 2,\ni)). Therefore the assumption 1 implies that J 0 contains \u03c6(P ) and \u03c6(P0 ) = 0. Let Xn be the\nscheme-theoretic closure of n * \u03c6(X)K in J 0 , i.e. the smallest closed subscheme (with reduced\ninduced structure) of J 0 containing n * \u03c6(X)K . Let A1 and A2 be the singular points of C0 .\nProposition 2.1 says that for Q \u2208 C0 (k)\\{A1 , A2 },\n\u03c6(Q) = \u03bb(x(Q) \u2212 x(A1 ))/(x(Q) \u2212 x(A2 )) \u00d7 1\nin a suitable decomposition Pic0 (Xk ) \u2243 T1 \u00d7 T (with \u03bb = (x(P0 ) \u2212 x(A2 ))/(x(P0 ) \u2212 x(A1 ))).\nOne deduces from that and the assumption 2 that the special fibre of Xn contains the same onedimensional subtorus T1 of Jk0 as the image of the component C0sm of X. By [14], Proposition\n2.8.1, Xn (which is a scheme-theoretic closure) is flat over Spec(O). The assumption 3 insures\nthat Xn is smooth over K. To prove the smoothness of Xn over O it is therefore enough to prove\nthat its special fiber is smooth over k, and this in turn follows from the assumption 4.\n\u0003\n\n3 Bad reduction of Shimura curves.\nIn this section we specialize the above considerations to the case of Shimura curves. We begin by\nrecalling some basic facts. Let D be a product of an even number of distinct (finite) primes, let N\nbe a integer prime to D, and O0D (N) an order of level N in the quaternion algebra BD over Q of\ndiscriminant D. As BD is indefinite (i.e. R \u2297 BD is split), there is an embedding of the subgroup\n\u00d7\nof O0D (N) consisting of elements with norm 1 into SL2 (R), and the quotient of the Poincar\u00e9 upper half-plane by this subgroup via the usual homographic action is a compact Riemann surface\ncalled the Shimura curve associated to O0D (N). We denote this curve by X0D (N)(C). It follows\nfrom the work of Shimura that it has a canonical model over Q, and thanks to Deligne-Rapoport\nand Buzzard (model at primes dividing the level N), Cherednik-Drinfeld et al. (model at primes\ndividing the discriminant D) one has a model for X0D (N) over Z. This model is constructed\nas the coarse moduli scheme parametrizing abelian surfaces with multiplication by O0D (N), i.e.\nabelian varieties of dimension 2 with multiplication by a maximal order of BD and a compatible\nN-level structure (plus an additional technical assumption in characteristics dividing D that we\nwill not discuss here). We will only need the description of Cherednik-Drinfeld, i.e. we will\nconcentrate on the localization of X0D (N) at primes dividing D. Fix such a prime p. To simplify\nthe notations, set X := X0D (N). According to Cherednik and Drinfeld, X is an admissible curve\n7\n\n\fover Zp . Let G := G(XFp ) be the dual graph of XFp as in section 2. This graph is easier to\ndescribe when D is a product of two primes p and q, and from now on we assume that D = pq.\nNote however that dealing with the general case should not present conceptual difficulties.\nIn our case D = pq it follows from the work of Ribet ([24], Proposition 4.4 and 4.7) that the\nset V of vertices of G consists of two copies V1 and V2 of the set of isomorphism classes of pairs\n(E, CN ) where E is a supersingular elliptic curve over Fq and CN \u2282 E is a cyclic subgroup\nof order N (notice the switch between p and q). The set E of edges of the graph consists of pisogenies between such objects. In other words the elements of E correspond to the isomorphism\nclasses of triples (E, CN , Cp ) where Cp is a cyclic subgroup of order p, with source (E, CN ) in\nV1 and target (E/Cp , CN + Cp /Cp ) in V2 . Note that this fixes an orientation on G. The length of\nan edge corresponding to (E, CN , Cp ) is card(Aut(E, CN , Cp )/ \u00b1 1).\nFor each d dividing DN such that gcd(d, DN/d) = 1, there is a distinguished involution wd on the curve X0D (N)Zp , a so-called Atkin-Lehner involution. The involution wq acts\non G by sending (E, CN , Cp ) to Frobq (E, CN , Cp ) so if Cq is the kernel in E of Frobq then\nFrobq (E, CN , Cp ) = (E/Cq , CN + Cq /Cq , Cp + Cq /Cq ). Note that wq preserves the bipartition\nof G. The involution wp maps an edge (E, CN , Cp ) to \u2212(E/Cp , CN + Cp /Cp , E[p]/Cp ), therefore wp switches the bipartition of G. Any quotient X + := X/wd is also an admissible curve\nand G + := G(XFp /wd ) = G(XFp )/wd (taking into account the ramification in the length of the\nedges).\nLet J := Jac(X) and J + := Jac(X + ) be the N\u00e9ron models over Spec(Zp ) of the jacobians of\nXQp and XQ+p respectively. It follows from the previous section that the neutral components JF0p\nand JF+0\nof JFp and JF+p are tori, and the character group of JF0p (respectively, JF+0\n) is isomorphic\np\np\n+\nto H1 (G, Z) (respectively, H1 (G , Z)).\nLet T be the Hecke algebra of \u03930 (pqN). The results of Jacquet-Langlands imply that the\nelements of T define correspondences on the Shimura curve X = X0pq (N). In order to formulate\na version of Mestre-Oesterl\u00e9's graph method for Shimura curves, we need to understand the\ninduced action of T on the special fiber of J. To achieve this we use a kind of \"explicit twisted\nJacquet-Langlands\" which is at the heart of [24]. In this article Ribet compares the character\ngroup of Jac(X0pq (N))Fp with a subgroup of the character group of Jac(X0 (pqN))Fq . To explain\nthis result we introduce a few new notations. Let X be the group of degree 0 divisors on the set\nof supersingular points in X0 (Nq)(Fq2 ) and let L be the group defined in the analogous way for\nX0 (Npq). The two natural degeneracy maps \u03b1 and \u03b2 from X0 (Npq) to X0 (Nq) induce maps \u03b1\u2217\nand \u03b2\u2217 from L to X . Call Y the kernel of the morphism (\u03b1\u2217 \u2295 \u03b2\u2217 ) : L \u2192 X \u2295 X . Ribet shows\nthat T restricts to an action on Y which cuts-out the pq-new quotient of T ([24], Theorem 3.20).\nThen he proves the following crucial result:\n\n8\n\n\fTheorem 3.1 (Ribet) There is a T-isomorphism (which is compatible with the monodromy pairings) between Y and the character group of Jac(X0pq (N))0Fp .\n\u0003\n\nProof. This is [24], Theorem 4.1.\n\nNote that the fact that Y is the character group of the jacobian of a Shimura curve already followed implicitly from the description of the graph given above.\n\n3.2 Lemmata on component groups.\nWe close this section by proving technical lemmas on the asymptotic shape and the order of components of a Shimura curve X pq (or its quotient X pq /wq ) embedded in its jacobian. We fix some\nmore notations. Let S = {C0 , . . . , Cg } be the set of supersingular j-invariants in characteristic\nq. Write the bipartite graph G(XFpqp ) as a union V1 \u222a V2 . According to Ribet's description of\nthe previous section, one may enumerate the vertices of Vr as Cr,0, . . . , Cr,g for r = 1, 2. Each\nCs \u2208 S corresponds to an elliptic curve Es , and we set w(Cs ) := card(Aut(Es )/(\u00b11)). One\nknows that two w(Ci ) at most are different from 1, in which case they are equal to 2 or 3. Recall\n1 S\nZ . For\nthat the Eisenstein vector for X0 (q)Fq is Eis := (w(C0)\u22121 , w(C1)\u22121 , . . . , w(Cg )\u22121 )t \u2208 12\nP\nP\nS\nv = (vi )i\u2208S \u2208 C we define the weight w(v) as i\u2208S vi . The weight w(Eis) =\nw(Cr )\u22121 is\nroughly g(X0(q)) \u2243 q/12.\nLemma 3.3 Fix a prime q > 3. As the prime p tends to infinity, the edges of G(XFpqp ) are\nequidistributed in the following sense. If C1,j and C2,i are elements of V1 and V2 respectively,\nthe number of edges from C1,j to C2,i is\n(p + 1)\n1\n\u221a\n\u00d7\n+ Oq ( p).\nw(Eis) w(C1,j )w(C2,i )\nProof. We first deal with the generic case: when w(C1,j ) = 1. Considering the transpose\nTp \u2208 Mg+1 (Z) of the pth -Brandt matrix for \u03930 (q) with respect to the basis associated to S, one\nsees that the number of edges from C1,j to C2,j is the ith coefficient of the j th column vector of\nTp (cf. for instance Proposition 4.4 of [13]). Write Cj = (0, . . . , 0, 1, 0, . . . , 0)t in ZS , where the\ncoefficient 1 occurs at the j th place. Decompose Cj as (1/w(Eis))Eis + cj , with cj a vector of\nweight 0. Now the lemma follows from the fact that Tp (Eis) = (p + 1)Eis, together with Weil's\nbounds on cuspidal eigenvalues (i.e. if ap is such an eigenvalue, with p prime to the level, then\n\u221a\n|ap | \u2264 2 p, see e.g. [9], 5.0.1 and references therein).\nWhen w(C1,j ) = 2 or 3, one uses the same arguments, plus the fact that, on a supersingular\nelliptic curve in characteristic q corresponding to C1,j , the p-isogenies which are conjugated by\n9\n\n\fthe exceptional automorphism \u03b6 (=\u03b64 or \u03b63 ) are isomorphic. Identifying the set of p-isogenies\nwith P1 (Fp ) one sees that, depending on the decomposition of p in Q(\u03b6), the exceptional isomorphism may fix zero, one or two of these isogenies; the others belong to orbits of length w(C1,j ).\nHowever the quantitative form of the statement does not depend on these different cases.\n\u0003\nLemma 3.4 Assume that p and q verify the hypotheses of Theorem 1.1, case 2 with p, q > 3. Let\nC be a vertex of G((X pq /wq )Fp ) associated to the Gal(Fq2 /Fq )-orbit of a supersingular invariant\nj . The number of edges emanating from C is:\n\n1. (p + 1) if j belongs to Fq2 \\Fq ;\n2. (p + 1)/2 if j \u2208 Fq and j 6\u2261 0, 1728;\n3. (p + 3)/4 if j \u2261 1728;\n4. (p + 3 \u00b1 2)/6 if j \u2261 0.\nSetting \u03b5(C1,s , C2,r ) = 1 if C1,s or C2,r belongs to Fq2 \\Fq , and \u03b5(C1,s , C2,r ) = 2 if both lie in Fq ,\nthe number NC1,s ,C2,r of edges between two vertices C1,s and C2,r belonging to two different sets\nof the bipartition of G((X pq /wq )Fp ) is:\nNC1,s ,C2,r =\n\n1\n\u221a\np+1\n\u00d7\n+ Oq ( p).\nw(Eis) \u03b5(C1,s , C2,r )w(C1,s )w(C2,r )\n\nProof. The first part of the lemma follows form Ribet's description of the graph (sketched\nbefore Theorem 3.1). Indeed, let C be a vertex of G(XFpqp ) associated to a supersingular curve\nE with invariant j. We recall that the involution wq acts as Frobq on G(XFpqp ). If j belongs to\nFq2 \\Fq , there are p + 1 edges emanating from C in G(XFpqp ), and as wq (C) 6= C, the same is true\nfor its image C in G((X pq /wq )Fp ), so case 1 of the lemma follows. Suppose that j belongs to Fq ,\nin which case C is fixed by wq . The hypotheses on p and q insure that that no edge of G(XFpqp )\nis fixed under the action of wq (see [27], proof of Theorem 3.1 and [21], p. 204 et seq.). This\nallows to conclude in case 2 of Lemma 3.4. If j \u2261 1728 (respectively, j \u2261 0), one must take\ninto account the fact that E has an extra automorphism of order 4 (respect. of order 6) as in the\nproof of Lemma 3.3. As we assume that p \u2261 1 mod 4, this shows that there are only (p + 3)/2\n(respect. (p + 3 \u00b1 2)/3) edges emanating from C, and half this number from C. This proves the\ncases 3 and 4 of Lemma 3.4. The assertion about NC1,s ,C2,r is clear from Lemma 3.3.\n\u0003\nTo prove the next lemma we need an explicit description of component groups. To achieve that\npurpose we recall the method of the proof of [11], Proposition 9.2. See also [10], section 1.\n\n10\n\n\fLet G be a graph with the set of vertices and edges S0 and S1 respectively, and write ZS0 [+]\nP\nfor the kernel of the \"weight\" map f 7\u2192 v\u2208S0 f (v) from ZS0 to Z. Raynaud's results show that\nthe component group \u03a6 of the jacobian of an admissible curve with the graph G is the cokernel of\nthe map \u03b9 : ZS0 \u2192 ZS0 [+] given by the intersection matrix of G. More precisely, if \u2206 : Z \u2192 ZS0\nis the diagonal map, one has the exact sequence:\n(R)\n\n\u2206\n\n\u03b9\n\n0 \u2192 Z \u2192 ZS0 \u2192 ZS0 [+] \u2192 \u03a6 \u2192 0\n\n(see e.g. [11], loc. cit.). Now having fixed an orientation on G, let s and t be the obvious\n\"source\" and \"target\" maps from S1 to S0 . Define t\u2217 : ZS0 \u2192 ZS1 by (t\u2217 f )(e) = f (t(e)) and\nP\nt\u2217 : ZS1 \u2192 ZS0 by (t\u2217 f )(v) = t(e)=v f (e). Define similarly s\u2217 and s\u2217 and set d\u2217 := t\u2217 \u2212 s\u2217 and\nd\u2217 := t\u2217 \u2212 s\u2217 . One readily checks that the map \u03b9 can be factorized as \u03b9 = \u2212d\u2217 d\u2217 (cf. for instance\n[8], section 1.2, proof of Theorem 1.2.3).\nThe basic problem we discuss in the next lemma is the following: given an element in ZS0 [+]\nof the form (p + 1)(C1 \u2212 C2 ), is it in the image of \u03b9, or not? Recall that for X an admissible\ncurve, X\u0303 denotes the regular curve obtained from X by blowing-up.\nLemma 3.5 Fix a prime q such that g(X0 (q)) \u2265 5 and suppose that p \u2261 5 mod 12 and q \u2261 3\nmod 4. For p large enough (compared to q ), if a non-trivial difference between two irreducible\npq\npq /w )\ncomponents of (X^\nq Fp is killed by (p + 1) in the component group of Jac(X /wq )Fp , then\nthese two components belong to the same set V1 or V2 of the bipartition of the set of components.\nIn particular, if J denotes the exceptional component arising from multiplication by \u03b64 and\nJ is any other component, then (J \u2212 J) is not killed by p + 1.\npq /w ) ), whose sets of vertices and edges are still\nProof. We consider the graph G + := G((X^\nq Fp\ndenoted by S0 and S1 respectively. As we assume that p \u2261 5 mod 12 and q \u2261 3 mod 4, we\nknow that there is exactly one exceptional component J arising from multiplication by \u03b64 , and\nno exceptional component arising from multiplication by \u03b63 (see [21], pp. 205 et seq., or the\ndiscussion preceding Theorem 4.1 and the proof of Lemma 5.1 of the present paper. Note that\nthis does not prevent a vertex from having \"multiplication by \u03b63 \", i.e. from corresponding to a\nsupersingular invariant j \u2261 0 mod q). Let w := w(Eis) be the weight of the Eisenstein vector\nfor X0 (q)Fq as in the Lemma 3.3. The hypothesis g(X0 (q)) \u2265 5 implies w > 4. For C \u2208 S write\n\u03b5(C) = 2 if C \u2208 Fq , and \u03b5(C) = 1 otherwise. Recall that the set of vertices of G + other than J is\nV1 \u222a V2 . Call J1 and J2 the components surrounding J . One has w(J1 ) = w(J2 ) = 2. There are\nexactly two edges emanating from J , one towards J1 and one towards J2 . Let J be a component\n(possibly J1 ) belonging to the set V1 , say. We divide the set of vertices of G + other than J , J, J1 ,\nJ2 into the subsets {ji,1 } and {ji,2 } of V1 and V2 respectively. By Lemma 3.4 if (C1 , C2 ) belongs\n\n11\n\n\fto V1 \u00d7 V2 then NC1 ,C2 > 0 for p \u226b q. We suppose this to be the case in what follows. (At this\n\u221a\npoint, it may help the reader to make a rough sketch of what G + looks like.) The symbol Oq ( p)\nbelow will denote a priori different functions, which depend on the vertices of our graph, but as\nq is fixed the set of vertices is fixed too, therefore those functions can be bounded by a single\none. To prove Lemma 3.5 we have several kinds of generic configurations to consider for our\ndifferences (C1 \u2212C2 ), relative to the above data. Using the previous lemmas the computations are\nelementary but lengthy so we treat in detail only the cases of the last statement of the lemma and\nwe leave other cases to the reader. (Note that in the computations below, we only need w > 3,\nbut the assumption w > 4 in our statement is necessary for the cases we do not write down here).\nFrom now on we assume that there is a v \u2208 ZS0 such that d\u2217 d\u2217 (v) = (p + 1)(J \u2212 J ) =: i. The\ndiscussion before the lemma shows that we need to obtain a contradiction for p \u226b q.\nWe point out that our problem has a simple electrodynamical interpretation. Indeed, consider\nG + as an electric circuit in which every edge has a resistance of one (ohm, say). The element\ni \u2208 ZS0 [+] may be seen as a vector of current: at each node C \u2208 S0 , a current of i(C) amp\u00e8res\nenters the circuit. If v \u2208 QS0 satisfies d\u2217 d\u2217 (v) = i then v can be interpreted as a distribution of\npotential in volts at each node, corresponding to the current i on G + . From this point of view\nour problem boils down to proving that no integer valued distribution of potential on the nodes\nallows a current of p+1 amp\u00e8res to enter the circuit at J and leave it at J . This electrodynamical\ninterpretation is a common practice among graph theorists (see for instance [4], II.1). It is also\nused in [11], Proposition 9.2.\nSublemma 3.5.1 (\"law (K)\"). With the above assumptions and notations, at each vertex C in\nP\nP\nS0 one has D7\u2192C (v(C) \u2212 v(D)) = i(C), where \" D7\u2192C \" means the sum over the neighbors\nof C in G + .\nProof of 3.5.1. Clear from the fact that i = d\u2217 d\u2217 (v). \u0003\n(Note that, from the electrodynamical point of view, this is just the conjunction of Ohm's law\nand Kirchhof's law (see [4], loc. cit.). Indeed, Ohm's law says that if a current c passes through\na wire of resistance r between two nodes A and B with a difference in potential equal to u, then\nu = r.c. On the other hand, Kirchhoff's law says that the sum of currents passing through a node\nis zero. In our case each wire in S1 has resistance r = 1 and d\u2217 (v) \u2208 ZS1 is the distribution of\ncurrent through the wires of G + .)\nSublemma 3.5.2 With the above hypotheses and notations, one has v(J ) < v(C) < v(J) for\nevery vertex C different from J and J .\n\n12\n\n\fProof of 3.5.2. Let C0 be such that v(C0 ) is maximal among the v(C) with C 6= J and suppose\nthat v(C0) \u2265 v(J). By connexity of G + one may assume that the vertex C0 has a neighbor\nD such that v(D) < v(C0 ) (otherwise v would be constant on G + , a contradiction with the\nP\nexact sequence (R) before Lemma 3.5). Therefore D7\u2192C0 (v(C0) \u2212 v(D)) > 0, which is a\ncontradiction with (3.5.1) as i(C0 ) \u2264 0. The other inequality of the sublemma is obtained by\nsymmetry. \u0003\n(Note that from the electrodynamical point of view, the sublemma just says that the distribution of potential must decrease between the nodes J (where the current enters) and J (where it\ncomes out)).\nWe finally turn to the proof of the Lemma 3.5 itself, examining the different configurations\nthat may occur for J and J . As we feel that the electrodynamical language gives slightly shorter\nand clearer proofs, we will use it freely. For readers who prefer more formal proofs however,\nwe treat our first case below in both abstract and physical languages. It is our hope that this will\nclarify our method for the rest of the computations.\nLet J2 \u2208 {J2 } \u222a V2 be such that v(J2) = max(v(ji,2 ), v(J2 )). Lemma 3.4 insures\nthat there are (p + 1)/\u03b5(J)w(J) edges leaving J. Recall that we assume that for each\npair of vertices (C1 , C2 ) in V1 \u00d7 V2 the number NC1 ,C2 of edges between C1 and C2 is\nnonzero. By (3.5.2) one has v(J) > v(J2 ), v(J) > v(ji,2 ) for all ji,2 in V2 , and by (3.5.1),\nP\nP\n(p+1) = NJ,J2 (v(J)\u2212v(J2 ))+ ji,2 NJ,ji,2 (v(J)\u2212v(ji,2 )) \u2265 (v(J)\u2212v(J2 ))(NJ,J2 + ji,2 NJ,ji,2 )\n= (v(J) \u2212 v(J2 ))(p + 1)/\u03b5(J)w(J), therefore v(J) \u2212 v(J2 ) \u2264 \u03b5(J)w(J).\nCase 1: Assume that J 6= J1 .\n1a: Suppose that v is constant on {J2 } \u222a V2 .\n(Abstract language.) One has v(J) \u2212 v(J2 ) = v(J) \u2212 v(J2 ) = \u03b5(J)w(J) by the preceding\ncomputation. Applying the law (K) (3.5.1) at each ji,1 in V1 shows that the v(ji,1 ) are\nconstant, equal to v(J2 ). Applying (3.5.1) again at J1 , then at each ji,2 , then at J, gives that\nP\nP\nv(J1 )\u2212v(J ) = (v(J2 )\u2212v(J1 ))NJ2 ,J1 + ji,2 Nji,2 ,J1 (v(ji,2 )\u2212v(J1 )) \u2265 ji,2 Nji,2 ,J1 (v(ji,2 )\u2212v(J1 ))\nP\n\u221a\n\u03b5(J)\n)+Oq ( p)\n\u2265 ji,2 NJ,ji,2 (v(J)\u2212v(ji,2 )) = (p+1)\u2212(v(J)\u2212v(J2 ))NJ,J2 = (p+1)(1\u2212 2\u03b5(J,J\n2 )w\nby Lemma 3.4. Now v(J2 ) \u2212 v(J ) > v(J1 ) \u2212 v(J ) so (3.5.1) applied at J2 gives\n\u221a\n\u221a\n\u03b5(J)\n\u03b5(J)\n) + Oq ( p) \u2264 (v(J) \u2212 v(J2 ))NJ2 ,J = (p + 1) 2\u03b5(J,J\n+ Oq ( p). This\n(p + 1)(1 \u2212 2\u03b5(J,J\n2 )w\n2 )w\nimplies w \u2264 1 for p \u226b q.\n(Electrodynamical language.) By the law (K) at each ji,1 in V1 , one sees that the v(ji,1 )s are\nconstant and equal to v(J2 ). Therefore all the current arriving from J to the ji,2 s goes to J1 . It\n\u221a\n\u03b5(J)\n) + Oq ( p) by Lemma 3.4.\nthen goes to J , and this total current is at least (p + 1)(1 \u2212 2\u03b5(J,J\n2 )w\nThis means that v(J1 ) \u2212 v(J ) is larger than this latter quantity, and the same is a fortiori true of\n13\n\n\f\u221a\n\u03b5(J)\n+ Oq ( p), and this\nv(J2 ) \u2212 v(J ). But the current that J2 receives from J is only (p + 1) 2\u03b5(J,J\n2 )w\nimplies w \u2264 1 for p \u226b q.\n1.b: Suppose that v is not constant on {J2 } \u222a V2 .\nWe first note that we have \u03b5(J) = 2, because if J is quadratic over Fq there are (p + 1) edges\nemanating from J, therefore (3.5.1) implies that v is constant and equal to v(J) \u2212 1 on {J2 } \u222a V2 .\nAs there is a j2 in {J2 } \u222a V2 such that v(j2 ) < v(J2 ) one sees that v(J2 ) > v(J1 ) (otherwise we\nget a contradiction with the fact that J1 has no current to offer to j2 ), and similarly v(J2 ) > v(ji,1 )\n\u221a\n1\n(1 \u2212 w.w(J)\n) + Oq ( p)\nfor all ji,1 in V1 . Therefore the node J2 has to deal at least \u03b5(J2p+1\n)w(J2 )\n\u221a\n(p+1)\n(\u03b5(J)w(J)) + Oq ( p).\namp\u00e8res, whereas it receives (from J) strictly less than \u03b5(J2 )w(J\n2 )w(J)w\nThis gives w \u2264 \u03b5(J) + 1/w(J) \u2264 3 for p \u226b q.\nCase 2. Assume that J = J1 . As in the case 1.b, the node J2 has to deal\n\u221a\n1\n(1 \u2212 2w\n) + Oq ( p) amp\u00e8res, whereas it receives from J1 less than\nat least \u03b5(J2p+1\n)w(J2 )\n\u221a\n\u221a\n(p+1)\n(v(J1 ) \u2212 v(J2 )) + Oq ( p) \u2264 \u03b5(J2(p+1)\n+ Oq ( p). This gives w \u2264 5/2 for p \u226b q.\n2\u03b5(J2 )w(J2 )w\n2 )w(J2 )w\nThis completes the examination of the cases of differences of components of shape J \u2212 J,\nwhich will be the only ones of interest to us in the following of the paper. The other cases of the\nlemma are similarly elementary and lengthy to treat.\n\u0003\nRemark 3.6 The above makes it clear that, if p is large enough relatively to q, the graphs G\nor G + are \"non-disconnecting\". It follows that the maps from XZpq,sm\nand (X pq /wq )sm\nZp to their\np\njacobian over the same basis are closed immersions, by Proposition 9.5 of [11]. We will use this\nremark before the Theorem 5.3.\n\n4 Shimura curves and results of Gross, Zhang and Waldspurger.\nIn this section we show how the results of Gross, Zhang and Waldspurger on the special values\nof automorphic L-functions describe the winding quotient of the jacobian of our Shimura curves,\ngeneralizing [22], Proposition 4.2.\nLet GQ denote the absolute Galois group of Q and S2new (\u03930 (N))Q the set of newforms over Q\nof weight 2 for \u03930 (N). For any integer N, the theory of Shimura associates to the decomposition\ninto GQ -orbits of S2new (\u03930 (N))Q a similar decomposition over Q, up to isogeny, of J0 (N) into a\nQ\nproduct GQ \u2212orbits Af . According to Shimura, Carayol et al., one has\nL(J0 (N), s) = \u2217\n\nY\n\nGQ \u2212orbits\n\nL(Af , s) = \u2217\n\n14\n\nY\n\nY\n\nGQ \u2212orbits (f \u03c3 \u2208GQ *f )\n\nL(f \u03c3 , s)\n\n\f(where the \u2217s denote non-zero constants). The Hecke algebra T := T\u03930 (N ) is a free Z-module\nof finite type. The above decomposition of J0 (N) corresponds to idempotents in T \u2297 Q and\nQ\nthere is a unique ideal Ie of T such that J0 (N)/Ie J0 (N) is isogenous to L(Af ,1)6=0 Af and Ie is\nsaturated (i.e. equal to the inverse image of Ie \u2297 Q under the map T \u2192 T \u2297 Q). This quotient\nabelian variety is called the winding quotient and we denote it by Je (N). A milestone theorem\nof Kolyvagin-Logachev (see [19]), generalized by Kato in [18], implies that Je (N)(Q) is finite\n(this is part of a special case of the conjecture of Birch and Swinnerton-Dyer). The theory of\nJacquet-Langlands establishes a correspondence between automorphic forms for GL2 on the one\nhand, and automorphic forms for the multiplicative group of nonsplit quaternion algebras, on the\nother hand (see e.g. [16]). This implies that one can also make the above construction for any\n(quotient of) a general Shimura curve instead of the classical X0 (N).\nWe want to develop a graph method on our Shimura curves in a similar way to [22]. The\nZ-modules L and Y of the end of section 3.1 can be interpreted as character groups or, as we are\nworking with tori, as spaces of differential 1-forms on the corresponding geometric objects. The\nuse of special values formulae for suitable Rankin-Selberg L-functions allows us to describe in\nthese spaces the subspaces of differentials pertaining to the winding quotient. To be more precise\nwe need to fix some notations and recall some results from Gross' theory (a neat introduction\nto this circle of ideas can be found in [32]). If M is a Z-module, define M\u0302 := M \u2297 \u1e90. Let\nB be the quaternion algebra over Q which is ramified precisely at q and \u221e. Choose a Eichler\norder R of level p in B, and let {R1 := R, ..., Rn } be a set of Eichler orders in B corresponding\nto representatives for R\u0302\u2217 \\B\u0302 \u2217 /B \u2217 : to a double coset g := (g2 , g3 , . . . , gl , . . . ) we associate the\nB \u2217 -conjugation class of the Eichler order B \u2229 g \u22121R\u0302g. Recall that R\u0302\u2217 \\B\u0302 \u2217 /B \u2217 is in one-to-one\ncorrespondence with the set S of singular points of X0 (pq)Fq (see [24], 3.3 and 3.4). The order\nRi associated to a point x = (E, Cp ) is such that Ri \u2243 EndFq (E, Cp ).\nIf L is a quadratic number field, it embeds in B if and only if its localization at ramification\nprimes for B is a field, i.e. L is a quadratic imaginary field in which q is inert or ramified. Then,\nfor an order O of L, a morphism of algebras \u03c3 : L \u0592\u2192 B, and a Eichler order R as above, the pair\n(\u03c3, R) is said to be an optimal embedding of O in R if \u03c3(L) \u2229 R = \u03c3(O). Such an embedding\nexists if and only if p splits or ramifies in O. If \u2212D is a negative integer, let h(\u2212D) be the class\nnumber of the quadratic order O\u2212D with discriminant \u2212D (if it exists), and let hi (\u2212D) be the\nnumber of optimal embeddings of O\u2212D in Ri modulo conjugation by Ri\u2217 . We define in ZS the\nelement:\nn\nX\nhi (\u2212D)\n[Ri ].\neD :=\n\u2217\n|Aut(R\n/\n\u00b1\n1)|\ni\ni=1\nWe call those elements Gross vectors.\nNow let f be a newform of weight 2 for \u03930 (pq). If \u2212D is a quadratic imaginary discriminant\n15\n\n\fas above, we write \u2212D = \u2212d.c2 , where \u2212d is a fundamental discriminant and c a conductor.\n\u221a\nLet \u03b5D be the non-trivial quadratic Dirichlet character associated to Q( \u2212D), and f \u2297 \u03b5D the\ntwist of f by \u03b5D . One knows that the natural action of the Hecke operators as correspondences\nendows L with a structure of T-module (the Brandt Hecke module), such that L \u2297 Q is a free\nT \u2297 Q-module of rank 1 (see [13], section 5, for the case of prime level, and for instance [12] for\nmore general results). Let (L \u2297 Q)f be the TQ -eigenspace in L \u2297 Q associated to f , and let ef,D\nbe the component of eD on (L \u2297 Q)f .\nTheorem 4.1 (Gross, Zhang, Waldspurger) With notations as above, the number\nL(f, 1)L(f \u2297 \u03b5D , 1) is non-zero if and only if ef,D is non-zero.\nProof. This follows from a result of Waldspurger, as explained, in a slightly different language,\nin section 1.4 of [7]. Under the assumption that (pq, D) = 1 and (c, pqD) = 1, see also [32],\nTheorem 6.4. Note that, when f has prime level, an exact formula expressing L(f, 1)L(f \u2297\u03b5D , 1)\nin terms of ef,D was proved by Gross in his seminal work [13], Corollary 11.6. This was generalized in [33], Theorem 1.3.2, or [34], Theorem 7.1. It was this formula that we used in [22]. But\neven the newest versions of this exact Gross-Zhang formula require mildly restrictive hypotheses. In the rest of this work however, as in the arithmetic applications of [7], one only needs the\nnonvanishing statement of Theorem 4.1.\n\u0003\nWe now come back to the case of modular curves. It follows from [24], Proposition 3.1, that\nthe group L of section 3.1 is isomorphic as a T-module to the character group of the maximal\nsubtorus of J0 (pq)Fq .\nProposition 4.2 Let E be the Q-vector subspace of L\u2297Q spanned by the orthogonal projections\nof Gross vectors (relative to the monodromy pairing h*, *i, cf. section 2). Then E = L[Ie ] \u2297 Q.\nProof. This is a straightforward variant of [22], Proposition 4.2.\n\n\u0003\n\nWe obtain an analogous result in the case of Shimura curves.\nCorollary 4.3 The subspace E\u2229YQ of YQ = Y \u2297Q is equal to the character group of the winding\nquotient of J0pq\u2212new (pq), i.e. the character group of the winding quotient of Jac(X pq )0Fp .\nProof. Combine Proposition 4.2 with Theorem 3.1.\n\n\u0003\n\nThe Corollary 4.3 says that homology classes of the closed paths in the graph of XFpqp made of\nGross vectors are characters of the winding quotient. This gives a concrete method for obtaining\nthose characters, which is a crucial point of our strategy.\n16\n\n\f5 General method.\nWe turn to our initial problem of proving the triviality of the rational points on Atkin-Lehner\nquotients of Shimura curves. Set as before X = X pq /wq . Suppose that there exists a point P in\nX(Q), and let P0 := wp (P ). Our aim is to prove that P = P0 , which implies that P is a special\n(or CM) point (cf. e.g. the first chapter of [6] or [2], Remark 6.5) - or leads to a contradiction if\nthere are no special points in X(Q). Consider the following diagram of Q-morphisms:\nXp+1\n\u0580\n\u03c6\n\nX \u2192\n\nJ\n\u03b1 \u2193\n\nw =1\n\nJe q\n\n\u0581\n\n[p+1]\n\n\u2212\u2192 J\n\u2193\u03b1\n\n[p+1]\n\nw =1\n\n\u2212\u2192 Je q\n\nwhere \u03c6(Q) = (Q) \u2212 (P0 ), Xp+1 = [p + 1] \u25e6 \u03c6(X) as at the end of section 2, \u03b1 is the prow =1\njection of J = Jac(X) to its winding quotient Je q (isogenous to Je /(1 \u2212 wq )Je for Je the\nwinding quotient of Jac(X pq )). It is clear that everything commutes in this diagram. We define\n\u03c8 = [p + 1] \u25e6 \u03c6 and \u03a8 = \u03b1 \u25e6 \u03c8.\nLet X\u0303 be the desingularization of X over Zp as in section 2. As X\u0303 is regular, any point in\nX\u0303(Zp ) belongs to X\u0303 sm (Zp ). For such a Q in X\u0303(Zp ), let CQ be the vertex of G(X\u0303) corresponding\nto the specialization component of Q.\nLemma 5.1 Assume that p and q satisfy the hypotheses of Theorem 1.1, case 2. Then X\u0303Fp has\na unique Fp -rational component which is necessarily CP0 . This component intersects the other\ncomponents in two points exactly. The embedding \u03c6 identifies CPsm0 with a one-dimensional\nsubtorus T of J which is isomorphic to the non-trivial twist of Gm over Fp (cf. Proposition 2.1).\nIn particular, for any Q in X\u0303(Zp ), one has CQ = Cwp (Q) = CP0 .\nProof. We use again the work of Ogg ([21]), Th\u00e9or\u00e8me of p. 206. In loc. cit. indeed, as we\nalready noticed, it is explained that the vertices and the edges of G(XFpqp ) are defined over Fp2 ,\nand that the action of Frobp on components and singular points of XFpqp corresponds to the action\nof wp on the graph G(XFpqp ). Recall that the set of vertices of G(XFpqp ) consists of two copies of the\nset of isomorphism classes of supersingular elliptic curves in characteristic q and that wp sends\na vertex from the first copy to the symmetrical vertex from the second. It follows that no vertex\nof G(XFpqp ) is fixed by wp . Passing to the quotient curve one sees that the Fp -rational components\nof XFp are exceptional, and more precisely are obtained by blowing-up the edges y of G(XFp )\nof length two and such that wp (y) = \u2212y (i.e. the edges which are preserved by wp , but whose\nsource and target are permuted).\n17\n\n\fAs already discussed, those exceptional components arise in two situations, the \"cas ramifi\u00e9\"\nand the \"cas non-ramifi\u00e9\" of Ogg. In the first case the lifting of y to G(XFpqp ) consists of one edge\nfixed by wq . In the second case y has two preimages in G(XFpqp ) exchanged by wq , see loc. cit., pp.\n204 and 205. Note that the fact that pq is odd implies that X pq (Qp ) itself is empty: this follows\nfrom\n\u0011 the point i) of the Theorem of p. 206 of [21]. The hypotheses of the present lemma, that\n\u0010\nq\n= \u22121 and the congruences satisfied by p and q, imply that we are in the \"cas non-ramifi\u00e9\".\np\nLet C1 and C2 be the liftings to G(XFpqp ) of a Fp -rational component CP0 in G(XFp ). Using Ribet's\ndescription ([24], Section 3) we see that the Ci 's correspond to Eichler orders \u0398 of level p in Bq\u221e\nwhich contain a fourth root of unity \u03b64 , so that the length of Ci is card(Aut(\u0398/ \u00b1 1)) = 2. By\nEichler mass formula (e.g. [13], 1.12), as q \u2261 3 mod 4 there is (up to conjugacy) exactly one\nmaximal order in Bq\u221e containing \u03b64 and, as p \u2261 1 mod 4, exactly two such orders of level\np. (One can see this by using Ribet's description according to which \u0398 is the endomorphism\nring of an \"enhanced elliptic curve\", i.e. a pair consisting of a supersingular elliptic curve in\ncharacteristic q and a cyclic subgroup of order p.) Those two orders are switched by wq , and this\nshows the existence and uniqueness of CP0 . As CP0 comes from a blow-up, it intersects other\ncomponents at two singular points only. To prove the last statement of the lemma we remark that\nProposition 2.1 gives the desired identification between CP0 and a one-dimensional subtorus T .\nUsing again that the Frobenius action on G(X\u0303Fp ) is given by wp , and that wp switches the two\nsingular points on CP0 , we finally obtain that card(T (Fp )) = p + 1.\n\u0003\nLemma 5.2 If n is a integer such that \u03c6(X)(C) \u2229 J[n](C) 6= {0}, then n \u2265 (pq)/245 provided\nthat p is at least 19 and q is at least 245.\nProof. We first recall that a projective and smooth curve C over a field k is said to be n-gonal\nover k if there exists a k-morphism of degree n from C to P1 . The gonality of C over k is the\nsmallest n for which C is n-gonal over k. In the situation of the lemma, if \u03c6(X)(C) \u2229 J[n](C)\ncontains a non-trivial point Q, then n((Q) \u2212 (P0 )) is the divisor of a rational function which\nprovides a morphism of degree n to the projective line, therefore X is n-gonal over C. This\nmeans that the C-gonality of X pq is at most 2n. But according to [1], Theorem 1.1, this gonality\nis at least (21/200)(g(X pq ) \u2212 1). The genus of X pq is given by the following formula ([28],\nchapter 2; see also [6], Proposition 46 for an immediate formula (note that pq is odd), or [31],\nremark after Proposition 1.4):\n\u0012 \u0013\n\u0012 \u0013\n\u0012 \u0013\n\u0012 \u0013\n1\n(p \u2212 1)(q \u2212 1)\n\u22121\n\u22123\n\u22121\n\u22123\n1\npq\n)(1 \u2212\n) \u2212 (1 \u2212\n)(1 \u2212\n)+\ng(X ) = 1 \u2212 (1 \u2212\n4\np\nq\n3\np\nq\n12\nhence\n\n7 (p \u2212 1)(q \u2212 1)\n.\ng(X pq ) \u2212 1 \u2265 \u2212 +\n3\n12\n18\n\n\fAn elementary computation now shows that n \u2265\nare as in the statement.\n\n21\n(g(X pq )\n400\n\n\u2212 1) \u2265\n\npq\n245\n\nprovided that p and q\n\u0003\n\nThe two preceding lemmas,\u0010together\nwith Lemma 3.5 and Remark 3.6, show that for q and p\n\u0011\nq\nlarge enough and verifying p = \u22121, p \u2261 5 mod 12, q \u2261 3 mod 4, all the four hypotheses\nof Proposition 2.2 are verified with n = p + 1: we may therefore speak of the model Xp+1 of\nXp+1,Qp over Zp provided by Proposition 2.2.\nTheorem 5.3 Keep the above notations and assumptions. Assume that there exists a closed path\non G(X) which is made of Gross vectors and contains, with prime-to-p multiplicity, the edge\ncorresponding to CP0 . Assume furthermore that q > 245 and p \u226b q . Then P = P0 and hence P\nis a special point.\nProof. We choose a basis of H1 (G(X), Z) as in the proof of Proposition 2.1, with only one\nvector VP0 containing (with multiplicity one) the edge corresponding to CP0 . The path \u03b3 made\nof the Gross vectors of the statement has a component at VP0 which is nonzero mod p, and\n\u03b3 corresponds to a character of the winding quotient by Corollary 4.3. We use our basis of\nH1 (G(X), Z) as in the proof of Proposition 2.1 and pick a Fp -parameter x on CP0 . Let a and\na be the values taken by x at the singular points of CP0 , which are Fp2 -conjugate (Lemma 5.1),\nand set \u03bb := (x(P0 ) \u2212 a)/(x(P0 ) \u2212 a). With these notations, a point Q in CP0 is mapped by\nx(Q)\u2212a\n, 1, . . . , 1) (Proposition 2.1). This gives the identification via \u03c6Fp of CP0 with\n\u03c6 to (\u03bb \u00d7 x(Q)\u2212a\nthe twisted form of Gm over Fp called T in Lemma 5.1. As the fiber of J at p is purely toric,\nits cotangent space is naturally identified with the tensor product of its character group with Fp .\nWe call \u03c9\u03b3 the invariant differential on JFp corresponding to \u03b3 via this identification. One now\ncomputes that, if \u03b2 is the component of \u03b3 at VP0 , the pull-back of \u03c9\u03b3 to the cotangent space of\nXFp at P0 is \u03b2(1/(x(P0 ) \u2212 a) \u2212 1/(x(P0 ) \u2212 a))dx, which of course does not vanish. The above\nshows that Cot(\u03c6) is nonzero at \u03c6(P0 ), and this means that \u03c6 is a formal immersion at P0 . We\nbriefly indicate how one can get the same for \u03b1 \u25e6 \u03c6, with \u03b1 defined at the beginning of section 5\nw =1\n(see e.g. the proof of [22], Proposition 3.2). Let Ie q be the Eisenstein ideal relative to J. The\nexact sequence of abelian varieties over Q:\nw =1\n\nq\n0 \u2192 Iewq =1 .J/Q \u2192 J/Q \u2192 Je/Q\n\u21920\n\ninduces an exact sequence of cotangent spaces at the origin, which are free Zp -modules of finite\nrank:\nwq =1\n0 \u2192 Cot(Je/Z\n) \u2192 Cot(J/Zp ) \u2192 Cot(Iewq =1 .J/Zp ) \u2192 0\np\n(this follows from the semistability of J, see the references in [22], loc. cit.). Using our previous remarks on \u03b3 and the identification between cotangent spaces and character groups, one\n19\n\n\fw =1\n\nsees that \u03c9\u03b3 actually belongs to the subspace Cot(Je/Fq p ) of Cot(J/Fp ). Therefore the nonvanishing of Cot(\u03c6)(\u03c9\u03b3 ) = Cot(\u03b1 \u25e6 \u03c6)(\u03c9\u03b3 ) shows that \u03b1 \u25e6 \u03c6 also is a formal immersion at P0\n(and actually at any point on the component CPsm0 ). As multiplication by an integer n on an\nabelian variety induces multiplication by n on its cotangent space (with respect to the module structure), one sees that the map \u03a8 defined at the beginning of this section is a formal\nimmersion at P0 , because p + 1 is prime to p. Finally, as \u03a8 factors through Xp+1 , the map\nw =1\nXp+1 \u2192 Je q is again a formal immersion at (p + 1)\u03c6(P0)(Fp ). Furthermore, Lemma 5.1\nshows that (p + 1)\u03c6(P )(Fp) = 0(Fp ) = (p + 1)\u03c6(P0)(Fp ) in Xp+1 (Fp ) \u0592\u2192 J(Fp ).\nSumming up: one has two points (p + 1)\u03c6(P0 := wp (P )) and (p + 1)\u03c6(P ) in Xp+1 (Q),\nspecializing to the same point at p, where the natural map to a winding quotient is a formal\nimmersion. This allows us to apply Mazur's classical argument to the curve Xp+1 (see e.g. [22],\nproof of the Proposition 3.1 for a version akin to the present one). We therefore obtain that\n(p + 1)((wp (P )) \u2212 (P )) = 0 in Xp+1 (Q) \u0592\u2192 J(Q). But this means that either P = wp (P ), in\nwhich case P is a special point, or X is (p + 1)-gonal. Now Lemma 5.2 shows that the choice of\np and q implies that the latter case is impossible.\n\u0003\n\n6 An explicit infinite family.\nWe finally illustrate our method by considering the family of curves X p*251 /w251 , for p large\nand running through the infinite set of primes verifying the explicit congruences of Lemma 6.1\nbelow, which ensures that the hypotheses of Theorem 5.3 are verified. Using Gross vectors,\nwe will construct explicit closed paths on the graph G := G((X p*251 /w251 )Fp ). Call S1 and\nS2 two copies of the supersingular invariants in characteristic 251. The vertices of G are the\n^\n/w251 ) the desingularized graph.\nGal(F2512 /F251 )-orbits in the Si s. Denote by G\u0303 := G(X p*251\nEach Si is given by the roots of the supersingular polynomial in characteristic 251, which is:\nj(j+29)(j+19)(j\u221264)(j\u22124)(j\u221224)(j\u221230)(j\u221235)(j\u2212101)(j+112)(j+66)(j+52)(j+44)\u00d7\n(j + 38)(j 2 \u2212 60j \u2212 81)(j 2 \u2212 81j \u2212 68)(j 2 \u2212 105j + 116)(j 2 + 93j + 91)\n(see for instance [3]). The second factor of this product is congruent to (j \u2212 1728) mod 251.\nLet E1728 be an elliptic curve over F251 with j-invariant 1728. As p \u2261 1 mod 4, there are two\nembeddings Z[\u03b64 ] \u0592\u2192 End(E1728 , Cp ), for two p-isogenies Cp . They give rise to the two only\nedges of length 2 in G(X p*251 ) from the vertex j = 1728 in S1 to the vertex j = 1728 in S2\n(see the proof of Lemma 5.1). The Gross vector e4 in the graph of X p*251 corresponds to the\nsums of these two edges, which are switched by w251 , hence e4 gives a single edge of length 2 in\nG(X p*251 /w251 )Fp . In G\u0303, this edge finally splits into the two edges (of length 1) surrounding the\n20\n\n\f^\nexceptional vertex which corresponds to the only Fp -rational component of (X p*251\n/w251 )Fp (see\nLemma 5.1).\nNow after looking in tables (e.g. [20]) among the Heegner points of degree one and two, one\n\u221a\nconsiders the following other three Gross vectors: e28 , e36 , e267 , associated to the orders Z[ \u22127],\n\u221a\n\u221a\nZ[3 \u22121] and Z[(1 + \u2212267)/2] respectively, with class polynomials:\nP\u221228 = (j \u2212 16581375) \u2261 (j \u2212 64) mod 251;\nP\u221236 = (j 2 \u2212 153542016 \u2217 j \u2212 1790957481984) \u2261 (j \u2212 64)(j + 19) mod 251;\nP\u2212267 = (j 2 + 19683091854079488000000 \u2217 j + 531429662672621376897024000000)\n\u2261 (j + 19)(j + 29) mod 251.\nOne readily checks that the corresponding quadratic orders embed into the quaternion algebra\nB251*\u221e (i.e. that 251 is inert in these orders), and if p splits in these orders, then for each one\nwe obtain two p-isogenies linking the (one or two) js of each polynomial. Those isogenies are\ninterpreted as edges from S1 to S2 on the graph G(X p*251 )Fp , then on G\u0303, in the same way as\nexplained in the above case of e4 . We sum-up the above observations in the following:\nLemma 6.1 Assume that p verifies the following congruence conditions:\n\u0012 \u0013\n\u0012\n\u0013\n\u0010 p \u0011\n\u22127\n\u2212267\np \u2261 5 mod 12,\n= 1,\n= 1, and\n= \u22121.\np\np\n251\n\nThen the sum of Heegner points:\nG((X p*251 /w251 )Fp ).\n\n(e4 \u2212 e267 + e36 \u2212 e28 ) defines a closed path in\n\nProof. A straightforward application of Theorem 3.1.\n\n\u0003\n\nRemark 6.2 The path of Lemma 6.1 may have different shapes depending on p - for instance it\ncan have one, two or three connected components. These shapes depend on whether or not the\ndegree-two Heegner points link their two different roots j. This in turn is determined by the class\nof the ideals above p in the Picard group of each corresponding quadratic order, by the theory of\ncomplex multiplication for elliptic curves. In any case however, one gets a closed path passing\nthrough the edge having CM by \u03b64 , which is the only relevant point regarding our problem.\nConsider the family of curves X p*251 /w251 with p satisfying the congruences above. It follows\nfrom Theorem 5.3 that the only possible Q-rational points on the curves of this family are special\npoints.\n\n21\n\n\fActually, the curves in our family do not have any special rational point either. For a curve\n\u221a\n\u221a\nX\n/w251 to have a special rational point, either Q( \u2212p) or Q( \u2212251) must have class\n\u221a\nnumber one or the field Q( \u2212251p) must have class number two (see e.g. [27], section 4).\nThese conditions are not satisfied by the primes p satisfying our conditions.\nIn general it is difficult to construct infinite families of counter-examples to Hasse principle\namong the curves of this form (see [27]). However, using a PARI computer program, one can\ndetermine, for a given example, whether the curve has local points everywhere. We have done\nthis for a particular example of p = 137. This prime satisfies the congruences above. Note\nhowever that, due to the ineffectiveness of Lemma 3.5, we cannot guarantee the smoothness of\n^\nthe curve X 137*251\n/w251 along the exceptional F137 -rational component. Using the theorem 3.1\nof [27], we verify first that the curve X 137*251 /w251 has rational points over R, Q137 and Q251 .\nThis is implied by the conditions\n\u0001\n251\n= \u22121.\n1. 137\np*251\n\n2. 251 \u2261 3 mod 4 and 137 \u2261 1 mod 4.\n\nThen one verifies, that for every l < 4g 2 (g being the genus of the curve) one of the quantities\n(notations of [27]) \u03a3l (251 * 137) or \u03a3251l (251 * 137) is non-zero. This guarantees the existence\nof local points at all primes of good reduction (i.e. l 6= 137, 251). It becomes difficult to verify\nthis condition for primes p > 137 as one exceeds the PARI limit on precompiled primes.\nWe state our theorem for an arbitrary p.\nTheorem 6.3 For every large enough prime p satisfying the congruences of Lemma 6.1 the curve\nX p*251 /w251 does not have Q-rational points.\n\nReferences\n[1] D. Abramovich, A linear lower bound on the gonality of modular curves. Internat. Math.\nRes. Notices no. 20 (1996), 1005\u20131011.\n[2] M. Alsina, P. Bayer, Quaternion orders, quadratic forms, and Shimura curves. CRM Monograph Series, 22. AMS, Providence, RI, 2004. xvi+196 pp.\n[3] A.O.L. Atkin, Table of supersingular invariants, in Modular functions of one variable, IV\n(Proc. Internat. Summer School, Univ. Antwerp, Antwerp, 1972), pp. 143-144. Lecture\nNotes in Math., Vol. 476, Springer, Berlin, 1975.\n[4] B. Bollob\u00e1s, Modern graph theory, GTM n. 184, Springer-Verlag, New York (1998).\n22\n\n\f[5] N. Bruin, E. V. Flynn, J. Gonz\u00e1lez, V. Rotger, On finiteness conjecture for modular quaternion algebras, Math. Proc. Camb. Phil. Soc. 141:3 (2006), 383-408.\n[6] P. Clark, Local and global points on moduli spaces of potentially quaternionic abelian surfaces, Ph. D. Thesis, 2003.\n[7] Ch. Cornut, V. Vatsal, Nontriviality of Rankin-Selberg L-functions and CM points, preprint\n(2004), to appear in the Proceedings of a Durham conference.\n[8] G. Davidoff, P. Sarnak, A. Valette, Elementary number theory, group theory, and Ramanujan\ngraphs. LMS Student Texts 55. CUP, Cambridge, 2003.\n[9] F. Diamond, J. Im, Modular forms and modular curves, in Seminar on Fermat's last theorem\n(Toronto, 1993-1994), CMS Conf. Proc. no 17, Amer. Math. Soc., Providence, RI, 1995.\n[10] B. Edixhoven, Appendix to A rigid analytic Gross-Zagier formula and arithmetic application, by M. Bertolini and H. Darmon, Annals of Maths. 146 (1997), 111-147.\n[11] B. Edixhoven, On N\u00e9ron models, divisors and modular curves, J. Ramanujan Math. Soc. 13\nno. 2 (1998), 157-194.\n[12] M. Emerton, Supersingular elliptic curves, theta series, and weight two modular forms, J.\nAmer. Math. Soc., 15 no. 3 (2002), 671-714.\n[13] B. Gross, Heights and the special values of L-series, Canadian Math. Soc. Conference\nProceedings 7, Amer. Math. Soc., Providence (1987), 115-187.\n[14] A. Grothendieck, \u00c9l\u00e9ments de g\u00e9om\u00e9trie alg\u00e9brique, IV. \u00c9tude locale des sch\u00e9mas et des\nmorphismes de sch\u00e9mas IV. Inst. Hautes \u00c9tudes Sci. Publ. Math. No. 32, 1967, 361 pp.\n[15] A. Grothendieck, S\u00e9minaire de G\u00e9om\u00e9trie alg\u00e9brique 7, I, Expos\u00e9 IX, LNM 288, 313\u2013523,\nSpringer 1972.\n[16] H. Jacquet, R.P. Langlands, Automorphic forms on GL2 , Lecture Note in Math. no 114,\nSpringer 1970.\n[17] B. Jordan, R. Livn\u00e9, Local Diophantine properties of Shimura curves, Math. Ann. 270 no.\n2 (1985), 235-248.\n[18] K. Kato, p-adic Hodge theory and values of Zeta functions of modular forms, in Cohomologies p-adiques et applications arithm\u00e9tiques, Ast\u00e9risque n. 295 (2004), ix, 117-290.\n23\n\n\f[19] V. A. Kolyvagin, D. Yu. Logachev, Finiteness of the Shafarevich-Tate group and the group of\nrational points for some modular abelian varieties, Leningrad Math. J., Vol. 1, no. 5 (1990),\n1229-1253.\n[20] J.-C. Lario, Tables available at http://www-ma2.upc.es/\u223clario/ellipticm.htm\n[21] A. P. Ogg, Mauvaise r\u00e9duction des courbes de Shimura, in S\u00e9minaire de th\u00e9orie des nombres, Paris 1983-84, 199\u2013217, Progr. Math., 59, Birkh\u00e4user Boston, Boston, MA (1985).\n[22] P. Parent, Towards the triviality of X0+ (pr )(Q) for r > 1, Compositio Math. 141 no. 3\n(2005), 561-572.\n[23] M. Raynaud, Jacobiennes des courbes modulaires et op\u00e9rateurs de Hecke, Ast\u00e9risque 196197 (1991), 9-25.\n[24] K. Ribet, On modular representations of Gal(Q/Q) arising from modular forms, Invent.\nMath. 100 (1990), no. 2, 431-476.\n[25] V. Rotger, Modular Shimura varieties and forgetful maps, Trans. Amer. Math. Soc. 356\n(2004), no. 4, 1535-1550.\n[26] V. Rotger, Which quaternion algebra act on a modular abelian variety?, preprint (2006).\n[27] V. Rotger, A. Skorobogatov, A. Yafaev, Failure of the Hasse principle for Atkin-Lehner quotients of Shimura curves over Q, Moscow Math. Journal vol. 5 (2005) no. 2, 463-476.\n[28] G. Shimura, Introduction to the arithmetic theory of automorphic functions. Kan\u00f4 Memorial Lectures, No. 1. Publications of the Mathematical Society of Japan, No. 11. Iwanami\nShoten, Publishers, Tokyo; Princeton University Press, Princeton, N.J., 1971. xiv+267 pp.\n[29] A. Skorobogatov, The Brauer-Manin obstruction for Shimura curves, IMRN, to appear.\n[30] A. Skorobogatov, S. Siksek, On a Shimura curve that is a counterexample to the Hasse\nprinciple, Bull. London Math. Soc. 35 (2003), no. 3, 409-414.\n[31] A. Skorobogatov, A. Yafaev, Descent on certain Shimura curves, Israel J. Math. 140 (2004),\n319-332.\n[32] V. Vatsal, Special value formulae for Rankin L-functions. Heegner points and Rankin Lseries, 165-190, Math. Sci. Res. Inst. Publ., 49, Cambridge Univ. Press, Cambridge, 2004.\n[33] Sh.-W. Zhang, Gross-Zagier formula for GL2 , Asian J. Math. 5 (2001), 183-290.\n24\n\n\f[34] Sh.-W. Zhang, Gross-Zagier formula for GL2 II, in Heegner points and Rankin L-series,\n191-214, Math. Sci. Res. Inst. Publ. 49, Cambridge Univ. Press, Cambridge, 2004.\n\nPierre Parent\nInstitut de Math\u00e9matiques de Bordeaux\nUniversit\u00e9 de Bordeaux I\n351, cours de la lib\u00e9ration\n33 405 Talence C\u00e9dex France\nAdresse \u00e9lectronique : Pierre.Parent@math.u-bordeaux1.fr\nAndrei Yafaev\nDepartment of Mathematics\nUniversity College London\nGower street\nLondon, WC1E 6BT England\nE-mail adress: yafaev@math.ucl.ac.uk\n\n25\n\n\f"}