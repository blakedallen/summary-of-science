{"id": "http://arxiv.org/abs/1012.0737v2", "guidislink": true, "updated": "2010-12-06T16:14:55Z", "updated_parsed": [2010, 12, 6, 16, 14, 55, 0, 340, 0], "published": "2010-12-03T13:33:47Z", "published_parsed": [2010, 12, 3, 13, 33, 47, 4, 337, 0], "title": "Brownian Motions on Metric Graphs II - Construction of Brownian Motions\n  on Single Vertex Graphs", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1012.0065%2C1012.1930%2C1012.3858%2C1012.3587%2C1012.0661%2C1012.5805%2C1012.3155%2C1012.0969%2C1012.1722%2C1012.5275%2C1012.2676%2C1012.4678%2C1012.0800%2C1012.4128%2C1012.5488%2C1012.3979%2C1012.2712%2C1012.5495%2C1012.4138%2C1012.0191%2C1012.3479%2C1012.5474%2C1012.4626%2C1012.4373%2C1012.1680%2C1012.0383%2C1012.3581%2C1012.0728%2C1012.2899%2C1012.0631%2C1012.2060%2C1012.1354%2C1012.2440%2C1012.0952%2C1012.2397%2C1012.5482%2C1012.3072%2C1012.1235%2C1012.0723%2C1012.1527%2C1012.2705%2C1012.5990%2C1012.1751%2C1012.0215%2C1012.5401%2C1012.5923%2C1012.0411%2C1012.0955%2C1012.1409%2C1012.2965%2C1012.5930%2C1012.1782%2C1012.1525%2C1012.0174%2C1012.1339%2C1012.5998%2C1012.2152%2C1012.1706%2C1012.0665%2C1012.4981%2C1012.5251%2C1012.5880%2C1012.1326%2C1012.4836%2C1012.1899%2C1012.0647%2C1012.3762%2C1012.1893%2C1012.4072%2C1012.1021%2C1012.1672%2C1012.5313%2C1012.2364%2C1012.3878%2C1012.3544%2C1012.2707%2C1012.3543%2C1012.5305%2C1012.2077%2C1012.3915%2C1012.2420%2C1012.5897%2C1012.1778%2C1012.0737%2C1012.0693%2C1012.4118%2C1012.3033%2C1012.4433%2C1012.3725%2C1012.5643%2C1012.3157%2C1012.0295%2C1012.2179%2C1012.5366%2C1012.1395%2C1012.5389%2C1012.0770%2C1012.1365%2C1012.3951%2C1012.5202%2C1012.2586&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Brownian Motions on Metric Graphs II - Construction of Brownian Motions\n  on Single Vertex Graphs"}, "summary": "Pathwise constructions of Brownian motions which satisfy all possible\nboundary conditions at the vertex of single vertex graphs are given.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1012.0065%2C1012.1930%2C1012.3858%2C1012.3587%2C1012.0661%2C1012.5805%2C1012.3155%2C1012.0969%2C1012.1722%2C1012.5275%2C1012.2676%2C1012.4678%2C1012.0800%2C1012.4128%2C1012.5488%2C1012.3979%2C1012.2712%2C1012.5495%2C1012.4138%2C1012.0191%2C1012.3479%2C1012.5474%2C1012.4626%2C1012.4373%2C1012.1680%2C1012.0383%2C1012.3581%2C1012.0728%2C1012.2899%2C1012.0631%2C1012.2060%2C1012.1354%2C1012.2440%2C1012.0952%2C1012.2397%2C1012.5482%2C1012.3072%2C1012.1235%2C1012.0723%2C1012.1527%2C1012.2705%2C1012.5990%2C1012.1751%2C1012.0215%2C1012.5401%2C1012.5923%2C1012.0411%2C1012.0955%2C1012.1409%2C1012.2965%2C1012.5930%2C1012.1782%2C1012.1525%2C1012.0174%2C1012.1339%2C1012.5998%2C1012.2152%2C1012.1706%2C1012.0665%2C1012.4981%2C1012.5251%2C1012.5880%2C1012.1326%2C1012.4836%2C1012.1899%2C1012.0647%2C1012.3762%2C1012.1893%2C1012.4072%2C1012.1021%2C1012.1672%2C1012.5313%2C1012.2364%2C1012.3878%2C1012.3544%2C1012.2707%2C1012.3543%2C1012.5305%2C1012.2077%2C1012.3915%2C1012.2420%2C1012.5897%2C1012.1778%2C1012.0737%2C1012.0693%2C1012.4118%2C1012.3033%2C1012.4433%2C1012.3725%2C1012.5643%2C1012.3157%2C1012.0295%2C1012.2179%2C1012.5366%2C1012.1395%2C1012.5389%2C1012.0770%2C1012.1365%2C1012.3951%2C1012.5202%2C1012.2586&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Pathwise constructions of Brownian motions which satisfy all possible\nboundary conditions at the vertex of single vertex graphs are given."}, "authors": ["Vadim Kostrykin", "J\u00fcrgen Potthoff", "Robert Schrader"], "author_detail": {"name": "Robert Schrader"}, "author": "Robert Schrader", "arxiv_comment": "version 02: references updated, font problem fixed", "links": [{"href": "http://arxiv.org/abs/1012.0737v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1012.0737v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "60J65, 60J45, 60H99, 58J65, 35K05, 05C99", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1012.0737v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1012.0737v2", "journal_reference": null, "doi": null, "fulltext": "BROWNIAN MOTIONS ON METRIC GRAPHS II\nCONSTRUCTION OF BROWNIAN MOTIONS ON SINGLE VERTEX GRAPHS\nVADIM KOSTRYKIN, J\u00dcRGEN POTTHOFF, AND ROBERT SCHRADER\n\narXiv:1012.0737v2 [math.PR] 6 Dec 2010\n\nA BSTRACT. Pathwise constructions of Brownian motions which satisfy all possible\nboundary conditions at the vertex of single vertex graphs are given.\n\n1. I NTRODUCTION AND P RELIMINARIES\nThis is the second in a series of three articles about the construction and the basic\nproperties of Brownian motions on metric graphs. In the first of these articles [21],\nBrownian motions on metric graphs have been defined, their Feller property has been\nshown, and their generators have been determined, i.e., the analogue of Feller's theorem for metric graphs has been proved. In the present article, we construct all possible\nBrownian motions on single vertex graphs (cf. below). In the third article of this series [22], this construction will be extended to general metric graphs. In a companion\narticle [20], which serves more as a background for this series and which can also be\nread as an introduction to the topic, we revisit the classical cases [7\u20139, 14, 15, 18] of\nBrownian motions on bounded intervals and on the semi-line R+ .\nFor a general introduction to the subject of this article we refer the interested reader\nto [21], henceforth quoted as \"article I\". We shall refer to equations, definitions, theorems etc. from article I by placing an \"I\" in front. For example, \"formula (I.2.4)\"\nrefers to formula (2.4) in article I, while \"definition I.3.1\" points to definition 3.1 in\narticle I. Unless otherwise mentioned, we continue to use the notation and the conventions set up in that article.\nIn the present article we solely consider a metric graph G consisting of a single\nvertex v, and n, n < +\u221e, external edges labeled lk , k \u2208 {1, 2, . . . , n}, each of which\nis metrically isomorphic to the interval [0, +\u221e), the vertex corresponding to 0. It will\nbe convenient to denote the local coordinate of a point \u03be in G \u25e6 = G \\ {v} by (k, x),\nk \u2208 {1, 2, . . . , n}, x \u2208 (0, +\u221e), instead of (lk , x) as we did in paper I.\nThe main ideas for the construction of Brownian motions with boundary conditions\nat the vertex compatible with Feller's theorem 5.3 are those which can be found in the\nwork by It\u00f4 and McKean [14, 15] for the case of the semi-line R+ , cf. also [18, Chapter 6]: The reflecting Brownian motion in the case of R+ is replaced by a Walsh\nprocess [31] (cf. also, e.g., [2]) on the single vertex graph, and then the killing and\nDate: December 6, 2010.\n2010 Mathematics Subject Classification. 60J65,60J45,60H99,58J65,35K05,05C99.\nKey words and phrases. Brownian motion, Feller Brownian motion, metric graphs.\n\n\f2\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nslowing down of this process on the scale of its local time at the vertex is used to\nconstruct processes implementing the various forms of the Wentzell boundary condition. On the other hand, we provide a number of arguments which - at least on a\ntechnical level - are rather different from those found in the standard literature. For\nexample, whenever possible, we use arguments based on Dynkin's formula to derive\nthe domain of the generator (i.e., the boundary conditions). This approach appears to\nbe much simpler and more intuitive than the one with standard arguments [14, 15, 18]\nfor the semi-line R+ , which is based on the rather tricky calculation of heat kernels\nwith the help of L\u00e9vy's theorem. Moreover, for the case of killing, instead of using\nthe standard first passage time formula for the hitting time of the vertex we use a first\npassage time formula for the life time of the process. In the opinion of the authors this\nleads to much simpler computations of the transition kernels than those in [14, 15, 18]\nfor a Brownian motion on R+ .\nThe article is organized as follows. In several subsections of the present section we\nset up some notation and discuss some preparatory results. In section 2 we recall the\nconstruction of a Walsh process on a metric graph. In section 3 we construct a Walsh\nprocess on the single vertex graph with an elastic boundary condition at the vertex,\nwhile in section 4 we construct a Walsh process with a sticky boundary condition at\nthe vertex. The most general Brownian motion on the single vertex graph is obtained\nin section 5 by combining these two constructions. In all three cases we also derive\nexplicit expressions of the analogues of the quantum mechanical scattering matrix on\nsingle vertex graphs.\n1.1. Feller's Theorem and Boundary Conditions. For ease of later reference, in\nthis subsection we state Feller's theorem, theorem I.5.3, as it reads for a single vertex\ngraph with n edges.\nC0 (G) denotes the space of continuous functions on G which vanish at infinity,\nand C02 (G) the subspace of C0 (G) consisting of those functions f \u2208 C0 (G) which\nare twice continuously differentiable on G \u25e6 , such that f 0 vanishes at infinity and f 00\nbelongs to C0 (G). Moreover, for a function f which is continuous on G \u25e6 , and such\nthat for k \u2208 {1, 2, . . . , n}, f (\u03be) has a limit when \u03be \u2208 G \u25e6 approaches the vertex v\nalong any edge lk , we set\nf (vk ) =\n\nlim\n\n\u03be\u2192v, \u03be\u2208lk\n\nf (\u03be).\n\nIt is not hard to see that for all f \u2208 C02 (G), k \u2208 {1, 2, . . . , n}, the limits f 0 (vk ) of the\nderivatives exist. Theorem I.5.3 states that the generator A (on C0 (G)) of a Brownian\nmotion on G is given by 1/2 times the Laplacean with domain D(A) \u2282 C02 (G),\nand that there exist non-negative constants a, c, a 6= 1, and a vector b = (bk , k =\n1, . . . , n) \u2208 [0, 1]n , with\n(1.1a)\n\na+c+\n\nn\nX\nk=1\n\nbk = 1,\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n3\n\nand D(A) consists exactly of those f for which\nn\nX\nc 00\n(1.1b)\naf (v) + f (v) =\nbk f 0 (vk )\n2\nk=1\n\nholds true.\n1.2. Standard Brownian Motion on the Real Line. The construction of Brownian\nmotions on a single vertex graph with infinitesimal generator whose domain consists\nof f 's which satisfy the boundary conditions (1.1) is quite similar to the construction\ncarried out for the half-line in [14], [15], [18]. This in turn is based on the properties\nof a standard Brownian motion on the real line, cf., e.g., [10\u201312, 17, 28, 33], and the\nworks cited above. For the convenience of the reader, and for later reference, we\ncollect the pertinent notions, tools and results here.\nLet (Qx , x \u2208 R) denote a family of probability measures on a measurable space\n(\u03a90 , A0 ), and let B = (Bt , t \u2208 R+ ) denote a standard Brownian motion defined on\n(\u03a90 , A0 ) with Qx (B0 = x) = 1, x \u2208 R. It will be convenient to assume throughout\nthat B has only continuous paths. Whenever it is notationally convenient, we shall\nalso write B(t) for Bt , t \u2265 0. Furthermore, we may suppose that there is a shift\noperator \u03b8 : R+ \u00d7 \u03a9 \u2192 \u03a9, such that for all s, t \u2265 0, Bs \u25e6 \u03b8t = Bs+t .\nWe shall always understand the Brownian family (B, (Qx , x \u2208 R)) to be equipped\nwith a filtration J = (Jt , t \u2265 0) which is right continuous and complete for the\nfamily (Qx , x \u2208 R). (For example, J could be chosen as the usual augmentation of\nthe natural filtration of B (e.g., [17, Sect. 2.7] or [28, Sect.'s I.4, III.2]).)\nB the hitting time of A by B,\nFor any A \u2282 R, we denote by HA\n(1.2)\n\nB\nHA\n= inf{t > 0, Bt \u2208 A},\n\nB is a\nand we note that for all A belonging to the Borel \u03c3\u2013algebra B(R) of R, HA\nstopping time with respect to J (e.g., [28, Theorem III.2.17]). In the case where\nB . We shall also denote these\nA = {x}, x \u2208 R, we also simply write HxB for H{x}\nstopping times by H B (A) and H B (x), respectively, whenever it is typographically\nmore convenient. The following particular cases deserve special attention. Let x \u2208 R.\nThen we have (e.g., [15, Sect. 1.7], [17, Sect. 2.6], [28, Sect.'s II.3, III.3])\n|x|\ng(t, x) dt,\nt > 0,\n(1.3)\nQ0 (HxB \u2208 dt) = Qx (H0B \u2208 dt) =\nt\nwhere g is the Gauss-kernel\n1\n2\n(1.4)\ng(t, x) = \u221a\ne\u2212x /2t ,\nt > 0, x \u2208 R,\n2\u03c0t\nand\n\u221a\nB\u0001\nB\u0001\n\u03bb > 0.\n(1.5)\nE0Q e\u2212\u03bbHx = ExQ e\u2212\u03bbH0 = e\u2212 2\u03bb|x| ,\nB\nMoreover, for a < x < b the law of H{a,b}\nunder Qx is well-known (e.g., [15,\nProblem 6, Sect. 1.7]), and its expectation is given by\n\u0001\nB\n(1.6)\nExQ H{a,b}\n= (x \u2212 a)(b \u2212 x).\n\n\f4\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nDenote by LB = (LB\nt , t \u2265 0) the local time of B at zero, where we choose the\nnormalization as in, e.g., [28] (and which thus differs by a factor 2 from the one used\nin, e.g., [12, 17]): for x \u2208 R, Px \u2013a.s.\n\b\n\u0001\n1\n(1.7)\nLB\n\u03bb s \u2264 t, |Bs | \u2264 \u000f ,\nt \u2265 0,\nt = lim\n\u000f\u21930 2\u000f\nand here \u03bb denotes the Lebesgue measure. Thus, in terms of its \u03b1\u2013potential (cf. [3,\nTheorem V.3.13]) we have\n\u0011\n\u0010Z \u221e\n\u221a\n1\n\u03b1\ne\u2212\u03b1t dLB\n= \u221a e\u2212 2\u03b1|x| ,\n\u03b1 > 0, x \u2208 R,\n(1.8)\nuLB (x) = Ex\nt\n2\u03b1\n0\nwhich provides an efficient way to compare the various normalizations of the local\ntime used in the literature. Slightly informally we can write\nZ t\nB\n\u03b40 (Bs ) ds,\n(1.9)\nLt =\n0\n\nwhere \u03b40 is the Dirac distribution concentrated at 0. LB is adapted to J , and nondecreasing. Moreover, for every x \u2208 R, Px \u2013a.s. the paths of LB are continuous, and\nLB is additive in the sense that\n(1.10)\n\nB\nB\nLB\nt+s = Lt + Ls \u25e6 \u03b8t ,\n\ns, t \u2208 R+ .\n\nSimilarly as above, we shall occasionally take the notational freedom to rewrite LB\nt\nas LB (t).\nWe will need the following well-known result (e.g., [15, Section 2.2, Problem 3]):\nLemma 1.1. The joint law of |Bt | and Lt , t > 0, under Q0 is given by\n\u0001\nx + y \u2212(x+y)2 /2t\n(1.11) Q0 |Bt | \u2208 dx, LB\ne\ndx dy,\nx, y \u2265 0.\nt \u2208 dy = 2 \u221a\n2\u03c0t3\nLet K B = (KrB , r \u2265 0) denote the right continuous pseudo-inverse of L,\n\b\n(1.12)\nKrB = inf t \u2265 0, LB\nr \u2265 0.\nt >r ,\nNote that due to the a.s. continuity of LB we have a.s. LB\nKr = r. In appendix B of [20]\nwe prove the following\nLemma 1.2. For any r \u2265 0\n(1.13)\n\n\u0001 r\nQ0 KrB \u2208 dt = g(t, r) dt,\nt\n\nand\n(1.14)\n\nB\n\nE0Q e\u2212\u03bbKr\n\n\u0001\n\n= e\u2212\n\n\u221a\n\n2\u03bbr\n\n,\n\nt > 0,\n\n\u03bb>0\n\nholds.\nMoreover, we shall make use of the following lemma, which is similar to results in\nSection 6.4 of [17], and which is proved in appendix B of [20].\n\u0001\nB\nLemma 1.3. Under Q0 , LB H{\u2212x,+x}\n, x > 0, is exponentially distributed with\nmean x.\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n5\n\n1.3. First Passage Time Formula for Single Vertex Graphs. In this subsection we\nset up some additional notation which will be used throughout this article. Also we\nrecord a special form of the first passage time formula, equation (I.2.6).\nLet X be a Brownian motion on G in the\u0001 sense of definition I.3.1 defined on a\nfamily \u03a9, A, F = (Ft , t \u2265 0), (P\u03be , \u03be \u2208 G) of filtered probability spaces. Let Hv\nbe the hitting time of the vertex v. Note that for all \u03be \u2208 G, P\u03be (Hv < +\u221e) = 1 (cf.\nthe discussion in section I.3). For \u03bb > 0, set\n\u221a\n\u0001\n\u03be \u2208 G,\n(1.15)\ne\u03bb (\u03be) = E\u03be exp(\u2212\u03bbHv ) = e\u2212 2\u03bbd(\u03be,v) ,\nwhere E\u03be ( * ) denotes expectation with respect to P\u03be . The last equality follows from\nformula (1.5).\nRecall that we denote the natural metric on G by d. We introduce another symmetric map dv from G \u00d7 G to R+ defined by\n(1.16)\n\ndv (\u03be, \u03b7) = d(\u03be, v) + d(v, \u03b7),\n\n\u03be, \u03b7 \u2208 G,\n\nwhich is the \"distance from \u03be to \u03b7 via the vertex v\". Observe that if \u03be, \u03b7 \u2208 G do not\nbelong to the same edge, then by the definition of d the equality dv (\u03be, \u03b7) = d(\u03be, \u03b7)\nholds true.\nNext we define two heat kernels on G by\nn\nX\n\u0001\n(1.17)\np(t, \u03be, \u03b7) =\n1lk (\u03be) g t, d(\u03be, \u03b7) 1lk (\u03b7),\nk=1\n\n(1.18)\n\npv (t, \u03be, \u03b7) =\n\nn\nX\n\n\u0001\n1lk (\u03be) g t, dv (\u03be, \u03b7) 1lk (\u03b7),\n\nk=1\n\nwith t > 0, \u03be, \u03b7 \u2208 G. g is the Gauss-kernel defined in equation (1.4). Hence, in local\ncoordinates \u03be = (k, x), \u03b7 = (m, y), x, y \u2265 0, k, m \u2208 {1, 2, . . . , n}, these kernels\nread\n\u0001\n1\n2\np t, (k, x), (m, y) = \u221a\n(1.19)\ne\u2212(x\u2212y) /2t \u03b4km\n2\u03c0t\n\u0001\n1\n2\n(1.20)\ne\u2212(x+y) /2t \u03b4km .\npv t, (k, x), (m, y) = \u221a\n2\u03c0t\nThe Dirichlet heat kernel pD on G is then given by\n(1.21)\n\npD (t, \u03be, \u03b7) = p(t, \u03be, \u03b7) \u2212 pv (t, \u03be, \u03b7),\n\nt > 0, \u03be, \u03b7 \u2208 G.\n\nIt is the transition density of a strong Markov process with state space G \u25e6 \u222a {\u2206}\nwhich on every edge of G \u25e6 is equivalent to a Brownian motion until the moment of\nreaching the vertex when it is killed, and \u2206 denotes a cemetery state adjoined to G\nas an isolated point. (Recall from section I.3 of article I that this process is not a\nBrownian motion on G in the sense of definition I.3.1.)\nThe Dirichlet resolvent RD = (R\u03bbD , \u03bb > 0) on G is defined by\n\u0010Z Hv\n\u0011\nD\n(1.22)\nR\u03bb f (\u03be) = E\u03be\ne\u2212\u03bbt f (Xt ) dt ,\n\u03bb > 0, \u03be \u2208 G, f \u2208 B(G).\n0\n\n\f6\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nIt is easy to see that R\u03bbD has the following integral kernel on G\n(1.23)\n\nr\u03bbD (\u03be, \u03b7) = r\u03bb (\u03be, \u03b7) \u2212 rv,\u03bb (\u03be, \u03b7),\n\n\u03be, \u03b7 \u2208 G,\n\nwhere for \u03be, \u03b7 \u2208 G,\n(1.24)\n\nr\u03bb (\u03be, \u03b7) =\n\nn\nX\n\n1lk (\u03be)\n\ne\u2212\n\n\u221a\n\n2\u03bb d(\u03be,\u03b7)\n\n\u221a\n\nk=1\n\n2\u03bb\n\n1lk (\u03b7),\n\nand\nrv,\u03bb (\u03be, \u03b7) =\n\nn\nX\n\n1lk (\u03be)\n\nk=1\n\n(1.25)\n=\n\ne\u2212\n\n\u221a\n\n2\u03bb dv (\u03be,\u03b7)\n\n\u221a\n\n2\u03bb\n\n1lk (\u03b7)\n\nn\nX\n\n1\n1lk (\u03be) \u221a e\u03bb (\u03be) e\u03bb (\u03b7) 1lk (\u03b7).\n2\u03bb\nk=1\n\nIn particular, r\u03bbD is the Laplace transform of the Dirichlet heat kernel (1.21) at \u03bb > 0.\nRecall the first passage time formula (I.2.6):\n\u0010Z S\n\u0011\n\u0001\ne\u2212\u03bbt f (Xt ) dt + E\u03be e\u2212\u03bbS R\u03bb f (XS ) ,\nR\u03bb f (\u03be) = E\u03be\n0\n\nwhere S is any P\u03be \u2013a.s. finite stopping time relative to J . The choice S = Hv gives\nthe following result.\nLemma 1.4. Let X be a Brownian motion on G with resolvent R = (R\u03bb , \u03bb > 0).\nThen for all \u03bb > 0, \u03be \u2208 G, f \u2208 B(G),\n(1.26)\n\nR\u03bb f (\u03be) = R\u03bbD f (\u03be) + e\u03bb (\u03be) R\u03bb f (v)\n\nholds true.\nThe following notation will be convenient. For real valued measurable functions\nf , g on G, with restrictions fk , gk , k \u2208 {1, 2, . . . , n}, to the edges lk we set\nZ\nn\nX\n(f, g) =\nf (\u03be) g(\u03be) d\u03be =\n(fk , gk ),\nG\n\nk=1\n\nwhere the integration is with respect to the Lebesgue measure on G, and\nZ \u221e\n(fk , gk ) =\nfk (x) gk (x) dx,\n0\n\nwhenever the integrals exist.\nAssume that f \u2208 C0 (G). Then for \u03bb > 0, R\u03bb f belongs to the domain of the\ngenerator of X, and therefore to C02 (G) (cf. subsection 1.1). It is straightforward to\ncompute the derivative of the right hand side of formula (1.26), and we obtain the\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n7\n\nCorollary 1.5. For every Brownian motion X on G with resolvent R = (R\u03bb , \u03bb > 0),\nand all f \u2208 C0 (G),\n\u221a\n(1.27)\n(R\u03bb f )0 (vk ) = 2(e\u03bb,k , fk ) \u2212 2\u03bbR\u03bb f (v),\nk \u2208 {1, 2, . . . , n},\nholds true.\n1.4. The Case b = 0. The case, where all parameters bk , k = 1, . . . , n, in equation (1.1) vanish, is trivial in the sense that the associated Brownian motion can be\nconstructed by a stochastic process living only on the edge where it started, and therefore it is just a classical Brownian motion on R+ in the sense of [18, Section 6.1].\nThis case is also discussed briefly in [18], but for the sake of completeness we include\nit here in somewhat more detail than in [18].\nConsider a standard Brownian motion on R as before, and without loss of generality assume in addition that the underlying sample space is large enough such that all\nconstant paths in R can be realized as paths of the Brownian motion. Construct from\nthe Brownian motion a new process by stopping it when it reaches the origin of R, and\nthen kill it after an exponential holding time (independent of the Brownian motion)\nwith rate \u03b2 \u2265 0. We shall only consider starting points x \u2208 R+ . If \u03b2 = 0, then the\nprocess is simply a Brownian motion with absorption at the origin. For example, it\nfollows from Theorem 10.1 and Theorem 10.2 in [5] that for every \u03b2 \u2265 0 this process\nis a strong Markov process, and obviously it has the path properties which make it a\nBrownian motion on R+ in the sense of [18, Section 6.1]. Thus, if \u03be \u2208 G, \u03be \u2208 lk ,\nk = 1, . . . , n, then we just have to map this process with the isomorphisms between\nthe edges lk , k = 1, . . . , n, and the interval [0, +\u221e) into G to obtain a Brownian\nmotion on G with start in \u03be, such that it is stopped when reaching the vertex, and then\nis killed there after an exponential holding time with rate \u03b2 \u2265 0.\nLet U 0 = (Ut0 , t \u2265 0) denote the semigroup associated with this process. It is\nobvious that for f \u2208 C0 (G) we get Ut0 f (v) = exp(\u2212\u03b2t)f (v), t \u2265 0. Thus for the\ncorresponding resolvent R0 = (R\u03bb0 , \u03bb > 0), and f \u2208 C0 (G) one finds\n(1.28)\n\n\u03bbR\u03bb0 f (v) \u2212 f (v) + \u03b2R\u03bb0 f (v) = 0,\n\n\u03bb > 0.\n\nLet A0 be the generator of this process, and recall from lemma I.5.2, that for all\nf \u2208 D(A0 ), A0 f (\u03be) = 1/2 f 00 (\u03be), \u03be \u2208 G. But then the identity \u03bbR\u03bb0 = A0 R\u03bb0 + id\nimplies the following formula\n\u000100\n1\nR\u03bb0 f (v) + \u03b2 R\u03bb0 f (v) = 0.\n2\nFor every \u03bb > 0 R\u03bb0 maps C0 (G) onto D(A0 ). With the choice a = (1 + \u03b2)\u22121 \u03b2,\nc = (1 + \u03b2)\u22121 this shows that the process realizes the boundary conditions of equations (1.1) with bk = 0, k = 1, . . . , n.\nMoreover, we can now use equation (1.26) combined with formula (1.28), to obtain\nthe following explicit expression for the resolvent with f \u2208 C0 (G), \u03bb > 0:\n(1.29)\n\nR\u03bb0 f (\u03be) = R\u03bbD f (\u03be) +\n\n\u221a\n1\ne\u2212 2\u03bbd(\u03be,v) f (v),\n\u03b2+\u03bb\n\n\u03be \u2208 G,\n\n\f8\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nwhere, as before, R\u03bbD is the Dirichlet resolvent.\nIn order to compute the heat kernel associated with this process on G, we invert the\nLaplace transforms in equation (1.29). For the first term on the right hand side this is\ntrivial, and gives the Dirichlet heat kernel pD , cf. equation (1.21). The second term\ncould be handled by a formula which can be found in the tables (e.g., [6, eq. (5.6.10)]).\nBut this formula involves the complementary error function erfc at complex arguments, and does not yield a very intuitive expression. Instead, we can simply use the\nobservation that t 7\u2192 exp(\u2212\u03b2t) is the inverse Laplace transform of \u03bb 7\u2192 (\u03b2 + \u03bb)\u22121 .\nMoreover, the well-known formula for the density of the hitting time of the origin by\na Brownian motion on the real line (e.g., [15, p. 25], [17, p. 96], [28, p. 102]) gives us\nthe following expression for the density of the first hitting time of the vertex\nd(\u03be, v) \u2212d(\u03be,v)2 /2s\nP\u03be (Hv \u2208 ds) = \u221a\ne\nds,\ns \u2265 0.\n2\u03c0s3\nUsing the well-known Laplace transform (e.g., [6, eq. 4.5.28])\nZ \u221e\n\u221a\na\n2\ne\u2212\u03bbs \u221a\na > 0, \u03bb > 0,\n(1.31)\ne\u2212a /2s ds = e\u2212 2\u03bba ,\n2\u03c0s3\n0\nwe infer that the inverse Laplace transform of the exponential in (1.29) is given by\nP\u03be (Hv \u2208 ds). Thus we obtain the following heat kernel\n(1.30)\n\n(1.32)\n0\n\nD\n\np (t, \u03be, d\u03b7) = p (t, \u03be, \u03b7) d\u03b7 \u2212\n\n\u0010Z\n\nt\n\n\u0011\ne\u2212\u03b2(t\u2212s) P\u03be (Hv \u2208 ds) \u000fv (d\u03b7),\n\n0\n\n\u0010Z\n\nt\n\nd(\u03be, v) \u2212d(\u03be,v)2 /2s \u0011\ne\u2212\u03b2(t\u2212s) \u221a\ne\nds \u000fv (d\u03b7),\n2\u03c0s3\n0\nwith \u03be, \u03b7 \u2208 G, t > 0, and \u000fv is the Dirac measure at the vertex v.\n= pD (t, \u03be, \u03b7) d\u03b7 \u2212\n\n1.5. Killing via the Local Time at the Vertex. We recall from remark I.3.2, that\nwe may and will consider every Brownian motion X on G with respect to a filtration\nF = (Ft , t \u2265 0) which is right continuous and complete relative to (P\u03be , \u03be \u2208 G), and\nsuch that X is strongly Markovian with respect to F.\nIn this subsection we suppose that X is a Brownian motion on the single vertex\ngraph G with infinite lifetime, and such that the vertex is not absorbing. This entails\n(cf. section I.3) that X leaves the vertex immediately and begins a standard Brownian\nexcursion into one of the edges. Therefore we get in this case for the hitting time Hv of\nthe vertex Pv (Hv = 0) = 1, i.e., v is regular for {v} in the sense of [3]. Consequently\nX has a local time L = (Lt , t \u2265 0) at the vertex (e.g., [3, Theorem V.3.13]). Without\nloss of generality, we suppose throughout this subsection that L is a perfect continuous\nhomogeneous additive functional (PCHAF) of X in the sense of [33, Section III.32].\nThat is, L is a non-decreasing process, which is adapted to F, and such that it \u0001is a.s.\ncontinuous, additive, i.e., Lt+s = Lt + Ls \u25e6 \u03b8t , and for all \u03be \u2208 G, P\u03be L0 = 0 = 1\nholds true. Moreover we may and will assume from now on that X and L are pathwise\ncontinuous.\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n9\n\nKilling X exponentially on the scale of L, we can construct a new Brownian motion X\u0302 on G. We shall do this using the method of [17, 18].\nLet K = (Ks , s \u2208 R+ ) denote the right continuous pseudo-inverse of L:\n(1.33)\n\nKs = inf{t \u2265 0, Lt > s},\n\ns \u2208 R+ ,\n\nwhere - as usual - we make the convention that inf \u2205 = +\u221e. The continuity of L\nentails that for every s \u2208 R+ , LKs = s. Clearly, K is increasing, and due to its right\ncontinuity it is a measurable stochastic process. Fix s \u2208 R+ . It is straightforward to\ncheck that for every t \u2208 R+ ,\n(1.34)\n\n{Ks < t} = {Lt > s}.\n\nBecause L is adapted, the set on the right hand side belongs to Ft , and since F is\nright continuous, equality (1.34) shows that for every s \u2208 R+ , Ks is a stopping time\nrelative to F. We remark that since L only increases when X is at the vertex v, the\ncontinuity of X implies that for every s \u2208 R+ we get X(Ks ) = v on {Ks < +\u221e}.\nOn the other hand, we shall argue below that L a.s. increases to +\u221e, so that we get\nX(Ks ) = v a.s. for all s \u2208 R+ .\nLet \u03b2 > 0. Bring in the additional probability space (R+ , B(R+ ), P\u03b2 ), where P\u03b2\nis the exponential law with rate \u03b2. Let S denote the associated coordinate random\nvariable S(s) = s, s \u2208 R+ . Define\n\u03a9\u0302 = \u03a9 \u00d7 R+ ,\n\u00c2 = A \u2297 B(R+ ),\nP\u0302\u03be = P\u03be \u2297 P\u03b2 ,\n\n\u03be \u2208 G.\n\nWe extend X, L, K, and S in the canonical way to these enlarged probability spaces,\nbut for simplicity keep the same notation for these quantities.\nSet\n\b\n(1.35)\n\u03b6\u03b2 = inf t \u2265 0, Lt > S ,\nand observe that since K is measurable we may write \u03b6\u03b2 = KS . Thus as above we\nget X(\u03b6\u03b2 ) = v. Define the killed process\n(\nXt , t < \u03b6\u03b2 ,\n(1.36)\nX\u0302t =\n\u2206, t \u2265 \u03b6\u03b2 .\nSince this prescription for killing the process X via the (PCHAF) L is slightly\ndifferent from the method used in [3, 33], we cannot use the results proved there to\nconclude that the subprocess X\u0302 of X is still a strong Markov process. However, it\nhas been proved in [20, Appendix A] that the strong Markov property is preserved\nunder this method of killing, i.e., X\u0302 is a strong Markov process relative to its natural\nfiltration (actually relative to a larger filtration, but we will not use this here). Now we\nmay employ the arguments in section 2.7 of [17], or in section III.2 of [28] to conclude\nthat X\u0302 is a strong Markov process with respect to the universal right continuous and\ncomplete augmentation of its natural filtration.\n\n\f10\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nIt is clear that X\u0302 has a.s. right continuous paths which admit left limits, and that its\npaths on [0, \u03b6\u03b2 ) are equal to those of X, and thus are continuous on this random time\ninterval. Moreover, it is obvious that for every \u03be \u2208 G \u25e6 , we have P\u03be (\u03b6\u03b2 \u2265 Hv ) = 1.\nTherefore, up to its hitting time of the vertex, X\u0302 is equivalent to a Brownian motion\non the edge to which \u03be belongs, because so is X. Altogether we have proved that -\nunder the hypothesis that L is a PCHAF, which will be argued below in all cases that\nwe consider - X\u0302 is a Brownian motion on G in the sense of definition I.3.1.\nThere is a simple, useful relationship between the resolvents R and R\u0302 of the processes X and X\u0302, respectively. Recall our convention that all functions f on G are\nextended to G \u222a {\u2206} by f (\u2206) = 0.\nLemma 1.6. For all \u03bb > 0, f \u2208 B(G), \u03be \u2208 G,\n(1.37)\n\n\u0001\nR\u0302\u03bb f (\u03be) = R\u03bb f (\u03be) \u2212 e\u03bb (\u03be) \u00cav e\u2212\u03bb\u03b6\u03b2 R\u03bb f (v)\n\nholds true, where e\u03bb is defined in equation (1.15).\nProof. For \u03bb > 0, f \u2208 B(G), \u03be \u2208 G\n\u0010Z \u03b6 \u03b2\n\u0011\nR\u0302\u03bb f (\u03be) = \u00ca\u03be\ne\u2212\u03bbt f (Xt ) dt\n0\nZ \u221e\n\u0010\n\u0001 \u0011\n\u2212\u03bb\u03b6\u03b2\ne\u2212\u03bbt f Xt+\u03b6\u03b2 dt .\n= R\u03bb f (\u03be) \u2212 \u00ca\u03be e\n0\n\nBy construction, the last expectation value is equal to\nZ \u221e\nZ \u221e\n\u0010\n\u0001\u0011\n\u2212\u03b2s\ne\u2212\u03bbt E\u03be e\u2212\u03bbKs f Xt+Ks dt ds,\ne\n\u03b2\n0\n\n0\n\nwhere we used Fubini's theorem. Consider the expectation value under the integrals,\nand recall that for fixed s \u2208 R+ , Ks is an F\u2013stopping time, while X is strongly\nMarkovian relative to F. Hence we can compute as follows\n\u0010\n\u0010\n\u0010\n\u0001\u0011\u0011\n\u0001\u0011\nE\u03be e\u2212\u03bbKs f Xt+Ks = E\u03be e\u2212\u03bbKs E\u03be f Xt+Ks FKs\n\u0010\n\u0001\u0011\n= E\u03be e\u2212\u03bbKs EX(Ks ) f (Xt )\n\u0001\n\u0001\n= E\u03be e\u2212\u03bbKs Ev f (Xt ) ,\nwhere we used the fact that a.s. X(Ks ) = v. So far we have established\n\u0001\nR\u0302\u03bb f (\u03be) = R\u03bb f (\u03be) \u2212 \u00ca\u03be e\u2212\u03bb\u03b6\u03b2 R\u03bb f (v).\nIn order to compute the expectation value on the right hand side, we first remark that\nbecause L is zero until X hits the vertex for the first time, we find that for given\ns \u2208 R+ , Ks \u2265 Hv , and therefore Ks = Hv + Ks \u25e6 \u03b8Hv . Hence, and again by the\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n11\n\nstrong Markov property,\n\u0001\n\u0001\nE\u03be e\u2212\u03bbKs = E\u03be e\u2212\u03bbHv e\u2212\u03bbKs \u25e6Hv\n= E\u03be e\u2212\u03bbHv E\u03be e\u2212\u03bbKs \u25e6Hv FHv\n\u0001\n\u0001\n= E\u03be e\u2212\u03bbHv Ev e\u2212\u03bbKs ,\n\n\u0001\u0001\n\nIntegrating the last identity against the exponential law in the variable s, we find with\nformula (1.15)\n\u0001\n\u0001\n\u00ca\u03be e\u2212\u03bb\u03b6\u03b2 = e\u03bb (\u03be) \u00cav e\u2212\u03bb\u03b6\u03b2 ,\n\u0003\n\nand the proof is finished.\n\nRemark 1.7. Formula (1.37) is quite useful, because if the resolvent of X is known,\nthen - in view of equation (1.15) - it reduces the calculation of R\u0302\u03bb to the computation of the Laplace transform of the density of \u03b6\u03b2 under P\u0302v .\n2. T HE WALSH P ROCESS\nThe most basic process - which on a single vertex graph plays the same role as a\nreflected Brownian motion on the half line - is the well-known Walsh process, which\nwe denote by W = (Wt , t \u2265 0). It corresponds to the case where the parameters a\nand c in the boundary condition (1.1) both vanish. This process has been introduced\nby Walsh in [31] as a generalization of the skew Brownian motion discussed in [15,\nChapter 4.2] to a process in R2 which only moves on rays connected to the origin.\nA pathwise construction of the Walsh process in the present context is as follows.\nConsider the paths of the standard Brownian motion B = (Bt , t \u2265 0) on R, and\nits associated reflected Brownian motion |B| = (|Bt |, t \u2265 0), where | * | denotes\nabsolute value. Let Z = {t \u2265 0, Bt = 0}. Then its complement Z c is open, and\nhence it is the pairwise disjoint union of a countable family of excursion intervals Ij =\n(tj , tj+1 ), j \u2208 N. Let R = (Rj , j \u2208 N) be an independent sequence of identically\ndistributed random variables, independent of B, with values in {1, 2, . . . , n}P\nsuch that\nRj , j \u2208 N, takes the value k \u2208 {1, 2, . . . , n} with probability wk \u2208 [0, 1], k wk =\n1. Now define Wt = v if t \u2208 Z, and if t \u2208 Ij , and Rj = k set Wt = (k, |Bt |). In\nother words, when starting at \u03be \u2208 G \u25e6 , the process moves as a Brownian motion on the\nedge containing \u03be until it hits the vertex at time Hv , and then W performs Brownian\nexcursions from the vertex v into the edges lk , k \u2208 {1, 2, . . . , n}, whereby the edge\nlk is selected with probability wk .\nAs for the standard Brownian motion on R (cf. subsection 1.2), we may and will\nassume without loss of generality that W has exclusively continuous paths.\nWalsh has remarked in the epilogue of [31], cf. also [2], that it is not completely\nstraightforward to prove that this stochastic process is strongly Markovian. A proof\nof the strong Markov property based on It\u00f4's excursion theory [13] has been given\nin [29, 30]. A construction of this process via its Feller semigroup can be found in [2]\n(cf. also the references quoted there for other approaches).\n\n\f12\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nNext we check that the Walsh process has a generator with boundary condition at\nthe vertex given by (1.1) with a = c = 0. Let f \u2208 D(Aw ). At the vertex v Dynkin's\nform for the generator reads\n\u0010\n\u0001\u0011\nw )\nEv f (X(Hv,\u000f\n\u2212 f (v)\n(2.1)\nAw f (v) = lim\n,\nw )\n\u000f\u21930\nEv (Hv,\u000f\nw is the hitting time of the complement of the open ball B (v) of radius\nwhere Hv,\u000f\n\u000f\n\u000f > 0 around v.\nw ) = \u000f2 .\nLemma 2.1. For the Walsh process Ev (Hv,\u000f\nw is the hitting time of the\nProof. Since by construction W has infinite lifetime, Hv,\u000f\nset of the n points with local coordinates (k, \u000f), k = 1, . . . , n. Therefore, by the\nindependence of the choice of the edge for the values of the excursion, it follows that\nw has the same law as the hitting time of the point \u000f > 0\nunder Pv the stopping time Hv,\u000f\nof a reflected Brownian motion on R+ , starting at 0. Thus the statement of the lemma\nfollows from equation (1.6).\n\u0003\n\nFrom the construction of W we immediately get\nn\n\u0010\n\u0001\u0011 X\nw\nEv f W (Hv,\u000f\n) =\nwk fk (\u000f),\nk=1\n\nwith the notation fk (x) = f (k, x), x \u2208 R+ . Inserting this into equation (2.1) we\nobtain\nn\nX\n\u0001\nw\n\u22122\nA f (v) = lim \u000f\nwk fk (\u000f) \u2212 f (v) ,\n\u000f\u21930\n\nk=1\n\nand since f 0 (vk ) exists (cf. section I.5) it is obvious that this entails the condition\nn\nX\n(2.2)\nwk f 0 (vk ) = 0.\nk=1\n\nFor later use we record this result as\nTheorem 2.2. Consider the boundary condition (1.1) with a = c = 0, and b \u2208\n[0, 1]n . Let W be a Walsh process as constructed above with the choice wk = bk ,\nk \u2208 {1, 2, . . . , n}. Then the generator Aw of W is 1/2 times the second derivative on\nG with domain consisting of those f \u2208 C02 (G) which satisfy condition (1.1b).\nFor the remainder of this section we make the choice a = c = 0, wk = bk ,\nk \u2208 {1, 2, . . . , n} in (1.1).\nNext we compute the resolvent of W . Let \u03bb > 0, f \u2208 C0 (G), and consider first\n\u03be = v. Without loss of generality, we may assume that W has been constructed\npathwise from a standard Brownian motion B as described above, and that B is as in\nsubsection 1.2. Then we get\nn\n\u0001 X\n\u0001\nEv f (Wt ) =\nbm E0Q fm (|Bt |) .\nm=1\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n13\n\nHence we find for the resolvent Rw of the Walsh process\nZ\n(2.3a)\nR\u03bbw f (v) =\nr\u03bbw (v, \u03b7) f (\u03b7) d\u03b7\nG\n\nwith resolvent kernel\n\nr\u03bbw (v, \u03b7),\n\n(2.3b)\n\nr\u03bbw (v, \u03b7)\n\n\u03b7 \u2208 G, given by\n=\n\nn\nX\n\n2bm\n\nm=1\n\ne\u2212\n\n\u221a\n\n2\u03bb d(v,\u03b7)\n\n\u221a\n\n1lm (\u03b7),\n\n2\u03bb\n\nand where the integration in (2.3a) is with respect to the Lebesgue measure on G.\nNow let \u03be \u2208 G. We use the first passage time formula (1.26) together with formulae (1.15) and (2.3), and obtain\nLemma 2.3. The resolvent of the Walsh process on G is given by\nZ\nr\u03bbw (\u03be, \u03b7)f (\u03b7) d\u03b7,\n\u03bb > 0, \u03be \u2208 G, f \u2208 B(G),\n(2.4a)\nR\u03bbw f (\u03be) =\nG\n\nwith\n(2.4b)\n(2.4c)\n\nr\u03bbw (\u03be, \u03b7)\n\n= r\u03bb (\u03be, \u03b7) +\n\nn\nX\n\n1\nw\n\u221a e\u03bb,m (\u03b7),\ne\u03bb,k (\u03be) Skm\n2\u03bb\nk,m=1\n\nw\n= 2wm \u2212 \u03b4km ,\nSkm\n\nwhere r\u03bb is defined in equation (1.24), and where e\u03bb,k , e\u03bb,m denote the restrictions of\ne\u03bb (cf. (1.15)) to the edges lk , lm respectively.\n\u0001\nw , k, m = 1, . . . , n is the scattering matrix\nRemark 2.4. The matrix S w = Skm\nas defined in quantum mechanics. We briefly recall its construction in the present\ncontext, for more details the interested reader is referred to [23]. S w is obtained from\nthe boundary conditions at the vertex v in the following way. Consider a function\nf on G which is continuously differentiable in G \u25e6 = G \\ {v}, and such that for all\nk = 1, . . . , n the limits\nFk = f (vk ) =\nFk0 = f 0 (vk ) =\n\nlim\n\nf (\u03be)\n\nlim\n\nf 0 (\u03be)\n\n\u03be\u2192v, \u03be\u2208lk\u25e6\n\n\u03be\u2192v, \u03be\u2208lk\u25e6\n\nexist. Define two column vectors F , F 0 \u2208 Cn , having the components Fk and Fk0 , k =\n1, . . . , n, respectively. Furthermore, consider boundary conditions of the following\nform\n(2.5)\n\nAF + BF 0 = 0,\n\nwhere A and B are complex n \u00d7 n matrices. The on-shell scattering matrix at energy\nE > 0 is defined as\n\u221a\n\u221a\n(2.6)\nSA,B (E) = \u2212(A + i EB)\u22121 (A \u2212 i EB),\n\n\f14\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nwhich exists and is unitary, provided the n \u00d7 2n matrix (A, B) has maximal rank (i.e.,\nrank n) and AB \u2020 is hermitian. These requirements for A and B guarantee that the corresponding Laplacean is a self-adjoint operator on L2 (G) (with Lebesgue measure).\nObserve that under these conditions the boundary conditions (2.5) are equivalent to\nany boundary conditions of the form CAF + CBF 0 = 0 where C is invertible. Also\nSCA,CB (E) = SA,B (E) holds true. For the Walsh process at hand, concrete choices\nfor A and B are given by\n\uf8eb\n0 0\n0 ...\n\uf8ec1 \u22121 0 . . .\n\uf8ec\n\uf8ec0 1 \u22121 . . .\n\uf8ec\nAw = \uf8ec0 0\n1 ...\n\uf8ec\n\uf8ec ..\n..\n..\n..\n\uf8ed.\n.\n.\n.\n0 0\n0 ...\n\n0\n0\n0\n0\n..\n.\n\n0\n0\n0\n0\n..\n.\n\n\uf8f6\n\n\uf8eb\n\nb1 b2 b3\n\uf8f7\n\uf8ec0 0 0\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec0 0 0\n\uf8f7\n\uf8ec\n\uf8f7 , B w = \uf8ec ..\n..\n..\n\uf8f7\n\uf8ec.\n.\n.\n\uf8f7\n\uf8ec\n\uf8f8\n\uf8ed0 0 0\n1 \u22121\n0 0 0\n\n\uf8f6\n. . . bn\u22121 bn\n...\n0\n0\uf8f7\n\uf8f7\n...\n0\n0\uf8f7\n\uf8f7\n..\n.. \uf8f7 .\n..\n.\n.\n.\uf8f7\n\uf8f7\n...\n0\n0\uf8f8\n...\n0\n0\n\nThen (2.5) is the condition that f is actually continuous at the vertex v, i.e., f (vk ) =\nf (vm ), k, m = 1, . . . , n, and that (2.2) is valid (with wk = bk , k \u2208 {1, 2, . . . , n}).\nObviously, (Aw , B w ) has maximal rank. However, Aw (B w )\u2020 is hermitian if and only\nif all bk are equal (i.e., bk = 1/n, k = 1, . . . , n). Nevertheless, (2.6) exists also in the\nnon-hermitian case, and SAw ,B w (E) = S w holds for all E > 0 due to the relations\nAw S w = \u2212Aw , and B w S w = B w . In addition, the following relations are valid:\n(2.7)\n(2.8)\n\nSw = Sw\nw\n\n\u0001\u22121\n\n,\n\nn+1\n\ndet S = (\u22121)\n\n.\n\nFurthermore, S w is a contraction, and the associated Laplace operator is m-dissipative\non L2 (G) since trivially Im(AB \u2020 ) = 0, cf. Theorem 2.5 in [19]. When all bk are equal,\nsuch that Aw (B w )\u2020 = 0, then S w is an involutive, orthogonal matrix of the form\n(2.9)\n\nS w = \u22121 + 2Pn .\n\nPn is the matrix whose entries are equal to 1/n. Pn is a real orthogonal projection,\nthat is Pn = Pn\u2020 = Pnt = Pn2 . It is also of rank 1, that is dim RanPn = 1. The\nrelation (2.4b) giving the resolvent in terms of the scattering matrix is actually valid\nin the more general context of arbitrary metric graphs and boundary conditions of the\nform (2.5), see [19, 24].\nIt is straightforward to compute the inverse Laplace transform of the right hand\nside of formula (2.4b), and this yields the following result.\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n15\n\nLemma 2.5. For t > 0, \u03be, \u03b7 \u2208 G the transition density of the Walsh process on G is\ngiven by\n(2.10)\n\nw\n\nD\n\np (t, \u03be, \u03b7) = p (t, \u03be, \u03b7) +\n\n\u0001\n1lk (\u03be) 2wm g t, dv (\u03be, \u03b7) 1lm (\u03b7),\n\nk,m=1\nn\nX\n\n\u0001\nw\n1lk (\u03be) Skm\ng t, dv (\u03be, \u03b7) 1lm (\u03b7).\n\n= p(t, \u03be, \u03b7) +\n\n(2.11)\n\nn\nX\n\nk,m=1\n\np(t, \u03be, \u03b7) is defined in equation (1.17), pD (t, \u03be, \u03b7) in equation (1.21), g is the Gausskernel (1.4), and dv is defined in equation (1.16).\nRemark 2.6. Alternatively pw (t, \u03be, \u03b7) can also be written as\npw (t, \u03be, \u03b7) = p(t, \u03be, \u03b7)\n(2.12)\n\n+\n\nn\nX\nk,m=1\n\nZ\n1lk (\u03be)\n\nt\n\n\u0001\nw\nP\u03be (Hv \u2208 ds) Skm\ng t \u2212 s, d(v, \u03b7) 1lm (\u03b7).\n\n0\n\nEven though this formula appears somewhat more complicated than (2.11), it exhibits\nthe role of the scattering matrix S w , that is, it describes more clearly what happens\nwhen the process hits the vertex.\n3. T HE E LASTIC WALSH P ROCESS\nIn this section we consider the boundary conditions (1.1) with 0 < a < 1 and c =\n0. The corresponding stochastic process, which we will denote by W e , is constructed\nfrom the Walsh process W of the previous section in the same way as the elastic\nBrownian motion on R+ is constructed from a reflected Brownian motion (cf., e.g.,\n[14], [15, Chapter 2.3], [18, Chapter 6.2], [17, Chapter 6.4]).\nIn more detail, the construction is as follows. Consider the Walsh process W as\ndiscussed in the previous section. We may continue to suppose that W has been\nconstructed pathwise from a standard Brownian motion B, as it has been described\nthere. But then the local time of W at the vertex, denoted by Lw , is pathwise equal\nto the local time of the Brownian motion at the origin (and we continue to use the\nnormalization determined by (1.8)). It is well-known (e.g., [15, 17, 18, 28]) that Lw\nhas all properties of a PCHAF as formulated in subsection 1.5 for the construction\nof a subprocess by killing W at the vertex. We continue to denote the rate of the\nexponential random variable S used there by \u03b2 > 0. Let W e be the subprocess so\nobtained. In particular (cf. 1.5), W e is a Brownian motion on G, and in analogy with\nthe case of a Brownian motion on the real line we call this stochastic process the\nelastic Walsh process. We write \u03b6\u03b2,0 for the lifetime of W e (i.e., for the random time\ncorresponding to \u03b6\u03b2 in subsection 1.5).\nWe proceed to show that the elastic Walsh process W e has a generator Ae with\ndomain D(Ae ) which satisfies the boundary conditions as claimed. In other words, we\n\n\f16\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nclaim that there exist a \u2208 (0, 1) and bk \u2208 (0, 1), k \u2208 {1, 2, . . . , n}, with a +\n1, so that for all f \u2208 D(G),\naf (v) =\n\n(3.1)\n\nn\nX\n\nP\n\nk bk\n\n=\n\nbk f 0 (vk )\n\nk=1\n\nholds. To this end, we calculate Ae f (v) in Dynkin's form. We shall use a notation\nsimilar to the one used in subsection 1.5. Namely, let P\u0302v and \u00cav denote the probability\nand expectation, respectively, on the probability space extended by (R+ , B(R+ ), P\u03b2 ),\nwhile the corresponding symbols without \u02c6* are those for the Walsh process without\nkilling.\ne denote the hitting time of the complement B (v)c\nFor \u000f > 0 and under W e let Hv,\u000f\n\u000f\ne = Hw \u2227 \u03b6\nof the open ball B\u000f (v) of radius \u000f > 0 with center v. Then Hv,\u000f\n\u03b2,0 ,\nv,\u000f\nw is the hitting time of B (v)c by the Walsh process W . (Note that\nwhere as before Hv,\u000f\n\u000f\nB\u000f (v)c contains the cemetery \u2206.) We find\n(3.2)\n\nn\n\u0010\n\u0011\n\u0001 \u0011 \u0010X\n\u0001\nw\ne\n< \u03b6\u03b2,0 .\n\u00cav f W e (Hv,\u000f\n) =\nwk fk (\u000f) P\u0302v Hv,\u000f\nk=1\n\nThe probability in the last expression is taken care of by the following lemma.\nLemma 3.1. For all \u000f, \u03b2 > 0,\n(3.3)\n\n\u0001\nw\nP\u0302v Hv,\u000f\n< \u03b6\u03b2,0 =\n\n1\n.\n1 + \u000f\u03b2\n\nProof. We may consider the Walsh process W as being pathwise constructed from\na standard Brownian motion B on the real line as in the previous section, and we\nshall use the notations and conventions from there. Then it is clear that under Pv\nw has the same law as the hitting time of the point \u000f in R by the\nand under P\u0302v , Hv,\u000f\n+\nB\nreflecting Brownian motion |B| under Q0 , that is, as H{\u2212\u000f,\u000f} of the Brownian motion\nB itself under Q0 . Let K w denote the right continuous pseudo-inverse of Lw . For\nfixed s \u2208 R+ we get\nw\nw\n{Ksw < Hv,\u000f\n} = {Lw (Hv,\u000f\n) > s}.\n\nHence\n\u0001\n\u0001\nw\nw\nPv Ksw < Hv,\u000f\n= Pv Lw (Hv,\u000f\n)>s\n\u0001\nB\n= Q0 LB (H{\u2212\u000f,\u000f}\n)>s .\nIn appendix B of [20] is shown with the method in [17, Section 6.4] that under Q0 the\nB\nrandom variable LB (H{\u2212\u000f,\u000f}\n) is exponentially distributed with mean \u000f. So we find\n\u0001\nw\nPv Ksw < Hv,\u000f\n= e\u2212s/\u000f .\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n17\n\nWe integrate this relation against the exponential law with rate \u03b2 in the variable s, and\nobtain\nZ \u221e\n\u0001\n\u0001\nw\nw\nP\u0302v \u03b6\u03b2,0 > Hv,\u000f = 1 \u2212 \u03b2\ne\u2212\u03b2s Pv KsW < Hv,\u000f\nds\n0\n\n1\n=\n.\n1 + \u000f\u03b2\nw . \u0003\nWe used the fact that due to the continuity of the paths of W we have \u03b6\u03b2,0 6= Hv,\u000f\n\nWe insert formula (3.3) into equation (3.2), and obtain\n\u0010 \u0010\n\u0011\n\u0001\u0011\n1\ne\nAe f (v) = lim\n\u00cav f W e (Hv,\u000f\n) \u2212 f (v)\n\u000f\u21930 \u00cav (H e )\nv,\u000f\nn\n\u0010 1\n\u0011\nX\n1\n= lim\nwk fk (\u000f) \u2212 f (v)\n\u000f\u21930 \u00cav (H e ) 1 + \u000f\u03b2\nv,\u000f\nk=1\n\n= lim\n\u000f\u21930\n\ne )\n\u00cav (Hv,\u000f\n\n1\ne\n1\n+\n\u000f\u03b2\n\u00cav (Hv,\u000f )\n\u000f\n\nw )\nEv (Hv,\u000f\n\nn\n\u0010X\nk=1\n\nwk\n\n\u0011\nfk (\u000f) \u2212 f (v)\n\u2212 \u03b2f (v) .\n\u000f\n\n\u000f2\n\n=\n(cf. lemma 2.1). Since the last limit and\n\u2264\nObviously\n0\nf (vk ), k \u2208 {1, 2, . . . , n}, exist and are finite, we get as a necessary condition\n(3.4)\n\nn\nX\n\nwk f 0 (vk ) \u2212 \u03b2f (v) = 0.\n\nk=1\n\nThus we have proved the following theorem.\nTheorem 3.2. Consider the boundary condition (1.1) with a \u2208 (0, 1), b \u2208 [0, 1]n ,\nand c = 0. Set\nbk\na\n(3.5)\nwk =\n, k = 1, . . . , n, \u03b2 =\n,\n1\u2212a\n1\u2212a\nand let W e be the elastic Walsh process as constructed above with these parameters.\nThen the generator Ae of W e is 1/2 times the second derivative on G with domain\nconsisting of those f \u2208 C02 (G) which satisfy condition (1.1b).\nRemark 3.3. Note that condition\nP(1.1a) entails that if wk and \u03b2 are defined by (3.5)\nthen wk \u2208 [0, 1], k = 1, . . . , n, k wk = 1, and \u03b2 > 0. Therefore the choice (3.5) is\nconsistent with the conditions on these parameters required by the construction of the\nelastic Walsh process W e .\nNext we compute the resolvent Re of the elastic Walsh process. As a byproduct\nthis will give another proof of theorem 3.2. Moreover, it will provide us with an\nexplicit formula for the scattering matrix in this case. In contrast to the calculations\nin [15, Chapter 2.3], [18, Chapter 6.2] for the classical case with G = R+ , we do\nnot use the first passage time formula (1.26), but instead we use formula (1.37). This\nsimplifies the computation considerably.\n\n\f18\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nLet f \u2208 C0 (G), \u03bb > 0, and \u03be \u2208 G. In the present context formula (1.37) reads\n\u0001\nR\u03bbe f (\u03be) = R\u03bbw f (\u03be) \u2212 e\u03bb (\u03be) \u00cav e\u2212\u03bb\u03b6\u03b2,0 R\u03bbw f (v),\nwhere Rw is the resolvent of the Walsh process without killing, and e\u03bb is defined\nin (1.15). The Laplace transform of the density of \u03b6\u03b2,0 under P\u0302v is readily computed:\nLemma 3.4. For all \u03bb, \u03b2 > 0,\n\u0001\n\u00cav e\u2212\u03bb\u03b6\u03b2,0 =\n\n\u03b2\n\u221a .\n\u03b2 + 2\u03bb\n\nProof. As remarked before, we may consider Lw to be equal to the local time at the\norigin of the Brownian motion B underlying the construction of W , and therefore the\nanalogous statement is true for the right continuous pseudo-inverse K w of Lw . As\nabove let K B denote the right continuous pseudo-inverse of LB (cf. 1.2). Then for\ns \u2208 R+ ,\nB\u0001\nw\u0001\nEv e\u2212\u03bbKs = E0Q e\u2212\u03bbKs\n\u221a\n\n= e\u2212\n\n2\u03bbs\n\n,\n\nwhere we used lemma 1.2. Hence\n\u2212\u03bb\u03b6\u03b2,0\n\n\u00cav e\n\n\u0001\n\nZ\n=\u03b2\n\n\u221e\n\n\u221a\n\ne\u2212(\u03b2+\n\n2\u03bb)t\n\ndt,\n\n0\n\n\u0003\n\nwhich proves the lemma.\nWith lemma 3.4 we obtain the following formula\n(3.6)\n\nR\u03bbe f (\u03be) = R\u03bbw f (\u03be) \u2212\n\n\u03b2\n\u221a e\u03bb (\u03be) R\u03bbw f (v).\n\u03b2 + 2\u03bb\n\nNote that R\u03bbw f is in the domain of the generator of the Walsh process, and therefore\nsatisfies the boundary condition (2.2):\nn\nX\n\n\u00010\nwk R\u03bbw f (vk ) = 0.\n\nk=1\n\n\u221a\n0\nOn the other\nPnhand, we obviously have e\u03bb (vk ) = \u2212 2\u03bb for all k \u2208 {1, 2, . . . , n}.\nThus with k=1 wk = 1 we find,\n\u221a\nn\nX\n\u00010\n2\u03bb\ne\n\u221a R\u03bbw f (v),\nwk R\u03bb f (vk ) = \u03b2\n\u03b2\n+\n2\u03bb\nk=1\nwhile equation (3.6) yields for \u03be = v\n\u221a\n\nR\u03bbe f (v)\n\n=\n\n2\u03bb\n\u221a R\u03bbw f (v).\n\u03b2 + 2\u03bb\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n19\n\nThe last two equations show that for all f \u2208 C0 (G), \u03bb > 0, we have\nn\nX\n\n\u00010\nwk R\u03bbe f (vk ) = \u03b2 R\u03bbe f (v).\n\nk=1\n\nR\u03bbe\n\nSince for every \u03bb > 0,\nmaps C0 (G) onto the domain of the generator of W e , we\nhave another proof of theorem 3.2.\nUpon insertion of the expressions for the resolvent kernels of the Walsh process,\nequations (2.3), and (2.4), with the same notation as in lemma 2.3 we immediately\nobtain the following result:\nLemma 3.5. For \u03bb > 0, \u03be, \u03b7 \u2208 G the resolvent kernel of the elastic Walsh process\nW e is given by\nr\u03bbe (\u03be, \u03b7)\n\n(3.7a)\n\n=\n\nr\u03bbD (\u03be, \u03b7)\n\n+\n\n= r\u03bb (\u03be, \u03b7) +\n\n(3.7b)\n\nn\nX\n\ne\u03bb,k (\u03be) 2wm\n\nk,m=1\nn\nX\n\n\u03b2+\n\n1\n\u221a\n\n2\u03bb\n\ne\u03bb,m (\u03b7)\n\n1\ne\ne\u03bb,k (\u03be) Skm\n(\u03bb) \u221a e\u03bb,m (\u03b7),\n2\u03bb\nk,m=1\n\nwith the scattering matrix S e\n\u221a\n2\u03bb\ne\n\u221a wm \u2212 \u03b4km ,\n(3.7c)\nSkm (\u03bb) = 2\n\u03b2 + 2\u03bb\n\n\u03bb > 0, k, m \u2208 {1, 2, . . . , n}.\n\nRemark 3.6. Note that in contrast to the case of the Walsh process, this time the scattering matrix is not constant with respect to \u03bb > 0. Also, when \u03b2 = 0, formula (2.4c)\nis recovered, as it should be. In analogy with the discussion in remark 2.4, the boundary conditions for the elastic Walsh process is given by the matrices\n\uf8f6\n\uf8eb\n\uf8f6\n\uf8eb\n0 0\n0 ... 0 \u03b2\nw1 w2 w3 . . . wn\u22121 wn\n\uf8ec1 \u22121 0 . . . 0 0 \uf8f7\n\uf8ec0\n0\n0 ...\n0\n0\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec0 1 \u22121 . . . 0 0 \uf8f7\n\uf8ec0\n\uf8f7\n0\n0\n.\n.\n.\n0\n0\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8f7\ne\nAe = \uf8ec 0 0\n,\nB\n=\n,\n\uf8f7\n\uf8ec\n1 ... 0 0 \uf8f7\n0\n0 ...\n0\n0\uf8f7\n\uf8ec\n\uf8ec0\n\uf8f7\n\uf8ec ..\n\uf8ec ..\n..\n..\n.. \uf8f7\n..\n.. . .\n..\n.. \uf8f7\n. . ..\n\uf8ed.\n\uf8ed .\n. .\n.\n.\n.\n. \uf8f8\n.\n.\n.\n. \uf8f8\n0\n\n0\n\n0\n\n. . . 1 \u22121\n\n0\n\n0\n\n0\n\n...\n\n0\n\n0\n\nsuch that\nS e (\u03bb) = SAe ,B e (E = \u22122\u03bb)\n\u221a\n\u221a\n= \u2212(Ae + 2\u03bbB e )\u22121 (Ae \u2212 2\u03bbB e ).\ne (\u03bb) of the scattering\nObserve that for k, m \u2208 {1, . . . , n} the matrix element Skm\nmatrix is obtained from the resolvent kernel as\n\u221a\n\u0001\ne\nSkm\n(\u03bb) = 2\u03bb lim r\u03bbe (\u03be, \u03b7) \u2212 r\u03bb (\u03be, \u03b7) ,\n\u03be, \u03b7\u2192v\n\n\f20\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nwhere the limit on the right hand side is taken in such a way that \u03be, \u03b7 converge to v\ne (\u03bb) in turn fixes the data w and \u03b2, e.g., via\nalong the edges lk , lm respectively. Skm\nm\nthe behavior for large \u03bb, that is from the behavior at \"large energies\"\n\u0001\n1\ne\nwm = \u03b4km + lim\nSkm\n(\u03bb0 ) , for all k \u2208 {1, 2, . . . , n},\n0\n\u03bb \u2191\u221e\n2\nand\n\u0011\n\u221a \u0010 \u03b4km + lim\u03bb0 \u2191\u221e S e (\u03bb0 )\nkm\n\u03b2 = 2\u03bb\n\u2212\n1\n, for all \u03bb, and all k, m \u2208 {1, 2, . . . , n}.\ne (\u03bb)\n\u03b4km + Smm\nAlternatively, the data can be obtained from the small \u03bb behavior, that is the threshold\nbehavior, of the scattering matrix, since from\n\u0001\n1\nwm\ne\n= lim \u221a\nSkm\n(\u03bb) + \u03b4km\nfor all k \u2208 {1, 2, . . . , n},\n\u03bb\u21930 2 2\u03bb\n\u03b2\nwe obtain\nn\n\u0011\n1 \u0010X e\n\u22121\n\u03b2 = \u221a\nSkm (\u03bb) + 1\nfor all k \u2208 {1, 2, . . . , n},\n2 2\u03bb m=1\nand therefore\nwm\n\n\u0001\ne (\u03bb) + \u03b4\nlim\u03bb\u21930 \u03bb\u22121/2 Skm\nkm\n\u0010P\n\u0011\n=\ne (\u03bb) + 1\nlim\u03bb\u21930 \u03bb\u22121/2\nS\n0\nm km\n\nfor all k, k 0 \u2208 {1, 2, . . . , n}.\n\nFurthermore we remark that in the context of quantum mechanics in the self-adjoint\ncase wk = 1/n, k = 1, . . . , n, the boundary conditions of the elastic Walsh process\nare interpreted as the presence of a \u03b4\u2013potential of strength \u03b2 at the vertex.\nIn order to compute expressions for the transition kernel of the elastic Walsh process, we use the following two inverse Laplace transforms which follow from formulae (5.3.4) and (5.6.12) in [6] (cf. also appendix C in [20]) (\u03bb > 0, t \u2265 0, x \u2265 0):\n\u221a\n\u0010 1\n\u0010 r t \u0011\u0011\n2\u03bb\n\u03b2 \u03b2 2 t/2\nL\u22121\n\u221a\n(3.8)\n\u2212\u2192 \u000f0 (dt) \u2212 \u03b2 \u221a\n\u2212 e\nerfc \u03b2\ndt,\n2\n2\n2\u03c0t\n\u03b2 + 2\u03bb\nr \u0011\n\u0010 x\n\u221a\n\u22121\n1\n\u03b2\nt\n2\nL\n\u221a e\u2212 2\u03bbx \u2212\u2192 g(t, x) \u2212 e\u03b2x+\u03b2 t/2 erfc \u221a + \u03b2\n(3.9)\n.\n2\n2\n2t\n\u03b2 + 2\u03bb\nThen the inverse Laplace transform of the scattering matrix S e is given by the following measures on R+ :\n1\ndt\nsekm (dt) = (2wm \u2212 \u03b4km ) \u000f0 (dt) \u2212 2wm \u03b2 \u221a\n2\u03c0t\n(3.10)\n\u0010 rt\u0011\n2 \u03b2 2 t/2\n+ wm \u03b2 e\nerfc \u03b2\ndt,\n2\nwith k, m \u2208 {1, 2, . . . , n}. Moreover, for t > 0, x \u2265 0, let us introduce\nr \u0011\n\u0010 x\n\u03b2 \u03b2x+\u03b2 2 t/2\nt\n(3.11)\ng\u03b2,0 (t, x) = g(t, x) \u2212 e\nerfc \u221a + \u03b2\n.\n2\n2\n2t\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n21\n\nLemma 3.7. For t > 0, \u03be, \u03b7 \u2208 G, the transition density pe of the elastic Walsh process\nis given by\nn\nX\n\u0001\ne\nD\n(3.12)\np (t, \u03be, \u03b7) = p (t, \u03be, \u03b7) +\n1lk (\u03be) 2wm g\u03b2,0 t, dv (\u03be, \u03b7) 1lm (\u03b7),\nk,m=1\n\nand alternatively by\ne\n\np (t, \u03be, \u03b7) = p(t, \u03be, \u03b7) +\n(3.13)\n\nn\nX\n\n1lk (\u03be)\n\n\u0010Z\n\nt\n\nP\u03be (Hvw \u2208 ds)\n\n0\n\nk,m=1\n\n\u0010\n\u0011\n\u0001\u0011\n\u00d7 sekm \u2217 g *, d(v, \u03b7) (t \u2212 s) 1lm (\u03b7),\nwhere \u2217 denotes convolution.\n4. T HE WALSH P ROCESS WITH A S TICKY V ERTEX\nIn this section we construct Brownian motions on G with a = 0 in the boundary\ncondition (1.1).\nConsider the Walsh process W on G from section 2 together with a right continuous, complete filtration F w , relative to which it is strongly Markovian. Furthermore,\nwe denote its local time at the vertex v by Lw (cf. section 3).\nAgain we follow closely the recipe given by It\u00f4 and McKean in [14] (cf. also [18,\nSection 6.2]) for the case of a Brownian motion on the half line. For \u03b3 \u2265 0 introduce\na new time scale \u03c4 by\n(4.1)\n\n\u03c4 \u22121 : t 7\u2192 t + \u03b3Lw\nt ,\n\nt \u2265 0.\n\nSince Lw is non-decreasing, \u03c4 \u22121 is strictly increasing. Moreover, we have \u03c4 \u22121 (0) =\n0 and limt\u2192+\u221e \u03c4 \u22121 (t) = +\u221e, which implies that \u03c4 exists, and is strictly increasing\nfrom R+ onto R+ , too. As is shown in [18, p. 160], the additivity of Lw entails the\nadditivity of \u03c4 on its own time scale, i.e.:\nLemma 4.1. For all s, t \u2265 0, a.s. the following formula holds true\n(4.2)\n\n\u03c4 (s + t) = \u03c4 (s) + \u03c4 (t) \u25e6 \u03b8\u03c4 (s) .\n\nIt is easily checked that for every t \u2265 0, \u03c4 (t) is an F w \u2013stopping time, and since \u03c4\nis increasing, we obtain the subfiltration F s = (Fts , t \u2265 0) of F w defined by Fts =\nw = \u03c3(F w , t \u2208 R ) and F s = \u03c3(F s , t \u2208 R ),\nF\u03c4w(t) , t \u2208 R+ . Moreover, we set F\u221e\n+\n+\nt\n\u221e\nt\ns\nw\nand find F\u221e \u2282 F\u221e . Standard calculations show that the completeness and the right\ncontinuity of F w entail the same properties for F s . (For details of the argument in\nthe case where G = R+ we refer the interested reader to section 3 of [20].)\nDefine a stochastic process W s on G, called Walsh process with sticky vertex, by\n(4.3)\n\nWts = W\u03c4 (t) ,\n\nt \u2208 R+ .\n\nObserve that when W is away from the vertex, Lw is constant, and therefore in this\ncase \u03c4 \u22121 grows with rate 1. On the other hand, when W is at the vertex, \u03c4 \u22121 grows\nfaster than with rate 1, and therefore \u03c4 increases slower than the deterministic time\n\n\f22\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nscale t 7\u2192 t. Thus W s \"experiences a slow down in time\" until W has left the vertex.\nIn this heuristic sense the vertex is \"sticky\" for W s , because it spends more time there\nthan W .\nNote that because Lw has continuous paths, \u03c4 \u22121 and therefore also \u03c4 are pathwise\ncontinuous. Consequently, W s has continuous sample paths. Since W has continuous paths, it is a measurable process, and hence for every t \u2265 0, W\u03c4 (t) is F\u03c4w(t) \u2013\nmeasurable, that is, W s is F s \u2013adapted. Set \u03b8ts = \u03b8\u03c4 (t) . With the additivity (4.2) of \u03c4\nwe immediately find\n(4.4)\n\ns\nWss \u25e6 \u03b8ts = Ws+t\n,\n\ns, t \u2208 R+ .\n\nThus \u03b8s = (\u03b8ts , t \u2208 R+ ) is a family of shift operators for W s .\nNext we show the strong Markov property of W s relative to F s following the\nargument sketched briefly in section 6.2 of [18] for the case G = R+ . First we prove\nthe simple Markov property of W s with respect to F s . To this end, let s, t \u2265 0,\n\u03be \u2208 G, and C \u2208 B(G). Then we get with (4.4)\n\u0001\n\u0001\ns\nP\u03be Wt+s\n\u2208 C Fts = P\u03be Wss \u25e6 \u03b8ts \u2208 C Fts\n\u0001\n= P\u03be W\u03c4 (s) \u25e6 \u03b8\u03c4 (t) \u2208 C F\u03c4w(t)\n\u0001\n= PW\u03c4 (t) W\u03c4 (s) \u2208 C\n\u0001\n= PWts Wss \u2208 C ,\nwhere we used the strong Markov property of W with respect to F w . As a next\nstep we prove that W s has the strong Markov property for its hitting time Hvs of the\nvertex. By construction, W s and W have the same paths up to the hitting time of\nthe vertex, and in particular Hvs is also the hitting time of the vertex by W , that is,\nHvs = Hv . Moreover, since Lw (Hv ) = 0, we get that \u03c4 \u22121 (Hv ) = Hv = \u03c4 (Hv ), as\nwell as \u03b8s (Hv ) = \u03b8(Hv ). Assume now that t \u2265 0, \u03be \u2208 G, and C \u2208 B(G). Then on\n{Hv < +\u221e} we can compute with the strong Markov property of W as follows\n\u0001\n\u0001\ns\nw\ns\nw\nP\u03be Wt+H\n\u2208 C FH\n= P\u03be Wts \u25e6 \u03b8H\n\u2208 C FH\nv\nv\nv\nv\n\u0001\nw\n= P\u03be W\u03c4 (t) \u25e6 \u03b8Hv \u2208 C FH\nv\n\u0001\n= Pv W\u03c4 (t) \u2208 C\n\u0001\n= Pv Wts \u2208 C .\ns \u2282 F w , and therefore we get in particular the strong\nIt is readily checked that FH\nHv\nv\ns\nMarkov property of W with respect to Hvs = Hv in the form\n\u0001\n\u0001\ns\ns\n(4.5)\nP\u03be Wt+H\n= Pv Wts \u2208 C .\ns \u2208 C FH\nv\nv\n\nFinally, with the strong Markov property of the standard one-dimensional Brownian\nmotions on every edge and the strong Markov property (4.5) just proved we can apply\nthe arguments of the proof of theorem I.4.3 to conclude that W s is a Feller process.\nHence it is strongly Markovian relative to the filtration F s .\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n23\n\nBy construction, W s is up to time Hvs equivalent to a standard one-dimensional\nBrownian motion, and it has continuous sample paths. Hence, altogether we have\nshown that W s is a Brownian motion on G in the sense of definition I.3.1.\nNow we want to compute the generator of W s , and first we argue that v is not\na trap for W s . To this end, we may consider W as constructed from a standard\nBrownian motion B as described in section 2. Let Z denote the zero set of B. Given\ns \u2265 0 we can choose t0 \u2265 s in the complement Z c of Z. Consider t = \u03c4 \u22121 (t0 ),\nc\ni.e., t = t0 + \u03b3Lw\nt0 . Obviously t \u2265 s, and \u03c4 (t) \u2208 Z . Therefore B\u03c4 (t) 6= 0, and\ns\nconsequently Wt = W\u03c4 (t) 6= v.\nTheorem 4.2. Consider the boundary condition (1.1) with a = 0, c \u2208 (0, 1), and\nb \u2208 [0, 1]n . Set\n(4.6)\n\nwk =\n\nbk\n, k = 1, . . . , n,\n1\u2212c\n\n\u03b3=\n\nc\n,\n1\u2212c\n\nand let W s be the sticky Walsh process as constructed above with these parameters.\nThen the generator As of W s is 1/2 times the second derivative on G with domain\nconsisting of those f \u2208 C02 (G) which satisfy condition (1.1b).\nBefore we prove theorem 4.2 we first prepare two preliminary results. Let \u000f > 0,\ns denote the hitting time of the complement of the open ball B (v) with\nand let Hv,\u000f\n\u000f\nw denotes the corresponding first hitting\nradius \u000f and center v by W s . Recall that Hv,\u000f\ntime for the Walsh process W .\nLemma 4.3. Pv \u2013a.s., the formula\ns\nw\nHv,\u000f\n= Hv,\u000f\n+ \u03b3 Lw\nw\nHv,\u000f\n\n(4.7)\nholds true.\n\nProof. Let W , and therefore also W s , start in the vertex v. Since W s and W have\ncontinuous paths with infinite lifetime we have for all \u03b3 \u2265 0\n\b\ns\nHv,\u000f\n= inf t > 0, d(v, W\u03c4 (t) ) = \u000f ,\nand in particular for \u03b3 = 0,\n\b\nw\nHv,\u000f\n= inf t > 0, d(v, Wt ) = \u000f .\nMoreover, as argued above, both infima are a.s. finite. Set\nw\n\u03c3 = Hv,\u000f\n+ \u03b3 Lw\nw .\nHv,\u000f\nw , and therefore\nThen \u03c4 (\u03c3) = Hv,\u000f\n\n\u0001\n\u0001\nd v, W\u03c3s = d v, W\u03c4 (\u03c3)\n\u0001\nw\n= d v, WHv,\u000f\n= \u000f.\n\n\f24\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\ns \u2264 \u03c3. To derive the converse inequality we remark that\nConsequently we get Hv,\u000f\n\u0001\n\u000f = d v, WHs v,\u000f\ns\n\u0001\ns ) ,\n= d v, W\u03c4 (Hv,\u000f\n\nwhich implies\n\u0001\ns\nw\n\u03c4 Hv,\u000f\n\u2265 Hv,\u000f\n.\nSince \u03c4 is strictly increasing this entails\n\u0001\ns\nw\nHv,\u000f\n\u2265 \u03c4 \u22121 Hv,\u000f\n= \u03c3,\n\u0003\n\nand the proof is finished.\nCorollary 4.4. For every \u03b3 \u2265 0,\n(4.8)\n\n\u0001\ns\nEv Hv,\u000f\n= \u000f2 + \u03b3\u000f\n\nholds.\nProof. By construction, the paths of W starting in v hit the complement of B\u000f (v)\nexactly when the underlying standard Brownian motion B (cf. section 2) starting at\nw ) has\nthe origin hits one of the points \u00b1\u000f on the real line. Thus under Pv , Lw (Hv,\u000f\nB\nB\nthe same law as L (H{\u2212\u000f,\u000f} ) under P0 . Lemma 1.3 states that under P0 this random\nvariable is exponentially distributed with mean \u000f. Then equation (4.8) follows directly\nfrom lemmas 4.3, and 2.1.\n\u0003\nGiven these results, we come to the\nProof of theorem 4.2. Let wk , k = 1, . . . , n, and \u03b3 be defined as in (4.6), and note\nthat due to theP\ncondition (1.1a) on bk , k = 1, . . . , n, and c, we have wk \u2208 [0, 1],\nk = 1, . . . , n, k wk = 1, as well as \u03b3 > 0. Hence we can construct the associated\nsticky Walsh process W s as above.\nLet As denote the generator of W s with domain D(As ). Then we have for f \u2208\nD(As ), As f (v) = 1/2f 00 (v) (cf. lemma I.5.2). On the other hand, we can compute\nAs f (v) via Dynkin's formula as follows\n\u0010\n\u0001\u0011\ns )\nEv f W s (Hv,\u000f\n\u2212 f (v)\n\u0001\nAs f (v) = lim\ns\n\u000f\u21930\nEv Hv,\u000f\nP\nwk fk (\u000f) \u2212 f (v)\n= lim k 2\n,\n\u000f\u21930\n\u000f + \u03b3\u000f\nwhere we used corollary 4.4. Since the directional derivatives of f at v\nf (a) \u2212 f (v)\nf 0 (vk ) = lim\n,\nk \u2208 {1, 2, . . . , n},\na\u2192v, a\u2208lk\nd(a, v)\nexist (cf. section I.5), we obviously get the boundary condition\nn\n1 00\n1 X\n(4.9)\nf (v) =\nwk f 0 (vk )\n2\n\u03b3\nk=1\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n25\n\nas a necessary condition. Finally, inserting of the values (4.6) of the parameters wk ,\nk = 1, . . . , n, and \u03b3 into equation (4.9) we complete the proof of theorem 4.2.\n\u0003\nNext we shall compute the resolvent Rs of the Walsh process with sticky vertex.\nSimilarly to the alternative proof of theorem 3.2 for the elastic Walsh process, as a\nbyproduct we obtain an alternative proof of theorem 4.2. We begin with the following\nLemma 4.5. Let \u03bb > 0, f \u2208 C0 (G). Then\n\u0011\n\u0010\n\u221a\n1 s \u000100\n1\nR\u03bb f (v) = \u221a\n2\u03bbf\n(v)\n(4.10)\n2\u03bb (ew\n,\nf\n)\n\u2212\n\u03bb\n2\n2\u03bb + \u03b3\u03bb\nholds, where\new\n\u03bb (\u03be) = wk e\u03bb (\u03be),\n\n(4.11)\n\n\u03be \u2208 lk , k = 1, . . . , n,\n\nand e\u03bb is defined in equation (1.15).\nProof. Let As be the generator of W s on C0 (G). From the identity As R\u03bbs = \u03bb R\u03bbs \u2212id,\nand the definition of \u03c4 we get\n\u0010Z \u221e\n\u0001 \u0011\n\u000100\n1\ns\ne\u2212\u03bbt f (Wts ) \u2212 f (v) dt\nR\u03bb f (v) = \u03bbEv\n2\n0\n\u0010Z \u221e\n\u0011\n\u0001\nw\n= \u03bbEv\ne\u2212\u03bb(s+\u03b3Ls ) f (Ws ) \u2212 f (v) (ds + \u03b3dLw\n)\ns\n0\nZ\n\u0010 \u221e\n\u0001 \u0011\nw\n= \u03bbEv\ne\u2212\u03bb(s+\u03b3Ls ) f (Ws ) \u2212 f (v) ds .\n0\n\nIn the last equality we used the fact that Lw only grows when W is at the vertex v.\nBy construction of the Walsh process W we have\n\u0010\n\u0001\u0011\nw\nEv e\u2212\u03bb\u03b3Ls f (Ws ) \u2212 f (v)\n=\n\nn\nX\n\n\u0010\n\u0001\u0011\nB\nwk E0 e\u2212\u03bb\u03b3Ls fk (|Bs |) \u2212 fk (0)\n\nk=1\nn\nX\n\n=2\n\nk=1\n\nZ\n\n\u221eZ \u221e\n\nwk\n0\n\n0\n\n\u0001 x + y \u2212(x+y)2 /2s\ne\u2212\u03bb\u03b3y fk (x) \u2212 fk (0) \u221a\ne\ndx dy,\n2\u03c0s3\n\nwhere we used lemma 1.1. We insert the last expression above, and use formula (1.31).\nThis gives\nZ \u221e \u221a\nn\nX\n\u000100\n\u0001\n1\n1\nR\u03bbs f (v) = 2\u03bb\nwk \u221a\ne\u2212 2\u03bbx fk (x) \u2212 fk (0) dx\n2\n2\u03bb + \u03b3\u03bb 0\nk=1\n\u221a\n\u0001\n1\n=\u221a\n2\u03bb (ew\n\u0003\n\u03bb , f ) \u2212 2\u03bbf (v) .\n2\u03bb + \u03b3\u03bb\nFrom the identity As R\u03bbs = \u03bb R\u03bbs \u2212 id and some simple algebra we get the\n\n\f26\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nCorollary 4.6. Let \u03bb > 0, and f \u2208 C0 (G). Then\nR\u03bbs f (v) = \u221a\n\n(4.12)\n\n\u0001\n1\n2 (ew\n\u03bb , f ) + \u03b3f (v)\n2\u03bb + \u03b3\u03bb\n\nholds.\nSince formula (1.27) in corollary 1.5 is valid for the resolvent of every Brownian\nmotion on G, we may use that formula for R\u03bbs f , sum it against the weights wk , k =\n1, . . . , n, and insert the right hand side of equation (4.12). This results in\nn\nX\n\n\u00010\nwk R\u03bbs f (vk ) = \u03b3 \u221a\n\nk=1\n\n\u221a\n\u0001\n1\n2\u03bb (ew\n\u03bb , f ) \u2212 2\u03bbf (v) ,\n2\u03bb + \u03b3\u03bb\n\nand a comparison with formula (4.10) shows that equation (4.9) holds true for f replaced by R\u03bbs f for arbitrary f \u2208 C0 (G). As promised we thus have another proof of\ntheorem 4.2.\nWith the help of the first passage time formula we can now provide explicit expressions for the resolvent Rs , its kernel rs and the transition kernel ps of W s . Inserting\nthe right hand side of equation (4.12) into the first passage time formula (1.26), we\nimmediately obtain for f \u2208 C0 (G), \u03bb > 0,\n\u0001\n1\ne\u03bb (\u03be) 2 (ew\n\u03be \u2208 G,\n(4.13)\nR\u03bbs f (\u03be) = R\u03bbD f (\u03be) + \u221a\n\u03bb , f ) + \u03b3f (v) ,\n2\u03bb + \u03b3\u03bb\nwhere RD is the Dirichlet resolvent (1.22). Using formula (1.23) for the kernel of RD\ntogether with (1.26), and (1.27), we get the following result.\nCorollary 4.7. For \u03be, \u03b7 \u2208 G, \u03bb > 0, the resolvent kernel r\u03bbs , of the Walsh process\nwith sticky vertex is given by\nr\u03bbs (\u03be, d\u03b7) = r\u03bbD (\u03be, \u03b7) d\u03b7 +\n\nn\nX\nk,m=1\n\n(4.14)\n\n1\ne\u03bb,m (\u03b7) d\u03b7\n2\u03bb + \u03b3\u03bb\n\u03b3\n+\u221a\ne\u03bb (\u03be) \u000fv (d\u03b7),\n2\u03bb + \u03b3\u03bb\n\ne\u03bb,k (\u03be) 2wm \u221a\n\nwith r\u03bbD defined in (1.23), and \u000fv denotes the Dirac measure in v. Alternatively, r\u03bbs is\ngiven by\nr\u03bbs (\u03be, d\u03b7) = r\u03bb (\u03be, \u03b7) d\u03b7 +\n(4.15a)\n\nn\nX\n\n1\ns\n(\u03bb) \u221a e\u03bb,m (\u03b7) d\u03b7\ne\u03bb,k (\u03be) Skm\n2\u03bb\nk,m=1\n\u03b3\n+\u221a\ne\u03bb (\u03be) \u000fv (d\u03b7),\n2\u03bb + \u03b3\u03bb\n\nwhere r\u03bb is defined in equation (1.24), and\n\u221a\n2\u03bb\ns\n(4.15b)\nSkm (\u03bb) = 2 \u221a\nwm \u2212 \u03b4km .\n2\u03bb + \u03b3\u03bb\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n27\n\nRemark 4.8. When all wm , m = 1, . . . , n, are equal to 1/n, the matrix S s (\u03bb) takes\nthe form\n\u221a\n2 2\u03bb\ns\nPn\nS (\u03bb) = \u22121 + \u221a\n2\u03bb + \u03b3\u03bb\nwhich reduces to (2.9) when \u03b3 = 0. S s (\u03bb) is unitary for all \u03bb < 0. Also the S s (\u03bb)\nfor different \u03bb all commute. As a consequence S s (\u03bb) has the interpretation of a\nquantum scattering matrix in the sense of [23]. More precisely, S s (\u03bb) stems from\nthe Schr\u00f6dinger operator \u2212\u2206s , where \u2206s is a self-adjoint Laplace operator on L2 (G)\nwith boundary conditions of the form (2.5) with the choice\n\u0001\n1\nA = \u2212 S s (\u03bb0 ) + 1 ,\n2\n(4.16)\n\u0001\n1\nS s (\u03bb0 ) \u2212 1 ,\nB=\u2212 p\n2 2\u03bb0\n\u221a\nfor any \u03bb0 for which 2\u03bb0 + \u03b3\u03bb0 6= 0. We emphasize that the Schr\u00f6dinger operator\n\u2212\u2206s and the generator As of the Walsh process are quite different: Not only do\nthey act on different Banach spaces, but also the functions in the intersection of their\ndomains satisfy different boundary conditions at the vertex v. As matter of fact, the\nintegral kernel of the resolvent (\u2212\u2206s + 2\u03bb)\u22121 of the Schr\u00f6dinger operator \u2212\u2206s is\ngiven by, see Lemma 4.2 in [24],\nn\n\u0011\nX\n1\n1\u0010\ns\nr\u03bb (\u03be, \u03b7) +\ne\u03bb,k (\u03be) Skm\n(\u03bb) \u221a e\u03bb,m (\u03b7) ,\n2\n2\u03bb\nk,m=1\nthat is - up to a factor 2 - by the right hand side of (4.15a) without the last term.\nIn more detail and with the definition (2.6)\n\u0001\nSA,B E = \u22122\u03bb = S s (\u03bb)\nholds for all \u03bb > 0. As a function of k (k 2 = E), S s is meromorphic in the complex\nk\u2013plane with a pole on the positive imaginary axis at k b = 2i/\u03b3. This corresponds\nto a negative eigenvalue E b = \u22124/\u03b3 2 of \u2212\u2206s . The corresponding (normalized)\neigenfunction \u03c8 b - physically speaking a bound state - is given as\nr\n1 \u03b3 \u22122d(v,\u03be)/\u03b3\nb\n\u03c8 (\u03be) =\ne\n,\n\u03be \u2208 G.\n2 n\nSo quantum mechanically the vertex v acts like an attractive potential. We view this\nas a quantum analogue of the stickyness of the vertex v.\nThis analogy can be elaborated a bit further by inspecting the associated quantum\nmechanical time delay matrix (see, e.g., [1, 4, 16, 25\u201327, 32])\n1\n\u2202\nT (k) =\nS(k)\u22121 S(k)\n2ik\n\u2202k\nwhich in the present context gives\n\u22122\u03b3\nT (k) =\nPn .\nk(4 + k 2 \u03b3 2 )\n\n\f28\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nSo T (k) has zero as an (n \u2212 1)\u2013fold eigenvalue plus the non-degenerate eigenvalue\n\u22122\u03b3\n,\nk(4 + k 2 \u03b3 2 )\nwhich for \u03b3 > 0 is the signal for a strict quantum delay. Observe that for k \u2192 +\u221e,\nthat is for large energies, the time delay experienced by the quantum particle tends to\nzero, while for k \u2192 0, i.e., for low energies, the delay becomes arbitrarily large. From\nthe physical point of view, both effects are clearly to be expected. For comparison\nand in contrast to the present stochastic context, in quantum mechanics \u03b3 < 0 is also\nallowed for a meaningful Schr\u00f6dinger operator and an associated scattering matrix.\nDefine for x \u2265 0, \u03b3, t > 0,\n\n\u221a \u0011\n\u0010 2x\n\u0010 x\n2t \u0011\n2t\n1\n+ 2 erfc \u221a +\n.\n(4.17)\ng0,\u03b3 (t, x) = exp\n\u03b3\n\u03b3\n\u03b3\n\u03b3\n2t\nIt is not hard to check that\n1\n2\n(4.18)\nlim g0,\u03b3 (t, x) = g(t, x) = \u221a\ne\u2212x /2t .\n\u03b3\u21930\n2\u03c0t\nMoreover, from [6, eq. 5.6.16] (cf. also appendix C in [20]) the Laplace transform is\n\u221a\n1\n(4.19)\nLg0,\u03b3 ( * , x)(\u03bb) = \u221a\ne\u2212 2\u03bbx ,\nx \u2265 0.\n2\u03bb + \u03b3\u03bb\nObserve that in agreement with (4.18)\n\u221a\n1\nLg( * , x)(\u03bb) = \u221a e\u2212 2\u03bbx\n2\u03bb\nholds. Now we can readily compute the inverse Laplace transform of formulae (4.14),\n(4.15), and obtain the following result.\nCorollary 4.9. For t > 0, \u03be, \u03b7 \u2208 G the transition kernel of the Walsh process with\nsticky vertex is given by\nps (t, \u03be, \u03b7) = pD (t, \u03be, \u03b7) d\u03b7\n(4.20)\n\n+\n\nn\nX\n\n\u0001\n1lk (\u03be) 2wm g0,\u03b3 t, dv (\u03be, \u03b7) 1lm (\u03b7) d\u03b7\n\nk,m=1\n\n\u0001\n+ \u03b3 g0,\u03b3 t, d(\u03be, v) \u000fv (d\u03b7)\nwhere pD is defined in equation (1.21), or alternatively by\nps (t, \u03be, d\u03b7) = p(t, \u03be, \u03b7) d\u03b7\nn\n\u0010\nX\n\u0001\n+\n1lk (\u03be) 2wm g0,\u03b3 t, dv (\u03be, \u03b7) d\u03b7\nk,m=1\n(4.21)\n\u0001 \u0011\n\u2212 \u03b4km g t, dv (\u03be, \u03b7) d\u03b7 1lm (\u03b7)\n\u0001\n+ \u03b3 g0,\u03b3 t, d(\u03be, v) \u000fv (d\u03b7),\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n29\n\nand p(t, a, b) is given in formula (1.17).\nWe close this section with some remarks concerning the local time of W s at the\nvertex v, which also serve to prepare the construction of the most general Brownian\nmotion on the single vertex graph G in the next section.\nLet us define\n(4.22)\n\nLst = Lw\n\u03c4 (t) ,\n\nt \u2265 0,\n\nwhere - as before - Lw denotes the local time of the Walsh process at the vertex,\nhaving (cf. section 3) the same normalization as the local time of a standard onedimensional Brownian motion (cf. (1.8)). By construction, Ls is pathwise continuous\nand non-decreasing. It is adapted to F s , and a straightforward calculation based on\nthe additivity of Lw and formula (4.2) shows the (pathwise) additivity property\n(4.23)\nLs\n\nLss+t = Lst + Lss \u25e6 \u03b8ts ,\n\ns, t \u2265 0.\n\n(W s , F s ).\n\nThus\nis a PCHAF of\nFurthermore, t \u2265 0 is a point of increase for Ls\nif only if \u03c4 (t) is a point of increase for Lw , which only is the case if W\u03c4 (t) is at the\nvertex, i.e., if Wts is at the vertex. Thus, it follows that Ls is a local time at the vertex\nfor W s . In order to completely identify it, it remains to compute its normalization,\nand it is not very hard to compute its \u03b1\u2013potential (the interested reader can find the\ndetails for the case G = R+ in [20]):\n\u0010Z \u221e\n\u0011\n\u221a\n1\n(4.24)\nE\u03be\ne\u2212\u03b1t dLst = \u221a\ne\u2212 2\u03b1 d(\u03be,v) ,\n\u03b1 > 0, \u03be \u2208 G.\n2\u03b1 + \u03b3\u03b1\n0\n5. T HE G ENERAL B ROWNIAN M OTION ON A S INGLE V ERTEX G RAPH\nFinally, in this subsection we construct a Brownian motion W g by killing the Walsh\nprocess with sticky vertex of section 4 in a similar way as in the construction of the\nelastic Walsh process (cf. section 3). W g realizes the boundary condition (1.1) in its\nmost general form.\nConsider the sticky Walsh process W s with stickiness parameter \u03b3 > 0, right\ncontinuous and complete filtration F s , and local time Ls at the vertex. We argued\nin section 4 that Ls is a PCHAF for (W s , F s ), and therefore we can apply the\nmethod of killing described in section 1.5: We bring in the additional probability\nspace (R+ , B(R+ ), P\u03b2 ) where P\u03b2 is the exponential law of rate \u03b2 > 0, and the\ncanonical coordinate\u0001 random variable S. Then\n\u0001 we take the family of product spaces\n\u03a9\u0302, \u00c2, (P\u0302\u03be , \u03be \u2208 G) of \u03a9, A, (P\u03be , \u03be \u2208 G) and (R+ , B(R+ ), P\u03b2 ). Define the random time\n\b\n(5.1)\n\u03b6\u03b2,\u03b3 = inf t \u2265 0, Lst > S .\nThen by the arguments given in section 1.5, the stochastic process W g defined by\nWtg = Wts for t \u2208 [0, \u03b6\u03b2,\u03b3 ), and Wtg = \u2206 for t \u2265 \u03b6\u03b2,\u03b3 , is again a Brownian motion\non G in the sense of definition I.3.1.\nDenote by K s the right continuous pseudo-inverse of Ls . Since Ls is continuous\n(cf. equation (4.22)), we get LsKrs = r for all r \u2208 R+ . Recall that the right continuous\n\n\f30\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\npseudo-inverse of the local time Lw of the Walsh process was denoted by K w . Then\nwe have the following\nLemma 5.1. For all \u03b3 \u2265 0, the following relation holds true:\n(5.2)\n\nKrs = Krw + \u03b3r,\n\nr \u2208 R+ .\n\nProof. For \u03b3, r \u2208 R+ define the random subset\nJ\u03b3 (r) = {t \u2265 0, Lst > r}\nof R+ . Since Ls is pathwise increasing, this set is a random interval with endpoints\nKrs and +\u221e. The relation LsKrs = r implies that\nJ\u03b3 (r) = (Krs , +\u221e).\nIn particular, we have J0 = (Krw , +\u221e). Now\nt \u2208 J\u03b3 (r) \u21d4 Lst = Lw\n\u03c4 (t) > r \u21d4 \u03c4 (t) \u2208 J0 (r).\nIn other words, J\u03b3 (r) = \u03c4 \u22121 J0 (r)), and therefore Krs = \u03c4 \u22121 (Krw ) holds. From\nthe definition of \u03c4 \u22121 (see equation (4.1)), and the relation LsKrs = r we obtain formula (5.2)\n\u0003\nIn the proof of lemma 3.4 the Laplace\u221atransform of the density of Krw , r \u2265 0, under\nPv has been determined as \u03bb 7\u2192 exp(\u2212 2\u03bbr). Hence we have\nr\n2\nPv (Krw \u2208 dl) = \u221a\ne\u2212r /2l dl,\nl \u2265 0.\n2\u03c0l3\nAs a consequence we find the\nCorollary 5.2. For r \u2265 0, Krs has the density\nr\n2\n(5.3)\nPv (Krs \u2208 dl) = p\ne\u2212r /2(l\u2212\u03b3r) dl,\n3\n2\u03c0(l \u2212 \u03b3r)\n\nl \u2265 \u03b3r.\n\nFurthermore, the Laplace transform of the density of Krs under Pv is given by\n\u221a\ns\u0001\n(5.4)\nEv e\u2212\u03bbKr = e\u2212( 2\u03bb+\u03bb\u03b3)r ,\n\u03bb > 0.\nRemark 5.3. One can use lemma C.1 in [20] to check that the right hand side of\nequation (5.3) is indeed the inverse Laplace transform of the right hand side of formula (5.4).\nObserve that \u03b6\u03b2,\u03b3 = KSs and \u03b6\u03b2,0 = KSw . Thus we obtain the\nCorollary 5.4. For all \u03b2 > 0, \u03b3 \u2265 0, the following equation holds true\n(5.5)\n\n\u03b6\u03b2,\u03b3 = \u03b6\u03b2,0 + \u03b3S.\n\nAs before, \u00ca\u03be denotes the expectation with respect to P\u0302\u03be , \u03be \u2208 G.\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n31\n\nCorollary 5.5. For all \u03b2 > 0, \u03b3 \u2265 0, \u03bb > 0, the following formula holds true\n\u0001\n(5.6a)\n\u00cav e\u2212\u03bb\u03b6\u03b2,\u03b3 = \u03b2\u03c1(\u03bb),\nwith\n\u03c1(\u03bb) =\n\n(5.6b)\n\n\u03b2+\n\n\u221a\n\n1\n.\n2\u03bb + \u03b3\u03bb\n\nProof. With corollary 5.2 and \u03b6\u03b2,\u03b3 = KSs we obtain\nZ \u221e\n\u0001\ns\u0001\n\u2212\u03bb\u03b6\u03b2,\u03b3\nEv e\u2212\u03bbKr e\u2212\u03b2r dr\n=\u03b2\n\u00cav e\n0\n\n=\n\n\u03b2+\n\n\u221a\n\n\u03b2\n.\n2\u03bb + \u03b3\u03bb\n\n\u0003\n\nDenote by Rg the resolvent of W g . With lemma 1.6 we immediately find the\nCorollary 5.6. For all f \u2208 C0 (G), \u03bb > 0, \u03be \u2208 G the following formula holds true:\nR\u03bbg f (\u03be) = R\u03bbs f (\u03be) \u2212 \u03b2\u03c1(\u03bb) e\u03bb (\u03be) R\u03bbs f (v).\n\n(5.7)\n\nNow it is easy to verify that for appropriately chosen parameters \u03b2, \u03b3, wk , k =\n1, . . . , n, the Brownian motion Wg realizes the boundary condition (1.1b).\nTheorem 5.7. Consider the boundary condition (1.1), and assume that b is not the\nnull vector. Set r = a + c \u2208 (0, 1), and\n(5.8)\n\nwk =\n\nbk\n, k = 1, . . . , n,\n1\u2212r\n\n\u03b2=\n\na\n,\n1\u2212r\n\n\u03b3=\n\nc\n.\n1\u2212r\n\nLet W g be the Brownian motion as constructed above with these parameters. Then the\ngenerator Ag of W g is 1/2 times the Laplacean on G with domain D(Ag ) consisting\nof those f \u2208 C02 (G) which satisfy condition (1.1b).\nProof. As in the previous cases it is readily seen that the definition (5.8) of the parameters \u03b3, \u03b2, wk , k = 1, . . . , n, is consistent with the conditions used in the above\nconstruction of W g .\nLet Ag be the generator of W g with domain D(Ag ). Since W g is a Brownian\nmotion on G in the sense of definition I.3.1, it follows from lemma I.5.2 that D(Ag ) \u2282\nC02 (G), and that for all f \u2208 D(Ag ), Ag f (\u03be) = 1/2 f 00 (\u03be), \u03be \u2208 G. Let h \u2208 C0 (G),\n\u03bb > 0. Then R\u03bbg h \u2208 D(Ag ), and therefore we may compute with equation (5.7) as\nfollows\n\u000100\n\u000100\n\u0001\n\u03b3\n\u03b3\nR\u03bbg h (v) =\nR\u03bbs h (v) \u2212 \u03b2 \u03c1(\u03bb) 2\u03bb R\u03bbs h (v)\n2\n2\nn\nX\n\u00010\n\u0001\n=\nwk R\u03bbs h (vk ) \u2212 \u03b2 \u03c1(\u03bb) \u03b3\u03bb R\u03bbs h (v),\nk=1\n\n\f32\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nwhere we used the fact that, since R\u03bbs h is in the domain of the generator As of W s , it\nsatisfies the boundary condition (4.9). We rewrite this equation in the following way:\n\n(5.9)\n\nn\nX\n\u221a\n\u0001\n\u00010\n\u03b3\ng \u000100\nR\u03bb h (v) =\nwk R\u03bbs h (vk ) + \u03b2 2\u03bb \u03c1(\u03bb) R\u03bbs h (v)\n2\nk=1\n\u0011\n\u221a\n\u0001\n\u2212 \u03b2 \u03c1(\u03bb) 2\u03bb + \u03b3\u03bb R\u03bbs h (v).\n\nNow we differentiate equation (5.7) at \u03be \u2208 lk , k = 1, . . . , n, let \u03be tend to v along any\nedge lk , and sum the resulting equation against the weights wk , k = 1, . . . , n. Then\nwe get the following formula\n(5.10)\n\nn\nX\n\n\u00010\nwk R\u03bbg h (vk )\n\nk=1\n\nwhere we used\n(5.11)\n\n=\n\nn\nX\n\n\u221a\n\u0001\n\u00010\nwk R\u03bbs h (vk ) + \u03b2 2\u03bb \u03c1(\u03bb) R\u03bbs h (v),\n\nk=1\n\nP\n\nk\n\nwk = 1. On the other hand, for \u03be = v, equation (5.7) gives\n\u221a\n\u0001\n\u0001\n\u0001\nR\u03bbg h (v) = \u03c1(\u03bb) 2\u03bb + \u03b3\u03bb R\u03bbs h (v).\n\nA comparison of equations (5.10), (5.11) with (5.9) shows that we have proved the\nfollowing formula\n(5.12)\n\nn\nX\n\u000100\n\u0001\n\u00010\n\u03b3\nwk R\u03bbg h (vk ) \u2212 \u03b2 R\u03bbg h (v).\nR\u03bbg h (v) =\n2\nk=1\n\nWith the values (5.8) for \u03b2, \u03b3, and wk , k = 1, . . . , n, it is obvious that f = R\u03bbg h\nsatisfies equation (1.1b). Since R\u03bbg is surjective from C0 (G) onto the domain of the\ngenerator Ag of W g , the proof of the theorem is finished.\n\u0003\nLet \u03bb > 0, f \u2208 C0 (G). Insertion of the right hand side of formula (4.13) for R\u03bbs\ninto equation (5.7) gives us after some simple algebra the following expression for\nR\u03bbg f :\n\u0001\n(5.13)\nR\u03bbg f (\u03be) = R\u03bbD f (\u03be) + \u03c1(\u03bb) e\u03bb (\u03be) 2(ew\n\u03be \u2208 G,\n\u03bb , f ) + \u03b3f (v) ,\nwhere RD is the Dirichlet resolvent, e\u03bb is defined in equation (1.15), ew\n\u03bb in equation (4.11), and \u03c1(\u03bb) is as in formula (5.6b). From equation (5.13) we can read off\nthe following result:\nCorollary 5.8. For \u03be, \u03b7 \u2208 G, \u03bb > 0, the resolvent kernel r\u03bbg of the general Brownian\nmotion W g on G is given by\n\n(5.14)\n\nr\u03bbg (\u03be, d\u03b7) = r\u03bbD (\u03be, \u03b7) d\u03b7 +\n\nn\nX\n\ne\u03bb,k (\u03be) 2wm \u03c1(\u03bb) e\u03bb,m (\u03b7) d\u03b7\n\nk,m=1\n\n+ \u03b3 \u03c1(\u03bb) e\u03bb (\u03be) \u000fv (d\u03b7),\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n33\n\nwith r\u03bbD as in formula (1.23), and \u03c1 is defined in equation (5.6b). Alternatively, r\u03bbg\ncan be written in the following form\n\n(5.15a)\n\nr\u03bbg (\u03be, d\u03b7) = r\u03bb (\u03be, \u03b7) d\u03b7 +\n\nn\nX\n\n1\ng\ne\u03bb,k (\u03be) Skm\n(\u03bb) \u221a e\u03bb,m (\u03b7) d\u03b7\n2\u03bb\nk,m=1\n+ \u03b3 \u03c1(\u03bb) e\u03bb (\u03be) \u000fv (d\u03b7),\n\nwhere r\u03bb is defined in equation (1.24), and\n\u221a\ng\n(5.15b)\nSkm\n(\u03bb) = 2 2\u03bb \u03c1(\u03bb) wm \u2212 \u03b4km .\nIn order to invert the Laplace transforms in equations (5.14), (5.15), we define for\n\u03b2, \u03b3 > 0, the following function g\u03b2,\u03b3 on (0, +\u221e) \u00d7 R+ :\nZ t\n\u0010 (s + \u03b3x)2 \u0011\n1 1\ns + \u03b3x\nexp\n\u2212 2\n(5.16)\ng\u03b2,\u03b3 (t, x) = 2 \u221a\ne\u2212\u03b2s/\u03b3 ds,\n3/2\n\u03b3\n2\u03b3\n(t\n\u2212\ns)\n(t\n\u2212\ns)\n2\u03c0 0\nwith (t, x) \u2208 (0, +\u221e) \u00d7 R+ . The heat kernel g\u03b2,\u03b3 is discussed in more detail in\nappendix C of [20]. In particular, it is outlined there that the limits of g\u03b2,\u03b3 as \u03b2 \u2193\n0, and \u03b3 \u2193 0, yield the kernels g\u03b2,0 (equation (3.11)) and g0,\u03b3 (equation (4.17)),\nrespectively. Moreover, it is proved there that the Laplace transform of g\u03b2,\u03b3 (*, x),\nx \u2265 0, is given by\n\u03c1(\u03bb) e\u2212\n\n(5.17)\n\n\u221a\n\n2\u03bbx\n\n,\n\n\u03bb > 0,\n\nwhere \u03c1 is defined in (5.6b). Hence we get the\nCorollary 5.9. For \u03be, \u03b7 \u2208 G, t > 0, the transition kernel of the general Brownian\nmotion W g on G is given by\npg (t, \u03be, d\u03b7) = pD (t, \u03be, \u03b7) d\u03b7\n+\n\n(5.18)\n\nn\nX\n\n\u0001\n1lk (\u03be) 2wm g\u03b2,\u03b3 t, dv (\u03be, \u03b7) 1lm (\u03b7) d\u03b7\n\nk,m=1\n\n\u0001\n+ \u03b3 g\u03b2,\u03b3 t, d(\u03be, v) \u000fv (d\u03b7),\nwhich alternatively can be written as\npg (t, \u03be, d\u03b7) = p(t, \u03be, \u03b7) d\u03b7\n+\n(5.19)\n\nn\nX\n\n\u0010\n\u0001\n1lk (\u03be) 2wm g\u03b2,\u03b3 t, dv (\u03be, \u03b7)\n\nk,m=1\n\n\u0001\u0011\n\u2212 \u03b4km g t, dv (\u03be, \u03b7) 1lm (\u03b7) d\u03b7\n\u0001\n+ \u03b3 g\u03b2,\u03b3 t, d(\u03be, v) \u000fv (d\u03b7).\n\n\f34\n\nV. KOSTRYKIN, J. POTTHOFF, AND R. SCHRADER\n\nR EFERENCES\n[1] W. Amrein, J.M. Jauch, and K. Sinha, Scattering Theory in Quantum Mechanics, Benjamin, Reading Mass., 1977.\n[2] M. Barlow, J. Pitman, and M. Yor, On Walsh's Brownian motion, S\u00e9minaire de Probabilit\u00e9s XXIII\n(J. Az\u00e8ma, P. A. Meyer, and M. Yor, eds.), Lecture Notes in Mathematics, no. 1372, Springer\u2013\nVerlag, Berlin, Heidelberg, New York, 1989, pp. 275\u2013293.\n[3] R. M. Blumenthal and R. K. Getoor, Markov Processes and Potential Theory, Academic Press,\nNew York and London, 1968.\n[4] R. Brunetti and K. Fredenhagen, Time of occurence observables in quantum mechanics, Phys. Rev.\nA 66 (2002), 044101\u20131\u2013044101\u20133.\n[5] E.B. Dynkin, Markov Processes, vol. 1, Springer-Verlag, Berlin, Heidelberg, New York, 1965.\n[6] A. Erd\u00e9lyi, W. Magnus, F. Oberhettinger, and F. G. Tricomi, Tables of Integral Transforms, vol. I,\nMcGraw-Hill, New York, Toronto, London, 1954.\n[7] W. Feller, Diffusion processes in one dimension, Trans. American Math. Soc. 77 (1954), 1\u201331.\n[8]\n, The general diffusion operator and positivity preserving semi-groups in one dimension,\nAnn. Math. 60 (1954), 417\u2013436.\n[9]\n, On boundaries and lateral conditions for the Kolmogorov differential equations, Ann.\nMath. 65 (1957), 527\u2013570.\n[10]\n, An Introduction to Probability Theory and Its Applications, 2nd ed., vol. 2, Wiley, New\nYork, London, Sydney, 1971.\n[11] T. Hida, Brownian Motion, Applications of Mathematics, no. 11, Springer-Verlag, Berlin, Heidelberg, New York, 1980.\n[12] N. Ikeda and S. Watanabe, Stochastic Differential Equations and Diffusion Processes, 2nd ed.,\nNorth Holland, Amsterdam, Oxford, New York, 1989.\n[13] K. It\u00f4, Poisson point processes attached to Markov processes, Proc. Sixth Berkeley Symp. Math.\nStatist. Probab., vol. 3, University of California Press, 1972.\n[14] K. It\u00f4 and H. P. McKean Jr., Brownian motions on a half line, Illinois J. Math. 7 (1963), 181\u2013231.\n[15]\n, Diffusion Processes and their Sample Paths, 2nd ed., Springer\u2013Verlag, Berlin, Heidelberg, New York, 1974.\n[16] J.M. Jauch, B. Misra, and K.B. Sinha, Time delay in scattering processes, Helv. Phys. Acta 45\n(1972), 398\u2013426.\n[17] I. Karatzas and S. E. Shreve, Brownian Motion and Stochastic Calculus, 2nd ed., Springer-Verlag,\nBerlin, Heidelberg, New York, 1991.\n[18] F.B. Knight, Essentials of Brownian Motion and Diffusion, Mathematical Surveys and Monographs, vol. 18, American Mathematical Society, Providence, Rhode Island, 1981.\n[19] V. Kostrykin, J. Potthoff, and R. Schrader, Contraction Semigroups on Metric Graphs, Analysis\non Graphs and Its Applications (B.M. Brown, P. Exner, P. Kuchment, and T. Sunada, eds.), Proc.\nSymp. Pure Math., vol. 77, 2009, pp. 423\u2013458.\n[20]\n, Brownian motions on metric graphs: Feller Brownian motions on intervals revisited,\narXiv: 1008.3761, August 2010.\n[21]\n, Brownian motions on metric graphs I - Definition, Feller Property, and Generators,\narXiv: 1012.0733, December 2010.\n[22]\n, Brownian motions on metric graphs III - Construction of Brownian motions on general\nmetric graphs, arXiv: 1012.0739, December 2010.\n[23] V. Kostrykin and R. Schrader, Kirchhoff's rule for quantum wires, J. Phys. A: Math. Gen. 32\n(1999), 595\u2013630.\n, Laplacians on metric graphs: Eigenvalues, resolvents and semigroups, Quantum Graphs\n[24]\nand Their Applications (Providence, RI) (G. Berkolaiko, R. Carlson, S.A. Fulling, and P. Kuchment, eds.), Contemp. Math., vol. 415, Amer. Math. Soc., 2006.\n[25] Ph. A. Martin, On the time delay of simple scattering systems, Commun. Math. Phys. 47 (1976),\n221\u2013227.\n\n\fBROWNIAN MOTIONS ON METRIC GRAPHS II\n\n[26]\n[27]\n[28]\n[29]\n[30]\n[31]\n[32]\n[33]\n\n35\n\n, Time delay in quantum scattering processes, New developments in mathematical physics,\nSchladming, 1981, vol. XXIII, 1981, pp. 157\u2013208.\nH. Narnhofer, Another definition of time delay, Phys.Rev.D 22 (1980), 2387\u20132390.\nD. Revuz and M. Yor, Continuous Martingales and Brownian Motion, Springer\u2013Verlag, Berlin,\nHeidelberg, New York, 1999.\nTh. S. Salisbury, Construction of right processes from excursions, Probab. Th. Rel. Fields 73\n(1986), 351\u2013367.\n, On the It\u00f4 excursion process, Probab. Th. Rel. Fields 73 (1986), 319\u2013350.\nJ.B. Walsh, A diffusion with a discontinuous local time, Ast\u00e9risque 52\u201353 (1978), 37\u201345.\nE. P. Wigner, Lower limit for the energy derivative of the scattering phase shift, Phys. Rev. 98\n(1955), 145\u2013147.\nD. Williams, Diffusions, Markov Processes, and Martingales, John Wiley & Sons, Chichester,\nNew York, Brisbane, Toronto, 1979.\n\nVADIM KOSTRYKIN\nI NSTITUT F \u00dcR M ATHEMATIK\nJ OHANNES G UTENBERG \u2013U NIVERSIT \u00c4T\nD\u201355099 M AINZ , G ERMANY\nE-mail address: kostrykin@mathematik.uni-mainz.de\nJ \u00dcRGEN P OTTHOFF\nI NSTITUT F \u00dcR M ATHEMATIK\nU NIVERSIT \u00c4T M ANNHEIM\nD\u201368131 M ANNHEIM , G ERMANY\nE-mail address: potthoff@math.uni-mannheim.de\nROBERT S CHRADER\nI NSTITUT F \u00dcR T HEORETISCHE P HYSIK\nF REIE U NIVERSIT \u00c4T B ERLIN , A RNIMALLEE 14\nD\u201314195 B ERLIN , G ERMANY\nE-mail address: schrader@physik.fu-berlin.de\n\n\f"}