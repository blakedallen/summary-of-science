{"id": "http://arxiv.org/abs/1109.2676v3", "guidislink": true, "updated": "2013-07-03T03:18:59Z", "updated_parsed": [2013, 7, 3, 3, 18, 59, 2, 184, 0], "published": "2011-09-13T05:25:38Z", "published_parsed": [2011, 9, 13, 5, 25, 38, 1, 256, 0], "title": "Dynamic Decentralized Algorithms for Cognitive Radio Relay Networks", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.2844%2C1109.4391%2C1109.0868%2C1109.3359%2C1109.1952%2C1109.1941%2C1109.2311%2C1109.3087%2C1109.0001%2C1109.6840%2C1109.6461%2C1109.4247%2C1109.6723%2C1109.4212%2C1109.5889%2C1109.6533%2C1109.5366%2C1109.1188%2C1109.5573%2C1109.3786%2C1109.1947%2C1109.5128%2C1109.1561%2C1109.6598%2C1109.0514%2C1109.3466%2C1109.4219%2C1109.2100%2C1109.5928%2C1109.6178%2C1109.4474%2C1109.6831%2C1109.1735%2C1109.2796%2C1109.4022%2C1109.3680%2C1109.6206%2C1109.5373%2C1109.2563%2C1109.5218%2C1109.0586%2C1109.0536%2C1109.5738%2C1109.0943%2C1109.0904%2C1109.0069%2C1109.1669%2C1109.2269%2C1109.1144%2C1109.6024%2C1109.0865%2C1109.1883%2C1109.3833%2C1109.4146%2C1109.1384%2C1109.2181%2C1109.5628%2C1109.4516%2C1109.5803%2C1109.3613%2C1109.1325%2C1109.4951%2C1109.2889%2C1109.2676%2C1109.5280%2C1109.4799%2C1109.3004%2C1109.5303%2C1109.3301%2C1109.1507%2C1109.5664%2C1109.0403%2C1109.1046%2C1109.2089%2C1109.3106%2C1109.4720%2C1109.6433%2C1109.0499%2C1109.6836%2C1109.2286%2C1109.2374%2C1109.2325%2C1109.0920%2C1109.1318%2C1109.0767%2C1109.0668%2C1109.1460%2C1109.0157%2C1109.6525%2C1109.1094%2C1109.2585%2C1109.3639%2C1109.1721%2C1109.2978%2C1109.5160%2C1109.6784%2C1109.6860%2C1109.1276%2C1109.6739%2C1109.4284%2C1109.1852&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Dynamic Decentralized Algorithms for Cognitive Radio Relay Networks"}, "summary": "We propose a distributed spectrum access algorithm for cognitive radio relay\nnetworks with multiple primary users (PU) and multiple secondary users (SU).\nThe key idea behind the proposed algorithm is that the PUs negotiate with the\nSUs on both the amount of monetary compensation, and the amount of time the SUs\nare either (i) allowed spectrum access, or (ii) cooperatively relaying the PU's\ndata, such that both the PUs' and the SUs' minimum rate requirement are\nsatisfied. The proposed algorithm is shown to be flexible in prioritizing\neither the primary or the secondary users. We prove that the proposed algorithm\nwill result in the best possible stable matching and is weak Pareto optimal.\nNumerical analysis also reveal that the distributed algorithm can achieve a\nperformance comparable to an optimal centralized solution, but with\nsignificantly less overhead and complexity.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.2844%2C1109.4391%2C1109.0868%2C1109.3359%2C1109.1952%2C1109.1941%2C1109.2311%2C1109.3087%2C1109.0001%2C1109.6840%2C1109.6461%2C1109.4247%2C1109.6723%2C1109.4212%2C1109.5889%2C1109.6533%2C1109.5366%2C1109.1188%2C1109.5573%2C1109.3786%2C1109.1947%2C1109.5128%2C1109.1561%2C1109.6598%2C1109.0514%2C1109.3466%2C1109.4219%2C1109.2100%2C1109.5928%2C1109.6178%2C1109.4474%2C1109.6831%2C1109.1735%2C1109.2796%2C1109.4022%2C1109.3680%2C1109.6206%2C1109.5373%2C1109.2563%2C1109.5218%2C1109.0586%2C1109.0536%2C1109.5738%2C1109.0943%2C1109.0904%2C1109.0069%2C1109.1669%2C1109.2269%2C1109.1144%2C1109.6024%2C1109.0865%2C1109.1883%2C1109.3833%2C1109.4146%2C1109.1384%2C1109.2181%2C1109.5628%2C1109.4516%2C1109.5803%2C1109.3613%2C1109.1325%2C1109.4951%2C1109.2889%2C1109.2676%2C1109.5280%2C1109.4799%2C1109.3004%2C1109.5303%2C1109.3301%2C1109.1507%2C1109.5664%2C1109.0403%2C1109.1046%2C1109.2089%2C1109.3106%2C1109.4720%2C1109.6433%2C1109.0499%2C1109.6836%2C1109.2286%2C1109.2374%2C1109.2325%2C1109.0920%2C1109.1318%2C1109.0767%2C1109.0668%2C1109.1460%2C1109.0157%2C1109.6525%2C1109.1094%2C1109.2585%2C1109.3639%2C1109.1721%2C1109.2978%2C1109.5160%2C1109.6784%2C1109.6860%2C1109.1276%2C1109.6739%2C1109.4284%2C1109.1852&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We propose a distributed spectrum access algorithm for cognitive radio relay\nnetworks with multiple primary users (PU) and multiple secondary users (SU).\nThe key idea behind the proposed algorithm is that the PUs negotiate with the\nSUs on both the amount of monetary compensation, and the amount of time the SUs\nare either (i) allowed spectrum access, or (ii) cooperatively relaying the PU's\ndata, such that both the PUs' and the SUs' minimum rate requirement are\nsatisfied. The proposed algorithm is shown to be flexible in prioritizing\neither the primary or the secondary users. We prove that the proposed algorithm\nwill result in the best possible stable matching and is weak Pareto optimal.\nNumerical analysis also reveal that the distributed algorithm can achieve a\nperformance comparable to an optimal centralized solution, but with\nsignificantly less overhead and complexity."}, "authors": ["Siavash Bayat", "Raymond H. Y. Louie", "Branka Vucetic", "Yonghui Li"], "author_detail": {"name": "Yonghui Li"}, "author": "Yonghui Li", "links": [{"href": "http://arxiv.org/abs/1109.2676v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1109.2676v3", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cs.NI", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cs.NI", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1109.2676v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1109.2676v3", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "Dynamic Decentralized Algorithms for Cognitive\nRadio Relay Networks\nSiavash Bayat, Raymond H. Y. Louie, Branka Vucetic, Yonghui Li\nCentre of Excellence in Telecommunications, School of Electrical and Information Engineering, University of Sydney,\nAustralia\n\nAbstract\nWe propose a distributed spectrum access algorithm for cognitive radio relay networks with multiple\nprimary users (PU) and multiple secondary users (SU). The key idea behind the proposed algorithm is that\nthe PUs negotiate with the SUs on both the amount of monetary compensation, and the amount of time the\nSUs are either (i) allowed spectrum access, or (ii) cooperatively relaying the PU's data, such that both the\nPUs' and the SUs' minimum rate requirement are satisfied. The proposed algorithm is shown to be flexible in\nprioritizing either the primary or the secondary users. We prove that the proposed algorithm will result in the\nbest possible stable matching and is weak Pareto optimal. Numerical analysis also reveal that the distributed\nalgorithm can achieve a performance comparable to an optimal centralized solution, but with significantly\nless overhead and complexity.\nIndex Terms\nCognitive radio, stable matchings, cooperative relaying, overlay model.\n\nI. I NTRODUCTION\nCognitive radio has been proposed as a promising technology to improve the spectral efficiency\nof wireless networks. This is achieved by allowing unlicensed secondary users (SU) to coexist with\nlicensed primary users (PU) in the same spectrum. This coexistence is facilitated by spectrum access\ntechniques, such as those involving an agreement between the PUs and SUs on an acceptable spectrum\naccess strategy. The key idea is that the PUs are motivated to lease spectrum bands to the SUs in\nexchange for some form of compensation.\nMonetary compensation has been well studied (see e.g., [1\u20138]), with the predominant approach for\nspectrum access and performance analysis involving the use of tools from game theory. For example,\n[7\u20139] considered a non-cooperative game between the PUs and SUs, while [4, 6] considered a twostage leader-follower game. For these monetary payment schemes, the PUs are assumed to have\n\n\f2\n\nsufficient spectrum for leasing to the SUs, such that their own performance requirements are not\naffected. Authors in [10] also have considered bilateral bargaining among PUs and SUs. In practice,\nhowever, the PUs may desire higher data rates than what its current spectrum can provide.\nTo allow for higher data rates, the use of cooperative relaying has emerged as a powerful technique\ndue to its ability to exploit user diversity and provide high reliability and capacity in wireless networks\n[11]. This is achieved by the use of intermediate relay nodes to aid transmission between the source\nand destination nodes. The use of cooperative relaying is particularly advantageous when the direct\nlink between the source and destination is weak, due to, for example, high shadowing.\nIn this paper, we consider a model where the SUs act as cooperative relays to assist the PUs'\ntransmission in exchange for both spectrum access and monetary compensation, and thus the SUs\nare effectively providing both a monetary and performance compensation to the PUs. When only\nperformance compensation is considered, this is commonly referred to as the overlay model, and\nvarious schemes have been proposed [12\u201316]. However, these schemes considered the scenario where\nthe increase in PU's performance does not necessarily translate into a satisfactory performance for the\nSUs, and in some cases, the SUs have limited spectrum access opportunities if the PUs have regular\ndata to transmit [12, 17, 18]. This issue was addressed in [19, 20], where a scheme was proposed which\nincreased the PU's performance while simultaneously satisfying the SU's requirements. However,\nthese papers [12\u201314, 19\u201321] considered a simplified scenario with only one PU, and did not consider\nmonetary compensation. Besides, some works also considered a simplified scenario with multiple\nPUs and only one SU.\nIn this paper, we propose a spectrum access strategy for a more general cognitive radio relay\nnetwork with multiple competitive PUs and multiple competitive SUs under the overlay model, which\nguarantees a minimum rate requirement for all matched PUs and SUs. We define a PU and SU as\nmatched if the SU cooperatively relays the PU's data, in exchange for spectrum access and monetary\ncompensation.\nThe majority of current game theory techniques in cognitive radio, which involve multiple PUs\nand multiple SUs focus on a framework where only users of the same type are the primary decision\nmakers, i.e., either the PUs or the SUs are involved in the game to determine access to the spectrum resources [22]. However, in this approach, the decision makers do not take into account the\nperformance metric of the non-decision users, and thus will lead to unacceptably low performance\n\n\f3\n\nfor these users. To obtain better performance, it is thus desirable for the spectrum access strategy to\nget all users involved in the decision making process, and thus the interactions between the PUs and\nSUs should be taken into account, along with the varying performance requirements of these users.\nMoreover, what is not actually captured by the normal and basic game and auction models is the\nfact that different spectrum resources and relaying services that are offered by PUs and SUs causes\ndifferent performance levels for the SUs and PUs respectively due to random phenomena such as:\nfading, noise, and shadowing. More specifically, each PU and each SU supplies a spectrum and\nrelaying service with a specific and unique rate performance for a SU and a PU respectively. Thus to\nmodel such a complex interaction between multiple spectrum suppliers and multiple relaying service\nsuppliers, a more flexible tool is required. Current algorithms in cognitive radio literature addressing\nthis issue have thus far focused on centralized-approaches, e.g., the double-auction approach in [23].\nThis approach is clearly not desirable in practice due to the significant amount of overhead required\nin centralized coordination.\nIn this paper, we develop a new distributed spectrum access framework based on auction and\nmatching theory. The proposed distributed algorithms will match the PUs with the SUs based on\na preference list, which is unique to each user, and based on both monetary and performance\ncompensations. Matching users belonging to two different groups (e.g., a PU group and a SU group)\nbased on preference lists has its roots in the dynamic matching theory [24, 25], which was used to\nmatch users based on a preference list, and recently applied to wireless resource allocation problems\n[26, 27]. However, the algorithms based on the classic matching theory did not consider the possibility\nof dynamic negotiation between the PUs and the SUs with time-varying requirements, which is\ndesirable for users in next generation wireless access networks.\nTo address this issue, we propose a novel dynamic negotiation algorithm based on multi-item\nauction theory [25, 28] and matching theory that requires an intelligent negotiation mechanism, where\nthe PUs and the SUs choose between either prioritizing monetary or performance compensation. Our\nalgorithm determines the matched pairings between PUs and SUs, such that the SU will provide\nmonetary compensation, and relay its paired PU's data in exchange for spectrum access. The key idea\nbehind the algorithm is that the PUs negotiate with the SUs on the amount of monetary compensation,\nin addition to the time the SUs are either (i) allowed access to the spectrum, or (ii) cooperatively\nrelaying the PU's data, such that both the PUs' and the SUs' minimum rate requirement are satisfied.\n\n\f4\n\nWe then analyze the performance of the proposed algorithm, showing that it results in the best possible stable matching, and is weak Pareto optimal. We introduce a utility function, which incorporates\nboth the rate and monetary factors. We demonstrate through numerical analysis that the algorithm\ncan achieve utilities (i) comparable to the utilities achieved by an optimal centralized algorithm, and\n(ii) significantly greater than the utilities achieved by a random matching algorithm that is mixed\nwith a basic negotiation, while also being able to accomplish a high number of matchings with low\noverhead and complexity.\nWhen only the rate is important, and monetary compensation is not a priority, we show that our\nalgorithm is flexible in terms of prioritizing either the PUs or SUs, by a simple manipulation of global\nparameter values. This is in contrast to [29], in which this design flexibility was not achievable. Note\nthat considering this extra monetary parameter is a significant extension to the algorithm presented\nin [29], as considerable changes to the algorithm are required. Moreover, in contrast to [29], we\nalso present additional analyses including (i) proving that our algorithm results in the best stable\nmatching over all possible stable matchings, (ii) providing an explicit upper bound expression for the\nnumber of iterations required for convergence of the proposed algorithm, (iii) presenting an explicit\nexpression for the overhead and (iv) analyzing the complexity performance of our proposed scheme\ncompared to a baseline centralized scheme. Finally, we show that the PUs, which utilize the SUs for\ncooperative relaying achieve a rate greater than what it would achieve without cooperative relaying,\ni.e, direct transmission, and thus motivates their participation in the proposed algorithm.\nThis paper is organized as follows. In Section II, we first describe our system model. We then\nformulate the optimization problem we are trying to solve in Section III, and present a distributed\nsolution to this problem in Section IV. Finally, we analyze the performance and the implementation\naspects of our proposed algorithm in Section V. For convenience, Table I provides a description of\nsome of the parameter values we will be utilizing in this paper.\nII. S YSTEM M ODEL\nWe consider an overlay cognitive radio wireless network, comprising of LPU PU transmitter\nPU\nPU\n\u2013PU receiver {PRi }Li=1\npairs, with the \u0002th pair having a rate requirement of RPU\u0002 ,req , and\n{PTi }Li=1\n\nwith each pair occupying a unique spectrum band of constant size. In the same network, there are LSU\nSU\nSU\nSU transmitter {STi }Li=1\n\u2013SU receiver {SRi }Li=1\npairs, with the qth pair having a rate requirement\n\nof RSUq ,req , and seeking to obtain access to one spectrum band occupied by a (PT, PR) pair. We\n\n\f5\n\nFig. 1. Secondary user and primary user spectrum-access model. The channel and price and time-slot allocation numbers are indicated\nfor (PT\u0002 , PR\u0002 ) and (STq , SRq ).\n\nassume that there are T time-slots per transmission frame, and each (ST, SR) pair has access to a\nmonetary value C.\nEach PT attempts to grant spectrum access to a unique (ST, SR) pair, as determined by the various\nmatching algorithms, described in Sections III and IV, in exchange for (i) the ST cooperatively\nrelaying the PT's data to the corresponding PR, and (ii) monetary compensation. In particular,\nwithout loss of generality (w.l.o.g), let us consider (PT\u0002 , PR\u0002 ), whose transmission is relayed by\nSTq during a fraction \u03b2\u0002,q (0\u2264\u03b2\u0002,q \u22641) of T , whilst also receiving a fraction \u03be\u0002,q (0\u2264\u03be\u0002,q \u22641) of C\nfrom STq , as depicted in Figure 1. We will refer to \u03be\u0002,q and \u03b2\u0002,q as the price and time-slot allocation\nnumbers, respectively, whose exact values will be determined by the matching algorithms described\nin Sections III and IV.\nDuring the cooperative relaying stage in the initial \u03b2\u0002,q T time-slots, a fraction \u03c4\u0002,q (0<\u03c4\u0002,q <1) is\nfirst allocated for PT\u0002 to broadcast its signal to STq and PR\u0002 , thus occurring in the first \u03b2\u0002,q \u03c4\u0002,q T\ntime-slots. In the subsequent \u03b2\u0002,q (1 \u2212 \u03c4\u0002,q )T time-slots, STq cooperatively relays the signal from PT\u0002\nto PR\u0002 . PR\u0002 and then applies maximum ratio combining (MRC) to the signal received from PT\u0002\n\n\f6\n\nin the first \u03b2\u0002,q \u03c4\u0002,q T time-slots, and the signal received from STq in the subsequent \u03b2\u0002,q (1 \u2212 \u03c4\u0002,q )T\ntime-slots. After this cooperative relaying stage, PT\u0002 ceases transmission, allowing STq to transmit\nto SRq over the spectrum occupied by (PT\u0002 , PR\u0002 ) in the final (1 \u2212 \u03b2\u0002,q )T time-slots.\nIn this paper, we consider the amplify-and-forward (AF) relaying protocol, due to its simple and\npractical operation, and thus set \u03c4\u0002,q = 12 . We note, however, that the proposed algorithm is applicable\nto any relaying protocol, such as the decode-and-forward or compress-and-forward protocol. The AF\ngain at STq is chosen such that its instantaneous transmission power is constrained to PSUq .\nA. Utility Functions\nTo evaluate the performance of each (PT, PR) and (ST, SR) pair, we consider the utility function,\nwhich comprises of both rate and monetary factors. The utility function is a concept, which shows\nthe level of satisfaction of a user by combining all parameters to a single number. It represents the\nnet losses and gains of a user [30]. These parameters can be of different types, and by using suitable\nweights can be combined together.\nUtility functions have been widely used in wireless literature to solve various radio resource\nmanagement problems [31\u201333]. These papers include combining different parameters, such as price,\ndelay, signal-to-interference and noise ratio, power, rate, error performance, into a single number.\nSpecifically in cognitive radio, the utility function have been used in [1, 4, 9, 34\u201336].\nFor (PT\u0002 , PR\u0002 ), the achievable instantaneous rate is given by [11]\nRPU\u0002,q (\u03b2\u0002,q )=\n\n\u0002\n\u0003\n\u03b2\u0002,q T\nRelay\n+\n\u0393\nlog2 1 + \u0393Dir\nPR\u0002\nPR\u0002,q\n2\n\n(1)\n\nwhere\n\u0393Dir\nPR\u0002 =\n\n\u03b3PT\u0002 ||hPT\u0002 ,PR\u0002 ||2\nd\u03b1PT\u0002 ,PR\u0002\n\n(2)\n\nis the receive signal-to-noise-ratio (SNR) at PR\u0002 of the direct signal from PT\u0002 ,\n\u0393Relay\nPR\u0002,q =\n\n\u0393PT\u0002 \u2212STq \u0393STq \u2212PR\u0002\n\u0393PT\u0002 \u2212STq \u0393STq \u2212PR\u0002 + 1\n\n(3)\n\nis the equivalent receive SNR of the relayed signal at PR\u0002 from STq , \u0393PT\u0002 \u2212STq =\n\u03b3\n||h\n||2\n\u0393STq \u2212PR\u0002 = STqd\u03b1 STq ,PR\u0002 ,\nSTq ,PR\n\u0002\n\nP\n\u03b3PT\u0002 = \u03c3PT2 \u0002\n\nis the transmit SNR for\n\nP\nPT\u0002 , \u03b3STq = \u03c3ST2 q\n\n\u03b3PT\u0002 ||hPT\u0002 ,STq ||2\n,\nd\u03b1\nPT ,STq\n\u0002\n\nis the transmit SNR\n\nfor STq , \u03c3 2 is the noise variance, PPT\u0002 is the transmission power at PT\u0002 , hPT\u0002 ,PR\u0002 and dPT\u0002 ,PR\u0002 denote\nrespectively the channel and distance from PT\u0002 to PR\u0002 , hPT\u0002 ,STq and dPT\u0002 ,STq are respectively the\n\n\f7\n\nchannel and distance from PT\u0002 to STq , hSTq ,PR\u0002 and dSTq ,PR\u0002 are respectively the channel and distance\nfrom STq to PR\u0002 and \u03b1 is the path loss exponent. We also consider a slowly varying block fading\nchannel model with a sufficiently long coherence time that is constant over the transmission frame\nT.\nSimilar to the utility functions defined in [9, 12, 34\u201336] we define\nUPU\u0002,q (\u03b2\u0002,q , \u03be\u0002,q )=RPU\u0002,q (\u03b2\u0002,q ) + c\u0304\u03be\u0002,q C\n\n(4)\n\nwhere c\u0304\u2208R+ , is a variable with unit defined as: rate per unit monetary value.\nFor (STq , SRq ), the achievable instantaneous rate is given by\n\u0004\n\u0005\nRSUq,\u0002 (\u03b2\u0002,q )=(1 \u2212 \u03b2\u0002,q )T log2 1 + \u0393SRq,\u0002\n\n(5)\n\nwhere\n\u0393SRq,\u0002 =\n\n\u03b3STq ||hSTq ,SRq ,\u0002 ||2\nd\u03b1STq ,SRq\n\n(6)\n\nis the receive SNR at SRq of the direct transmission signal from STq , hSTq ,SRq ,\u0002 is the channel\ncoefficient from STq to SRq in the spectrum band occupied by (PT\u0002 , PR\u0002 ) and dST\u0002 ,SRq is the\ndistance from STq to SRq . The utility for (STq , SRq ) is thus given by\nUSUq,\u0002 (\u03b2\u0002,q , \u03be\u0002,q )=RSUq,\u0002 (\u03b2\u0002,q ) \u2212 k\u0304\u03be\u0002,q C,\n\n(7)\n\nwhere k\u0304\u2208R+ is a variable with unit defined as: rate per unit monetary value. We consider a general\ncase where c\u0304 and k\u0304 have the same units, but their values may be different. This is to allow for\nflexibility in the algorithm design, as will be discussed in Section V.\nIII. P ROBLEM F ORMULATION\nIn this section, we describe the optimization problem we aim to address. To proceed, we introduce some notations. We first define the primary and secondary user sets, respectively, as P=\nPU\nSU\nand S={SUq =(STq , SRq )}Lq=1\n. Moreover, we define a LPU \u00d7 LSU matching\n{PU\u0002 =(PT\u0002 , PR\u0002 )}L\u0002=1\n\nmatrix M, with mi,j =1 if PUi is matched with SUj , and mi,j =0 otherwise, where the notation\nmi,j denotes the (i, j)th entry of matrix M. From this matrix, we introduce an injective function\n\u03bc:(P \u222a S)\u2192(P \u222a S \u222a {\u2205}), such that\n(a) \u03bc(PU\u0002 )\u2208(S \u222a {\u2205}),\n\n\f8\n\nTABLE I\nPARAMETER D ESCRIPTIONS\nNotation\n\nDescription\n\n\u03be\u0002,q\n\u03b2\u0002,q\nT\nC\n\nPrice allocation number\nTime-slot allocation number\nLength of transmission frame\nTotal money each SU has access to in each transmission frame\nTime-slot fraction that PT\u0002 transmits its signal to\nSTq\nPath loss exponent\nReceive SNR at PR\u0002 of the direct transmission\nsignal from PT\u0002\nEquivalent receive SNR of the relayed signal at PR\u0002\nfrom STq\nReceive SNR at SRq of the direct transmission\nsignal from STq\nTransmit signal-to-noise-ratio for PT\u0002\nTransmit signal-to-noise-ratio for STq\nRate per unit monetary value for PT\nRate per unit monetary value for ST\nPU\u0002 's utility while cooperating with STq\nSUq 's utility while cooperating with PU\u0002\nMatching matrix\nTime-slot allocation matrix\nPrice allocation matrix\nPT\u0002 's preference list\nSTq 's preference list\nPT's price step number\nPT's time-slot step number\n\n\u03c4\u0002,q\n\u03b1\n\u0393Dir\nPR\n\n\u0002\n\n\u0393Relay\nPR\u0002,q\n\u0393SRq,\u0002\n\u03b3PT\u0002\n\u03b3STq\nc\u0304\nk\u0304\nUPU\u0002,q\nUSUq,\u0002\nM\nB\nG\nPULIST\u0002\nSULISTq\n\u03b4\n\n(b) \u03bc(SUq )\u2208(P \u222a {\u2205}),\n(c) \u03bc(SUq )=PU\u0002 and \u03bc(PU\u0002 )=SUq if m\u0002,q =1, for \u0002=1, . . . , LPU and q=1, . . . , LSU ,\n(d) \u03bc(SUq )=\u2205 if m\u0002,q =0, for \u0002=1, . . . , LPU ,\n(e) \u03bc(PU\u0002 )=\u2205 if m\u0002,q =0, for q=1, . . . , LSU .\nIn the above definition, (a) implies that a PU is matched to a single SU or no PU, i.e., \u03bc(PU\u0002 )=\u2205,\n(b) implies that a SU is matched to a single PU or no source, i.e., \u03bc(SUq )=\u2205, (c) implies that if\nPU\u0002 is matched to SUq , then SUq is also matched to PU\u0002 and m\u0002,q =1, (d) implies that if m\u0002,q =0\nthen SUq is not matched and (e) implies that if m\u0002,q =0 then PU\u0002 is not matched .\nWe also define an LPU \u00d7 LSU price allocation matrix G with gi,j =\u03bei,j , and an LPU \u00d7 LSU time-slot\nallocation matrix B with bi,j =\u03b2i,j , and where gi,j =bi,j =0 if mi,j =0. We denote the price and timeslot allocation matrices with continuous elements as Gcont and Bcont respectively. Mathematically,\ncont\n=\u03bei,j \u2208\nthis implies that the elements of Gcont and Bcont , respectively take values from the sets {gi,j\n\nR:0\u2264\u03bei,j \u22641} and {bcont\ni,j =\u03b2i,j \u2208R:0\u2264\u03b2i,j \u22641}.\nNow the main goal for each primary and secondary user is to ensure their minimum rate requirements are satisfied. When this is achieved, the secondary goal is to maximize their utility functions.\nNote that the secondary goals for the primary and secondary users cannot be achieved simultaneously,\nas a higher utility for the primary user will result in a lower utility for the matched secondary user,\n\n\f9\n\nand vice-versa. It is natural, and often considered in literature (see e.g. [34]), to give preference to\nthe primary users, i.e. focus on maximizing the primary users' utility. As such, we now present the\noptimization problem:\n\n{Mopt , Bopt , Gopt }\n=arg\n\nmax\n\n{M,Bcont ,Gcont }\n\nLPU \u0006\nLSU\n\u0006\n\nm\u0002,q UPU\u0002,q (\u03be\u0002,q , \u03b2\u0002,q )\n\n\u0002=1 q=1\n\ns.t.:(a)RPU\u0002,\u03bc\u2020 (\u0002) (\u03b2\u0002,\u03bc\u2020 (\u0002) )\u0002RPU\u0002,req ,\u2200\u0002\u2208{1,2,...,LPU }\n(b) RSUq,\u03bc\u2020 (q) (\u03b2\u03bc\u2020 (q),q )\u0002RSUq,req ,\u2200q\u2208{1,2,...,LSU }\n(c) RSUq,\u03bc\u2020 (q) (\u03b2\u03bc\u2020 (q),q )\u2212\u03be\u03bc\u2020 (q),q k\u0304C\u00020,\n\n(8)\n\n\u2200 q\u2208{1,2,...,LSU }\n\n(d)\n\n\u0002LPU\n\u0002=1\n\nm\u0002,q \u22641,\u2200q\u2208{1,2,...,LSU }\n\nSU m\n(e) \u0002Lq=1\n\u0002,q \u22641,\u2200\u0002\u2208{1,2,...,LPU }\n\n(f ) 0\u0003\u03be\u0002,q \u00031, \u2200 q\u2208{1,2,...,LSU }, \u2200 \u0002\u2208{1,2,...,LPU }\n(g) 0\u0003\u03b2\u0002,q \u00031, \u2200 q\u2208{1,2,...,LSU },\u2200 \u0002\u2208{1,2,...,LPU }\nwhere \u03bc\u2020 (p\u0002 )=q if \u03bc(p\u0002 )=sq , and \u03bc\u2020 (sq )=\u0002 if \u03bc(sq )=p\u0002 .\nConditions (a) and (b) ensure that the minimum required rate for the PUs and SUs are satisfied1 ,\nrespectively. Condition (c) ensures that the SUs always receive a positive utility. Conditions (d) and\n(e) respectively ensure that each PU will only be matched with one SU, and vice-versa. Finally,\nconditions (f ) and (g), respectively, ensure that the price and time-slot allocation values are kept\nwithin their bounds.\nIn practice, a centralized controller is required to solve the optimization problem in (8). However,\nthere are three key issues regarding this approach:\n\u2022\n\nOverhead: The centralized controller will require the feedback on channel conditions and minimum rate requirements from each primary and secondary user. Moreover, after the optimization\nproblem is solved, the resultant matching between PUs and SUs and price and time-slot allocation\n\n1\n\nFrom the output of the optimization problem, it can be shown that the final time slot allocation numbers are chosen such that the\nachievable rate for the matched SUs is equivalent to their minimum rate requirement, and the price-time slot allocation numbers are\nchosen such that the utility for each matched SU is zero. We can thus present an alternate formulation accordingly, however, we leave\nthe formulation as described to make it clear that the SU's rate and utility requirements are satisfied.\n\n\f10\n\nnumbers will then have to be transmitted to the corresponding users. The amount of overhead\nrequired for this increases with the number of users, and can be quite high, rendering it\nimpractical.\n\u2022\n\nComplexity: The optimization problem is non-linear, and requires an exhaustive search over all\npossible matching, price and time-slot allocation combinations. Such a problem is known to be\nNP-hard [5].\n\n\u2022\n\nSelfish Users: We assume all the primary and secondary users are selfish2 , which means their\ngoal is to always maximize their own utilities, then the outcome of the optimization problem\nmay not be in the best interests of at least one of these users. Selfishness is considered as an\ninherent behavior of distributed and intelligent users. There are also privacy issues for which a\ncentralized approach may not be ideal.\n\nTo address these issues, we propose a distributed low-complexity algorithm, which accounts for\nselfish users. As we will demonstrate in Section V, our algorithm can achieve a performance close\nto the solution of the optimization problem in (8) for practical system parameters.\nIV. P ROPOSED D ISTRIBUTED M ATCHING A LGORITHM\nIn this section, we describe the proposed algorithm, which determines spectrum access for each\n(PT, PR) and (ST, SR) pair.\nA. Received SNR Assumptions\nWe first describe two scenarios that will be considered in the proposed algorithm, characterized\nby different assumptions on the received SNR at the transmitters and receivers.\n1) Complete Received SNR: In the first scenario, PT\u0002 has perfect knowledge of the instantaneous\n\bLSU\n\u0007\nreceived SNRs in \u0393Dir\nPR\u0002 and \u0393PT\u0002 \u2212STq , \u0393STq \u2212PR\u0002 q=1 . Moreover, STq has perfect knowledge of the\n\bLPU\n\u0007\n. As such, PT\u0002 and STq are able to\ninstantaneous received SNRs in the expressions \u0393SRq,\u0002 \u0002=1\nrespectively calculate their instantaneous rates in (1) and (5).\n2) Partial Received SNR: In the second scenario, PT\u0002 has knowledge of the average received SNRs\nLSU\n\u0007\n\bLSU\n\u03b3\nand the instantaneous received SNRs in the terms \u0393Dir\nand \u0393PT\u0002 \u2212STq q=1\n.\nin the term d\u03b1 STq\nPR\n\u0002\nSTq ,PR\u0002\nq=1\n\bLPU\n\u0007\nMoreover, STq has perfect knowledge of the instantaneous received SNRs in the term \u0393SRq,\u0002 \u0002=1\n.\nAs such, PT\u0002 is able to calculate its instantaneous conditional rate, given by the expectation of the\nSU\nrate in (1), with respect to {hPT\u0002 ,STq }Lq=1\n, while STq is able to calculate its instantaneous rate in (5).\n2\n\nSelfish users are a common assumption in cognitive radio literature [30].\n\n\f11\n\nFor both complete and partial received SNR scenarios, note that each PT and ST does not have\nknowledge of the instantaneous received SNRs corresponding respectively to the other PTs and STs.\nMoreover, the instantaneous received SNRs can be obtained through standard channel estimation\ntechniques.\nB. Users Preference Lists\nEach PT has a preference list of STs which can cooperatively relay the PT's message such that\nit obtains a rate greater than its minimum rate requirement. In particular, the preference list for PT\u0002\nis given by\n\u0002\nPULIST\u0002 ={(ST\u03c6\u0002 (j) , SR\u03c6\u0002 (j) )}K\nj=1\n\n(9)\n\nwhere \u03c6\u0002 (*) is a function \u03c6\u0002 :{1, . . . , K\u0002 }\u2192{1, . . . , LSU } satisfying\nRPU\u0002,\u03c6\u0002 (q) (\u03be\u0002,\u03c6\u0002 (q) , \u03b2\u0002,\u03c6\u0002 (q) )\u0002RPU\u0002 ,req\n\nK\u0002\n\n(10)\n\nq=1\n\nfor the complete received SNR scenario, and the conditions\nEhST\u03c6\n\n\u0002 (q)\n\n,PR\u03c6 (q)\n\u0002\n\nRPU\u0002,\u03c6\u0002 (q) (\u03be\u0002,\u03c6\u0002 (q) , \u03b2\u0002,\u03c6\u0002 (q) )\n\u0002RPU\u0002 ,req\n\n\u000e\n\nK\u0002\nq=1\n\n(11)\n\nfor the partial received SNR scenario. The function \u03c6\u0002 (*) also satisfies the ordering\nUPU\u0002,\u03c6\u0002 (1) (\u03be\u0002,\u03c6\u0002 (1) , \u03b2\u0002,\u03c6\u0002 (1) )>. . .>UPU\u0002,\u03c6\u0002 (K\u0002 ) (\u03be\u0002,\u03c6\u0002 (K\u0002 ) , \u03b2\u0002,\u03c6\u0002 (K\u0002 ) ), implying that the first ST in the list\nprovides the largest utility. Moreover, K\u0002 is the number of (ST, SR) pairs satisfying these conditions.\nSimilarly, each ST has a preference list of PTs which, if it transmits in the spectrum band occupied\nby the (PT, PR) pair in the list, obtains a rate greater than its minimum rate requirement and a utility\ngreater or equal to zero. In particular, the preference list for STq is given by\nSULISTq = (PT\u03c8q (\u0002) , PR\u03c8q (\u0002) )\n\nVq\n\u0002=1\n\n(12)\n\nwhere \u03c8q (*) is a function \u03c8q :{1, . . . , Vq }\u2192{1, . . . , LPU } satisfying the conditions\nRSUq,\u03c8q (\u0002) (\u03b2q,\u03c8q (\u0002) )\u0002RSUq ,req\nand\nUSUq,\u03c8q (\u0002) (\u03beq,\u03c8q (V\u0002 ) , \u03b2q,\u03c8q (\u0002) )\u00020\n\nVq\n\u0002=1\n\nVq\n\u0002=1\n\n(13)\n\n(14)\n\n\f12\n\nwith the ordering USUq,\u03c8q (1) (\u03beq,\u03c8q (1) , \u03b2q,\u03c8q (1) )>. . .>USUq,\u03c8q (Vq ) (\u03beq,\u03c8q (Vq ) , \u03b2q,\u03c8q (Vq ) ). The ordering thus\nimplies that the first PT in the list provides the largest utility. Moreover, V\u0002 is the number of\n(PT, PR) pairs satisfying these conditions.\nIn practice, the instantaneous channels can be measured by utilizing common channel estimation\ntechniques [37]. One possibility is for this channel estimation to be sent via control channels, as\nconsidered in [1, 12].\nC. Proposed Algorithm to Determine the Matching, Price and Time-slot Allocation Matrices\nThe key idea of the proposed algorithm is that each (PT, PR) pair trades with the (ST, SR) pair,\nwhich provides the highest utility, through both cooperative relaying and monetary payment. This\nPU LSU\ntrading will be done by negotiating on the price and time-slot allocation numbers {\u03be\u0002,q , \u03b2\u0002,q }L\u0002=1\nq=1 .\n\nWe say PT\u0002 makes an offer of (\u03be\u0002,q , \u03b2\u0002,q ) to STq to imply that PT\u0002 is willing to allow STq to transmit,\nin exchange for STq (i) cooperatively relaying PT\u0002 's message with time slot allocation number \u03b2\u0002,q\nand, (ii) providing a monetary payment with price allocation number \u03be\u0002,q .\nThe specific details of the main algorithm are given in Table II. Note that the main algorithm calls\nupon the function3 'Proposal Update Unit (PUU)', denoted as PUU(*, *, *), and detailed in Table III.\nNote that the PUU provides an intelligent response for each PU after its offer is rejected by a SU.\nTo summarize the main algorithm (MA), each PT will first make an offer to the ST, which is first\nin its preference list (MA-Step 2-1). The ST will then check if the offering PT is in it's preference\nlist (MA-Step 2-2-1). If it is, and the ST is already matched with another PT, the ST has two\nchoices: (a) if the offering PT can provide a better utility than the ST's current matching, then the\nST will reject its current matching in favor of the new matching (MA-Step 2-2-1-a-i), or (b) if the\noffering PT can not provide a better utility than the ST's current matching, the ST will reject the\nPT's offer (MA-Step 2-2-1-a-ii). If the ST is not matched, then the ST will be matched with the\noffering PT (MA-Step 2-2-1-b). If the offering PT is not in the ST's preference list, the ST will\nreject the offering PT (MA-Step 2-2-2). The algorithm will then repeat this procedure with each PT\nuntil no more matchings are possible.\nNote that if the ST rejects a PT, then the proposal update unit (PUU) will be activated, and the\nPT will either (i) decrease its price allocation number by a price step number \u03b4 (PUU-3), or (ii)\n3\nNote that the PUU is required in the algorithm as we are considering both monetary and rate factors in the utility function. This\nis in contrast to our conference paper [29], which did not have a PUU as monetary factors were not considered.\n\n\f13\n\nTABLE II\nMain Algorithm (MA)\n\nStep 1: Initialization. (Parameter setting and list construction)\n(1) Set (\u03bek,q , \u03b2k,q )=(\u03beinit , \u03b2init ), for k=1, . . . , LPU , eq=1, . . . , LSU .\n(2) Set the price step number \u03b4.\n(3) Set the time-slot step number \u0005.\n(4) Construct PUs's preference list, PULISTk , based on (\u03beinit , \u03b2init ),\nfor k=1, . . . , LPU .\n(5) Construct SUs's preference list, SULISTq , based on (\u03beinit , \u03b2init ),\nfor q=1, . . . , LSU .\n(6) Construct the list of all PTs which are not matched, denoted by\nMATCH={PT1 , . . . , PTLPU }.\n(7) Set the indexing parameter \u0006=1.\nStep 2: Find a suitable ST for each PT(PUs and SUs dynamic negotiation)\n(1) PT\u0002 makes an offer of (\u03be\u0002,q , \u03b2\u0002,q ) to the first ST in its preference list\nPULIST\u0002 . Let us denote this ST as STq . If (\u03be\u0002,q , \u03b2\u0002,q )\u0002=(\u03beinit , \u03b2init ), then\nSTq updates its preference list based on (\u03be\u0002,q , \u03b2\u0002,q ) and reorder its preference\nlist based on the new update.\n(2)\n1) If PT\u0002 is in STq 's preference list, then\na) If STq is already matched to a primary transmitter, denoted by\nPTcurr , then\ni) If PT\u0002 is higher up than PTcurr on STq 's preference list\nSULISTq then\n- SUq and PU\u0002 are matched. Remove PU\u0002 from\nMATCH.\n- Update (\u03becurr,q , \u03b2curr,q , MATCH, PULISTcurr ) by executing the Proposal Update Unit, ie.,\n(\u03becurr,q , \u03b2curr,q , MATCH, PULISTcurr )\n=PUU (\u03becurr,q , \u03b2curr,q , MATCH, PULISTcurr ).\nii) Else\nUpdate\n(\u03be\u0002,q , \u03b2\u0002,q , MATCH, PULIST\u0002 )\nby executing the Proposal Update Unit, ie.,\n(\u03be\u0002,q , \u03b2\u0002,q , MATCH, PULIST\u0002 )\n=PUU (\u03be\u0002,q , \u03b2\u0002,q , MATCH, PULIST\u0002 ).\nb) Else\n- SUq and PU\u0002 are matched. Remove PU\u0002 from MATCH.\n2) Else\n- Update \u03be\u0002,q , \u03b2\u0002,q , MATCH, PULIST\u0002 by executing the Proposal Update Unit, ie.,\n(\u03be\u0002,q , \u03b2\u0002,q , MATCH, PULIST\u0002 )\n=PUU (\u03be\u0002,q , \u03b2\u0002,q , MATCH, PULIST\u0002 ).\n3) If PULIST\u0002 =\u2205, remove PT\u0002 from MATCH, and go to Step 2-3, else\ngo to Step 2-1.\n(3) If no more matchings are possible, i.e., MATCH=\u2205, then go to Step 4.\nElse go to Step 2-1 for each PT which is not matched, i.e., go to Step 2-1\nwith PT\u0002 being the PT corresponding to the first entry in MATCH.\nStep 4: End of the algorithm\n\ndecrease its time slot allocation number by a time slot-step number\n\n(PUU-4), depending on which\n\noption maximizes the PT's utility, and assuming a positive price and time-slot allocation number\nand the minimum data rate requirement for the PT is satisfied.\nWe observe that the proposed algorithm produces a matching, price allocation, and time-slot\nallocation matrix. Note that the price and time-slot allocation matrix have non-zero entries, which\n\n\f14\n\nTABLE III\nProposal Update Unit (PUU)\n\nInput\nOld\n.\n(1) Current price allocation number \u03be\u0002,q\nOld\n(2) Current time-slot allocation number \u03b2\u0002,q\n.\n(3) Current MATCHLISTOld\n(4) Current PUOld\n's preference list PULISTOld\n.\n\u0002\n\u0002\nOutput\nNew\n.\n(1) Updated price allocation number \u03be\u0002,q\nNew\n(2) Updated time-slot allocation number \u03b2\u0002,q\n.\nNew\n(3) Updated MATCHLIST\n(4) Updated PU\u0002 's preference list PULISTNew\n.\n\u0002\nProcedure\nOld\n\u2212 \u03b4\u22640\n(1) If \u03be\u0002,q\n\u0002 Old\n\u0003\nNew\n\u2212 \u0005, 0 .\n1) \u03b2\u0002,q =max \u03b2\u0002,q\nNew\nOld\n2) \u03be\u0002,q =\u03be\u0002,q .\n\u0002 Old\n\u0003\nOld\n\u2212 \u03b4>0 and RPU\u0002,q \u03b2\u0002,q\n\u2212 \u0005, \u03be\u0002,q \u2264RPU\u0002 ,req\n(2) Else if \u03be\u0002,q\nNew\nOld\n1) \u03b2\u0002,q\n=\u03b2\u0002,q\n.\nNew\nOld\n2) \u03be\u0002,q =\u03be\u0002,q \u2212 \u03b4.\n\u0002 Old Old\n\u0002 Old\n\u0003\n\u0003\nOld\n, \u03be\u0002,q \u2212 \u03b4 <UPU\u0002,q \u03b2\u0002,q\n\u2212 \u0005, \u03be\u0002,q\n(3) Else if UPU\u0002,q \u03b2\u0002,q\nNew\nOld\n1) \u03b2\u0002,q\n=\u03b2\u0002,q\n\u2212 \u0005.\nNew\nOld\n2) \u03be\u0002,q =\u03be\u0002,q .\n\u0002 Old Old\n\u0003\n\u0002\n, \u03be\u0003\u0003\n(4) Else \u0002UPU\u0002,q \u03b2\u0002,q\n\u0002,q \u2212 \u03b4\nOld\nOld\n\u2265UPU\u0002,q \u03b2\u0002,q\n\u2212 \u0005, \u03be\u0002,q\nNew\nOld\n1) \u03b2\u0002,q =\u03b2\u0002,q .\nNew\nOld\n2) \u03be\u0002,q\n=\u03be\u0002,q\n\u2212 \u03b4.\nOld\non\n(5) Update the\nold\npreference\n\u0002 New New \u0003 list PULIST\u0002 for (PT\u0002 , PR\u0002 ) based\nthe updated \u03be\u0002,q , \u03b2\u0002,q , to form a new preference list PULISTNew\n.\n\u0002\n(6) Update the old MATHLISTOld by putting PU\u0002 at the end of the\nlist, to form a new MATCHLISTNew .\n\ntake values from a discrete set, in contrast to the continuous set considered in the optimization\nproblem in (8). This is due to the update procedure, where the price and time-slot allocation numbers\nchange according to the price and time-slot step numbers \u03b4 and . We denote the price and timeslot allocation matrices with discrete elements corresponding to the particular \u03beinit , \u03b2init , \u03b4 and\nvalues as Gdisc (\u03beinit , \u03b4) and Bdisc (\u03b2init , ) respectively. Mathematically, the elements of Gdisc (\u03beinit , \u03b4)\ndisc\n=\u03bei,j \u2208\u03beinit \u2212 m\u03b4:m=1, . . . , \u0006 \u03beinit\n\u0007} and\nand Bdisc (\u03b2init , ) respectively take values from the sets {gi,j\n\u03b4\n\u03b2init\n\u0007}.\n{bdisc\ni,j =\u03b2i,j \u2208\u03b2init \u2212 m :m=1, . . . , \u0006\n\nV. P ERFORMANCE AND I MPLEMENTATION A NALYSIS\nWe now analyze the performance of the proposed algorithm, and consider related implementation\nissues. We first present some assumptions we will be considering in the analysis. To demonstrate\nthat the (PT, PR) pairs are motivated to participate in the proposed algorithm, we set the minimum\nrate requirement of each (PT, PR) pair to be the rate of the direct PT to PR link. This is given for\n\u0004\n\u0005\n(PT\u0002 , PR\u0002 ) by RPT\u0002 ,PR\u0002 =T log2 1 + \u0393Dir\nPR\u0002 . In this paper, we thus set RPU\u0002 ,req =RPT\u0002 ,PR\u0002 .\nWe assume all channels experience Rayleigh fading, that randomly distributed as \u223cCN (0, 1) and\n\n\f15\n\nare constant during the duration of the proposed algorithm and subsequent T transmission timeslots. This is a common assumption for auction based and iterative resource allocation algorithms in\nwireless networks [38\u201340].\nMoreover, the PTs and PRs are located on opposite sides of a square of length two, and thus\ndPT\u0002 ,PR\u0002 =2, while the STs and SRs are randomly located in an internal square of length one, located\nwithin the square of length two. Moreover, the minimum rate requirements for each (ST, SR) pair\nSU\n=0.1 and all curves are generated based on averaging over 20,000\nis given by RSU,req ={RSUq ,req }Lq=1\n\ninstances of the algorithm.\nFinally, to demonstrate the benefits of the proposed algorithm, we also consider, in addition to the\ncentralized algorithm in (8), a random matching algorithm where the (PT, PR) pairs are randomly\nmatched with the (ST, SR) pairs, and denoted by \u03bcrnd . When LPU >LSU , LPU \u2212 LSU (PT, PR) pairs\nwill be randomly omitted from the matching, and when LSU >LPU , LSU \u2212LPU (ST, SR) pairs will be\nrandomly omitted from the matching. Once the matchings are randomly established, each matched\nPT-ST pair start an interactive negotiation process on the values of \u03be\u0002,q and \u03b2\u0002,q . If the PT-ST pair\nagree on these values, they will cooperate, otherwise there is no cooperation.\nWe observe that such a random matching requires a centralized approach, and is an upper bound to a\ncompletely distributed random matching with no overhead. However, this is sufficient for comparison\npurposes with the proposed algorithm. Note that the centralized and random matching algorithm\nrepresent the two extremes in the amount of overhead and complexity required for any algorithm.\nFor all figures, unless indicated otherwise the 'Centralized' curves are generated by using (8), the\n'Proposed (complete SNR)' curves are generated as described in Section IV-A1, the 'Proposed (partial\nSNR)' curves are generated as described in Section IV-A2, and the 'RMBN' curves are generated\nbased on the random match basic negotiation methods as previously described in this Section.\nA. Incentive Analysis for Selfish and Rational Users\nA common and realistic assumption in cognitive radio networks is that the primary and secondary\nusers are selfish and rational (see e.g., [1] and [30]). Selfishness implies that users compete with\neach other to maximize their individual utility function, with no regard for other user's utility, while\nrationality implies that users always make decisions to increase their utility. It is thus important for\nthe proposed algorithm to provide, incentive for the users to participate in the proposed algorithm,\nby taking into account the selfish and rational nature of the users.\n\n\f16\n\n1) Accounting for Selfish Users Through Stable Matching: We first prove that the proposed\nalgorithm takes into consideration the selfish nature of the users, by showing that a stable matching\nis produced. To define a stable matching4 , we will first define a matching, which is blocked by an\nindividual, and a matching which is blocked by a pair. To do this, we consider p\u0002 \u2208P and sq \u2208S,\nwhere \u03bc(p\u0002 )=sq and \u03bc(sq )=p\u0002 . A matching \u03bc is blocked by an individual p\u0002 (sq ) if p\u0002 (sq ) prefers\nnot to be matched, than being matched with its current partner under \u03bc. Mathematically, for p\u0002 , this\nimplies that RPU\u0002,\u03bc\u2020 (p ) (\u03b2\u0002,\u03bc\u2020 (p\u0002 ) )<RPU\u0002,req , while for sq , this implies that RSUq,\u03bc\u2020 (s ) (\u03b2\u03bc\u2020 (sq ),q )<RSUq,req\nq\n\n\u0002\n\nor USUq,\u03bc\u2020 (s ) (\u03be\u03bc\u2020 (sq ),q , \u03b2\u03bc\u2020 (sq ),q )<0.\nq\n\nA matching \u03bc is blocked by pair (p\u0002 , sq ) if (i) it is not blocked by individual p\u0002 and sq , and (ii)\nthere exists a \u03be\u0002,q and \u03b2\u0002,q such that p\u0002 and sq can both achieve a higher utility if they were matched\ntogether, as opposed to their current matching under \u03bc. The latter condition, thus mathematically\nimplies that\nUPU\u0002,\u03bc\u2020 (p ) (\u03be\u0002,\u03bc\u2020 (p\u0002 ) , \u03b2\u0002,\u03bc\u2020 (p\u0002 ) )<UPU\u0002,q (\u03be\u0002,q , \u03b2\u0002,q )\n\u0002\n\nUSUq,\u03bc\u2020 (s ) (\u03be\u03bc\u2020 (sq ),q , \u03b2\u03bc\u2020 (sq ),q )<USUq,\u0002 (\u03be\u0002,q , \u03b2\u0002,q ).\nq\n\n(15)\n\nA matching \u03bc is then defined as stable, under the price and time-slot allocation matrices5 G and\nB, if it is not blocked by any individual or any pair. Given this definition, we present the following\ntheorem.\nTheorem 1: The proposed algorithm in Section IV-C produces a stable matching, under\nGdisc (\u03beinit , \u03b4) and Bdisc (\u03b2init , ).\nProof: See Appendix A.\nTheorem 1 is important because it states that the proposed algorithm results in a matching, where\nany matched (PT, PR) and (ST, SR) pair will not both achieve a higher utility than if they were to\nrespectively partner with any other (ST, SR) and (PT, PR) pair.\n2) Accounting for Rational Users Through Utility Maximization: It is also important that the\nproposed algorithm takes into account the rational nature of the users. This first means that each PU\nand SU will obtain at least a better utility if they participated in the algorithm compared to if they\nwere unmatched. This is equivalent to one of the stable matching conditions; that the matching is not\n4\n\nWe extend the common definition of stable matchings [41] to incorporate the price and time-slot allocation numbers\nIn general, G and A can have continuous elements as considered in Section III, or discrete elements as considered in Section IV.\nAny analysis involving the matching \u03bc thus has to also consider the domain of the price and time-slot allocation matrices in order to\nbe meaningful.\n5\n\n\f17\n\nblocked by an individual, and was proved in Theorem 1. The second is that at each iteration of the\nalgorithm, each PU and SU should always choose the user, which provides the highest utility. This\ncan be directly observed in MA-Step 2-1 for each PU, and MA-Step 2-2-1-a-i and MA-Step 2-2-1-b\nfor each SU. This implies that none of these matched selfish PUs and SUs have any incentive to\ndeviate from the matching produced by the proposed algorithm.\nB. Utility Performance\nWe now investigate the utility performance of the proposed algorithm. To do this, we first present\nthe following lemma:\nLemma 1: The utility for every (PT, PR) pair in the stable matching, produced by the proposed\nalgorithm in Section IV-C, is greater than or equal to the utility obtained through a stable matching\nproduced by any algorithm, under Gdisc (\u03beinit , \u03b4) and Bdisc (\u03b2init , ).\nProof: See Appendix B.\nLemma 1 thus indicates that our algorithm produces the best stable matching, out of every possible\nstable matchings, under Gdisc (\u03beinit , \u03b4) and Bdisc (\u03b2init , ).\nA natural question now arises as to how our algorithm performs when compared with non-stable\nmatchings. To answer this, we first show that our algorithm produces a weak Pareto optimal matching,\ndenoted by \u03bcPareto . A weak Pareto optimal matching is defined as a matching where there exists at\nleast one matched (PT, PR) pair under \u03bcPareto , which obtains a utility at least greater than any other\nmatching, stable or non-stable. Given this definition, we present the following theorem:\nTheorem 2: The proposed algorithm in Section IV-C is weak Pareto optimal, under Gdisc (\u03beinit , \u03b4)\nand Bdisc (\u03b2init , ).\nProof: See Appendix C.\nTheorem 2 indicates there exists at least one matched (PT, PR) pair under the proposed algorithm\nthat achieves a utility at least greater than the utility achieved under a non-stable centralized optimal\nalgorithm, under Gdisc (\u03beinit , \u03b4) and Bdisc (\u03b2init , ). This optimal algorithm is similar to the algorithm\nin (8), but under Gdisc (\u03beinit , \u03b4) and Bdisc (\u03b2init , ), not Gcont (\u03beinit , \u03b4) and Bcont (\u03b2init , ).\nIn fact, the proposed algorithm can achieve a utility for every matched (PT, PR) pair very close\nto the centralized optimal algorithm in (8), even under Gcont (\u03beinit , \u03b4) and Bcont (\u03b2init , ). This can be\nobserved in Figure 2, which plots the average sum-utility of all matched (PT, PR) pairs vs. timeslot step number\n\nfor the proposed algorithm, the centralized algorithm in (8), and the RMBN\n\n\fAverage sum\u2212utility of matched primary users,\n\nUPU\n\n\u03a3,\u03bc\n\n18\n\n3.2\n3\nLSU=10\n\nCentralized\nProposed (complete SNR)\nProposed (partial SNR)\nRandom\n\n2.8\n2.6\n2.4\nLSU=2\n\n2.2\n2\n1.8\n1.6\n1.4\n\n0.05\n\n0.1\n\n0.15\n\n0.2 0.25 0.3 0.35 0.4\nTime\u2212slot step number, \u03b5\n\n0.45\n\n0.5\n\n0.55\n\nFig. 2. Average sum-utility of all matched (PT, PR) pairs vs. time slot step-number \u0005, with \u03beinit =0.99, \u03b2init =0.99, \u03b4=\u0005 , \u03b3SU1 =\nPU\n. . . \u03b3SULSU =25 dB, LPU =2, \u03b3PU1 =\u03b3PU2 =5 dB, RSU,req =0.1, {RPU\u0002 ,req =RPT\u0002 ,PR\u0002 }L\n\u0002=1 , c\u0304=1, k\u0304=1 and \u03b1=4.\n\nalgorithm. Note that the average sum-utility corresponds to the sum over all utilities achieved\nby the matched (PT, PR) pairs, averaged over the channel realizations, and given by UPU\u03a3 ,\u03bc =\n\u0010\n\u0011\n\u000f\n\u0002\u2208P\u03bc E U\u0002,\u03bc\u2020 (\u0002) (\u03be\u0002,\u03bc\u2020 (\u0002) , \u03b2\u0002,\u03bc\u2020 (\u0002) ) , where P\u03bc corresponds to all the (PT, PR) pairs matched under\n\u03bc.\nWe first observe in Figure 2 that for the proposed algorithm, the complete and partial received\nSNR scenarios achieve very similar performance, despite different channel assumptions. We next\nobserve that the proposed algorithm (i) achieves a sum-utility comparable with the sum-utility of the\ncentralized algorithm for sufficiently small , and (ii) performs significantly better than the RMBN\nalgorithm. For example, when the time-slot step number =0.1 and LSU =10, we observe that the\nproposed algorithm with complete and partial received SNR achieves respectively (i) \u224897% of the\nsum-utility of the centralized algorithm, and (ii) \u2248193% sum-utility increase compared to the RMBN\nalgorithm.\n\n\f19\n\nAverage sum\u2212rate of matched PUs, RPU\n\n\u03a3,\u03bc\n\n1.6\n\n1.4\n\nLSU=10\n\nCentralized\nProposed (complete SNR)\nProposed (partial SNR)\nRandom\nPUs' direct rate\n\n1.2\n\n1\nLSU=2\n\n0.8\n\n0.6\n\n0.4\n\n0\n\n0.2\n\n0.4\n0.6\n0.8\n1\nPUs' rate per monetary value, c\u0304\n\n1.2\n\n1.4\n\nFig. 3. Average total sum-rate of all matched (PT, PR) pairs vs. c\u0304, with \u03beinit =0.99, \u03b2init =0.99, \u0005=0.05, \u03b4=0.05 , \u03b3SU1 =\nPU\n. . . \u03b3SULSU =25 dB, LPU =2, \u03b3PU1 =\u03b3PU2 =5 dB, RSU,req =0.1, {RPU\u0002 ,req =RPT\u0002 ,PR\u0002 }L\n\u0002=1 , k\u0304=15 and \u03b1=4.\n\nC. Rate Performance\nAs observed in Section IV-C and Figure 2, the proposed algorithm's primary focus is on maximizing the PU's sum-utility, while simultaneously satisfying both the PU's and SU's minimum rate\nrequirement. However, some networks may require that (i) only the rate is important and monetary\nfactors are not a consideration, and (ii) the SUs also prefer a higher rate, greater than their minimum\ndata rate requirement. For such networks, the proposed algorithm is flexible in adapting to these\ndesign needs.\nIn particular, observe from (4) that increasing c\u0304 has the effect of increasing the contribution of\nthe monetary value in the (PT, PR)'s utility function. As observed in the Proposal Update Unit, this\nhas the effect of the PUs choosing to offer a lower time-slot allocation number, rather than a lower\nprice allocation number, to the SUs. This will subsequently result in a higher rate for the SUs, at\nthe expense of a lower rate for the PUs. Thus the parameter c\u0304 can be used to control the rates of\nthe PUs and SUs, in accordance with specific system requirements.\n\n\fAverage sum\u2212rate of matched SUs, RPU\n\n\u03a3,\u03bc\n\n20\n\n12\n\nLSU=2\nLSU=10\n\n10\n\nCentralized\nProposed (complete SNR)\nProposed (partial SNR)\nRandom\nR SU,req\n\n8\n\n6\n\nLSU=2\n\n4\nLSU=10\n\n2\n\n0\n\nLSU=2\n\n0\n\n0.2\n\n0.4\n0.6\n0.8\n1\nPUs' rate per monetary value, c\u0304\n\n1.2\n\n1.4\n\nFig. 4. Average total sum-rate of all matched (ST, SR) pairs vs. c\u0304, with \u03beinit =0.99, \u03b2init =0.99, \u0005=0.05, \u03b4=0.05 , \u03b3SU1 =. . . \u03b3SULSU =\nPU\n25 dB, LPU =2, \u03b3PU1 =\u03b3PU2 =5 dB, RSU,req =0.1, {RPU\u0002 ,req =RPT\u0002 ,PR\u0002 }L\n\u0002=1 , k\u0304=15 and \u03b1=4.\n\nThis can be observed in Figures. 3 and 4, which respectively plots the average sum-rate of all\nmatched (PT, PR) pairs vs. c\u0304, and the average sum-rate of all matched (ST, SR) pairs vs. c\u0304, for\nthe complete received SNR scenario. Note that the average sum-rate of all matched (PT, PR) pairs\ncorresponds to the sum over all rates achieved by the matched (PT, PR) pairs, averaged over the\n\u0010\n\u0011\n\u000f\nchannel realizations, and is given by RPU\u03a3 ,\u03bc = \u0002\u2208P\u03bc E R\u0002,\u03bc\u2020 (\u0002) (\u03b2\u0002,\u03bc\u2020 ) , where P\u03bc corresponds to\nall the (PT, PR) pairs matched under \u03bc. A similar definition can be made for the sum-rate of the\nmatched (ST, SR) pairs, denoted RSU\u03a3 ,\u03bc . For comparison, we also plot the sum-rate achieved by a\ncentralized optimal algorithm. In particular, in Figure 3, the centralized algorithm produces a sumrate, which maximizes the total sum-rate of all (PT, PR) pairs, and given by substituting c\u0304=0 into\nthe optimal algorithm produced from (8). In Figure 4, the centralized algorithm produces a sum-rate\nwhich maximizes the sum-rate of all (ST, SR) pairs, and is formulated in a way similar to (8), but\ninterchanging the (PT, PR) pairs with the (ST, SR) pairs in the optimization equation. This results\n\n\fAverage percentage of matched primary (secondary) users\n\n21\n\n1\n0.9\n\nLSU=15\n\n0.8\n0.7\nLSU=2\n\n0.6\n0.5\n0.4\nCentralized\nProposed (complete SNR)\nProposed (partial SNR)\nRandom\n\n0.3\n0.2\n0.1\n\n0\n\n5\n\n10\n15\nSUs signal to noise ratio, (\u03b3 ST)\n\n20\n\n25\n\nFig. 5. Percentage of matched (PT, PR) pairs vs. the total number of (ST, SR) pairs LSU , with \u03b1init =0.99, \u03b2init =0.99, \u0005=0.05,\nPU\n\u03b4=0.05 , \u03b3SU1 =. . . \u03b3SULSU =25 dB, LPU =2, \u03b3PU1 =\u03b3PU2 =5 dB, LPU =2, RSU,req =0.1, {RPU\u0002 ,req =RPT\u0002 ,PR\u0002 }L\n\u0002=1 , c\u0304=1, k\u0304=2\nand \u03c1=4.\n\nin the optimization\narg\n\nmax\n\n{M,Bcont ,Gcont }\n\nLPU \u0006\nLSU\n\u0006\n\nm\u0002,q RSUq,\u0002 (\u03be\u0002,q , \u03b2\u0002,q )\n\n\u0002=1 q=1\n\nsubject to the conditions in (8).\nWe observe in Figures. 3 and 4 that RPU\u03a3 ,\u03bc decreases with c\u0304, while RSU\u03a3 ,\u03bc increases with c\u0304, as\nexpected. This shows the flexibility of our algorithm in adapting to different primary and secondary\nuser priority levels. When c\u0304 is low, we observe in Figure 3 that the sum-rate of the matched (PT, PR)\npairs of our proposed algorithm achieves a high percentage of the optimal algorithm and significantly\ngreater than the RMBN algorithm. Similarly, when c\u0304 is high, we observe in Figure 4 that the sum-rate\nof the matched (ST, SR) pairs of our proposed algorithm achieves a high percentage of the optimal\nalgorithm and significantly greater than the RMBN algorithm.\n\n\f22\n\nD. Total Number of Matchings\nThe total number of matched (PT, PR) and (ST, SR) pairs is also an important consideration of\nany matching algorithm, and is proportional to the total number of users which can achieve their\nminimum rate requirements. Figure 5 shows the percentage of matched (PT, PR) pairs vs. the SU's\nSNR \u03b3ST =\u03b3ST1 =\u03b3STLSU , for different number of (ST, SR) pairs LSU . We observe that the percentage\nof matched (PT, PR) pairs increases with \u03b3SU and LSU , due to the higher achievable rates that the\nmatched (PT, PR) pairs can achieve through cooperative relaying. Remarkably, we observe that the\nproposed scheme can achieve a very high matching percentage at high SNR even when LSU =2,\ni.e., \u226580% when \u03b3SU \u226520 dB. Moreover, the proposed algorithm delivers a percentage of matched\nusers comparable with the centralized algorithm, and significantly greater than the RMBN algorithm.\nNote that as the minimum rate requirement for the PUs is equal to the rate of their corresponding\ndirect link transmission without cooperative relaying, Figure 5 thus indicates that the PUs are well\nmotivated to participate in the trading framework with the SUs.\nIn practice, the unmatched PTs will transmit directly to their corresponding PRs and thus (PT\u0002 , PR\u0002 )\nwill achieve the rate RPT\u0002 ,PR\u0002 . However, the unmatched STs will not be able to transmit at all. To\nremedy this, various modifications to the proposed algorithm can be made, which are the subject\nof future work such as integrating a fairness mechanism into the algorithm so each ST has a turn\ntransmitting, though at different times.\nE. Convergence\nWe will now analyze the convergence behavior of the proposed algorithm, as shown in the following\ntheorem:\nTheorem 3: The number of iterations required for the proposed algorithm to converge is upper\nbounded by:\nImax =\nwhere \u03b2 MIN = min\n\n\u0005\n\u03beinit 1 \u0004\n+\n\u03b2init \u2212 \u03b2 MIN\n\u03b4\n\nmin\nmin\nmin \u03b2\u0002,q\nand \u03b2\u0002,q\n=\n\n\u0002=1,...,LPU q=1,...,LSU\n\nProof: See Appendix D.\n\n\u0003\n\n2RPU\u0002,req\n\nRelay\nT log2 1+\u0393Dir\nPR +\u0393PR\n\u0002\n\n(16)\n\u0004.\n\n\u0002,q\n\nTheorem 3 implies that the proposed algorithm converges after a finite number of iterations, and\nthat this number is dependent on different parameters. For example, we clearly see that the number\nof iterations for convergence decreases with\n\nand \u03b4, and increases with \u03beinit and \u03b2init .\n\n\f23\n\nF. Overhead\nThe proposed algorithm is distributed, and thus incurs significantly less overhead and complexity\ncompared to centralized algorithms. An exact analysis of the amount of overhead and complexity\nis difficult, due to the dependency on a number of system parameters, such as the minimum sumrate requirements, the price and time-slot step-numbers and the initial price and time-slot allocation\nnumbers. We can however, find an expression for the upper bound on the maximum number of\ncommunication packets between the PTs adn the STs, given in the following theorem:\nTheorem 4: The number of communication packets between the PTs and the STs required in the\nproposed algorithm is upper bounded by\nNmax =(a1 LPU + a2 F ) Imax\n\u0013\n\u0012\n\u0005\n\u03beinit 1 \u0004\nMIN\n+\n\u03b2init \u2212 \u03b2\n=(a1 LPU + a2 F )\n\u03b4\n\n(17)\n\nwhere where a1 , a2 \u2208R+ and F =max{LPU , LSU }.\nProof: See Appendix E.\nWe observe in (17) that the amount of overhead, and thus the number of iterations, decreases\nwith\n\nand \u03b4. This is confirmed in Figure 6, which plots the total number of communication packets\n\nexchanged between each PT and all the STs it communicates with, vs. time-slot step number ,\nwith the same parameters used in Figure 2. We see that the total number of communication packets\nconverge to a constant at sufficiently high . This is because if\n\nis sufficiently large, the time-slot\n\nallocation numbers are updated in the algorithm in such a way that the preference lists for each\n(PT, PR) and (ST, SR) pair remain unchanged.\nDenoting the random variable Y as the total number of communication packets as a function of\nthe user channels, Figure 7 plots the cumulative distribution function (c.d.f.) of Y , PR (Y \u2264y), vs.\ny for different number of secondary users LSU , where y is a realization of Y . We observe that the\nproposed algorithm can achieve low overhead with high probability in various practical scenarios.\nFor example, when LSU =6, we observe that 90% of the time, a maximum of only 15 communication\npackets are exchanged between the PUs and the SUs.\nFigures. 2 and 6, and (17) reveal that can be designed to ensure an acceptable amount of overhead\nand achievable rate. In particular, we observe from (17) and Figure 6 that decreasing the overhead by\nincreasing\n\nor \u03b4 will result in both a lower magnitude and number of price and time-slot allocation\n\n\f24\n\nAverage number of communication packets\n\n100\nProposed (complete SNR)\nProposed (partial SNR)\n\n90\n80\n70\n60\n50\n40\n30\n\nLSU=6\n\n20\n10\n0\n\nLSU=2\n\n0.05\n\n0.1\n\n0.15\n0.2\n0.25\nTime\u2212slot step number, \u03b5\n\n0.3\n\n0.35\n\n0.4\n\nFig. 6. Total number of communication packets vs. \u0005 for the complete instantaneous received SNR scenario, with \u03b1init =0.99,\nPU\n\u03b2init =0.99, \u0005=0.05, \u03b4=0.05 , \u03b3SU1 =. . . \u03b3SULSU =25 dB, LPU =2, \u03b3PU1 =\u03b3PU2 =5 dB, RSU,req =0.1, {RPU\u0002 ,req =RPT\u0002 ,PR\u0002 }L\n\u0002=1 ,\nc\u0304=1, k\u0304=1 and \u03c1=4.\n\nnumbers which can be offered to the (ST, SR) pairs from the (PT, PR) pairs. This will result in\na lower utility for the (PT, PR) pairs, and increase the chance the STs will reject any offer made.\nThis can be observed in Figure 2, which illustrates a tradeoff between performance and overhead.\nA similar argument can be made for decreasing \u03beinit and \u03b2init . In practice, each PU can adaptively\nadjust it's time-slot step number\n\nbased on (i) the acceptable sum utility of PUs in Figure 2 and (ii)\n\nthe tolerable average number of required communication packets in Figure 6.\nWe note that the packet length required for communication between the PTs and the STs is very\nshort. In particular, assuming that \u03beinit , \u03b2init , \u03b4 and\n\nare initially known to all users, each PT is only\n\nrequired to send one bit to the first ST in its preference list indicating an offer, and the corresponding\nST only needs to send one bit back to the offering PT indicating either acceptance or rejection. The\nrequired time for the proposed algorithm execution is thus very small. Specifically, if high speed\ncontrol channels such as 802.11 are used, the average time for execution is in the order of 100-200\nnsec [42]. As demonstrated in Figure 6, the total number of communication packets for each PT\n\n\f25\n\n1\n\u03b3SU=25 dB\n\nCDF of proposed algorithm convergence\n\n0.9\n\n\u03b3SU=20 dB\n\n0.8\n0.7\nLSU=6\n\n0.6\n0.5\n0.4\n\nLSU=15\n\n0.3\n0.2\n0.1\n0\n\n0\n\n5\n\n10\n15\n20\n25\n30\nNumber of communication packets\n\n35\n\n40\n\nFig. 7. Cumulative distribution function vs. total number of communication packets for the complete instantaneous received SNR\nscenario, with \u03b1init =0.99, \u03b2init =0.99, \u0005=0.05, \u03b4=0.05 , \u03b3SU1 =. . . \u03b3SULSU =25 dB, LPU =2, \u03b3PU1 =\u03b3PU2 =5 dB, RSU,req =0.1,\nPU\n{RPU\u0002 ,req =RPT\u0002 ,PR\u0002 }L\n\u0002=1 , c\u0304=1, k\u0304=1 and \u03c1=4.\n\ncan be designed to be reasonably small, and thus given the short packet lengths, the total running\ntime and amount of overhead from the proposed algorithm can be quite small.\nG. Complexity\nWe now present a lemma for the complexity of the centralized, proposed and RMBN algorithms:\nLemma 2: The complexity of the centralized algorithm is given by\n\u0014\n\nO\nO\n\n\u0002\n\u0002\n\nLSU !\n22LSU +LPU\n(LSU \u2212LPU )!\nLPU !\n22LSU +LPU\n(LPU \u2212LSU )!\n\n\u0003\n\u0003\n\n, if LSU \u2265LPU ;\n\n(18)\n\n, if LSU <LPU ,\n\nof the proposed algorithm by O (LPU LSU ), and of the RMBN algorithm by O (LPU ).\nProof: See Appendix F.\nWe observe that the centralized method has a significantly larger complexity than both the proposed\nand randomized algorithm. Its complexity is increasing exponentially with the number of primary\nand secondary users. In contrast, the proposed algorithm complexity only increases linearly with the\n\n\f26\n\nnumber of primary or secondary users.\nVI. C ONCLUSION\nWe proposed a distributed algorithm for spectrum access, which guarantees that the PUs' and SUs'\nrate requirements are satisfied. Our algorithm hinges on a trading framework between the PUs and\nSUs, where the PUs and SUs negotiate on combined time-slot and monetary compensation. Time\nslot allocation numbers determine the amount of transmission time dedicated for SU transmission,\nand the length of time the SUs will cooperative relay the PUs' data. The price allocation numbers\nexpress the amount of monetary compensation that SU provide for PUs in exchange of spectrum\nusage. The proposed algorithm, was based on a dynamic bilateral negotiation between the PUs and\nSUs that resulted in a stable outcome. We proved that the proposed algorithm results in the best\npossible stable matching and is weak Pareto optimal. A numerical analysis also revealed that the\ndistributed algorithm achieves a performance comparable to an optimal centralized algorithm, but\nwith significantly less overhead and complexity.\nA PPENDIX\nA. Proof of Theorem 1\nL\n\nprop\n\n\u03bc\nWe first define some notations. Without loss of generality, let {(PT\u0002 PR\u0002 )}\u0002=1\n\nbe the set of\n\nmatched (PT, PR) pairs at the conclusion of the algorithm. We first consider p1 =(PT1 , PR1 ), with\nthe preference list at the conclusion of the algorithm denoted by PULIST1 ={s1 , . . . , sK1 }. Associated\nwith this preference list are the final price and time-slot allocation numbers associating p1 and\nprop K1\nprop K1\n1\n{sq }K\nq=1 , and denoted respectively by {\u03be1,q }q=1 and {\u03b21,q }q=1 . Note that due to the ordering of\n\nthe preference list, the proposed algorithm will match p1 with s1 . We now prove that the proposed\nalgorithm doesn't produce any blocking pairs by contradiction. Assume that p1 and sq , for some\nq=2, . . . , K1 , constitute a blocking pair. This implies that there exists a \u03be1,q and \u03b21,q such that\nprop\nprop\nprop\nprop\n, \u03b21,1\n), implying that either (i) \u03be1,q >\u03be1,q\n, (ii) \u03b21,q >\u03b21,q\nor (iii) both\nUPU1,q (\u03be1,q , \u03b21,q )>UPU1,1 (\u03be1,1\nprop\nprop\nand \u03b21,q >\u03b21,q\n. Due to the ordering of the preference list PULIST1 , this cannot occur as\n\u03be1,q >\u03be1,q\n\nthere would have been a period during the algorithm when sq initially rejected p1 at this \u03b21,q and/or\n\u03be1,q value, as sq received a better offer from another (PT, PR) pair. For this scenario, p1 and sq thus do\nnot form a blocking pair. A similar proof can be made for the other p\u0002 s, for \u0002=2, . . . , LPU . The stable\nmatching proof follows by noting that there are no blocking individuals due to the preference lists,\n\n\f27\n\ni.e., no (PT, PR) and (ST, SR) pairs will be matched respectively with a (ST, SR) and (PT, PR)\npair not on its preference list.\nB. Proof of Lemma 1\nThe proof is by contradiction. Denote \u03bcprop as the stable matching produced by the proposed\nalgorithm, and \u03bcalt as another stable matching. Then let us assume that for all (PT, PR) pairs, the\nutility achieved under \u03bcprop is less than the utility achieved under \u03bcalt . W.l.o.g, consider (PT\u0002 , PR\u0002 ),\nand thus the previous statement mathematically implies that\nUPU\n\nalt\n\u0002,\u03bc\u2020\n(\u0002)\n\nprop\nprop\nalt\nalt\nprop\nprop\nalt\nalt\n(\u03be\u0002,\u03bc\n, \u03b2\u0002,\u03bc\n)>UPU\u0002,\u03bc\u2020 prop (\u0002) (\u03be\u0002,\u03bc\n, \u03b2*,*\n) and (\u03be*,*\n, \u03b2*,*\n)\n\u2020 prop (\u0002) , \u03b2\u0002,\u03bc\u2020 prop (\u0002) ), where (\u03be*,*\n\u2020 alt (\u0002)\n\u2020 alt (\u0002)\n\ndenote the price and time-slot allocation numbers under matching \u03bcprop and \u03bcalt respectively. Denoting\nalt\n\nalt\nalt\n, \u03b2\u0002,\u03bc\n) to\nq=\u03bc\u2020 (\u0002), this means that under the proposed matching \u03bcprop , PT\u0002 offered (\u03be\u0002,\u03bc\n\u2020 alt (\u0002)\n\u2020 alt (\u0002)\n\nSTq but was rejected. There are two ways for this to happen. The first is if under matching \u03bcprop ,\nalt\nalt\n, \u03b2\u0002,\u03bc\n) was not in STq 's preference list SULISTq . However, this\nPT\u0002 with proposal (\u03be\u0002,\u03bc\n\u2020 alt (\u0002)\n\u2020 alt (\u0002)\nalt\nalt\n, \u03b2\u0002,\u03bc\n)\ncontradicts the implicit assumption that under matching \u03bcalt , PT\u0002 with proposal (\u03be\u0002,\u03bc\n\u2020 alt (\u0002)\n\u2020 alt (\u0002)\n\nis in STq 's preference list, and thus should also be in STq 's preference list under matching \u03bcprop .\nThe second alternative is if under matching \u03bcprop , STq rejected PT\u0002 in favor of another primary\ntransmitter, denoted as PT\u03bd . W.l.o.g., let us assume that this is the first rejection that has taken place\nunder \u03bcprop . This implies that PT\u03bd prefers STq to every other (ST, SR) pair, and thus the matching\n\u03bcalt is blocked by pair ((PT\u03bd , PR\u03bd ), (STq , SRq )), which contradicts the assumption that \u03bcalt is a\nstable matching.\nC. Proof of Theorem 2\nWe outline the proof for non-stable matchings, and note that the proof for stable matchings follows\ndirectly from Lemma 1. The proof is by contradiction. Denote \u03bcprop as the matching produced by\nthe proposed algorithm, and \u03bcopt as an arbitrary non-stable matching. Then let us assume that every\nmatched (PT, PR) pair in \u03bcprop achieves a utility less than its utility obtained under matching \u03bcopt .\nL\n\nprop\nprop\nopt\nopt\n\u03bc\n, \u03b2\u0002,\u03bc\n)}\u0002=1\nMathematically, this is represented by {U\u0002,\u03bc\u2020 prop (\u0002) (\u03be\u0002,\u03bc\n\u2020 prop (\u0002) , \u03b2\u0002,\u03bc\u2020 prop (\u0002) )<U\u0002,\u03bc\u2020 opt (\u0002) (\u03be\n\u2020 opt (\u0002)\n\u0002,\u03bc\u2020 opt (\u0002)\nprop\nprop\nopt\nopt\n, \u03b2*,*\n) and (\u03be*,*\n, \u03b2*,*\n) denote the price and time-slot allocation numbers under matching\nwhere (\u03be*,*\n\n\u03bcprop and \u03bcopt respectively. We consider three scenarios, defined by the relative number of matched\n(ST, SR) pairs under \u03bcprop compared to \u03bcopt . Specifically:\n\nprop\n\n,\n\n\f28\n\n1) Same matchings: In this scenario, every matched (ST, SR) and (PT, PR) pair under \u03bcprop\nis also matched under \u03bcopt . Consider the last (ST, SR) pair which is matched in \u03bcprop , and denote this pair as (STL\u03bcprop , SRL\u03bcprop ). Moreover, w.l.o.g. (STL\u03bcprop , SRL\u03bcprop ) is matched with (i)\n(PTL\u03bcprop , PRL\u03bcprop ) under matching \u03bcprop , and (ii) (PT1 , PR1 ) under matching \u03bcopt . From the initial\ncontradiction assumption, note that under \u03bcprop , (PT1 , PR1 ) prefers (STL\u03bcprop , SRL\u03bcprop ) with price\nalt\nalt\n, \u03b21,L\n) than its current matching, which mathematically\nand time slot allocation numbers (\u03be1,L\n\u03bcprop\n\u03bcprop\n\nimplies that\nprop\nprop\nalt\nalt\n, \u03b21,L\n)>UPU1,\u03bc\u2020 prop (1) (\u03be1,\u03bc\nUPU1,L\u03bcprop (\u03be1,L\n\u2020 prop (1) , \u03b21,\u03bc\u2020 prop (1) ). There was thus a period during\n\u03bcprop\n\u03bcprop\nprop\nalt\n(>\u03be1,L\n), and/or\nthe proposed algorithm where (PT1 , PR1 ) offered a price allocation number \u03be1,L\nPU\nPU\nprop\nalt\n(>\u03b21,L\n) to (STL\u03bcprop , SRL\u03bcprop ), and was rejected. However, as\na time-slot allocation number \u03b21,L\nPU\nPU\n\n(STL\u03bcprop , SRL\u03bcprop ) is the last (ST, SR) pair to be matched, this is a contradiction as (STL\u03bcprop , SRL\u03bcprop )\nwill not reject any offer from (PT1 , PR1 ).\n2) More primary user matchings: In this scenario, there are more (PT, PR) pairs which are\nmatched under \u03bcprop , then matched under \u03bcopt . The initial contradiction assumption is thus clearly\nviolated, as the un-matched (PT, PR) pairs which are matched under \u03bcprop , but not under \u03bcopt , have\na zero utility.\n3) Less primary user matchings: In this scenario, there are less (PT, PR) pairs which are matched\nunder \u03bcprop , then matched under \u03bcopt . Every (ST, SR) pair which is not matched under \u03bcprop will\nthus have a zero utility. However, at least one of these (ST, SR) pairs, denoted as (STq , SRq ) will\nobtain a positive utility under \u03bcopt . Combined with the initial contradiction assumption, this implies\nthat (STq , SRq ) and (PT\u03bc\u2020 opt (q) , PR\u03bc\u2020 opt (q) ) form a blocking pair for \u03bcprop , which is a contradiction.\nD. Proof of Theorem 3\nFrom MA-Step 2-2-1-a-i and MA-Step 2-2-2 of the proposed algorithm in Table II, if STq rejects\nthe offer of PT\u0002 , then PT\u0002 will decrease its price allocation number \u03b2\u0002,q or its time-slot allocation\nnumber \u03be\u0002,q by executing PUU. The minimum possible price allocation number that PT\u0002 can offer\nSTq is \u03be\u0002,q =0, while the minimum time-slot allocation number that PT\u0002 can offer STq is\nmin\n\u03b2\u0002,q\n=\n\n\u0002\n\n2RPU\u0002,req\n\nRelay\nT log2 1 + \u0393Dir\nPR\u0002 + \u0393PR\u0002,q\n\n\u0003.\n\n(19)\n\nmin\n\u2212 , since its minimum rate\nPT\u0002 will not decrease its time-slot allocation number to \u03b2\u0002,q =\u03b2\u0002,q\n\nrequirement will not be satisfied. Thus the minimum possible time-slot allocation number that PT\u0002\n\n\f29\n\ncan offer in the algorithm is\nmin\n\u03b2\u0002MIN = min \u03b2\u0002,q\n.\n\n(20)\n\nq=1,...,LSU\n\nSo in the worst case scenario, each PT\u0002 , \u0002=1, . . . , LPU after\n\n\u03beinit\n\u03b4\n\n+\n\n1\n\n\u0004\n\n\u03b2init \u2212 \u03b2\u0002MIN\n\n\u0005\n\niterations\n\nwill not make any offer to any ST, and according to MA Step 2-2-3, PT\u0002 will be removed from\nthe list of unmatched PTs denoted by MATCH in Table II. Thus the maximum number of iterations\nthat all the PTs will be removed from MATCH is given by\n\u03beinit 1\n+\nImax =\n\u03b4\n\n\u0012\n\n\u0013\n\u03b2init \u2212\n\nmin\n\n\u0002=1,...,LPU\n\n\u03b2\u0002MIN\n\n.\n\n(21)\n\nE. Proof of Theorem 4\nFollowing the proposed algorithm in Table II, the PTs and STs need to communicate together as\nfollows. In MA-Step 2-1, in the worst case scenario, all the PTs make an offer to all the STs, and\nthus LPU communication packets are required. After receiving the PTs offer, the STs need to inform\nthe PTs whether they accepted or rejected the offers. This process happens in MA-Step 2-2-1-a-i,\nMA-Step 2-2-1-a-ii and MA-Step 2-2-2 and thus F communication packets are required. Thus in the\nfirst iteration of the algorithm, a maximum of LPU + F communication packets are required.\nHowever, since in the next iterations some of the PUs are matched and also the length of the\npreference list of the unmatched PTs is decreased, the number of communication packets will\ndecrease. Thus after the first iteration, the total number of communication packets at each iteration\nof the algorithm is a linear function of LPU and F . The maximum number of iterations that the\nalgorithm ends is also known from Theorem 3. Therefore, the maximum number of communication\npackets packets between the PTs and STs scales as (a1 LPU + a2 F ) Imax .\nF. Proof of Lemma 2\nFor the centralized method when LPU \u0003LSU , the proof follows by noting that the total number of\nmatching combinations between the PTs and STs is\n\nLSU !\n,\n(LSU \u2212LPU )!\n\nwhile the complexity of solving the\n\nlinear programming problem for all possible matching combinations is 22LSU +LPU [43]. A similar\nargument can be made when LPU >LSU . For the proposed algorithm, the proof follows by noting\nthat the complexity is proportional to the total number of times the PTs communicates with the STs,\ngiven in (17). For the RMBN method, the proof follows by noting that each PT communicates to a\nrandom ST only once, and thus the complexity is proportional to the number of primary users LPU .\n\n\f30\n\nACKNOWLEDGMENT\nThis work was supported in part by the Australian Research Council (ARC) Discovery Projects\nGrants DP120100190, DP0877090, and Linkage Project Grant LP0991663, and Future Fellowships\nGrant FT120100487.\nR EFERENCES\n[1] D. Niyato, E. Hossain, and Z. Han, \"Dynamics of multiple-seller and multiple-buyer spectrum trading in cognitive radio networks:\nA game-theoretic modeling approach,\" IEEE Trans. Mobile Comput., vol. 8, no. 4, pp. 1009\u20131022, Aug. 2009.\n[2] Z. Ji and R. Liu, \"Multi-stage pricing game for collusion-resistant dynamic spectrum allocation,\" IEEE J. Select. Areas Commun.,\nvol. 26, no. 1, pp. 182\u2013191, Jan. 2008.\n[3] S. K. Jayaweera and T. Li, \"Dynamic spectrum leasing in cognitive radio networks via primary-secondary user power control\ngames,\" IEEE Trans. Wireless Commun., vol. 8, no. 6, pp. 3300\u20133310, Jun. 2009.\n[4] P. Lin, J. Jia, Q. Zhang, and M. Hamdi, \"Dynamic spectrum sharing with multiple primary and secondary users,\" IEEE Trans.\nVeh. Technol., vol. 60, no. 4, pp. 1756\u20131765, May 2011.\n[5] L. Gao, Y. Xu, and X. Wang, \"MAP: Multiauctioneer progressive auction for dynamic spectrum access,\" IEEE Trans. Mobile\nComput., vol. 10, no. 8, pp. 1144\u20131161, Aug. 2011.\n[6] V. Gajic, J. Huang, and B. Rimoldi, \"Competition of wireless providers for atomic users: Equilibrium and social optimality,\" in\nProc. 47th Annual Allerton Conference on Communication, Control, and Computing, 2009.\n[7] Y. Tan, S. Sengupta, and K. Subbalakshmi, \"Competitive spectrum trading in dynamic spectrum access markets: A price war,\"\nin IEEE Global Telecommunications Conference (GLOBECOM), Dec. 2010, pp. 1\u20135.\n[8] H. S. Mohammadian and B. Abolhassani, \"Auction-based spectrum sharing for multiple primary and secondary users in cognitive\nradio networks,\" in Proc. IEEE Sarnoff Symposium, 2010.\n[9] D. Li, Y. Xu, J. Liu, X. Wang, and Z. Han, \"A market game for dynamic multi-band sharing in cognitive radio networks,\" in\nIEEE International Conference on Communications (ICC), vol. 1, May 2010, pp. 1\u20135.\n[10] C. Z. X. Z. M. Z. J. W. Y. Yan, X. Chen, \"Bargaining-based spectrum sharing in cognitive radio network.\"\n[11] J. N. Laneman, D. N. C. Tse, and G. W. Wornell, \"Cooperative diversity in wireless networks: Efficient protocols and outage\nbehavior,\" IEEE Trans. Inform. Theory, vol. 50, no. 12, pp. 3062\u20133080, Dec. 2004.\n[12] O. Simeone, I. Stanojev, S. Savazzi, Y. Bar-Ness, U. Spagnolini, and R. Pickholtz, \"Spectrum leasing to cooperating secondary\nad hoc networks,\" IEEE J. Select. Areas Commun., vol. 26, no. 1, pp. 203\u2013213, Jan. 2008.\n[13] L. Giupponi and C. Ibars, \"Distributed cooperation among cognitive radios with complete and incomplete information,\" EURASIP\nJ. on Advances in Signal Processing, 2009.\n[14] Y. Han, A. Pandharipande, and S. H. Ting, \"Cooperative decode-and-forward relaying for secondary spectrum access,\" IEEE\nTrans. Wireless Commun., vol. 8, no. 10, pp. 4945\u20134950, Oct. 2009.\n[15] C. H. S. He, L. Jiang, \"A novel secondary user assisted relay mechanism in cognitive radio networks with multiple primary\nusers,\" in Proc. IEEE Global Telecommunications Conference (GLOBECOM), Dec. 2012, pp. 1273\u20131277.\n[16] H. Z. Z. Zhang Z, \"A variable-population evolutionary game model for resource allocation in cooperative cognitive relay\nnetworks,\" IEEE Commun. Lett., vol. Early Access Article, Nov. 2013.\n[17] Q. Z. J. Zhang, \"Stackelberg game for utility-based cooperative cognitive radio networks,\" in Proc. of the 10th ACM International\nSymposium on Mobile Ad Hoc Networking and Computing, 2009, pp. 23\u201332.\n\n\f31\n\n[18] H. Xu and B. Li, \"Efficient resource allocation with flexible channel cooperation in ofdma cognitive radio networks,\" in IEEE\nINFOCOM, 2010, Mar. 2010, pp. 1\u201310.\n[19] R. Manna, R. H. Y. Louie, Y. Li, and B. Vucetic, \"Interference cancellation in two hop multiuser cognitive radio networks,\" in\nProc. IEEE Wireless Communications and Networking Conference (WCNC), Sydney, Australia, Apr. 2010.\n[20] R. Manna, , R. H. Y. Louie, Y. Li, and B. Vucetic, \"Cooperative spectrum sharing in cognitive radio networks with multiple\nantennas,\" IEEE Trans. Signal Processing, vol. 59, no. 11, pp. 5509 \u20135522, Nov. 2011.\n[21] J. H. L. Duan, L. Gao, \"Cooperative spectrum sharing: A contract-based approach,\" IEEE Trans. Mobile Comput., vol. Early\nAccess Article.\n[22] B. Wang, Y. Wu, Z. Ji, K. Liu, and T. Clancy, \"Game theoretical mechanism design methods,\" IEEE Trans. Signal Processing,\nvol. 25, no. 6, pp. 74\u201384, Nov. 2008.\n[23] J. Zhu and K. Liu, \"Belief-assisted pricing for dynamic spectrum allocation in wireless networks with selfish users,\" in 3rd\nAnnual IEEE Communications Society on Sensor and Ad Hoc Communications and Networks (SECON), vol. 1, Sep. 2006, pp.\n119 \u2013127.\n[24] A. Roth and M. Sotomayor, Two Sided Matching: a study in game-theoretic modeling and analysis, 1st ed.\n\nUK: Cabridge\n\nUniversity Press., 1989.\n[25] V. Krishna, Auction Theory, 2nd ed.\n\nEngland: Elsevier Inc., 2010.\n\n[26] E. Jorswieck, \"Stable matchings for resource allocation in wireless networks,\" in 17th International Conference on Digital Signal\nProcessing (DSP), Jul. 2011, pp. 1 \u20138.\n[27] Y. Leshem and E. Zehavi, \"Stable matching for channel access control in cognitive radio systems,\" in 2nd International Workshop\non Cognitive Information Processing (CIP), Jun. 2010, pp. 470 \u2013475.\n[28] G. Demange, D. Gale, and M. Sotomayor, \"Multi-item auctions,\" J. Polit. Economy, no. 94, pp. 863\u2013872, 1986.\n[29] S. Bayat, R. H. Y. Louie, Y. Li, and B. Vucetic, \"Cognitive radio relay networks with multiple primary and secondary users:\nDistributed stable matching algorithms for spectrum access,\" in Proc. IEEE International Conference on Communications (ICC),\nKyoto, Japan, Jun. 2011, pp. 1\u20136.\n[30] E. Hossain, D. Niyato, and Z. Han, Dynamic Spectrum Access and Management in Cognitive Radio Networks, 1st ed.\n\nUK:\n\nCabridge University Press., 2009.\n[31] P. Liu, R. Berry, and M. Honig, \"A fluid analysis of a utility-based wireless scheduling policy,\" IEEE Trans. Inform. Theory,\nvol. 52, no. 7, pp. 2872 \u20132889, Jul 2006.\n[32] Z. Jiang, Y. Ge, and Y. Li, \"Max-utility wireless resource management for best-effort traffic,\" IEEE Trans. Wireless Commun.,\nvol. 4, no. 1, pp. 100 \u2013 111, Jan. 2005.\n[33] J. W. Lee, M. Chiang, and A. Calderbank, \"Price-based distributed algorithms for rate-reliability tradeoff in network utility\nmaximization,\" IEEE J. Select. Areas Commun., vol. 24, no. 5, pp. 962 \u2013 976, May 2006.\n[34] D. Niyato and E. Hossain, \"Competitive pricing for spectrum sharing in cognitive radio networks: Dynamic game, inefficiency\nof nash equilibrium, and collusion,\" IEEE J. Select. Areas Commun., vol. 26, no. 1, pp. 192\u2013202, Jan. 2008.\n[35] P. Y. Chen, W. C. Ao, S. C. Lin, and K. C. Chen, \"Reciprocal spectrum sharing game and mechanism in cellular systems with\ncognitive radio users,\" in Proc. IEEE Global Telecommunications Conference (GLOBECOM) Workshops, Dec. 2011, pp. 981\n\u2013985.\n[36] X. Kang, R. Zhang, and M. Motani, \"Price-based resource allocation for spectrum-sharing femtocell networks: A stackelberg\ngame approach,\" IEEE J. Select. Areas Commun., vol. 30, no. 3, pp. 538 \u2013549, Apr 2012.\n[37] Y. Choi, P. Voltz, and F. Cassara, \"On channel estimation and detection for multicarrier signals in fast and selective rayleigh\nfading channels,\" IEEE Trans. Commun., vol. 49, no. 8, pp. 1375\u20131387, Aug 2001.\n\n\f32\n\n[38] Q. Zhao and B. Sadler, \"A survey of dynamic spectrum access,\" IEEE Trans. Inform. Theory, vol. 24, no. 3, pp. 79 \u201389, May\n2007.\n[39] H. Xu, J. Jin, and B. Li, \"A channel portfolio optimization framework for trading in a spectrum secondary market,\" in Proc.\nIEEE International Conference on Communications (ICC), May 2010, pp. 1 \u20135.\n[40] Z. Kong and Y. K. Kwok, \"Relay auction algorithms for downlink bandwidth allocation in IEEE 802.16-based OFDM/TDMA\nwireless mesh networks,\" in Proc. Fourth International Conference on Communications and Networking in China (ChinaCOM),\nAug. 2009, pp. 1 \u20135.\n[41] D. Gusfield and R. W. Irving, The Stable Marriage Problem: Structure and Algorithms. The MIT Press, 1989.\n[42] Cisco. Cisco Aironet 1240AG Series 802.11A/B/G Access Point, 802.11a/b/g datasheet, 2009.\n[43] A. Kan and J. Telgen, \"The complexity of linear programming,\" J. of Statistica Neerlandica, no. 2, pp. 91\u2013107, 1981.\n\n\f"}