{"id": "http://arxiv.org/abs/physics/0402099v3", "guidislink": true, "updated": "2004-10-18T17:08:03Z", "updated_parsed": [2004, 10, 18, 17, 8, 3, 0, 292, 0], "published": "2004-02-19T19:54:46Z", "published_parsed": [2004, 2, 19, 19, 54, 46, 3, 50, 0], "title": "Bayesian Estimation for Land Surface Temperature Retrieval: The Nuisance\n  of Emissivities", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0112052%2Cphysics%2F0112064%2Cphysics%2F0112069%2Cphysics%2F0112060%2Cphysics%2F0402111%2Cphysics%2F0402037%2Cphysics%2F0402119%2Cphysics%2F0402031%2Cphysics%2F0402015%2Cphysics%2F0402005%2Cphysics%2F0402081%2Cphysics%2F0402071%2Cphysics%2F0402066%2Cphysics%2F0402076%2Cphysics%2F0402129%2Cphysics%2F0402008%2Cphysics%2F0402082%2Cphysics%2F0402100%2Cphysics%2F0402078%2Cphysics%2F0402009%2Cphysics%2F0402027%2Cphysics%2F0402059%2Cphysics%2F0402039%2Cphysics%2F0402109%2Cphysics%2F0402052%2Cphysics%2F0402090%2Cphysics%2F0402046%2Cphysics%2F0402068%2Cphysics%2F0402094%2Cphysics%2F0402032%2Cphysics%2F0402104%2Cphysics%2F0402085%2Cphysics%2F0402120%2Cphysics%2F0402108%2Cphysics%2F0402019%2Cphysics%2F0402021%2Cphysics%2F0402029%2Cphysics%2F0402080%2Cphysics%2F0402117%2Cphysics%2F0402036%2Cphysics%2F0402083%2Cphysics%2F0402084%2Cphysics%2F0402053%2Cphysics%2F0402007%2Cphysics%2F0402087%2Cphysics%2F0402004%2Cphysics%2F0402040%2Cphysics%2F0402013%2Cphysics%2F0402064%2Cphysics%2F0402024%2Cphysics%2F0402099%2Cphysics%2F0402130%2Cphysics%2F0402060%2Cphysics%2F0402035%2Cphysics%2F0402075%2Cphysics%2F0402126%2Cphysics%2F0402131%2Cphysics%2F0402016%2Cphysics%2F0402022%2Cphysics%2F0402122%2Cphysics%2F0402058%2Cphysics%2F0402067%2Cphysics%2F0402055%2Cphysics%2F0402101%2Cphysics%2F0402062%2Cphysics%2F0402113%2Cphysics%2F0402072%2Cphysics%2F0402091%2Cphysics%2F0402096%2Cphysics%2F0402002%2Cphysics%2F0402118%2Cphysics%2F0402124%2Cphysics%2F0402093%2Cphysics%2F0402034%2Cphysics%2F0402077%2Cphysics%2F0402023%2Cphysics%2F0402017%2Cphysics%2F0402114%2Cphysics%2F0402018%2Cphysics%2F0402121%2Cphysics%2F0402089%2Cphysics%2F0402116%2Cphysics%2F0402127%2Cphysics%2F0402056%2Cphysics%2F0402025%2Cphysics%2F0402112%2Cphysics%2F0402102%2Cphysics%2F0402103%2Cphysics%2F0402107%2Cphysics%2F0402049%2Cphysics%2F0402048%2Cphysics%2F0402043%2Cphysics%2F0402070%2Cphysics%2F0402133%2Cphysics%2F0402069%2Cphysics%2F0402110%2Cphysics%2F0402106%2Cphysics%2F0402006%2Cphysics%2F0402073%2Cphysics%2F0402011%2Cphysics%2F0402097&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Bayesian Estimation for Land Surface Temperature Retrieval: The Nuisance\n  of Emissivities"}, "summary": "An approach to the remote sensing of land surface temperature is developed\nusing the methods of Bayesian inference. The starting point is the maximum\nentropy estimate for the posterior distribution of radiance in multiple bands.\nIn order to convert this quantity to an estimator for surface temperature and\nemissivity with Bayes' theorem, it is necessary to obtain the joint prior\nprobability for surface temperature and emissivity, given available prior\nknowledge. The requirement that any pair of distinct observers be able to\nrelate their descriptions of radiance under arbitrary Lorentz transformations\nuniquely determines the prior probability. Perhaps surprisingly, surface\ntemperature acts as a scale parameter, while emissivity acts as a location\nparameter, giving the prior probability P(T,emissivity|K)=const./T dT\nd(emissivity). Given this result, it is a simple matter to construct estimators\nfor surface temperature and emssivity. Monte Carlo simulations of land surface\ntemeprature retrieval in selected MODIS bands are presented as examples of the\nutility of the approach.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=physics%2F0112052%2Cphysics%2F0112064%2Cphysics%2F0112069%2Cphysics%2F0112060%2Cphysics%2F0402111%2Cphysics%2F0402037%2Cphysics%2F0402119%2Cphysics%2F0402031%2Cphysics%2F0402015%2Cphysics%2F0402005%2Cphysics%2F0402081%2Cphysics%2F0402071%2Cphysics%2F0402066%2Cphysics%2F0402076%2Cphysics%2F0402129%2Cphysics%2F0402008%2Cphysics%2F0402082%2Cphysics%2F0402100%2Cphysics%2F0402078%2Cphysics%2F0402009%2Cphysics%2F0402027%2Cphysics%2F0402059%2Cphysics%2F0402039%2Cphysics%2F0402109%2Cphysics%2F0402052%2Cphysics%2F0402090%2Cphysics%2F0402046%2Cphysics%2F0402068%2Cphysics%2F0402094%2Cphysics%2F0402032%2Cphysics%2F0402104%2Cphysics%2F0402085%2Cphysics%2F0402120%2Cphysics%2F0402108%2Cphysics%2F0402019%2Cphysics%2F0402021%2Cphysics%2F0402029%2Cphysics%2F0402080%2Cphysics%2F0402117%2Cphysics%2F0402036%2Cphysics%2F0402083%2Cphysics%2F0402084%2Cphysics%2F0402053%2Cphysics%2F0402007%2Cphysics%2F0402087%2Cphysics%2F0402004%2Cphysics%2F0402040%2Cphysics%2F0402013%2Cphysics%2F0402064%2Cphysics%2F0402024%2Cphysics%2F0402099%2Cphysics%2F0402130%2Cphysics%2F0402060%2Cphysics%2F0402035%2Cphysics%2F0402075%2Cphysics%2F0402126%2Cphysics%2F0402131%2Cphysics%2F0402016%2Cphysics%2F0402022%2Cphysics%2F0402122%2Cphysics%2F0402058%2Cphysics%2F0402067%2Cphysics%2F0402055%2Cphysics%2F0402101%2Cphysics%2F0402062%2Cphysics%2F0402113%2Cphysics%2F0402072%2Cphysics%2F0402091%2Cphysics%2F0402096%2Cphysics%2F0402002%2Cphysics%2F0402118%2Cphysics%2F0402124%2Cphysics%2F0402093%2Cphysics%2F0402034%2Cphysics%2F0402077%2Cphysics%2F0402023%2Cphysics%2F0402017%2Cphysics%2F0402114%2Cphysics%2F0402018%2Cphysics%2F0402121%2Cphysics%2F0402089%2Cphysics%2F0402116%2Cphysics%2F0402127%2Cphysics%2F0402056%2Cphysics%2F0402025%2Cphysics%2F0402112%2Cphysics%2F0402102%2Cphysics%2F0402103%2Cphysics%2F0402107%2Cphysics%2F0402049%2Cphysics%2F0402048%2Cphysics%2F0402043%2Cphysics%2F0402070%2Cphysics%2F0402133%2Cphysics%2F0402069%2Cphysics%2F0402110%2Cphysics%2F0402106%2Cphysics%2F0402006%2Cphysics%2F0402073%2Cphysics%2F0402011%2Cphysics%2F0402097&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "An approach to the remote sensing of land surface temperature is developed\nusing the methods of Bayesian inference. The starting point is the maximum\nentropy estimate for the posterior distribution of radiance in multiple bands.\nIn order to convert this quantity to an estimator for surface temperature and\nemissivity with Bayes' theorem, it is necessary to obtain the joint prior\nprobability for surface temperature and emissivity, given available prior\nknowledge. The requirement that any pair of distinct observers be able to\nrelate their descriptions of radiance under arbitrary Lorentz transformations\nuniquely determines the prior probability. Perhaps surprisingly, surface\ntemperature acts as a scale parameter, while emissivity acts as a location\nparameter, giving the prior probability P(T,emissivity|K)=const./T dT\nd(emissivity). Given this result, it is a simple matter to construct estimators\nfor surface temperature and emssivity. Monte Carlo simulations of land surface\ntemeprature retrieval in selected MODIS bands are presented as examples of the\nutility of the approach."}, "authors": ["J. A. Morgan"], "author_detail": {"name": "J. A. Morgan"}, "author": "J. A. Morgan", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1109/TGRS.2005.845637", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/physics/0402099v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/physics/0402099v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "Table 3 has been replaced, and the discussion in Section IV has been\n  revised, to reflect corrected Monte Carlo simulations. Text revised and\n  corrected in light of comments by referees, others", "arxiv_primary_category": {"term": "physics.data-an", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.data-an", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.ao-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.geo-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/physics/0402099v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/physics/0402099v3", "journal_reference": "IEEE Transactions on Geoscience and Remote Sensing 43, p. 1279\n  (June 2005)", "doi": "10.1109/TGRS.2005.845637", "fulltext": "1\n\narXiv:physics/0402099v3 [physics.data-an] 18 Oct 2004\n\nBayesian Estimation for Land Surface Temperature\nRetrieval: The Nuisance of Emissivities\nJ. A. Morgan\nThe Aerospace Corporation\nP. O. Box 92957\nLos Angeles, CA 90009\nAbstract- An approach to the remote sensing of land\nsurface temperature is developed using the methods of\nBayesian inference. The starting point is the maximum entropy estimate for the posterior distribution of radiance in\nmultiple bands. In order to convert this quantity to an estimator for surface temperature and emissivity with Bayes'\ntheorem, it is necessary to obtain the joint prior probability\nfor surface temperature and emissivity, given available prior\nknowledge. The requirement that any pair of distinct observers be able to relate their descriptions of radiance under\narbitrary Lorentz transformations uniquely determines the\nprior probability. Perhaps surprisingly, surface temperature\nacts as a scale parameter, while emissivity acts as a location\nparameter, giving the prior probability\n\nP (T, \u01eb | K) =\n\nconst\ndT d\u01eb\nT\n\nGiven this result, it is a simple matter to construct estimators for surface temperature and emissivity. A Monte Carlo\nsimulation of land surface temperature retrieval in selected\nMODIS bands is presented as an example of the utility of\nthe approach.\nKeywords- Remote Sensing, Land Surface Temperature,\nSea Surface Temperature.\n\nII. The Temperature-Emissivity Separation\nProblem amd its Discontents\nIncreasingly capable remote sensing technology has\nsparked interest in exploiting thermal emission from surfaces both for remote sensing of surface temperature and\nof emissivity. On the one hand, surface temperature studies\nform a significant portion of the science goals of MODIS,\nASTER, and MTI, while AVHRR has been used operationally for sea surface and land surface temperature studies for many years. On the other, the use of emissivity\ninformation in thermal portions of the spectrum for geological remote sensing has grown rapidly in recent years,\nand is as prominent in the science goals of MODIS and\nsimilar instruments as is surface temperature.\nAccordingly, the problem of temperature-emissivity separation merits close examination. The entirety of the information about a radiating surface comes from the thermal radiation it emits, conventionally parameterized as the\nproduct of blackbody radiation at the surface temperature\nT and the emissivity \u01ebk ,\nIs = \u01ebk Bk (T )\n\nI. Introduction\n\nT\n\nHIS paper derives the joint prior probability for surface temperature and emissivity for the land surface temperature retrieval problem in remote sensing. It\npresents analysis necessary for formulating a Bayesian approach to that problem, together with a Monte Carlo simulation of land surface temperature (LST) and surface emissivity extractions.\nAfter a brief description of the problem and the method\nof attack, the maximum entropy estimator for the mismatch between sensed and forward model radiance is given.\nNext, the joint prior probability for surface temperature\nand emissivity is obtained. This quantity is required in\norder to construct a useable estimator for surface temperature and emissivity. With the prior probability in hand,\nit is a simple matter to construct expressions for the expected values of surface temperature and emissivity consistent with sensor aperture radiances and available prior\nknowledge. Finally, a sample temperature-emissivity separation is presented using MODTRAN calculations both for\nthe forward model and for simulated sensor radiances.\nc 2004 The Aerospace Corporation\n\n(1)\n\nat each wavenumber k. Suppose one observes a radiating patch of a surface at each of n wavenumber intervals,\nand that one knows how to correct for the effects of lineof-sight (LOS) attenuation and contamination by radiance\nfrom other sources. One then has n equations of the form\n(1), but n+1 unknowns, including the surface temperature.\nIn the absence of knowledge about T or \u01ebk from extraneous\nsources, one has an underdetermined problem.\nA variety of methods has been proposed for handling the\ntemperature-emissivity separation (TES) problem[1]. In\nmost approaches to this problem, simultaneous LST and\nband emissivity retrieval depends upon specifying an emissivity value in one or more reference bands. The MODIS\nLand Surface Temperature (LST) algorithm[2] seeks a\npair of reference channels in a part of the thermal spectrum in which the emissivity of natural surfaces displays\nvery limited variation, and may therefore be regarded as\nknown with good confidence. Multiband emissvities inferred on this basis are called \"relative\" emissivities[3]. Algorithms using this approach include the reference channel\nmethod[4] and emissivity normalization[5]. In the former,\na value of emissivity is assumed for one band, and in the\nlatter, an approximate surface temperature is obtained by\n\n\f2\n\nnoting that emissivity cannot exceed unity, in order to close\nthe system of equations. Other relative emissivity retrieval\nmethods include the temperature-independent spectral index method[6],[7] and spectral ratios[8]. The study by Li\net al.[3] shows that all of these relative emissivity retrieval\nalgorithms are closely related, and argues that they may\nbe expected to show comparable performance. A different\napproach has been proposed for analysis of Multispectral\nThermal Imager (MTI) data[9], in which radiances are collected from a surface with looks at nadir and 60 degrees\noff-nadir, assuming a known angular dependence of emissivity, in order to balance equations and unknowns. The\ngeneralized split-window LST algorithm[10] likewise uses\ndual looks in a regression-law based approach. The basis of the \"grey body emissivity\" approach[11] is the slow\nvariation of emissivity with wavelength for certain natural targets. The physics-based MODIS LST algorithm[12]\nexploits observations taken at day and at night, on the assumption that band emissivites do not change over periods\nof a few weeks.\nIt is clear that the methods described depend upon a\npriori assumptions about the variation of emissivity, either with wavelength, or with look angle, or over time,\nfrom which one would like to be free. The work described\nin this paper uses Bayesian inference to retrieve estimates\nof surface parameters. This approach allows one to treat\nemissivities as \"nuisance\" parameters which may be integrated out of a posterior distribution function between parsimoniously chosen, and hence \"uninformative,\" limits.\nIt might appear odd to use as an approach to the separation of temperature and emissivity a Bayesian estimator\nwhich, in essence, allows one to ignore the actual value of\nemissivity. Equation (1) shows that thermal radiance is\nlinear in emissivity. However, the Planck function goes as\na fairly high power of the temperature in the LWIR, and\nis close to exponential in temperature in the MWIR. Any\nroughness in the treatment of sensed radiance-as in allowing the assumed emissivity in the estimator to take on a\nwide range of values-may, therefore, be expected to lead to\ncomparatively small errors in the inferred surface temperature. In fact, it turns out that the posterior distribution\nfor surface temperature to be developed gives sharp limits\nto allowable surface temperature even in the presence of\nconsiderable latitude in the value of possible emissivities.\nIn most cases, only a narrow range of surface temperature\nis consistent with the sensed radiance in multiple bands,\nwhatever be assumed about emissivity.\nOnce a reasonably good estimate of surface temperature\nis in hand, it is a simple matter to insert it into estimators\nfor the individual band emissivities, and for the uncertainty\nin those values consistent with available knowledge. The\na priori limits on emissivity may then be contracted, and\na new estimate of surface temperature obtained. The expectation values of surface temperature and emissivity may\nthus be refined iteratively. It is also possible to search for a\n(local) maximum for the posterior likelihood for these parameters. Because the TES problem is underdetermined,\n\nthis will not give a unique global maximum, but, given\nthe insensitivity of surface temperature estimates to small\nemissivity errors, the local maximum may be expected to\ngive results close to the physical values for the parameters\nof interest.\nIII. Maximum Entropy Estimators for Surface\nParameters\nConsider the problem of estimating surface temperature\nand emissivity from radiance detected by a remote sensor. The sensor supplies measurements of radiance I at\nthe aperture. A forward model is required to compute the\nvalue of aperture radiance as a function of, among other\nthings, the parameters we wish to extract. Assume initially (for simplicity) that the sensor has fine spectral resolution. The forward model radiance may be described at\neach wavenumber k by a form of the Duntley equation [13]\n\u03c1k\n\u03c4k\n\u03c4k\nIF (k) = \u01ebk Bk (T )exp(\u2212 ) + Fk\u2193 (0)exp(\u2212 ) + Ik\u2191 (\u03c4, \u03bc)\n\u03bc\n\u03c0\n\u03bc\n(2)\nIk\u2191 (\u03c4, \u03bc) and Fk\u2193 (0) are the upwelling diffuse radiance at\nnadir optical depth \u03c4 (top of the atmosphere, or TOA, for\nspaceborne sensors; \u03bc is the cosine of the angle with respect\nto zenith) and the downwelling irradiance at the surface,\nrespectively. Bk (T ) is the Planck function at surface temperature T . The emissivity is \u01ebk , and the surface reflectance\n\u03c1k = 1\u2212\u01ebk . The form of (2) is what one would get assuming\na Lambertian surface obeying Khirchoff's law. The analysis presented below does not depend upon a Lambertian\napproximation to surface reflectances; in fact, it makes no\nassumption regarding their angular behavior [14]. In what\nfollows it will be assumed that the only unknown quantities in the preceding equation are T and \u01ebk . Generalization\nof the analysis which follows to the case of reflectance not\nequal to one minus the emissivity poses no difficulties.\nAn estimator for the probability that, given observed\nradiances I(k), the surface parameters T and \u01ebk take\non particular values, is constructed in the following way\n[15],[16],[17], (vide. also a related discussion in Landau\nand Lifschitz[18], pp. 343-5). The posterior probability for\nT and \u01ebk is given by Bayes' theorem as\nP (T, \u01ebk | I, K) = P (T, \u01ebk | K)\n\nP (I | T, \u01ebk , K)\nP (I | K)\n\n(3)\n\nwhere K denotes available knowledge. The quantity P (I |\nK), the prior probability of the radiance I, may be absorbed into an overall normalization and does not concern\nus further. It may be that the surface T is of interest,\nwhatever the value of emissivity. In this case, one is free\nto denigrate \u01ebk as a \"nuisance\" parameter and integrate it\nout of (3), as will be done below.\nConsider the remaining factors in (3) in turn, starting\nwith the direct probability P (I | T, \u01ebk , K) of observing radiance I given T , \u01ebk , and other a priori knowledge K.\nWith aid of the forward model, it is possible to recast this\nquantity in more tractable form. By hypothesis,\nI(k) = IF (k) + ek\n\n(4)\n\n\f3\n\nwhere the error in spectral radiance ek is attributed to\nnoise processes. The prior probability for the noise P (ek |\nT, \u01ebk , K) is now obtained by a maximum entropy argument.\nIf the noise power is assumed known, the noise probability\nis the function which maximizes the information-theoretic\nentropy subject to constraints imposed by the value of the\nnoise power and overall normalization of probability,\nZ +\u221e\nS=\u2212\nP (e | K)log(P (e | K))de \u2212\n\nand assigning the prior probability\ng(T \u2032 , \u01eb\u2032 )dT \u2032 d\u01eb\u2032\n\nIn order for the pair to agree as to the form of the estimator,\nthe priors must be related by\ng(T \u2032 , \u01eb\u2032 )dT \u2032 d\u01eb\u2032 = J \u22121 f (T, \u01eb)dT d\u01eb\nwhere\n\n\u2212\u221e\n\n\u03bb1\n\nZ\n\n+\u221e\n\n\u2212\u221e\n\ne2 P (e | K)de \u2212 \u03bb2\n\nZ\n\n+\u221e\n\n\u2212\u221e\n\nP (e | K)de.\n\nThe function maximizing (5) is a Gaussian,\n\u0014\n\u0015\ne2\n1\nexp \u2212 2\nP (e | K) = \u221a\n2\u03c3\n2\u03c0\u03c3\n\n(5)\n\n(6)\n\nwhere the Lagrange multipliers for noise power and normalization have been written in terms of the RMS noise\nradiance \u03c3. Upon substituting (4) for the noise term, the\nprobability of detecting a radiance I given T , \u01eb, and noise\n\u03c3 becomes\n\u0014\n\u0015\n(I \u2212 IF )2 dI\nP (I | T, \u01eb, \u03c3) = exp \u2212\n(7)\n2\u03c3 2\n\u03c3\nThis is also the likelihood function for T and \u01eb. In order to\nformulate an estimator for T and \u01eb, it remains to find the\nprior probability\nP (T, \u01eb | K) = f (T, \u01eb)dT d\u01eb\n\n(8)\n\n(The appropriate prior for noise is known to be the Jeffreys\nform, but is omitted here because it is assumed that the\nnoise contribution is known.)\nWe now follow Jaynes' prescription for finding an uninformative prior probability[19],[20],[21]. Assume two equivalent observers record the same sensor aperture radiance\noriginating as thermal radiation from a surface, and interpret it in terms of Planckian emission characterized by a\nsurface temperature and emissivities, subject to LOS attenuation. Vladimir detects surface thermal emission I in\na solid angle \u03a9, and describes the surface with parameters\nT and \u01eb, and the attenuation with optical depth \u03bc\u03c4 :\n\u03c4k\nI = \u01ebk Bk (T )exp(\u2212 )\n\u03bc\n\n(9)\n\nHe assigns prior probability in light of his knowledge regarding the problem\nf (T, \u01eb)dT d\u01eb\n\n(10)\n\nOn the other hand, Estragon agrees with Vladimir on the\ndefinition of the Planck function, emissivity, and LOS attenuation, but describes the same situation with surface\n\u2032\nemission I \u2032 in \u03a9', and parameters T \u2032 , \u01eb\u2032 , and \u03bc\u03c4 \u2032 , reporting\nI\u2032 =\n\n\u03c4\u2032\u2032\n\u01eb\u2032k\u2032 Bk\u2032 (T \u2032 )exp(\u2212 k\u2032\n\u03bc\n\n)\n\n(11)\n\n(12)\n\n\u2202(T \u2032 , \u01eb\u2032 )\nJ = det\n\u2202(T, \u01eb)\n\u0014\n\n\u0015\n\n(13)\n\n(14)\n\nis the Jacobian determinant for the transformation between\ndescriptions in the parameter space.\nAssuming both are sober, Vladimir and Estragon must\nalways be able to relate their descriptions of the sensed radiance by a Lorentz transformation. Let us consider active\ntransformations for concreteness. Suppose that Vladimir\nwishes to describe events in a frame of reference moving\nat velocity \u03b2 = v/c along the observation axis, denoted\nx, with respect to the frame preferred by Estragon. (It\nis convenient, although not actually necessary, to suppose\nthat the x axis is also the axis of photon propagation.)\nLorentz invariance requires that Vladimir's (unprimed) and\nEstragon's (primed) description of events be invariant under the Lorentz transformation given by\n\nwhere\n\nx\u2032 = \u03b3(x \u2212 \u03b2ct)\n\n(15)\n\nt\u2032 = \u03b3(t \u2212 \u03b2x/c)\n\n(16)\n\n1\n.\n\u03b3= p\n1 \u2212 \u03b22\n\n(17)\n\nThe four-momentum of a photon travelling along the x-axis\nis\n\uf8f6\n\uf8eb\nh\u0304k/c\n\uf8ec h\u0304k \uf8f7\n\uf8f7\n(18)\np=\uf8ec\n\uf8ed 0 \uf8f8.\n0\nApplying (15) and (16) to the components of (18), we see\nthat Estragon and Vladimir relate their description of frequency or wavenumber by\nk \u2032 = \u03b3(1 \u2212 \u03b2)k\n\u2261 \u03b7k.\n\n(19)\n\nHow does the pair relate their descriptions of radiance?\nLet a bundle of \u03b4n photons with mean energy p0 = h\u0304ck\nand uncertainty \u03b4p0 = h\u0304c\u03b4k originate in a small area \u03b4A of\nthe radiating surface in a small time interval \u03b4t, collimated\nwithin a small solid angle \u03b4\u03a9, and propagate unattenuated to an observer. The surviving photons arriving at the\nobserver's location comprise a collisionless photon gas. A\nsingle photon in the bundle occupies a phase space volume\nVx \u00d7 Vk = \u03b4A(c\u03b4t) \u00d7 h\u03043 k 2 \u03b4k\u03b4\u03a9\n\n(20)\n\nwhile the bundle occupies a 6 \u03b4n-dimensional phase space\nvolume\nVphase = [Vx Vk ]\u03b4n .\n(21)\n\n\f4\n\nEquation (21) is invariant at any point on a photon trajectory. According to a standard result in statistical physics,\nLiouville's theorem ([18], pp. 9-10; 178), it has the same\nvalue at every point on that trajectory. So long as the\nphotons remain collisionless they can neither leave their\noriginal volume of phase space, nor enter another. However Vladimir or Estragon choose to describe the patch of\nemitting surface \u03b4A, the time interval \u03b4t, the solid angle\ninterval \u03b4\u03a9 or the photon wavenumber k, they must agree\nas to the number of photons \u03b4n in the bundle. Hence, both\n(20) and the ratio\n\u03b4n\n\u03b4n\n= 3\nN=\nVx Vk\nh\u0304 \u03b4A\u03b4tk 2 \u03b4k\u03b4\u03a9\n\nd(energy)\n.\nd(time)d(area)d(f requency)d(solidangle)\n\nBk (T \u2032 /\u03b7)\n\u01ebk\n= \u2032\nBk (T )\n\u01eb\u03b7k\n\nthe right-hand side can have no dependence upon T or T \u2032 ,\nwhile the left-hand side cannot be an arbitrary function of\n\u03b7 or k. The only remaining possibility is\n\n(22)\n\n(23)\n\nThe set of Lorentz transformations forms a group[24], so\nthis relation holds for the identity with \u03b2 = 0, \u03b3 = \u03b7 = 1.\nThe constant must therefore equal unity.\nNext allow \u03c4 to differ from zero in (28). In\nexp(\u2212 \u03c4\u03bck )\nk 3 \u01eb\u2032k\u2032 Bk\u2032 (T \u2032 )\n=\n\u03c4\u2032\nk \u20323 \u01ebk Bk (T )\nexp(\u2212 \u03bck\u2032\u2032 )\n\nRewriting the radiance as\nIk =\n\nh\u0304k\u03b4n\n= h\u03044 k 3 N,\n\u03b4A\u03b4t\u03b4k\u03b4\u03a9\n\n(24)\n\ngives\n\nIk\n= invariant\n(25)\nk3\nfor any component of the total radiance along a given line\nof sight[22]. Equation (25) has the same value in any frame\nof reference[23], with two consequences for this problem:\n1. The Planck function obeys\nB\u03b7k (\u03b7T )\n= Bk (T )\n\u03b73\n\n1\nk3\ni\ni.\nh\nh\n2\n\u03c0 exp h\u0304ck \u2212 1\n\nk 3 \u01eb\u2032\u03b7k Bk\u2032 (T \u2032 )\n\u01eb\u2032 \u2032 B\u03b7k (\u03b7T )\n= k 3\n=1\n\u20323\nk \u01ebk Bk (T )\n\u01ebk \u03b7 Bk (T )\nor\n\n\u01ebk Bk (T )exp(\u2212 \u03c4\u03bck )\n\nexp(\u2212 \u03c4\u03bck )\n\u03c4\u2032\n\n=1\n\n(36)\n\n(37)\n\nLOS attenuation does not affect the validity of (34).\nThus, the most general relation which respects a Lorentz\ntransformation carrying wavenumber k to k \u2032 = \u03b7k is\n(27)\n\n2. Vladimir and Estragon must agree that the attenuated\nsurface emission obeys\n)\n\n(35)\n\nexp(\u2212 \u03bck\u2032\u2032 )\n\nkB T\n\n\u03c4\u2032\n\u01eb\u2032k\u2032 Bk\u2032 (T \u2032 )exp(\u2212 \u03bck\u2032\u2032\nk \u20323\n\n(34)\n\nthe left-hand side has, by hypothesis, no dependence upon\nLOS transmission, while the right-hand has no dependence\nupon surface properties so, again, both sides equal a constant, and, from (26) and (34), we find\n\n(26)\n\nas may also be seen by direct substitution in\nBk (T ) =\n\n(33)\n\nBk (T \u2032 /\u03b7)\n\u01ebk\n= \u2032 = const.\nBk (T )\n\u01eb\u03b7k\n\nare invariant along a photon trajectory.\nSpectral radiance is defined as\nIk \u2261\n\nNow, Vladimir and Estragon also agree that, while they\nmust lie between 0 and 1, emissivities are otherwise completely arbitrary functions of wavenumber, and by hypothesis have no dependence upon temperature. In\n\nT \u2032 = \u03b7T\n\n(38)\n\n\u01eb\u2032k\u2032 = \u01eb\u2032\u03b7k = \u01ebk .\n\n(39)\n\nThe Jacobian is therefore\nJ =\u03b7\n\n(40)\n\nConsider first the case of no attenuation, \u03c4 = 0. Then\n\nf (T, \u01ebk ) = \u03b7g(\u03b7T, \u01eb\u2032\u03b7k ).\n\n(41)\n\n\u01ebk Bk (T )\n\u01eb\u2032k\u2032 Bk\u2032 (T \u2032 )\n=\nk \u20323\nk3\n\n(29)\n\nInvocation of the principle of indifference1 to assert Estragon and Vladimir must use the identical description of\nevents, and thus assign the same prior probabilities,\n\n\u01eb\u2032k\u2032 Bk\u2032 (T \u2032 ) = \u03b7 3 \u01ebk Bk (T ).\n\n(30)\n\nf (T, \u01eb) = g(T, \u01eb)\n\n=\n\nk3\n\n(28)\nand\n\nor\nOne also has, from (26),\n\u2032\n\nleads to the functional equation\n3\n\n\u2032\n\nB\u03b7k (T ) = \u03b7 Bk (T /\u03b7).\n\n(31)\n\nCombining (19), (30), and (31) gives\n\u01eb\u2032k\u2032 Bk (T \u2032 /\u03b7)\n\n(42)\n\n= \u01ebk Bk (T ).\n\nf (T, \u01ebk ) = \u03b7f (\u03b7T, \u01ebk ).\n1 As\n\n(32)\n\n(43)\n\ngiven by Jaynes[19], p. 128, in an extension of the original\nconcept introduced by Laplace to encompass indifference between descriptions by distinct but equally cogent observers.\n\n\f5\n\nThe solution of (43) is\nconst.\nf (T, \u01eb) =\nT\n\n\u2261\n(44)\n\nIt is always possible to do this by the mean value theorem for integrals, and it is frequently the case that the\nright-hand side of (46) expresses all available knowledge\nconcerning the radiant properties of the emitting surface.\nVladimir describes the surface emission by\nZ k2\nZ k2\n\u03c4k\n\u03c4k\n\u01ebk Bk (T )exp(\u2212 )dk (47)\nBk (T )exp(\u2212 )dk =\n\u01ebi\n\u03bc\n\u03bc\nk1\nk1\nwith\n\u01ebk =\n\n\uf8f1\n\uf8f2\n\n0, k < k1\n\u01ebi , k1 \u2264 k \u2264 k2\n\uf8f3\n0, k > k2\n\nwhile, by (37)-(39), Estragon describes things by\nZ \u03b3k2\n\u03c4\u2032\u2032\n\u01eb\u2032k\u2032 Bk\u2032 (\u03b3T )exp(\u2212 k\u2032 )dk \u2032\n\u03bc\n\u03b3k1\n\nZ\n\n\u03b3k2\n\nBk\u2032 (\u03b3T )exp(\u2212\n\n\u03b3k1\n\n\u03c4k\u2032 \u2032\n)dk \u2032\n\u03bc\u2032\n\n(48)\n\nwith\n\nyielding\n\nconst.\nf (T, \u01eb)dT d\u01eb =\ndT d\u01eb\n(45)\nT\nfor the prior probability.\nOne now argues this form of the prior is least informative\nas to emissivity. No functional dependence upon a parameter should enter the form of the prior probability that is\nnot imposed by the requirements of invariance and indifference. Any such dependence would amount to the admission\nthat we possess additional knowledge about emissivity beyond that assumed. That is, (45) is the unique choice of\nprior probability that assumes nothing about the value of\n\u01ebk beyond what is dictated by the problem statement. A\nstandard argument (found, for example, in [15], pp. 9-15)\nthen shows that prior knowledge about limits on the value\nof emissivity should appear in the limits of integration used\nin constructing marginal distributions for T .\nSurface temperature thus obeys the Jeffreys prior, while\nemissivity obeys the Bayes prior. Both results may appear\nsomewhat surprising, especially that for emissivity. From\nthe manner in which it appears in the expression for radiance, one's naive expectation might be that emissivity is\na scale parameter. However, the relation between the description of emissivity as seen by Vladimir and Estragon\nmore resembles what one would expect of a location parameter: They must agree on the value of emissivity, but\nare free to assign it to different wavenumbers.\nThe result just obtained will now be extended to the situation in which radiance is sensed in bands wide enough\nthat that it cannot be regarded as a function of wavenumber, but must be treated as an integral over a passband.\nOne then writes, for the contribution of surface emission\nto the total radiance at the sensor aperture in band i,\nZ k2\nZ k2\n\u03c4k\n\u03c4k\nBk (T )exp(\u2212 )dk (46)\n\u01ebk Bk (T )exp(\u2212 )dk \u2261 \u01ebi\n\u03bc\n\u03bc\nk1\nk1\n\n\u01eb\u2032i\n\n\uf8f1\n\uf8f2\n\n0, k \u2032 < \u03b3k1\n=\n\u01ebi , \u03b3k1 \u2264 k \u2032 \u2264 \u03b3k2\n\uf8f3\n0, k \u2032 > \u03b3k2\n\n\u01eb\u2032k\u2032\n\nComparison of the two expressions for surface emission,\n(47) and (48), leads to the immediate conclusion that the\nJacobian connecting the two descriptions of surface temperature and band emissivity is\n\u0015\n\u0014\n\u2202(T \u2032 , \u01eb\u2032 )\n= \u03b3,\n(49)\nJ = det\n\u2202(T, \u01eb)\nand\nf (T, \u01eb)dT d\u01eb =\n\nconst.\ndT d\u01eb\nT\n\n(50)\n\nonce more.\nThe result just obtained allows us to derive estimators\nfor surface temperature and emissivity. The starting point\nis a calculation of the marginal posterior probability for T\ngiven observed radiance in a finite number of bands when\nthe surface emissivity in band i is known to lie between\n\u01ebmin (i) and \u01ebmax (i). This quantity is computed for each\nband by integrating (3) between these limits, upon inserting (7) and (45). Evaluating the integral requires completing the square in the exponent of (7). To accomplish this,\ndefine auxilliary quantities a, b, and c, obtained from (2):\n\"Z \u0012\n#2\n\u0013\nk2\n1 \u2193\n\u03c4k\na=\nBk (T ) \u2212 Fk (0) exp(\u2212 )dk ,\n(51)\n\u03c0\n\u03bc\nk1\nb = b1 b2\n\n(52)\n\nwith\nb1 = 2\n\n\"Z\n\nk2\n\nk1\n\nb2 =\n\n\"Z\n\nk2\n\nk1\n\n\u0012\n\n#\n\u0012\n\u0013\n1 \u2193\n\u03c4k\nBk (T ) \u2212 Fk (0) exp(\u2212 )dk\n\u03c0\n\u03bc\n\n(53)\n\n#\n\u0013\n\u03c4k\n1 \u2193\n\u2191\nF (0)exp(\u2212 ) + Ik (\u03c4, \u03bc) dk \u2212 Ii ,\n\u03c0 k\n\u03bc\n(54)\n\nand\nc=\n\n\"Z\n\nk2\nk1\n\n\u0012\n\n#2\n\u0013\n1 \u2193\n\u03c4k\n\u2191\n(55)\nF (0)exp(\u2212 ) + Ik (\u03c4, \u03bc) dk \u2212 Ii\n\u03c0 k\n\u03bc\n\nThen (dropping subscript i for the moment) (3) and (7)\ngive\n\u0014\n\u0015\n(a\u01eb2 + b\u01eb + c)\n1\nexp \u2212\n(56)\nP (T, \u01eb | I, \u03c3) \u221d \u221a\n2\u03c3 2\n2\u03c0\u03c3\nThe marginal distribution obtained by integrating over the\nnuisance parameter \u01eb is\n\u0015\nZ \u01ebmax \u0014\n(a\u01eb2 + b\u01eb + c)\n1\nd\u01eb (57)\nexp \u2212\nP (T | I, \u03c3) \u221d \u221a\n2\u03c3 2\n2\u03c0\u03c3 \u01ebmin\n\n\f6\n\nCompleting the square in the exponent allows this to be\nwritten as\n\" \u0002\n\u0003#\nc \u2212 b2 /4a\n1\nH(\u01ebmax , \u01ebmin ) (58)\nP (T | I, \u03c3) \u221d \u221a exp \u2212\na\n2\u03c3 2\nwhere\n#\n\"p\na/2(\u01ebmax + b/2a)\nH(\u01ebmax , \u01ebmin ) = erf\n\u03c3\n\"p\n#\na/2(\u01ebmin + b/2a)\n\u2212erf\n\u03c3\nfor each band i. In (59) the error function is\nZ x\n\u0001\n2\nerf (x) = \u221a\nexp \u2212t2 dt\n\u03c0 0\n\n(59)\n\n(60)\n\nThe joint posterior probability for observing radiances\nIi , i = 1, n is\nP (T | Ii,i=1,n , \u03c3) =\n\nn\nY\n\ni=1\n\nP (T | Ii , \u03c3).\n\n(61)\n\nAssuming T is known to lie between a minimum and a\nmaximum, an estimator for T given radiance in band i is\nR Tmax\nT P (T | Ii , \u03c3) dT\nT\nhT i = RTmin\n(62)\nTmax\ndT\nP\n(T\n|\nI\n,\n\u03c3)\ni\nT\nTmin\nwhile a joint estimator for T given radiances in all n bands\nis\nR Tmax\nT P (T | Ii,i=1,n , \u03c3) dT\nT\n(63)\nhT i = RTmin\nTmax\ndT\nP\n(T\n|\nI\n,\n\u03c3)\ni,i=1,n\nT\nTmin\n\nAn estimator for the emissivity in band i is given by\nR \u01ebmax\n\u01ebP (hT i, \u01eb | Ii , \u03c3)d\u01eb\nh\u01ebi i = R\u01ebmin\n(64)\n\u01ebmax\nP (hT i, \u01eb | Ii , \u03c3)d\u01eb\n\u01ebmin\n\nThis form has the advantage that estimates of the surface\nT are significantly less sensitive to discrepancies between\nsensed and modeled radiances than are estimates of emissivity. An estimate of T obtained from (58)-(63) with uninformative limits on emissivity may be close enough in\npractice for accurate emissivity retrievals by (64). (Equation (64) may be evaluated in closed form with elementary\nfunctions; however, the resulting expression is quite cumbersome and is omitted here.)\nIV. Monte Carlo Simulation of MODIS Land\nSurface Temperature Retrieval\nA land surface temperature retrieval algorithm has been\ndeveloped using the results just derived. While the intent\nof the work reported in this paper is to unshackle LST\nestimation from emissivity knowledge, the algorithm also\nretrieves emissivity estimates, and may be thought of as a\nTES algorithm if desired. It is intended to illustrate the\n\napplication of Bayesian analysis to thermal remote sensing,\nand is purported to be optimal neither in execution speed\nnor accuracy. The requirement for only one forward model\ncalculation per retrieval suggests that it will not impose an\nextreme computational burden in practice (even though the\nforward model to be described requires two MODTRAN\ncalculations). The algorithm is used to simulate LST retrieval from a notional exoatmospheric sensor that records\nradiance from a patch of the Earth's surface at a specified\nsignal-to-noise ratio(SNR). It is assumed that the dominant noise contribution arises from the shot noise of the\nradiance incident upon the sensor aperture.\nIn outline, the algorithm works as follows. Equation\n(58) gives the distribution of surface temperature consistent with observed radiances and the initial range of emissivities. This distribution typically differs from zero only\nwithin a narrow range about the true surface temperature.\nWithin this range, (63) is used for each of n bands and\nfor all bands jointly to compute n + 1 separate estimates\nof the surface temperature. The actual surface temperature is assumed to lie between the extreme values of this\nset of expected values, which now determine the allowable\nrange. The joint temperature distribution and the various\nexpectation values for surface temperature are next refined\nusing the contracted range of a-priori credible surface temperatures in (58), now calculated with a finer temperature\nmesh. After a few iterations of this procedure, the different surface temperature expectation values obtained from\n(62) and (63) reliably converge to a single value lying close\nto the true surface temperature. A convergence radius \u03b7\nfor the different estimates of 0.01 K was used. Emissivities\nare then obtained by substitution of the joint surface temperature estimate into the expression for band emissivity\nexpectation values, (64). Equation (56) being a Gaussian\ndistribution, it is possible to refine the a-priori limits on\ncredible emissivites by specifying a threshold of m standard deviations. Six is used for the examples presented\nhere. The revised a-priori emissivity limits and surface\ntemperature limits may then be used to restart the entire\nsequence just outlined, if desired. This additional iterative loop was repeated once in the simulation presented\nhere. Surface temperature and emissivity values show only\nmarginal changes as a result of the second iteration, indicating convergence of the retrieval.\nThe starting point is the posterior distribution for surface temperature (58). To compute it, the coefficients a(T ),\nb(T ), and c are obtained as a function of surface temperature. Isaacs two-stream MODTRAN4 calculations with\nSALB=1.0 supply those forward-model spectral quantities\nindependent of surface temperature: Attenuation along the\nline-of-sight, downwelling radiance at the surface, and upwelling radiance at TOA. The surface thermal emission\ncomponent is computed directly from the Planck function\nand spectral attenuation. A further MODTRAN calculation with SALB=0.0 is used to obtain estimates of scattered solar radiance and of the \"scattered thermal\" radiance compoment of the total radiance returned by MOD-\n\n\f7\n\nTRAN.\nThe calculation of a(T ) and b(T ) used in the retrievals\ndeparts from (51)-(53) in one regard. Approximation of\nthe total TOA radiance computed by MODTRAN with\nthe (never exact) Duntley equation becomes increasingly\ninaccurate as the surface temperature increases. The dominant contribution to the discrepancy is the surface emission portion of the scattered thermal radiance. Subtracting an estimate of this term gives a corrected TOA radiance in much better accord with the predictions of the\nDuntley equation. The estimate is calculated as a function\nof the unknown surface emissivity and (necessarily erroneous) forward model boundary temperature, using the difference between the scattered thermal contributions computed with SALB=1.0 and SALB=0.0. Rather than subtracting the approximate scattered surface thermal radiance from the total MODTRAN radiance, the correction\nwas implemented in a mathematically equivalent way by\nadding that portion of the scattered thermal radiance component linear in surface emissivity to the surface thermal\nemission terms in (51)-(53).\nIt should be noted that while the forward model assumes knowledge of atmospheric parameters, MODTRANcomputed quantities used in the forward model have no dependence upon true surface temperature or emissivity. The\nboundary temperature parameter used in MODTRAN affects the forward radiance calculations primarily through\nthe scattered thermal contribution. In addition, MODTRAN adjusts the atmospheric temperature profile in the\nlower zones to interpolate smoothly between surface conditions and a fiducial layer in the atmosphere. For these\nreasons the forward model boundary temperature should\nnot differ greatly from a physically reasonable value.\nThe algorithm is executed according to these steps:\n1. Perform the forward model radiative transfer calculations with MODTRAN.\n2. Calculate the individual band posterior probabilities,\nand the joint posterior probability over all bands, as a function of surface temperature with (62) and (63), contracting\nas necessary the range of T to that giving nonvanishing\njoint posterior probability in (61).\n3. Calculate expectation values for surface temperature\nover the posterior probabiltiy for each band individually,\nand over the joint posterior probabiltity. This calculation\ngives n + 1 surface temperature estimates.\n4. Perform convergence test max|hTi i\u2212hTj i| < \u03b7 over all\npairs of surface temperature estimates. If the convergence\ntest is satisfied, proceed to step 5. Otherwise, iterate by\nrepeating steps 2-4.\n5. Compute expectation values for band emissivities using (64).\n6. Adjust \u01ebmin , \u01ebmax to \u00b1m standard deviations about\nh\u01ebi i for each band.\n(7. Repeat steps 2-6 if desired.)\nMonte Carlo simulations of LST retrieval in a selected\nsubset of MODIS bands illustrate the performance of the\nalgorithm. The bands chosen appear in Table 1. MOD-\n\nTRAN calculations are used both as simulated TOA radiances in MODIS bands and as the forward model. Each\nMonte Carlo realization of TOA radiance is calculated using a mid-latitude summer atmosphere with MODTRAN\nparameters listed in Table 2 selected as uniform deviates\nwithin the limits shown, including \"true\" surface T and\nband emissivities. It is unlikely that the atmospheric profile or other parameters required to specify a formard radiative transfer model will be reliably known to high accuracy.\nIn order to simulate the effect of imperfect knowledge on\nthe forward model, a second draw of random numbers is\nused to introduce errors in the fallible forward model as\nshown in the last column. Thus, for examples, the surface\nvisibility, which MODTRAN uses to parameterize aerosol\neffects, is chosen to lie between 5 and 30 km for each Monte\nCarlo realization. A random error of up to \u00b14 km is added\nto this value of visibility for use in calculation of the fallible forward model for each realization. The MODTRAN\nmodel default water vapor profile, given as (grams precipitable water)/ (kilograms air), is randomly scaled between\nthe limits shown (subject to the constraint that relative\nhumidity cannot exceed 100%). The range of perturbed\nforward model parameters is truncated at the limits specified in Table 2. The forward model cannot, of course, incorporate knowledge of the true surface temperature, but\nit does require an initial guess for that quantity. This guess\nis obtained by varying the forward model boundary temperaature randomly from \"truth\" by \u00b120K, without truncation. Inclusion of the scattered thermal radiance contribution in the forward model notably improves retrieval\naccuracy, despite boundary temperature uncertaintiies of\nthis magnitude in the forward model.\nTable 1. MODIS bands used in simulations\nMODIS band wavelength limits\n\nnotional snr\n\n20\n22\n23\n29\n31\n32\n\n350\n350\n350\n1000\n1000\n1000\n\n3.660-3.840 \u03bc\n3.929-3.989 \u03bc\n4.020-4.080 \u03bc\n8.400-8.700 \u03bc\n10.870-11.280 \u03bc\n11.770-12.270 \u03bc\n\nTable 2. Monte Carlo parameter ranges\nMODTRAN\nparameter\n\nminimum\nvalue\n\nmaximum\nvalue\n\nfallible forward\nmodel error\n\nnadir view angle\nsurface visibility\ncolumn water vapor\nthin cirrus altitude\nthin cirrus thickness\nthin cirrus opacity\nsolar azimuth\nsolar elevation\nviewng azimuth\nviewing elevation\nsurface T\n\n125 deg\n5 km\n0.33 \u00d7 MLS\n8 km\n1m\n0.05/km\n0 deg\n20 deg\n0 deg\n35 deg\n268 deg K\n\n180 deg\n30 km\n1.00\n12 km\n20 m\n0.2/km\n90 deg\n60 deg\n90 deg\n90 deg\n328 deg K\n\n\u00b10.125 deg\n\u00b1 4 km\n\u00b10.2\n\u00b10.5 km\n\u00b125 m\n\u00b10.025/km\n\u00b10.125 deg\n\u00b10.125 deg\n\u00b10.125 deg\n\u00b10.125 deg\nN/A\n\n\f8\n\nNext, the simulated MODIS TOA radiances are contaminated with notional sensor noise simulated as a zero-mean\nGaussian random process with standard deviation equal to\nthe noise equivalent radiance N E\u2206R. The algorithm also\nrequires an estimated variance for the noise radiance (\u03c3\nin (6)), which should be of order N E\u2206R. N E\u2206R is parameterized in terms of a signal-to-noise ratio. SNR was\nchosen to lie on the low end of values inferred from MODIS\nN E\u2206T values[25] with the aid of the following estimate.\nThe error in TOA radiance from noise sources is estimated\nas, roughly,\n\u03b4I =\n\nwhere\nIs = \u01eb\n\n\u2202I\n\u03b4T + O(\u03b4T )2\n\u2202T\n\u2202Is\n\u223c\nN E\u2206T\n=\n\u2202T\nZ\n\n\u2206k\n\nBk (T )exp(\u2212\n\n(65)\n\n\u03c4k\n)dk\n\u03bc\n\n(66)\n\nis the attenuated surface thermal emission at TOA, leading\nto\n\u0013\u22121\n\u0012 \u0013\u22121 \u0012\n\u2202log(Is )\n\u03b4I\n\u223c\nN E\u2206T\n(67)\nSN R =\n=\nI\n\u2202T\nThis quantity was computed for each Monte Carlo realization; the SNR values used for the retrievals, which apppear\nin Table 1, conservatively underestimate (67). Performance\nof the algorithm appears not too sensitive to the exact noise\ncontamination added to the simulated band radiances, nor\nto the exact noise variance assumed in the retrieval, as long\nas neither is grossly erroneous. In fact, it is possible to adjust the assumed value of \u03c3 in the estimator to contract\nor expand the range of viable surface temperatures consistent with sensor radiances without disastrously biasing the\nretrieval, as described below.\nOne thousand Monte Carlo realizations each were calculated for day and night, with a mid-latitude summer atmosphere. Generous bounds for the initial a-priori limits\non LST and band emissivity were assumed, subject to the\nphysical upper bound on surface emissivity:\n200K \u2264 T \u2264 500K\n0.75 \u2264 \u01ebi \u2264 0.99\n\n(68)\n\nNote that both limits for LST lie outside the range sampled\nby the Monte Carlo draws.\nMean errors and error standard deviations for the retrieved surface temperatures and band emissivities, with\nrespect to \"true\" values, appear in Table 3. In the majority\nof cases, acceptable estimates of LST and band emissvities\nwere obtained using all six bands from Table 2, with the\nSNR chosen to equal the assumed noise variance in the simulations which appears in Table 1. However, in about 4% of\nthe simulations it proved impossible to find an acceptable\nsolution with all six bands in this manner. The solution\ninstead tended to badly erroneous values (e.g., T \u2264 100K,\nand emissivities pegged at the limits of the prior). Inspection of the posterior probabilities from (62) revealed that in\n\nTable 3. Monte Carlo simulation results: mean errors,\nstandard deviations\nCase\n\nDay\n\nNight\n\nLST error(K)\n\u01eb20 error\n\u01eb22 error\n\u01eb23 error\n\u01eb29 error\n\u01eb31 error\n\u01eb32 error\n\n\u22120.25 \u00b1 1.23\n\u22120.004 \u00b1 0.022\n\u22120.009 \u00b1 0.034\n\u22120.008 \u00b1 0.048\n\u22120.004 \u00b1 0.031\n\u22120.005 \u00b1 0.023\n\u22120.007 \u00b1 0.028\n\n\u22120.31 \u00b1 1.11\n\u22120.003 \u00b1 0.035\n+0.001 \u00b1 0.034\n\u22120.007 \u00b1 0.038\n\u22120.003 \u00b1 0.022\n\u22120.005 \u00b1 0.022\n\u22120.006 \u00b1 0.029\n\nthese anomalous cases one or more of the individual band\nposterior probabilities fails to overlap significantly with the\nproduct of the remaining posterior distributions, leading\nto a joint posterior probability that effectively vanishes. A\nnumber of remedies is available when this difficulty arises.\nThe number of successful retrievals rises sharply when the\nrange of the band emissivity prior is expanded to 0.7-0.999,\nbut at the cost of reducing their overall accuracy somewhat.\nExperimentation shows that, in all of the anomalous cases,\nit is possible to get a satisfactory LST retrieval with some\nthree-band subset of the original six. The LST so obtained\ncan then be inserted into the expectation value for band\nemissivity to yield emisssivities for all six bands. Finally,\nthe support of the joint posterior probability can be broadened by increasing the noise radiance \u03c3 in its calculation.\nThis last approach was used to obtain Table 3. The effect\non retrievals of increasing \u03c3 for subsets of the bands differed negligibly from that of increasing \u03c3 for all bands by\nthe same factor. The most intractable of the anomalous\ncases (one each nighttime and daytime) required increasing \u03c3 by a factor of 7.0 in order to obtain an acceptable\nsolution.\nExamination of the \u03c72 statistic for retrieval errors shows\nthat the estimator is (slightly) biased for normal, and significantly biased for anomalous, retrievals. For the 963\nnormal nighttime retrievals the mean and stardard deviation of the surface temperature error are \u03b4T = \u22120.26 \u00b1\n1.06K, with \u03c72 = 1.06 per degree of freedom. For 958\nnormal daytime retrievals, the corresponding figures are\n\u03b4T = \u22120.21 \u00b1 1.18K and \u03c72 =1.03 per degree of freedom. The values for 37 anomalous nighttime retrievals are\n\u03b4T = \u22121.71 \u00b1 1.32K and \u03c72 = 2.64 per degree of freedom,\nwith \u03b4T = \u22121.08 \u00b1 1.92K and \u03c72 =1.29 per degree of freedom, for 42 anomalous daytime cases. However, the distribution of errors is very accurately Gaussian (as should be\nexpected). If the mean error is subtracted before calculating \u03c72 , the result is identically 0.999 per degree of freedom\nfor surface temperature (and all six band emissivities) for\nall retrievals.\nForward models for the anomalous cases systematically\nhave large errors in one or more of the randomly-varied\nsimulation parameters. Thus, the surface visibility and the\nboundary temperature are both more likely to lie near the\nlimits of their range than in the middle. In particular, the\ncolumn water vapor scaling factor is over three times as\nlikely to exceed 1.1 for anomalous retrievals as for normal\n\n\f9\n\nones (25/37 vs 203/963 nighttime; 27/42 vs 182/958 daytime), with only three daytime and two nighttime anomalous retrievals occurring for a column water vapor scaling\nless than unity. The frequency of anomalous retrievals appears, to some extent, to be an artifact of inserting large\nerrors in the forward model to approximately simulate imperfect knowledge of atmospheric conditions.\nIn any event, all 2000 Monte Carlo realizations led to a\nsuccesssful retrieval of both LST and six band emissivities.\nV. Discussion\nPoints which should be addressed in further developments of practical algorithms:\n1. It appears that this approach to TES works largely\nbecause the range of plausible surface temperature values\nconsistent with band radiances and an uninformative range\nof band emissivity is quite constricted, as a consequence of\nthe strong temperature dependence of the Planck function.\nIt turns out not to be terribly difficult to get a temperature estimate that is close enough to truth that it can be\ninserted into the least sophisticated imaginable estimator\nfor band emissivity (64), and still lead to acceptably accurate results.\nOnce the algorithm has gotten to an iteration in which\nthe current range of temperature and band emissivities is\nrestricted to a neighborhood sufficiently close to the true\nvalues that the posterior distribution is jointly Gaussian\nin T as well as in the \u01ebi , it is apparent both that convergence to the true values will occur as assumed in this\nalgorithm, and that these values will maximize the likelihood. However, at present, there is no proof in hand that\nthe procedure outlined above actually converges, or that,\ngiven that it does, it converges to the true surface temperature and emissivity combination. It appears to do both\nto good accuracy in practice.\nHowever, the algorithm did-initially-fail to converge to\nan acceptable solution in about 4% of the realizations. As\nrecounted in the previous section, it proved possible in every case to adapt the search strategy so as to successfully\nretrieve both LST and emissivities for all bands. The successful recovery strategies all had the effect of maximizing\nthe numerical joint posterior probability, by some combination of 1) eliminating from the estimator band posterior probabilities whose effective nonvanishing support did\nnot intersect that of the joint probability of the remaining\nbands, or forcing intersection by broadening the support\nof the outlier posterior probabilities by 2) loosening limits\non the prior, or 3) increasing the noise radiance parameter\nassumed in the retrieval.\nThe solutions obtained are, in any event, not unique,\nbecause the TES problem is underdetermined. Considered\nas a surrogate for maximum likelihood solutions, the algorithm solutions approximate only local maxima, and it\nmight be possible to find maxima which give very poor\naccount of temperature and emissivity. This has not happened in simulations performed to date.\n2. The algorithm as presently formulated appears to be\n\nunnecessarily complicated. It seems certain that its operation can be significantly streamlined. For practical applications, it will be necessary to eliminate redundant elements\nof the calculation.\n3. The model for band radiances in this memo treated\nthem independently, apart from the prior knowledge that\nthe surface temperature for all bands must be the same.\nBretthorst [15],[16],[17] has addressed problems involving\nmore sophisticated models for observations, in an approach\nwhich would appear to offer real advantages in the present\ncontext.\n4. Perhaps the least satisfactory feature of this algorithmic approach is its dependence upon an accurate forward radiance model. To the extent MODTRAN can be\nregarded as supplying radiance estimates which are zeromean error estimates of the true radiance, the effect of\nradiance prediction error on this algorithm may simply be\nregarded as a contribution to the noise variance. But in real\nlife, a forward model can be expected to have systematic\nerrors that need not originate as unbiased stationary Gaussian processes. The question whch has been addressed in\nthis work is: Given an accurate forward model (in the sense\njust described), what surface temperature and band emissivities are consistent with observed radiances and knowledge of their error statistics? A harder question, which will\nbe the focus of further developments, is: Given a fallible,\nbut reasonably accurate, forward model, what surface temperatures and band emissivities can possibly be consistent\nwith observations and available knowledge, no matter what\nthe forward model error, so long as it falls within known\nlimits?\nVI. Conclusion\nA simple argument, based on inherent physical symmetries that the description of surface thermal emission must\nobey, leads to the appropriate prior probabilities for surface\ntemperature and emissivity. These lead to the maximum\nentropy estimator for the mismatch between sensed and\nmodeled radiance in the presence of noise, from which an\nestimator of surface temperature may be constructed that\ntreats emissivity as a nuisance parameter. MODTRANbased simulations show that temperature-emissivity separation is successfully performed by iteration between the\ntemperature estimator, and a similar estimator for surface\nemissivity.\nReferences\n[1] Dash, P., F.-M. G\u00f6ttsche, F.-S. Olesen, and H. Fischer, \"Land\nsurface temperature and emissivity estimation from passive sensor data: theory and practice-current trends,\" Int. J. Remote\nSensing, vol. 23, pp. 2563-2594, 2002\n[2] Wan, Z.-M., MODIS Land-Surface Temperature Algorithm Theoretical Basis Document, Institute for Computational Earth System Science, University of California, Santa Barbara, 1999\n[3] Li Z.-L.,F. Becker, M. P. Stoll, and Z. Wan, \"Evaluation of Six\nMethods for Extracting Relative Emissivity Spectra from Thermal Infrared Images,\" Rem. Sens. Env., vol. 69, pp. 197-214, 1999\n[4] Kahle, A. B., and R. E. Alley, \"Separation of Temperature and\nEmittance in Remotely Sensed Radiance Measurements,\" Rem.\nSens. Env., vol. 42, pp. 107-111, 1992\n\n\f10\n\n[5] Kealy, P. S., and S. J. Hook, \"Separating Temperature and Emissivity in Thermal Infrared Multispectral Scanner Data: Implications for Recovering Land Surface Temperatures,\" IEEE Trans.\nGeosci. Remote Sensing, vol. 31, pp. 1155-1164, 1993\n[6] Petitcolin, F., and E. F. Vermote, \"Land Surface Reflectance,\nEmisivity and Temperature from MODIS Middle and Thermal\nInfrared data,\" Rem. Sens. Env.,vol 83(1-2), 112-134, 2002\n[7] Li Z.-L., and F. Becker, \"Feasibility of Land Surface Temperature\nand Emissivity Determination from AVHRR Data,\" Rem. Sens.\nEnv., vol. 43, pp. 67-85, 1993\n[8] Watson, K., \"Spectral Ratio Method for Measuring Emissivity,\"\nRem. Sems. Env., vol. 42, pp. 113-116, 1992\n[9] Borel, C. C., and J. . Szymanski, \"Physics-based Water and Land\nTemperature Retrieval,\" in Handbook of Science Algorithms for\nthe Multispectral Thermal Imager, B. W. Smith, Ed., Los Alamos\nNational Laboratory and Savannah River Technology Center,\n1998\n[10] Wan, Z.-M., and J. Dozier, \"A generalized split-window algorithm for retrieveing land-surface temperature from space,\" IEEE\nTrans. Geosci. Remote Sensing, vol. 34, pp. 892-905, 1996\n[11] Barducci, A., and I. Pippi, \"Temperature and emissivity retrieval from remotely sensed images using the 'Grey body emissivity' method,\" IEEE Trans. Geosci. Remote Sensing, vol. 34,\npp. 681-695, 1996\n[12] Wan, Z.-M., and Z.-L. Li, \"A physics-based algorithm for landsurface emissivity and temperature from EOS/MODIS data,\"\nIEEE Trans. Geosci. Remote Sensing, vol. 35, pp. 980-996, 1997\n[13] Duntley, S. Q., \"The Reduction of Apparent Contrast by the\nAtmosphere,\" J. Opt. Soc. Am vol. 38, p 179, 1948\n[14] It happens that Lambertian behavior is usually considered a\ngood approximation in the LWIR. A Lambertian assumption is\nregarded as more questionable in the MWIR. Looking ahead to\nlater simulated MODIS retrievals, Wan and Li [12] have examined\nthis question for MODIS MWIR surface imaging bands (Bands\n20,22, and 23) and have concluded that in MWIR bands surfaces\nmay be adequately approximated as Lambertian reflectors obeying Khirchoff's law. For the present application, the relevant point\nis the applicability of Khirchoff's law, rather than Lambert's.\n[15] Bretthorst, L., Bayesian Spectral Analysis and Parameter Estimation, Dissertation, Washington University, St. Louis, MO,\n1987\n[16] Bretthorst, L., \"Bayesian Spectrum Analysis and Parameter Estimation,\" in Berger, J., S. Fienberg, J. Gani, K. Krickenberg, and\nB. Singer, Eds, Lecture Notes in Statistics, 48, Springer-Verlag,\nNew York, 1988\n[17] Bretthorst, L., \"Excerpts from Bayesian Spectrum Analysis and\nParameter Estimation,\" in Erickson, G. J., and C. R. Smith,\nMaximumum-Entropy and Bayesian Methods in Science and Engineering, Volume 1: Foundations, Kluwer, Dordrecht, 1988, pp.\n75-145\n[18] Landau, L. D., annd L. Lifschitz, Statistical Physics, AddisonWesley: Reading, MA, 1958\n[19] Jaynes, E., \"Prior Probabilities,\" IEEE Trans. on Systems Science and Cybernetics, vol. SSC-4, pp. 227-241, 1968\n[20] Jaynes, E., \"The Well-Posed Problem,\" Found. Physics 3, pp.\n477-493, 1973\n[21] Jaynes, E., \"Marginalization and Prior Probabilities,\" in\nBayesian Analysis in Econometrics and Statitstics, A. Zellner,\nEd., North-Holland Publishing Co.: Amsterdam, 1980\n[22] Misner, C. W., K. S. Thorne, and J. A. Wheeler, Gravitation,\nFreeman: San Francisco, 1973\n[23] Weinberg, S., Gravitation and Cosmology, John Wiley and Sons:\nNew York, 1972\n[24] Einstein, A., \"Zur elektrodynamik bewegter K\u00f6rper,\" Ann.\nPhysik, vol. 17, pp. 891-921, 1905\n[25] Guenther, B., X. Xiong, V. V. Salmonson, W. L. Barnes, and\nJ. Young, \"On-orbit perfromance of the Earth Observing System\nModerate Resolution Spectroradiometer; first year of data,\" Rem.\nSens. Env. 83, pp. 16-30, 2002\n\n\f"}