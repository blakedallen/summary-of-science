{"id": "http://arxiv.org/abs/math-ph/0306070v5", "guidislink": true, "updated": "2006-01-12T15:00:15Z", "updated_parsed": [2006, 1, 12, 15, 0, 15, 3, 12, 0], "published": "2003-06-27T11:46:49Z", "published_parsed": [2003, 6, 27, 11, 46, 49, 4, 178, 0], "title": "Optimal Transportation in the presence of a prescribed pressure field", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math-ph%2F0301035%2Cmath-ph%2F0301019%2Cmath-ph%2F0301006%2Cmath-ph%2F0301042%2Cmath-ph%2F0301001%2Cmath-ph%2F0301031%2Cmath-ph%2F0301021%2Cmath-ph%2F0301041%2Cmath-ph%2F0301028%2Cmath-ph%2F0301002%2Cmath-ph%2F0301024%2Cmath-ph%2F0301045%2Cmath-ph%2F0301039%2Cmath-ph%2F0306061%2Cmath-ph%2F0306077%2Cmath-ph%2F0306048%2Cmath-ph%2F0306031%2Cmath-ph%2F0306021%2Cmath-ph%2F0306058%2Cmath-ph%2F0306024%2Cmath-ph%2F0306046%2Cmath-ph%2F0306055%2Cmath-ph%2F0306003%2Cmath-ph%2F0306012%2Cmath-ph%2F0306075%2Cmath-ph%2F0306057%2Cmath-ph%2F0306035%2Cmath-ph%2F0306011%2Cmath-ph%2F0306076%2Cmath-ph%2F0306065%2Cmath-ph%2F0306043%2Cmath-ph%2F0306016%2Cmath-ph%2F0306029%2Cmath-ph%2F0306007%2Cmath-ph%2F0306034%2Cmath-ph%2F0306002%2Cmath-ph%2F0306033%2Cmath-ph%2F0306010%2Cmath-ph%2F0306067%2Cmath-ph%2F0306005%2Cmath-ph%2F0306074%2Cmath-ph%2F0306008%2Cmath-ph%2F0306040%2Cmath-ph%2F0306045%2Cmath-ph%2F0306064%2Cmath-ph%2F0306056%2Cmath-ph%2F0306068%2Cmath-ph%2F0306030%2Cmath-ph%2F0306070%2Cmath-ph%2F0306026%2Cmath-ph%2F0306037%2Cmath-ph%2F0306047%2Cmath-ph%2F0306018%2Cmath-ph%2F0306051%2Cmath-ph%2F0306006%2Cmath-ph%2F0306028%2Cmath-ph%2F0306015%2Cmath-ph%2F0306020%2Cmath-ph%2F0306066%2Cmath-ph%2F0306009%2Cmath-ph%2F0306053%2Cmath-ph%2F0306062%2Cmath-ph%2F0306052%2Cmath-ph%2F0306078%2Cmath-ph%2F0306013%2Cmath-ph%2F0306038%2Cmath-ph%2F0306025%2Cmath-ph%2F0306027%2Cmath-ph%2F0306023%2Cmath-ph%2F0306054%2Cmath-ph%2F0306004%2Cmath-ph%2F0306036%2Cmath-ph%2F0306071%2Cmath-ph%2F0306032%2Cmath-ph%2F0306039%2Cmath-ph%2F0306044%2Cmath-ph%2F0306019%2Cmath-ph%2F0306042%2Cmath-ph%2F0306063%2Cmath-ph%2F0306022%2Cmath-ph%2F0306069%2Cmath-ph%2F0306041%2Cmath-ph%2F0306014%2Cmath-ph%2F0306050%2Cmath-ph%2F0306072%2Cmath-ph%2F0306060%2Cmath-ph%2F0306049%2Cmath-ph%2F0306017%2Cmath-ph%2F0306001%2Cmath-ph%2F0306059%2Cmath-ph%2F0306073%2Cmath-ph%2F0607013%2Cmath-ph%2F0607019%2Cmath-ph%2F0607016%2Cmath-ph%2F0607021%2Cmath-ph%2F0607030%2Cmath-ph%2F0607051%2Cmath-ph%2F0607062%2Cmath-ph%2F0607044%2Cmath-ph%2F0607047%2Cmath-ph%2F0607010&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Optimal Transportation in the presence of a prescribed pressure field"}, "summary": "The optimal (Monge-Kantorovich) transportation problem is discussed from\nseveral points of view. The Lagrangian formulation extends the action of the\n{\\em Lagrangian} $L(v,x,t)$ from the set of orbits in $\\R^n$ to a set of\nmeasure-valued orbits. The {\\em Eulerian}, dual formulation leads an\noptimization problem on the set of sub-solutions of the corresponding\nHamilton-Jacobi equation. Finally, the Monge problem and its Kantorovich\nrelaxation are obtained by reducing the optimization problem to the set of\nmeasure preserving mappings and two point distribution measures subjected to an\nappropriately defined cost function.\n  In this paper we concentrate on mechanical Lagrangians $L=|v|^2/2+P(x,t)$\nleading, in general, to a non-homogeneous cost function. The main results yield\nexistence of a unique {\\em flow} of homomorphisms which transport the optimal\nmeasure valued orbit of the extended Lagrangian, as well as the existence of an\noptimal solution to the dual Euler problem and its relation to the Monge- and\nKantorovich formulations.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math-ph%2F0301035%2Cmath-ph%2F0301019%2Cmath-ph%2F0301006%2Cmath-ph%2F0301042%2Cmath-ph%2F0301001%2Cmath-ph%2F0301031%2Cmath-ph%2F0301021%2Cmath-ph%2F0301041%2Cmath-ph%2F0301028%2Cmath-ph%2F0301002%2Cmath-ph%2F0301024%2Cmath-ph%2F0301045%2Cmath-ph%2F0301039%2Cmath-ph%2F0306061%2Cmath-ph%2F0306077%2Cmath-ph%2F0306048%2Cmath-ph%2F0306031%2Cmath-ph%2F0306021%2Cmath-ph%2F0306058%2Cmath-ph%2F0306024%2Cmath-ph%2F0306046%2Cmath-ph%2F0306055%2Cmath-ph%2F0306003%2Cmath-ph%2F0306012%2Cmath-ph%2F0306075%2Cmath-ph%2F0306057%2Cmath-ph%2F0306035%2Cmath-ph%2F0306011%2Cmath-ph%2F0306076%2Cmath-ph%2F0306065%2Cmath-ph%2F0306043%2Cmath-ph%2F0306016%2Cmath-ph%2F0306029%2Cmath-ph%2F0306007%2Cmath-ph%2F0306034%2Cmath-ph%2F0306002%2Cmath-ph%2F0306033%2Cmath-ph%2F0306010%2Cmath-ph%2F0306067%2Cmath-ph%2F0306005%2Cmath-ph%2F0306074%2Cmath-ph%2F0306008%2Cmath-ph%2F0306040%2Cmath-ph%2F0306045%2Cmath-ph%2F0306064%2Cmath-ph%2F0306056%2Cmath-ph%2F0306068%2Cmath-ph%2F0306030%2Cmath-ph%2F0306070%2Cmath-ph%2F0306026%2Cmath-ph%2F0306037%2Cmath-ph%2F0306047%2Cmath-ph%2F0306018%2Cmath-ph%2F0306051%2Cmath-ph%2F0306006%2Cmath-ph%2F0306028%2Cmath-ph%2F0306015%2Cmath-ph%2F0306020%2Cmath-ph%2F0306066%2Cmath-ph%2F0306009%2Cmath-ph%2F0306053%2Cmath-ph%2F0306062%2Cmath-ph%2F0306052%2Cmath-ph%2F0306078%2Cmath-ph%2F0306013%2Cmath-ph%2F0306038%2Cmath-ph%2F0306025%2Cmath-ph%2F0306027%2Cmath-ph%2F0306023%2Cmath-ph%2F0306054%2Cmath-ph%2F0306004%2Cmath-ph%2F0306036%2Cmath-ph%2F0306071%2Cmath-ph%2F0306032%2Cmath-ph%2F0306039%2Cmath-ph%2F0306044%2Cmath-ph%2F0306019%2Cmath-ph%2F0306042%2Cmath-ph%2F0306063%2Cmath-ph%2F0306022%2Cmath-ph%2F0306069%2Cmath-ph%2F0306041%2Cmath-ph%2F0306014%2Cmath-ph%2F0306050%2Cmath-ph%2F0306072%2Cmath-ph%2F0306060%2Cmath-ph%2F0306049%2Cmath-ph%2F0306017%2Cmath-ph%2F0306001%2Cmath-ph%2F0306059%2Cmath-ph%2F0306073%2Cmath-ph%2F0607013%2Cmath-ph%2F0607019%2Cmath-ph%2F0607016%2Cmath-ph%2F0607021%2Cmath-ph%2F0607030%2Cmath-ph%2F0607051%2Cmath-ph%2F0607062%2Cmath-ph%2F0607044%2Cmath-ph%2F0607047%2Cmath-ph%2F0607010&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The optimal (Monge-Kantorovich) transportation problem is discussed from\nseveral points of view. The Lagrangian formulation extends the action of the\n{\\em Lagrangian} $L(v,x,t)$ from the set of orbits in $\\R^n$ to a set of\nmeasure-valued orbits. The {\\em Eulerian}, dual formulation leads an\noptimization problem on the set of sub-solutions of the corresponding\nHamilton-Jacobi equation. Finally, the Monge problem and its Kantorovich\nrelaxation are obtained by reducing the optimization problem to the set of\nmeasure preserving mappings and two point distribution measures subjected to an\nappropriately defined cost function.\n  In this paper we concentrate on mechanical Lagrangians $L=|v|^2/2+P(x,t)$\nleading, in general, to a non-homogeneous cost function. The main results yield\nexistence of a unique {\\em flow} of homomorphisms which transport the optimal\nmeasure valued orbit of the extended Lagrangian, as well as the existence of an\noptimal solution to the dual Euler problem and its relation to the Monge- and\nKantorovich formulations."}, "authors": ["Gershon Wolansky"], "author_detail": {"name": "Gershon Wolansky"}, "author": "Gershon Wolansky", "arxiv_comment": "40 pages", "links": [{"href": "http://arxiv.org/abs/math-ph/0306070v5", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math-ph/0306070v5", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "35Q80, 35F20,49K20", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math-ph/0306070v5", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math-ph/0306070v5", "journal_reference": null, "doi": null, "fulltext": "Optimal Transportation in the presence of a\nprescribed pressure field\n\narXiv:math-ph/0306070v5 12 Jan 2006\n\nG. Wolansky1\nNovember 21, 2018\nAbstract\nThe optimal (Monge-Kantorovich) transportation problem is discussed from several\npoints of view. The Lagrangian formulation extends the action of the Lagrangian L(v, x, t)\nfrom the set of orbits in Rn to a set of measure-valued orbits. The Eulerian, dual formulation leads an optimization problem on the set of sub-solutions of the corresponding\nHamilton-Jacobi equation. Finally, the Monge problem and its Kantorovich relaxation\nare obtained by reducing the optimization problem to the set of measure preserving mappings and two point distribution measures subjected to an appropriately defined cost\nfunction.\nIn this paper we concentrate on mechanical Lagrangians L = |v|2 /2 + P (x, t) leading,\nin general, to a non-homogeneous cost function. The main results yield existence of a\nunique flow of homomorphisms which transport the optimal measure valued orbit of the\nextended Lagrangian, as well as the existence of an optimal solution to the dual Euler\nproblem and its relation to the Monge- and Kantorovich formulations.\n\n1\n\nIntroduction\n\n1.1\n\nMotivation\n\nConsider the Schrodinger equation on a domain \u03a9 \u2286 Rn\ni~\n\n\u2202\u03c8\n= ~2 \u2206x \u03c8 + P \u03c8 ; (x, t) \u2208 \u03a9 \u00d7 [0, T ]\n\u2202t\n\n(1.1)\n\nwhere P = P (x, t) is a given potential (pressure field). If \u2202\u03a9 6= \u2205 we specify a boundary\ncondition under which equation (1.1) is well posed and generate a unitary semigroup. We are\ninterested in the following question: Given a pair of probability measures \u03bc0 , \u03bc1 on \u03a9 (say,\nabsolutly continuous subjected to the densities \u03c10 , \u03c11 ), can one solve the two point boundary\nproblem, given only the data \u03c10 (x) = |\u03c8|2 (x, 0) and \u03c11 (x) = |\u03c8|2 (x, T )?\nThis problem is a prototype for a variety of wave equations admitting a Lagrangian\nformulation. However, in spite of the underlying Lagrangian stracture associated with (1.1),\nwe do not yet know wether such a two point boundary value problem is well posed for this\nequation.\nWe turn, therefore, to the semi-classical approximation ~ \u2192 0, where \u03c8 is written as\n\u221a i\u03c6/~\n\u03c1e\n. Then the Schrodinger equation is reduced to the Hamilton-Jacobi (HJ) equation\n1\n\u03c6t + |\u2207x \u03c6|2 = P\n2\n1\n\nDepartment of mathematics, Technion, Haifa 32000, Israel\n\n1\n\n(1.2)\n\n\fcoupled with the continuity equation\n\u03c1t + \u2207x * [\u03c1\u2207x \u03c6] = 0 .\n\n(1.3)\n\nThe two point boundary problem for the Schrodinger equation in the semi classical approximation is, therefore, reduced to solving (1.2) and (1.3) under the sole data of the initial and\nend probability densities \u03c10 = \u03c1(, 0) and \u03c11 = \u03c1(, T ), without any data on the velocity field\n\u2207x \u03c6 whatsoever.\nWe attempt to associate a Lagrangian on the state space of orbits of probability densities\n\u03c1(, t) defined for each t \u2208 [0, T ]. Since we wish to generalize the standard Lagrangian formalism defined on classical orbits x : [0, T ] \u2192 \u03a9, we shall extend this to a space of \"relaxed\norbits\" of the from \u03bc = \u03bc(t) (dx)dt, where \u03bc(t) is a Borel probability measure on \u03a9 for any\nt \u2208 [0, T ]. The special class of deterministic orbits is embedded in this set as \u03bc(t) = \u03b4x(t) ,\nwhere x is a classical orbit.\nTheR next step is to define a metric on this set of relaxed orbits which generalizes the\nT\naction 0 |\u1e8b(t)|2 dt for deterministic orbits. It turns out that the above problem is closely\nrelated to the classical Monge-Kantorovich problem of optimal transportation subjected to\nquadratic cost. An historical background of this is given below.\n\n1.2\n\nHistorical Background\n\nThe classical problem of optimal mass transportation was suggested by Monge in the 18'th\ncentury [M]: given a cost function c(x, y) (originally, c = |x\u2212y|) and a pair of Borel probability\nmeasures \u03bc0 , \u03bc1 on (say) a common probability space \u03a9, minimize\nZ\nc(x, T(x))\u03bc0 (dx)\n(M)\nalong all Borel mappings T : \u03a9 \u2192 \u03a9 which transport \u03bc0 into \u03bc1 (T# \u03bc0 = \u03bc1 ), namely\n\u0001\n\u03bc0 T\u22121 A = \u03bc1 (A) \u2200 Borel sets A \u2282 \u03a9 .\n(1.4)\n\nThe Monge problem was revived in the last century. In particular, Kantorovich [K] introduced\nin 1942 a relaxation, reducing the Monge problem to a linear programming in a cone of twopoint distributions over \u03a9 whose marginals are \u03bc0 , \u03bc1 respectively:\nZ Z\n(1)\n(0)\n(K)\nmin\nc(x, y)\u03bb(dx, dy) ; \u03c0# \u03bb = \u03bc0 , \u03c0# \u03bb = \u03bc1\n\u03bb\n\nHere \u03c0 (i) , i = 0, 1 are the natural projections of \u03a9 \u00d7 \u03a9 on its factors. A particular attention\nis given to the Wasserstein metrics\n\u0014\n\nWp (\u03bc0 , \u03bc1 ) = min\n\u03bb\n\nZ Z\n\np\n\n|x \u2212 y| \u03bb(dx, dy)\n\n;\n\n(0)\n\u03c0# \u03bb\n\n= \u03bc0 ,\n\n(1)\n\u03c0# \u03bb\n\n= \u03bc1\n\n\u00151/p\n\n(1.5)\n\nwhere p \u2265 1.\nThe most striking advantage of the relaxed problem is that a minimizer always exists\nby the compactness of the set of probability measures (assuming c is continuous and \u03a9 is\n2\n\n\fcompact). It can be shown [Am] that, if c is continuous and \u03bc0 contains no atoms, then\nthe minimum of the Kantorovich problem coincides with the infimum of the Monge problem.\nThe existence of an optimal Monge mapping is reduced to existence of such a minimizer of\nthe Kantorovich problem which is supported on a graph of a Borel map.\nFurther progress was achieved in the last few decades. In the late 80's and early 90's\nBrenier [B] studied the Monge problem with a quadratic cost c = |x \u2212 y|2 on Rn and showed\nthe existence of a unique, optimal Monge map provided \u03bc0 , \u03bc1 posses finite second moments\nand \u03bc0 is absolutely continuous with respect to Lebesgue. Moreover, he showed that this\nmap is the gradient of a convex function \u03a6 which solves the dual problem\n\u001b\n\u001aZ\nZ\n\u03a8d\u03bc1 (dx) ; \u03a6, \u03a8 \u2208 C(Rn ) ; \u03a6(x) + \u03a8(y) \u2265 x * y \u2200 x, y \u2208 Rn ,\n\u03a6\u03bc0 (dx) +\ninf\nRn\n\nRn\n\n(1.6)\nIt turned out that any map T which transports \u03bc0 to \u03bc1 must be of the form \u2207\u03a6 \u25e6 S\nwhere S perseveres \u03bc0 . This results is interpreted as a Polar factorization for mappings,\ngeneralizing the matrix polar factorization. Another interpretation of \u2207\u03a6 is as a monotone\nvectorized rearrangement in the class of maps transporting \u03bc0 to \u03bc1 . A generalization of this\nresult also holds for more general, strictly convex (and concave) homogeneous cost functions\nc(x, y) = h(x \u2212 y), using special definitions of convexity ([GM], [C] and references therein).\n\n1.3\n\nObjectives and main results\n\nIn general, if \u03bc0 contains an atom, then there is, in general, no deterministic mapping T of\nany type which maps \u03bc0 into \u03bc1 , so there is no sense to compare the deterministic Monge\nproblem (M) with the probabilistic Kantorovich problem (K). However, we may still consider\nthe following alternative formulation in terms of an optimal flow with respect to some family\nof cost functions ct1 ,t2 = J(x, y, t1 , t2 ):\n(F) : Find a relaxed orbit \u03bc = \u03bc(t) dt and a flow of diffeomorphysms Ttt21 : \u03a9 \u2192 \u03a9 for\n.\nt1 , t2 \u2208 (0, T ) such that\n\n(i) Ttt21 is the optimal Monge mapping with respect to ct1 ,t2 transporting \u03bc(t1 ) to \u03bc(t2 ) for\nany t1 , t2 \u2208 (0, T ).\n\n(ii) limt\u21920 \u03bc(t) = \u03bc0 and limt\u2192T \u03bc(t) = \u03bc1 in the weak sense of measures.\n(iii) The limits limt\u2192T Tt\u03c4 =: TT\u03c4 exists uniformly and TT\u03c4 is a continuous mappings for any\n\u03c4 \u2208 (0, T ).\nIt is feasible that, once a solution to the flow problem F is provided, a c0,T optimal\nsolution to the Monge problem M with respect to \u03bc0 , \u03bc1 exists by T = lim\u03c4 \u21920 TT\u03c4 provided\nthe later limit exists as a Borel map.\nOur starting point is the definition of a norm ||\u03bc||p of a measure-valued orbit as the minimal Lp\u03bc -norm of the velocity fields v which satisfy the weak form of the continuity equation\n\u001a\nZ\nv = v(x, t) ;\n\n0\n\nT\n\nZ\n\n\u03a9\n\n[\u03c6t + v * \u2207x \u03c6] \u03bc(t) (dx)dt = 0\n3\n\n; \u2200\u03c6 \u2208\n\nC01 (\u03a9\n\n\u001b\n\u00d7 [0.T ])\n.\n\n(1.7)\n\n\fand\n\"\n\nk\u03bckp := inf\nv\n\nZ\n\np\n\n\u03a9\u00d7[0,T ]\n\n|v| \u03bc(t) (dx)dt\n\n#1/p\n\n(1.8)\n\nwhere the infimum is taken over all \u03bc\u2212measurable vectorfield v satisfying (1.7). Denote\nthe set for which ||\u03bc||p < \u221e as Hp . This is a normed cone. In section 2 we shall indicate\nsome of its properties and prove a compactness embedding of Hp (for p > 1) in a set of\norbits which satisfies Holder continuity in an appropriate topology. In particular, the end\nconditions \u03bc0 := \u03bc(0) , \u03bc1 := \u03bc(T ) are uniquely defined for \u03bc \u2208 Hp where p > 1.\nIn the rest of the paper we concentrate on the case p = 2. The connection between the\ncost function ct1 ,t2 = J posted in formulation (F) above and the pressure P is as follows:\nThe function J = JP is the action associated with the Lagrangian\n\u0015\n\u001b\n\u001aZ t2 \u0014\n|\u1e8b(t)|2\nJP (x, y, t1 , t2 ) = inf\n+ P (x(t), t) dt ; x : [t1 , t2 ] \u2192 \u03a9, x(t1 ) = x , x(t2 ) = y .\nx\n2\nt1\nThe main result of this paper, formulated in section 3, reveals a connection between the\nfollowing approaches:\nL: The Lagrangian approach: Minimize a Lagrangian LP on the space of orbits \u03bc \u2208 H2 :\nZ TZ\n1\n2\nL := inf LP (\u03bc) ; LP (\u03bc) := ||\u03bc||2 +\nP \u03bc(t) (dx)dt , \u03bc \u2208 H2 , \u03bc(0) = \u03bc0 , \u03bc(T ) = \u03bc1 .\n\u03bc\n2\n0\n\u03a9\nE: The Eulerian approach: Maximize on the set of velocity potentials \u03c6\n\u0015\n\u0014Z\nZ\n\u03c6(x, 0)\u03bc0 (dx)\nE := sup\n\u03c6(x, T )\u03bc1 (dx) \u2212\n\u03c6\n\n(1.9)\n\n\u03a9\n\n\u03a9\n\nwhere the supremum is taken in the set of all functions \u03c6 = \u03c6(x, t) which are subsolutions of the Hamilton-Jacobi (HJ) equation (1.2) in a sense to be defined.\nM: The Monge approach: Minimize on the set of mappings verifying (1.4)\n\u001aZ\n\u001b\nJP (x, T(x), 0, T )\u03bc0 (dx) ; T# \u03bc0 = \u03bc1\nM := inf\nT\n\n\u03a9\n\nK: The Kantorovich approach: Minimize on the set of 2-point probability measures with\nprescribed marginal\n\u001aZ Z\n\u001b\n(0)\n(1)\nJP (x, y, 0, T )\u03bb(dx, dy) ; \u03c0# \u03bb = \u03bc0 , \u03c0# \u03bb = \u03bc1\nK := min\n\u03bb\n\nOur first result reveals the relation between the above formulation: If P \u2208 C 1 (\u03a9 \u00d7 [0, T ])\nthen\nL=E =K\n4\n\n\fholds for arbitrary (probability, Borel) end measures \u03bc0 , \u03bc1 . As discussed above, the Monge\nproblem may not have a solution at all (e.g., if \u03bc0 contains an atomic measure and the set of\ntransporting mappings T# \u03bc0 = \u03bc1 is empty).\nThe second part of our main result shows the relation between the flow problem (F)\nand the Lagrangian formulation L. This is the relation between the optimal velocity field v\nrealizing (1.8) and the induced flow\n\nTo elaborate, we shall prove\n\n\u0001\nd t\nTt1 (x) = v Ttt1 , t .\ndt\n\n(1.10)\n\n1) There exists a minimizer \u03bc \u2208 H2 of L which satisfies the end conditions. This minimizer\nmay be non-unique.\n2) There exists a maximizer \u03c8 of E which is a Lipschitz function on \u03a9 \u00d7 [0, T ] and satisfies\nthe equation\n1\n\u03c8t + |\u2207x \u03c8|2 = P\n(1.11)\n2\nalmost everywhere. Again, such a maximizer may be non-unique.\n3) The vector field v = \u2207x \u03c8 is defined everywhere on some relatively closed set K0 \u2282\n\u03a9 \u00d7 (0, T ) which contains the support of any minimal path \u03bc of L given by (1).\nUnder some additional assumption on P (see Main Theorem in section 3) we also get\n4) The vector field v = \u2207x \u03c8 is locally Lipschitz continuous on K0 .\n5) The restriction of v to the support of any minimal orbit of L is uniquely determined.\n6) The flow T induced by v (1.10) leaves K0 invariant.\n7) The flow Ttt21 transports \u03bc(t1 ) to \u03bc(t2 ) for any minimizer \u03bc of L and any t1 , t2 \u2208 (0, T ).\nMoreover, it is an optimal Monge transport with respect to the action JP (*, *, t1 , t2 ).\nt\n8) The maps lim\u03c4 \u2192T T\u03c4t := TTt : \u03a9 \u2192 \u03a9 and\nTt0 : \u03a9 \u2192 \u03a9 exist and are\n\u0003\n\u0002 T lim\n\u0003 \u03c4 \u21920 T\u0002\u03c4 :=\ncontinuous for any t \u2208 (0, T ). Moreover, Tt # (res. Tt0 # ) is an optimal Monge map\nwith respect to the action JP (, , t, T ) (res. JP (*, *, 0, t)) transporting \u03bc(t) to \u03bc1 (res. \u03bc0\nto \u03bc(t) ).\n\n9) If limt\u2192T Tt0 := T exists as a Borel map, then T transports \u03bc0 to \u03bc1 and is an optimal\nsolution of the Monge problem M. In this case\nM=L=E =K\n\nA particular case is the pressureless flow P \u2261 0. Here the optimal potential satisfies\n1\n\u03c8t + |\u2207x \u03c8|2 = 0\n2\n5\n\n(1.12)\n\n\fand the associated action is\nJ0 (x, y, t1 , t2 ) =\n\n|x \u2212 y|2\n,\n2(t2 \u2212 t1 )\n\nreducing the Monge-Kantorovich problem to the Wasserstein metric W2 for quadratic costs\n(1.5). The associated flow, claimed in (6), is given in this case by\nTtt21 (x) = x + (t2 \u2212 t1 )\u2207x \u03c8(x, t1 )\nwhere \u2207x \u03c8 is defined and Lipschitz everywhere. In particular it follows that, for a quadratic\ncost, an optimal Monge map T# \u03bc0 = \u03bc1 exists and is unique provided \u2207x \u03c8(x, 0) is \u03bc0\nmeasurable.2 In this case, Brenier representation T = TT0 = \u2207x \u03a6 of the optimal map [see\n(1.6) and the proceeding discussion] is recovered via\n\u03a6(x) = x2 /2 + T \u03c8(x, 0) .\nThe connection between the Monge-Kantorovich problem in the quadratic case and the flow\nproblem L (P \u2261 0), as well as the dual relation E together with the Hamilton-Jacobi equation\n(1.12) was indicated by several authors (see [BB], [BBG])3 as well as in the excellent monograph of Villani [V]. However, to the best of my knowledge, the existence and uniqueness\nresult for the flow Ttt21 without any regularity assumptions on the end measures \u03bc0 , \u03bc1 is new\neven in the case P \u2261 0. In fact, the existence and uniqueness of the flow holds even if there\nis no optimal Monge map.\nIn section 4 we shall start to develop the tools needed for the proof of our main results.\nSection 4.1 deals with a dual formulation for the norm k\u03bck2 for an orbit of measure \u03bc =\n\u03bc(t) dt \u2208 H2 . It follows that\ns\n\u0014 RR\n\u0015\n(\n\u03c6t \u03bc(dxdt))2\n||\u03bc||2 = sup R R\n|\u2207x \u03c6|2 \u03bc(dxdt)\nwhere the supremum is taken on the set of test functions \u03c6(x, t) = \u03c6 \u2208 C01 (\u03a9 \u00d7 [0, T ]). An\nequivalent definition turns out to be\n\u001b\n\u001a Z\nZ\nZ\n1\n2\n\u03c6(x, T )\u03bc1 (dx)\n(1.13)\n\u03c6(x, 0)\u03bc0 (dx) +\n||\u03bc||2 = sup \u2212\nP (x, t)\u03bc(dxdt) \u2212\n2\n\u03c6,P\n\u03a9\n\u03a9\n\u03a9I\n\nwhere the infimum above is on the pairs of \"velocity potentials\" \u03c6 \u2208 C 1 (\u03a9 \u00d7 [0, T ]) and\n\"pressures\" P = P (x.t) which are related via the Bernulli-type (or Hamilton-Jacobi) equation\n(1.2). In case of a prescribed pressure P (as in this paper), this identity reveals the relation\nbetween the Lagrangian formulation L and the Eulerian one E. In section 4.2 we imply a dual\nformulation to a strict convex perturbation of the Lagrangian L, leading to an approximation\nof the Euler formulation E, to be used in the proof of the main result.\nFor the proof of the main result we shall also need a series of auxiliary Lemmas and\ndefinitions related to the Hamilton-Jacobi equation. In subsection 5.1 we list these definitions\n2\n\nSince \u03c8(, 0) is a Lipschitz function, \u2207x \u03c8(x, 0) is a measurable function defined a.e, so we recover the\nexistence of an optimal map if \u03bc0 is a continuous w.r to Lebesgue measure.\n3\nI wish to thank Prof. D. Kinderlehrer for turning my attention to these publications.\n\n6\n\n\fand Lemmas, concerning forward (maximal), backward (minimal) and reversible solutions of\nthe Hamilton-Jacobi equation, which are essential to the proof of the main results. The proofs\nof the Lemmas are given in subsection 5.2. In 5.3 we utilize these results for the proofs of\nour main Theorem.\nIn the rest of the paper we shall restrict ourselves to the flat torus \u03a9 = Rn /Zn . The\nreason is that we wish to avoid compactness problems originated from measures on Rn , on\nthe one hand, and the boundary conditions for the Hamilton-Jacobi equation required in\ncase of a bounded domain \u03a9 \u2282 Rn . The flat torus is the simplest example in the sense that\nit is compact manifold with no boundary, on the one hand, and it inherits the Euclidean\ngeometry from Rn on the other. Any function (or probability measure) on \u03a9 is understood\nas a periodic function (or periodic, normalized per-period measure) on Rn , unless otherwise\nis explicitly specified. In particular, a mapping T : \u03a9 \u2192 \u03a9 is understood as a mapping on the\ncovering Rn which satisfies T(x + z) = T(x) + z for any x \u2208 Rn and any z \u2208 Zn .\n\n7\n\n\fList of symbols and definitions\n\u2022 \u03a9 := Rn /Zn .\n\u2022 I = [0, T ] ; I0 = (0, T )\n\u2022 \u03a9 I = \u03a9 \u00d7 I , \u03a9 I 0 = \u03a9 \u00d7 I0 .\n\u2022 LIPl is the set of all locally Lipschitz functions in \u03a9)I0 .\n\u2022 M is the set of all probability Borel measures supported in \u03a9.\n\u2022 MI is the set of all Borel probability measures supported on \u03a9I which are decomposable\nas \u03bc \u2208 MI \u21d0\u21d2 \u03bc = \u03bc(t) dt where \u03bc(t) \u2208 M a.e. t \u2208 I.\n\u2022 if \u03bc is Lebesgue continuous measure, then \u03c1\u03bc \u2208 L1 (\u03a9I ) is the density of \u03bc.\n\u2022 \u03c0 (0) (res. \u03c0 (1) ) is the natural projection of \u03a9 \u00d7 \u03a9 on its first (res. second) factor \u03a9.\n\u2022 For any pair \u03bc0 , \u03bc1 \u2208 M, the Wasserstein-p metric is defined by\nZ Z\n|x \u2212 y|p \u03bb(dxdy)\nWp (\u03bc0 , \u03bc1 ) := inf\n\u03bb\n\n\u03a9\n\n\u03a9\n\n(0)\n\nwhere the infimum is on all probability measures on \u03a9 \u00d7 \u03a9 such that \u03c0# \u03bb = \u03bc0 ,\n(1)\n\n\u03c0# \u03bb = \u03bc 1 .\n\u2022 E\u03bc (\u03c8) :=\n\nRT R\n0\n\n\u03a9 \u03c8(x, t)\u03bc(t) (dx)dt.\n\nLikewise, E\u03bc(t) (\u03c8) =\n\nR\n\n\u03a9 \u03c8(x, t)\u03bc(t) (dx).\n\n\u2022 A lifting \u03bd of \u03bc \u2208 MI is a Borel measure on \u03a9I \u00d7 Rn such that\nZ TZ Z\n\u03c8(x, t)\u03bd(dxdtdv) = E\u03bc (\u03c8) ; E\u03bd (\u03c8t + v * \u2207x \u03c8) = 0\nE\u03bd (\u03c8) :=\n0\n\n\u03a9\n\nRn\n\nfor all \u03c8 \u2208 C01 (\u03a9I ).\n\n2\n\nA metric space for measure's orbits\n\nWe start with the following\nDefinition 2.1. Let \u03bc \u2208 MI . Then \u03bc \u2208 Hp (I, M) if there exists a lifting \u03bd of \u03bc such that\nE\u03bd (|v|p ) < \u221e. We shall also define the Hp norm of \u03bc \u2208 Hp by:\n||\u03bc||p = inf [E\u03bd (|v|p )]1/p\n\u03bd\n\nwhere the infimum is taken over all liftings of \u03bc.\n\n8\n\n\fLemma 2.1. Hp is complete and locally compact under the weak C \u2217 topology if p > 1.\nThat is, for any bounded sequence \u03bcn in Hp we can extract a subsequence which converges in\nC \u2217 (\u03a9I ) to some \u03bc \u2208 Hp . In addition:\nlim ||\u03bcn ||p \u2265 ||\u03bc||p .\n\nn\u2192\u221e\n\nProof. By definition there exists a set of liftings \u03bdn corresponding to \u03bcn . Moreover, this\nsequence can be chosen so that E\u03bdn (|v|p ) < C, so \u03bdn and v\u03bdn are tight on \u03a9I \u00d7 Rn (since\np > 1 and \u03a9I is compact). Hence the weak limit \u03bd of \u03bdn is a lifting of the weak limit \u03bc of \u03bcn ,\nand E\u03bd (|v|p ) < C, hence \u03bc \u2208 Hp . The same argument also yields the lower-semi-continuity\nof Hp .\nLemma 2.2. If \u03bc = \u03bc(t) dt \u2208 Hp , p > 1 then the map t \u2192 \u03bc(t) is a Holder (p \u2212 1)/p\ncontinuous function from I into M with respect to the weak (C \u2217 ) topology equipped with the\nWasserstein-1 norm W1 :\nZ\nW1 (\u03bc0 , \u03bc1 ) = sup\n\u03c6(\u03bc1 (dx) \u2212 \u03bc0 (dx)) .\n(2.1)\n|\u2207\u03c6|\u22641 \u03a9\n\nProof. We know that an optimal lifting \u03bd exists for \u03bc \u2208 Hp . The measure \u03bd can be decomposed, by the Theorem of measure's decomposition [AFP], into \u03bd = \u03bc(t) (dx)\u03bdx,t (dv)dt, for \u03bc\na.a. (x, t). We may define now the velocity field\nv(x, t) = E\u03bdx,t (v)\nfor \u03bc a.a. (x, t). It follows that v \u2208 Lp\u03bc and, moreover,\n\u00151/p\n\u0014Z\np\n.\n|v| \u03bc(dxdt)\n||\u03bc||p =\n\u03a9I\n\nBy assumption:\nZ Z\nI\n\n\u03a9\n\n\u2202\u03c6\n\u03bc (dx)dt = \u2212\n\u2202t (t)\n\nZ Z\nI\n\n\u03a9\n\nv * \u2207x \u03c6\u03bc(t) (dx)dt\n\n(2.2)\n\n1\n1\n1\nwhere \u03c6 =\nR \u03c6(x, t) is in C0 (\u03a9I ). Let \u03c6(x, t) = h(t)\u03a6(x) with \u03a6 \u2208 C (\u03a9) and h \u2208 C0 (I). Then\nf\u03a6 (t) := \u03a9 \u03a6(x)\u03bc(t) (dx) satisfies\n\nZ\n\nT\n\n0\n\n\u2032\n\nf\u03a6 (t)h (t)dt = \u2212\n\nZ\n\nT\n\nh(t)\n\n0\n\nZ\n\n\u03a9\n\n\u2207\u03a6 * v\u03bc(t) (dx)dt .\n\nBy Holder inequality\nZ\n\n0\n\nT\n\nh(t)\n\nZ\n\n\u03a9\n\n\u2207\u03a6 * v\u03bc(t) (dx)dt \u2264 |\u2207\u03a6|\u221e\n\n\u0014Z\n\nT\n\nq\n\nh (t)dt\n0\n\n\u00151/q\n\n||\u03bc||p\n\nwith q = p/(p \u2212 1). It follows that f\u03a6 \u2208 W1,p (I) and, moreover, ||f\u03a6 ||1,p \u2264 C||\u03a6||1,\u221e . This\nimplies the result by Sobolev imbedding together with the dual formulation of the W1 norm\n(2.1).\n9\n\n\fGiven \u03bc0 and \u03bc1 \u2208 M, define the set\n\b\n\u039bp (\u03bc0 , \u03bc1 ) := \u03bc = \u03bc(t) dt \u2208 Hp ; \u03bc(0) = \u03bc0 , \u03bc(T ) = \u03bc1 ;\n\n.\n\nCorollary 2.1. The set \u039bp (\u03bc0 , \u03bc1 ) where p > 1 is closed and locally compact in C(I; C \u2217 (\u03a9)).\nSimilar versions of the Lemma and Proposition below can be found in [Am]. We also note\nthat Proposition 2.1 in the case p = 2 is a special case of our main Theorem (see section 3).\nLemma 2.3. ( Regularization Lemma): If \u03bc \u2208 Hp then there exists a sequence \u03bc\u03b5 \u2208 Hp\nof smooth density so that \u03bc = lim\u03b5\u21920 \u03bc\u03b5 holds in C \u2217 (\u03a9I ) and, moreover,\nlim ||\u03bc\u03b5 ||p = ||\u03bc||p .\n\n\u03b5\u21920\n\nIn addition, for any t0 , t1 \u2208 I,\nlim Wp (\u03bc\u03b5t0 , \u03bc\u03b5t1 ) = Wp (\u03bc(t0 ) , \u03bc(t1 ) ) .\n\n\u03b5\u21920\n\nWe next consider the relation between Hp and the optimal solution of the Kantorovich\nproblem.\nProposition 2.1. Assume p \u2265 1. Let \u03bc0 , \u03bc1 \u2208 M. Then \u039bp (\u03bc0 , \u03bc1 ) 6= \u2205. and\ninf\n\n\u03bc\u2208\u039bp (\u03bc0 ,\u03bc1 )\n\n||\u03bc||p = Wp (\u03bc0 , \u03bc1 ) .\n\nThe proof is similar to the proof of Theorem 4.2 of Ambrosio [Am] for the metric case\n(p = 1) .\nWe note that Corollary 2.1 is not valid in the case p = 1. To see it, consider the measure:\nX\n\u03bc=\n\u03b1j (t)\u03b4(x\u2212xj (t) dt\nj\n\nP\n1 (I, R) such that\nwhere xj = xj (t) \u2208 C 1 (I; \u03a9) and \u03b1j \u2208 C+\nj \u03b1j (t) = 1 \u2200t \u2208 I. We can\napproximate \u03bc by a sequence of measures \u03bcm \u2208 \u039b1 (\u03bc0 , \u03bc1 ) as follows: For each m \u2208 N consider\n(m)\nthe division tk = k/m, 0 \u2264 k \u2264 m of I. Let \u03bbm,k be the optimal solution of Kantorovich\n(m)\n(m)\n(m)\n(t)\nproblem due to W1 (\u03bc(t(m) ) , \u03bc(t(m) ) ), and Tm,k := Id + (t \u2212 tk ) [Tm,k \u2212 Id] /(tk+1 \u2212 tk ).\n\nDefine \u03bcm as follows:\n\nk\n\nk+1\n\n(m)\n\n(t)\n\n\u03bcm,(tk ) = \u03bc(tk ) ; \u03bcm,(t) = Tm,k,# \u03bcm,(tk ) ; tk\n\n(m)\n\n\u2264 t \u2264 tk+1 .\n\nThen, by Proposition 2.1, \u03bcm are bounded in H1 and \u03bcm \u2192 \u03bc. However, \u03bc 6\u2208 H1 unless \u03b1j\nare constants in t. To see it, note that the continuity equation takes the form\nXZ\nXZ\n\u2212\u03b1\u0307j \u03c6(xj (t), t)+[vj (t)\u2212\u1e8bj ]*\u2207x \u03c6(xj (t), t)dt\n(\u03b1j (t)\u03c6t (xj (t), t)+vj (t)*\u2207x \u03c6(xj (t), t)dt =\n0=\nj\n\nI\n\nj\n\nI\n\nwhere vj (t) are the velocities attributed to xj . It is evident that, unless \u03b1\u0307j \u2261 0, for any\npossible choice of vj one can find \u03c6 = \u03c6(x, t) for which the integral on the right does not\nvanish.\n10\n\n\f3\n\nMain results\n\nLet the pressure P = P (x, t) \u2208 C 1 (\u03a9I ) and the associated action:\nZ\n1\n2\nLP (\u03bc) := ||\u03bc||2 +\nP \u03bc(dxdt) ; \u03bc \u2208 H2 .\n2\n\u03a9I\nLet us recall the definition of the action JP :\n\u001aZ t2 \u0014\n\u0015\n|\u1e8b(t)|2\nJP (x, y, t1 , t2 ) = inf\n+ P (x(t), t) dt\nx\n2\nt1\n\n(3.1)\n\n; x : [t1 , t2 ] \u2192 \u03a9, x(t1 ) = x , x(t2 ) = y\n\n\u001b\n\n(3.2)\nRemark: Note that JP is not a function on \u03a9 =\nin each of the variables x, y,\nseparately. However, for each q \u2208 Zn and each x, y \u2208 Rn , t1 , t2 \u2208 I, JP (x + q, y + q, t1 , t2 ) =\nJP (x, y, t1 , t2 ).\nRn /Zn\n\nDefinition 3.1. (L) (the relaxed Lagrangian):\nL(\u03bc0 , \u03bc1 ) :=\n\ninf\n\n\u03bc\u2208\u039b2 (\u03bc0 ,\u03bc1 )\n\nLP (\u03bc) .\n\nDefinition 3.2. (M). (the Monge problem):\nZ\nJP (x, T(x), 0, T )\u03bc0 (dx) .\nM(\u03bc0 , \u03bc1 ) := inf\nT# \u03bc0 =\u03bc1\n\n\u03a9\n\nDefinition 3.3. (K). (the Kantorovich problem):\nZ\nJP (x, y, 0, T )\u03bb(dxdy)\nK(\u03bc0 , \u03bc1 ) := inf\n\u03bb\n\n\u03a9\n\namong all probability measures on \u03a9 \u00d7 \u03a9 with the same \u03a9 marginals \u03bc0 , \u03bc1 .\nWe now introduce the Hamilton-Jacobi (HJ) equation\n\u2202\u03c6 1\n+ |\u2207x \u03c6|2 = P .\n\u2202t\n2\n\n(3.3)\n\nLet us denote the set of classical sub-solutions of the H-J equation as\n\u001a\n\u001b\n1\n2\n\u2217\n1\n\u039bP := \u03c6 \u2208 C (\u03a9I ) ; \u03c6t + |\u2207x \u03c6| \u2264 P \u2200(x, t) in \u03a9I .\n2\nFor our purpose we need a generalization of the concept of a classical sub-solution. The\nconcept of viscosity sub-solution (see, e.g. [E]) is too restrictive for us. So, we define a\ngeneralized sub-solution of the H-J equation as follows:\nThe set of generalized sub solution of the H-J equation is given by\n\b\n\u2217\n\u039bP := \u03c6 \u2208 LIP (\u03a9I ) ; \u2200x \u2208 C 1 (I; \u03a9),\n\nd\n1\n2\n\u03c6(x(t), t) \u2264 \u1e8b(t) + P (x(t), t) holds f or Lebesgue a.e t \u2208 I\ndt\n2\n11\n\n\u001b\n\n(3.4)\n\n.\n\n\fRemark (i): Note that \u03c6(x(t), t) is a Lipschitz function on I if \u03c6 is Lipschitz and x \u2208 C 1 (I).\nHence it is a.e. differentiable (as a function of t) on I by Rademacher's Theorem (see, e.g.,\n[E]).\nRemark (ii): It is not difficult to see that any classical sub-solution is also generalized sub\n\u2217\nsolution, so \u039b\u2217P \u2282 \u039bP . The concept of generalized sub-solution is more general than that of\na viscosity sub-solution. The relation between generalized sub-solutions and viscosity (and\nanti-viscosity) sub-solutions is discussed in section 5.1.\nDefinition 3.4. (E): (The Euler formulation):\n\u001b\n\u001aZ\nZ\nE(\u03bc0 , \u03bc1 ) := sup\n\u03c6(x, 0)\u03bc0 (dx) .\n\u03c6(x, T )\u03bc1 (dx) \u2212\n\u2217\n\n\u03c6\u2208\u039b (P )\n\n\u03a9\n\n\u03a9\n\nWe now state our main result:\nMain Theorem:\nAssume P \u2208 C 1 (\u03a9I ). For any \u03bc0 , \u03bc1 \u2208 M:\nK(\u03bc0 , \u03bc1 ) = L(\u03bc0 , \u03bc1 ) = E(\u03bc0 , \u03bc1 ) .\n\n(3.5)\n\u2217\n\nThere exists minimizers \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ) of L (Definition 3.1) and a maximizer \u03c8 \u2208 \u039bP of E\n(Definition 3.4) such that\n1\n(3.6)\n\u03c8t + |\u2207x \u03c8|2 = P ; a.e on \u03a9I .\n2\nAssume, in addition, there exists C(t) > 0 on I0 so that P (x, t) \u2212 C(t)|x|2 is a concave\nfunction on Rn for any t \u2208 I0 . Then, for maximizer \u03c8 of E(\u03bc0 , \u03bc1 ), there exists a closed set\nK \u2282 \u03a9I such that\n\ni) The restriction of \u03c8 to K0 := K \u2229 \u03a9I0 is continuously differentiable, the equality (3.6)\nholds for any (x.t) \u2208 K0 and \u2207x \u03c8 is Locally Lipschitz continuous on K0 .\nii) Let v be a Lipschitz extension of \u2207x \u03c8 to \u03a9I0 . Let T = Ttt21 be the flow generated by v.\nThen K0 is invariant under this flow.\niii) A minimizer \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ) of L is not necessarily unique. However, any such minimizer\nis supported in K and the vectorfield v = \u2207x \u03c8 is uniquely defined on the support of\nany such minimizer.\niv) Any such minimizer is transported by the flow T, that is\n\u0002 t2 \u0003\nTt1 # \u03bc(t1 ) = \u03bc(t2 )\n\nholds for any t1 , t2 \u2208 (0, T ). Moreover, if t1 = 0 (res. t2 = T ) then Tt0 := lim\u03c4 \u21920 Tt\u03c4\n(res. TTt = lim\u03c4 \u2192T T\u03c4t ) are continuous maps transporting \u03bc0 to \u03bc(t) (res. \u03bc(t) to \u03bc1 ).\n\nv) The map Ttt21 are optimal with respect to the cost function c(x, y) = JP (x, y, t1 , t2 ) and\nthe measures \u03bc(t1 ) , \u03bc(t2 ) , where either t1 \u2208 I, t2 \u2208 I0 or t1 \u2208 I0 , t2 \u2208 I.\n1,1\nvi) If P \u2261 0 then the optimal solution \u03c8 of E (Definition 3.4) is in Cloc\n(\u03a9I0 ). In particular,\nthe flow T can be defined anywhere in terms of \u03c8 as\n\nTtt21 (x) = x + (t2 \u2212 t1 )\u2207x \u03c8(x, t1 ) , \u2200t1 < t2 \u2208 I0 , \u2200x \u2208 \u03a9 .\n12\n\n\f4\n\nDual representation\n\nThe key duality argument for minimizing convex functionals under affine constraints is summarized in the following proposition whose proof is given in the appendix:\nProposition 4.1. Let C a real Banach space and C\u2217 the its dual. Denote the duality C + C\u2217\nrelation by < c\u2217 , c >\u2208 R. Let Z a subspace of C and h \u2208 C\u2217 . Let Z\u2217 \u2282 C\u2217 given by the\ncondition z \u2217 \u2208 Z\u2217 iff < z \u2217 \u2212 h, z >= 0 for any z \u2208 Z. Let F : C\u2217 \u2192 R \u222a {\u221e} a convex\nfunction and\nI := \u2217inf \u2217 F(c\u2217 ) .\nc \u2208Z\n\nAssume further that A0 := {c\u2217 \u2208 C\u2217 ; F(c\u2217 ) \u2264 I} is compact (in the \u2217\u2212 topology of C\u2217 ).\nThen\nsup \u2217inf \u2217 [F(c\u2217 )\u2212 < c\u2217 , z > + < h, z >] = I .\nz\u2208Z c \u2208C\n\nIn particular, both sides equal \u221e if Z\u2217 = \u2205.\n\n4.1\n\nDual representation of H2\n\nWe shall apply Proposition 4.1 were the space C is all the continuous functions q = q(x, t, v)\non \u03a9I \u00d7 Rn subjected to:\n\u001a\n\u001b\n|q(x, t, v)|\nkqk :=\nsup\n<\u221e.\n(4.1)\n1 + |v|2\n(x,t,v)\u2208\u03a9I \u00d7Rn\nThe dual space C\u2217 contains all finite Borel measures \u03bd on \u03a9I \u00d7 Rn of finite second moments:\nZ\nZ\n|v|2 |\u03bd|(dxdtdv) < \u221e .\n|\u03bd|(dxdtdv) < \u221e ;\n\u03a9I \u00d7Rn\n\n\u03a9I \u00d7Rn\n\nDefine the subspaces Z, Z0 of C as\n\b\nZ0 := z = \u03c6t + v * \u2207x \u03c6 ; \u03c6 \u2208 C01 (\u03a9I )\n\n\b\n\u2282 Z := z = \u03c6t + v * \u2207x \u03c6 ; \u03c6 \u2208 C 1 (\u03a9I0 ) \u2229 LIP (\u03a9I ) .\n\nGiven \u03bc0 , \u03bc1 \u2208 M, define h\u03bc0 ,\u03bc1 as a linear functional on Z as follows:\nZ\nZ\n\u03c6(x, 0)\u03bc0 (dx) for z \u2208 Z ,\n\u03c6(x, T )\u03bc1 (dx) \u2212\n< h\u03bc0 ,\u03bc1 , z >:=\n\n(4.2)\n\n\u03a9\n\n\u03a9\n\n(in particular, < h\u03bc0 ,\u03bc1 , z >= 0 if z \u2208 Z0 ).\nLemma 4.1. The functional h\u03bc0 ,\u03bc1 , so defined, is continuous (bounded) on C.\n(0)\n\n(1)\n\nProof. Let \u03bb be a probability distribution on \u03a9 \u00d7 \u03a9 so that \u03c0# \u03bb = \u03bc0 , \u03c0# \u03bb = \u03bc1 . Then\nZ\n\n\u03a9\n\n\u03c6(x, T )\u03bc1 (dx) \u2212\n\nZ\n\n\u03c6(x, 0)\u03bc0 (dx) =\n\u03a9\n\nZ Z\n\n\u03a9\u00d7\u03a9\n\n13\n\n[\u03c6(y, T ) \u2212 \u03c6(x, 0)] \u03bb(dxdy) .\n\n(4.3)\n\n\fNow, for \u03b6(s) :=\n\n(T \u2212s)x+sy\nT\n\n\u03c6(y, T ) \u2212 \u03c6(x, 0) =\n\nZ\n\nT\n\n0\n\nwe obtain\n\nd\n\u03c6 (\u03b6(s), s) ds =\nds\n\nZ\n\nT\n\n\u0014\n\n0\n\n\u03c6t +\n\n\u0015\ny\u2212x\n* \u2207x \u03c6\nds\nT\n\u03b6(s),s\n\u0013\nZ T \u0012\ny\u2212x\nds (4.4)\nz \u03b6(s), s,\n=\nT\n0\n\nIn particular,\n|\u03c6(y, T ) \u2212 \u03c6(x, 0)| \u2264 max\n\nmax\n\n(x,t)\u2208\u03a9I |v|\u2264Diam(\u03a9/T )\n\n\"\n\n|z(x, t, v)| \u2264 kzk 1 +\n\n\u0012\n\nDiam(\u03a9)\nT\n\n\u00132 #\n\n,\n\nwhere we used the definition on the norm k * k on C given by (4.1). The proof follows from\n(4.2,4.3) and since \u03bb is a probability distribution on \u03a9 \u00d7 \u03a9.\nThe corresponding dual spaces are given by\n\u001a\n\u001b\nZ\n\u2217\n\u2217\nz(x, t, v)\u03bd(dxdtdv) = 0 , \u2200z \u2208 Z0\nZ0 := \u03bd \u2208 C ;\n\n(4.5)\n\n\u03a9I \u00d7Rn\n\n\u2283 Z\u2217\u03bc0 ,\u03bc1 :=\n\n\u001a\nZ\n\u03bd \u2208 C\u2217 ;\n\n\u03a9I \u00d7Rn\n\nz(x, t, v)\u03bd(dxdtdv) =< h\u03bc0 ,\u03bc1 , z > , \u2200z \u2208 Z\n\n\u001b\n\n.\n\nFor any \u03bc \u2208 H2 , a convex subset of C\u2217 is given by\n\u001b\n\u001a\nZ\nZ\n\u2217\n\u2217\n\u03c6(x, t)\u03bc(dxdt) \u2200 \u03c6 \u2208 C(\u03a9I )\n.\n\u03c6(x, t)\u03bd(dx, dt, dv) =\nC\u03bc := \u03bd \u2208 C ;\n\u03a9I \u00d7Rn\n\n\u03a9I\n\nFinally, F\u03bc : C\u2217 \u2192 R \u222a {\u221e} is defined by\n\u001a 1R\n2\n\u2217\n2 \u03a9I \u00d7Rn |v| \u03bd(dxdtdv) if \u03bd \u2208 C\u03bc\nF\u03bc (\u03bd) =\n\u221e\nif \u03bd 6\u2208 C\u2217\u03bc\nWe obtain\nLemma 4.2. The function F\u03bc is convex on C\u2217 for any \u03bc \u2208 H2 . In addition, if F\u03bc (\u03bd) < \u221e\nand \u03bd \u2208 Z\u22170 then \u03bd is a lifting of \u03bc. Similarly, if F\u03bc (\u03bd) < \u221e and \u03bd \u2208 Z\u2217\u03bc0 ,\u03bc1 then \u03bc \u2208\n\u039b2 (\u03bc0 , \u03bc1 ).\nProof. The proof of Lemma 4.2 is almost evident from the definitions. Let us just prove the\nlast part. Since Z\u2217\u03bc0 ,\u03bc1 \u2282 Z\u22170 it follows that \u03bd is a lifting of \u03bc \u2208 H2 . We only have to show\nthat \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ). Let \u03c6 \u2208 C 1 (\u03a9I0 ) \u2229 LIP (\u03a9I ), \u03b7 = \u03b7(t) \u2208 C01 (I) satisfies 0 \u2264 \u03b7 \u2264 1 on I\nand, for some \u03b5 > 0, \u03b7(t) = 1 for \u03b5 \u2264 t \u2264 T \u2212 \u03b5, and \u03b7t \u2265 0 on [0, \u03b5], \u03b7t \u2264 0 on [T \u2212 \u03b5, T ]. Set\n\u03c6(\u03b5) = \u03c6 on \u03a9 \u00d7 [\u03b5, T \u2212 \u03b5] and \u03c6(\u03b5) (x, t) = \u03c6(x, \u03b5) on t \u2208 [0, \u03b5] (res. \u03c6(\u03b5) (x, t) = \u03c6(x, T \u2212 \u03b5) on\nt \u2208 [T \u2212 \u03b5, T ]). Then \u03b7\u03c6(\u03b5) \u2208 C01 (\u03a9I ), so\n0=\n\nZ\n\n\u03a9I \u00d7Rn\n\nZ\ni\nh\n(\u03b5)\n(\u03b5)\n\u03bd(dxdtdv) =\n(\u03b7\u03c6 )t + \u03b7v * \u2207x \u03c6\n\n\u03b5\n\n14\n\nT \u2212\u03b5 Z\n\n\u03a9\u00d7Rn\n\n[\u03c6t + v * \u2207x \u03c6] \u03bd(t) (dxdv)dt\n\n\f+\n\nZ\n\n0\n\n+\n\n\u03b5Z\n\nZ\n\n\u03a9\u00d7Rn\n\n0\n\n\u03b5Z\n\n\u03b7t \u03c6(x, \u03b5)\u03bc(t) (dx)dt +\n\n\u03a9\n\n\u03b7v * \u2207x \u03c6(x, \u03b5)\u03bd(t) (dxdv)dt +\n\nZ\n\nT\nT \u2212\u03b5\n\nT\n\nZ\n\nT \u2212\u03b5\n\nZ\n\nZ\n\n\u03b7t \u03c6(x, T \u2212 \u03b5)\u03bc(t) (dx)dt\n\n\u03a9\n\n\u03b7v * \u2207x \u03c6(x, T \u2212 \u03b5)\u03bd(t) (dxdv)dt . (4.6)\n\n\u03a9\u00d7Rn\n\nSince \u03bd is a lifting of some \u03bc \u2208 H2 it follows that \u03bd(t) (dxdv) is a probability measure\nn . By the Cauchy-Schwartz inequality we estimate the last two integrals by\non \u03a9 \u00d7 Rp\n2k\u2207x \u03c6k\u221e E\u03bd (|v|2 )\u03b51/2 . By Lemma 2.2, \u03bc(t) is Holder continuous of exponent 1/2 in t,\nwith respect to the W1 topology, so\nZ \u03b5\nZ \u03b5Z\nZ \u03b5Z\n|\u03b7t |dt\n\u03b7t \u03c6(x, \u03b5)\u03bc(0) (dx)dt + O(\u03b51/2 )k\u2207x \u03c6k\u221e\n\u03b7t \u03c6(x, \u03b5)\u03bc(t) (dx)dt =\n0\n\n=\n\nZ\n\n\u03a9\n\n0\n\n\u03a9\n\n0\n\n\u03a9\n\n\u03c6(x, \u03b5)\u03bc(0) (dx) + O(\u03b51/2 )k\u2207x \u03c6k\u221e\n\nusing \u03b7t \u2265 0 on [0, \u03b5], hence\nZ\n\nT\n\nT \u2212\u03b5\n\nZ\n\n\u03a9\n\nR\u03b5\n0\n\n|\u03b7t | =\n\nR\u03b5\n\n\u03b5\n\n\u03b7t dt =\n\nZ\n\n\u03a9\n\n0\n\n\u03c6(x, \u03b5)\u03bc(0) (dx) + O(\u03b51/2 )k\u2207x \u03c6k\u221e ,\n(4.7)\n\n\u03b7t = 1. Similarly\n\n0\n\n(\u03b7\u03c6)t \u03bc(t) (dx)dt = \u2212\n\nZ\n\nZ\n\n\u03a9\n\n\u03c6(x, T \u2212 \u03b5)\u03bc(T ) (dx) + O(\u03b51/2 )k\u2207x \u03c6k\u221e .\n\n(4.8)\n\nLetting \u03b5 \u2192 0 we obtain from (4.6, 4.7,4.8):\nZ\nZ\n\u0002\n\u0003\n\u03c6(x, T )\u03bc(T ) (dx) \u2212 \u03c6(x, 0)\u03bc(0) (dx) = 0 .\n[\u03c6t + v * \u2207x \u03c6] \u03bd(dxdtdv) \u2212\n\u03a9I \u00d7Rn\n\n\u03a9\n\nThe above is valid for any \u03c6 \u2208 C 1 (\u03a9I0 ) \u2229 LIP (\u03a9I ). Since \u03bd \u2208 Z\u2217\u03bc0 ,\u03bc1 by assumption, it follows\nthat \u03bc(0) = \u03bc0 and \u03bc(T ) = \u03bc1 , hence \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ).\nCorollary 4.1. If \u03bc \u2208 H2 then\n1\n||\u03bc||22 = \u2212 inf\n2\n\u03c6\u2208C01\n\n\u0010R\n\u00112\n\u001b\n\u03c6\n\u03bc(dxdt)\n\u03a9I t\n1\n.\n(\u03c6t + |\u2207x \u03c6|2 /2)\u03bc(dxdt) = sup R\n2 \u03c6\u2208C 1 \u03a9I |\u2207x \u03c6|2 \u03bc(dxdt)\n\u03a9I\n\n\u001aZ\n\nas well as\n\u2212\n\ninf\n\n\u03c6\u2208C 1 (\u03a9I0 )\u2229LIP (\u03a9I )\n\n\u001aZ\n\n\u03a9I\n\n(4.9)\n\n0\n\n2\n\n(\u03c6t + |\u2207x \u03c6| /2)\u03bc(dxdt) +\n=\n\n\u001a\n\n1\n2\n2 ||\u03bc||2\n\n\u221e\n\nZ\n\n\u03a9\n\n\u03c6(x, 0)\u03bc0 (dx) \u2212\n\nif \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 )\nif \u03bc \u2208\n6 \u039b2 (\u03bc0 , \u03bc1 )\n\n15\n\n.\n\nZ\n\n\u03a9\n\n\u001b\n\u03c6(x, T )\u03bc1 (dx)\n(4.10)\n\n\fProof. Certainly, F\u03bc satisfies all the conditions of Proposition 4.1. Using Lemma 4.2 and\nProposition 4.1 in the definition of k\u03bck2 (Definition 2.1 for p = 2) we obtain that\n1\nk\u03bck22 = inf\u2217 F\u03bc (\u03bd) = sup inf \u2217 (F\u03bc (\u03bd)\u2212 < \u03bd, z >)\n\u03bd\u2208Z\n2\nz\u2208Z \u03bd\u2208C\n\u0015\n\u0014\nZ\n1 2\n|v| \u2212 \u03c6t \u2212 v * \u2207x \u03c6 \u03bd(dxdtdv)\n= sup\ninf \u2217\n\u03c6\u2208C01 (\u03a9I ) \u03bd\u2208C\u03bc \u03a9I \u00d7Rn 2\n\u0014\n\u0015\nZ\n1\n1\n2\n2\n= sup\ninf \u2217\n|v \u2212 \u2207x \u03c6| \u2212 \u03c6t \u2212 |\u2207x \u03c6| \u03bd(dxdtdv)\n2\n\u03c6\u2208C01 (\u03a9I ) \u03bd\u2208C\u03bc \u03a9I \u00d7Rn 2\n\u001b\n\u0015\n\u001a Z \u0014\nZ\n1\n1\n2\n2\n|v \u2212 \u2207x \u03c6| \u03bd(dxdtdv) .\ninf\n= sup\n\u2212\n\u03c6t + |\u2207x \u03c6| \u03bc(dxdt) +\n2\n2 \u03bd\u2208C\u2217\u03bc \u03a9I \u00d7Rn\n\u03a9I\n\u03c6\u2208C 1 (\u03a9I )\n0\n\nSo, we set \u03bd = \u03bc\u03b4v\u2212\u2207x \u03c6 to annihilate the second integral and obtain the first equality in (4.9).\nFor the second equality in (4.9) we observe\n\u001b\n\u001b\n\u001aZ\n\u001aZ\n(\u03b2\u03c6t + \u03b2 2 |\u2207x \u03c6|2 /2)\u03bc(dxdt)\n(\u03c6t + |\u2207x \u03c6|2 /2)\u03bc(dxdt) = inf inf\ninf\n\u03c6\u2208C01\n\n\u03c6\u2208C01 \u03b2\u2208R\n\n\u03a9I\n\n\u03a9I\n\n\u00112 \uf8f6\n\u03c6\n\u03bc(dxdt)\n\uf8ec 1 \u03a9I t\n\uf8f7\n= inf \uf8ed\u2212 R\n\uf8f8 .\n2 \u03a9I |\u2207x \u03c6|2 \u03bc(dxdt)\n\u03c6\u2208C01\n\uf8eb\n\n\u0010R\n\nFinally, we obtain (4.10) using the constraint Z\u2217\u03bc0 ,\u03bc1 for Z\u2217 in Proposition 4.1.\nRT\nP\nExample: P\nLet \u03bc = ki=1 \u03b2k \u03b4(x\u2212xk (t)) where xk : I \u2192 \u03a9 satisfies 0 |\u1e8bj |2 dt := |\u1e8bj |2 < \u221e\nand \u03b2j \u2265 0, j \u03b2j = 1. Then\nZ\n\n\u03c6t \u03bc(dxdt) =\n\n\u03a9I\n\nand\n\nZ\n\n\u03a9I\n\nX\n\n\u03b2j\n\nj\n\n|\u2207x \u03c6|2 \u03bc(dxdt) =\n\nX\n\n\u03b2j\n\nj\n\nZ\n\nT\n\n0\n\nZ\n\n0\n\nT\n\n\u2202\u03c6\n(xj (t), t)dt\n\u2202t\n\n|\u2207x \u03c6|2 (xj (t), t)dt\n\nOn the other hand,\n\u0015\nZ T\nZ T\u0014\n\u2202\u03c6\nd\u03c6\n(xj (t), t)dt =\n(xj (t), t) \u2212 \u1e8bj (t) * \u2207x \u03c6(xj (t), t) dt\ndt\n0 \u2202t\n0\nZ T\n\u1e8bj (t) * \u2207x \u03c6(xj (t), t)dt\n=\u2212\n0\n\nso, by an application (twice) of the Cauchy-Schwartz inequality,\n\u00112\n\u0010P\n\u00112\n\u0010R\nRT\n\u2207\n\u03c6(x\n(t),\nt)\n*\n\u1e8b\ndt\n\u03b2\n\u03c6\n\u03bc(dxdt)\nX Z T\nx\nj\nj\nj\nt\nj\n0\n\u03a9I\nR\n|\u1e8bj |2 dt .\n\u2264\n\u03b2j\n=\nRT\nP\n2 \u03bc(dxdt)\n2 dt\n|\u2207\n\u03c6|\nx\n0\n|\u2207\n\u03c6(x\n(t),\nt)|\n\u03b2\n\u03a9I\nx\nj\nj\nj\n\nj\n\n0\n\n16\n\n\fIn fact, it can be shown that ||\u03bc||22 coincides with the above sum, and that there exists a\nmaximizing sequence \u03c6n (x, t) such that \u2207x \u03c6n (xj (t), t) \u2192 \u1e8bj (t) for all j and a.e t \u2208 I (even if\nsome of the orbits xj intersect (!)-see [W]).\n\n4.2\n\nDual representation of the Lagrangian\n\nWe shall now define a strong convex perturbation of the Lagrangian LP (Definition 3.1). Let\nalso F : R \u2192 R+ \u222a {\u221e} such that\nF (q) = \u221e if q < 0 ; F (0) = 0\n\n;\n\ncq \u03c9 < F (q) < Cq \u03c9 if q > 0\n\n(4.11)\n\nwhere 1 < \u03c9 < 1 + 1/(n + 1) and c, C > 0. The functional I\u03b5P : C\u2217 \u2192 R \u222a {\u221e} is defined by:\nZ\nZ\nZ\n1\n2\nP\nP (x, t)\u03bd(dxdtdv), (4.12)\n\u03b5F (f\u03bd ) dxdtdv +\n|v| \u03bd(dxdtdv)+\nI\u03b5 (\u03bd) :=\n2 \u03a9I \u00d7Rn\n\u03a9I \u00d7Rn\n\u03a9I \u00d7Rn\nif \u03bd = f\u03bd (x, t, v)dxdtdv is absolutely continuous with respect to Lebesgue measure and the\ndensity f\u03bd satisfies F (f\u03bd ) \u2208 L1 (\u03a9I \u00d7 Rn ). Otherwise I\u03b5P (\u03bd) = \u221e. Note that, since F (q) = \u221e\nfor q < 0, it follows that I\u03b5P (\u03bd) = \u221e if \u03bd \u2208 C\u2217 is not a non-negative measure. However, I\u03b5P\ncan attain a finite value also for a measure \u03bd which is not normalized (i.e not a probability\nmeasure on \u03a9I \u00d7 Rn ).\nGiven \u03bc0 , \u03bc1 \u2208 M, define\nI\u03b5P (\u03bc0 , \u03bc1 ) :=\n\ninf\n\n\u03bd\u2208Z\u2217\u03bc0 ,\u03bc1\n\nI\u03b5P (\u03bd) .\n\n(4.13)\n\nNext, we claim\nLemma 4.3. For any \u03b5 > 0,\nI\u03b5P (\u03bc0 , \u03bc1 ) \u2265 L(\u03bc0 , \u03bc1 )\nwhere L(\u03bc0 , \u03bc1 ) as in Definition 3.1.\nProof.\nFirst, we can restrict ourselves to non-negative measures \u03bd \u2208 Z\u2217\u03bc0 ,\u03bc1 , since otherwise\nR\nF (f\u03bd ) = \u221e by (4.11). We only have to show that if \u03bd \u2265 0 and \u03bd \u2208 Z\u2217\u03bc0 ,\u03bc1 then \u03bd is a lifting\nof some \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ).\nUsing Lemma 4.2 it is, therefore, enough to prove that \u03bdt (dxdv) is a probability measure\non \u03a9 \u00d7 Rn for a.e (Borel) t \u2208 I. Setting \u03c6(x, t) = \u03b7(t) \u2208 C01 (I) we obtain from (4.5) that\n\u0013\nZ \u0012Z\nd\u03b7\n\u03bdt (dxdv)\ndt = 0\ndt\nn\nI\n\u03a9\u00d7R\nR\nfor any such \u03b7. This implies that \u03a9\u00d7Rn \u03bdt (dxdv) is constant for a.e. t \u2208 I. Since \u03bd \u2265 0 it\nimplies that \u03bdt is a constant multiple of some probability measure on \u03a9 \u00d7 Rn for a.e. t \u2208 I.\nThis constant equals one since the \u03a9 marginal of \u03bdt is C \u2217 continuous on I by Lemma 2.2 and\nis a probability measure at t = 0 (\u03bc0 ) and t = T (\u03bc1 ).\n\n17\n\n\fWe now proceed to a dual formulation of the constraint minimization of I\u03b5p. Certainly\nI\u03b5P satisfies the assumption on F introduced in Proposition 4.1. In fact, it follows that the\nset {\u03bd \u2208 C\u2217 ; I\u03b5P (\u03bd) < C} is bounded (and hence \u2217\u2212compact) for any real C. Then\nProposition 4.1 and (4.13) yield\n\u0002\n\u0003\nI\u03b5P (\u03bc0 , \u03bc1 ) = sup inf \u2217 I\u03b5P (\u03bd)\u2212 < \u03bd, z > + < h\u03bc0 ,\u03bc1 , z >\nz\u2208Z \u03bd\u2208C\n\n=\n\nsup\n\ninf\n\n\u03c6\u2208C 1 (\u03a9I ) f\n\nZ\n\n\u03a9I \u00d7Rn\n\nZ\n\n\u03a9\n\n\u0014\n\n\u03b5F (f ) \u2212 f\n\n\u0012\n\n1\n\u03c6t + v * \u2207x \u03c6 \u2212 |v|2 \u2212 P\n2\n\n\u0013\u0015\n\ndxdtdv+\n\n\u03c6(x, T )\u03bc1 (dx) \u2212 \u03c6(x, 0)\u03bc0 (dx) ,\n\nwhere inf f stands for the infimum on all measurable functions on \u03a9I \u00d7 Rn . Let\n\u0013 \u0015\n\u0014\n\u0012\nZ\n1 2\nH\u03b5 (f, \u03c6) :=\n\u03b5F (f ) \u2212 \u03c6t + v * \u2207x \u03c6 \u2212 |v| \u2212 P f dxdtdv .\n2\n\u03a9I \u00d7Rn\n\u0014\n\u0012\n\u0013 \u0015\nZ\n1\n1\n2\n2\ndxdtdv \u03b5F (f ) \u2212 \u03c6t + |\u2207x \u03c6| \u2212 |v \u2212 \u2207x \u03c6| \u2212 P f\n=\n2\n2\n\u03a9I \u00d7Rn\nLet F \u2217 be the Legendre transform of F :\n\nF \u2217 (\u03bb) = sup [s\u03bb \u2212 F (s)] .\ns\n\nBy our assumption we know that F \u2217 is also convex and non-negative on R. It satisfies\nF \u2217 (\u03bb) = 0 for \u03bb \u2264 0. Now,\n\u0012\n\u0013\nZ\n2\n2\n\u2217 \u03c6t + |\u2207x \u03c6| /2 \u2212 |v \u2212 \u2207x \u03c6| /2 \u2212 P\nF\ninf H\u03b5 (f, \u03c6) = \u2212\u03b5\ndxdtdv\nf\n\u03b5\n\u03a9I \u00d7Rn\n1+n/2\n\n= \u2212\u03b5\n\nZ\n\nF\n\n\u03a9I \u00d7Rn\n\n\u2217\n\n\u0012\n\nLet\nG(s) :=\nand\n1+n/2\n\n\u03a8\u03b5 (\u03c6) := \u2212\u03b5\n\nZ\n\nG\n\u03a9I\n\n\u0012\n\n|v|2\n\u03c6t + |\u2207x \u03c6|2 /2 \u2212 P\n\u2212\n\u03b5\n2\n\nZ\n\nRn\n\nF \u2217 (s \u2212 |v|2 /2)dv\n\n\u03c6t + |\u2207x \u03c6|2 /2 \u2212 P\n\u03b5\n\n\u0013\n\ndxdt +\n\nZ\n\n\u03a9\n\nLemma 4.4. For \u03b5 > 0 and \u03bc0 , \u03bc1 \u2208 M,\nsup\n\u03c6\u2208C 1 (\u03a9I0 )\u2229LIP (\u03a9I )\n\n18\n\ndxdtdv\n\n(4.14)\n\n\u03c6(x, T )\u03bc1 (dx) \u2212 \u03c6(x, 0)\u03bc0 (dx)\n\nWe have proved:\n\nI\u03b5P (\u03bc0 , \u03bc1 ) =\n\n\u0013\n\n\u03a8\u03b5 (\u03c6) .\n\n(4.15)\n\n\fWe shall also need the following result, whose proof is direct and omitted:\nLemma 4.5. If F satisfies (4.11) then, for some constant c > 0, the function G defined in\n(4.14) satisfies cq \u03c9/\u03c9\u22121 < G(q) < c\u22121 q \u03c9/\u03c9\u22121 . Thus, the first integral of (4.15) is estimated\nby\n\u0012\n\u0013\nZ\nZ\ns\n\u03c6t + |\u2207x \u03c6|2 /2 \u2212 P\n|\u2207x \u03c6|2\n1+n/2\n\u2212\u03b1\nG\n\u2212\u03b5\n\u2212 P dxdt\n\u03c6t +\ndxdt = \u2212O(\u03b5 )\n\u03b5\n2\n\u03a9I\n\u03a9I\nwhere \u03b1 = 1/(\u03c9 \u2212 1) \u2212 n/2 > 0 and s = \u03c9/(\u03c9 \u2212 1) > 1 + n (c.f. (4.11)).\nWe also need:\nLemma 4.6. Let \u03bc0 , \u03bc1 \u2208 M. Then there exists a connecting orbit \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ) of finite\nH2 norm and a lifting \u03bd such that both \u03bc and \u03bd has densities in Lp (\u03a9I ) (res. Lp (\u03a9I \u00d7 Rn )),\nwhere 1 \u2264 p < 1 + 1/n.\nIn particular. it follows that for such \u03bd as guaranteed in Lemma 4.6, each of the integrals\nin (4.12) is finite. Hence, there exists C > 0 (independent of \u03b5) and \u03bd \u2208 Z\u2217\u03bc0 ,\u03bc1 such that\nI\u03b5P (\u03bd) < C for any \u03b5 > 0. In particular, I\u03b5P (\u03bc0 , \u03bc1 ) < C for any such \u03b5 by (4.13). It follows\nfrom this, Lemma 4.3 and Lemma 4.4 that\nCorollary 4.2. For any \u03bc0 , \u03bc1 \u2208 M there exists C > 0 independent of \u03b5 where\nC>\n\nsup\n\u03c6\u2208C 1 (\u03a9I0 )\u2229LIP (\u03a9I )\n\n\u03a8\u03b5 (\u03c6) \u2265 L(\u03bc0 , \u03bc1 ) .\n\nLemma 4.6 is a direct result from Lemma 4.7 below. For its presentation we define the\nspace Hp ([t0 , t1 ]) by restricting Hp = Hp (I) to orbits defined for a time interval [t0 , t1 ]. The\nnorm of \u03bc \u2208 Hp ([t0 , t1 ]) is denoted by ||\u03bc||2,[t0 ,t1 ] . Lemma 4.7 is also used in the proof of\nLemma 5.8.\nLemma 4.7. For any t1 > t2 \u2208 I, any path x = x(t) : [t0 , t1 ] \u2192 \u03a9 and any \u03b1 > 0 there exists\nan orbit \u03bc(t) dt \u2208 Hp ([t0 , t1 ]) with \u03bc(t0 ) = \u03b4x0 , \u03bc(t1 ) = \u03b4x1 where xi = x(ti ), i = 0, 1, such that\nZ t1\n2\n2\n\u1e8b dt + C|t1 \u2212 t0 |\u03b1\u22122\n||\u03bc||2,[t0 ,t1 ] \u2264\nt0\n\nand \u03bc(t) (dx) = \u03c1(x, t)dx where \u03c1 \u2208\n\nLp (\u03a9\n\n\u00d7 [t0 , t1 ]) for any p \u2208 [1, 1 + 1/n). Moreover\n\"\n\u0012\n\u0013n(p\u22121) #1/p\n\u03b1\n|\u03c1|p \u2264 C(p) (t1 \u2212 t0 )\nt1 \u2212 t0\n\nand\n\n\u001a\n\u001b\nt1 \u2212 t0\nsupp(\u03c1) \u2282 (x, t) \u2208 \u03a9 \u00d7 [t0 , t1 ] ; |x(t) \u2212 x| \u2264 C\n\u2200 t \u2208 [t0 , t1 ] .\n\u03b1\n\nIn particular, the choice x(t) = x0 +\n\nt\u2212t0\nt1 \u2212t0 (x1\n\n||\u03bc||22,[t0 ,t1 ] \u2264\n\n\u2212 x0 ) yields\n\n|x1 \u2212 x0 |2\n+ C|t1 \u2212 t0 |\u03b1\u22122 .\nt1 \u2212 t0\n\nThe proof of Lemma 4.7 is given in the Appendix.\n19\n\n\f5\n5.1\n\nProof of main results\nOn the Hamilton-Jacobi Equation\n\nIn this section we introduce some fundamental results for the HJ equation\n1\n\u03c6t + |\u2207x \u03c6|2 = P\n2\n\n(x, t) \u2208 \u03a9I\n\n(5.1)\n\nwhere P \u2208 C 1 (\u03a9I ). The book of L.Evans [E] contains a detailed exposition on the HamiltonJacobi equation. However, the discussion in [E] is restricted to generalized solutions of viscosity type and for time independent Hamiltonians, which excludes the application of backward\nsolutions and time dependent pressure P = P (x, t) . The results in this section are all needed\nfor the proof of the Main Theorem in section 3\nWe list below some properties of the action JP (3.2):\nLemma 5.1. For P \u2208 C 1 (\u03a9I ), the action JP is satisfies the following:\n\n(a) For \u03c41 < \u03c42 \u2208 [0, T ] and x1 , x2 \u2208 Rn , the value of the action JP (x1 , x2 , \u03c41 , \u03c42 ) is realized\nalong a (possibly not unique) orbit x which satisfies the equation\n\u1e8d = \u2207x P (x(t), t) ; t \u2208 [\u03c41 , \u03c42 ] .\n\n(5.2)\n\n(b) Assume further that there exists C(t) > 0 so that P (x, t) \u2212 C(t)|x|2 is a concave function\non Rn for any t \u2208 I0 . Let x be an optimizer orbit connecting x1 , \u03c41 to x2 , \u03c42 . For any\ny \u2208 Rn and t \u2208 (0, T )\nJP (x1 , x2 , \u03c41 , \u03c42 ) \u2212 JP (x1 , y, \u03c41 , t) \u2265\n\u0014\n\n\u0015\n1\n\u1e8b(\u03c42 ) * (x2 \u2212 y) + P (x2 , \u03c42 ) \u2212 |\u1e8b|(\u03c42 ) (\u03c42 \u2212 t) \u2212 O(|x2 \u2212 y|2 ) \u2212 o(t \u2212 \u03c42 ) ,\n2\n\n(5.3)\n\nJP (y, x2 , t, \u03c42 ) \u2212 JP (x1 , x2 , \u03c41 , \u03c42 ) \u2264\n\u0014\n\n\u0015\n1\n\u1e8b(\u03c41 ) * (x1 \u2212 y) + P (x1 , \u03c41 ) \u2212 |\u1e8b|(\u03c41 ) (\u03c41 \u2212 t) + O(|x1 \u2212 y|2 ) + o(t \u2212 \u03c41 ) .\n2\n\n(5.4)\n\n(c) For any x1 , y, x2 \u2208 Rn , t1 < \u03c4 < t2\nJP (x1 , y, t1 , \u03c4 ) + JP (y, x2 , \u03c4, t2 ) \u2265 JP (x1 , x2 , t1 , t2 )\n\n(5.5)\n\nholds .\n(d) For any pair x1 , x2 \u2208 Rn and a triple t1 < \u03c4 < t2 there exists y \u2217 \u2208 Rn (possibly\nnon-unique) for which the equality holds in (5.5):\nJP (x1 , y \u2217 , t1 , \u03c4 ) + JP (y \u2217 , x2 , \u03c4, t2 ) = JP (x1 , x2 , t1 , t2 ) .\n\n(5.6)\n\nThere exists a (possibly non-unique) optimal orbit x connecting (x1 , t1 ) to (x2 , t2 ) such\nthat x(\u03c4 ) = y. However, for any such optimal orbit, \u1e8b(\u03c4 ) is determined uniquely.\n20\n\n\f(e) For any t > t1 x \u2208 Rn and a.e y \u2208 Rn\n\u2202\n1\nJP (x, y, t1 , t) + |\u2207y JP (x, y, t1 , t)|2 = P (y, t) .\n\u2202t\n2\n\n(5.7)\n\nDefinition 5.1. \u03c6(x, t) is a forward solution of (5.1) iff, for any x \u2208 \u03a9 and t1 > t0 \u2208 I\n\u03c6(x, t1 ) = infn [JP (y, x, t0 , t1 ) + \u03c6(y, t0 )] .\ny\u2208R\n\n(F)\n\nLikewise, \u03c6 is a backward solution iff\n\u03c6(x, t0 ) = sup [\u2212JP (x, y, t0 , t1 ) + \u03c6(y, t1 )] .\n\n(B)\n\ny\u2208Rn\n\nRemark: It follows, by the remark proceeding (3.2), that the right sides of (F) (res. (B))\ndefines a function which is Zn periodic on Rn , namely defined on \u03a9, if \u03c6(*, t0 ) (res. \u03c6(*, t1 ))\nis a function on \u03a9.\nFor the special case of zero-pressure Hamilton-Jacobi equation, the action is reduced to\nJ0 (x1 , x2 , t1 , t2 ) =\n\n|x2 \u2212 x1 |2\n2(t2 \u2212 t1 )\n\nand definition 5.1 reduces to the (original) Hopf-Lax formula:\nDefinition 5.2. A forward solution of the pressureless Hamilton-Jacobi equation\n1\n\u03c6t + |\u2207x \u03c6|2 = 0\n2\nsatisfies, for any t1 > t0 and x \u2208 \u03a9\n\u03c6(x, t1 ) = infn\ny\u2208R\n\n\u0014\n\n\u0015\n1 |x \u2212 y|2\n+ \u03c6(y, t0 ) ,\n2 t1 \u2212 t0\n\n(F0 )\n\nwhile a backward solution satisfies\n\u0014\n\u0015\n1 |x \u2212 y|2\n\u03c6(x, t0 ) = sup \u2212\n+ \u03c6(y, t1 ) .\n2 t1 \u2212 t0\ny\u2208Rn\n\n(B0 )\n\nA forward (backward) solution can be constructed from an initial (end) data at t = 0\n(t = T ) as follows.\nLemma 5.2. For any continuous initial data \u03c6(, 0) on \u03a9 and P \u2208 LIP (\u03a9I ),\n\u03c6(x, t) = infn [JP (y, x, 0, t) + \u03c6(y, 0)]\ny\u2208R\n\n(5.8)\n\nis a forward solution and satisfies (5.1) a.e. Moreover, \u03c6 \u2208 LIP (\u03a9 \u00d7 (0, T ]) and\nC\n|\u03c6(x, t) \u2212 \u03c6(y, t)|\n\u2264\n|x \u2212 y|\nt\n21\n\n(5.9)\n\n\fwhere C is a constant independent on \u03c6(, 0). Likewise, for any continuous end data \u03c6(, T )\n\u03c6(x, t) = sup [\u2212JP (x, y, 0, t) + \u03c6(y, 1)]\ny\u2208Rn\n\nis a backward solution and satisfies (5.1) a.e., \u03c6 \u2208 LIP (\u03a9 \u00d7 [0, T )) and\n|\u03c6(x, t) \u2212 \u03c6(y, t)|\nC\n\u2264\n|x \u2212 y|\nT \u2212t\n\n(5.10)\n\nIf, in either cases, the end data \u03c6(, 0) (res. \u03c6(, T )) is Lipschitz on \u03a9, then the corresponding\nforward (backward) solution is in LIP (\u03a9I ).\nNext, we establish the connection between generalized sub-solutions, as defined in (3.4),\nand forward/backward solutions:\nLemma 5.3. Both forward and backward solutions are generalized sub-solutions in the sense\nof (3.4). A forward (backward) solution is a maximal (minimal) generalized sub-solution\nin the following sense: If \u03c8 is a generalized sub-solution and \u03c6 is a forward (backward)\nsolution so that \u03c8(x, \u03c4 ) = \u03c6(x, \u03c4 ) for all x \u2208 \u03a9 and some \u03c4 \u2208 I, then \u03c6(x, t) \u2265 \u03c8(x, t)\n(\u03c6(x, t) \u2264 \u03c8(x, t)) for all x \u2208 \u03a9 and t \u2265 \u03c4 (t \u2264 \u03c4 ) in I.\nAn immediate corollary from Lemma 5.3 is:\nCorollary 5.1. Let \u03c6 be a forward solution and \u03c8 is a backward solution on \u03a9I .\ni) If \u03c6(x, T ) = \u03c8(x, T ) holds \u2200x \u2208 \u03a9 then \u03c8(x, t) \u2264 \u03c6(x, t) \u2200(x, t) \u2208 \u03a9I .\nii) Similarly, if \u03c6(x, 0) = \u03c8(x, 0) holds \u2200x \u2208 \u03a9 then \u03c8(x, t) \u2264 \u03c6(x, t) \u2200(x, t) \u2208 \u03a9I .\nNext, we wish to address the notion of a reversible solution:\nDefinition 5.3. A reversible pair {\u03c6, \u03c6} where \u03c6 (\u03c6) is a forward (backward) solution on \u03a9I\nsuch that \u03c6(x, 0) = \u03c6(x, 0) and \u03c6(x, T ) = \u03c6(x, T ) for any x \u2208 \u03a9. By Corollary 5.1, \u03c6 \u2265 \u03c6 on\n\u03a9I . For any such reversible pair we denote the reversibility set of the pair as the relatively\nclosed set K0 (\u03c6, \u03c6) \u2282 \u03a9I0 given by\nK0 (\u03c6, \u03c6) := {(x, t) \u2208 \u03a9I0 ; \u03c6(x, t) = \u03c6(x, t)} \u2282 \u03a9I0\nLikewise,\n(t)\n\nK0 (\u03c6, \u03c6) = K0 (\u03c6, \u03c6) \u2229 [\u03a9 \u00d7 {t}]\n\nfor any t \u2208 (0, T ) .\n\nIf \u03c6 \u2261 \u03c6 then \u03c6 := \u03c6 = \u03c6 is called a reversible solution.\nFrom Corollary 5.1 we obtain a way to create reversible pairs. It turns out that, in the\ncase P \u2261 0, this way yields reversible solutions:\nLemma 5.4. Given \u03c60 \u2208 LIP (\u03a9), let \u03c6 be the forward solution subjected to \u03c6(x, 0) = \u03c60 (x).\nLet \u03c8 be the backward solution subjected to \u03c8(x, T ) = \u03c6(x, T ), and \u03c8 the forward solution\nsubjected to\n\u03c8(x, 0) = \u03c8(x, 0) .\nThen {\u03c8, \u03c8} is a reversible pair. Moreover, if P \u2261 0 then \u03c8 = \u03c8 is a reversible solution.\n22\n\n\fThe next Lemmas indicate that reversible pairs (in particular, reversible solutions) are\nclosely related to classical solutions of the Hamilton-Jacobi equation.\nLemma 5.5. If \u03c6 \u2208 C 1 (\u03a9I ) is a classical solution of (5.1) then \u03c6 is a reversible solution.\nUsing Lemma 5.1 we show that the converse of Lemma 5.5 also holds, in some sense:\nLemma\nK0 (\u03c6, \u03c6)\nequation\nthen \u2207\u03c6\n\n5.6. If {\u03c6, \u03c6} is a reversible pair then both \u03c6 and \u03c6 are differentiable on K0 :=\n(cf., Definition 5.3). Moreover, \u2207\u03c6 := {\u2207x \u03c6, \u03c6t } = \u2207\u03c6 := {\u2207x \u03c6, \u03c6t } and the H.J\nis satisfied on this set. If, in addition, P satisfies the condition of Lemma 5.1-(b)\nis locally Lipschitz continuous on K0 and \u03c6 satisfies (5.1) pointwise on this set.\n\nLemma 5.7. Assume P satisfies the condition of Lemma 5.1-(b). Let v(x, t) be a Lipschitz\nextension of \u2207x \u03c6 from K0 to \u03a9I0 . Then the set K0 is invariant with respect to the (unique)\nflow generated by the vectorfield v.\nFinally, we introduce the two following results, to be needed in Section 5.3:\nLemma 5.8. If \u03c6 \u2208 C 1 (\u03a9 \u00d7 [t0 , t1 ]) satisfying\n1\n\u03c6t + |\u2207x \u03c6|2 = P + \u03be\n2\n\n; (x, t) \u2208 \u03a9 \u00d7 [t0 , t1 ]\n\nwhere P, \u03be \u2208 Lip(\u03a9\u00d7[t0 , t1 ]), s > n+1 and k\u03beks stands for the Ls (\u03a9\u00d7[t0 , t1 ]) norm of \u03be then,\nfor any x0 , x1 in \u03a9, any t1 > t0 and any orbit x = x(t) : [t0 , t1 ] \u2192 \u03a9 satisfying x(t0 ) = x0 ,\nx(t1 ) = x1 :\n1\n\u03c6(x1 , t1 )\u2212\u03c6(x0 , t0 ) \u2264\n2\nwhere \u03b2 =\n\np\n2p+n(p\u22121) ,\n\nZ\n\nt1\n\n2\n\n\u1e8b +\nt0\n\n, p = s\u2217 :=\n\nZ\n\nt1\n\nt0\n\n\u03bb\n\u03b7\n\u03b2\nP (x(t), t)dt+C1 ||\u03be||2\u03b2\ns (t1 \u2212t0 ) +C2 ||P ||lip (t1 \u2212t0 ) ||\u03be||s ,\n\ns\u22121\ns ,\n\n\u03bb=\n\n2+n\u2212np\n2p+np\u2212n ,\n\n\u03b7=\n\n4p+(n\u22121)(p\u22121)\n2p+n(p\u22121) .\n\nFrom Lemma 5.8 and Definition 5.1 we also obtain\nCorollary 5.2. Let \u03c6 \u2208 C 1 (\u03a9I ) be a solution and \u03c8 a forward solution of the respective\nequations on \u03a9I :\n\u03c6t + 1/2|\u2207x \u03c6|2 = P + \u03be\n\n;\n\n\u03c8t + 1/2|\u2207x \u03c8|2 = P\n\nsuch that \u03c8(x, 0) = \u03c6(x, 0) on \u03a9. Then\ni\nh\n\u03b2\n\u03c8(x, T ) \u2265 \u03c6(x, T ) \u2212 C1 ||\u03be||2\u03b2\n+\nC\n||P\n||\n||\u03be||\n2\nlip\ns\ns\n\nwhere s, \u03b2 as defined in Lemma 5.8.\n\n23\n\n\f5.2\n\nProof of auxiliary results\n\nProof. (of Lemma 5.1) We shall only establish part (b), since all the rest follows by standard\narguments.\nTo establish this part, let us redefine the action JP in terms of parameterized orbits\nx(s) \u2192 (y(s), \u03c4 (s)), s \u2208 [0, 1]. The optimal orbit is denoted x := {y, \u03c4 }. The action takes the\nform\n\u0015\nZ 1\u0014\n2\n1\n\u2032\n\u2032\nJP (x1 , x2 , \u03c41 , \u03c42 ) = inf\ny (s) + P (y(s), \u03c4 (s))\u03c4 (s) ds\n(5.11)\ny,\u03c4 0\n2\u03c4 \u2032 (s)\n\u2032\n\nwhere . stands for s derivative while {y, \u03c4 } are the set of orbits satisfying y(0) = x1 , y(1) = x2 ,\n\u2032\n\u03c4 (0) = t1 , \u03c4 (1) = t2 and \u03c4 > 0 on [0, 1] . An optimal orbit {y, \u03c4 } satisfies the Euler-Lagrange\nequations:\n\uf8f9\n\uf8ee\n\u0012\n\u0013\n\u2032 2\n\u2032\nd \uf8f01 y\n\u2032\n1 dy\nd\n(5.12)\n= \u03c4 Px (y, \u03c4 ) ;\n\u2212 P (y(s), \u03c4 (s))\uf8fb = \u2212P\u03c4 (y, \u03c4 )\u03c4 .\n\u2032\n\u2032\nds \u03c4 ds\nds 2 \u03c4\nNow let us replace x2 by y and \u03c42 by t. Deform the optimal orbit {y, \u03c4 } into\n\u1ef9(s) = y(s) + (y \u2212 x2 )s\n\n;\n\n\u03c4\u0303 (s) = \u03c4 (s) + (t \u2212 \u03c42 )s\n\nNow, {\u1ef9, \u03c4\u0303 } is an admissible orbit for the action with end-points (x1 , \u03c41 ) and (y, t). In\naddition, our assumption on P yields:\n\u2032\n\n\u2032\n\n\u2032\n\nP (\u1ef9(s), \u03c4\u0303 (s))\u03c4\u0303 (s) \u2264 P (y(s), \u03c4 (s))\u03c4 (s) + \u03c4 (s)Px (y(s), \u03c4 (s))(\u1ef9 \u2212 y)\n\u2032\n\n\u2032\n\n\u2032\n\n+ \u03c4 (s)Pt (y(s), \u03c4 (s))(\u03c4\u0303 \u2212 \u03c4 ) + (\u03c4\u0303 \u2212 \u03c4 )P (y(s), \u03c4 (s)) + O2 (|\u1ef9 \u2212 y|) + o(\u03c4\u0303 \u2212 \u03c4 ) , (5.13)\n\nas well as\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n\u2032\n\n|y |2 y (\u1ef9 \u2212 y ) |y |2 (\u03c4\u0303 \u2212 \u03c4 )\n|\u1ef9 |2\n\u2264\n\u2212\n+ O 2 (|y \u2212 x2 |) + O 2 (|t \u2212 \u03c42 |) ,\n\u2032 +\n\u2032\n\u2032 \u00012\n2\u03c4\u0303 \u2032\n2\u03c4\n\u03c4\n2 \u03c4\n\nso, by substitution of {\u1ef9, \u03c4\u0303 }, integration by parts, (5.11) and (5.12)\n\u0015\nZ 1\u0014\n2\n1\n\u2032\n\u2032\nJP (x1 , y, \u03c41 , t) \u2264\n\u1ef9 (s) + P (\u1ef9(s), \u03c4\u0303 (s))\u03c4\u0303 (s) ds\n2\u03c4\u0303 \u2032 (s)\n0\n\"\n#\n\u2032\n|y |2\n1 \u2032\n= JP (x1 , x2 , \u03c41 , \u03c42 )+ \u2032 y (1)*(y\u2212x2 )+ P (y(1), \u03c4 (1)) \u2212\n(t\u2212\u03c42 )+O2 (|y \u2212 x2 |)+o(|t\u2212\u03c42 |) .\n\u2032 2\n\u03c4 (1)\n2(\u03c4 )\n\u2032\n\n\u2032\n\nUsing y(1) = x2 , \u03c4 (1) = \u03c42 and y /\u03c4 = \u1e8b we obtain (5.3). The second inequality (5.4) is\nobtained similarly.\nProof. (of lemma 5.2).\nAssuming \u03c6 given by (5.8) and t1 > t0 \u2265 0 we have to prove (F) in Definition 5.1, namely\n\u03c6(y, t1 ) = inf n [JP (w, y, t0 , t1 ) + \u03c6(w, t0 )] .\nw\u2208R\n\n24\n\n(5.14)\n\n\fHowever, from (5.8)\n\u03c6(y, t1 ) = infn [JP (z, y, 0, t1 ) + \u03c6(z, 0)] and \u03c6(y, t0 ) = infn [JP (z, y, 0, t0 ) + \u03c6(z, 0)] .\nz\u2208R\n\nz\u2208R\n\nfrom (5.5), (5.6):\nJP (z, y, 0, t1 ) = inf n {JP (z, w, 0, t0 ) + JP (w, y, t0 , t1 )}\nw\u2208R\n\nso\n\u03c6(y, t1 ) =\n\ninf {JP (z, w, 0, t0 ) + JP (w, y, t0 , t1 ) + \u03c6(z, 0)}\n\nz,w\u2208Rn\n\n= inf n {\u03c6(w, t0 ) + JP (w, y, t0 , t1 )}\nw\u2208R\n\nand (5.14) follows. The proof for the backward equation is completely analogous.\nTo prove the second part we proceed, as in the proof of Lemma 5.1, to consider the orbit\nx\u0303(\u03c4 ) = x(\u03c4 ) + (y \u2212 x)\u03c4 /t\nwhere x is an optimal orbit connecting (x, t) with (x(0), 0), namely\n\u03c6(x, t) =\n\nZ th\n0\n\ni\n2\n\u1e8b /2 + P (x(\u03c4 ), \u03c4 ) d\u03c4 + \u03c6(x(0), 0) = JP (x(0), x, 0, t) + \u03c6(x(0), 0) .\n\nSince x\u0303(t) = y we obtain, using (5.2) and integration by parts\n\u03c6(y, t) \u2264\n\nZ th\n0\n\ni\n|x \u2212 y|2\n2\nx\u0303 \u0307 /2 + P (x\u0303(\u03c4 ), \u03c4 ) d\u03c4 +\u03c6(x(0), 0) = \u03c6(x, t)+ \u1e8b(t)*(y\u2212x)+\n(1+O(t2 )) .\n2t\n\nIn particular we obtain that\n\u03c6(y, t) \u2212 \u03c6(x, t)\nC\n|x \u2212 y|\n\u2264 |\u1e8b(t)| +\n(1 + O(t2 )) \u2264\n(5.15)\n|x \u2212 y|\n2t\nt\n\u0002\n\u0003\nwhere C = T max |\u1e8b(t)| + Diam(\u03a9) 12 + O(T 2 ) . Here max |\u1e8b|(t) is the maximal possible\nvalue over all possible optimal orbits x. We now observe that there is a bound |\u1e8b| < D for\nany optimal orbit x where D depends only on the bounds of P and Px on \u03a9I . This follows\nsince there is a bound on the variation of \u1e8b in terms of\u0001 max(|Px |) via (5.2), and a bound on\nthe action JP itself in terms of max(|P |) and max \u1e8b by its definition.\nThe reverse inequality of (5.15) and the result for the backward solutions follows analogously.\nProof. (of Lemma 5.3) Let \u03c6 be a forward solution. We know that \u03c6 is Lipschitz by\nLemma 5.2. If \u03c6 is not a generalized sub-solution, then there exists \u03b5 > 0 and a C 1 orbit x so that the set of points\n)\n(\n \u0307 2\n|x|\nd\n\u03c6(x(t), t) >\n+ P (x(t), t) + \u03b5 \u2282 I\nt;\ndt\n2\n25\n\n\fis of positive Lebesgue measure in I. Let \u03c40 be a density point of this set. Then, for\nt1 < \u03c40 < t2 sufficiently close, and x1 = x(t1 ) ,x2 = x(t2 ), we obtain\n#\nZ t2\nZ t2 \"\n2\n\u1e8b(t)\nd\n\u03c6(x(t), t)dt >\n+ P (x(t), t) dt \u2265 JP (x1 , x2 , t1 , t2 )\n\u03c6(x2 , t2 ) \u2212 \u03c6(x1 , t1 ) =\n2\nt1 dt\nt1\nwhich contradicts Definition 5.1. Hence, a forward solution is necessarily a generalized subsolution.\nWe now show that a forward solution \u03c6 is a maximal generalized sub-solution. Let \u03c8 be\na generalized sub-solution, (x, t) \u2208 \u03a9I . Let \u03c4 < t and x : [\u03c4, t] \u2192 \u03a9 be a C 1 orbit satisfying\nx(t) = x. Assume \u03c6 be a forward solution in \u03a9 \u00d7 [\u03c4, t] such that \u03c6(x, \u03c4 ) = \u03c8(x, \u03c4 ) on \u03a9.\nThen, by definition\n\u0015\nZ t\nZ t\u0014\nd\n1\n2\n\u03c8(x, t) = \u03c8(x(\u03c4 ), \u03c4 ) +\n\u1e8b(s) + P (x(s), s)ds\n\u03c8(x(s), s)ds \u2264 \u03c8(x(\u03c4 ), \u03c4 ) +\n2\n\u03c4 ds\n\u03c4\n\u2264 \u03c6(x(\u03c4 ), \u03c4 ) + JP (x(\u03c4 ), x, \u03c4, t) .\n\n(5.16)\n\nHowever, the same inequality survive if we take the infimum of the r.h.s of (5.16) over all\nsuch orbits x. By definition, this infimum is nothing but the value of the forward solution\n\u03c6(x, t). This implies the maximality of \u03c6. The statement for a backward solution is proved\nanalogously.\nProof. (of Lemma 5.4):\nFrom Corollary 5.1 and by construction it follows that \u03c8 \u2264 \u03c6 and \u03c8 \u2265 \u03c8 on \u03a9I , while\n\u03c8(x, 0) = \u03c8(x, 0) for x \u2208 \u03a9. On the other hand, since both \u03c8 and \u03c6 are forward solutions\nand\n\u03c8(x, 0) = \u03c8(x, 0) \u2264 \u03c60 (x)\non \u03a9, then necessarily \u03c8 \u2264 \u03c6 on \u03a9I .\n\u03c8(x, T ) \u2264 \u03c6(x, T ) = \u03c8(x.T )\nand the equality \u03c8(x, T ) = \u03c8(x, T ) follows.\nLet us turn to the case P \u2261 0. Set \u03c80 = \u03c8(*, 0) (res. \u03c81 = \u03c8(*, T )). From (F0 ), (B0 ) in\nDefinition 5.2:\n\u0015\n\u0014\n\u0015\n\u0014\n|x \u2212 y|2\n|x \u2212 y|2\n\u03c81 (x) = infn\n+ \u03c80 (y) ; \u03c80 (x) = sup \u2212\n+ \u03c81 (y) .\ny\u2208R\n2T\n2T\ny\u2208Rn\nIn particular\n\n|x \u2212 y|2\n+ \u03c80 (x) \u2212 \u03c81 (y) \u2265 0\n(5.17)\n2T\nfor any x, y \u2208 Rn . We may now lift the functions \u03c80 , \u03c81 from the torus \u03a9 to periodic functions\nin Rn , and set\n\u03a80 (x) = T \u03c80 (x) +\n\nx2\ny2\n; \u03a81 (y) =\n\u2212 T \u03c81 (y) ,\n2\n2\n26\n\nx, y \u2208 Rn\n\n\fas functions on Rn . Then (5.17) is equivalent to\n\u03a80 (x) + \u03a81 (y) \u2212 x * y \u2265 0\n\n; \u2200x, y \u2208 Rn .\n\n(5.18)\n\nThe condition of reversible pair is manifested in \u03a80 , \u03a81 being related by the Legendre transforms:\n\u03a80 (x) = sup [x * y \u2212 \u03a81 (y)] := \u03a8\u22171 (x)\ny\n\n;\n\n\u03a81 (x) = inf [x * y \u2212 \u03a80 (y)] := \u03a8\u22170 (x) .\ny\n\nIn particular, both \u03a80 , \u03a81 are convex functions on Rn . Recall that the super-gradient \u2202x \u03a8 of\na function \u03a8 is given by\ny \u2208 \u2202x \u03a8 \u21d0\u21d2 \u03a8(z) \u2212 \u03a8(x) \u2265 y * (z \u2212 x) ; \u2200z \u2208 Rn\nand the equality in (5.18) holds iff y \u2208 \u2202x \u03a80 (equivalently, x \u2208 \u2202y \u03a81 ).\nLet now x, y, z \u2208 Rn , \u03c4 \u2208 (0, T ). The inequality\n|x \u2212 z|2\n|z \u2212 y|2\n|x \u2212 y|2\n\u2264\n+\n2T\n2\u03c4\n2(T \u2212 \u03c4 )\n\n(5.19)\n\nholds, and turns into an equality iff (T \u2212 \u03c4 )x + \u03c4 y = T z. We obtain\n\u0014\n\u0014\n\u0015\n\u0015\n|z \u2212 y|2\n|z \u2212 y|2\n\u03c8(z, \u03c4 ) = infn\n+ \u03c80 (y) \u2265 \u03c8(z, \u03c4 ) = sup \u2212\n+ \u03c81 (y) ,\ny\u2208R\n2\u03c4\n2(T \u2212 \u03c4 )\ny\u2208Rn\n=\u21d2 \u03c8(z, \u03c4 ) \u2212 \u03c8(z, \u03c4 ) = inf n\nx,y\u2208R\n\n\u0014\n\n\u0015\n|z \u2212 y|2\n|z \u2212 x|2\n+\n+ \u03c80 (x) \u2212 \u03c81 (y) .\n2\u03c4\n2(T \u2212 \u03c4 )\n\n(5.20)\n\nLet now l(z, \u03c4 ) := {x, y \u2208 Rn ; (T \u2212 \u03c4 )x + \u03c4 y = T z}. If we restrict the infimum in (5.20) to\nx, y \u2208 l(z, \u03c4 ) then, by the equality in (5.19), it is estimated by\n\u0015\n\u0014\n|y \u2212 x|2\n+ \u03c80 (x) \u2212 \u03c81 (y) = T \u22121 inf [\u03a80 (x) + \u03a81 (y) \u2212 x * y] .\n\u2264 inf\n2T\nx,y\u2208l(z,\u03c4 )\nx,y\u2208l(z,\u03c4 )\nNow, the last term is zero iff there exists a pair (x, y) where both (T \u2212 \u03c4 )x + \u03c4 y = T z and\ny \u2208 \u2202x \u03a80 hold, namely:\nT z \u2212 (T \u2212 \u03c4 )x\nT\n\u2208 \u2202x \u03a80 \u21d0\u21d2 z := z\u03c4 \u2208 \u2202x \u03a8\u03c4\n\u03c4\n\u03c4\n\u2212\u03c4 2\nwhere \u03a8\u03c4 (x) := \u03a80 (x) + T2\u03c4\nx . Finally, z\u03c4 \u2208 \u2202x \u03a8\u03c4 iff z\u03c4 is in the domain of the Legendre\ntransform \u03a8\u2217\u03c4 . Since \u03a80 is convex, it follows that \u03a8\u03c4 is strictly convex and it's Legendre\ntransform is defined on Rn .\n\nProof. (of Lemma 5.5):\nLet x : [t0 , t1 ] \u2192 Rn be any orbit. Then\n\u0015\n\u0013\u0015\nZ t1 \u0014 2 \u0012\nZ t1 \u0014 2\n|\u1e8b|\n1\n|\u1e8b|\n+ P (x(t), t) dt =\n+ \u03c6t (x, t) + |\u2207x \u03c6(x, t)| dt\n2\n2\n2\nt0\nt0\n27\n\n\f=\n\nZ\n\nt1\n\nt0\n\n\u0014\n\n\u0015\n\u0015\nZ t1 \u0014\n\u0001\n1\n1\nd\n2\n2\n|\u1e8b \u2212 \u2207x \u03c6(x, t)| + \u03c6t (x, t) + \u1e8b * \u2207x \u03c6(x, t) dt =\n|\u1e8b \u2212 \u2207x \u03c6(x, t)| + \u03c6(x(t), t) dt\n2\n2\ndt\nt0\nZ t1\n1\n=\n|\u1e8b \u2212 \u2207x \u03c6(x, t)|2 dt + \u03c6(x1 , t1 ) \u2212 \u03c6(x0 , t0 ) ,\n2 t0\n\nwhere x0 = x(t0 ), x1 = x(t1 ). Hence\n\u0015\nZ t1 \u0014 2\nZ\n|\u1e8b|\n1 t1\n\u03c6(x1 , t1 ) =\n+ P (x(t), t) dt + \u03c6(x0 , t0 ) \u2212\n|\u1e8b \u2212 \u2207x \u03c6(x, t)|2 dt\n2\n2 t0\nt0\nholds for any orbit x(t). In particular,\n\u0015\nZ t1 \u0014 2\n|\u1e8b|\n\u03c6(x1 , t1 ) \u2264\n+ P (x(t), t) dt + \u03c6(x(t0 ), t0 ) .\n2\nt0\nMoreover, if x is a solution of \u1e8b = \u2207x \u03c6(x, t), x(t1 ) = x1 , t0 \u2264 t \u2264 t1 , then the equality holds.\nHence \u03c6 is a forward solution. By the same way it follows that \u03c6 is a backward solution, as\nwell.\nProof. (of Lemma 5.6)\nLet \u03c4 \u2208 (0, T ) and x \u2208 \u03a9. Since \u03c6 is a forward solution and \u03c6 is a backward one, then\n(i) \u03c6(x, \u03c4 )\u2212\u03c6(y1 , 0) \u2264 JP (y1 , x, 0, \u03c4 ) ; (ii) \u03c6(y2 , T )\u2212\u03c6(x, \u03c4 ) \u2264 JP (x, y2 , \u03c4, T ) \u2200y1 , y2 \u2208 Rn ,\nMoreover, there exists y1\u2217 , y2\u2217 \u2208 Rn for which\n(i\u2217 ) \u03c6(x, \u03c4 ) \u2212 \u03c6(y1\u2217 , 0) = JP (y1\u2217 , x, 0, \u03c4 )\n\n(ii\u2217 ) \u03c6(y2\u2217 , T ) \u2212 \u03c6(x, \u03c4 ) = JP (x, y2\u2217 , \u03c4, T ) ,\n\n;\n\nwhile, for any x\u2217 \u2208 \u03a9 and t \u2208 (0, T )\n(i\u2217\u2217 ) \u03c6(x\u2217 , t)\u2212\u03c6(y1\u2217 , 0) \u2264 JP (y1\u2217 , x\u2217 , 0, t)\n\n(ii\u2217\u2217 ) \u03c6(y2\u2217 , T )\u2212\u03c6(x\u2217 , t) \u2264 JP (x\u2217 , y2\u2217 , t, T ) .\n\n;\n\nFrom (i\u2217 ), (i\u2217\u2217 ) and (5.3):\n\u03c6(x, \u03c4 ) \u2212 \u03c6(x\u2217 , t) \u2265 JP (y1\u2217 , x, 0, \u03c4 ) \u2212 JP (y1\u2217 , x\u2217 , 0, t) \u2265\n\u0014\n\n\u0015\n1\n2\n\u1e8b1 (\u03c4 ) * (x \u2212 x ) + P (x, \u03c4 ) \u2212 |x1 (\u03c4 )| (\u03c4 \u2212 t) \u2212 O 2 (|x \u2212 x\u2217 |) \u2212 o(|t \u2212 \u03c4 |)\n2\n\u2217\n\n(5.21)\n\nwhere x1 : [0, \u03c4 ] \u2192 Rn is an optimal orbit realizing the action JP (y1\u2217 , x, 0, \u03c4 ). Similarly, from\n(i\u2217\u2217 ) (ii\u2217\u2217 ) and (5.4)\n\u03c6(x, \u03c4 ) \u2212 \u03c6(x\u2217 , t) \u2264 JP (x\u2217 , y2\u2217 , t, T ) \u2212 JP (x, y2\u2217 , \u03c4, T ) \u2264\n\u0014\n\n\u0015\n1\n2\n\u1e8b2 (\u03c4 ) * (x \u2212 x ) + P (x, \u03c4 ) \u2212 |x2 (\u03c4 )| (\u03c4 \u2212 t) + O 2 (|x \u2212 x\u2217 |) + o(|t \u2212 \u03c4 |)\n2\n\u2217\n\nwhere x2 : [\u03c4, T ] \u2192 Rn is an optimal orbit realizing the action JP (x, y2\u2217 , \u03c4, T ).\n28\n\n(5.22)\n\n\fLet now (x, \u03c4 ) \u2208 K0 (\u03c6, \u03c6). Then \u03c6(x, \u03c4 ) := \u03c6(x, \u03c4 ) = \u03c6(x, \u03c4 ) and (5.21), (5.22) yield\n\u0014\n\u0015\n1\n\u1e8b1 (\u03c4 ) * (x \u2212 x\u2217 ) + P (x, \u03c4 ) \u2212 |x1 (\u03c4 )|2 (\u03c4 \u2212 t) \u2212 O2 (|x \u2212 x\u2217 |) \u2212 o(|\u03c4 \u2212 t|)\n2\n\u2264 \u03c6(x, \u03c4 ) \u2212 \u03c6(x\u2217 , t) \u2264\n\u0014\n\u0015\n1\n\u2217\n2\n\u1e8b2 (\u03c4 ) * (x \u2212 x ) + P (x, \u03c4 ) \u2212 |x2 (\u03c4 )| (\u03c4 \u2212 t) + O 2 (|x \u2212 x\u2217 |) + o(|\u03c4 \u2212 t|) ,\n2\nas well as\n\u0014\n\n\u0015\n1\n2\n\u1e8b1 (\u03c4 ) * (x \u2212 x ) + P (x, \u03c4 ) \u2212 |x1 (\u03c4 )| (\u03c4 \u2212 t) \u2212 O2 (|x \u2212 x\u2217 |) \u2212 o(|t \u2212 \u03c4 |)\n2\n\u2217\n\n\u2264 \u03c6(x, \u03c4 ) \u2212 \u03c6(x\u2217 , t) \u2264\n\u0014\n\u0015\n1\n\u2217\n2\n\u1e8b2 (\u03c4 ) * (x \u2212 x ) + P (x, \u03c4 ) \u2212 |x2 (\u03c4 )| (\u03c4 \u2212 t) + O 2 (|x \u2212 x\u2217 |) + o(|t \u2212 \u03c4 |) .\n2\nNow, in order to show that both \u2207x \u03c6(x, \u03c4 ) and \u2207x \u03c6(x, \u03c4 ) exist for (x, \u03c4 ) \u2208 K0 we only\nhave to show that \u1e8b1 (\u03c4 ) = \u1e8b2 (\u03c4 ). Adding (i) and (ii) we obtain:\n\u03c6(y2 , T ) \u2212 \u03c6(y1 , 0) \u2264 JP (y1 , x, 0, \u03c4 ) + JP (x, y2 , \u03c4, T )\n\n(5.23)\n\nfor any y1 , y2 \u2208 Rn . From (i\u2217 ), (ii\u2217 ) we obtain that equality holds in (5.23) for y1\u2217 , y2\u2217 :\n\u03c6(y2\u2217 , T ) \u2212 \u03c6(y1\u2217 , 0) = JP (y1\u2217 , x, 0, \u03c4 ) + JP (x, y2\u2217 , \u03c4, T ) .\n\n(5.24)\n\nOn the other hand, by pair-reversibility:\n\u03c6(y2\u2217 , T ) \u2212 \u03c6(y1\u2217 , 0) \u2264 JP (y1\u2217 , y2\u2217 , 0, T ) .\nTogether with (5.24):\nJP (y1\u2217 , x, 0, \u03c4 ) + JP (x, y2\u2217 , \u03c4, T ) \u2264 JP (y1\u2217 , y2\u2217 , 0, T ) .\n\n(5.25)\n\nComparing the above with (5.5) we obtain an equality in (5.25). This implies that \u1e8b1 (\u03c4 ) =\n\u1e8b2 (\u03c4 ) by Lemma 5.1-d. The existence of\n\u2207x \u03c6(x, \u03c4 ) = \u1e8b(\u03c4 ) := \u1e8b1 (\u03c4 ) = \u1e8b2 (\u03c4 )\nand of\n\n(5.26)\n\n1\n\u03c6t (x, \u03c4 ) = P (x, \u03c4 ) \u2212 |\u1e8b|2 (\u03c4 )\n2\nfollows from (5.21), (5.22). In particular the equality (5.1) holds for any (x, \u03c4 ) \u2208 K0 .\nWe now prove the Lipschitz continuity of \u2207x \u03c6 on K0 . By Lemma 5.1 (b) we obtain\nthat for any t \u2208 (0, T ) there exists C = C(t) such that both JP (y, x, 0, t) \u2212 C(t)x2 and\nJP (x, y, t, T ) \u2212 C(t)x2 are concave functions of x for any y \u2208 Rn . It follows by Definition 5.1\n(F) that q(x) := \u03c6(x, t)\u2212C(t)x2 , being the infimum of a set of concave functions JP (y, x, 0, t)\u2212\n29\n\n\fC(t)x2 + \u03c6(y, 0) ; y \u2208 Rn , is concave as well. Likewise, from (B) of the same definition\nwe obtain that q(x) := \u03c6(x, t) + C(t)x2 , being the supremum of a set of convex functions\n\u2212JP (x, y, t, T ) + C(t)x2 + \u03c6(x, T ) ; y \u2208 Rn , is convex.\nLet x, x\u2217 \u2208 K0 for some t \u2208 I0 . Then both x, x\u2217 are differentiability points of the convex\nfunction q, hence\n\u2207x q \u2212 \u2207x\u2217 q, x \u2212 x\u2217 \u2265 0 .\n\nUsing \u2207\u03c6 = \u2207\u03c6 for x, x\u2217 we obtain\n\nh\u2207x \u03c6 \u2212 \u2207x\u2217 \u03c6, x \u2212 x\u2217 i \u2265 \u2212C |x \u2212 x\u2217 |2 .\n\n(5.27)\n\nThe same argument applied to the concave function q yields\nh\u2207x \u03c6 \u2212 \u2207x\u2217 \u03c6, x \u2212 x\u2217 i \u2264 C |x \u2212 x\u2217 |2 .\n\n(5.28)\n\nWe may assume, by shifting and rotating the coordinate system, that x = (0, 0 . . . 0) and\nx\u2217 = (\u03b6, 0 . . . 0). Then (5.27, 5.28) yield\n|\u03c6,x1 (0, 0 . . . 0, t) \u2212 \u03c6,x1 (\u03b6, 0 . . . 0, t)| \u2264 C|\u03b6| .\n\n(5.29)\n\nIt is left to be shown that there exists a constant C \u2217 such that\n|\u03c6,xi (0, 0, . . . 0, t) \u2212 \u03c6,xi (\u03b6, 0 . . . 0, t)| \u2264 C \u2217 |\u03b6|\n\n(5.30)\n\nholds for any i > 1. By subtracting an affine function from \u03c6 and \u03c6 we may assume that (for\nthe fixed value of t)\n\u03c6(0, t) = \u03c6(0, t) = q(0) = q(0) = 0\n(5.31)\nand\n\u2207x \u03c6(0, t) = \u2207x \u03c6(0, t) = \u2207x q(0) = \u2207x q(0) = 0 ,\n\n(5.32)\n\nhence (5.29) is reduced to\n|\u03c6,x1 (\u03b6, 0 . . . 0, t)| < C|\u03b6| ,\n\n(5.33)\n\n|\u03c6,xi (\u03b6, 0, . . . 0, t)| \u2264 C \u2217 |\u03b6|\n\n(5.34)\n\nand (5.30) takes the form\nfor i > 1.\nSince q (q) is concave (convex), then (5.31, 5.32) implies that\nq\u22640\u2264q\n\n(5.35)\n\neverywhere.\nTo proceed, we use the concavity of q to obtain\nq(\u03b6, y . . . 0) \u2212 q(\u03b6, 0 . . . 0) \u2264 q ,x2 (\u03b6, 0 . . . 0)y = \u03c6,x2 (\u03b6, 0 . . . 0, t)y .\nFrom (5.36), (5.35), the inequality \u03c6 \u2265 \u03c6 and the relation between q and \u03c6 we obtain\n\u03c6,x2 (\u03b6, 0 . . . 0, t)y \u2265 q(\u03b6, y, 0 . . . 0) = \u03c6(\u03b6, y, 0 . . . 0) \u2212 C(\u03b6 2 + y 2 )\n30\n\n(5.36)\n\n\f\u2265 \u03c6(\u03b6, y, 0 . . . 0) \u2212 C(\u03b6 2 + y 2 ) = q(\u03b6, y, 0 . . . 0) \u2212 2C(\u03b6 2 + y 2 ) \u2265 \u22122C(\u03b6 2 + y 2 ) ,\nso\n\u03c6,x2 (\u03b6, 0 . . . 0, t)y + 2C|y|2 \u2265 \u22122C\u03b6 2\nholds for any y \u2208 R. Take now the minimum of the lhs above with respect to y to obtain\n\u2212\n\n\u03c62,x2\n\u2265 \u22122C\u03b6 2 \u2212\u2192 |\u03c6,x2 (\u03b6, 0, 0 . . . 0, t)| \u2264 4C|\u03b6|\n8C\n\nand (5.30) holds with C \u2217 = 4C where i = 2. The general case of i > 1 is evident.\nProof. (of Lemma 5.7): Let (\u03c6, \u03c6) a reversible pair. We first note that, for any (x, t) \u2208 \u03a9I0 ,\n0 \u2264 \u03c6(x, t) \u2212 \u03c6(x, t) \u2264 \u03c6(y, 0) \u2212 \u03c6(z, T ) + JP (y, x, 0, t) + JP (x, z, t, T ) .\nHowever, from definition of JP\nJP (y, x, 0, t) + JP (x, z, t, T ) \u2264\n\nZ\n\nT\n0\n\n\u0014\n\n\u0015\n1\n2\n\u1e8b(s) + P (x(s), s) ds ,\n2\n\nholds for any C 1 orbit x which satisfies x(0) = y, x(t) = x and x(T ) = z. It follows that\n\u0015\nZ T\u0014\n1\n2\n\u1e8b(s) + P (x(s), s) ds + \u03c6(x(0), 0) \u2212 \u03c6(x(T ), T )\n0 \u2264 \u03c6(x, t) \u2212 \u03c6(x, t) \u2264\n2\n0\nholds for any (x, t) \u2208 \u03a9I0 .\nAs a result we conclude that, if there exists an orbit x crossing the point (x, t) \u2208 \u03a9I0 such\nthat\n\u0015\nZ T\u0014\n1\n2\n\u1e8b(s) + P (x(s), s) ds + \u03c6(x(0), 0) \u2212 \u03c6(x(T ), T ) = 0 ,\n(5.37)\n2\n0\nthen \u03c6(x, t) = \u03c6(x, t), i.e. (x, t) \u2208 K0 . Moreover, in that case, the entire orbit is contained in\nK0 , namely \u222a\u03c4 \u2208I0 (x(\u03c4 ), \u03c4 ) \u2282 K0 . In addition, it must be a minimal orbit for the action and,\nby Lemma 5.1 and Lemma 5.6, \u2207x \u03c6(x(t), t) = \u2207x \u03c6(x(t), t) = \u1e8b(t).\nNext, let (x, t) \u2208 K0 and leth x1 : [0, t] \u2192 \u03a9 (x2 : [t,\ni T ] \u2192 \u03a9) the minimal orbits for\nRt 1\n2\nwhich \u03c6(x, t) = \u03c6(x1 (0), 0) + 0 2 \u1e8b1 (s) + P (x1 (s), s) ds (res. \u03c6(x, t) = \u03c6(x2 (T ), T ) \u2212\ni\nR T h1\n2\n\u1e8b\n(s)\n+\nP\n(x\n(s),\ns)\nds) and x1 (t) = x2 (t) = x. Then x = x1 \u222a x2 satisfies (5.37). In\n2\n2\n2\nt\nparticular, it is contained in K0 and is an integral curve of the vectorfield \u2207x \u03c6. This implies\nthe invariance of K0 under the flow of \u2207x \u03c6.\n\n5.3\n\nProof of the main Theorem\n\nFirst, the existence of a minimizer for L(\u03bc0 , \u03bc1 ) in \u039b2 (\u03bc0 , \u03bc1 ) follows immediately by the\nlower-semi-continuity of k\u03bck2 and the local compactness of H2 . Next, we shall prove the\nchain of inequalities:\nE(\u03bc0 , \u03bc1 ) \u2265 L(\u03bc0 , \u03bc1 ) \u2265 K(\u03bc0 , \u03bc1 ) \u2265 E(\u03bc0 , \u03bc1 )\n\n\u2217\n\nfrom left to right, together with the existence of a maximizer for E(\u03bc0 , \u03bc1 ) in \u039bP .\n31\n\n\f\u2022 E(\u03bc0 , \u03bc1 ) \u2265 L(\u03bc0 , \u03bc1 )\nFrom Lemma 4.5 and Corollary 4.2 there exists a sequence \u03b5k \u2192 0 and \u03c6k \u2208 C 1 (\u03a9I )\nsuch that\nZ\nZ\n\u0001\n\u2212\u03b1\ns\n\u03c6k (x, 0)\u03bc0 (dx) < C (5.38)\n\u03c6k (x, T )\u03bc1 (dx) \u2212\nL \u2264 \u03a8\u03b5k (\u03c6k ) < \u2212O \u03b5k ||\u03bek ||s +\n\u03a9\n\n\u03a9\n\nwhere \u03b1 > 0, s > n + 1 and\n\n\u03bek = \u03c6k,t + |\u2207x \u03c6k |2 /2 \u2212 P .\nLet now \u039e : \u03a9I \u2192 \u03a9 be a flow such that\ni) supx\u2208\u03a9\n\nRT\n0\n\n\u2202\u039e(x,t) 2\ndt\n\u2202t\n\n:= E < \u221e,\n\nii) \u039e(x, 0) = x, \u039e# (*, T )\u03bc0 = \u03bc1\nBy Lemma 5.8 and (i) we obtain\n1\n\u03b2\n\u03c6k (\u039e(x, T ), T ) \u2212 \u03c6k (x, 0) \u2264 E + |P |\u221e + C1 ||\u03bek ||2\u03b2\ns + C2 ||P ||lip ||\u03bek ||s .\n2\nIntegrate the above against \u03bc0 on \u03a9 and use (ii) to obtain\nZ\nZ\n1\n\u03b2\n\u03c6k (x, 0)\u03bc0 (dx) \u2264 E + |P |\u221e + C1 ||\u03bek ||2\u03b2\n\u03c6k (x, T )\u03bc1 (dx) \u2212\ns + C2 ||P ||lip ||\u03bek ||s\n2\n\u03a9\n\u03a9\n(5.39)\nUsing s > n + 1 and \u03b2 < 1/2 (c.f. Lemma 5.8) we obtain from (5.38) and (5.39) that\n||\u03bek ||s \u2192 0 as \u03b5k \u2192 0. In addition\n\u0015\n\u0014Z\nZ\n\u03c6k (x, 0)\u03bc0 (dx) \u2265 L .\n(5.40)\n\u03c6k (x, T )\u03bc1 (dx) \u2212\nlim inf\nk\u2192\u221e\n\n\u03a9\n\n\u03a9\n\nNow, we may replace the sequence \u03c6k by\nequation\n1\n2\n\u03c8 k,t + \u2207x \u03c8 k = P\n2\nThis is also a maximizing sequence which,\nyields\n\u0014Z\nlim inf\nk\u2192\u221e\n\n\u03a9\n\na sequence of forward solutions \u03c8 k of the\n;\n\n\u03c8 k (x, 0) = \u03c6k (x, 0) .\n\nby Corollary 5.2 together with ||\u03bek ||s \u2192 0,\n\n\u03c8 k (x, T )\u03bc1 (dx) \u2212\n\nZ\n\n\u03a9\n\n\u0015\n\u03c8 k (x, 0)\u03bc0 (dx) \u2265 L .\n\n(5.41)\n\nFrom Lemma 5.2 we also obtain a uniform estimate on \u03c8 k in LIP (\u03a9 \u00d7 (0, T ]). In\nparticular, the sequence \u03c8 k (,\u0307T ) is uniformly Lipschitz on \u03a9.\nNow, define \u03c8 k to be the backward solutions of (3.6) subjected to \u03c8 k (x, T ) = \u03c8 k (x, T ).\nFrom the first part of Lemma 5.2, \u03c8 k (x, 0) \u2264 \u03c8 k (x, 0) on \u03a9 so (5.41) is satisfied for\n\u03c8 k as well. Moreover, by the last part of Lemma 5.2 \u03c8 k are uniformly bounded in\nthe Lipschitz norm on \u03a9I . So, we can extract a subsequence of \u03c8 k which converges\nuniformly on LIP (\u03a9 \u00d7 [0, T ]) to a backward solution \u03c8.In particular, both \u03c8(, T ) and\n32\n\n\f\u03c8(, 0) are Lipschitz. Let \u03c8 be the forward solution satisfying \u03c8(, 0) = \u03c8(, 0). By\nCorollary 5.1 and definition 5.3, the pair (\u03c8, \u03c8) is a reversible pair and both functions\n\u2217\nare in \u039bP (see the first part of Lemma 5.3). Moreover, the inequality (5.41) is preserved\nin the limit process, so\nZ\nZ\n\u03c8(x, 0)\u03bc0 (dx) \u2265 L\n\u03c8(x, T )\u03bc1 (dx) \u2212\n\u03a9\n\n\u03a9\n\nholds for both \u03c8 = \u03c8 and \u03c8 = \u03c8 (recall \u03c8 = \u03c8 on \u03a9 \u00d7 {0} and \u03a9 \u00d7 {T }).\n\u2022 L(\u03bc0 , \u03bc1 ) \u2265 K(\u03bc0 , \u03bc1 )\nRecall that there exists a minimizer of L(\u03bc0 , \u03bc1 ) by the first part of the Theorem. Let\n\u03bc be such a minimizer. We now use the regularization Lemma 2.3 to approximate \u03bc by\nsmooth densities \u03bcn = \u03c1n (x, t)dxdt. Let v n be the regularized velocity field. Then\nZ\n|v n |2 (x, t)\u03c1n (x, t)dxdt = ||\u03bc||22 .\n(5.42)\nlim\nn\u2192\u221e \u03a9\nI\n\nas well as\nlim\n\nZ\n\nn\u2192\u221e \u03a9\nI\n\n\u03c1n (x, t)P (x, t)dxdt =\n\nZ\n\nP \u03bc(dxdt) .\n\n\u03a9I\n\nDefine\nmn (x, t) = \u03c1n (x, t)v n (x, t) .\n\n(5.43)\n\nThen mn \u2208 C 1 (\u03a9I ). Define now\nv \u03b5n (x, t) =\n\nmn (x, t)\n\u03c1n (x, t) + \u03b5\n(\u03b5)\n\nBy assumption, v \u03b5n is Lipschitz on \u03a9I , t \u2208 I. Define \u03c1n (x, t) as the solution of\n(\u03b5)\n\ni\nh\n\u2202\u03c1n\n= 0 ; \u03c1(\u03b5)\n+ \u2207x v \u03b5n \u03c1(\u03b5)\nn (x, 0) = \u03c1n (x, 0) .\nn\n\u2202t\n\n(5.44)\n\nSince v \u03b5n is Lipschitz, we may define the flow associated with it as \u0393t(\u03b5) : \u03a9 \u2192 \u03a9 for\nt \u2208 I, namely \u0393t(\u03b5) (x) = y(x) (t) where \u1e8f(x) = v \u03b5n (y(x) (t), t) and y(x) (0) = x. It follows\n(\u03b5)\n\nthat \u0393t(\u03b5),# \u03c1n (*, 0)dx = \u03c1n (*, t)dx for all t \u2208 I. In particular:\n\n\u0010\n\u0011\n\u0010\n\u0011 Z\n(\u03b5)\n\u03c1n (x, 0)JP x, \u0393T(\u03b5) (x)0, T dx\nK \u03c1n (x, 0)dx, \u03c1n (x, T )dx \u2264\n\u03a9\n\n=\n\n=\n\nZ\n\n\u03a9I\n\nZ\n\n\u03c1n (x, 0)\n\u03a9I\n\n\u0001\nd\nJP x, \u0393t\u03b5 (x), 0, t dtdx\ndt\n\n\u0014\n\n\u0015\n\u0001\n\u2202\nt\n\u03b5\nt\n\u03c1n (x, 0)\nJP (x, \u0393(\u03b5) (x), t) + \u2207y=\u0393t\u03b5 (x) JP (x, y, 0, t) * v n \u0393\u03b5 (x), t dxdt (5.45)\n\u2202t\n33\n\n\fFrom (5.7)\n1\n1\n\u2202t JP (x, y, 0, t)+\u2207y JP (x, y, 0, t)*v \u03b5n (y, t) = P (y, t)+ |v\u03b5n |2 (y, t)\u2212 |\u2207y JP (x, y, 0, t) \u2212 v \u03b5n (y, t)|2 .\n2\n2\nSubstitute the above in (5.45) at y = \u0393t\u03b5 (x) to obtain\n\u0014\n\u0015\n\u0010\n\u0011 Z\n\u0001 1 n2 t\n\u0001\nt\n\u03c1\n(x,\n0)\nP\n\u0393\n(x),\nt\n+\n(x,\nT\n)dx\n\u2264\nK \u03c1n (x, 0)dx, \u03c1(\u03b5)\n|v\n|\n\u0393\n(x),\nt\ndxdt\nn\n\u03b5\nn\n\u03b5\n2 \u03b5\n\u03a9I\n\u0014\n\u0015\n\u0015\nZ\n1 n2\n1 n2\n\u03c1(\u03b5)\n(x,\nt)\n|v \u03b5 | (x, t) + P (x, t) dxdt \u2264\n|v\n|\n(x,\nt)\n+\nP\n(x,\nt)\ndxdt\nn\n2\n2\n\u03a9I\n\u03a9I\n(5.46)\nwhere the last inequality follows from (5.43). We next show that\nZ\nlim\n(5.47)\n\u03c1(\u03b5)\nn (x, t) \u2212 \u03c1n (x, t) dx = 0\n=\n\nZ\n\n\u03c1(\u03b5)\nn (x, t)\n\n\u0014\n\n\u03b5\u21920 \u03a9\n\n(\u03b5)\n\n(\u03b5)\n\nfor any t \u2208 I. In fact, we note that \u03c1n +\u03b5 solves equation (5.44), hence wn := \u03c1n \u2212\u03c1n +\u03b5\n(\u03b5)\n(\u03b5)\nsolves this equation as well. Since wn (x, 0) = \u03b5 > 0 we obtain that wn \u2265 0 over \u03a9I\nand, moreover,\nZ\nZ\nZ\n(\u03b5)\n\u03c1n (x, t) \u2212 \u03c1(\u03b5)\n(x,\nt)\ndx\n\u2212\n|\u03a9|\u03b5\n\u2264\nw\n(x,\nt)\n=\nwn(\u03b5) (x, 0) = |\u03a9|\u03b5\nn\nn\n\u03a9\n\n\u03a9\n\n\u03a9\n\nfor all t \u2208 I. Now we take first the limit \u03b5 \u2192 0 then the limit n \u2192 \u221e in (5.46). The r.h.s\nof (5.46) converges to L(\u03bc0 , \u03bc1 ). Now, \u03c1n (x, 0)dx and \u03c1\u03b5n (x, T )dx converges, as n \u2192 \u221e\nand \u03b5 \u2192 0, weak\u2212\u2217 to \u03bc0 and \u03bc1 , respectively. Since K is lower-semi-continuous in\nboth \u03bc0 and \u03bc1 we obtain the desired result from (5.46) .\n\u2022 E(\u03bc0 , \u03bc1 ) \u2264 K(\u03bc0 , \u03bc1 ).\n(1)\nLet \u03bb \u2208 C \u2217 (\u03a9 \u00d7 \u03a9) be an optimizer of K. Since \u03c0# \u03bb = \u03bc1 then\nZ\n\n\u03c61 (x)\u03bc1 (dx) =\n\nZ Z\n\u03a9\n\n\u03a9\n\n\u03c61 (y)\u03bb(dxdy)\n\nZ\n\nand\n\n\u03c60 (x)\u03bc0 (dx) =\n\n\u03a9\n\n\u03a9\n\n\u03a9\n\nZ Z\n\n\u03c60 (x)\u03bb(dxdy)\n\u03a9\n\nfor any continuous \u03c61 , \u03c62 . Set \u03c61 (x) = \u03c8(x, T ) and \u03c60 (x) = \u03c8(x, 0) with \u03c8 an optimal\nbackward solution of problem E. Then\nZ Z\nZ\nZ\n[\u03c8(y, T ) \u2212 \u03c8(x, 0)] \u03bb(dxdy) .\n\u03c8(x, 0)\u03bc0 (dx) =\n\u03c8(x, T )\u03bc1 (dx) \u2212\nE=\n\u03a9\n\n\u03a9\n\n\u03a9\n\n\u03a9\n\nSince \u03c8 is a backward solution then\nZ Z\nZ Z\nJP (x, y, 0, T )\u03bb(dxdy) = K .\n[\u03c8(y, T ) \u2212 \u03c8(x, 0)] \u03bb(dxdy) \u2264\n\u03a9\n\n\u03a9\n\n\u03a9\n\n34\n\n\u03a9\n\n\fWe have proved\nZ\nZ\nZ\nZ\n\u03c8(x, T )\u03bc1 (dx) \u2212\n\u03c8(x, 0)\u03bc0 (dx) = L(\u03bc0 , \u03bc1 ) .\n\u03c8(x, T )\u03bc1 (dx) \u2212\n\u03c8(x, 0)\u03bc0 (dx) =\n\u03a9\n\n\u03a9\n\n\u03a9\n\n\u03a9\n\n(5.48)\n\nWe now turn to the proof of parts (i)-(vi) of the Theorem.\n(0)\n\ni) Let \u03bc(0) be a minimizer of L. Given t \u2208 I0 , let \u03bc1/2 := \u03bc(t) \u2208 M. Let us consider \u03bc(1)\n\nto be the restriction of \u03bc(0) to \u03a9 \u00d7 [0, t] and \u03bc(2) the restriction of \u03bc(0) to \u03a9 \u00d7 [t, T ].\nEvidently, \u03bc(1) is a minimizer of LP on the set of orbits \u039b2 (\u03bc0 , \u03bc1/2 ) confined to [0, t]\nwhile \u03bc(2) is a minimizer on \u039b2 (\u03bc1/2 , \u03bc1 ) with respect to the same set, confined to [t, T ].\nIn particular,\nLP (\u03bc(1) ) + LP (\u03bc(2) ) = LP (\u03bc(0) ) = L(\u03bc0 , \u03bc1 ) .\n(5.49)\nBy what we know so far,\nZ\nZ\n\u03c8(x, t)\u03bc1/2 (dx) \u2212\n\u03c8(x, 0)\u03bc0 (dx) \u2264 LP (\u03bc(1) )\n\u03a9\n\nZ\n\n\u03a9\n\n(5.50)\n\n\u03a9\n\n\u03c8(x, T )\u03bc1 (dx) \u2212\n\nZ\n\n\u03a9\n\n\u03c8(x, t)\u03bc1/2 (dx) \u2264 LP (\u03bc(2) ) .\n\n(5.51)\n\nHowever, if we sum (5.50) and (5.51) and use (5.49) and (5.48), we conclude that there\nis, in fact, an equality in both (5.50) and (5.51). Same argument holds for \u03c8 as well.\nThus\nZ\nZ\nZ\nZ\n(1)\n\u03c8(x, t)\u03bc1/2 (dx)\u2212 \u03c8(x, 0)\u03bc0 (dx) .\n\u03c8(x, t)\u03bc1/2 (dx)\u2212 \u03c8(x, 0)\u03bc0 (dx) = LP (\u03bc ) =\n\u03a9\n\n\u03a9\n\n\u03a9\n\n\u03a9\n\nSince \u03c8(x, 0) \u2261 \u03c8(x, 0),\nZ\n\n\u03a9\n\n\u0002\n\n\u0003\n\u03c8(x, t) \u2212 \u03c8(x, t) \u03bc1/2 (dx) = 0 .\n\n\u0011\n\u0010\n\u0001\n(0)\nBut, \u03c8 \u2265 \u03c8 by Lemma 5.3. Hence \u03c8(x, t) = \u03c8(x, t) on supp \u03bc(t) = supp \u03bc1/2 .\n\u0001\nThis, together with Lemma 5.6, proves that Supp \u03bc(0) \u2229 \u03a9I0 \u2282 K0 \u2261 {(x, t) ; t \u2208\nI0 , \u03c8(x, t) = \u03c8(x, t)} and, in particular, that \u03c6 is differentiable at any point on the\nsupport of \u03bc(0) in \u03a9I .\nii) This part follows from Lemma 5.7. In addition, the limits lim\u03c4 \u2192T T\u03c4t and lim\u03c4 \u21920 Tt\u03c4\nexists since \u2207x \u03c8 is uniformly bounded on K0 . In particular, the Lipschitz extension v\ncan be chosen to be a uniformly bounded function on \u03a9I as well.\niii) Suppose there are two optimal solutions \u03c81 , \u03c82 of E(\u03bc0 , \u03bc1 ). To prove the uniqueness for\nthe vector field v we claim that\nZ\n|\u2207x \u03c81 \u2212 \u2207x \u03c82 |2 \u03bc(dxdt) = 0\n\u03a9I\n\n35\n\n\ffor any minimizer \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ) of L(\u03bc0 , \u03bc1 ). Let \u03c8 = \u03b1\u03c81 +(1\u2212\u03b1)\u03c82 where \u03b1 \u2208 (0, 1).\nThen\n|\u2207x \u03c8|2 = \u03b1|\u2207x \u03c81 |2 + (1 \u2212 \u03b1)|\u2207x \u03c82 |2 \u2212 \u03b1(1 \u2212 \u03b1)|\u2207x \u03c81 \u2212 \u2207x \u03c82 |2 ,\n\nso \u03c8t + |\u2207x \u03c8|2 /2 < P and\nZ\nZ\n\u0002\n\u0003\n2\n\u03c8t + |\u2207x \u03c8| /2 \u03bc(dxdt) <\n\u03a9I\n\nP \u03bc(dxdt)\n\n(5.52)\n\n\u03a9I\n\nif \u2207x \u03c81 6= \u2207x \u03c82 at some point in the support of a minimizer \u03bc (recall that both \u2207\u03c8i ,\ni = 1, 2 are continuous on the support of \u03c8 by Lemma 5.6).\nOn the other hand,\nE(\u03bc0 , \u03bc1 ) =\n\nZ\n\n\u03a9\n\n[\u03c8(x, T )\u03bc1 (dx) \u2212 \u03c8(x, 0)\u03bc0 (dx)] = L(\u03bc0 , \u03bc1 )\n\n(5.53)\n\nfollows from the assumptions that both \u03c81 , \u03c82 are maximizers of E. From (4.10), (5.52)\nand (5.53) it follows that\nZ\nZ\n1\n1\n2\n2\nP \u03bc(dxdt) > ||\u03bc||2 +\n(\u03c8t +|\u2207x \u03c8|2 /2)\u03bc(dxdt) \u2265 E(\u03bc0 , \u03bc1 ) = L(\u03bc0 , \u03bc1 ) ,\nLP (\u03bc) := ||\u03bc||2 +\n2\n2\n\u03a9I\n\u03a9I\nin contradiction to the assumption that \u03bc is a minimizer of LP .\niv)\n\nLet, again, \u03bc \u2208 \u039b2 (\u03bc0 , \u03bc1 ) a minimizer of L and \u03c8 a maximizer of E. Since \u03c8 satisfies\nthe HJ equation on a closed set K0 containing the support of \u03bc in \u03a9I0 and is a C 1\nfunction there, we can extend it as a C 1 function on \u03a9I0 so \u03c8 \u2208 C 1 (\u03a9I0 ) \u2229 LIP (\u03a9I )\nand, by (5.53),\n\u0015\nZ \u0014\nZ\n1\n2\n\u2212\n\u03c8t + |\u2207x \u03c8| \u2212 P \u03bc(dxdt)+ [\u03c8(x, T )\u03bc1 (dx) \u2212 \u03c8(x, 0)\u03bc0 (dx)] = L(\u03bc0 , \u03bc1 ) = LP (\u03bc)\n2\n\u03a9I\n\u03a9\n(5.54)\nWe now use Corollary 4.1 (4.10) to observe that \u03c8 is a maximizer of the left of (5.54),\nso by taking the variation \u03c6 = \u03c8 + \u03b5\u03b7 with \u03b7 \u2208 C 1 (\u03a9I ) we obtain\nZ\n\n\u03a9I\n\n(\u03b7t + \u2207x \u03c8 * \u2207x \u03b7)\u03bc(dxdt) +\n\nZ\n\n\u03a9\n\n\u03b7(x, 0)\u03bc0 (dx) \u2212\n\nZ\n\n\u03a9\n\n\u03b7(x, T )\u03bc1 (dx) \u2265 0\n\nfor any such \u03b7. Replacing \u03b7 by \u2212\u03b7 we obtain the equality above. Moreover, by the\nsame argument following (5.49) to (5.51) we also obtain that\nZ\nZ\nZ tZ\n\u03b7(x, t)\u03bc(t) (dx) = 0 , (5.55)\n\u03b7(x, t0 )\u03bc(t0 ) (dx) \u2212\n(\u03b7t + \u2207x \u03c8 * \u2207x \u03b7)\u03bct (dx) +\nt0\n\n\u03a9\n\n\u03a9\n\n\u03a9\n\nhold for any 0 < t0 < t < T . In particular, \u03bc solves the weak form of the continuity\nequation with v = \u2207x \u03c8.\n\nNow, we know that, by the additional assumption on P , that K0 is invariant with\nrespect to the flow Ttt0 induced by the Lipschitz vectorfield v extending \u2207x \u03c8. We shall\n36\n\n\fnow prove that \u03bc is transported by this flow. That is, for any choice of t0 , t \u2208 (0, T ),\nwe need to show that \u03bc(t) = \u03b3t where\n\u0002\n\u0003\n\u03b3t := Ttt0 # \u03bct0 .\n\nSince T is the flow generated by v and K0 is invariant with respect to v it follows that\n\u03b3 = \u03b3t dt is supported on K and solves the weak form of the continuity equation as well.\nSetting \u03b6t = \u03bc(t) \u2212 \u03b3t , \u03b6 := \u03b6t dt we obtain from (5.55)\nZ tZ\nt0\n\n\u03a9\n\n(\u03b7\u03c4 + v * \u2207x \u03b7)\u03b6\u03c4 (dx)d\u03c4 =\n\nZ\n\n\u03b7(x, t)\u03b6t (dx)\n\n(5.56)\n\n\u03a9\n\nfor any \u03b7 \u2208 C 1 ([t0 , t]; R) where we used \u03b6t0 \u2261 0.\n\nLet now h = h(x) \u2208 C 1 (\u03a9). Let \u03b7 = \u03b7(x, \u03c4 ) be a solution of\n\u03b7\u03c4 + v * \u2207x \u03b7 = 0 ; \u03b7(x, t) = h(x) , t0 \u2264 \u03c4 \u2264 t .\n\n(5.57)\n\nSince, by Lemma 5.6 and Lemma 5.7, the vector field \u2207x \u03c8 = v is locally Lipschitz\ncontinuous on K0 which is invariant with respect to the induced flow, we can find a\nsolution of (5.57) on K \u2229 (\u03a9 \u00d7 [t0 , t]) via\n\u0001\n\u03b7(x, \u03c4 ) = h T\u03c4t (x) .\n(5.58)\nThe function \u03b7 so defined can be extended into a C 1 function on \u03a9 \u00d7 [t0 , t]. It satisfies\n(5.57) on K0 , so, recalling that \u03b6 is supported on K0 , we substitute now (5.57) in (5.56)\nto obtain \u03b6t \u2261 0 and the proof of part (iv).\n\nv) The optimality of T is evident from the proof of (iii) and (iv).\nvi) From the last part of Lemma 5.4 it follows that \u03c8 is a reversible solution so Lemma 5.6\nimplies that \u03c8t + |\u2207x \u03c8|2 /2 = 0 is satisfied everywhere on \u03a9I0 . The flow induced by such\na solution is given by Tt\u03c4 (x) = x + (t \u2212 \u03c4 )\u2207x \u03c8(x, \u03c4 ) and, by (iv) and (v), it transports\n\u03bc(\u03c4 ) to \u03bc(t) optimally.\n\n6\n\nAppendix\n\nProof. of Proposition 4.1:\nDefine\n\u03a6(c\u2217 , z) := F(c\u2217 )\u2212 < c\u2217 , z > + < h, z > .\nFirst, note that\nI = \u2217inf \u2217 sup \u03a6(c\u2217 , z) .\nc \u2208C z\u2208Z\n\nIndeed, if c\u2217 6\u2208 Z\u2217 then supz\u2208Z \u03a6(c\u2217 , z) = \u221e while, if c\u2217 \u2208 Z\u2217 then \u03c6(c\u2217 , z) = F(c\u2217 ) by\ndefinition. We have, therefore, to show\ninf sup \u03a6(c\u2217 , z) = sup \u2217inf \u2217 \u03a6(c\u2217 , z) .\n\nc\u2217 \u2208C\u2217 z\u2208Z\n\nz\u2208Z c \u2208C\n\n37\n\n\fIt is trivial that\ninf sup \u03a6(c\u2217 , z) \u2265 sup \u2217inf \u2217 \u03a6(c\u2217 , z) := I ,\n\nc\u2217 \u2208C\u2217 z\u2208Z\n\nz\u2208Z c \u2208C\n\nso we only have to show that\ninf sup \u03a6(c\u2217 , z) \u2264 I .\n\n(6.1)\n\nc\u2217 \u2208C\u2217 z\u2208Z\n\nDefine, for any z \u2208 Z\n\nAz = {c\u2217 \u2208 C\u2217 ; \u03a6(c\u2217 , z) \u2264 I} .\n\nNote that (6.1) follows provided\n\\\n\nz\u2208Z\n\nAz 6= \u2205 .\n\n(6.2)\n\nT\nThe next step is to show that, for any finite set z1 , . . . zn \u2208 Z, the set zi Azi 6= \u2205. The proof\nof this part can be taken from the proof of Theorem 2.8.1 in [Ba].\nFinally, note that A0 \u2282 A0 as defined in the Proposition, since I \u2264 I. It follows that A0\nis compact, and that the non-empty intersection of finite sets implies (6.2).\n\nProof. of Lemma 4.7:\nLet \u03c11 (r) be a smooth, positive function with compact support such that\nZ \u221e\nZ \u221e\nZ \u221e\nk\nn\u22121\nn\u22121\nr n\u22121 \u03c1p1 dr := L(p) .\nr \u03c11 (r)dr := Mk ;\nr\n\u03c11 (r)dr = 1 ;\n|S\n|\n0\n\n0\n\n0\n\nSet also\n\u03c1\u03b1 (r) = \u03b1n \u03c11 (\u03b1r) .\nDefine\nv(x, t) =\n\n\u03c1(x, t) =\n\n\uf8f1\n\uf8f2\n\uf8f3\n\n(\n\nx\u2212x(t)\nt\u2212t0 + \u1e8b(t)\nx\u2212x(t)\nt1 \u2212t + \u1e8b(t)\n\n\u0010\n\n\u0011\n\n|x\u2212x(t)|\n1\n(t\u2212t0 )n \u03c1\u03b1 \u0010 t\u2212t0 \u0011\n|x\u2212x(t)|\n1\nt1 \u2212t\n(t1 \u2212t)n \u03c1\u03b1\n\nif t0 \u2264 t \u2264 (t0 + t1 )/2\nif (t0 + t1 )/2 \u2264 t \u2264 t1\nif\n\nt0 \u2264 t \u2264 (t0 + t1 )/2\n\nif\n\n(t0 + t1 )/2 \u2264 t \u2264 t1\n\n.\n\nA direct calculation shows that \u03c1 satisfies the weak form of the continuity equation:\n\u03c1t + \u2207x * (v\u03c1) = 0 .\nLet us now consider the interval [t0 , (t0 + t1 )/2]. The second interval [(t0 + t1 )/2, t1 ] can be\ntreated analogously. Define the lifting of \u03c1 as\n\u0013\n\u0012\n|v \u2212 v|2\n\u03c1(x, t) .\nf (x, t, v) = \u03c3 \u2212n \u03c0 \u22122/n exp \u2212\n\u03c32\nIt follows immediately that\nZ\nZ\n\u03c3n\n|f |p dv = p\u2212n/2 \u03c0 2(1\u2212p)/n \u03c3 n(1\u2212p) \u03c1p (x, t) .\nv 2 f (x, t, v)dv =\n\u03c1(x, t) + v2 \u03c1(x, t) ;\n2\nn\nn\nR\nR\n38\n\n\fMoreover:\nZ\nZ\nZ\np\nn(1\u2212p) n\u22121\n\u03c1 (x, t)dx = (t\u2212t0 )\n|S\n|\n\u03c1(x, t)dx = 1 ;\n\u03a9\n\n\u03a9\n\nZ\n\n\u03a9\n\n2\n\n2\n\n|v(x, t)| \u03c1(x, t)dx = \u1e8b(t) + |S\n\nIn particular:\nZ Z\n\u03a9\n\n(t0 +t1 )/2\n\nt0\n\n|v|2 f =\n\nand\n\nZ Z\n\u03a9\n\nZ\n\n(t0 +t1 )/2\n\nt0\n\nn\u22121\n\n|\n\nZ\n\n\u221e\n\n0\n\n(t0 +t1 )/2\nt0\n\n\u221e\n0\n\nr n\u22121 \u03c1p\u03b1 (r)dr = \u03b1n(p\u22121) (t\u2212t0 )n(1\u2212p) |Sn\u22121 |L(p)\n2\n\nr n+1 \u03c1\u03b1 (r)dr = \u1e8b(t) + |Sn\u22121 |\u03b1\u22122 Mn+1\n2\n\n\u1e8b dt + C1 |t1 \u2212 t0 |\u03b1\u22122 + O(\u03c3)\n\n\u03c1p = C3 |t1 \u2212 t0 |n(1\u2212p)+1 \u03b1n(p\u22121)\n\nProof. of Lemma 5.8\nWe use Corollary 4.1 with \u03bc supported on \u03a9 \u00d7 [t1 , t0 ] and \u03bct0 = \u03b4x0 , \u03bct1 = \u03b4x1 , to obtain\nZ Z t1\n1\n2\n\u03c6(x1 , t1 ) \u2212 \u03c6(x0 , t0 ) \u2264 ||\u03bc||2 +\n(\u03c6t + |\u2207x \u03c6|2 /2)\u03bc(t (dx)dt .\n(6.3)\n2\n\u03a9 t0\nBy Lemma 4.7 we can find such a \u03bc for which:\nZ t1\n2\n2\n\u1e8b + C1 |t1 \u2212 t0 |\u03b1\u22122\n||\u03bc||2 \u2264\n\n(6.4)\n\nt0\n\nand, for the density \u03c1 = \u03c1\u03bc :\nZ Z\n\u03a9\n\nt1\n\nt0\n\n\u03c1p \u2264 C3 |t1 \u2212 t0 |n(1\u2212p)+1 \u03b1n(p\u22121)\n\n(6.5)\n\nwhere p < 1 + 1/n and \u03b1 any positive constant. Since \u03c1 is supported, for any t, in a domain\nof diameter (t1 \u2212 t0 )\u03b1\u22121 it follows\n\u0013 Z t1\n\u0012\nZ Z t1\nZ Z t1\nL(t1 \u2212 t0 )2\n2\n+\nP (x(t), t)dt +\n\u03be\u03c1dxdt ,\n(\u03c6t + |\u2207x \u03c6| /2)\u03c1dxdt = O\n\u03b1\nt0\n\u03a9 t0\n\u03a9 t0\nwhere L is the Lipschitz norm of P . By (6.5) we obtain\nZ Z t1\n1/p\n\u03be\u03c1dxdt \u2264 ||\u03c1||p ||\u03be||s \u2264 C3 |t1 \u2212 t0 |[n(1\u2212p)+1]/p \u03b1n(p\u22121)/p ||\u03be||s .\n\u03a9\n\n(6.6)\n\nt0\n\nCollecting (6.3) to (6.6)\n\u0013\n\u0012\nZ\nL(t1 \u2212 t0 )2\n1 t1\n2\n[n(1\u2212p)+1]/p n(p\u22121)/p\n\u22122\n.\n\u1e8b dt+C||\u03be||s |t1 \u2212t0 |\n\u03b1\n+C1 |t1 \u2212t0 |\u03b1 +O\n\u03c6(x1 , t1 )\u2212\u03c6(x0 , t0 ) \u2264\n2 t0\n\u03b1\n\u03b3\nThe choice \u03b1 = ||\u03be||\u2212\u03b2\ns (t1 \u2212 t0 ) where \u03b3 =\nand yields the desired result.\n\n(n+1)(p\u22121)\n2p+n(p\u22121)\n\n39\n\nand \u03b2 =\n\np\n2p+n(p\u22121)\n\nis the optimal choice\n\n\fReferences\n[Am] L. Ambrosio: Lectures Notes on Optimal Transport Problems, CVGMT Preprint:\nhttp://cvgmt.sns.it/papers/amb00a/\n[AGS] L. Ambrosio, N. Gigli & G. Savare: Gradient flows of probability measures, Preprint.\n[AFP] L. Ambrosio, N.Fusco & D.Pallara: Functions of Bounded Variations and Free\nDiscontinuity Problems, Oxford University Press, 2000.\n[B] Y. Brenier: Polar factorization and monotone rearrangement of vector valued functions,\nComm. Pure Appl. Math, 44, (1991), 375-417.\n[Ba]\n\nA.V. Balakrishnan, Applied Functional Analysis, Applications of Mathematics 3,\nSpringer-Verlag, 1976.\n\n[BB] J.D.Benamou, Y. Brenier: A computational fluid mechanics solution to the MongeKantorovich mass transfer problem, Numer.Math., 84 (2000), 375-393.\n[BBG] J.D.Benamou, Y. Brenier & K.Guitter: The Monge-Kantorovich mass transfer and\nits computational fluid mechanics formulation, Inter. J. Numer.Meth.Fluids, 40 (2002),\n21-30.\n[C] L. Caffarelli, Allocation maps with general cost functions, in Partial Differential Equations with Applications (ed. by Talenti), (1996), Dekker\n[E] L.C.Evans, Partial Differential Equations 1949- Providence, R.I. : American Mathematical Society, c1998.\n[GM] W. Gangbo & R.J. McCann: The geometry of optimal transportation, Acta Math.,\n177 (1996), 113-161\n[M] G. Monge: M\u00e9moire sur la th\u00e9orie des d\u00e9blais et de remblais, Histoire de l'Acad\u00e9mie\nRoyale des Sciences de Paris, 1781, pp. 666-704\n[RKF] J. Richard, D. Kinderlehrer & F. Otto: The variational formulation of the FokkerPlanck equation. SIAM J. Math. Anal. 29 (1998), no. 1, 1\u201317\n[V] C. Villani: Topics in Optimal Transportation, Graduate studies in Math, 58, AMS, 2003\n[W] G. Wolansky: Rotation numbers for measure-valued circle maps, J. D'anal. Math., to\nappear.\n\n40\n\n\f"}