{"id": "http://arxiv.org/abs/cond-mat/0702528v7", "guidislink": true, "updated": "2008-03-12T17:01:38Z", "updated_parsed": [2008, 3, 12, 17, 1, 38, 2, 72, 0], "published": "2007-02-22T19:56:11Z", "published_parsed": [2007, 2, 22, 19, 56, 11, 3, 53, 0], "title": "Full Potential Multiple Scattering for X-ray Spectroscopies", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cond-mat%2F0702202%2Ccond-mat%2F0702550%2Ccond-mat%2F0702324%2Ccond-mat%2F0702002%2Ccond-mat%2F0702517%2Ccond-mat%2F0702250%2Ccond-mat%2F0702302%2Ccond-mat%2F0702016%2Ccond-mat%2F0702057%2Ccond-mat%2F0702262%2Ccond-mat%2F0702661%2Ccond-mat%2F0702010%2Ccond-mat%2F0702436%2Ccond-mat%2F0702528%2Ccond-mat%2F0702478%2Ccond-mat%2F0702574%2Ccond-mat%2F0702357%2Ccond-mat%2F0702644%2Ccond-mat%2F0702026%2Ccond-mat%2F0702275%2Ccond-mat%2F0702416%2Ccond-mat%2F0702207%2Ccond-mat%2F0702477%2Ccond-mat%2F0702268%2Ccond-mat%2F0702516%2Ccond-mat%2F0702088%2Ccond-mat%2F0702491%2Ccond-mat%2F0702303%2Ccond-mat%2F0702680%2Ccond-mat%2F0702637%2Ccond-mat%2F0702582%2Ccond-mat%2F0702163%2Ccond-mat%2F0702394%2Ccond-mat%2F0702253%2Ccond-mat%2F0702287%2Ccond-mat%2F0702017%2Ccond-mat%2F0702181%2Ccond-mat%2F0702693%2Ccond-mat%2F0702590%2Ccond-mat%2F0702133%2Ccond-mat%2F0702662%2Ccond-mat%2F0702211%2Ccond-mat%2F0702007%2Ccond-mat%2F0702688%2Ccond-mat%2F0702296%2Ccond-mat%2F0702480%2Ccond-mat%2F0702196%2Ccond-mat%2F0702120%2Ccond-mat%2F0702492%2Ccond-mat%2F0702110%2Ccond-mat%2F0702483%2Ccond-mat%2F0702675%2Ccond-mat%2F0702175%2Ccond-mat%2F0702510%2Ccond-mat%2F0702426%2Ccond-mat%2F0702561%2Ccond-mat%2F0702019%2Ccond-mat%2F0702228%2Ccond-mat%2F0702130%2Ccond-mat%2F0702045%2Ccond-mat%2F0702490%2Ccond-mat%2F0702356%2Ccond-mat%2F0702430%2Ccond-mat%2F0702557%2Ccond-mat%2F0702609%2Ccond-mat%2F0702315%2Ccond-mat%2F0702073%2Ccond-mat%2F0702475%2Ccond-mat%2F0702099%2Ccond-mat%2F0702506%2Ccond-mat%2F0702101%2Ccond-mat%2F0702097%2Ccond-mat%2F0702346%2Ccond-mat%2F0702102%2Ccond-mat%2F0702305%2Ccond-mat%2F0702586%2Ccond-mat%2F0702418%2Ccond-mat%2F0702392%2Ccond-mat%2F0702641%2Ccond-mat%2F0702018%2Ccond-mat%2F0702368%2Ccond-mat%2F0702474%2Ccond-mat%2F0702445%2Ccond-mat%2F0702050%2Ccond-mat%2F0702051%2Ccond-mat%2F0702370%2Ccond-mat%2F0702423%2Ccond-mat%2F0702148%2Ccond-mat%2F0702276%2Ccond-mat%2F0702404%2Ccond-mat%2F0702422%2Ccond-mat%2F0702382%2Ccond-mat%2F0702061%2Ccond-mat%2F0702458%2Ccond-mat%2F0702199%2Ccond-mat%2F0702552%2Ccond-mat%2F0702640%2Ccond-mat%2F0702473%2Ccond-mat%2F0702024%2Ccond-mat%2F0702446%2Ccond-mat%2F0702256&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Full Potential Multiple Scattering for X-ray Spectroscopies"}, "summary": "We present a Full Potential Multiple Scattering (FP-MS) scheme for the\ninterpretation of several X-ray spectroscopies that is a straightforward\ngeneralization of the more conventional Muffin-Tin (MT) version. Like this\nlatter, it preserves the intuitive description of the physical process under\nconsideration and overcomes some of the limitations of the existing FP-MS\ncodes. It hinges on a fast and efficient method for solving the single cell\nscattering problem that avoids the convergence drawbacks of the angular\nmomentum (AM) expansion of the cell shape function and relies on an alternative\nderivation of the multiple scattering equations (MSE) that allows us to work\nreliably with only one truncation parameter, {\\it i.e.} the number of local\nbasis functions in the expansion of the global scattering function determined\nby the classical relation $l_{\\rm max} \\sim k R$.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cond-mat%2F0702202%2Ccond-mat%2F0702550%2Ccond-mat%2F0702324%2Ccond-mat%2F0702002%2Ccond-mat%2F0702517%2Ccond-mat%2F0702250%2Ccond-mat%2F0702302%2Ccond-mat%2F0702016%2Ccond-mat%2F0702057%2Ccond-mat%2F0702262%2Ccond-mat%2F0702661%2Ccond-mat%2F0702010%2Ccond-mat%2F0702436%2Ccond-mat%2F0702528%2Ccond-mat%2F0702478%2Ccond-mat%2F0702574%2Ccond-mat%2F0702357%2Ccond-mat%2F0702644%2Ccond-mat%2F0702026%2Ccond-mat%2F0702275%2Ccond-mat%2F0702416%2Ccond-mat%2F0702207%2Ccond-mat%2F0702477%2Ccond-mat%2F0702268%2Ccond-mat%2F0702516%2Ccond-mat%2F0702088%2Ccond-mat%2F0702491%2Ccond-mat%2F0702303%2Ccond-mat%2F0702680%2Ccond-mat%2F0702637%2Ccond-mat%2F0702582%2Ccond-mat%2F0702163%2Ccond-mat%2F0702394%2Ccond-mat%2F0702253%2Ccond-mat%2F0702287%2Ccond-mat%2F0702017%2Ccond-mat%2F0702181%2Ccond-mat%2F0702693%2Ccond-mat%2F0702590%2Ccond-mat%2F0702133%2Ccond-mat%2F0702662%2Ccond-mat%2F0702211%2Ccond-mat%2F0702007%2Ccond-mat%2F0702688%2Ccond-mat%2F0702296%2Ccond-mat%2F0702480%2Ccond-mat%2F0702196%2Ccond-mat%2F0702120%2Ccond-mat%2F0702492%2Ccond-mat%2F0702110%2Ccond-mat%2F0702483%2Ccond-mat%2F0702675%2Ccond-mat%2F0702175%2Ccond-mat%2F0702510%2Ccond-mat%2F0702426%2Ccond-mat%2F0702561%2Ccond-mat%2F0702019%2Ccond-mat%2F0702228%2Ccond-mat%2F0702130%2Ccond-mat%2F0702045%2Ccond-mat%2F0702490%2Ccond-mat%2F0702356%2Ccond-mat%2F0702430%2Ccond-mat%2F0702557%2Ccond-mat%2F0702609%2Ccond-mat%2F0702315%2Ccond-mat%2F0702073%2Ccond-mat%2F0702475%2Ccond-mat%2F0702099%2Ccond-mat%2F0702506%2Ccond-mat%2F0702101%2Ccond-mat%2F0702097%2Ccond-mat%2F0702346%2Ccond-mat%2F0702102%2Ccond-mat%2F0702305%2Ccond-mat%2F0702586%2Ccond-mat%2F0702418%2Ccond-mat%2F0702392%2Ccond-mat%2F0702641%2Ccond-mat%2F0702018%2Ccond-mat%2F0702368%2Ccond-mat%2F0702474%2Ccond-mat%2F0702445%2Ccond-mat%2F0702050%2Ccond-mat%2F0702051%2Ccond-mat%2F0702370%2Ccond-mat%2F0702423%2Ccond-mat%2F0702148%2Ccond-mat%2F0702276%2Ccond-mat%2F0702404%2Ccond-mat%2F0702422%2Ccond-mat%2F0702382%2Ccond-mat%2F0702061%2Ccond-mat%2F0702458%2Ccond-mat%2F0702199%2Ccond-mat%2F0702552%2Ccond-mat%2F0702640%2Ccond-mat%2F0702473%2Ccond-mat%2F0702024%2Ccond-mat%2F0702446%2Ccond-mat%2F0702256&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a Full Potential Multiple Scattering (FP-MS) scheme for the\ninterpretation of several X-ray spectroscopies that is a straightforward\ngeneralization of the more conventional Muffin-Tin (MT) version. Like this\nlatter, it preserves the intuitive description of the physical process under\nconsideration and overcomes some of the limitations of the existing FP-MS\ncodes. It hinges on a fast and efficient method for solving the single cell\nscattering problem that avoids the convergence drawbacks of the angular\nmomentum (AM) expansion of the cell shape function and relies on an alternative\nderivation of the multiple scattering equations (MSE) that allows us to work\nreliably with only one truncation parameter, {\\it i.e.} the number of local\nbasis functions in the expansion of the global scattering function determined\nby the classical relation $l_{\\rm max} \\sim k R$."}, "authors": ["Keisuke Hatada", "Kuniko Hayakawa", "Maurizio Benfatto", "Calogero R. Natoli"], "author_detail": {"name": "Calogero R. Natoli"}, "author": "Calogero R. Natoli", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevB.76.060102", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/cond-mat/0702528v7", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/cond-mat/0702528v7", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "4 pages 2 figures", "arxiv_primary_category": {"term": "cond-mat.mtrl-sci", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.mtrl-sci", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/cond-mat/0702528v7", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/cond-mat/0702528v7", "journal_reference": "Physical Review B (Vol.76, No.6) 060102 (Rapid Communications)\n  (2007)", "doi": "10.1103/PhysRevB.76.060102", "fulltext": "Full Potential Multiple Scattering for X-ray Spectroscopies\nKeisuke Hatada1,2 , Kuniko Hayakawa3,2, Maurizio Benfatto2 , and Calogero R. Natoli2\n\narXiv:cond-mat/0702528v7 [cond-mat.mtrl-sci] 12 Mar 2008\n\n1\n\nDipartimento di Fisica \"E. Amaldi\", Universit\u00e0 degli studi Roma Tre, Via Vasca Navale 84, Rome, I-00146 Italy,\n2\nLaboratori Nazionali di Frascati - INFN, Via E. Fermi 40, 00044 Frascati, Italy,\n3\nMuseo Storico della Fisica e Centro Studi e Ricerche \"Enrico Fermi\", Via Panisperna 89A, 00184, Roma, Italy\n(Dated: October 29, 2018)\nWe present a Full Potential Multiple Scattering (FP-MS) scheme for the interpretation of several\nX-ray spectroscopies that is a straightforward generalization of the more conventional Muffin-Tin\n(MT) version. Like this latter, it preserves the intuitive description of the physical process under\nconsideration and overcomes some of the limitations of the existing FP-MS codes. It hinges on a\nfast and efficient method for solving the single cell scattering problem that avoids the convergence\ndrawbacks of the angular momentum (AM) expansion of the cell shape function and relies on an\nalternative derivation of the multiple scattering equations (MSE) that allows us to work reliably\nwith only one truncation parameter, i.e. the number of local basis functions in the expansion of the\nglobal scattering function determined by the classical relation lmax \u223c k R.\nPACS numbers: 61.05.js,61.05.cj,71.15.Ap\n\nMultiple scattering theory ( MST ) has been widely\nused to solve the Schr\u00f6dinger equation (SE) ( or the associated Lippmann-Schwinger equation (LSE)) both for\nscattering and bound states. It was proposed originally\nby Korringa and by Kohn and Rostoker (KKR) as a convenient way to calculate the electronic structure of solids\n[1, 2] with potentials of the muffin-tin (MT) form (i.e.\npotentials that are bounded by non overlapping spheres\nand spherically symmetric), and was later extended to\npolyatomic molecules by Slater and Johnson [3]. However the MT approximation cannot properly describe a\ngreat number of physical systems, ranging from open lattices to molecular systems with substantial anisotropy (\ne.g. systems of biological interest ), to surfaces and interfaces.\nThe attempts to extend MST to space-filling potential\ncells in order to eliminate the interstitial region and take\nfull account of the asphericity of the potential, have generated a lot of controversies that have gone on for more\nthan twenty years [4]. Many (but not all) of the questions are now settled and we refer the reader to the book\nof Gonis and Butler [5] for a comprehensive review of\nthe state of the art in this field. Usually the applications of the space-filling method have regarded mainly\nthe calculations of the electronic structure of solids, i.e.\nstates below the Fermi level. Applications to states well\nabove the Fermi energy, as required in the simulations\nof x-ray spectroscopies, like absorption, photo-emission,\nanomalous scattering, etc..., have been scarce, probably\ndue to the difficulties encountered in the numerical implementation of the method. We mention here the work\nby Huhne and Ebert [6] on the calculation of x-ray absorption spectra using the full-potential spin-polarized\nrelativistic MST, that of Ankudinov and Rehr [7] and\nthat of Foulis [8] based on a version of the MST that\nuses spherical cells and treats the interstitial potential in\nthe Born approximation [9, 10].\nAll these methods, however, have their limitations and\n\ndrawbacks. The method used by Foulis treats in an approximate way the potential in the interstitial region and\nmoreover looses one of the major advantages of the MST,\nnamely the separation between dynamics and geometry\nin the solution of the scattering problem. Huhne and\nAnkudinov use the potential shape function to generate the local basis functions which are at the heart of\nMST. The expansion of the shape function and the cell\npotential in spherical harmonics leads to a high number\nof spherical components in the coupled radial equations\nthat becomes progressively cumbersome to handle and\ntime consuming with increasing energy and in absence of\nsymmetry. This feature might also be at the origin of another problem related with the saturation of \"internal\"\nsums in the MSE [5], as discussed below. Moreover no\ncritical discussion is devoted in their work to the convergence problems of MST.\nThe purpose of this letter is to give an alternative\nderivation and interpretation of the FP-MS equations\nthat will allow us to work with square matrices for the\nphase functions SLL\u2032 and ELL\u2032 and for the cell TLL\u2032\nmatrix (see below) with only one truncation parameter,\ncontrary to the present accepted view [5]. As a result\nthis scheme can be viewed as a natural extension of its\nMT counterpart, with all the consequent advantages for\nthe interpretation of X-ray spectroscopies. In connection\nwith this we shall present a new scheme to generate local\nbasis functions for the truncated potential cells that is\nsimple, fast, efficient, valid for any shape of the cell and\nreduces to the minimum the number of spherical harmonics in the expansion of the scattering wave function.\nIn order to solve for scattering states we seek a solution of the SE continuous in the whole space with its\nfirst derivatives, satisfying the\nasymptotic boundary\nconi\n\u0001 21 h ik*r\neikr\nk\ne\n+ f (r\u0302; k) r , where k\ndition \u03c8(r; k) \u2243 16\u03c03\nis the photo-electron wave-vector. We partition the space\nin terms of non overlapping space-filling cells \u03a9j with\n\n\f2\nsurfaces Sj and centers at Rj . This is equivalent to partitioning the overall space\nP potential V (r) into cell potentials, such that V (r) = j vj (rj ), where vj (rj ) takes the\nvalue of V (r) for r inside cell j and vanishes elsewhere.\nHere and in the following rj = r \u2212 Rj . The partition\nis assumed to satisfy the requirement that the shortest\ninter-cell vector Rij = Ri \u2212 Rj joining the origins of the\nnearest neighbors cells i and j, is larger than any intracell vector ri or rj , when r is inside either cell i or cell\nj. We also assume that there exists a finite neighborhood around the origin of each cell lying in the domain\nof the cell [4]. We then start from the following identity\ninvolving surface integrals in dr\u0302 \u2261 d\u03c3\nN Z\nX\n\nSj\n\nj=1\n\n=\n\nZ\n\nSo\n\n\u0002\n\n\u0003\n+ \u2032\n\u2032\nG+\n0 (r \u2212 r)\u2207\u03c8(r) \u2212 \u03c8(r)\u2207G0 (r \u2212 r) * nj d\u03c3j\n\n\u0002 + \u2032\n\u0003\n\u2032\nG0 (r \u2212 r)\u2207\u03c8(r) \u2212 \u03c8(r)\u2207G+\n0 (r \u2212 r) * no d\u03c3o .\n\n+ \u2032\nHere\nP G0 (r \u2212 r) is the free Green's function and \u03a9o =\u2032\nj \u03a9j , with surface So . This identity is valid for all r\nlying in the neighborhood of the origin of each cell, since\nin this case the integrands are continuous with their first\nderivatives.\nThe heart of MST is the introduction of the functions \u03a6L (rj ) which inside cell j are local solutions of\nthe SE with potential vj (rj ) behaving as JL (rj ) for\nrj \u2192 0. They form a complete set of basis functions\nsuch that the global scattering\nfunction can be loP wave\nj\nA\n(k)\u03a6\ncally expanded as \u03c8(rj ) =\nL (rj ) [4]. UsL L\ning this expansion in the above surface integrals, taking\nr\u2032 in the neighborhood of the\nP origin\u2032 of+cell i, so that\n+ \u2032\n\u2032\nG+\n(r\n\u2212\nr)\n\u2261\nG\n(r\n\u2212\nr\n)\n=\ni\n0\n0\ni\nL JL (ri )H\u0303L (ri ) (since r is\nconfined to lie on the cell surfaces), and putting to zero\nthe coefficients of JL (r\u2032i ) due to their linear independence,\nwe readily arrive at the MST compatibility equations for\nthe amplitudes AjL (k) (see Ref. [5] page 129 for analogous\nderivation in the case of bound states)\nX ij j\nHLL\u2032 AL\u2032 (k) = YL (k\u0302)eik*Ri (k/\u03c0)1/2 = ILi (k) (1)\njL\u2032\n\nwhere\nij\nHLL\n\u2032 =\n\nZ\n\nSj\n\n[ H\u0303L+ (ri )\u2207\u03a6L\u2032 (rj )\u2212\u03a6L\u2032 (rj )\u2207H\u0303L+ (ri ) ]*nj d\u03c3j\n\nand the rhs term comes from the outer sphere \u03a9o (see\nAppendix A of Ref. [11] for details). As usual JL (r) =\njl (kr)YL (r\u0302) and H\u0303L+ (r) = \u2212ikh+\nl (kr)YL (r\u0302). The usual\nderivation of the MSE now proceeds by re-expanding\nH\u0303 + (r ) around center j by use of the equation H\u0303L+ (ri ) =\nPL i ij\nij\nL\u2032 GLL\u2032 JL\u2032 (rj ), where GLL\u2032 are the free electron propagator in the site and angular momentum basis ( KKR\nreal space structure factors). Unfortunately this relation\nintroduces a further expansion parameter into the theory\n\n(with related convergence problems) which is actually unnecessary, as shown below.\nWe in fact observe that the integrals over the surfaces\nof the various cells j can be calculated over the surfaces of\nthe corresponding bounding spheres (with radius Rbj ) by\napplication of the Green's theorem, since both H\u0303L+ (r) and\n\u03a6L (r) satisfy the Helmholtz equation outside the domain\nof the cell (where the potential is zero). We then use the\nfollowing relation\nZ\nd\njl\u2032 (kRbj ) (2)\nYL\u2032 (r\u0302j )\u2207 H\u0303L+ (ri ) * nj d\u03c3j = Gij\nLL\u2032\ndRbj\nSj\n(and the similar one without derivatives) which is\nexact for all L provided |ri \u2212 rj | = Rij > rj\nfor r lying on the surface Sj .\nThis is a consequence of the\nfact\nthat\nunder\nthis\ncondition\nthe series\nP\nij\n\u2032\nG\n(r\n)\nconverges\nabsolutely,\nsince\nJ\nH\u0303L+ (ri ) =\nj\nL\u2032 LL\u2032 L\n\u2032\nij\nl\nl+1\n\u2032\nGLL\u2032 JL\u2032 (rj ) \u2264 (rj /Rij ) 1/(kRij ) [2(l + l) + 1]l for\nfixed l, as can be seen by using the usual expression for\nGij\nLL\u2032 and the asymptotic expansion of the Bessel functions for high values of the index l\u2032 (l\u2032 \u226b krj ) [12]. By\nuse of the Weierstrass criterium, the series is also uniformly convergent in the entire solid angle domain and\ncan therefore be integrated term by term [13], leading to\nthe desired result (this property is also true for the series\nderived with respect to r) .\nBy inserting in Eq. (1) the expression for the basis\nP functions expanded in spherical harmonics \u03a6L (r) =\nL\u2032 RL\u2032 L (r)YL\u2032 (r\u0302) and using Eq. (2), we finally obtain\nX\nL\u2032\n\ni\ni\nELL\n\u2032 AL\u2032 (k) \u2212\n\nj6=i\nX\n\nj\nj\ni\nGij\nLL\u2032\u2032 SL\u2032\u2032 L\u2032 AL\u2032 (k) = IL (k)\n\nj,L\u2032 ,L\u2032\u2032\n\n(3)\n\ndefining\n2\n\u2032\n\u2032\n\u2032\nELL\u2032 = Rb2 W [\u2212ikh+\nl , RLL ]; SLL = Rb W [jl , RLL ]\n\nwhere the Wronskians W [f, g] = f g \u2032 \u2212 gf \u2032 are calculated\nat Rb and reduce to diagonal matrices for MT potentials.\nWe observe that, even if the potential has a step, the\nwave function and its first derivatives are continuous, so\nthat the AM expansion converges uniformly in r\u0302 [14] and\ncan be thus integrated term by term. Eq. (3) looks formally similar to the usual MSE. However we notice that\nthe sum over L\u2032\u2032 runs over the angular momentum components of the basis functions \u03a6L (r) and is not affected\nby convergence constraints related to the re-expansion of\nH\u0303L+ (ri ) around center j.\nTo find the local solutions of the SE we do not expand\nthe truncated cell potential to avoid AM expansion problems. Dropping the cell index j, we write the SE in polar\ncoordinates for the function PL (r) = r\u03a6L (r)\n\u0014 2\n\u0015\nd\n1\n+ E \u2212 v(r, r\u0302) PL (r, r\u0302) = 2 L\u03032 PL (r, r\u0302) (4)\ndr2\nr\n\n\f3\nwhere L\u03032 is the angular momentum operator, whose action on PL (r, r\u0302) can be calculated as:\nX\nL\u03032 PL (r, r\u0302) =\nl\u2032 (l\u2032 + 1)rRL\u2032 L (r)YL\u2032 (r\u0302).\n(5)\nL\u2032\n\nEquation (4) in the variable r looks like a second order\nequation with an inhomogeneous term. Accordingly we\nuse Numerov's method to solve it. As is well known,\nL\nputting fi,j\n= PL (ri , r\u0302j ) and dropping for simplicity the\nindex L, the associated three point recursion relation is\nAi+1,j fi+1,j \u2212 Bi,j fi,j + Ai\u22121,j fi\u22121,j = gi,j \u2212\n\nh6 vi\nf\n240 i,j\n\nwhere,\nh2\nvi,j\n12\n5h2\nvi,j = 12 \u2212 10Ai,j\n= 2+\n6\n= v(ri , r\u0302j ) \u2212 E\n\nAi,j = 1 \u2212\nBi,j\nvi,j\n\nh2\n[qi+1,j + 10qi,j + qi\u22121,j ]\n12\n1 X \u2032 \u2032\n= 2\nl (l + 1)ri RL\u2032 L (ri )YL\u2032 (r\u0302j ).\nri \u2032\n\ngi,j =\nqi,j\n\nL\n\nHere i is an index of radial mesh and j an index of angular points P\non a Lebedev surface grid [15]. Obviously\nRL\u2032 L (ri ) = j wj PL (ri , r\u0302j )/ri YL\u2032 (r\u0302j ), where wj is the\nweight function for angular integration associated with\nthe chosen grid.\nOnly the inhomogeneous term qi+1,j in the recurrence\nrelation, containing the still unknown term fi+1,j , prevents us to solve the equation by iteration, from the\nknowledge of fi,j and fi\u22121,j at all the angular points.\nThis difficulty is easily overcome by introducing the backward second derivative formula, whereby\ngi,j \u223c\n\nh5 \u2032\u2032\u2032\nh6 iv\nh2\n[13qi,j \u2212 2qi\u22121,j + qi\u22122,j ] + qi,j\n\u2212 qi,j\n(6)\n12\n12\n24\n\nso that at the cost of a small errors O(h5 ) only the backward points fi,j , fi\u22121,j and fi\u22122,j are now involved. The\nappearance of qi\u2032\u2032\u2032 , strictly infinite at the step point, does\nnot cause practical problems.\nIn this way the three-dimensional discretized equation\ncan be solved along the radial direction for all angles in\nan onion-like way [12], provided the expansion (5) is performed at each new radial mesh point. We use a log-linear\nmesh \u03c1 = \u03b1 r + \u03b2 ln r, to reduce numerical errors around\nthe origin and the bounding sphere. [16]. We tested this\nmodified Numerov method against analytically solvable\nseparable model potentials, with and without shape truncation, obtaining very good results [12].\nThe next delicate point to tackle is how to handle and\ntruncate the various L sums in Eq. (3). Here only two\n\ntruncation parameters appear, the number of basis functions and the number of their AM components, corresponding to the indexes L\u2032 and L in RLL\u2032 . (The external index L in Eq. (1), coming from the expansion of\nG+\n0 , must coincide with the index L of RLL\u2032 when calii\ni\nculating HLL\n\u2032 \u2261 ELL\u2032 , due to the orthogonality of the\nspherical harmonics). These two indexes are in principle\nunrelated, although one can speculate that for l > k Rb\nand positive energies the wave-function hardly sees the\nanisotropy of the potential. This is in practice what happens in our method of generating the local basis functions, so that the two indexes can be cut safely at the\nsame value lmax \u223c k Rb and the matrices S and E can\nbe treated like square matrices. This is also in keeping\nwith the physical fact that the elements of the atomic Tmatrix Tll = (SE \u22121 )ll tend rapidly to zero for l > lmax .\nThe need to converge first the internal sum over L\u2032\u2032 in Eq.\n(3), pointed out by various authors, was probably related\nto the slow rate of convergence in the AM expansion of\nthe basis functions, due to their method of generation.\nWe are aware that even in the case of \"small\" overlap of the cell bounding spheres the L truncation procedure is likely to be divergent [17]. A simple calculation [12] shows that G(Rij )ll Tll goes like (2Rb /Rij )2l /l3\nfor l >> lmax , which explains why for \"small\" overlap\nthe spectrum seems to converge at first, but actually diverges for high values of lmax , which in practice depends\non various parameters, with the typical behavior of the\nasymptotic series. In keeping with this view one can\nattribute a meaning to the finite result obtained by truncating the MSE: at a given lmax the difference between\nthe exact and the approximate result can be made very\nsmall, provided the independent parameters of the theory\n(like the photo-electron energy and the amount of overlap\nbetween the bounding spheres) lie in a definite domain of\ntheir definition space. For energies in the near edge region this can be obtained by taking a moderate overlap\nbetween bounding spheres, of the order of 30\u223c40%, so as\nto reduce the space between them and their MT spheres.\nEmpty spheres can be added to satisfy this condition.\nWe have tested the present FP-MS scheme against\nthe analytical solution of the absorption cross section for\nhydrogen-like atoms given by [18]\n27 1\n\u03c3 ( k ) = 4\u03c0 \u03b1\n3 Z2\n2\n\n1\n1 + ( Zk )2\n\n!4\n\nZ\n\ne\u22124 k\n\nk\ntan\u22121 ( Z\n)\nZ\n\n1 \u2212 e\u22122\u03c0 k\n\nin the case of the Li2+ atom (Z = 3). Even though\nthe potential is spherically symmetric in the whole space\nwith respect to the atomic center so that it is easy to\nreproduce numerically the cross section, this is not obvious in the MS scheme. To this purpose we have partitioned the space inside a sphere of radius R = 8.6 au\ninto an atomic sphere of 4.15 au and 14 other empty\nspheres, all truncated so that the resulting polyhedra do\n\n\f4\n\nFIG. 1: (color online) Cross section for Li2+ with 15 cells\ncompared to the analytical result. The solution for a MT\ncentral sphere is also shown.\n\nnot overlap and such that their bounding sphere do not\noverlap more than 40%. To calculate the contribution\nof the outer sphere we integrated inwardly the Coulomb\npotential. Fig. 1 shows the almost exact agreement between the analytical and the numerical result, indicating\nthat the partitioning procedure for solving the SE is able\nto reconstruct the global solution. Moreover the oscillations due to the truncation of the potential inside each\ncell (shown by the solution for a truncated central sphere\nwith radius 4.15 au) cancel each other, showing that at a\ncommon boundary the overall solutions inside two adjacent cells are continuously\nsmooth. For this test a value\n\u221a\nof lmax = 4.15 3 \u223c 8 was taken at the end of the energy\ninterval Emax = 3 Ryd.\nFig. 2a shows an application of the method to the\ncalculation of the Ge K-edge absorption spectrum of the\ntetrahedral molecule GeCl4 [19]. The MT approximation could never reproduce the first bump after the main\ntransition. Its appearance is due to the introduction of\nthe anisotropy of the potential inside the atoms and the\npresence of four empty Voronoi cells completing the BCC\nunit cell. An lmax = 4 was sufficient to reach convergence\nof the spectrum, as verified by using higher l values up\nto lmax = 10 (Fig. 2b).\nIn conclusions we have developed a FP-MS scheme\nwhich is a straightforward generalization of the usual\ntheory with MT potentials and implemented the code\nto calculate the cross section for several spectroscopies\nlike absorption, photo-electron diffraction and anomalous\nscattering. The key point in this approach is the generation of the cell solutions \u03a6L ( r ) for a general truncated\npotential free of the well known convergence problems of\nAM expansion together with an alternative derivation of\nthe MSE which allows us to treat the matrices S and E\nas square, with only one truncation parameter given by\nthe classical relation lmax \u223c k R. Even though this truncation procedure does not converge, taking a moderate\noverlap between bounding spheres assures satisfactory result in the approximation of the exact solution. At the\nsame time we have provided an efficient and fast method\n\nFIG. 2: (color online) (a) Cross section for GeCl4 molecule\nwith nine scattering cells located at the sites of a BCC lattice,\ncompared with the MT result and experiment. (b) Study of\nits convergence rate as a function of lmax up to lmax = 10.\n\nfor solving numerically a partial differential equation of\nthe elliptic type in polar coordinates which can also be\nused to solve the Poisson equation.\nK. Hatada and C.R. Natoli wish to thank Dr.\nKr\u00fcger for many useful discussions.\n\nP.\n\n[1] J. Korringa, Physica 13, 392 (1947).\n[2] W. Kohn and N. Rostoker, Phys. Rev. 94, 1111 (1954).\n[3] J. C. Slater and K. H. Johnson, Phys. Rev. B 5, 844\n(1972).\n[4] W. H. Butler, A. Gonis, and X. G. Zhang, Phys. rev. B\n45, 11527 (1992).\n[5] A. Gonis and W. H. Butler, Multiple Scattering in Solids\n(Springer Verlag, Inc., New York, 2000), and references\ntherein.\n[6] T. Huhne and H. Ebert, Solid State Commun. 109, 577\n(1999).\n[7] A. L. Ankudinov and J. J. Rehr, Phys. Scr. T115, 24\n(2005).\n[8] D. L. Foulis, R. F. Pettifer, and P. Sherwood, Europhys.\nLett. 29, 647 (1995).\n[9] C. R. Natoli, M. Benfatto, C. Brouder, M. F. R. L\u00f3pez,\nand D. L. Foulis, Phys. Rev. B 42, 1944 (1990).\n[10] D. L. Foulis, R. F. Pettifer, C. R. Natoli, and M. Benfatto, Phys. Rev. A 41, 6922 (1990).\n[11] D. Sebilleau, R. Gunnella, Z.-Y. Wu, S. D. Matteo, and\nC. R. Natoli, J. Phys.: Cond. Matter 18, R175 (2006).\n[12] K. Hatada, K. Hayakawa, M. Benfatto, and C. R. Natoli,\nTo be submitted (2007).\n[13] E. Whittaker and G. Watson, A course of modern analysis (Cambridge University Press, Cambridge, 1965).\n[14] O. D. Kellog, Foundations of Potential Theory (Dover,\nNew York, 1954).\n[15] V. I. Lebedev, Computational Mathematics and Mathematical Physics 15, 44 (1975).\n[16] V. F. Brastev, Atomic Wavefunctions (Nauka, Moscow,\n1966).\n\n\f5\n[17] W. H. Butler and X. G. Zhang, Phys. Rev. B 44, 969\n(1991), pag. 979.\n[18] H. A. Bethe and E. E. Salpeter, Quantum mechanics\nof one- and two-electron atoms (Plenum/Rosetta, New\n\nYork, 1977), p. 304.\n[19] A. Filipponi and P. D'Angelo, J. Chem. Phys. 109, 5356\n(1998).\n\n\f"}