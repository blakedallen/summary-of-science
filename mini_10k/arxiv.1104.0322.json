{"id": "http://arxiv.org/abs/1104.0322v4", "guidislink": true, "updated": "2013-07-27T17:34:37Z", "updated_parsed": [2013, 7, 27, 17, 34, 37, 5, 208, 0], "published": "2011-04-02T15:44:56Z", "published_parsed": [2011, 4, 2, 15, 44, 56, 5, 92, 0], "title": "Explosive behavior in a log-normal interest rate model", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.4097%2C1104.5482%2C1104.0668%2C1104.1890%2C1104.0840%2C1104.3191%2C1104.1965%2C1104.1895%2C1104.3958%2C1104.3463%2C1104.0458%2C1104.2709%2C1104.5413%2C1104.0596%2C1104.0694%2C1104.3847%2C1104.0907%2C1104.1108%2C1104.1136%2C1104.1535%2C1104.1041%2C1104.2747%2C1104.3510%2C1104.4333%2C1104.1573%2C1104.4814%2C1104.0530%2C1104.2101%2C1104.0835%2C1104.5480%2C1104.2151%2C1104.0355%2C1104.5011%2C1104.5088%2C1104.3353%2C1104.2900%2C1104.4378%2C1104.5555%2C1104.1326%2C1104.1935%2C1104.0553%2C1104.1586%2C1104.2124%2C1104.4720%2C1104.3389%2C1104.2181%2C1104.0322%2C1104.4695%2C1104.2232%2C1104.3852%2C1104.0850%2C1104.1932%2C1104.2264%2C1104.3192%2C1104.5680%2C1104.0338%2C1104.2663%2C1104.1310%2C1104.0131%2C1104.2855%2C1104.5567%2C1104.5131%2C1104.1492%2C1104.3856%2C1104.1368%2C1104.1207%2C1104.3439%2C1104.2546%2C1104.4812%2C1104.1569%2C1104.4512%2C1104.2761%2C1104.3676%2C1104.3517%2C1104.1309%2C1104.2041%2C1104.2404%2C1104.2078%2C1104.0543%2C1104.4077%2C1104.1263%2C1104.1623%2C1104.1039%2C1104.0844%2C1104.1353%2C1104.5033%2C1104.2614%2C1104.5270%2C1104.0053%2C1104.3995%2C1104.2063%2C1104.0509%2C1104.0193%2C1104.3779%2C1104.5221%2C1104.3681%2C1104.4680%2C1104.2448%2C1104.0489%2C1104.5281%2C1104.5372&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Explosive behavior in a log-normal interest rate model"}, "summary": "We consider an interest rate model with log-normally distributed rates in the\nterminal measure in discrete time. Such models are used in financial practice\nas parametric versions of the Markov functional model, or as approximations to\nthe log-normal Libor market model. We show that the model has two distinct\nregimes, at high and low volatilities, with different qualitative behavior. The\ntwo regimes are separated by a sharp transition, which is similar to a phase\ntransition in condensed matter physics. We study the behavior of the model in\nthe large volatility phase, and discuss the implications of the phase\ntransition for the pricing of interest rate derivatives. In the large\nvolatility phase, certain expectation values and convexity adjustments have an\nexplosive behavior. For sufficiently low volatilities the caplet smile is\nlog-normal to a very good approximation, while in the large volatility phase\nthe model develops a non-trivial caplet skew. The phenomenon discussed here\nimposes thus an upper limit on the volatilities for which the model behaves as\nintended.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.4097%2C1104.5482%2C1104.0668%2C1104.1890%2C1104.0840%2C1104.3191%2C1104.1965%2C1104.1895%2C1104.3958%2C1104.3463%2C1104.0458%2C1104.2709%2C1104.5413%2C1104.0596%2C1104.0694%2C1104.3847%2C1104.0907%2C1104.1108%2C1104.1136%2C1104.1535%2C1104.1041%2C1104.2747%2C1104.3510%2C1104.4333%2C1104.1573%2C1104.4814%2C1104.0530%2C1104.2101%2C1104.0835%2C1104.5480%2C1104.2151%2C1104.0355%2C1104.5011%2C1104.5088%2C1104.3353%2C1104.2900%2C1104.4378%2C1104.5555%2C1104.1326%2C1104.1935%2C1104.0553%2C1104.1586%2C1104.2124%2C1104.4720%2C1104.3389%2C1104.2181%2C1104.0322%2C1104.4695%2C1104.2232%2C1104.3852%2C1104.0850%2C1104.1932%2C1104.2264%2C1104.3192%2C1104.5680%2C1104.0338%2C1104.2663%2C1104.1310%2C1104.0131%2C1104.2855%2C1104.5567%2C1104.5131%2C1104.1492%2C1104.3856%2C1104.1368%2C1104.1207%2C1104.3439%2C1104.2546%2C1104.4812%2C1104.1569%2C1104.4512%2C1104.2761%2C1104.3676%2C1104.3517%2C1104.1309%2C1104.2041%2C1104.2404%2C1104.2078%2C1104.0543%2C1104.4077%2C1104.1263%2C1104.1623%2C1104.1039%2C1104.0844%2C1104.1353%2C1104.5033%2C1104.2614%2C1104.5270%2C1104.0053%2C1104.3995%2C1104.2063%2C1104.0509%2C1104.0193%2C1104.3779%2C1104.5221%2C1104.3681%2C1104.4680%2C1104.2448%2C1104.0489%2C1104.5281%2C1104.5372&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We consider an interest rate model with log-normally distributed rates in the\nterminal measure in discrete time. Such models are used in financial practice\nas parametric versions of the Markov functional model, or as approximations to\nthe log-normal Libor market model. We show that the model has two distinct\nregimes, at high and low volatilities, with different qualitative behavior. The\ntwo regimes are separated by a sharp transition, which is similar to a phase\ntransition in condensed matter physics. We study the behavior of the model in\nthe large volatility phase, and discuss the implications of the phase\ntransition for the pricing of interest rate derivatives. In the large\nvolatility phase, certain expectation values and convexity adjustments have an\nexplosive behavior. For sufficiently low volatilities the caplet smile is\nlog-normal to a very good approximation, while in the large volatility phase\nthe model develops a non-trivial caplet skew. The phenomenon discussed here\nimposes thus an upper limit on the volatilities for which the model behaves as\nintended."}, "authors": ["Dan Pirjol"], "author_detail": {"name": "Dan Pirjol"}, "author": "Dan Pirjol", "arxiv_comment": "20 pages, 5 figures. Revised version published in IJTAF", "links": [{"href": "http://arxiv.org/abs/1104.0322v4", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1104.0322v4", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-fin.CP", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-fin.CP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-fin.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1104.0322v4", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1104.0322v4", "journal_reference": "International Journal of Theoretical and Applied Finance, vol. 16,\n  p.1350023 (2013)", "doi": null, "fulltext": "EXPLOSIVE BEHAVIOR IN A LOG-NORMAL INTEREST RATE\nMODEL\n\narXiv:1104.0322v4 [q-fin.CP] 27 Jul 2013\n\nDAN PIRJOL\u2217\nAbstract. We consider an interest rate model with log-normally distributed rates in the terminal\nmeasure in discrete time. Such models are used in financial practice as parametric versions of the\nMarkov functional model, or as approximations to the log-normal Libor market model. We show that\nthe model has two distinct regimes, at low and high volatility, with different qualitative behavior. The\ntwo regimes are separated by a sharp transition, which is similar to a phase transition in condensed\nmatter physics. We study the behavior of the model in the large volatility phase, and discuss\nthe implications of the phase transition for the pricing of interest rates derivatives. In the large\nvolatility phase, certain expectation values and convexity adjustments have an explosive behavior.\nFor sufficiently low volatilities the caplet smile is log-normal to a very good approximation, while in\nthe large volatility phase the model develops a non-trivial caplet skew. The phenomenon discussed\nhere imposes thus an upper limit on the volatilities for which the model behaves as intended.\nKey words. short rate models, log-normal interest rate models, Markov functional model\n\n1. Introduction. An important class of interest rate models used in financial\npractice is the class of short rate models [1, 15, 25, 7]. These models are Markovian,\nand the state of the model at time t is completely defined by the short rate r(t). As\na result all dynamical variables such as zero coupon bonds and rates at some time t\ndepend only on r(t). These models are simple and intuitive, but have the drawback\nthat the connection between the model parameters and market data is not always\ntransparent. For this reason they are usually not flexible enough in their calibration\nto market data.\nThis problem can be solved by the introduction of market models. One particular\ntype of these models are the Markov functional models, where the dynamical quantities of the model are functionals of a small number of Markov drivers xi (t). It has\nbeen shown in [14, 15, 1, 2] that by a judicious choice of the functional dependence\nof some dynamical variable of the model on the stochastic drivers xi (t), it is possible\nto reproduce exactly Black's formula or a given market caplet or swaption implied\nvolatility smile.\nWe consider in this paper a one-factor Markovian model in discrete time with\nlog-normally distributed rates in the terminal measure. Such a model is encountered\nin practice as a particular parametric realization of a Markov-functional model for\nsimulating an interest rate market with log-normal caplet smile, see e.g. [1]. Models\nof this type have been proposed in the literature as approximations to the Libor\nmarket model with log-normal caplet volatility [6, 19, 8]. For example, the Libor\nmarket model reduces to such a model in the frozen drift approximation (up to the\naddition of appropriate convexity multipliers) when considering only the terminal\ndistribution of the Libors at their setting time. See Sec. 2 for a detailed discussion.\nThe model with log-normally distributed rates in the terminal measure was studied in Ref. [26], where it was shown that it can be solved exactly for the timehomogeneous case of uniform volatility. Exact results can be found for the dependence\nof all zero coupon bonds on the Markovian driver. The more general case of a short\nrate model where the short rate is the exponential of a Gaussian Markov process was\nconsidered in [27]. The exact solution of the model was found to have discontinuous dependence on volatility. The main results can be summarized as follows: the\n\u2217 J.\n\nP. Morgan, 277 Park Avenue, New York, NY 10172, dpirjol@gmail.com\n1\n\n\f2\nmodel has two distinct regimes, at low and large volatility, respectively, with different\nqualitative properties. These regimes are separated by a sharp transition, occurring\nat a critical value of the volatility, which resembles a first order phase transition in\ncondensed matter physics. In particular certain convexity adjustments appearing in\nthe calibration of the model have non-analytic behavior as function of the volatility,\nmanifested as a discontinuous derivative at the critical point.\nIn this paper we consider the implications of these phenomena for the pricing\nof interest rates derivatives under such models, and point out that they limit their\nregion of applicability. We start by studying the distributional properties of the Libor\nprobability distribution function in a measure where it is simply related to caplet\nprices (the forward measure). It turns out that the shape of the Libor distribution\nfunction changes suddenly at the critical volatility, and becomes very concentrated at\nsmall values of the Libor rates in addition to developing a long tail. This is reflected in\nBlack caplet volatility, which undergoes a sudden change at the critical volatility, both\nin the ATM volatility and the shape of the caplet smile. While for subcritical volatility\nthe caplet smile is flat to a good approximation, and is equal to the Libor volatility,\nabove the critical volatility the ATM caplet implied volatility increases suddenly, and\na nontrivial caplet smile appears. In addition, the moments of the Libor probability\ndistribution function have non-analytic behavior in volatility and explosive behaviour.\nSection 2 introduces the model with log-normally distributed rates in the terminal\nmeasure which is considered in this paper, and provides some background on the\npractical relevance of such models. This section gives also a brief review of the main\nresults of [26], describing the method used to find the exact solution of the model,\nand the main features of the volatility dependence following from this solution. In\nSection 3 we study the properties of the Libor probability distribution function in the\nforward measure and its moments, and in Section 4 we consider in some detail the\npricing of a Libor payment in arrears, and show the presence of non-analyticity in\nprices of actual interest rate derivatives in this model. Section 5 gives a summary of\nthe main results, and a brief discussion of their implications.\n2. The model. We consider an interest rate model defined on a finite set of\ndates ti\n0 = t0 < t1 < * * * < tn .\n\n(2.1)\n\nTypically the dates ti are equally spaced, e.g. by 3 or 6 months apart, but we will\nkeep them completely general, and denote the difference between consecutive dates\nas \u03c4i \u2261 ti+1 \u2212 ti .\nThe fundamental dynamical quantities of the model are the zero coupon bonds\nPi,j \u2261 Pti ,tj . They are driven by a one-dimensional Markov process x(t), which will be\nassumed to be a simple Brownian motion under the terminal measure. The numeraire\nis Pt,tn , the zero coupon bond maturing at the last simulation time tn . Define the\nforward Libor rate Li (t) for the (ti , ti+1 ) period as\n\u0011\n1 \u0010 Pt,ti\n\u22121 .\n(2.2)\nLi (t) =\n\u03c4i Pt,ti+1\nThe model is defined by the functional dependence on x(t) of the Libor rates at\ntheir setting time Li \u2261 Li (ti ). Specifically, in the model considered here the Libors\nLi are assumed to be log-normally distributed in the terminal measure,\n\u0010\n\u0011\n1\nLi = L\u0303i exp \u03c8i xi \u2212 \u03c8i2 ti .\n(2.3)\n2\n\n\f3\nFor simplicity we will denote the value of the Markov driver at time ti as xi \u2261 x(ti ).\nIts mean and variance are E[xi ] = 0, E[x2i ] = ti . Here \u03c8i is the volatility of the Libor\nLi , and L\u0303i are parameters which will have be determined such that the initial yield\ncurve P0,i is correctly reproduced.\nThe original motivation for this work was the study of a Markov-functional model\nwith log-normal functional specification of the Libors at their setting time on the\nMarkovian driver, as given by (2.3). Such a specification is somewhat different from\nthe original philosophy behind the Markov-functional models [14, 15, 1, 2], which\naims to reproduce exactly Black's formula or model an appropriate market skew for\ncaplets or for swaptions with a judicious choice for the functional dependence Li (xi )\n(or equivalently the functional dependence of the numeraire Pt,tn (x)). See [18] for a\ndetailed discussion of a specific implementation.\nThe Markov-functional model is used in practice in parametric and non-parametric\nversions, according to the implementation of the functional dependence Li (xi ). The\nlog-normal parametric form considered here is one of the simplest possible, and was\nconsidered first in the original work on Markov functional models [14]. For another\ndiscussion of this model see Sec. 11.A.2 in [1]. Another parametric version is the\nso-called semi-parametric representation of Ref. [25]\n1\n\n\u22121\nPi,n\n(x) = 1 + ai ebi x + di e\u2212 2 ci (x\u2212mi )\n\n2\n\n(2.4)\n\nwhere ai , bi , ci , di , mi are numerical parameters to be fitted to the numerical solution.\nOf course, with a parametric representation the resulting model will not reproduce\nexactly the caplet or swaption implied volatility for all strikes, and the best one can\naim for is to match the implied volatility at one particular strike (for example the\nATM point), and possibly also for a region of neighboring strikes.\nModels with log-normal rates in the terminal measure appear also when considering approximations to the log-normal Libor market model (LMM) [6]. For a general\ncomparison of the LMM with separable Libor volatility and Markov-functional models in the one-dimensional case see [4]. Consider a model with log-normal caplet\nvolatilities \u03c8i and given initial yield curve P0,i implying forward Libors Lfwd\n=\ni\n1/\u03c4i (P0,i /P0,i+1 \u2212 1). A one-factor LMM realization of this model is specified by\nthe diffusion for the forward Libors Li (t) [6]\nn\u22121\nX \u03c4j \u03c8j2 Lj (t)\ndLi (t)\ndt\n= \u03c8i dx(t) \u2212\nLi (t)\n1 + Lj (t)\u03c4j\nj=i+1\n\n(2.5)\n\nwhere x(t) is a Brownian motion in the terminal measure. This model is usually\nsimulated using Monte-Carlo methods [1], but several analytical approximations have\nbeen proposed as well. The simplest approximation is the frozen drift approximation,\nwhere the forward Libors Lj (t) in the drift term are replaced with their forward\nvalues Lj (0) = Lfwd\nj . Then the evolution equation can be solved in closed form, and\nthe Libors at their setting time are log-normally distributed in the terminal measure\n\u0011\n\u0010\n1 2\nfwd\n(2.6)\n\u03c8\nt\n+\n\u03bc\nt\nLFD\n(t\n)\n=\nL\nexp\n\u03c8\nx\n\u2212\ni\ni i\ni\ni i\ni\ni\n2\nn\u22121\nX \u03c4j \u03c8j2 Lfwd\nj\n\u03bci = \u2212\n(2.7)\nfwd \u03c4\n1\n+\nL\nj\nj\nj=i+1\n\u03bci ti\n. This expression for L\u0303i agrees with\nThis has the form of (2.3) with L\u0303i = Lfwd\ni e\nthe small-volatility limit of the convexity-adjusted Libors L\u0303i derived in Eq. (27) of\n\n\f4\n[26]. For larger volatilities a convexity adjuster \u03bai must be added to the frozen drift\n\u03bci ti\nsuch that the yield curve P0,i is correctly reproduced.\napproximation L\u0303i = \u03bai Lfwd\ni e\nThe frozen drift approximation is expected to be valid only for very small volatility.\nImproved approximations to the Libor market model which are valid over a larger\nrange of volatilities, and which have log-normally distributed Libors in the terminal\nmeasure have been proposed in [19, 8].\nThis paper presents a study of the model defined by (2.3) with uniform volatility\nparameter1 \u03c8i = \u03c8, and investigates its properties as functions of the volatility parameter \u03c8. For sufficiently low volatility the model is found to generate a log-normal\ncaplet smile, with caplet volatility equal to \u03c8 to a very good approximation. In retrospect, this provides a justification for the choice of the functional form (2.3) for\ndescribing a model with log-normal caplet volatility. In other words, for sufficiently\nsmall caplet volatility, a model with log-normal caplet smile has also log-normally\ndistributed rates in the terminal measure to a very good approximation.\nAs the volatility parameter \u03c8 is increased, the ATM caplet volatility starts to\ndiverge from the model volatility parameter \u03c8, and a non-trivial caplet smile appears.\nThis change is not gradual, but rather occurs at a sharply defined value of the volatility\nparameter \u03c8cr , which we call the critical volatility. We will show that at the critical\nvolatility the ATM caplet volatility has a sudden increase, and the shape of the\nLibor probability distribution in its natural measure changes suddenly from a typical\nhumped shape to a function which is very concentrated near the origin.\nAbove the critical volatility, the dynamics predicted from the model are different\nfrom those intended (log-normal caplet smile), such that this phenomenon introduces\na limitation of the model, or more precisely of the choice (2.3) for the functional\ndependence of the Libor distribution. In the context of the Libor market model, our\nresults give a measure of the limit of validity of a log-normal approximation. In view\nof the practical use of this parameterization, it is important to understand its region\nof applicability.\n2.1. Analytical solution. We summarize here the derivation and main features\nof the analytical solution of the model [26]. The zero coupon bonds Pi,j (x) can be\nexpressed as functions of the one-dimensional Markov process x(t). We will denote the\nnumeraire-rebased zero coupon bond prices as P\u0302i,j = Pi,j /Pi,n . They are martingales\nin the terminal (tn -forward) measure, and thus satisfy the condition, see e.g. [3]\nP\u0302i,j = En\n\ni\nh 1\nFi\nPj,n\n\n(2.8)\n\nImposing the martingale condition (2.8) for all possible i, j pairs determines uniquely\nthe convexity-adjusted Libors L\u0303i , provided that the volatility parameters \u03c8i are\nknown. The latter are determined for example by calibration to the ATM caplet\nvolatilities, observed in the market.\nThis model can be solved analytically [26, 27]. For the case of uniform volatility\n\u03c8i = \u03c8 the solution can be expressed as an analytical expression for the one-step zero\n1 The restriction to the case of uniform \u03c8 is motivated by arguments of simplicity of the resulting\ni\nanalytical formulas. The general case of arbitrary \u03c8i can be also solved in closed form [27], but\nthe resulting expressions are unwieldy for numerical evaluation for n > 12, with n the number of\nsimulation times.\n\n\f5\ncoupon bonds P\u0302i,i+1\nP\u0302i,i+1 (xi ) =\n\nn\u2212i\u22121\nX\n\n(i)\n\n1\n\ncj ej\u03c8xi \u2212 2 (j\u03c8)\n\n2\n\nti\n\n(2.9)\n\nj=0\n\n(i)\n\nwith cj a set of constant coefficients to be determined. The convexity-adjusted Libors\nare given by\nL\u0303i =\n\nP\u03020,i \u2212 P\u03020,i+1\n,\nNi \u03c4i\n1\n\n(2.10)\n\nNi \u2261 E[P\u0302i,i+1 e\u03c8xi \u2212 2 \u03c8\n\n2\n\nti\n\n]=\n\nn\u2212i\u22121\nX\n\n(i)\n\ncj ej\u03c8\n\n2\n\nti\n\n.\n\nj=0\n\n(i)\n\nThe coefficients cj satisfy the recursion relation\n(i)\n\n(i+1)\n\ncj = cj\n\n(i+1)\n\n+ L\u0303i+1 \u03c4i+1 cj\u22121 e(j\u22121)\u03c8\n\n2\n\nti+1\n\n(2.11)\n\nwhich must be solved simultaneously with Eq. (2.10) for L\u0303i . The initial condition is\n(n\u22121)\nc0\n= 1, L\u0303n\u22121 \u03c4n\u22121 = P\u03020,n\u22121 \u2212 1. The recursion relation (2.11) can be solved backwards in time, for all i \u2264 n \u2212 1, finding all coefficients recursively. An explicit solution\n(i)\nof this recursion relation was found in [27], and cj has a physical interpretation as\nthe canonical partition function of a one-dimensional attractive Coulomb lattice gas\nwith j particles and n \u2212 i \u2212 1 sites. We will not make use of this solution here, and\n(i)\nprefer to evaluate the recursion relation (2.11) explicitly. The coefficients cj and the\nconvexity-adjusted Libors L\u0303i determine the solution of the model. The zero coupon\nbonds Pi,j can be found explicitly as functions of x = xi , as shown in Eq. (2.11).\nThe recursion relation (2.11) can be expressed more compactly by introducing\nthe generating function at the time horizon ti\nf (i) (x) \u2261\n\nn\u2212i\u22121\nX\n\n(i)\n\ncj xj\n\n(2.12)\n\nj=0\n\nThe generating function f (i) (x) takes known values at x = 0, 1\nf (i) (0) = 1 ,\n\nf (i) (1) = P\u03020,i+1\n\n(2.13)\n(i)\n\nwhere the second constraint follows from a sum rule for the coefficients cj [26]. The\ngenerating function satisfies the recursion relation\nf (i) (x) = f (i+1) (x) + L\u0303i+1 \u03c4 xf (i+1) (xe\u03c8\n\n2\n\nti+1\n\n)\n\n(2.14)\n\nwith initial condition f (n\u22121) (x) = 1. The expectation value Ni appearing in the\nexpression for the convexity-adjusted Libor L\u0303i is\nNi = f (i) (e\u03c8\n\n2\n\nti\n\n)\n\n(2.15)\n(i)\n\nThe generating function f (i) (x) and thus the coefficients cj can be found in\nclosed form in the two limiting cases of very small and very large volatility \u03c8 [26].\nThe zero volatility limit of the generating function is\n(i)\n\nn\u22121\nf0 (x) = \u03a0j=i+1\n(1 + Lfwd\nj \u03c4 x) .\n\n(2.16)\n\n\f6\nIn the asymptotically large volatility limit \u03c8 \u2192 \u221e, the recursion relation (2.14)\ncan be solved again exactly with the result\n(i)\nf\u221e\n(x) = 1 + (P\u03020,n\u22121 \u2212 1)x + * * * + (P\u03020,i+1 \u2212 P\u03020,i+2 )xn\u2212i\u22121 .\n\n(2.17)\n\nThe most distinctive feature of the model in the large volatility limit is an explosive\n2\nincrease of the expectation values Ni = f (i) (e\u03c8 ti ) with the volatility. This causes the\nconvexity-adjusted Libors L\u0303i to become very small. Their asymptotic expression in\nthe large volatility phase is [26]\nL\u0303i =\n\nP\u03020,i \u2212 P\u03020,i+1\n\n(P\u03020,i+1 \u2212 P\u03020,i+2 )\u03c4i\n\ne\u2212(n\u2212i\u22121)\u03c8\n\n2\n\nti\n\n(1 + O(e\u2212\u03c8\n\n2\n\nti\n\n)) .\n\n(2.18)\n\nIn practice L\u0303i can become very small, below machine precision, which can make an\nexact numerical simulation of the model very difficult in the large volatility regime.\n2.2. The Libor phase transition. The analytical solution of the model presented above can be used to study exactly its behavior as a function of the volatility\nparameter \u03c8. It turns out that this is not smooth for all quantities of the model.\nCertain expectation values, such as Ni given in (2.10), have a \u03c8 dependence which\nhas singular behavior at a special value of volatility which will be called the critical\nvolatility \u03c8cr . This is manifested as a sudden change in the derivative dNi /d\u03c8 at the\ncritical point, which becomes more sharp as the time step \u03c4 decreases, such that it\napproaches a nonanalyticity point in the continuous time limit [26]. At the critical\npoint the expectation value Ni has an explosive increase, which is much faster than\nin the low volatility phase.\nThe underlying reason for this phenomenon is a singularity in the generating\nfunction f (i) (x) at a certain value x\u2217 . This value is related to the position of the\nzeros of f (i) (x) in the complex plane. The generating function is a polynomial in x\nof degree n \u2212 i \u2212 1 with positive coefficients, and thus does not have any zeros on the\npositive real axis. It has n \u2212 i \u2212 1 zeros, which are arranged in complex conjugate\npairs symmetric with respect to the real axis, along a curve surrounding the origin.\nThe singularity point x\u2217 is the point on the positive real axis where the complex\nzeros pinch the real axis. At this point the derivative of the generating function has\na discontinuity which is proportional to the angular density of the zeros around the\npositive real axis. This density is of the order of n \u2212 i \u2212 1, the number of simulation\ntime steps to the maturity.\nThis phenomenon is similar to a first order phase transition in condensed matter physics, where the thermodynamical potentials have a discontinuity in the first\nderivative at the critical point [29]. The analogy becomes even closer in the Lee-Yang\nformalism of the phase transitions [20], where the critical point is associated with the\ncomplex zeros of the grand canonical partition function.\nIn the context of the Markov functional model with log-normally distributed rates,\nthe singularity in Ni occurs at the point \u03c8cr given by\n2\n\ne\u03c8cr ti = x\u2217 .\n\n(2.19)\n\nThis equation determines the critical volatility \u03c8cr . A similar phenomenon occurs for\nany expectation value of the form similar to Ni\n1\n\nEn [P\u0302i,i+1 e\u03c6x\u2212 2 \u03c6\n\n2\n\nti\n\n] = f (i) (e\u03c8\u03c6ti )\n\n(2.20)\n\n\f7\n\n\u03c8\n\n0.5\n\n0.5\n\n0.4\n\n0.4\ni=30\n\n0.3\n\n0.3\n\n\u03c8\n0.2\n\n0.2\n\ni=20\n\n0.1\n\n0.1\n\n0\n\n2\n\n4\n\n1/\u03c4\n\n0.01\n\n0.02\n\n16\n\n8\n\n0.03\n\n0.04\n\n0.05\n\n0.06\n\nr0\n\nFig. 2.1. Left: the critical volatility \u03c8cr of the log-normal interest rate model with constant\nforward short rate r0 = 5% for several discretizations with 1/\u03c4 = 2, 4, 8, 16 time steps per year.\nThe dots show the exact critical volatility, and the lines the results of the approximation (2.22).\nBlue: Libor rate set at ti = 5, red: Libor rate set at ti = 7.5. Right: the dependence of the critical\nvolatility \u03c8cr (r0 ) on the short rate in a simulation with quarterly time steps \u03c4 = 0.25. The red\ncurves correspond to the Libor rate set at ti = 7.5 and the blue curves to the Libor rate set at ti = 5.\nThe solid lines are exact phase boundaries, while the dashed lines correspond to the approximative\nresult Eq. (2.22). Total simulation time is tn = 10 years.\n\nwhich can be expressed in terms of the generating function f (i) (x) as shown. The critical volatility corresponding to this expectation value is found in analogy to Eq. (2.19)\nand is given by exp(\u03c8\u03c6ti ) = x\u2217 .\nThe precise value of the critical volatility depends on the time step i, and on\nthe entire shape of the yield curve P0,i . Consider for illustration the case of a constant short rate r0 , which corresponds to the discount bonds P0,i = exp(\u2212r0 \u03c4 i). A\nsimple estimate of the critical volatility can be obtained from the zeros of the asymp(i)\ntotic generating function f\u221e (x), corresponding to very large volatility [26]. Using an\napproximation for the position of these zeros one finds\n2\n\ner0 \u03c4 +\u03c8cr ti =\n\n\u0010\n\n\u00111/(n\u2212i\u22121)\n1\n1 \u2212 e\u2212r0 \u03c4\n\n(2.21)\n\nwhich can be approximated, to a good precision, as\n2\n\u03c8cr\n=\n\n\u0010 1 \u0011\n1\n.\nlog\ni(n \u2212 i \u2212 1)\u03c4\nr0 \u03c4\n\n(2.22)\n\nThe relation (2.22) reproduces the main features of the critical volatility observed\nin numerical simulations:\n\u2022 The critical volatility decreases as the size of the time step \u03c4 is reduced,\napproaching zero in the continuous time limit.\n\u2022 The critical volatility increases as the short rate r0 is reduced, approaching a\nvery large volatility as the rate r0 becomes very small.\nThis behavior is illustrated in Fig. 2.1. These plots show the critical volatility\n\u03c8cr of the model with flat forward short rate r0 as function of \u03c4 at fixed r0 (left\npanel), and as function of r0 at fixed time step \u03c4 (right panel). In these plots we show\nboth the exact critical volatility (dots/solid lines), which can be found as the value of\n\u03c8 at which \u2202\u03c82 log Ni is maximal, and the result of the simple approximation (2.22)\n(lines/dashed lines). These plots show that the approximation (2.22) underestimates\nthe actual value of the critical volatility by about 10%.\n\n\f8\n3. The Libor probability distribution function. By the model definition\n(2.3), the Libor rates Li are log-normally distributed in the tn -forward measure (the\nterminal measure). A more natural measure for pricing instruments depending on\nthe Libor rate Li is the ti+1 -forward measure (or simply the forward measure), with\nnumeraire the zero-coupon bond Pt,i+1 , maturing at time ti+1 . We will consider the\ntwo measures\nPn :\nPi+1 :\n\nnumeraire Pt,n\nnumeraire Pt,i+1\n\n(3.1)\n(3.2)\n\n\u22121\nAs a concrete example, consider a caplet Ci (K) on the Libor rate Li = \u03c4i\u22121 (Pi,i+1\n\u2212\n1), set at time ti and paid at time ti+1 , with strike K. The payoff of this instrument\nis (Li \u2212 K)+ , and its price is given as an expectation value in the tn -forward measure\nPn\n\nCi (K) = P0,n En [(Li \u2212 K)+ P\u0302i,i+1 ] .\n\n(3.3)\n\nExpressed in the forward Pi+1 measure, the expression for the caplet price Ci (K)\nsimplifies and is given by\nCi (K) = P0,i+1 Ei+1 [(Li \u2212 K)+ ]\n\n(3.4)\n\nThe expectation value in Pi+1 measure can be expressed as an integral of the payoff\nconvoluted with the probability distribution function of the Libor Li in this measure.\nWe will denote this distribution \u03a6i (Li ), and we have\nZ \u221e\nEi+1 [(Li \u2212 K)+ ] =\ndLi \u03a6i (Li )(Li \u2212 K)+\n(3.5)\n0\n\nIn the following we will study in some detail the distribution function \u03a6i (x), and\nits properties. The pdf of the Libor Li in the Pi+1 measure can be obtained by\ncomparing Eqs. (3.3) and (3.4). It is given by\n\u03a6i (L) =\n\n2\n\n1\nP\u03020,i+1\n\ne\u2212x0 /(2ti ) 1\n\u221a\nP\u0302i,i+1 (x0 )\n2\u03c0ti \u03c8L\n\n(3.6)\n\nwith x0 = x0 (L) determined as\nx0 =\n\n1\nL\n1\n+ \u03c8ti .\nlog\n\u03c8\nL\u0303i 2\n\n(3.7)\n\nWe would like to study how the Libor probability distribution function \u03a6i (L)\nchanges as the volatility \u03c8 is increased from zero to large values. At zero volatility\n\u03c8 = 0, this distribution is a delta function concentrated at the forward value\n\u03a6i (L, \u03c8 = 0) = \u03b4(L \u2212 Lfwd\ni )\n\n(3.8)\n\nAs the volatility increases, the distribution widens out. We show in Fig. 3.1 the shape\nof the distribution \u03a6i (L) for several values of the volatility \u03c8. For moderate values\nof \u03c8, below the critical volatility \u03c8cr , the distribution has a typical humped shape,\npeaked around the forward value Lfwd\ni .\nAbove the critical volatility \u03c8 > \u03c8cr the probability distribution function \u03a6i (L)\nundergoes a dramatic change: its support appears to collapse very rapidly to very\n\n\f9\n70\n\u03c8 = 0.35\n\n60\n\n\u03c8 = 0.05\n\n50\n40\n30\n\u03c8 = 0.1\n\n20\n\n\u03c8 = 0.2\n\n10\n0\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n\n0.1\n\nL\n\nFig. 3.1. The probability distribution function \u03a6i (L) for the Libor Li in the measure Pi+1 for\nseveral values of the volatility \u03c8. The plots correspond to a constant forward short rate r0 = 5%,\nwhich gives Lfwd\n= 5.0314%. The remaining parameters are i = 30, n = 40, \u03c4 = 0.25.\ni\n\nsmall values of L, see Fig. 3.1. The \"collapse\" of the support of the Libor distribution\n\u03a6i (L) to very small values close to zero is another surprising phenomenon in the\nhigh-volatility phase of this model.\nNaively, one may ascribe this phenomenon to the fact that the convexity-adjusted\nLibors L\u0303i in the defining equation of the model (2.3) become very small in the large\nvolatility phase. Upon further reflection the situation is slightly more complicated,\nfor two reasons. First, the log-normal distribution (2.3) is in the terminal measure Pn ,\nwhile we are interested here in the probability distribution function in Pi+1 measure.\nSecond, the martingale condition for Li (t) in Pi+1 measure requires that the average\nof Li (ti ) should be equal to its forward value Ei+1 [Li ] = Lfwd\ni , which would not be\npossible if the distribution were concentrated near Li = 0. The only way for the\nmartingale condition to be satisfied is that the distribution has a long fat tail, which\ncontributes significantly to the average of Li .\nIn the following we would like to explore this phenomenon in more detail. The\nanalysis presented next will confirm the heuristic arguments mentioned above. We\nstart by showing that the probability distribution function \u03a6i (L) can be represented\nas a sum of log-normal distributions. Define the log-normal distribution with average\nparameter \u03bc and dispersion \u03c3\n2\n1\n1\ne\u2212 2\u03c32 (log x\u2212\u03bc)\n\u03c6(x; \u03bc, \u03c3) = \u221a\nx 2\u03c0\u03c3\n\n(3.9)\n\nThe j-th moment of the x variable under the distribution \u03c6(x; \u03bc, \u03c3) is\n1 2\n\nE[xj ] = ej\u03bc+ 2 j\n\n\u03c32\n\n(3.10)\n\nThe probability distribution function of the Li Libor in the Pi+1 measure (3.6)\ncan be represented as a sum of log-normal distributions with different averages but\nthe same variance\n\u03a6i (L) =\n\n1\nP\u03020,i+1\n\nn\u2212i\u22121\nX\n\n\u221a\n(i)\n(i)\ncj \u03c6(L; \u03bcj , \u03c3i = \u03c8 ti )\n\n(3.11)\n\nj=0\n\nwhere\n\u0010\n\u0011\n2\n1\n(i)\n\u03bcj = log L\u0303i e(j\u2212 2 )\u03c8 ti .\n\n(3.12)\n\n\f10\n\u221a\n(i)\nThe average value of L under the log-normal distribution \u03c6(L; \u03bcj , \u03c3i = \u03c8 ti ) is\n(i)\n\nE[L|\u03c6(L; \u03bcj , \u03c3i )] = L\u0303i ej\u03c8\n\n2\n\nti\n\n(3.13)\n\nso each of these log-normal distributions are peaked at successively higher values\nof L. Specifically, the pdf of the Libor (3.11) consists of a sum of log-normal dis2\n2\n(i)\ntributions with averages L\u0303i , L\u0303i e\u03c8 ti , * * * , L\u0303i e(n\u2212i\u22121)\u03c8 ti , and weights ck /P\u03020,i+1 with\nk = 0, 1, * * * , n \u2212 i \u2212 1. We recall that the weights add up to 1 due to the exact sum\nPn\u2212i\u22121 (i)\nrule j=0 cj = P\u03020,i+1 .\n(i)\n\nThe weights cj /P\u03020,i+1 of the terms with j > 1 decrease sufficiently fast with j,\nsuch that the total average of L is equal to the forward Libor rate, as required by the\nmartingale condition for Li in the Pi+1 measure\nEi+1 [L] =\n\n=\n\n1\nP\u03020,i+1\n1\nP\u03020,i+1\n\nn\u2212i\u22121\nX\n\ncj E[L|\u03c6(L; \u03bcj , \u03c3i )]\n\nn\u2212i\u22121\nX\n\ncj L\u0303i ej\u03c8\n\n(i)\n\n(i)\n\n(3.14)\n\nj=0\n\n(i)\n\n2\n\nti\n\n= Lfwd\n.\ni\n\nj=0\n\nThe representation (3.11) of the distribution function can be used to obtain a\nqualitative understanding of the behavior of this function in the large volatility limit\n\u03c8 2 ti \u226b 1. In this limit the asymptotic behavior of the convexity adjusted Libors\nL\u0303i is given by (2.18). In the large volatility regime, the convexity adjusted Libors\ndecrease very rapidly with the volatility \u03c8. This means that most of the log-normal\ncomponents of the distribution function \u03a6i (L) have vanishingly small averages, except\nfor the last one with the largest index j = n \u2212 i \u2212 1\n(i)\n\ne\u2212(n\u2212i\u22121\u2212j)\u03c8\nE[L|\u03c6(L; \u03bcj , \u03c3i )] = Lmax\ni\n\n2\n\nti\n\n,\n\n(3.15)\n\nwhere\nLmax\n=\ni\n\nP\u03020,i \u2212 P\u03020,i+1\n\n(P\u03020,i+1 \u2212 P\u03020,i+2 )\u03c4i\n\n= Lfwd\ni\n\n1 + Lfwd\ni+1 \u03c4i+1\n.\nLfwd\ni+1 \u03c4i+1\n\n(3.16)\n\nFor typical values of model parameters, such as Lfwd = 5%, \u03c4 = 0.25, one has Lmax \u223c\n500% which is a very large value compared to typical rates.\n(i)\nIn the large volatility regime the coefficients cj are all comparable, such that the\nshape of the probability distribution function \u03a6i (L) is expected to be very concentrated near L = 0, corresponding to the terms with j = 0, 1, * * * , n \u2212 i \u2212 2, and to\nhave a fat tail extending to very large values of L \u223c Lmax , corresponding to the term\nwith j = n \u2212 i \u2212 1. This is confirmed by direct calculation of the distribution function\nin the large volatility limit, as observed in Fig. 3.1.\nThe behavior of the Libor probability distribution function in the Pi+1 measure\nin the large volatility limit is related to a numerical issue discussed in [26], which is\nresponsible for the unobservability of the phase transition in usual simulation methods\nsuch as Monte Carlo or finite difference methods. This numerical issue appears in the\ncalculation of the expectation value (2.10) as an integral\nZ \u221e\nx2\n1 2\ndx \u2212 2t\n\u03c8x\u2212 21 \u03c8 2 ti\n\u221a\ne i P\u0302i,i+1 (x)e\u03c8x\u2212 2 \u03c8 ti .\n]=\n(3.17)\nNi = E[P\u0302i,i+1 e\n2\u03c0ti\n\u2212\u221e\n\n\f11\nAt volatilities above the critical value \u03c8 > \u03c8cr the integrand\n\u221a in this expression develops\na secondary peak at a relatively large value of |x| \u223c 10 ti , in addition to the peak\naround x \u223c 0, see Fig. 4 in [26]. The secondary peak gives the dominant contribution\nto the integral in the large volatility limit. However, the region of large x where\nit appears is either very poorly sampled, or completely ignored in usual simulation\nmethods, which thus will fail to take it into account.\nThe dominance of the integral by the secondary peak in the super-critical regime\ncan be understood by changing variables in the integral (3.17) from x to Li , the Libor\nrate. We observe that the integrand of (3.17) is simply related to the Libor probability\ndistribution function \u03a6i (L) in the Pi+1 measure, when expressed in terms of x = x(L)\ngiven in Eq. (3.7). The integral in (3.17) becomes, after changing the integration\nvariable from x to L\nZ \u221e\nL\nNi = P\u03020,i+1\ndL\u03a6i (L) .\n(3.18)\nL\u0303i\n0\nThe secondary peak in the integrand of (3.17) becomes the fat tail of \u03a6i (L), while\nthe peak near x \u223c 0 corresponds to the region of L \u223c L\u0303i . As discussed above, the\nfat tail of \u03a6i (L) is essential in order for the integral above to reproduce correctly its\nnon-arbitrage value; the counterpart of this statement in the x\u2212integral (3.17) is that\nthe secondary peak is also required by the consistency of the model, and can not be\nneglected.\n3.1. The moments of the Libor pdf. In this section we consider the moments\nof the Libor probability distribution function \u03a6i (L) in the forward Pi+1 measure. We\nwill show that its moments, and thus its characteristic function\nZ \u221e\n\u221e\nX\n(iu)j\nEi+1 [Lji ]\n(3.19)\ndLeiuL \u03a6i (L) =\n\u03a6\u0303i (u) =\nj!\n\u2212\u221e\nj=0\ncan be expressed in terms of the generating function f (i) (x).\nThe moments of \u03a6i (L) can be computed using Eq. (3.11). The integral can be\nperformed straightforwardly by changing the integration variable from L to x. The\nresult expresses the j\u2212th moment of the Libor distribution in the forward measure in\nterms of the generating function f (i) (x) as\nZ \u221e\n2\n2\n1\n1\nj\nL\u0303ji e 2 j(j\u22121)\u03c8 ti f (i) (ej\u03c8 ti ) .(3.20)\nMj = Ei+1 [Li ] =\ndLi (Li )j \u03a6i (Li ) =\nP\u03020,i+1\n0\nWe consider a few particular cases of the relation Eq. (3.20). The first two moments j = 0, 1 do not contain dynamical information, and are constrained by general\nconsiderations as follows. The j = 0 moment is the normalization integral, and is\nindeed equal to 1 by the condition (2.13)\nM0 =\n\n1\nP\u03020,i+1\n\nf (i) (1) = 1 .\n\n(3.21)\n\nThe first moment can be found again in closed form, and is equal to the forward Libor\nrate Lfwd\ni , as expected\nM1 =\n\n1\nP\u03020,i+1\n\nL\u0303i f (i) (e\u03c8\n\n2\n\nti\n\n)=\n\nP\u03020,i \u2212 P\u03020,i+1\nP\u03020,i+1 \u03c4i\n\n= Lfwd\n.\ni\n\n(3.22)\n\n\f12\nThis expresses the martingale condition for Li in the Pi+1 measure.\nMore interesting is the result for the second moment M2 . This determines the\nequivalent lognormal volatility of the Libor rate Li as\n2\n\u03c3LN\nti = log\n\n\u0010M \u0011\n2\nM12\n\n2\n\u0010\n2\nf (i) (e2\u03c8 ti ) \u0011\n= log P\u03020,i+1 e\u03c8 ti (i) \u03c82 t 2\n[f (e i )]\n\n(3.23)\n\nIn the small volatility limit \u03c8 2 ti \u226a 1 the ratio of generating functions can be computed\nusing the approximative formula (2.16). This gives\n2\n\u03c3LN\n= \u03c8 2 (1 + O(\u03c8 2 ti )) .\n\n(3.24)\n\nThis means that in the small volatility limit the caplet log-normal volatilities are\napproximately equal to \u03c8. This is useful for the calibration of the model, as the \u03c8i\nvolatilities can be read off directly from ATM caplet volatilities.\nWhen considered as a function of the volatility \u03c8, the moments Mj , j \u2265 2 of the\nLibor probability distribution function \u03a6i (L) have non-analytic dependence on \u03c8 at\n(j)\na value of the volatility \u03c8cr given by the solution to the equation\nx\u2217 (\u03c8) = ej\u03c8\n\n2\n\nti\n\n(3.25)\n\nwhere x\u2217 (\u03c8) is the non-analyticity point of the generating function f (i) (x) at time\nhorizon ti . This is the point on the real positive axis where the complex zeros of the\ngenerating function f (i) (x) pinch the real axis. In general the position of the nonanalyticity point x\u2217 (\u03c8) depends on the volatility parameter \u03c8, although it approaches\na well-defined value in the very large volatility limit \u03c8 \u2192 \u221e, when the generating\n(i)\nfunction approaches the asymptotic expression f\u221e (x) given in Eq. (2.17). The zeros\n(i)\nand the non-analyticity point of the polynomial f\u221e (x) have been studied in detail in\n[26] for the case of a constant forward short rate. As discussed above, approximating\n(i)\nthe generating function with its asymptotic expression f\u221e (x) leads to the result (2.21)\nfor the critical volatility.\nAssuming that x\u2217 (\u03c8) is independent on \u03c8 (as is the case for asymptotically large\nvolatility), from (3.25) it follows that the critical volatilities of the moments of the\nLibor distribution function are related as\n\u03c8cr\n(j)\n\u03c8cr\n= \u221a ,\nj\n\n\u03c8\u2192\u221e\n\n(3.26)\n\nHowever, in reality the non-analyticity point occurs at moderate values of the volatility\n\u03c8, for which x\u2217 has a pronounced dependence on \u03c8. This implies that the simple\nrelation (3.26) is badly violated in practice.\nWe illustrate the non-analyticity in volatility of the moments Mj on the example\nof the second moment M2 . This is the most important moment from a practical point\nof view, as it determines the Black log-normal caplet volatility according to Eq. (3.23).\nIn Figure 3.3 we show a plot of the equivalent Black caplet volatility \u03c3LN as a function\nof \u03c8 (red curve) at the time horizon i = 30 in a simulation with n = 40 quarterly\ntime steps.\nThe equivalent log-normal volatility \u03c3LN has two turning points, at \u03c8 around\n0.3 and at 0.33. The critical point at the time horizon considered here is \u03c8cr = 0.33,\nwhich corresponds to the second point. In order to understand the first turning point,\nwe show in the Appendix the zeros of the generating function f (i) (x) together with\n\n\f13\n2\n\n2\n\ntwo circles of radius e\u03c8 ti and e2\u03c8 ti . From these plots one can see that the first\n2\nturning point coincides with the zeros crossing the larger circle of radius e2\u03c8 ti , and\nthe second turning point corresponds to the volatility \u03c8 at which the zeros cross the\n2\nsmaller circle, of radius e\u03c8 ti . Since the position of the zeros changes with \u03c8, the first\n(2)\nturning point (the critical volatility of the second moment M2 ) \u03c8cr\n\u221a = 0.3 differs from\nthe large volatility limit prediction following from Eq. (3.26) \u03c8cr / 2 \u2243 0.23, obtained\nby assuming stationary zeros. This illustrates the comment made above about the\nlimited validity of Eq. (3.26).\nOnly the first few moments have non-analyticity points. The reason for this is\nthat at very low volatilities \u03c8, the zeros of the generating function do not surround\ncompletely the origin, but a gap remains between the real axis and the zeros. As\nthe volatility increases, the zeros move closer to the origin, and close together onto\nthe real axis. However, at this point they have crossed already the circles of radii\n2\nej\u03c8 ti , with j > j0 such that the moments Mj do not have a non-analyticity point for\nsufficiently large j > j0 . In other words, the equation (3.25) does not have a solution\nfor sufficiently large index j. The maximal index j0 of the moment of the Libor pdf\nLi which still has a phase transition depends on the time horizon ti considered.\nThe price of an instrument which is sensitive to the j\u2212th moment will have a nonanalyticity point at the corresponding value of the volatility. For the second moment\nthis is the case for example with the Libor payment in arrears, discussed in the next\nsection.\n3.2. Caplet pricing and Black caplet volatility. A closed form expression\nfor the caplet price can be found by direct evaluation of the expectation value in (3.3)\nCi (K) = P0,n\n\nn\u2212i\u22121\nX\nj=0\n\n(i)\n\ncj [L\u0303i ej\u03c8\n\n2\n\nti\n\nN (f1 ) \u2212 KN (f2 )]\n\n(3.27)\n\nwith\n1\nf1 = \u2212 \u221a [x0 (K) \u2212 (j + 1)\u03c8ti ]\nti\n1\nf2 = \u2212 \u221a [x0 (K) \u2212 j\u03c8ti ]\nti\n1\n1\nK\nx0 (K) = log\n+ \u03c8ti .\n\u03c8\nL\u0303i 2\n\n(3.28)\n(3.29)\n(3.30)\n\nThis has the typical form of a mixing solution [21, 22] for an option price on an asset\nwith a probability distribution consisting of a superposition of log-normal distributions.\nFigure 3.2 shows typical results for the Black (log-normal) caplet volatility \u03c3BS (K)\nfor several values of the volatility \u03c8, obtained from the exact formula (3.27). At\nlow values of \u03c8 the Black volatility is independent of strike, which means that the\ndistribution \u03a6i (L) is aproximatively log-normal. In Figure 3.3 we show a plot of the\nexact ATM Black caplet volatility for ATM strike K = 5%. From this plot one can\nsee that, for small \u03c8, the ATM caplet volatility is to a very good approximation equal\nto \u03c8. This agrees with the prediction (3.23), and confirms that for sufficiently small\nvolatility, the Libor volatility parameter \u03c8 is equal to a very good approximation with\nthe caplet volatility. At larger values of \u03c8 above the critical volatility \u03c8cr = 0.33, the\nsmile is not flat, which signals deviations from a log-normal distribution for \u03a6i (L).\n\n\f14\n1.4\n\n\u03c8= 0.35\n\n1.2\n\u03c8= 0.34\n\n1\n0.8\n0.6\n0.4\n0.2\n0.01\n\n0.02\n\n0.03\n\n0.04\n\n\u03c8= 0.3\n\u03c8= 0.2\n\u03c8= 0.1\n0.05\n0.06\n\n\u039a\n\nFig. 3.2. Implied caplet volatility smile \u03c3BS (K) for several values of the volatility \u03c8, as function\nof the strike K. The caplet is defined on the rate L30 in a simulation with n = 40 time steps, \u03c4 = 0.25\nand constant forward short rate r0 = 5%. The forward Libor is Lfwd\n= 5.0%.\ni\n\nIn Figure 3.3 we show also the ATM equivalent Black caplet volatility \u03c3LN given\nby Eq. (3.23) (red curve), comparing it with the exact ATM caplet volatility \u03c3BS\n(black curve). The critical volatility corresponding to the caplet shown in this plot is\n\u03c8cr = 0.33. We observe that the exact and approximative volatilities agree with each\nother for small \u03c8, where they satisfy very well the approximative equality relation\n(3.24). This region is the intended region of applicability of the model.\nAs the volatility \u03c8 is increased, a sharp turn in the equivalent volatility \u03c3LN occurs\n(2)\nat \u03c8cr \u223c 0.3, which corresponds to the critical volatility of the second moment of\nthe Libor distribution function, as explained above. The second turn point is at\n\u03c8cr = 0.33 which is the critical volatility of the model at the maturity ti considered.\nIt is interesting that for \u03c8 > \u03c8cr the equivalent log-normal volatility decreases as the\nmodel volatility \u03c8 increases.\nThe exact ATM caplet volatility has a first turning point which is closer to the\ncritical volatility \u03c8cr = 0.33. It starts to diverge from the equivalent log-normal\nvolatility \u03c3LN at a lower volatility \u03c8 \u223c 0.3, which thus is the point where the shape of\nthe Libor distribution function starts to deviate appreciably from a log-normal shape.\nThe fast increase in the ATM caplet volatility above the critical volatility is explained\nby the appearance of the long tail of the Libor distribution function \u03a6i (L) extending\nto very large values of L. This gives a large contribution to the caplet price, which is\ngiven by a simple integral over \u03a6i (L)\nZ \u221e\nCi (K) = P0,i+1\ndL(L \u2212 K)+ \u03a6i (L) .\n(3.31)\n0\n\nWe remarked above on the numerical importance of the tail of the \u03a6i (L) distribution\nin relation to the integral (3.18), where it is needed in order for this integral to\nreproduce its non-arbitrage value. Based on the same argument, one expects that\nthe tail of this distribution will contribute significantly also to the caplet price Ci (K)\nabove the critical point.\n4. Libor payment in arrears. We consider in this section the pricing of a\nLibor payment in arrears in the model with log-normally distributed rates in the\nterminal measure. We derive the convexity adjustment, and compare it with the\nknown convexity adjustment in the model with log-normal caplet volatility. It will be\n\n\f15\n1.5\n\n\u03c3BS\n\n1\n\n\u03c3 LN\n\n0.5\n\n0\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n\u03c8\nFig. 3.3. The exact ATM caplet volatility \u03c3BS (black), and the equivalent log-normal caplet\nvolatility \u03c3LN computed using (3.23) (red), as functions of the volatility parameter \u03c8. The caplet\nstrike is K = 5%, the forward Libor is Lfwd = 5.0%, corresponding to a constant forward short rate\nr0 = 5%. The remaining model parameters are i = 30, n = 40, \u03c4 = 0.25.\n\nseen that the convexity adjustment in the model with log-normally distributed rates\nin the terminal measure has a phase transition at two values of the Libor volatility,\nin contrast to the latter, which is perfectly well-behaved as function of the caplet\nvolatility.\nThe Libor payment in arrears pays the amount Li \u03c4i at time ti , where Li is the\nLibor rate for the (ti , ti+1 ) period, set at ti . The price of this instrument in the\nterminal measure is\n\u22121\nAi = P0,n En [Li (xi )\u03c4i Pi,n\n(xi )] = P0,n En [Li (xi )\u03c4i P\u0302i,i+1 (xi )(1 + Li (xi )\u03c4i )] . (4.1)\n\nThe first term, linear in Li , is known exactly from the pricing of a forward rate\nagreement\nEn [Li (xi )\u03c4i P\u0302i,i+1 (xi )] = P\u03020,i \u2212 P\u03020,i+1 = P0,i+1 (Lfwd\ni \u03c4i ) .\n\n(4.2)\n\nThe only non-trivial part is the pricing of the term quadratic in Li , which can be\nexpressed in terms of the generating function\nEn [L2i (xi )P\u0302i,i+1 (xi )] = L\u03032i e\u03c8\n\n2\n\nti (i)\n\n(e2\u03c8\n\n2\n\nti\n\n)\n\n(4.3)\n\n1\nP\u03020,i \u2212 P\u03020,i+1\n= P\u03020,i+1 Lfwd\ni\nf (i) (e\u03c82 ti )\u03c4i\nf (i) (e\u03c82 ti )\n\n(4.4)\n\nf\n\nRecall that the convexity-adjusted Libor is given by\nL\u0303i =\n\nCombining all the pieces together we get for the price of a Libor payment in arrears\nAi\nP0,i+1\n\n2\n\n=\n\n(Lfwd\ni \u03c4i )\n\n+\n\n2 \u03c8 2 ti\nP\u03020,i+1 (Lfwd\ni \u03c4i ) e\n\nf (i) (e2\u03c8 ti )\n.\n[f (i) (e\u03c82 ti )]2\n\n(4.5)\n\nThe second term is the convexity adjustment, and can be expressed in terms of the\nequivalent log-normal volatility \u03c3LN introduced above in (3.23). We obtain the following result for the price of a Libor payment in arrears in the model with log-normally\ndistributed Libors in the terminal measure\nn\no\n2\nfwd\n\u03c3LN\nti\nAi = P0,i+1 (Lfwd\n.\n(4.6)\ni \u03c4i ) 1 + (Li \u03c4i )e\n\n\f16\nThis can be compared with the exact result for the price of a Libor payment in\narrears in a model with exact log-normal caplet volatility \u03c8 for the Libor Li\no\nn\nfwd\n\u03c8 2 ti\n(4.7)\nAi = P0,i+1 (Lfwd\n\u03c4\n)\n1\n+\n(L\n\u03c4\n)e\ni\ni\ni\ni\nThis model has a log-normal Libor distribution function in the measure Pi+1 . The\nresult (4.7) is identical with the price in the model with log-normal Libor in the\nterminal measure Pn (4.6), up to the replacement \u03c3LN \u2192 \u03c8.\nAt low volatility \u03c8, the equivalent volatility \u03c3LN is approximatively equal to \u03c8,\nsee Eq. (3.24). For larger volatility \u03c8 it has a more complex behavior as discussed in\n(2)\nSec. 3.1, including two non-analyticity points at \u03c8cr and \u03c8cr , as observed in Fig. 3.3.\nThis means that the price of this instrument has the same non-analytical behavior in\n\u03c8 as \u03c3LN (\u03c8).\nSimilar non-analyticity effects can be expected to appear in the pricing of other\ninterest rates derivatives, and are introduced either through non-analytic behavior in\nthe convexity-adjusted Libors L\u0303i , or through the moments of the Libor distribution\nfunction in the forward measure Pi+1 . Thus non-analyticity effects appear to be a\ngeneric feature of models with log-normally distributed rates in the terminal measure.\n5. Conclusions. We considered in this paper the dynamics of an interest rate\nmodel with log-normally distributed rates in the terminal measure. Such models\nare used in financial practice as particular parametric realizations of the Markov\nfunctional model, and as approximations to models with log-normal caplet smile,\nsuch as the log-normal Libor market model. Using the exact solution of the model we\nstudied the dependence on volatility of the distributional properties of the dynamical\nquantities of the model and their implications for pricing interest rate derivatives. The\nmain result of the study is the existence of a previously unobserved sharp transition\nat a critical value of the volatility. Above the critical volatility certain expectation\nvalues and convexity adjustments have an explosive growth. The values of the critical\nvolatility in simulations with 10-30y and interest rates around 5% are comparable with\nactual log-normal caplet volatilities observed in the market, such that the existence of\nthis phase transition is of practical relevance, and imposes a limit on the applicability\nof the model.\nIt has been long known that models with log-normally distributed rates suffer from\nsingular behavior. This was observed in [12, 28] in the context of the Dothan model,\nand of the Black-Karasinski model. However, the phenomenon discussed here appears\nto be different in several respects: first, the singularity discussed in [12, 28] was shown\nto appear for a continuous time model, while the model considered here is defined\nin discrete time. Second, the transition discussed here appears at a well-defined\nfinite value of the volatility, while the divergence studied in [12, 28] is independent of\nvolatility.\nThe results of this paper show that at low volatilities a log-normal caplet smile\ncan be well reproduced by assuming Libor log-normality in the terminal measure;\nhowever at larger volatility this property is not preserved, and a non-trivial cap smile\nis generated. These results spell out the limits of applicability of the log-normal\nparameterization (2.3) for describing an interest rate market with log-normal caplet\nsmile. Such models can be applied only for sufficiently low caplet volatility, below the\ncritical volatility.\nThe underlying reason for this limitation is a change in the shape of the probability\ndistribution function of the Libor rates in their forward measure around the critical\n\n\f17\nvolatility. For small volatility the Libor pdf has a typical humped shape, centered\naround the forward Libor value. However, at the critical volatility this pdf changes\nsuddenly, and it collapses to small Libor values, in addition to developing a long tail.\nFurthermore, the moments of this probability distribution function have also sharp\ntransitions as functions of volatility.\nThese phenomena have implications for interest rate derivative pricing under the\ngiven model, and we considered as concrete examples caplets on Libor rates and Libor\npayments in arrears. The caplet prices, the Black caplet volatilities, and the convexity\nadjustment for Libor payments in arrears display also sharp transitions as functions\nof the model volatility. Based on these examples, it is plausible to expect that this\nphenomenon occurs also for other interest rate derivatives, and is a general feature of\nthe interest rates models with log-normally distributed rates in the terminal measure.\nThe effects discussed in this paper are due to a contributions to the expectation\nvalues from a region in the state variable (Markovian driver) which is usually assumed\nto be unimportant in practice, as it is associated with very large interest rates \u223c 100%.\nThis region is usually truncated off in tree and finite difference simulations, or is very\npoorly sampled in Monte Carlo simulations, unless extremely high numbers of paths\nare used. This implies that usual numerical implementations of this model do not\ncapture correctly the behavior of the model in the large volatility phase, and thus\nthe phase transition is not visible under these simulation methods. In practice one\ncan take the view that the implementation version of the model with its built-in\nlimitations (e.g. limits on the range of the Markovian driver x(t)) is the model. This\ncorresponds to a truncation of the original model, and the numerical consistency of\nthis truncation must be carefully verified.\nThe arguments of this paper are limited to the time-homogeneous setting of a\nuniform volatility, but it is plausible that a similar phenomenon will occur also in the\npractically relevant but analytically more complex case of time-dependent volatility\n\u03c8i . This is confirmed by the study of a related model in [27], where the stochastic\ndriver x(t) is replaced with an Ornstein-Uhlenbeck process. This corresponds to\nthe Black-Karasinski model in the terminal measure, with mean reversion and term\nstructure of caplet volatilities. The exact solution of this model obtained in [27] shows\nthe presence of a similar phase transition in volatility in the convexity adjustments\nof the model. Finally, it would be interesting to investigate whether some of these\nresults persist also in a model with exact log-normal caplet volatility, such as the exact\nMarkov functional model [2, 14] or the Libor market model [6]. This is plausible in\nview of the result obtained in [10], according to which the Libor distribution function\nin the terminal measure in the LMM has log-normal tails, which is similar to the\ndistributional property (2.3) of the model considered here.\nAcknowledgements. I am grateful to Emanuel Derman and the participants\nat the Columbia University IEOR seminar for comments and discussions, and to\nan anonymous referee for useful comments and criticism. The information, views\nand opinions set forth in this publication are those of the author, and are in no\nways sponsored, endorsed, or related to the business of J. P. Morgan Chase & Co.\n(\"J. P. Morgan\"). J. P. Morgan does not warrant the publication's completeness or\naccuracy, and makes no representations regarding the use of the information set forth\nin this publication. In no event shall J. P. Morgan be liable for any direct, indirect,\nspecial, punitive, or consequential damages, including loss of principal and/or lost\nprofits, even if notified of the possibility of such damages. Nothing in this publication\nis intended to be an advertisement or offer for any J. P. Morgan service.\n\n\f18\nAppendix. We illustrate in this Appendix the relation between the position of\nthe zeros of the generating function f (i) (x) and the non-analyticity properties of the\nmoments of the Libor distribution function discussed in Sec. 3.1. We take as a concrete\nexample a simulation with n = 40 quarterly time steps, with constant forward short\nrate r0 = 5%, and we examine the zeros of the f (i) (x) at the time step i = 30.\nThe plots in Fig. 5.1 show the movement of the zeros of f (30) (x) as a function\nof the volatility \u03c8 for \u03c8 = 0.3 \u2212 0.33. On the same plots are shown also two circles\n2\n2\nwith radii e\u03c8 ti and e2\u03c8 ti . The values of the volatility at which the zeros cross these\ncircles are the critical volatility \u03c8cr and the critical volatility of the second moment\n(2)\n\u03c8cr , respectively. These critical volatilities are visible as turning points in the plot\nof the equivalent log-normal volatility \u03c3LN as function of \u03c8 in Fig. 3.3.\nA similar picture holds for the higher order moments. For example, the j-th\nmoment of the Libor distribution function Mj = Ei+1 [Lji ] will have a non-analyticity\n(i)\npoint at \u03c8cr . This corresponds to that value of the volatility where the zeros of f (i) (x)\n2\ncross the circle of radius ej\u03c8 ti . As mentioned in the text, for sufficiently high order\nmoments the zeros do not surround completely the origin, and these moments will\nnot have a phase transition.\nREFERENCES\n[1] L. Andersen and V. Piterbarg, Interest Rate Modeling, Atlantic Financial Press, 2010.\n[2] P. Balland and L. P. Hughston, Markov Market Model Consistent with Cap Smile,\nInt. J. Th. Appl. Finance, 3, 161-181 (2000).\n[3] M. Baxter and A. Rennie, Financial calculus: An introduction to derivative pricing, Cambridge\nUniversity Press, 1996.\n[4] M. Bennett and J. Kennedy, A comparison of Markov-functional and market models: the onedimensional case, The Journal of Derivatives 13, 22-43 (2005).\n[5] F. Black, E. Derman and W. Toy, A One-Factor Model of Interest Rates and Its Application\nto Treasury Bond Options, Financial Analysts Journal 24-32 (1990).\n[6] A. Brace, D. Gatarek and M. Musiela, The market model of interest rate dynamics, Math. Finance 7, 125-155 (1997).\n[7] D. Brigo and F. Mercurio, Interest Rate Models - Theory and Practice: With Smile, Inflation\nand Credit, Springer Verlag 2006.\n[8] A. Daniluk and D. Gatarek, A fully lognormal Libor market model, Risk 18(9), 115-118,\nSept. 2005.\n[9] L. U. Dothan, On the Term Structure of Interest Rates, Journal of Financial Economics 6,\n59-69 (1978).\n[10] S. Gerhold, Moment explosion in the Libor market model, Statistics and Probability Letters\n81, 560-562 (2011), arXiv:1008.2104[q-fin.PR]\n[11] P. Glasserman and X. Zhao, Arbitrage free discretization of log-normal forward Libor and swap\nrate models, Finance and Stochastics 4, 35-68 (2000)\n[12] M. Hogan and K. Weintraub, The lognormal interest rate model and eurodollar futures,\nCitibank working paper, 1993.\n[13] Z. Hu, J. Kerkhof, P. McCloud and J. Wackertapp, Cutting edges using domain integration,\nRisk, 95, 2006.\n[14] P. Hunt, J. Kennedy and A. Pellser, Markov-Functional Interest Rate Models, Finance and\nStochastics, 4, 391-408 (2000).\n[15] J. B. Hunt and J. E. Kennedy, Financial Derivatives in Theory and Practice, Wiley Series in\nProbability and Statistics, 2005.\n[16] F. Jamshidian, Forward Induction and Construction of Yield Curve Diffusion Models, J. Fixed\nIncome 1, 62-74 (1991).\n[17] F. Jamshidian, Libor and swap markets models and measures, Finance and Stochastics 1,\n293-330 (1997).\n[18] S. Johnson, Numerical methods for the Markov-functional models, Wilmott, 68 (2006).\n[19] O. Kurbanmuradov, K. Sabelfeld and J. Schoenmakers, Lognormal approximations to Libor\nmarket models, Journal of Computational Finance 6(1), 69-100, 2002.\n\n\f19\n[20] T. D. Lee and C. N. Yang, Statistical Theory of Equations of State and Phase Transitions. II.\nLattice Gas and Ising Model, Physical Review Letters 87, 410-419 (1952); Phys. Rev. 87,\n410 (1952).\n[21] A. L. Lewis, Option Valuation under Stochastic Volatility: with Mathematica Code, Finance\nPress, Newport Beach, 2000.\n[22] A. L. Lewis, The Mixing Approach to Stochastic Volatility and Jump Models, 2002.\n[23] K. Miltersen, L. Sandmann and D. Sondermann, Closed Form Solutions for Term Structure\nDerivatives with Log-normal Interest Rates, J. Finance 52, 409-430 (1997).\n[24] M. Musiela and M. Rutkowski, Martingale methods in financial modeling, Springer-Verlag\n(1997).\n[25] A. Pelsser, Efficient Methods for Valuing Interest Rate Derivatives, Springer Finance, 2000.\n[26] D. Pirjol, Phase Transition in a Log-normal Markov Functional Model, J. Math. Phys. 52,\n013301 (2011), arXiv:1007.0691 [q-fin].\n[27] D. Pirjol, Equivalence of Interest Rate Models and Lattice Gases, Phys. Rev. E 85, 046116\n(2012), arXiv:1204.0915 [q-fin].\n[28] K. Sandmann and D. Sondermann, A note on the stability of lognormal interest rate models\nand the pricing of Eurodollar futures, Mathematical Finance 7(2), 119-125 (1997).\n[29] E. H. Stanley, Introduction to Phase Transitions and Critical Phenomena, Oxford University\nPress, 1987.\n\n\f20\n\ni=30, psi=0.3\n\ni=30, psi=0.31\n\n4\n\n4\n\n2\n\n2\n\n0\n\n0\n\n-2\n\n-2\n\n-4\n\n-4\n\n-4\n\n-2\n\n0\n\n2\n\n4\n\n-4\n\n-2\n\n0\n\ni=30, psi=0.32\n4\n\n2\n\n2\n\n0\n\n0\n\n-2\n\n-2\n\n-4\n\n-4\n\n-2\n\n0\n\n2\n\n4\n\n4\n\ni=30, psi=0.33\n\n4\n\n-4\n\n2\n\n-4\n\n-2\n\n0\n\n2\n\n4\n\nFig. 5.1. The position of the zeros of the generating function f (i) (x) for several values of the\nvolatility \u03c8 = 0.3 \u2212 0.33 at the time horizon i = 30 in a simulation with n = 40 quarterly time steps\n2\n2\n(\u03c4 = 0.25). The two circles shown have radii e\u03c8 ti and e2\u03c8 ti . The zeros cross these circles at\n(2)\n\u03c8cr and \u03c8cr , corresponding to the critical volatility of the model, and to the critical volatility of the\nsecond moment of the Libor distribution function, respectively.\n\n\f"}