{"id": "http://arxiv.org/abs/math/0612777v1", "guidislink": true, "updated": "2006-12-27T10:32:59Z", "updated_parsed": [2006, 12, 27, 10, 32, 59, 2, 361, 0], "published": "2006-12-27T10:32:59Z", "published_parsed": [2006, 12, 27, 10, 32, 59, 2, 361, 0], "title": "Empirical graph Laplacian approximation of Laplace--Beltrami operators:\n  Large sample results", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0612067%2Cmath%2F0612015%2Cmath%2F0612395%2Cmath%2F0612306%2Cmath%2F0612039%2Cmath%2F0612549%2Cmath%2F0612026%2Cmath%2F0612399%2Cmath%2F0612540%2Cmath%2F0612659%2Cmath%2F0612369%2Cmath%2F0612061%2Cmath%2F0612644%2Cmath%2F0612631%2Cmath%2F0612718%2Cmath%2F0612807%2Cmath%2F0612586%2Cmath%2F0612232%2Cmath%2F0612777%2Cmath%2F0612349%2Cmath%2F0612811%2Cmath%2F0612756%2Cmath%2F0612773%2Cmath%2F0612180%2Cmath%2F0612538%2Cmath%2F0612508%2Cmath%2F0612428%2Cmath%2F0612797%2Cmath%2F0612033%2Cmath%2F0612686%2Cmath%2F0612543%2Cmath%2F0612010%2Cmath%2F0612674%2Cmath%2F0612848%2Cmath%2F0612252%2Cmath%2F0612068%2Cmath%2F0612233%2Cmath%2F0612114%2Cmath%2F0612259%2Cmath%2F0612152%2Cmath%2F0612210%2Cmath%2F0612522%2Cmath%2F0612172%2Cmath%2F0612368%2Cmath%2F0612536%2Cmath%2F0612622%2Cmath%2F0612698%2Cmath%2F0612227%2Cmath%2F0612149%2Cmath%2F0612009%2Cmath%2F0612001%2Cmath%2F0612706%2Cmath%2F0612589%2Cmath%2F0612501%2Cmath%2F0612792%2Cmath%2F0612685%2Cmath%2F0612099%2Cmath%2F0612572%2Cmath%2F0612027%2Cmath%2F0612786%2Cmath%2F0612087%2Cmath%2F0612423%2Cmath%2F0612790%2Cmath%2F0612134%2Cmath%2F0612094%2Cmath%2F0612542%2Cmath%2F0612419%2Cmath%2F0612200%2Cmath%2F0612579%2Cmath%2F0612621%2Cmath%2F0612060%2Cmath%2F0612688%2Cmath%2F0612590%2Cmath%2F0612479%2Cmath%2F0612544%2Cmath%2F0612312%2Cmath%2F0612150%2Cmath%2F0612438%2Cmath%2F0612108%2Cmath%2F0612558%2Cmath%2F0612611%2Cmath%2F0612048%2Cmath%2F0612207%2Cmath%2F0612220%2Cmath%2F0612055%2Cmath%2F0612581%2Cmath%2F0612240%2Cmath%2F0612112%2Cmath%2F0612833%2Cmath%2F0612262%2Cmath%2F0612800%2Cmath%2F0612071%2Cmath%2F0612380%2Cmath%2F0612518%2Cmath%2F0612751%2Cmath%2F0612292%2Cmath%2F0612806%2Cmath%2F0612684%2Cmath%2F0612839%2Cmath%2F0612632%2Cmath%2F0612253&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Empirical graph Laplacian approximation of Laplace--Beltrami operators:\n  Large sample results"}, "summary": "Let ${M}$ be a compact Riemannian submanifold of ${{\\bf R}^m}$ of dimension\n$\\scriptstyle{d}$ and let ${X_1,...,X_n}$ be a sample of i.i.d. points in ${M}$\nwith uniform distribution. We study the random operators $$\n\\Delta_{h_n,n}f(p):=\\frac{1}{nh_n^{d+2}}\\sum_{i=1}^n\nK(\\frac{p-X_i}{h_n})(f(X_i)-f(p)), p\\in M $$ where\n${K(u):={\\frac{1}{(4\\pi)^{d/2}}}e^{-\\|u\\|^2/4}}$ is the Gaussian kernel and\n${h_n\\to 0}$ as ${n\\to\\infty.}$ Such operators can be viewed as graph\nlaplacians (for a weighted graph with vertices at data points) and they have\nbeen used in the machine learning literature to approximate the\nLaplace-Beltrami operator of ${M,}$ ${\\Delta_Mf}$ (divided by the Riemannian\nvolume of the manifold). We prove several results on a.s. and distributional\nconvergence of the deviations\n${\\Delta_{h_n,n}f(p)-{\\frac{1}{|\\mu|}}\\Delta_Mf(p)}$ for smooth functions ${f}$\nboth pointwise and uniformly in ${f}$ and ${p}$ (here ${|\\mu|=\\mu(M)}$ and\n${\\mu}$ is the Riemannian volume measure). In particular, we show that for any\nclass ${{\\cal F}}$ of three times differentiable functions on ${M}$ with\nuniformly bounded derivatives $$ \\sup_{p\\in M}\\sup_{f\\in\nF}\\Big|\\Delta_{h_n,p}f(p)-\\frac{1}{|\\mu|}\\Delta_Mf(p)\\Big|=\nO\\Big(\\sqrt{\\frac{\\log(1/h_n)}{nh_n^{d+2}}}\\Big) a.s. $$ as soon as $$\nnh_n^{d+2}/\\log h_n^{-1}\\to \\infty and nh^{d+4}_n/\\log h_n^{-1}\\to 0, $$ and\nalso prove asymptotic normality of\n${\\Delta_{h_n,p}f(p)-{\\frac{1}{|\\mu|}}\\Delta_Mf(p)}$ (functional CLT) for a\nfixed ${p\\in M}$ and uniformly in ${f}.$", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0612067%2Cmath%2F0612015%2Cmath%2F0612395%2Cmath%2F0612306%2Cmath%2F0612039%2Cmath%2F0612549%2Cmath%2F0612026%2Cmath%2F0612399%2Cmath%2F0612540%2Cmath%2F0612659%2Cmath%2F0612369%2Cmath%2F0612061%2Cmath%2F0612644%2Cmath%2F0612631%2Cmath%2F0612718%2Cmath%2F0612807%2Cmath%2F0612586%2Cmath%2F0612232%2Cmath%2F0612777%2Cmath%2F0612349%2Cmath%2F0612811%2Cmath%2F0612756%2Cmath%2F0612773%2Cmath%2F0612180%2Cmath%2F0612538%2Cmath%2F0612508%2Cmath%2F0612428%2Cmath%2F0612797%2Cmath%2F0612033%2Cmath%2F0612686%2Cmath%2F0612543%2Cmath%2F0612010%2Cmath%2F0612674%2Cmath%2F0612848%2Cmath%2F0612252%2Cmath%2F0612068%2Cmath%2F0612233%2Cmath%2F0612114%2Cmath%2F0612259%2Cmath%2F0612152%2Cmath%2F0612210%2Cmath%2F0612522%2Cmath%2F0612172%2Cmath%2F0612368%2Cmath%2F0612536%2Cmath%2F0612622%2Cmath%2F0612698%2Cmath%2F0612227%2Cmath%2F0612149%2Cmath%2F0612009%2Cmath%2F0612001%2Cmath%2F0612706%2Cmath%2F0612589%2Cmath%2F0612501%2Cmath%2F0612792%2Cmath%2F0612685%2Cmath%2F0612099%2Cmath%2F0612572%2Cmath%2F0612027%2Cmath%2F0612786%2Cmath%2F0612087%2Cmath%2F0612423%2Cmath%2F0612790%2Cmath%2F0612134%2Cmath%2F0612094%2Cmath%2F0612542%2Cmath%2F0612419%2Cmath%2F0612200%2Cmath%2F0612579%2Cmath%2F0612621%2Cmath%2F0612060%2Cmath%2F0612688%2Cmath%2F0612590%2Cmath%2F0612479%2Cmath%2F0612544%2Cmath%2F0612312%2Cmath%2F0612150%2Cmath%2F0612438%2Cmath%2F0612108%2Cmath%2F0612558%2Cmath%2F0612611%2Cmath%2F0612048%2Cmath%2F0612207%2Cmath%2F0612220%2Cmath%2F0612055%2Cmath%2F0612581%2Cmath%2F0612240%2Cmath%2F0612112%2Cmath%2F0612833%2Cmath%2F0612262%2Cmath%2F0612800%2Cmath%2F0612071%2Cmath%2F0612380%2Cmath%2F0612518%2Cmath%2F0612751%2Cmath%2F0612292%2Cmath%2F0612806%2Cmath%2F0612684%2Cmath%2F0612839%2Cmath%2F0612632%2Cmath%2F0612253&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let ${M}$ be a compact Riemannian submanifold of ${{\\bf R}^m}$ of dimension\n$\\scriptstyle{d}$ and let ${X_1,...,X_n}$ be a sample of i.i.d. points in ${M}$\nwith uniform distribution. We study the random operators $$\n\\Delta_{h_n,n}f(p):=\\frac{1}{nh_n^{d+2}}\\sum_{i=1}^n\nK(\\frac{p-X_i}{h_n})(f(X_i)-f(p)), p\\in M $$ where\n${K(u):={\\frac{1}{(4\\pi)^{d/2}}}e^{-\\|u\\|^2/4}}$ is the Gaussian kernel and\n${h_n\\to 0}$ as ${n\\to\\infty.}$ Such operators can be viewed as graph\nlaplacians (for a weighted graph with vertices at data points) and they have\nbeen used in the machine learning literature to approximate the\nLaplace-Beltrami operator of ${M,}$ ${\\Delta_Mf}$ (divided by the Riemannian\nvolume of the manifold). We prove several results on a.s. and distributional\nconvergence of the deviations\n${\\Delta_{h_n,n}f(p)-{\\frac{1}{|\\mu|}}\\Delta_Mf(p)}$ for smooth functions ${f}$\nboth pointwise and uniformly in ${f}$ and ${p}$ (here ${|\\mu|=\\mu(M)}$ and\n${\\mu}$ is the Riemannian volume measure). In particular, we show that for any\nclass ${{\\cal F}}$ of three times differentiable functions on ${M}$ with\nuniformly bounded derivatives $$ \\sup_{p\\in M}\\sup_{f\\in\nF}\\Big|\\Delta_{h_n,p}f(p)-\\frac{1}{|\\mu|}\\Delta_Mf(p)\\Big|=\nO\\Big(\\sqrt{\\frac{\\log(1/h_n)}{nh_n^{d+2}}}\\Big) a.s. $$ as soon as $$\nnh_n^{d+2}/\\log h_n^{-1}\\to \\infty and nh^{d+4}_n/\\log h_n^{-1}\\to 0, $$ and\nalso prove asymptotic normality of\n${\\Delta_{h_n,p}f(p)-{\\frac{1}{|\\mu|}}\\Delta_Mf(p)}$ (functional CLT) for a\nfixed ${p\\in M}$ and uniformly in ${f}.$"}, "authors": ["Evarist Gin\u00e9", "Vladimir Koltchinskii"], "author_detail": {"name": "Vladimir Koltchinskii"}, "author": "Vladimir Koltchinskii", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1214/074921706000000888", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/math/0612777v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0612777v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "Published at http://dx.doi.org/10.1214/074921706000000888 in the IMS\n  Lecture Notes Monograph Series\n  (http://www.imstat.org/publications/lecnotes.htm) by the Institute of\n  Mathematical Statistics (http://www.imstat.org)", "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.DG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "60F15, 60F05 (Primary) 53A55, 53B99 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0612777v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0612777v1", "journal_reference": "IMS Lecture Notes Monograph Series 2006, Vol. 51, 238-259", "doi": "10.1214/074921706000000888", "fulltext": "arXiv:math/0612777v1 [math.PR] 27 Dec 2006\n\nIMS Lecture Notes\u2013Monograph Series\nHigh Dimensional Probability\nVol. 51 (2006) 238\u2013259\nc Institute of Mathematical Statistics, 2006\nDOI: 10.1214/074921706000000888\n\nEmpirical graph Laplacian approximation\nof Laplace\u2013Beltrami operators:\nLarge sample results\nEvarist Gin\u00e91,\u2217 and Vladimir Koltchinskii1,\u2020\nUniversity of Connecticut and Georgia Institute of Technology\nAbstract: Let M be a compact Riemannian submanifold of Rm of dimension d\nand let X1 , . . . , Xn be a sample of i.i.d. points in M with uniform distribution.\nWe study the random operators\n\u2206hn ,n f (p) :=\nwhere K(u) :=\n\n1\nnhd+2\nn\n2\n\nn\nX\ni=1\n\n1\ne\u2212kuk /4\n(4\u03c0)d/2\n\nK(\n\np \u2212 Xi\n)(f (Xi ) \u2212 f (p)), p \u2208 M\nhn\n\nis the Gaussian kernel and hn \u2192 0 as n \u2192 \u221e.\n\nSuch operators can be viewed as graph laplacians (for a weighted graph with\nvertices at data points) and they have been used in the machine learning\nliterature to approximate the Laplace-Beltrami operator of M, \u2206M f (divided\nby the Riemannian volume of the manifold). We prove several results on a.s.\n1\nand distributional convergence of the deviations \u2206hn ,n f (p) \u2212 |\u03bc|\n\u2206M f (p) for\nsmooth functions f both pointwise and uniformly in f and p (here |\u03bc| = \u03bc(M )\nand \u03bc is the Riemannian volume measure). In particular, we show that for any\nclass F of three times differentiable functions on M with uniformly bounded\nderivatives\nsup sup \u2206hn ,p f (p) \u2212\n\np\u2208M f \u2208F\n\n1\n\u2206M f (p) = O\n|\u03bc|\n\nas soon as\n\n\u0010r\n\nlog(1/hn )\nnhd+2\nn\n\n\u0011\n\na.s.\n\n\u22121\nd+4\n\u22121\nnhd+2\nn / log hn \u2192 \u221e and nhn / log hn \u2192 0,\n\nand also prove asymptotic normality of \u2206hn ,p f (p) \u2212\nCLT) for a fixed p \u2208 M and uniformly in f.\n\n1\n\u2206 f (p)\n|\u03bc| M\n\n(functional\n\n1. Introduction\nRecently, there have been several developments in statistical analysis of data supported on a submanifold in a high dimensional space based on the idea of approximation of the Laplace-Beltrami operator of the manifold (and some more general\noperators that contain information not only about the geometry of the manifold,\nbut also about the unknown density of data points) by empirical graph Laplacian\noperators. If V is a finite set of vertices and W := (wij )i,j\u2208V is a symmetric nonnegative definite matrix of weights with wij \u2265 0 (\"adjacency matrix\"), then the\n1 University of Connecticut, Department of Mathematics, U-3009, Storrs, CT 06269, USA,\nSchool of Mathematics, Georgia Inst. of Technology, Atlanta, GA 30332, USA, e-mail:\ngine@math.uconn.edu; vlad@math.gatech.edu\n\u2217 Research partially supported by NSA Grant H98230-1-0075.\n\u2020 Research partially supported by NSF Grant DMS-03-04861.\nAMS 2000 subject classifications: primary 60F15, 60F05; secondary 53A55, 53B99.\nKeywords and phrases: Laplace-Beltrami operator, graph Laplacian, large sample approximations.\n\n238\n\n\fLaplace\u2013Beltrami operators\n\n239\n\ngraph Laplacian of the weighted graph (V, W ) is defined as the matrix (operator)\nL = D \u2212 W, where D is the diagonal matrix with the degrees of vertices\nX\ndeg(i) :=\nwij , i \u2208 V\nj\u2208V\n\non the diagonal. Such (unnormalized) graph Laplacians along with their normalized\ncounterparts L\u0303 := I \u2212 D\u22121/2 LD\u22121/2 have been studied extensively in spectral\ngraph theory. If now X1 , . . . , Xn are i.i.d. points uniformly distributed in a compact\nRiemannian submanifod M of Rm of dimension d < m, it has been suggested in the\nliterature to view {X1 , . . . , Xn } as the set V of vertices of the graph and to define\n2\n2\nthe weights as wij \u224d e\u2212kXi \u2212Xj k /4h with a small parameter h > 0, to approximate\nthe Laplace-Beltrami operator \u2206M of M, \u2206M (f ) = div(grad(f )). More precisely,\nthe estimate is defined as\n\u2206hn ,n f (p) :=\n\nn\n1 X \u0010 p \u2212 Xi \u0011\nK\n(f (Xi ) \u2212 f (p)), p \u2208 M\nhn\nnhd+2\nn\ni=1\n2\n\nwhere K(u) := (4\u03c0)1d/2 e\u2212kuk /4 is the Gaussian kernel and hn \u2192 0 as n \u2192 \u221e (if the\nfunctions f are restricted to V, this can be viewed, up to a sign, as a graph Laplacian\noperator). We will call such operators empirical graph Laplacians and their limit\n1\n\u2206M f (p), where |\u03bc| is the Riemannian\nas n \u2192 \u221e on smooth functions f is |\u03bc|\nvolume of M. There are numerous statistical applications of such an approximation\nof the manifold Laplacian by its empirical version. In particular, one can look\nat projections of the data on eigenspaces of the empirical Laplacian \u2206hn ,n (the\ntechnique sometimes called diffusion maps) in order to try to recover geometrically\nrelevant features of the data (as in the method of spectral clustering) or use the\nkernels associated with this operator to approximate the heat kernel of the manifold\nand to use it to design kernel machines suitable, for instance, for classification of\nthe manifold data.\nConvergence properties of empirical graph Laplacians have been first studied\nby Belkin and Niyogi [1] and Hein, Audibert and von Luxburg [8]. Our goal in\nthis paper is to provide a more subtle probabilistic analysis of such operators. In\nparticular, for proper classes of\npsmooth functions F and for a fixed p \u2208 M, we\n1\nestablish a functional CLT for nhd+2\nn (\u2206hn ,p f (p) \u2212 |\u03bc| \u2206M f (p)), f \u2208 F, and also\nshow that\n\u0013\n\u0012s\n1\nlog(1/hn )\na.s.\nsup sup \u2206hn ,p f (p) \u2212\n\u2206M f (p) = O\n|\u03bc|\nnhd+2\np\u2208M f \u2208F\nn\n(under suitable assumptions on hn ). The asymptotic properties of empirical laplacians are closely related to the well developed theory of kernel density and kernel\nregression estimators, which can be viewed as examples of so called local empirical\nprocesses, as in [6]. Our proofs are essentially based on an extension of this type of\nresults to the case of data on the manifolds (for kernel density estimation on manifolds, see, e.g., [11] and references therein). For simplicity, we are considering in\nthe current paper only uniform distributions on manifolds and Gaussian kernels K,\nbut more general types of operators that occur in the case when the distribution of\nthe data is not uniform and more general kernels (as in the paper of Hein, Audibert\nand von Luxburg [8]) can be dealt with quite similarly using the methods of the\npaper.\n\n\f240\n\nE. Gin\u00e9 and V. Koltchinskii\n\n2. Some geometric background\nWe refer to [4] for the basic definitions and notations from Riemannian geometry.\nGiven a manifold M and p \u2208 M , Tp (M ) will denote the tangent space to M at p, and\nT M the tangent bundle. Let M be a complete connected (embedded) Riemannian\nsubmanifold of Rm , of dimension d < m, meaning that M is a complete connected\nRiemannian manifold and that the inclusion map \u03c6 : M 7\u2192 Rm is an isometric embedding, that is, (i) \u03c6 is differentiable and injective, (ii) d\u03c6p : Tp (M ) 7\u2192 T\u03c6(p) (Rm )\nis an isometry onto its image, T\u03c6(p) (\u03c6(M )), and (iii) \u03c6 is a homeomorphism onto\n\u03c6(M ) with the topology inherited from Rm . When no confusion may arise, we identify M with \u03c6(M ). M being complete, by the Hopf and Rinow theorem (e.g., [4],\np. 146) the closed bounded sets of M are compact.\nGiven p \u2208 M and v \u2208 Tp (M ), let \u03b3(t, p, v), t > 0, be the geodesic starting\nat p with velocity v, \u03b3(0, p, v) = p and \u03b3 \u2032 (0, p, v) = v. The exponential map Ep :\nTp (M ) 7\u2192 M (the usual notation is expp ) is defined by Ep (v) = \u03b3(1, p, v). This map\nis defined on all of Tp (M ) by the Hopf and Rinow theorem.\nA normal neighborhood V of p \u2208 M is one for which a) every point q in V can be\njoined to p by a unique geodesic \u03b3(t, p, v), 0 \u2264 t \u2264 1, with \u03b3(0) = p, \u03b3(1) = q and b)\nthe exponential map centered at p, Ep , is a diffeomorphism between a neighborhood\nof 0 \u2208 Tp (M ) and V . If B \u2282 V is a normal ball of center p, that is, the image by the\nexponential map of a ball around zero in Tp (M ), then the unique geodesic joining\np to q \u2208 B is a minimizing geodesic, which means that if dM denotes the distance\nin M and | * | denotes the norm of Tp (M ) defined by the Riemannian structure of\nM , then dM (p, Ep (v)) = |v|. Given an orthonormal basis e1 , . . . , ed of Tp (M ), the\nnormal coordinates centered at p (or the p-normal coordinates) of q \u2208 V are the\ncomponents qip = hEp\u22121 (q), ei i of Ep\u22121 (q) in this basis. (The super-index p will be\nomitted when no confusion may arise, but we will need it when considering normal\ncoordinates based at different points.) Every point in M has a normal neighborhood.\nSee [4], Propositions 2.7, and 3.6, pp. 64 and 70 for these facts. Actually, more is\ntrue (e.g., [4], Theorem 3.7 and Remark 3.8):\nProposition 2.1. For every p \u2208 M there exist a neighborhood W of p and a number\n\u03b4 > 0 such that: (a) for every q in W , Eq is defined on the \u03b4 ball around 0 \u2208 Tq (M ),\nB\u03b4 (0) \u2282 Tq (M ), and Eq (B\u03b4 (0)) is a normal ball for q, (b) W \u2282 Eq (B\u03b4 (0)) (W is a\nnormal neighborhood of all of its points), and (c) the function\nF (q, v) := (q, Eq (v))\nis a diffeomorphism from W\u03b4 := W \u00d7 B\u03b4 (0) = {(q, v) \u2208 T M : q \u2208 W, |v| < \u03b4} onto\nits image in M \u00d7 M and |dF | is bounded away from zero on W\u03b4 .\nSuch a neighborhood W of p is called totally or uniformly normal. In particular, Eq (v) is jointly differentiable in (q, v) \u2208 W\u03b4 if W is a uniformly normal\nneighborhood. Moreover, for every q \u2208 W and v \u2208 Tq (M ) such that |v| < \u03b4,\ndM (q, Eq (v)) = |v|.\nRemark 2.1. By shrinking W and taking \u03b4/2 instead of \u03b4 if necessary, we can\nassume in Proposition 2.1 that the closure of W and the closure of W\u03b4 (which\nare compact because M is complete) are contained in W \u2032 and W\u03b4\u2032\u2032 satisfying the\nproperties described in the previous proposition. Moreover, we can also assume that\nfor all q in W , Eq (B\u03b4 (0)) is contained in a strongly convex normal ball around p\n(these points are at distances less than 2\u03b4 from p, so this assumption can be met by\nfurther shrinking W and taking a smaller \u03b4 if necessary, since every point in M has\n\n\fLaplace\u2013Beltrami operators\n\n241\n\na strongly convex geodesic ball, e.g. Proposition 4.2 in do Carmo, loc. cit.; strongly\nconvex set: for any two points in the set, the minimizing geodesic joining them lies\nin the set). We will assume without loss of generality and without further mention\nthat our uniformly normal neighborhoods W satisfy these two conditions.\nLet W be a uniformly normal neighborhood of p as in the remark, let W \u2032 be\na uniformly normal neighborhood of p containing the closure of W , and let 0 <\n\u03b4 < \u03b4 \u2032 be as in the proposition and the remark. Let us choose an orthonormal\nbasis e1 , . . . , ed of Tp (M ) and define an orthonormal frame eq1 , . . . , eqd , q \u2208 W \u2032 , by\nparallel transport of e1 , . . . , ed from p to q along the unique minimizing geodesic\njoining p and q. So, eq1 , . . . , eqd is an orthonormal basis of Tq (M ) for each q \u2208 W \u2032 .\nThis frame depends differentiably on q as parallel transport is differentiable (and\npreserves length and angle). So, we have on W \u2032 a system of normal coordinates\nPd\ncentered at q for every q \u2208 W \u2032 , namely, if x \u2208 Eq (B\u03b4\u2032 (0)) is x = Eq ( i=1 vi eqi ),\nthen the coordinates of x, xqi are xqi = vi , the components of Eq\u22121 (x). Let now f be\na differentiable function f : M 7\u2192 R, and define f \u0303 : W\u03b4\u2032\u2032 7\u2192 R by\nf \u0303(q, v) := f (\u03c02 (F (q, v)) = f (Eq (v)),\nwhere \u03c02 is the projection of M \u00d7 M onto its second component. This map is\ndifferentiable by the previous proposition. In particular, if we take as coordinates\nof (q, v) \u2208 W\u03b4\u2032\u2032 the normal coordinates centered at p of q, (q1 , . . . , qd ) = (q1p , . . . , qdp )\nand for v \u2208 Tq (M ) the coordinates v1 , . . . vd in the basis eq1 , . . . , eqd , which coincide\nwith the normal coordinates centered at q of Eq (v), then the real function of 2d\nvariables (which we keep calling f \u0303; the same convention applies to other similar\ncases below)\nf \u0303(q1 , . . . , qd , v1 , . . . , vd ) = f \u0303(q, v)\nis differentiable on the preimage of W\u03b4\u2032\u2032 by this system of coordinates. Moreover,\nby compactness, each of its partial derivatives (of any order) is uniformly bounded\non the preimage of W\u03b4 . If we denote by xqi the normal coordinates centered at q,\nwe obviously have that for each r \u2208 N and (i1 , . . . , ir ) \u2208 {1, . . . , d}r ,\n\u2202rf\n\u2202 r f \u0303\n(x)\n=\n(q1 , . . . , qd , xq1 , . . . , xqd ).\n\u2202xqi1 \u2202xqi2 . . . \u2202xqir\n\u2202vi1 \u2202vi2 . . . \u2202vir\nWe then conclude that\neach of the partial derivatives (any order) of f with respect to the\n(2.1)\nq \u2212 normal coordinates xqi is unif ormly bounded in q \u2208 W and x \u2208 Eq (B\u03b4 (0)).\nIn particular, the error term in any limited Taylor development of f in q-normal\ncoordinates can be bounded uniformly in q for all |v| < \u03b4, that is, if Pkq (xq1 , . . . , xqd )\nis the Taylor polynomial of degree k in these coordinates, we have, for q \u2208 W and\n|Eq\u22121 (x)| < \u03b4,\n(2.2)\n\n|f (x) \u2212 Pkq (xq1 , . . . , xqd )| \u2264 Ck (dM (q, x))k+1 ,\n\nwhere Ck is a constant that depends only on k. Moreover, the coefficients of the\npolynomials Pkq are differentiable functions of q, in particular bounded on W . The\nq-uniformity of these Taylor developments for |v| < \u03b4 and the q-differentiability\n\n\f242\n\nE. Gin\u00e9 and V. Koltchinskii\n\nof their coefficients will be very useful below. We will apply these properties to\nthe canonical (in Rm ) coordinates of the embedding \u03c6 and also to the functions\n\u2202\n, \u2202 i(x), where xi = xpi are the p-normal coordinates.\nh \u2202x\ni \u2202xj\nIn what follows, we often deal with classes F of functions on M whose partial\nderivatives up to a given order k are uniformly bounded in M or in a neighborhood\nU of a point p \u2208 M. In such cases, we say that F is unformly bounded up to the\nk-th order in M (or in U ). Clearly, this property does not depend on the choice\nof normal (or even arbitrary) local coordinates. In the case when we choose an\northonormal frame eq1 , . . . , eqd and define normal coordinates and the corresponding\npartial derivatives as described above, we can also deal with continuity of partial\nderivatives. We say that F is a uniformly bounded and equicontinuous up to the k-th\norder class of functions iff there exists a finite covering of M with uniformly normal\nneighborhoods such that, in each neighborhood, the sets of partial derivatives of\nany order \u2264 k are uniformly bounded and equicontinuous. This definition does not\ndepend on the choice of orthonormal frames in the neighborhoods. Such classes are\nuseful because the remainders in Taylor developments are uniform both in q \u2208 M\nand in f \u2208 F.\nConsider now, for q \u2208 W \u2032 and x \u2208 Eq (B\u03b4\u2032 (0)), the tangent vector fields \u2202x\u2202 q (x),\ni\n\n\u2202\ni = 1, . . . , d, and simply write \u2202x\n(x) for \u2202x\u2202 p (x). Taking the previous coordinates\ni\ni\nqi , vj in W\u03b4\u2032\u2032 , denote by \u03c7i (Eq (v)) = \u03c7i (q1 , . . . , qd , v1 , . . . , vd ) the p-normal coordinates of Eq (v), which are differentiable. By the chain rule,\nd\n\nX \u2202\u03c7j\n\u2202\n\u2202\n(q, Eq\u22121 x)\n(x).\nq (x) =\n\u2202xi\n\u2202vi\n\u2202xj\nj=1\n\nq\nHence, if gij\n(x) are the components of the metric tensor at x in q-normal coordinates, we have\nX \u2202\u03c7r\n\u2202\u03c7s\n\u2202\n\u2202\n\u2202\n\u2202\nq\n(q, Eq\u22121 x)\n(q, Eq\u22121 x)\n,\ngij\n(x) =\n(x).\nq,\nq (x) =\n\u2202xi \u2202xj\n\u2202vi\n\u2202vj\n\u2202xi \u2202xj\n1\u2264r,s\u2264d\n\nBy (2.2), we conclude that if Pkq (xq1 , . . . , xqd ) is the Taylor polynomial of degree k in\nq\nthe expansion of gij\n(x) in q-normal coordinates, then there are constants Ck that\ndepend only on k such that, for all q \u2208 W and x \u2208 Eq (B\u03b4 (0)),\n\n(2.3)\n\nq\n|gij\n(x) \u2212 Pkq (xq1 , . . . , xqd )| \u2264 Ck (dM (q, x))k+1 .\n\nThis will also be useful below. These remarks allow us to strengthen several results\nbased on Taylor expansions by making them uniform in q, as follows.\nProposition 2.2. Given p \u2208 M , let W and W\u03b4 be as in Remark 2.1, and consider\nfor each q \u2208 W , the q-normal system of coordinates defined above. Then,\nq\n(a) for every q \u2208 W the components gij\n(xq1 , . . . , xqd ) of the metric tensor in q-normal\ncoordinates admit the following expansion, uniform in q and in x \u2208 Eq (B\u03b4 (0))\n(B\u03b4 (0) \u2208 Tq (M )):\n1 q\nq\n(0)xqr xqs + O(d3M (q, x)),\ngij\n(xq1 , . . . , xqd ) = \u03b4ij \u2212 Rirsj\n3\nq\n(Einstein notation) where Rirsj\n(0) are the components of the curvature tensor at\nq in q-normal coordinates, and, as a consequence, the following expansion of the\nvolume element is also uniform in q and x:\nq\n1\nq\n(2.5)\ndet(gij\n)(xq1 , . . . , xqd ) = 1 \u2212 Ricqrs (0)xqr xqs + O(d3M (q, x)),\n6\n(2.4)\n\n\fLaplace\u2013Beltrami operators\n\n243\n\nwhere Ricqrs (0) are the components of the Ricci tensor at q in q-normal coordinates.\n(b) There exists C < \u221e such that for all q \u2208 W and x \u2208 Eq (B\u03b4 (0)),\n0 \u2264 d2M (q, x) \u2212 k\u03c6(q) \u2212 \u03c6(x)k2 \u2264 Cd4M (q, x).\n\n(2.6)\n\n(c) For each 1 \u2264 \u03b1 \u2264 m, the \u03b1-th component in canonical coordinates of Rm of\n\u03c6(Eq (v)), \u03c6\u03b1 (Eq (v)), admits the following expansion in q-normal coordinates vi of\nEq (v), uniform in q \u2208 W and |v| < \u03b4,\n(2.7)\n\n\u03c6\u03b1 (Eq (v)) \u2212 \u03c6\u03b1 (q) =\n\n1 \u2202 2 \u03c6\u0303\u03b1\n\u2202 \u03c6\u0303\u03b1\n(q, 0)vi +\n(q, 0)vi vj + O(|v|3 ),\n\u2202vi\n2 \u2202vi \u2202vj\n\n\u03b1 = 1, . . . , m, where \u03c6\u0303(q, v) = \u03c6(Eq (v)).\nPd\n\u03c6\u0303\u03b1\nNote that i=1 \u2202\u2202v\n(q, 0)vi are the Rm -canonical coordinates centered at \u03c6(q)\ni\nq\nof the vector d\u03c6q (v) \u2208 T\u03c6(q) (\u03c6(M )) \u2282 Rm since gij\n(q) = \u03b4ij . Hence, if we identify\nthe tangent space to \u03c6(M ) at \u03c6(q) with an affine subspace of Rm , part c) says\nthat the difference between \u03c6(Eq (v)) \u2208 Rm and the tangent vector to the geodesic\n\u03c6(\u03b3(t, q, v)) at \u03c6(q) (t = 0), \u03c6(q) + d\u03c6q (v), is a vector of the form\n\u00101\n\n2\n\nX\n\n1\u2264i,j\u2264d\n\n\u0011\n\u2202 2 \u03c6\u0303\u03b1\n(q, 0)vi vj : \u03b1 = 1, . . . , m + O(|v|3 )\n\u2202vi \u2202vj\n\nwhere O(|v|3 ) is uniform in |v| < \u03b4 and q. Ignoring the embedding, this gives an\nexpansion of the exponential map as\n(2.7\u2032 )\n\nEq (v) = q + v + Qq (v, v) + O(|v|3 )\n\nuniform in q \u2208 W and |v| < \u03b4, where Qq is a Rm -valued bilinear map on Tq (M ) (actually, on T\u03c6(q) (\u03c6(M ))) that depends differentiably on q, hence uniformly bounded\nin q \u2208 W .\nq\nq\nq\nProof of Proposition 2.2. (a) follows from the expansions of gij\nand det(gij\n) in\nq-normal coordinates (e.g. in [12], p. 41), the expansion of its determinant (e.g.,\n[12], p. 45), and the uniformity provided by (2.3).\n(c) follows by direct application of (2.2) to f = \u03c6\u03b1 , \u03b1 = 1, . . . , m.\n(b) Following Smolyanov, Weizs\u00e4cker and Wittich [13], for q \u2208 W and x = Eq (v),\n|v| < \u03b4, and applying (2.2) for f = \u03c6\u03b1 , \u03b1 = 1, . . . , m, we have\n\u00012\nP\n|v|2 \u2212 m\nd2M (q, x) \u2212 k\u03c6(q) \u2212 \u03c6(x)k2\n\u03b1=1 \u03c6\u03b1 (Eq (v)) \u2212 \u03c6\u03b1 (q)\n=\n0\u2264\nd4M (q, x)\n|v|4\n\u00012\nPm\n3\n\u03c6\u0303\u03b1\n\u2202 2 \u03c6\u0303\u03b1\n|v|2 \u2212 \u03b1=1 \u2202\u2202v\n(q, 0)vi + 12 \u2202v\n(q, 0)vi vj + 16 \u2202vi\u2202\u2202v\u03c6\u0303j\u03b1\u2202vk (q, 0)vi vj vk\ni\ni \u2202vj\n=\n|v|4\n+ O(|v|),\n\nwhere the term O(|v|) is dominated by C4 |v| for a constant C4 that does not depend on q or v. But now, continuing the proof in this reference, which consists in\ndeveloping and simplifying the ratio above, we obtain that, uniformly in q \u2208 W ,\nx = Eq (v), |v| < \u03b4,\n\u00012\n\u2202 2 \u03c6\u0303\u03b1\n1 X \u2202vi \u2202vj (q, 0)vi vj\nd2M (q, x) \u2212 k\u03c6(q) \u2212 \u03c6(x)k2\n+ O(|v|),\n=\n0\u2264\nd4M (q, x)\n12 \u03b1\n|v|4\n\n\f244\n\nE. Gin\u00e9 and V. Koltchinskii\n\nand note also that, by compactness, the main term is bounded by a fixed finite\nconstant in this domain.\nAlthough we have been using [4] as our main reference on Riemannian geometry, another nice user-friendly reference for the exponential map in particular and\nRiemannian manifolds in general is [9]. We thank Jesse Ratzkin for reading this\nsection and making comments (of course, any mistakes are ours).\n3. Approximation of the Laplacian by averaging kernel operators\nLet M be a compact connected Riemannian submanifold of Rm , m > d (if M\nis compact, it is automatically embedded, that is, conditions (i) and (ii) on the\nimmersion \u03c6 imply that \u03c6 is a homeomorphism onto its image). [ See a remark at\nthe end of this section for a relaxation of this condition.] Let \u03bc be its Riemannian\nvolume measure and |\u03bc| = \u03bc(M ). Let K : Rm 7\u2192 R be the Gaussian kernel of Rm ,\n(3.1)\n\nK(x) =\n\n2\n1\ne\u2212kxk /4 ,\n(4\u03c0)d/2\n\nwhere kxk is the norm of x in Rm . Let X be a random variable taking values\nin M with law the normalized volume element, \u03bc/|\u03bc|, and let f : M 7\u2192 R be\na differentiable function. The object of this section is to show that the LaplaceBeltrami operator or Laplacian of M ,\n\u2206M f (p) = div grad(f )(p)\np\n\u2202f\n\u2202\nij\n), where (g ij ) = (gij )\u22121 )\ndet(gij ) \u2202x\n(in coordinates, \u2206M (f ) = \u221a 1\n\u2202xi (g\nj\ndet(gij )\n\ncan be approximated, uniformly in f (with some partial derivatives bounded), and\nin p \u2208 M , by the averaging kernel operator\n\u0013\n\u0015\n\u0014 \u0012\n\u0001\n1\n\u03c6(p) \u2212 \u03c6(X)\nf (X) \u2212 f (p)\n(3.2)\n\u2206hn f (p) := d+2 E K\nhn\nhn\n\nwith rates depending on hn \u2192 0. Note that, by the expansion (2.4) of the metric\ntensor in normal coordinates centered at p, we have, in these coordinates,\n(3.3)\n\n\u2206M f (p) =\n\nd\nX\n\u22022f\ni=1\n\n\u2202x2i\n\n(p).\n\n(where p = (0, . . . , 0) in these coordinates).\nWith some abuse of notation, given p \u2208 M , we denote the derivatives with\nrespect to the components of v of f \u0303(p, v) = f \u25e6 Ep (v) at (p, v), v = Ep\u22121 (x), by\n\u0001\n\u2202 f \u0303\n\u2202 f \u0303\n(p, v), . . . , \u2202v\n(p, v) )\nf \u2032 (x), f \u2032\u2032 (x), etc. (so, for instance, if x = Ep (v), f \u2032 (x) = \u2202v\n1\nd\n(k)\n\n(in fact, f (k) (x) depends on p and therefore it should have been denoted fp (x),\nbut in the context we are using this notation p is typically fixed, so, we will drop\np, hopefully, without causing a confusion).\nTheorem 3.1. We have, for any p, any normal neighborhood Up of p and a class\nF uniformly bounded up to the third order in Up , that\n(3.4)\n\nsup \u2206hn f (p) \u2212\n\nf \u2208F\n\n1\n\u2206M f (p) = O(hn ).\n|\u03bc|\n\n\fLaplace\u2013Beltrami operators\n\n245\n\nas hn \u2192 0. Moreover, for any class of functions uniformly bounded up to the third\norder in M,\nsup sup \u2206hn f (p) \u2212\n\n(3.5)\n\nf \u2208F p\u2208M\n\n1\n\u2206M f (p) = O(hn ).\n|\u03bc|\n\nas hn \u2192 0.\nProof. M being regular, the embedding \u03c6 is a homeomorphism of M onto \u03c6(M ),\nand M being compact, the uniformities defined respectively on M by the intrinsic\nmetric dM (p, q) and by the metric from Rm , dRm (p, q) := k\u03c6(p) \u2212 \u03c6(q)k coincide\n(e.g., Bourbaki (1940), Theorem II.4.1, p. 107), that is, given \u03b5 > 0 there exists\n\u03b4 > 0 such that if dM (p, q) < \u03b4 for p, q \u2208 M , then dRm (p, q) < \u03b5, and conversely.\nHence, in Proposition 2.2, we can replace B\u03b4 (0) \u2282 Tq (M ) by B\u03b4\u2032 \u2032 (0) := Eq\u22121 {x \u2208\nM : k\u03c6(q)\u2212\u03c6(x)k < \u03b4 \u2032 } for some \u03b4 \u2032 depending on \u03b4 but not on p or q. From here on,\nwe identify M with \u03c6(M ) (that is, we leave \u03c6 implicit). Let p \u2208 M . Given hn \u0581 0,\nlet\n(3.6)\n\n1/2\n}\nBn := {x \u2208 M : kp \u2212 xk < Lhn (log h\u22121\nn )\n\n1/2\nfor a constant L to be chosen later. As soon as Lhn (log h\u22121\n< \u03b4 \u2032 , the neighborn )\nhood of 0 \u2208 Tp (M ),\nB\u0303n := Ep\u22121 Bn\n\nis well defined, and, by (2.6), since |v| = dM (p, Ep (v)), we have on B\u0303n that\n|v|2 \u2265 kp \u2212 Ep (v)k2 \u2265 |v|2 (1 \u2212 C|v|2 )\n\nwith C independent of p \u2208 M . Hence, for all n \u2265 N0 , for some N0 < \u221e independent\nof p, we have\n(3.7)\n\n1/2\n{v \u2208 Tp M : |v| < Lhn (log h\u22121\n} \u2286 B\u0303n\nn )\n1/2\n\u2286 {v \u2208 Tp M : |v| < 2Lhn (log h\u22121\n},\nn )\n\nwhere the coefficient 2 can be replaced by \u03bbn \u2192 1. Assume n \u2265 N0 .\nBy the definitions of K and Bn ,\n\u0012\n\u0013\np\u2212X\nE K\n(f (X) \u2212 f (p))I(X \u2208 M \\ Bn )\nhn\nZ\n2\n2 d\u03bc(x)\n2kf k\u221e\n\u2264\n(3.8)\ne\u2212kp\u2212xk /4hn\nd/2\n|\u03bc|\n(4\u03c0)\nM\\Bn\n\u2264\n\n2kf k\u221e L2 /4\nh\n.\n(4\u03c0)d/2 n\n\np\nTaking into account that the measure \u03bc has density det(gij ) in p-normal coordinates (hence on Bn ), we have\n\u0014 \u0012\n\u0013\n\u0015\np\u2212X\nE K\n(f (X) \u2212 f (p))I(X \u2208 Bn )\nhn\nZ\n(3.9)\nq\n1\n\u2212kp\u2212Ep (v)k2 /4h2n\ndet(gij )(v)dv.\n=\n(f\n(E\n(v))\n\u2212\nf\n(E\n(0)))\ne\np\np\n(4\u03c0)d/2 |\u03bc| B\u0303n\nWith the notation introduced just before the statement of the theorem, the Taylor\nexpansion of f in p-normal coordinates can be written as\n1\n1\nf (Ep (v)) \u2212 f (Ep (0)) = hf \u2032 (p), vi + f \u2032\u2032 (p)(v, v) + f \u2032\u2032\u2032 (\u03bev )(v, v, v).\n2\n3!\n\n\f246\n\nE. Gin\u00e9 and V. Koltchinskii\n\nwhere \u03bev = Ep (\u03b8v v) for some \u03b8v \u2208 [0, 1]. Next we will estimate the three terms that\nresult from combining this Taylor development with equation (3.9). Recall that, by\nProposition 2.2, there are C1 and C independent of p such that\nq\n1 2\ndet(gij )(v) \u2264 1 + C1 |v|2 ,\n|v| \u2264 |v|2 \u2212 C|v|4 \u2264 kp \u2212 Ep (v)k2 \u2264 |v|2\n(3.10)\n2\nfor v \u2208 B\u0303n , and recall also (3.7) on the size of B\u0303n . Using these facts and the\ndevelopment of the exponential about \u2212|v|2 /4h2n immediately gives\nZ\nZ\nq\n2\n2\n2\n2\ne\u2212|v| /4hn hf \u2032 (p), vidv + Rn\ne\u2212kp\u2212Ep (v)k /4hn hf \u2032 (p), vi det(gij )(v)dv =\nB\u0303n\n\nB\u0303n\n\nwhere\nZ\n\n2\n4\n2\n2\n2\u0001\ne\u2212(|v| \u2212C|v| )/4hn \u2212 e\u2212|v| /4hn |f \u2032 (p)||v|dv\nB\u0303n\nZ\n2\n2\ne\u2212|v| /8hn |f \u2032 (p)||v|3 dv\n+ C1\nB\u0303n\nZ\n\u2212|v|2 /8h2n \u2032\ne\n|f (p)|(C|v|5 /(4h2n ) + C1 |v|3 )dv\n\u2264\nB\u0303n\nZ\n2\n\u2264 h3+d\ne\u2212|v| /8 |f \u2032 (p)|(C|v|5 /4 + C1 |v|3 )dv\nn\n\n|Rn | \u2264\n\nRd\n\n\u2032\n\n= D|f (p)|h3+d\nn ,\n\n1/2\nand D only depends on C, C1 and d. Moreover, since Bnc \u2286 {|v| \u2265 Lhn (log h\u22121\n}\nn )\nand\nZ\n2\n2\ne\u2212|v| /4hn hf \u2032 (p), vidv = 0,\nRd\n\nwe also have\nZ\nZ\n2\n2\ne\u2212|v| /4hn hf \u2032 (p), vidv =\n\ne\u2212|v|\n\n2\n\n/4h2n\n\nc\nB\u0303n\n\nB\u0303n\n\n\u2264 |f \u2032 (p)|\n\nZ\n\nhf \u2032 (p), vidv\ne\u2212|v|\n\n2\n\n/4h2n\n\n1/2\n|v|\u2265Lhn (log h\u22121\nn )\n\n= |f \u2032 (p)|h1+d\nn\n\nZ\n\ne\u2212|u|\n\n2\n\n/4\n\n1/2\n|u|\u2265L(log h\u22121\nn )\n\n= Cd |f \u2032 (p)|h1+d\nn\n\nZ\n\ne\u2212r\n\n|v|dv\n\n2\n\n|u|du\n\n/4 d\n\nr dr\n\n1/2\nr\u2265L(log h\u22121\nn )\n\n\u2264 Cd\u2032 |f \u2032 (p)|Ld\u22121 h1+d+L\nn\n\n2\n\n/4\n\n(d\u22121)/2\n(log h\u22121\n,\nn )\n\nwhere Cd and Cd\u2032 are constants depending only on d. Collecting terms and assuming\nL2 /4 > 2,\nwe obtain\n(3.11)\n\nZ\n\nB\u0303n\n\ne\u2212kp\u2212Ep (v)k\n\n2\n\n/4h2n\n\nq\nhf \u2032 (p), vi det(gij )(v)dv \u2264 D2 |f \u2032 (p)|h3+d\nn ,\n\nfor all n \u2265 N0 , and where D2 does not depend on p.\n\n\f247\n\nLaplace\u2013Beltrami operators\n\nThe remainder term is of a similar order if |f \u2032\u2032\u2032 | is uniformly bounded in a\nneighborhood of p: if c is such a bound,\nZ\nq\n2\n2\ne\u2212kp\u2212Ep (v)k /4hn f \u2032\u2032\u2032 (\u03bev )(v, v, v) det(gij )(v)dv\nB\u0303n\nZ\n(3.12)\n2\n2\n3+d\ne\u2212|v| /8hn |v|3 |1 + C1 h2n log h\u22121\n\u2264c\nn |dv \u2264 D3 chn ,\nB\u0303n\n\nwhere D3 does not depend on f or p (as long as n \u2265 N0 ).\nFinally, we consider the second term, which is the one that gives the key relationship to the Laplacian. Proceeding as we did for the first term, we see that\nZ\nq\n2\n2\ne\u2212kp\u2212Ep (v)k /4hn f \u2032\u2032 (p)(v, v) det(gij )(v)dv\nB\u0303n\nZ\n(3.13)\n2\n= hd+2\ne\u2212|v| /4 f \u2032\u2032 (p)(v, v)dv + Rn ,\nn\nRd\n\nwhere now\n(3.14) |Rn | \u2264 D4 |f \u2032\u2032 (p)|h4+d\n+ D5 |f \u2032\u2032 (p)|h2+d+L\nn\nn\n\n2\n\n/4\n\nd/2\n(log h\u22121\n\u2264 D6 |f \u2032\u2032 (p)|h4+d\nn )\nn\n\nif\nL2 /4 > 2\nand n \u2265 N0 , where the constants D do not depend on f or p. Now, by definition\nf \u2032\u2032 (p) = (f \u25e6 Ep )\u2032\u2032 (0) =\n\n!d\n\u2202 2 (f \u25e6 Ep )\n(0)\n\u2202vi \u2202vj\n\n=\n\ni,j=1\n\n!d\n\u22022f\n(p)\n\u2202xi \u2202xj\n\n,\n\ni,j=1\n\nso that, on account of (3.3),\n\n(3.15)\n\nZ\n\nRd\n\ne\u2212|v|\n\n2\n\n/4 \u2032\u2032\n\nf (p)(v, v)dv =\n\n\u0012Z\n\ne\u2212|v|\n\nRd\n\n= 2(4\u03c0)d/2\n\n2\n\n/4 2\nv1 dv\n\n\u0013X\nd\ni=1\n\nd\nX\n\u22022f\ni=1\n\n\u2202x2i\n\n\u22022f\n(p)\n\u2202x2i\n\n(p) = 2(4\u03c0)d/2 \u2206M f (p).\n\nCombining the bounds (3.11), (3.12), (3.13)-(3.14) and the identity (3.15) with\n(3.9), we obtain the first part of the theorem. Note that we need to choose L such\n1/2\n< \u03b4, and that with these\nthat L2 /4 > 2 and then N0 such that LhN0 (log h\u22121\nN0 )\nchoices the bounds obtained on the terms that tend to zero in the proof depend\nonly on the sup of the derivatives of f and on the sup of certain differentiable\nfunctions of (q, v) on W\u03b4 , where W is a uniformly normal neighborhood of p and\n\u03b4 the corresponding number from Proposition 2.2 and Remark 2.1. These bounds\nare the same if we replace p by any q \u2208 W by Proposition 2.2. M being compact,\nit can be covered by a finite number of uniformly normal neighborhoods Wi , i \u2264 k,\nwith numbers \u03b4i as prescribed in Proposition 2.1 and Remark 2.1. Taking \u03b4 to be\nthe minimum of \u03b4i , i = 1, . . . , k, and the constants in the bounds in the first part\nof the proof as the maximum of the constants in these bounds for each of the k\nneighborhoods, the above estimates work uniformly on q \u2208 M , giving the second\npart of the theorem.\n\n\f248\n\nE. Gin\u00e9 and V. Koltchinskii\n\nRemark 3.1. (1) Obviously, the first part of the theorem, namely the limit (3.4),\ndoes not require the manifold M to be compact. (2) If instead of assuming existence\nand boundedness of the third order partial derivatives in a neighborhood of p we\nassume that the second order derivatives are continuous in a neighborhood of p,\nthen we can proceed as in the above proof except for the remainder term (3.12),\nthat now can be replaced by\nZ\nq\n2\n2\ne\u2212kp\u2212Ep (v)k /4hn (f \u2032\u2032 (\u03bev ) \u2212 f \u2032\u2032 (p))(v, v) det(gij )(v)dv = o(h2+d\n(3.16)\nn ).\nB\u0303n\n\nHence, in this case we still have\n\u2206hn f (p) \u2192\n\n(3.17)\n\n1\n\u2206M f (p) as hn \u2192 0.\n|\u03bc|\n\nA similar observation can be made regarding (3.5).\nRemark 3.2. Suppose N is a compact Riemannian d-dimensional submanifold of\nRm with boundary (for the definition, see [12], p. 70-71). The Riemannian volume\nmeasure \u03bc is still finite. Then, Theorem 3.1 is still true if X is a N -valued random\nvariable with law \u03bc/|\u03bc| with |\u03bc| = \u03bc(N ), and M a compact subset of N interior to\nN . The proof is essentially the same.\nThe first part of Theorem 3.1, without uniformity in f , is proved in a more\ngeneral setting in [8].\nTheorem 3.1 provides the basis for the estimation of the Laplacian of M by\nindependent sampling from the space according to the normalized volume element,\nwhich is what we do for the rest of this article.\n4. Pointwise approximation of the Laplacian by graph Laplacians\nLet M be a compact Riemannian submanifold of Rd (or, in more generality, let M\nbe as in Remark 3.2), and let X, Xi , i \u2208 N, be independent identically distributed\nrandom variables with law \u03bc/|\u03bc|. The 'empirical counterpart' of the averaging kernel\noperator from Section 3 corresponding to such a sequence is the so called graph\nLaplacian\n\u0012\n\u0013\nn\n1 X\np \u2212 Xi\n(4.1)\n\u2206hn ,n f (p) :=\nK\n(f (Xi ) \u2212 f (p)),\nhn\nnhd+2\nn\ni=1\nwith K given by (3.1) (other kernels are possible).\nWe begin with the pointwise central limit theorem for a single function f , as a\nlemma for the CLT uniform in f .\nProposition 4.1. Assume f has partial derivatives up to the third order continuous\nin a neighborhood of p. Let hn \u2192 0 be such that nhdn \u2192 \u221e and nhd+4\n\u2192 0. Then,\nn\nq\ni\nh\n1\n\u2206M f (p) \u2192 sg in distribution,\n(4.2)\nnhd+2\n\u2206hn ,n f (p) \u2212\nn\n|\u03bc|\n\nwhere g is a standard normal random variable and\n(4.3) s2 =\n\n1\n(4\u03c0)d |\u03bc|\n\nZ\n\nRd\n\ne\u2212|v|\n\n2\n\n/2\n\nd\nd\n\u00112\n\u0010X\nX\n2\n1\n\u2202f\n\u2202f\ndv\n=\n(p)v\nj\np\np (p) .\nd\nd/2\n\u2202xj\n2 (2\u03c0) |\u03bc| j=1 \u2202xj\nj=1\n\n\fLaplace\u2013Beltrami operators\n\n249\n\nProof. Since by Theorem 3.1,\n\u0012q\n\u0013\nq\n\u0011\n\u0010\nd+2\nd+4\nnhn\n\u2206M f (p) \u2212 \u2206hn f (p) = O\nnhn\n\u2192 0,\nit suffices to prove that the sequence\n\"\nq\nd+2\nZn = nhn\n\n(4.4)\n\n\u0013\nn \u0012 \u0012\n1 X\np \u2212 Xi\nK\n(f (Xi ) \u2212 f (p))\nhn\nnhd+2\nn\ni=1\n\u0013\n\u0013#\n\u0012\np\u2212X\n(f (Xi ) \u2212 f (p))\n\u2212 EK\nhn\n\nis asymptotically centered normal with variance s2 . To prove this we first observe\nthat we can restrict to Xi \u2208 Bn because, as in (3.8),\n\"\n\n#\n\u0013\np\n\u2212\nX\ni\nE K2\n(f (Xi ) \u2212 f (p))2 I(X \u2208 M \\ Bn )\nhn\nhd+2\nn\nZ\n4kf k2\u221e L2 /2\u2212(d+2)\n4kf k2\u221e\n\u2212L2 (log h\u22121\nn )/2 d\u03bc/|\u03bc| =\nh\n\u21920\ne\n\u2264\n(4\u03c0)d n\n(4\u03c0)d hd+2\nM\nn\n1\n\n(4.5)\n\n\u0012\n\nif we take L2 /2 > d + 2. Now, on the restriction to Bn we replace f (Xi ) \u2212 f (p) by\nits Taylor expansion up to the second order plus remainder, as done in the proof of\nTheorem 3.1. The second term and the remainder parts, namely\n\"\nq\nd+2\nZn,2 := nhn\n\n(4.6)\n\n\u0013\nn \u0012 \u0012\np \u2212 Xi\n1 X\nK\nf \u2032\u2032 (p)(Ep\u22121 (Xi ), Ep\u22121 (Xi ))I(Xi \u2208 Bn )\nh\nnhd+2\nn\nn\ni=1\n\u0012\n\u0013\n\u0013#\np\u2212X\n\u2032\u2032\n\u22121\n\u22121\n\u2212 EK\nf (p)(Ep (X), Ep (X))I(X \u2208 Bn )\nhn\n\nand\nZn,3\n\n\"\nq\nd+2\n:= nhn\n\n(4.7)\n\n\u0013\nn \u0012 \u0012\np \u2212 Xi \u2032\u2032\u2032\n1 X\nK\nf (\u03bei )\nhn\nnhd+2\nn\ni=1\n\n\u00d7 (Ep\u22121 (Xi ), Ep\u22121 (Xi ), Ep\u22121 (Xi ))I(Xi \u2208 Bn )\n\u0013\n\u0013#\n\u0012\np\u2212X\n\u2032\u2032\u2032\n\u22121\n\u22121\n\u22121\nf (\u03be)(Ep (X), Ep (X), Ep (X))I(X \u2208 Bn )\n\u2212 EK\nhn\n\ntend to zero in probability: the estimates (3.10) give\n2\nEZn,2\n\n(4.8)\n\nZ\nq\n1\n\u2032\u2032\n2\n\u2212kp\u2212Ep (v)k2 /2h2n\n\u2264\ndet(gij )(v)dv\n(f\n(p)(v,\nv))\ne\n(4\u03c0)d |\u03bc|hd+2\nB\u0303\nn\nZ n\n2\n2\n2\n\u2264\ne\u2212|v| /3hn |f \u2032\u2032 (p)|2 |v|4 dv\nd+2\nd\n(4\u03c0) |\u03bc|hn\nB\u0303n\nZ\nd+4\n2\n2hn\n\u2264\ne\u2212|v| /3 |f \u2032\u2032 (p)|2 |v|4 dv = O(h2n ) \u2192 0,\nd\n(4\u03c0)d |\u03bc|hd+2\nR\nn\n\n\f250\n\nE. Gin\u00e9 and V. Koltchinskii\n\nand, with c = supx\u2208U |f \u2032\u2032\u2032 (x)|,\nZ\nq\n2\n2\n2cn\np\ne\u2212kp\u2212Ep (v)k /4hn |v|3 det(gij )(v)dv\nB\u0303n\n(4\u03c0)d/2 |\u03bc| nhd+2\nn\nZ\n2\n2\n3cn\np\n\u2264\ne\u2212|v| /5hn |v|3 dv\nd+2\nB\u0303n\n(4\u03c0)d/2 |\u03bc| nhn\nZ\n2\n3h3+d\ncn\nn\np\ne\u2212|v| /5 |v|3 dv\n\u2264\nRd\n(4\u03c0)d/2 |\u03bc| nhd+2\nn\n\u0010q\n\u0011\nnhd+4\n=O\n\u2192 0.\nn\n\nE|Zn,3 | \u2264\n\n(4.9)\n\nFinally, we show that the linear term part,\n\"\n\u0013\nq\nn \u0012 \u0012\np \u2212 Xi\n1 X\nd+2\nK\nhf \u2032 (p), Ep\u22121 (Xi )iI(Xi \u2208 Bn )\nZn,1 := nhn\nh\nnhd+2\nn\nn\ni=1\n(4.10)\n\u0012\n\u0013\n\u0013#\np\u2212X\n\u2032\n\u22121\n\u2212 EK\nhf (p), Ep (X)iI(X \u2208 Bn )\nhn\nis asymptotically N (0, s2 ). Since, by (3.11),\n\u0013\n\u0012\nr\nn\np\u2212X\nhf \u2032 (p), Ep\u22121 (X)iI(X \u2208 Bn )\nEK\nhn\nhd+2\nn\nr\n\u0011\n\u0010q\nn\n4+d\nd+3\nnh\n\u2192 0,\n=\nO(h\n)\n=\nO\nn\nn\nhd+2\nn\n\nand since, by computations similar to the ones leading to (3.11),\n\" \u0012\n\u0013\n\u0013#2\np\u2212X\n1\nhf \u2032 (p), Ep\u22121 (X)iI(X \u2208 Bn )\nE K\nhn\nhd+2\nn\nZ\nq\n1\n\u2212kp\u2212Ep (v)k2 /2h2n\n\u2032\n2\ne\nhf\n(p),\nvi\n=\ndet(gij )(v)dv\n(4\u03c0)d |\u03bc|hd+2\nn\nB\u0303n\nZ\n2\n1\n=\ne\u2212|v| /2 hf \u2032 (p), vi2 dv\nd\n(4\u03c0) |\u03bc| Rd\n!\n\u0011\n\u0010\n\u0011\n\u0010\n1\nd+4\n2+d+L2 /4\n\u22121 (d+1)/2\n,\n+ O hn\n(log hn )\n+ d+2 O hn\nhn\n\nwe have that, taking L2 /4 > 2 + d,\n2\nlim EZn,1\n= s2 .\n\n(4.11)\n\nn\u2192\u221e\n\nTherefore, by Lyapunov's theorem (e.g., [2], p. 44), in order to show that\nL(Zn,1 ) \u2192 N (0, s2 ),\n\n(4.12)\nit suffices to prove that\n\n\u0014 \u0012\n\u0013\np\u2212X\nE\nK\nhf \u2032 (p), Ep\u22121 (X)iI(X \u2208 Bn )\n\u00114\nhn\nd+2\n\nn\n(4.13)\n\n\u0010p\nnhn\n\n\u0013\n\u00154\np\u2212X\n\u2032\n\u22121\nhf (p), Ep (X)iI(X \u2208 Bn ) \u2192 0\n\u2212 EK\nhn\n\u0012\n\n\fLaplace\u2013Beltrami operators\n\n251\n\nBy the hypothesis on hn and (3.11) we can ignore the expected value within the\nsquare bracket, and for the rest, proceeding as usual, we have\n\u0013\n\u00154\n\u0014 \u0012\np\u2212X\n\u2032\n\u22121\nhf\n(p),\nE\n(X)iI(X\n\u2208\nB\n)\nE\nK\nn\np\n2(d+2)\nhn\nnhn\nZ\n2\n4\n2\n1\n=\ne\u2212(|v| +O(|v| )/hn hf \u2032 (p), vi4 (1 + O(|v|2 ))dv\n2(d+2)\nB\u0303n\n(4\u03c0)2 |\u03bc|nhn\nZ\nd+4\n2\n2hn\ne\u2212|v| /2 |f \u2032 (p)|4 dv = O(1/(nhdn )) \u2192 0,\n\u2264\n2(d+2)\n2\nRd\n(4\u03c0) |\u03bc|nhn\n1\n\nproving (4.13), and therefore, the limit (4.12). Now the theorem follows from Proposition 2.1, (4.5), (4.8), (4.9) and (4.12).\nThis result extends without effort to the CLT uniform in f , which is the main\nresult in this section.\nTheorem 4.2. Let U be a normal neighborhood of p and let F be a class of functions\nuniformly bounded up to the third order in U. Assume nhd+4\n\u2192 0, and nhdn \u2192 \u221e.\nn\nThen, as n \u2192 \u221e, the processes\n\u001b\n\u001aq\ni\nh\n1\n\u2206M f (p) : f \u2208 F\nnhd+2\n\u2206hn ,n f (p) \u2212\nn\n|\u03bc|\n\n(4.14)\n\nconverge in law in l\u221e (F ) to the Gaussian process\n\n(4.15)\n\n\uf8f1\n\uf8f2\n\n\uf8fc\nd\n\uf8fd\nX\n\u2202f\n1\nZ\nG(f ) := d/2\n(p)\n:\nf\n\u2208\nF\n,\nj\np\n\uf8f3\n\uf8fe\n2 (2\u03c0)d/4 |\u03bc|1/2 j=1 \u2202xj\n\nwhere Z = (Z1 , . . . , Zd ) is the standard normal vector in Tp (M ) (= Rd ).\nPr\nProof. The proof of Proposition 4.1 applied to f = j=1 \u03b1j fj , with fj \u2208 F, shows\nthat the finite dimensional distributions of the processes (4.14) converge to those\nof the process (4.15) (by the definition (4.3) of s = s(f )). Also, by Theorem 3.1,\nwe can center the processes (4.14). Hence, the Theorem will follow if we show that\nthe processes Zn = Zn (f ) in (4.4) are asymptotically equicontinuous with respect\nto a totally bounded pseudometric on F (e.g., [5]).\nFirst, by the computation (3.8) we can restrict the range of Xi to Xi \u2208 Bn by\ntaking L2 /4 > d + 3, because\n\u0013\nn \u0012 \u0012\nX\np \u2212 Xi\n1\np\nK\nE sup\n(f (Xi ) \u2212 f (p))I(Xi \u2208 M \\ Bn )\nhn\nf \u2208F i=1\nnhd+2\nn\n\u0012\n\u0013\n\u0013\np\u2212X\n\u2212 EK\n(f (Xi ) \u2212 f (p))I(X \u2208 M \\ Bn )\nhn\nL2 /4\n\n\u2264\n\n4cnhn\np\n\u2192 0,\n(4\u03c0)d/2 nhd+2\nn\n\nsince nhd+4\n\u2192 0.\nn\n\n\f252\n\nE. Gin\u00e9 and V. Koltchinskii\n\nNow that we can restrict to Xi \u2208 Bn , we only need to consider Zn,i (f ), i = 1, 2, 3,\nas defined by equations (4.10), (4.6) and (4.7) respectively. Asymptotic equicontinuity of Zn,1 (f ) follows because\n\u0013\nn \u0012 \u0012\nX\np \u2212 Xi\n1\nK\nEp\u22121 (Xi )I(Xi \u2208 Bn )\nE sup |Zn,1 (f )|2 \u2264 \u03b4 2 E p\nd+2\nh\n\u2032\nn\nkf (p)k\u2264\u03b4\nnhn i=1\n\u0012\n\u0013\n\u0013 2\np\u2212X\n\u2212 EK\nEp\u22121 (X)I(X \u2208 Bn )\nhn\n2\n\u0013\n\u0012\np\u2212X\n\u03b42\n\u22121\nE\n(X)I(X\n\u2208\nB\n)\nE\nK\nn\np\nhn\nhd+2\nn\nZ\nq\n\u03b42\n\u2212kp\u2212Ep (v)k2 /2h2n\n2\n=\ne\n|v|\ndet(gij )(v)dv\n(4\u03c0)d |\u03bc|hd+2\nn\nB\u0303n\nZ\n2\n\u03b42\n\u2264\ne\u2212|v| /3 |v|2 dv\n(4\u03c0)d |\u03bc| Rd\n\n\u2264\n\nwhich tends to zero when we take sup over n and then limit as \u03b4 \u2192 0.\nNext, by the computation in (4.9),\n\u0010p\n\u0011\nE sup |Zn,3 (f )| = O\nnh4n \u2192 0.\nf \u2208F\n\nFinally we consider Zn,2 (f ). Let \u03b5i be i.i.d. Rademacher variables independent\nof {Xi }. Then, by symmetrization,\n2\nE sup Zn,2\n(f )\nf \u2208F\n\n\u0012\n\u0013\nn\n2\nX\np \u2212 Xi\n4\n\u2032\u2032\n\u22121\n\u22121\n\u03b5\nK\n.\nf\n(p)(E\n(X\n),\nE\n(X\n))I(X\n\u2208\nB\n)\nEE\nsup\n\u2264\ni\ni\ni\ni\nn\n\u03b5\np\np\nhn\nnhd+2\nf \u2208F i=1\nn\nNext, we recall that, for an operator A in Rd , (or in Tp (M )), we have the following\nidentity for its quadratic form\nA(u, v) := hAu, vi = hA, u \u2297 viHS ,\nwhere in orthonormal coordinates, u \u2297 v is the d \u00d7 d-matrix with entries ui vj , and\nthe Hilbert-Schmidt inner product of two matrices is just the inner product in R2d .\nAlso note in particular that ku \u2297 vkHS = |u||v|. Therefore,\n\u0013\n\u0012\nn\n2\nX\np \u2212 Xi\nf \u2032\u2032 (p)(Ep\u22121 (Xi ), Ep\u22121 (Xi ))I(Xi \u2208 Bn )\nE\u03b5 sup\n\u03b5i K\nhn\nf \u2208F i=1\n\u0012\n\u001c\n\u0013\n\u001d2\nn\nX\np \u2212 Xi\n\u03b5i K\n= E\u03b5 sup f \u2032\u2032 (p),\n(Ep\u22121 (Xi ) \u2297 Ep\u22121 (Xi ))I(Xi \u2208 Bn )\nhn\nf \u2208F\nHS\ni=1\n\u2264 E\u03b5 sup |f \u2032\u2032 (p)|2HS E\u03b5\nf \u2208F\nn\nX\n\n\u0013\n2\np \u2212 Xi\n(Ep\u22121 (Xi ) \u2297 Ep\u22121 (Xi ))I(Xi \u2208 Bn )\nhn\nHS\ni=1\n\u0013\n\u0012\nn\nX\np \u2212 Xi\nk(Ep\u22121 (Xi ) \u2297 Ep\u22121 (Xi ))k2HS I(Xi \u2208 Bn ) =: c2 \u039b2n .\n\u2264 b2\nK2\nh\nn\ni=1\n\u00d7\n\n\u03b5i K\n\n\u0012\n\n\f253\n\nLaplace\u2013Beltrami operators\n\nNow, by (4.8),\nE\u039b2n = nEK 2\n\n\u0012\n\n\u0013\nZ\n2\n2nhd+4\np\u2212X\nn\nkEp\u22121 (X)k4 I(X \u2208 Bn ) \u2264\ne\u2212|v| /3 |v|4 dv,\nhn\n(4\u03c0)d |\u03bc| Rd\n\nwhich gives\n2\nE sup Zn,2\n(f ) = O(h2n ) \u2192 0.\nf \u2208F\n\nA simpler proof along similar lines gives the following law of large numbers:\nTheorem 4.3. Let U be a normal neighborhood of p and let F be uniformly bounded\nand equicontinuous up to the second order in U. Assume hn \u2192 0 and nhd+2\n\u2192 \u221e.\nn\nThen\n(4.16)\n\nsup \u2206hn ,n f (p) \u2212\n\nf \u2208F\n\n1\n\u2206M f (p) \u2192 0\n|\u03bc|\n\nin pr.\n\nA Law of the Iterated Logarithm is also possible, but we refrain from presenting\none since in the next section we will give a law of the logarithm for the sup over\nf \u2208 F and p \u2208 M , and the same methods, with a simpler proof, give the LIL at a\nsingle point.\n5. Uniform approximation of the Laplacian by graph Laplacians\nThis section is devoted to results about approximation of the Laplacian by graph\nLaplacians not only uniformly on the functions f , but also on the points p \u2208 M ,\nM a compact submanifold or M as in Remark 3.2. The distributional convergence\nrequires extra work (recall the Bickel-Rosenblatt theorem on the asymptotic distribution of the sup of the difference between a density and its kernel estimator) and\nwill not be considered here.\nAlthough the results in this section are also valid in the situation of Remark 3.2,\nwe will only state them for M a compact submanifold (without boundary). Also,\nwe will identify M with \u03c6(M ), that is, the imbedding \u03c6 will not be displayed.\nTheorem 5.1. Let M be a compact Riemannian submanifold of dimenison d < m\nof Rm , let X, Xi be i.i.d. with law \u03bc/|\u03bc| and let K be as defined in (3.1). Let F be\na class of functions uniformly bounded and equicontinuous up to the second order\n\u22121\nin M. If hn \u2192 0 and nhd+2\nn / log hn \u2192 \u221e, then\n(5.1)\n\nsup sup \u2206hn ,n f (q) \u2212\n\nf \u2208F q\u2208M\n\n1\n\u2206M f (q) \u2192 0 a.s.\n|\u03bc|\n\nas n \u2192 \u221e. Moreover, if F is a class of functions uniformly bounded up to the third\n\u22121\norder in M, and, in addition to the previous conditions on hn , nhd+4\nn / log hn \u2192 0,\nthen\n\u0013\n\u0012s\nlog(1/hn )\n1\nas n \u2192 \u221e a.s.\n\u2206M f (q) = O\n(5.1\u2032 ) sup sup \u2206hn ,n f (q) \u2212\n|\u03bc|\nnhd+2\nf \u2208F q\u2208M\nn\nProof. By Remark 3.1 on Theorem 3.1 (more precisely, by its uniform version), in\norder to prove (5.1) it suffices to show that\n(5.2)\n\nsup sup \u2206hn ,n f (q) \u2212 \u2206hn f (q) \u2192 0 a.s.\n\nf \u2208F q\u2208M\n\n\f254\n\nE. Gin\u00e9 and V. Koltchinskii\n\n1/2\nLet Bn,q = {x \u2208 M : kx \u2212 qk < Lhn (log h\u22121\n}, where, we recall, k * k is the norm\nn )\nm\n2\nin R . Then, as in (3.8) and (4.5), if L /4 > d + 2,\n\nsup sup\nf\n\n(5.3)\n\nq\n\nn\n1 X\u0010\nc\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q\n)(f (Xi ) \u2212 f (q))\nnhd+2\nn\ni=1\n\u0010\n\u0011\u0011\nc\n\u2212 E K((q \u2212 X)/hn )I(X \u2208 Bn,q\n)(f (X) \u2212 f (q))\nL2 /4\n\n4kf k\u221ehn\n\u2264\nhd+2\nn\n\n\u2192 0.\n\nTo establish (5.1), we show that\nEn :=\n(5.4)\n\nn \u0010\nX\n1\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(f (Xi ) \u2212 f (q))\nE\nsup\nsup\nq\nnhd+2\nf\nn\ni=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(f (X) \u2212 f (q)) \u2192 0,\n\nand use Talagrand's [14] concentration inequality to transform this into a statement\non a.s. convergence.\nEach function f \u2208 F can be extended to a twice continuously differentiable\nfunction f on a compact domain N of Rm with M in its interior such that the\n\u2032\n\u2032\u2032\nclasses {f : f \u2208 F } {f : f \u2208 F } {f : f \u2208 F } are uniformly bounded and\n\u2032\u2032\n{f : f \u2208 F } is equicontinuous on N (use a finite partition of unity to patch\ntogether convenient extensions of f in each of the sets in a finite cover of M by e.g.,\ngeodesic balls: see e.g. Lee [9], pp. 15-16). Then,\n\u2032\n\nf (Xi ) \u2212 f (q) = f (q + \u03b8(Xi \u2212 q))(Xi \u2212 q)\nfor some point 0 \u2264 \u03b8 = \u03b8q,Xi \u2264 1.\nNote that, M being compact, Bn,q is contained in one of a finite number of\nuniformly normal neighborhoods for all n \u2265 N0 , with N0 < \u221e independent of q,\nso, we can use q-normal coordinates and notice that for these coordinates, on Bn,q ,\nwe have the inequalities (3.10) holding uniformly in q (by Proposition 2.2). Since\n\u2032\nthe derivative f is uniformly bounded, for n \u2265 N1 (independent of q), we have\nEK 2 ((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(f (Xi ) \u2212 f (q))2\n\u2264 CEK 2 ((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )kXi \u2212 qk2 ,\nwhich, in view of (3.10), can be further bounded by\n2CEK 2 ((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )|Eq\u22121 (Xi )|2\nZ\n2\n4\n2\ne\u2212(|v| \u2212C|v| )/2hn |v|2 (1 + C1 |v|2 )dv\n\u2264 2C\nB\u0303n,q\n\n\u2264\n\n2Chd+2\nn\n\nZ\n\nRd\n\ne\u2212|v|\n\n2\n\n/3\n\n|v|2 (1 + C1 |v|2 )dv \u2264 C2 hd+2\nn ,\n\nso we have\n(5.5)\n\nEK 2 ((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(f (Xi ) \u2212 f (q))2 \u2264 C2 hd+2\nn\n\nwith a constant C2 that does not depend on q.\n\n\f255\n\nLaplace\u2013Beltrami operators\n\nTo prove (5.4), we replace f (Xi ) \u2212 f (q) by its Taylor expansion of the second\norder:\n1 \u2032\u2032\n\u2032\nf (Xi ) \u2212 f (q) = f (q)(Xi \u2212 q) + f (q)(Xi \u2212 q, Xi \u2212 q) + rn (f ; q; Xi ),\n2\nwhere\nsup sup rn (f ; q; X) \u2264 \u03b4n kX \u2212 qk2\n\nq\u2208M f \u2208F\n\n\u2032\u2032\n\nwith \u03b4n \u2192 0 as n \u2192 \u221e (because of equicontinuity of {f : f \u2208 F } and the fact\n1/2\nthat kX \u2212 qk < Lhn (log h\u22121\n\u2192 0).\nn )\nThe first order term leads to bounding the expectation\nn \u0010\nD \u2032\nX\n1\nE\nsup\nsup\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(Xi \u2212 q)\nf\n(q),\nq\nnhd+2\nf\nn\ni=1\n\u0011E\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(X \u2212 q)\n,\n\nwhich is smaller than\n\nn \u0010\nX\nb\nE\nsup\nsup\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(Xi \u2212 q)\nnhd+2\nq\nf\nn\ni=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(X \u2212 q) ,\n\u2032\n\nwhere b is a uniform upper bound on f . Denote the coordinates of x \u2208 Rm in\nthe canonical basis of Rm by x\u03b1 , \u03b1 = 1, . . . , m and consider the class of functions\nM 7\u2192 R,\nG = {fq,h,\u03bb (x) := e\u2212kq\u2212xk\n\n2\n\n/4h2\n\nI(kx \u2212 qk < \u03bb)(x\u03b1 \u2212 q\u03b1 ) : q \u2208 M, h > 0, \u03bb > 0}.\n2\n\n2\n\nBy arguments of Nolan and Pollard (1987), the class of functions of x, {e\u2212kq\u2212xk /4h :\nq \u2208 M, h > 0} is VC subgraph; and it is well known that the open balls in Rm are\nVC and that the class of functions {x\u03b1 \u2212 q\u03b1 : q \u2208 M } is also VC subgraph (see,\ne.g., [5]). The three classes are bounded (resp. by 1, 1 and 2 sup{kxk : x \u2208 M }) and\ntherefore, by simple bounds on covering numbers, the product of the three classes\nis VC-type with respect to the constant envelope C = 2 + 2 sup{kxk : x \u2208 M }.\nIn particular, if N (G, \u03b5) are the covering numbers for G in L2 of any probability\nmeasure, then\n\u0010 A \u0011v\nN (G, \u03b5) \u2264\n\u03b5\nfor some A, v < \u221e and all \u03b5 less than or equal to the diameter of G. Hence, by\ninequality (2.2) in [7], there exists a constant R such that\nE sup\nq\n\n(5.6)\n\nn \u0010\nX\n1/2\nK((q \u2212 Xi )/hn )I(kXi \u2212 qk < Lhn (log h\u22121\n)(Xi,\u03b1 \u2212 q\u03b1 )\nn )\ni=1\n\n\u0010\n1/2\n\u2212 E K((q \u2212 X)/hn )I(kX \u2212 qk < Lhn (log h\u22121\n)(X\u03b1 \u2212 q\u03b1 )\nn )\nr\n\u0010\u221a\nA\u0011\nA\n,\n\u2228 log\n\u2264 R n\u03c3 log\n\u03c3\n\u03c3\n\n\f256\n\nE. Gin\u00e9 and V. Koltchinskii\n\nwhere \u03c3 2 \u2265 supf \u2208G Ef 2 (X). Now, to compute \u03c3 we use again our observations\nbefore the proof of (5.5). For n \u2265 N1 (independent of q), we have\n2\n\nsup Ef (X) \u2264\n\nf \u2208G\n\n\u2264\n\nZ\n\ne\u2212(|v|\n\n2\n\n\u2212C|v|4 )/2h2n\n\nB\u0303n,q\n\nhd+2\nn\n\nZ\n\ne\u2212|v|\n\n2\n\nRd\n\n/3\n\n|v|2 (1 + C1 |v|2 )dv\n\n|v|2 dv \u2264 C2 hd+2\nn ,\n\nfor some C2 < \u221e independent of q. So, we can take \u03c3 2 = C2 hd+2\nn . Hence, by the\nhypothesis on hn , the right hand side of (5.6) is bounded by\n\u0010\nA \u00111/2\nlog\nR\u2032 nhd+2\nn\nhn\nfor some R\u2032 < \u221e.\nTo handle the second order term, note that\nn \u0010\nX\n1\n\u2032\u2032\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )f (q)(Xi \u2212 q, Xi \u2212 q)\nE\nsup\nsup\nq\nnhd+2\nf\nn\ni=1\n\u0011\n\u2032\u2032\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )f (q)(X \u2212 q, X \u2212 q)\nD \u2032\u2032\n1\nE\nsup\nsup\n=\nf (q),\nq\nnhd+2\nf\nn\nn \u0010\nX\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(Xi \u2212 q) \u2297 (Xi \u2212 q)\ni=1\n\n\u0011E\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(X \u2212 q) \u2297 (X \u2212 q)\n\nHS\n\n,\n\nwhich is dominated by\nn \u0010\nX\nb\nE\nsup\nsup\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(Xi \u2212 q) \u2297 (Xi \u2212 q)\nq\nnhd+2\nf\nn\ni=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(X \u2212 q) \u2297 (X \u2212 q)\n\nHS\n\n\u2032\u2032\n\n(with b being a uniform upper bound on f ). Here \u2297 denotes the tensor product of\nvectors of Rm and k * kHS is the Hilbert-Schmidt norm for linear transformations\nof Rm . This leads to bounding the expectation\nE sup\nq\n\u2032\n\n(5.6 )\n\nn \u0010\nX\ni=1\n\n1/2\nK((q \u2212 Xi )/hn )I(kXi \u2212 qk < Lhn (log h\u22121\n)(Xi,\u03b1 \u2212 q\u03b1 )(Xi,\u03b2 \u2212 q\u03b2 )\nn )\n\n\u0010\n1/2\n\u2212 E K((q \u2212 X)/hn )I(kX \u2212 qk < Lhn (log h\u22121\n)(X\u03b1 \u2212 q\u03b1 )(X\u03b2 \u2212 q\u03b2 )\nn )\n\nfor all 1 \u2264 \u03b1, \u03b2 \u2264 m, which is done using the inequality for empirical processes\non VC-subgraph classes exactly the same way as in the case (5.6). This time the\nbound becomes\n\u0010\nA \u00011/2\nlog\nR\u2032 nhd+4\n.\nn\nhn\n\n\f257\n\nLaplace\u2013Beltrami operators\n\nFor the remainder, we have the bound\nn\nX\n1\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )rn (f, q, Xi )\nE\nsup\nsup\nq\nnhd+2\nf\nn\ni=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )rn (f, q, X)\n\nn \u0010\nX\n\u03b4n\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )kXi \u2212 qk2\nE sup\n\u2264\nd+2\nq\nnhn\ni=1\n\u0011\n\u0010\n\u03b4n\n+ n d+2 sup E K((q \u2212 X)/hn )I(X \u2208 Bn,q )kX \u2212 qk2\nq\nnhn\nn \u0010\nX\n\u03b4n\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )kXi \u2212 qk2\n\u2264\nE\nsup\nq\nnhd+2\nn\ni=1\n\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )kX \u2212 qk2\n\n+\n\n2\u03b4n\nsup EK((q \u2212 X)/hn )I(X \u2208 Bn,q )kX \u2212 qk2 .\nq\nhd+2\nn\n\n\u0011\n\nThe first expectation is bounded again by using the inequality for VC-subgraph\nclasses and the bound in this case is\ns\n\u03b4n \u0010 d+4\nA \u00111/2\nlog(A/hn )\n\u2192 0.\n= \u03b4n\nnhn log\nd+2\nh\nnhdn\nnhn\nn\nThe second expectation is bounded by replacing kX \u2212 qk2 by |Eq\u22121 (X)|2 and changing variables in the integral (as it has been done before several times). This yields\na bound of the order C\u03b4n , which also tends to 0.\nCombining the above bounds establishes (5.4). One of the versions of Talagrand's\ninequality (e.g., [10]) together with (5.5) gives with some constant K > 0 and with\nprobability at least 1 \u2212 e\u2212t\n\nn \u0010\nX\n1\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(f (Xi ) \u2212 f (q))\nsup sup\nn f q i=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(f (X) \u2212 f (q))\nr\n\u0012\n\u0013\nt\nd+2 t\nd+2\n\u2264 K hn En + hn\n.\n+\nn n\nP\nTaking t := tn := A log n with large enough A, so that n e\u2212tn < \u221e and using\nBorel-Cantelli Lemma shows that a.s. for large enough n\nn \u0010\nX\n1\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )(f (Xi ) \u2212 f (q))\nsup\nsup\nq\nnhd+2\nf\nn\ni=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )(f (X) \u2212 f (q))\ns\n\u0012\n\u0013\nA log n A log n\n\u2264 K En +\n+\nnhd+2\nnhd+2\nn\nn\n\n\u22121\nand since, in view of (5.4) and under the condition nhd+2\nn / log hn \u2192 \u221e, the right\n\u22121\nhand side tends to 0. This and (5.3) yield (5.1). (Note that nhd+2\nn / log hn \u2192 \u221e\nd+2\nimplies nhn / log n \u2192 \u221e.)\n\n\f258\n\nE. Gin\u00e9 and V. Koltchinskii\n\nThe proof of (5.1') requires the following version of Taylor's expansion of f :\n1 \u2032\u2032\n\u2032\nf (Xi ) \u2212 f (q) = f (q)(Xi \u2212 q) + f (q)(Xi \u2212 q, Xi \u2212 q)\n2\n1 \u2032\u2032\u2032\n+ f (q + \u03b8i (Xi \u2212 q))(Xi \u2212 q, Xi \u2212 q, Xi \u2212 q).\n6\nThe first two terms have been handled before, and the expectations\nr of the suph\u22121\nn\nnorms of the corresponding empirical processes were shown to be O( log\n). The\nnhd+2\nn\n\nthird term leads to bounding\n\nn \u0010\nX\n1\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )\nE\nsup\nsup\nq\nnhd+2\nf\nn\ni=1\n\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )\n\n1 \u2032\u2032\u2032\n\u00d7 f (q + \u03b8i (Xi \u2212 q))(Xi \u2212 q, Xi \u2212 q, Xi \u2212 q) ,\n6\nwhich, for f \u2032\u2032\u2032 uniformly bounded by b, is smaller than\nn \u0010\nX\nb\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )kXi \u2212 qk3\nE\nsup\nq\n6nhd+2\nn\ni=1\n\n\u0011\nbn\nsup EK((q \u2212 X)/hn )I(X \u2208 Bn,q )kX \u2212 qk3\nd+2\nq\n6nhn\nn \u0010\nX\nb\nE sup\nK((q \u2212 Xi )/hn )I(Xi \u2208 Bn,q )kXi \u2212 qk3\n\u2264\n6nhd+2\nq\nn\ni=1\n\u0011\n\u2212 EK((q \u2212 X)/hn )I(X \u2208 Bn,q )kX \u2212 qk3\n+\n\n+\n\nb\nsup EK((q \u2212 X)/hn )I(X \u2208 Bn,q )kX \u2212 qk3 ,\n3hd+2\nq\nn\n\nwhich can be handled exactly as before and shown to be of the order\n\nhn\n\ns\n\ns\n\u0010 log h\u22121 \u0011\nlog h\u22121\nn\nn\n+ hn = o\n,\nnh2n\nnhd+2\nn\n\nby the conditions on hn . Using Talagrand's inequality the same way as before,\ncompletes the proof of (5.1\u2032 ).\nWe conclude with the following theorem, whose proof is a little longer and more\ninvolved, but it is based on a methodology that is well known and well described in\nthe literature (see [6] and [7]). Its extension to the case of manifolds requires some\nwork, but is rather straightforward.\nTheorem 5.2. Let M be a compact Riemannian submanifold of dimenison d < m\nof Rm , let X, Xi be i.i.d. with law \u03bc/|\u03bc| and let K be as defined in (3.1). Assume\n\u22121\nd+4\n\u22121\nthat hn \u2192 0, nhd+2\nn / log hn \u2192 \u221e, and nhn / log hn \u2192 0. Let F be a class of\n\n\fLaplace\u2013Beltrami operators\n\n259\n\nfunctions uniformly bounded up to the third order in M. Then,\ns\n1\nnhd+2\nn\nsup sup \u2206hn ,n f (q) \u2212\n\u2206M f (q)\nlim\nn\u2192\u221e\n|\u03bc|\n2 log hn\u2212d f \u2208F q\u2208M\n\u00112 \u00111/2\n\u0010P \u0010\nd\n\u2202f\nsupf \u2208F ,q\u2208M\nj=1 \u2202xqj (q)\na.s.,\n=\n2d/2 (2\u03c0)d/4 |\u03bc|1/2\nwhere xqj denote normal coordinates centered at q.\nReferences\n[1] Belkin, M. and Niyogi, P. (2005). Towards a theoretical foundation for\nLaplacian-based manifold methods. In: Learning Theory: Proceedings of 18th\nAnnual Conference on Learning Theory, COLT 2005, P. Auer and R. Meir\n(Eds), Lecture Notes in Computer Science, vol. 3559. Springer-Verlag, pp. 486\u2013\n500. MR2203282\n[2] Billingsley, P. (1968). Convergence of Probability Measures. Wiley, New\nYork. MR0233396\n[3] Bourbaki, N. (1940). Topologie G\u00e9n\u00e9rale. Hermann, Paris. MR0004747\n[4] do Carmo, M. (1992). Riemannian Geometry. Birkh\u00e4user, Boston.\nMR1138207\n[5] Dudley, R. M. (2000). Uniform Central Limit Theorems. Cambridge Press,\nCambridge. MR1720712\n[6] Einmahl, U. and Mason, D. (2000). An empirical process approach to the\nuniform consistency of kernel-type function estimators. J. Theoret. Probab. 13\n1\u201337. MR1744994\n[7] Gin\u00e9, E. and Guillou, A. (2002). Rates of strong uniform consistency for\nmultivariate kernel density estimators. Ann. Inst. Henri Poincar\u00e9 38 907\u2013921.\nMR1955344\n[8] Hein, M., Audibert, J. Y. and Luxburg, U. V. (2005). From graphs\nto manifolds -weak and strong pointwise consistency of graph Laplacians. In:\nLearning Theory: Proceedings of 18th Annual Conference on Learning Theory,\nCOLT 2005, P. Auer and R. Meir (Eds), Lecture Notes in Computer Science,\nvol. 3559. Springer-Verlag, pp. 470\u2013485. MR2203281\n[9] Lee, J. M. (1997). Riemannian Manifolds. Springer, New York. MR1468735\n[10] Massart, P. (2000). About the constants in Talagrand's concentration inequalities for empirical processes. Ann. Probab. 28 863\u2013884. MR1782276\n[11] Pelletier, B. (2005). Kernel density estimation on Riemannian manifolds.\nStatistics and Probability Letters 73 297\u2013304. MR2179289\n[12] Sakai, T. (1996). Riemannian Geometry. AMS, Providence.\n[13] Smolyanov, O. G., Weizs\u00e4cker, H.V. and Wittich, O. (2004). Chernoff's theorem and discrete time approximations of Brownian Motion on manifolds. Preprint, available at: http://lanl.arxiv.org/abs/math.PR/0409155.\n[14] Talagrand, M. (1996). New concentration inequalities in product spaces.\nInventiones Math. 126 505\u2013563. MR1419006\n\n\f"}