{"id": "http://arxiv.org/abs/cs/0603049v1", "guidislink": true, "updated": "2006-03-13T10:43:45Z", "updated_parsed": [2006, 3, 13, 10, 43, 45, 0, 72, 0], "published": "2006-03-13T10:43:45Z", "published_parsed": [2006, 3, 13, 10, 43, 45, 0, 72, 0], "title": "State Space Realizations and Monomial Equivalence for Convolutional\n  Codes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cs%2F0508012%2Ccs%2F0508014%2Ccs%2F0508124%2Ccs%2F0508097%2Ccs%2F0508021%2Ccs%2F0508044%2Ccs%2F0508107%2Ccs%2F0508103%2Ccs%2F0508008%2Ccs%2F0508083%2Ccs%2F0508120%2Ccs%2F0508132%2Ccs%2F0508119%2Ccs%2F0508085%2Ccs%2F0508032%2Ccs%2F0508067%2Ccs%2F0508053%2Ccs%2F0508003%2Ccs%2F0603111%2Ccs%2F0603015%2Ccs%2F0603126%2Ccs%2F0603024%2Ccs%2F0603026%2Ccs%2F0603091%2Ccs%2F0603067%2Ccs%2F0603057%2Ccs%2F0603007%2Ccs%2F0603092%2Ccs%2F0603036%2Ccs%2F0603088%2Ccs%2F0603132%2Ccs%2F0603014%2Ccs%2F0603008%2Ccs%2F0603041%2Ccs%2F0603054%2Ccs%2F0603009%2Ccs%2F0603108%2Ccs%2F0603028%2Ccs%2F0603082%2Ccs%2F0603001%2Ccs%2F0603040%2Ccs%2F0603076%2Ccs%2F0603099%2Ccs%2F0603037%2Ccs%2F0603112%2Ccs%2F0603059%2Ccs%2F0603033%2Ccs%2F0603095%2Ccs%2F0603003%2Ccs%2F0603013%2Ccs%2F0603039%2Ccs%2F0603032%2Ccs%2F0603048%2Ccs%2F0603130%2Ccs%2F0603105%2Ccs%2F0603062%2Ccs%2F0603042%2Ccs%2F0603017%2Ccs%2F0603004%2Ccs%2F0603125%2Ccs%2F0603110%2Ccs%2F0603047%2Ccs%2F0603100%2Ccs%2F0603084%2Ccs%2F0603096%2Ccs%2F0603011%2Ccs%2F0603094%2Ccs%2F0603010%2Ccs%2F0603074%2Ccs%2F0603022%2Ccs%2F0603038%2Ccs%2F0603063%2Ccs%2F0603030%2Ccs%2F0603052%2Ccs%2F0603120%2Ccs%2F0603016%2Ccs%2F0603045%2Ccs%2F0603056%2Ccs%2F0603083%2Ccs%2F0603118%2Ccs%2F0603080%2Ccs%2F0603058%2Ccs%2F0603029%2Ccs%2F0603065%2Ccs%2F0603093%2Ccs%2F0603069%2Ccs%2F0603051%2Ccs%2F0603107%2Ccs%2F0603079%2Ccs%2F0603078%2Ccs%2F0603050%2Ccs%2F0603098%2Ccs%2F0603116%2Ccs%2F0603075%2Ccs%2F0603023%2Ccs%2F0603049%2Ccs%2F0603127%2Ccs%2F0603102%2Ccs%2F0603123%2Ccs%2F0603087%2Ccs%2F0603089&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "State Space Realizations and Monomial Equivalence for Convolutional\n  Codes"}, "summary": "We will study convolutional codes with the help of state space realizations.\nIt will be shown that two such minimal realizations belong to the same code if\nand only if they are equivalent under the full state feedback group. This\nresult will be used in order to prove that two codes with positive Forney\nindices are monomially equivalent if and only if they share the same adjacency\nmatrix. The adjacency matrix counts in a detailed way the weights of all\npossible outputs and thus contains full information about the weights of the\ncodewords in the given code.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cs%2F0508012%2Ccs%2F0508014%2Ccs%2F0508124%2Ccs%2F0508097%2Ccs%2F0508021%2Ccs%2F0508044%2Ccs%2F0508107%2Ccs%2F0508103%2Ccs%2F0508008%2Ccs%2F0508083%2Ccs%2F0508120%2Ccs%2F0508132%2Ccs%2F0508119%2Ccs%2F0508085%2Ccs%2F0508032%2Ccs%2F0508067%2Ccs%2F0508053%2Ccs%2F0508003%2Ccs%2F0603111%2Ccs%2F0603015%2Ccs%2F0603126%2Ccs%2F0603024%2Ccs%2F0603026%2Ccs%2F0603091%2Ccs%2F0603067%2Ccs%2F0603057%2Ccs%2F0603007%2Ccs%2F0603092%2Ccs%2F0603036%2Ccs%2F0603088%2Ccs%2F0603132%2Ccs%2F0603014%2Ccs%2F0603008%2Ccs%2F0603041%2Ccs%2F0603054%2Ccs%2F0603009%2Ccs%2F0603108%2Ccs%2F0603028%2Ccs%2F0603082%2Ccs%2F0603001%2Ccs%2F0603040%2Ccs%2F0603076%2Ccs%2F0603099%2Ccs%2F0603037%2Ccs%2F0603112%2Ccs%2F0603059%2Ccs%2F0603033%2Ccs%2F0603095%2Ccs%2F0603003%2Ccs%2F0603013%2Ccs%2F0603039%2Ccs%2F0603032%2Ccs%2F0603048%2Ccs%2F0603130%2Ccs%2F0603105%2Ccs%2F0603062%2Ccs%2F0603042%2Ccs%2F0603017%2Ccs%2F0603004%2Ccs%2F0603125%2Ccs%2F0603110%2Ccs%2F0603047%2Ccs%2F0603100%2Ccs%2F0603084%2Ccs%2F0603096%2Ccs%2F0603011%2Ccs%2F0603094%2Ccs%2F0603010%2Ccs%2F0603074%2Ccs%2F0603022%2Ccs%2F0603038%2Ccs%2F0603063%2Ccs%2F0603030%2Ccs%2F0603052%2Ccs%2F0603120%2Ccs%2F0603016%2Ccs%2F0603045%2Ccs%2F0603056%2Ccs%2F0603083%2Ccs%2F0603118%2Ccs%2F0603080%2Ccs%2F0603058%2Ccs%2F0603029%2Ccs%2F0603065%2Ccs%2F0603093%2Ccs%2F0603069%2Ccs%2F0603051%2Ccs%2F0603107%2Ccs%2F0603079%2Ccs%2F0603078%2Ccs%2F0603050%2Ccs%2F0603098%2Ccs%2F0603116%2Ccs%2F0603075%2Ccs%2F0603023%2Ccs%2F0603049%2Ccs%2F0603127%2Ccs%2F0603102%2Ccs%2F0603123%2Ccs%2F0603087%2Ccs%2F0603089&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We will study convolutional codes with the help of state space realizations.\nIt will be shown that two such minimal realizations belong to the same code if\nand only if they are equivalent under the full state feedback group. This\nresult will be used in order to prove that two codes with positive Forney\nindices are monomially equivalent if and only if they share the same adjacency\nmatrix. The adjacency matrix counts in a detailed way the weights of all\npossible outputs and thus contains full information about the weights of the\ncodewords in the given code."}, "authors": ["Heide Gluesing-Luerssen", "Gert Schneider"], "author_detail": {"name": "Gert Schneider"}, "author": "Gert Schneider", "links": [{"href": "http://arxiv.org/abs/cs/0603049v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/cs/0603049v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cs.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.IT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.OC", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/cs/0603049v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/cs/0603049v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "State Space Realizations and Monomial Equivalence for\nConvolutional Codes\n\narXiv:cs/0603049v1 [cs.IT] 13 Mar 2006\n\nHeide Gluesing-Luerssen\u2217 , Gert Schneider\u2217\nMarch 13, 2006\n\nAbstract: We will study convolutional codes with the help of state space realizations.\nIt will be shown that two such minimal realizations belong to the same code if and only if\nthey are equivalent under the full state feedback group. This result will be used in order to\nprove that two codes with positive Forney indices are monomially equivalent if and only if\nthey share the same adjacency matrix. The adjacency matrix counts in a detailed way the\nweights of all possible outputs and thus contains full information about the weights of the\ncodewords in the given code.\nKeywords: Convolutional codes, minimal realizations, weight adjacency matrix, monomial equivalence\nMSC (2000): 94B10, 94B05, 93B15, 93B20\n\n1\n\nIntroduction\n\nIn the theory of linear block codes the Equivalence Theorem of MacWilliams [12, 13] tells us\nthat two block codes are isometric if and only if they are monomially equivalent, that is, if\nthey differ only by permutation and rescaling of the coordinates. In other words, the intrinsic\nnotion of isometry coincides with the extrinsically defined concept of monomial equivalence.\nThis theorem became the cornerstone of the notion of equivalence for block codes and allows\nus to classify these codes. Since the discovery of the importance of linear block codes over Z4\nfor nonlinear codes, the Equivalence Theorem has enjoyed various generalizations to block\ncodes over certain finite rings, see for instance the articles [18, 19, 6, 1].\nFor convolutional codes a classification, taking all relevant parameters of the code into\naccount, has not yet been established. In other words, it is not yet clear as to when two\nsuch codes should be identified. In this paper we want to contribute to this issue by showing that the adjacency matrix forms a complete invariant under monomial equivalence for\nconvolutional codes with positive Forney indices.\nThe adjacency matrix of a code counts in a very detailed and systematic way the weights of\ncodeword coefficients. It will be introduced in Section 3, and its properties, as found in [4, 5],\nwill be briefly summarized. All that will indicate that it forms an adequate generalization of\nthe classical weight enumerator for block codes. The adjacency matrix is defined via suitable\nstate space realizations of reduced encoders. In this sense, our approach follows a series\nof papers where convolutional codes have been investigated successfully by system-theoretic\nmethods, see, e. g., [17, 16, 9]. Since for a given code neither the reduced encoders nor\nUniversity of Groningen, Department of Mathematics, P. O. Box 800, 9700 AV Groningen, The Netherlands; gluesing@math.rug.nl, schneider@math.rug.nl\n\u2217\n\n1\n\n\fthe associated realizations are unique, we will first discuss in detail the relationship between\nany two minimal realizations for a given code. This is accomplished in Section 2 by making\nuse of classical realization theory. It turns out that, in essence, two minimal realizations\nbelong to the same code if and only if they are equivalent under the full state feedback\ngroup. In Section 3 the weight adjacency matrix associated with a minimal realization will\nbe introduced. The only-if part of the theorem just mentioned will provide us with an easy\nway to turn this matrix into an invariant of the code. Finally, the if-part together with\nMacWilliams' Equivalence Theorem for block codes will lead to our main result stating that\ntwo convolutional codes with positive Forney indices are monomially equivalent if and only\nif they share the same adjacency matrix. This result is not true for codes where at least one\nForney index is zero; in particular it is not true for block codes (of dimension bigger than\none), which, of course, is a well known fact.\nWe strongly believe that our main theorem will be helpful in order to establish an appropriate notion of equivalence, and thus a useful classification, for convolutional codes. It\nshould be clear that a reasonable notion of equivalence should involve those (vector space)\nisometries that leave all error-correcting properties of the code invariant. Since the adjacency\nmatrix comprises many of the parameters characterizing these properties [4, Sec. 3] we believe\nthat it is reasonable to require this matrix to be invariant under code equivalence. In this\nsense our main theorem can be regarded as a generalization of MacWilliams' Equivalence\nTheorem to convolutional codes with positive Forney indices. However, the result does not\ntell us how in general an adequate notion of code equivalence should look like, and we have\nto leave this open for future research.\nWe end the introduction with recalling the basic notions for convolutional codes as needed\nin this paper. Let F be a finite field. A k-dimensional convolutional code of length n is a\nsubmodule C of F[z]n of the form\nC = im G := {uG u \u2208 F[z]k }\nwhere G is a basic matrix in F[z]k\u00d7n , i. e.\nrk G(\u03bb) = k for all \u03bb \u2208 F,\n\n(1.1)\n\nwith F being an algebraic closure of F. In other words, G is noncatastrophic and delay-free.\nWe call such a matrix G an encoder, and the number\ndeg(C) := deg(G) := max{deg(M ) | M is a k-minor of G}\n\n(1.2)\n\nis said to be the degree of the encoder GPor of the code C. A matrix G \u2208 F[z]k\u00d7n with rows\ng1 , . . . , gk \u2208 F[z]n is said to be reduced if ki=1 deg(gi ) = deg(G). Here deg(gi ) denotes the ith\nrow degree, i. e., the maximal degree of the entries in the ith row of G. For characterizations\nof reducedness see, e. g., [2, Main Thm.] or [14, Thm. A.2]. It is well known [2, p. 495] that\neach convolutional code C admits a reduced encoder G. The row degrees deg(gi ) of a reduced\nencoder G are, up to ordering, uniquely determined by the code and are called the Forney\nindices of the code or of the encoder. It follows that a convolutional code has a constant\nencoder matrix if and only if the degree is zero. In that case the code is, in a natural way, a\nblock code.\n\n2\n\nState Space Descriptions of Reduced Encoders\n\nIn this section we will study state space descriptions of convolutional codes and discuss their\nnon-uniqueness. More precisely, we will fix a code C = im G and concentrate on the encoding\n2\n\n\fprocess\nG : F[z]k \u2212\u2192 C,\n\nu 7\u2212\u2192 v := uG\n\n(2.1)\n\nfor various (reduced) encoders G \u2208 F[z]k\u00d7n . Obviously, the encoding (2.1) can be interpreted\nas a dynamical input-output system and thus can be described as a state space system in the\nsystem theoretic sense. In this section we will describe all possible state space descriptions of\na given code C with minimal state space dimension and investigate their relation to each other.\nThe main difficulty will be the non-uniqueness of the encoder matrix G. The considerations\nof this section are, of course, closely related to classical realization theory, and can be deduced\nstraightforwardly. However, the polynomial rather than proper rational setting and the fact\nthat not the encoder but rather the code is the object under consideration lead to certain\ndifferences, and we consider it worth deriving the results in detail. Of course, we will make\nuse of classical realization theory. It is worth mentioning that the results of this section are\ntrue for arbitrary fields F and do not require the finiteness of F.\nIn order to use standard notation of systems theory it will be most convenient to associate\nthe proper rational transfer matrix\nTG (z) := G(z \u22121 ) \u2208 F(z)k\u00d7n\n\n(2.2)\n\nto a polynomial matrix G \u2208 F[z]k\u00d7n . Notice that the transfer function TG is polynomial\nin z \u22121 , or, in other words, TG does not have any poles in F\\{0}. Recall that the McMillan\ndegree \u03b4M (T ) of a proper rational matrix T \u2208 F(z)k\u00d7n can be defined as \u03b4M (T ) := deg(det Q)\nwhere\nT = Q\u22121 P is a coprime factorization with matrices Q \u2208 F[z]k\u00d7k , P \u2208 F[z]k\u00d7n .\n\n(2.3)\n\nCoprimeness of the factorization Q\u22121 P simply means that the matrix [Q, P ] is basic. It is\nwell known that such a factorization always exists (e. g., the Smith-McMillan form), and the\nMcMillan degree does not depend on the choice of the coprime factorization.\nProposition 2.1 Let G \u2208 F[z]k\u00d7n be a polynomial matrix and let TG be as in (2.2). Then\n\u03b4M (TG ) \u2265 deg(G). Moreover, if G is reduced then \u03b4M (TG ) = deg(G).\nProof: Let \u03b4M (TG ) = \u03b3 and deg(G) = \u03b4. Since all possible poles of TG are at\nP\u03b4zero wei\nknow that TG has a factorization as in (2.3) such that det Q = z \u03b3 . Let m :=\ni=0 mi z\n\u22121\nbe a k-minorPof G of degree \u03b4. Then P (z) = Q(z)G(z ) being polynomial implies that\nz \u03b3 m(z \u22121 ) = \u03b4i=0 mi z \u03b3\u2212i is polynomial. Since m\u03b4 6= 0 this yields \u03b3 \u2265 \u03b4.\nLet now G be reduced and\nof G. Moreover, for i = 1, . . . , k let\nP\u03bdi1 , . . . , \u03bdl k be the row degrees\ngi,l z where gi,l \u2208 Fn . Then\nthe ith row of G be gi = \u03bdl=0\nTG (z) = diag(z \u03bd1 , . . . , z \u03bdk )\u22121\n\n\u03bdi\n\u0010X\nl=0\n\ngi,\u03bdi \u2212l z l\n\n\u0011\n\ni=1,...,k\n\n.\n\n(2.4)\n\nNow reducedness of G implies that the rightmost matrix has full row rank for z = 0, see [2,\nMain Thm.]. This in turn yields that (2.4) is a coprime polynomial factorization of TG , and\nwe obtain the desired result.\n\u2737\nThe last statement of Proposition 2.1 is not an if-and-only-if statement. This can easily\nbe verified using the matrix in (2.8) below.\nLet us now turn to state space realizations of encoders. Before we briefly recall some\nwell known results from realization theory as to be found, e. g., in [11, Ch. 6], let us remind\n3\n\n\fthat transfer matrices act on input vectors from the right, see (2.1). Taking the according\nnotational changes into account we obtain that each proper rational matrix T \u2208 F(z)k\u00d7n has\na realization (A, B, C, D) \u2208 F\u03b4\u00d7\u03b4+k\u00d7\u03b4+\u03b4\u00d7n+k\u00d7n , meaning that T (z) = B(zI \u2212 A)\u22121 C + D.\nFurthermore, \u03b4 \u2265 \u03b4M (T ), and \u03b4 = \u03b4M (T ) if and only if (A, B, C, D) is controllable and\nobservable, that is,\n\uf8eb\n\uf8f6\nB\n\uf8ec BA \uf8f7\n\u0001\n\uf8ec\n\uf8f7\nrk \uf8ecBA2 \uf8f7 = \u03b4 and rk C AC A2 C . . . = \u03b4.\n\uf8ed\n\uf8f8\n..\n.\n\nControllable and observable realizations for a given T \u2208 F(z)k\u00d7n do always exist. They are\nunique up to similarity; precisely, given two such realizations (A, B, C, D) and (\u0100, B\u0304, C\u0304, D\u0304)\nof T then there exists a matrix S \u2208 GL\u03b4 (F) such that\n(\u0100, B\u0304, C\u0304, D\u0304) = (SAS \u22121 , BS \u22121 , SC, D).\n\n(2.5)\n\nAssume now that T = TG for some matrix G \u2208 F[z]k\u00d7n with full row rank. Thus the only\npoles (if any) of the rational matrix T are at zero. One can show straightforwardly that any\nrealization (A, B, C, D) of T leads to the equivalence\n\u001a\n\u001b\nxt+1 = xt A + ut B\nv = uG \u21d0\u21d2\nfor all t \u2265 0 where x0 = 0\n(2.6)\nvt = x t C + u t D\nP\nP\nfor any u = t\u22650 ut z t \u2208 F[z]k and v = t\u22650 vt z t \u2208 F[z]n , see also [4, Thm. 2.3]. Indeed, the\nstate vectors xt are given as the coefficients of the polynomial x = uB(z \u22121 I \u2212 A)\u22121 . Due to\nthis interpretation we simply call the quadruple (A, B, C, D) a (state space) system over F.\nThe discussion gives rise to the following definition.\nDefinition 2.2 Let (A, B, C, D) \u2208 F\u03b4\u00d7\u03b4+k\u00d7\u03b4+\u03b4\u00d7n+k\u00d7n be a system over F.\n(1) Let G \u2208 F[z]k\u00d7n be a polynomial matrix with full row rank. Then (A, B, C, D) is said to\nbe a realization of order \u03b4 of G if\nG(z) = B(z \u22121 I \u2212 A)\u22121 C + D.\nAs usual, the system is called canonical if it is controllable and observable.\n(2) We call (A, B, C, D) a realization of the code C \u2286 F[z]n if there exists an encoder G \u2208\nF[z]k\u00d7n of C such that (A, B, C, D) is a realization of G. If G is reduced and (A, B, C, D)\nis a canonical realization of G, then it is said to be a canonical minimal realization of C.\nSince a realization of G is, by definition, a realization of the proper matrix TG in the\nsystem theoretic sense, it follows from the discussion above that each\n\u0001 polynomial matrix G\nhas a realization, and the order of any realization is at least \u03b4M TG . Each such G also has\na canonical\nrealization, and a given realization is canonical if and only if its order equals\n\u0001\n\u03b4M TG . Any two canonical realizations (A, B, C, D) and (\u0100, B\u0304, C\u0304, D\u0304) of G are similar in\nthe sense of (2.5). Moreover, due to Proposition 2.1 a realization of a reduced matrix G\nis canonical if and only if it has order deg(G). Finally, each code has a canonical minimal\nrealization; it has order deg(C). Let us also note that in the special case where deg(C) = 0,\ni. e., C is a block code, the matrices A, B, C of a canonical minimal realization do not exist\nand D = G, where G is a constant encoder of C.\nWe will single out a particularly simple realization of a given encoder.\n4\n\n\fk\u00d7n be a polynomial matrix with rank k and row degrees\nProposition 2.3 Let\nPkG \u2208 F[z]\nPi\ngi,l z l , i = 1, . . . , k, where gi,l \u2208 Fn .\n\u03bd1 , . . . , \u03bdk . Put \u03b4 := i=1 \u03bdi . Let G have rows gi = \u03bdl=0\nFor i = 1, . . . , k define the matrices\n\uf8f6\n\uf8eb\n!\ngi,1\n01\n\u0001\n\uf8f7\n\uf8ec\n..\nAi =\n\u2208 F\u03bdi \u00d7\u03bdi , Bi = 1 0 * * * 0 \u2208 F\u03bdi , Ci = \uf8ed ... \uf8f8 \u2208 F\u03bdi \u00d7n .\n.\n1\n0\ngi,\u03bdi\n\nThen the controller form of G is defined as the matrix quadruple (A, B, C, D) \u2208 F\u03b4\u00d7\u03b4 \u00d7Fk\u00d7\u03b4 \u00d7\nF\u03b4\u00d7n \u00d7 Fk\u00d7n where\n!\n!\n!\ng1,0 !\nC1\nB1\nA1\n.. , D =\n..\n..\n..\n,C=\n,B=\n= G(0).\nA=\n.\n.\n.\n.\nAk\n\nBk\n\nCk\n\ngk,0\n\nIn the case where \u03bdi = 0 the ith block is missing and in B a zero row occurs. The following\nis true.\n(i) The controller form (A, B, C, D) forms a controllable realization of the matrix G.\n\u0013\n\u0012\n\u2212A C\n= \u03b4 + k.\n(ii) G is reduced if and only if rk \u2212B\nD\n(iii) If G is reduced, then the controller form is a canonical realization.\nProof: Part (i) is proved in [4, Prop. 2.1] and part (ii) can be checked directly1 . Part (iii)\nis a consequence of (i) and (ii) since observability is equivalent to rk (\u03bbI \u2212 A, C) = \u03b4 for all\n\u03bb \u2208 F which, due to nilpotency of A, is equivalent to rk (\u2212A, C) = \u03b4. But the latter follows\nfrom (ii).\n\u2737\nIt is well known, and can also straightforwardly be shown, that if G is reduced the controller form is the shift realization of the coprime factorization (2.4) of TG as introduced and\ndiscussed in detail by Fuhrmann [3, Thm. 10-1].\nWe will now investigate those canonical systems (A, B, C, D) that give rise to a polynomial\nbasic and reduced encoder matrix G(z) = B(z \u22121 I \u2212 A)\u22121 C + D.\nTheorem 2.4 Let (A, B, C, D) \u2208 F\u03b4\u00d7\u03b4+k\u00d7\u03b4+\u03b4\u00d7n+k\u00d7n be a canonical system and put G :=\nB(z \u22121 I \u2212 A)\u22121 C + D \u2208 F(z)k\u00d7n . Then G is a polynomial matrix if and only if A is nilpotent.\nIf A is nilpotent one also has the following.\n\u0013\n\u0012\n\u2212A C\n= \u03b4 + k for all\n(a) G is a basic polynomial matrix if and only if rk D = k and rk \u03bbI\u2212B\nD\n\u03bb \u2208 F\\{0}.\n\u0012\n\n\u0013\n\n\u2212A C\n= \u03b4 + k.\n(b) If G is a reduced polynomial matrix then rk \u2212B\nD\nSummarizing, if G is a basic and reduced polynomial matrix then\n\u0012\n\u0013\n\u03bbI \u2212 A C\nA nilpotent, rk D = k, rk\n= \u03b4 + k for all \u03bb \u2208 F.\n(2.7)\n\u2212B\nD\nP\ni\u22121 Cz i . This shows immediately\nProof: For the first statement notice that G = D+ \u221e\ni=1 BA\nthe if-part. On the other hand, if G is polynomial then there exists an index N \u2208 N such\nthat BAi C = 0 for i \u2265 N . Thus\n\uf8eb\n\uf8f6\n\uf8eb\n\uf8f6\nB\nB\n\uf8ec BA \uf8f7\n\uf8f7\n\u0001 \uf8ec\n\u0001\n\uf8ec\n\uf8f7\n\uf8ec BA \uf8f7\n0 = \uf8ecBA2 \uf8f7 AN C AN +1 C AN +2 C * * * = \uf8ecBA2 \uf8f7 AN C AC A2 C * * * .\n\uf8ed\n\uf8f8\n\uf8ed\n\uf8f8\n..\n..\n.\n.\n1\n\nThe equivalence given in [4, (2.2)] is false in general. It is true, however, if all row degrees of G are positive.\n\n5\n\n\fNow controllability and observability yield AN = 0 as desired.\n(a) By nilpotency of A the matrix \u03bbI \u2212 A is regular for \u03bb 6= 0. Thus\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u03bbI \u2212 A C\n\u03bbI \u2212 A\nC\n\u03bbI \u2212 A\nC\nrk\n= rk\n= rk\n.\n\u2212B\nD\n0\nD + B(\u03bbI \u2212 A)\u22121 C\n0\nG(\u03bb\u22121 )\nSince G(0) = D this yields that G is basic iff rk\nrk D = k.\n\n\u0012\n\n\u03bbI \u2212 A\n\u2212B\n\nC\nD\n\n\u0013\n\n= \u03b4 + k for all \u03bb \u2208 F\\{0} and\n\n(b) Let G be reduced and consider the controller form (A, B, C, D) of G. Then the required\nrank condition is satisfied by Proposition 2.3(ii). By part (iii) of that proposition the controller form is canonical. Now (b) follows for arbitrary canonical realizations by \u0012using the\u0013\n\u2212A C\nfacts that each such realization is similar to the controller form and that the rank of \u03bbI\u2212B\nD\nis invariant under similarity.\n\u2737\nRemark 2.5 Using the transformation T = TG part (a) of the last theorem is a particular\ninstance of the well-known system theoretic fact that the transmission zeros (i. e., the zeros\nof the transfer matrix) coincide with the invariant zeros of a canonical realization (i. e., the\nzeros of the rightmost matrix in (2.7)), see for instance [11, p. 578]. Part (b) reflects the\nfact that row reduced matrices have no zeros at infinity, see [11, 6.5.-19, p. 468]. Indeed, by\ndefinition G has a zero at infinity if TG has a zero at zero, meaning that rk P (0) < k for a\ncoprime factorization Q\u22121 P = TG . But if G is reduced then the factorization in (2.4) shows\nthat TG has no zeros at zero. The converse of Theorem 2.4(b), and thus the converse of this\nlast statement, is not true. This can be seen from the system\n\uf8f6\n\uf8eb\n\u0013\n\u0012\nz 0 0 1\nzI \u2212 A C\n= \uf8ed 1 0 1 1 \uf8f8 \u2208 F3 [z]3\u00d74 .\n\u2212B\nD\n2 1 0 0\n\nThe system is controllable and observable and satisfies (2.7). But the corresponding polynomial matrix\n\u0012\n\u0013\n0 1 1 + 2z\n\u22121\n\u22121\nG = B(z I \u2212 A) C + D =\n(2.8)\n1 0\nz\n\nis not reduced. As a consequence, (A, B, C, D) is not a canonical minimal realization of the\ncode C = im G in the sense of Definition 2.2. It can also be checked straightforwardly that\nthe matrix TG has no zeros at zero.\nNotice that any system satisfying (2.7) is observable (but not necessarily controllable). It\nshould also be observed that conversely, even if the first two conditions of (2.7) are satisfied\nand the system is controllable, observability does not imply the last condition of (2.7). For\ninstance, the system over F2 given by\n\u0012\n\u0013\n\u0012\n\u0013\n\u0001\n\u0001\n0 1\n0 1\nA=\n, B= 1 0 , C=\n, D= 1 1\n0 0\n1 0\n\nis controllable and observable and satisfies the first two\u0001 conditions of (2.7), but not the last\none. Its encoder matrix is given by G = 1 + z 1 + z 2 which is not basic.\nLet us now turn to canonical realizations of different reduced encoders for a given code.\nThe following lemma will be crucial.\n\n6\n\n\fLemma 2.6 Let (A, B, C, D) \u2208 F\u03b4\u00d7\u03b4+k\u00d7\u03b4+\u03b4\u00d7n+k\u00d7n satisfy (2.7). Furthermore, let M \u2208 F\u03b4\u00d7k\nand put\n\u0100 = A \u2212 M B, B\u0304 = B, C\u0304 = C \u2212 M D, D\u0304 = D.\n(2.9)\nSuppose that \u0100 is nilpotent. Then\n(a) (\u0100, B\u0304, C\u0304, D\u0304) satisfies (2.7),\n\u0001\n(b) B(z \u22121 I \u2212 A)\u22121 C + D = V (z) B\u0304(z \u22121 I \u2212 \u0100)\u22121 C\u0304 + D\u0304 where V (z) := I + B(z \u22121 I \u2212 A)\u22121 M ,\n(c) V \u2208 GLk (F[z]).\n\nProof: (a) It suffices to observe that\n\u0012\n\u0013 \u0012\n\u0013\u0012\n\u0013\n\u03bbI \u2212 \u0100 C\u0304\nI \u2212M\n\u03bbI \u2212 A C\n=\n.\n\u2212B\u0304\nD\u0304\n0\nI\n\u2212B\nD\n\u0001\u22121\n(b) First notice that B(z \u22121 I \u2212 A + M B)\u22121 = I + B(z \u22121 I \u2212 A)\u22121 M\nB(z \u22121 I \u2212 A)\u22121 .\nPutting G(z) := B(z \u22121 I \u2212 A)\u22121 C + D and \u1e20(z) := B\u0304(z \u22121 I \u2212 \u0100)\u22121 C\u0304 + D\u0304 we compute\n\u0001\u22121\n\u0001\nV (z)\u22121 G(z) = I + B(z \u22121 I \u2212 A)\u22121 M\nB(z \u22121 I \u2212 A)\u22121 C + D\n\u0001\u22121\n\u0001\n= I + B(z \u22121 I \u2212 A)\u22121 M\nB(z \u22121 I \u2212 A)\u22121 (C \u2212 M D) + B(z \u22121 I \u2212 A)\u22121 M D + D\n\u0001\u22121\n\u0001\n= B(z \u22121 I \u2212A+M B)\u22121 (C \u2212M D) + I +B(z \u22121 I \u2212A)\u22121 M\nB(z \u22121 I \u2212A)\u22121 M D+D\n= B(z \u22121 I \u2212 A + M B)\u22121 (C \u2212 M D) + D\n\n= \u1e20(z).\n(c) Observe that V \u2208 F[z]k\u00d7k by nilpotency of A. Moreover, det V 6\u2261 0. From Theorem 2.4\nwe know that G and \u1e20 are both polynomial and basic. Hence the unimodularity of V follows\nfrom (b).\n\u2737\nOne should observe that Identity (b) above does not require nilpotency of A. After\ntransformation z 7\u2192 z \u22121 , this identity for the transfer functions of state feedback equivalent\nsystems is also known from systems theory and can in particular cases be deduced from,\nfor instance, [11, Sec. 7.2.1]. Our very particular situation makes V even a unimodular\npolynomial matrix.\nNow we can prove the main result of this section.\nTheorem 2.7 Let G, \u1e20 \u2208 F[z]k\u00d7n be basic and reduced and let deg(G) = deg(\u1e20) = \u03b4. Let\n(A, B, C, D) and (\u0100, B\u0304, C\u0304, D\u0304) be associated canonical realizations, respectively. Then the\nfollowing are equivalent.\n(i) G = W \u1e20 for some W \u2208 GLk (F[z]).\n(ii) The systems (A, B, C, D) and (\u0100, B\u0304, C\u0304, D\u0304) are equivalent under the full state feedback\ngroup, that is, there exist matrices T \u2208 GL\u03b4 (F), U \u2208 GLk (F), M \u2208 F\u03b4\u00d7k such that\n\u0100 = T \u22121 (A \u2212 M B)T, B\u0304 = U BT, C\u0304 = T \u22121 (C \u2212 M D), D\u0304 = U D.\n\n(2.10)\n\nProof: (ii) \u21d2 (i): By Theorem 2.4 both realizations satisfy (2.7). Hence we may apply\nLemma 2.6(b) and compute\n\u0001\n\u1e20 = U BT (z \u22121 I \u2212 T \u22121 (A \u2212 M B)T )\u22121 T \u22121 (C \u2212 M D) + D\n\u0001\n\u0001\n= U B(z \u22121 I \u2212 A + M B)\u22121 (C \u2212 M D) + D = U V \u22121 (z) B(z \u22121 I \u2212 A)\u22121 C + D\n7\n\n\fwhere V (z) := I + B(z \u22121 I \u2212 A)\u22121 M . Now Lemma 2.6(c) yields (i).\n(i) \u21d2 (ii): First notice that equivalence under the full state feedback group is indeed an equivalence relation. Since the controller form of a reduced matrix is canonical and all canonical\nrealizations are similar, we may assume without loss of generality that both (A, B, C, D)\nand (\u0100, B\u0304, C\u0304, D\u0304) are in controller form. Assumption (i) implies that G and \u1e20 have the\nsame row degrees. Since reordering of the rows of G corresponds to a transformation\n(T \u22121 AT, U BT, T \u22121 C, D) that retains the specific form of the controller form we may further assume that G and \u1e20 both have row degrees \u03bd1 \u2265 . . . \u2265 \u03bdk . Then A = \u0100 and B = B\u0304\nsince they are both fully determined by the row degrees. Due to reducedness of G and \u1e20 the\nith row of W has degree at most \u03bdi for i = 1, . . . , k, see [2, Main Thm. (4)]. We will show\nnow that\n\u0001\nW = I + B(z \u22121 I \u2212 A)\u22121 M U \u22121 for some M \u2208 F\u03b4\u00d7k , U \u2208 GLk (F).\n(2.11)\n\nThen U := W (0)\u22121 . Hence we need to \u0010find M such\u0011that B(z \u22121 I \u2212 A)\u22121 M = W U \u2212 I. The\nP\u03bd i\nj\nlatter matrix is of the form W U \u2212 I =\nfor suitable aij \u2208 Fk . Using that\nj=1 aij z\ni=1,...,k\n\nB(z\n\n\u22121\n\n\u22121\n\nI \u2212 A)\n\n\uf8eb\n\nz z2 * * *\n\nz \u03bd1\n\nz z2 * * *\n\n\uf8ec\n\uf8ec\n=\uf8ec\n\uf8ed\n\n\uf8f6\n\nz \u03bd2\n..\n\n.\nz z2 * * *\n\nz \u03bdk\n\n\uf8f7\n\uf8f7\n\uf8f7,\n\uf8f8\n\none sees that the matrix M = (M1 , . . . , Mk )T where Mi = (ai1T , . . . , ai\u03bdiT ), satisfies (2.11).\nNotice that if \u03bdi = 0 the result is true as well since in that case the ith block of M is\n\u22121\n\u22121\nmissing and a zero row appears\n\u0001 \u22121in W U \u2212 I and B(z I \u2212 A) . Now we have the identity\n\u22121\n\u22121\nG = I + B(z I \u2212 A) M U \u1e20 which in turn implies\nU I + B(z \u22121 I \u2212 A)\u22121 M\n\nUsing Lemma 2.6(b) this yields\n\n\u0001\u22121\n\n\u0001\nB(z \u22121 I \u2212 A)\u22121 C + D = B(z \u22121 I \u2212 A)\u22121 C\u0304 + D\u0304.\n\nU B(z \u22121 I \u2212 A + M B)\u22121 (C \u2212 M D) + U D = B(z \u22121 I \u2212 A)\u22121 C\u0304 + D\u0304 = \u1e20(z).\n\n(2.12)\n\nHence (A \u2212 M B, U B, C \u2212 M D, U D) is a realization of \u1e20 of order deg(\u1e20) and therefore\ncanonical. As a consequence, (2.12) implies that the realizations (A\u2212M B, U B, C \u2212M D, U D)\nand (A, B, C\u0304, D\u0304) are similar, and this yields (ii).\n\u2737\nRecall the notion of a canonical minimal realization of a code as given in Definition 2.2(2).\nThe result just proven tells us that two canonical minimal realizations of a given code are\nequivalent under the full state feedback group. The next example, however, shows that the\naction of the full state feedback group does in general not preserve the property of being\ncanonical minimal.\nExample 2.8 Let F = F2 and\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n0 0\n1 0\n0 1 1\n1 0 1\nA=\n, B=\n, C=\n, D=\n.\n0 0\n0 1\n0 0 1\n0 1 0\nThen (A, B, C, D) is canonical and satisfies (2.7). Moreover,\n\u0012\n\u0013\n1 z 1+z\n\u22121\n\u22121\nG = B(z I \u2212 A) C + D =\nis basic and reduced.\n0 1\nz\n8\n\n\fThus,\u0012(A, \u0013B, C, D) is a canonical minimal realization of the code C = im G. Using the feedback\nM = 01 00 and T = U = I2 the system (\u0100, B\u0304, C\u0304, D\u0304) in (2.10) leads to a nilpotent matrix \u0100\nand a non-reduced encoder matrix\n\u0012\n\u0013\n1\nz\n1+z\n\u22121\n\u22121\n\u1e20 = B\u0304(z I \u2212 \u0100) C\u0304 + D\u0304 =\n.\nz 1 + z2\nz2\nHence the realization (\u0100, B\u0304, C\u0304, D\u0304) of the code C is not canonical minimal in the sense of\nDefinition 2.2(2).\nThe last example and Proposition 2.1 suggest that the requirement of reducedness for\nencoders seems too strong for our considerations. Indeed, the results of this section become\nsomewhat smoother if we replace reducedness by semi-reducedness where we call a matrix\nG \u2208 F[z]k\u00d7n semi-reduced if \u03b4M (TG ) = deg(G). Let us briefly sketch the situation based on\nthis notion.\n\u2013 By Proposition 2.1 reducedness implies semi-reducedness, and obviously a matrix G is\nsemi-reduced if and only if each canonical realization has order deg(G).\n\u2013 One can show that G is semi-reduced if and only if TG has no zeros at zero. Recall that,\nby definition, the latter means rk P (0) = k for any coprime factorization as in (2.3).\n\u2013 Using that the zeros of TG coincide with the invariant zeros of a canonical realization [11,\np. 578] one obtains that Theorem 2.4(b) becomes an if-and-only if statement if we replace\nreducedness by semi-reducedness. As a consequence, a canonical realization (A, B, C, D)\nsatisfies (2.7) if and only if G = B(z \u22121 I\u2212A)\u22121 C+D is a basic and semi-reduced polynomial\nmatrix.\n\u2013 Even Theorem 2.7 remains valid if we replace reducedness by semi-reducedness. Let us\nbriefly outline the idea of the proof. The proof of the direction (ii) \u21d2 (i) does not change\nat all. For the converse direction one first brings G into reduced form \u0174 G = \u011c where\n\u0174 \u2208 GLk (F[z]). Then it is not hard to see that, due to semi-reducedness of G, the ith row\ndegree of \u0174 is less or equal the ith row degree of \u011c. This allows us to proceed as in the\nproof of Theorem 2.7 and to show that (A, B, C, D) is equivalent under the full feedback\ngroup to the controller form of \u011c.\n\u2013 Finally, one can easily see that each state feedback action as in (2.10), where M is such that\nA \u2212 M B is nilpotent, transforms a canonical realization (A, B, C, D) satisfying (2.7) into a\ncanonical system (\u0100, B\u0304, C\u0304, D\u0304) that also satisfies (2.7). As a consequence, semi-reducedness\nof the corresponding encoder is preserved under each such transformation.\nDespite these more elegant results we decided to base this section on reducedness rather than\nsemi-reducedness since firstly, reducedness is a well-established concept and suffices for the\nresults needed here, and secondly, the proof of Theorem 2.7 makes explicit use of reducedness\nin either case. Furthermore, in the next section we will need again the controller form of a\nreduced encoder.\n\n3\n\nThe Weight Adjacency Matrix and Monomial Equivalence\n\nIn this section we will return to the particular situation of convolutional codes as dynamical\nsystems over finite fields. Thus from now on let\nF = Fq be a finite field with q = ps elements where p is prime and s \u2208 N.\n\n9\n\n(3.1)\n\n\fBefore introducing weight counting invariants for convolutional codes let us recall the Hamming weight on Fn defined as wt(w1 , . . . , wn ) := #{i | wi 6= 0}. We will also need the weight\nenumerator of sets S \u2286 Fn given as\nwe(S) :=\n\nn\nX\n\n\u03bbi W i \u2208 Z[W ], where \u03bbi := #{v \u2208 S | wt(v) = i}.\n\n(3.2)\n\ni=0\n\nThe weight enumerator we(C) of a block code C \u2286 Fn has been investigated intensively in the\nblock coding literature. For instance, the famous MacWilliams Identity Theorem [13] tells\nus how to completely derive we(C \u22a5 ) from we(C), where C \u22a5 is the dual of C with respect to\nthe standard inner product on Fn .\nThe weight of a polynomial\nstraightforwardly by simply extending the\n\u0001 is defined\nPN vector\nPN\n(j)\nj\nHamming weight via wt\n:= j=0 wt(v (j) ) for any v (j) \u2208 Fn .\nj=0 v z\nIn order to introduce an appropriate generalization of the weight enumerator for convolutional codes we need the weight adjacency matrix of a realization. Recall the state space\nsystem (2.6). It has q \u03b4 different state vectors xt where \u03b4 is the order of the realization\n(A, B, C, D). We consider now for each pair of states (X, Y ) \u2208 F2\u03b4 all (finitely many) state\ntransitions from xt = X to xt+1 = Y via suitable input ut = u and count the weights of all\ncorresponding outputs v = XC + uD. This leads to the following definition, see also [15,\nSec. 2] and [4, Def. 3.4].\nDefinition 3.1 Let G \u2208 F[z]k\u00d7n be a basic and reduced matrix such that deg(G) = \u03b4\nand let (A, B, C, D) be a canonical realization of G. We call F\u03b4 the state space of the\nrealization. The weight adjacency matrix associated with (A, B, C, D) is defined to be the\n\u03b4\n\u03b4\nmatrix \u039b \u2208 Z[W ]q \u00d7q that is indexed by (X, Y ) \u2208 F2\u03b4 and has the entries\n\u039bX,Y := we{XC + uD | u \u2208 Fk : Y = XA + uB} \u2208 Z[W ] for (X, Y ) \u2208 F2\u03b4 .\n\n(3.3)\n\nRecall that in the case \u03b4 = 0 the matrices A, B, C do not exist while D = G. As a\nconsequence, \u039b = \u039b0,0 = we(C) is the ordinary weight enumerator we(C) of the block code\nC = {uG | u \u2208 Fk } \u2286 Fn .\nThe properties of the weight adjacency matrix have been studied in detail in the papers [4]\nand [5]. Among other things it has been discussed in detail in [4, Sec. 3] that the weight\nadjacency matrix contains full information about the extended row distances and the active\nburst distances of the convolutional code C = im G. These parameters are closely related to\nthe error-correcting performance of C and are studied intensively in the more engineeringoriented literature, see, e. g., [10, 7]. In the paper [5], alternative formulas for the entries\nof the weight adjacency matrix are given. They are used in order to formulate a conjecture\nfor a MacWilliams Identity for convolutional codes and their duals which then is proven in\nspecial cases. All this makes sense only because the weight adjacency matrix can indeed\nnicely be turned into an invariant of the code. This will be shown below. The discussion at\nthis point should have made clear that this invariant will form an appropriate generalization\nof the weight enumerator of block codes.\nExample 3.2 Let\nG=\n\n\u0012\n\nz 1 + z2 1 + z z + z2\n1\n0\n1\n1\n\n\u0013\n\n\u2208 F2 [z]2\u00d74 .\n\nThen G is basic and reduced and the controller form is given by\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n0 1\n1 0\n1 0 1 1\n0 1 1 0\nA=\n, B=\n, C=\n, D=\n.\n0 0\n0 0\n0 1 0 1\n1 0 1 1\n10\n\n\fIn order to explicitly display the weight adjacency matrix we need to fix an ordering on the\nstate space. Let us choose the lexicographic ordering, hence X1 = (0, 0), X2 = (0, 1), X3 =\n(1, 0), X4 = (1, 1). Going through all possible combinations of states X and inputs u one\nobtains the weight adjacency matrix\n\uf8eb\n\uf8f6\n1 + W3\n0\nW2 + W3\n0\n\uf8ecW 2 + W 3\n\uf8f7\n0\nW + W2\n0\n\uf8f7,\n\u039b=\uf8ec\n3\n2\n3\n\uf8ed\n0\n1+W\n0\nW +W \uf8f8\n0\nW2 + W3\n0\nW + W2\nwhere the entry at position (i, j) is \u039bXi ,Xj as defined in (3.3).\n\nThe weight adjacency matrix does not form an invariant of a code but rather depends\non the choice of both the reduced encoder and the canonical realization. This dependence,\nhowever, can nicely be described.\nTheorem 3.3 Let C \u2286 F[z]n be a code of degree \u03b4, and let (A, B, C, D) and (\u0100, B\u0304, C\u0304, D\u0304) both\nbe canonical minimal realizations of C. Furthermore, let \u039b and \u039b\u0304 be the associated weight\nadjacency matrices, respectively. Then there exists a state space isomorphism T \u2208 GL\u03b4 (F)\nsuch that\n\u039b\u0304X,Y = \u039bXT,Y T for all (X, Y ) \u2208 F2\u03b4 .\n(3.4)\nIn particular, \u039b\u0304 = P \u039bP \u22121 for some permutation matrix P \u2208 GLq\u03b4 (Z).\nThe result appeared first in [4, Remark 3.6, Theorem 4.1]. Using Theorem 2.7 we can give\nan alternative, very short proof for this theorem. Indeed, by Theorem 2.7 the two realizations\nare equivalent under the full feedback group, thus we may assume (2.10). But then one can\nstraightforwardly check that for any (X, Y, u, v) \u2208 F2\u03b4+k+n\nY = XA + uB, v = XC + uD\nis equivalent to\nY T = XT \u0100 + (uU \u22121 + XM U \u22121 )B\u0304, v = XT C\u0304 + (uU \u22121 + XM U \u22121 )D\u0304.\nSince for any given X the mapping u 7\u2212\u2192 uU \u22121 + XM U \u22121 is bijective on Fk , Equation (3.4)\nis immediate from the definition of the weight adjacency matrix.\nThe result above shows that we obtain an invariant of the code after factoring out the\neffect of the state space isomorphism T . We will introduce this invariant in Definition 3.7(b)\nbelow in a slightly more general setting by also considering field automorphisms. Thereafter\nwe will investigate the relation between two codes having the same invariant.\nLet us now turn to transformations on codes that obviously leave all relevant properties\ninvariant. It should be clear that field automorphisms are of this kind. Likewise codes that\ndiffer only by a permutation and rescaling of the coordinates have the same characteristics.\nIn the sequel we will make these notions precise and show the effect of such transformations\non the realizations and weight adjacency matrices.\nLet Aut(F) be the group of field automorphisms of F = Fps . Recall that each such\nautomorphism leaves the prime field Fp of F invariant and thus is Fp -linear. For any \u03c6 \u2208\nAut(F) we define its extension to polynomial matrices coefficientwise, that is,\n\u0011\n\u0011\n\u0010X\n\u0010X\n(\u03bd)\n(\u03bd)\n\u03c6(mij )z \u03bd\nmij z \u03bd\n.\n7\u2212\u2192 \u03c6(M ) :=\n\u03c6 : F[z]a\u00d7b \u2212\u2192 F[z]a\u00d7b , M :=\ni,j\n\n\u03bd\u22650\n\n11\n\n\u03bd\u22650\n\ni,j\n\n\fRemark 3.4 The\u0001 mapping \u03c6 is multiplicative and Fp -linear\n\u0001 for matrices nof fitting sizes and\nsatisfies rk \u03c6(M ) = rk (M ). Moreover, wt(v) = wt \u03c6(v) for all v \u2208 F[z] . Thus, \u03c6 induces\na weight-preserving Fp -isomorphism on F[z]n .\nNow we are ready to introduce monomial equivalence of convolutional codes.\nDefinition 3.5 We define two matrices G, G\u2032 \u2208 F[z]k\u00d7n with rank k to be monomially\nequivalent if there exists an automorphism \u03c6 \u2208 Aut(F), a permutation matrix P \u2208 GLn (F),\nand a nonsingular diagonal matrix R \u2208 GLn (F) such that G\u2032 = \u03c6(G)P R. We call two codes\nmonomially equivalent if they have monomially equivalent encoder matrices.\nObviously, monomial equivalence is an equivalence relation. Moreover, monomially equivalent\ncodes have the same dimension, Forney indices, and degree. Furthermore, according to\nRemark 3.4 the mapping uG 7\u2212\u2192 \u03c6(u)\u03c6(G) is weight-preserving and Fp -linear. Hence the\nsame is true for uG 7\u2212\u2192 \u03c6(u)\u03c6(G)P R, and thus monomially equivalent codes are Fp -isometric.\nThe isometry is even degree-preserving. It should also be observed that, in general, testing\nwhether two codes C = im G and C \u2032 = im G\u2032 of the same size are monomially equivalent\ncan be quite a formidable task. Indeed, one has to check whether there exists a unimodular\nmatrix U , a permutation P , and a diagonal matrix R such that G\u2032 = U GP R.\nAs we will see next, the effect of monomial equivalence on canonical realizations is easily\ndescribed.\nProposition 3.6 Let the data be as in Definition 3.5 and assume G\u2032 = \u03c6(G)P R. Let \u03a3 =\n(A, B, C, D) be any canonical realization of G. Then \u03a3\u2032 = (\u03c6(A), \u03c6(B), \u03c6(C)P R, \u03c6(D)P R) is\n\u03b4\n\u03b4\na canonical realization of G\u2032 . If G, and thus G\u2032 , is basic and reduced and \u039b, \u039b\u2032 \u2208 Z[W ]q \u00d7q\nare the weight adjacency matrices associated with \u03a3 and \u03a3\u2032 , respectively, then\n\u039bX,Y = \u039b\u2032\u03c6(X),\u03c6(Y ) for all (X, Y ) \u2208 F2\u03b4 .\n\n(3.5)\n\nProof: Using multiplicativity and additivity of \u03c6 one easily checks that \u03a3\u2032 is a canonical\nrealization of G\u2032 . For the second part of the statement notice that for any (X, Y ) \u2208 F2\u03b4 and\nany (u, v) \u2208 Fk \u00d7 Fn one has\nY = XA + uB \u21d0\u21d2 \u03c6(Y ) = \u03c6(X)\u03c6(A) + \u03c6(u)\u03c6(B),\nv = XC + uD \u21d0\u21d2 \u03c6(v)P R = \u03c6(X)\u03c6(C)P R + \u03c6(u)\u03c6(D)P R.\n\u0001\nSince wt \u03c6(v)P R = wt(v) for all v \u2208 Fn the result follows directly from Definition 3.1. \u2737\nThe identities (3.4) and (3.5) suggest the following equivalence relation for weight adjacency matrices. The corresponding equivalence classes result in the desired weight counting\ninvariants for convolutional codes.\nDefinition 3.7 (a) For matrices M, M \u2032 \u2208 Z[W ]q\n\n\u03b4 \u00d7q \u03b4\n\nwe define the equivalence relation\n\n\u2032\nM \u2243 M \u2032 \u21d0\u21d2 \u2203 \u03c6 \u2208 Aut(F), T \u2208 GL\u03b4 (F) : MX,Y\n= M\u03c6(X)T,\u03c6(Y )T for all (X, Y ) \u2208 F2\u03b4 .\n\nWe denote the equivalence class of M by M := {M \u2032 \u2208 Z[W ]q\n\n\u03b4 \u00d7q \u03b4\n\n| M \u2032 \u2243 M }.\n\n(b) For a code C of degree \u03b4 let \u039b\u0304(C) := \u039b be the equivalence class of the adjacency matrix \u039b\nassociated with any canonical minimal realization of C. We call \u039b\u0304(C) the adjacency\nmatrix of the code C.\n\n12\n\n\fIt is worth mentioning that \u2243 is not identical to the equivalence relation in [4, (4.1)] since\nthe latter does not cover F-automorphisms.\nFrom Theorem 3.3 we know that \u039b\u0304(C) is indeed an invariant of the code. Furthermore,\nProposition 3.6 implies that \u039b\u0304(C) is even invariant under monomial equivalence. The main\nresult of this section states that under a certain condition on the Forney indices the adjacency\nmatrix even forms a complete invariant for monomial equivalence. Indeed, we have the\nfollowing.\nTheorem 3.8 Let C, C \u2032 \u2286 F[z]n be two codes and assume that all Forney indices of C are\npositive. Then C and C \u2032 are monomially equivalent if and only if \u039b\u0304(C) = \u039b\u0304(C \u2032 ).\nNotice that we require that C and C \u2032 are defined over the same field F and have the same\nlength n. Just like in block coding theory we consider this a reasonable assumption for this\nkind of considerations. In the proof we will see that if \u039b\u0304(C) = \u039b\u0304(C \u2032 ) the codes C and C \u2032 have\nthe same Forney indices. Thus the assumption above on the Forney indices is true for C \u2032 as\nwell.\nRemembering that the adjacency matrix can be regarded as a generalization of the weight\nenumerator of block codes (see the paragraph right after Definition 3.1) this result comes\nsomewhat surprising. Indeed, there exist block codes that have the same weight enumerator\nbut are not monomially equivalent; see Example 3.10(a) at the end of this section. This\nshows that the positivity of the Forney indices is certainly a necessary condition for the above\nresult to be true. On the other hand for block codes the famous MacWilliams' Equivalence\nTheorem [13] tells us that isometric block codes are monomially equivalent, see also, e. g., [8,\nThm. 7.9.4]. It is not known yet whether an analogous statement is true for convolutional\ncodes with a suitable notion of isometry. We believe that the result above will be helpful for\ninvestigating this issue.\nProof: The only-if part has been proven in Proposition 3.6. Thus let us assume that\n\u039b\u0304(C) = \u039b\u0304(C \u2032 ). Since the adjacency matrices have the same size, the two codes have the\nsame degree, say \u03b4. Let G, G\u2032 be any basic and reduced encoder matrices of C and C \u2032 and\n(A, B, C, D) and (A\u2032 , B \u2032 , C \u2032 , D \u2032 ) be the corresponding controller forms, respectively. Then\nthe two systems have order \u03b4 and, according to Proposition 2.3, they form canonical minimal\nrealizations of the codes C and C \u2032 . Let \u039b and \u039b\u2032 be the associated weight adjacency matrices.\nBy assumption there exist \u03c6 \u2208 Aut(F) and T \u2208 GL\u03b4 (F) such that\n\u039b\u2032X,Y = \u039b\u03c6(X)T,\u03c6(Y )T for all (X, Y ) \u2208 F2\u03b4 .\n1) We first eliminate the automorphism \u03c6 from this identity. To this end, consider the realization (A\u2032\u2032 , B \u2032\u2032 , C \u2032\u2032 , D \u2032\u2032 ) = (\u03c6(A\u2032 ), \u03c6(B \u2032 ), \u03c6(C \u2032 ), \u03c6(D \u2032 )). By Proposition 3.6 this is a canonical\nrealization of the code C \u2032\u2032 := im \u03c6(G\u2032 ) and this code is, by definition, monomially equivalent\nto C \u2032 . Moreover, by the form of A\u2032 and B \u2032 in the controller form we have A\u2032\u2032 = A\u2032 , B \u2032\u2032 = B \u2032 .\nHence (A\u2032 , B \u2032 , C \u2032\u2032 , D \u2032\u2032 ) is a controller form. Again by Proposition 3.6 the associated weight\nadjacency matrix \u039b\u2032\u2032 satisfies\n\u039b\u2032\u2032\u03c6(X),\u03c6(Y ) = \u039b\u2032X,Y = \u039b\u03c6(X)T,\u03c6(Y )T for all (X, Y ) \u2208 F2\u03b4 .\nSince \u03c6 is a bijection on F\u03b4 this yields\n\u039b\u2032\u2032X,Y = \u039bXT,Y T for all (X, Y ) \u2208 F2\u03b4 .\n\n(3.6)\n\n2) In [4, Thm. 5.1] is has been proven that codes satisfying (3.6) have the same dimension\nand the same Forney indices. Thus let k = dim(C) = dim(C \u2032\u2032 ). Using Theorem 3.3 we may\n13\n\n\fassume that both codes have their Forney\nthem\nPk indices in the same ordering. Let us denote\n\u2032\nby \u03bd1 \u2265 . . . \u2265 \u03bdk \u2265 1. Notice that \u03b4 = i=1 \u03bdi . Now the controller form implies A = A and\nB \u2032 = B. Thus we arrive at canonical minimal realizations (A, B, C, D) and (A, B, C \u2032\u2032 , D \u2032\u2032 )\nsuch that the associated weight adjacency matrices satisfy (3.6). It remains to show that the\ncorresponding codes C and C \u2032\u2032 are monomially equivalent.\n3) We will show that\nA = T (A \u2212 M B)T \u22121 and B = U BT \u22121 for some matrices M \u2208 F\u03b4\u00d7k , U \u2208 GLk (F).\n\n(3.7)\n\nBy definition of the weight adjacency matrix we have for any (X, Y ) \u2208 F2\u03b4\nY \u2212 XA \u2208 im B \u21d0\u21d2 \u039b\u2032\u2032X,Y 6= 0 \u21d0\u21d2 \u039bXT,Y T 6= 0 \u21d0\u21d2 Y T \u2212 XT A \u2208 im B.\nPutting \u00c3 = T AT \u22121 , B\u0303 = BT \u22121 , we thus get\nY \u2212 XA \u2208 im B \u21d0\u21d2 Y \u2212 X \u00c3 \u2208 im B\u0303.\nUsing X = 0 this implies im B\u0303 = im B and hence BT \u22121 = \u0168 B for some \u0168 \u2208 GLk (F). On the\nother hand, for each X \u2208 F\u03b4 there exists u \u2208 Fk and Y \u2208 F\u03b4 such that Y \u2212 XA = uB, hence\nthere exists \u0169 \u2208 Fk such that Y \u2212 X \u00c3 = \u0169B. This implies X(\u00c3 \u2212 A) = (u \u2212 \u0169)B. Using for X\nall standard basis vectors we obtain the identity \u00c3 = A + M\u0303 B for some matrix M\u0303 \u2208 F\u03b4\u00d7k .\nHence we arrive at A = T \u22121 (A + M\u0303 B)T and B = \u0168 BT . This in turn yields (3.7).\n4) In this step we will prove that (A, B, C \u2032\u2032 , D \u2032\u2032 ) and (A, B, C, D) are related via the full\nfeedback group followed by monomial equivalence. Using Theorem 2.7 this will then establish\nthe desired result. In order to do so we will compare the entries of the weight adjacency\nmatrices. Consider the canonical minimal realization (\u0100, B\u0304, C\u0304, D\u0304) = (T AT \u22121 , BT \u22121 , T C, D)\nof the code C. It is easy to see [4, Rem. 3.6] that the associated weight adjacency matrix \u039b\u0304\nsatisfies \u039b\u0304X,Y = \u039bXT,Y T for all (X, Y ) \u2208 F2\u03b4 and hence Equation (3.6) implies\n\u039b\u0304 = \u039b\u2032\u2032 .\nNow we can study the entries of these weight adjacency matrices. Recall that \u039b\u2032\u2032 belongs\nto the realization (A, B, C \u2032\u2032 , D \u2032\u2032 ) of the code C \u2032\u2032 . Since all Forney indices are positive, the\nmatrix B has full rank k (see the controller form). As a consequence, for each pair of states\n(X, Y ) \u2208 F2\u03b4 the set {XC \u2032\u2032 + uD \u2032\u2032 | u \u2208 Fk : Y = XA + uB} has at most one element.\nRecalling the definition of the weight adjacency matrix in (3.3) one obtains that the nonzero\nentries are given by\n\u039b\u2032\u2032X,XA+uB = \u039b\u0304X,XA+uB for all (X, u) \u2208 F\u03b4 \u00d7 Fk ,\n\n(3.8)\n\nand these entries have the value \u039b\u2032\u2032X,XA+uB = W \u03b1 where \u03b1 = wt(XC \u2032\u2032 + uD \u2032\u2032 ). On the other\nhand notice that, due to (3.7), for any (X, u) \u2208 F\u03b4 \u00d7 Fk we have\nXA + uB = X(T AT \u22121 \u2212 T M BT \u22121 ) + uU BT \u22121 = X \u0100 + \u016bB\u0304 where \u016b = uU \u2212 XT M.\nThus (3.3) yields \u039b\u0304X,XA+uB = \u039b\u0304X,X \u0100+\u016bB\u0304 = W \u03b2 where \u03b2 = wt(X C\u0304 + \u016bD\u0304). As a consequence, (3.8) implies\n\u0012\n\u0012\n\u0012\n\u0012 \u2032\u2032 \u0013 \u0013\n\u0013\u0013\n\u0001\nC\u0304 \u2212 T M D\u0304\nC\n=\nwt\nX\nC\u0304\n+\n(uU\n\u2212\nXT\nM\n)\nD\u0304\n=\nwt\n(X,\nu)\nwt (X, u)\nD \u2032\u2032\nU D\u0304\n14\n\n\ffor all (X, u) \u2208 F\u03b4 \u00d7 Fk . Now [4, Lemma 5.4], which is basically MacWilliams' Equivalence\nTheorem for block codes, yields the existence of a permutation matrix P \u2208 GLn (F) and a\nnonsingular diagonal matrix R \u2208 GLn (F) such that\n\u0012 \u2032\u2032 \u0013 \u0012\n\u0013\nC\nC\u0304 \u2212 T M D\u0304\n=\nP R.\nD \u2032\u2032\nU D\u0304\n\nHence the realization (A, B, C \u2032\u2032 , D \u2032\u2032 ) of C \u2032\u2032 is of the form\n\n(A, B, C \u2032\u2032 , D \u2032\u2032 ) = (T (A \u2212 M B)T \u22121 , U BT \u22121 , (C\u0304 \u2212 T M D\u0304)P R, U D\u0304P R)\n= (T (A \u2212 M B)T \u22121 , U BT \u22121 , T (C \u2212 M D)P R, U DP R).\nThis finally allows us to apply Theorem 2.7, which then tells us that\n\u0001\n\u0001\nC \u2032\u2032 = im B(z \u22121 I \u2212 A)\u22121 C \u2032\u2032 + D \u2032\u2032 = im B(z \u22121 I \u2212 A)\u22121 C + D P R = im (GP R)\nis monomially equivalent to C. This completes the proof.\n\n\u2737\n\nRemark 3.9 The proof shows that the result of Theorem 3.8 is also true if monomial equivalence of codes and equivalence of adjacency matrices (see Definitions 3.5 and 3.7) do not\nallow nontrivial field automorphisms \u03c6. In that case step 1) is simply omitted.\nWe close the paper with presenting some examples showing that the theorem above is not\ntrue if some of the Forney indices are zero.\nExample 3.10\n(a) Recall that for a block code C = im G, thus G \u2208 Fk\u00d7n , the adjacency matrix is the\nordinary weight enumerator. In this case it is well known that block codes with the same\nweight enumerator are, in general, not monomially equivalent. The following example is\ntaken from [8, Exa. 1.6.1]. The matrices\n\uf8eb\n\uf8eb\n\uf8f6\n\uf8f6\n1 1 0 0 0 0\n1 1 0 0 0 0\nG1 = \uf8ed0 0 1 1 0 0\uf8f8 , G2 = \uf8ed1 0 1 0 0 0\uf8f8 \u2208 F3\u00d76\n2\n1 1 1 1 1 1\n1 1 1 1 1 1\ngenerate codes with the same weight enumerator 1 + 3W 2 + 3W 4 + W 6 , but are not\nmonomially equivalent. The latter follows from G1 G1T = 0 6= G2 G2T .\n\n(b) From the previous data one can also construct an example with positive degree. Using\nthe rows of the matrices above in a suitable way one obtains\n\u0012\n\u0013\n\u0012\n\u0013\n1 1 z z 0 0\nz+1 1 z 0 0 0\nG=\n, \u1e20 =\n\u2208 F2 [z]2\u00d76 .\n1 1 1 1 1 1\n1\n1 1 1 1 1\nBoth matrices are basic and reduced. The weight adjacency matrices of the associated\ncontroller forms are both given by\n\u0013\n\u0012\n1 + W6 W2 + W4\n\u039b=\n.\nW2 + W4 W2 + W4\n\nBut the codes C = im G and C \u0304 = im \u1e20 are not monomially equivalent. This can be seen\nby computing U G for all U \u2208 GL2 (F2 [z]) such that U G is reduced with indices 1 and 0\nagain. The only options are\nn \u00121 1\u0013 \u00121 z \u0013 \u00121 1 + z \u0013 o\nU \u2208 I2 ,\n,\n,\n0 1\n0 1\n0\n1\n\nand it is seen by inspection that in none of these cases U G has, up to ordering, the same\ncolumns as \u1e20.\n15\n\n\fConclusion\nIn this note we have shown that codes with all Forney indices being positive are monomially\nequivalent if and only if they share the same adjacency matrix. The result is not true\nfor codes with at least one Forney index being zero (unless they are one-dimensional block\ncodes). We believe that this result will be helpful for the investigation of (F-linear) isometries\nfor convolutional codes that leave the characteristic properties of the codes invariant. This\nsubject however has to remain open for future research since no well founded notion for such\nisometries has been established yet. Once this has been found the question of a MacWilliams'\nEquivalence Theorem for convolutional codes can be addressed, and our result might provide\na partial answer.\n\nReferences\n[1] H. Q. Dinh and S. R. L\u00f3pez-Permouth. On the equivalence of codes over rings and\nmodules. Finite Fields & their Appl., 10:615\u2013625, 2004.\n[2] G. D. Forney Jr. Minimal bases of rational vector spaces, with applications to multivariable linear systems. SIAM J. on Contr., 13:493\u2013520, 1975.\n[3] P. A. Fuhrmann. Linear Systems and Operators in Hilbert space. McGraw-Hill, New\nYork, 1981.\n[4] H. Gluesing-Luerssen. On the weight distribution of convolutional codes. Linear Algebra\nand its Applications, 408:298\u2013326, 2005.\n[5] H. Gluesing-Luerssen and G. Schneider. On the MacWilliams identity for convolutional\ncodes. Preprint 2006. Submitted. Available at http://arxiv.org/pdf/cs.IT/0603013.\n[6] M. Greferath and S. E. Schmidt. Finite ring combinatorics and MacWilliams' Equivalence Theorem. J. Combin. Theory Ser. A, 92:17\u201328, 2000.\n[7] S. H\u00f6st, R. Johannesson, and V. V. Zyablov. Woven convolutional codes I: Encoder\nproperties. IEEE Trans. Inform. Theory, IT-48:149\u2013161, 2002.\n[8] W. C. Huffman and V. Pless. Fundamentals of Error-Correcting Codes. Cambridge\nUniversity Press, Cambridge, 2003.\n[9] R. Hutchinson, J. Rosenthal, and R. Smarandache. Convolutional codes with maximum\ndistance profile. Syst. Contr. Lett., 54:53\u201363, 2005.\n[10] J. Justesen, E. Paaske, and M. Ballan. Quasi-cyclic unit memory convolutional codes.\nIEEE Trans. Inform. Theory, IT-36:540\u2013547, 1990.\n[11] T. Kailath. Linear Systems. Prentice-Hall, 1980.\n[12] F. J. MacWilliams. Combinatorial problems of elementary abelian groups. PhD thesis,\nHarvard University, 1962.\n[13] F. J. MacWilliams. A theorem on the distribution of weights in a systematic code. Bell\nSyst. Tech. J., 42:79\u201394, 1963.\n\n16\n\n\f[14] R. J. McEliece. The algebraic theory of convolutional codes. In V. Pless and W. Huffman,\neditors, Handbook of Coding Theory, Vol. 1, pages 1065\u20131138. Elsevier, Amsterdam,\n1998.\n[15] R. J. McEliece. How to compute weight enumerators for convolutional codes. In M. Darnell and B. Honory, editors, Communications and Coding (P. G. Farrell 60th birthday\ncelebration), pages 121\u2013141. Wiley, New York, 1998.\n[16] J. Rosenthal. Connections between linear systems and convolutional codes. In B. Marcus\nand J. Rosenthal, editors, Codes, Systems, and Graphical Models, pages 39\u201366. Springer,\nBerlin, 2001.\n[17] J. Rosenthal and E. V. York. BCH convolutional codes. IEEE Trans. Inform. Theory,\nIT-45:1833\u20131844, 1999.\n[18] H. N. Ward and J. A. Wood. Characters and the equivalence of codes. J. Combin.\nTheory Ser. A, 73:348\u2013352, 1996.\n[19] J. A. Wood. Weight functions and the extension theorem for linear codes over finite\nrings. Contemp. Math., 225:231\u2013243, 1999.\n\n17\n\n\f"}