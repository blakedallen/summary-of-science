{"id": "http://arxiv.org/abs/0804.0645v2", "guidislink": true, "updated": "2008-06-04T00:13:10Z", "updated_parsed": [2008, 6, 4, 0, 13, 10, 2, 156, 0], "published": "2008-04-04T02:43:03Z", "published_parsed": [2008, 4, 4, 2, 43, 3, 4, 95, 0], "title": "Finite Trigonometric Character Sums Via Discrete Fourier Analysis", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0804.4530%2C0804.2494%2C0804.4157%2C0804.4821%2C0804.1003%2C0804.1099%2C0804.0645%2C0804.2425%2C0804.2338%2C0804.4564%2C0804.0136%2C0804.2778%2C0804.3604%2C0804.0016%2C0804.3650%2C0804.4055%2C0804.4789%2C0804.1110%2C0804.3503%2C0804.0544%2C0804.2214%2C0804.3061%2C0804.1151%2C0804.4440%2C0804.2709%2C0804.2993%2C0804.3935%2C0804.2905%2C0804.3969%2C0804.2731%2C0804.4014%2C0804.3428%2C0804.0073%2C0804.4803%2C0804.4000%2C0804.0140%2C0804.0470%2C0804.0182%2C0804.2416%2C0804.2114%2C0804.3800%2C0804.3238%2C0804.0087%2C0804.2616%2C0804.3459%2C0804.4437%2C0804.1738%2C0804.2923%2C0804.0962%2C0804.1686%2C0804.1009%2C0804.0591%2C0804.4743%2C0804.1930%2C0804.3431%2C0804.0822%2C0804.4038%2C0804.3761%2C0804.2743%2C0804.3163%2C0804.1975%2C0804.4139%2C0804.3694%2C0804.3974%2C0804.3590%2C0804.4416%2C0804.3978%2C0804.3262%2C0804.4149%2C0804.2638%2C0804.2603%2C0804.1959%2C0804.2409%2C0804.3606%2C0804.4465%2C0804.0381%2C0804.0299%2C0804.4604%2C0804.0569%2C0804.4425%2C0804.4871%2C0804.2020%2C0804.3376%2C0804.0117%2C0804.4417%2C0804.2910%2C0804.1430%2C0804.0153%2C0804.1714%2C0804.3986%2C0804.4632%2C0804.4042%2C0804.0963%2C0804.2953%2C0804.3644%2C0804.4395%2C0804.2110%2C0804.4188%2C0804.2223%2C0804.3279%2C0804.0255&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Finite Trigonometric Character Sums Via Discrete Fourier Analysis"}, "summary": "We prove several old and new theorems about finite sums involving characters\nand trigonometric functions. These sums can be traced back to theta function\nidentities from Ramanujan's notebooks and were systematically first studied by\nBerndt and Zaharescu; their proofs involved complex contour integration. We\nshow how to prove most of Berndt-Zaharescu's and some new identities by\nelementary methods of discrete Fourier Analysis.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0804.4530%2C0804.2494%2C0804.4157%2C0804.4821%2C0804.1003%2C0804.1099%2C0804.0645%2C0804.2425%2C0804.2338%2C0804.4564%2C0804.0136%2C0804.2778%2C0804.3604%2C0804.0016%2C0804.3650%2C0804.4055%2C0804.4789%2C0804.1110%2C0804.3503%2C0804.0544%2C0804.2214%2C0804.3061%2C0804.1151%2C0804.4440%2C0804.2709%2C0804.2993%2C0804.3935%2C0804.2905%2C0804.3969%2C0804.2731%2C0804.4014%2C0804.3428%2C0804.0073%2C0804.4803%2C0804.4000%2C0804.0140%2C0804.0470%2C0804.0182%2C0804.2416%2C0804.2114%2C0804.3800%2C0804.3238%2C0804.0087%2C0804.2616%2C0804.3459%2C0804.4437%2C0804.1738%2C0804.2923%2C0804.0962%2C0804.1686%2C0804.1009%2C0804.0591%2C0804.4743%2C0804.1930%2C0804.3431%2C0804.0822%2C0804.4038%2C0804.3761%2C0804.2743%2C0804.3163%2C0804.1975%2C0804.4139%2C0804.3694%2C0804.3974%2C0804.3590%2C0804.4416%2C0804.3978%2C0804.3262%2C0804.4149%2C0804.2638%2C0804.2603%2C0804.1959%2C0804.2409%2C0804.3606%2C0804.4465%2C0804.0381%2C0804.0299%2C0804.4604%2C0804.0569%2C0804.4425%2C0804.4871%2C0804.2020%2C0804.3376%2C0804.0117%2C0804.4417%2C0804.2910%2C0804.1430%2C0804.0153%2C0804.1714%2C0804.3986%2C0804.4632%2C0804.4042%2C0804.0963%2C0804.2953%2C0804.3644%2C0804.4395%2C0804.2110%2C0804.4188%2C0804.2223%2C0804.3279%2C0804.0255&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We prove several old and new theorems about finite sums involving characters\nand trigonometric functions. These sums can be traced back to theta function\nidentities from Ramanujan's notebooks and were systematically first studied by\nBerndt and Zaharescu; their proofs involved complex contour integration. We\nshow how to prove most of Berndt-Zaharescu's and some new identities by\nelementary methods of discrete Fourier Analysis."}, "authors": ["Matthias Beck", "Mary Halloran"], "author_detail": {"name": "Mary Halloran"}, "author": "Mary Halloran", "arxiv_comment": "14 pages", "links": [{"href": "http://arxiv.org/abs/0804.0645v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0804.0645v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11L03, 11E41", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0804.0645v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0804.0645v2", "journal_reference": "International Journal of Number Theory 6, no. 1 (2010), 51-67", "doi": null, "fulltext": "arXiv:0804.0645v2 [math.NT] 4 Jun 2008\n\nFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER\nANALYSIS\nMATTHIAS BECK AND MARY HALLORAN\nAbstract. We prove several old and new theorems about finite sums involving characters and\ntrigonometric functions. These sums can be traced back to theta function identities from Ramanujan's notebooks and were systematically first studied by Berndt and Zaharescu; their proofs involved\ncomplex contour integration. We show how to prove most of Berndt\u2013Zaharescu's and some new\nidentities by elementary methods of discrete Fourier Analysis.\n\n1. Introduction\nCuriously looking trigonometric identities such as\n\u0001\n\u0001\n\u0001\nsin2 3\u03c0\nsin2 \u03c07\nsin2 2\u03c0\n7\n7\n(1)\n+\n\u2212\n=0\nsin \u03c07\nsin 2\u03c0\nsin 3\u03c0\n7\n7\nfirst surfaced in [1] as corollaries of (nontrivial) theta function identities from Ramanujan's notebooks, and also in [8]. Berndt\u2013Zaharescu initiated in [4] a systematic study of finite trigonometric\nidentities involving characters, which nicely explained and vastly expanded on all previously known\nidentities of the likes of (1). Let us give two examples of such identities, one due to Berndt\u2013\nZaharescu (which generalizes (1)) [4, Theorem 3.1] and one that we believe is novel.\nTheorem 1.1 (Berndt\u2013Zaharescu). Suppose \u03c7 is a nonprincipal, real, primitive, odd character\nmodulo k, where k \u2265 7 is odd. Then\n\u0010 \u0011\n( \u221a\n\u221a\nk\u22121\nsin2 \u03c0j\nX\nk\n3 k\n\u22123 k h(\u2212k) if k \u2261 3 mod 8,\n\u0010 \u0011 =\n(\u03c7(2) \u2212 1) h(\u2212k) =\n\u03c7(j)\n4\u03c0j\n2\n0\nif k \u2261 7 mod 8.\nsin\nj=1\n\nk\n\nTheorem 1.2. Let \u03c7 be a nonprincipal, real, odd character modulo k, let a and b be positive integers\nsuch that a is odd and 1 \u2264 ab < k, and let x \u2208 R. Then\n\u221a\n\u0012\n\u0013\n\u0012 \u0013\nk\u22121\nX\nX\nk\na 2\u03c0bj\nm\u2212(a\u22121)/2 a\n\u03c7(j) sin\n+ x = a\u22121\n(\u22121)\ncos ((a \u2212 2m)x) \u03c7(n) .\nk\n2\nm\nn,m\u22650\nj=0\n\nn+2mb=ab\n\nDate: 3 June 2008.\n2000 Mathematics Subject Classification. 11L03; 11E41.\nKey words and phrases. Finite trigonometric sums, characters, class numbers, discrete Fourier analysis,\nconvolution.\nThe authors thank an anonymous referee for many helpful suggestions and corrections.\n1\n\n\f2\n\nMATTHIAS BECK AND MARY HALLORAN\n\nHere h(\u2212k) denotes the class number\n(i.e., the number of equivalent classes of fractional ideals) of\n\u221a\nthe imaginary quadratic field Q[ \u2212k]. Class numbers make an appearance in many of the theorems\nthat will follow, and so one can think of them as representations of class numbers by trigonometric\nsums.\nExamining the ingredients of the left-hand sides of Theorems 1.1 and 1.2 suggests that there\nought to be a way of interpreting them as convolutions of finite Fourier series, and this is our goal\nin this paper: to show that the elementary methods of discrete Fourier Analysis are well suited\nto prove these and many other theorems on finite sums involving characters and trigonometric\nfunctions. (Berndt\u2013Zaharescu used complex contour integration to prove their theorems.)\nWe will give a quick brush-up on discrete Fourier Analysis and the Fourier transforms of the basic\ntrigonometric functions in Section 2. In Section 3 we show that this setting gives rise to essentially\ntrivial proofs of many old and some new trigonometric identities not involving characters. In\nSection 4 we give Fourier proofs of several old and new theorems along the lines of (and including)\nTheorems 1.1 and 1.2.\n2. Discrete Fourier Transforms and Convolutions\nWe recall a few basic facts from discrete Fourier analysis (see, e.g., [10]). Throughout the paper,\nwe fix a positive integer k and let \u03c9 = e2\u03c0i/k .\nTheorem 2.1. Suppose f is a periodic function on Z with period k. Then there exist f\u02c6(0), f\u02c6(1), . . . , f\u02c6(k\u2212\n1) such that\nk\u22121\n1X\u02c6\nf (j) \u03c9 jn .\nf (n) =\nk\nj=0\n\nWe can think of the discrete Fourier transform f\u02c6 as another periodic function on Z with period k.\nExplicitly, f\u02c6 is given through\nk\u22121\nX\nf (j) \u03c9 \u2212jn .\nf\u02c6(n) =\nj=0\n\nCorollary 2.2. f is even/odd if and only if f\u02c6 is even/odd, respectively.\nTheorem 2.3. Let f and g be periodic functions on Z with period k, and suppose f\u02c6 and \u011d are their\ndiscrete Fourier transforms. Then the convolution f \u2217 g of f and g,\n(f \u2217 g)(n) :=\nhas period k and discrete Fourier transform\n\nk\u22121\nX\nj=0\n\nf (j) g(n \u2212 j) ,\n\nf[\n\u2217 g = f\u02c6 * \u011d .\n\nCorollary 2.4. Let f and g be periodic functions on Z with period k, and suppose f\u02c6 and \u011d are\ntheir discrete Fourier transforms. Then\nk\u22121\nX\n\nm=0\n\nf (m)g(\u2212m) =\n\nk\u22121\n1X\u02c6\nf (j) \u011d(j) .\nk\nj=0\n\n\fFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER ANALYSIS\n\n3\n\nCorollary 2.5. Let f and g be periodic functions on Z with period k, and suppose f\u02c6 and \u011d are\ntheir discrete Fourier transforms. If f or g is odd then\nk\u22121\nX\n\nk\u22121\n1X\u02c6\nf (j) \u011d(j) .\nf (m) g(m) = \u2212\nk\nm=0\n\nIf f or g is even then\n\nj=0\n\nk\u22121\nX\n\nf (m) g(m) =\n\nm=0\n\nk\u22121\n1X\u02c6\nf (j) \u011d(j) .\nk\nj=0\n\nAs examples of discrete Fourier transforms, we discuss the basic trigonometric functions. It is\nthrough their discrete Fourier transforms that we will derive the finite trigonometric identities that\nwe are after. Let {x} = x \u2212 \u230ax\u230b denote the fractional part of x.\nLemma 2.6. Let a \u2208 Z, 0 < a < k, a 6= k2 . If\n\uf8f1\n1\n\uf8f4\nif k|a + n,\n\uf8f22\n1\nf (n) = \u2212 2 if k|a \u2212 n,\n\uf8f4\n\uf8f3\n0\notherwise,\n\nIf\n\nf (n) =\n\n(\n\n1\n2\n\n0\n\nif k|a + n or k|a \u2212 n,\notherwise,\n\nIf k is odd and\n(\n\u0010\u0010 n \u0011\u0011\n0\n:= \b n\nf (n) =\nk\nk \u2212\nIf k is odd and\n\n1\n2\n\nif k|n,\notherwise,\n\n(\n0\nf (n) =\n(\u22121)n mod k\n\n2\u03c0an\n.\nf\u02c6(n) = i sin\nk\n\nthen\n\nthen\n\nthen\n\nif k|n,\notherwise,\n\nthen\n\n2\u03c0an\nf\u02c6(n) = cos\n.\nk\n\nf\u02c6(n) =\n\n(\n0\ni\n2\n\ncot\n\n\u03c0n\nk\n\nif k|n,\notherwise.\n\n\u03c0n\nf\u02c6(n) = i tan\n.\nk\n\nHere n mod k denotes the least positive residue mod k.\n3. Explicit Evaluations of Finite Trigonometric Sums\nBy using the results of the previous section, we can obtain numerous identities of finite trigonometric sums, in an essentially trivial way. As an archetype, we prove the following identity, which\nis the earliest trigonometric sum evaluation that we are aware of, found by Stern in 1861 [9].\nProposition 3.1. If k is an odd positive integer,\n\u0012 \u0013\nk\u22121\nX\n2 \u03c0j\ntan\n= k2 \u2212 k .\nk\nj=1\n\nWe refer to the excellent bibliography of [3] for further past appearances of this and all other\ntrigonometric sums in this section.\n\n\f4\n\nMATTHIAS BECK AND MARY HALLORAN\n\nProof. The discrete Fourier transform of\n(\n0\nf (n) =\n(\u22121)n mod k\n\nif k|n,\notherwise,\n\nis f\u02c6(n) = i tan \u03c0n\nk ; hence Corollary 2.5 gives\n\u0012 \u0013\nk\u22121\nk\u22121\nk\u22121\nX\nX\n1X\n2 \u03c0j\n2\n(\u22121)2n = \u2212(k \u2212 1) .\ntan\nf (j) = \u2212\n\u2212\n=\u2212\nk\nk\nj=1\n\n\u0003\n\nj=1\n\nj=0\n\nSimilar identities, which can be proved in a completely analogous fashion, include\n\u0012 \u0013\nk\u22121\nX\n1\n2 \u03c0j\ncot\n= (k \u2212 1)(k \u2212 2)\nk\n3\nj=1\n\nand, for odd k,\nk\u22121\nX\n\n2\n\ncsc\n\nj=1\n\n\u0012\n\n2\u03c0j\nk\n\n\u0013\n\n\u0001\n1 2\nk \u22121\n=\n3\n\nk\u22121\nX\n\nand\n\n2\n\nsec\n\nj=1\n\n\u0012\n\n2\u03c0j\nk\n\n\u0013\n\n= k2 \u2212 1 .\n\nOne can easily establish these identities with the help of Corollary 2.5 and the identities\ncsc(2\u03b8) =\n\n1\n2\n\n(tan \u03b8 + cot \u03b8)\n\nand\n\nsec2 \u03b8 = 1 + tan2 \u03b8 .\n\nAnother application of the Convolution Theorem is the following identity proved by Eisenstein [7];\nthe earliest published proof we are aware of is in [9].\nProposition 3.2. For 0 < a < k,\nk\u22121\nX\nj=1\n\nProof. If a =\n\nThen\n\nk\n2\n\ncot\n\n2\u03c0aj\n\u03c0j\nsin\n= k \u2212 2a .\nk\nk\n\nthen both sides of the identity are\n\uf8f1\n1\n\uf8f4\n\uf8f22\ng(n) = \u2212 12\n\uf8f4\n\uf8f3\n0\nf\u02c6(n) =\n\n(\n0\ni\n2\n\ncot\n\n\u03c0n\nk\n\nif k|n,\notherwise\n\nzero. Now suppose a 6= k2 . Let f (n) =\nif k|a + n,\nif k|a \u2212 n,\notherwise.\n\nand\n\n\u011d(n) = i sin\n\nn\nk\n\n\u0001\u0001\n\nand\n\n2\u03c0an\n,\nk\n\nand by Corollary 2.5,\n\u0012\n\u0013\u0012 \u0013 \u0012\n\u0013\u0012 \u0013\nk\u22121\nk\u22121\nX\n1 X\na 1\n\u03c0j\nk\u2212a 1\n1\n2\u03c0aj\n1\nk \u2212 2a\n\u2212\nf (j) g(j) = \u2212\ncot\nsin\n=\u2212\n\u2212\n\u2212\n.\n\u2212\n\u2212\n=\u2212\n2k\nk\nk\nk 2\n2\nk\n2\n2\n2k\nj=1\n\nj=0\n\n\u0003\n\n\fFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER ANALYSIS\n\n5\n\nGeneralizations of Proposition 3.2 were constructed by Williams and Zhang [12], who allowed\narbitrary powers of the cotangent, and Wang [11], who replaced the cotangent by a cotangent\nderivative.\nHere we give siblings of Proposition 3.2 that have essentially identical proofs in the language of\ndiscrete Fourier analysis.\nProposition 3.3. Suppose k is an odd, positive integer and 0 < a < k. Then\nk\u22121\nX\n\n2\u03c0aj\n\u03c0j\nsin\n= (\u22121)a+1 k ,\nk\nk\nj=1\n(\nk\u22121\nX\n2\u03c0aj\n2\u03c0j\nk \u2212 a if a is odd,\nsin\ncsc\n=\nk\nk\n\u2212a\nif a is even,\nj=1\ntan\n\nk\u22121\nX\n\ntan\n\n2\u03c0j\nk2 \u2212 1\n\u03c0j\ncsc\n=\n,\nk\nk\n2\n\ncot\n\n\u03c0j\n2\u03c0j\nk2 \u2212 1\ncsc\n=\n.\nk\nk\n6\n\nj=1\n\nk\u22121\nX\nj=1\n\nThese examples illustrate that the method of using discrete Fourier convolution does not discriminate between different trigonometric functions. On the other hand, a disadvantage compared\nto other methods is the fact that we cannot easily handle arbitrary powers, which appear, e.g., in\nidentities of Berndt\u2013Yeap [3] and Chu\u2013Marini [6]. We can, however, deal with fixed higher powers.\nAs an illustrating example, we prove the following.\nProposition 3.4. If k is an odd positive integer,\nk\u22121\nX\n\ntan\n\n4\n\nj=0\n\n\u0012\n\n\u03c0j\nk\n\n\u0013\n\n\u0001\n1\n= k(k \u2212 1) k2 + k \u2212 3 .\n3\n\nProof. We will use the Convolution Theorem with the function\ng(n) =\n\nk\u22121\n1X\n\u03c0j jn\n\u03c9 .\ntan2\nk\nk\nj=0\n\nPk\u22121\nThis function, in turn, is a convolution, namely g(n) = \u2212 m=0\nf (n \u2212 m) f (m) where\n(\n0\nif k|n,\nf (n) =\nn\nmod\nk\n(\u22121)\notherwise.\nBy Proposition 3.1, g(0) = k \u2212 1. Now for 0 < n < k we have with f (0) = 0\ng(n) = \u2212\n\nn\u22121\nX\n\nm=0\n\nf (n \u2212 m) f (m) \u2212\n\nk\u22121\nX\n\nm=n+1\n\nf (n \u2212 m) f (m) .\n\n\f6\n\nMATTHIAS BECK AND MARY HALLORAN\n\nWe have f (m) = (\u22121)m for 0 < m < k, but the evaluation of f (n \u2212 m) is slightly more subtle:\n(\n(\u22121)n\u2212m\nif 0 < m < n,\nf (n \u2212 m) =\nn\u2212m+1\n(\u22121)\nif n < m < k.\nHere the first case is clear since 0 < m < n implies 0 < n \u2212 m < k. The second case n < m < k\nimplies \u2212k < n \u2212 m < 0, and we use the fact that f is an odd function (since tangent is odd).\nThus we obtain for 0 < n < k\ng(n) = \u2212\n\nn\u22121\nX\n\nn\u2212m\n\n(\u22121)\n\nm=1\n\nm\n\n(\u22121) \u2212\n\nk\u22121\nX\n\nm=n+1\n\n(\u22121)n\u2212m+1 (\u22121)m = (\u22121)n (k \u2212 2n) .\n\nIn summary, we have\ng(n) =\n\n(\n\nk\u22121\n(\u22121)n mod k (k \u2212 2(n mod k))\n\nif n|k,\notherwise.\n\nNow we can apply Corollary 2.5:\n\u0012 \u0013 X\nk\u22121\nk\u22121\nk\u22121\nX\n\u0001\n1X\n1\n4 \u03c0j\n(2m \u2212 k)2 = (k \u2212 1) k2 + k \u2212 3 .\ntan\n(g(m))2 = (k \u2212 1)2 +\n=\nk\nk\n3\nm=1\nm=0\n\n\u0003\n\nj=0\n\nAs a final application of discrete Fourier convolution in this section, we derive two identities of\nbinomial coefficients using Fourier analysis. In preparation, we prove an identity for arbitrary sine\nand cosine powers (for which we do not need to apply Fourier convolution).\nLemma 3.5. Let a, b be positive integers such that 0 < ab < k, and let x, y \u2208 R. Then\n\u0013 X\n\u0013\n\u0012\n\u0012 \u0013\n\u0012\nk\u22121\nk\u22121\nX\nk 2a\n2a b\u03c0j\n2a b\u03c0j\ncos\n+x =\n+ y = 2a\n.\nsin\nk\nk\n2\na\nj=0\n\nj=0\n\nProof. The cosine identity follows from the sine identity by replacing x with x+ \u03c02 . The sine identity\nis obtained through\n\u0013\n\u0012\nk\u22121\nk\u22121\n\u00112a\nX\n1 X \u0010 bj/2 ix\n2a b\u03c0j\n\u2212bj/2 \u2212ix\nsin\n\u03c9\ne\n\u2212\n\u03c9\ne\n\u03c9 nj\n+ x \u03c9 nj =\nk\n(2i)2a\nj=0\n\nj=0\n\nk\u22121 2a \u0012 \u0013\n(\u22121)a X X 2a (2a\u2212m)bj/2 (2a\u2212m)ix\n= 2a\n\u03c9\ne\n(\u22121)m \u03c9 \u2212mbj/2 e\u2212mix \u03c9 nj\n2\nm\nm=0\nj=0\n\n\u0012 \u0013\n2a\nk\u22121\nX\n(\u22121)a X\nm 2a\n(\u22121)\n\u03c9 bj(a\u2212m)+nj .\ne2ix(a\u2212m)\n= 2a\n2\nm\nm=0\nj=0\n\nNow let n = 0. We have\nk\u22121\nX\nj=0\n\n\u03c9 bj(a\u2212m) =\n\n(\n\nk\n0\n\nif k|b(a \u2212 m),\notherwise.\n\n\fFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER ANALYSIS\n\nSince 0 < ab < k, k divides b(a \u2212 m) only if m = a, whence the above sum becomes\n\u0013\n\u0012 \u0013\n\u0012\nk\u22121\nX\nk 2a\n2a b\u03c0j\n+ x = 2a\nsin\n.\nk\n2\na\n\n7\n\n\u0003\n\nj=0\n\nTheorem 3.6. For any positive integer a,\n\u0012 \u0013 X\n\u0012 \u0013\u0012 \u0013\na \u0012 \u00132\na\nX\n2a\na\na\nm 2(a\u2212m) 2m\n(\u22121) 2\n=\n=\n.\na\nm\nm\nm\nm=0\n\nm=0\n\nProof. Given a \u2265 1, choose k such that 2a < k. A computation very similar to the previous proof\n(with b = 2 and x = 0) gives\n\u0012 \u0013\n\u0013\nk\u22121 \u0012\nX\n1X\n2\u03c0j a jn\n1\nm a\n(\u22121)\nf (n) =\ni sin\n\u03c9 = a\n.\nm\nk\nk\n2 0\u2264m\u2264a\nj=0\n\nk|n+a\u22122m\n\nNote that f (\u2212n) = (\u22121)a f (n) and \u2212 k2 < a \u2212 2m < k2 . Thus given any n, there is at most one m\nsuch that k|n + a \u2212 2m. Therefore,\n(\n(\u22121)m a \u0001\nif k|n + a \u2212 2m for some 0 \u2264 m \u2264 a,\n2a\nm\nf (n) =\n0\notherwise.\nWe claim that we can find n (between 0 and k \u2212 1) such that k|n + a \u2212 2m, for any 0 \u2264 m \u2264 a.\nIndeed, if m < a2 then choose n = k \u2212 (a \u2212 2m)), and if m \u2265 a2 then choose n = \u2212(a \u2212 2m). Thus\nby Lemma 3.5 and the Convolution Theorem,\n\u0001\n\u0012\n\u0013 X\na \u0012 \u0013\nk\u22121\nk\u22121\n(\u22121)a 2a\n(\u22121)a X a 2\n(\u22121)a X 2a 2\u03c0j\na\nsin\nf (\u2212n) f (n) = 2a\n=\n=\n.\n22a\nk\nk\n2\nm\nm=0\nn=0\nj=0\n\nThe second identity follows with\n\u0012 \u0013\n\u0012\n\u0012\n\u0013 \u0012\n\u0013\u0013a X\n\u0013\n\u0012\na\nm a\n2a 2\u03c0j\n2m 2\u03c0j\n2 2\u03c0j\n(\u22121)\ncos\nsin\n=\n= 1 \u2212 sin\n,\nm\nk\nk\nk\nm=0\n\nLemma 3.5, and the first identity:\n\u0001 k\u22121\n\u0012\n\u0013 X\n\u0012 \u0013 2m\u0001\na\nX\nk 2a\n2a 2\u03c0j\nm a k m\na\ncos\n=\n(\u22121)\n.\n=\n22a\nk\nm 22m\nj=0\n\n\u0003\n\nm=0\n\n4. Evaluations of Finite Character Sums\nWe review a few definitions on characters. A character \u03c7 (mod k) is a nonzero map from Zk to\nC such that \u03c7(ab) = \u03c7(a)\u03c7(b) and \u03c7(n) = 0 when gcd(n, k) > 1. The principal character mod k is\n(\n1 if gcd(n, k) = 1,\n\u03c70 (n) =\n0 otherwise.\nPk\u22121\nOne of the most basic properties of nonprincipal characters \u03c7 is the fact that j=0\n\u03c7(j) = 0. A\n\u2032\n\u2032\n\u2032\n\u2032\ncharacter \u03c7 (mod k) is induced by a character \u03c7 (mod k ) if k |k and \u03c7 = \u03c7 (where we extend \u03c7\u2032\n\n\f8\n\nMATTHIAS BECK AND MARY HALLORAN\n\nnaturally to Zk ). A character that is not induced by any other character is primitive. We will use\nthe fact that for a nonprincipal, real, primitive character modulo k, where k is odd,\n(\n1\nif k \u2261 \u00b11 mod 8,\n\u03c7(2) =\n\u22121 if k \u2261 \u00b13 mod 8.\nThe reason that class numbers show up in our formulas is the following classic result (see, e.g., [5,\np. 344\u2013346]):\nTheorem 4.1. Let \u03c7 be a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7.\nThen\n(k\u22121)/2\nk\u22121\nX\n1\n1X\n\u03c7(j) .\nj \u03c7(j) =\nh(\u2212k) = \u2212\nk\n2 \u2212 \u03c7(2)\nj=1\n\nj=1\n\nThe Gauss sum G(z, \u03c7) is defined for any z \u2208 C through G(z, \u03c7) =\nresults about Gauss sums are summarized next (see, e.g., [2]).\n\nPk\u22121\nj=0\n\n\u03c7(j) \u03c9 jz . Some basic\n\nTheorem 4.2. For each integer n, \u03c7 is real and primitive if and only if G(n, \u03c7) = \u03c7(n) G(1, \u03c7) =:\n\u03c7(n) G(\u03c7). Now let \u03c7 be a real, primitive character modulo k. Then\n(\u221a\nk\nif \u03c7 is even,\nG(\u03c7) = \u221a\ni k if \u03c7 is odd.\nConsequently, for an integer n,\nk\u22121\n1X\n1\n\u03c7(j) \u03c9 jn = G(n, \u03c7) =\nk\nk\nj=0\n\nIn other words,\n\u03c7\nb(n) =\n\n(\u221a\n\n(\n\nk \u03c7(n)\n\u221a\n\u2212i k \u03c7(n)\n\n\u221a1\nk\n\u221ai\nk\n\n\u03c7(n)\n\nif \u03c7 is even,\n\n\u03c7(n)\n\nif \u03c7 is odd.\n\nif \u03c7 is even,\nif \u03c7 is odd.\n\nNow we're ready to apply the machinery of Section 2 to prove old and new theorems about finite\ntrigonometric sums involving characters. We start with proving Theorem 1.2, which says that, for\n\u03c7 a nonprincipal, real, odd character modulo k, a and b positive integers such that a is odd and\n1 \u2264 ab < k, and x \u2208 R, we have\n\u221a\n\u0012\n\u0013\n\u0012 \u0013\nk\u22121\nX\nX\nk\na 2\u03c0bj\nm\u2212(a\u22121)/2 a\n\u03c7(j) sin\n+ x = a\u22121\n(\u22121)\ncos ((a \u2212 2m)x) \u03c7(n) .\nk\n2\nm\nn,m\u22650\nj=0\n\nn+2mb=ab\n\nProof of Theorem 1.2. Let f (n) =\n\n1\nk\n\n\u0010\n\u0011\u0011a\nPk\u22121 \u0010\n2b\u03c0j\ni\nsin\n+\nx\n\u03c9 nj ; then\nj=0\nk\n\n\u0012 \u0013\na\nk\u22121\nX\n1 X\n1\nm a\n(a\u22122m)xi\nf (n) = a\n(\u22121)\n\u03c9 (n+(a\u22122m)b)j = a\ne\n2 k\nm\n2\nm=0\n\nj=0\n\nX\n\n0\u2264m\u2264a\nk|n+(a\u22122m)b\n\n\u0012 \u0013\na (a\u22122m)xi\n(\u22121)\ne\n.\nm\nm\n\n\fFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER ANALYSIS\n\n9\n\nIf we let sm = (a \u2212 2m)b, then sa\u2212m = \u2212sm , and we can rewrite the above equation as\n\uf8eb\n\uf8f6\n\u0012\n\u0013\n\u0012\n\u0013\nX\na (a\u22122m)xi\na \u2212(a\u22122m)xi \uf8f7\n1 \uf8ec X\n(\u22121)m\ne\n\u2212\n(\u22121)m\nf (n) = a \uf8ed\ne\n\uf8f8.\n2\nm\nm\n0\u2264m<a/2\n0\u2264m<a/2\nk|n+sm\n\nLet g(n) =\n\n\u221ai\nk\n\nk|n\u2212sm\n\n\u03c7(n), then by Corollary 2.5,\n\n\u0013\n\u0012\nk\u22121\nia X\na 2\u03c0bj\n\u03c7(j) sin\n+x\nk\nk\nj=0\n\uf8eb\n\u0012 \u0013\nk\u22121\ni X\n\uf8ec X\nm a\n\u03c7(n) \uf8ed\n(\u22121)\ne(a\u22122m)xi \u2212\n=\u2212 \u221a\nm\n2a k n=0\n0\u2264m<a/2\nk|n+sm\n\n=\u2212\n\ni\n\u221a\n2a k\n\nX\n\n0\u2264m<a/2\n\n\uf8f6\n\u0012\n\u0013\nX\na \u2212(a\u22122m)xi \uf8f7\n(\u22121)m\ne\n\uf8f8\nm\n0\u2264m<a/2\nk|n\u2212sm\n\n\uf8f6\n\u0012 \u0013\nX\na \uf8ec X\n\uf8f7\n(\u22121)m\n\u03c7(n)e\u2212(a\u22122m)xi \uf8f8 .\n\u03c7(n)e(a\u22122m)xi \u2212\n\uf8ed\nm\n0\u2264n<k\n0\u2264n<k\n\uf8eb\n\nk|n\u2212sm\n\nk|n+sm\n\na\n2,\n\nSince 1 \u2264 ab \u2264 k and 0 \u2264 m <\nwe have 0 < sm \u2264 ab < k. Furthermore, since 0 \u2264 n < k, we\nhave for all m\n0 < n + sm < 2k\nand\n\u2212 k < n \u2212 sm < k .\nThus k|n + sm only when n = k \u2212 sm and k|n \u2212 sm only when n = sm . Since for every m there\nexists exactly one n such that n = sm and \u03c7(k \u2212 sm ) = \u2212\u03c7(sm ), then\n\u0012 \u0013\u0010\n\u0013\n\u0012\nk\u22121\n\u0011\nX\ni\nia X\n(a\u22122m)xi\n(a\u22122m)xi\nm a\na 2\u03c0bj\n\u221a\n\u03c7(k\n\u2212\ns\n)e\n\u2212\n\u03c7(s\n)e\n(\u22121)\n\u03c7(j) sin\n+x = \u2212\nm\nm\nm\nk\nk\n2a k 0\u2264m<a/2\nj=0\n\u0012 \u0013\n\u0011\n\u0010\nX\ni\nm a\n= \u221a\n(\u22121)\n\u03c7(sm ) e(a\u22122m)xi + e\u2212(a\u22122m)xi\nm\n2a k 0\u2264m<a/2\n\u0012 \u0013\nX\ni\nm a\n\u221a\n(\u22121)\ncos ((a \u2212 2m)x) \u03c7(n) .\n\u0003\n=\nm\n2a\u22121 k n,m\u22650\nn+2mb=ab\n\nCorollary 4.3. Let \u03c7 be a nonprincipal, real, odd character modulo k and let b be a positive integer\nnot divisible by k. Then\nk\u22121\nX\n\u221a\n2\u03c0bj\n= k \u03c7(b) .\n\u03c7(j) sin\nk\nj=0\n\nWe can use essentially the same proof (or the substitution x 7\u2192 x + \u03c02 ) to arrive at the identity\n\u221a\n\u0012\n\u0013\nk\u22121\nX\nX \u0012a\u0013\nk\na 2\u03c0bj\n\u03c7(j) cos\n+ x = a\u22121\nsin ((a \u2212 2m)x) \u03c7(n) ,\nm\nk\n2\nn,m\u22650\nj=0\n\nn+2mb=ab\n\nwhich holds under the same conditions as in Theorem 1.2.\nThe next result we will tackle appeared in [4, Corollary 2.3].\n\n\f10\n\nMATTHIAS BECK AND MARY HALLORAN\n\nTheorem 4.4 (Berndt\u2013Zaharescu). Suppose \u03c7 is a nonprincipal, real, primitive, odd character\nmodulo k, where k \u2265 7 is odd. Then\nk\u22121\nX\n\n\u03c7(j) cot\n\nj=1\n\n\u221a\n\u03c0j\n= 2 k h(\u2212k) .\nk\n\nProof. We apply Corollary 2.5 with the functions f (n) =\n\nn\nk\n\n\u0001\u0001\n\nand g(n) =\n\n\u221ai \u03c7(n):\nk\n\n\u0013\nk\u22121\nk\u22121 \u0012\n\u03c0j\ni X\ni X m 1\ni\n\u03c7(j) cot\n= \u2212\u221a\n\u2212\n\u03c7(m) = \u221a h(\u2212k) ,\n2k\nk\n2\nk m=1 k\nk\nj=1\nby Theorem 4.1.\n\n\u0003\n\nThe following extension of Theorem 4.4 seems to have gone unnoticed in [4].\nCorollary 4.5. Suppose \u03c7 is a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7\nis odd, and gcd(b, k) = 1. Then\nk\u22121\nX\nj=1\n\n\u03c7(j) cot\n\n\u221a\n\u03c0jb\n= 2 k \u03c7(b) h(\u2212k) .\nk\n\nProof. Since gcd(b, k) = 1, we have\nk\u22121\nk\u22121\nk\u22121\nX\nX\nX\n\u221a\n\u03c0jb\n\u03c0jb\n\u03c0j\n\u03c7(jb) cot\n\u03c7(j) cot\n=\n= \u03c7(b)\n.\n\u03c7(j) cot\n2 kh(\u2212k) =\nk\nk\nk\nj=1\n\nj=1\n\nj=1\n\nThe statement now follows, since \u03c7(b) = \u00b11.\n\n\u0003\n\nWith an essentially identical proof to that of Theorem 4.4 we obtain the tangent analog [4,\nCorollary 5.2].\nTheorem 4.6 (Berndt\u2013Zaharescu). Suppose \u03c7 is a nonprincipal, real, primitive, odd character\nmodulo k, where k \u2265 7 is odd. Then\n( \u221a\nk\u22121\nX\n\u221a\n\u03c0j\nif k \u2261 3 mod 8,\n6 k h(\u2212k)\n\u221a\n\u03c7(j) tan\n= k (2 \u2212 4\u03c7(2)) h(\u2212k) =\nk\n\u22122 k h(\u2212k) if k \u2261 7 mod 8.\nj=1\nTheorems 4.4 and 4.6 and the identity csc 2\u03b8 =\nresult.\n\n1\n2\n\n(tan \u03b8 + cot \u03b8) immediately yield the following\n\nCorollary 4.7. Suppose \u03c7 is a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7\nis odd. Then\n( \u221a\nk\u22121\nX\n\u221a\n4 k h(\u2212k) if k \u2261 3 mod 8,\n2\u03c0j\n= 2 k (1 \u2212 \u03c7(2)) h(\u2212k) =\n\u03c7(j) csc\nk\n0\nif k \u2261 7 mod 8.\nj=1\nAt this point we have all the Fourier series ingredients to prove the following theorem [4, Corollary\n2.2]; however, its Fourier proof is lengthy, so that we omit the details.\n\n\fFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER ANALYSIS\n\n11\n\nTheorem 4.8 (Berndt\u2013Zaharescu). Suppose \u03c7 is a nonprincipal, real, primitive, odd character\nmodulo k, where k \u2265 7 is odd, and a is an odd positive integer such that a \u2212 3 < 2k. Then\n\uf8f6\n\uf8eb\n\u0012 \u0013\n\u0012 \u0013\n\u0012\n\u0013\nk\u22121\nX\nX\n\u221a \uf8ec\n\u03c0j\n\u03c0j\na+1 \uf8f7\ncosa\u22121\n= 2 k \uf8edh(\u2212k) \u2212 21\u2212a\n\u03c7(j) cot\n\u03c7(n)\n\uf8f8.\nk\nk\ns\nn,m,s\u22650\nj=1\n\nn+2m+s=(a\u22121)/2\n\nNow we turn to [4, Theorem 7.1].\n\nTheorem 4.9 (Berndt\u2013Zaharescu). Suppose \u03c7 is a nonprincipal, real, primitive, odd character\nmodulo k, where k \u2265 7 is odd, and b is a positive integer such that b \u2264 k. Then\n!\n\u0012\n\u0013\n\u0012 \u0013\nk\u22121\nb\u22121\nX\nX\n\u221a\n2\u03c0bj\n\u03c0j\ncos\n= k 2h(\u2212k) \u2212 \u03c7(b) \u2212 2\n\u03c7(j) cot\n\u03c7(n) .\nk\nk\nn=1\nj=1\n\n\u03c0j jn\ni Pk\u22121\nProof of Theorem 4.9. By applying the Convolution Theorem to the functions f (n) = 2k\nj=1 cot k \u03c9\nPk\u22121\nand g(n) = j=1 \u03c7(j)\u03c9 jn , one obtains after a somewhat tedious but straightforward calculation\nthe Fourier transform\n!\nk\u22121\nn\nX\n1X\n\u03c0j jn\n1\n(2)\nF (n) =\n\u03c7(j) cot \u03c9 = \u221a\n2h(\u2212k) + \u03c7(n) \u2212 2\n\u03c7(m) .\nk\nk\nk\nm=0\nj=1\n\nNow we convolve this function with\nh(n) =\n\n(\n\n1\n2\n\n0\n\nif k|b + n or k|b \u2212 n,\notherwise,\n\n\u0001\n2\u03c0bn\n\nthe Fourier transform of cos k . The Convolution Theorem gives\n\u0012 \u0013\n\u0012\n\u0013 X\nk\u22121\nk\u22121\n1X\n\u03c0j\n2\u03c0bj\n\u03c7(j) cot\nF (n) h(\u2212n)\ncos\n=\nk\nk\nk\nn=0\nj=1\n\n1\n= \u221a\n2 k\n1\n=\u221a\nk\n\n4h(\u2212k) + \u03c7(b) + \u03c7(k \u2212 b) \u2212 2\n2h(\u2212k) \u2212 \u03c7(b) \u2212 2\n\nb\u22121\nX\n\nn=1\n\n!\n\nb\nX\n\n\u03c7(m) +\n\nm=0\n\nk\u2212b\nX\n\nm=0\n\n\u03c7(n) .\n\n!!\n\n\u03c7(m)\n\n\u0003\n\nThere are innumerable siblings of Theorem 4.9 that one can prove with the same methods, and\nwe will give some of them below. The only difficulty lies in the computation of (more and more\ninvolved) Fourier transforms. For example, the following theorem is as easily proved as the previous\nonce one has computed the Fourier transform\n!\n\u0012 \u0013\nk\u22121\nn\nX\nX\n\u221a\n\u03c0j\n\u03c7(j) cot 2\n\u03c9 jn = i k 4n h(\u2212k) \u2212 \u03c7(n) \u2212 4\n\u03c7(m)(m \u2212 n)\nk\nj=1\n\n(where \u03c7 satisfies the conditions stated in the theorem).\n\nm=0\n\n\f12\n\nMATTHIAS BECK AND MARY HALLORAN\n\nTheorem 4.10. Suppose \u03c7 is a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7\nis odd. Then\n!\n\u0012 \u0013\n\u0012\n\u0013\nk\u22121\na\u22121\nX\nX\n\u221a\n\u03c0j\n2\u03c0aj\n\u03c7(j) cot 2\nsin\n= k 4a h(\u2212k) \u2212 \u03c7(a) \u2212 4\n\u03c7(m)(a \u2212 m) .\nk\nk\nm=0\n\nj=1\n\nOur final goal is a discrete Fourier proof of Berndt\u2013Zaharescu's Theorem 1.1, namely, for \u03c7 a\nnonprincipal, real, primitive, odd character modulo k, where k \u2265 7 is odd, we have\n\u0010 \u0011\n( \u221a\n\u221a\nk\u22121\nsin2 \u03c0j\nX\nk\n\u22123 k h(\u2212k) if k \u2261 3 mod 8,\n3 k\n\u0010 \u0011 =\n(\u03c7(2) \u2212 1) h(\u2212k) =\n\u03c7(j)\n4\u03c0j\n2\n0\nif k \u2261 7 mod 8.\nsin\nj=1\n\nSince\n\n1\nsin(2\u03b8)\n\n=\n\nk\n\n1\n2\n\n(cot \u03b8 + tan \u03b8) and cot(2\u03b8) =\n\n1\n2\n\n(cot \u03b8 \u2212 tan \u03b8),\n\n\u0010 \u0011\n\u0012 \u0013\n\u0012 \u0013\n\u0012 \u0013\n\u0012 \u0013\nk\u22121\nk\u22121\nsin2 \u03c0j\nk\n1X\n\u03c0j\n\u03c0j\n\u03c0j\n\u03c0j\n1X\n2\n2\n\u0010 \u0011 =\n\u03c7(j)\n\u03c7(j) sin\n\u03c7(j) sin\ncot\n\u2212\ntan\n4\nk\nk\n4\nk\nk\nsin 4\u03c0j\nj=1\nj=1\nj=1\nk\n\u0012 \u0013\n\u0012\n\u0013\nk\u22121\n2\u03c0j\n1X\n2 \u03c0j\n\u03c7(j) sin\ntan\n,\n+\n2\nk\nk\n\nk\u22121\nX\n\nj=1\n\nand so Theorem 1.1 follows from Theorems 4.11, 4.12, and 4.13 below, which we believe to be novel.\nSince the proofs are very similar to the ones we have given above, we outline only which functions\nto convolve in each case. We need the discrete Fourier transform of \u03c7(n) cot \u03c0n\nk which we derived\nin (2), and the following transforms which are easily verified.\n\uf8f1\n1\n\uf8f4\n\u0012 \u0013\nif k|n,\nk\u22121\n\uf8f22\nX\n1\n\u03c0j\n2\njn\n1\nsin\n\u03c9 = \u2212 4 if k|(n + 1) or k|(n \u2212 1),\n(3)\n\uf8f4\nk\nk\n\uf8f3\nj=0\n0\notherwise,\n\uf8f1\n\uf8f40\nif k|n,\nk\u22121\n2\u03c0j jn \uf8f2\niX\ntan\n\u03c9 = 1\n(4)\nif n \u2261 0, 1 mod k and k \u2224 n,\n\uf8f4\nk\nk\n\uf8f3\nj=0\n\u22121 if n \u2261 2, 3 mod k and k \u2224 n.\n\nThe last identity is only valid for k \u2261 3 mod 4, but this suffices for our purposes: for a character\nmodulo k to be nonprincipal, real, primitive, and odd, k has to be congruent to 3 mod 4.\n\nTheorem 4.11. Suppose \u03c7 is a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7\nis odd. Then\n\u0012 \u0013\n\u0012 \u0013\nk\u22121\nX\n\u03c0j\n1\u221a\n2 \u03c0j\n\u03c7(j) sin\ncot\n=\nk.\nk\nk\n2\nj=1\n\nProof. Convolve the discrete Fourier transform of sin2\n\n\u03c0n\nk\n\n\u0001\n\nwith that of \u03c7(n) cot\n\n\u03c0n\nk\n\n\u0001\n\n.\n\n\u0003\n\n\fFINITE TRIGONOMETRIC CHARACTER SUMS VIA DISCRETE FOURIER ANALYSIS\n\n13\n\nTheorem 4.12. Suppose \u03c7 is a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7\nis odd. Then\n\u0013\n\u0012 \u0013\n\u0012 \u0013\n\u0012\nk\u22121\nX\n\u221a\n\u03c0j\n1\n2 \u03c0j\n\u03c7(j) sin\ntan\n= k \u2212 + (2 \u2212 4 \u03c7(2)) h(\u2212k)\nk\nk\n2\nj=1\n(\u221a\n\u0001\nk \u2212 21 + 6h(\u2212k)\nif k \u2261 3 mod 8,\n\u0001\n= \u221a\n1\nif k \u2261 7 mod 8.\nk \u2212 2 \u2212 2h(\u2212k)\nPk\u22121\njn\n\u03c7(j) tan \u03c0j\nProof. Let t(n) := k1 j=0\nk \u03c9 ; we will convolve this function with the discrete Fourier\n\u0001\ntransform of sin2 \u03c0n\nk . Because of the special form of the latter, we only need to compute\n\n1\n1\nt(0) = \u2212 \u221a (4 \u03c7(2) \u2212 2) h(\u2212k)\nand\nt(1) = \u221a (1 + (4 \u03c7(2) \u2212 2) h(\u2212k)) ,\nk\nk\nand the statement now follows with the Convolution Theorem.\n\n\u0003\n\nTheorem 4.13. Suppose \u03c7 is a nonprincipal, real, primitive, odd character modulo k, where k \u2265 7\nis odd. Then\n\u0012 \u0013\n\u0012\n\u0013\n\u0012\n\u0013\nk\u22121\nX\n\u221a\n1\n2\u03c0j\n2 \u03c0j\n\u03c7(j) sin\ntan\n= k \u2212 + (\u03c7(2) \u2212 2) h(\u2212k)\nk\nk\n2\nj=1\n(\u221a\n\u0001\nk \u2212 21 \u2212 3 h(\u2212k)\nif k \u2261 3 mod 8,\n\u221a\n\u0001\n=\n1\nk \u2212 2 \u2212 h(\u2212k)\nif k \u2261 7 mod 8.\n\u0010 \u0011\n\u0001\n2\u03c0j\n1 Pk\u22121\nProof. We convolve the Fourier transform of sin2 \u03c0n\n\u03c7(j)\ntan\nwith\ns(n)\n:=\n. Again\nj=1\nk\nk\nk\nwe only need to know only a few of the values of s(n), since by (3) we obtain\n\u0012 \u0013\n\u0012\n\u0013\nk\u22121\n1X\n2\u03c0j\n1\n1\n2 \u03c0j\n\u03c7(j) sin\ntan\n= s(0) \u2212 (s(1) + s(k \u2212 1)) .\nk\nk\nk\n2\n4\nj=1\n\nThe value s(0) can be easily derived by a quick convolution calculation:\n( 6\n\u0012\n\u0013\nk\u22121\n\u2212 \u221ak h(\u2212k)\n2\u03c0j\n1X\n1\n\u03c7(j) tan\ns(0) =\n= \u221a (2 \u03c7(2) \u2212 4) h(\u2212k) =\nk\nk\n\u2212 \u221a2 h(\u2212k)\nk\nj=1\n\nk\n\nif k \u2261 3 mod 8,\nif k \u2261 7 mod 8.\n\nIt remains to compute s(1) + s(k \u2212 1). Let's denote the right-hand side of (4) by\n\uf8f1\n\uf8f4\nif k|n,\n\uf8f20\nr(n) := 1\nif n \u2261 0, 1 mod k and k \u2224 n,\n\uf8f4\n\uf8f3\n\u22121 if n \u2261 2, 3 mod k and k \u2224 n.\nPk\u22121\nThus by the Convolution Theorem, s(n) = \u221a1k m=0\nr(n \u2212 m) \u03c7(m), whence\n1\ns(1) + s(k \u2212 1) = \u221a\nk\n\nk\u22121\nX\n\nm=0\n\nr(1 \u2212 m) \u03c7(m) +\n\nk\u22121\nX\n\nm=0\n\n!\n\nr(k \u2212 1 \u2212 m) \u03c7(m) .\n\n\f14\n\nMATTHIAS BECK AND MARY HALLORAN\n\nSince \u03c7 and r are both odd and \u03c7(0) = r(0) = 0,\n1\ns(1) + s(k \u2212 1) = \u2212 \u221a\nk\n\nk\u22121\nX\n\nm=2\n\nr(m \u2212 1) \u03c7(m) +\n\nk\u22122\nX\n\n!\n\nr(m + 1) \u03c7(m)\n\nm=1\n\n!\nk\u22122\nX\n\u0001\n1\n= \u2212\u221a\n\u03c7(m) r(m \u2212 1) + r(m + 1)\nr(k \u2212 2) \u03c7(k \u2212 1) + r(2) \u03c7(1) +\nk\nm=2\n2\n=\u221a .\nk\nHere the last equation follows from the fact that for 2 \u2264 m \u2264 k \u2212 2, r(m \u2212 1) + r(m + 1) = 0, as\ncan be directly concluded from the definition of r.\n\u0003\nReferences\n1. B. C. Berndt and Liang Cheng Zhang, Ramanujan's identities for eta-functions, Math. Ann. 292 (1992), no. 3,\n561\u2013573. MR MR1152951 (93g:11039)\n2. Bruce C. Berndt, Ronald J. Evans, and Kenneth S. Williams, Gauss and Jacobi sums, Canadian Mathematical Society Series of Monographs and Advanced Texts, John Wiley & Sons Inc., New York, 1998, , A Wiley-Interscience\nPublication. MR MR1625181 (99d:11092)\n3. Bruce C. Berndt and Boon Pin Yeap, Explicit evaluations and reciprocity theorems for finite trigonometric sums,\nAdv. in Appl. Math. 29 (2002), no. 3, 358\u2013385. MR 2003h:11092\n4. Bruce C. Berndt and Alexandru Zaharescu, Finite trigonometric sums and class numbers, Math. Ann. 330 (2004),\nno. 3, 551\u2013575. MR MR2099193 (2005f:11173)\n5. A. I. Borevich and I. R. Shafarevich, Number theory, Translated from the Russian by Newcomb Greenleaf. Pure\nand Applied Mathematics, Vol. 20, Academic Press, New York, 1966. MR MR0195803 (33 #4001)\n6. Wenchang Chu and Alberto Marini, Partial fractions and trigonometric identities, Adv. in Appl. Math. 23 (1999),\nno. 2, 115\u2013175. MR MR1699235 (2000i:33001)\n7. G. Eisenstein, Aufgaben und Lehrs\u00e4tze, J. Reine Angew. Math. 27 (1844), 281\u2013283.\n8. Zhi-Guo Liu, Some Eisenstein series identities related to modular equations of the seventh order, Pacific J. Math.\n209 (2003), no. 1, 103\u2013130. MR MR1973936 (2004c:11052)\n9. M. Stern, \u00fcber einige Eigenschaften der Funktion Ex, J. Reine Angew. Math. 59 (1861), 146\u2013162.\n10. Audrey Terras, Fourier Analysis on Finite Groups and Applications, London Mathematical Society Student\nTexts, vol. 43, Cambridge University Press, Cambridge, 1999. MR 2000d:11003\n11. Kai Wang, Exponential sums of Lerch's zeta functions, Proc. Amer. Math. Soc. 95 (1985), no. 1, 11\u201315.\nMR MR796438 (86j:11084)\n12. Kenneth S. Williams and Nan Yue Zhang, Evaluation of two trigonometric sums, Math. Slovaca 44 (1994), no. 5,\n575\u2013583, Number theory (Ra\u010dkova dolina, 1993). MR 96d:11088\nDepartment of Mathematics, San Francisco State University, San Francisco, CA 94132, U.S.A.\nE-mail address: beck@math.sfsu.edu, mahall@sfsu.edu\n\n\f"}