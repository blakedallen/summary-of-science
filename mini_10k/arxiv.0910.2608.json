{"id": "http://arxiv.org/abs/0910.2608v1", "guidislink": true, "updated": "2009-10-14T13:01:10Z", "updated_parsed": [2009, 10, 14, 13, 1, 10, 2, 287, 0], "published": "2009-10-14T13:01:10Z", "published_parsed": [2009, 10, 14, 13, 1, 10, 2, 287, 0], "title": "Random 3-noncrossing partitions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0910.2026%2C0910.4076%2C0910.0772%2C0910.5459%2C0910.3221%2C0910.2325%2C0910.5863%2C0910.5171%2C0910.2603%2C0910.1063%2C0910.3161%2C0910.1616%2C0910.2070%2C0910.0681%2C0910.3806%2C0910.0436%2C0910.4306%2C0910.2700%2C0910.1450%2C0910.3934%2C0910.0567%2C0910.0524%2C0910.3958%2C0910.3227%2C0910.5059%2C0910.2053%2C0910.3236%2C0910.1323%2C0910.1796%2C0910.5213%2C0910.0734%2C0910.1088%2C0910.3819%2C0910.2257%2C0910.3722%2C0910.4963%2C0910.1802%2C0910.2884%2C0910.1927%2C0910.5206%2C0910.0144%2C0910.3402%2C0910.4410%2C0910.5716%2C0910.4459%2C0910.4280%2C0910.3431%2C0910.4325%2C0910.5825%2C0910.3760%2C0910.0313%2C0910.1039%2C0910.4067%2C0910.2065%2C0910.3673%2C0910.2054%2C0910.5821%2C0910.3816%2C0910.0417%2C0910.5836%2C0910.3922%2C0910.2429%2C0910.5145%2C0910.2465%2C0910.4886%2C0910.2256%2C0910.3498%2C0910.2197%2C0910.5822%2C0910.1567%2C0910.4047%2C0910.0653%2C0910.1160%2C0910.1815%2C0910.2487%2C0910.3899%2C0910.1005%2C0910.4373%2C0910.5479%2C0910.4409%2C0910.3256%2C0910.0515%2C0910.0853%2C0910.3181%2C0910.4503%2C0910.4322%2C0910.3695%2C0910.0111%2C0910.0482%2C0910.3230%2C0910.5533%2C0910.2608%2C0910.0322%2C0910.1426%2C0910.2390%2C0910.2720%2C0910.4328%2C0910.1029%2C0910.2331%2C0910.2699%2C0910.1210&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Random 3-noncrossing partitions"}, "summary": "In this paper, we introduce polynomial time algorithms that generate random\n3-noncrossing partitions and 2-regular, 3-noncrossing partitions with uniform\nprobability. A 3-noncrossing partition does not contain any three mutually\ncrossing arcs in its canonical representation and is 2-regular if the latter\ndoes not contain arcs of the form $(i,i+1)$. Using a bijection of Chen {\\it et\nal.} \\cite{Chen,Reidys:08tan}, we interpret 3-noncrossing partitions and\n2-regular, 3-noncrossing partitions as restricted generalized vacillating\ntableaux. Furthermore, we interpret the tableaux as sampling paths of\nMarkov-processes over shapes and derive their transition probabilities.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0910.2026%2C0910.4076%2C0910.0772%2C0910.5459%2C0910.3221%2C0910.2325%2C0910.5863%2C0910.5171%2C0910.2603%2C0910.1063%2C0910.3161%2C0910.1616%2C0910.2070%2C0910.0681%2C0910.3806%2C0910.0436%2C0910.4306%2C0910.2700%2C0910.1450%2C0910.3934%2C0910.0567%2C0910.0524%2C0910.3958%2C0910.3227%2C0910.5059%2C0910.2053%2C0910.3236%2C0910.1323%2C0910.1796%2C0910.5213%2C0910.0734%2C0910.1088%2C0910.3819%2C0910.2257%2C0910.3722%2C0910.4963%2C0910.1802%2C0910.2884%2C0910.1927%2C0910.5206%2C0910.0144%2C0910.3402%2C0910.4410%2C0910.5716%2C0910.4459%2C0910.4280%2C0910.3431%2C0910.4325%2C0910.5825%2C0910.3760%2C0910.0313%2C0910.1039%2C0910.4067%2C0910.2065%2C0910.3673%2C0910.2054%2C0910.5821%2C0910.3816%2C0910.0417%2C0910.5836%2C0910.3922%2C0910.2429%2C0910.5145%2C0910.2465%2C0910.4886%2C0910.2256%2C0910.3498%2C0910.2197%2C0910.5822%2C0910.1567%2C0910.4047%2C0910.0653%2C0910.1160%2C0910.1815%2C0910.2487%2C0910.3899%2C0910.1005%2C0910.4373%2C0910.5479%2C0910.4409%2C0910.3256%2C0910.0515%2C0910.0853%2C0910.3181%2C0910.4503%2C0910.4322%2C0910.3695%2C0910.0111%2C0910.0482%2C0910.3230%2C0910.5533%2C0910.2608%2C0910.0322%2C0910.1426%2C0910.2390%2C0910.2720%2C0910.4328%2C0910.1029%2C0910.2331%2C0910.2699%2C0910.1210&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper, we introduce polynomial time algorithms that generate random\n3-noncrossing partitions and 2-regular, 3-noncrossing partitions with uniform\nprobability. A 3-noncrossing partition does not contain any three mutually\ncrossing arcs in its canonical representation and is 2-regular if the latter\ndoes not contain arcs of the form $(i,i+1)$. Using a bijection of Chen {\\it et\nal.} \\cite{Chen,Reidys:08tan}, we interpret 3-noncrossing partitions and\n2-regular, 3-noncrossing partitions as restricted generalized vacillating\ntableaux. Furthermore, we interpret the tableaux as sampling paths of\nMarkov-processes over shapes and derive their transition probabilities."}, "authors": ["Jing Qin", "Christian M. Reidys"], "author_detail": {"name": "Christian M. Reidys"}, "author": "Christian M. Reidys", "arxiv_comment": "17 pages, 7 figures", "links": [{"href": "http://arxiv.org/abs/0910.2608v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0910.2608v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05A19", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0910.2608v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0910.2608v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:0910.2608v1 [math.CO] 14 Oct 2009\n\nRANDOM 3-NONCROSSING PARTITIONS\nJING QIN AND CHRISTIAN M. REIDYS\n\nAbstract. In this paper, we introduce polynomial time algorithms that generate random 3noncrossing partitions and 2-regular, 3-noncrossing partitions with uniform probability. A 3noncrossing partition does not contain any three mutually crossing arcs in its canonical representation and is 2-regular if the latter does not contain arcs of the form (i, i + 1). Using a\nbijection of Chen et al. [2, 4], we interpret 3-noncrossing partitions and 2-regular, 3-noncrossing\npartitions as restricted generalized vacillating tableaux. Furthermore, we interpret the tableaux\nas sampling paths of Markov-processes over shapes and derive their transition probabilities.\n\n1. Introduction\n\nRecently, a paper written by Chen et. al. [3] attracts our attention. According to the bijection\nbetween the k-noncrossing matchings and the oscillating tableaux [2], they identify the latter as\nstochastic processes over Young tableaux of less than k rows in order to uniformly generate a knoncrossing matching. Furthermore, since the generating function of the corresponding oscillating\nlattice walks in Zk\u22121 that remains in the interior of the dominant Weyl chamber has been given by\nGrabiner and Magyar [7], the key quantities, the transition probabilities of the specific stochastic\nprocesses can be derived with linear time complexity.\nThe objective to enumerate k-noncrossing partitions is much more difficult since the corresponding\nlattice walks are not reflectable [6] in Zk\u22121 in case of k \u2265 3. Only the case for k = 3 has been\nsolved by Bousquet-M\u00e9lou and Xin in [1] via the celebrated kernel method. Also in their paper, they\nconjecture that k-noncrossing partitions are not P -recursive for k \u2265 4. For k = 3, what BousquetM\u00e9lou and Xin need in order to enumerate 3-noncrossing partition is the number of corresponding\nKey words and phrases. 3-noncrossing partition, 2-regular 3-noncrossing partition, uniform generation, kernel\nmethod.\n1\n\n\f2\n\nJING QIN AND CHRISTIAN M. REIDYS\n\nlattice walks starting and ending at (1, 0) \u2208 Z2 . However, our main idea is to interpret the\ncorresponding vacillating tableaux as sampling paths of Markov-processes over shapes and derive\ntheir transition probabilities, see Fig. 1. In order to derive the transition probabilities, what we\nneed is the number of the corresponding lattice walks ending at arbitrary (i, j) \u2208 Z2 such that\ni > j \u2265 0.\nThis paper is organized as follows. Section 2 describes the basic facts of 3-noncrossing partitions and\n2-regular, 3-noncrossing partitions. Section 3 shows the reader how we explore more information\nfrom the kernel equations. In the meantime, we generate a 3-noncrossing braid since we will prove\nthere exists a bijection between the set of k-noncrossing partitions over [N ] = {1, 2, . . . , N } and the\nset of k-noncrossing braids over [N \u22121]. Furthermore, in the Section 4, we will show the reader how\nto arrive at the transition probabilities of corresponding lattice walks for 2-regular, 3-noncrossing\npartitions from the fact that there exists a bijection between the set of 2-regular, k-noncrossing\npartitions over [N ] and the set of k-noncrossing braids without loops over [N \u2212 1].\nStep 1\n\n(A)\n\nStep 2\n\nStep 3\n\nStep 4\n\nStep 5\n\nStep 6\n\nStep 7\n\nStep 8\n\nP=1/5\nP=5/14\nP=1\n\nP=5/9\n\nP=1\n\nP=1/2\n\nP=1/5\n\nP=9/14\n\nP=2/3\nP=4/9\n\nP=3/5\n\n(B)\n\nP=1/2\n\nP=1\n\nP=1\n\nP=1/3\n\nP=1\n\nP=1\n\nP=5/14\n\nP=5/9\n\nP=3/5\n\nP=2/3\n\nP=1/2\n\nP=1\n\nP=1\n\n1\u00d71\u00d7(9/14)\u00d7(5/9)\u00d7(3/5)\u00d7(2/3)\u00d7(1/2)\u00d71\u00d71=1/14\n\n(C)\n1\n\n2\n\n3\n\n4\n\nFigure 1. The idea behind the uniform generation: we consider a stochastic process\nover shapes (A) extract a specific sampling path (B) and (C) display the corresponding\n3-noncrossing partition structure induced by this path. The probabilities given in (B) are\nthe conditional probabilities with respect to their last step. The transition probabilities\nfor given k = 3 and N are computed in Theorem 3.3 as a preprocessing step in polynomial\ntime.\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n3\n\n2. Some basic facts\n\nA set partition P of [N ] is a collection of nonempty and mutually disjoint subsets of [N ], called\nblocks, whose union is [N ]. A k-noncrossing partition is called m-regular, m \u2265 1, if for any two\ndistinct elements x, y in the same block, we have |x \u2212 y| \u2265 m. A partial matching and a matching\nis a particular type of partition having block size at most two and exactly two, respectively. Their\nstandard representation is a unique graph on the vertex set [N ] whose edge set consists of arcs\nconnecting the elements of each block in numerical order, see Fig. 2.\n\n1 2 3 4 5 6 7 8 9 10 11 12131415\n\nFigure 2. Standard representation and k-crossings: we display the partition {2}, {8},\n{11}, {1, 5}, {6, 12}, {9, 15}, {13, 14}, {3, 7, 10} of [15]. Elements within blocks are\nconnected in numerical order. The arcs {(1, 5), (3, 7)}, {(3, 7), (6, 12)} {(7, 10), (9, 15)}\nand {(6, 12), (9, 15)} are all 2-crossings.\n\nGiven a (set) partition P , a k-crossing is a set of k edges {(i1 , j1 ), (i2 , j2 ), . . . , (ik , jk )} such that\ni1 < i2 < . . . < ik < j1 < j2 < . . . < jk , see Fig.2. A k-noncrossing partition is a partition without\nany k-crossings. We denote the sets of k-noncrossing partitions and m-regular, k-noncrossing\npartitions by Pk (N ) and Pk,m (N ), respectively. For instance, the set of 2-regular, 3-noncrossing\npartitions are denoted by P3,2 (N ).\nA (generalized) vacillating tableau [4] V\u03bb2N of shape \u03bb and length 2N is a sequence \u03bb0 , \u03bb1 , . . . , \u03bb2N\nof shapes such that (1) \u03bb0 = \u2205, \u03bb2N = \u03bb and (2) for 1 \u2264 i \u2264 N , \u03bb2i\u22121 , \u03bb2i are derived from \u03bb2i\u22122\nby elementary moves (EM) defined as follows: (\u2205, \u2205): do nothing twice; (\u2212\u0003, \u2205): first remove a\nsquare then do nothing; (\u2205, +\u0003): first do nothing then add a square; (\u00b1\u0003, \u00b1\u0003): add/remove a\nsquare at the odd and even steps, respectively. We use the following notation: if \u03bbi+1 is obtained\nfrom \u03bbi by adding, removing a square from the j-th row, or doing nothing we write \u03bbi+1 \\\u03bbi = +\u0003j ,\n\u03bbi+1 \\ \u03bbi = \u2212\u0003j or \u03bbi+1 \\ \u03bbi = \u2205, respectively, see Fig.3.\nA braid over [N ] can be represented via introducing loops (i, i) and drawing arcs (i, j) and (j, l)\nwith i < j < l as crossing, see Fig.4 (B1). A k-noncrossing braid is a braid without any k-crossings.\nWe denote the set of k-noncrossing braids over [N ] with and without isolated points by Bk (N )\nand B\u2217k (N ), respectively. Chen et al. [2] have shown that each k-noncrossing partition corresponds\n\n\f4\n\nJING QIN AND CHRISTIAN M. REIDYS\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10 11 12 13 14 15 16\n\n17 18 19 20\n\n( A1 )\n( A2 )\n\n+\n\n1\n\n+\n\n1\n\n+\n\n1\n\n+\n\n1\n\n-\n\n1\n\n-\n\n1\n\n+\n\n1\n\n+\n\n2\n\n-\n\n2\n\n+\n\n2\n\n-\n\n-\n\n1\n\n+\n\n1\n\n+\n\n2\n\n-\n\n2\n\n-\n\n1\n\n+\n\n1\n\n+\n\n2\n\n-\n\n2\n\n-\n\n1\n\n+\n\n2\n\n-\n\n2\n\n+\n\n2\n\n-\n\n2\n\n+\n\n2\n\n-\n\n2\n\n+\n\n2\n\n-\n\n2\n\n-\n\n1\n\n2\n\n+\n\n2\n\n+\n\n1\n\n-\n\n-\n\n2\n\n1\n\n( B1 )\n( B2 )\n\n(C1)\n(C2)\n\n+\n\n1\n\n-\n\n1\n\nFigure 3. Vacillating tableaux and elementary moves: (A1) shows a general vacillating\ntableaux with EM (A2). (B1) displays another vacillating tableaux and its set of EM,\n{(\u2212\u0003, \u2205), (\u2205, +\u0003), (\u2205, \u2205), (\u2212\u0003, +\u0003)} shown in (B2). In (C1) we present a vacillating\ntableaux with the EM {(\u2212\u0003, \u2205), (\u2205, +\u0003), (\u2205, \u2205), (+\u0003, \u2212\u0003)} displayed in (C2).\n\nuniquely to a vacillating tableau of empty shape, having at most (k \u2212 1) rows, obtained via the\nEM {(\u2212\u0003, \u2205), (\u2205, +\u0003), (\u2205, \u2205), (\u2212\u0003, +\u0003)}, see Fig.4 (A2). In [4], Chen et al. proceed by proving\nthat vacillating tableaux of empty shape, having at most (k \u2212 1)-rows which are obtained by the\nEMs {(\u2212\u0003, \u2205), (\u2205, +\u0003), (\u2205, \u2205), (+\u0003, \u2212\u0003)} correspond uniquely to k-noncrossing braids.\n( B1 )\n\n( A1 )\n\n1 2 3 4 5 6 7 8 9 10 11 12131415\n\n1 2 3 4 5 6 7 8 9 10 11 121314\n\n(A2)\n0 1\n\n9 10 11 12 13 14 15 16 17\n\n18 19 20 212223 24 25\n\n26 27 28 29 30\n\n4 5 6 7 8 9 10 11 12 13 14 15 16 17\n\n18 19 20 212223 24 25\n\n26 27 28\n\n2 3 4 5 6 7\n\n8\n\n(B2)\n0 1\n\n2 3\n\nFigure 4. Vacillating tableaux, partitions and braids: in (A1) we show a 3-noncrossing\npartition and in (A2) the associated vacillating tableau. (B1) shows a 3-noncrossing braid\nand (B2) its vacillating tableau.\n\nIn the following, we consider 3-noncrossing partition or a 2-regular, 3-noncrossing partition of N\nvertices, where N \u2265 1. To this end, we introduce two Z2 domains Q2 = {(a1 , a2 ) \u2208 Z2 | a1 , a2 \u2265 0}\nand W2 = {(a1 , a2 ) \u2208 Z2 | a1 > a2 \u2265 0}. Let D \u2208 {Q2 , W2 }, e1 = (1, 0) and e2 = (0, 1). A\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n5\n\nPD -walk is a lattice walk in D starting at (1, 0) having steps \u00b1e1 , \u00b1e2 , 0 = (0, 0), such that even\nsteps are +e1 , +e2 , or 0 and odd steps are either \u2212e1 , \u2212e2 , or 0. Analogously, a BD -walk is a\nlattice walk in D starting at (1, 0) whose even steps are either \u2212e1 , \u2212e2 , or 0 and whose odd steps\nare +e1 , +e2 , or 0. By abuse of language, we will omit the subscript D.\nInterpreting the number of squares in the rows of the shapes as coordinates of lattice points, we\nimmediately obtain\nTheorem 2.1. [4]\n(1) The number of 3-noncrossing partitions over [N ] equals the number of PW2 -walks from (1, 0)\nto itself of length 2N .\n(2) The number of 3-noncrossing braids over [N ] equals the number of BW2 -walks from (1, 0) to\nitself of length 2N .\n\n3. Random 3-noncrossing partitions\n\nIn the following, set x\u0304 = 1/x and \u0233 = 1/y. We work in the ring of power series in t whose\ncoefficients are Laurent polynomials in x and y, denoted by Q[x, x\u0304, y, \u0233][[t]]. We first review some\ncalculations of [1]. Let ai,j\ns denote the number of PQ2 -walks of length s ending at (i, j) \u2208 Q2 and\nX i,j\nX i,j\n(3.1)\nFe (x, y; t) =\na2l xi y j t2l and Fo (x, y; t) =\na2l+1 xi y j t2l+1\ni,j,l\n\ni,j,l\n\ndenote the generating functions of PQ2 -walks of even and odd length and ending at (i, j), respectively. In particular, let He (x; t) = Fe (x, 0; t) and Ve (y; t) = Fe (0, y; t) denote the generating\nfunctions of even PQ2 -walks ending on the x-axis and y-axis.\nProposition 3.1. [1] Let V (y; t) = Ve (y; t2 ), H(x; t) = He (x; t2 ), then\n(3.2)\n\nFe (x, y; t) = x + Fo (x, y; t)(1 + x + y)t,\n\n(3.3)\n\nK(x, y; t) F (x, y; t) = xy + x2 y + x2 \u2212 xH(x, t) \u2212 yV (y, t),\n\nwhere F (x, y; t) =\n(3.4)\n\nP\n\ni,j,l\n\nfli,j xi y j tl is given by Fo (x, y; t) = tF (x, y; t2 ) and\nK(x, y; t) := xy \u2212 t(1 + x + y)(x + y + xy)\n\nis called the kernel of eq. (3.3).\n\n\f6\n\nJING QIN AND CHRISTIAN M. REIDYS\n\ni\u22121,j\ni,j\u22121\ni,j\nEq. (3.2) follows from a1,0\n= 1 and ai,j\n0\n2l = a2l\u22121 + a2l\u22121 + a2l\u22121 for 1 \u2264 l \u2264 N . In view of\nProposition 3.1, F (x, y; t) is the key for enumerating PQ2 -walks. We observe that\np\n1 \u2212 (x\u0304 + 3 + x)t \u2212 (1 \u2212 (1 + x + x\u0304t))2 \u2212 4t\nY0 =\n2(1 + x\u0304)t\n\nis the unique power-series solution in t of the kernel equation K(x, y; t) = 0, whence\n(3.5)\n\nxY0 = t(1 + x + Y0 )(x + Y0 + xY0 ).\n\nSince K(x, y; t) is quadratic in both x and y, (x, Y0 ) can be regarded as a pair of Laurent series in\nt with coefficients satisfying K(x, Y0 ; t) = 0. As (x\u0304Y0 , Y0 ) and (x\u0304Y0 , x\u0304) also solve K(x, y; t) = 0, we\narrive at\nxY0 + x2 Y0 + x2 ,\n\n(3.6)\n\nxH(x; t) + Y0 V (Y0 ; t) =\n\n(3.7)\n\nx\u0304Y0 H(x\u0304Y0 ; t) + Y0 V (Y0 ; t) =\n\nx\u0304Y02 + x\u03042 Y03 + x\u03042 Y02 ,\n\n(3.8)\n\nx\u0304Y0 H(x\u0304Y0 ; t) + x\u0304V (x\u0304; t) =\n\nx\u03042 Y0 + x\u03043 Y02 + x\u03042 Y02 .\n\nIndeed, we can conclude from eqs. (3.6)-(3.8)\n(3.9)\n\nxH(x) + x\u0304V (x\u0304) = x2 + (x\u03042 + x + x2 )Y0 + (x\u03043 \u2212 x\u0304)Y02 \u2212 x\u03042 Y03 .\n\nSince H and V are generating functions, xH(x; t) contains only positive powers of x. Similarly,\nx\u0304V (x\u0304; t) contains only negative powers of x. Therefore, setting NTx and PTx to be the operators\nthat extract the positive and negative powers of x from a power series in Q[x, x\u0304][[t]], we arrive at\n(3.10)\n\nxH(x; t)\n\n=\n\n(3.11)\n\nx\u0304V (x\u0304; t) =\n\nPTx [x2 + (x\u03042 + x + x2 )Y0 + (x\u03043 \u2212 x\u0304)Y02 \u2212 x\u03042 Y03 ]\nNTx [x2 + (x\u03042 + x + x2 )Y0 + (x\u03043 \u2212 x\u0304)Y02 \u2212 x\u03042 Y03 ].\n\nVia Lagrange inversion [8], we derive the formula\nX m \u0012s\u0013\u0012 s \u0013\u00122j + m\u0013\n.\n(3.12)\n[x0 ts ]xl Y0m =\ns j\nj+m\nj\u2212l\nj\nThe enumeration of PW2 -walks follows from the reflection principle [5]. Let \u03c9li,j denote the number\nof PW2 -walks ending at (i, j) of length l. The reflection-principle implies\n(3.13)\n\nj,i\n\u03c9li,j = ai,j\nl \u2212 al .\n\nIn the following lemma, we express \u03c9li,j via the coefficients of F (x, y; t) and establish their corresponding recurrence relations.\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n7\n\nLemma 3.2. (a) Suppose 1 \u2264 l \u2264 N \u2212 1 and (i, j) \u2208 Z2 , then \u03c9si,j is given by\n\uf8f1\n\uf8f2f i,j \u2212 f j,i\nfor s = 2l + 1,\nl\nl\n(3.14)\n\u03c9si,j =\n\uf8f3f i,j + f i\u22121,j + f i,j\u22121 \u2212 f j,i \u2212 f j\u22121,i \u2212 f j,i\u22121 for s = 2l + 2,\nl\nl\nl\nl\nl\nl\n\nwhere (1) \u03c90i,j = 1, for i = 1, j = 0 and \u03c90i,j = 0, otherwise; (2) fli,j = 0 for i 6\u2208 {0, 1, . . . , l} or\nj 6\u2208 {0, 1, . . . , l}.\n(b) fli,j satisfies the recursion\n\n(3.15)\n\nfli,j\n\n\uf8f1\nP\n0,j\u22121\nj l+1\n\uf8f4\n= j1 (\u22121)j\u2212j1 [y j1 tl+1 ]V (y; t)\n\uf8f4\n\uf8f2[y t ]V (y; t) \u2212 fl\nP\n= [xi tl+1 ]H(x; t) \u2212 fli\u22121,0 = i1 (\u22121)i\u2212i1 [xi1 tl+1 ]H(x; t)\n\uf8f4\n\uf8f4\n\uf8f3 i,j+1\ni+1,j\ni\u22121,j+1\ni+1,j\u22121\ni,j\ni\u22121,j\ni,j\u22121\nfl\u22121 \u2212 fl\u22121\n\u2212 fl\u22121\n\u2212 fl\u22121\n\u2212 3fl\u22121\n\u2212 fl\u22121\n\u2212 fl\u22121\n\nfor i = 0, j 6= 0\nfor i 6= 0, j = 0\notherwise.\n\nProof. We first prove assertion (a). Indeed, according to Proposition 3.1 we have Fo (x, y; t) =\ntF (x, y; t2 ) and Fe (x, y; t) = x + Fo (x, y; t)(1 + x + y)t or equivalently\n(3.16)\n\ni,j\nai,j\n2l+1 = fl\n\ni,j\ni\u22121,j\ni,j\u22121\nand ai,j\n2l = fl\u22121 + fl\u22121 + fl\u22121 ,\n\nj,i\nwhence eq. (3.14) follows from \u03c9li,j = ai,j\nl \u2212 al .\nNext, we prove (b). We distinguish the following three cases. First, suppose i 6= 0 and j 6= 0.\nEquating the coefficients of xi y j tl in eq. (3.3), we derive\n\n(3.17)\n\ni,j+1\ni+1,j\ni\u22121,j+1\ni+1,j\u22121\ni,j\ni\u22121,j\ni,j\u22121\nfli,j = fl\u22121\n\u2212 fl\u22121\n\u2212 fl\u22121\n\u2212 fl\u22121\n\u2212 3fl\u22121\n\u2212 fl\u22121\n\u2212 fl\u22121\n.\n\nIn case of i = 0 or j = 0, let [xi tl ]xH(x; t) and [y j tl ]yV (y; t) denote the coefficients of xi tl in\nxH(x; t) and the coefficient of y j tl in yV (y; t), respectively. Then we have\n(3.18)\n\n0,j\u22121\n0,j\u22122\nfl\u22121\n+ fl\u22121\n\n=\n\n[y j tl ]yV (y; t),\n\n(3.19)\n\ni\u22121,0\ni\u22122,0\nfl\u22121\n+ fl\u22121\n\n=\n\n[xi tl ]xH(x; t).\n\nAccording to eq. (3.10) and eq. (3.11), the coefficients [xi tl ]xH(x; t) and [y j tl ]yV (y; t) are given\nas follows:\n(3.20)\n\n[xi tl ]H(x, t)\n\n(3.21)\n\n[y j tl ]V (y, t) =\n\n=\n\n[x0 tl ]x\u2212i\u22121 (x2 + (x\u03042 + x + x2 )Y0 + (x\u03043 \u2212 x\u0304)Y02 \u2212 x\u03042 Y03 ),\n[x0 tl ]xj+1 (x2 + (x\u03042 + x + x2 )Y0 + (x\u03043 \u2212 x\u0304)Y02 \u2212 x\u03042 Y03 ).\n\nwhence (b) and the proof of the lemma is complete.\n\n\u0003\n\n\f8\n\nJING QIN AND CHRISTIAN M. REIDYS\n\nLemma 3.2 allows us to compute \u03c9li,j for all i, j \u2208 Z2 and 1 \u2264 l \u2264 2N . In the following, we consider\na vacillating tableaux as the sampling path of a Markov-process, whose transition probabilities can\nbe calculated via the terms \u03c9li,j .\nTheorem 3.3. Algorithm 1 generates a random 3-noncrossing partition after a pre-processing step\nhaving O(N 4 ) time and O(N 3 ) space complexity with uniform probability in linear time and space.\nAlgorithm 1 Uniform generation of 3-noncrossing partitions\n1: i=1\n2: Tableaux (Initialize the sequence of shapes, {\u03bbi }i=2N\ni=0 )\n0\n2N\n3: \u03bb = \u2205, \u03bb\n=\u2205\n4: while i < 2N do\n5:\nif i is even then\n6:\nX[0]\u2190 V3 (\u03bbi+1\n\u2205 , 2N \u2212 (i + 1))\n7:\nX[1]\u2190 V3 (\u03bbi+1\n\u2212\u00031 , 2N \u2212 (i + 1))\n8:\nX[2]\u2190 V3 (\u03bbi+1\n\u2212\u00032 , 2N \u2212 (i + 1))\n9:\nend if\n10:\nif i is odd then\n11:\nX[0]\u2190 V3 (\u03bbi+1\n\u2205 , 2N \u2212 (i + 1))\n12:\nX[1]\u2190 V3 (\u03bbi+1\n+\u00031 , 2N \u2212 (i + 1))\ni+1\n13:\nX[2]\u2190 V3 (\u03bb+\u00032 , 2N \u2212 (i + 1))\n14:\nend if\n15:\nsum \u2190 X[0]+X[1]+X[2]\n16:\nShape \u2190 Random(sum) (Random generates the random shape \u03bbi+1\n+\u0003j (or\u2212\u0003j ) with probability\n17:\n18:\n19:\n20:\n\nX[j]/sum or \u03bbi+1\nwith probability X[0]/sum)\n\u2205\ni\u2190 i+1\nInsert Shape into Tableau (the sequence of shapes).\nend while\nMap(Tableau) (maps Tableau into its corresponding 3-noncrossing partition)\n\nProof. The main idea is to interpret tableaux of 3-noncrossing partitions as sampling paths of a\nstochastic process. We label the (i+1)-th shape, \u03bbi+1\nby \u03b1 = \u03bbi+1 \\\u03bbi \u2208 {+\u00031 , +\u00032 , \u2212\u00031 , \u2212\u00032 , \u2205},\n\u03b1\nwhere the labeling specifies the transition from \u03bbi to \u03bbi+1 .\nLet V(\u03bbi+1\n\u03b1 , 2N \u2212 (i + 1)) denote the number of vacillating tableaux of length (i + 1) such that\n\u03bbi+1 \\ \u03bbi = \u03b1. We remark here that if \u03bbi+1 has (a \u2212 1) in the first row and b boxes in the second\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n9\n\n7\n\n8\n\nFigure 5. Sampling paths: we display all tableaux sequences where \u03bb1 = \u2205, \u03bb2 =\n\u03bb3 = \u0003. We display the three possible \u03bb4 -shapes (blue), induced by \u2205, +\u00031 , +\u00032 and\nall possible continuations (grey).\na,b\ni 2N\nrow, then V(\u03bbi+1\n\u03b1 , 2N \u2212 (i + 1)) = \u03c92N \u2212(i+1) . Let (X )i=0 be given as follows:\n\u2022 X 0 = X 2N = \u2205 and X i is a shape having at most 2 rows;\n\u2022 for 1 \u2264 i \u2264 N \u2212 1, we have X2i+1 \\ X2i \u2208 {\u2205, \u2212\u00031 , \u2212\u00032 } and X2i+2 \\ X2i+1 \u2208 {\u2205, +\u00031, +\u00032 }.\n\u2022 for 1 \u2264 i \u2264 2N \u2212 1, we have\n\nV(\u03bbi+1\n\u03b1 , 2N \u2212 i \u2212 1)\n.\nV(\u03bbi , 2N \u2212 i)\n\nP(X i+1 = \u03bbi+1 | X i = \u03bbi ) =\n\n(3.22)\n\nIn view of eq. (3.22), we immediately observe\n(3.23)\n\n2N\n\u22121\nY\n\nP(X i+1 = \u03bbi+1 | X i = \u03bbi ) =\n\ni=0\n\n1\nV(\u03bb2N = \u2205, 0)\n=\n.\nV(\u03bb0 = \u2205, N )\nV(\u2205, 2N )\n\nConsequently, the process (X i )2N\ni=0 generates random 3-noncrossing partitions with uniform probability in O(N ) time and space.\nAs for the derivation of the transition probabilities, suppose we are given a shape \u03bbh having exactly\na and b squares in the first and second row, respectively. According to Lemma 3.2, we obtain\n\uf8f1\n\uf8f2f a,b \u2212 f b,a\nfor 2N \u2212 h = 2l + 1,\na,b\nl\nl\n\u03c92N \u2212h =\n\uf8f3f a,b + f a\u22121,b + f a,b\u22121 \u2212 f b,a \u2212 f b\u22121,a \u2212 f b,a\u22121 for 2N \u2212 h = 2l + 2,\nl\n\nl\n\nl\n\nl\n\nl\n\nl\n\nwhich reduces the problem to the calculation of at most six coefficients fli,j for fixed i, j and l.\nClaim. The coefficients fli,j for all 0 \u2264 i, j \u2264 l and 1 \u2264 l \u2264 N \u2212 1, can be computed in O(N 4 )\ntime and O(N 3 ) space complexity.\nStep 1. For fixed i, j and l, fli,0 and fl0,j can be computed in O(N 2 ) time. Indeed, according to\neq. (3.15), we have\nX\n(\u22121)i\u2212i1 [xi1 tl+1 ]H(x; t),\nfli,0 =\ni1\n\n\f10\n\nJING QIN AND CHRISTIAN M. REIDYS\n\nwhence fli,0 can be calculated via a For-loop summing over the terms (\u22121)i\u2212i1 [xi1 tl+1 ]H(x; t).\nIn view of eq. (3.21), the [xi1 tl+1 ]H(x; t) terms in turn are expressed via [x0 tl+1 ]xq Y0m , for\nq \u2208 {\u2212i1 \u22124, \u2212i1 \u22123, \u2212i1 \u22122, \u2212i1, \u2212i1 +1} and m \u2208 {0, 1, 2}. According to eq. (3.12), the quantities\n\u0001 l+1 \u0001 2j+m\u0001\nm l+1\nfor\n[x0 tl+1 ]xq Y0m can be calculated via a For-loop summing over the terms l+1\nj\nj+m\nj\u2212q\n\n1 \u2264 j \u2264 l + 1. Consequently, for fixed i, l the coefficient fli,0 can be derived in O(N 2 ) time. Using\nthe same arguments we obtain for fixed j, l the coefficient fl0,j in O(N 2 ) time.\nStep 2. We compute fli,0 and fl0,j for all i, j and l via two nested For-loops in O(N 2 ) time.\nStep 3. Once the coefficients fli,0 and fl0,j are calculated for all i, j, l, we compute fli,j for arbitrary\ni, j, l employing three nested For-loops and the recurrence of eq. (3.15) since there exists boundary\nconditions as follows:\n\n(3.24)\n\nfli,j\n\n=\n\n(3.25)\n\nf0i,j\n\n=\n\n0 i > l or j > l,\n\uf8f1\n\uf8f21 i = 1, j = 0;\n\uf8f30 otherwise.\n\nTherefore, we compute fli,j for arbitrary i, j, l in O(N 4 ) time and O(N 3 ) space and the claim\nfollows.\nGiven the coefficients fli,j for all i, j, l, we can derive the transition probabilities in O(1) time.\nAccordingly, we obtain all transition probabilities V(\u03bbi\u03b1 , 2N \u2212 i)) in O(N 4 ) time and O(N 3 ) space\ncomplexity.\n\u0003\n\n4. Random 2-regular, 3-noncrossing partitions\n\nIn this section, we generate random 2-regular, 3-noncrossing partitions employing a bijection between the set of 2-regular, 3-noncrossing partitions over [N ] and the set of k-noncrossing braids\nwithout loops over [N \u2212 1].\n0\nLemma 4.1. Set k \u2208 N, k \u2265 3. Suppose (\u03bbi )2l+1\ni=0 in which \u03bb = \u2205 is a sequence of shapes such\nh=k\u22121\nh=k\u22121\nthat \u03bb2j \\\u03bb2j\u22121 \u2208 {{+\u0003h}h=1\n, \u2205} and \u03bb2j\u22121 \\\u03bb2j\u22122 \u2208 {{\u2212\u0003h}h=1\n, \u2205}. Then (\u03bbi )2l+1\ni=0 induces\na unique sequence of shapes (\u03bci )2l\nwith\nthe\nfollowing\nproperties\ni=0\n\n(4.1)\n\nh=k\u22121\nh=k\u22121\n\u03bc2j+1 \\ \u03bc2j \u2208 {{+\u0003h}h=1\n, \u2205} and \u03bc2j+2 \\ \u03bc2j+1 \u2208 {{\u2212\u0003h }h=1\n, \u2205},\n\n(4.2)\n\n\u03bc2j = \u03bb2j+1\n\n(4.3)\n\n\u03bc2j+1 6= \u03bb2j+2\n\n=\u21d2\n\n\u03bc2j+1 \u2208 {\u03bb2j+1 , \u03bb2j+3 }.\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n3-noncrossing\npartition\n\nVacillating\ntableaux\nsequence\n\n1\n0\n\n1\n\n2\n2\n\n3\n\n3\n4\n\n4\n\n5\n\n6\n\n7\n\n5\n8\n\n9\n\n6\n\n7\n\n8\n\n10 11 12 13 14\n\n9\n\n15 16\n\n10\n\n11\n\n11\n\n17 18 19 20\n\n12\n\n21 22\n\n13\n\n23 24 25\n\n14\n\n15\n\n26 27 28\n\n29 30\n\nShift\nElementary\nmove\nsequence\n\n+\n\nElementary\nmove\nsequence\nVacillating\ntableaux\nsequence\n\n3-noncrossing\nbraid\n\n0\n\n+\n\n1\n\n+\n\n1\n\n1\n\n2\n\n1\n\n+\n\n3\n\n4\n\n-\n\n2\n\n5\n\n2\n\n-\n\n2\n\n3\n\n6\n\n7\n\n4\n\n8\n\n2\n\n9\n\n5\n\n2\n\n+ 2-\n\n2\n\n+ 2-\n\n2\n\n10\n\n+\n\n1\n\n+\n\n1\n\n11 12 13 14\n\n6\n\n7\n\n+ 2-\n\n1\n\n+ 2-\n\n1\n\n15 16\n\n8\n\n-\n\n-\n\n17 18 19 20\n\n9\n\n10\n\n2\n\n2\n\n+ 1-\n\n1\n\n+ 1-\n\n1\n\n21 22\n\n11\n\n-\n\n-\n\n23 24 25\n\n12\n\n13\n\n1\n\n1\n\n26 27 28\n\n14\n\nFigure 6. Illustration of Lemma 4.1. We show how to map the PW2 -walk induced by\nthe 3-noncrossing partition P , of Fig. 4, (A) into the BW2 -walk. The latter corresponds\nto the 3-noncrossing braid of Fig. 4, (B). Here each vertex, i, is aligned with the triple\nof shapes (\u03bb2i\u22122 , \u03bb2i\u22121 , \u03bb2i ) in the corresponding tableaux.\n\nl\nProof. Since \u03bb1 = \u2205, (\u03bbj )2l+1\nj=1 corresponds to a sequence of pairs ((xi , yi ))i=1 given by xi =\n\u03bb2i \\ \u03bb2i\u22121 and yi = \u03bb2i+1 \\ \u03bb2i such that\n\n(4.4)\n\n\u2200 1 \u2264 i \u2264 l;\n\n(xi , yi ) \u2208 {(\u2205, \u2205), (+\u0003h , \u2205), (\u2205, \u2212\u0003h ), (+\u0003h , \u2212\u0003j )}.\n\nLet \u03c6 be given by\n(4.5)\n\n\uf8f1\n\uf8f2(x , y )\ni i\n\u03c6((xi , yi )) =\n\uf8f3(yi , xi )\n\nfor (xi , yi ) = (+\u0003h , \u2212\u0003j )\notherwise,\n\nand set (\u03c6(xi , yi ))li=1 = (ai , bi )li=1 . Note that (ai , bi ) \u2208 {(\u2212\u0003h , \u2205), (\u2205, +\u0003h ), (\u2205, \u2205), (+\u0003h , \u2212\u0003j )},\nwhere 1 \u2264 h, j \u2264 k \u2212 1. Let (\u03bci )li=1 be the sequence of shapes induced by (ai , bi )li=1 according\nto ai = \u03bc2i \\ \u03bc2i\u22121 and bi = \u03bc2i\u22121 \\ \u03bc2i\u22122 initialized with \u03bc0 = \u2205. Now eq. (4.1) is implied by\neq. (4.4) and eq. (4.2) follows by construction. Suppose \u03bc2j+1 6= \u03bb2j+2 for some 0 \u2264 j \u2264 l \u2212 1. By\ndefinition of \u03c6, only pairs containing \"\u2205\" in at least one coordinate are transposed from which we\n\n\f12\n\nJING QIN AND CHRISTIAN M. REIDYS\n\ncan conclude \u03bc2j+1 = \u03bc2j or \u03bc2j+1 = \u03bc2j+2 , whence eq. (4.3). I.e. we have the following situation\n\n\u03bc2j\n\n/ \u03bb2j+2\n/ \u03bb2j+2\n/ \u03bb2j+3\n/ \u03bb2j+3\n\u03bb2j+1\n\u03bb2j+1\nvv\nvv\nyy\nyy\nv\nv\nv\nv\ny\ny\nv\nv\nv\nv\ny\ny\nv\nv\nv\nyy\nyy\nvvv\nvvv\nv\nvv\ny\ny\nv\nv\ny\ny\nv\nv\nv\ny\ny\nv\nv\nv\nor\nyy\nyy\nvv\nvv\nvv\nvv\nvvvvv\nvvvvv\nyyyyy\nyyyyy\nvv\nvv\n/ \u03bc2j+2\n/ \u03bc2j+1\n\u03bc2j+1\n\u03bc2j+2 ,\n\u03bc2j\n\nand the lemma follows.\n\n\u0003\n\nLemma 4.1 establishes a bijection between PWk\u22121 -walks of length 2l + 1 and BWk\u22121 -walks of length\n2l, where Wk\u22121 = {(a1 , a2 , . . . , ak\u22121 ) | a1 > a2 > * * * > ak\u22121 }.\nCorollary 4.2. Let Pk (N ) and Bk (N \u2212 1) denote the set of k-noncrossing partitions on [N ] and\nk-noncrossing braids on [N \u2212 1]. Then\n(a) we have a bijection\n(4.6)\n\n\u03b8 : Pk (N ) \u2212\u2192 Bk (N \u2212 1).\n\n(b) \u03b8 induces by restriction a bijection between 2-regular, k-noncrossing partitions on [N ] and\nk-noncrossing braids without loops on [N \u2212 1].\n\nProof. Assertion (a) follows from Lemma 4.1 since a partition is completely determined by its\ninduced PWk\u22121 -walk of shape \u03bb2n\u22121 = \u2205. (b) follows immediately from the fact that, according to\nthe definition of \u03c6 given in Lemma 4.1, any pair of consecutive EMs (\u2205, \u00031 ), (\u2212\u00031 , \u2205) induces an\nEM (+\u00031 , \u2212\u00031 ). Therefore, \u03b8 maps 2-regular, k-noncrossing partitions into k-noncrossing braids\nwithout loops.\n\u0003\n\nAccording to Corollary 4.2, each 2-regular, 3-noncrossing partition on [N ] corresponds to a 3noncrossing braid without loops over [N \u2212 1]. Each such braid uniquely corresponds to a BW2 -walk\nof length 2N \u2212 2 in which there does not exist any odd +e1 -step followed by an even \u2212e1 -step.\nWe call such a walk a B\u2217W2 -walk.\nLemma 4.3. The number of B\u2217W2 -walks ending at (i, j) of length 2l, is given by\n\u0012 \u0013\nX\ni,j;\u2217\nh l\n\u03c9 i,j\n.\n(4.7)\n\u03c32l =\n(\u22121)\nh 2(l\u2212h)+1\nh\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n3-noncrossing\npartition\n\nVacillating\ntableaux\nsequence\n\n1\n0\n\n1\n\n2\n2\n\n3\n\n3\n4\n\n4\n\n5\n\n6\n\n7\n\n5\n8\n\n9\n\n6\n\n7\n\n8\n\n10 11 12 13 14\n\n9\n\n15 16\n\n10\n\n13\n\n11\n\n17 18 19 20\n\n21 22\n\n12\n\n13\n\n23 24 25\n\n14\n\n15\n\n26 27 28\n\n29 30\n\nShift\nElementary\nmove\nsequence\n\n+\n\nElementary\nmove\nsequence\nVacillating\ntableaux\nsequence\n\n3-noncrossing\nbraid\n\n0\n\n+\n\n1\n\n+\n\n1\n\n1\n\n2\n\n1\n\n+\n\n3\n\n2\n\n4\n\n-\n\n2\n\n-\n\n2\n\n5\n\n3\n\n6\n\n7\n\n4\n\n8\n\n2\n\n9\n\n5\n\n2\n\n+ 2-\n\n2\n\n+ 2-\n\n2\n\n10\n\n+\n\n1\n\n+\n\n1\n\n11 12 13 14\n\n6\n\n7\n\n+ 2-\n\n1\n\n+ 2-\n\n1\n\n15 16\n\n-\n\n-\n\n17 18 19 20\n\n8\n\n9\n\n10\n\n-\n\n2\n\n-\n\n2\n\n21 22\n\n11\n\n23 24 25\n\n12\n\n13\n\n1\n\n1\n\n26 27 28\n\n14\n\nFigure 7. Mapping 2-regular 3-noncrossing partitions into loop-free braids: illustration\nof Corollary 4.2(b).\ni,j;\u2217\nFurthermore, we obtain the recurrence of \u03c32l+1\ngiven by\ni,j;\u2217\ni\u22121,j;\u2217\ni,j\u22121;\u2217\ni,j;\u2217\n\u03c32l+1\n= \u03c32l\n+ \u03c32l\n+ \u03c32l\n.\n\n(4.8)\n\nProof. According to Lemma 4.1, any PW2 -walk of length 2l + 1 corresponds to a unique BW2 -walk\ni,j\ni,j\nof length 2l, whence \u03c32l\n= \u03c92l+1\n. Let A2l (h) denote the set of BW2 -walks of length 2l in which\nthere exist at least h pairs of shapes (\u03bc2q\u22121 , \u03bc2q ) induced by the EM (+e1 , \u2212e1 ). Since the removal\nof h pairs of (+e1 , \u2212e1 )-EMs from such a BW2 -walk, results in a BW2 -walk of length 2(l \u2212 h), we\n\u0001 i,j\nderive A2l (h) = hl \u03c32l\u22122h\n. Using the inclusion-exclusion principle, we arrive at\n\u0012 \u0013\n\u0012 \u0013\nX\nX\nl i,j\nl i,j\ni,j;\u2217\n(4.9)\n\u03c32l\n=\n\u03c32(l\u2212h) =\n\u03c9\n.\n(\u22121)h\n(\u22121)h\nh\nh 2(l\u2212h)+1\nh\n\nh\n\nBy construction, an odd step in a BW2 -walk is either \u2212e1 , -e2 or 0, whence\ni,j;\u2217\ni\u22121,j;\u2217\ni,j\u22121;\u2217\ni,j;\u2217\n\u03c32l+1\n= \u03c32l\n+ \u03c32l\n+ \u03c32l\n.\n\n\u0003\n\n\f14\n\nJING QIN AND CHRISTIAN M. REIDYS\n\nVia Lemma 4.3, we have explicit knowledge about the numbers of B\u2217W2 -walks, i.e. \u03c3li,j;\u2217 for all\ni, j \u2208 Z2 and 1 \u2264 l \u2264 2N . Accordingly, we are now in position to generate 2-regular, 3-noncrossing\npartitions with uniform probability via 3-noncrossing, loop-free braids.\nTheorem 4.4. A random 2-regular, 3-noncrossing partition can be generated, in O(N 4 ) preprocessing time and O(N 3 ) space complexity, with uniform probability in linear time. Each 2regular, 3-noncrossing partition is generated with O(N ) space and time complexity.\n\nProof. We interpret B\u2217W2 -walks as sampling paths of a stochastic process. To this end, we again\nlabel the (i + 1)-th shape, \u03bbi+1\nby \u03b1 = \u03bbi+1 \\ \u03bbi \u2208 {+\u00031 , +\u00032 , \u2212\u00031 , \u2212\u00032 , \u2205}, where the labeling\n\u03b1\nspecifies the transition from \u03bbi to \u03bbi+1 . In the following we distinguish even and odd labeled shape.\n\u2217\n2s\nFor i = 2s, we let W \u2217 (\u03bb2s\n\\ \u03bb2s\u22121 .\n\u03b1 , 2N \u2212 2s) denote the number of BW2 -walks such that \u03b1 = \u03bb\nBy construction, assume \u03bb2s has (a \u2212 1) and b boxes in its first and second row, respectively, then\nwe have\n(4.10)\n\na,b;\u2217\nW \u2217 (\u03bb2s\n\u03b1 , 2N \u2212 2s) = \u03c32N \u22122s\n\n\u2217 2s\n\u2217 2s\ni.e. W \u2217 (\u03bb2s\n\u03b1 , 2N \u2212 2s) is independent of \u03b1 and we write W (\u03bb\u03b1 , 2N \u2212 2s) = W (\u03bb , 2N \u2212 2s).\nFor i = 2s + 1, let V \u2217 (\u03bb2s+1\n, 2N \u2212 (2s + 1)) denote the number of B\u2217W2 -walks of shape \u03bb2s+1 of\n\u03b1\nlength 2N \u2212 (2s + 1) where \u03bb2s+1 \\ \u03bb2s = \u03b1. Then we have setting u = 2N \u2212 2s \u2212 2\n\uf8f1\n\u2217 2s+2\n\uf8f4\nfor \u03b1 = +\u00031\n\uf8f4\n\uf8f4W (\u03bb+\u00032 , u)\n\uf8f4\n\uf8f4\n\uf8f2W \u2217 (\u03bb2s+2 , u) + W \u2217 (\u03bb2s+2 , u)\nfor \u03b1 = +\u00032\n\u2212\u00031\n\u2212\u00032\n, u + 1) =\n(4.11) V \u2217 (\u03bb2s+1\n\u03b1\n2s+2\n2s+2\n2s+2\n\u2217\n\u2217\n\u2217\n\uf8f4\n\uf8f4\nW (\u03bb+\u00031 , u) + W (\u03bb+\u00032 , u) + W (\u03bb\u2205 , u) for \u03b1 = \u2205\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 \u2217 2s+2\nW (\u03bb\u2205 , u)\nfor \u03b1 = \u2212\u00031 , \u2212\u00032 .\n\nWe are now in position to specify the process (X i )i=2N\ni=0 :\n0\n2N\ni\n\u2022X =X\n= \u2205 and X is a shape with at most 2 rows.\n\u2022 for 1 \u2264 i \u2264 N \u2212 1, (X 2i+1 \\ X 2i , X 2i+2 \\ X 2i ) \u2208 {(\u2212\u0003, \u2205), (\u2205, +\u0003), (\u2205, \u2205), (+\u0003, \u2212\u0003)}.\n\u2022 there does not exist any subsequence (X 2i , X 2i+1 , X 2i+2 ) such that (X 2i+1 \\ X 2i , X 2i+2 \\ X 2i ) =\n(+\u00031 , \u2212\u00031 ).\n\u2022 the transition probabilities are given as follows:\n(1) for i = 2l, we obtain\ni\ni\nP(X i+1 = \u03bbi+1\n\u03b1 |X = \u03bb ) =\n\nV \u2217 (\u03bbi+1\n\u03b1 , 2n \u2212 i \u2212 1)\n.\nW \u2217 (\u03bbi+1 , 2N \u2212 i)\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\nAlgorithm 2 Uniform generation of 2-regular, 3-noncrossing partitions.\n1:\n2:\n3:\n4:\n5:\n6:\n7:\n8:\n9:\n10:\n11:\n12:\n13:\n14:\n15:\n16:\n17:\n18:\n19:\n20:\n21:\n22:\n23:\n24:\n25:\n26:\n27:\n28:\n29:\n30:\n31:\n32:\n33:\n34:\n35:\n36:\n37:\n38:\n39:\n40:\n41:\n42:\n43:\n44:\n45:\n\nTableaux (Initialize the sequence of shapes to be a list {\u03bbi }i=2N\ni=0 )\n0\n2N\n\u03bb = \u2205, \u03bb = \u2205, i=1\nwhile i < 2N do\nflag0 \u2190 1, flag1 \u2190 1, flag2 \u2190 1, flag3 \u2190 1\nif i is even then\nX[0]\u2190 V\u2217 (\u03bbi+1\n\u2205 , 2n \u2212 (i + 1))\n\u2217 i+1\nX[1]\u2190 V (\u03bb+\u00031 , 2N \u2212 (i + 1)), X[2]\u2190 V\u2217 (\u03bbi+1\n+\u00032 , 2n \u2212 (i + 1))\n\u2217 i+1\nX[3]\u2190 V\u2217 (\u03bbi+1\n,\n2N\n\u2212\n(i\n+\n1)),\nX[4]\u2190\nV\n(\u03bb\n\u2212\u00031\n\u2212\u00032 , 2N \u2212 (i + 1))\nend if\nif i is odd then\nX[0]\u2190 W\u2217 (\u03bbi+1\n\u2205 , 2N \u2212 (i + 1))\n\u2217 i+1\nX[1]\u2190 W (\u03bb+\u00031 , 2N \u2212 (i + 1)), X[2]\u2190 W\u2217 (\u03bbi+1\n+\u00032 , 2N \u2212 (i + 1))\n\u2217 i+1\nX[3]\u2190 W\u2217 (\u03bbi+1\n,\n2N\n\u2212\n(i\n+\n1)),\nX[4]\u2190\nW\n(\u03bb\n\u2212\u00031\n\u2212\u00032 , 2N \u2212 (i + 1))\nif flag0 =0 then\nX[3]\u2190 0, X[4]\u2190 0\nend if\nif flag1 =0 then\nX[1]\u2190 0, X[2]\u2190 0, X[0]\u2190 0, X[3]\u2190 0\nend if\nif flag2 =0 then\nX[1]\u2190 0, X[2]\u2190 0, X[3]\u2190 0, X[4]\u2190 0\nend if\nif flag3 =0 then\nX[1]\u2190 0, X[2]\u2190 0, X[0]\u2190 0\nend if\nsum \u2190 X[0]+X[1]+X[2]+X[3]+X[4]\nend if\ni+1\nShape \u2190 Random(sum) (Random generates the random shape \u03bbi+1\n+\u0003j (or\u2212\u0003j ) or \u03bb\u2205 .)\nif i is even and Shape=\u03bbi+1\n+\u00031 then\nflag1 \u2190 0\nend if\nif i is even and Shape=\u03bbi+1\n\u2212\u00031 then\nflag2 \u2190 0\nend if\nif i is even and Shape=\u03bbi+1\n\u2212\u00032 then\nflag2 \u2190 0\nend if\nif i is even and Shape=\u03bbi+1\n+\u00032 then\nflag3 \u2190 0\nend if\nif i is even and Shape=\u03bbi+1\nthen\n\u2205\nflag0 \u2190 0\nend if\nInsert Shape into Tableaux (the sequence of shapes)\ni\u2190 i+1\n\n15\n\n\f16\n\nJING QIN AND CHRISTIAN M. REIDYS\n\n(2) for i = 2l + 1, we have\nP(X i+1 = \u03bbi+1 |X i = \u03bbi\u03b1 ) =\n\nW \u2217 (\u03bbi+1 , 2n \u2212 i \u2212 1)\n.\nV \u2217 (\u03bbi+1\n\u03b1 , 2N \u2212 i)\n\nBy construction,\n2N\n\u22121\nY\n\n(4.12)\n\ni=0\n\nP(X i+1 = \u03bbi+1 | X i = \u03bbi ) =\n\nW\u2217 (\u03bb2N = \u2205, 0)\n1\n= \u2217\n,\nW\u2217 (\u03bb0 = \u2205, n)\nW (\u2205, 2N )\n\n(X i )2N\ni=0\n\nwhence\ngenerates random 2-regular, 3-noncrossing partitions with uniform probability in\nO(N ) time and space, see Figure 8.\nAs for the derivation of the transition probabilities, supposed that the terms \u03c9li,j for 0 \u2264 i, j \u2264 l\nand 1 \u2264 l \u2264 2N can be calculated in O(N 4 ) time and O(N 3 ) space according to Theorem 3.3.\nWe claim for fix the indices i1 , j1 and s such that 0 \u2264 i1 , j1 \u2264 s and 1 \u2264 s \u2264 2N , \u03c3si1 ,j1 ;\u2217 can be\ncomputed in O(N ) time. Consider the parity of s, there are two cases. First, in case of s = 2l1 , via\n\u0001 i1 ,j1\ni1 ,j1 ;\u2217\nusing a For-loop summing over the terms (\u22121)h l1h\u2212h \u03c92(l\n. Otherwise, in\n, we obtain \u03c32l\n1\n1 \u2212h)+1\n\ni1 ,j1 ;\u2217\ni1 ,j1 \u22121;\u2217\ni\u22121,j1 ;\u2217\nvia using a For-loop according\n, and \u03c32l\n, \u03c32l\ncase of s = 2l1 +1, we first calculate \u03c32l\n1\n1\n1\ni1 ,j1 ;\u2217\ni1 ,j1 \u22121;\u2217\ni1 ,j1 ;\u2217\ni1 ,j1 ;\u2217\ni\u22121,j1 ;\u2217\n.\n+ \u03c32l\n+ \u03c32l1\nto eq. (4.9) then \u03c32l1 +1 follows from \u03c32l1 +1 = \u03c32l1\n1\nFurthermore, via using three nested For loops for s, i1 and j1 from outside to inside, we derive\n\u03c3si1 ,j1 ;\u2217 for arbitrary i1 , j1 and s. Consequently, we compute \u03c3si1 ,j1 ;\u2217 for all i1 , j1 , s with O(N 4 ) +\nO(N 3 \u00d7N ) = O(N 4 ) time and O(N 3 ) space complexity. Obviously, once the terms \u03c3si1 ,j1 ;\u2217 for i1 , j1\nand s are calculated, we can compute the transition probabilities in O(1) time. Therefore we obtain\nthe transition probabilities W \u2217 (\u03bbi+1 , 2N \u2212 i) in O(N 4 ) time and O(N 3 ) space complexity.\n\u0003\n\nReferences\n[1] M. Bousquet-M\u00e9lou and G. Xin. On partitions avoiding 3-crossings. S\u00e9minaire Lotharingien de Combinatoire,\n54(B54e), 2006.\n[2] W.Y.C. Chen, E.Y.P. Deng, R.R.X. Du, R.P. Stanley, and C.H. Yan. Crossing and nesting of matchings and\npartitions. Trans. Amer. Math. Soc., 359:1555\u20131575, 2007.\n[3] W.Y.C. Chen, H.S.W Han, and C.M. Reidys. Random k-noncrossing RNA structures. 2009.\n[4] W.Y.C. Chen, J. Qin, and C.M. Reidys. Crossings and nestings in tangled diagrams. Electron. J. Comb., 15:R86,\n2008.\n[5] I. M. Gessel and D. Zeilberger. Random walk in a Weyl chamber. Proc. Am. Math. Soc., 115:27\u201331, 1992.\n[6] I.M. Gessel and D. Zeilberger. Random walk in a weyl chamber. Proc. Amer. Math. Soc., 115:27\u201331, 1992.\n[7] D.J. Grabiner and P. Magyar. Random walks in Weyl chambers and the decomposition of tensor powers. J.\nAlgebr. Comb., 2:239\u2013260, 1993.\n[8] R.P. Stanley. Enumerative Combinatorics, volume 1. Cambridge University Press, Cambridge, 1996.\n\n\fRANDOM 3-NONCROSSING PARTITIONS\n\n(A)\n\nStep 1\n\nP=1\n\nP=1\n\nStep 2\n\nStep 3\n\nStep 4\n\nStep 5\n\nP=5/15\n\nP=3/10\n\nP=1/5\n\nP=1/3\n\nP=10/15\n\nP=5/10\n\nP=3/5\n\nP=1/3\n\nP=2/10\n\nP=1/5\n\nP=1/3\n\nStep 6\n\nStep 7\n\nStep 8\n\nP=1\n\nP=1\n\nP=1\n\n17\n\n1\u00d71\u00d7(10/15)\u00d7(5/10)\u00d7(3/5)\u00d7(1/3)\u00d71\u00d71\u00d71=1/15\n\n(B)\n\nP=1\n\nP=1\n\nP=10/15 P=5/10 P=3/5\n\nP=1/3\n\nP=1\n\nP=1\n\nP=1\n\n1\n\n2\n\n3\n\n4\n\n3\n\n4\n\n(C)\n\n1\n\n2\n\n5\n\nFigure 8. Uniform generation of 2-regular, 3-noncrossing partitions: the stochastic\nprocess over shapes (A), extract a specific sampling path (B) which we transform in (C)\ninto the corresponding 2-regular, 3-noncrossing partition. The probabilities specified in\n(B) are the transition probabilities.\nE-mail address: reidys@santafe.edu\n\n\f"}