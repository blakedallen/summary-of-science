{"id": "http://arxiv.org/abs/0811.1734v1", "guidislink": true, "updated": "2008-11-11T16:59:06Z", "updated_parsed": [2008, 11, 11, 16, 59, 6, 1, 316, 0], "published": "2008-11-11T16:59:06Z", "published_parsed": [2008, 11, 11, 16, 59, 6, 1, 316, 0], "title": "How to compute the length of a geodesic on a Riemannian manifold with\n  small error in arbitrary Sobolev norms", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0811.0788%2C0811.3979%2C0811.3575%2C0811.3377%2C0811.0358%2C0811.4638%2C0811.0330%2C0811.2142%2C0811.1138%2C0811.4576%2C0811.3560%2C0811.4449%2C0811.4763%2C0811.0331%2C0811.3354%2C0811.4505%2C0811.2350%2C0811.1469%2C0811.0815%2C0811.4504%2C0811.3266%2C0811.0865%2C0811.3570%2C0811.4567%2C0811.4331%2C0811.2531%2C0811.3763%2C0811.1945%2C0811.0609%2C0811.3368%2C0811.0950%2C0811.3147%2C0811.4040%2C0811.2809%2C0811.4318%2C0811.0370%2C0811.1946%2C0811.1421%2C0811.0356%2C0811.3449%2C0811.3729%2C0811.3036%2C0811.3778%2C0811.4622%2C0811.3287%2C0811.0849%2C0811.4488%2C0811.2110%2C0811.4721%2C0811.2762%2C0811.3948%2C0811.0563%2C0811.0690%2C0811.2477%2C0811.2165%2C0811.4651%2C0811.1907%2C0811.1406%2C0811.0271%2C0811.1104%2C0811.1108%2C0811.0630%2C0811.2269%2C0811.2927%2C0811.3438%2C0811.4620%2C0811.4340%2C0811.0782%2C0811.2823%2C0811.1399%2C0811.3779%2C0811.0844%2C0811.1495%2C0811.0818%2C0811.2243%2C0811.0772%2C0811.2406%2C0811.0677%2C0811.1875%2C0811.4323%2C0811.2059%2C0811.1734%2C0811.4484%2C0811.2933%2C0811.3370%2C0811.2460%2C0811.2976%2C0811.1376%2C0811.3608%2C0811.1611%2C0811.1873%2C0811.4564%2C0811.3107%2C0811.2955%2C0811.4273%2C0811.1144%2C0811.4214%2C0811.4354%2C0811.1476%2C0811.2577%2C0811.2654&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "How to compute the length of a geodesic on a Riemannian manifold with\n  small error in arbitrary Sobolev norms"}, "summary": "We compute the length of geodesics on a Riemannian manifold by regular\npolynomial interpolation of the global solution of the eikonal equation related\nto the line element $ds^2=g_{ij}dx^idx^j$ of the manifold. Our algorithm\napproximates the length functional in arbitrarily strong Sobolev norms. Error\nestimates are obtained where the geometric information is used. It is pointed\nout how the algorithm can be used to get accurate approximation of solutions of\nparabolic partial differential equations leading obvious applications to\nfinance and physics.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0811.0788%2C0811.3979%2C0811.3575%2C0811.3377%2C0811.0358%2C0811.4638%2C0811.0330%2C0811.2142%2C0811.1138%2C0811.4576%2C0811.3560%2C0811.4449%2C0811.4763%2C0811.0331%2C0811.3354%2C0811.4505%2C0811.2350%2C0811.1469%2C0811.0815%2C0811.4504%2C0811.3266%2C0811.0865%2C0811.3570%2C0811.4567%2C0811.4331%2C0811.2531%2C0811.3763%2C0811.1945%2C0811.0609%2C0811.3368%2C0811.0950%2C0811.3147%2C0811.4040%2C0811.2809%2C0811.4318%2C0811.0370%2C0811.1946%2C0811.1421%2C0811.0356%2C0811.3449%2C0811.3729%2C0811.3036%2C0811.3778%2C0811.4622%2C0811.3287%2C0811.0849%2C0811.4488%2C0811.2110%2C0811.4721%2C0811.2762%2C0811.3948%2C0811.0563%2C0811.0690%2C0811.2477%2C0811.2165%2C0811.4651%2C0811.1907%2C0811.1406%2C0811.0271%2C0811.1104%2C0811.1108%2C0811.0630%2C0811.2269%2C0811.2927%2C0811.3438%2C0811.4620%2C0811.4340%2C0811.0782%2C0811.2823%2C0811.1399%2C0811.3779%2C0811.0844%2C0811.1495%2C0811.0818%2C0811.2243%2C0811.0772%2C0811.2406%2C0811.0677%2C0811.1875%2C0811.4323%2C0811.2059%2C0811.1734%2C0811.4484%2C0811.2933%2C0811.3370%2C0811.2460%2C0811.2976%2C0811.1376%2C0811.3608%2C0811.1611%2C0811.1873%2C0811.4564%2C0811.3107%2C0811.2955%2C0811.4273%2C0811.1144%2C0811.4214%2C0811.4354%2C0811.1476%2C0811.2577%2C0811.2654&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We compute the length of geodesics on a Riemannian manifold by regular\npolynomial interpolation of the global solution of the eikonal equation related\nto the line element $ds^2=g_{ij}dx^idx^j$ of the manifold. Our algorithm\napproximates the length functional in arbitrarily strong Sobolev norms. Error\nestimates are obtained where the geometric information is used. It is pointed\nout how the algorithm can be used to get accurate approximation of solutions of\nparabolic partial differential equations leading obvious applications to\nfinance and physics."}, "authors": ["Joerg Kampen"], "author_detail": {"name": "Joerg Kampen"}, "author": "Joerg Kampen", "links": [{"href": "http://arxiv.org/abs/0811.1734v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0811.1734v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "65N99,35F20", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0811.1734v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0811.1734v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0811.1734v1 [math.NA] 11 Nov 2008\n\nHow to compute the length of a geodesic on a\nRiemannian manifold with small error in arbitrary\nSobolev norms\nJ\u00f6rg Kampen\n\n1\n\nNovember 11, 2018\nAbstract\nWe compute the length of geodesics on a Riemannian manifold by\nregular polynomial interpolation of the global solution of the eikonal\nequation related to the line element ds2 = gij dxi dxj of the manifold.\nOur algorithm approximates the length functional in arbitrarily strong\nSobolev norms. Error estimates are obtained where the geometric information is used. It is pointed out how the algorithm can be used to\nget accurate approximation of solutions of parabolic partial differential\nequations leading obvious applications to finance and physics.\n\n1\n\nIntroduction\n\nLet (M, g) is a Riemannian manifold, i.e. a differentiable n-dimensional\nmanifold with a function g, which defines for all p \u2208 M a positive definite\nsymmetric bilinear form\ngp : Tp M \u00d7 Tp M \u2192 R\n\n(1)\n\nsuch that for any given vector fields X, Y \u2208 X(M ) the map\ng(X, Y ) : M \u2192 R, p \u2192 g(X, Y )(p) := gp (Xp , Yp )\n\n(2)\n\nis differentiable. The Riemannian metric g allows to define a metric dM on\nM via the length of curves\ndM (x, y) := inf {L(\u03b3)|\u03b3 : [0, 1] \u2192 M, \u03b3(0) = x, \u03b3(1) = y} ,\n\u03b3 diff.\nwith\nL(\u03b3) =\n\nZ\n\n0\n\n1\n\n1q\n\ng\u03b3(t) (\u03b3\u0307(t), \u03b3\u0307(t)) dt.\n\n(3)\n\n(4)\n\nWeierstrass Institute for Applied Analysis and Stochastics, Mohrenstr. 39, 10117\nBerlin, Germany. kampen@wias-berlin.de.\n\n1\n\n\fWith this definition any connected Riemannian manifold becomes a metric\nspace, and it is well known that for any compact Riemannian manifold any\ntwo points x, y \u2208 M can be connected by a geodesic whose length is dM (x, y).\nIf \u2207 denotes the Levi-Civita connection, then a geodesic \u03b3 is characterized\nby the equation\n\u2207\u03b3\u0307 \u03b3\u0307 = 0,\n(5)\nwhich becomes (in terms of the coordinates of the values of the curve \u03b3)\n\u03bc\n\u03bd\nd2 x\u03bb\n\u03bb dx dx\n+\n\u0393\n=0,\n\u03bc\u03bd\ndt2\ndt dt\n\n(6)\n\nwhere the well-known Christoffel symbols are\n1\n\u0393\u03ba\u03bc\u03bd = g\u03ba\u03c1 (\u2202\u03bc g\u03bd\u03c1 + \u2202\u03bd g\u03bc\u03c1 \u2212 \u2202\u03c1 g\u03bc\u03bd ) .\n2\n\n(7)\n\nThis is an n-dimensional nonlinear ordinary differential equation with values\nin Rn which is difficult to compute numerically in general (note the quadratic\nterms). For computing the length of a geodesic it is easier to compute the\nsolution of a eikonal equation of the form\nd2 =\n\n1X\naij (x)d2xi d2xj\n4\n\n(8)\n\nij\n\n(boundary conditions considered later), where x \u2192 aij (x) are functions such\nthat at each x \u2208 Rn the matrix (aij (x)) is the inverse of the positive matrix\n\u2202f\n(gij (x)) at each point x. Here fxi := \u2202x\ndenotes the derivative of f with\ni\nrespect to the variable xi . In general we shall write \u2202 \u03b1 f , \u2202x\u03b1 f or \u2202x\u2202\u03b1 f for the\nmultivariate derivative with multiindex \u03b1 = (\u03b11 , * * * , \u03b1n ). The connection\nbetween the length of a geodesic which is given in local coordinates as in\n(6), (7) and the length function d2 defined by equation (8) is considered in\nsection 2. This way the problem of finding the length of a geodesic is reduced\nto solving a nonlinear first-order partial differential equation in some domain\nof Euclidean space.\nThe computation of d2 is still far from trivial, however. Even if the data\ngij are analytic functions, power series expansion typically lead to power\nseries solutions for d2 with small radius of convergence. Hence, the question\nis how we can approximate the function d2 globally. Moreover, for some\napplications such as the accurate computation of diffusions we need the approximation of d2 in strong norms (Sobolev norms of form H s,p for possibly\nany positive real s. For that matter recall that H 0,p (Rn ) = Lp (Rn ) and\nthat for any s \u2208 R we may define H s,p to be the set of all tempered distributions \u03c6 \u2208 S\u2032 such that I\u2212s \u03c6 is a function in Lp (Rn ), where Is is the\n\u0001\u2212 s\npseudo-differential operator with symbol \u03c3s (\u03be) = 1 + |\u03be|2 2 , i.e.\nIs \u03c6 = F\u22121 \u03c3s F\u03c6, \u03c6 \u2208 S\u2032 ,\n2\n\n(9)\n\n\fF denoting the Fourier transform. The goal of the present paper can then\nbe formulated as follows: find for each \u01eb > 0 and each real s, p (p \u2265 1) an\n2 to (8) such that\napproximative solution qs,p\n2\nkd2 \u2212 qs,p\nks,p \u2264 \u01eb.\n\n(10)\n\n2 an H s,p approximation to d2 for reasons which will become\nWe shall call qs,p\napparent later. Let us motivate this ambitious task by looking at a specific\napplication. There are a lot of applications for computations of the length\nof a geodesic, where applications to computations in general relativity are\nonly one domain. Another important example is the leading term of the\nexpansion of the fundamental solution of linear parabolic solutions (with\nvariable coefficients). Varadhan showed that the fundamental solution of\nthe diffusion equation\nP \u2202u\n1P\n\u22022u\n\u2202u\n(11)\ni,j aij \u2202xi \u2202xj +\ni bi \u2202xi ,\n\u2202t = 2\n\n(where the diffusion coefficients aij and the first order coefficients bi in (11)\ndepend on the spatial variable x only) is connected\nd of the\nP ijto the length\n2\nij\ngeodesic with respect to the line element ds = ij a dxi dxj (a being the\ninverse of aij ) via the relation\nd2 (x, y) = lim t ln p(t, x, y).\n\n(12)\n\nt\u21930\n\nRemark 1.1. Solving equation (8) we can assume that the matrix-valued\nfunction x \u2192 (aij (x)) is symmetric, i.e. aij (x) = aji (x) for all 1 \u2264 i, j \u2264 n.\nThis is because\nP\nP\nd2 (x, y) = 41 ij aij d2xi d2xj = 41 ij 21 (aij + aji ) d2xi d2xj\n(13)\n1P 1\n1P 1\n2\n2\n2\n2\n+ 4 ij 2 (aij \u2212 aji ) dxi dxj = 4 ij 2 (aij + aji ) dxi dxj ,\n\nso we can always substitute the matrix aij by its symmetrization\nwithout affecting the solution d2 .\n\n1\n2\n\n(aij + aji )\n\nIn [5] we have seen that for C \u221e coefficient functions x \u2192 aij (x) and\nx \u2192 bi (x) and if some boundedness conditions of the derivatives are satisfied\nthe fundamental solution has the pointwise valid form\n!\n\u221e\nd2 (x, y) X\n1\n+\n(14)\np(t, x, y) = \u221a n exp \u2212\nck (x, y)tk ,\n2t\n2\u03c0t\nk=0\n\nwhere the functions x \u2192 ck (x, y), k \u2265 0 are solutions of recursively defined\nlinear first order equations for each y. These equations can be solved by\nmethods of characteristics or approximated by regular polynomial interpolation methods outlined in [6]. In the computation of the WKB-coefficients\n3\n\n\fd2 and ck , k \u2265 0 the recursive relations for ck+1 involve second order derivatives of ck , and therefore implicitly derivatives of order 2k of the squared\nmetric d2 . Hence it is of great interest to compute not only d2 but also\nits derivatives up to a given order with high accuracy. The present work\nshows how his can be accomplished. In Section 2 we recapture some facts\nabout the connection of the geodesic equation (6), (7) and equation (8), and\nprove global existence, regularity and uniqueness of the latter (family) of\nequation(s) leading us to theorem 2.3. Then in Section 3 we provide further\nanalysis of the family of eikonal equations which lead us to local representations of the solution. In Section 4 we construct first a weak approximation of\nthe solution (in Lp sense), and then extend this to a recursive construction\nof an H s,p -approximation. In Section 5 we provide error estimates by using\ngeometric information. Section 6 points out how the method may be applied\nfor accurate approximation of diffusions, and we finish with a conclusion in\nSection 7.\n\n2\n\nGlobal existence and regularity of the squared\nRiemannian distance d2\n\nWe shall only sketch the connection between geodesics and the eikonal equation (8). It is almost standard, and details can be found in [5] and [4]. Our\ninterest here is that the eikonal equation together with careful chosen boundary conditions has a global and unique solution. We shall have two different\narguments for uniqueness: one is via uniqueness of an associated diffusion\nand WKB-representations (or, alternatively, Varadhan's result, cf. [8]), but\nwe will have the same insight from an other point of view when we look\nat local representations of the solution in the next Section. We consider\nRiemannian manifolds where any two points can be connected by a minimal\ngeodesic. For our purposes it is sufficient to consider manifolds which are\ngeodesically complete. Recall that a Riemannian manifold M is geodesically\ncomplete if for all p \u2208 M the exponential map expp : Tp M \u2192 M is defined\nglobally on Tp M . Here, Tp M denotes the tangential space of the manifold\nM at p \u2208 M . The Hopf-Rinow theorem provides conditions for Riemannian\nmanifolds to be geodesically complete. Especially we have\nTheorem 2.1. For a Riemannian manifold M the following statements are\nequivalent:\n\u2022 M is complete as a metric space.\n\u2022 The closed and bounded sets of M are compact.\n\u2022 M is geodesically complete.\n\n4\n\n\fEach of these equivalent statements implies that geodesics are curves of\nshortest length. Moreover, if M is geodesically complete, then any two points\nof M can be joined by a minimal geodesic.\nThe connection between the arclength and equation (8) can be established as follows. First equations for minimal geodesics are obtained from\nvariation of the length functional. Second Hamilton-Jacobi calculus shows\nthat the length functional satisfies the eikonal equation (8). Since this is\nknown we only sketch the main steps for convenience of the reader. Setting\nthe variation of the length functional to zero we get\n\u0012\n\u0013\nd 1\ni\nL\n2gij \u1e8b + gij,k \u1e8bi \u1e8bj = 0\n(15)\ndr L\np\nwith L \u2261 gij (x(r))\u1e8bi \u1e8bj and where we use Einstein summation. Parameterizing by arclength, i.e. setting L \u2261 1 (or r = s) we get\n2gij \u1e8di + 2gij,l \u1e8bl \u1e8bi + gij,k \u1e8bi \u1e8bj = 0\n\n(16)\n\nwhich, upon multiplcation by g mj (entries of inverse of (gmj )) and rearranging becomes the geodesic equation (6),(7). In order to show on the other\nhand that the squared length functional satisfies (8) we may consider the\nlength functional\nZ s\nL (x(u), \u1e8b(u)) du\n(17)\nl(r, x, s, y) =\nr\n\nand invoke Hamilton-Jacobi calculus. This is done by introducing the variables pi = L\u1e8bi , and the associated Hamiltonian defined by\nH(x, p) = \u1e8bi pi \u2212 L(x, \u1e8b).\n\n(18)\n\n(here and henceforth we use Einstein summation if convenient). Then we\nmay write\nx(t) \u2261 x(t; r, x, s, y) and p(t) \u2261 p(t; r, x, s, y),\nwhere x(r; r, x, s, y) = x and x(s; r, x, s, y) = y. and compute\nls = \u2212H(x(s), p(s)).\n\n(19)\n\nThen we may connect p to lyk by computing\nlyk =\n\nr\n\n*\nR s \u0010 \u2202xi\nr\n\n\u0011\ni \u2202pi \u2212 H \u2202xi \u2212 H \u2202pi dt\np\n+\n\u1e8b\ni\npi \u2202y k\nx \u2202y k\n\u2202y k i\n\u2202y k\n\nR s \u0010 \u2202 \u1e8bi\n\np\n\u2202y k i\n\n\u0011\n\ndt =\n\ns\n\n\u2202xi\np\n\u2202y k i r\n\n5\n\n= pk (s; r, x, s, y).\n\n(20)\n\n\fby invoking the canonical system of equations. This leads to\n\u2202l X ij \u2202l \u2202l\n+\ng\n= 0,\n\u2202s\n\u2202yi \u2202yj\n\n(21)\n\nij\n\nand a similar equation with respect to the variables x. Then we get the\nequations for l2 and d2 , i. e. the equations (24) and (23) below.\nRecall that a minimal geodesic is a global distance minimizing geodesic.\nThis minimal geodesic which connects x and y characterizes the Riemannian\ndistance d(x, y) in an obvious way. Moreover smoothness of (x, y) \u2192 d(x, y)\nfor smooth diffusion and drift coefficients aij , bi follows from the following\nfact about ordinary differential equations.\nTheorem 2.2. Let F : Rn \u00d7 Rn \u2192 R be a smooth map. Consider the\ndifferential system\n\u0012\n\u0013\ndx\nd2 x\n= F x,\n,\n(22)\ndt2\ndt\n\nwhere x is a map I \u2282 R \u2192 Rn . Then for each point (x0 , y0 ) there exists a\nneighborhood U \u00d7 V of this point and \u01eb > 0 such that for (x, v) \u2208 U \u00d7 V\nequation (2.69) has a unique solution xv :]\u2212 \u01eb, \u01eb[\u2192 Rn with initial conditions\nxv (0) = x and x\u2032v (0) = v. Moreover, the map X : U \u00d7V \u00d7]\u2212\u01eb, \u01eb[\u2192 Rn defined\nby (t, x, v) \u2192 X(t, x, v) := xv (t) is smooth.\nFinally we get\n\nTheorem 2.3. Let \u03a9 \u2286 Rn be some domain. The function d2 : \u03a9 \u00d7 \u03a9 \u2286\nRn \u00d7 Rn \u2192 R+ (the leading order term of the WKB-expansion of a parabolic\nequation with diffusion coefficients aij ) is the unique function which satisfies\nthe equations\n1X 2\ndxi aij d2xj ,\n(23)\nd2 =\n4\nij\n\nd2 =\n\n1X\n4\n\nd2yi aij d2yj\n\n(24)\n\nij\n\nfor all x, y \u2208 Rn and with the boundary condition\nd(x, y) = 0 iff x = y for all x, y \u2208 Rn .\nMoreover, the squareroot d is the Riemannian distance induced by\n(\nq\nRb\n.i .j\nd(x, y) := inf\naij (\u03b3) \u03b3 \u03b3 dt|\u03b3 : [a, b] \u2192 Rn is piecewise\na\n)\nsmooth with \u03b3(a) = x and \u03b3(b) = y .\n\nThe function d2 is a C \u221e -function with respect to both variables.\n6\n\n(25)\n\n(26)\n\n\fProof. The variation of the length functional leads to the geodesic equation. On the other hand, Hamilton-Jacobi calculus leads us to the fact that\nthe squared length functional d2 satisfies the equation (8). It is clear that\nthe squared length functional satisfies both equations (23) and (24) below.\nMoreover, it is clear that the squared length functional satisfies the initial\ncondition (25). Uniqueness is a bit more subtle. In [8] Varadhan showed\nthat\nd2 (x, y) = lim 2t ln p(t, x, y),\n(27)\nt\u21930\n\nwhere p is the fundamental solution of a scalar parabolic equation with\ndiffusion coefficient function x \u2192 aij (x). Since p is unique for a strictly\nparabolic equation d2 is uniquely determined by the equation (27). On the\nother hand one knows that for small t > 0 ln p has for C \u221e coefficients\na representation of type (95) is valid (cf. [3, 5]). Plugging this into the\ncorrespondend parabolic equation leads to the eikonal equation (8) which\nis, hence, satisfied by d2 . Moreover we know by V and the fact that the\nsquareroot of d2 is a metric. Hence d(x, y) = 0 if and only if x = y, and\nthe same holds for d2 . Hence, we conclude that the global solution d2 of\nthe system of equations (8),(25) and (25) is unique. Moreover, from the\npreceding theorem we can conclude that the function (x, y) \u2192 d2 (x, y) is\nalso smooth with respect to both variables.\n\n3\n\nFurther analysis of the equation for the squared\nmetric d2\n\nNext we observe that the local representation of the solution of the equations (23), (24) with the boundary condition (25) has a local representation\nwhich starts with the quadratic terms. This will be used in the construction\nof a global approximation. The analysis presented here gives us two other\ninsights. First, a powere series ansatz leads atmost to local and not to global\nsolutions. Even if there is a local power series representation of the solution\nat each point of the domain, we do not know how a global solution can be\nconstructed from this information, because we do not know the location of\nthe geodesic the length of which we want to compute. If we knew, then\ncomputing the length would be a rather trivial task. Even the derivatives of\nthe length functional would be better computed from the explicit geodesic.\nHowever, as we mentioned the nonlinear ordinary differential equation describing the geodesic is harder to solve in general than the eikonal equation.\nSecond, we shall see from an different point of view why the boundary condition (25) leads to uniqueness of solutions (x, y) \u2192 d2 (x, y) of the system\n(23), (24), and (25). We have\n\n7\n\n\fCorollary 3.1. The local representation d2 satisfying the equations (23),\n(24), together with the boundary condition (25) is of the form\nd2 (x, y) =\n+\n\nP\n\nP\n\nij\n\naij (y)\u2206xi \u2206xj +\n\n|\u03b3|=M\n\nR1\n\nP\n\n|\u03b1<M\n\nd2\u03b1 (y)\n\u03b1\n\u03b1! \u2206x\n\n(28)\n\u03b3\n\nM \u22121 \u2206x \u2202 \u03b3 d2 (y + \u03b8\u2206x, y)d\u03b8.\n\u03b3!\n0 (1 \u2212 \u03b8)\n\nThe coefficients d\u03b1 (y) are uniquely determined by a recursion obtained from\nthe equations (23),\nwith second order normal form,\nP (24). Ini coordinates\n2\nj\ni.e. where d is ij \u03bbi (y)\u2206x \u2206x with \u03bbi (y), 1 \u2264 i \u2264 n is the spectrum of\n(aij (y)), the multiindex recursion is\nd2\u03b2 (y) =\n\n(1\u2212\n\n1\nP\n\ni\n\nP\n\n\u03b2i )\n\n+\n\nP P\n\n+\n\nP P\n\ni\n\ni\n\n\u03bbi0\n\ni\n\n\u00012\n\n\u03b2 \u2212\u03072\n\n\u03bbi i\n1\n(\u03b2 \u2212\u03072i )! {\u03b2i \u22652}\n\n\u03bb\u03b1\ni 2\ni\n|\u03b1|\u22651,|\u03b3|\u22653,\u03b1+\u03b3=\u03b2 \u03b1! \u03bb0 d\u03b3 (y)\u03b3i\n\n(29)\n!\n\n\u03bb\u03b1\n2\n2\ni\n\u03b1\u22650,|\u03b4|\u22653,|\u03b3|\u22653,\u03b1+\u03b3+\u03b4\u2212\u03072i =\u03b2 \u03b1! \u03b4i \u03b3i d\u03b4 (y)d\u03b3 (y)\n\n.\n\nThis confirms uniqueness. (Note that there is no loss of generality if we\nchoose the normal coordinates for the second order terms). In general the\nsolution is not globally analytic in the sense that d2 is not representable by\na globally converging power series.\nProof. A smooth solution d2 of the eikonal equation has the representation\nd2 (x, y) = d(y, y) + \u2207d(y, y) * (x \u2212 y)\n+\n\nP\n\n|\u03b3|=2\n\nWe abbreviate R(x, y) =\nd(y, y) = 0 we have\n\nP\n\nR1\n\n\u03b3\n\n(30)\n\n\u03b3 2\n1 \u2206x\n0 (1 \u2212 \u03b8) \u03b3! \u2202 d (x + \u03b8\u2206x, y)d\u03b8.\n\nR1\n|\u03b3|=2 0 (1\n\n\u03b3\n\n\u03b3 2\n\u2212 \u03b8)1 \u2206x\n\u03b3! \u2202 d (x + \u03b8\u2206x, y)d\u03b8. Since\n\nd2 (x, y) = \u2207d2 (y, y) * (x \u2212 y) + R(x, y)\n\n(31)\n\nThe 'only if'-condition of the boundary condition leads to \u2207d2 (y, y) = 0.\nTo see this assume that \u2207d2 (y, y) 6= 0. Since R(x, y) \u2264 Ck\u2206xk2 there is a\nsmall \u2206x such that \u2207d2 (y, y) * \u03bc\u2206x > Ck\u2206xk2 and \u2207d2 (y, y) * (\u2212\u03bc)\u2206x <\n\u2212Ck\u2206xk2 for some \u03bc \u2208 (0, 1]. Hence there exists some \u03c1 such that with\nx\u2032 := y + (\u03c1\u03bc)\u2206x\nd2 (x\u2032 , y) = \u2207d2 (y, y) * (\u03c1\u03bc)\u2206x + R(x\u2032 , y) = 0,\n\n8\n\n(32)\n\n\fcontradicting one part ofPthe boundary condition d2 (x, y) = 0 iff x = y.\nNext one computes that ij aij (y)\u2206xi \u2206xj satisfies the equation\nd2 (x, y) =\n\n1X\naij (y)d2xi d2xj ,\n4\n\n(33)\n\nij\n\nand the uniqueness of theorem 2.3. (which we established by arguing with\nuniqueness of related diffusions and Varadhan's result, in the Atiyah-Singer\nspirit of short-range analytic expansions) identifies the coefficients aij (y) as\nthe second order terms of local representations around y. Having obtained\nthis the representation (28) is just a multivariate version of Taylor's theorem.\nNote, however, that we do not need to invoke the uniqueness of theorem 2.3.\nbut just consider a recursion obtained from a power series ansatz starting\nwith second order terms. However, this would complicate the matter a\nbit so we take advantage that we know the second order terms of a local\nrepresentation by the preceding argument. Finally we have to establish\nthe recursion in (29). The recursion shows directly that the higher order\ncoefficients d2\u03b2 (y) for |\u03b2| \u2265 3 are uniquely determined. Moreover, it is clear\nfrom (29) that in general the convergence radius of the full power series is\nsmall (if not zero). Hence in general there is no globally analytic solution\nthe function d2 : \u03a9 \u00d7 \u03a9 \u2192 R globally analytic if for each y \u2208 Rn the Taylor\nexpansion of d2 at y \u2208 Rn and x \u2208 Rn equals d2 globally, i.e.\nd2 (x, y) =\n\nX \u2202\u03b1 d2 (y)\n\u03b1\n\n\u03b1!\n\n(x \u2212 y)\u03b1 forall x, y \u2208 Rn .\n\n(34)\n\nInvoking the implicit function theorem equation (8) is equivalent to\nd2 =\n\n1X\n\u03bbi (x)d2xi d2xi ,\n4\n\n(35)\n\ni\n\nwhere \u03bbi (x), 1 \u2264 i \u2264 n is the spectrum of the positive (aij (x)). Since\nd2xi = 2ddxi this is equivalent to\n1=\n\nX\n\n\u03bbi (x)dxi dxi\n\n(36)\n\ni\n\nThe latter equation is easier but there is no Taylor expansion around y as can\nbe seen in the case of constant coefficients (and hence constant eigenvalues\n\u03bb), where the solution is\nv\nu n\nuX \u2206x2i\n(37)\nd(x, y) = t\n\u03bbi\ni=1\n\n9\n\n\fRemark 3.2. We use equation (35) mainly for the theoretical purposes of\nthis corollary. In general it cannot be in general used for numerical purposes\nsince this would imply that we have an efficient procedure to compute the\neigenvalue functions of a space dependent matrix. Since we are looking for\nhigh precision in this paper, this is not possible in general. An exception is\nthe case of dimension n = 2 where we have\ns\u0012\n\u0013\ntr(A)(x) 2\ntr(A)(x)\n\u2212 det(A)(x)\n(38)\n\u00b1\n\u03bb1,2 (x) =\n2\n2\nwhere A(x) = (aij (x)).\nNext we plug in the power series expansion\nd2 (x, y) =\n\nn\nX\n\nX\n\n\u03bbi0 \u2206x2i +\n\ni=1\n\nd2\u03b2 (y)\u2206x\u03b2\n\n(39)\n\n|\u03b2|\u22653\n\nWe have\n\nX\n\nd2xi = 2\u03bbi0 (y)\u2206xi +\n\nd2\u03b2 (y)\u03b2i \u2206x\u03b2 \u2212\u03071i ,\n\n(40)\n\n|\u03b2|\u22653\n\nwhere for any multiindex \u03b2 we define\n\u001a\n(\u03b21 , * * * , \u03b2i \u2212 1, * * * \u03b2n ) if \u03b2i \u2265 1\n\u03b2 \u2212\u03071i = (\u03b21 , * * * , \u03b2i , * * * \u03b2n )\u2212\u03071i :=\n(\u03b21 , * * * , 0, * * * \u03b2n ) else\n\n(41)\n\nThe term \u03b2 \u2212 2i is defined analogously.\nPlugging in the power series ansatz\n\u00012\nand using the relation \u03bb0i \u03bbi0 = \u03bb0i , this leads to\n\u0011\n\u0010P\n\u0001\nP\n2 (y)\u2206x\u03b2\n1 \u2212 i \u03b2i \u03bbi0 \u03bb0i\nd\n|\u03b2|\u22653 \u03b2\n=\n=\n\n\u0010P\n\n\u03b2\n2\n|\u03b2|\u22653 d\u03b2 (y)\u2206x\n\n\u0010P P\ni\n\n+\n+\n\n\u03bb\u03b1\n\u03b1\ni\n|\u03b1|\u22651 \u03b1! \u2206x\n\n\u0010P P\ni\n\n\u0010P P\n\n\u0010P\n\ni\n\n\u0011\n\n(1 \u2212\n\n\u0011\n\n\u03bbi0\n\n\u03bb\u03b1\n\u03b1\ni\n|\u03b1|\u22651 \u03b1! \u2206x\n\u03bb\u03b1\n\u03b1\ni\n\u03b1 \u03b1! \u2206x\n\n\u0011\n\nP\n\n\u00012\n\ni \u03b2i )\n\n\u2206x2i +\n(42)\n\n\u0011\n\u0011\u0010 P\n\u03bbi0 |\u03b2|\u22653 d2\u03b2 (y)\u03b2i \u2206x\u03b2\n\n\u00d7\n\n\u03b2 \u2212\u03071 \u2206x\u03b3 \u2212\u03071\n2\n2\n|\u03b2|\u22653,|\u03b3|\u22653 \u03b2i \u03b3i d\u03b2 (y)d\u03b3 (y)\u2206x\n\n10\n\n\u0011\n\n.\n\n\fThis leads to\nP\n=\n\n2\n\u03b2\n|\u03b2|\u22653 d\u03b2 (y)\u2206x\n\n(1\u2212\n+\n+\n\n1\nP\n\ni\n\ni \u03b2i )\n\n\u0010P P\ni\n\n\u0010P P\ni\n\n\u0010P\n\n\u0010P P\n\n\u03bb\u03b1\n\u03b1\ni\n|\u03b1|\u22651 \u03b1! \u2206x\n\n\u03bb\u03b1\n\u03b1\ni\n|\u03b1|\u22651 \u03b1! \u2206x\n\u03bb\u03b1\n\u03b1\ni\n\u03b1 \u03b1! \u2206x\n\n\u0011\n\n\u0011\n\n\u03bbi0\n\n\u00012\n\n\u2206x2i +\n\n\u0011\n\u0011\u0010 P\n\u03bbi0 |\u03b2|\u22653 d2\u03b2 (y)\u03b2i \u2206x\u03b2\n\n(43)\n\n\u00d7\n\n2\n\u03b2 \u2212\u03071 \u2206x\u03b3 \u2212\u03071\n2\n|\u03b2|\u22653,|\u03b3|\u22653 \u03b2i \u03b3i d\u03b2 (y)d\u03b3 (y)\u2206x\n\n\u0011\n\n!\n\n.\n\nSimplifying and renaming multiindices in order to collect for multiindices of\norder \u03b2 we get\nP\n2\n\u03b2\n|\u03b2|\u22653 d\u03b2 (y)\u2206x\n=\n\n(1\u2212\n\n1\nP\n\ni \u03b2i )\n\nP P\ni\n\n+\n\nP P\n\n+\n\nP P P\n\ni\n\ni\n\n|\u03b1|\u22651\n\n\u03b1\n\nP\n\n|\u03b1|\u22651\n\n\u03bbi0\n\n\u00012\n\n\u03bb\u03b1\n\u03b1+2i +\ni\n\u03b1! \u2206x\n\n(44)\n\n\u03bb\u03b1\n\u03b1+\u03b3\ni 2\ni\n|\u03b3|\u22653 \u03b1! \u03bb0 d\u03b3 (y)\u03b3i \u2206x\n\u03bb\u03b1\ni\n\n2\n\u03b1+\u03b3+\u03b4\u2212\u03072i\n2\n|\u03b4|\u22653,|\u03b3|\u22653 \u03b1! \u03b4i \u03b3i d\u03b4 (y)d\u03b3 (y)\u2206x\n\n!\n\n.\n\nThe latter equation leads directly to (29).\nLet us draw some consequences out of our theoretical considerations.\nThere is neither an explicit solution nor leads a power series ansatz to a\nglobal solution in general. Neither does it help to have local solutions in\nterms of power series. Such representations are not sufficient for our purposes, since we are interested in a global solution for x \u2192 d2 (x, y) and do\nnot know the intermediate points on the corresponding geodesic in order to\ncompute the global d2 by means of local power series representations. This\nmotivates our later construction of regular polynomial interpolation of d2 as\nseemingly unavoidable.\n\n11\n\n\f4\n\nRegular polynomial interpolation algorithm for\nthe Riemannian metric and its derivatives\n\nFor the moment let us denote again an interpolation polynomial which approximates the squared Riemannian distance d2 in the Lp -sense on some\n2 and one that approximates the squared Riemanbounded domain \u03a9 by q0,p\n2 . How can we check\nnian distance d2 in the H s,p -sense (again on \u03a9) by qs,p\nthat a given polynomial is an approximation in either sense? The equation\n2 of d2 performs. In order\n(8) gives us itself a hint how an approximation qs,p\np\np\n2\nto obtain the L error of an L approximation q0,p of d2 we may plug in the\n2 into the right side of equation (8) and subtract the left\napproximation qs,p\nside, i.e. we compute\n2 \u2202q 2\n\u2202q0,p\n1X\n0,p\n2\naij (x)\n\u2212 q0,p\n= r0,p (x),\n4\n\u2202xi \u2202xj\n\n(45)\n\nij\n\nWe shall see that r0,p \u2208 O(h3 ) locally (with h the mesh size of the interpolation points) implies that\nkd(x, y) \u2212 q0,p kLp (\u03a9)\n\n(46)\n\nconverges to zero as the number of interpolation points N goes to infinity in\nsuch a way that the mesh size of the set of interpolation points h goes to zero.\n2 . We call an approximation q 2\nNote that q0,p denotes the squareroot of q0,p\ns,p\ns,p\nan H -approximation if it approximates not only d2 in the Lp sense but\ncan be plugged in into all the derivatives of (8) of order m (i.e. multivariate\nderivatives \u03b1 for |\u03b1| \u2264 m of the eikonal equation) such that in\n\uf8eb\n\uf8f6\n2 \u2202q 2\n\u03b1\nX\n\u2202q\n\u2202 \uf8ed1\n\u2202\u03b1\n0,p\n0,p \uf8f8\naij (x)\n\u2212 \u03b1 d2 (x, y) =: r\u03b1,p\n(47)\n\u03b1\n\u2202x\n4\n\u2202xi \u2202xj\n\u2202x\nij\n\nthe right side staisfies r0,p \u2208 O(h3+m ) locally implies that\nkd(x, y) \u2212 q0,p kH s,p (\u03a9)\n\n(48)\n\nconverges to zero as the number of interpolation points N goes to infinity\nin such a way that the mesh size of the set of interpolation points h goes\n2 (q 2 ) an Lp - (H s,p ) approximation\nto zero. Accordingly, we call such q0,p\ns,p\nof the boundary value problem (8). In the next subsection we construct a\nLp -approximation and refine the construction in the following subsection in\norder to construct H s,p -approximations.\n\n12\n\n\fPolynomial interpolation of eikonal equation in Lp sense\n\n4.1\n\nWe may write the eikonal equation (8)\n1X\n1\nd2 (x, y) =\naij d2xi d2xj =\n\u2207d2 , A\u2207d2 .\n4\n4\n\n(49)\n\nij\n\nAssume that A = (aij ) is constant. The solution (8) with the boundary\ncondition d2 (x, y) = 0 iff x = y is\nd2 (x, y) = \u2206x, A\u22121 \u2206x ,\n\n(50)\n\nwhere \u2206x = (x \u2212 y), and A\u22121 =: (aij ) denotes the inverse of the matrix A.\nThis is easily verified by observing that\n\u2207d2 = 2A\u22121 x.\n\n(51)\n\nDefine\nd2A\u22121 (xj ) (x, y) =\n\nX\nml\n\nalm (xj )(xl \u2212 y l )(xm \u2212 y m ), j = 0, * * * , N\n\n(52)\n\nwe get the first recursively defined approximation algorithm for the Riemannian distance based on N + 1 interpolation points x0 = y, x1 , x2 , * * * , xN .\nNote that the squared distance is a function\nd2 : \u03a9 \u00d7 \u03a9 \u2286 Rn \u00d7 Rn \u2192 R+ ,\n\n(53)\n\nwhere we define R+ := {x|x \u2265 0}. There are several ways to approximate\nthe function d2 . In order to approximate this function we approximate first\nthe function x \u2192 d2 (x, y), then the function x \u2192 d2 (x, x1 ) and so on up to\nx \u2192 d2 (x, xN ).\nWe start with the approximation of x \u2192 d2 (x, y). First define\nd200 (x, y) = d2A\u22121 (y) (x, y)\n\n(54)\n\nd210 (x, y) = d2A\u22121 (y) (x, y) + c10 \u03a0nl=1 (xl \u2212 yl )2 d2A\u22121 (x1 ) (x, y),\n\n(55)\n\nNext define\n\nand determine a real number c10 such that\n1X\naij (x1 )d21,xi (x1 , y)d21,xj (x1 , y),\nd21 (x1 , y) =\n4\n\n(56)\n\nij\n\ni.e. the eikonal equation (8) with respect to x and fixed parameter y is satisfied at x1 . Proceeding we get a series d210 , d220 , * * * , d2k0 , * * * of approximations\nof the form\nd2k0 (x, y) = d2A\u22121 (y) (x, y) +\n\nk\nX\nj=1\n\ncj0 \u03a0jr=0 \u03a0nl=1 (xl \u2212 xrl )2 d2A\u22121 (xj ) (x, y).\n13\n\n(57)\n\n\fHaving determined the real numbers c10 , * * * c(k\u22121)0 we obtain the real number ck0 by solving\n1X\nd2k0 (xk , y) =\n(58)\naij (xk )d2k0,xi (xk , y)d2k0,xj (xk , y).\n4\nij\n\nfor ck0 . Continuing this procedure for N interpolation points we get a polynomial of the form\nd2N 0 (x, y) = d2A\u22121 (y) (x, y) +\n\nN\nX\nj=1\n\ncj0 \u03a0jr=0 \u03a0nl=1 (xl \u2212 xrl )2 d2A\u22121 (xj ) (x, y). (59)\n\nwith N real numbers cj0 obtained recursively by plugging in d2j0 with one\ndegree of freedom cj0 into (58).\nAnalogous constructions are done to approximate x \u2192 d2 (x, xj ) for k =\n1, * * * , N with\nd2N k (x, xk )\n\n=\n\nd2A\u22121 (y) (x, xk )+\n\nN\nX\nj=1\n\ncjk \u03a0jr=0 \u03a0nl=1 (xl \u2212xrl )2 d2A\u22121 (xj ) (x, xk ), (60)\n\nwith cjk computed analogously. The construction of the functions d2N 0 , * * * , d2N N\nsuffices to approximate d2 (we do not need to synthesize these functions into\none function, for example by a Lagrangian polynomial interpolation). Note\nthat for j = 0, * * * N the function d2N k satisfies the equation\nP\nd2 (x, xk ) = 41 ij aij (x)d2xi (x, xk )d2xj (x, xk )\nwith boundary condition\n\n(61)\n\nd2 (x, xk ) = 0 iff x = xk .\nat all interpolation points x0 , * * * xN by construction.\n\nRemark 4.1. Note that in the preceding construction no restrictions on the\nchoice of the interpolation points are made. This does not mean that one\nmay search for an optimal choice of interpolation points and improve efficiency and convergence. We are free to choose a certain set of interpolation\npoints (for example Chebyshev nodes). But these are purely computational\naspects which will be exploited elsewhere.\nRemark 4.2. Note that we have constructed an approximation of the squared\nmetric d2 . The metric d is then approximated naturally by the squareroot\nof the approximation of the squared metric, i.e. we consider the function\nq\nk\n(62)\nx \u2192 dN k (x, x ) := d2N k (x, xk )\n\nto be the approximation of the metric function x \u2192 d(x, xk ).\n14\n\n\f4.2\n\nConstruction of H s,p -approximations\n\nWe refine the construction of the preceding section by construction of an\napproximation which solves not only (8), (or the set of equations (23), (24)\nwith boundary conditions (25)), but also all multivariate derivatives of (8)\nup to a given order m at the interpolation points. It turns out then that these\npolynomials are H s,p -approximations for s \u2264 m. The approximation is constructed recursively again. For a multiindex \u03b2 of order |\u03b2| = m \u2265 3 we denote the approximations of order d2M (\u03b2m )n,N or just d2M (\u03b2m ) if we do not want\nto refer to the number of interpolation points N and the dimension of the\nproblem n explicitly. The choice of the mesh is free again (in principle). We\njust assume that a set {x1 , * * * , xN } of interpolation points is given. Again\nwe may construct functions x \u2192 d2M (\u03b2)0 (x, y), x \u2192 d2M (\u03b2)0 (x, x1 ),..., and\nx \u2192 d2M (\u03b2)0 (x, xN ). We shall construct the first function x \u2192 d2M (\u03b2)0 (x, y)\nfor arbitrary multiindex \u03b2. The other functions can be constructed completely analogously. We start with the Lp -approximation.\nd2N 0 (x, y) = d2A\u22121 (y) (x, y) +\n\nN\nX\nj=1\n\ncj0 \u03a0jr=1 \u03a0nl=1 (xl \u2212 xrl )2 d2A\u22121 (xj ) (x, y), (63)\n\nwhere the numbers cj1 have been determined according to section 4.1.. Next\nwe define d2M (\u03b2)0 (x, xN ) for multiindices of order |\u03b2| = 3. Let \u03b2 0 , * * * , \u03b2 k , * * * , \u03b2 R\na list of multiindices of order 3. The length R of this list is dependent of\nthe dimension n of course. Start with \u03b2 0 = (\u03b210 , * * * , \u03b2n0 ) and let \u03b3 0 be an\nmultiindex with |\u03b3| = 2 such that \u03b2 0 \u2212 \u03b3 = 1i for some index i. Define\n(recall that x0 = y)\nd2\u03b2 0 0 (x, y) = d2N 0 (x, y) +\n\n0\n1 0\nc 0 (x \u2212 y)\u03b2 .\n\u03b20! \u03b2\n\n(64)\n\nThen plug d2\u03b2 0 0 (x, y) into the equation\n(\u03b2 0 \u2212\u03b3 0 ) 2\nd (x, y)\n\n\u2202x\n\n(\u03b2 0 \u2212\u03b3 0 )\n\n= \u2202x\n\n\u0010 P\n1\n4\n\n\u0011\n\u2202d2 \u2202d2\na\n(x)\nij\nij\n\u2202xi \u2202xj ,\n\n(65)\n\nevaluate at x = x0 = y and solve for the real number c0\u03b2 0 . Then proceed\nrecursively: having defined the function x \u2192 d2\u03b2 0 (k\u22121) (x, y) define\nk\u22121\n(x \u2212 xl )\u03b2\nd2\u03b2 0 k (x, y) = d2\u03b2 0 (k\u22121) (x, y) + ck\u03b2 0 \u03a0l=0\n\n0 +1\n\n1\n0\n(x \u2212 xk )\u03b2 ,\n0\n\u03b2 !\n\n(66)\n\nwhere 1 = (1, 1, * * * , 1). Then plug d2\u03b2 0 k (x, y) into the equation (69), evaluate\nat y, and solve for ck\u03b2 0 . When k = N we have got the approximation\nd2\u03b2 0 N (x, y) = d2N 0 (x, y) +\n\nN\nX\nk=0\n\nk\u22121\nck\u03b2 0 \u03a0l=0\n(x \u2212 xl )\u03b2\n\n15\n\n0 +1\n\n1\n0\n(x \u2212 xk )\u03b2 .\n\u03b20!\n\n(67)\n\n\fwith N + 1 real numbers ck\u03b2 0 for 0 \u2264 k \u2264 N determined recursively. Note\nthat the function x \u2192 d2\u03b2 0 k (x, y) satisfies the equations (8) and (69) at all\ninterpolation points x0 , * * * , xN . Then we take the next multiindex \u03b2 1 from\nthe list of multiindices of order 3 (i.e. |\u03b2 1 | = 3) where we may assume\nthat \u03b2 1 \u2212 \u03b3 1 = 1k for some multiindex \u03b3 1 with |\u03b3 1 | = 2 and some index\nk. An analogous construction as in the case of \u03b2 0 can be done. The only\ndifference is that we start with d2\u03b2 0 N (x, y) instead of d2N 0 (x, y). We get an\napproximation of the form\nd2\u03b2 1 N (x, y) = d2\u03b2 0 k (x, y) +\n\nN\nX\nk=0\n\nk\u22121\n(x \u2212 xl )\u03b2\nck\u03b2 1 \u03a0l=0\n\n1 +1\n\n1\n1\n(x \u2212 xk )\u03b2 .\n1\n\u03b2 !\n\n(68)\n\nwhere the real numbers are computed recursively by plugging the current\napproximation into the equation\n\u0011\n\u0010\n(\u03b2 1 \u2212\u03b3 1 ) 2\n(\u03b2 1 \u2212\u03b3 1 ) 1 P\n\u2202d2 \u2202d2\n(69)\na\n(x)\n\u2202x\nd = \u2202x\nij\nij\n4\n\u2202xi \u2202xj ,\n\nevaluating at the current interpolation point and solving for the currently\nundetermined real number ck\u03b2 1 . Doing this for all the multiindices of order\n3 in the list above we get the approximation\nd2M (\u03b23 ) (x, y) := d2\u03b2 N N (x, y).\n\n(70)\n\nNote that by construction the function x \u2192 d2M (\u03b23 ) (x, y) satisfies the equation (8) and all its first order derivative equations\n!\nX\n1\n\u2202xi d2 = \u2202xi\nalm (x)d2xl d2xm , 1 \u2264 i \u2264 n,\n(71)\n4\nlm\n\nat all interpolation points x0 = y, x1 , * * * , xN . This completes the stage of\nconstruction for multiindices of order 3. Next assume that the construction\nfor the approximation\nx \u2192 d2M (\u03b2m ) (x, y)\n(72)\nof order m has been completed. Then we may list the multiindices of order\nm + 1, i.e. consider a list of multiindices \u03b40 , \u03b41 , * * * , \u03b4Rm+1 such that |\u03b4| =\nm + 1. The procedure is then quite similar as in the stage for multiindices\nof order 3. Therefore we give a very short description. Starting with the\nmultiindex \u03b40 there is a multiindex \u03b2 k of order m (i.e. |\u03b2 k | = m) such that\n\u03b40 \u2212 \u03b2 k = 1i for some index i. Then we get successive approximations\nd2\u03b40 k (x, y)\n\n=\n\nd2M (\u03b2m ) (x, y)\n\n+\n\nk\nX\nr=0\n\nr\u22121\n(x \u2212 xl )\u03b4\ncr\u03b40 \u03a0l=0\n\n16\n\n0 +1\n\n1\n0\n(x \u2212 xr )\u03b4 ,\n0\n\u03b4 !\n\n(73)\n\n\fwhere the real numbers ck\u03b40 are succesively determined by plugging in the\nfunction x \u2192 d2\u03b40 k (x, y) into the equation\n!\n1 \u03b2k X\n\u03b2k 2\n2 2\n\u2202 d = \u2202\nalm (x)dxl dxm ,\n(74)\n4\nlm\n\nk\n\n0\n\nevaluated at the interpolation point xk (Note that \u2202 \u03b2 = \u2202 \u03b4 \u22121i ). After\nN + 1 steps we get the approximation function x \u2192 d2\u03b40 N (x, y). Having\ndefined x \u2192 d2\u03b4l N (x, y) for l = 0, * * * p \u2212 1 the next multiindex \u03b4r may be\nsuch that there is an multiindex \u03b2 h of order m such that \u03b4r \u2212 \u03b2 h = 1i for\nsome index i. We may then define x \u2192 d2\u03b4p k (x, y)\nd2\u03b4p k (x, y)\n\n=\n\nd2M (\u03b2m ) (x, y)\n\n+\n\nk\nX\nr=0\n\nr\u22121\n(x \u2212 xl )\u03b4\ncr\u03b4p \u03a0l=0\n\np +1\n\n1\np\n(x \u2212 xr )\u03b4 ,\n\u03b4p !\n\n(75)\n\nand determine the constants cr\u03b4p by plugging in the function x \u2192 d2\u03b4r k (x, y)\ninto the equation\n!\n1 \u03b2h X\n2 2\n\u03b2h 2\nalm (x)dxl dxm ,\n(76)\n\u2202 d = \u2202\n4\nlm\n\nand evaluate at\n\nxk .\n\nFinally, we get the approximation of order m+1, namely\nd2M (\u03b2m+1 ) = d2\u03b4Rm+1 N (x, y).\n\n(77)\n\nNote that this approximation satisfies the eikonal equation (8) and all its\nderivatives up to order m + 1, i.e. all equations\n!\nX\n1\n\u2202x\u03b1 d2 = \u2202x\u03b1\n(78)\nalm (x)d2xl d2xm\n4\nlm\n\nwith |\u03b1| \u2264 m + 1 at all interpolation points x1 , * * * xN .\n\nRemark 4.3. Note that at some stage of the construction we may have a\nmultiindex \u03b3 such that \u03b3 \u2212 \u03b1 = 1i0 for some \u03b1 and some index i0 . Then the\nterms in the \u03b1th derivative of the eikonal equation evaluated at xk that do\nk\u22121\n(x \u2212 xl )\u03b3+1 (x \u2212 xk )\u03b3 are quite easily\nnot annihilate a term of form ck\u03b3 \u03a0l=0\ncomputed. For this reason the constants of the form ck\u03b3 are quite easily\ncomputed. You can see very easily this by writing the \u03b1th derivative of the\neikonal equation invoking symmetry aij = aji . We have\n\u0011\n\u0010 P\n2 \u2202d2\n\u2202 \u03b1 d2 (x, y) = \u2202 \u03b1 41 ij aij (x) \u2202d\n\u2202xi \u2202xj\n=\n\n1\n2\n\n+ 41\n\nP\n\n\u0010\n\u0011\nP\n\u03b1 \u2202d2 \u2202d2 + 1\na\n(x)\n\u2202\nij\nij\nij\n\u2202xi \u2202xj\n4\n\nP P\nij\n\n\u03b2<\u03b1\n\nP\n\n\u03b1\u0001 \u03b2 \u0001\n\u03b3\u2264\u03b2 \u03b2 \u03b3\n\n\u2202\u03b1\n\u2202x\u03b1 aij (x)\n\n\u0001 \u2202d2 \u2202d2\n\u2202xi \u2202xj\n\n\u0011\n\u0001\u0010\n2\n\u03b3 \u2202d2\n\u2202 \u03b2 aij (x) \u2202 \u03b1\u2212\u03b2\u2212\u03b3 \u2202d\n\u2202xi \u2202 \u2202xj\n17\n\n(79)\n\n\fIf the indicated approximation\nis\u0011 plugged into (79) and evaluated at xk only\n\u0010\nP\n2\n\u2202d\n\u2202d2\n2\nthe terms 21 j ai0 j (x) \u2202 \u03b1 \u2202x\n\u2202xj (evaluated for approximations d\u03b3k at\ni\n0\n\nk\u22121\n(x\u2212xl )\u03b3+1 (x\u2212\ninterpolation point xk ) do not annihilate terms of form ck\u03b3 \u03a0l=0\nk\n\u03b3\nx ) .\n\n5\n\nError estimates for the regular polynomial interpolation algorithm\n\nWe first consider error estimates for Lp -approximations, and then extend\nour estimates to H s,p -approximations. In the whole Section we consider a\nbounded domain \u03a9 \u2286 Rn and assume that the coefficient functions aij are\nC \u221e.\n\n5.1\n\nError estimates for Lp approximation\n\nWe have\nTheorem 5.1. The approximations d2N k defined in (60) are Lp - approximations of the boundary value problems of form (61), i.e. Lp - approximations\nfor functions of form x \u2192 d2 (x, xk ) for p > 1.\nProof. Let x and y be two points connected by a geodesic curve \u03b3 given in\nlocal coordinates with values in Rn . Let us assume also that x and y are\ninterpolation points. We have no solution for the curve \u03b3 in general, but\nthere are lets say k points z 0 = x, z 1 * * * z k = y in the image of the curve \u03b3\nwith Euclidean distance less than a certain mesh size h. Clearly,\nd(x, y) =\n\nN\nX\n\nd(z i , z i+1 )\n\n(80)\n\ni=0\n\nNext define an approximative distance along the geodesic of form\ndg (x, y) =\n\nn\nX\n\ndg (z i , z i+1 ),\n\n(81)\n\ni=0\n\nP\ni \u2212 z i+1 )(z i \u2212 z i+1 ).\nwhere dg is the squareroot of d2g (z i , z i+1 ) := lm alm (zm\nm\nl\nl\nSince y is fixed d is approximated by dN 0 and we estimate\nd(x, y) \u2212 dN 0 (x, y) = d(x, y) \u2212 dg (x, y) + dg (x, y) \u2212 dN 0 (x, y)\n\n(82)\n\nOur analysis showed that the local approximation of d2 by d2g is of order\n\u0010 3\u0011\nO(h3 ) hence the approximation of d by dg is of order O h 2 , hence with\n18\n\n\fgeneric constant C we have for the first summand on the right hand side of\n(82)\n|d(x, y) \u2212 dg (x, y)| =\n\nN\nX\ni=0\n\n\u221a\n\u0001\n| d(z i , z i+1 ) \u2212 dg (z i , z i+1 ) | \u2264 C h\n\n(83)\n\nThe modulus of the first summand on the right hand side can be estimated\nby\n\u221a\n(84)\n|d(x, y) \u2212 dg (x, y)| \u2264 C h\n\nSince \u03a9 is a compact bounded domain, the C \u221e coefficient functions aij are\nLipschitz Only locally Lipschitz is needed). Assuming a suitable choice of\nthe points on the geodesic for the second summand we get by an elementary\nargument that\nkdg (x, y) \u2212 dN 0 (x, y)kLp \u2264\n\n5.2\n\nN\nX\ni=0\n\nkd(z i , z i+1 ) \u2212 dg (z i , z i+1 )kLp \u2264 Chp\u22121 . (85)\n\nError estimates for H s,p approximation\n\nTheorem 5.2. The approximations d2M (\u03b2m ) defined in (77) are H s,p - approximations of the boundary value problems of form (61) for s \u2264 m, i.e.\nH s,p - approximations for functions of form x \u2192 d2 (x, xk ) for p > 1.\nProof. For fixed y the function x \u2192 d2 (x, y) and the function x \u2192 d2M (\u03b2m ) (x, y)\nboth satisfy the eikonal equation and its derivatives at any interpolation\npoint by construction. That means that for all interpolation points xj , 1 \u2264\nj \u2264 N and all derivatives \u03b3 \u2264 m we have\n\u2202x\u03b3 d2 (xj , y) = \u2202x\u03b3 d2M (\u03b2m ) (xj , y).\n\n(86)\n\nNext recall a multivariate version of Taylor's theorem\nTheorem 5.3. If f \u2208 C \u221e , then for all positive integers M we have\nf (x + y) =\n+M\n\nP\n\nP\n\n|\u03b1|<M\n\ny\u03b3\n|\u03b3|=M \u03b3!\n\n(\u2202\u03b1f )(x) \u03b1\ny\n\u03b1!\n\n(87)\nR1\n0\n\n(1 \u2212\n\n\u03b8)M \u22121 (\u2202 \u03b3 f )(x\n\n+ \u03b8y)d\u03b8\n\nApplying this formula, we see from our construction of x \u2192 d2M (\u03b2m ) (x, y)\nthat the local order of approximation of x \u2192 d2 (x, y) is O(h3+m ). A similar\nreasoning as in the preceding Section leads to the result. Note here that\nthe same reasoning holds when y is replaced by another interpolation point\nxj .\n19\n\n\fRemark 5.4. (Sharper error estimates) A little analysis shows that the local\norder of approximation is\nd2 (x, y) \u2212 d2M (\u03b2m ) (x, y) \u2264 CP\n\nhm\n,\nm!\n\nwhere P is the number of multiindices of order m and\n\uf8f1\n\uf8fc\n\uf8f2 X\n\uf8fd\nX\nC := 2 max\nsup \u2202 \u03b3 d2 (x, y),\nsup \u2202 \u03b3 d2M (\u03b2) (x, y)\n\uf8f3\n\uf8fe\nx\u2208\u03a9\nx\u2208\u03a9\n|\u03b3|=M\n\n(88)\n\n(89)\n\n|\u03b3|=M\n\nSimilarly for |\u03b2| \u2264 m we get\n\n\u2202 \u03b2 d2 (x, y) \u2212 \u2202 \u03b2 d2M (\u03b2m (x, y) \u2264 C\n\nhm\u2212|\u03b2|\n,\n(m \u2212 |\u03b2|)!\n\n(90)\n\nSince we are working on a bounded domain and d2 is C \u221e there is some\nbound C, but not a priori known. However bounds for C may be obtained\nfrom a priori estimates by inspection of the eikonal equation. It is clear that\n1X\nd2 =\naij d2xi d2xj .\n(91)\n4\nij\n\nis equivalent to\nd2 =\n\n1X\n\u03bbi d2xi d2xi ,\n4\n\n(92)\n\ni\n\nand, hence\n\n4d2\n,\n(93)\n\u03bbmin\nwhere \u03bbmin = mini inf x\u2208\u03a9 \u03bb(x). Further a priori estimates for the derivatives\nmay be obtained from derivatives of the eikonal equation.\n|d2xi | \u2264\n\n6\n\nAnalytic approximations of the fundamental solution of parabolic equations\n\nConsider the parabolic equation\nX\n\u22022p\n\u2202p\n\u2202p 1 X\naij (x)\n\u2212\n\u2212\nbi (x)\n=0\n\u2202t\n2\n\u2202xi \u2202xj\n\u2202xi\nij\n\n(94)\n\ni\n\non some domain (0, T ) \u00d7 \u03a9 \u2286 (0, T ) \u00d7 Rn , and where x \u2192 (aij (x)) is a\nmatrix-valued C \u221e -function with symmetric positive matrix (aij (x)) for all\nx \u2208 \u03a9, and x \u2192 b(x) is also a C \u221e -function. Plugging in the Ansatz\n!\n\u221e\n1\nd2 (x, y) X\nk\n+\n(95)\np(t, x, y) = \u221a n exp \u2212\nck (x, y)t ,\n2t\n2\u03c0t\nk=0\n20\n\n\fleads to the recursive equation (8) for d2 . Given d2 the first order recursive\nequation\n\uf8eb\n\uf8f6\nd2xj \u2202c0\nn 1 2 1 X \uf8edX\n\uf8f8\n\u2212 + Ld +\n(aij (x) + aji (x))\n(x, y) = 0,\n(96)\n2 2\n2\n2\n\u2202xi\ni\n\nj\n\ntogether with the boundary condition\nq\n1\n(97)\nc0 (y, y) = \u2212 ln det (aij (y))\n2\ndetermines c0 uniquely for each y \u2208 Rn . Furthermore, having computed all\nWKB-coefficient functions cl up to order k, for k + 1 \u2265 1 the coefficient\nfunction ck+1 can be computed via the first order equation\n\u0010 d2\n\u0011\nd2xj \u2202c\nP\n\u2202ck+1\nk+1\n(k + 1)ck+1 (x, y) + 21 ij aij (x) 2xi \u2202x\n+\n2\n\u2202x\nj\ni\n(98)\nP\nP\nP\nP\n2c\n\u2202c\nk\n\u2202c\n\u2202\n\u2202c\n+ 12 ij aij (x) \u2202xi \u2202xk j + i bi (x) \u2202xki ,\n= 21 ij aij (x) l=0 \u2202xli \u2202xk\u2212l\nj\nwith the boundary conditions\n\nck+1 (x, y) = Rk (y, y) if\n\nx = y,\n\n(99)\n\nRk being the right side of (98). We will show in a subsequent paper that\nequations (96) (97), and (98),(99) can be solved or approximated to higher\norder if (8) is solved or approximated to higher order. We have\nProposition 6.1. In order to compute the WKB-approximation up to order\nk a H s,p approximation of d2 for s \u2265 2k is sufficient.\n\nProof. In each recursion step (98) an operator of order 2 is applied to the\npreviously computed WKB-coefficients.\n\n7\n\nConclusion and final remarks on computational\nissues\n\nWe have established a stable algorithm for efficient computation of the length\nof geodesics as a function of two arbitrary points on C k - Riemannian manifold with minimal geodesic as well as of partial derivatives of the length functional (of principally any order) accurately. We established error estimates\nin arbitrary Sobolev norms. We showed how the algorithm can be applied in\norder to compute fundamental solutions of irreducible linear parabolic equations. There are many obvious applications to mathematical physics and\nfinance as well as to statistics, e.g. to the maximum log-likelihood method,\nto option pricing, computing transition amplitudes etc.. Finally, we remark\nthat the interpolation polynomials should not be evaluated in the way they\nare constructed. Here careful implementation of Horner schemes is needed.\nBut this computational issues will be considered in a subsequent paper.\n21\n\n\fReferences\n[1] M. Avellaneda et al.:M\u00e9thodes de grandes d\u00e9viations et pricing d'options sur indices,\nComptes Rendus Mathematique Volume 336, Issue 3, 1 February 2003, Pages 263266\n[2] Gallot, S., Hulin, D., and Ladontaine, J.:Riemannian geometry, Springer, 1987.\n[3] Gilkey, P.:Invariance theory, the Heat equation, and the Atiyah Singer Index Theorem., Studies in advanced mathematics, CRC press, 1995.\n[4] Jost, Li-Jost, X.:Calculus of Variations, Cambridge University Press, 1998.\n[5] Kampen, J.:The WKB-Expansion of the fundamental solution of linear parabolic\nequations and its applications.(SSRN ,2006)\n[6] Kampen, J.:Regular polynomial interpolation and linear systems of partial differential equations (arXiv:0807.1497)(extended version with numerical examples in\npreparation)\n[7] Kampen, J.; Kolodko, A.; Schoenmakers, J.: Monte Carlo Greeks for Financial\nProducts via Approximative Transition Densities, Siam J. Sc. Comp., vol. 31 , p.\n1-22, 2008.\n[8] Varadhan, S.R.S. Diffusion processes in small time intervall, Communications in\npure and applied mathematics, 20, 659-685, 1967\n*sponsored by DFG (Matheon)\n\n22\n\n\f"}