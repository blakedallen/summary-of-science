{"id": "http://arxiv.org/abs/1109.3458v3", "guidislink": true, "updated": "2011-12-01T11:44:38Z", "updated_parsed": [2011, 12, 1, 11, 44, 38, 3, 335, 0], "published": "2011-09-15T20:00:05Z", "published_parsed": [2011, 9, 15, 20, 0, 5, 3, 258, 0], "title": "Modelling large-scale halo bias using the bispectrum", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.3968%2C1109.3897%2C1109.0073%2C1109.1209%2C1109.1948%2C1109.5306%2C1109.2141%2C1109.5950%2C1109.1998%2C1109.3182%2C1109.6036%2C1109.4806%2C1109.4732%2C1109.6407%2C1109.3419%2C1109.5436%2C1109.5453%2C1109.1964%2C1109.6888%2C1109.3743%2C1109.4235%2C1109.1523%2C1109.2291%2C1109.2468%2C1109.0385%2C1109.1109%2C1109.4721%2C1109.1252%2C1109.2914%2C1109.3198%2C1109.2412%2C1109.0712%2C1109.6364%2C1109.2259%2C1109.4432%2C1109.5710%2C1109.5167%2C1109.6085%2C1109.0138%2C1109.3088%2C1109.3077%2C1109.2935%2C1109.4255%2C1109.2470%2C1109.3458%2C1109.0544%2C1109.1239%2C1109.1145%2C1109.1396%2C1109.3257%2C1109.5288%2C1109.6045%2C1109.3110%2C1109.1489%2C1109.4891%2C1109.2617%2C1109.1136%2C1109.4719%2C1109.3297%2C1109.4554%2C1109.1009%2C1109.2685%2C1109.6541%2C1109.6285%2C1109.1181%2C1109.3033%2C1109.3454%2C1109.0212%2C1109.6341%2C1109.1286%2C1109.0126%2C1109.5226%2C1109.5874%2C1109.2253%2C1109.1346%2C1109.6361%2C1109.1190%2C1109.5574%2C1109.5250%2C1109.2385%2C1109.2551%2C1109.1005%2C1109.2045%2C1109.2055%2C1109.0103%2C1109.4630%2C1109.5991%2C1109.5760%2C1109.4557%2C1109.0532%2C1109.3201%2C1109.2920%2C1109.2726%2C1109.6605%2C1109.2114%2C1109.4114%2C1109.3514%2C1109.0205%2C1109.2943%2C1109.2355%2C1109.4683&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Modelling large-scale halo bias using the bispectrum"}, "summary": "We study the relation between the halo and matter density fields -- commonly\ntermed bias -- in the LCDM framework. In particular, we examine the local model\nof biasing at quadratic order in the matter density. This model is\ncharacterized by parameters b_1 and b_2. Using an ensemble of N-body\nsimulations, we apply several statistical methods to estimate the parameters.\nWe measure halo and matter fluctuations smoothed on various scales and find\nthat the parameters vary with smoothing scale. We argue that, for real-space\nmeasurements, owing to the mixing of wavemodes, no scale can be found for which\nthe parameters are independent of smoothing. However, this is not the case in\nFourier space. We measure halo power spectra and construct estimates for an\neffective large-scale bias. We measure the configuration dependence of the halo\nbispectra B_hhh and reduced bispectra Q_hhh for very large-scale k-space\ntriangles. From this we constrain b_1 and b_2. Using the lowest-order\nperturbation theory, we find that for B_hhh the best-fit parameters are in\nreasonable agreement with one another as the triangle scale is varied, but that\nthe fits become poor as smaller scales are included. The same is true for\nQ_hhh. The best-fit parameters depend on the discreteness correction. This led\nus to consider halo-mass cross-bispectra. The results from these statistics\nsupport our earlier findings. We develop a test to explore the importance of\nmissing higher-order terms in the models. We prove that low-order expansions\nare not able to correctly model the data, even on scales k_1~0.04 h/Mpc. If\nrobust inferences are to be drawn from galaxy surveys, then accurate models for\nthe full nonlinear matter bispectrum and trispectrum will be essential.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1109.3968%2C1109.3897%2C1109.0073%2C1109.1209%2C1109.1948%2C1109.5306%2C1109.2141%2C1109.5950%2C1109.1998%2C1109.3182%2C1109.6036%2C1109.4806%2C1109.4732%2C1109.6407%2C1109.3419%2C1109.5436%2C1109.5453%2C1109.1964%2C1109.6888%2C1109.3743%2C1109.4235%2C1109.1523%2C1109.2291%2C1109.2468%2C1109.0385%2C1109.1109%2C1109.4721%2C1109.1252%2C1109.2914%2C1109.3198%2C1109.2412%2C1109.0712%2C1109.6364%2C1109.2259%2C1109.4432%2C1109.5710%2C1109.5167%2C1109.6085%2C1109.0138%2C1109.3088%2C1109.3077%2C1109.2935%2C1109.4255%2C1109.2470%2C1109.3458%2C1109.0544%2C1109.1239%2C1109.1145%2C1109.1396%2C1109.3257%2C1109.5288%2C1109.6045%2C1109.3110%2C1109.1489%2C1109.4891%2C1109.2617%2C1109.1136%2C1109.4719%2C1109.3297%2C1109.4554%2C1109.1009%2C1109.2685%2C1109.6541%2C1109.6285%2C1109.1181%2C1109.3033%2C1109.3454%2C1109.0212%2C1109.6341%2C1109.1286%2C1109.0126%2C1109.5226%2C1109.5874%2C1109.2253%2C1109.1346%2C1109.6361%2C1109.1190%2C1109.5574%2C1109.5250%2C1109.2385%2C1109.2551%2C1109.1005%2C1109.2045%2C1109.2055%2C1109.0103%2C1109.4630%2C1109.5991%2C1109.5760%2C1109.4557%2C1109.0532%2C1109.3201%2C1109.2920%2C1109.2726%2C1109.6605%2C1109.2114%2C1109.4114%2C1109.3514%2C1109.0205%2C1109.2943%2C1109.2355%2C1109.4683&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We study the relation between the halo and matter density fields -- commonly\ntermed bias -- in the LCDM framework. In particular, we examine the local model\nof biasing at quadratic order in the matter density. This model is\ncharacterized by parameters b_1 and b_2. Using an ensemble of N-body\nsimulations, we apply several statistical methods to estimate the parameters.\nWe measure halo and matter fluctuations smoothed on various scales and find\nthat the parameters vary with smoothing scale. We argue that, for real-space\nmeasurements, owing to the mixing of wavemodes, no scale can be found for which\nthe parameters are independent of smoothing. However, this is not the case in\nFourier space. We measure halo power spectra and construct estimates for an\neffective large-scale bias. We measure the configuration dependence of the halo\nbispectra B_hhh and reduced bispectra Q_hhh for very large-scale k-space\ntriangles. From this we constrain b_1 and b_2. Using the lowest-order\nperturbation theory, we find that for B_hhh the best-fit parameters are in\nreasonable agreement with one another as the triangle scale is varied, but that\nthe fits become poor as smaller scales are included. The same is true for\nQ_hhh. The best-fit parameters depend on the discreteness correction. This led\nus to consider halo-mass cross-bispectra. The results from these statistics\nsupport our earlier findings. We develop a test to explore the importance of\nmissing higher-order terms in the models. We prove that low-order expansions\nare not able to correctly model the data, even on scales k_1~0.04 h/Mpc. If\nrobust inferences are to be drawn from galaxy surveys, then accurate models for\nthe full nonlinear matter bispectrum and trispectrum will be essential."}, "authors": ["Jennifer E. Pollack", "Robert E. Smith", "Cristiano Porciani"], "author_detail": {"name": "Cristiano Porciani"}, "author": "Cristiano Porciani", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1111/j.1365-2966.2011.20279.x", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1109.3458v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1109.3458v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "23 pages, 7 figures; accepted for publication in MNRAS", "arxiv_primary_category": {"term": "astro-ph.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1109.3458v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1109.3458v3", "journal_reference": null, "doi": "10.1111/j.1365-2966.2011.20279.x", "fulltext": "Mon. Not. R. Astron. Soc. 000, 000\u2013000 (0000)\n\nPrinted 3 October 2018\n\n(MN LATEX style file v2.2)\n\nModelling large-scale halo bias using the bispectrum\nJennifer\nE. Pollack1\u22c6, Robert E. Smith2,1\u2020, & Cristiano Porciani1\u2021\n1\nArgelander Institut f\u00fcr Astronomie der Universit\u00e4t Bonn, Auf dem H\u00fcgel 71, D-53121 Bonn, Germany\nfor Theoretical Physics, University of Zurich, Zurich, CH 8037\n\narXiv:1109.3458v3 [astro-ph.CO] 1 Dec 2011\n\n2 Institute\n\n3 October 2018\n\nABSTRACT\n\nWe study the relation between the density distribution of tracers for large-scale structure and the underlying matter distribution \u2013 commonly termed bias \u2013 in the \u039bCDM\nframework. In particular, we examine the validity of the local model of biasing at\nquadratic order in the matter density. This model is characterized by parameters b1\nand b2 . Using an ensemble of N -body simulations, we apply several statistical methods to estimate the parameters. We measure halo and matter fluctuations smoothed\non various scales. We find that, whilst the fits are reasonably good, the parameters\nvary with smoothing scale. We argue that, for real-space measurements, owing to the\nmixing of wavemodes, no smoothing scale can be found for which the parameters are\nindependent of smoothing. However, this is not the case in Fourier space. We measure\nhalo and halo-mass power spectra and from these construct estimates of the effective\nlarge-scale bias as a guide for b1 . We measure the configuration dependence of the halo\nbispectra Bhhh and reduced bispectra Qhhh for very large-scale k-space triangles. From\nthis data we constrain b1 and b2 , taking into account the full bispectrum covariance\nmatrix. Using the lowest-order perturbation theory, we find that for Bhhh the best-fit\nparameters are in reasonable agreement with one another as the triangle scale is varied; although, the fits become poor as smaller scales are included. The same is true for\nQhhh . The best-fit values were found to depend on the discreteness correction. This led\nus to consider halo-mass cross-bispectra. The results from these statistics supported\nour earlier findings. We then developed a test to explore whether the inconsistency in\nthe recovered bias parameters could be attributed to missing higher-order corrections\nin the models. We prove that low-order expansions are not sufficiently accurate to\nmodel the data, even on scales k1 \u223c 0.04 h Mpc\u22121 . If robust inferences concerning\nbias are to be drawn from future galaxy surveys, then accurate models for the full\nnonlinear bispectrum and trispectrum will be essential.\nKey words: cosmology: theory, large-scale structure\n\n1\n\nINTRODUCTION\n\nThe accurate estimation and modelling of higher-order\nclustering statistics in current and future galaxy redshift\nsurveys has the potential to act as a powerful probe\nfor cosmological physics. The higher-order connected moments, beginning at lowest order with the three-point\ncorrelation function and its Fourier analogue, the bispectrum, when interpreted within the gravitational instability paradigm, encode important information regarding\nthe growth of large-scale structure (Matarrese et al. 1997;\nScoccimarro et al. 1998). Their measurements also provide\ninsight into the statistical nature of the primordial fluc-\n\n\u22c6\n\nE-mail: jpollack@astro.uni-bonn.de\n\u2020 res@physik.unizh.ch\n\u2021 porciani@astro.uni-bonn.de\nc 0000 RAS\n\ntuations (Fry & Scherrer 1994; Sefusatti & Komatsu 2007;\nNishimichi et al. 2010; Baldauf et al. 2011) and the cosmological parameters (Sefusatti et al. 2006). Another attribute\nof three-point statistics, and the focus of our study, is their\ncapability to probe the manner in which an observable\ntracer population of objects, such as galaxies, is related to\nthe unobservable matter distribution \u2013 termed the 'bias'\n(Kaiser 1984; Dekel & Rees 1987; Fry & Gaztanaga 1993;\nDekel & Lahav 1999; Catelan et al. 2000).\nIf the primordial fluctuations were Gaussian, as appears\nto be the case (Komatsu et al. 2010), then the statistical\nproperties of the initial fields are fully characterized by the\npower spectrum, with all higher-order connected correlators\nvanishing. However, gravitational instability leads to the\ncoupling of Fourier modes and this generates a hierarchy\nof non-vanishing connected correlators, each of which has\na precise characteristic mathematical structure. The matter\n\n\f2\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nbispectrum is thus an inherently nonlinear quantity, whose\nsignal depends on closed triangles in Fourier space. In theory, this should vanish at early times and on scales large\nenough where linear theory is valid. If galaxy bias is local\nand linear, then the bispectrum of the observable tracers\nis proportional to the matter bispectrum. If on the other\nhand, bias is local and nonlinear then the triangle configuration dependence of the signal is modified, and this happens\nin a very precise and calculable way. Thus the bispectrum\ncan be used to constrain the bias (Fry & Gaztanaga 1993;\nMatarrese et al. 1997; Scoccimarro et al. 1999).\nThere is a long and rich history of measurements of\nthree-point statistics from galaxy surveys, going all the\nway back to Peebles & Groth (1975). However, attempts\nto constrain the nonlinearity of galaxy bias from galaxy\nredshift surveys have only been performed over the last\ndecade. Feldman et al. (2001) and Scoccimarro et al. (2001)\nboth analyzed the IRAS survey using the bispectrum, and\nfound a negative quadratic bias; although, due to small\nsample size the constraints were rather weak. Verde et al.\n(2002) analyzed the 2dFGRS survey, also using the bispectrum approach, and claimed that the flux-limited sample\nwas an unbiased tracer of the dark matter. A subsequent\nanalysis of the final 2dFGRS data set by Gazta\u00f1aga et al.\n(2005), using the 3-point correlation function, contradicted\nthis: using information from weakly non-linear scales (R \u223c\n6 \u2212 27 h\u22121 Mpc) the unbiased case (b1 = 1 and b2 = 0)\nwas excluded at the order of 9\u03c3. More recently a number of authors have analyzed various data releases of the\nSDSS (Nishimichi et al. 2007 \u2013 DR3, McBride et al. 2011\n\u2013 DR6 and Marin 2010 \u2013 DR7). These all claim a nonzero quadratic bias term for most of the samples within the\ndataset. Obviously, these variations of the results with survey and statistical method require an explanation.\nWhilst the local bias model can be used to test whether\nthe bias is linear or nonlinear, a significant detection of nonzero nonlinear bias does not imply that we have understood\nthe bias. In order to believe that these measurements are\nmeaningful, we need to be sure that the local model is indeed\nthe correct model for interpreting data. This is currently an\nopen question. Attempting to shed light on this subject is\none of the aims of this paper. Over the past few years, the\nlocal model of galaxy bias has been scrutinized by a number\nof authors (Heavens et al. 1998; Gazta\u00f1aga & Scoccimarro\n2005; Smith et al. 2007; Guo & Jing 2009; Manera et al.\n2010; Roth & Porciani 2011; Manera & Gazta\u00f1aga 2011).\nHowever, no firm conclusions have yet been reached.\nIn this paper, we use a large ensemble of 40 midresolution, large volume, pure dark matter N -body simulations, to test the validity of the local bias model. In this\nstudy we compare a selection of different methods for determining the bias. We first present a point-wise comparison\nof the halo and matter density fields smoothed on certain\nscales. We also utilize the power spectrum to estimate a\nlarge-scale effective bias parameter. Then we expend most\nof our efforts on using the bispectrum and reduced bispectrum approach for constraining the bias. Besides the autobispectra, we also present, for the first time, measurements\nof the halo-matter cross-bispectra: Bhhm and Bhmm , and\nQhhm and Qhmm . The value of these new statistics becomes\napparent when correcting for shot-noise effects. Finally, we\nperform a numerical test that allows us to sharply illumi-\n\nnate the importance of terms in the theory that are beyond\nthe tree-level expansions typically used.\nThe paper is divided up as follows: in \u00a72 we present the\ntheory for the matter bispectrum and the local bias model.\nIn \u00a73, we provide details of the numerical simulations used\nin this work. In \u00a74, we present the results for the bias parameters from the various commonly used simple estimators.\nIn \u00a75 we present the estimation of the bias from the bispectrum. Then, in \u00a76 we present measurements of bias from the\ncross-bispectra. In \u00a77 we present a test of the importance of\nterms in the theory that are beyond tree level. Finally in \u00a78\nand \u00a79 we discuss our findings and present our conclusions.\n\n2\n2.1\n\nTHEORETICAL OVERVIEW\nStandard perturbation theory dynamics\n\nIn the fluid approximation, the gravitational collapse of collisionless cold matter structures in the expanding Universe,\ncan be fully characterized by specifying the evolution of the\ndensity \u03b4\u03c1(x) and the peculiar velocity \u03b4v(x) perturbations\n(Bernardeau et al. 2002). Focusing primarily on the density\nfield, we work with models of the matter density contrast:\n\u03b4(x, t) \u2261\n\n\u03c1(x, t) \u2212 \u03c1(t)\n,\n\u03c1(t)\n\n(1)\n\nwhere \u03c1\u0304(t) is the mean matter density of the Universe. In\nFourier space, we define its corresponding Fourier representation, \u03b4(k), accordingly, as\nZ\nZ\nd3 k\n\u2212ik*x\n\u03b4(x) =\n\u03b4(k)e\n\u21d4\n\u03b4(k)\n=\nd3x \u03b4(x)eik*x .(2)\n(2\u03c0)3\n\nIt can be shown that the nonlinear equations of motion\nfor \u03b4(k) can be solved exactly by perturbative expansions\nof the type (Juszkiewicz 1981; Vishniac 1983; Goroff et al.\n1986):\n\u03b4(k) =\n\n\u221e\nX\n\nan (t)\u03b4n (k) ,\n\n(3)\n\nn=1\n\nand, where \u03b4n (k) is given by,\nZ 3\nZ 3\nd q1\nd qn\n\u03b4n (k) =\n.\n.\n.\n(2\u03c0)3 \u03b4 D (k \u2212 q1 \u2212 * * * \u2212 qn )\n(2\u03c0)3\n(2\u03c0)3\n\u00d7Fn (q1 , . . . , qn )\u03b41 (q1 ) * * * \u03b41 (qn ) .\n(4)\nThe density kernel Fn is the dimensionless, homogeneous, mode coupling function that couples together the\namplitudes and phases of n initial Fourier wavemodes\n{\u03b4(q1 ), . . . , \u03b4(qn )}. As was shown by (Goroff et al. 1986;\nMakino et al. 1992; Jain & Bertschinger 1994), the nth\norder kernel may be constructed recursively from the\nlower-order solutions. Linear theory is thus represented by\nF1 (q1 ) = 1, and the first nonlinear correction by F2 , where\n\u0012\n\u0013\n5\n2 (k1 * k2 )2\nk2\nk 1 * k 2 k1\nF2 (k1 , k2 ) =\n+\n+\n+\n. (5)\n7\nk1 k2\nk2\nk1\n7 k12 k22\nThe above approach defines the standard perturbation theory (hereafter SPT). Before moving on, we note that the\nabove statements are only exactly true for the Einsteinde Sitter model. However, it has been shown that the\nF2 kernel is almost independent of cosmology (Fry 1994;\nBouchet et al. 1995; Hivon et al. 1995). We therefore adopt\nEq. (5) when dealing with the density at second order.\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n2.2\n\nFrom dynamics to statistics\n\nOwing to the stochastic nature of the density field, we are\nnot interested in reproducing a specific density field per se,\nbut instead in characterizing its statistical properties. In this\nwork we focus on 2- and 3-point correlation functions in\nFourier space. These we may write as:\nh \u03b4(k1 )\u03b4(k2 ) i \u2261 (2\u03c0)3 \u03b4 D (k12 )Pmm (k1 ) ;\n3\n\n(6)\n\nD\n\nh \u03b4(k1 )\u03b4(k2 )\u03b4(k3 ) i \u2261 (2\u03c0) \u03b4 (k123 )Bmmm (k1 , k2 , k3 ), (7)\nwhere Pmm (k) and Bmmm (k1 , k2 , k3 ) constitute definitions\nof the power and bispectrum. For the Dirac delta functions\nwe used the short-hand notation \u03b4 D (k1...n ) \u2261 \u03b4 D (k1 + . . . +\nkn ) and these guarantee that P and B are translationally invariant. This is an important property for estimation, since\nit means that we shouldP\nconsider only closed pairs and triangles in Fourier space:\nki = 0.\nThe perturbative expansion of the density field described in the previous section implies that Pmm and Bmmm\nmay also be described in a perturbative fashion. Hence,\nh\u03b4(k1 )\u03b4(k2 )i\n\n=\n\nh\u03b4(k1 ) . . . \u03b4(k3 )i\n\n=\n\nh[\u03b41 (k1 ) + \u03b42 (k1 ) + . . .]\n\u00d7 [\u03b41 (k2 ) + \u03b42 (k2 ) + . . .]i ;\n\n(8)\n\nh[\u03b41 (k1 ) + \u03b42 (k1 ) + . . .] . . .\n\u00d7 [\u03b41 (k3 ) + \u03b42 (k3 ) + . . .]i .\n\n(9)\n\nSince we are assuming that the initial Fourier modes are\nGaussianly distributed, i.e. the phase of each initial mode\nis uniformly random \u03c6 \u2208 [0, 2\u03c0], modes must cancel in\npairs. Hence, Wick's theorem applies, and so odd products of initial Fourier modes must vanish: h\u03b41 (k1 )\u03b42 (k2 )i =\nh\u03b41 (k1 )\u03b41 (k2 )\u03b41 (k3 )i = 0 . This leads us to write the perturbative expansions for Pmm and Bmmm as:\nPmm (k)\n\n=\n\n(0)\n(1)\nPmm\n(k) + Pmm\n(k) + . . . ;\n\nBmmm (k1 , k2 )\n\n=\n\n(0)\n(1)\nBmmm\n(k1 , k2 ) + Bmmm\n(k1 , k2 ) + . . .\n\nWe shall refer to the lowest order terms in the expansions as\n'tree-level' terms. For P , P (0) is simply the linear spectrum,\nwhile for B the tree-level term can be written:\n(0)\nBmmm\n(k1 , k2 )\n\n=\n\n(0)\n(0)\n2 Pmm\n(k1 ) Pmm\n(k2 ) F2 (k1 , k2 ) + 2\n\ncyc .(12)\n\nIn this work we shall mainly be dealing with tree-level quan(0)\n(0)\ntities; we now set: Pmm = Pmm and Bmmm = Bmmm , unless\notherwise stated.\nAnother statistical quantity commonly used to\nexplore galaxy clustering is the reduced bispectrum\n(Peebles & Groth 1975; Scoccimarro et al. 1998), which can\nbe defined:\nBmmm (k1 , k2 , k3 )\nQmmm (k1 , k2 , k3 ) \u2261\n.\nPmm (k1 )Pmm (k2 ) + 2 cyc\n\nonly formed in dark matter haloes, as is the usual assumption for all models of galaxy formation (White & Rees 1978),\nthen understanding the clustering of haloes is an essential\ncomponent of any theory of galaxy biasing (Smith et al.\n2007). In the local model of halo biasing, the number density of dark matter haloes of mass scale M , smoothed over\na scale R, can be expressed as a function of the local matter\ndensity, smoothed on the scale R. This function may then\nbe Taylor expanded to give (Fry & Gaztanaga 1993; Coles\n1993; Mo et al. 1997; Smith et al. 2007):\n\u03b4h (x|M, R) =\n\n(13)\n\nAs will be made clear below, the importance of this statistic\nbecomes apparent when one considers non-Gaussian terms\nthat are generated by simple quadratic products of Gaussian\nfields. In this case Qmmm simply scales as a constant.\n\n\u221e\nX\nbj (M )\n[\u03b4(x|R)]j ,\nj!\nj=0\n\n\u03b4h (k|M, R)\n\n=\n\nb1 (M )\u03b4(k|R)\nZ 3\nd q1\n\u03b4(q1 |R)\u03b4(k \u2212 q1 |R) + . . . ,(15)\n(2\u03c0)3\n\nb2 (M )\n+\n2\n\nwhere \u03b4i (qj |R) \u2261 W (|qj |R)\u03b4i (qj ). If one inserts the SPT\nexpansions for the density into the local model, then, up to\nsecond order in the density and bias, one finds:\n\u03b4 h (k|M, R)\n\n=\n\nb1 (M ) [\u03b41 (k|R) + \u03b42 (k|R)]\nZ 3\nb2 (M )\nd q1\n\u03b41 (q1 |R)\u03b41 (k \u2212 q1 |R) . (16)\n+\n2\n(2\u03c0)3\n\nUsing this approach one may then find a perturbative expansion for the halo power and bispectra:\n(0)\n\nBhhh (M ) =\n\n(0)\nBhhh (M )\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n+\n\n(1)\nBhhh (M )\n\n(17)\n\n+ ... .\n\n(18)\n\nAgain, we refer to the lowest order terms in these expansions\nas tree-level terms, and for these we have:\ne (0) (k|M )\nP\nhh\n\n(0)\nBehhh (k1 , k2 |M )\n\n=\n=\n\nemm (k) ;\nb21 (M )P\n(19)\n3\n2\ne\nb1 (M )Bmmm (k1 , k2 ) + b1 (M )b2 (M )\nh\ni\nemm (k1 )P\nemm (k2 ) + 2 cyc , (20)\n\u00d7 P\n\nwhere in the above expressions we have derived the spece \u2261 W 2 (kR)P (k), and Be \u2261\ntra of the smoothed fields: P\nW (k1 R)W (k2 R)W (k3 R)B. However, when we estimate the\nbispectrum from data we do not smooth the fields apart\nfrom the CIC assignment scheme used to obtain the density\ncontrast field. As pointed out by Smith et al. (2007, 2008)\nand Sefusatti (2009), one way to overcome this is to adopt\nthe ansatz:\nPhh (k|M )\n\n=\n\nBhhh (k1 , k2 , k3 |M )\n\n=\n\nHalo Bias: Local Form\n\nIn this study we investigate the relation between the clustering of dark matter haloes and total matter. If galaxies are\n\n(1)\n\nPhh (M ) = Phh (M ) + Phh (M ) + . . .\n\n(0)\n\n2.3\n\n(14)\n\nwhere we defined the smoothed halo over-density to be,\n\u03b4h (x|M, R) \u2261 [nh (x|M, R) \u2212 nh (M )]/nh (M ). Owing to the\nfact\nP that h \u03b4h i j= 0, the constant coefficient b0 (M ) =\n\u2212 \u221e\nj=2 bj (M ) h \u03b4 i /j! (Fry & Gaztanaga 1993). Note that\non Fourier transforming \u03b4h (x|M, R) the constant b0 only\ncontributes to the unmeasurable k = 0 mode. The terms\nb1 (M ) and b2 (M ) represent the linear and first nonlinear\nbias parameters, respectively.\nIn Fourier space, Eq. (14) can be written as:\n\n(10)\n(11)\n\n3\n\n(0)\n\ne (0) (k|M, R)\nP\nhh\n;\nW 2 (kR)\n(0)\nBe (k1 , k2 , k3 |M, R)\nhhh\n\nW (k1 R)W (k2 R)W (k3 R)\n\n(21)\n.\n\n(22)\n\n\f4\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nOn applying this 'de-smoothing' operation to Eqs (19)\nand (20), one finds:\n(0)\n\nPhh (k|M )\n(0)\nBhhh (k1 , k2 |M )\n\n=\n\nb21 (M )Pmm (k) ;\n\n=\n\nb31 (M )Bmmm (k1 , k2 )\n\n(23)\nb21 (M ) b2 (M )\n\n+\nf\n\u00d7Wk1 ,k2 Pmm (k1 )Pmm (k2 ) + 2 cyc .\n\n(24)\n\nwhere we have defined the function (Sefusatti 2009):\nfk ,k \u2261 W (|k1 |R)W (|k2 |R) .\nW\n1 2\nW (|k1 + k2 |R)\n\n(25)\n\nNote that in the limit of very large scales or arbitrarily small\nsmoothing scales, ki R \u2192 0 for i \u2208 {1, 2, 3}, Eq. (24) approximates to:\n(0)\n\nBhhh (k1 , k2 |M )\n\n\u2248\n\nb31 (M )Bmmm (k1 , k2 ) + b21 (M ) b2 (M )\n\u00d7 [Pmm (k1 )Pmm (k2 ) + 2 cyc ] .\n\n(26)\n\nAgain, since in this paper we are only considering tree-level\n(0)\n(0)\nexpressions we shall take Phh \u2192 Phh and Bhhh \u2192 Bhhh .\nConsidering now the reduced halo bispectrum, it may\nbe defined in a similar fashion to Eq. (13):\nQhhh (k1 , k2 , k3 |M ) \u2261\n\nBhhh (k1 , k2 |M )\n. (27)\nPhh (k1 |M )Phh (k2 |M ) + 2 cyc\n\nOn inserting our tree-level expressions from Eqs (23)\nand (24), we find that\nQhhh (M ) =\n\nb2 (M )\nQmmm\n+ 2\n\u03b1(k1 , k2 , k3 ) ,\nb1 (M )\nb1 (M )\n\n(28)\n\nwhere we have defined,\n\u03b1(k1 , k2 , k3 ) \u2261\n\nfk ,k P (k1 )P (k2 ) + 2 cyc\nW\n1 2\n.\nP (k1 )P (k2 ) + 2 cyc\n\nQmmm (k1 , k2 , k3 )\nb2 (M )\n+ 2\n.\nb1 (M )\nb1 (M )\n\nSIMPLE ESTIMATES OF BIAS\n\nBefore we examine halo bias in the context of the bispectrum, we explore two alternative methods for studying the\nbias. We first evaluate the second-order local biasing model\ndirectly, by comparing in a point-wise fashion the halo and\nmatter density fields, smoothed over a range of scales. Then,\nwe use power spectra to determine an effective large-scale\nbias.\n4.1\n\n(30)\n\nWe now see the utility of the reduced bispectrum: if one constructs halo/galaxy density fields from a local transformations of the matter density, then the lowest order nonlinear\ncorrections will lead to a function that is a scaled version of\nthe matter Qmmm , plus a constant offset. Moreover, if the\ndensity field were simply Gaussian, then estimates of Qhhh\non large scales would directly measure b2 /b21 .\n\n3\n\n4\n\n(29)\n\nAgain, in the limit of very large scales or arbitrarily small\nsmoothing scales and \u03b1(k1 , k2 , k3 ) \u2192 1, the above expression approximates to:\nQhhh (k1 , k2 , k3 |M ) \u2248\n\n\u03a9m = 0.25, vacuum density \u03a9\u039b = 0.75, power spectrum normalization \u03c38 = 0.8, power spectral index n = 1, and dimensionless Hubble parameter h = 0.7. The transfer function\nfor the simulations was generated using the publicly available cmbfast code (Seljak & Zaldarriaga 1996; Seljak et al.\n2003), with high sampling of the spatial frequencies on large\nscales. Initial conditions were set at redshift z = 49 using the serial version of the publicly available 2LPT code\n(Scoccimarro 1998; Crocce et al. 2006).\nDark matter halo catalogues were generated for each\nsimulation using the Friends-of-Friends (FoF) algorithm\n(Davis et al. 1985), with the linking-length parameter b =\n0.2, where b is the fraction of the inter-particle spacing. For\nthis we employed the fast parallel B-FoF code, provided to\nus by V. Springel. The minimum number of particles for\nwhich an object is considered to be a bound halo was set\nat 20 particles. This gave a minimum host halo mass of\nMmin = 1.11 \u00d7 1013 h\u22121 M\u2299 . For our analysis of the bias,\nwe use the full sample of haloes and this corresponded to\nroughly N h \u2248 1.26 \u00d7 106 haloes per simulation. Further details of the simulations may be found in Smith (2009).\n\nN -BODY SIMULATIONS\n\nFor our investigations of the bias, we use an ensemble of\n40 large N -body simulations, executed on the zBOX-2 and\nzBOX-3 supercomputers at the University of Z\u00fcrich. We use\nonly the z = 0 outputs from the simulations. Each simulation was performed using the publicly available Gadget-2\ncode (Springel 2005), and followed the nonlinear evolution\nunder gravity of N = 7503 equal-mass particles in a comoving cube of length Lsim = 1500 h\u22121 Mpc.\nThe cosmological model that we simulated was analogous to the basic vanilla \u039bCDM model determined by the\nWMAP experiment (Komatsu et al. 2009): matter density\n\nAnalyzing Density Fields\n\nOne obvious way to examine the local model of biasing is\nto simply construct a scatter plot of the local density of\ndark matter haloes against the local density of dark matter\nin the simulations (see for example Sheth & Lemson 1999;\nDekel & Lahav 1999). As was discussed in \u00a72.3, this model\nonly makes sense in the context of smooth fields. We shall\ntherefore also inspect how the model parameters depend on\nthe adopted smoothing scale R.\nWe generate the smoothed density fields as follows: we\nassign particles/haloes to a Fourier grid using the CIC algorithm (c.f. \u00a75.1); then we Fourier transform the grid using\nthe FFT algorithm; each Fourier mode is then multiplied by\na Gaussian filter of the form:\n\u0002\n\u0003\nW (kR) \u2261 exp \u2212(kR)2 /2 .\n(31)\n\nFinally, on taking the inverse Fourier transform, we obtain\nthe smoothed \u03b4(x|R) and \u03b4 h (x|R). We perform the above\nprocedure for 28 of the ensemble of simulations and consider\nthe filter scales: R = {50 , 20 , 10} h\u22121 Mpc.\nIn Figure 1 we present the bin averaged scatter plots\nof \u03b4 h (x|R) vs. \u03b4(x|R), averaged over the realizations. The\ncolour contours are shaded by the normalized population\ndensity of that pixel, e.g. the central red region indicates that\nmost of the points in the simulation are regions of density\nclose to average. We also see that as the smoothing scale is\ndecreased (panels going from left-to-right), that the scatter\nincreases and that there are more points that have higher\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n\n5\n\nFigure 1. Scatter plots of \u03b4h (x) versus \u03b4(x) smoothed with a Gaussian filter of various scales averaged over the realizations. From left\nto right, the panels correspond to the smoothing scales R = {50, 20, 10} h\u22121 Mpc. The color coding denotes the log of the population\ndensity, i.e. the red region corresponds to the largest concentration of points and the white background to null values. The dot-dashed\nline in each panel denotes the local halo bias model up to second-order with the best-fitting bias parameters averaged over 28 realizations.\n\nb0 \u00b1 \u03c3b0\n\u00d710\u22123\n\nb1 \u00b1 \u03c3b1\n\nb2 \u00b1 \u03c3b2\n\n[ h\u22121 Mpc]\n50\n20\n10\n\n1.3 \u00b1 0.1\n12.0 \u00b1 0.1\n37.2 \u00b1 0.1\n\n1.497 \u00b1 0.002\n1.542 \u00b1 0.006\n1.644 \u00b1 0.005\n\n-0.577 \u00b1 0.031\n-0.635 \u00b1 0.004\n-0.512 \u00b1 0.001\n\nR\n\nTable 1. Average of the mean bias parameters and the root-mean\nsquare errors for the local halo bias model up to second-order\naveraged over 28 realizations determined from fitting the scatter\nplots of the halo and matter density fields smoothed on scales\nks = {0.02, 0.05, 0.1} h Mpc\u22121 .\n\nand lower density. Conversely, as the filter scale is increased\nthe relation becomes tighter and more linear. One obvious\nconclusion that may be drawn from this behaviour is that\nthe bias relation is certainly not deterministic.\nIn order to obtain a more quantitative understanding,\nwe next consider fitting for the parameters of the local bias\nmodel at second-order. From Eq. (14) we have:\n\u03b4h (x|M, R) = b0 (M ) + b1 (M ) \u03b4(x|R) +\n\nb2 (M )\n[\u03b4(x|R)]2 .(32)\n2\n\nWe perform a least-squares analysis on each realization, and\nthen average over the resulting set of bias parameters to obtain the mean parameters: b0 (M ), b1 (M ), and b2 (M ). The\n1\u03c3-errors are then estimated in the usual way, as quadratic\ndeviations from the sample mean. In Fig. 1 we plot the resultant best-fit local model as the dot-dashed line in each of\nthe three panels.\nThe information on the parameters is summarized in\nTable 1 as a function of the filter scale R. This clearly\nshows that the estimates of b1 increase as the smoothing scale is decreased, whereas those for b2 appear to be\nparabolical. Naively, one might expect that the nonlinear\nbias terms should approach zero as the amount of smoothing is increased and nonlinearities are washed out, however,\nat R = 50 h\u22121 Mpc even with \u03c3(x|R) < 1, the fluctuations\nc 0000 RAS, MNRAS 000, 000\u2013000\n\nare still significant enough to yield a non-zero b2 . Note also\nthat in all cases b0 6= 0.\nThe local model, as written in Eq. (14), asserts that the\nparameters bi are independent of the smoothing scale R, and\nwe, therefore, consider the implications as follows. Suppose\nthat nonlinear bias is exactly as described by Eq. (32), but\nthat the coefficients are not independent of the smoothing\nscale. Let us now consider the results that would be obtained\nfrom measurements for two smoothing scales Ra and Rb .\nFrom Eq. (32) we would have:\n\u03b4h (x|Ra )\n\n=\n\n\u03b4h (x|Rb )\n\n=\n\nba2\n[\u03b4(x|Ra )]2 ;\n2\nbb\nbb0 + bb1 \u03b4(x|Rb ) + 2 [\u03b4(x|Rb )]2 .\n2\nba0 + ba1 \u03b4(x|Ra ) +\n\n(33)\n(34)\n\nSupposing now that we desmoothed each of the fields, by\nFourier transforming and dividing out the appropriate window function. We would then have:\nZ\nd3 q\nba\nfq,k\u2212q (Ra )\n\u03b4(q)\u03b4(|k \u2212 q|)W\n\u03b4h (k) = ba1 \u03b4(k) + 2\n2\n(2\u03c0)3\nZ\nbb\nd3 q\nfq,k\u2212q (Rb ) .\n\u03b4h (k) = bb1 \u03b4(k) + 2\n\u03b4(q)\u03b4(|k \u2212 q|)W\n2\n(2\u03c0)3\nIn order for the above equations to be equivalent, then we\nmust have\nba1\nba2\n\n=\n\nbb1\n\n=\n\nbb2\n\n\u0014\n\nW (qRb ) W (|k \u2212 q|Ra ) W (kRa )\nW (qRa ) W (|k \u2212 q|Rb ) W (kRb )\n\n\u0015\n\n(35)\n.\n\n(36)\n\nThe last of the two equations may only be satisfied if and\nonly if Ra = Rb or {kR, qR, |k\u2212q|R} \u226a 1. Since the \u03b4 h (x|R)\nvs. \u03b4(x|R) method is inherently a real space measure it involves contributions from all Fourier modes. It is therefore\ndifficult to ensure that ba2 = bb2 .\nWe conclude that the above method will not be a safe\nway to recover bias parameters independent of the smoothing scale. We now turn to Fourier space methods.\n\n\f6\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nL\nNL\nL\nFigure 2. Scale dependence of effective bias parameters bNL\nhh , bhh , bhm and bhm (c.f. Eqs (38) and (39)), estimated from the auto- and\ncross-power spectrum as a function of wavemode. For the left and central panels: solid blue and open red symbols denote the bias when\nPhh is not and is shot noise corrected, respectively. The first panel shows bhh when the nonlinear matter power spectrum is used; the\nsecond panel shows the same but when the linear matter power spectrum is used; the third panel shows bhm , where the red stars and\nblue points denote the case where the nonlinear and linear matter power spectra are used, respectively.\n\nk [ h Mpc\u22121 ]\n0.03-0.09\n0.04-0.12\n0.05-0.15\n0.06-0.18\n\nbNL,SC\nhh\n\nbNL\nhh\n1.589\n1.624\n1.663\n1.695\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.002\n0.002\n0.002\n0.001\n\n1.493\n1.486\n1.474\n1.460\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\nbL,SC\nhh\n\nbL\nhh\n\n0.002\n0.002\n0.002\n0.002\n\n1.589\n1.638\n1.709\n1.775\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.004\n0.003\n0.003\n0.002\n\n1.487\n1.489\n1.503\n1.511\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.004\n0.003\n0.003\n0.003\n\nTable 2. Weighted average estimates of the effective bias, bhh (see Eq. (38) for a defintions).\n\n4.2\n\nEffective large-scale bias from power spectra\n\nWe now use various halo power spectra to derive estimates\nfor an effective large-scale halo bias.\nIn order to do this, we first measure the Fourier transform of the matter and halo density fields as described in\nAppendix A. The halo-halo, halo-mass and mass-mass power\nspectra, {Phh , Phm , Pmm }, are then estimated from the data\nby performing the following sums:\nN(k)\nV\u03bc X\n\u03b4\u03bc (kl )\u03b4\u03bd\u2217 (kl ) ,\nPb\u03bc\u03bd (kl ) =\nN (k) m=1\n\n(37)\n\nwhere {\u03bc, \u03bd} \u2208 {m, h}, V\u03bc is the sample volume (which in\nour case is the simulation volume), and where N (k) are the\nnumber of Fourier modes in a shell of thickness \u2206k.\nFollowing Smith et al. (2007), we next construct the estimators:\ns\ns\nNs\nNs\nX\nX\nb\n1\n1\nP\n(k\n)\nPbhh (ki )\nhh i\nb\nbNL\n; (38)\n; b\nbL\nhh =\nhh =\nL (k )\nNs i=1 Pbmm (ki )\nNs i=1 Pmm\ni\nNs\n1 X Pbhm (ki )\nb\nbNL\n;\nhm =\nNs i=1 Pbmm (ki )\n\nNs\n1 X Pbhm (ki )\nb\nbL\n,\nhm =\nL (k )\nNs i=1 Pmm\ni\n\n(39)\n\nL\nwhere Ns is the number of simulations and Pmm\nis the linear\nmatter power spectrum. Note that in the case of bhh we also\nconsider shot-noise corrected versions of these two estimators, i.e. we correct Phh using Eq. (A11). We denote these\nbias estimates by bNL,SC\nand bL,SC\nhh\nhh , respectively. Finally, we\ndetermine the 1\u03c3 errors by evaluating the variance of each\nrealization against the mean.\n\nThe first panel of Fig. 2 shows bNL\nhh (solid blue data\npoints) and bNL,SC\n(open red points). The bias for the shothh\nnoise corrected terms remains roughly constant at \u223c 1.49\ndown to scales k \u223c 0.08 h Mpc\u22121 and with very small errors, indicating that the result is highly constrained by the\ndata. On scales smaller than this the bias is a decreasing\nfunction of k. Without shot-noise correction, we find that\nthe bias is strongly scale dependent, and the bias rapidly\nincreases with increasing k.\nThe second panel of Fig. 2 shows the results obtained\nL,SC\nfrom using bL\n(open hexagohh (solid blue points) and bhh\n, but\nnal points). The results are similar to those for bNL,SC\nhh\nwith increased cosmic variance on large scales. An oscillation\nstructure is also present, this can be understood as explained\nin Guzik et al. (2007). Nevertheless, comparing the two provides a clear indication of the validity of the tree-level power\nspectrum up to k = 0.08 h Mpc\u22121 .\nThe third panel of Fig. 2 shows the bias results bNL\nhm\n(solid red points) and bL\nhm (solid blue points). The value\nof bNL\nhm stays roughly constant for the whole scale range\nconsidered in the estimate, while bL\nhm is not smooth and\nclearly shows the imprint of the oscillation structure. Nevertheless, we find bL\nhm \u223c 1.48, to within the errors for\nk < 0.08 h Mpc\u22121 . On comparing the results for bNL,SC\nhh\n\u22121\nand bNL\n, these estihm , we see that for scales k . 0.08 h Mpc\nmates are compatible and that the effective large-scale bias\nis roughly b \u223c 1.49. Interestingly, these findings are consistent with real space measures of the effective large scale bias\nfrom cell variances (Smith & Marian 2011).\nIn Table 2, we report the weighted average and corc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\nresponding 1\u03c3 error on the effective bias, bhh , computed\nover the same k-modes corresponding to the magnitude of\nthe third wavevector k3 for each triangle configuration. The\ntabulated results for the analysis of the uncorrected data\nconfirms the results shown in Figure 2, that bias is indeed\nscale-dependent. Applying the shot-noise correction yields a\nmore constant effective bias, even for the range of k-modes\nentering into our bispectrum estimation. Interestingly, the\nvalue b1 = 1.49 \u00b1 0.002 found for k \u2208 [0.03, 0.09], is in good\nagreement with the result for b1 obtained from fitting the\ndensity fields smoothed on scales R = 50 h\u22121 Mpc. Therefore, if we opt to infer that the effective bias is equivalent\nto b1 over these scales, then the bispectrum (reduced bispectrum) should also yield this value for b1 when fitted over\nthe same scale ranges (c.f. Table 2). That is, if the local bias\nmodel is correct and the tree-level bispectrum (reduced bispectrum) is a sufficient description of the nonlinearities on\nthese scales.\nBefore moving on, we point out that one can also use\nthe halo power spectra to define an effective b2 (Smith et al.\n2009), however we shall not explore this here.\n\n5\n\nHALO BIAS FROM BISPECTRA\n\n5.2\n\nBias estimation\n\nOur method for estimating the bias parameters follows an\napproach similar to that presented by Scoccimarro (2000)\nand Porciani & Giavalisco (2002). To start, we take a \u03c72\nfunction that is a quadratic form of the type:\n\u03c72 (b1 , b2 ) =\n\nN\u03b8 N\u03b8\nX\nX\ni=1 j=1\n\n\u22121 \u2206 (b , b ) ,\n\u2206i (b1 , b2 )rd\nij j 1 2\n\n\u2206i \u2261\n\nb\nmod\nB\nhhh (k1 , k2 , \u03b8i ) \u2212 Bhhh (k1 , k2 , \u03b8i |b1 , b2 )\n.\n\u03c3hhh (k1 , k2 , \u03b8i )\n\nrbij =\n\nNsim\n\n1\n\n(Nsim \u2212 1)\n\nX\n\nk=1\n\ne ki \u2206\ne kj ,\n\u2206\n\n(42)\n\n5.1\n\nb\nb (k)\ne i \u2261 Bhhh (k1 , k2 , \u03b8i ) \u2212 B hhh (k1 , k2 , \u03b8i ) ,\n\u2206\n\u03c3hhh (k1 , k2 , \u03b8i )\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n(41)\n\nNote that in dividing the difference between the estimate of\nb and the model predicthe ensemble average bispectrum (B)\nmod\n\u22121\ntion (B\n) by the standard deviation (\u03c3hhh ), rd\nij is in fact\nthe inverse correlation matrix. Recall that the correlation\np\nand covariance matrices are related by: rij = Cij / Cii Cjj .\nIn order to minimize this \u03c72 function and so recover the\n\u22121 , and\nbest-fit bias parameters, we need an estimate of rd\nij\nwe do this using the standard unbiased estimator:\n\nwhere Nsim is the number of simulations and where\n\nThe computational code used to estimate the matter and\nhalo power and bispectra is a modified version of the code\ndeveloped in Smith et al. (2008), which itself is based on\nthe algorithm of Scoccimarro et al. (1998). The major modification to that code, which we have implemented, is that\nno random subsampling of the Fourier modes is performed\nto estimate the bispectrum. Instead, all modes that contribute to a particular triangle configuration are used. In\nthis work we use a FFT grid of size Ng = 5123 to estimate the power and bispectra. We only evaluate triangles\nthat have k2 = 2k1 , but consider the variation of B with\nthe angular separation of the two vectors. The largest scale\nat which we estimate the bispectrum is k1 = 0.03 h Mpc\u22121 ,\nand this is \u2248 7.5kf , where kf = 2\u03c0/L \u2248 0.004 h Mpc\u22121 . Further details of the bispectrum estimation procedure may be\nfound in Appendix A.\nFigure 3 shows the ensemble-averaged shot-noise corrected results for the halo bispectra Bhhh (open red squares)\nand matter bispectra Bmmm (solid blue diamonds), measured from the ensemble of N -body simulations. The four\npanels show the results obtained for the scales: k1 =\n{0.03, 0.04, 0.05, 0.06} h Mpc\u22121 . The error bars are the 1-\u03c3\nerrors on the mean, derived from the ensemble to ensemble\nvariation. The solid red line represents the tree-level prediction for Bmmm as given by Eq. (12). We see that this\nappears to be a good description of the Bmmm estimates for\nthe scales that we have considered. We notice that, for the\ncase k1 = 0.06 h Mpc\u22121 , the theory systematically underpredicts the measurements for \u03b8/\u03c0 \u223c 0.5 (but see \u00a75.4 for a\nmore quantitative discussion of the goodness of fit).\nFigure 4 shows the same as in Fig. 3, however this time\nfor Qhhh and Qmmm .\n\n(40)\n\nwhere N\u03b8 is the number of angular bins considered and\n\nIn this section, we present our main results from the analysis\nof the halo bispectra.\nBispectrum Estimation\n\n7\n\n(43)\n\nb (k) is the kth estimate of the bispecwhere in the above B\nhhh\nb\ntrum and where B\nhhh is the mean of the ensemble.\nNext, we use singular-value-decomposition (SVD) to invert the rbij . For the estimate of the inverse correlation matrix, we utilize principal component analysis (PCA) to remove some of the noisy eigenvectors. We select the fraction\nof principal components that account for 95% of the variance. According to this selection criteria we typically retain\n15 out of 20 of the most 'dominant' eigenmodes. Note that\nd\n\u22121 6= C\nb \u22121 . Howas pointed out in Hartlap et al. (2007), C\never, since we are using PCA, this should be a subdominant\ncorrection. Thus, we may approximate Eq. (40) as:\n\u03c72\n\n=\n\nN\u03b8 N\u03b8\nX\nX\n\n\u2206i (b1 , b2 )[RT \u039bR]\u22121\nij \u2206j (b1 , b2 ) ,\n\ni=1 j=1\n\n=\n\nN\u03b8 N\u03b8\nX\nX\n\n\u2206i (b1 , b2 )\n\ni=1 j=1\nN\u03b8\n\n\u2248\n\nX\n\n2\n\u039b\u22121\nll Yl \u0398ll ,\n\nN\u03b8\nX\n\nT \u22121\nRil\n\u039bll Rlj \u2206j (b1 , b2 ) ,\n\nl=1\n\n(44)\n\nl=1\n\nwhere the correlation matrix r was diagonalized by rotation into its eigenbasis, i.e. r = RT \u039bR, with \u039b representing\nP a\u03b8 diagonal matrix of eigenvalues. We also defined\nYl \u2261 N\ni=1 Rli \u2206i (b1 , b2 ). Note that in the final approximate\nexpression we include a matrix \u0398ll , this a diagonal matrix\nwith entries either 1 or 0, depending on whether the eigenvector is to be retained or cut from the PCA reconstruction.\nFinally, the \u03c72 (b1 , b2 ) function was minimized using the\nLevenberg-Marquardt routine for non-linear least squares\nfitting.\n\n\f8\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nFigure 3. Ensemble-averaged matter and halo bispectrum measurements for 40 LCDM N -body simulations in real-space in comparison\nwith the PT models at tree-level. Each panel shows the shot-noise corrected bispectrum measurements as a function of angle for a variety\nof triangle configurations at different scale ranges set by k1 = {0.03 0.04 0.05 0.06} h Mpc\u22121 and k2 = 2k1 . The blue solid symbols\nrepresent the matter bispectrum, whereas the open squares denote the halo bispectrum. The tree-level bispectrum is represented by the\nsolid orange line and the local halo bias model with the best-fitting parameters listed in Table 4 is the dashed violet line.\n\n5.3\n\nErrors in parameter estimates\n\nTo the best-fit parameters (b1 , b2 ), we assign both systematic\nand statistical errors.\nIn our context, the systematic errors correspond to the\nerrors induced in the best-fit parameters from fitting the\ndata with a noisy inverse covariance matrix (or correlation\nmatrix). Owing to the relatively low number of simulations\n(Nsim = 40), we expect that Eq. (42) provides a noisy es\u22121\ntimate of rij\n. In order to estimate the errors this has on\nthe best-fit parameters we employ the jackknife subsampling\nmethod (see for example Norberg et al. 2009). This involves\nslicing the total data set into Nsub subsamples. Then a resampling of the data is obtained by excluding one of the subsamples from the set. From this resampling we then estimate\nthe mean statistic of interest and the inverse correlation matrix as described in the previous section. The resampled data\nset is then used to determine a new estimate of the best-fit\nbias parameters. This procedure is then repeated for all of\n\nthe possible Nsub resamplings of the data. In our particular case we treat the measurements from each simulation as\nthe regions to be included or excluded, and this gives us 40\njackknife estimates of the bias parameters (b1 , b2 ). The parameter covariance matrix for the systematic errors can be\ncomputed as (Norberg et al. 2009):\nNsub\nX\nb JK [bi , bj ] = Nsub \u2212 1\nC\n(bi,k \u2212 \u02c6b\u0304j )(bj,k \u2212 \u02c6b\u0304j ) ,\nNsub k=1\n\n(45)\n\nwhere bi,k is the estimate of bi from the kth resampling of\nthe data and \u02c6b\u0304i is the estimate of the mean bi obtained from\nall of the resamplings.\nThe statistical error is obtained directly from the nonlinear least-squares analysis. The routine mrqmin provides\nan approximation to the errors on the parameters that corresponds to a \u2206\u03c72 \u2248 1 for a one-parameter model. However,\nthe confidence regions we present in the forthcoming plots\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n\n9\n\nFigure 4. Ensemble-averaged matter and halo reduced bispectrum measurements of the 40 LCDM N -body simulations in real-space in\ncomparison with the PT models at tree-level. Point and line styles as in Figure 3.\n\ncorrespond to either \u2206\u03c72 = (2.30, 6.17), which roughly denote the (\u223c 1\u03c3, \u223c 2\u03c3) errors for a two-parameter model.\nGiven that we consider the two forms of error: systematic and statistical), and that one is never consistently larger\nthan the other, in all forthcoming tables, we choose to report only the total error. This is obtained simply from the\ntwo errors added in quadrature.\n\n5.4\n\nTesting the validity of the tree-level matter B\n\nBefore we report the estimates of the halo bias parameters,\nwe first present a test of the validity of the tree-level model\nfor the matter bispectrum. We do this by applying the \u03c72\ntest described above, to the Bmmm and Qmmm data, and\nso fit for b1 and b2 . Note that since the total number of\nprincipal components retained equals 15, then for a twoparameter model the number of degrees-of-freedom equals\n13. If the tree-level expressions in the large-scale limit as\ngiven by Eqs (26) and (30) are correct, then we should expect\nto find b1 = 1 and b2 = 0.\nTable 3 presents the best-fit nonlinear bias parameters\nc 0000 RAS, MNRAS 000, 000\u2013000\n\nfor the four different bispectrum scale ranges discussed earlier. In the analysis we fit the shot-noise corrected bispectra.\nThe \u03c72 values (end column of the table), confirms that the\n0\ntree-level expressions Bmmm\nand Q0mmm , provide good fits for\nthe triangle configurations with k1 = {0.03, 0.04} h Mpc\u22121 .\nHowever, for k1 = {0.05, 0.06} h Mpc\u22121 the fits are poor\ngiven the \u03c72 estimates, and we see that, for both B and Q,\nthey yield non-zero values for b2 at 1\u03c3. The results also imply that the failure of the tree-level model on these scales\nis more severe for Q than for B. This can be understood\nby noting that b1 from Qmmm shows a prominent departure\nfrom unity, whereas Bmmm does not (although the deviation\nstill exceeds 2\u03c3). We thus conclude that it is likely that the\ntree-level expressions for the halo bispectra will only be valid\nfor k1 6 0.04 h Mpc\u22121 , for our chosen bispectra configurations.\n\n5.5\n\nConstraints on b1 and b2 from halo bispectra\n\nTable 4 presents the best-fit nonlinear bias parameters and\ntheir respective 1\u03c3 errors in quadrature, obtained from the\n\n\f10\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nk1 [ h Mpc\u22121 ]\n\nb1 \u00b1 \u03c3b1\n\nb2 \u00b1 \u03c3b2\n\n\u03c72\n\n0.03\n\nBmmm\nQmmm\n\n1.01 \u00b1 0.07\n0.93 \u00b1 0.19\n\n-0.04 \u00b1 0.25\n-0.05 \u00b1 0.30\n\n19.08\n19.03\n\n0.04\n\nBmmm\nQmmm\n\n0.98 \u00b1 0.03\n1.05 \u00b1 0.09\n\n0.04 \u00b1 0.10\n0.07 \u00b1 0.16\n\n14.31\n14.95\n\n0.05\n\nBmmm\nQmmm\n\n0.97 \u00b1 0.02\n1.14 \u00b1 0.07\n\n0.13 \u00b1 0.08\n0.19 \u00b1 0.13\n\n38.83\n19.97\n\n0.06\n\nBmmm\nQmmm\n\n0.98 \u00b1 0.02\n1.15 \u00b1 0.04\n\n0.10 \u00b1 0.10\n0.22 \u00b1 0.08\n\n34.09\n29.58\n\nk1 [ h Mpc\u22121 ]\n\nTable 3. Assessment of the validity of the tree-level modelling\nby fitting the matter bispectra and reduced bispectra. Column 1:\nbispectrum triangle scale; column 2: statistic, where Bmmm and\nQmmm are shot-noise corrected; columns 3 and 4: best-fit b1 and\nb2 along with 1\u03c3 errors; column 5: \u03c72 .\n\n\u03c72 analysis of Bhhh and Qhhh . Note that we present the\nresults for both the uncorrected and shot-noise corrected\nmeasurements, indicated in the table by superscript 'SC'.\nTable 4 also shows the \u03c72 value of these best-fit parameters\nas an indication of the goodness-of-fit.\nIn Figures 3 and 4 we also show the tree-level theoretical models for Bhhh and Qhhh (dashed lines), where the\nbest-fit bias parameters from Table 4 have been used. These\nfigures demonstrate that, at least by-eye, the tree-level models provide a reasonable description of the data. However a\nmore detailed inspection of Table 4 reveals some important\ndiscrepancies.\nFor the case of fitting B, the shot-noise correction is less\nimportant, as we see that the estimates of b1 for all bispectra\nconfigurations with and without shot-noise corrections are\nconsistent to within the errors, and have b1 \u223c 1.4. However,\nb2 shows systematic differences, being more negative if the\ncorrection is made, and for this we find that b2 \u223c \u22120.25. On\nthe other hand, for the case of Q, the results clearly show\nthat the shot-noise subtraction has an important effect on\nthe recovered values for the bias parameters. If the shotnoise is not corrected, then we see that the estimates for b1\nincrease systematically as we go from triangle configurations\nwith k1 = 0.03 h Mpc\u22121 to k1 = 0.06 h Mpc\u22121 . Whereas if\nit is corrected, then we find b1 \u223c 1.8 and b2 \u223c \u22120.3 to\nwithin the errors. On comparing the results from B and Q\nwe see that, whilst the values for b1 disagree significantly,\nsurprisingly those for b2 remain consistent at the 1\u03c3 level.\nThe \u03c72 function of Eq. (41) may be interpreted as\na Gaussian likelihood if we make the transformation,\nL({Bhhh }|b1 , b2 ) \u221d exp[\u2212\u03c72 /2]. Once suitably normalized\nand on assuming a set of prior probabilities we may then\nexplore the shape of the confidence regions in the posterior\nprobability p(b1 , b2 |{Bhhh }).\nFigure 5 shows the 1\u03c3 likelihood confidence contours\nin the posterior probability for the nonlinear bias parameters for the four scales considered according to our method\nof analysis described above. The solid lines denote the size\nof the confidence regions at the 68% and 95% level (i.e.\n\u2206\u03c72 \u2248 2.3, 6.17) when we construct a correlation matrix\nfrom the 40 realizations without regard for the systematic\nuncertainty. The dashed-lines demonstrate the magnitude\n\nb1 \u00b1 \u03c3b1\n\n\u03c72\n\nb2 \u00b1 \u03c3b2\n\n0.03\n\nBhhh\nSC\nBhhh\nQhhh\nQSC\nhhh\n\n1.43\n1.42\n2.09\n1.75\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.11\n0.11\n0.55\n0.47\n\n-0.18\n-0.36\n-0.12\n-0.39\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.40\n0.38\n0.76\n0.56\n\n17.20\n17.08\n16.08\n16.66\n\n0.04\n\nBhhh\nSC\nBhhh\nQhhh\nQSC\nhhh\n\n1.41\n1.38\n2.32\n1.80\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.08\n0.08\n0.39\n0.29\n\n-0.05 \u00b1 0.26\n-0.27 \u00b1 0.25\n0.14 \u00b1 0.58\n-0.34 \u00b1 0.36\n\n26.92\n26.16\n26.40\n26.96\n\n0.05\n\nBhhh\nSC\nBhhh\nQhhh\nQSC\nhhh\n\n1.40\n1.38\n2.66\n1.90\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.06\n0.05\n0.26\n0.19\n\n0.15 \u00b1 0.21\n-0.25 \u00b1 0.15\n0.57 \u00b1 0.42\n-0.30 \u00b1 0.22\n\n31.92\n12.63\n11.53\n11.60\n\n0.06\n\nBhhh\nSC\nBhhh\nQhhh\nQSC\nhhh\n\n1.41\n1.37\n2.84\n1.87\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.05\n0.03\n0.20\n0.14\n\n0.19 \u00b1 0.24\n-0.23 \u00b1 0.13\n0.88 \u00b1 0.40\n-0.30 \u00b1 0.19\n\n63.64\n19.30\n20.70\n19.47\n\nTable 4. Best-fit bias parameters from fitting the halo-halo-halo\nbispectra and reduced bispectra. Column 1: bispectrum triangle\nscale; column 2: statistic, where Bhhh and Qhhh are raw, and\nSC and QSC are shot-noise corrected; columns 3 and 4:\nwhere Bhhh\nhhh\nbest-fit b1 and b2 along with 1\u03c3 errors; column 5: \u03c72 .\n\nat which the 68% and 95% confidence regions expand following our generation of a set of jackknife subsamples to\nmonitor the effect due to the implicit error associated with\nthe estimated correlation matrix. Hence, we clearly see the\nrelevance of accounting for the uncertainty of the correlation\nmatrix when obtaining the bias parameter constraints. The\ndiscrepancy between the resulting jackknife error ellipses for\nB and Q is less severe than the likelihood contours obtained\nfrom the complete sample where the level of agreement improves progressing to large scales, yet this might be due to\nthe fact that the statistical error is more prominent at larger\nscales. Interestingly, the overlap of the two likelihood regions\nat 2\u03c3 for k1 =0.03, 0.04 and 0.05 h Mpc\u22121 occurs with the\nrectangular region or strip denoting the effective bias measure, bNL,SC\n, at 1\u03c3. These set of panels in Figure 5 convey\nhh\npictorially the information obtained from the results in Table 4 that the likelihood contours from analysis of Q show\nan evolution with decreasing scale toward larger and larger\nb1 , whereas the constraints on b2 remain consistent. Lastly,\nthe constraints obtained from analyzing the Q-amplitudes\nare much weaker than those coming from the bispectrum.\n\n6\n\nHALO BIAS FROM CROSS-BISPECTRA\n\nIn \u00a75.5 we saw that shot-noise corrections influenced the\nrecovery of the bias parameters particularly for Q. In this\nsection, we attempt to develop the use of cross-bispectra, as\nmeasures of the bias that are less susceptible to discreteness\neffects. The use of cross-correlations in large-scale structure\nwork has long been known as a way of reducing discreteness\ncorrections (Peebles 1980). However, it is only relatively recent that it has been applied to study bias (Smith et al.\n2007; Dalal et al. 2008; Smith 2009; Padmanabhan et al.\n2009; Desjacques et al. 2009; Pillepich et al. 2010).\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n\n11\n\nFigure 5. Evolution of the likelihood contours for the bias parameters b1 and b2 , estimated from Bhhh and Qhhh , with scale. The\nsolid lines denote the 68% and 95% confidence intervals, obtained from a full exploration of the likelihood surface around the best\nfit values; the dashed lines denote the same, but where the jackknife parameter covariance matrix from Eq. (45) has been used to\ndetermine the error contours. The top left, top right, bottom left and bottom right panels show the results for triangle configurations\n, using the\nwith k1 = {0.03, 0.04, 0.05, 0.06} h Mpc\u22121 , respectively. The vertical black lines denote the effective bias parameter bNL,SC\nhh\nsame wavemodes that enter into the bispectrum estimates.\n\n6.1\n\nwhere we have for the denominators (again symmetrized):\n\nDefinitions and theory\n\nWe may define the halo cross-bispectra as follows:\n\nP Phhm\n\n=\n\nh \u03b4h (k1 )\u03b4h (k2 )\u03b4(k3 ) i= (2\u03c0)3 \u03b4 D (k123 )Bhhm (k1 , k2 , k3 ) ;(46)\nh \u03b4h (k1 )\u03b4(k2 )\u03b4(k3 ) i= (2\u03c0)3 \u03b4 D (k123 )Bhmm (k1 , k2 , k3 ) (. 47)\nP Phmm\nWe then symmeterize these quantities by the operations:\n(sym)\n\n=\n\n[Bhhm + Bhmh + Bmhh ] /3 ;\n\n(48)\n\n(sym)\n\n=\n\n[Bhmm + Bmhm + Bmmh ] /3 .\n\n(49)\n\nBhhm\n\nBhmm\n\n(sym)\n\nFor ease of notation we shall now simply take Bhhm \u2261 Bhhm\n(sym)\nand Bhmm \u2261 Bhmm , unless otherwise indicated. We may\nnow also define the cross-reduced bispectra as:\nQhhm\n\n\u2261\n\nBhhm /P Phhm ;\n\n(50)\n\nQhmm\n\n\u2261\n\nBhmm /P Phmm ,\n\n(51)\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n=\n\n2\n[Phh (k1 )Phm (k2 ) + 2 cyc ]\n3\n1\n+ [Phm (k1 )Phm (k2 ) + 2 cyc ] ;\n3\n2\n[Phm (k1 )Pmm (k2 ) + 2 cyc ]\n3\n1\n+ [Phm (k1 )Phm (k2 ) + 2 cyc ] .\n3\n\n(52)\n\n(53)\n\nThe relations for P Phhm and P Phmm can easily be constructed using a graphical approach. Let us consider three\nnodes two of which are the same and the third is different\n(we shall think of the nodes as the density fields). Label these\nnodes 1, 2, and 3. Now consider all possible ways to connect\nthe three nodes together by two edges. When two nodes,\nwhich are the same, connect together this gives us an autopower spectrum with a delta function, and when two nodes\nthat are different connect together this gives us a cross-\n\n\f12\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\npower spectrum and delta function. One may then symmetrize the results by considering all possible relabellings\nof the nodes and dividing by three.\nIn Appendix B we calculate the tree-level crossbispectra, Bhmm and Bhhm , in the local model of halo biasing. The main results are:\n\nk1 [ h Mpc\u22121 ]\n\nIn the limit of large scales, and or small smoothing scales,\nfk1 ,k2 \u2192 1 and we have\nthe filter functions W\ni\nb2 h (0)\n(0)\n(0)\n(0)\nBhmm \u2248 b1 Bmmm\n+\nPmm (k1 )Pmm\n(k2 ) + 2 cyc ; (56)\n3\nh\ni\n1\n(0)\n2 (0)\n(0)\n(0)\nBhhm \u2248 b1 Bmmm + b1 b2 Pmm\n(k1 )Pmm\n(k2 ) + 2 cyc .\n3\n(57)\nAt second order in the nonlinear bias and PT, the crossreduced bispectra are:\n(0)\n\nb2 (M )\n3Qmmm\n+\n\u03b1(k1 , k2 , k3 ) ;(58)\n2 + b1 (M )\n2b1 (M ) + b21 (M )\n2b2 (M )\n3 Qmmm\n\u2248\n+ 2\n\u03b1(k1 , k2 , k3 ) .\n2b1 (M ) + 1\n2b1 (M ) + b1 (M )\n(59)\n\nb2 \u00b1 \u03c3b2\n\n\u03c72\n\n0.03\n\nBhmm\nSC\nBhmm\nQhmm\nQSC\nhmm\n\n1.37\n1.37\n1.98\n1.98\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n1.18\n1.18\n0.75\n0.75\n\n-0.36\n-0.36\n-0.75\n-0.75\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.32\n0.32\n0.99\n0.99\n\n16.86\n16.86\n19.09\n19.09\n\n0.04\n\nBhmm\nSC\nBhmm\nQhmm\nQSC\nhmm\n\n1.33\n1.33\n2.50\n2.51\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.16\n0.16\n0.56\n0.56\n\n-0.33\n-0.33\n-0.31\n-0.32\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.51\n0.51\n0.89\n0.89\n\n16.83\n16.83\n17.96\n17.97\n\n0.05\n\nBhmm\nSC\nBhmm\nQhmm\nQSC\nhmm\n\n1.30\n1.30\n2.94\n2.94\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.07\n0.07\n0.25\n0.25\n\n-0.01 \u00b1 0.23\n-0.02 \u00b1 0.23\n0.24 \u00b1 0.57\n0.23 \u00b1 0.57\n\n26.98\n26.82\n16.90\n16.95\n\n0.06\n\nBhmm\nSC\nBhmm\nQhmm\nQSC\nhmm\n\n1.29\n1.29\n3.45\n3.45\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.07\n0.07\n0.30\n0.30\n\n-0.001 \u00b1 0.28\n-0.004 \u00b1 0.28\n1.43 \u00b1 0.94\n1.42 \u00b1 0.94\n\n13.99\n13.93\n46.60\n46.87\n\n(0)\n\n(0)\nBhmm (k1 , k2 , k3 ) \u2248 b1 (M )Bmmm\n(k1 , k2 , k3 )\nh\ni\nb2 (M ) f\n(0)\n(0)\nWk1 ,k2 Pmm (k1 )Pmm (k2 ) + 2 cyc ; (54)\n+\n3\n1\n(0)\n(0)\nBhhm (k1 , k2 , k3 ) \u2248 b21 (M )Bmmm\n(k1 , k2 , k3 ) + b1 (M )\n3\nh\ni\n(0)\n(0)\nfk1 ,k2 Pmm\n\u00d7b2 (M ) W\n(k1 )Pmm\n(k2 ) + 2 cyc .\n(55)\n\nb1 \u00b1 \u03c3b1\n\nTable 5. Best-fit bias parameters from halo-mass-mass bispectra and reduced bispectra. Column 1: bispectrum triangle scale;\ncolumn 2: statistic, where Bhmm and Qhmm are raw and where\nSC\nand QSC\nBhmm\nhmm are shot-noise corrected; columns 3 and 4: bestfit b1 and b2 along with 1\u03c3 errors; column 5: \u03c72 .\n\nQhmm \u2248\n(0)\n\nQhhm\n\nk1 [ h Mpc\u22121 ]\n\n(0)\n\n(0)\n\nQhhm\n\n6.2\n\n\u2248\n\u2248\n\nb2 (M )\n3Qmmm\n+\n;\n2 + b1 (M )\n2b1 (M ) + b21 (M )\n2b2 (M )\n3 Qmmm\n+ 2\n.\n2b1 (M ) + 1\n2b1 (M ) + b1 (M )\n\n0.03\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.25\n0.24\n0.40\n0.40\n\n-0.32\n-0.45\n-0.49\n-0.67\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.60\n0.47\n0.46\n0.42\n\n17.13\n17.49\n17.45\n17.46\n\n0.04\n\nBhhm\nSC\nBhhm\nQhhm\nQSC\nhhm\n\n1.39\n1.37\n2.49\n2.56\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.14\n0.15\n0.46\n0.49\n\n-0.24\n-0.37\n-0.17\n-0.47\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.25\n0.24\n0.56\n0.51\n\n21.29\n21.42\n22.92\n24.60\n\n0.05\n\nBhhm\nSC\nBhhm\nQhhm\nQSC\nhhm\n\n1.38\n1.36\n2.87\n2.92\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.08\n0.07\n0.18\n0.19\n\n-0.05 \u00b1 0.18\n-0.29 \u00b1 0.14\n0.22 \u00b1 0.29\n-0.37 \u00b1 0.25\n\n22.46\n13.16\n12.55\n16.77\n\n0.06\n\nBhhm\nSC\nBhhm\nQhhm\nQSC\nhhm\n\n1.39\n1.36\n3.12\n3.25\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.07\n0.07\n0.27\n0.31\n\n-0.07 \u00b1 0.25\n-0.31 \u00b1 0.22\n0.54 \u00b1 0.52\n-0.14 \u00b1 0.47\n\n20.56\n15.32\n37.81\n60.54\n\n(61)\n\nThe cross-bispectra Bhhm and Bhmm can be estimated following the algorithm described in \u00a75.1 with some small modifications. Firstly, the estimates must be symmetrized, and\nfor the discrete form of Bhhm we have,\nd\nbhhm\nB\n(k1 , k2 , \u03b812 )\n\n\u00d7\n\nn\n\n=\n\n1 V\u03bc2\n3 Ntri\n\nNtri\n\nX\n\n(n1 ,n2 )\n\no\nRe[\u03b4h (kn1 )\u03b4h (kn2 )\u03b4m (kn3 )] + 2 cyc ,(62)\n\nd\nbhmm\nand with a similar relation for B\n. The reduced bispectra\nare estimated by dividing the above bispectrum estimates\nby estimates for P Phhm and P Phmm from Eqs (52) and (53),\nrespectively.\nOne further complication is constructing the corrections\nfor shot-noise. This may be performed following the countsin-cells approach of Peebles (1980) (and see also Smith\n2009). We find that the symmetrized corrections for Bhhm\nand Bhmm can be written as:\ni\n1 h d\nb\u0304\nB\n\u2261\nPhm (k1 ) + 2 cyc ;\n(63)\nhhm,shot\n3nh\nh\ni\n1\nd\nb\u0304\nPhm\n(k1 ) + 2 cyc ,\n(64)\nB\n\u2261\nhmm,shot\n3nm\n\n\u03c72\n\n1.42\n1.42\n2.08\n2.11\n\n(60)\n\nEstimation of the cross-bispectra\n\nb2 \u00b1 \u03c3b2\n\nBhhm\nSC\nBhhm\nQhhm\nQSC\nhhm\n\nIn the large-scale limit, \u03b1 \u2192 1, these expressions become:\nQhmm\n\nb1 \u00b1 \u03c3b1\n\nTable 6. Best-fit bias parameters from halo-halo-mass bispectra\nand reduced bispectra. Column 1: bispectrum triangle scale; colSC\numn 2: statistic, where Bhhm and Qhhm are raw and where Bhhm\nSC\nand Qhhm are shot-noise corrected; columns 3 and 4: best-fit b1\nand b2 along with 1\u03c3 errors; column 5: \u03c72 .\n\nwhere nm = N/V\u03bc and nh = Nh /V\u03bc , are the number density of matter particles and haloes, respectively. For the reduced bispectra we must correct the estimates of P Phhm and\nP Phmm , which are written in the following form:\ni\n2 h bd\nQdenom\n=\nPhm (k1 ) + 2 cyc ;\n(65)\nhhm,shot\n3nh\nh\ni\n2\nd\nQdenom\n=\nPbhm\n(k1 ) + 2 cyc .\n(66)\nhmm,shot\n3nm\nAs it is the case that nm \u226b nh , we expect that the shotnoise corrections to Bhmm will be significantly smaller than\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n\n13\n\nFigure 6. Evolution of the 95% likelihood contours for b1 and b2 obtained from the halo auto- and cross-bispectra and reduced bispectra\nas a function of scale. In each panel, the solid red lines of increasing thickness denote {Bhmm , Bhhm , Bhhh } and the dashed blue lines\nof increasing thickness denote {Qhmm , Qhhm , Qhhh }. The alphabetical labels {a, b, c, d} correspond to the triangle configurations with\n, using the same\nk1 = {0.03, 0.04, 0.05, 0.06} h Mpc\u22121 , respectively. The vertical black lines denote the effective bias parameter bNL,SC\nhh\nwavemodes that enter into the bispectrum estimates.\n\nfor Bhhm . Hence, we shall think of this as being an almost\nperfect measure independent of discreteness.\nUsing these estimators, we compute the ensemble average and ensemble-to-ensemble variations of the halo-mass\ncross-bispectra. We do this for the same bispectra configurations that were considered in \u00a75.1.\n\n6.3\n\nNonlinear bias from cross-bispectra\n\nWe estimate the nonlinear bias parameters and their errors\nfrom the cross-bispectra using the same method employed\nfor the auto-bispectra in \u00a75.2 and \u00a75.3. The results are tabulated in Tables 5 and 6, respectively.\nFigure 6 presents the 2-D 95% confidence likelihood\ncontours for b1 and b2 , that are obtained from fitting the\nSC\nSC\nSC\nshot-noise corrected bispectra {Bhhh\n, Bhhm\n, Bhmm\n} and reSC\nSC\nSC\nduced bispectra {Qhhh , Qhhm , Qhmm }. The four panels show\nthe results obtained from fitting triangle configurations,\nk1 \u2208 {0.03, 0.04, 0.05, 0.06} h Mpc\u22121 , with k2 /k1 = 2, and\nthese correspond to the top-left, top-right, bottom left and\nbottom right panels, respectively. For comparative purposes,\nthe vertical band in each panel, denotes the 1\u03c3 constraint\nc 0000 RAS, MNRAS 000, 000\u2013000\n\non bNL,SC\n, obtained from the shot-noise corrected halo and\nhh\nnonlinear matter power spectra (c.f. \u00a74.2).\nSC\nSC\nSC\nConsider first the bispectra {Bhmm\n, Bhhm\n, Bhhh\n,}\n(solid red lines of increasing thickness), from the figure\nand the tables, we see that all of the results are reasonably consistent with one another over the various scale\nranges considered. However, when smaller scales are used\n(i.e. k1 > 0.05 h Mpc\u22121 ), the consistency weakens and the\nSC\nSC\nbest-fit parameters, obtained from Bhhh\nand Bhmm\n, differ\nby & 2.5\u03c3.\n\nEvaluating the results for the reduced bispectra\nSC\nSC\n{QSC\nhmm , Qhhm , Qhhh } (dashed blue lines of increasing thickness), the four panels show a strong evolution of the error ellipses with scale. We also note that the level of agreement between the different estimators also evolves strongly,\nbecoming weaker and weaker as smaller scales are considered. At the largest scale where k = 0.03 h Mpc\u22121 , all of the\n2\u03c3 likelihood contour regions overlap. However, this consistency is broken for the next scale range, k = 0.04 h Mpc\u22121 ,\nwhere Qhmm and Qhhm are shifted downwards and further\nto the right favoring a more negative b2 and higher b1 . The\ntrend continues in this same direction heading to smaller\nand smaller scales.\n\n\f14\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nComparing the results from both B and Q together, we\nsee that only on the largest scales is there any degree of overall consistency. One way to interpret the results up to now,\nis that, if we believe b1 \u2248 bNL,SC\n, then the agent driving the\nhh\ninconsistency between the parameter estimates, is the breakdown of the local bias model at tree-level. Furthermore, the\nbreakdown of the local tree-level model is more severe for\nthe reduced bispectrum than for the bispectrum.\n\n7\n\nThis final set of analysis consists of a simple proof of method\ntest, and we determine whether, when the underlying bias\nmodel is known, the 'true' bias parameters of the model are\nindeed recoverable with our approach.\nBiasing by hand\n\nFor these tests, and for simplicity, we shall assume that the\nlocal model of biasing at quadratic order is the correct underlying bias model. Nonlinear biased density fields of this\ntype may be obtained through the following procedure.\nFor each of the z = 0 outputs of the 40 simulations,\nwe assign the nonlinear density field of matter to a cubical\nFourier grid using the CIC algorithm. This is then Fourier\ntransformed. Each Fourier mode is then smoothed using a\nGaussian filter of scale R. We then inverse Fourier transform this field and obtain the smoothed, nonlinear matter\ndistribution in real space. Using this we next form the sum,\n\u03b4b (x|R) = bb1 \u03b4(x|R) + bb2 [\u03b4(x|R)]2 /2 ,\n\nPn,m\n\n\u2261\n\nP4,m\n\n\u2261\n\nP5,m\n\nTHE NEED FOR BEYOND TREE LEVEL\nBIAS MODELS\n\n7.1\n\nwhere for ease of notation we take bbi = bi and in the above\nwe have suppressed the dependence of B, P4,m , P5,m and\nP6,m , on (k1 , k2 , \u2212k1 \u2212 k2 ). We have also introduced the\nauxiliary functions:\n\n(67)\n\nwhere bb1 and bb2 are the artificial bias parameters. Finally,\nthis is Fourier transformed to give us \u03b4b (k|R). Thus, given\n\u03b4(k|R) and \u03b4b (k|R), we can now use our standard bispectrum estimators to estimate Bbbb , Bbbm , Bbmm and Bmmm .\nWe refer to this procedure as the 'biasing-by-hand' test.\nThe major benefits of these tests are that we are able to\nbetter gauge the effects to which nonlinearities beyond treelevel order influence the measured bispectra and reduced\nbispectra. We also note that shot-noise plays no r\u00f4le here,\nsince the biased field is created from the matter density field\nwhich is densely sampled.\n\nP6,m\n\n\u2261\n\n\u2261\n\nW (k1 R)W (k2 R)W (k3 R)Pn,m ;\nZ 3\nd q1 f\nWq1 ,k1 \u2212q1\n(2\u03c0)3\n\u00d7T (q1 , k1 \u2212 q1 , k2 , k3 ) + 2 cyc ;\nZ 3\nd q1 d3 q2 f\nfq ,k \u2212q\nWq1 ,k1 \u2212q1 W\n2 2\n2\n(2\u03c0)3 (2\u03c0)3\n\u00d7P5,m (q1 , k1 \u2212 q1 , q2 , k2 \u2212 q2 , k3 )\n\n(72)\n\n(73)\n\n+2 cyc ;\n(74)\nZ 3\nd3 q3 f\nd q1\nfq3 ,k3 \u2212q3\n...\nWq1 ,k1 \u2212q1 . . . W\n(2\u03c0)3\n(2\u03c0)3\n\u00d7P6 (q1 , k1 \u2212 q1 , q2 , k2 \u2212 q2 , q3 , k3 \u2212 q3 ) . (75)\n\nThe attractive aspect of this test can now be understood: if\nwe move the terms in Eqns (69), (70) and (71), which are\nproportional to Bmmm from the right to the left-hand-side,\nthen we may rewrite this system as the matrix equation:\n\uf8f6\n\uf8f6\uf8eb\n\uf8f6 \uf8eb\n\uf8eb\nP4,m\nYbmm\nb2 /2\n0\n0\n\uf8ed Ybbm \uf8f8 = \uf8ed b1 b2 /3 b22 /12\n0 \uf8f8 \uf8ed P5,m \uf8f8 , (76)\nb21 b2 /2 b1 b22 /4 b32 /8\nP6,m\nYbbb\n\nwhere we defined Ybmm \u2261 Bbmm \u2212 b1 Bmmm , etc. This equation may be inverted to give,\n\uf8f6\n\uf8eb\n\uf8f6\uf8eb\n\uf8f6\n\uf8eb\nP4,m\nYbmm\n2b22\n0\n0\n1\n\uf8ed P5,m \uf8f8 =\n\uf8ed \u22128b1 b2\n12b2\n0 \uf8f8 \uf8ed Ybbm \uf8f8 .(77)\nb32\nP6,m\n8b21\n\u221224b1 8\nYbbb\nHence, if we specify b1 , b2 and measure the four bispectra\nBmmm , Bbmm , Bbbm and Bbbb , then we can determine exactly P4,m , P5,m and P6,m . Thus we have complete knowledge of all components of the nonlinear model at all orders in\nthe theory. The lowest order perturbation theory expansions\nof these statistics are (c.f. Appendix B):\ni\nb2 h (0)\n(0)\n(0)\n(0)\nBbmm \u2248 b1 Bmmm\n+\nPmm (k1 )Pmm\n(k2 ) + 2 cyc ; (78)\n3\ni\nb1 b2 h (0)\n(0)\n(0)\n2 (0)\nPmm (k1 )Pmm\n(k2 ) + 2 cyc ;(79)\nBbbm \u2248 b1 Bmmm +\n3 h\ni\n(0)\n3 (0)\n2\n(0)\n(0)\nBbbb \u2248 b1 Bmmm + b1 b2 Pmm\n(k1 )Pmm\n(k2 ) + 2 cyc , (80)\n\nwhere in the above, we defined Pmm (k) \u2261 W 2 (k|R)Pmm (k).\n7.2\n\nTheoretical interpretation\n\nIn order to interpret the results from such a construction\nwe may use the results presented in Appendix B, with the\nsmall modification that we do not de-smooth the results. If\nwe define the smoothed bispectra as\nB(k1 , k2 , k3 ) \u2261 W (k1 R)W (k2 R)W (k3 R)B(k1 , k2 , k3 ) , (68)\nthen for {Bbmm , Bbbm , Bbbb }, we have:\nb2\nP4,m ;\n(69)\n2\n2\nb1 b2\nb\n= b21 Bmmm +\nP4,m + 2 P5,m ;\n(70)\n3\n12\nb2 b2\nb1 b22\nb3\nP5,m + 2 P6,m ,\n= b31 Bmmm + 1 P4,m +\n2\n4\n8\n(71)\n\nBbmm = b1 Bmmm +\nBbbm\nBbbb\n\n7.3\n\nResults of the artificial bias test\n\nFollowing the algorithm described in \u00a77.1, for each realization of our ensemble of simulations, we generate three\nartificially biased density fields smoothed on scales: R =\n{20 , 10 , 6.67} h\u22121 Mpc. In all cases we apply the same nonlinear bias: b1 = 1.63 and b2 = \u22120.53. Whilst these values\nare somewhat arbitrary, they were selected to coincide with\nthe best-fit values to the scatter plot of \u03b4h (x|R) vs. \u03b4(x|R),\nsmoothed at R \u223c 10 h\u22121 Mpc, that we recorded in \u00a74.1.\nFor each filtering scale, we then measure the four bispectra Bmmm , Bbmm , Bbbm and Bbbb for triangle configurations\nwith k1 = 0.04 h Mpc\u22121 , k2 /k1 = 2, over 20 angular bins.\nFrom these we use the method described above, to recover\nthe higher-order terms: P4,m , P5,m and P6,m .\nWe now define three modelling cases of interest:\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\nR [ h\u22121 Mpc]\n20\n20\n20\n10\n10\n10\n6.7\n6.7\n6.7\n\nb1 \u00b1 \u03c3b1\nBbbb\nBbbm\nBbmm\nBbbb\nBbbm\nBbmm\nBbbb\nBbbm\nBbmm\n\n1.62\n1.62\n1.63\n1.62\n1.62\n1.63\n1.59\n1.60\n1.63\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.07\n0.10\n0.22\n0.04\n0.06\n0.13\n0.04\n0.05\n0.12\n\nb2 \u00b1 \u03c3b2\n-0.46\n-0.49\n-0.53\n-0.42\n-0.47\n-0.53\n-0.35\n-0.42\n-0.53\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.12\n0.19\n0.51\n0.04\n0.07\n0.20\n0.02\n0.04\n0.12\n\n\u03c72\n0.01\n0.00\n0.00\n0.15\n0.02\n0.00\n0.70\n0.14\n0.00\n\nTable 7. Constraints on b1 and b2 obtained using the Exact\nTrispectrum model described in the text. The actual input\nbias parameters were b1 = 1.63 and b2 = \u22120.53. Column 1: the\nsmoothing scale of the biased density field; Column 2: measured\nquantity; Column 3 and 4 best-fit values for b1 and b2 along with\n1\u03c3 errors; Column 5: the median \u03c72 .\n\nR [ h\u22121 Mpc]\n20\n20\n20\n10\n10\n10\n6.7\n6.7\n6.7\n\nb1 \u00b1 \u03c3b1\nBbbb\nBbbm\nBbmm\nBbbb\nBbbm\nBbmm\nBbbb\nBbbm\nBbmm\n\n1.63\n1.58\n1.37\n1.49\n1.48\n1.46\n1.36\n1.36\n1.32\n\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\u00b1\n\n0.11\n0.17\n0.33\n0.03\n0.04\n0.09\n0.02\n0.03\n0.07\n\nb2 \u00b1 \u03c3b2\n\n\u03c72\n\n-0.67 \u00b1 0.36\n-0.45 \u00b1 0.65\n0.56 \u00b1 1.19\n-0.66 \u00b1 0.08\n-0.69 \u00b1 0.13\n-0.69 \u00b1 0.29\n-0.74 \u00b1 0.06\n-0.82 \u00b1 0.09\n-0.86 \u00b1 0.22\n\n14.75\n15.71\n18.43\n13.32\n13.60\n14.13\n13.21\n12.87\n13.13\n\nTable 8. Same as Table 7, but this time the \u03c72 analysis is for\nthe Tree-level model described in the text.\n\n\u2022 Case 1: All Order: Eqns (69), (70) and (71) are used\nto interpret the data.\n\u2022 Case 2: Exact Trispectrum: Eqns (69), (70) and (71)\nare exact up to P4,m . All higher-order terms (P5,m , P6,m )\nare dropped from the modelling.\n\u2022 Case 3: Tree-level: lowest order expansions given by\nEqns (78), (79) and (80) are used to interpret the data.\nFor each of the models described above, we then apply the\nsame \u03c72 \u2013fitting analysis, as described in \u00a75.2 to determine\nthe best-fit b1 and b2 parameters.\nWe begin by first examining the All Order expansion\nmodel. We confirm that for this case, the true bias parameters b1 = 1.63 and b2 = \u22120.53 are recovered exactly, albeit\nwith some uncertainty, however, with a \u03c72 = 0, and for all\nthe smoothing lengths considered. This null test is important, because it gives us confidence that any departures of\nthe fits from the true bias values, can be attributed solely\nto a break down of the theoretical modelling.\nNext we focus on the Exact Trispectrum model\nwhere Bmmm and P4,m are measured from the simulations. In\nTable 7 we report the best-fitting bias parameters with the\n1\u03c3 errors expressed in quadrature for the auto- and crossbispectrum and for the four smoothing scales examined. For\nthe case Bbmm , a quick inspection of Eq. (69) tells us that\nthe modelling should be exact, and indeed we see that the\nbias parameters are correctly recovered. However, for the\ncases Bbbm and Bbbb we see that the absence of the higherorder terms (P5,m , P6,m ), induce biases in the parameters.\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n15\n\nFor b1 the deviation from the true value is relatively small,\nwith the value of the parameter only slightly decreasing in\nsize. For b2 the deviations are larger, and this parameter becomes more positive. We also note that the deviations from\nthe true values appear to increase as the smoothing scale is\ndecreased.\nFinally, we focus on the Tree-level model. Table 8\npresents the best-fit results for b1 and b2 . We see that in\nnearly all cases, there are systematic biases in the recovery\nof the nonlinear bias parameters for all of the measured bispectra. In particular, for the case of Bbmm , the results are\nmost deviant and poorly constrained. Whereas for Bbbb , only\nwhen the data has been smoothed on scales R = 20 h\u22121 Mpc\nare the recovered parameters close to the true values.\nThe comparison of the results from this analysis leads\nus to conclude that the recovered bias parameters are very\nsensitive to the inclusion of beyond leading order corrections\nin the modelling. Furthermore, accurate nonlinear modelling\nof, at the very least, the matter bispectrum and trispectrum\nwill be essential, if we are to safely recover the nonlinear\nbias parameters from this approach.\n\n8\n\nDISCUSSION\n\nWe have evaluated the local halo bias model at second-order\nusing three different probes: smoothed density fields; power\nspectra; and bispectra and reduced bispectra. A summary of\nour results for the best-fitting bias parameters determined\nfrom shot-noise corrected spectra is shown in Figure 7.\nIn the figure we also compare our estimates for b1 and\nb2 with the analytical predictions for the halo bias parameters obtained from the peak background split (PBS) ansatz\n(Bardeen et al. 1986; Mo & White 1996). The average theory bias parameters are obtained through computing the\nexpression:\nZ\nZ \u221e\n1 \u221e\nbi =\ndM n(M ) bi (M ) ; n \u2261\ndM n(M ) , (81)\nn Mmin\nMmin\nwhere n(M ) is the halo mass function, and Mmin\nis set equal to the value of the minimum halo mass\nidentified in the simulations (see \u00a73) . We evaluate the\nabove integral using three different fits to N-body simulations by Sheth & Tormen (1999), Warren et al. (2006) and\nPillepich et al. (2010). The corresponding expressions for\nthe bias parameters as a function of halo mass are presented\nin Scoccimarro et al. (2001) and Manera et al. (2010).\nConsidering, the results for b1 (bottom panel), we see\nthat when the reduced bispectra, Qhhh , Qhhm and Qhmm\nare used, the recovered parameters are poorly constrained\nand appear incompatible with respect to the other estimates\nand are only weakly consistent with one another. On the\nother hand, the estimates from the bispectra Bhhh , Bhhm\nand Bhmm are in much better agreement with each other.\nThey are also in close agreement with the predictions from\nWarren et al. (2006) and Pillepich et al. (2010), which both\nprovided an estimate of b1 = 1.39. However, they slightly\nundershoot the values from the effective bias estimates,\nL\nbNL\nhh and bhh , likewise the smoothed density fields, and the\nSheth-Tormen prediction. The analytical predictions from\nthe Sheth & Tormen (1999) mass-function yielded b1 = 1.50\nin good agreement with the power spectrum and density field\n\n\f16\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nFigure 7. Plot summary of bias measurements on b1 and b2\nfor the second-order local bias model from different estimators:,\nshot-noise corrected B, Q, P , and finally smoothed, \u03b4R , in comparison with analytical predictions applying the peak-background\nsplit ansatz with the Sheth & Tormen (1999) mass function denoted by the dotted line, as well as the Warren et al. (2006) and\nPillepich et al. (2010) mass-functions, which are both represented\nby the single dashed-line.\n\nresults smoothed on a scale R \u223c 50 h\u22121 Mpc. The recovered\nvalues of b1 from the effective bias in the power spectra\nand the smoothed density fields collectively are in broad\nagreement, but the latter increase with decreasing smoothing scale.\nIn the top panel of the figure, we see that the constraints on b2 from the different estimators used in the\nsimulations are reasonably consistent with one another, albeit with significant error bars. These estimates also agree\nwell with the PBS prediction from the Warren et al. (2006)\nand Pillepich et al. (2010) mass functions, which give an\naverage b2 = \u22120.24. However, the prediction from the\nSheth & Tormen (1999) mass function gives b2 = \u22120.06,\nand this appears to be in worse agreement with the data.\nThere are a number of possible explanations for the deviations in the recovered bias parameters. Firstly, the relation between matter and halo fluctuations may not be local.\nIndeed, we know it is not deterministic owing to the scatter in relation \u03b4h vs. \u03b4. Perhaps, this is a consequence of\nnon-locality. In this case we need a more advanced theoretical approach to understand the halo clustering. One possibility may be that the bias is local in Lagrangian space\n(Catelan et al. 2000; Matsubara 2011).\nSecondly, our simple biasing-by-hand test has enabled\nus to discern that, for the current set of tests that we have\nperformed, the most likely explanation at this point is that\nthe tree-level expansions for Bhhh and Qhhh are not sufficiently accurate enough. Higher-order nonlinear corrections\n\nin the modelling must be included, and if possible all order\nexpansions for Bmmm and P4,m would be invaluable.\nThirdly, as we have argued, the local bias model only\nmakes sense in the context of smoothing. The bias parameters one recovers from fitting, depend sensitively on the\nsmoothing scale R. For the biasing-by-hand tests, the exact\nsmoothing scale was known beforehand. However, in real\ndata we do not know this a priori. In all of the cases, when\nrecovering bias parameters from the bispectra, we have assumed that we are on sufficiently large scales such that\nW (ki R) \u2192 1. However, in general R should be a free parameter and as such, marginalized over in the analysis.\nManera & Gazta\u00f1aga (2011) performed a similar study\nof nonlinear halo bias with the three-point correlation function in configuration space. In contrast to our analysis, they\nmeasured the bias parameters for different halo mass bins.\nThey found inconsistencies between the predictions of the\ndifferent estimators considered. They evaluated the scatter\nplots of \u03b4h vs. \u03b4 as function of smoothing scale, and found\nthat stability in the local bias parameters (b1 , b2 ) occurred\nfor smoothing scales, R > 30\u221260 h\u22121 Mpc, albeit with larger\nerrors. They also found that the bias predictions derived\nfrom \u03b4h vs. \u03b4 for R = 60 h\u22121 Mpc were in good agreement,\nto within the errors, with the linear bias measured from evaluating the two-point correlation function on large and intermediate scales. As in the case of our findings, they found the\nlinear bias measured from evaluating the three-point correlation function, expressed in terms of the Q-amplitudes, was\nnot consistent with that of the two-point correlation function for the lower mass bins: M < 1013 h\u22121 M\u2299 . They were\nunable to formulate solid conclusions for larger mass ranges.\nGuo & Jing (2009) explored the differences between estimates of bias from Q and P . They also found that b1 based\non analysis of the mock galaxy catalogues was larger for\ngalaxy reduced bispectra and power spectra Qg than for\nPg . While Guo & Jing (2009) also noted that this might be\ndue to the failure of SPT at tree-level, they also reported\nthat agreement could be found between estimators if Qmmm\nmeasured directly from the simulations was used in place of\nthe tree-level expression. However, when we performed the\nsame test with our data we found no dramatic reconciliation of the two bias estimates. The investigation performed\nby Guo & Jing (2009) was carried out using only 4 large\nvolume and 3 smaller volume runs. As a result of having too\nfew realizations, they assumed the Gaussian approximation\nfor the covariance matrix in order to perform their study at\nlarge-scales.\n\n9\n\nCONCLUSIONS\n\nIn this paper we have used a sample of 40 large volume\nN -body simulations, with total volume V \u223c 135 Gpc3 h\u22123 ,\nto test the local model of halo biasing, and the extent to\nwhich nonlinearities impact the modelling. We used three\ndifferent methods for exploring the bias: smoothed density\nfields; power spectra; and bispectra and reduced bispectra.\nWe focused mainly on the results from the bispectra. All of\nthe reported results were scaled to a single realization of our\nsimulations, and so are directly relevant for galaxy surveys\nwith a total volume V \u223c 4 h\u22123 Gpc3 .\nIn \u00a72 we reviewed the basic results of perturbation thec 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\nory and how they connect to density statistics. We then\nreviewed the local model of halo biasing, drawing special attention to the r\u00f4le that smoothing plays in the theory. The\nimportant result being that even at tree-level, the smoothing explicitly enters the theory. The expressions for Bhhh\nand Qhhh , which are typically used in all past and current\nanalysis, make the assumption that smoothing is unimportant. In subsequent sections we argued that this assumption\nis not safe.\nIn \u00a73 we described our suite of N -body simulations, and\nthe halo catalogues used in this study.\nIn \u00a74 we made measurements of the relation between \u03b4h (x|R) and \u03b4(x|R) smoothed on the set of scales\nR = {50, 20, 10} h\u22121 Mpc. To this data we fitted the local\nmodel of halo biasing up to second order, including b0 , b1 and\nb2 . We found that the fits were reasonably good, however the\nbest-fit parameters showed a running with the filter scale R.\nWe then demonstrated, theoretically, why the nonlinear bias\nparameters from this approach, could not be made independent of smoothing scale. We then turned to Fourier space\nstatistics, and used the halo auto- and cross-power spectra to obtain an effective large-scale bias. We found that\nNL\nthe effective bias estimators bNL\nhh and bhm were reasonably\n\u22121\nscale independent for k < 0.08 h Mpc . However, on scales\nsmaller than this, bNL\nhh decreased with increasing wavenumber, whereas bNL\nhm remained surprisingly flat.\nIn \u00a75 we estimated the matter auto- and halo autobispectra and reduced bispectra from our simulations. We\nmeasured these statistics for the triangle configurations\nk1 = {0.03, 0.04, 0.05, 0.06} h Mpc\u22121 and with k2 /k1 = 2\nand \u03b812 \u2208 [0, \u03c0]. These triangles all lay in the weakly nonlinear regime k = 0.03 \u2212 0.18 h Mpc\u22121 . We modeled these estimates using tree-level perturbation theory expressions for\nthe matter bispectrum and nonlinear bias at second order,\nand assumed smoothing to be unimportant. Our method for\nestimation of the bias parameters followed a standard minimum \u03c72 approach. We estimated the covariance matrix for\nthe full ensemble applying principal component analysis to\nminimize the intrinsic noise. We also performed a jackknife\nsubsampling routine to propagate the error of the estimated\ncovariance matrix onto the errors of the bias parameters.\nWe tested how well the measurements of the matter\nbispectra Bmmm and reduced bispectra Qmmm could be described by such modelling. The results obtained for the bias\nparameters b1 and b2 showed that the tree-level expressions\nwere a good description of the data for configurations, k1 =\n{0.03, 0.04} h Mpc\u22121 , for which b1 = 1 and b2 = 0. However,\nfor smaller scale triangles, k1 = {0.05, 0.06} h Mpc\u22121 , significant deviations were apparent, and these were manifest as\nb1 6= 1 and b2 6= 0 at high significance.\nWe then applied the \u03c72 test to the halo bispectra Bhhh\nand reduced bispectra Qhhh . We found, for the shot-noise\ncorrected Bhhh , that the estimated values for b1 \u223c 1.40 and\nb2 \u223c \u22120.25 were reasonably consistent with one another.\nHowever, the fits became progressively poorer as smaller\nscales were added, yet the reduced\u2013\u03c72 remained . 2 for\nk1 = {0.06} h Mpc\u22121 . For the shot-noise corrected Qhhh ,\nwe found that the values of b1 were significantly larger\nb1 \u223c 1.85, with large errors, and the values evolved with\ntriangle configuration scale. However, b2 \u223c \u22120.3, appeared\nto be more stable, although again with large errors. For triangle configurations with k1 > 0.04 h Mpc\u22121 , the fits from\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n17\n\nBhhh and Qhhh were inconsistent with each other at the \u223c 3\u03c3\nlevel. For both Bhhh and Qhhh shot-noise corrections significantly influenced the recovered bias parameters.\nIn \u00a76 we explored the halo and matter cross-bispectra,\nBhhm and Bhmm , and reduced bispectra Qhhm and Qhmm .\nWe calculated the tree-level expressions for these quantities\nsymmetrized in all of their arguments. We then developed\nestimators for them. We showed that for Bhmm and Qhmm ,\nprovided the matter distribution was densely sampled, the\nshot-noise corrections were small.\nWe applied the \u03c72 analysis from \u00a75 to these statistics\nand recovered the best-fit values for b1 and b2 . We found\nthat for Bhhm the shot-noise corrected data were all reasonably consistent with one another, giving b1 \u223c 1.39 and\nb2 \u223c \u22120.3. For Bhmm we found a similar pattern, except\nthat for k1 > 0.05 h Mpc\u22121 where we found b2 \u223c 0.0, but\nwith large errors. The results for Qhhm and Qhmm appeared\nto vary significantly.\nFinally in \u00a77 we explored to what extent the break-down\ncould be attributed to the absence of terms that were beyond\ntree-level in the modelling. In order to do this, we developed\na novel approach, whereby we constructed smoothed biased\ndensity fields from the smoothed matter density field, using\nthe local model at quadratic order. We showed that if we\nset b1 and b2 to some fiducial values, and then measured\nthe smoothed matter and halo bispectra and their crossbispectra, then the higher order matter correlators P4,m ,\nP5,m and P6,m could be recovered exactly. Thus we were\nable to construct three models: an all order model; a model\nthat used the exact matter bispectrum and trispectrum; and\na tree-level model.\nWe applied the \u03c72 analysis using these three models and\nfor bispectra with k1 = 0.04 h Mpc\u22121 . As expected, the exact model recovered the correct bias parameters. The model\nwith the exact Bmmm and P4,m , was in fact also exact for\nBbmm . For Bbbm and Bbbb the recovered parameters were\nclose to the true values, but showed evolution with smoothing scale. Finally, for the tree-level model we showed that\nthere was a significant evolution in the estimated bias parameters with smoothing scale and with the type of statistic\nused.\nWe conclude that estimates of nonlinear bias from the\nbispectrum that do not attempt to account for higher-order\ncorrections, will most likely provide biased estimates for the\nbias parameters b1 and b2 . Robust modelling of nonlinear\nbias from bispectra, will, at the very least, require almost\nexact models for the matter bispectrum and trispectrum.\nReal space estimates of bias appear to be inconsistent\nwith Fourier space based ones. We believe that this owes\nprimarily to the mixing of large- and small-scale wavemodes\nin real space. We therefore recommend that perturbative\nmethods should strictly be applied in Fourier space. We also\nrecommend that measurements focus on the bispectrum and\nthe associated cross statistics, rather than the reduced bispectra, since this appears very sensitive to nonlinearities in\nthe modelling and also shot-noise corrections.\nFinally, we emphasize the importance of smoothing in\nthe local model. Owing to the fact that the smoothing scale\nassociated with the halo/galaxy distribution in question is\nnot known a priori, it must be treated as a nuisance parameter and so marginalized over.\nAn alternative strategy for recovering information from\n\n\f18\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nhigher order statistics, which may be of interest for future\nconsideration, is the use of 'Gaussianizing transformations'\nor 'density clipping' (Neyrinck et al. 2009; Seo et al. 2011;\nSimpson et al. 2011). However, the theoretical connection\nbetween what is measured and what is interpreted from such\napproaches still remains to be fully calculated.\n\nACKNOWLEDGEMENTS\nWe thank the anonymous referee for helpful suggestions. We\nalso thank Tobias Baldauf, Martin Crocce, Roman Scoccimarro, Emiliano Sefussati, Ravi Sheth and Masahiro Takada\nfor useful discussions. We thank V. Springel for making\npublic GADGET-2 and for providing his B-FoF halo finder,\nand R. Scoccimarro for making public his 2LPT code. JEP\nand CP were supported by funding provided through the\nSFB-Transregio 33 The Dark Universe by the Deutsche\nForschungsgemeinschaft. RES acknowledges support from a\nMarie Curie Reintegration Grant, the Alexander von Humboldt Foundation and partial support from the Swiss National Foundation under contract 200021-116696/1.\n\nREFERENCES\nBaldauf T., Seljak U., Senatore L., 2011, Journal of Cosmology and Astro-Particle Physics, 4, 6\nBardeen J. M., Bond J. R., Kaiser N., Szalay A. S., 1986,\nApJ, 304, 15\nBernardeau F., Colombi S., Gazta\u00f1aga E., Scoccimarro R.,\n2002, Phys. Rep. , 367, 1\nBouchet F. R., Colombi S., Hivon E., Juszkiewicz R., 1995,\nA&A, 296, 575\nCatelan P., Porciani C., Kamionkowski M., 2000, MNRAS,\n318, L39\nColes P., 1993, MNRAS, 262, 1065\nCrocce M., Pueblas S., Scoccimarro R., 2006, MNRAS, 373,\n369\nDalal N., Dor\u00e9 O., Huterer D., Shirokov A., 2008, PRD,\n77, 123514\nDavis M., Efstathiou G., Frenk C. S., White S. D. M., 1985,\nApJ, 292, 371\nDekel A., Lahav O., 1999, ApJ, 520, 24\nDekel A., Rees M. J., 1987, Nature, 326, 455\nDesjacques V., Seljak U., Iliev I. T., 2009, MNRAS, 396,\n85\nFeldman H. A., Frieman J. A., Fry J. N., Scoccimarro R.,\n2001, Physical Review Letters, 86, 1434\nFry J. N., 1994, ApJ, 421, 21\nFry J. N., Gaztanaga E., 1993, ApJ, 413, 447\nFry J. N., Scherrer R. J., 1994, ApJ, 429, 36\nGazta\u00f1aga E., Norberg P., Baugh C. M., Croton D. J.,\n2005, MNRAS, 364, 620\nGazta\u00f1aga E., Scoccimarro R., 2005, MNRAS, 361, 824\nGoroff M. H., Grinstein B., Rey S.-J., Wise M. B., 1986,\nApJ, 311, 6\nGuo H., Jing Y. P., 2009, ApJ, 702, 425\nGuzik J., Bernstein G., Smith R. E., 2007, MNRAS, 375,\n1329\nHartlap J., Simon P., Schneider P., 2007, A&A, 464, 399\n\nHeavens A. F., Matarrese S., Verde L., 1998, MNRAS, 301,\n797\nHivon E., Bouchet F. R., Colombi S., Juszkiewicz R., 1995,\nA&A, 298, 643\nHockney R. W., Eastwood J. W., 1988, Computer simulation using particles. Bristol: Hilger, 1988\nJain B., Bertschinger E., 1994, ApJ, 431, 495\nJing Y. P., 2005, ApJ, 620, 559\nJoachimi B., Shi X., Schneider P., 2009, A&A, 508, 1193\nJuszkiewicz R., 1981, MNRAS, 197, 931\nKaiser N., 1984, ApJL, 284, L9\nKomatsu E., The WMAP Team 2010, ArXiv e-prints\nKomatsu E., Dunkley J., Nolta M. R., Bennett C. L., Gold\nB., Hinshaw G., Jarosik N., Larson D., Limon M., Page L.,\nSpergel D. N., Halpern M., Hill R. S., Kogut A., Meyer\nS. S., Tucker G. S., Weiland J. L., Wollack E., Wright\nE. L., 2009, ApJS, 180, 330\nMakino N., Sasaki M., Suto Y., 1992, PRD, 46, 585\nManera M., Gazta\u00f1aga E., 2011, MNRAS, 415, 383\nManera M., Sheth R. K., Scoccimarro R., 2010, MNRAS,\n402, 589\nMarin F., 2010, ArXiv e-prints\nMatarrese S., Verde L., Heavens A. F., 1997, MNRAS, 290,\n651\nMatsubara T., 2011, PRD, 83, 083518\nMcBride C. K., Connolly A. J., Gardner J. P., Scranton\nR., Newman J. A., Scoccimarro R., Zehavi I., Schneider\nD. P., 2011, ApJ, 726, 13\nMo H. J., Jing Y. P., White S. D. M., 1997, MNRAS, 284,\n189\nMo H. J., White S. D. M., 1996, MNRAS, 282, 347\nNeyrinck M. C., Szapudi I., Szalay A. S., 2009, ApJL, 698,\nL90\nNishimichi T., Ohmuro H., Nakamichi M., Taruya A., Yahata K., Shirata A., Saito S., Nomura H., Yamamoto K.,\nSuto Y., 2007, Publications of Astronomical Society of\nJapan, 59, 1049\nNishimichi T., Taruya A., Koyama K., Sabiu C., 2010,\nJournal of Cosmology and Astro-Particle Physics, 7, 2\nNorberg P., Baugh C. M., Gazta\u00f1aga E., Croton D. J.,\n2009, MNRAS, 396, 19\nPadmanabhan N., White M., Norberg P., Porciani C., 2009,\nMNRAS, 397, 1862\nPeebles P. J. E., 1980, The large-scale structure of the\nuniverse. Research supported by the National Science\nFoundation. Princeton, N.J., Princeton University Press,\n1980. 435 p.\nPeebles P. J. E., Groth E. J., 1975, ApJ, 196, 1\nPillepich A., Porciani C., Hahn O., 2010, MNRAS, 402, 191\nPorciani C., Giavalisco M., 2002, ApJ, 565, 24\nRoth N., Porciani C., 2011, MNRAS, 415, 829\nScoccimarro R., 1998, MNRAS, 299, 1097\nScoccimarro R., 2000, ApJ, 544, 597\nScoccimarro R., Colombi S., Fry J. N., Frieman J. A., Hivon\nE., Melott A., 1998, ApJ, 496, 586\nScoccimarro R., Couchman H. M. P., Frieman J. A., 1999,\nApJ, 517, 531\nScoccimarro R., Feldman H. A., Fry J. N., Frieman J. A.,\n2001, ApJ, 546, 652\nScoccimarro R., Sheth R. K., Hui L., Jain B., 2001, ApJ,\n546, 20\nSefusatti E., 2009, PRD, 80, 123002\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\nSefusatti E., Crocce M., Pueblas S., Scoccimarro R., 2006,\nPRD, 74, 023522\nSefusatti E., Komatsu E., 2007, PRD, 76, 083004\nSeljak U., Sugiyama N., White M., Zaldarriaga M., 2003,\nPRD, 68, 083507\nSeljak U., Zaldarriaga M., 1996, ApJ, 469, 437\nSeo H.-J., Sato M., Dodelson S., Jain B., Takada M., 2011,\nApJL, 729, L11+\nSheth R. K., Lemson G., 1999, MNRAS, 304, 767\nSheth R. K., Tormen G., 1999, MNRAS, 308, 119\nSimpson F., Berian James J., Heavens A. F., Heymans C.,\n2011, ArXiv e-prints\nSmith R. E., 2009, MNRAS, pp 1337\u2013+\nSmith R. E., Hern\u00e1ndez-Monteagudo C., Seljak U., 2009,\nPRD, 80, 063528\nSmith R. E., Marian L., 2011, MNRAS, p. 1484\nSmith R. E., Scoccimarro R., Sheth R. K., 2007, PRD, 75,\n063512\nSmith R. E., Sheth R. K., Scoccimarro R., 2008, PRD, 78,\n023523\nSpringel V., 2005, MNRAS, 364, 1105\nVerde L., Heavens A. F., Percival W. J., Matarrese S., The\n2dFGRS Team 2002, MNRAS, 335, 432\nVishniac E. T., 1983, MNRAS, 203, 345\nWarren M. S., Abazajian K., Holz D. E., Teodoro L., 2006,\nApJ, 646, 881\nWhite S. D. M., Rees M. J., 1978, MNRAS, 183, 341\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n19\n\n\f20\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n\nAPPENDIX A: BISPECTRUM ESTIMATION: ALGORITHM\nBriefly, the algorithm that we employ is as follows: firstly the dark matter density field is computed by assigning the dark\nmatter particles to a cubical grid using the 'Cloud in Cell' (CIC) technique (Hockney & Eastwood 1988). Next the fast\nFourier transform (FFT) of the gridded density field is computed. Each Fourier mode is then corrected for convolution with\nthe Fourier mesh. We do this by dividing out from each mode, the Fourier transform of the window assignment function of\nthe CIC scheme (Hockney & Eastwood 1988; Jing 2005):\nY \u0014 sin(\u03c0ki /2kNy ) \u00152\n\u03b4g (k)\n; WCIC (k) \u2261\n,\n(A1)\n\u03b4(k) =\nWCIC (k)\n\u03c0ki /2kNy\ni=1,3\nwhere subscript g denotes gridded quantities, kNy = \u03c0Ng /L is the Nyquist frequency of the mesh and Ng is the number of\nFourier grid cells.\nThe estimator for the bispectrum can be written (Scoccimarro et al. 1998):\nZ 3\nV\u03bc2\nd q1 d3 q2 d3 q3\nb\nB(k\n(2\u03c0)3 \u03b4 D (q123 )\u03b4(q1 )\u03b4(q2 )\u03b4(q3 ) ,\n(A2)\n1 , k2 , \u03b8) =\nVB (k1 , k2 , \u03b8)\n(2\u03c0)3 (2\u03c0)3 (2\u03c0)3\n\nwhere V\u03bc is the sample volume (in our case the simulation volume), the normalization factor, VB , can be written as\n(Sefusatti et al. 2006; Joachimi et al. 2009)\nZ 3\n8\u03c0 2 k1 k2 k3\nd q1 d3 q2 d3 q3\n3 D\n(2\u03c0)\n\u03b4\n(q\n)\n\u2248\n(\u2206k)3 ,\n(A3)\nVB (k1 , k2 , \u03bc) \u2261\n123\n(2\u03c0)3 (2\u03c0)3 (2\u03c0)3\n(2\u03c0)6\nand we write in shorthand \u03b4 D (q1...n ) \u2261 \u03b4 D (q1 + . . . + qn ). A practical implementation of the above estimator may be achieved\nthrough (Smith et al. 2008):\nb d (k , k , \u03b8 ) =\nB\n1\n2 12\n\nV\u03bc2\nNtri (k1 , k2 , \u03b812 )\n\nNtri (k1 ,k2 ,\u03b812 )\n\nX\n\nRe[\u03b4(kn1 )\u03b4(kn2 )\u03b4(k\u2212n1 \u2212n2 )],\n\n(A4)\n\n(n1 ,n2 )\n\nwhere superscript d denotes discretized quantities; ni denotes an integer vector from the origin of the k-space to each mesh\npoint; (n1 , n2 ) represents a pair of integer vectors, which lie in thin shells centred on k1 and k2 and whose angular separation\nlies in a narrow angular bin centred on \u03b812 , and for which k3 = \u2212k1 \u2212 k2 . The upper limit of the sum Ntri (k1 , k2 , \u03b812 )\nrepresents the total number of triangles that have such a configuration.\nb is written as:\nThe estimator for the bin-averaged reduced bispectrum, Q,\nbd = B\nb d /Q\nb denom,d ,\nQ\n\n(A5)\n\nb denom,d is the estimator for the bin-averaged cyclical terms of the power spectrum generated from first computing the\nwhere Q\nb d . Note that we estimate the power spectra that enter into this product in a slightly different\nbin-averaged power-spectra, P\ni\nway than normal: we use only those modes that go into estimating the particular B triangle configuration to estimate\nb denom,d (k , k , \u03b8 ). Hence,\nQ\n1\n\nbd =\nP\ni\n\n2\n\n12\n\nNtri (k1 ,k2 ,\u03b812 )\n\nV\u03bc\nNtri (k1 , k2 , \u03b812 )\n\nX\n\n|\u03b4(kni )|2 ,\n\n(A6)\n\n(n1 ,n2 )\n\nb d is dependent on the angular bin, since, with |n | and |n | fixed, we still have\nwhere i \u2208 {1, 2, 3} and where P\n1\n2\n3\ncos \u03b812 = n1 * n2 /|n1 ||n2 | and the closure criterion implies n3 = \u2212n1 \u2212 n2 varies as function of \u03b812 . Therefore,\n\nb denom,d = P\nb dP\nbd bd bd bd bd\nQ\n1 2 + P 2P 3 + P 1P 3.\nd\n\n(A7)\n\nd\n\nThe estimates of B and Q are then corrected for discreteness, i.e. shot-noise. For the estimators of interest, the\ncorrections are (Peebles 1980; Smith et al. 2008):\nb\nP\nshot\n\nb\nB\nshot\n\ndenom\n\nb\nQ\nshot\n\n\u2261\n\u2261\n\u2261\n\n1/n ;\n\n(A8)\n\nbd + P\nb d ]/n \u2212 2/n2 ;\nbd + P\n[P\n1\n2\n3\nd\n\nd\n\nd\n\nb +P\nb +P\nb ]/n \u2212 3/n2 .\n2[P\n1\n2\n3\n\n(A9)\n(A10)\n\nShot-noise corrected estimates of the statistics are obtained:\n\u03c7 = \u03c7d \u2212 \u03c7shot ,\n\n(A11)\n\nb , B,\nb Q\nb denom } and where Q\nb = B/\nb Q\nb denom . Note that the above recipe corrects some typos that are present in\nwhere \u03c7 \u2208 {P\nSmith et al. (2008).\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n\n21\n\nAPPENDIX B: HALO CROSS-BISPECTRA IN THE LOCAL MODEL\nAs was shown in Eq. (15), at quadratic order, the local model of nonlinear biasing can be written as:\nZ 3\nb2 (M )\nd q1 d3 q1\n\u03b4h (k|R) = b1 (M )\u03b4(k|R) +\n\u03b4(q1 |R)\u03b4(q2 |R)(2\u03c0)3 \u03b4 D (k1 \u2212 q1 \u2212 q2 ) .\n2\n(2\u03c0)3 (2\u03c0)3\n\n(B1)\n\nwhere \u03b4(qi |R) \u2261 \u03b4(qi )W (qi R), is the filtered density. Using this model we may now proceed to calculate the halo auto- and\nhalo-mass cross-bispectra.\nB1\n\nHalo-mass-mass bispectrum in the local model\n\nLet us start with the simplest three-point cross-statistic, the halo-matter-matter bispectrum, this can be written:\nh\u03b4h (k1 |M, R)\u03b4(k2 |R)\u03b4(k3 |R)i\n\n=\n\nb1 (M ) h\u03b4(k1 |R)\u03b4(k2 |R)\u03b4(k3 |R)i\nZ 3\nb2 (M )\nd q1 d3 q1\n+\n(2\u03c0)3 \u03b4 D (k1 \u2212 q1 \u2212 q2 ) h\u03b4(q1 |R)\u03b4(q2 |R)\u03b4(k1 |R)\u03b4(k2 |R)i .\n2\n(2\u03c0)3 (2\u03c0)3\n\n(B2)\n\nLet us define the smoothed n-point spectra as:\nh\u03b4(k1 |R) . . . \u03b4(kn |R)i\n\n\u2261\n=\n\nen (k1 , . . . , kn |R) ,\n(2\u03c0)3 \u03b4(k1 + . . . + kn )P\n\n(2\u03c0)3 \u03b4(k1 + . . . + km )W (k1 R) . . . W (kn R)Pn (k1 , . . . , kn )\n\n(B3)\n\ne2 \u2261 P\ne = W 2 (kR)P , P\ne3 \u2261 Be = W (k1 R)W (k2 R)W (k3 R)B, and where P\ne4 \u2261 Te = W (k1 R)W (k2 R)W (k3 R)W (k4 R)T .\nwhere P\nWe may now integrate over q2 to obtain\n\u0015\n\u0014\nZ 3\nd q1 e\nb2 (M )\n3 D\ne\nT (q1 , k1 \u2212 q1 , k2 , k3 ) . (B4)\nh\u03b4h (k1 |M, R)\u03b4(k2 |R)\u03b4(k3 |R)i = (2\u03c0) \u03b4 (k1 + k2 + k3 ) b1 (M )B(k1 , k2 , k3 ) +\n2\n(2\u03c0)3\nOn dividing the above expression by W (k1 R)W (k2 R)W (k3 R), then we find the halo-mass-mass bispectrum can be written as\nZ 3\nb2 (M )\nd q1 f\nBhmm (k1 , k2 , k3 ) = b1 (M )Bmmm (k1 , k2 , k3 ) +\nWq1 ,k1 \u2212q1 Tmmmm (q1 , k1 \u2212 q1 , k2 , k3 ) .\n(B5)\n2\n(2\u03c0)3\nWe may symmetrize the above result by constructing the sum [Bhmm + Bmhm + Bmmh ]/3, and this gives us:\nZ 3\ni\nb2 (M )\nd q1 h f\nBhmm (k1 , k2 , k3 ) = b1 (M )Bmmm (k1 , k2 , k3 ) +\nWq1 ,k1 \u2212q1 Tmmmm (q1 , k1 \u2212 q1 , k2 , k3 ) + 2 cyc\n3\n6\n(2\u03c0)\n\n(B6)\n\nOn expanding B and T to fourth order in \u03b4, the above expression can be approximated as,\ni\nb2 (M ) h f\n(0)\n(0)\n(0)\nWk2 ,k3 P (0) (k2 )Pmm\n(k3 ) + 2 cyc .\n(B7)\nBhmm (k1 , k2 , k3 ) \u2248 b1 (M )Bmmm\n(k1 , k2 , k3 ) +\n3\nFinally, in the large-scale limit ki \u2192 0, or for arbitrarily small smoothing scales, ki R \u226a 1, the above expression becomes,\ni\nb2 (M ) h (0)\n(0)\n(0)\n(0)\nBhmm (k1 , k2 , k3 ) \u2248 b1 (M )Bmmm\n(k1 , k2 , k3 ) +\nPmm (k2 )Pmm\n(k3 ) + 2 cyc\n(B8)\n3\nThe reduced bispectrum Qhmm is given by\nQhmm (k1 , k2 , k3 ) \u2261\n\nBhmm (k1 , k2 , k3 )\n,\nP Phmm\n\n(B9)\n\nwhere\n2\n1\n[Phm (k1 )Pmm (k2 ) + 2 cyc ] + [Phm (k1 )Phm (k2 ) + 2 cyc ] .\n(B10)\n3\n3\nIn order to calculate the reduced halo-mass cross-bispectrum, then we need to evaluate the halo-matter power spectrum.\nIn the local model and up to quadratic order in the bias we have,\nZ 3\nb2 (M )\nd q1 f\nPhm (k) = b1 (M )Pmm (k1 ) +\nWq1 ,k1 \u2212q1 Bmmm (q1 , k1 \u2212 q1 , \u2212k1 ) .\n(B11)\n2\n(2\u03c0)3\n\nP Phmm =\n\nUsing the above expression in Eq. (B10) we find\n\u001a \u0014\n\u0015\n\u001b\nZ 3\nb2 (M )\n2\nd q1 f\nP Phmm (k1 , k2 , k3 ) =\nb1 (M )Pmm (k1 ) +\nW\nB\n(q\n,\nk\n\u2212\nq\n,\n\u2212k\n)\nP\n(k\n)\n+\n2\ncyc\nmmm\n1\n1\n1\n1\nmm\n2\nq\n,k\n\u2212q\n1 1\n1\n3\n2\n(2\u03c0)3\n\u0015\n\u001a\u0014\nZ 3\nd q1 f\nb2 (M )\n1\nW\nB\n(q\n,\nk\n\u2212\nq\n,\n\u2212k\n)\nb1 (M )Pmm (k1 ) +\n+\nmmm\n1\n1\n1\n1\nq\n,k\n\u2212q\n1\n1\n1\n3\n2\n(2\u03c0)3\n\u0015\n\u001b\n\u0014\nZ 3\nb2\nd q1 f\nW\nB\n(q\n,\nk\n\u2212\nq\n,\n\u2212k\n)\n+\n2\ncyc\n(B12)\n\u00d7 b1 (M )Pmm (k2 ) +\nmmm\n2\n2\n2\n2\nq\n,k\n\u2212q\n2 2\n2\n2\n(2\u03c0)3\nIf we expand P Phmm to fourth order in the density then the above expression simplifies to:\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f22\n\nJ. E. Pollack, R. E. Smith & C. Porciani\n(0)\n\nP Phmm (k1 , k2 , k3 ) \u2248\nHence we have,\n(0)\nQhmm (k1 , k2 , k3 )\n\nh\ni\nb1 (M )\n(0)\n(0)\n[2 + b1 (M )] Pmm\n(k1 )Pmm\n(k2 ) + 2 cyc .\n3\n\n3\nb2 (M )\n\u2248\nQ(0) (k1 , k2 , k3 ) +\n2 + b1 (M ) mmm\n2b1 (M ) + b21 (M )\n\n\"\n\n(B13)\n\n(0)\n(0)\nfk ,k Pmm\n(k1 )Pmm (k2 ) + 2 cyc\nW\n1 2\n(0)\n\n(0)\n\nPmm (k1 )Pmm (k2 ) + 2 cyc\n\n#\n\nf \u2192 1 and the above result can be approximated by\nFinally, in the limit that ki R \u226a 1, W\n(0)\n\nQhmm (k1 , k2 , k3 ) \u2248\n\nB2\n\n3\nb2 (M )\nQ(0) (k1 , k2 , k3 ) +\n.\n2 + b1 (M ) mmm\n2b1 (M ) + b21 (M )\n\n(B14)\n\n(B15)\n\nHalo-halo-mass bispectrum in the local model\n\nAgain, using Eq. (B1), the halo-halo-mass bispectrum, symmetrized in the ki arguments, can be written:\nZ 3\ni\nb1 (M )b2 (M )\nd q1 h f\nBhhm (k1 , k2 , k3 ) = b21 (M )Bmmm (k1 , k2 , k3 ) +\nW\nT\n(q\n,\nk\n\u2212\nq\n,\nk\n,\nk\n)\n+\n2\ncyc\nmmmm\n1\n1\n1\n2\n3\nq\n,k\n\u2212q\n1\n1\n1\n3\n(2\u03c0)3\nZ 3\nh\ni\n2\n3\nd q1 d q2 f\nb (M )\nfq ,k \u2212q P5,m (q1 , k1 \u2212 q1 , q2 , k2 \u2212 q2 , k3 ) + 2 cyc .\nWq1 ,k1 \u2212q1 W\n(B16)\n+ 2\n2 2\n2\n3\n3\n12\n(2\u03c0) (2\u03c0)\n\nIf we use perturbation theory to expand P , B, T and P5 , and only keep terms that are 4th order in the density field, then the\nabove expression can be approximated by:\nh\ni\n1\n(0)\n(0)\n(0)\n(0)\nfk1 ,k2 Pmm\nBhhm (k1 , k2 , k3 ) \u2248 b21 (M )Bmmm\n(k1 , k2 , k3 ) + b1 (M )b2 (M ) W\n(k1 )Pmm\n(k2 ) + 2 cyc .\n(B17)\n3\nIn the large-scale limit ki R \u2192 0, the above expression can be approximated as:\nh\ni\n1\n(0)\n(0)\n(0)\n(0)\n(k1 )Pmm\n(k2 ) + 2 cyc .\n(B18)\nBhhm (k1 , k2 , k3 ) \u2248 b21 (M )Bmmm\n(k1 , k2 , k3 ) + b1 (M )b2 (M ) Pmm\n3\nThe reduced bispectrum is given by,\nQhhm(k1 , k2 , k3 ) \u2261\n\nBhhm (k1 , k2 , k3 )\n,\nP Phhm\n\n(B19)\n\nwhere\n1\n2\n[Phh (k1 )Phm (k2 ) + 2 cyc ] + [Phm (k1 )Phm (k2 ) + 2 cyc ] .\n3\n3\nThe halo-mass power spectrum is given by Eq. (B11) and the halo auto-power spectrum is given by:\nZ 3\nd q1 f\nPhh (k) = b21 (M )Pmm (k1 ) + b1 (M )b2 (M )\nWq1 ,k1 \u2212q1 Bmmm (q1 , k1 \u2212 q1 , \u2212k1 )\n(2\u03c0)3\nZ\nd3 q1 d3 q2 f\nb2 (M )\nfq ,\u2212k \u2212q Tmmmm (q1 , k1 \u2212 q1 , q2 , \u2212k1 \u2212 q2 ) .\n+ 2\nWq1 ,k1 \u2212q1 W\n2\n1\n2\n4\n(2\u03c0)3 (2\u03c0)3\n\nP Phhm =\n\nExpanding the above expression to lowest order in perturbation theory gives,\nh\ni\n2b2 (M )\n(0)\n(0)\n(0)\n[2b1 (M ) + 1] Pmm\n(k1 )Pmm\n(k2 ) + 2 cyc .\nP Phhm \u2248 1\n3\nUsing the above expression, we find that the tree-level expression for the reduced bispectrum can be written:\n\"\n#\n(0)\n(0)\nfk ,k Pmm\n(k1 )Pmm (k2 ) + 2 cyc\nW\n3\n2b2 (M )\n(0)\n(0)\n1 2\nQhhm(k1 , k2 , k3 ) \u2248\nQ\n(k1 , k2 , k3 ) + 2\n.\n(0)\n(0)\n2b1 (M ) + 1 mmm\n2b1 (M ) + b1 (M )\nPmm (k1 )Pmm (k2 ) + 2 cyc\nf \u2192 1 and\nIn the large-scale limit ki R \u2192 0, we again have W\n(0)\n\nQhhm(k1 , k2 , k3 ) \u2248\n\nB3\n\n2b2 (M )\n3\nQ(0) (k1 , k2 , k3 ) + 2\n.\n2b1 (M ) + 1 mmm\n2b1 (M ) + b1 (M )\n\n(B20)\n\n(B21)\n\n(B22)\n\n(B23)\n\n(B24)\n\nHalo-halo-halo bispectrum in the local model\n\nAgain using Eq. (B1), the halo-halo-halo bispectrum, symmetrized in the ki arguments, can be written:\nZ 3\ni\n1\nd q1 h f\nBhhh (k1 , k2 , k3 ) = b31 (M )Bmmm (k1 , k2 , k3 ) + b21 (M )b2 (M )\nW\nT\n(q\n,\nk\n\u2212\nq\n,\nk\n,\nk\n)\n+\n2\ncyc\nmmmm\n1\n1\n1\n2\n3\nq\n,k\n\u2212q\n1 1\n1\n2\n(2\u03c0)3\nZ 3\nh\ni\n3\n1\nd q1 d q2 f\nfq2 ,k2 \u2212q2 P5,m (q1 , k1 \u2212 q1 , q2 , k2 \u2212 q2 , k3 ) + 2 cyc\n+ b1 b22\nWq1 ,k1 \u2212q1 W\n3\n3\n4\n(2\u03c0) (2\u03c0)\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fModelling halo bias using the bispectrum\n+\n\nb32\n8\n\nZ\n\n23\n\nd3 q1 d3 q2 d3 q3 f\nfq ,k \u2212q W\nfq ,k \u2212q P6,m (q1 , k1 \u2212 q1 , q2 , k2 \u2212 q2 , q3 , k3 \u2212 q3 ) .\nWq1 ,k1 \u2212q1 W\n2 2\n2\n3 3\n3\n(2\u03c0)3 (2\u03c0)3 (2\u03c0)3\n(B25)\n\nIf we use perturbation theory to expand P , B, T , P5 , and P6 , and keep only terms that are fourth order in the density field,\nthen the above expression can be approximated by:\nh\ni\n(0)\n(0)\n(0)\n(0)\nfk ,k Pmm\nBhhh (k1 , k2 , k3 ) \u2248 b31 (M )Bmmm\n(k1 , k2 , k3 ) + b21 (M )b2 (M ) W\n(k1 )Pmm\n(k2 ) + 2 cyc .\n(B26)\n1 2\n\nIn the large-scale limit ki R \u2192 0, the above expression can be approximated as:\nh\ni\n(0)\n(0)\n(0)\n(0)\nBhhh (k1 , k2 , k3 ) \u2248 b31 (M )Bmm\n(k1 , k2 , k3 ) + b21 (M )b2 (M ) Pmm\n(k1 )Pmm\n(k2 ) + 2 cyc .\n\n(B27)\n\nThe reduced halo-halo-halo bispectrum is given by,\n\nQhhh (k1 , k2 , k3 ) \u2261\n\nBhhh (k1 , k2 , k3 )\n,\nP Phhh\n\n(B28)\n\nwhere\nP Phhh = [Phh (k1 )Phh (k2 ) + 2 cyc ] ,\n\n(B29)\n\nwhere the halo auto-power spectrum is given by Eq. (B21). On expanding the above expression to fourth order in the density\nwe find,\nh\ni\n(0)\n(0)\n(0)\nP Phhh \u2248 b41 (M ) Pmm\n(k1 )Pmm\n(k2 ) + 2 cyc .\n(B30)\nUsing the above expression, we find that the tree-level expression for the reduced bispectrum can be written:\n\"\n#\n(0)\n(0)\nfk1 ,k2 Pmm\n(k1 )Pmm (k2 ) + 2 cyc\nb2 (M ) W\n1\n(0)\n(0)\nQmmm (k1 , k2 , k3 ) + 2\nQhhh (k1 , k2 , k3 ) \u2248\n.\n(0)\n(0)\nb1 (M )\nb1 (M )\nPmm (k1 )Pmm (k2 ) + 2 cyc\n\nf \u2192 1 and\nIn the large-scale limit ki R \u2192 0, we again have W\n(0)\n\nQhhh (k1 , k2 , k3 ) \u2248\n\n1\nb2 (M )\nQ(0) (k1 , k2 , k3 ) + 2\n.\nb1 (M ) mmm\nb1 (M )\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n(B31)\n\n(B32)\n\n\f"}