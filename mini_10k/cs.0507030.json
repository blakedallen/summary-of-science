{"id": "http://arxiv.org/abs/cs/0507030v2", "guidislink": true, "updated": "2006-06-21T10:01:37Z", "updated_parsed": [2006, 6, 21, 10, 1, 37, 2, 172, 0], "published": "2005-07-11T20:06:06Z", "published_parsed": [2005, 7, 11, 20, 6, 6, 0, 192, 0], "title": "Strictly convex drawings of planar graphs", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cs%2F0507069%2Ccs%2F0507006%2Ccs%2F0507064%2Ccs%2F0507057%2Ccs%2F0507031%2Ccs%2F0507015%2Ccs%2F0507020%2Ccs%2F0507012%2Ccs%2F0507043%2Ccs%2F0507021%2Ccs%2F0507038%2Ccs%2F0507008%2Ccs%2F0507046%2Ccs%2F0507027%2Ccs%2F0507068%2Ccs%2F0507047%2Ccs%2F0507058%2Ccs%2F0507063%2Ccs%2F0507030%2Ccs%2F0507062%2Ccs%2F0507028%2Ccs%2F0507004%2Ccs%2F0507059%2Ccs%2F0507071%2Ccs%2F0507070%2Ccs%2F0507016%2Ccs%2F0507066%2Ccs%2F0507022%2Ccs%2F0507041%2Ccs%2F0507023%2Ccs%2F0507032%2Ccs%2F0507002%2Ccs%2F0507042%2Ccs%2F0507019%2Ccs%2F0507013%2Ccs%2F0507035%2Ccs%2F0507017%2Ccs%2F0507073%2Ccs%2F0507009%2Ccs%2F0507065%2Ccs%2F0507034%2Ccs%2F0507055%2Ccs%2F0507039%2Ccs%2F0507029%2Ccs%2F0507051%2Ccs%2F0507014%2Ccs%2F0507045%2Ccs%2F0507025%2Ccs%2F0507026%2Ccs%2F0507049%2Ccs%2F0507067%2Ccs%2F0507056%2Ccs%2F0507033%2Ccs%2F0008033%2Ccs%2F0008004%2Ccs%2F0008022%2Ccs%2F0008007%2Ccs%2F0008008%2Ccs%2F0008031%2Ccs%2F0008002%2Ccs%2F0008005%2Ccs%2F0008020%2Ccs%2F0008006%2Ccs%2F0008015%2Ccs%2F0008025%2Ccs%2F0008001%2Ccs%2F0008035%2Ccs%2F0008010%2Ccs%2F0008011%2Ccs%2F0008026%2Ccs%2F0008028%2Ccs%2F0008017%2Ccs%2F0008014%2Ccs%2F0008018%2Ccs%2F0008027%2Ccs%2F0008024%2Ccs%2F0008023%2Ccs%2F0008036%2Ccs%2F0008013%2Ccs%2F0008032%2Ccs%2F0008019%2Ccs%2F0008003%2Ccs%2F0008016%2Ccs%2F0008021%2Ccs%2F0008034%2Ccs%2F0008029%2Ccs%2F0008012%2Ccs%2F0008030%2Ccs%2F0008009%2Ccs%2F0508113%2Ccs%2F0508065%2Ccs%2F0508127%2Ccs%2F0508061%2Ccs%2F0508131%2Ccs%2F0508066%2Ccs%2F0508036%2Ccs%2F0508022%2Ccs%2F0508005%2Ccs%2F0508110%2Ccs%2F0508045%2Ccs%2F0508096&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Strictly convex drawings of planar graphs"}, "summary": "Every three-connected planar graph with n vertices has a drawing on an O(n^2)\nx O(n^2) grid in which all faces are strictly convex polygons. These drawings\nare obtained by perturbing (not strictly) convex drawings on O(n) x O(n) grids.\nMore generally, a strictly convex drawing exists on a grid of size O(W) x\nO(n^4/W), for any choice of a parameter W in the range n<W<n^2. Tighter bounds\nare obtained when the faces have fewer sides.\n  In the proof, we derive an explicit lower bound on the number of primitive\nvectors in a triangle.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cs%2F0507069%2Ccs%2F0507006%2Ccs%2F0507064%2Ccs%2F0507057%2Ccs%2F0507031%2Ccs%2F0507015%2Ccs%2F0507020%2Ccs%2F0507012%2Ccs%2F0507043%2Ccs%2F0507021%2Ccs%2F0507038%2Ccs%2F0507008%2Ccs%2F0507046%2Ccs%2F0507027%2Ccs%2F0507068%2Ccs%2F0507047%2Ccs%2F0507058%2Ccs%2F0507063%2Ccs%2F0507030%2Ccs%2F0507062%2Ccs%2F0507028%2Ccs%2F0507004%2Ccs%2F0507059%2Ccs%2F0507071%2Ccs%2F0507070%2Ccs%2F0507016%2Ccs%2F0507066%2Ccs%2F0507022%2Ccs%2F0507041%2Ccs%2F0507023%2Ccs%2F0507032%2Ccs%2F0507002%2Ccs%2F0507042%2Ccs%2F0507019%2Ccs%2F0507013%2Ccs%2F0507035%2Ccs%2F0507017%2Ccs%2F0507073%2Ccs%2F0507009%2Ccs%2F0507065%2Ccs%2F0507034%2Ccs%2F0507055%2Ccs%2F0507039%2Ccs%2F0507029%2Ccs%2F0507051%2Ccs%2F0507014%2Ccs%2F0507045%2Ccs%2F0507025%2Ccs%2F0507026%2Ccs%2F0507049%2Ccs%2F0507067%2Ccs%2F0507056%2Ccs%2F0507033%2Ccs%2F0008033%2Ccs%2F0008004%2Ccs%2F0008022%2Ccs%2F0008007%2Ccs%2F0008008%2Ccs%2F0008031%2Ccs%2F0008002%2Ccs%2F0008005%2Ccs%2F0008020%2Ccs%2F0008006%2Ccs%2F0008015%2Ccs%2F0008025%2Ccs%2F0008001%2Ccs%2F0008035%2Ccs%2F0008010%2Ccs%2F0008011%2Ccs%2F0008026%2Ccs%2F0008028%2Ccs%2F0008017%2Ccs%2F0008014%2Ccs%2F0008018%2Ccs%2F0008027%2Ccs%2F0008024%2Ccs%2F0008023%2Ccs%2F0008036%2Ccs%2F0008013%2Ccs%2F0008032%2Ccs%2F0008019%2Ccs%2F0008003%2Ccs%2F0008016%2Ccs%2F0008021%2Ccs%2F0008034%2Ccs%2F0008029%2Ccs%2F0008012%2Ccs%2F0008030%2Ccs%2F0008009%2Ccs%2F0508113%2Ccs%2F0508065%2Ccs%2F0508127%2Ccs%2F0508061%2Ccs%2F0508131%2Ccs%2F0508066%2Ccs%2F0508036%2Ccs%2F0508022%2Ccs%2F0508005%2Ccs%2F0508110%2Ccs%2F0508045%2Ccs%2F0508096&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Every three-connected planar graph with n vertices has a drawing on an O(n^2)\nx O(n^2) grid in which all faces are strictly convex polygons. These drawings\nare obtained by perturbing (not strictly) convex drawings on O(n) x O(n) grids.\nMore generally, a strictly convex drawing exists on a grid of size O(W) x\nO(n^4/W), for any choice of a parameter W in the range n<W<n^2. Tighter bounds\nare obtained when the faces have fewer sides.\n  In the proof, we derive an explicit lower bound on the number of primitive\nvectors in a triangle."}, "authors": ["Imre Barany", "Guenter Rote"], "author_detail": {"name": "Guenter Rote"}, "author": "Guenter Rote", "arxiv_comment": "20 pages, 13 figures. to be published in Documenta Mathematica. The\n  revision includes numerous small additions, corrections, and improvements, in\n  particular: - a discussion of the constants in the O-notation, after the\n  statement of thm.1. - a different set-up and clarification of the case\n  distinction for Lemma 1", "links": [{"href": "http://arxiv.org/abs/cs/0507030v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/cs/0507030v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cs.CG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cs.CG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cs.DM", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "F.2.2; G.2.2", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/cs/0507030v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/cs/0507030v2", "journal_reference": "DOCUMENTA MATHEMATICA, Vol. 11 (2006), 369-391", "doi": null, "fulltext": "Strictly Convex Drawings of Planar Graphs\nImre B\u00e1r\u00e1ny\u2217\n\nG\u00fcnter Rote\u2020\n\narXiv:cs/0507030v2 [cs.CG] 21 Jun 2006\n\nJune 28, 2018\n\nAbstract\nEvery three-connected planar graph with n vertices has a drawing on an O(n2 )\u00d7O(n2 )\ngrid in which all faces are strictly convex polygons. These drawings are obtained by\nperturbing (not strictly) convex drawings on O(n) \u00d7 O(n) grids. Tighter bounds are\nobtained when the faces have fewer sides. In the proof, we derive an explicit lower bound\non the number of primitive vectors in a triangle.\n\n1\n\nIntroduction\n\nA strictly convex drawing of a planar graph is a drawing with straight edges in which all faces,\nincluding the outer face, are strictly convex polygons, i. e., polygons whose interior angles are\nless than 180\u25e6 .\nTheorem 1. (i) A three-connected planar graph with n vertices in which every face has\nat most k edges has a strictly convex drawing on an O(nw) \u00d7 O(n2 k/w) grid of area\nO(n3 k), for any choice of a parameter w in the range 1 \u2264 w \u2264 k.\n(ii) In particular, every three-connected planar graph with n vertices has a strictly convex\ndrawing on an O(n2 ) \u00d7 O(n2 ) grid, and on an O(n) \u00d7 O(n3 ) grid.\n(iii) For k \u2264 4, an O(n) \u00d7 O(n) grid suffices.\nThe drawings can be constructed in linear time.\nWhen referring to a W \u00d7 H grid of width W and height H, the constant hidden in the\nO-notation is on the order of 100 for the width and on the order of 10000 for the height. This\nis far too much for applications where one wants to draw graphs on a computer screen, for\nexample. For the case w = 1, the bound is tighter: the grid size is approximately 14n\u00d730n2 k.\nFor part (iii) of the theorem, the grid size is at most 14n \u00d7 14n, and if the outer face is a\ntriangle, it is 2n \u00d7 2n.\nThe main idea of the proof is to start with a (non-strictly) convex embedding, in which\nangles of 180\u25e6 are allowed, and to perturb the vertices to obtain strict convexity. We will use\nan embedding with special properties that is provided by the so-called Schnyder embeddings,\nwhich are introduced in Section 2.\n\u2217\nR\u00e9nyi Institute, Hungarian Academy of Sciences, PoB 127, Budapest 1364, Hungary, barany@renyi.hu,\nand Mathematics, University College London, Gower Street, London WC1E 6BT, UK.\n\u2020\nFreie Universit\u00e4t Berlin, Institut f\u00fcr Informatik, Takustrasse 9, 14195 Berlin, Germany, rote@inf.fuberlin.de\n\n1\n\n\fHistoric context. The problem of drawing graphs with straight lines has a long history.\nIt is related to realizing three-connected planar graphs as three-dimensional polyhedra. By\na suitable projection on a plane, one obtains from a polyhedron a straight-line drawing, a\nso-called Schlegel diagram. The faces in such a drawing are automatically strictly convex. By\na projective transformation, it can be arranged that the projection along a coordinate axis\nis possible, and hence a suitable realization as a grid polytope gives rise to a grid drawing\nof the graph. However, the problem of realizing a graph as a polytope is more restricted:\nnot every drawing with strictly convex faces is the projection of a polytope. In fact, there is\nan exponential gap between the known grid size for strictly convex planar drawings and for\npolytopes in space.\nThe approaches for realizing a graph as a polytope or for drawing it in the plane come\nin several flavors. The classical methods of Steinitz (for polytopes) and F\u00e1ry and Wagner\n(for graphs) work incrementally, making local modifications to the graph and adapting the\ngeometric structure accordingly. Tutte [15, 16] gave a \"one-shot\" approach for drawing graphs\nthat sets up a system of equations. This method yields also a polytope via the MaxwellCremona correspondence, see [11]. All these methods give embeddings that can be drawn on\nan integer grid but require an exponential grid size (or even larger, if one is not careful).\nThe first methods for straight-line drawings of graphs on an O(n) \u00d7 O(n) grid were proposed for triangulated graphs, independently by de Fraysseix, Pach and Pollack [7] and by\nSchnyder [13]. The method of de Fraysseix, Pach and Pollack [7] is incremental: it inserts\nvertices in a special order, and modifies a partial grid drawing to accommodate new vertices.\nIn contrast, Schnyder's method is another \"one-shot\" method: it constructs some combinatorial structure in the graph, from which the coordinates of the embedding can be readily\ndetermined afterwards. Both methods work in linear time. O(n) \u00d7 O(n) is still the best\nknown asymptotic bound on the size of planar grid drawings.\nIf graphs are not triangulated, the first challenge is to get faces which are convex. (Without\nthe convexity requirement one can just add edges until the graph becomes triangulated, draw\nthe triangulated supergraph and remove the extra edges from the drawing.) Many algorithms\nare now known that construct convex (but not necessarily strictly convex) drawings with\nO(n) \u00d7 O(n) size, for example by Chrobak and Kant [5] (\u00e0 la Fraysseix, Pach and Pollack); or\nSchnyder and Trotter [14] and Felsner [8], see also [4] (\u00e0 la Schnyder). Our algorithm builds\non the output of Felsner's algorithm, which is described in the next section. Luckily, this\nembedding has some special features, which our algorithm uses.\nThe idea of getting a strictly convex drawing by perturbing a convex drawing was pioneered by Chrobak, Goodrich and Tamassia [6]. They claimed to construct strictly convex\nembeddings on an O(n3 )\u00d7O(n3 ) grid, without giving full details, however. This was improved\nto O(n7/3 ) \u00d7 O(n7/3 ) in [12]. In this paper we further improve the \"fine perturbation\" step\nof [12] to obtain a bound of O(n2 ) \u00d7 O(n2 ) for grid drawings. Theorem 1 gives better bounds\nwhen the faces have few sides, and we allow grids of different aspect ratios (keeping the same\ntotal area).\nIn the course of the proof, we need explicit (not just asymptotic) lower bounds on the\nnumber of primitive vectors in certain triangles. A primitive vector is an integer vector which\nis not a multiple of another integer vector; hence, primitive vectors can be used to characterize\nthe directions of polygon edges. The existence of many short primitive vectors is the key to\nconstructing strictly convex polygons with many sides. These lower bounds are derived in\nSection 5, based on elementary techniques from the geometry of numbers.\n\n2\n\n\f2\n\nPreliminaries: Schnyder Embeddings of Three-Connected\nPlane Graphs\n\nFelsner [8] (see also [9, 4]) has extended the straight-line drawing algorithm of Schnyder, which\nworks for triangulated planar graphs, to arbitrary three-connected graphs. It constructs a\ndrawing with very special properties, beyond just having convex faces. These properties will\nbe crucial for the perturbation step.\nFelsner's algorithm works roughly as follows. The edges of the graph are covered by three\ndirected trees which are rooted at three selected vertices a, b, c on the boundary, forming a\nSchnyder wood. The three trees define for each vertex v three paths from v to the respective\nroot, which partition the graph into three regions. Counting the faces in each region gives\nthree numbers x, y, z which can be used as barycentric coordinates for the point v with respect\nto the points a, b, and c. Selecting abc as an equilateral triangle of side length f \u2212 1 (the\nnumber of interior faces of the graph) yields vertices which lie on a hexagonal grid formed by\nequilateral triangles of side length 1, see Figure 1a. Since f \u2264 2n this yields a drawing on a\ngrid of size 2n \u00d7 2n.\nc\n\na\n\nb\n(a)\n\n(b)\n\nFigure 1: (a) A Schnyder embedding on a hexagonal grid and (b) on the refined grid after\nthe initial (rough) perturbation\nThis straight-line embedding has the following important property (see [8, Lemma 4 and\nFigure 11], [4, Fact 5]):\nThe Three Wedges Property. Every vertex except the corners a, b, c has exactly\none incident edge in each of the three closed 60\u25e6 wedges shown in Figure 2a.\nFrom this it follows immediately that there can be no angle larger than 180\u25e6 , and hence all\nfaces are convex. Moreover, it follows that the interior faces F have the Enclosing Triangle\nProperty, see Figure 4a ([8, proof of Lemma 7], [4, Lemma 2]):\nThe Enclosing Triangle Property. Consider the line x = const through the point\nof F with maximum x-coordinate, and similarly for the other three coordinate\n3\n\n\fdirections. These three lines form a triangle TF which encloses F . Then all\nvertices of F lie on the boundary of TF , but F contains none of the vertices of TF .\nIt follows that interior faces with k \u2264 4 sides are already strictly convex. Throughout, we\nwill call TF the enclosing triangle of the face F .\nThe Schnyder wood and the coordinates of the points can be calculated in linear time.\nRecently, Bonichon, Felsner, and Mosbah [4], have improved the grid size to (n \u2212 2) \u00d7 (n \u2212 2).\nHowever, the resulting drawing does not have the Three Wedges Property. An alternative\nalgorithm for producing an embedding with a property similarly to the Enclosing Triangle\nProperty is sketched in Chrobak, Goodrich and Tamassia [6]. It proceeds incrementally in the\nspirit of the algorithm of de Fraysseix, Pach and Pollack [7] and takes linear time. From the\ndetails given in [6] it is not clear whether the embedding has also the Three Wedges Property,\nwhich we need for our algorithm. The original algorithm of Chrobak and Kant [5] achieves\na weak form of the Three Wedges Property, where F is permitted to contain vertices of TF .\nMaybe, this algorithm can be modified to obtain the Three Wedges Property, at the expense\nof a constant-factor blow-up in the grid size.\n\nv\n\nv\n\n150\u25e6\n(a)\n\n(b)\n\nFigure 2: (a) Each closed shaded wedge contains exactly one edge incident to v. There may\nbe additional edges in the interior of the white sectors. (b) A typical situation at a vertex\nwhich is perturbed.\n\nFigure 3: The three possible new positions for a single vertex in the rough perturbation.\n(Only the three boundary vertices a, b, c are pushed in directions opposite to these.)\n\n3\n\nRough Perturbation\n\nBefore making all faces strictly convex, we perform an initial perturbation on a refined grid\nwhich is smaller by only a constant factor. This preparatory step will ensure that the subsequent \"fine perturbation\" can treat each face independently.\n4\n\n\f?\n?\nTF\n\nF\n\n?\n\n(a)\n\n(b)\n\n(c)\n\nFigure 4: (a) A typical face F constructed by the convex embedding algorithm. (b) The new\npositions of the vertices of F which are pushed out are indicated. (c) The result of the rough\nperturbation. The perturbation of the vertices with question marks depends on the other\nfaces incident to these vertices.\n\nWe overlay a triangular grid which is scaled by a factor of 1/7, see Figures 3 and 5. A\npoint\n\u221a may be moved to one of the three possible positions shown in Figure 3, by a distance\nof 3/7. The precise rules are as follows: A vertex v on an interior face F is moved if and\nonly if the following two conditions hold.\n(i) The interior angle of F at v is larger than 150\u25e6 (including the possibility of a straight\nangle of 180\u25e6 ); and\n(ii) v is incident to an edge of F which lies on the enclosing triangle TF .\nSee Figure 2b for a typical case. Such a vertex is then pushed \"out\", perpendicular to the\nedge of TF . We call the angle between the two edges incident to F and v the critical angle\nof v. For a boundary vertex different from a, b, c, the exterior angle is the critical angle, but\nthese vertices are not subject to the rough perturbation. The three corners a, b, and c are\ntreated specially: they are pushed straight into the triangle by the rough perturbation, as\nillustrated in Figure 1. Examples can be seen in Figure 4b\u2013c and Figure 5. The result of\n\nFigure 5: Example of the rough perturbation.\nperturbing the example in Figure 1a is shown in Figure 1b.\n\n5\n\n\fz\n\nz\n\nz\n\nz\n\nz\n\nz\n\ny\n\nF\n\nF\n> 150\u25e6\n\nx\n\nF\n\nx\n\nx\n\u2264 150\u25e6\n\nF\u2032\n\ny\n\ny\n\ny\n\ny\n\nl\u2032\nl\u2032\u2032\nd=\n\n1\n14\n\nr\n\n(a) Case I\n\nl\n\ns\n\nl\n\n(b) Case IIa\n\nl\n(c) Case IIb\n\nFigure 6: The cases in the proof of Lemma 1. The figures show possible locations for the\nneighbors y and z of x.\nThere can be no conflict in applying the rules by regarding a vertex v as part of different\nfaces: the bound of 150\u25e6 on the angle, together with the Three Wedges Property ensures that\nthere is at most one critical angle for every vertex (Figure 2b).\nThe result has the following properties:\nLemma 1. After the rough perturbation, all faces are still convex.\nMoreover, if each vertex is additionally perturbed within a disk of radius 1/30, the only\nconcave angle that might arise at a vertex v is the critical angle of v.\nProof. It is evident that no critical angle can become bigger than 180\u25e6 . For non-critical angles,\nthis is also easy to see (cf. Figure 4c). (In fact, the second statement is a strengthening of\nthis claim.)\nWe now prove this second statement of the lemma by considering different cases. The\nreader who is satisfied with the existence of some small enough perturbation bound \u03b5 > 0\nmay skip the rest of the proof. We continue to show that we can choose \u03b5 = 1/30.\nConsider a non-critical angle yxz at a vertex x in a face F . We assume without loss of\ngenerality that x lies on the lower left edge l of the enclosing triangle TF .\nCase I. The point x is incident to a critical angle of another face F \u2032 , and thus x is pushed\nout of F \u2032 .\nWithout loss of generality, we can assume that x lies on the lower right edge of TF \u2032 , and thus\nx is perturbed in the lower right direction, as in Figure 6a. (The other case, when x lies on the\nupper edge of TF \u2032 and is pushed vertically upward, is symmetric.) By the definition of critical\n6\n\n\fangles, the angle in F \u2032 must be bigger than 150\u25e6 . This excludes from F all points vertically\nabove x or to the left of x. The upper neighbor z of x, which is a grid point, is therefore\nrestricted to a closed halfplane right of a vertical line r at distance 1/2 from x. The lower\nneighbor y must lie on or above the line l that bounds the enclosing triangle TF . Thus, y and\nz are restricted to the shaded area in Figure 6a. Even if all three points are perturbed by the\n3\n1\n= 14\n.\nrough perturbation, they are still separated by a vertical strip of width d = 12 \u2212 2 * 14\n1\n1\n\u25e6\nAn additional perturbation of 30 < 2*14 cannot make the angle at x larger than 180 .\nCase II. The point x not perturbed by the initial perturbation.\nCase IIa. The point x has a neighbor on l.\nWe can assume w.l.o.g. that it is the lower neighbor y, see Figure 6b. The angle yxz must be\nat most 150\u25e6 because otherwise x would be critical. It means that z cannot lie to the left of x,\nand thus y and z are restricted to the shaded area in Figure 6b. Even if they are perturbed,\nthey remain above the line s, which is obtained by offsetting\nthe edge of the shaded region\np\n2\n. Thus, there is\nthat is closest to x. The distance from x to s is 1/7 * 3/7 \u2248 0.0935 > 30\nenough space to additionally perturb the points x, y and z without creating a concave angle.\n(Actually, the vertex x will not even be perturbed in the fine perturbation.)\nCase IIb. The point x has no neighbors on l, see Figure 6c.\nThis means that y and z lie on or beyond the next grid line l\u2032 parallel to l. The rough\n\u2032\u2032\nperturbation can move them closer\np to l, but they remain beyond another parallel line l\nwhose distance from x is 5/7 * 3/4 \u2248 0.618. This leaves plenty of space for additional\nperturbations of x, y, and z.\nAfter the rough perturbation, we will subject every vertex v that is incident to a critical\nangle to an additional small perturbation of a distance at most 1/30. The lemma ensures\nthat, in order to achieve convexity at v without destroying convexity at another place, we\nonly have to take care of one incident face when we decide the final perturbation of v. We\ncan thus work on each face independently to make it strictly convex.\n\n4\n\nFine Perturbation\n\nWe will now discuss how we go about achieving strict convexity of all faces. The rough\nperturbation helps us to reduce this task to the case of regularly spaced points on a line\n(Section 4.1). In Section 4.2, we will describe in detail how the perturbed strictly convex\nchain is constructed for this special case.\n\n4.1\n\nThe Setting after the Rough Perturbation\n\nAfter the rough perturbation, we are in the following situation. Consider a maximal chain\nv2 , v3 , . . . , vK\u22121 of successive critical angles on a face F . These angles must be made strictly\nconvex by perturbing them inside their little disks. (The two extreme angles at v2 and vK\u22121\nmight already be convex.) The vertices v2 , v3 , . . . , vK\u22121 lie originally on a common edge of\nthe enclosing triangle TF , We first discuss the case when the vertices lie on the upper edge l\nof TF , forming a horizontal chain, as in Figure 7a. (The extension to the other two cases is\ndiscussed in Section 4.3.) According to Lemma 1 we have to ensure that these critical angles\nare smaller than 180\u25e6 after the perturbation. In Figure 7a, these are the vertices v2 , v3 , and\nv4 . Let us call these vertices critical vertices. In addition, we look at the two adjacent vertices\nv1 and vK on F . By the choice of a maximal chain, they are not critical for F . They may lie\n7\n\n\f\u221a\n\n3\n7\n\nv1\n\nv3\n\nv2\n\nv4\n\nv5\n\n(a)\n1\n1\n30\n\nv5\u2032\n\nv1\u2032\n\n(b)\n\n(c)\nv2\n\nv3\n\nv1\nv5\nv4\n(d)\n\nFigure 7: The setting of the fine perturbation process: (a) The initial situation after the rough\nperturbation. The angles in which it is necessary to ensure a convex angle are marked. (b)\nThe circles in which the fine perturbation is performed. The size of the circles is exaggerated\nto make the perturbation more conspicuous. (c) A strictly convex polygon inside the circles.\n(d) The final result.\non the same line as the critical vertices, as the vertices v1 and v5 in Figure 7a, or they might\nlie below this line. To guide the perturbation of the points v2 , . . . , vK\u22121 , we pretend that v1\n\u2032 for these neighbors:\nand vK are part of the chain, and we create surrogate positions v1\u2032 and vK\nFirst we move them from their original positions vertically upward to l; if they don't land on\na grid point, we move them outward by 1/2 unit. Since the angles at v2 and vK\u22121 are bigger\n\u2032 lie on l in this order. Finally, we subject v \u2032\nthan 150\u25e6 , we are sure that v1\u2032 , v2 , . . . , vK\u22121 , vK\n1\n\u2032\nand vK to the same rough perturbation as the critical vertices between them, and move them\nvertically upward.\nWe place a disk of radius 1/30 around every perturbed point on this edge, including the\ntwo surrogate positions, see Figure 7b. In the next step, to be described in Section 4.2, we find\na strictly convex chain which selects one vertex out of each little disk, as shown in Figure 7c.\nThis will make all angles at v2 , . . . , vK\u22121 strictly convex. Finally, we use these perturbed\npositions for our critical vertices, but for v1 and vK , we ignore their perturbed surrogate\npositions, see Figure 7d. The true position of v1 or vK may be determined by a different face\nin which it forms a critical angle (as is the case for v5 in the example), or it might just keep\nits original position (like v1 in the example). We only have to check that the angle at the\nleft-most and right-most critical vertex (v2 and v4 in this case) remains convex:\n\u2032 of the points v and v\nLemma 2. Replacing the perturbed surrogate position v1\u2032 and vK\n1\nK by\ntheir true positions does not destroy convexity at their neighbors v2 and vK\u22121 in F .\n\nProof. We first show that the rough perturbation does not actually perturb v1 and vK to\n\u2032 . It is conceivable that, say, v lies on l and is perturbed\ntheir surrogate positions v1\u2032 or vK\n1\nupwards because of its critical angle in a different face F \u2032 , see Figure 8. However, this would\n8\n\n\fcontradict the Three Wedges Property for v1 and F , creating two incident edges in a sector\nin which only a unique incident edge can exist.\nl\nF v2\n\nv1\n\nv3\n\nF\u2032\n\nFigure 8: A neighbor of a critical vertex cannot be perturbed in the same direction.\nThus we conclude that v1 and vK lie below or on l, and they are either perturbed not at\nall or in a direction below l.\nVertices v2 and v4 in the example of Figure 7 represent the possible extreme cases that have\nto be considered. v5 represents a vertex that is pushed downward in the rough perturbation,\nand then subjected to a fine perturbation anywhere in its little circle. For visual clarity, the\ncircles in Figure 7 have been drawn with a much larger radius than 1/30. Since the circles are\nactually small enough, the angle at v4 will be convex no matter where the point v5 is placed\nin its own circle. (This position is determined when the critical face of v5 is considered.) A\nsimilar statement holds at v2 , where the perturbed surrogate position of v1 in Figure 7c is\nreplaced by the original position of v1 ; this will always turn the edge v2 v1 counterclockwise\nand thus preserve convexity at v2 .\nThe argument works also for a chain of vertices on an exterior edge of the enclosing\ntriangle. In this case, v2 , v3 , . . . , vK\u22121 are perturbed around their original position on l,\nwhereas the neighbors v1 and vK are moved inside the triangle and below l. Geometrically,\nthe situation looks similar as for vertex v1 in Figure 7, except that v1 is not pushed down\nstraight but at a \u221230\u25e6 angle. This movement is large enough to ensure convexity at v2 .\n\n4.2\n\nConvex Chains in the Grid\n\nWe have a number K of vertices 0 = a1 < a2 < * * * < aK \u2264 2n \u2212 1 on a horizontal line which\nform part of an array of 2n consecutive grid points. We want to perturb them into convex\nposition. If the faces of the embedding have at most k sides, then K \u2264 k. It is more convenient\nto work with a rectangular grid. So we extend the hexagonal grid to a rectangular grid as\nshown in Figure 9. This grid will be refined sufficiently in order to allow a strictly convex\nchain to be drawn inside a sequence of circles. Figure 10 gives a schematic picture of the\nsituation. (This drawing is not to scale.) It is more convenient to discuss the construction of\nan upward convex chain. Inside each disk (of radius 1/30) we fit a square of side length 1/50,\nwhich is subdivided into a subgrid of width w and height h. More precisely, we are looking\nfor a sequence of points pi = (xi , yi ) in these circles, whose coordinates measure the distance\nfrom the lower left corner of the first circle in units of little grid cells. Two successive circle\ncenters at distance 1 in terms of the original grid have a distance of S := 50w when measured\nin subgrid units. Thus we are looking for integer coordinates that satisfy ai *S \u2264 xi \u2264 ai *S +w\nand 0 \u2264 yi \u2264 h. Eventually, when the whole subgrid is scaled to the standard grid Z \u00d7 Z, xi\nand yi will become true distances again. The total size of the resulting integer grid will be\nO(nw) \u00d7 O(nh).\n9\n\n\f(a)\n\n(b)\n\n(c)\n\nFigure 9: The hexagonal grid (a) is contained in a rectangular grid (b). A hexagonal grid twice\nrefined (c) contains rectangular grids in three different directions. One of these rectangular\ngrids is highlighted by thicker points.\ny\nS = 50w\n\np1\nh\n\np3\np2\n\nx\nw\n\nFigure 10: A convex chain formed by grid points in the circles. (Again, the radius of the\ncircles is drawn much too large compared to their distance.)\n\nThe convex chain p1 , p2 , . . . , pK has a descending part up to a point with minimum ycoordinate and an ascending part. We choose the two points with minimum y-coordinate to\nlie in the middle: We define M := \u230aK/2\u230b + 1 and set yM \u22121 = yM = 0. We will only describe\nthe construction of the ascending chain from pM to the right. The left half is constructed\nsymmetrically.\nThe direction between two grid points is uniquely specified by a primitive vector, a vector whose components are relatively prime. We now take a sequence of primitive vectors\nq1 , q2 , . . . , qK\u2212M , qi = (ui , vi ) with 0 < ui \u2264 w and vi > 0, in order of increasing slope vi /ui .\nThen we choose the difference vectors \u2206p as appropriate multiples of these vectors, in the\nfollowing way. We have already defined yM := 0, and we choose xM arbitrarily within the\npermitted range of x-coordinates. Having defined pM +i\u22121 , we define\npM +i := pM +i\u22121 + s * qi\nby adding as many copies of qi as are necessary to bring xM +i into the desired box:\naM +i * S \u2264 xM +i \u2264 aM +i * S + w\nSince this box has width w, and ui \u2264 w, this is always possible.\nWe need K \u2212 M \u2264 K/2 primitive vectors qi (including the vector (1, 0) from pM \u22121 to\npM .) The following theorem ensures that we can find these vectors in a triangle of sufficiently\nlarge area.\n10\n\n\fTheorem 2. The right triangle T = (0, 0), (w, 0), (w, t), where w \u2265 1, w integer, and t \u2265 2,\ncontains at least wt/4 primitive vectors.\nThe general proof is given in Section 5. We can however easily give an explicit solution\nfor the special case t = 2 (corresponding to the choice w = k below, which leads to the most\nbalanced grid dimensions): In this case, we can simply take the 1 + \u230aw/2\u230b vectors (w, 1),\n(w \u2212 1, 1), . . . , (\u2308w/2\u2309, 1).\nWe use Theorem 2 as follows. We choose an arbitrary width w \u2264 k for the boxes. By\nTheorem 2, we can set t := max{2, 2K/w} to ensure that we find at least K/2 primitive\nvectors in the triangle T . The slope of these vectors is bounded by t/w. Let us estimate the\nnecessary height h of the boxes. The last point pK is connected to pM by a chain of vectors\nwith slope at most t/w. The distance of x-coordinates is at most the width of the whole\ngrid on which the graph is embedded, i. e., at most S * 2n = O(wn); hence the difference in\ny-coordinates is at most t/w * O(wn) = O(tn) = O(kn/w). It follows that the height h of the\nboxes is O(kn/w). The total height of the resulting grid is O(hn) = O(kn2 /w).\nThis leads to part (i) of Theorem 1. Part (ii) is an easy corollary. As an extreme case,\nwe can set w = 1 and perform only vertical perturbations. We get h \u2264 2kn (without any\nadditional constants depending on S).\n\n(a)\n\n(b)\n\n(c)\n\nFigure 11: A rectangular grid (a), its 2 \u00d7 6 refinement (b), and a shearing (c) of the refined\ngrid. Its grid-points coincide with the untransformed grid.\n\n4.3\n\nPerturbation of Vertices on Diagonal Lines\n\nSo far, we have treated only a sequence of vertices on a horizontal straight line. The same\nscheme can\nbe applied to\n\u0001 linesx\u0001of the twox other\n\u0001 directions by applying the shearing transforx\u0001\nx\n\u221a\n\u221a\nmation y 7\u2192 y+ 3/2*x or y 7\u2192 y\u2212 3/2*x which moves points only in vertical direction.\nIf h is a multiple of w, the transformation will produce a grid like in Figure 11c which is\ncontained in the original grid of Figure 11b. For the range of parameters which is interesting\nfor the theorem (w \u2264 k), the height h of the subgrid is never smaller than the width w; thus,\nthe choice of h as a multiple of w does not change the asymptotic analysis. One needs to\nreduce the size of the little square subgrid to ensure that the sheared square still fits inside\nthe circle, and one has to adjust the quantity S accordingly. In addition, we have to select h\nand w as multiples of 14, to accommodate the grid of the rough perturbation and the refined\nrectangular grid of Figure 9b. All of this changes the analysis only by a constant factor.\nFor the case of a uniform stretching of both dimensions (w = h), one referee has pointed\nout a simpler alternative method. After a blow-up by a factor of two, the original triangular\n\n11\n\n\fgrid contains rectangular grids in all three grid directions, Figure 9c. Two further refinements by the factor 7 (for the rough perturbation) and then by the factor w are sufficient to\naccommodate the fine perturbation.\nOn the exterior edges, the points must of course be perturbed to form an outward convex\nchain.\nFor part (iii) of the theorem we have already mentioned that interior faces with k \u2264 4\nsides are already strictly convex. If the outer face has 4 edges, it contains a single vertex on\none of the sides of the outer triangle. The rough perturbation is thus sufficient to make the\nouter face strictly convex.\nThe whole procedure, as described above, is quite explicit and can be carried out with a\nlinear number of arithmetic operations. We calculate the O(k) primitive vectors qi only once\nand store them in an array. Then, for every actual sequence of vertices on an edge, we can\nconstruct the perturbation very easily. The primitive vectors in the triangle (0, 0), (w, 0),\n(w, t) according to Theorem 2 can be selected from the O(wt) = O(k) grid points in linear\ntime with a sieve method.\n\n4.4\n\nNumerical Experiments\n\nWe have presented a general systematic solution for finding a convex chain by selecting gridpoints from a sequence of boxes. One can find the optimal (i.e., longest) convex chain in\npolynomial time by dynamic programming, as described in more detail below. Results of\nsome experiments are shown in the first column of Table 1. We restrict ourselves to the\nstandard situation of selecting an n-gon from n adjacent boxes (K = n) which are squares\n(w = h). For several different sizes w, we computed the largest n such that a strictly convex\nn-gon can be found in a sequence of cells of size w \u00d7 w. The factor (w + 1)/n determines the\nnecessary grid size w in terms of n. (By the convention of Figure 10, a \"w \u00d7w\" grid consists of\n(w + 1)2 vertices; thus we give the fraction (w + 1)/n instead of w/n.) Since the convex chain\nconsists of a monotone decreasing and a monotone increasing part, connected by a horizontal\nsegment in the middle, the necessary height w + 1 is at least 0.5 n. We see that this trivial\nlower bound is achieved for small values of n. The factor (w + 1)/n increases with n, but not\nvery fast. (The rectangular w \u00d7 h boxes constructed in the proof of Theorem 1 would have\nw/n = 1, but h/n = 100.)\nThe dynamic programming algorithm computes, for each point p in the w \u00d7 h box, and\nfor each possible previous point p\u2032 in the adjacent box to the left, the longest ascending and\nstrictly convex chain (of length i) for which pi\u22121 = p\u2032 and pi = p. Knowing p\u2032 and p, it can\nbe determined which points in the next box are candidate endpoints pi+1 of a chain of length\ni + 1. One can argue that, among these points pi+1 that are reachable as a continuation of\np\u2032 p, only the w + 1 lowest points on each vertical line are candidates for endpoints pi+1 that\nform part of an optimal chain. Theoretically, the complexity of this algorithm is therefore\nO(w3 h2 ). It turns out that, with few exceptions, every point p has only one predecessor point\np\u2032 that must be considered: all other predecessor points pi\u22121 have either a larger slope of\nthe vector p \u2212 pi\u22121 or they are reached by a shorter chain. Therefore, the algorithm runs in\nO(w2 h) = O(wkn) time, in practice.\nA simple greedy approach for selecting the points pi one by one gives already a very good\nsolution: we choose pi+1 from the possible grid points in the appropriate box in such a way\nthat the segment pi+1 \u2212 pi has the slope as small as possible while still forming a convex\nangle at pi . The results in the right column of Table 1 indicate that this algorithm is quite\n12\n\n\fw=h\n0\n1\n2\n4\n6\n8\n10\n12\n20\n40\n100\n200\n400\n1,000\n2,000\n4,000\n10,000\n20,000\n40,000\n100,000\n200,000\n400,000\n1,000,000\n2,000,000\n4,000,000\n\noptimal\nn (w + 1)/n\n2 0.5000\n4 0.5000\n6 0.5000\n10 0.5000\n14 0.5000\n16 0.5625\n20 0.5500\n22 0.5909\n32 0.6562\n58 0.7069\n122 0.8279\n212 0.9481\n366 1.0956\n758 1.3206\n1,292 1.5488\n2,206 1.8137\n4,468 2.2384\n7,592 2.6345\n\ngreedy\nn (w + 1)/n\n2\n0.5000\n4\n0.5000\n6\n0.5000\n8\n0.6250\n12\n0.5833\n14\n0.6429\n18\n0.6111\n18\n0.7222\n28\n0.7500\n48\n0.8542\n96\n1.0521\n164\n1.2256\n276\n1.4529\n562\n1.7811\n948\n2.1108\n1,610\n2.4851\n3,230\n3.0963\n5,472\n3.6552\n9,250\n4.3244\n18,484\n5.4101\n31,192\n6.4119\n52,626\n7.6008\n105,012\n9.5227\n177,046 11.2965\n299,494 13.3559\n\nTable 1: The length of the longest strictly convex n-gon in a sequence of square cells of size\nw \u00d7 w, regularly spaced at distance S = 50w.\ncompetitive with the optimum solution. The running time is O(kw).\n\n5\n\nGrid Points in a Triangle\n\nIn this section we prove Theorem 2. We denote by P := { (x, y) | gcd(x, y) = 1 } the set of\nprimitive vectors in the plane.\nIt is known that the proportion of primitive vectors among the integer vectors in some\nlarge enough area is approximately 1/\u03b6(2) = 6/\u03c0 2 [10, Chapters 16\u201318]. Thus, a \"large\"\ntriangle T should contain roughly 3/\u03c0 2 * wt \u2248 0.304wt primitive points. However, for very\nwide or very high triangles, the fraction of primitive vectors may be different. In fact, for\nt = 2, the bound wt/4 is tight except for an additive slack of at most 2.\nWe will use special methods for counting primitive vectors when T is \"very high\" (i. e., w\nis fixed and below some threshold and t is unbounded, Section 5.1), when T is \"very wide\"\n(t is fixed and w is unbounded, Section 5.2), and for the case when both t and w are large\n(Section 5.3). We use the help of the computer for the first two cases, but we use a general\n13\n\n\fbound for the last case.\n\n5.1\n\nFixed width, unbounded height\n\nFor a fixed value of w, the function f (t) := |T \u2229 P| can be analyzed explicitly. It is periodically\nascending:\nf (t + w) = f (t) + C,\nPw\nwhere C = i=1 \u03c6(i) is the number of primitive vectors in the triangle (0, 0), (w, 0), (w, w),\nexcluding the point (1, 1). Euler's totient function \u03c6(i) denotes the number of integers 1 \u2264\nj \u2264 i that are relatively prime to i, or equivalently, the number of primitive vectors (i, j) on\nthe vertical line segment from (i, 0) to (i, i \u2212 1).\nThe reason for the periodic behavior is that the unimodular shearing transformation\n(x, y) 7\u2192 (x, y+x) maps the triangle (0, 0), (w, 0), (w, t), to the triangle (0, 0), (w, w), (w, w+t),\nwhich is equal to (0, 0), (w, 0), (w, w + t) minus the triangle (0, 0), (w, 0), (w, w).\nTherefore, it is sufficient to check that the \"average slope\" C/w of f is bigger than w/4,\nand to check\nf (t) \u2265 tw/4\n(1)\nfor the initial interval 2 \u2264 t \u2264 2 + w. This can be done by computer: We sort all primitive\nvectors (x, y) with 0 \u2264 x \u2264 w and 0 \u2264 y/x \u2264 (w + 2)/w by their slope y/x. We gradually\nincrease t from 2 to w + 2. The critical values of t for which (1) must be checked explicitly\nare when a new primitive vector is just about to enter the triangle.\nWe ran a lengthy computer check to establish (1) for w = 1, 2, . . . , 250 and for 2 \u2264 t \u2264 w+2\n(and hence for all t). In addition, we checked it for the range w = 251, 252, . . . , 800 and for\n2 \u2264 t \u2264 250.\n\n5.2\n\nLarge width\n\nIn this section we prove Theorem 2 for small t and large w. T intersects each horizontal line\ny = i in a segment of length w \u2212 (w/t)i. In any set of i consecutive grid points on this line,\nthere are precisely \u03c6(i) primitive vectors. We can subdivide the grid points on y = i into\n\u230a(w \u2212 (w/t)i)/i\u230b \u2265 w/i \u2212 w/t \u2212 1 groups of i consecutive points, leading to a total of at least\n(w/i \u2212 w/t \u2212 1)\u03c6(i) primitive vectors:\n|T \u2229 P| \u2265 1 +\n\n\u230at\u230b \u0010\nX\nw\ni=1\n\ni\n\n\u2212\n\n\u0011\nw\n\u2212 1 \u03c6(i)\nt\n\nFor a given value of \u230at\u230b, one can evaluate the expression\n|T \u2229 P| \u2265 1 +\n\n\u230at\u230b \u0010\n\u0011\n\u0011\nX\nw\nw\nw\n\u2212 \u2212 1 \u03c6(i) \u2265 1 +\n\u2212\n\u2212 1 \u03c6(i)\ni\nt\ni\n\u230at\u230b\n\n\u230at\u230b \u0010\nX\nw\ni=1\n\ni=1\n\nexplicitly. The right-hand side of this bound is a linear function g(w):\ng(w) =\n\n\u230at\u230b \u0010\nX\nw\ni=1\n\n\u0011\nw\n\u2212\n\u2212 1 \u03c6(i)\ni\n\u230at\u230b\n\n14\n\n(2)\n\n\fT\u2032\nb\u2032\n\n(a)\na\u2032\ny\n\n(b)\n\nT\u2217\n\nb\n\nT\nx\na\n\nFigure 12: (a) The triangle T \u2032 in Lemma 3 and its covering by squares. (b) The triangles T\nand T \u2217 (shaded) in Lemma 4.\nFor example, for \u230at\u230b = 130, we have g(w) = w * 39.514 . . . \u2212 5153. It follows that g(w) >\nw * 131/4 > wt/4 for w \u2265 762. Performing this calculation by computer for \u230at\u230b = 6, 7, . . . , 130\nestablishes Theorem 2 for 6 \u2264 t \u2264 130 and w \u2265 800. The interval 4 \u2264 t < 6 can be split into\nthe ranges 4 \u2264 t < 4.5, 4.5 \u2264 t < 5, 5 \u2264 t < 5.5, and 5.5 \u2264 t < 6. For each range, we can use\nthe above method with a tighter bound in (2) than t \u2265 \u230at\u230b, and the estimate goes through in\nthe same way.\nSo let us consider the remaining interval 2 \u2264 t \u2264 4: For 2 \u2264 t < 3, we can evaluate |T \u2229 P|\nexplicitly:\n|T \u2229 P| = 1 + (w + 1 \u2212 \u2308 wt \u2309) + (\u2308 w2 \u2309 \u2212 \u2308 wt \u2212 12 \u2309),\n(3)\ncounting the primitive vectors on the lines y = 0, y = 1, and y = 2, respectively. For t \u2265 3,\nthe right-hand side of (3) is still valid as a lower bound. We get\n\u0001\n\u0001\n|T \u2229 P| \u2265 1 + w + 1 \u2212 ( wt + 1) + w2 \u2212 ( wt \u2212 12 + 1) > w( 32 \u2212 2t )\nThe last expression is \u2265 wt/4 for 2 \u2264 t \u2264 4.\nThus we have proved the theorem for 2 \u2264 t \u2264 130 and w \u2265 800.\n\n5.3\n\nLarge triangles\n\nLemma 3. Let T \u2032 be an axis-aligned right triangle of width a\u2032 and height b\u2032 , whose right angle\nlies on a grid point. Then\narea T \u2032 \u2264 |T \u2032 \u2229 Z2 | \u2264 area T \u2032 + \u230aa\u2032 \u230b + \u230ab\u2032 \u230b + 1\nProof. This is simple. Suppose the right angle is at the right bottom corner of T \u2032 , see\nFigure 12a. Each lattice point in T \u2032 is the right bottom vertex of a unit square and these\nsquares cover T \u2032 . To bound the area from below, we must subtract the squares which are not\ncontained in T \u2032 . These squares form a monotone chain along the longest side of T \u2032 , and their\nnumber is \u230aa\u2032 \u230b + \u230ab\u2032 \u230b + 1.\n15\n\n\fy\nT\u2217\nb\n\nb\u2032\n\nT\n\nx\n\na\n\n\u230aa\u230b\n\nFigure 13: If T \u2217 (shaded) contains no grid points, the triangle T \u2032 does not exist.\nLemma 4. Let T be the right triangle (0, 0), (a, 0), (a, b), with a, b \u2265 1. Define T \u2217 as\nT \u2229 { (x, y) : y \u2265 1 }. Then\na\nab\na\nab\n\u2212a\u2212b+\n\u2264 |T \u2217 \u2229 Z2 | \u2264\n+b\u2212\n2\n2b\n2\n2b\n\n(4)\n\nIn particular,\nT \u2217 \u2229 Z2 \u2212\n\nab\n\u2264a+b\n2\n\nProof. See Figure 12b. The triangle T \u2217 has length a \u2212 a/b, height b \u2212 1 and area 12 (b \u2212 1)(a \u2212\na/b) = ab/2 \u2212 a + a/(2b). Let T \u2032 denote the part of T \u2217 that lies left of the line x = \u230aa\u230b. This\ntriangle contains the same grid points as T \u2217 . We assume first that T \u2032 is a nonempty triangle.\nThe difference in areas lies in a rectangle strip of width < 1 and height b \u2212 1:\narea T \u2217 \u2212 (b \u2212 1) \u2264 area T \u2032 \u2264 area T \u2217\nWe can apply Lemma 3 to T \u2032 and obtain\na\u0011\na\u0011 \u0010\n+ a\u2212\n+ (b \u2212 1) + 1,\n\u2212a+\n2\n2b\nb\n\u0010 ab\na\u0011\n|T \u2217 \u2229 Z2 | = |T \u2032 \u2229 Z2 | \u2265 area T \u2032 \u2265\n\u2212 (b \u2212 1),\n\u2212a+\n2\n2b\n\n|T \u2217 \u2229 Z2 | = |T \u2032 \u2229 Z2 | \u2264\n\n\u0010 ab\n\nfrom which the lemma follows.\nThe triangle T \u2032 may not exist, as in Figure 13. In this case, T \u2217 \u2229Z2 = \u2205. Instead of arguing\nwhy the above derivation is valid also for this case, we establish the inequalities directly. Let\nb\u2032 \u2265 b \u2212 b/a denote the vertical extent of T at x = \u230aa\u230b. Then the fact that T \u2032 is empty is\nequivalent to b\u2032 < 1.\nThen, from 1 \u2265 b\u2032 \u2265 b \u2212 b/a we conclude that ab < a + b. It follows that the lower bound\nin (4) is at most 0:\nab\na\na+b a\n+\n\u2212a\u2212b\u2264\n+ \u2212a\u2212b\u22640\n2\n2b\n2\n2\nThe claimed upper bound in (4) is always nonnegative, by the assumption b \u2265 1.\nThe number of primitive vectors can be estimated by an inclusion-exclusion formula,\ntaking into account vectors which are multiples of single primes 2, 3, 5, 7, . . ., vectors which\nare jointly multiples of two primes, of three primes, and so on, see [10, Chapters 16\u201318]:\n\u2217\n\n|T \u2229 P| = 1 + |T \u2229 P| = 1 +\n\nS\nX\ni=1\n\n\u03bc(i) *\n\n( 1i\n16\n\n\u2217\n\n*T )\u2229Z\n\n2\n\n=1+\n\nS\nX\ni=1\n\n\u03bc(i) * ( 1i T )\u2217 \u2229 Z2\n\n(5)\n\n\fHere, \u03bc(i) is the M\u00f6bius function: \u03bc(i) = (\u22121)k if i is the product of k distinct primes and\nP\n\u03bc(i)\n2\n\u03bc(i) = 0 otherwise. It is known that \u221e\ni=1 i2 = 1/\u03b6(2) = 6/\u03c0 , leading to the fact mentioned\n2\nabove that a fraction of approximately 6/\u03c0 of the grid points in a large area are primitive\nvectors.\nOur sum in (5) goes to i = \u221e, but for i > w or i > t, the set ( 1i T )\u2217 \u2229 Z2 is empty.\nTherefore, the formula is valid for S := min{w, \u230at\u230b}. We apply Lemma 4 and obtain\n|T \u2229 P| = 1 +\n\nS\nX\ni=1\n\nS\nS\nwt X \u03bc(i) X w + t\n\u2212\n2\ni2\ni\ni=1\n\u0012\n\u0013i=1\n1\nwt 6\n\u2212\n\u2212 HS (w + t),\n\u2265\n2 \u03c02 S\n\n\u03bc(i) * ( 1i T )\u2217 \u2229 Z2 \u2265\n\nwhere HS = 1 + 1/2 + 1/3 P\n+ * * * + 1/S is the harmonic\nnumber. The last inequality comes from\nP\u221e\n2 \u2264\n2 < 1/S of the infinite series, whose\nbounding the remainder \u221e\n\u03bc(i)/i\n1/i\ni=S+1\ni=S+1\nvalue is 6/\u03c0 2 .\nWe distinguish the two cases for S: Case 1: w \u2264 t, and S = w. Then\n\u0012\n\u0013\n\u0012\n\u0013\nwt 6\n3\n1\n1\n2Hw\n|T \u2229 P| \u2265\n\u2212\n\u2212\n\u2212\n\u2212 Hw (2t) = wt\n2 \u03c02 w\n\u03c0 2 2w\nw\nCase 2: w \u2265 t, and S = \u230at\u230b.\n\u0013\n6\n1\n\u2212\n\u2212 H\u230at\u230b (w + t)\n\u03c0 2 \u230at\u230b\n\u0013\u0013\n\u0012\n\u0012\n1\n1\n1\n3\n\u2212 H\u230at\u230b\n+\n\u2212\n\u2265 wt\n\u03c0 2 2(t \u2212 1)\nt\nw\n\nwt\n|T \u2229 P| \u2265\n2\n\n\u0012\n\n(6)\n\nCombining the two cases and setting n := min{w, t} gives\n\u0013\n\u0012\n2H\u230an\u230b\n1\n3\n\u2212\n\u2212\n|T \u2229 P| \u2265 wt\n\u03c0 2 2(n \u2212 1)\nn\nUsing the estimate Hi \u2264 \u03b3 + ln(i + 1) with Euler's constant \u03b3 \u2248 0.57721, it can be checked\nthat this factor is bigger than 1/4 for n \u2265 250, thus proving the theorem for w, t \u2265 250.\nOn the other hand, the factor in (6) is bigger than 1/4 for w \u2265 800 and 130 \u2264 t \u2264 250,\nproving the theorem also for this range.\nWrap-up. The proof of Theorem 2 is now complete. On a high level, we distinguish three\nranges for w: 1 \u2264 w \u2264 250, 251 \u2264 w \u2264 800, and w \u2265 800.\n\u2022 Range 1: For 1 \u2264 w \u2264 250, the theorem has been established in Section 5.1.\n\u2022 Range 2: 251 \u2264 w \u2264 800. For 251 \u2264 w \u2264 800 and 1 \u2264 t \u2264 250, the theorem has been\nestablished in Section 5.1 as well. For 251 \u2264 w \u2264 800 and t \u2265 250, it has been proved\nin Section 5.3.\n\u2022 Range 3: Finally, for w \u2265 800, there is a division into three cases: Section 5.2 takes\ncare of the range 2 \u2264 t \u2264 130. Section 5.3 proves the bound separately for the ranges\n130 \u2264 t < 250 and t \u2265 250.\n17\n\n\f6\n\nConclusion\n\nIn practice, the algorithm behaves much better than indicated by the rough worst-case bounds\nthat we have proved. We have not attempted to optimize the constants in the proof. For\nexample, if we don't take a 7 \u00d7 7 subgrid but an 11 \u00d7 11 subgrid, and with a more specialized\ntreatment of the outer face, the permissible amount of perturbation in Lemma 1 increases\nfrom 1/30 to 1/9, but it would make the pictures of the rough perturbation harder to draw.\nBonichon, Felsner, and Mosbah [4] have used a technique of eliminating edges from the\ndrawing that can later be inserted in order to reduce the necessary grid size for (non-strictly)\nconvex drawings. This technique can also be applied in our case: remove interior edges as\nlong as the graph remains three-connected. These edges can be easily reinserted in the end,\nafter all faces are strictly convex. (For non-strictly convex drawings in [4], the selection of\nremovable edges and their reinsertion is actually a more complicated issue.) This technique\nmight be useful in practice for reducing the grid size.\nLower Bounds. The only known lower bound comes from the fact that a single convex\nn-gon on the integer grid needs \u03a9(n3 ) area, see B\u00e1r\u00e1ny and Tokushige [3], or Acketa and\n\u017duni\u0107 [1, 2] for the easier case of a square grid. To achieve this area for an n-gon, one has to\ndraw it in a quite round shape. In contrast, the faces that are produced in our algorithm have a\nvery restricted shape: when viewed from a distance, the look like the triangles, quadrilaterals,\npentagons, or hexagons of the n \u00d7 n grid drawing from which they were derived. To reduce\nthe area requirement below O(n4 ) one has to come up with a new approach that also produces\nfaces with a \"rounder\" shape.\nOur bounds are however, optimal within the restricted class of algorithms that start with\na Schnyder drawing or an arbitrary non-strictly convex drawing on an O(n) \u00d7 O(n) grid and\ntry to make it strictly convex by local perturbations only. Consider the case where n \u2212 1\nvertices lie on the outer face, connected to a central vertex in the middle. The Schnyder\ndrawing will place these vertices on the enclosing triangle, and at least n/3 vertices will lie\non a common line. They have to be perturbed into convex position, as in Figures 7 or 10.\nLet us focus on the standard situation when we want to perturb n equidistant vertices\non a line, at distance 1 from each other. The n \u2212 1 edge vectors pi+1 \u2212 pi lie in a 2w \u00d7 2h\nbox; they must be non-parallel, and in particular, they must be distinct. If \u2206y is the average\nabsolute vertical increment of these vectors, it follows that \u2206y = \u03a9(n/w), and the total\nnecessary height h of the boxes is \u03a9(n(\u2206y)) = \u03a9(n2 /w). Therefore, the total necessary area\nis \u03a9(hwn2 ) = \u03a9(n4 ).\nThe argument can be extended to the case when only \u03a9(n) selected grid vertices on a line\nof length O(n) have to be perturbed. It can also be shown that our bounds in terms of k\nare optimal in this setting. The worst case occurs when there is a line of length n with \u03a9(k)\nconsecutive grid points in the middle and two vertices at the extremes.\nExtensions. The class of three-connected graphs is not the most general class of graphs\nwhich allow strictly convex embeddings. The simplest example of this is a single cycle.\nA planar graph, with a specified face cycle C as the outer boundary, has a strictly convex\nembedding if and only if it is three-connected to the boundary, i. e., if every interior vertex (not\non C) has three vertex-disjoint paths to the boundary cycle. Equivalently, the graph becomes\nthree-connected after adding a new vertex and connecting it to every vertex of C. These\ngraphs cannot be treated directly by our approach, since the Schnyder embedding method\n18\n\n\fof Felsner [8] does not apply. Partitioning the graph into three-connected components and\nputting them together at the end might work.\nAcknowledgements. We thank the referees for helpful remarks which have lead to many\nclarifications in the presentation. Imre B\u00e1r\u00e1ny was partially supported by Hungarian National\nScience Foundation Grants No. T 037846 and T 046246.\n\nReferences\n[1] Dragan M. Acketa and Jovisa D. \u017duni\u0107, On the maximal number of edges of convex\ndigital polygons included into a square grid, po\u010d\u0131\u0301ta\u010de a umel\u00e1 inteligencia 1 (1982), no. 6,\n549\u2013558.\n[2]\n\n, On the maximal number of edges of convex digital polygons included into an\nm \u00d7 m-grid, J. Comb. Theory, Ser. A 69 (1995), 358\u2013368.\n\n[3] Imre B\u00e1r\u00e1ny and Norihide Tokushige, The minimum area of convex lattice n-gons, Combinatorica 24 (2004), no. 2, 171\u2013185.\n[4] Nicolas Bonichon, Stefan Felsner, and Mohamed Mosbah, Convex drawings of 3connected plane graphs, Graph Drawing: Proc. 12th International Symposium on Graph\nDrawing (GD 2004), September 29\u2013October 2, 2004 (New York), J\u00e1nos Pach, ed. Lecture\nNotes in Computer Science, vol. 3383, Springer-Verlag, 2005, pp. 60\u201370.\n[5] M. Chrobak and G. Kant, Convex grid drawings of 3-connected planar graphs, Internat.\nJ. Comput. Geom. Appl. 7 (1997), no. 3, 211\u2013223.\n[6] Marek Chrobak, Michael T. Goodrich, and Roberto Tamassia, Convex drawings of graphs\nin two and three dimensions, Proc. 12th Ann. Sympos. Comput. Geom., 1996, pp. 319\u2013\n328.\n[7] H. de Fraysseix, J. Pach, and R. Pollack, How to draw a planar graph on a grid, Combinatorica 10 (1990), no. 1, 41\u201351.\n[8] Stefan Felsner, Convex drawings of planar graphs and the order dimension of 3-polytopes,\nOrder 18 (2001), 19\u201337.\n[9]\n\n, Geodesic embeddings and planar graphs, Order 20 (2003), 135\u2013150.\n\n[10] G. H. Hardy and E. M. Wright, An Introduction to the Theory of Numbers, Oxford\nScience Publications, 1979.\n[11] J\u00fcrgen Richter-Gebert, Realization Spaces of Polytopes, Lecture Notes in Mathematics,\nvol. 1643, Springer-Verlag, 1997.\n[12] G\u00fcnter Rote, Strictly convex drawings of planar graphs, Proceedings of the 16th Annual\nACM-SIAM Symposium on Discrete Algorithms (SODA), Vancouver, 2005, pp. 728\u2013734.\n[13] W. Schnyder, Embedding planar graphs on the grid, Proc. 1st ACM-SIAM Sympos. Discrete Algorithms, 1990, pp. 138\u2013148.\n\n19\n\n\f[14] W. Schnyder and W. T. Trotter, Convex embeddings of 3-connected plane graphs, Abstracts of the AMS 13 (1992), no. 5, 502.\n[15] W. T. Tutte, Convex representations of graphs, Proceedings London Mathematical Society 10 (1960), no. 38, 304\u2013320.\n[16]\n\n, How to draw a graph, Proceedings London Mathematical Society 13 (1963),\nno. 52, 743\u2013768.\n\n20\n\n\f"}