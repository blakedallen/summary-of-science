{"id": "http://arxiv.org/abs/1011.0104v3", "guidislink": true, "updated": "2011-05-30T13:14:09Z", "updated_parsed": [2011, 5, 30, 13, 14, 9, 0, 150, 0], "published": "2010-10-30T20:32:33Z", "published_parsed": [2010, 10, 30, 20, 32, 33, 5, 303, 0], "title": "On Roth's theorem on progressions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.2093%2C1011.4851%2C1011.0009%2C1011.4591%2C1011.4527%2C1011.4664%2C1011.1601%2C1011.4506%2C1011.2288%2C1011.3147%2C1011.0255%2C1011.1235%2C1011.2463%2C1011.0649%2C1011.3292%2C1011.4384%2C1011.0104%2C1011.6214%2C1011.3478%2C1011.5006%2C1011.6020%2C1011.1568%2C1011.5309%2C1011.1179%2C1011.0165%2C1011.4693%2C1011.1168%2C1011.1377%2C1011.2309%2C1011.5022%2C1011.1588%2C1011.1250%2C1011.0838%2C1011.4402%2C1011.2466%2C1011.3418%2C1011.6106%2C1011.5989%2C1011.4786%2C1011.0115%2C1011.5832%2C1011.3395%2C1011.3372%2C1011.3860%2C1011.3269%2C1011.2470%2C1011.0022%2C1011.2854%2C1011.2043%2C1011.5498%2C1011.1036%2C1011.5470%2C1011.6429%2C1011.5713%2C1011.6658%2C1011.1915%2C1011.1720%2C1011.5151%2C1011.4196%2C1011.4246%2C1011.1379%2C1011.3854%2C1011.4465%2C1011.3580%2C1011.3339%2C1011.5341%2C1011.0272%2C1011.6005%2C1011.1359%2C1011.3882%2C1011.4660%2C1011.3050%2C1011.3779%2C1011.1228%2C1011.4355%2C1011.2273%2C1011.3283%2C1011.0300%2C1011.3907%2C1011.4833%2C1011.2652%2C1011.1458%2C1011.2084%2C1011.3081%2C1011.3819%2C1011.2895%2C1011.0172%2C1011.3076%2C1011.3655%2C1011.2482%2C1011.0055%2C1011.5221%2C1011.6260%2C1011.1557%2C1011.5835%2C1011.3341%2C1011.5711%2C1011.1647%2C1011.2940%2C1011.4052%2C1011.2252&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On Roth's theorem on progressions"}, "summary": "We show that if A is a subset of {1,...,N} contains no non-trivial three-term\narithmetic progressions then |A|=O(N/ log^{1-o(1)} N). The approach is somewhat\ndifferent from that used in arXiv:1007.5444.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.2093%2C1011.4851%2C1011.0009%2C1011.4591%2C1011.4527%2C1011.4664%2C1011.1601%2C1011.4506%2C1011.2288%2C1011.3147%2C1011.0255%2C1011.1235%2C1011.2463%2C1011.0649%2C1011.3292%2C1011.4384%2C1011.0104%2C1011.6214%2C1011.3478%2C1011.5006%2C1011.6020%2C1011.1568%2C1011.5309%2C1011.1179%2C1011.0165%2C1011.4693%2C1011.1168%2C1011.1377%2C1011.2309%2C1011.5022%2C1011.1588%2C1011.1250%2C1011.0838%2C1011.4402%2C1011.2466%2C1011.3418%2C1011.6106%2C1011.5989%2C1011.4786%2C1011.0115%2C1011.5832%2C1011.3395%2C1011.3372%2C1011.3860%2C1011.3269%2C1011.2470%2C1011.0022%2C1011.2854%2C1011.2043%2C1011.5498%2C1011.1036%2C1011.5470%2C1011.6429%2C1011.5713%2C1011.6658%2C1011.1915%2C1011.1720%2C1011.5151%2C1011.4196%2C1011.4246%2C1011.1379%2C1011.3854%2C1011.4465%2C1011.3580%2C1011.3339%2C1011.5341%2C1011.0272%2C1011.6005%2C1011.1359%2C1011.3882%2C1011.4660%2C1011.3050%2C1011.3779%2C1011.1228%2C1011.4355%2C1011.2273%2C1011.3283%2C1011.0300%2C1011.3907%2C1011.4833%2C1011.2652%2C1011.1458%2C1011.2084%2C1011.3081%2C1011.3819%2C1011.2895%2C1011.0172%2C1011.3076%2C1011.3655%2C1011.2482%2C1011.0055%2C1011.5221%2C1011.6260%2C1011.1557%2C1011.5835%2C1011.3341%2C1011.5711%2C1011.1647%2C1011.2940%2C1011.4052%2C1011.2252&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We show that if A is a subset of {1,...,N} contains no non-trivial three-term\narithmetic progressions then |A|=O(N/ log^{1-o(1)} N). The approach is somewhat\ndifferent from that used in arXiv:1007.5444."}, "authors": ["Tom Sanders"], "author_detail": {"name": "Tom Sanders"}, "author": "Tom Sanders", "links": [{"title": "doi", "href": "http://dx.doi.org/10.4007/annals.2011.174.1.20", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1011.0104v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1011.0104v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "16 pp. Corrected the proof of the Croot-Sisask Lemma. Corrected\n  typos. Updated references", "arxiv_primary_category": {"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1011.0104v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1011.0104v3", "journal_reference": "Ann. of Math. (2) 174 (2011), no. 1, 619-636", "doi": "10.4007/annals.2011.174.1.20", "fulltext": "ON ROTH'S THEOREM ON PROGRESSIONS\n\narXiv:1011.0104v3 [math.CA] 30 May 2011\n\nTOM SANDERS\nAbstract. We show that if A \u2282 {1, . . . , N } contains no non-trivial three-term arithmetic\nprogressions then |A| = O(N/ log1\u2212o(1) N ).\n\n1. Introduction\nIn this paper we prove the following version of Roth's theorem on arithmetic progressions.\nTheorem 1.1. Suppose that A \u2282 {1, . . . , N} contains no non-trivial three-term arithmetic\nprogressions. Then\n\u0013\n\u0012\nN(log log N)5\n.\n|A| = O\nlog N\nThere are numerous detailed expositions and proofs of Roth's theorem and the many\nrelated results, so we shall not address ourselves to a comprehensive history here. Briefly,\nthe first non-trivial upper bound on the size of such sets was given by Roth [Rot52, Rot53],\nand there then followed refinements by Heath-Brown [HB87] and Szemer\u00e9di [Sze90], and\nlater Bourgain [Bou99], leading up to the above with the power 1/2 in place of 1 (up to\ndoubly logarithmic factors).\nBourgain then introduced a new sampling technique in [Bou08] which was refined in\n[San10] to give the previous best bound which had a power of 3/4 (again up to doubly\nlogarithmic factors) in place of 1. The methods of this paper, however, are largely unrelated\nto these last developments. We do still use the Bohr set technology of Bourgain [Bou99],\nbut couple this with two new tools: the first is motivated by the arguments of Katz and\nKoester in [KK10] and is a sort of variant of the Dyson e-transform; the second is a result\non the Lp -invariance of convolutions due to Croot and Sisask [CS10a].\nFor comparison with these upper bounds, Salem and Spencer [SS42] showed that the\nsurface of high-dimensional convex bodies can be embedded in the integers to construct\nsets of size N 1\u2212o(1) containing no three-term progressions, and Behrend [Beh46] noticed\nthat spheres are a particularly good choice. Recently Elkin [Elk10] tweaked this further by\nthickening the spheres to produce the largest known progression-free sets, and his argument\nwas then considerably simplified by Green and Wolf in the very short and readable note\n[GW10b].\n2. Notation\nSuppose that G is a finite Abelian group. We write M(G) for the space of measures on\nG and given a measure \u03bc \u2208 M(G) and a function f \u2208 L1 (\u03bc) we write f d\u03bc for the measure\n1\n\n\f2\n\nTOM SANDERS\n\ninduced by\nC(G) \u2192 C(G); g 7\u2192\n\nZ\n\ng(x)f (x)d\u03bc(x).\n\nGiven a non-empty set A \u2282 G we write \u03bcA for the uniform probability measure supported\non A, that is the measure assigning mass |A|\u22121 to each x \u2208 A, so that \u03bcG is Haar probability\nmeasure on G. The significance of this measure is that it is the unique (up to scaling)\ntranslation invariant measure on G: for x \u2208 G and \u03bc \u2208 M(G) we define \u03c4x (\u03bc) to be the\nmeasure induced by\nZ\nC(G) \u2192 C(G); g 7\u2192\n\ng(y)d\u03bc(y + x),\n\nand it is easy to see that \u03c4x (\u03bcG ) = \u03bcG for all x \u2208 G.\nTranslation can be usefully averaged by convolution: given two measures \u03bc, \u03bd \u2208 M(G)\ndefine their convolution \u03bc \u2217 \u03bd to be the measure induced by\nZ\nC(G) \u2192 C(G); g 7\u2192 g(x + y)d\u03bc(x)d\u03bd(y).\n\nWe use Haar measure to pass between the notion of function f \u2208 L1 (\u03bcG ) and measure\n\u03bc \u2208 M(G). Indeed, since G is finite we shall often identify \u03bc with d\u03bc/d\u03bcG , the RadonNikodym derivate of \u03bc with respect to \u03bcG . In light of this we can easily extend the notion\nof translation and convolution to L1 (\u03bcG ): given f \u2208 L1 (\u03bcG ) and x \u2208 G we define the\ntranslation of f by x point-wise by\n\u03c4x (f )(y) :=\n\nd(\u03c4x (f d\u03bcG ))\n(y) = f (x + y) for all y \u2208 G;\nd\u03bcG\n\nand given f, g \u2208 L1 (\u03bcG ) we define convolution of f and g point-wise by\nZ\nd((f d\u03bcG ) \u2217 (gd\u03bcG))\nf \u2217 g(x) :=\n(x) = f (y)g(x \u2212 y)d\u03bcG (y),\nd\u03bcG\n\nand similarly for the convolution of f \u2208 L1 (\u03bcG ) with \u03bc \u2208 M(G).\nConvolution operators can be written in a particularly simple form with respect to the\nb for the dual group, that is the finite Abelian\nFourier basis which we now recall. We write G\n1\ngroup of homomorphisms \u03b3 : G \u2192 S , where S 1 := {z \u2208 C : |z| = 1}. Given \u03bc \u2208 M(G) we\nb by\ndefine \u03bc\nb \u2208 l\u221e (G)\nZ\nb\n\u03bc\nb(\u03b3) := \u03b3d\u03bc for all \u03b3 \u2208 G,\nand extend this to f \u2208 L1 (G) by fb := f[\nd\u03bcG . It is easy to check that \u03bc[\n\u2217\u03bd = \u03bc\nb * \u03bdb for all\n1\nb\n[\n\u03bc, \u03bd \u2208 M(G) and f \u2217 g = f * gb for all f, g \u2208 L (\u03bcG ).\nThroughout the paper Cs will denote absolute, effective, but unspecified constants of\nsize greater than 1 and cs will denote the same of size at most 1. Typically the constants\nwill be subscripted according to the result from which they come and superscripted within\narguments.\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n3\n\n3. Fourier analysis on Bohr sets\nFourier analysis on Bohr sets was introduced to additive combinatorics by Bourgain in\n[Bou99], and has since become a fundamental tool. The material is standard so we shall\nimport the results we require from [San10] without comment; for a more detailed discussion\nthe reader may wish to consult the book [TV06] of Tao and Vu.\nb and width function \u03b4 \u2208 (0, 2]\u0393 if\nA set B is called a Bohr set with frequency set \u0393 \u2282 G\nB = {x \u2208 G : |1 \u2212 \u03b3(x)| 6 \u03b4\u03b3 for all \u03b3 \u2208 \u0393}.\n\nThe size of the set \u0393 is called the rank of B and is denoted rk(B).\nThere is a natural way of dilating Bohr sets which will be of particular use to us. Given\nsuch a B, and \u03c1 \u2208 R+ we shall write B\u03c1 for the Bohr set with frequency set \u0393 and width\nfunction1 \u03c1\u03b4 so that, in particular, B = B1 .\nWith these dilates we say that a Bohr set B \u2032 is a sub-Bohr set of another Bohr set B,\nand write B \u2032 6 B, if\nB\u03c1\u2032 \u2282 B\u03c1 for all \u03c1 \u2208 R+ .\nFinally, we write \u03b2\u03c1 for the probability measure induced on B\u03c1 by \u03bcG , and \u03b2 for \u03b21 .\n3.1. Size and regularity of Bohr sets. The rank of a Bohr set is closely related to its\ndimension: a Bohr set B is said to be d-dimensional if\n\u03bcG (B2\u03c1 ) 6 2d \u03bcG (B\u03c1 ) for all \u03c1 \u2208 (0, 1],\nand we have the following standard averaging argument, see [TV06, Lemma 4.20].\nLemma 3.2 (Dimension of Bohr sets). Suppose that B is a rank k Bohr set. Then it is\nO(k)-dimensional.\nA key observation of [Bou99] was that some Bohr sets behave better than others: a\nd-dimensional Bohr set is said to be C-regular if\n\u03bcG (B1+\u03b7 )\n1\n6\n6 1 + Cd|\u03b7| for all \u03b7 with |\u03b7| 6 1/Cd.\n1 + Cd|\u03b7|\n\u03bcG (B1 )\nCrucially, regular Bohr sets are plentiful:\nLemma 3.3 (Regular Bohr sets). There is an absolute constant CR such that whenever B\nis a Bohr set, there is some \u03bb \u2208 [1/2, 1) such that B\u03bb is CR -regular.\nThe result is proved by a covering argument due to Bourgain [Bou99]; for details one\nmay also consult [TV06, Lemma 4.25]. For the remainder of the paper we shall say regular\nfor CR -regular.\n1Technically\n\nwidth function \u03b3 7\u2192 min{\u03c1\u03b4\u03b3 , 2}.\n\n\f4\n\nTOM SANDERS\n\n3.4. The large spectrum. Given a probability measure \u03bc, a function f \u2208 L1 (\u03bc) and a\nparameter \u01eb \u2208 (0, 1] we define the \u01eb-spectrum of f w.r.t. \u03bc to be the set\nb : |(f d\u03bc)\u2227(\u03b3)| > \u01ebkf kL1 (\u03bc) }.\nSpec\u01eb (f, \u03bc) := {\u03b3 \u2208 G\n\nThis definition extends the usual one from the case \u03bc = \u03bcG . We shall need a local version of\na result of Chang [Cha02] for estimating the 'complexity' or 'entropy' of the large spectrum.\nConceptually the next definition is inspired by the discussion of quadratic rank Gowers\nand Wolf give in [GW10a]. The (K, \u03bc)-relative entropy of a set \u0393 is the size of the largest\nsubset \u039b \u2282 \u0393 such that\nZ Y\n(1 + Re \u03c9(\u03bb)\u03bb)d\u03bc 6 exp(K) for all \u03c9 : \u039b \u2192 D,\n\u03bb\u2208\u039b\n\nwhere D := {z \u2208 C : |z| 6 1}. The definition is essentially relativising the notion of being\ndissociated (if \u03bc = \u03bcG and K = 0 it is precisely this), but the reader does not need to have\na deep understanding for the purposes of this paper as it is only used to couple the next\ntwo results from [San10] into Lemma 3.8.\n\nLemma 3.5 (The Chang bound, [San10, Lemma 4.6]). Suppose that 0 6\u2261 f \u2208 L2 (\u03bc). Then\nSpec\u01eb (f, \u03bc) has (1, \u03bc)-relative entropy O(\u01eb\u22122 log 2kf kL2(\u03bc) kf k\u22121\nL1 (\u03bc) ).\nLow entropy sets of characters are majorised by large Bohr sets, a fact encoded in the\nfollowing lemma.\nLemma 3.6 ([San10, Corollary 6.4]). Suppose that B is a regular d-dimensional Bohr set\nand \u2206 is a set of characters with (\u03b7, \u03b2)-relative entropy k. Then there is a Bohr set B \u2032 6 B\nwith\nrk(B \u2032 ) 6 rk(B) + k and \u03bcB (B \u2032 ) > (\u03b7/2dk)O(d) (1/2k)O(k)\nsuch that |1 \u2212 \u03b3(x)| 6 1/2 for all x \u2208 B \u2032 and \u03b3 \u2208 \u2206.\n3.7. The energy increment method. The final lemma of the section encodes the HeathBrown-Szemer\u00e9di energy increment technique from [HB87, Sze90] which shows how to get\na density increment on a Bohr set from large energy on a large spectrum.\nLemma 3.8. Suppose that B is a regular d-dimensional Bohr set, A \u2282 B has density\n\u03b1 > 0, B \u2032 \u2282 B\u03c1\u2032 is a regular rank k Bohr set, T \u2282 B \u2032 has relative density \u03c4 and\nX\n|((1A \u2212 \u03b1)1B )\u2227 (\u03b3)|2 > \u03bd\u03b12 \u03bcG (B).\n\u03b3\u2208Spec\u03b7 (1T ,\u03b2 \u2032 )\n\nThen there is a regular Bohr set B \u2032\u2032 with\n\u2032\u2032\n\nrk(B ) 6 k + O(\u03b7\n\n\u22122\n\nlog 2\u03c4\n\n\u22121\n\n\u2032\u2032\n\n) and \u03bcB\u2032 (B ) >\n\n\u0012\n\n\u03b7\n2k log 2\u03c4 \u22121\n\nsuch that k1A \u2217 \u03b2 \u2032\u2032 kL\u221e (\u03bcG ) > \u03b1(1 + \u03a9(\u03bd)) provided \u03c1\u2032 6 c3.8 \u03bd\u03b1/d.\n\n\u0013O(k+\u03b7\u22122 log 2\u03c4 \u22121 )\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n5\n\nProof. By Lemma 3.5 the set Spec\u03b7 (1T , \u03b2 \u2032) has (1, \u03b2 \u2032 )-relative entropy O(\u03b7 \u22122 log 2\u03c4 \u22121 ). The\ndimension of B \u2032 is O(k) so it follows by Lemma 3.6 that there is a Bohr set B \u2032\u2032 6 B \u2032 with\n\u0012\n\u0013O(k+\u03b7\u22122 log 2\u03c4 \u22121 )\n\u03b7\n\u2032\u2032\n\u2032\u2032\n\u22122\n\u22121\nrk(B ) 6 k + O(\u03b7 log 2\u03c4 ) and \u03bcB\u2032 (B ) >\n2k log 2\u03c4 \u22121\nsuch that\nSpec\u03b7 (1T , \u03b2 \u2032 ) \u2282 {\u03b3 : |1 \u2212 \u03b3(x)| 6 1/2 for all x \u2208 B \u2032\u2032 }.\nBy the triangle inequality and Parseval's theorem it follows that\nX\nc\u2032\u2032 (\u03b3)|2\n\u03a9(\u03bd\u03b12 \u03bcG (B)) =\n|((1A \u2212 \u03b1)1B )\u2227 (\u03b3)|2 |\u03b2\nb\n\u03b3\u2208G\n\n= k(1A \u2212 \u03b11B ) \u2217 \u03b2 \u2032\u2032 k2L2 (\u03bcG ) .\n\nSince B \u2032\u2032 6 B \u2032 \u2282 B\u03c1\u2032 and B is regular we have that\n\nk(1A \u2212 \u03b11B ) \u2217 \u03b2 \u2032\u2032 k2L2 (\u03bcG ) = k1A \u2217 \u03b2 \u2032\u2032 k2L2 (\u03bcG ) \u2212 \u03b12 \u03bcG (B) + O(\u03b1\u03c1\u2032d\u03bcG (B)).\n\nIt follows that if \u03c1\u2032 is sufficiently small then\n\nk1A \u2217 \u03b2 \u2032\u2032 k2L2 (\u03bcG ) > \u03b12 (1 + \u03a9(\u03bd))\u03bcG (B)\n\nand we get the result by H\u00f6lder's inequality.\n\n\u0003\n\n4. Katz-Koester and the Dyson e-transform\nIn [KK10] Katz and Koester introduced a new way of transforming sumsets. This method\nhas seen impressive applications in, for example, [Sch11] and [SS10], and is particularly ripe\nfor iteration. The arguments of this section evolved from these Katz-Koester techniques but\nin their final form may be seen to have more in common with the Dyson e-transform (see\ne.g. [TV06, \u00a75.1]). In any case, from our perspective what is important is that it provides\na sort of density increment without the cost of passing to an approximate subgroup.\nSpecifically our aim is to transform the set A in Roth's theorem into two sets L and S\nwhere L is thick, S is not too thin, and L + S \u2282 A \u2212 2.A. This dovetails with the regime\nof strength of the results in the next section.\nThe main idea is to construct such sets L and S iteratively using the Katz-Koester\ntransformation. Suppose that L, S, A and A\u2032 are sets of density \u03bb, \u03c3, \u03b1 and \u03b1\u2032 respectively\nand L + S \u2282 A + A\u2032 . Unless A is 'quite structured' one expects there to be very few x for\nwhich\n1L \u2217 1\u2212A (x) > \u03b1/2;\non the other hand, by averaging, there are many x \u2208 G such that\n1\u2212S \u2217 1A\u2032 (x) > \u03c3\u03b1\u2032 /2.\n\nIt follows that unless A is 'quite structured' one may find an x \u2208 G such that\nNow, if we put\n\n1L \u2217 1\u2212A (x) 6 \u03b1/2 and 1\u2212S \u2217 1A\u2032 (x) > \u03c3\u03b1\u2032 /2.\nL\u2032 := L \u222a (x + A) and S \u2032 := S \u2229 (A\u2032 \u2212 x),\n\n\f6\n\nTOM SANDERS\n\nthen we have\n\u03bcG (L\u2032 ) > \u03bcG (L) + \u03bcG (x + A) \u2212 1L \u2217 1\u2212A (x) > \u03bb + \u03b1/2 and \u03bcG (S \u2032 ) > \u03b1\u2032 \u03c3/2,\n\nand also\n\nL\u2032 + S \u2032 \u2282 (L + S \u2032 ) \u222a ((x + A) + S \u2032 ) \u2282 (L + S) \u222a (x + A + A\u2032 \u2212 x) \u2282 A + A\u2032 .\n\nWe see that unless A is quite structured we have a new pair (L\u2032 , S \u2032) whose sumset is\ncontained in A + A\u2032 , but for which L\u2032 is somewhat larger (than L) while S \u2032 is not too much\nsmaller (than S).\nThe actual result we require is the following relativised and weighted version of the\nabove.\nProposition 4.1. Suppose that B is a regular d-dimensional Bohr set, B \u2032 is a regular rank\nk Bohr set with B \u2032 \u2282 B\u03c1\u2032 ,B \u2032\u2032 \u2282 B\u03c1\u2032 \u2032\u2032 , A \u2282 B has relative density \u03b1 and A\u2032 \u2282 B \u2032 has relative\ndensity \u03b1\u2032 . Then either\n(i) there is a regular Bohr set B \u2032\u2032\u2032 of rank at most k + O(\u03b1\u22121 log 2\u03b1\u2032\u22121 ) with\n\u0012\n\u0013O(k+\u03b1\u22121 log 2\u03b1\u2032\u22121 )\n\u03b1\n\u2032\u2032\u2032\n\u03bcB\u2032 (B ) >\n2k log 2\u03b1\u2032\u22121\nand k1A \u2217 \u03b2 \u2032\u2032\u2032 kL\u221e (\u03bcG ) > \u03b1(1 + \u03a9(1));\n\u22121\n(ii) or there are sets L \u2282 B and S \u2282 B \u2032\u2032 with \u03b2(L) = \u03a9(1) and \u03b2 \u2032\u2032 (S) > (\u03b1\u2032 /2)O(\u03b1 )\nsuch that\n1L \u2217 (1S d\u03b2 \u2032\u2032 )(x) 6 C4.1 \u03b1\u22121 \u03bcB\u2032 (B \u2032\u2032 )\u22121 1A \u2217 (1A\u2032 d\u03b2 \u2032)(x)\nfor all x \u2208 G;\nprovided \u03c1\u2032 6 c4.2 \u03b1/d and \u03c1\u2032\u2032 6 c4.2 \u03b1\u2032 /k.\nThe proof is an iteration of the following lemma.\nLemma 4.2. Suppose that B is a regular d-dimensional Bohr set, B \u2032 is a regular rank k\nBohr set with B \u2032 \u2282 B\u03c1\u2032 ,B \u2032\u2032 \u2282 B\u03c1\u2032 \u2032\u2032 , A \u2282 B has relative density \u03b1 and A\u2032 \u2282 B \u2032 has relative\ndensity \u03b1\u2032 .\nIf, additionally, there is a set L \u2282 B of relative density \u03bb and S \u2282 B \u2032\u2032 of relative density\n\u03c3, then either\n(i) there is a regular Bohr set B \u2032\u2032\u2032 of rank at most k + O(\u03b1\u22121 log 2\u03b1\u2032\u22121 ) with\n\u0013O(k+\u03b1\u22121 log 2\u03b1\u2032\u22121 )\n\u0012\n\u03b1\n\u2032\u2032\u2032\n\u03bcB\u2032 (B ) >\n2k log 2\u03b1\u2032\u22121\nand k1A \u2217 \u03b2 \u2032\u2032\u2032 kL\u221e (\u03bcG ) > \u03b1(1 + \u03a9(1));\n(ii) or there are sets L\u2032 \u2282 B and S \u2032 \u2282 B \u2032\u2032 with \u03b2(L\u2032 ) > \u03bb + \u03b1/4 and \u03b2 \u2032\u2032 (S \u2032 ) > \u03b1\u2032 \u03c3/2\nsuch that\n1L\u2032 \u2217 (1S \u2032 d\u03b2 \u2032\u2032 )(x) 6 1L \u2217 (1S d\u03b2 \u2032\u2032 )(x) + \u03bcB\u2032 (B \u2032\u2032 )\u22121 1A \u2217 (1A\u2032 d\u03b2 \u2032)(x)\n\nfor all x \u2208 G;\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n7\n\nprovided \u03bb 6 c4.2 , \u03c1\u2032 6 c4.2 \u03b1/d and \u03c1\u2032\u2032 6 c4.2 \u03b1\u2032 /k.\nProof. We put\nL := {x \u2208 B \u2032 : 1\u2212L \u2217 (1A d\u03b2)(\u2212x) > \u03b1/2},\n\nand split into two cases. First, when \u03b2 \u2032 (L) is large we shall show that A has a density\nincrement on a Bohr set; secondly, when it is small we shall proceed as per the heuristic\nat the start of the section.\nCase. \u03b2 \u2032 (L) > \u03b1\u2032 /8\nProof. This is a textbook translation of a physical space condition into a density increment\nvia the Fourier transform. We consider the inner product\n\u03b1\u03b2 \u2032 (L)/2 6 h1\u2212L \u2217 (1A d\u03b2), 1\u2212L iL2 (\u03b2 \u2032 ) .\nBy regularity we have that if \u03c1\u2032 is sufficiently small then\n|h1\u2212L \u2217 \u03b2, 1\u2212L iL2 (\u03b2 \u2032 ) \u2212 \u03bb\u03b2 \u2032 (L)| 6 \u03b2 \u2032 (L)/4.\nIt follows by the triangle inequality that\n|h1\u2212L \u2217 ((1A \u2212 \u03b1)d\u03b2), 1\u2212LiL2 (\u03b2 \u2032 ) | > \u03b1\u03b2 \u2032 (L)(1/4 \u2212 \u03bb) > \u03b1\u03b2 \u2032(L\u2032 )/8\nif \u03bb is sufficiently small. By Fourier inversion and rescaling we then have\nX\nb\n\u03b3\u2208G\n\n\u2032\n\u2227\n\\\u2032\n1d\n\u2212L (\u03b3)(1A \u2212 \u03b11B ) (\u03b3)1\u2212L d\u03b2 (\u03b3) > \u03b1\u03b2 (L)\u03bcG (B)/8.\n\n2\nBy Cauchy-Schwarz and Parseval on the sum of |1d\n\u2212L (\u03b3)| we get that\nX\n2\n2 \u2032\n2\n\u2032\n|(1A \u2212 \u03b11B )\u2227 (\u03b3)|2 |1\\\n\u2212L d\u03b2 (\u03b3)| > \u03b1 \u03b2 (L) \u03bcG (B)/64.\nb\n\u03b3\u2208G\n\n\u221a\nOn the other hand, Parseval's theorem tells us that if \u03b7 := \u03b1/16 then\nX\n2\n2 \u2032\n2\n2\n\u2032\n|(1A \u2212 \u03b11B )\u2227 (\u03b3)|2 |1\\\n\u2212L d\u03b2 (\u03b3)| 6 \u03b1 \u03b2 (L) \u03bcG (B)/16 .\n\u03b36\u2208Spec\u03b7 (1\u2212L ,\u03b2 \u2032 )\n\n\u2032\n\u2032\nThus, by the triangle inequality, and since |1\\\n\u2212L d\u03b2 (\u03b3)| 6 \u03b2 (L) we get that\nX\n|((1A \u2212 \u03b1)1B )\u2227 (\u03b3)|2 = \u03a9(\u03b12 \u03bcG (B)).\n\u03b3\u2208Spec\u03b7 (1\u2212L ,\u03b2 \u2032 )\n\nIt follows by Lemma 3.8 that we are in the first case of the lemma provided \u03c1\u2032 is sufficiently\nsmall.\n\u0003\nCase. \u03b2 \u2032 (L) 6 \u03b1\u2032 /8\n\n\f8\n\nTOM SANDERS\n\nProof. First we show that the set\nS := {x \u2208 B \u2032 : (1\u2212S d\u03b2 \u2032\u2032 ) \u2217 1A\u2032 (x) > \u03b1\u2032 \u03c3/2}\n\nis large by averaging. In particular,\nZ\nZ\n\u2032\n\u2032\n\u2032\n\u2032\u2032\n\u03b2 (S)\u03c3 + \u03b1 \u03c3/2 > (1\u2212S d\u03b2 ) \u2217 1A\u2032 d\u03b2 = 1A\u2032 d((1\u2212S d\u03b2 \u2032\u2032 ) \u2217 \u03b2 \u2032 ).\n\nOf course, by regularity we have that\n\nk(1\u2212S d\u03b2 \u2032\u2032 ) \u2217 \u03b2 \u2032 \u2212 \u03c3\u03b2 \u2032 k = O(\u03c3k\u03c1\u2032\u2032 ),\n\nwhence\n\n\u03b2 \u2032(S) > \u03b1\u2032 /2 \u2212 O(k\u03c1\u2032\u2032 ) > \u03b1\u2032 /4\nprovided \u03c1\u2032\u2032 is sufficiently small. Now, since L is assumed to be so small there must be\nsome x \u2208 S \\ L; we put\nL\u2032 := L \u222a ((x + A) \u2229 B) and S \u2032 := S \u2229 (A\u2032 \u2212 x).\n\nNow, L\u2032 \u2282 B and since x 6\u2208 L we have\nBut then\n\n\u03b2(L \u2229 (x + A)) = \u03b2((\u2212L) \u2229 (\u2212x \u2212 A)) = 1\u2212L \u2217 (1A d\u03b2)(\u2212x) 6 \u03b1/2.\n\u03b2(L\u2032 ) > \u03bb + \u03b2((x + A) \u2229 B) \u2212 \u03b1/2 > \u03bb + \u03b1/2 \u2212 O(d\u03c1\u2032 ) > \u03bb + \u03b1/4\n\nprovided \u03c1\u2032 is sufficiently small. Additionally S \u2032 \u2282 S \u2282 B \u2032\u2032 and\nand finally\n\nas required.\n\n\u03b2 \u2032\u2032 (S \u2032 ) = \u03b2 \u2032\u2032 (S \u2229 (A\u2032 \u2212 x)) = (1\u2212S d\u03b2 \u2032\u2032) \u2217 1A\u2032 (x) > \u03b1\u2032 \u03c3/2,\n\n1L\u2032 \u2217 (1S \u2032 d\u03b2 \u2032\u2032 ) 6 1L \u2217 (1S \u2032 d\u03b2 \u2032\u2032 ) + 1x+A \u2217 (1S \u2032 d\u03b2 \u2032\u2032)\n6 1L \u2217 (1S d\u03b2 \u2032\u2032 ) + \u03bcG (B \u2032\u2032 )\u22121 1x+A \u2217 1A\u2032 \u2212x\n= 1L \u2217 (1S d\u03b2 \u2032\u2032 ) + \u03bcB\u2032 (B \u2032\u2032 )\u22121 1A \u2217 (1A\u2032 d\u03b2 \u2032 )\n\u0003\n\u0003\n\nProof of Proposition 4.1. We produce a sequence of sets (Li )i and (Si )i iteratively with\nLi \u2282 B, Si \u2282 B \u2032\u2032 , \u03bbi := \u03b2(Li ) and \u03c3i := \u03b2 \u2032\u2032 (Si ) such that\n\n(4.1)\n\n\u03bbi > \u03b1i/4 and \u03c3i > (\u03b1\u2032 /2)i+1\n\nand\n(4.2)\n\n1Li \u2217 (1Si d\u03b2 \u2032\u2032 ) 6 i\u03bcB\u2032 (B \u2032\u2032 )\u22121 1A \u2217 (1A\u2032 d\u03b2 \u2032 ).\n\nTo initialise the iteration we consider the inner product\nZ\n1A\u2032 \u2217 \u03b2 \u2032\u2032 d\u03b2 \u2032 = \u03b1\u2032 + O(\u03c1\u2032\u2032 k).\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n9\n\nThus, if \u03c1\u2032\u2032 is sufficiently small then it follows that there is some x \u2208 B \u2032 \u2282 B such that\n\u03b2 \u2032\u2032 (B \u2032\u2032 \u2229 (A\u2032 \u2212 x)) > \u03b1\u2032 /2;\n\nWe put L0 := \u2205 and S0 := B \u2032\u2032 \u2229 (A\u2032 \u2212 x) and note that this satisfies (4.1) and (4.2).\nWe now repeatedly apply Lemma 4.2. If at any point we are in the first case of that\nlemma then we terminate in the first case here; otherwise we have the sequence as required.\nThis process terminates after some i0 = O(\u03b1\u22121) steps, when \u03bbi > c4.2 = \u03a9(1). We set\nL := Li0 and S := Si0 and the result is proved.\n\u0003\n5. A consequence of the Croot-Sisask lemma\nIn light of the previous section, rather than counting three-term progressions by examining the inner product h1A \u2217 1A , 12.A iL2 (\u03bcG ) , we shall be able to examine (a relativised version\nof) h1L \u2217 1S , 12.A iL2 (\u03bcG ) where L has density \u03a9(1), and S, of density \u03c3, is potentially thin\nbut not too thin. To do this we shall find a Bohr set B such that\n(5.1)\nso that\n\nk1L \u2217 \u03bcS \u2217 \u03b2 \u2212 1L \u2217 \u03bcS kLp (\u03bcG ) 6 \u01eb,\n|h1L \u2217 1S \u2217 \u03b2, 12.AiL2 (\u03bcG ) \u2212 h1L \u2217 1S , 12.A iL2 (\u03bcG ) | 6 \u01eb\u03c3k12.A kLp/(p\u22121) (\u03bcG ) .\n\nIf the error is small enough this will give rise to a density increment on B; to get a sense\nof how small it needs to be we think of the second term on the left as being typically of\nsize \u03bcG (L)\u03c3\u03b1 = \u03a9(\u03c3\u03b1). Now,\n(i) if p = 2 then k12.A kLp/(p\u22121) (\u03bcG ) = \u03b11/2 and we would need \u01eb \u223c \u03b11/2 for the error\nterm not to swamp the main term;\n(ii) if p \u223c log \u03b1\u22121 then k12.A kLp/(p\u22121) (\u03bcG ) \u223c \u03b1 so we would only need \u01eb \u223c 1 for the error\nterm not to swamp the main term.\nOf course, which of these two ranges to use depends on how the size of the Bohr set found\nvaries with p and \u01eb. We shall use an argument of Croot and Sisask [CS10a] to show that\nwe can take\n(5.2)\n\n\u03bcG (B) > exp(\u2212O(\u01eb\u22122 p log \u03c3 \u22121 ))\n\nin (5.1), and so in particular case (ii) above leads to a much larger Bohr set.\nThis argument of Croot and Sisask is an important new approach for studying the Lp invariance of convolutions. It relies on random sampling in physical space to approximate a\nconvolution by a small number of translates and works for general groups, not just Abelian\nones.\nWe shall now record a version of their result which will be particularly useful to us. For\ncompleteness \u2013 and since it is simple \u2013 we include the proof of the result as well.\nLemma 5.1 (Croot-Sisask). Suppose that G is a finite Abelian group, f \u2208 Lp (\u03bcG ) and\nA, S \u2282 G have \u03bcG (S + A) 6 K\u03bcG (A). Then there is an s \u2208 S and a set T \u2282 S with\n\u22122\n\u03bcS (T ) > (2K)\u2212O(\u01eb p) such that\nk\u03c4t (f \u2217 \u03bcA ) \u2212 f \u2217 \u03bcA kLp (\u03bcG ) 6 \u01ebkf kLp (\u03bcG ) for all t \u2208 T \u2212 s.\n\n\f10\n\nTOM SANDERS\n\nProof. Let z1 , . . . , zk be independent uniformly distributed A-valued random variables, and\nfor each y \u2208 G define Zi (y) := \u03c4\u2212zi (f )(y) \u2212 f \u2217 \u03bcA (y). For fixed y, the variables Zi (y) are\nindependent and have mean zero, so it follows by the Marcinkiewicz-Zygmund inequality,\nwith constants due to Yao-Feng and Han-Ying [YFHY01, Theorem 2], that\nk\n\nk\nX\ni=1\n\nZi (y)kpLp (\u03bck )\nA\n\n6 O(p)\n\np/2 p/2\u22121\n\nk\n\nk Z\nX\ni=1\n\n|Zi (y)|pd\u03bckA .\n\nIntegrating over y and interchanging the order of summation we get\nZ X\nZ X\nk Z\nk\np\np/2 p/2\u22121\n|Zi (y)|p d\u03bcG (y)d\u03bckA .\n(5.3)\nk\nZi (y)kLp (\u03bck ) d\u03bcG (y) 6 O(p) k\ni=1\n\nA\n\ni=1\n\nOn the other hand,\n\u00131/p\n\u0012Z\np\n|Zi (y)| d\u03bcG (y)\n= kZi kLp (\u03bcG ) 6 k\u03c4\u2212zi (f )kpLp (\u03bcG ) + kf \u2217 \u03bcA kLp (\u03bcG ) 6 2kf kLp (\u03bcG )\nby the triangle inequality. Dividing (5.3) by k p and inserting the above and the expression\nfor the Zi s we get that\np\nZ Z\nk\n1X\n\u03c4\u2212zi (f )(y) \u2212 f \u2217 \u03bcA (y) d\u03bcG (y)d\u03bckA (z) = O(pk \u22121 kf k2Lp (\u03bcG ) )p/2 .\nk i=1\n\nPick k = O(\u01eb\u22122 p) such that the right hand side is at most (\u01ebkf klp (G) /4)p and write L for\nthe set of x = (x1 , . . . , xk ) \u2208 Ak for which the integrand above is at most (\u01ebkf klp (G) /2)p ;\nby averaging \u03bckA (Lc ) 6 2\u2212p and so \u03bckA (L) > 1 \u2212 2\u2212p > 1/2.\nNow, \u2206 := {(s, . . . , s) : s \u2208 S} has L + \u2206 \u2282 (A + S)k , whence \u03bcGk (L + \u2206) 6 2K k \u03bcGk (L)\nand so\nh\u03bc\u2206 \u2217 \u03bc\u2212\u2206 , 1\u2212L \u2217 1L iL2 (\u03bcGk ) = k1L \u2217 \u03bc\u2206 k2L2 (\u03bc k ) > \u03bcGk (L)/2K k ,\nG\n\nby the Cauchy-Schwarz inequality since the adjoint of g 7\u2192 1L \u2217 g is g 7\u2192 1\u2212L \u2217 g and\nsimilarly for g 7\u2192 g \u2217 \u03bc\u2206 .\nBy averaging it follows that at least 1/2K k of the pairs (z, y) \u2208 \u22062 have 1\u2212L \u22171L (z \u2212y) >\n0, and hence there is some s \u2208 S such that there is a set T \u2282 S with \u03bcS (T ) > 1/2K k and\n1\u2212L \u2217 1L (t, . . . , t) > 0 for all t \u2208 T \u2212 s.\nThus for each t \u2208 T \u2212 s there is some z(t) \u2208 L and y(t) \u2208 L such that y(t)i = z(t)i + t\nfor all i. But then by the triangle inequality we get that\n!\nk\n1X\nk\u03c4\u2212t (f \u2217 \u03bcA ) \u2212 f \u2217 \u03bcA kLp (\u03bcG ) 6 k\u03c4\u2212t\n\u03c4\u2212z(t)i (f ) \u2212 f \u2217 \u03bcA kLp (\u03bcG )\nk i=1\n!\nk\n1X\n\u03c4\u2212z(t)i (f ) \u2212 f \u2217 \u03bcA kLp (\u03bcG ) .\n+k\u03c4\u2212t\nk i=1\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n11\n\nHowever, since \u03c4t is isometric on Lp (\u03bcG ) we see that\nk\n\nk\u03c4t (f \u2217 \u03bcA ) \u2212 f \u2217 \u03bcA kLp (\u03bcG )\n\n1X\n\u03c4\u2212y(t)i (f ) \u2212 f \u2217 \u03bcA kLp (\u03bcG )\n6 k\nk i=1\nk\n\n+k\n\n1X\n\u03c4\u2212z(t)i (f ) \u2212 f \u2217 \u03bcA kLp (\u03bcG ) ,\nk i=1\n\nand we are done since z(t), y(t) \u2208 L.\n\n\u0003\n\nThe quantitatively weaker arguments of [Bou90], and the usual Bogolyubov-Chang argument in the case p = 2 actually endow T with the structure of a Bohr set, while the set\nwe found has, a priori, no structure. Croot and Sisask noted that this could, to some degree, be recovered by taking repeated sumsets, and we shall couple this idea with Chang's\ntheorem to get the necessary strength in our corollary.\nThis may sound like we can't have gained anything over the usual multi-sum version of\nthe Bogolyubov-Chang argument. However, we do get some extra strength from the fact\nthat we are in some sense able to increase the number of summands without decreasing\nthe (higher order) additive energy or having the individual summands become too thin.\nA similar sort of observation is exploited by Schoen in [Sch11] (see also [CS10b]) for the\npurpose of proving a remarkable Fre\u0131\u0306man-type theorem.\nCorollary 5.2. Suppose that B is a regular d-dimensional Bohr set, B \u2032 \u2282 B\u03c1\u2032 is a regular\nrank k Bohr set, L, A \u2282 B have relative densities \u03bb and \u03b1 respectively, S \u2282 B \u2032 has relative\ndensity \u03c3. Then either\n(i) (large inner product)\nh1L \u2217 (1S d\u03b2 \u2032 ), 1A iL2 (\u03b2) > \u03bb\u03c3\u03b1/2;\n(ii) (density increment) or there is a regular Bohr set B \u2032\u2032\u2032 and an\nm = O(\u03bb\u22122(log 2\u03bb\u22121 \u03b1\u22121 )2 (log 2\u03b1\u22121)(log 2\u03c3 \u22121 ))\nwith rk(B \u2032\u2032\u2032 ) 6 k + m and \u03bcB\u2032 (B \u2032\u2032\u2032 ) > (1/2km)O(k+m) such that k1A \u2217 \u03b2 \u2032\u2032\u2032 kL\u221e (\u03bcG ) >\n\u03b1(1 + \u03a9(\u03bb));\nprovided \u03c1\u2032 6 c5.2 \u03bb\u03b1/d.\nProof. We can certainly assume that all of \u03bb, \u03b1 and \u03c3 are positive and to begin we set some\nparameters, the choices for which will become apparent later:\nl := \u2308log 2\u03bb\u22121 \u03b1\u22121 \u2309, p := 2 + log \u03b1\u22121 and \u01eb := \u03bb/8el.\nThe Bohr set B \u2032 has dimension O(k), whence we may pick \u03c1\u2032\u2032 = \u03a9(1/k) such that B \u2032\u2032 :=\nB\u03c1\u2032 \u2032\u2032 /2l is regular and \u03bcG (B \u2032\u2032 + B \u2032 ) 6 2\u03bcG (B \u2032 ). Then\n|B \u2032\u2032 + S| 6 |B \u2032\u2032 + B \u2032 | 6 2|B \u2032 | 6 2\u03c3 \u22121 |S|,\n\n\f12\n\nTOM SANDERS\n\nand we apply Lemma 5.1 to the sets S, B \u2032\u2032 and the function 1L respectively2 with param\u22122\neters p and \u01eb. We get that there is an s \u2208 B \u2032\u2032 and a set T \u2282 B \u2032\u2032 with \u03b2 \u2032\u2032 (T ) > (\u03c3/2)O(p\u01eb )\nsuch that\nk\u03c4t (1L \u2217 (1S d\u03b2 \u2032 )) \u2212 1L \u2217 (1S d\u03b2 \u2032)kLp (\u03bcG ) 6 \u01eb\u03c3k1L kLp (\u03bcG ) for all t \u2208 T \u2212 s.\n\nOf course\n\n\u2032\n\nk\u03c4t (1L \u2217 (1S d\u03b2 )) \u2212 1L \u2217 (1S d\u03b2\n\n\u2032\n\n)kpLp (\u03b2)\n\nZ\n1\n|\u03c4t (1L \u2217 (1S d\u03b2 \u2032 )) \u2212 1L \u2217 (1S d\u03b2 \u2032 )|p d\u03bcG\n6\n\u03bcG (B)\n6 \u01ebp \u03c3 p \u03b2(L) 6 \u01ebp \u03c3 p ,\n\nwhence\nk\u03c4t (1L \u2217 (1S d\u03b2 \u2032)) \u2212 1L \u2217 (1S d\u03b2 \u2032 )kLp (\u03b2) 6 \u01eb\u03c3 for all t \u2208 T \u2212 s.\nIt follows by the triangle inequality that\nk\u03c4t (1L \u2217 (1S d\u03b2 \u2032)) \u2212 1L \u2217 (1S d\u03b2 \u2032 )kLp (\u03b2) 6 2l\u01eb\u03c3 for all t \u2208 l(T \u2212 T ).\n\nIntegrating and applying the triangle inequality again we get\n\nk1L \u2217 (1S d\u03b2 \u2032 ) \u2217 f \u2212 1L \u2217 (1S d\u03b2 \u2032)kLp (\u03b2) 6 2l\u01eb\u03c3\n\nwhere f := \u03bcT \u2217 * * * \u2217 \u03bcT \u2217 \u03bc\u2212T \u2217 * * * \u2217 \u03bc\u2212T and there are l copies of \u03bcT and l copies of \u03bc\u2212T .\nBy H\u00f6lder's inequality we have\n|h1L \u2217 (1S d\u03b2 \u2032 ) \u2217 f, 1A iL2 (\u03b2) \u2212 h1L \u2217 (1S d\u03b2 \u2032), 1A iL2 (\u03b2) | 6 2l\u01eb\u03c3k1A kLp/(p\u22121) (\u03b2) 6 \u03bb\u03c3\u03b1/4.\n\nIt follows that we are either in the first case of the corollary or else\nhf \u2217 (1S d\u03b2 \u2032 ) \u2217 1L , 1A iL2 (\u03b2) 6 3\u03bb\u03c3\u03b1/4,\n\nwhich we assume from hereon.\nNow, supp f \u2282 2lB \u2032\u2032 \u2282 B\u03c1\u2032 \u2032\u2032 \u2282 B\u03c1\u2032 so\nZ\n1L \u2217 (1S d\u03b2 \u2032 ) \u2217 f d\u03b2 = \u03bb\u03c3 + O(\u03c1\u2032 d\u03c3),\n\nwhence\n\n|h1L \u2217 (1S d\u03b2 \u2032 ) \u2217 f, 1A \u2212 \u03b1iL2 (\u03b2) | > \u03bb\u03c3\u03b1/8\nprovided \u03c1\u2032 is sufficiently small. We now apply Fourier inversion to get that\nX\nb\n\u03b3\u2208G\n\n\u2227\n\u2032\nc\n|c\n\u03bcT (\u03b3)|2l 1\\\nS d\u03b2 (\u03b3)1L (\u03b3)(1A \u2212 \u03b11B ) (\u03b3) > \u03bb\u03c3\u03b1\u03bcG (B)/8.\n\nBy the Cauchy-Schwarz inequality and the Hausdorff-Young inequality (in the trivial case\n\u2032\nwhich ensures |1\\\nS d\u03b2 (\u03b3)| 6 \u03c3) we see that\n\uf8f61/2\n\uf8eb\n\uf8f61/2 \uf8eb\nX\nX\n2\uf8f8\n\uf8ed\n|c\n\u03bcT (\u03b3)|4l |(1A \u2212 \u03b11B )\u2227 (\u03b3)|2 \uf8f8 > \u03bb\u03c3\u03b1\u03bcG (B)/8.\n\u03c3\uf8ed\n|1c\nL (\u03b3)|\nb\n\u03b3\u2208G\n\n2So\n\nthat A is S, and S is B \u2032\u2032 .\n\nb\n\u03b3\u2208G\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n13\n\nParseval's theorem tells us that the first sum is \u03bb\u03bcG (B) and so\nX\n|c\n\u03bcT (\u03b3)|4l |(1A \u2212 \u03b11B )\u2227 (\u03b3)|2 > \u03bb\u03b12 \u03bcG (B)/64.\nb\n\u03b3\u2208G\n\nWe put \u03b7 := (\u03bb\u03b1)1/2l /161/l = \u03a9(1) and since \u03bcT = 1T d\u03b2 \u2032\u2032 note, by the triangle inequality,\nthat\nX\n|(1A \u2212 \u03b11B )\u2227 (\u03b3)|2 = \u03a9(\u03bb\u03b12 \u03bcG (B)).\n\u03b3\u2208Spec\u03b7 (1T ,\u03b2 \u2032\u2032 )\n\nThe corollary is completed by Lemma 3.8 provided \u03c1\u2032 is sufficiently small.\n\n\u0003\n\n6. Proof of the main theorem\nWe shall now prove the following theorem from which our main result follows by the\nusual Fre\u0131\u0306man embedding.\nTheorem 6.1. Suppose that G is a group of odd order, and A \u2282 G has density \u03b1 > 0.\nThen\nh1A \u2217 1\u22122.A , 1\u2212A iL2 (\u03bcG ) = exp(\u2212O(\u03b1\u22121 log5 2\u03b1\u22121 )).\nThere is some merit in trying to control the logarithmic term here. Indeed, while it seems\nlikely that with care one could improve the 5 a bit, if one could replace it by 1 \u2212 \u03a9(1) then\none could use the W -trick (as popularised by Green [Gre05]) to deduce van der Corput's\ntheorem pretty easily; if one could replace it by \u2212\u03a9(1) then van der Corput's theorem\nwould follow directly from the prime number theorem.\nEven more ambitiously, the Erd\u0151s-Tur\u00e1n conjecture would follow (for progressions of\nlength three) if one could replace the 5 by \u2212(1 + \u03a9(1)). However, despite the fact that\nsuch an improvement appears small it seems that a new idea would probably be required\nto prove such a result since it is not known even in the model setting of G = (Z/3Z)n . (The\nbest result known there is the celebrated Roth-Meshulam theorem of Meshulam [Mes95].)\nThe proof of Theorem 6.1 is an iterative application of the following lemma.\nLemma 6.2. Suppose that B is a regular d-dimensional Bohr set, B \u2032 is a regular rank k\nBohr set with B \u2032 \u2282 B\u03c1\u2032 ,B \u2032\u2032 \u2282 B\u03c1\u2032 \u2032\u2032 , A \u2282 B has relative density \u03b1 and A\u2032 \u2282 B \u2032 has relative\ndensity \u03b1\u2032 . Then either\n(i) (large inner product)\n\u22121 )\n\nh1A \u2217 (1A\u2032 d\u03b2 \u2032 ), 1\u2212A iL2 (\u03b2) > \u03bcB\u2032 (B \u2032\u2032 )(\u03b1\u2032/2)O(\u03b1\n\n;\n\n(ii) (density increment) or there is a regular Bohr set B \u2032\u2032\u2032 with rank at most k +\nO(\u03b1\u22121(log3 2\u03b1\u22121 )(log 2\u03b1\u2032\u22121 )) and\n\u0012\n\u0013O(k+\u03b1\u22121 (log3 2\u03b1\u22121 )(log 2\u03b1\u2032\u22121 ))\n\u03b1\n\u2032\u2032\u2032\n\u03bcB\u2032 (B ) >\n2k log 2\u03b1\u2032\u22121\n\nand k1A \u2217 \u03b2 \u2032\u2032\u2032 kL\u221e (\u03bcG ) > \u03b1(1 + c6.2 );\nprovided \u03c1\u2032 6 c6.2 \u03b1/d and \u03c1\u2032\u2032 6 c6.2 \u03b1\u2032 /k.\n\n\f14\n\nTOM SANDERS\n\nProof. We apply Proposition 4.1 to see that (provided \u03c1\u2032 and \u03c1\u2032\u2032 aren't too large) either\nwe are in the second case of the lemma or else there are sets L \u2282 B and S \u2282 B \u2032\u2032 with\n\u22121\n\u03b2(L) = \u03a9(1) and \u03b2 \u2032\u2032 (S) > (\u03b1\u2032 /2)O(\u03b1 ) such that\n1L \u2217 (1S d\u03b2 \u2032\u2032 ) 6 C4.1 \u03b1\u22121 \u03bcB\u2032 (B \u2032\u2032 )\u22121 1A \u2217 (1A\u2032 d\u03b2 \u2032).\n\nIn this latter case we apply Corollary 5.2 (to the set \u2212A provided \u03c1\u2032 isn't too large) to get\nthat either we are in the second case of the lemma or else\n\u22121 )\n\nh1L \u2217 (1S d\u03b2 \u2032\u2032 ), 1\u2212A iL2 (\u03b2) > \u03b1\u03b2(L)\u03b2 \u2032\u2032 (S)/2 > (\u03b1\u2032 /2)O(\u03b1\n\n,\n\nand we are in the first case of the lemma.\n\n\u0003\n\nProof of Theorem 6.1. We construct a sequence of regular Bohr sets B (i) and sequences\nki := rk(B (i) ), di = dim B (i) and \u03b1i := k1A \u2217 \u03b2 (i) kL\u221e (\u03bcG ) .\n\nWe initialise with B (0) = G which is easily seen to be regular so that \u03b10 = \u03b1. Suppose\nthat we are at stage i of the iteration.\nWe have di = O(ki ) and so by regularity we have that\n(i)\n\n(i)\n\nk1A \u2217 \u03b2 (i) \u2217 \u03b2\u03c1\u2032 + 1A \u2217 \u03b2 (i) \u2217 \u03b2\u03c1\u2032 \u03c1\u2032\u2032 \u2212 2(1A \u2217 \u03b2 (i) )kL\u221e (\u03bcG ) = O(\u03c1\u2032 ki ).\n\u2032\n\n(i)\n\nIt follows that we can pick \u03c1\u2032 , \u03c1\u2032\u2032 = \u03a9(\u03b1/ki ) such that B (i) := B\u03c1\u2032 is regular of dimension\n\u2032\u2032\n\n(i)\n\ndi , B (i) := 2.B\u03c1\u2032 \u03c1\u2032\u2032 is regular of rank ki ,\n(i)\u2032\n\n\u2032\u2032\n\nB (i) \u2282 Bc\nand\n\n(i)\u2032\n\n\u2032\n\nIf\n\n,\n\n6.2 \u03b1/2di\n\nk1A \u2217 \u03b2 (i) \u2217 \u03b2 (i) + 1A \u2217 \u03b2 (i) \u2217 \u03b2\u03c1\u2032\u2032 \u2212 2(1A \u2217 \u03b2 (i) )kL\u221e (\u03bcG ) 6 c6.2 \u03b1/4.\n(i)\u2032\n\n\u2032\n\nk1A \u2217 \u03b2 (i) kL\u221e (\u03bcG ) > \u03b1i (1 + c6.2 /4) or k1A \u2217 \u03b2\u03c1\u2032\u2032 kL\u221e (\u03bcG ) > \u03b1i (1 + c6.2 /4)\n\u2032\n\n(i)\u2032\n\nthen we let B (i+1) be B (i) or B\u03c1\u2032\u2032 respectively and see that\n\nki+1 = ki , \u03bcG (B (i+1) ) > \u03bcG (B (i) )(\u03b1/2ki )O(ki ) and \u03b1i+1 > \u03b1i (1 + c6.2 /4).\nOtherwise, by averaging, there is some xi such that\n(i)\u2032\n\n\u2032\n\n1A \u2217 \u03b2 (i) (xi ) > \u03b1i (1 \u2212 c6.2 /2) and 1A \u2217 \u03b2\u03c1\u2032\u2032 (xi ) > \u03b1i (1 \u2212 c6.2 /2).\n\u2032\n\n\u2032\u2032\n\nTranslating by xi we get a set A1 := (A \u2212 xi ) \u2229 B (i) and A2 := (2xi \u2212 2.A) \u2229 B (i) such\nthat\n\u2032\u2032\n\u2032\n\u03b2 (i) (A1 ) > \u03b1i (1 \u2212 c6.2 /2) and \u03b2 (i) (A2 ) > \u03b1/2,\nand\n\u2032\u2032\n\u2032\u2032\n\u2032\nh1A \u2217 1\u22122.A , 1\u2212A i > \u03bcG (B (i) )\u03bcG (B (i) )h1A1 \u2217 (1A2 d\u03b2 (i) ), 1\u2212A1 iL2 (\u03b2 (i)\u2032 ) .\nNow we apply the preceding lemma to see that either\n(6.1)\n\n\u2032\n\n(i)\u2032\u2032\n\nh1A \u2217 1\u22122.A , 1\u2212A i > \u03bcG (B (i) )\u03bcG (Bc\n\n6.2\n\n\u03b1/2ki )(\u03b1/2)\n\nO(\u03b1\u22121 )\n\n,\n\n\fON ROTH'S THEOREM ON PROGRESSIONS\n\n15\n\nor there is a Bohr set B (i+1) such that\n\nand\n\nki+1 6 ki + O(\u03b1i\u22121 log4 2\u03b1\u22121 ),\n4\n\u22121 )\n\u0012 \u0013O(ki +\u03b1\u22121\ni log 2\u03b1\n\u03b1\n(i+1)\n(i)\n\u03bcG (B\n) > \u03bcG (B )\n,\n2ki\n\n\u03b1i+1 > \u03b1i (1 + c6.2 /2).\nSince \u03b1i cannot exceed 1 the iteration described above must terminate after i0 =\nO(log 2\u03b1\u22121 ) steps with (6.1). By summing the geometric progression we see that\n\u22121\n\nki0 = O(\u03b1\u22121 log4 2\u03b1\u22121) and \u03bcG (B (i0 ) ) > (\u03b1/2)O(\u03b1\nInserting this in (6.1) gives the required result.\n\nlog4 2\u03b1\u22121 )\n\n.\n\u0003\n\nAcknowledgements\nThe author should like to thank an anonymous referee for useful comments and suggesting the connection between the material in \u00a74 and the Dyson e-transform, Thomas Bloom\nfor numerous corrections, Ben Green for encouragement, and Julia Wolf for many useful\ncomments and encouragement.\nReferences\n[Beh46]\n[Bou90]\n[Bou99]\n[Bou08]\n[Cha02]\n[CS10a]\n[CS10b]\n[Elk10]\n[Gre05]\n[GW10a]\n[GW10b]\n\n[HB87]\n[KK10]\n[Mes95]\n[Rot52]\n\nF. A. Behrend. On sets of integers which contain no three terms in arithmetical progression.\nProc. Nat. Acad. Sci. U. S. A., 32:331\u2013332, 1946.\nJ. Bourgain. On arithmetic progressions in sums of sets of integers. In A tribute to Paul Erd\u0151s,\npages 105\u2013109. Cambridge Univ. Press, Cambridge, 1990.\nJ. Bourgain. On triples in arithmetic progression. Geom. Funct. Anal., 9(5):968\u2013984, 1999.\nJ Bourgain. Roth's theorem on progressions revisited. J. Anal. Math., 104:155\u2013192, 2008.\nM.-C. Chang. A polynomial bound in Fre\u0131\u0306man's theorem. Duke Math. J., 113(3):399\u2013419, 2002.\nE. S. Croot and O. Sisask. A probabilistic technique for finding almost-periods of convolutions.\nGeom. Funct. Anal., 20(6):1367\u20131396, 2010.\nK. Cwalina and T. Schoen. A linear bound on the dimension in Green-Ruzsa's theorem.\nPreprint, 2010.\nM. Elkin. An improved construction of progression-free sets. In Symposium on Discrete Algorithms, pages 886\u2013905, 2010, arXiv:0801.4310.\nB. J. Green. Roth's theorem in the primes. Ann. of Math. (2), 161(3):1609\u20131636, 2005.\nW. T. Gowers and J. Wolf. Linear forms and quadratic uniformity for functions on ZN . 2010,\narXiv:1002.2210.\nB. J. Green and J. Wolf. A note on Elkin's improvement of Behrend's construction. In Additive\nnumber theory: Festschrift in honor of the sixtieth birthday of Melvyn B. Nathanson, pages\n141\u2013144. Springer-Verlag, 1st edition, 2010.\nD. R. Heath-Brown. Integer sets containing no arithmetic progressions. J. London Math. Soc.\n(2), 35(3):385\u2013394, 1987.\nN. H. Katz and P. Koester. On additive doubling and energy. SIAM J. Discrete Math.,\n24(4):1684\u20131693, 2010.\nR. Meshulam. On subsets of finite abelian groups with no 3-term arithmetic progressions. J.\nCombin. Theory Ser. A, 71(1):168\u2013172, 1995.\nK. F. Roth. Sur quelques ensembles d'entiers. C. R. Acad. Sci. Paris, 234:388\u2013390, 1952.\n\n\f16\n\nTOM SANDERS\n\n[Rot53]\n[San10]\n[Sch11]\n[SS42]\n\nK. F. Roth. On certain sets of integers. J. London Math. Soc., 28:104\u2013109, 1953.\nT. Sanders. On certain other sets of integers. J. Anal. Math., to appear, 2010, arXiv:1007.5444.\nT. Schoen. Near optimal bounds in Fre\u0131\u0306man's theorem. Duke Math. J., 158:1\u201312, 2011.\nR. Salem and D. C. Spencer. On sets of integers which contain no three terms in arithmetical\nprogression. Proc. Nat. Acad. Sci. U. S. A., 28:561\u2013563, 1942.\n[SS10]\nT. Schoen and I. Shkredov. Additive properties of multiplicative subgroups in Fp . Quart. J.\nMath., 2010. to appear.\n[Sze90]\nE. Szemer\u00e9di. Integer sets containing no arithmetic progressions. Acta Math. Hungar., 56(12):155\u2013158, 1990.\n[TV06]\nT. C. Tao and H. V. Vu. Additive combinatorics, volume 105 of Cambridge Studies in Advanced\nMathematics. Cambridge University Press, Cambridge, 2006.\n[YFHY01] R. Yao-Feng and L. Han-Ying. On the best constant in marcinkiewicz-zygmund inequality.\nStatistics & Probability Letters, 53(3):227 \u2013 233, 2001.\nDepartment of Pure Mathematics and Mathematical Statistics, University of Cambridge, Wilberforce Road, Cambridge CB3 0WB, England\nE-mail address: t.sanders@dpmms.cam.ac.uk\n\n\f"}