{"id": "http://arxiv.org/abs/math/0509359v6", "guidislink": true, "updated": "2006-08-27T23:15:34Z", "updated_parsed": [2006, 8, 27, 23, 15, 34, 6, 239, 0], "published": "2005-09-15T19:27:21Z", "published_parsed": [2005, 9, 15, 19, 27, 21, 3, 258, 0], "title": "Linear superposition in nonlinear wave dynamics", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0509630%2Cmath%2F0509719%2Cmath%2F0509244%2Cmath%2F0509411%2Cmath%2F0509648%2Cmath%2F0509356%2Cmath%2F0509015%2Cmath%2F0509688%2Cmath%2F0509552%2Cmath%2F0509485%2Cmath%2F0509087%2Cmath%2F0509680%2Cmath%2F0509113%2Cmath%2F0509339%2Cmath%2F0509461%2Cmath%2F0509401%2Cmath%2F0509274%2Cmath%2F0509115%2Cmath%2F0509176%2Cmath%2F0509598%2Cmath%2F0509386%2Cmath%2F0509287%2Cmath%2F0509508%2Cmath%2F0509652%2Cmath%2F0509581%2Cmath%2F0509560%2Cmath%2F0509059%2Cmath%2F0509666%2Cmath%2F0509403%2Cmath%2F0509024%2Cmath%2F0509481%2Cmath%2F0509064%2Cmath%2F0509415%2Cmath%2F0509547%2Cmath%2F0509585%2Cmath%2F0509332%2Cmath%2F0509199%2Cmath%2F0509488%2Cmath%2F0509055%2Cmath%2F0509644%2Cmath%2F0509188%2Cmath%2F0509707%2Cmath%2F0509374%2Cmath%2F0509452%2Cmath%2F0509131%2Cmath%2F0509650%2Cmath%2F0509002%2Cmath%2F0509101%2Cmath%2F0509451%2Cmath%2F0509081%2Cmath%2F0509006%2Cmath%2F0509657%2Cmath%2F0509242%2Cmath%2F0509327%2Cmath%2F0509682%2Cmath%2F0509169%2Cmath%2F0509541%2Cmath%2F0509664%2Cmath%2F0509323%2Cmath%2F0509421%2Cmath%2F0509296%2Cmath%2F0509359%2Cmath%2F0509363%2Cmath%2F0509078%2Cmath%2F0509307%2Cmath%2F0509690%2Cmath%2F0509325%2Cmath%2F0509054%2Cmath%2F0509187%2Cmath%2F0509215%2Cmath%2F0509465%2Cmath%2F0509348%2Cmath%2F0509526%2Cmath%2F0509140%2Cmath%2F0509301%2Cmath%2F0509724%2Cmath%2F0509469%2Cmath%2F0509446%2Cmath%2F0509529%2Cmath%2F0509091%2Cmath%2F0509450%2Cmath%2F0509028%2Cmath%2F0509713%2Cmath%2F0509647%2Cmath%2F0509090%2Cmath%2F0509157%2Cmath%2F0509422%2Cmath%2F0509018%2Cmath%2F0509693%2Cmath%2F0509077%2Cmath%2F0509440%2Cmath%2F0509351%2Cmath%2F0509023%2Cmath%2F0509638%2Cmath%2F0509629%2Cmath%2F0509463%2Cmath%2F0509132%2Cmath%2F0509226%2Cmath%2F0509134%2Cmath%2F0509160%2Cmath%2F0509381&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Linear superposition in nonlinear wave dynamics"}, "summary": "We study nonlinear dispersive wave systems described by hyperbolic PDE's in\nR^{d} and difference equations on the lattice Z^{d}. The systems involve two\nsmall parameters: one is the ratio of the slow and the fast time scales, and\nanother one is the ratio of the small and the large space scales. We show that\na wide class of such systems, including nonlinear Schrodinger and Maxwell\nequations, Fermi-Pasta-Ulam model and many other not completely integrable\nsystems, satisfy a superposition principle. The principle essentially states\nthat if a nonlinear evolution of a wave starts initially as a sum of generic\nwavepackets (defined as almost monochromatic waves), then this wave with a high\naccuracy remains a sum of separate wavepacket waves undergoing independent\nnonlinear evolution. The time intervals for which the evolution is considered\nare long enough to observe fully developed nonlinear phenomena for involved\nwavepackets. In particular, our approach provides a simple justification for\nnumerically observed effect of almost non-interaction of solitons passing\nthrough each other without any recourse to the complete integrability. Our\nanalysis does not rely on any ansatz or common asymptotic expansions with\nrespect to the two small parameters but it uses rather explicit and\nconstructive representation for solutions as functions of the initial data in\nthe form of functional analytic series.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0509630%2Cmath%2F0509719%2Cmath%2F0509244%2Cmath%2F0509411%2Cmath%2F0509648%2Cmath%2F0509356%2Cmath%2F0509015%2Cmath%2F0509688%2Cmath%2F0509552%2Cmath%2F0509485%2Cmath%2F0509087%2Cmath%2F0509680%2Cmath%2F0509113%2Cmath%2F0509339%2Cmath%2F0509461%2Cmath%2F0509401%2Cmath%2F0509274%2Cmath%2F0509115%2Cmath%2F0509176%2Cmath%2F0509598%2Cmath%2F0509386%2Cmath%2F0509287%2Cmath%2F0509508%2Cmath%2F0509652%2Cmath%2F0509581%2Cmath%2F0509560%2Cmath%2F0509059%2Cmath%2F0509666%2Cmath%2F0509403%2Cmath%2F0509024%2Cmath%2F0509481%2Cmath%2F0509064%2Cmath%2F0509415%2Cmath%2F0509547%2Cmath%2F0509585%2Cmath%2F0509332%2Cmath%2F0509199%2Cmath%2F0509488%2Cmath%2F0509055%2Cmath%2F0509644%2Cmath%2F0509188%2Cmath%2F0509707%2Cmath%2F0509374%2Cmath%2F0509452%2Cmath%2F0509131%2Cmath%2F0509650%2Cmath%2F0509002%2Cmath%2F0509101%2Cmath%2F0509451%2Cmath%2F0509081%2Cmath%2F0509006%2Cmath%2F0509657%2Cmath%2F0509242%2Cmath%2F0509327%2Cmath%2F0509682%2Cmath%2F0509169%2Cmath%2F0509541%2Cmath%2F0509664%2Cmath%2F0509323%2Cmath%2F0509421%2Cmath%2F0509296%2Cmath%2F0509359%2Cmath%2F0509363%2Cmath%2F0509078%2Cmath%2F0509307%2Cmath%2F0509690%2Cmath%2F0509325%2Cmath%2F0509054%2Cmath%2F0509187%2Cmath%2F0509215%2Cmath%2F0509465%2Cmath%2F0509348%2Cmath%2F0509526%2Cmath%2F0509140%2Cmath%2F0509301%2Cmath%2F0509724%2Cmath%2F0509469%2Cmath%2F0509446%2Cmath%2F0509529%2Cmath%2F0509091%2Cmath%2F0509450%2Cmath%2F0509028%2Cmath%2F0509713%2Cmath%2F0509647%2Cmath%2F0509090%2Cmath%2F0509157%2Cmath%2F0509422%2Cmath%2F0509018%2Cmath%2F0509693%2Cmath%2F0509077%2Cmath%2F0509440%2Cmath%2F0509351%2Cmath%2F0509023%2Cmath%2F0509638%2Cmath%2F0509629%2Cmath%2F0509463%2Cmath%2F0509132%2Cmath%2F0509226%2Cmath%2F0509134%2Cmath%2F0509160%2Cmath%2F0509381&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We study nonlinear dispersive wave systems described by hyperbolic PDE's in\nR^{d} and difference equations on the lattice Z^{d}. The systems involve two\nsmall parameters: one is the ratio of the slow and the fast time scales, and\nanother one is the ratio of the small and the large space scales. We show that\na wide class of such systems, including nonlinear Schrodinger and Maxwell\nequations, Fermi-Pasta-Ulam model and many other not completely integrable\nsystems, satisfy a superposition principle. The principle essentially states\nthat if a nonlinear evolution of a wave starts initially as a sum of generic\nwavepackets (defined as almost monochromatic waves), then this wave with a high\naccuracy remains a sum of separate wavepacket waves undergoing independent\nnonlinear evolution. The time intervals for which the evolution is considered\nare long enough to observe fully developed nonlinear phenomena for involved\nwavepackets. In particular, our approach provides a simple justification for\nnumerically observed effect of almost non-interaction of solitons passing\nthrough each other without any recourse to the complete integrability. Our\nanalysis does not rely on any ansatz or common asymptotic expansions with\nrespect to the two small parameters but it uses rather explicit and\nconstructive representation for solutions as functions of the initial data in\nthe form of functional analytic series."}, "authors": ["A. Babin", "A. Figotin"], "author_detail": {"name": "A. Figotin"}, "author": "A. Figotin", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1142/S0129055X06002851", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/math/0509359v6", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0509359v6", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "New introduction written, style changed, references added and typos\n  corrected", "arxiv_primary_category": {"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "35L70;35L75; 35L90;35G55;35Q60; 34C15;37K60; 39A12", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0509359v6", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0509359v6", "journal_reference": null, "doi": "10.1142/S0129055X06002851", "fulltext": "arXiv:math/0509359v6 [math.AP] 27 Aug 2006\n\nLinear superposition in nonlinear wave dynamics\nA. Babin and A. Figotin\nDepartment of Mathematics, University of California at Irvine, CA 92697\nSeptember 27, 2018\nAbstract\nWe study nonlinear dispersive wave systems described by hyperbolic PDE's in Rd\nand difference equations on the lattice Zd . The systems involve two small parameters:\none is the ratio of the slow and the fast time scales, and another one is the ratio of\nthe small and the large space scales. We show that a wide class of such systems,\nincluding nonlinear Schrodinger and Maxwell equations, Fermi-Pasta-Ulam model and\nmany other not completely integrable systems, satisfy a superposition principle. The\nprinciple essentially states that if a nonlinear evolution of a wave starts initially as a sum\nof generic wavepackets (defined as almost monochromatic waves), then this wave with\na high accuracy remains a sum of separate wavepacket waves undergoing independent\nnonlinear evolution. The time intervals for which the evolution is considered are long\nenough to observe fully developed nonlinear phenomena for involved wavepackets. In\nparticular, our approach provides a simple justification for numerically observed effect\nof almost non-interaction of solitons passing through each other without any recourse\nto the complete integrability. Our analysis does not rely on any ansatz or common\nasymptotic expansions with respect to the two small parameters but it uses rather\nexplicit and constructive representation for solutions as functions of the initial data in\nthe form of functional analytic series.\n\n1\n\nIntroduction\n\nThe principal object of our studies here is a general nonlinear evolutionary system which\ndescribes wave propagation in homogeneous media governed either by a hyperbolic PDE's in\nRd or by a difference equation on the lattice Zd , d = 1, 2, 3, . . . is the space dimension. We\nassume the evolution to be governed by the following equation with constant coefficients\ni\n\u2202\u03c4 U = \u2212 L (\u2212i\u2207) U + F (U) , U (r, \u03c4 )|\u03c4 =0 = h (r) , r \u2208 Rd ,\n\u033a\n\n(1.1)\n\nwhere (i) U = U (r, \u03c4 ), r \u2208 Rd , U \u2208 C2J is a 2J dimensional vector; (ii) L (\u2212i\u2207) is a\nlinear self-adjoint differential (pseudodifferential) operator with constant coefficients with\n1\n\n\fthe symbol L (k), which is a Hermitian 2J \u00d7 2J matrix; (iii) F is a general polynomial\nnonlinearity; (iv) \u033a > 0 is a small parameter. The form of the equation suggests that the\nprocesses described by it involve two time scales. Since the nonlinearity F (U) is of order\none, nonlinear effects occur at times \u03c4 of order one, whereas the natural time scale of linear\neffects, governed by the operator L with the coefficient 1/\u033a, is of order \u033a. Consequently,\nthe small parameter \u033a measures the ratio of the slow (nonlinear effects) time scale and the\nfast (linear effects) time scale. A typical example an equation of the form (1.1) is nonlinear\nSchrodinger equation (NLS) or a system of NLS. Another one is the Maxwell equation in\na periodic medium when truncated to a finite number of bands, and more examples are\ndiscussed below.\nWe assume further that the initial data h for the evolution equation (1.1) to be the sum\nof a finite number of wavepackets hl , l = 1, . . . , N, i.e.\nh = h1 + . . . + hN\n\n(1.2)\n\nwhere the monochromaticity of every wavepacket hl is characterized by another small parameter \u03b2.\nThe well known superposition principle is a fundamental property of every linear evolutionary system, stating that the solution U corresponding to the initial data h as in (1.2)\nequals\nU = U1 + . . . + UN , for h = h1 + . . . + hN ,\n(1.3)\nwhere Ul is the solution to the same linear problem with the initial data hl .\nEvidently the standard superposition principle can not hold exactly as a general principle\nin the presence of a nonlinearity, and, at the first glance, there is no expectation for it to\nhold even approximately. We have discovered though that the superposition principle does\nhold with a high accuracy for general dispersive nonlinear wave systems provided that the\ninitial data are a sum of generic wavepackets, and this constitutes the subject of this paper.\nNamely, the superposition principle for nonlinear wave systems states that the solution U\ncorresponding to the multi-wavepacket initial data h as in (1.2) equals\nU = U1 + . . . + UN + D, for h = h1 + . . . + hN , where D is small.\nAs to the particular form (1.1) we chose to be our primary one, we would like to point out\nthat many important classes of problems involving small parameters can be readily reduced\nto the framework of (1.1) by a simple rescaling. It can be seen from the following examples.\nFirst example is a system with a small factor before the nonlinearity\n\u2202t v = \u2212iLv + \u03b1f (v) , v|t=0 = h, 0 < \u03b1 \u226a 1,\n\n(1.4)\n\nwhere initial data are bounded uniformly in \u03b1. Such problems are reduced to (1.1) by\nthe time rescaling \u03c4 = t\u03b1. Note that now \u033a = \u03b1 and the finite time interval 0 \u2264 \u03c4 \u2264 \u03c4 \u2217\ncorresponds to the long time interval 0 \u2264 t \u2264 \u03c4 \u2217 /\u03b1.\n2\n\n\fSecond example is a system with small initial data on a long time interval. The system\nhere is given and has no small parameters but the initial data are small, namely\n\u2202t v = \u2212iLv + f0 (v) , v|t=0 = \u03b10 h, 0 < \u03b10 \u226a 1, where\n(m)\n\nf0 (v) = f0\n\n(m+1)\n\n(v) + f0\n\n(1.5)\n\n(v) + . . . ,\n\nwhere \u03b10 is a small parameter and f (m) (v) is a homogeneous polynomial of degree m \u2265 2.\nAfter the rescaling v = \u03b10 V we obtain the following equation with a small nonlinearity\nh\ni\n(m)\n0(m+1)\nm\u22121\nf0 (V) + \u03b10 f\n(V) + . . . , V|t=0 = h,\n(1.6)\n\u2202t V = \u2212iLV + \u03b10\nwhich is of the form of (1.4) with \u03b1 = \u03b1m\u22121\n. Introducing the slow time variable \u03c4 = t\u03b1m\u22121\n0\n0\nwe get from the above an equation of the form (1.1), namely\n\u2202\u03c4 V = \u2212\n\ni\n\nLV\n\u03b1m\u22121\n0\n\n\u0002\n\u0003\n+ f (m) (V) + \u03b10 f (m+1) (V) + . . . , V|t=0 = h,\n\n(1.7)\n\nwhere the nonlinearity does not vanish as \u03b10 \u2192 0. In this case \u033a = \u03b1m\u22121\nand the finite time\n0\n\u03c4\u2217\ninterval 0 \u2264 \u03c4 \u2264 \u03c4 \u2217 corresponds to the long time interval 0 \u2264 t \u2264 \u03b1m\u22121\nwith small \u03b10 \u226a 1.\n0\nVery often in theoretical studies of equations of the form (1.1) or ones reducible to it a\nfunctional dependence between \u033a and \u03b2 is imposed, resulting in a single small parameter.\nThe most common scaling is \u033a = \u03b2 2 . The nonlinear evolution of wavepackets for a variety\nof equations which can be reduced to the form (1.1) was studied in numerous physical and\nmathematical papers, mostly by asymptotic expansions of solutions with respect to a single\nsmall parameter similar to \u03b2, see [11], [14], [18], [20], [23], [28], [29], [34], [38], [39], [40]\nand references therein. Often the asymptotic expansions are based on a specific ansatz\nprescribing a certain form to the solution. In our studies here we do not use asymptotic\nexpansions with respect to a small parameter and do not prescribe a specific form to the\nsolution, but we impose conditions on the initial data requiring it to be a wavepacket or a\nlinear combination of wavepackets. Since we want to establish a general property of a wide\nclass of systems, we apply a general enough dynamical approach. There is a number of general\napproaches developed for the studies of high-dimensional and infinite-dimensional nonlinear\nevolutionary systems of hyperbolic type, [10], [13], [19], [22], [27], [31], [35], [39], [41], [43],\n[45]) and references therein. We develop here an approach which allows to exploit specific\nproperties of a certain class of initial data, namely wavepackets and their linear combinaions,\nwhich comply with the symmetries of equations. Such a class of the initial data is obviously\nlesser than all possible initial data. One of the key mathematical tools developed here for\nthe nonlinear studies is a refined implicit function theorem (Theorem 4.25). This theorem\nprovides a constructive and rather explicit representation of the solution to an abstract\nnonlinear equation in a Banach space as a certain functional series. The representation is\nexplicit enough to prove the superposition principle and is general enough to carry out the\nstudies of the problem without imposing restrictions on dimension of the problem, structural\n3\n\n\frestrictions on nonlinearities or a functional dependence between the two small parameters\n\u033a, \u03b2.\nAs we have already stated the superposition principle holds with high accuracy for linear\ncombinations of wavepackets. A wavepacket h (\u03b2, r) can be most easily described in terms\nof its Fourier transform h\u0303 (\u03b2, k). Simply speaking, wavepacket h\u0303 (\u03b2, k) is a function which is\nlocalized in \u03b2-neighborhood of a given wavevector k\u2217 (the wavepacket center) and as a vector\nis an eigenfunction of the matrix L (k), details of the definition of the wavepacket can be\nfound in the following Section 2. The simplest example of a wavepacket is a function of the\nform\n\u0012\n\u0013\nk \u2212 k\u2217\n\u2212d\nh\u0303 (\u03b2, k) = \u03b2 \u0125\ngn (k\u2217 ) , k \u2208 Rd ,\n(1.8)\n\u03b2\nwhere gn (k\u2217 ) is an eigenvector of the matrix L (k\u2217 ) and \u0125 (k) is a Schwartz function (i.e. it is\ninfinitely smooth and rapidly decaying one). Note that the inverse Fourier transform h (\u03b2, r)\nof h\u0303 (\u03b2, k) has the form\nh (\u03b2, r) = h (\u03b2r) eik\u2217 r gn (k\u2217 ) , r \u2208 Rd ,\n\n(1.9)\n\nwhere h (r) is a Schwartz function, and obviously has a large spatial extension of order \u03b2 \u22121 .\nWe study the nonlinear evolution equation (1.1) on a finite time interval\n0 \u2264 \u03c4 \u2264 \u03c4 \u2217 , where \u03c4 \u2217 > 0 is a fixed number\n\n(1.10)\n\nwhich may depend on the L\u221e norm of the initial data h but, importantly, \u03c4 \u2217 does not depend\non \u033a. We consider classes of initial data such that wave evolution governed by (1.1) is\nsignificantly nonlinear on time interval [0, \u03c4 \u2217 ] and the effect of the nonlinearity F (U) does\nnot vanish as \u033a \u2192 0. We assume that \u03b2, \u033a satisfy\n0 < \u03b2 \u2264 1, 0 < \u033a \u2264 1,\n\n\u03b22\n\u2264 C1 with some C1 > 0.\n\u033a\n\n(1.11)\n\n2\n\nThe above condition on the dispersion parameter \u03b2\u033a ensures that the dispersive effects are\nnot dominant and do not suppress nonlinear effects, see [7] for a discussion.\nTo formulate the superposition principle more precisely we introduce first the solution\noperator S (h) (\u03c4 ) : h \u2192 U (\u03c4 ) which relates to the initial data h of the nonlinear evolution\nequation (1.1) the solution\nXU (t) of this equation. Suppose that the initial state is a multiwavepacket, namely h =\nhl , with hl , l = 1, . . . , N being \"generic\" wavepackets. Then for\nall times 0 \u2264 \u03c4 \u2264 \u03c4 \u2217 the following superposition principle holds\n\u0011\n\u0010XN\nXN\nS (hl ) (\u03c4 ) + D (\u03c4 ) ,\n(1.12)\nhl (\u03c4 ) =\nS\nl=1\nl=1\n\u033a\nkD (\u03c4 )kE = sup kD (\u03c4 )kL\u221e \u2264 C\u03b4 1+\u03b4 for any small \u03b4 > 0.\n(1.13)\n\u03b2\n0\u2264\u03c4 \u2264\u03c4 \u2217\nObviously, the right-hand side of (1.13) may be small only if \u033a \u2264 C1 \u03b2. There are examples\n(see [7]) in which D (\u03c4 ) is not small for \u033a = C1 \u03b2. In what follows we refer to a linear\n4\n\n\fcombination of wavepackets as a multi-wavepacket, and to wavepackets which constitutes the\nmulti-wavepacket as component wavepackets.\nThe superposition principle implies, in particular, that in the process of nonlinear evolution every single wavepacket propagates almost independently of other wavepackets even\nthough they may \"collide\" in physical space for a certain period of time and the exact solution\nequals the sum of particular single wavepacket solutions with a high precision. In particular, the dynamics of a solution with multi-wavepacket initial data is reduced to dynamics of\nseparate solutions with single wavepacket data. Note that the nonlinear evolution of a single\nwavepacket solution for many problems is studied in detail, namely it is well approximated\nby its own nonlinear Schrodinger equation (NLS), see [18], [23], [29], [30], [39], [40], [41], [7]\nand references therein.\nThe superposition principle (1.12), (1.13) can also be looked at as a form of separation of\nvariables. Such a form of separation of variables is different from usual complete integrability,\nand its important factor is the continuity of spectrum of the linear component of the system.\nThe approximate superposition principle imposes certain restrictions on dynamics which\ndiffer from usual constraints imposed by the conserved quantities as in completely integrable\nsystems as well as from topological constraints related to invariant tori as in KAM theory.\nNow we present an elementary physical argument justifying the superposition principle.\nIf nonlinearity is absent, the superposition principle holds exactly and any deviation from it is\ndue to the nonlinear interactions between wavepackets, so we need to estimate their impact.\nSuppose that initially at time \u03c4 = 0 the spatial extension s of every composite wavepacket is\ncharacterized by the parameter \u03b2 \u22121 as in (1.9). Assume also (and it is quite an assumption)\nthat the component wavepackets during the nonlinear evolution maintain somehow their\nwavepacket identity, group velocities and spatial extension. Then, consequently, the spatial\nextension of every component wavepacket is propositional to \u03b2 \u22121 and its group velocity vj is\nproportional to \u033a\u22121 . The difference \u2206v between any two different component group velocities\nis also proportional to \u033a\u22121 . The time when two different component wavepackets overlap in\nspace is proportional to s/ |\u2206v| and, hence, to \u033a/\u03b2. Since the nonlinear term is of order\none, the magnitude of the impact of the nonlinearity during this time interval should be\nproportional to \u033a/\u03b2, which results in the same order of magnitude of D. This conclusion is\nin agreement with the estimate of magnitude of D in (1.13) (if we set \u03b4 = 0).\nThe rigorous proof of the superposition principle we present in this paper is not based\non the above argument since it implicitly relies on a superposition principle in the form\nof an assumption that component wavepackets can somehow maintain their identity, group\nvelocities and spatial extension during nonlinear evolution which by no means is obvious. In\nfact, the question if a wavepacket or a multi-wavepacket structure can be preserved during\nnonlinear evolution is important and interesting question on its own right. The answer\nto it under natural conditions is affirmative as we have shown in [7]. Namely, if initially\nsolution was a multi-wavepacket at \u03c4 = 0, it remains a multi-wavepacket at \u03c4 > 0, and every\ncomponent wavepacket maintains its identity. Therefore a wavepacket can be interpreted as\na quasi-particle which maintains its identity and can interact with other quasi-particles. This\nproperty holds also in the situation when there are stronger nonlinear interactions between\n5\n\n\fwavepacket components which do not allow the superposition principle to hold, see [7] for\ndetails.\nThe proof we present here is based on general algebraic-functional considerations. The\nstrategy of our proof is as follows. First, we prove that the operator S (h) in (1.12) is\nanalytical, i.e. it can be written in the form of a convergent series\nX\u221e\n\u0001\nS (j) hj , hj = h, . . . , h (j copies of h),\nS (h) =\nj=1\n\nwhere S (j) (hj ) is a j-linear operator applied to h. Now we substitute h in S (j) with the sum\nof hl as in (1.2). Considering for simplicity the case N = 2 and using the polylinearity of\nS (j) we get\n\u0001\n\u0001\n\u0001\nS (2) (h1 + h2 )2 = S (2) (h1 )2 + 2S (2) (h1 h2 ) + S (2) (h2 )2 , . . . ,\nimplying after the summation\n\u0001\n\u0001\n\u0001\n\u0001\nS (h) = S (2) (h1 )2 + S (3) (h1 )3 + . . . + S (2) (h2 )2 + S (3) (h2 )3 + . . . Scr\n= S (h1 ) + S (h2 ) + Scr ,\n\nwhere Scr is a sum of all cross-terms such as S (2) (h1 h2 ) etc. The main part of the proof is\nto show that every term in Scr is small. An important step for that is based on the refined\nimplicit function theorem (Theorem 4.25) which allows to represent the operators S (j) in the\nform of a sum of certain composition monomials, which, in turn, have a relatively simple\noscillatory integral representation. Importantly, the relevant oscillatory integrals involve the\nknown initial data hl rather than unknown solution U. The analysis of the oscillatory integrals shows that there are two mechanisms responsible for the smallness of the integrals.\nThe first one is time averaging, and the second one is based on large group velocities (in\nthe slow time scale) of wavepackets. Remarkably, if wavepackets satisfy proper genericity\nconditions, every cross term is small due one of the above mentioned two mechanisms. Importantly, the both mechanism are instrumental for the smallness of terms in Scr , and the\ntime averaging alone is not sufficient. We obtain estimates on terms in Scr which ultimately\nyield the estimate (1.13). Since the smallness of interactions between waves under nonlinear\nevolution stems from high frequency oscillations in time and space of functions involved in\nthe interaction integrals, we can interpret it as a result of the destructive wave interference.\nThe above sketch shows that the mathematical tools we use in our studies are (i) the theory\nof analytic functions and corresponding series of infinite-dimensional (Banach) variable, and\n(ii) the theory of oscillatory integrals.\nWe would like to point out that the estimate (1.13) for the remainder in the superposition\nprinciple is quite accurate. For example, when the estimate is applied to the sine-Gordon\nequation with bimodal initial data, it yields essentially optimal estimates for the magnitude\nof the interaction of counterpropagating waves. These estimates are more accurate than\nones obtained by the well known ansatz method as in [38], and the comparative analysis is\nprovided below in Example 1, Section 2.2.\nTo summarize the above analysis we list important ingredients of our approach.\n6\n\n\f\u2022 The spectrum of the underlying linear problem is continuous.\n\u2022 The wave nonlinear evolution is analyzed based on the modal decomposition with respect to the linear component of the system because there is no exchange of energy\nbetween modes by linear mechanisms. Wavepacket definition is based on the modal\nexpansion determining, in particular, its the spatial extension and the group velocity..\n\u2022 The problem involves two small parameters \u03b2 and \u033a respectively in the initial data\nand coefficients of the equations. These parameters scale respectively (i) the range of\nwavevectors involved in its modal composition, with \u03b2 \u22121 scaling its spatial extension,\nand (ii) \u033a scaling the ratio of the slow and the fast time scales. We make no assumption\non the functional dependence between \u03b2 and \u033a, which are essentially independent and\nare subject only to inequalities.\n\u2022 The nonlinear evolution is studied for a finite time \u03c4 \u2217 which may depend on, say,\nthe amplitude of the initial excitation, and, importantly, \u03c4 \u2217 is long enough to observe\nappreciable nonlinear phenomena which are not vanishingly small. The superposition\nprinciple can be extended to longer time intervals up to blow-up time or even infinity if\nrelevant uniform in \u03b2 and \u033a estimates of solutions in appropriate norms are available.\n\u2022 Two fast wave processes (in the chosen slow time scale) attributed to the linear operator\nL and having typical time scale of order \u033a can be identified as responsible for the\nessential independence of wavepackets: (i) fast time oscillations which lead to time\naveraging; (ii) fast wavepacket propagation with large group velocities produce effective\nweakening of interactions which are not subjected to time averaging.\nThe rest of the paper is organized as follows. In the following Section 2 we formulate exact conditions and theorems for lattice equations and partial differential equations and give\nexamples. In Section 3 we recast the original evolution equation in a convenient reduced form\nallowing, in particular, to construct a representation of the solution in a form of convergent\nfunctional operator series explicitly involving the equation nonlinear term. In Section 4 we\nprovide the detailed analysis of function-analytic series used to get a constructive representation of the solution. Section 5 is devoted to the analysis of certain oscillatory integrals\nwhich are terms of the series representing the solution. Note that when making estimations\nwe use the same letter C for different constants in different statements. Finally, the proofs\nof Theorems 2.15 and 2.19 are provided in Section 6. more examples and generalizations are\ngiven in Section 7. For reader's convenience we provide a list of notations in the end of the\npaper.\n\n2\n\nStatement of results\n\nIn this section we consider two classes of problems: lattice equations and partial differential\nequations. After Fourier transform they can be written in the modal form which is essentially\n7\n\n\fthe same in both cases. We formulate the exact conditions on the modal equations and present\nthe main theorems on the superposition principle. We also give examples of equations to\nwhich the general theorems apply, in particular Fermi-Pasta-Ulam system and Nonlinear\nSchrodinger equation.\n\n2.1\n\nMain definitions, statements and examples for the lattice equation\n\nThe first class of evolutionary systems we consider involves systems of equations describing\ncoupled nonlinear oscillators on a lattice Zd , namely the following lattice system of ordinary\ndifferential equations (ODE's) with respect to time\ni\n\u2202\u03c4 U (m, \u03c4 ) = \u2212 LU (m, \u03c4 ) + F (U) (m, \u03c4 ) , U (m, 0) = h (m) , m \u2208 Zd ,\n\u033a\n\n(2.1)\n\nwhere L is a linear operator, F is a nonlinear operator and \u033a > 0 is a small parameter (see\n[6]). To analyze the evolution equation (2.1) it is instrumental to recast it in the modal\nform (the wavevector domain), in other words, to apply to it the lattice Fourier transform\nas defined by the formula\nX\n\u0168 (k) =\nU (m) e\u2212im*k , where k \u2208 [\u2212\u03c0, \u03c0]d ,\n(2.2)\nm\u2208Zd\n\nk is called a wave vector. We assume that the Fourier transformation of the original lattice\nevolutionary equation (2.1) is of the form\n\u0010 \u0011\ni\n\u2202\u03c4 \u0168 (k, \u03c4 ) = \u2212 L (k) \u0168 (k, \u03c4 ) + F\u0303 \u0168 (k, \u03c4 ) ; \u0168 (k, 0) = h\u0303 (k) for \u03c4 = 0.\n\u033a\n\n(2.3)\n\nHere, \u0168 (k, \u03c4 ) is 2J- component vector, L\u0010(k)\u0011 is a k-dependent 2J \u00d7 2J matrix that corresponds to the linear operator L and F\u0303 \u0168 is a nonlinear operator, which we describe\n\u0010 \u0011\nlater. The matrix L (k) and the coefficients of the nonlinear operator F\u0303 \u0168 in (2.3) are 2\u03c0-\n\nperiodic functions of k and for that reason we assume that k belongs to the torus Rd / (2\u03c0Z)d\nwhich we denote by [\u2212\u03c0, \u03c0]d . The k-dependent matrix L (k) determines the linear operator\nL and plays an important role in the analysis. We refer to L (k) as to the linear symbol.\nSince (2.3) describes evolution of the Fourier modes of the solution, we call (2.3) modal\nevolution equation.\nWe study the modal evolution equation (2.3) on a finite time interval\n0 \u2264 \u03c4 \u2264 \u03c4 \u2217,\n\n(2.4)\n\nwhere \u03c4 \u2217 > 0 is a fixed number which, as we will see, may depend on the magnitude of the\ninitial data. The time \u03c4 \u2217 does not depend on small parameters, it is of order one and is\n8\n\n\fdetermined by norms of operators and initial data; it is almost optimal for general F since\nthere are examples when \u03c4 \u2217 is of the same order as the blow up time of solutions. To make\nformulas and estimates simpler we assume without loss of generality that\n\u03c4 \u2217 \u2264 1.\n\n(2.5)\n\nFor a number of reasons the modal form (2.3) of the evolution equation is much more suitable\nfor nonlinear analysis than the original evolution equation (2.1). This is why from now on\nwe consider the modal form of evolution equation (2.3) for the modal components \u0168 (k, \u03c4 ) as\nour primary evolution equation.\nFirst, as an illustration, let us look at the simplest nontrivial example of (2.3) with J = 1\ncorresponding to two-component vector fields on the lattice Zd . A two-component vector\nfunction U (m) of a discrete argument m \u2208 Zd has the form\n\u0014\n\u0015\nU+ (m)\nU (m) =\n, m \u2208 Zd .\n(2.6)\nU\u2212 (m)\nIn this example L (k) in (2.3) is a 2 \u00d7 2 matrix, and we assume that for almost all k it has\ntwo different real eigenvalues \u03c9 \u2212 (k) and \u03c9 + (k) (the dependence of \u03c9 \u00b1 (k) on k is called the\ndispersion relation) satisfying the relation \u03c9 \u2212 (k) = \u2212\u03c9 + (k), namely,\nL (k) g\u03b6 (k) = \u03c9 \u03b6 (k) g\u03b6 (k) , \u03c9 \u03b6 (k) = \u03b6\u03c9 (k) , \u03b6 = \u00b1,\n\n(2.7)\n\nwhere, evidently, g\u03b6 (k) are the eigenvectors of L (k). These eigenvalues \u03c9 \u03b6 (k), \u03b6 = \u00b1, are\n2\u03c0-periodic real valued functions\n\u03c9 \u03b6 (k1 + 2\u03c0, k2 , . . . , kd ) = . . . = \u03c9 \u03b6 (k1 , k2 , . . . , kd + 2\u03c0) = \u03c9 \u03b6 (k1 , k2 , . . . , kd ) .\n(2.8)\n\u0010 \u0011\n\u0010 \u0011\nThe simplest nonlinearity in (2.3) is a quadratic nonlinear operator F\u0303 \u0168 = F\u0303 (2) \u01682\nwhich is given by the following convolution integral\nZ\n\u0011\n\u0010\n\u0011\n\u0010\n\u0011\u0010\n1\n(2)\n(2)\n~k \u01681 (k\u2032 ) \u01682 (k\u2032\u2032 ) dk\u2032 ,\n\u01681 \u01682 (k) =\nF\u0303\n(2.9)\n\u03c7\nk,\n(2\u03c0)d\nk\u2032 \u2208[\u2212\u03c0,\u03c0]d ; k\u2032 +k\u2032\u2032 =k\n\n\u0010\n\u0011\n\u2032\n\u2032\u2032\n(2)\n~\n~\nk, k is a quadratic tensor (susceptibility) which acts on vectors\nwhere k = (k , k ), \u03c7\n\n\u01681 , \u01682 . We refer to the case J = 1 as the one-band case since the corresponding linear\noperator is described by a single function \u03c9 (k).\nA particular example of (2.3) is obtained as a Fourier transform of the following FermiPasta-Ulam equation (FPU) (see [12], [37], [44]) describing a nonlinear system of coupled\noscillators:\n1\n\u2202\u03c4 xn = (yn \u2212 yn\u22121 ) ,\n(2.10)\n\u033a\n1\n\u2202\u03c4 yn = (xn+1 \u2212 xn ) + \u03b12 (xn+1 \u2212 xn )2 + \u03b13 (xn+1 \u2212 xn )3 , n \u2208 Z.\n\u033a\n9\n\n\fNote that an equivalent form of (2.10) (with \u03b12 = 0) is the second order equation\n\u2202\u03c42 xn =\n\n1\n\u03b13\n3\n3\u0001\n(x\n\u2212\nx\n)\n\u2212\n(x\n\u2212\nx\n)\n.\n(x\n\u2212\n2x\n+\nx\n)\n+\nn+1\nn\nn\nn\u22121\nn\u22121\nn\nn+1\n\u033a2\n\u033a\n\n(2.11)\n\nIn this example d = 1, k = k and elementary computations show that the Fourier transform\nof the FPU equation (2.10) has the form of the modal evolution equation (2.3), (2.9) where\n\u0014\n\u0014 \u0015\n\u0001\u2217 \u0015\nk\nx\u0303\n0 \u0001 \u2212 1 \u2212 e\u2212ik\n(2.12)\n, iL (k) =\n\u0168 =\n, \u03c9 \u03b6 (k) = 2\u03b6 sin ,\n\u2212ik\n\u1ef9\n1\u2212e\n0\n2\n\u0015\n\u0011\u0014\n\u0011\u0010\n\u0010\n0\n\u2212ik \u2032\u2032\n(2)\n\u2032\n\u2032\u2032\n\u2032\n\u2032\u2032\n\u2212ik \u2032\n,\n1\u2212e\n\u03c7 (k, k , k ) \u01681 (k ) \u01682 (k ) = \u03b12 1 \u2212 e\nx\u03031 (k \u2032 ) x\u03032 (k \u2032\u2032 )\nand a similar formula for \u03c7(3) (see (7.5)).\nNow let us consider the general multi-component vector case with J > 1 which we refer\nto as J-band case for which the system (2.3) has 2J components, and instead of (2.7) we\nassume that L (k) has eigenvalues and eigenvectors as follows:\nL (k) gn,\u03b6 (k) = \u03c9 n,\u03b6 (k) gn,\u03b6 (k) , \u03c9 n,\u03b6 (k) = \u03b6\u03c9 n (k) , \u03b6 = \u00b1, n = 1, . . . , J,\n\n(2.13)\n\nwhere \u03c9 n (k) are real-valued, continuous for all k functions, and eigenvectors gn,\u03b6 (k) \u2208 C2J\nhave unit length in the standard Euclidean norm. We also suppose that the eigenvalues are\nnumbered so that\n\u03c9 n+1 (k) \u2265 \u03c9 n (k) \u2265 0, n = 1, . . . , J \u2212 1,\n(2.14)\nand we call n the band index. Note that the presence of \u03b6 = \u00b1 reflects a symmetry of the\nsystem allowing it, in particular, to have real-valued solutions. Such a symmetry of dispersion\nrelation \u03c9 n (k) occurs in photonic crystals and many other physical problems.\nNote that (2.13) implies that the following symmetry relation hold:\n\u03c9 n,\u2212\u03b6 (k) = \u2212\u03c9 n,\u03b6 (k) , n = 1, . . . , J.\n\n(2.15)\n\nWe also always assume that the following inversion symmetry holds:\n\u03c9 n,\u03b6 (\u2212k) = \u03c9 n,\u03b6 (k) .\n\n(2.16)\n\nRemark 2.1 Assuming (2.15)and (2.16) we suppose that the dispersion relations \u03c9 \u03b6 (k)\nhave the same symmetry properties as the dispersion relations of Maxwell equations in periodic\nmedia, see [1]-[3], [5]. We would like to stress that these symmetry conditions are not imposed\nfor technical reasons but because they are consequences of fundamental symmetries of physical\nmedia. Such symmetries arise in many problems including, for instance, the Fermi-PastaUlam equation, or when L (k) originates from a Hamiltonian H (p, q) = 21 (H1 (p2 ))+ 21 H2 (q 2 ).\nIn the opposite case if it is assumed that (2.15)and (2.16) never hold, the results of this paper\nhold and the proofs, in fact, are simpler. The case with the symmetry is more difficult and\ndelicate because of a possibility of resonant nonlinear interactions.\n10\n\n\fThere are values of k for which inequalities (2.14) turn into equalities, these points require\nspecial treatment.\nDefinition 2.2 (band-crossing points) We call k0 a band-crossing point if \u03c9 n+1 (k0 ) =\n\u03c9 n (k0 ) for some n or \u03c9 1 (k0 ) = 0 and denote the set of band-crossing points by \u03c3.\nEverywhere in this paper we assume that the following condition is satisfied.\nCondition 2.3 The set \u03c3 of band-crossing points is a closed nowhere dense set in Rd with\nzero Lebesgue measure, the entries of the matrix L (k) are infinitely smooth functions of k \u2208\n/\u03c3\nand \u03c9 n (k) are continuous functions of k for all k and are infinitely smooth when k \u2208\n/ \u03c3.\nObserve that for k \u2208\n/ \u03c3 all the eigenvalues of the matrix L (k) are different and the\ncorresponding eigenvectors gn,\u03b6 (k) of L (k) can be locally defined as smooth functions of\nk\u2208\n/ \u03c3 as long as L (k) is smooth.\nRemark 2.4 The band-crossing points are discussed in more details in [1], [2]. Here we only\nnote that generically the singular set \u03c3 is a manifold of the dimension d \u2212 2, see [1], [2]). A\nsimple example of a band-crossing point is k = 0 in (2.12).\nSince we do not assume the matrix L (k) to be Hermitian, we impose the following\ncondition on its eigenfunctions which guarantees its uniform diagonalization.\nCondition 2.5 We assume that the 2J \u00d7 2J matrix formed by the eigenvectors gn,\u03b6 (k) of\nL (k), namely,\n\u039e (k) = [g1,+ (k) , g1,\u2212 (k) , . . . , gJ,+ (k) , gJ,+ (k)]\nis uniformly bounded together with its inverse\nsup k\u039e (k)k , sup \u039e\u22121 (k) \u2264 C\u039e for some constant C\u039e .\nk\u2208\u03c3\n/\n\n(2.17)\n\nk\u2208\u03c3\n/\n\nHere and everywhere we use the standard Euclidean norm in C2J .\nNote that if the matrix L (k) is Hermitian for every k, the eigenvectors form an orthonormal system. Then the matrix \u039e, which diagonalizes L, is unitary and (2.17) is satisfied with\nC\u039e = 1. Everywhere throughout the paper we assume that Condition 2.5 is satisfied.\nWe introduce for vectors \u0169 \u2208 C2J their expansion with respect to the basis gn,\u03b6 :\n\u0169 (k) =\n\nJ X\nX\n\n\u0169n,\u03b6 (k) gn,\u03b6 (k) =\n\nJ X\nX\n\n\u0169n,\u03b6 (k) ,\n\n(2.18)\n\nn=1 \u03b6=\u00b1\n\nn=1 \u03b6=\u00b1\n\nand we refer to it as the modal decomposition of \u0169 (k), and call the coefficients \u0169n,\u03b6 (k) the\nmodal coefficients of \u0169 (k). In this expansion we assign to every n, \u03b6 a linear projection\n\u03a0n,\u03b6 (k) in C2J corresponding to gn,\u03b6 (k), namely\n\u03a0n,\u03b6 (k) \u0169 (k) = \u0169n,\u03b6 (k) gn,\u03b6 (k) = \u0169n,\u03b6 (k) , n = 1, . . . , J, \u03b6 = \u00b1.\n11\n\n(2.19)\n\n\fNote that these projections may be not orthogonal if L (k) is not Hermitian. Evidently the\nprojections \u03a0n,\u03b6 (k) are determined by the matrix L (k) and therefore do not depend on the\nchoice of the basis gn,\u03b6 (k). Projections \u03a0n,\u03b6 (k) depend smoothly on k \u2208\n/ \u03c3 (note that we\ndo not assume that the basis elements gn,\u03b6 (k) are defined globally as smooth functions for\nall k \u2208\n/ \u03c3, in fact band-crossing points may be branching points for eigenfunctions, see for\nexample [1].) They are also uniformly bounded thanks to Condition 2.5:\n!1/2\nX\n2\nC\u039e\u22121 |V| \u2264\n|\u03a0n,\u03b6 (k) V|\n\u2264 C\u039e |V| , V \u2208 C2J , k \u2208\n/ \u03c3.\n(2.20)\nn,\u03b6\n\nWe would like to point out that most of the quantities are defined outside of the singular set\n\u03c3 of band-crossing points. It is sufficient since we consider \u0168 (k) as an element of the space\nL1 of Lebesgue integrable functions and the set \u03c3 has zero Lebesgue measure.\nThe class of nonlinearities F\u0303 in (2.3) which we consider can be described as follows. F\u0303 is\na general polynomial nonlinearity of the form\nmF\n\u0010 \u0011 X\n\u0011\n\u0010\nm\n(m)\nF\u0303 \u0168 =\n\u0168 , with mF \u2265 2,\nF\u0303\n\n(2.21)\n\nm=2\n\nwhere m-linear operators F\u0303 (m) are represented by integral convolution formulas similar to\n(2.9), namely\nZ\n\u0010\n\u0011\n\u0010\n\u0011\u0011\n\u0010\n\u0011\n\u0010\n(m)\n\u01681 , . . . , \u0168m (k, \u03c4 ) =\nF\u0303\n\u03c7(m) k, ~k \u01681 (k\u2032 ) . . . \u0168m k(m) k, ~k\nd\u0303(m\u22121)d~k, (2.22)\nDm\n\nwhere the domain\n\nDm = [\u2212\u03c0, \u03c0](m\u22121)d ,\n\nand we use notation\nd\u0303(m\u22121)d~k =\n\n1\n(2\u03c0)\n\n(m\u22121)d\n\nand\n\ndk\u2032 . . . dk(m\u22121)\n\n(2.23)\n(2.24)\n\n\u0010\n\u0011\n\u0001\n~\n(2.25)\nk, k = k \u2212 k\u2032 \u2212 . . . \u2212 k(m\u22121) , ~k = k\u2032 , . . . , k(m) .\nk\n\u0010 \u0011\nCondition 2.6 (nonlinearity regularity) The nonlinear operator F\u0303 \u0168 defined by (2.21)\nsatisfy\n\u0001\n1\n(m)\n\u2032\n(m)\n\u03c7(m) =\n\u03c7\nk,\nk\n,\n.\n.\n.\n,\nk\n\u2264 C\u03c7 , m = 2, 3, . . . ,\n(2.26)\nsup\n(2\u03c0)(m\u22121)d k,k\u2032 ,...,k(m)\n\u0010\n\u0011\nwhere, without loss of generality, we can assume that C\u03c7 \u2265 1. The norm \u03c7(m) k, ~k of the\n\u0001m\n\u0001\ntensor \u03c7(m) with a fixed ~k as a m-linear operator from C2J\ninto C2J is defined by\n\u0010\n\u0011\n\u0010\n\u0011\n(2.27)\n\u03c7(m) k, ~k = sup \u03c7(m) k, ~k (x1 , . . . , xm ) ,\n(m)\n\n|xj |\u22641\n\n12\n\n\f\u0010\n\u0011\nwhere as always, |*| stands for the standard Euclidean norm. The tensors \u03c7(m) k, ~k are\n\nassumed to be smooth functions of k, k\u2032 , . . . , k(m) \u2208\n/ \u03c3, namely for every compact K \u2282 Rd \\ \u03c3\nand for all m = 2, 3, . . . .\n\u0001\n\u2207l \u03c7(m) k, k\u2032 , . . . , k(m) \u2264 CK,l if k, k\u2032 , . . . , k(m) \u2208 K, l = 1, 2, . . . ,\n(2.28)\n\nwhere \u2207l \u03c7(m) is the vector composed of all partial derivatives of order l of all components of\nthe tensor \u03c7(m) with respect to the variables k, k\u2032 , . . . , k(m) .\n\u00bfFrom now on all the nonlinear operators we consider are assumed to satisfy the nonlinearity regularity Condition 2.6.\nRemark 2.7 At first sight, since \u033a is a small parameter, one might think that the linear term\nin (2.1) with the factor \u033a1 is dominant. But it is not that simple. Indeed, since all eigenvalues\ni\n\nof L (k) are purely imaginary the magnitude of e\u2212 \u033a L(k) h\u0303 (k) which represents the solution\nof a linear equation (with F\u0303 = 0) is bounded uniformly in \u033a. A nonlinearity F\u0303 alters the\nsolution for a bounded time \u03c4 \u2217 which is not small for small \u033a. Therefore the influence of\nthe nonlinearity can be significant. This phenomenon can be illustrated by the following toy\nmodel. Let us consider the partial differential equation for a scalar function y (x, \u03c4 ):\n1\n\u2202\u03c4 y = \u2212 \u2202x y + y 2 , y (x, 0) = h (x) .\n\u033a\nIts solution is of the form\n\n\u0011\n\u0010\n\u03c4\nh x\u2212 \u033a\n\u0010\n\u0011,\ny (x, \u03c4 ) =\n1 \u2212 \u03c4 h x \u2212 \u03c4\u033a\n\n(2.29)\n\nand regularly it exists only for a finite time. The solution (2.29) shows that the large coefficient 1\u033a enters it so that the corresponding wave moves faster with the velocity \u033a1 along the\nx-axis but the wave's shape does not depend on \u033a at all. For the NLS with the initial data\nh\u0303 (k) = h\u0303 (k, \u03b2), \u033a = \u03b2 2 , and the coefficient 1\u033a at the linear part, the nonlinearity balances\nthe effect of dispersion leading to emergence of solitons, see [6] for a discussion.\nTo formulate our results we introduce a Banach space E = C ([0, \u03c4 \u2217 ] , L1 ) of functions\n\u1e7d (k, \u03c4 ), 0 \u2264 \u03c4 \u2264 \u03c4 \u2217 , with the norm\nZ\n|\u1e7d (k, \u03c4 )| dk.\n(2.30)\nk\u1e7d (k, \u03c4 )kE = k\u1e7d (k, \u03c4 )kC([0,\u03c4 \u2217 ],L1 ) = sup\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\n[\u2212\u03c0,\u03c0]d\n\nHere L1 is the Lebesgue function space with the standard norm defined by the formula\nZ\nk\u1e7d (*)kL1 =\n|\u1e7d (k)| dk.\n(2.31)\n[\u2212\u03c0,\u03c0]d\n\nThe following theorem guarantees the existence and the uniqueness of a solution to the modal\nevolution equation (2.3) on a time interval which does not depend on \u033a (see Theorem 5.4 for\ndetails).\n13\n\n\fTheorem 2.8 (existence and uniqueness) Let the modal evolution equation (2.3) satisfy\nthe Condition 2.5, and let h\u0303 \u2208 L1 , h\u0303\n\u2264 R. Then there exists a unique solution \u0168 =\nL1\n\u0010 \u0011\nG h\u0303 of (2.3) which belongs to C 1 ([0, \u03c4 \u2217 ] , L1 ). The number \u03c4 \u2217 > 0 depends on R, C\u03c7 and\nC\u039e and it does not depend on \u033a.\nNow we would like to formulate the main result of this paper, a theorem on the superposition principle, showing that the generic wavepackets evolve almost independently for the\ncase of lattice equations. To do that, first, we define an important concept of wavepacket.\nDefinition 2.9 (wavepacket) A function h\u0303 (\u03b2, k) which depends on a parameter 0 < \u03b2 <\n1, is called a wavepacket with a center k\u2217 if it satisfies the following conditions:\n(i) It is bounded in L1 uniformly in \u03b2, i.e.\nh\u0303 (\u03b2, *)\n\nL1\n\n\u2264 Ch .\n\n(2.32)\n\n(ii) It is composed of modes from essentially a single band n, namely for any 0 < \u01eb < 1\nthere is a constant C\u01eb > 0 such that\nh\u0303 (k) \u2212 h\u0303\u2212 (k) \u2212 h\u0303+ (k)\n\nL1\n\n\u2264 C\u01eb \u03b2, h\u0303\u03b6 (k) = \u03a0n,\u03b6 h\u0303 (k) , \u03b6 = \u00b1,\n\n(2.33)\n\nand h\u0303\u03b6 (\u03b2, k) is essentially supported in a small vicinity of \u03b6k\u2217 , where k\u2217 is the wavepacket\ncenter, namely\nZ\n|k\u2212\u03b6k\u2217 |\u2265\u03b2 1\u2212\u01eb\n\nh\u0303\u03b6 (\u03b2, k) dk \u2264 C\u01eb \u03b2.\n\n(2.34)\n\n(iii) The wavepacket center k\u2217 is not a band-crossing point, that is k\u2217l \u2208\n/ \u03c3, and the following\nregularity condition holds:\nZ\n(2.35)\n\u2207k h\u0303\u03b6 (\u03b2, k) dk \u2264 C\u01eb \u03b2 \u22121\u2212\u01eb .\n|k\u2212\u03b6k\u2217 |\u2264\u03b2 1\u2212\u01eb\n\nIn the above conditions (ii) and (iii) C\u01eb does not depend on \u03b2, 0 < \u03b2 < 1.\nThe simplest example of a wavepacket in the sense of Definition 2.9 is a function of the\nform\n\u0012\n\u0013\nk \u2212 \u03b6k\u2217\n\u2212d\nh\u0303\u03b6 (\u03b2, k) = \u03b2 \u0125\u03b6\ngn,\u03b6 (k) , \u03b6 = \u00b1,\n(2.36)\n\u03b2\nwhere \u0125\u03b6 (k) is a Schwartz function, that is an infinitely smooth, rapidly decaying function.\nAnother typical and natural example of a wavepacket h\u0303 centered at k\u2217 is readily provided by\nh\u0303 (\u03b2, k) = \u03a0n,+ (k) h\u03030,+ (\u03b2, k) + \u03a0n,\u2212 (k) h\u03030,\u2212 (\u03b2, k)\n14\n\n(2.37)\n\n\fwhere h\u03030,\u03b6 (\u03b2, k) is the lattice Fourier transform of the following function\nh0,\u03b6 (m, \u03b2) = ei\u03b6k\u2217 *m \u03a6\u03b6 (\u03b2m \u2212 r0 ) g, \u03b6 = \u00b1,\n\n(2.38)\n\nwhere g is a vector in C2J , projection \u03a0n,\u03b6 is as in (2.19) with some n, vectors m, r0 \u2208 Rd\nand \u03a6\u03b6 (r) being an arbitrary Schwartz function (see Lemma 7.2).\nOur special interest is in the waves that are finite sums of wavepackets and we refer to\nthem as multi-wavepackets.\nDefinition 2.10 (multi-wavepacket) A function h\u0303 (\u03b2, k), 0 < \u03b2 < 1, is called a multiwavepacket if it is a finite sum of wavepackets h\u0303l as defined in Definition 2.9, namely\nh\u0303 (\u03b2, k) =\n\nNh\nX\n\nh\u0303l (\u03b2, k) ,\n\n(2.39)\n\nl=1\n\nand we call the set {k\u2217l } of all the centers k\u2217l of involved wavepackets center set of h\u0303.\nIn what follows we will be interested in generic multi-wavepackets such that their centers\nare generic. The exact meaning of this is provided below in the following conditions.\nCondition 2.11 (non-zero frequency) We assume that every center k\u2217l of a wavepacket\nsatisfies the following condition\n\u03c9 nl (k\u2217l ) 6= 0, l = 1, . . . , Nh .\n\n(2.40)\n\nCondition 2.12 (group velocity) We assume that all centers k\u2217l , l = 1, . . . , Nh , of the\nmulti-wavepacket h\u0303\u0001 as defined in Definition 2.10 are not band-crossing points, and the gradients \u2207k \u03c9 nlj k\u2217lj (called group velocities) at these points satisfy the following condition\n\u2207k \u03c9 nl1 (k\u2217l1 ) \u2212 \u2207k \u03c9 nl2 (k\u2217l2 ) 6= 0 when l1 6= l2 ,\n\n(2.41)\n\nindicating that the group velocities are different.\nWe also want the functions (dispersion relations) \u03c9 nl (k) to be non-degenerate in the sense\nthat they are not exactly linear, below we give exact conditions.\nConsider the following equation for n and \u03b8\n\u03b8\u03c9 nl (k\u2217 ) \u2212 \u03b6\u03c9 n (\u03b8k\u2217 ) = 0, \u03b6 = \u00b11,\n\n(2.42)\n\nwhere the admissible \u03b8 have the form\n\u03b8=\n\nm\nX\nj=1\n\n\u03b6 (j) , \u03b6 (j) = \u00b11, m \u2264 mF ,\n\n(2.43)\n\nmF is the same as in (2.21). In the case when in the series (2.21) some terms F\u0303 (m) vanish,\nwe take in (2.43) only m corresponding to non-zero F\u0303 (m) .\n15\n\n\fCondition 2.13 (non-degeneracy) Given a point k\u2217 = k\u2217l and band nl we assume that\ndispersion relations \u03c9 n (k) are such that all solutions n,\u03b8 of (2.42) are necessarily of the form\nn = nl , \u03b8 = \u03b6.\n\n(2.44)\n\nDefinition 2.14 (generic multi-wavepackets) A multi-wavepacket h\u0303 as defined in Definition 2.10 is called generic if the centers k\u2217l , l = 1, . . . , Nh , of all wavepackets satisfy\nConditions 2.11 and 2.12; and the dispersion relations \u03c9 n (k) at every k\u2217l and band nl satisfy\nCondition 2.13.\nWe introduce\nnow the solution operator G mapping the initial data h\u0303 into the solution\n\u0010 \u0011\n\u0168 = G h\u0303 of the modal evolution equation (2.3); this operator is defined for h\u0303 \u2264 R\naccording to Theorem 2.8. The main result of this paper for the lattice case is the following\nstatement.\nTheorem 2.15 (superposition principle for lattice equations) Suppose that the initial data h\u0303 of (2.3) is a multi-wavepacket of the form\nh\u0303 =\n\nNh\nX\n\nh\u0303l , Nh max h\u0303l\nl\n\nl=1\n\nL1\n\n\u2264 R,\n\n(2.45)\n\nsatisfying Definition 2.10, where h\u0303 is generic in the sense of Definition 2.14. Let us assume\nthat\n\u03b22\n1\n1\n\u2264 C, with some C, 0 < \u03b2 \u2264 , 0 < \u033a \u2264 .\n(2.46)\n\u033a\n2\n2\n\u0010 \u0011\nThen the solution \u0168 = G h\u0303 to the evolution equation (2.3) satisfies the following approximate superposition principle\n!\nNh\nNh\n\u0010 \u0011\nX\nX\nG h\u0303l + D\u0303,\n(2.47)\nG\nh\u0303l =\nl=1\n\nl=1\n\nwith a small remainder D\u0303 (\u03c4 ) satisfying the following estimate\nsup\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\nD\u0303 (\u03c4 )\n\nL1\n\n\u2264 C\u01eb\n\n\u033a\n\u03b2\n\n1+\u01eb\n\n|ln \u03b2| ,\n\n(2.48)\n\nwhere \u01eb is the same as in Definition 2.9 and can be arbitrary small, \u03c4 \u2217 does not depend on\n\u03b2, \u033a and \u01eb.\nThe most common case when (2.46) holds is \u033a = \u03b2 2 , a discussion of different scalings is\nprovided in [6] and [7].\nObserve that solutions to the original evolution equation (2.1) with the initial data (2.39),\n(2.38) satisfy the superposition principle if the wave vectors k\u2217l in (2.38) satisfy (2.41), (2.42)\n16\n\n\fand \u03a6l are Schwartz functions. It turns out, that the evolution of every coefficient \u0169n,\u03b6 (k)\nof the solution as defined by (2.18) can be accurately approximated by a solution a relevant\nNonlinear Schrodinger equation (NLS), see [23]. Therefore Theorem 2.15 provides a reduction\nof multi-wavepacket problem to several single-wavepacket problems.\nWe also would like to stress that though \u03b2 is small the nonlinear effects are not small.\nNamely, there can be a significant difference between solutions of a nonlinear and the corresponding linear (with F (U) being set zero) equations with the same initial data for times\n\u03c4 = \u03c4 \u2217.\nRecall that up to now we analyzed the nonlinear evolution in the modal form (2.3) for\n\u0168 (k, \u03c4 ). To make a statement on the nonlinear evolution for the original evolution equation\n(2.1), i.e. in terms of the quantities\nU (m, \u03c4 ), we introduce U (h) (m) as the inverse Fourier\n\u0010 \u0011\ntransform of the solution G h\u0303 (k) of the modal evolution equation (2.3). Recall that the\ninverse Fourier transform corresponding to (2.2) is given by the formula\nZ\n\u2212d\nU (m) = (2\u03c0)\neim*k \u0168 (k) dk,\n(2.49)\n[\u2212\u03c0,\u03c0]d\n\nand when applying the inverse Fourier transform we get back the original lattice system (2.1)\nfrom its modal form (2.3). The convolution form of the nonlinearity makes the lattice system\ninvariant with respect to translations on the lattice Zd . Using Theorem 2.15 and applying\nthe inverse Fourier transform together with the inequality\nkUkL\u221e \u2264 (2\u03c0)\u2212d \u0168\n\n(2.50)\n\nL1\n\nwe obtain the following statement.\nCorollary 2.16 Let the evolution equation (2.1) be obtained as the lattice Fourier transform\nof (2.3). If h is given by (2.38) where every \u03a6l,\u03b6 (r) is a Schwartz function (that is an\ninfinitely smooth, rapidly decaying function) then U (h) is a solution to the evolution equation\n(2.1). If h = h1 +. . .+hNh and every hl is given by (2.38) then the approximate superposition\nprinciple holds:\nU (h) = U (h1 ) + . . . + U (hNh ) + D,\n(2.51)\nwith a small coupling remainder D (\u03c4 ) satisfying\nsup kD (\u03c4 )kL\u221e \u2264 C\u03b4\u2032\n\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\n\u033a\n\u03b2\n\n1+\u03b4\n\n,\n\n(2.52)\n\nwhere \u03b4 > 0 can be taken arbitrary small.\nAs an application of Theorem 2.15 let us consider the Fermi-Pasta-Ulam equation (2.10).\nWe impose the initial condition for (2.10)\nxn (0) =\n\nnh\nX\nl=1\n\n\u03a80l (\u03b2n \u2212 rl ) eik\u2217l n + cc, yn (0) =\n17\n\nnh\nX\nl=1\n\n\u03a81l (\u03b2n \u2212 rl ) eik\u2217l n + cc, n \u2208 Z,\n\n(2.53)\n\n\fwhere \u03a80l (r) , \u03a81l (r) are arbitrary Schwartz functions, and rl are arbitrary real numbers, cc\nmeans complex conjugate to the preceding terms and assume that \u033a, \u03b2 satisfy (2.46). For\nany given k\u2217l there are two eigenvectors g\u00b1 (k\u2217l ) of the matrix L (k\u2217l ) in (2.12) given by (7.3)\nand corresponding terms in (2.53) can be written as\n\u0014\n\u0015\n\u03a80l\neik\u2217l n = [\u03a6\u2212,l g\u2212 (k\u2217l ) + \u03a6+,l g+ (k\u2217l )] eik\u2217l n .\n\u03a81l\nIn this case all requirements of Definition 2.10 are fulfilled, and (2.53) defines a multiwavepacket. Note that the multiwavepacket (2.53) involves Nh = 2nh wavepackets with\n2nh wavepacket centers \u03b8k\u2217l , \u03b8 = \u00b1. To satisfy Condition 2.12 the wavepacket centers k\u2217l\nmust satisfy\nk\ncos k2\u2217l\ncos 2\u2217j\n6=\nif l 6= j.\n(2.54)\nk\nsin k2\u2217l\nsin 2\u2217j\nTo check if the centers k\u2217l satisfy Condition 2.13 we consider the equation\n\u0012\n\u0013\n3\nX\nk\u2217l\nk\u2217l\nz sin\n\u2212 \u03b6 sin z\n= 0, z =\n\u03b6 (j) , \u03b6 (j) = \u00b11.\n2\n2\nj=1\n\n(2.55)\n\nEvidently the possible values of z are \u22123, \u22121, 1, 3. Since the equation 3 |sin \u03c6| = |sin (3\u03c6)|\nhas the only solution \u03c6 = 0 on [0, \u03c0/2] the equation (2.55) has the only solution z = \u03b6.\nConsequently, all points k\u2217l 6= 0 satisfy Condition 2.13, and Theorem 2.15 applies. The\ninitial data for a single wavepacket solution have the form\n\u0014\n\u0015\nx\u03b8,n,l (0)\n= \u03a6\u03b8,l (\u03b2n \u2212 rl ) g\u03b8 (k\u2217l ) + cc, n \u2208 Z, \u03b8 = \u00b1.\n(2.56)\ny\u03b8,n,l (0)\nAccording to this theorem and Corollary 2.16 the solution to (2.10), (2.53) equals the sum\nof solutions of (2.10) with single wavepacket initial data, that is\nxn (\u03c4 ) =\n\nnh\nXX\n\nx\u03b8,n,l (\u03c4 ) + D1,n (\u03c4 ) , yn (\u03c4 ) =\n\n\u03b8=\u00b1 l=1\n\nnh\nXX\n\ny\u03b8,n,l (\u03c4 ) + D2,n (\u03c4 ) .\n\n(2.57)\n\n\u03b8=\u00b1 l=1\n\nwhere Dn is a small remainder satisfying\nsup sup [|D1,n (\u03c4 )| + |D2,n (\u03c4 )|] \u2264 C\u03b4\n\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\nn\n\n\u033a\n\u03b2\n\n1+\u03b4\n\n(2.58)\n\nwith arbitrarily small positive \u03b4. Hence, the following statement holds.\nTheorem 2.17 (superposition for Fermi-Pasta-Ulam equation) If every \u03a6l,\u03b6 (r) is a\nSchwartz function, and the wavevectors k\u2217l 6= 0 satisfy (2.54), then the solution xn (\u03c4 ) , yn (\u03c4 )\nof the initial value problem for the Fermi-Pasta-Ulam equation (2.10) with multi-wavepacket\ninitial condition (2.53) is a linear superposition of solutions xn,l (\u03c4 ) , yn,l (\u03c4 ) of the same equation with single-wavepacket initial condition (2.56) up to a small coupling term D1,n (\u03c4 ) , D2,n (\u03c4 )\nsatisfying (2.57), (2.58) with arbitrary small \u03b4 > 0 and \u03c4 \u2217 which do not depend on \u03b2, \u033a, \u03b4.\n18\n\n\fNote that solutions x\u03b8,n,l (\u03c4 ) with different \u03b8, l resemble 2nh solitons which originate at\ndifferent points rl and propagate with different group velocities. According to (2.57), (2.58)\nall these soliton-like wavepackets pass through one another with very little interaction, see\nFig. 1. Note that Theorem 2.15 shows that this phenomenon is robust in the class of general\n\n3\n\n2\n\n1\n\ny 0\n-40\n\n-20\n\n0\n\n20\n\n40\n\nx\n-1\n\n-2\n\nFigure 1: In this picture two wavepackets are shown with different \"centers\" k\u22171 and k\u22172 .\nThe values of k\u22171 and k\u22172 are proportional to the frequences of spatial oscillations. Though\nthe wavepackets overlap in physical space, they pass one through another in the process of\nnonlinear evolution almost without interaction if their group velocities are different.\ndifference equations on the lattice Z, and that it persists under polynomial perturbations of\nthe nonlinearity as well as perturbations of the linear part of the equation (2.11) as long as\nthey leave the linear difference operator non-positive and self-adjoint. Observe also that the\nevolution of every single wavepacket is nonlinear, and it is well-approximated by a properly\nconstructed NLS (we intend to write a proof of this statement for general lattice systems in\nanother article; see [23] for a particular case). For example, for a special choice of \u03a8jl the\nsolution xn,l (\u03c4 ) can be well approximated by a soliton solution of a corresponding NLS.\n\n2.2\n\nMain statements and examples for semilinear systems of hyperbolic PDE\n\nIn this subsection we consider nonlinear evolution equation involving partial differential (and\npseudodifferential) operators with respect to spatial variables with constant coefficients in\nthe entire space Rd . There is a great deal of similarity between such nonlinear evolution\nPDE and the lattice nonlinear evolution equations considered in the previous section. In\nparticular, we study first not the original PDE but its Fourier transform, modal evolution\nequation, and the results concerning the original PDE are obtained by applying the inverse\nFourier transform.\n\u0001\nRecall that for functions U (r) from L1 Rd the Fourier transform and its inverse are\n19\n\n\fdefined by the formulas\n\u00db (k) =\n\nZ\n\nRd\n\nU (r) =\n\n1\n(2\u03c0)\n\nd\n\nU (r) e\u2212ir*k dr, where k \u2208 Rd ,\n\n(2.59)\n\nZ\n\n(2.60)\n\nRd\n\n\u00db (k) eir*k dr, where r \u2208 Rd .\n\nSimilarly to (2.3) we introduce the following modal evolution equation\n\u0010 \u0011\ni\n\u2202\u03c4 \u00db (k, \u03c4 ) = \u2212 L (k) \u00db (k, \u03c4 ) + F\u0302 \u00db (k, \u03c4 ) , \u00db (k, 0) = \u0125 (k) , k \u2208 Rd ,\n\u033a\n\n(2.61)\n\nwhere (i) \u00db (k, \u03c4 ) is a 2J-component\nvector-function of k, \u03c4 , (ii) L (k) is a 2J \u00d7 2J matrix\n\u0010 \u0011\nfunction of k, and (iii) F\u0302 \u00db is the nonlinearity. We assume that the 2J \u00d7 2J matrix L (k),\n\nk \u2208 Rd , has exactly 2J eigenvectors gn,\u03b6 (k) with corresponding 2J real eigenvalues \u03c9 n,\u03b6 (k)\nsatisfying the relation (2.13), (2.14), (2.15), (2.16), (2.17). We also assume the matrix L (k),\nk \u2208 Rd , to satisfy the polynomial bound\n|L (k)| \u2264 C (1 + |k|p ) .\n\n(2.62)\n\nThe singular set \u03c3 for L (k) is as in Definition 2.3 with the only difference that functions\nd\n\u03c9 n,\u03b6 (k) are defined over Rd rather\n\u0010 \u0011 than the torus [\u2212\u03c0, \u03c0] , and, consequently they are not\nperiodic. The nonlinearity F\u0302 \u00db has a form entirely similar to (2.21):\nmF\n\u0010 \u0011 X\n\u0011\n\u0010\nm\n(m)\nF\u0302 \u00db =\n\u00db ,\nF\u0302\n\n(2.63)\n\nm=2\n\nwith F\u0302 (m) being m-linear operators with the following representation similar to (2.22):\nZ\n\u0010\n\u0010\n\u0011\u0011\n\u0010\n\u0011\n\u0011\n\u0010\n(m)\n\u03c7(m) k, ~k \u00db1 (k\u2032 ) . . . \u00dbm k(m) k, ~k d\u0303(m\u22121)d~k, (2.64)\n\u00db1 , . . . , \u00dbm (k) =\nF\u0302\nDm\n\n\u0010\n\u0011\nwhere k(m) k, ~k is defined by the convolution equation (2.25), d\u0303 is defined by (2.24) and\nDm in (2.64) is now defined not by (2.23) but by\nDm = R(m\u22121)d .\n\n(2.65)\n\nThe difference with (2.3) now is that the involved functions of k, k\u2032 etc.,\n\u0010 are\u0011not 2\u03c0-periodic,\n(m)\nk, ~k satisfy the nonDm in (2.64) is defined by (2.65) instead of (2.23), and the tensors \u03c7\n\u0001\nlinear regularity Condition 2.6 without the periodicity assumption.\nThe functions \u00dbl k(l)\n\u0001\nin (2.64) are assumed to be from the space L1 = L1 Rd with the norm\nZ\n=\n|\u1e7d (k)| dk.\n(2.66)\n\u00db (*)\nL1\n\nRd\n\n20\n\n\fWe seek solutions to (2.61) in the space C 1 ([0, \u03c4 \u2217 ] , L1 ) with 0 < \u03c4 \u2217 \u2264 1.\nApplying the inverse Fourier transform to the modal evolution equation (2.61) we obtain\na hyperbolic 2J-component systems in Rd of the form\ni\n\u2202\u03c4 U (r, \u03c4 ) = \u2212 L (\u2212i\u2207r ) U (r, \u03c4 ) + F (U) (r, \u03c4 ) , U (r, 0) = h (r) .\n\u033a\n\n(2.67)\n\nNote that since L (k) satisfies the polynomial bound 2.62) we can define the action of the\noperator L (\u2212i\u2207r ) on any Schwartz function Y (r) by the formula\n\\\nL (\u2212i\u2207\nr ) Y (k) = L (k) \u0176 (k) ,\n\n(2.68)\n\nwhere, in view of (2.62), the order of L does not exceed p. If all the entries of L (k) are polynomials, such a definition coincides with the common definition of the action of a differential\noperator L (\u2212i\u2207r ). In this case L (\u2212i\u2207r ) defined by (2.68) is a differential operator with\nconstant coefficients of order not greater than p.\nThe properties of the modal evolution equation (2.61) are completely similar to its lattice\ncounterpart and are as follows. The existence and uniqueness theorem is similar to Theorem\n2.8.\nTheorem 2.18 (existence and uniqueness) Let equation (2.61) satisfy conditions (2.17)\n\u0001\n\u2264 R. Then there exists a unique solution to the\nand (2.26) and h \u2208 L1 = L1 Rd , h\u0303\nL1\n\nmodal evolution equation (2.61) in the functional space C 1 ([0, \u03c4 \u2217 ] , L1 ). The number \u03c4 \u2217 depends on R, C\u03c7 and C\u039e .\nHere is the main result for the semilinear hyperbolic systems of PDE which is completely\nsimilar to Theorem 2.15.\n\nTheorem 2.19 (principle of superposition for PDE systems) Let the initial data of\nthe modal evolution equation (2.61) be a multi-wavepacket, i.e. the sum of Nh wavepackets\n\u0125l as in (2.45) satisfying Definitions 2.9, 2.10. Suppose that \u033a, \u03b2 satisfy condition \u0010\n(2.46).\n\u0011\nAssume also that \u0125 is generic in the sense of Definition 2.14. Then the solution \u00db = G \u0125 to\nthe modal evolution equation (2.61) satisfies the approximate linear superposition principle,\nnamely\n!\nNh\nNh\n\u0010 \u0011\nX\nX\nG \u0125l + D\u0302,\n(2.69)\n\u0125l =\nG\nl=1\n\nl=1\n\nwith a small remainder D\u0302 (\u03c4 )\nsup\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\nD\u0302 (\u03c4 )\n\nL1\n\n\u2264 C\u01eb\n\n21\n\n\u033a\n\u03b2\n\n1+\u01eb\n\n|ln \u03b2| ,\n\n(2.70)\n\n\fwhere \u01eb is the same as in Definition 2.9, \u03c4 \u2217 does not depend on \u03b2, \u033a and \u01eb. The solutions\nU (h) (r, \u03c4 \u0010\n) of\u0011 the space evolution equation (2.67) are obtained as the inverse Fourier transform of G \u0125 and they satisfy the approximate linear superposition principle, namely\nU (h) = U (h1 ) + . . . + U (hNh ) + D,\n\n(2.71)\n\nwith a small coupling remainder D (\u03c4 ) satisfying\nsup kD (\u03c4 )kL\u221e \u2264 C\u01eb\n\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\n\u033a\n\u03b2\n\n1+\u01eb\n\n|ln \u03b2| ,\n\n(2.72)\n\nwhere \u01eb > 0 is the same as in Definition 2.9 and can be arbitrary small.\nExample 1: Sine-Gordon and Klein-Gordon equations with small initial data Let\nus consider the sine-Gordon equation (see [26])\n\u2202t2 u = \u2202r2 u \u2212 sin u\n\n(2.73)\n\nu (r, 0) = \u03b2b0 , \u2202t u (r, 0) = \u03b2b1 , \u03b2 \u226a 1.\n\n(2.74)\n\nwith small initial data\n\nFirst, we recast this the equation into our framework by rescaling the variables\nu = \u03b2U1 , \u03b2 2 t = \u03c4 .\n\n(2.75)\n\nSince sin \u03b2U1 = \u03b2U1 \u2212 16 \u03b2 3 U13 + \u03b2 5 f (U1 ), where evidently f (U1 ) is an enitire function, we\ncan recast the equation (2.73) into the following form\n\u2202\u03c42 U1 =\n\n\u0003\n\u0003\n1 \u0002 2\n1 \u0002 3\n2\n4 \u2202x U1 \u2212 U1 + 2 qU1 + \u03b2 f (U1 ) .\n\u03b2\n\u03b2\n\nWe introduce then a linear pseudodifferential operator A = (I \u2212 \u2202x2 )\n1/2\n(1 + k 2 ) and rewrite the equation (2.76) as the following system\n\u2202\u03c4 U1 =\nwith the initial data\n\n(2.76)\n1/2\n\nwith the symbol\n\n\u0002 3\n\u0003\n1\n1\n\u22121\nqU1 + \u03b2 2 f (U1 ) ,\n2 AU2 , \u2202\u03c4 U2 = \u2212 2 AU1 + A\n\u03b2\n\u03b2\nU1 (0) = h0 , U2 (0) = h1 ,\n\n(2.77)\n\n(2.78)\n\nwhere h0 and h1 are assumed to be of the form\nz (r, 0) = h0 , p (r, 0) = h1 , hj =\n\nnh\nX\nl=1\n\n22\n\n\u03a8jl (\u03b2r \u2212 rl ) eik\u2217l *r + cc, j = 0, 1,\n\n(2.79)\n\n\fin one-dimentional case with r = r, k = k. Evidently, the relations with the initial data of\n(2.73) are\nb0 = h0 , b1 = Ah1 .\nNotice that the system (2.77) is of the form (2.67) with\n\u0015\n\u0014\nAU2\n2\n, F (U) = F0 (U) + \u03b2 2 F1 (U) ,\n\u033a = \u03b2 , LU =\n\u2212AU1\n\u0015\n\u0014\n\u0015\n\u0014\n0\n0\n\u22121\n\u22121\n.\n, F1 (U) = A\nF0 (U) = A\nf (U1 )\nqU13\n\n(2.80)\n\nObserve now that L has only one spectral band with the dispersion relation and eigenvectors\ngiven by\n\u0015\n\u0014\n\u0001\n\u2212i\u03b8\n2 1/2\n\u22121/2\n, \u03b8 = \u00b11,\n\u03c9 (k) = I + k\n, g\u03b8 (k) = g\u03b8 = 2\n1\nand there is no band-crossing points. We use expansion in the basis g\u00b1\n\u0014\n\u0015\n\u03a80l\neik\u2217l *r = [\u03a6+,l g+ + \u03a6\u2212,l g\u2212 ] eik\u2217l *r .\n\u03a81l\n\n(2.81)\n\nto represent initial data (2.78) and (2.79). The equation (2.42) takes here the form\n2\n1 + k\u2217l\n\n\u00011/2\n\n2\n\u03bb = \u03b6 1 + \u03bb2 k\u2217l\n\n\u00011/2\n\n, \u03b6 = \u00b11.\n\nObviously, this equation has only solutions \u03bb = \u03b6 and Condition 2.13 is fulfilled. Condition\n2.12 holds if\n\u03b8k\u2217l\n\u03b8\u2032 k\u2217l\u2032\n=\n6\nfor l 6= l\u2032 or \u03b8 6= \u03b8\u2032\n(2.82)\n2 1/2\n2 1/2\n(1 + k\u2217l )\n(1 + k\u2217l\u2032 )\nwhich is equivalent to\nk\u2217l\u2032 6= k\u2217l for l\u2032 6= l, and k\u2217l 6= 0 for all l.\n\n(2.83)\n\nEquation (2.77) can be written in the integral form (3.3) with mF = \u221e and by Theorem\n5.4 it has unique solution U for \u03c4 \u2264 \u03c4 \u2217 . If we replace F (U) in (2.80) by F0 (U) we obtain\n\u2202\u03c4 V1 =\n\n1\n1\n\u22121\n3\n2 AV2 , \u2202\u03c4 V2 = \u2212 2 AV1 + A qV1 ,\n\u03b2\n\u03b2\n\n(2.84)\n\nwhere we take the initial data to be as in (2.78), namely\nV1 (0) = h0 , V2 (0) = h1 .\n\n(2.85)\n\nEquations (2.84) can be obtained by replacing sin u in (2.73) by the cubic polynomial u\u2212u3/6\nproducing the quasilinear Klein-Gordon equation (see [36]). Observe that the solutions to\nthe sine-Gordon and the Klein-Gordon equations with small initial data are very close. To\n23\n\n\fb (k) which are bounded in\nsee that, note that the operator f[\n(U) (k) is bounded in L1 for U\nL1 . Therefore the norm of the neglected term is small, namely \u03b2 2 f[\n(U)\n\u2264 C\u03b2 2 . Thus,\nby Remark 4.8, the solutions of (2.77) and (2.84) are close, namely\n\nkU1 \u2212 V1 kL\u221e + kU2 \u2212 V2 kL\u221e \u2264 C\u03b2 2 , 0 \u2264 \u03c4 \u2264 \u03c4 \u2217.\n\nL1\n\n(2.86)\n\nAccording to Theorem 2.19 the superposition principle is applicable to the equation (2.84)\nwith initial data as in (2.85), and the following statements hold.\nTheorem 2.20 (Superposition for Klein-Gordon) Assume that the initial data h0 , h1\nin (2.85) are as in (2.79). Then the solution {V1 , V2 } to the system (2.84) satisfies the linear\nsuperposition principle, namely\nV1 (r, \u03c4 ) =\n\nnh\nXX\n\nV1,\u03b8,l (r, \u03c4 ) + D1 (r, \u03c4 ) , V2 (r, \u03c4 ) =\n\nnh\nXX\n\nV2,\u03b8,l (r, \u03c4 ) + D2 (r, \u03c4 ) , (2.87)\n\n\u03b8=\u00b1 l=1\n\n\u03b8=\u00b1 l=1\n\nwhere {V1,\u03b8,l (r, \u03c4 ) , V2,\u03b8,l (r, \u03c4 )} is a solution to (2.84) with the one-wavepacket initial condition\n\u0014\n\u0015\nV1,\u03b8,l (r, 0)\n= \u03a6\u03b8,l (\u03b2r \u2212 rl ) g\u03b8 eik\u2217l *r + cc,\n(2.88)\nV2,\u03b8,l (r, 0)\nwhere \u03a6\u03b8,l (r) are arbitrary Schwartz functions. If (2.83) holds, the coupling terms D1 , D2\nsatisfy the bound\n\u0003\n\u0002\n\u033a\nkD1 (\u03c4 )kL\u221e + kD2 (\u03c4 )kL\u221e \u2264 C\u03b4\u2032 1+\u03b4 = C\u03b4\u2032 \u03b2 1\u2212\u03b4 ,\n\u03b2\n0\u2264\u03c4 \u2264\u03c4 \u2217\nsup\n\n(2.89)\n\nwhere \u03c4 \u2217 and C\u03b4\u2032 do not depend on \u03b2, and \u03b4 can be taken arbitrary small.\n\nUsing (2.86) we obtain a similar superposition theorem for the sine-Gordon equation.\nTheorem 2.21 (Superposition for sine-Gordon) Assume that the initial data h0 , h1 in\n(2.78) are as in (2.79). Then the solution {U1 , U2 } to (2.77), (2.78) satisfies the linear\nsuperposition principle, namely\nU1 (r, \u03c4 ) =\n\nnh\nXX\n\nU1,\u03b8,l (r, \u03c4 ) + D1 (r, \u03c4 ) , U2 (r, \u03c4 ) =\n\nnh\nXX\n\nU2,\u03b8,l (r, \u03c4 ) + D2 (r, \u03c4 ) ,\n\n\u03b8=\u00b1 l=1\n\n\u03b8=\u00b1 l=1\n\nwhere U1,\u03b8,l (r, \u03c4 ) , U2,\u03b8,l (r, \u03c4 ) is a solution of (2.77) with the one-wavepacket initial condition\n\u0015\n\u0014\nU1,\u03b8,l (r, 0)\n= \u03a6\u03b8,l (\u03b2r \u2212 rl ) g\u03b8 eik\u2217l *r + cc, \u03b8 = \u00b1,\nU2,\u03b8,l (r, 0)\nwhere \u03a6\u03b8,,l (r) are arbitrary Schwartz functions. If (2.83) holds, the coupling terms D1 , D2\nsatisfy the bound (2.89).\n24\n\n\fNote that a theorem completely similar to Theorem 2.20 holds also for a generalized\nKlein-Gordon equation where qV13 is replaced by an arbitrary polynomial P (V1 ). Hence, the\nsuperposition principle holds for the sine-Gordon equation (2.73) with a small initial data and\na strongly perturbed nonlinearity as, for example, when sin u is replaced by sin u + \u03b2 \u22121 u4 +\n\u03b2 \u22122 u5 .\nWe would like to compare now our results and methods with that of [38] where the\ninteraction of counterpropagating waves is studied by the ansatz method. Pierce and Wayne\nconsidered in [38] the sine-Gordon equation in the case of small initial data which have the\nform of a bimodal wavepacket. In our notation it corresponds to the case when \u033a = \u03b2 2 ,\nnh = 1 in (2.79), when two wavepackets, corresponding to \u03b8 = + and \u03b8 = \u2212, have exactly\nopposite group velocities. They proved that the bimodal wavepacket data generate two waves\nwhich are described by two uncoupled nonlinear Schrodinger equations with a small error.\nThe magnitude of the error given in [38] (which we formulate here for the solution U1 of\nthe rescaled equation (2.76) ) is estimated by C\u03b2 1/2 on the time interval 0 \u2264 \u03c4 \u2264 \u03c4 0 (\nor 0 \u2264 t \u2264 \u03c4 0 \u03b2 \u22122 ). Note that our general Theorem 2.19 when applied to the special case\nof the sine-Gordon equation (2.76) provides a better estimate of the coupling error, namely\nC\u033a/\u03b2 1+\u03b4 = C\u03b2 1\u2212\u03b4 in (2.89) with arbitrary small \u03b4, for the same time interval. Notice that\nthe estimate (2.72) given in Theorem 2.19 is almost optimal, since it is possible to construct\nexamples when the coupling error is greater than c\u03b2 1+\u03b4 with arbitrary small \u03b4.\nWe would like to point out that the general mechanism responsible for the wavepacket\ndecoupling is the destructive wave interference, this mechanism is subtle though general.\nWe treat the destructive wave interference by taking into account explicitly all nonlinear\ninteractions of high-frequency waves. In our approach we use the exact representation of a\ngeneral solution in the form of a functional-analytic operator monomial series, every term\nof the series is explicitly given as a multilinear oscillatory integral operator applied to the\ninitial data. A key advantage of such an approach is that it allows to estimate wavepacket\ncoupling as a sum of contributions of highly oscillatory terms and to get a precise estimate of\nmagnitude of every term. In contrast, the well known \"ansatz\" approach as, for instance, in\n[38] and [32], requires to find a clever ansatz with consequent estimations of the \"residuum\"\nin an appropriate norm. Our approach can naturally treat general tensorial polynomial\nnonlinearities F of arbitrary large degree NF and any number of wavepackets, whereas finding\na good ansatz which allows to estimate the residuum in such a general situation would be\ndifficult. For readers interested in detailed features of one-wavepacket solutions to the sineGordon equations, we refer to [32], [38] and [39].\nExample 2: Nonlinear Schrodinger equation. The Nonlinear Schrodinger equation\n(NLS) with d spatial variables ([42], [16], [15]) has the form\n1\n\u2202\u03c4 z (r, \u03c4 ) = i \u03b3 (\u2212i\u2207) z (r, \u03c4 ) + \u03b1 |z|2 z (r, \u03c4 ) , z (r, 0) = h (r) , r \u2208 Rd ,\n\u033a\n\n25\n\n(2.90)\n\n\fwhere \u03b1 is a complex constant, \u03b3 (\u2212i\u2207) is a second-order differential operator, its symbol\n\u03b3 (k) is a real, symmetric quadratic form\nX\nX\n\u03b3 (k) = \u03b3 (k, k) =\n\u03b3 ij ki kj , \u03b3 (\u2212i\u2207) z = \u2212\n\u03b3 ij \u2202ri \u2202rj z.\n\nTo put the NLS into the framework of this paper we introduce the following two-component\nsystem\n1\n2\n\u2202\u03c4 z+ (r, \u03c4 ) = i \u03b3 (\u2212i\u2207) z+ (r, \u03c4 ) + \u03b1z\u2212 z+\n(r, \u03c4 ) ,\n(2.91)\n\u033a\n1\n2\n(r, \u03c4 ) ,\n\u2202\u03c4 z\u2212 (r, \u03c4 ) = \u2212i \u03b3 (i\u2207) z\u2212 (r, \u03c4 ) + \u03b1\u2217 z+ z\u2212\n\u033a\nz+ (r, 0) = h (r) , z\u2212 (r, 0) = h\u2217 (r) , r \u2208 Rd ,\nwhere \u03b1\u2217 denotes complex conjugate to \u03b1. Obviously if z (r, \u03c4 ) is a solution of (2.90) then\nz+ (r, \u03c4 ) = z (r, \u03c4 ), z\u2212 (r, \u03c4 ) = z \u2217 (r, \u03c4 ) gives a solution of (2.91). Using the Fourier transform\nwe get from (2.90)\n\n1\n\\\n\u2217 z 2 ) (k, \u03c4 ) , k \u2208 Rd .\n\u2202\u03c4 \u1e91 (k, \u03c4 ) = i \u03b3 (k) \u1e91 (k, \u03c4 ) + \u03b1(z\n(2.92)\n\u033a\n\b\nNow the band-crossing set \u03c3 = k \u2208 Rd : \u03b3 (k) = 0 . We assume that the quadratic form\n\u03b3 is not identically zero. The Fourier transform of (2.91) takes the form of (2.67) with\n\u0014\n\u0015\n\u0014\n\u0015\u0014\n\u0015\n\u00db+\n\u03b3 (k)\n0\n\u00db+\n\u00db =\n, L (k) \u00db =\n,\n0\n\u2212\u03b3 (\u2212k)\n\u00db\u2212\n\u00db\u2212\n\uf8ee \u0010 \u0010 \u0011 \u0010 \u0011 \u0010 \u0011\u0011 \uf8f9\n\\\n\u0010 \u0011\n\u00db \u1e91\u2212 \u00db\n\u00db\n\u1e91\n\u1e91\n\u03b1\n+\n+\n\uf8fa\n\uf8ef\n\u03c9 (k) = |\u03b3 (k)| , F\u0302 (3) \u00db3 = \uf8f0 \u0010 \u0010 \u0011 \u0010 \u0011 \u0010 \u0011\u0011 \uf8fb ,\n\\\n\u03b1\u2217 \u1e91\u2212 \u00db \u1e91\u2212 \u00db \u1e91+ \u00db\n\nTo satisfy the requirements of Condition 2.14 we have to take the wave vectors k\u2217l \u2208\n/ \u03c3 so\nthat\n2\u03b3 (k\u2217l\u2032 )\n2\u03b3 (k\u2217l )\n(2.93)\n\u03b3 (k\u2217l\u2032 , *) if l 6= l\u2032 ,\n\u03b3 (k\u2217l , *) 6=\n\u2207 |\u03b3 (k\u2217l )| =\n|\u03b3 (k\u2217l )|\n|\u03b3 (k\u2217l\u2032 )|\nwhich provides (2.41). Since\n\u0003\n\u0002\n|\u03b3 (k\u2217l )| \u03bb \u2212 \u03b6 |\u03b3 (\u03bbk\u2217l )| = |\u03b3 (k\u2217l )| \u03bb \u2212 \u03b6 |\u03bb|2 ,\nand \u03bb is odd, every point k\u2217l \u2208\n/ \u03c3 satisfies Condition 2.13. If the quadratic form \u03b3 is not\nsingular, that is det \u03b3 6= 0, then condition (2.93), which ensures that group velocities of\nwavepackets are different, holds when\n\u03b3 (k\u2217l )\n\u03b3 (k\u2217l\u2032 )\nk\u2217l\u2032 if l 6= l\u2032 .\nk\u2217l 6=\n|\u03b3 (k\u2217l )|\n|\u03b3 (k\u2217l\u2032 )|\n\nIn this case Theorem 2.19 is applicable, and generic wavepacket solutions of the NLS are\nlinearly superposed and propagate almost independently with coupling O (\u03b2). More precisely,\nas a corollary of Theorem 2.19 we obtain the following statement.\n26\n\n\fTheorem 2.22 (Superposition for NLS) Assume that initial data of the NLS (2.90) have\nthe form h = h1 + . . . + hNh\nhl (r) = eik\u2217l *m \u03a6l,+ (\u03b2r \u2212 r0 ) + e\u2212ik\u2217l *m \u03a6l,\u2212 (\u03b2r \u2212 r0 ) , l = 1, . . . , Nh\nwhere \u03a6l,\u03b6 (r) are arbitrary Schwartz functions. Assume also that det \u03b3 6= 0 and the vectors\nk\u2217l satisfy conditions\n\u03b3 (k\u2217l ) 6= 0, l = 1, . . . , Nh ; k\u2217l 6= k\u2217l\u2032 if l 6= l\u2032 .\nThen solution z = z (h) is a linear superposition\nz (h) = z (h1 ) + . . . + z (hNh ) + D\nwith a small coupling term D\nsup kD (\u03c4 )kL\u221e (Rd ) \u2264 C\u03b4\n\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\n\u033a\n\u03b2\n\n1+\u03b4\n\n,\n\nwhere \u03b4 > 0 can be taken arbitrary small.\nWe note in conclusion, that the superposition principle reduces dynamics of multi-wavepacket\nsolutions to dynamics of single-wavepacket solutions; we do not study dynamics of singlewavepacket solutions in this paper. Note that the theory of NLS-type approximations of\none-wavepacket solutions of hyperbolic PDE is well-developed, see [29], [30], [18], [40], [41],\n[5] and references therein. Relevance of different group velocities of wavepackets for smallness\nof their interaction was noted in [29].\n\n2.3\n\nGeneralizations\n\nNote that in a degenerate case when the function \u03c9 nl (k) is linear in the direction of k\u2217 the\nequation (2.42) for \u03b6 = 1 has many solutions for which \u03b8 6= \u00b11 and Condition 2.13 does not\nhold. It turns out, that if Condition 2.13 for dispersion relations \u03c9 n (k) at k\u2217 is not satisfied,\nstill we can prove our results under the following alternative condition. We consider here the\ncase of PDE in the entire space Rd and k \u2208 Rd .\nCondition 2.23 (complete degeneracy) The series (2.21) has only F\u0303 (m) with odd m.\nThe wavevectors k\u2217l and functions \u03c9 nl (k), l = 1, . . . , Nh , have the following three properties:\n(i) There exists \u03b4 > 0 such that for every l1 6= l2 , the following inequality holds:\n\u2207k \u03c9 nl1 (\u03bd 1 k\u2217l1 ) \u2212 \u2207k \u03c9 nl2 (\u03bd 2 k\u2217l2 ) \u2265 \u03b4,\n\n(2.94)\n\nfor any odd integers \u03bd 1 , \u03bd 2 = 1, 3, . . ..\n(ii) There exists \u03b4 > 0 such that \u03bdk\u2217l does not get in a \u03b4-neighborhood of \u03c3 for any odd\ninteger \u03bd and any l = 1, . . . , Nh .\n27\n\n\f(iii) For any positive integer odd number \u03b8 and any k\u2217l , for any n the following identities\nhold:\n\u2207k \u03c9 n (\u03b8k\u2217l ) = \u2207k \u03c9 n (k\u2217l ) ,\n(2.95)\n\u03c9 n (\u03b8k\u2217l ) = \u03b8\u03c9 n (k\u2217l ) .\n\n(2.96)\n\nA nontrivial examples, where the above Condition 2.23 is satisfied, is given below.\nWe give here a generalization of Definition 2.14.\nDefinition 2.24 (generic multi-wavepackets) A multi-wavepacket \u0125 as defined in Definition 2.10 is called generic if (i) the centers k\u2217l , l = 1, . . . , Nh , of all wavepackets satisfy\nConditions 2.11 and 2.12; (ii) either the dispersion relations \u03c9 n (k) at every k\u2217l and band nl\nsatisfy Condition 2.13 or they satisfy Condition 2.23.\nThe statement of Theorem 2.19 remains true if Condition 2.14 is replaced by less restrictive\nCondition 2.24, namely the following theorem holds.\nTheorem 2.25 Let the initial data of the modal evolution equation (2.61) be a multi-wavepacket,\ni.e. the sum of Nh wavepackets \u0125l as in (2.45) satisfying Definitions 2.9, 2.10. Suppose that\n(2.46) holds. \u0010Assume\nalso that \u0125 is generic in the sense of Definition 2.24. Then the so\u0011\nlution \u00db = G \u0125 to the modal evolution equation (2.61) satisfies the approximate linear\nsuperposition principle, namely (2.69), (2.70), (2.71) and (2.72) hold.\nThe proofs we give in this paper directly apply to more general Theorem 2.25.\nAnother generalization concerns the possibility to shift independently initial wavepackets.\nIf initial data involve parameters rl as in (2.79) it is possible to prove that C\u01eb in (2.48), (2.70)\nand (2.72) does not depend on rl \u2208 Rd if the functions \u03a8jl are Schwartz functions. Most\nof the proofs remain the same, but several statements have to be modified, and we present\nproofs in a subsequent paper.\nOne more generalization concerns the smoothness of initial data. It is possible to take\ninitial data hl (r) with a finite smoothness rather than from Schwartz class. Namely, consider\nweighted spaces L1,a with the norm\nZ\nkv\u0302kL1,a =\n(1 + |k|)a |v\u0302 (k)| dk, a \u2265 0.\n(2.97)\nRd\n\nObviously, large a corresponds to high smoothness of the inverse Fourier transform v (r).\nThen if functions \u0125l,\u03b6 (k) have the form (2.36) with \u0125\u03b6 (k) = \u0125l,\u03b6 (k) from the class L1,a the\ninequality (2.70) can be replaced by\nsup\n0\u2264\u03c4 \u2264\u03c4 \u2217\n\nD\u0302 (\u03c4 )\n\nL1\n\n\u2264 C\u01eb\n\n28\n\n\u033a\n\u03b2\n\n1+\u01eb\n\n|ln \u03b2| + C\u01eb \u03b2 s ,\n\n(2.98)\n\n\fwhere s > 0 and \u01eb > 0 have to satisfy restriction s\u01eb < a. This generalization requires minor\nmodifications in the proofs and in conditions (2.33) and (2.34) C\u01eb \u03b2 has to be replaced by\nC\u01eb \u03b2 s . In particular, if a = 1, \u033a = \u03b2 2 and s = 1/2 the right-hand side of (2.98) can be\nestimated by C\u01eb1 \u03b2 1/2\u2212\u01eb1 with arbitrary small \u01eb1 .\nMore generalizations which involve the structure of equations are discussed in Sections\n7.3 and 7.4. Now we give an example where Condition 2.23 is applicable.\nExample 3: Semilinear wave equation. Let us consider a semilinear wave equation\nwith d spatial variables\n\u2202\u03c42 z (r, \u03c4 ) =\n\n\u03b1\n1\n\u2206z (r, \u03c4 ) + \u2202x1 z 3 (r, \u03c4 ) , r \u2208 Rd ,\n2\n\u033a\n\u033a\n\n(2.99)\n\nwhere \u2206 is the Laplace\noperator, \u03b1 is an arbitrary complex constant, \u033a = \u03b2 2 . We introduce\n\u221a\nthe operator A = \u2212\u2206 which is defined in terms of the Fourier transform, it has symbol |k|.\nWe rewrite (2.99) in the form of a first-order system\n1\n\u2202\u03c4 z (r, \u03c4 ) = Ap (r, \u03c4 ) , r \u2208 Rd ;\n\u033a\n1\n\u2202\u03c4 p (r, \u03c4 ) = \u2212 Az (r, \u03c4 ) + \u03b1A\u22121 \u2202x1 z 3 (r, \u03c4 ) .\n\u033a\n\n(2.100)\n\n1\n, it is a zero order operator. We rewrite\nThe linear operator A\u22121 \u2202x1 has the symbol \u2212ik\n|k|\n(2.100) in the form of (2.67) where\n\u0015\n\u0014\n\u0015\u0014 \u0015\n\u0012\u0014 \u0015\u0013\n\u0014\n\u0014 \u0015\nz\n0 A\nz\nz\n0\n.\nU=\n, \u2212iL (\u2212i\u2207r ) U =\n, F\n=\u03b1\n\u2212A 0\np\np\n\u2212A\u22121 \u2202x1 z 3\np\n\nUsing the Fourier transform we get (2.61) with\n\u0014 \u0015\n\u0014 \u0015\n\u0014\n\u0015\u0014 \u0015\n\u0010 \u0011 \u2212i\u03b1k\n0\n\u1e91\n0\n|k|\n\u1e91\n1d\n3\n(3)\n\u00db =\n(z 3 )\n,\n\u00db =\n, \u2212iL (k) \u00db =\n, F\u0302\n1\np\u0302\n\u2212 |k| 0\np\u0302\n|k|\nd\n3 ) (k) =\n(z\n\n1\n\n(2\u03c0)\n\n2d\n\nZ\n\n\u1e91 (k\u2032 ) \u1e91 (k\u2032\u2032 ) \u1e91 (k\u2032\u2032\u2032 ) dk\u2032 dk\u2032\u2032 .\n\nk\u2032 ,k\u2032\u2032 \u2208R2d ;k\u2032 +k\u2032\u2032 +k\u2032\u2032\u2032 =k\n\nk1\nis uniformly bounded and smooth for |k| =\n6 0 conditions (2.26) and (2.28)\nSince the factor |k|\nare satisfied. The eigenvalues and corresponding eigenvectors of L are given explicitly:\n\u0014 \u0015\n\u0014\n\u0015\ni\n\u2212i\n\u22121/2\n\u22121/2\n.\n(2.101)\n, g\u2212 (k) = 2\n\u03c9 + (k) = |k| , \u03c9 \u2212 (k) = \u2212 |k| , g+ (k) = 2\n1\n1\n\nSince the matrix L (k) is Hermitian, Condition 2.5 is satisfied. The singular set \u03c3 consists\nof the single point k = 0. Note that conclusions of Theorem 2.19 are applicable to equation\n29\n\n\f(2.100) and consequently to (2.99). For instance, we take the initial data for (2.100) in the\nform (2.79)\nz (r, 0) = h0 , p (r, 0) = h1 , hj =\n\nnh\nX\nl=1\n\n\u03a8jl (\u03b2r \u2212 rl ) eik\u2217l *r + cc, j = 0, 1,\n\n(2.102)\n\nwhere \u03a80l (r), \u03a81l (r) are arbitrary Schwartz functions, cc means complex conjugate to the\npreceding terms. The points rl are arbitrary. Note that terms corresponding to k\u2217l can be\nwritten using the basis (2.101) as\n\u0015\n\u0014\n\u03a80l\neik\u2217l *r = [\u03a6+,l g+ + \u03a6\u2212,l g\u2212 ] eik\u2217l *r .\n(2.103)\n\u03a81l\nIn this case all requirements of Definition 2.9 are fulfilled. The number of initial wavepackets\nfor the first-order system (2.100) corresponding to initial data (2.102) ) equals Nh = 2nh and\nthere are 2Nh wavepacket centers \u03b8k\u2217l , \u03b8 = \u00b1. To satisfy the requirements of Condition 2.14\nwe have to take the wave vectors k\u2217l 6= 0 so that\n\u03b8k\u2217l\n\u03b8\u2032 k\u2217l\u2032\nif l 6= l\u2032 or \u03b8 6= \u03b8\u2032 ,\n6=\n|k\u2217l |\n|k\u2217l\u2032 |\n\nwhich provides (2.41). Since\n|k\u2217l | \u03bb \u2212 \u03b6 |\u03bbk\u2217l | = |k\u2217l | (\u03bb \u2212 \u03b6 |\u03bb|) ,\nequation (2.42) has solutions \u03bb 6= \u03b6 and every point k\u2217l does not satisfy Condition 2.13. This\nis the property of the very special, purely homogeneous \u03c9 (k) = |k|. Checking the second\nalternative, namely Condition 2.23 we observe that\n\u2207k |\u03bdk\u2217l | =\n\n\u03bd k\u2217l\n\u03bdk\u2217l\n=\n.\n|\u03bdk\u2217l |\n|\u03bd| |k\u2217l |\n\nHence, if\n\n\u03b8k\u2217l\n\u03b8\u2032 k\u2217l\u2032\nfor l 6= l\u2032 or \u03b8 6= \u03b8\u2032 and if k\u2217l 6= 0\n(2.104)\n6=\n|k\u2217l |\n|k\u2217l\u2032 |\nthen Condition 2.23 is satisfied and Superposition Theorem 2.19 is applicable. As a corollary\nof Theorem 2.19 applied to (2.99) we obtain that if the initial data for (2.99) equal the sum\nof wavepackets, then the solution equals the sum of separate solutions plus a small remainder,\nmore precisely we have the following theorem.\nTheorem 2.26 (superposition principle for wave equation) Assume that the initial data\nfor (2.100) to be a multi-wavepacket of the form (2.102) and (2.46) holds. Then the solution\nz (r, \u03c4 ) to (2.100), (2.102) satisfy the superposition principle, namely\nz (r, \u03c4 ) =\n\nnh\nXX\n\nz\u03b8,l (r, \u03c4 ) + D1 (r, \u03c4 ) , p (r, \u03c4 ) =\n\nnh\nXX\n\n\u03b8=\u00b1 l=1\n\n\u03b8=\u00b1 l=1\n\n30\n\np\u03b8,l (r, \u03c4 ) + D2 (r, \u03c4 )\n\n\fwhere z\u03b8,l (r, \u03c4 ) , p\u03b8,l (r, \u03c4 ) is a solution of (2.100) with the initial condition\n\u0015\n\u0014\nz\u03b8,l (r, 0)\n= \u03a6\u03b8,l (\u03b2r \u2212 rl ) g\u03b8 eik\u2217l *r + cc,\np\u03b8,l (r, 0)\n\n(2.105)\n\nwith \u03a6\u03b8,l (r) being arbitrary Schwartz functions. If (2.104) holds, the coupling terms D1 and\nD2 satisfy the bound\n\u0003\n\u0002\n\u033a\nkD1 (\u03c4 )kL\u221e + kD2 (\u03c4 )kL\u221e \u2264 C\u03b4\u2032 1+\u03b4 ,\n\u03b2\n0\u2264\u03c4 \u2264\u03c4 \u2217\nsup\n\n(2.106)\n\nwhere \u03c4 \u2217 and C\u03b4\u2032 do not depend on \u03b2,\u033a and \u03b4 can be taken arbitrary small..\nIn the following sections we introduce concepts and develop analytic tools allowing to\nprove the approximate linear superposition principle as stated in Theorems 2.15, 2.19 and\n2.25.\n\n3\n\nReduced evolution equation\n\nSince the properties of the evolution equations (2.3) and (2.61) are very similar, we consider\nhere in detail the lattice evolution equation (2.3) with understanding that all the statements\napply to\u0010the PDE\n\u0168 with \u00db, [\u2212\u03c0, \u03c0]d with Rd , the function space\n\u0011 (2.61) if we replace\n\u0001\nL1 = L1 [\u2212\u03c0, \u03c0]d with L1 = L1 Rd and so on.\nFirst, using the variation of constants formula we recast the modal evolution equation\n(2.3) into the following equivalent integral form\nZ \u03c4 \u2212i \u03c4 \u2212\u03c4 \u2032\n\u0010 \u0011\n(\n)\n\u2212i\u03b6\u03c4\n\u0168 (k, \u03c4 ) =\ne \u033a L(k) F\u0303 \u0168 (k, \u03c4 ) d\u03c4 \u2032 + e \u033a L(k) h\u0303 (k) , \u03c4 \u2265 0.\n(3.1)\n0\n\nThen we introduce for \u0168 (k, \u03c4 ) its two-time-scale representation (with respectively slow and\nfast times \u03c4 and t = \u03c4\u033a )\ni\u03c4\n\ni\u03c4\n\n\u0168 (k, \u03c4 ) = e\u2212 \u033a L(k) \u0169 (k, \u03c4 ) , \u0168n,\u03b6 (k, \u03c4 ) = \u0169n,\u03b6 (k, \u03c4 ) e\u2212 \u033a \u03b6\u03c9 n (k) ,\n\n(3.2)\n\nwhere \u0169n,\u03b6 (k, \u03c4 ) are the modal coefficients of \u0169 (k, \u03c4 ) (see (2.18)); note that \u0169n,\u03b6 (k, \u03c4 ) may\ndepend on \u033a, therefore (3.2) is just a change of variables. Consequently we obtain the\nfollowing reduced evolution equation for \u0169 = \u0169 (k, \u03c4 ), \u03c4 \u2265 0,\n\u0169 (k, \u03c4 ) = F (\u0169) (k, \u03c4 ) + h\u0303 (k) , F (\u0169) =\nF\n\n(m)\n\nm\n\n(\u0169 ) (k, \u03c4 ) =\n\nZ\n\n\u03c4\n\ne\n\ni\u03c4 \u2032\nL(k)\n\u033a\n\nF\u0303\n\n(m)\n\n0\n\n31\n\n\u0012\u0010\n\ne\n\nmF\nX\n\nm=2\n\nF (m) (\u0169m (k, \u03c4 )) ,\n\n\u2212i\u03c4 \u2032\nL(*)\n\u033a\n\n\u0011m \u0013\n\u0169\n(k, \u03c4 \u2032 ) d\u03c4 \u2032 ,\n\n(3.3)\n(3.4)\n\n\fwhere the quantities F\u0303 (m) are defined by (2.21) and (2.22) in terms of the susceptibilities\n\u03c7(m) .\nThe norm of\u0010 the \u0011oscillatory integral F (m) in (3.4) is estimated in terms of the norm of\nthe tensor \u03c7(m) k, ~k defined in (2.26), (2.27). The operator F (m) is shown to be a bounded\n\none from (E)m into E, see Lemma 5.1 for details The proof of this property is based on the\nfollowing Young inequality for the convolution\nk\u0169 \u2217 \u1e7dkL1 \u2264 k\u0169kL1 k\u1e7dkL1 .\n\n(3.5)\n\nFor a detailed analysis of solutions of (3.3) we recast the equation (3.3) for \u0169 (k, \u03c4 ) using\nprojections (2.19) as the following expanded reduced evolution equation\n\u0169n,\u03b6 (k, \u03c4 ) =\n\n\u221e X\nX\n\nm=2 ~\nn,~\u03b6\n\n(m)\n\nFn,\u03b6,~n,~\u03b6 (\u0169m ) (k, \u03c4 ) + hn,\u03b6 (k) , \u03c4 \u2265 0,\n\n(3.6)\n\nfor the modal coefficient \u0169n,\u03b6 (k, \u03c4 ). In the above formula and elsewhere we use notations\n\u0010\n\u0011\n\u0001\n\u0001\n~n = n\u2032 , . . . , n(m) , ~\u03b6 = \u03b6 \u2032 , . . . , \u03b6 (m) , ~k = k\u2032 , . . . , k(m) .\n(3.7)\n(m)\n\nThe operators Fn,\u03b6,~n,~\u03b6 are m-linear oscillatory integral operators defined by the formulas\n\u001a\nZ \u03c4Z\n\u0010\n\u0011\u03c4 \u001b\n1\n(m)\nFn,\u03b6,~n,~\u03b6 (\u01691 . . . \u0169m ) (k, \u03c4 ) =\nexp i\u03c6n,\u03b6,~n,~\u03b6 k, ~k\n(3.8)\n\u033a\n0\nDm\n\u0010\n\u0011h\n\u0010\n\u0010\n\u0011\n\u0011i\n(m)\n\u03c7n,\u03b6,~n,~\u03b6 k, ~k \u01691 (k\u2032 , \u03c4 1 ) , . . . , \u0169m k(m) k, ~k , \u03c4 1 d\u0303(m\u22121)d~kd\u03c4 1 ,\n\nwhere we use notations (2.23), (2.24), (2.25). In (3.8) the interaction phase function \u03c6 is\ndefined by\n\u0010\n\u0011\n\u0010\n\u0011\n\u0001\n\u03c6n,\u03b6,~n,~\u03b6 k, ~k = \u03b6\u03c9 n (k) \u2212 \u03b6 \u2032 \u03c9 n\u2032 (k\u2032 ) \u2212 . . . \u2212 \u03b6 (m) \u03c9 n(m) k(m) , k(m) = k(m) k, ~k\n(3.9)\n\u0010\n\u0011\n(m)\nand the susceptibilities \u03c7n,\u03b6,~n,~\u03b6 k, ~k are m-linear symmetric tensors (i.e. mappings from\n\u0001m\nC2J\ninto C2J ) defined for almost all k, ~k by the following formula\n\u0010\n\u0011\u0002\n\u0001\u0003\n(m)\n\u03c7n,\u03b6,~n,~\u03b6 k, ~k \u01691 (k\u2032 ) , . . . , \u0169m k(m) =\n(3.10)\n\u0010\n\u0010\n\u0011\u0011\n\u0010\n\u0010\n\u0011\u0011i\n\u0010\n\u0011h\n.\n\u03a0n,\u03b6 (k) \u03c7(m) k, ~k \u03a0n\u2032 ,\u03b6 \u2032 (k\u2032 ) \u01691 (k\u2032 ) , . . . , \u03a0n(m) ,\u03b6 (m) k(m) k, ~k \u0169m k(m) k, ~k\n\u0010\n\u0011\n(m)\nFor the lattice equation \u03c7 n,\u03b6,~n,~\u03b6 k, ~k is 2\u03c0-periodic with respect to every variable k, k\u2032 , . . . , k(m) .\nNote that operators F (m) (um ) in (3.3) can be rewritten using (3.8) as\nX (m)\nF (m) (um ) =\nFn,\u03b6,~n,~\u03b6 (\u0169m ) .\n~\nn,~\u03b6\n\n(m)\n\nWe also call operators Fn,\u03b6,~n,~\u03b6 decorated operators.\n32\n\n(3.11)\n\n\fRemark 3.1 The expanded reduced evolution equation (3.6) is instrumental to the nonlinear\nanalysis. Its very form, a convergent series of multilinear forms which are oscillatory integrals (3.8), is already a significant step in the analysis of the solution accomplishing several\n(m)\ntasks: (i) it suggests a constructive representation for the solution; (ii) every term Fn,\u03b6,~n,~\u03b6\ncan be naturally interpreted as nonlinear interaction of the underlying linear modes; (iii)\n(m)\nthe representation of Fn,\u03b6,~n,~\u03b6 as the oscillatory integral (3.8) involving the interaction phase\n\u0010\n\u0011\n(m)\n(m)\n~\n\u03c6n,\u03b6,~n,~\u03b6 and the susceptibilities \u03c7n,\u03b6,~n,~\u03b6 k, k directly relates Fn,\u03b6,~n,~\u03b6 to the terms of the original evolution equation as well as to physically significant quantities.\n\u0010\n\u0011 We can also add that\n~\nsince we consider \u033a \u2192 0 the interaction phase function \u03c6n,\u03b6,~n,~\u03b6 k, k plays the decisive role\nin the analysis of nonlinear interactions of different modes.\nThe analysis of fundamental properties of the reduced evolution equation (3.6), including,\nin particular, the linear modal superposition principle, involves and combines the following\nthree components: (i) the linear spectral theory component in the form of the modal decomposition of the solution and introduction of wavepackets as elementary waves; (ii) functionanalytic component which deals with the structure of series similar to the one in (3.6) and its\ndependence on the nonlinearity of the original evolution equation; (iii) asymptotic analysis of\noscillatory integrals (3.8) which allows to estimate the magnitude of nonlinear interactions\nbetween different modes and, in particular, to show that generically different modes almost\ndo not interact leading to the superposition principle.\nSometimes it is convenient to rewrite (3.8) in a slightly different form. The convolution\nintegral (3.8) according to (2.25) involves the following phase matching condition\nk\u2032 + . . . + k(m) = k.\nUsing the following notation for the integral over the plane (3.12)\nZ\n\u0010\n\u0011\n~\nf k, k dk\u2032 . . . dk(m\u22121) =\n\n(3.12)\n\n(3.13)\n\nk\u2032 ,...,k(m\u22121) \u2208[\u2212\u03c0,\u03c0](m\u22121)d ;k\u2032 +...+k(m) =k\n\nZ\n\n[\u2212\u03c0,\u03c0]md\n\n\u0010\n\u0011\n\u0001\n~\nf k, k \u03b4 k \u2212 k\u2032 \u2212 . . . \u2212 k(m) dk\u2032 . . . dk(m)\n\nin terms of a delta-function we can rewrite (3.8) in the form\n\u001a\nZ \u03c4Z\n\u0010\n\u0011\u03c4 \u001b\n1\n1\n(m)\n~\nFn,\u03b6,~n,~\u03b6 (\u01691 . . . \u0169m ) (k, \u03c4 ) =\nexp i\u03c6n,\u03b6,~n,~\u03b6 k, k\n(3.14)\nm(d\u22121)\n\u033a\n(2\u03c0)\n0\n[\u2212\u03c0,\u03c0]md\n\u0011\n\u0001\n\u0001 (m) \u0010\n\u2032\n(m)\n~\n\u03b4 k\u2212 k \u2212 ...\u2212k\n\u03c7n,\u03b6,~n,~\u03b6 k, k \u01691,\u03b6 \u2032 (k\u2032 ) . . . \u0169m,\u03b6 (m) k(m) dk\u2032 . . . dk(m) d\u03c4 1 .\n\n4\n\nFunction-analytic operator series\n\nIn this section necessary algebraic concepts required for the analysis are introduced. We study\nthe reduced evolution equation (3.3) as a particular case of the following abstract nonlinear\n33\n\n\fequation in a Banach space\nu = F (u) + x, F (u) =\n\n\u221e\nX\ns=2\n\nF (s) (xs )\n\n(4.1)\n\nwhere the nonlinearity F (u) is an analytic operator represented by a convergent operator\nseries. It is well known (see [25]) that the solution u = G (x) of such equation can be\nrepresented as a convergent series in terms of m-linear operators Gm which are constructed\nbased on F :\nG (x) = G (F , x) =\n\n\u221e\nX\n\nm=1\n\nG (m) (xm ) , G (m) (xm ) = G (m) (F , xm ) , where\n\nxm = x\n. . x} = x\n. . x}.\n| .{z\n| .{z\nm times\n\nm times\n\nUsing the multilinearity of G (m) we readily obtain the formula\nG (x1 + . . . + xN ) =\n=\n\n\u221e\nX\n\nm=1\n\nG ((x1 )m ) + . . . +\n\n\u221e\nX\n\nm=1\n\u221e\nX\n\nm=1\n\nG (m) ((x1 + . . . + xN )m )\n\n(4.2)\n\nG ((xN )m ) + GCI (x1 , . . . , xN ) ,\n\nwhere x = x1 + . . .+ xN represents a multi-wavepacket and GCI (x1 , . . . , xN ) collects all \"cross\nterms\" and describes the \"cross interaction\" (CI) of involved wavepackets x1 , . . . , xN . We\nwill find in sufficient detail the dependence of the solution operators Gm on the nonlinearity F\nand prepare a basis for the consequent estimation of nonlinear interactions between different\nmodes and wavepackets. Then combining the facts about the structure of the solution\noperators G (m) with asymptotic estimates of relevant oscillatory integrals we show that for a\nmulti-wavepacket x = x1 + . . . + xN the cross-interaction term satisfies the following estimate\n\u0001\nkGCI (x1 , . . . , xN )k = O (\u03b2) + O \u033a |ln \u03b2| /\u03b2 1+\u01eb , \u03b2, \u033a \u2192 0,\nimplying the modal superposition principle.\n\n4.1\n\nMultilinear forms and polynomial operators\n\nThe analysis of nonlinear equations of the form (3.3) requires the use of appropriate Banach\nspaces of time dependent fields, as well as multilinear and analytic functions in those spaces.\nIt also uses an appropriate version of the implicit function theorem. For the reader's convenience we collect in this section the known concepts and statements on the above-mentioned\nsubjects needed for our analysis. We in this section consider functional-analytic operators\nwhich are defined in a ball in a Banach space X with the norm kxkX . In our treatment of\nthe analytic functions in infinitely-dimensional Banach spaces we follow to [25, Section 3],\n[21].\n34\n\n\fDefinition 4.1 (polylinear operator) Suppose that x1 , x2 , . . . , xn are vectors in a Banach\nspace X. Let a function F (n) (~x), ~x = (x1 , . . . , xn ), take values in X and be defined for all\n~x \u2208 X n . Such a function F (n) is called a n-linear operator if it is linear in each variable, and\nit is said to be bounded if its following norm is finite\nF (n) =\n\nF (n) (x1 x2 . . . xn )\n\nsup\nkx1 kX =...=kxn kX =1\n\nX\n\n< \u221e.\n\n(4.3)\n\nDefinition 4.2 (polynomial) A function P (x) from X to X defined for all x \u2208 X is called\na polynomial in x of degree n if for all a, h \u2208 X and all complex \u03b1\nP (a + \u03b1h) =\n\nn\nX\n\nP\u03bd (a, h) \u03b1\u03bd ,\n\n\u03bd=0\n\nwhere P\u03bd (a, h) \u2208 X are independent of \u03b1 . The degree of Pn is exactly n if Pn (a, h) is not\nidentically zero. A polynomial F (x) is a homogeneous polynomial of a degree n if for all\nc\u2208C\nF (cx) = cn F (x) .\nThen n is called also the homogeneity index of F (x). A homogeneous polynomial F is called\nbounded if its norm\nkF k\u2217 = sup {kF (x)kX }\n(4.4)\nkxkX =1\n\nis finite. For a given n-linear operator F (n) (~x) = F (n) (x1 x2 . . . xn ) we denote by F (n) (xn )\na homogeneous of degree n polynomial from X to X:\nF (n) (xn ) = F (n) (x . . . x) .\n\n(4.5)\n\nNote the norm definitions (4.3), (4.4) and (4.5) readily imply\nF (n)\n\n\u2217\n\n\u2264 F (n) .\n\n(4.6)\n\nDefinition 4.3 (analyticity class 1) Let a function F be defined by the following convergent series\n\u221e\nX\nF (x) =\nF (m) (xm ) for kxkX < R\u2217F ,\n(4.7)\nm=2\n\nwhere F\n\n(m)\n\nm\n\n(x ), m = 2, 3, . . . is a sequence of bounded m-homogenious polynomials satisfying\nF (m)\n\n\u2217\n\n\u2212m\n\u2264 C\u2217F R\u2217F\n, m = 2, 3, . . . ,\n\n(4.8)\n\nThen we say that F (x) belongs to the analyticity class A\u2217 (C\u2217F , R\u2217F ) and write F \u2208 A\u2217 (C\u2217F , R\u2217F ) .\nNotice that for kxkX < R\u2217F we have\nkF (x)kX \u2264 C\u2217F\n\n\u221e\nX\nn=2\n\nkxknX\n\n\u2212n\nR\u2217F\n\n\u2212n0\nkxknX0 R\u2217F\n\u2264 C\u2217F\n\u22121 ,\n1 \u2212 kxkX R\u2217F\n\nimplying, in particular, the convergence of the series (4.7).\n35\n\n(4.9)\n\n\fDefinition 4.4 (analyticity class 2) If F (m) (~x), m = 2, 3, . . ., is a sequence of bounded\nm-linear operators from X m to X and\nF (m) \u2264 CF RF\u2212m , m = 2, 3 . . . .,\n\n(4.10)\n\nwe say that a function F defined by the series (4.7) for kxkX < RF belongs to the analyticity\nclass A (CF , RF ) and write F \u2208 A (CF , RF ) .\nIn this paper we will use operators from the classes A (CF , RF ) based on multilinear\noperators.\nNote that evidently A (CF , RF ) \u2282 A\u2217 (CF , RF ). One can construct a polynomial based\non a multilinear operator according to the formula (4.5). Conversely, the construction of a\nmultilinear operator, called polar form, based on a given homogeneous polynomial is described\nby the following statement, [21, Section 1.1, 1.3], [25, Section 26.2].\nProposition 4.5 (polar form) For any homogeneous polynomial P (n) (x) of degree n there\nis a unique symmetric n-linear operator P\u0303 (n) (x1 x2 . . . xn ), called the polar form of Pn (x),\nsuch that P (n) (x) = P\u0303 (n) (x . . . x). It is defined by the following polarization formula:\n!\nn\nX\nX\n1\nP\u0303 (n) (x1 x2 . . . xn ) = n\nP (n)\n\u03be j xj .\n(4.11)\n2 n! \u03be =\u00b11\nj=1\nj\n\nIn addition to that, the following estimate holds:\nkPn k\u2217 \u2264 P\u0303n\n\nnn\n\u2264\nkPn k\u2217 \u2264 en P (n)\nn!\n\n\u2217\n\n.\n\n(4.12)\n\nSince by Definition 4.4 functions from A (C, R) have zero of the second order at zero,\ntheir Lipschitz constant is small in a vicinity of zero. More exactly, the following statement\nholds.\nLemma 4.6 (Lipschitz estimate) If F \u2208 A (CF , RF ) then\nkF (x) \u2212 F (y)k \u2264 CF C kx \u2212 yk (kxk + kyk) for kxk , kyk \u2264 RF\u2032 < RF ,\n\n(4.13)\n\nwhere C > 0 depends on RF\u2032 and RF .\n\n4.2\n\nImplicit Function Theorem and expansion of operators into\ncomposition monomials\n\nHere we provide a version of the Implicit Function Theorem, first we formulate classical\nimplicit function theorem for equations u = F (u) + x with analytic function F and then we\npresent a refined implicit function theorem. The refined implicit function theorem we prove\nhere produces expansion of the solution u into a sum of terms which are multi-linear not only\n36\n\n\fwith respect to x but also with respect to F . The formulation of the theorem and the proof\ninvolve convenient labeling of the terms of the expansion (called composition monomials),\nand we use properly introduced trees to this end. The explicit expansion produced by the\nrefined implicit function theorem is required to be able to take into account rather subtle\nmechanisms which lead to the superposition principle.\nLet us consider the abstract nonlinear equation (4.1) and its solution u = u (x) for small\nkxk when the nonlinear operator F belongs to the class A (CF , RF ). We seek the solution u\nin the following form\nu = G (F , x) =\n\n\u221e\nX\n\nm=1\n\nG (m) (xm ) for sufficiently small kxk ,\n\n(4.14)\n\nand we call G the solution operator for (4.1). It readily follows from (4.1) that\nG (F , x) = x + F (G (F , x))\nand\n\n\u221e\nX\n\nm=1\n\nG (m) (xm ) = x +\n\n\u221e\nX\ns=2\n\nF (s)\n\n\u221e\nX\n\nm=1\n\nG (m) (xm )\n\n(4.15)\n!s !\n\n.\n\n(4.16)\n\n\u00bfFrom the above equation we can deduce recurrent formulas for multilinear operators G (m) .\nIndeed for m = 1 the linear term is the identity operator\nG (1) (x) = F (1) (x) \u2261 x.\n\n(4.17)\n\nFor m \u2265 2 we write the following recurrent formula\nG\n\n(m)\n\n(x1 . . . xm ) =\n\nm\nX\n\nX\n\ns=2 i1 +...+is =m\n\n\u0001\nF (s) G (i1 ) (x1 . . . xi1 ) . . . G (is ) (xm\u2212is +1 . . . xm ) .\n\n(4.18)\n\nBy the construction, if multilinear operators G (i) are defined by (4.18), then (4.16) is satisfied.\nNamely, expanding right-hand side of (4.16) using multi-linearity of F (s) we obtain a sum\nof expressions as in right-hand side of (4.18), and since (4.18) holds, terms in the left-hand\nside of (4.16) with given homogeneity index p cancel with the terms in the right-hand side\nwith the same homogeneity. Note that in (4.18) we do not assume that the operators F (s)\nand G (i) are symmetrized and the order of variables is important; we prefer to treat F (s)\nand G (m) as multilinear operators of s and m variables respectively. Though, when we apply\nconstructed G (i) to solve (4.1), we set x1 = . . . = xm .\nThe following implicit function theorem holds (see [4] and Theorem 4.25 below with a\nsimilar proof).\nTheorem 4.7 (Implicit Function Theorem) Let F \u2208 A (CF , RF ). Then there exists a\nsolution u = x + G (F , x) of the equation (4.1) u = x + F (u), given by the solution operator\nG \u2208 A (CG , RG ), where we can take\nRF2\nRF2\nCG =\n, RG =\n,\n2 (CF + RF )\n4 (CF + RF )\n37\n\n(4.19)\n\n\fthe series (4.14) converges for kxkX < RG . The multilinear operators G (m) (~x) satisfy the\nrecursive relations (4.17), (4.18).\nNote that uniqueness of the solution and continuous dependence on parameters follows\nfrom Lemma 4.6 and from a standard observation which we formulate in the following remark.\nRemark 4.8 If u1 , u2 are two solutions of the equation (4.1) with x = x1 , x2 respectively and\nku1 k , ku2 k \u2264 R, and F (u) is Lipschitz continuous for kuk \u2264 R with a Lipschitz constant\nq < 1 then ku1 \u2212 u2 k \u2264 (1 \u2212 q)\u22121 kh1 \u2212 h2 k . If u1 , u2 are two solutions of the equation\n(4.1) with F = F0 and F = F0 + F1 respectively, ku1 k , ku2 k \u2264 R, and F (u) is Lipschitz\ncontinuous for kuk \u2264 R with a Lipschitz constant q < 1 and F1 (u) \u2264 \u01eb when kuk \u2264 R then\nku1 \u2212 u2 k \u2264 \u01eb (1 \u2212 q)\u22121 .\nObserve that every term G (il ) in (4.18), in turn, can be recast as a sum (4.18) with m\nreplaced by il < m. Evidently applying the recurrent representation (4.18) and multilinearity\nof F (s) we can get a formula for G (m) as a sum of terms involving exclusively (i) the symbols\nF (m) , (ii) variables xj and (iii) parentheses. We will refer to the terms of such a formula\nas composition monomials. To be precise we give below a formal recursive definition of\ncomposition monomials. The monomials are expressions which involve variables uj , j =\n1, 2, . . ., and m-linear operators F (m) , m = 2, 3 . . ., and are constructed by induction as\nfollows.\n\b\n\u221e\nDefinition 4.9 (composition monomials) Let F (s) s=2 be a sequence of s-linear operators which act on variables uj , j = 1, 2, . . .. A composition monomial M of rank 0 is\nthe identity operator, namely M (uj ) = uj , and its homogeneity index is 1. A composition\nmonomial M of a non-zero rank r \u2265 1 has the form\n\u0001\u0001\n(4.20)\nM (ui0 . . . uis ) = F (s) M1 (ui0 . . . ui1 ) . . . Ms uis\u22121 +1 . . . uis ,\n\u0001\nwhere M1 (ui0 . . . ui1 ), M2 (ui1 +1 . . . ui2 ),..., Ms uis\u22121 +1 . . . uis , with 1 \u2264 i0 < i1 < . . . < is ,\nare composition monomials of ranks not exceeding r \u2212 1 (submonomials) and at least one of\nthe rank r \u2212 1, the homogeneity index of Mj equals ij \u2212 ij\u22121 . For a composition monomial\nM the operator F (s) in its representation (4.20) is called its root operator. The index of\nhomogeneity of M defined by (4.20) equals im \u2212 i0 + 1. We call the labeling of the arguments\nof a composition monomial M defined by (4.20) by consecutive integers standard labeling if\ni0 = 1.\nIf the monomials M1 , ., Ms have the respective homogeneity indexes \u03bd (Mi ) then we\nreadily get that the homogeneity index of the monomial M satisfies the identity\n\u03bd (M) = \u03bd (M1 ) + . . . + \u03bd (Ms ) .\n\n(4.21)\n\nUsing the formula (4.20) inductively we find that\n\b any\u221ecomposition monomial M is given by a\nformula which involves symbols from the set F (s) s=2 , arguments ui and parentheses, and\nif s-linear operators are substituted as F (s) we obtain the terms contained in the expansion\nof G (m) .\n38\n\n\fDefinition 4.10 (incidence number) The total number of symbols F (q) involved in M is\ncalled the incidence number for M.\nFor instance, the expression of the form\nM = F (4) u1 u2 u3 F (3) u4 F (2) (u5 u6 ) F (3) (u7 u8 u9 )\n\n\u0001\u0001\n\n(4.22)\n\nis an example of a composition monomial M of rank 3, incidence number 4 and homogeneity\u0001\nindex 9. It has three submonomials. Namely, the first one is F (3) u4 F (2) (u5 u6 ) F (3) (u7 u8 u9 )\nof rank 2 and incidence number 3. The second submonomial F (2) (u5 u6 ) has rank 1 and incidence number 1, and the third one is F (3) (u7 u8 u9 ) of rank 1 and incidence number 1.\nWhen analyzing the structure of composition monomials we use basic concepts and notation from the graph theory, namely, nodes, trees and subtrees.\nDefinition 4.11 (nodes, tree, subtree) A (finite) directed graph T consists of nodes\nNi \u2208 NT where NT is the set (finite) of nodes of T and a set of edges Ni Nj \u2208 NT \u00d7 NT . An\nedge Ni Nj connects Ni with Nj , it is an outcoming edge of Ni and an incoming edge of Nj . A\ntree (more precisely a rooted tree, we only consider rooted trees) is a directed connected graph\nwhich is cycle-free and has a selected root node, that is a node N\u2217 which has no incoming\nedges. If a node N has an outcoming edge NNj the node Nj is called a child node of N; if a\nnode N has an incoming edge Nj N the node Nj is called the parent node of N. We denote\nthe parent node of N by p (N). If a node does not have children it is called an end node (or\na leaf ). For every node N we denote by \u03bc (N) the number of child nodes of the node N. If\na path connects two nodes we call the number of edges in the path its length. We denote\nby l (N) the length of a path which connects N\u2217 with N. Every node N of the tree T can be\ntaken as a root node of a subtree which involves all descendent nodes of N and connecting\nedges; we denote this maximal subtree T \u2032 (N). Since we consider only maximal subtrees we\nsimply call them subtrees. We call by the rank of a tree the maximal length of a path from\nits root node to an end node and denote it by r (T ). We call by the rank of a node N of the\ntree T the rank of the subtree T \u2032 (N).\nDefinition 4.12 (tree incidence number and homogeneity index) For a tree T we call\nthe number of non-end nodes incidence number i = i (T ). We denote the number of end nodes\nof the tree by \u03bd (T ) and call it homogeneity index.\nElementary properties of trees. Since a tree does not have cycles, the path connecting\ntwo nodes on a tree is unique. The root node N\u2217 does not have a parent node, and since it\nis connected with every other node, every non-root node has a parent node. The end nodes\nhave zero rank. The only node with rank r (T ) is the root node. The total number of nodes\nof a tree T equals m (T ) + i (T ).\nDefinition 4.13 (ordered tree) A tree is called an ordered tree if for every node N all\nchild nodes of N are labeled by consecutive positive integers (which may start not from 1).\n39\n\n\fHence, for any node N \u2032 6= N\u2217 there is the parent node N = p (N \u2032 ) and the order number (label)\no (N \u2032 ), i1 \u2264 o (N \u2032 ) \u2264 i1 + \u03bc (N) \u2212 1. Two trees are equal if there is one-to-one mapping \u0398\nbetween the nodes which preserves edges, maps the root node into the root node and preserves\nthe order of children of every node up to a shift: if \u0398 (N) = \u00d1 and p (N1 ) = p (N2 ) = N\nthen o (N1 ) \u2212 o (N2 ) = o (\u0398 (N1 )) \u2212 o (\u0398 (N2 )).\nSince we use in this paper only ordered trees we simply call them trees.\nStandard node labeling and ordering. We use the following way of labeling and ordering of end nodes of a given ordered tree T . Let r\u0302 be the rank of T . For any end node N we\ntake the unique path N\u2217 N1 . . . Nl(N )\u22121 N of length l (N) \u2264 r\u0302 connecting it to the root. Since\nthe tree is ordered, every node Nj in the path has an order number o (Nj ). These order numbers form a word w (N) of length l (N). If l (N) < r\u0302 we complete w (N) to the length r\u0302 adding\nseveral symbols \u221e and assuming that \u221e > n for n = 1, 2, . . .. After that we order \u0001words\nw (N) in the lexicographic order. We obtain the ordered list w1 (N1 ) , . . . , w\u03bd(T ) N\u03bd(T ) . We\ntake this ordering and labeling of the end nodes N1 , . . . , N\u03bd(T ) as a standard ordering and\ndenote by o0 (N) the consecutive number with respect to this labeling: j = o0 (Nj ). To label\nthe nodes with rank r we delete all the nodes of rank less than r together with the incoming\nedges and nodes of rank r become end nodes. We apply to them the described labeling\nand denote the indexes obtained by or (N). Hence, every node N of the tree T has two\ninteger numbers assigned: r (N) and or(N ) (N). We introduce the standard\n\u0001 labeling of all\nnodes of T by applying the lexicographic ordering to pairs r (N) , or(N ) (N) , and denote the\ncorresponding number o (N), 1 \u2264 o (N) \u2264 m (T ) + i (T ).\nThe following statement follows straightforwardly from the definition of the standard\nordering.\nProposition 4.14 If a tree T has a subtree T \u2032 and the standard labeling of end nodes is\nused, then all the end nodes of the subtree T \u2032 fill an interval j1 \u2264 o0 (N) \u2264 j2 for some j1\nand j2 .\nTheorem 4.15 Let T2 be the set of ordered trees such that each node of a tree which is\nnot \ban end node has at least two children nodes. The set of composition monomials based\non F (s) , s = 2, 3, . . . is in one-to-one correspondence with the set T2 . The correspondence\nhas the following properties. The monomials of rank r correspond to trees of rank r. The\nroot node of the tree T corresponds to the root operator of the composition monomial. The\nend nodes correspond to variables uj , j = 1, . . . , \u03bd (T ). The standard labeling of end nodes\ncoincides with the consecutive labeling of the variables uj of monomial from left to right. The\nhomogeneity index of a monomial equals the homogeneity index of the corresponding tree.\nThe incidence number of a monomial equals the incidence number of a tree, and the rank of\na monomial equals the rank of a tree.\n\b\nProof. For a given F (s) the set of monomials with rank r is finite, the set of trees\nwith rank r is finite too. Therefore, to prove one-to-one correspondence of the two sets it is\n40\n\n\fsufficient to construct two one-to-one mappings from the first set into the second and from\nthe second into the first. First of all, using the induction with respect to r we construct for\nevery monomial the corresponding tree. Let r = 0. A monomial of rank 0 has the form u1 ,\nand it corresponds to a tree involving one node. The tree has no edges and the node is the\nboth the root and the end node; its incidence number is zero and homogeneity power is one.\nAssume now that we have defined a tree for any monomial of rank not greater than r \u2212 1. A\nmonomial of rank r has the form F (m) (M1 . . . Mm ) where monomials M1 . . . Mm have rank\nnot greater than r \u2212 1. Every monomial M1 . . . Mm corresponds to an ordered tree T1 , . . . , Tm\nwith the root nodes N\u22171 , . . . N\u2217m . We form the tree T as a union of the nodes of T1 , . . . , Tm\nand add one more node N\u2217 which corresponds to the root operator F (m) and it becomes\nthe root node of T . We take the union of edges from T1 , . . . , Tm and add m more edges\nconnecting N\u2217 with the nodes N\u22171 , . . . N\u2217m , the order of the nodes corresponds to ordering of\nM1 . . . Mm from left to right. The first mapping is constructed.\nNow let us define for every ordered tree T the corresponding monomial M (F , T ). If we\nhave a tree T of rank zero we set M (F , T ) = uj and j = 1 if we use the standard labeling.\nNow we do induction step from r \u2212 1 to r. If we have a tree of rank r we take the root node\nN\u2217 and its children N\u22171 , . . . , N\u2217s , s = \u03bc (N\u2217 ). The subtrees T \u2032 (N\u22171 ),..., T \u2032 (N\u2217s ) have rank not\ngreater than r \u22121 and the monomials M (F , T \u2032 (N\u22171 )) ,..., M (F , T \u2032 (N\u2217s )) are defined according to induction assumption, let m (T \u2032 (N\u22171 )),...,m (T \u2032 (N\u2217s )) be their homogeneity indices.\nWe set m (T ) = m (T \u2032 (N\u22171 )) +...+m (T \u2032 (N\u2217s )). We denote the variables of every monomial\nM (F , T \u2032 (N\u2217j )) by uj,1 , . . . , uj,m(T \u2032 (N\u2217j )) counting from left to right, and then labeling all the\nvariables uj,l using the lexicographic ordering of pairs j, l we obtain variables u1 , . . . , um(T )\nand monomials\n\u0001\nM (F , T \u2032 (N\u22171 )) u1 , . . . , um(T \u2032 (N\u22171 )) , M (F , T \u2032 (N\u22172 )) (um1 +1 , . . . , um1 +m2 ) ,\netc., where mj = m (T \u2032 (N\u2217j )). After that we set\n\nF (s)\n\n\u0001\nM (F , T ) u1 , . . . , um(T ) =\n\u0001\n\u0001\u0001\nM (F , T \u2032 (N\u22171 )) u1 , . . . , um(T \u2032 (N\u22171 )) , . . . , M (F , T \u2032 (N\u2217s )) um(T )\u2212ms\u22121 +1 , . . . , um(T ) .\n\nNote that the homogeneity index for the monomial M equals the sum of the indices for\nsubmonomials M1 . . . Mm , the homogeneity index for the tree T equals the sum of the indices\nfor subtrees T1 , . . . , Tm , this implies their equality by induction. The incidence number for\nthe monomial M equals the sum of the numbers for submonomials M1 . . . Mm plus one; the\nincidence number for the tree T equals the sum of the numbers for submonomials T1 , . . . , Tm\nplus one. Therefore, these quantities for monomials and trees are equal by induction.\nInduction is completed. Therefore we constructed the two mappings, one can easily check\nthat they are one-to-one and have all required properties.\nDefinition 4.16 (monomial to a tree) For a tree T \u2208 T2 we denote by M (F , T ) the\nmonomial which is constructed in Theorem 4.15.\n\n41\n\n\fConclusion 4.17 The above construction shows that the structure of every composition\nmonomial is completely described by an (ordered) tree T with nodes Ni corresponding to\nthe operators F (mi ) . At such a node Ni (i) the number mi of outcoming edges equals the\nhomogeneity index of F (mi ) ; (ii) the outcoming edges are in one-to-one correspondence with\nthe arguments of F (mi ) , and the ordering of the child nodes coincides with the ordering of\narguments of F (mi ) from left to right. The value of mi may be different for different nodes.\nA node corresponding to F (m) is connected by edges with m child nodes corresponding to the\narguments of F (m) . Every node N of the tree T can be taken as a root node of a subtree\nT \u2032 (N) which correspond to a submonomial M (F , T \u2032 (N)). Conversely, every submonomial\nof M (F , T ) equals M (F , T \u2032 (N)) for some mode N. If m > 1 the submonomial has a\nnonzero rank. The number of non-end nodes equals to the number of symbols F (m) used in\nF -represenation of the monomial which is the incidence number of the monomial. The total\nnumber of end nodes of an m-homogenious operator equals to m = \u03bd (T ). The rank of a node\nN equals the rank of the corresponding submonomial M (F , T \u2032 (N)). The arguments u1 , . . . us\nof a monomial correspond to the end nodes of the tree. The standard labeling of nodes of\nT agrees with the standard labeling (from left to right) of the arguments of the composition\nmonomial M (F , T ). The number of end nodes of the tree T equals the homogeneity index of\ncorresponding monomial. If the root mode of the tree T of a monomial M has \u03bc (N\u2217 ) = m\nedges which are connected to child nodes N1 , . . . Nm then there is a node F (mj ) , j = 1, . . . , n\nat the end of every edge such that M has the form\n\u0001\nF (m) F (\u03bc(N1 )) (. . .) , . . . , F (\u03bc(Nm )) (. . .) .\n(4.23)\n\nExample 4.18 The tree corresponding to F (3) (u1 u2 F (u1 u2 u3 )) has two nodes of non-zero\nrank, the root node of rank 2, one non-end node of rank 1 and five end nodes of rank 0.\nAnother example, the monomial (4.22) has the root node corresponding to F (4) , four edges\nlead respectively to nodes corresponding to the end nodes with u1 , u2 , u3 and to the non-end\nnode with F (3) , see Fig. 2.\n\b\n\u221e\nRemark 4.19 Since all operators in the set F (s) s=2 in (4.18) have the homogeneity index\nat least two, the trees of monomials generated by recurrent relations (4.18) have a special\nproperty: every non-end mode has at least two children.\nSometimes it is convenient to use monomials involving several types of operators. To\ndescribe such a situation we introduce for a given tree a decorated monomial.\nDefinition 4.20 (decorated monomial of a tree) Assume that we have several formal\nP\n(m)\nseries {F1 , . . . , Fl } where Fi is represented by a formal series Fl = m Fi , i = 1, . . . , l.\nWe call the set {F } = {Fj , j = 1, . . . , S} the operator alphabet, and j is called the decoration index. We consider a function \u0393 (N), N \u2208 T , defined on the nodes of the tree T and\ntaking values in the set {1, . . . , l} of the decoration indices, and call such a function a decoration function on the tree T . Then for a decoration function \u0393 (N) we define the decorated\n42\n\n\fFigure 2: In this picture a tree corresponding to a monomial is drawn.\n(m)\n\nmonomial M ({F } , \u0393, T ) of the tree T by picking operators Fj with j defined by \u0393. For\n(m)\nevery node N the homogeneity index m = \u03bc (N) of the operator Fj equals to the number\nof children of N and j is defined by \u0393, namely Fj , j = \u0393 (N).\nHence, a decorated monomial M ({F } , \u0393, T ) has instead of (4.23) the following form\n\u0010\n\u0011\n(m)\n(\u03bc(N1 ))\n(\u03bc(Nm ))\nF\u0393(N ) F\u0393(N1 ) (. . .) , . . . , F\u0393(Nm ) (. . .) .\n(4.24)\n(m)\n\nWhen Fi are multilinear operators, a monomial M ({F } , T, \u0393) is also a multilinear operator, its homogeneity index m equals \u03bd (T ) and we denote its arguments by (x1 . . . xm ).\nRespectively, if x1 . . . x\u03bd are arguments of a monomial M ({F } , T, \u0393) and we use the standard labeling of the nodes then according to Proposition 4.14 a submonomial M ({F } , T, \u0393)\nhas arguments x\u03ba(T \u2032 ) , . . . , x\u03ba(T \u2032 )+\u03bd(T \u2032 )\u22121 which are labeled constructively.\nNow we would like to describe elementary properties of composition monomials and the\nrelated trees. Note that for every N \u2208 T a composition monomial is a linear function of\n\u03bc(N )\noperator F\u0393(N ) . Consequently, the concept of the decorated composition monomial can be\nnaturally extended to monomials associated with the following family of operators\n{F } = {F : F = c1 F1 + . . . + cl Fl , ci \u2208 C} .\nFor a given tree T the submonomial M ({F } , \u0393, T ) is represented as a function on the tree\nT with values in {F }, this is an i-linear function of F where i is the incidence number of T .\n43\n\n\fThere are elementary relations between the incidence number i (T ), the rank r (T ), the\nnumber of edges of a tree T which do not end at an end node e0 (T ) and the homogeneity index\nm of a tree T , and corresponding monomial M ({F } , \u0393, T ). For example, e0 (T ) = i (T ) \u2212 1.\nSome useful relations expressed by inequalities are given in the following lemma.\nLemma 4.21 Let us consider trees T for which every non-end node has at least two children,\n\u03bc (N) \u2265 2 for all N \u2208 T . Let for any i the number m (i) be the minimum number of the end\nnodes \u03bd (T ) for all trees T with given incidence number i. Then\nm (i) \u2265 i + 1.\n\n(4.25)\n\nSimilarly for any given r let m (r) be the minimum number of end nodes with given rank r.\nThen\nm (r) \u2265 r + 1.\n(4.26)\n\nLet e0 (T ) be the number of edges of a tree T which do not end at end nodes. For any given\ne let m (e) be the minimum number of end nodes with e0 (T ) = e. Then\n\u0001\nm e0 > e0 + 1.\n(4.27)\n\nProof. For i = 1 (4.25) is true. Let the statement be true for i = i0 . Let T be a tree with\nthe minimum number of end nodes m (i0 ) = m. We delete one of the end nodes together\nwith the edge leading to it from its parent obtaining a tree with m (i0 ) \u2212 1 end node. If the\ntree remains in the same class, then m (i0 ) is reduced by one contradicting the minimality.\nHence, the deletion of the edge created a node with only one child. Such a node can be\nreplaced by an edge leading from its parent to its child and reducing the incidence number\nby one. Using the induction assumption we get\nm (i0 ) \u2212 1 \u2265 m (i0 \u2212 1) \u2265 (i0 \u2212 1) + 1\n\n(4.28)\n\nthat completes the induction and proves (4.25) for all i. Similar induction proves (4.26). For\nr = 1 (4.26) is true. Let T be a tree with the minimum number of end nodes m (r0 ) = m.\nAs above, by deleting an end node and using the minimality we reduce the tree T to a tree\nT \u2032 with a smaller rank. Since only one non-end node is eliminated, the rank of T \u2032 is r0 \u2212 1\nand we get (4.26). Inequality (4.27) holds for e = 0 since m (0) \u2265 2. Let T be a tree with the\nminimum number of end nodes m (e0 ) = m. We again delete one of the end nodes together\nwith the edge joining it to its parent and obtain a tree with m (e0 ) \u2212 1 end nodes and the\nsame number of edges which do not end at an end node. The minimality implies that the\nparent node has only one another child and removing it we get either e0 or e0 \u2212 1 edges which\ndo not go to end nodes. We use the induction as in (4.28) obtaining (4.27).\nMonomial expansion in the Implicit Function Theorem If operators G m (x1 . . . xm )\nare determined by the recurrent formulas (4.18) it is obvious that every G m can be represented\n44\n\n\f\b\nin terms of F = F (s) using the recurrence and multilinearity of F (s) . More precisely the\nfollowing representation holds\nX\ncT M (F , T ) (x1 . . . xm ) ,\n(4.29)\nG (m) (F , x1 . . . xm ) =\nT \u2208Tm\n\nwhere (i) M (F , T ) \u2208 T2 is a composition monomial corresponding to a tree T and Tm \u2282 T2\nstands for the set of trees with m end nodes; (ii) the integer-valued multiplicity coefficient\ncT \u2265 0 counts the multiplicity of the related monomial M (F , T ) in the expansion of (4.18);\nfor some trees T its multiplicity coefficient cT may be zero. The expansion (4.29) is obtained\nm\n(ij )\nby an inductive process with respect to m since (4.18)\nwith\n\b (s) expresses G in terms of G\n2 \u2264 ij < m. Notice that for a given operator F = F\nthe monomial M (F , T ) considered\nas an operator can be the same for different T , the monomials and the multiplicity coefficients\nare determined purely algebraically.\nRemark 4.22 The expression (4.29) for G (m) as a linear combination of composition monomials M (F , T ), in particular the multiplicity coefficients cT , does not depend on a specific\nform of the operator F . It is the same for a solution z = x + G (F , x) of the general functional equation (4.1) and for an elementary algebraic equation u = F (u) + x with u, x \u2208 C\nand with a scalar analytic function F of one complex variable.\n(m)\n\nIf all Fi are bounded multilinear operators then a decorated monomial M (F , T, \u0393) is\nalso a bounded multilinear operator as it follows from the following statement.\nLemma 4.23 Let M ({F } , T, \u0393) be a decorated monomial of the homogeneity index \u03bd (T ) =\n(s)\nm and all Fi be bounded operators from E s into E for a Banach space E. Then the following\nestimate holds\nm\nY\nY\n(\u03bc(N ))\nF\u0393(N )\nkM ({F } , T, \u0393) (x1 . . . xm )kE \u2264\nkxj kE .\n(4.30)\nN \u2208T ,r(N )>0\n\nj=1\n\nProof. Notice that\nF (m) (M1 . . . Mm )\n\nE\n\n\u2264 F (m) kM1 kE . . . kMm kE\n\n(4.31)\n\nwhere Mj are submonomials. Applying the above inequality repeatedly we obtain (4.30).\nThe next statement provides a bound for the norm of a decorated monomial which involves\nas a factor the norm of a submonomial.\nLemma 4.24 . Let M ({F } , T, \u0393) be a decorated monomial evaluated at x1 . . . xm . Let\nall F (s) be bounded operators from E s into Banach space E. Then for every evaluated\nsubmonomial M ({F } , T \u2032 (N0 ) , \u0393) we have an estimate\n\u0001\nkM ({F } , T, \u0393) (x1 . . . xm )kE \u2264 M ({F } , T \u2032 (N0 ) , \u0393) x\u03ba , . . . , x\u03ba+\u03bd(T \u2032 (N ))\u22121 E\n(4.32)\nY\nY\nY\n(\u03bc(N ))\nF\u0393(N )\nkxj k\nkxj k .\nN \u2208T \\T \u2032 (N0 ),r(N )>0\n\nwhere x\u03ba , . . . , x\u03ba\n\n+\u03bd(T \u2032 (N ))\u22121\n\nj<\u03ba\n\nj\u2265\u03ba+\u03bd(T \u2032 (N0 ))\n\nare the arguments of the submonomial M ({F } , T \u2032 (N0 ) , \u0393).\n45\n\n\fProof. The proof uses the induction with respect to the length l (N0 ). For l (N0 ) = 0\nthe statement is obvious. Assuming that the statement is true for l (N) < l0 we consider\nthe case when l (N0 ) = l0 . Notice that\n(\u03bc(N ))\n\nF\u0393(N\u2217 )\u2217\n\nM1 . . . M\u03bc(N )\n\n\u0001\n\n(\u03bc(N ))\n\nE\n\n\u2264 F\u0393(N\u2217 )\u2217\n\nkM1 kE . . . M\u03bc(N )\n\nE\n\n,\n\nwhere Mj = M ({F } , T \u2032 (N\u2217j ) , \u0393), N\u2217j are child nodes of N\u2217 . One of the submonomials\nM1 . . . M\u03bc(N ) contains M ({F } , T \u2032 (N0 ) , \u0393) as a submonomial, and let it be M ({F } , T \u2032 (N\u2217j0 ) , \u0393).\nThe length of the path from N0 to N\u2217j is less than l0 and we can use the induction hypothesis\nto estimate the norm of M ({F } , T \u2032 (N\u2217j0 ) , \u0393). The norms of Mj with j 6= j0 are estimated\nusing (4.30). The labels of the arguments of the submonomial fill an interval according to\nProposition 4.14.\nThe following theorem gives a needed refinement of the Implicit Function Theorem 4.7.\nTheorem 4.25 (refined Implicit Function Theorem) Let F \u2208 A (CF , RF ). Let G \u2208\nA (CG , RG ) be the analytic solution operator constructed in Theorem 4.7 which solves (4.1).\nThen the expansion of G (F , x) into composition monomials\nG (F , x) =\n\n\u221e X\nX\n\ncT M (F , T ) (xm )\n\n(4.33)\n\nm=1 T \u2208Tm\n\nconverges for kxk < RG , and the following estimates hold\nX\ncT kM (F , T ) (xm )k \u2264 CG RG\u2212m kxkm , m = 2, . . . ,\n\n(4.34)\n\nT \u2208Tm\n\n\u221e X\nX\n\nm=2 T \u2208Tm\n\ncT kM (F , T ) (xm )k \u2264 CG\n\nkxk2X RG\u22122\n,\n1 \u2212 kxkX RG\u22121\n\nwhere CG and RG depend only on CF and RF and satisfy\nCG =\n\nRF2\nRF2\n, RG =\n.\n2 (CF + RF )\n4 (CF + RF )\n\nThe multiplicity coefficients cT \u2265 0 satisfy the inequality\nX\n\nT \u2208Tm\n\n1\ncT \u2264 8 m .\n4\n\nThe proof of this statement is given in Appendix B.\n\n46\n\n(4.35)\n\n\f4.3\n\nDecorated expansions\n\nIn this section we develop a formalism for treating linear operators with several invariant\nsubspaces which span the entire space as, for example, in the case of projections (2.19).\nThe decomposition into related invariant subspaces is very important for the analysis. The\ngeneral setting is as follows. Suppose that a Banach space E has several projection operators\n\u03a0\u03bb , \u03bb \u2208 \u039b, where \u039b is a finite set of indices, we call this set decoration set. We assume that\nthe sum of the projections equals the identical operator, i.e.\nX\n\u03a0\u03bb = Id, where Id is the identity operator,\n(4.36)\n\u03bb\u2208\u039b\n\nand\n\u03a0\u03bb \u03a0\u03bb = \u03a0\u03bb , \u03a0\u03bb\u2032 \u03a0\u03bb = 0 if \u03bb\u2032 6= \u03bb, \u03bb\u2032 , \u03bb \u2208 \u039b.\n\n(4.37)\n\nWe call such projections decoration projections. For example, let us look at projections\n\u03a0n,\u03b6 (k), n = 1, . . . , J, \u03b6 = \u00b1 defined by (2.19). These projections define bounded operators\n\u03a0n,\u03b6 acting on (i) functions of k in the space L1 ; (ii) functions of k, \u03c4 in the space E =\nC ([0, \u03c4 \u2217 ] , L1 ). In another example based on (2.19) we fix n0 and define\nX\n\u03a0n,\u03b6 (k) .\n(4.38)\n\u03a0\u03b6 (k) = \u03a0n0 ,\u03b6 (k) , \u03b6 = \u00b1, \u03a0\u221e (k) =\nn6=n0 ,\u03b6=\u00b1\n\nUsing (4.36) we expand vectors x \u2208 E as follows\nX\nX\nx=\n\u03a0\u03bb x =\nx\u03bb , x\u03bb = \u03a0\u03bb (x) .\n\u03bb\u2208\u039b\n\nWe also use notation\n\n(4.39)\n\n\u03bb\u2208\u039b\n\n(n)\n\nF\u03bb = \u03a0\u03bb F (n)\n\n(4.40)\n\nOften in applications the number of elements in \u039b is either 2 or 3. In the case when \u039b has\nthree elements we set\n\u039b = {+, \u2212, \u221e} , \u03a0+ + \u03a0\u2212 + \u03a0\u221e = Id,\n(4.41)\n\nand\n\nx = x+ + x\u2212 + x\u221e , F (x) = F+ (x) + F\u2212 (x) + F\u221e (x) .\n\n(4.42)\n\n(n)\n\nUsing the decomposition (4.36) we introduce for m-linear operators F (x1 . . . xn ) the cor(n)\nresponding decorated operators F\u03bb,~\u03b6 as follows:\n\u0010\n\u0011\n\u0010\n\u0011\n(n)\n(n)\nF\u03bb,~\u03b6 (x1 . . . xn ) = \u03a0\u03bb F (n) \u03a0\u03b6 \u2032 x1 . . . \u03a0\u03b6 (n) xn = F\u03bb \u03a0\u03b6 \u2032 x1 . . . \u03a0\u03b6 (n) xn ,\n(4.43)\n\nwhere ~\u03b6 is defined in (3.7). Obviously, we have\nX\nF (n) (x1 . . . xn ) =\n\n\u03bb\u2208\u039b, ~\u03b6\u2208\u039bn\n\nAn example of expansion (4.44) is given by (3.11).\n47\n\n(n)\n\nF\u03bb,~\u03b6 (x1 . . . xn ) .\n\n(4.44)\n\n\f4.4\n\nDecorated composition monomials\n\nWe assume that operators F (n) act in the space allowing a decomposition into three components as in (4.41). Let M (F , T ) be a composition monomial of the homogeneity index\nm, and assume that the corresponding tree T has the incidence number i, the rank r, and e\nedges. Suppose also that every operator F (n) is expanded into a sum of decorated operators\nas in (4.44) , (4.43). Using the linearity of M (F , T ) with respect to operators F (n) we get\n\u0001\nM (F , T ) = F (n) F (m1 ) (. . .) . . . F (mn ) (. . .) =\n(4.45)\n\u0012\n\u0013\nX\n(m )\n(n)\n(m )\nF\u03bb 1,~\u03b6 (. . .) . . . F\u03bb n,~\u03b6 (. . .) ,\nF\u03bb\nj1\n\n\u03bb\u2208\u039b, ~\n\u03bb\u2208\u039bi\u22121 , ~\u03b6 j , j=1,...,e\n(m )\n\njn\n\nj1\n\njn\n\n(m )\n\nwhere submonomials F\u03bb ,~\u03b61 (. . .),...,F\u03bb ,n~\u03b6 (. . .) have ranks not exceeding r \u2212 1. We expanded\nn n\n1 1\nrepeatedly the expression in the left-hand side of (4.45) as long as submonomials of non-zero\n(n)\nrank were present resulting in an expansion involving only decorated operators F\u03bb,~\u03b6 .\nRemark 4.26 Note that\n\u0010\n\u0010\n\u0011\n\u0011\n(m1 )\n(m1 )\n(mn )\n(n)\n(mn )\n(n)\nF\u03bb F\u03bb ,~\u03b6 (. . .) . . . F\u03bb ,~\u03b6 (. . .) = F\u03bb \u03a0\u03bb1 F\u03bb ,~\u03b6 (. . .) . . . \u03a0\u03bbn F\u03bb ,~\u03b6 (. . .)\n1\n\nn\n\n1\n\n1\n\nn\n\n1\n\nn\n\n(4.46)\n\nn\n\n\u0011\n\u0010\nSince projections \u03a0\u03b6 satisfy the identities (4.37) if a vector ~\u03b6 = \u03b6 \u2032 , . . . , \u03b6 (n) and indices\n\u03bb1 , . . . , \u03bbn are given, then we have the identity\n\u0010\n\u0011\n(n)\n(m1 )\n(mn )\nF\u03bb,~\u03b6 F\u03bb ,~\u03b6 . . . F\u03bb ,~\u03b6 = 0 when \u03bbi =\n6 \u03b6 (i) for some i.\n(4.47)\n1\n\n1\n\nn\n\nn\n\n(m )\n\n(m )\n\nHence, for non-zero terms in the expansion (4.45) if indices \u03bb1 , . . . , \u03bbn for F\u03bb ,~\u03b61 ,...,F\u03bb ,~n\u03b6\nn n\n1 1\n(n)\nare given the vector ~\u03b6 in F is determined by them\n\u03bb,~\u03b6\n\n\u03b6 (i) = \u03bbi , i = 1, . . . , n.\nNote that according to (4.47) and (4.48) we have\n\u0010\n\u0011\n\u0001\n(m )\n(m )\n(n)\n(n)\nF\u03bb,~\u03bb F (m1 ) (. . .) . . . F (mn ) (. . .) = F\u03bb F\u03bb1 1 (. . .) . . . F\u03bbn n (. . .) .\n\n(4.48)\n\n(4.49)\n\nAccording to (4.45), (4.49) for every tree T of the homogeneity index m and the incidence\nnumber i, we get an expansion into a sum of monomials of the form\n\u0010\n\u0011\nM F , T, ~\u03bb, ~\u03b6 (x1 x2 . . . xm ) = M ({F } , \u0393, T ) (x1 x2 . . . xm ) ,\n(4.50)\no\nn\n(n)\n{F } = F\u03bb,~\u03b6 : \u03bb \u2208 \u039b, ~\u03b6 \u2208 \u039bn , n = 2, 3, . . . .\n48\n\n\fNamely, if a monomial M (F , T ) has at a node N operator F (m(N )) then M ({F } , \u0393, T ) at\n(m(N ))\nthis node has operator F\u0393(N ) . We call a composition monomial of the form (4.50), where\n(4.48) is assumed, a decorated composition monomial. Using the standard labeling of nodes,\nfor a given function \u0393 on the tree T with values in \u039b we find the vectors ~\u03bb \u2208 \u039bi , ~\u03b6 \u2208 \u039bm ,\nwith i being the incidence number of the tree T , and using (4.48) we rewrite (4.45) in the\nform\n\u0010\n\u0011\nX\nM (F , T ) (x1 x2 . . . xm ) =\nM F , T, ~\u03bb, ~\u03b6 (x1 x2 . . . xm ) .\n(4.51)\n~\n\u03bb\u2208\u039bi , ~\u03b6\u2208\u039bm\n\nwhere ~\u03b6 is determined by values of \u0393 on the end nodes. The sum (4.51) contains at most\n3i+m non-zero terms, where 3 is the number of elements in \u039b. Combining (4.51) with (4.33)\nwe obtain\n\u0010\n\u0011\nX\nX\ncT M F , T, ~\u03bb, ~\u03b6 (xm ) .\n(4.52)\nG (m) (xm ) =\nT \u2208Tm ~\n\u03bb\u2208\u039bi(T ) , ~\u03b6\u2208\u039bm\n\n5\n\nExpansions of solutions for oscillatory integral equation\n\nIn this section we apply general concepts introduced in previous sections to oscillatory integrals involving operators F as in (3.3), (3.4). Based on projections \u03a0n,\u03b6 (k) in (2.19) for\ngiven n = n0 we define as in (4.38) decoration projections in L1 which satisfy (4.41):\nXX\n\u03a0n,\u03b6 .\n(5.1)\n\u03a0\u03b6 \u0169 (k) = \u03a0n0 ,\u03b6 (k) \u0169 (k) , \u03b6 = \u00b1, \u03a0\u221e =\nn6=n0 \u03b6=\u00b1\n\n5.1\n\nBoundedness of oscillatory integral operators\n\nIn this subsection we estimate norms of multilinear operators F = F (m) defined by (3.4)\nand the related composition monomials. The operators F (m) have the form (3.4) where\nDm = Rd(m\u22121) as in (2.65) or Dm = [\u2212\u03c0, \u03c0]d(m\u22121) as in (2.23). The\nare completely\n\u0011\n\u0010 both cases\n\u0001\nd\nor L1 = L1 Rd ,\nsimilar since we use the same properties of the spaces L1 = L1 [\u2212\u03c0, \u03c0]\n\nand we do not use in our proofs the boundedness and compactness of the domain [\u2212\u03c0, \u03c0]d .\nHence, we will everywhere consider the periodic case [\u2212\u03c0, \u03c0]d which corresponds to lattice\nequations and without further comment apply the results to the case Rd .\nLemma 5.1 The operator F (m) defined by (3.4), (2.22) is bounded from E = C ([0, \u03c4 \u2217 ] , L1 )\ninto C 1 ([0, \u03c4 \u2217 ] , L1 ) and its norm is estimated as follows\nF\n\n(m)\n\n(\u01691 . . . \u0169m )\n\nE\n\n\u2202\u03c4 F (m) (\u01691 . . . \u0169m )\n\n\u2264\nE\n\n\u03c4 \u2217 C\u039e2m+1\n\n(m)\n\n\u03c7\n\nm\nY\nj=1\n\n\u2264 C\u039e2m+1 \u03c7(m)\n49\n\nY\nj\n\nk\u0169j kE ,\n\n(5.2)\n\nk\u0169j kE .\n\n(5.3)\n\n\fn\no\nProof. According to Condition 2.5 we can diagonalize the matrix exp \u2212iL (k) \u03c4\u033a1 and\nits norm is bounded uniformly in k, \u03c4 1 and \u033a:\n\u001a\n\u001b\n\u03c41\nexp \u2212iL (k)\n\u2264 C\u039e2 \u2200k \u2208 Rd , \u033a > 0, \u03c4 1 \u2265 0.\n(5.4)\n\u033a\nBy (3.4), (3.5) and (2.22)\nF\n\nC\u039e2m+1\n\n(m)\n\n\u03c7\n\n(m)\n\nZ\n\n(\u01691 . . . \u0169m ) (*, \u03c4 )\n\nL1\n\n\u0010\n\n\u2264\n\nC\u039e2m+1\n\n\u0010\n\n|\u01691 (k\u2032 )| . . . \u0169m k(m) k, ~k\n\n0\n\n\u03c4\n\n\u0011\u0011\n\n(m)\n\nsup \u03c7\nk,~k\n\n\u0010\n\nk, ~k\n\n\u0011 Z Z\n\n\u03c4\n0\n\nZ\n\nDm\n\ndk\u2032 . . . dk(m\u22121) d\u03c4 1 dk \u2264\n\nk\u01691 (\u03c4 1 )kL1 . . . k\u0169m (\u03c4 1 )kL1 d\u03c4 1 \u2264 \u03c4 \u2217 C\u039e2m+1 \u03c7(m) k\u01691 kE . . . k\u0169m kE .\n\nSimilarly,\n\nC\u039e2m+1 \u03c7(m)\n\nZ Z\n\nDm\n\n\u2202\u03c4 F (m) (\u01691 . . . \u0169m ) (*, \u03c4 ) L1 \u2264\n\u0010\n\u0010\n\u0011\u0011\ndk\u2032 . . . dk(m\u22121) dk \u2264\n|\u01691 (k\u2032 )| . . . \u0169m k(m) k, ~k\n\u03c7(m) k\u01691 kE . . . k\u0169m kE .\n\n\u0010\n\n\u0011\n~\n~\nCorollary 5.2 If M F , T, \u03bb, \u03b6 (x1 . . . xm ) is a decorated composition monomial defined\nby (4.18) and F is defined by (3.3), (3.4) then\n\u0010\n\n\u0011\n~\n~\nM F , T, \u03bb, \u03b6 (x1 . . . xm )\n\u0010\n\n\u0011\n~\n~\n\u2202\u03c4 M F , T, \u03bb, \u03b6 (x1 . . . xm )\n\nE\n\nE\n\nY\n\n\u2264\n\nC\u039e2e+i \u03c4 i\u2217\n\n\u2264\n\nC\u039e2e+i \u03c4 i\u22121\n\u2217\n\n(\u03bc(N ))\n\n\u03c7\n\nN \u2208T\n\nY\n\nN \u2208T\n\nm\nY\nl=1\n\n(\u03bc(N ))\n\n\u03c7\n\nkxl kE ,\n\nm\nY\nl=1\n\nkxl kE ,\n\n(5.5)\n\n(5.6)\n\nwhere i is the incidence number of the tree T , and e is the number of edges of T .\nProof. We estimate the norm of the monomial M = F (m) (M1 . . . Mm ) and its time\nderivative applying Lemma 5.1. Then we use (5.2) to estimate kMj kC([0,\u03c4 \u2217 ],L1 ) . The formal\nproof is straightforward and uses the induction with respect to the incidence number of a\nmonomial.\nUsing boundedness of operators F (m) we obtain in a standard way uniqueness of solution\nof (3.3).\nLemma 5.3 If \u01691 , \u01692 \u2208 C ([0, \u03c4 0 ] , L1 ) with \u03c4 0 > 0 are two solutions of (3.3) with the\nsame h\u0303 then \u01691 = \u01692 .\n50\n\n\fProof. Applying Lemma 4.6, we conclude that\nkF (\u01691 ) \u2212 F (\u01692 )kC([0,\u03c4 1 ],L1 ) \u2264 C\u03c4 1 kF (\u01691 ) \u2212 F (\u01692 )kC([0,\u03c4 1 ],L1 ) , 0 < \u03c4 1 \u2264 \u03c4 0 .\nDeriving the above inequality we use that since NF < \u221e the radius RF in Lemma 4.6 is\narbitrary large and CF in (4.13) according to (5.2) is proportional to \u03c4 1 . When the Lipschitz\nconstant C\u03c4 1 < 1, in a standard way we obtain that \u01691 (\u03c4 ) = \u01692 (\u03c4 ) for 0 \u2264 \u03c4 \u2264 \u03c4 1 . Since\nthis statement can be applied to \u01691 (\u03c4 \u2212 \u03c4 1 ) and \u01692 (\u03c4 \u2212 \u03c4 1 ) we obtain that solutions coincide\nfor 0 \u2264 \u03c4 \u2264 \u03c4 0 .\n\n5.2\n\nFunction-analytic expansion of solutions for modal integral\nevolution equation\n\nThe reduced evolution equation (3.3) has the form\n\u0169 = F (\u0169) + x\u0303,\n\n(5.7)\n\nwhere \u0169, x\u0303 are functions of (k, \u03c4 ). The nonlinear operator F in the right-hand side of (5.7)\nis determined by (3.4), x\u0303 (k, \u03c4 ) = h\u0303 (k) as in (3.3). We look for the solution operator G in\nthe form of operator series\n\u0169 = G (x\u0303) =\n\n\u221e\nX\n\nm=1\n\n\u0001\nG (m) x\u0303(m) .\n\n(5.8)\n\nThe questions related to the existence and the convergence of such series are addressed in\nTheorem 4.7. As a direct corollary of Theorem 4.7 and Lemma 5.3 if applied to the reduced\nevolution equation (3.3) we obtain the following theorem.\nTheorem 5.4 Let\nkx\u0303kE < RG = \u03c4 \u2217 C\u03c7 C\u039e2mF +1\n\n\u0001\u22121/(mF \u22121)\n\n/8, \u03c4 \u2217 \u2264 C\u039e\u22123 C\u03c7\u22121 .\n\n(5.9)\n\nwith C\u03c7 as in (2.26), C\u039e as in (2.17). Then the series (5.8) converges in E = C ([0, \u03c4 \u2217 ] , L1 ).\nThe solution operator G (x\u0303) = \u0169 determines the solution to (5.7) and the operators G (m) in\nseries (5.8) satisfy the recursive relations (4.18).\nProof. \u00bfFrom (2.26) and (5.2) we infer that F defined by (2.21) belongs to the class\nA (CF , RF ) if\n\u03c4 \u2217 C\u03c7 C\u039e2m+1 \u2264 CF RF\u2212m , m = 2, . . . , mF .\nIf C\u039e\u22122 RF\u22121 \u2264 1 it is sufficient to verify the above condition at m = mF only. After this we\napply Theorem 4.7 where according to (4.19) we can take\nRF2\nRF2\nCG =\n, RG =\n.\n2 (CF + RF )\n4 (CF + RF )\n51\n\n(5.10)\n\n\fWe take\nCF = RF = \u03c4 \u2217 C\u03c7 C\u039e2mF +1\n\n\u0001\u22121/(mF \u22121)\n\n, CG = 2RG = RF /4\n\n(5.11)\n\nand apply Theorem 4.7. Note that C\u039e\u22122 RF\u22121 \u2264 1 if \u03c4 \u2217 \u2264 C\u039e\u22123 C\u03c7\u22121 .\n\u00bfFrom Theorem 5.4 (observing that by (5.11) RF \u2192 \u221e when \u03c4 \u2217 \u2192 0) we obtain Theorems\n2.8 and Theorem 2.18.\nTo prove Theorem 2.15 on the superposition principle we apply the solution operator G to\na sum of wavepackets h\u0303l (k, \u03b2) as in Definition 2.9. For technical reasons we have to modify\nthe wavepackets using cut-off functions described below.\nCutoff functions. We often use an infinitely smooth cutoff function \u03a8 (\u03b7), \u03b7 \u2208 Rd , satisfying the following relations\n0 \u2264 \u03a8 (\u03b7) \u2264 1, \u03a8 (\u2212\u03b7) = \u03a8 (\u03b7) ,\n\u03a8 (\u03b7) = 1 for |\u03b7| \u2264 \u03c0 0 /2, \u03a8 (\u03b7) = 0 for |\u03b7| \u2265 \u03c0 0 ,\n\n(5.12)\n\nwhere \u03c0 0 \u2264 1 is a sufficiently small number which satisfies the inequality\n0 < \u03c00 <\n\n1\nmin dist {k\u2217l , \u03c3} .\n2 l\n\n(5.13)\n\nUsing \u03a8 we introduce cutoff functions \u03a8l,\u03b6 (k, \u03b2) with support near \u03b6k\u2217l defined as follows:\n\u0013\n\u0012\nk \u2212 \u03b6k\u2217l\n, l = 1, . . . , Nh .\n(5.14)\n\u03a8l,\u03b6 (k, \u03b2) = \u03a8\n\u03b2 1\u2212\u01eb\nHere \u01eb is a small number, 1/2 > \u01eb > 0; we take the same \u01eb as in Definition 2.9.\nGiven a wavepacket h\u0303l (k, \u03b2) we introduce a modified wavepacket\n\u03a8\n\u03a8\n\u03a8\nh\u0303\u03a8\nl (k, \u03b2) = h\u0303l,+ (k, \u03b2) + h\u0303l,\u2212 (k, \u03b2) , h\u0303l,\u03b6 (k, \u03b2) = \u03a8l,\u03b6 (k, \u03b2) h\u0303l,\u03b6 (k, \u03b2) ,\n\n(5.15)\n\nwhere \u03a8l,\u03b6 are defined by (5.14).\nProposition 5.5 If h\u0303l (k, \u03b2) is a wavepacket in the sense of Definition 2.9 then h\u0303\u03a8\nl (k, \u03b2)\ndefined by (5.15) and (5.14) is also a wavepacket in the sense of Definition 2.9 and, in\naddition to that,\n1\u2212\u01eb\nh\u0303\u03a8\n,\n(5.16)\nl,\u03b6 (k, \u03b2) = 0 if |k \u2212 \u03b6k\u2217l | \u2265 \u03c0 0 \u03b2\nh\u0303l \u2212 h\u0303\u03a8\nl\n\nL1\n\n\u2264 C\u03b2.\n\nProof. To obtain (5.17) we note that (2.34) and (5.12) imply:\nZ\n=\n(1 \u2212 \u03a8l,\u03b6 (k, \u03b2)) h\u0303l,\u03b6 (k) dk \u2264 C\u03b2,\n(1 \u2212 \u03a8l,\u03b6 ) h\u0303l,\u03b6\nL1\n\n(5.17)\n\n(5.18)\n\nand (5.17) follows. Remaining statements are obtained by a straightforward verification.\nThe following lemma shows that we can replace h\u0303l by h\u0303\u03a8\nl in the statement of Theorem\n2.15, in particular in (2.47), (2.48).\n52\n\n\fLemma 5.6 Let h\u0303l,\u03b6 satisfy (2.34) and h\u0303\u03a8\nl (k, \u03b2) be defined by (5.15). Let\nh\u0303l \u2264 R, l = 1, . . . , Nh where Nh R < RG .\nThen the difference\n# \"\n! N\n\"\nNh\nh\n\u0010 \u0011\nX\nX\nG h\u0303l \u2212 G\nh\u0303l \u2212\nG\nl=1\n\nl=1\n\nNh\nX\n\nh\u0303\u03a8\nl\n\nl=1\n\n!\n\n(5.19)\n\n#\nNh\n\u0010 \u0011\nX\nG h\u0303\u03a8\n= B\u03a8 ,\n\u2212\nl\n\n(5.20)\n\nl=1\n\nis small, namely\nkB\u03a8 kE \u2264 C (R) \u03b2.\n\n(5.21)\n\nProof. Note that since 0 \u2264 \u03a8l \u2264 1 we have\n\u03a8l,\u03b6 h\u0303l,\u03b6\n\nL1\n\n\u2264 h\u0303l,\u03b6\n\nL1\n\n,\n\n(1 \u2212 \u03a8l,\u03b6 ) h\u0303l,\u03b6\n\nL1\n\n\u2264 h\u0303l,\u03b6\n\nL1\n\n,\n\n(5.22)\n\nand (5.18). Using the Lipschitz continuity of the solution operator G (see 4.6) and (5.17) we\nobtain (5.21).\nTruncation. We will truncate the infinite series (5.8). To this end we define an integer\nm = m (\u03b2 q ) as a solution of the inequality\n2 |ln \u03b2 q |\n2 |ln \u03b2 q |\nq\n< m (\u03b2 ) \u2264\n+ 1,\n|ln RG |\n|ln RG |\n\n(5.23)\n\nwhere RG is the same as in (5.9). We consider then the following partial sum of the expansion\n(5.8)\nq\n\u0011\n\u0010\n\u0010 \u0011 m(\u03b2\nX)\n(5.24)\nG (m) h\u0303(m)\nGm(\u03b2 q ) h\u0303 =\nm=1\n\nand readily conclude that the following statement holds.\nLemma 5.7 Let G be defined by (5.8), then\n\u0010 \u0011\n\u0010 \u0011\n\u2264 C (R) \u03b2 when\nG h\u0303 \u2212 Gm(\u03b2) h\u0303\nE\n\n5.2.1\n\nSI-CI splitting for evaluated monomials\n\nh\u0303\n\nE\n\n\u2264 R < RG .\n\n(5.25)\n\n\u0010\n\u0011\nWe consider a function h\u0303 which is a sum of the form (2.39) and the solution G F , h\u0303 . Ex\u0011\n\u0010\n(m)\n(m)\nh\u0303\ninto composition monomials as in (4.33) we obtain a sum of composition\npanding G\n\u0010 \u0011\n\u0010 \u0011\nmonomials M (F , T ) h\u0303m . Then we look at the m-linear monomial M (F , T ) h\u0303m where h\u0303\n53\n\n\fequals a sum of Nh one-band wavepacket h\u0303l as in (2.39). Using the linearity with respect to\neach argument we expand the monomial into a sum of Nhm expressions (evaluated monomials)\n!\n!m\nNh\n\u0011\n\u0010\nY\nX\nX\nX\nM (F , T )\nh\u0303li . (5.26)\nM (F , T ) h\u0303l1 . . . h\u0303lm =\n=\nM (F , T )\nh\u0303l\ni\n\nl1 ,...,lm\n\nl1 ,...,lm\n\nl=1\n\nThe sum contains evaluated monomials of two kinds: (i) ones which involve the same\nwavepacket; and (ii) one corresponding to the cross-terms (terms involving different wavepackets). To be precise, we introduce the following definition.\n\u0011\n\u0010\nDefinition 5.8 (SI and CI) We say that an evaluated monomial M (F , T ) h\u0303l1 . . . h\u0303lm\n\nwith the argument multiindex l1 , . . . , lm \u2208 {1, . . . , N}m in the expansion (5.26) is self-interacting\n(SI) if\nl 1 = l 2 = . . . = lm .\n(5.27)\n\u0011\n\u0010\nOtherwise we say that M (F , T ) h\u0303l1 . . . h\u0303lm is cross-interacting (CI).\nUsing this notation we rewrite (5.26):\n!m !\nNh\nNh\n\u0010\u0010 \u0011m \u0011\nX\nX\nh\u0303l\n=\nM (F , T )\nM (F , T ) h\u0303l\n+\nl=1\n\nl=1\n\nX\n\nl1 ,...,lm is CI\n\n\u0011\n\u0010\nM (F , T ) h\u0303l1 . . . h\u0303lm .\n\n(5.28)\n\nSubstituting this expression into (4.33) we obtain the expansion\n\u0010\n\n\u0011\n\nG h\u03031 + . . . + h\u0303Nh =\n=\n\n\u221e\nX\n\nm=1\n\n\u221e\nX\n\nm=1\n\n\u0010\u0010\n\u0011m \u0011\nGm h\u03031 + . . . + h\u0303Nh\n\n(5.29)\n\n\u221e\n\u0010\u0010 \u0011m \u0011\n\u0010\u0010\n\u0011m \u0011\n\u0010\n\u0011\nX\nG h\u03031\n+ ...+\nG h\u0303Nh\n+ GCI h\u03031 , . . . , h\u0303Nh ,\nm=1\n\nwhere GCI contains only CI monomials with cross-terms.\nProposition 5.9\nmial of the form\n\n\u0010\n\u0011\nEvery evaluated CI monomial M (F , T ) h\u03031 , . . . , h\u0303Nh has a submono-\n\n\u0011\u0011\n\u0011\n\u0010\n\u0010\n\u0010\n(5.30)\nF (s) M (F , T1 ) h\u0303l1 . . . h\u0303l1 . . . M (F , Ts ) h\u0303ls . . . h\u0303ls\n\u0011\n\u0011\n\u0010\n\u0010\nwhere all M (F , T1 ) h\u0303l1 . . . h\u0303l1 ,..., M (F , Ts ) h\u0303ls . . . h\u0303ls are SI, and there are at least two\nindices i and j such that h\u0303li 6= h\u0303lj . We call such a monomial a minimal CI monomial.\n\nProof. The set of CI submonomials of M (F , T ) is finite and it is non-empty since\nM (F , T ) itself is a CI monomial. We take CI submonomial of M (F , T ) with a minimal\nrank. Its rank is non-zero since every zero rank submonomial is SI. Since the rank is minimal\nall submonomials are SI. Hence it has the form (5.30).\n54\n\n\f5.3\n\nProperties of SI monomials\n\nAccording to Definition 5.8 for a SI evaluated monomial we have h\u0303l1 = . . . = h\u0303lm . Observe\nalso that in view of Definition 2.9 every single-band wavepacket h\u0303l has its band number,\nand n\u2032 = n\u2032\u2032 = . . . = n(m) , that is the band nl = n0 is the same for all h\u0303l . Similarly,\nk\u2217l1 = . . . = k\u2217lm . Having these properties we often omit in this section indices ni , li and\nskip ~n for notational brevity, writing, for example,\n(m)\nn,\u03b6,~\nn,~\u03b6\n\n\u03c9 n,\u03b6 (k) = \u03c9 \u03b6 (k) , \u0169n,\u03b6 (k) = \u0169\u03b6 (k) , \u03c7\n5.3.1\n\n(m)\n\n= \u03c7\u03b6,~\u03b6 .\n\nMonomials applied to a single-band wavepacket.\n\nHere we consider monomials based on oscillatory integral operators and which are applied\nto a single-band wavepacket. We recall that according to (2.33) a single-band wavepacket h\u0303\ninvolves two components h\u0303+ and h\u0303\u2212 and a small complement component h\u0303\u221e .\n\u0010\n\u0011\nDefinition 5.10 (frequency matching) We call a decorated composition monomial M F , T, ~\u03bb, ~\u03b6\nfrequency matched (FM)\nnode N \u2208 T the corresponding decorated sub\u0010 if for every non-end\n\u0011\n\u2032)\n(m\nM1,\u03b6 \u2032 . . . Mm\u2032 ,\u03b6 (m\u2032 ) satisfies the following conditions:\nmonomial M \u2032 = F\u03bb\n\u03bb 6= \u221e, \u03b6 (j) 6= \u221e, j = 1, . . . , m\u2032 ,\n\nand\n\n(5.31)\n\n\u2032\n\nm\nX\n\n\u03b6 (j) = \u03bb,\n\n(5.32)\n\nj=1\n\nwhere \u03bb, \u03b6 (j) \u2208 \u039b defined by (4.41), we identify \u00b1 with \u00b11. A decorated composition monomial\nwhich does not satisfy the above conditions is called not frequency matched (NFM) monomial.\nCollecting separately FM and NFM terms in the expression (4.51) we obtain\n\u0010\n\u0011\nX\nM (F , T ) (x1 x2 . . . xm ) =\nM F , T, ~\u03bb, ~\u03b6 (x1 x2 . . . xm )\n+\n\nX\n\nNFM ~\n\u03bb,~\u03b6\n\n(5.33)\n\nFM ~\n\u03bb,~\u03b6\n\n\u0010\n\u0011\nM F , T, ~\u03bb, ~\u03b6 (x1 x2 . . . xm ) .\n\nRemark 5.11 Any SI evaluated monomial is either FM or NFM. We do not define for CI\nevaluated monomials if they are FM or NFM.\nBelow we show that FM decorated monomials have the following properties which can\nbe briefly stated as follows.\n\n55\n\n\fProperty 1. If h\u0303 (k)\n\u0010 is a wavepacket\n\u0011 \u0010 \u0011 in the sense of Definition 2.9 centered around \u00b1k\u2217\n~\n~\nthen FM monomial M F , T, \u03bb, \u03b6 h\u0303m (k) is also localized about \u00b1k\u2217 . This property is\nproved below in Corollary 5.13.\nProperty 2. The most important property concerning FM-NFM splitting is that the\u0001\nresult of a NFM monomial application to a wavepacket has magnitude O (\u033a), that is O \u03b2 2\nfor the scaling (2.46). Consequently, all NFM terms in (5.33) are small (see Lemma 5.16\nbelow) and they give contribution only to the remainder D\u0303 in (2.47).\nNow we formulate exact statements clarifying the above properties. The following two\nstatements show, in particular, that an FM monomial transforms a function supported in a\nvicinity of k\u2217 into a similar function.\nLemma 5.12 (operator support ) If \u01691,\u03b6 \u2032 . . . \u0169m,\u03b6 (m) are such that\n\u0001\n\u0169\u03b6 (l) k(l) = 0 when k(l) \u2212 \u03b6 (l) k\u2217 > \u03b4 l , l = 1, . . . , m,\n\nand\n\nthen F\n\n(m)\n\n\u0010\n\n\u0011\n\n\u0010\n\u0011\nk~\u03b6 = \u03b6 \u2032 + . . . + \u03b6 (m) k\u2217 .\n\n(5.34)\n\n\u01691,\u03b6 . . . \u0169m,\u03b6 (m) (k, \u03c4 ) given by (3.4), satisfies\n\u2032\n\n(m)\n\nF\u03b6\n\n\u0010\n\n\u0011\n\u01691,\u03b6 \u2032 . . . \u0169m,\u03b6 (m) (k, \u03c4 ) = 0 if k \u2212 k~\u03b6 > \u03b4 1 + . . . + \u03b4 m .\n\n(5.35)\n\nIn particular, if the binary indices \u03b6, ~\u03b6 (m) are frequency matched (FM), that is\n\u03b6 = \u03b6 \u2032 + . . . + \u03b6 (m) , where \u03b6 (j) , \u03b6 = \u00b11,\n\n(5.36)\n\nthen (5.35) holds with k~\u03b6 = \u03b6k\u2217 .\nProof. \u00bfFrom (3.8) and (5.36) we obtain the equality\n\u0010\n\u0011\nk \u2212 \u03b6k\u2217 = (k\u2032 \u2212 \u03b6 \u2032 k\u2217 ) + . . . + k(m) \u2212 \u03b6 (m) k\u2217\n\nwhich implies lemma's statement.\n\n\u0010\n\u0011\u0010\n\u0011\nCorollary 5.13 (support of a monomial) If M F , T, ~\u03bb, ~\u03b6 h\u03031 . . . h\u0303m is a decorated\ncomposition monomial and\n\nthen\n\nh\u0303l,\u03b6 (l) = 0 when k(l) \u2212 \u03b6 (l) k\u2217 > \u03b4 0 , l = 1, . . . , m,\n\n(5.37)\n\n\u0010\n\u0011\u0010\n\u0011\n~\n~\nM F , T, \u03bb, \u03b6 h\u03031 . . . h\u0303m (k) = 0 if k \u2212 k~\u03b6 > m\u03b4 0 ,\n\n(5.38)\n\n56\n\n\f\u0010\n\u0011\u0010\n\u0011\nwhere k~\u03b6 is defined by (5.34). In particular, if M F , T, ~\u03bb, ~\u03b6 h\u03031 . . . h\u0303m is a FM decorated\ncomposition monomial, then\n\u0010\n\u0011\u0010\n\u0011\n~\n~\nM F , T, \u03bb, \u03b6 h\u03031 . . . h\u0303m (k) = 0 if |k \u2212 \u03b6k\u2217 | > m\u03b4 0 .\n(5.39)\n\nwhere \u03b6 satisfies (5.36). In particular, if \u03b4 0 = \u03b2 1\u2212\u01eb and m \u2264 C ln \u03b2 then for any \u03b4 1 > 0 there\nexists \u03b2 0 such that for \u03b2 < \u03b2 0 we have C\u03c0 0 \u03b2 1\u2212\u01eb ln \u03b2 < \u03b4 1 and\n\u0010\n\u0011\u0010\n\u0011\nM F , T, ~\u03bb, ~\u03b6 h\u03031 . . . h\u0303m (k) = 0 when |k \u2212 \u03b6k\u2217 | > C\u03c0 0 \u03b2 1\u2212\u01eb ln \u03b2.\n(5.40)\n\nProof. To obtain (5.38) we apply Lemma 5.12 and use the induction with respect to\nthe rank of a monomial.\n\u0010\n\u0011\n~\n~\nRemark 5.14 If M F , T, \u03bb, \u03b6 is NFM and h\u0303 (k) is a wavepacket localized near \u00b1k\u2217 , then\n\u0010\n\u0011\u0010 \u0011\nM F , T, ~\u03bb, ~\u03b6 h\u0303m (k) is localized near the point k~\u03b6 . As ~\u03b6 vary over {\u22121, 1}m such points\nk~\u03b6 lie on a straight line parallel to k\u2217 . For m \u2192 \u221e the closure of the set of such k~\u03b6 with\na generic k\u2217 can be the entire torus [\u2212\u03c0, \u03c0]d , whereas for the case of ~\u03b6 corresponding to an\nFM monomial the closure is just two points \u00b1k\u2217 . Hence Property 1 is very useful and, in\nparticular, allows to avoid small denominators in coupling terms.\nThe following lemma shows that the FM interaction phase function of a single wavepacket\nhas a critical point at its center, or, in other words, FM monomials satisfy the group velocity\nmatching condition (see [3], [6]).\n(m)\n\nLemma 5.15 If a decorated operator F\u03b6,~\u03b6\n\nis FM then the interaction phase function \u03c6 in\n\n(m)\n\n(3.8) has a critical point:\n\n\u0010\n\u0011\n\u0010\n\u0011\n\u2032\n(m)\n~\n~\n\u2207k \u03c6n,\u03b6,~n,~\u03b6 \u03b6k\u2217 , k\u2217 = 0 at k\u2217 = \u03b6 k\u2217 , . . . , \u03b6 k\u2217 .\n\n(5.41)\n\nn = n\u2032 = . . . = n(m) and \u03b6 = \u03b6 \u2032 + . . . + \u03b6 (m) .\n\n(5.42)\n\nProof. For FM decorated operator all indices \u03b6 (j) = \u00b1 and\n\nHence we obtain from (3.9) that\n\u0010\n\u0011\n\u0001\n~\n\u2207k \u03c6n,\u03b6,~n,~\u03b6 k, k = \u03b6\u2207k \u03c9 (k) \u2212 \u03b6 (m) \u2207k \u03c9 k \u2212 k\u2032 \u2212 . . . \u2212 k(m\u22121) .\n(m\u22121)\n\nSince \u03b6k\u2217 \u2212 \u03b6 \u2032 k\u2032\u2217 \u2212 . . . \u2212 \u03b6 (m\u22121) k\u2217\n\n(m)\n\n= \u03b6 (m) k\u2217 and (2.16) implies\n\u0010\n\u0011\n\u03b6\u2207k \u03c9 (\u03b6k\u2217 ) = \u03b6 (m) \u2207k \u03c9 \u03b6 (m) \u03b6k\u2217 for \u03b6 = \u00b1, \u03b6 (m) = \u00b1,\n57\n\n(5.43)\n\n\fwe obtain the desired (5.41).\nNow we consider NFM monomials and prove the Property 2.\nimplies\n\u03c9 nl (k\u2217l ) \u2265 \u03c9 \u2217 > 0, l = 1, . . . , Nh .\n\nFirst we note that (2.40)\n(5.44)\n\nIf k\u2217l = k\u2217 , nl = n0 satisfy Condition 2.13 then if (2.44) does not hold, (2.42) does not hold\ntoo, hence for m \u2264 mF\nm\nX\nj=1\n\nm\n\u0010 \u0011\nX\n\u03b6 (j) \u03c9 n0 (k\u2217 ) \u2212 \u03b6\u03c9 n k~\u03b6 \u2265 \u03c9 \u2217 > 0, k~\u03b6 =\n\u03b6 (j) k\u2217 ,\n\n(5.45)\n\nj=1\n\nwhere \u03c9 \u2217 > 0 is a positive number (we take for notation simplicity the same small enough\nconstsant in (5.44) and (5.45).\nThe following Lemma, which is a version of the standard statement of the stationary\nphase method, shows that the action of an NFM monomial on a wavepacket produces a wave\nof a small amplitude.\nLemma 5.16 Let the decoration projections be defined by (5.1). Assume that Condition 2.13\nholds. Let indices \u03b6, \u03b6 \u2032 , . . . , \u03b6 (m) be NFM, that is either one of them is \u221e or\n\u03b6 6= \u03b6 \u2032 + . . . + \u03b6 (m) , \u03b6 (j) = \u00b11, \u03b6 = \u00b11.\n\n(5.46)\n\nLet \u03b4 N F M > 0 be small enough to satisfy\n\u03b4N F M\n\n1\n|\u2207\u03c9 l (k)| \u2264 \u03c9 \u2217 , l = 1, . . . , Nh ,\n|k\u2217l \u2212k|\u2264\u03b4 NF M\n4\nmax\n\n(5.47)\n\nwhere \u03c9 \u2217 is given in (5.45). Let k,k(j) satisfy (3.12) and be such that\nm\nX\nj=1\n\nk(j) \u2212 \u03b6 (j) k\u2217 \u2264 \u03b4 N F M , k \u2212 k~\u03b6 \u2264 \u03b4 N F M ,\n\n(5.48)\n\nwhere k~\u03b6 is defined by (5.34) and k\u2217 = k\u2217l satisfy the conditions (5.44) and (5.45). Let the\nfunctions \u0169j,\u03b6 (j) (k, \u03c4 ) satisfy the condition\n\u0010\n\u0011\n\u0169j,\u03b6(j) (k, \u03c4 ) = 0 when \u03b6 (j) = \u221e and \u0169j,\u03b6(j) \u03b6 (j) k\u2217 + s, \u03c4 = 0 when |s| \u2265 \u03b4 N F M .\n\n(5.49)\n\n\u0011\n\n(5.50)\n\nThen\n\n(m)\nF\u03b6,\u03b6 \u2032 ,...,\u03b6 (m)\n\n+\n\n\u0010\n\n\u01691,\u03b6 . . . \u0169m,\u03b6 (m)\n\u2032\n\n2\u033a\u03c4 \u2217 2m+1 (m)\nC\n\u03c7\n\u03c9\u2217 \u039e\n\nY\n4\u033a (m)\n\u03c7\nC\u039e2m+1\nk\u0169j kE\n\u03c9\u2217\nE\nj\nY\nX\nk\u0169j kE .\nk\u2202\u03c4 \u0169i kE\n\u2264\n\ni\n\n58\n\nj6=i\n\n\f(m)\n\nProof. If one of the indices \u03b6 \u2032 , . . . , \u03b6 (m) equals \u221e by (5.49) F\u03b6,\u03b6 \u2032 ,...,\u03b6 (m) = 0 and (5.50) is\n\nsatisfied. Now we consider the case when all \u03b6, \u03b6 \u2032 , . . . , \u03b6 (m) are finite. We denote for brevity\n\u03c9 n0 = \u03c9, k\u2217l = k\u2217 and \u03c6n,\u03b6,~n,~\u03b6 = \u03c6. Since (5.48) holds we get from (3.9) that\n\u0010\n\u0011\n\u0010\n\u0011\n\u0010\n\u0011\n\u0001\n\u03c6 k, ~k \u2212 \u03c6 k, ~k\u2217 \u2264 |\u03c9 (k\u2032 ) \u2212 \u03c9 (\u03b6 \u2032 k\u2217 )| + . . . + \u03c9 k(m) \u2212 \u03c9 \u03b6 (m) k\u2217\n\u2264\n\nmax\n\n|k\u2217 \u2212k|\u2264\u03b4NF M\n\n|\u2207\u03c9 (k)|\n\nm\nX\nj=1\n\nk(j) \u2212 \u03b6 (j) k\u2217 \u2264 \u03b4 N F M\n\nmax\n\n|k\u2217 \u2212k|\u2264\u03b4NF M\n\n|\u2207\u03c9 (k)| .\n\nUsing (5.47) we conclude that\n\u0010\n\u0011\n\u0010\n\u0011\n1\n\u03c6 k, ~k \u2265 \u03c6 k, ~k\u2217 \u2212 |\u03c9 \u2217 | .\n(5.51)\n4\nBy (5.46) the condition (2.44) is not satisfied, therefore (5.45) holds and implies that\n\u0010\n\u0011\n\u03c6 k~\u03b6 , ~k\u2217 \u2265 \u03c9 \u2217 .\n(5.52)\n\nUsing (5.52), (5.48) and (5.47) we conclude that\n\u0010\n\u0011\n\u0010 \u0011\n~\n\u03c6 k, k\u2217 \u2265 \u03c9 \u2217 \u2212 \u03c9 (k) \u2212 \u03c9 k~\u03b6 \u2265 \u03c9 \u2217 \u2212 \u03b4 N F M\n\n3\n|\u2207\u03c9 (k)| \u2265 \u03c9 \u2217 .\n|k\u2217 \u2212k|\u2264\u03b4 NF M\n4\nmax\n\n(5.53)\n\nTogether with (5.51) this inequality implies that when (5.48) holds we have the estimate\n\u0010\n\u0011\n1\n(5.54)\n\u03c6 k, ~k \u2265 \u03c9 \u2217 .\n2\nNow we note that the oscillatory factor in (3.8)\n\u001a \u0010\n\u001a \u0010\n\u0011\u03c4 \u001b\n\u0011\u03c4 \u001b\n\u033a\n1\n\u0011 \u2202\u03c4 1 exp i\u03c6 k, ~k 1 .\nexp i\u03c6 k, ~k\n= \u0010\n\u033a\n\u033a\ni\u03c6 k, ~k\n\nIntegrating (3.8) by parts with respect to \u03c4 1 we obtain\n(m)\n\nF\u03b6,~\u03b6 (\u01691 . . . \u0169m ) (k, \u03c4 ) =\n\nn \u0010\n\u0011 o\nZ \u033a exp i\u03c6 k, ~k \u03c4\n\u0010\n\u0010\n\u0011 \u0011\n\u0010\n\u0011\n\u033a\n(m)\n(m)\n\u2032\n~\n~\n\u0010\n\u0011\n\u2032\n\u2032\n\u03c7\u03b6,~\u03b6 k, k \u01691,\u03b6 (k , \u03c4 ) . . . \u0169m,\u03b6 k\nk, k , \u03c4 d\u0303(m\u22121)d~k\nDm\ni\u03c6 k, ~k\nZ\n\u0010\n\u0011 \u0011\n\u0010\n\u0010\n\u0011\n\u033a\n(m)\n(m)\n\u2032\n~\n~\n\u2032\n\u2032\n\u0010\n\u0011\nk, k , 0 d\u0303(m\u22121)d~k\n\u03c7\u03b6,~\u03b6 k, k \u01691,\u03b6 (k , 0) . . . \u0169m,\u03b6 k\n\u2212\nDm i\u03c6 k, ~\nk\n\u001a \u0010\nZ \u03c4Z\n\u0011\u03c4 \u001b\n\u033a\n~\n\u0010\n\u0011 exp i\u03c6 k, k 1\n\u2212\n\u033a\n0\nDm i\u03c6 k, ~\nk\n\u0010\n\u0011\u0011i\n\u0010\nh\n\u0010\n\u0011\n(m)\n(m)\n\u2032\n~\n~\n\u2032\n\u2032\nk, k\nd\u0303(m\u22121)d~kd\u03c4 1 .\nk, k \u2202\u03c4 1 \u01691,\u03b6 (k ) . . . \u0169m,\u03b6 k\n\u03c7\u03b6,~\u03b6\n(m)\n\n59\n\n(5.55)\n\n\fEstimating the denominator by (5.54) and using (3.5) we obtain (5.50). Finally, we consider\nthe case when \u03b6 = \u221e and all remaining\n\u03b6 (j) equal \u00b1. We expand \u03a0\u221e into sum of\n\u0010 indices\n\u0011\n(m)\nk, ~k involves a projection \u03a0n,\u03b6 with n 6= n0 (the\n\u03a0n,\u03b6 as in (4.38). In this case \u03c7\u03b6,~\u03b6\n(m)\n\noscillatory integral\n\u0010 may\n\u0011 involve Nh \u2212 1 terms with such n). For a fixed n the corresponding\nphase function \u03c6 k, ~k takes the form\n\u0010\n\u0011\n\u0010\n\u0011\n\u0001\n\u03c6 k, ~k = \u03c6n,\u03b6,~n,~\u03b6 k, ~k = \u03b6\u03c9 n (k) \u2212 \u03b6 \u2032 \u03c9 n0 (k\u2032 ) \u2212 . . . \u2212 \u03b6 (m) \u03c9 n0 k(m) .\n\nUsing again (5.45) (now with n 6= n0 ) we obtain that (5.52) holds. This implies (5.54) as\nabove provided \u03b4 N F M is small enough. Hence, the relation (5.55) holds, implying readily the\ndesired bound (5.50).\n5.3.2\n\nFM and NFM monomials for SI oscillatory integrals\n\nThe following below theorem shows that NFM monomials are of the order O (\u033a) as \u033a \u2192 0.\nWe begin first with the following statement.\n\u0011\n\u0010\n(s)\nLemma 5.17 Assume that Condition 2.13 holds. Let a monomial S = F\u03b6 M1,\u03b6 (1) . . . Ms,\u03b6 (s)\nhave all submonomials M1,\u03b6 (1) . . . Ms,\u03b6 (s) which satisfy FM condition (5.36), but S itself is not\nFM. Assume that S is applied to wavepackets hl which satisfy Definition 2.9. and\nh\u0303l,\u03b6 (k, \u03b2) = 0 if |k \u2212 \u03b6k\u2217l | \u2265 \u03c0 0 \u03b2 1\u2212\u01eb , \u03b6 = \u00b1.\n\n(5.56)\n\nThen\n4\u033a \u03c7(s) 2s+1 Y\nC\nMj,\u03b6 (j)\nkSkE \u2264\n|\u03c9 (k\u2217 )| \u039e\nj\ns\n\n4\u033a\u03c4 \u2217 \u03c7(s) 2s+1 X\nC\u039e\n\u2202\u03c4 Mi,\u03b6 (i)\n+\n|\u03c9 (k\u2217 )|\ni=1\n\nE\n\nY\nj6=i\n\nMj,\u03b6 (j)\n\nE\n\nE\n\n+\n\n(5.57)\n\n, E = C ([0, \u03c4 \u2217 ] , L1 ) .\n\nProof. Since M1,\u03b6 (1) . . . Ms,\u03b6 (s) are decorated FM submonomials we can use Lemma 5.12\nand Corollary 5.13. Applying Corollary 5.13 and using (5.12) we obtain that\n\u0011\n\u0010\n\u0001\n(5.58)\nMl,\u03b6 (l) k(l) , \u03c4 1 = 0 when k(l) \u2212 \u03b6 (l) k\u2217 > \u03bd Ml,\u03b6 (l) \u03b2 1\u2212\u01eb \u03c0 0 , l = 1, . . . , s.\n\nwhere \u03bd (M) is homogeneity index of M. Consider now the oscillatory integral (3.8) which\ndetermines S, namely\n\u001a\nZ \u03c4Z\n\u0011\n\u0010\n\u0011\u03c4 \u001b\n\u0010\n1\n(s)\nF\u03b6,~\u03b6 M1,\u03b6 (1) . . . Ms,\u03b6 (s) (k, \u03c4 ) =\nexp i\u03c6 \u03b6,~\u03b6 k, ~k\n(5.59)\n\u033a\n0\nDs\n\u0010\n\u0010\n\u0011\n\u0011\n\u0010\n\u0011\n(s)\n\u03c7 \u03b6,~\u03b6 k, ~k M1,\u03b6 (1) (k\u2032 , \u03c4 1 ) . . . Ms,\u03b6 (s) k(s) k, ~k , \u03c4 1 d\u0303(s\u22121)d~kd\u03c4 1 .\n60\n\n\fWe apply Lemma 5.16 where, according to (5.58) and (5.62) \u03b4 N F M = m\u03b2 1\u2212\u01eb \u03c00 . According\nto (5.50)\n(s)\n\nkSkE = F\u03b6,~\u03b6\n\n(s)\n\n\u0011\n\u0010\nM1,\u03b6 (1) . . . Ms,\u03b6 (s) (k, \u03c4 )\ns\n\n4\u033a\u03c4 \u2217 \u03c7(s) 2s+1 X\nC\u039e\n+\n\u2202\u03c4 Mi,\u03b6 (i)\n|\u03c9 (k\u2217 )|\ni=1\n\nE\n\nE\n\nY\n\n\u2264\n\n4\u033a \u03c7(s) 2s+1 Y\nC\nMj,\u03b6 (j)\n|\u03c9 (k\u2217 )| \u039e\nj\n\nMj,\u03b6 (j)\n\nE\n\nj6=i\n\nE\n\n(5.60)\n\n, E = C ([0, \u03c4 \u2217 ] , L1 ) ,\n\nthat implies (5.57).\nTheorem 5.18 Suppose that (i) the inequalities (5.44) hold; (ii) h\u0303l are wavepackets in the\nsense of Definition 2.9; (iii) the relations (5.56) hold; (iv) the projections are defined by (5.1);\n(v) Condition 2.13 holds. Then a NFM decorated monomial based on oscillatory integrals F\ndefined by (3.4) satisfies the estimate\n\u0010\n\u0011\u0010\n\u0011\nM F , T, ~\u03bb, ~\u03b6 h\u03031 . . . h\u0303m\n\u2264\n(5.61)\n4\u033a\u03c4 i\u22121\n\u2217\n\n[1 + m] 2i+e\nC\u039e\n|\u03c9 (k\u2217 )|\n\nY\n\n\u03c7(\u03bc(N ))\n\nN \u2208T,r(N )>0\n\nC([0,\u03c4 \u2217 ],L1 )\nm\nY\n\nh\u0303l,\u03b6 (l)\n\nl=1\n\nC([0,\u03c4 \u2217 ],L1 )\n\n,\n\nwhere i, m and e are respectively the incidence number, the homogeneity index and the number\nof edges of T .\n\u0011\n\u0011\u0010\n\u0010\nProof. Let M F , T, ~\u03bb(q) , ~\u03b6 (m) h\u03031 . . . h\u0303m be a NFM decorated m-homogenious mono\u0011\n\u0011\n\u0010\n\u0010\nmial. We find a decorated submonomial S = M F , T (N0 ) , ~\u03bb(q) , ~\u03b6 (m) of M F , T, ~\u03bb(q) , ~\u03b6 (m)\nwith such N0 that S is NFM and has minimal rank of all NFM submonomials. We denote\nby r0 the rank of S, by i\u2032 its incidence number and \u0010by s = \u03bd (S) = \u03bd\u0011(T (N0 )) its homo(s)\ngeneity index. This monomial has the form S = F\u03b6 M1,\u03b6 (1) . . . Ms,\u03b6 (s) . Since the rank is\nminimal, all decorated submonomials Ml,\u03b6 (l) are FM and their ranks do not exceed r0 \u2212 1.\nThen according to (4.21) their homogeneity indices satisfy\n\u0011\n\u0011\n\u0010\n\u0010\n(5.62)\n\u03bd M1,\u03b6 (1) + . . . + \u03bd Ms,\u03b6 (s) = s \u2264 m.\nApplying Lemma 5.17 we obtain (5.57). Now we use Lemma 5.1 and 5.2. Applying Lemma\n4.24 we obtain\n\u0010\n\u0011\nM ({F } , T, \u0393) h\u03031 . . . h\u0303m\n\u2264\nE\nY\nY\nY\n(\u03bc(N ))\nh\u0303l,\u03b6 (l) .\nF\u0393(N )\nh\u0303l,\u03b6 (l)\nkSkE\nN \u2208T \\T \u2032 (N0 ),r(N )>0\n\nl<\u03ba\n\n61\n\nE\n\nl\u2265\u03ba+\u03bd(T \u2032 (N0 ))\n\nE\n\n\f(\u03bc(N ))\n\nNote that the norm of F\u0393(N )\nis estimated by (5.2) and norm of S by (5.57). In turn, we\nestimate right-hand side of (5.57) using (5.2) and (5.3) Taking into account that s \u2264 m in\nthe sum in (5.60) we get the estimate (5.61).\nWe also consider the case when Condition 2.13 does not hold and Condition 2.23 holds.\nIn this case we give an alternative definition of FM and NFM decorated monomials.\nDefinition 5.19\nFrequency Matching) We call a decorated composition\n\u0010 (Alternative\n\u0011\n~\n~\nmonomial M F , T, \u03bb, \u03b6 alternatively frequency matched (AFM) if (i) every node of T\nhas an odd number of child nodes (at least\nfor every non-end\nnode N \u2208 T\n\u0010\n\u0011 the cor\u0010 three); (ii) \u0011\n(m\u2032 )\n\u2032\n~\n~\nM1,\u03b6 \u2032 . . . Mm\u2032 ,\u03b6 (m\u2032 ) satisfies\nresponding decorated submonomial M F , T (N) , \u03bb, \u03b6 = F\u03bb\n(5.31) and\n!\nm\u2032\nX\nsign\n\u03b6 (j) = \u03bb,\n(5.63)\nj=1\n\n(j)\n\nwhere \u03bb, \u03b6 \u2208 \u039b defined by (4.41), we identify \u00b1 with \u00b11. A decorated composition monomial\nwhich is not AFM is called alternatively not frequency matched (ANFM) monomial.\nNow we prove a statement analogous to Theorem 5.18 when Condition 2.23 holds.\nTheorem 5.20 Assume that assumptions of Theorem NFM hold with Condition 2.13 replaced by Condition 2.23. Then (5.61) holds.\n2.9 and\nProof. According\nto \u0011\nCorollary\n5.13,\nm = h\u0303l satisfy Definition\n\u0011\n\u0011 if h\u0303l1\u0010= . . . = h\u0303\n\u0011l\u0010\n\u0010\n\u0010\n(5.56), then M F , T, ~\u03bb, ~\u03b6 h\u0303l1 . . . h\u0303lm = M F , T, ~\u03bb, ~\u03b6 h\u0303l1 ,\u03b6 \u2032 . . . h\u0303lm ,\u03b6 (m) has support in\n\na m\u03b2 1\u2212\u01eb vicinity of\n\nk~\u03b6 = \u03bdk\u2217 defined by (5.34), \u03bd and m are odd integers,m \u2265 3, \u03bd =\n\u0010\n\u0011\n\u0010\n\u0011\n\u03b6 \u2032 + . . . + \u03b6 (m) . Let S = M F , T \u2032, ~\u03bb, ~\u03b6 be minimal ANFM submonomial of M F , T, ~\u03bb, ~\u03b6 ,\n\u0010\n\u0011\nthat is if T \u2032\u2032 \u2282 T \u2032 then M F , T \u2032\u2032 , ~\u03bb, ~\u03b6 is AFM submonomial of S. The monomial S has\nthe form of (5.59) with the interaction phase function\n\u0010\n\u0011\n\u0001\n\u03c6\u03b6,~\u03b6 k, ~k = \u03b6\u03c9 n (k) \u2212 \u03b6 \u2032 \u03c9 n0 (k\u2032 ) \u2212 . . . \u2212 \u03b6 (s) \u03c9 n0 k(s) .\n(5.64)\n\nThe integrand is non-zero near k(j) = \u03bd j k\u2217 ,and applying (5.63) to every AFM submonomial\nwe get\n\u03b6 (l) = sign (\u03bd l ) .\n(5.65)\nUsing (2.96) and (2.16) we obtain\n\u0010\n\u0011\n\u03c6\u03b6,~\u03b6 \u03bdk\u2217 , ~k\u2217 = \u03b6\u03c9 n (\u03bdk\u2217 ) \u2212 \u03b6 \u2032 \u03c9 n0 (\u03bd 1 k\u2217 ) \u2212 . . . \u2212 \u03b6 (s) \u03c9 n0 (\u03bd s k\u2217 )\n\n= \u03b6\u03c9 n (\u03bdk\u2217 ) \u2212 sign (\u03bd 1 ) |\u03bd 1 | \u03c9 n0 (k\u2217 ) \u2212 . . . \u2212 sign (\u03bd s ) |\u03bd s | \u03c9 n0 (k\u2217 )\n= \u03b6 |\u03bd| \u03c9 n (k\u2217 ) \u2212 (\u03bd 1 + . . . + \u03bd s ) \u03c9 n0 (k\u2217 ) , \u03bd = \u03bd 1 + . . . + \u03bd s .\n62\n\n(5.66)\n\n\fTherefore, since S is ANFM, \u03b6 6=sign(\u03bd) and since \u03bd is odd,\n\u0010\n\u0011\n\u03c6\u03b6,~\u03b6 \u03bdk\u2217 , ~k\u2217 = \u22122\u03bd\u03c9 n0 (k\u2217 ) 6= 0,\n\n(5.67)\n\ntherefore (5.52) holds. We can repeat the proofs of Lemma 5.16 and Lemma 5.17 and obtain\n(5.57). From (5.57) we obtain (5.61) as in the proof of Theorem 5.18.\nBelow we give estimations for the derivatives with respect to k of a composition monomial\napplied to a wavepacket. Note that (2.35) admits a singular dependence on \u03b2 of wavepackets\nh\u0303\u03b6 (\u03b2, k). This type of dependence also naturally comes from explicit formulas as (2.36)\nwhich yield that the first derivative with respect to k has a factor \u03b2 \u22121 . Below we estimate\ndependence on \u03b2 of monomials applied to wavepackets and will show that they have the same\ntype of singularity.\nObserve that by (5.13) all the points k\u2217l are at the distance at least 2\u03c0 0 from \u03c3. Hence,\naccording to Definition 2.3, and (2.28)\n\u0001\n(5.68)\n\u22072k \u03c9 + |\u2207k \u03c9| \u2264 C\u03c9,2 ,\nmax\n|k\u00b1k\u2217l |\u2264\u03c0 0 , l=1,...,Nh ,\n\nmax\n\n|k\u00b1k\u2217l |\u2264\u03c0 0 , l=1,...,Nh\n\n(m)\n\n\u2207\u03c7\u03b6,~\u03b6 k, k\u2032 , . . . , k(m)\n\n\u0001\n\n\u2264 C\u03c7 C\u039em+1 .\n\n(5.69)\n\nThe following seemingly technical Lemma describes a very important property of solutions.\nIt shows that the k-gradient of solutions behaves, roughly speaking, as the gradient of initial\ndata. Corresponding estimates play a crucial role in the control of smallness of interaction\nof different wavepackets.\n\u0011\n\u0010\n\u0011\u0010\nLemma 5.21 Let M F , T, ~\u03bb, ~\u03b6 h\u0303l1 . . . h\u0303lm be a decorated monomial which is SI. Assume\n\nthat h\u0303lj = h\u0303l are wavepackets satisfying Definition 2.9, (5.56) and (5.19), that (2.46) holds\nand\n\u03b2 1\u2212\u01eb m \u2264 \u03c0 0 .\n(5.70)\nAssume that either Condition 2.13 holds and the monomial is FM or Condition 2.23 holds\nand the monomial is AFM. Then\n\u0011\n\u0010\n\u0011\u0010\n~\n~\n\u2264 CC\u03c7 \u03c4 i\u2217 C\u039e2i+e C\u03c7i\u22121 Rm\u22121 \u03b2 \u22121\u2212\u01eb m2 ,\n(5.71)\n\u2207k M F , T, \u03bb, \u03b6 h\u0303l1 . . . h\u0303lm\nE\n\nwhere E = C ([0, \u03c4 \u2217 ] , L1 ), \u03c4 \u2217 \u2264 1, with i = i (T ) and e = e (T ) being respectively the incidence\nnumber and the number of edges of T .\nProof. We use the induction with respect to the incidence\nnumber\ni of a tree T . First,\n\u0010\n\u0011\n~\n~\nwe consider the case when Condition 2.13 holds and M F , T, \u03bb, \u03b6 is FM. For i = 0 (5.71)\nfollows from (2.35). Now we assume that (5.71) holds for the incidence number less than i\n\n63\n\n\f\u0010\n\u0011\nand prove it when the incidence number equals i. Since arguments of M F , T, ~\u03bb, ~\u03b6 are SI,\naccording Definition 5.8 l1 = . . . = lm = l. It is sufficient to prove the boundedness of\n\u0011\n\u0010\n\u0010\n\u0011\u0010 \u0011\n(s)\n\u2032\n,\nM\n.\n.\n.\nM\n\u2207\nF\n\u2207k M F , T, ~\u03bb, ~\u03b6 h\u0303m\n=\n(s)\nk \u03bb\n1,\u03b6\nl\ns,\u03b6\nE\n\nE\n\nwhere M1 . . . Ms are decorated submonomials, Mj,\u03b6 = \u03a0\u03b6 Mj . Let the submonomials have\nincidence numbers i1 , . . . , is and homogeneities m1 , . . . , ms respectively satisfying\ni1 + . . . + is = i \u2212 1, m1 + . . . + ms = m.\n\nWe have by (3.8)\n\u001a\nZ \u03c4Z\n\u0011\n\u0010\n\u0010\n\u0011\u03c4 \u001b\n1\n(s)\n~\nexp i\u03c6 \u03bb,~\u03b6 k, k\n\u2207k F\u03bb M1,\u03b6 \u2032 . . . Ms,\u03b6 (s) (k, \u03c4 ) = \u2207k\n(s\u22121)d\n\u033a\n0\n[\u2212\u03c0,\u03c0]\n\u0010\n\u0011\u0011\n\u0010\n\u0010\n\u0011\n(s)\n(s)\n\u2032\n~\n~\nk, k\nd\u0303(s\u22121)d~kd\u03c4 1 .\n\u03c7\u03bb,~\u03b6 k, k M1,\u03b6 \u2032 (k ) . . . Ms,\u03b6 (s) k\n\n(5.72)\n\n(5.73)\n\nBy Leibnitz formula\n\n(s)\n\n\u2207k F \u03bb\nwhere\n\nZ\n\n\u03c4\n\n\u0010\n\n\u0011\nM1,\u03b6 \u2032 . . . Ms,\u03b6 (s) (k, \u03c4 ) = I1 + I2 + I3 ,\n\u0014\n\nZ\n\n\u001a\n\n\u0010\n\n(5.74)\n\n\u0011 \u03c4 \u001b\u0015\n\n1\nI1 =\n\u2207k exp i\u03c6 \u03bb,~\u03b6 k, ~k\n(s\u22121)d\n\u033a\n0\n[\u2212\u03c0,\u03c0]\n\u0010\n\u0011\u0011\n\u0010\n\u0010\n\u0011\n(s)\nd\u0303(s\u22121)d~kd\u03c4 1 ,\n\u03c7\u03bb,~\u03b6 k, ~k M1,\u03b6 \u2032 (k\u2032 ) . . . Ms,\u03b6 (s) k(s) k, ~k\n\nZ\n\n\u03c4\n\nZ\n\n\u001a\n\n\u0010\n\n\u0011\u03c4 \u001b\n\nZ\n\n\u001a\n\n\u0010\n\n\u0011\u03c4 \u001b\n\n1\nI2 =\nexp i\u03c6 \u03bb,~\u03b6 k, ~k\n(s\u22121)d\n\u033a\n0\n[\u2212\u03c0,\u03c0]\n\u0010\n\u0010\n\u0011\u0011\n\u0010\n\u0011i\nh\n(s)\n\u2207k \u03c7\u03bb,~\u03b6 k, ~k M1,\u03b6 \u2032 (k\u2032 ) . . . Ms,\u03b6 (s) k(s) k, ~k\nd\u0303(s\u22121)d~kd\u03c4 1 ,\n\nZ\n\n\u03c4\n\n1\nI3 =\nexp i\u03c6 \u03bb,~\u03b6 k, ~k\n(s\u22121)d\n\u033a\n0\n[\u2212\u03c0,\u03c0]\n\u0010\n\u0010\n\u0011\u0011\n\u0010\n\u0011\n(s)\n\u03c7\u03bb,~\u03b6 k, ~k M1,\u03b6 \u2032 (k\u2032 ) . . . \u2207k Ms,\u03b6 (s) k(s) k, ~k\nd\u0303(s\u22121)d~kd\u03c4 1 .\n\nBy (5.5)\n\nMj,\u03b6 (j) k(j)\n\n\u0001\n\n(j)\n\nL1\n\n\u2264 C\u03c4 i C\u039e2i\n\n(j) +e(j)\n\n(j)\n\nC\u03c7i Rmj , j = 1, . . . , s.\n\n(5.75)\n\nUsing (3.5), (5.75), (5.72) and the induction assumption we get\n(s)\n\n|I3 | \u2264 \u03c7\n\ns\u22121\nY\nj=1\n\n(j)\n\nMj,\u03b6 (j) k\n\n\u0001\n\nE\n\nZ\n\n0\n\n\u03c4\n\n\u2207k Ms,\u03b6 (s)\n64\n\nE\n\nd\u03c4 1 \u2264 CC1m Rm\u22121 \u03c4 i C\u039e2i+e C\u03c7i \u03b2 \u22121\u2212\u01eb . (5.76)\n\n\f\u0010\n\u0011\nFrom (5.75) and the smoothness of \u03c7(s) k, ~k we get\n\n|I2 | \u2264 C\u03b2 \u22121\u2212\u01eb \u03c4 i C1m C\u039e2i+e C\u03c7i Rm .\n\n(5.77)\n\nNow we estimate I1 . Using (3.9) we obtain\n\u0014\n\u001a\n\u0010\n\u0011 \u03c4 \u001b\u0015\n1\n~\nI1 =\nexp i\u03c6 \u03bb,~\u03b6 k, k\n\u033a\n0\n[\u2212\u03c0,\u03c0](s\u22121)d\n\u0010\n\u0011\u0011i\n\u0010\n\u03c41 h\n\u2212\u03bb\u2207k \u03c9 (k) + \u03b6 (s) \u2207k \u03c9 k(s) k, ~k\n\u033a\n\u0010\n\u0011\u0011\n\u0010\n\u0010\n\u0011\n(s)\n(s)\n\u2032\n~\n~\n\u2032\nk, k d\u0303(s\u22121)d~kd\u03c4 1 .\n\u03c7\u03bb,~\u03b6 k, k M1,\u03b6 (k ) . . . Ms,\u03b6 (s) k\nZ\n\n\u03c4\n\nZ\n\n(5.78)\n\nThe difficulty in the estimation of the integral I1 comes from the factor \u03c4\u033a1 since \u033a is small.\n\u0010\n\u0011\nNote that according to (2.46) \u03b2 2 /\u033a \u2264 C. Since M F , T, ~\u03bb, ~\u03b6 is FM, its every submonomial\nis FM too and we can apply to them Corollary 5.13, which yields\n\u0001\nMj,\u03b6 (j) k(j) = 0 for k(j) \u2212 \u03b6 (j) k\u2217 > mj \u03c0 0 \u03b2 1\u2212\u01eb , j = 1, . . . , s.\n\nHence, it is sufficient to estimate I1 for.\n\nk(j) \u2212 \u03b6 (j) k\u2217 \u2264 \u03b4 1 = m\u03c0 0 \u03b2 1\u2212\u01eb for all j.\nAccording to Lemma 5.15, since ~\u03bb, ~\u03b6 are FM\n\u0010\n\u0011\u0011\u0011i\n\u0010\n\u0011 h\n\u0010\u0010\n= 0.\n\u2207k \u03c6\u03bb,~\u03b6 \u03bbk\u2217 , ~k\u2217 = \u2212\u03bb\u2207k \u03c9 (k\u2217 ) + \u03b6 (s) \u2207k \u03c9 k(s) k\u2217 , ~k\u2217\n\n(5.79)\n\n(5.80)\n\nUsing (5.68) we conclude that in a vicinity of k\u2217 defined by (5.79) we have\n\u0010\n\u0011\u0011i\nh\n\u0010\n\u2212\u03bb\u2207k \u03c9 (k) + \u03b6 (s) \u2207k \u03c9 k(s) k, ~k\n\u2264 2 (s + 1) C\u03c9,2 \u03b4 1 .\nThis yields the estimate\n\n|I1 | \u2264 CC\u039e2i+e \u03c4 i C\u03c7i C1m \u03b2 \u22121\u2212\u01eb m2 Rm .\n\n(5.81)\n\nCombining (5.81), (5.77) and (5.76) we obtain (5.71) and the induction is completed. Now we\nconsider the case when Condition 2.23 holds and the monomial is AFM. Note that according\nto Corollary 5.13 the submonomials Mj,\u03b6 (j) have supports near \u03bd j k\u2217 , with an odd \u03bd j . By\nLemma 5.12 the monomial itself is non-zero near \u03bdk\u2217 , \u03bd = \u03bd 1 + . . . + \u03bd s ; since s is odd \u03bd is\nodd too. Obviously, one of \u03bd j has the same sign as \u03bd, we assume that j = s, that is\nsign (\u03bd s ) = sign (\u03bd 1 + . . . + \u03bd s ) = sign (\u03bd) ,\n\n65\n\n(5.82)\n\n\fthe general case can be reduced to this by a relabeling of variables. The interaction phase\nfunction is given by (5.64) and since the submonomials are AFM (5.65) holds. According to\n(2.16) \u2207k (\u03c9 (\u2212k)) = \u2212 (\u2207k \u03c9) (k). Therefore, using (2.95) we obtain\n\u0010\n\u0011\n\u2207k \u03c6\u03bb,~\u03b6 \u03bdk\u2217 , ~k\u2217 = \u03bb\u2207k \u03c9 (\u03bdk\u2217 ) \u2212 \u03b6 (s) \u2207k \u03c9 (\u03bd s k\u2217 ) =\n\u03bb (\u2207k \u03c9) (sign (\u03bd) |\u03bd| k\u2217 ) \u2212 \u03b6 (s) \u2207k \u03c9 (sign (\u03bd s ) |\u03bd s | k\u2217 )\n\u0010\n\u0011\n(s)\n(s)\n= \u03bb (\u2207k \u03c9) (sign (\u03bd) k\u2217 ) \u2212 \u03b6 \u2207k \u03c9 (sign (\u03bd s ) k\u2217 ) = \u03bbsign (\u03bd) \u2212 \u03b6 sign (\u03bd s ) (\u2207k \u03c9) (k\u2217 ) .\n\nUsing (5.65) we conclude that\n\n\u0010\n\u0011\n\u2207k \u03c6\u03bb,~\u03b6 \u03bdk\u2217 , ~k\u2217 = 0, ~k\u2217 = (\u03bd 1 k\u2217 , . . . , \u03bd s k\u2217 ) .\n\n(5.83)\n\nUsing (5.83) instead of (5.80) we conclude as in the first half of the proof that (5.71) holds\nin the AFM case too.\n\n5.4\n\nProperties of minimal CI monomials\n\nHere we consider CI evaluated monomials with arguments involving different wavepackets h\u0303l .\nSince the group velocities of wavepackets are different, namely (2.41) is satisfied, there exists\np0 > 0 such that\n|\u2207\u03c9 (k\u2217l1 ) \u2212 \u2207\u03c9 (k\u2217l2 )| \u2265 p0 > 0 if l1 6= l2 .\n(5.84)\nThe next lemma is a standard implication of the Stationary Phase Method in the case when\nthe phase function has no critical points in the domain of integration, namely when (2.41)\nholds.\nLemma 5.22 Let k\u2217l and \u03c9 n be generic in the sense of Definition 2.24. Let F (m) be defined\nby (3.4), m (\u03b2) be as in (5.23). We assume that (2.28) and (2.41) hold. We\u0010also assume\n\u0011 that\n(5.19), (5.56), (2.34), (2.35) and (2.46) hold. We assume that M (F , T ) h\u0303l1 . . . h\u0303lm is a\nmonomial with homogeneity index m evaluated\u0010 at arguments\n\u0011 with CI multiindex l1 , . . . , lm ,\nbut every evaluated submonomial of M (F , T ) h\u0303l1 . . . h\u0303lm is SI. Then for m \u2264 m (\u03b2) and\nsmall \u03b2\n\u0014\n\u0015\n\u0011\n\u0010\nC i\u22121 2i+e 2m i \u033a |ln \u03b2|\n\u2264 \u03c4 \u2217 C\u039e 3 C\u03c7\nM (F , T ) h\u0303l1 . . . h\u0303lm\n+ \u03b2 m2 Rm\u22121 ,\n(5.85)\np0\nE\n\u03b2 1+\u01eb\nwhere i and e are respectively the incidence number and number of edges of T , R is as in\n(5.19).\nProof. Since k\u2217l are not band-crossing points, the relations\n\u0010 (5.69)\u0011and (5.68) hold. We\nexpand M (F , T ) into a sum of decorated monomials M F , T, ~\u03bb, ~\u03b6 as in (4.51), which\n66\n\n\fcontains no more than 3i(T )+m terms, and i (T ) + m \u2264 2m. The submonomials of every\ndecorated monomial are SI by the assumption of the theorem. If Condition 2.13 holds, the\nsubmonomials are either FM or NFM; if Condition\n\u0011 the submonomials are either\n\u0010 2.23 holds,\n\u2032 \u2032\n\u2032 ~ ~\nAFM or ANFM. If a decorated submonomial M F , T , \u03bb , \u03b6 is NFM we use Theorem 5.18\nand obtain from (5.61) the inequality\n\u0010\n\u0011\u0010\n\u0011\n\u2032 \u2032\n\u2032\n\u2032\n\u2032\n\u2032\n\u2032\n(5.86)\nM F , T \u2032, ~\u03bb , ~\u03b6\nh\u0303lj\u2032 +1 . . . h\u0303lj\u2032 +m\u2032\n\u2264 C\u033a\u03c4 i\u2217 \u22121 [1 + m] C\u039e2i +e C\u03c7i Rm ,\nE\n\nwhere i\u2032 and e\u2032 are the incidence number and number of edges\nT \u2032 . Alterna\u0011\n\u0010 of the\u2032 subtree\n\u2032\ntively, if Condition 2.23 holds, and .a decorated monomial M F , T \u2032, ~\u03bb , ~\u03b6 is ANFM, we use\nTheorem 5.20 and obtain from (5.61) the inequality (5.86). Using (5.86) in both cases we\nobtain\n\u0011\n\u0010\n\u0011\u0010\n2i+e i\n~\n~\n\u2264 C\u033a\u03c4 i\u22121\nC\u03c7 mRm .\n(5.87)\nM F , T, \u03bb, \u03b6 h\u0303l1 . . . h\u0303lm\n\u2217 C\u039e\nE\n\u0010\n\u0011\nNow we consider the case when Condition 2.13 holds and every submonomial of M F , T, ~\u03bb, ~\u03b6\nis FM. We write the integral with respect to \u03c4 1 in (5.59) as a sum of two integrals from 0 to\n\u03b2 and from \u03b2 to \u03c4 , namely\n(s)\n\nF\u03b6,~\u03b6 (M1 . . . Ms ) (k, \u03c4 ) = F1 + F2 ,\n\u001a\nZ \u03c4Z\nZ \u03b2\n\u0010\n\u0011\u03c4 \u001b\n\u0010\n\u0011\n1\n(s)\n(s\u22121)d~\n~\n~\nexp i\u03c6\u03b6,~\u03b6 k, k\nF1 =\nA\u03b6,~\u03b6 k, k d\u0303\nkd\u03c4 1 , F2 =\n. . . d\u03c4 1\n\u033a\n\u03b2\nDm\n0\nwhere\n\n(s)\n\nA\u03b6,~\u03b6\n\n(m)\n\n\u0010\n\u0011\n\u0010\n\u0011\n\u0001\n(s)\nk, ~k = \u03c7\u03b6,~\u03b6 k, ~k M1 (k\u2032 ) . . . Ms k(s) ,\n\n(5.88)\n\n(5.89)\n\nMj are submonomials of M. According to Corollary 5.2 with \u03c4 \u2217 = \u03b2\nkF2 kL1 \u2264\n\n2C\u039e1+2s C\u03c7 \u03b2\n\ns\nY\nj=1\n\nkMj kE \u2264\n\n\u03b2C\u039ee+2i \u03c4 i\u22121\n\u2217 C\u03c7\n\nm\nY\nj=1\n\nh\u0303lj\n\nE\n\nm\n\u2264 \u03b2C\u03c7 C\u039ee+2i \u03c4 i\u22121\n\u2217E R .\n\n(5.90)\n\nNow we estimate\n, T ) is CI, there are two SI submonomials Mj1 and Mj2\n\u0010\n\u0011mF1 1 . Since\n\u0010 M\n\u0011m(F\n2\napplied to h\u0303lj1\nand h\u0303lj2\nwith lj1 6= lj2 . Let us assume that lj1 = l1 , lj2 = ls (the\ngeneral case can be easily reduced to it by a relabeling of variables). We denote\n\u0010\n\u0011\n\u03c6\u2032 = \u2207k\u2032 \u03c6\u03b6,~\u03b6 k, ~k\u2217 = \u2207k\u2032 \u03c9 (k\u2217l1 ) \u2212 \u2207k(s) \u03c9 (k\u2217ls ) 6= 0, p = \u03c6\u2032 / |\u03c6\u2032 | .\n(5.91)\nBy (5.84) and (5.43) we obtain\n\u0010\n\u0011\np*\u2207k\u2032 \u03c6\u03b6,~\u03b6 k, ~k\u2217 \u2265 p0 > 0 for ~k = ~k\u2217 = (k\u2217l1 , . . . , k\u2217ls ) .\n67\n\n(5.92)\n\n\fNote that\n\u001a\n\nexp i\u03c6\u03b6,~\u03b6\n\n\u0010\n\n\u001a\n\u0011\u03c4 \u001b\n\u0010\n\u0011\u03c4 \u001b\n\u033a\n1\n~\n~\n\u0010\n\u0011 p*\u2207k\u2032 exp i\u03c6\u03b6,~\u03b6 k, k 1 .\nk, k\n=\n\u033a\n\u033a\n~\nip*\u2207k\u2032 \u03c6\u03b6,~\u03b6 k, k \u03c4 1\n\nUsing this identity, (2.25) and integrating by parts the integral which defines F1 in (5.88)\nwe obtain\n\u001a\nZ \u03c4\nZ\n\u0010\n\u0011\n\u0010\n\u0011\u03c4 \u001b\n1\n(s)\n~\nA\u03b6,~\u03b6 k, ~k d\u0303(s\u22121)d~k = (5.93)\nexp i\u03c6\u03b6,~\u03b6 k, k\nF1 =\nI (k, \u03c4 1 ) d\u03c4 1 , I (k, \u03c4 1 ) =\n\u033a\n\u03b2\nDm\nn\n\u0010\n\u0011 o\n\u0010\n\u0011\n(s)\nZ \u033a exp i\u03c6 ~ k, ~k \u03c4 1\n~k\nA\nk,\n\u03b6,\u03b6\n\u033a\n\u03b6,~\u03b6\n\u0010\n\u0011 d\u0303(s\u22121)d~k.\n\u2212\np*\u2207k\u2032\ni\u03c4\n~\n1\nDs\n\u2207k\u2032 \u03c6\u03b6,~\u03b6 k, k * p\n\nFrom (5.56), Lemma 5.12 and Corollary 5.13 we see that in the integral I (k, \u03c4 1 ) the integrands are nonzero only if\n\u2264 mj \u03c0 0 \u03b2 1\u2212\u01eb , |k \u2212 \u03b6k\u2217 | \u2264 m\u03c0 0 \u03b2 1\u2212\u01eb , m1 + . . . + ms \u2264 m,\nk(j) \u2212 \u03b6 (j) k(j)\n\u2217\n\n(5.94)\n\nwhere \u03c0 0 \u2264 1. Using the Taylor remainder estimate for \u03c6\u03b6,~\u03b6 at ~k\u2217 we obtain the inequality\n\u0010\n\u0011\n\u2207k\u2032 \u03c6\u03b6,~\u03b6 k, ~k \u2212 \u03c6\u2032 \u2264 3m\u03b2 1\u2212\u01eb C\u03c9,2 if (5.94) holds.\n(5.95)\n\nSuppose that \u03b2 is small and satisfies\n\n3m\u03b2 1\u2212\u01eb C\u03c9,2 \u2264\n\np0\n.\n2\n\n(5.96)\n\nCondition (5.96) is satisfied for small \u03b2 if m \u2264 m (\u03b2) as in (5.23). Using (5.95) we derive\nfrom (5.92), (5.96) and (5.56) that\n\u0010\n\u0011\np0\n> 0 if (5.94) holds.\n(5.97)\np*\u2207k\u2032 \u03c6\u03b6,~\u03b6 k, ~k \u2265\n2\nNow we use (5.97) to estimate denominators, (5.68) to estimate second k\u2032 -derivatives of \u03c9\nand (5.69) to estimate \u2207k\u2032 \u03c7. We conclude that\nZ \u0014\n\u0010\n\u0011\n\u0010\n\u0011\u0015\n\u033a\n8\u033aC\n\u03c9,2\n(s)\n(s)\n2s+1\n|I (k, \u03c4 1 )| \u2264 C\u039e\n\u2207k\u2032 A\u03b6,~\u03b6 k, ~k +\nk, ~k\nd\u0303(s\u22121)d~k\n(5.98)\nA\u03b6,~\u03b6\n2\n(m)\n\u03c4\np\n\u03c4\np\n1 0\n1 0\nDs\n\u0014\n\u0015\ns\nY\n8C\u03c9,2 (m)\n\u033a\n2s+1\n(s)\n(\u2207k\u2032 \u2212 \u2207k(s) ) \u03c7 (k, *) +\n\u03c7 (k, *) C\u039e\nkMj kL1 +\n\u2264\n\u03c4 1 p0\np0\nj=1\n#\n\" s\ns\u22121\n2s+1\n(s)\nY\n\u033aC\u039e\n\u03c7 (k, *) Y\nkMj kL1 k\u2207k(s) Ms kL1 .\nkMj kL1 k\u2207k\u2032 M1 kL1 +\n\u03c4 1 p0\nj=1\nj=2\n68\n\n\fTo estimate \u2207Mi we use Lemma 5.21. We also use (5.2) and (5.5) to estimate kMj kL1 .\nTherefore, using (5.72), we obtain\n|I (k, \u03c4 1 )| \u2264\n\nC i\u22121 2i+e i \u033a\n\u03c4 C\u039e C\u03c7 1+\u01eb m2 Rm\u22121 .\n\u03c41 \u2217\n\u03b2 p0\n\n(5.99)\n\nFinally, we consider the case when the alternative Condition 2.23 holds. In this case M1 and\nMs according to Lemma 5.12 are localized near \u03bd 1 k\u2217l1 and \u03bd 2 k\u2217ls with some \u03bd 1 and \u03bd 2 ; we\nuse (2.94) to obtain (5.92) both for AFM and ANFM submonomials. Therefore (5.97) holds\nand we again get (5.98) and (5.99). So, we proved (5.99) in all cases. Integrating (5.99) in\n\u03c4 1 we obtain\n\u033a\n2i+e i\nkF1 kE \u2264 C\u03c4 i\u22121\nC\u03c7 1+\u01eb m2 |ln \u03b2| Rm\u22121 .\n(5.100)\n\u2217 C\u039e\n\u03b2 p0\nUsing summation over all ~\u03bb, ~\u03b6 (the sum involves no more than 32m terms) we obtain (5.85)\nfrom (5.87) and (5.100).\n\n6\n\nProof of the superposition theorems\n\nIn this section we prove Theorems 2.15, 2.19 on the approximate modal superposition principle.\n\n6.1\n\nProof of the Superposition principle for lattice equations\n\nHere we prove Theorem 2.15. First we note that according to Lemma 5.6 we can replace\nh\u0303l by h\u0303\u03a8\nl in the statement of Theorem 2.15, in particular in (2.47), (2.48). Hence we can\nassume that (5.56) holds.\nBased on Theorem 5.4 we expand the solution of (2.3) into series (5.8) and then into\nthe sum of composition monomials M (F , T ) as in (4.33):\n\u221e X\n\u0010 \u0011\n\u0010\n\u0011\nX\ncT M (F , T ) h\u0303m ,\nG F , h\u0303 = h\u0303 +\n\n(6.1)\n\nm=2 T \u2208Tm\n\nwhere\nh\u0303 =\n\nNh\nX\n\nh\u0303l ,\n\nh\u0303l\n\nl=1\n\nE\n\n\u2264 R, l = 1, . . . , Nh ,\n\n(6.2)\n\nand the relation (5.19) (that is Nh R < RG ) holds, where RG is the radius of convergence\nfrom Theorem 5.4, R will be specified below. Using Lemma 5.7 we conclude that\nm(\u03b2)\n\u0010 \u0011\n\u0011\nX X\ncT M (F , T ) h\u0303m + g, kgkE \u2264 \u03b2,\nG F , h\u0303 = h\u0303 +\n\n\u0010\n\nm=2 T \u2208Tm\n\n69\n\n(6.3)\n\n\f\u0010 \u0011\nwhere m (\u03b2) is defined by (5.23). Then we expand every monomial M (F , T ) h\u0303m according\n\u0011\n\u0010\nto (5.28) into the sum of the terms M (F , T ) h\u0303l1 . . . h\u0303lm . Note that since m (\u03b2) \u2264 C |ln \u03b2|,\nconditions (5.96), (5.70),\n\u0011 satisfied if \u03b2 is small enough for every m \u2264 m (\u03b2). The\n\u0010 (5.47) are\nmonomials M (F , T ) h\u0303l1 . . . h\u0303lm belong to two classes, SI and CI (according to Definition\n \u0304 Using (6.3) we conclude\n5.8) and the class is determined by the multiindex (l1 , . . . , lm ) = l.\nthat\n!\nNh\nNh\n\u0010\n\u0011\nX\nX\nG F , h\u0303l + D\u0303,\n(6.4)\nh\u0303l =\nG F,\nl=1\n\nl=1\n\nm(\u03b2)\n\nD\u0303 =\n\nX\n\nX X\n\nm=2 T \u2208Tm CI l1 ,...,lm\n\n\u0011\n\u0010\ncT M (F , T ) h\u0303l1 . . . h\u0303lm + g1 , kg1 kE \u2264 C\u03b2.\n\nTo obtain (2.48) we have to estimate the sum in D\u0303 and show that it is small. It follows from\n(4.35) that\nm(\u03b2)\n\nX X\n\nX\n\nm=2 T \u2208Tm CIl1 ,...,lm\nm(\u03b2)\n\n\u2264\n\nX\n\nNhm\n\nm=2\nm(\u03b2)\n\n\u2264\n\nX\n\nm=2\n\nX\n\ncT\n\nT \u2208Tm\n\nNhm c0 cm\n1\n\n\u0011\n\u0010\ncT M (F , T ) h\u0303l1 . . . h\u0303lm\n\nsup\nT \u2208Tm ,CIl\u0304\n\nsup\n\n\u2264\nE\n\n\u0011\n\u0010\nM (F , T ) h\u0303l1 . . . h\u0303lm\n\u0010\n\nM (F , T ) h\u0303l1 . . . h\u0303lm\n\nT \u2208Tm ,CIl\u0304\n\n\u0011\n\nE\n\nE\n\n\u2264\n\n.\n\n\u0011\n\u0010\nNow we consider an evaluated monomial M (F , T ) h\u0303l1 . . . h\u0303lm with arguments given by CI\nmultiindex  \u0304l = (l1 , . . . , lm ). To prove that this monomial has a small norm, according to\nLemma 4.24 it is sufficient to show that one of its submonomials is small and \u0010the relevant\n\u0011\noperators are bounded. According to Proposition 5.9 the monomial M (F , T ) h\u0303l1 . . . h\u0303lm\n\u0010\n\u0011\ncontains a submonomial M (F , T \u2032 ) h\u0303ls\u2032 . . . h\u0303ls\u2032\u2032 with the homogeneity index s = s\u2032\u2032 \u2212 s\u2032 + 1,\n\u2032\n\u2032\nthe incidence\n\u0010 number i\u0011and the rank r which is minimal in the following\n\u0010 sense. The\n\u0011 monomial\n\u2032\n\u2032\u2032\nM (F , T ) h\u0303ls\u2032 . . . h\u0303ls\u2032\u2032 is CI, but every its submonomial M (F , T ) h\u0303ls\u2032\u2032 . . . h\u0303ls\u2032\u2032\u2032 is SI. Now\n\u2032\nwe use the space decomposition (5.1)\n\u0011 in (4.44) into a sum of no more\n\u0010 and expand\n\u0011 \u0010M (F , T ) as\n2m\n\u2032 ~ ~\nthan 3 decorated monomials M F , T , \u03bb, \u03b6 h\u0303ls\u2032 . . . h\u0303ls\u2032\u2032 . The decorated submonomials\nof every decorated monomial are SI. We apply Lemma 5.22 and conclude that\n\u0014\n\u0015 2\n\u0011\n\u0010\n\u0011\u0010\n\u033a\ns i\u2032 \u22121 e\u2032 +2i\u2032 i\u2032 s\u2032\u2032 \u2212s\u2032\n\u2032 ~ ~\nM F , T , \u03bb, \u03b6 h\u0303ls\u2032 . . . h\u0303ls\u2032\u2032\n\u2264 C 1+\u01eb |ln \u03b2| + \u03b2\nC\u03c7 R\n.\n(6.5)\n\u03c4\nC\u039e\nE\np0 \u2217\n\u03b2\n70\n\n\f\u0011\n\u0010\nHence, there is a submonomial of M (F , T ) h\u0303l1 . . . h\u0303lm with a small norm. Namely, since\n(2.46) and (2.5) are assumed, this\nprovides the smallness of the norm of\n\u0011\n\u0010 small submonomial\nthe whole monomial M (F , T ) h\u0303l1 . . . h\u0303lm according to Lemma 4.24. We also use Corollary\n5.2 and (2.26) to estimate norms of remaining submonomials of rank r and apply (4.32) and\n(5.72) to obtain\n\u0014\n\u0015\n\u0011\n\u0010\n\u033a\ne+2i i m\u22121\n2m\n\u22643\nM (F , T ) h\u0303l1 . . . h\u0303lm\n|ln \u03b2| + \u03b2 C1 m2 \u03c4 i\u22121\nC\u03c7 R\n.\n(6.6)\n\u2217 C\u039e\n\u03b2 1+\u01eb\nSince e = i + m \u2212 1, using (4.25) and the inequalities i (T ) = i \u2265 m/mF , i \u2264 m \u2212 1 we get\nm(\u03b2)\n\nX X\n\nX\n\nm=2 T \u2208Tm CIl1 ,...,lm\n\n\u2264 C2\n\n\u0014\n\n\u033a\n\n\u03b2 1+\u01eb\n\n\u0011\n\u0010\ncT M (F , T ) h\u0303l1 . . . h\u0303lm\n\n|ln \u03b2| + \u03b2\n\n\u0015X\n\u221e\n\n(6.7)\n\nm\u22121\nF \u22121\n\u03c4 m/m\nm2 Nhm cm\n\u2217\n1 R\n\nm=2\n\nwith c1 = 9C\u039e5 C\u03c7 . The series converges if, in addition to (5.19), R satisfies the inequality\nF\nRNh c1 \u03c4 1/m\n< 1.\n\u2217\n\nFor such R and \u03c4 \u2217 , combining (6.7) with (6.3) and using (2.46) we obtain (2.48), and the\nTheorem 2.15 is proved.\n\n6.2\n\nProof of the Superposition principle for PDE\n\nHere we prove Theorem 2.25 (and its particular case Theorem 2.19). The proof is completely\nsimilar to the above proof of Theorem 2.15 up to every detail. One only have to replace Dm\ngiven by (2.23) by Dm given by (2.65) and the space L1 is now defined by (2.66) instead of\n(2.31).\nRemark 6.1 Note that smallness of CI terms is essential and is based on different group\nvelocities of single band wavepackets. Note that separation of different wavepackets based\nonly on FM and NFM arguments as in Lemma 5.17 is impossible since there are always FM\nmonomials with different l because of the symmetry conditions (2.15), (2.16), for example\nFM condition\n\u03b6\u03c9 n,\u03b6 (\u03b6k\u2217 ) \u2212 \u03b6 \u2032 \u03c9 n\u2032 (\u03b6 \u2032 k\u22171 ) \u2212 \u03b6 \u2032\u2032 \u03c9 n\u2032\u2032 (\u03b6 \u2032\u2032 k\u22172 ) \u2212 \u03b6 \u2032\u2032\u2032 \u03c9 n\u2032\u2032\u2032 (\u03b6 \u2032\u2032\u2032 k\u22173 ) = 0\nis fulfilled if\nn = n\u2032 , \u03b6 = \u03b6 \u2032 , k\u2217 = k\u22171 , n\u2032\u2032 = n\u2032\u2032\u2032 , \u03b6 \u2032\u2032 = \u2212\u03b6 \u2032\u2032\u2032 , k\u22172 = k\u22173\nindependently of the values of k\u2217 , k\u22173 and independently of a particular form of functions\n\u03c9 n (k).\n71\n\n\f7\n7.1\n\nExamples and possible generalizations\nFermi-Pasta-Ulam equation\n\nFPU equation on the infinite lattice has the form\n\u2202t2 xn = (xn\u22121 \u2212 2xn + xn+1 ) + \u03b13 (xn+1 \u2212 xn )3 \u2212 (xn \u2212 xn\u22121 )3\n\u0001\n+\u03b12 (xn+1 \u2212 xn )2 \u2212 (xn \u2212 xn\u22121 )2 .\n\n\u0001\n\n(7.1)\n\nIt can be reduced to the following first-order equation\n\n\u2202t xn = yn \u2212 yn\u22121 , \u2202t yn = xn+1 \u2212 xn + \u03b13 (xn+1 \u2212 xn )3 + \u03b12 (xn+1 \u2212 xn )2 .\n\n(7.2)\n\nWe introduce lattice Fourier transforms x\u0303 (k) and \u1ef9 (k) by (2.2), namely\nX\nx\u0303 (k) =\nxn e\u2212ink , k \u2208 [\u2212\u03c0, \u03c0] .\nn\n\nFirst we write Fourier transform of the linear part of (7.2) (that is with \u03b13 = \u03b12 = 0).\nMultiplying by e\u2212ink and doing summation we obtain\n\u2202t x\u0303 (k) = \u1ef9 (k) \u2212 e\u2212ik \u1ef9 (k) , \u2202t \u1ef9 (k) = eik x\u0303 (k) \u2212 x\u0303 (k) .\nthat can be recast in the matrix form as follows\n\u0014 \u0015 \u0014\n\u0001\u2217 \u0015 \u0014 \u0015\nx\u0303\nx\u0303\n0\n\u2212 eik \u2212 1\n=\n\u2202t\n.\nik\n\u1ef9\n\u1ef9\ne \u22121\n0\nThe eigenvalues of the matrix are purely imaginary and equal i\u03c9 \u03b6 (k) with\n\u03c9 \u03b6 (k) = \u03b6 eik \u2212 1 = 2\u03b6 sin\n\nk\n, \u03b6 = \u00b1, \u2212\u03c0 \u2264 k \u2264 \u03c0.\n2\n\nThe eigenvectors are orthogonal and are given explicitly by\n#\n\"\n\u0015\n\u0014\ni\u03b6\n1\n1\ni\u03b6 eik \u2212 1\n=\u221a\n, \u03b6 = \u00b1, k 6= 0.\ng\u03b6 (k) = \u221a\neik \u22121\neik \u2212 1\n2 |eik \u2212 1|\n2 |eik \u22121|\n\n(7.3)\n\nNow let us consider nonlinear terms. Note that the lattice Fourier transform of the product\nx (n) z (n), n \u2208 Zd is given by the following convolution formula\nZ\n1\nx\nfz (k) =\nx\u0303 (s) z\u0303 (k \u2212 s) ds\n(7.4)\n(2\u03c0)d [\u2212\u03c0,\u03c0]d\n\nas in the case of the continuous Fourier transform. Note that\n\u0001\n^\nxn+1\n\u2212 xn (k) = eik \u2212 1 x\u0303 (k) ,\n72\n\n\fand, hence, the Fourier transform of the cubic term of the nonlinearity in (7.2) is\n\n1\n=\n(2\u03c0)2\n\nZ\n\nk \u2032 +k \u2032\u2032 +k \u2032\u2032\u2032 =k\n[\u2212\u03c0,\u03c0]2\n\n\u0010 \u2032\neik\n\n^\n(xn+1\n\u2212 xn )3 =\n(7.5)\n\u0011 \u0010 \u2032\u2032\n\u0011 \u0010 \u2032\u2032\u2032\n\u0011\n\u2212 1 eik \u2212 1 eik \u2212 1 x\u0303 (k \u2032 ) x\u0303 (k \u2032\u2032 ) x\u0303 (k \u2032\u2032\u2032 ) dk \u2032 dk \u2032\u2032 ,\n\nand similar convolution for the quadratic term.\n\n7.2\n\nExamples of wavepacket data\n\nHere we give examples of initial data for PDE in Rd and on the lattice Zd which are wavepackets in the sense of Definition 2.9. We define a wavepacket by (2.33) where h\u03b6 is chosen to\nsatisfy (2.35) and (2.34).\nRecall that a Schwartz function is an infinitely smooth function \u03a6 (r), r \u2208 Rd which\nrapidly decays and satisfies for every s \u2265 0 the inequality\nX\n|r|p |\u2202r\u03b1 \u03a6 (r)| dr \u2264 C1 (s) ,\n(7.6)\nsup\nr\n\n|\u03b1|+p\u2264s\n\nwhere\n\u2202r\u03b1 \u03a6 (r) = \u2202r\u03b111 . . . \u2202r\u03b1dd \u03a6 (r) , \u03b1 = (\u03b11 , . . . , \u03b1d ) , | \u03b1| = \u03b11 + . . . + \u03b1d .\nIt is well known that Fourier transform of a Schwartz function remains to be a Schwartz\nfunction and that its derivatives satisfy the inequality\nX\n(7.7)\nsup\n|k|p \u2202k\u03b1 \u03a6\u0302 (k) \u2264 C2 (s) .\nk\n\n|\u03b1|+p\u2264s\n\nExample 1. We consider equation in Rd as in Subsection 1.2. The simplest example of a\nwavepacket in the sense of Definition 2.9 is a function of the form (2.36) where\nZ\n(7.8)\n\u0125\u03b6 (k) + \u2207k \u0125\u03b6 (k) + |k|1/\u01eb \u0125\u03b6 (k) dk < \u221e, .\nRd\n\nand gn,\u03b6 (k) is an eigenvector from (2.13). Note that \u03b2 \u2212d \u0125\u03b6 (k/\u03b2) is the Fourier transform of\na function h\u03b6 (\u03b2r).\nLemma 7.1 Let \u0125 (\u03b2, k) , k \u2208 Rd be defined by (2.36), (7.8). Then \u0125l,\u03b6 (\u03b2, k)\n\u0001 is a wavepacket\nd\nwith wavepacket center k\u2217 in the sense of Definition 2.9 with L1 = L1 R .\nProof. First, condition (2.32) holds since\n\u0013\n\u0012\nZ\nZ\nk \u2212 \u03b6k\u2217\n\u2212d\n\u0125\u03b6 (k ) dk.\ngn,\u03b6 (k\u2217 ) dk = |gn,\u03b6 (k\u2217 )|\n=\n\u03b2\n\u0125\u03b6 (\u03b2, *)\n\u0125\u03b6\n\u03b2\nL1\nRd\nRd\n73\n\n\fCondition (2.33) is obviously fulfilled since\n\u0125\u03b6 (\u03b2, k) = \u03a0n,\u03b6 (k) h\u0303\u03b6 (\u03b2, k) .\nInequality (2.34) follows from the estimate\n\u0012\n\u0013\nZ\nZ\nk \u2212 \u03b6k\u2217\n\u2212d\n\u0125\u03b6\n\u03b2\ndk \u2264 \u03b2\n|k|1/\u01eb \u0125\u03b6 (k) dk \u2264 C\u03b2.\n\u03b2\n|k\u2212\u03b6k\u2217 |\u2265\u03b2 1\u2212\u01eb\n|k|\u2265\u03b2 \u2212\u01eb\n\n(7.9)\n\nTo verify (2.35) we note that since \u03a0n,\u03b6 (k) smoothly depend on k near \u03b6k\u2217 we have\nZ\n\u2207k \u0125\u03b6 (\u03b2, k) dk\n|k\u2212\u03b6k\u2217 |\u2264\u03b2 1\u2212\u01eb\n\u0012\n\u0013\n\u0013\n\u0012\nZ\nk \u2212 \u03b6k\u2217\nk \u2212 \u03b6k\u2217\n\u2212d\u22121\n\u2212d\n\u2264C\n\u03b2\n\u2207k \u0125l\n+\u03b2\ndk\n\u0125l\n\u03b2\n\u03b2\n|k\u2212\u03b6k\u2217 |\u2264\u03b2 1\u2212\u01eb\nZ\n\u22121\n\u2207k \u0125\u03b6 (k) dk + C\n\u2264 C\u03b2\nRd\n\nand (7.8) implies (2.35).\nExample 2. Let us consider a lattice equation in Zd as in Section 1.1. We would like to\ngive a sufficient condition for functions defined on the lattice which ensures that their Fourier\ntransforms satisfy all requirements of Definition 2.9. We pick a Schwartz function \u03a6 (r) (see\n(7.6)), a vector k\u2217 \u2208 [\u2212\u03c0, \u03c0]d and introduce\nh (\u03b2, r) = e\u2212ir*k\u2217 \u03a6 (\u03b2r) , r \u2208 Rd .\n\n(7.10)\n\nThen we restrict the above function to the lattice Zd by setting r = m. The following lemma\nis similar to Lemma 7.1.\nLemma 7.2 Let \u03a6 (r) be a Schwartz function, h\u03b6 (\u03b2, r) be defined by (7.10), h\u0303\u03b6 (\u03b2, k)\nbe its lattice Fourier transform. Then the function h\u0303\u03b6 (\u03b2, k) extended to Rd as\u0010a periodic\n\u0011\nfunction with period 2\u03c0 satisfies all requirements of Definition 2.9 with L1 = L1 [\u2212\u03c0, \u03c0]d .\nProof. The lattice Fourier transform of h (\u03b2, r) equals\nX\nX\nh\u0303 (\u03b2, k) =\ne\u2212im*k\u2217 \u03a6 (\u03b2m) e\u2212im*k =\n\u03a6 (\u03b2m) e\u2212im*(k\u2212k\u2217 ) .\nm\u2208Zd\n\n(7.11)\n\nm\u2208Zd\n\nSince the above expression naturally defines h\u0303 (\u03b2, k) as a function of k \u2212 k\u2217 , it is sufficient\nto take k\u2217 = 0. To get (2.34), we use the representation of \u03a6 (r) in terms of inverse Fourier\ntransform (2.60)\n\u0012 \u0013\nZ\nZ\n1\n1\n1\nir*k\nk eim*k dk.\n(7.12)\n\u03a6 (r) =\n\u03a6\u0302 (k) e dk, \u03a6 (\u03b2m) =\n\u03a6\u0302\nd\nd\n\u03b2\nd\nd\n(2\u03c0) R\n(2\u03c0\u03b2) R\n74\n\n\fWe split \u03a6 (\u03b2m) into two terms:\n\u0012\n\n\u0013\n1\n\u03a6 (\u03b2m) =\n\u03a8\n\u03be eim*\u03bed\u03be + \u03a61 (m) ,\n1\u2212\u01eb \u03be \u03a6\u0302\nd\n\u03b2\nd\n\u03b2\n(2\u03c0\u03b2) R\n\u0012\n\u0013\u0013 \u0012 \u0013\nZ \u0012\n1\n1\n1\n\u03a61 (m) =\n\u03be eim*\u03bed\u03be\n1\u2212\u03a8\n\u03a6\u0302\n1\u2212\u01eb \u03be\nd\n\u03b2\n\u03b2\n(2\u03c0\u03b2) Rd\n1\n\nZ\n\n1\n\n\u0013\n\n\u0012\n\n(7.13)\n\nwith \u03a8 (\u03be) defined by (5.12). The first term in (7.13) coincides with the inverse lattice Fourier\ntransform, its lattice Fourier transform\n\u0001 is explicitly given and can be treated as in Lemma\nN\n7.1. The second term gives O \u03b2\nwith large N for Schwartz functions \u03a6\u0302. Using these\nobservations we check all points of Definition 2.9 as in Lemma 7.1.\n\n7.3\n\nThe Nonlinear Maxwell equation\n\nWe expect that the approximate superposition principle can be generalized to the Nonlinear\nMaxwell equations (NLM) in periodic media studied in [4] . A concise operator form of the\nNLM is\ni\n\u2202\u03c4 U = \u2212 MU + FNL (U) \u2212 J0 , U (\u03c4 ) = 0 for \u03c4 \u2264 0,\n\u033a\nwhere the excitation current\nJ (\u03c4 ) = 0 for \u03c4 \u2264 0.\nWe were studying the properties of nonlinear wave interactions as described by the Nonlinear\nMaxwell equations in series of papers [1]-[6]. Our analysis of the solutions to the NLM uses\nan expansion in terms of orthonormal Floquet-Bloch basis G\u0303n,\u03b6 (r, k), n = 1, . . . ., namely\n\u0168 (k, r, \u03c4 ) =\n\n\u221e\nXX\n\n\u03b6=\u00b11 n=1\n\n\u0168n,\u03b6 (k, \u03c4 ) G\u0303n,\u03b6 (r, k) , k \u2208 [\u2212\u03c0, \u03c0]d .\n\n(7.14)\n\nThis expansion is similar to (2.18) with J replaced by \u221e, since the linear Maxwell operator in\na periodic medium has infinitely many bands. The excitation currents take the form similar\nto forcing term in (3.1), namely\ni\n\ni\n\nJ\u0303 (r, k, \u03c4 ) = j\u0303n,+ (k, \u03c4 ) G\u0303n,+ (r, k) e\u2212 \u033a \u03c9 n (k)\u03c4 + j\u0303n,\u2212 (k, \u03c4 ) G\u0303n,\u2212 (r, k) e \u033a \u03c9n (k)\u03c4 ,\nJ\u0303n (r, k, \u03c4 ) = 0, n 6= n0 ,\nwith a fixed n = n0 . The difference with (3.1) is that time-independent hn,\u03b6 (k) is replaced\nby j\u0303n,\u03b6 (k, \u03c4 ). The functions j\u0303n,\u03b6 (k, \u03c4 ) for every \u03c4 have the form of wavepackets in the sense\nof Definition 2.9, or in particular the form similar to (2.36) with fixed k\u2217 .\nThe Existence and uniqueness Theorem for the NLM is proven in [4], in particular\nfunction-analytic representation of the solution as a function of the excitation current. The\nresults of this paper can be extended to the NLM equations provided that certain technical\n75\n\n\fdifficulties are addressed. Particularly, the classical NLM equation allows for the time dispersion with consequent time-convolution integration in the nonlinear term. This complication\ncan be addressed\n\u0001 by approximating it with a nonlinearity of the form (2.22) with an error\n2\nO (\u033a) = O \u03b2 , see [6]. Then the derivation of the approximate linear superposition principle\nfor wavepackets can be done as in this paper. Another complication with the NLM is that it\nhas infinite number of bands.\n\n7.4\n\nDissipative terms in the linear part\n\nEquations (2.3) and (2.61) involve linear operators iL (k) with purely imaginary spectrum.\nQuite similarly we can consider equations of the form\n\u0014\n\u0015\n\u0010 \u0011\ni\n\u2202\u03c4 \u00db (k, \u03c4 ) = \u2212G (k) \u2212 L (k) \u00db (k, \u03c4 ) + F\u0302 \u00db (k, \u03c4 ) ,\n(7.15)\n\u033a\nwhere a Hermitian matrix G (k) commutes with the Hermitian matrix L (k) and G (k) is nonnegative. In this case the approximate superposition principle also holds. The proofs are quite\nsimilar. In the case (2.61), which corresponds to of PDE, G (k) determines a dissipative term,\nfor example G (k) = |k|2 I, k \u2208 Rd , where I is the identity matrix, corresponds to Laplace\noperator \u2206. When such a dissipative term is introduced, we can consider nonlinearities\nF\u0302 which involve derivatives, see [8], [9] in a similar situation. For such nonlinearities our\nframework remains the same, but some statements and proofs have to be modified. We will\nconsider this case in a separate paper.\n\n8\n\nAppendix A: Structure of a composition monomial\nbased on oscillatory integrals\n\n\u0011\u0010\n\u0011\n\u0010\nEvery composition monomial M F , T, ~\u03bb(\u015d) , ~\u03b6 (m) h\u03031 . . . h\u0303m based on oscillatory integral\n\noperators F (m) as defined by (3.14) and the space decomposition as defined by (5.1) has the\nfollowing structure. Let T be the tree corresponding to the monomial M. The monomial\ninvolves integration with respect to time variables \u03c4 (N ) where N \u2208 T are the nodes of the\ntree T . The monomial also involves \u0010integration with\u0011 respect to variables kN , N \u2208 T . The\nargument of the integral operator M F , T, ~\u03bb(\u015d) , ~\u03b6 (m) involves only end nodes (of zero rank)\nand has the form\nY\nh\u0303N (kN ) .\nrank(N )=0\n\n\u0011\n\u0010\n~\n~\nThe kernel of the integral operator involves the composition monomial M \u03c7, T, \u03bb(\u015d) , \u03b6 (m)\n\u0010\n\u0011\n(m)\nk, ~k(m) with the same tree T . Note that the\nbased on the susceptibilities tensors \u03c7\u03b6,~\u03b6\n(m)\n\n76\n\n\fphase matching condition (3.12) takes the form\n\u03bc(N )\n\nkN =\n\nk\u2032N\n\n+ ...+\n\n(\u03bc(N ))\nkN\n\n=\n\nX\n\nkci (N ) .\n\ni=1\n\nRecall that if ci (N), i = 1, . . . , \u03bc (N) is the i-th child node of N, then the arguments in\n(3.14) are determined by the formula\n(c )\n\nkci (N ) = kN i .\n\u0011\u0010\n\u0011\n\u0010\nHence, the kernel of the integral operator M F , T, ~\u03bb(\u015d) , ~\u03b6 (m) h\u03031 . . . h\u0303m involves the product of normalized delta functions\n\u0010\n\u0011\nY\n\u03b4 kN \u2212 kc1 (N ) \u2212 . . . \u2212 kc\u03bc(N) (N ) ,\nrank(N )>0\n\nand the integration with respect to kN is over the torus\n!\nY Z\nY\n[. . .]\ndkN ,\nN 6=N\u2217\n\n[\u2212\u03c0,\u03c0]\u03bc(N)d\n\nN 6=N\u2217\n\nand, obviously, the variable kN\u2217 corresponding to the root node N\u2217 is not involved into the\nintegration.\n\u0011\n\u0010\nSince every operator F (m) at a node N of the monomial M F , T, ~\u03bb(\u015d) , ~\u03b6 (m) contains the\noscillatory factor\n\u001a\n\u0010\n\u0011\u03c4 \u001b\n(N )\nexp i\u03c6 \u03b6,~\u03b6 (m),N k, ~k(m)\n=\n\u033a\n\u001a h\n\u0010\n\u0011i \u03c4 \u001b\n(N )\n(m)\n(m)\n\u2032\n\u2032\nexp i \u03b6 N \u03c9 (kN ) \u2212 \u03b6 N \u03c9 (kN ) \u2212 . . . \u2212 \u03b6 N \u03c9 kN\n,\n\u033a\n\nwe obtain the following total oscillatory factor\n\u001a\n\u0010\n\u0011\u001b\n1\n~\n,\nexp i \u03a6 \u03b6,~\u03b6 (m),T k, k(m)\n\u033a\n\u0010 \u0011\nwhere the phase function \u03a6 T,~\u03b6 ~k of the monomial is defined by the formula\n\uf8ee\n\uf8f9\n\u03bc(N )\n\u0010\n\u0011 X\nX (c (N ))\n\u0001\n\uf8f0\u03b6 N \u03c9 (k) \u2212\n\u03a6T,~\u03b6 ~k, ~\u03c4 =\n\u03b6 Ni\n\u03c9 kci (N ) \uf8fb \u03c4 (N ) .\n\n(8.1)\n\n(8.2)\n\ni=1\n\nN \u2208T\n\nThe vectors ~k, ~\u03c4 and ~\u03b6 are composed of kN , \u03c4 N and \u03b6 N using the standard labeling of the\nnodes.\n77\n\n\fNotice then that the oscillatory exponent (8.1) is the only expression in the composition\nmonomial which involves parameter \u033a. Observe also that the FM condition takes here the\nform\n\u03bc(N )\nX (c (N ))\n\u03b6N =\n\u03b6 Ni\n.\ni=1\n\nThe domain of integration with respect to time variables is given in terms of the tree T by\nthe following inequalities\n\b\nDT = \u03c4 (N ) : 0 \u2264 \u03c4 (N ) \u2264 \u03c4 (p(N )) , N \u2208 T \\ N\u2217\n(8.3)\nwhere p (N) is the parent node\n\u0010 of the node\u0011 N. Using introduced notations we can write the\naction of the monomial M F , T, ~\u03bb(\u015d) , ~\u03b6 (m) in the form\n\u0010\n\n\u0011\n\n\uf8eb\n\nM F , T, ~\u03bb, ~\u03b6 \uf8ed\n\u001a\n\nY\n\nrank(N )=0\n\n\uf8f6\n\nZ\n\nh\u0303N \uf8f8 (kN\u2217 , \u03c4 N\u2217 ) =\n\nDT\n\nY Z\n\nN 6=N\u2217\n\n[\u2212\u03c0,\u03c0]\u03bc(N)d\n\n\u0010\n\u0011\u001b \u0010\n\u0011 Y\n1\n~\nexp i \u03a6 T,~\u03b6 k, ~\u03c4\nM \u03c7, T, ~\u03bb, ~\u03b6, ~k\nh\u0303N (kN )\n\u033a\nrank(N )=0\n\u0010\n\u0011 Y\nY\nY\nd\u03c4 (N ) .\ndkN\n\u03b4 kN \u2212 kc1 (N ) \u2212 * * * \u2212 kc\u03bc(N) (N )\nN 6=N\u2217\n\nrank(N )>0\n\n!\n\n(8.4)\n\nN 6=N\u2217\n\nNote that m equals the number of end nodes, that is nodes with zero rank and they are\nnumerated using the standard labeling of the nodes, that is\nY\nh\u03031 (k1 ) * * * h\u0303m (km ) =\nh\u0303N (kN ) .\nrank(N )=0\n\nThe formula (8.4) gives a closed form of a composition monomial based on oscillatory integral\noperators F (m) with an arbitrary large rank.\n\n9\n\nAppendix B: Proof of the refined implicit function\ntheorem\n\nHere we give the proof of Theorem 4.25.\nFirst, we consider the following elementary problem which provides majorants for the\nproblem of interest. Let a function of one complex variable be defined by the formula\nF\u030c (u) = CF\n\n\u221e\nX\n\nm=2\n\nu\n\nm\n\nRF\u2212m\n\n= CF\n\n\u0014\n\n78\n\n\u0015\nu2 /RF2\n, CF > 0, RF > 0.\n1 \u2212 u/RF\n\n(9.1)\n\n\fIn this case F\u030c (m) (x1 . . . xm ) = CF RF\u2212m x1 . . . xm . Let us introduce the equation\nu = F\u030c (u) + x, u, x \u2208 C\n\n(9.2)\n\nwhich is a particular case of (4.1). A small solution u (x) of this equation such that u (0) = 0\nis given by the series\n\u221e\nX\nu = \u01e6 (x) =\n\u01e6(m) xm ,\nm=1\n\nwhich is a particular case of formula (4.14). The terms \u01e6(m) xm of this problem are determined\nfrom (4.18) and can be written in the form (4.29)\nX\n\u0001\ncT M F\u030c, T xm .\n(9.3)\n\u01e6(m) xm =\nT \u2208Tm\n\nObviously,\n\n\u0001\ni(T ) \u2212e(T )\nM F\u030c, T xm = CF RF xm\n\n(9.4)\n\nwhere i (T ) is the incidence number of the tree T , e (T ) is the number of edges of T . Now\nwe compare solution of the general equation (4.1). It is given by the formula (4.14) with\noperators G (m) (um ) admitting expansion (4.29). Since\nF (m) \u2264 CF RF\u2212m ,\nwhere the constants are the same as in (9.1) we have\n\u0001\nkM (F , T ) (x1 . . . x\u03bd )k \u2264 M F\u030c, T kx1 k . . . kx\u03bd k ,\n\nimplying\nX\nX\n\u0001\ncT M F\u030c , T kx1 k . . . kxm k = \u01e6(m) kx1 k . . . kxm k .\ncT kM (F , T ) (x1 . . . xm )k \u2264\nT \u2208Tm\n\nT \u2208Tm\n\n(9.5)\n\nSolving (9.2) we get explicitly\n\u0012\n\u0013\nr\nRF\nx\nCF\nu=\n1 \u2212 1 \u2212 4c\n= \u01e6 (x) , c =\n+ 1.\n2c\nRF\nRF\nWe have the following estimate of the coefficients\n\u0012\n\u0013m\nCF + RF\nRF2\n(m)\n4\n\u01e6 \u2264\n, m = 1, 2, . . . ,\n2 (CF + RF )\nRF2\n\n(9.6)\n\n(see [4] for details in a similar situation). From (9.4) and (9.6) we infer the following inequality\n\u0012\n\u0013m\nX\nCF + RF\nRF2\ni(T ) \u2212e(T )\n4\ncT CF RF\n\u2264\n2 (CF + RF )\nRF2\nT \u2208T\nm\n\nwhich hods for all CF , R\n\nF\n\n> 0. We set CF = RF = 1 and obtain the desired bound (4.35).\n79\n\n\f10\n\nNotations and abbreviations\n\nFor reader's convenience we provide below a list of notations and abbreviations used in this\npaper.\nAFM\u2013 alternatively frequency matched, see Definition 5.19\nANFM \u2013 alternatively non-frequency-matched see Definition 5.19\nband-crossing points \u2013 see Definition 2.3\ncc \u2013 complex conjugate to the preceding terms in the formula\ncomposition monomial \u2013 see Definition 4.9\ndecoration projections \u2013 see (4.36), (4.37)\ndecorated monomial \u2013 see Definition 4.20\nCI monomials \u2013 cross-interacting monomials, see Definition 5.8\nFPU, Fermi-Pasta-Ulam equation \u2013 (2.10), (2.11), (7.1)\nFloquet-Bloch modal decomposition \u2013 see (7.14)\nFourier transform \u2013 see (2.59)\nFM \u2013 frequency matched, see Definition 5.10 see also (5.42)\nhomogeneity index of a monomial Definition 4.9\nhomogeneity index of a tree \u2013 Definition 4.11\nincidence number of a monomial \u2013 number of occurrences of operators F (l) in the\ncomposition monomial\nincidence number of a monomial \u2013 see Definition 4.10\nincidence number of a tree \u2013 Definition 4.12\nlattice Fourier transform \u2013 see (2.2)\nmonomial \u2013 Definition 4.9\nNFM \u2013 non-frequency-matched see Definition 5.10, see also (5.46)\noscillatory integral operator \u2013 see (3.8), (3.3)\nrank of monomial \u2013 see Definition 4.9\nroot operator (4.20)\nSI monomials \u2013 self-interacting monomials, see Definition 5.8\nSchwartz functions \u2013 infinitely smooth functions on Rd which decay faster than any\npower, see (7.6)\nsingle-mode wavepacket \u2013 see Definition 2.9\nsubmonomial (4.10)\nwavepacket see Definition 2.9\n1\nd\u0303(m\u22121)~k = (2\u03c0)(m\u22121)d\ndk\u2032 . . . dk(m\u22121) \u2013 see (2.24)\nDm = [\u2212\u03c0, \u03c0](m\u22121)d \u2013 see (2.23) or Dm = R(m\u22121)d see (2.65)\nE = C ([0, \u03c4 \u2217 ] , L1 ) see (2.30)\nF\u0302 (m) \u2013 m-linear operator in L1 , see (2.22), (2.64)\n(m)\nFn,\u03b6,~n,~\u03b6 \u2013 basis element of the m-linear operator F (m) in E see (3.8)\n(n)\n\nF\u03bb,~\u03b6 \u2013 see (4.43)\n\n80\n\n\f2.9\n2.9\n\n\u0125\u03b6 (\u03b2, k) , \u03b6 = \u00b1 \u2013 Fourier transform of the wavepacket initial data h\u03b6 (\u03b2, r), see Definition\n\u0010 \u0011\n\u0125\u03b6 \u03b21 \u03be , \u03b6 = \u00b1 \u2013 Fourier transform of the wavepacket h\u03b6 (\u03b2r)initial data, see Definition\n\n1\u2212\u01eb\nh\u0303\u03a8\nvicinity of \u00b1k\u2217 , see (5.15)\nl (k, \u03b2) \u2013 a function nullified outside \u03b2\nd\nk = (k1 , . . . , kd ) \u2208 [\u2212\u03c0, \u03c0] - quasimomentum (wave vector) variable, (2.2), (2.25).\nk = (k1 , . . . , kd ) \u2208 Rd \u2013 Fourier wave vector variable, (2.59), (2.25).\nk\u2217 = (k\u22171 , . . . , k\u2217d ) \u2013 center of the wavepacket see Definition 2.9\nk\u2217l \u2013 center of l-th\n\u0001 wavepacket\n~k = k\u2032 , . . . , k(m) , \u2013 interaction multi-wave vector, (2.25), (3.7) .\n\u0010\n\u0011\n(s)\n~\nk\nk, k = k \u2212 k\u2032 \u2212 . . . \u2212 k(s\u22121) \u2013 see (2.25)\n\u0011\n\u0010\n\u0001\nL1 \u2013 Lebesgue space L1 [\u2212\u03c0, \u03c0]d or L1 Rd - see (2.31) and (2.66)\nn \u2013 band number\u0001\n~n = n\u0010\u2032 , . . . , n(m) \u2013 band\n\u0011 interaction index, (3.7)\n\n\u2207r =\n\n\u2202\n, \u2202 ,***\n\u2202r1 \u2202r2\n\n, \u2202r\u2202d\n\n\u2013 spatial gradient\n\nis bounded as \u03bc \u2192 0.\nO (\u03bc) \u2013 any quantity having the property that O(\u03bc)\n\u03bc\n\u03c9 n\u0304 (k) = \u03b6\u03c9 n (k) \u2013 dispersion relation of the band (\u03b6, n), see (2.13)\n\u03c9 \u2032n0 (k) = \u2207k \u03c9 n0 (k) \u2013 group velocity vector\n\u03c9 n (k)\u2013 n-th eigenvalue of L (k), see (2.13); dispersion relation of n-th band\n\u03a8 \u2013\u0010 cutoff\n\u0011 function in quasimomentum domain, see (5.12)\n\u0001\n~\n\u03c6~n k, k = \u03b6\u03c9 n (k) \u2212 \u03b6 \u2032 \u03c9 n\u2032 (k\u2032 ) \u2212 . . . \u2212 \u03b6 (m) \u03c9 n(m) k(m) \u2013 interaction phase function, (3.9)\n\u03c0 0 \u2013 see (5.13)\n\u03a0n,\u03b6 (k) \u2013 projection in C2J onto direction of gn,\u03b6 (k); see (2.19)\nr = (r1 , . . . , rd ) \u2013 spatial variable\n\u033a = \u03b2 2 \u2013 (2.46)\n\u03c3 \u2013 the set of band-crossing points, see Definition 2.3\n\u00db (k) \u2013 Fourier transform of U (r), see (2.59)\ni\u03c4\n\u0168n,\u03b6 (k, \u03c4 ) = \u0169n,\u03b6 (k, \u03c4 ) e\u2212 \u033a \u03b6\u03c9n (k) \u2013 amplitudes, see (3.2)\n\u03b6=\u00b1\n\u0010 or \u03b6 = \u00b11\u0011\u2013 band binary index.\n~\u03b6 = \u03b6 \u2032 , . . . , \u03b6 (m) \u2013 binary band index vector, see (3.7)\nZ \u2217 \u2013 complex conjugate to Z\nAcknowledgment: Effort of A. Babin and A. Figotin is sponsored by the Air Force\nOffice of Scientific Research, Air Force Materials Command, USAF, under grant number\nFA9550-04-1-0359.\n\n81\n\n\fReferences\n[1] Babin A. and Figotin A., Nonlinear Photonic Crystals: I. Quadratic nonlinearity, Waves\nin Random Media, 11, R31-R102, (2001).\n[2] Babin A. and Figotin A., Nonlinear Photonic Crystals: II. Interaction classification for\nquadratic nonlinearities, Waves in Random Media, 12, R25-R52, (2002).\n[3] Babin A. and Figotin A., Nonlinear Photonic Crystals: III. Cubic Nonlinearity, Waves\nin Random Media, 13, pp. R41-R69 (2003).\n[4] Babin A. and Figotin A., Nonlinear Maxwell Equations in Inhomogenious Media, Commun. Math. Phys. 241, 519-581 (2003).\n[5] Babin A. and Figotin A., Polylinear spectral decomposition for nonlinear Maxwell equations, in Partial Differential Equations, M.S. Agranovich and M.A. Shubin eds, Advances\nin Mathematical Sciences, American Mathematical Society Translations -Series 2, Vol.\n206, 2002, p. 1-28.\n[6] Babin A. and Figotin A., Nonlinear Photonic Crystals: IV Nonlinear Schrodinger Equation Regime, Waves in Random and Complex Media, Vol. 15, No. 2 (2005), pp. 145-228.\n[7] Babin A. and Figotin A., Wavepacket preservation under nonlinear evolution, submitted; e-print available online at arxiv.org arXiv:math.AP/0607723\n[8] Babin A., Mahalov A. and Nicolaenko B., Global regularity of 3D rotating Navier-Stokes\nequations for resonant domains, Indiana University Mathematics Journal vol. 48 no. 3\n(1999), p.1133-1176.\n[9] Babin A., Mahalov A. and Nicolaenko B, Fast Singular Oscillating Limits and Global\nRegularity for the 3D Primitive Equations of Geophysics, M2AN,v.34,no.2, 2000, p.201222.\n[10] Bambusi, D., Birkhoff normal form for some nonlinear PDEs, Comm. Math. Phys. 234\n(2003), no. 2, 253\u2013285.\n[11] Ben Youssef, W.; Lannes, D., The long wave limit for a general class of 2D quasilinear\nhyperbolic problems, Comm. Partial Differential Equations 27 (2002), no. 5-6, 979\u20131020.\n[12] Berman G.P, Izrailev F.M., The Fermi-Pasta-Ulam problem: 50 years of progress,\narXiv:nlin.CD\n[13] Bogoliubov N. N. and Mitropolsky Y. A., Asymptotic Methods In The Theory Of NonLinear Oscillations, Delhi, Hindustan Pub. Corp., 1961.\n[14] Bona, J. L.; Colin, T.; Lannes, D., Long wave approximations for water waves, Arch.\nRation. Mech. Anal. 178 (2005), no. 3, 373\u2013410.\n82\n\n\f[15] Bourgain, J., Global solutions of nonlinear Schr\u00f6dinger equations. American Mathematical Society Colloquium Publications, 46. American Mathematical Society, Providence,\nRI, 1999.\n[16] Cazenave T., Semilinear Schr\u00f6dinger equations. Courant Lecture Notes in Mathematics, 10., New York University, Courant Institute of Mathematical Sciences, New York;\nAmerican Mathematical Society, Providence, RI, 2003.\n[17] Colin, T., Rigorous derivation of the nonlinear Schr\u00f6dinger equation and DaveyStewartson systems from quadratic hyperbolic systems, Asymptot. Anal. 31 (2002), no.\n1, 69\u201391.\n[18] Colin, T.; Lannes, D., Justification of and long-wave correction to Davey-Stewartson\nsystems from quadratic hyperbolic systems., Discrete Contin. Dyn. Syst. 11 (2004), no.\n1, 83\u2013100.\n[19] Craig W.; Groves M. D., Normal forms for wave motion in fluid interfaces, Wave Motion\n31 (2000), no. 1, 21\u201341.\n[20] Craig, W.; Sulem, C.; Sulem, P.-L., Nonlinear modulation of gravity waves: a rigorous\napproach, Nonlinearity 5 (1992), no. 2, 497\u2013522.\n[21] Dineen S., Complex Analysis on Infinite Dimensional Spaces, Springer, 1999.\n[22] Gallay T.; Wayne C. E., Invariant manifolds and the long-time asymptotics of the NavierStokes and vorticity equations on R2 ., Arch. Ration. Mech. Anal. 163 (2002), no. 3,\n209\u2013258.\n[23] Giannoulis, J.; Mielke, A.,The nonlinear Schr\u00f6dinger equation as a macroscopic limit\nfor an oscillator chain with cubic nonlinearities., Nonlinearity 17 (2004), no. 2, 551\u2013565.\n[24] N. Hayashi and P. Naumkin, Asymptotics of small solutions to nonlinear Schr\u00f6dinger\nequations with cubic nonlinearities. Int. J. Pure Appl. Math. 3 (2002), no. 3, 255\u2013273.\n[25] Hille E. and Phillips R. S., Functional Analysis and Semigroups, AMS, 1991.\n[26] Infeld, E. and Rowlands, G. Nonlinear Waves, Solitons, and Chaos, 2nd ed. Cambridge,\nEngland: Cambridge University Press, 2000.\n[27] Iooss, G.; Lombardi, E., Polynomial normal forms with exponentially small remainder\nfor analytic vector fields. J. Differential Equations 212 (2005), no. 1, 1\u201361.\n[28] Joly, J.-L.; Metivier, G.; Rauch, J., Diffractive nonlinear geometric optics with rectification, Indiana Univ. Math. J. 47 (1998), no. 4, 1167\u20131241.\n[29] Kalyakin, L. A., Long-wave asymptotics. Integrable equations as the asymptotic limit\nof nonlinear systems., Uspekhi Mat. Nauk 44 (1989), no. 1(265), 5\u201334, 247; translation\nin Russian Math. Surveys 44 (1989), no. 1, 3\u201342.\n83\n\n\f[30] Kalyakin L.A., Asymptotic decay of a one-dimensional wave packet in a nonlinear dispersive medium, Math. USSR Sb. Surveys 60 (2) (1988) 457\u2013483.\n[31] Kuksin S. B., Fifteen years of KAM for PDE. Geometry, topology, and mathematical\nphysics, 237\u2013258, Amer. Math. Soc. Transl. Ser. 2, 212, Amer. Math. Soc., Providence,\nRI, 2004.\n[32] Kirrmann P.; Schneider G.; Mielke A., The validity of modulation equations for extended\nsystems with cubic nonlinearities, Proc. Roy. Soc. Edinburgh Sect. A 122 (1992), no.\n1-2, 85\u201391.\n[33] Lax P.D., Integrals of nonlinear equations of evolution and solitary waves, Comm. Pure\nAppl. Math. 21 (1968), 467-490.\n[34] Maslov V.P., Non-standard characteristics in asymptotic problems, Uspekhi Mat. Nauk\n38:6 (1983), 3-36, translation in Russian Math. Surveys 38:6 (1983),1-42.\n[35] Mielke A., Schneider G., Ziegra A., Comparison of inertial manifolds and application to\nmodulated systems, Math. Nachr. 214 (2000), 53\u201369.\n[36] Nayfeh, A. H., Perturbation Methods, New York: Wiley, 1973.\n[37] A. Pankov, Travelling Waves And Periodic Oscillations In Fermi-Pasta-Ulam Lattices,\nImperial College Press, 2005.\n[38] Pierce R. D.; Wayne C. E., On the validity of mean-field amplitude equations for counterpropagating wavetrains, Nonlinearity 8 (1995), no. 5, 769\u2013779.\n[39] Schneider, G., Justification of modulation equations for hyperbolic systems via normal\nforms, NoDEA Nonlinear Differential Equations Appl. 5 (1998), no. 1, 69\u201382.\n[40] Schneider, G., Justification and failure of the nonlinear Schr\u00f6dinger equation in case of\nnon-trivial quadratic resonances. J. Differential Equations 216 (2005), no. 2, 354\u2013386.\n[41] Schneider G., Uecker H. Existence and stability of modulating pulse solutions in\nMaxwell's equations describing nonlinear optics, Z. Angew. Math. Phys. 54 (2003), no.\n4, 677\u2013712.\n[42] Sulem C. and Sulem P.-L. , The Nonlinear Schrodinger Equation, Springer , 1999.\n[43] Soffer A., Weinstein M. I., Resonances, radiation damping and instability in Hamiltonian\nnonlinear wave equations, Invent. Math. 136 (1999), no. 1, 9\u201374.\n[44] Weissert T.P.,The Genesis of Simulation in Dynamics: pursuing the Fermi-Pasta-Ulam\nproblem, Springer-Verlag, New York, 1997.\n[45] Whitham G., Linear and Nonlinear Waves, John Wiley & Sons, 1974.\n\n84\n\n\f"}