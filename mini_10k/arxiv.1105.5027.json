{"id": "http://arxiv.org/abs/1105.5027v1", "guidislink": true, "updated": "2011-05-25T13:52:21Z", "updated_parsed": [2011, 5, 25, 13, 52, 21, 2, 145, 0], "published": "2011-05-25T13:52:21Z", "published_parsed": [2011, 5, 25, 13, 52, 21, 2, 145, 0], "title": "Defect Polytopes and Counter-Examples With polymake", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1105.5315%2C1105.2434%2C1105.3205%2C1105.1813%2C1105.0524%2C1105.5983%2C1105.2244%2C1105.0712%2C1105.2981%2C1105.1888%2C1105.4375%2C1105.1188%2C1105.0641%2C1105.3652%2C1105.3580%2C1105.3990%2C1105.0630%2C1105.2423%2C1105.4170%2C1105.3610%2C1105.4650%2C1105.1614%2C1105.4850%2C1105.3568%2C1105.0439%2C1105.3754%2C1105.3785%2C1105.3643%2C1105.2363%2C1105.4286%2C1105.1213%2C1105.3334%2C1105.2668%2C1105.1678%2C1105.1908%2C1105.2843%2C1105.6178%2C1105.4669%2C1105.5027%2C1105.3586%2C1105.5506%2C1105.1577%2C1105.3752%2C1105.0485%2C1105.4257%2C1105.1098%2C1105.0553%2C1105.0529%2C1105.5544%2C1105.4999%2C1105.3883%2C1105.4216%2C1105.2332%2C1105.2770%2C1105.0558%2C1105.4655%2C1105.1792%2C1105.2703%2C1105.3876%2C1105.3707%2C1105.4427%2C1105.5278%2C1105.1235%2C1105.1820%2C1105.2578%2C1105.4533%2C1105.5482%2C1105.2299%2C1105.1441%2C1105.4264%2C1105.2333%2C1105.3307%2C1105.3297%2C1105.6140%2C1105.2177%2C1105.1022%2C1105.3793%2C1105.0348%2C1105.3469%2C1105.1543%2C1105.0805%2C1105.6049%2C1105.3047%2C1105.5550%2C1105.2845%2C1105.0302%2C1105.5028%2C1105.5467%2C1105.0961%2C1105.1663%2C1105.1471%2C1105.0081%2C1105.2198%2C1105.2212%2C1105.5017%2C1105.1453%2C1105.2821%2C1105.3695%2C1105.2780%2C1105.3550%2C1105.4518&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Defect Polytopes and Counter-Examples With polymake"}, "summary": "It is demonstrated how the software system polymake can be used for\ncomputations in toric geometry. More precisely, counter-examples to conjectures\nrelated to A-determinants and defect polytopes are constructed.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1105.5315%2C1105.2434%2C1105.3205%2C1105.1813%2C1105.0524%2C1105.5983%2C1105.2244%2C1105.0712%2C1105.2981%2C1105.1888%2C1105.4375%2C1105.1188%2C1105.0641%2C1105.3652%2C1105.3580%2C1105.3990%2C1105.0630%2C1105.2423%2C1105.4170%2C1105.3610%2C1105.4650%2C1105.1614%2C1105.4850%2C1105.3568%2C1105.0439%2C1105.3754%2C1105.3785%2C1105.3643%2C1105.2363%2C1105.4286%2C1105.1213%2C1105.3334%2C1105.2668%2C1105.1678%2C1105.1908%2C1105.2843%2C1105.6178%2C1105.4669%2C1105.5027%2C1105.3586%2C1105.5506%2C1105.1577%2C1105.3752%2C1105.0485%2C1105.4257%2C1105.1098%2C1105.0553%2C1105.0529%2C1105.5544%2C1105.4999%2C1105.3883%2C1105.4216%2C1105.2332%2C1105.2770%2C1105.0558%2C1105.4655%2C1105.1792%2C1105.2703%2C1105.3876%2C1105.3707%2C1105.4427%2C1105.5278%2C1105.1235%2C1105.1820%2C1105.2578%2C1105.4533%2C1105.5482%2C1105.2299%2C1105.1441%2C1105.4264%2C1105.2333%2C1105.3307%2C1105.3297%2C1105.6140%2C1105.2177%2C1105.1022%2C1105.3793%2C1105.0348%2C1105.3469%2C1105.1543%2C1105.0805%2C1105.6049%2C1105.3047%2C1105.5550%2C1105.2845%2C1105.0302%2C1105.5028%2C1105.5467%2C1105.0961%2C1105.1663%2C1105.1471%2C1105.0081%2C1105.2198%2C1105.2212%2C1105.5017%2C1105.1453%2C1105.2821%2C1105.3695%2C1105.2780%2C1105.3550%2C1105.4518&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "It is demonstrated how the software system polymake can be used for\ncomputations in toric geometry. More precisely, counter-examples to conjectures\nrelated to A-determinants and defect polytopes are constructed."}, "authors": ["Michael Joswig", "Andreas Paffenholz"], "author_detail": {"name": "Andreas Paffenholz"}, "author": "Andreas Paffenholz", "arxiv_comment": "6 pages, epxanded extended abstract for software session at ISSAC\n  2011", "links": [{"href": "http://arxiv.org/abs/1105.5027v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1105.5027v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "52B20, 52-04, 14M25", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1105.5027v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1105.5027v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:1105.5027v1 [math.CO] 25 May 2011\n\nDEFECT POLYTOPES AND COUNTER-EXAMPLES\nWITH POLYMAKE\nMICHAEL JOSWIG AND ANDREAS PAFFENHOLZ\n\nAbstract. It is demonstrated how the software system polymake can be used\nfor computations in toric geometry. More precisely, counter-examples to conjectures related to A-determinants and defect polytopes are constructed.\n\n1. Defect Polytopes\nThe purpose of this note is to demonstrate how polymake's features can be used\nto establish explicit counter-examples to some conjectures on defect polytopes in\ntoric geometry. More precisely, we consider several invariants of lattice polytopes\nproposed by Di Rocco [3], show a way to compute them with polymake, and use this\nto give answers to questions posed in Section 6 of that paper. For basic properties\nof polytopes and related toric varieties we refer to Ewald [6].\nWe start by introducing some notation. Let P be a lattice polytope, i.e., a\npolytope whose vertices are contained in d . Let F(P ) the set of all non-empty\nfaces of P , including P itself. Further, we let FP (k) be the set of k-dimensional\nfaces of P . For t \u2208 we define\n\nZ\n\nN\n\n(1)\n\nct (P ) :=\n\nd\nX\n\n(\u22121)d\u2212k\n\nk=0\n\n(k + t)!\nk!\n\nX\n\nlvol(F ) ,\n\nF \u2208FP (k)\n\nwhere lvol(F ) is the normalized volume of F in the lattice\n\nZF\n\n:=\n\nZd \u2229 aff(F ) ;\n\nsee [3, p. 101]. For smooth polytopes P the invariant c1 (P ) is a function that\nrecords the degree of homogeneity of a certain rational function, the A-determinant,\nwhere A := P \u2229 d is the set of lattice points in P . Starting with the seminal\nmonograph [8] this invariant was extensively studied; see also [2, 4, 5, 10] for recent\nresults, and generalizations to the singular case. By [8, \u00a711, Thm. 1.6] the number\nc1 (P ) is non-negative for simple lattice polytopes whose associated toric variety is\nquasi-smooth. (and thus, in particular, for smooth polytopes). By [4, Pro. 3.2] this\nalso holds for arbitrary lattice simplices, while it is open for more general simple\npolytopes. A polytope P is a defect polytope, if P is a smooth lattice polytope and\nc1 (P ) = 0. In terms of the associated toric variety P is a defect polytope if the\ndual variety is not a hypersurface. By a result of Dickenstein and Nill [3, Thm. 1.6]\n\nZ\n\nMichael Joswig is supported by DFG Research Group \"Polyhedral Surfaces\" (FG 565) and\nDFG Priority Program \"Algorithmic and Experimental Methods\" (SPP 1489).\nAndreas Paffenholz is supported by the DFG Priority Program \"Algorithmic and Experimental\nMethods\" (SPP 1489).\n1\n\n\f2\n\nMICHAEL JOSWIG AND ANDREAS PAFFENHOLZ\n\nany defect polytope is a smooth strict Cayley polytope. A strict Cayley polytope is\na polytope that is affinely isomorphic to\nQ0 \u22c6 * * * \u22c6 Qk = conv(Q0 \u00d7 {e0 }, . . . , Qk \u00d7 {ek })\n\nZ\n\nwhere ej is a lattice basis of k+1 and Q0 , . . . , Qk are strictly isomorphic lattice\npolytopes in m (i.e. having the same normal fan) such that dim(aff(Q0 , . . . , Qk )) =\nm.\n\nR\n\n2. The Software\npolymake is a software system for computations in geometric combinatorics and\nrelated areas. The project was initiated in 1995 by Gawrilow and the first author [7],\nand many people helped to continuously expand it since. Recently, two important\nadditions to the system have been accomplished [9]:\n(1) polymake now comes with an interactive shell similar to most computer\nalgebra systems.\n(2) polymake has been extended to allow computations specific to the class\nof lattice polytopes, i.e., convex polytopes with integral vertex coordinates,\nand their relation to combinatorial commutative algebra, toric geometry,\nand integer programming.\nThe latest release 2.9.9 of polymake was published on November 9, 2010 and can\nbe obtained from http://www.polymake.org. It is distributed as source code and\nprecompiled binaries for Mac OS X and several Linux distributions. It is released\nunder the GNU GPL, version 3.\npolymake's functionality is organized in various applications. Currently, these\nare polytope for computations with convex polyhedra, matroid and graph for\npurposes revealed by their names, topaz (which is short for \"topology application\nzoo\") for finite simplicial complexes, and tropical for tropical geometry. Each\napplication centers around objects, a representation for the basic mathematical objects dealt with, e.g., Polytope<Rational> or LatticePolytope in the application\npolytope. Technically, objects are organized in a class hierarchy written in (a\nslightly extended dialect of) Perl. These extensions include the possibility to use\nC++-style template parameters (e.g., <Rational> to specify a coordinate domain\nfor polytopes) and a shared-memory communication model to interface with compiled C++-code. Semantically, objects are defined by their properties with can be\nused to derive further properties according to an extendible set of rules. For more\nabout the general ideas behind polymake the reader should consult [7], while [9] is\na more recent account with a focus on lattice polytopes.\n3. Computations and Code Fragments\nWe prepare a function, written in polymake's Perl dialect, that computes the\nfunction c from (1). It takes a polytope P in the first, and the parameter t in the\nsecond argument.\nsub\nmy\nmy\nmy\nmy\nmy\n\nct_invariant {\n($P, $t) = @_;\n$v = $P->VERTICES;\n$hd = $P->HASSE_DIAGRAM;\n$sign = 1;\n$c = new Integer(0);\n\nfor (my $d = $P->DIM; $d > 0; --$d) {\n\n\fDEFECT POLYTOPES AND COUNTER-EXAMPLES WITH POLYMAKE\n\n3\n\nforeach (@{$hd->nodes_of_dim($d)}) {\nmy $F = new Polytope(VERTICES=>\n$v->minor($hd->FACES->[$_],All));\nmy $vol = $F->LATTICE_VOLUME;\n$c += $sign*fac($d+$t)/fac($d)*$vol;\n}\n$sign = -$sign;\n}\n$c += $sign*fac($t)*$P->N_VERTICES;\nreturn $c;\n}\n\nThe code of all functions used in this section, together with some explanations how\nto use them, is also available as a tutorial in the polymake wiki at http://www.\npolymake.org/doku.php/tutorial/a_determinants. polymake has interfaces to\nseveral other software packages for the computation of some special properties, such\nas the volume with respect to a given lattice, in the example above. polymake 2.9.9\nuses Normaliz [1] for this type of computation by default.\nNow we can interactively apply the function ct invariant to some examples,\ne.g., [3, Example 2, p. 86]. Each input line to the polymake shell is preceded with\nthe name of the currently active application, which is polytope throughout this\nextended abstract:\npolytope\npolytope\npolytope\n1\npolytope\n0\n\n> $S = simplex(2);\n> $P = prism($S);\n> print $P->SMOOTH;\n> print ct_invariant($P,1);\n\nR\n\nHere we have assigned conv{(0, 0), (1, 0), (0, 1)}, the standard simplex in 2 , to\nthe variable $S and defined $P to be the prism over $S (with distance 1 between\nbase and top). We can check for non-singularity of the associated toric variety by\nasking for the property SMOOTH in polymake. The output \"1\" represents the boolean\nvalue \"true\". Calling the function ct invariant defined above shows that, indeed,\nc1 (P ) = 0. So the prism over the standard triangle is a defect polytope. It is\na Cayley polytope of 3 segments. We can repeat the same computation for the\nhypersimplex \u2206(3, 6), which is not simple and hence not smooth:\npolytope > print ct_invariant(hypersimplex(3,6),1);\n136\n\nNotice that the value given in [3, Ex. 10] is not correct.\nUsing the connection between lattice polytopes and toric varieties Di Rocco\nproves that ct (P ) \u2265 0 for t \u2265 1 and any smooth lattice polytope P [3, Cor. 4].\n4. Counter-Examples\nIn the sequel we use polymake to give answers to three questions raised in [3].\n4.1. Lattice polytopes with c1 negative. Conjecture 4 in that paper asks if\nc1 (P ) \u2265 0 for any lattice polytope, not necessarily smooth. We introduce some\nmore notation in order to give counter-examples. Let P be a lattice polytope in\nd\n. The lattice pyramid of P is the lattice polytope\n\nR\n\npyr(P ) := conv(P \u00d7 {0} \u222a v \u00d7 {1}) ,\n\n\f4\n\nMICHAEL JOSWIG AND ANDREAS PAFFENHOLZ\n\nR\n\nR\n\nwhere v is a vertex of P (any other lattice point at distance 1 from d \u00d7{0} \u2286 d+1\ngives an equivalent lattice polytope). We define the r-fold lattice pyramid of P\ninductively via\npyrr (P ) := pyr(pyrr\u22121 (P ))\n\nfor r \u2265 1,\n\n0\n\npyr (P ) := P .\nWe define another small function to compute r-fold pyramids.\nsub r_fold_pyr {\nmy ($P, $r) = @_;\nfor (; $r>0; --$r) {\n$P = lattice_pyramid($P);\n}\nreturn $P;\n}\n\nWe can apply this to the standard unit cube, and compute some of the invariants\nct for lattice pyramids over the cube.\npolytope\npolytope\n-2\npolytope\n4\npolytope\n-1\npolytope\n-2\npolytope\n-6\n\n> $C=cube(3,0);\n> print ct_invariant($C,0);\n> print ct_invariant($C,1);\n> print ct_invariant(r_fold_pyr($C,1),1);\n> print ct_invariant(r_fold_pyr($C,2),2);\n> print ct_invariant(r_fold_pyr($C,3),3);\n\nWith the knowledge of this example it is not hard to see that\ncr (pyrr (P )) = r!c0 (P ) + (\u22121)d+1 r! .\nfor any d-dimensional lattice polytope P and r > 0. We have seen in the previous\ncomputation that c0 (C) = \u22122 for the standard unit cube C, so that\ncr (pyrr (C)) = r!c0 (C) + r! = \u2212r! < 0 .\n4.2. Convolutions of Ehrhart polynomials. Conjecture 5 in [3] asks whether\nall coefficients of the polynomial\nf (P, t) :=\n\nd\nX\n\n(\u2212t)(d\u2212k) (k + 1)!\n\n=\n\n|Z F \u2229 tF |\n\nF \u2208FP (k)\n\nk=0\nd\nX\n\nX\n\nX\n\n(k + 1)! ehr(F, t)t(d\u2212k)\n\nk=0 F \u2208F(P )\n\nin the indeterminate t are non-negative. Here ehr(F, t) is the Ehrhart polynomial of\nF , and the coefficients of f (P, t) are integral, as k! ehr(F, k) has integral coefficients\nfor any k-dimensional lattice polytope. Again we will provide counter-examples. In\npolymake, we can use the following function to compute the coefficients of f (P, t).\nsub\nmy\nmy\nmy\nmy\nmy\n\nf_poly_coeff {\n($P) = @_;\n$d = $P->DIM;\n$v = $P->VERTICES;\n$hd = $P->HASSE_DIAGRAM;\n$sign = 1;\n\n\fDEFECT POLYTOPES AND COUNTER-EXAMPLES WITH POLYMAKE\n\n5\n\nmy $f = new Vector<Integer>($d+1);\nfor (my $k = $d; $k > 0; --$k) {\nforeach (@{$hd->nodes_of_dim($k)}) {\nmy $q = new Polytope(VERTICES=>\n$v->minor($hd->FACES->[$_],All));\nmy $h = (zero_vector<Rational>($d-$k))\n|$q->EHRHART_POLYNOMIAL_COEFF;\n$f += $sign*fac($k+1)*$h;\n}\n$sign = -$sign;\n}\n$f += $sign*$P->N_VERTICES\n*unit_vector<Rational>($d+1,$d);\nreturn $f;\n}\n\nThe returned vector lists the coefficients of the polynomial with increasing degree,\ni.e., the last entry is the leading coefficient of the polynomial.\nWe can use the same example as before to show that the coefficients need not\nbe non-negative. We start out with the 3-dimensional unit cube stored in $C.\npolytope > print f_poly_coeff($C);\n24 36 24 4\npolytope > print f_poly(lattice_pyramid($C));\n120 192 114 32 -1\n\nIt is not hard to see that the leading coefficient of this polynomial coincides with\nc1 (P ). Looking at iterated pyramids, by re-using our function r fold pyr, we\nobtain:\npolytope > print f_poly_coeff(r_fold_pyr($C,3));\n5040 9060 5538 1698 188 -3 0\npolytope > print f_poly_coeff(r_fold_pyr($C,5));\n362880 717696 491304 163056 28086 1490 -15 0 0\n\nWe are not aware of an example where another but the leading coefficient of the\npolynomial is negative.\n4.3. Cayley polytopes. It is finally asked in [3, p. 103] whether c1 (P ) = 0 implies\nthat P is a strict Cayley polytope as defined above. This is not true, as the example\nof a two-fold pyramid over the unit square shows:\npolytope > $Q=cube(2,0);\npolytope > print ct_invariant(r_fold_pyr($Q,2),1);\n0\n\nHowever, in the above definition for a Cayley polytope we could drop the condition that all factors have the same normal fan. With this slightly more general\nnotion the 2-fold lattice pyramid over the 0/1-square is a non-strict Cayley polytope\nof two segments and two points. On the other hand, it is known [5, Prop. 2.14] that\nthe set of lattice points of a defect polytope is contained in two parallel hyperplanes\nwith distance one, so any defect polytope is always a non-strict Cayley polytope\nover a segment.\nReferences\n[1] W. Bruns and B. Ichim, Normaliz 2.5, 2010, http://www.mathematik.uni-osnabrueck.de/\nnormaliz/.\n[2] Raymond Curran and Eduardo Cattani, Restriction of a-discriminants and dual defect toric\nvarieties, J. of Symbolic Computation 42 (2007), no. 1-2, 115 \u2013 135.\n\n\f6\n\nMICHAEL JOSWIG AND ANDREAS PAFFENHOLZ\n\n[3] S. Di Rocco, Projective duality of toric manifolds and defect polytopes., Proc. Lond. Math.\nSoc., III. Ser. 93 (2006), no. 1, 85\u2013104.\n[4] A. Dickenstein and B. Nill, A simple combinatorial criterion for projective toric manifolds\nwith dual defect, Math. Res. Letters 17 (2010), no. 3, 435\u2013448.\n[5] Alexander Esterov, Newton polyhedra of discriminants of projections, Discrete Comput.\nGeom., Mathematical Journal 8 (2008), no. 3, 433\u2013442.\n[6] G. Ewald, Combinatorial convexity and algebraic geometry, Graduate Texts in Mathematics,\nvol. 168, Springer-Verlag, New York, 1996.\n[7] E. Gawrilow and M. Joswig, polymake: a framework for analyzing convex polytopes,\nPolytopes-combinatorics and computation, DMV Sem., vol. 29, Birkh\u00e4user, Basel, 2000,\npp. 43\u201373.\n[8] I. M. Gelfand, M. M. Kapranov, and A. V. Zelevinsky, Discriminants, resultants and multidimensional determinants, Birkh\u00e4user Boston Inc., Boston, MA, 2008.\n[9] M. Joswig, B. M\u00fcller, and A. Paffenholz, polymake and lattice polytopes, FPSAC 2009, Assoc.\nDiscr. Math. Theor. Comput. Sci., Nancy, 2009, pp. 491\u2013502.\n[10] Yutaka Matsui and Kiyoshi Takeuchi, A geometric degree formula for A-discriminants and\nEuler obstructions of toric varieties., Adv. Math. 226 (2011), no. 2, 2040\u20132064.\nTU Darmstadt, Dolivostr. 15, 64293 Darmstadt, Germany\nE-mail address: {joswig,paffenholz}@mathematik.tu-darmstadt.de\n\n\f"}