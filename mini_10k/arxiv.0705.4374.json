{"id": "http://arxiv.org/abs/0705.4374v1", "guidislink": true, "updated": "2007-05-30T16:37:09Z", "updated_parsed": [2007, 5, 30, 16, 37, 9, 2, 150, 0], "published": "2007-05-30T16:37:09Z", "published_parsed": [2007, 5, 30, 16, 37, 9, 2, 150, 0], "title": "Enhancing SPH using moving least-squares and radial basis functions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0705.0803%2C0705.2366%2C0705.3152%2C0705.3352%2C0705.4671%2C0705.2089%2C0705.2223%2C0705.1649%2C0705.3557%2C0705.1971%2C0705.3284%2C0705.4250%2C0705.2979%2C0705.3302%2C0705.3372%2C0705.0514%2C0705.1015%2C0705.1189%2C0705.2496%2C0705.0604%2C0705.0474%2C0705.2246%2C0705.1983%2C0705.1444%2C0705.3052%2C0705.0777%2C0705.3707%2C0705.2436%2C0705.4374%2C0705.2389%2C0705.3782%2C0705.3151%2C0705.0044%2C0705.0251%2C0705.1668%2C0705.2487%2C0705.3587%2C0705.1785%2C0705.2553%2C0705.4414%2C0705.3554%2C0705.3730%2C0705.3751%2C0705.0822%2C0705.2109%2C0705.0924%2C0705.0406%2C0705.1673%2C0705.3868%2C0705.2283%2C0705.0628%2C0705.4043%2C0705.4419%2C0705.1994%2C0705.0405%2C0705.3896%2C0705.1939%2C0705.3929%2C0705.2307%2C0705.2942%2C0705.4371%2C0705.4238%2C0705.4512%2C0705.1413%2C0705.3143%2C0705.4458%2C0705.2149%2C0705.0769%2C0705.4059%2C0705.3876%2C0705.0654%2C0705.2053%2C0705.3415%2C0705.2073%2C0705.4427%2C0705.0050%2C0705.3835%2C0705.4008%2C0705.4455%2C0705.0968%2C0705.2906%2C0705.1652%2C0705.2921%2C0705.0682%2C0705.4352%2C0705.2339%2C0705.0242%2C0705.0752%2C0705.1303%2C0705.4325%2C0705.0460%2C0705.3872%2C0705.0980%2C0705.1436%2C0705.2786%2C0705.0918%2C0705.0639%2C0705.2992%2C0705.1157%2C0705.2156%2C0705.4081&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Enhancing SPH using moving least-squares and radial basis functions"}, "summary": "In this paper we consider two sources of enhancement for the meshfree\nLagrangian particle method smoothed particle hydrodynamics (SPH) by improving\nthe accuracy of the particle approximation. Namely, we will consider shape\nfunctions constructed using: moving least-squares approximation (MLS); radial\nbasis functions (RBF). Using MLS approximation is appealing because polynomial\nconsistency of the particle approximation can be enforced. RBFs further appeal\nas they allow one to dispense with the smoothing-length -- the parameter in the\nSPH method which governs the number of particles within the support of the\nshape function. Currently, only ad hoc methods for choosing the\nsmoothing-length exist. We ensure that any enhancement retains the conservative\nand meshfree nature of SPH. In doing so, we derive a new set of\nvariationally-consistent hydrodynamic equations. Finally, we demonstrate the\nperformance of the new equations on the Sod shock tube problem.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0705.0803%2C0705.2366%2C0705.3152%2C0705.3352%2C0705.4671%2C0705.2089%2C0705.2223%2C0705.1649%2C0705.3557%2C0705.1971%2C0705.3284%2C0705.4250%2C0705.2979%2C0705.3302%2C0705.3372%2C0705.0514%2C0705.1015%2C0705.1189%2C0705.2496%2C0705.0604%2C0705.0474%2C0705.2246%2C0705.1983%2C0705.1444%2C0705.3052%2C0705.0777%2C0705.3707%2C0705.2436%2C0705.4374%2C0705.2389%2C0705.3782%2C0705.3151%2C0705.0044%2C0705.0251%2C0705.1668%2C0705.2487%2C0705.3587%2C0705.1785%2C0705.2553%2C0705.4414%2C0705.3554%2C0705.3730%2C0705.3751%2C0705.0822%2C0705.2109%2C0705.0924%2C0705.0406%2C0705.1673%2C0705.3868%2C0705.2283%2C0705.0628%2C0705.4043%2C0705.4419%2C0705.1994%2C0705.0405%2C0705.3896%2C0705.1939%2C0705.3929%2C0705.2307%2C0705.2942%2C0705.4371%2C0705.4238%2C0705.4512%2C0705.1413%2C0705.3143%2C0705.4458%2C0705.2149%2C0705.0769%2C0705.4059%2C0705.3876%2C0705.0654%2C0705.2053%2C0705.3415%2C0705.2073%2C0705.4427%2C0705.0050%2C0705.3835%2C0705.4008%2C0705.4455%2C0705.0968%2C0705.2906%2C0705.1652%2C0705.2921%2C0705.0682%2C0705.4352%2C0705.2339%2C0705.0242%2C0705.0752%2C0705.1303%2C0705.4325%2C0705.0460%2C0705.3872%2C0705.0980%2C0705.1436%2C0705.2786%2C0705.0918%2C0705.0639%2C0705.2992%2C0705.1157%2C0705.2156%2C0705.4081&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper we consider two sources of enhancement for the meshfree\nLagrangian particle method smoothed particle hydrodynamics (SPH) by improving\nthe accuracy of the particle approximation. Namely, we will consider shape\nfunctions constructed using: moving least-squares approximation (MLS); radial\nbasis functions (RBF). Using MLS approximation is appealing because polynomial\nconsistency of the particle approximation can be enforced. RBFs further appeal\nas they allow one to dispense with the smoothing-length -- the parameter in the\nSPH method which governs the number of particles within the support of the\nshape function. Currently, only ad hoc methods for choosing the\nsmoothing-length exist. We ensure that any enhancement retains the conservative\nand meshfree nature of SPH. In doing so, we derive a new set of\nvariationally-consistent hydrodynamic equations. Finally, we demonstrate the\nperformance of the new equations on the Sod shock tube problem."}, "authors": ["R. A. Brownlee", "P. Houston", "J. Levesley", "S. Rosswog"], "author_detail": {"name": "S. Rosswog"}, "author": "S. Rosswog", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1007/978-3-540-46551-5_8", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0705.4374v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0705.4374v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "10 pages, 3 figures, In Proc. A4A5, Chester UK, Jul. 18-22 2005", "arxiv_primary_category": {"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0705.4374v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0705.4374v1", "journal_reference": "Algorithms for Approximation: Proceedings of the 5th International\n  Conference, Chester UK, July 18-22 2005, pages 103-112, Springer, 2007", "doi": "10.1007/978-3-540-46551-5_8", "fulltext": "arXiv:0705.4374v1 [math.NA] 30 May 2007\n\nEnhancing SPH using Moving Least-Squares\nand Radial Basis Functions\u2217\nR. Brownlee1,\u2020 , P. Houston2, , J. Levesley1 , and S. Rosswog3\n1\n\nDepartment of Mathematics, University of Leicester, Leicester, LE1 7RH, UK,\n{r.brownlee,j.levesley}@mcs.le.ac.uk\nSchool of Mathematical Sciences, University of Nottingham, Nottingham NG7\n2RD, UK, paul.houston@nottingham.ac.uk\nSchool of Engineering and Science, International University Bremen, Campus\nRing 1, D-28759 Bremen, Germany, s.rosswog@iu-bremen.de\n\n2\n\n3\n\nSummary. In this paper we consider two sources of enhancement for the meshfree\nLagrangian particle method smoothed particle hydrodynamics (SPH) by improving\nthe accuracy of the particle approximation. Namely, we will consider shape functions\nconstructed using: moving least-squares approximation (MLS); radial basis functions\n(RBF). Using MLS approximation is appealing because polynomial consistency of\nthe particle approximation can be enforced. RBFs further appeal as they allow one\nto dispense with the smoothing-length \u2013 the parameter in the SPH method which\ngoverns the number of particles within the support of the shape function. Currently,\nonly ad hoc methods for choosing the smoothing-length exist. We ensure that any\nenhancement retains the conservative and meshfree nature of SPH. In doing so,\nwe derive a new set of variationally-consistent hydrodynamic equations. Finally, we\ndemonstrate the performance of the new equations on the Sod shock tube problem.\n\n1 Introduction\nSmoothed particle hydrodynamics (SPH) is a meshfree Lagrangian particle\nmethod primarily used for solving problems in solid and fluid mechanics\n(see [10] for a recent comprehensive review). Some of the attractive characteristics that SPH possesses include: the ability to handle problems with large\ndeformation, free surfaces and complex geometries; truly meshfree nature (no\nbackground mesh required); exact conservation of momenta and total energy.\nOn the other hand, SPH suffers from several drawbacks: an instability in\ntension; difficulty in enforcing essential boundary conditions; fundamentally\nbased on inaccurate kernel approximation techniques. This paper addresses\nthe last of these deficiencies by suggesting improved particle approximation\n\u2217\n\u2020\n\nThis work is supported by EPSRC grants GR/S95572/01 and GR/R76615/02.\nCorresponding author.\n\n\f2\n\nR. Brownlee, P. Houston, J. Levesley, and S. Rosswog\n\nprocedures. Previous contributions in this direction (reviewed in [2]) have focused on corrections of the existing SPH particle approximation (or its derivatives) by enforcing polynomial consistency. As a consequence, the conservation\nof relevant physical quantities by the discrete equations is usually lost.\nThe outline of the paper is as follows. In the next section we review how\nSPH equations for the non-dissipative motion of a fluid can be derived. In\nessence this amounts to a discretization of the Euler equations:\nd\u03c1\n= \u2212\u03c1\u2207 * v,\ndt\n\ndv\n1\n= \u2212 \u2207P,\ndt\n\u03c1\n\nde\nP\n= \u2212 \u2207 * v,\ndt\n\u03c1\n\n(1)\n\nd\nwhere dt\nis the total derivative, \u03c1, v, e and P are the density, velocity, thermal energy per unit mass and pressure, respectively. The derivation is such\nthat important conservation properties are satisfied by the discrete equations.\nWithin the same section we derive a new set of variationally-consistent hydrodynamic equations based on improved particle approximation. In Sect. 3\nwe construct specific examples \u2013 based on moving least-squares approximation and radial basis functions \u2013 to complete the newly derived equations.\nThe paper finishes with Sect. 4 where we demonstrate the performance of the\nnew methods on the Sod shock tube problem [12] and make some concluding\nremarks.\nTo close this section, we briefly review the SPH particle approximation\ntechnique on which the SPH method is fundamentally based and which\nwe purport to be requiring improvement. From a set of scattered particles\n{x1 , . . . , xN } \u2282 IRd , SPH particle approximation is achieved using\n\nSf (x) =\n\nN\nX\nj=1\n\nf (xj )\n\nmj\nW (|x \u2212 xj |, h),\n\u03c1j\n\n(2)\n\nwhere mj and \u03c1j denotes the mass and density of the jth particle, respectively.\nThe function W is a normalised kernel function which approximates the \u03b4m\ndistribution as the smoothing-length, h, tends to zero. The function \u03c1jj W (|x\u2212\nxj |, h) is called an SPH shape function and the most popular choice for W is\na compactly supported cubic spline kernel with support 2h. The parameter\nh governs the extent to which contributions from neighbouring particles are\nallowed to smooth the approximation to the underlying function f . Allowing a\nspatiotemporally varying smoothing-length increases the accuracy of an SPH\nsimulation considerably. There are a selection of ad hoc techniques available\nto accomplish this, although often terms arising from the variation in h are\nneglected in the SPH method. The approximating power of the SPH particle\napproximation is perceived to be poor. The SPH shape functions fail to provide\na partition of unity so that even the constant function is not represented\nexactly. There is currently no approximation theory available for SPH particle\napproximation when the particles are in general positions. The result of a\nshock tube simulation using the SPH equations derived in Sect. 2 is shown in\n\n\fEnhancing SPH using MLS and RBFs\n1\n\n1\n\n0.8\n\n0.8\n\n\u03c10.6\n\nP0.6\n\n0.4\n\n0.4\n0.2\n\n0.2\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n1\n0.6\n0.4\n0.2\n0\n\u22120.5 \u22120.25\n\n0\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n0\nx\n\n0.25\n\n0.5\n\n2.8\n2.6\ne2.4\n2.2\n2\n1.8\n\n0.8\nv\n\n3\n\n0\nx\n\n0.25\n\n0.5\n\n\u22120.5 \u22120.25\n\nFig. 1. Shock tube simulation (t=0.2) using SPH.\n\nFig. 1 (see Sect. 4 for the precise details of the simulation). The difficulty that\nSPH has at the contact discontinuity (x \u2248 0.2) and the head of the rarefaction\nwave (x \u2248 \u22120.25) is attributed to a combination of the approximation (2) and\nthe variable smoothing-length not being self-consistently incorporated.\n\n2 Variationally-Consistent Hydrodynamic Equations\nIt is well known (see [10] and the references cited therein) that the most\ncommon SPH equations for the non-dissipative motion of a fluid can be derived\nusing the Lagrangian for hydrodynamics and a variational principle. In this\nsection we review this procedure for a particular formulation of SPH before\nderiving a general set of variationally-consistent hydrodynamic equations.\nThe aforementioned Lagrangian\nis a particular functional of the dynamical\nR\ncoordinates: L(x, v) = \u03c1(v 2 /2 \u2212 e) dx, where x is the position, v is the\nvelocity, \u03c1 is the density, e is the thermal energy per unit mass and the integral\nis over the volume being discretized. Given N particles {x1 . . . , xN } \u2282 IRd ,\nthe SPH discretization of the Lagrangian, also denoted by L, is given by\nL=\n\nN\nX\nj=1\n\nmj\n\n\u0010 v2\nj\n\n2\n\n\u0011\n\u2212 ej ,\n\n(3)\n\nwhere mj has replaced \u03c1j Vj to denote particle mass (assumed to be constant),\nand Vj is a volume associated with each particle. Self-evidently, the notation\nfj is used to denote the function f evaluated at the jth particle.\nThe Euler-Lagrange equations give rise to SPH equations of motion provided each quantity in (3) can be written directly as a function of the particle\ncoordinates. By setting f = \u03c1 in (2) and evaluating at xj , we can obtain\nan expression for \u03c1j directly as a function of the particle coordinates. Therefore, because we assume that ej = ej (\u03c1j ), the Euler\u2013Lagrange equations are\n\n\f4\n\nR. Brownlee, P. Houston, J. Levesley, and S. Rosswog\n\namenable. Furthermore, in using this approach, conservation of momenta and\ntotal energy are guaranteed via Noether's symmetry theorem. However, when\nwe consider improved particle approximation, the corresponding expression\nfor density depends on the particle coordinates in an implicit manner, so that\nthe Euler\u2013Lagrange equations are not directly amenable. To circumvent this\ndifficulty, one can use the principle of stationary action directly to obtain SPH\nequations of motion \u2013 the action,\nZ\nS = L dt,\nbeing the time integral of L. The principle of stationary action demands that\nthe action is invariant with respect to small changes in the particle coordinates (i.e., \u03b4S = 0). The Euler\u2013Lagrange equations are a consequence of this\nvariational principle. In [10] it is shown that if an expression for the time rate\nof change of \u03c1j is available, then, omitting the detail, this variational principle\ngives rise to SPH equations of motion.\nTo obtain an expression for the time rate of change of density we can\ndiscretize the first equation of (1) using (2) by collocation. By assuming that\nthe SPH shape functions form a partition of unity we commit error but are\nable to artificially provide the discretization with invariance to a constant\nshift in velocity (Galilean invariance):\nN\nX\nmj\nd\u03c1i\n(vj \u2212 vi ) * \u2207i W (|xi \u2212 xj |, hi ),\n= \u2212\u03c1i\ndt\n\u03c1\nj=1 j\n\ni = 1, . . . , N ,\n\n(4)\n\nwhere \u2207i is the gradient with respect to the coordinates of the ith particle.\nThe equations of motion that are variationally-consistent with (4) are\nN\n\u0011\n1 X mj \u0010\ndvi\nPi \u2207i W (|xi \u2212 xj |, hi ) + Pj \u2207i W (|xi \u2212 xj |, hj ) ,\n=\u2212\ndt\n\u03c1i j=1 \u03c1j\n\n(5)\n\nfor i = 1, . . . , N , where Pi denotes the pressure of the ith particle (provided\nvia a given equation of state). Using the first law of thermodynamics, the\nequation for the rate of change of thermal energy is given by\ndei\nPi d\u03c1i\n= 2\n,\ndt\n\u03c1i dt\n\ni = 1, . . . , N .\n\n(6)\n\nAs already noted, a beneficial consequence of using the Euler\u2013Lagrange\nequations is that one automatically preserves, in the discrete equations, fundamental conservation properties of the original system (1). Since we have\nnot done this, conservation properties are not necessarily guaranteed by our\ndiscrete equations (4)\u2013(6). However, certain features of the discretization (4)\ngive us conservation. Indeed, by virtue of (4) being Galilean invariant, one\n\n\fEnhancing SPH using MLS and RBFs\n\n5\n\nconserves linear momentum and total energy (assuming perfect time integration). Remember that Galilean invariance was installed under the erroneous\nassumption that the SPH shape functions provide a partition of unity. Angular momentum is also explicitly conserved by this formulation due to W being\nsymmetric.\nNow, we propose to enhance SPH by improving the particle approximation (2). Suppose we have constructed shape functions \u03c6j that provide at least\na partition of unity. With these shape functions we form a quasi-interpolant:\nSf =\n\nN\nX\n\nf (xj )\u03c6j ,\n\n(7)\n\nj=1\n\nwhich we implicitly assume provides superior approximation quality than that\nprovided by (2). We defer particular choices for \u03c6j until the next section. The\ndiscretization of the continuity equation now reads\nN\nX\nd\u03c1i\n(vj \u2212 vi ) * \u2207\u03c6j (xi ),\n= \u2212\u03c1i\ndt\nj=1\n\ni = 1, . . . , N ,\n\n(8)\n\nwhere, this time, we have supplied genuine Galilean invariance, without committing an error, using the partition of unity property of \u03c6j . As before, the\nprinciple of stationary action provides the equations of motion and conservation properties of the resultant equations reflect properties present in the\ndiscrete continuity equation (8).\nTo obtain (3), two assumptions were made. Firstly, the SPH shape functions were assumed to form a sufficiently goodRpartition of unity. Secondly,\nit was assumed that the kernel approximation f W (| * \u2212xj |, h) dx \u2248 f (xj ),\nwas valid. For our general shape functions the first of these assumptions is\nmanifestly true. The analogous assumption we make to replace the second is\nthat the error induced by the approximations\nZ\nZ\nj = 1, . . . , N ,\n(9)\nf \u03c6j dx \u2248 fj \u03c6j dx \u2248 fj Vj ,\nis negligible. With the assumption (9), the approximate Lagrangian associated\nwith \u03c6j is identical in form to (3). Neglecting the details once again, which\ncan be recovered from [10], the equations of motion variationally-consistent\nwith (8) are\nN\ndvi\n1 X mj\nPj \u2207\u03c6i (xj ),\n=\ndt\nmi j=1 \u03c1j\n\ni = 1, . . . , N ,\n\n(10)\n\nThe equations (6), (8) and (10) constitute a new set of variationallyconsistent hydrodynamic equations. They give rise to the formulation of SPH\nm\nderived earlier under the transformation \u03c6j (xi ) 7\u2192 \u03c1jj W (|xi \u2212 xj |, hi ). The\n\n\f6\n\nR. Brownlee, P. Houston, J. Levesley, and S. Rosswog\n\nequations of motion (10) appear in [8] but along side variationally-inconsistent\ncompanion equations. The authors advocate using a variationally-consistent\nset of equation because evidence from the SPH literature (e.g., [3, 9]) suggests\nthat not doing so can lead to poor numerical results.\nLinear momentum and total energy are conserved by the new equations,\nand this can be verified immediately using the partition of unity property of\n\u03c6j . The \u03c6j will not be symmetric. However, if it is also\nP assumed that the\nshape functions reproduce linear polynomials, namely,\nxj \u03c6j (x) = x, then\nit is simple to verify that angular momentum is also explicitly conserved.\n\n3 Moving Least-Squares and Radial Basis Functions\nIn this section we construct quasi-interpolants of the form (7). In doing so\nwe furnish our newly derived hydrodynamic equations (6), (8) and (10) with\nseveral examples.\nMoving least-squares (MLS). The preferred construction for MLS shape functions, the so-called Backus\u2013Gilbert approach [4], seeks a quasi-interpolant of\nthe form (7) such that:\n\u2022\n\u2022\n\nSp = p for all polynomials p of some fixed degree;\nP 2 h \u0010 |x\u2212xj | \u0011i\u22121\n\u03c6j (x), j = 1, . . . , N , minimise the quadratic form\n\u03c6j (x) w\n,\nh\n\nwhere w is a fixed weight function. If w is continuous, compactly supported\nand positive on its support, this quadratic minimisation problem admits a\nunique solution. Assuming f has sufficient smoothness, the order of convergence of the MLS approximation (7) directly reflects the degree of polynomial\nreproduced [14].\nThe use of MLS approximation in an SPH context has been considered before. Indeed, Belytschko et al. [2] have shown that correcting the SPH particle\napproximation up to linear polynomials is equivalent to an MLS approximation with w(| * \u2212xj |/h) = W (| * \u2212xj |, h). There is no particular reason to base\nthe MLS approximation on an SPH kernel. We find that MLS approximations\nbased on Wendland functions [13], which have half the natural support of a\ntypical SPH kernel, produce results which are less noisy. Dilts [7, 8] employs\nMLS approximation too. Indeed, in [7], Dilts makes an astute observation that\naddresses an inconsistency that arises due to (9) \u2013 we have the equations\nN\nX\ndVi\n(vj \u2212 vi ) * \u2207\u03c6j (xi )\n= Vi\ndt\nj=1\n\nand\n\ndVi\nd\n\u2248\ndt\ndt\n1/d\n\n\u0012Z\n\n\u0013\n\u03c6i (x) dx .\n\nDilts shows that if hi is evolved according to hi \u221d Vi then there is agreement\nbetweenR the right-hand sides of these equations when a one-point quadrature of \u03c6i dx is employed. Thus, providing some theoretical justification for\nchoosing this particular variable smoothing-length over other possible choices.\n\n\fEnhancing SPH using MLS and RBFs\n\n7\n\nRadial basis functions (RBFs). To construct an RBF interpolant to an unknown function f on x1 , . . . , xN , one produces a function of the form\nIf =\n\nN\nX\n\n\u03bbj \u03c8(| * \u2212xj |),\n\n(11)\n\nj=1\n\nwhere the \u03bbj are found by solving the linear system If (xi ) = f (xi ), i =\n1, . . . , N . The radial basis function, \u03c8, is a pre-specified univariate function\nchosen to guarantee the solvability of this system. Depending on the choice of\n\u03c8, a low degree polynomial is sometimes added to (11) to ensure solvability,\nwith the additional degrees of freedom taken up in a natural way. This is\nthe case with the polyharmonic splines, which are defined, for m > d/2, by\n\u03c8(|x|) = |x|2m\u2212d log |x| if d is even and \u03c8(|x|) = |x|2m\u2212d otherwise, and a\npolynomial of degree m \u2212 1 is added. The choice m \u2265 2 ensures the RBF\ninterpolant reproduces linear polynomials as required for angular momentum\nto be conserved by the equations of motion. As with MLS approximation,\none has certain strong assurances regarding the quality of the approximation\ninduced by the RBF interpolant (e.g. [6] for the case of polyharmonic splines).\nIn its present form (11), the RBF interpolant is not directly amenable.\nOne possibility is to rewrite the interpolant in cardinal form so that it coincides with (7). This naively constitutes much greater computational effort.\nHowever, there are several strategies for constructing approximate cardinal\nRBF shape functions (e.g. [5]) and fast evaluation techniques (e.g. [1]) which\nreduce this work significantly. The perception of large computational effort is\nan attributing factor as to why RBFs have not been considered within an SPH\ncontext previously. Specifically for polyharmonic splines, another possibility\nis to construct shape functions based on discrete m-iterated Laplacians of \u03c8.\nThis is sensible because the continuous iterated Laplacian, when applied \u03c8,\nresults in the \u03b4-distribution (up to a constant). This is precisely the approach\nwe take in Sect. 4 where we employ cubic B-spline shape functions for one of\nour numerical examples. The cubic B-splines are discrete bi-Laplacians of the\nshifts of | * |3 , and they gladly reproduce linear polynomials.\nIn addition to superior approximation properties, using globally supported\nRBF shape functions has a distinct advantage. One has dispensed with the\nsmoothing-length entirely. Duely, issues regarding how to correctly vary and\nself-consistently incorporate the smoothing-length vanish. Instead, a natural\n'support' is generated related to the relative clustering of particles.\n\n4 Numerical Results\nIn this section we demonstrate the performance of the scheme (6), (8) and (10)\nusing both MLS and RBF shape functions. The test we have selected has\nbecome a standard one-dimensional numerical test in compressible fluid flow\n\u2013 the Sod shock tube [12]. The problem consists of two regions of ideal gas,\n\n\f8\n\nR. Brownlee, P. Houston, J. Levesley, and S. Rosswog\n\none with a higher pressure and density than the other, initially at rest and\nseparated by a diaphragm. The diaphragm is instantaneously removed and the\ngases allowed to flow resulting in a rarefaction wave, contact discontinuity and\nshock. We set up 450 equal mass particles in [\u22120.5, 0.5]. The gas occupying\nthe left-hand and right-hand sides of the domain are given initial conditions\n(PL , \u03c1L , vL ) = (1.0, 1.0, 0.0) and (PR , \u03c1R , vR ) = (0.1, 0.125, 0.0), respectively.\nThe initial condition is not smoothed.\nWith regards to implementation, artificial viscosity is included to prevent\nthe development of unphysical oscillations. The form of the artificial viscosity\nmimics that of the most popular SPH artificial viscosity and is applied with a\nswitch which reduces the magnitude of the viscosity by a half away from the\nshock. A switch is also used to administer an artificial thermal conductivity\nterm, also modelled in SPH. Details of both dissipative terms and their respective switches can be accessed through [10]. Finally, we integrate, using a\npredictor\u2013corrector method, the equivalent hydrodynamic equations\nN\nX\ndVi\n(vj \u2212 vi ) * \u2207\u03c6j (xi ),\n= Vi\ndt\nj=1\nN\n1 X\ndvi\nVj Pj \u2207\u03c6i (xj ),\n=\ndt\nmi j=1\n\n(12)\n\ndei\nPi dVi\n=\u2212\n,\ndt\nmi dt\n\ni\ntogether with dx\ndt = vi , to move the particles. To address the consistency issue\nregarding particle volume mentioned earlier \u2013 which is partially resolved by\nevolving h in a particular way when using MLS approximation\n\u2013 we periodR\nically update the particle volume predicted by (12) with \u03c6i dx if there is\nsignificant difference between these two\nR quantities. To be more specific, the\nparticle volume Vi is updated if |Vi \u2212 \u03c6i dx|/Vi \u2265 1.0 \u00d7 10\u22123 .\nWe first ran a simulation with linearly complete MLS shape functions. The\nunderlying univariate function, w, was selected to be a Wendland function\nwith C 4 -smoothness. The smoothing-length was evolved by taking a time\nderivative of the relationship hi \u221d Vi and integrating it alongside the other\nequations, the constant of proportionality was chosen to be 2.0. The result\nis shown in Fig. 2. The agreement with the analytical solution (solid line)\nis excellent, especially around the contact discontinuity and the head of the\nrarefaction wave. Next, we constructed RBF shape functions. As we mentioned\nin Sect. 3, for this one-dimensional problem we employ cubic B-spline because\nthey constitute discrete bi-Laplacians of the shifts of the globally supported\nbasis function, \u03c8 = | * |3 . The result of this simulation is shown in Fig. 3.\nAgain, the agreement with the analytical solution is excellent.\nIn the introduction an SPH simulation of the shock tube was displayed\n(Fig. 1). There, we integrated (4)\u2013(6) and h was updated by taking a time\nderivative of the relationship hi = 2.0mi /\u03c1i . To keep the comparison fair,\nthe same initial condition, particle setup and dissipative terms were used. As\n\n\fEnhancing SPH using MLS and RBFs\n1\n\n1\n\n0.8\n\n0.8\n\n\u03c10.6\n\nP0.6\n\n0.4\n\n0.4\n0.2\n\n0.2\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n1\n0.6\n0.4\n0.2\n0\n\u22120.5 \u22120.25\n\n0\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n0\nx\n\n0.25\n\n0.5\n\n2.8\n2.6\ne2.4\n2.2\n2\n1.8\n\n0.8\nv\n\n9\n\n0\nx\n\n0.25\n\n0.5\n\n\u22120.5 \u22120.25\n\nFig. 2. Shock tube simulation (t=0.2) using linearly complete MLS shape functions.\n1\n\n1\n\n0.8\n\n0.8\n\n\u03c10.6\n\nP0.6\n\n0.4\n\n0.4\n0.2\n\n0.2\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n1\n0.6\n0.4\n0.2\n0\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n0\nx\n\n0.25\n\n0.5\n\n2.8\n2.6\ne2.4\n2.2\n2\n1.8\n\n0.8\nv\n\n0\n\u22120.5 \u22120.25\n\n0\nx\n\n0.25\n\n0.5\n\n\u22120.5 \u22120.25\n\nFig. 3. Shock tube simulation (t=0.2) using cubic B-spline shape functions.\n\npreviously noted, this formulation of SPH performs poorly on this problem,\nespecially around the contact discontinuity. Furthermore, we find that this\nformulation of SPH does not converge in the L\u221e -norm for this problem. At\na fixed time (t = 0.2), plotting number of particles, N , versus L\u221e -error in\npressure, in the region of the computational domain where the solution is\nsmooth reveals an approximation order of around 2/3, attributed to the low\nregularity of the analytical solution, for the MLS and RBF methods, whereas\nour SPH simulation shows no convergence. This is not to say that SPH can not\nperform well on this problem. Indeed, Price [11] shows that, for a formulation\nof SPH where density is calculated via summation and variable smoothinglength terms correctly incorporated, the simulation does exhibit convergence\nin pressure. The SPH formulation we have used is fair for comparison with\nthe MLS and RBF methods since they all share a common derivation. In\nparticular, we are integrating the continuity equation in each case.\n\n\f10\n\nR. Brownlee, P. Houston, J. Levesley, and S. Rosswog\n\nTo conclude, we have proposed a new set of discrete conservative variationally-consistent hydrodynamic equations based on a partition of unity. These\nequations, when actualised with MLS and RBF shape functions, outperform\nthe SPH method on the shock tube problem. Further experimentation and\nnumerical analysis of the new methods is a goal for future work.\nAcknowledgements. The first author would like to acknowledge Joe Monaghan, whose captivating lectures at the XIth NA Summer School held in\nDurham in July 2004 provided much inspiration for this work. Similarly, the\nfirst author would like to thank Daniel Price for his useful discussions, helpful\nsuggestions and hospitality received during a visit to Exeter in May 2005.\n\nReferences\n1. R. K. Beatson and W. A. Light. Fast evaluation of radial basis functions: methods for two-dimensional polyharmonic splines. IMA J. Numer. Anal., 17(3):343\u2013\n372, 1997.\n2. T. Belytschko, B. Krongauz, D. Organ, M. Fleming, and P. Krysl. Meshless\nmethods: An overview and recent developments. Comput. Meth. Appl. Mech.\nEngrg., 139:3\u201347, 1996.\n3. J. Bonet and T.-S. L. Lok. Variational and momentum preservation aspects\nof smooth particle hydrodynamic formulations. Comput. Methods Appl. Mech.\nEngrg., 180(1-2):97\u2013115, 1999.\n4. L. P. Bos and K. \u0160alkauskas. Moving least-squares are Backus-Gilbert optimal.\nJ. Approx. Theory, 59(3):267\u2013275, 1989.\n5. D. Brown, L. Ling, Kansa E., and J. Levesley. On approximate cardinal preconditioning methods for solving PDEs with radial basis functions. Eng. Anal.\nBound. Elem., 29:343\u2013353, 2005.\n6. R. A. Brownlee and W. A. Light. Approximation orders for interpolation by\nsurface splines to rough functions. IMA J. Numer. Anal., 24(2):179\u2013192, 2004.\n7. G. A. Dilts. Moving-least-squares-particle hydrodynamics. I. Consistency and\nstability. Internat. J. Numer. Methods Engrg., 44(8):1115\u20131155, 1999.\n8. G. A. Dilts. Moving least-squares particle hydrodynamics. II. Conservation and\nboundaries. Internat. J. Numer. Methods Engrg., 48(10):1503\u20131524, 2000.\n9. S. Marri and S. D. M. White. Smoothed particle hydrodynamics for galaxyformation simulations: improved treatments of multiphase gas, of star formation\nand of supernovae feedback. Mon. Not. R. Astron. Soc., 345:561\u2013574, 2003.\n10. J. J. Monaghan. Smoothed particle hydrodynamics. Rep. Prog. Phys., 68:1703\u2013\n1759, 2005.\n11. D. Price. Magnetic Fields in Astrophysics. Ph.d., Institute of Astronomy, University of Cambridge, August 2004.\n12. G. A. Sod. A survey of several finite difference methods for systems of nonlinear\nhyperbolic conservation laws. J. Comput. Phys., 27(1):1\u201331, 1978.\n13. H. Wendland. Piecewise polynomial, positive definite and compactly supported\nradial functions of minimal degree. Adv. Comput. Math., 4(4):389\u2013396, 1995.\n14. H. Wendland. Local polynomial reproduction and moving least squares approximation. IMA J. Numer. Anal., 21(1):285\u2013300, 2001.\n\n\f"}