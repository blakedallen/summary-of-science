{"id": "http://arxiv.org/abs/math/0612667v1", "guidislink": true, "updated": "2006-12-21T20:39:59Z", "updated_parsed": [2006, 12, 21, 20, 39, 59, 3, 355, 0], "published": "2006-12-21T20:39:59Z", "published_parsed": [2006, 12, 21, 20, 39, 59, 3, 355, 0], "title": "Computing central values of $L$-functions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0612630%2Cmath%2F0612417%2Cmath%2F0612539%2Cmath%2F0612429%2Cmath%2F0612052%2Cmath%2F0612022%2Cmath%2F0612006%2Cmath%2F0612657%2Cmath%2F0612708%2Cmath%2F0612594%2Cmath%2F0612169%2Cmath%2F0612680%2Cmath%2F0612591%2Cmath%2F0612634%2Cmath%2F0612485%2Cmath%2F0612575%2Cmath%2F0612066%2Cmath%2F0612342%2Cmath%2F0612445%2Cmath%2F0612733%2Cmath%2F0612801%2Cmath%2F0612752%2Cmath%2F0612862%2Cmath%2F0612667%2Cmath%2F0612057%2Cmath%2F0612302%2Cmath%2F0612053%2Cmath%2F0612493%2Cmath%2F0612447%2Cmath%2F0612477%2Cmath%2F0612122%2Cmath%2F0612305%2Cmath%2F0612324%2Cmath%2F0612175%2Cmath%2F0612035%2Cmath%2F0612779%2Cmath%2F0612585%2Cmath%2F0612616%2Cmath%2F0612762%2Cmath%2F0612772%2Cmath%2F0612432%2Cmath%2F0612789%2Cmath%2F0612520%2Cmath%2F0612827%2Cmath%2F0612852%2Cmath%2F0612552%2Cmath%2F0612532%2Cmath%2F0612196%2Cmath%2F0612646%2Cmath%2F0612506%2Cmath%2F0612809%2Cmath%2F0612715%2Cmath%2F0612422%2Cmath%2F0612791%2Cmath%2F0612692%2Cmath%2F0612838%2Cmath%2F0612389%2Cmath%2F0612322%2Cmath%2F0612524%2Cmath%2F0612511%2Cmath%2F0612386%2Cmath%2F0612799%2Cmath%2F0612749%2Cmath%2F0612834%2Cmath%2F0612304%2Cmath%2F0612162%2Cmath%2F0612857%2Cmath%2F0612362%2Cmath%2F0612556%2Cmath%2F0612135%2Cmath%2F0612178%2Cmath%2F0612675%2Cmath%2F0612225%2Cmath%2F0612574%2Cmath%2F0612377%2Cmath%2F0612277%2Cmath%2F0612019%2Cmath%2F0612363%2Cmath%2F0612014%2Cmath%2F0612670%2Cmath%2F0612111%2Cmath%2F0612046%2Cmath%2F0612320%2Cmath%2F0612771%2Cmath%2F0612759%2Cmath%2F0612668%2Cmath%2F0612755%2Cmath%2F0612098%2Cmath%2F0612248%2Cmath%2F0612618%2Cmath%2F0612375%2Cmath%2F0612156%2Cmath%2F0612346%2Cmath%2F0612458%2Cmath%2F0612562%2Cmath%2F0612224%2Cmath%2F0612565%2Cmath%2F0612571%2Cmath%2F0612177%2Cmath%2F0612348%2Cmath%2F0612382&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Computing central values of $L$-functions"}, "summary": "This is a mostly expository note concerning the following question: How fast\ncan we compute the value of an L-function at the center of the critical strip?\nIt is the writeup of my talk at the Matrix Ensembles and L-Functions workshop\nat the Isaac Newton Institute for Mathematical Sciences in Cambridge, UK on\nJuly 2005.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0612630%2Cmath%2F0612417%2Cmath%2F0612539%2Cmath%2F0612429%2Cmath%2F0612052%2Cmath%2F0612022%2Cmath%2F0612006%2Cmath%2F0612657%2Cmath%2F0612708%2Cmath%2F0612594%2Cmath%2F0612169%2Cmath%2F0612680%2Cmath%2F0612591%2Cmath%2F0612634%2Cmath%2F0612485%2Cmath%2F0612575%2Cmath%2F0612066%2Cmath%2F0612342%2Cmath%2F0612445%2Cmath%2F0612733%2Cmath%2F0612801%2Cmath%2F0612752%2Cmath%2F0612862%2Cmath%2F0612667%2Cmath%2F0612057%2Cmath%2F0612302%2Cmath%2F0612053%2Cmath%2F0612493%2Cmath%2F0612447%2Cmath%2F0612477%2Cmath%2F0612122%2Cmath%2F0612305%2Cmath%2F0612324%2Cmath%2F0612175%2Cmath%2F0612035%2Cmath%2F0612779%2Cmath%2F0612585%2Cmath%2F0612616%2Cmath%2F0612762%2Cmath%2F0612772%2Cmath%2F0612432%2Cmath%2F0612789%2Cmath%2F0612520%2Cmath%2F0612827%2Cmath%2F0612852%2Cmath%2F0612552%2Cmath%2F0612532%2Cmath%2F0612196%2Cmath%2F0612646%2Cmath%2F0612506%2Cmath%2F0612809%2Cmath%2F0612715%2Cmath%2F0612422%2Cmath%2F0612791%2Cmath%2F0612692%2Cmath%2F0612838%2Cmath%2F0612389%2Cmath%2F0612322%2Cmath%2F0612524%2Cmath%2F0612511%2Cmath%2F0612386%2Cmath%2F0612799%2Cmath%2F0612749%2Cmath%2F0612834%2Cmath%2F0612304%2Cmath%2F0612162%2Cmath%2F0612857%2Cmath%2F0612362%2Cmath%2F0612556%2Cmath%2F0612135%2Cmath%2F0612178%2Cmath%2F0612675%2Cmath%2F0612225%2Cmath%2F0612574%2Cmath%2F0612377%2Cmath%2F0612277%2Cmath%2F0612019%2Cmath%2F0612363%2Cmath%2F0612014%2Cmath%2F0612670%2Cmath%2F0612111%2Cmath%2F0612046%2Cmath%2F0612320%2Cmath%2F0612771%2Cmath%2F0612759%2Cmath%2F0612668%2Cmath%2F0612755%2Cmath%2F0612098%2Cmath%2F0612248%2Cmath%2F0612618%2Cmath%2F0612375%2Cmath%2F0612156%2Cmath%2F0612346%2Cmath%2F0612458%2Cmath%2F0612562%2Cmath%2F0612224%2Cmath%2F0612565%2Cmath%2F0612571%2Cmath%2F0612177%2Cmath%2F0612348%2Cmath%2F0612382&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "This is a mostly expository note concerning the following question: How fast\ncan we compute the value of an L-function at the center of the critical strip?\nIt is the writeup of my talk at the Matrix Ensembles and L-Functions workshop\nat the Isaac Newton Institute for Mathematical Sciences in Cambridge, UK on\nJuly 2005."}, "authors": ["Fernando Rodriguez Villegas"], "author_detail": {"name": "Fernando Rodriguez Villegas"}, "author": "Fernando Rodriguez Villegas", "links": [{"href": "http://arxiv.org/abs/math/0612667v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0612667v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0612667v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0612667v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0612667v1 [math.NT] 21 Dec 2006\n\nCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\n1.\nHow fast can we compute the value of an L-function at the center of the critical\nstrip?\nWe will divide this question into two separate questions while also making it\nmore precise. Fix an elliptic curve E defined over Q and let L(E, s) be its L-series.\nFor each fundamental discriminant D let L(E, D, s) be the L-series of the twist ED\nof E by the corresponding quadratic character; note that L(E, 1, s) = L(E, s).\nA. How fast can we compute the central value L(E, 1)?\nB. How fast can we compute L(E, D, 1) for D in some interval say a \u2264 D \u2264 b?\nThese questions are obviously related but, as we will argue below, are not identical.\nWe should perhaps clarify what to compute means. First of all, we know, thanks\nto the work of Wiles and others, that L(E, s) = L(f, s) for some modular form f\nof weight 2; hence, L(E, s), first defined on the half-plane R(s) > 3/2, extends to\nan analytic function on the whole s-plane which satisfies a functional equation as\ns goes to 2 \u2212 s. In particular, it makes sense to talk about the value L(E, 1) of\nour L-function at the center of symmetry s = 1. The same reasoning applies to\nL(E, D, s).\nAs a first approximation to our question we may simply want to know the real\nnumber L(E, D, 1) to some precision given in advance; but we can expect something\nbetter. The Birch\u2013Swinnerton-Dyer conjectures predict a formula of type\n(1)\n\nL(E, D, 1) = \u03baD m2D ,\n\nfor some integer mD and \u03baD an explicit easily computable positive constant. (Up\nto the usual fudge factors the conjectures predict that m2D , if non-zero, should be\nthe order of the Tate\u2013Shafarevich group of ED .) To compute L(E, D, 1) would then\nmean to calculate mD exactly.\nIn fact, formulas \u00e0 la Waldspurger have the form (1) with mD the |D|-th coefficient of a modular form g of weight 3/2 which is in Shimura correspondance with\nf . The main point of this note is to discuss informally how explicit versions of such\nformulas can be used for problem B above.\nLet us also note the interesting fact that mD , being related to the coefficient of\na modular form, typically does not have a constant sign. The significance of the\nextra information provided by sgn(mD ) remains a tantalizing mystery.\n2.\nThere is a standard analytic method to compute L(E, 1), which we now recall.\nIf E has conductor N then the associated modular form f has level N and\nf |wN = \u2212\u03b5f,\n1\n\n\f2\n\nCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\nwhere wN is the Fricke involution and \u03b5 is the sign of the functional equation for\nL(E, s). Concretely, we have\n\u0012\n\u0013\n\u0012\n\u0013\ni\nit\n2\n\u221a\n\u221a\nf\n= \u03b5t f\n,\nt \u2208 R.\nNt\nN\nIt follows that\n\u0012\n\u0013\u2212s\n\u0013\nZ \u221e \u0012\n2\u03c0\ndt\nit\n\u221a\nts .\n\u0393(s)L(f, s) =\nf \u221a\nt\nN\nN\n0\nR1 R\u221e\nNow break the integral as 0 + 1 , make the substitution t 7\u2192 1/t in the first and\nuse the functional equation to obtain\n\u0013\u2212s\n\u0013\n\u0013\n\u0012\nZ \u221e \u0012\nZ \u221e \u0012\ndt\ndt\nit\nit\n2\u03c0\n\u221a\nts\nt2\u2212s .\n\u0393(s)L(f, s) =\nf \u221a\n+\u03b5\nf \u221a\nt\nt\nN\nN\nN\n1\n1\n(This is the classical argument to prove the functional equation of L(E, s) and goes\nback to Riemann who used it for his zeta function.)\nNow plug in s = 1 to get\n\u221a\n\u221a\nX an\nN\n(2)\nL(E, 1) = (1 + \u03b5)\ne\u22122\u03c0n/ N\n2\u03c0\nn\nn\u22651\n\nwhere f has Fourier expansion\nf=\n\nX\n\nan q n ,\n\nq = e2\u03c0iz .\n\nn\u22651\n\nAssume for simplicity that gcd(N, D) = 1. Then the conductor of ED is N D2 and\n(2) applied to ED yields, more generally,\n\u221a\n\u221a\nX \u0012 D \u0013 an\n|D| N\nL(E, D, 1) = (1 + \u03b5D )\ne\u22122\u03c0n/|D| N ,\n(3)\n2\u03c0\nn\nn\nn\u22651\n\nwith \u03b5D the sign in the functional equation of L(E, D, s).\nWe know that |an | grows no more than polynomially with n (a straightforward\nargument gives |an | = O(n)). It follows that for a fixed E and varying D we will\nneed to take, very roughly, of the order of O(|D|) terms in the sum to obtain a decent\napproximation to L(E, D, 1). Assuming the Birch\u2013Swinnerton-Dyer conjectures we\nmay use (3) to compute m2D in (1) exactly. However, if we know that mD is the D-th\ncoefficient of some specific modular form (i.e. we have a formula \u00e0 la Waldspurger)\nwe would get |mD | but would not be able to recover sgn(mD ).\nUsing this method to compute, say, L(E, D, 1) for |D| \u2264 X would take time\nof the order of O(X 2 ). We will see below that using formulas of type (1) we can\nreduce this to O(X 3/2 ) for at least some fraction of such D's.\n3.\nBefore tackling L(E, D, 1) let us consider the case of the special value of an\nEisenstein series of weight 2 (as opposed to a cusp form as we have for L(E, D, 1)).\nWhat follows is meant only as\u0001an illustration\n\u0001 of the general case.\nLet the L-function be L( D* , s \u2212 1)L( D* , s) with D < 0 the discriminant of an\nimaginary quadratic field K. Its value at s = 1 is essentially h(D)2 , where h(D) is\nthe class number of K, and we find an analogue of (1) with h(D) playing the role\nof mD . There are many excellent algorithms for computing the class number h(D)\n\n\fCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\n3\n\n(see for example [1] chap. 5). Unfortunately, these do not obviously generalize to\nthe calculation of mD . The main reason for this is that the class group of K is\neasy to describe (both its elements and the group operation) in terms of binary\nquadratic forms, whereas its elliptic analogue, the Tate-Shafarevich group of ED ,\nis notoriously intractable.\nThe standard analytic method of the previous section yields the following formula\n(which was known to Lerch, see [2] vol. III, p. 171)\np\n\u0012 \u0013\n2\nwD\n|D| X D \u03c3(n) \u22122\u03c0n/|D|\n2\ne\n,\n(4)\nh(D) =\n2\u03c0\nn\nn\nn\u22651\n\nP\nwhere wD is the number of units in K and \u03c3(n) :=\nd|n d is the divisor sum\nfunction. Again, we need to take, roughly, O(|D|) number of terms in the sum to\nobtain a reasonable approximation of the left hand side. In this case, we in fact\nhave an exact formula requiring D terms, namely, Dirichlet's class number formula\n(5)\n\n\u0013\n|D|\u22121 \u0012\nD\nwD X\n.\nn\nh(D) = \u2212\n2|D| n=1\nn\n\nNeither one of these formulas is, however, particularly useful for computing h(D) in\npractice. On the other hand, it may be worth pointing out that similar arguments\nyield the formula [2] vol. III, p. 153.\nX \u0012D\u0013\n1\n\u221a ,\nh(D) = wD\nD \u2261 5 mod 8,\nn 1 \u2212 (\u22121)n e\u03c0n/ |D|\nn\u22651\np\nwith the number of necessary steps now reduced to the order of O( |D|). (Analogous formulas can be given for D in other congruence classes modulo 8.)\nTo make the connection to the general case of computing L(E, D, 1) that we are\nconsidering we mention two other possible approaches to computing h(D) that do\ngeneralize.\n(I) The first is to follow Gauss and realize ideal classes of K as classes of primitive,\npositive definite binary quadratic forms of discriminant D. Each class has a unique\nrepresentative Q = (a, b, c) in the standard fundamental domain (what is known as\na reduced form) and we can simply enumerate these. A straightforward\nalgorithm\np\nis as follows: run over values of b with b \u2261 D mod 2 and 0 \u2264 b \u2264 |D|/3; for each\nb decompose (b2 \u2212 D)/4 as ac with 0 < a \u2264 c. Add one or two to the total count\nas the case may be if gcd(a, b, c) = 1.\nThough this algorithm also takes time O(|D|) the constant of proportionality is\nvery small making the algorithm quite practical. An important point to notice for\nour purpose, however, is that if we wanted to compute\np h(D) for 0 \u2264 |D| \u2264 X we\nmay simply run over all triples a, b, c of size at most X/3 checking the necessary\nconditions on (a, b, c) for it to be a reduced form. In this way we obtain an algorithm\nwhich will run in time O(X 3/2 ).\n(II) The second approach is again to follow Gauss but in a different direction. He\nproved that h(D) is related to the number of representations of |D| as a sum of\nthree squares. One precise form of this relation is the following identity (see [3]\n\n\f4\n\nCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\np.177)\n(6)\n\n1\n2\n\nX\n\nx\u2261y\u2261z mod 2\n\nqx\n\n2\n\n+y 2 +z 2\n\n=\n\n1\n2\n\n+ 12\n\nX\n\nH2 (D) q |D|\n\nD\n\nwhere D runs through all negative discriminants (i.e. D < 0 and D \u2261 0, 1 mod 4),\nand H2 is a variant of the Hurwitz class number (see [3], page 120). (For us it suffices\nto know that it is related to h(D); for example for D \u2261 5 mod 8 a fundamental\ndiscriminant we have H2 (D) = h(D).)\nThere are sophisticated techniques for computing the coefficients of the left hand\nside, such as convolution which uses the fast Fourier transform to compute products\nof q-series. But even a simple enumeration of the lattice points x2 +y 2 +z 2 \u2264 X, x \u2261\ny \u2261 z mod 2 would again take time O(X 3/2 ).\nThe two approaches (I) and (II) are of course related; they amount to counting\n(in an appropriate sense) the number of representations of D by a certain ternary\nquadratic form. In case (I) we count the number of solutions to b2 \u2212 4ac = D\nup to SL2 (Z)-equivalence; in (II), the number of solutions to |D| = x2 + y 2 + z 2\nwith x \u2261 y \u2261 z mod 2. Note the crucial difference that the ternary quadratic form\ninvolved is indefinite in case (I) and positive definite in case (II).\nA more geometrical point of view is to think that we are dealing with Heegner\npoints. In case (I) we may associate to a primitive\npositive definite binary quadratic\n\u221a\nform Q = (a, b, c) the point zQ = (\u2212b + D)/2a in the upper half plane H. The\nrespective actions of SL2 (Z) on forms and H are compatible; hence, the class of Q\ndetermines a unique (Heegner) point in SL2 (Z)\\H of discriminant D.\nIt is a bit less intuitive how to think of Heegner points in case (II) but this\nwas worked out by Gross [3]. The main ingredient is a positive definite quaternion\nalgebra B over Q ramified, say, at \u221e and a prime N . Pick a maximal order R of\nB and let I1 , . . . , In be representatives for the (left) ideal classes of R. Let Ri be\nthe right order of Ii for i = 1, * * * , n.\nFix an imaginary quadratic field K of discriminant D. Then we can think of a\nHeegner point of discriminant D (what Gross calls a special point) as an (optimal)\nembedding of the ring of integers OK into some Ri . Eichler has proved that the\n\u0001 total\nD\n)h(D).\nnumber of such points, each counted up to conjugation by Ri\u22c6 , is (1 \u2212 N\n(In fact, the situation is quite analogous to that of case (I) if we take the indefinite\nalgebra B = M2 (Q) and R = M2 (Z).)\nFor example, if N = 2 then the algebra B is the usual Hamilton quaternions and\nwe may pick R to be the order discovered by Hurwitz (in standard notation)\nR = Z + Zi + Zj + Z 12 (1 + i + j + k).\nIn this case there is only one class of left R-ideals represented by R itself. Hence a\nHeegner point is an embedding \u03c6 : OK \u2192 R.\nHow do we find such embeddings? The main thing we need is a w \u2208 R with\nw2 = D. Such a quaternion, because D is a scalar, necessarily has trace t(w) = 0\nand norm n(w) = \u2212D and conversely. Elements of trace 0 in R form a rank 3 lattice\nand hence n(w) = \u2212D is a representation of D by a certain ternary quadratic form\nassociated to R. A few congruence conditions are needed to actually produce an\noptimal embedding \u03c6 out of w but the upshot is that the problem becomes one\nabout representations of \u2212D by ternary quadratic forms. For example, in the case\nN = 2 Eichler's count of embeddings can be completely encoded in the identity\n\n\fCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\n5\n\n(6); the presence of the factor 12 in that formula is due to the fact that this is the\norder of R\u22c6 / \u00b1 1. More details on this setup are given below in \u00a74 (II).\n4.\nWe now return to the main case of computing L(E, D, 1) and describe analogues\nof cases (I) and (II) of the previous section. These analogues are the remarkable\nresults of Gross and Zagier.\n(I) Let us assume for simplicity that E has conductor a prime N , sign of the\nfunctional equation equal to \u22121, L\u2032 (E, 1) 6= 0, and E(Q) = hP0 i. If f is the weight\n2 eigenform associated to E then we get a map\n(7)\n\n\u03a6:\n\nX0 (N )\nz\n\n\u2212\u2192\nR zC/L\n7\u2192 2\u03c0i i\u221e f (u) du\n\nwhere X0 (N ) is the modular curve of level N and L \u2282 C is a certain lattice of\nperiods of f . It is known that C/L = E \u2032 (C) for some elliptic curve E \u2032 /Q isogenous\nto E. Since the L-function is unchanged by isogenies we may assume without loss\nof generality that E \u2032 = E.\nLet K be an imaginary quadratic field of discriminant D < \u22124 in which N\nsplits. Choose b\u2217 \u2208 Z such that b2\u2217 \u2261 D mod N ; this is possible by the assumption\nthat N splits in K. Note also that N does not divide b\u2217 . We want to consider\nHeegner points on X0 (N ) of discriminant D. To define them concretely choose\nrepresentatives Q = (a, b, c) of the h(D) classes of binary quadratic forms with\nN | a and b \u2261 b\u2217 mod N . (For example, start with representatives (a, b, c) with\ngcd(a, N ) = 1 and compose\nthem with the fixed form (N, b\u2217 , (b2\u2217 \u2212 D)/2N ).)\n\u221a\nP\nThen zQ := (\u2212b + D)/2/a) \u2208 X0 (N ) is well defined and PD := Q \u03a6(zQ ) \u2208\nE(K). Moreover, complex conjugation fixes PD , by the assumption on the sign of\nthe functional equation. Hence PD actually is in E(Q) (and is independent of the\nchoice of b\u2217 ).\nOne consequence of the results of Gross\u2013Zagier is the following [15],[4], [5]. By\nour assumption on E(Q) we have PD = mD P0 for some mD \u2208 Z and hence\n(8)\n\nL(E, D, 1) = \u03baD m2D ;\n\nwhere \u03baD is an explicit easily computable positive constant; i.e. we have a formula\nof type (1).\nUsually one regards the Gross-Zagier formula as a way to compute a rational\npoint PD on E whose height is given in terms of L(E, D, 1)L\u2032 (E, 1) and hence\nobtaining, when this value does not vanish, a confirmation of the predictions of the\nBirch\u2013Swinnerton-Dyer conjecture. Here, instead, we are taking the point of view\nthat the points of E(Q) are known and use the Gross\u2013Zagier formula as a means\nto computing L(E, D, 1).\nTo calculate mD in practice it is better to work on the E(C) = C/L model of\nE rather than, say, a Weierstrass equation. Let z0 \u2208 C represent, modulo L, the\npoint P0 \u2208 E(Q). We first compute an approximation to\nX X an\nzD :=\ne2\u03c0inzQ .\nn\nQ n\u22651\n\nThen we solve the linear equation below for integers n1 and n2\nz Q = mD z 0 + n 1 \u03c9 1 + n 2 \u03c9 2 ,\n\n\f6\n\nCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\nwhere \u03c91 , \u03c92 are a basis for L. (In fact, multiplying by 2 if necessary, we may\nassume that \u03c91 \u2208 R and \u03c91 \u2208 iR and hence by taking real parts solve only a three\nterm equation instead.)\nThe result is a practical and reasonably efficient algorithm for computing mD .\nThe number mD is the D-th Fourier coefficient of a weight 3/2 modular form g of\nlevel 4N which is in Shimura correspondence with f . It is interesting that we can\ncompute the Fourier coefficients of g directly without any knowledge of the whole\nvector space of modular forms in which g lies; though we do, of course, start by\nknowing f itself. (We have only described the calculation for certain D's but there\nis analogous way to get all coefficients.)\nTogether with my student Ariel Pacetti we implemented the above algorithm in\nGP. The corresponding routines can be found at\nhttp://www.ma.utexas.edu/users/villegas/cnt/\nunder Heegner points.\nHere is a sample example. Let E be the curve y 2 + y = x3 \u2212 x of conductor\nN = 37 (this is the elliptic curve over Q of positive rank with smallest conductor).\nThis case was described in detail in [15]. It is known that E(Q) = h(0, 0)i.\n? e=ellinit([0,0,1,-1,0]); anvec=ellan(e,5000);\n? for(d=5,100, if(isfundamental(-d) && kronecker(-d,37)==1,\nprint(-d,\" \",ellheegnermult(e,-d,[0,0],0,anvec)[1])))\n-7\n1\n\n-11 -40 -47 -67\n-1 -2\n1 -6\n\n-71 -83\n-1\n1\n\n-84 -95\n1\n0\n\nThe first row is D, the second mD (for typographical reasons we transposed the\nactual GP output). These values agree, fortunately, with Zagier's [15] formula (28)\nup to a global negative sign.\nIn our implementation at least the algorithm is not that well suited for computing\nL(E, D, 1) for all D < 0 and |D| < X for very large X; for this, it would be better\nto adapt (see \u00a75) the ideas of (II) below but these have not been fully implemented\nas yet.\n(II) Let B over Q be the (unique up to isomorphism) positive definite quaternion\nalgebra ramified at \u221e and a prime N . Pick a maximal order R of B and let\nI1 , . . . , In be representatives for the (left) ideal classes of R. Let Ri be the right\norder of Ii for i = 1, * * * , n. The class number n of R, in contrast with h(D), has a\nsimple formula and is roughly of size N/12.\nFor example, if N \u2261 3 mod 4 we can describe B as the algebra over Q with\ngenerators i, j such that i2 = \u22121, j 2 = \u2212N and ij = \u2212ji. Also in this case we can\ntake R = Z + Zi + Z 21 (1 + j) + Zi 21 (1 + j).\nThere are various ways to compute representatives I1 , * * * , In of the ideal classes\n(for algorithms for quaternion algebras see [11]). If N \u2261 3 mod 4 there is an\nalgorithm which is completely analogous to that of Gauss \u00a73 (I) for binary quadratic\nforms. It exploits the fact that our choice of R has an embedding of Z[i] and hence\nallows us to view R-left ideals as rank 2 modules over Z[i]; then classes of Rideals correspond to classes of positive definite binary Hermitian forms over Z[i] of\ndiscriminant \u2212N . Instead of H we now need to work on hyperbolic 3-space where,\nas it turns out, the action of SL2 (Z[i]) has a very simple fundamental domain. This\n\n\fCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\n7\n\nyields an algorithm which is almost verbatim that of Gauss for binary forms over\nZ. Details can be found in [12].\nFor example, if N = 11 then there are two classes of positive definite binary\nHermitian forms of discriminant \u221211 over Z[i]; namely, (1, 1, 3) and (2, 1 + 2i, 2)\ncorresponding to the two ideals\nI0 := R = Z + Zi + Z 12 (1 + j) + Zi 21 (1 + j)\nand\nI1 := 2Z + Z2i + Z 21 (1 + 2i + j) + Zi 12 (1 + 2i + j)\nrepresenting the n = 2 classes of left R-ideals.\nLet VQ be the Q vector space of functions on the set {I0 , . . . , In }. For each\nm \u2208 Z\u22650 there is an operator B(m) acting on VQ , the Brandt matrix of order m,\nwhich encodes the number of representations of m by certain quaternary quadratic\nforms (see [3] (1.4)). Let B be the algebra generated over Z by all the B(m); it is\ncommutative and B \u2297Z Q is semisimple.\nOn the other hand, we have the space MC of modular form of weight 2 on \u03930 (N )\n(known to be of dimension n) and the Hecke operators Tm acting on MC . Let T\nbe the algebra spanned by the Tm over Z ; like B it is commutative and T \u2297Z Q is\nsemisimple. This algebra preserves the Q vector space MQ \u2282 MC of dimension n\nconsisting of those modular forms in MC with Fourier coefficients in Q.\nThese two setups are closely related and indeed we have a special case of the\nJacquet\u2013Langlands correspondence. Eichler proved that Tm and B(m) have the\nsame trace for all m \u2208 N. Hence, by semisimplicity of the algebras the map Tm 7\u2192\nB(m) induces a ring isomorphism T \u2243 B. It follows that eigenspaces of VQ and\nMQ , under the action of B and T respectively, correspond to each other. Since we\nalso have multiplicity one these\nP eigenspaces are one-dimensional.\nIn conclusion, given f = n\u22650 an q n \u2208 MC an eigenform for all Hecke operators\nTm (so that Tm f = am f ) there is an ef \u2208 VQ \u2297Z K unique up to scalars such that\nB(m)ef = am ef . (Here K denotes the field Q(a0 , a1 , . . .) generated by the Fourier\ncoefficients of f .)\nIn fact, this correspondence gives an efficient way to compute Fourier coefficients\nof eigenforms in MC (see [11]). An implementation of the corresponding algorithms\ncan be found in the above mentioned website (under qalgmodforms). Here is a\nsample GP session.\n? R=qsetprime(11);\n? brandt(R,2)~\n[1 3]\n[2 0]\n? brandt(R,3)~\n[2 3]\n[2 1]\n\n\f8\n\nCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\nThe first line defines R as a maximal order in the algebra ramified at 11 and \u221e; the\nothers compute the corresponding Brandt matrices. We find that these matrices\nhave two eigenvectors: eE = (1/2, 1/3) and ef = (\u22121, 1) corresponding to an\nEisenstein series and a cusp form, respectively.\nThe above implementation is intended for small to medium scale computations.\nFor large scale computations one should use the graph method ideas of Mestre and\nOesterl\u00e9 [8], which exploit the sparse nature of the Brandt matrices.\nNow following Gross we show how to associate a modular form of weight 3/2 to\nan eigenvector ef . Let Ri be the right order of Ii and let Li \u2282 Ri be the ternary\nlattice defined by\nLi :\n\nw \u2208 Ri ,\n\nt(w) = 0,\n\nLet gi be the corresponding theta series\nX\nq n(w) ,\ngi (\u03c4 ) := 12\n\nw \u2208 Z mod 2Ri .\nq = e2\u03c0i\u03c4 .\n\nw\u2208Li\n\nGross [3] prop. 12.9 describes precisely how the D-th coefficient\u221aai (D) of gi relates\nto the optimal embeddings of imaginary quadratic orders of Q( D) into Ri .\nThese theta series are modular forms of weight 3/2 and level 4N and, in fact,\nbelong to a certain subspace U defined by Kohnen. This subspace is determined by\nthe condition that the coefficient of q d of a \u0001form should be zero unless D := \u2212d is a\nD\n6= 1. The weight 3/2 Hecke operators\ndiscriminant, i.e., D \u2261 0, 1 mod 4, and N\nTm2 preserve U .\nDefine\nX\nX\nef (i) gi =\nmD q |D| \u2208 U.\ng :=\ni\n\nD\n\nThis form is identically zero if the sign in the functional equation of f is \u22121. If g is\nnon-zero it is a modular form in Shimura correspondence with f ; i.e., Tm2 g = am g,\nwhere Tm f = am f . Moreover, we have the Waldspurger formula [3] 13.5\n\u03b4D\n(9)\nL(f, 1)L(f \u2297 \u03c7D , 1) = \u03baf p\nm2D ,\n|D|\n\u0001\nD\nwhere D is a fundamental discriminant with N\n6= 1, \u03c7D is the associated quadratic character, \u03baf > 0 is a constant depending only on f and \u03b4D := 2 if N | D\nand \u03b4D := 1 otherwise.\nFinally, let E/Q be an elliptic curve of prime conductor N and sign +1 in its\nfunctional equation. Let f and g be the corresponding modular forms of weight 2\nand 3/2 respectively as above. Then if L(f, 1) 6= 0 we obtain from (9) a formula\nof type (1) with mD the Fourier coefficient of g. As in \u00a73 (II) to compute mD for\n|D| < X we could run through all w \u2208 Li with n(w) \u2264 X whose total number\nis O(X 3/2 ). Again various computational techniques could also be used to speed\nup the calculation of mD . Note that in any case all computations are done with\ninteger arithmetic.\nTables of mD 's for several curves and the routines to compute them can be found\nat G. Tornar\u0131\u0301a's website\nhttp://www.ma.utexas.edu/users/tornaria/cnt/\namong other goodies (an interactive version of Cremona's tables of elliptic curves\nand an interactive table of ternary quadratic forms).\n\n\fCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\n9\n\n5.\nWe conclude with some remarks about the general situation.\n1. It follows from (9) that if L(f, 1) = 0 then the form g vanishes identically. In\nthis case we naturally need to do something else.\nIn [7] we work out an extension of Gross's work introducing an auxiliary prime\nl; the theta series gi , for example, are modified by introducing an appropriate\nweight function. The complexity of algorithms only increase by a factor essentially\nproportional to l.\n2. If the level N is not prime but square-free the situation is not too different\nfrom the one described above. The downside is that L(E, D, 1) can be computed\nthis way only for a certain fraction of D's (determined by local conditions). One\nneeds to consider a quaternion algebra B ramified at \u221e and at primes l | N for\nwhich the Atkin-Lehner involution acts as f |wl = \u2212f and an Eichler order in B of\nlevel the product of the remaining primes factors of N .\n3.\nIf the level is not square-free things become quite a bit more complicated;\nfor example, the algebra B of Brandt matrices typically does not act with multiplicity one and some modular forms are simply missing. The arithmetic of the\ncorresponding orders, which are no longer Eichler orders in general, also becomes\nmore involved and, moreover, one needs to consider two types of orders: one for\nthe weight 2 side and another for the weight 3/2 side; see [9], [10], [14] some work\non this case.\n\u221a\n4. To compute twists L(f \u2297 \u03c7l , 1) by real quadratic fields Q( l) one\u221amay consider\na twist fD := f \u2297 \u03c7D by an auxiliary imaginary quadratic field Q( D) and find\na formula of type (1) for L(fD \u2297 \u03c7Dl , 1). The form fD typically does not have\nsquare-free level so several corresponding difficulties ensue, see [14].\n5.\nForms of higher weight can also be handled using quaternion algebras by\nintroducing harmonic polynomials as weight functions for the theta functions (both\nfor the ideals Ii corresponding to forms of weight 2 + 2r and for the ternary lattices\nLi corresponding to forms of weight 3/2 + r) see [6], [13].\nReferences\n[1] H. Cohen, A course in computational algebraic number theory, GTM 138, SpringerVerlag, Berlin, (1993).\n[2] L. Dickson, History of the theory of numbers, Chelsea Pub. Co., New York (1966).\n[3] B. Gross, Heights and the special values of L-series, Number theory (Montreal, Que.,\n1985), 115\u2013187, CMS Conf. Proc., 7, Amer. Math. Soc., Providence, RI, (1987).\n[4] B. Gross and D. Zagier, Heegner points and derivatives of L-series, Invent. Math. 84\n(1986), 225\u2013320.\n[5] B. Gross, W. Kohnen and D. Zagier, Heegner points and derivatives of L-series. II,\nMath. Ann. 278 (1987), 497\u2013562.\n[6] R. Hatcher, Heights and L-series, Canad. J. Math. 42,(1990), 533\u2013560.\n[7] Z. Mao, F. Rodriguez-Villegas, G. Tornar\u0131\u0301a, Computation of central value of quadratic\ntwists of modular L-functions, To appear in \"Ranks of Elliptic Curves and Random\nMatrix Theory\" (2005).\n[8] J.-F., Mestre, La m\u00e9thode des graphes. Exemples et applications, Proceedings of the\ninternational conference on class numbers and fundamental units of algebraic number\nfields (Katata, 1986), 217\u2013242, Nagoya Univ., Nagoya, 1986.\n\n\f10\n\nCOMPUTING CENTRAL VALUES OF L-FUNCTIONS\n\n[9] A. Pacetti and F. Rodriguez-Villegas (appendix by B. Gross), Computing Weight 2\nModular forms of level p2 Math. Comp. 251, (2004), 1545\u20131557.\n[10] A. Pacetti, G. Tornar\u0131\u0301a, Examples of Shimura correspondence for level p2 and real\nquadratic twists To appear in \"Ranks of Elliptic Curves and Random Matrix Theory\"\n(2005).\n[11] A. Pizer, An Algorithm for Computing Modular Forms on \u03930 (N ), Journal of Algebra\n64, (1980), 340-390.\n[12] F. Rodriguez-Villegas, Explicit models of genus 2 curves with split CM Algorithmic\nnumber theory (Leiden, 2000), 505\u2013513, Lecture Notes in Comput. Sci., 1838, Springer,\nBerlin, (2000).\n[13] H. Rosson, G. Tornar\u0131\u0301a, Central values of quadratic twists for a modular form of\nweight 4, To appear in \"Ranks of Elliptic Curves and Random Matrix Theory\" (2005).\n[14] A. Pacetti, G. Tornar\u0131\u0301a, Shimura correspondence for level p2 and the central values\nof L-series, preprint (2005).\n[15] D. Zagier, Modular points, modular curves, modular surfaces and modular forms,\nWorkshop Bonn 1984 (Bonn, 1984), 225\u2013248, Lecture Notes in Math., 1111, Springer,\nBerlin, (1985).\n\nDepartment of Mathematics\nUniversity of Texas at Austin,\nTX 78712 USA\n\nvillegas@math.utexas.edu\n\n\f"}