{"id": "http://arxiv.org/abs/1005.0722v2", "guidislink": true, "updated": "2010-10-23T08:46:06Z", "updated_parsed": [2010, 10, 23, 8, 46, 6, 5, 296, 0], "published": "2010-05-05T11:51:44Z", "published_parsed": [2010, 5, 5, 11, 51, 44, 2, 125, 0], "title": "On Theta-palindromic Richness", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1005.3077%2C1005.3768%2C1005.2462%2C1005.4277%2C1005.2207%2C1005.0698%2C1005.3809%2C1005.1244%2C1005.3656%2C1005.4212%2C1005.2508%2C1005.0117%2C1005.4419%2C1005.0059%2C1005.5542%2C1005.2380%2C1005.2067%2C1005.0273%2C1005.3665%2C1005.4520%2C1005.2969%2C1005.4198%2C1005.0606%2C1005.0046%2C1005.1069%2C1005.2750%2C1005.1536%2C1005.5460%2C1005.1948%2C1005.5446%2C1005.0766%2C1005.4128%2C1005.4801%2C1005.4988%2C1005.3026%2C1005.4878%2C1005.4743%2C1005.2784%2C1005.4192%2C1005.0413%2C1005.0516%2C1005.0629%2C1005.5141%2C1005.1398%2C1005.3099%2C1005.5189%2C1005.4736%2C1005.0934%2C1005.2578%2C1005.3298%2C1005.5561%2C1005.2159%2C1005.5352%2C1005.1077%2C1005.5515%2C1005.2469%2C1005.2014%2C1005.1021%2C1005.1216%2C1005.4267%2C1005.2944%2C1005.1680%2C1005.2419%2C1005.0722%2C1005.0400%2C1005.0348%2C1005.0370%2C1005.0196%2C1005.0422%2C1005.2195%2C1005.2755%2C1005.1150%2C1005.1891%2C1005.2061%2C1005.3856%2C1005.1379%2C1005.1362%2C1005.4339%2C1005.5030%2C1005.1149%2C1005.4054%2C1005.4979%2C1005.3242%2C1005.5180%2C1005.3610%2C1005.4806%2C1005.5131%2C1005.5123%2C1005.2670%2C1005.2399%2C1005.4307%2C1005.0123%2C1005.0079%2C1005.3702%2C1005.0818%2C1005.2686%2C1005.4795%2C1005.5270%2C1005.0970%2C1005.0147%2C1005.1751&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On Theta-palindromic Richness"}, "summary": "In this paper we study generalization of the reversal mapping realized by an\narbitrary involutory antimorphism $\\Theta$. It generalizes the notion of a\npalindrome into a $\\Theta$-palindrome -- a word invariant under $\\Theta$. For\nlanguages closed under $\\Theta$ we give the relation between\n$\\Theta$-palindromic complexity and factor complexity. We generalize the notion\nof richness to $\\Theta$-richness and we prove analogous characterizations of\nwords that are $\\Theta$-rich, especially in the case of set of factors\ninvariant under $\\Theta$. A criterion for $\\Theta$-richness of\n$\\Theta$-episturmian words is given together with other examples of\n$\\Theta$-rich words.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1005.3077%2C1005.3768%2C1005.2462%2C1005.4277%2C1005.2207%2C1005.0698%2C1005.3809%2C1005.1244%2C1005.3656%2C1005.4212%2C1005.2508%2C1005.0117%2C1005.4419%2C1005.0059%2C1005.5542%2C1005.2380%2C1005.2067%2C1005.0273%2C1005.3665%2C1005.4520%2C1005.2969%2C1005.4198%2C1005.0606%2C1005.0046%2C1005.1069%2C1005.2750%2C1005.1536%2C1005.5460%2C1005.1948%2C1005.5446%2C1005.0766%2C1005.4128%2C1005.4801%2C1005.4988%2C1005.3026%2C1005.4878%2C1005.4743%2C1005.2784%2C1005.4192%2C1005.0413%2C1005.0516%2C1005.0629%2C1005.5141%2C1005.1398%2C1005.3099%2C1005.5189%2C1005.4736%2C1005.0934%2C1005.2578%2C1005.3298%2C1005.5561%2C1005.2159%2C1005.5352%2C1005.1077%2C1005.5515%2C1005.2469%2C1005.2014%2C1005.1021%2C1005.1216%2C1005.4267%2C1005.2944%2C1005.1680%2C1005.2419%2C1005.0722%2C1005.0400%2C1005.0348%2C1005.0370%2C1005.0196%2C1005.0422%2C1005.2195%2C1005.2755%2C1005.1150%2C1005.1891%2C1005.2061%2C1005.3856%2C1005.1379%2C1005.1362%2C1005.4339%2C1005.5030%2C1005.1149%2C1005.4054%2C1005.4979%2C1005.3242%2C1005.5180%2C1005.3610%2C1005.4806%2C1005.5131%2C1005.5123%2C1005.2670%2C1005.2399%2C1005.4307%2C1005.0123%2C1005.0079%2C1005.3702%2C1005.0818%2C1005.2686%2C1005.4795%2C1005.5270%2C1005.0970%2C1005.0147%2C1005.1751&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper we study generalization of the reversal mapping realized by an\narbitrary involutory antimorphism $\\Theta$. It generalizes the notion of a\npalindrome into a $\\Theta$-palindrome -- a word invariant under $\\Theta$. For\nlanguages closed under $\\Theta$ we give the relation between\n$\\Theta$-palindromic complexity and factor complexity. We generalize the notion\nof richness to $\\Theta$-richness and we prove analogous characterizations of\nwords that are $\\Theta$-rich, especially in the case of set of factors\ninvariant under $\\Theta$. A criterion for $\\Theta$-richness of\n$\\Theta$-episturmian words is given together with other examples of\n$\\Theta$-rich words."}, "authors": ["Stepan Starosta"], "author_detail": {"name": "Stepan Starosta"}, "author": "Stepan Starosta", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/j.tcs.2010.12.011", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1005.0722v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1005.0722v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "14 pages", "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "68R15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1005.0722v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1005.0722v2", "journal_reference": "Theoretical Computer Science, Volume 412, Issues 12-14, 18 March\n  2011, Pages 1111-1121", "doi": "10.1016/j.tcs.2010.12.011", "fulltext": "ON THETA-PALINDROMIC RICHNESS\n\narXiv:1005.0722v2 [math.CO] 23 Oct 2010\n\n\u0160T\u011aP\u00c1N STAROSTA\nAbstract. In this paper we study generalization of the reversal mapping realized by an arbitrary\ninvolutory antimorphism \u0398. It generalizes the notion of a palindrome into a \u0398-palindrome \u2013 a word\ninvariant under \u0398. For languages closed under \u0398 we give the relation between \u0398-palindromic complexity\nand factor complexity. We generalize the notion of richness to \u0398-richness and we prove analogous\ncharacterizations of words that are \u0398-rich, especially in the case of set of factors invariant under \u0398. A\ncriterion for \u0398-richness of \u0398-episturmian words is given together with other examples of \u0398-rich words.\n\n1. Introduction\nA palindrome is a word that reads the same from the left as from the right. In the last decade the\nstudy of palindromes in the field of combinatorics on words has notably grown. The motivation comes\nfor instance from the application in mathematical physics or diophantine approximation. Two notions\nwere mainly studied. First the palindromic complexity which counts the number of palindromes of\ngiven length in an infinite word. Its study resulted for example in a new equivalent definition of Sturmian\nwords using palindromic complexity ([12]). The second notion is the notion of defect which measures\nthe saturation by palindromic factors of a finite word ([6]) . An important class of words that are \"rich\"\nin palindromes in the utmost sense (called rich words) have been defined in [11, 13]. They have been\nfurther studied and many characterizations have been found. For recent results and summary on rich\nwords see for instance [9, 10, 13].\nA more general approach to the notion of palindrome has been considered by replacing the reversal\nmapping by a mapping \u0398 having the needed properties, i.e., being an involution and antimorphism. A\nword which is invariant under such mapping is called a pseudopalindrome or \u0398-palindrome. See\nfor instance [2] or [7]. In this work we concentrate on \u0398-palidromic saturation in infinite words. We\nderive an upper bound for the number of distinct \u0398-palindromic factors in a finite word. We define an\nanalogue to rich words \u2013 words containing the maximum number of \u0398-palindromes possible. For this\nclass of words that are rich in \u0398-palindromes (or shortly \u0398-rich) we prove similar equivalent statements\nas are known for rich words. The main result concerns words with set of factors closed under \u0398. We\nprove the following relation between \u0398-palindromic complexity P\u0398 (n) and factor complexity C(n) which\nis analogous to the case of the reversal mapping ([3]). P\u0398 (n) denotes the function counting the number\nof distinct \u0398-palindromic factors of length n in a given word and C(n) denotes the function counting the\nnumber of distinct factors of length n in a given word.\nTheorem 1. Let u be an infinite word with language closed under \u0398. Then\nP\u0398 (n) + P\u0398 (n + 1) \u2264 C(n + 1) \u2212 C(n) + 2, for all n \u2208 N.\nWe show that the equality is attained for \u0398-rich words, a result analogous to the case of the reversal\nmapping in [9].\nTheorem 2. Let u be an infinite word with language closed under \u0398. Then u is \u0398-rich if and only if\nP\u0398 (n) + P\u0398 (n + 1) = C(n + 1) \u2212 C(n) + 2 for all n \u2265 1.\nWe also make a connection to \u0398-episturmian words that are a generalization of episturmian words \u2013\na well known example of rich words. For a survey on such class of words see for instance [8]. Unlike\nepisturmian words, \u0398-episturmian words are not all \u0398-rich. We give a condition when this is true.\nDate: October 28, 2018.\n1\n\n\f2\n\n\u0160T\u011aP\u00c1N STAROSTA\n\nSection 2 summarizes notation and introduces some needed results from combinatorics on words. It\nincludes known results on rich words and defines \u0398-palindromes. Section 3 establishes a relation between\n\u0398-palindromic and factor complexity. Next section introduces the definition of \u0398-richness and a proof of\nTheorem 2. Section 5 provides examples of \u0398-rich words and contains also examples of \u0398-episturmian\nwords which are not \u0398-rich.\n2. Notation and basic facts\nBy A we denote an alphabet \u2013 a finite set of symbols, called letters. A finite sequence of letters\nw = w0 w1 w2 . . . wn\u22121 is called a word. Its length is denoted by |w| and equals n. The set of all words\nover an alphabet A, together with the empty word \u03b5 and the operation of concatenation, form a free\nmonoid A\u2217 .\nThe reversal of a finite word w = w0 w1 . . . wn\u22121 is the word w = wn\u22121 wn\u22122 . . . w0 . The mapping\nw 7\u2192 w is called reversal and clearly is a bijection on A\u2217 . If w = w then such word w is called a\npalindrome.\nAn infinite sequence u = u0 u1 u2 . . . of letters from A is said to be an infinite word over A. A finite\nword v is called a factor of a finite word w if there exist words v \u2032 and v \u2032\u2032 such that w = v \u2032 vv \u2032\u2032 . If v \u2032 = \u03b5\nthen v is called a prefix of w. If v \u2032\u2032 = \u03b5 then v is called a suffix. A factor of an infinite word u is defined\nanalogously with v \u2032\u2032 being infinite.\nThe language L(u) of an infinite word u is the set\nS of all its factors. Ln (u) denotes the set of factors of\nu of length n. We have L0 (u) = {\u03b5} and L(u) = n\u2208N Ln (u). If for every factor w \u2208 L(u) the reversal\nimage of w is in L(u), then we say that the language L(u) is closed under reversal.\nFor any factor w \u2208 L(u) there exists an index i such that w = ui ui+1 . . . ui+|w|\u22121 . Such an index is\ncalled an occurrence of w in u. We will say that a factor v is unioccurent in some word w if v occurs\nexactly once in w. If every factor of u has at least 2 occurrences in u then the word u is said to be\nrecurrent. One can verify that this is equivalent with every factor occurring infinitely many times. For a\nrecurrent infinite word we define a complete return word 1 to a factor w \u2208 L(u) to be a factor with exactly\n2 distinct occurrences of w, one as a prefix and one as a suffix.\nA factor w \u2208 L(u) is said to be left (right) special if there exist two distinct letters a, b \u2208 A such that\naw \u2208 L(u) and bw \u2208 L(u) (wa \u2208 L(u) and wb \u2208 L(u)). A factor is bispecial if it is right and left special.\nThe factor complexity of an infinite word u is a mapping N 7\u2192 N defined as C(n) := #Ln (u). The\npalindromic complexity is a mapping N 7\u2192 N defined as P(n) := # {w \u2208 Ln (u) | w = w}.\nIn [3] the following connection between palindromic complexity and the first difference of factor complexity \u2206C(n) = C(n + 1) \u2212 C(n) was proved.\nTheorem 3 ([3]). Let u be an infinite word with language closed under reversal. Then for all n we have\n(1)\n\nP(n) + P(n + 1) \u2264 \u2206C(n) + 2.\n\nGiven an infinite word u and n \u2208 N, we define the Rauzy graph of order n of the word u, denoted\n\u0393n (u), as follows. \u0393n (u) is a directed graph whose set of vertices equals Ln (u) and set of edges equals\nLn+1 (u). There is an edge e \u2208 Ln+1 (u) going from the vertex v1 to the vertex v2 if v1 is a prefix of e and\nv2 is a suffix of e. If the word u is recurrent then for all n the graph \u0393n (u) is strongly connected, i.e.,\nthere exists a directed path from any vertex to any other vertex. Let deg+ (w) denote the outdegree of\na vertex w. Especially for \u0393n (u) we have deg+ (w) = # {a \u2208 A | wa \u2208 L(u)}. Rauzy graphs are a useful\ntool to calculate the complexity as we have\nX\n\u0001\ndeg+ (w) \u2212 1 .\n\u2206C(n) =\nw\u2208Ln (u)\n\nAn n-simple path p is a factor of u of length at least n + 1 such that its prefix of length n and its\nsuffix of length n are both special (left or right) and no interior factor of length n is special. We can now\ndefine the reduced Rauzy graph of order n of u \u0393\u2032n (u). Its set of vertices equals the set of special (right\nor left) factors of Ln (u). There is an edge e from v1 to v2 if there is a n-simple path p which begins with\n1A shorter term \"complete return\" is also used.\n\n\fON THETA-PALINDROMIC RICHNESS\n\n3\n\nv1 and ends with v2 . Note that if for a given length N there is no special factor, the word u is periodic,\ni.e., can be written as u = v \u03c9 = vvv . . ., where v is a finite word. In such cases the definition of reduced\nRauzy graph of order n results in an empty graph for all n \u2265 N .\nConsider now an infinite word u with language closed under reversal. We can define the super reduced\nRauzy graph of order n of u denoted \u0393\u2032\u2032n (u) (first defined in [9]). Its set of vertices is formed by unordered\npairs {w, w}, where w \u2208 Ln (u) is a special factor. There is an undirected edge {e, e} from {v, v} to\n{w, w} if there is an n-simple path e starting with v or v and ending with w or w. Note that \u0393\u2032\u2032n (u) may\nhave multiple edges or loops.\n2.1. Palindromic richness. We say that a finite word w is rich if it has exactly |w| + 1 palindromic\nfactors. It is in fact the maximum number of palindromic factors possible. An infinite word is rich if all\nits factors are rich. This definition arises from the work done in [11] and in [13].\nThe following theorem summarizes some known characterizations of rich words. Listed equivalent\ndefinitions of richness have been proven respectively in [13], [9], [10].\nTheorem 4 ([13], [9], [10]). For any infinite word u the following conditions are equivalent:\n(1) u is rich,\n(2) any complete return word to a palindromic factor of u is a palindrome,\n(3) for any factor w of u, every factor of u that contains w only as its prefix and w only as its suffix\nis a palindrome,\n(4) each factor of u is uniquely determined by its longest palindromic prefix and its longest palindromic\nsuffix.\nThe following theorem gives a characterization of rich infinite words with language closed under reversal. It also answers the question whether the inequality (1) in Theorem 3 is reached for rich words.\nTheorem 5 ([9]). Let u be an infinite word with language L(u) closed under reversal. Then u is rich if\nand only if P(n + 1) + P(n) = \u2206C(n) + 2 for all n \u2208 N.\nIn [4] a different characterization of rich words with language closed under reversal has been shown.\nIt is based on bispecial orders of factors.\nLet us mention two classes of words that we will refer to later and that are also rich. The well-known\nSturmian words are exactly those words with factor complexity C(n) = n + 1 for all n \u2208 N. The second\nclass consists of so-called episturmian words. They are defined as words whose language is closed under\nreversal and have at most one left special factor of every length.\nFor further information on episturmian or rich words you can refer for instance to [5, 11, 13, 14].\nA differently constructed class of rich words than the two mentioned above may be found in [1].\n2.2. \u0398-palindromicity. The reversal mapping can in fact be understood as a special case of a more\ngeneral mapping \u0398: A\u2217 7\u2192 A\u2217 which satisfies two conditions:\n(1) it is an involution, i.e., \u03982 = id;\n(2) \u0398 is an antimorphism, i.e., \u2200v, w \u2208 A\u2217 , \u0398(vw) = \u0398(w)\u0398(v).\nFrom now on, \u0398 will denote a mapping with such properties. It is easy to verify that \u0398 can only be a\ncomposition of the reversal mapping and an involutory permutation of letters. Such permutation has two\ntypes of cycles distinguished by their length 1 or 2.\nThe definitions in the previous section can be modified in the following way. A finite word w is called\na \u0398-palindrome if w = \u0398(w). \u0398-palindromic complexity is a mapping N 7\u2192 N defined as\nP\u0398 (n) := # {w \u2208 Ln (u) | w = \u0398(w)} .\nThe language of u is closed under \u0398 if for any factor w \u2208 L(u) we have \u0398(w) \u2208 L(u). The definition of\nsuper reduced Rauzy graph is analogous: for words closed under \u0398 the reversal mapping is replaced by\n\u0398.\nAs we will see later, a crucial difference between the reversal mapping and a \u0398 mapping different from\nthe reversal mapping is that there exists a letter a such that a 6= \u0398(a). Therefore there exist words that\nhave no non-empty \u0398-palindromic suffix at all.\n\n\f4\n\n\u0160T\u011aP\u00c1N STAROSTA\n\nThe research on \u0398-palindromicity has led to several generalizations of known results. We will recall\none such generalization. A word is \u0398-episturmian if its language is closed under \u0398 and if for each n\nthere exists at most one left special factor of length n. Such words are discussed for instance in [8]. In [2]\nthese words are called pseudopalindromic. A more general class that we will mention later is discussed\nin [7].\n3. \u0398-palindromic and factor complexity\nAs for the reversal mapping, if u has its language closed under \u0398, then it is recurrent. To see that,\nconsider a non-\u0398-palindromic factor w \u2208 L(u). As L(u) is closed under \u0398 we can find an occurrence of\n\u0398(w) and so find a factor r having w as a prefix (respectively suffix) and \u0398(w) as a suffix (respectively\nprefix). If r is not a \u0398-palindrome, then we can find a different occurrence of \u0398(r) and in it a second\noccurrence of w. If w or r is a \u0398-palindrome it suffices to consider a non-\u0398-palindromic factor that\ncontains w or r as factor. Such factor either exists (for instance one can look only among prefixes of u)\nor u is trivial (periodic with period 1).\nThe following observation, stated as a lemma, will be used in the proof of Theorem 1. We provide a\nshort proof.\nLemma 6. Let u be an infinite word with language closed under \u0398. If there exists an integer N such\nthat there is no special factor of length N , then for all n \u2265 N we have P\u0398 (n) + P\u0398 (n + 1) = 2.\nProof. As u is recurrent, it is clear that for all n \u2265 N , \u0393n (u) is a cycle. Take n \u2265 N . We will consider\nan undirected graph G whose vertices are defined by unordered pairs {w, \u0398(w)} for all w \u2208 Ln (u). Let e\nbe an edge of \u0393n (u) going from the vertex w to the vertex v. For each pair {e, \u0398(e)}, there is an edge in\nG between the vertex {w, \u0398(w)} and the vertex {v, \u0398(v)}. Note that there may be multiple edges and\nalso loops (in the case e = \u0398(e)). According to the terminology already used this graph may be called\n\"super Rauzy graph of order n\".\nAs \u0393n (u) is a cycle, it is clear that G is formed by one elementary path p and at most 2 loops one possibly on the first vertex of p, one possibly on the last vertex of p. Suppose there is an interior\nvertex {w, \u0398(w)} in p such that w = \u0398(w). Then w would be a special factor of length n and we have a\ncontradiction. Denote by {s, \u0398(s)} the first vertex of p. If there is a loop on {s, \u0398(s)}, then it is clear\nthat s 6= \u0398(s) as otherwise s would be special. On the other hand, if there is not a loop on {s, \u0398(s)},\nthen s = \u0398(s) as \u0393n (u) would be disconnected. The reasoning is analogous for the last vertex of p.\nAs a loop in G is in fact a \u0398-palindrome of length n + 1, we have at most 2 \u0398-palindromes of length\nn or n + 1 - one associated with the first vertex of p and one with the last vertex of p.\n\u0003\nWe will now prove the analogue of Theorem 3 for languages closed under \u0398.\nProof of Theorem 1. Consider the operation \u03b8 which to every vertex w of a Rauzy graph associates \u0398(w)\nand to every edge e associates \u0398(e). Since we supposed the language closed under \u0398, \u03b8 is well defined\non all Rauzy graphs of u. In fact, \u03b8 maps every Rauzy graph \u0393n (u) onto itself. We will omit u in the\nnotation of Rauzy graphs from now on.\nFix n. We are interested in n-simple paths. As L(u) is closed under \u0398, u is recurrent. Thus the graph\n\u0393n is strongly connected and every vertex and every edge belongs to an n-simple path.\nFor an edge satisfying \u03b8(e) = e we find the n-simple path p which contains e. Then the operation \u03b8\nmust map the path represented by p onto itself, i.e., p = \u0398(p). Similarly, for a non-special vertex w such\nthat \u03b8(w) = w, the n-simple path containing w is mapped by \u03b8 onto itself.\nNote that an n-simple path can contain at most one \u0398-palindrome of length n or n + 1 which is not its\nprefix or suffix. To prove that suppose the contrary. Let z be an n-simple path containing two interior \u0398palindromic factors of length n or n + 1. Denote p1 the \u0398-palindrome with leftmost occurrence in z which\nis not a prefix of z. Since there is another \u0398-palindrome of length n or n + 1 and z is a \u0398-palindrome,\nthere is another occurrence of p1 as an interior factor of z. Let r be the shortest left special factor such\nthat p1 is its suffix. If there is no occurrence of r in z, then there is another occurrence in z of the prefix\nof z of length n which is neither its prefix nor suffix. If there is at least one occurrence of r in z, then\n\n\fON THETA-PALINDROMIC RICHNESS\n\n5\n\neither the prefix of length n of r is a special factor of z different from its prefix or suffix, or again the\nprefix of z of length n has another occurrence in z different from its prefix or suffix. In both cases, we\ncan find an interior occurrence of a special factor of length n - a contradiction with z being an n-simple\npath.\nTo give an upper bound on P\u0398 (n) + P\u0398 (n + 1) therefore consists in finding the number of n-simple\npaths in \u0393n that are mapped by \u03b8 onto themselves and the number of special \u0398-palindromes of length n.\nFor that we can consider the reduced Rauzy graph \u0393\u2032n .\nThe set of vertices of \u0393\u2032n can be partitioned into two disjoint subsets. The first subset is given by special\n\u0398-palindromes of length n. Let \u03b1 denote the number of such vertices. The second subset is formed by\nthe rest of the vertices \u2013 non-\u0398-palindromic special factors of length n. Let the number of such vertices\nbe denoted by 2\u03b2. The total number of vertices in \u0393\u2032n is then \u03b1 + 2\u03b2.\nIt is clear that the super reduced Rauzy graph \u0393\u2032\u2032n has exactly \u03b1 + \u03b2 vertices. As \u0393\u2032\u2032n is connected,\nit has at least \u03b1 + \u03b2 \u2212 1 edges. Thus the number of edges in \u0393\u2032n is at least 2(\u03b1 + \u03b2 \u2212 1). These edges\ncorrespond to the n-simple paths in \u0393n which are not mapped by \u03b8 onto themselves.\nAs already mentioned, the number of \u0398-palindromes of length n or n + 1 is bounded by the number\nof n-simple paths in \u0393n which are mapped onto themselves, and the number of special \u0398-palindromic\nvertices. We thus have\nX\nP\u0398 (n) + P\u0398 (n + 1) \u2264\ndeg+ (w) \u2212 2(\u03b1 + \u03b2 \u2212 1) + \u03b1,\nw is special\n\nwhere the first summand is the number of all n-simple paths in \u0393n , the second summand estimates the\nnumber of n-simple paths which are not mapped onto themselves, and the third counts the number of\nspecial \u0398-palindromic vertices. We obtain\nX\ndeg+ (w) \u2212 (\u03b1 + 2\u03b2) + 2 =\nP\u0398 (n) + P\u0398 (n + 1) \u2264\nw\u2208Ln (u) is special\n\n(2)\n\nX\n\n=\n\nw\u2208Ln (u) is special\n\n\u0001\ndeg+ (w) \u2212 1 + 2 =\n\n=\n\n\u2206C(n) + 2.\n\nThe proof is finished except for the special case where the word u is periodic. This implies existence\nof N such that for all n \u2265 N we have \u2206C(n) = 0, i.e., there is no special factor of length n. It this case\nthe reduced Rauzy graph of order n is empty. According to Lemma 6 we have P\u0398 (n) + P\u0398 (n + 1) = 2\nfor all n \u2265 N , which completes the proof.\n\u0003\nCorollary 7. Let L(u) be closed under \u0398. Let n \u2265 0. The equality\n(3)\n\nP\u0398 (n) + P\u0398 (n + 1) = \u2206C(n) + 2\n\nholds if and only if both of the following conditions are satisfied:\n(1) the graph \u0393\u2032\u2032n after removing loops is a tree,\n(2) any simple path forming a loop in the graph \u0393\u2032\u2032n is mapped by \u03b8 onto itself.\nProof. First, we rewrite the equality in the relation (2) as\n\u2206C(n) + 2 = #n-simple paths in \u0393\u2032n \u2212 \u03b1 \u2212 2\u03b2 + 2\nwhere \u03b1 is again the number of special \u0398-palindromes of length n and 2\u03b2 is the number of non-\u0398palindromic special factors of length n. Let p denote the number of n-simple paths that are mapped by\n\u03b8 onto themselves and m the number of n-simple paths that are not mapped onto themselves.\nWe will prove the equivalence directly. Suppose that P\u0398 (n) + P\u0398 (n + 1) = \u2206C(n) + 2. We have\n\u03b1 + p = P\u0398 (n) + P\u0398 (n + 1) = \u2206C(n) + 2 = p + m \u2212 \u03b1 \u2212 2\u03b2 + 2.\nTherefore m = 2(\u03b1 + \u03b2 \u2212 1). From the proof of Theorem 1, this is equivalent with having exactly the\nminimum number of non-\u0398-palindromic n-simple paths needed so that the graph \u0393\u2032n is strongly connected.\n\n\f6\n\n\u0160T\u011aP\u00c1N STAROSTA\n\nAs loops are not needed to have the graph strongly connected, they are counted in the number p. These\ntwo facts are equivalent with \u0393\u2032\u2032n being a tree after removing loops and all loops being \u0398-palindromic.\n\u0003\nA natural question is whether there exist such words for which the equality (3) is satisfied for all n.\nThe answer is positive only for \u0398 equal to the reversal mapping. In any other case we have P\u0398 (1) < #A\nand thus\nP\u0398 (0) + P\u0398 (1) < (#A \u2212 1) + 2 = \u2206C(0) + 2.\nHowever, there are words saturated in \u0398-palindromes that satisfy the equality for all n \u2265 1. Examples\nof such words are given in Section 5.1.\n4. \u0398-Richness\nRecall that a finite word is rich if it has the maximum possible number of palindromic factors. If we\nwant to use the same notion of richness for \u0398-palindromes, we need to take into consideration that there\nis always fewer \u0398-palindromes since some letters may not be \u0398-palindromes. To define richness we need\nto evaluate the number of these letters contained in a given word. We introduce the set \u03b3(w) as follows\n\b\n\u03b3(w) := {a, \u0398(a)} | a \u2208 A, a 6= \u0398(a), a or \u0398(a) \u2208 L(w) .\n\nIt is clear that if w\u2032 is a prefix of some finite word w, then #\u03b3(w\u2032 ) \u2264 #\u03b3(w). It is also clear that if for\nsome letter x \u2208 A we have \u03b3(w) 6= \u03b3(wx),\n\b then the word wx has no \u0398-palindromic suffix as \u0398(x) does\nnot occur in it. Also, as \u03b3(wx) = \u03b3(w) \u222a {x, \u0398(x)} , one can see that in this case #\u03b3(wx) = #\u03b3(w) + 1.\nThe following proposition gives the maximum number of \u0398-palindromes that may occur in a finite\nword.\nProposition 8. Let w be a finite word. Then the number of its \u0398-palindromic factors is bounded by\n|w| + 1 \u2212 #\u03b3(w).\n\nProof. The proof is done by induction on |w|. The statement is clear for |w| \u2264 1. Suppose that for\n|w| \u2264 N , w contains at most |w| + 1 \u2212 #\u03b3(w) different \u0398-palindromes. Let x \u2208 A. We will count the\nnumber of \u0398-palindromes in the word wx. It is clear that the number of \u0398-palindromes in wx is equal\nto the number of \u0398-palindromes in w plus the number of new \u0398-palindromic factors \u2013 \u0398-palindromic\nsuffixes of wx that do not occur in w.\nFirst suppose we have \u03b3(w) 6= \u03b3(wx). As there is no \u0398-palindromic suffix the number of \u0398-palindromes\nin wx equals the number of \u0398-palindromes in w which is at most |w| + 1 \u2212 #\u03b3(w) = |wx| + 1 \u2212 #\u03b3(wx).\nSuppose \u03b3(wx) = \u03b3(w). Suppose for contradiction that wx contains more than |wx| + 1 \u2212 #\u03b3(wx)\ndifferent \u0398-palindromes. As |wx| + 1 \u2212 #\u03b3(wx) = (|w| + 1 \u2212 #\u03b3(w)) + 1, it is clear that there must be\nat least two different \u0398-palindromes p and q such that w = yp and w = zq that do not occur previously\nin w (as they were not yet counted). We can assume that |p| > |q| and p is the longest of such suffixes\nof wx. On the other hand we have p = vq = q\u0398(v) where |v| > 0. Therefore every such factor q occurs\nalready in w and has already been counted in the number of \u0398-palindromes in w \u2013 a contradiction. We\ncan see that the number of \u0398-palindromes in wx is equal to either the number of \u0398-palindromes in w\nor the number of \u0398-palindromes in w plus 1. Therefore the upper bound is |w| + 1 \u2212 #\u03b3(w) + 1 which\nequals |wx| + 1 \u2212 #\u03b3(wx).\n\u0003\nWe can see from the preceding proof that if there is a new \u0398-palindromic factor, it is the longest\n\u0398-palindromic suffix. We will now define a class of words having maximum number of \u0398-palindromes.\nDefinition 9. A finite word w is \u0398-rich if it contains |w| + 1 \u2212 #\u03b3(w) \u0398-palindromic factors.\nAn infinite word is \u0398-rich if all its factors are \u0398-rich.\nOne can see that all factors of a finite \u0398-rich word are \u0398-rich as well. Thus, if an infinite word has all\nits prefixes \u0398-rich, then all its factors are \u0398-rich and it is by definition \u0398-rich.\nThe following equivalence is a consequence of the last remark and of the proof of Proposition 8. It is\na \u0398-rich analogue of results in [11, 13].\n\n\fON THETA-PALINDROMIC RICHNESS\n\n7\n\nProposition 10. An infinite or finite word u is \u0398-rich if and only if the longest \u0398-palindromic suffix of\neach prefix p is unioccurrent except for prefixes having the form px, with x \u2208 A and \u03b3(p) 6= \u03b3(px).\nProposition 10 leads to the following corollary, which is a \u0398-rich analogue of a result in [9].\nCorollary 11. Let u be an infinite \u0398-rich word. Then for all w \u2208 L(u), w 6= \u0398(w), the occurrences of\nw and \u0398(w) alternate.\nProof. Suppose there exist a factor w \u2208 L(u), w 6= \u0398(w), and a factor v \u2208 L(u), |v| > |w|, such that\nw is its prefix and its suffix and there is no occurrence of \u0398(w) in v. Since the last letter of v already\noccurred in v and v does not have a unioccurrent \u0398-palindromic suffix, according to Proposition 10 we\nhave a contradiction.\n\u0003\nThe following proposition gives an equivalent characterization of \u0398-rich words.\nProposition 12. Let u be an infinite or finite word. Then u is rich \u0398-rich if and only if for each factor\nv 6= \u03b5 of u, any factor of u beginning with v and ending with \u0398(v), containing no other occurrences of v\nor \u0398(v), is a \u0398-palindrome; and for all a \u2208 A, the occurrences of a and \u0398(a) in u alternate.\nProof. (\u21d2): Let v be a factor of u. Consider a factor r containing v as a prefix and \u0398(v) as a suffix,\nwith no other occurrences of v or \u0398(v).\nIf |v| = |r|, then v = \u0398(v) and r is a \u0398-palindrome.\nLet us assume |v| < |r|. Let s be the longest \u0398-palindromic suffix of r. (There is such a suffix as r is\n\u0398-rich and the image by \u0398 of the last letter of r has already occurred in r as the first letter.)\nIf |s| \u2264 |v| then we can write \u0398(v) = zs with z \u2208 A\u2217 . Then v = \u0398(s)\u0398(z) = s\u0398(z). We have a second\noccurrence of s in r \u2013 a contradiction with its unioccurrence.\nIf |v| < |s| < |r| then as \u0398(v) is a suffix of s we can write s = z\u0398(v) = v\u0398(z). Therefore we can find\na second occurrence of v in r \u2013 a contradiction with choice of r.\nThe last possibility left is s = r and thus r is a \u0398-palindrome.\nAlternation of a and \u0398(a) follows from Corollary 11.\n(\u21d0): Suppose for contradiction that u is not \u0398-rich. Then there is a prefix p whose longest \u0398palindromic suffix s occurs at least twice in p or there is a prefix p with no non-empty \u0398-palindromic\nsuffix such that p ends in a non-\u0398-palindromic letter a and has at least one another occurrence of a or\n\u0398(a).\nIn the first case, as s occurs in p for a second time, there is a complete return word to s contained in\np which is its suffix. The complete return word is a \u0398-palindrome and is longer than s \u2013 a contradiction.\nIn the second case, as occurrences of a and \u0398(a) alternate, we can find the rightmost occurrence of\n\u0398(a) in p. The suffix starting at that occurrence is then a word beginning with \u0398(a), ending with a and\nwith no other occurrences of a or \u0398(a). We supposed such words were \u0398-palindromic. Thus p has a\n\u0398-palindromic suffix and we have a contradiction.\n\u0003\nIn the last proof we did not need all the assumptions to prove the second implication. We can formulate\na weaker sufficient condition as follows.\nProposition 13. Let u be an infinite or finite word satisfying\n\u2022 all complete return words to \u0398-palindromes are \u0398-palindromes;\n\u2022 for any a \u2208 A, a 6= \u0398(a), occurrences of a and \u0398(a) alternate;\n\u2022 factors beginning with a \u2208 A and ending with \u0398(a), with no other occurrences of a or \u0398(a), are\n\u0398-palindromes.\nThen u is \u0398-rich.\nThe following lemma will be used in the proof of Theorem 2.\nLemma 14. Let u be an infinite word with language closed under \u0398. If P\u0398 (1) + P\u0398(2) = \u2206C(1) + 2 then\nfor all letters a, a 6= \u0398(a), occurrences of a and \u0398(a) alternate.\n\n\f8\n\n\u0160T\u011aP\u00c1N STAROSTA\n\nProof. Let a \u2208 A and suppose a is not a \u0398-palindrome. We will look at the super reduced Rauzy graph\n\u0393\u2032\u20321 for which the statements in Corollary 7 hold.\nSuppose a is not special. Then a is a factor of exactly one 1-simple path p. If the edge {p, \u0398(p)} is\na loop in \u0393\u2032\u20321 then the occurrences of a and \u0398(a) must alternate as p = \u0398(p). If {p, \u0398(p)} is not a loop\nthen there is no path in \u0393\u2032\u20321 that would contain 2 occurrences of p and no occurrence of \u0398(p). Such path\nwould form a cycle in \u0393\u2032\u20321 which is not possible.\nSuppose now that a is special. Then {a, \u0398(a)} is a vertex of \u0393\u2032\u20321 . We will look at paths going from\n{a, \u0398(a)} again to {a, \u0398(a)} which are not going through the vertex {a, \u0398(a)}. There are 2 possibilities.\nIn the first case such path corresponds to a loop in \u0393\u2032\u20321 connected to {a, \u0398(a)}. Therefore, the corresponding path in \u03931 is a 1-simple path and is a \u0398-palindrome beginning with a or \u0398(a) respectively and\nending with \u0398(a) or a respectively.\nIn the second case such path starts with an edge {e, \u0398(e)}. It is clear that the end of this path is again\nthe same edge {e, \u0398(e)} as otherwise there would be a cycle in \u0393\u2032\u20321 . If the corresponding path in \u03931 starts\nwith e, it must end with \u0398(e) as otherwise there would be a multiple edge (forming a cycle) between the\nvertices of \u0393\u2032\u2032 connected by {e, \u0398(e)}. Therefore, if such path starts with a, it must end with \u0398(a) and\nthe proof is finished.\n\u0003\nIn what follows, to ease the notation, we will borrow some elements from the free group generated\nby A and use them in the following way. Let w be a finite word. By w\u22121 we denote an element whose\nconcatenation with w produces the empty word, i.e., ww\u22121 = w\u22121 w = \u03b5. The notation is justified by the\nfact that we will never concatenate w\u22121 with anything else than w.\nProof of Theorem 2.\n(\u21d0):\nSuppose that u is not rich. According to Lemma 14 non-\u0398-palindromic letters alternate. Proposition 12\nimplies there exists a factor v \u2208 L(u) and a factor r \u2208 L(u) such that r begins with v and ends with\n\u0398(v), with no other occurrences of v or \u0398(v), and r is not a \u0398-palindrome. Then r is of the form\nr = vwxsy\u0398(w)\u0398(v),\nwhere w and s are finite words and x, y \u2208 A, x 6= \u0398(y). As the language is closed under \u0398, we can\nsee that vw\u0398(y) \u2208 L(u). This means that the factor vw is right special and therefore {vw, \u0398(vw)} is a\nvertex in \u0393\u2032\u2032|vw| .\nIf r is a |vw|-simple path then r forms a loop in \u0393\u2032\u2032|vw| . Therefore according to Corollary 7 it is a\n\u0398-palindrome \u2013 a contradiction.\nSuppose now that r is not a |vw|-simple path, i.e., contains other special factors of length |vw|. Denote\nby p, q two factors of r such that they are |vw|-simple paths and p is a prefix and q a suffix of r. Let p\u2032\ndenote the special suffix of length |vw| of p and q \u2032 the special prefix of q of length |vw|. It is clear that\nvertices {vw, \u0398(vw)} and {p\u2032 , \u0398(p\u2032 )} are connected as well as {vw, \u0398(vw)} and {q \u2032 , \u0398(q \u2032 )} are connected.\n\u22121\nIf p\u2032 and q \u2032 coincide, i.e., r = pp\u2032 q, then as x 6= \u0398(y) we have a multiple edge in \u0393\u2032\u2032|vw| \u2013 a cycle in \u0393\u2032\u2032|vw|\n\u2032\nand thus a contradiction. If p and q \u2032 do not coincide there exists a path in \u0393\u2032\u2032|vw| leading from {p\u2032 , \u0398(p\u2032 )}\nto {q \u2032 , \u0398(q \u2032 )}, avoiding {vw, \u0398(vw)}, which together with the two paths connecting {vw, \u0398(vw)} forms\na cycle and we have again a contradiction with Corollary 7.\n(\u21d2):\nWe say that a factor r is a realization of an edge in \u0393\u2032\u2032 between vertices {v, \u0398(v)} and {w, \u0398(w)} if\n\u2022 r has a prefix v or \u0398(v) and a suffix w or \u0398(w) OR\n\u2022 r has a prefix w or \u0398(w) and a suffix v or \u0398(v),\nand contains no interior occurrences of factors v, \u0398(v), w and \u0398(w).\nWe will denote by v \u21c1 w a realization of an edge between vertices {v, \u0398(v)} and {w, \u0398(w)} which\nstarts with v and ends with w.\n\n\fON THETA-PALINDROMIC RICHNESS\n\n9\n\nFirst, we are going to show that for every pair of distinct vertices {v, \u0398(v)} and {w, \u0398(w)} there are\nexactly two realizations of an edge between them and that they are \u0398 images of each other. Let w 6= v and\nw 6= \u0398(v). Suppose without loss of generality there is a realization v \u21c1 w. We will find two consecutive\nrealizations, denoted r1 and r2 . See Figure 1.\n\nv| \u21c1\n{z w} . . . . . . . . . . . . . . . . . . . . . . . . . . . . v| \u21c1\n{z w}\nr1\n\nr2\n\nFigure 1. Two consecutive realizations v \u21c1 w.\nAccording to Corollary 11 occurrences of each factor alternate with occurrences of its \u0398 image. Therefore we can find occurrences of \u0398(v) and \u0398(w) between occurrences of r1 and r2 . Let us first find the\nleftmost occurrence (after r1 ) of \u0398(v). As every factor beginning with v and ending with \u0398(v) is a\n\u0398-palindrome, we can find a realization \u0398(w) \u21c1 \u0398(v). Denote this realization by q1 . See Figure 2. Note\nthat the occurrences of the factor w in r1 and \u0398(w) in q1 may coincide.\n\u0398-palindrome\n\nz\n}|\n{\nv \u21c1 w . . . \u0398(w) \u21c1 \u0398(v) . . . . . . . . . . . . v \u21c1 w\n{z\n}\n|\nq1\n\nFigure 2. The leftmost occurrence of realization \u0398(w) \u21c1 \u0398(v).\nLet us now find the rightmost occurrence (before r2 ) of \u0398(w). Analogously, we find a realization\n\u0398(w) \u21c1 \u0398(v). Denote this realization by q2 . See Figure 3.\n\u0398-palindrome\n\n}|\n{\nz\nv \u21c1 w . . . . . . . . . . . . \u0398(w) \u21c1 \u0398(v) . . . v \u21c1 w\n|\n{z\n}\nq2\n\nFigure 3. The rightmost occurrence of realization \u0398(w) \u21c1 \u0398(v).\nSuppose now that occurrences of q1 and q2 are not equal. If they are not consecutive, we can find a\nrealization of \u0398(w) \u21c1 \u0398(v), denoted by q1\u2032 , such that q1\u2032 and q2 are consecutive. Now, using the same\narguments as for consecutive realizations r1 and r2 , we can find a realization v \u21c1 w between q1\u2032 and q2 .\nThis is a contradiction with r1 and r2 being consecutive. Thus the occurrence of q1 equals the occurrence\nq2 and q1 = q2 . \u0398-palindromes depicted in Figure 2 and Figure 3 imply q1 = \u0398(r1 ) and q2 = \u0398(r2 ),\nrespectively. Therefore r1 = r2 and we deduce that every realization v \u21c1 w equals r1 and every realization\n\u0398(v) \u21c1 \u0398(w) equals \u0398(r1 ).\nSo far we have shown that for every pair of distinct vertices {v, \u0398(v)} and {w, \u0398(w)} there are exactly\ntwo realizations of an edge between them and that they are \u0398 images of each other. This implies that \u0393\u2032\u2032\nafter removing loops is a tree. Corollary 11 claims that occurrences of w and \u0398(w) alternate, thus any\nrealization between the same vertices {w, \u0398(w)} is of the form w \u21c1 \u0398(w) or \u0398(w) \u21c1 w. By Proposition 12,\nsuch realizations are \u0398-palindromes. These realizations are in fact loops in \u0393\u2032\u2032 . Using Corollary 7 these\ntwo parts together imply that the equality (3) holds.\n\u0003\n5. Examples of \u0398-rich words\nIn this section we will provide examples of \u0398-rich words. We first concentrate on a generalization of\nepisturmian words, namely \u0398-episturmian words, mentioned earlier. The following definition will serve\nto reveal the structure of the language of a \u0398-episturmian word. Its main aim is to ease the notation.\n\n\f10\n\n\u0160T\u011aP\u00c1N STAROSTA\nK\n\nDefinition 15. Let u be a \u0398-episturmian word. Denote by (wk )k=0 the sequence of all bispecial factors\nof u, ordered by increasing length and starting by w0 = \u03b5 with K possibly equal to +\u221e. Furthermore let\nzk denote the unique letter such that wk zk is a prefix of wk+1 . Denote by pk \u2208 A\u2217 the word such that\nwk+1 = pk \u0398(zk )wk . For all k \u2208 N and all a \u2208 A let rk,a denote the complete return word to wk beginning\nwith wk a, if it exists.\nFor a letter a 6= \u0398(a), let ka denote the maximal index k \u2264 K, if it exists, such that wk has non-\u0398palindromic complete return words beginning with wk a and with wk \u0398(a). If ka does not exist, we will\nconsider it to be +\u221e.\nNote that since there is at most one complete return word wk having a prefix wk a, the definition of\nrk,a is correct. As the language of u is closed under \u0398, rk,a exists if and only if rk,\u0398(a) exists. Note also\nthat ka \u2265 1 for every letter a 6= \u0398(a).\nProposition 16. Let u be a \u0398-episturmian word.\n(1) If a = \u0398(a) and rk,a exists, then rk,a is a \u0398-palindrome;\n(2) if a 6= \u0398(a), then\na. if k \u2264 ka , then rk,a equals wk awk , furthermore a is not contained in wk or in any other\ncomplete return word to wk except for rk,a ;\nb. if k > ka , then at most one of the words rk,a and rk,\u0398(a) exist.\nProof. The proof will be done by induction on k.\nFor k = 0, we have w0 = \u03b5 and the claim holds trivially (for non-\u0398-palindromic a we are in the case\n(2a)).\nSuppose the claim holds for k. We will prove it for k + 1. We need to consider especially the case\nk + 1 = ka + 1 for all a to be able to assume also (2b).\nCase (1):\nLet a = \u0398(a). If a = zk then rk+1,a = pk \u0398(zk )wk as for some word s. As there is at most one complete\nreturn word to wk beginning with wk a, we have wk as = wk a\u0398(pk ). Thus, rk+1,a = pk awk a\u0398(pk ) which\nis a \u0398-palindrome.\nIf a 6= zk suppose that rk+1,a is not a \u0398-palindrome. Therefore we can write rk+1,a = pk \u0398(zk )wk ax\nand wk ax = yawk v = rk,a v with x, y, v \u2208 A\u2217 . By the assumption rk,a is a \u0398-palindrome which implies\nthat v cannot start with zk as rk+1,a would be a \u0398-palindrome. In other words we can find a factor\nhaving the form awk b with b 6= zk .\nWe can then find two different factors \u0398(zk )wk a \u2208 L(u) and \u0398(b)wk a \u2208 L(u). Thus wk a is left special\nwhich is a contradiction with wk zk being a second left special factor of the same length. Thus b = zk and\nwe have rk+1,a = pk \u0398(zk )rk,a zk \u0398(pk ) which is a \u0398-palindrome. This concludes the proof of the case (1).\nCase (2):\nLet now a 6= \u0398(a). We distinguish the following three cases according to the value of ka .\nI. k + 1 \u2264 ka\nSuppose that a is contained in wk+1 . This means that wk awk is a factor of wk+1 and so is\nwk \u0398(a)wk .\nSuppose zk = a. We have wk+1 = wk awk pwk \u0398(a)wk where p is a \u0398-palindrome or wk \u22121 .\nThen the complete return word rk+1,a equals wk+1 awk pwk \u0398(a)wk which is a \u0398-palindrome and\ncontradicts the assumption k + 1 < ka .\nSuppose now zk 6= a. We can then find a factor of wk+1 of the form bwk awk c with b 6= \u0398(zk ).\n(If b = \u0398(zk ), then we would have a shorter bispecial factor than wk+1 but longer than wk .) Since\nrk+1,a exists we can find a factor \u0398(zk )wk a. Thus wk a is right special which contradicts wk zk being\nright special of the same length.\nWe will now prove that rk+1,a is the only complete return word to wk+1 to contain a. Suppose\nthat a is contained in rk+1,b with b 6= a. Since a is not contained in wk+1 , rk+1,b is of the form\nwk+1 xwk+1 where x \u2208 A\u2217 contains a.\n\n\fON THETA-PALINDROMIC RICHNESS\n\n11\n\nWe can find a factor of x equal to cwk a with c 6= \u0398(zk ). As rk+1,a exists there is a factor\n\u0398(zk )wk a which implies that wk a is right special. Since especially a 6= zk as otherwise it would be\ncontained in wk+1 , we arrive at a contradiction.\nIt remains to show that rk+1,a = wk+1 awk+1 . Since k + 1 < ka we know from the definition of ka\nthat both rk+1,a and rk+1,\u0398(a) exist. We can see that rk+1,a = pk \u0398(zk )rk,a x with x \u2208 A\u2217 . If the first\nletter of x is zk we are finished. Suppose it is not true and denote that letter by x0 6= zk . We have\nawk x0 \u2208 L(u). As rk+1,\u0398(a) exists (from the definition of ka ) we know that \u0398(zk )wk \u0398(a) \u2208 L(u)\nwhich implies awk zk \u2208 L(u). This implies that awk is right special. As \u0398(zk ) 6= a we can see that\nwe have 2 right special factors of the same length and thus x0 must be zk . Finally as rk,a = wk awk\nwe have rk+1,a = pk \u0398(zk )rk,a zk \u0398(pk ) = wk+1 awk+1 .\nII. k + 1 = ka + 1\nIf wk+1 does not exist, then rk+1,a does not exist too.\nIf wk+1 exists, suppose that both rk+1,a and rk+1,\u0398(a) exist and at least one of them is a \u0398palindrome. We can suppose without loss of generality that rk,a is a \u0398-palindrome. We can then\nfind a factor \u0398(a)wk zk . rk+1,\u0398(a) contains a factor \u0398(a)wk b with b 6= zk as otherwise we would\nhave two complete return words rk+1,a . The factor \u0398(a)wk is therefore right special which implies\nzk = a. As \u0398(a)wk \u0398(a) \u2208 L(u) we have also awk a \u2208 L(u) and awk is not right special. Since wk a\ncan only be extended as wk awk we arrive to a contradiction \u2013 u = pwk awk awk a . . . which implies\nu is not recurrent (\u0398(a) occurs only in the word p).\nIII. k + 1 > ka + 1\nIt suffices to see that if rk,a does not exist then rk+1,a does not exist too.\n\u0003\nCorollary 17. For all letters a 6= \u0398(a) the value of ka is finite.\nProof. If u is periodic, then K is finite and so is ka . For u aperiodic if ka = +\u221e then we stay in the case\n(2a) for all k. In other words all bispecial factors do not contain a which is clearly impossible.\n\u0003\nFrom the above corollary we can deduce that if \u0398 is different from the reversal mapping, then there\nexists k such that \u2206C(|wk |) < #A \u2212 1, i.e., the growth of factor complexity is not constant.\nThe following corollary will serve to derive the criterion for richness of \u0398-episturmian words.\nCorollary 18. Let k > ka and rk,a is a \u0398-palindrome. Then either rk+1,a does not exist or is a \u0398palindrome.\nProof. Suppose that rk+1,a exists and is not a \u0398-palindrome. Then rk+1,a begins by pk \u0398(zk )rk,a b where\nzk 6= b \u2208 A. As \u0398(a)wk b \u2208 L(u) so is \u0398(b)wk a \u2208 L(u). Together with \u0398(zk )wk a \u2208 L(u) we see that\nwk a is left special, i.e., zk = a. This is impossible as we would have rk+1,a = pk \u0398(a)wk a\u0398(pk ) \u2013 a\n\u0398-palindrome.\n\u0003\nCorollary 19. Let u be a \u0398-episturmian word. Let lk = |wk |. If there exists an index k0 such that\nP\u0398 (lk0 ) + P\u0398 (lk0 + 1) = \u2206C(lk0 ) + 2, then for all n \u2265 lk0\nP\u0398 (n) + P\u0398 (n + 1) = \u2206C(n) + 2.\nProof. First note that as u is \u0398-episturmian, \u0393\u2032\u2032n has at most one vertex for all n.\nAccording to Corollary 7, the graph \u0393\u2032\u2032lk consists of one vertex and P\u0398 (lk0 ) + P\u0398 (lk0 + 1) \u2212 1 edges\n0\nwhich are loops mapped onto themselves. Therefore all complete return words to wk0 are \u0398-palindromes.\nThus, using Corollary 18, for all k > k0 , the graph \u0393\u2032\u2032lk consists of one vertex with loops mapped onto\nthemselves. Thus using again Corollary 7, we see that P\u0398 (lk ) + P\u0398 (lk + 1) = \u2206C(lk ) + 2.\nWe will prove that for all k > k0 , for all n such that lk\u22121 < n < lk , the graph \u0393\u2032\u2032n is of the same form\nas \u0393\u2032\u2032lk (one vertex with loops mapped onto themselves) and thus according to Corollary 7 the equation\nP\u0398 (n)+P\u0398 (n+1) = \u2206C(n)+2 holds. It suffices to see that every n-simple path is in fact a \u0398-palindromic\nfactor of a (lk )-simple path or wk .\nIt remains to see the case of finite value of K. Then for all n > K, there is no special factor of length\nn. According to Lemma 6, we have 2 = P\u0398 (n) + P\u0398 (n + 1) = \u2206C(n) + 2.\n\n\f12\n\n\u0160T\u011aP\u00c1N STAROSTA\n\n\u0003\nThe following corollary stems from combining the previous claim with Theorem 2. It gives a criterion\nto see whether a \u0398-episturmian word is \u0398-rich or not.\nCorollary 20. \u0398-episturmian word is \u0398-rich if and only if P\u0398 (1) + P\u0398 (2) = \u2206C(1) + 1.\n5.1. Examples. This section contains examples of infinite words with properties mentioned above.\nExample 21. Let \u03c0 denote a morphism {0, 1}\u2217 \u2192\n7 {a, a\u2032 , c}\u2217 :\n\u001a\n0 7\u2192 aa\u2032\n\u03c0:\n.\n1 7\u2192 aa\u2032 c\nDenote \u0398 an involutory antimorphism defined as\n\u0398 : a 7\u2192 a\u2032 , a\u2032 7\u2192 a, c 7\u2192 c.\nThen the infinite word u = \u03c0(v), where v is a Sturmian word, has the following properties:\n(1) is \u0398-episturmian,\n(2) satisfies the equality P\u0398 (n) + P\u0398 (n + 1) = \u2206C(n) + 2 for n \u2265 1,\n(3) is \u0398-rich.\nAs v is Sturmian, it is clear that u is aperiodic. Furthermore if we enumerate L2 (u) we see that\n\u2206C(1) = 1. These two facts imply that for n \u2265 1 we have \u2206C(n) = 1. As the language L(v) is closed\nunder reversal, the language L(u) is closed under \u0398.\nTo prove the rest we can either apply directly Corollary 20 or enumerate \u0398-palindromic complexity.\nIn the following examples the mapping \u0398 is considered the same as in Example 21.\nExample 22. Let \u03c0 be the following morphism\n\u03c0 : 0 7\u2192 a\u2032 cacc, 1 7\u2192 a\u2032 cac.\nWe set u = \u03c0(v) where v is a Sturmian word over {0, 1}. Then u is \u0398-episturmian and not \u0398-rich.\nThe proof is similar as in Example 21. From v we can deduce that the word u is aperiodic, uniformly\nrecurrent and contains infinitely many \u0398-palindromes. The last two properties imply that L(u) is closed\nunder \u0398. As \u2206C(2) = 1 and there is one special factor of length 1 \u2013 the factor c \u2013 it is clear that u is\n\u0398-episturmian.\nu is not \u0398-rich: factors ca\u2032 c and cac do not have a unioccurrent \u0398-palindromic suffix.\nNext example is a \u0398-rich word which is not \u0398-episturmian.\nExample 23. Set \u03c0 as follows\n\u03c0 : 0 7\u2192 aa\u2032 , 1 7\u2192 acca\u2032 .\nLet v be a Sturmian word over {0, 1}. Then the word \u03c0(v) is \u0398-rich and is not \u0398-episturmian. The proof\nis left to the reader.\nThe following two examples concern periodic infinite words.\n\u03c9\n\nExample 24. The word (caca\u2032 ) is periodic but not \u0398-rich. The factors ca\u2032 c and cac do not have a\nunioccurrent \u0398-palindromic suffix as before.\n\u03c9\n\nExample 25. The word (ccaa\u2032 ) is periodic and \u0398-rich. It follows from the fact that we can find a\nunioccurrent \u0398-palindromic suffix for each prefix of this word.\n\n\fON THETA-PALINDROMIC RICHNESS\n\n13\n\n6. Final remarks\nA wider class of infinite words related to \u0398-palindromes has been studied in [7]. The class is constructed\nusing the right \u0398-palindromic closure operator. To any word w in A\u2217 it associates the word w\u2295 which is\nthe shortest \u0398-palindromic word having w as prefix. It is clear that if s denotes the longest \u0398-palindromic\nsuffix of w then if we denote w = ps we have w\u2295 = ps\u0398(p).\nLet u0 be a fixed finite word called seed. Let \u03a8 : A\u2217 \u2192 A\u2217 be a map defined as follows\n\u03a8(\u03b5) = u0 ,\n\u2295\n\n\u03a8(ux) = (\u03a8(u)x)\n\nfor u \u2208 A\u2217 and x \u2208 A.\n\nFor a given infinite word t we can define \u03a8(t) as\n\u03a8(t) = lim \u03a8 (pref n (t))\nn\u2192+\u221e\n\nwhere pref n stands for the prefix of length n. The word t is called the directive word of \u03a8(t) and is\ndenoted \u2206(\u03a8(t)). The word \u03a8(t) is called \u0398-standard word with seed if u0 6= \u03b5 otherwise it is called\njust \u0398-standard. \u0398-episturmian words are included in \u0398-standard words with seed (exact condition and\ndetails are given in [7]).\nAs the definition of \u0398-standard word is constructive, a rough and direct condition to decide whether\na \u0398-standard word is \u0398-rich is easy to derive. If the word \u03a8 (pref n (t)) tn is \u0398-rich for all n \u2265 0 (with\nt = t0 t1 t2 . . .), then \u03a8(t) is \u0398-rich.\nThe following proposition connects the class of \u0398-standard words with seed with the class of \u0398-rich\nwords.\nProposition 26 (Proposition 4.7, [7]). Let u be a \u0398-standard word with seed. Then there exists an\ninteger M such that any prefix p of u of length greater than M has a unioccurrent \u0398-palindromic suffix.\nThe integer M is explained in detail in the paper. It is clear that if M = 1, then u is \u0398-rich. However\nM = 1 implies some restrictions on \u0398 and a criterion whether a \u0398-standard word with seed is \u0398-rich\nremains an open question.\n7. Acknowledgements\nI would like to thank Edita Pelantov\u00e1 and L'ubom\u00edra Balkov\u00e1 for their careful reviewing and fruitful\nsuggestions. I acknowledge financial support by the Czech Science Foundation grant no. 201/09/0584,\nby the grant no. MSM6840770039 and LC06002 of the Ministry of Education, Youth, and Sports of\nthe Czech Republic and by the grant no. SGS10/085OHK4/1T/14 of the Grant Agency of the Czech\nTechnical University in Prague.\nReferences\n1. Petr Ambro\u017e, Christiane Frougny, Zuzana Mas\u00e1kov\u00e1, and Edita Pelantov\u00e1, Palindromic complexity of infinite words\nassociated with simple Parry numbers, Ann. Inst. Fourier (Grenoble) 56 (2006), 2131\u20132160.\n2. Vyoma Anne, Luca Q. Zamboni, and Ioana Zorca, Palindromes and pseudo-palindromes in episturmian and pseudoepisturmian infinite words, in: S. Brlek, C. Reutenauer (Eds.), Words 2005, n. 36 in Publications du LACIM, 2005,\npp. 91\u2013100.\n3. Peter Bal\u00e1\u017ei, Zuzana Mas\u00e1kov\u00e1, and Edita Pelantov\u00e1, Factor versus palindromic complexity of uniformly recurrent\ninfinite words, Theoret. Comput. Sci. 380 (2007), no. 3, 266\u2013275.\n4. L'ubom\u00edra Balkov\u00e1, Edita Pelantov\u00e1, and \u0160t\u011bp\u00e1n Starosta, Sturmian jungle (or garden?) on multiliteral alphabets, to\nappear in RAIRO-Theor. Inf. Appl.\n5. Jean Berstel, Sturmian and episturmian words: a survey of some recent results, CAI'07: Proceedings of the 2nd\ninternational conference on Algebraic informatics (Berlin, Heidelberg), Lecture Notes in Computer Science, vol. 4728,\nSpringer-Verlag, 2007, pp. 23\u201347.\n6. Srecko Brlek, Sylvie Hamel, Maurice Nivat, and Christophe Reutenauer, On the palindromic complexity of infinite\nwords, Internat. J. Found. Comput. 15 (2004), no. 2, 293\u2013306.\n7. Michelangelo Bucci, Aldo de Luca, Alessandro De Luca, and Luca Q. Zamboni, On different generalizations of episturmian words, Theoret. Comput. Sci. 393 (2008), no. 1-3, 23\u201336.\n, On theta-episturmian words, European J. Combin. 30 (2009), no. 2, 473\u2013479.\n8.\n\n\f14\n\n\u0160T\u011aP\u00c1N STAROSTA\n\n9. Michelangelo Bucci, Alessandro De Luca, Amy Glen, and Luca Q. Zamboni, A connection between palindromic and\nfactor complexity using return words, Advances in Applied Mathematics 42 (2009), no. 1, 60 \u2013 74.\n, A new characteristic property of rich words, Theoret. Comput. Sci. 410 (2009), no. 30-32, 2860\u20132863.\n10.\n11. Xavier Droubay, Jacques Justin, and Giuseppe Pirillo, Episturmian words and some constructions of de Luca and\nRauzy, Theoret. Comput. Sci. 255 (2001), no. 1-2, 539\u2013553.\n12. Xavier Droubay and Giuseppe Pirillo, Palindromes and Sturmian words, Theoret. Comput. Sci. 223 (1999), no. 1-2,\n73\u201385.\n13. Amy Glen, Jacques Justin, Steve Widmer, and Luca Q. Zamboni, Palindromic richness, European J. Combin. 30\n(2009), no. 2, 510\u2013531.\n14. Glen, Amy and Justin, Jacques, Episturmian words: a survey, Theoret. Inf. Appl. 43 (2009), no. 3, 403\u2013442.\nDepartment of Mathematics, FNSPE, Czech Technical University in Prague, Trojanova 13, 120 00\nPraha 2, Czech Republic\nE-mail address: staroste@fjfi.cvut.cz\n\n\f"}