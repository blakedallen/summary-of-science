{"id": "http://arxiv.org/abs/1007.1840v1", "guidislink": true, "updated": "2010-07-12T08:28:45Z", "updated_parsed": [2010, 7, 12, 8, 28, 45, 0, 193, 0], "published": "2010-07-12T08:28:45Z", "published_parsed": [2010, 7, 12, 8, 28, 45, 0, 193, 0], "title": "A geometric approach to the diophantine Frobenius problem", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1007.3693%2C1007.3045%2C1007.4197%2C1007.0878%2C1007.2048%2C1007.5209%2C1007.0144%2C1007.3686%2C1007.1007%2C1007.3316%2C1007.1179%2C1007.1670%2C1007.2055%2C1007.4254%2C1007.5388%2C1007.5214%2C1007.1569%2C1007.2473%2C1007.3578%2C1007.3230%2C1007.2128%2C1007.2714%2C1007.0299%2C1007.0884%2C1007.5454%2C1007.0402%2C1007.5514%2C1007.2343%2C1007.2919%2C1007.1709%2C1007.1034%2C1007.0858%2C1007.1854%2C1007.2391%2C1007.1052%2C1007.4265%2C1007.0592%2C1007.3054%2C1007.4874%2C1007.4425%2C1007.4006%2C1007.3340%2C1007.2749%2C1007.5395%2C1007.4813%2C1007.4586%2C1007.0200%2C1007.3503%2C1007.0268%2C1007.0270%2C1007.2841%2C1007.5519%2C1007.3092%2C1007.1123%2C1007.2681%2C1007.4371%2C1007.2976%2C1007.4028%2C1007.2846%2C1007.1807%2C1007.0429%2C1007.1486%2C1007.2941%2C1007.1204%2C1007.4975%2C1007.1173%2C1007.1492%2C1007.1840%2C1007.2127%2C1007.0471%2C1007.3130%2C1007.1881%2C1007.3872%2C1007.5300%2C1007.3026%2C1007.5496%2C1007.2927%2C1007.1986%2C1007.2691%2C1007.5025%2C1007.1547%2C1007.1033%2C1007.0155%2C1007.3215%2C1007.3228%2C1007.2249%2C1007.2461%2C1007.3488%2C1007.3970%2C1007.2315%2C1007.3425%2C1007.2675%2C1007.0875%2C1007.4114%2C1007.5446%2C1007.5506%2C1007.3271%2C1007.4838%2C1007.1193%2C1007.5175%2C1007.4986&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A geometric approach to the diophantine Frobenius problem"}, "summary": "It turns out that all instances of the diophantine Frobenius problem for\nthree coprime a_i have a common geometric structure which is independent of\narithmetic coincidences among the a_i. By exploiting this structure we easily\nobtain Johnson's formula for the largest non-representable z, as well as a\nformula for the number of such z. A procedure is described which computes these\nquantities in O(log(max a_i)) steps.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1007.3693%2C1007.3045%2C1007.4197%2C1007.0878%2C1007.2048%2C1007.5209%2C1007.0144%2C1007.3686%2C1007.1007%2C1007.3316%2C1007.1179%2C1007.1670%2C1007.2055%2C1007.4254%2C1007.5388%2C1007.5214%2C1007.1569%2C1007.2473%2C1007.3578%2C1007.3230%2C1007.2128%2C1007.2714%2C1007.0299%2C1007.0884%2C1007.5454%2C1007.0402%2C1007.5514%2C1007.2343%2C1007.2919%2C1007.1709%2C1007.1034%2C1007.0858%2C1007.1854%2C1007.2391%2C1007.1052%2C1007.4265%2C1007.0592%2C1007.3054%2C1007.4874%2C1007.4425%2C1007.4006%2C1007.3340%2C1007.2749%2C1007.5395%2C1007.4813%2C1007.4586%2C1007.0200%2C1007.3503%2C1007.0268%2C1007.0270%2C1007.2841%2C1007.5519%2C1007.3092%2C1007.1123%2C1007.2681%2C1007.4371%2C1007.2976%2C1007.4028%2C1007.2846%2C1007.1807%2C1007.0429%2C1007.1486%2C1007.2941%2C1007.1204%2C1007.4975%2C1007.1173%2C1007.1492%2C1007.1840%2C1007.2127%2C1007.0471%2C1007.3130%2C1007.1881%2C1007.3872%2C1007.5300%2C1007.3026%2C1007.5496%2C1007.2927%2C1007.1986%2C1007.2691%2C1007.5025%2C1007.1547%2C1007.1033%2C1007.0155%2C1007.3215%2C1007.3228%2C1007.2249%2C1007.2461%2C1007.3488%2C1007.3970%2C1007.2315%2C1007.3425%2C1007.2675%2C1007.0875%2C1007.4114%2C1007.5446%2C1007.5506%2C1007.3271%2C1007.4838%2C1007.1193%2C1007.5175%2C1007.4986&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "It turns out that all instances of the diophantine Frobenius problem for\nthree coprime a_i have a common geometric structure which is independent of\narithmetic coincidences among the a_i. By exploiting this structure we easily\nobtain Johnson's formula for the largest non-representable z, as well as a\nformula for the number of such z. A procedure is described which computes these\nquantities in O(log(max a_i)) steps."}, "authors": ["Christian Blatter"], "author_detail": {"name": "Christian Blatter"}, "author": "Christian Blatter", "arxiv_comment": "12 pages, 5 figures, Plain TeX", "links": [{"href": "http://arxiv.org/abs/1007.1840v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1007.1840v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11D07", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1007.1840v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1007.1840v1", "journal_reference": null, "doi": null, "fulltext": "A geometric approach to the diophantine Frobenius problem\n\narXiv:1007.1840v1 [math.NT] 12 Jul 2010\n\nChristian Blatter\n\nABSTRACT. It turns out that all instances of the diophantine Frobenius problem for three coprime ai\nhave a common geometric structure which is independent of arithmetic coincidences among the ai . By\nexploiting this structure we easily obtain Johnson's formula for the largest non-representable z, as well\nas a formula for the number of such z. A procedure is described which computes these quantities in\nO(log(max ai )) steps.\n\n1. INTRODUCTION\nFor an n-tuple a = (a1 , a2 , . . . , an ) of positive integers we denote by T := T (a) the set\nof natural numbers z that can be written in the form\nz=\n\nn\nX\n\nxk ak ,\n\nk=1\n\nxk \u2208 N := {0, 1, 2 . . .} ,\n\nand by F := F (a) the set of natural numbers z that cannot be so represented. If\ngcd(a1 , . . . , an ) = 1 then it is easily seen that all sufficiently large numbers z are in\nT . It follows that in this case F is a finite set, so there is a largest non-representable\nnumber g(a) := max F . To compute this number and maybe even the cardinality N (a)\nof F in terms of a1 , . . ., an constitutes the so-called diophantine Frobenius problem.\nWe recommend [4], printed in 2005, as a comprehensive source of material about this\nproblem; the bibliography alone contains about 500 items.\nThe case n = 2 was first considered and solved by Sylvester [6], [7]. He proved:\nProposition 1. If a1 , a2 are > 1 and coprime then\ng(a1 , a2 ) = a1 a2 \u2212 a1 \u2212 a2 ,\n\nN (a1 , a2 ) =\n\n(a1 \u2212 1)(a2 \u2212 1)\n.\n2\n\n(1)\n\nThe proof of this result follows from inspection of Fig. 1 and is given at the beginning\nof the next section.\nThis paper deals with the case n = 3. We shall give a natural geometric description of\nthe set F from which an explicit answer to the Frobenius-3-problem can immediately be\nread off. In order to formulate our result we introduce the quantities\nl3 := min{l \u2208 N>0 | l a3 \u2208 T (a1 , a2 )}\n\n\b .\n\nHere and in the sequel the sign \b indicates that there are three such formulae in all,\nwhereby the other two are obtained by cyclic permutation 1 \u2192 2 \u2192 3 \u2192 1 of the indices.\nAbout the li the following can be said right away (cf. [2], Theorem 3 and eq. 26):\n1\n\n\fProposition 2. Assume that the three numbers a1 , a2 , a3 are pairwise prime and that\nli \u2265 2 (1 \u2264 i \u2264 3). Then the minimal representation\nl3 a3 = x31 a1 + x32 a2 ,\n\nx31 , x32 \u2208 N\n\n(2)\n\n\b\n\nof li ai (1 \u2264 i \u2264 3) is uniquely determined, and one has\nxij \u2265 1\n\n(all i 6= j) .\n\n(3)\n\nFurthermore the li are coupled to the xij through\nl3 = x13 + x23\n\n\b .\n\n(4)\n\nWe now state our main result; it will be proven in section 3:\nTheorem 3. Assume that the three numbers a1 , a2 , a3 are pairwise prime and that\nli \u2265 2 (1 \u2264 i \u2264 3). Then\nX\ng(a) = l1 l2 l3 + max{x12 x23 x31 , x21 x32 x13 } \u2212\nai ;\n(5)\ni\n\nN (a) =\n\n\u0012\n1 X\n2\n\ni\n\n(li \u2212 1)ai \u2212 l1 l2 l3 + 1\n\n\u0013\n\n.\n\n(6)\n\nThe assumption li \u2265 2 means that none of the ai is \"superfluous\". If, e.g., l3 = 1 then\nF (a1 , a2 , a3 ) = F (a1 , a2 ); this case is handled in Proposition 1. When the given ai are\nnot pairwise prime then there is a way to get rid of common factors, see [2], Theorem 2.\nOur formula (5), resp. its preliminary version (8), appears as Theorem 4 in [2] and on\np. 35 of [4]. Note, however, that the proof given in [4] uses heavy algebraic machinery\nand is deferred to a later chapter.\nExample 1. Let a1 := 2n \u2212 1, a2 := 2n, a3 := 2n + 1 for an n \u2265 2. As a2 \u2261 1 and a3 \u2261 2\n(mod a1 ) the smallest multiple of a1 in T (a2 , a3 ) is a2 + (n \u2212 1)a3; similarly the smallest\nmultiple of a3 in T (a1 , a2 ) is na1 + a2 , and obviously the minimal representation of a2\nis 2a2 = a1 + a3 . Altogether we have\nl1 = n + 1, x12 = 1, x13 = n \u2212 1; l2 = 2, x21 = 1, x23 = 1; l3 = n, x31 = n, x32 = 1 ;\nso Theorem 3 gives\ng(a) = 2n(n + 1) + max{n, n \u2212 1} \u2212 6n = 2n2 \u2212 3n ,\n\u0001\n1\nN (a) = n(2n \u2212 1) + 2n + (n \u2212 1)(2n + 1) \u2212 2n(n + 1) + 1 = n2 \u2212 n .\n2\nFor the computation of the li and the xij we propose the so called Lagrange algorithm\n\u2013 a kind of two-dimensional euclidean\nalgorithm modeled after a Gram-Schmidt-process\n\u0001\n\u2013 which takes O log(max ai ) steps. The resulting procedure is developped in sections\n4 and 5 of this paper. In [4] several other algorithms for g(a) are described, notably the\nalgorithm of R\u00f8dseth [5] which is an improved version of an earlier continued fraction\nalgorithm by Selmer & Beyer.\n\n2\n\n\fFig. 1\n\n2. PRELIMINARIES\nProof of Proposition 1. We draw in the (x1 , x2 )-plane the directed graph \u0393 with vertex\nset Z2 and edges of unit length connecting neighboring lattice points in the direction of\nincreasing x1 resp. x2 , see Fig. 1. For given a1 , a2 \u2208 N>1 we define the height function\nf (x1 , x2 ) := a1 x1 + a2 x2 .\nTwo points in Z2 have the same height iff they differ by a vector u \u2208 L := Z2 \u2229 f \u22121 (0).\nSince a1 and a2 are coprime the set L is the one-dimensional lattice formed by the\nvectors uk := (ka2 , \u2212ka1 ), k \u2208 Z.\nAn integer z \u2208 N can be represented in the form z = x1 a1 + x2 a2 with x1 , x2 \u2208 N iff\nthere is a directed edge path in \u0393 connecting a point uk \u2208 L with a point x \u2208 Z2 of\nheight f (x) = z. Now the lattice points that can be reached from a given uk \u2208 L lie in\nthe set Qk := uk + R2\u22650 , a first quadrant with origin at uk , and the setSof all possible\nend points of such paths consists of the lattice points in the union \u03a9 := k Qk of these\nquadrants.\n\nThe lattice points of positive height that cannot be reached from one of the points uk\nare the interior lattice points of the rectangular triangles \u2206k with vertices uk , uk+1 ,\nuk + (a2 , 0). The largest occurring height in such a \u2206k is given by the first formula (1),\nand using symmetry one concludes that each \u2206k contains exactly (a1 \u2212 1)(a2 \u2212 1)/2\nlattice points in its interior, which all have different heights.\n\u0003\nFor later purposes we note the following: Any lattice point in \u22060 can be connected by\nan admissible path to the point (a2 , 0) of height a1 a2 . It follows that a number z > 0 is\nin F (a1 , a2 ) iff there are integers k1 , k2 \u2265 1 such that z = a1 a2 \u2212 k1 a1 \u2212 k2 a2 .\nProof of Proposition 2. First we show (3). Assume, e.g., that x13 = 0. Then we have\nl1 a1 = x12 a2 , and as a1 , a2 are coprime it follows that l1 \u2265 a2 . On the other hand, from\nl3 \u2265 2, i.e., a3 \u2208 F (a1 , a2 ) it follows that there are integers k1 , k2 \u2265 1 with\na3 = a1 a2 \u2212 k1 a1 \u2212 k2 a2 = (a2 \u2212 k1 )a1 \u2212 k2 a2 .\n3\n\n\fWhence we would have (a2 \u2212 k1 )a1 = k2 a2 + a3 which would imply l1 < a2 \u2013 a contradiction.\nWe next show (4). Let the xij be determined such that (2) holds. Then the quantities\n\u03bc3 := l3 \u2212 x13 \u2212 x23\n\n\b\n\nsatisfy \u03bc1 a1 + \u03bc2 a2 + \u03bc3 a3 = 0. If the \u03bci do not all vanish then up to a permutation of\nthe ai we must have one of the following:\n(a)\n\n\u03bc1 > 0 ,\n\n\u03bc2 < 0 ,\n\n\u03bc3 \u2264 0 ;\n\n(b)\n\n\u03bc1 > 0 ,\n\n\u03bc2 > 0 ,\n\n\u03bc3 < 0 .\n\nIn case (a) it follows that\n(l1 \u2212 x21 \u2212 x31 )a1 = \u03bc1 a1 = (\u2212\u03bc2 )a2 + (\u2212\u03bc3 )a3 ,\ncontradicting the definition of l1 . In case (b), from\n(x13 + x23 \u2212 l3 )a3 = \u2212\u03bc3 a3 = \u03bc1 a1 + \u03bc2 a2\nit follows by definition of l3 that x13 + x23 \u2265 2l3 , whence, e.g., x13 \u2265 l3 . By definition\nof the xij we now have the representation\n(l1 \u2212 x31 )a1 = (x12 + x32 )a2 + (x13 \u2212 l3 )a3\nwhich again contradicts the definition of l1 .\nAs (4) is true for all possible choices of x21 and x31 consistent with the definition of l2\nand l3 , and as these choices can be made independently, it follows that there is in fact\nno choice at all, which means that the xij are indeed uniquely determined.\n\u0003\n3. PROOF OF THE MAIN RESULT\nWe now come to the proof of Theorem 3. Inspired by the proof of Sylvester's result for\nn = 2 we embed the problem into the following geometric setup: Consider the integer\nlattice Z3 in euclidean (x1 , x2 , x3 )-space R3 . We use Z3 as vertex set of a directed graph\n\u0393 whose edges are the segments of unit length connecting neighboring lattice points in\nthe direction of increasing x1 , resp. x2 , x3 . Given a1 , a2 , a3 , we again define the height\nfunction\nf (x1 , x2 , x3 ) := a1 x1 + a2 x2 + a3 x3\nwhich on the one hand is just a linear functional on R3 and on the other hand assigns a\nheight f (x) to each lattice point x \u2208 Z3 . The kernel H := f \u22121 (0) of f is a plane through\nthe origin of R3 and contains the Frobenius lattice L := H \u2229 Z3 of integer solutions to\nthe equation f (x) = 0.\nLemma 4. (a) Let m1 a1 + m2 a2 = 1 with mi \u2208 Z. Then the vectors e1 := (a2 , \u2212a1 , 0),\ne2 := (a3 m1 , a3 m2 , \u22121) form a basis of L.\n(b) The fundamental domain of the lattice L, when projected to the plane xi = 0, has\narea ai (1 \u2264 i \u2264 3).\n4\n\n\fProof. (a) One easily checks that f (e1 ) = f (e2 ) = 0, which means that e1 , e2 \u2208 L.\nOn the other hand, let u = (u1 , u2 , u3 ) be an arbitrary point of L. Then u + u3 e2 =\n(u\u20321 , u\u20322 , 0) \u2208 L which implies a1 u\u20321 + a2 u\u20322 = 0. Since a1 , a2 are coprime it follows that\n(u\u20321 , u\u20322 , 0) = ke1 for a k \u2208 Z, whence we have u = ke1 \u2212 u3 e2 .\n\n(b) It suffices to compute the vector product\n\n\u0001\ne1 \u00d7 e2 = a1 , a2 , (m1 a1 + m2 a2 )a3 = (a1 , a2 , a3 ) .\n\n\u0003\n\nThe three lattice vectors\nf1 := (l1 , \u2212x12 , \u2212x13 ), f2 := (\u2212x21 , l2 , \u2212x23 ), f3 := (\u2212x31 , \u2212x32 , l3 ) \u2208 L\nencoding the data li , xij will play a special r\u00f4le. We shall call any vector of the form fi\nor \u2212fi a basic vector and any set of three essentially different vectors among the \u00b1 fi a\nsolution basis for the Frobenius problem at hand.\n\nFig. 2\n\nThe connection of the three-dimensional structure described so far with the diophantine\nFrobenius problem is the following: A natural number z is in T (a) iff there is a lattice\npoint u \u2208 L and a directed edge path in \u0393 beginning at u and ending in a point x \u2208 Z3\nof height f (x) = z. Now the lattice points that can be reached from a given u \u2208 L lie\nin the set Ou := u + R3\u22650 , an octant with origin at u, and the set of\nS all possible end\npoints of such paths consists of the lattice points in the union \u03a9 := u\u2208L Ou of these\noctants. It follows that T (a) = f (Z3 \u2229 \u03a9). The boundary \u2202\u03a9 is L-periodic; it consists\nof three L-shapes per octant and touches the plane H in the points of L. It looks like\na washboard and is depicted in Fig. 2, as seen from below. The proof of Theorem 3\nessentially consists in understanding this figure.\n5\n\n\fConsider, e.g., the positive x3 -axis. It is an edge of the octant O0 and belongs to the\nboundary of \u03a9 until it is intercepted at p = (0, 0, u3 ) by a wall x3 = const. belonging to\nanother octant Ou , u = (u1 , u2 , u3 ) \u2208 L. For this to happen it is necessary that u1 \u2264 0,\nu2 \u2264 0, u3 > 0, and that there is no point u\u2032 = (u\u20321 , u\u20322 , u\u20323 ) \u2208 L with u\u20321 \u2264 0, u\u20322 \u2264 0 and\nu\u20323 < u3 . This means\n\b\nu3 = min u \u2208 N>0 \u2203 u1 , u2 \u2208 Z\u22640 : a1 u1 + a2 u2 + a3 u = 0\n\b\n(7)\n= min u \u2208 N>0 u a3 \u2208 T (a1 , a2 ) ,\n\nfrom which we deduce\n\nu3 = l3 ,\n\n\u2212u1 = x31 ,\n\n\u2212u2 = x32 ,\n\ni.e., (u1 , u2 , u3 ) = f3 ; and similarly for the other li , xij .\nThe lattice points x of positive height that cannot be reached from a point u \u2208 L are\nthe interior lattice points contained in the region W enclosed between H and \u2202\u03a9. As\nseen in the figure, the restriction f \u21be \u2202\u03a9 takes local maxima at the points q1 , q2 , and\nthe interior lattice points of maximal height are q1 \u2212 (1, 1, 1) or q2 \u2212 (1, 1, 1) and their\nequivalents mod L. It follows that the maximal non-realizable height g(a) is given by\ng(a) = max{f (q1 ), f (q2 )} \u2212\n\nX\n\ni\n\nai = l3 a3 + max{x21 a1 , x12 a2 } \u2212\n\nX\n\ni\n\nai .\n\n(8)\n\nSince the three L-shapes have areas ai by Lemma 4(b), we deduce from Fig. 2 that the\nai satisfy\na1 = x12 l3 + x13 x32 ,\n\na2 = x21 l3 + x23 x31 ,\n\na3 = l1 l2 \u2212 x12 x21\n\n\b .\n\n(9)\n\nSubstituting these expressions into (8) one arrives at the symmetric formula (5):\ng(a) = l1 l2 l3 \u2212 l3 x12 x21 + max{x21 x12 l3 + x21 x13 x32 , x12 x21 l3 + x12 x23 x31 } \u2212\nX\n= l1 l2 l3 + max{x21 x13 x32 , x12 x23 x31 } \u2212\nai .\n\nX\n\ni\n\nai\n\ni\n\nWe now come to the proof of formula (6). We have to count the number z0 of interior\nlattice points in the quotient \u0174 := W/L. As \u0174 does not have a simple description\nin terms of inequalities we are going to determine z0 \"from the outside\" by means of\na three-dimensional analog of Pick's area formula. Let z1 denote the total number of\nrelative interior lattice points in the three L-shapes; similarly, let z2 be the total number\nof relative interior lattice points on the reentrant edges of \u0174 and z3 be the number of\nsuch points on the protruding edges of \u0174 . Then we have the following formula:\nLemma 5.\n\n3\n1\n7\n1\nvol(\u0174 ) = z0 + z1 + z2 + z3 + ,\n2\n4\n4\n4\n\nwhereby the last term incorporates the contribution of the corners of \u0174 .\nProof. We perform a \"Gedankenexperiment\" used already in [1] for a proof of Pick's\narea formula. Imagine that at time 0 a unit of heat is concentrated at each point of Z3 .\n6\n\n\fThis heat will be distributed all over space by heat conduction, and at time \u221e it will be\nequally distributed in space with density 1. In particular, the amount of heat contained\nin \u0174 will be vol(\u0174 ). Where does this amount of heat come from? For symmetry reasons\nthere is absolutely no flux across the unit squares of \u2202\u03a9, and, again by symmetry, the\nnet flux across H/L is 0 as well. As a consequence, the final amount of heat within \u0174\ncomes from the interior lattice points, counted by z0 , and from the lattice points on the\nboundary of \u0174 . The lattice points counted by z1 send half their heat into \u0174 , whereas\nthe corresponding factor is 43 for the points counted by z2 and 41 for the points counted\nby z3 . Furthermore \u0174 possesses two protruding corners q1 and q2 which contribute\n1\neach, three \"L-corners\" contributing 38 , and finally the reentrant corner on H which\n8\n\u0003\ncontributes 38 as well.\n\nFig. 3\n\nIn order to compute vol(\u0174 ) directly we use the L-shape A in the plane x3 = 0 as\nfundamental domain. Fig. 3 shows A, as seen from the positive x3 -direction. The\nvertical prism K determined by A and the plane\nH:\n\nx3 = \u2212\n\n1\n(a1 x1 + a2 x2 )\na3\n\nis a representative for \u0174 . To compute the volume of K we split A into two rectangles\nand work with the heights of K in their midpoints. We obtain\n2x32 + x12 \u0011 l1 x32 \u0010 l1\nx32 \u0011\nx31 x12 \u0010 x31\na1\na1 + a2\n+\n,\n+ a2\nvol(\u0174 ) =\na3\n2\n2\na3\n2\n2\nwhich using (2) and (9) can be brought into the following symmetric form:\n\u0011\n1 \u0010X\nli ai \u2212 l1 l2 l3 .\nvol(\u0174 ) =\ni\n2\n\n(10)\n\nWe now compute the quantities z1 , z2 and z3 . \u2013 The horizontal L-shape A in Fig. 3\nhas area a3 by Lemma 4(b) and 2(l1 + l2 ) lattice points on its boundary. Therefore by\nPick's area formula for the plane the number of interior lattice points on A is given by\na3 \u2212 (l1 + l2 ) + 1, and we obtain\nX\nX\nz1 =\nai \u2212 2\nli + 3 .\n(11)\ni\n\ni\n\n7\n\n\fInspection of Fig. 2 shows that\nz2 =\n\nX\n\ni\n\n(li \u2212 1) =\n\nX\n\ni\n\nli \u2212 3 ,\n\nz3 =\n\nX\n\ni6=j\n\n(xij \u2212 1) =\n\nX\n\ni\n\nli \u2212 6 .\n\n(12)\n\nIntroducing (10), (11) and (12) into Lemma 5 we get\n3\n1\n7\n1\nz0 = vol(\u0174 ) \u2212 z1 \u2212 z2 \u2212 z3 \u2212\n2\n4\n4\n4\n\u0011 1 \u0010X\n\u0011 3 \u0010X\n\u0011\nX\n1 \u0010X\n=\nli ai \u2212 l1 l2 l3 \u2212\nai \u2212 2\nli + 3 \u2212\nli \u2212 3\ni\ni\ni\ni\n2\n2\n4\n\u0011 7\n1 \u0010X\nli \u2212 6 \u2212\n\u2212\ni\n4\n4\n\u0011\n\u0010\n1 X\n(li \u2212 1)ai \u2212 l1 l2 l3 + 1 .\n=\ni\n2\nThis concludes the proof of Theorem 3.\n\n\u0003\n\n4. FINDING A SOLUTION BASIS\nIn order to make Theorem 3 useful we have to establish a procedure to compute the\nquantities li , xij . Our argument takes place in the plane H. Fig. 4 shows H as seen from\nthe tip of the vector a, the points of L are again marked by bullets. The three planes\nxi = 0 intersect H in three lines gi through the origin which altogether divide H into six\nsectors of various widths. The line g3 , spanned by the vector v3 := (\u2212a2 , a1 , 0), is at the\nsame time a level line of the linear function x3 restricted to H. Equation (7) can now\nbe interpreted as follows: In order to find l3 we have to translate the line g3 : x3 = 0 in\nthe direction of increasing x3 (marked by an arrow in Fig. 4) until it hits for the first\ntime a lattice point in the sector x1\u2264 0 \u2227 x2 \u2264 0. The lattice point obtained in this way\nis the point f3 . Translating similarly the lines g1 and g2 one obtains the lattice points\nf1 , f2 in the appropriate sectors.\n\nFig. 4\n\n8\n\n\fBeing minimizers of some sort the fi \u2208 L tend to be short. Now there exists a revered\nalgorithm (attributed to Lagrange, Gauss and others, see [3]) which finds the shortest\nvector u of the lattice L, and we plan to make use of this algorithm. But if u happens\nto lie in a sector of width > 60\u25e6 , as in Fig. 4, there is no guarantee that u coincides with\nthe basic vector fi (or \u2212fi ) in that sector. For this reason we change the metric in such\na way that the three lines xi = 0 intersect at angles of 60\u25e6 .\nLemma 6. For a suitable scalar product hx, yi := xT Q y the three lines xi = 0 in H\nintersect at angles of 60\u25e6 .\nProof. The three directions in question are\nv1 := (0, \u2212a3 , a2 ) ,\n\nv2 := (a3 , 0, \u2212a1 ) ,\n\nv3 := (\u2212a2 , a1 , 0) .\n\nConsider now the linear map P : R3 \u2192 R2 given by the matrix\n\u0014\n\n\u2212a1\nP :=\n0\n\na2\n0\n\n\u221a0\n3a3\n\n\u0015\n\n.\n\nThe kernel of P is spanned by the vector (a2 , a1 , 0) \u2208\n/ H, therefore the restriction P \u21be H\nmaps H bijectively onto the euclidean plane E := R2 . One easily computes\n\u0010 1 \u221a3 \u0011\n,\nP v1 = 2a2 a3 \u2212 ,\n2 2\n\n\u0010 1 \u221a3 \u0011\nP v2 = 2a1 a3 \u2212 , \u2212\n,\n2\n2\n\nP v3 = 2a1 a2 (1, 0) ,\n\nwhich shows that in the image plane the lines gi intersect at angles of 60\u25e6 .\nPulling back the euclidean scalar product in E to H one obtains there the new scalar\nproduct\nhx, yi := (P x)T P y = xTP T P y = xT Q y ,\nwhere the integer matrix Q := P T P is given by\n\uf8ee\n\na21\nQ = \uf8f0 \u2212a1 a2\n0\n\n\u2212a1 a2\na22\n0\n\n\uf8f9\n0\n0 \uf8fb .\n3a23\n\n\u0003\n\nIn what follows, | * | denotes the norm corresponding to the scalar product h*, *i.\nLagrange's algorithm (to be described in the next section) produces a reduced basis\n(u, v) of the Frobenius lattice L. This means that u is a shortest nonzero vector in L\nand that v is a shortest vector in L \\ Z u; in particular, |u| \u2264 |v|.\nTheorem 7. Under the hypotheses of Theorem 3, let (u, v) be a reduced basis of the\nFrobenius lattice L. Assume that u1 \u2264 0, u2 \u2264 0, u3 > 0 and put \u03bb := v3 /u3 . Then the\nthree vectors\nu , v\u2212 := v \u2212 \u2308\u03bb\u2309u , v+ := v \u2212 \u230a\u03bb\u230bu\nform a solution basis for the Frobenius problem determined by the ai .\n9\n\n\fFig. 5\n\nProof. We argue in the (x, y)-plane E, but omit the P in our notation. The lines gi\nenclose angles of 60\u25e6 , creating (closed) sectors Sk (1 \u2264 k \u2264 6), see Fig. 5. After scaling\nwe have u = (\u2212 sin \u03b8, cos \u03b8) with |\u03b8| \u2264 \u03c06 , whence u \u2208 S2 , and we may assume that the\nlattice line l k u containing v is to the right of u. We shall show that the points u, v\u2212\nand v+ are basic points in the sectors S6 , S1 and S2 respectively.\nWe begin with the remark that\n\u221a in fact |\u03b8| < \u03c0/6. Assume to the contrary that, e.g.,\n\u03b8 = \u03c0/6. Then u = (\u22121/2, 3/2) \u2208 g1 , meaning u1 = 0. In this case u could not be\nbasic\n\u221a by (3). It follows that there would have to be a lattice point in S2 with y-coordinate\n< 3/2. But there is no room for such a point since the interior of the unit circle is\nforbidden.\nLet b := v \u2212 \u03bbu = (b, 0) be the point where l \u221a\nintersects g3 . Then b = h/ cos \u03b8 where h\ndenotes the distance from 0 to l, whence h \u2265 3/2. We write (cos \u03c6, sin \u03c6) =: e\u03c6 .\nLemma 8. (a) he\u03c0/6 , ui < he\u03c0/6 , bi ,\n\n(b) he\u2212\u03c0/6 , \u2212ui < he\u2212\u03c0/6 , bi .\n\n\u0001\n\u0001\nProof. The left sides of\n(a) and (b) are sin \u03c06 \u2212 \u03b8 and sin \u03c06 + \u03b8 respectively, so they\n\u0001\nboth are \u2264 sin \u03c06 + |\u03b8| . On the other hand the right sides of (a) and (b) both have the\nsame value\n\u03c0 h\n3\n\u03c0\n\u2265\n.\ncos b = cos\n6\n6 cos \u03b8\n4 cos \u03b8\nIt remains to prove that for 0 \u2264 \u03b8 < \u03c06 one has\n\u0010\u03c0\n\n\u0011\n3\n+ \u03b8 cos \u03b8 < .\n6\n2\n\u0001\nBut here the left side can be written as sin \u03c06 + 2\u03b8 + sin\n2 sin\n\n\u03c0\n6\n\n\u0001\n\nwhich is < 1 + 12 .\n\n\u0003\n\nPut c\u2212 := b \u2212 u, c+ := b + u. Then from Lemma 8(a) it follows that he\u03c0/6 , c\u2212 i > 0,\nwhence c\u2212 \u2208 int(S6 ), and analogously from Lemma 8(b) it follows that he\u2212\u03c0/6 , c+ i > 0,\n10\n\n\fwhence c+ \u2208 int(S1 ). From this we conclude that the lattice points v\u2212 \u2208 [b, c\u2212 ] and\nv+ \u2208 [b, c+ ] lie in S6 and S1 respectively.\nAs c+ \u2208 int(S1 ) the line l intersects g2 at a y-level > cos \u03b8, whence all lattice points on\nl \u2229 S2 have a larger y-level than u, and similarly, as \u2212c\u2212 \u2208 int(S3 ), the line l\u2032 intersects\ng1 at a y-level > cos \u03b8, whence all lattice points on l\u2032 \u2229 S2 have a larger y-level than u.\nThis implies that the vector u is basic in its sector S2 .\nNote that he\u03c0/6 , ui > 0, whence going upwards along l \u2229 S1 the distance to g1 increases.\nSince v+ is the first lattice point met along this path, v+ is basic for the sector S1 ,\nunless there were an even better lattice point on the parallel to l through the point 2b.\nBut the latter is prohibited by the inequality he\u03c0/6 , c+ i < he\u03c0/6 , 2bi which follows easily\nfrom Lemma 8(a).\nSimilarly one has he\u2212\u03c0/6 , ui < 0, and this implies that going downwards along l \u2229 S6\nthe distance to g2 increases. Since v\u2212 is the first lattice point met along this path, v\u2212\nis basic for the sector S6 , unless there were an even better lattice point on the parallel\nto l through the point 2b. But the latter is prohibited by the inequality he\u2212\u03c0/6 , c\u2212 i <\nhe\u2212\u03c0/6 , 2bi which follows easily from Lemma 8(b).\n\u0003\n5. LAGRANGE'S ALGORITHM\nLagrange's algorithm, as it is called in [3], takes an arbitrary basis (u, v) of the Frobenius\nlattice L as input and in a certain number of steps arrives at a reduced basis of L. An\nessential accessory to the calculations is the Gram matrix\n\u0014\n\nhu, ui\nG := G(u, v) :=\nhv, ui\n\nhu, vi\nhv, vi\n\n\u0015\n\nof the current basis (u, v); it is updated along with the basis vectors.\nThe following box is taken from [3]. The subscript \u2264 to a basis indicates that one\nassumes |u| \u2264 |v|, and \u230a * \u2309 denotes the nearest integer function.\nInput: A basis (u, v)\u2264 with its Gram matrix G = (gi,j )1\u2264i,j\u22642 .\nOutput: A reduced basis of L with its Gram matrix.\n1. Repeat\n\n3.\n\n\u0007\n\u0004\nr := v \u2212 x u, where x := g1,2 /g1,1 .\nWhen computing x, also compute the remainder y := g1,2 \u2212 xg1,1 .\nv := u .\n\n4.\n\nu := r .\n\n5.\n\nUpdate the Gram matrix as follows: swap g2,2 and g1,1 ; then let g1,2 := y and\ng1,1 := g1,1 \u2212 x(y + g1,2 ).\n\n2.\n\n6. Until |u| \u2265 |v| .\n\n7. Return (v, u)\u2264 and its Gram matrix (setting g2,1 := g1,2 ).\nLagrange's algorithm\n\n11\n\n\fWe now combine this with the results of the foregoing section in order to obtain a\ncoherent description of the computational procedure to determine the li , xij .\nWhen a1 , a2 , a3 are given, one first \u0001has to set up the basis (e1 , e2 ) of L given in Lemma\n4(a). This requires O log(maxi ai ) steps for the euclidean algorithm to find m1 , m2 .\nUsing this basis as input one then runs Lagrange's algorithm and obtains a reduced\nbasis (u, v)\u2264 of\u0001 L. As shown in [3], Theorem 3.0.3, this is accomplished in at most\nO log(maxi ai ) loops of the algorithm. Replacing u by \u2212u, if necessary, makes ui > 0,\nuj < 0 (j 6= i) for some i. Now put \u03bb := vi /ui and define v\u2212 , v+ as given in Theorem\n7. The quantities li , xij can then be read off from the coordinates of the three vectors\nu, v\u2212 , v+ . Note however that the bit complexity of the whole computation is quadratic\ninsofar as the bit-length of the input data ai not only affects the number of required\nsteps/loops but also the cost of each step.\nExample 2. Consider the random numerical example a1 := 4327, a2 := 6716, a3 := 9237.\nIn 8 steps the euclidean algorithm finds 2055a1 \u2212 1324a2 = 1, and after 6 loops of\nLagrange's algorithm we arrive at a reduced basis of L given by u = (\u221253, \u221247, 59),\nv = (\u2212130, 59, 18). Theorem 7 then tells us that\nf1 = (130, \u221259, \u221218) ,\n\nf2 = (\u221277, 106, \u221241) ,\n\nf3 = (\u221253, \u221247, 59)\n\nis a solution basis for the given data, and by Theorem 3 we have\ng(a) = 920 947 ,\n\nN (a) = 493 045 .\n\nReferences\n[1] Chr. Blatter: Another proof of Pick's area theorem. Math. Mag. 70 (1997), 200.\n[2] S.M. Johnson: A linear diophantine problem. Can. J. Math. 12 (1960), 390\u2013398.\n[3] P.Q. Nguyen & D. Stehl\u00e9: Low-dimensional lattice basis reduction revisited. ACM Transactions on\nAlgorithms 5 (2009), 4 (Oct.), 1\u201348.\n[4] J.L. Ramirez Alfonsin: The diophantine Frobenius problem. Oxford University Press 2005\n[5] \u00d8.J. R\u00f8dseth: On a linear diophantine problem of Frobenius. J. Reine und Angewandte Mathematik\n301 (1978), 171\u2013178.\n[6] J.J. Sylvester: On subinvariants, i.e. semi-invariants to binary quantities of an unlimited order. Am.\nJ. Math. 5 (1882), 119\u2013136.\n[7] J.J. Sylvester: Problem 7382. Educational Times 37 (1884), 26.\nAddress of the author:\nChristian Blatter\nDepartment of Mathematics\nSwiss Fed. Inst. of Technology\nCH-8092 Zurich (Switzerland)\ne-mail: christian.blatter@math.ethz.ch\n\n12\n\n\f"}