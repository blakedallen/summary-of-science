{"id": "http://arxiv.org/abs/1008.1804v1", "guidislink": true, "updated": "2010-08-10T20:53:31Z", "updated_parsed": [2010, 8, 10, 20, 53, 31, 1, 222, 0], "published": "2010-08-10T20:53:31Z", "published_parsed": [2010, 8, 10, 20, 53, 31, 1, 222, 0], "title": "A new surrogate data method for nonstationary time series", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1008.3592%2C1008.4029%2C1008.4301%2C1008.0460%2C1008.5023%2C1008.0166%2C1008.4215%2C1008.0085%2C1008.1332%2C1008.1973%2C1008.0411%2C1008.3365%2C1008.1942%2C1008.4055%2C1008.1357%2C1008.4613%2C1008.0666%2C1008.0529%2C1008.2955%2C1008.1401%2C1008.5374%2C1008.3078%2C1008.2005%2C1008.4293%2C1008.2784%2C1008.0751%2C1008.1617%2C1008.0983%2C1008.2189%2C1008.0826%2C1008.2984%2C1008.3701%2C1008.0119%2C1008.3509%2C1008.3038%2C1008.1463%2C1008.0165%2C1008.1804%2C1008.2006%2C1008.4035%2C1008.1935%2C1008.0156%2C1008.2828%2C1008.3025%2C1008.5165%2C1008.2714%2C1008.1406%2C1008.1656%2C1008.1408%2C1008.1963%2C1008.2508%2C1008.0228%2C1008.1866%2C1008.1108%2C1008.1225%2C1008.4648%2C1008.3007%2C1008.4602%2C1008.5217%2C1008.3805%2C1008.2445%2C1008.1224%2C1008.2749%2C1008.4999%2C1008.0422%2C1008.3997%2C1008.0226%2C1008.3777%2C1008.5129%2C1008.2956%2C1008.4851%2C1008.1339%2C1008.4812%2C1008.1928%2C1008.5264%2C1008.4093%2C1008.3013%2C1008.0017%2C1008.4404%2C1008.4704%2C1008.1356%2C1008.1609%2C1008.1484%2C1008.0730%2C1008.1534%2C1008.0052%2C1008.0977%2C1008.4146%2C1008.0408%2C1008.3483%2C1008.2400%2C1008.3297%2C1008.2218%2C1008.0724%2C1008.1781%2C1008.3834%2C1008.4777%2C1008.1292%2C1008.1492%2C1008.3938%2C1008.2019&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A new surrogate data method for nonstationary time series"}, "summary": "Hypothesis testing based on surrogate data has emerged as a popular way to\ntest the null hypothesis that a signal is a realization of a linear stochastic\nprocess. Typically, this is done by generating surrogates which are made to\nconform to autocorrelation (power spectra) and amplitude distribution of the\ndata (this is not necessary if data are Gaussian). Recently, a new algorithm\nwas proposed, the null hypothesis addressed by this algorithm is that data are\na realization of a non stationary linear stochastic process, surrogates\ngenerated by this algorithm preserve the autocorrelation and local mean and\nvariance of data. Unfortunately, the assumption of Gaussian amplitude\ndistribution is not always valid. Here we propose a new algorithm; the\nhypothesis addressed by our algorithm is that data are a realization of a\nnonlinear static transformation of a non stationary linear stochastic process.\nSurrogates generated by our algorithm preserve the autocorrelation, amplitude\ndistribution and local mean and variance of data. We present some numerical\nexamples where the previously proposed surrogate data methods fail, but our\nalgorithm is able to discriminate between linear and nonlinear data, whether\nthey are stationary or not. Using our algorithm we also confirm the presence of\nnonlinearity in the monthly global average temperature and in a small segment\nof a signal from a Micro Electrode Recording.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1008.3592%2C1008.4029%2C1008.4301%2C1008.0460%2C1008.5023%2C1008.0166%2C1008.4215%2C1008.0085%2C1008.1332%2C1008.1973%2C1008.0411%2C1008.3365%2C1008.1942%2C1008.4055%2C1008.1357%2C1008.4613%2C1008.0666%2C1008.0529%2C1008.2955%2C1008.1401%2C1008.5374%2C1008.3078%2C1008.2005%2C1008.4293%2C1008.2784%2C1008.0751%2C1008.1617%2C1008.0983%2C1008.2189%2C1008.0826%2C1008.2984%2C1008.3701%2C1008.0119%2C1008.3509%2C1008.3038%2C1008.1463%2C1008.0165%2C1008.1804%2C1008.2006%2C1008.4035%2C1008.1935%2C1008.0156%2C1008.2828%2C1008.3025%2C1008.5165%2C1008.2714%2C1008.1406%2C1008.1656%2C1008.1408%2C1008.1963%2C1008.2508%2C1008.0228%2C1008.1866%2C1008.1108%2C1008.1225%2C1008.4648%2C1008.3007%2C1008.4602%2C1008.5217%2C1008.3805%2C1008.2445%2C1008.1224%2C1008.2749%2C1008.4999%2C1008.0422%2C1008.3997%2C1008.0226%2C1008.3777%2C1008.5129%2C1008.2956%2C1008.4851%2C1008.1339%2C1008.4812%2C1008.1928%2C1008.5264%2C1008.4093%2C1008.3013%2C1008.0017%2C1008.4404%2C1008.4704%2C1008.1356%2C1008.1609%2C1008.1484%2C1008.0730%2C1008.1534%2C1008.0052%2C1008.0977%2C1008.4146%2C1008.0408%2C1008.3483%2C1008.2400%2C1008.3297%2C1008.2218%2C1008.0724%2C1008.1781%2C1008.3834%2C1008.4777%2C1008.1292%2C1008.1492%2C1008.3938%2C1008.2019&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Hypothesis testing based on surrogate data has emerged as a popular way to\ntest the null hypothesis that a signal is a realization of a linear stochastic\nprocess. Typically, this is done by generating surrogates which are made to\nconform to autocorrelation (power spectra) and amplitude distribution of the\ndata (this is not necessary if data are Gaussian). Recently, a new algorithm\nwas proposed, the null hypothesis addressed by this algorithm is that data are\na realization of a non stationary linear stochastic process, surrogates\ngenerated by this algorithm preserve the autocorrelation and local mean and\nvariance of data. Unfortunately, the assumption of Gaussian amplitude\ndistribution is not always valid. Here we propose a new algorithm; the\nhypothesis addressed by our algorithm is that data are a realization of a\nnonlinear static transformation of a non stationary linear stochastic process.\nSurrogates generated by our algorithm preserve the autocorrelation, amplitude\ndistribution and local mean and variance of data. We present some numerical\nexamples where the previously proposed surrogate data methods fail, but our\nalgorithm is able to discriminate between linear and nonlinear data, whether\nthey are stationary or not. Using our algorithm we also confirm the presence of\nnonlinearity in the monthly global average temperature and in a small segment\nof a signal from a Micro Electrode Recording."}, "authors": ["Diego Guarin", "Alvaro Orozco", "Edilson Delgado"], "author_detail": {"name": "Edilson Delgado"}, "author": "Edilson Delgado", "arxiv_comment": "9 pages, 15 figures", "links": [{"href": "http://arxiv.org/abs/1008.1804v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1008.1804v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "nlin.CD", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "nlin.CD", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.data-an", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "37M10 (Primary), 65C99 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1008.1804v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1008.1804v1", "journal_reference": null, "doi": null, "fulltext": "A new surrogate data method for nonstationary time series\nDiego L. Guar\u0131\u0301n L\u00f3peza,1,\u2217, Alvaro A. Orozco Gutierreza, Edilson Delgado Trejosb\na Department\n\nof Electrical Engineering. Universidad tecnol\u00f3gica of Pereira. Pereira, Colombia.\ncenter at the Instituto Tecnol\u00f3gico Metropolitano. Medell\u0131\u0301n, Colombia.\n\narXiv:1008.1804v1 [nlin.CD] 10 Aug 2010\n\nb Research\n\nAbstract\nHypothesis testing based on surrogate data has emerged as a popular way to test the null hypothesis that a signal is a\nrealization of a linear stochastic process. Typically, this is done by generating surrogates which are made to conform\nto autocorrelation (power spectra) and amplitude distribution of the data (this is not necessary if data are Gaussian).\nRecently, a new algorithm was proposed, the null hypothesis addressed by this algorithm is that data are a realization\nof a non stationary linear stochastic process, surrogates generated by this algorithm preserve the autocorrelation and\nlocal mean and variance of data. Unfortunately, the assumption of Gaussian amplitude distribution is not always\nvalid. Here we propose a new algorithm; the hypothesis addressed by our algorithm is that data are a realization of\na nonlinear static transformation of a non stationary linear stochastic process. Surrogates generated by our algorithm\npreserve the autocorrelation, amplitude distribution and local mean and variance of data. We present some numerical\nexamples where the previously proposed surrogate data methods fail, but our algorithm is able to discriminate between\nlinear and nonlinear data, whether they are stationary or not. Using our algorithm we also confirm the presence of\nnonlinearity in the monthly global average temperature and in a small segment of a signal from a Micro Electrode\nRecording.\nKeywords:\nComputational methods in statistical physics and nonlinear dynamics, Hypothesis testing, Surrogate data, Time\nseries analysis\n\n1. Introduction\nSurrogate data method, initially introduced by\nTheiler et al. [1] is nowadays one of the most popular\ntests used in nonlinear time series analysis to investigate\nthe existence of nonlinear dynamics underlying experimental data. The approach is to formulate a null hypothesis for a specific process class and compare the system\noutput to this hypothesis. The surrogate data method\ncan be undertaken in two different ways: Typical realizations are Monte Carlo generated surrogates from a\nmodel that provides a good fit to the data; constrained\nrealizations are surrogates generated from the time series to conform to certain properties of the data. The\nlatter approach is preferable for hypothesis testing due\n\u2217 Corresponding\n\nauthor.\nEmail addresses: dlguarin@gmail.com (Diego L. Guar\u0131\u0301n\nL\u00f3pez), aaog@utp.edu.co (Alvaro A. Orozco Gutierrez),\nedilsondelgado@itm.edu.co (Edilson Delgado Trejos)\n1 Diego L. Guar\u0131\u0301n L\u00f3pez is supported by the Universidad Tecnol\u00f3gica de Pereira and Colciencias, Contract No 5304 of 2010.\nPreprint submitted to Nonlinear Analysis: Real World Applications\n\nto the fact that it does not requiere a pivotal statistics\n[2]. In order to test a null hypothesis at a level of significance \u03b1, one has to generate 1/\u03b1\u22121 (2/\u03b1\u22121) surrogates\nfor a one side (two side) test. Then, one simply evokes\nwhatever statistic is of interest and compares the value\nof this statistic computed from data to the distribution of\nvalues elicited from the surrogates. If the statistic value\nof the data deviates from that of the surrogates, then the\nnull hypothesis may be rejected. Otherwise, it may not.\nThe classical methods for constrained realizations\nnamed (i) Random shuffle (RS); (ii) Random phase\n(RP); and, (iii) Amplitude adjusted Fourier transform\n(AAFT) surrogates [1], were developed to test the null\nhypothesis that the data came from a (i) i.i.d gaussian\nrandom process, (ii) linear correlated stochastic process; and (iii) nonlinear static transformation of a linear stochastic process. Surrogates generated with the\nRS method preserves the amplitude distribution (AD) of\nthe original data, while the ones generated with the RP\nalgorithm preserve the autocorrelation (AC) and surrogates generated with the AAFT algorithm preserve both\nOctober 29, 2018\n\n\fthe AD and the AC of the original data (in general this is\nnot true, this is why an improved version of the AAFT\nalgorithm was presented, referred as iAAFT [3]).\nRecently, Richard et al. [4] showed that surrogates generated with the mentioned methods are stationarized\nversions of the original data. This imply that while\nthe statistical properties of the data might be time dependent, the statistical properties of the surrogates will\nnot. Because of this, when data becomes from a nonstationary process, it is impossible to make a statistical\ncomparison of data with its surrogates. So, the classical surrogate data methods are not applicable to nonstationary process. Due the importance of this kind of\nprocess, many modifications of the classical methods\nhave been presented. The first one can be attributed to\nSchreiber and Schmitz [5], in this approach the surrogate data preserves the AC and any other desired property of the original time series. To generate a surrogate\none starts by random shuffling the data, then measuring (for example) the AC of the surrogates and defining an error function as the square difference of data\nAC minus the surrogate AC. One has to keep permuting\npairs until the error function is minimized. To generate surrogates for non stationary time series, one has to\nensure that the surrogates also preserve the local mean\nand variance of the data. This procedure can be done\niteratively by means of any optimization algorithm, but\nthere is no guarantee that one will not be stuck in a local minimum (this issue was overcome in [5] by using\nthe simulated annealing optimization method). Unfortunately, this method requires a lot of computational time,\nso it is of limited applicability.\nRecently, Nakamura et al. [6] presented a modification of the RP method which makes it suitable for nonstationary data, they called its method Truncated Fourier\nTransform (TFT). Surrogates generated with the TFT\nalgorithm are constrained to preserve the AC and the local mean and variance of data so, surrogates will be nonstationary if original data are non-stationary. Through\nthis method it is possible to test the null hypothesis\nthat the data came from a non-stationary linear correlated stochastic process. Since surrogates generated\nwith this method do not preserve the AD of data, further hypothesis (e.g, data are a realization of a nonlinear\nstatical transformation of a non-stationary linear correlated stochastic process) can not be tested. The aim of\nthis paper is to present a new surrogate data method\nthrough which is possible to obtain surrogates that are\nconstrained to preserve the AC, AD and local mean and\nvariance of data, but are otherwise random.\nThis document is organized in the following way; initially we briefly introduce the RP, AAFT and the TFT\n\nmethods, followed by an introduction to our method,\nnamed Amplitude Adjusted Truncated Fourier Transform (AATFT). Then we introduce a methodology to\naccept or reject a null hypothesis and proceed to apply\nthe methods to several simulated and real time series,\nshowing the utility of each one. Finally we present some\nconcluding remarks.\n2. Surrogate data methods\nAs mentioned, the surrogate data methods, originally\nintroduced by Theiler et al. [1], has become a very popular method for hypothesis testing. The original algorithms can be stated as follows:\n2.1. The existing algorithms\n2.1.1. Random Phase surrogates (RP)\nThe surrogate data is generated by the following procedure:\n1. Start with the original data x[t], t = 1, * * * , N.\n2. Compute z[n], the Fourier transform of x[t].\n3. Randomize the phases: z\u2032 [n] = z[n]e\u0131\u03c6[n] .\nWhere \u03c6[1] = 0 and \u03c6[n] \u2208 N(0, 2\u03c0), n = 2, . . . , N.\n4. Symmetrize z\u2032 [n] (to obtain a real inverse Fourier\nTransform):\nz\u2032 [n \u2212 i + 1] = b\nz\u2032 [i + 1], i = 1, . . . , f loor(n/2),\nif N is even then z\u2032 [n/2 + 1] = abs(z\u2032 [n/2 + 1]).\nb\nz[n] is the complex conjugate of z[n].\n5. Obtain x\u2032 [t], the inverse Fourier transform of z\u2032 [n].\n\nx\u2032 [t] is the surrogate data of x[t].\nThe surrogates maintain the linear correlation of the\ndata, but by means of the phases randomization, any\nnonlinear structure is destroyed.\n\n2.1.2. Amplitude Adjusted Fourier Transform surrogates (AAFT)\nThe surrogate data is generated by the following procedure:\n1.\n2.\n3.\n4.\n5.\n6.\n7.\n8.\n2\n\nStart with the original data x[t], t = 1, . . . , N.\nSort the data S x[k], k = 1, . . . , N.\nCompute z[n], the Fourier transform of x[t].\nMake a ranked time series Rx[t] defined to satisfy\nS x[Rx[t]] = x[t].\nCreate a random data set g[t], t = 1, . . . , N.\nSort the random gaussian number S g[k], k =\n1, . . . , N.\nDefine a new time series y[t] = S g[Rx[t]].\nGenerate a surrogate time series y\u2032 [t] from y[t] using the RP algorithm.\n\n\f9. Make a ranked time series Ry\u2032 [t] of y\u2032 [t].\n10. The surrogate time series of x[t] is given by x\u2032 [t] =\nS x[Ry\u2032 [t]].\n\n2.2. A new algorithm\n2.2.1. Amplitude Adjusted Truncated Fourier Transform surrogates (AATFT)\nSurrogates generated with the TFT algorithm do not\npreserve AD of data (this is actually not true, if fc is\nhigh enough the surrogates AD will eventually be like\nthe data AD, but this imply that surrogates are too similar to data). It is tempting to think that this issue can be\novercome by simply applying a similar procedure to the\nAAFT (or the iAAFT) algorithm, but the solution is not\nso simple. The idea of the TFT method is to preserve the\nlow frequency components of data in surrogates, this is\ndone by preserving some phases of frequency domain,\nand it is possible to observe that thanks to the reordering procedure of the AAFT method the phases will no\nlonger be preserved.\nIn order to preserve the AC, AD and local mean and\nvariance of data in surrogates we propose the following\nprocedure.\n\nx\u2032 [t] is the surrogate data of x[t].\nIt is evident that this process achieves two aims: First,\njust as with RP algorithm, the power spectra (and therefore linear correlation) of the data is preserved in the\nsurrogate; and second, the re-ordering process means\nthat the AD of the data and surrogate is also identical\n(this is actually not true, as this algorithm does not simultaneously preserve both rank distribution and power\nspectra, which is why the iAAFT [3] has to be used in\nmost practical situations).\n2.1.3. Truncated Fourier Transform Surrogates (TFT)\nThe TFT algorithm introduced a way to deal with non\nstationarity; this algorithm works by preserving the low\nfrequency phases in the Fourier domain, but randomizing the high frequency components.\nThe surrogate data is generated by the following procedure:\n\n1.\n2.\n3.\n4.\n\n1. Start with the original data x[t], t = 1, * * * , N.\n2. Compute z[n], the Fourier transform of x[t].\n3. Randomize the phases: z\u2032 [n] = z[n]e\u0131\u03c6[n] . Where\n\u03c6[n] \u2208 N(0, \u03c0) if n > fc .\n\u03c6[n] = 0 if n \u2264 fc .\n4. Symmetrize z\u2032 [n] (as in the RP algorithm).\n5. Obtain x\u2032 [t], the inverse Fourier transform of z\u2032 [n].\n\n5.\n6.\n7.\n8.\n9.\n\nx\u2032 [t] is the surrogate data of x[t].\nWhile all phases are not randomized in this method, it\nis possible to discriminate between linearity and nonlinearity because the superposition principle is valid\nonly for linear data. i.e., when data are nonlinear, even\nif the power spectrum is preserved completely, the inverse Fourier transform data using randomized phases\nwill exhibit a different dynamical behavior.\nThe surrogate data generated by this method are influenced primarily by the choice of frequency fc . If fc is\ntoo high, the TFT surrogates are almost identical to the\noriginal data. In this case, even if there is nonlinearity\nin irregular fluctuations, one may fail to detect it. Conversely, if fc is too low, the TFT surrogates are almost\nthe same as the linear surrogate and the long-term trends\nare not preserved. In this case, even if there is no nonlinearity in irregular fluctuations, one may wrongly judge\notherwise. The method for selecting the correct value of\nfc was presented in [6].\n\nStart with the original data x[t], t = 1, . . . , N.\nSort the data S x[k], k = 1, . . . , N.\nCompute z[n], the Fourier transform of x[t].\nGenerate a surrogate time series x\u2032 [t] of x[t] using\nthe TFT algorithm.\nCompute z\u2032 [n], the Fourier transform of x\u2032 [t].\nChange the magnitude of z\u2032 [n]:\nz\u2032 [n] = (z\u2032 [n]/abs(z\u2032[n])) abs(z[n]).\nObtain x\u2032 [t], the inverse Fourier transform of z\u2032 [n].\nMake a ranked time series Rx\u2032 [t] of x\u2032 [t].\nModify x\u2032 [t] so it has the same data as S x[k] but\nwith the order given by Rx\u2032 [t]: x\u2032 [Rx\u2032 [t]] = S x[k].\n\nx\u2032 [t] is the surrogate data of x[t].\nIf one iteratively performs the steps 5 to 9 it is possible\nto increase the fitness between AC of the data and the\nsurrogates (the iterative procedure will also reduce the\npreservation of local mean and variance, but this can\nbe solved increasing the value of fc ). This iterative\nprocedure will be referred to as iAATFT. Note that\n\u2032\nsurrogate time series x [t] is just a shuffling of original\ntime series x[t], so it has the same AD.\nIt is important to notice that any implementation of\nthe discrete FT assumes that the time series under consideration is periodic with a finite period. When there is\na large difference between the first and last points (endpoint mismatch), the FT will treat this as a sudden discontinuity in the time series. As a result, this will introduce significant spurious high-frequency power into the\npower spectrum, which is a critical problem when the\nrandomization is centered only on the high-frequency\n3\n\n\fportion.\nTo ameliorate this artifact, Nakamura et al. [6] proposed\nto symmetrize the original data before the application of\nthe FT (i.e. {x1 , x2 , * * * , xn\u22121 , xn , xn , xn\u22121 , * * * , x2 , x1 }).\nWith this procedure, there is no end-point mismatch in\nthe data.\n\nFor robustness, the AMI must be calculated for lag of\n1. This calculates on average how much information we\nhave about {xt+1 } knowing {xt }. So, if AMI(\u03c4 = 1) of the\ndata deviates from that of the surrogates (i.e. is greater\nor lower) then the null hypothesis may be rejected.\nIn order to reject (or not) a null hypothesis we generate\nN = 99 surrogates, which gaves us a level of significance \u03b1 = 0.02.\n\n3. Testing for nonlinearity\nNext we describe our selection of discriminant statistics, and propose a methodology to accept or reject a\nnull hypothesis using this statistic. Finally we study a\nmethod for selecting the correct value of fc .\nIt is important to clarify that we are not interested in\nperforming a deep analysis on the linearity or nonlinearity of any specific time series, our aim is to preset\nand study the behavior of the new surrogate data method\ncalled AATFT; further applications will be presented in\nthe future.\n\n3.3. Selection of the correct value of fc\nThe selection of the correct value of fc cannot be done\na priori, because it depends on the nature of the data\nand the length of the time series [6]. Our aim is to\npreserve AC, AD and local mean and variances of the\noriginal data in the surrogates. The conservation of AD\nis assured by the reordering process of the AATFT algorithm. To preserve AC and local mean and variance\none has to start by randomizing all the phases (100% of\nfrequency domain), if AC, local mean and variance of\nsurrogates are not similar to the data then it is necessary to randomize only a portion of the phases (i.e. 99%\nof the higher frequency domain), and keep decreasing\nthe value of fc by small steps until the surrogates preserve AC, local mean and variance of the original data.\nIt should be noted that it is no possible to preserve the\nAC for all lags, but at least for small lags the surrogates\nAC should be identical to the data AC.\n\n3.1. Selection of the discriminant statistics\nDynamical measures are often used as discriminating\nstatistics. According to [7], the correlation dimension\nis one of the most popular choices. To estimate these,\nwe first need to reconstruct the underlying attractor. For\nthis purpose, a time-delay embedding reconstruction is\nusually applied. But this method is not useful for data\nexhibiting irregular fluctuations and long-term trends,\nbecause a smaller time delay is necessary to treat irregular fluctuations and a larger time delay is necessary to\ntreat long-term trends. At the moment, there is no optimal method for embedding such data [7].\nTherefore, as discriminant statistics we chose the Average Mutual Information (AMI). The AMI is a nonlinear\nversion of the AC. It can answer the following question:\nOn average, how much does one learn about the future\nfrom the past?. For further information regarding the\nAMI, the reader is referred to [7] and references within.\n\n4. Results\n4.1. Numerical examples\nIn order to prove the validity of our surrogate data\nmethod, we compared results obtained by applying the\ndifferent algorithms to a fictional time series.\n4.1.1. A simple example\nFirst, we analyzed the data generated by a linear AR\nmodel given by\n\n3.2. Rejection or acceptance of a null hypothesis\nSurrogate data methods are based on the Monte Carlo\nhypothesis testing procedure, first one calculates the\nstatistic for data and surrogates, and then one compares\nthe value of this statistic computed from the data to the\ndistribution of values elicited from the surrogates. If\nthere is sufficient difference the null might be rejected,\notherwise it will not.\nThe level of significance of the test is given by the number of surrogates. For a one sided (two sided) test a level\nof significance \u03b1 is reached with 1/\u03b1 \u2212 1 (2/\u03b1 \u2212 1) surrogates.\n\nx(t) = a1 x(t \u2212 1) + a6 x(t \u2212 6) + \u03b7.\n\n(1)\n\nWhere a1 = 0.3, a6 = 0.2 and \u03b7 \u2208 N(0, 1). We obtained 2048 values and discarded the first half. Our aim\nwas to prove what has been argued about each algorithm, in this case the acceptance of the null hypothesis is granted. Figs. 1 to 4 show that each algorithm\nachieves its goals, so using the AATFT algorithm we\ncan generate surrogate constrained to have the same AC,\nAD and local mean and variance of the data.\n4\n\n\fa)\n\nb)\n\na)\n\n0.2\n0.1\n0\n\u22120.1\n\u22120.2\n\n0\n\u22122\n\u22124\n200\n\n400 600\nIteration\nc)\n\n800\n\n1000\n\nb)\n0.2\n0.1\n0\n\u22120.1\n\u22120.2\n\n0\n\u22122\n\u22124\n\n10\n\n15\nWindow\nd)\n\n20\n\n200\n\n400 600\nIteration\nc)\n\n800\n\n1000\n\n200\n\n15\nWindow\nd)\n\n20\n\n200\n\n1\n\n1\n150\n\n0.5\n\n150\n0.5\n\n100\n50\n\n0\n0\n\n10\n\n10\n\n20\n\n30\nLag\n\n40\n\n50\n\n0\n\n100\n50\n\n0\n\u22120.5\n\n0\n0.5\nAmplitude\n\n1\n\n0\n\n10\n\n20\n\n30\nLag\n\n40\n\n50\n\n0\n\n\u22120.5\n\n0\n0.5\nAmplitude\n\n1\n\nFigure 1: a) Original Data (black), surrogate data generated with the\nRP algorithm (dark gray) and difference between data and surrogate\n(gray). Values are displaced from one another by 2 for clarity. b) Local\nMean and variance of data (black) and surrogates (dotted gray). c) AC\nof data (black) and surrogates (dotted dark gray), and the difference\nbetween AC of data and surrogates (gray). The difference is displaced\nby 0.2 for clarity. d) AD of data (black) and of surrogates (dotted\ngray)\n\nFigure 2: a) Original Data (black), surrogate data generated with the\niAAFT algorithm (dark gray) and difference between data and surrogate (gray). Values are displaced from one another by 2 for clarity. b)\nLocal Mean and variance of data (black) and surrogates (dotted gray).\nc) AC of data (black) and surrogates (dotted dark gray), and the difference between AC of data and surrogates (gray). The difference is\ndisplaced by 0.2 for clarity. d) AD of data (black) and of surrogates\n(dotted gray)\n\n4.1.2. Failure of the iAAFT algorithm\nTo study the behavior of algorithms in presence of\nnon stationarity we followed [8]. First we defined an\nAR process.\n\n(the following parameters were used: T = 50,\u03c4 = 10,\nT mod = 250 and MT = 5.5) and a surrogate generated\nwith each algorithm (we excluded the RP algorithm).\nFig. 6 shows an amplification of Fig. 5, it can be noted\nthat surrogates generated with TFT and iAATFT algorithms preserve the low frequency behavior. Finally,\nFig. 7 shows the results of computing AMI(\u03c4 = 1) for\ndata and 99 surrogates generated with each algorithm,\nit can be observed in Fig. 7 a) that the null hypothesis addressed by the iAAFT algorithm was rejected, but\nthis happens because the times series is non stationary\nnot because it is nonlinear. As expected, the hypothesis addressed by TST and AATFT algorithms was not\nrejected (Timmer [8] proved that the iAAFT algorithm\nis robust for some kinds of non-stationarity, but as seen\nhere this is not a general result).\n\nx(t) = a1 (t)x(t \u2212 1) + a2 (t)x(t \u2212 2) + a3 (t) + \u03b7.\n\n(2)\n\nWhere,\na1 = 2 cos (2\u03c0/T ) exp (\u22121/\u03c4),\na2 = \u2212 exp (\u22122/\u03c4),\n\n(3)\n\na3 = 1.\nThis process can be interpreted as a damped oscillator,\nwith period T and relaxation time \u03c4. Period-based modulation is introduced by subjecting the mean period of\nthe AR process to a sinusoidal fluctuation of the form\nT (t) = T + Mt sin (t2\u03c0/T mod ).\n\n(4)\n\n4.1.3. Failure of the TFT algorithm\nNext we generated surrogates for the following process\nh(t) = g[x(t)] = x(t)2 .\n(7)\n\nThis modulation introduces a temporal dependency in\na1 :\na1 (t) = 2 cos (2\u03c0/T (t)) exp (\u22121/\u03c4).\n(5)\nHowever, 4 also introduces a temporal dependency in\nthe variance, which can be compensated by using\n\uf8eb\n\uf8f6\na23\n\uf8ec\uf8ec\uf8ec\n\uf8f7\uf8f7\uf8f7\n2\na3 (t) = \uf8ed\uf8ec\n\uf8f8\uf8f7\n2\n2\n2\n1 \u2212 a1 \u2212 a2 \u2212 2a1 a2 /(1 \u2212 a2 )\n(6)\n!\n2a1 (t)2 a2\n2\n2\n.\n\u00d7 1 \u2212 a1 (t) \u2212 a2 \u2212\n1 \u2212 a2\n\nWhere x(t) is given by 2. In this case, the signal is nonlinear, but the nonlinearity is given by the observation\nfunction g[ ] rather than by the dynamic of the process.\nFig. 8 shows that the TFT algorithm detects nonlinearity, but the iAAFT algorithm does not. This result was\nexpected, because the hypothesis addressed by the TFT\nalgorithm does not involve a static nonlinear transformation of the linear non stochastic process, while this\nis exactly the hypothesis addressed by the AATFT algorithm.\n\nTo generate data, we obtained 2048 values and discarded the first half. Fig. 5 shows the time series\n5\n\n\fa)\n\nb)\n\na)\n\n0.2\n0.1\n0\n\u22120.1\n\u22120.2\n\n0\n\u22122\n\u22124\n200\n\n400 600\nIteration\nc)\n\n800\n\n1000\n\nb)\n0.2\n0.1\n0\n\u22120.1\n\u22120.2\n\n0\n\u22122\n\u22124\n\n10\n\n15\nWindow\nd)\n\n20\n\n200\n\n400 600\nIteration\nc)\n\n800\n\n1000\n\n200\n\n15\nWindow\nd)\n\n20\n\n200\n\n1\n\n1\n150\n\n0.5\n\n150\n0.5\n\n100\n50\n\n0\n0\n\n10\n\n10\n\n20\n\n30\nLag\n\n40\n\n50\n\n0\n\n100\n50\n\n0\n\u22120.5\n\n0\n0.5\nAmplitude\n\n1\n\n0\n\n20\n\n30\n\n40\n\n50\n\n0\n\n\u22120.5\n\n0\n0.5\nAmplitude\n\nLag\n\nFigure 3: a) Original Data (black), surrogate data generated with the\nTFTS algorithm (dark gray) and difference between data and surrogate (gray). Values are displaced from one another by 2 for clarity. b)\nLocal Mean and variance of data (black) and surrogates (dotted gray).\nc) AC of data (black) and surrogates (dotted dark gray), and the difference between AC of data and surrogates (gray). The difference is\ndisplaced by 0.2 for clarity. d) AD of data (black) and of surrogates\n(dotted gray). In this case we randomized the higher 98% of the frequency domain.\n\n1\n\nFigure 4: a) Original Data (black), surrogate data generated with the\nAATFT algorithm (dark gray) and difference between data and surrogate (gray). Values are displaced from one another by 2 for clarity. b)\nLocal Mean and variance of data (black) and surrogates (dotted gray).\nc) AC of data (black) and surrogates (dotted dark gray), and the difference between AC of data and surrogates (gray). The difference is\ndisplaced by 0.2 for clarity. d) AD of data (black) and of surrogates\n(dotted gray). In this case we randomized the higher 99% of the frequency domain.\n\n4.1.4. Failure of the three methods\nWe now present a case where neither of the hypotheses are rejected despite the fact that the system that generated the signal is nonlinear. The signal was generated\nby the Duffing system, given by\n\u1e8d + \u03c3 \u1e8b + \u03c920 x + \u03b2x = \u03b3 cos \u03c9t.\n\n10\n\n0\n\n\u22122\n\n\u22124\n\n(8)\n\n\u22126\n0\n\nIn this case, \u03c3 = 0, \u03c920 = \u03b3 = \u03c9 = 1 and \u03b2 = 0.3.\nThe signal x is obviously nonlinear, but this is a case of\nweak nonlinearity [9].\nFig. 9 shows 1024 points of the x component of the\nDuffing equation (integrated for 10.000 steps with a unit\nof 0.1, discarded the first half and then selected a subsegment of 1024 points which minimized the end-point\nmismatch) and also shows a surrogate generated with\neach algorithm. Surrogates generated with each algorithm are very similar to the data, in this case we found\nthat randomizing the higher 95% of the frequency domain, the AC, local mean and variance of data were\npreserved in the surrogates generated with the TFT and\niAATFT methods. Fig. 10 shows that neither of the hypotheses can be rejected using the AMI. The fact that the\ntest fails to reject the hypothesis could be a consequence\nof the selected discriminant statistic or just because the\nnonlinearity is so weak that the test simply fails to detect\nit.\n\n100\n\n200\n\n300\n\n400\n\n500\n600\nIteration\n\n700\n\n800\n\n900\n\n1000\n\nFigure 5: Data generated by a linear non stationary AR process\n(black), surrogate generated by the iAAFT algorithm (dark gray), the\nTFT algorithm (gray) and the iAATFT algorithm (light gray) each displaced from the other by 2 units for clarity\n\n[7], which is given by\n\u1e8b = a(y \u2212 x)\n\u1e8f = x(b \u2212 z) \u2212 y\n\u017c = xy \u2212 cz\n\n(9)\n\nThe system exhibits a chaotic behavior with a = 10,\nb = 28 and c = 8/3.\nFig. 11 shows 1024 points of the x component of the\nLorenz system (integrated for 10.000 steps with a unit\nof 0.1, discarded the first half and then selected a subsegment of 1024 points which minimized the end-point\nmismatch), and also shows a surrogate generated with\neach algorithm. It is easy to see that the surrogate generated with the iAAFT algorithm is very different to the\ndata despite it preserve the AC and AD of the data (this\nsituation was also observed in Fig. 5), this imply that\n\n4.1.5. A chaotic system\nSubsequently, we used the iAAFT, TFT and the\niAATFT to generate surrogates for the Lorenz system\n6\n\n\fa)\n0\n\n\u22122\n0.32\n\n0.34\n\n0.36\n\n0.38\n\n0.4\n\n0.42\n\n0.44\n\n0.46\n\nb)\n\u22124\n\n\u22126\n820\n\n840\n\n860\n\n880\n\n900\n\n920\nIteration\n\n940\n\n960\n\n980\n\n1000\n\n0.295\n\n1020\n\n0.3\n\n0.305\n\n0.31\n\n0.315\n\n0.32 0.325\nAMI (\u03c4 = 1)\n\n0.33\n\n0.335\n\n0.34\n\n0.345\n\nFigure 8: AMI (\u03c4 = 1) for data generated by a linear non stationary\nAR process observed through a nonlinear function (longer stem) and\n99 surrogates generad with the a) TFT algorithm and b) iAATFT algorithm (10 iterations were performed). We randomized the higher 98%\nof the frequency domain.\n\nFigure 6: Data generated by a linear non stationary AR process\n(black), surrogate generated by the iAAFT algorithm (dark gray), the\nTFT algorithm (gray) and the iAATFT algorithm (light gray) each displaced from the other by 2 units for clarity\n\na)\n\n0\n0.5\n\n0.51\n\n0.52\n\n0.53\n\n0.54\nb)\n\n0.55\n\n0.56\n\n0.57\n\n0.58\n\u22122\n\n0.51\n\n0.52\n\n0.53\n\n0.54\n\n0.55\nc)\n\n0.56\n\n0.57\n\n0.58\n\n\u22124\n\n0.59\n\n\u22126\n0.53\n\n0.54\n\n0.55\n\n0.56\n0.57\nAMI (\u03c4 = 1)\n\n0.58\n\n0.59\n\n0.6\n\n0\n\nFigure 7: AMI (\u03c4 = 1) for data generated by a linear non stationary AR process (longer stem) and 99 surrogates generad with the a)\niAAFT algorithm, b) TFT algorithm and c) iAATFT algorithm (10\niterations were performed). We randomized the higher 99% of the\nfrequency domain.\n\n100\n\n200\n\n300\n\n400\n\n500\n600\nIteration\n\n700\n\n800\n\n900\n\n1000\n\nFigure 9: x component of the Duffing equation (black), surrogate generated by the iAAFT algorithm (dark gray), the TFT algorithm (gray)\nand the iAATFT algorithm (light gray) each displaced from the other\nby 2 units for clarity\n\n4.2.1. Monthly global average temperature (MGAT)\nAs shown in Fig. 13 a) the MGAT data is non stationary (it has a trend) and has an end point mismatch, so\nthe classical surrogate data methods would not be able\nto detect nonlinearity. Prior to the generation of surrogate data with the TFT and AATFT algorithms we proceeded to symmetrize the data in order to eliminate the\nend point mismatch.\nFig. 14 shows that both hypotheses were rejected, so\nthere is a good chance that the data is nonlinear (there\nis always room for error). This result verifies what was\nfound by [6].\n\ndata is either: nonlinear and stationary, linear and non\nstationary or nonlinear and non stationary, but we cannot make a clear distinction. Fig. 12 helps us clarify\nthis issue, it is obvious that data is nonlinear, because\nthe linear and stationary and linear and non stationary\nhypotheses were rejected.\n4.2. Application to real data\nBased on the previous results, we applied the TFT\nand the AATFT algorithms to two experimental systems: (i) monthly global average temperature (MGAT)\nfrom January 1880 to February 2010 (1562 data points).\nThis database is public, available on the web and (ii) Micro electrode recording (MER) from the substantia nigra pars reticulata (4096 data points) adquiared during a\nParkinson surgery held in Valencia (Spain). The equipment used in the acquisition was the LEADPOINT TM\nof Medtronic.\n\n4.2.2. Micro Electrode recordings (MER)\nWe now turn our attention to physiological data. Fig.\n13 b) shows the typical behavior of these kinds of signals, that is synchronization; the spike is generated because of the synchronization of a small cumulus of neurons sorrounding the micro-electrode implanted in the\nbrain, obviously this is a difficult case and the standard\n7\n\n\fa)\n\na)\n\n2.415\n\n2.42\n\n2.425\n\n2.43\n\n2.435\nb)\n\n2.44\n\n2.445\n\n2.45\n\n2.455\n1.75\n\n1.8\n\n1.85\n\n1.9\n\n1.95\n\n2\n\nb)\n2.41\n\n2.415\n\n2.42\n\n2.425\n\n2.43\n\n2.435\n\n2.44\n\n2.445\n\n2.45\n\nc)\n\n2.38\n\n2.39\n\n2.4\n\n2.41\n2.42\nAMI (\u03c4 = 1)\n\n2.43\n\n2.44\n\n1.84\n\n2.45\n\n1.86\n\n1.88\n\n1.9\n\n1.92\nAMI (\u03c4 = 1)\n\n1.94\n\n1.96\n\n1.98\n\n2\n\nFigure 12: AMI (\u03c4 = 1) for x component of the Lorenz system (longer\nstem) and 99 surrogates generad with the a) TFT algorithm and b)\niAATFT algorithm (20 iterations were performed). We randomized\nthe higher 97% of the frequency domain.\n\nFigure 10: AMI (\u03c4 = 1) for x component of the Duffing equation\n(longer stem) and 99 surrogates generad with the a) TFT algorithm\nand b) iAATFT algorithm (10 iterations were performed). We randomized the higher 95% of the frequency domain.\n\na)\n0.5\n0\n0\n\n\u22120.5\n0\n\n\u22122\n\n500\n\n1000\n\n1500\n\nMoths\nb)\n\n0.5\n\u22124\n0\n\u22120.5\n\n\u22126\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n600\n\n700\n\n800\n\n900\n\n\u22121\n0\n\n1000\n\n0.02\n\n0.04\n\n0.06\n\n0.08\ntime (s)\n\n0.1\n\n0.12\n\n0.14\n\n0.16\n\nFigure 13: Real time series. a) Monthly global average temperature\nfrom January 1880 to February 2010 and b) Micro electrode recording\n(MER) from the substantia nigra pars reticulata,\n\nFigure 11: x component of the Lorenz system (black), surrogate generated by the iAAFT algorithm (dark gray), the TFT algorithm (gray)\nand the iAATFT algorithm (light gray) each displaced from the other\nby 2 units for clarity\n\ngate data methods, by including non stationary and non\nGaussian processes. Through numerous examples we\ndemonstrate that classical surrogate data methods will\nfail to discrimine between linear and nonlinear systems\nwhen the underlying process is non-stationary; we also\nshown that the same problem occurs with the TFT surrogate method when the time series generated by a nonstationary process does not have a Gaussian AD. Only\nthe proposed AATFT algorithm is able to detect the true\nnature of the data in this cases.\nWith these methods we were able to confirm the presence of nonlinearity in the monthly global average temperature time series, and we also prove that the studied\nMER signal is a realization of a nonlinear statical transformation of a linear non-stationary stochastic process,\na result that will be studied further in future works.\n\nsurrogate data methods are useless. However, the TFT\nand the proposed (AATFT) methods are able to mimic\nthe temporal behavior of data which implies that the\npreservation of local mean and variance is key to generating valid surrogates. These results are shown in Fig.\n15. Finally, Fig. 16 shows that the hypothesis addressed\nby the TFT algorithm is rejected, while the hypothesis\naddressed by the AAFT algorithm is not. This implies\nthat data is nonlinear, but nonlinearity is due to the observation function, further discussion on this matter will\nbe presented in the future.\n5. Conclusions\nA new surrogate data algorithm was presented. With\nthis algorithm we were able to generate surrogate data\nthat are constrained to the have the same autocorrelation (power spectra), amplitude distribution and local mean and variance of data, but are otherwise realizations of a non-stationary linear stochastic process.\nIn this way we expanded the range of uses for surro-\n\n6. ACKNOWLEDGMENTS\nWe express our sincere gratitude to the Instrumentation and Control Research Group of the Universidad\nTecnol\u00f3gica of Pereira and to the MIRP group in the\n8\n\n\fa)\n\n2.28\n\n2.3\n\n2.32\n\na)\n\n2.34\n\n2.36\n\n2.38\n\n2.4\n\n0.67\n\n0.68\n\n0.69\n\nb)\n\n2.29\n\n2.3\n\n2.31\n\n2.32\n\n2.33\n2.34\nAMI (\u03c4 = 1)\n\n2.35\n\n2.36\n\n2.37\n\n2.38\n\n0.65\n\nFigure 14: AMI (\u03c4 = 1) for the Monthly global average temperature\nfrom January 1880 to February 2010 (longer stem) and 99 surrogates\ngenerad with the a) TFT algorithm and b) iAATFT algorithm (10 iterations were performed). We randomized the higher 98% of the frequency domain.\n\n0.71\n\n0.72\n\n0.73\n\n0.655\n\n0.66\n\n0.665\n\n0.67\n0.675\nAMI (\u03c4 = 1)\n\n0.68\n\n0.685\n\n0.69\n\n0.695\n\nFigure 16: AMI (\u03c4 = 1) for MER signal from the substantia nigra pars\nreticulata (longer stem) and 99 surrogates generad with the a) TFT\nalgorithm and b) iAATFT algorithm (10 iterations were performed).\nWe randomized the higher 97.5% of the frequency domain.\n\n[8] J. Timmer, Power of surrogate data testing with respect to nonstationarity, Physical Review E 58 (1998) 5153 \u2013 5156.\n[9] N. Huang, The Hilbert-Huang Transform in Engineering, Taylor\nand Francis Group, pp. 1 \u2013 22.\n\n0\n\n\u22122\n\n\u22124\n\n\u22126\n0\n\n0.7\na)\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n0.1\ntime (s)\n\n0.12\n\n0.14\n\n0.16\n\nFigure 15: MER signal from the substantia nigra pars reticulata(black), surrogate generated by the iAAFT algorithm (dark gray),\nthe TFT algorithm (gray) and the iAATFT algorithm (light gray) each\ndisplaced from the other by 2 units for clarity\n\nResearch Center of the Instituto Tecnol\u00f3gico Metropolitano of Medell\u0131\u0301n - Colombia.\n\nReferences\n[1] J. Theiler, S. Eubank, A. Longtin, B. Galdrikian, J. D. Farmer,\nTesting for nonlinearity in time series: The method of surrogate\ndata, Physica D 58 (1992) 77 \u2013 94.\n[2] J. Theiler, D. Prichard, Constrained realization monte carlo\nmethod for hypothesis testing, Physica D 94 (1996) 221 \u2013 235.\n[3] T. Schreiber, A. Schmitz, Improved surrogate data for nonlinearity tests, Physical Review Letters 77 (1996) 635 \u2013 638.\n[4] C. Richard, A. Ferrari, H. Amoud, P. Honeine, P. Flandrin,\nP. Borgnat, Statistical hypothesis testing with time-frequency\nsurrogates to check signal stationarity, in: IEEE Int. Conf. on\nAcoustics, Speech and Signal Proc. ICASSP 2010.\n[5] T. Schreiber, A. Schmitz, Surrogate time series, Physica D 142\n(2000) 346\u2013382.\n[6] T. Nakamura, M. Small, Y. Hirata, Testing for nonlinearity in\nirregular fluctuations with long-term trends, Physical Review E\n74 (2006) 026205.\n[7] M. Small, Applied Nonlinear Time Series Analysis - Applications\nin Physics, Physiology and Finance, World Scientific, 2005.\n\n9\n\n\f"}