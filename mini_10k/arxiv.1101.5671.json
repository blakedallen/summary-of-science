{"id": "http://arxiv.org/abs/1101.5671v1", "guidislink": true, "updated": "2011-01-29T06:04:35Z", "updated_parsed": [2011, 1, 29, 6, 4, 35, 5, 29, 0], "published": "2011-01-29T06:04:35Z", "published_parsed": [2011, 1, 29, 6, 4, 35, 5, 29, 0], "title": "Identikit 2: An Algorithm for Reconstructing Galactic Collisions", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1101.0391%2C1101.5016%2C1101.1625%2C1101.5929%2C1101.4700%2C1101.3911%2C1101.2841%2C1101.3775%2C1101.3510%2C1101.4065%2C1101.5455%2C1101.2135%2C1101.0791%2C1101.4174%2C1101.5917%2C1101.3882%2C1101.1764%2C1101.0276%2C1101.2582%2C1101.4901%2C1101.5945%2C1101.3318%2C1101.1127%2C1101.5643%2C1101.1470%2C1101.2918%2C1101.0225%2C1101.3941%2C1101.4341%2C1101.2447%2C1101.4036%2C1101.0761%2C1101.5088%2C1101.0210%2C1101.3351%2C1101.2606%2C1101.0819%2C1101.5179%2C1101.2643%2C1101.4350%2C1101.0243%2C1101.5624%2C1101.2989%2C1101.5671%2C1101.0124%2C1101.3751%2C1101.5848%2C1101.1217%2C1101.3857%2C1101.2590%2C1101.2698%2C1101.3757%2C1101.5670%2C1101.5594%2C1101.3507%2C1101.4122%2C1101.4926%2C1101.3764%2C1101.2250%2C1101.3674%2C1101.4395%2C1101.5219%2C1101.5998%2C1101.4662%2C1101.3365%2C1101.5727%2C1101.5920%2C1101.0192%2C1101.2077%2C1101.1585%2C1101.0900%2C1101.1373%2C1101.0019%2C1101.5131%2C1101.5744%2C1101.4896%2C1101.4619%2C1101.1958%2C1101.4714%2C1101.1716%2C1101.0384%2C1101.1953%2C1101.2248%2C1101.0094%2C1101.4468%2C1101.1363%2C1101.1523%2C1101.0389%2C1101.5622%2C1101.4542%2C1101.4728%2C1101.3491%2C1101.2707%2C1101.2058%2C1101.4536%2C1101.1555%2C1101.2722%2C1101.3406%2C1101.2667%2C1101.1454%2C1101.0831&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Identikit 2: An Algorithm for Reconstructing Galactic Collisions"}, "summary": "Using a combination of self-consistent and test-particle techniques,\nIdentikit 1 provided a way to vary the initial geometry of a galactic collision\nand instantly visualize the outcome. Identikit 2 uses the same techniques to\ndefine a mapping from the current morphology and kinematics of a tidal\nencounter back to the initial conditions. By requiring that various regions\nalong a tidal feature all originate from a single disc with a unique\norientation, this mapping can be used to derive the initial collision geometry.\nIn addition, Identikit 2 offers a robust way to measure how well a particular\nmodel reproduces the morphology and kinematics of a pair of interacting\ngalaxies. A set of eight self-consistent simulations is used to demonstrate the\nalgorithm's ability to search a ten-dimensional parameter space and find\nnear-optimal matches; all eight systems are successfully reconstructed.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1101.0391%2C1101.5016%2C1101.1625%2C1101.5929%2C1101.4700%2C1101.3911%2C1101.2841%2C1101.3775%2C1101.3510%2C1101.4065%2C1101.5455%2C1101.2135%2C1101.0791%2C1101.4174%2C1101.5917%2C1101.3882%2C1101.1764%2C1101.0276%2C1101.2582%2C1101.4901%2C1101.5945%2C1101.3318%2C1101.1127%2C1101.5643%2C1101.1470%2C1101.2918%2C1101.0225%2C1101.3941%2C1101.4341%2C1101.2447%2C1101.4036%2C1101.0761%2C1101.5088%2C1101.0210%2C1101.3351%2C1101.2606%2C1101.0819%2C1101.5179%2C1101.2643%2C1101.4350%2C1101.0243%2C1101.5624%2C1101.2989%2C1101.5671%2C1101.0124%2C1101.3751%2C1101.5848%2C1101.1217%2C1101.3857%2C1101.2590%2C1101.2698%2C1101.3757%2C1101.5670%2C1101.5594%2C1101.3507%2C1101.4122%2C1101.4926%2C1101.3764%2C1101.2250%2C1101.3674%2C1101.4395%2C1101.5219%2C1101.5998%2C1101.4662%2C1101.3365%2C1101.5727%2C1101.5920%2C1101.0192%2C1101.2077%2C1101.1585%2C1101.0900%2C1101.1373%2C1101.0019%2C1101.5131%2C1101.5744%2C1101.4896%2C1101.4619%2C1101.1958%2C1101.4714%2C1101.1716%2C1101.0384%2C1101.1953%2C1101.2248%2C1101.0094%2C1101.4468%2C1101.1363%2C1101.1523%2C1101.0389%2C1101.5622%2C1101.4542%2C1101.4728%2C1101.3491%2C1101.2707%2C1101.2058%2C1101.4536%2C1101.1555%2C1101.2722%2C1101.3406%2C1101.2667%2C1101.1454%2C1101.0831&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Using a combination of self-consistent and test-particle techniques,\nIdentikit 1 provided a way to vary the initial geometry of a galactic collision\nand instantly visualize the outcome. Identikit 2 uses the same techniques to\ndefine a mapping from the current morphology and kinematics of a tidal\nencounter back to the initial conditions. By requiring that various regions\nalong a tidal feature all originate from a single disc with a unique\norientation, this mapping can be used to derive the initial collision geometry.\nIn addition, Identikit 2 offers a robust way to measure how well a particular\nmodel reproduces the morphology and kinematics of a pair of interacting\ngalaxies. A set of eight self-consistent simulations is used to demonstrate the\nalgorithm's ability to search a ten-dimensional parameter space and find\nnear-optimal matches; all eight systems are successfully reconstructed."}, "authors": ["Joshua E. Barnes"], "author_detail": {"name": "Joshua E. Barnes"}, "author": "Joshua E. Barnes", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1111/j.1365-2966.2011.18358.x", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1101.5671v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1101.5671v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "14 pages, 8 figures. Accepted for publication in MNRAS. To get a copy\n  with high-resolution figures, use the web interface, or download the\n  Identikit software, visit\n  http://www.ifa.hawaii.edu/faculty/barnes/research/identikit/", "arxiv_primary_category": {"term": "astro-ph.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1101.5671v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1101.5671v1", "journal_reference": null, "doi": "10.1111/j.1365-2966.2011.18358.x", "fulltext": "Mon. Not. R. Astron. Soc. 000, 000\u2013000 (0000)\n\nPrinted 26 July 2018\n\n(MN LATEX style file v2.2)\n\nIdentikit 2: An Algorithm for Reconstructing Galactic\nCollisions\nJoshua E. Barnes\n\narXiv:1101.5671v1 [astro-ph.CO] 29 Jan 2011\n\nInstitute of Astronomy, University of Hawaii, 2680 Woodlawn Drive, Honolulu, HI 96822, USA\n\n26 July 2018\n\nABSTRACT\n\nUsing a combination of self-consistent and test-particle techniques, Identikit 1 provided\na way to vary the initial geometry of a galactic collision and instantly visualize the\noutcome. Identikit 2 uses the same techniques to define a mapping from the current\nmorphology and kinematics of a tidal encounter back to the initial conditions. By\nrequiring that various regions along a tidal feature all originate from a single disc with\na unique orientation, this mapping can be used to derive the initial collision geometry.\nIn addition, Identikit 2 offers a robust way to measure how well a particular model\nreproduces the morphology and kinematics of a pair of interacting galaxies. A set\nof eight self-consistent simulations is used to demonstrate the algorithm's ability to\nsearch a ten-dimensional parameter space and find near-optimal matches; all eight\nsystems are successfully reconstructed.\nKey words: galaxies: interactions \u2013 galaxies: kinematics and dynamics \u2013 methods:\nN-body simulations \u2013 methods: numerical\n\n1\n\nINTRODUCTION\n\nDynamical modeling of specific pairs of interacting galaxies is a subject with considerable history. Toomre & Toomre (1972,\nhereafter TT72) bolstered their interpretation of bridges and tails as tidal features by presenting test-particle models of\nArp 295, M 51, NGC 4676, and NGC 4038/9; the power of such models was demonstrated when Stockton (1974) confirmed\nTT72's prediction for the relative velocities of the two galaxies making up NGC 4676. As observational and numerical\ntechniques have improved, modeling of interacting systems has generated an extensive literature (see Barnes & Hibbard 2009,\nhereafter BH09, for a partial list). The motivation for dynamical modeling has evolved over time. While early studies focused on\ntesting the tidal theory of galactic encounters, more recent work has used dynamical modeling to help interpret observations,\nprobe the structure and dynamics of unseen matter, and reconstruct the dynamical histories of merging galaxies.\nDespite the advances of the past few decades, it remains a challenge to create models matching the detailed morphology\nand kinematics of a pair of colliding galaxies. One fundamental complication is the inherent uncertainty in inferring the\ndistribution and dynamics of dark matter strictly by its effects on luminous material. Another is the violent reprocessing of\ninterstellar material \u2013 including rapid star formation \u2013 in galaxy collisions. However, there are three rather technical issues\nwhich also limit progress:\n(1) A galactic collision is described by a large number of parameters which interact in highly non-linear ways.\n(2) Simulating galactic collisions is computationally intensive.\n(3) The criteria for a successful match are not easily translated into quantitative terms.\nThe parameters necessary to simulate an encounter of two disc galaxies fall into three groups, as illustrated in Fig. 1. The\nfirst group specifies the initial orbits of the galaxies; assuming these orbits are asymptotically Keplerian at early times, the\nrequired parameters are the periapsis separation p, the orbital eccentricity e, and the mass ratio \u03bc. The second group describes\nthe spin vector of disc d (where d = 1, 2) with respect to the angular momentum of the relative orbit and the separation\nvector between the galaxies at periapsis; this vector is parametrized by the inclination id and argument to periapsis \u03c9d of\neach disc. Together with any parameters needed to describe the internal structures of the two galaxies, the first and second\ngroups specify the initial conditions for a galactic encounter. The third group consists of the time t since first periapsis, and\nparameters which map the simulation onto the observational plane: three Euler angles \u03b8\u03b1 specifying the viewing direction,\nc 0000 RAS\n\n\f2\n\nJ. E. Barnes\n\nFigure 1. An abstract representation of the sixteen-dimensional parameter space of galaxy interactions. The radial coordinate represents\nthe initial orbit, the azimuthal coordinate represents the disc orientations, and the vertical coordinate represents the parameters chosen\nafter a simulation is run. A conventional N-body simulation explores the parameter subspace represented by the dotted line, while a\nsingle Identikit simulation explores the entire cylindrical surface.\n\nscaling factors L and V which transform dimensionless simulation positions and velocities, respectively, into real physical\nquantities, and the centre-of-mass position on the plane of the sky Rc and radial velocity Vc . These parameters may be chosen\nafter a simulation has been run.\nOf these sixteen parameters, only a few have a priori constraints. TT72 argued that the orbital eccentricity should\nbe e \u2243 1; this is generally supported by cosmological simulations (Khochfar & Burkert 2006), although the e distribution\nextracted from these simulations includes a tail to e < 1. The mass ratio \u03bc may be estimated from the relative luminosities of\nthe two galaxies \u2013 provided that the galaxies are still distinct and that interaction-induced star formation has not significantly\naltered their luminosities. Finally, the scale factors L and V are are not completely arbitrary since the pre-encounter galaxies\nshould have radii and circular velocities comparable to those of other disc galaxies.\n1.1\n\nIdentikit 1\n\nIdentikit simulations combine test-particle and self-consistent techniques (BH09). Each galaxy is modeled by an initially\nspherical configuration of massive particles with cumulative mass profile m(r), in which is embedded a spherical swarm\nof massless test particles on initially circular orbits with angular momenta uniformly distributed over all directions. Two\nsuch models are launched towards each other with orbital parameters (p, \u03bc, e). During the ensuing encounter, the massive\ncomponents interact self-consistently, approximating the time-dependent potential and orbit decay of a fully self-consistent\ngalactic collision. The test particles mimic the tidal response of embedded discs with all possible spin vectors; once such a\nsimulation has been run, selecting the appropriate subset of test particles yields a good approximation to the tidal response\nof any particular disc.\nIn the simplest Identikit implementation, the test particles initially populating each galaxy model have the same radial\ndistribution as the discs they are intended to mimic. Each test particle i is associated with a normalized vector si \u2208 S2 which\nrecords the direction of the particle's initial angular momentum with respect to the centre of its parent galaxy. An Identikit\nsimulation yields a Monte Carlo representation of an 'extended' distribution function,\n. X 3\ngd (r, v, s; t) =\n\u03b4 (r \u2212 ri (t)) \u03b4 3 (v \u2212 vi (t)) \u03b4 2 (s \u2212 si ) .\n(1)\ni\nThis function gives the phase-space number density at time t of test particles from disc d with position r, velocity v which\n.\ninitially had angular momentum direction s. Here and throughout, '=' is used throughout to indicate an explicit Monte Carlo\nexpression. On the right-hand side, ri (t) and vi (t) are the position and velocity of test particle i at time t; these are understood\nto also depend on the orbital parameters (p, \u03bc, e). Once this extended function has been constructed, the distribution function\nfd for a disc with a specific initial spin s0 is estimated by\nfd (r, v; t) \u221d\n\nZ\n\n. X\nd2 s gd (r, v, s; t) =\n\u03b4 3 (r \u2212 ri (t)) \u03b4 3 (v \u2212 vi (t)) ,\nsi \u2208 s\u03030\ns\u03030\n\n(2)\n\nwhere s\u03030 = {s \u2208 S2 | s * s0 \u2265 1 \u2212 \u03c3} and \u03c3 \u226a 1 is a tolerance parameter which determines the solid angle contributing to the\nestimate of fd .\nThe reason why fd is estimated by integrating over a finite solid angle s\u03030 is not obvious; it may seem enough to simply\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fReconstructing Galactic Collisions\n\n3\n\nevaluate gd (r, v, s0 ; t). However, gd and fd are both represented in a Monte Carlo fashion. To sample fd well enough for a\nvisual comparison with observational data requires a few thousand particles; if gd is represented by Ntest \u223c 105 to 106 test\nparticles per galaxy, this requires \u03c3 \u2243 10\u22122 .\nThis simple version of Identikit has some drawbacks. Only a small percentage of the test particles are initially placed\nat large radii where they are responsive to tidal forces; this wastes computer time. Moreover, simulated discs defined by\nsi * s0 \u2265 1 \u2212 \u03c3 have scale heights which increase linearly with radius and look unrealistic when viewed edge-on. Both of\nthese flaws can be addressed by radially biasing the distribution of test particles. Following BH09, the test particle density\nis multiplied by a factor of r 2 , and each test particle i is given a weight \u03bei = max(riinit /rmin , 1)\u22122 , where riinit is the initial\norbital radius of particle i, and rmin is a small cut-off radius. The extended distribution function is then\n. X 3\ngd (r, v, s, \u03be; t) =\n\u03b4 (r \u2212 ri (t)) \u03b4 3 (v \u2212 vi (t)) \u03b4 2 (s \u2212 si )\u03b4(\u03be \u2212 \u03bei ) ,\ni\n\n(3)\n\nand the expression for fd becomes\nfd (r, v; t) \u221d\n\nZ\n\nd\u03be\n\nZ\n\ns\u03030 (\u03be)\n\n. X\nd2 s gd (r, v, s, \u03be; t) =\n\nsi \u2208 s\u03030 (\u03bei )\n\n\u03b4 3 (r \u2212 ri (t)) \u03b4 3 (v \u2212 vi (t)) ,\n\n(4)\n\nwhere s\u03030 (\u03be) = {s \u2208 S2 | s * s0 \u2265 1 \u2212 \u03c3\u03be}.\n\n2\n\nDERIVING DISC SPINS\n\nIdentikit 1 uses the extended distribution function gd in a 'forward' mode which allows a rapid exploration of the outcome\nfor any choice of initial disc spin. However, the same function can also be used in an 'inverse' mode, in which the fact that a\ntidal feature populates certain regions of phase space can be used to solve for the initial spin vector of the disc it came from.\nLet q = (r, v) \u2208 R6 be a point in phase space, and q\u0303 \u2282 R6 be a region of phase space which is populated by tidal material\nfrom disc d. Define a density on the sphere of spin directions S2 :\n\u03a9d (s; q\u0303, t) =\n\nZ\n\nd\u03be\n\nZ\n\nq \u2208 q\u0303\n\n. X\nd3 r d3 v \u03begd (r, v, s, \u03be; t) =\n\nqi (t) \u2208 q\u0303\n\n\u03bei \u03b4 2 (s \u2212 si ) ,\n\n(5)\n\nwhere qi (t) = (ri (t), vi (t)). This function describes the inverse image of the material populating the phase space region q\u0303 at\ntime t mapped back onto the sphere of initial spin directions. As will be seen shortly, the inverse image of a region q\u0303 may\nspan a wide range of initial disc spins s, and the function \u03a9d can have a rather complicated behavior. Nonetheless, \u03a9d usually\nhas compact support, meaning that only a subset of all possible disc spins can produce tidal features populating q\u0303.\nNow consider a set of nreg phase-space regions q\u0303j (where j = 1, . . . , nreg ) which sample a given tidal structure. For\nexample, imagine that disc d has produced a tidal tail, and that the regions are distributed along this tail. Each of these\nregions q\u0303j can be populated by some range of initial spins, defined by the set of s for which \u03a9d (s; q\u0303j , t) > 0. However, the\ntail as a whole is presumably populated by one disc with a unique spin s0 , and this spin must lie within the intersection of\nthe images of the individual regions q\u0303j .\nTo find this intersection numerically, it's convenient to work with a smoothed and normalized version of \u03a9d . Define\n\u03a9d (s; q\u0303, t) = K(q\u0303)\n\nZ\n\nX\n.\nd2 s\u2032 w(s \u2212 s\u2032 ) \u03a9d (s\u2032 ; q\u0303, t) = K(q\u0303)\n\u03bei w(s \u2212 si ) ,\nqi (t) \u2208 q\u0303\n\n(6)\n\nwhere w(\u2206s) is a smoothing function with compact support, and the factor K(q\u0303) normalizes the maximum value of \u03a9d (s; q\u0303)\nto unity. Smoothing replaces the pointillistic Monte Carlo representation of \u03a9d with a continuous version in which the value\nof \u03a9d (s) reflects the density of points near s; accordingly, the radius of the smoothing function should be somewhat larger\nthan the mean separation on S2 between the points. The advantages of normalization will be illustrated later.\nGiven smoothed functions for a set of regions q\u0303j tracing the tidal features of a single disc, define the product function\n\u03a9\u2217d (s; t) =\n\nYnreg\n\nj=1\n\n\u03a9d (s; q\u0303j , t) .\n\n(7)\n\nThis function may vanish everywhere on S2 , it may have a complicated structure, perhaps with multiple peaks, or it may\nhave a simple structure with just one peak. If it vanishes everywhere, then no single disc spin can populate all of the target\nregions q\u0303i ; this may indicate that model parameters such as the time t since periapsis are incorrect. If it has a complicated\nstructure, then there are many initial configurations which can populate all of the target regions. But if \u03a9\u2217d has a single peak\nat s0 and vanishes everywhere else except for a small surrounding neighborhood, then the true spin of the disc must be close\nto s0 \u2013 provided that t and other model parameters are accurately known.\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f4\n\nJ. E. Barnes\n\n2.1\n\nObservational constraints\n\nObservations of distant galaxies can constrain only some components of phase-space. Let the observations of a pair of interacting galaxies be described using coordinates R = (X, Y, Z), with the Z axis coinciding with our line of sight to the system,\nso that (X, Y ) is parallel to the plane of the sky. For simplicity, assume that the origin of these coordinates lies near the\nsystem's centre of mass. Given a distance to the system, the (X, Y ) coordinates may be expressed in physical units. Likewise,\ndescribe velocities using coordinates V = (U, W, V ) = (\u1e8a, \u1e8e , \u017b), where the origin lies near the systemic velocity. As a rule,\nwe can measure the first two components of (X, Y, Z) and the third component of (U, W, V ), while the other components are\neffectively unconstrained.\nConsequently, if tidal material is detected with a specific position and line-of-sight velocity, we can only say that the\nphase-space region it occupies has finite extent in some directions and infinite extent in others. For example, consider a\nphase-space region\nQ\u0303 = {(X, Y, Z; U, W, V ) \u2208 R6 | X \u2208 XQ \u00b1 RQ , Y \u2208 YQ \u00b1 RQ , V \u2208 VQ \u00b1 SQ } .\n\n(8)\n\nHere (XQ , YQ ) specifies a point on the plane of the sky, RQ is a radius, VQ specifies a line-of-sight velocity, and SQ is a velocity\nrange. Such a region Q\u0303 might, for example, correspond to a voxel in a HI data-cube.\nSimulation coordinates r and v may be projected onto the observational plane via\nR = LMr + Rc ,\n\nV = VMv + Vc .\n\n(9)\n\nHere the rotation matrix M = M(\u03b8\u03b1 ), which depends on the Euler angles, rotates simulation coordinates to observation\ncoordinates. Assuming the simulation coordinates are dimensionless, the scale factors L and V will have units of length and\nvelocity, respectively. Finally, Rc = (Xc , Yc , 0) and Vc = (0, 0, Vc ) specify offsets in the plane of the sky and the line-of-sight\nvelocity, respectively. These offsets vanish if the origins of R and V coincide exactly with the system's centre of mass position\nand velocity, but this is hard to insure in practice.\nIt is convenient to define an operator P : q 7\u2192 Q which implements the mapping from simulation to observation:\nP : (r, v) 7\u2192 (LMr + Rc , VMv + Vc ) .\n\n(10)\n\nThe observational version of (5) is then\n. X\n\u03a9d (s; Q\u0303, t, \u03b8\u03b1 , L, V, Rc , Vc ) =\n\nPqi (t) \u2208 Q\u0303\n\n\u03bei \u03b4 2 (s \u2212 si ) ,\n\n(11)\n\nwhere P depends on the parameters \u03b8\u03b1 , L, V, Rc , and Vc ; these parameters are involved because the region Q\u0303 is specified\nobservationally. Observational versions of \u03a9d and \u03a9\u2217d can be defined analogously and likewise depend on these parameters.\n2.2\n\nProof of concept tests\n\nSince observations can constrain only three out of six phase-space dimensions, it's not clear if the algorithm described above\ncan yield well-determined disc spins. One way to find out is to apply the algorithm to data generated using simulated galaxy\nencounters; if the algorithm reconstructs initial disc spins from simulated observational data then it passes the test. To make\nthe test as clean as possible, the simulated encounters are run using test-particle discs embedded in a spherical self-consistent\nmodels, and the same mass model is used in the Identikit simulation to compute gd (r, v, s, \u03be; t). This side-steps, for now,\ntwo potential complications: (1) the difference between test-particle and self-consistent tidal responses, and (2) any mismatch\nbetween the mass model used for the simulated data and the one used for the Identikit computation.\nThis test uses the same composite mass model adopted in BH09, with a bulge/disc/halo mass ratio of 1:3:16. The bulge\nhas a Hernquist (1990) profile, the disc has an exponential surface-density profile, and the halo has a Navarro, Frenk, & White\n(1996) profile and is tapered smoothly at \u223c 12 disc scale lengths. As in BH09, the calculations are carried out in units with\nG = 1; in these units the rotation period at 3 disc scale lengths is trot \u2243 1.23. Two discs with spins (i1 , \u03c91 ) = (30, 0) and\n(i2 , \u03c92 ) = (135, 0) are placed on approaching parabolic orbits, reaching periapsis at time t = 0. By time t = 1, disc 1 has\nproduced a well-developed tidal tail. For simplicity, the observation operator P is replaced with the identity operator, so that\nq = Q. The simulated orbit lies in the (X, Y ) plane, while the system is viewed along the orbital axis Z.\nAs the left side of Fig. 2 shows, three phase-space regions Q\u0303j are defined along the tidal tail of disc 1. These regions\ntrace the run of tail velocity V as well as tail position (X, Y ), but \u2013 as (8) implies \u2013 have infinite extent in Z and in (U, W ).\nThe right side of Fig. 2 shows contours of the three functions \u03a91 (s; Q\u0303j , t), evaluated at time t = 1. All three regions Q\u0303j map\nto roughly linear features on the spin sphere; each region can be populated by a range of disc spins. However, the three sets\nof contours overlap in one place on the spin sphere, and the product function \u03a9\u22171 (s, t) has a single peak very near the true\ndisc spin (i1 , \u03c91 ) = (30, 0). The white contour shows where \u03a9\u22171 (s, t) equals 95% of its peak value. This contour, which neatly\nencloses the true (i1 , \u03c91 ), illustrates the uncertainty in the derived spin.\nA simple variation of this experiment is shown in Fig. 3, where the argument to periapsis of disc 1 has been changed to\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fReconstructing Galactic Collisions\n\n5\n\nFigure 2. A proof-of-concept test of the Identikit 2 algorithm. On the left are (X, Y ) and (X, V ) projections of an encounter between\ntwo disc galaxies with spins (i1 , \u03c91 ) = (30, 0) and (i2 , \u03c92 ) = (135, 0); the system is viewed along the orbital axis. The small colored\nboxes show three phase-space regions Q\u0303j distributed along the tidal tail produced by galaxy 1. On the right is an equal-area projection\nof one hemisphere of the spin sphere; lines of constant inclination i and argument \u03c9 are labeled. The contour plots show the functions\n\u03a91 (s; Q\u0303j , t); their colors correspond to the regions defined on the left. The grey-scale image shows the product function \u03a9\u22171 (s; t); the\nsingle white contour is set at 95% of the peak value, and neatly encloses the actual disc spin (i1 , \u03c91 ) = (30, 0).\n\n\u03c91 = 90. This has little effect on the resulting tail's morphology, but yields a different run of line-of-sight velocities as shown\non the bottom left of the figure. The three regions defined here have the same (X, Y ) coordinates as in the previous case; only\ntheir V coordinates have been modified. In response, the peak of the product function \u03a9\u22171 (s, t) shifts to very near the actual\nspin (i1 , \u03c91 ) = (30, 90). Again, the white contour at 95% of the peak shows how well the spin is constrained.\nThese simple tests demonstrate several key points. First, a single phase-space region Q\u0303 defined following (8) doesn't\nprovide enough information to uniquely determine initial disc spin; the various \u03a91 (s; Q\u0303j , t) functions contoured in Figs. 2\nand 3 each admit a range of possible solutions. Second, two or more regions Q\u0303j tracing a given tidal structure can, at least in\ntheory, accurately determine initial disc spin. For best results the regions used should sample different parts of the tidal feature\noriginating from a given disc, so the resulting \u03a9d (s; Q\u0303j , t) functions are not closely aligned with one another. Third, line-ofsight velocity information is necessary; morphological constraints alone can't distinguish between the two cases presented in\nthis section.\n\n3\n\nSEARCHING PARAMETER SPACE\n\nThe algorithm described above yields disc spins assuming that all other model parameters are already known. This capability\nmay be useful in examining variations on a known solution, but a more comprehensive methodology is required to model\nreal systems from scratch. Some technique for searching parameter space or solving for the other parameters is needed; this\nsection develops a possible approach.\n3.1\n\nMeasuring quality of fit\n\nA numerical measure of the quality of a solution is needed to implement an automated search of parameter space. The function\n\u03a9\u2217d (s; t, . . .), where (t, . . .) represents all orbit and viewing parameters, may be useful in this role. If \u03a9\u2217d vanishes for all disc\nspins s, then either:\n(1) The regions Q\u0303j do not all originate from a single disc with a unique spin vector.\n(2) The adopted orbit parameters (p, \u03bc, e) or viewing parameters (t, \u03b8\u03b1 , L, V, Rc , Vc ) are too inaccurate to yield a solution.\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f6\n\nJ. E. Barnes\n\nFigure 3. Another test of the algorithm. Here, disc 1 has spin (i1 , \u03c91 ) = (30, 90). The three colored boxes have the same locations on\nthe (X, Y ) plane as in Fig. 2, but have been shifted in V to track the run of velocities along the tail. As a result, the function \u03a9\u22171 now\npeaks very close to (i, \u03c9) = (30, 90). This illustrates the key role velocity information plays in constraining encounter geometry.\n\nThe first interpretation may be correct if the disc was initially warped or if some of the regions are attributed to the wrong\ngalaxy. In most cases, however, the second interpretation may be taken as a working hypothesis.\nExtending this line of thought, it seems plausible to prefer model solutions which yield higher peak values of \u03a9\u2217d . Let\n\u039bd (t, . . .) = max s \u03a9\u2217d (s; t, . . .) ,\n\n(12)\n\nbe the maximum value of \u03a9\u2217d obtained for any s \u2208 S2 . The peak value basically measures the degree to which the functions\n\u03a9d for different regions overlap with one another; a solution in which the ridge-lines of these functions intersect is probably\nbetter than one in which their outskirts barely touch.\nJust two regions, suitably chosen, suffice to constrain a disc's spin if all other parameters are known. However, for nreg = 2\nregions the peak function \u039bd (t, . . .) will be fairly insensitive to the viewing and orbit parameters. An inaccurate choice for\nthese parameters will probably shift the locus of the overlap between the images of Q\u03031 and Q\u03032 , but won't appreciably reduce\n\u039bd unless the error is quite large. To make \u039bd a useful metric, at least nreg = 3 regions should be used to trace each disc's\ntidal features, and it seems likely that more regions will yield stronger constraints on the collision parameters.\nFinally, a plausible model of a galactic collision must be able to account for the tidal features of both galaxies using the\nsame set of orbit and viewing parameters. Suppose functions \u03a9\u22171 (s; t, . . .) and \u03a9\u22172 (s; t, . . .) have been defined using two different\nsets of regions, each tracing the tidal features of one of the galaxies. By analogy with (7), let\n\u039b(t, . . .) = \u039b1 (t, . . .) \u039b2 (t, . . .) ;\n\n(13)\n\nthis product, which depends on all orbit and viewing parameters, provides an estimate of the overall quality of a solution.\n\n3.2\n\nCentre 'locking'\n\nIn many cases, a subset of the viewing parameters may be determined straightforwardly. Even violently disturbed galaxies\noften have well-defined nuclei which can be accurately located, and a plausible simulation of an interacting pair should\nreproduce the positions of these nuclei. As BH09 noted, when modeling a system in which two galaxies appear well-separated\non the plane of the sky, it's helpful to 'lock' the centres of the models. Locking derives the rotation about the viewing axis\n\u03b8Z , length scale L, and offset Rc by requiring the centres of the models to coincide with the nuclei of the real galaxies. These\nfour viewing parameters, in effect, become functions of the viewing direction (\u03b8X , \u03b8Y ), time since periapsis t, and orbital\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fReconstructing Galactic Collisions\n\n7\n\nparameters (p, \u03bc, e). Locking is completely independent of disc orientation, so it can be applied before attempting to solve for\ndisc spins.\n\n3.3\n\nScanning over viewing direction\n\nIf the pair of galaxies to be modeled exhibit distinct and well-separated nuclei, it's straightforward to perform a systematic\nsearch of all viewing directions. Suppose for the moment that trial values have been chosen for the orbit parameters (p, \u03bc, e),\ntime since periapsis t, and velocity scale V and offset Vc . The basic idea is to iterate over a lattice of possible viewing\ndirections parametrized by the Euler angles (\u03b8X , \u03b8Y ). For each viewing direction, centre locking determines the remaining\nviewing parameters, and a trial solution for disc spins is obtained using the algorithm in \u00a7 2; the best viewing direction is the\none which yields the largest value of \u039b. In effect, this prescription surveys a ten-parameter subset of the full parameter space\n(Fig. 1) at the cost of a blind search of only two parameters.\nIn the present implementation, the lattice of viewing directions is generated by starting with an icosahedron inscribed\nwithin a unit sphere, and replacing every one of its 20 triangular faces with four equilateral triangles, each with one quarter\nof the original triangle's area. The new vertexes introduced are projected out to unit radius, producing a solid with nface = 80\ntriangular faces approximating a sphere. This process can be iterated, producing a sequence of ever-better approximations\nwith nface = 320, 1280, 5120, . . . faces.\nThe midpoints of these faces, which cover the sphere in a nearly uniform fashion, define a lattice of viewing directions.\nEach face, indexed by k (where k = 1, . . . , nface ), is associated with a viewing direction (\u03b8X,k , \u03b8Y,k ). Locking determines\ncorresponding values for the angle \u03b8Z,k , scale Lk , and offset Rc,k = (Xc,k , Yc,k , 0). Solving for disc spins yields the peak values\n\u039bd,k (t, V, Vc , p, \u03bc, e) = \u039bd (t, \u03b8\u03b1,k , Lk , V, Rc,k , Vc , p, \u03bc, e) .\n\n(14)\n\nIn addition to finding the viewing direction k which maximizes the product \u039bk = \u039b1,k \u039b2,k , the algorithm tabulates values of\n\u039bd,k for all faces.\n\n4\n\nTESTING PARAMETER SEARCH\n\nThe approach just outlined only works if the product \u039b(t, . . .) can reliably identify good solutions. To establish this, the next\ntest treats the viewing angles \u03b8\u03b1 , length scale L and position offset Rc as unknowns, in addition to the disc spins (id , \u03c9d ).\nConversely, the orbit parameters (p, \u03bc, e), time since periapsis t, and velocity scale V and offset Vc have known values. While\nthis test therefore doesn't search the full parameter space, it does survey a non-trivial subset; in particular, this test aims to\ndetermine if Identikit 2 can reconstruct the encounter and viewing geometry for well-separated pairs of interacting galaxies.\nFig. 4 presents a sample of equal-mass (\u03bc = 1) initially-parabolic (e = 1) galaxy encounters with random disc spins and\nviewing angles. Out of the 36 self-consistent encounters BH09 used to test Identikit 1, these are the eight with the largest\nperiapsis separations; they include an equal mix of direct and retrograde discs. All eight are 'observed' at ttrue = 1, one model\ntime unit after first periapsis. At this time, these pairs all have well-separated centres, insuring that centre locking will work\neffectively.\nFollowing BH09, the Identikit calculations use a spherically-averaged version of the same mass model employed in the\nself-consistent simulations. Since the range of actual periapsis separations ptrue represented in this sample is fairly small, all\neight were matched using a single Identikit simulation with p comparable to the mean separation. This simulation was evolved\nto t = 1, exactly matching the actual time.\nFive regions, shown in Fig. 4, were used to trace the the tidal features of each disc. For the most part, these regions\nsimply follow the morphology and kinematics of the tidal structures seen in (X, Y ), (X, V ), and (V, Y ) projections of the\nself-consistent simulations. In some cases, however, these projections don't fully delineate the information contained in a\n(X, Y, V ) data-cube. An interactive routine was therefore used to evaluate the amount of tidal material in each region as\nits parameters were adjusted; this insured that the regions actually contain significant amounts of material even when the\nprojected views were ambiguous. Of course, the same approach could be used when working with observational data.\nOnce these regions were defined, a preliminary model for each system was found by scanning over a lattice of nface = 320\nto 1280 viewing directions. In two cases (encounters 2 and 5), the algorithm failed these preliminary tests. The nature of these\nfailures will be discussed shortly, but fairly minor adjustments to the regions sampling just one of the two discs were enough\nto resolve both cases. With these adjustments made, final models for all eight systems were obtained by scanning nface = 5120\nviewing directions. Each of these final models took about one hour of computing time on a 3 Ghz Intel processor; this time\ncould be substantially reduced by optimizing and parallelizing the code. Fig. 5 shows these eight models (points), overplotted\non the self-consistent simulations (grey-scale images). The algorithm successfully reproduced the morphologies and kinematics\nof all eight systems; by the standards of BH09, these are all 'good' matches.\nThe algorithm selects viewing direction by maximizing the product \u039b1,k \u039b2,k , but how do the constraints provided by\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f8\n\nJ. E. Barnes\n\nFigure 4. (X, Y ) and (X, V ) projections of eight self-consistent galaxy encounters used to test the Identikit 2 algorithm, represented\nby grey-scale images. The nuclear position and velocity of each galaxy are shown by red and green dots for galaxy 1 and galaxy 2,\nrespectively. Five regions, color-coded according to the same convention, are used to trace the tidal features of each galaxy disc.\n\nthe two discs work together? Fig. 6 shows how \u039bd varies as a function of viewing direction. Each panel shows a perspective\nview of the viewing direction lattice, with the viewing direction selected by the algorithm situated dead centre. The color of\neach triangular face shows \u039b1,k and \u039b2,k , using red for disc 1 and green for disc 2. The eight models yield a wide range of\n'landscapes' on this spherical lattice. Somewhat predictably, models 6 and 8, in which both discs display only subtle tidal\ndisturbances, yield diffuse \u039bd functions with multiple local maxima. More pronounced tidal disturbances, such as the classic\n'bridge and tail' structures seen in both discs of models 1 and 4, and in one disc each in models 2, 3, 5, and 7, generally\nyield more localized \u039bd functions; while multiple maxima may still appear, they are closer together. In models 2, 3 and 5, the\nindividual \u039bd functions appear nearly disjoint, only overlapping for a small range of viewing directions. Model 4, in contrast,\nproduces \u039bd functions which are roughly aligned with each other, although one function is considerably more diffuse than the\nother. Clearly, the intrinsic tidal response, viewing direction, and strategy used to pick regions are all factors in determining\nthe landscape of the resulting \u039bd functions; further experimentation with a larger set of encounters may help to tease these\nfactors apart.\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fReconstructing Galactic Collisions\n\n9\n\nFigure 5. (X, Y ) and (X, V ) projections of Identikit 2 models for the eight galaxy encounters. Red and green points show solutions for\ndisc 1 and disc 2, respectively, over-plotted on grey-scale images of the self-consistent simulations.\n\nIn practice, the method used to select viewing direction works quite well for this set of galaxy encounters. Fig. 7 shows the\ncumulative distribution of angular errors in viewing direction \u2206view . Numbered points represent the eight Identikit 2 models\nfrom Fig. 5, while the light grey dots show the set of 36 Identikit 1 models from BH09. The median error in viewing direction\nfor the Identikit 2 models is \u2206view \u2243 5.6\u25e6 , which is less than half the median error for the Identikit 1 models. Moreover, all of\nthe new models are good fits; the tail of poor solutions represented by the grey dots extending to the upper right is absent.\nOf course, this comparison is not entirely fair; BH09 also fit for the time t, periapsis separation p, and velocity scale V, while\nhere these parameter values are pre-determined. It's nonetheless remarkable that models 6 and 8, which would probably be\nquite tricky to model by hand, are among the most accurate of the eight models plotted. Inspection of Fig. 6 suggests that the\nbest solutions arise when the peaks of the two \u039bd functions fall fairly near each other, while somewhat less accurate results\nare obtained when the selected viewing direction is a compromise between separate peaks, as in models 2, 3 and 5.\nFig. 8 plots the cumulative distribution of angular errors in disc spin direction \u2206spin . Here the numbered points represent\nthe sixteen discs from Fig. 5, color coded as in that figure. Given that the viewing directions for the eight Identikit 2 models\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f10\n\nJ. E. Barnes\n\nFigure 6. Perspective views of the viewing direction lattice with color representations of \u039bd , using red for disc 1 and green for disc 2.\n\nare all determined with an error of \u223c 10\u25e6 or less, it's not too surprising that the spins of the individual discs are also well\ndetermined. The median error for this sample is \u2206spin \u2243 8.0\u25e6 , again less than half of the analogous error for the BH09 sample\n(grey dots). In conjunction with Fig. 5, this plot reveals some interesting systematics. As a group, the discs with accurate\nspin directions tend to be face-on, while those with large errors tend to be edge-on. This is neatly illustrated by model 2,\nwhere galaxy 1 (red) is fairly face-on and has a spin error \u2206spin = 2.3\u25e6 , while galaxy 2 (green) is nearly edge-on and has\n\u2206spin = 17.7\u25e6 . The same pattern is also seen in model 8 (2.3\u25e6 vs. 10.8\u25e6 ) and to a smaller degree in model 6 (4.8\u25e6 vs. 7.9\u25e6 ).\nThis trend may arise because face-on discs present truly two-dimensional velocity fields, while edge-on discs collapse the two\nspatial dimensions into one; in effect, the former provide more information. On the other hand, the error in spin direction \u2206spin\ndoes not appear to correlate with disc inclination i. The four discs at the bottom of Fig. 8, which have the most accurately\ndetermined spins, are an equal mix of direct (i < 90\u25e6 ) and retrograde (i > 90\u25e6 ) passages; the four at the top include three\nretrograde passages, but the three discs just below this group are all direct. This is somewhat unexpected since direct passages\nproduce pronounced tidal bridges and tails, which would seem to offer better constraints on model solutions; it is, however,\nconsistent with the very accurate results already noted for the purely retrograde encounters 6 and 8.\nThe colored lines in Figs. 7 and 8 show results for different versions of the disc spin algorithm (\u00a7 2). The red curves in\nthese figures were obtained by calculating \u03a9d (5) with all particles weighted equally (in effect, setting \u03bei = 1). The blue curves\nresult from computing \u03a9d (6) without normalizing the peak value to unity (setting K(q\u0303) = 1). Finally, the green curves\ncombine both options (setting \u03bei = K(q\u0303) = 1). For the most part, these different variants produce similar results. Equal\nweighting, which effectively overrepresents the outer regions of the initial discs, may yield a modest increase in spin direction\naccuracy. Conversely, doing without normalization produces less accurate models, although in most cases the differences are\nslight \u2013 the exceptions will be discussed next.\n\n4.1\n\nFailed models\n\nFig. 7 shows that two of the models constructed without normalizing \u03a9d (blue curve) are clearly very poor solutions. These\nmodels have errors in viewing direction of \u2206view = 63\u25e6 and 79\u25e6 , which induce comparable errors in spin direction, as shown\nin Fig. 8. A similar failure, with \u2206view = 72\u25e6 , was seen in a preliminary model for encounter 5. In all of these cases, the\nalgorithm selected a viewing direction roughly parallel to the line between the two galaxies, so that the centres of the models\nappear close in projection. Because the model centres are forced to coincide with the nuclei of the self-consistent galaxies,\nthese viewing directions yield very large values for the scale factor L. As a result, the transformation from simulation to\nobservation coordinates (9) splatters particles into all of the regions Q\u0303j used to constrain model solutions. Since both model\ngalaxies are scaled by the same L, both \u039bd functions have local peaks for the same viewing direction, and their product \u039b\nrises higher than the peak representing the true viewing direction.\nThis mode of failure is more likely when \u03a9d is not normalized because the particles splattered into the Q\u0303j regions often\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fReconstructing Galactic Collisions\n\n11\n\nFigure 7. Cumulative distribution functions for the error in viewing direction \u2206view . The numbered points show results for the eight\nfinal models. Colored lines show variants of the algorithm: red shows results for equal particle weights (\u03bei = 1), blue for unnormalized\npeaks (K(q\u0303) = 1), and green for both together (\u03bei = K(q\u0303) = 1). The light grey dots show results from BH09.\n\nFigure 8. Cumulative distribution functions for the error in spin direction \u2206spin . The numbered points show results for the eight final\nmodels, with red for disc 1 and green for disc 2. Colored lines show results for variants of the algorithm as in Fig. 7. The light grey dots\nshow results from BH09; one dot, off-scale to the left, is not plotted\n\ncome from the inner parts of the galaxies and therefore have relatively large weights \u03bei . These high-weight particles help to\npush the false peak of \u039b above the one corresponding to the true solution. If, in addition to not normalizing \u03a9d , all particles\nare given equal weight (green curve in Fig. 7), then viewing directions which scatter particles from small radii far and wide\nare less favored and failure becomes less likely. However, using equal weights when the test-particle distribution is actually\nbiased by a factor of r 2 seems rather arbitrary.\nIn practice, failed solutions such as these are easy to recognize visually, and it would also be straightforward to detect\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f12\n\nJ. E. Barnes\n\nthem automatically. One way to do so is to place astrophysically motivated limits on L; for example, a solution which requires\ndiscs an order of magnitude larger than the discs of real galaxies could presumably be rejected out of hand. Another way is\nto detect and reject solutions which splatter particles far beyond the actual extent of the tidal features.\nFor completeness, the other failure of the algorithm, which occurred in the first attempt to model encounter 2, should\nalso be mentioned. In this encounter, disc 2 is nearly edge-on, and presents a wide range of line-of-sight velocities. The two\nsmall regions on either side of the centre of this disc in Fig. 4 were initially set to opposite extremes of this velocity range.\nBut as BH09 showed, Identikit models with test particles on circular orbits generally don't reproduce the full velocity width\nof self-consistent discs. Consequently, \u039b2,k vanished for almost all viewing directions, and did not overlap at all with \u039b1,k .\nReducing the range of velocities sampled by these two regions produced the satisfactory solution shown in Fig. 5.\nFinally, it's worth noting that these failures are only partial. In every case, an acceptable solution could be recovered by\nignoring one of the two \u039bd functions and selecting a viewing direction corresponding to a peak of the other. With a good\nmatch to the viewing direction selected, the algorithm could then compute good solutions for the spins of both discs.\n\n5\n\nDISCUSSION\n\nThe problem of finding a model matching the morphology and kinematics of a pair of colliding galaxies has generally been\nsolved by a process of trial-and-error, informed by physical insight into the dynamics of tidal interactions. In this approach,\nobservational data can't be used to derive initial conditions directly; instead, the outcome of a model calculation is compared\nto the observations, and the initial conditions are modified on the basis of this comparison. Identikit 2 offers a shortcut: an\nimportant component of the initial conditions \u2013 the initial spin vectors of the interacting discs \u2013 can be derived directly from\nthe observed morphology and kinematics of the tidal features. Moreover, by providing a way to assess the quality of a solution,\nthe algorithm can be used to search parameter space automatically.\nThe Identikit 2 algorithm derives the initial spin vector of a tidally interacting disc by simultaneously populating a set\nof phase-space regions which trace that disc's tidal features. It may seem odd not to make any use of the amount of material\nfound in each region, but this 'omission' is deliberate. The tracers commonly used to study the kinematics of interacting\nsystems don't necessarily obey a continuity equation; for example, neutral hydrogen may be ionized or converted to molecular\nform, so the amount of HI found in a given region can't be predicted by purely dynamical models. On the other hand, even if\nmuch of the HI in a tidal feature has been converted to another phase, the remaining HI may still provide a useful constraint\non disc spin as long as it has followed a free-fall trajectory.\nSince the algorithm does not use a \u03c72 statistic to quantify goodness-of-fit, it's not straightforward to obtain precise\nconfidence limits on solutions. Nonetheless, inspection of the function \u039b and its constituent factors (Fig. 6) offers some insight\ninto a solution's uniqueness and accuracy. It may be worth exploring the landscape of this function in more detail. For example,\ninstead of simply maximizing \u039b, the algorithm could examine solutions around the peak, and look for secondary peaks which\nmay represent alternate solutions. A similar examination of the functions \u03a9\u2217d could likewise reveal uncertainties and alternate\nsolutions for spin direction.\n\n5.1\n\nOther parameters\n\nThe version of the algorithm tested here performs a blind search of viewing direction, parameterized by (\u03b8X , \u03b8Y ). It constrains\nfour other viewing parameters \u2013 the line-of-sight rotation \u03b8Z , the length scale L, and two components of the offset Rc \u2013 from\nthe positions of the galaxy centres, and computes initial disc spins (id , \u03c9d ) using the regions tracking each disc. This accounts\nfor ten parameters out of the sixteen described in Fig. 1. Preliminary experiments indicate that some of the other parameters\ncan also be determined by maximizing \u039b(t, . . .). For example, the test in \u00a7 4 was repeated varying the time since periapsis t\nbetween 0.5 and 1.5; the times maximizing \u039b clustered around the actual value ttrue = 1, with an r.m.s. of 0.18. Further tests\nwith multiple parameters in play are necessary; it will be interesting to see if the algorithm can simultaneously fit for the time\nt, periapsis separation p, and velocity scale V as well as BH09 did.\nThe number of unknowns remaining depends on the type of system to be modeled as well as the nature of the data\navailable. Suppose that accurate systemic velocities for both members of a pair of well-separated galaxies are available. By\nforcing the model nuclei to coincide with their real counterparts in velocity as well as position, locking can determine the\nvelocity scale V and offset Vc in addition to \u03b8Z , L, and Rc . Adopting e = 1 and using photometry to estimate the mass ratio\n\u03bc leaves just four parameters \u2013 the viewing direction (\u03b8X , \u03b8Y ), the periapsis separation p, and time since periapsis t \u2013 as\nunknowns. In this case a blind search of these parameters seems reasonable. However, sufficiently accurate systemic velocities\nmay be hard to determine; galactic nuclei have large velocity dispersions, and different tracers (stars, H\u03b1 , HI, CO) often give\nresults differing by several tens of km/s. Only in cases where the systemic velocities of the nuclei differ by more than the\nuncertainties is velocity locking likely to yield useful constraints.\nAt the other extreme, fully merged systems such as NGC 7252 (Schweizer 1977; Hibbard et al. 1994; Hibbard & Mihos\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\fReconstructing Galactic Collisions\n\n13\n\n1995) represent the most difficult class of objects to model. The position and systemic velocity of a merger remnant constrain\nthe offsets Rc and Vc , but even assuming e = 1, a total of eight orbit and viewing parameters (Fig. 1) remain indeterminate.\nSince the real galaxies have already merged, only models run past merger need be considered. Nonetheless, the available\nparameter space is still very large, and blindly searching for possible solutions may not be very rewarding.\nSeveral groups have used genetic algorithms to automate the search for models of interacting galaxies (Wahde 1998;\nTheis & Kohle 2001). In these algorithms, a population of candidate solutions compete to match the observational data; the less\nsuccessful candidates are eliminated, and the most successful reproduce to replenish the population. After enough generations\nhave passed, the population converges toward a solution matching the observations. Unlike simple 'hill-climbing' strategies,\ngenetic algorithms are unlikely to be trapped by local maxima (a familiar problem with naive trial-and-error modeling). To\ndate, most genetic algorithms have determined the reproductive fitness of candidate solutions by comparing low-resolution\nimages of the actual system and candidate pixel by pixel, with only limited use of velocity data (Wahde & Donner 2001). For\nsuch a comparison to be truly meaningful, the observed material \u2013 typically stars or HI \u2013 must obey a continuity equation; as\nnoted above, this may be violated in real systems. Moreover, as Figs. 2 and 3 illustrate, morphology alone is not enough to\nstrongly constrain disc spins; low-resolution versions of the (X, Y ) images in the upper left of these figures would be almost\nindistinguishable.\nIf further tests confirm that maximizing \u039b(t, . . .) is an effective way of constraining viewing and orbit parameters, it\nmay be possible to combine Identikit 2 with a genetic algorithm. In this hybrid approach, each member of the candidate\npopulation would define a specific choice of viewing direction, periapsis time and separation, velocity scale, and possibly\norbital eccentricity. The remaining viewing parameters would be determined by locking the centres, and initial spin directions\ncould then be derived directly. The resulting \u039b value could be used to determine the fitness of the candidate solution. This\napproach combines the strengths of both algorithms. A genetic algorithm should be able to out-perform a blind search without\ngetting stuck on local maxima. Meanwhile, Identikit 2 could efficiently determine disc spins and provide a robust way to define\nreproductive fitness which fully includes velocity information and does not assume continuity.\n5.2\n\nMass models\n\nThe mass models adopted in Identikit simulations will almost certainly influence the algorithm's accuracy. In the tests presented here, the same mass model has been used to construct self-consistent simulations and their Identikit reproductions. However, rotation curves of real disc galaxies exhibit a variety of shapes (Casertano & van Gorkom 1991; Catinella, Giovanelli, & Haynes\n2006); small galaxies often have rising curves, while massive galaxies may have flat or even falling curves. This diversity presumably arises because real galaxies have a range of initial angular momenta, bulge/disc/halo mass ratios, and assembly\nhistories (Mo, Mao, & White 1998). Several studies have shown that rotation curve shape (equivalently, potential well or halo\nstructure) strongly influences the development of tidal features; in particular, long tidal tails can be inhibited by sufficiently\ndeep galactic potential wells (Dubinski, Mihos, & Hernquist 1996, 1999; Springel & White 1999). What happens if the mass\nmodel used in an Identikit simulation does not match the structure of the galaxies being modeled?\nSuppose for a moment that the Identikit mass model and the real galaxy have the similar rotation curves but apportion\nmass differently between various components. In this situation the Identikit algorithm will probably yield good encounter\nparameters despite the mismatch. One test is shown in Figs. 7 and 8, where the results obtained by giving all particles equal\nweights (red lines) accurately reproduce the viewing and spin directions of all eight test systems. This can be interpreted as\nan experiment in which real galaxies with exponential discs (surface density \u03a3 \u221d e\u2212\u03b1R ) are matched to Identikit models with\nradially biased discs (\u03a3 \u221d R2 e\u2212\u03b1R ) but identical rotation curves.\nAt the opposite extreme, suppose an attempt is made to match a pair of galaxies with long, well-developed tidal tails\n\u2013 which imply relatively shallow galactic potential wells \u2013 using an Identikit model with a very deep potential well. Since\nsuch a model would be unable to produce long tidal tails, it's unlikely that any set of encounter parameters could populate\nphase-space regions near the ends of the tails. As a result, the algorithm would fail to find a solution. This 'failure' points to\na flaw in the adopted mass model; the obvious recourse is to try a model with a shallower potential well.\nBetween these extremes is a grey area in which Identikit 2 may yield a good match to the morphology and kinematics\nof an interacting system without providing accurate values for all encounter parameters. Consider the problem of modeling a\nsystem observed just after first encounter, in which tidal features have not yet had time to develop and probe the full extent\nof the galactic potential wells. Some constraint on potential well depth may still be afforded by the relative velocities of the\ntwo galaxies, but depth is likely to be degenerate with orbital eccentricity; for example, a large line-of-sight velocity difference\nmay arise because the galaxies have deep potential wells or because their initial orbit was hyperbolic (e > 1).\nWhat can be learned about galactic structure by matching the morphology and kinematics of a pair of interacting galaxies\nwith a dynamical model? This larger question is independent of the specific technique \u2013 Identikit 2, genetic algorithm, or\ntrial-and-error \u2013 used to produce the model. Clearly there's no simple answer; the outcome will vary from system to system.\nIdentikit 2 offers a practical way to explore this question without laborious trial-and-error modeling. It's straightforward\nto construct self-consistent simulations with various mass models; these could then be tested against Identikit models with\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f14\n\nJ. E. Barnes\n\ndifferent rotation curves. Of particular interest will be tests varying the ratio of circular to escape velocity, which appears to\npredict the extent of the tidal tails produced in an encounter (Springel & White 1999; Dubinski et al. 1999).\n5.3\n\nCoda\n\nDetermining additional encounter parameters (\u00a7 5.1) and exploring the results of different mass models (\u00a7 5.2) both present\nintriguing theoretical problems. Beyond these, the effects of 'pre-existing conditions' such as bars and warps suggest additional\nlines of investigation. However, the algorithm already appears quite effective at reconstructing galactic collisions. It will be\nvery interesting to see if it works with real galaxy data.\nSource code for this algorithm is available at http://www.ifa.hawaii.edu/faculty/barnes/research/identikit/.\n\nACKNOWLEDGMENTS\nI am grateful to John Hibbard for his collaboration in developing Identikit 1, which led me towards the algorithm presented\nhere. The Observatories of the Carnegie Institute of Washington, the California Institute of Technology, and Kyoto University\nprovided support and hospitality during the initial stages of this work. I thank colleagues at these institutions, and at Academia\nSinica, Columbia University, the Institute for Astronomy, and the National Astronomical Observatory of Japan for listening\nto my talks on this project as it developed and offering useful feedback. Finally, I thank the referee for a very positive and\nconstructive report.\n\nREFERENCES\nBarnes, J.E. & Hibbard, J.E. 2009, 'IDENTIKIT 1: A modeling tool for interacting disc galaxies', AJ, 137, 3071\u20133090\nCasertano, S. & van Gorkom, J.H. 1991, 'Declining rotation curves \u2013 The end of a conspiracy?', AJ, 101, 1231\u20131241\nCatinella, B., Giovanelli, R., & Haynes, M.P. 2006, 'Template Rotation Curves for Disc Galaxies', ApJ, 640, 751\u2013761\nDubinski, J., Mihos, J.C., & Hernquist, L. 1996, 'Using Tidal Tails to Probe Dark Matter Halos', ApJ, 462, 576\u2013593\nDubinski, J., Mihos, J.C., & Hernquist, L. 1999, 'Constraining Dark Halo Potentials with Tidal Tails', ApJ, 526, 607\u2013622\nHernquist, L.E. 1990, 'An analytical model for spherical galaxies and bulges', ApJ, 356, 359\u2013364\nHibbard, J.E. & Mihos, J.C. 1995, 'Dynamical Modeling of NGC7252 and the Return of Tidal Material', AJ, 110, 140\u2013155\nHibbard, J.E., Guhathakurta, P., van Gorkom, J.H., & Schweizer, F. 1994, 'Cold, warm, and hot gas in the late-stage merger\nNGC 7252', AJ, 107, 67\u201389\nKhochfar, S. & Burkert, A. 2006, 'Orbital parameters of merging dark matter halos', A&A, 445, 403\u2013412\nMo, H.J., Mao, S., & White, S.D.M. 1998, 'The formation of galactic discs', MNRAS, 295, 319\u2013336\nNavarro, J.F., Frenk, C.S., & White, S.D.M. 1996, 'The Structure of Cold Dark Matter Halos', ApJ, 462, 563\u2013575\nSchweizer, F. 1977, 'Galaxies with long tails', in Structure and Properties of Nearby Galaxies, eds. E.M. Berkhuijsen & R.\nWielebinski. D. Reidel, Dordrecht. p. 279\u2013284\nSpringel, V., & White, S.D.M. 1999, 'Tidal tails in cold dark matter cosmologies', MNRAS, 307, 162\u2013178\nStockton, A. 1974, 'Spectroscopic observations of NGC 4676', ApJ, 187, 219\u2013221\nThies, C. & Kohle, S. 2001, 'Multi-method-modeling of interacting galaxies', A&A, 370, 365\u2013383\nToomre, A. & Toomre, J. 1972, 'Galactic Bridges and Tails', ApJ, 178, 623\u2013666\nWahde, M. 1998, 'Determination of orbital parameters of interacting galaxies using a genetic algorithm. Description of the\nmethod and application to artificial data', A&AS, 132, 417\u2013429\nWahde, M. & Donner, K.J. 2001, 'Determination of the orbital parameters of the M 51 system using a genetic algorithm',\nA&A, 379, 115\u2013124\n\nc 0000 RAS, MNRAS 000, 000\u2013000\n\n\f"}