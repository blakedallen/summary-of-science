{"id": "http://arxiv.org/abs/1203.3569v1", "guidislink": true, "updated": "2012-03-15T21:18:31Z", "updated_parsed": [2012, 3, 15, 21, 18, 31, 3, 75, 0], "published": "2012-03-15T21:18:31Z", "published_parsed": [2012, 3, 15, 21, 18, 31, 3, 75, 0], "title": "The Lax-Oleinik semi-group: a Hamiltonian point of view", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1203.1007%2C1203.1388%2C1203.0369%2C1203.2830%2C1203.1221%2C1203.6064%2C1203.1182%2C1203.6138%2C1203.3143%2C1203.1455%2C1203.4283%2C1203.1529%2C1203.1344%2C1203.1132%2C1203.2967%2C1203.1545%2C1203.6240%2C1203.0110%2C1203.1843%2C1203.0729%2C1203.4717%2C1203.0326%2C1203.0458%2C1203.3723%2C1203.6591%2C1203.5987%2C1203.3569%2C1203.4879%2C1203.5903%2C1203.6146%2C1203.3306%2C1203.5590%2C1203.6348%2C1203.5630%2C1203.6473%2C1203.2241%2C1203.0114%2C1203.2319%2C1203.2107%2C1203.0401%2C1203.5538%2C1203.1508%2C1203.6675%2C1203.5383%2C1203.2292%2C1203.0740%2C1203.4441%2C1203.1207%2C1203.3419%2C1203.2871%2C1203.0288%2C1203.2730%2C1203.0973%2C1203.3670%2C1203.0172%2C1203.3721%2C1203.1728%2C1203.6409%2C1203.0231%2C1203.1016%2C1203.0374%2C1203.0934%2C1203.4085%2C1203.2428%2C1203.6490%2C1203.3559%2C1203.2720%2C1203.1564%2C1203.2651%2C1203.3619%2C1203.4935%2C1203.5025%2C1203.1513%2C1203.0564%2C1203.2584%2C1203.2121%2C1203.4237%2C1203.5425%2C1203.4086%2C1203.5513%2C1203.5854%2C1203.2480%2C1203.1820%2C1203.3982%2C1203.0297%2C1203.4353%2C1203.2686%2C1203.3249%2C1203.2164%2C1203.5046%2C1203.6107%2C1203.3054%2C1203.0069%2C1203.5535%2C1203.5883%2C1203.5139%2C1203.2110%2C1203.4073%2C1203.5776%2C1203.5121%2C1203.0328&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Lax-Oleinik semi-group: a Hamiltonian point of view"}, "summary": "The Weak KAM theory was developed by Fathi in order to study the dynamics of\nconvex Hamiltonian systems. It somehow makes a bridge between viscosity\nsolutions of the Hamilton-Jacobi equation and Mather invariant sets of\nHamiltonian systems, although this was fully understood only a posteriori.\nThese theories converge under the hypothesis of convexity, and the richness of\napplications mostly comes from this remarkable convergence. In the present\ncourse, we provide an elementary exposition of some of the basic concepts of\nweak KAM theory. In a companion lecture, Albert Fathi exposes the aspects of\nhis theory which are more directly related to viscosity solutions. Here on the\ncontrary, we focus on dynamical applications, even if we also discuss some\nviscosity aspects to underline the connections with Fathi's lecture. The\nfundamental reference on Weak KAM theory is the still unpublished book of\nAlbert Fathi \\textit{Weak KAM theorem in Lagrangian dynamics}. Although we do\nnot offer new results, our exposition is original in several aspects. We only\nwork with the Hamiltonian and do not rely on the Lagrangian, even if some\nproofs are directly inspired from the classical Lagrangian proofs. This\napproach is made easier by the choice of a somewhat specific setting. We work\non $\\Rm^d$ and make uniform hypotheses on the Hamiltonian. This allows us to\nreplace some compactness arguments by explicit estimates. For the most\ninteresting dynamical applications however, the compactness of the\nconfiguration space remains a useful hypothesis and we retrieve it by\nconsidering periodic (in space) Hamiltonians. Our exposition is centered on the\nCauchy problem for the Hamilton-Jacobi equation and the Lax-Oleinik evolution\noperators associated to it. Dynamical applications are reached by considering\nfixed points of these evolution operators, the Weak KAM solutions. The\nevolution operators can also be used for their regularizing properties, this\nopens a second way to dynamical applications.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1203.1007%2C1203.1388%2C1203.0369%2C1203.2830%2C1203.1221%2C1203.6064%2C1203.1182%2C1203.6138%2C1203.3143%2C1203.1455%2C1203.4283%2C1203.1529%2C1203.1344%2C1203.1132%2C1203.2967%2C1203.1545%2C1203.6240%2C1203.0110%2C1203.1843%2C1203.0729%2C1203.4717%2C1203.0326%2C1203.0458%2C1203.3723%2C1203.6591%2C1203.5987%2C1203.3569%2C1203.4879%2C1203.5903%2C1203.6146%2C1203.3306%2C1203.5590%2C1203.6348%2C1203.5630%2C1203.6473%2C1203.2241%2C1203.0114%2C1203.2319%2C1203.2107%2C1203.0401%2C1203.5538%2C1203.1508%2C1203.6675%2C1203.5383%2C1203.2292%2C1203.0740%2C1203.4441%2C1203.1207%2C1203.3419%2C1203.2871%2C1203.0288%2C1203.2730%2C1203.0973%2C1203.3670%2C1203.0172%2C1203.3721%2C1203.1728%2C1203.6409%2C1203.0231%2C1203.1016%2C1203.0374%2C1203.0934%2C1203.4085%2C1203.2428%2C1203.6490%2C1203.3559%2C1203.2720%2C1203.1564%2C1203.2651%2C1203.3619%2C1203.4935%2C1203.5025%2C1203.1513%2C1203.0564%2C1203.2584%2C1203.2121%2C1203.4237%2C1203.5425%2C1203.4086%2C1203.5513%2C1203.5854%2C1203.2480%2C1203.1820%2C1203.3982%2C1203.0297%2C1203.4353%2C1203.2686%2C1203.3249%2C1203.2164%2C1203.5046%2C1203.6107%2C1203.3054%2C1203.0069%2C1203.5535%2C1203.5883%2C1203.5139%2C1203.2110%2C1203.4073%2C1203.5776%2C1203.5121%2C1203.0328&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Weak KAM theory was developed by Fathi in order to study the dynamics of\nconvex Hamiltonian systems. It somehow makes a bridge between viscosity\nsolutions of the Hamilton-Jacobi equation and Mather invariant sets of\nHamiltonian systems, although this was fully understood only a posteriori.\nThese theories converge under the hypothesis of convexity, and the richness of\napplications mostly comes from this remarkable convergence. In the present\ncourse, we provide an elementary exposition of some of the basic concepts of\nweak KAM theory. In a companion lecture, Albert Fathi exposes the aspects of\nhis theory which are more directly related to viscosity solutions. Here on the\ncontrary, we focus on dynamical applications, even if we also discuss some\nviscosity aspects to underline the connections with Fathi's lecture. The\nfundamental reference on Weak KAM theory is the still unpublished book of\nAlbert Fathi \\textit{Weak KAM theorem in Lagrangian dynamics}. Although we do\nnot offer new results, our exposition is original in several aspects. We only\nwork with the Hamiltonian and do not rely on the Lagrangian, even if some\nproofs are directly inspired from the classical Lagrangian proofs. This\napproach is made easier by the choice of a somewhat specific setting. We work\non $\\Rm^d$ and make uniform hypotheses on the Hamiltonian. This allows us to\nreplace some compactness arguments by explicit estimates. For the most\ninteresting dynamical applications however, the compactness of the\nconfiguration space remains a useful hypothesis and we retrieve it by\nconsidering periodic (in space) Hamiltonians. Our exposition is centered on the\nCauchy problem for the Hamilton-Jacobi equation and the Lax-Oleinik evolution\noperators associated to it. Dynamical applications are reached by considering\nfixed points of these evolution operators, the Weak KAM solutions. The\nevolution operators can also be used for their regularizing properties, this\nopens a second way to dynamical applications."}, "authors": ["Patrick Bernard"], "author_detail": {"name": "Patrick Bernard"}, "author": "Patrick Bernard", "arxiv_comment": "Proceedings of the Royal Society of Edinburgh, Section: A Mathematics\n  (2012) to appear", "links": [{"href": "http://arxiv.org/abs/1203.3569v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1203.3569v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DS", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1203.3569v1", "affiliation": "CEREMADE", "arxiv_url": "http://arxiv.org/abs/1203.3569v1", "journal_reference": null, "doi": null, "fulltext": "The Lax-Oleinik semi-group: a Hamiltonian point of view.\nPatrick Bernard\n\narXiv:1203.3569v1 [math.DS] 15 Mar 2012\n\nCANPDE crash-course, Edimbourg, February 2011.\n\n\u2217\n\nThe Weak KAM theory was developed by Fathi in order to study the dynamics of convex Hamiltonian\nsystems. It somehow makes a bridge between viscosity solutions of the Hamilton-Jacobi equation and\nMather invariant sets of Hamiltonian systems, although this was fully understood only a posteriori. These\ntheories converge under the hypothesis of convexity, and the richness of applications mostly comes from\nthis remarkable convergence. In the present course, we provide an elementary exposition of some of the\nbasic concepts of weak KAM theory. In a companion lecture, Albert Fathi exposes the aspects of his\ntheory which are more directly related to viscosity solutions. Here on the contrary, we focus on dynamical\napplications, even if we also discuss some viscosity aspects to underline the connections with Fathi's\nlecture. The fundamental reference on Weak KAM theory is the still unpublished book of Albert Fathi\nWeak KAM theorem in Lagrangian dynamics. Although we do not offer new results, our exposition is\noriginal in several aspects. We only work with the Hamiltonian and do not rely on the Lagrangian, even if\nsome proofs are directly inspired from the classical Lagrangian proofs. This approach is made easier by the\nchoice of a somewhat specific setting. We work on Rd and make uniform hypotheses on the Hamiltonian.\nThis allows us to replace some compactness arguments by explicit estimates. For the most interesting\ndynamical applications however, the compactness of the configuration space remains a useful hypothesis\nand we retrieve it by considering periodic (in space) Hamiltonians. Our exposition is centered on the\nCauchy problem for the Hamilton-Jacobi equation and the Lax-Oleinik evolution operators associated to\nit. Dynamical applications are reached by considering fixed points of these evolution operators, the Weak\nKAM solutions. The evolution operators can also be used for their regularizing properties, this opens a\nsecond way to dynamical applications.\n\nContents\n1 The method of characteristics, existence and uniqueness of regular solutions.\n\n2\n\n2 Convexity, the twist property, and the generating function.\n\n9\n\n3 Extension of the generating function: The minimal action.\n\n13\n\n4 The Lax-Oleinik operators.\n\n16\n\n5 Sub-solutions of the stationary Hamilton-Jacobi equation.\n\n23\n\n6 Weak KAM solutions and invariant sets.\n\n26\n\n7 Regular sub-solutions and the Aubry set.\n\n28\n\n8 The Ma\u00f1\u00e9 Potential.\n\n31\n\n9 Return to the periodic case.\n\n35\n\n10 The Lagrangian.\n\n36\n\nA Some technical results.\n\n38\n\n\u2217\n\nNotes completed in May 2011, revised in january 2012.\n\n1\n\n\f1\n\nThe method of characteristics, existence and uniqueness of\nregular solutions.\n\nWe consider a C 2 Hamiltonian\nH(t, q, p) : R \u00d7 Rd \u00d7 Rd\u2217 \u2212\u2192 R\nand study the associated Hamiltonian system\n\u1e57(t) = \u2212\u2202q H(t, q(t), p(t))\n\nq\u0307(t) = \u2202p H(t, q(t), p(t)) ,\n\n(HS)\n\nand Hamilton-Jacobi equation\n\u2202t u + H(t, q, \u2202q u(t, q)) = 0.\n\n(HJ)\n\nWe denote by XH (x) = XH (q, p) the Hamiltonian vector field XH = JdH, where J is the matrix\n\u0014\n\u0015\n0 I\nJ=\n.\n\u2212I 0\nThe Hamiltonian system can be written in condensed terms \u1e8b(t) = XH (t, x(t)). We will always\nassume that that the solutions extend to R. We denote by\n\u03c6t\u03c4 = (Qt\u03c4 , P\u03c4t ) : Rd \u00d7 Rd\u2217 \u2212\u2192 Rd \u00d7 Rd\u2217\nthe flow map which, to a point x \u2208 T\u2217 Rd , associate the value at time t of the solution x(s) of\n(HS) which satisfies x(\u03c4 ) = x.\nIf u(t, q) solves (HJ), and if q(s) is a curve in Rd , then the formula\nZ\n\nt1\n\nu(t1 , q(t1 )) \u2212 u(t0 , q(t0 )) =\n\n\u2202q u(s, q(s)) * q\u0307(s) \u2212 H(s, \u2202q u(s, q(s)))ds\n\n(1)\n\nt0\n\nfollows from an obvious computation. The integral on the right hand side is the Hamiltonian\naction of the curve s 7\u2212\u2192 (q(s), \u2202q u(s, q(s))). The Hamiltonian action of the curve (q(s), p(s))\non the interval [t0 , t1 ] is the quantity\nZ\n\nt1\n\np(s) * q\u0307(s) \u2212 H(s, q(s), p(s))ds.\nt0\n\nA classical and important property of the Hamiltonian actions is that orbits are critical points\nof this functional. More precisely, we have:\nProposition 1. The C 2 curve x(t) = (q(t), p(t)) : [t0 , t1 ] \u2212\u2192 Rd \u00d7 Rd\u2217 solves (HS) if and only\nif the equality\n\u0012Z t1\n\u0013\nd\np(t, s) * q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))dt = 0,\nds s=0\nt0\nwhere the dot is the derivative with respect to t, holds for each C 2 variation x(t, s) = (q(t, s), p(t, s)) :\n[t0 , t1 ] \u00d7 R \u2212\u2192 Rd \u00d7 Rd\u2217 fixing the endpoints, which means that x(t, 0) = x(t) for each t and that\nq(t0 , s) = q(t0 ) and q(t1 , s) = q(t1 ) for each s.\n\n2\n\n\fProof. We set \u03b8(t) = \u2202s q(t, 0), \u03b6(t) = \u2202s p(t, 0) and compute:\n\u0012Z t1\n\u0013\nd\np(t, s)q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))dt\nds s=0\nt0\nZ t1\n=\np(t)\u03b8\u0307(t) + \u03b6(t)q\u0307(t) \u2212 \u2202q H(t, q(t), p(t))\u03b8(t) \u2212 \u2202p H(t, q(t), p(t))\u03b6(t)dt\nt0\n\nZ\n\nt1\n\n\u0001\nq\u0307(t) \u2212 \u2202p H(t, q(t), p(t)) \u03b6(t)dt\n\n= p(t1 )\u03b8(t1 ) \u2212 p(t0 )\u03b8(t0 ) +\nt0\n\nZ\n\nt1\n\n\u0001\n\u1e57(t) + \u2202q H(t, q(t), p(t)) \u03b8(t)dt.\n\n\u2212\nt0\n\nAs a consequence, the derivative of the action vanishes if (q(t), p(t)) is a Hamiltonian trajectory\nand if the variation q(t, s) is fixing the boundaries. Conversely, this computation can be applied\nto the variation q(t, s) = q(t) + s\u03b8(t), p(t, s) = p(t) + s\u03b6(t), and implies that\nZ t1\nZ t1\n\u0001\n\u0001\nq\u0307(t) \u2212 \u2202p H(t, q(t), p(t)) \u03b6(t)dt \u2212\n\u1e57(t) + \u2202q H(t, q(t), p(t)) \u03b8(t)dt = 0\nt0\n\nt0\n\nfor each C 2 curve \u03b8(t) vanishing on the boundary and each C 2 curve \u03b6(t). This implies that\nq\u0307(t) \u2212 \u2202p H(t, q(t), p(t)) \u2261 0 and \u1e57(t) + \u2202q H(t, q(t), p(t)) \u2261 0.\nWe now return to the connections between (HS) and (HJ). A function is said of class C 1,1 if\n1,1\nit is differentiable and if its differential is Lipschitz. It is said of class Cloc\nif it is differentiable\nwith a locally Lipschitz differential. The Theorem of Rademacher states that a locally Lipschitz\nfunction is differentiable almost everywhere.\n1,1\nTheorem 1. Let \u03a9 \u2282 R \u00d7 Rd be an open set, and let u(t, q) : \u03a9 \u2212\u2192 R be a Cloc\nsolution of\n(HJ). Let q(t) : [t0 , t1 ] \u2212\u2192 Rd be a C 1 curve such that (t, q(t)) \u2208 \u03a9 and\n\u0001\nq\u0307(t) = \u2202p H t, q(t), \u2202q u(t, q(t))\n\nfor each t \u2208 [t0 , t1 ]. Then, setting p(t) = \u2202q u(t, q(t)), the curve (q(t), p(t)) is C 1 and it solves\n(HS).\nThe curves q(t) satisfying the hypothesis of the theorem, as well as the associated trajectories\n(q(t), p(t)) are called the characteristics of u.\nProof. Let \u03b8(t) : [t0 , t1 ] \u2212\u2192 Rd be a smooth curve vanishing on the boundaries. We\ndefine q(t, s) := q(t) + s\u03b8(t) and p(t, s) := \u2202q u(t, q(t, s))). Our hypothesis is that q\u0307(t) =\n\u2202p H(t, q(t), p(t)), which is the first part of (HS). For each s, we have\nZ t1\nu(t1 , q(t1 )) \u2212 u(t0 , q(t0 )) =\np(t, s) * q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))ds\nt0\n\nhence\nZ\n\nt1\n\nt0\n\nd\nds s=0\n\n\u0010R\n\nt1\nt0\n\n\u0011\np(t, s)q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))dt = 0. We now claim that\n\nd\n\u2202q H(t, q(t), p(t)) * \u03b8(t) \u2212 p(t)\u03b8\u0307(t) dt =\nds\n\n\u0012Z\n\nt1\n\n\u0013\np(t, s)q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))dt .\n\ns=0\n\nt0\n\nRt\nAssuming the claim, we obtain the equality t01 \u2202q H(t, q(t), p(t)) * \u03b8(t) \u2212 p(t) * \u03b8\u0307(t) dt = 0 for each\nsmooth function \u03b8 vanishing at the boundary. In other words, we have\n\u1e57(t) = \u2212\u2202q H(t, q(t), p(t))\n3\n\n\fin the sense of distributions. Since the right hand side is continuous, this implies that p is C 1\nand that the equality holds for each t. We have proved the theorem, assuming the claim.\nThe claim can be proved by an easy computation in the case where u is C 2 . Under the\n1,1\nassumption that u is only Cloc\n, the map p is only locally Lipschitz, and some care is necessary.\nFor each fixed \u03b8, we have\n\u2202q H(t, q(t, s), p(t, s)) * \u03b8(t) \u2212 p(t, s) * \u03b8\u0307(t) = \u2202q H(t, q(t), p(t)) * \u03b8(t) \u2212 p(t) * \u03b8\u0307(t) + O(s)\n\u2202t q(t, s) \u2212 \u2202p H(t, q(t, s), p(t, s)) = q\u0307 \u2212 \u2202p H(t, q(t), p(t)) + O(s) = O(s)\nwhere O(s) is uniform in t. We then have, for small S > 0,\nZ t1\n\u2202q H(t, q(t), p(t)) * \u03b8(t) \u2212 p(t) * \u03b8\u0307(t) dt\nt0\n\n=O(S) +\n\n1\nS\n\n1\n=O(S) +\nS\n1\n=O(S) +\nS\n\nZ\n\nt1\n\nZ\n\nS\n\n\u2202q H(t, q(t, s), p(t, s)) * \u03b8(t) \u2212 p(t, s) * \u03b8\u0307(t) dsdt\nt0\nZ t1\nt0\n\nZ\n\nt1\n\nt0\n\n0\n\nZ\n\nS\n\n\u0001\n\u2202q H * \u2202s q \u2212 p * \u2202st q + \u2202t q \u2212 \u2202p H * \u2202s p dsdt\n\n0\n\n\u0002\n\u0003S\n1\np * \u2202t q \u2212 H 0 dt = O(S) +\nS\n\n\u0014Z\n\nt1\n\n\u0015S\np * \u2202t q \u2212 H dt .\n\nt0\n\n0\n\nWe obtain the claimed equality at the limit S \u2212\u2192 0.\nThe following restatement of Theorem 1 has a more geometric flavor:\n1,1\nsolution of\nCorollary 2. Let \u03a9 \u2282 R \u00d7 Rd be an open set, and let u(t, q) : \u03a9 \u2212\u2192 R be a Cloc\nthe Hamilton Jacobi equation (HJ). Then the extended Hamiltonian vector-field YH = (1, XH )\nis tangent to the graph\nG := {(t, q, \u2202q u) : (t, q) \u2208 \u03a9}.\n\nProof. Let us fix a point (t0 , q0 ) in \u03a9. By the Cauchy-Lipschitz theorem,\nthere exists a solution\n\u0001\nq(t) of the ordinary differential equation q\u0307 = \u2202p H t, q(t), \u2202q u(t, q(t)) , defined on an open time\ninterval containing t0 and such that q(t0 ) = q0 . Let us define as above p(t) := \u2202q u(t, q(t)). The\ncurve (t, q(t), p(t)) is contained in the graph G, and we deduce from Theorem 1 that it solves\n(HS). As a consequence, the derivative YH of the curve (t, q(t), p(t)) is tangent to G.\n1,1\nCorollary 3. Let u(t, q) be a Cloc\nsolution of (HJ) defined on the open set \u03a9 =]t0 , t1 [\u00d7Rd .\nThen, for each s and t in ]t0 , t1 [ we have\n\n\u0393t = \u03c6ts (\u0393s ),\nwhere \u0393t is defined by\n\u0393t := {(q, dut (q)) : q \u2208 Rd }.\nProof. Let (qs , ps ) be a point in \u0393s . Let us consider the Lipschitz map\nF (t, q) := \u2202p H(t, q, \u2202q u(t, q)),\nand consider the differential equation q\u0307(t) = F (t, q(t)). By the Cauchy-Peano Theorem, there\nexists a solution q(t) of this equation, defined on the interval ]t\u2212 , t+ [3 s, and such that q(s) = qs .\nSetting p(t) = \u2202q u(t, q(t)), Theorem 1 implies that the curve (q(t), p(t)) solves (HS). We can\nchose t+ such that either t+ = t1 or the curve q(t) is unbounded on [s, t+ [. The second case\n4\n\n\fis not possible because (q(t), p(t)) is a solution of (HS), which is complete, hence we can take\nt+ = t1 . Similarly, we can take t\u2212 = t0 . We have proved that (q(t), p(t)) is the Hamiltonian\norbit of the point (qs , ps ). Then, for each t \u2208]t0 , t1 [, we have\n\u03c6ts (qs , ps ) = (q(t), p(t)) = (q(t), \u2202q u(t, q(t))) \u2208 \u0393t .\nSince this holds for each (qs , ps ) \u2208 \u0393s , we conclude that \u03c6ts (\u0393s ) \u2282 \u0393t for each s, t \u2208]t0 , t1 [. By\nsymmetry, this inclusion is an equality.\nLet us now consider an initial condition u0 (q) and study the Cauchy problem consisting of\nfinding a solution u(t, q) of (HJ) such that u(0, q) = u0 (q).\n1,1\nProposition 4. Given a time interval ]t0 , t1 [ containing the initial time t = 0 and a Cloc\n1,1\ninitial condition u0 , there is at most one Cloc\nsolution u(t, q) :]t0 , t1 [\u00d7Rd of (HJ) such that\nu(0, q) = u0 (q) for all q \u2208 Rd .\n\nProof. Let u and \u0169 be two solutions of this Cauchy problem. Let us associate to them the\ngraphs \u0393t and \u0393\u0303t , t \u2208]t0 , t1 [. Since \u0169(\u03c4, q) = u(\u03c4, q), we have \u0393\u03c4 = \u0393\u0303\u03c4 hence, by Corollary 3,\n\u0001\n\u0001\n\u0393t = \u03c6t\u03c4 \u0393\u03c4 = \u03c6t\u03c4 \u0393\u0303\u03c4 = \u0393\u0303t .\nWe conclude that \u2202q u = \u2202q \u0169, and then, from (HJ), that \u2202t u = \u2202t \u0169. The functions u and \u0169 thus\nhave the same differential on ]t0 , t1 [\u00d7Rd , hence they differ by a constant. Finally, since these\nfunctions have the same value on {\u03c4 } \u00d7 Rd , they are equal.\nTo study the existence problem, we lift the function u0 to the surface \u03930 by defining w0 =\nu0 \u25e6 \u03c0, where \u03c0 is the projection (q, p) 7\u2212\u2192 q (later we will also use the symbol \u03c0 to denote the\nprojection (t, q, p) 7\u2212\u2192 (t, q)). It is then useful to work in a more general setting:\nA geometric initial condition is the data of a subset \u03930 \u2282 Rd \u00d7 Rd\u2217 and of a function\nw0 : \u03930 \u2212\u2192 R such that dw0 = pdq on \u03930 . More precisely, we require that the equality\n\u2202s (w0 (q(s), p(s))) = p(s)\u2202s q(s) holds almost everywhere for each Lipschitz curve (q(s), p(s)) on\n\u03930 . We will consider mainly two types of geometric initial conditions:\n\u2022 The geometric initial condition (\u03930 , w0 = u0 \u25e6 \u03c0) associated to the C 1 initial condition u0 .\n\u2022 The geometric initial condition (\u03930 = {q0 } \u00d7 Rd\u2217 , w0 = 0), for q0 \u2208 Rd .\nGiven the geometric initial condition (\u03930 , w0 ), we define:\n[\n\u0001\nG :=\n{t} \u00d7 \u03c6t0 \u03930\n\n(G)\n\nt\u2208]t0 ,t1 [\n\nand, denoting by Q\u0307st (x) the derivative with respect to s, the function\nw:\n\nG \u2212\u2192 R\n\n(t, x) 7\u2212\u2192\n\nw0 (Q0t (x))\n\nZ\n+\n\nt\n\nPts (x)Q\u0307st (x) \u2212 H(s, \u03c6st (x))ds.\n\n(w)\n\n0\n\nThe pair (G, w) is called the geometric solution emanating from the geometric initial condition\n(\u03930 , w0 ).\nThis definition is motivated by the following observation: Assume that a C 2 solution u(t, q)\nof (HJ) emanating from the genuine initial condition u0 exists. Let (\u03930 , w0 ) be the geometric\ninitial condition associated to u0 . Let G be the graph of \u2202q u, as defined in Corollary 3, and let\nw be the function defined on G by w := u \u25e6 \u03c0. Then, (G, w) is the geometric solution emanating\nfrom the geometric initial condition \u03930 . This follows immediately from Corollary 3 and equation\n(1). In general, we have:\n5\n\n\fProposition 5. Let (\u03930 , w0 ) be a geometric initial condition, and let (G, w) be the geometric\nsolution emanating from (\u03930 , w0 ). Then, the function w satisfies dw = pdq \u2212 Hdt on G. More\nprecisely, for each Lipschitz curve Y (s) = (T (s), \u03b8(s), \u03b6(s)) contained in G, then for a. e. s,\n\u0001\nd\nd\u03b8\ndT\nw(T (s), \u03b8(s), \u03b6(s)) = \u03b6(s) \u2212 H(Y (s)) .\nds\nds\nds\nProof. Let us first consider a C 2 curve Y (s) = (T (s), \u03b8(s), \u03b6(s)) on G. We set q(t, s) =\nQtT (s) (\u03b8(s), \u03b6(s)) and p(t, s) = PTt (s) (\u03b8(s), \u03b6(s)), and finally x(t, s) = (q(t, s), p(t, s)). We have\nZ\n\nT (s)\n\np(t, s)q\u0307(t, s) \u2212 H(t, x(t, s))dt.\n\nw(T (s), \u03b8(s), \u03b6(s)) = w0 (q(0, s), p(0, s)) +\n0\n\nSince dw0 = pdq on \u03930 , the calculations in the proof of Proposition 1 imply that\nd\n(w \u25e6 Y ) = p(0, s) * \u2202s q(0, s) + p(T (s), s) * \u2202s q(T (s), s) \u2212 p(0, s) * \u2202s q(0, s)\nds\n\u0010\n\u0011 dT\n+ p(T (s), s) * \u2202t q(T (s), s) \u2212 H(T (s), x(T (s), s))\nds\n\u0013\n\u0012\ndT\ndT\n+ H(Y (s)) .\n= \u03b6(s) \u2202s q(T (s), s) + \u2202t q(T (s), s)\nds\nds\nThe desired equality follows from the observation that d\u03b8/ds = \u2202t q(T (s), s)(dT /ds)+\u2202s q(T (s), s),\nwhich can be seen by differentiating the equality \u03b8(s) = q(T (s), s).\nThese computations, however, can't be applied directly in the case where Y (s) is only C 1 ,\nor, even worse, Lipschitz. In this case, we will prove the desired equality in integral form\nZ S1\nS1\n[w \u25e6 Y ]S0 =\n\u03b6(s) * \u2202s \u03b8(s) \u2212 H \u25e6 Y (s) * \u2202s T (s)ds\nS0\n\nfor each S0 < S1 . Fixing S0 and S1 , we can approximate uniformly the curve Y (s) by a sequence\nYn (s) : [S0 , S1 ] \u2212\u2192 R \u00d7 Rd \u00d7 Rd\u2217 of equi-Lipschitz smooth curves such that Yn (S0 ) = Y (S0 )\nand Yn (S1 ) = Y (S1 ). To the curves Yn , we associate xn (t, s) = (pn (t, s), qn (t, s)) as above. The\nfunctions xn are equi-Lipschitz and converge uniformly to x. In general, we don't have Yn (s) \u2208 G\non ]S0 , S1 [, hence we don't have xn (0, s) \u2208 \u03930 , and we cannot express \u2202s w(xn (0, s)) as we did\nabove. Since this is the only part of the above computation which used the inclusion Y (s) \u2208 G,\nwe can still get:\nd\nd\n(w \u25e6 Yn ) = (w0 (xn (0, s)) \u2212 pn (0, s) * \u2202s qn (0, s) + \u03b6n (s)\u2202s \u03b8n (s) + H(Yn (s))\u2202s Tn (s).\nds\nds\nNoticing that [w \u25e6 Y ]SS10 = [w \u25e6 Yn ]SS10 and that [w0 (x(0, .))]SS10 = [w0 (xn (0, .))]SS10 , we obtain\n[w \u25e6 Y ]SS10 = [w0 (x(0, .))]SS10 +\nZ\n\nZ\n\nS1\n\n\u2212pn (0, s) * \u2202s qn (0, s) + \u03b6n (s)\u2202s \u03b8n (s) + H(Yn (s))\u2202s Tn (s)ds\nS0\n\nS1\n\np(0, s) * \u2202s q(0, s) \u2212 pn (0, s) * \u2202s qn (0, s)ds\n\n=\nS0\nZ S1\n\n+\n\n\u03b6n (s)\u2202s \u03b8n (s) + H(Yn (s))\u2202s Tn (s)ds.\nS0\n\nWe derive the desired formula at the limit n \u2212\u2192 \u221e, along a subsequence such that\n\u2202s qn (0, .) * \u2202s q(0, .),\n\n\u2202s \u03b8n * \u2202s \u03b8,\n6\n\n\u2202s Tn * \u2202s T\n\n\fweakly-? in L\u221e , taken into account that\npn (0, .) \u2212\u2192 p(0, .),\n\n\u03b6n (s) \u2212\u2192 \u03b6(s),\n\nH(Yn (s)) \u2212\u2192 H(Y (s))\n\nuniformly, hence strongly in L1 . RRecall that aRsequence of curves fn : [t0 , t1 ] \u2212\u2192 Rd is said to\nt\nt\nconverge to f weakly-? in L\u221e if t01 fn gdt \u2212\u2192 t01 f gdt for each L1 curve g : [t0 , t1 ] \u2212\u2192 Rd . We\nhave used two classical properties of the weak-? convergence:\n\u2022 A uniformly bounded sequence of functions has a subsequence which has a weak-? limit.\nR\nRt\n\u2022 The convergence t01 fn gn dt \u2212\u2192 f gdt holds if fn * f weakly-? in L\u221e and if gn \u2192 g\nstrongly in L1 .\nCorollary 6. If there exists a locally Lipschitz map \u03c7 : \u03a9 \u2212\u2192 Rd\u2217 on some open subset \u03a9 of\n]t0 , t1 [\u00d7Rd such that (t, q, \u03c7(t, q)) \u2282 G for all (t, q) \u2208 \u03a9, then the function\nu(t, q) := w(t, q, \u03c7(t, q))\nis C 1 and it solves (HJ) on \u03a9. Moreover, we have \u2202q u = \u03c7.\nProof. For each C 1 curve (T (s), Q(s)) in \u03a9, the curve\nY (s) = (T (s), Q(s), \u03c7(T (s), Q(s))\nis Lipschitz, hence, by Proposition 5, we have\n\u0001\n\u2202s u(T (s), Q(s)) = \u2202s w T (s), Q(s), \u03c7(T (s), Q(s))\n\u0001\n\u0001\n= \u03c7 T (s), Q(s) * \u2202s Q(s) \u2212 H T (s), Q(s), \u03c7(T (s), Q(s) \u2202s T (s)\nalmost everywhere. Since the right hand side in this expression is continuous, we conclude that\nthe Lipschitz functions u(T (s), Q(s)) is actually differentiable at each point, the equality above\nbeing satisfied everywhere. Since this holds for each C 1 curve (T (s), Q(s)), the function u has\nto be differentiable, with \u2202q u(t, q) = \u03c7(t, q) and \u2202t u(t, q) + H(t, q, \u03c7(t, q)) = 0.\nWe have reduced the existence problem to the study of the geometric solution G. We need\nan additional hypothesis to obtain a local existence result. We will rest on the following one,\nwhich it is stronger than would really be necessary, but will allow us to rest on simple estimates\nin this course.\nHypothesis 1. There exists a constant M such that\nkd2 H(t, q, p)k 6 M\nfor each (t, q, p).\nThis hypothesis implies that the Hamiltonian vector-field is Lipschitz, hence that the Hamiltonian flow is complete. The hypothesis can be exploited further to estimate the differential\n\u0014\n\u0015\n\u2202q Qt0 (x) \u2202p Qt0 (x)\nd\u03c6t0 =\n\u2202q P0t (x) \u2202p P0t (x)\nusing the variational equation\n\u0014\n\u0015 \u0014\n\u0015\u0014\n\u0015\n\u2202q Q\u0307t0 (x) \u2202p Q\u0307t0 (x)\n\u2202qp H(t, x)\n\u2202pp H(t, x)\n\u2202q Qt0 (x) \u2202p Qt0 (x)\n=\n.\n\u2212\u2202qp H(t, x) \u2212\u2202pp H(t, x)\n\u2202q P0t (x) \u2202p P0t (x)\n\u2202q \u1e560t (x) \u2202p \u1e560t (x)\n7\n\n\fWe obtain the following estimates:\nkd\u03c6t\u03c4 \u2212 Ik 6 eM |t\u2212\u03c4 | \u2212 1\nwhich implies, for |t \u2212 \u03c4 | 6 1/M , that\nkd\u03c6t\u03c4 \u2212 Ik 6 2M |t \u2212 \u03c4 |\n\n(M)\n\nor componentwise (taking \u03c4 = 0, and assuming that |t| 6 M ):\nk\u2202q Qt0 \u2212 Ik 6 2M |t| ,\n\nk\u2202p P0t \u2212 Ik 6 2M |t| ,\n\nk\u2202q P0t k 6 2M |t| ,\n\nk\u2202p Qt0 k 6 2M |t|.\n\nWe can now prove:\nTheorem 2. Let H : R \u00d7 Rd \u00d7 (Rd )\u2217 be a C 2 Hamiltonian satisfying Hypothesis 1. Let u0 be a\n1,1\nC 1,1 initial condition. There exists a time T > 0 and a Cloc\nsolution u(t, q) :] \u2212 T, T [\u00d7Rd \u2212\u2192 R\nof (HJ) such that u(0, q) = u0 (q). Moreover, we can take\n\u0010\n\u0001\u0011\u22121\nT = 4M 1 + Lip(du0 )\n,\nand we have\nLip(dut ) 6 Lip(du0 ) + 4|t|M 1 + Lip(du0 )\n\n\u00012\n\nwhen |t| 6 T . If the initial condition u0 is C 2 , then so is the solution u(t, q).\nProof. Let (\u03930 , w0 ) be the geometric initial condition associated to u0 , and let (G, w) be\nthe geometric solution emanating from (\u03930 , w0 ). We first prove that the restriction of G to\n] \u2212 T, T [\u00d7Rd is a graph. It is enough to prove that the map\n\u0001\nF (t, q) := t, Qt0 (q, du0 (q))\nis a bi-Lipschitz homeomorphism of ] \u2212 T, T [\u00d7Rd . By (M), we have\n\u0001\nLip(F \u2212 Id) 6 2|t|M 1 + Lip(du0 ) < 1,\n\u0010\n\u0001\u0011\u22121\n. We conclude using the classical Proposition 50 of the\nprovided |t| < 2M 1 + Lip(du0 )\nAppendix that F is a bi-Lipschitz homeomorphism of ] \u2212 T, T [\u00d7Rd . Moreover, if u0 is C 2 , then\nF is a C 1 diffeomorphism. Since F is a homeomorphism preserving t, we can denote by by\n(t, Z(t, q)) its inverse. By Proposition 50, we have\nLip(Z) 6\n\n1\n,\n1 \u2212 2|t|M (1 + Lip(du0 ))\n\nand, under the assumption that |t| 6 T (as defined in the statement), we obtain\nLip(Z) 6 1 + 4M |t|(1 + Lip(du0 )) 6 2.\nWe have just used here that (1 \u2212 a)\u22121 6 1 + 2a for a \u2208 [0, 1/2]. We set\n\u0001\n\u03c7(t, q) = P0t Z(t, q), du0 (Z(t, q)) ,\nin such a way that G is the graph of \u03c7 on ] \u2212 T, T [\u00d7Rd . Observing that \u03c7 is Lipschitz, we\nconclude from Corollary 6 that the function u(t, q) := w(t, q, \u03c7(t, q)) solves (HJ). Moreover, we\nhave u(0, q) = u0 (q). Corollary 6 also implies that dut = \u03c7t hence, in view of (M), we have\nLip(dut ) = Lip(\u03c7t ) 6 2M |t|Lip(Zt ) + (1 + 2M |t|)Lip(du0 )Lip(Zt )\n6 4M |t| + Lip(du0 ) + Lip(du0 )(4M |t|(1 + Lip(du0 ))) + 4M |t|Lip(du0 )\n\u0001\n\u0001\n6 Lip(du0 ) + 4M |t| 1 + Lip(du0 ) 1 + Lip(du0 ) .\n\n8\n\n\f1.1\n\nExercise :\n\nTake d = 1, H(t, q, p) = (1/2)p2 , and u0 (q) = \u2212q 2 , and prove that the C 2 solution can't be\nextended beyond t = 1/2.\n\n2\n\nConvexity, the twist property, and the generating function.\n\nWe make an additional assumption on H. Once again, we make the assumption in a stronger\nform than would be necessary, this allows to obtain simpler statements:\nHypothesis 2. There exists m > 0 such that\n2\n\u2202pp\nH > mId\n\nfor each (t, q, p), in the sense of quadratic forms.\nLet us first study the consequences of this hypothesis on the structure of the flow.\nProposition 7. There exists \u03c3 > 0 such that the map p 7\u2212\u2192 Qt0 (q, p) is (mt/2)-monotone when\nt \u2208]0, \u03c3], in the sense that the inequality\n(Qt0 (q, p0 ) \u2212 Qt0 (q, p)) * (p0 \u2212 p) > mt|p0 \u2212 p|2 /2\nholds for each q \u2208 Rd , each t \u2208 [0, \u03c3]. As a consequence, it is a C 1 diffeomorphism onto Rd .\nWe say that the flow has the Twist property.\nProof. Fix a point q and denote by F t the map p 7\u2212\u2192 Qt0 (q, p). We have dF t (p) = \u2202p Qt0 (q, p).\nIn order to estimate this linear map, we recall the variational equation\n\u2202p Q\u0307t0 (x) = \u2202qp H(t, \u03c6t0 (x))\u2202p Qt0 (x) + \u2202pp H(t, \u03c6t0 (x))\u2202p P0t (x).\nWe deduce that\n2\n2\n2\nH(t, \u03c6t0 (x))(\u2202p P0t (x) \u2212 Id)\n\u2202p Q\u0307t0 (x) \u2212 \u2202pp\nH(t, \u03c6t0 (x)) = \u2202qp\nH(t, \u03c6t0 (x))\u2202p Qt0 (x) + \u2202pp\n\nand then that\n2\nk\u2202p Q\u0307t0 (x) \u2212 \u2202pp\nH(t, \u03c6t0 (x))k 6 2M 2 t\n\nAs a consequence, for t 6 \u03c3 = m/(4M 2 ), we have\n\u2202p Q\u0307t0 > (m \u2212 2M 2 t)I > (m/2)I\nin the sense of quadratic forms (note that the matrix \u2202p Q\u0307t0 is not necessarily symmetric). Since\nZ t\n\u2202p Qt0 (x) =\n\u2202p Q\u0307s0 (x)ds,\n0\n\nwe conclude that\ndF t (p) = \u2202p Qt0 (q, p) > (m/2)Id,\nwhich means that (dF t (p)z, z) > (m/2)|z|2 for each z \u2208 Rd\u2217 . This estimate can be integrated,\nand implies the monotony of the map F t :\n\u0012Z 1\n\u0013\nt\n0\nt\n0\nt\n0\n0\n(Q (q, p ) \u2212 Q (q, p)) * (p \u2212 p) =\n\u2202p Q (q, p + s(p \u2212 p)) * (p \u2212 p)ds * (p0 \u2212 p)\n0\nZ 1\n\u0001\n=\n\u2202p Qt (q, p + s(p0 \u2212 p)) * (p0 \u2212 p) ds\n0\nZ 1\n>\n(m/2)t(p0 \u2212 p) * (p0 \u2212 p)ds > (m/2)t(p0 \u2212 p) * (p0 \u2212 p).\n0\n\n9\n\n\fIt is then a classical result that the map F t is a C 1 diffeomorphism, see Proposition 51 in the\nappendix.\nCorollary 8. The map (t, q, p) 7\u2212\u2192 (t, q, Qt0 (q, p)) is a C 1 diffeomorphism from ]0, \u03c3[\u00d7Rd \u00d7 Rd\u2217\nonto its image ]0, \u03c3[\u00d7Rd \u00d7 Rd .\nWe denote by \u03c10 (t, q0 , q1 ) the unique momentum p such that Qt0 (t, q0 , \u03c10 (t, q0 , q1 )) = q1 . In\nother words, \u03c10 (t, q0 , q1 ) is the initial momentum p(0) of the unique orbit (q(s), p(s)) : [0, t] \u2212\u2192\nRd \u00d7 Rd\u2217 of (HS) which satisfies q(0) = q0 and q(t) = q1 . By the Corollary we just proved,\nthe map \u03c10 is C 1 . Similarly, we denote by \u03c11 (t, q0 , q1 ) the unique momentum p such that\nQ0t (t, q1 , \u03c11 (t, q0 , q1 )) = q0 . We can equivalently define \u03c11 as\n\u03c11 (t, q0 , q1 ) = P0t (t, q0 , \u03c10 (t, q0 , q1 )).\nConsidering the geometric initial condition (\u03930 = {q0 } \u00d7 Rd\u2217 , w0 = 0), and the associated\ngeometric solution (G, w), we see that\nG = {(t, q, \u03c11 (t, q0 , q)),\n\n(t, q) \u2208]0, \u03c3[\u00d7Rd }.\n\nWe conclude from Corollary 6 that there exists a genuine solution of (HJ) emanating from the\ngeometric initial condition ({q0 } \u00d7 Rd\u2217 , 0). We denote by S t (q0 , q) this solution. We have\nS t (q0 , q) = w(t, p, \u03c11 (t, q0 , q))\nand\n\u2202q S t (q0 , q) = \u03c11 (t, q0 , q).\nIn view of the definition of geometric solutions, the function S can be written more explicitly\nZ t\nS t (q0 , q1 ) =\nP0s (q0 , \u03c10 (t, q0 , q1 ))Q\u0307s0 (q0 , \u03c10 (t, q0 , q1 )) \u2212 H(s, \u03c6s0 (q0 , \u03c10 (t, q0 , q1 ))ds.\n0\n\nIn words, S t (q0 , q1 ) is the action of the unique trajectory (q(s), p(s)) : [0, t] \u2212\u2192 Rd \u00d7 Rd\u2217 of (HS)\nwhich satisfies q(0) = q0 and q(t) = q1 .\nWe have defined the function S t (q0 , q1 ) as the action of the unique orbit joining q0 and\nq1 between time 0 and t. We can define similarly the function S\u03c4t (q0 , q1 ) as the action of the\nunique orbit joining q0 to q1 between time \u03c4 and time t, all this being well-defined provided\n0 < t \u2212 \u03c4 < \u03c3. It is possible to prove as above that the function (s, q) 7\u2212\u2192 Sst (q, q1 ) solves the\nHamilton-Jacobi equation\n\u2202s u + H(t, q, \u2212\u2202q u) = 0,\non s < t, and that\n\u2202q S t (q, q1 ) = \u2202q S0t (q, q1 ) = \u2212\u03c10 (t, q, q1 ).\nConvention: We shall from now on denote by \u22020 S t the partial differential with respect to\nthe first variable (which in our notations is often q0 ), and by \u22021 S t the partial differential with\nrespect to the second variable (which in our notations is often q1 ).\nThe relations \u22020 S = \u2212\u03c10 , \u22021 S = \u03c11 , \u2202t S = \u2212H(t, q1 , \u03c11 ) = \u2212H(0, q0 , \u03c10 ) that we have proved\nimply that the function S is C 2 . Moreover, since \u03c6t0 (q0 , \u03c10 (t, q0 , q1 )) = (q1 , \u03c11 (t, q0 , q1 ), we have\n\u03c6t0 (q0 , \u2212\u22020 S(q0 , q1 )) = (q1 , \u22021 S t (q0 , q1 )).\nWe say that S t is a generating function of the flow map \u03c6t0 . See [17], chapter 9, for more\nmaterial on generating functions. It is useful to estimate the second differentials of S:\n10\n\n\fLemma 9. The function S is C 2 on ]0, \u03c3[\u00d7Rd \u00d7 Rd , and the estimates\nc\n2 t\n\u220200\nS > I\nt\n\n,\n\nc\n2 t\n\u220211\nS > I\nt\n\n2 t\n2 t\n2 t\nk\u220200\nS k + k\u220201\nS k + k\u220201\nS k6\n\nC\nt\n\nhold, with constants c and C which depend only on m and M .\nProof. Let us first observe that\n\u0001\n\u0001\u22121\n2 t\n\u220211\nS (q0 , q1 ) = \u2202p P0t (q0 , \u03c10 (t, q0 , q1 ) \u2202p Qt0 (q0 , \u03c10 (t, q0 , q1 )) ,\nand recall the estimates:\nk\u2202p P0t \u2212 Idk 6 2M t,\n\nk\u2202p Qt0 k 6 2M t,\n\n\u2202p Qt0 > (mt/2)Id.\n\nWe conclude that (see Lemma 52)\n(\u2202p Qt0 )\u22121 >\n\nm\nId\n8M 2 t\n\n,\n\nk(\u2202p Qt0 )\u22121 k 6 2/(mt).\n\nFinally, we obtain that\n2\n\u220211\nS(q0 , q1 )\n\n\u0012\n>\n\nm\n4M\n\u2212\n8M 2 t\nm\n\n\u0013\nId >\n\nm\nId\n16M 2 t\n\nprovided t 6 m2 /(64M 3 ). The other estimates can be proved similarly, using the expressions\n\u0001\n\u0001\u22121\n2 t\n\u220200\nS (q0 , q1 ) = \u2212 \u2202p Pt0 (q1 , \u03c11 (t, q0 , q1 ) \u2202p Q0t (q1 , \u03c11 (t, q0 , q1 )) ,\n\u0001\u22121\n2 t\n\u220210\nS (q0 , q1 ) = \u2202p Qt0 (q0 , \u03c10 (t, q0 , p0 ))\n.\n\nProposition 10. Given times t1 and t2 such that 0 < t1 < t2 < \u03c3, we have the triangle\ninequality\nS0t2 (q0 , q2 ) 6 S0t1 (q0 , q1 ) + Stt12 (q1 , q2 )\n\u0001\nfor each q0 , q1 , q2 . Moreover, S0t2 (q0 , q2 ) = minq S0t1 (q0 , q) + Stt12 (q, q2 ) .\nProof. Let us consider the map\nq 7\u2212\u2192 f (q) = S0t1 (q0 , q) + Stt12 (q, q2 ).\nWe have d2 f > 2c hence the map f is convex. Now let us denote by (q(s), p(s)) : [0, t2 ] \u2212\u2192\nRd \u00d7 Rd\u2217 the unique orbit which satisfies q(0) = q0 and q(t2 ) = q2 . We can compute\ndf (q(t1 )) = \u22021 S0t1 (q0 , q(t1 )) + \u22020 Stt12 (q(t1 ), q2 ) = p(t1 ) \u2212 p(t1 ) = 0.\nThe point q(t1 ) is thus a critical point of the convex function f , hence it is a minimum of this\nfunction. We conclude that\nS0t1 (q0 , q) + Stt12 (q, q2 ) > S0t1 (q0 , q(t1 )) + Stt12 (q(t1 ), q2 ) = S0t2 (q0 , q2 )\nfor all q.\nUnder the convexity hypothesis 2, Theorem 1 can be extended to C 1 solutions:\n11\n\n\fTheorem 3. Let \u03a9 \u2282 R \u00d7 Rd be an open set, and let u(t, q) : \u03a9 \u2212\u2192 R be a C 1 solution of the\nHamilton Jacobi equation (HJ). Let q(t) : [t0 , t1 ] \u2212\u2192 Rd be a C 1 curve such that (t, q(t)) \u2208 \u03a9\nand\n\u0001\nq\u0307(t) = \u2202p H q(t), \u2202q u(t, q(t))\nfor each t \u2208 [t0 , t1 ]. Then, setting p(t) = \u2202q u(t, q(t)), the curve (q(t), p(t)) solves (HS).\nProof. As in the proof of Theorem 1, we consider a variation q(t, s) = q(t) + s\u03b8(t) of q(t),\nwhere \u03b8 is smooth and vanishes on the endpoints. We choose the vertical variation p(t, s) in\nsuch a way that the equation\nq\u0307(t, s) = \u2202p H(t, q(t, s), p(t, s))\nholds. The map p(t, s) defined by this relation is differentiable in s, because q and q\u0307 are and\n2 H is invertible. It is also useful to consider the other vertical variation\nbecause the matrix \u2202pp\nP (t, s) := \u2202q u(t, q(t, s)).\nOur hypothesis is that q\u0307(t) = \u2202p H(t, q(t), p(t)), which is the first part of (HS). We start as in\nthe proof of Theorem 1 with the following equality:\n\u0012Z t1\n\u0013\nd\np(t, s) * q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))dt = 0.\n(2)\nds s=0\nt0\nWe deduce this equality from the observation that s = 0 is a local minimum of the function\nZ t1\ns 7\u2212\u2192 F (s) :=\np(t, s) * q\u0307(t, s) \u2212 H(t, q(t, s), p(t, s))dt.\nt0\n\nThis claim follows from the equality\nZ\n\nt1\n\nF (0) = u(t1 , q(t1 )) \u2212 u(t0 , q(t0 )) =\n\nP (t, s) * q\u0307(t, s) \u2212 H(t, q(t, s), P (t, s))ds,\nt0\n\nwhich holds for all s, and from the inequality\nZ t1\nF (s) >\nP (t, s) * q\u0307(t, s) \u2212 H(t, q(t, s), P (t, s))ds\nt0\n\nwhich results, in view of the convexity of H, from the computation\nH(t, q(t, s), P (t, s)) > (P (t, s) \u2212 p(t, s)) * \u2202p H(t, q(t, s), p(t, s)) + H(t, q(t, s), p(t, s))\n> (P (t, s) \u2212 p(t, s)) * q\u0307(t, s) + H(t, q(t, s), p(t, s)).\nWe have proved (2). As in the proof of Theorem 1, we develop the left hand side and, after a\nsimplification, we get\nZ t1\np(t) * \u03b8\u0307(t) \u2212 \u2202q H(t, q(t), p(t)) * \u03b8(t) dt = 0.\nt0\n\nIn other words, we have proved that \u1e57(t) = \u2202q H(t, q(t), p(t)) in the sense of distributions. Since\nthe right hand side is continuous, p is C 1 and the equality holds in the genuine sense.\nAs in the C 2 case, we have the following corollary, see [12]:\n\n12\n\n\fCorollary 11. Let u(t, q) :]t0 , t1 [\u00d7Rd \u2212\u2192 R be a C 1 solution of (HJ). Then, for each s and t\nin ]t0 , t1 [ we have\n\u0393t = \u03c6ts (\u0393s ),\nwhere \u0393t is defined by\n\u0393t := {(q, dut (q)) : q \u2208 Rd }.\nProof. This corollary follows from Theorem 3 in the same way as Corollary 3 follows from\nTheorem 1. The only difference here is that the map\nF (t, q) := \u2202p H(t, q, \u2202q u(t, q))\nis only continuous. By the Cauchy-Peano Theorem, this is sufficient to imply the existence of solutions to the associated differential equation, which is what we need to develop the argument.\nA last property of the functions S will be useful. Assume that we are considering a family\nH\u03bc , \u03bc \u2208 I of Hamiltonians, where I \u2282 R is an interval, such that the whole function H(\u03bc, t, q, p)\nis C 2 and such that each of the Hamiltonians H\u03bc satisfy our hypotheses 1 and 2, with uniform\nconstants m and M . Then, for each value of \u03bc, we have the function S t (\u03bc; q0 , q1 ), which is\ndefined for t \u2208]0, \u03c3], the bound \u03c3 > 0 being independent of \u03bc. Since everything we have done\nso far was based on the local inversion theorem, the function S t (\u03bc; q0 , q1 ) is C 1 in \u03bc, or more\nprecisely the function (\u03bc, t, q0 , q1 ) 7\u2212\u2192 S t (\u03bc; q0 , q1 ) is C 1 . Moreover, a computation similar to\nthe proof of Proposition 1 yields\nZ t\nt\n\u2202\u03bc S (\u03bc; q0 , q1 ) = \u2212\n\u2202\u03bc H\u03bc (s, q(\u03bc, s), p(\u03bc, s))ds,\n0\n\nwhere s 7\u2212\u2192 (q(\u03bc, s), p(\u03bc, s)) is the only H\u03bc -trajectory satisfying q(\u03bc, 0) = q0 and q(\u03bc, t) = q1 .\nWe can exploit this remark when H\u03bc is the linear interpolation H\u03bc = H0 + \u03bc(H1 \u2212 H0 ) between\ntwo Hamiltonians H0 and H1 , and conclude the important monotony property:\nH0 6 H1\n\n2.1\n\n\u21d2\n\nS t (0; q, q 0 ) > S t (1; q, q 0 ).\n\n(Monotone)\n\nExercise :\n\nIf H(t, q, p) = h(p) is a function of p, then\nS t (q0 , q1 ) = th\u2217\n\n\u0012\n\nq1 \u2212 q0\nt\n\n\u0013\n,\n\nwhere h\u2217 is the Legendre transform of h. As an example, when H(t, q, p) = a|p|2 /2, then\nS t (q0 , q1 ) =\n\n3\n\n1\n|q1 \u2212 q0 |2 .\n2ta\n\nExtension of the generating function: The minimal action.\n\nA classical problem consists in finding an orbit (q(t), p(t)) of the Hamiltonian system such that\nq(t0 ) = q0 and q(t1 ) = q1 , for given [t0 , t1 ] \u2282 R, q0 , q1 \u2208 Rd . We have seen, under Hypotheses 1\nand 2, that this problem has a unique solution provided t0 < t1 < t0 + \u03c3, where \u03c3 is a constant\ndepending only on m an M . The situation is more subtle for larger values of t1 \u2212 t0 . In order\nto study it, it is useful to consider the function\nt/n\n\n2t/n\n\nt\nS : (\u03b81 , . . . , \u03b8n\u22121 ) 7\u2212\u2192 S0 (q0 , \u03b81 ) + St/n (\u03b81 , \u03b82 ) + * * * + S(n\u22121)t/n\n(\u03b8n\u22121 , q1 ),\n\nwhere we have taken t0 = 0 and t1 = t to simplify notations, and where n is an integer such\nthat t/n 6 \u03c3. The critical points of S are in one to one correspondence with the solutions of\nour problem:\n13\n\n\fLemma 12. The point (\u03b81 , . . . , \u03b8n\u22121 ) is a critical point of S if and only if there exists an\norbit (q(s), p(s)) : [0, t] \u2212\u2192 Rd \u00d7 Rd\u2217 such that q(0) = q0 , q(t) = q1 , and q(it/n) = \u03b8i for\ni = 1, . . . , n \u2212 1. This orbit is then unique, and its action is S(\u03b81 , . . . , \u03b8n\u22121 ).\nProof. Let (q(s), p(s)) be the piecewise orbit defined on [it/n, (i + 1)t/n] by the constraints\nq(it/n) = \u03b8i and q((i + 1)t/n) = \u03b8i+1 . The action of this piecewise orbit is S(\u03b81 , * * * , \u03b8n\u22121 ). The\nstatement follows from the simple computation\n\u2202\u03b8i S = \u22021 S t/n (\u03b8i\u22121 , \u03b8i ) + \u22020 S t/n (\u03b8i , \u03b8i+1 ) = p\u2212 (it/n) \u2212 p+ (it/n).\nUsing this finite dimensional variational functional is usually called the method of broken\ngeodesics, see [9]. The function S can be minimized under additional assumptions, for example:\nHypothesis 3.\nm 2\nM 2\n|p| \u2212 M 6 H(t, q, p) 6\n|p| + M.\n2\n2\nBy exploiting the monotony property (Monotone), this hypothesis implies that\n1\n1\n|q1 \u2212 q0 |2 \u2212 M t 6 S t (q0 , q1 ) 6\n|q1 \u2212 q0 |2 + M t,\n2tM\n2tm\nand then that\nS(\u03b81 , . . . , \u03b8n\u22121 ) >\n\nn\n(|\u03b81 \u2212 q0 |2 + |\u03b82 \u2212 \u03b81 |2 + * * * + |q1 \u2212 \u03b8n\u22121 |2 ) \u2212 M t.\n2tM\n\nAs a consequence, the function S is coercive and C 2 , hence it has a minimum. Notice that,\nalthough S is convex separately in each of its variables, it is not jointly convex. It can have\ncritical points which are not minima, and it can have several different minima. We denote by\nAt the value function\n\u0001\nt/n\n2t/n\nt\nAt (q0 , q1 ) = min S =\nmin\nS0 (q0 , \u03b81 ) + St/n (\u03b81 , \u03b82 ) + S(n\u22121)t/n\n(\u03b8n\u22121 , q1 )\n(A)\n\u03b81 ,\u03b82 ,...\u03b8n\u22121\n\nwhere n is any integer such that t/n < \u03c3. The functions At\u03c4 (q0 , q1 ) are defined similarly for each\nt > \u03c4. This notation is legitimate in view of the following:\nLemma 13. The value of At does not depend on n provided t/n < \u03c3. Moreover, we have\n1\n1\n|q1 \u2212 q0 |2 \u2212 M t 6 At (q0 , q1 ) 6\n|q1 \u2212 q0 |2 + M t.\n2M t\n2tm\nThis statement implies that At = S t when t < \u03c3 : At can be seen as an extension of S t\nbeyond t = \u03c3.\nProof. Since we have not yet proved the independence of n, we temporarily denote by\nAt (q0 , q1 ; n) the value of the minimum. We have\n\u0011\n\u0010 n\n\u0001\nAt (q0 , q1 ; n) >\nmin\n|\u03b81 \u2212 q0 |2 + * * * + |q1 \u2212 \u03b8n\u22121 |2 \u2212 M t\n\u03b81 ,\u03b82 ,...\u03b8n\u22121 2M t\n1\n=\n|q1 \u2212 q0 |2 \u2212 M t.\n2M t\nIf t < \u03c3, then the equality S t (q0 , q1 ) = At (q0 , q1 ; n) can be proved by recurrence for each n using\nProposition 10. For general t, let us prove that At (n) is independent of n. We take two integers\n\n14\n\n\fn and m such that t/n < \u03c3, t/m < \u03c3 and want to prove that At (n) = At (m). We will prove that\nAt (n) = At (nm) = At (m). Since t/m < \u03c3, we have\nA\u03c4\u03c4 +t/m (q0 , q1 ; n) = S\u03c4\u03c4 +t/m (q0 , q1 )\nfor each \u03c4 and n, hence\nAt (q0 , q1 ; nm) =\n\nmin\n\n\u03b81 ,\u03b82 ,...\u03b8nm\u22121\n\nh\nt/nm\n2t/mn\nt/m\nS0\n(q0 , \u03b81 ) + St/nm (\u03b81 , \u03b82 ) + * * * + S(n\u22121)t/nm (\u03b8n\u22121 , \u03b8n )\n\n(n+1)t/nm\n\n+ St/m\n\n2t/m\n\n(\u03b8n , \u03b8n+1 ) + * * * + S(2n\u22121)t/nm (\u03b82n\u22121 , \u03b82n )\n\n+ ***\n(m\u22121)t/m+t/nm\n\n+ S(m\u22121)t/m\n=\n\nmin\n\nh\n\n\u03b82n ,\u03b83n ,...,\u03b8(m\u22121)n\n\ni\nt\n(\u03b8mn\u22121 , q1 )\n(\u03b8(m\u22121)n , \u03b8(m\u22121)n+1 ) + * * * + S(1\u22121/nm)t\n\nt/m\n\nS0\n\n2t/m\n\nt\n(\u03b8(m\u22121)n , q1 )\n(q0 , \u03b8n ) + St/m (\u03b8n , \u03b82n ) + * * * + S(m\u22121)t/m\n\ni\n\n= At (q0 , q1 ; m).\nWe have proved that At (nm) = At (m), by symmetry we also have At (nm) = At (n) hence\nAt (n) = At (m). Finally, we have\nS(\u03b81 , . . . , \u03b8n\u22121 ) 6\n\n\u0001\nn\n|\u03b81 \u2212 q0 |2 + |\u03b82 \u2212 \u03b81 |2 + |q1 \u2212 \u03b8n\u22121 |2 + M t\n2mt\n\nhence\nAt (q0 , q1 ) 6\n=\n\nmin\n\n\u03b81 ,\u03b82 ,...\u03b8n\u22121\n\n\u0001\nn\n|\u03b81 \u2212 q0 |2 + |\u03b82 \u2212 \u03b81 |2 + |q1 \u2212 \u03b8n\u22121 |2 + M t\n2mt\n\n1\n|q1 \u2212 q0 |2 + M t.\n2mt\n\nThe following property concerning A follows easily from the definition :\n\u0001\nAtt20 (q0 , q2 ) = min Att10 (q0 , q1 ) + Att21 (q1 , q2 ) ,\nq1\n\n(T)\n\nwhen 0 6 t0 6 t1 6 t2 . The following consequence of Hypothesis 3 will also be useful:\nLemma 14.\np * \u2202p H(t, q, p) \u2212 H(t, q, p) >\n\nm\nH(t, q, p) \u2212 (m + M ).\nM\n\nProof. We deduce from Hypothesis 2 that\nH(t, q, 0) > H(t, q, p) \u2212 p * \u2202p H(t, q, p) +\n\nm 2\n|p| .\n2\n\nWe deduce that\np * \u2202p H(t, q, p) \u2212 H(t, q, p) >\n\nm 2\nm\n|p| \u2212 H(t, q, 0) >\n(H(t, q, p) \u2212 M ) \u2212 M\n2\nM\n\nThe minimal action At (q0 , q1 ) is not necessarily C 1 , we need some definitions before we can\nstudy its regularity. The linear form l is called a K-super-differential of the function u at point\nq if the inequality\nu(\u03b8) 6 u(q) + l(\u03b8 \u2212 q) + K|\u03b8 \u2212 q|2\n15\n\n\fholds in a neighborhood of q. The linear form l is a proximal super-differential of u at point q\nif it is a K-super-differential for some K. The form l is a proximal super-differential of u at q if\nand only if there exists a C 2 function v such that dv(q) = l and such that the difference v \u2212 u\nhas a minimum at q. More generally, we will say that l is a super-differential of u at q if there\nexists a C 1 function v such that dv(q) = l and such that the difference v \u2212 u has a minimum at\nq. A super-differential is not necessarily a proximal super-differential.\nA function u : Rd \u2212\u2192 R is called K-semi-concave if it admits a K-super-differential at each\npoint. It is equivalent to require that the function \u03b8 7\u2212\u2192 u(\u03b8) \u2212 K|\u03b8|2 is concave. A function is\ncalled semi-concave if it is K-semi-concave for some K. If u is a K-semi-concave function, and\nif l is a super-differential at u, then the inequality\nu(\u03b8) 6 u(q) + l(\u03b8 \u2212 q) + K|\u03b8 \u2212 q|2\nholds for each \u03b8. In particular, l is a K-super-differential.\nLemma 15. The function At is C(1 + 1/t)-semi-concave, with some constant C which depends\nonly on m and M .\nProof. Let us first assume that t \u2208]0, \u03c3[. In this case, At0 = S0t , this function is C 2 and its\nsecond derivative was estimated in Lemma 9. Let us now assume that t > \u03c3. Then, there exists\nn \u2208 N such that t/n \u2208 [\u03c3/3, \u03c3/2[. We have\n\u0001\nt/n\nt\u2212t/n\nt\nAt0 (q, q 0 ) = min0 S0 (q, \u03b8) + At/n (\u03b8, \u03b80 ) + St\u2212t/n\n(\u03b80 , q 0 ) .\n\u03b8,\u03b8\n\nConsidering a minimizing pair (\u03b80 , \u03b81 ) in the expression above at (q0 , q1 ), we see that the C 2\nfunction\nt/n\nt\u2212t/n\nt\n(q, q 0 ) 7\u2212\u2192 S0 (q, \u03b80 ) + At/n (\u03b80 , \u03b81 ) + St\u2212t/n\n(\u03b81 , q 0 )\nis touching from above the function At0 at point (q0 , q1 ). In view of Lemma 9, this provides a\nuniform (for t > \u03c3) semi-concavity constant for At0 .\n\n4\n\nThe Lax-Oleinik operators.\n\nGiven t0 < t1 , we define the Lax-Oleinik operators Ttt10 and \u0164tt01 which, to each function u :\nRd \u2212\u2192 R associate the functions\n\u0001\n\u0001\nTtt10 u(q) := inf u(\u03b8) + Att10 (\u03b8, q) , \u0164tt01 u(q) := sup u(\u03b8) \u2212 Att10 (q, \u03b8) .\n\u03b8\u2208Rd\n\n\u03b8\u2208Rd\n\nWe have the Markov (or semi-group) property:\nTtt21 \u25e6 Ttt10 = Ttt20\n\n,\n\n\u0164tt01 \u25e6 \u0164tt12 = \u0164tt02\n\nfor t0 < t1 < t2 . Note however that Ttt10 \u25e6 \u0164tt01 and \u0164tt01 \u25e6 Ttt10 are not the identity. Concerning\nthese operators, we only have the inequalities\n\u0164tt01 \u25e6 Ttt10 (u) 6 u\n\n,\n\nTtt10 \u25e6 \u0164tt01 (u) > u,\n\nthe easy proof of which is left to the reader. Each property concerning the Lax-Oleinik operator\nT has a counterpart for the dual operator \u0164, that we will not always bother to state, but\nnever hesitate to use. The family of operators Ttt10 is characterized by the fact that Ttt10 u(q) =\n\u0001\ninf \u03b8 u(\u03b8) + Stt01 (q0 , q1 ) when t0 6 t1 6 t0 + \u03c3 and by the Markov property. The Lax-Oleinik\noperators solve (HJ) in various important ways, that will be detailed in the present section. It\nis useful first to settle some regularity issues.\n16\n\n\fLemma 16. There exists a constant C, depending only on m and M such that, for each t \u2208]0, \u03c3],\nthe function Tt u is (C/t)-semi-concave provided it is finite at each point.\nProof. The function Tt u is the infimum of the functions f = u(\u03b8) + S t (\u03b8, .), which are C 2 with\nthe uniform bound kd2 f k 6 C/t. It is then an easy exercise to conclude that the function Tt u\nis C/t-semi-concave, see Lemma 54.\nGiven an arbitrary function u0 , the infimum in the definition of Tt0 u0 is not necessarily finite,\nand, even if it is finite, it is not necessarily a minimum. It is clear from Proposition 13 that the\ninfimum is a finite minimum under the assumption that u0 is continuous and Lipschitz in the\nLarge, which means that there exists a constant k such that\nu0 (q 0 ) \u2212 u0 (q) 6 k(1 + |q 0 \u2212 q|)\nfor each q and q 0 .\nLemma 17. If u0 is Lipschitz in the large, then so are the functions Tt0 u0 for all t > 0.\nThe function (t, q) 7\u2212\u2192 u(t, q) = Tt0 u0 (q) is locally semi-concave, hence locally Lipschitz on\n]0, \u221e) \u00d7 Rd . The function u solves (HJ) at all its points of differentiability (hence almost\neverywhere).\nProof. Since u0 is Lipschitz in the large, the function Tt0 u0 \u2212 u0 is bounded for each t > 0, as\nfollows from the inequalities\n\u0001\ninf u0 (q) \u2212 k \u2212 k|\u03b8 \u2212 q| + S t (\u03b8, q) 6 Tt0 u0 6 u0 (q) + S t (q, q)\n\u03b8\n\nwhich imply (setting \u2206 = \u03b8 \u2212 q) that\ninf\n\n\u2206\u2208Rd\n\n\u2212 k \u2212 k|\u2206| +\n\n\u0001\n1\n|\u2206|2 \u2212 tM 6 Tt0 u0 (q) \u2212 u0 (q) 6 M t.\n2tM\n\nWe conclude that the function Tt0 u0 = (Tt0 u0 \u2212 u0 ) + u0 is Lipschitz in the large. In the\ncomputations above, we also see that the infimum can be taken on |\u2206| 6 K, where K is a\nconstant independent from q.\nLet us now prove that the function u(t, q) := Tt0 u0 (q) is locally Lipschitz on t > 0. In view\nof the Markov property, it is enough to prove that the function u is Lipschitz on ]\u03c4, \u03c3/2[\u00d7B for\neach closed ball B \u2282 Rd and each time \u03c4 \u2208]0, \u03c3/2[. Since u(q) is Lipschitz in the large, there\nexists a radius R > 0 such that\nu(t, q) = inf u(\u03b8) + S t (\u03b8, q)\n|\u03b8|6R\n\nfor (t, q) \u2208]\u03c4, \u03c3/2[\u00d7B. Since S is C 2 , the functions (t, q) 7\u2212\u2192 u(\u03b8)+S t (\u03b8, q), |\u03b8| 6 R have uniform\nC 2 bounds on ]\u03c4, \u03c3/2[\u00d7B. Their infimum u(t, q) is then semi-concave, hence Lipschitz on that\nset, see Lemma 54.\nFinally, let (t, q) be a point of differentiability of u, and let \u03c4 \u2208] max(0, t \u2212 \u03c3), t[ be given.\nSince u\u03c4 is Lipschitz in the large and locally Lipschitz, there exists \u03b8 such that Tt\u03c4 u\u03c4 (q) =\nu\u03c4 (\u03b8) + S\u03c4t (\u03b8, q). For a different point (s, y), we have Ts\u03c4 u\u03c4 (y) 6 u\u03c4 (\u03b8) + S\u03c4t (\u03b8, y), hence the\nfunction (s, y) 7\u2212\u2192 u(s, y) \u2212 S\u03c4s (\u03b8, y) has a maximum at (t, q), which implies that the functions\nu(s, y) and S\u03c4s (\u03b8, y), each of which is differentiable at (t, q), have the same differential at (t, q).\nSince the functions (s, y) 7\u2212\u2192 S\u03c4s (\u03b8, y) solves (HJ), the function u also solves (HJ) at (t, q).\nLet us now establish the relation of our operators with regular solutions.\n17\n\n\fProposition 18. Let u(t, q) :]t0 , t1 [\u00d7Rd \u2212\u2192 R be a C 1 solution of HJ, then Tt\u03c4 u\u03c4 = ut and\n\u0164\u03c4t ut = u\u03c4 for each \u03c4 6 t in ]t0 , t1 [. The function u is locally C 1,1 .\nThis property is one of the main motivations to introduce the Lax-Oleinik operators. The\nobservation that C 1 solutions are actually locally C 1,1 comes Fathi's paper [12], itself inspired\nby anterior works of Herman. Another consequence of this Theorem is that uniqueness extends\nto C 1 solutions under the convexity assumption.\nProof. In view of the Markov property, it is enough to prove the result for 0 < t \u2212 \u03c4 < \u03c3.\nGiven q and \u03b8 in Td , we consider the unique orbit (q(s), p(s)) such that q(\u03c4 ) = \u03b8 and q(t) = q.\nBy the convexity of H, we have\nH(q(s), \u2202q u(s, q(s))) > H(q(s), p(s)) + (\u2202q u(s, q(s)) \u2212 p(s)) * \u2202p H(s, q(s), p(s)).\nNoticing that q\u0307(s) = \u2202p H(s, q(s), p(s)) and integrating gives:\nS\u03c4t (\u03b8, q) =\n\nZ\n\nt\n\np(s) * q\u0307(s) \u2212 H(s, q(s), p(s))ds\n\u03c4\n\nZ\n\nt\n\n\u2202q u(s, q(s)) * q\u0307(s) \u2212 H(s, q(s), \u2202q u(s, q(s)))ds\n\n>\n\u03c4\n\n= u(t, q) \u2212 u(\u03c4, \u03b8),\nwith equality if p(s) = \u2202q u(s, q(s)) for each s. We conclude that\nTt\u03c4 u\u03c4 (q) > ut (q),\nwith equality if there exists an orbit (q(s), p(s)) : [\u03c4, t] \u2212\u2192 Rd \u00d7Rd\u2217 such that p(s) = \u2202q u(s, q(s))\nand q(t) = q. By Corollary 11, the orbit of the point (q, \u2202q u(t, q)) satisfies this property, hence\nthe equality holds.\nTo prove the regularity of u we consider a subinterval [t\u03030 , t\u03031 ] \u2282]t0 , t1 [, and prove that u is\nlocally C 1,1 on ]t\u03030 , t\u03031 [. We have\nu(t, q) = Ttt\u03030 ut\u03030 (q) = \u0164t\u0303t1 ut\u03031 (q)\nfor each t \u2208]t\u03030 , t\u03031 [. If the functions ut were Lipschitz in the Large, we could apply Lemma\n17 and deduce that u is both locally semi-concave and locally semi-convex, hence locally C 1,1 ,\non ]t\u03030 , t\u03031 [\u00d7Rd . Here we do not make any growth assumption, so we need a slightly different argument to prove the semi-concavity of u (and, similarly, its semi-convexity). We have\nseen that the infimum in the definition Ttt\u0303 ut\u03030 (q) is a minimum, which is attained at the point\n0\n\n\u03b8 = Qt\u0303t0 (q, \u2202q u(t, q)). This gives us an a priori bound on \u03b8, and we can continue the proof as in\nLemma 17.\nLet us sum up some properties of the Lax-Oleinik operators Tt\u03c4 associated to a Hamiltonian\nsatisfying hypotheses 1,2,3:\nProperty 19.\n1. Markov property: Tts \u25e6 Ts\u03c4 = Tt\u03c4 when \u03c4 6 s 6 t.\n2. Monotony: u > v \u21d2 Tt\u03c4 u > Tt\u03c4 v for each t > \u03c4 .\n3. Compatibility with (HJ): If u(t, q) :]t0 , t1 [\u00d7Rd \u2212\u2192 R is a C 2 solution of (HJ), then Tt\u03c4 u\u03c4 =\nut when t0 < \u03c4 < t < t1 .\n18\n\n\f4. Boundedness: If u\u03c4 is Lipschitz in the large, then the functions Tt\u03c4 u\u03c4 , t \u2208 [\u03c4, T ] are\nuniformly Lipschitz in the large for each T > \u03c4 .\n5. Regularity: If u\u03c4 is Lipschitz in the large, the function (t, q) 7\u2212\u2192 Tt\u03c4 u\u03c4 (q) is locally Lipschitz\non ]\u03c4, \u221e) \u00d7 Rd .\n6. Translation invariance: Tt\u03c4 (c + u) = c + Tt\u03c4 u for each constant c \u2208 R.\nThe Lax-Oleinik operators solve the Cauchy problem for (HJ) in the viscosity sense. Actually,\nthis follows from Property 19:\nProposition 20. Let H be a Hamiltonian satisfying Hypothesis 1. Assume that there exists a\nfamily Tt\u03c4 , 0 6 \u03c4 6 t of operators satisfying the Markov property, the monotony, the compatibility\nwith (HJ), and the boundedness as expressed in Property 19. Then if u0 is an initial condition\nwhich is Lipschitz in the large, the function\n(t, q) 7\u2212\u2192 u(t, q) = Tt0 u0 (q)\nis a viscosity solution of (HJ) on ]0, \u221e) \u00d7 Rd .\nNotice that we did not make any convexity assumption. This kind of axiomatic characterization of viscosity solutions is reminiscent from [1], see also [8]. It may also help to understand\nthe links between viscosity solutions and variational solutions in the non-convex setting. Such\nlinks were suggested by Claude Viterbo and established in her thesis by Qiaolin Wei, [20].\nProof of Proposition 20: Let us prove that u is a viscosity sub-solution, a similar proof\nyields that it is also a super-solution. We consider a point (T, Q) \u2208]0, \u221e) \u00d7 Rd and a superdifferential (h, p) of the function u at (T, Q). To prove that h + H(T, Q, p) 6 0, we assume, by\ncontradiction, that\nh + H(T, Q, p) > 0.\nAs is usual for viscosity solutions we will use a test function \u03c6. We will assume that \u03c6 : R\u00d7Rd \u2212\u2192\nR is smooth and satisfies the following properties:\n\u2022 \u03c6(T, Q) = u(T, Q),\n\n\u2202t \u03c6(T, Q) = h,\n\n\u2202q \u03c6(T, Q) = p,\n\n\u2022 \u03c6 > u on [\u2212T /2, 2T ] \u00d7 Rd ,\n\u2022 There exists a constant C > 0 such that \u03c6(t, q) = C\n\np\n1 + |q|2 when |q| + |t| > C.\n\nNote that d2 \u03c6 is bounded. Such a test function exists because the functions ut , t \u2208 [T /2, 2T ],\nare uniformly Lipschitz in the large, as follows from the boundedness property assumed on the\noperators.\nClaim: There exists S > 0 and a C 2 function w(\u03c4, t, q) defined on the open set\n\b\n(\u03c4, t, q) \u2208 R \u00d7 R \u00d7 Rd : \u03c4 \u2212 S < t < \u03c4 + S \u2282 R \u00d7 R \u00d7 Rd\nsuch that, for each fixed \u03c4 , the function w\u03c4 : (t, q) 7\u2212\u2192 w(\u03c4, t, q) is the solution of the Cauchy\nproblem\n\u001a\n\u2202t w\u03c4 + H(t, q, \u2202q w\u03c4 ) = 0\nw\u03c4 (\u03c4, q) = \u03c6(\u03c4, q).\nThe existence of a solution w\u03c4 to this problem follows from Theorem 2. However, to see that w\nis C 2 in all its variables, we find it more convenient to consider the Cauchy problem\n\u0010\n\u0011\n(\n\u2202s u + \u2202z u + H(z, q, \u2202q u(s, z, q)) = 0\nu(0, z, q) = \u03c6(z, q).\n19\n\n\fBy Theorem 2, applied to the Hamiltonian\n\u0124(s, z, q, \u03be, p) : R \u00d7 (R \u00d7 Rd ) \u00d7 (R \u00d7 Rd )\u2217 \u2212\u2192 R\n(s, z, q, \u03be, p) 7\u2212\u2192 \u03be + H(z, q, p)\nthere exists S > 0 and a C 2 solution u(s, z, q) :] \u2212 S, S[\u00d7R \u00d7 Rd \u2212\u2192 R of this Cauchy problem.\nSetting\nw(\u03c4, t, q) := u(t \u2212 \u03c4, t, q),\nwe verify that\n\u2202t w(t, q) + H(t, q, \u2202q w(t, q)) = \u2202s u(t \u2212 \u03c4, t, q) + \u2202z u(t \u2212 \u03c4, t, q) + H(t, q, \u2202q u(t \u2212 \u03c4, t, q)) = 0\nand that w(\u03c4, \u03c4, q) = u(0, \u03c4, q) = \u03c6(\u03c4, q).\nClaim : There exists \u03c4 \u2208]T \u2212 S, T [ such that w(\u03c4, T, Q) < \u03c6(T, Q).\nSince w(T, T, q) = \u03c6(T, q), we have\n\u2202t w(T, T, Q) = \u2212H(T, Q, \u2202q w(T, Q)) = \u2212H(T, Q, \u2202q \u03c6(T, Q)) < \u2202t \u03c6(T, Q).\nAs a consequence, there exists \u03b4 > 0 such that\n\u2202t w(\u03c4, t, Q) \u2212 \u2202t \u03c6(t, Q) < 0\nfor \u03c4, t \u2208]T \u2212 \u03b4, T [. Since w(\u03c4, \u03c4, Q) = \u03c6(\u03c4, Q), we deduce by integration that\nZ T\nw(\u03c4, T, Q) \u2212 \u03c6(T, Q) =\n\u2202t w(\u03c4, t, Q) \u2212 \u2202t \u03c6(t, Q)dt < 0\n\u03c4\n\nprovided \u03c4 \u2208]T \u2212 \u03b4, T [, which proves our claim.\nConclusion : Since we are considering monotone operators compatible with (HJ) we have\nw(\u03c4, T, Q) = TT\u03c4 w\u03c4 (Q) = TT\u03c4 \u03c6\u03c4 (Q) > TT\u03c4 u\u03c4 (Q) = u(T, Q)\nhence \u03c6(T, Q) > u(T, Q), which is a contradiction.\nThis parenthesis through viscosity solutions being closed, let us turn our attention to more\ngeometric aspects of the Lax-Oleinik operators. We denote by \u0393u the graph of the differential\nof u on its domain of definition,\n\u0393u := {(q, du(q)) :\n\nq \u2208 Rd ,\n\ndu(q) exists}.\n\nProposition 21. Let u be a semi-concave and Lipschitz function. The set\n\u0010\n\u0011\n\u03c60t \u0393\u0304Tt0 u\nis contained in \u0393u for each t > 0, and it is a Lipschitz graph.\nProof. In view of the Markov property, it is enough to prove the result for t \u2208]0, \u03c3]. Let (q, p) be\na point of \u0393Tt0 u , which means that the function Tt0 u is differentiable at q and that d(Tt0 u)(q) = p.\nLet \u0398 be a minimizing point in the expression Tt0 u(q) = min\u03b8 u(\u03b8) + S0t (\u03b8, q). Since each of the\nfunctions u and S0t (., q) are semi-concave, this implies that they are both differentiable at \u0398,\nand that du(\u0398) + \u22020 S0t (\u0398, q) = 0. Moreover, this implies that the function u(\u0398) + S0t (\u0398, .)\ntouches the function Tt0 u from above at point q, hence that S0t (\u0398, .) is differentiable at q, with\na differential equal to p. We then have\n\u03c60t (q, p) = \u03c60t (q, \u22021 S0t (\u0398, q)) = (\u0398, \u2212\u22020 S0t (\u0398, q) = (\u0398, du(\u0398)) \u2282 \u0393u .\n20\n\n\fWe have proved that \u03c60t (\u0393Tt0 u ) \u2282 \u0393u . Moreover, we have Q0t (\u0393Tt0 u ) \u2282 I, where I \u2282 Rd is the\nset of points \u03b8 which are minimizing in the definition of Tt0 u(q) for some point q.\nClaim: The function u is C 1,1 on I. This means that u is differentiable at each point of I, and\nthat the map \u03b8 7\u2212\u2192 du(\u03b8) is Lipschitz on I. In other words, the projection of \u0393u to Rd contains\nI, and the set\n\u0393u|I := {(\u03b8, du(\u03b8), \u03b8 \u2208 I}\nis a Lipschitz graph.\nTo prove the claim, we first prove that u has C-super-differentials and C-sub-differentials at\neach point of I, where C is a common semi-concavity constant of all the functions \u2212S0t (., q) and\nof the function u. The existence of a C-super-differential follows from the C-semi-concavity of u.\nTo prove the existence of a C-sub-differential at a point \u0398 \u2208 I, we consider a point q such that\nu(\u0398) + S0t (\u0398, q) = T0t u(q). Such a point exists by definition of I. This implies that the function\n\u03b8 7\u2212\u2192 u(\u03b8) + S0t (\u03b8, q) has a minimum at \u03b8 = \u0398, hence each C-sub-differential of \u2212S0t (., q) is a\nC-sub-differential of u. The claim then follows from a result of Fathi, see Proposition 53 in the\nAppendix.\nLet now (q, p) be a point in the closure \u0393\u0304Tt0 u of \u0393Tt0 u . There exists a sequence (qn , pn ) of\npoints of \u0393Tt0 u which converges to (q, p). By definition, the function Tt0 u is differentiable at qn ,\nand pn = d(Tt0 u)(qn ). Let \u0398n = Q0t (qn , pn ) be the sequence of points such that\nTt0 u(qn ) = u(\u0398n ) + S0t (\u0398n , qn ).\nThe sequence \u0398n is converging to \u0398 = Q0t (q, p), and, at the limit, we see that\nTt0 u(q) = u(\u0398) + S0t (\u0398, q).\nWe conclude that \u0398 \u2208 I. Since we have already proved the Lipschitz regularity of du on I, we\ndeduce that \u03c60t (q, p) = lim(\u03c60t (qn , pn )) = lim(\u0398n , du(\u0398n )) = (\u0398, du(\u0398)) \u2208 \u0393u|I \u2282 \u0393u .\nThe action of the Lax-Oleinik operators on semi-convex functions also has a remarkable\nproperty, see [4]. It is useful to denote by Lu the set of point (Q, P ) such that P is a subdifferential of u at Q. Note that \u0393u \u2282 Lu .\nProposition 22. If u is K-semi-convex, then for each \u03b4 \u2208]0, 1[ there exists T > 0 such that\nTt0 u is (K + \u03b4)-semi-convex, hence C 1,1 , for each t \u2208]0, T ]. One can take\nT =\n\n\u03b4\n.\n2M (3 + 2K)2\n\nProof. Since u is K-semi-convex, for each (Q, P ) \u2208 Lu , we have\nu(q) > u(Q) + P (q \u2212 Q) \u2212 K|q \u2212 Q|2 .\nWe denote by lQ,P (q) the function on the right in this inequality, so that\nu=\n\nmax lQ,P .\n\n(Q,P )\u2208Lu\n\nTaking T as in the statement, it follows from Theorem 2 that the functions Tt0 (lQ,P ), t \u2208 [\u2212T, T ]\nare C 2 with a second derivative bounded by 2K + 4tM (1 + 2K)2 6 2K + 2\u03b4. We claim that\nTt0 u = max Tt0 (lQ,P ),\n(Q,P )\u2208L\n\n21\n\n\ffor t \u2208 [0, T ] \u2229 [0, \u03c3], which implies that Tt0 u is (K + 4tM (1 + 2K)2 )-semi-convex. We prove the\nclaim in two steps. First, the inequality\nTt0 u > max Tt0 (lQ,P )\n(Q,P )\u2208L\n\nfollows immediately from the fact that u > lQ,P for each (Q, P ) \u2208 L in view of the monotony\nof Tt0 , see Property 19. Let us fix a point (t, q) and prove the converse inequality at this point.\nSince\n1\nu(\u03b8) + S0t (\u03b8, q) > u(q) + P (\u03b8 \u2212 q) \u2212 K(\u03b8 \u2212 q)2 +\n|\u03b8 \u2212 q|2 \u2212 tM\n2tM\nand since K 6 1/2tM , there exists a point \u03b8 such that Tt0 u(q) = u(\u03b8) + S0t (\u03b8, q). Assuming that\nt 6 \u03c3, this implies that the point (\u03b8, \u03b6) = (\u03b8, \u2212\u22020 S0t (\u03b8, q)) belongs to Lu , and that q = Qt0 (\u03b8, \u03b6).\nThen, we have\nTt0 (l\u03b8,\u03b6 )(q) = l\u03b8,\u03b6 (\u03b8) + S0t (\u03b8, q) = u(\u03b8) + S0t (\u03b8, q) = Tt0 u(q)\nhence\nTt0 u(q) 6 max Tt0 (lQ,P )(q)\n(Q,P )\u2208L\n\nprovided t 6 \u03c3. We conclude that Tt0 u is semi-concave with constant K + 2tM (1 + 2K)2 for\nt \u2208 [0, \u03c3] \u2229 [0, T ]. We can then apply this result to T\u03c30 u, and, since K + tM (1 + 2K)2 6 K + 1,\nwe conclude that the function Tt\u03c3 T\u03c30 u is semi-concave with constant\nK + 2\u03c3M (1 + 2K)2 + 2tM (3 + 2K)2 6 K + 2(\u03c3 + t)M (3 + 2K)2 6 K + 1\nfor t \u2208 [0, \u03c3] \u2229 [0, T \u2212 \u03c3]. In other words, the functions Tt0 u are semi-concave with constant\nK + 2tM (3 + 2K)2 for t \u2208 [0, 2\u03c3] \u2229 [0, T ]. We can apply this argument as many times as\nnecessary and obtain that, the functions Tt0 u are semi-concave with constant K + 2tM (3 + 2K)2\nfor each t \u2208 [0, T ].\nThe following was first stated explicitly by Marie-Claude Arnaud in [2].\nAddendum 1. Under the hypotheses of Proposition 22, we have Lu = \u03c60t (\u0393Tt0 u ) for each\nt \u2208]0, T [. Moreover, for each q, we have Tt0 u(q) = u(\u03b8) + S0t (\u03b8, q), with \u03b8 = Q0t (q, d(Tt0 u)(q)).\nProof. For each q \u2208 Rd , we have seen that there exists (\u03b8, \u03b6) \u2208 Lu such that Tt0 u(q) =\nu(\u03b8) + S0t (\u03b8, q) and \u03b6 = \u2212\u22020 S0t (\u03b8, q). Since we know that Tt0 u is C 1 , the first of these equalities\nimplies that d(Tt0 u)(q) = \u22021 S0t (\u03b8, q), while the second implies that \u03c6t0 (\u03b8, \u03b6) = (q, \u22021 S0t (\u03b8, q)). We\nconclude that \u03c60t (\u0393Tt0 u ) \u2282 Lu . Moreover, \u03b8 = Q0t (q, d(Tt0 u)(q)).\nConversely, let us consider a point (\u03b8, \u03b6) \u2208 L, and denote by l the associated function l\u03b8,\u03b6 . By\nProposition 18, the function (t, q) 7\u2212\u2192 Tt0 l(q) is the restriction to ]0, T [\u00d7Rd of the C 2 solution\nof (HJ) emanating from l. As a consequence, we have\nTt0 l(Qt0 (\u03b8, \u03b6)) = l(\u03b8) + S0t (\u03b8, Qt0 (\u03b8, \u03b6)) = u(\u03b8) + S0t (\u03b8, Qt0 (\u03b8, \u03b6)) > Tt0 u(Qt0 (\u03b8, \u03b6)).\nSince we know from the monotony property that Tt0 l 6 Tt0 u, we conclude that this last inequality\nis actually an equality. Setting q1 = Qt0 (\u03b8, \u03b6), this implies that\n(\u03b8, \u03b6) = (\u03b8, \u2212\u22020 S0t (\u03b8, q1 )) = \u03c60t (q1 , \u22021 S0t (\u03b8, q1 )) = \u03c60t (q1 , dTt0 u(q1 )) \u2282 \u03c60t (\u0393Tt0 u ).\nWe conclude that Lu \u2282 \u03c60t (\u0393Tt0 u ).\nAddendum 2. Under the hypotheses of Proposition 22, we have \u01640t \u25e6Tt0 u = u for each t \u2208]0, T [.\n22\n\n\fProof. Let us define the map F : q 7\u2212\u2192 Q0t (q, d(Tt0 u(q)). By the first addendum, the image of\nF is equal to the projection of Lu on Rd , hence the map F is onto. Given a point \u03b8 \u2208 Rd , we\nconsider a preimage q of \u03b8 by F , and write\n\u01640t \u25e6 Tt0 u(\u03b8) > Tt0 u(q) \u2212 S0t (\u03b8, q) = u(\u03b8)\nwhere the last equality comes from the first addendum. We conclude that \u01640t \u25e6 Tt0 u > u, hence\n\u01640t \u25e6 Tt0 u = u.\nThe following extrapolates on [7]. For t0 \u2208 R and \u03b4, t > 0, let us define the operators\nt0 \u2212t\nRt := \u0164tt00 +\u03b4t \u25e6 Ttt00 +\u03b4t\n\u2212t \u25e6 \u0164t0\n\n,\n\nt0 +t\n\u0158t := Ttt00 \u2212\u03b4t \u25e6 \u0164tt00 \u2212\u03b4t\n+t \u25e6 Tt0 .\n\nTheorem 4. There exists \u03b4 \u2208]0, 1[, which depends only on m and M such that the operators\nRt , \u0158t have the following properties:\n\u2022 For each t0 \u2208 R and t \u2208]0, 1[, the finite valued functions in the images of Rt and \u0158t are\nuniformly C 1,1 .\n\u2022 For each semi-concave function u, there exists T > 0 such that Rt u 6 u and \u0158t u 6 u for\neach t0 \u2208 R and t \u2208]0, T [.\n\u2022 For each semi-convex function u, there exists T > 0 such that Rt u > u and \u0158t u > u for\neach t0 \u2208 R and t \u2208]0, T [.\n\u2022 For each C 1,1 function u, there exists T > 0 such that Rt u = u and \u0158t u = u for each\nt0 \u2208 R and t \u2208]0, T [.\nProof. The finite valued functions in the image of Ttt00 +\u03b4t\n\u2212t are C/t-semi-concave, by Lemma 16\n(we assume that t \u2208]0, 1[). Then, by Proposition 22, the finite valued functions in the image of\n\u0164tt00 +\u03b4t \u25e6 Ttt00 +\u03b4t\n\u2212t are (2C/t)-semi-concave provided\n\u03b4t 6\n\nC\nCt\n=\n,\ntM (3 + 2C/t)2\nM (3t + 2C)2\n\nwhich holds it \u03b4 6 C/(M (3 + 2C)). For such a \u03b4, the finite valued functions in the image of Rt\nare uniformly semi-concave. They are also uniformly semi-convex, hence uniformly C 1,1 . The\nproof is similar for \u0158. Let us now write\nRt := (\u0164tt00 +\u03b4t \u25e6 Ttt00 +\u03b4t ) \u25e6 (Ttt00 \u2212t \u25e6 \u0164tt00 \u2212t ),\nwhich implies, using the monotony, that Rt u > \u0164tt00 +\u03b4t \u25e6 Ttt00 +\u03b4t u and Rt u 6 Ttt00 \u2212t \u25e6 \u0164tt00 \u2212t u. By\nAddendum 2 we conclude that Rt u > u for small t when u is semi-convex. All the statements\nof the second and third point follow by similar considerations. The last point follows from the\nsecond and third one.\n\n5\n\nSub-solutions of the stationary Hamilton-Jacobi equation.\n\nWe assume from now on that the Hamiltonian does not explicitly depend on time. Then, in\naddition to (HJ), we can consider the stationary Hamilton-Jacobi equation\nH(q, du(q)) = a,\n23\n\n(HJa)\n\n\ffor each real parameter a. This stationary equation is the main character of Fathi's joined\nlecture. Formally, a function u(q) solves (HJa) if and only if the function (t, q) 7\u2212\u2192 u(q) \u2212 at\nsolves (HJ). It is not hard to check that this also holds in the sense of viscosity solutions: The\nfunction u(q) is a viscosity solution of (HJa) if and only if the function (t, q) 7\u2212\u2192 u(q) \u2212 at is a\nviscosity solution of (HJ). Let us explicit for later references:\nHypothesis 4. We say that H is autonomous if it does not depend on the time variable.\nIn this autonomous context, we have T\u03c4\u03c4 +t = Tt0 . We will denote by Tt this operator. The\nMarkov property turns to the equality Tt \u25e6Ts = Tt+s . In other words, the Lax Oleinik operators\nform a semi-group, the famous Lax-Oleinik semi-group. Another important specificity of the\nautonomous context is that the Hamiltonian H is constant along Hamiltonian orbits, as can be\nchecked by an easy computation.\nProposition 23. Given a Hamiltonian H satisfying Hypotheses 1,2,3,4, the following properties\nare equivalent for a function u:\n1. The function u is Lipschitz and it solves the inequation H(q, du(q)) 6 a almost everywhere.\n2. The inequality u(q1 ) \u2212 u(q0 ) 6 At (q0 , q1 ) + at holds for each q0 \u2208 Rd , q1 \u2208 Rd , t > 0.\n3. The inequality u 6 Tt u + ta holds for each t > 0.\n4. The function u is a viscosity sub-solution of the Hamilton-Jacobi equation H(q, du(q)) = a.\n5. The function u is Lipschitz and the inequation H(q, du(q)) 6 a holds at each point of\ndifferentiability q of u (by Rademacher Theorem, the set of points of differentiability has\nfull measure).\nThe function u is called a sub-solution at level a, or a sub-solution of (HJa), if it satisfies these\nproperties.\nProof. It is tautological that 5 \u21d2 1 and easy that 2 \u21d4 3. Let us prove that 1 \u21d2 2,\nfollowing Fathi. If 1 holds, then there exists a set M \u2282 Rd of full measure composed of points\nof differentiability q of u such that H(q, du(q)) 6 a. We first assume that t < \u03c3 and prove 2\n(recall that At = S t ). Let us consider the map\n(q0 , q1 , \u03c4 ) 7\u2212\u2192 (q(\u03c4 ), q1 , \u03c4 ),\nwhere q(\u03c4 ) is the value at time \u03c4 of the unique orbit (q(s), p(s)) which satisfies q(0) = q0 and\nq(t) = q1 . This map is a diffeomorphism of Rd \u00d7 Rd \u00d7]0, t[, the inverse diffeomorphism being\n(\u03b8, q1 , \u03c4 ) 7\u2212\u2192 (q(0), q1 , \u03c4 ),\nwhere (q(s), p(s)) is the unique orbit such that q(\u03c4 ) = \u03b8 and q(t) = q1 . As a consequence,\nfor almost each pair (q0 , q1 ), the function u is differentiable at the point q(s) for almost every\ns \u2208]0, t[. If (q0 , q1 ) is such a pair, we have, using the convexity of H in p,\nZ t\nZ t\nu(q1 ) \u2212 u(q0 ) = u(q(t)) \u2212 u(q(0)) =\nduq(s) * q\u0307(s)ds =\nduq(s) * \u2202p H(q(s), p(s))ds\n0\n0\nZ t\n6\nH(q(s), duq(s) ) + \u2202p H(q(s), p(s)) * p(s) \u2212 H(q(s), p(s))ds\n0\n\n6 at + S t (q(0), q(t)) = at + At (q0 , q1 ).\n\n24\n\n\fWe have proved the desired inequality for almost every pair (q0 , q1 ), hence on a dense subset of\npairs. Since both sides of the inequality are continuous, we deduce that the inequality holds for\nall pairs (q0 , q1 ), provided t < \u03c3. In order to deduce the inequality when t > \u03c3, we write, for n\nlarge enough,\n\u0001\nS t/n (q0 , \u03b81 ) + at/n + * * * + S t/n (qn\u22121 , q1 ) + at/n\nAt (q0 , q1 ) + at = min\n\u03b81 ,...,\u03b8n\u22121\n\u0001\nu(\u03b81 ) \u2212 u(q0 ) + * * * + u(q1 ) \u2212 u(\u03b8n\u22121 ) = u(q1 ) \u2212 u(q0 ).\n> min\n\u03b81 ,...,\u03b8n\u22121\n\nLet us now prove that 3 \u21d2 4. Let u be a function satisfying 3. This function then satisfies 2,\nhence it is Lipschitz. We consider a C 2 function v(q) which touches u from above at some point\n\u03b8, which means that v \u2212 u has a global minimum at \u03b8. Since the function u is Lipschitz, we can\nmodify v at infinity and assume that it has bounded second differential. Then, there exists a\nC 2 solution V (t, q) of (HJ) defined on ] \u2212 T, T [\u00d7Rd with T > 0, and such that V (0, q) = v(q).\nFor t > 0, we have Vt = Tt v, by Proposition 18. Since v > u, we obtain that\nV (t, q) = Tt v(q) > Tt u(q) > u(q) \u2212 at\nfor t \u2208]0, T [, hence \u2202t V (0, \u03b8) > \u2212a (recall that \u03b8 is the point of contact between u and v). Since\nwe know that V solves (HJ), we conclude that\nH(\u03b8, \u2202q V (0, \u03b8)) = H(\u03b8, dv(\u03b8)) 6 a.\nThe proof that 4 \u21d2 5 is very classical and can be found in Fathi's lecture, but we recall it here\nfor completeness. If q is a point of differentiability of u, then du(q) is a super-differential (but\nnot necessarily a proximal super-differential) of u at q, hence H(q, du(q)) 6 a. We will now\nprove that the function u is locally Lipschitz. The estimate H(q, du(q)) 6 a , which holds at\neach point of differentiability of u, then implies that it is globally Lipschitz in view of Hypothesis\n3.\nLet B(Q, 1) be a closed ball, of radius one. Let us set r = max\u03b8\u2208B(Q,2),q\u2208B(Q,1) (u(\u03b8) \u2212 u(q)).\nLet k be a positive number greater that r and such that |p| > k \u21d2 H(q, p) > a for each q. Such\na k exists by Hypothesis 3. Given q in B(Q, 1), the function\n\u03b8 7\u2212\u2192 k|\u03b8 \u2212 q| \u2212 u(\u03b8)\nhas then a local minimum in the interior of the ball B(Q, 2). If this minimum is reached at a\npoint q1 different from q, then the function v(\u03b8) := k|\u03b8 \u2212 q| is smooth at q1 , and, since u is a\nviscosity sub-solution, we have H(q1 , dv(q1 )) 6 a, which is in contradiction with the fact that\n|dv(q1 )| = k. Hence the minimum must be reached at q, which implies that k|\u03b8\u2212q|\u2212u(\u03b8) > \u2212u(q)\nor equivalently that\nu(\u03b8) \u2212 u(q) 6 k|\u03b8 \u2212 q|\nfor each \u03b8 \u2208 B(Q, 2) and all q \u2208 B(Q, 1). We conclude that u is k-Lipschitz on B(Q, 1).\nCorollary 24. If u is a sub-solution of (HJa), then, for each t > 0, Tt u is a sub-solution of\n(HJa), and so is \u0164t u.\nProof. The function u is a sub-solution if and only if Ts u + as > u for each t > 0. Applying\nTt , we obtain Tt Ts u + as = Ts Tt u + as > Tt u. Since this inequality holds for each s > 0, we\nconclude that Tt u is a sub-solution.\nCorollary 25. If the function u is Lipschitz, and if the Hamiltonian is autonomous, then the\nfunctions Tt u, t > 0 are equi-Lipschitz.\n25\n\n\fProof. If the function u is k-Lipschitz, then du(q) 6 k almost everywhere, hence u is a\nsub-solution to (HJa) for some a (one can take a = sup|p|6k H(q, p)). As a consequence,\nthe functions Tt u, t > 0 are all sub-solutions to (HJa), hence they are K-Lipschitz, with\nK = sup{|p|, H(q, p) 6 a}.\n\n6\n\nWeak KAM solutions and invariant sets.\n\nWe derive here the first dynamical consequences from the theory.\nDefinition 26. The function u is called a Weak KAM solution at level a if Tt u + ta = u for\neach t > 0. Weak KAM solutions at level a are viscosity solutions of (HJa). We say that the\nfunction u is a Weak KAM Solution if it is a Weak KAM solution at some level a.\nIf u is a weak KAM solution, then it is semi-concave (with a semi-concavity constant which\ndepends only on M and m). By Theorem 21, for t > 0, we have the inclusion\n\u0001\n\u03c6\u2212t \u0393\u0304u \u2282 \u0393u\nand this set is a Lipschitz graph. The set\nI \u2217 (u) := \u2229n\u2208N \u03c6\u2212n \u0393\u0304u\n\n\u0001\n\nis a closed invariant set contained in a Lipschitz graph. It would be a very nice result to have\nobtained a distinguished closed invariant subsets of our Hamiltonian system contained in a\nLipschitz graph. Unfortunately, at this point, we can't prove (because it is not necessarily true)\nthat the set I \u2217 (u) is not empty. In order to obtain interesting dynamical consequences from this\ntheory, we need an additional assumption.\nHypothesis 5. We say that the Hamiltonian H is periodic if H(q + w, p) = H(q, p) for each\nw \u2208 Zd , q \u2208 Rd and p \u2208 Rd\u2217 .\nUnder this hypothesis, we should see the Hamiltonian system as defined on the phase space\nTd \u00d7 Rd\u2217 , with Td = Rd /Zd . Indeed, the flow \u03c6t commutes with the translations (q, p) 7\u2212\u2192 (q +\nw, p), w \u2208 Zd . The compactness of this new configuration space has remarkable consequences,\nsummed up in the following Theorem. We assume in the rest of this section that the Hamiltonian\nH satisfies Hypotheses 1, 2, 3, 4, 5.\nTheorem 5. If the Hamiltonian is autonomous and periodic, then there exists a periodic Weak\nKAM solution. The corresponding set I \u2217 (u) is a non-empty closed invariant set which is contained in a Lipschitz graph and which is invariant under the translations (q, p) 7\u2212\u2192 (q + w, p),\nw \u2208 Zd .\nThis last property on the invariance under translations means that I \u2217 (u) naturally gives rise\nto an invariant space on the quotient phase space Td \u00d7 Rd\u2217 .\nProof. Let us first prove the second part of the Theorem. If u is a periodic Weak KAM\nsolution, then the set \u0393\u0304u is contained in {|p| 6 C} for some constant C, and it is invariant under\nthe integral translations, hence it descends to a compact subset of Td \u00d7 Rd\u2217 , that we still denote\nby \u0393\u0304u . Then the sets \u03c6\u2212n (\u0393\u0304u ) form a decreasing sequence of non-empty compact sets, hence\ntheir intersection is a non-empty compact set.\nLet us now prove that there exists a periodic Weak KAM solution. We follow the proof of\n[6], which is slightly different from the original proof of Fathi. Observe first that the functions\nAt (q0 , q1 ) are periodic in the sense that At (q0 + w, q1 + w) = At (q0 , q1 ) for each w \u2208 Zd . This\n26\n\n\fimplies that Tt u is periodic when u is periodic. Considering the Cauchy problem for (HJ) with\ninitial condition equal to zero, we define v(t, q) := Tt 0(q). The quantities a+ (t) = maxq vt (q)\nand a\u2212 (t) = minq vt (q) will be useful. Since the functions vt , t > 0 are equi-Lipschitz, there\nexists a constant K such that a+ (t) \u2212 a\u2212 (t) 6 K for all t > 0. We have\na+ (t + s) = max Tt+s 0 = max Tt (Ts 0) 6 Tt (a+ (s)) = a+ (s) + Tt (0) 6 a+ (s) + a+ (t),\nand similarly\na\u2212 (t + s) > a\u2212 (t) + a\u2212 (s).\nBy standard results on sub-additive functions, we conclude that a+ (t)/t and a\u2212 (t)/t converge\nrespectively to inf t>0 a+ (t)/t and supt>0 a\u2212 (t)/t. Since a+ \u2212 a\u2212 is bounded, these two limits\nhave the same value, let us call it \u2212a. We have\nK \u2212 ta > a\u2212 (t) + K > a+ (t) > \u2212ta > a\u2212 (t) > a+ (t) \u2212 K > K \u2212 at\nfor all t > 0, hence\nK > v(t, q) + ta > \u2212K.\nWe can now define\nu(q) := lim inf (v(t, q) + ta).\nt\u2212\u2192\u221e\n\nWe claim that u is a Weak KAM solution at level a. Since the functions vt + ta are equiLipschitz and equi-bounded, the function u is well-defined and Lipschitz. We have to prove that\nTt u + ta = u for all t > 0.\nWe have\nv(t + s, q1 ) + (t + s)a 6 v(s, q0 ) + sa + At (q0 , q1 ) + ta\nfor each q0 , q1 and t > 0, s > 0. Taking the lim inf in s yields\nu(q1 ) 6 u(q0 ) + At (q0 , q1 ) + ta.\nWe have proved that u is a sub-solution to (HJa).\nConversely, we have to prove that Tt u+ta > u. Let us pick a point q and consider a sequence\ntn such that v(tn , q) + tn a \u2212\u2192 u(q). Fixing t > 0, we consider a sequence qn in Rd such that\nv(tn , q) + tn a = v(tn \u2212 t, qn ) + (tn \u2212 t)a + At (qn , q) + ta.\nThis equality implies that the sequence qn is bounded, and we assume by taking a subsequence\nthat it has a limit q 0 . We can also assume that the sequence v(tn \u2212 t, q 0 ) + (tn \u2212 t)a has a limit,\nthat we denote by l. Note that l > u(q 0 ). Since the functions vt are equi-Lipschitz, we have\nv(tn \u2212 t, qn ) + (tn \u2212 t)a \u2212\u2192 l hence, taking the limit in the equality above,\nu(q) = l + At (q 0 , q) + at > u(q 0 ) + At (q 0 , q) + at > Tt u(q) + at.\nWe have proved that u is a periodic Weak KAM solution at level a.\nThe periodic Weak KAM solutions at level a are the periodic viscosity solutions of (HJa),\nas is proved in Fathi's joined lecture. The existence of periodic viscosity solutions was first\nobtained by Lions, Papanicolaou and Varadhan in a famous unpublished preprint, [15]. The\nmost important aspect of Fathi's weak KAM theorem that we just exposed is that these viscosity\nsolutions have a dynamical relevance and give rise to invariant sets.\nLet us comment a bit further in that direction, and explain the name \"Weak KAM\". Consider\na periodic Lipschitz function u, and the associated set \u0393u , that we consider here as a subspace\nof Td \u00d7 Rd\u2217 .\n27\n\n\fAssume first that u is C 2 , so that \u0393u is a C 1 graph. This graph is invariant if and only if\nthere exists a such that u solves (HJa). This follows from Section 1: If u solves (HJa), then the\nfunction U (t, q) = u(q) \u2212 at solves HJ, hence\n\u03c6t (\u0393u ) = \u0393Ut = \u0393u .\nConversely, if \u0393u is invariant, then \u0393Tt u = \u03c6t (\u0393u ) = \u0393u , by Corollay 3, hence Tt u is equal to\nu up to an additive constant a(t). Since Tt is a semi-group, it is easy to deduce that a(t) = at\nfor some a \u2208 R. As a consequence, u is a C 2 Weak KAM solution, hence a classical solution of\n(HJa).\nThe classical KAM theorem gives the existence, in certain very specific settings, of some\ninvariant C 1 graphs of the form \u0393u . From what we just explained, it can be interpreted as\ngiving the existence of C 2 solutions of (HJa), although this point of view is not the right one\nto obtain its proof. It is natural to expect that the Hamilton-Jacobi equation could be used to\nproduce invariant sets in more general situations. Since we do not know any direct method to\nprove the existence of C 2 solutions of (HJa), we should deal with some kind of weak solutions.\nHowever, if u is just a Lipschitz solution almost everywhere, we can't say much about the\ndynamical properties of \u0393u . It is remarkable that the inclusion \u03c6t (\u0393u ) \u2283 \u0393\u0304u holds for viscosity\nsolutions (or, equivalently Weak KAM solutions) in the convex case. This is the starting point\nof Fathi's construction of the invariant set I \u2217 (u) that we exposed in the present section.\n\n7\n\nRegular sub-solutions and the Aubry set.\n\nWe abandon for a moment the hypothesis 5, and consider a Hamiltonian satisfying Hypotheses\n1, 2, 3, 4. We describe a new construction of invariant sets based on the study of regular subsolutions, and define the Aubry set. We mostly follow [4] in this section. The following result is\nat the base of our constructions, see [4, 2, 13].\nTheorem 6. If (HJa) admits a sub-solution, then it admits a C 1,1 sub-solution. Moreover, the\nset of C 1,1 sub-solutions is dense in the set of all sub-solutions for the uniform topology.\nProof. Let u be a sub-solution at level a. We use the operator Rt = \u0164\u03b4t \u25e6 T(\u03b4+1)t \u25e6 \u0164t of\nTheorem 4 to regularize u. Since the operators Tt and \u0164t preserve sub-solutions, so does Rt .\nWe claim that\nu \u2212 (C + a)(1 + \u03b4)t 6 Rt u 6 u + (C + a)(1 + \u03b4)t\nwith a constant C which depends only on m and M . This implies that the function Rt u is finite\nvalued. If the parameter \u03b4 has been chosen small enough, then, by Theorem 4, the functions Rt\nare C 1,1 sub-solutions, which converge uniformly to u as t \u2212\u2192 0. The bound on Rt u claimed\nabove follows from the following ones in view of Property 19,\nv \u2212 sa 6 Ts v 6 v + Cs,\n\nv \u2212 Cs 6 \u0164s v 6 v + sa\n\nwhich hold for each s > 0 and each sub-solution v at level a. The first one can be seen by writing\nu(q) \u2212 as 6 Ts u(q) 6 u(q) + As (q, q) 6 u(q) + Cs.\nThis ends the proof of Theorem 6. Observe that we could have used the simpler operator T\u0306\u03b4t \u25e6Tt ,\nas was done in [4], but the operator Rt deserves attention for some nicer properties.\nDefinition 27. The critical value of H is the real number \u03b1 (or \u03b1(H)) defined as the infimum\nof all real numbers a such that (HJa) has a sub-solution. The sub-solutions of (HJ\u03b1) are called\ncritical sub-solutions.\n28\n\n\fLemma 28. We have the estimate \u2212M 6 \u03b1 6 M .\nProof. The function u = 0 is a sub-solution at level M , hence \u03b1 6 M . Conversely, since\nH > \u2212M there exists no sub-solution at level a when a < \u2212M .\nProposition 29. There exists a C 1,1 sub-solution of (HJ\u03b1).\nProof. Let an be a sequence decreasing to \u03b1. Since an > \u03b1, the Hamilton-Jacobi equation at level an has a sub-solution un . The sequence un is equi-Lipschitz, and we can assume\nby adding constants that it is also equi-bounded. Taking a subsequence, we can also assume\nthat it converges locally uniformly to a limit u. Taking the limit n \u2212\u2192 \u221e in the inequalities\nun (q1 ) \u2212 un (q0 ) 6 At (q0 , q1 ) + tan gives u(q1 ) \u2212 u(q0 ) 6 At (q0 , q1 ) + tan . This holds for all\nq0 , q1 and t > 0, hence u is a sub-solution at level \u03b1, or in other words a critical sub-solution.\nSince there exists a critical sub-solution, Theorem 6 implies that there exists a C 1,1 critical\nsub-solution.\nDefinition 30. The projected Aubry set is the set A \u2282 Rd of points q such that the equality\nH(q, du(q)) = \u03b1 holds for all C 1 critical sub-solutions u.\nWe point out that A might be empty without additional hypotheses.\nLemma 31. If q \u2208 A, then all C 1 critical sub-solutions u have the same differential at q. In\nother words, the restriction \u0393u|A does not depend on the C 1 critical sub-solution u.\nProof. Let u and v be two critical sub-solutions, and q a point in A. We have to prove that\ndu(q) = dv(q). Assume, by contradiction, that this equality does not hold and consider the\nsub-solution w = (u + v)/2. Since H(q, du(q)) = H(q, dv(q)) = \u03b1, the strict convexity of H(q, .)\nimplies that H(q, dw(q)) < \u03b1, which contradicts the definition of A.\nLemma 32. There exists a C 1,1 sub-solution u0 which satisfies the strict inequality H(q, du0 (q)) <\n\u03b1 for all q in the complement of A.\nProof. The set of C 1 functions is separable for the topology of uniform C 1 convergence on\ncompact sets. This topology can be defined for example by the distance\nd(u, v) =\n\nX sup|q|6n arctan(|u(q)| + |du(q)|)\n2n\n\nn\n\n.\n\nSince a subset of a separable space is separable, there exists a sequence un of C 1 critical subsolutions which is dense for this topology in the set of all C 1 critical sub-solutions. Let us\nset\na0\nan = n\n2 supk6n,|q|6n (1 + |uk (q)| + |duk (q)|))\nP\nP\nand choose a0 such that\nn>1 an = 1. The sum\nn>1 an un converges uniformly with its\n1\ndifferentials on each compact sets to a C limit v0 . The function v0 is a critical sub-solution,\nand we claim that H(q, dv0 (q)) = \u03b1 if and only if q belongs to A. Indeed, this equality holds\nonly if all the inequalities H(q, dun (q)) 6 \u03b1 are equalities, which, in view of the density of the\nsequence un , implies that H(q, du(q)) = \u03b1 for all C 1 sub-solutions u. By definition, this implies\nthat q belongs to A. We have constructed a C 1 sub-solution v0 such that\nH(q, dv0 (q)) < \u03b1\n29\n\n\foutside of A. We have to prove the existence of a C 1,1 critical sub-solution with the same\nproperty. We consider a smooth function V (q) which is bounded in C 2 , which is positive outside\nof A, and such that\n0 6 V (q) 6 \u03b1 \u2212 H(q, dv0 (q))\nfor all q \u2208 Rn . The modified Hamiltonian H\u0303(q, p) = H(q, p) + V (q) satisfies all our hypotheses.\nSince H\u0303 > H, the corresponding critical value \u03b1\u0303 satisfies \u03b1\u0303 > \u03b1. Since v0 is a sub-solution of\nthe inequation\nH\u0303(q, dv0 (q)) 6 \u03b1,\nwe can apply Theorem 6 to H\u0303 at level \u03b1, and obtain the existence of a C 1,1 sub-solution u0 to\nthe same inequation. The inequality\nH(q, du0 (q)) 6 \u03b1 \u2212 V (q)\nimplies that u0 is a critical sub-solution for H which is strict on the set {V > 0} which, from\nour construction of V , is the complement of A.\nDefinition 33. The Aubry set A\u2217 is defined as:\nA\u2217 = \u2229u \u0393u|A = \u2229u \u0393u ,\nwhere the intersections are taken on the set of C 1 critical sub-solutions.\nIn view of Lemma 31 we have A\u2217 = \u0393u|A for each C 1 sub-solution u, hence \u03c0(A\u2217 ) = A, where\n\u03c0 : Rd \u00d7 Rd\u2217 \u2212\u2192 Rd is the projection on the first factor. To check the second inequality, it is\nsufficient to prove that \u2229u \u0393u \u2282 A\u2217 . Let u0 be a C 1 critical sub-solution such that H(q, du0 (q)) <\n\u03b1 outside of A. Given a point (q0 , p0 ) in \u0393u0 \u2212A\u2217 , we can slightly perturb the critical sub-solution\nu0 around q0 to a critical sub-solution u1 such that du1 (q0 ) 6= du0 (q0 ) (we use the strict inequality\nH(q, du0 (q)) < \u03b1). The point (q0 , p0 ) does not belong to \u0393u1 , hence it does not belong to \u2229u \u0393u ,\nwhich ends our proof.\nThe set A\u2217 is contained in the Lipschitz graph \u0393u0 for each C 1,1 sub-solution u0 . As in\nSection 6, we have obtained an invariant set contained in a Lipschitz graph, but which may be\nempty in general:\nProposition 34. The Aubry set is a closed invariant set.\nProof. Let u0 be a C 1,1 critical solution such that H(q, du0 (q)) < \u03b1 outside of A. By\nProposition 22, there exists T > 0 such that Tt u0 is still C 1,1 for t \u2208 [\u2212T, T ]. Given (q, p) \u2208 A\u2217 ,\nwe conclude that, for t \u2208 [0, T ], we have p = d(Tt u0 )(q). Setting \u03b8 = Q\u2212t (q, p), the addendum\nto Proposition 22 implies that Tt u0 (q) = u0 (\u03b8) + S t (\u03b8, q), and that\n\u03c6t (\u03b8, du0 (\u03b8)) = (q, p).\nSince the flow preserves the Hamiltonian, we get that H(\u03b8, du0 (\u03b8)) = \u03b1, hence the point \u03b8\nbelongs to A, and then\n\u0001\n\u03c6\u2212t (q, p) = \u03b8, du0 (\u03b8) \u2208 A\u2217 .\nWe have proved that \u03c6\u2212t (A\u2217 ) \u2282 A\u2217 for t \u2208 [0, T ]. We can prove in a similar way, using the C 1,1\nsub-solution \u0164t u0 instead of Tt u0 , that \u03c6t (A\u2217 ) \u2282 A\u2217 for t \u2208 [0, T ], and hence that\n\u03c6t (A\u2217 ) = A\u2217\nfor each t \u2208 [\u2212T, T ], which clearly implies that this equality holds for all t. We have proved the\ninvariance of A\u2217 .\n\n30\n\n\fProposition 35. The equality\n\u0164t u(q) \u2212 t\u03b1 = u(q) = Tt u(q) + t\u03b1\nholds for each critical sub-solution u, each t > 0 and each q \u2208 A. The inclusion A\u2217 \u2282 \u0393u holds\nfor each critical sub-solution, hence the inclusion A\u2217 \u2282 I \u2217 (u) holds for each weak KAM solution\nat level \u03b1.\nProof. Let (q(s), p(s)) be a trajectory contained in A\u2217 , and t > 0 be given. For each C 1\ncritical sub-solution u, we have p(s) = duq(s) , and\nZ\nu(q(t)) \u2212 u(q(0)) =\n\nt\n\nZ\n\nt\n\nduq(s) q\u0307(s) \u2212 H(q, duq(s) )ds\n\nduq(s) q\u0307(s)ds = t\u03b1 +\n0\n\n0\nt\n\n>A (q(0), q(t)) + t\u03b1.\nSince u is a critical sub-solution, the second point in Proposition 23 implies that the last inequality must be an equality, hence\nu(q(t)) \u2212 u(q(s)) = At\u2212s (q(s), q(t)) + (t \u2212 s)\u03b1\nfor each t > s. In the terminology of Fathi, we have proved that the curve q(s) is calibrated by\nthe sub-solution u. We can now write\nu(q(t)) 6 Tt u(q(t)) + t\u03b1 6 u(q(0)) + At (q(0), q(t)) + t\u03b1 = u(q(t)).\nThis implies that Tt u + t\u03b1 = u on A, and, similarly, \u0164t u \u2212 t\u03b1 = u on A. Let us now fix t \u2208]0, \u03c3[.\nGiven an orbit (q(s), p(s)) in A\u2217 , we have\nu(q(0)) 6 u(\u03b8) + S t (\u03b8, q(0)) + t\u03b1\nfor each sub-solution u and each \u03b8, with equality at \u03b8 = q(\u2212t). This implies that \u22021 S(q(\u2212t), q(0))\nis a super-differential of u at q(0). This holds in particular for C 1 sub-solutions, which satisfy\ndu(q(0)) = p(0), hence \u22021 S(q(\u2212t), q(0)) = p(0). We have proved that p(0) is a super-differential\nof u at q(0). Similarly, using the inequality\nu(q(0)) > u(\u03b8) \u2212 S t (q(0), \u03b8) \u2212 t\u03b1,\nwith equality at \u03b8 = q(t), we conclude that p(0) is a sub-differential of u at q(0). This implies\nthat u is differentiable at q(0), and that du(q(0)) = p(0). As a consequence, A\u2217 \u2282 \u0393u for each\nsub-solution u.\nIn the course of the above proof, we have established the following lemma, which will be\nneeded later:\nLemma 36. Let u be a sub-solution at level a, and let (q(s), p(s)) be a Hamiltonian trajectory\ncontained in \u0393u \u2229 {H = a} (note that this set is not necessarily invariant in general), then, the\nequality \u0164t u(q(s)) \u2212 ta = u(q(s)) = Tt u(q(s)) + ta holds, for each t > 0 and each s \u2208 R.\n\n8\n\nThe Ma\u00f1\u00e9 Potential.\n\nIn this section, we work with a Hamiltonian satisfying Hypotheses 1, 2, 3, 4. The Ma\u00f1\u00e9 Potential\nat level a is the function\n\u0001\n\u03a6a (q0 , q1 ) := inf At (q0 , q1 ) + at .\nt>0\n\n31\n\n\fThis function was first introduced by Ricardo Ma\u00f1\u00e9, see [16]. We leave as an easy exercise for\nthe reader to prove the triangle inequality\n\u03a6a (q0 , q1 ) 6 \u03a6a (q0 , \u03b8) + \u03a6a (\u03b8, q1 ).\nIn view of Proposition 23, each sub-solution u at level a satisfies\nu(q1 ) \u2212 u(q0 ) 6 \u03a6a (q0 , q1 )\nfor each q0 and q1 . We conclude that \u03a6a is finite if there exists a sub-solution at level a, which\nholds if and only if a > \u03b1. Conversely, If the function \u03a6a is finite, then we see from the triangle\ninequality that the function q 7\u2212\u2192 \u03a6a (q0 , q) is a sub-solution at level a, which implies that a > \u03b1.\nThe estimates of Lemma 13 imply that\np\n\u03a6a (q0 , q1 ) 6 2 2m(M + a)|q1 \u2212 q0 |\nprovided a > \u03b1 (note that \u03b1 > \u2212M ). We have proved that the Ma\u00f1\u00e9 Potential is the function\ncalled the viscosity semi-distance in Fathi's lecture:\nProposition 37. If a > \u03b1, then the function q 7\u2212\u2192 \u03a6a (q0 , q) is the maximum of all sub-solutions\nu at level a which vanish at q0 . If a < \u03b1, then there is no such sub-solution and \u03a6a is identically\nequal to \u2212\u221e.\nThis statement also implies that the Ma\u00f1\u00e9 Potential at level a only depends on the energy\nlevel {H = a}. More precisely, let G be another Hamiltonian satisfying our hypotheses and\nsuch that H = a \u21d4 G = a. Then, the sets {H 6 a} and {G 6 a} are equal, which implies in\nview of the first characterization of sub-solutions in Proposition 23 that G and H have the same\nsub-solutions at level a. As a consequence, they have the same Ma\u00f1\u00e9 potential at level a. This\nis also reflected in the following Proposition by the fact that the involved orbits are contained\nin the set {H = a}.\nProposition 38. Given q0 6= q1 , there exists \u03c4 \u2208]0, \u221e] and an orbit (q(s), p(s)) : (\u2212\u03c4, 0] \u2212\u2192\nRd \u00d7 Rd\u2217 such that q(0) = q1 , A0s (q0 , q(s)) \u2212 as = \u03a6a (q(s), q1 ),\n\u03a6a (q0 , q(s)) + \u03a6a (q(s), q1 ) = \u03a6a (q0 , q1 )\nand H(q(s), p(s)) = a for each s \u2208 (\u2212\u03c4, 0]. If moreover \u03c4 is finite, then q(\u2212\u03c4 ) = q0 .\nProof. If q0 6= q1 , then either the functions t 7\u2212\u2192 At (q0 , q1 ) + at reaches its minimum at some\nfinite time \u03c4 > 0, or it has a minimizing sequence \u03c4n \u2212\u2192 \u221e. This follows from Lemma 13.\nIn the first case, there exists an orbit (q(t), p(t)) : [\u2212\u03c4, 0] \u2212\u2192 Rd \u00d7Rd\u2217 such that q(\u2212\u03c4 ) = q0 ,\nq(0) = q1 , and\nZ 0\np * q\u0307 \u2212 H(q, p)dt = A\u03c4 (q0 , q1 ) = \u03a6a (q0 , q1 ) \u2212 \u03c4 a.\n\u2212\u03c4\n\nWe obtain, for each s \u2208 [\u2212\u03c4, 0], that\na\n\nZ\n\n0\n\n\u03a6 (q0 , q1 ) \u2212 a\u03c4 =\n\nZ\np * q\u0307 \u2212 H(q, p)dt =\n\n\u2212\u03c4\n\ns\n\nZ\np * q\u0307 \u2212 H(q, p)dt +\n\n\u2212\u03c4\ns+\u03c4\n\n>A\n\n0\n\np * q\u0307 \u2212 H(q, p)dt\ns\n\n(q0 , q(s)) + A\u2212s (q(s), q1 )\n\n> \u03a6a (q0 , q(s)) \u2212 a(s + \u03c4 ) + \u03a6a (q(s), q1 ) + as\n> \u03a6a (q0 , q1 ) \u2212 a\u03c4.\n\n32\n\n\fWe conclude that all these inequalities are equalities, hence\n\u03a6a (q0 , q(s)) + \u03a6a (q(s), q1 ) = \u03a6a (q0 , q1 ).\nWe also deduce from the above chain of inequalities that A\u2212s (q(s), q1 ) \u2212 as = \u03a6a (q(s), q1 ), which\nimplies that the function t 7\u2212\u2192 At (q(s), q1 ) + at is minimal for t = \u2212s. Taking s \u2208] \u2212 \u03c3, 0[, we\ncan differentiate with respect to t at t = \u2212s and get\n\u2202t|t=\u2212s S t (q(s), q1 ) + a = 0.\nRecalling the equality\n\u2202t S \u2212s (q(s), q1 ) + H(q1 , p(0)) = 0\n(because p(0) = \u03c11 (\u2212s, q(s), q1 ) in the notations of Section 2), we conclude that H(q1 , p(0)) = a,\nand, since the Hamiltonian is constant on Hamiltonian orbits, H(q(t), p(t)) = a for each t.\nIn the second case, there exists a sequence of orbits (qn (t), pn (t)) on [\u2212\u03c4n , 0] such that\nZ\n\n0\n\npn * q\u0307n \u2212 H(qn , pn )dt + a\u03c4n = A\u03c4n (q0 , q1 ) + a\u03c4n 6 \u03a6a (q0 , q1 ) + \u03b4n ,\n\n\u2212\u03c4n\n\nwhere \u03b4n \u2212\u2192 0. Let us denote hn := H(qn (s), pn (s)), it does not depend on s. By Lemma 14\nand the above inequality, we have\nZ 0\nm\n\u03c4n hn \u2212 (m + M )\u03c4n 6\npn * \u2202p H(qn , pn ) \u2212 H(qn , pn )dt 6 \u03a6a (q0 , q1 ) + \u03b4n\nM\n\u2212\u03c4n\nhence the sequence hn is bounded. As a consequence, the curves pn (s) are uniformly bounded,\nhence so is q\u0307n (s) = \u2202p H(qn (s), pn (s)). On each compact interval of time [s, 0], the curves\nxn (t) = (qn (t), pn (t)) are thus uniformly bounded, hence uniformly Lipschitz. Up to taking a\nsubsequence, we can thus assume that the curves xn (t) converge, uniformly on compact time\nintervals, to a Hamiltonian orbit x(t) = (q(t), p(t)) : (\u2212\u221e, 0] \u2212\u2192 Rd \u00d7 Rd\u2217 . Passing at the limit\nin the inequality\n\u03a6a (q0 , qn (s)) + \u03a6a (qn (s), q1 ) 6 \u03a6a (q0 , q1 ) + \u03b4n ,\nwhich holds for each s \u2208 [\u2212\u03c4n , 0], yields\n\u03a6a (q0 , q(s)) + \u03a6a (q(s), q1 ) 6 \u03a6a (q0 , q1 ),\nwhich must actually be an equality. We prove as in the first case that H(q1 , p(0)) = a, thus\nH(q(s), p(s)) \u2261 a.\nThe projected Aubry set A can be characterized in terms of the Ma\u00f1\u00e9 potential (see also\nFathi's lecture):\nProposition 39. The following statements are equivalent for a point q0 and a real number a,\nwhere we denote by u the function \u03a6a (q0 , .):\n1. q0 \u2208 A and a = \u03b1.\n2. Tt u(q0 ) + ta = u(q0 ) = 0 for each t > 0.\n3. The function u is a Weak KAM solution at level a.\n4. u is differentiable at q0 .\n\n33\n\n\fProof. 1 \u21d2 2. This follows from Proposition 35 since u is a sub-solution at level a = \u03b1.\n2 \u21d2 3. Let us fix t > 0 and q1 . We have to prove that there exists \u03b8 such that u(q1 ) >\nu(\u03b8) + At (\u03b8, q1 ) + ta (this inequality is then an equality). If q1 = q0 , the existence of this point\nfollows from the equality Tt u(q0 ) + ta = u(q0 ).\nIf q1 6= q0 , we can apply Proposition 38 to this pair of points. With the notations of\nProposition 38, if \u03c4 > t, then the point \u03b8 = q(\u2212t) fulfills our demand. If \u03c4 < t, then we set\ns = t \u2212 \u03c4 . We have q(\u2212\u03c4 ) = q0 and A\u03c4 (q0 , q1 ) + a\u03c4 = u(q1 ). Since Ts u(q0 ) + sa = u(q0 ), there\nexists \u03b8 such that u(\u03b8) + As (\u03b8, q0 ) + sa = u(q0 ) = 0. The infimum in the definition of Ts u(q0 )\nexists because u is Lipschitz. We conclude that\nu(\u03b8) + At (\u03b8, q1 ) + at 6 u(\u03b8) + As (\u03b8, q0 ) + sa + A\u03c4 (q0 , q1 ) + a\u03c4 = u(q1 ).\n3 \u21d2 4. If u is a Weak KAM solution, then it has a proximal super-differential at each\npoint. Conversely, if v is a C 1 sub-solution, then u \u2212 v has a minimum at q0 hence dv(q0 ) is a\nsub-differential of u at q0 . The function u both has a super-differential and a sub-differential at\nq0 , hence it is differentiable at q0 .\n4 \u21d2 1. If a > \u03b1 or if q0 does not belong to A, then there exists a C 1 sub-solution v at\nlevel a which is strict near q0 . We can then slightly perturb the function v near q0 and build\na sub-solution w such that dw(q0 ) 6= dv(q0 ). In view of the characterization of u as the largest\nsub-solution vanishing at q0 , we conclude that dv(q0 ) as well as dw(q0 ) are sub-differentials of u\nat q0 , hence u is not differentiable at this point.\nThe Ma\u00f1\u00e9 potential also allows to build Weak KAM solutions in the non periodic case by\nthe Busemann method, see [11] and Fathi's Lecture. Let qn be a sequence of points of Rd such\nthat |qn | > n. We consider the sequence of functions\nun (q) = \u03a6a (qn , q) \u2212 \u03a6a (qn , q0 ).\nBy construction, un (q0 ) = 0, and it follows from the triangle inequality that the functions un are\nequi-Lipschitz. We can then assume, without loss of generality, that the functions un converge,\nuniformly on compact sets, to a Lipschitz limit u(q).\nProposition 40. The limit function u(q) is a Weak KAM solution at level a.\nProof. The functions un are all sub-solutions at level a, which means that un (q1 ) \u2212 un (q0 ) 6\nAt (q0 , q1 ) + ta for each t > 0, q0 , q1 . At the limit n \u2212\u2192 \u221e, we obtain that that Tt u + ta > u\nfor each t > 0.\nWe have to prove that Tt u + ta 6 u for all t > 0. Let us fix a point q and a time t > 0, and\nconsider a sequence tn such that\nAtn (qn , q) + atn 6 \u03a6a (qn , q) + 1/n.\nThis inequality implies that\np\n1\n|qn \u2212 q|2 6 1 + (M \u2212 a)tn + 2 2m(M + a)|qn \u2212 q|\n2M tn\nand, since |qn \u2212 q| \u2212\u2192 \u221e, that tn \u2212\u2192 \u221e. When n is large enough, we have tn > t and there\nexists \u03b8n \u2208 Rd such that Atn (qn , q) = Atn \u2212t (qn , \u03b8n ) + At (\u03b8n , q). This implies that\n\u03a6a (qn , q) > Atn (qn , q) + atn \u2212 1/n\n> Atn \u2212t (qn , \u03b8n ) + a(tn \u2212 t) + At (\u03b8n , q) + at \u2212 1/n\n> \u03a6a (qn , \u03b8n ) + At (\u03b8n , q) + at \u2212 1/n.\n34\n\n\fThis inequality implies that\nun (q) > un (\u03b8n ) + At (\u03b8n , q) + at \u2212 1/n.\nSince the functions un are equi-Lipschitz, this implies that the sequence \u03b8n is bounded, by\nLemma 13. By taking a subsequence, we assume that \u03b8n has a limit \u03b8, and, at the limit, we\nobtain\nu(q) > u(\u03b8) + At (\u03b8, q) + at,\nwhich implies that u(q) > Tt u(q) + ta.\n\n9\n\nReturn to the periodic case.\n\nA more precise link can be established between the contents of Sections 6 and 7 under the\nassumption that H is periodic (see Hypothesis 5). It is useful first to expose a variant of Section\n7 adapted to the periodic case. We leave as exercises the proofs which are direct adaptations of\nthe ones given above. From now on, we assume Hypotheses 1, 2, 3, 4, 5.\nTheorem 7. If (HJa) admits a periodic sub-solution, then it admits a periodic C 1,1 sub-solution.\nMoreover, the set of periodic C 1,1 sub-solutions is dense in the set of all periodic sub-solutions\nfor the uniform topology.\nDefinition 41. The periodic critical value of H is the real number \u03b1(0) defined as the infimum\nof all real numbers a such that (HJa) has a periodic sub-solution. The periodic sub-solutions at\nlevel \u03b1(0) are called critical periodic sub-solutions.\nDefinition 42. The projected periodic Aubry set is the set A(0) \u2282 Td of points q such that the\nequality H(q, du(q)) = \u03b1(0) holds for all C 1 periodic critical sub-solutions u.\nLemma 43. If q \u2208 A(0), then all C 1 critical periodic sub-solutions u have the same differential\nat q. In other words, the restriction \u0393u|A does not depend on the C 1 critical periodic sub-solution\nu.\nProposition 44. There exists a C 1,1 periodic critical sub-solution u0 such that H(q, du0 (q)) <\n\u03b1(0) outside of A(0).\nWithout surprise, we define the periodic Aubry set A\u2217 (0) as\nA\u2217 (0) := \u0393u0 |A ,\nwith u0 given by the proposition (there is not a single u0 , but the Aubry set is well defined).\nProposition 45. The set A\u2217 (0) \u2282 Td \u00d7 Rd\u2217 is compact, non empty, and invariant.\nProof. Let us prove that A(0), hence A\u2217 (0) is not empty. Assuming by contradiction that it\nwas empty, then the equality H(q, du0 (q)) < \u03b1(0) would hold for all q \u2208 Rd . Since the function\nq 7\u2212\u2192 H(q, du0 (q)) is periodic, we could conclude that supq H(q, du0 (q)) < \u03b1(0), which is in\ncontradiction with the definition of \u03b1(0).\nWe are now in a position to specify the connection with the invariant sets introduced in\nSection 6:\n\n35\n\n\fProposition 46. In the periodic case, we have the equality\nA\u2217 (0) = \u2229u I \u2217 (u),\nwhere the intersection is taken on all periodic weak KAM solutions.\nProof. The inclusion A\u2217 (0) \u2282 \u2229u I \u2217 (u) is proved as in Section 7. Our goal is to prove the\nother inclusion. Let u0 be a C 1,1 periodic sub-solution which is strict outside of A(0). The\nmap t 7\u2212\u2192 Tt u0 + t\u03b1(0) is non-decreasing. In addition, the functions Tt u0 + t\u03b1(0) are equiLipschitz, and they coincide with u0 on A, hence they are equi-bounded. As a consequence,\nTt u0 + t\u03b1 \u2212\u2192 u\u221e uniformly as t \u2212\u2192 \u221e.\nClaim: The limit u\u221e is a periodic weak KAM solution such that u0 < u\u221e outside of A(0).\nIn order to prove that u\u221e is a weak KAM solution, it is enough to notice that the function\nTt+s u0 + (t + s)\u03b1(0) converges both to u\u221e and to Ts u\u221e + s\u03b1(0) when t \u2212\u2192 \u221e. This implies,\nas desired, that Ts u\u221e + s\u03b1(0) = u\u221e for each s > 0.\nWe know that u\u221e > u0 , with equality on A(0). Conversely, let us consider a point q such\nthat u\u221e (q) = u0 (q). The point q is minimizing the difference u\u221e \u2212 u0 . Since u\u221e is semiconcave and u0 is C 1 , the function u\u221e must be differentiable at q with du\u221e (q) = du0 (q).\nSince u\u221e solves the Hamilton-Jacobi equation at its points of differentiability, we conclude that\nH(q, du0 (q)) = H(q, du\u221e (q)) = \u03b1(0), hence q \u2208 A(0). We have proved the claim.\nLet us now establish that I(u\u221e ) = A(0), which implies the proposition. By Lemma 36, we\nhave \u0164t u\u221e \u2212 t\u03b1 = u\u221e on I(u\u221e ) for each t > 0. Setting \u000f(t) = sup(u\u221e \u2212 Tt u0 \u2212 t\u03b1(0)), we have\nu\u221e > u0 > \u0164t \u25e6 Tt u0 > \u0164t (u\u221e \u2212 \u000f(t) \u2212 t\u03b1(0)) > \u0164t u\u221e \u2212 \u000f(t) \u2212 t\u03b1(0) = u\u221e \u2212 \u000f(t)\non I(u\u221e ). Since this holds for all t > 0, and since limt\u2212\u2192\u221e \u000f(t) = 0, we conclude that u0 = u\u221e\non I(u\u221e ). On the other hand, we have seen that u0 < u\u221e outside of A(0), hence I(u\u221e ) \u2282 A(0).\n\nWe finish with an easy remark which is specific to the periodic case:\nProposition 47. All periodic weak KAM solutions have level \u03b1(0).\nProof. Let u0 be a critical periodic sub-solution, and let u be a periodic weak KAM solution at\nlevel a. Since u is a periodic sub-solution at level a, the definition of \u03b1(0) implies that a > \u03b1(0).\nOn the other hand, there exists a constant C such that u \u2212 C 6 u0 6 u + C, which implies\nu = Tt u + ta > Tt u0 \u2212 C + ta > u0 + t(a \u2212 \u03b1(0)) \u2212 C > u + t(a \u2212 \u03b1(0)) \u2212 2C.\nWe obtain that t(a \u2212 \u03b1(0)) 6 2C for each t > 0, hence a \u2212 \u03b1(0) 6 0.\n\n10\n\nThe Lagrangian.\n\nIn most expositions of weak KAM theory, the Lagrangian plays an important role. In the present\nsection, we relate it to our main objects in order to facilitate the connection with the core of\nthe literature, where what we state here as properties is usually taken as definitions. We define\nthe Lagrangian as\nL : R \u00d7 Rd \u00d7 Rd \u2212\u2192 R\n(t, q, v) 7\u2212\u2192 sup\np\u2208(Rd )\u2217\n\n36\n\n\u0001\np * v \u2212 H(t, q, p) .\n\n\fBy standard results on convex Analysis, see[19] for example, we then have\n\u0001\nH(t, q, p) = sup p * v \u2212 L(t, q, v) .\nv\u2208Rd\n\nWe obviously have the Legendre inequality\nH(t, q, p) + L(t, q, v) > p * v\nfor all t, q, p, v. This inequality is an equality if and only if\np = \u2202v L(t, q, v) or equivalently v = \u2202p H(t, q, p).\nLet q(t) :]t0 , t1 [\u2212\u2192 M be a curve, The action of q is the number\nZ t1\nL(t, q(t), q\u0307(t))dt.\nt0\n\nWe can also call it Lagrangian action if we want to distinguish from the previously defined\nHamiltonian action. The Lagrangian and Hamiltonian actions are related as follows:\nThe Hamiltonian action of a curve (q(t), p(t)) is smaller than the Lagrangian action of its projection q(t), with equality if and only if p(t) \u2261 \u2202v L(t, q(t), q\u0307(t)). In particular, the Hamiltonian\naction of an orbit is equal to the Lagrangian action of its projection.\nLemma 48. let q0 and q1 be two points of Rd , and t0 , t1 be two times, with 0 < t1 \u2212 t0 < \u03c3. If\n(q(s), p(s)) is the orbit satisfying q(t0 ) = q0 , q(t1 ) = q1 , we have\nZ t1\nZ t1\nt1\nSt0 (q0 , q1 ) =\nL(s, q(s), q\u0307(s))ds = min\nL(s, \u03b8(s), \u03b8\u0307(s))ds,\n\u03b8(s)\n\nt0\n\nt0\n\nwhere the minimum is taken on the set of Lipschitz curves \u03b8 : [t0 , t1 ] \u2212\u2192 Rd which satisfy\n\u03b8(t0 ) = q0 and \u03b8(t1 ) = q1 .\nProof. Since Stt01 (q0 , q1 ) is the Hamiltonian action of the unique orbit (q(t), p(t)), it is also the\nLagrangian action of the curve q(t):\nZ t1\nt1\nSt0 (q0 , q1 ) =\nL(s, q(s), q\u0307(s))ds.\nt0\n\nThe function u(t, q) := Stt0 (q0 , q) solves (HJ) on ]t0 , t1 [\u00d7Rd . Let us now consider any Lipschitz\ncurve \u03b8(s) : [t0 , t1 ] \u2212\u2192 Rd satisfying \u03b8(t0 ) = q0 and \u03b8(t1 ) = q1 , and write\nZ t1\nZ t1\nL(s, \u03b8(s), \u03b8\u0307(s))ds >\n\u2202q u(s, \u03b8(s)) * \u03b8\u0307(s) \u2212 H(s, \u03b8(s), \u2202q u(s, \u03b8(s))ds\nt0\n\nt0\nt1\n\nZ\n\n\u2202q u(s, \u03b8(s)) * \u03b8\u0307(s) \u2212 \u2202t u(s, \u03b8(s))ds\n\n=\nt0\n\n= u(t1 , q1 ) \u2212 u(t0 , q0 ) = Stt01 (q0 , q1 ).\nThe following proposition is usually taken as the definition of A:\nProposition 49. Given two points q0 and q1 and two times t0 < t1 , we have\nZ t1\nt1\nAt0 (q0 , q1 ) = min\nL(s, \u03b8(s), \u03b8\u0307(s))ds,\n\u03b8(s)\n\nt0\n\nwhere the minimum is taken on the set of Lipschitz curves \u03b8 : [t0 , t1 ] \u2212\u2192 Rd which satisfy\n\u03b8(t0 ) = q0 and \u03b8(t1 ) = q1 .\n37\n\n\fIt is part of the statement that the minimum is achieved. This is usually called the Theorem\nof Tonelli. The statement can be extended to absolutely continuous curves instead of Lipschitz\ncurves, but this setting is not useful for our discussion.\nProof. For n large enough, we have (t1 \u2212 t0 )/n < \u03c3, hence, setting \u03c4i = t0 + i(t1 \u2212 t0 )/n,\n\u0001\nAtt10 (q0 , q1 ) =\nmin\nSt\u03c401 (q0 , \u03b81 ) + S\u03c4\u03c412 (\u03b81 , \u03b82 ) + * * * + S\u03c4t1n\u22121 (\u03b8n\u22121 , q1 )\n(\u03b81 ,...,\u03b8n\u22121 )\n\nZ\n=\n\nmin\n\nmin\n\n(\u03b81 ,...,\u03b8n\u22121 )\n\n\u03b8(s)\n\nZ\n\nA\n\nZ\n\nt1\n\nL(s, \u03b8(s), \u03b8\u0307(s))ds + . . . + min\n\u03b8(s)\n\nt0\n\nL(s, \u03b8(s), \u03b8\u0307(s))ds\n\n\u0001\n\n\u03c4n\u22121\n\nt1\n\n= min\n\u03b8(s)\n\n\u03c41\n\nL(s, \u03b8(s), \u03b8\u0307(s))ds.\nt0\n\nSome technical results.\n\nProposition 50. A Lipschitz map F : Rd \u2212\u2192 Rd which satisfies Lip(F \u2212 Id) < 1 is a biLipschitz homeomorphism of Rd . Its inverse is Lipschitz and Lip(F \u22121 ) 6 (1 \u2212 k)\u22121 . If F is C 1 ,\nthen so is F \u22121 .\nProof. The equation F (q) = \u03b8 can be rewritten\n\u03b8 \u2212 (F (q) \u2212 q) = q\nThe map on the left being contracting, we conclude that F is invertible. We now write\n|x1 \u2212 x0 | \u2212 |F (x1 ) \u2212 F (x0 )| 6 |(F (x1 ) \u2212 x1 ) \u2212 (F (x0 ) \u2212 x0 )| 6 k|x1 \u2212 x0 |\nand deduce that |F (x1 ) \u2212 F (x2 )| > (1 \u2212 k)|x1 \u2212 x0 |.\nProposition 51. Let F : Rd \u2212\u2192 Rd be a C 1 , c-monotone map on Rd , with c > 0. Then F is a\ndiffeomorphism from Rd onto itself.\nProof. Let us consider a point \u03b8 \u2208 Rd , and the line \u03b8(s) = F (0) + s(\u03b8 \u2212 F (0)). Since F is\na local diffeomorphism around 0, the points \u03b8(s) for small s have a unique preimage p(s). Let\nS be the infimum of the positive real numbers s such that the equation F (p) = \u03b8(s) does not\nhave a solution in Rd . The curve p(s) is well-defined, C 1 , and Lipschitz on [0, S[, hence, if S is\nfinite, it extends at S with with F (p(S)) = \u03b8(S). Since F is a local diffeomorphism at p(S), the\npoints near \u03b8(S) have preimages, which contradicts the definition of S. Hence S can't be finite.\nLemma 52. Let A be a d \u00d7 d matrix, such that A > aId in the sense of quadratic forms, and\nkAk 6 b. Then A\u22121 > (a/b2 )I in the sense of quadratic forms.\nProof. We have\n(A\u22121 v, v) = (AA\u22121 v, A\u22121 v) > a|A\u22121 v|2 > a(|v|/b)2 .\n\nThe following important result appears in Fathi's book on Weak KAM theory (the proof is\nalso his):\nProposition 53. Let u : Rd \u2212\u2192 R be a function and K be a positive number. Let I \u2208 Rd be\nthe set of points where u has both a K-super-differential and a K-sub-differential. Then, the\nfunction u is differentiable at each point of I and the function q 7\u2212\u2192 du(q) is 6K-Lipschitz on\nI.\n38\n\n\fProof. For each q \u2208 I, there exists a unique l(q) \u2208 Rd\u2217 such that\n|u(q + \u03b8) \u2212 u(q) \u2212 l(q) * \u03b8| 6 Kk\u03b8k2 .\nWe conclude that l(q) is the differential of u at q, and we have to prove that the map q 7\u2212\u2192 l(q)\nis Lipschitz on I. We have, for each q, \u03b8 and y in H:\nl(q) * (y + \u03b8) \u2212 Kky + \u03b8k2 6 u(q + y + \u03b8) \u2212 u(q) 6 l(q) * (y + \u03b8) + Kky + \u03b8k2\nl(q + y) * (\u2212y) \u2212 Kkyk2 6 u(q) \u2212 u(q + y) 6 l(q + y) * (\u2212y) + Kkyk2\nl(q + y) * (\u2212\u03b8) \u2212 Kk\u03b8k2 6 u(q + y) \u2212 u(q + y + \u03b8) 6 l(q + y) * (\u2212\u03b8) + Kk\u03b8k2 .\nTaking the sum, we obtain\n(l(q + y) \u2212 l(q)) * (y + \u03b8) 6 Kky + \u03b8k2 + Kkyk2 + Kkzk2 .\nBy a change of variables, we get\n(l(q + y) \u2212 l(q)) * \u03b8 6 Kk\u03b8k2 + Kkyk2 + Kk\u03b8 \u2212 yk2 .\nTaking k\u03b8k = kyk, we obtain\n(l(q + y) \u2212 l( q)) * (\u03b8) 6 6Kk\u03b8kkyk\nfor each \u03b8 such that k\u03b8k = kyk, we conclude that\nkl(q + y) \u2212 l(q)k 6 6Kkyk.\n\nLemma 54. Let u be a finite valued function which is the infimum of a family F of equi-semiconcave functions: u = inf f \u2208F f . Then the function u is semi-concave.\nIt is important in the statement to assume that u is really finite valued at each point.\nProof. Let us assume that the functions in F are k-semi-concave. Given a point q0 \u2208 Rd let\nfn (q) = an + pn * q + k/2kqk2 be a sequence of functions of F such that fn (q0 ) \u2212\u2192 u(q0 ). We\nhave fn (q) 6 fn (q0 ) + pn * (q \u2212 q0 ) + k/2kq \u2212 q0 k2 for some sequence pn \u2208 R\u2217 . If the sequence pn\nis bounded, then we can take the limit along a subsequence and get the inequality\nu(q) 6 u(q0 ) + p * (q \u2212 q0 ) + k/2kq \u2212 q0 k2 .\nIf this holds for each q0 , we conclude that u is k-semi-concave. Let us now prove that pn is\nbounded. If this was not true, there would exist a point q such that pn * (q \u2212 q0 ) is not bounded\nfrom below. This would imply that\n\u0001\nu(q) = inf f (q) 6 inf fn (q) 6 inf fn (q0 ) + pn * (q \u2212 q0 ) + k/2kq \u2212 q0 k2 = \u2212\u221e,\nf \u2208F\n\nn\n\nn\n\nwhich would contradict the finiteness of u at q.\nAcknowledgements. Many thanks to Lyonell Boulton and Sergei Kuksin for organizing\nthis CANPDE session on Weak KAM theory. I also thank Albert Fathi form many useful\ncomments and suggestions.\n\n39\n\n\fReferences\n[1] L. Alvarez, F. Guichard, P.-L. Lions, J.-M. Morel. Axioms and fundamental equations of image\nprocessing, Arch. Rat. Mech. An. 123 no. 3, 199-257 (1993).\n[2] M. C. Arnaud. Are pseudographs Lagrangian submanifolds? Nonlinearity, 24 no. 1 (2011).\n[3] P. Bernard. Connecting orbits of time dependent lagrangian systems.\n52(5):1533\u20131568, 2002.\n\nAnn. Institut Fourier,\n\n[4] P. Bernard. Existence of C 1,1 critical sub-solutions of the Hamilton\u2013Jacobi equation on compact\nmanifolds. Annales scientifiques de l'Ecole normale sup\u00e9rieure, 40(3):445\u2013452, (2007).\n[5] P. Bernard. Symplectic aspects of Mather theory. Duke Mathematical Journal, 136(3):401\u2013420,\n(2007).\n[6] P. Bernard. The dynamics of pseudographs in convex Hamiltonian systems. J. A. M. S., 21(3):615\u2013\n669, (2008).\n[7] P. Bernard. Lasri-Lions regularisation and a lemma of Ilmanen, Rend. Sem. Mat. Univ. Padova, 124,\n221-229, (2010).\n[8] S. Biton. Nonlinear monotone semigroups and viscosity solutions, Ann. IHP (C) Nonlinear Analysis,\n18, no. 3, 383-402, (2001).\n[9] M. Chaperon : Une id\u00e9e du type g\u00e9od\u00e9siques bris\u00e9es pour les syst\u00e8mes hamiltoniens= A broken geodesic type suggestion for hamiltonian systems, journal=Comptes rendus des s\u00e9ances de\nl'Acad\u00e9mie des sciences. S\u00e9rie 1, Math\u00e9matique, 298, no. 13, 293\u2013296, (1984).\n[10] G. Contreras, R. Iturriaga, G.P. Paternain, and M. Paternain. Lagrangian graphs, minimizing\nmeasures and Ma\u00f1\u00e9's critical values. Geometric and Functional Analysis, 8(5):788\u2013809, (1998).\n[11] G. Contreras. Action potential and weak KAM solutions, Calc. Var. and Part. Diff. Eq., 13, no. 4,\n427\u2013458, (2001),\n[12] A. Fathi. Regularity of C 1 solutions of the Hamilton-Jacobi equation, Ann. Fac. Sci. Toulouse\nMath.(6), 12, no. 4, 479\u2013516, (2003).\n[13] A. Fathi and A. Siconolfi. Existence of C 1 critical sub-solutions of the Hamilton-Jacobi equation.\nInventiones mathematicae, 155(2):363\u2013388, (2004).\n[14] A. Fathi and A. Siconolfi. PDE aspects of Aubry-Mather theory for quasiconvex Hamiltonians.\nCalculus of Variations and Partial Differential Equations, 22(2):185\u2013228, (2005).\n[15] P.L. Lions, G. Papanicolaou and S.R.S. Varadhan, Homogenization of Hamilton-Jacobi equations,\n(1988).\n[16] R. Man\u00e9. Lagrangian flows: the dynamics of globally minimizing orbits. Bulletin of the Brazilian\nMathematical Society, 28(2):141\u2013153, (1997).\n[17] D.M. McDuff and D. Salamon, Introduction to symplectic topology, Oxford Science Publications\n(1995).\n[18] J.N. Mather. Variational construction of connecting orbits. Annales de l'institut Fourier, 43(5):1349\u2013\n1386, (1993).\n[19] R. T.Rockafellar,Convex analysis 1997, Princeton Univ. Press.\n[20] Q. Wei, PhD thesis.\n\n40\n\n\f"}