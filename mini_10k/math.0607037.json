{"id": "http://arxiv.org/abs/math/0607037v2", "guidislink": true, "updated": "2019-10-14T20:20:32Z", "updated_parsed": [2019, 10, 14, 20, 20, 32, 0, 287, 0], "published": "2006-07-03T08:01:26Z", "published_parsed": [2006, 7, 3, 8, 1, 26, 0, 184, 0], "title": "On the structure of essential graphs for AMP chain graph models", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0607786%2Cmath%2F0607563%2Cmath%2F0607487%2Cmath%2F0607783%2Cmath%2F0607433%2Cmath%2F0607364%2Cmath%2F0607099%2Cmath%2F0607335%2Cmath%2F0607048%2Cmath%2F0607536%2Cmath%2F0607238%2Cmath%2F0607214%2Cmath%2F0607608%2Cmath%2F0607759%2Cmath%2F0607560%2Cmath%2F0607180%2Cmath%2F0607244%2Cmath%2F0607213%2Cmath%2F0607502%2Cmath%2F0607362%2Cmath%2F0607056%2Cmath%2F0607550%2Cmath%2F0607318%2Cmath%2F0607640%2Cmath%2F0607653%2Cmath%2F0607805%2Cmath%2F0607743%2Cmath%2F0607779%2Cmath%2F0607755%2Cmath%2F0607057%2Cmath%2F0607546%2Cmath%2F0607333%2Cmath%2F0607416%2Cmath%2F0607511%2Cmath%2F0607196%2Cmath%2F0607756%2Cmath%2F0607701%2Cmath%2F0607142%2Cmath%2F0607594%2Cmath%2F0607443%2Cmath%2F0607770%2Cmath%2F0607413%2Cmath%2F0607025%2Cmath%2F0607764%2Cmath%2F0607508%2Cmath%2F0607661%2Cmath%2F0607078%2Cmath%2F0607707%2Cmath%2F0607286%2Cmath%2F0607232%2Cmath%2F0607215%2Cmath%2F0607781%2Cmath%2F0607776%2Cmath%2F0607697%2Cmath%2F0607681%2Cmath%2F0607278%2Cmath%2F0607483%2Cmath%2F0607494%2Cmath%2F0607404%2Cmath%2F0607807%2Cmath%2F0607754%2Cmath%2F0607561%2Cmath%2F0607304%2Cmath%2F0607449%2Cmath%2F0607394%2Cmath%2F0607600%2Cmath%2F0607448%2Cmath%2F0607695%2Cmath%2F0607310%2Cmath%2F0607149%2Cmath%2F0607220%2Cmath%2F0607091%2Cmath%2F0607444%2Cmath%2F0607176%2Cmath%2F0607734%2Cmath%2F0607463%2Cmath%2F0607042%2Cmath%2F0607523%2Cmath%2F0607328%2Cmath%2F0607341%2Cmath%2F0607332%2Cmath%2F0607037%2Cmath%2F0607366%2Cmath%2F0607104%2Cmath%2F0607465%2Cmath%2F0607660%2Cmath%2F0607299%2Cmath%2F0607822%2Cmath%2F0607726%2Cmath%2F0607380%2Cmath%2F0607538%2Cmath%2F0607646%2Cmath%2F0607656%2Cmath%2F0607294%2Cmath%2F0607313%2Cmath%2F0607504%2Cmath%2F0607752%2Cmath%2F0607657%2Cmath%2F0607031%2Cmath%2F0607135%2Cmath%2F0607177&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the structure of essential graphs for AMP chain graph models"}, "summary": "Chain graphs (CG) use undirected and directed edges to represent both\nstructural and associative dependences. Like acyclic directed graphs (ADGs),\nthe CG associated with a statistical Markov model may not be unique, so CGs\nfall into Markov equivalence classes, which may be superexponentially large,\nleading to unidentifiability and computational inefficiency in model search and\nselection.Under the Andersson--Madigan--Perlman (AMP) interpretation of a CG,\neach Markov-equivalence class can be uniquely represented by a single CG, the\nAMP essential graph, that can be used for efficient inference and model search\nand selection. Here the graphical structure of an AMP essential graph is\nstudied in detail. This structural information will be useful for algorithmic\nconstruction of the essential graph.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0607786%2Cmath%2F0607563%2Cmath%2F0607487%2Cmath%2F0607783%2Cmath%2F0607433%2Cmath%2F0607364%2Cmath%2F0607099%2Cmath%2F0607335%2Cmath%2F0607048%2Cmath%2F0607536%2Cmath%2F0607238%2Cmath%2F0607214%2Cmath%2F0607608%2Cmath%2F0607759%2Cmath%2F0607560%2Cmath%2F0607180%2Cmath%2F0607244%2Cmath%2F0607213%2Cmath%2F0607502%2Cmath%2F0607362%2Cmath%2F0607056%2Cmath%2F0607550%2Cmath%2F0607318%2Cmath%2F0607640%2Cmath%2F0607653%2Cmath%2F0607805%2Cmath%2F0607743%2Cmath%2F0607779%2Cmath%2F0607755%2Cmath%2F0607057%2Cmath%2F0607546%2Cmath%2F0607333%2Cmath%2F0607416%2Cmath%2F0607511%2Cmath%2F0607196%2Cmath%2F0607756%2Cmath%2F0607701%2Cmath%2F0607142%2Cmath%2F0607594%2Cmath%2F0607443%2Cmath%2F0607770%2Cmath%2F0607413%2Cmath%2F0607025%2Cmath%2F0607764%2Cmath%2F0607508%2Cmath%2F0607661%2Cmath%2F0607078%2Cmath%2F0607707%2Cmath%2F0607286%2Cmath%2F0607232%2Cmath%2F0607215%2Cmath%2F0607781%2Cmath%2F0607776%2Cmath%2F0607697%2Cmath%2F0607681%2Cmath%2F0607278%2Cmath%2F0607483%2Cmath%2F0607494%2Cmath%2F0607404%2Cmath%2F0607807%2Cmath%2F0607754%2Cmath%2F0607561%2Cmath%2F0607304%2Cmath%2F0607449%2Cmath%2F0607394%2Cmath%2F0607600%2Cmath%2F0607448%2Cmath%2F0607695%2Cmath%2F0607310%2Cmath%2F0607149%2Cmath%2F0607220%2Cmath%2F0607091%2Cmath%2F0607444%2Cmath%2F0607176%2Cmath%2F0607734%2Cmath%2F0607463%2Cmath%2F0607042%2Cmath%2F0607523%2Cmath%2F0607328%2Cmath%2F0607341%2Cmath%2F0607332%2Cmath%2F0607037%2Cmath%2F0607366%2Cmath%2F0607104%2Cmath%2F0607465%2Cmath%2F0607660%2Cmath%2F0607299%2Cmath%2F0607822%2Cmath%2F0607726%2Cmath%2F0607380%2Cmath%2F0607538%2Cmath%2F0607646%2Cmath%2F0607656%2Cmath%2F0607294%2Cmath%2F0607313%2Cmath%2F0607504%2Cmath%2F0607752%2Cmath%2F0607657%2Cmath%2F0607031%2Cmath%2F0607135%2Cmath%2F0607177&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Chain graphs (CG) use undirected and directed edges to represent both\nstructural and associative dependences. Like acyclic directed graphs (ADGs),\nthe CG associated with a statistical Markov model may not be unique, so CGs\nfall into Markov equivalence classes, which may be superexponentially large,\nleading to unidentifiability and computational inefficiency in model search and\nselection.Under the Andersson--Madigan--Perlman (AMP) interpretation of a CG,\neach Markov-equivalence class can be uniquely represented by a single CG, the\nAMP essential graph, that can be used for efficient inference and model search\nand selection. Here the graphical structure of an AMP essential graph is\nstudied in detail. This structural information will be useful for algorithmic\nconstruction of the essential graph."}, "authors": ["Steen A. Andersson", "Michael D. Perlman"], "author_detail": {"name": "Michael D. Perlman"}, "author": "Michael D. Perlman", "arxiv_comment": "36 pages, 10 figures", "links": [{"href": "http://arxiv.org/abs/math/0607037v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0607037v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "stat.TH", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "62M45, 60K99 (Primary) 68R10, 68T30 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0607037v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0607037v2", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0607037v1 [math.ST] 3 Jul 2006\n\nThe Annals of Statistics\n2006, Vol. 34, No. 2, 939\u2013972\nDOI: 10.1214/009053606000000173\nc Institute of Mathematical Statistics, 2006\n\nCHARACTERIZING MARKOV EQUIVALENCE CLASSES\nFOR AMP CHAIN GRAPH MODELS1\nBy Steen A. Andersson and Michael D. Perlman\nIndiana University and University of Washington\nChain graphs (CG) (= adicyclic graphs) use undirected and directed edges to represent both structural and associative dependences.\nLike acyclic directed graphs (ADGs), the CG associated with a statistical Markov model may not be unique, so CGs fall into Markov\nequivalence classes, which may be superexponentially large, leading\nto unidentifiability and computational inefficiency in model search\nand selection. It is shown here that, under the Andersson\u2013Madigan\u2013\nPerlman (AMP) interpretation of a CG, each Markov-equivalence\nclass can be uniquely represented by a single distinguished CG, the\nAMP essential graph, that is itself simultaneously Markov equivalent\nto all CGs in the AMP Markov equivalence class. A complete characterization of AMP essential graphs is obtained. Like the essential\ngraph previously introduced for ADGs, the AMP essential graph will\nplay a fundamental role for inference and model search and selection\nfor AMP CG models.\n\n1. Introduction. In a graphical Markov model, the nodes of the graph\nrepresent the variables of a multivariate statistical distribution, while the\nedges represent possible dependences. Chain graphs (CG), which may have\nboth undirected and directed edges but no semi-directed cycles, were introduced by Lauritzen and Wermuth [19] and Frydenberg [15] to represent\ndependences that may be both associative and directional. Cox [12] stated\nthat chain graphs represent \"a minimal level of complexity needed to model\nempirical data.\" Also see [2, 8, 9, 13, 15, 17, 18, 19, 25, 26, 28, 29].\nThe LWF Markov property for CGs is an extension of the Markov properties of both acyclic directed graphs (ADG \u2261 DAG) and undirected graphs\n(UG). Recently, Andersson, Madigan and Perlman [1, 4] proposed an alternative Markov property (AMP) for CGs that also extends the ADG and UG\nReceived June 2004; revised June 2005.\nSupported in part by NSF Grants DMS-00-71818 and DMS-00-71920.\nAMS 2000 subject classifications. Primary 62M45, 60K99; secondary 68R10, 68T30.\nKey words and phrases. Graphical model, chain graph, Markov equivalence, essential\ngraph.\n1\n\nThis is an electronic reprint of the original article published by the\nInstitute of Mathematical Statistics in The Annals of Statistics,\n2006, Vol. 34, No. 2, 939\u2013972. This reprint differs from the original in pagination\nand typographic detail.\n1\n\n\f2\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nproperties, but that more closely retains the recursive character of ADG\nmodels; see [14, 20]. Furthermore, AMP Markov equivalence of CGs (see\nbelow), as for ADGs, is determined by their triplexes, which have three\nvertices, while LWF Markov equivalence of CGs is determined by their complexes, which have arbitrarily many vertices.\nLike ADGs, different CGs may be Markov equivalent, that is, may represent the same set of conditional independences (CI), hence, the same statistical models. Because Markov equivalence classes can be superexponentially\nlarge even for ADGs (cf. [3]), for the sake of computational efficiency, CG\nmodel search ideally should be carried out in the space of CG Markov equivalence classes rather than the space of all CGs.\nFor any CG G, Frydenberg [15] showed the existence of a unique largest\n(i.e., having the most undirected edges) CG G\u221e in the LWF Markov equivalence class containing G. Studen\u00fd [23, 24] proposed that G\u221e be used as\na unique representative for the LWF equivalence class. Characterizations of\nG\u221e have been obtained by Volf and Studen\u00fd [27] and Roverato [22].\nThe ADG essential graph D \u2217 that uniquely represents the ADG Markov\nequivalence class of an ADG D was introduced by Andersson, Madigan and\nPerlman [3]: D \u2217 has the same skeleton as D, and contains an arrow a \u2192 b\niff this arrow occurs in every member of the equivalence class, whereas it\ncontains a line a \u2212 b iff a \u2192 b and a \u2190 b occur in two different ADGs in the\nequivalence class. Applications of the ADG essential graph for ADG model\nsearch are presented in [10] and [21].\nThis paper is devoted to the characterization of a unique representative\nof the AMP Markov equivalence class (temporarily denoted by [G]) for a\ngeneral CG G. Andersson, Madigan and Perlman [4] suggested the following\nextension of the definition of the ADG essential graph: the AMP essential\ngraph, temporarily denoted by G\u2217 , has the same skeleton as G and contains\n\nFig. 1.\n\nTwo CGs G for which G = G\u2217 6= G\u221e .\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\nFig. 2.\n\n3\n\nAn undirected CG G whose essential graph G\u2217 contains a directed edge.\n\nan arrow a \u2192 b iff this arrow occurs with the same orientation in at least\none G\u2032 \u2208 [G], but with the opposite orientation in no G\u2032\u2032 \u2208 [G]. The arrows\nin G\u2217 are called essential arrows. For example, if G = a \u2192 b \u2212 c, then [G]\nconsists of G, G\u2032 := a \u2212 b \u2190 c, and G\u2032\u2032 := a \u2192 b \u2190 c, so G\u2217 = G\u2032\u2032 .\nBecause G\u221e is defined for LWF Markov equivalence rather than AMP\nequivalence, it need not agree with G\u2217 , even when G = D, an ADG. For\nexample, if G is the first CG (an ADG) in Figure 1, then G = G\u2217 , but G\u221e\nreplaces one arrow \u2192 by a line \u2212. Similarly, for the second CG G in Figure 1,\ntwo arrows are replaced by lines in G\u221e . In fact, even if G (and therefore G\u221e )\nis a fully undirected graph, G\u2217 may possess essential arrows-see Figure 2.\nIn Section 3 we show that the AMP essential graph G\u2217 does in fact\nuniquely represent its AMP Markov equivalence class [G]: G\u2217 is itself a\nCG (adicyclic) and G\u2217 \u2208 [G] (Theorem 3.2). Section 4 completely describes\nthe configurations of arrows in G\u2217 . It is also shown there that if G is itself\nan ADG D or is AMP Markov equivalent to D, then G\u2217 = D \u2217 (Proposition 4.2), and a characterization of those directed graphs that can occur\nas AMP essential graphs is given (Theorem 4.1). In Section 5 a complete\ncharacterization is obtained for AMP essential graphs (Theorem 5.1). Additional results on the structure of AMP essential graphs may be found in\n[5, 6]. Current research, including an algorithm for constructing G\u2217 from G,\nis reviewed in Section 6.\n2. Graphical terminology. We write G \u2261 (V, E) to indicate a graph G\nwith vertex set V and edge set E. Definitions of the graphical terminology and notation used here can be found in [3, 4] and especially [5]. The\nterms parent, neighbor, immorality, flag, triplex and biflag are particularly\nimportant for our study of chain graphs.\nLet a, b be distinct vertices of G. We write a \u21d2 b \u2208 G (a \u2194 b \u2208 G) (a * * * b \u2208 G)\nto indicate that either a \u2192 b \u2208 G or a \u2212 b \u2208 G (either a \u2190 b \u2208 G or a \u2192 b \u2208 G)\n(either a \u2190 b \u2208 G, a \u2212 b \u2208 G, or a \u2192 b \u2208 G). A path \u03c0 of length k \u2265 1 from a\nto b in G is a sequence of distinct vertices (a \u2261 v0 , v1 , . . . , vk \u2261 b) such that\nvi\u22121 \u21d2 vi \u2208 G for all i = 1, . . . , k. A k-cycle (v0 , . . . , vk ) (or simply cycle)\nin G is a path of length k \u2265 3 with v0 = vk . A path or cycle (v0 , . . . , vk ) is\nundirected if vi\u22121 \u2212 vi \u2208 G for all i = 1, . . . , k; it is directed (semi-directed)\nif vi\u22121 \u2192 vi \u2208 G for all (at least one) i = 1, . . . , k. A chain graph (CG) is an\nadicyclic graph, that is, has no semi-directed cycles. An induced subgraph\n\n\f4\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nof an adicyclic graph is adicyclic. The set of chain components of the CG\nG, denoted by \u039e \u2261 \u039e(G), is the set of connected components obtained by\nremoving all arrows from G.\nA path (cycle) (v0 , . . . , vk ) in G with k \u2265 2 (k \u2265 4) is chordless if no two\nnonconsecutive [nonconsecutive (mod k)] vertices are adjacent. A chordless\n2-dipath in G is an induced subgraph of the form a \u2192 b \u2192 c. An antiflag is\nan induced subgraph of the form a \u2212 b \u2192 c.\nAn undirected graph G is chordal (\u2261 decomposable) if it contains no\nchordless cycles. The edges of a chordal UG G \u2261 (V, E) can be assigned\na perfect orientation (i.e., acyclic with no immoralities) by the maximum\ncardinality search (MCS) algorithm (cf. [7], Theorem 2.5, [11], Chapter 4.4).\nMCS begins by assigning the number 1 to an arbitrary vertex of G, then\nassigning the numbers 2, . . . , |V | consecutively to the remaining vertices, each\ntime selecting the vertex with the most previously numbered neighbors in G,\nbreaking ties arbitrarily. The edges of G are then oriented in accordance with\nthis numbering. This numbering is called perfect because this orientation can\nbe shown to be perfect. Furthermore, if A \u2286 V is complete, MCS can begin\nat any v \u2208 A and visit all vertices in A before visiting any vertex in V \\ A.\nThus, any edge a \u2212 v \u2208 G with a \u2208 A and v \u2208 V \\ A can be oriented by MCS\nas a \u2192 v.\n3. The essential graph for an AMP chain graph model. In this paper\nG0 \u2261 (V, E0 ) shall denote a fixed but arbitrary chain graph and G its AMP\nMarkov equivalence class, that is, the collection of all CGs G \u2261 (V, E) such\nthat P(G) = P(G0 ), where P(G) is the set of all multivariate probability\ndistributions that satisfy the AMP Markov property specified by G. AMP\nMarkov equivalence was characterized by Andersson, Madigan and Perlman\n[4] as follows.\nTheorem 3.1. Two chain graphs with the same vertex set are Markov\nequivalent iff they have the same skeleton and the same triplexes.\nWe shall show that G is uniquely represented by its essential graph G \u2217 ,\ndefined below. To emphasize that the AMP essential graph depends on G,\nwe now denote it by G \u2217 , rather than by G\u22170 as in Section 1.\nDefinition 3.1. The AMP essential graph G \u2217 \u2261 (V, E \u2217 ) determined by\nG is a graph with the same skeleton as G0 . An arrow a \u2192 b occurs in G \u2217 iff\na \u2192 b occurs in at least one G \u2208 G, but a \u2190 b occurs in no G\u2032 \u2208 G. A line\na \u2212 b occurs in G \u2217 iff either a \u2212 b \u2208 G for every G \u2208 G or there exist G, G\u2032 \u2208 G\nsuch that a \u2192 b \u2208 G and a \u2190 b \u2208 G\u2032 .\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\nFig. 3.\n\n5\n\nStrong/weak arrows/lines in AMP essential graphs (cf. Figure 6).\n\nThus, the line a \u2212 b \u2208 G \u2217 iff either : a \u2212 b \u2208 G for all G \u2208 G, in which case\ns\nit is called a strong line and denoted as a \u2013 b, or : a \u2192 b \u2208 G and a \u2190 b \u2208 G\u2032\nfor some G, G\u2032 \u2208 G, in which case it is called a weak line and denoted as\nw\na \u2013 b. In these two cases, a is a strong (resp., weak ) neighbor of b. An arrow\ns\na \u2192 b \u2208 G \u2217 is called strong and denoted as a \u2192 b if it occurs in each G \u2208 G;\nw\notherwise it is called weak and denoted as a \u2192 b, in which case \u2203 G, G\u2032 \u2208 G\nsuch that a \u2192 b \u2208 G and a \u2212 b \u2208 G\u2032 , while a \u21d2 b \u2208 G\u2032\u2032 for all other G\u2032\u2032 \u2208 G.\nIn these two cases, a is a strong (resp., weak ) parent of b. The set of strong\n(weak) parents in G \u2217 of a subset B \u2282 V is denoted by spG \u2217 (B) [wpG \u2217 (B)].\nIn the AMP essential graph a \u2192 b \u2190 c, both arrows are weak, while in\na \u2212 b \u2212 c both lines are weak. Other examples of strong/weak arrows/lines\nare given in Figures 3, 4 and 7. (Also see [5, 6].)\nThe following fact will be used repeatedly. Consider the four statements:\n1.\n2.\n3.\n4.\n\na \u2192 b \u2208 G\u2217;\na \u21d2 b \u2208 G for all G \u2208 G;\na \u2192 b \u2208 G for some G \u2208 G;\na \u21d2 b \u2208 G\u2217.\n\nThen 1 implies 2 implies 4 and, equivalently, 1 implies 3 implies 4.\nThis section will culminate with Theorem 3.2, which establishes that G \u2217\nis in fact adicyclic so is itself a chain graph. Thus, G \u2217 \u2208 G by the following\nLemma 3.1 and, therefore, G \u2217 uniquely represents G: G1 = G2 iff G1\u2217 = G2\u2217 .\nLemma 3.1.\n\nG \u2217 has the same skeleton and triplexes as each G \u2208 G.\n\nProof. Clearly, G \u2217 has the same skeleton as each G \u2208 G. Suppose that\nthe triplex ({a, c}, b) occurs in each G \u2208 G, so a \u21d2 b \u21d0 c occurs as an induced\n\n\f6\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nFig. 4.\n\nStrong/weak arrows/lines in AMP essential graphs (cf. Figure 6).\n\nsubgraph in each G \u2208 G, hence, also a \u21d2 b \u21d0 c occurs as an induced subgraph\nin G \u2217 . Furthermore, there exists G \u2208 G such that either a \u2192 b \u2208 G, in which\ncase a \u2192 b \u2208 G \u2217 , or b \u2190 c \u2208 G, in which case b \u2190 c \u2208 G \u2217 . In both cases, the\ntriplex ({a, c}, b) occurs in G \u2217 , as required.\nConversely, suppose that the triplex ({a, c}, b) occurs in G \u2217 . If this triplex\noccurs as the immorality a \u2192 b \u2190 c in G \u2217 , then a \u21d2 b \u21d0 c occurs as an\ninduced subgraph in each G \u2208 G while a \u2192 b \u2208 G\u2032 for some G\u2032 \u2208 G, hence,\nthis triplex occurs in G\u2032 and thus in all G \u2208 G.\nIf this triplex occurs as the flag a \u2192 b \u2212 c in G \u2217 , then a \u21d2 b \u2208 G for every\nG \u2208 G. If b \u2212 c were a weak line in G \u2217 , then there would exist G, G\u2032 \u2208 G such\nthat a \u21d2 b \u2192 c occurs in G and a \u21d2 b \u2190 c occurs in G\u2032 , both as induced\nsubgraphs, contradicting the fact that G and G\u2032 have the same triplexes.\nTherefore, b \u2212 c must be a strong line in G \u2217 . By a similar argument, a \u2192 b\nmust be a strong arrow in G \u2217 and, therefore, a \u2192 b \u2212 c occurs as a flag in\neach G \u2208 G. Thus, again the triplex ({a, c}, b) occurs in each G \u2208 G. \u0003\nLemma 3.2. ( a) A flag a \u2192 b\u2212 c occurs in G \u2217 iff it occurs in each G \u2208 G,\nin which case a \u2192 b is a strong arrow and b \u2212 c is a strong line. Thus, neither\nw\ns\nw\na \u2192 b \u2013 c nor a \u2192 b \u2013 c can occur as an induced subgraph of G \u2217 .\nw\n(b) \u2022 If a \u2192 b \u2013 c occurs as a subgraph in G \u2217 , then a \u21d2 c \u2208 G \u2217 .\ns\nw\nw\n\u2022 If a \u2192 b \u2013 c occurs as a subgraph in G \u2217 , then a \u2192 c \u2208 G \u2217 .\ns\nw\ns\n\u2022 If a \u2192 b \u2192 c occurs as a subgraph in G \u2217 , then a \u2192 c \u2208 G \u2217 .\ns w\nw\n\u2022 If a \u2013 b \u2013 c occurs as a subgraph in G \u2217 , then a \u2013 c \u2208 G \u2217 .\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n7\n\nProof. (a) \"Only if\" was established in the last paragraph of the proof\nof Lemma 3.1, while \"if\" is immediate.\nw\n(b) If a \u2192 b \u2013 c occurs in G \u2217 , then by (a) a * * * c \u2208 G \u2217 and, therefore, a * * * c\noccurs in all G \u2208 G. Choose G \u2208 G such that b \u2192 c \u2208 G. Since necessarily\na \u21d2 b \u2208 G, therefore, a \u2192 c \u2208 G by adicyclicity, hence a \u21d2 c \u2208 G \u2217 .\ns\nw\nIf a \u2192 b \u2013 c occurs in G \u2217 , then by (a) the triangle a \u21d2 b \u2212 c * * * a occurs in\nall G \u2208 G, hence a \u21d2 c \u2208 G by adicyclicity. If we now choose G, G\u2032 \u2208 G such\nthat a \u2192 b \u2208 G and a \u2212 b \u2208 G\u2032 , then a \u2192 c \u2208 G and a \u2212 c \u2208 G\u2032 by adicyclicity,\nw\nhence a \u2192 c \u2208 G \u2217 .\ns\nw\nIf a \u2192 b \u2192 c occurs in G \u2217 , then a \u2192 b \u21d2 c occurs in every G \u2208 G and\na \u2192 b \u2212 c occurs in some G\u2032 \u2208 G. Since G \u2217 and G\u2032 have the same triplexes by\nLemma 3.1, a * * * c \u2208 G\u2032 , so the triangle a \u2192 b \u21d2 c * * * a occurs in every G \u2208 G.\ns\nThus, a \u2192 c must occur in every G \u2208 G by adicyclicity, hence a \u2192 c \u2208 G \u2217 .\ns w\nIf a \u2013 b \u2013 c occurs in G \u2217 , then there exist G, G\u2032 \u2208 G such that a \u2212 b \u2192 c occurs in G and a \u2212 b \u2190 c occurs in G\u2032 . Since G and G\u2032 have the same triplexes,\nnecessarily a * * * c \u2208 G, G\u2032 , hence a \u2192 c \u2208 G and a \u2190 c \u2208 G\u2032 by adicyclicity.\nw\nTherefore, a \u2013 c \u2208 G \u2217 . \u0003\nLemma 3.3. A biflag or chordless undirected cycle occurs in G \u2217 iff it\noccurs in at least one G \u2208 G, in which case it occurs in all G \u2208 G. Thus, if\nan arrow occurs in a biflag in G \u2217 or some G \u2208 G, then it must be strong,\nwhile if a line occurs in some biflag or chordless undirected cycle in G \u2217 or\nin some G \u2208 G, then it must be strong.\nProof. If a biflag [a; c1 , . . . , ck ] (k \u2265 3) or [a, b; c1 , . . . , ck ] (k \u2265 2) ocs w\ncurs in G \u2217 , then, because \u2013 \u2013 cannot occur as an induced subgraph in G \u2217\n[Lemma 3.2(b)], either all undirected edges ci \u2212 ci+1 (1 \u2264 i \u2264 k) are strong\ns\ns\nor all are weak. Since the flag a \u2192 ck\u22121 \u2013 ck occurs in G \u2217 , therefore all edges\nci \u2212 ci+1 are strong. Furthermore, if any arrow a \u2192 ci or b \u2192 ci is weak, then\nall must be weak [apply Lemma 3.2(b)], a contradiction. Thus, all arrows\nand lines occurring in the biflag are strong, hence the biflag occurs in every\nG \u2208 G.\nConversely, if a biflag [a; c1 , . . . , ck ] or [a, b; c1 , . . . , ck ] occurs in some G \u2208 G,\nthen the triplex ({a, ck }, ck\u22121 ) occurs in G \u2217 . If this triplex occurs as the flag\ns\ns\na \u2192 ck\u22121 \u2013 ck , then the above argument applies to show that the biflag\noccurs in every G \u2208 G and in G \u2217 . But the triplex cannot occur in either of\nthe other two possible configurations: If it did, then ck\u22121 \u2190 ck \u2208 G \u2217 , which\nwould require that c1 \u2190 c2 \u2208 G \u2217 . (If c1 \u21d2 c2 \u2208 G \u2217 , then at least one triplex\nwould occur in the path c1 \u21d2 c2 * * * ck\u22121 \u2190 ck in G \u2217 , whereas no such triplex\noccurs in G, contradicting Lemma 3.1.) But c1 \u2190 c2 \u2208\n/ G \u2217 , since a \u2192 c2 \u2212 c1\nor b \u2192 c2 \u2212 c1 occurs as a flag in G, so ({a, c1 }, c2 ) \u2208 G \u2217 or ({b, c1 }, c2 ) \u2208 G \u2217 .\n\n\f8\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nNext, suppose that a chordless undirected cycle occurs in G \u2217 or in some\nG \u2208 G. Because no triplex occurs in this cycle, none can occur in the corresponding subgraph in any G\u2032 \u2208 G. Therefore, no arrow can occur in this\nsubgraph in any G\u2032 \u2208 G; otherwise this subgraph would either include at\nleast one triplex or else be a fully directed cycle, contradicting the adicylicity of G\u2032 . Thus, the chordless undirected cycle occurs in every G\u2032 \u2208 G \u2217 and\neach of its lines is a strong line. \u0003\nThe converse to the second statement in Lemma 3.3 is not true: strong\narrows not occurring in biflags appear in Figures 3(1) and 4(1)\u2013(5). Strong\nlines not in biflags or chordless cycles may also occur; see [5, 6].\nLemma 3.4. ( a) Any semi-directed cycle in G \u2217 has at least one weak\nline.\n(b) If a \u2192 b \u21d2 d \u21d2 a is a semi-directed 3-cycle in G \u2217 , then \u2203 G, G\u2032 \u2208 G\nsuch that a \u21d2 b \u2190 d \u2192 a occurs in G and a \u21d2 b \u2192 d \u2190 a occurs in G\u2032 . Thus,\nw w\nthe semi-directed 3-cycle must have the form a \u2192 b \u2013 d \u2013 a in G \u2217 .\n(c) In this case, a \u2192 b cannot occur in G \u2217 in an immorality a \u2192 b \u2190 c,\nin a flag a \u2192 b \u2212 c, in a chordless 2-dipath c \u2192 a \u2192 b or in an antiflag of\ns\nthe form c \u2013 a \u2192 b.\nProof. (a) Let d0 \u2192 d1 \u21d2 * * * \u21d2 (dk \u2261 d0 ) (k \u2265 3) be a semi-directed\nk-cycle in G \u2217 . Then \u2203 G \u2208 G such that d0 \u2192 d1 \u2208 G. Since G is adicyclic,\ndi \u2190 di+1 \u2208 G for some 1 \u2264 i \u2264 k \u2212 1, hence di \u21d0 di+1 \u2208 G \u2217 . But di \u21d2 di+1 \u2208\nw\nG \u2217 , so di \u2013 di+1 \u2208 G \u2217 as required.\nw\nw\n(b) By (a), either b \u2013 d \u2208 G \u2217 or d \u2013 a \u2208 G \u2217 (or both). If the former, then\n\u2203 G\u2032 \u2208 G such that b \u2192 d \u2208 G\u2032 . Since a \u21d2 b \u2208 G\u2032 , d \u2190 a \u2208 G\u2032 by adicyclicity.\nw\nTherefore, d \u21d0 a \u2208 G \u2217 , hence d \u2013 a \u2208 G \u2217 (since d \u21d2 a \u2208 G \u2217 and d \u2190 a \u2208 G\u2032 ),\nso \u2203 G \u2208 G such that d \u2192 a \u2208 G. Since a \u21d2 b \u2208 G, b \u2190 d \u2208 G by adicyclicity.\nIf the latter, then \u2203 G \u2208 G such that d \u2192 a \u2208 G. Since a \u21d2 b \u2208 G, necessarily\nw\nb \u2190 d \u2208 G by adicyclicity. Thus, b \u2013 d \u2208 G \u2217 (since b \u21d2 d \u2208 G \u2217 ), so \u2203 G\u2032 \u2208 G\nsuch that b \u2192 d \u2208 G\u2032 . Since a \u21d2 b \u2208 G\u2032 , d \u2190 a \u2208 G\u2032 by adicyclicity.\n(c) Assume that a \u2192 b \u21d0 c occurs as an immorality or flag in G \u2217 . Let G, G\u2032\nbe as specified in (b). Since a*6**c, necessarily c 6= d. Because G \u2217 , G, G\u2032 have the\nsame triplexes (Lemma 3.1), b \u21d0 c \u2208 G, G\u2032 . Necessarily d * * * c, for otherwise\nthe triplex ({d, c}, b) would occur as the induced subgraph d \u2192 b \u2190 c in G\nbut this triplex could not occur in G\u2032 . Thus, by adicyclicity, d \u2190 c \u2208 G\u2032 , so\nthe triplex ({a, c}, d) occurs as the immorality a \u2192 d \u2190 c in G\u2032 , but this\ntriplex cannot occur in G, a contradiction.\nNext, assume that either (i) the chordless 2-dipath c \u2192 a \u2192 b or (ii) the\ns\nantiflag c \u2013 a \u2192 b occurs in G \u2217 . Let G, G\u2032 be as specified in (b); again, necessarily c 6= d. For both (i) and (ii), necessarily c \u21d2 a \u2208 G, G\u2032 . Therefore,\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n9\n\nc * * * d, for otherwise the triplex ({c, d}, a) would occur as the induced subgraph c \u21d2 a \u2190 d in G, but this triplex could not occur in G\u2032 . Thus, by\nadicyclicity, c \u2192 d \u2208 G\u2032 , so the triplex ({c, b}, d) occurs as the immorality\nc \u2192 d \u2190 b in G\u2032 , but this triplex cannot occur in G, a contradiction. \u0003\nFor any graph H \u2261 (W, F ), define H \u25e6 \u2261 (W, F \u25e6 ) to be the smallest chain\ngraph larger than H, that is, H \u25e6 is obtained from H by converting any\narrow that occurs in a semi-directed cycle in H into a line. Note that this\ncan be done in a single step: if, after converting an arrow that occurs in a\nsemi-directed cycle in H into a line, a second arrow now becomes part of a\nsemi-directed cycle, then this second arrow already must have occurred in a\nsemi-directed cycle in H. Clearly, H \u25e6 has the same skeleton as H, H \u2286 H \u25e6 ,\nand H is adicyclic iff H \u25e6 = H.\nLemma 3.5. ( a) G \u2217 and (G \u2217 )\u25e6 have the same immoralities.\n(b) G \u2217 and (G \u2217 )\u25e6 have the same flags.\ns\n(c) If an antiflag of the form a \u2013 b \u2192 c occurs G \u2217 , it also occurs in (G \u2217 )\u25e6 .\nProof. (a) Since G \u2217 \u2286 (G \u2217 )\u25e6 with the same skeletons, if a \u2192 b \u2190 c occurs as an immorality in (G \u2217 )\u25e6 , then it must occur in G \u2217 . Conversely, suppose that a \u2192 b \u2190 c occurs as an immorality in G \u2217 but not in (G \u2217 )\u25e6 . This\ncan happen only if at least one of the two arrows is converted to a line\nin (G \u2217 )\u25e6 , hence occurs in some semi-directed cycle in G \u2217 . Choose the immorality a \u2192 b \u2190 c that is associated with a semi-directed cycle of minimum\nlength k [i.e., minimal with respect to all immoralities a\u2032 \u2192 b\u2032 \u2190 c\u2032 in G \u2217\nthat do not occur in (G \u2217 )\u25e6 ] and assume without loss of generality that this\nminimum-length semi-directed cycle contains a \u2192 b. This cycle thus has the\nform a \u2192 (b \u2261 d1 ) \u21d2 d2 \u21d2 * * * \u21d2 (dk \u2261 a) in G \u2217 . By Lemma 3.4(c), k \u2265 4.\nIt is conceivable that di = c for some (at most one) i = 3, . . . , k \u2212 2. In\nthat case, however, (di \u2261 c) \u2192 b occurs in a shorter semi-directed cycle c \u2192\n(b \u2261 d1 ) \u21d2 * * * \u21d2 (di \u2261 c) in G \u2217 , contradicting the minimality of k. Therefore,\ndi 6= c for each i.\nBy Lemma 3.4(a), the minimum-length semi-directed cycle has at least\nw\none weak line dj \u2013 dj+1 \u2208 G \u2217 (1 \u2264 j \u2264 k \u2212 1). Consider the least such j.\nSuppose first that j \u2265 2. In this case the minimality of j implies that either\nw\ns\nw\ndj\u22121 \u2192 dj \u2013 dj+1 or dj\u22121 \u2013 dj \u2013 dj+1 occurs in G \u2217 , hence dj\u22121 \u21d2 dj+1 \u2208 G \u2217\ns\nby Lemma 3.2(b). Thus, a \u2192 (b \u2261 d1 ) \u21d2 * * * \u21d2 dj\u22121 \u21d2 dj+1 \u21d2 * * * \u21d2 (dk \u2261 a)\nis a shorter semi-directed cycle in G \u2217 , contradicting the minimality of k.\nw\nw\nSuppose now that j = 1, so (b \u2261 d1 ) \u2013 d2 \u2208 G \u2217 . Therefore, a \u2192 b \u2013 d2 and\nw\nd2 \u2013 b \u2190 c occur as subgraphs in G \u2217 , so by Lemma 3.2(b), a \u21d2 d2 \u21d0 c occurs\nas a subgraph of G \u2217 . If a \u2212 d2 \u2208 G \u2217 , then a \u2192 b occurs in the semi-directed\n3-cycle a \u2192 b \u2212 d2 \u2212 a in G \u2217 , contradicting Lemma 3.4(c), hence a \u2192 d2 \u2208 G \u2217 .\n\n\f10\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nSimilarly, d2 \u2190 c \u2208 G \u2217 , hence a \u2192 d2 \u2190 c occurs as an immorality in G \u2217 .\nBut then a \u2192 d2 occurs in the shorter semi-directed cycle a \u2192 d2 \u21d2 * * * \u21d2\n(dk \u2261 a) in G \u2217 , contradicting the minimality of k. We conclude that every\nimmorality in G \u2217 also occurs in (G \u2217 )\u25e6 .\ns\ns\n(b) If a flag occurs in G \u2217 , it has the form a \u2192 b \u2013 c by Lemma 3.2(a).\nBecause G \u2217 \u2286 (G \u2217 )\u25e6 and they have the same skeletons, if a \u2192 b \u2212 c does\nnot occur as a flag in (G \u2217 )\u25e6 , then a \u2212 b \u2212 c must occur in (G \u2217 )\u25e6 with a*6 ** c\ns\nin both graphs. This implies that a \u2192 b occurs in a semi-directed cycle\ns\na \u2192 (b \u2261 d1 ) \u21d2 d2 \u21d2 * * * \u21d2 (dk \u2261 a) in G \u2217 . Choose this cycle to minimize k;\nby Lemma 3.4(c), k \u2265 4.\nIt is conceivable that di = c for some (at most one) i = 2, . . . , k \u2212 2. If\ns\ns\nsuch i exists and i \u2265 3, then a \u2192 (b \u2261 d1 ) \u2013 di \u21d2 * * * \u21d2 (dk \u2261 a) is a shorter\nsemi-directed cycle in G \u2217 , contradicting the minimality of k. Thus, either\ni = 2 or no such i exists.\nBy Lemma 3.4(a), the minimum-length semi-directed cycle must have at\nw\nleast one weak line dj \u2013 dj+1 \u2208 G \u2217 (1 \u2264 j \u2264 k \u2212 1). Consider the least such j.\nIf j \u2265 2, then the minimality of k is contradicted exactly as in (a). Suppose,\nw\ntherefore, that j = 1, so (b \u2261 d1 ) \u2013 d2 \u2208 G \u2217 . (Also, i does not exist and d2 6= c.)\nw\nw s\nw\ns\nSince now a \u2192 b \u2013 d2 and d2 \u2013 b \u2013 c occur in G \u2217 , a \u21d2 d2 \u2208 G \u2217 and d2 \u2013 c \u2208 G \u2217\nw\nby Lemma 3.2(b). However, a \u2192 d2 cannot occur in G \u2217 [otherwise a \u2192 d2 \u2013 c\nwould be a flag in G \u2217 , contradicting Lemma 3.2(a)], so a \u2212 d2 \u2208 G \u2217 . Thus,\na \u2192 b \u2212 d2 \u2212 a is a semi-directed 3-cycle in G \u2217 , contrary to Lemma 3.4.\nConversely, assume that a \u2192 b \u2212 c occurs as a flag in (G \u2217 )\u25e6 , so a \u2192 b * * * c\noccurs in G \u2217 . If b \u2212 c \u2208 G \u2217 , then the flag also occurs in G \u2217 , as asserted. If\nb \u2190 c \u2208 G \u2217 , then a \u2192 b \u2190 c occurs as an immorality in G \u2217 , hence by part (a)\nalso occurs as an immorality in (G \u2217 )\u25e6 , contrary to assumption.\nThus, assume that a \u2192 b \u2192 c occurs as a chordless 2-dipath in G \u2217 . Then\nb \u2192 c must occur in a semi-directed cycle b \u2192 (c \u2261 d1 ) \u21d2 d2 \u21d2 * * * \u21d2 (dk \u2261\nb) in G \u2217 . [Note that di 6= a for each i; otherwise a \u2192 b would be included\nin a semi-directed cycle and would thus be converted to a \u2212 b in (G \u2217 )\u25e6 ,\ncontradicting the original assumption.] Choose the chordless 2-dipath a \u2192\nb \u2192 c in G \u2217 that is associated with a semi-directed cycle having minimal\nlength k with respect to all chordless 2-dipaths a\u2032 \u2192 b\u2032 \u2192 c\u2032 in G \u2217 that occur\nas a\u2032 \u2192 b\u2032 \u2212 c in (G \u2217 )\u25e6 . By Lemma 3.4(c), k \u2265 4.\nBy Lemma 3.4(a), the minimum-length semi-directed cycle must have at\nw\nleast one weak line dj \u2013 dj+1 \u2208 G \u2217 (1 \u2264 j \u2264 k \u2212 1); consider the least such j. If\nj \u2265 2, then the minimality of k is again contradicted exactly as in (a). Thus,\nw\nassume that j = 1, so b \u2192 (c \u2261 d1 ) \u2013 d2 occurs in G \u2217 . By Lemma 3.2(b),\n\u2217\n\u2217\nb \u21d2 d2 \u2208 G . If b \u2212 d2 \u2208 G , then b \u2192 c occurs in a semi-directed 3-cycle\nw\nb \u2192 c \u2013 d2 \u2212 b in G \u2217 , contradicting Lemma 3.4(c), so b \u2192 d2 \u2208 G \u2217 .\nIf a*6** d2 in G \u2217 , then the chordless 2-dipath a \u2192 b \u2192 d2 is associated with a\nshorter semi-directed cycle b \u2192 d2 \u21d2 * * * \u21d2 (dk \u2261 b) in G \u2217 , contradicting the\n\n\f11\n\nMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\nw\n\nminimality of k, hence a * * * d2 \u2208 G \u2217 . If a \u21d0 d2 \u2208 G \u2217 , then a \u2192 b \u2192 c \u2013 d2 \u21d2 a\nis a semi-directed cycle in G \u2217 , so \u03b1 \u2192 \u03b2 would be converted to a line in\nw\n(G \u2217 )\u25e6 , contrary to assumption; thus, a \u2192 d2 \u2208 G \u2217 . But then a \u2192 d2 \u2013 c is a\nflag in G \u2217 , contradicting Lemma 3.2(a). Thus, a \u2192 b \u2212 c also occurs as a flag\nin G \u2217 .\ns\n(c) Suppose that a \u2013 b \u2192 c occurs as an antiflag in G \u2217 but not in (G \u2217 )\u25e6 .\nThen b \u2192 c must occur in a semi-directed cycle b \u2192 (c \u2261 d1 ) \u21d2 d2 \u21d2 * * * \u21d2\ns\n(dk \u2261 b) in G \u2217 . Choose the antiflag a \u2013 b \u2192 c in G \u2217 that is associated with\na semi-directed cycle having minimum length k with respect to all antiflags\ns\na\u2032 \u2013 b\u2032 \u2192 c\u2032 in G \u2217 that occur as a\u2032 \u2212 b\u2032 \u2212 c in (G \u2217 )\u25e6 . By Lemma 3.4(c), k \u2265 4.\nIt is conceivable that di = a for some (at most one) i = 3, . . . , k \u2212 1. If such\ns\ni exists and i \u2264 k \u2212 2, then b \u2192 (c \u2261 d1 ) \u21d2 * * * \u21d2 di \u2013 (dk \u2261 b) is a shorter\nsemi-directed cycle in G \u2217 , contradicting the minimality of k. Thus, either\ni = k \u2212 1 or no such i exists.\nBy Lemma 3.4(a), the minimum-length semi-directed cycle must have at\nw\nleast one weak line dj \u2013 dj+1 \u2208 G \u2217 (1 \u2264 j \u2264 k \u2212 1); consider the least such j. If\nj \u2265 2, then the minimality of k is again contradicted exactly as in (a). Thus,\nw\nassume that j = 1, so b \u2192 (c \u2261 d1 ) \u2013 d2 occurs in G \u2217 . By Lemma 3.2(b),\nb \u21d2 d2 \u2208 G \u2217 . If b \u2212 d2 \u2208 G \u2217 , then b \u2192 c occurs in a semi-directed 3-cycle\nw\nb \u2192 c \u2013 d2 \u2212 b in G \u2217 , contradicting Lemma 3.4(c), so b \u2192 d2 \u2208 G \u2217 .\ns\nIf a*6** d2 in G \u2217 , then the antiflag a \u2192 b \u2192 d2 is associated with a shorter\nsemi-directed cycle b \u2192 d2 \u21d2 * * * \u21d2 (dk \u2261 b) in G \u2217 , contradicting the mins\nimality of k; hence a * * * d2 \u2208 G \u2217 . If a \u21d0 d2 \u2208 G \u2217 , then b \u2192 d2 \u21d2 a \u2013 b is a\nsemi-directed 3-cycle in G \u2217 , contradicting Lemma 3.4(b), so a \u2192 d2 \u2208 G \u2217 .\nw\nBut then a \u2192 d2 \u2013 c occurs as a flag in G \u2217 , contradicting Lemma 3.2(a). \u0003\nTwo vertices a, a\u2032 \u2208 V are strongly equivalent (with respect to G) if a = a\u2032\nor there is a path between them in G \u2217 consisting solely of strong lines. Let\n\u03a3 \u2261 \u03a3(G) denote the set of strong equivalence classes in G \u2217 , providing the\n\u1e60\ndecomposition V = (\u03c3|\u03c3 \u2208 \u03a3). If a * * * a\u2032 \u2208 G\u03c3\u2217 , then a \u2212 a\u2032 \u2208 G\u03c3 \u2200 G \u2208 G\ns\nby the adicyclicity of G, so a \u2013 a\u2032 \u2208 G\u03c3\u2217 . Therefore, G\u03c3\u2217 = ((G \u2217 )\u25e6 )\u03c3 = G\u03c3 is\na connected UG (possibly a singleton), each of whose lines is strong. For\na \u2208 V , the unique strong equivalence class containing a is denoted by \u03c3(a).\nLemma 3.6.\n\nSuppose that a \u2208 \u03b1 and b \u2208 \u03b2 for distinct \u03b1, \u03b2 \u2208 \u03a3 \u2261 \u03a3(G).\n\n(a) If a \u2192 b \u2208 G (resp., a \u2212 b \u2208 G) for some G \u2208 G and a\u2032 * * * b\u2032 \u2208 G for a\npair a\u2032 \u2208 \u03b1, b\u2032 \u2208 \u03b2, then a\u2032 \u2192 b\u2032 \u2208 G (resp., a\u2032 \u2212 b\u2032 \u2208 G).\nw\ns\n(b) If a \u2192 b \u2208 G \u2217 (resp., a \u2192 b \u2208 G \u2217 ) and a\u2032 * * * b\u2032 \u2208 G \u2217 for a pair a\u2032 \u2208 \u03b1,\nw\ns\nb\u2032 \u2208 \u03b2, then a\u2032 \u2192 b\u2032 \u2208 G \u2217 (resp., a\u2032 \u2192 b\u2032 \u2208 G \u2217 ).\nw\nw\n\u2217\n(c) If a \u2192 b \u2208 G \u2217 , then a \u2192 b\u2032 \u2208 G \u2217 for every b\u2032 \u2208 \u03b2. Furthermore, G\u03b1\u2229wp\nG \u2217 (\u03b2)\nis complete.\n\n\f12\n\nS. A. ANDERSSON AND M. D. PERLMAN\nw\n\nw\n\n(d) If a \u2013 b \u2208 G \u2217 , then a\u2032 \u2013 b\u2032 \u2208 G \u2217 for every pair a\u2032 \u2208 \u03b1, b\u2032 \u2208 \u03b2. Furthermore, G\u03b1\u2217 and G\u03b2\u2217 are complete.\nProof. (a) is immediate by the adicyclicity of G and the connectedness\nof the subgraphs G\u03b1 and G\u03b2 .\nw\n(b) If a \u2192 b \u2208 G, then a \u2192 b \u2208 G1 and a \u2212 b \u2208 G2 for some G1 , G2 \u2208\nG, while a \u21d2 b \u2208 G3 for all other G3 \u2208 G. Therefore, by (a), a\u2032 \u2192 b\u2032 \u2208 G1 ,\nw\ns\na\u2032 \u2212 b\u2032 \u2208 G2 , and a\u2032 \u21d2 b\u2032 \u2208 G3 , hence a\u2032 \u2192 b\u2032 \u2208 G \u2217 . Similarly, if a \u2192 b \u2208 G \u2217 ,\ns\nthen a\u2032 \u2192 b\u2032 \u2208 G \u2217 .\nw\n(c) By Lemma 3.2(b), a \u2192 b\u2032\u2032 \u2208 G \u2217 for all strong neighbors b\u2032\u2032 of b in G \u2217 ,\nw\nso by the connectedness of G\u03b2\u2217 , a \u2192 b\u2032 \u2208 G \u2217 for every b\u2032 \u2208 \u03b2. Next, suppose\nw\nthat a\u2032 , a\u2032\u2032 \u2208 \u03b1 \u2229 wpG \u2217 (\u03b2). It follows from the preceding that a\u2032 \u2192 b \u2208 G \u2217 and\nw\na\u2032\u2032 \u2192 b \u2208 G \u2217 . By (a), therefore, \u2203 G1 , G2 \u2208 G such that a\u2032 \u2192 b \u2208 G1 and a\u2032\u2032 \u2192\nb \u2208 G1 , but a\u2032 \u2212 b \u2208 G2 and a\u2032\u2032 \u2212 b \u2208 G2 . Thus, a\u2032 * * * a\u2032\u2032 \u2208 G \u2217 , for otherwise\nthe triplex ({a\u2032 , a\u2032\u2032 }, b) would occur as the immorality a\u2032 \u2192 b \u2190 a\u2032\u2032 in G1 ,\nbut this triplex would not occur in G2 .\nw\n(d) By Lemma 3.2(b), a \u2013 b\u2032\u2032 \u2208 G \u2217 for all strong neighbors b\u2032\u2032 of b in G \u2217 , so\nw\nw\nby the connectedness of G\u03b2 , a \u2013 b\u2032 \u2208 G \u2217 for every b\u2032 \u2208 \u03b2. Similarly, a\u2032 \u2013 b\u2032 \u2208 G \u2217\nw\nfor all a\u2032 \u2208 \u03b1. Next, for any a\u2032 , a\u2032\u2032 \u2208 G\u03b1\u2217 , the preceding shows that a\u2032 \u2013 b \u2208 G \u2217\nw\nand a\u2032\u2032 \u2013 b \u2208 G \u2217 . By (a), \u2203 G1 , G2 \u2208 G such that a\u2032 \u2192 b \u2208 G1 and a\u2032\u2032 \u2192 b \u2208 G1 ,\nbut a\u2032 \u2190 b \u2208 G2 and a\u2032\u2032 \u2190 b \u2208 G2 . Thus, a\u2032 * * * a\u2032\u2032 \u2208 G \u2217 , for otherwise the\ntriplex ({a\u2032 , a\u2032\u2032 }, b) would occur as the immorality a\u2032 \u2192 b \u2190 a\u2032\u2032 in G1 , but\nthis triplex would not occur in G2 , hence G\u03b1\u2217 is complete. Similarly, G\u03b2\u2217 is\ncomplete. \u0003\nDefinition 3.2. For each G \u2261 (V, E) \u2208 G, define the reduced graph G \u2261\n(\u03a3 \u2261 \u03a3(G), E) as follows: \u03b1 \u2192 \u03b2 \u2208 G (resp., \u03b1 \u2212 \u03b2 \u2208 G) iff a \u2192 b \u2208 G (resp.,\na \u2212 b \u2208 G) for at least one pair a \u2208 \u03b1, b \u2208 \u03b2. The reduced graph G \u2217 \u2261 (\u03a3, E \u2217 )\nis defined similarly.\nBy Lemma 3.6(a), G is well defined. Since G and G are adicyclic, G\u25e6 =\nG = (G)\u25e6 . Clearly, G \u2217 has the same skeleton as G for each G \u2208 G, and\n\u03b1 * * * \u03b2 \u2208 G \u2217 iff a * * * b \u2208 G \u2217 for some pair a \u2208 \u03b1, b \u2208 \u03b2. The arrow \u03b1 \u2192 \u03b2 \u2208 G \u2217\nw\ns\nis called weak (resp., strong) if a \u2192 b \u2208 G \u2217 (resp., a \u2192 b \u2208 G \u2217 ). All lines\n\u03b1 \u2212 \u03b2 \u2208 G \u2217 are called weak because each line a \u2212 b \u2208 G \u2217 (a \u2208 \u03b1, b \u2208 \u03b2) must\nbe weak.\nThe following fact will be used repeatedly. Consider the following four\nstatements:\n1. \u03b1 \u2192 \u03b2 \u2208 G \u2217 ;\n2. \u03b1 \u21d2 \u03b2 \u2208 G for all G \u2208 G;\n3. \u03b1 \u2192 \u03b2 \u2208 G for some G \u2208 G;\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n13\n\n4. \u03b1 \u21d2 \u03b2 \u2208 G \u2217 .\nThen 1 \u21d0\u21d2 2 =\u21d2 3 \u21d0\u21d2 4.\nLemma 3.7. ( a) If G \u2208 G, then G has no chordless undirected cycles.\n(b) If \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs as an immorality in G for some G \u2208 G, then\nthe triplex ({\u03b1, \u03b3}, \u03b2) occurs in G\u2032 for every G\u2032 \u2208 G.\nProof. (a) If (\u03c30 , \u03c31 , . . . , \u03c3k \u2261 \u03c30 ) comprises a chordless undirected kcycle in G, then, by the definition of G and the connectedness of each G\u03c3i ,\nthere exist {sij |1 \u2264 j \u2264 ni } \u2286 \u03c3i , i = 1, . . . , k, such that (s11 , . . . , s1n1 , . . . , sk1 ,\n. . . , sknk \u2261 s11 ) is an undirected l-cycle in G (l \u2265 k). If we choose the l-cycle\nof this form that minimizes l, this cycle must be chordless. By Lemma 3.3,\neach line sini \u2212 s(i+1)1 must be strong in G \u2217 , but also must be weak in G \u2217\nsince sini \u2208 \u03c3i and s(i+1)1 \u2208 \u03c3i+1 , a contradiction.\n(b) Because \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs as an immorality in G, \u03b1 \u21d2 \u03b2 \u21d0 \u03b3 occurs\nw\nw\nw\nw\nin G \u2217 with \u03b1*6 ** \u03b3. If \u03b1 \u2192 \u03b2, \u03b1 \u2013 \u03b2, \u03b2 \u2190 \u03b3, or \u03b2 \u2013 \u03b3 occurs in G \u2217 , then, by\nLemma 3.6(a), (b), (c), (d), \u2203 a \u2208 \u03b1, b \u2208 \u03b2, and c \u2208 \u03b3 such that a \u2192 b \u2190 c\noccurs as an immorality in G. In this case ({a, c}, b) must occur as a triplex in\neach G\u2032 \u2208 G, hence ({\u03b1, \u03b3}, \u03b2) must occur as a triplex in G\u2032 for each G\u2032 \u2208 G.\ns\ns\nIn the remaining case, \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs in G \u2217 . By the connectedness of\ns\ns\ns\ns\nG\u03b2\u2217 , \u2203 a \u2208 \u03b1, b0 , . . . , bn \u2208 \u03b2 (n \u2265 0), and c \u2208 \u03b3 such that a \u2192 b0 \u2013 * * * \u2013 bn \u2190 c\noccurs as a subgraph of G \u2217 and thus as a subgraph of each G\u2032 \u2208 G. Therefore,\n\u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs as an immorality (a triplex) in G\u2032 for each G\u2032 \u2208 G. \u0003\nLemma 3.8. ( a) Let \u03b1, \u03b2 \u2208 \u03a3 \u2261 \u03a3(G) be distinct strong equivalence classes.\nAn arrow \u03b1 \u2192 \u03b2 \u2208 G \u2217 is contained in some semi-directed cycle in G \u2217 if and\nonly if there exist a \u2208 \u03b1 and b \u2208 \u03b2 such that a \u2192 b \u2208 G \u2217 is contained in some\nsemi-directed cycle in G \u2217 . In this case, every arrow a\u2032 \u2192 b\u2032 \u2208 G \u2217 between \u03b1\nand \u03b2 is contained in some semi-directed cycle in G \u2217 .\n(b) G \u2217 is adicyclic iff G \u2217 is adicyclic. In general, (G \u2217 )\u25e6 = (G \u2217 )\u25e6 .\nProof. (a) \"Only if\": This follows immediately from the fact that any\ntwo vertices in a strong equivalence class are connected in G \u2217 via a path\nconsisting of strong lines.\n\"If\": Let a \u2192 b \u21d2 d1 \u21d2 * * * \u21d2 (dl \u2261 a) be a semi-directed l-cycle in G \u2217\n(l \u2265 3). Consider the largest i = 1, . . . , l \u2212 1 such that di \u2208 \u03b2. Since di \u21d2\ndi+1 \u2208 G \u2217 , Lemma 3.6(b) implies that \u03c3(di+1 ) 6= \u03b1, hence i \u2264 l \u2212 2, \u03b3 :=\n\u03c3(di+1 ) 6= \u03b1, \u03b2, and \u03b1 \u2192 \u03b2 \u21d2 \u03b3 occurs as a subgraph in G \u2217 . Next, consider\nthe largest j = i + 1, . . . , l \u2212 1 such that dj \u2208 \u03b3. Then \u03b4 := \u03c3(dj+1 ) 6= \u03b2, \u03b3 and,\nsince dj \u21d2 dj+1 \u2208 G \u2217 , \u03b1 \u2192 \u03b2 \u21d2 \u03b3 \u21d2 \u03b4 occurs in G \u2217 . Either \u03b4 = \u03b1, producing a\nsemi-directed 3-cycle of the desired form, or this process may be continued\n\n\f14\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nuntil a semi-directed k-cycle \u03b1 \u2192 \u03b2 \u21d2 \u03b3 \u21d2 \u03b4 \u21d2 * * * \u21d2 \u03b1 (k \u2265 4) in G \u2217 is\nobtained. The final statement is immediate.\n(b) The first part follows from the first statement in (a). By Lemma 3.5,\n(G \u2217 )\u25e6 \u2208 G, so (G \u2217 )\u25e6 is well defined; clearly, it has the same skeleton as G \u2217\nand (G \u2217 )\u25e6 . Suppose first that \u03b1 \u2192 \u03b2 \u2208 (G \u2217 )\u25e6 . Then \u03b1 \u2192 \u03b2 \u2208 G \u2217 and \u03b1 \u2192 \u03b2\ncannot occur in a semi-directed cycle in G \u2217 . Select a \u2208 \u03b1 and b \u2208 \u03b2 such that\na \u2192 b \u2208 G \u2217 . By (a)(\"if\"), a \u2192 b cannot occur in a semi-directed cycle in G \u2217 ,\nhence a \u2192 b \u2208 (G \u2217 )\u25e6 , so \u03b1 \u2192 \u03b2 \u2208 (G \u2217 )\u25e6 .\nSuppose next that \u03b1 \u2212 \u03b2 \u2208 (G \u2217 )\u25e6 , so either (i) \u03b1 \u2212 \u03b2 \u2208 G \u2217 , (ii) \u03b1 \u2192 \u03b2 \u2208 G \u2217 ,\nor (iii) \u03b1 \u2190 \u03b2 \u2208 G \u2217 . In case (i), it follows directly that \u03b1 \u2212 \u03b2 \u2208 (G \u2217 )\u25e6 . In case\n(ii), \u03b1 \u2192 \u03b2 must occur in some semi-directed cycle in G \u2217 , hence by (a)(\"only\nif\") again \u03b1 \u2212 \u03b2 \u2208 (G \u2217 )\u25e6 ; case (iii) is similar to (ii). Thus, (G \u2217 )\u25e6 = (G \u2217 )\u25e6 . \u0003\nLemma 3.9. ( a) G \u2217 has no flags or chordless undirected cycles.\n(b) If \u03b1 \u2192 \u03b2 \u2212 \u03b3 occurs as a subgraph in G \u2217 , then \u03b1 \u21d2 \u03b3 \u2208 G \u2217 .\n(c) Any triplex (necessarily an immorality) in G \u2217 is a triplex in G for\neach G \u2208 G.\nProof. (a) If \u03b1 \u2192 \u03b2 \u2212 \u03b3 is a flag in G \u2217 , then \u03b2 \u2212 \u03b3 is a weak line and,\nby Lemma 3.6(d) and the definition of G \u2217 , there exist a \u2208 \u03b1, b \u2208 \u03b2, c \u2208 \u03b3\nsuch that a \u2192 b \u2212 c is a flag in G \u2217 . Therefore, b \u2212 c must be a strong line in\nG \u2217 by Lemma 3.2(a), but b \u2212 c is a weak line, thus, a contradiction.\nNext, if (\u03c30 , \u03c31 , . . . , \u03c3k \u2261 \u03b30 ) is a chordless undirected k-cycle in G \u2217 , then\nby Lemma 3.6(d) and the definition of G \u2217 , there exist si \u2208 \u03c3i , i = 1, . . . , k,\nsuch that (s0 , s1 , . . . , sk \u2261 s0 ) is a chordless undirected k-cycle in G \u2217 . Each\nline si\u22121 \u2212 si \u2208 G \u2217 is weak, but, by Lemma 3.3, each line si\u22121 \u2212 si \u2208 G \u2217 must\nbe strong, a contradiction.\n(b) By (a), \u03b1 * * * \u03b3 \u2208 G \u2217 . Because \u03b2 \u2212 \u03b3 must be weak, we can choose G \u2208 G\nsuch that \u03b2 \u2192 \u03b3 \u2208 G, hence, the triangle \u03b1 \u21d2 \u03b2 \u2192 \u03b3 * * * \u03b1 occurs in G. Since\nG is adicyclic, \u03b1 \u2192 \u03b3 \u2208 G, hence \u03b1 \u21d2 \u03b3 \u2208 G \u2217 .\n(c) By (a), any triplex in G \u2217 is an immorality, say \u03b1 \u2192 \u03b2 \u2190 \u03b3. If either\narrow is weak, then by Lemma 3.6(c) there exist a \u2208 \u03b1, b \u2208 \u03b2, c \u2208 \u03b3 such\nthat a \u2192 b \u2190 c is an immorality in G \u2217 . Thus, by Lemma 3.1, ({a, c}, b) is a\ntriplex in G, so by the definition of G, ({\u03b1, \u03b3}, \u03b2) is a triplex in G. If both\narrows in \u03b1 \u2192 \u03b2 \u2190 \u03b3 are strong, then there exist a \u2208 \u03b1, b, b\u2032 \u2208 \u03b2, c \u2208 \u03b3 such\nthat a \u2192 b \u2208 G and b\u2032 \u2190 c \u2208 G, hence \u03b1 \u2192 \u03b2 \u2190 \u03b3 is an immorality in G. \u0003\nLemma 3.10. ( a) Any semi-directed cycle in G \u2217 has at least one (weak)\nline.\n(b) If \u03b1 \u2192 \u03b2 \u21d2 \u03b4 \u21d2 \u03b1 is a semi-directed 3-cycle in G \u2217 , then there exist\nG, G\u2032 \u2208 G such that \u03b1 \u21d2 \u03b2 \u2190 \u03b4 \u2192 \u03b1 occurs in G and \u03b1 \u21d2 \u03b2 \u2192 \u03b4 \u2190 \u03b1 occurs\nin G\u2032 . Therefore, the semi-directed 3-cycle in G \u2217 must have the form \u03b1 \u2192\nw w\n\u03b2 \u2013 \u03b4 \u2013 \u03b1.\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n15\n\n(c) In this case, \u03b1 \u2192 \u03b2 cannot occur in G \u2217 in a triplex (necessarily an\nimmorality \u03b1 \u2192 \u03b2 \u2190 \u03b3) or in an induced subgraph of the form \u03b3 \u2192 \u03b1 \u2192 \u03b2.\n(d) If \u03c30 \u2192 \u03c31 \u21d2 * * * \u21d2 (\u03c3k \u2261 \u03c30 ) is a semi-directed k-cycle in G \u2217 (k \u2265 3),\nthen each \u03c3i has at least one weak neighbor in G \u2217 . Thus, by Lemma 3.6(d),\nthe induced subgraphs G\u03c3\u22171 , . . . , G\u03c3\u2217k are complete.\nProof. (a) This follows directly from Lemma 3.4(a), using the fact that\neach G\u03c3\u2217 , \u03c3 \u2208 \u03a3, is connected.\n(b) The proof is the same as that of Lemma 3.4(b).\n(c) Assume that the immorality \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs in G \u2217 . Let G, G\u2032 be as\nspecified in (b); since \u03b1*6 ** \u03b3, necessarily \u03b3 6= \u03b4. Because \u03b2 \u2190 \u03b3 \u2208 G \u2217 , necessarily \u03b2 \u21d0 \u03b3 \u2208 G, G\u2032 . Since \u03b4 \u2212 \u03b2 \u2190 \u03b3 occurs as a subgraph of G \u2217 , necessarily\n\u03b4 \u21d0 \u03b3 \u2208 G \u2217 [Lemma 3.9(b)], hence also \u03b4 * * * \u03b3 \u2208 G, G\u2032 . Thus, the triangle\n\u03b4 \u2190 \u03b2 \u21d0 \u03b3 * * * \u03b4 occurs in G\u2032 , hence \u03b4 \u2190 \u03b3 \u2208 G by the adicyclicity of G.\nTherefore, \u03b1 \u2192 \u03b4 \u2190 \u03b3 occurs as an immorality in G\u2032 , so by Lemma 3.7(b),\n({\u03b1, \u03b3}, \u03b4) must occur as a triplex in G. But this is impossible because\n\u03b1 \u2190 \u03b4 \u2208 G. The impossibility of the occurrence of \u03b3 \u2192 \u03b1 \u2192 \u03b2 as an induced\nsubgraph of G \u2217 is proved by a similar argument.\n(d) Use induction on k. By (b), the result is true when k = 3. Suppose\nit is true for all k\u2032 < k. By (a), at least one edge in the k-cycle is a weak\nw\nw\nline. Let \u03c3j \u2013 \u03c3j+1 be the first such edge (1 \u2264 j \u2264 k \u2212 1), so \u03c3j\u22121 \u2192 \u03c3j \u2013 \u03c3j+1\noccurs in G \u2217 . Thus, \u03c3j\u22121 \u21d2 \u03c3j+1 \u2208 G \u2217 by Lemma 3.9(b). If j \u2265 2, then \u03c30 \u2192\n\u03c31 \u21d2 * * * \u21d2 \u03c3j\u22121 \u21d2 \u03c3j+1 \u21d2 * * * \u21d2 (\u03c3k \u2261 \u03c30 ) is a semi-directed (k \u2212 1)-cycle\nin G \u2217 , so by the induction hypothesis, each of its vertices has at least one\nweak neighbor in G \u2217 . Because the vertex \u03c3j also has a weak neighbor (\u03c3j+1 ),\nthe asserted result holds. If j = 1, then the cycle \u03c30 \u21d2 \u03c32 \u21d2 * * * \u21d2 (\u03c3k \u2261 \u03c30 )\noccurs in G \u2217 . If \u03c30 \u2192 \u03c32 \u2208 G \u2217 , then this cycle is semi-direct and the induction\nw\nhypothesis again yields the asserted result. If \u03c30 \u2013 \u03c32 \u2208 G \u2217 , then either the\ncycle is completely undirected, in which case the asserted result obviously\nholds, or else it has at least one arrow, in which case the cycle is semi-directed\nand the induction hypothesis again applies. \u0003\nLemma 3.11. ( a) An immorality \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs in G \u2217 iff it occurs\nin (G \u2217 )\u25e6 .\n(b) Neither G \u2217 nor (G \u2217 )\u25e6 has any flags.\n(c) (G \u2217 )\u25e6 has no chordless undirected cycles.\nProof. (a) Note that G \u2217 \u2286 (G \u2217 )\u25e6 and they have the same skeletons.\nThus, if the immorality \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs in (G \u2217 )\u25e6 , it must occur in G \u2217 .\nConversely, suppose that \u03b1 \u2192 \u03b2 \u2190 \u03b3 occurs in G \u2217 but not in (G \u2217 )\u25e6 . Then\nat least one of these two arrows must occur in a semi-directed cycle in G \u2217\nand so is converted to a line in (G \u2217 )\u25e6 ; also \u03b1*6** \u03b3 in both graphs. Choose the\n\n\f16\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nimmorality \u03b1 \u2192 \u03b2 \u2190 \u03b3 associated with a semi-directed cycle of minimum\nlength k [minimum with respect to all immoralities \u03b1\u2032 \u2192 \u03b2 \u2032 \u2190 \u03b3 \u2032 in G \u2217 that\ndo not occur in (G \u2217 )\u25e6 ] and assume without loss of generality that this cycle\ncontains \u03b1 \u2192 \u03b2. This cycle thus has the form \u03b1 \u2192 (\u03b2 \u2261 \u03b41 ) \u21d2 \u03b42 \u21d2 * * * \u21d2\n(\u03b4k \u2261 \u03b1) in G \u2217 . By Lemma 3.10(c), k \u2265 4.\nIt may be that \u03b4i = \u03b3 for some (at most one) i = 3, . . . , k \u2212 2. In that\ncase, however, \u03b2 \u2190 (\u03b3 \u2261 \u03b4i ) occurs in a shorter semi-directed cycle \u03b3 \u2192 (\u03b2 \u2261\n\u03b41 ) \u21d2 * * * \u21d2 (\u03b4i \u2261 \u03b3) in G \u2217 , contradicting the minimality of k; hence, \u03b4i 6= \u03b3\nfor each i. By Lemma 3.10(a), the minimal-length semi-directed cycle has\nw\nat least one line \u03b4j \u2013 \u03b4j+1 \u2208 G \u2217 (1 \u2264 j \u2264 k \u2212 1); consider the minimal such j.\nSuppose first that j \u2265 2, so \u03b4j\u22121 \u2192 \u03b4j \u2212 \u03b4j+1 occurs as a subgraph of G \u2217 .\nBy Lemma 3.9(b), \u03b4j\u22121 \u21d2 \u03b4j+1 \u2208 G \u2217 , hence \u03b1 \u2192 (\u03b2 \u2261 \u03b41 ) \u21d2 * * * \u21d2 \u03b4j\u22121 \u21d2\n\u03b4j+1 \u21d2 * * * \u21d2 (\u03b4k \u2261 \u03b1) is a shorter semi-directed cycle in G \u2217 containing \u03b1 \u2192\n\u03b2, contradicting the minimality of k.\nSuppose next that j = 1, so (\u03b2 \u2261 \u03b41 ) \u2212 \u03b42 \u2208 G \u2217 . By Lemma 3.9(b), \u03b1 \u21d2\n\u03b42 \u21d0 \u03b3 occurs as an induced subgraph in G \u2217 . By Lemma 3.10(c), neither\nedge can be a line, hence \u03b1 \u2192 \u03b42 \u2190 \u03b3 occurs as an immorality in G \u2217 . But\nnow \u03b1 \u2192 \u03b42 occurs in a shorter semi-directed cycle \u03b1 \u2192 \u03b42 \u21d2 * * * \u21d2 (\u03b4k \u2261 \u03b1),\ncontradicting the minimality of k.\n(b) By Lemma 3.9(a), G \u2217 has no flags. Assume that \u03b1 \u2192 \u03b2 \u2212 \u03b3 occurs as a\nflag in (G \u2217 )\u25e6 . Then necessarily \u03b1 \u2192 \u03b2 \u2208 G \u2217 , so by (a), \u03b1 \u2192 \u03b2 \u2192 \u03b3 occurs as a\nchordless 2-dipath in G \u2217 , and \u03b2 \u2192 \u03b3 occurs in some semi-directed cycle in G \u2217 :\n\u03b2 \u2192 (\u03b3 \u2261 \u03b41 ) \u21d2 \u03b42 \u21d2 * * * \u21d2 (\u03b4k \u2261 \u03b2), with k \u2265 4 by Lemma 3.10(c). Choose\nthe flag \u03b1 \u2192 \u03b2 \u2212 \u03b3 in (G \u2217 )\u25e6 such that the associated semi-directed cycle has\nminimal length k. [Note that \u03b4i 6= \u03b1 for each i; otherwise \u03b1 \u2192 \u03b2 would be\nincluded in a semi-directed cycle in G \u2217 and would thus be converted to \u03b1 \u2212 \u03b2\nin (G \u2217 )\u25e6 , a contradiction to the original assumption.]\nBy Lemma 3.10(a), the semi-directed cycle must have at least one line\n\u03b4j \u2212 \u03b4j+1 \u2208 G \u2217 (1 \u2264 j \u2264 k \u2212 1); consider the minimal such j. If j \u2265 2, then the\nminimality of k is contradicted exactly as in (a), hence j = 1 and \u03b41 \u2212 \u03b42 \u2208 G \u2217 .\nBy Lemma 3.9(b), \u03b2 \u21d2 \u03b42 \u2208 G \u2217 . If \u03b2 \u2212 \u03b42 , then \u03b2 \u2192 (\u03b3 \u2261 \u03b41 ) \u2212 \u03b42 \u2212 \u03b2 is a\nsemi-directed 3-cycle containing \u03b2 \u2192 \u03b3 in G \u2217 , contradicting Lemma 3.10(c);\nhence \u03b2 \u2192 \u03b42 \u2208 G \u2217 .\nIf \u03b1*6** \u03b42 in G \u2217 , then \u03b1 \u2192 \u03b2 \u2192 \u03b42 occurs as a chordless 2-dipath in G \u2217 and\n\u03b2 \u2192 \u03b42 occurs in the semi-directed cycle \u03b2 \u2192 \u03b42 \u21d2 * * * \u21d2 (\u03b4k \u2261 \u03b2), contradicting the minimality of k. If \u03b1 * * * \u03b42 in G \u2217 , then \u03b1 \u2192 \u03b42 , since otherwise\n\u03b1 \u2192 \u03b2 would occur in the semi-directed cycle \u03b1 \u2192 \u03b2 \u2192 \u03b3 \u2212 \u03b42 \u21d2 \u03b1 in G \u2217 ,\nhence would be converted into \u03b1 \u2212 \u03b2 in (G \u2217 )\u25e6 . But now \u03b1 \u2192 \u03b42 \u2212 \u03b3 is a flag\nin G \u2217 , contradicting Lemma 3.9(a).\n(c) Suppose that (G \u2217 )\u25e6 has a chordless undirected cycle which has no\ntriplexes. By Lemma 3.9(a), G \u2217 has no such cycles, so has at least one arrow\nin this cycle. If G \u2217 has at least one opposing arrow in this cycle, it must have\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n17\n\nat least one triplex therein. If it has no opposing arrow, then it has at least\none line [Lemma 3.10(a)], so again at least one triplex therein. But by (a)\nand (b), G \u2217 and (G \u2217 )\u25e6 have the same triplexes, hence a contradiction. \u0003\nTheorem 3.2.\n\nG \u2217 is adicyclic (i.e., is a chain graph) and G \u2217 \u2208 G.\n\nProof. By Lemma 3.8(b), to show that G \u2217 is adicyclic, it suffices to\nshow that G \u2217 is adicyclic, that is, G \u2217 = (G \u2217 )\u25e6 . To simplify notation, set\nK := G \u2217 . By Lemma 3.11, K and K \u25e6 have the same immoralities, have\nno flags and K \u25e6 is a chain graph each of whose chain components (K \u25e6 )\u03b7 ,\n\u03b7 \u2208 \u039e(K \u25e6 ), is chordal. [Note that \u03b7 \u2286 \u03a3 \u2261 \u03a3(G).]\nBecause K \u2286 K \u25e6 , it suffices to show that if \u03b1\u2212\u03b2 \u2208 K \u25e6 , then \u03b1\u2212\u03b2 \u2208 K. Let\n\u03b7 \u2208 \u039e(K \u25e6 ) be the unique chain component of K \u25e6 such that \u03b1 \u2212 \u03b2 \u2208 (K \u25e6 )\u03b7 .\nSince it is chordal, (K \u25e6 )\u03b7 admits two perfect directed versions, say, D\u03b7 and\nD\u03b7\u2032 , such that \u03b1 \u2192 \u03b2 \u2208 D\u03b7 and \u03b1 \u2190 \u03b2 \u2208 D\u03b7\u2032 . (Apply Maximum Cardinality\nSearch starting first at \u03b1 and next at \u03b2.) Extend D\u03b7 and D\u03b7\u2032 to directed\ngraphs D and D \u2032 , each having the same vertex set \u03a3 and the same skeleton\nas K and K \u25e6 , by assigning perfect orientations (the same for D and D \u2032 ) to\nall other chain components (K \u25e6 )\u03c7 , \u03c7 \u2208 \u039e(K \u25e6 ), \u03c7 6= \u03b7. Thus, every arrow in\nK \u25e6 also occurs in D and D \u2032 , while \u03b1 \u2192 \u03b2 \u2208 D and \u03b1 \u2190 \u03b2 \u2208 D \u2032 .\nIt is readily verified that D and D \u2032 are acyclic (since K \u25e6 is adicyclic\nand perfect orientations of chordal graphs are acyclic) and have the same\nimmoralities as K and K \u25e6 (since K \u25e6 has no flags, perfect orientations of\nchordal graphs are moral, and every arrow in K \u25e6 also occurs in D and D \u2032 ).\nNow consider the \"un-reduced\" versions H of D and H \u2032 of D \u2032 . That is,\nH and H \u2032 have the same skeleton as G \u2217 , while if c * * * d \u2208 G \u2217 , then:\ns\n\nA: c \u2212 d \u2208 H, H \u2032 iff c \u2013 d \u2208 G \u2217 , that is, H\u03c3 = H\u03c3\u2032 = G\u03c3\u2217 \u2200 \u03c3 \u2208 \u03a3;\nB: c \u2192 d \u2208 H (resp., H \u2032 ) iff \u03c3(c) \u2192 \u03c3(d) \u2208 D (resp., D \u2032 ).\nIn case B, either\nB1: \u03c3(c) \u2192 \u03c3(d) \u2208 K \u25e6 , in which case \u03c3(c) \u2192 \u03c3(d) \u2208 K, or\nw\nB2a: \u03c3(c) \u2212 \u03c3(d) \u2208 K \u25e6 and \u03c3(c) \u2013 \u03c3(d) \u2208 K, or\nB2b: \u03c3(c) \u2212 \u03c3(d) \u2208 K \u25e6 and \u03c3(c) \u2194 \u03c3(d) \u2208 K but the arrow \u2194 is contained\nin a semi-directed cycle in K.\nNote that if \u00e3 \u2208 \u03b1 and b\u0303 \u2208 \u03b2 are chosen such that \u00e3 * * * b\u0303 \u2208 G \u2217 , then \u00e3 \u2192\nb\u0303 \u2208 H and \u00e3 \u2190 b\u0303 \u2208 H \u2032 . If we can show that H, H \u2032 \u2208 G, then \u00e3 \u2212 b\u0303 \u2208 G \u2217 , so\n\u03b1 \u2212 \u03b2 \u2208 G \u2217 \u2261 K, which would complete the proof of the adicyclicity of G \u2217 .\nSince D and D \u2032 are acyclic, H and H \u2032 are adicyclic by their construction.\nTherefore, it suffices to show that H and H \u2032 have the same immoralities and\nthe same flags as G \u2217 , hence, the same triplexes.\n\n\f18\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\n(i) Suppose that c \u2192 d \u2190 e occurs as an immorality in G \u2217 . By Lemma 3.5(a),\nthis immorality also occurs in (G \u2217 )\u25e6 , so the arrow(s) \u03c3(c) \u2192 \u03c3(d) and \u03c3(d) \u2190\n\u03c3(e) occur in (G \u2217 )\u25e6 = (G \u2217 )\u25e6 \u2261 K \u25e6 [Lemma 3.8(b)] and therefore occur in\nD and D \u2032 . [Note that it is possible that \u03c3(c) = \u03c3(e).] Thus, c \u2192 d and d \u2190 e\nboth occur in H and H \u2032 so, since c*6** e in H and H \u2032 , c \u2192 d \u2190 e occurs as an\nimmorality in H and H \u2032 .\ns\ns\n(ii) Suppose that c \u2192 d \u2013 e occurs as a flag in G \u2217 . By Lemma 3.5(b), this\nflag also occurs in (G \u2217 )\u25e6 , so the arrow \u03c3(c) \u2192 \u03c3(d) occurs in (G \u2217 )\u25e6 = (G \u2217 )\u25e6 \u2261\nK \u25e6 and therefore in D and D \u2032 . Thus, c \u2192 d \u2212 e occurs as a flag in H and\nH \u2032.\ns\n(iii) Suppose that c \u2192 d \u2212 e occurs as a flag in H (or H \u2032 ). Then c * * * d \u2013 e\noccurs as an induced subgraph of G \u2217 and \u03c3(c) \u2192 \u03c3(d) \u2208 D (or D \u2032 ). Consider\nthe three possibilities B1, B2a, B2b for the edge \u03c3(c) * * * \u03c3(d):\ns\nB1: Here \u03c3(c) \u2192 \u03c3(d) \u2208 K \u2261 G \u2217 , so c \u2192 d \u2013 e occurs as a flag in G \u2217 .\nw\nw\nw\ns\nw\nB2a: Here \u03c3(c) \u2013 \u03c3(d) \u2208 K so c \u2013 d \u2208 G \u2217 , hence c \u2013 d \u2013 e \u2208 G \u2217 , hence c \u2013\ne \u2208 G \u2217 [Lemma 3.2(b)]. But c*6** e in G \u2217 , a contradiction.\nB2b: Here \u03c3(c) \u2194 \u03c3(d) \u2208 K and the arrow occurs in a semi-directed cycle\nin K \u2261 G \u2217 , so by Lemma 3.8(a), c \u2194 d must occur in a semi-directed cycle\ns\nin G \u2217 . Thus, either c \u2192 d \u2013 e occurs as a flag in G \u2217 but not in (G \u2217 )\u25e6 , cons\ntradicting Lemma 3.5(b), or c \u2190 d \u2013 e occurs as an antiflag in G \u2217 but not in\n(G \u2217 )\u25e6 , contradicting Lemma 3.5(c).\n(iv) Suppose that c \u2192 d \u2190 e occurs as an immorality in H (or H \u2032 ). Then\nc * * * d * * * e occurs as an induced subgraph of G \u2217 , and \u03c3(c) \u2192 \u03c3(d) \u2208 D (or\nD \u2032 ), \u03c3(c) \u2192 \u03c3(d) \u2208 D (or D \u2032 ).\nFirst, assume that \u03c3(c) = \u03c3(e). Again consider the three possibilities B1,\nB2a, B2b for the edge \u03c3(c) * * * \u03c3(d):\nB1: Here \u03c3(c) \u2192 \u03c3(d) \u2208 K \u2261 G \u2217 , so c \u2192 d \u2190 e occurs as an immorality\nin G \u2217 .\nw\nw\nw\n\u2217\n\u2217\nB2a: Here \u03c3(c) \u2013 \u03c3(d) \u2208 K, so c \u2013 d \u2208 G \u2217 , e \u2013 d \u2208 G \u2217 , and G\u03c3(c)\n\u2261 G\u03c3(e)\nis\n\u2217\ncomplete [Lemma 3.6(d)], but c*6** e in G , a contradiction.\nB2b: Here \u03c3(c) \u2194 \u03c3(d) \u2208 K and the arrow occurs in a semi-directed cycle\n\u2217\n\u2217\nin K \u2261 G \u2217 , so G\u03c3(c)\n\u2261 G\u03c3(e)\nis complete [Lemma 3.10(d)]. But c*6 ** e in G \u2217 ,\na contradiction.\nSecond, assume that \u03c3(c) 6= \u03c3(e). As above, three possibilities (B1, B2a,\nB2b) exist for the edge \u03c3(c) * * * \u03c3(d) in K \u25e6 . Similarly, three possibilities (B1\u2032 ,\nB2a\u2032 , B2b\u2032 ) exist for the edge \u03c3(e) * * * \u03c3(d) in K \u25e6 :\nB1\u2032 : \u03c3(e) \u2192 \u03c3(d) \u2208 K \u25e6 , in which case \u03c3(e) \u2192 \u03c3(d) \u2208 K, or\nw\nB2a\u2032 : \u03c3(e) \u2212 \u03c3(d) \u2208 K \u25e6 and \u03c3(e) \u2013 \u03c3(d) \u2208 K, or\nB2b\u2032 : \u03c3(e) \u2212 \u03c3(d) \u2208 K \u25e6 and \u03c3(e) \u2194 \u03c3(d) \u2208 K, but the arrow \u2194 is contained in a semi-directed cycle in K.\n\n\f19\n\nMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\nThus, we must consider the nine cases (B1, B1\u2032 ), (B2a, B1\u2032 ), . . . , (B2b,\nB2b\u2032 ).\n(B1, B1\u2032 ): Here \u03c3(c) \u2192 \u03c3(d) \u2208 K and \u03c3(e) \u2192 \u03c3(d) \u2208 K \u2261 G \u2217 , so c \u2192\nd \u2190 e occurs as an immorality in G \u2217 .\nw\nw\n(B1, B2a\u2032 ): Here \u03c3(c) \u2192 \u03c3(d) \u2208 K and \u03c3(e) \u2013 \u03c3(d) \u2208 K, so c \u2192 d \u2013 e occurs as a flag in G \u2217 , contradicting Lemma 3.2(a). Similarly, the case (B2a,\nB1\u2032 ) is also impossible.\n(B1, B2b\u2032 ): Here \u03c3(c) \u2192 \u03c3(d) \u2208 K and \u03c3(e) \u2194 \u03c3(d) \u2208 K with the arrow\n\u2194 contained in a semi-directed cycle in K \u2261 G \u2217 . By Lemma 3.8(a), e \u2194 d\nmust occur in a semi-directed cycle in G \u2217 , so either c \u2192 d \u2190 e occurs as an\nimmorality in G \u2217 but not in (G \u2217 )\u25e6 , contradicting Lemma 3.5(a), or c \u2192 d \u2192 e\noccurs as a chordless 2-dipath in G \u2217 but c \u2192 d \u2212 e occurs as a flag in (G \u2217 )\u25e6 ,\ncontradicting Lemma 3.5(b). Similarly, (B2b, B1\u2032 ) is impossible.\nIn the remaining four cases (B2a, B2a\u2032 ), (B2a, B2b\u2032 ), (B2b, B2a\u2032 ) and\n(B2b, B2b\u2032 ), \u03c3(c) \u2212 \u03c3(d) \u2212 \u03c3(e) occurs as a subgraph in K \u25e6 . Because \u03c3(c) \u2192\n\u03c3(d) \u2190 \u03c3(e) occurs as a subgraph in D (or D \u2032 ) and K \u25e6 has the same immoralities as D, D \u2032 , necessarily \u03c3(c) * * * \u03c3(e) \u2208 K \u2261 G \u2217 in these four cases. It\nw\ncannot occur that \u03c3(c) \u2013 \u03c3(e) \u2208 K [otherwise c * * * e \u2208 G \u2217 by Lemma 3.6(d)],\nso \u03c3(c) \u2194 \u03c3(e) \u2208 K. Therefore, \u2203 c\u2032 \u2208 \u03c3(c), e\u2032 \u2208 \u03c3(e) such that c\u2032 \u2194 e\u2032 \u2208 G \u2217 .\nSince c*6** e in G \u2217 , either c 6= c\u2032 or e 6= e\u2032 (or both).\nw\n\nw\n\nw\n\n(B2a, B2a\u2032 ): Here \u03c3(c) \u2013 \u03c3(d) \u2208 K and \u03c3(e) \u2013 \u03c3(d) \u2208 K \u2261 G \u2217 , so c \u2013 d \u2208\nw\n\u2217\n\u2217\nG \u2217 , e \u2013 d \u2208 G \u2217 , and both G\u03c3(c)\nand G\u03c3(e)\nare complete [Lemma 3.6(d)]. Thus,\n\u2032\n\u2032\nc \u2194 e occurs in a semi-directed cycle in G \u2217 .\ns\n(\u2022) If we assume that c 6= c\u2032 , then c \u2013 c\u2032 \u2194 e\u2032 occurs as a subgraph of\nG \u2217 . In this case c \u2194 e\u2032 \u2208 G \u2217 , for otherwise the subgraph would occur as\nan antiflag or flag in G \u2217 but not in (G \u2217 )\u25e6 , contradicting Lemma 3.5(c),(b).\ns\nTherefore, e\u2032 6= e (since c*6 ** e in G \u2217 ), so c \u2194 e\u2032 \u2013 e occurs as a subgraph of\nG \u2217 . By the same reasoning, c \u2194 e \u2208 G \u2217 , thereby contradicting the fact that\nc*6** e \u2208 G \u2217 . The same contradiction is obtained if we assume first that e 6= e\u2032 .\nw\n(B2a, B2b\u2032 ): Here \u03c3(c) \u2013 \u03c3(d) \u2208 K and \u03c3(e) \u2194 \u03c3(d) \u2208 K with the arrow\n\u2217\n\u2194 contained in some semi-directed cycle in K. Thus, G\u03c3(c)\nis complete by\ns\n\n\u2217\nLemma 3.6(d) and G\u03c3(e)\nis complete by Lemma 3.10(d), so c \u2013 c\u2032 \u2208 G \u2217 if c 6= c\u2032\ns\n\nw\n\nand e \u2013 e\u2032 \u2208 G \u2217 if e 6= e\u2032 . Because the triangle \u03c3(c) \u2013 \u03c3(d) \u2194 \u03c3(e) \u2194 \u03c3(c)\noccurs in K \u2261 G \u2217 and has exactly one line, by Lemma 3.10(b), it cannot\noccur as a semi-directed 3-cycle. This leaves two possible configurations for\nw\nw\nthe triangle in G \u2217 : \u03c3(c) \u2013 \u03c3(d) \u2190 \u03c3(e) \u2192 \u03c3(c) and \u03c3(c) \u2013 \u03c3(d) \u2192 \u03c3(e) \u2190 \u03c3(c),\nand in both cases the arrow between \u03c3(d) and \u03c3(e) is contained in some\nsemi-directed cycle in G \u2217 .\nIf the first configuration obtains, therefore, there exists a path \u03c3(d) \u21d2\n\u03b41 \u21d2 * * * \u21d2 (\u03b4k \u2261 \u03c3(e)) in G \u2217 (k \u2265 2). If each \u03b4i 6= \u03c3(c), then \u03c3(e) \u2192 \u03c3(c) is\n\n\f20\n\nS. A. ANDERSSON AND M. D. PERLMAN\nw\n\ncontained in the semi-directed cycle \u03c3(e) \u2192 \u03c3(c) \u2013 \u03c3(d) \u21d2 \u03b41 \u21d2 * * * \u21d2 (\u03b4k \u2261\n\u03c3(e)) in G \u2217 , while if \u03b4i = \u03c3(c) for some (at most one) i = 2, . . . , k \u2212 1 (so\nk \u2265 3), then \u03c3(e) \u2192 \u03c3(c) is contained in the semi-directed cycle \u03c3(e) \u2192\n(\u03c3(c) \u2261 \u03b4i ) \u21d2 * * * \u21d2 (\u03b4k \u2261 \u03c3(e)) in G \u2217 . In both cases, therefore, e\u2032 \u2192 c\u2032 is\ncontained in a semi-directed cycle in G \u2217 by Lemma 3.8(a). If the second\nconfiguration obtains, a similar argument shows that c\u2032 \u2192 e\u2032 is contained in\na semi-directed cycle in G \u2217 . Now a contradiction is reached exactly as in (\u2022).\nSimilarly, (B2b, B2a\u2032 ) is also impossible.\n(B2b, B2b\u2032 ): Here \u03c3(c) \u2194 \u03c3(d) \u2208 K and \u03c3(e) \u2194 \u03c3(d) \u2208 K, with the arrows \u2194 both contained in semi-directed cycles in K. Since also \u03c3(c) \u2194\n\u03c3(e) \u2208 K, \u03c3(c) \u2194 \u03c3(d) \u2194 \u03c3(e) \u2194 \u03c3(c) occurs as a triangle in K \u2261 G \u2217 . Of\nthe eight possible orientations, two are cyclic but have no lines, hence are\nimpossible by Lemma 3.4(b), leaving six acyclic possibilities: \u03c3(c) \u2192 \u03c3(d) \u2190\n\u03c3(e) \u2192 \u03c3(c), \u03c3(c) \u2190 \u03c3(d) \u2190 \u03c3(e) \u2192 \u03c3(c), and so on. The argument in the\npreceding paragraph can be extended to show again that c\u2032 \u2194 e\u2032 occurs in a\nsemi-directed cycle in G \u2217 , and again a contradiction is reached exactly as in\n(\u2022).\nThus, we have established that H and H \u2032 have the same triplexes as G \u2217 ,\nso the proof of the adicyclicity of G \u2217 is complete. Last, it follows now from\nLemma 3.1 that G \u2217 \u2208 G. \u0003\nRemark 3.1. For subsequent use, we summarize the properties of the\ngraphs H and H \u2032 constructed in the preceding proof: H and H \u2032 are adicyclic\nand have the same skeleton, immoralities and flags as G \u2217 , so H, H \u2032 \u2208 G. Each\nstrong line in G \u2217 occurs as a line in H and H \u2032 , each arrow in G \u2217 occurs as\nan arrow with the same orientation in H and H \u2032 , and each weak line in G \u2217\nw\nis converted to an arrow in H and H \u2032 . Further, if a weak line a \u2013 b \u2208 G \u2217 is\nspecified, H and H \u2032 can be chosen such that a \u2192 b \u2208 H and a \u2190 b \u2208 H \u2032 .\n4. Local properties of AMP essential graphs. Having established that\nG \u2217 and G \u2217 are adicyclic, some of the results in Lemmas 3.2 and 3.9 can be\nsharpened and extended. These then yield information about the possible\nlocal configurations of strong/weak arrows/lines in G \u2217 \u2261 (V, E \u2217 ).\nA chain component \u03be \u2208 \u039e(G \u2217 ) is nontrivial if |\u03be| \u2265 2, so that G\u03be\u2217 contains at\nleast one line. A nontrivial chain component \u03be is called strong (weak ) if each\nline in G\u03be\u2217 is strong (weak). For v \u2208 V , denote the unique chain component\nof G \u2217 that contains v by \u03be(v) \u2261 \u03beG \u2217 (v).\nw\n\nLemma 4.1. ( a) If a \u2192 b \u2013 c occurs as a subgraph in G \u2217 , then a \u2192 c \u2208\n\u2217\nG . Thus, if \u03be(b) is weak, then a \u2192 b\u2032 \u2200 b\u2032 \u2208 \u03be(b).\n(b) If \u03b1 \u2192 \u03b2 \u2212 \u03b3 occurs as a subgraph in G \u2217 , then \u03b1 \u2192 \u03b3 \u2208 G \u2217 .\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\nw\n\n21\n\nw\n\n(c) If a \u2192 b \u2013 c occurs as a subgraph in G \u2217 , then a \u2192 b\u2032 \u2013 c\u2032 and a \u2192 c\u2032\noccur as subgraphs of G \u2217 for all b\u2032 \u2208 \u03c3(b) and c\u2032 \u2208 \u03c3(c).\ns w\n(d) The configuration a \u2013 b \u2013 c cannot occur as an induced or noninduced\nsubgraph in G \u2217 .\nProof. (a) and (b) By the adicyclicity of G \u2217 and G \u2217 , these results follow\nimmediately from Lemmas 3.2(b) and 3.9(b) and the connectivity of \u03be(b).\nw\nw\n(c) By Lemma 3.6(d), a \u2192 b \u2013 c\u2032 \u2013 b\u2032 occurs as a subgraph in G \u2217 . Therefore,\nw\na \u2192 c\u2032 \u2013 b\u2032 occurs in G \u2217 by (a), whence a \u2192 b\u2032 \u2208 G \u2217 also by (a). [Note that\nw\nif the arrow a \u2192 b is weak, the result concerning a \u2192 b\u2032 \u2013 c\u2032 follows from\nLemma 3.6(c), (d), and in turn implies that a \u2192 c\u2032 \u2208 G \u2217 by (a).]\ns w\n(d) Assume that a \u2013 b \u2013 c occurs as a subgraph in G \u2217 and let \u03be = \u03be(a) \u2261\nw\n\u03be(b) \u2261 \u03be(c). By Lemma 3.6(d), a\u2032 \u2013 c\u2032 \u2208 G \u2217 \u2200 a\u2032 \u2208 \u03c3(a), c\u2032 \u2208 \u03c3(c), and \u03c3(a) \u2261\n\u03c3(b) and \u03c3(c) are complete subsets of \u03be. Since every \u03c3 \u2208 \u03a3(G) such that\n\u03c3 \u2286 \u03be must be connected to \u03c3(a) by a path of weak and strong lines, it\nfollows that every such \u03c3 is complete. This implies that any chordless cycle\nw\nC in G\u03be\u2217 must contain at least one weak line d \u2013 e, hence \u2203 G \u2208 G such that\neither d \u2192 e \u2208 G or d \u2190 e \u2208 G. But this and the adicyclicity of G imply the\nexistence of a triplex in GC , while GC\u2217 , being undirected, has no triplexes, a\ncontradiction since G and G \u2217 have the same triplexes. Thus, G\u03be\u2217 can have no\nchordless cycles, hence is chordal.\nThus, G\u03be\u2217 admits a perfect directed version F\u03be (apply MCS), so the edge\na * * * b occurs as an arrow in F\u03be . Let F be the graph obtained from G \u2217 if\nwe replace G\u03be\u2217 by F\u03be , so F \u2286 G \u2217 . Clearly, F has the same skeleton as G \u2217\nand is adicyclic: any semi-directed cycle in F cannot be wholly contained\nin \u03be since F\u03be is acyclic, hence such a cycle must contain at least one arrow\nfrom G \u2217 , so would correspond to a semi-directed cycle in G \u2217 which, however,\nis adicyclic. Because F differs from G \u2217 only in that all lines in G\u03be\u2217 become\narrows in F , because no triplexes occur within F\u03be or G\u03be\u2217 (the orientation\nin F\u03be is perfect, while G\u03be\u2217 is undirected), and because neither F nor G \u2217 has\na line d \u2212 e with e \u2208 \u03be and f \u2208 V \\ \u03be [since \u03be \u2208 \u039e(G)], the triplexes of F\nand G \u2217 can differ only if, for some e, f \u2208 \u03be, d \u2192 e \u2212 f occurs as a flag in\nG \u2217 but d \u2192 e \u2192 f \u2208 F . The former is impossible if e \u2212 f is weak in G \u2217\ns\n[Lemma 3.2(a)], so assume e \u2013 f \u2208 G \u2217 . Since \u03c3(e) ( \u03be, \u2203 g \u2208 (\u03be \\ \u03c3(e)) such\nw\nthat e \u2013 g \u2208 G \u2217 [Lemma 3.6(d)], so, since f \u2208 \u03c3(e), d \u2192 f \u2208 G \u2217 [set a = d,\nb = e, c = g and b\u2032 = f in part (c)]. Thus, d \u2192 e \u2212 f cannot occur as a flag\nin G \u2217 , so F and G \u2217 have the same triplexes, hence F \u2208 G. Since a * * * b occurs\nas an arrow in F , a \u2212 b cannot be a strong line in G \u2217 , contrary to assumption.\n\u0003\nProposition 4.1.\nstrong or weak.\n\n( a) Every nontrivial chain component of G \u2217 is either\n\n\f22\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\n(b) A nontrivial chain component \u03be \u2208 \u039e(G \u2217 ) is strong iff G\u03be\u0304\u2217 contains\neither a chordless undirected cycle or a flag, where \u03be\u0304 = clG \u2217 (\u03be) \u2261 \u03be \u222a \u0307 paG \u2217 (\u03be).\nIn fact, G\u03be\u0304\u2217 must contain either a chordless undirected cycle or a biflag.\nProof. Lemma 4.1(d) yields (a); Lemmas 3.2(a) and 3.3 yield \"if\" in\n(b).\n(b) \"only if\": Assume that \u03be is strong but G\u03be\u0304\u2217 contains no chordless undirected cycles or biflags. Suppose first that G\u03be\u0304\u2217 has no flags. Because G\u03be\u2217 is\nchordal, we can define F\u03be and F as in the proof of Lemma 4.1(d). Then as\nabove, F is adicyclic and has the same skeleton and triplexes as G \u2217 , hence\nF \u2208 G. Because all edges in F\u03be are arrows, however, the corresponding edges\nin G\u03be\u2217 cannot be strong lines, a contradiction.\nSuppose next that G\u03be\u0304\u2217 has at least one flag, say, a\u2217 \u2192 b\u2217 \u2212 c\u2217 with b\u2217 , c\u2217 \u2208 \u03be.\nLet F be the graph constructed from G \u2217 by converting each such flag into an\nimmorality a\u2217 \u2192 b\u2217 \u2190 c\u2217 . This process is unambiguous since b\u2217 \u2212 c\u2217 cannot\noccur in a 2-biflag in G \u2217 . Since F \u2286 G \u2217 and they have the same skeleton,\neach chain component \u03c1 of F satisfies either \u03c1 \u2286 \u03be or \u03c1 \u2229 \u03be = \u2205. Define\n\u039e\u03be (F ) := {\u03c1 \u2208 \u039e(F )|\u03c1 \u2286 \u03be},\nso \u03be =\n\n\u1e60\n\n{\u03c1|\u03c1 \u2208 \u039e\u03be (F )}. We shall establish four properties of F :\n\n(1) F is adicyclic. If F were not adicyclic, it would contain a semidirected cycle c0 \u2192 c1 \u21d2 * * * \u21d2 ck \u2261 c0 (k \u2265 3). Because F \u2286 G \u2217 and G \u2217\nis adicyclic, this cycle must be completely undirected in G \u2217 , in particular, c0 \u2212 c1 \u2208 G \u2217 , so there must exist a vertex a 6= c0 , c1 , c2 , ck\u22121 such that\nc0 \u2212c1 \u2190 a occurs as a flag in G \u2217 . (If k \u2265 5, then also a 6= ci for i = 3, . . . , k \u22122,\nfor otherwise c1 \u21d2 c2 * * * \u21d2 ci \u2192 c1 would be a semi-directed cycle in G \u2217 .)\nFurther, a \u2192 c1 \u2212 c2 cannot occur as a flag in G \u2217 (otherwise c1 \u2190 c2 \u2208 F ),\nso a \u2192 c2 \u2208 G \u2217 . Similarly, a \u2192 ci \u2208 G \u2217 for i = 3, . . . , k, which contradicts the\nnonadjacency of a and ck \u2261 c0 in the flag c0 \u2212 c1 \u2190 a.\n(2) Each triplex in G \u2217 corresponds to a triplex in F . This is immediate\nby the construction of F from G \u2217 .\n(3) Each immorality in F corresponds to a triplex in G \u2217 (but not every\nflag in F need correspond to a triplex in G \u2217 ). This holds since G\u03be\u2217 contains\nno 3-biflag chains.\n(4) The moralized graph (cf. [4], page 40) L \u2261 L(\u03c1) := (FclF (\u03c1) )m is chordal\nfor each \u03c1 \u2208 \u039e\u03be (F ). If not, then L would contain a chordless k-cycle c0 \u2212\nc1 \u2212 c2 \u2212 * * * \u2212 ck \u2261 c0 (k \u2265 4), where each ci \u2208 clF (\u03c1) \u2261 \u03c1 \u222a \u0307 paF (\u03c1). Since\nL\u03c1 = F\u03c1 = G\u03c1\u2217 and G\u03be\u2217 is chordal, this cycle cannot lie entirely within \u03c1, so\nmust intersect paF (\u03c1). Since paF (\u03c1) is complete in L, either (a) exactly one\nvertex of the cycle lies in paF (\u03c1), say, c1 , or (b) exactly two vertices of the\ncycle, necessarily consecutive, lie in paF (\u03c1), say, c0 \u2261 ck and c1 .\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n23\n\nIn case (a), c2 , ck \u2208 \u03c1, while c1 \u2208 paF (\u03c1), so c1 \u2192 c2 \u2208 F and c1 \u2192 ck \u2208 F\nby (1) and the connectedness of F\u03c1 , hence c1 \u21d2 c2 \u2208 G \u2217 and c1 \u21d2 ck \u2208 G \u2217 .\nBecause c2 \u2212 c3 \u2208 F\u03c1 = G\u03c1\u2217 and ck\u22121 \u2212 ck \u2208 F\u03c1 = G\u03c1\u2217 , c1 \u2212 c2 \u2208 G \u2217 and c1 \u2212 ck \u2208\nG \u2217 by the definition of F , so the cycle lies in G\u03be\u2217 and is chordless, contradicting\nthe chordality of G\u03be\u2217 .\nIn case (b), a similar argument shows that c1 \u2192 c2 \u2208 F and ck \u2192 ck\u22121 \u2208 F ,\nwhile c1 \u2212 c2 \u2208 G \u2217 and ck \u2212 ck\u22121 \u2208 G \u2217 . Therefore, all vertices c1 , . . . , ck lie in\n\u03be, so c1 and ck cannot be adjacent in G \u2217 since G\u03be\u2217 is assumed to be chordal.\n(Instead, the line c1 \u2212 ck \u2261 c0 in L must have been added by moralization.)\nFurthermore, by the definition of F , there must exist vertices a, b (possibly\na = b) such that c1 \u2212 c2 \u2190 a and b \u2192 ck\u22121 \u2212 ck occur as flags in G \u2217 . Thus,\na 6= c1 , c2 , c3 and, since the cycle is chordless in L, a 6= c4 , . . . , ck . Similarly,\nb 6= c1 , . . . , ck . Because ci \u2212 ci+1 \u2208 F \u2286 G \u2217 for i = 2, . . . , k \u2212 2 and G\u03be\u2217 contains\nno biflag chains, necessarily a \u2192 ci \u2208 G \u2217 for i = 3, . . . , k \u2212 1 and b \u2192 ci \u2208\nG \u2217 for i = k \u2212 2, . . . , 2. Thus, at least one of [a; c1 , . . . , ck ], [b; c1 , . . . , ck ] or\n[a, b; c1 , . . . , ck ] must occur as a k-biflag in G \u2217 , contradicting the assumption\nthat G\u03be\u0304\u2217 does not contain a biflag. Thus, (4) holds.\nNow construct a graph F \u2032 \u2286 F with the same skeleton as F , as follows.\nFor each \u03c1 \u2208 \u039e\u03be (F ), assign a perfect orientation to the edges of the chordal\nundirected graph L(\u03c1) \u2261 (FclF (\u03c1) )m according to MCS starting at an arbitrary vertex in paF (\u03c1) (if any), obtaining a perfect digraph D(\u03c1) with vertex\nset clF (\u03c1). Because paF (\u03c1) is complete in L(\u03c1), MCS can be chosen to visit\neach vertex in paF (\u03c1) before visiting any vertex in \u03c1 itself. Thus, for any\nedge between a vertex in paF (\u03c1) and a vertex in \u03c1, the orientations of this\nedge in D(\u03c1) and in F (and in F \u2032 defined below) are identical.\nLet F \u2032 \u2286 F be the graph obtained from F by orienting each undirected\nedge in F\u03c1 (= G\u03c1\u2217 ) according to its orientation in D(\u03c1), for each \u03c1 \u2208 \u039e\u03be (F ).\nNote that, for any pair d, e \u2208 V with either d \u2208\n/ \u03be or e \u2208\n/ \u03be (or both), the edge\n\u2217\n\u2032\nd * * * e (if any) must be identical in G , F and F . Also, every line in G\u03be\u2217 is\nconverted to an arrow in F \u2032 . We shall show that F \u2032 is adicyclic and has the\nsame triplexes as G \u2217 , hence F \u2032 \u2208 G. This contradicts the fact that every line\nin G\u03be\u2217 (in particular, b\u2217 \u2212 c\u2217 ) is strong, which will complete the proof.\nIf F \u2032 were not adicyclic, it would have a semi-directed cycle which cannot\nlie entirely within any one \u03c1 \u2208 \u039e\u03be (F ) since each D(\u03c1) is perfect. Nor can\nthis cycle lie entirely outside \u03be, since there F \u2032 coincides with F which is\nadicyclic. Thus, this cycle must contain two consecutive vertices c1 * * * c2\nsuch that either c1 \u2208 \u03c11 and c2 \u2208 \u03c12 for distinct \u03c11 , \u03c12 \u2208 \u039e\u03be (F ), or else c1 \u2208 \u03be\nand c2 \u2208\n/ \u03be. In either case the edge c1 * * * c2 must occur as an arrow in F ,\nso the cycle is also semi-directed in F (since F \u2287 F \u2032 ), contradicting the\nadicyclicity of F .\nSince G \u2217 \u2287 F \u2032 , each immorality in G \u2217 remains an immorality in F \u2032 , while,\nby the construction of F and F \u2032 , each flag d \u2192 e \u2212 f in G \u2217 either remains a\n\n\f24\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nflag in F \u2032 (if e, f \u2208\n/ \u03be) or else is converted to an immorality in F \u2032 (if e, f \u2208 \u03be).\nAlso, by this construction, if d \u2192 e \u2212 f is a flag in F \u2032 , then necessarily\ne, f \u2208\n/ \u03be, so this flag also occurs in G \u2217 .\nLast, suppose that d \u2192 e \u2190 f is an immorality in F \u2032 that does not occur as\na triplex in G \u2217 . Then d \u2212 e \u2212 f must occur as an induced subgraph in G\u03be\u2217 , but\nd, e, f cannot all lie in the same \u03c1 \u2208 \u039e\u03be (F ), since D(\u03c1) is perfect, hence has\nno immoralities. Without loss of generality, assume that d \u2208 \u03c11 and e \u2208 \u03c12 ,\nwhere \u03c11 6= \u03c12 . Thus, the edge d * * * e must be an arrow in F , hence d \u2192 e \u2208 F\nsince F \u2287 F \u2032 , and e \u21d0 f \u2208 F for the same reason. If e \u2190 f \u2208 F , then d \u2192\ne \u2190 f would occur as an immorality in F , hence by (3) would correspond\nto a triplex in G \u2217 , contrary to assumption, so necessarily e \u2212 f \u2208 F and\nf \u2208 \u03c12 . Thus, the edge d * * * f cannot be added in the moralization process for\nL(\u03c12 ), hence cannot occur in D(\u03c12 ), so d \u2192 e \u2190 f is an immorality in D(\u03c12 ),\ncontradicting its perfectness. Thus, F \u2032 and G \u2217 have the same triplexes. \u0003\nWe note that not every line in a strong chain component need be contained\nin a biflag or chordless cycle. Examples appear in [5, 6].\nLet D0 \u2261 (V, E0 ) be an ADG and let D denote its ADG Markov equivalence class, the set of all ADGs D \u2261 (V, ED ) that are Markov equivalent to\nD0 . Andersson, Madigan and Perlman [3] defined the ADG essential graph\n(4.1)\n\nD\u2217 \u2261\n\n[\n\n{D|D \u2208 D} := (V,\n\n[\n\n(ED | D \u2208 D))\n\ndetermined by D and showed that it uniquely represents D. For ADGs, in\nfact, the ADG and AMP definitions of essential graph are identical.\nProposition 4.2. G contains some ADG D0 iff G \u2217 has no biflags and\nall its chain components are chordal. In this case G \u2217 = D \u2217 .\nProof. Since G \u2217 \u2208 G, the first statement follows from Proposition 3 of\n[4]. By Proposition 4.1(b), G \u2217 has no strong chain components, hence no\nstrong lines. Clearly, each arrow in G \u2217 , strong or weak, must occur with the\nw\nsame orientation in every D \u2208 D, so must occur in D \u2217 . If a weak line a \u2013 b\noccurs in G \u2217 , then the graphs H, H \u2032 in Remark 3.1 are ADGs and belong to\nD, so the line a \u2212 b must occur in D \u2217 . Thus, G \u2217 = D \u2217 . \u0003\nWe now turn to a characterization of the arrows in G \u2217 .\nDefinition 4.1. Let G \u2261 (V, E) be a chain graph. An arrow a \u2192 b \u2208 G\nis protected in G if it occurs in at least one of the seven configurations shown\nin Figure 5 as an induced subgraph of G.\nDefinition 4.2. Let G \u2261 (V, E) be a chain graph. An arrow a \u2192 b \u2208 G\nis irreversible in G if replacing a \u2192 b by a \u2190 b creates or destroys a triplex\nor creates a semi-directed cycle.\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\nFig. 5.\n\n25\n\nThe seven protected configurations for an arrow a \u2192 b \u2208 G.\n\nDetermination of the irreversibility of an arrow in G apparently requires\nglobal knowledge of G, since semi-directed cycles may be of arbitrary length.\nIn fact, however, only local knowledge of G is required:\nLemma 4.2. Let G \u2261 (V, E) be a chain graph. An arrow is irreversible\nin G if and only if it is protected in G.\nProof. Clearly, a protected arrow is irreversible. If a \u2192 b is irreversible\nin G by virtue of a \u2190 b creating (resp., destroying) a triplex, then a \u2192 b\nmust occur in configuration (i) or (vi\u2032 ) [resp., (ii) or (vii\u2032 )] as an induced\nsubgraph of G. If a \u2192 b is irreversible in G by virtue of a \u2190 b creating a\nsemi-directed cycle, then a \u2192 (b \u2261 d1 ) \u21d0 d2 \u21d0 * * * \u21d0 (dk \u2261 a) (k \u2265 3) occurs\nas a subgraph in G. Since G is adicyclic, at least one \u21d0 must be \u2190.\nSuppose first that b \u2190 d2 \u2208 G. If a*6** d2 , then a \u2192 b occurs in configuration\n(ii) with c = d2 . If a * * * d2 in G, then either a \u2192 d2 \u2208 G, a \u2212 d2 \u2208 G or\na \u2190 d2 \u2208 G. In the first (resp., second) case a \u2192 b occurs in configuration\n(iii) [resp., (v\u2032 )] with c = d2 . The third case cannot occur, for otherwise k \u2265 4\nand a \u2190 d2 \u21d0 * * * \u21d0 (dk \u2261 a) would be a semi-directed cycle in G. Suppose\nnext that b \u2212 d2 \u2208 G. Then a similar argument shows that a \u2192 b must occur\nin configuration (vii\u2032 ) or (viii\u2032 ) with c = d2 . \u0003\nBy the definition of G \u2217 , each arrow a \u2192 b \u2208 G \u2217 must be irreversible in G \u2217 ,\nhence, since G \u2217 is a chain graph, protected in G \u2217 . In fact, each arrow must\nbe well protected in G \u2217 .\nDefinition 4.3. Let G \u2217 \u2261 (V, E \u2217 ) be an AMP essential graph. An arrow\na \u2192 b \u2208 G \u2217 is well protected in G \u2217 if it occurs in at least one of the eight\nconfigurations shown in Figure 6 as an induced subgraph of G \u2217 .\n\n\f26\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nFig. 6.\n\nThe eight well-protected configurations for an arrow a \u2192 b \u2208 G \u2217\n\nProposition 4.3.\nprotected in G \u2217 .\n\nEach arrow in an AMP essential graph G \u2217 is well\ns\n\nProof. If \u03be(a) is strong, hence, nontrivial, \u2203 c \u2208 \u03be(a) such that c \u2013 a \u2192 b\nis a subgraph of G \u2217 . Here a \u2192 b must occur in configuration (v) or (vi) in\ns\nG \u2217 . If \u03be(b) is strong, hence nontrivial, then \u2203 c \u2208 \u03be(a) such that a \u2192 b \u2013 c is a\nsubgraph of G \u2217 . Here a \u2192 b must occur in configuration (vii) or (viii) in G \u2217 .\nLast, assume that both \u03be(a) and \u03be(b) are weak (or trivial). In particular,\na \u2192 b cannot occur in configuration (v), (vi), (vii) or (viii) in G \u2217 . We shall\nassume also that it does not occur in configuration (i), (ii), (iii) or (iv) and\nobtain a contradiction.\nWe begin by showing that G\u03b8\u2217 is complete, where\n(4.2)\n\n\u03b8 := {c \u2208 \u03be(a)|c \u2192 b \u2208 G \u2217 }.\n\nNote that a \u2208 \u03b8. If c \u2208 \u03b8 \\ {a}, then c \u2192 b \u2208 G \u2217 . Thus, c * * * a (necessarily\nc \u2212 a \u2208 G \u2217 ), for otherwise a \u2192 b \u2190 c would occur as an immorality in G \u2217 ,\ncontradicting the assumed nonoccurrence of a \u2192 b in configuration (ii) in G \u2217 .\nIf c, c\u2032 \u2208 \u03b8 \\ {a} then c \u2192 b \u2208 G \u2217 and c\u2032 \u2192 b \u2208 G \u2217 , while c \u2212 a \u2208 G \u2217 and c\u2032 \u2212 a \u2208\nG \u2217 by the preceding argument, hence c \u2212 c\u2032 \u2208 G \u2217 by the nonoccurrence of\n(iv) in G \u2217 . Thus, \u03b8 is complete.\n\u2217\n\u2217\nBy Lemma 3.3, G\u03be(b)\nand G\u03be(a)\nare chordal UGs. Construct G from G \u2217\nby assigning perfect orientations to the lines (if any) in these two UGs as\nfollows. First, let q = |\u03b8| \u2265 1, let (c1 , . . . , cq\u22121 ) be an arbitrary numbering of\n\u2217\n\u03b8\\{a} and let cq = a. Apply MCS to G\u03be(a)\nstarting at c1 . The completeness of\n\u2217\nG\u03b8 ensures that MCS can reproduce the initial sequence (c1 , . . . , cq \u2261 a). The\n\u2217\nresulting perfect orientation in G of the lines of G\u03be(a)\nsatisfies the following\ntwo conditions:\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n27\n\n\u2217\n(\u03b1) any line a \u2212 c \u2208 G\u03be(a)\nwith c \u2208 \u03b8\\{a} becomes a \u2190 c in G;\n\u2217\n(\u03b2) any line a \u2212 d \u2208 G\u03be(a) with d \u2208 \u03be(a)\\\u03b8 becomes a \u2192 d in G. Next,\n\u2217\norient the lines in G\u03be(b)\naccording to MCS started at b; in particular,\n\u2217\n(\u03b3) any line b \u2212 c \u2208 G\u03be(b)\nbecomes b \u2192 c in G.\n\nNow construct G\u2032 from G by replacing a \u2192 b by a \u2190 b, so G \u2217 , G and G\u2032\nhave the same skeleton. We shall show that G and G\u2032 are adicyclic and have\nthe same flags and immoralities as G \u2217 , hence G, G\u2032 \u2208 G. Thus, a \u2212 b \u2208 G \u2217 ,\nthe desired contradiction.\nBecause G\u03be(a) and G\u03be(b) are acyclic digraphs, any semi-directed cycle in G\ncannot be entirely contained in G\u03be(a) or in G\u03be(b) , hence must include at least\none arrow of G \u2217 . Since G \u2286 G \u2217 , this cycle must correspond to a semi-directed\ncycle in G \u2217 , contradicting the adicyclicity of G \u2217 . Thus, G is adicyclic.\nIf d \u2192 e \u2190 f is an immorality in G \u2217 , then it also occurs as an immorality\nin G, since both graphs have the same skeleton and G \u2286 G \u2217 . If d \u2192 e \u2212 f is\ns\na flag in G \u2217 , then d \u2192 e \u2208 G and e \u2013 f \u2208 G \u2217 [Lemma 3.2(a)] so e \u2212 f remains\na line in G, hence d \u2192 e \u2212 f is a flag in G. If d \u2192 e \u2212 f is a flag in G but\nnot in G \u2217 \u2287 G, then d \u2212 e \u2212 f occurs as an induced subgraph of G \u2217 and\n\u2217\n\u2217 , hence also e \u2212 f \u2208 G \u2217\n\u2217\nnecessarily d \u2212 e \u2208 G\u03be(a)\nor G\u03be(b)\n\u03be(a) or G\u03be(b) , so e * * * f\nmust occur as an arrow in G, a contradiction. Finally, if d \u2192 e \u2190 f is an\nimmorality in G, but not in G \u2217 , then at least one of these arrows, say, d \u2192 e,\n\u2217\n\u2217 , so d w\noccurs as a line d \u2212 e in G \u2217 , hence d \u2212 e \u2208 G\u03be(a)\nor G\u03be(b)\n\u2013 e \u2208 G \u2217 . Since\nw\n\nd \u2013 e \u2190 f cannot occur as a flag in G \u2217 , necessarily e \u2212 f \u2208 G \u2217 , so d \u2212 e \u2212 f\n\u2217\n\u2217 . But this subgraph cannot\noccurs as an induced subgraph of G\u03be(b)\nor G\u03be(b)\nbecome an immorality d \u2192 e \u2190 f in G because the orientations of G\u03be(b) and\nG\u03be(b) are perfect, a contradiction. Thus, G \u2217 and G have the same flags and\nimmoralities.\nIf G\u2032 were not adicyclic, then since G is adicyclic, G\u2032 must contain a semidirected cycle with a \u2190 b, so this cycle must have the form a \u2190 (b \u2261 c1 ) \u21d0\nc2 \u21d0 * * * \u21d0 (ck \u2261 a) (k \u2265 3) in G\u2032 . Therefore, G must contain the subgraph\na \u2192 (b \u2261 c1 ) \u21d0 c2 \u21d0 * * * \u21d0 (ck \u2261 a) and, since G \u2286 G \u2217 , a subgraph of this\nform also occurs in G \u2217 . Consider the edge b \u21d0 c2 in G \u2217 . If b \u2212 c2 \u2208 G \u2217 , then\n\u2217 , hence b \u2192 c \u2208 G by (\u03b3), contradicting the occurrence of b \u21d0 c\nb \u2212 c2 \u2208 G\u03be(b)\n2\n2\nin G. Next, if b \u2190 c2 \u2208 G \u2217 , then a \u21d0 c2 in G \u2217 by the assumed nonoccurrence\nof (ii) and (iii) in G \u2217 . If this edge is a \u2190 c2 in G \u2217 , then a \u2190 c2 \u2208 G, so\na \u2190 c2 \u2208 G\u2032 , which implies that k \u2265 4 and that a \u2190 c2 \u21d0 * * * \u21d0 (ck \u2261 a) is a\nsemi-directed cycle in G, a contradiction. If this edge is a \u2212 c2 in G \u2217 , then\nc2 \u2208 \u03b8\\{a}, so a \u2190 c2 \u2208 G by (\u03b1), leading to the same contradiction. Thus,\nG\u2032 is adicyclic.\nSuppose that an immorality d \u2192 e \u2190 f occurs in G but not in G\u2032 . Then\none of these two arrows, say, d \u2192 e, must be a \u2192 b, so a \u2192 b \u2190 f occurs as\nan immorality in G \u2286 G \u2217 . Thus, either a \u2192 b \u2190 f occurs as an immorality in\n\n\f28\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nG \u2217 , contradicting the nonoccurrence of (ii), or a \u2192 b\u2212 f occurs as a subgraph\nin G \u2217 so b \u2192 f \u2208 G by (\u03b3), a contradiction. If d \u2192 e \u2212 f occurs as a flag in\nG but not in G\u2032 , then the arrow d \u2192 e must be the arrow a \u2192 b in G, hence\na \u2192 b \u2212 f occurs as a subgraph in G and therefore in G \u2217 , so b \u2192 f \u2208 G by\n(\u03b3), again a contradiction. If d \u2212 e \u2190 f occurs as a flag in G\u2032 but not in\nG, then the arrow e \u2190 f must be the arrow a \u2190 b in G\u2032 , so d \u2212 a \u2192 b is a\nsubgraph of G \u2286 G \u2217 , hence d \u2208 \u03be(a). But then the edge d * * * a must be an\narrow in G, a contradiction. Finally, if d \u2192 e \u2190 f occurs as an immorality\nin G\u2032 but not in G, then one arrow, say, e \u2190 f , must be a \u2190 b in G\u2032 , so\nd \u2192 a \u2192 b occurs as an induced subgraph in G \u2286 G \u2217 . Thus, either d \u2192 a \u2192 b\noccurs as an induced subgraph in G \u2217 , contradicting the nonoccurrence of\nw\n(i), or d \u2013 a \u2192 b occurs as an induced subgraph in G \u2217 , so d \u2208 \u03be(a)\\\u03b8, hence\nd \u2190 a \u2208 G by (\u03b2), a contradiction. Thus, G and G\u2032 have the same flags and\nimmoralities. \u0003\nThe examples in Figures 3 and 4 show that Proposition 4.3 is rendered\ninvalid if any of the eight configurations (i), (ii), (iii), (iv), (v), (vi), (vii)\nor (viii) is excluded from the definition of well protection in Definition 4.3.\nHowever, weak arrows and strong arrows of G \u2217 are well protected in more\nstringent fashions, namely, configurations (iv) and (vii) cannot occur for\nthe well protection of weak arrows, while (vi) is not required for the well\nprotection of strong arrows-see [5], Propositions 4.4 and 4.5.\nBy Lemma 3.6(b), both arrows in configurations (v) and (viii) must be\nstrong or both weak. The example in Figure 4(4) (resp., Figure 7) shows\nthat if the strong line in (v) [resp., (viii)] is replaced by a weak line, then it\ncan occur in G \u2217 that one arrow is strong and the other weak.\nWe conclude this section with an easy characterization of those directed\ngraphs that can occur as AMP essential graphs.\nTheorem 4.1. A directed graph G is an AMP essential graph iff it\nis acyclic and each arrow is protected in G, that is, occurs in one of the\nconfigurations (i), (ii), or (iii) as an induced subgraph of G. Thus, the class\n\nFig. 7.\n\nAn AMP essential graph G \u2217 .\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n29\n\nof directed AMP essential graphs coincides with the class of directed ADG\nessential graphs.\nProof. \"Only if\" follows immediately from Theorem 3.2 and Proposition 4.3. \"If\" and the final statement follow from Corollary 4.2 of [3] and\nProposition 4.2. \u0003\n5. Characterization of AMP essential graphs. Because the well-protected\nconfigurations (v), (vi), (vii) and (viii) in Definition 4.3 involve strong lines,\nthe local characterization of the arrows of an AMP essential graph G \u2217 given\nin Proposition 4.3 in turn requires a characterization of the strong lines of\nG \u2217 . By Lemma 3.3, any line in a chordless undirected cycle or biflag must\nbe strong, but G \u2217 may contain other strong lines as well (see [5, 6]). Because\n[Proposition 4.1(b)] the strong chain components of G \u2217 are distinguished\nfrom the weak chain components by the presence of at least one chordless\ncycle or biflag and the latter involves at least one arrow, the strong lines\ncannot be determined in an intrinsic way. A characterization (necessarily\nnonintrinsic) of the strong chain components of G \u2217 is contained in the characterization of AMP essential graphs given in Theorem 5.1.\nSome additional terminology is required. Let G \u2261 (V, E) be an adicyclic\ngraph. For any nonempty subset \u03b1 \u2286 V , a vertex v \u2208\n/ \u03b1 is called a covering\nneighbor (covering parent) of \u03b1 if v is a neighbor (parent) of each a \u2208 \u03b1,\nwhile v \u2208\n/ \u03b1 is called a noncovering neighbor (noncovering parent) of \u03b1 if v\nis a neighbor (parent) of at least one a \u2208 \u03b1 but fails to be a neighbor (parent)\nof at least one other a\u2032 \u2208 \u03b1. The set of covering neighbors (covering parents)\nof \u03b1 is denoted by cnbG (\u03b1) [cpaG (\u03b1)]. The set of noncovering neighbors\nof \u03b1 is denoted by ncnbG (\u03b1). Note that nbG (\u03b1) = cnbG (\u03b1) \u222a \u0307 ncnbG (\u03b1) and\ncnbG (cnbG (\u03b1)) \u2287 \u03b1. If \u03b1 \u2261 {a} is a singleton, then trivially ncnbG (\u03b1) = \u2205.\nLemma 5.1. Let G \u2261 (V, E) be a chain graph, \u03be \u2208 \u039e(G) a nontrivial\nchain component, and \u03be \u0304 = clG (\u03be) \u2261 \u03be \u222a \u0307 paG (\u03be). The following two properties\nof G\u03be\u0304 are equivalent:\nS: For every nonempty complete subset \u03b1 ( \u03be in G\u03be such that \u03ba \u2261 cnbG\u03be (\u03b1)\nis nonempty, let \u03ba1 , . . . , \u03bar denote the connected components of G\u03ba . Then\nfor each q = 1, . . . , r, either:\n(i) nbG\u03be (\u03baq ) \\ \u03b1 6= \u2205, or\n(ii) paG\u03be\u0304 (\u03b1) \\ cpaG\u03be\u0304 (\u03baq ) 6= \u2205 (equivalently, G\u03be\u0304 contains a flag t \u2192\nu \u2212 v with t \u2208 V \\ \u03be, u \u2208 \u03b1, and v \u2208 \u03baq ).\nS\u2032 : For every nonempty connected subset \u03ba ( \u03be such that \u03b1 \u2261 cnbG\u03be (\u03ba) is\nnonempty and complete, either:\n(i\u2032 ) ncnbG\u03be (\u03ba) 6= \u2205, or\n\n\f30\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\n(ii\u2032 ) paG\u03be\u0304 (\u03b1) \\ cpaG\u03be\u0304 (\u03ba) 6= \u2205 (equivalently, G\u03be\u0304 contains a flag t \u2192\nv \u2212 w with v \u2208 \u03b1 and w \u2208 \u03ba).\nProof. S =\u21d2 S\u2032 : Assume that G\u03be\u0304 satisfies S and let \u03ba ( \u03be be a nonempty\nconnected subset in G\u03be s.t. \u03b1 \u2261 cnbG\u03be (\u03ba) is nonempty and complete. Then\n\u03ba\u2032 \u2261 cnbG\u03be (\u03b1) \u2287 \u03ba is nonempty, so by S, either (i) nbG\u03be (\u03ba\u2032q ) \\ \u03b1 6= \u2205 or\n(ii) paG\u03be\u0304 (\u03b1) \\ cpaG\u03be\u0304 (\u03ba\u2032q ) 6= \u2205, where \u03ba\u2032q is the unique connected component of G\u03ba\u2032 that contains \u03ba. If \u03ba\u2032q = \u03ba, then either nbG\u03be (\u03ba) \\ \u03b1 6= \u2205 or\npaG\u03be\u0304 (\u03b1) \\ cpaG\u03be\u0304 (\u03ba) 6= \u2205, so (i\u2032 ) or (ii\u2032 ) holds. If c \u2208 \u03ba\u2032q ) \u03ba, let \u03c0 = (c \u2261\nc0 , c1 , . . . , cl ) be a minimal-length path from c to \u03ba in G\u03ba\u2032q . Then cl\u22121 \u2208\nnbG\u03be (\u03ba) \u2229 \u03ba\u2032q \u2286 nbG\u03be (\u03ba) \\ \u03b1 = ncnbG\u03be (\u03ba), so (i\u2032 ) holds. Thus, S\u2032 holds in either case.\nS\u2032 =\u21d2 S: Assume that G\u03be\u0304 satisfies S\u2032 and let \u03b1 ( \u03be be a nonempty complete subset in G\u03be s.t. \u03ba \u2261 cnbG\u03be (\u03b1) is nonempty. Let \u03ba1 , . . . , \u03bar denote the\nconnected components of G\u03ba , fix q \u2208 {1, . . . , r}, and let \u03b1\u2032 \u2261 cnbG\u03be (\u03baq ) \u2287\n\u03b1 6= \u2205. If nbG\u03be (\u03baq ) \\ \u03b1 6= \u2205, then (i) holds, so assume that nbG\u03be (\u03baq ) \\ \u03b1 = \u2205.\nIn this case \u03b1\u2032 = \u03b1, so \u03b1\u2032 is nonempty and complete, hence S\u2032 implies that\neither (i\u2032 ) ncnbG\u03be (\u03baq ) 6= \u2205 or (ii\u2032 ) paG\u03be\u0304 (\u03b1\u2032 ) \\ cpaG\u03be\u0304 (\u03baq ) 6= \u2205. If (i\u2032 ), then\nnbG\u03be (\u03baq ) \\ \u03b1 \u2261 ncnbG\u03be (\u03baq ) 6= \u2205 so (i) holds, while if (ii\u2032 ), then (ii) is immediate, so S holds in either case. \u0003\nLemma 5.2. Let \u03c3 be a strong chain component of the AMP essential\ngraph G \u2217 and let \u03c3\u0304 = clG \u2217 (\u03c3) \u2261 \u03c3 \u222a \u0307 paG \u2217 (\u03c3). Then G\u03c3\u0304\u2217 satisfies S \u2261 S\u2032 .\nProof. To show that G\u03c3\u0304\u2217 satisfies S, let \u03b1 ( \u03c3 be a complete subset of G\u03c3\u2217\nsuch that \u03ba \u2261 cnbG\u03c3\u2217 (\u03b1) 6= \u2205 and let \u03ba1 , . . . , \u03bar be the connected components\nof G\u03ba\u2217 . For any q = 1, . . . , r, let H be the graph obtained from G \u2217 by replacing\nthe lines a \u2212 c by a \u2192 c for every (a, c) \u2208 \u03b1 \u00d7 \u03baq . This cannot create any\nimmoralities in H since \u03b1 is complete. If paG\u03c3\u0304\u2217 (\u03b1) \\ cpaG\u03c3\u0304\u2217 (\u03baq ) = \u2205, this would\nnot destroy any triplexes in G \u2217 . (Note that such a destroyed triplex must be\na flag in G \u2217 , since no arrows of G \u2217 are altered.) If nbG\u03c3\u2217 (\u03baq ) \\ \u03b1 = \u2205, neither\nwould any flags or semi-directed cycles be created in H. Thus, H would have\nthe same skeleton and triplexes as G \u2217 , so H \u2208 G. But H\u03c3 contains at least\none arrow, so this contradicts the assumption that \u03c3 is strong. \u0003\nWe are ready to present a complete characterization of general AMP chain\ngraphs. The following definitions are needed.\nDefinition 5.1. Let G \u2261 (V, E) be a chain graph and let \u039es (G) denote\nthe set of nontrivial chain components \u03be of G such that G\u03be\u0304 contains at least\none chordless undirected cycle or flag. Call a line a \u2212 b \u2208 G strong in G\ns\n(indicated as a \u2013 b \u2208 G) if a, b \u2208 \u03be for some \u03be \u2208 \u039es (G). Let \u039et (G) denote\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n31\n\nthe set of trivial (\u2261 singleton) chain components of G, set \u039ew (G) = \u039e(G) \\\nw\n(\u039es (G) \u222a \u0307 \u039et (G)), and call a line a \u2212 b \u2208 G weak in G (indicated as a \u2013 b \u2208 G)\nif a, b \u2208 \u03be for some \u03be \u2208 \u039ew (G). Thus, for each \u03be \u2208 \u039ew (G), G\u03be\u0304 contains no\nchordless undirected cycle or flag.\nDefinition 5.2. An arrow a \u2192 b \u2208 G is well protected in G if it occurs\nin at least one of the eight configurations in Figure 6 as an induced subgraph\ns\nof G, where \u2013 is now defined as in Definition 5.1.\nBy Proposition 4.1(b), these definitions of strong/weak lines in G and\nwell-protected arrows in G agree with the previous definitions when G \u2261 G \u2217\nis an AMP essential graph.\nTheorem 5.1. A graph G \u2261 (V, E) is an AMP essential graph, that is,\nG = G \u2217 for some AMP Markov equivalence class G, if and only if G satisfies\nthe following three conditions:\nG1: G is a chain graph, that is, is adicyclic.\nG2: For each \u03be \u2208 \u039es (G), G\u03be\u0304 satisfies property S \u2261 S\u2032 .\nG3: Each arrow in G is well protected in G.\nProof. \"Only if\": If G \u2261 G \u2217 is an AMP essential graph, G1 follows from\nTheorem 3.2, G2 follows from Proposition 4.1(b) and Lemma 5.2, and G3\nfollows from Proposition 4.3.\n\"If\": Assume that G satisfies G1, G2 and G3. Let G be the AMP Markov\nequivalence class containing G. To show that G = G \u2217 , it suffices to establish\nthe stronger fact that:\nw\n\nw\n\n(a) if a \u2013 b \u2208 G, then a \u2013 b \u2208 G \u2217 ;\ns\ns\n(b) if a \u2013 b \u2208 G, then a \u2013 b \u2208 G \u2217 ;\n(c) if a \u2192 b \u2208 G, then a \u2192 b \u2208 G \u2217 .\n(a): It suffices to show that \u2203 H, H \u2032 \u2208 G such that a \u2192 b \u2208 H and a \u2190\nw\nb \u2208 H \u2032 . Since a \u2013 b \u2208 G, a, b \u2208 \u03be for some \u03be \u2208 \u039ew (G). Since G\u03be is chordal, use\nMCS starting at a (resp., b) to obtain a perfect orientation of G\u03be , thereby\nreplacing G by a graph H (resp., H \u2032 ) with a \u2192 b \u2208 H (resp., a \u2190 b \u2208 H \u2032 ).\nSince G\u03be\u0304 has no flags, it is straightforward to show that H and H \u2032 are\nadicyclic and have the same triplexes as G, as required.\n(b): It suffices to show that, for every \u03be \u2208 \u039es (G) and every H \u2208 G, H\u03be has\nno arrows. Suppose to the contrary that H\u03be has at least one arrow. (Note\nthat H\u03be must be adicyclic since H is adicyclic.) Choose a \u2192 b \u2208 H\u03be so that b\nis maximal w.r.t. the pre-ordering induced on \u03be by H\u03be , that is, there exists\nno semi-directed path in H\u03be beginning at b. Let \u03be(b) \u2208 \u039e(H\u03be ) be the unique\n\n\f32\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nchain component of H\u03be (possibly trivial) containing b and let \u03b1 = nbG\u03be (\u03be(b)).\nNote that a \u2208 \u03b1 since a \u2212 b \u2208 G\u03be . For any a\u2032 \u2208 \u03b1, a\u2032 \u2212 b\u2032 \u2208 G\u03be for some\nb\u2032 \u2208 \u03be(b), so a\u2032 * * * b\u2032 \u2208 H\u03be . If a\u2032 6= a, then, by the maximality of b and the\nconnectedness of \u03be(b), a\u2032 \u21d2 b\u2032 \u2208 H\u03be , so by the definition of \u03be(b), a\u2032 \u2192 b\u2032 \u2208 H\u03be .\nIf a\u2032 = a, then a\u2032 \u2192 b \u2208 H\u03be . Thus, for every a\u2032 \u2208 \u03b1, a\u2032 \u2192 b\u2032\u2032 \u2208 H\u03be for all\nb\u2032\u2032 \u2208 \u03be(b) since \u03be(b) is connected and H\u03be can have no flags (because G\u03be has\nno arrows, hence no triplexes). Thus, \u03b1 = cnbG\u03be (\u03be(b)), which in turn implies\nthat \u03b1 is complete, since H\u03be can have no immoralities. Therefore, since G\u03be\u0304\nsatisfies property S\u2032 by G2, either ncnbG\u03be (\u03be(b)) 6= \u2205 or paG (\u03b1)\\cpaG (\u03be(b)) 6=\n\u2205. The former is impossible since ncnbG\u03be (\u03be(b)) = nbG\u03be (\u03be(b)) \\ cnbG\u03be (\u03be(b)) =\n\u03b1 \\ \u03b1 = \u2205. If the latter holds, then \u2203 v \u2208 V \\ \u03be, a\u2032 \u2208 \u03b1, and b\u2032 \u2208 \u03be(b) such that\nv \u2192 a\u2032 \u2208 G but v*6** b\u2032 in G. But necessarily a\u2032 \u2212 b\u2032 \u2208 G\u03be , while a\u2032 \u2192 b\u2032 \u2208 H\u03be ,\nso v \u2192 a\u2032 \u2212 b\u2032 occurs as a flag in G but not in H, also a contradiction.\n(c): It suffices to show that\nA \u2261 {a\u2032 \u2208 V |\u2203 b\u2032 \u2208 V \u220b a\u2032 \u2192 b\u2032 \u2208 G, a\u2032 \u2212 b\u2032 \u2208 G \u2217 } = \u2205.\nIf A 6= \u2205, let a be a minimal element of A with respect to the pre-ordering\ninduced on V by G. Since a \u2208 A,\nB \u2261 {b\u2032 \u2208 V |a \u2192 b\u2032 \u2208 G, a \u2212 b\u2032 \u2208 G \u2217 } =\n6 \u2205.\nLet b be a minimal element of B; in particular, a \u2192 b \u2208 G and a \u2212 b \u2208 G \u2217 .\nBy G3, a \u2192 b is well protected in G, so it occurs in at least one of the eight\nconfigurations (i)\u2013(viii) in Figure 6 as an induced subgraph of G.\n(i) If c \u2192 a \u2192 b occurs as an induced subgraph in G, then by the minimality of a the flag c \u2192 a \u2212 b must occur in G \u2217 , contradicting the fact that\nG and G \u2217 have the same triplexes.\n(ii) If a \u2192 b \u2190 c occurs as an induced subgraph in G, then the flag a\u2212b \u2190\ns\nc must occur in G \u2217 , which would require that a \u2013 b \u2208 G \u2217 , hence a \u2212 b \u2208 G,\nagain a contradiction.\n(iii) If a \u2192 b \u2190 c \u2190 a occurs as a triangle in G, then, by the minimality\nof b, the semi-directed triangle a \u2212 b \u21d0 c \u2190 a must occur in G \u2217 , contradicting\nthe adicyclicity of G \u2217 .\n(iv) If a \u2192 b occurs in configuration (iv) in G, denote the immorality in\nthis configuration by c \u2192 b \u2190 d. Since G and G \u2217 have the same triplexes,\neither c \u2192 b \u21d0 d or c \u21d2 b \u2190 d occurs as an induced subgraph of G \u2217 . Without\nloss of generality, assume the former. Since a \u2212 b \u2208 G \u2217 , necessarily c \u2192 a \u2208 G \u2217\nby the adicyclicity of G \u2217 , hence a \u2192 d \u2208 G \u2217 since G and G \u2217 have the same\ntriplexes. But then the semi-directed triangle a \u2192 d \u21d2 b \u2212 a occurs in G \u2217 ,\nagain contradicting adicyclicity.\n(v), (vi), (vii), (viii): If a \u2192 b occurs in configuration (v), (vi), (vii) or (viii)\nin G, by (b) the strong line in this configuration must also be strong in G \u2217 .\ns\nSince a \u2212 b \u2208 G \u2217 , Lemma 4.1(d) implies that a \u2013 b \u2208 G \u2217 , which contradicts\na \u2192 b \u2208 G. This completes the proof of (c). \u0003\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n33\n\nThe necessity of Condition G2 is demonstrated by the graph G in Figure 2\nand the upper graph G\u221e in Figure 1. The necessity of G3 is demonstrated\nby the graph consisting of a single arrow.\nFor comparison with Theorem 5.1, the characterization of ADG essential\ngraphs in Theorem 4.1 of [3] can be stated as follows: G is an ADG essential\ngraph iff it satisfies conditions G1, G2\u2032 : \u039es (G) = \u2205 and G3.\nMore detailed results on the structure of a strong chain component \u03c3\nof G \u2217 \u2261 (V, E \u2217 ) can be obtained from Theorem 5.1. For example, if G \u2217 is\na strong connected undirected AMP essential graph (so \u03c3 = V ), then by\nProposition 4.1(b), G \u2217 must contain at least one chordless cycle. Using Theorem 5.1, however, it can be shown that unless G \u2217 consists exactly of a single\nchordless cycle, it must contain at least one additional chordless cycle. For\na general AMP essential graph G \u2217 , by Proposition 4.1(b), G\u03c3\u0304\u2217 must contain\neither a chordless undirected cycle or a biflag. Using Theorem 5.1, however,\nit can be shown that G\u03c3\u0304\u2217 must contain another chordless undirected cycle or\nbiflag or \"3-halfbiflag.\" These results appear in [5, 6].\n6. Current research. Like the essential graph D \u2217 for ADG Markov models, the AMP essential graph G \u2217 plays a fundamental role for inference,\nmodel selection and model averaging for AMP CG Markov models. For these\npurposes, the results of [3] and [21] can be extended to AMP CG models\nby means of our characterization of AMP essential graphs in Theorem 5.1\nabove. In particular, a polynomial-time algorithm for constructing G \u2217 from\nany G \u2208 G has been obtained-see [5], Chapter 7.\nThe following additional topics are currently under development:\n1. The computational complexity of the above construction algorithm.\n2. An algorithm for recovering all G \u2208 G from G \u2217 .\n3. Markov chain Monte Carlo algorithms for model search over the space of\nAMP Markov equivalence classes by means of AMP essential graphs.\n4. A catalog of AMP essential graphs with small vertex sets.\n5. Determination of the ratio rn of the number of AMP CG Markov equivalence classes to the total number of CGs with n vertices (cf. [16] for the\ncorresponding question for ADG models).\n6. When is an AMP CG Markov equivalent to some LWF CG, and vice\nversa? (Cf. [4], Theorem 6.)\nAcknowledgments. We thank Robert Castelo, Sanjay Chaudhuri, Mathias Drton, Steven Gillispie, David Madigan, Chris Meek, Marina Meila,\nThomas Richardson, Alberto Roverato, Milan Studen\u00fd, a referee and especially an Associate Editor for helpful comments and suggestions.\n\n\f34\n\nS. A. ANDERSSON AND M. D. PERLMAN\n\nREFERENCES\n[1] Andersson, S. A., Madigan, D. and Perlman, M. D. (1996). An alternative\nMarkov property for chain graphs. In Uncertainty in Artificial Intelligence: Proc.\nTwelfth Conference (F. Jensen and E. Horvitz, eds.) 40\u201348. Morgan Kaufmann,\nSan Francisco. MR1617123\n[2] Andersson, S. A., Madigan, D. and Perlman, M. D. (1997). On the Markov\nequivalence of chain graphs, undirected graphs and acyclic digraphs. Scand. J.\nStatist. 24 81\u2013102. MR1436624\n[3] Andersson, S. A., Madigan, D. and Perlman, M. D. (1997). A characterization\nof Markov equivalence classes for acyclic digraphs. Ann. Statist. 25 505\u2013541.\nMR1439312\n[4] Andersson, S. A., Madigan, D. and Perlman, M. D. (2001). Alternative Markov\nproperties for chain graphs. Scand. J. Statist. 28 33\u201385. MR1844349\n[5] Andersson, S. A. and Perlman, M. D. (2004). Characterizing\nMarkov equivalence classes for AMP chain graph models. Technical Report 453, Dept. Statistics, Univ. Washington. Available at\nwww.stat.washington.edu/www/research/reports/2004/tr453.pdf.\n[6] Andersson, S. A. and Perlman, M. D. (2005). On the structure of essential graphs\nfor AMP chain graph models. To appear.\n[7] Blair, J. R. S. and Peyton, B. (1993). An introduction to chordal graphs and\nclique trees. In Graph Theory and Sparse Matrix Computation (A. George, J.\nR. Gilbert and J. W. H. Liu, eds.) 1\u201329. Springer, New York. MR1320296\n[8] Bouckaert, R. R. and Studen\u00fd, M. (1995). Chain graphs: Semantics and expressiveness. Symbolic and Quantitative Approaches to Reasoning and Uncertainty.\nLecture Notes in Artificial Intelligence 946 69\u201376. Springer, Berlin. MR1464966\n[9] Buntine, W. L. (1995). Chain graphs for learning. In Uncertainty in Artificial Intelligence: Proc. Eleventh Conference (P. Besnard and S. Hanks, eds.) 46\u201354.\nMorgan Kaufmann, San Francisco. MR1615011\n[10] Castelo, R. and Perlman, M. D. (2004). Learning essential graph Markov models\nfrom data. In Advances in Bayesian Networks (J. A. G\u00e1mez, S. Moral and A.\nSalmer\u00f3n, eds.) 255\u2013269. Springer, Berlin. MR2090887\n[11] Cowell, R. G., Dawid, A. P., Lauritzen, S. L. and Spiegelhalter, D. J. (1999).\nProbabilistic Networks and Expert Systems. Springer, New York. MR1697175\n[12] Cox, D. R. (1999). Graphical Markov models: Statistical motivation. Paper presented at the Workshop on Conditional Independence Structures and Graphical Models, Fields Institute for Research in Mathematical Sciences, Toronto,\nCanada.\n[13] Cox, D. R. and Wermuth, N. (1996). Multivariate Dependencies: Models, Analysis\nand Interpretation. Chapman and Hall, London. MR1456990\n[14] Drton, M. and Eichler, M. (2006). Maximum likelihood estimation in Gaussian\nchain graph models under the alternative Markov property. Scand. J. Statist. 33\n247\u2013258.\n[15] Frydenberg, M. (1990). The chain graph Markov property. Scand. J. Statist. 17\n333\u2013353. MR1096723\n[16] Gillispie, S. and Perlman, M. D. (2002). The size distribution for Markov equivalence classes of acyclic digraph models. Artificial Intelligence 141 137\u2013155.\nMR1935281\n[17] H\u00f8jsgaard, S. and Thiesson, B. (1995). BIFROST\u2013Block recursive models induced from relevant knowledge, observations and statistical techniques. Comput.\nStatist. Data Anal. 19 155\u2013175.\n\n\fMARKOV EQUIVALENCE FOR AMP CHAIN GRAPHS\n\n35\n\n[18] Lauritzen, S. L. (1996). Graphical Models. Oxford Univ. Press. MR1419991\n[19] Lauritzen, S. L. and Wermuth, N. (1989). Graphical models for associations\nbetween variables, some of which are qualitative and some quantitative. Ann.\nStatist. 17 31\u201357. MR0981437\n[20] Levitz, M., Perlman, M. D. and Madigan, D. (2001). Separation and completeness properties for AMP chain graph Markov models. Ann. Statist. 29 1751\u20131784.\nMR1891745\n[21] Madigan, D., Andersson, S. A., Perlman, M. D. and Volinsky, C. T. (1996).\nBayesian model averaging and model selection for Markov equivalence classes of\nacyclic digraphs. Comm. Statist.-Theory Methods 25 2493\u20132519.\n[22] Roverato, A. (2005). A unified approach to the characterization of equivalence\nclasses of DAGs, chain graphs with no flags and chain graphs. Scand. J. Statist.\n32 295\u2013312. MR2188675\n[23] Studen\u00fd, M. (1996). On separation criterion and recovery algorithm for chain\ngraphs. In Uncertainty in Artificial Intelligence: Proc. Twelfth Conference (F.\nJensen and E. Horvitz, eds.) 509\u2013516. Morgan Kaufmann, San Francisco.\nMR1617229\n[24] Studen\u00fd, M. (1997). A recovery algorithm for chain graphs. Internat. J. Approx.\nReason. 17 265\u2013293. MR1462716\n[25] Studen\u00fd, M. (1998). Bayesian networks from the point of view of chain graphs.\nIn Uncertainty in Artificial Intelligence: Proc. Fourteenth Conference (G. F.\nCooper and S. Moral, eds.) 496\u2013503. Morgan Kaufmann, San Francisco.\n[26] Studen\u00fd, M. and Bouckaert, R. R. (1998). On chain graph models for description\nof conditional independence structure. Ann. Statist. 26 1434\u20131495. MR1647685\n[27] Volf, M. and Studen\u00fd, M. (1999). A graphical characterization of the largest chain\ngraphs. Internat. J. Approx. Reason. 20 209\u2013236. MR1685080\n[28] Wermuth, N. and Lauritzen, S. L. (1990). On substantive research hypotheses,\nconditional independence graphs and graphical chain models (with discussion).\nJ. Roy. Statist. Soc. Ser. B 52 21\u201372. MR1049302\n[29] Whittaker, J. (1990). Graphical Models in Applied Multivariate Statistics. Wiley,\nChichester. MR1112133\nDepartment of Mathematics\nIndiana University\nBloomington, Indiana 47405\nUSA\nE-mail: standers@indiana.edu\n\nDepartment of Statistics\nUniversity of Washington\nSeattle, Washington 98195-4322\nUSA\nE-mail: michael@stat.washington.edu\n\n\f"}