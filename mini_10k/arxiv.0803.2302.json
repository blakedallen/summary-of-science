{"id": "http://arxiv.org/abs/0803.2302v1", "guidislink": true, "updated": "2008-03-15T15:28:10Z", "updated_parsed": [2008, 3, 15, 15, 28, 10, 5, 75, 0], "published": "2008-03-15T15:28:10Z", "published_parsed": [2008, 3, 15, 15, 28, 10, 5, 75, 0], "title": "On perpetual American put valuation and first-passage in a\n  regime-switching model with jumps", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0803.2406%2C0803.0345%2C0803.2537%2C0803.1336%2C0803.1134%2C0803.2734%2C0803.3176%2C0803.2105%2C0803.3977%2C0803.0409%2C0803.3530%2C0803.2263%2C0803.1360%2C0803.3311%2C0803.3424%2C0803.4117%2C0803.4257%2C0803.2664%2C0803.0286%2C0803.1064%2C0803.3932%2C0803.2544%2C0803.1855%2C0803.0893%2C0803.2982%2C0803.2436%2C0803.3975%2C0803.1731%2C0803.2371%2C0803.3571%2C0803.2302%2C0803.3145%2C0803.2657%2C0803.1263%2C0803.4119%2C0803.2073%2C0803.3427%2C0803.2844%2C0803.2240%2C0803.3053%2C0803.4012%2C0803.1356%2C0803.4035%2C0803.0212%2C0803.2578%2C0803.0123%2C0803.1581%2C0803.0809%2C0803.1224%2C0803.1738%2C0803.4128%2C0803.3590%2C0803.1135%2C0803.4353%2C0803.1787%2C0803.3996%2C0803.0325%2C0803.1883%2C0803.0919%2C0803.2781%2C0803.3502%2C0803.1913%2C0803.0754%2C0803.1138%2C0803.4308%2C0803.3034%2C0803.0368%2C0803.0372%2C0803.1714%2C0803.4467%2C0803.2112%2C0803.2665%2C0803.2480%2C0803.2634%2C0803.2235%2C0803.2247%2C0803.2349%2C0803.3844%2C0803.0488%2C0803.1993%2C0803.2662%2C0803.1921%2C0803.3388%2C0803.0152%2C0803.2559%2C0803.3073%2C0803.1471%2C0803.2049%2C0803.2654%2C0803.0900%2C0803.0700%2C0803.3240%2C0803.4031%2C0803.2450%2C0803.2834%2C0803.2013%2C0803.0901%2C0803.0888%2C0803.0558%2C0803.2172%2C0803.0499&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On perpetual American put valuation and first-passage in a\n  regime-switching model with jumps"}, "summary": "In this paper we consider the problem of pricing a perpetual American put\noption in an exponential regime-switching L\\'{e}vy model. For the case of the\n(dense) class of phase-type jumps and finitely many regimes we derive an\nexplicit expression for the value function. The solution of the corresponding\nfirst passage problem under a state-dependent level rests on a path\ntransformation and a new matrix Wiener-Hopf factorization result for this class\nof processes.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0803.2406%2C0803.0345%2C0803.2537%2C0803.1336%2C0803.1134%2C0803.2734%2C0803.3176%2C0803.2105%2C0803.3977%2C0803.0409%2C0803.3530%2C0803.2263%2C0803.1360%2C0803.3311%2C0803.3424%2C0803.4117%2C0803.4257%2C0803.2664%2C0803.0286%2C0803.1064%2C0803.3932%2C0803.2544%2C0803.1855%2C0803.0893%2C0803.2982%2C0803.2436%2C0803.3975%2C0803.1731%2C0803.2371%2C0803.3571%2C0803.2302%2C0803.3145%2C0803.2657%2C0803.1263%2C0803.4119%2C0803.2073%2C0803.3427%2C0803.2844%2C0803.2240%2C0803.3053%2C0803.4012%2C0803.1356%2C0803.4035%2C0803.0212%2C0803.2578%2C0803.0123%2C0803.1581%2C0803.0809%2C0803.1224%2C0803.1738%2C0803.4128%2C0803.3590%2C0803.1135%2C0803.4353%2C0803.1787%2C0803.3996%2C0803.0325%2C0803.1883%2C0803.0919%2C0803.2781%2C0803.3502%2C0803.1913%2C0803.0754%2C0803.1138%2C0803.4308%2C0803.3034%2C0803.0368%2C0803.0372%2C0803.1714%2C0803.4467%2C0803.2112%2C0803.2665%2C0803.2480%2C0803.2634%2C0803.2235%2C0803.2247%2C0803.2349%2C0803.3844%2C0803.0488%2C0803.1993%2C0803.2662%2C0803.1921%2C0803.3388%2C0803.0152%2C0803.2559%2C0803.3073%2C0803.1471%2C0803.2049%2C0803.2654%2C0803.0900%2C0803.0700%2C0803.3240%2C0803.4031%2C0803.2450%2C0803.2834%2C0803.2013%2C0803.0901%2C0803.0888%2C0803.0558%2C0803.2172%2C0803.0499&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this paper we consider the problem of pricing a perpetual American put\noption in an exponential regime-switching L\\'{e}vy model. For the case of the\n(dense) class of phase-type jumps and finitely many regimes we derive an\nexplicit expression for the value function. The solution of the corresponding\nfirst passage problem under a state-dependent level rests on a path\ntransformation and a new matrix Wiener-Hopf factorization result for this class\nof processes."}, "authors": ["Z. Jiang", "M. R. Pistorius"], "author_detail": {"name": "M. R. Pistorius"}, "author": "M. R. Pistorius", "arxiv_comment": "22 pages, 3 figures. Tp appear in Finance and Stochastics,", "links": [{"href": "http://arxiv.org/abs/0803.2302v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0803.2302v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-fin.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-fin.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "60K15, 90A09", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0803.2302v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0803.2302v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:0803.2302v1 [q-fin.PR] 15 Mar 2008\n\nOn perpetual American put valuation and first-passage\nin a regime-switching model with jumps\u2217\nZ. Jiang\u2020\n\nM. R. Pistorius\u2021\n\nIn memory of Yumin Jiang\n\nAbstract\nIn this paper we consider the problem of pricing a perpetual American\nput option in an exponential regime-switching L\u00e9vy model. For the case\nof the (dense) class of phase-type jumps and finitely many regimes we\nderive an explicit expression for the value function. The solution of the\ncorresponding first passage problem under a state-dependent level rests\non a path transformation and a new matrix Wiener-Hopf factorization\nresult for this class of processes.\nKeywords American put option * matrix Wiener-Hopf factorization *\nphase-type * regime-switching * first-passage problem\nMathematics Subject Classification (2000) 60K15 * 90A09\nJEL classification G13\n\n1\n\nIntroduction\n\nConsider a riskless bond and a stock whose price processes {Bt , t \u2265 0} and\n{St , t \u2265 0} are given by\n\u0012Z t\n\u0013\nBt = exp\nr(Zs )ds , St = exp(Xt ),\nX0 = x,\n(1)\n0\n\nwith r(*) \u2265 0 the instantaneous interest rate, Z a finite state Markov process\nand X = {Xt , t \u2265 0} a regime-switching phase-type L\u00e9vy process (that will be\nspecified below in Section 2). When Xt is a Brownian motion with drift and\n\u2217 Research supported by the Nuffield Foundation, grant NAL/00761/G, and EPSRC grant\nEP/D039053/1.\n\u2020 King's College London, Department of Mathematics, Strand, London WC2R 2LS, UK\nemail: zjunjiang@yahoo.com.cn\nPresent address: School of Finance, Nanjing University of Finance and Economics, Nanjing,\n210046, China\n\u2021 King's College London, Department of Mathematics, Strand, London WC2R 2LS, UK\nemail: martijn.pistorius@kcl.ac.uk\n\n1\n\n\fr(*) is constant, the model (1) reduces to the classical Black-Scholes model (BS).\nIt has been well documented in the literature that the BS model is not flexible\nenough to accurately replicate observed market call prices simultaneously across\ndifferent strikes and maturities.\nTo address some of the deficiencies of the BS model it was proposed to\nreplace the geometric Brownian motion by an exponential L\u00e9vy process, modelling sudden stock price movements by jumps. A substantial literature has\nbeen devoted to the study and application of L\u00e9vy models in derivative pricing;\npopular models include the infinite jump activity models, such as the NIG [6],\nCGMY [10], KoBoL [8] and hyperbolic processes [12], and the finite activity,\njump-diffusion models \u2013 see also Cont and Tankov [11] for an overview. In the\nlatter category, for instance, Kou [21] investigated the pricing of European and\nbarrier options in the case of double-exponential jumps; Asmussen et al. [4]\nconsidered perpetual American and Russian options under phase-type jumps.\nIn a parallel line of research the BS model was extended by allowing its\nparameters \u03bc, \u03c3 and r to be modulated by a finite state Markov chain Z. The\nprocess Z models (perceived) changes in economic factors and their influence on\nthe stock price. See Guo [15, 16] for background on this regime-switching model\nand further references. In the context of option pricing, Guo [14, 15] and Guo\nand Zhang [17] obtained closed form solutions of European, perpetual American\nput and lookback options for a two-state regime switching Brownian motion; For\nthe case of N states, Jobert and Rogers [18] considered the perpetual American\nput and numerically solved the finite time American put problem.\nIn the present study we consider the model (1) which combines both the important features of regime-switching and jumps, motivated by the observation\nthat L\u00e9vy models have been successfully calibrated to options with single, short\ntime maturities whereas regime-switching models fit well longer dated options.\nThe model (1) allows, at least in principle, for a flexible specification of the\njump-distribution, since the phase-type distributions are dense in the class of\nall distributions on a half-line (see [4, Prop. 1]). Under this model, we obtain explicit, analytically tractable results for the value function of a perpetual\nAmerican put and corresponding optimal exercise strategy under this model.\nGuo & Zhang [17] and Jobert & Rogers [18] have shown that the optimal stopping time takes the form of the first-passage problem of Xt under a level k(Zt )\nthat depends on the current regime Zt . We will show that the optimal stopping\ntime still takes this form in our model and subsequently solve the corresponding\nfirst-passage problem. The solution of the latter rests on a path transformation\nand new matrix Wiener-Hopf factorization results, which extend the classical\nfactorization results of London et al. [23]. The results also extend Asmussen et\nal. [4] who solved the first-passage problem across a constant level in the case\nof two regimes using methods different from ours.\nTo value a finite maturity American put under the model (1) the solution\nof the perpetual American put problem may in principle be used as building\nblock in an approximation procedure that we will briefly outline now. In the\nsetting of the BS model, Carr [9] investigated the approximation of a finite\nmaturity American put price by randomizing its maturity and showed, by nu2\n\n\fmerical experiments, fast convergence of this algorithm. The proposed maturity\nrandomization resulted in an iterative evaluation of a series of related perpetualtype American options, a procedure which was extended to the setting of jumpdiffusions by Levendorskii [22]. The idea is then to combine our solution of the\nfirst-passage problem with Carr's ideas to develop a pricing algorithm of finite\nmaturity American put options under a regime-switching L\u00e9vy model \u2013 we leave\nfurther exploration of this idea for future research.\nThe rest of the paper is organized as follows. Section 2 is devoted to the\nproblem formulation and the solution of the perpetual American put problem\nin terms of a first-passage problem. The solution to the first-passage problem\nunder a state-dependent level is developed in Sections 3-6. Finally, in Section\n7, the case of two regimes is considered in detail. Proofs that are not given in\nthe text are deferred to the Appendix.\n\n2\n2.1\n\nProblem formulation\nModel\n\nLet the bond and risky asset price processes be given as in (1) such that E[S1 ] <\n\u221e, where Z = {Zt ; t \u2265 0} is a continuous time irreducible Markov process with\nfinite state space E 0 = {1, . . . , N } and intensity-matrix G, and X = {Xt , t \u2265 0}\nis a regime-switching jump-diffusion given by\nZ t\nZ t\nXZ t\n1(Zs =i) dJi (s).\n(2)\n\u03c3(Zs )dWs +\n\u03bc(Zs )ds +\nXt = x +\n0\n\n0\n\ni\u2208E 0\n\n0\n\nHere 1B is the indicator of the set B, x \u2208 R, W = {Wt ; t \u2265 0} is a Wiener\nprocess, Ji = {Ji (t); t \u2265 0} are independent compound Poisson processes with\njumps arriving at rate \u03bbi , and \u03bc and \u03c3 are real-valued functions on E 0 with\n\u03c3(*) > 0. The stochastic processes X and Z are defined on some filtered probability space (\u03a9, F , F, P), where F = {Ft }t\u22650 denotes the completed filtration\ngenerated by (X, Z). The jump sizes of the compound Poisson processes Ji\nare assumed to be distributed according to double phase-type distributions, the\ndefinition of which we will specify below. We first briefly review the definition of a phase-type distribution. A distribution F on (0, \u221e) is said to be of\nphase-type, if it is the distribution of the absorption time of a finite state Markov\nchain with one state \u2202 absorbing and the remaining states transient. One writes\nF \u223c P H(\u03b1, T ) if this Markov chain, restricted to the transient states, has generator matrix T and initial distribution given by the (column) vector \u03b1. From\nMarkov chain theory it follows that the density of F is given by\nf (x) = \u03b1\u2032 eT x t,\n\nx > 0,\n\n(3)\n\nwhere \u2032 denotes transpose and t = (\u2212T )1, with 1 a column vector of ones, is\nthe vector of exit rates from a transient state to \u2202. The class of phase-type\ndistributions is dense (in the sense of convergence in distribution) in the class\n3\n\n\fof all probability distributions on (0, \u221e). Examples of phase-type distributions\ninclude hyper-exponential and Erlang distributions. See Neuts [24] and Asmussen [1, 2, 3] for further background on phase-type distributions and their\napplications.\nAn extension to distributions supported on R reads as follows:\nDefinition 1 A continuous distribution H on R is said to be of double phasetype with parameters p, \u03b1, T, \u03b2, U , and one writes H \u223c DP H(p, \u03b1, T, \u03b2, U ), if\nits density h is of the form\nh(x) = pf\u03b1,T (x)1(x>0) + (1 \u2212 p)f\u03b2,U (\u2212x)1(x<0) ,\n\n(4)\n\nwhere p \u2208 (0, 1) and f\u03b1,T , f\u03b2,U are P H(\u03b1, T ) and P H(\u03b2, U ) densities respectively.\n+\n\u2212\n\u2212\nFor each i \u2208 E 0 the jump size distribution Fi \u223c DHP (pi , \u03b1+\ni , Ti , \u03b1i , Ti )\nof Ji is of double phase-type. Note that the positive and negative jumps of Ji\ni\narrive at rates \u03bb+\ni := pi \u03bbi and \u03bb\u2212 := (1 \u2212 pi )\u03bbi and are distributed according\n+\n+\n\u2212\n\u2212\nto PH(\u03b1i , Ti ) and PH(\u03b1i , Ti ) distributions, respectively.\nThe market with price processes (B, S) as specified above is arbitrage-free\nas there exists an equivalent martingale measure P\u2217 . Furthermore, there exists\na P\u2217 that is structure-preserving (i.e. X is still of the form (2) but with different\nparameters) \u2013 a proof of this result is given in the Appendix. From now on we\nwill assume that X admits a representation (2) under a martingale measure P\u2217 ,\nand we will write P for P\u2217 .\n\n2.2\n\nPerpetual American put\n\nIn the market (1) we consider a perpetual American put with strike K > 0,\na contract that gives its holder the right to exercise it at any moment t and\nreceive the payment K \u2212 St . From standard theory of pricing American style\noptions in [7, 19] it follows that, if S0 = s = ex and Z0 = i, an arbitrage-free\nprice for this contract is given by\n\u0003\n\u0002\n(5)\nV \u2217 (s, i) = sup Ex,i B\u03c4\u22121 (K \u2212 eX\u03c4 )+ ,\n\u03c4 \u2208T0,\u221e\n\nwhere u+ = max{u, 0}, T0,\u221e denotes the set of F-measurable finite stopping\ntimes, and Ex,i [*] = E[*|X0 = x, Z0 = i]. An optimal stopping time in (5) reads\nas\nT (k \u2217 ) = inf {t \u2265 0 : Xt \u2264 k \u2217 (Zt )} ,\n(6)\n\nfor some function (or vector) k \u2217 : E 0 \u2192 R. This can be seen to be true as\nfollows. In view of the fact that (S, Z) is a Markov process, the general theory\nof optimal stopping in Shiryaev [27] implies that an optimal stopping time \u03c4 \u2217\nin (5) is given by\n\u03c4 \u2217 = inf{t \u2265 0 : V \u2217 (St , Zt ) \u2264 (K \u2212 St )+ }.\n4\n\n\fThat \u03c4 \u2217 is of the form (6) is a consequence of the fact that V \u2217 (s, i) is a positive,\nconvex and decreasing function that dominates (K \u2212 s)+ with V \u2217 (0, i) = K.\nThe latter follows in turn by the definition of V \u2217 and by observing that s 7\u2192\n(K \u2212 seX\u03c4 \u2212X0 )+ is convex and decreasing, and that subsequently taking the\nexpectation and the supremum over the stopping times \u03c4 \u2208 T0,\u221e preserves\nthese properties.\nThe next result presents the solution to the valuation problem of the perpetual American put in the market (1):\nTheorem 1 The value function in (5) is given by V \u2217 (s, i) = Vk\u2217 (s, i) where\nVk (s, i) = Kv0,k (x, i) \u2212 v1,k (x, i),\nwith\n\ni \u2208 E 0 , s = ex ,\n\n(7)\n\ni\nh\nvb,k (x, i) = Ex,i BT\u22121(k) ebXT (k) .\n\n\u2217\nAn optimal stopping time in (5) is given by (6) where k \u2217 = (k1\u2217 , . . . , kN\n) satisfies\n\u2217\n\nlim\u2217 Vk\u2032\u2217 (ex , j) = \u2212ekj\n\nx\u2193kj\n\n2.3\n\nj \u2208 E0.\n\n(8)\n\nFirst passage\n\nTo solve the American put problem we will consider the first-passage problem\nof Xt under the level k(Zt ), with k : E 0 \u2192 R, which amounts to finding the\nfunction\n\u0003\n\u0002\n(9)\nvb,k (x, i) = Ex,i e\u2212RT +bXT h0 (ZT ) ,\nRT\nwhere RT = 0 a(Zs )ds, a, h0 : E 0 \u2192 R+ , and\nT = T (k) = inf {t \u2265 0 : Xt \u2264 k (Zt )} .\n\n(10)\n\nFollowing [3, 4], the first step in the solution of (9) is to reformulate this problem\nas a first-hitting time problem for a related continuous Markov additive process\nA, called the fluid embedding of X. Informally, a path of A is constructed from\na path of X by replacing the jumps of X by linear stretches \u2013 see Figure 1. An\nexplicit construction is given in Section 3.\nA classical approach [20, 23] to solving the resulting first-hitting time problem rests on a characterization of the laws of corresponding up- and downcrossing ladder processes \u2013 see Figure 2. London et al. [23] developed matrix\nWiener-Hopf factorization results for fluctuating additive processes (see also\nRogers [26] for elegant martingale proofs and Brownian perturbations). By extending the results of [23, 26] to our setting, we solve the matrix Wiener-Hopf\nfactorization problem for the embedding A, in Section 4.\nTo deal with the different ways in which first-passage in (9) can occur (see\nFigure 3), the Wiener-Hopf factorization is employed in Section 5 to calculate\nthe distribution of the process A at the first moment of leaving a finite interval\nor a regime-switch, whichever occurs first. In Section 6 the solution to (9) is\nderived by combining the foregoing results.\n5\n\n\f0\n\nT\u2212\n\nk\n\nA\u03c4 \u2212\nXT \u2212\n\nFigure 1: Shown is a sample path of X until the first time T \u2212 that X enters\n(\u2212\u221e, k). The process A has no positive jumps and always hits a level at firstpassage.\n\n3\n\nFluid Embedding\n\nLet Y be an irreducible continuous time Markov chain with finite state space\nE \u222a \u2202, where \u2202 is an absorbing cemetery state, and denote by A = {At , t \u2265 0}\nthe stochastic process given by\nZ t\nZ t\nAt = A0 +\ns(Ys )dWs +\nm(Ys )ds,\n(11)\n0\n\n0\n\nwhere s and m are functions from E \u222a \u2202 to R with s(\u2202) = m(\u2202) = 0. The\nprocess A is the fluid-embedding of X if the generator of Y restricted to E is\nequal to Q0 where, in block notation,\n\uf8eb +\n\uf8f6\nT\nt+\nO\nQa = \uf8ed B + G \u2212 Da B \u2212 \uf8f8 .\n(12)\nO\nt\u2212\nT\u2212\n\nHere Da is an N \u00d7 N diagonal matrix with (Da )ii = \u03bbi + ai , O are zero matrices\nof appropriate sizes and, again in block-notation,\n\uf8f6\n\uf8f6\n\uf8eb \u00b1 \u00b1\u2032\n\uf8eb \u00b1\n\uf8eb \u00b1\n\u03bb1 \u03b11\nT1\nt1\n\uf8f7\n\uf8f7\n\uf8ec\n\uf8ec\n\uf8ec\n\u00b1\n\u00b1\n\u00b1\n.\n.\n..\n..\nB =\uf8ed\nT =\uf8ed\nt =\uf8ed\n\uf8f8,\n\uf8f8,\n\u00b1 \u00b1\u2032\n\u00b1\n\u03bbN \u03b1N\nTN\n6\n\n..\n\n.\nt\u00b1\nN\n\n\uf8f6\n\n\uf8f7\n\uf8f8.\n\n\fAt\n\n111111\n000\n111\n0\n0\n1\n00000\n000\n111\n0\n1\n0\n1\n00000\n11111\n00000\n11111\n00000\n11111\n\nYeu+\n\n11111\n00000\n00000\n11111\n00000\n11111\n00000\n11111\n00000\n11111\n00000\n11111\n00000\n11111\n00000\n11111\n00000\n11111\n00000\n11111\n\n111\n000\n000\n111\n000\n111\n11\n00\n000000\n111111\n1010 111111111111\n000000000000\n1111\n0000\n00\n11\n000\n111\n000000\n111111\n00000\n11111\n00\n11\n000000000000\n000000000000\n111111111111\n00111111111111\n11\n000\n111\n000000\n111111\n00000\n11111\n00\n000000000000\n111111111111\n1111\n0000\n000000000000111\n111111111111\n000\n0000011\n11111\n00\n11\nYt\n\nFigure 2: Pictured is a stylized sample path of the process A. The dashed\nvertical lines denote the jump times of Y . The horizontal dotted lines indicate\nthe jump times of the associated Markov process Ye + .\n\nFrom the form of Qa it follows that E can be partitioned as E = E + \u222a E 0 \u222a E \u2212\nwhere E 0 is the state-space inherited from Z and E + and E \u2212 are the states\nin which the path of A is linear with slope +1 or \u22121 which originate from\nthe positive and negative jumps of X, respectively. Similarly, we will write\nEi = Ei+ \u222a {i} \u222a Ei\u2212 for the subset of E corresponding to the ith regime of X\nwith corresponding embedded positive and negative jumps. The functions m(*)\nand s(*) are then specified as follows:\n\uf8f1\n(\n\uf8f4\nif j \u2208 E +\n\uf8f21\n\u03c3j if j \u2208 E 0\ns(j) =\nm(j) = \u03bcj if j \u2208 E 0 .\n\uf8f4\n0 otherwise\n\uf8f3\n\u22121 if j \u2208 E \u2212\n\n3.1\n\nPath transformation\n\nIn Figure 1 it is illustrated how a path of A can be transformed to obtain a path\nof X. More formally, denoting by\nZ t\nT0 (t) =\n1(Ys \u2208E 0 ) ds\nand\nT0\u22121 (u) = inf{t \u2265 0 : T0 (t) > u},\n0\n\n7\n\n\fthe time before t spent by Y in E 0 and its right-continuous inverse, respectively,\nit is not hard to verify that\n(A \u25e6 T0\u22121 , Y \u25e6 T0\u22121 ) is in law equal to\n\n(X, Z).\n\nThis implies in particular that the triplets (T0 (T\u0303 ), AT\u0303 , YT\u0303 ) and (T, XT , ZT ) have\nthe same distribution, where\nn\no\nT\u0303 = T\u0303 (k) = inf t \u2265 0 : Yt \u2208 E 0 and At \u2264 k\u0303(Yt )\n\nwith k\u0303 : E \u2192 R given by k\u0303(j) = k(i) for j \u2208 Ei . It is not hard to verify that\nstate-dependent discounting (or 'killing') at rate a(i) when Yt = i \u2208 E 0 can be\nincluded by replacing Q0 by the generator Qa for the vector a = (a(i), i \u2208 E 0 ).\nThus, it holds that\ni\nh\n(13)\nvb,k (x, i) = Ex,i ebAT\u0303 h (YT\u0303 ) 1(T\u0303 <\u03b6 ) ,\nwith Y now evolving according to the generator Qa and Ei,x [*] = E[*|Y0 =\ni, A0 = x]. Here,\n\u03b6 = inf{t \u2265 0 : Yt \u2208\n/ E}\n(14)\n\nwith inf \u2205 = \u221e, and h : E \u2192 R is given by h(j) = h0 (i) for j \u2208 Ei .\n\n4\n\nMatrix Wiener-Hopf factorization\n\nThe solution of the first-passage problem of the Markov process (A, Y ) across\na constant level is closely linked to the up-crossing and down-crossing ladder\nprocesses Ye + , Ye \u2212 of (A, Y ). These processes are defined as time changes of Y\nthat are constructed such that Y is observed only when A is at its maximum\nand at its minimum respectively, that is,\n\u0001\n\u0001\n(15)\nand\nYet\u2212 = Y \u03c4t\u2212 ,\nYet+ = Y \u03c4t+\nwhere\n\n\u03c4t+ = inf{s \u2265 0 : As > t}\n\nand\n\n\u03c4t\u2212 = inf{s \u2265 0 : As < t}.\n\nIt is easily verified that the ladder processes Ye + and Ye \u2212 are again Markov processes with state spaces E 0 \u222aE + and E 0 \u222aE \u2212 , respectively. We will characterize\n\u2212\ne + and Ye \u2212 along with the initial distributions\nthe generators Q+\na and Qa of Y\n+\n\u03b7 , defined by\nh\ni\nfor i \u2208 E \u2212 , j \u2208 E + \u222a E 0\n(16)\n\u03b7 + (i, j) = P0,i Ye0+ = j, \u03c40+ < \u03b6\nh\ni\nfor i \u2208 E + , j \u2208 E \u2212 \u222a E 0\n(17)\n\u03b7 \u2212 (i, j) = P0,i Ye0\u2212 = j, \u03c40\u2212 < \u03b6\n\nDenote by Q(n) the set of irreducible n \u00d7 n generator matrices (matrices with\nnon-negative off-diagonal elements and non-positive row sums) and write P(n, m)\n8\n\n\ffor the set of n \u00d7 m matrices whose rows are sub-probability vectors. Let V and\n\u03a3 denote the |E| \u00d7 |E| diagonal matrices given by diag(m(i)) and diag(s(i)),\nrespectively. The matrix Qa is called recurrent if its rows sum up to zero; otherwise it is called transient. By considering the process A at the subsequent times\nit visits a certain state, r \u2208 E say, and noting that this defines a random walk,\nwe have that in the recurrent case either supt\u22650 At = \u221e or limt\u2192\u221e At = \u2212\u221e,\nP0,i -a.s.\nWrite N, N + and N \u2212 for the number of elements of E 0 , E + and E \u2212 , respectively and let N0+ = N + N + and N0\u2212 = N + N \u2212 . We then define the\nWiener-Hopf factorization of (A, Y ) as follows:\nDefinition 2 Let G+ , C + , G\u2212 and C \u2212 be elements of the sets Q(N0+ ), P(N \u2212 , N0+ ),\nQ(N0\u2212 ) and P(N + , N0\u2212 ), respectively. A quadruple (C + , G+ , C \u2212 , G\u2212 ) is called\na Wiener-Hopf factorization of (A, Y ) if\n\u0001\n\u0001\n(18)\nand\n\u039e G\u2212 , W \u2212 = O,\n\u039e \u2212G+ , W + = O\nwhere, for matrices W with |E| rows,\n\u039e(S, W ) =\n\n1 2\n\u03a3 W S 2 + V W S + Qa W\n2\n\nand W + and W \u2212 are given in obvious block notation by\n\uf8f6\n\uf8eb +\n\uf8eb\n\uf8f6\nI\nO\nC\u2212\nW + = \uf8ed O I0 \uf8f8\nand\nW \u2212 = \uf8ed I0 O \uf8f8 ,\n+\nC\nO I\u2212\n\n(19)\n\n(20)\n\nwhere I0 , I + and I \u2212 are identity matrices of sizes N \u00d7 N , N + \u00d7 N + and\nN \u2212 \u00d7 N \u2212 , respectively, and O denotes a zero matrix of the appropriate size.\nIn the following result the Wiener-Hopf factorization of (A, Y ) is identified:\nTheorem 2 (i) The quadruple (\u03b7 + , Q+ , \u03b7 \u2212 , Q\u2212 ) is a Wiener-Hopf factorization of (A, Y ).\n(ii) The Wiener-Hopf factorization (\u03b7 + , Q+ , \u03b7 \u2212 , Q\u2212 ) is unique if Q is transient or if Q is recurrent and A oscillates (that is, supt At = \u2212 inf t At = \u221e).\n(iii) If Q is recurrent and limt\u2192\u221e At = \u2212\u221e, there are precisely two WienerHopf factorizations of (A, Y ) given by (\u03b7 + , Q+ , \u03b7 \u2212 , Q\u2212 ) and\n\u0001\n\u03b7 + (I \u2212 1\u03bc) + \u03bc, Q+ (I \u2212 1\u03bc), \u03b7 \u2212 , Q\u2212 ,\nwhere \u03bc is the left eigenvector of Q+ corresponding to its largest eigenvalue,\nnormalized such that \u03bc1 = 1, where 1 denotes a column vector of ones.\nProof: For l \u2208 R let \u03a6\u00b1\nl be given by the matrices\n\u0001\n\u0001\n+\n+\n\u2212\n\u2212\n\u03a6+\nand \u03a6\u2212\nl (x) = W exp Q (l \u2212 x)\nl (x) = W exp Q (x \u2212 l) ,\n9\n\n(21)\n\n\fwhere W + and W \u2212 are given by (20) with C + = \u03b7 + and with C \u2212 = \u03b7 \u2212 . The\nproof rests on the martingale property of\n\u0010\n\u0011\n\u0010\n\u0011\nMt+ = f+ Yt\u2227\u03c4 + , At\u2227\u03c4 +\nand Mt\u2212 = f\u2212 Yt\u2227\u03c4 \u2212 , At\u2227\u03c4 \u2212\n(22)\nl\n\nwith\n\nl\n\nf+ (i, x) = e\u2032i \u03a6+\nl (x)h+\n\nl\n\nand f\u2212 (i, x) = e\u2032i \u03a6\u2212\nl (x)h\u2212 ,\n\nl\n\n(23)\n\nwhere h+ and h\u2212 are N0+ \u2212 and N0\u2212 \u2212 column vectors, respectively. Here, and\nin the sequel, ei denotes a (column) vector of appropriate size with element\nei (j) = 1 if j = i and zero otherwise. To verify that M + is a martingale,\nobserve first that, since Ye + is a Markov process with generator Q+ = Q+\na and\ninitial distribution \u03b7 + defined by (16), Markov chain theory implies that for\nx\u2264l\nh \u0010 \u0011\ni\n(24)\nEx,i h Yel+ 1(\u03c4 + <\u03b6 ) = e\u2032i \u03a6+\nl (x)h.\nl\n\n+\n\nThe martingale property of M then follows from (23) \u2013 (24) as a consequence\nof the Markov property of (A, Y ). An application of It\u00f4's lemma shows that\nf = (f+ (i, u), i \u2208 E) satisfies for u \u2264 l\nX\n2 \u2032\u2032\n\u2032\n1\nqij (f (j, u) \u2212 f (i, u)) = 0,\n(25)\ns(i)\nf\n(i,\nu)\n+\nm(i)f\n(i,\nu)\n+\n2\nj\n\nwhere f \u2032 and f \u2032\u2032 denote the first and second derivatives of f with respect to u.\nBy substituting the expressions (21) \u2013 (23) into equation (25) we find, since h\nwas arbitrary, that Q+ and \u03b7 + satisfy the first set of equations of the system\n(18). The proof for Q\u2212 and \u03b7 \u2212 is analogous and omitted. The proofs of Theorem\n2 (ii), (iii) are deferred to the Appendix.\n\u0003\nExample (Gerber-Shiu penalty function) Let Xt in (2) with x > 0 be the\nsurplus of an insurance company. Note that, for \u03c3 = 0, N = 1, and in the\nabsence of positive jumps, (2) reduces to the classical Cram\u00e9r-Lundberg model.\nDenote by \u03c1 = inf{t \u2265 0 : Xt < 0} the ruin time of X. Quantities of interest in\nthis setting include the ruin probability Px,i (\u03c1 < \u221e) and the Gerber-Shiu [13]\nexpected discounted penalty function which quantifies the severity of ruin by\nmeasuring the shortfall X\u03c1 of X at the ruin time \u03c1. Under the model (2) both\nthese quantities can be expressed in terms of the functions \u03a6\u00b1\nl defined in (23).\nFor instance, the probability of ruin in regime l \u2208 E 0 is given by\nPx,i (\u03c1 < \u221e, Z\u03c1 = l) = e\u2032i \u03a6\u2212\n0 (x)fl ,\n\u2212\n\u2212\nwhere fl (j) = 1 if j \u2208 El and zero else and \u03a6\u2212\n0 is given by (21) with Q = Q0 .\n0\nMore generally, for any non-negative function \u03c0 on [0, \u221e) \u00d7 E the Gerber-Shiu\nexpected discounted penalty function reads as\n\u0003\n\u0002\nEx,i e\u2212R\u03c1 \u03c0(X\u03c1 , Z\u03c1 ) = e\u2032i \u03a6\u2212\n0 (x)\u1e21,\n\n10\n\n\fR\u03c1\n\u2212\nwhere R\u03c1 = 0 a(Zs )ds, \u03a6\u2212\n= Q\u2212\na , and \u1e21 is the\n0 is given by (21) with Q\n\u2212\nN -vector with elements\n\uf8f1\n\uf8f2\u03c0(0, l)\nfor l \u2208 E 0\nZ \u221e\n\u1e21(l) =\n\u2212\n.\n\u2212\n\uf8f3\n\u03c0(\u2212s, m)e\u2032l esTm t\u2212\nm ds for l \u2208 Em\n0\n\n5\n\nFirst exit from a finite interval\n\nThe two-sided exit problem of A from the interval [k, l] for \u2212\u221e < k < l < +\u221e\nis to find the distribution of the position of (A\u03c4 , Y\u03c4 ) at the first-exit time\n\u03c4 = \u03c4k,l = inf{t \u2265 0 : At \u2208\n/ [k, l]}.\nBy considering appropriate linear combinations of the martingales M + and M \u2212\ndefined in (22) we will now show that the two-sided exit problem can be solved\nexplicitly in terms of (\u03b7 + , Q+ , \u03b7 \u2212 , Q\u2212 ). To this end, introduce\n\u0012\n\u0013\n\u0012\n\u0013\n\u2212\nO I0\n\u03b7\u2212\nQ+ (l\u2212k)\n\u2212\nZ+ =\ne\n,\nZ\n=\neQ (l\u2212k) ,\n\u03b7+\nI0 O\nand define the matrices\n\u0010\n\u0011\n\u0001\u22121\n+\n\u2212\n\u03a8+ (x) =\nW + eQ (l\u2212x) \u2212 W \u2212 eQ (x\u2212k) Z + I \u2212 Z \u2212 Z +\n,\n\u0011\n\u0010\n\u0001\n\u2212\n+\n\u22121\n,\n\u03a8\u2212 (x) =\nW \u2212 eQ (x\u2212k) \u2212 W + eQ (l\u2212x) Z \u2212 I \u2212 Z + Z \u2212\n\u0001\n\u03a8\u25e6 (s, x) = esx I \u2212 esl \u03a8+ (x)J + \u2212 esk \u03a8\u2212 (x)J \u2212 [\u2212K(s)]\u22121 ,\n\n(26)\n(27)\n(28)\n\nwhere I is an identity matrix, W \u00b1 are given in (20) with C + = \u03b7 + and C \u2212 = \u03b7 \u2212 ,\nJ \u00b1 is the transpose of (20) with C \u00b1 replaced by zero matrices, and\nK(s) =\n\n1 2 2\n\u03a3 s + V s + Qa .\n2\n\n(29)\n\n\u2212\n\u25e6\nWe will write \u03a8+\nk,l /\u03a8k,l /\u03a8k,l if we wish to clarify their dependence on k and l.\nThe complete solution of the two-sided exit problem reads as follows:\n\nProposition 1 Let h+ , h\u2212 and h\u2020 be functions that map E 0 \u222a E + , E 0 \u222a E \u2212\nand E to R. If\ns(i)2 b2 + m(i)b < \u2212qii\nthen it holds for x \u2208 [k, l] and i \u2208 E that\n\u0002\n\u0003\nEx,i h+ (Y\u03c4 ) 1(A\u03c4 =l,\u03c4 <\u03b6)\n\u0002\n\u0003\nEx,i h\u2212 (Y\u03c4 ) 1(A\u03c4 =k,\u03c4 <\u03b6)\n\u0002\n\u0003\nEx,i ebA\u03b6\u2212 h\u2020 (Y\u03b6\u2212 ) 1(\u03b6<\u03c4 )\n\nfor all i \u2208 E,\n\n(30)\n\n= e\u2032i \u03a8+ (x)h+ ,\n\n(31)\n\n=\n=\n\ne\u2032i \u03a8\u2212 (x)h\u2212 ,\ne\u2032i \u03a8\u25e6 (b, x)\u2206h\u2020 qa ,\n\n(32)\n(33)\n\nwhere qa = (\u2212Qa )1, \u03b6 is defined by (14) and \u2206h\u2020 is the diagonal matrix with\nelements h\u2020 (j).\n11\n\n\fProof: Define g+ and g\u2212 by the right-hand sides of (31) and (32) respectively.\nIt is straightforward to verify from (26) \u2013 (27) that it holds that\n(\nh+ (i) if x = l, i \u2208 E + \u222a E 0\ng+ (i, x) =\n,\n0\nif x = k, i \u2208 E \u2212 \u222a E 0\n(\n0\nif x = l, i \u2208 E + \u222a E 0\ng\u2212 (i, x) =\n.\n\u2212\nh (i) if x = k, i \u2208 E \u2212 \u222a E 0\nIn view of these boundary conditions and the fact that any linear combination\nof M + and M \u2212 , defined in (22), is a bounded martingale, Doob's optional\nstopping theorem gives that\n\u0002\n\u0003\ng+ (i, x) = Ex,i g+ (Y\u03c4 , A\u03c4 )1(\u03c4 <\u03b6)\n\u0002\n\u0003\n= Ex,i h+ (Y\u03c4 )1(A\u03c4 =l,\u03c4 <\u03b6) ,\n\nwhere \u03c4 = \u03c4k,l . Similarly, it follows that\n\u0002\n\u0003\ng\u2212 (i, x) = Ex,i h\u2212 (Y\u03c4 )1(A\u03c4 =k,\u03c4 <\u03b6) .\n\nTo prove the third identity, consider the map h\u2217 : E \u2192 R given by\n\u0002\n\u0003\nh\u2217 (i) = E0,i esA\u03b6\u2212 h\u2020 (Y\u03b6\u2212 ) .\n\nBy conditioning on the first jump epoch \u03be of Y it is straightforward to verify\nthat\nP\nh\u2020 (i)qi\u2202 + j6=i qij h\u2217 (j)\n\u2217\n,\nh (i) = \u2212\ns(i)2 s2 /2 + m(i)s + qii\nwhere qij [qi\u2202 ] denotes the intensity of a transition i \u2192 j [i \u2192 \u2202]. After reordering and writing the above expression in matrix form, it follows that\nK(s)h\u2217 = \u2206h\u2020 Qa 1,\nso that, for s satisfying s(i)2 s2 + m(i)s < \u2212qii , i \u2208 E,\nh\u2217 = [\u2212K(s)]\u22121 \u2206h\u2020 (\u2212Qa )1.\n\n(34)\n\nIn view of the strong Markov property and (31) \u2013 (32), it follows that\n\u0002\n\u0003\n\u0002\n\u0003\n\u0002\n\u0003\nEx,i esA\u03b6\u2212 1(\u03b6<\u03c4 ) = Ex,i esA\u03b6\u2212 \u2212 Ex,i esA\u03b6\u2212 1(\u03b6>\u03c4 )\n\u0003\n\u0002\n= esx h\u2217 (i) \u2212 Ex,i esA\u03c4 1(\u03c4 <\u03b6) h\u2217 (Y\u03c4 )\n\n\u0001\n= e\u2032i esx h\u2217 \u2212 esk \u03a8\u2212 (x)J \u2212 h\u2217 \u2212 esl \u03a8+ (x)J + h\u2217 . (35)\n\nInserting (34) into (35) finishes the proof of (33).\n\n12\n\n\u0003\n\n\fk1\nk2\n\n(a)\n\n(b)\n\n(c)\n\nFigure 3: First-passage under the state-dependent level (k2 , k1 ) takes place while\nY \u2208 E 0 and can take place in two ways: A hits the level ki while Y = i, i = 1, 2\n(illustrated in (a) and (b)) or by a jump of Y (illustrated in (a), (b) and (c)).\nThe different line styles of the paths of A correspond to the different states of\nY.\n\n6\n\nFirst-passage under state-dependent levels\n\nBy combining the ingredients from the previous sections the first-passage function vk,b (x, i) of At under the level k(Yt )\ni\n\u0011\n\u0010\nh\n(36)\nvb,k (x, i) = Ex,i ebAT\u0303 (k) h YT\u0303 (k) 1(T\u0303 (k)<\u03b6 ) ,\nwith h : E \u2192 R+ and\n\nn\no\nT\u0303 (k) = inf t \u2265 0 : Yt \u2208 E 0 and At \u2264 k\u0303(Yt )\n\ncan be explicitly expressed in terms of the matrix Wiener-Hopf factorization\nfound in Theorem 2. For simplicity we will assume that the levels are ordered\nas k1 > k2 > . . . > kN (the general case of possibly equal levels follows by a\nsimilar reasoning). As the first-passage over k can only occur when Y is in E 0 ,\nit follows that Y can cross the boundary k before A exits the interval [kj , kj\u22121 ]\nin two ways: either Y jumps into a state {1, . . . , j \u2212 1} or A hits the level kj\nwhile Y is in state j \u2013 see Figure 3. We are thus led to considering the processes\nY (j) = Y\n\nej\nE\n\n,\n\nej := E\\ \u222aj\u22121 Ei\nwhere E\ni=1\n\n(with Y (1) = Y ). Clearly, the Y (j) are themselves Markov processes with generators Q(j) given by the corresponding restrictions of Qa ; in block notation the\nresulting partitions read as\n\u0012\n\u0013\nR(j)\nQa =\n,\nj = 2, . . . , N,\nq (j) Q(j)\n13\n\n\ffor some matrix R(j) , where q (j) is the matrix of exit rates from the sub-space\nej . By the strong Markov property, Proposition 1 and Theorem 2, the value\nE\nof vb,k (x, i) can be expressed in terms of the unknowns vb,k (kj , i). For these\nunknowns a system of equations can be derived by invoking smoothness and\ncontinuity properties of vb,k above the barrier k.\nMore specifically, denote, for some constants Cj (l), Dj (l), the vectors h\u2212\nj\nej \u2192 R by\nand h+\n:\nE\nj\n(\nCj\u22121 (l) if l \u2208 E 0 \\{1, . . . , j \u2212 1}\nh+\n,\n(j = 2, . . . , N ), (37)\nj (l) =\nDj\u22121 (l) else\n\uf8f1\nbkj\n\uf8f4\n\uf8f2e h(j) if l = j\n(j = 1, . . . , N ),\n(38)\nh\u2212\nCj (l)\nif l \u2208 E 0 \\{1, . . . , j} ,\nj (l) =\n\uf8f4\n\uf8f3\nDj (l)\nelse\n\nrespectively, and set\n\nej ).\nh\u2020j = (h(l), l \u2208 E\n\n\u2212\n+\n\u2212\n\u25e6\nWe shall write \u03a8+\nj , \u03a8j and \u03a8j as shorthand for \u03a8(kj ,kj\u22121 ) , \u03a8(kj ,kj\u22121 ) and\n\u03a8\u25e6(kj ,kj\u22121 ) , respectively, and denote by f (x+) and f (x\u2212) the right- and leftlimits of the function f at x. Then the following characterization of v holds\ntrue:\n\nTheorem 3 Assume that s(i)2 b2 /2 + m(i)b < \u2212qii for all i \u2208 E. The function\nvb,k is given by\n\uf8f1\n\uf8f4\ne\u2032i \u03a6\u2212 (x)h\u2212\nif x > k1 ,\n\uf8f4\n1 ,\n\uf8f4\n\uf8f4\n\uf8f2\ni\nh\nvb,k (x, i) =\n+\n+\n\u2212\n\u2212\n\u25e6\n(j)\n\u2032\n\uf8f4\n, if j = 2, . . . , N,\n\u03a8\n(x)h\n+\n\u03a8\n(x)h\n+\n\u03a8\n(b,\nx)\u2206\n\u2020\nq\ne\n\uf8f4\nj\nj\nj\nj\nhj\n\uf8f4 i j\n\uf8f4\n\uf8f3\nkj < x \u2264 kj\u22121 ,\n(39)\n+\n\u2212\nwhere \u03a6\u2212 = \u03a6\u2212\nk1 is given by (23) and hj , hj are specified by (37) \u2013 (38) with\nCj (l) and Dj (l) satisfying the following system of equations:\n\u2032\nvb,k\n(kj +, l) =\n\n\u2032\nvb,k\n(kj \u2212, l),\n\nvb,k (kj +, l) =\n\u0001\nDj (l), l \u2208 Ej\u2212\n=\n\nvb,k (kj \u2212, l),\n\nwhere j = 1, . . . , N \u2212 1, and\n\n7\n\n\u2032\n\n\u0001\n\u2212 \u22121\n\nebkj bI \u2212 Tj\n\nl \u2208 E 0 \\{1, . . . , j},\n\u000f\u0002\n\u0003\nej E 0 \u222a E \u2212 ,\nl\u2208E\nj\nt\u2212\nj h(j),\n\n(40)\n(41)\n(42)\n\ndenotes differentiation with respect to x.\n\nExample: two regimes\n\nTo illustrate the results derived in previous sections we consider next the model\n(2) in the case of two regimes. Suppose that Z is a Markov chain with state\n14\n\n\fspace E 0 = {1, 2} and transition matrix\n\u0012\n\u2212q1\nG=\nq2\n\nq1\n\u2212q2\n\n\u0013\n\nand that X evolves as a Brownian motion with drift \u03bc1 t + \u03c31 Wt when Z is in\nstate 1 and as the jump-diffusion \u03bc2 t + \u03c32 Wt \u2212 Jt when Z is in state 2, with J\na compound Poisson process with intensity rate \u03bb and exponential jumps with\nmean 1/\u03b1. Then the embedding of (X, Z) has state space E = {1, 2, 2\u22c6}, say,\nwith corresponding transition matrix\n\uf8eb\n\uf8f6\n\u2212q1 \u2212 r1\nq1\n0\n\u2212q2 \u2212 r2 \u2212 \u03bb \u03bb \uf8f8 .\nQr = \uf8ed q2\n(43)\n0\n\u03b1\n\u2212\u03b1\n\nWe will consider the stopping time T (k1\u2217 , k2\u2217 ) for the three different configurations of the optimal levels: k1\u2217 < k2\u2217 , k1\u2217 = k2\u2217 and k1\u2217 > k2\u2217 . For x > max{k1\u2217 , k2\u2217 },\nthe value function of the put is determined by the generator matrix Q\u2212\nr of the\ncorresponding down-crossing ladder process, which we determine by invoking the\nmatrix Wiener-Hopf factorization results from Section 4. Noting that E + = \u2205\nand E \u2212 = {2\u22c6 }, it follows that Q\u2212 = Q\u2212\nr satisfies\n1 2 \u2212 2\n\u03a3 (Q ) + V Q\u2212 + Qr = O,\n2\nwhere\n\n\uf8eb\n\n\u03c31\n\u03a3=\uf8ed0\n0\n\n\uf8f6\n0\n0\uf8f8 ,\n0\n\n\u03bc1\nV =\uf8ed0\n0\n\nK(\u03b8) =\n\n1 2 2\n\u03a3 \u03b8 + V \u03b8 + Qr\n2\n\n0\n\u03c32\n0\n\n\uf8eb\n\n(44)\n0\n\u03bc2\n0\n\n\uf8f6\n0\n0 \uf8f8.\n\u22121\n\nDenoting by \u03b2[\u03b8] a right-eigenvector of Q\u2212\nr corresponding to eigenvalue \u03b8 it\nfollows by right-multiplying (44) with \u03b2[\u03b8] that the matrix\n\nis singular and K(\u03b8)\u03b2[\u03b8] = 0. It is a matter of algebra to verify that \u03b8 satisfies\ng(\u03b8) = 0 where\ng(\u03b8) = F1 (\u03b8) ((\u03b1 + \u03b8)F2 (\u03b8) \u2212 \u03bb\u03b8) \u2212 q1 q2 (\u03b1 + \u03b8),\n\n(45)\n\nwith\n\n1 2 2\n\u03c3 \u03b8 + \u03bcj \u03b8 \u2212 qj \u2212 rj , j = 1, 2.\n2 j\nThe following result lists the properties of the roots of g(\u03b8) = 0:\nFj (\u03b8) =\n\n(46)\n\nLemma 1 Suppose that r1 , r2 > 0. Then g(\u03b8) has five different real roots which\nsatisfy the distribution characteristics \u03b81 < \u03b82 < \u03b83 < 0 < \u03b84 < \u03b85 . As a\nconsequence, Q\u2212 = Q\u2212\nr has three distinct eigenvalues \u03b81 , \u03b82 and \u03b83 .\n\n15\n\n\fSince the eigenvectors \u03b2[\u03b8i ] corresponding to the different eigenvalues \u03b8i , i =\n1, 2, 3, are linearly independent, the matrix Q\u2212 explicitly reads as\nQ\u2212 = \u03b81 \u03b2[\u03b81 ] \u03b82 \u03b2[\u03b82 ] \u03b83 \u03b2[\u03b83 ]\n1. Case k = k1\u2217 = k2\u2217 .\nput reads as\n\u2212\n\nW (ex , i) = e\u2032i eQ\n\n(x\u2212k)\n\n\u0001\n\n\u03b2[\u03b81 ] \u03b2[\u03b82 ] \u03b2[\u03b83 ]\n\n\u0001\u22121\n\n.\n\n(47)\n\nFor x > k, the value function of the American\n\uf8eb\n\n\uf8f6\nK \u2212 ek\nH(k) = \uf8ed K \u2212 ek \uf8f8 ,\n\u03b1\nK \u2212 ek \u03b1+1\n\nH(k) with\n\nwhere Q\u2212 is given in (47) and k solves\n\u2212ek = e\u2032i Q\u2212 H(k)\n\ni = 1, 2.\n\n2. Case k2\u2217 > k1\u2217 .\nTo deal with the case that k1\u2217 < x < k2\u2217 and Z = 1,\nwe note that, if the process Z is restricted to state 1, X is equal to a Brownian\nmotion with drift, \u03bc1 t + \u03c31 Wt , killed at rate q1 + r1 . The generator matrices\nof this restriction of Z and the corresponding ladder processes, denoted by\nQ\u0304, \u2212Q\u0304+ , Q\u0304\u2212 , reduce in this case to scalars, given by\nQ\u0304 = \u2212q1 \u2212 r1\nand the positive and negative root of the equation\n1 2 2\n\u03c3 x + \u03bc1 x \u2212 q1 \u2212 r1 = 0.\n2 1\nThe associated two-sided exit probabilities from the interval [k1\u2217 , k2\u2217 ] are\n\u2212\n\n\u03a8\u2212\n1 (x)\n\n=\n\n\u03a8+\n1 (x)\n\n=\n\neQ\u0304\n\n(x\u2212k)\n\n1\u2212\n+\n\neQ\u0304\n\n(l\u2212x) Q\u0304\u2212 (l\u2212k)\n\ne\n\neQ\u0304+ (l\u2212k) eQ\u0304\u2212 (l\u2212k)\n\n(l\u2212x)\n\n1\u2212\n\n+\n\n\u2212 eQ\u0304\n\n\u2212\n\n\u2212 eQ\u0304\n\n,\n\n(x\u2212k) Q\u0304+ (l\u2212k)\n\ne\n\neQ\u0304\u2212 (l\u2212k) eQ\u0304+ (l\u2212k)\n\n,\n\nwith k = k1\u2217 and l = k2\u2217 . Putting everything together shows that the value\nfunction of the American put in this case is given by\n\uf8f1\n\u2032 Q\u2212 (x\u2212k2\u2217 )\n\uf8f4\nH\u0304(k2\u2217 ),\nx \u2265 k2\u2217 , i = 1, 2,\n\uf8f2e i e\nW (ex , i) =\n\uf8f4\n\uf8f3 +\n\u2212\n+ \u2217\n\u2212 \u2217\n\u2217\n\u2217\nH (x) + \u03a8+\n1 (x)[C \u2212 H (k2 )] + \u03a81 (x)H (k1 ), k1 < x \u2264 k2 , i = 1,\n\nwhere\n\n\uf8f6\nC\nH\u0304(k) = \uf8ed K \u2212 ek \uf8f8 ,\n\u03b1\nK \u2212 ek \u03b1+1\n\uf8eb\n\nH \u2212 (k) = ek\n\n16\n\nr1\n,\nq1\n\nH + (x) = K \u2212 ex\n\nq1 + r1\n,\nq1\n\n\fusing equation (A.3). Here C is determined by\nW \u2032 (ek2 \u2212, 1) = e\u20321 Q\u2212 H\u0304(k2 )\nand the levels k1\u2217 and k2\u2217 satisfy the smooth fit equations\n+\u2032\n\u2212\n+\n\u03a8\u2212\u2032\n1 (k1 )H (k1 ) + \u03a81 (k1 )[C \u2212 H (k2 )] =\n\ne\u20322 Q\u2212 H\u0304(k2 ) =\n\nr1 k1\ne ,\nq1\n\u2212ek2 ,\n\nwhere prime in the first equation denotes differentiation with respect to x.\n3. Case k1\u2217 > k2\u2217\nFor k2\u2217 < x < k1\u2217 and Z = 2, we are led to consider the\n(2)\nMarkov process Y\nwith state space {2, 2\u22c6 } and generator matrix\n\u0012\n\u0013\n\u2212q2 \u2212 r2 \u2212 \u03bb \u03bb\nQ(2) =\n.\n\u03b1\n\u2212\u03b1\nIn this case it can be checked from (18), (19), and (20) with Qa replaced by\nQ(2) , that \u2212Q+\n(2) is a scalar given by the positive root of\n\u03c322 2\n\u03b1\nx + \u03bc2 x + \u03bb\n= q2 + r2 + \u03bb\n2\nx+\u03b1\nand that\n\n\u03b7 + = \u03b1/[\u2212Q+\n(2) + \u03b1].\n\n\u2212\n+\nWe can calculate Q\u2212\n(2) in a similar way as we calculated Q above. Writing Q\u0303 =\n\u2212\n\u2212\nQ+\n(2) and Q\u0303 = Q(2) the corresponding matrices of two-sided exit probabilities\nfrom [k2\u2217 , k1\u2217 ] read as\n\u0014\u0012 \u0013\n\u0012 \u0013\n\u0015\n1\n1\n1\n+\nQ\u0303+ (l\u2212x)\nQ\u0303\u2212 (x\u2212k)\nQ\u0303+ (l\u2212k)\n\u03a82 (x) =\ne\n\u2212e\n,\ne\n\u03b7+\n\u03b7+\nc\ni\u22121\nih\nh \u2212\n+\n\u2212\n+\n\u2212\n,\n\u03a8\u2212\neQ\u0303 (x\u2212k) \u2212 eQ\u0303 (l\u2212x) M eQ\u0303 (l\u2212k) I \u2212 eQ\u0303 (l\u2212k) M eQ\u0303 (l\u2212k)\n2 (x) =\n\nwith k = k2\u2217 and l = k1\u2217 , where\nc\n\n=\n\nM\n\n=\n\n\u2212\n\n1 \u2212 ( 1 0 )eQ\u0303\n\u0012\n\u0013\n1 0\n.\n\u03b7+ 0\n\nThe value function is\n\uf8f1\n\u2032 Q\u2212 (x\u2212k1\u2217 ) e\n\uf8f4\nH(k1\u2217 ),\n\uf8f4\n\uf8f2e i e\nW (ex , i) =\n\n(l\u2212k)\n\n\u0012\n\n\u0013\n+\n1\neQ\u0303 (l\u2212k) ,\n\u03b7+\n\nx \u2265 k1\u2217 , i = 1, 2,\n\nh\ni\n\uf8f4\n\uf8f4\ne + (x) + f \u03a8+ (x)[C \u2212 H\ne + (k1\u2217 )] + \u03a8\u2212 (x)H\ne \u2212 (k2\u2217 ) ,\n\uf8f3H\n2\n2\n17\n\nk2\u2217 < x \u2264 k1\u2217 , i = 2,\n\n\fwhere f is the row vector f = ( 1 0 ) and\n\uf8eb\n\uf8f6\nK \u2212 ek\ne\ne + (x) = K \u2212 ex q2 + r2 ,\nH(k)\n= \uf8ed C \uf8f8,\nH\nq2\nD\n\ne \u2212 (k) = ek r2\nH\nq2\n\n\u0012\n\n1\n\u03b1\n\u03b1+1\n\n\u0013\n\n,\n\nwhere we used again equation (A.3). Here C and D are determined by the two\nlinear equations\nW (ek1 \u2212, 2\u22c6 ) =\n\nW (ek1 +, 2\u22c6 ),\n\nW \u2032 (ek1 \u2212, 2) =\n\nW \u2032 (ek1 +, 2),\n\nand the levels k1\u2217 and k2\u2217 satisfy the two equations\nh\ni\nr2\n+\u2032\ne\u2212\ne+\nf \u03a8\u2212\u2032\n= ek2 ,\n2 (k2 )H (k2 ) + \u03a82 (k2 ){C \u2212 H (k1 )}\nq2\n\u2032 \u2212e\nk1\ne Q H(k1 ) = \u2212e .\n1\n\nAcknowledgements\n\nWe would like to thank Florin Avram for inspiring conversations. We also thank\nan anonymous referee and an associate editor for their numerous useful suggestions and comments that led to considerable improvements of the presentation\nof the paper.\n\nAppendix\n\nA\nA.1\n\nProofs\nCram\u00e9r Martingale Measure\n\nIn this section and the next we present a construction of an equivalent martingale\nmeasure for the process (X, Z) and show how the parameters change under this\nchange of measure. For a background of Markov additive processes we refer to\nAsmussen [3].\nAn important role in the construction of the change of measure is played by\nthe process Xa = {Xa (t); t \u2265 0} defined by\nZ t\nXa (t) =\na(Zs )dXs\n0\n\nfor some function a to be specified below. It is straightforward to verify that the\nprocess Xa is still of the form (2), but with changed parameters; its characteristic\nmatrix is Ka [s] = G + \u2206a [s], where \u2206a [s] is the diagonal matrix with elements\n\u03bai (ai s). Write h and \u03bb for the Perron-Frobenius right-eigenvector and eigenvalue\nof Ka [1], respectively, and define the candidate change of measure L = {Lt ; t \u2265\n0} by\nL(t) = eXa (t)\u2212\u03bbt h(Z(t))/h(Z(0)),\n(A.1)\n18\n\n\fwith h(i) = hi the ith coordinate of h. If E[S1 ] < \u221e, then \u03bai (1) < \u221e for i \u2208 E 0 ,\nand a solution ai , i \u2208 E 0 , exists of the equations\n\u03bai (ai + 1) = r(i) + \u03bai (ai ),\n\n(A.2)\n\ni\n\nwith \u03bai (ai ) < \u221e, where \u03bai (s) = log E[esX1 ] is the Laplace exponent of Xti =\n\u03bci t + \u03c3i Wt + Ji (t). It is shown in the following result that the measure P\u2217 with\nRadon-Nikodym derivative\ndP\u2217\n= L(t)\ndP Ft\nis indeed an equivalent martingale measure:\nProposition 2 Suppose that E[S1 ] is finite.\n(i) The process L = {Lt , Ft ; t \u2265 0} is a positive mean one martingale and\nP\u2217 is a probability measure;\n\u0010\n\u0011\nRt\n(ii) Under P\u2217 , exp Xt \u2212 0 r(Zs )ds = Bt\u22121 St is a martingale.\n\nIn view of Proposition 2, the market (1) with price processes as specified\nin (2) is arbitrage-free if E[S1 ] < \u221e. It is shown below in Proposition 3 that,\nunder P\u2217 , X is still of the form (2) but with changed parameters. The process\nBt\u22121 St is martingale if the following restriction holds for the parameters of X\n(see also [4, Sec. 2]):\n\nwhere\n\n\u03c3 2 (i)\n+ \u03bc(i) + \u03bbi (Fbi (1) \u2212 1) = r(i),\n2\n\ni \u2208 E0,\n\n(A.3)\n\nFbi (s) = pi \u03b1\u2032i (\u2212sI \u2212 Ti )\u22121 ti + qi \u03b2i\u2032 (sI \u2212 Ui )\u22121 ui\n\ndenotes the moment-generating function of fi , the pdf of the jump-sizes of X\nin state i.\nProof: of Proposition 2 (i) Let (X, Z) be of the form (2), with corresponding\ncharacteristic matrix K and suppose that g is a E 0 -row vector. Asmussen and\nKella [5] have shown that\nebXt \u2212ct g(Zt ) \u2212 ebX0 g(Z0 ) \u2212\n\nZ\n\nt\n\nebXu \u2212cu g(Zu )du(K[b] \u2212 cI),\n\n(A.4)\n\n0\n\nis a row vector of martingales for c \u2265 0 and b such that the diagonal elements of\nK[b] are finite. Choosing in (A.4) the process X to be equal to Xa , b = 1, c = \u03bb\nand g = h, it follows that eXa (t)\u2212\u03bbt h( Zt ) \u2212 h( Z0 ) is a zero mean martingale.\nAs h is positive, the process L in (A.1) is thus a positive mean one martingale.\nThe proof of (ii) can be found in the next section.\n\u0003\n\n19\n\n\fA.2\n\nChange of measure\n\nProposition 3 Under P\u2217 , the process X is still of the form (2) with \u03c3 \u2217 (i) =\n\u03c3(i),\nZ 1\n(+) (+)\n\u2217\n2\ny(1 \u2212 e\u03b1i y )\u03bbi Fi (dy)\n\u03bc (i) = \u03bc(i) + \u03b1i \u03c3i \u2212\n0\n\nand with Ji\u2217 compound Poisson processes with changed jump rates\n(+)\u2217\n\n\u03bbi\n\n= \u03bb(+) F\u0302 (+) [\u2212\u03b3]\n\n(\u2212)\u2217\n\nand\n\n\u03bbi\n\n= \u03bb(\u2212) F\u0302 (\u2212) [\u03b3]\n\nand distributions of the positive and negative jumps of phase-type with representations\n(+)\u2217\n\n(\u03b1i\n\n(+)\u2217\n\n, Ti\n\n(+,ai )\n\n) = (\u03b1i\n\n(+,ai )\n\n, Ti\n\n(\u2212)\u2217\n\n) and (\u03b1i\n\n(\u2212)\u2217\n\n, Ti\n\n(\u2212,ai )\n\n) = (\u03b1i\n\n(\u2212,ai )\n\n, Ti\n\n),\n\nrespectively, where the parameters are transformed according to\n(+)\n(\u03b1(+,\u03b3) , T (+,\u03b3) ) = (\u03b1(+) \u2206+ /F\u0302 (+) [\u2212\u03b3], \u2206\u22121\n\u2206+ + \u03b3I),\n+ T\n(\u2212,\u03b3)\n\n(\u03b1\n\n,T\n\n(\u2212,\u03b3)\n\n(\u2212)\n\n) = (\u03b1\n\n\u2206\u2212 /F\u0302\n\n(\u2212)\n\n\u22121 (\u2212)\n[\u03b3], \u2206\u2212\nT \u2206\u2212\n\n\u2212 \u03b3I),\n\n(A.5)\n(A.6)\n\nwhere \u2206+ and \u2206\u2212 are the diagonal matrices with respectively (k+ )i and (k\u2212 )i\non the diagonal such that k+ = (\u2212\u03b3I \u2212 T (+) )\u22121 t(+) , k\u2212 = (\u03b3I \u2212 T (\u2212) )\u22121 t(\u2212)\nand I is an identity matrix of appropriate size.\nProposition 4 Under P\u2217 , Z has intensity matrix G\u2217 with elements\nX\n\u2217\n\u2217\ngij\n= gij h(j)/h(i), i 6= j, and gii\n=\u2212\ngij h(j)/h(i),\nj6=i\n\nwhere gij is the ijth element of G;\nProof: of Propositions 3 and 4. We first show how to find the characteristic\nea the process Xa + bX, where b is such that\nmatrix of X under P\u2217 . Denote by X\nea are finite, and let f be a function\nthe elements of the characteristic matrix of X\ne\n0\nthat maps E to R. Applying It\u00f4's lemma to eXa (t)\u2212\u03bbt ha (Zt )f (Zt ) shows that\nZ t\ne\ne\ne\n\u03bbeXa (u)\u2212\u03bbu h(Zu )f (Zu )du\neXa (t)\u2212\u03bbt h(Zt )f (Zt ) \u2212 eXa (0) h(Z0 )f (Z0 ) \u2212\n0\nZ t\nea (u)\u2212\u03bbu\nX\n\u00d7\n\u2212\ndu e\n0\n\uf8ee\n\uf8f9\nX\nX\n\u00d7\uf8f0\n(1{Zu =i} h(i)f (i)\u03bai (ai + b) +\ngij (h(j)f (j) \u2212 h(i)f (i)))\uf8fb ,\ni\u2208E 0\n\nj6=i\n\nis a P-martingale, where we wrote \u03bb = \u03bba and h = ha . Since\nX\n\u03bba (ha )i = (Ka [1]ha )i =\ngij (ha (j) \u2212 ha (i)) + \u03bai (ai )ha (i),\nj6=i\n\n20\n\n\fit follows from taking expectations and rearranging terms that, in vector notation,\nZ t\n(A.7)\nE0,i [Lu ebX(u) 1Zu ](G\u2217 + \u2206\u2217 [b])du,\nE0,i [Lt ebX(t) 1Zt ] = 1i +\n0\n\nwhere G\u2217 is as in the statement of the proposition and \u2206\u2217 is the diagonal\nmatrix with elements \u2206\u2217ii = \u03bai (ai + b) \u2212 \u03bai (ai ). Writing Ft\u2217 [b] for the matrix\nwith elements E\u22170,i [ebXt 1Zt =j ] and differentiating (A.7) with respect to t, we\narrive at the matrix differential equation\nFt\u2217\u2032 [b] = Ft\u2217 [b](G\u2217 + \u2206\u2217 ),\n\nF0\u2217 [b] = I,\n\nwhere \u2032 denotes the time derivative. Solving this system shows that the characteristic matrix of X under P\u2217 is given by K \u2217 [b] = G\u2217 + \u2206\u2217 . See [1] for a proof\nof (A.5) and (A.6); the rest of the statements of (i) and (ii) directly follow from\nProposition 3 in [25].\n\u0003\nProof: of Proposition 2(ii) From Proposition 3 it follows that the ai 's have been\nchosen in such that, under P\u2217 , X i have cumulant-generating functions satisfying\n\u2217\n\u2217\nR\u03bai* (1) = \u03bai (ai + 1) \u2212 \u03bai\u2217(ai ) = ri , so\u2217that the\u2217 characteristic matrix K of (X\u2217 \u2212\nr(Zs )ds, Z) under P satisfies K [1] = G and 1 is an eigenvector of K [1]\n0\nwith eigenvalue 0.\nSetting g \u2261 1 in (A.4) and taking a = 0, it thus follows that\nRt\nthe process eXt \u2212 0 r(Zs )ds is a martingale under P\u2217 .\n\u0003\n\nA.3\n\nWiener-Hopf factorization\n\nProof: of Theorem 2(ii) Now we turn to the proof of the uniqueness of the\nWiener-Hopf factorization. To this end, let (Z + , G+ , Z \u2212 , G\u2212 ) be a WienerHopf factorization and define the function fe as in (21), but replacing \u03b7 + and\nQ+ by Z + and G+ respectively. Since (Z + , G+ ) satisfies the first equation of\n(18), it follows from an application of It\u00f4's lemma, that fe(Yt , At ) is a local\nmartingale that is bounded on {t \u2264 \u03c4l+ }, so that Doob's Optional Stopping\nTheorem implies that\nfe(j, x) = Ex,j [fe(Yt\u2227\u03c4 + , At\u2227\u03c4 + )]\nl\n\nl\n\n= Ex,j [fe(Yel+ , A\u03c4 + )1(\u03c4 + <\u221e) ] + lim Ex,j [fe(Yt , At )1(\u03c4 + =\u221e) ].\nl\n\nt\u2192\u221e\n\nl\n\nl\n\n(A.8)\n\nBy the definition of fe and the absence of positive jumps of A, the first expectation in (A.8) is equal to f (j, x). Note that the second term in (A.8) is zero if Q\nis transient or Q is recurrent and supt At = +\u221e. Indeed, in the latter case, \u03c4l+\nis finite a.s. whereas in the former case Px,i (Yt \u2208 E) converges to zero. Thus\nf = fe for all h and we deduce that G+ = Q+ and Z + = \u03b7 + . Similarly, one can\nshow that G\u2212 = Q\u2212 and Z \u2212 = \u03b7 \u2212 and the uniqueness is proved.\n\u0003\nProof: of Theorem 2(iii) Assume that Q is recurrent but At \u2192 \u2212\u221e. As Q+\ninherits the irreducibility property of Q, it follows from the Perron-Frobenius\ntheorem that the matrix Q+ has a probability vector \u03bc as left-eigenvector with\n21\n\n\fits largest eigenvalue. Since the quadruple (\u03b7 + , Q+ , \u03b7 \u2212 , Q\u2212 ) satisfies (18), it is\nstraightforward to check that this remains the case if we replace (\u03b7 + , Q+ ) by\n(\u03b7 + (I \u2212 1\u03bc) + \u03bc, Q+ (I \u2212 1\u03bc)). We are left to show that these are the only two\nfactorizations of (A, Y ). As in the proof of Theorem 2(ii), it follows that any\nfactorization quadruple of (A, Y ) must contain \u03b7 \u2212 and Q\u2212 . Letting (\u03b7 + , G+ )\nand fe(j, x) be as in the proof of Theorem 2, we distinguish between the cases that\nG is recurrent or transient. In the latter case fe(j, x) tends to zero if x \u2192 \u2212\u221e\nand we deduce from (A.8) that f = fe and thus G = Q+ and Z + = \u03b7 + . In\nthe former case, we note that, as G+ inherits the irreducibility property of Q,\nit has a unique invariant distribution \u03bd given by the left-eigenvector of G with\neigenvalue 0. Thus fe(j, x) converges to e\u2032j 1\u03bdh = \u03bdh as x \u2192 \u221e. The right-hand\nside of (A.8) is thus equal to\nfe(j, x) = f (j, x) + Px,j (\u03c4k+ = \u221e)\u03bdh\n\n\u0001\n= f (j, x) + 1 \u2212 e\u2032j W + exp(Q+ (k \u2212 x))1 \u03bdh.\n\n(A.9)\n\nBy differentiation of (A.9) with respect to x, we deduce that G = Q+ (I \u2212 1\u03bd).\nIn particular, it follows that \u03bd is a left-eigenvector of Q+ . Since the PerronFrobenius eigenvector is the unique eigenvector with the largest eigenvalue, it\nfollows that \u03bc = \u03bd and then also that Z + = \u03b7 + (I \u2212 1\u03bc) + \u03bc, which completes\nthe proof.\n\u0003\n\nA.4\n\nFirst-passage under state-dependent levels\n\nProof: of Theorem 3 For brevity of notation we will drop the subscript and write\nv for vb,k . Appealing to the strong Markov property, it follows that, for x > k1 ,\nv(x, i)\n\n=\n\nEx,i [v(k1 , Y\u03c4 \u2212 )1(\u03c4 \u2212 <\u03b6) ] = Ex,i [h\u2212\n1 (Y\u03c4 \u2212 )1(\u03c4 \u2212 <\u03b6) ],\n\nwhere \u03c4 \u2212 = \u03c4k\u22121 , and for kj < x < kj\u22121 ,\nv(x, i)\n\n\u0002\n\u0003\n= Ex,i v(kj\u22121 , Y\u03c4 )1(\u03c4 <\u03b6,A\u03c4 =kj\u22121 )\n\u0002\n\u0003\n\u0002\n\u0003\n+ Ex,i v(kj , Y\u03c4 )1(\u03c4 <\u03b6,A\u03c4 =kj ) + Ex,i v(A\u03b6\u2212 , Y\u03b6\u2212 )1(\u03b6<\u03c4 ) .\n\nInvoking results from Proposition 1 yields that (36) is valid for some vectors\n\u2020\n+\nh\u2212\nj , hj and hj . To finish the proof we have to show that the stated form of\nthese vectors is correct. We start with noting that, by the structure of the\nprocess (A, Y ),\nv(kj , j) = ebkj\n\nand v(kj , l) = ebkj e\u2032l (sI \u2212 Tj\u2212 )\u22121 t\u2212\nj\n\nfor l \u2208 Ej\u2212 .\n\nFurthermore, we claim that v(*, i) is continuous. Indeed, from the Markov prop\u2212\n, m \u2208 E0\nerty it follows that for l \u2208 Em\nZ \u221e\n\u2212\nv(z, l) =\nv(z + y, m)e\u2032l eTm y t\u2212\n(A.10)\nm dy,\n0\n\n22\n\n\fso that, in particular, it holds that v(*, l) is continuously differentiable on\n+\n(km , \u221e). Similarly, it follows that v(*, l) \u2208 C 1 (km , \u221e) for l \u2208 Em\n. The conti0\nnuity of v(*, l) for l \u2208 E follows directly from its definition. As a consequence\nit follows that the equation (41) holds true. Let l > j, l \u2208 E 0 and consider\nv(x, l) for x \u2208 [kj \u2212 \u01eb, kj + \u01eb]. By a Feynman-Kac argument it follows that, on\n[kj \u2212 \u01eb, kj + \u01eb] for \u01eb > 0 small enough (such that kj \u2212 \u01eb > kl ), v(*, l) is equal to\nthe unique C 2 solution of the ODE\n\u03c3 2 (l) \u2032\u2032\nf + \u03bc(l)f \u2032 \u2212 c(l)f = g,\n2\n\nf (kj \u00b1 \u01eb) = v(kj \u00b1 \u01eb, l),\n\nfor some continuous function g and some constant c(l). In particular, v(*, l) is\ncontinuously differentiable at kj and it follows that (40) holds true.\n\u0003\n\nA.5\n\nAmerican put\n\nProof: of Theorem 1 The proof of this result follows a standard approach for solving perpetual American option pricing problems. As argued above the optimal\nstopping time must be of the form (6). Therefore, the value function is given\nby Vk\u2217 for some vector k \u2217 \u2208 (\u2212\u221e, log K)N . The vector k \u2217 can subsequently be\nfound by optimisation. At this point we note that the condition (A.3) implies\nthat for the embedding s(i)2 /2 + m(i) < \u2212qii is satisfied for all i \u2208 E, so that\nwe can apply Theorem 3. Since, for fixed (x, i), k 7\u2192 Vk (x, i) is continuously\ndifferentiable it follows that k \u2217 satisfies\n\u2202Vk x\n(e , i)\n\u2202kj\n\n=0\n\nfor all (x, i), j = 1, . . . , N .\n\n(A.11)\n\nk=k\u2217\n\nConsider next the finite difference [Vk (ekj +h , j) \u2212 Vk (ekj , j)]/h and note that it\nis equal to the sum\nVk (ekj +h , j) \u2212 Vk+h (ekj +h , j) Vk+h (ekj +h , j) \u2212 Vk (ekj , j)\n+\n.\nh\nh\n\n(A.12)\n\nLetting h \u2193 0, it follows from (A.11), that the first term converges to zero, while\nthe second term converges to \u2212ekj . Thus we see that the smooth fit equations\n(8) hold true. By a martingale argument it also follows that Vk\u2217 = V \u2217 for any\nsolution k \u2217 \u2208 (\u2212\u221e, log K)N of (8).\n\u0003\nProof: of Lemma 1 Suppose first that\nq\n\u03b1 6= [\u03bc1 + \u03bc21 + 2(r1 + q1 )\u03c312 ]/\u03c312 .\nFrom the definitions of g(\u03b8), F1 (\u03b8), and F2 (\u03b8), we have that\ng(+\u221e) = +\u221e,\n\ng(\u2212\u221e) = \u2212\u221e,\n\ng(0) = \u03b1[(q1 + r1 )(q2 + r2 ) \u2212 q1 q2 ] > 0.\n\nNote that F1 (\u03b8) has two different real roots \u03b80,1 > 0 > \u03b80,2 with\nq\n\u03b80,2 = \u2212[\u03bc1 + \u03bc21 + 2(r + q1 )\u03c312 ]/\u03c312 ,\n23\n\n\fwe then have \u03b80,2 6= \u2212\u03b1. Also,\ng(\u03b80,1 ) = \u2212q1 q2 (\u03b1 + \u03b80,1 ) < 0,\nbecause q1 , q2 , \u03b1, \u03b80,1 > 0. Therefore, we further have that\n(\n\u2212q1 q2 (\u03b1 + \u03b80,2 ) < 0, if\n\u03b80,2 > \u2212\u03b1,\ng(\u03b80,2 ) =\n\u2212q1 q2 (\u03b1 + \u03b80,2 ) > 0, if\n\u03b80,2 < \u2212\u03b1.\n(\n\u03bb\u03b1F1 (\u2212\u03b1; r) > 0, if\n\u03b80,2 > \u2212\u03b1,\nlim g(\u03b8) =\n\u03b8\u2192\u2212\u03b1\n\u03bb\u03b1F1 (\u2212\u03b1; r) < 0, if\n\u03b80,2 < \u2212\u03b1.\nIn view of the intermediate value theorem the proof of the first assertion is\ncomplete. Since Q\u2212 is a generator matrix, it is negative semi-definite and the\nfinal assertion follows.\nIf\nq\n\u03b1 = [\u03bc1 + \u03bc21 + 2(r1 + q1 )\u03c312 ]/\u03c312 ,\n\n\u03b8 = \u2212\u03b1 is a root. By a similar reasoning applied to h(\u03b8) = g(\u03b8)/(\u03b8 + \u03b1) and\nh(\u2212\u03b1) < 0 it can be shown that h has four distinct roots (two positive and two\nnegative ones).\n\u0003\n\nReferences\n[1] Asmussen, S.: Exponential families generated by phase-type distributions\nand other Markov lifetimes. Scand. J. Statist. 16, 319\u2013334, 1989.\n[2] Asmussen, S.: Phase\u2013type representations in random walk and queueing\nproblems. Ann. Probab. 20, 772\u2013789, 1992.\n[3] Asmussen, S.: Ruin Probabilities. World Scientific, 2000.\n[4] Asmussen, S., Avram, F. and Pistorius, M.R.: Russian and American put\noptions under phase-type L\u00e9vy models. Stoch. Proc. Appl. 109, 79\u2013111, 2004.\n[5] Asmussen, S. and Kella, O.: A multi\u2013dimensional martingale for Markov\nadditive processes and its applications, Adv. Appl. Probab. 32, 376\u2013393,\n2000.\n[6] Barndorff-Nielsen, O. E. Processes of normal inverse Gaussian type. Finance\nStoch. 2, 41\u201368, 1998.\n[7] Bensoussan, A. On the theory of option pricing, Acta applicandae mathematicae 2, 139\u2013158, 1984.\n[8] Boyarchenko, S.I., and Levendorskii, S.Z.: Perpetual American options under L\u00e9vy processes. SIAM Journal on Control and Optimization 40, 1663\u2013\n1696, 2002.\n24\n\n\f[9] Carr, P.: Randomization and the American Put. Rev. Fin. Studies 11, 597\u2013\n626, 1998.\n[10] Carr, P., Geman, H., Madan, D.P. and Yor, M.: The fine structure of asset\nreturns, Journal of Business 75, 305\u2013332, 2002.\n[11] Cont, R. and Tankov, P. Financial modelling with jump-diffusions. Chapman/CRC Press, 2004.\n[12] Eberlein, E. and Keller, U: Hyperbolic Distributions in Finance. Bernoulli\n1, 281\u2013299, 1995.\n[13] Gerber, H.U., Shiu, E.S.W. On the time value of ruin. North American\nActuarial Journal 2, 48\u201378, 1998.\n[14] Guo, X. An explicit solution to an optimal stopping problem with regime\nswitching. J. Appl. Prob. 38, 464\u2013481, 2001.\n[15] Guo, X. Inside information and stock fluctuations. PhD dissertation, Department of Mathematics, Rutgers University, Newark, NJ, 1999.\n[16] Guo, X. Information and option pricing, Quantitative Finance, 1, 38\u201344,\n2001.\n[17] Guo, X. and Q. Zhang: Closed-form solutions for perpetual American put\noptions with regime switching. SIAM J. Appl. Math. 64, 2034\u20132049, 2004.\n[18] Jobert, A. and Rogers, L.C.G.: Option pricing with Markov-modulated\ndynamics. Siam J. Control Optim. 44, 2063\u20132078, 2006.\n[19] Karatzas, I. On the pricing of American options. Applied mathematics and\noptimization 17, 37-60, 1988.\n[20] Kemperman, J. H. B. The passage problem for a stationary Markov chain.\nStatistical Research Monographs, Vol. I. The University of Chicago Press,\nChicago, 1961.\n[21] Kou, S. G.: A jump-diffusion for option pricing. Management Science 48,\npp. 1086\u20131101, 2002.\n[22] Levendorskii, S.Z.: Early exercise boundary and option pricing in L\u00e9vy\ndriven models; Quantitative Finance 4, 525\u2013547, 2004.\n[23] London, R. R.; McKean, H. P.; Rogers, L. C. G.; Williams, David A martingale approach to some Wiener-Hopf problems. I, II. Seminar on Probability,\nXVI, pp. 41\u201367, 68\u201390, Lecture Notes in Math., 920, Springer, Berlin-New\nYork, 1982.\n[24] Neuts, M. F.:\nHopkins, 1981.\n\nMatrix-Geometric Solutions in Stochastic Models, John\n\n25\n\n\f[25] Palmowski, Z. and Rolski, T.: A technique of exponential change of measure for Markov processes, Bernoulli 8, 767\u2013785, 2002.\n[26] Rogers, L.C.G.: Fluid models in Queueing theory, Ann. Appl. Probab. 4,\n390-413, 1994.\n[27] Shiryayev, A. N. Optimal stopping rules. Applications of Mathematics, Vol.\n8. Springer-Verlag, New York-Heidelberg, 1978.\n\n26\n\n\f"}