{"id": "http://arxiv.org/abs/math/0401289v1", "guidislink": true, "updated": "2004-01-22T12:53:26Z", "updated_parsed": [2004, 1, 22, 12, 53, 26, 3, 22, 0], "published": "2004-01-22T12:53:26Z", "published_parsed": [2004, 1, 22, 12, 53, 26, 3, 22, 0], "title": "Trace of Frobenius endomorphism of an elliptic curve with complex\n  multiplication", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0401115%2Cmath%2F0401243%2Cmath%2F0401266%2Cmath%2F0401371%2Cmath%2F0401425%2Cmath%2F0401218%2Cmath%2F0401420%2Cmath%2F0401234%2Cmath%2F0401240%2Cmath%2F0401252%2Cmath%2F0401432%2Cmath%2F0401331%2Cmath%2F0401139%2Cmath%2F0401016%2Cmath%2F0401317%2Cmath%2F0401098%2Cmath%2F0401130%2Cmath%2F0401203%2Cmath%2F0401026%2Cmath%2F0401223%2Cmath%2F0401339%2Cmath%2F0401168%2Cmath%2F0401311%2Cmath%2F0401336%2Cmath%2F0401196%2Cmath%2F0401292%2Cmath%2F0401228%2Cmath%2F0401020%2Cmath%2F0401006%2Cmath%2F0401267%2Cmath%2F0401034%2Cmath%2F0401058%2Cmath%2F0401172%2Cmath%2F0401429%2Cmath%2F0401138%2Cmath%2F0401320%2Cmath%2F0401250%2Cmath%2F0401239%2Cmath%2F0401119%2Cmath%2F0401062%2Cmath%2F0401382%2Cmath%2F0401286%2Cmath%2F0401337%2Cmath%2F0401036%2Cmath%2F0401187%2Cmath%2F0401217%2Cmath%2F0401031%2Cmath%2F0401255%2Cmath%2F0401050%2Cmath%2F0401290%2Cmath%2F0401009%2Cmath%2F0401335%2Cmath%2F0401154%2Cmath%2F0401184%2Cmath%2F0401216%2Cmath%2F0401209%2Cmath%2F0401254%2Cmath%2F0401377%2Cmath%2F0401350%2Cmath%2F0401399%2Cmath%2F0401022%2Cmath%2F0401084%2Cmath%2F0401177%2Cmath%2F0401384%2Cmath%2F0401173%2Cmath%2F0401390%2Cmath%2F0401412%2Cmath%2F0401375%2Cmath%2F0401342%2Cmath%2F0401193%2Cmath%2F0401281%2Cmath%2F0401356%2Cmath%2F0401241%2Cmath%2F0401259%2Cmath%2F0401099%2Cmath%2F0401206%2Cmath%2F0401364%2Cmath%2F0401391%2Cmath%2F0401321%2Cmath%2F0401431%2Cmath%2F0401035%2Cmath%2F0401201%2Cmath%2F0401132%2Cmath%2F0401270%2Cmath%2F0401268%2Cmath%2F0401385%2Cmath%2F0401247%2Cmath%2F0401289%2Cmath%2F0401386%2Cmath%2F0401198%2Cmath%2F0401178%2Cmath%2F0401436%2Cmath%2F0401076%2Cmath%2F0401309%2Cmath%2F0401427%2Cmath%2F0401325%2Cmath%2F0401162%2Cmath%2F0401330%2Cmath%2F0401069%2Cmath%2F0401213%2Cmath%2F0401419&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Trace of Frobenius endomorphism of an elliptic curve with complex\n  multiplication"}, "summary": "Let E be an elliptic curve with complex multiplication by R, where R is an\norder of discriminant D<-4 of an imaginary quadratic field K . If a prime\nnumber p is decomposed completely in the ring class field associated with R,\nthen E has good reduction at a prime ideal P of K dividing p and there exist\npositive integers u and v such that 4p=u^2-Dv^2. It is well known that square\nof the trace a_P of Frobenius endomorphism of the reduction of E modulo P is\nequal to u^2. We determine whether a_P=u or a_P=-u in the case the class number\nof R is 2 or 3 and D is divided by 3,4 or 5. This article is a revised version\nof the authors' preprint DMIS-RR-02-5,2002.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0401115%2Cmath%2F0401243%2Cmath%2F0401266%2Cmath%2F0401371%2Cmath%2F0401425%2Cmath%2F0401218%2Cmath%2F0401420%2Cmath%2F0401234%2Cmath%2F0401240%2Cmath%2F0401252%2Cmath%2F0401432%2Cmath%2F0401331%2Cmath%2F0401139%2Cmath%2F0401016%2Cmath%2F0401317%2Cmath%2F0401098%2Cmath%2F0401130%2Cmath%2F0401203%2Cmath%2F0401026%2Cmath%2F0401223%2Cmath%2F0401339%2Cmath%2F0401168%2Cmath%2F0401311%2Cmath%2F0401336%2Cmath%2F0401196%2Cmath%2F0401292%2Cmath%2F0401228%2Cmath%2F0401020%2Cmath%2F0401006%2Cmath%2F0401267%2Cmath%2F0401034%2Cmath%2F0401058%2Cmath%2F0401172%2Cmath%2F0401429%2Cmath%2F0401138%2Cmath%2F0401320%2Cmath%2F0401250%2Cmath%2F0401239%2Cmath%2F0401119%2Cmath%2F0401062%2Cmath%2F0401382%2Cmath%2F0401286%2Cmath%2F0401337%2Cmath%2F0401036%2Cmath%2F0401187%2Cmath%2F0401217%2Cmath%2F0401031%2Cmath%2F0401255%2Cmath%2F0401050%2Cmath%2F0401290%2Cmath%2F0401009%2Cmath%2F0401335%2Cmath%2F0401154%2Cmath%2F0401184%2Cmath%2F0401216%2Cmath%2F0401209%2Cmath%2F0401254%2Cmath%2F0401377%2Cmath%2F0401350%2Cmath%2F0401399%2Cmath%2F0401022%2Cmath%2F0401084%2Cmath%2F0401177%2Cmath%2F0401384%2Cmath%2F0401173%2Cmath%2F0401390%2Cmath%2F0401412%2Cmath%2F0401375%2Cmath%2F0401342%2Cmath%2F0401193%2Cmath%2F0401281%2Cmath%2F0401356%2Cmath%2F0401241%2Cmath%2F0401259%2Cmath%2F0401099%2Cmath%2F0401206%2Cmath%2F0401364%2Cmath%2F0401391%2Cmath%2F0401321%2Cmath%2F0401431%2Cmath%2F0401035%2Cmath%2F0401201%2Cmath%2F0401132%2Cmath%2F0401270%2Cmath%2F0401268%2Cmath%2F0401385%2Cmath%2F0401247%2Cmath%2F0401289%2Cmath%2F0401386%2Cmath%2F0401198%2Cmath%2F0401178%2Cmath%2F0401436%2Cmath%2F0401076%2Cmath%2F0401309%2Cmath%2F0401427%2Cmath%2F0401325%2Cmath%2F0401162%2Cmath%2F0401330%2Cmath%2F0401069%2Cmath%2F0401213%2Cmath%2F0401419&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let E be an elliptic curve with complex multiplication by R, where R is an\norder of discriminant D<-4 of an imaginary quadratic field K . If a prime\nnumber p is decomposed completely in the ring class field associated with R,\nthen E has good reduction at a prime ideal P of K dividing p and there exist\npositive integers u and v such that 4p=u^2-Dv^2. It is well known that square\nof the trace a_P of Frobenius endomorphism of the reduction of E modulo P is\nequal to u^2. We determine whether a_P=u or a_P=-u in the case the class number\nof R is 2 or 3 and D is divided by 3,4 or 5. This article is a revised version\nof the authors' preprint DMIS-RR-02-5,2002."}, "authors": ["N. Ishii"], "author_detail": {"name": "N. Ishii"}, "author": "N. Ishii", "arxiv_comment": "20 pages", "links": [{"href": "http://arxiv.org/abs/math/0401289v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0401289v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11G05 (Primary), 14H52 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0401289v1", "affiliation": "Osaka Prefecture University", "arxiv_url": "http://arxiv.org/abs/math/0401289v1", "journal_reference": "Bull.Austral.Math.Soc.70(2004),125-142", "doi": null, "fulltext": "arXiv:math/0401289v1 [math.NT] 22 Jan 2004\n\nTrace of Frobenius endomorphism of an\nelliptic curve with complex multiplication1\nBy Noburo ISHII\n1. Introduction\n\u221a\nLet K = Q( \u2212m) be an imaginary quadratic field, where m is a squarefree positive integer. Let R be an order of K of conductor f0 with a basis\n{1, \u03c9} over Z. We denote by d(R) and h(R) the discriminant and the class\nnumber\nof R respectively. Let f be the smallest positive integer such that\n\u221a\nf \u2212m \u2208 R. Then we have f = f0 /2 (resp. f0 ) if m \u2261 3 mod 4 and f0 is\neven (resp. otherwise). Let E be an elliptic curve with complex multiplication by R and denote by j(E) the j-invariant of E. We may assume that E\nis defined by a Weierstrass equation: y 2 = x3 + Ax + B, A, B \u2208 F = Q(j(E)).\nFirst, we introduce the notation used in the follwing. For an endomorphism\n\u03bb of E, the kernel of \u03bb is denoted by E[\u03bb]. For a prime ideal p of F , we\ndenote by lp the relative degree of p over Q. If E has good reduction at\n\u223c\n\np, then we denote by Ep the reduction of E modulo p. For a point P of E\nwe denote by P \u223c the reduction of P modulo p. Further we denote by \u03c6p\n\u223c\n\nthe Frobenius endomorphism of Ep and by ap(E) the trace of \u03c6p. By Fq , we\n\u223c\n\n\u223c\n\ndenote the finite field of q-elements. If Ep is defined over Fq , then Ep(Fq )\n\u223c\n\ndenotes the group of Fq -rational points of Ep.\nNow let p be an odd prime number and p a prime ideal of F dividing p.\nLet us assume that p and p satisfy the following condition:\n(1) p splits completely in K, p is prime to f and E has good reduction at p.\nThen by complex multiplication theory (cf. II of Silverman [11]), we know\n\u223c\n\nthat E has ordinary good reduction at p and the endomorphism ring of Ep\nis isomorphic to R (cf. Theorem 12 of 13.4 of Lang [6]). Further K(j(E))\nis the ring class field of K of conductor f0 (cf. \u00a79 of Cox [3]). Since p is of\nrelative degree lp, there exist positive integers up and vp such that\n\u221a\n4plp = u2p + mf 2 vp2 , (up + vp f \u2212m)/2 \u2208 R, (up , p) = 1.\n1\n\nResearch supported by Grand-in-Aid for Scientific Research No.12640036\n2000 Mathematics Subject Clasiification 11G05,14H52\nKey words: Elliptic curve, complex multiplication, trace, Frobenius endomorphism.\n\n1\n\n\f\u221a\nBy the assumption, we may write \u03c6p = (ap(E) + bp(E)f \u2212m)/2 = \u03b1 + \u03b2\u03c9,\n\u223c\n\nwhere bp(E), \u03b1 and \u03b2 are integers. It is known that the group Ep(Fplp ) is of\norder Np(E) = plp +1\u2212ap(E) and is isomorphic to the group Z/(Np(E)/d)Z\u2295\nZ/dZ, where d is the greatest common divisor of \u03b1 \u2212 1 and \u03b2. On the\nother hand, if d(R) < \u22124, then we have easily ap(E) = \u01ebpup , where \u01ebp =\n1 or \u2212 1. It is easy to find up for a given number 4plp such that 4plp =\nu2p + mf 2 vp2 , (up , p) = 1. Therefore if we determine \u01ebp, then we can compute\nthe numbers Np(E) and d rapidly. The problem to detemine \u01ebp in the case\nh(R) = 1 has been solved by A.R. Rajwade, A. Joux-F. Morain and others.\nSee A. Joux and F. Morain[5] for the references of their results. In the case\nh(R) = 2, this problem is solved only for one case of the order of discriminant\n\u221220, by F. Lepr\u00e9vost and F. Morain [7], using the results of B.W. Brewer\n[1,2] for the character sum of Dickson polynomial of degree 5.\nThe purpose of this article is to determine \u01ebp for an elliptic curves E\nhaving complex multiplication by R and for prime ideals p of F satisftying\n(1), where R are orders such that h(R) = 2 or 3 and mf 2 is divided by at\nleast one of 3, 4 and 5. Thus R are orders of discriminant\nd(R) = \u2212 15, \u221220, \u221224, \u221232, \u221235, \u221236, \u221240, \u221248, \u221251, \u221260, \u221264, \u221272, \u221275,\n\u2212 99, \u2212100, \u2212108, \u2212112, \u2212115, \u2212123, \u2212147, \u2212235, \u2212243, \u2212267.\n\nFurther we assume that j(E) is real to avoid tedious argument.\nOur idea to solve the problem is as follows (for details see \u00a72). Let s be a\n2\ndivisor\n\u221a of f m and assume s \u2265 3. We find a F -rational cyclic subgroup Cs of\nE[f \u2212m] of order s and take a generator Q of Cs . Consider the Frobenius\nisomorphism of \u03c3p of p. Then F -rationality of Cs shows Q\u03c3p = [rp](Q) for an\n\u223c\n\u221a\ninteger rp. Using Q\u223c \u2208 Ep[f \u2212m] and (Q\u03c3p )\u223c = \u03c6p(Q\u223c ), we have\n[2]([rp](Q))\u223c = [2](Q\u03c3p )\u223c = [2]\u03c6p(Q\u223c )\n\u221a\n= [(ap(E) + bp(E)f \u2212m)](Q\u223c ) = [ap(E)](Q\u223c ).\nThis shows that ap(E) \u2261 2rp mod s. Therefore the number \u01ebp is determined\nby the condition \u01ebpup \u2261 2rp mod s. This argument reduces our original\nproblem to a problem of finding a point Q and of determining rp for a given\nprime ideal p. In \u00a72, we give auxiliary results to find the cyclic sbgroup Cs and\na generator Q. If s is an odd prime number, then we show, in Proposition 3\nof \u00a72, that the s-division polynomial \u03a8s (x, E) of E has a unique F -rational\nfactor H1,E (x) of degree (s \u2212 1)/2 and that the point Q is obtainable from a\n2\n\n\fsolution of H1,E (x) = 0. In \u00a73 we determine rp for the case f 2 m is divided\nby 3 or 4 and in \u00a74 for the case f 2 m is divided by 5. Though we deal with a\nspecified elliptic curve E for each order R, a similar result is easily obtained\nfor any elliptic curve E \u2032 of the j-invariant j(E), because E \u2032 is a quadratic\ntwist of E and ap(E \u2032 ) is the product of ap(E) and the value at p of the\ncharacter corresponding to the twist.\nIn the following, we assume any elliptic curve is defined by a short Weierstrass equation.\n\u221a\n2. The subgroups of E[f \u2212m] and decomposition of division polynomials\n2.1. Let E be an elliptic \u221a\ncurve with complex multiplication by R. By the\ndefinition of f , we have f \u2212m \u2208 R.\n\u221a\nProposition 1. The group E[f \u2212m] is cyclic of order f 2 m.\n\u221a\nProof. \u221a\nBy Proposition 2.1 of Lenstra [8], we know E[f \u2212m] is isomorphic\nto R/f \u2212mR.\nLet f be odd and\n\u221a\n\u221a m \u2261 3 mod 4. Then R2 = Z\u2295f \u03c9Z, where\n\u03c9 = (1 + \u2212m)/2. Further f \u2212mR\n\u221a = f (2\u03c9 \u2212 1)Z \u2295 f (\u03c9 \u2212 (m + 1)/2)Z.\nPut \u03be = f \u03c9 \u2212 f (mf + 1)/2 \u2208 f \u2212mR. Then we have f (2\u03c9 \u2212 1) = 2\u03be +\n2\n2\nmf 2 , f 2 (\u03c9 \u2212\n\u221a \u03be} is\n\u221a(m + 1)/2) = f \u03be + (f \u2212 1)f m/2. This shows that {f m,\na basis of f \u2212mR over Z. Since {1, \u03be} is a basis of R over Z, R/f \u2212mR\nis a cyclic group of order f 2 m. The assertion for the other cases is easily\nobtained.\nLemma 1. Let r be a fixed prime number. Then there exist infinitely many\nprime numbers of the form u2 + v 2 f 2 m, where u and v are integers and v is\nprime to r.\nProof. Consider the ideal groups G0 and P0 of K such that\n\u221a\nG0 = {a | a is prime to 2rf m}, P0 = {(\u03b1) | \u03b1 \u2261 1 mod 2rf \u2212m}.\nThen P0 is a subgroup of G0 of finite index and by Tshebotareff's density\ntheorm, in each factor \u221a\nclass there exist infinitely many prime ideals of degree\n1. Let \u03b3 = u0 + v0 f \u2212m such that ideal (\u03b3) \u2208 G0 and u0 , v0 \u2208 Z and\nfurther v0 is prime to r. Then \u221aevery integral ideal of the class (\u03b3)P0 has a\ngenerator of the form u1 + v1 f \u2212m ( u1, v1 \u2208 Z, r \u2224 v1 ). Thus we have our\nassertion.\nIn the following, let p be an odd prime number and p a prime ideal of F\ndividing p and assume that p and p satisfy the condition (1).\n3\n\n\fLemma 2. Let s be an odd prime number dividing f 2 m. Let q = plp . Assume\nthat q = u2 + v 2 f 2 m, (v, ps) = 1 or 4q = u2 + v 2 f 2 m, (v, 2sp) = 1. Then we\nhave\n\u223c\n\u223c\n\u223c\n\u221a\nEp[s] \u2229 Ep[f \u2212m] \\ {0} = {P = (\u03b1, \u03b2) \u2208 Ep[s] | s \u2224 [Fq (\u03b1) : Fq ]},\n\nwhere [Fq (\u03b1) : Fq ] denotes the degree of the field Fq (\u03b1) over Fq .\n\u223c\n\nProof. By the assumption, Ep is defined over Fq . \u221aFirst we assume the Frobenius endomorphism \u03c6p is given by \u03c6p = (u + vf \u2212m)/2, if necessary, after\n\u223c\n\u223c\n\u221a\nreplacing u by \u2212u or v by \u2212v. Let P = (\u03b1, \u03b2) \u2208 Ep[s]. If P \u2208 Ep[f \u2212m],\nthen, for h = (s \u2212 1)/2, we have \u03c6hp ([2h ](P )) = [uh ](P ). Since 2h , uh \u2261 \u00b11\nmod s, we have \u03c6hp (P ) = \u00b1P . This shows [Fq (\u03b1) : Fq ] \u2264 (s \u2212 1)/2. Conver\u223c\n\nsly let P = (\u03b1, \u03b2) \u2208 Ep[s], s \u2224 k = [Fq (\u03b1) : Fq ] and r = q k . Since \u03c6kp (P ) =\n\u221a\n(\u03b1r , \u03b2 r ) = (\u03b1, \u03b2 r ) = \u01ebP (\u01eb = \u00b11),we have [(u + vf \u2212m)/2)k \u2212 \u01eb](P ) = 0.\n\u223c\n\u221a\nSince P \u2208 Ep[s] and s|f 2 m, we have [(uk \u2212 2k \u01eb) + kuk\u22121vf \u2212m](P ) = 0 and\n[(uk \u2212 2k \u01eb)2 + (kuk\u22121 v)2 f 2 m](P ) = 0. Thus [(uk \u2212 2k \u01eb)2 ](P )\u221a= 0. Since the\norder of P is s, we see [(uk \u2212 2k \u01eb)](P ) = 0 and [kuk\u22121 vf \u2212m](P ) = 0.\nBy the assumption, k, u and v are prime to s. Therefore we conclude\n\u223c\n\u221a\n\u221a\n\u221a\n[f \u2212m](P ) = 0. Hence P \u2208 Ep[f \u2212m]. In the case \u03c6p = u + vf \u2212m, the\nsame argument holds true.\n\u223c\n\n\u223c\n\nCorollary 1. Let \u03a8s (x, Ep) be the s-division polynomial of Ep. Then we\n\u223c\n\nknow \u03a8s (x, Ep) is the product of two Fq -rational polynomials h1 (x) and h2 (x)\nsuch that h1 (x) is of degree (s\u22121)/2 and the degree of every irreducible factor\nof h2 (x) is divided by s. Further the solutions of h1 (x) = 0 consist of all\n\u223c\n\u223c\n\u221a\ndistinct x-coordinates of non-zero points in Ep[s] \u2229 Ep[f \u2212m].\n\n\u223c\n\u223c\n\u221a\nProof. Since p is prime to f 2 m, by Proposition 1, Ep[s] \u2229QEp[f \u2212m] is a Fq rational cyclic group of order s. Thus if we put h1 (x) = \u03b1 (x \u2212 \u03b1), where \u03b1\n\u223c\n\u223c\n\u221a\nruns over all distinct x-coordinates of non-zero points in Ep[s] \u2229 Ep[f \u2212m],\nthen h1 (x) is Fq -rational and of degree (s \u2212 1)/2. The assertion for h2 (x)\nfollows immediately from Lemma 2.\n\nLemma 3. Let 4|f 2 m and q = plp = u2 + v 2 f 2 m, (v, 2) = 1. Let Q1 be\n\u223c\n\u223c\n\u221a\nan point of order 4 of Ep[f \u2212m] and Q2 a point of Ep such that [2](Q1 ) =\n4\n\n\f[2](Q2 ) and Q2 6= \u00b1Q1 . Then the x-coordinates x1 and x2 of Q1 and Q2 are\n\u223c\n\nall Fq -rational solutions of \u03a84 (x, Ep)/y = 0. Furthermore let y 2 = h(x) be\n\u223c\n\u221a\nthe equation of Ep. Assume that \u03c6p = u + vf \u2212m. Then, of two elements\nx1 and x2 , only x1 satisfies the relation (h(x1 )/p) = (\u22121)(u\u22121)/2 ,where ( /p)\ndenotes the Legendre symbol for p.\n\u223c\n\u221a\nProof. Since Ep[f \u2212m] is Fq -rational, we see x1 and x2 are Fq -rational. Let\n\u223c\n\n\u03b1 be a Fq -rational root of \u03a84 (x, Ep)/y = 0 and put S = (\u03b1, \u03b2). Then S is a\n\u223c\n\n4-division point of Ep and we have\n\u221a\n\u03c6p(S) = [u + vf \u2212m](S) = (\u03b1q , \u03b2 q ) = (\u03b1, \u00b1\u03b2) = [\u03b5](S), (\u03b5 = \u00b11).\n\u221a\nThus we have [(u \u2212\u03b5) + vf \u2212m](S) = 0. This shows [(u \u2212\u03b5)\u221a2 + v 2 f 2 m](S) =\n0. Since the order of S is 4, u \u2212 \u03b5 is divided by 2. Thus [f \u2212m]([2]S) = 0.\n\u223c\n\u221a\nSince [2](Q1 ) is the only one point of degree 2 in Ep[f \u2212m], we have [2](S) =\n[2](Q1 ). This shows that S equals to one of \u00b1Q1 and \u00b1Q2 . Therefore \u03b1 equals\n\u223c\n\nto x1 or x2 . Let P = (x, y) be a point of Ep of order 4 such that x \u2208 Fq .\nThen\n\u03c6p(P ) = (xq , y q ) = (x, yh(x)(q\u22121)/2 )\n\n\u221a\n= [(h(x)/p)](P ) = [u](P ) + [vf \u2212m](P ).\n\n\u223c\n\u221a\nTherefore we have (h(x)/p) \u2261 u mod 4 if and only if P \u2208 Ep[f \u2212m].\n2\n2.2. Let s be a positive divisor of f \u221a\nm and s \u2265 3. By Proposition 1,\nthere exists a unique subgroup Cs of E[f \u2212m] of order s. Let Q = (xQ , yQ )\nbe a generator\nof Cs . Consider the fields L = F (xQ ) and M = F (Q).\n\u221a\nSince E[f \u2212m] is F -rational, Cs is F -rational and the field M is an abelian\nextension over F . By class field theory, the Galois group G of M over F is\nisomorphic to an ideal class group G of F . For an ideal class C \u2208 G, let \u03c3C\nbe the isomorphism of G corresponding to C. Then we have\n\nTheorem 1. Let C be the class represented by p and Q\u03c3C = [rC](Q). Then we\nhave ap(E) \u2261 2rC mod s. Further if ap(E) is even, then we have ap(E)/2 \u2261\nrC mod s.\n\n5\n\n\f\u221a\nProof. Let \u03c6p = (ap(E) + bp(E)f \u2212m)/2. Since (Q\u03c3C )\u223c = \u03c6p(Q\u223c ), we see\n[2]([rC](Q))\u223c = [2](Q\u03c3C )\u223c = [2]\u03c6p(Q\u223c )\n\u221a\n= [(ap(E) + bp(E)f \u2212m)](Q\u223c ) = [ap(E)](Q\u223c ).\n\nSince p is prime to s, Q\u223c is of order s. Thus\n\u221a ap(E) \u2261 2rC mod s. If ap(E)\nis even, then \u03c6p = (ap(E)/2) + (bp(E)/2)f \u2212m. By a similar argument we\nhave [ap(E)/2](Q\u223c ) = [rC](Q). This shows the remaining assertion.\nProposition 2. Let s be an odd prime number of f 2 m. If plp \u2261 1 mod s,\nthen\n2\nap(E) \u2261 2(yQ\n/p) mod s\n.\n\nProof. Since we have 4plp = ap(E)2 + bp(E)2 f 2 m, Theorem 1 shows that\nrC \u2261 \u00b11 mod s. Thus x\u223c\nQ \u2208 Fq . By the similar argument in the last part\nof Lemma 3, we have our assertion.\nProposition 3. Let s be an odd prime divisor of f 2 m and \u03a8s (x, E) the sdivision polynomial of E. Then \u03a8s (x, E) is the product of two F -rational\npolynomials H1,E (x) and H2,E (x) such that H1,E (x) is of degree (s \u2212 1)/2 and\nevery irreducible factor of H2,E (x) is of degree s. Further the solutions of\nH1,E (x) = 0 consist of all distinct x-coordinates of non-zero points of Cs .\nY\nProof. Let H1,E (x) =\n(x \u2212 t), where t runs over all distinct x-coordinates\nt\n\nof non-zero points of Cs . Since Cs is F -rational, we see H1,E (x) is F -rational\nof order (s\u22121)/2 and clearly it divides \u03a8s (x, E). By Lemma 1, we can choose\nan odd prime p and a prime ideal p dividing p such that they satisfy (1) and\np is of the form p = u2 + v 2 f 2 m, (v, s) = 1, and further the reduction of\n\u223c\n\n\u03a8s (x, E)\n\u221a modulo p is equal to \u03a8s (x, Ep). Take\u221aa point P \u2208 E[s] \\ Cs and put\nQ = [f \u2212m](P ). Clearly, we have Q \u2208 E[f \u2212m] and E[s] =< P > \u2295 <\nQ >. Let G1 be the Galois group of F (E[s]) over F . By the representation\nof G1 on E[s] with the basis {P, Q}, G1 is identified with a subgroup of the\ngroup\n\u0013\n\u001a\u0012\n\u001b\na 0\n\u00d7\nG0 =\na \u2208 Fs , b \u2208 Fs .\nb \u00b1a\nConsider the subgroups of G0 :\n\u0013\n\u001b\n\u0013\n\u001b\n\u001a\u0012\n\u001a\u0012\n1 0\na 0\n\u00d7\nb \u2208 Fs .\na \u2208 Fs , N =\nH=\nb 1\n0 \u00b1a\n6\n\n\fThen we see G0 = HN, G0 \u22b2 N and H \u2229 N = {12 }, where 12 is the unit\nmatrix. Since the order of N is s and s is prime, we know that G1 \u2283 N or\nG1 \u2229 N = {12 }. Let \u03a9 be the set of all subgroups of order s of E[s]. Then\n\u03a9 consists of s + 1 elements and G1 operates on \u03a9. By Corollary 1, the\ndegree of every irreducible factor of H2,E (x) = \u03a8s (x, E)/H1,E (x) is divided\nby s. Thus we know Cs is one and the only one fixed point of G1 . First\nlet us consider the case G1 \u2283 N. Then we have G1 = H1 N, H1 = H \u2229 G1 .\nSince H1 is the fixed subgroup of < P >, the orbit of < P > consists of s\nelements. Therefore \u03a9 decomposes into two orbits. In particular, for each\nn, 1 \u2264 n \u2264 (s \u2212 1)/2, the x-coordinate of [n]P has s conjugates over F .\nThus every irreducible factor of H2,E (x) is of degree s. Next consider the\ncase G1 \u2229 N = {12 }. Then the order of\nis a divisor of 2(s \u2212 1) and is\n\u0012 G1 \u0013\na 0\nprime to s. Since the order of a matrix\n, (b 6= 0) is divided by s, G1\nb a\ndose not contain the matrices of this form. Therefore there exists a \u03bb \u2208 Fs\nsuch that G1 is contained in the subgroup\n\u0013\n\u001d\n\u001c \u0012\n1 0\n\u00d7\n\u03b1 \u2208 Fs .\n\u03b1,\n\u03bb \u22121\nThis shows < P + (\u03bb/2)Q > is a fixed point. Thus we have a contradiction.\n\u221a\nProposition 4. Let 4|f 2 m. If Q is a point of order 4 in E[f \u2212m] and T is\na poinf of E such that [2](Q) = [2](T ) and T 6= \u00b1Q, then the x-coordinates\nxQ and xT of Q and T are all F -rational solutions of \u03a84 (x, E)/y = 0.\nProof. Using Lemma 3 instead of Lemma 2 and tracing the argument in the\nfirst part of Proposition 2, we have the assertion.\nIn \u00a74, to study the ideal class groups of F corresponding to the fields L\nand M, we must determine conductors fL and fM of abelian extensions L and\nM over F . In next lemma, we shall give some results for the conductors. For\na prime ideal q and an integral ideal a of F , we denote by eq(a) the maximal\ninteger m such that m \u2265 0 and qm dividing a.\nLemma 4. Let Q be a point of E of order s. Assume that s is an odd\nprime number, s > 3 and Q generates a F -rational subgroup < Q >. Let\nL, M, fL and fM be as above. If q is a prime ideal of F prime to (2s), then\neq(fL ) \u2264 eq(fM ) and eq(fM ) > 0 implies eq(fL ) > 0. Further if E has good\nreduction at q, then eq(fM ) = 0.\n7\n\n\fProof. Since L is a subfield of M, we have eq(fL ) \u2264 eq(fM ). If E has good\nreduction at q, then N\u00e9ron-Ogg-Shafarevich criterion (cf.Proposition 4.1 of\nVII of Silverman [10]) shows that eq(fM ) = 0. We shall prove eq(fM ) > 0\nimplies eq(fL ) > 0. Assume that eq(fM ) > 0 and eq(fL ) = 0, thus, assume\nthat q is ramified in M and is unramified in L. Let Q be a prime ideal of M\ndividing q and MQ the completion of M with respect to Q. Further we denote\n\u223c\n\nby kM the residue field of Q. Let E0 , E1 and E ns be the groups defined in VII\nof Silverman [10]. Since E has additive reduction at q, by Theorem 6.1 of VII\nof [10] we have [E(MQ) : E0 (MQ)] = w \u2264 4. Since Q has order s, by replacing\nQ by [w]Q if necessary, we can assume that Q \u2208 E0 (MQ). Let \u03c3 be a non\ntrivial element of inertia group of Q. Then since x\u03c3Q = xQ , we have Q\u03c3 = \u2212Q.\nBy considering the reduction modulo q, we have Q\u223c = \u2212Q\u223c . Therefore\n\u223c\n\nQ\u223c \u2208 E ns (kM ) and [2](Q\u223c ) = 0. Since the characteristic of kM is prime to\n2, Proposition 5.1 of VII of [10] shows Q\u223c = 0. Therefore by Proposition 2.1\nof VII of [10] , we know Q \u2208 E1 (MQ). Consequently, by Proposition 3.1 of\nVII of [10], we have Q = 0. This contradicts that Q 6= 0.\nFinally for s = 3, 4, 5, we list s-division polynomials \u03a8s (x, E):\n\uf8f1\n\u03a83 (x, E)\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u03a84 (x, E)\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\u03a8 (x, E)\n5\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n\n= 3x4 + 6Ax2 + 12Bx \u2212 A2 ,\n= 2y(2x6 + 10Ax4 + 40Bx3 \u2212 10A2 x2 \u2212 8ABx \u2212 16B 2 \u2212 2A3 ),\n= 5x12 + 62Ax10 + 380Bx9 \u2212 105A2 x8 + 240ABx7\n\u2212(300A3 + 240B 2 )x6 \u2212 696A2 Bx5 \u2212 (125A4 + 1920AB 2 )x4\n\u2212(1600B 3 + 80BA3 )x3 \u2212 (50A5 + 240A2B 2 )x2\n\u2212(640AB 3 + 100A4 B)x + A6 \u2212 32B 2 A3 \u2212 256B 4 .\n\n3. The case f 2 m is divided by 3 or 4\n\n2\nLet\n\u221a s = 3 or 4. Assume that s|f m. Let Q = (xQ , yQ ) be a point of\nE[f \u2212m] of order s . By Propositions 2 and 3, we know xQ \u2208 F . We may\n2\nwrite yQ\n= w 2 \u03b1E such that w \u2208 F \u00d7 , \u03b1E is an integer of F and ideal(\u03b1) has\nno square factors. In the following, let p be an odd prime number and p a\nprime ideal of F dividing p and assume they satisfy the condition (1). Then\nthere exist positive integers up and vp such that 4plp = u2p + mf 2 vp2 , (up +\n\u221a\nvp f \u2212m)/2 \u2208 R, (up , p) = 1. If up is even, then clearly we have plp =\n(up /2)2 + mf 2 (vp /2)2 .\n\n8\n\n\fTheorem 2. Let up and vp be as above. If we choose \u01ebp \u2208 {\u00b11} such that\n\u01ebp(up /2) \u2261 (\u03b1E /p) mod s, then we have ap(E) = \u01ebpup .\n\u221a\nProof. Since F (Q) = F ( \u03b1E ), we have Q\u03c3p = [(\u03b1E /p)](Q). Thus by Theorem 1, we have our assertion. It is noted that up can be odd only in the case\ns = 3.\nLet E0 be an elliptic curve defined by a Weierstrass equation: y 2 = x3 +\nA0 x + B0 (A0 , B0 \u2208 F ). If E0 is isomorphic to E over an extension F0 over\nF , then there exists an element \u03b4 \u2208 F0 such that A0 = \u03b4 4 A, B0 = \u03b4 6 B.\nSince j(E) 6= 0, 1728, we know that A, B, A0 and B0 are not 0 and \u03b4 2 \u2208 F .\nTherefore we may put \u03b1E0 = \u03b4 2 \u03b1E . In particular we obtain\nTheorem 3. Let E \u2217 be the twist of E defined by the equation y 2 = x3 +\n2\n3\nA\u03b1E\n+ B\u03b1E\n. Further assume that E \u2217 has good reduction at p. Let up and vp\nbe as above. If we choose \u01ebp \u2208 {\u00b11} such that \u01ebp (up /2) \u2261 1 mod s, then we\nhave ap(E \u2217 ) = \u01ebpup .\nThe j-invariants of elliptic curves with complex multiplication by R are\nsolutions of the class equation H|d(R)| (x) = 0 of discrimint d(R) (cf. \u00a713 of\nCox [3] for the class equations). In the following, we shall use the table of\nclass equations prepared by M.Kaneko. We shall gives a canonical elliptic\ncurve E with complex multiplication by R and compute \u03b1E in subsections\n3.1 and 3.2 for the cases s = 3 and 4 respectively.\n3.1. The case s = 3\nWe shall explain the process to obtain a canonical elliptic curve E \u221a\nin the\ncase d(R) = \u221215. At first we take a solution j1 = (\u2212191025 + 85995 5)/2\nof the equation:\nH15 (x) = x2 + 191025x \u2212 121287375 = 0.\nLet E1 be the elliptic curve defined by the equation:\ny 2 = x3 +A1 x+B1 , A1 = \u22121/48\u221236/(j1 \u22121728), B1 = 1/864+2/(j1 \u22121728).\nThen the\u221aj-invariant of E1\u221ais equal to j1 . By considering twists of E1 by\nelements n, n \u2208 F = Q( 5), we find an elliptic curve E such that coefficients A and B of an equation y 2 = x3 + Ax + B of E are integers of F and\nfurther the absolute value of the norm of the square factor of A is as small\n9\n\n\f\u221a\n\u221a\n\u221a\n2\nas possible. In this case, we take\nn\n=\n2\n37(4\n+\n5)/(\n5(4\n\u2212\n\u221a 5)). Therefore\n\u221a\n3\n2\nwe see A = A1 n = 105 + 48 5, B = B1 n = \u2212784 \u2212 350 5 and\n\u221a\n\u221a\n\u221a\n\u221a\n\u03a83 (E, x) = 3(x3 +6x2 +3 5x2 +(291+132 5)x+590+265 5)(x\u22126\u22123 5).\n\u221a\n\u221a\n2\nThis shows xQ = 6 + 3 5 and yQ\n= 24 ((1 + 5)/2)11 . Finally we have\nProposition 5. Let E be the elliptic curve defined by the equation\n\u221a\n\u221a\ny 2 = x3 + (105 + 48 5)x \u2212 784 \u2212 350 5.\nThen E has complex\u221amultiplication by the order of discriminant \u221215. Further\nwe have \u03b1E = (1 + 5)/2.\n\u221a\nNote 1. For another root j2 = (\u2212191025 \u2212 85995 5)/2 of H15 (x) =\u221a0, we\nconsider the conjugate elliptic curve E of E over Q and put \u03b1E = (1\u2212 5)/2.\nExample 1.\n(1) Let p = 61. Then (\u221215/p)\n\u221a = (5/p) = 1. Thus lp = 1. Choose the\nprime ideal p such that p \u220b 5 \u2212 26. Since (\u03b1E /p) = (54/61) = \u22121 and\n4p = 22 + 42 15, ap(E) = \u22122.\n(2) Let p = 83. Then (\u221215/p) = 1, (5/p) = \u22121. Thus lp = 2. Since\n(\u03b1E /(p)) = \u22121 and 4p2 = 1542 + 162 * 15, a(p) = 154.\nFor other cases, we give only results and deta nacessary to obtain the\nresults. For each order R, the data consits of the class polynomial H|d(R)| (x),\na solution j of H|d(R)| = 0, coefficients A and B of a Weierstrass equation\n2\nof an elliptic curve E with j(E) = j, xQ , yQ\nand \u03b1E . We list them in the\nfollwing format:\nd(R)\n\nH|d(R)| (x)\nj\nA, B\n2\nxQ , yQ\n\u03b1E\n\n10\n\n\fThe results and data for the case h(R) = 2\n\u221224\nx2 \u2212 4834944x + 14670139392\n\u221a\n2417472\n+\n1707264\n2\u221a\n\u221a\n\u221221 +\n2\n\u221a 12 2, \u2212\u221a28 6+ 22 \u221a\n\u22123 + 3 2, 2(1 \u2212\u221a 2) (1 + 2)\n1+ 2\n2\n\u221236\nx \u2212 153542016x \u2212 1790957481984\n\u221a\n76771008\u221a+ 44330496 \u221a\n3\n\u2212120\u221a\u2212 42 3, \u221a\n448 + 336\u221a3\n3 + 3 3, 4(2 +\u221a 3)2 (1 + 3)\n1+ 3\n2\n\u221248\nx \u2212 2835810000x + 6549518250000\n\u221a\n1417905000\n+\n818626500\n3\u221a\n\u221a\n\u22121035\n\u221a \u2212 240 \u221a3, 12122 +\n\u221a5280 3 \u221a\n\u22129 + 18 3, 4(2 \u2212 3)4\u221a\n(1 \u2212 2 3)2 (8 + 6 3)\n8+6 3\n2\n\u221251\nx + 5541101568x + 6262062317568\n\u221a\n\u22122770550784\n\u2212\n671956992\n\u221a\n\u221a17\n\u221260 \u2212 12 17, \u2212 210\n\u2212\n56\n\u221a 2 17\n\u22126, \u2212 2(4 \u2212 17)\n\u22122\n2\n\u221260\nx \u2212 37018076625x + 153173312762625\n\u221a\n(37018076625\u221a+ 16554983445 5)/2\n\u221a\n(\u2212645 + 201\n\u221a 5)/2, 1694 \u2212\n\u221a924 516\n\u2212(45 \u2212 15 5)/2, \u2212 ((1 \u2212 5)/2)\n\u22121\n\u221272\nx2 \u2212 377674768000x + 232381513792000000\n\u221a\n188837384000\n\u221a + 77092288000 \u221a6,\n\u2212470 \u2212\u221a360 6, 19208\n\u221a 2+ 10080\n\u221a 6\n6 + 9 6, 4(5 \u2212 \u221a\n2 6) (2 + 6)\n2+ 6\n\u221275\nx2 + 654403829760x + 5209253090426880\n\u221a\n\u2212327201914880\n+\n146329141248\n\u221a\n\u221a5\n\u22122160 + 408 5,\u221a42130 \u2212\u221a10472 5 \u221a\n\u221a\n2\n14\n\u2212(15 + 21 5), (\u221225 \u2212 13 5)(4\n\u221a\u2212 5) ((1 + 5)/2))\n\u221225 \u2212 13 5\n11\n\n\fx2 + 37616060956672x \u2212 56171326053810176\n\u221a\n\u221218808030478336\n+\n3274057859072\n33\n\u221a\n\u221a\n\u221245012 + 7836 33, \u2212\u221a5198438 + 904932 33\n\u2212(87 \u2212 15 33), \u2212 2,\n\u22122\n6\n\u2212123\nx2 + 1354146840576 * 103 x + 148809594175488\n\u221a * 10\n\u2212677073420288000\n\u221a + 105741103104000\n\u221a 41\n\u2212960 + 120 41, \u2212 13314\n41\n\u221a + 2240\n2\n\u221224, \u2212 2(32 + 5 41)\n\u22122\n2\n3\n6\n\u2212147\nx + 34848505552896 * 10 x + 11356800389480448\n\u221a * 10\n\u221217424252776448000\n+ 3802283679744000\n\u221a\n\u221a 21\n\u22122520 \u2212\u221a240 21, \u221a\n\u2212 31724 \u2212\u221a\n11418 21\n63 + 9 21, (7 \u2212 \u221a\n21)((5 + 21)/2)8\n7 \u2212 21\n2\n6\n6\n\u2212267 x + 19683091854079488 * 10 x + 531429662672621376897024\n\u221a * 10\n\u22129841545927039744000000\n89\n\u221a + 1043201781864732672000\n\u221a\n\u221237500 + 3180 89, 3250002\n\u2212\n371000\n89\n\u221a\n150, 2(500 + 53 89)2\n2\n\u221299\n\nThe results and data for the case h(R) = 3\n\u2212108\nx3 \u2212 151013228706 * 103 x2 + 224179462188 * 106 x\n\u2212 1879994705688\n* 109\n\u221a\n\u221a\n3\n3\n31710790944000\n4 + 39953093016000\n2 + 50337742902000\n\u221a\n\u221a\n\u221a\n\u221a\n3\n3\n3\n3\n105 4 \u2212 90 \u221a\n2 \u2212 135, \u2212\u221a738 4 + 738\n2 + 526\n\u221a\n3\n3\n3\n8\n9 \u2212 3 2, 4(1 \u2212 \u221a2) (\u22121 + 2)\n\u22121 + 3 2\n\u2212243 x3 + 1855762905734664192 * 103 x2 \u2212 3750657365033091072 * 106 x\n+3338586724673519616 * 109\n\u221a\n3\n\u2212618587635244888064000 \u2212 428904711070941184000\n3\n\u221a\n3\n\u2212297385917043138560000\n9\n\u221a\n\u221a\n\u221a\n3\n3\n\u22121560 + 720\u221a3 9, 32258 \u2212\n11124\n3\n\u2212\n7704\n9\n\u221a\n\u221a\n3\n3\n3\n8\n42 \u2212 18 9, (\u22122 + \u221a9) (\u22124 + 2 9)\n\u22124 + 2 3 9\n\n12\n\n\f3.2. The case s = 4\nIn this case, by Lemma 3 and Proposition 4, we know that xQ is one\nof two F -rational solutions of \u03a84 (x, E)/y = 0 satisfying the condition given\nin the last part of Lemma 3. We shall explain\nthe case d(R) = \u221232. We\n\u221a\ntake a solution j = 26125000 + 18473000 2 of H32 (x) = x2 \u2212 52250000x +\n12167000000 = 0 and consider an elliptic curve E with j(E) = j, defined by\nan equation:\n\u221a\n\u221a\ny 2 = x3 + Ax + B (A = \u2212105 \u2212 90 2, B = 630 + 518 2).\n\u221a\n\u221a\nThen \u03a84 (x, E)/y = 0 has two F -rational solutions x1 = 3+5 2, x2 = 9\u2212\u221a 2.\nConsider a prime number p = 17 = 32 + 22 2 and a prime ideal p = (1 \u2212 3 2).\n\u223c\n\nThen by counting the number of points\nof Ep(Fp ), we know ap(E) = \u22126.\n\u221a\n(ap (E)/2\u22121)\n3\n,\nSince (x1 + Ax1 + B/p) = (\u22123 + 3 2/p) = (\u22122/17) = 1 = (\u22121)\n\u221a\n2\nwe see xQ = x1 . Calculating yQ , we may obtain \u03b1E = \u22123 + 3 2. For the\ncases d(R) = \u221264, \u2212112, we know the class polynomials are:\n(\nH64 (x) = x2 \u2212 82226316240x \u2212 7367066619912,\nH112 (x) = x2 \u2212 274917323970000x + 1337635747140890625.\nIn these cases by similar argument we have (E, \u03b1E ). We list our results in\nthe next propositon.\nProposition 6.\nd(R)\n\u221232\n\u221264\n\u2212112\n\nj(E)\n\nA\nB\n\u221a\n\u221a\n26125000 + 18473000 2\n\u2212105 \u2212 90\u221a 2\n\u221a 630 + 518\u221a 2\n41113158120 + 29071392966 2 \u221291 \u2212 60 \u221a2\n462 + 308 \u221a\n2\n137458661985000\n\u2212725 \u2212 240 \u221a7\n\u221a\n+ 51954490735875 7\n9520 + 3698 7\n\n\u03b1E\n\u221a\n\u22123 + 3 2\n\u221a\n\n2\u22121\n\n1\n\n4. The case mf 2 is divided by 5\nWe shall consider the orders R of discriminant d(R) = \u221220,\u221235,\u221240,\n\u2212115, \u2212235. These orders R are maximal and of class number 2. Further\n13\n\n\f\u221a\nfor any R, we know F = Q( 5). For a given order R, we consider an elliptic\ncurve E, defined over F , with complex multiplication by R. Proposition 3\nshows that \u03a85 (x, E) has only one F -rational factor H1,E (x) of degree 2 and\nfor any solution x1 of H1,E (x) = 0, a point Q of E with xQ = x1 is a generator\nof the group C5 . Let L = F (xQ ) and M = F (Q). For a prime number p\nsatisfying plp \u2261 1 mod 5, our problem is rather easy (cf. Proposition 2).\nFor a prime number p satisfying plp \u2261 4 mod 5 and a prime ideal p dividing\np, to determine rp, we must study the ideal class groups of F corresponding\nto the fields L and M. Regarding conductors of L and M, we have a following\nresult. In Proposition 7, we shall use the notation in \u00a72.\n\u221a\nProposition 7. Let q be a prime ideal of F prime to (2 5). Then eq(fL ) =\neq(fM ) and eq(fM ) \u2264 1. Further if E has good reduction at q, then eq(fM ) = 0.\nProof. Since M is a cyclic extension of degree 4 over F , we have eq(fM ) \u2264 1\n(cf. Serre [9]). The other assertions are deduced from Lemma 4.\n\u221a\nAs for the prime ideal ( 5), we have e(\u221a5) (fL ) \u2264 e(\u221a5) (fM ) \u2264 1. Proposition 7 shows, to avoid tedious computation in determining class groups,\nit is necessary to choose an elliptic curve E such that the number of prime\nfactors of its discriminant is as small as possible. We shall explain the case\nd(R) = \u2212235, because the other cases can be deduced from similar but much\neasier argument. We have\nH235 (x) = x2 + 82317741944942592 * 104 x + 11946621170462723407872 * 103 .\nFirst we take a solution\n\u221a\nj = \u2212411588709724712960000 \u2212 184068066743177379840 5\nof H235 (x) = 0.\n2\n3\nWe consider \u221aan elliptic curve E defined\n\u221a by an equation: y = x +\n(\u221215510 + 2068 5)x + (3200841 \u2212 649446 5)/4. The discriminant of E\nis 473 2\u22124 e\u221242 , j(E) = j and\n\u221a\n\u221a\nH1,E (x) = 10x2 + (3525 \u2212 2115 5)x + 624160 \u2212 262918 5,\n\u221a\nwhere e = (1 + 5)/2. By solving the equation H1,E (x) = 0, we obtain a\ngenerator Q of C5 given by\n\u221a\nxQ = 3e\u22121 t + 47e\u221210 /2, yQ = (2 5e10 )\u22121 \u03c0\n14\n\n\fq\np \u221a\n\u221a\n\u22121\n, where t = 47 5e and \u03c0 = 47e\u22121 (2115 \u2212 (211 + 23 5)t). In particular we have L = F (t) and M = L(\u03c0). Next we shall determine conductors\nand ideal class groups of L and M. Since the maximal order of L has a basis\n{1, (1 + e\u22121 t)/2} over the maximal order\n\u221a of F , the discrimant of L over F\n\u22121 2\nis (e t) . This shows that fL = (47 5). Since M is real and a conjugate\n\u221a\nfield of M over Q is imaginary, Proposition 7 shows fM = (2k * 47 5)\u221e2 ,\nwhere k \u2208 Z, 0 \u2264 k \u2264 2 and \u221e2 is the infinite place of F corresponding\nto the conjugate embedding of F to Q. We have only to determine the 2exponent k. See \u00a73 of Hiramatsu and Ishii [4] for a method to calculate the\n2-exponent\nof conductors. For a moment, we assume M is \u221a\ndefined modulo\n\u221a\n(4*47 5)\u221e2 . Let P be the ray class group of F modulo (4*47 5)\u221e2 . Denote\nby PL and PM the subgroups of P corresponding to L and M respectively.\nConsider\n\u221a the ideal classes\n\u221a g, k and l of P represented by the principal ideals\n((1 + 3 5)/2), (46 + 47 5) and (471) respectively. Then we see g is of order\n276 and both k and l are of order 2. Further we have:\nP =< g > \u00d7 < k > \u00d7 < l >\n\n(a direct product).\n\u221a\n\nLet P1 be the ray class group modulo (47 5) and \u03b8 the canonical morphism\nof P to P1 . Then P1 is a cyclic group\u221agenerated by \u03b8(g) of order 138 and\nKer(\u03b8) =< g 138 , k, l >. Since fL = (47 5), PL \u2283 Ker(\u03b8). This shows that\nPL =< g2 , k, l >. Next we shall determine PM . Let \u03be be the homomorphism\nof P to itself defined by \u03be(a) = a69 . Then \u03be induces an isomorphism of P/PM\nto \u03be(P)/\u03be(PM ). Consider the prime numbers q1 = 251 = 42 +235, q2\u221a= 431 =\n2\n142 + 235\n\u221a and q3 = 239 = 2 +\n\u221a 235 and prime ideals q1 = (16 + 5), q2 =\n((43+5 5)/2) and q3 = ((31+ 5)/2) of F dividing q1 , q2 and q3 respectively.\nIn the following, for a prime ideal q of F , we denote by C(q) the class of P\nrepresented by q69 . Then we know C(q1 ), C(q2 ) and C(q3 ) belong to kl, k\nand \u03be(g)k respectively. By counting the number of rational points of the\nreduced elliptic curve of E modulo qi , we have aq1 (E) = \u22128, aq2 (E) = \u221228\nand aq3 (E) = \u22124. Therefore, by Theorem 1, we know k, l \u2208 PM and the class\n\u03be(g)k corresponds to the isomorphism \u03bb such that Q\u03bb = [3](Q). Since PM is a\nsubgroup of PL of index 2, we conclude that PM =< g4 , k, l >. In particular,\nPM does not contain the kernel < g138\n\u221a of P\n\u221ak, l > of the canonical morphism\nto the ray class group modulo (2 * 47 5)\u221e2 . Therefore fM = (4 * 47 5)\u221e\n\u221a 2.\nWe know the class m = \u03be(g) is represented by the ideal (743 + 756 5).\nConsequently we have\nTheorem 4. Let k, l and m be the classes of P represented by the ideals\n15\n\n\f\u221a\n\u221a\n(46 + 47 5), (471) and (743 + 756 5) respectively. Put S =< m, k, l > and\nD =< k, l >. Let p be an odd prime number and p a prime ideal of F dividing\np and assume that they satisfy (1). Furthermore, let up and vp be the positive\nintegers such that 4plp = u2p + 235vp2 and (up , p) = 1. If the class C(p) of p69\nbelongs to mi D (0 \u2264 i \u2264 3), and \u01ebp \u2208 {\u00b11} is chosen such that \u01ebpup \u2261 2 * 3i\nmod 5, then we have ap(E) = \u01ebpup .\nNote 2. C(p) \u2208 D \u222a m2 D if and only if plp \u2261 1 mod 5.\n\n\u221a\nExample 1. (i) Let p = 239 = 22 + 235 and p = ((31 + 5)/2). Then\nC(p) = mk \u2208 mD and ap(E) = \u22124.\n\u221a\n(ii) Let p = 241 = (272 + 235)/4 and p = ((33 + 5 5)/2). Then C(p) =\nl \u2208 D and ap(E) = 27.\n\u221a\n(iii) Let p = 719 = 222 + 235 and p = ((59 + 11 5)/2). Then C(p) = m3 kl \u2208\nm3 D and ap(E) = 44.\nWeqshall give the data and results for other cases. In the below, put\n\u221a\ntm = m/( 5e) and denote by P the ray class group of conductor fM of F .\nFurther, we denote by p and p an odd prime number and a prime ideal of F\ndividing p such that they satisfy the condition (1) for the given elliptic curve\nE.\n(I) The case m = 5, d(R) = \u221220\n\u221a\n\uf8f1\n2\n5,\nH\n(x)\n=\nx\n\u2212\n1264000x\n\u2212\n681472000,\nj(E)\n=\n632000\n+\n282880\n\uf8f4\n20\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\n100/3 + 280 5/27,\n\uf8f4\n\uf8f2A = \u221250/3 \u2212 5 5, B =\np\n\u221a\n2\nxQ = 5e /6 + tm , y\u0010\n1 + t\u22121\nQ = ( 5)(e\u0011+ tm )\nm ,\np\n\u221a\n\u221a\n\uf8f4\n\uf8f4\n\u22121 , f = (4 5), f\n\uf8f4\nL = F (tm ), M = L\n1 + tm\n\uf8f4\nL\nM = (8 5),\n\uf8f4\n\uf8f4\n\uf8f3\nP =< g1 > \u00d7 < g2 >, PL =< g21 , g2 >, PM =< g21 g2 >,\n\nwhere g\u221a1 and g2 are the classes\n\u221a of order of 4 and 2 represented by the ideals\n((21 + 5)/2) and (11 + 2 5).\nProposition 8. Let up and vp be the positive integers such that plp = u2p +\n5vp2 , (up , p) = 1. Choose \u01ebp \u2208 {\u00b11} such that \u01ebpup \u2261 2i mod 5 if the class\nof p belongs to gi1 PM (0 \u2264 i \u2264 3). Then we have ap(E) = 2\u01ebpup .\n16\n\n\fChoosing a suitable generator of p, p is written in a form p = a2 \u2212 5b2 ,\nwhere a and b are integers satisfying the condition:\n(\n17 mod 20\nif p \u2261 4 mod 5\na\u2261\n1 mod 20\nif p \u2261 1 mod 5,\n(\n2 mod 4\nif p \u2261 5 mod 8\nb\u2261\n0 mod 4\nif p \u2261 1 mod 8.\nFor i = 1, 2, let pi = a2i \u2212 5b2i be the prime numbers\nrepresented\u221a as above.\n\u221a\nIf p1 \u2261 p2 mod 40, then prime ideals (a1 + b1 5) and (a2 + b2 5) belong\nto the same class of P if and only if a1 \u2212 a2 + 5(b1 \u2212 b2 ) \u2261 0 mod 40. Let\nT =< g21 >. Then we see if p \u2261 1 \u221a\n(resp. 9, 21, 29) mod 40, then the class\nC(p) of the prime ideal p = (a + b 5) belongs to T, (resp. g2 g1 T, g2 T, g1 T)\nand furthermore C(p) \u2208 PM if and only if a+5b \u2261 1(resp. \u22123, 11, 7) mod 40.\nTherefore we have\nProposition 9. Let p = u2 + 5v 2 = a2 \u2212 5b2 , where u and b are positive\nintegers and a and b are integers satisfying the above condition. Then if we\nchoose \u01ebp \u2208 {\u00b11}such that\n\uf8f1\n(\u22121)(a+5b\u22121)/20 a mod 5\nif p \u2261 1 mod 40,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2(\u22121)(a+5b+3)/20 a mod 5\nif p \u2261 9 mod 40,\n\u01ebpu \u2261\n(a+5b\u221211)/20\n\uf8f4\n(\u22121)\na mod 5\nif p \u2261 21 mod 40,\n\uf8f4\n\uf8f4\n\uf8f3\n(a+5b\u22127)/20\n(\u22121)\na mod 5\nif p \u2261 29 mod 40,\nthen we have ap(E) = 2\u01ebpu.\n\n(II) The case m = 35, d(R) = \u221235\n\uf8f1\n\uf8f4\nH35 (x) = x2 + 117964800x \u2212 134217728000,\n\uf8f4\n\uf8f4\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\nj(E) = \u221258982400 \u2212 26378240 5,\n\uf8f4\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\nA = \u221270 5/3, B = (13475 + 980 5)/108,\n\uf8f4\n\uf8f4\nq\u221a\n\uf8f4\n\u221a\n\uf8f2\n2\n2\n2\n5 \u2212 (9 + 5)(etm )\u22121 ,\nxQ = (35e \u2212 3tm )/6e , yQ = (tm /2e )\n\u0012q\n\u0013\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\nL = F (tm ), M = L\n5 \u2212 (9 + 5)(etm )\u22121 ,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\nfL = (7 5), fM = (14 5\u221e2 ),\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\nP =< h >, PL =< h2 >, PM =< h4 >,\n17\n\n\fwhere h is the class of order 12 represented by the ideal (6 +\n\n\u221a\n\n5) .\n\nProposition 10. Let up and vp be the positive integers such that 4plp =\nu2p + 35vp2 , (up , p) = 1. Choose \u01ebp \u2208 {\u00b11} such that \u01ebpup \u2261 2 * 3i mod 5 if\nthe class of p belongs to hi PM (0 \u2264 i \u2264 3). Then we have ap(E) = \u01ebpup .\n(III) The case m = 10, d(R) = \u221240\n\uf8f1\n\uf8f4\nH40 (x) = x2 \u2212 425692800x + 9103145472000,\n\uf8f4\n\uf8f4\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\nj(E) = 212846400 + 95178240 5,\n\uf8f4\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\nA\n=\n\u2212125\n+\n15\n5,\nB\n=\n\u2212200\n+\n240\n5,\n\uf8f4\n\uf8f4\nq\n\uf8f4\n\u221a\n\uf8f2\nxQ = (10e + tm )/e2 , yQ = 2e\u22122 tm 15e\u22121 + (40 \u2212 11 5)t\u22121\nm ,\n\u0012q\n\u0013\n\uf8f4\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\n15e\u22121 + (40 \u2212 11 5)t\u22121\nL = F (tm ), M = L\n,\n\uf8f4\nm\n\uf8f4\n\uf8f4\n\uf8f4\np\n\u221a\n\uf8f4\n\uf8f4\nfL = (8 5), fM = (16 5)\u221e2 ,\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\nP =< g > \u00d7 < h > \u00d7 < l >, PL =< g2 , h, l >, PM =< h, l >,\n\nwhere\u221ag, h and l are\n\u221a the classes of order\n\u221a 4, 4 and 2 represented by the ideals\n(6 + 5),((53 + 3 5)/2) and ((37 + 7 5)/2) respectively.\nProposition 11. Let up and vp be the positive integers such that plp =\nu2p + 10vp2 , (up , p) = 1. Choose \u01ebp \u2208 {\u00b11} such that \u01ebpup \u2261 2i mod 5 if the\nclass of p belongs to gi PM (0 \u2264 i \u2264 3). Then we have ap(E) = 2\u01ebpup .\n(IV) The case m = 115, d(R) = \u2212115\n\uf8f1\nH115 (x) = x2 + 427864611225600x + 130231327260672000,\n\uf8f4\n\uf8f4\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\nj(E) = \u2212213932305612800 + 95673435586560 5,\n\uf8f4\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\n5,\nB\n=\n\u2212(19573\n+\n5290\n5)/4,\nA\n=\n\u2212345\n\u2212\n23\n\uf8f4\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\n3\n4\n\uf8f4\n5tm + e )/10,\n\uf8f2xQ = e 5tm ( q\n\u221a\nyQ = (e9 t2m /10) 15e\u22121 + (\u221285 + 61 5)t\u22121\nm ,\n\uf8f4\n\uf8f4\n\u0013\n\u0012q\n\uf8f4\n\u221a\n\uf8f4\n\uf8f4\n\u22121\n\u22121\n\uf8f4\n15e + (\u221285 + 61 5)tm ,\nL = F (tm ), M = L\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u221a\n\u221a\n\uf8f4\n\uf8f4\n\uf8f4\nfL = (23 5), fM = (92 5)\u221e2 ,\n\uf8f4\n\uf8f4\n\uf8f3\nP =< f1 > \u00d7 < f2 > \u00d7 < f3 >, PL =< f21 , f2, f3 >, PM =< f41 , f2 , f3 >,\n18\n\n\f\u221a\nwhere\nf\n,\nf\nand\nf\nare\nthe\nclasses\nrepresented\nby\nthe\nideals\n((1+3\n5)/2), (24+\n1\n2\n3\n\u221a\n23 5) and (91) and the order of f1 , f2 and f3 are 132, 2 and 2 respectively.\nSince the map \u03be1 : a \u2192 a33 of P to itself induces an isomorphism of\u221aP/PM\nto \u03be1 (P)/\u03be1 (PM ) and f0 = f33\n1 is represented by the ideal (423 + 372 5), we\nhave\nProposition 12. Let S =< f0 , f2 , f3 > and D =< f2 , f3 >. Let up and vp\nbe the positive integers such that 4plp = u2p + 115vp2, (up , p) = 1. Choose\n\u01ebp \u2208 {\u00b11} such that \u01ebpup \u2261 2 * 3i mod 5 if the class of p33 belongs to\nfi0 D (0 \u2264 i \u2264 3). Then we have ap(E) = \u01ebpup .\nAcknowledgement. The author would like to express his hearty gratitude to\nProfessor M. Kaneko for offering the table of class equations and to Tomoko\nIbata for writing and running the computer program required for this work.\n\nReferences\n[1] B.W. Brewer, On certain character sums, Trans.Amer.Math.Soc.99\n(1961),241-245.\n[2] B.W. Brewer, On primes of the form u2 + 5v 2 ,Proc.Amer.Math.Soc.17\n(1966),502-509.\n[3] D.A. Cox, \"Primes of the form x2 + ny 2\", John Wiley& Sons, Inc.,\nNew York,1989.\n[4] T. Hiramatsu and N. Ishii, Quartic residuacity and cusp forms of weight\none, Comment Math.Univ.St.Paul.34 (1985),91-108.\n[5] A. Joux and F. Morain, Sur les sommes de caract\u00e8res li\u00e9es aux curbes\nelliptiques \u00e0 multiplication complexe, J.Number Theory 55 (1995),108128.\n[6] S. Lang, \"Elliptic functions\", Addison-Weslley Publishing Co.Inc.1973.\n[7] F. Lepr\u00e9vost and F. Morain, Rev\u00eatements de courbes elliptiques \u00e0 multiplication complexe par des courbes hyperelliptiques et sommes de caract\u00e8res, J.Number Teory 64 (1997),165-182.\n\n19\n\n\f[8] H.W. Lenstra,JR, Complex Multiplication Structure of Elliptic curves,\nJ.Number Theory 56 (1996),227-241.\n[9] J-P. Serre, \"Local fields\", GTM 67, Springer-verlag,New York,1979.\n[10] J.H. Silverman, \"The Arithmetic of Elliptic curves\", GTM 106, Springer\n-verlag, New York,1986.\n[11] J.H. Silverman,\"Advanced Topics in the Arithmetic of Elliptic curves\",\nGTM 151,Springer-verlag, New York,1994.\nNoburo Ishii\nDepartment of Mathematics and Information Science,\nOsaka Prefecture University,\n1-1 Gakuen-cho, Sakai, Osaka 599-8531\nJapan\ne-mail:ishii@mi.cias.osakafu-u.ac.jp\n\n20\n\n\f"}