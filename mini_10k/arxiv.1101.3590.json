{"id": "http://arxiv.org/abs/1101.3590v5", "guidislink": true, "updated": "2014-10-04T10:13:31Z", "updated_parsed": [2014, 10, 4, 10, 13, 31, 5, 277, 0], "published": "2011-01-19T00:24:49Z", "published_parsed": [2011, 1, 19, 0, 24, 49, 2, 19, 0], "title": "Curvature-dimension inequalities and Ricci lower bounds for\n  sub-Riemannian manifolds with transverse symmetries", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1101.4129%2C1101.4264%2C1101.1747%2C1101.0312%2C1101.2414%2C1101.2259%2C1101.3255%2C1101.5605%2C1101.5342%2C1101.1917%2C1101.0874%2C1101.0336%2C1101.1915%2C1101.5855%2C1101.3039%2C1101.6006%2C1101.2127%2C1101.5344%2C1101.4252%2C1101.2393%2C1101.1549%2C1101.2439%2C1101.0821%2C1101.3548%2C1101.0779%2C1101.0206%2C1101.3064%2C1101.1110%2C1101.4996%2C1101.3076%2C1101.5667%2C1101.4437%2C1101.1828%2C1101.4183%2C1101.5331%2C1101.4943%2C1101.5689%2C1101.4467%2C1101.3258%2C1101.0811%2C1101.3960%2C1101.3414%2C1101.3931%2C1101.1497%2C1101.3367%2C1101.5030%2C1101.5007%2C1101.1450%2C1101.0265%2C1101.4113%2C1101.5318%2C1101.1397%2C1101.0693%2C1101.5208%2C1101.1905%2C1101.1365%2C1101.4279%2C1101.5719%2C1101.4309%2C1101.5715%2C1101.2595%2C1101.3647%2C1101.2642%2C1101.2242%2C1101.2169%2C1101.3619%2C1101.2002%2C1101.3489%2C1101.0861%2C1101.1900%2C1101.4745%2C1101.3963%2C1101.1950%2C1101.0471%2C1101.2789%2C1101.3796%2C1101.4092%2C1101.1893%2C1101.0423%2C1101.4750%2C1101.2071%2C1101.0870%2C1101.0506%2C1101.2603%2C1101.0789%2C1101.4389%2C1101.3590%2C1101.5966%2C1101.3336%2C1101.4446%2C1101.3363%2C1101.0707%2C1101.3430%2C1101.2633%2C1101.0360%2C1101.6033%2C1101.2134%2C1101.4506%2C1101.4930%2C1101.1416%2C1101.4002&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Curvature-dimension inequalities and Ricci lower bounds for\n  sub-Riemannian manifolds with transverse symmetries"}, "summary": "Let $\\M$ be a smooth connected manifold endowed with a smooth measure $\\mu$\nand a smooth locally subelliptic diffusion operator $L$ satisfying $L1=0$, and\nwhich is symmetric with respect to $\\mu$. Associated with $L$ one has\n\\textit{le carr\\'e du champ} $\\Gamma$ and a canonical distance $d$, with\nrespect to which we suppose that $(M,d)$ be complete. We assume that $\\M$ is\nalso equipped with another first-order differential bilinear form $\\Gamma^Z$\nand we assume that $\\Gamma$ and $\\Gamma^Z$ satisfy the Hypothesis below. With\nthese forms we introduce in \\eqref{cdi} below a generalization of the\ncurvature-dimension inequality from Riemannian geometry, see Definition\n\\ref{D:cdi}. In our main results we prove that, using solely \\eqref{cdi}, one\ncan develop a theory which parallels the celebrated works of Yau, and Li-Yau on\ncomplete manifolds with Ricci bounded from below. We also obtain an analogue of\nthe Bonnet-Myers theorem. In Section \\ref{S:appendix} we construct large\nclasses of sub-Riemannian manifolds with transverse symmetries which satisfy\nthe generalized curvature-dimension inequality \\eqref{cdi}. Such classes\ninclude all Sasakian manifolds whose horizontal Webster-Tanaka-Ricci curvature\nis bounded from below, all Carnot groups with step two, and wide subclasses of\nprincipal bundles over Riemannian manifolds whose Ricci curvature is bounded\nfrom below.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1101.4129%2C1101.4264%2C1101.1747%2C1101.0312%2C1101.2414%2C1101.2259%2C1101.3255%2C1101.5605%2C1101.5342%2C1101.1917%2C1101.0874%2C1101.0336%2C1101.1915%2C1101.5855%2C1101.3039%2C1101.6006%2C1101.2127%2C1101.5344%2C1101.4252%2C1101.2393%2C1101.1549%2C1101.2439%2C1101.0821%2C1101.3548%2C1101.0779%2C1101.0206%2C1101.3064%2C1101.1110%2C1101.4996%2C1101.3076%2C1101.5667%2C1101.4437%2C1101.1828%2C1101.4183%2C1101.5331%2C1101.4943%2C1101.5689%2C1101.4467%2C1101.3258%2C1101.0811%2C1101.3960%2C1101.3414%2C1101.3931%2C1101.1497%2C1101.3367%2C1101.5030%2C1101.5007%2C1101.1450%2C1101.0265%2C1101.4113%2C1101.5318%2C1101.1397%2C1101.0693%2C1101.5208%2C1101.1905%2C1101.1365%2C1101.4279%2C1101.5719%2C1101.4309%2C1101.5715%2C1101.2595%2C1101.3647%2C1101.2642%2C1101.2242%2C1101.2169%2C1101.3619%2C1101.2002%2C1101.3489%2C1101.0861%2C1101.1900%2C1101.4745%2C1101.3963%2C1101.1950%2C1101.0471%2C1101.2789%2C1101.3796%2C1101.4092%2C1101.1893%2C1101.0423%2C1101.4750%2C1101.2071%2C1101.0870%2C1101.0506%2C1101.2603%2C1101.0789%2C1101.4389%2C1101.3590%2C1101.5966%2C1101.3336%2C1101.4446%2C1101.3363%2C1101.0707%2C1101.3430%2C1101.2633%2C1101.0360%2C1101.6033%2C1101.2134%2C1101.4506%2C1101.4930%2C1101.1416%2C1101.4002&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let $\\M$ be a smooth connected manifold endowed with a smooth measure $\\mu$\nand a smooth locally subelliptic diffusion operator $L$ satisfying $L1=0$, and\nwhich is symmetric with respect to $\\mu$. Associated with $L$ one has\n\\textit{le carr\\'e du champ} $\\Gamma$ and a canonical distance $d$, with\nrespect to which we suppose that $(M,d)$ be complete. We assume that $\\M$ is\nalso equipped with another first-order differential bilinear form $\\Gamma^Z$\nand we assume that $\\Gamma$ and $\\Gamma^Z$ satisfy the Hypothesis below. With\nthese forms we introduce in \\eqref{cdi} below a generalization of the\ncurvature-dimension inequality from Riemannian geometry, see Definition\n\\ref{D:cdi}. In our main results we prove that, using solely \\eqref{cdi}, one\ncan develop a theory which parallels the celebrated works of Yau, and Li-Yau on\ncomplete manifolds with Ricci bounded from below. We also obtain an analogue of\nthe Bonnet-Myers theorem. In Section \\ref{S:appendix} we construct large\nclasses of sub-Riemannian manifolds with transverse symmetries which satisfy\nthe generalized curvature-dimension inequality \\eqref{cdi}. Such classes\ninclude all Sasakian manifolds whose horizontal Webster-Tanaka-Ricci curvature\nis bounded from below, all Carnot groups with step two, and wide subclasses of\nprincipal bundles over Riemannian manifolds whose Ricci curvature is bounded\nfrom below."}, "authors": ["Fabrice Baudoin", "Nicola Garofalo"], "author_detail": {"name": "Nicola Garofalo"}, "author": "Nicola Garofalo", "arxiv_comment": "Final version. To appear in the Journal of the European Mathematical\n  Society", "links": [{"href": "http://arxiv.org/abs/1101.3590v5", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1101.3590v5", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.DG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1101.3590v5", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1101.3590v5", "journal_reference": null, "doi": null, "fulltext": "arXiv:1101.3590v5 [math.DG] 4 Oct 2014\n\nCurvature-dimension inequalities and Ricci lower\nbounds for sub-Riemannian manifolds with\ntransverse symmetries\nFabrice Baudoin\n\nNicola Garofalo\n\nAbstract\nLet M be a smooth connected manifold endowed with a smooth measure \u03bc and\na smooth locally subelliptic diffusion operator L satisfying L1 = 0, and which is\nsymmetric with respect to \u03bc. Associated with L one has the carr\u00e9 du champ \u0393 and\na canonical distance d, with respect to which we suppose that (M, d) be complete.\nWe assume that M is also equipped with another first-order differential bilinear form\n\u0393Z and we assume that \u0393 and \u0393Z satisfy the Hypothesis 1.1, 1.2, and 1.4 below.\nWith these forms we introduce in (1.12) below a generalization of the curvaturedimension inequality from Riemannian geometry, see Definition 1.3. In our main\nresults we prove that, using solely (1.12), one can develop a theory which parallels\nthe celebrated works of Yau, and Li-Yau on complete manifolds with Ricci curvature bounded from below. We also obtain an analogue of the Bonnet-Myers theorem. In Section 2 we construct large classes of sub-Riemannian manifolds with\ntransverse symmetries which satisfy the generalized curvature-dimension inequality (1.12). Such classes include all Sasakian manifolds whose horizontal WebsterTanaka-Ricci curvature is bounded from below, all Carnot groups with step two, and\nwide subclasses of principal bundles over Riemannian manifolds whose Ricci curvature is bounded from below.\nKeywords. Sub-Riemannian geometry, Curvature dimension inequalities\n\n1 Introduction\nIn the present paper we introduce a generalization of the curvature-dimension inequality\nfrom Riemannian geometry which, as we show, is appropriate for some sub-Riemannian\nFabrice Baudoin: Department of Mathematics, Purdue University, West Lafayette, IN 47907; e-mail:\nfbaudoin@purdue.edu\nNicola Garofalo: Dipartimento d'Ingegneria Civile e Ambientale (DICEA), Universit\u00e0 di Padova via\nTrieste 63, 35131 Padova, Italy; e-mail: nicola.garofalo@unipd.it\nMathematics Subject Classification (2010): Primary 53C12; Secondary 53C17\n\n1\n\n\fFabrice Baudoin, Nicola Garofalo\n\n2\n\ngeometries. The central objective of our work is developing a program which, through\na systematic use of such curvature-dimension inequality, connects the geometry of the\nambient manifold, expressed in terms of lower bounds on a generalization of the Ricci\ntensor, to global properties of solutions of a certain canonical second order diffusion (non\nelliptic) partial differential operator, a sub-Laplacian, and of its associated heat semigroup.\nIn Riemannian geometry the Ricci tensor plays a fundamental role. Its connection with\nthe Laplace-Beltrami operator is provided by the celebrated identity of Bochner which\nstates that if M is a n-dimensional Riemannian manifold with Laplacian \u2206, for any f \u2208\nC \u221e (M) one has\n\u2206(|\u2207f |2 ) = 2||\u22072 f ||2 + 2 < \u2207f, \u2207(\u2206f ) > +2Ric(\u2207f, \u2207f ).\n\n(1.1)\n\nConsider the following differential forms on functions f, g \u2208 C \u221e (M),\n1\n\u0393(f, g) = (\u2206(f g) \u2212 f \u2206g \u2212 g\u2206f ) = (\u2207f, \u2207g),\n2\nand\n\n\u0003\n1\u0002\n\u2206\u0393(f, g) \u2212 \u0393(f, \u2206g) \u2212 \u0393(g, \u2206f ) .\n2\nWhen f = g, we simply write \u0393(f ) = \u0393(f, f ), \u03932 (f ) = \u03932 (f, f ). The functional calculus\nof these forms was introduced and developed in [9]. As an application of the Bochner's\nformula, which in terms of these functionals can be reformulated as\n\u03932 (f, g) =\n\n\u2206\u0393(f ) = 2||\u22072f ||2 + 2\u0393(f, \u2206f ) + 2 Ric(\u2207f, \u2207f ),\none obtains\n\u03932 (f ) = k\u22072 f k22 + Ric(\u2207f, \u2207f ).\nUsing the Cauchy-Schwarz inequality, which gives k\u22072 f k22 \u2265 n1 (\u2206f )2 , we thus see that\nthe assumption that the Riemannian Ricci tensor on M be bounded from below by \u03c11 \u2208 R\nimplies the so-called curvature-dimension inequality CD(\u03c11 , n):\n\u03932 (f ) \u2265\n\n1\n(\u2206f )2 + \u03c11 \u0393(f ),\nn\n\nf \u2208 C \u221e (M).\n\n(1.2)\n\nIn the hands of D. Bakry, M. Ledoux and their co-authors the inequality (1.2) has proven\na powerful tool in combination with a systematic use of fine properties of the heat semigroup. Among other things, these authors have succeeded in re-deriving, from a purely\nanalytical perspective, several of the well-known fundamental results which, in Riemannian geometry, are obtained under the assumption that the Ricci curvature be bounded\nfrom below, see for instance [6], [10] [38], [41]. It is remarkable that the curvature dimension inequality (1.2) perfectly captures the notion of Ricci curvature lower bound. It\n\n\fCurvature-dimension inequalities, etc.\n\n3\n\nwas in fact proved by Bakry in Proposition 6.2 in [6] that: on a n-dimensional Riemannian manifold M the inequality CD(\u03c11 , n) implies Ric \u2265 \u03c11 . In conclusion, Ric\u2265 \u03c11 \u21d0\u21d2\nCD(\u03c11 , n).\nInspired by the ideas contained in the above mentioned works, in the present paper\nwe introduce a generalization of the curvature-dimension inequality (1.2) which can be\nsuccessfully used in sub-Riemannian geometry. At this point, we feel it is important to\nsay few words concerning the organization of the paper. The essential contribution of the\npresent work is based on ideas and tools which are purely analytical in nature: as we have\nmentioned above, we systematically use the heat semigroup to derive new results in subRiemannian geometry. On the other hand, an equally important aspect of the present work\nis the construction of the examples from geometry: as the title indicates, the main class\nstudied in this paper is that of sub-Riemannian manifolds with transverse symmetries.\nWe show that such class is quite large, as it incorporates (but is not limited to) examples\nwhich are geometrically as diverse as CR manifolds with vanishing Tanaka-Webster torsion (Sasakian manifolds), graded nilpotent Lie groups of step two, orthonormal frame\nbundles. To facilitate the perusal of this paper by an audience of analysts we have strived\nas much as possible to separate the presentation of the analytical part of our work from\nthe geometrical discussion of the examples. With this objective in mind, we have chosen\nto present the analytical part of the paper in an axiomatic way. By this we mean that all\nthat is asked to a reader less inclined toward geometry is to accept a set of four \"abstract\"\nassumptions, which are listed as Hypothesis 1.1, 1.2, Definition 1.3 and Hypothesis 1.4\nbelow. The geometrical relevance, and the motivation, of such assumptions is unraveled\nin Section 2, where we discuss the examples and we develop the geometric setup.\nWith this being said, we now introduce the relevant setting. We consider a smooth,\nconnected manifold M endowed with a smooth measure \u03bc and a smooth second-order\ndiffusion operator L with real coefficients satisfying L1 = 0, and which is symmetric\nwith respect to \u03bc and non-positive. By this we mean that\nZ\nZ\nZ\nf Lgd\u03bc =\ngLf d\u03bc,\nf Lf d\u03bc \u2264 0,\n(1.3)\nM\n\nM\n\nM\n\nC0\u221e (M).\n\nfor every f, g \u2208\nWe make the technical assumption that L be locally subelliptic\nin the sense of [27]. We associate with L the following symmetric, first-order, differential\nbilinear form:\n1\n\u0393(f, g) = (L(f g) \u2212 f Lg \u2212 gLf ), f, g \u2208 C \u221e (M).\n(1.4)\n2\nThe expression \u0393(f ) = \u0393(f, f ) is known as the carr\u00e9 du champ. Furthermore, using the\nresults in [47], locally in the neighborhood of every point x \u2208 M we can write\nL=\u2212\n\nm\nX\ni=1\n\nXi\u2217 Xi ,\n\n(1.5)\n\n\fFabrice Baudoin, Nicola Garofalo\n\n4\n\nwhere the vector fields Xi are Lipschitz continuous (such representation is not unique,\nbut this fact is of no consequence for us). Therefore, for any x \u2208 M there exists an open\nneighborhood Ux such that for any f \u2208 C \u221e (M) we have in Ux\n\u0393(f ) =\n\nm\nX\n\n(Xi f )2 .\n\n(1.6)\n\ni=1\n\nThis shows that \u0393(f ) \u2265 0 and it actually only involves differentiation of order one.\nFurthermore, as it is clear from (1.4), the value of \u0393(f )(x) does not depend on the\nparticular representation (1.5) of L.\nWith the operator L we can also associate a canonical distance:\nd(x, y) = sup {|f (x) \u2212 f (y)| | f \u2208 C \u221e (M), k\u0393(f )k\u221e \u2264 1} ,\n\nx, y \u2208 M,\n\n(1.7)\n\nwhere for a function g on M we have let ||g||\u221e = ess sup|g|. A tangent vector v \u2208 Tx M\nMP\nP\nm\n2\na\nX\n(x),\nwith\nis called subunit for L at x if v = m\ni\ni\ni=1 ai \u2264 1, see [27]. It turns out\ni=1\nthat the notion of subunit vector for L at x does not depend on the local representation\n(1.5) of L. A Lipschitz path \u03b3 : [0, T ] \u2192 M is called subunit for L if \u03b3 \u2032 (t) is subunit for\nL at \u03b3(t) for a.e. t \u2208 [0, T ]. We then define the subunit length of \u03b3 as ls (\u03b3) = T . Given\nx, y \u2208 M, we indicate with\nS(x, y) = {\u03b3 : [0, T ] \u2192 M | \u03b3 is subunit for L, \u03b3(0) = x, \u03b3(T ) = y}.\nIn this paper we assume that\nS(x, y) 6= \u2205,\n\nfor every x, y \u2208 M.\n\nUnder such assumption it is easy to verify that\nds (x, y) = inf{ls (\u03b3) | \u03b3 \u2208 S(x, y)},\n\n(1.8)\n\ndefines a true distance on M. Furthermore, thanks to Lemma 5.43 in [18] we know that\nd(x, y) = ds (x, y), x, y \u2208 M,\nhence we can work indifferently with either one of the distances d or ds . Throughout this\npaper we assume that the metric space (M, d) be complete.\nWe also suppose given on M a symmetric, first-order differential bilinear form \u0393Z :\nC \u221e (M) \u00d7 C \u221e (M) \u2192 R. Hereafter in this, the term symmetric first-order differential\nform means that \u0393Z (f, g) = \u0393Z (g, f ) and\n\u0393Z (f g, h) = f \u0393Z (g, h) + g\u0393Z (f, h).\n\n(1.9)\n\n\fCurvature-dimension inequalities, etc.\n\n5\n\nIn particular, we have \u0393Z (1) = 0, where, as for \u0393, we have set \u0393Z (f ) = \u0393Z (f, f ). We\nassume that \u0393Z (f ) \u2265 0.\nWe will work with four general assumptions. The former three will be listed as Hypotheses 1.1, 1.2 and Definition 1.3, the fourth one will be introduced in Hypothesis 1.4\nbelow.\nHypothesis 1.1. There exists an increasing sequence hk \u2208 C0\u221e (M) such that hk \u0580 1 on\nM, and\n||\u0393(hk )||\u221e + ||\u0393Z (hk )||\u221e \u2192 0, as k \u2192 \u221e.\nWe will also assume that the following commutation relation be satisfied.\nHypothesis 1.2. For any f \u2208 C \u221e (M) one has\n\u0393(f, \u0393Z (f )) = \u0393Z (f, \u0393(f )).\nLet us notice explicitly that when M is a Riemannian manifold, \u03bc is the Riemannian\nvolume on M, and L = \u2206, then d(x, y) in (1.7) is equal to the Riemannian distance on\nM. In this situation if we take \u0393Z \u2261 0, then Hypothesis 1.1, 1.2 are fulfilled. In fact,\nHypothesis 1.2 is trivially satisfied, whereas Hypothesis 1.1 is equivalent to assuming\nthat (M, d) be a complete metric space, which we are assuming anyhow. More generally,\nin all the examples of Section 2, Hypothesis 1.1 is equivalent to assuming that (M, d)\nbe a complete metric space (the reason is that in those examples \u0393 + \u0393Z is the carr\u00e9 du\nchamp of the Laplace-Beltrami operator of a Riemannian structure whose completeness\nis equivalent to the completeness of (M, d)). On the other hand, Hypothesis 1.2 is also\nverified as a consequence of the assumptions about the existence of transverse symmetries\nthat we make.\nBefore we proceed with the discussion, we pause to stress that, in the generality in\nwhich we work the bilinear differential form \u0393Z , unlike \u0393, is not a priori canonical.\nWhereas \u0393 is determined once L is assigned, the form \u0393Z in general is not intrinsically associated with L. However, in the geometric examples described in this paper (for this see\nthe discussion below and Section 2) the choice of \u0393Z will be natural and even canonical,\nup to a constant. This is the case, for instance, of the important example of CR Sasakian\nmanifolds. The reader should think of \u0393Z as an orthogonal complement of \u0393: the bilinear\nform \u0393 represents the square of the length of the gradient in the horizontal directions,\nwhereas \u0393Z represents the square of the length of the gradient along the vertical directions.\nGiven the sub-Laplacian L and the first-order bilinear forms \u0393 and \u0393Z on M, we now\nintroduce the following second-order differential forms:\n\u03932 (f, g) =\n\n\u0003\n1\u0002\nL\u0393(f, g) \u2212 \u0393(f, Lg) \u2212 \u0393(g, Lf ) ,\n2\n\n(1.10)\n\n\fFabrice Baudoin, Nicola Garofalo\n\n6\n\n\u0003\n1\u0002 Z\nL\u0393 (f, g) \u2212 \u0393Z (f, Lg) \u2212 \u0393Z (g, Lf ) .\n(1.11)\n2\nObserve that if \u0393Z \u2261 0, then \u0393Z2 \u2261 0 as well. As for \u0393 and \u0393Z , we will use the notations\n\u03932 (f ) = \u03932 (f, f ), \u0393Z2 (f ) = \u0393Z2 (f, f ).\nWe are ready to introduce the central character of our paper, a generalization of the\nabove mentioned curvature-dimension inequality (1.2).\n\u0393Z2 (f, g) =\n\nDefinition 1.3. We shall say that M satisfies the generalized curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) with respect to L and \u0393Z if there exist constants \u03c11 \u2208 R, \u03c12 > 0,\n\u03ba \u2265 0, and 0 < d \u2264 \u221e such that the inequality\n\u0010\n1\n\u03ba\u0011\n\u03932 (f ) + \u03bd\u0393Z2 (f ) \u2265 (Lf )2 + \u03c11 \u2212\n\u0393(f ) + \u03c12 \u0393Z (f )\n(1.12)\nd\n\u03bd\nhold for every f \u2208 C \u221e (M) and every \u03bd > 0.\n\nIt is worth observing explicitly that if in Definition 1.3 we choose L = \u2206, \u0393Z \u2261 0,\nd = n = dim(M), and \u03ba = 0, we obtain the Riemannian curvature-dimension inequality\nCD(\u03c11 , n) in (1.2) above. Thus, the case of Riemannian manifolds is trivially encompassed by Definition 1.3. We also remark that, changing \u0393Z into a\u0393Z , where a > 0,\nchanges the inequality CD(\u03c11 , \u03c12 , \u03ba, d) into CD(\u03c11 , a\u03c12 , a\u03ba, d). We express this fact by\nsaying that the quantity \u03c1\u03ba2 is intrinsic. Hereafter, when we say that M satisfies the curvature dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) (with respect to L and \u0393Z ), we will routinely\navoid repeating at each occurrence the sentence \"for some \u03c12 > 0, \u03ba \u2265 0 and d > 0\".\nInstead, we will explicitly mention whether \u03c11 = 0, or > 0, or simply \u03c11 \u2208 R. The reason\nfor this is that the parameter \u03c11 in the inequality (1.12) has a special relevance since, in\nthe geometric examples in Section 2, it represents the lower bound on a sub-Riemannian\ngeneralization of the Ricci tensor. Thus, \u03c11 = 0 is, in our framework, the counterpart of\nthe Riemannian Ric \u2265 0, whereas when \u03c11 > 0 (< 0), we are dealing with the counterpart\nof the case Ric > 0 (Ric bounded from below by a negative constant).\nSince, as we have stressed above, we wish to present our results in an axiomatic way,\nwe will also need the following assumption which is necessary to rigorously justify computations on functionals of the heat semigroup. Hereafter, we will denote by Pt = etL the\nsemigroup generated by the diffusion operator L, see the discussion below, and Section 4.\nHypothesis 1.4. The semigroup Pt is stochastically complete that is, for t \u2265 0, Pt 1 = 1\nand for every f \u2208 C0\u221e (M) and T \u2265 0, one has\nsup k\u0393(Pt f )k\u221e + k\u0393Z (Pt f )k\u221e < +\u221e.\n\nt\u2208[0,T ]\n\nIn the Riemannian setting (L = \u2206 and \u0393Z \u2261 0), Hypothesis 1.4 is satisfied if one assumes the lower bound Ricci \u2265 \u03c1, for some \u03c1 \u2208 R. This can be derived from the paper by\n\n\fCurvature-dimension inequalities, etc.\n\n7\n\nYau [59] and Bakry's note [5]. It thus follows that, in the Riemannian case, the Hypothesis 1.4 is not needed since it can be derived as a consequence of the curvature-dimension\ninequality CD(\u03c11 , n) in (1.2) above. In this paper we will prove that, more generally, this\nsituation occurs in the sub-Riemannian setting of our work. As a consequence of the results in Section 2 below, in Theorem 4.3 we prove that, in every sub-Riemannian manifold\nwith transverse symmetries of Yang-Mills type (for the relevant definitions see Sections 2\nand 3 below), the Hypothesis 1.4 is not needed since it follows (in a non-trivial way) from\nthe generalized curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) in Definition 1.3 above.\nIn this connection it is worth observing that, even in the abstract framework of the\npresent work, if we assume that \u0393Z = 0, then the Hypothesis 1.4 becomes redundant\nsince it can be actually obtained a consequence of CD(\u03c11 , n). This can be seen from the\nresults in Chapter 5 of [4]. Whether it is possible to generalize this fact to the genuinely\nnon-Riemannian situation of \u0393Z 6= 0, we must leave to a future study. Concerning our\naxiomatic presentation, we finally mention that, had we chosen to do so, we could have\ndeveloped our results in an even more abstract setting, as Bakry and Ledoux often do in\ntheir works. We could have worked with abstract Markov diffusion generators on measure spaces and replaced Hypothesis 1.1 and Hypothesis 1.4 with the existence of a nice\nalgebra of functions which is dense in the domain of L (see Definition 2.4.2 in [4] for the\nprecise properties that should be satisfied by this algebra when \u0393Z = 0). However assuming the existence of such algebra is a strong assumption that may be difficult to verify in\nsome concrete situations.\nThe above discussion prompts us to underline the distinctive aspect of the theory developed in the present paper: for the class of complete sub-Riemannian manifolds with\ntransverse symmetries of Yang-Mills type that we study in Section 3, all our results are\nsolely deduced from the curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) in (1.12).\nTo introduce our results we recall that in their celebrated work [40] Li and Yau, generalizing to the heat equation some fundamental works of Yau, see for instance [58],\nobtained various a priori gradient bounds for positive solutions of the heat equation on a\ncomplete n-dimensional Riemannian manifold M. When Ric \u2265 0 the Li-Yau inequality\nstates that if u > 0 is a solution of \u2206u \u2212 ut = 0 in M \u00d7 (0, \u221e), then\n|\u2207u|2 ut\nn\n\u2212\n\u2264 .\n2\nu\nu\n2t\n\n(1.13)\n\nNotice that in the flat Rn the Gauss-Weierstrass kernel u(x, t) = (4\u03c0t)\u2212n/2 exp(\u2212|x|2 /4t)\nsatisfies (1.13) with equality. The inequality (1.13) was the central tool for obtaining a\nscale invariant Harnack inequality for the heat equation and optimal off-diagonal upper\nbounds for the heat kernel on M, see Corollary 3.1 and Theorem 4.1 in [40]. The proof of\n(1.13) hinges crucially on Bochner's identity (1.1) above, and on the Laplacian comparison theorem which, for a manifold with Ric \u2265 0, states that, given a base point x0 \u2208 M,\n\n\fFabrice Baudoin, Nicola Garofalo\n\n8\n\nand denoted with \u03c1(x) the Riemannian distance from x to x0 , then\n\u2206\u03c1(x) \u2264\n\nn\u22121\n,\n\u03c1(x)\n\n(1.14)\n\noutside of the cut-locus of x0 (and globally in D \u2032 (M)). As it is well-known, see for instance [21], the proof of (1.14) exploits the theory of Jacobi fields. In sub-Riemannian\ngeometry the exponential map is not a local diffeomorphism. As a consequence of this\nobstacle, a general sub-Riemannian comparison theorem such as (1.14) presently represents terra incognita.\nThe main thrust of the present work is that, despite such obstructions, we have succeeded in establishing a sub-Riemannian generalization of the Li-Yau inequalities. In our\napproach, we completely avoid those tools from geometry that appear typically Riemannian, and instead base our analysis on a systematic use of some entropic inequalities for\nthe heat semigroup that are inspired by the works [8], [11], [13], and which, as we have\nstressed above, in the geometric framework of this paper we solely derive from our generalized curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) in (1.12).\nMore precisely, let Pt = etL indicate the heat semigroup on M associated with the\noperator L. It is well-known that Pt is sub-Markovian, i.e., Pt 1 \u2264 1, and it has a positive\nand symmetric kernel p(x, y, t). If f \u2208 C0\u221e (M) the function\nZ\nu(x, t) = Pt f (x) =\np(x, y, t)f (y)d\u03bc(y),\nM\n\nsolves the Cauchy problem\n(\n\n\u2202u\n\u2202t\n\n\u2212 Lu = 0, in M \u00d7 (0, \u221e),\nu(x, 0) = f (x), x \u2208 M.\n\nFor fixed x \u2208 M and T > 0 we introduce the functionals\n\u03a61 (t) = Pt ((PT \u2212t f )\u0393(ln PT \u2212t f )) (x),\n\u0001\n\u03a62 (t) = Pt (PT \u2212t f )\u0393Z (ln PT \u2212t f ) (x),\n\nwhich are defined for 0 \u2264 t < T . The fundamental observation is that, in our framework,\nthe inequality CD(\u03c11 , \u03c12 , \u03ba, d) in (1.12) leads to the following differential inequality\n\u0013\u2032\n\u0012\nb\u2032 \u03b3 2\n2b\u2032 \u03b3\nb\u2032\n\u03a61 + b\u03a62 \u2265 \u2212\nLPT f +\nPT f,\n(1.15)\n\u2212\n2\u03c12\nd\u03c12\nd\u03c12\nwhere b is any smooth, positive and decreasing function on the time interval [0, T ] and\n\u0012\n\u0013\n\u03ba b\u2032\nd b\u2032\u2032\n+\n+ 2\u03c11 .\n\u03b3=\n4 b\u2032\n\u03c12 b\n\n\fCurvature-dimension inequalities, etc.\n\n9\n\nDepending on the value of \u03c11 , a good choice of the function b leads to a generalized LiYau type inequality, see Theorem 6.1 below. In the special case \u03c11 = 0 (i.e., our Ric \u2265 0),\nthe latter becomes\n\u0010\n\u00112\n3\u03ba\n\u0013\n\u0012\nd\n1\n+\n2\u03c12\n3\u03ba LPt f\n2\u03c12 Z\nt\u0393 (ln Pt f ) \u2264 1 +\n+\n,\n(1.16)\n\u0393(ln Pt f ) +\n3\n2\u03c12 Pt f\n2t\nfor every sufficiently nice function f \u2265 0 on M. In the Riemannian case, when \u0393Z \u2261 0,\nand \u03ba = 0, the inequality (1.16) is precisely the Li-Yau inequality (1.13), except that\nour inequality holds for positive solutions of the heat equation of the type u = Pt f , i.e.,\nthey arise from an initial datum f , whereas in the original Li-Yau inequality (1.13) such\nlimitation is not present.\nIt is worth emphasizing at this point that, even in the Riemannian case, our approach,\nbased on a systematic use of the entropic inequality (1.15) above, provides a new and\nelementary proof of several fundamental results for complete manifolds with Ric \u2265 0. In\nthis framework, in fact, besides the already mentioned Li-Yau gradient estimates, with the\nensuing scale invariant Harnack inequality and the Liouville theorem of Yau, see [58], we\nalso obtain an elementary proof of the fundamental monotonicity of Perelman's entropy\nfor the heat equation, see [46], and of the volume doubling property on Riemannian manifolds (for the statement of this classical result see for instance [19]). For these aspects\nwe refer the reader to the recent note [15]. The reader more oriented toward analysis and\npde's might in fact find somewhat surprising that we can develop the whole local regularity theory for solutions of the relevant heat equation starting from a global object such\nas the heat semigroup. By this we mean that, at the end of our process, we are able to\nreplace the functions Pt f in (1.16) with any positive solution u of the heat equation. This\nin a sense reverses the way one normally proceeds, starting from local solutions, and then\nmoving from local to global.\nWe are now ready to provide a brief account of our main results.\n1) Li-Yau type inequalities (Theorem 6.1): assume Hypothesis 1.1, 1.2 and 1.4 hold.\nIf M satisfies CD(\u03c11 , \u03c12 , \u03ba, d) in (1.12) with \u03c11 \u2208 R, then for any f \u2208 C0\u221e (M),\nf \u2265 0, f 6= 0, the following inequality holds for t > 0:\n2\u03c12 Z\nt\u0393 (ln Pt f )\n3\n\u0010\n\u00112\n\u0012\n\u0013 d 1 + 3\u03ba\n\u0012\n\u0013\n2\n2\u03c12\n3\u03ba\n3\u03ba\n2\u03c11\nd\u03c1\nd\u03c11\nLPt f\n1+\n+\n\u2264 1+\n\u2212\nt\n+ 1t \u2212\n.\n2\u03c12\n3\nPt f\n6\n2\n2\u03c12\n2t\n\u0393(ln Pt f ) +\n\n2) Scale-invariant parabolic Harnack inequality (Theorem 7.1): assume Hypothesis\n1.1, 1.2 and 1.4. If M satisfies CD(\u03c11 , \u03c12 , \u03ba, d) with \u03c11 \u2265 0, then for every (x, s), (y, t) \u2208\n\n\fFabrice Baudoin, Nicola Garofalo\n\n10\nM \u00d7 (0, \u221e) with s < t one has\n\n\u0012 \u0013 D2\n\u0012\n\u0013\nD d(x, y)2\nt\nu(x, s) \u2264 u(y, t)\nexp\n,\ns\nd 4(t \u2212 s)\nwith u(x, t) = Pt f (x), and f \u2208 C \u221e (M) such that f \u2265 0 and bounded. The number\nD > 0, which solely depends on \u03c12 , \u03ba and d, is defined in (6.2) below.\n3) Off-diagonal Gaussian upper bounds (Theorem 8.1): assume Hypothesis 1.1, 1.2\nand 1.4. If M satisfies CD(\u03c11 , \u03c12 , \u03ba, d) with \u03c11 \u2265 0, then for any 0 < \u03b5 < 1 there\nexists a constant C(\u03c12 , \u03ba, d, \u03b5) > 0, which tends to \u221e as \u03b5 \u2192 0+ , such that for\nevery x, y \u2208 M and t > 0 one has\n\u0013\n\u0012\nC(\u03c12 , \u03ba, d, \u03b5)\nd(x, y)2\np(x, y, t) \u2264\n.\n\u221a 1 exp \u2212\n\u221a 1\n(4 + \u03b5)t\n\u03bc(B(x, t)) 2 \u03bc(B(y, t)) 2\n4) Liouville type theorem (Theorem 9.2): assume Hypothesis 1.1, 1.2 and 1.4. If M\nsatisfies CD(\u03c11 , \u03c12 , \u03ba, d) with \u03c11 \u2265 0, then there exists no entire bounded solution\nof Lf = 0.\n5) Bonnet-Myers type theorem (Theorem 10.1): assume Hypothesis 1.1, 1.2, 1.4, and\nsuppose that M satisfy CD(\u03c11 , \u03c12 , \u03ba, d) with \u03c11 > 0. Then, the metric space (M, d)\nis compact in the metric topology, and we have\ns\n\u0012\n\u0013\n\u221a\n3\u03ba\n\u03ba + \u03c12\ndiam M \u2264 2 3\u03c0\n1+\nd.\n\u03c11 \u03c12\n2\u03c12\nConcerning the Gaussian upper bound in 3), we mention that a similar bound was obtained\nfor sub-Laplacians on Lie groups [57]. Our approach is totally different since it does not\nuse the uniform doubling condition on the volume of the metric balls which is a key\nassumption in that work. We should also mention that in the sequel paper [14] we have in\nfact established a uniform global doubling condition under non negative lower bound on\nthe sub-Riemannian Ricci tensor (\u03c11 \u2265 0).\nConcerning the sub-Riemannian Bonnet-Myers theorem in 5) we emphasize that, similarly to the Laplacian comparison theorem (1.14), the proof of its classical Riemannian\npredecessor is based on the theory of Jacobi fields. Our proof of Theorem 10.1 is, instead,\npurely analytical and exploits in a subtle way some sharp entropic inequalities which, in\nthe case \u03c11 > 0, we are able to derive from the inequality CD(\u03c11 , \u03c12 , \u03ba, d) in (1.12).\nHaving presented the main results of the paper, we now turn to the fundamental question of the examples. This aspect is dealt with in Section 2, which is devoted to constructing large classes of sub-Riemannian manifolds to which our general results apply.\nWe begin with a discussion in Section 2.2 of a class of Lie groups which carry a natural\n\n\fCurvature-dimension inequalities, etc.\n\n11\n\nCR structure, and which, in our framework, are the 3-dimensional sub-Riemannian CR\nSasakian model spaces with constant curvature (see Hughen [35] for a precise meaning\nof the notion of model spaces). Entropic inequalities on such model spaces were studied\nin [8], and these inequalities constituted a first motivation for our theory.\nGiven a \u03c11 \u2208 R we consider a Lie group G(\u03c11 ) whose Lie algebra g admits a basis of\ngenerators X, Y, Z satisfying the commutation relations\n[X, Y ] = Z, [X, Z] = \u2212\u03c11 Y, [Y, Z] = \u03c11 X.\nThe group G(\u03c11 ) can be endowed with a natural CR structure \u03b8 with respect to which the\nReeb vector field is given by \u2212Z. A sub-Laplacian on G(\u03c11 ) with respect to such structure\nis thus given by L = X 2 + Y 2 . The pseudo-hermitian Tanaka-Webster torsion of G(\u03c11 )\nvanishes (see Definition 2.23 below), and thus (G(\u03c11 ), \u03b8) is a Sasakian manifold. In the\nsmooth manifold M = G(\u03c11 ) with sub-Laplacian L we introduce the differential forms \u0393\nand \u0393Z defined by\n\u0393(f, g) = Xf Xg + Y f Y g,\n\n\u0393Z (f, g) = Zf Zg.\n\nThese forms satisfy the Hypothesis (1.1), (1.2). It is worth observing that, since \u2212Z is\nthe Reeb vector field of the CR structure \u03b8, then the above choice of \u0393Z is canonical.\nIt is also worth remarking at this point that for the CR manifold (G(\u03c11 ), \u03b8) the TanakaWebster horizontal sectional curvature is constant and equals \u03c11 . Having noted these facts,\nin Section 2.2 we prove the following proposition.\nProposition 1.5. The sub-Laplacian L on the Lie group G(\u03c11 ) satisfies the generalized\ncurvature-dimension inequality CD(\u03c11 , 12 , 1, 2).\nThe relevance of the model space G(\u03c11 ) is illustrated by the Lie groups:\n(i) SU(2);\n(ii) the \"flat\" Heisenberg group H1 ;\n(iii) SL(2, R).\nIn Section 2.2 we note that the Lie groups (i)-(iii) are special instances of the model CR\nmanifold G(\u03c11 ) corresponding, respectively, to the cases \u03c11 = 1, \u03c11 = 0 and \u03c11 = \u22121.\nAfter introducing these motivating examples, in Section 2.3 we turn our attention to the\nconstruction of a large class of C \u221e manifolds carrying a natural sub-Riemannian structure\nfor which our generalized curvature-dimension inequality (1.12) holds. As a consequence,\nin these spaces all the above mentioned results 1)-6) are valid as well. Let M be a smooth,\nconnected manifold equipped with a bracket generating distribution H of dimension d\n\n\fFabrice Baudoin, Nicola Garofalo\n\n12\n\nand a fiberwise inner product g on H. The distribution H will be referred to as the set of\nhorizontal directions.\nWe indicate with iso the finite-dimensional Lie algebra of all sub-Riemannian Killing\nvector fields on M. It is readily seen that Z \u2208 iso if and only if:\n(1) For every x \u2208 M, and any u, v \u2208 H(x), LZ g(u, v) = 0;\n(2) If X \u2208 H, then [Z, X] \u2208 H.\nIn (1) we have denoted by LZ g the Lie derivative of g with respect to Z. Our main geometric assumption is the following:\nHypothesis 1.6. There exists a Lie sub-algebra V \u2282 iso, such that for every x \u2208 M,\nTx M = H(x) \u2295 V(x).\nThe sub-bundle of transverse symmetries will be referred to as the set of vertical directions. The dimension of V will be denoted by h.\nThe horizontal distribution H with its fiberwise inner product g, plus the Lie algebra V\nare the essential data of the construction in Section 2.3. By this we mean that the relevant\ngeometric objects that we introduce, namely the sub-Laplacian, the canonical connection\n\u2207 and the tensor R, respectively defined in Section 2.3.1 and equation (2.13) in Definition\n2.15 below, solely depend on (H, g) and V, but not on the choice of an inner product on\nV. As a consequence, in those situations in which the choice of V is canonical, then our\nanalysis will depend only on the choice of (H, g). This is the case, for instance, of the\nbasic example of Sasakian manifolds.\nOur ultimate objective in Section 2.3 is proving that the smooth manifold M, with a\ngiven sub-Riemannian geometry (H, g) and a vertical distribution of transverse symmetries V, satisfies a generalized curvature-dimension inequality such as (1.12) as soon as\nsome intrinsic geometric conditions are satisfied. To achieve this objective we find it expedient introducing in Section 2.3.1 a canonical connection \u2207. By means of such connection\nwe define in Definition 2.15 a generalization of the Riemannian Ricci tensor, which we\ndenote by R. In Theorem 2.18 we prove two Bochner identities which intertwine the tensor R with the forms \u0393 and \u0393Z . With such Bochner identities in hand in Theorem 2.19\nwe finally show that, under the geometric assumptions in (2.26), the manifold M satisfies\nthe generalized curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d). In Proposition 2.20 we\nprove that, remarkably, the generalized curvature-dimension inequality implies the geometric bounds (2.26), and therefore: on any sub-Riemannian manifold with transverse\nsymmetries we have CD(\u03c11 , \u03c12 , \u03ba, d) \u21d0\u21d2 (2.26).\nThe remaining part of Section 2 is devoted to presenting some basic examples of\nmanifolds which fall within the geometric framework of Section 2.3. In Section 2.4\n\n\fCurvature-dimension inequalities, etc.\n\n13\n\nwe prove that all Carnot groups of step two satisfy the curvature-dimension inequality\nCD(0, \u03c12 , \u03ba, d), for some appropriate values of \u03c12 and \u03ba, see Proposition 2.21. Here,\nd indicates the dimension of the bracket-generating layer of their Lie algebra. This result shows, in particular, that in our framework all Carnot groups of step two are subRiemannian manifolds of nonnegative Ricci tensor, since \u03c11 = 0. In Section 2.5 we analyze another important class of manifolds which falls within the scope of our work,\nnamely Sasakian manifolds endowed with their CR sub-Laplacian. These are CR manifolds of real hypersurface type for which the Tanaka-Webster pseudo-hermitian torsion\nvanishes in an appropriate sense. Concerning Sasakian manifolds we prove the following\nbasic result.\nTheorem 1.7. Let (M, \u03b8) be a complete CR manifold with real dimension 2n + 1 and\nvanishing Tanaka-Webster torsion, i.e., a Sasakian manifold. If for every x \u2208 M the\nTanaka-Webster Ricci tensor satisfies the bound\nRicx (v, v) \u2265 \u03c11 |v|2,\nfor every horizontal vector v \u2208 Hx , then, for the CR sub-Laplacian of M the curvaturedimension inequality CD(\u03c11 , d4 , 1, d) holds, with d = 2n and the Hypothesis 1.1, 1.2 and\n1.4 are satisfied..\nThanks to this result, the above listed results 1)-5) are valid for all Sasakian manifolds.\nWe close this introduction by mentioning that, for general metric measure spaces,\na different notion of lower bounds on the Ricci tensor based on the theory of optimal\ntransport has been recently proposed independently by Sturm [55], [56], and by LottVillani [42], see also the paper by Ollivier [45]. However, as pointed out by Juillet in\n[36], the remarkable theory developed in these papers does not appear to be suited for\nsub-Riemannian manifolds. For instance, in this theory the flat Heisenberg group H1 has\ncurvature = \u2212\u221e. In their preprint [2] Agrachev and Lee have used a notion of Ricci\ntensor, denoted by Ric, which was introduced by the first author in [1]. They study threedimensional contact manifolds and, under the assumption that the manifold be Sasakian,\nthey prove that a lower bound on Ric implies the so-called measure-contraction property.\nIn particular, when Ric \u2265 0, then the manifold M satisfies a global volume growth similar\nto the Riemannian Bishop-Gromov theorem. An analysis shows that, interestingly, our\nnotion of Ricci tensor coincides, up to a scaling factor, with theirs.\nWe also mention that for three-dimensional contact manifolds, the sub-Riemannian\ngeometric invariants were computed by Hughen in his unpublished Ph.D. dissertation,\nsee [35]. In particular, with his notations, the CR Sasakian structure corresponds to the\ncase a21 + a22 = 0 and, up to a scaling factor, his K is the Tanaka-Webster Ricci curvature.\nIn such respect, the Bonnet-Myers type theorem obtained by Hughen (Proposition 3.5 in\n\n\fFabrice Baudoin, Nicola Garofalo\n\n14\n\n[35]) is the exact analogue (with a better constant) of our Theorem 10.1, applied to the\ncase of three-dimensional Sasakian manifolds. Let us finally mention that a Bonnet-Myers\ntype theorem on general three-dimensional CR manifolds was first obtained by Rumin in\n[51]. The methods of Rumin and Hughen are close as they both rely on the analysis of the\nsecond-variation formula for sub-Riemannian geodesics.\n\nAcknowledgments: The authors would like to thank F.Y. Wang for pointing to our\nattention an oversight in a previous version of the paper. His constructive criticism has\nled us to improve the presentation and also add new results. We would also like to thank\nthe anonymous referees for their careful reading of the manuscript and for several helpful\ncomments.\n\n2 Examples\nIn this section we present several classes of sub-Riemannian spaces satisfying the generalized curvature-dimension inequality in Definition 1.3. These examples constitute the\ncentral motivation of the present work.\n\n2.1 Riemannian manifolds\nAs we have mentioned in the introduction, when M is a n-dimensional complete Riemannian manifold with Riemannian distance dR , Levi-Civita connection \u2207 and LaplaceBeltrami operator \u2206, our main assumptions hold trivially. It suffices in fact to choose\n\u0393Z = 0 to satisfy Hypothesis 1.2 in a trivial fashion. Hypothesis 1.1 is also satisfied since\nit is equivalent to assuming that (M, dR ) be complete, see [32] (observe in passing that the\ndistance (1.7) coincides with dR ). Finally, with the choice \u03ba = 0 the curvature-dimension\ninequality (1.12) reduces to (1.2), which, as we have shown, is implied by (and it is in fact\nequivalent to) the assumption Ric \u2265 \u03c11 .\n\n2.2 The three-dimensional Sasakian models\nThe purpose of this section is providing a first basic sub-Riemannian example which fits\nthe framework of the present paper. This example was first studied in [8]. Given a number\n\u03c11 \u2208 R, suppose that G(\u03c11 ) be a three-dimensional Lie group whose Lie algebra g has a\nbasis {X, Y, Z} satisfying:\n(i) [X, Y ] = Z,\n(ii) [X, Z] = \u2212\u03c11 Y ,\n\n\fCurvature-dimension inequalities, etc.\n\n15\n\n(iii) [Y, Z] = \u03c11 X.\nA sub-Laplacian on G(\u03c11 ) is the left-invariant, second-order differential operator\nL = X 2 + Y 2.\n\n(2.1)\n\nIn view of (i)-(iii) H\u00f6rmander's theorem, see [34], implies that L be hypoelliptic, although\nit fails to be elliptic at every point of G(\u03c11 ). From (1.4) we find in the present situation\n\u0393(f ) =\n\n1\nL(f 2 ) \u2212 2f Lf ) = (Xf )2 + (Y f )2 .\n2\n\nIf we define\n\u0393Z (f, g) = Zf Zg,\nthen from (i)-(iii) we easily verify that\n\u0393(f, \u0393Z (f )) = \u0393Z (f, \u0393(f )).\nWe conclude that the Hypothesis 1.2 is satisfied. It is not difficult to show that the Hypothesis 1.1 is also fulfilled.\nUsing (i)-(iii) we leave it to the reader to verify that\n[L, Z] = 0.\n\n(2.2)\n\nBy means of (2.2) we easily find\n1\n\u0393Z2 (f ) = L(\u0393Z (f )) \u2212 \u0393Z (f, Lf ) = Zf [L, Z]f + (XZf )2 + (Y Zf )2\n2\n= (XZf )2 + (Y Zf )2 .\nFinally, from definition (1.10) and from (i)-(iii) we obtain\n1\n\u03932 (f ) = L(\u0393(f )) \u2212 \u0393(f, Lf )\n2\n= \u03c11 \u0393(f ) + (X 2 f )2 + (Y Xf )2 + (XY f )2 + (Y 2 f )2\n+ 2Y f (XZf ) \u2212 2Xf (Y Zf ).\nWe now notice that\n1\n(X 2 f )2 + (Y Xf )2 + (XY f )2 + (Y 2 f )2 = ||\u22072H f ||2 + \u0393Z (f ),\n2\nwhere we have denoted by\n\u22072H f\n\n=\n\n\u0012\n\nX 2f\n1\n(XY f + Y Xf )\n2\n\n1\n(XY\n2\n\n\u0013\nf + Y Xf )\nY 2f\n\n\fFabrice Baudoin, Nicola Garofalo\n\n16\n\nthe symmetrized Hessian of f with respect to the horizontal distribution generated by\nX, Y . Substituting this information in the above formula we find\n\u0001\n1\n\u03932 (f ) = ||\u22072H f ||2 + \u03c11 \u0393(f ) + \u0393Z (f ) + 2 Y f (XZf ) \u2212 Xf (Y Zf ) .\n2\n\nBy the above expression for \u0393Z2 (f ), using Cauchy-Schwarz inequality, we obtain for every\n\u03bd>0\n1\n|2Y f (XZf ) \u2212 2Xf (Y Zf )| \u2264 \u03bd\u0393Z2 (f ) + \u0393(f ).\n\u03bd\nSimilarly, one easily recognizes that\n1\n||\u22072H f ||2 \u2265 (Lf )2 .\n2\nCombining these inequalities, we conclude that we have proved the following result.\nProposition 2.1. For every \u03c11 \u2208 R the Lie group G(\u03c11 ), with the sub-Laplacian L in\n(2.1), satisfies the generalized curvature dimension inequality CD(\u03c11 , 21 , 1, 2). Precisely,\nfor every f \u2208 C \u221e (G(\u03c11 )) and any \u03bd > 0 one has:\n\u0013\n\u0012\n1\n1\n1\nZ\n2\n\u03932 (f ) + \u03bd\u03932 (f ) \u2265 (Lf ) + \u03c11 \u2212\n\u0393(f ) + \u0393Z (f ).\n2\n\u03bd\n2\nProposition 2.1 provides a basic motivation for Definition 1.3. It is also important to\nobserve at this point that the Lie group G(\u03c11 ) can be endowed with a natural CR structure.\nDenoting in fact with H the subbundle of T G(\u03c11 ) generated by the vector fields X and\nY , the endomorphism J of H defined by\nJ(Y ) = X,\n\nJ(X) = \u2212Y,\n\nsatisfies J 2 = \u2212I, and thus defines a complex structure on G(\u03c11 ). By choosing \u03b8 as the\nform such that\nKer \u03b8 = H, and d\u03b8(X, Y ) = 1,\nwe obtain a CR structure on G(\u03c11 ) whose Reeb vector field is \u2212Z. Thus, the above choice\nof \u0393Z is canonical.\nThe pseudo-hermitian Tanaka-Webster torsion of G(\u03c11 ) vanishes (see Definition 2.23\nbelow), and thus (G(\u03c11 ), \u03b8) is a Sasakian manifold. It is also easy to verify that for the\nCR manifold (G(\u03c11 ), \u03b8) the Tanaka-Webster horizontal sectional curvature is constant\nand equals \u03c11 . The following three model spaces correspond respectively to the cases\n\u03c11 = 1, \u03c11 = 0 and \u03c11 = \u22121.\nExample 2.2. The Lie group SU(2) is the group of 2 \u00d7 2, complex, unitary matrices of\ndeterminant 1. Its Lie algebra su(2) consists of 2 \u00d7 2, complex, skew-hermitian matrices\n\n\fCurvature-dimension inequalities, etc.\n\n17\n\nwith trace 0. A basis of su(2) is formed by the following matrices X = 2i \u03c31 , Y = 2i \u03c32 ,\nZ = 2i \u03c33 , where \u03c3k , k = 1, 2, 3, are the Pauli matrices:\n1\nX=\n2\n\n\u0012\n\n0\n\u22121\n\n1\n0\n\n\u0013\n\n1\n, Y =\n2\n\n\u0012\n\n0\ni\n\ni\n0\n\n\u0013\n\n1\n, Z=\n2\n\n\u0012\n\ni\n0\n\n0\n\u2212i\n\n\u0013\n\n.\n\nOne easily verifies\n[X, Y ] = Z,\n\n[X, Z] = \u2212Y,\n\n[Y, Z] = X,\n\n(2.3)\n\nand thus \u03c11 = 1.\nExample 2.3. The Heisenberg group H is the group of 3 \u00d7 3 matrices:\n\uf8eb\n\n1\n\uf8ed 0\n0\n\nx\n1\n0\n\n\uf8f6\nz\ny \uf8f8 , x, y, z \u2208 R.\n1\n\nThe Lie algebra of H is spanned by the matrices\n\uf8eb\n\n0\n\uf8ed\n0\nX=\n0\n\n1\n0\n0\n\n\uf8f6\n\uf8eb\n0\n0\n\uf8f8\n\uf8ed\n0\n0\n, Y =\n0\n0\n\n0\n0\n0\n\n\uf8f6\n\uf8eb\n0\n0\n\uf8f8\n\uf8ed\n1\n0\n, Z=\n0\n0\n\n0\n0\n0\n\n\uf8f6\n1\n0 \uf8f8,\n0\n\nfor which the following commutation relations hold\n[X, Y ] = Z, [X, Z] = [Y, Z] = 0.\nWe thus have \u03c11 = 0 in this case.\nExample 2.4. The Lie group SL(2) is the group of 2 \u00d7 2, real matrices of determinant 1.\nIts Lie algebra sl(2) consists of 2 \u00d7 2 matrices of trace 0. A basis of sl(2) is formed by the\nmatrices:\n\u0013\n\u0013\n\u0013\n\u0012\n\u0012\n\u0012\n1\n1\n1\n1\n0\n0 1\n0\n1\nX=\n, Y =\n, Z=\n,\n0 \u22121\n1 0\n2\n2\n2 \u22121 0\nfor which the following commutation relations hold\n[X, Y ] = Z,\nWe thus have \u03c11 = \u22121 in this case.\n\n[X, Z] = Y,\n\n[Y, Z] = \u2212X.\n\n(2.4)\n\n\fFabrice Baudoin, Nicola Garofalo\n\n18\n\n2.3 Sub-Riemannian manifolds with transverse symmetries\nWe now turn our attention to a large class of sub-Riemannian manifolds, encompassing\nthe three-dimensional model spaces discussed in the previous section. The central objective of the present section is proving Theorem 2.19 below. The latter states that for these\nsub-Riemannian manifolds the generalized curvature-dimension inequality (1.12) does\nhold under some natural geometric assumptions which, in the Riemannian case, reduce\nto requiring a lower bound for the Ricci tensor. To achieve this result, we will need to\nestablish some new Bochner type identities. This is done in Theorem 2.18 below.\nLet M be a smooth, connected manifold. We assume that M is equipped with a bracket\ngenerating distribution H of dimension d and a fiberwise inner product g on that distribution. The distribution H will be referred to as the set of horizontal directions.\nWe indicate with iso the finite-dimensional Lie algebra of all sub-Riemannian Killing\nvector fields on M (see [53]). A vector field Z \u2208 iso if the one-parameter flow generated\nby it locally preserves the sub-Riemannian geometry defined by (H, g). This amounts to\nsaying that:\n(1) For every x \u2208 M, and any u, v \u2208 H(x), LZ g(u, v) = 0;\n(2) If X \u2208 H, then [Z, X] \u2208 H.\nIn (1) we have denoted by LZ g the Lie derivative of g with respect to Z. Our main geometric assumption is the following:\nHypothesis 2.5. There exists a Lie sub-algebra V \u2282 iso, such that for every x \u2208 M,\nTx M = H(x) \u2295 V(x).\nThe distribution V will be referred to as the set of vertical directions. The dimension\nof V will be denoted by h.\nThe choice of an inner product on the Lie algebra V naturally endows M with a Riemannian extension gR of g that makes the decomposition H(x) \u2295 V(x) orthogonal. Although gR will be useful for the purpose of computations, the geometric objects that we\nwill introduce, like the sub-Laplacian L, the canonical connection \u2207 and the \"Ricci\" tensor R, ultimately will not depend on the choice of an inner product on V.\nThe Riemannian measure of (M, gR ) will be denoted by \u03bc and, for notational convenience, we will often use the notation h*, *i instead of gR .\nRemark 2.6. If the Lie group V generated by V acts properly on M, then we have a\nnatural Riemannian submersion M \u2192 M/V. In the case SU(2) studied in the previous\nsection, we obtain the Hopf fibration S3 \u2192 S2 , see [44].\n\n\fCurvature-dimension inequalities, etc.\n\n19\n\nThe above assumptions imply that, in a sufficiently small neighborhood of every point\nx \u2208 M, we can find a frame of vector fields {X1 , * * * , Xd , Z1 , * * * , Zh } such that:\n(a) Z1 , * * * , Zh \u2208 V;\n(b) {X1 (x), * * * , Xd (x)} is an orthonormal basis of H(x);\n(c) {Z1 (x), * * * , Zh (x)} is an orthonormal basis of V(x);\n(d) the following commutation relations hold:\n[Xi , Xj ] =\n\nd\nX\n\n\u03c9ijl Xl\n\n+\n\nh\nX\n\n\u03b3ijm Zm ,\n\n(2.5)\n\nm=1\n\nl=1\n\n[Xi , Zm ] =\n\nd\nX\n\nl\n\u03b4im\nXl ,\n\n(2.6)\n\nl=1\n\nl\nfor smooth functions \u03c9ijl , \u03b3ijm and \u03b4im\nsuch that\nl\ni\n\u03b4im\n= \u2212\u03b4lm\n, i, l = 1, ..., d, and m = 1, ..., h.\n\n(2.7)\n\nWe mention explicitly that the equation (2.7) follows from the property of Zm being subl\nand\nRiemannian Killing, see conditions (1) and (2) above. By convention, \u03c9ijl = \u2212\u03c9ji\nm\nm\n\u03b3ij = \u2212\u03b3ji .\nDefinition 2.7. A local frame such as in (a)-(d) above will be called an adapted frame.\nWe define the horizontal gradient \u2207H f of a function f as the projection of the Riemannian gradient of f on the horizontal bundle. Similarly, we define the vertical gradient\n\u2207V f of a function f as the projection of the Riemannian gradient of f on the vertical\nbundle. In an adapted frame,\nd\nX\n\u2207H f =\n(Xi f )Xi ,\ni=1\n\n\u2207V f =\n\nh\nX\n\n(Zm f )Zm .\n\nm=1\n\nThe canonical sub-Laplacian in this structure is, by definition, the diffusion operator L on\nM which is symmetric on C0\u221e (M) with respect to the measure \u03bc and such that (see (1.4)):\n1\n\u0393(f, g) = (L(f g) \u2212 f Lg \u2212 gLf ) = h\u2207H f, \u2207H gi.\n2\nIt is readily seen that in an adapted frame, one has\nL=\u2212\n\nd\nX\ni=1\n\nXi\u2217 Xi ,\n\n\fFabrice Baudoin, Nicola Garofalo\n\n20\n\nwhere Xi\u2217 is the formal adjoint of Xi with respect to the measure \u03bc. From the commutation\nrelations in an adapted frame, we obtain that\nXi\u2217\n\n= \u2212Xi +\n\nd\nX\n\nk\n\u03c9ik\n,\n\nk=1\n\nso that, in an adapted frame\nL=\n\nd\nX\n\nXi2 + X0 ,\n\n(2.8)\n\ni=1\n\nwhere\nX0 = \u2212\n\nd\nX\n\nk\n\u03c9ik\nXi .\n\n(2.9)\n\ni,k=1\n\nWe also note that since H is supposed to be bracket generating, from H\u00f6rmander's theorem, L is a hypoelliptic operator.\nIn the present setting, from the very definition of L, one readily recognizes that the\ncanonical bilinear form introduced in (1.4) above is given by\n\u0393(f, g) = h\u2207H f, \u2207H gi.\nDefinition 2.8. We define for every f, g \u2208 C \u221e (M)\n\u0393Z (f, g) = h\u2207V f, \u2207V gi.\nOur first step is verifying that the differential forms \u0393 and \u0393Z satisfy the Hypothesis\n1.2 in the introduction. This is the content of the next result.\nLemma 2.9. For f, g \u2208 C \u221e (M),\n\u0393(f, \u0393Z (f )) = \u0393Z (f, \u0393(f )).\nProof. It is readily checked in a local adapted frame {X1 , ..., Xd , Z1 , ..., Zh }. We have\nZ\n\n\u0393 (f, \u0393(f )) = 2\n\nh\nX\n\nZm f\n\nm=1\n\n=2\n\nd\nX\n\nd\nX\n\nXi f Zm (Xi f )\n\ni=1\nh\n\nXi f\n\nX\n\nm=1\n\ni=1\n\nZm f Xi (Zm f ) \u2212 2\n\n= \u0393(f, \u0393Z (f )) \u2212 2\nZ\n\n= \u0393(f, \u0393 (f )),\n\nh\n\nX\n\nm=1\n\nZm f\n\nd\nX\n\nd\nX\n\nXi f\n\ni=1\n\nh\nX\n\nm=1\n\nl\n\u03b4im\nXi f Xl f\n\ni,l=1\n\nwhere in the last two equalities we have used (2.6) and (2.7).\n\nZm f [Xi , Zm ]f\n\n\fCurvature-dimension inequalities, etc.\n\n21\n\nAnother property that will be important for us is that V is a Lie algebra of symmetries\nfor the sub-Laplacian L.\nLemma 2.10. For any Z \u2208 V one has [L, Z] = 0.\nProof. Since Z is a Killing vector field, [L, Z] is a first-order differential operator and\ntherefore a vector field. Since Z \u2217 = \u2212Z + c, where Z \u2217 denotes the formal adjoint of Z\nand c a constant, we obtain that [L, Z]\u2217 = [L, Z]. Since a symmetric vector field must\nvanish identically, we obtain the desired conclusion.\n2.3.1 The canonical connection\nOur ultimate objective (see Theorem 2.19 in Section 2.3.3) will be establishing natural\ngeometric conditions under which the manifold M, endowed with the above defined subLaplacian L, and with the differential bilinear form \u0393Z , satisfy the generalized curvaturedimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) in Definition 1.3. A useful ingredient in the realization of this objective is the existence of a canonical connection on M.\nProposition 2.11. There exists a unique affine connection \u2207 on M satisfying the following\nproperties:\n(i) \u2207g = 0;\n(ii) if X and Y are horizontal vector fields, \u2207X Y is horizontal;\n(iii) if Z \u2208 V, \u2207Z = 0;\n(iv) if X, Y are horizontal vector fields and Z \u2208 V, the torsion vector field T(X, Y ) is\nvertical and T(X, Z) = 0.\nProof. If we indicate with \u2207R the Riemannian Levi-Civita connection on M, the existence of the connection \u2207 follows by prescribing the relations\n\u2207Z X = [Z, X],\n\n\u2207X Y = \u03c0H (\u2207R\nX Y ),\n\n\u2207Z = 0,\n\nwhere X, Y \u2208 H, Z \u2208 V, and \u03c0H the projection onto the horizontal bundle. The uniqueness of \u2207 follows in a standard fashion.\nRemark 2.12. It is worth noting that the connection \u2207 does not depend on the choice of\nthe inner product on V.\nRemark 2.13. It is also worth observing here that in the Riemannian case we simply have\nH = T M, and \u2207 is just the Levi-Civita connection on M.\n\n\fFabrice Baudoin, Nicola Garofalo\n\n22\n\nRemark 2.14. For later use we observe that, in a local adapted frame, one has:\n\u2207X i X j =\n\nd\nX\n1\nk=1\n\n2\n\n\u0001\nj\ni\n\u03c9ijk + \u03c9ki\n+ \u03c9kj\nXk ,\n\n\u2207Z m X i = \u2212\n\nd\nX\n\nl\n\u03b4im\nXl ,\n\n(2.10)\n\n(2.11)\n\nl=1\n\n\u2207Zm = 0.\n\n(2.12)\n\nWe also note that, thanks to (2.8) and (2.9), in a local adapted frame we have\nL=\n\nd\nX\ni=1\n\nXi2 \u2212 \u2207Xi Xi ,\n\nso that\nLf = div(\u2207H f ).\n2.3.2 Generalized Bochner identities\nAs we have recalled in the opening of the present paper at the hearth of the Riemannian\ncurvature-dimension inequality CD(\u03c11 , n) there is the Bochner identity. It is then only\nnatural that our first step in the formulation of the generalized curvature-dimension inequality in Definition 1.3 above was understanding appropriate versions of the identity\nof Bochner. This is accomplished by Theorem 2.18 below, which represents the central\nresult of this section. This result contains two Bochner identities: one for the horizontal\ndirections, see (2.17), and the other for the vertical ones, see (2.18) below. One of the\nessential points of the program laid in this paper is that, to formulate a notion of Ricci that\nworks well for sub-Riemannian spaces, one needs to appropriately intertwine these identities. As a final comment we mention that, as it will be clear from the proof of Theorem\n2.18, the vertical Bochner formula is incredibly easier than the horizontal one, but this is\nin the nature of things, and should come as no surprise.\nWe are ready to introduce the relevant geometric quantities.\nDefinition 2.15. Let \u2207 be the affine connection introduced by Proposition 2.11, and indicate with Ric and T respectively the Ricci and torsion tensors with respect to \u2207. For\nf \u2208 C \u221e (M) we define:\nR(f ) = Ric(\u2207H f, \u2207H f ) +\n\nd \u0012\nX\n\nl,k=1\n\n\u0013\n1\n2\n\u2212((\u2207Xl T)(Xl , Xk )f )(Xk f ) + (T(Xl , Xk )f ) .\n4\n(2.13)\n\n\fCurvature-dimension inequalities, etc.\n\n23\n\nwhere {X1 , * * * , Xd } is a local frame of horizontal vector fields. We also define the following second-order differential form by the formula:\nd\nX\n\nS(f ) = \u22122\n\ni=1\n\nh\u2207Xi \u2207V f, T(Xi , \u2207H f )i.\n\n(2.14)\n\nRemark 2.16. The expressions (2.13), (2.14) do not depend on the choice of the frame,\nthus they define intrinsic differential forms on M. Also, we observe that since the connection \u2207 does not depend on the choice of an inner product on V, it is easy to check that\nR and S do not depend on this choice either. We note explicitly that in the Riemannian\ncase we have H = T M, \u2207 is just the Levi-Civita connection of M, and therefore T\u2261 0.\nIn such case, R(f ) = Ric(\u2207f, \u2207f ), where now Ric is the Riemannian Ricci tensor.\nThe following lemma provides a useful expression of the differential forms R(f ) and\nS(f ) in a local adapted frame.\nLemma 2.17. Let {X1 , ..., Xd , Z1, ..., Zh } be a local adapted frame. Then, we have:\n\u0013 X\nh\nd\nd X\nd \u001a\u0012 X\nX\nj\nm l\nk\n\u03b3kj \u03b4jm +\n(Xl \u03c9kj\n\u2212 Xj \u03c9lj\n)\n(2.15)\nR(f ) =\nk,l=1\n\nd\nX\n\nj=1 m=1\n\nd\nX\n\nj=1\n\n\u0012\n\u0013\u001b\n1 X\nj\nj\nl k\ni\ni\n+\n\u2212\n+\n\u03c9ij \u03c9ij \u2212 (\u03c9lj + \u03c9li )(\u03c9kj + \u03c9ki ) Xk f Xl f\n2 1\u2264i<j\u2264d\ni,j=1\ni=1\n\u0013\nh \u0012 d\nd\nd X\nX\nX\nX\nX\nk m\nm\nl m\n\u03c9lj \u03b3lj \u2212\nXj \u03b3kj Zm f Xk f\n\u03c9jl \u03b3kj +\n+\ni l\n\u03c9ji\n\u03c9kj\n\nk=1 m=1\n\n+\n\n1\n2\n\n1\u2264l<j\u2264d\n\nl,j=1\n\nh\nX \u0012X\n\n1\u2264l<j\u2264d\n\ni\n\u03c9ki\n\u03c9lii\n\nm=1\n\nm\n\u03b3lj\nZm f\n\n\u00132\n\nj=1\n\n,\n\nand\nS(f ) = \u22122\n\nh\nd X\nX\n\n\u03b3ijm (Xj Zm f )(Xi f ).\n\n(2.16)\n\ni,j=1 m=1\n\nProof. It is a standard but lengthy computation using an adapted frame.\nIn the following we denote by k\u22072H f k2 the Hilbert-Schmidt norm of the symmetrized\nhorizontal Hessian of a function f . In a local adapted frame\n!2\n!2\nd\nd\nd\nX\nX\nX\nX\n\u03c9ijl + \u03c9ilj\nXj Xl + Xl Xj\n2\nl\n2\n2\nXl f \u2212\n\u03c9il Xi f +2\nk\u2207H f k =\nf\u2212\nXi f .\n2\n2\ni=1\ni=1\n1\u2264l<j\u2264d\nl=1\nP P\nAlso, we will denote k\u2207H \u2207V f k2 = di=1 hm=1 (Xi Zm f )2 , an expression which is seen\nto be independent from the local adapted frame. The next theorem constitutes one of the\ncentral results of Section 2.3.\n\n\fFabrice Baudoin, Nicola Garofalo\n\n24\n\nTheorem 2.18. For every f \u2208 C \u221e (M) the following formulas hold:\n\u03932 (f ) = k\u22072H f k2 + R(f ) + S(f );\n\u0393Z2 (f ) = k\u2207H \u2207V f k2 .\n\n(Horizontal Bochner formula)\n\n(2.17)\n\n(Vertical Bochner formula)\n\n(2.18)\n\nProof. It is enough to prove (2.17) and (2.18) in a local adapted frame {X1 , ..., Xd , Z1 , ..., Zh }.\nWe begin with the vertical Bochner formula (2.18), which is quite simple. Such formula\nfollows immediately by a direct computation starting from the definition (1.11) of \u0393Z2 , and\nusing the fact that L and Zm commute, see Lemma 2.10.\nThe proof of the horizontal Bochner formula (2.17) is not as straightforward. In order\nto avoid long and cumbersome computations we will omit the intermediate details and\nonly provide the essential identities. With such identities the interested reader should be\nable to fill in the gaps. Let us preliminarily observe that\n1\nXi Xj f = f,ij + [Xi , Xj ]f,\n2\nwhere we have let\n1\nf,ij = (Xi Xj + Xj Xi )f.\n2\n\n(2.19)\n\nUsing (2.5), we find\nXi Xj f = f,ij +\n\nh\nd\n1X l\n1X m\n\u03c9 Xl f +\n\u03b3 Zm f.\n2 l=1 ij\n2 m=1 ij\n\n(2.20)\n\nNow, starting from the definition (1.10) of \u03932 (f ), we obtain\n\u03932 (f ) =\n\nd\nX\ni=1\n\n+\n\nd\nX\n\nXi f [X0 , Xi ]f \u2212 2\n\nd\nX\n\nXi f [Xi , Xj ]Xj f\n\ni,j=1\n\nXi f [[Xi , Xj ], Xj ]f +\n\ni,j=1\n\nd\nX\n\n(Xj Xi f )2 ,\n\ni,j=1\n\nwhere X0 is defined by (2.9). From (2.20) we have\nd\nX\n\nd\nX\n\n1\n2\nf,ij\n+\n(Xj Xi f )2 =\n2\ni,j=1\ni,j=1\n+\n\nX\n\nd\nX\n\nX\n\n1\u2264i<j\u2264d\n\nh\nX\n\n1\u2264i<j\u2264d l=1 m=1\n\nd\nX\n\n\u03c9ijl Xl f\n\nl=1\n\n\u03c9ijl \u03b3ijm Zm f Xl f.\n\n!2\n\n1\n+\n2\n\nX\n\n1\u2264i<j\u2264d\n\nh\nX\n\nm=1\n\n\u03b3ijm Zm f\n\n!2\n\n\fCurvature-dimension inequalities, etc.\n\n25\n\nand therefore,\n\u03932 (f ) =\n\nd\nX\n\n2\nf,ij\n\n\u22122\n\ni,j=1\n\n+\n\nd\nX\ni=1\n\n+\n\nd\nX\n\nXi f [Xi , Xj ]Xj f +\n\ni,j=1\n\nd\nX\n\nXi f [[Xi , Xj ], Xj ]f\n\nd\nX\n1 X\n\u03c9 l Xl f\nXi f [X0 , Xi ]f +\n2 1\u2264i<j\u2264d l=1 ij\n\nh\nd X\nX X\n\n(2.21)\n\ni,j=1\n\n!2\n\n1 X\n+\n2 1\u2264i<j\u2264d\n\nh\nX\n\n\u03b3ijm Zm f\n\nm=1\n\n!2\n\n\u03c9ijl \u03b3ijm Zm f Xl f.\n\n1\u2264i<j\u2264d l=1 m=1\n\nTo complete the proof we need to recognize that the right-hand side in (2.21) coincides\nwith that in (2.17). With this objective in mind, using (2.5) we obtain after a computation\nd\nX\n\ni,j=1\n\n=\n\n2\nf,ij\n\u22122\n\nd\nX\n\nd\nX\n\ni,j=1\n\nX\n\nd\nX\n\nd\nX\n\n\u03c9ill Xi f\n\ni=1\n\n2\nf,jl\n\u22122\n\n1\u2264l<j\u2264d\n\n\u2212\n\nd\nX\n\n2\nf,ll\n\u22122\n\nl=1\n\n+2\n\nXi f [Xi , Xj ]Xj f\n\nX\n\n1\u2264l<j\u2264d\n\nk\n\u03c9ijl \u03c9lj\nXk f Xi f\n\n\u2212\n\ni,j=1 l,k=1\n\n\u22122\n\nh\nd X\nX\n\n!\n\nf,ll\n\n!\n\nd\nX\n\u03c9ijl + \u03c9ilj\nXi f\n2\ni=1\n\nh\nd X\nd X\nX\n\n!\n\nf,lj\n\n!\n\nm\n\u03c9ijl \u03b3lj\nZ m f Xi f\n\ni,j=1 l=1 m=1\n\n\u03b3ijm Zm Xj f Xi f.\n\ni,j=1 m=1\n\nCompleting the squares in the latter expression we find\nd\nX\n\ni,j=1\n\n=\n\n2\nf,ij\n\u22122\n\nd\nX\nl=1\n\n\u2212\n\u2212\n\nd\nX\n\nXi f [Xi , Xj ]Xj f\n\ni,j=1\n\nf,ll \u2212\n\nd\nd\nX\nX\nl=1\n\nd\nX\n\nd\nX\n\n\u03c9ill Xi f\n\ni=1\n\n\u03c9ill Xi f\n\ni=1\n\n!2\n\n\u22122\n\nk\n\u03c9ijl \u03c9lj\nXk f Xi f\n\ni,j,k,l=1\n\n\u22122\n\nd\nX\n\nh\nX\n\ni,j=1 m=1\n\n!2\n\n\u03b3ijm Xj Zm f\n\n\u2212\n\nX\n\n+2\n\n1\u2264l<j\u2264d\n\nX\n\n1\u2264l<j\u2264d\n\nf,jl \u2212\n\nd\nX\n\u03c9ijl + \u03c9ilj\n\nd\nX\n\u03c9ijl + \u03c9ilj\n\n2\n\ni=1\n\nh\nd X\nd X\nX\n\n2\n\ni=1\n\nXi f\n\n!2\n\nm\n\u03c9ijl \u03b3lj\nZ m f Xi f\n\ni,j=1 l=1 m=1\n\nXi f \u2212 2\n\nh\nd X\nX\n\ni,j=1 m=1\n\n\u03b3ijm [Zm , Xj ]f Xi f.\n\nXi f\n\n!2\n\n\fFabrice Baudoin, Nicola Garofalo\n\n26\nNext, we have from (2.9)\n\nd\nX\n\nd\nX\n\nXi f [X0 , Xi ]f =\n\ni=1\n\nk l\n\u03c9jk\n\u03c9ij Xl f Xi f\n\ni,j,k,l=1\n\n+\n\nh\nd X\nd X\nX\n\nd\nd X\nX\n\nk m\n\u03c9jk\n\u03b3ij Zm f Xi f +\n\ni=1 j,k=1 m=1\n\nk\n(Xi \u03c9jk\n)Xi f Xj f.\n\ni=1 j,k=1\n\nUsing (2.5) we find\n\nd\nX\n\nd X\nd\nX\n\nXi f [[Xi , Xj ], Xj ]f =\n\ni,j=1\n\nk\nXi f Xk f +\n\u03c9ijl \u03c9lj\n\n+\n\nh\n\nX\n\n\u03b3ijm [Zm , Xj ]f Xi f\n\ni,j=1 m=1\n\n\u2212\n\nd\nX\n\nd\nX\n\nm\nZ m f Xi f\n\u03c9ijl \u03b3lj\n\ni,j,l=1 m=1\n\ni,j=1 l,k=1\nd\nX\n\nh\nd\nX\nX\n\n\u2212\n\nh\nd X\nX\n\n(Xj \u03b3ijm )Zm f Xi f\n\ni,j=1 m=1\n\n(Xj \u03c9ijl )Xi f Xl f.\n\ni,j=1 l=1\n\nSubstituting the latter three equations in (2.21) we thus obtain\n\n\u03932 (f ) =\n\nd\nX\nl=1\n\n\u22122\n\nd\nX\n\nf,ll \u2212\nh\nX\n\ni,j=1 m=1\n\nd\nX\ni=1\n\n\u03c9ill Xi f\n\n!2\n\n+2\n\nX\n\n1\u2264l<j\u2264d\n\n\u03b3ijm Xj Zm f Xi f + M\n\nd\nX\n\u03c9ijl + \u03c9ilj\nf,jl \u2212\nXi f\n2\ni=1\n\n!2\n\n\fCurvature-dimension inequalities, etc.\n\n27\n\nwhere we have let\nM=\u2212\n\nd\nd\nX\nX\ni=1\n\nl=1\n\nd\nX\n\n+\n\ni,j,k,l=1\n\n\u2212\n+\n\n\u2212\n\nd\nX\n\n!2\n\n\u22122\n\ni,j,k,l=1\n\nh\n\nX\n\n\u03b3ijm [Zm , Xj ]f Xi f +\n\nd\nX\n\nl\n\u03c9ijk \u03c9kj\nXl f Xi f \u2212\n\nd\nX\n\nh\n\nd\nX\n\nX\n\nXi f\n\n!2\n\n(2.22)\n\nh\nd X\nd X\nX\n\nm\n\u03c9ijl \u03b3lj\nZ m f Xi f\n\ni,j=1 l=1 m=1\n\nk m\n\u03c9jk\n\u03b3ij Zm f Xi f\n\ni=1 j,k=1 m=1\n\nd\nX\n\nk\n(Xi \u03c9jk\n)Xi f Xj f\ni=1 j,k=1\n\nh\nd X\nX\n\n2\n\ni=1\n\n1\u2264l<j\u2264d\n\nd\nX\n\nk l\n\u03c9jk\n\u03c9ij Xl f Xi f \u2212\n\nd\nX\n\u03c9ijl + \u03c9ilj\n\nX\n\ni,j=1 m=1\n\nX\n\n1\u2264i<j\u2264d\n\nd\nX\n\n\u03c9ijl Xl f\n\nl=1\n\nh\nd X\nX X\n\nd\nX\n\n+\n\nd\nX\n\nk\n\u03c9ijl \u03c9lj\nXi f Xk f\n\n+\n\n\u2212\n\n!2\n\nd X\nd\nX\n\nh\nd\nX\nX\n\nm\n\u03c9ijl \u03b3lj\nZ m f Xi f\n\ni,j,l=1 m=1\n\ni,j=1 l,k=1\n\n(Xj \u03b3ijm )Zm f Xi f\n\ni,j=1 m=1\n\n1\n+\n2\n+\n\n\u03c9ill Xi f\n\n(Xj \u03c9ijl )Xi f Xl f\n\ni,j=1 l=1\n\n1\n+\n2\n\nX\n\n1\u2264i<j\u2264d\n\nh\nX\n\n\u03b3ijm Zm f\n\nm=1\n\n!2\n\n\u03c9ijl \u03b3ijm Zm f Xl f.\n\n1\u2264i<j\u2264d l=1 m=1\n\nSimplifying the latter expression we obtain\nM=\u2212\n\nd X\nd\nX\n\ni\n\u03c9ki\n\u03c9lii Xk f Xl f\n\nk,l=1 i=1\n\nd\n1X X\nj\ni\ni\n(\u03c9lj\n+ \u03c9lij )(\u03c9kj\n+ \u03c9ki\n)Xk f Xl f\n\u2212\n2 k,l=1 1\u2264i<j\u2264d\n\n+\n\nd X\nd\nX\n\nj\n(Xl \u03c9kj\n\nk,l=1 j=1\n\n\u2212\n\nk\nXj \u03c9lj\n)Xk f Xl f\n\n+\n\nd\nX\n\n(2.23)\n\ni l\n\u03c9ji\n\u03c9kj Xk f Xl f\n\ni,j,k,l=1\n\nh\nX\nX\n1\nm\nl k\n+\n\u03b3kj\n[Xj , Zm ]f Xk f\n\u03c9 \u03c9 Xk f Xl f +\n2 k,l=1 1\u2264i<j\u2264d ij ij\nk,j=1 m=1\nd\nX\n\nd\nX\n\n+\n\nh\nd X\nd X\nX\n\ni=1 j,k=1 m=1\n\nk m\n\u03c9jk\n\u03b3ij Zm f Xi f\n\n+\n\nh\nd X\nX X\n\n\u03c9ijl \u03b3ijm Zm f Xl f\n\n1\u2264i<j\u2264d l=1 m=1\n\nh\nX\n1 X\nm\n\u03b3ijm Zm f\n(Xj \u03b3ij )Zm f Xi f +\n\u2212\n2\ni,j=1 m=1\n1\u2264i<j\u2264d m=1\nh\nd X\nX\n\n!2\n\n.\n\nAt this point, using (2.6), it is easy to recognize in view of (2.13) in Lemma 2.17 that\nM = R(f ).\n\n\fFabrice Baudoin, Nicola Garofalo\n\n28\nTo complete the proof of (2.17) it now suffices to:\n1) use the equation (2.14) in Lemma 2.17;\n\n2) recognize by a computation that, in a local horizontal frame, the square of the\nHilbert-Schmidt norm of the horizontal Hessian \u22072H f is given by\n!2\n!2\nd\nd\nd\nX\nX\nX\nX\n\u03c9ijl + \u03c9ilj\nl\n2\n2\n\u03c9il Xi f\nf,ll \u2212\n+2\nf,jl \u2212\nk\u2207H f k =\nXi f .\n2\ni=1\ni=1\nl=1\n\n1\u2264l<j\u2264d\n\n(2.24)\n\n2.3.3 The generalized curvature-dimension inequality\nIn this final part of Section 2.3 we establish the main result of the whole section, namely\nTheorem 2.19 below. This result shows that, under suitable geometric bounds, see (2.26)\nbelow, which are natural in sub-Riemannian geometry (by this we mean that they are\nsatisfied by large classes of significant examples), the sub-Riemannian manifold M, with\nits canonical sub-Laplacian L and the Lie subalgebra of transverse symmetries V, satisfies\nthe curvature-dimension inequality in (1.12).\nWe need to introduce the last intrinsic first-order differential quadratic form, which in\na local horizontal frame {X1 , ..., Xd }, we defined as\nT (f ) =\n\nd\nX\ni=1\n\nkT(Xi , \u2207H f )k2 .\n\nA computation shows that in a local adapted frame we obtain:\n!2\nh\nd X\nd\nX\nX\nT (f ) =\n\u03b3ijm Xi f .\nj=1 m=1\n\n(2.25)\n\ni=1\n\nIt is worth remarking that, as we have already observed, in the Riemannian case \u2207\nis the Levi-Civita connection. As a consequence, in such case T (f ) = 0 for every f \u2208\nC \u221e (M).\nTheorem 2.19. Suppose that there exist constants \u03c11 \u2208 R, \u03c12 > 0 and \u03ba \u2265 0 such that\nfor every f \u2208 C \u221e (M):\n(\nR(f ) \u2265 \u03c11 \u0393(f ) + \u03c12 \u0393Z (f ),\n(2.26)\nT (f ) \u2264 \u03ba\u0393(f ).\nThen, the sub-Riemannian manifold M satisfies the generalized curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d) in (1.12) with respect to the sub-Laplacian L and the differential\nform \u0393Z .\n\n\fCurvature-dimension inequalities, etc.\n\n29\n\nProof. We need to show that for every f \u2208 C \u221e (M) and any \u03bd > 0 one has:\n\u0010\n\u03ba\u0011\n1\n2\nZ\n\u0393(f ) + \u03c12 \u0393Z (f ).\n\u03932 (f ) + \u03bd\u03932 (f ) \u2265 (Lf ) + \u03c11 \u2212\nd\n\u03bd\nLet {X1 , ..., Xd , Z1 , ..., Zh } be a local adapted frame. From (2.8) and (2.9) and Schwarz\ninequality we find\n\uf8eb\n!\n!2 \uf8f61/2\nd\nd\nd\nd\nX\nX\nX\nX\n\u221a\n\u03c9ill Xi f \uf8f8\n\u03c9ill Xi f \u2264 d \uf8ed\nXl2 f \u2212\nXl2 f \u2212\nLf =\nl=1\n\ni=1\n\ni=1\n\nl=1\n\nThis inequality and (2.24) readily give\n\n1\n(Lf )2 \u2264 ||\u22072Hf ||2 .\nd\nFrom this estimate and from (2.17) in Theorem 2.18 we obtain\n1\n(Lf )2 \u2264 \u03932 (f ) \u2212 R(f ) + S(f )\nd\n\u2264 \u03932 (f ) \u2212 \u03c11 \u0393(f ) \u2212 \u03c12 \u0393Z (f ) + S(f ),\n\n(2.27)\n\nwhere in the last inequality we have used the lower bound on R(f ) in the hypothesis\n(2.26). Using (2.16) and the Cauchy-Schwarz inequality we now find for every \u03bd > 0\n\uf8eb\n!2 \uf8f61/2\n!1/2\nh\nh\nd\nd\nd X\nXX X\nX\n|S(f )| \u2264 2 \uf8ed\n\u03b3ijm Xi f \uf8f8\n(Xj Zm f )2\nj=1 m=1\n\ni=1\n\nj=1 m=1\n\n1\nT (f ) + \u03bd\u0393Z2 (f ),\n\u03bd\nwhere in the second to the last equality we have used (2.18) and (2.25). Substituting the\nlatter inequality in (2.27) we find\n= 2T (f )1/2 \u0393Z2 (f )1/2 \u2264\n\n1\n1\n(Lf )2 \u2264 \u03932 (f ) + \u03bd\u0393Z2 (f ) + T (f ) \u2212 \u03c11 \u0393(f ) \u2212 \u03c12 \u0393Z (f ).\nd\n\u03bd\nAt this point it suffices to use the bound from above on T (f ) in (2.26) to reach the desired\nconclusion.\n\nThe next result shows that, remarkably, the generalized curvature-dimension inequality (1.12) in Definition 1.3 is equivalent to the geometric bounds (2.26) above.\nTheorem 2.20. Suppose that there exist constants \u03c11 \u2208 R, \u03c12 > 0 and \u03ba \u2265 0 such\nthat M satisfy the generalized curvature-dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d). Then, M\nsatisfies the geometric bounds (2.26). As a consequence of this fact and of Theorem 2.19\nwe conclude that\n(\nR(f ) \u2265 \u03c11 \u0393(f ) + \u03c12 \u0393Z (f ),\nCD(\u03c11 , \u03c12 , \u03ba, d) \u21d0\u21d2\nT (f ) \u2264 \u03ba\u0393(f ).\n\n\fFabrice Baudoin, Nicola Garofalo\n\n30\n\nProof. Let us fix x0 \u2208 M, u \u2208 Hx0 (M) and v \u2208 Vx0 (M). Let also \u03bd > 0. Let {X1 , ..., Xd , Z1 , ..., Zh }\nbe a local adapted frame around x0 . We claim that we can find a function f \u2208 C \u221e (M)\nsuch that:\n(i) \u2207H f (x0 ) = u,\n(ii) \u2207V f (x0 ) = v,\n(iii) \u22072H f (x0 ) = 0,\n(iv) Xj Zm f (x0 ) =\n\n1\n\u03bd\n\nPd\n\ni=1\n\n\u03b3ijm (x0 )ui .\n\nTo see this, we denote as before by \u2207R the Levi-Civita connection of the Riemannian\nmetric on M. Since {X1 , ..., Xd , Z1 , ..., Zh } is a local frame, we can find a local chart\n(U, \u03c6) at x0 , such that \u03c6(0) = x0 and in U we have Xj = \u2202x\u2202 j , j = 1, ..., d, Zm = \u2202z\u2202m ,\nm = 1, ..., h. We first observe that there exists a function f1 \u2208 C \u221e (M) such that\n(\n\u2207R f1 (x0 ) = u + v,\n\u2207R \u2207R f1 (x0 ) = 0.\nFor the explicit construction of such function f1 , see for instance the proof of Theorem\n3.1 and Lemma 3.2 in [49]. We can also find a function f2 \u2208 C \u221e (M) such that\n(\n\u2207R f2 (x0 ) = 0,\nP\nXj Zm f2 (x0 ) = \u03bd1 di=1 \u03b3ijm (x0 )ui \u2212 Xj Zm f1 (x0 ).\n\nIndeed, it will suffice to take as f2 the function that in the local coordinates\n(x, z) = (x1 , ..., xd , z1 , ..., zh )\nis expressed in the form\nf2 (x, z) =\n\nh\nd X\nX\n\nj=1 m=1\n\n!\nd\n1X m\n\u03b3 (x0 )ui \u2212 Xj Zm f1 (x0 ) xj zm .\n\u03bd i=1 ij\n\nIt is readily verified that such f2 satisfies the two above conditions. With this being done,\nwe now take f = f1 + f2 . It is clear that such f satisfies (i)-(iv) above. Now, using\nCD(\u03c11 , \u03c12 , \u03ba, d) on the function f , in combination with (i)-(iii) above, we find at the point\nx0 ,\n\u0010\n\u03ba\u0011\nkuk2 + \u03c12 kvk2 .\n\u03932 (f )(x0 ) + \u03bd\u0393Z2 (f )(x0 ) \u2265 \u03c11 \u2212\n\u03bd\nBut, from (2.17) in Theorem 2.18 and (iii) we have\n\u03932 (f )(x0 ) = R(f )(x0 ) + S(f )(x0 ).\n\n\fCurvature-dimension inequalities, etc.\n\n31\n\nBy (2.16) and (iii) we find\nS(f )(x0 ) = \u22122\n\nh\nd X\nX\n\n\u03b3ijm (x0 )Xj Zm f (x0 )Xi f (x0 )\n\ni,j=1 m=1\n\nh\nd\nd\n2 XX X m\n=\u2212\n\u03b3 (x0 )ui\n\u03bd j=1 m=1 i=1 ij\n\n!2\n\nh\nd\nd\n2 XX X m\nm\n\u03b3 (x0 )\u03b3lj\n(x0 )ul ui\n=\u2212\n\u03bd j=1 m=1 i,l=1 ij\n\n2\n= \u2212 T (f )(x0 ),\n\u03bd\n\nwhere in the last equality we have used (2.25). On the other hand, (2.18) and (iii) give\n!2\nh\nd\nd X\nX\nX\n1\n1\n\u03b3ijm (x0 )ui\n= 2 T (f )(x0 ),\n\u0393Z2 (f )(x0 ) = k\u2207H \u2207V f (x0 )k2 = 2\n\u03bd j=1 m=1 i=1\n\u03bd\nwhere in the last equality we have used (2.25) again. In conclusion,\n1\n\u03932 (f )(x0 )+\u03bd\u0393Z2 (f )(x0 ) = R(f )(x0 )+S(f )(x0 )+\u03bdk\u2207H \u2207V f (x0 )k2 = R(f )(x0 )\u2212 T (f )(x0 ).\n\u03bd\nWe thus infer from CD(\u03c11 , \u03c12 , \u03ba, d)\n\u0010\n\u03ba\u0011\n1\nkuk2 + \u03c12 kvk2\nR(f )(x0 ) \u2212 T (f )(x0 ) \u2265 \u03c11 \u2212\n\u03bd\n\u03bd\nWe finally note that (2.15) in Lemma 2.17 gives\n\u0013 X\nh\nd\nd X\nd \u001a\u0012 X\nX\nj\nm l\nk\n\u03b3kj \u03b4jm +\n(Xl \u03c9kj\n\u2212 Xj \u03c9lj\n)\nR(f )(x0 ) =\nk,l=1\nd\nX\n\nj=1 m=1\n\nd\nX\n\nj=1\n\n\u0012\n\u0013\u001b\n1 X\nj\nj\nl k\ni\ni\n+\n\u2212\n+\n\u03c9ij \u03c9ij \u2212 (\u03c9lj + \u03c9li )(\u03c9kj + \u03c9ki ) uk ul\n2\ni,j=1\ni=1\n1\u2264i<j\u2264d\n\u0013\nh \u0012 d\nd\nd\nX\nX\nXX X\nk m\nm\nl m\n\u03c9lj \u03b3lj \u2212\nXj \u03b3kj vm uk\n\u03c9jl \u03b3kj +\n+\ni l\n\u03c9ji\n\u03c9kj\n\nk=1 m=1\n\n+\n\n1\n2\n\nm=1\n\nj=1\n\n1\u2264l<j\u2264d\n\nl,j=1\n\nh\nX \u0012X\n\n1\u2264l<j\u2264d\n\ni\n\u03c9ki\n\u03c9lii\n\nm\n\u03b3lj\nvm\n\n\u00132\n\n,\n\n:= R(u, v),\nand that (2.25) gives\n\nT (f )(x0 ) =\n\nh\nd X\nd\nX\nX\nj=1 m=1\n\ni=1\n\n\u03b3ijm ui\n\n!2\n\n:= T (u).\n\nIn conclusion, we have proved that for every u \u2208 Hx0 (M) and v \u2208 Vx0 (M) and \u03bd > 0,\n\u0010\n\u03ba\u0011\n1\nkuk2 + \u03c12 kvk2 .\nR(u, v) \u2212 T (u) \u2265 \u03c11 \u2212\n\u03bd\n\u03bd\n\n\fFabrice Baudoin, Nicola Garofalo\n\n32\nBy first letting \u03bd \u2192 \u221e, we obtain\n\nR(u, v) \u2265 \u03c11 kuk2 + \u03c12 kvk2 .\nIf instead we let \u03bd \u2192 0, we find T (u) \u2264 kkuk2. This completes the proof.\n\n2.4 Carnot groups of step two\nCarnot groups of step 2 provide a natural reservoir of sub-Riemannian manifolds with\ntransverse symmetries. Let g be a graded nilpotent Lie algebra of step two. This means\nthat g admits a splitting g = V1 \u2295V2 , where [V1 , V1 ] = V2 , and [V1 , V2 ] = {0}. We endow g\nwith an inner product h*, *i with respect to which the decomposition V1 \u2295 V2 is orthogonal.\nWe denote by e1 , ..., ed an orthonormal basis of V1 and by \u03b51 , ..., \u03b5h an orthonormal basis\nof V2 . Let G be the connected and simply connected graded nilpotent Lie group associated\nwith g. Left-invariant vector fields in V2 are seen to be transverse sub-Riemannian Killing\nvector fields of the horizontal distribution given by V1 . The geometric assumptions of the\nprevious section are thus satisfied.\nLet Lx (y) = xy be the operator of left-translation on G, and indicate with dLx its\ndifferential. We indicate with Xj (x) = dLx (ej ), j = 1, * * * , d and Zm (x) = dLx (\u03b5m ),\nm = 1, * * * , h, the corresponding system of left-invariant vector fields on G. Using the\nBaker-Campbell-Hausdorff formula, we see that in exponential coordinates\nh\nd\n\u2202\n1 XX m\nXi =\n\u2212\n\u03b3 xl Zm\n\u2202xi 2 m=1 l=1 il\n\nwhere \u03b3ilm = h[ei , el ], \u03b5m i are the group constants. From the latter equation we see that\n[Xi , Xj ] =\n\nh\nX\n\n\u03b3ijm Zm .\n\n(2.28)\n\nm=1\n\nWe note that X1 , ..., Xd , Z1 , ..., Zh is a global adapted frame on G.\nA canonical sub-Laplacian on G is given by\nL=\n\nd\nX\n\nXi2 .\n\ni=1\n\nIf we endow G with a bi-invariant Haar measure \u03bc, then Xi\u2217 = \u2212Xi , see e.g. [29]. Therefore, L is symmetric with respect to \u03bc.\nIn the present setting we have\n\u0393(f ) =\n\nd\nX\ni=1\n\n2\n\n(Xi f ) ,\n\nZ\n\n\u0393 (f ) =\n\nh\nX\n\n(Zm f )2 .\n\nm=1\n\n\fCurvature-dimension inequalities, etc.\n\n33\n\nIf we use Lemma 2.17, then we easily see that\nh\nd\n1X X m\n\u03b3 Zm f\nR(f ) =\n4 i,j=1 m=1 ij\n\n!2\n\n.\n\n!2\n\n.\n\n!2\n\n,\n\n!2\n\n.\n\nFrom this expression it is clear that\nR(f ) \u2265 \u03c12 \u0393Z (f ),\nwith\nh\nd\n1X X m\n\u03b3ij zm\n\u03c12 = inf\nkzk=1 4\ni,j=1 m=1\n\n(2.29)\n\nFurthermore, from (2.25) one has\n\nT (f ) =\n\nh\nd X\nX\n\nj=1 m=1\n\nd\nX\n\n\u03b3ijm Xi f\n\ni=1\n\nand therefore\nT (f ) \u2264 \u03ba\u0393(f ),\nwith\n\u03ba = sup\n\nh\nd X\nX\n\nkxk=1 j=1 m=1\n\nd\nX\ni=1\n\n\u03b3ijm xi\n\n(2.30)\n\nFrom these considerations in view of Theorem 2.19 we immediately obtain the following\nresult.\nProposition 2.21. Let G be a Carnot group of step two, with d being the dimension of the\nhorizontal layer of its Lie algebra. Then, G satisfies the generalized curvature-dimension\ninequality CD(0, \u03c12 , \u03ba, d) (with respect to any sub-Laplacian L on G), with \u03c12 and \u03ba\nrespectively given by (2.29) and (2.30).\nIn particular, in our framework, every Carnot group of step two is a sub-Riemannian\nmanifold with nonnegative Ricci tensor.\n2.4.1 Groups of Heisenberg type\nA significant class of Carnot groups of step two is that of groups of Heisenberg type.\nSuch groups constitute a generalization of the Heisenberg group and they carry a natural\ncomplex structure. Groups of Heisenberg type (aka H-type groups) were first introduced\nby Kaplan [37] in connection with the study of hypoellipticity and they were further\ndeveloped in [22], where the authors characterized those groups of H-type which arise\nas the nilpotent component in the Iwasawa decomposition of simple Lie groups of real\n\n\fFabrice Baudoin, Nicola Garofalo\n\n34\n\nrank one. In a Carnot group of step two G consider the map J : V2 \u2192 End(V1 ) defined\nfor every \u03b7 \u2208 V2 by\n< J(\u03b7)\u03be, \u03be \u2032 >=< [\u03be, \u03be \u2032], \u03b7 >,\n\n\u03be, \u03be \u2032 \u2208 V1 , \u03b7 \u2208 V2 .\n\nThen, G is said of H-type if J(\u03b7) is an orthogonal map on V1 for every \u03b7 \u2208 V2 such that\n||\u03b7|| = 1. When G is of H-type we thus have for \u03be, \u03be \u2032 \u2208 V1 , \u03b7 \u2208 V2 ,\n< J(\u03b7)\u03be, J(\u03b7)\u03be \u2032 >= ||\u03b7||2 < \u03be, \u03be \u2032 > .\nThe J map induces a complex structure since in every group of H-type one has for every\n\u03b7, \u03b7 \u2032 \u2208 V2 ,\nJ(\u03b7)J(\u03b7 \u2032) + J(\u03b7 \u2032 )J(\u03b7) = \u22122 < \u03b7, \u03b7 \u2032 > I,\nsee [22]. In particular,\nJ(\u03b7)2 = \u2212||\u03b7||2I.\nSince in a Carnot group of step two we always have [ei , ej ] =\n\nPh\n\ns=1\n\n\u03b3ijs \u03b5s , we obtain\n\n< J(\u03b5m )ei , ej >=< [ei , ej ], \u03b5m >= \u03b3ijm .\nWhen G is of H-type we thus find for z =\nh\nd\n1X X m\n\u03b3 zm\n4 i,j=1 m=1 ij\n\n!2\n\nPh\n\nm=1 zm \u03b5m ,\n\nd\nd\n1X\n< J(z)ei , ej >2 = ||z||2 .\n=\n4 i,j=1\n4\n\nIn view of (2.29) we conclude that, when G is of H-type, then \u03c12 =\nPd\ni=1 xi ei one has,\nh\nd X\nX\n\nj=1 m=1\n\nd\nX\ni=1\n\n\u03b3ijm xi\n\n!2\n\n=\n\nh\nd X\nX\n\nj=1 m=1\n\n2\n\nhJ(\u03b5m )x, ej i =\n\nh\nX\n\nm=1\n\nd\n.\n4\n\nAlso, for x =\n\nkJ(\u03b5m )xk2 = hkxk2 .\n\nIn view of (2.30) we conclude \u03ba = h. Combining these considerations with Proposition\n2.21, we have thus proved the following result.\nProposition 2.22. Let G be a group of H-type. Then, G satisfies the generalized curvaturedimension inequality CD(0, d4 , h, d) with respect to any sub-Laplacian L.\n\n2.5 CR Sasakian manifolds\nAnother interesting class of sub-Riemannian manifolds with transverse symmetries is\ngiven by the class of CR Sasakian manifolds. For all the known results cited in this section\nwe refer the reader to the monograph [25]. Let M be a non degenerate CR manifold of\nreal hypersurface type and dimension d + 1, where d = 2n. Let \u03b8 be a pseudo-hermitian\n\n\fCurvature-dimension inequalities, etc.\n\n35\n\nform on M with respect to which the Levi form L\u03b8 is positive definite. The kernel of \u03b8\ndetermines the horizontal bundle H. Denote now by Z the Reeb vector field on M, i.e.,\nthe characteristic direction of \u03b8. It is an immediate consequence of Theorem 1.3 on p. 25\nin [25] that the canonical connection \u2207 introduced in Section 2.3.1 coincides with the\nTanaka-Webster connection on M. The sub-Laplacian L introduced in Section 2.3 is then\nthe classical CR sub-Laplacian, see Definition 2.1 on p. 111 of [25].\nLike in the Riemannian case, the pseudo-hermitian torsion with respect to \u2207 is\nT(X, Y ) = \u2207X Y \u2212 \u2207Y X \u2212 [X, Y ].\nDefinition 2.23. The CR manifold (M, \u03b8) is called Sasakian if the pseudo-hermitian torsion vanishes, in the sense that\nT(Z, X) = 0,\nfor every X \u2208 H.\nIn every Sasakian manifold the Reeb vector field Z is a sub-Riemannian Killing vector\nfield (see Theorem 1.5 on p. 42 and Lemma 1.5 on p. 43 in [25]). In this situation, the\nbilinear forms R, T take a particularly nice form. Indeed, in the Sasakian case, the torsion\nT of the Tanaka-Webster connection is given, for horizontal vector fields X and Y, by\nT(X, Y ) = hJX, Y iZ,\nwhere J is the complex structure on M. Since \u2207J = 0, we obtain from (2.13) in Definition\n2.15,\n!\nd\n1 X\nR(f ) = Ric(\u2207H f, \u2207H f ) +\n(2.31)\nhJXl , Xk i2 (Zf )2 .\n4\nl,k=1\n\nSince\n\nd\nX\n\n2\n\nhJXl , Xk i =\n\nl,k=1\n\nd\nX\nk=1\n\nkJXk k2 = d,\n\nwe conclude from (2.31) that\nd\nR(f ) = Ric(\u2207H f, \u2207H f ) + \u0393Z (f ).\n4\nAlso, from (2.25)\nT (f ) =\n\nd\nX\ni=1\n\nhJ\u2207H f, Xi i2 = kJ\u2207H f k2 = \u0393(f ).\n\nAs a straightforward consequence of these considerations we thus obtain from Theorem\n2.19.\n\n\f36\n\nFabrice Baudoin, Nicola Garofalo\n\nTheorem 2.24. Assume that the Tanaka-Webster Ricci tensor is bounded from below by\n\u03c11 \u2208 R on smooth functions, that is for every f \u2208 C \u221e (M)\nRic(\u2207H f, \u2207H f ) \u2265 \u03c11 k\u2207H f k2 .\nThen, the Sasakian manifold M satisfies the generalized curvature-dimension inequality\nCD(\u03c11 , d4 , 1, d), with d = 2n.\nRemark 2.25. The example of CR Sasakian manifolds, together with that of H-type\ngroups studied in Section 2.4.1, suggests the existence of an interesting class of subRiemannian manifolds with transverse symmetries. Indeed, returning to the setting and\nnotations of Section 2.3, for Z \u2208 V consider the map J(Z) defined on the horizontal\nbundle H by\nhJ(Z)X, Y i = hZ, T (X, Y )i.\n\nSuppose that J(Z) is orthogonal for every Z \u2208 V such that kZk = 1, and that furtherP\nmore dk=1 \u2207Xk J(Z) = 0. In that case, similarly to the case of groups of the H-type\ncase and Sasakian manifolds we can prove that, if the horizontal Ricci curvature of the\ncanonical connection \u2207 is bounded from below by \u03c11 , then M satisfies the generalized\ncurvature-dimension inequality CD(\u03c11 , d4 , h, d). An example of such structure is given by\nthe Hopf fibration S7 \u2192 S4 and, more generally, by the so-called 3 Sasakian manifolds\n(see [16] for an account on these geometric structures).\n\n2.6 Principal bundles over Riemannian manifolds\nSub-Riemannian structures with transverse symmetries also naturally arise in the context\nof principal bundles over Riemannian manifolds. Let (M, g) be a C \u221e connected Riemannian manifold with dimension d. Let us consider the orthonormal frame bundle O (M)\nover M. The kernel of the Levi-Civita connection form defines the distribution H of horizontal directions. If the Riemannian curvature form is non-degenerate this distribution\nis two-step bracket generating (see for instance Chapter 3 in [12]). The set of vertical\ndirections is then given by the vector fields that are tangent to the fibers of the bundle projection. It is then easily seen that in such case V \u2243 sod (R), and therefore that the vertical\nbundle is generated by the sub-Riemannian Killing vector fields of the horizontal bundle.\nWe therefore have an example of a sub-Riemannian manifold with transverse symmetries.\nIn this example the geometric quantities introduced in Section 2.2 may be interpreted in\nterms of the geometry of M.\nFirst, let us observe that we can find a globally defined adapted frame. For each x \u2208 Rd\nwe can define a horizontal vector field Hx on O (M) by the property that at each point\nu \u2208 O(M), Hx (u) is the horizontal lift of u(x) from u. If (e1 , ..., ed ) is the canonical basis\n\n\fCurvature-dimension inequalities, etc.\n\n37\n\nof Rd , the fundamental horizontal vector fields are then defined by\nHi = He i .\nNow, for every M \u2208 od (R) (space of d \u00d7 d skew-symmetric matrices), we can define a\nvertical vector field VM on O (M) by\n\u0001\nF uetM \u2212 F (u)\n,\n(VM F )(u) = lim\nt\u21920\nt\nwhere u \u2208 O (M) and F : O (M) \u2192 R. If Eij , 1 \u2264 i < j \u2264 d denote the canonical\nbasis of od (R) (Eij is the matrix whose (i, j)-th entry is 1/2, (j, i)-th entry is \u22121/2, and\nall other entries are zero), then the fundamental vertical vector fields are given by\nVij = VEij .\nIt can be shown that we have the following Lie bracket relations:\nX\n[Hi , Hj ] = \u22122\n\u03a9kl\nij Vkl ,\nk<l\n\n1\n1\n[Hi , Vjk ] = \u2212\u03b4ij Hk + \u03b4ik Hj ,\n2\n2\nwhere \u03b4ij = 1 if i = j and 0 otherwise, and where \u03a9 is the Riemannian curvature form:\n\u03a9(X, Y )(u) = u\u22121 R(\u03c0\u2217 X, \u03c0\u2217 Y )u, X, Y \u2208 Tu O (M) ,\nR denoting the Riemannian curvature tensor on M and \u03c0 the canonical projection O (M) \u2192\nM.\nIn this structure, the sub-Laplacian L is the so-called horizontal Bochner Laplace operator. It is by definition the diffusion operator on O (M) given by\n\u2206O(M) =\n\nd\nX\n\nHi2 .\n\ni=1\n\nIts fundamental property is that it is the lift of the Laplace-Beltrami operator \u2206M of M.\nThat is, for every smooth f : M \u2192 R,\n\u2206O(M) (f \u25e6 \u03c0) = (\u2206M f ) \u25e6 \u03c0.\nThe canonical sub-Riemannian connection \u2207 is easily expressed in terms of the Ehresman bundle connection. Let us recall (see for instance Chapter 3 in [12]) that the Ehresmann connection form \u03b1 on O (M) is the unique skew-symmetric matrix \u03b1 of one forms\non O (M) such that:\n\n\fFabrice Baudoin, Nicola Garofalo\n\n38\n1. \u03b1(X) = 0 if and only if X \u2208 HO(M);\n2. V\u03b1(X) = X if and only if X \u2208 VO(M),\n\nwhere HO(M) denotes the horizontal bundle and VO(M) the vertical bundle. It is then\neasily verified that for a vector field Y on O(M),\n\u2207Y H i =\n\nd\nX\n\n\u03b1jk (Y )Hk .\n\nk=1\n\nLet us observe that if X, Y are smooth horizontal vector fields then we have for the torsion:\nT(X, Y ) = V\u03a9(X,Y ) .\nWe then obtain after straightforward computations\n\u2217\n\nR(f, f ) =Ric (\u2207H f, \u2207H f ) \u2212\n\nd\nX\n\nV(\u2207Hj \u03a9)(Hj ,Hk ) f Hk f +\n\nj,k=1\n\n\u00012\n1\nV\u03a9(Hj ,Hk ) f ,\n4\n\nwhere for horizontal vector fields X and Y ,\nRic\u2217 (X, Y ) = Ric(\u03c0\u2217 X, \u03c0\u2217 Y ),\nand Ric denotes the Ricci tensor of M. In the same vein we have\nT (f ) =\n\nd\nX\ni=1\n\n2\n\nkT(Hi , \u2207H f )k =\n\nd\nX\ni=1\n\nkV\u03a9(Hi ,\u2207H f ) k2 .\n\nWe then observe that the expression of R simplifies if for every horizontal vector field X,\nd\nX\n\n(\u2207Hj \u03a9)(Hj , X) = 0.\n\nj=1\n\nUsing the second Bianchi identity, it is seen that this latter condition is equivalent to the\nfact that the Ricci tensor of M is a Codazzi tensor, that is for any vector fields X, Y, Z on\nM,\n(\u2207X Ric)(Y, Z) = (\u2207Y Ric)(X, Z).\nAs a conclusion we then obtain from Theorem 2.19.\nProposition 2.26. Let (M, g) be a C \u221e connected Riemannian manifold with dimension\nd. Assume that:\n1. Ric is a Codazzi tensor;\n2. There exists \u03c11 \u2265 0 such that Ric \u2265 \u03c11 ;\n\n\fCurvature-dimension inequalities, etc.\n\n39\n\n3. There exists \u03c12 > 0 such that for every U \u2208 sod (R),\nd\nX\n\nh\u03a9(Hj , Hk ), Ui2 \u2265 4\u03c12 kUk2 ;\n\ni,j=1\n\n4. There exists \u03ba \u2265 0 such that for every horizontal vector field X.\nd\nX\ni=1\n\nk\u03a9(Hi , X)k2 \u2264 \u03bakXk2 ,\n\nThen, the horizontal Bochner operator of O(M) satisfies the generalized curvature-dimension\ninequality CD(\u03c11 , \u03c12 , \u03ba, d).\nThe previous assumptions are readily satisfied in the case of spaces with constant\ncurvature and, after some standard computations, we obtain the following result.\nCorollary 2.27. Let (M, g) be a C \u221e connected Riemannian manifold with dimension\nd and constant curvature K 6= 0. The sub-Riemannian\nstructure of O(M) \u0011\nsatisfies the\n\u0010\nd\n2 d(d\u22121)\n2\ngeneralized curvature dimension inequality CD (d \u2212 1)K, 4 K , 2 K , d .\n\nActually, more general principal bundles provide examples of sub-Riemannian structures with transverse symmetries. Let \u03c0 : (M, g) \u2192 (M\u2032 , g \u2032 ) be the projection of a principal fibre bundle with structure group a compact, semisimple Lie group G with dimension\nh equipped with its bi-invariant metric given by the Cartan-Killing form. We suppose that\n\u03c0 is a Riemannian submersion with totally geodesic fibres isometric to G. We denote by \u03b8\nthe one-form of the principal connection corresponding to the horizontal distribution H.\nIf H is bracket generating, then we have an example of a sub-Riemannian structure with\ntransverse symmetries.\nLet\n \u0303 X Y H )V + (\u2207\n \u0303 X Y V )H ,\nAX Y = (\u2207\nH\nH\nbe the O'Neill's tensor of the submersion. When X and Y are horizontal vector fields we\nhave T(X, Y ) = \u22122AX Y , where, as usual, T denotes the torsion of the canonical subRiemannian connection. As a consequence, A is the skew-symmetrization of \u2212 21 T. The\nconnection form \u03b8 is a Yang-Mills connection if for every horizontal vector field X, the\nvertical component of\nd\nX\n(\u2207Xl T)(Xl , X)\nl=1\n\nis zero (see for instance [26], p. 146). As a consequence of Theorem 2.19, we then obtain\nthe following result.\nProposition 2.28. Let us assume that:\n\n\fFabrice Baudoin, Nicola Garofalo\n\n40\n1. \u03b8 is a Yang-Mills connection;\n\n2. there exists \u03c11 \u2265 0 such that Ric\u2032 \u2265 \u03c11 where Ric\u2032 is the Ricci tensor of (M\u2032 , g \u2032);\n3. there exists \u03c12 > 0 such that for every vertical vector field Z,\nd\nX\ni=1\n\nkAXi Zk2 \u2265 \u03c12 kZk2 ;\n\n4. there exists \u03ba \u2265 0 such that for every horizontal vector field X,\nh\nX\n\nm=1\n\nkAX Zi k2 \u2264 \u03bakXk2 .\n\nThen, the sub-Riemannian structure on M given by the submersion \u03c0 : (M, g) \u2192 (M\u2032 , g \u2032)\nsatisfies the generalized curvature dimension inequality CD(\u03c11 , \u03c12 , \u03ba, d).\nRemark 2.29. If G is simple, then by Ad invariance, it is seen that\nd\nX\n\nkAXi Zk2 =\n\nh\nX\n\nkAX Zi k2 \u2264 kAk2 kXk2 .\n\ni=1\n\nkAk2\nkZk2 ,\nh\n\nand\nm=1\n\n3 Second derivatives estimates\nIn this section, in the context of sub-Riemannian manifolds with transverse symmetries,\nwe develop some basic tools to obtain bounds on the second derivatives that will later be\nused.\nLet M be a sub-Riemannian manifold with transverse symmetries as in the previous\nsection. If X1 , * * * , Xd is a local frame of horizontal vector fields, we define the tensor\n\u03b4T (V ) =\n\nd\nX\n\n(\u2207Xl T)(Xl , V )\n\nl=1\n\nMotivated by the examples of the previous section, we set the following definition:\nDefinition 3.1. The sub-Riemannian manifold M is said to be of Yang-Mills type, if for\nevery horizontal vector field X,\n\u03b4T (X) = 0.\n\n\fCurvature-dimension inequalities, etc.\n\n41\n\nFor instance, Riemannian manifolds, CR Sasakian manifolds and Carnot groups of\nstep 2 are examples of sub-Riemannian manifolds with transverse symmetries of YangMills type.\nProposition 3.2. Suppose that M is of Yang-Mills type and that there exist constants\n\u03c11 \u2208 R, \u03c12 > 0 and \u03ba \u2265 0 such that\n(\nR(f ) \u2265 \u03c11 \u0393(f ) + \u03c12 \u0393Z (f ),\nT (f ) \u2264 \u03ba\u0393(f ),\nhold for every f \u2208 C \u221e (M). Then, for f \u2208 C \u221e (M), and \u03bd > 0, one has\n\u0010\n\u0010\n\u0011\n\u03ba\u0011\n\u0393(\u0393(f )) \u2264 4\u0393(f ) \u03932 (f ) + \u03bd\u0393Z2 (f ) \u2212 \u03c11 \u2212\n\u0393(f ) ,\n\u03bd\n\nand\n\n\u0393(\u0393Z (f )) \u2264 4\u0393Z (f )\u0393Z2 (f ).\nProof. Let f \u2208 C \u221e (M) and x0 \u2208 M. We assume that \u2207H f (x0 ) 6= 0, otherwise the inequality is straightforward. We can find a local adapted frame {X1 , * * * , Xd , Z1 , * * * , Zh }\nin the neighborhood of x0 such that\nX1 f = 0, * * * , Xd f = k\u2207H f k.\nIn this frame, we have\nd\nX\n\n\u0393(\u0393(f )) = 4\n\n!\n\n(Xi Xd f )2 \u0393(f ),\n\ni=1\n\nand\nk\u22072H f k2 =\n\nd\nX\nl=1\n\nXl2 f \u2212\n\nd\nX\ni=1\n\n\u03c9ill Xi f\n\n!2\n\nd\n\n+2\n\n1\u2264l<j\u2264d\n\nd\nBy observing that Xj Xl f = 0 if l 6= d and Xj Xd f = \u03c9jd\nXd f +\nreach the conclusion that\n\n\u0393(\u0393(f )) \u2212\n\n4k\u22072H f k2 \u0393(f )\n\n\u2264 2\u0393(f )\n\u2264 2\u0393(f )\n\nj\n\nX \u03c9ijl + \u03c9il\nXj Xl + Xl Xj\nf\u2212\nXi f\n2\n2\ni=1\n\nX\n\nd\nX\nl=1\n\nh\nX\n\nm=1\n\nm\n\u03b3ld\nZm f\n\nm=1\n\nh\nX \u0012X\n\n1\u2264l<j\u2264d\n\nPh\n\nm=1\n\nNow, from (2.17) in Theorem 2.18 we have\n\u03932 (f ) = k\u22072H f k2 + R(f ) + S(f ).\n\nm\n\u03b3jd\nZm f we easily\n\n!2\n\nm\n\u03b3lj\nZm f\n\n\u00132\n\n!2\n\n.\n\n\fFabrice Baudoin, Nicola Garofalo\n\n42\n\nFrom this identity and the proof of Theorem 2.19, we obtain for every \u03bd > 0\n\u03ba\n\u03932 (f ) + \u03bd\u0393Z2 (f ) \u2265 ||\u22072H f ||2 \u2212 \u0393(f ) + R(f ).\n\u03bd\n\n(3.1)\n\nTherefore we have\nh\nX \u0012X\n\n1\n\u03ba\n\u0393(\u0393(f )) \u2264 4\u0393(f ) \u03932 (f ) + \u03bd\u0393Z2 (f ) + \u0393(f ) \u2212 R(f ) +\n\u03bd\n2 1\u2264l<j\u2264d\n\nm=1\n\nm\n\u03b3lj\nZm f\n\n\u00132 !\n\n.\n\nFrom the Yang-Mills assumption we have\n\u0012X\n\u00132\nh\n1 X\nm\nR(f ) \u2212\n\u03b3 Zm f\n2 1\u2264l<j\u2264d m=1 lj\n\u0013 X\nh\nd\nd X\nd \u001a\u0012 X\nX\nj\nk\nm l\n(Xl \u03c9kj\n\u2212 Xj \u03c9lj\n)\n\u03b3kj \u03b4jm +\n=\nk,l=1\n\n+\n\nd\nX\n\nj=1 m=1\n\ni l\n\u03c9kj\n\u03c9ji\n\ni,j=1\n\nand thus\n\n\u2212\n\nj=1\n\nd\nX\n\ni\n\u03c9ki\n\u03c9lii\n\ni=1\n\n\u0012\n\u0013\u001b\n1 X\nj\nj\nl k\ni\ni\n\u03c9ij \u03c9ij \u2212 (\u03c9lj + \u03c9li )(\u03c9kj + \u03c9ki ) Xk f Xl f,\n+\n2 1\u2264i<j\u2264d\n\n\u0012X\n\u00132\nh\n1 X\nm\n\u03b3 Zm f\n\u2265 \u03c11 \u0393(f ).\nR(f ) \u2212\n2 1\u2264l<j\u2264d m=1 lj\n\nPuttings things together, we conclude\n\u0010\n\u0010\n\u0011\n\u03ba\u0011\nZ\n\u0393(\u0393(f )) \u2264 4\u0393(f ) \u03932 (f ) + \u03bd\u03932 (f ) \u2212 \u03c11 \u2212\n\u0393(f ) .\n\u03bd\n\nThe proof of\n\n\u0393(\u0393Z (f )) \u2264 4\u0393Z (f )\u0393Z2 (f ).\nis easy and let to the reader.\nIn the sequel of this section we assume that M is complete and that there exist constants\n\u03c11 \u2208 R, \u03c12 > 0 and \u03ba \u2265 0 such that (2.26) hold for every f \u2208 C \u221e (M). The assumed\ncompleteness of M implies that the Hypothesis 1.1 be satisfied, that is that there exists an\nincreasing sequence hk \u2208 C0\u221e (M) such that hk \u0580 1 on M, and\n||\u0393(hk )||\u221e + ||\u0393Z (hk )||\u221e \u2192 0, as k \u2192 \u221e.\nFollowing an argument of Strichartz [53], (Theorem 7.3 p. 246 and p. 261), this implies\nthat the operators L and L + LZ are both essentially self-adjoint on the space C0\u221e (M),\nwhere we have let\nh\nX\n\u2217\nZ\nZm\nZm .\nL =\u2212\nm=1\n\nIn the sequel, we will denote by D(L) the domain of the self-adjoint extension of L.\n\n\fCurvature-dimension inequalities, etc.\n\n43\n\nLemma 3.3. The operators L and L + LZ spectrally commute, that is for any bounded\nBorel function \u03a8 : (\u2212\u221e, 0] \u2192 R and any f \u2208 L2 (M),\n\u03a8(L)\u03a8(L + LZ )f = \u03a8(L + LZ )\u03a8(L)f.\nProof. Let f \u2208 C0\u221e (M). We first observe that\nZ\n\u0393Z (f, Lf )d\u03bc \u2264 0.\n\n(3.2)\n\nM\n\nTo see this we note that, thanks to Lemma 2.10, we have\nZ\nZ\nh Z\nh Z\nX\nX\nZ\nZ\n\u0393(Zm f )d\u03bc \u2264 0.\n\u0393(Zm f )d\u03bc = \u22122\n2\n\u0393 (f, Lf )d\u03bc =\nL\u0393 (f )d\u03bc\u22122\nM\n\nM\n\nM\n\nm=1\n\nm=1\n\nM\n\nNext, we observe that for every f, g \u2208 C0\u221e (M) we have\nZ\nZ\nZ\nZ\nZ\nZ\nZ\n0=\nL (f g)d\u03bc =\nf L gd\u03bc +\ngL f d\u03bc + 2\n\u0393Z (f, g)d\u03bc.\nM\n\nWith f \u2208\n\nC0\u221e (M)\n\nM\n\nM\n\nM\n\nand g = Lf , this gives\nZ\nZ\nZ\n\u22122\n\u0393 (f, Lf )d\u03bc = 2\nLf LZ f d\u03bc.\nM\n\nM\n\nIn view of (3.2) this gives for any f \u2208\nZ\nM\n\nC0\u221e (M)\n\nLf LZ f d\u03bc \u2265 0.\n\nC0\u221e (M)\n\nIn turn, this implies for all f \u2208\nZ\nZ\n2\n(Lf ) d\u03bc \u2264\n(Lf + LZ f )2 d\u03bc.\nM\n\n(3.3)\n\nM\n\nBut then, the inequality (3.3) continues to be true for f \u2208 D(L + LZ ). Let now f \u2208 D(L)\nand consider the function,\n\u03c6(x, t) = LQt f (x),\nwhere Qt is the heat semigroup associated with L + LZ . Since L and L + LZ commute\non smooth functions (see Lemma 2.10), we easily see that \u03c6 solves the heat equation\n\u2202\u03c6\n= (L + LZ )\u03c6,\n\u2202t\nwith initial condition \u03c6(x, 0) = Lf (x). From (3.3), we have that for every t \u2265 0,\nR\n\u03c6(x, t)2 d\u03bc < \u221e. Thus by uniqueness in L2 of solutions of the heat equation, we\nM\nconclude that \u03c6(x, t) = LQt f (x) = Qt Lf (x). By a similar argument, we may prove that\nfor every f \u2208 L2 (M), s, t \u2265 0\nPs Qt f = Qt Ps f,\nwhich implies that L and L + LZ spectrally commute, see Reed and Simon [48] (Chapter\n8, Section 5).\n\n\fFabrice Baudoin, Nicola Garofalo\n\n44\n\nLemma 3.4. There is a constant C = C(\u03c11 , \u03c12 , \u03ba) > 0 such that for every smooth function f belonging to D(L2 ), one has\nZ\n0\u2264\u2212\n\u0393Z (f, Lf )d\u03bc \u2264 Ckf k2D(L2 ) ,\nM\n\nwhere\nkf k2D(L2 )\n\n=\n\nZ\n\nM\n\n2\n\nf d\u03bc +\n\nZ\n\n(L2 f )2 d\u03bc.\nM\n\nProof. From Theorem 2.19 we have for every \u03bd > 0\n\u0010\n\u03ba\u0011\nZ\n\u03932 (f ) + \u03bd\u03932 (f ) \u2265 \u03c11 \u2212\n\u0393(f ) + \u03c12 \u0393Z (f ).\n\u03bd\n\nSince\n\n2\u03932 (f ) = L\u0393(f ) \u2212 2\u0393(f, Lf ),\nand\n2\u0393Z2 (f ) = L\u0393Z (f ) \u2212 2\u0393Z (f, Lf ),\nwe deduce by an integration over M that for \u03bd > 0,\nZ\nZ\nZ\nZ\n\u0010\n\u03ba\u0011\n2\nZ\n\u0393(f )d\u03bc + \u03c12\n\u0393Z (f )d\u03bc.\n(Lf ) d\u03bc + \u03bd\nLf L f d\u03bc \u2265 \u03c11 \u2212\n\u03bd\nM\nM\nM\nM\nR\nR\n(One should keep in mind that, since f \u2208 C0\u221e (M), we have M L\u0393(f )d\u03bc = M L\u0393Z (f )d\u03bc =\nR\nR\nR\nR\n0, and that \u2212 M \u0393(f, Lf )d\u03bc = M (Lf )2 d\u03bc, \u2212 M \u0393Z (f, Lf )d\u03bc = M Lf LZ f d\u03bc.) The\nlatter inequality can be re-written as\nZ\nZ\nZ\nZ\n\u0010\n\u03ba\u0011\n2\nZ\n(\u2212Lf )f d\u03bc + \u03c12 (\u2212LZ f )f d\u03bc.\n(Lf ) d\u03bc + \u03bd\nLf L f d\u03bc \u2265 \u03c11 \u2212\n\u03bd\nM\nM\nM\nM\nFrom Lemma 2.10, the diffusion operators L and L + LZ spectrally commute, therefore\nfrom the spectral theorem, there is a measure space (\u03a9, \u03b1), a unitary map U : L2\u03b1 (\u03a9, R) \u2192\nL2 (M) and real valued measurable functions \u03bb and \u03bbZ on \u03a9 such that for x \u2208 \u03a9,\nU \u22121 LUg(x) = \u2212\u03bb(x)g(x),\nU \u22121 LZ Ug(x) = \u2212\u03bbZ (x)g(x).\nFrom the previous inequality, we obtain\n\u0010\n\u03ba\u0011\nk\u03bbU \u22121 f k2L2\u03b1 +\u03bdh\u03bbU \u22121 f, \u03bbZ U \u22121 f iL2\u03b1 \u2265 \u03c11 \u2212\nh\u03bbU \u22121 f, U \u22121 f iL2\u03b1 +\u03c12 h\u03bbZ U \u22121 f, U \u22121 f iL2\u03b1 .\n\u03bd\nSince it holds for every smooth and compactly supported functions, we deduce that for\nevery \u03bd > 0, we have almost everywhere with respect to \u03b1,\n\u0010\n\u03ba\u0011\n2\nZ\n\u03bb(x) + \u03c12 \u03bbZ (x).\n\u03bb (x) + \u03bd\u03bb (x)\u03bb(x) \u2265 \u03c11 \u2212\n\u03bd\n\n\fCurvature-dimension inequalities, etc.\n\n45\n\nIn particular, by choosing\n\u03bd = \u03c12 (\u03bb(x) + 1)\u22121 ,\nwe obtain the following inequality on the spectral measures\n\u0013\n\u0012\n\u0013\n\u0012\n\u03ba\n\u03ba\n\u03c12 \u03bbZ\n\u03bb+ 1+\n\u03bb2 .\n\u2264 \u2212 \u03c11 \u2212\n\u03bb+1\n\u03c12\n\u03c12\nAs a consequence, for any f \u2208 D(L2 ),\n\u0012\n\u0013 \u0012Z\n\u0013\nZ\nZ\n\u03ba\nZ\n2\n\u03c12 (\u2212L f )f d\u03bc \u2264 \u2212 \u03c11 \u2212\n(\u2212Lf )f d\u03bc + (Lf ) d\u03bc\n\u03c12\nM\nM\n\u0013 \u0012Z\n\u0013\n\u0012\nZ M\n\u03ba\n2\n2\n(Lf ) d\u03bc + (\u2212Lf )(L f )d\u03bc\n+ 1+\n\u03c12\nM\nM\n\n(3.4)\n\n(3.5)\n\nBy denoting\nR = \u03c12 (\u2212L + Id)\u22121 ,\nwe also deduce from 3.4 that for every f \u2208 D(L),\n\u0013Z\n\u0012\n\u0013Z\n\u0012\nZ\n\u03ba\n\u03ba\nZ\n\u2212f Lf d\u03bc + 1 +\n(Lf )2 d\u03bc.\n\u03c12 (\u2212L f )(Rf )d\u03bc \u2264 \u2212 \u03c11 \u2212\n\u03c1\n\u03c1\n2\n2\nM\nM\nM\nBy using now the above inequality with \u2212Lf + f instead of f , and using (3.5) we obtain\nthe desired inequality.\n\nRemark 3.5. The previous proof also shows the following inclusion of domains:\nD(L2 ) \u2282 D(L + LZ ) \u2282 D(L).\nAs a consequence of the previous inequality , we obtain the following useful a priori\nbounds.\nProposition 3.6. There exists a positive constant C = C(\u03c11 , \u03c12 , \u03ba) > 0 such that for\nevery smooth function f belonging to D(L2 ),\nZ\n\u0393Z (f )d\u03bc \u2264 Ckf k2D(L2 ) ,\nM\n\nZ\n\nM\n\nZ\n\nM\n\n\u0393Z2 (f )d\u03bc \u2264 Ckf k2D(L2 ) ,\n\n\u0001\n\u03932 (f ) + \u0393Z2 (f ) \u2212 (\u03c11 \u2212 \u03ba) \u0393(f ) d\u03bc \u2264 Ckf k2D(L2 ) .\n\n\fFabrice Baudoin, Nicola Garofalo\n\n46\n\nProof. Let f \u2208 C0\u221e (M). According to Lemma 3.4, we have\nZ\nZ\nZ\n\u03932 (f )d\u03bc = \u2212\n\u0393Z (f, Lf )d\u03bc \u2264 C1 kf k2D(L2) .\nM\n\nM\n\nThen, we get\nZ\n\nM\n\n\u03932 (f )d\u03bc = \u2212\n\nZ\n\n\u0393(f, Lf )d\u03bc =\nM\n\nZ\n\nM\n\n(Lf )2 d\u03bc \u2264 kf k2D(L2 ) ,\n\nand\nZ\n\nZ\nZ\n\u0010\n\u03ba\u0011\n(Lf ) d\u03bc + \u03bd\nLf L f d\u03bc \u2265 \u03c11 \u2212\n\u0393(f, f )d\u03bc + \u03c12\n\u0393Z (f, f )d\u03bc.\n\u03bd\nM\nM\nM\nM\nZ\n\n2\n\nZ\n\nwhich implies\nZ\n\nM\n\n\u0393Z (f )d\u03bc \u2264 C2 kf k2D(L2 ) .\n\nPutting things together, we conclude that for f \u2208 C0\u221e (M),\nZ\n\u0393Z (f )d\u03bc \u2264 Ckf k2D(L2 ) ,\nM\n\nZ\n\nM\n\nZ\n\nM\n\n\u0393Z2 (f )d\u03bc \u2264 Ckf k2D(L2 ) ,\n\n\u0001\n\u03932 (f ) + \u0393Z2 (f ) \u2212 (\u03c11 \u2212 \u03ba) \u0393(f ) d\u03bc \u2264 Ckf k2D(L2 ) .\n\nThe inequalities are then extended to the smooth functions of D(L2 ) by using the essential self-adjointness of L which implies the density of C0\u221e (M) in D(L2 ) and the same\narguments as in Bakry [5, 6]. The details are let to the reader.\n\n4 The heat semigroup and parabolic comparison theorems\nWe now return to the general framework described in the introduction. Hereafter in this\npaper, M will be a C \u221e connected manifold endowed with a smooth measure \u03bc and a\nsmooth, locally subelliptic operator L satisfying L1 = 0 and (1.3). We indicate with \u0393(f )\nthe quadratic differential form defined by (1.4) and denote by d(x, y) the canonical distance (1.7) associated with such form. As we have said in the introduction throughout this\npaper we assume that (M, d) be a complete metric space. Furthermore, we assume that M\nbe endowed with another smooth bilinear differential form, indicated with \u0393Z , satisfying\n(1.9) above. We thus have, in particular, \u0393Z (1) = 0. As stated in the introduction, we\nassume that \u0393Z (f ) \u2265 0 for every f \u2208 C \u221e (M).\n\n\fCurvature-dimension inequalities, etc.\n\n47\n\nFrom (1.3) we have that, as an operator defined on C0\u221e (M), L is symmetric with\nrespect to the measure \u03bc and non-positive: for f \u2208 C0\u221e (M), < Lf, f >\u2264 0.\nThen, following an argument of Strichartz [53], Theorem 7.3 p. 246 and p. 261, by using the completeness of (M, d), we conclude that L is essentially self-adjoint on C0\u221e (M).\nAs a consequence, L admits a unique self-adjoint extension (its Friedrichs extension).\nWe shall continue to denote such extension by L. The domain of this extension shall be\ndenoted by D(L).\nR\u221e\nHereafter, for 1 \u2264 p \u2264 \u221e we will write Lp (M) instead of Lp (M, \u03bc). If L = \u2212 0 \u03bbdE\u03bb\ndenotes the spectral decomposition of L in L2 (M), then by definition, the heat semigroup\nR\u221e\n(Pt )t\u22650 is given by Pt = 0 e\u2212\u03bbt dE\u03bb . It is a one-parameter family of bounded operators\non L2 (M). Since the quadratic form Q(f ) = \u2212 < f, Lf > is a Dirichlet form in the sense\nof Fukushima [31], we deduce that (Pt )t\u22650 is a sub-Markov semigroup: it transforms positive functions into positive functions and satisfies\nPt 1 \u2264 1.\n\n(4.1)\n\n||Pt f ||L1 (M) \u2264 ||f ||L1(M) , ||Pt f ||L\u221e (M) \u2264 ||f ||L\u221e (M) ,\n\n(4.2)\n\nThis property implies in particular\n\nand therefore by the Theorem of Riesz-Thorin\n||Pt f ||Lp (M) \u2264 ||f ||Lp (M) , 1 \u2264 p \u2264 \u221e.\n\n(4.3)\n\nFrom the spectral definition of Pt , it is clear that for every t > 0, and every f \u2208 L2 (M),\nPt f \u2208 D\u221e (L) = \u2229k\u22651 D(Lk ). Moreover, it can be shown as in [39]:\nProposition 4.1. The unique solution of the Cauchy problem\n(\n\u2202u\n\u2212 Lu = 0,\n\u2202t\nu(x, 0) = f (x), f \u2208 Lp (M), 1 < p < \u221e,\nthat satisfies ku(*, t)kp < \u221e, is given by u(x, t) = Pt f (x).\nDue to the hypoellipticity of L the function (x, t) \u2192 Pt f (x) is smooth on M \u00d7 (0, \u221e)\nand\nZ\nPt f (x) =\n\nM\n\np(x, y, t)f (y)d\u03bc(y), f \u2208 C0\u221e (M),\n\nwhere p(x, y, t) > 0 is the so-called heat kernel associated to Pt . Such function is smooth\nand it is symmetric, i.e.,\np(x, y, t) = p(y, x, t).\n\n\fFabrice Baudoin, Nicola Garofalo\n\n48\n\nBy the semi-group property for every x, y \u2208 M and 0 < s, t, we have\nZ\np(x, y, t + s) =\np(x, z, t)p(z, y, s)d\u03bc(z)\nM\nZ\n=\np(x, z, t)p(y, z, s)d\u03bc(z) = Ps (p(x, *, t))(y).\n\n(4.4)\n\nM\n\nWe first establish a global comparison theorem in L2 .\nProposition 4.2. Suppose that M satisfy the Hypothesis 1.1. Let T > 0. Let u, v : M \u00d7\n[0, T ] \u2192 R be smooth functions such that:\nRT\n(i) For every t \u2208 [0, T ], u(*, t) \u2208 L2 (M) and 0 ku(*, t)k2dt < \u221e;\nRT p\n(ii) 0 k \u0393(u)(*, t)kp dt < \u221e for some 1 \u2264 p \u2264 \u221e;\nRT\n(iii) For every t \u2208 [0, T ], v(*, t) \u2208 Lq (M) and 0 kv(*, t)kq dt < \u221e for some 1 \u2264 q \u2264\n\u221e.\nIf the inequality\nLu +\n\n\u2202u\n\u2265 v,\n\u2202t\n\nholds on M \u00d7 [0, T ], then we have\nPT u(*, T )(x) \u2265 u(x, 0) +\n\nZ\n\nT\n\nPs v(*, s)(x)ds.\n\n0\n\nProof. Let f, g \u2208 C0\u221e (M), f, g \u2265 0. We claim that we must have\nZ\nZ\nZ TZ\np\np\ngPT (f u(*, T ))d\u03bc \u2212\ngf u(x, 0)d\u03bc \u2265 \u2212k \u0393(f )k\u221e\n(Pt g) \u0393(u)d\u03bcdt\nM\n\n0\n\nM\n\nM\n\n(4.5)\n\np\n\u2212 k \u0393(f )k\u221e\n\nZ\n\n0\n\nT\n\nk\n\np\n\n\u0393(Pt g)k2 ku(*, t)k2dt +\n\nZ\n\nM\n\ng\n\nZ\n\nT\n\nPt (f v(*, t))d\u03bcdt,\n0\n\nwhere for every 1 \u2264 p \u2264 \u221e and a measurable F , we have let ||F ||p = ||F ||Lp (M) . To\nestablish (4.5) we consider the function\nZ\n\u03c6(t) =\ngPt (f u(*, t))d\u03bc.\nM\n\nDifferentiating \u03c6 we find\n\u0013\n\u0012\nZ\n\u2202u\n\u2032\nd\u03bc\ngPt L(f u) + f\n\u03c6 (t) =\n\u2202t\nM\n\u0013\n\u0012\nZ\n\u2202u\nd\u03bc\n=\ngPt (Lf )u + 2\u0393(f, u) + f Lu + f\n\u2202t\nZM\nZ\n\u2265\ngPt ((Lf )u + 2\u0393(f, u)) d\u03bc +\ngPt(f v)d\u03bc.\nM\n\nM\n\n\fCurvature-dimension inequalities, etc.\n\n49\n\nSince\nZ\n\ngPt ((Lf )u) d\u03bc =\n\nZ\n\n(Pt g)(Lf )ud\u03bc\nZ\n=\u2212\n\u0393(f, u(Pt g))d\u03bc\nM\n\u0012Z\n\u0013\n=\u2212\nPt g\u0393(f, u) + u\u0393(f, Pt g)d\u03bc ,\n\nM\n\nM\n\nM\n\nwe obtain\n\u2032\n\n\u03c6 (t) \u2265\nNow, we can bound\nZ\n\nM\n\nZ\n\nM\n\nPt g\u0393(f, u)d\u03bc \u2212\n\nZ\n\nu\u0393(f, Pt g)d\u03bc +\n\nM\n\n(Pt g)\u0393(f, u)d\u03bc \u2264 k\n\np\n\nZ\n\ngPt (f v)d\u03bc.\n\nM\n\n\u0393(f )k\u221e\n\nZ\n\nM\n\np\n(Pt g) \u0393(u)d\u03bc,\n\nand for a.e. t \u2208 [0, T ] the integral in the right-hand side is finite in view of the assumption\n(ii) above. We have thus obtained\nZ\nZ\nZ\np\np\n\u2032\n\u03c6 (t) \u2265 \u2212k \u0393(f )k\u221e (Pt g) \u0393(u)d\u03bc \u2212\nu\u0393(f, Pt g)d\u03bc +\ngPt (f v(*, t))d\u03bc.\nM\n\nM\n\nM\n\nAs a consequence, we find\nZ\nZ\ngPT (f u(*, T ))d\u03bc \u2212\ngf u(x, 0)d\u03bc\nM\nM\nZ TZ\nZ TZ\nZ TZ\np\np\n(Pt g) \u0393(u)d\u03bcdt \u2212\nu\u0393 (f, Pt g) d\u03bcdt +\n\u2265 \u2212 k \u0393(f )k\u221e\ngPt (f v(*, t))d\u03bcdt\n0\nM\n0\nM\n0\nM\nZ TZ\nZ T\nZ\nZ T\np\np\n(Pt g) \u0393(u)d\u03bcdt \u2212\n\u2265 \u2212 k \u0393(f )k\u221e\nku(*, t)k2k\u0393(f, Pt g)k2dt +\ng\nPt (f v(*, t))dtd\u03bc\n0\nM\n0\nM\n0\nZ TZ\nZ T\np\np\np\np\n(Pt g) \u0393(u)d\u03bcdt \u2212 k \u0393(f )k\u221e\nku(*, t)k2k \u0393(Pt g)k2 dt\n\u2265 \u2212 k \u0393(f )k\u221e\n0\nM\n0\nZ\nZ T\n+\ng\nPt (f v(*, t))dtd\u03bc,\n0\n\nM\n\nwhich proves (4.5). Let now hk \u2208 C0\u221e (M) be a sequence as in Hypothesis 1.1. Using hk\nin place of f in (4.5), and letting k \u2192 \u221e, gives\nZ\nZ\nZ\nZ T\ngPT (u(*, T ))d\u03bc \u2212\ngu(x, 0)d\u03bc \u2265\ng\nPt (v(*, t))dtd\u03bc.\nM\n\nM\n\nM\n\n0\n\nWe observe that the assumption on v and Minkowski's integral inequality guarantee that\nRT\nthe function x \u2192 0 Pt (v(*, t))(x)dt belongs to Lq (M). We have in fact\n1\n1\n\u0013 q1 Z T Z\n\u0012Z Z T\nZ T Z\nq\nq\nq\nq\nq\n|v(*, t)| d\u03bc dt\nPt (v(*, t))dt d\u03bc\n\u2264\n|Pt (v(*, t))| d\u03bc dt \u2264\nM\n\n0\n\n0\n\n0\n\nM\n\n1\n\n\u2264 T q\u2032\n\n\u0012Z\n\nT\n\n0\n\nZ\n\nM\n\n\u0013 q1\nq\n< \u221e.\n|v(*, t)| d\u03bcdt\n\nM\n\n\fFabrice Baudoin, Nicola Garofalo\n\n50\n\nSince this must hold for every non negative g \u2208 C0\u221e (M), we conclude that\nZ T\nPT (u(*, T ))(x) \u2265 u(x, 0) +\nPs (v(*, s))(x)ds,\n0\n\nwhich completes the proof.\nThe next theorem shows that Hypothesis 1.4 is redundant on complete sub-Riemannian\nmanifolds with transverse symmetries of Yang-Mills type if the sub-Laplacian L satisfies\nthe generalized curvature dimension inequality.\nTheorem 4.3. Let L be the sub-Laplacian on a complete sub-Riemannian manifold with\ntransverse symmetries of Yang-Mills type. Suppose that L satisfies CD(\u03c11 , \u03c12 , \u03ba, d), for\nsome \u03c11 \u2208 R. Then, the Hypothesis 1.4 is satisfied.\nProof. Let f \u2208 C0\u221e (M) and consider the functional\np\n\u03a6(t) = \u0393Z (PT \u2212t f ).\n\nWe first assume that (x, t) \u2192 \u0393Z (Pt f )(x) > 0 on M \u00d7 [0, T ]. From Proposition 3.6\nZ (P\nT \u2212t f ))\nwe have \u03a6(t) \u2208 L2 (M). Moreover \u0393(\u03a6)(t) = \u0393(\u0393\n. So from Proposition 3.2,\n4\u0393Z (PT \u2212t f )\nZ\nwe have \u0393(\u03a6)(t) \u2264 \u03932 (PT \u2212t f ). Therefore, again from Proposition 3.6 , we deduce that\n\u0393(\u03a6)(t) \u2208 L1 (M). Next, we easily compute that\n\u0393(\u0393Z (PT \u2212t f ))\n\u0393Z (PT \u2212t f )\n\u2202\u03a6\n\u2212 Z\n+ L\u03a6 = p 2\n.\n\u2202t\n\u0393Z (PT \u2212t f ) 4\u0393 (PT \u2212t f )3/2\n\nThus, from Proposition 3.2, we obtain that\n\n\u2202\u03a6\n+ L\u03a6 \u2265 0.\n\u2202t\nWe can then use Proposition 4.2 to infer that\n\u0010p\n\u0011\np\n\u0393Z (PT f ) \u2264 PT\n\u0393Z (f ) .\n\nThis implies that for every t \u2265 0, \u0393Z (Pt f ) \u2208 Lp (M) for every 1 \u2264 p \u2264 \u221e. If (x, t) \u2192\n\u0393Z (Pt f )(x) vanishes on M \u00d7 [0, T ], we consider the functional\n\u03a6(t) = g\u03b5 (\u0393Z (PT \u2212t f )),\nwhere, for 0 < \u03b5 < 1,\ng\u03b5 (y) =\n\np\n\ny + \u03b52 \u2212 \u03b5.\n\nSince \u03a6(t) \u2208 L2 (M), an argument similar to that above (details are let to the reader)\nshows that\n\u0001\ng\u03b5 (\u0393Z (PT f )) \u2264 PT g\u03b5 (\u0393Z (f )) .\n\n\fCurvature-dimension inequalities, etc.\n\n51\n\nLetting \u03b5 \u2192 0, we conclude that\n\u0010p\n\u0011\np\n\u0393Z (PT f ) \u2264 PT\n\u0393Z (f ) .\n\nProving that (x, t) \u2192 \u0393(Pt f )(x) is bounded is similar. For \u03b1 \u2208 R, we consider the\nfunctional\n\u0011\n\u0010p\n\u03a8(t) = e\u2212\u03b1(T \u2212t)\n\u0393(PT \u2212t f ) + \u0393Z (PT \u2212t f ) ,\nand first assume that (x, t) \u2192 \u0393(Pt f )(x) does not vanish on M \u00d7 [0, T ]. From the previous inequality, Proposition 3.6 and Proposition 3.2, it is seen that \u03a8(t) \u2208 L2 (M) and\np\n\u0393(\u03a8)(t) \u2208 L1 (M) + L2 (M). Moreover,\n!\n\u2202\u03a8\n\u0393(\u0393(P\nf\n))\n\u0393\n(P\nf\n)\nT \u2212t\n2\nT \u2212t\n\u2212\n+ L\u03a8 = e\u2212\u03b1(T \u2212t) p\n+ 2\u0393Z2 (PT \u2212t f ) + \u03b1\u03a6.\n3/2\n\u2202t\n4\u0393(P\nf\n)\n\u0393(PT \u2212t f )\nT \u2212t\n\nAccording to Proposition 3.2 we have for every f \u2208 C \u221e (M), and \u03bd > 0,\n\u0011\n\u0010\n\u0010\n\u03ba\u0011\nZ\n\u0393(f ) ,\n\u0393(\u0393(f )) \u2264 4\u0393(f ) \u03932 (f ) + \u03bd\u03932 (f ) \u2212 \u03c11 \u2212\n\u03bd\np\nChoosing \u03bd = 2 \u0393(f ) gives\n\nWe deduce\n\np\n\u03ba\n\u0393(\u0393(f ))\n\u0393 (f )\nZ\np2\n+\n2\u0393\n(f\n)\n\u2265\n\u03c1\n\u0393(f ) \u2212 .\n\u2212\n1\n2\n3/2\n2\n\u0393(f ) 4\u0393(f )\n\n\u0010\n\u0011 \u03ba\np\n\u2202\u03a8\n+ L\u03a8 \u2265 e\u2212\u03b1(T \u2212t) (\u03b1 + \u03c11 ) \u0393(PT \u2212t f ) + \u03b1\u0393Z (PT \u2212t f ) \u2212 e\u2212\u03b1(T \u2212t) .\n\u2202t\n2\n\nTherefore, by choosing \u03b1 large enough we obtain\n\n\u2202\u03a8\n\u03ba\n+ L\u03a8 \u2265 \u2212 e\u2212\u03b1(T \u2212t) .\n\u2202t\n2\nAs a consequence of Proposition 4.2, we find\np\n\nZ\n\n\u03b1T\n\n\u0393(PT f ) + \u0393 (PT f ) \u2264 e\n\n\u0010\n\n\u221a\n\n\u03ba\nPT ( \u0393(f )) + PT (\u0393 (f )) + e\u03b1T\n2\nZ\n\n\u0011\n\nZ\n\nT\n\n(Ps 1)ds.\n0\n\nSince Ps 1 \u2264 1, we conclude therefore:\n\u0010\n\u0011 \u03ba\np\n\u221a\n\u0393(PT f ) + \u0393Z (PT f ) \u2264 e\u03b1T PT ( \u0393(f )) + PT (\u0393Z (f )) + T e\u03b1T .\n2\n\nThis implies that (x, t) \u2192 \u0393(Pt f )(x) + \u0393Z (Pt f )(x) \u2208 L\u221e (M \u00d7 [0, T ]). If (x, t) \u2192\n\u0393(Pt f )(x) does vanish on M \u00d7 [0, T ], then we consider the C \u221e approximation of the\nsquare root as above.\n\n\fFabrice Baudoin, Nicola Garofalo\n\n52\n\nWe now prove that Pt 1 = 1, that is that Pt is stochastically complete. A first consequence of the fact that for every f \u2208 C0\u221e (M), and T \u2265 0, (x, t) \u2192 \u0393(Pt f )(x) +\n\u0393Z (Pt f )(x) \u2208 L\u221e (M \u00d7 [0, T ]) is that in Proposition 4.2 we can now allow u to be in\nL1 . More precisely, under the very same assumptions as in Proposition 4.2 where (i) is\nRT\nreplaced by: For every t \u2208 [0, T ], u(*, t) \u2208 L1 (M) and 0 ku(*, t)k1dt < \u221e, we still have\nthe conclusion\nZ\nT\n\nPT (u(*, T ))(x) \u2265 u(x, 0) +\n\nPs (v(*, s))(x)ds.\n\n0\n\nThe proof of this fact is identical to that of Proposition 4.2. With the notations of this\nproof, \u0393(P* g) \u2208 L\u221e ([0, T ] \u00d7 M) is used to obtain the following bound\nZ\n\nT\n0\n\nZ\n\nM\n\nZ\np\nu\u0393 (f, Pt g) d\u03bcdt \u2264 k \u0393(f )k\u221e\n\nT\n\nk\n\n0\n\np\n\n\u0393(Pt g)k\u221e ku(*, t)k1dt.\n\nThis leads to an inequality where (4.5) is replaced by\nZ\n\nM\n\ngPT (f u(*, T ))d\u03bc \u2212\n\np\n\u2212 k \u0393(f )k\u221e\n\nZ\n\n0\n\nT\n\nk\n\np\n\nZ\n\nM\n\ngf u(x, 0)d\u03bc \u2265 \u2212k\n\np\n\n\u0393(Pt g)k\u221e ku(*, t)k1dt +\n\n\u0393(f )k\u221e\n\nZ\n\nM\n\ng\n\nZ\n\nZ\n\n0\n\nT\n\nZ\n\nM\n\np\n(Pt g) \u0393(u)d\u03bcdt\n\n(4.6)\n\nT\n\nPt (f v(*, t))d\u03bcdt.\n\n0\n\nAt this point the argument proceeds exactly as in the conclusion of the proof of Proposition 4.2.\nWith this L1 comparison result in hands, we can now come back to the stochastic\ncompleteness problem. Let f \u2208 C0\u221e (M) and consider the functional\n\u0001\nu(x, t) = e\u03b1(T \u2212t) \u0393(PT \u2212t f )(x) + \u0393Z (PT \u2212t f )(x) .\n\nWe have\n\n\u0001\nLu(x, t) = e\u03b1(T \u2212t) L\u0393(PT \u2212t f )(x) + L\u0393Z (PT \u2212t f )(x) ,\n\nand\n\n\u0001\n\u2202u\n(x, t) = \u2212\u03b1u(x, t) \u2212 2e\u03b1(T \u2212t) \u0393(PT \u2212t f, LPT \u2212t )(x) + \u0393Z (PT \u2212t f, LPT \u2212t )(x) .\n\u2202t\n\nTherefore we have\nLu(x, t) +\n\n\u0001\n\u2202u\n(x, t) = \u2212\u03b1u(x, t) + 2e\u03b1(T \u2212t) \u03932 (PT \u2212t f )(x) + \u0393Z2 (PT \u2212t f )(x) .\n\u2202t\n\nBy using now the inequality CD(\u03c11 , \u03c12 , \u03ba, d) with \u03bd = 1, we obtain\nLu(x, t)+\n\n\u0001\n\u2202u\n(x, t) \u2265 e\u03b1(T \u2212t) (2(\u03c11 \u2212 \u03ba) \u2212 \u03b1)\u0393(PT \u2212t f )(x) + (2\u03c12 \u2212 \u03b1)\u0393Z (PT \u2212t f )(x) .\n\u2202t\n\n\fCurvature-dimension inequalities, etc.\n\n53\n\nBy choosing \u03b1 \u2264 2 min{\u03c12 , \u03c11 \u2212 \u03ba}, we thus get\nLu(x, t) +\n\n\u2202u\n(x, t) \u2265 0,\n\u2202t\n\nand we conclude by using the L1 version of Proposition 4.5 that\n\u0001\n\u0393(Pt f ) + \u0393Z (Pt f ) \u2264 e\u2212\u03b1t Pt \u0393(f ) + Pt \u0393Z (f ) .\n\n(4.7)\n\nWe are now ready for the final argument leading to the stochastic completeness. Let f, g \u2208\nC0\u221e (M), by (1.3) and (1.4) we have\n\u0013\nZ tZ \u0012\nZ\nZ tZ\nZ tZ\n\u2202\n(Pt f \u2212 f )gd\u03bc =\nPs f gd\u03bcds =\n(LPs f ) gd\u03bcds = \u2212\n\u0393(Ps f, g)d\u03bcds.\n\u2202s\nM\n0\nM\n0\nM\n0\nM\nBy means of Cauchy-Schwarz inequality and (4.7), we find\n\u0013\n\u0012Z t\nZ\nZ\np\n1\n\u2212 \u03b1s\nZ\n2\nk\u0393(f )k\u221e + k\u0393 (f )k\u221e\n\u0393(g) 2 d\u03bc.\n(Pt f \u2212 f )gd\u03bc \u2264\ne ds\n0\n\nM\n\n(4.8)\n\nM\n\nWe now apply (4.8) with f = hk , where hk is the sequence whose existence is postulated\nin the Hypothesis (1.1), and then let k \u2192 \u221e. By Beppo Levi's monotone convergence\ntheorem we have Pt hk (x) \u0580 Pt 1(x) for every x \u2208 M. We conclude that the left-hand side\nR\nof (4.8) converges to M (Pt 1\u22121)gd\u03bc. Since in view of the Hypothesis (1.1) the right-hand\nside converges to zero, we reach the conclusion\nZ\n(Pt 1 \u2212 1)gd\u03bc = 0, g \u2208 C0\u221e (M).\nM\n\nIt follows that Pt 1 = 1.\n\nWe point out that the stochastic completeness of the heat semigroup is classically\nequivalent to the uniqueness in the Cauchy problem for initial data in L\u221e (M). Following\nthe classical approach (see for instance Theorem 8.18 in [33]), we in fact obtain:\nProposition 4.4. Suppose that M satisfy Hypothesis 1.1, Hypothesis 1.4. Then, for every\nf \u2208 L\u221e (M) the Cauchy problem\n(\nLu \u2212 ut = 0, in M \u00d7 (0, \u221e),\nu(x, 0) = f (x), f \u2208 L\u221e (M),\nadmits a unique bounded solution, given by u(x, t) = Pt f (x).\nWe state the following L\u221e global parabolic comparison theorem that will be easier to\nuse that Proposition 4.2 because it does not require a priori bounds on the derivatives.\n\n\fFabrice Baudoin, Nicola Garofalo\n\n54\n\nProposition 4.5. Suppose that M satisfy Hypothesis 1.4. Let T > 0. Let u, v : M \u00d7\n[0, T ] \u2192 R be smooth functions such that for every T > 0, supt\u2208[0,T ] ku(*, t)k\u221e < \u221e,\nsupt\u2208[0,T ] kv(*, t)k\u221e < \u221e; If the inequality\nLu +\n\n\u2202u\n\u2265v\n\u2202t\n\nholds on M \u00d7 [0, T ], then we have\nPT (u(*, T ))(x) \u2265 u(x, 0) +\n\nZ\n\nT\n\nPs (v(*, s))(x)ds.\n\n0\n\nProof. Let (Xtx )t\u22650 be the diffusion Markov process with semigroup (Pt )t\u22650 and started\nat x \u2208 M (see for instance Chapter 7 in [31] for the construction of such process). From\nPt 1 = 1, we deduce that (Xtx )t\u22650 has an infinite lifetime. We have then for t \u2265 0,\n\u0013\nZ t\u0012\n\u2202u\nx\nu (Xt , t) = u (x, 0) +\nLu +\n(Xsx , s)ds + Mt ,\n\u2202t\n0\nwhere (Mt )t\u22650 is a local martingale. From the assumption one obtains\nZ t\nx\nu (Xt , t) \u2265 u (x, 0) +\nv(Xsx , s)ds + Mt .\n0\n\nLet now (Tn )n\u2208N be an increasing sequence of stopping times such that almost surely\nTn \u2192 +\u221e and (Mt\u2227Tn )t\u22650 is a martingale. From the previous inequality, we find\n\u0013\n\u0012Z t\u2227Tn\n\u0001\u0001\nx\nx\nv(Xs , s)ds .\nE u Xt\u2227Tn , t \u2227 Tn \u2265 u (x, 0) + E\n0\n\nBy using the dominated convergence theorem, we conclude\n\u0012Z t\n\u0013\nx\nx\nE (u (Xt , t)) \u2265 u (x, 0) + E\nv(Xs , s)ds ,\n0\n\nwhich yields the conclusion.\n\nFor later use, we also finally record the following gradient bounds that are consequences of Hypothesis 1.4.\nCorollary 4.6. Suppose that L satisfies CD(\u03c11 , \u03c12 , \u03ba, d), for some \u03c11 \u2208 R and that Hypothesis 1.4 is satisfied. There exists \u03b1 \u2208 R (\u03b1 \u2264 2 min{\u03c12 , \u03c11 \u2212 \u03ba} will do), such that\nfor every f \u2208 C0\u221e (M), one has\n\u0001\n\u0393(Pt f ) + \u0393Z (Pt f ) \u2264 e\u2212\u03b1t Pt \u0393(f ) + Pt \u0393Z (f ) .\n(4.9)\nAs a consequence, for every f \u2208 C0\u221e (M) and 1 \u2264 p \u2264 \u221e one obtains\n\u0001\nk\u0393(Pt f )kLp (M) \u2264 e\u2212\u03b1t k\u0393(f )kLp (M) + k\u0393Z (f )kLp (M) , t \u2265 0.\n\n(4.10)\n\nand\n\n\u0001\nk\u0393Z (Pt f )kLp (M) \u2264 e\u2212\u03b1t k\u0393(f )kLp (M) + k\u0393Z (f )kLp (M) ,\n\nt \u2265 0.\n\n(4.11)\n\n\fCurvature-dimension inequalities, etc.\n\n55\n\nProof. The proof is identical to the proof of (4.7) except that we now use Proposition\n4.5.\n\n5 Entropic variational inequalities\nOur objective in this section is proving a fundamental variational inequality which will\nplay a pervasive role in our study, see Theorem 5.2 below. We begin with some preliminary results. Henceforth, we will indicate Cb\u221e (M) = C \u221e (M) \u2229 L\u221e (M).\nLemma 5.1. Let f \u2208 Cb\u221e (M), f > 0 and T > 0, and consider the functions\n\u03c61 (x, t) = (PT \u2212t f )(x)\u0393(ln PT \u2212t f )(x),\n\u03c62 (x, t) = (PT \u2212t f )(x)\u0393Z (ln PT \u2212t f )(x),\nwhich are defined on M \u00d7 (\u2212\u221e, T ). We have\nL\u03c61 +\n\n\u2202\u03c61\n= 2(PT \u2212t f )\u03932 (ln PT \u2212t f ).\n\u2202t\n\nIf, furthermore, the Hypothesis (1.2) is valid, then\nL\u03c62 +\n\n\u2202\u03c62\n= 2(PT \u2212t f )\u0393Z2 (ln PT \u2212t f ).\n\u2202t\n\nProof. Let for simplicity g(x, t) = PT \u2212t f (x). A simple computation gives\n\u2202\u03c61\ngt\n= gt \u0393(ln g) + 2g\u0393(ln g, ).\n\u2202t\ng\nOn the other hand,\nL\u03c61 = Lg\u0393(ln g) + gL\u0393(ln g) + 2\u0393(g, \u0393(ln g)).\nCombining these equations we obtain\nL\u03c61 +\n\n\u2202\u03c61\ngt\n= gL\u0393(ln g) + 2\u0393(g, \u0393(ln g)) + 2g\u0393(ln g, ).\n\u2202t\ng\n\nFrom (1.10) we see that\n2g\u03932(ln g) = g(L\u0393(ln g) \u2212 2\u0393(ln g, L(ln g)))\n\n= gL\u0393(ln g) \u2212 2g\u0393(ln g, L(ln g)).\n\nObserving that\nL(ln g) = \u2212\n\n\u0393(g) gt\n\u2212 ,\ng2\ng\n\n\fFabrice Baudoin, Nicola Garofalo\n\n56\nwe conclude that\nL\u03c61 +\n\n\u2202\u03c61\n= 2(PT \u2212t f )\u03932 (ln PT \u2212t f ).\n\u2202t\n\nIn the same vein, we obtain\nL\u03c62 +\n\n\u2202\u03c62\ngt\n= gL\u0393Z (ln g) + 2\u0393(g, \u0393Z (ln g)) + 2g\u0393Z (ln g, ).\n\u2202t\ng\n\nOn the other hand, this time using (1.11), we find\n2g\u0393Z2 (ln g) = g(L\u0393Z (ln g) \u2212 2\u0393Z (ln g, L(ln g)))\n\u0393(g)\ngt\n= gL\u0393Z (ln g) + 2g\u0393Z (ln g, 2 ) + 2g\u0393Z (ln g, ).\ng\ng\nFrom this latter equation it is now clear that, if the Hypothesis (1.2) is valid, then\nL\u03c62 +\n\n\u2202\u03c62\n= 2g\u0393Z2 (ln g).\n\u2202t\n\nThis concludes the proof.\n\nWe now turn to our most important variational inequality. Given a function f \u2208\nand \u03b5 > 0, we let f\u03b5 = f + \u03b5.\nSuppose that T > 0, and x \u2208 M be given. For a function f \u2208 Cb\u221e (M) with f \u2265 0 we\ndefine for t \u2208 [0, T ],\n\nCb\u221e (M)\n\n\u03a61 (t) = Pt ((PT \u2212t f\u03b5 )\u0393(ln PT \u2212t f\u03b5 )) ,\n\u0001\n\u03a62 (t) = Pt (PT \u2212t f\u03b5 )\u0393Z (ln PT \u2212t f\u03b5 ) .\n\nTheorem 5.2. Suppose that the Hypothesis 1.1, 1.2, 1.4 be satisfied and that the curvaturedimension inequality (1.12) holds for \u03c11 \u2208 R. Let a, b \u2208 C 1 ([0, T ], [0, \u221e)), \u03b3 \u2208 C((0, T ), R)\n2\nbe such that a\u2032 + 2\u03c11 a \u2212 2\u03ba ab \u2212 4a\u03b3\n, b\u2032 + 2\u03c12 a, a\u03b3, a\u03b3 2 be continuous functions on [0, T ].\nd\nGiven f \u2208 C0\u221e (M), with f \u2265 0, we have\n\u0001\na(T )PT (f\u03b5 \u0393(ln f\u03b5 )) + b(T )PT f\u03b5 \u0393Z (ln f\u03b5 ) \u2212 a(0)(PT f\u03b5 )\u0393(ln PT f\u03b5 ) \u2212 b(0)\u0393Z (ln PT f\u03b5 )\n\u0013\nZ T\nZ T\u0012\na2 4a\u03b3\n\u2032\n\u03a61 ds +\n(b\u2032 + 2\u03c12 a)\u03a62 ds\n\u2265\na + 2\u03c11 a \u2212 2\u03ba \u2212\nb\nd\n0\n0\n\u0012 Z T\n\u0013\n\u0012 Z T\n\u0013\n4\n2\n+\na\u03b3ds LPT f\u03b5 \u2212\na\u03b3 2 ds PT f\u03b5 .\nd 0\nd 0\nProof. Let f \u2208 C \u221e (M), f \u2265 0. Consider the function\n\u03c6(x, t) = a(t)(PT \u2212t f )(x)\u0393(ln PT \u2212t f )(x) + b(t)(PT \u2212t f )(x)\u0393Z (ln PT \u2212t f )(x).\n\n\fCurvature-dimension inequalities, etc.\n\n57\n\nApplying Lemma 5.1 and the curvature-dimension inequality (1.12), we obtain\nL\u03c6 +\n\n\u2202\u03c6\n= a\u2032 (PT \u2212t f )\u0393(ln PT \u2212t f ) + b\u2032 (PT \u2212t f )\u0393Z (ln PT \u2212t f )\n\u2202t\n+ 2a(PT \u2212t f )\u03932 (ln PT \u2212t f ) + 2b(PT \u2212t f )\u0393Z2 (ln PT \u2212t f )\n\u0013\n\u0012\na2\n\u2032\n(PT \u2212t f )\u0393(ln PT \u2212t f )\n\u2265 a + 2\u03c11 a \u2212 2\u03ba\nb\n+ (b\u2032 + 2\u03c12 a)(PT \u2212t f )\u0393Z (ln PT \u2212t f )\n2a\n+ (PT \u2212t f )(L(ln PT \u2212t f ))2 .\nd\n\nBut,\n(L(ln PT \u2212t f ))2 \u2265 2\u03b3L(ln PT \u2212t f ) \u2212 \u03b3 2 ,\nand\nL(ln PT \u2212t f ) =\n\nLPT \u2212t f\n\u2212 \u0393(ln PT \u2212t f ).\nPT \u2212t f\n\nTherefore,\n\u0013\n\u0012\na2 4a\u03b3\n\u2202\u03c6\n\u2032\n(PT \u2212t f )\u0393(ln PT \u2212t f )\n\u2265 a + 2\u03c11 a \u2212 2\u03ba \u2212\nL\u03c6 +\n\u2202t\nb\nd\n+ (b\u2032 + 2\u03c12 a)(PT \u2212t f )\u0393Z (ln PT \u2212t f )\n4a\u03b3\n2a\u03b3 2\n+\nLPT \u2212t f \u2212\nPT \u2212t f.\nd\nd\nIf now f \u2208 C0\u221e (M), f \u2265 0, we obtain the same differential inequality if we use f\u03b5 instead\nof f throughout. At that point we apply Proposition 4.5 to reach the desired conclusion.\n\nThe following corollary is of particular importance.\nCorollary 5.3. Under the same assumptions of Theorem 5.2, let b : [0, T ] \u2192 [0, \u221e) be a\nnon-increasing C 2 function such that, with\n\u0012 \u2032\u2032\n\u0013\nb\n\u03ba b\u2032\ndef d\n\u03b3 =\n+\n+ 2\u03c11 ,\n(5.1)\n4 b\u2032\n\u03c12 b\nthe functions b\u2032 \u03b3, b\u2032 \u03b3 2 be continuous on [0, T ]. Then, we have for f \u2208 C0\u221e (M),\n\u0001\nb\u2032 (T )\nPT (f\u03b5 \u0393(ln f\u03b5 )) + b(T )PT f\u03b5 \u0393Z (ln f\u03b5 )\n2\u03c12\nb\u2032 (0)\n(PT f\u03b5 )\u0393(ln PT f\u03b5 ) \u2212 b(0)\u0393Z (ln PT f\u03b5 )\n+\n2\u03c12\n\u0013\n\u0012\n\u0013\n\u0012\nZ T\nZ T\n1\n2\n\u2032\n\u2032 2\nb \u03b3ds LPT f\u03b5 +\nb \u03b3 ds PT f\u03b5 .\n\u2265\u2212\nd\u03c12 0\nd\u03c12 0\n\u2212\n\n(5.2)\n\n\fFabrice Baudoin, Nicola Garofalo\n\n58\n\nProof. We choose a : [0, T ] \u2192 [0, \u221e) of class C 1 so that\nb\u2032 + 2\u03c12 a = 0.\nWith this choice, and with \u03b3 defined by (5.1), we obtain\na\u2032 + 2\u03c11 a \u2212 2\u03ba\n\na2 4a\u03b3\n\u2212\n= 0.\nb\nd\n\nApplying Theorem 5.2 with these a, b and \u03b3, we immediately reach the desired conclusion.\n\n6 Li-Yau type estimates\nIn this section, we extend the celebrated Li-Yau inequality in [40] to the heat semigroup\nassociated with the subelliptic operator L. Let us mention that, in this setting, related inequalities were obtained by Cao-Yau [17]. However, these authors work locally and the\ngeometry of the manifold does not enter in their study. Instead, our analysis in based on\nthe entropic inequalities established in Section 5 and, consequently, it hinges crucially on\nour curvature-dimension inequality (1.12). As we have shown in the discussion of the examples in Section 2, such inequality is deeply connected to the sub-Riemannian geometry\nof the manifold. We have mentioned in the introduction that, even when specialized to the\nRiemannian case, the ideas in this section provide a new, more elementary approach of\nthe Li-Yau inequalities. For this aspect we refer the reader to the paper [15].\nTheorem 6.1 (Gradient estimate). Assume the Hypothesis 1.1, 1.2, 1.4 and that the curvaturedimension inequality (1.12) be satisfied for \u03c11 \u2208 R. Let f \u2208 C0\u221e (M), f \u2265 0, f 6\u2261 0, then\nthe following inequality holds for t > 0:\n\u0010\n\u00112\n3\u03ba\n\u0012\n\u0013\n\u0012\n\u0013\nd 1 + 2\u03c12\n2\u03c12 Z\n2\u03c11\n3\u03ba\n3\u03ba\nLPt f d\u03c121 \u03c11 d\n\u0393(ln Pt f )+\n\u2212\n1+\n+\nt\u0393 (ln Pt f ) \u2264 1 +\nt\n+\nt\u2212\n.\n3\n2\u03c12\n3\nPt f\n6\n2\n2\u03c12\n2t\nProof. We apply Corollary 5.3, in which we choose b(t) = (T \u2212 t)3 . With such choice,\n(5.1) gives:\n\u0012\n\u0012\n\u0013\u0013\nd\n1\n3\u03ba\n\u03b3(t) =\n\u03c11 \u2212\n1+\n,\n2\nT \u2212t\n2\u03c12\nand thus b\u2032 \u03b3, b\u2032 \u03b3 2 \u2208 C([0, t]), R). Simple calculations give\nZ\n\n0\n\nT\n\n\u03c11 d 3 3d\nT +\nb (t)\u03b3(t)dt = \u2212\n2\n4\n\u2032\n\n\u0012\n\n3\u03ba\n1+\n2\u03c12\n\n\u0013\n\nT 2,\n\n\fCurvature-dimension inequalities, etc.\n\n59\n\nand\nZ\n\n0\n\nT\n\n3d2\nb\u2032 (t)\u03b3(t)2 dt = \u2212\n16\n\n\u00132\n\u0013 !\n\u0012\n\u0012\n4\u03c121 3\n3\u03ba\n3\u03ba\nT2 .\nT +4 1+\nT \u2212 4\u03c11 1 +\n3\n2\u03c12\n2\u03c12\n\nUsing the latter two equations in (5.2) and letting \u03b5 \u2192 0, by the arbitrariness of T > 0 we\nobtain the desired conclusion.\nRemark 6.2. We notice that when \u03c11 \u2265 \u03c1\u20321 , then one trivially has that:\nCD(\u03c11 , \u03c12 , \u03ba, d) =\u21d2 CD(\u03c1\u20321 , \u03c12 , \u03ba, d).\nAs a consequence of this observation, when (1.12) holds with \u03c11 > 0, then also CD(0, \u03c12 , \u03ba, d)\nis true. Therefore, when \u03c11 > 0, Theorem 6.1 gives in particular for f \u2208 C0\u221e (M), f \u2265 0,\n\u00112\n\u0010\n3\u03ba\n\u0013\n\u0012\nd\n1\n+\n2\u03c12\n3\u03ba LPt f\n2\u03c12 Z\nt\u0393 (ln Pt f ) \u2264 1 +\n+\n.\n(6.1)\n\u0393(ln Pt f ) +\n3\n2\u03c12 Pt f\n2t\nHowever, this inequality is not optimal when \u03c11 > 0. It leads to a optimal Harnack inequality only when \u03c11 = 0. Sharper bounds in the case \u03c11 > 0 will be obtained in (10.4)\nof Proposition 10.2 below by a different choice of the function b(t) in Corollary 5.3.\nRemark 6.3. Throughout the remainder of the paper the symbol D will only be used with\nthe following meaning:\n\u0013\n\u0012\n3\u03ba\n.\n(6.2)\nD =d 1+\n2\u03c12\nWith this notation, observing that the left-hand side of (6.1) is always nonnegative, and\nthat LPt f = \u2202t Pt f , when \u03c11 \u2265 0 we obtain\n\u2202t (ln(tD/2 Pt f (x))) \u2265 0.\n\n(6.3)\n\nBy integrating (6.3) from t < 1 to 1 leads to the following on-diagonal bound for the heat\nkernel,\np(x, x, t) \u2264\n\n1\ntD/2\n\np(x, x, 1).\n\n(6.4)\n\nThe constant D2 in (6.4) is not optimal, in general, as the example of the heat semigroup on a Carnot group shows. In such case, in fact, one can argue as in [29] to show\nthat the heat kernel p(x, y, t) is homogeneous of degree \u2212 Q2 with respect to the nonisotropic group dilations, where Q indicates the corresponding homogeneous dimension\nof the group. From such homogeneity of p(x, y, t), one obtains the estimate\np(x, x, t) \u2264\n\n1\ntQ/2\n\np(x, x, 1),\n\n\fFabrice Baudoin, Nicola Garofalo\n\n60\n\nwhich, unlike (6.4), is best possible. In the sub-Riemannian setting it does not seem easy\nto obtain sharp geometric constants by using only the curvature-dimension inequality\n(1.12). This aspect is quite different from the Riemannian case, for which the CD(\u03c11 , n)\ninequality (1.2) does provide sharp geometric constants (see [7], [38]). However, in such\ncase our bound (6.4) is sharp as well, since if d = n = dim(M), and \u03ba = 0, then (6.2)\ngives D = n.\n\n7 A parabolic Harnack inequality\nIn this section we generalize the celebrated Harnack inequality in [40] to solutions of the\nheat equation Lu \u2212 ut = 0 on M which are in the form u(x, t) = Pt f (x), for some\nf \u2208 Cb\u221e (M), f \u2265 0. Theorem 7.1 below should be seen as a generalization of (i) of\nTheorem 2.2 in [40], in the case of a zero potential q. One should also see the paper [17],\nwhere the authors deal with subelliptic operators on a compact manifold. As we have\nmentioned, these authors do not obtain bounds which depend on the sub-Riemannian\ngeometry of the underlying manifold.\nTheorem 7.1. Assume the Hypothesis 1.1, 1.2, 1.4 and that the curvature-dimension inequality (1.12) be satisfied for \u03c11 \u2265 0. Given (x, s), (y, t) \u2208 M \u00d7 (0, \u221e), with s < t, one\nhas for any f \u2208 Cb\u221e (M), f \u2265 0,\n\u0012 \u0013 D2\n\u0012\n\u0013\nt\nD d(x, y)2\nPs f (x) \u2264 Pt f (y)\nexp\n.\ns\nd 4(t \u2212 s)\n\n(7.1)\n\nProof. Let f \u2208 C0\u221e (M) be as in the statement of the theorem, and for every (x, t) \u2208\nM \u00d7 (0, \u221e) consider u(x, t) = Pt f (x) . Since Lu = \u2202u\n, in terms of u the inequality (6.1)\n\u2202t\ncan be reformulated as\n\u0010\n\u00112\n3\u03ba\n3\u03ba \u2202 log u d 1 + 2\u03c12\n2\u03c12 Z\n)\nt\u0393 (ln u) \u2264 (1 +\n+\n.\n\u0393(ln u) +\n3\n2\u03c12\n\u2202t\n2t\nRecalling (6.2), this implies in particular,\n\u2212\n\n\u2202 ln u\nd\nD\n\u2264 \u2212 \u0393(ln u) + .\n\u2202t\nD\n2t\n\n(7.2)\n\nWe now fix two points (x, s), (y, t) \u2208 M \u00d7 (0, \u221e), with s < t. Let \u03b3(\u03c4 ), 0 \u2264 \u03c4 \u2264 T be\na subunit path such that \u03b3(0) = y, \u03b3(T ) = x (for the definition of subunit path see [27]).\nConsider the path in M \u00d7 (0, \u221e) defined by\n\u0013\n\u0012\ns\u2212t\n\u03c4 , 0 \u2264 \u03c4 \u2264 T,\n\u03b1(\u03c4 ) = \u03b3(\u03c4 ), t +\nT\n\n\fCurvature-dimension inequalities, etc.\n\n61\n\nso that \u03b1(0) = (y, t), \u03b1(T ) = (x, s). We have\nu(x, s)\n=\nln\nu(y, t)\n\u2264\n\nT\n\nZ\n\n0\n\nZ\n\n0\n\nT\n\nd\nln u(\u03b1(\u03c4 ))d\u03c4\nd\u03c4\n\u0014\n\u0015\n1\nt \u2212 s \u2202 ln u\n\u0393(ln u(\u03b1(\u03c4 ))) 2 \u2212\n(\u03b1(\u03c4 )) d\u03c4.\nT\n\u2202t\n\nApplying (7.2) for any \u01eb > 0 we find\n\u0012Z T\n\u0013 21\nZ\n1\nu(x, s)\nt \u2212 s T \u2202 ln u\n\u0393(ln u)(\u03b1(\u03c4 ))d\u03c4\nlog\n\u2212\n\u2264T2\n(\u03b1(\u03c4 ))d\u03c4\nu(y, t)\nT\n\u2202t\n0\n0\nZ\nZ\nd t\u2212s T\n\u01eb T\n1\n\u0393(ln u)(\u03b1(\u03c4 ))d\u03c4 \u2212\n\u0393(ln u)(\u03b1(\u03c4 ))d\u03c4\n\u2264 T+\n2\u01eb\n2 0\nD T\n0\nZ\nd\u03c4\nD(s \u2212 t) T\n\u2212\ns\u2212t .\n2T\n0 t+ T \u03c4\nIf we now choose \u01eb > 0 such that\n\u01eb\nd t\u2212s\n=\n,\n2\nD T\nwe obtain from the latter inequality\nu(x, s)\nD ls (\u03b3)2\nD\nlog\n\u2264\n+ ln\nu(y, t)\nd 4(t \u2212 s)\n2\n\n\u0012 \u0013\nt\n,\ns\n\nwhere we have denoted by ls (\u03b3) the subunitary length of \u03b3. If we now minimize over all\nsubunitary paths joining y to x, and we exponentiate, we obtain\n\u0012 \u0013 D2\n\u0012\n\u0013\nt\nD d(x, y)2\nu(x, s) \u2264 u(y, t)\nexp\n.\ns\nd 4(t \u2212 s)\nThis proves (7.1) when f \u2208 C0\u221e (M). We can then extend the result to f \u2208 Cb\u221e (M)\nby considering the approximations hn P\u03c4 f \u2208 C0\u221e (M) , where hn \u2208 C0\u221e (M), hn \u2265 0,\nhn \u2192n\u2192\u221e 1 and let n \u2192 \u221e and \u03c4 \u2192 0.\nThe following result represents an important consequence of Theorem 7.1.\nCorollary 7.2. Suppose that the Hypothesis 1.1, 1.2, 1.4 be valid, and that the curvaturedimension inequality (1.12) be satisfied for \u03c11 \u2265 0. Let p(x, y, t) be the heat kernel on M.\nFor every x, y, z \u2208 M and every 0 < s < t < \u221e one has\n\u0012 \u0013 D2\n\u0012\n\u0013\nt\nD d(y, z)2\np(x, y, s) \u2264 p(x, z, t)\nexp\n.\ns\nd 4(t \u2212 s)\n\n\fFabrice Baudoin, Nicola Garofalo\n\n62\n\nProof. Let \u03c4 > 0 and x \u2208 M be fixed. By the hypoellipticity of L \u2212 \u2202t , we know that\np(x, *, * + \u03c4 ) \u2208 C \u221e (M \u00d7 (\u2212\u03c4, \u221e)), see [28]. From (4.4) we have\np(x, y, s + \u03c4 ) = Ps (p(x, *, \u03c4 ))(y)\nand\np(x, z, t + \u03c4 ) = Pt (p(x, *, \u03c4 ))(z)\nSince we cannot apply Theorem 7.1 directly to u(y, t) = Pt (p(x, *, \u03c4 ))(y), we consider\nun (y, t) = Pt (hn p(x, *, \u03c4 ))(y), where hn \u2208 C0\u221e (M), 0 \u2264 hn \u2264 1, and hn \u0580 1. From\n(7.1) we find\n\u0012 \u0013 D2\n\u0012\n\u0013\nt\nD d(y, z)2\nPs (hn p(x, *, \u03c4 ))(y) \u2264 Pt (hn p(x, *, \u03c4 ))(z)\nexp\ns\nd 4(t \u2212 s)\nLetting n \u2192 \u221e, by Beppo Levi's monotone convergence theorem we obtain\n\u0012\n\u0013\n\u0012 \u0013 D2\nD d(y, z)2\nt\nexp\n.\np(x, y, s + \u03c4 ) \u2264 p(x, z, t + \u03c4 )\ns\nd 4(t \u2212 s)\n\nThe desired conclusion follows by letting \u03c4 \u2192 0.\n\n8 Off-diagonal Gaussian upper bounds for p(x, y, t)\nSuppose that the assumption of Theorem 7.1 are in force. Fix x \u2208 M and t > 0. Applying\n\u221a\nCorollary 7.2 to (y, t) \u2192 p(x, y, t) for every y \u2208 B(x, t) we find\nD\n\nD\n\np(x, x, t) \u2264 2 2 e 4d p(x, y, 2t) = C(\u03c12 , \u03ba, d)p(x, y, 2t).\n\u221a\nIntegration over B(x, t) gives\nZ\n\u221a\np(x, y, 2t)d\u03bc(y) \u2264 C(\u03c12 , \u03ba, d),\np(x, x, t)\u03bc(B(x, t)) \u2264 C(\u03c12 , \u03ba, d)\n\u221a\nB(x, t)\n\nwhere we have used Pt 1 \u2264 1. This gives the on-diagonal upper bound\np(x, x, t) \u2264\n\nC(\u03c12 , \u03ba, d)\n\u221a .\n\u03bc(B(x, t))\n\n(8.1)\n\nThe aim of this section is to establish the following off-diagonal upper bound for\nthe heat kernel. Before doing so, let us observe that from the general theory of Markov\nsemigroups, if the volume doubling property is assumed, then the on-diagonal bound\n(8.1) implies an off-diagonal bound (see for instance [20]). However, in our framework,\nthe volume doubling property is only proved in the sequel paper [14] which relies on the\nresults in the present paper. Therefore, and we think this is interesting in itself, to prove\nthe off-diagonal upper bound, we completely bypass the use of uniform volume estimates\nand instead rely in an essential way on the scale invariant parabolic Harnack inequality.\n\n\fCurvature-dimension inequalities, etc.\n\n63\n\nTheorem 8.1. Assume the Hypothesis 1.1, 1.2, 1.4, and that the curvature-dimension\ninequality (1.12) be satisfied for \u03c11 \u2265 0. For any 0 < \u01eb < 1 there exists a constant\nC(\u03c12 , \u03ba, d, \u01eb) > 0, which tends to \u221e as \u01eb \u2192 0+ , such that for every x, y \u2208 M and t > 0\none has\n\u0012\n\u0013\nd(x, y)2\nC(d, \u03ba, \u03c12 , \u01eb)\np(x, y, t) \u2264\n.\n\u221a 1\n\u221a 1 exp \u2212\n(4 + \u01eb)t\n\u03bc(B(x, t)) 2 \u03bc(B(y, t)) 2\nProof. We suitably adapt here an idea in [17] for the case of a compact manifold without\nboundary. Since, however, we allow the manifold M to be non-compact, we need to take\ncare of this aspect. Corollary 4.6 will prove crucial in this connection. Given T > 0, and\n\u03b1 > 0 we fix 0 < \u03c4 \u2264 (1 + \u03b1)T . For a function \u03c8 \u2208 C0\u221e (M), with \u03c8 \u2265 0, in M \u00d7 (0, \u03c4 )\nwe consider the function\nZ\nf (y, t) =\np(y, z, t)p(x, z, T )\u03c8(z)d\u03bc(z), x \u2208 M.\nM\n\nSince f = Pt (p(x, *, T )\u03c8), it satisfies the Cauchy problem\n(\nLf \u2212 ft = 0 in M \u00d7 (0, \u03c4 ),\nf (z, 0) = p(x, z, T )\u03c8(z), z \u2208 M.\nNotice that by the hypoellipticity of L \u2212 \u2202t we know y \u2192 p(x, y, T ) is in C \u221e (M), and\ntherefore p(x, *, T )\u03c8 \u2208 L\u221e (M). Moreover, (4.3) gives\nZ\n2\n2\n||Pt (p(x, *, T )\u03c8)||L2(M) \u2264 ||p(x, *, T )\u03c8||L2(M) =\np(x, z, T )2 \u03c8(z)d\u03bc(z) < \u221e,\nM\n\nand therefore\nZ\n\n0\n\n\u03c4\n\nZ\n\n2\n\nM\n\nf (y, t) d\u03bc(z)dt \u2264 \u03c4\n\nZ\n\nM\n\np(x, z, T )2 \u03c8(z)d\u03bc(z)dt < \u221e.\n\n(8.2)\n\nInvoking (4.9) in Corollary 4.6 we have\n\u0001\n\u0393(f )(z, t) \u2264 e\u2212\u03b1t Pt \u0393(p(x, *, T )\u03c8)(z) + Pt \u0393Z (p(x, *, T )\u03c8)(z) .\n\nThis allows to conclude\n\nZ\n\n0\n\n\u03c4\n\nZ\n\nM\n\n\u0393(f )(z, t)2 d\u03bc(z)dt < \u221e.\n\n(8.3)\n\nWe now consider a function g \u2208 C 1 ([0, (1 + \u03b1)T ], Lipd (M)) \u2229 L\u221e (M \u00d7 (0, (1 + \u03b1)T ))\nsuch that\n1\n\u2202g\n\u2265 \u0393(g), on M \u00d7 (0, (1 + \u03b1)T ).\n(8.4)\n\u2212\n\u2202t\n2\nSince\n\u2202\n\u2202\n(L \u2212 )f 2 = 2f (L \u2212 )f + 2\u0393(f ) = 2\u0393(f ),\n\u2202t\n\u2202t\n\n\fFabrice Baudoin, Nicola Garofalo\n\n64\n\nmultiplying this identity by h2n (y)eg(y,t) , where hn is a sequence as in Hypothesis 1.1, and\nintegrating by parts, we obtain\nZ \u03c4Z\nZ \u03c4Z\n\u2202\n2 g\n0=2\nhn e \u0393(f )d\u03bc(y)dt \u2212\nh2n eg (L \u2212 )f 2 d\u03bc(y)dt\n\u2202t\n0\nZ0 \u03c4 ZM\nZ \u03c4M\nZ\n=2\nh2n eg \u0393(f )d\u03bc(y)dt + 4\nhn eg f \u0393(hn , f )d\u03bc(y)dt\n0\nZ 0\u03c4 Z M\nZ \u03c4 MZ\n\u2202g\n+2\nh2n eg f \u0393(f, g)d\u03bc(y)dt \u2212\nhn eg f 2 d\u03bc(y)dt\n\u2202t\n0\nM\nZ\nZ 0 M\n+\nhn eg f 2 d\u03bc(y)\n\u2212\nhn eg f 2 d\u03bc(y)\nM\nM\nt=\u03c4\n\u0013\n\u0012 t=0\nZ \u03c4Z\nZ \u03c4Z\n2\nf\n2 g\nhn eg f \u0393(hn , f )d\u03bc(y)dt\n\u22652\nhn e \u0393(f ) + \u0393(g) + f \u0393(f, g) d\u03bc(y)dt + 4\n4\n0\nM\n0\nM\nZ\nZ\ng 2\n,\n\u2212\nhn eg f 2 d\u03bc(y)\nhn e f d\u03bc(y)\n+\nM\n\nM\n\nt=\u03c4\n\nt=0\n\nwhere in the last inequality we have made use of the assumption (8.4) on g. From this we\nconclude\nZ \u03c4Z\nZ\nZ\ng 2\ng 2\n\u22124\nhn eg f \u0393(hn , f )d\u03bc(y)dt.\n\u2264\nhn e f d\u03bc(y)\nhn e f d\u03bc(y)\nM\n\nM\n\nt=\u03c4\n\nWe now claim that\nlim\n\nn\u2192\u221e\n\nZ\n\nt=0\n\n\u03c4\n0\n\nZ\n\n0\n\nM\n\nhn eg f \u0393(hn , f )d\u03bc(y)dt = 0.\n\nM\n\nTo see this we apply Cauchy-Schwarz inequality which gives\nZ\n\n\u03c4\n\n0\n\n\u2264\n\nZ\n\ng\n\nM\n\n\u0012Z\n\n0\n\n\u03c4\n\nhn e f \u0393(hn , f )d\u03bc(y)dt \u2264\nZ\n\nM\n\n\u0012Z\n\n\u03c4\n\n0\n\n\u0013 21 \u0012Z\ng 2\ne f \u0393(hn )d\u03bc(y)dt\n\n0\n\n\u03c4\n\nZ\n\nZ\n\n\u0013 21 \u0012Z\n\nh2n eg f 2 \u0393(hn )d\u03bc(y)dt\nM\n\nM\n\n\u0013 21\ng\n\u2192 0,\ne \u0393(f )d\u03bc(y)dt\n\n0\n\n\u03c4\n\nZ\n\n\u0013 21\ne \u0393(f )d\u03bc(y)dt\ng\n\nM\n\nas n \u2192 \u221e, thanks to (8.2), (8.3). With the claim in hands we now let n \u2192 \u221e in the above\ninequality obtaining\nZ\nZ\ng(y,\u03c4 ) 2\ne\nf (y, \u03c4 )d\u03bc(y) \u2264\neg(y,0) f 2 (y, 0)d\u03bc(y).\n(8.5)\nM\n\nM\n\nAt this point we fix x \u2208 M and for 0 < t \u2264 \u03c4 consider the indicator function 1B(x,\u221at) of\n\u221a\nthe ball B(x, t). Let \u03c8k \u2208 C0\u221e (M), \u03c8k \u2265 0, be a sequence such that \u03c8k \u2192 1B(x,\u221at) in\n\u221a\nL2 (M), with supp \u03c8k \u2282 B(x, 100 t). Slightly abusing the notation we now set\nZ\nf (y, s) = Ps (p(x, *, T )1B(x,\u221at) )(y) =\np(y, z, s)p(x, z, T )d\u03bc(z).\n\u221a\nB(x, t)\n\n\fCurvature-dimension inequalities, etc.\n\n65\n\nThanks to the symmetry of p(x, y, s) = p(y, x, s), we have\nf (x, T ) =\n\nZ\n\np(x, z, T )2 d\u03bc(z).\n\n\u221a\n\n(8.6)\n\nB(x, t)\n\nApplying (8.5) to fk (y, s) = Ps (p(x, *, T )\u03c8k )(y), we find\nZ\n\neg(y,\u03c4 ) fk2 (y, \u03c4 )d\u03bc(y)\nM\n\n\u2264\n\nZ\n\neg(y,0) fk2 (y, 0)d\u03bc(y).\n\n(8.7)\n\nM\n\nAt this point we observe that as k \u2192 \u221e\nZ\n\neg(y,\u03c4 ) fk2 (y, \u03c4 )d\u03bc(y)\nM\n\n\u2212\n\nZ\n\neg(y,\u03c4 ) f 2 (y, \u03c4 )d\u03bc(y)\n\nM\n\n\u2264 2||eg(*,\u03c4 ) ||L\u221e (M) ||p(x, *, T )||L2(M) ||p(x, *, \u03c4 )||L\u221e (B(x,110\u221at)) ||\u03c8k \u2212 1B(x,\u221at) ||L2 (M) \u2192 0.\nBy similar considerations we find\nZ\n\neg(y,0) fk2 (y, 0)d\u03bc(y)\n\nM\ng(*,0)\n\n\u2264 2||e\n\n||\n\nL\u221e (M)\n\n\u2212\n\nZ\n\neg(y,0) f 2 (y, 0)d\u03bc(y)\n\nM\n\n||p(x, *, T )||L\u221e(B(x,110\u221at)) ||\u03c8k \u2212 1B(x,\u221at) ||L2 (M) \u2192 0.\n\nLetting k \u2192 \u221e in (8.7) we thus conclude that the same inequality holds with fk replaced\nby f (y, s) = Ps (p(x, *, T )1B(x,\u221at) )(y). This implies in particular the basic estimate\ng(z,\u03c4 )\n\nZ\n\ninf \u221a e\nf 2 (z, \u03c4 )d\u03bc(z)\n\u221a\nz\u2208B(x, t)\nB(x, t)\nZ\nZ\ng(z,\u03c4 ) 2\n\u2264\ne\nf (z, \u03c4 )d\u03bc(z) \u2264\neg(z,\u03c4 ) f 2 (z, \u03c4 )d\u03bc(z)\n\u221a\nM\nZB(x, t)\nZ\n\u2264\neg(z,0) f 2 (z, 0)d\u03bc(z) =\neg(z,0) p(x, z, T )2 d\u03bc(z)\n\u221a\nM\nB(y, t)\nZ\n\u2264 sup\u221a eg(z,0)\np(x, z, T )2 d\u03bc(z).\n\u221a\n\n(8.8)\n\nB(y, t)\n\nz\u2208B(y, t)\n\nAt this point we choose in (8.8)\ng(y, t) = gx (y, t) = \u2212\n\nd(x, y)2\n.\n2((1 + 2\u03b1)T \u2212 t)\n\nUsing the fact that \u0393(d) \u2264 1, one can easily check that (8.4) is satisfied for this g. Taking\ninto account that\ngx (z,\u03c4 )\n\ninf \u221a e\n\nz\u2208B(x, t)\n\n=\n\nd(x,z)2\n\n\u2212 2((1+2\u03b1)T \u2212\u03c4 )\n\ninf \u221a e\n\nz\u2208B(x, t)\n\n\u2212t\n\n\u2265 e 2((1+2\u03b1)T \u2212\u03c4 ) ,\n\n\fFabrice Baudoin, Nicola Garofalo\n\n66\n\nif we now choose \u03c4 = (1 + \u03b1)T , then from the previous inequality and from (8.6) we\nconclude that\n!Z\nZ\nd(x,z)2\nt\nf 2 (z, (1 + \u03b1)T )d\u03bc(z) \u2264\nsup\u221a e\u2212 2(1+2\u03b1)T + 2\u03b1T\np(x, z, T )2 d\u03bc(z).\n\u221a\n\u221a\nB(x, t)\n\nB(y, t)\n\nz\u2208B(y, t)\n\nWe now apply Theorem 7.1 which gives for every z \u2208 B(x,\n2\n\n2\n\nf (x, T ) \u2264 f (z, (1 + \u03b1)T ) (1 + \u03b1)\nIntegrating this inequality on B(x,\n\u0012Z\n\n2\n\n\u221a\n\np(x, z, T ) d\u03bc(z)\n\nB(y, t)\n\n\u00132\n\n\u221a\n\n\u221a\n\n3\u03ba\n)\nd(1+ 2\u03c1\n\n(8.9)\n\nt)\n3\u03ba )\nt(1+ 2\u03c1\n2\n2\u03b1T\n\n2\n\ne\n\n)\n\n3\u03ba )\nt(1+ 2\u03c1\n2\n\n.\n\nt) we find\nd(1+\n\n3\u03ba\n\n2\u03c12\ne 2\u03b1T\n(1 + \u03b1)\n\u221a\n= f (x, T )2 \u2264\n\u03bc(B(x, t))\n\nZ\n\nf 2 (z, (1+\u03b1)T )d\u03bc(z).\n\n\u221a\n\nB(x, t)\n\nIf we now use (8.9) in the last inequality we obtain\nZ\n\nd(1+\n\n3\u03ba\n\n)\n\n3\u03ba )\nt(1+ 2\u03c1\n2\n\n2\u03c12\n(1 + \u03b1)\ne 2\u03b1T\n\u221a\np(x, z, T )2 d\u03bc(z) \u2264\n\u221a\n\u03bc(B(x, t))\nB(y, t)\n\nsup\n\n\u221a\nz\u2208B(y, t)\n\nd(x,z)2\n\u2212 2(1+2\u03b1)T\n\ne\n\nt\n+ 2\u03b1T\n\n!\n\n.\n\nChoosing T = (1 + \u03b1)t in this inequality we find\nZ\n\n2\n\n\u221a\nB(y, t)\n\np(x, z, (1 + \u03b1)t) d\u03bc(z) \u2264\n\n(1 + \u03b1)\n\n3\u03ba\nd(1+ 2\u03c1\n)\n\n3\u03ba )\n(1+ 2\u03c1\n1\n2 +\n2\u03b1(1+\u03b1)\n2\u03b1(1+\u03b1)\n\ne\n\u221a\n\u03bc(B(x, t))\n2\n\nsup\n\n\u221a\nz\u2208B(y, t)\n\nd(x,z)2\n\n1\n\u2212 2(1+2\u03b1)(1+\u03b1)t + 2\u03b1(1+\u03b1)\n\ne\n\n(8.10)\n\n\u221a\nWe now apply Corollary 7.2 obtaining for every z \u2208 B(y, t)\np(x, y, t)2 \u2264 p(x, z, (1 + \u03b1)t)2 (1 + \u03b1)\n\n\u0011\n\u0010\n3\u03ba\nd 1+ 2\u03c1\n\nexp\n\n2\n\n1+\n\n3\u03ba\n2\u03c12\n\n2\u03b1\n\n!\n\n.\n\n\u221a\nIntegrating this inequality in z \u2208 B(y, t), we have\n\u0011 1+ 3\u03ba Z\n\u0010\n\u221a\n3\u03ba\n2\u03c12\nd 1+ 2\u03c1\n2\n2 e 2\u03b1\n\u03bc(B(y, t))p(x, y, t) \u2264 (1 + \u03b1)\n\n\u221a\n\np(x, z, (1 + \u03b1)t)2 d\u03bc(z).\n\nB(y, t)\n\nCombining this inequality with (8.10) we conclude\n\np(x, y, t) \u2264\n\n(1 + \u03b1)\n\n3\u03ba\nd(1+ 2\u03c1\n)\n\n\u03bc(B(x,\n\n2\n\n\u221a\n\ne\n\n3\u03ba )(2+\u03b1)\n(1+ 2\u03c1\n3\n2\n+ 4\u03b1(1+\u03b1)\n4\u03b1(1+\u03b1)\n\n\u221a 1\n1\nt)) 2 \u03bc(B(y, t)) 2\n\n\u221a\nIf now x \u2208 B(y, t), then\nd(x, z)2 \u2265 (d(x, y) \u2212\n\n\u221a\n\nsup\n\n\u221a\nz\u2208B(y, t)\n\ne\n\nt)2 > d(x, y)2 \u2212 t,\n\nd(x,z)2\n\n\u2212 2(1+2\u03b1)(1+\u03b1)t\n\n!\n\n.\n\n!\n\n.\n\n\fCurvature-dimension inequalities, etc.\n\n67\n\nand therefore\nd(x,z)2\n\n1\n\nd(x,y)2\n\nsup\u221a e\u2212 2(1+2\u03b1)(1+\u03b1)t \u2264 e 2(1+2\u03b1)(1+\u03b1) e\u2212 2(1+2\u03b1)(1+\u03b1)t .\n\nz\u2208B(y, t)\n\n\u221a\nIf instead x 6\u2208 B(y, t), then for every \u03b4 > 0 we have\nd(x, z)2 \u2265 (1 \u2212 \u03b4)d(x, y)2 \u2212 (1 + \u03b4 \u22121 )t\nChoosing \u03b4 = \u03b1/(\u03b1 + 1) we find\nd(x, z)2 \u2265\n\nd(x, y)2\n\u2212 (2 + \u03b1\u22121 )t,\n1+\u03b1\n\nand therefore\nd(x,z)2\n\n\u2212\n\nsup\u221a e\u2212 2(1+2\u03b1)(1+\u03b1)t \u2264 e\n\nd(x,y)2\n2+\u03b1\u22121\n+ 2(1+2\u03b1)(1+\u03b1)\n2(1+2\u03b1)(1+\u03b1)2 t\n\nz\u2208B(y, t)\n\nFor any \u01eb > 0 we now choose \u03b1 > 0 such that 2(1 + 2\u03b1)(1 + \u03b1)2 = 4 + \u01eb to reach the\ndesired conclusion.\n\n9 A generalization of Yau's Liouville theorem\nIn his seminal 1975 paper [58], by using gradient estimates, Yau proved his celebrated\nLiouville theorem that there exists no non-constant positive harmonic function on a complete Riemannian manifold with non-negative Ricci curvature. The aim of this section is\nto extend Yau's theorem to the sub-Riemannian setting of this paper. An interesting point\nto keep in mind here is that, even in the Riemannian setting, our approach gives a new\nproof of Yau's theorem which is not based on delicate tools from Riemann geometry such\nas the Laplacian comparison theorem (1.14) for the geodesic distance. However, due to\nthe nature of our proof at the moment we are only able to deal with harmonic functions\nbounded from two sides, whereas in [58] the author is able to treat functions satisfying a\none-side bound. In the sequel paper [14] we will remove this restriction.\nWe begin with a Harnack type inequality for the operator L.\nTheorem 9.1. Assume the Hypothesis 1.1, 1.2, 1.4 and that the curvature-dimension inequality (1.12) be satisfied for \u03c11 \u2265 0. Let 0 \u2264 f \u2264 M be a harmonic function on M,\nthen there exists a constant C = C(\u03c12 , \u03ba, d) > 0 such that for any x0 \u2208 M and any r > 0\none has\nsup f \u2264 C inf f.\n\nB(x0 ,r)\n\nB(x0 ,r)\n\n\fFabrice Baudoin, Nicola Garofalo\n\n68\n\nProof. We know that f \u2208 Cb\u221e (M), and f \u2265 0. Applying Theorem 7.1 to the function\nu(x, t) = Pt f (x), we obtain for x, y \u2208 B(x0 , r)\n\u0012 \u0013 D2\n\u0012\n\u0013\nt\nDr 2\nPs f (x) \u2264 Pt f (y)\nexp\n, 0 < s < t < \u221e.\ns\nd(t \u2212 s)\nAt this point we observe that, thanks to the assumption Lf = 0, the functions u(x, t) =\nPt f (x) and v(x, t) = f (x) solve the same Cauchy problem on M. By Proposition 4.4\nwe must have Pt f (x) = f (x) for every x \u2208 M and every t > 0. Therefore, taking\ns = r 2 , t = 2r 2 , the latter inequality gives\n\u0010\u221a 1 \u0011D\nf (x) \u2264\n2e d\nf (y), x, y \u2208 B(x0 , r).\nTheorem 9.2 (of Cauchy-Liouville type). Under the same assumptions of Theorem 9.1,\nthere exist no bounded solutions to Lf = 0 on M, other than the constants.\nProof. Suppose a \u2264 f \u2264 b on M. Consider the function g = f \u2212 inf f . Clearly, 0 \u2264 g \u2264\nM\n\nM = b \u2212 a. If we apply Theorem 9.1 to g we find for any x0 \u2208 M and r > 0\nsup g \u2264 C inf g.\nB(x0 ,r)\n\nB(x0 ,r)\n\nLetting r \u2192 \u221e we reach the conclusion sup f = inf f , hence f \u2261 const.\nM\n\nM\n\n10 A sub-Riemannian Bonnet-Myers theorem\nLet (M, g) be a complete, connected Riemannian manifold of dimension n \u2265 2. It is\nwell-known that if for some \u03c11 > 0 the Ricci tensor of M satisfies the bound\nRic \u2265 (n \u2212 1)\u03c11 ,\n\n(10.1)\n\nthen M is compact, with a finite fundamental group, and diam(M) \u2264 \u221a\u03c0\u03c11 . This is the\ncelebrated Myer's theorem, which strengthens Bonnet's theorem. Like the latter, Myer's\ntheorem is usually proved by using Jacobi vector fields (see e.g. Theorem 2.12 in [19]).\nA different approach is based on the curvature-dimension inequality CD((n\u22121)\u03c11 , n),\nwhich as we have seen, one obtains from (10.1) (see (1.2)). When n > 2, in the paper\n[38] (see also [10]) Ledoux uses ingenious non-linear methods, based on the study of the\npartial differential equation\nc(f p\u22121 \u2212 f ) = \u2212\u2206f,\n\n1\u2264p\u2264\n\n2n\n,\nn\u22122\n\n\fCurvature-dimension inequalities, etc.\n\n69\n\nto deduce from the curvature-dimension inequality CD((n\u22121)\u03c11 , n) the following Sobolev\ninequality\nn\n(n \u2212 2)\u03c121\n\n\"\u0012Z\n\nM\n\np\n\n|f | d\u03bc\n\n\u00132/p\n\n\u2212\n\nZ\n\nM\n\n2\n\n#\n\nf d\u03bc \u2264\n\nZ\n\nM\n\n\u0393(f )d\u03bc, f \u2208 C0\u221e (M),\n\n(10.2)\n\nwhere \u03bc is the Riemannian measure. By a simple iteration procedure, the author shows\nfrom (10.2) that the diameter of M is finite and bounded by \u221a\u03c0\u03c11 . The non-linear methods\nin [38] seem difficult to extend to the framework of the present paper.\nA weaker version of the Myers theorem was proved by Bakry in [6] by using linear\nmethods only. We have been able to suitably adapt his approach, based on entropy-energy\ninequalities (a strong form of log-Sobolev inequalities). In this section we establish the\nfollowing sub-Riemannian Bonnet-Myer's compactness theorem.\nTheorem 10.1. Assume the Hypothesis 1.1, 1.2, 1.4, and that the curvature-dimension\ninequality (1.12) be satisfied for \u03c11 > 0. Then, the metric space (M, d) is compact and we\nhave\ns\u0012\ns\n\u0012\n\u0013\n\u0013\n\u221a\n\u221a\n\u03c0\n\u03ba\n\u03c12 + \u03ba\n3\u03ba\ndiam M \u2264 \u221a 2 3\n1+\nd.\n+ 1 D = 2 3\u03c0\n\u03c11\n\u03c12\n\u03c11 \u03c12\n2\u03c12\nThe proof of Theorem 10.1 will be accomplished in several steps. In the remainder of\nthis section we will tacitly assume the hypothesis of Theorem 10.1.\n\n10.1 Global heat kernel bounds\nOur first result is the following large-time exponential decay for the heat kernel.\nProposition 10.2. Let 0 < \u03bd <\nf \u2208 C0\u221e (M), f \u2265 0:\n\n\u03c11 \u03c12\n.\n\u03c12 +\u03ba\n\nThere exist t0 > 0 and C1 > 0 such that for every\n\n\u2202\nln Pt f (x) \u2264 C1 e\u2212\u03bdt ,\n\u2202t\n\nx \u2208 M, t \u2265 t0 .\n\nProof. In Corollary 5.3, we choose\nb(t) = (e\u2212\u03b1t \u2212 e\u2212\u03b1T )\u03b2 ,\n\n0 \u2264 t \u2264 T,\n\nwith \u03b2 > 2 and \u03b1 > 0. With such choice a simple computation gives,\n\u0012\n\u0012\n\u0013\n\u0013\n\u03b1\u03b2\u03ba\n\u03ba\nd\n\u2212 \u03b21\n\u2212\u03b1T\n\u03b1(\u03b2 \u2212 1) +\n.\n2\u03c11 \u2212 \u03b1\u03b2 \u2212 \u03b1\u03b2 \u2212 e\nb(t)\n\u03b3(t) =\n4\n\u03c12\n\u03c12\n\n\fFabrice Baudoin, Nicola Garofalo\n\n70\n\nKeeping in mind that b(T ) = b\u2032 (T ) = 0, and that b(0) = (1 \u2212 e\u2212\u03b1T )\u03b2 , b\u2032 (0) = \u2212\u03b1\u03b2(1 \u2212\ne\u2212\u03b1T )\u03b2\u22121 , we obtain from (5.2)\n\u03b1\u03b2(1 \u2212 e\u2212\u03b1T )\u03b2\u22121\n\u0393(ln PT f ) \u2212 (1 \u2212 e\u2212\u03b1T )\u03b2 \u0393Z (ln PT f )\n2\u03c12\n\u0012Z T\n\u0012Z T\n\u0013\n\u0013\n2\n1\nLPT f\n\u2032\n\u2032\n2\n\u2265\u2212\n+\nb (t)\u03b3(t)dt\nb (t)\u03b3(t) dt .\nd\u03c12\nPT f\nd\u03c12\n0\n0\n\n\u2212\n\n(10.3)\n\nNow,\nZ\n\nT\n\nZ\n\nT\n0\n\n\u0012\n\u00132\n\u03ba\nd2\n2\u03c11 \u2212 \u03b1\u03b2 \u2212 \u03b1\u03b2\n(1 \u2212 e\u2212\u03b1T )\u03b2\nb (t)\u03b3(t) dt = \u2212\n16\n\u03c12\n\u0010\n\u0011\u0010\n\u0011\n\u03ba\n\u03ba\n2 2\u03c11 \u2212 \u03b1\u03b2 \u2212 \u03b1\u03b2\n\u03b1\u03b2\n\u2212\n\u03b1\n+\n\u03b1\u03b2\n\u03c12\n\u03c12\nd\n+\ne\u2212\u03b1T (1 \u2212 e\u2212\u03b1T )\u03b2\u22121\n1\n8\n1\u2212 \u03b2\n\u00112\n\u0010\n\u03ba\n2 \u03b1\u03b2 \u2212 \u03b1 + \u03b1\u03b2\n\u03c12\nd\ne\u22122\u03b1T (1 \u2212 e\u2212\u03b1T )\u03b2\u22122 .\n\u2212\n2\n16\n1\u2212 \u03b2\n\u2032\n\n0\n\n\u0012\n\u0013\nd\n\u03ba\nb (t)\u03b3(t)dt = \u2212\n2\u03c11 \u2212 \u03b1\u03b2 \u2212 \u03b1\u03b2\n(1 \u2212 e\u2212\u03b1T )\u03b2\n4\n\u03c12\n\u0013\n\u0012\nd 1\n\u03ba\ne\u2212\u03b1T (1 \u2212 e\u2212\u03b1T )\u03b2\u22121 ,\n+\n\u03b1\u03b2 \u2212 \u03b1 + \u03b1\u03b2\n4 1 \u2212 \u03b21\n\u03c12\n\u2032\n\n2\n\nIf we choose\n\u03b1=\nthen\n2\u03c11 \u2212 \u03b1\u03b2 \u2212 \u03b1\u03b2\n\n2\u03c11 \u03c12\n,\n\u03b2(\u03c12 + \u03ba)\n\n\u03ba\n\u03ba\n= 0, \u03b1\u03b2 \u2212 \u03b1 + \u03b1\u03b2 = 2\u03c11 \u2212 \u03b1,\n\u03c12\n\u03c12\n\nand we obtain from (10.3):\n0\u2264\n\nd(2\u03c11 \u2212 \u03b1) \u2212\u03b1T LPT f\n\u03c11\n\u0011e\n\u0010\n\u0393(ln PT f ) + (1 \u2212 e\u2212\u03b1T )\u0393Z (ln PT f ) \u2264\n1\n\u03c12 + \u03ba\nPT f\n2\u03c12 1 \u2212 \u03b2\n+\n\nd(2\u03c11 \u2212 \u03b1)2 e\u22122\u03b1T\n\u0011\n\u0010\n.\n\u2212\u03b1T\n16\u03c12 1 \u2212 \u03b22 1 \u2212 e\n\n(10.4)\n\n\u03c12\n1\n((\u03b2 \u2212 1)\u03c12 + \u03b2\u03ba) > 0, and that \u03b2 > 2 implies \u03b1 < \u03c1\u03c121+\u03ba\n,\nNoting that 2\u03c11 \u2212 \u03b1 = \u03b2(\u03c12\u03c12 +\u03ba)\n\u2202\n(10.4) gives in particular the desired lower bound for \u2202t ln Pt f (x) with \u03bd = \u03b1.\n2\u03c11 \u03c12\n, and with \u03b3 = 2\u03b2\u03c11 \u03c12 we\nThe upper bound is more delicate. We fix 0 < \u03b7 = \u03b2(\u03c1\n2 +\u03ba)\nnow choose in (10.3)\n\n\u03b1=\n\n2\u03c11 \u03c12 \u2212 \u03b3e\u2212\u03b7T\n\u03b3e\u2212\u03b7T\n=\u03b7\u2212\n.\n\u03b2(\u03c12 + \u03ba)\n\u03b2(\u03c12 + \u03ba)\n\n\fCurvature-dimension inequalities, etc.\n\n71\n\nClearly, \u03b1 > 0 provided that T be sufficiently large. This choice gives\n2\u03c11 \u2212 \u03b1\u03b2 \u2212 \u03b1\u03b2\n\n\u03ba\n\u03b3e\u2212\u03b7T\n\u03ba\n\u03b3e\u2212\u03b7T\n=\n, \u03b1\u03b2 \u2212 \u03b1 + \u03b1\u03b2 = 2\u03c11 \u2212 \u03b1 \u2212\n.\n\u03c12\n\u03c12\n\u03c12\n\u03c12\n\nWe thus have\n\u001a\n\u001b\nZ T\n\u03b3(1 \u2212 e\u2212\u03b1T )e\u2212(\u03b7\u2212\u03b1)T\n\u03b2\n\u03b3e\u2212\u03b7T\nd \u2212\u03b1T\n\u2212\u03b1T \u03b2\u22121\n\u2032\n(1 \u2212 e\n)\n\u2212\n(2\u03c11 \u2212 \u03b1 \u2212\n) .\nb (t)\u03b3(t)dt = \u2212 e\n4\n\u03c12\n\u03b2\u22121\n\u03c12\n0\n\u2212\u03b7T\n\ne\n\u2212 \u03b3T\n\u03b2(\u03c1\n\nNoting that e\u2212(\u03b7\u2212\u03b1)T = e\n\n2 +\u03ba)\n\n\u2192 1, and \u03b1 \u2212\u2192\n\n2\u03c11 \u03c12\n\u03b2(\u03c12 +\u03ba)\n\nas T \u2192 \u221e, we obtain\n\n\u0012\n\u0013\n\u03b3(1 \u2212 e\u2212\u03b1T )e\u2212(\u03b7\u2212\u03b1)T\n2\u03c11 \u03c12\n\u03b2\n\u03b3e\u2212\u03b7T\n\u03b3\n\u03b2\n2\u03c11 \u2212\n.\n\u2212\n(2\u03c11 \u2212\u03b1\u2212\n) \u2212\u2192\n\u2212\n\u03c12\n\u03b2\u22121\n\u03c12\n\u03c12 \u03b2 \u2212 1\n\u03b2(\u03c12 + \u03ba)\n\u0010\n\u0011\n2\u03c11 \u03c12\n\u03b2\nSince by our choice of \u03b3 we have \u03c1\u03b32 \u2212 \u03b2\u22121\n2\u03c11 \u2212 \u03b2(\u03c1\n> 0, it is clear that we have\n2 +\u03ba)\nZ\n\n0\n\nT\n\nd\nb (t)\u03b3(t)dt \u2264 \u2212\n8\n\u2032\n\n\u0012\n\n\u0012\n\u0013\u0013\n2\u03c11 \u03c12\n\u03b3\n\u03b2\n2\u03c11 \u2212\ne\u2212\u03b1T (1 \u2212 e\u2212\u03b1T )\u03b2\u22121 ,\n\u2212\n\u03c12 \u03b2 \u2212 1\n\u03b2(\u03c12 + \u03ba)\n\nprovided that T be large enough. We also have\n\u001a\nZ T\n\u03b3e\u2212\u03b7T 2\n\u03b2\nd2 \u22122\u03b1T\n\u2212\u03b1T \u03b2\u22122\n\u2032\n2\n(1 \u2212 e\n)\n(2\u03c11 \u2212 \u03b1 \u2212\n)\nb (t)\u03b3(t) dt = \u2212 e\n16\n\u03b2\u22122\n\u03c12\n0\n\u001b\n\u03b32\n\u03b3e\u2212\u03b7T \u2212(\u03b7\u2212\u03b1)T\n\u03b3 \u03b2\n\u2212\u03b1T\n\u2212\u03b1T 2 \u22122(\u03b7\u2212\u03b1)T\n+ 2 (1 \u2212 e\n.\n(1 \u2212 e\n)(2\u03c11 \u2212 \u03b1 \u2212\n)e\n)e\n\u22122\n\u03c12\n\u03c12 \u03b2 \u2212 1\n\u03c12\nUsing our choice of \u03b3 we see that, if we let T \u2192 \u221e, the quantity between curly bracket\nin the right-hand side converges to\n\u00132\n\u0012\n\u03b2\n8\u03b2 2 \u03c121 (\u03b2 \u2212 1)\u03c12 + \u03b2\u03ba\n(\u03b2 \u2212 1)\u03c12 + \u03b2\u03ba\n2\n+ 4\u03b2 2 \u03c121 \u2212\n4\u03c11\n.\n\u03b2\u22122\n\u03b2(\u03c12 + \u03ba)\n\u03b2 \u2212 1 \u03b2(\u03c12 + \u03ba)\nThis quantity is strictly positive provided that\n2\u03b2 (\u03b2 \u2212 1)\u03c12 + \u03b2\u03ba\n1\n<\n\u03b2 \u2212 1 \u03b2(\u03c12 + \u03ba)\n\u03b2\u22122\n\n\u0012\n\n(\u03b2 \u2212 1)\u03c12 + \u03b2\u03ba\n\u03b2(\u03c12 + \u03ba)\n\n\u00132\n\n+ \u03b2,\n\nand this latter inequality is true, as one recognizes by applying the inequality 2xy \u2264\nx2 + y 2. From these considerations and from (10.3) we conclude the desired upper bound\n\u2202\nfor \u2202t\nln Pt f (x).\nProposition 10.3. Let 0 < \u03bd <\nf \u2208 C0\u221e (M), with f \u2265 0,\ne\u2212C2 e\n\n\u2212\u03bdt d(x,y)\n\n\u2264\n\n\u03c11 \u03c12\n.\n\u03ba+\u03c12\n\nThere exist t0 > 0 and C2 > 0 such that for every\n\nPt f (x)\n\u2212\u03bdt\n\u2264 eC2 e d(x,y) ,\nPt f (y)\n\nx, y \u2208 M, t \u2265 t0 .\n\n\fFabrice Baudoin, Nicola Garofalo\n\n72\n\nProof. If we combine (10.4) (in which we take \u03b1 = \u03bd), with the upper bound of Proposition 10.2, we obtain that for x \u2208 M and t \u2265 t0 ,\n\u0393(ln Pt f )(x) \u2264 C22 e\u22122\u03bdt ,\np\nwith C2 = d(2\u03c11 \u2212 \u03bd)/2\u03c12 (1 \u2212 \u03b2 \u22121 ). We infer that the function u(x) = C2\u22121 e\u03bdt ln Pt f (x),\nwhich belongs to C \u221e (M), is such that ||\u0393(u)||\u221e \u2264 1. From (1.7) we obtain that\n|u(x) \u2212 u(y)| \u2264 d(x, y),\n\nx, y \u2208 M.\n\nThis implies the sought for conclusion.\nIf we now fix x \u2208 M, and denote by p(x, *, t) the heat kernel with singularity at (x, 0),\nthen according to Proposition 10.2 we obtain for t \u2265 t0 ,\n\u2202 ln p(x, y, t)\n\u2264 C1 exp (\u2212\u03bdt) ,\n\u2202t\n\n(10.5)\n\n\u03c11 \u03c12\nwith 0 < \u03bd < \u03ba+\u03c1\n. This shows that ln p(*, *, t) converges when t \u2192 \u221e. Let us call ln p\u221e\n2\nthis limit. Moreover, from Proposition 10.3 the limit, ln p\u221e (x, *) is a constant C(x). By\nthe symmetry property p(x, y, t) = p(y, x, t), so that C(x) actually does not depend on x.\nWe deduce from this that the measure \u03bc is finite. We may then as well suppose that \u03bc is a\nprobability measure, in which case p\u221e = 1. We assume this from now on.\nWe now can prove a global and explicit upper bound for the heat kernel p(x, y, t).\n\nProposition 10.4. For x, y \u2208 M and t > 0,\np(x, y, t) \u2264 \u0010\n\n1\n2\u03c1 \u03c12 t\n\u2212 3(\u03c11 +\u03ba)\n2\n\n1\u2212e\n\nProof. We apply (10.4) with \u03b2 = 3 and obtain\n\n\u0011 d2\n\n\u0010\n\u0011.\n3\u03ba\n1+ 2\u03c1\n2\n\n\u03c11 2\u03c12 + 3\u03ba \u2212\u03b1t LPt f\n\u03c11\n\u0393(ln Pt f ) + (1 \u2212 e\u2212\u03b1t )\u0393Z (ln Pt f ) \u2264\ne\n(10.6)\n\u03c12 + \u03ba\n2\u03c12 \u03c12 + \u03ba\nPt f\n\u0012\n\u00132 \u22122\u03b1t\nd\u03c121 2\u03c12 + 3\u03ba\ne\n+\n,\n12\u03c12\n\u03c12 + \u03ba\n1 \u2212 e\u2212\u03b1t\nwhere \u03b1 =\n\n2\u03c11 \u03c12\n.\n3(\u03c12 +\u03ba)\n\nWe deduce\nd\u03c11 2\u03c12 + 3\u03ba e\u2212\u03b1t\n\u2202 ln Pt f\n\u2265\u2212\n.\n\u2202t\n6 \u03c12 + \u03ba 1 \u2212 e\u2212\u03b1t\n\nBy integrating from t to \u221e, we obtain\n\nd\n\u2212 ln p(x, y, t) \u2265 \u2212\n2\n\nThis gives the desired conclusion.\n\n\u0012\n\u0013\n3\u03ba\n1+\nln(1 \u2212 e\u2212\u03b1t ).\n2\u03c12\n\n\fCurvature-dimension inequalities, etc.\n\n73\n\n10.2 Diameter bound\nIn this subsection we conclude the proof of Theorem 10.1 by showing that the diam M is\nbounded. The idea is to show that the operator L satisfies an entropy-energy inequality.\nSuch inequalities have been extensively studied by Bakry (see chapters 4 and 5 in [6]). To\nsimplify the computations, in what follows we denote by D the number defined in (6.2),\nand we set\n2\u03c11 \u03c12\n\u03b1=\n.\n3(\u03c12 + \u03ba)\nR\nProposition 10.5. For f \u2208 L2 (M) such that M f 2 d\u03bc = 1, we have\n\u0012Z\n\u0013\nZ\n2\n2\nf ln f d\u03bc \u2264 \u03a6\n\u0393(f )d\u03bc ,\nM\n\nwhere\n\nM\n\n\u0013 \u0012\n\u0013\n\u0012\n\u0013\u0015\n\u0014\u0012\n2\n2\n2\n2\nx ln 1 +\nx \u2212\nx ln\nx .\n\u03a6(x) = D 1 +\n\u03b1D\n\u03b1D\n\u03b1D\n\u03b1D\n\nProof. From Proposition 10.4, for every f \u2208 L2 (M) we have\nkPt f k\u221e \u2264\n\n1\nD\n\n(1 \u2212 e\u2212\u03b1t ) 2\n\nkf k2 .\n\nTherefore, from Davies' theorem (Theorem 2.2.3 in [23]), for f \u2208 L2 (M) such that\nR 2\nf d\u03bc = 1, we obtain\nM\nZ\nZ\n\u0001\n2\n2\nf ln f d\u03bc \u2264 2t\n\u0393(f )d\u03bc \u2212 D ln 1 \u2212 e\u2212\u03b1t , t > 0.\nM\n\nM\n\nBy minimizing over t the right-hand side of the above inequality, we obtain\n\u0013\n\u0012\n\u0013\n\u0012\nZ\n2\n2x + \u03b1D\n2x\n2\n2\nf ln f d\u03bc \u2264 \u2212 x ln\n+ D ln\n.\n\u03b1\n2x + \u03b1D\n\u03b1D\nM\nR\nwhere x = M \u0393(f )d\u03bc. It is now an easy exercise to recognize that the right-hand side of\nthe latter inequality is the same as \u03a6(x).\nWith Proposition 10.5 in hands, we can finally complete the proof of Theorem 10.1.\nProposition 10.6. One has\n\u221a\n\ndiam M \u2264 2 2\n\nr\n\n\u221a\nD\n\u03c0 = 2 3\u03c0\n\u03b1\n\ns\n\n\u03c12 + \u03ba\n\u03c11 \u03c12\n\n\u0012\n\u0013\n3\u03ba\n1+\nd.\n2\u03c12\n\nProof. The function \u03a6 that appears in the Proposition 10.5 enjoys the following properties:\n\n\fFabrice Baudoin, Nicola Garofalo\n\n74\n\n\u2022 \u03a6\u2032 (x)/x1/2 and \u03a6(x)/x3/2 are integrable on (0, \u221e);\n\u2022 \u03a6 is concave;\nR +\u221e\nR +\u221e\ndx\n=\n\u2022 21 0 \u03a6(x)\n3/2\n0\nx\n\n\u03a6\u2032 (x)\n\u221a dx\nx\n\n= \u22122\n\nR +\u221e \u221a\n0\n\nx\u03a6\u2032\u2032 (x)dx < +\u221e.\n\nWe can therefore apply the beautiful Theorem 5.4 in [6] to deduce that the diameter of M\nis finite and\nZ +\u221e\n\u221a \u2032\u2032\ndiam M \u2264 \u22122\nx\u03a6 (x)dx.\n0\n\n2D\n, a routine calculation shows\nSince \u03a6\u2032\u2032 (x) = \u2212 x(2x+\u03b1D)\n\n\u22122\n\nZ\n\n+\u221e\n0\n\n\u221a\n\ns\u0012\n\u0013\n\u221a\n\u03ba\n\u03c0\n\u2032\u2032\nx\u03a6 (x)dx = \u221a 2 3\n+ 1 D.\n\u03c11\n\u03c12\n\n\u221a\n\nRemark 10.7. The constant 2 3\u03c0\n\nr\n\n\u03c12 +\u03ba\n\u03c11 \u03c12\n\n\u0010\n\n1+\n\n3\u03ba\n2\u03c12\n\n\u0011\n\nd is not sharp. For instance, if M is\n\na Riemannian manifold, we can take d = n = dim(M), \u03ba = 0, and we thus obtain\n\u221a rn\ndiam M \u2264 2 3\u03c0\n,\n\u03c11\nwhereas it is known from the classical Bonnet-Myer's theorem that\nr\nn\u22121\n.\ndiam M \u2264 \u03c0\n\u03c11\n\nAcknowledgments. The first author supported in part by NSF Grant DMS 0907326. The second author was\nsupported in part by NSF Grant DMS-1001317\n\nReferences\n[1] A. Agrachev, Geometry of optimal control problems and Hamiltonian systems, SISSA, preprint series,\n42/2005/M.\n[2] A. Agrachev & P. Lee, Generalized Ricci curvature bounds on three-dimensional contact subRiemannian manifolds, To appear Math. Ann., (2014)\n[3] A. Agrachev, P. Lee: Bishop and Laplacian comparison theorems on three-dimensional contact subriemannian manifolds with symmetry, to appear Journal of Geometric Analysis, (2014).\n[4] C. An\u00e9; S. Blach\u00e8re, D. Chafa\u0131\u0308, P. Foug\u00e8res, I. Gentil, F. Malrieu, C. Roberto, G. Scheffer, Sur les\nin\u00e9galit\u00e9s de Sobolev logarithmiques. (French) [Logarithmic Sobolev inequalities] With a preface by\nDominique Bakry and Michel Ledoux. Panoramas et Synth\u00e8ses, 10. Soci\u00e9t\u00e9 Math\u00e9matique de France,\nParis, 2000. xvi+217\n\n\fCurvature-dimension inequalities, etc.\n\n75\n\n[5] D. Bakry, Un crit\u00e8re de non-explosion pour certaines diffusions sur une vari\u00e9t\u00e9 riemannienne\ncompl\u00e8te.C. R. Acad. Sci. Paris S\u00e9r. I Math. 303 (1986), no. 1, 2326.\n[6] D. Bakry, L'hypercontractivit\u00e9 et son utilisation en th\u00e9orie des semigroupes, Ecole d'Et\u00e9 de Probabilites de St-Flour, Lecture Notes in Math, (1994).\n[7] D. Bakry, Functional inequalities for Markov semigroups. Probability measures on groups: recent\ndirections and trends, 91\u2013147, Tata Inst. Fund. Res., Mumbai, 2006.\n[8] D. Bakry, F. Baudoin, M. Bonnefont & B. Qian, Subelliptic Li-Yau estimates on three dimensional\nmodel spaces, Potential Theory and Stochastics in Albac, Aurel Cornea Memorial Volume (2009).\n[9] D. Bakry & M. Emery, Diffusions hypercontractives, S\u00e9min. de probabilit\u00e9s XIX, Univ. Strasbourg,\nSpringer, 1983.\n[10] D. Bakry & M. Ledoux, Sobolev inequalities and Myers's diameter theorem for an abstract Markov\ngenerator. Duke Math. J. 85 (1996), no. 1, 253270.\n[11] D. Bakry & M. Ledoux, A logarithmic Sobolev form of the Li-Yau parabolic inequality. Revista Mat.\nIberoamericana 22 (2006), 683\u2013702.\n[12] F. Baudoin, An introduction to the geometry of stochastic flows, Imperial College Press, London, 2004.\nx+140 pp.\n[13] F. Baudoin & M. Bonnefont, The subelliptic heat kernel on SU(2): Representations, asymptotics and\ngradient bounds, Math. Zeit., 263, no. 3, (2009), 647-672.\n[14] F. Baudoin, M. Bonnefont & N. Garofalo, A sub-Riemannian curvature-dimension inequality, volume\ndoubling property and the Poincar\u00e9 inequality, Math. Ann. 358 (2014), 3-4, 833-860\n[15] F. Baudoin & N. Garofalo, Perelman's entropy and doubling property on Riemannian manifolds, Journal of Geometric Analysis, 21 (2011), 1119-1131.\n[16] C.P. Boyer, K. Galicki: 3-Sasakian manifolds, arXiv:hep-th/9810250\n[17] H.D. Cao, S.T. Yau, Gradient estimates, Harnack inequalities and estimates for heat kernels of the\nsum of squares of vector fields, Mathematische Zeitschrift, 211 (1992), 485-504.\n[18] E. Carlen, S. Kusuoka & D. Stroock, Upper bounds for symmetric Markov transition functions, Ann.\nInst. H. Poincar\u00e9 Probab. Statist. 23 (1987), no. 2, suppl., 245\u2013287.\n[19] I. Chavel, Riemannian geometry: a modern introduction, Cambridge Tracts in Mathematics, vol. 108,\nCambridge Univ. Press, 1993.\n[20] T. Coulhon & A. Sikora, Gaussian heat kernel bounds via Phragmn-Lindel?f theorem, Proc. London\nMath. Soc. 3, 96 (2008) 507-544.\n[21] B. Chow, P. Lu & L. Ni, Hamilton's Ricci flow, Graduate Studies in Mathematics, 77. American\nMathematical Society, Providence, RI; Science Press, New York, 2006. xxxvi+608 pp.\n[22] M. Cowling, A. H. Dooley, A. Kor\u00e1nyi & F. Ricci, H-type groups and Iwasawa decompositions, Adv.\nin Math., 87 (1991), 1-41.\n[23] Davies, E.B. Heat kernels and spectral theory. Cambridge Tracts in Mathematics, 92. Cambridge\nUniversity Press, Cambridge, 1989.\n[24] J. Dodziuk, Maximum principle for parabolic inequalities and the heat flow on open manifolds, Indiana Univ. Math. J. 32 (1983), 703-716.\n[25] S. Dragomir & G. Tomassini, Differential geometry and analysis on CR manifolds, Birkh\u00e4user, Vol.\n246, 2006.\n[26] M. Falcitelli, S. Ianus & A. M. Pastore, Riemannian submersions and related topics. World Scientific\nPublishing Co., Inc., River Edge, NJ, 2004. xiv+277 pp\n\n\f76\n\nFabrice Baudoin, Nicola Garofalo\n\n[27] C. Fefferman & D. H. Phong, Subelliptic eigenvalue problems, Conference on harmonic analysis in honor of Antoni Zygmund, Vol. I, II (Chicago, Ill., 1981), 590\u2013606, Wadsworth Math. Ser.,\nWadsworth, Belmont, CA, 1983.\n[28] C. L. Fefferman & A. S\u00e1nchez-Calle, Fundamental solutions for second order subelliptic operators,\nAnn. of Math. (2) 124 (1986), no. 2, 247\u2013272.\n[29] G. Folland, Subelliptic estimates and function spaces on nilpotent Lie groups, Ark. Math., 13 (1975),\n161-207.\n[30] A. Friedman, Partial differential equations of parabolic type, Dover, 2008.\n[31] M. Fukushima, Y. Oshima, M. Takeda, Dirichlet forms and Symmetric Markov processes, de Gruyter\nStudies in Mathematics, 19, (1994).\n[32] R. Green & Wu, Function theory on manifolds which possess a pole, Lecture Notes in Math., vol. 699,\nSpringer-Verlag, 1979.\n[33] A. Grigor'yan, Heat kernel and analysis on manifolds. AMS/IP Studies in Advanced Mathematics, 47. American Mathematical Society, Providence, RI; International Press, Boston, MA, 2009.\nxviii+482 pp.\n[34] L. H\u00f6rmander, Hypoelliptic second-order differential equations, Acta Math., 119 (1967), 147-171.\n[35] K. Hughen, The geometry of sub-Riemannian three-manifolds, 1995, Duke University preprint server.\n[36] N. Juillet, Geometric inequalities and generalized Ricci bounds in the Heisenberg group, Int. Math.\nRes. Not. IMRN no. 13 (2009), 2347-2373.\n[37] A Kaplan. Fundamental solutions for a class of hypoelliptic PDE generated by composition of\nquadratic forms. Trans. Amer. Math. Soc., 258(1):147153, 1980\n[38] M. Ledoux, The geometry of Markov diffusion generators. Probability theory. Ann. Fac. Sci. Toulouse\nMath., (6) 9 (2000), no. 2, 305\u2013366.\n[39] P. Li, Uniqueness of L1 solutions for the Laplace equation and the heat equation on Riemannian\nmanifolds, Journ. Diff. Geom., 20 (1984), 447-457.\n[40] P. Li & S. T. Yau, On the parabolic kernel of the Schr\u00f6dinger operator, Acta Math., 156 (1986),\n153-201.\n[41] X.D. Li, Liouville theorems for symmetric diffusion operators on complete Riemannian manifolds, J.\nMath. Pures Appl. 84, (2005), 1295-1361.\n[42] J. Lott & C. Villani, Ricci curvature for metric-measure spaces via optimal transport, Annals of Math.,\nVol. 169, No. 3., pp.903-991, 2009.\n[43] T. Melcher, Hypoelliptic heat kernel inequalities on Lie groups. Stochastic Process. Appl. 118 (2008),\nno. 3, 368388\n[44] R. Montgomery, A tour of sub-Riemannian geometries, their geodesics and applications, Math. Surveys and Monographs, vol. 91, Amer. Math. Soc., 2002.\n[45] Y. Ollivier, Ricci curvature of Markov chains on metric spaces J. Funct. Anal. 256 (2009), 3, 810-864.\n[46] G. Perelman, The entropy formula for the Ricci flow and its geometric applications,\nArXiv:math.DG/0211159.\n[47] R. S. Phillips & L. Sarason, Elliptic-parabolic equations of the second order, J. Math. Mech.\n17 (1967/1968), 891-917.\n[48] M. Reed & B. Simon, Methods of modern mathematical physics. Functional analysis. Second edition.\nAcademic Press, Inc. [Harcourt Brace Jovanovich, Publishers], New York, 1980.\n[49] M.-K. von Renesse & K-T. Sturm, Transport inequalities, gradient estimates, entropy, and Ricci curvature, Comm. Pure Appl. Math. 58 (2005), no. 7, 923\u2013940.\n\n\fCurvature-dimension inequalities, etc.\n\n77\n\n[50] L. P. Rothschild & E. M. Stein, Hypoelliptic differential operators and nilpotent groups, Acta Math.\n137 (1976), no. 3-4, 247\u2013320.\n[51] M. Rumin, Formes diff\u00e9rentielles sur les vari\u00e9t\u00e9s de contact. (French) [Differential forms on contact\nmanifolds] J. Differential Geom. 39 (1994), no. 2, 281-330.\n[52] R. Strichartz, Analysis of the Laplacian on the complete Riemannian manifold, Journal Func. Anal.,\n52, 1, 48-79, (1983).\n[53] R. Strichartz, Sub-Riemannian geometry, Journ. Diff. Geom., 24 (1986), 221-263.\n[54] R. Strichartz, Corrections to \"Sub-Riemannian geometry\" [Journ. Diff. Geom., 24 (1986), 221-263],\n30 (2) (1989), 595-596.\n[55] K. Th. Sturm, On the geometry of metric measure spaces I, Acta Math., 196, no.1, (2006), 65\u2013131.\n[56] K. Th. Sturm, On the geometry of metric measure spaces II, Acta Math., 196, no.1, (2006), 133\u2013177.\n[57] N. Varopoulos, L. Saloff-Coste & T. Coulhon, Analysis and Geometry on Groups, Cambridge University Press, 1992.\n[58] S.T. Yau, Harmonic functions on complete Riemannian manifolds, Comm. Pure Appl. Math. 28\n(1975), 201\u2013228.\n[59] S.T. Yau, On the heat kernel of a complete Riemannian manifold. J. Math. Pures Appl. (9) 57 (1978),\nno. 2, 191\u2013201.\n\n\f"}