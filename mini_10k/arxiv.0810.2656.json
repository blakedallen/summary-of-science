{"id": "http://arxiv.org/abs/0810.2656v1", "guidislink": true, "updated": "2008-10-15T10:38:33Z", "updated_parsed": [2008, 10, 15, 10, 38, 33, 2, 289, 0], "published": "2008-10-15T10:38:33Z", "published_parsed": [2008, 10, 15, 10, 38, 33, 2, 289, 0], "title": "An efficient algorithm for computing the Baker-Campbell-Hausdorff series\n  and some of its applications", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0810.2376%2C0810.5328%2C0810.0032%2C0810.2480%2C0810.0904%2C0810.3269%2C0810.2749%2C0810.1606%2C0810.0555%2C0810.4575%2C0810.1179%2C0810.2224%2C0810.0029%2C0810.0118%2C0810.2539%2C0810.5252%2C0810.1820%2C0810.0269%2C0810.4260%2C0810.4750%2C0810.5434%2C0810.2656%2C0810.1851%2C0810.3478%2C0810.5112%2C0810.4666%2C0810.2617%2C0810.0781%2C0810.2947%2C0810.1751%2C0810.2164%2C0810.1483%2C0810.2277%2C0810.2977%2C0810.0814%2C0810.4893%2C0810.1627%2C0810.4481%2C0810.2725%2C0810.2548%2C0810.3558%2C0810.3090%2C0810.5521%2C0810.1161%2C0810.1102%2C0810.2200%2C0810.0119%2C0810.0360%2C0810.2773%2C0810.4684%2C0810.5120%2C0810.3659%2C0810.4897%2C0810.4238%2C0810.4479%2C0810.4229%2C0810.3021%2C0810.1965%2C0810.5289%2C0810.0666%2C0810.3549%2C0810.2053%2C0810.0581%2C0810.1943%2C0810.5034%2C0810.4065%2C0810.1186%2C0810.1216%2C0810.0543%2C0810.5770%2C0810.1233%2C0810.4367%2C0810.2356%2C0810.3408%2C0810.0615%2C0810.4732%2C0810.3066%2C0810.2349%2C0810.3187%2C0810.2683%2C0810.1320%2C0810.3617%2C0810.1708%2C0810.4525%2C0810.2292%2C0810.2282%2C0810.1404%2C0810.2452%2C0810.3130%2C0810.1508%2C0810.5507%2C0810.1145%2C0810.4633%2C0810.4366%2C0810.5510%2C0810.2571%2C0810.2062%2C0810.0913%2C0810.5374%2C0810.1607%2C0810.3008&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "An efficient algorithm for computing the Baker-Campbell-Hausdorff series\n  and some of its applications"}, "summary": "We provide a new algorithm for generating the Baker--Campbell--Hausdorff\n(BCH) series $Z = \\log(\\e^X \\e^Y)$ in an arbitrary generalized Hall basis of\nthe free Lie algebra $\\mathcal{L}(X,Y)$ generated by $X$ and $Y$. It is based\non the close relationship of $\\mathcal{L}(X,Y)$ with a Lie algebraic structure\nof labeled rooted trees. With this algorithm, the computation of the BCH series\nup to degree 20 (111013 independent elements in $\\mathcal{L}(X,Y)$) takes less\nthan 15 minutes on a personal computer and requires 1.5 GBytes of memory. We\nalso address the issue of the convergence of the series, providing an optimal\nconvergence domain when $X$ and $Y$ are real or complex matrices.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0810.2376%2C0810.5328%2C0810.0032%2C0810.2480%2C0810.0904%2C0810.3269%2C0810.2749%2C0810.1606%2C0810.0555%2C0810.4575%2C0810.1179%2C0810.2224%2C0810.0029%2C0810.0118%2C0810.2539%2C0810.5252%2C0810.1820%2C0810.0269%2C0810.4260%2C0810.4750%2C0810.5434%2C0810.2656%2C0810.1851%2C0810.3478%2C0810.5112%2C0810.4666%2C0810.2617%2C0810.0781%2C0810.2947%2C0810.1751%2C0810.2164%2C0810.1483%2C0810.2277%2C0810.2977%2C0810.0814%2C0810.4893%2C0810.1627%2C0810.4481%2C0810.2725%2C0810.2548%2C0810.3558%2C0810.3090%2C0810.5521%2C0810.1161%2C0810.1102%2C0810.2200%2C0810.0119%2C0810.0360%2C0810.2773%2C0810.4684%2C0810.5120%2C0810.3659%2C0810.4897%2C0810.4238%2C0810.4479%2C0810.4229%2C0810.3021%2C0810.1965%2C0810.5289%2C0810.0666%2C0810.3549%2C0810.2053%2C0810.0581%2C0810.1943%2C0810.5034%2C0810.4065%2C0810.1186%2C0810.1216%2C0810.0543%2C0810.5770%2C0810.1233%2C0810.4367%2C0810.2356%2C0810.3408%2C0810.0615%2C0810.4732%2C0810.3066%2C0810.2349%2C0810.3187%2C0810.2683%2C0810.1320%2C0810.3617%2C0810.1708%2C0810.4525%2C0810.2292%2C0810.2282%2C0810.1404%2C0810.2452%2C0810.3130%2C0810.1508%2C0810.5507%2C0810.1145%2C0810.4633%2C0810.4366%2C0810.5510%2C0810.2571%2C0810.2062%2C0810.0913%2C0810.5374%2C0810.1607%2C0810.3008&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We provide a new algorithm for generating the Baker--Campbell--Hausdorff\n(BCH) series $Z = \\log(\\e^X \\e^Y)$ in an arbitrary generalized Hall basis of\nthe free Lie algebra $\\mathcal{L}(X,Y)$ generated by $X$ and $Y$. It is based\non the close relationship of $\\mathcal{L}(X,Y)$ with a Lie algebraic structure\nof labeled rooted trees. With this algorithm, the computation of the BCH series\nup to degree 20 (111013 independent elements in $\\mathcal{L}(X,Y)$) takes less\nthan 15 minutes on a personal computer and requires 1.5 GBytes of memory. We\nalso address the issue of the convergence of the series, providing an optimal\nconvergence domain when $X$ and $Y$ are real or complex matrices."}, "authors": ["Fernando Casas", "Ander Murua"], "author_detail": {"name": "Ander Murua"}, "author": "Ander Murua", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1063/1.3078418", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0810.2656v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0810.2656v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "30 pages", "arxiv_primary_category": {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0810.2656v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0810.2656v1", "journal_reference": "Journal of Mathematical Physics 50 (2009), 033513", "doi": "10.1063/1.3078418", "fulltext": "arXiv:0810.2656v1 [math-ph] 15 Oct 2008\n\nAn efficient algorithm for computing the\nBaker\u2013Campbell\u2013Hausdorff series and some of its\napplications\nFernando Casas1\u2217\n\nAnder Murua2\u2020\n\nAbstract\nWe provide a new algorithm for generating the Baker\u2013Campbell\u2013Hausdorff (BCH) series Z = log(eX eY ) in an arbitrary generalized Hall basis\nof the free Lie algebra L(X, Y ) generated by X and Y . It is based on\nthe close relationship of L(X, Y ) with a Lie algebraic structure of labeled\nrooted trees. With this algorithm, the computation of the BCH series up\nto degree 20 (111013 independent elements in L(X, Y )) takes less than\n15 minutes on a personal computer and requires 1.5 GBytes of memory.\nWe also address the issue of the convergence of the series, providing an\noptimal convergence domain when X and Y are real or complex matrices.\n\n1\n\n1\n\nDepartament de Matem\u00e0tiques, Universitat Jaume I, E-12071 Castell\u00f3n,\nSpain.\n\n2\n\nKonputazio Zientziak eta A.A. saila, Informatika Fakultatea, EHU/UPV,\nDonostia/San Sebasti\u00e1n, Spain.\n\nIntroduction\n\nThe Baker\u2013Campbell\u2013Hausdorff formula deals with the expansion of Z in eX eY =\neZ in terms of nested commutators of X and Y when they are assumed to be\nnon-commuting operators. If we introduce the formal series for the exponential\nfunction\n\u221e\nX\n1\nX Y\ne e =\nXp Y q\n(1.1)\np! q!\np,q=0\n\nand substitute this series in the formal series defining the logarithm function\nlog Z =\n\n\u221e\nX\n(\u22121)k\u22121\n\nk\n\nk=1\n\n(Z \u2212 1)k\n\none obtains\n\u221e\nX\n(\u22121)k\u22121 X X p1 Y q1 . . . X pk Y qk\n,\nlog(e e ) =\nk\np1 ! q 1 ! . . . pk ! q k !\nX Y\n\nk=1\n\n\u2217\n\u2020\n\nCorresponding author. Email: Fernando.Casas@uji.es\nEmail: Ander.Murua@ehu.es\n\n1\n\n\fwhere the inner summation extends over all non-negative integers p1 , q1 , . . . ,\npk , qk for which pi + qi > 0 (i = 1, 2, . . . , k). Gathering together the terms for\nwhich p1 + q1 + p2 + q2 + * * * + pk + qk = m we can write\nZ = log(eX eY ) =\n\n\u221e\nX\n\nPm (X, Y ),\n\n(1.2)\n\nm=1\n\nwhere Pm (X, Y ) is a homogeneous polynomial of degree m in the non-commuting\nvariables X and Y . Campbell [8], Baker [2] and Hausdorff [17] addressed the\nquestion whether Z can be represented as a series of nested commutators of X\nand Y , without producing a general formula. We recall here that the commutator [X, Y ] is defined as XY \u2212 Y X. It was Dynkin [12] who finally derived an\nexplicit formula for Z as\n\u221e X\nX\n[X p1 Y q1 . . . X pk Y qk ]\n(\u22121)k\u22121\n.\nZ=\nPk\nk\n( i=1 (pi + qi )) p1 ! q1 ! . . . pk ! qk !\np ,q\nk=1\n\ni\n\n(1.3)\n\ni\n\nHere the inner summation is taken over all non-negative integers p1 , q1 , . . ., pk ,\nqk such that p1 + q1 > 0, . . . , pk + qk > 0 and [X p1 Y q1 . . . X pk Y qk ] denotes the\nright nested commutator based on the word X p1 Y q1 . . . X pk Y qk . Expression\n(1.3) is known, for obvious reasons, as the Baker\u2013Campbell\u2013Hausdorff series in\nthe Dynkin form. By rearranging terms, it is clear that Z can be written as\nZ = log(eX eY ) = X + Y +\n\n\u221e\nX\n\nZm ,\n\n(1.4)\n\nm=2\n\nwith Zm (X, Y ) a homogeneous Lie polynomial in X and Y of degree m, i.e., it is\na Q-linear combination of commutators of the form [V1 , [V2 , . . . , [Vm\u22121 , Vm ] . . .]]\nwith Vi \u2208 {X, Y } for 1 \u2264 i \u2264 m. The first terms read explicitly\nZ2 =\nZ3 =\nZ4 =\n\n1\n[X, Y ]\n2\n1\n1\n[X, [X, Y ]] \u2212 [Y, [X, Y ]]\n12\n12\n1\n[X, [Y, [Y, X]]]\n24\n\nThe expression eX eY = eZ is then called the Baker\u2013Campbell\u2013Hausdorff formula (BCH for short), although other different labels (e.g., Campbell\u2013Baker\u2013\nHausdorff, Baker\u2013Hausdorff, Campbell\u2013Hausdorff) are commonly attached to\nit in the literature. The formula (1.3) is certainly awkward to use due to the\ncomplexity of the sums involved. Notice, in particular, that different choices\nof pi , qi , k in (1.3) may lead to terms in the same commutator. Thus, for\ninstance, [X 3 Y 1 ] = [X 1 Y 0 X 2 Y 1 ] = [X, [X, [X, Y ]]]. An additional difficulty\narises from the fact that not all the commutators are independent, due to the\nJacobi identity [47]:\n[X1 , [X2 , X3 ]] + [X2 , [X3 , X1 ]] + [X3 , [X1 , X2 ]] = 0.\n2\n\n\fThe BCH formula plays a fundamental role in many fields of mathematics\n(theory of linear differential equations [26], Lie groups [14], numerical analysis\n[16]), theoretical physics (perturbation theory [10], Quantum Mechanics [49],\nStatistical Mechanics [24, 50], quantum computing [40]) and control theory\n(analysis and design of nonlinear control laws, nonlinear filters, stabilization of\nrigid bodies [46]). In particular, in the theory of Lie groups, with this formula\none can explicitly write the operation of multiplication in a Lie group in canonical coordinates in terms of the Lie bracket operation in its tangent algebra and\nalso prove the existence of a local Lie group with a given Lie algebra [14].\nAlso in the numerical treatment of differential equations on manifolds [19,\n16], the BCH formula is quite useful. If M is a smooth manifold and X(M)\ndenotes the linear space of smooth vector fields on M, then a Lie algebra\nstructure is established in X(M) by using the Lie bracket [X, Y ] of fields X and\nY \u2208 X(M) [47]. The flow of a vector field X \u2208 X(M) is a mapping exp(X)\ndefined through the solution of the differential equation\ndu\n= X(u),\ndt\n\nu(0) = q \u2208 M\n\n(1.5)\n\nas exp(tX)(q) = u(t). Many numerical methods used to approximately solving equation (1.5) are based on compositions of maps that are flows of vector\nfields [16]. To be more specific, suppose the vector field X can be split as\nX = A + B and that the flows corresponding to A(u) and B(u) can be explicitly obtained. Then one may consider an approximation of the form \u03a8h \u2261\nexp(ha1 A) exp(hb1 B) * * * exp(hak A) exp(hbk B) for the exact flow exp(h(A+B))\nof (1.5) after a time step h. The idea now is to obtain the conditions to be satisfied by the coefficients ai , bi so that \u03a8h (q) = u(h) + O(hp+1 ) as h \u2192 0, and\nthis can be done by applying the BCH formula in sequence to the expression\nof \u03a8 up to the degree required by the order of approximation p [27]. This\ntask can be carried out quite easily provided one has explicit expressions of Zm\nimplemented in a symbolic algebra package [23, 46].\nIn addition to the Dynkin form (1.3), there are other standard procedures\nto construct explicitly the BCH series. Recall that the free Lie algebra L(X, Y )\ngenerated by the symbols X and Y can be considered as a subspace (the subspace of Lie polynomials) of the vector space spanned by the words w in the\nsymbols X and Y , i.e., w = a1 a2 . . . am , each ai being X or Y . Thus, the BCH\nseries admits the explicit associative presentation\nZ =X +Y +\n\n\u221e\nX\n\nX\n\ngw w,\n\n(1.6)\n\nm=2 w,|w|=m\n\nin which gw is a rational coefficient and the inner sum is taken over all words\nw with length |w| = m. Here the length of w is the number of letters it\ncontains. The coefficients can be computed with a procedure based on a family\nof recursively computable polynomials [13].\nAlthough the terms in equation (1.6) are expressed as linear combinations\nof individual words (which are not Lie polynomials), by virtue of the Dynkin\u2013\n\n3\n\n\fSpecht\u2013Wever theorem [21], Z can be written as\nZ =X +Y +\n\n\u221e\nX\n1\nm\n\nm=2\n\nX\n\ngw [w],\n\n(1.7)\n\nw,|w|=m\n\nthat is, the individual terms are the same as in the associative series (1.6) except\nthat the word w = a1 a2 . . . am is replaced with the right nested commutator\n[w] = [a1 , [a2 , . . . [am\u22121 , am ] . . .]] and the coefficient gw is divided by the word\nlength m [42]. This gives explicit expressions of the terms Zm in the BCH\nseries (1.4) as a linear combination of nested commutators of homogeneous\ndegree, that is, as a linear combination of elements of the homogeneous subspace\nL(X, Y )m of degre m of the free Lie algebra L(X, Y ). However, it should be\nstressed that the set of nested commutators [w] for words w of length m is not\na basis of the homogeneous subspace L(X, Y )m .\nByP\nintroducing a parameter \u03c4 and differentiating with respect to \u03c4 the power\nseries m\u22651 \u03c4 m Zm = log(exp(\u03c4 X) exp(\u03c4 Y )), the following recursion formula is\nderived in [47]:\nZ1 = X + Y\n\n(1.8)\n\n1\n[X \u2212 Y, Zm\u22121 ] +\n2\n\nmZm =\n\n[(m\u22121)/2]\n\nX\np=1\n\n\u0011\nB2p \u0010 2p\nadZ (X + Y ) ,\n(2p)!\nm\n\nm \u2265 1.\n\nk\u22121\n(X + Y )], the Bj stand for the\nadkZ (X + Y ) = [Z, adZ\n\u0010\n\u0011\nBernoulli numbers [1], and ad2p\ndenotes the projection of ad2p\nZ (X + Y )\nZ (X +\n\nHere Z =\n\nP\n\nm\u22651 Zm ,\n\nm\n\nY ) onto the homogeneous subspace L(X, Y )m , which can be written in terms\nof Z1 , Z2 , Z3 , . . . as\n\u0010\n\u0011\nX\n[Zk1 , [* * * [Zk2p , X + Y ] * * * ]].\nad2p\n(X\n+\nY\n)\n=\nZ\nm\n\nk1 +***+k2p =m\u22121\nk1 \u22651,...,k2p \u22651\n\nExplicit formulas (1.3), (1.7) as well as recursion (1.8) can be used in principle to construct the BCH series up to arbitrary degree in terms of commutators.\nAs a matter of fact, several systematic computations of the series have been carried out along the years, starting with the work of Richtmyer and Greenspan in\n1965 [37], where results up to degree eight are reported. Later on, Newman and\nThompson obtained the coefficients gw in (1.7) up to words of length 20 [32],\nBose [6] constructed an algorithm to compute directly the coefficient of a given\ncommutator in the Dynkin presentation (1.3) and Oteo [33] and Kolsrud [22]\npresented a simplified expression of (1.3) in terms of right nested commutators\nup to degree eight and nine, respectively. More recently, Reinsch [35] has proposed a matrix operation procedure for calculating the polynomials Pm (X, Y ) in\n(1.2) which can be easily implemented in any symbolic algebra package. Again,\nthe Dynkin\u2013Specht\u2013Wever has to be used to write the resulting expressions in\nterms of commutators.\nAs mentioned before, all of these procedures exhibit a key limitation, however: the iterated commutators are not all linearly independent due to the\n4\n\n\fJacobi identity (and other identities involving nested commutators of higher\ndegree which are originated by it [33]). In other words, they do not provide\nexpressions directly in terms of a basis of the free Lie algebra L(X, Y ). This\nis required, for instance, in applications of the BCH formula in the numerical\nintegration of ordinary differential equations, or when one wants to study specific features of the series, such as the distribution of the coefficients and other\ncombinatorial properties [32].\nOf course, it is always possible to express the resulting formulas in terms\nof a basis of L(X, Y ) but this rewriting process is very time consuming and\nrequires a good deal of memory resources. In practice, going beyond degree\nm = 11 constitutes a difficult task indeed [28, 23, 46], since the number of\nterms involved in the series grows exponentially.\nOur goal is then to express the BCH series as\nX\nZ = log(exp(X) exp(Y )) =\nzi Ei ,\n(1.9)\ni\u22651\n\nwhere zi \u2208 Q (i \u2265 1) and {Ei : i = 1, 2, 3, . . .} is a basis of L(X, Y ) whose\nelements are of the form\nE1 = X,\n\nE2 = Y,\n\nEi = [Ei\u2032 , Ei\u2032\u2032 ]\n\nand\n\ni \u2265 3,\n\n(1.10)\n\nfor appropriate values of the integers i\u2032 , i\u2032\u2032 < i (for i = 3, 4, . . .). Clearly, each\nEi in (1.10) is a homogeneous Lie polynomial of degree |i|, where\n|1| = |2| = 1,\n\nand\n\n|i| = |i\u2032 | + |i\u2032\u2032 | for\n\ni \u2265 3.\n\n(1.11)\n\nWe will focus on a general class of bases of the free Lie algebra L(X, Y ), referred\nto in the current literature as generalized Hall bases and also as Hall\u2013Viennot\nbases [36, 48]. These include the Lyndon basis [25, 48], and different variants\nof the classical Hall basis (see [36] for references). Specifically, in this paper\nwe present a new procedure to write the BCH series (1.9) for an arbitrary\nHall\u2013Viennot basis. Such an algorithm is based on results obtained in [30], in\nparticular those relating a certain Lie algebra structure g on rooted trees with\nthe description of a free Lie algebra in terms of a Hall basis. This Lie algebra g\non rooted trees was first considered in [11], whereas a closely related Lie algebra\non labeled rooted trees was treated in [15] (see [18] for the relation of these two\nLie algebras and for further references about related algebraic structures on\nrooted trees).\nWe have implemented the algorithm in Mathematica (it can also be programmed in Fortran or C for more efficiency). The resulting procedure gives\nthe BCH series up to a prescribed degree directly in terms of a Hall\u2013Viennot\nbasis of L(X, Y ). As an illustration, obtaining the series (in the classical basis of P. Hall) up to degree m = 20 with a personal computer (2.4 GHz Intel\nCore 2 Duo processor with 2 GBytes of RAM) requires less than 15 minutes\nof CPU time and 1.5 GBytes of memory. The resulting expression has 109697\nnon-vanishing coefficients out of 111013 elements Ei of degree |i| \u2264 20 in the\nHall basis. As far as we know, there are no results up to such a high degree\n5\n\n\freported in the literature. For comparison with other procedures, the authors\nof [46] report 25 hours of CPU time and 17.5 MBytes with a Pentium III PC\nto achieve degree 10. By contrast, our algorithm is able to achieve m = 10 in\n0.058 seconds and only needs 5.4 MBytes of computer memory.\nIn Table 3 in the Appendix, we give the values of i\u2032 and i\u2032\u2032 for the elements\nEi of degree |i| \u2264 9 in the Hall basis and their coefficients zi in the BCH formula\n(1.9). The elements of the basis are ordered in such a way that i < j if |i| < |j|,\nand the horizontal lines in the table separate elements of different homogeneous\ndegree. Extension of Table 3 up to terms of degree 20 is available at the website\nwww.gicas.uji.es/research/bch.html for both the basis of P. Hall and the\nLyndon basis. As an example, the last element of degree 20 in the Hall basis is\nE111013 = [[[[[Y, X], Y ], [Y, X]], [[[Y, X], X], [Y, X]]],\n[[[[Y, X], Y ], [Y, X]], [[[[Y, X], Y ], Y ], Y ]]],\nand the corresponding coefficient in (1.9) reads\n19234697\n.\nz111013 = \u2212\n140792940288\nAnother central issue addressed in this paper concerns the convergence properties of the BCH series. Suppose we introduce a sub-multiplicative norm k * k\nsuch that\nk[X, Y ]k \u2264 \u03bckXk kY k\n(1.12)\nfor some \u03bc > 0. Then it is not difficult to show that the series (1.3) is absolutely\nconvergent as long as kXk+kY k < (log 2)/\u03bc [7, 41]. As a matter of fact, several\nimproved bounds have been obtained for the different presentations. Thus, in\nparticular, the Lie presentation (1.7) converges absolutely if kXk \u2264 1/\u03bc and\nkY k \u2264 1/\u03bc in a normed Lie algebra g with a norm satisfying\n(1.12) [31, 45],\nP\nwhereas in [3] it has been shown that the series Z = m\u22651 Zm is absolutely\nconvergent for all X, Y such that\nZ 2\u03c0\n1\ndt\n(1.13)\n\u03bckXk <\n1\nt\n\u03bckY k 2 + 2 (1 \u2212 cot( 2 t))\nand the corresponding expression obtained by interchanging in (1.13) X by\nY . Moreover, the series diverges in general if kXk + kY k \u2265 \u03c0 when \u03bc = 2\n[28]. Here we provide a generalization of this feature based on the well known\nMagnus expansion for linear differential equations [26] and also we give a more\nprecise characterization of the convergence domain of the series when X and Y\nare (real or complex) matrices.\n\n2\n2.1\n\nAn algorithm for computing the BCH series based\non rooted trees\nSummary of the procedure\n\nOur starting point is the vector space g of maps \u03b1 : T \u2192 R, where T denotes\nthe set of rooted trees with black and white vertices\no\nn\nT =\n, , , , , ,\n,\n,\n,\n,...,\n,\n,\n,\n,... .\n6\n\n\fIn the combinatorial literature, T is typically referred to as the set of labeled\nrooted trees with two labels, 'black' and 'white'. Hereafter, we refer to the\nelements of T as bicoloured rooted trees.\nThe vector space g is endowed with a Lie algebra structure by defining the\nLie bracket [\u03b1, \u03b2] \u2208 g of two arbitrary maps \u03b1, \u03b2 \u2208 g as follows. For each u \u2208 T ,\n|u|\u22121\n\n[\u03b1, \u03b2](u) =\n\nX\nj=1\n\n\u0001\n\u03b1(u(j) )\u03b2(u(j) ) \u2212 \u03b1(u(j) )\u03b2(u(j) ) ,\n\n(2.1)\n\nwhere |u| denotes the number vertices of u, and each of the pairs of trees\n(u(j) , u(j) ) \u2208 T \u00d7 T , j = 1, . . . , |u| \u2212 1, is obtained from u by removing one of\nthe |u| \u2212 1 edges of the rooted tree u, the root of u(j) being the original root of\nu. For instance,\n[\u03b1, \u03b2]( ) = \u03b1( )\u03b2( ) \u2212 \u03b1( )\u03b2( ),\n[\u03b1, \u03b2](\n[\u03b1, \u03b2](\n\n\u0001\n) = 2 \u03b1( )\u03b2( ) \u2212 \u03b1( )\u03b2( ) ,\n\n[\u03b1, \u03b2]( ) = 0,\n(2.2)\n\n) = \u03b1( )\u03b2( ) + \u03b1( )\u03b2( ) \u2212 \u03b1( )\u03b2( ) \u2212 \u03b1( )\u03b2( ).\n\nAn important feature of the Lie algebra g is that the Lie subalgebra of g\ngenerated by the maps X, Y \u2208 g defined as\n\u001a\n\u001a\n1 if u =\n1 if u =\n, Y (u) =\n.\n(2.3)\nX(u) =\n0 if u \u2208 T \\{ }\n0 if u \u2208 T \\{ }\nis a free Lie algebra over the set {X, Y } [30]. In what follows, we denote as\nL(X, Y ) the Lie subalgebra of g generated by the maps X and Y .\nIt has also been shown in [30] that for each particular Hall\u2013Viennot basis\n{Ei : i = 1, 2, 3, . . .}, (whose elements are given by (1.10) for appropriate\nvalues of i\u2032 , i\u2032\u2032 < i, i = 3, 4, . . ., and X and Y given by (2.3)) one can associate a\nbicoloured rooted tree ui to each element Ei such that, for any map \u03b1 \u2208 L(X, Y ),\n\u03b1 =\n\nX \u03b1(ui )\ni\u22651\n\n\u03c3(ui )\n\nEi ,\n\n(2.4)\n\nwhere for each i, \u03c3(ui ) is certain positive integer associated to the bicoloured\nrooted tree ui (the number of symmetries of ui , that we call symmetry number\nof ui ). For instance, the bicoloured rooted trees ui and their symmetry numbers\n\u03c3(ui ) associated to the elements Ei (of degree |i| \u2264 5) of the Hall basis used in\nthis work are displayed in Table 1.\nAs in the introduction, we denote by L(X, Y )n (n \u2265 1) the homogeneous\nsubspace of L(X, Y ) of degree n (whence admiting {Ei : |i| = n} as a basis). It\ncan be seen [30] that, if \u03b1 \u2208 L(X, Y ), then its projection \u03b1n to the homogeneous\nsubspace L(X, Y )n is given by\n\u001a\n\u03b1(u)\nif\n|u| = n\n\u03b1n (u) =\n(2.5)\n0\notherwise\nfor each u \u2208 T .\n7\n\n\fWe also use the notation L(X, Y ) for the Lie algebra of Lie series, that is,\nseries of the form\n\u03b1 = \u03b11 + \u03b12 + \u03b13 + * * * ,\n\nwhere \u03b1n \u2208 L(X, Y )n .\n\nNotice that in this setting, a Lie series \u03b1 \u2208 L(X, Y ) is a map \u03b1 : T \u2192 R satisfying that, for each n \u2265 1, the map \u03b1n given by (2.5) belongs to L(X, Y )n . A map\n\u03b1 \u2208 g is then a Lie series if and only if (2.4) holds (see [30] for an alternative\ncharacterization of maps \u03b1 : T \u2192 R that actually belong to L(X, Y )).\nIn particular, the BCH series Z = Z1 + Z2 + Z3 + * * * given by (1.8) (for X\nand Y defined as in (2.3)) is a Lie series. From (1.8), it follows that Z( ) =\nZ( ) = 1, and for n = 2, 3, 4, . . .\nnZ(u) =\n\n1\n[X \u2212 Y, Z](u) +\n2\n\n[(n\u22121)/2]\n\nX\np=1\n\n\u0011\nB2p \u0010 2p\nadZ (X + Y ) (u)\n(2p)!\n\n(2.6)\n\nfor each u \u2208 T with n = |u|. Recall that, for arbitrary \u03b1, \u03b2 \u2208 g and u \u2208 T , the\nvalue [\u03b1, \u03b2](u) is defined in terms of bicoloured rooted trees u(j) , u(j) with less\nvertices than u, so that (2.6) effectively allows us to compute the values Z(u)\nfor all bicoloured rooted trees with arbitrarily high number |u| of vertices. In\nthis way, the characterization (2.4) of maps \u03b1 \u2208 g that are Lie series directly\ngives a way to write Z \u2208 L(X, Y ) in the form (1.9) with\nzi =\n\nZ(ui )\n\u03c3(ui )\n\nfor\n\ni \u2265 1.\n\n(2.7)\n\nFor instance, we have according to Table 1 that in the Hall basis,\nX\nX Z(ui )\nEi\nZ =\nzi Ei =\n\u03c3(ui )\ni\u22651\n\ni\u22651\n\n= Z( )X + Z( )Y + Z( )[Y, X]\nZ(\n)\n+\n[[Y, X], X] + Z(\n)[[Y, X], Y ] + * * * ,\n2\nwhere the first five coefficients Z(ui ) can be obtained by applying (2.6) with\n(2.2):\n[X \u2212 Y, Z]( ) = \u2212Z( ) \u2212 Z( ) = \u22122,\n1\n2Z( ) =\n[X \u2212 Y, Z]( ) = \u22121,\n2\n[X \u2212 Y, Z]( ) = 0, 2Z( ) = 0,\n[X \u2212 Y, Z](\n[X \u2212 Y, Z](\n[Z, [Z, X + Y ]](\n[Z, [Z, X + Y ]](\n3Z(\n3Z(\n\n) = \u22122Z( ) = 1,\n1\n) = Z( ) \u2212 Z( ) = \u2212 ,\n2\n) = \u22122Z( )(Z( ) \u2212 Z( )) = 0,\n) = \u2212Z( )(Z( ) \u2212 Z( )) = 0,\n1\n,\n) =\n2\n1\n) = \u2212 .\n4\n8\n\n(2.8)\n\n\fIn summary, the idea of the formalism is to construct algorithmically a sequence\nof labeled rooted trees in a one-to-one correspondence with a Hall basis, verifying in addition (2.4). In this way it is quite straightforward to build and\ncharacterize Lie series, and in particular, the BCH series.\n\n2.2\n\nDetailed treatment\n\nIn this subsection we provide a detailed treatment of the main steps involved in\nthe procedure previously sketched, first by analyzing the representation (2.4)\nof Lie series for the classical Hall basis and then by considering Hall\u2013Viennot\nbases.\nWe start by providing an algorithm that constructs the table of values (i\u2032 , i\u2032\u2032 )\n(for i \u2265 3) in (1.10) (together with |i| for i \u2265 1) that determines a classical Hall\nbasis. The algorithm starts by setting\n1\u2032 = 1,\n\n1\u2032\u2032 = 0,\n\n2\u2032 = 2,\n\n2\u2032\u2032 = 0,\n\n|1| = 1,\n\n|2| = 1,\n\nand initializing the counter i as i = 3. Then, the values i\u2032 , i\u2032\u2032 , |i| for subsequent\nvalues of i are set as follows (i++ indicates that the value of the counter i is\nincremented by one):\nAlgorithm 1\nfor n = 2, 3, . . .\nj = 1, . . . , i \u2212 1\nk = j + 1, . . . , i \u2212 1\nIf |j| + |k| = n and j \u2265 k\u2032\u2032\ni\u2032\u2032 = j, i\u2032 = k, |i| = n,\ni++ .\n\nthen\n\nThe values of i\u2032 , i\u2032\u2032 , |i| thus determined satisfy that i\u2032 > i\u2032\u2032 \u2265 (i\u2032 )\u2032\u2032 for i \u2265 3. In\naddition, j < i if |j| < |i|, which implies that i\u2032 , i\u2032\u2032 < i for all i \u2265 3. The values\nfor |i|, i\u2032 , and i\u2032\u2032 and the element Ei of the basis for the values of the index i of\ndegree |i| \u2264 5 are displayed in Table 1.\nOn the other hand, it is possible to design a simple recursive procedure to\ndefine the bicoloured rooted trees ui appearing in (2.4) in terms of the values\nof i\u2032 and i\u2032\u2032 by using the following binary operation. Given u, v \u2208 T , the new\nrooted tree u \u25e6 v \u2208 T is a rooted tree with |u| + |v| vertices obtained by grafting\nthe rooted tree v to the root of u (that is to say, u \u25e6 v is a new bicoloured rooted\ntree with the coloured vertices of u and v, one edge that makes the root of v a\nchild of the root of u added to the edges of u and v). For instance,\n\u25e6\n\n=\n\n,\n\nand also\n\n\u25e6\n\n=\n\n.\n\nand ui = ui\u2032 \u25e6 ui\u2032\u2032\n\nfor i \u2265 3.\n\nWe now define\nu1 =\n\n,\n\nu2 =\n\n,\n\n(2.9)\n\nFinally, the symmetry numbers \u03c3i = \u03c3(ui ) can also be determined recursively:\n\u03c31 = \u03c32 = 1,\n\nand\n\n\u03c3i = \u03bai \u03c3i\u2032 \u03c3i\u2032\u2032 ,\n9\n\nfor\n\ni \u2265 3,\n\n(2.10)\n\n\fi\u2032\n\ni\n\n|i|\n\n1\n2\n\n1\n1\n\n3\n\n2\n\n2\n\n4\n5\n\n3\n3\n\n6\n7\n8\n\ni\u2032\u2032\n\nEi\n\nui\n\n\u03c3(ui )\n\nzi =\n\nZ(ui )\n\u03c3(ui )\n\nX\nY\n\n1\n1\n\n1\n1\n\n1\n\n[Y, X]\n\n1\n\n\u2212 12\n\n3\n3\n\n1\n2\n\n[[Y, X], X]\n[[Y, X], Y ]\n\n2\n1\n\n1\n12\n1\n\u2212 12\n\n4\n4\n4\n\n4\n4\n5\n\n1\n2\n2\n\n[[[Y, X], X], X]\n[[[Y, X], X], Y ]\n[[[Y, X], Y ], Y ]\n\n6\n2\n2\n\n0\n\n9\n10\n11\n12\n\n5\n5\n5\n5\n\n6\n6\n7\n8\n\n1\n2\n2\n2\n\n[[[[Y, X], X], X], X]\n[[[[Y, X], X], X], Y ]\n[[[[Y, X], X], Y ], Y ]\n[[[[Y, X], Y ], Y ], Y ]\n\n24\n6\n4\n6\n\n13\n\n5\n\n4\n\n3\n\n[[[Y, X], X], [X, Y ]]\n\n2\n\n14\n\n5\n\n5\n\n3\n\n[[[Y, X], Y ], [X, Y ]]\n\n1\n\n1\n24\n\n0\n1\n\u2212 720\n1\n\u2212 180\n1\n180\n1\n720\n1\n\u2212 120\n1\n\u2212 360\n\nTable 1: First elements Ei of the basis of P. Hall, their corresponding bicoloured\nrooted trees ui , the values |i|, i\u2032\u2032 , i\u2032 , \u03c3(ui ), and the coefficients zi = Z(ui )/\u03c3(ui )\nin the BCH series (1.9)\nwhere \u03bai = 1 if (i\u2032 )\u2032\u2032 6= i\u2032\u2032 , and \u03bai = \u03bai\u2032 + 1 if (i\u2032 )\u2032\u2032 = i\u2032\u2032 .\nThe bicoloured rooted trees ui , their symmetry numbers \u03c3(ui ), and the\ncoefficients zi = Z(ui )/\u03c3(ui ) in the BCH series (1.9) are displayed in Table 1\nfor the first values of the index i, whereas in Table 3 given in the Appendix, the\nterms of the BCH series (1.9) up to terms of degree 9 are given in compact form\nfor the classical Hall basis by displaying the values of i\u2032 , i\u2032\u2032 , and zi = Z(ui )/\u03c3(ui )\nfor each index i.\nThis procedure can be extended indeed to Hall\u2013Viennot bases. A set {Ei :\ni = 1, 2, 3, . . .} \u2282 L(X, Y ) recursively defined as (1.10) with some positive\nintegers i\u2032 , i\u2032\u2032 < i (i = 3, 4, . . .) is a Hall\u2013Viennot basis if there exists a total\norder relation \u227b in the set of indices {1, 2, 3, . . .} such that i \u227b i\u2032\u2032 for all i \u2265 3,\nand the map\nd : {3, 4, . . .} \u2212\u2192 {(j, k) \u2208 Z+ \u00d7 Z+ : j \u227b k \u0017 j \u2032\u2032 },\n\u2032\n\n\u2032\u2032\n\nd(i) = (i , i )\n\n(2.11)\n(2.12)\n\n(with the convention 1\u2032\u2032 = 2\u2032\u2032 = 0) is bijective.\nIn [48, 36], Hall\u2013Viennot bases are indexed by a subset of words (a Hall set\nof words) on the alphabet {x, y}. Such Hall set of words {wi : i \u2265 1} can be\nobtained by defining recursively wi as the concatenation wi\u2032 wi\u2032\u2032 of the words\nwi\u2032 and wi\u2032\u2032 , with w1 = x and w2 = y. For instance, the Hall set of words wi\nassociated to the indices i = 1, 2, . . . , 14 in Table 1 are x, y, yx, yxx, yxy, yxxx,\nyxxy, yxyy, yxxxx, yxxxy, yxxyy, yxyyy, yxxyx, yxyyx.\n10\n\n\fFor the classical Hall basis we have considered before, the map (2.11) has\nbeen constructed in such a way that the total order relation \u227b is the natural\norder relation in Z+ , i.e., > (notice that in [7] the total order is chosen as <).\nThis is not possible, however, for the Lyndon basis. The Lyndon basis can\nbe constructed as a Hall\u2013Viennot basis by considering the order relation \u227b as\nfollows: i \u227b j if, in lexicographical order (i.e., the order used when ordering\nwords in the dictionary), the Hall word wi associated to i comes before than the\nHall word wj associated to j. The Hall set of words {wi : i \u2265 1} corresponding\nto the Lyndon basis is the set of Lyndon words, which can be defined as the set\nof words w on the alphabet {x, y} satisfying that, for arbitrary decompositions\nof w as the concatenation w = uv of two non-empty words u and v, the word\nw is smaller than v in lexicographical order [48, 25].\nNow, the representation (2.4) of a map \u03b1 \u2208 L(X, Y ) (and in particular, the\nBCH series (1.9) with (2.7)) for any Hall\u2013Viennot basis can be stated as follows.\nTheorem 2.1 Given a total order relation \u227b in Z+ and a bijection (2.11)\nsatisfying that i \u227b i\u2032\u2032 for all i \u2265 3, then any map \u03b1 \u2208 L(X, Y ) admits the\nrepresentation (2.4) for the Hall basis (1.10) and the bicoloured rooted trees ui\nand their symmetry numbers \u03c3i = \u03c3(ui ) recursively defined as (2.9) and (2.10).\nTheorem 2.1 can be proven as a corollary of Theorem 3 and Remark 17 in\n[30]. Actually, in [30] it is shown that (2.4) holds for a different set T\u0302 =\n{u1 , u2 , u3 , . . .} of bicoloured rooted trees associated to a Hall basis, for which\n\u03c3(ui ) = 1 for all i. However, the set of Hall rooted trees we consider here (which\nis the set T\u0302 \u2217 considered in Remark 17 in [30]) has some advantages from the\ncomputational point of view.\nIn Table 2, we display the elements Ei of the Lyndon basis with degree\n|i| \u2264 5, the corresponding Lyndon words wi , the bicoloured rooted trees ui , the\nvalues |i|, i\u2032\u2032 , i\u2032 , \u03c3(ui ), and the coefficients zi = Z(ui )/\u03c3(ui ) in the BCH series\n(1.9).\n\n2.3\n\nPractical aspects in the implementation\n\nAn important ingredient in the whole procedure is the practical implementation\nof the Lie bracket [\u03b1, \u03b2] of two Lie series \u03b1, \u03b2 \u2208 L(X, Y ) \u2282 g, which we address\nnext. Let us consider for each u \u2208 T the sequence\nS(u) = {(u(1) , u(1) ), . . . , (u(|u|\u22121) , u(|u|\u22121 ))}\n\n(2.13)\n\nof pairs of bicoloured rooted trees used to define the Lie bracket [\u03b1, \u03b2] in (2.1).\nFor instance,\nn\no\nS(\n)= (\n, ), ( ,\n), ( ,\n) .\n\nIt can be seen that the sequences S(u) satisfy the following recursion. If u =\nv \u25e6 w, where v, w \u2208 T , then, let p = |v| \u2212 1, q = |w| \u2212 1, and\n\nS(v) = {(v(1) , v (1) ), . . . , (v(p) , v (p) )},\n\nS(w) = {(w(1) , w(1) ), . . . , (w(q) , w(q) )},\n11\n\n\fi\u2032\n\ni\n\n|i|\n\n1\n2\n\n1\n1\n\n3\n\n2\n\n1\n\n4\n\n3\n\n5\n\ni\u2032\u2032\n\nui\n\n\u03c3(ui )\n\nzi =\n\nZ(ui )\n\u03c3(ui )\n\nwi\n\nEi\n\nx\ny\n\nX\nY\n\n1\n1\n\n1\n1\n\n2\n\nxy\n\n[X, Y ]\n\n1\n\n3\n\n2\n\nxyy\n\n[[X, Y ], Y ]\n\n2\n\n3\n\n1\n\n3\n\nxxy\n\n[X, [X, Y ]]\n\n1\n\n1\n2\n1\n12\n1\n12\n\n6\n\n4\n\n4\n\n2\n\nxyyy\n\n[[[X, Y ], Y ], Y ]\n\n6\n\n0\n\n7\n\n4\n\n1\n\n4\n\nxxyy\n\n[X, [[X, Y ], Y ]]\n\n2\n\n1\n24\n\n8\n\n4\n\n1\n\n5\n\nxxxy\n\n[X, [X, [X, Y ]]]\n\n1\n\n0\n\n9\n\n5\n\n6\n\n2\n\nxyyyy\n\n[[[[X, Y ], Y ], Y ], Y ]\n\n24\n\n10\n\n5\n\n5\n\n3\n\nxxyxy\n\n[[X, [X, Y ]], [X, Y ]]\n\n2\n\n11\n\n5\n\n3\n\n4\n\nxyxyy\n\n[[X, Y ], [[X, Y ], Y ]]\n\n2\n\n12\n\n5\n\n1\n\n6\n\nxxyyy\n\n[X, [[[X, Y ], Y ], Y ]]\n\n6\n\n1\n720\n1\n360\n1\n120\n1\n180\n\n13\n\n5\n\n1\n\n7\n\nxxxyy\n\n[X, [X, [[X, Y ], Y ]]]\n\n2\n\n1\n180\n\n14\n\n5\n\n1\n\n8\n\nxxxxy\n\n[X, [X, [X, [X, Y ]]]]\n\n1\n\n1\n\u2212 720\n\nTable 2: First elements Ei of the Lyndon basis, their corresponding Lyndon\nwords wi and bicoloured rooted trees ui , the values |i|, i\u2032\u2032 , i\u2032 , \u03c3(ui ), and the\ncoefficients zi = Z(ui )/\u03c3(ui ) in the BCH series (1.9)\n.\nthen\nS(u) = {(w, v), (v(1) , v (1) \u25e6w), . . . , (v(p) , v (p) \u25e6w), (w(1) , v\u25e6w(1) ), . . . , (w(q) , v\u25e6w(q) )}.\n(2.14)\nFrom the point of view of implementation, it is important to observe that, if\none wants to compute the BCH formula (1.9) up to terms of degree |i| \u2264 n,\nthere is no need to compute all values Z(u) for u \u2208 T with |u| \u2264 n, since only\nthe values (2.7) of Z(u) for the rooted trees ui associated to the elements Ei of\nthe basis are used in (1.9). However, when applying the recursion (2.6) for the\nbicoloured rooted trees ui , i = 1, 2, 3, . . . (that we will call Hall rooted trees),\none finds that Z(u) needs to be computed for some additional bicoloured rooted\ntrees u. Observe for instance that in (2.8), the value Z(u) for u = was needed\n) from the recursion (2.6). This is due to the\nin order to get the value Z(\nfact that in (2.1), the bicoloured rooted trees u(j) need not be Hall rooted trees\nwhen u is a Hall rooted tree (u(j) is however necessarily a Hall rooted tree in\nthat case).\nThe minimal set T \u0303n of bicoloured rooted trees u for which Z(u) needs to be\ncomputed in order to get the values of Z(ui ) for Hall rooted trees with |i| \u2264 n\n\n12\n\n\fby using recursion (2.6) can be determined by requiring that\n{ui : |i| \u2264 n} \u2282 T \u0303n \u2282 T\n\nand S(T \u0303n ) \u2282 T \u0303n \u00d7 T\u0303n .\n\nIt can be seen that the subset T\u0303n of bicoloured rooted trees can be alternatively\ndefined as follows: We say that a bicoloured rooted tree v \u2208 T is covered by\nu \u2208 T if either v can be obtained from u by removing some of its vertices and\nedges, or u = v. For instance, the bicoloured rooted trees covered by the tree\nu11 in Table 2 are\n,\n\n,\n\n,\n\n,\n\n,\n\n,\n\n,\n\n,\n\n,\n\n.\n\nThen, it can be seen that T\u0303n is the set of bicoloured rooted trees covered by\nsome of the trees in {ui : |i| \u2264 n}.\nAs a summary of this treatment, we next describe the main steps of the\nalgorithm that we use to compute the BCH series up to terms of a given degree\nN for an arbitrary Hall\u2013Viennot basis. Let mN be sum of the dimensions of the\nhomogeneous subspaces L(X, Y )n for 1 \u2264 n \u2264 N , and let m\u0303N be the number\nof bicoloured rooted trees in T\u0303N (so that mN \u2264 m\u0303N ). We proceed as follows\nfor a given N :\n1. Determine the values i\u2032 , i\u2032\u2032 for each i = 1, . . . , mN such that the Ei given\nby (1.10) are the elements of degree |i| \u2264 N of the required Hall\u2013Viennot\nbasis. Algorithm 1 can be used in the case of the basis of P. Hall. We\nuse a similar (although slightly more complex) algorithm for the general\ncase.\n2. Determine the bicoloured rooted trees u \u2208 T\u0303N together with the |u| \u2212 1\npairs of bicoloured rooted trees in S(u) recursively obtained by (2.14).\nActually, we associate each bicoloured rooted tree in T\u0303N with a positive\ninteger, such that T\u0303N = {ui : i = 1, 2, . . . , m\u0303N } (and {ui : i =\n1, 2, . . . , mN } is the set of Hall trees of degree |i| \u2264 N ). Each S(ui ) is\nthen represented as a list of |i| \u2212 1 pairs of positive integers.\n3. Represent the truncated versions of Lie series \u03b1 (truncated up to terms\nof degree N ) as a list of m\u0303N real values (\u03b11 , . . . , \u03b1m\u0303N ) corresponding\nto (\u03b1(u1 ), . . . , \u03b1(um\u0303N )). The Lie bracket \u03b3 = [\u03b1, \u03b2] of two Lie series\ncan be implemented as a way to obtain the list (\u03b31 , . . . , \u03b3m\u0303N ) from the\nlists (\u03b11 , . . . , \u03b1m\u0303N ) and (\u03b21 , . . . , \u03b2m\u0303N ) in terms of the pairs of integers\nrepresenting S(ui ) for each i = 1, . . . , m\u0303N .\n4. Represent the truncated versions of BCH series Z (truncated up to terms\nof degree N ) as a list of m\u0303N rational values (Z1 , . . . , Zm\u0303N ) corresponding\nto (Z(u1 ), . . . , Z(um\u0303N )), which can be obtained by initializing that list as\n(1, 1, 0, . . . , 0) and applying (2.6) repeatedly for n = 2, . . . , N .\nIt is worth noticing that the number of trees in T\u0303n is different for different Hall\u2013Viennot bases. For instance, for the basis of P. Hall, T\u030320 has 724018\nbicoloured rooted trees, while for the Lyndon basis the set T\u030320 has 1952325\n13\n\n\fbicoloured rooted trees. Due to this fact, the amount of memory and CPU\ntime required to compute with our algorithm the BCH formula up to a given\ndegree for the Lyndon basis is considerably larger than for the basis of P. Hall.\nMoreover, the number of non-zero coefficients zi in the BCH formula differs\nconsiderably in both bases. For instance, there are 109697 non-vanishing coefficients zi (out of 111013 elements Ei of degree |i| \u2264 20) in the BCH formula\nfor the basis of P. Hall, while for the Lyndon basis the number of non-vanishing\ncoefficients zi is 76760.\n\n3\n3.1\n\nOptimal convergence domain of the BCH series\nThe BCH formula and the Magnus expansion\n\nOne particularly simple way of obtaining a sharp bound on the convergence\ndomain for the BCH series consists in relating it with the Magnus expansion\nfor linear differential equations. For the sake of completeness, we summarize\nhere the main features of this procedure.\nSuppose we have the non-autonomous linear differential equation\ndU\n= A(t)U,\ndt\n\nU (0) = I,\n\n(3.1)\n\nwhere U (t) and A(t) are operators acting on some Hilbert space H (in particular,\nn \u00d7 n real or complex matrices). Then the idea is to express the solution U (t)\nas the exponential of a certain operator \u03a9(t),\nU (t) = exp \u03a9(t).\n\n(3.2)\n\nBy substituting (3.2) into (3.1), one can derive the differential equation satisfied\nby the exponent \u03a9:\n\u2032\n\n\u03a9 =\n\n\u221e\nX\nBk\nk=0\n\nk!\n\nadk\u03a9 (A(t)),\n\n\u03a9(0) = O.\n\n(3.3)\n\nBy applying Picard's iteration on (3.3), one gets an infinite series for \u03a9(t),\n\u03a9(t) =\n\n\u221e\nX\n\n\u03a9m (t),\n\n(3.4)\n\nm=1\n\nwhose terms can be obtained recursively from\nZ t\nA(t1 ) dt1 ,\n\u03a91 (t) =\n\u03a9m (t) =\n\n0\nm\u22121\nX\nj=1\n\nBj\nj!\n\nZ\n\nt\n\n0\n\n(ad\u03a9(s) A(s))m ds\n\nm \u2265 2.\n\n(3.5)\n\nEquations (3.2) and (3.4) constitute the so-called Magnus expansion for the\nsolution of (3.1), whereas the infinite series (3.4) with (3.5) is known as the\nMagnus series.\n14\n\n\fSince the 1960s [49], the Magnus expansion has been successfully applied as\na perturbative tool in numerous areas of physics and chemistry, from atomic and\nmolecular physics to nuclear magnetic resonance and quantum electrodynamics\n(see [4] and [5] for a review and a list of references). Also, since the work\nby Iserles and N\u00f8rsett [20], it has been used as a tool to construct practical\nalgorithms for the numerical integration of equation (3.1), while preserving the\nmain qualitative properties of the exact solution.\nIn general, the Magnus series does not converge unless A is small in a suitable\nsense, and several bounds to the actual radius of convergence have been obtained\nalong the years. Recently, the following theorem has been proved [9]:\nTheorem 3.1 Let us consider the differential equation U \u2032 = A(t)U defined in\na Hilbert space H, dim H < \u221e, with U (0) = I, and\nP let A(t) be a bounded linear\noperator on H. Then, the Magnus series \u03a9(t) = \u221e\nk=1 \u03a9k (t), with \u03a9k given by\n(3.5) converges in the interval t \u2208 [0, T ) such that\nZ\n\nT\n\nkA(s)k ds < \u03c0\n\n0\n\nand the sum \u03a9(t) satisfies exp \u03a9(t) = U (t). The statement also holds when H is\ninfinite-dimensional if U is a normal operator (in particular, if U is unitary).\nHere k * k stands for the norm defined by the inner product on H.\nMoreover, it has been shown that the convergence domain of the Magnus\nseries provided by this theorem is the best result one can get for a generic\nbounded operator A(t) in a Hilbert space, in the sense that it isR possible to find\nt\nspecific A(t) where the series diverges for any time t such that 0 kA(s)kds > \u03c0\n[29, 9].\nNow, given two operators X and Y , let us consider equation (3.1) with\n\u001a\nY\n0\u2264t<1\nA(t) =\n(3.6)\nX\n1\u2264t\u22642\nClearly, the exact solution at t = 2 is given by U (2) = eX eY . On the other\nhand, if we apply recurrence (3.5) to compute U (2) with the Magnus expansion,\nU (2) = e\u03a9(2) , we get \u03a91 (2) = X + Y and more generally \u03a9n (2) = Zn in (1.4).\nIn other words, the BCH series can be considered as the Magnus expansion\ncorresponding to the differential equation (3.1) with A(t) given by (3.6) at\nt = 2.\nR t=2\nSince 0 kA(s)kds = kXk+kY k, Theorem 3.1 leads to the following bound\non the convergence of the BCH series.\nTheorem 3.2 Let X and Y be two bounded elements in a Hilbert space H with\ndim H \u2265 2.Then the BCH formula in the form (1.4), i.e., expressed as a series\nof homogeneous Lie polynomials in X and Y , converges when kXk + kY k < \u03c0.\nOf course, this result can be generalized to any set X1 , X2 , . . . , Xk of bounded\noperators: the corresponding BCH series is convergent if kX1 k + * * * + kXk k < \u03c0\nin the 2-norm.\n15\n\n\fLet us illustrate the result provided by Theorem 3.2 with a simple example\ninvolving 2 \u00d7 2 matrices.\nExample 1. Given\nX=\n\n\u0012\n\n\u03b1\n0\n0 \u2212\u03b1\n\n\u0013\n\n,\n\nY =\n\n\u0012\n\n0 \u03b2\n0 0\n\n\u0013\n\n(3.7)\n\nwith \u03b1, \u03b2 \u2208 C, a simple calculation shows that\nlog(eX eY ) = X +\n\n2\u03b1\nY,\n1 \u2212 e\u22122\u03b1\n\nwhich is an analytic function for |\u03b1| < \u03c0 with first singularities at \u03b1 = \u00b1i\u03c0.\nTherefore, the BCH formula cannot converge if |\u03b1| \u2265 \u03c0, independently of \u03b2 6= 0.\nBy taking the spectral norm, it is clear that kXk = |\u03b1|, kY k = |\u03b2|, so that the\nconvergence domain given by Theorem 3.2 is |\u03b1| + |\u03b2| < \u03c0. Notice that in the\nlimit |\u03b2| \u2192 0 this domain is optimal. 2\nGenerally speaking, however, the bound given by Theorem 3.2 is conservative, i.e., the BCH series converges for larger values of kXk and kY k. Thus,\nin the previous example, for any \u03b1 and \u03b2 with |\u03b1| < \u03c0 and |\u03b1| + |\u03b2| \u2265 \u03c0, the\nBCH series also converges. One would like therefore to have a more realistic\ncharacterization of this feature. It turns out that this is indeed feasible for\ncomplex n \u00d7 n matrices.\n\n3.2\n3.2.1\n\nConvergence for matrices\nConvergence determined by the eigenvalues\n\nFor complex n \u00d7 n matrices it is possible to use the theory of analytic matrix\nfunctions and more specifically, the logarithm of an analytic matrix function,\nin a similar way as in the Magnus expansion [9], to characterize more precisely\nthe convergence of the BCH series.\nTo begin with, let us introduce a parameter \u03b5 \u2208 C and consider the substitution (X, Y ) 7\u2212\u2192 (\u03b5X, \u03b5Y ) into eq. (1.1). It is clear that\nU (\u03b5) \u2261 e\u03b5X e\u03b5Y\nis an analytic function of \u03b5, det U (\u03b5) 6= 0 and the matrix function Z(\u03b5) =\nlog U (\u03b5) is also analytic at \u03b5 = 0. Equivalently, the series Z(\u03b5) is convergent\nfor sufficiently small \u03b5. It turns out that the actual radius of convergence of\nthis series is related with the existence of multiple eigenvalues of U (\u03b5). Let us\ndenote by \u03c11 (\u03b5), . . . , \u03c1n (\u03b5) the eigenvalues of the matrix U (\u03b5). Observe that\nU (0) = I, so that \u03c11 (0) = * * * = \u03c1n (0) = 1 and we can take the principal values\nof the logarithm, log \u03c11 (0) = * * * = log \u03c1n (0) = 0. In essence, if the analytic\nmatrix function U (\u03b5) has an eigenvalue \u03c10 (\u03b50 ) of multiplicity l > 1 for a certain\n\u03b50 such that: (a) there is a curve in the \u03b5-plane joining \u03b5 = 0 with \u03b5 = \u03b50 , and\n(b) the number of equal terms in log \u03c11 (\u03b50 ), log \u03c12 (\u03b50 ), . . . , log \u03c1l (\u03b50 ) such that\n\u03c1k (\u03b50 ) = \u03c10 , k = 1, . . . , l is less than the maximum dimension of the elementary\n16\n\n\fJordan P\nblock corresponding to \u03c10 , then the radius of convergence of the series\nZ(\u03b5) = k\u22651 \u03b5k Zk verifying exp Z(\u03b5) = U (\u03b5) is precisely r = |\u03b50 | [9].\nMore specifically, we find first the values of the parameter \u03b5 for which the\ncharacteristic polynomial det(U (\u03b5) \u2212 \u03c1I) has multiple roots and write them in\norder of non-decreasing absolute value,\n(1)\n\n(2)\n\n(3)\n\n\u03b50 , \u03b50 , \u03b50 , . . .\n\n(3.8)\n\n(1)\n\nNext, we consider the circle |\u03b5| = |\u03b50 | in the complex \u03b5-plane and denote by\n(1)\n(1)\n\u03c10 an eigenvalue of U (\u03b50 ) with multiplicity l1 > 1. Let \u03b5 move along some\n(1)\n(1)\nfixed curve L from \u03b5 = 0 to \u03b5 = \u03b50 in the circle |\u03b5| \u2264 |\u03b50 |. Then it is clear\n(1)\n(1)\nthat l1 eigenvalues \u03c1j (\u03b5) will tend to \u03c10 at \u03b5 = \u03b50 . If these points lie at\n(1)\n\u03b5 = \u03b50 on the same sheet of the Riemann surface of the function log z, and\n(1)\n(1)\nthis is true for all (possible) multiple eigenvalues of Yt (\u03b5) at \u03b5 = \u03b50 , then \u03b50\n(1)\nis called a extraneous root. Otherwise, \u03b50 is called a non-extraneous root.\n(1)\nBy the analysis carried out in [51], when |\u03b5| < |\u03b50 | the numbers log \u03c1j (\u03b5)\nare uniquely determined as eigenvalues of the matrix Z(\u03b5) and this series is\n(1)\n(1)\nconvergent. This is also true at |\u03b5| = |\u03b50 | if \u03b50 is an extraneous root, since then\nthe eigenvalues of Z(\u03b5) retain their identity throughout the collision process, so\nthat we proceed to the next value in the sequence (3.8) until a non-extraneous\nroot is obtained.\n(2)\nAssume, for simplicity, that \u03b50 is the first non-extraneous root, for which\nthere exists an eigenvalue \u03c10 of U (\u03b5) with multiplicity l > 1. Associated with\nthis multiple eigenvalue \u03c10 there is a pair of integers (p, q) defined as follows.\nThe integer p is the greatest number of equal terms in the set of numbers\nlog \u03c11 (\u03b50 ), log \u03c12 (\u03b50 ), . . . , log \u03c1l (\u03b50 ) such that \u03c1k (\u03b50 ) = \u03c10 , k = 1, . . . , l.\nThe integer q is the maximum degree of the elementary divisors (\u03c1 \u2212 \u03c10 )k\nof U (\u03b50 ), i.e., the maximum dimension of the elementary Jordan block corresponding to \u03c10 .\nUnder these conditions, it has been proved that, if pP\n< q for the eigenvalue\n\u03c10 , then the radius of convergence of the series Z(\u03b5) = k\u22651 \u03b5k Zk is precisely\nr = |\u03b50 | [51].\nAlthough in some cases with p \u2265 q the series Z(\u03b5) may converge at |\u03b5| = |\u03b50 |\nand the radius of convergence r is greater than |\u03b50 | (for instance, when X and\nY are diagonal), this situation is exceptional in a topological sense, as explained\nin [51, pp. 65-66].\n3.2.2\n\nExamples\n\nIn order to illustrate this result we next consider a pair of examples involving\nalso 2 \u00d7 2 matrices.\nExample 1. The first example involves again the matrices X and Y given by\n(3.7). In this case\n\u0012 \u03b5\u03b1\n\u0013\ne\n\u03b5\u03b2 e\u03b5\u03b1\n\u03b5X \u03b5Y\nU (\u03b5) = e e =\n0\ne\u2212\u03b5\u03b1\n17\n\n\fThe first values of \u03b5 for which there are multiple eigenvalues of U (\u03b5) are\n\u03c0\n\u03b5 = \u00b1i .\n\u03b1\n\n\u03b5 = 0,\n\nThe first value, \u03b5 = 0, is clearly an extraneous root, whereas the eigenvalues\nof the matrix U (\u03b5) move along the unit circle, one clockwise and the other\ncounterclockwise from\n\u03c11,2 (0) = 1\n\nto\n\n\u03c11,2 (i\u03c0/\u03b1) = \u22121\n\nwhen \u03b5 varies along the imaginary axis from \u03b5 = 0 to \u03b5 = i\u03c0/\u03b1 (the same\nconsiderations apply to the case \u03b5 = \u2212i\u03c0/\u03b1). Then, obviously, p = 1 and\nq = 2, so that the radius of convergence of the series Z(\u03b5) is\n|\u03b5| =\n\n\u03c0\n.\n|\u03b1|\n\nBy fixing \u03b5 = 1, we get the actual domain of convergence of the BCH series as\n|\u03b1| = \u03c0, i.e., the same result as in section 3.1. 2\nExample 2. Consider now the matrices\n\u0013\n\u0013\n\u0012\n\u0012\n0 1\n0 0\n,\nB=\nA=\n0 0\n1 0\nand X = \u03b1A, Y = \u03b1B, with \u03b1 > 0. Then\n\u0013\n\u0012\n1\n\u03b1\u03b5\nU (\u03b5) =\n\u03b1\u03b5 1 + \u03b12 \u03b52\n(1)\n\nhas multiple eigenvalues when \u03b50\n\n(2)\n\n= 0, \u03b50\n\n(2)\n\n(3.9)\n\n= \u00b1i \u03b12 . As \u03b5 varies along the\n\nimaginary axis from \u03b5 = 0 to \u03b5 = \u03b50 , the eigenvalues of the matrix U (\u03b5),\ns\u0012\n\u0013\n2\n\u03b1 2\n\u03b12 2 2\n\u03c11,2 (\u03b5) = 1 +\n1+\n\u03b5 \u00b1\n\u03b5\n\u22121\n2\n2\nmove along the unit circle, one clockwise and the other counterclockwise from\n\u03c11,2 (0) = 1\n(2)\n\nto\n\n(2)\n\n(2)\n\n\u03c11,2 (\u03b50 ) = \u22121\n\nThus, \u03c11 (\u03b50 ) and \u03c12 (\u03b50 ) lie on different sheets of the Riemann surface of the\n(2)\nfunction log z and therefore \u03b50 is a non-extraneous root, with p = 1. Since\n(2)\nU (\u03b50 ) 6= \u2212I, we have q = 2, so that the radius of convergence of the series\nZ(\u03b5) is precisely\n2\n(2)\nr = |\u03b50 | = .\n(3.10)\n\u03b1\nThis result should be compared with the bound provided by the Magnus expansion. Since kAk = kBk = 1, Theorem 3.2 guarantees the convergence of\n\u03c0\n, which, in view of\nthe BCH series in this case whenever 2\u03b1|\u03b5| < \u03c0, or |\u03b5| < 2\u03b1\n(3.10), is clearly a conservative estimate.\n18\n\n\fWe can also check numerically the rate of convergence of the BCH series in\nthis example as a function of the parameter \u03b5. Let us denote by Z [N ] the sum\nof the first N terms of the series, i.e.,\nZ\n\n[N ]\n\n(\u03b5) =\n\nN\nX\n\nZn (\u03b5)\n\nn=1\n\nand compute, for \u03b1 = 2 and different values of \u03b5, the matrix\nEr (\u03b5) = U (\u03b5)e\u2212Z\n\n[N] (\u03b5)\n\n\u2212 I,\n\nwhere U (\u03b5) is given by (3.9). If \u03b5 belongs to the convergence domain of the\nBCH series for the matrices X and Y (i.e., |\u03b5| < 1), then Er (\u03b5) \u2192 0 as N \u2192 \u221e.\nFirst we take \u03b5 = 41 . With N = 10, the elements of Er are of order 10\u22127 ,\nwhereas adding five additional terms in the series, N = 15, the elements of Er\nare approximately 10\u221210 .\nNext we choose \u03b5 = 0.9, i.e., a value near the boundary of the convergence\ndomain. In this case with N = 15 the convergence of the series does not\nmanifest at all. In fact, a much larger number of terms is required to achieve\nsignificant results. Thus, for the elements of Er to be of order 10\u22128 we need to\ncompute N = 150 terms of the BCH series, whereas with N = 200 the elements\nof Er are of order 10\u221210 . The computations have been carried out with the\nrecurrence (1.8). 2\nAs this example clearly shows, it is not always possible to determine accurately the convergence domain of the BCH series by computing successive\napproximations, since the rate of convergence can be slow indeed near the\nboundary. For this reason it could be of interest to design a procedure to apply\nin practice the characterization of the convergence in terms of the eigenvalues\nof the matrix U (\u03b5) analyzed in subsection 3.2.1 for matrices.\nThis procedure could be as follows. Given two matrices X, Y , take the\nproduct of exponentials\nU (\u03b5) = e\u03b5X e\u03b5Y\nwith \u03b5 = rei\u03b8 . Next, define a grid in the \u03b5-plane, for instance in polar coordinates (r, \u03b8), by \u2206r = rf /(n + 1), \u2206\u03b8 = 2\u03c0/(m + 1) for two integers\nn, m \u2265 1 and a sufficiently large value rf > 1. Then, for each point in the\ngrid, (rk = k\u2206r, \u03b8l = l\u2206\u03b8), k = 1, . . . , n + 1, l = 0, 1, . . . , m, compute the corresponding matrix U (\u03b5) and its eigenstructure, locating where there are multiple\neigenvalues (within a prescribed tolerance). If some of these multiple eigenvalues have a negative real part, there exists a point in the neighborhood where the\nconditions enumerated in subsection 3.2.1 are satisfied and therefore we have\napproximately located the value of \u03b5 where the BCH series fails to converge.\nThis approximation can be made more accurate by applying, for instance, Newton's method. The actual radius of convergence will be given by the smallest\nnumber r found in this way. Finally, if r > 1, then obviously the BCH series\ncorresponding to X and Y converges.\n\n19\n\n\f4\n\nSome Applications\n\nAs an illustration of the usefulness of the previous results, in this section we\npresent two not so trivial applications of the formalism developed in section 2\nfor constructing explicitly the BCH series up to arbitrarily high order.\n\n4.1\n\nThe symmetric BCH formula\n\nSometimes it is necessary to compute the Lie series W defined by\n1\n1\nexp( X) exp(Y ) exp( X) = exp(W ).\n2\n2\n\n(4.1)\n\nThis occurs, for instance, if one is interested in obtaining the order conditions\nsatisfied by time-symmetric composition methods for the numerical integration\nof differential equations [52, 39]. Two applications of the usual BCH formula\ngives then the expression of W in the Hall basis of L(X, Y ).\nA more efficient procedure is obtained, however, by introducing a parameter\n\u03c4 in (4.1) such that\nW (\u03c4 ) = log(e\u03c4 X/2 eY e\u03c4 X/2 )\n(4.2)\nand deriving the differential equation satisfied by W (\u03c4 ). From the derivative of\nthe exponential map, one gets\n\u221e\n\nX Bn\ndW\n=X+\nadn X,\nd\u03c4\nn! W\n\nW (0) = Y\n\n(4.3)\n\nn=2\n\nwhence it is possible to construct explicitly W as the series W (\u03c4 ) =\nwith\n\nP\u221e\n\nk=0 Wk (\u03c4 ),\n\nW1 (\u03c4 ) = X\u03c4 + Y\nW2 (\u03c4 ) = 0\nWl (\u03c4 ) =\n\nl\u22121\nX\nj=2\n\n(4.4)\nBj\nj!\n\nZ\n\n\u03c4\n0\n\n(adjW X)l ds,\n\nl\u22653\n\nwhere, in general, W2m = 0 for m \u2265 1. By following a similar approach as with\nequation (1.8) in the usual BCH series in section 2, the recursion (4.4) allows\none to express W in (4.1) as\nX\nW =\nwi Ei .\n(4.5)\ni\u22651\n\nThe coefficients wi of this series up to degree 9 in the classical Hall basis are\ncollected in Table 4 in the Appendix. As with the usual BCH series, the\ncoefficients up to degree 19 in both Hall and Lyndon bases can be found at\nwww.gicas.uji.es/research/bch.html.\nWith respect to the convergence of the series, Theorem (3.2) guarantees\nthat W is convergent at least when kXk + kY k < \u03c0.\n\n20\n\n\f4.2\n\nThe BCH formula and a problem of R.C. Thompson\n\nIn a series of papers [43, 32, 44, 45], R.C. Thompson considered the problem of\nconstructing a representation of the BCH formula as\neX eY = eZ\n\nZ = SXS \u22121 + T Y T \u22121 ,\n\nwith\n\n(4.6)\n\nfor certain functions S = S(X, Y ) and T = T (X, Y ) depending on X and Y . By\nusing analytic techniques related with the Kashiwara\u2013Vergne method, Rouvi\u00e8re\n[38] proved that a Lie series \u03c1(X, Y ) exists such that\nS = e\u03c1(X,Y ) ,\n\nT = e\u03c1(\u2212Y,\u2212X)\n\n(4.7)\n\nand converges when X, Y are replaced by normed elements near 0, whereas the\nrepresentation (4.6) is global when both X and Y are skew-Hermitian matrices\n[43].\nThompson himself developed a computational technique for constructing\nexplicitly the series \u03c1(X, Y ) up to terms of degree ten. Although his results\nwere not published, he pointed out that they furnished strong evidence of the\nconvergence of the series \u03c1(X, Y ) on the closed unit sphere in any norm for\nwhich k[X, Y ]k \u2264 kXk kY k [45].\nWith the aim of clarifying this issue and illustrating the techniques developed in section 2, we proceed next to compute \u03c1(X, Y ). Since \u03c1(X, Y ) \u2208\nL(X, Y ), i.e., is a Lie series, it can be written as\nX\n\u03c1(X, Y ) =\n\u03c1i Ei ,\ni\u22651\n\nwhere the elements Ei have been introduced in (1.9), and the goal is to determine the coefficients \u03c1i . This can be accomplished as follows. From the well\nknown formula eU V e\u2212U = eadU V , it is clear that\nZ = ead\u03c1(X,Y ) X + ead\u03c1(\u2212Y,\u2212X) Y.\n\n(4.8)\n\nNext we expand ead\u03c1(X,Y ) X and ead\u03c1(\u2212Y,\u2212X) Y into infinite series as a linear combination of the Hall basis in L(X, Y ) and match the resulting terms with the\ncorresponding to the BCH series for Z. Then a recursive system of equations\nis obtained for the coefficients \u03c1i .\nIt is in fact possible to get a closed expression for \u03c1(X, Y ) up to terms Y 2\nby taking into account the corresponding formula of Z [34]. Specifically, from\nZ=X+\n\nadX\nY\n1 \u2212 e\u2212adX\n\nmod Y 2 ,\n\n(4.9)\n\na simple calculation leads to\n\u03c1(X, Y ) = f (adX )Y\n\nmod Y 2\n\nwith the function f (z) given by\nf (z) =\n\n1\nez\n1 1\n5\n1 2\n143 3\n1\n+ ez = \u2212 \u2212 z +\nz +\nz +\nz 4 + * * * (4.10)\n1 \u2212 ez z\n4 96\n384\n92160\n122880\n21\n\n\fWorking in the classical Hall basis, the complete expression up to degree four\nreads\n5\n1\n11\n1\n[[Y, X], X] +\n[[Y, X], Y ]\n\u03c1(X, Y ) = \u2212 Y + [Y, X] +\n4\n96\n384\n768\n143\n283\n11\n\u2212\n[[[Y, X], X], X] \u2212\n[[[Y, X], X], Y ] +\n[[[Y, X], Y ], Y ]\n92160\n92160\n23040\ni.e., the corresponding equations have a unique solution. This is not the case,\nhowever, at degree 5, where a free parameter appears, which can be chosen to\nbe \u03c110 . Then\n\u03c112 =\n\n\u2212137 \u2212 184320\u03c110\n,\n184320\n\n\u03c113 =\n\n\u2212511 \u2212 737280\u03c110\n737280\n\nAs a matter of fact, if higher degrees are considered, more and more free parameters appear in the corresponding solution. Thus, at degree 7 there are two\nadditional parameters (for instance, \u03c126 and \u03c130 ), whereas at degree 8 \u03c150 and\n\u03c152 can be chosen as free parameters. We conclude, therefore, that there are\ninfinite solutions to the problem posed by Thompson depending on an increasing number of free parameters. An interesting issue would be to determine the\nvalue of these parameters in order to render the whole series convergent on a\ndomain as large as possible.\n\n4.3\n\nDistribution of coefficients in the Lyndon basis\n\nAs we previously mentioned, there are noteworthy differences in the results\nobtained when the algorithm of section 2 is applied to the BCH series in the\nclassical P. Hall basis and the Lyndon basis, particularly with respect to number\nof vanishing coefficients. In the basis of P. Hall there are 1316 zero coefficients\nout of 111013 up to degree m = 20, whereas in the Lyndon basis the number of vanishing terms rises to 34253 (more than 30% of the total number of\ncoefficients).\nMore remarkably, one notices that the distribution of these vanishing coefficients in the Lyndon basis follows a very specific pattern. Before entering into\nthe details, let us denote for simplicity Lm \u2261 L(X, Y )m . We first remark that,\nfor each m \u2265 2, the Lyndon basis Bm of Lm is a disjoint union Bm = Bm,1 \u222aBm,2\nwith Bm,2 = [X, Bm\u22121 ]. Thus, Lm = Lm,1 \u2295 Lm,2 , where Lm,2 = [X, Lm\u22121 ], and\nBm,k (k = 1, 2) is a basis of Lm,k . In particular, adm\u22121\nX Y \u2208 Bm . In this sense,\nfrom our computations we make two observations: First, the coefficient in the\nBCH formula of the element adm\u22121\nX Y in the basis Bm is 0 for even m. Second,\nthe coefficients for the terms in Bm,1 are also zero for even m. This gives a total\nnumber of\nnc (2p) = dim(L2p ) \u2212 dim(L2p\u22121 ) + 1,\np\u22652\nvanishing coefficients of terms of degree m = 2p in the BCH formula written in\nthe Lyndon basis. Thus, for instance, when p = 10, the number of total number\nof vanishing coefficients is nc (20) = dim(L20 ) \u2212 dim(L19 ) + 1 = 52377 \u2212 27594 +\n1 = 24784.\n\n22\n\n\fWith these considerations in mind, we can proceed next to explain the\nobserved phenomena. First, notice that expression (4.9) gives explicitly the\nlast term of the BCH series in the Lyndon basis at each degree. By formally\nexpanding in power series of adX we get\n\u221e\n\nX\n1\nadkX Y\nZ = X + Y + adX Y +\n2\n\nmod Y 2 .\n\nk=2\n\nSince B2n+1 = 0 for all n \u2265 1, the coefficient of adkX Y is non-vanishing only for\nodd values of k, or equivalently, for even values of the degree m.\nAs for the remaining zero coefficients, let us consider at this point the symmetric BCH formula (4.1)\nP again. Clearly the series (4.5) only contains terms of\nodd degree, i.e., W = i\u22650 W2i+1 , where Wi \u2208 Li . By denoting P = X/2 and\nforming the composition exp(P ) exp(W ) exp(\u2212P ) one gets trivially\neP eW e\u2212P = eX eY = eZ ,\ni.e., the standard BCH formula. In the terminology of dynamical systems,\nexp(W ) and exp(Z) are said to be conjugated. Alternatively, we can write\nexp(Z) = exp(adP ) exp(W ), so that Z = exp(adP )W . It is worth\nP to write\nexplicitly this relation for each term Zm \u2208 Lm of the series Z = m\u22650 Zm by\nseparating the odd and even degree cases. Specifically,\nZ2p+1 = W2p+1 +\n\np\nX\nj=1\n\nZ2p =\n\np\nX\nj=1\n\n1\nad2j\nX W2p\u22122j+1\n2j\n(2j)!)2\n\n1\nad2j\u22121 W2p\u22122j+1 .\n(2j \u2212 1)!)22j\u22121 X\n\nFrom these expressions, it is clear that Z2p+1 contains terms in the whole subspace L2p+1,1 \u2295 L2p+1,2 (due to the presence of W2p+1 ), whereas Z2p belongs to\nthe subspace L2p,2 , whose dimension is equal to dim(L2p\u22121 ). In other words,\nthe remaining dim(L2p ) \u2212 dim(L2p\u22121 ) must necessarily vanish. In this sense,\nthe Lyndon basis seems the natural choice to get systematically the BCH series\nwith the minimum number of terms. Nevertheless, compared to the basis of P.\nHall, more CPU time and memory is required to compute the BCH with our\nalgorithm in the Lyndon basis. In particular, 1.5 GBytes are required to compute the BCH formula up to degree 20 in the Hall basis, whereas 3.6 GBytes\nof memory are needed in the Lyndon basis.\n\n5\n\nConcluding remarks\n\nThe effective computation of the BCH series has a long history and is closely\nrelated with the more general problem of carrying out symbolic computations\nin free Lie algebras. In this work we have presented a new algorithm which\nallows us to get a closed expression of the series Z = log(eX eY ) up to degree\n20 in terms of an arbitrary Hall\u2013Viennot basis of the free Lie algebra generated\n23\n\n\fby X and Y , L(X, Y ), requiring reasonable computational resources. As far as\nwe know, no other results are available up to this degree in terms of a basis of\nL(X, Y ). The algorithm is based on some more general results presented in [30]\non the connection of labeled rooted trees with an arbitrary Hall\u2013Viennot basis\nof the free Lie algebra.\nWe have carried out explicitly the computations to get the coefficients of the\nBCH series in terms of both the classical P. Hall basis and the Lyndon basis,\nwith some noteworthy differences in the corresponding results, as analyzed in\nsubsection 4.3.\nWe have also addressed the problem of the convergence of the series when\nX and Y are replaced by normed elements. In the particular case of X and\nY being matrices, we have provided a characterization of the convergence in\nterms of the eigenvalues of eZ .\nAlthough here we have considered only the BCH series, it is clear that\nother more involved calculations can be done, as is illustrated for instance by\nthe problem of R.C. Thompson studied in section 4.2. As a matter of fact, we\nintend to develop a general purpose package to carry out symbolic computations\nin a free Lie algebra generated by more than two operators.\n\nAcknowledgments\nThe authors would like to thank Prof. Xavier Viennot for their very illuminating comments on the observed pattern of zero coefficients in the Lyndon basis.\nThis work has been partially supported by Ministerio de Educaci\u00f3n y Ciencia (Spain) under project MTM2007-61572 (co-financed by the ERDF of the\nEuropean Union) and Fundaci\u00f3 Bancaixa. The SGI/IZO-SGIker UPV/EHU\n(supported by the National Program for the Promotion of Human Resources\nwithin the National Plan of Scientific Research, Development and Innovation Fondo Social Europeo, MCyT and Basque Government) is also gratefully acknowledged for generous allocation of resources for our computations in the\nLyndon basis.\n\nA\n\nAppendix\n\nIn Table 3 we collect the indices i\u2032 and i\u2032 for i \u2265 3 in (1.10) for the classical\nHall basis and the values of the coefficients zi in the BCH formula (1.9) up to\ndegree 9, whereas in Table 4 we gather the corresponding coefficients for the\nsymmetric BCH formula (4.1).\n\n24\n\n\fTable 3:\nbasis and\ni\ni\u2032\n1\n2\n3\n2\n4\n3\n5\n3\n6\n4\n7\n4\n8\n5\n9\n6\n10\n6\n11\n7\n12\n8\n13\n4\n14\n5\n15\n9\n16\n9\n17 10\n18 11\n19 12\n20\n6\n21\n7\n22\n8\n23\n5\n24 15\n25 15\n26 16\n27 17\n28 18\n29 19\n30\n9\n31 10\n32 11\n33 12\n34 13\n35 14\n36\n6\n37\n7\n38\n8\n39\n6\n40\n7\n41\n8\n42 24\n43 24\n\nTable of values of i\u2032 and i\u2032 for i \u2265 3 in (1.10) for the\nthe values zi \u2208 Q in the BCH formula (1.9).\ni\u2032\u2032\nzi\ni i\u2032 i\u2032\u2032\nzi\ni i\u2032\n1\n44 25 2\n1/10080\n87 31\n1\n45 26 2 23/120960\n88 32\n1\n-1/2\n46 27 2\n1/10080\n89 33\n1\n1/12\n47 28 2\n1/60480\n90 34\n2\n-1/12\n48 29 2\n0\n91 35\n1\n0\n49 15 3\n0\n92 15\n2\n1/24\n50 16 3\n1/4032\n93 16\n2\n0\n51 17 3\n23/30240\n94 17\n1\n-1/720\n52 18 3\n1/2240\n95 18\n2\n-1/180\n53 19 3\n1/15120\n96 19\n2\n1/180\n54 20 3\n0\n97 20\n2\n1/720\n55 21 3\n1/2520\n98 21\n3\n-1/120\n56 22 3\n1/10080\n99 22\n3\n-1/360\n57\n9 4\n0\n100 23\n1\n0\n58 10 4\n1/10080\n101 15\n2 -1/1440\n59 11 4\n-1/20160\n102 16\n2\n-1/360\n60 12 4\n-1/20160\n103 17\n2 -1/1440\n61 13 4\n0\n104 18\n2\n0\n62 14 4\n-1/2520\n105 19\n3\n0\n63\n9 5\n1/4032\n106 20\n3\n-1/240\n64 10 5\n1/840\n107 21\n3\n-1/720\n65 11 5\n1/1440\n108 22\n4\n1/240\n66 12 5\n1/12096\n109 23\n1 1/30240\n67 13 5\n1/1260\n110\n9\n2\n1/5040\n68 14 5\n1/10080\n111 10\n2\n1/3780\n69\n7 6\n-1/10080\n112 11\n2 -1/3780\n70\n8 6 -13/30240\n113 12\n2 -1/5040\n71\n8 7\n-1/3360\n114 13\n2 -1/30240 72 42 1 -1/1209600 115 14\n3\n1/2016\n73 42 2 -1/151200\n116\n9\n3 23/15120 74 43 2\n-1/56700\n117 10\n3\n1/5040\n75 44 2\n-1/75600\n118 11\n3 -1/10080 76 45 2\n1/75600\n119 12\n3\n1/1260\n77 46 2\n1/56700\n120 13\n3\n1/5040\n78 47 2\n1/151200\n121 14\n4\n1/5040\n79 48 2 1/1209600 122\n9\n4 -1/10080 80 24 3\n-1/43200\n123 10\n4\n1/1680\n81 25 3 -37/302400 124 11\n5 13/15120 82 26 3 -11/60480\n125 12\n5 -1/1120\n83 27 3 -11/302400 126 13\n5 -1/5040\n84 28 3 11/302400 127 14\n1\n0\n85 29 3\n1/100800\n2 1/60480\n86 30 3\n-1/7560\n25\n\nclassical Hall\ni\u2032\u2032\n3\n3\n3\n3\n3\n4\n4\n4\n4\n4\n4\n4\n4\n4\n5\n5\n5\n5\n5\n5\n5\n5\n5\n6\n6\n6\n6\n6\n6\n7\n7\n7\n7\n7\n7\n8\n8\n8\n8\n8\n8\n\nzi\n-11/30240\n-19/100800\n-1/43200\n-1/10080\n-1/50400\n-1/33600\n-13/120960\n-1/10080\n-11/201600\n-1/43200\n-1/7560\n-1/10080\n1/50400\n1/20160\n-23/302400\n-1/5760\n13/151200\n19/120960\n1/33600\n-13/30240\n-23/100800\n-1/100800\n-1/33600\n-1/60480\n-1/90720\n1/30240\n-11/302400\n1/15120\n1/3780\n-11/120960\n-1/6720\n-1/14400\n-11/120960\n-1/20160\n17/100800\n-1/20160\n17/151200\n1/6048\n1/60480\n-1/100800\n1/37800\n\n\fTable 4:\nbasis and\ni\ni\u2032\n1\n1\n2\n2\n3\n2\n4\n3\n5\n3\n6\n4\n7\n4\n8\n5\n9\n6\n10\n6\n11\n7\n12\n8\n13\n4\n14\n5\n15\n9\n16\n9\n17 10\n18 11\n19 12\n20\n6\n21\n7\n22\n8\n23\n5\n24 15\n25 15\n26 16\n27 17\n28 18\n29 19\n30\n9\n31 10\n32 11\n33 12\n34 13\n35 14\n36\n6\n37\n7\n38\n8\n39\n6\n40\n7\n41\n8\n42 24\n43 24\n\nTable of values of i\u2032 and i\u2032 for i \u2265 3 in (1.10) for the classical Hall\nthe values wi \u2208 Q in the symmetric BCH formula (4.1).\ni\u2032\u2032\nwi\ni\ni\u2032 i\u2032\u2032\nwi\ni i\u2032 i\u2032\u2032\nwi\n0\n1\n44 25 2\n0\n87 31 3\n1/4608\n0\n1\n45 26 2\n0\n88 32 3\n23/134400\n1\n0\n46 27 2\n0\n89 33 3\n1/37800\n1\n-1/24\n47 28 2\n0\n90 34 3\n1/23040\n2\n-1/12\n48 29 2\n0\n91 35 3\n1/201600\n1\n0\n49 15 3\n0\n92 15 4 193/6451200\n2\n0\n50 16 3\n0\n93 16 4\n53/483840\n2\n0\n51 17 3\n0\n94 17 4\n25/193536\n1\n7/5760\n52 18 3\n0\n95 18 4\n1/22400\n2\n7/1440\n53 19 3\n0\n96 19 4 -13/1209600\n2\n1/180\n54 20 3\n0\n97 20 4\n53/483840\n2\n1/720\n55 21 3\n0\n98 21 4\n17/161280\n3\n1/480\n56 22 3\n0\n99 22 4\n-3/44800\n3\n-1/360\n57\n9 4\n0\n100 23 4 -19/322560\n1\n0\n58 10 4\n0\n101 15 5 367/4838400\n2\n0\n59 11 4\n0\n102 16 5 193/645120\n2\n0\n60 12 4\n0\n103 17 5 247/604800\n2\n0\n61 13 4\n0\n104 18 5\n53/241920\n2\n0\n62 14 4\n0\n105 19 5\n1/33600\n3\n0\n63\n9 5\n0\n106 20 5\n53/161280\n3\n0\n64 10 5\n0\n107 21 5 193/403200\n3\n0\n65 11 5\n0\n108 22 5\n13/201600\n4\n0\n66 12 5\n0\n109 23 5\n-1/5600\n1 -31/967680 67 13 5\n0\n110\n9 6\n11/774144\n2 -31/161280 68 14 5\n0\n111 10 6\n1/290304\n2 -13/30240\n69\n7 6\n0\n112 11 6\n-1/15360\n2 -53/120960 70\n8 6\n0\n113 12 6 -89/1209600\n2\n-1/5040\n71\n8 7\n0\n114 13 6 -11/241920\n2\n-1/30240\n72 42 1 127/154828800 115 14 6\n-13/80640\n3 -53/161280 73 42 2 127/19353600\n116\n9 7\n1/12096\n3 -11/12096\n74 43 2\n157/7257600\n117 10 7\n11/64512\n3\n-3/4480\n75 44 2\n367/9676800\n118 11 7\n1/33600\n3\n-1/10080\n76 45 2\n23/604800\n119 12 7 -11/120960\n3\n-1/4032\n77 46 2\n79/3628800\n120 13 7\n1/35840\n3\n-1/6720\n78 47 2\n1/151200\n121 14 7 -29/134400\n4 -19/80640\n79 48 2\n1/1209600\n122\n9 8 211/1935360\n4\n-1/10080\n80 24 3 367/19353600\n123 10 8 173/604800\n4\n17/40320\n81 25 3\n473/4838400\n124 11 8\n5/24192\n5 -53/60480\n82 26 3\n41/215040\n125 12 8\n1/60480\n5 -19/13440\n83 27 3\n211/1209600\n126 13 8\n61/403200\n5\n-1/5040\n84 28 3\n89/1209600\n127 14 8\n-1/151200\n1\n0\n85 29 3\n1/100800\n2\n0\n86 30 3\n79/967680\n26\n\n\fReferences\n[1] M. Abramowitz and I.A. Stegun. Handbook of Mathematical Functions.\nDover, 1965.\n[2] H.F. Baker. Alternant and continuous groups. Proc. London Math. Soc.\n(Second series), 3:24\u201347, 1905.\n[3] S. Blanes and F. Casas. On the convergence and optimization of the Baker\u2013\nCampbell\u2013Hausdorff formula. Linear Algebra Appl., 378:135\u2013158, 2004.\n[4] S. Blanes, F. Casas, J.A. Oteo, and J. Ros. Magnus and Fer expansions for\nmatrix differential equations: the convergence problem. J. Phys. A: Math.\nGen., 22:259\u2013268, 1998.\n[5] S. Blanes, F. Casas, J.A. Oteo, and J. Ros. Magnus expansion: mathematical study and physical applications, 2008. Work in progress.\n[6] A. Bose. Dynkin's method of computing the terms of the Baker\u2013Campbell\u2013\nHausdorff series. J. Math. Phys., 30:2035\u20132037, 1989.\n[7] N. Bourbaki. Lie groups and Lie algebras. Chapters 1\u20133, Springer, 1989.\n[8] J. E. Campbell. On a law of combination of operators. Proc. London Math.\nSoc., 29:14\u201332, 1898.\n[9] F. Casas. Sufficient conditions for the convergence of the Magnus expansion. J. Phys. A: Math. Theor., 40:15001\u201315017, 2007.\n[10] A. J. Dragt and J. M. Finn. Lie series and invariant functions for analytic\nsymplectic maps. J. Math. Phys., 17:2215\u20132227, 1976.\n[11] A. D\u00fcr. Mobius Functions, Incidence Algebras and Power-Series Representations, volume 1202 of Lecture Notes in Mathematics. Springer-Verlag,\nBerlin, 1986.\n[12] E.B. Dynkin. Evaluation of the coefficients of the Campbell\u2013Hausdorff\nformula. Dokl. Akad. Nauk. SSSR, 57:323\u2013326, 1947.\n[13] K. Goldberg. The formal power series for log(ex ey ). Duke Math. J., 23:13\u2013\n21, 1956.\n[14] V.V. Gorbatsevich, A.L. Onishchik, and E.B. Vinberg. Foundations of Lie\nTheory and Lie Transformation Groups. Springer, 1997.\n[15] R. Grossman and R.G. Larson. Hopf-algebraic structure of families of trees.\nJ. Algebra, 126:184\u2013210, 1989.\n[16] E. Hairer, Ch. Lubich, and G. Wanner. Geometric Numerical Integration. Structure-Preserving Algorithms for Ordinary Differential Equations.\nSpringer-Verlag, Second edition, 2006.\n\n27\n\n\f[17] F. Hausdorff. Die symbolische Exponential Formel in der Gruppen theorie.\nLeipziger Ber., 58:19\u201348, 1906.\n[18] M.E. Hoffman. Combinatorics of rooted trees and Hopf algebras. Trans.\nAmer. Math. Soc., 355:3795\u20133811, 2003.\n[19] A. Iserles, H. Z. Munthe-Kaas, S. P. N\u00f8rsett, and A. Zanna. Lie-group\nmethods. Acta Numerica, 9:215\u2013365, 2000.\n[20] A. Iserles and S. P. N\u00f8rsett. On the solution of linear differential equations\nin Lie groups. Phil. Trans. Royal Soc. A, 357:983\u20131019, 1999.\n[21] N. Jacobson. Lie Algebras. Dover, 1979.\n[22] M. Kolsrud. Maximal reductions in the Baker-Hausdorff formula. J. Math.\nPhys., 34(1):270\u2013285, 1993.\n[23] P.-V. Koseleff. Calcul formel pour les m\u00e9thodes de Lie en m\u00e9canique hamiltonienne. PhD thesis, \u00c9cole Polytechnique, 1993.\n[24] K. Kumar. On expanding the exponential. J. Math. Phys., 6:1928\u20131934,\n1965.\n[25] M. Lothaire. Combinatorics on Words, volume 17 of Encyclopedia of Mathematics. Addison-Wesley, Reading, 1983.\n[26] W. Magnus. On the exponential solution of differential equations for a\nlinear operator. Comm. Pure and Appl. Math., VII:649\u2013673, 1954.\n[27] R.I. McLachlan and R. Quispel.\n11:341\u2013434, 2002.\n\nSplitting methods.\n\nActa Numerica,\n\n[28] J. Michel. Bases des alg\u00e8bres de Lie et s\u00e9rie de Hausdorff. S\u00e9minaire\nDubreil. Alg\u00e8bre, 27(6):1\u20139, 1974.\n[29] P.C. Moan. On backward error analysis and Nekhoroshev stability in the\nnumerical analysis of conservative systems of ODEs. PhD thesis, University of Cambridge, 2002.\n[30] A. Murua. The Hopf algebra of rooted trees, free Lie algebras, and Lie\nseries. Found. Comp. Math., 6:387\u2013426, 2006.\n[31] M. Newman, W. So, and R.C. Thompson. Convergence domains for the\nCampbell-Baker-Hausdorff formula. Linear Multilinear Algebra, 24:301\u2013\n310, 1989.\n[32] M. Newman and R.C. Thompson. Numerical values of Goldberg's coefficients in the series for log(ex ey ). Math. Comp., 48:265\u2013271, 1987.\n[33] J.A. Oteo. The Baker-Campbell-Hausdorff formula and nested commutator\nidentities. J. Math. Phys., 32(2):419\u2013424, 1991.\n\n28\n\n\f[34] M. Postnikov. Lie Groups and Lie Algebras. Semester V of Lectures in\nGeometry. URSS Publishers, 1994.\n[35] M.W. Reinsch. A simple expression for the terms in the Baker\u2013Campbell\u2013\nHausdorff series. J. Math. Phys., 41:2434\u20132442, 2000.\n[36] C. Reutenauer. Free Lie algebras, volume 7 of London Math. Soc. monographs (new series). Oxford University Press, 1993.\n[37] R.D. Richtmyer and S. Greenspan. Expansion of the Campbell\u2013Baker\u2013\nHausdorff formula by computer. Comm. Pure and Appl. Math., 18:107\u2013\n108, 1965.\n[38] F. Rouvi\u00e8re. Espaces sym\u00e9triques et m\u00e9thode de Kashiwara\u2013Vergne. Ann.\nSci. \u00c9cole Norm. Sup., 19:553\u2013581, 1986.\n[39] J. M. Sanz-Serna and M. P. Calvo. Numerical Hamiltonian Problems.\nAMMC 7. Chapman & Hall, 1994.\n[40] A.T. Sornborger and E.D. Stewart. Higher-order methods for simulations\non quantum computers. Phys. Rev. A, 60:1956\u20131965, 1999.\n[41] M. Suzuki. On the convergence of exponential operators-the Zassenhaus\nformula, BCH formula and systematic approximants. Commun. Math.\nPhys., 57:193\u2013200, 1977.\n[42] R.C. Thompson. Cyclic relations and the Goldberg coefficients in the\nCampbell\u2013Baker\u2013Hausdorff formula. Proc. Amer. Math. Soc., 86:12\u201314,\n1982.\n[43] R.C. Thompson. Proof of a conjectured exponential formula. Linear Multilinear Algebra, 19:187\u2013197, 1986.\n[44] R.C. Thompson. Special cases of a matrix exponential formula. Linear\nAlgebra Appl., 107:283\u2013292, 1988.\n[45] R.C. Thompson. Convergence proof for Goldberg's exponential series. Linear Algebra Appl., 121:3\u20137, 1989.\n[46] M. Torres-Torriti and H. Michalska. A software package for Lie algebraic\ncomputations. SIAM Review, 47:722\u2013745, 2005.\n[47] V. S. Varadarajan. Lie Groups, Lie Algebras, and Their Representations.\nGTM 102. Springer-Verlag, 1984.\n[48] X.G. Viennot. Alg\u00e8bres de Lie Libres et mono\u0131\u0308des libres, volume 691 of\nLecture Notes in Mathematics. Springer, Berlin, 1978.\n[49] G.H. Weiss and A.A. Maradudin. The Baker\u2013Hausdorff formula and a\nproblem in Crystal Physics. J. Math. Phys., 3:771\u2013777, 1962.\n[50] R.M. Wilcox. Exponential operators and parameter differentiation in quantum physics. J. Math. Phys., 8:962\u2013982, 1967.\n29\n\n\f[51] V.A. Yakubovich and V.M. Starzhinskii. Linear Differential Equations\nwith Periodic Coefficients. John Wiley & Sons, 1975.\n[52] H. Yoshida. Construction of higher order symplectic integrators. Phys.\nLett. A, 150:262\u2013268, 1990.\n\n30\n\n\f"}