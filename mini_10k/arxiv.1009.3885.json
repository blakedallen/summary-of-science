{"id": "http://arxiv.org/abs/1009.3885v1", "guidislink": true, "updated": "2010-09-20T16:45:58Z", "updated_parsed": [2010, 9, 20, 16, 45, 58, 0, 263, 0], "published": "2010-09-20T16:45:58Z", "published_parsed": [2010, 9, 20, 16, 45, 58, 0, 263, 0], "title": "On Rice's formula for stationary multivariate piecewise smooth processes", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.0269%2C1009.0407%2C1009.4547%2C1009.3889%2C1009.2419%2C1009.2603%2C1009.0134%2C1009.0724%2C1009.4622%2C1009.5367%2C1009.2641%2C1009.5603%2C1009.4726%2C1009.5904%2C1009.6167%2C1009.0820%2C1009.3650%2C1009.1986%2C1009.1453%2C1009.1228%2C1009.2073%2C1009.4226%2C1009.5636%2C1009.4851%2C1009.2074%2C1009.1028%2C1009.4893%2C1009.5458%2C1009.1194%2C1009.0869%2C1009.3405%2C1009.5442%2C1009.1903%2C1009.5561%2C1009.1563%2C1009.0955%2C1009.0332%2C1009.5865%2C1009.1413%2C1009.1451%2C1009.3047%2C1009.2918%2C1009.1415%2C1009.0006%2C1009.5130%2C1009.4040%2C1009.1587%2C1009.0691%2C1009.2763%2C1009.4079%2C1009.4367%2C1009.1330%2C1009.2830%2C1009.3235%2C1009.2493%2C1009.4017%2C1009.4849%2C1009.2290%2C1009.6039%2C1009.2908%2C1009.4774%2C1009.2573%2C1009.2292%2C1009.5954%2C1009.0071%2C1009.5965%2C1009.1129%2C1009.3679%2C1009.4119%2C1009.2376%2C1009.0273%2C1009.2468%2C1009.0641%2C1009.5264%2C1009.4991%2C1009.5663%2C1009.1727%2C1009.6172%2C1009.1414%2C1009.2742%2C1009.5842%2C1009.3300%2C1009.2988%2C1009.0985%2C1009.4207%2C1009.5718%2C1009.0904%2C1009.5855%2C1009.2951%2C1009.4387%2C1009.3150%2C1009.3710%2C1009.2265%2C1009.3885%2C1009.2402%2C1009.2930%2C1009.3319%2C1009.1972%2C1009.0758%2C1009.4191%2C1009.4739&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On Rice's formula for stationary multivariate piecewise smooth processes"}, "summary": "Let $X=\\{X_t: t\\ge 0\\}$ be a stationary piecewise continuous $\\R^d$-valued\nprocess that moves between jumps along the integral curves of a given\ncontinuous vector field, and let $S\\subset\\R^d$ be a smooth surface. The aim of\nthis paper is to derive a multivariate version of Rice's formula, relating the\nintensity of the point process of (localized) continuous crossings of $S$ by\n$X$ to the distribution of $X_0$. Our result is illustrated by examples\nrelating to queueing networks and stress release network models.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1009.0269%2C1009.0407%2C1009.4547%2C1009.3889%2C1009.2419%2C1009.2603%2C1009.0134%2C1009.0724%2C1009.4622%2C1009.5367%2C1009.2641%2C1009.5603%2C1009.4726%2C1009.5904%2C1009.6167%2C1009.0820%2C1009.3650%2C1009.1986%2C1009.1453%2C1009.1228%2C1009.2073%2C1009.4226%2C1009.5636%2C1009.4851%2C1009.2074%2C1009.1028%2C1009.4893%2C1009.5458%2C1009.1194%2C1009.0869%2C1009.3405%2C1009.5442%2C1009.1903%2C1009.5561%2C1009.1563%2C1009.0955%2C1009.0332%2C1009.5865%2C1009.1413%2C1009.1451%2C1009.3047%2C1009.2918%2C1009.1415%2C1009.0006%2C1009.5130%2C1009.4040%2C1009.1587%2C1009.0691%2C1009.2763%2C1009.4079%2C1009.4367%2C1009.1330%2C1009.2830%2C1009.3235%2C1009.2493%2C1009.4017%2C1009.4849%2C1009.2290%2C1009.6039%2C1009.2908%2C1009.4774%2C1009.2573%2C1009.2292%2C1009.5954%2C1009.0071%2C1009.5965%2C1009.1129%2C1009.3679%2C1009.4119%2C1009.2376%2C1009.0273%2C1009.2468%2C1009.0641%2C1009.5264%2C1009.4991%2C1009.5663%2C1009.1727%2C1009.6172%2C1009.1414%2C1009.2742%2C1009.5842%2C1009.3300%2C1009.2988%2C1009.0985%2C1009.4207%2C1009.5718%2C1009.0904%2C1009.5855%2C1009.2951%2C1009.4387%2C1009.3150%2C1009.3710%2C1009.2265%2C1009.3885%2C1009.2402%2C1009.2930%2C1009.3319%2C1009.1972%2C1009.0758%2C1009.4191%2C1009.4739&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let $X=\\{X_t: t\\ge 0\\}$ be a stationary piecewise continuous $\\R^d$-valued\nprocess that moves between jumps along the integral curves of a given\ncontinuous vector field, and let $S\\subset\\R^d$ be a smooth surface. The aim of\nthis paper is to derive a multivariate version of Rice's formula, relating the\nintensity of the point process of (localized) continuous crossings of $S$ by\n$X$ to the distribution of $X_0$. Our result is illustrated by examples\nrelating to queueing networks and stress release network models."}, "authors": ["K. A. Borovkov", "G. Last"], "author_detail": {"name": "G. Last"}, "author": "G. Last", "links": [{"href": "http://arxiv.org/abs/1009.3885v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1009.3885v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "60J75, 60G55", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1009.3885v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1009.3885v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:1009.3885v1 [math.PR] 20 Sep 2010\n\nOn Rice's formula for stationary multivariate\npiecewise smooth processes\nK. Borovkov\u2217 and G. Last\n\n\u2020\n\nSeptember 12, 2018\n\nAbstract\nLet X = {Xt : t \u2265 0} be a stationary piecewise continuous Rd -valued process that\nmoves between jumps along the integral curves of a given continuous vector field,\nS \u2282 Rd be a smooth surface. The aim of this paper is to derive a multivariate\nversion of Rice's formula, relating the intensity of the point process of (localized)\ncontinuous crossings of S by X to the distribution of X0 . Our result is illustrated\nby examples relating to queueing networks and stress release network models.\n\nKeywords: level crossings, Rice's formula, stationarity, Palm probabilities, piecewisedeterministic process, stochastic network\n2000 Mathematics Subject Classification: Primary 60J75; secondary 60G55.\n\n1\n\nIntroduction\n\nThe classical Rice's formula going back to [10] gives the intensity \u03bd(u) of crossings (originally, upcrossings) of a given level u by a univariate continuous stationary Gaussian\nd\nprocess Xt in terms of the joint distribution of (Xt , Xt\u2032 ) = (X0 , X0\u2032 ), the process' value\nand its derivative at a fixed time (provided that the derivative exists in some suitable\nsense, e.g. in mean quadratic):\nZ\n\u03bd(u) = |z| p(u, z) dz,\n(1.1)\nwhere p(*, *) is the joint density (X0 , X0\u2032 ) which is assumed to exist. Later on the result has\nbeen extended to more general classes of differentiable (in some suitable sense) stationary\nprocesses, covering not only the first moments but also higher order factorial moments\nof the numbers of crossing, and even to more general settings for continuous random\nprocesses and fields. The formula proved to be quite useful in a number of applied areas,\nincluding signal processing, reliability, sea waves and others. For detailed accounts of the\nhistory of results of this kind and further bibliography, the interested reader is referred\nto [11], [9] and Chapter 3 in [2].\n\u2217\n\u2020\n\nDepartment of Mathematics and Statistics, University of Melbourne, k.borovkov@ms.unimelb.edu.au.\nInstitut f\u00fcr Stochastik, Karlsruher Institut f\u00fcr Technologie, guenter.last@kit.edu.\n\n1\n\n\fThe case of processes with jumps and degenerate finite-dimensional distributions drew\nmuch less attention, although, from the applications' viewpoint, it is scarcely less interesting than the one of continuous processes. However, the heuristics behind the formula\nbased on \"Kac's counting formula\" giving the number of crossings of a level u by a C 1 function f on [0, 1] as\n1\nlim\n\u03b4\u21920+ 2\u03b4\n\nZ\n\n1\n\n|f \u2032 (t)| 1{|f (t) \u2212 u| < \u03b4} dt\n\n(1.2)\n\n0\n\n(under a couple of further technical assumptions and denoting by 1A the indicator function\nof the set A), seems to be applicable in that case as well, provided that the process jumps at\nfinite intensity and is smooth between the jump times. We note that (1.2) is a consequence\nof Federer's coarea theorem (see e.g. (7.4.15) in [1])\nZ 1\nZ \u221e X\n\u2032\ng(t) |f (t)| dt =\ng(s) 1{f (s) = t} dt,\n(1.3)\n0\n\n\u2212\u221e s\u2208[0,1]\n\napplied to the function g(s) := 1{|f (s) \u2212 u| < \u03b4}.\nAn analogue of (1.1) for the intensity \u03bdc (u) of continuous level crossings by general\nunivariate piecewise deterministic Markov processes that has the form\n\u03bdc (u) = |\u03bc(u)|p(u),\nwhere \u03bc(*) is the drift coefficient of the process and p(*) the density of X0 , was established\nin [6] (see also Theorem 2.5 below; one should mention here an earlier paper [4] where the\ncase of Poisson shot-noise processes was considered). The result was used in [6] to obtain\nthe asymptotic behaviour of the point processes of high level crossings (i.e. as u \u2192 \u221e) in\na number of interesting and important for applications special cases.\nThe proof in [6] relied on the Markov structure of the process and in fact did not\nassume the existence of the density p - its existence was part of the assertion of the main\ntheorem there. The natural question on whether Rice's formula for piecewise smooth\nprocesses can be extended to the multivariate and non-Markovian cases remained open.\nIn the present paper we give a positive answer to it.\nThe paper is organized as follows. In Section 2, we describe the main class of processes\nwe will be working with and then present the main result together with its proof. Section 3\npresents examples to illustrate our main result.\n\n2\n\nThe main result\n\nFirst we will describe the main model of multivariate random processes X = {Xt : t \u2265 0}\ndealt with in this paper. The two key elements of the model are a point process N =\n{N(B) : B \u2208 B(R+ )} of jumps in our process X (here and in what follows, B(*) denotes\nthe class of Borel subsets of *) and a vector field \u03bc : D \u2192 Rd defined on an open domain\nD \u2282 Rd and specifying the dynamics of X between the jumps. Note that we allow trivial\njumps (of zero size) as well.\nWe assume that the following assumptions are satisfied.\n2\n\n\f(A.1) N is a stationary simple counting process on R+ , which has a finite intensity\n\u03bbN := EN((0, 1]) and is such that N(R+ ) = \u221e a.s.\nThe latter implies that the process N is locally finite and hence its points can be\nenumerated in the increasing order. We denote them by 0 < T1 < T2 < . . . and set\nT0 := 0 for convenience (this is not a point of N a.s.).\n(A.2) \u03bc \u2208 C 1 (D).\nThis assumption implies that there exist continuous functions t\u2212 : Rd \u2192 (\u2212\u221e, 0)\nand t+ : Rd \u2192 (0, \u221e) such that, for any x \u2208 D, there exists a unique C 1 -function\nq(x, *) : (t\u2212 (x), t+ (x)) \u2192 D satisfying the integral equation\nZ t\nq(x, t) = x +\n\u03bc(q(x, s)) ds, t \u2208 (t\u2212 (x), t+ (x))\n(2.1)\n0\n\n(Picard-Lindel\u00f6f theorem, see e.g. p.8 in [8]). Moreover, for any fixed x \u2208 Rd there is\na neighbourhood of (x, 0) \u2208 Rd+1 in which q(*, *) will also be continuously differentiable\n(Peano's theorem on dependence on initial conditions, see e.g. p.95 in [8]).\nThe integral curves q specify the dynamics of the process X between its jumps.\n(A.3) Assume that, for any n \u2265 0, one has XTn \u2208 D, Tn+1 < Tn + t+ (XTn ) and\nXt = q(XTn , t \u2212 Tn ),\n\nTn \u2264 t < Tn+1 .\n\n(2.2)\n\nMoreover, X and N are jointly stationary, i.e. the distribution of the bivariate process\n{(Xs+t , N((s, s + t])) : t \u2265 0} does not depend on s \u2265 0.\nNext we will list assumptions involving the surface S of which the continuous crossings\nby X we are concerned with. The latter are defined as follows: we say that X has a\ncontinuous crossing of S at time s > 0 if Xs\u2212 = Xs \u2208 S and there is a \u03b4 > 0 such that\nXt \u2208\n/ S for t \u2208 (s \u2212 \u03b4, s + \u03b4) \\ {s}.\n(A.4) Let S \u2282 D be the relative interior of a (d \u2212 1)-dimensional (not necessarily\nconnected) C 1 -manifold with or without boundary, and {n(x) : x \u2208 S} be a continuous\nfield of unit normals to S. Denoting by h*, *i the Euclidean scalar product in Rd , we\nassume that\nhn(x), \u03bc(x)i =\n6 0,\n\nx \u2208 S.\n\n(2.3)\n\nRemark 2.1. Let \u03c4x := inf{t > 0 : q(x, t) \u2208 S} be the first positive time the integral\ncurve of \u03bc leaving from x at time zero hits the surface S. It is not hard to see that, if S \u2032\nis a compact subset of S, then from (A.2) and (A.4) it follows that\ninf{\u03c4x : x \u2208 S \u2032 } > 0.\n\n(2.4)\n\nThis (together with the fact that X jumps only finitely often in finite time intervals)\nimplies that the times of continuous crossings of S through a compact subset of S cannot\naccumulate in finite time.\n\n3\n\n\fThe times of continuous crossings of S by X form an at most countable set Nc that\nwill be identified with a random counting measure on [0, \u221e). Then\nZ\nX\n\u0001\n1{(s, Xs ) \u2208 C} = 1{(s, Xs ) \u2208 C}Nc (ds), C \u2208 B [0, \u221e) \u00d7 Rd , (2.5)\n\u03a6c (C) :=\ns\u2208Nc\n\ndefines a random (integer-valued) measure \u03a6c on [0, \u221e) \u00d7 Rd . For t \u2265 0 and S \u2032 \u2208 B(Rd ),\nthe random variable \u03a6c ([0, t] \u00d7 S \u2032 ) need not be finite. However, if S \u2032 is a compact subset\nof S then (2.4) implies that \u03a6c ([0, t] \u00d7 S \u2032 ) < \u221e. Moreover, since N has a finite intensity,\n\u03bdc (B) := E\u03a6c ((0, 1] \u00d7 B),\n\nB \u2208 B(Rd ),\n\n(2.6)\n\nis finite, whenever B is a compact subset of S. Therefore \u03bdc (*) is a \u03c3-finite measure on\nB(Rd ). For any compact B \u2282 S, the point process \u03a6c (* \u00d7 B) is stationary. This is enough\nto derive the (refined) Campbell theorem stating that\nZ\nZZ\nE g(s, Xs ) Nc (ds) =\ng(s, x) ds \u03bdc(dx).\n(2.7)\nfor any measurable function g : R+ \u00d7 Rd \u2192 R+ , cf. e.g. (1.2.19) in [3].\nRemark 2.2. Assuming that A is a small enough open set to ensure that \u03bdc (S \u2229 A) < \u221e,\nobserve that \u03bdc (S \u2229 A)\u22121 \u03bdc (*) can be interpreted as the distribution of the value of X at\na typical time of continuous crossing of S \u2229 A. This is a particular instance of a Palm\ndistribution, see e.g. [3].\nThe Palm measure \u03c00 of the pairs of values of X just before and after a typical jump\nof X is defined by\n\u03c00 (B) := E\n\n\u221e\nX\n\n1{Tn \u2264 1, XTn \u2212 6= XTn , (XTn \u2212 , XTn ) \u2208 B},\n\nB \u2208 B(Rd \u00d7 Rd ).\n\n(2.8)\n\nn=1\n\nNote that \u03c00 (Rd \u00d7 Rd ) \u2264 \u03bbN < \u221e.\n(A.5) The distribution \u03c0 of X0 has a continuous density p in a neighborhood of S,\nand\n\b\nmin \u03c00 ((Rd \\ S) \u00d7 S), \u03c00 (S \u00d7 (Rd \\ S)) = 0.\n(2.9)\n\nNow we are ready to state our main result.\n\nTheorem 2.3. Under assumptions (A.1)\u2013(A.5), one has the identity\nZ\n\u03bdc (B) =\n|hn(x), \u03bc(x)i| p(x) Hd\u22121(dx), B \u2208 B(Rd ),\n\n(2.10)\n\nS\u2229B\n\nwhere Hd\u22121 is the (d \u2212 1)-dimensional Hausdorff measure on Rd .\nRemark 2.4. As it will be seen from the first half of the proof of Theorem 2.3, the full\ncontinuity assumption on p (which is part of (A.5)) can actually be somewhat weakened\nto the boundedness of p in a neighborhood of S and its right-continuity (in case the first\nnumber in (2.9) vanishes) on S along the flow meaning that p(q(x, 0+)) = p(x), x \u2208 S.\n4\n\n\fIn the one-dimensional case the above theorem simplifies to the following assertion.\nTheorem 2.5. In the case d = 1, assuming that S = {u} for some u \u2208 D such that\n\u03bc(u) 6= 0, and that (A.1)\u2013(A.3) and (A.5) are satisfied, one has\n\u03bdc ({u}) = |\u03bc(u)|p(u).\n\n(2.11)\n\nRemark 2.6. In the Markovian case, representation (2.11) was established in [6]. More\nprecisely, it was shown there that there exists a density p satisfying (2.11). Due to the\nMarkovian structure of the process, it was possible to derive the result under weaker\ntechnical assumptions.\nIn the case when\nS = S u := {x \u2208 Rd : x1 = u}\nfor some u \u2208 R, a continuous crossing of S is a continuous crossing of the level u by the\nfirst component of X. In this case Theorem 2.3 takes the following form.\nTheorem 2.7. Let assumptions (A.1)\u2013(A.3) be satisfied and u \u2208 R be such that S u \u2282 D\nand \u03bc1 (x) 6= 0 for all x \u2208 S u , where \u03bc1 is the first component of \u03bc. Assume that (A.5)\nholds with S = S u . Then, for B \u2208 B(Rd ),\nZ\nZ\n\u03bdc (B) = * * * 1B (u, x2 , . . . , xd ) |\u03bc1(u, x2 , . . . , xd )| p(u, x2, . . . , xd ) dx2 * * * dxd .\nRemark 2.8. Theorem 2.7 is another, more straigthforward, generalization of (2.11).\nAssume now that 0 < \u03bdc (S u ) < \u221e and consider a \"typical time\" of a continuous crossing\nof the level u by the first component of X. Then the measure Qu (*) := \u03bdc (S u )\u22121 \u03bdc ({u} \u00d7*)\ndescribes the distribution of the other components of X at this time. This distribution\ncan be interpreted in terms of the drift-modulated density p1 proportional to |\u03bc1 (x)|p(x)\n(assuming that E|\u03bc1 (X0 )| < \u221e). If (Y1 , . . . , Yd) is a random vector with density p1 , then\nQu is the conditional distribution of (Y2 , . . . , Yd) given that Y1 = u.\nRemark 2.9. Let k \u2208 {1, . . . , d} and assume that S = S\u0303\u00d7Rd\u2212k , where S\u0303 \u2282 Rk is a (k\u22121)dimensional smooth surface. Let {\u00f1(x) : x \u2208 S\u0303} be a continuous field of unit normals to\nS\u0303. Let X\u0303 := (X (1) , . . . , X (k) ) and Y := (X (k+1) , . . . , X (d) ), where X = (X (1) , . . . , X (d) ).\nThere is a one-to-one correspondence between the continuous crossings of S by the process\nX and continuous crossings of S\u0303 by the process X\u0303. Equation (2.10) can be written as\nZ Z\n\u03bdc (B) =\n|h\u00f1(x), \u03bc\u0303(x, y)i|1B (x, y)p(x|y)Hk\u22121(dx)P(Y0 \u2208 dy), B \u2208 B(Rk \u00d7 Y),\nY\n\nS\u0303\n\n(2.12)\nwhere Y := Rd\u2212k , \u03bc\u0303(x, y) is the vector of the first k components of \u03bc(x, y), and x 7\u2192 p(x|y)\nis the conditional density of X\u03030 given that Y0 = y. In this form the result might be\ngeneralizable to other stationary pairs (X\u0303, Y ). The process X\u0303 should remain piecewise\ndeterministic for given Y . But the process Y might take values in a more general space\nY. In this paper we will make no attempt to establish such an extension of our results.\n\n5\n\n\fTo prove Theorem 2.3, we will need an auxiliary result that requires some further\nnotation. First of all, for our purposes it will suffice that that result would hold in a\n\"local setting\", i.e. for S replaced with S \u2229 A, where A is a small enough open subset\nof Rd . As can easily be seen from the observation that we made after stating assumption\n(A.2) and from (A.4), if we understand by S such a \"small piece\" of the original surface,\nthen the following will be satisfied:\n(A.6) The surface S is connected and relatively compact, (2.4) holds with S \u2032 = S\nand \u03bdc := \u03bdc (S) < \u221e. Furthermore, there exists a u0 > 0 such that t+ (x) \u2265 u0 for all\nx \u2208 S and, for any u \u2208 [0, u0 ],\nSu := {q(x, u) : x \u2208 S}\nis a C 1 -surface with a continuous field {nu (x) : x \u2208 Su } of unit normals to it satisfying\n\b\ninf hnu (x), \u03bc(x)i : x \u2208 Su , u \u2208 [0, u0 ] > 0.\n(2.13)\n\nMoreover, \u03c0 has a density p in a neighbourhood of S(0,u0 ) , where\n[\nSI :=\nSu , I \u2282 R.\nu\u2208I\n\nNow denote by Ncu the stationary point process of the times of all continuous crossings\nof Su by X. For any C \u2208 B([0, \u221e) \u00d7 Rd ), let \u03a6uc (C) be the number of all s \u2208 Ncu such\nthat (s, Xs ) \u2208 C and \u03bdcu (B) := E\u03a6uc ([0, 1] \u00d7 B), B \u2208 B(Rd ).\nProposition 2.10. Under assumptions (A.1)\u2013(A.4) and (A.6), for any measurable\nfunction g : Rd \u2192 R+ , one has\nZ\nZ\nu\n|hn(x), \u03bc(x)i| g(x)p(x)Hd\u22121(dx)\n(2.14)\ng(x)\u03bdc (dx) =\nSu\n\nfor H1 -almost all u \u2208 [0, u0 ].\nProof. For any j \u2265 0 set Tj\u2032 := Tj \u2227 1 and, in particular, T0\u2032 := 0. For j \u2265 1 we define\n\u2032\nIj := (Tj\u22121\n, Tj\u2032),\n\n\u2032\n\u2032\n, t \u2212 Tj\u22121\n) : t \u2208 Ij }.\nLj := {Xt : t \u2208 Ij } = {q(XTj\u22121\n\nFix a B \u2208 B(Rd ) and assume that u \u2208 (0, u0 ). By definition, \u03a6uc (Ij \u00d7 B) > 0 if and only\nif Lj \u2229 Su \u2229 B 6= \u2205. On the other hand, (2.13) implies that \u03a6uc (Ij \u00d7 B) \u2264 1, so that\n\u03a6uc (Ij \u00d7 B) = 1{Lj \u2229 Su \u2229 B 6= \u2205}.\nTherefore\n\u03a6uc ((0, 1)\n\n\u00d7 B) =\n\n\u221e\nX\n\n1{Lj \u2229 Su \u2229 B 6= \u2205}\n\nj=1\n\nand, for any v \u2208 (0, u0),\nZ v\n\u221e Z\nX\nu\n\u03a6c ((0, 1) \u00d7 B) du =\n0\n\nj=1\n\n6\n\n0\n\nv\n\n1{Lj \u2229 Su \u2229 B 6= \u2205}du.\n\n(2.15)\n\n\fNow set\nJj (v) := {t \u2208 Ij : Xt \u2208 S(0,v) },\n\nUj (v) := {u \u2208 (0, v) : Lj \u2229 Su 6= \u2205}.\n\nClearly, the last two sets are either simultaneously empty or are open intervals of the\nsame length; in the latter case, put uj (v) := inf Uj (v). Therefore,\nZ v\nZ\n1{Lj \u2229 Su \u2229 B 6= \u2205}du =\n1{q(Xuj (v) , u \u2212 uj (v)) \u2208 B}du\n0\nUj (v)\nZ\nZ\n=\n1{Xt \u2208 B}dt =\n1{Xt \u2208 S(0,v) \u2229 B}dt, (2.16)\nJj (v)\n\nso that (2.15) becomes\nZ v\n\n\u03a6uc ((0, 1)\n\nIj (v)\n\n\u00d7 B) du =\n\n0\n\nZ\n\n1\n\n1{Xt \u2208 S(0,v) \u2229 B}dt.\n0\n\nTaking expectations on both sides of the last relation and using Fubini's theorem and\nstationarity of X, we obtain that\nZ v\nZ 1\nu\n\u03bdc (B)du = E\n1{Xt \u2208 S(0,v) \u2229 B}dt = P(X0 \u2208 S(0,v) \u2229 B).\n0\n\n0\n\nd\n\nAs functions of B \u2208 B(R ), both sides specify a measure, and so the standard argument\nshows that, for any measurable function g : Rd \u2192 R+ ,\nZ v Z\nZ\nu\ng(x)p(x)Hd (dx).\n(2.17)\ndu g(x)\u03bdc (dx) =\n0\n\nS(0,v)\n\nNow we can assume without loss of generality that S admits a C 1 -parametrization\n(w1 , . . . , wd\u22121 ) 7\u2192 z(w1 , . . . , wd\u22121 ), where (w1 , . . . , wd\u22121 ) varies in an open set W \u2282 Rd\u22121 .\nFor (w1 , . . . , wd\u22121 ) \u2208 W and u \u2208 [0, u0], define\n\u03c8(w1 , . . . , wd\u22121 , u) := q(z(w1 , . . . , wd\u22121 ), u),\nwhich, for a fixed u \u2208 [0, u0], will be a C 1 -parametrization of the \"parallel\" surface Su .\nNext we denote by \u2202i the operator of partial differentiation with respect to wi , i =\n1, . . . , d \u2212 1, and let \u2202d \u03c8 := \u2202/\u2202u. A simple linear algebra calculations shows that the\nJacobian J\u03c8 of \u03c8 = \u03c8(w1 , . . . , wd\u22121 , u) satisfies\n|J\u03c8| = |hnu (\u03c8), \u2202d \u03c8i| H \u2261 |hnu (\u03c8), \u03bc(\u03c8)i| H,\n\u0001\nwhere H 2 = H 2 (w1 , . . . , wd\u22121 , u) is the determinant of the matrix h\u2202i \u03c8, \u2202j \u03c8i i,j=1,...,d\u22121 .\nHowever, for any fixed u \u2208 [0, u0 ], H(w1 , . . . , wd\u22121 , u) dw1 * * * dwd\u22121 is the surface element\nof Su in the coordinates (w1 , . . . , wd\u22121 ), so that changing coordinates on the right-hand\nside of (2.17) yields\nZ\nZ\nd\ng(x)p(x)H (dx) =\ng(\u03c8)p(\u03c8) |J\u03c8| dw1 * * * dwd\u22121 du\nW \u00d7(0,v)\n\nS(0,v)\n\n=\n=\n\nZ\n\ng(\u03c8)p(\u03c8) |hnu (\u03c8), \u03bc(\u03c8)i| H dw1 * * * dwd\u22121 du\n\nW \u00d7(0,v)\nZ v Z\n\ndu\n\n0\n\ng(x)p(x) |hnu (x), \u03bc(x)i| Hd\u22121 (dx),\n\nSu\n\nwhich immediately implies the assertion of Proposition 2.10.\n7\n\n(2.18)\n\n\fRemark 2.11. Assume that f is a real-valued C 1 -function defined on an open domain\nD\u0303 \u2282 Rd , with non-vanishing gradient and such that Su = {x \u2208 D\u0303 : f (x) = u} for all small\nenough u. Such a function exists, at least for suitably small pieces of S. We may then\n\u2032\napply Federer's coarea theorem (see e.g. (7.4.15) in [1]) on each open interval (Tj\u22121\n, Tj\u2032 )\nto the level sets of the function t 7\u2192 f (Xt ). While this would provide an alternative way\nfor deriving (2.16), we have preferred to give a direct argument presented in the above\nproposition. In a quite similar spirit the coarea theorem can be used to derive Rice's\nformula for smooth processes, see Section 11.4 in [1]. It was actually U. Z\u00e4hle who first\nused in [12] the coarea theorem to prove Rice's formula for certain continuous processes.\nWe also note in passing that the coarea formula could be used to establish (2.18) as well.\nHowever, our more explicit argument yields additional information that is needed in the\nproof of Theorem 2.3.\nProof of Theorem 2.3. Since both sides of (2.10) are \u03c3-additive in B, it is no\nrestriction of generality to assume that assumption (A.6) is satisfied. Moreover, we can\nassume that S admits a smooth parametrization as in the proof of Proposition 2.10. This\nis due to the fact that the surface S can be represented as a \"mosaic\" of \"small pieces\"\nfor which the assumption will be satisfied owing to assumptions (A.1)\u2013(A.4) on the\noriginal S.\nFurthermore, it is not hard to see that, to prove the theorem, it suffices to demonstrate\nthat (2.14) holds at u = 0 for continuous and bounded g. We will show that by proving\nthat, under the assumption \u03c00 ((Rd \\ S) \u00d7 S) = 0, both sides of (2.14) are right-continuous\nat u = 0, as Proposition 2.10 will imply then the desired result. The case when only the\nsecond term on the left-hand side of (2.9) turns into zero (i.e. \u03c00 (S \u00d7 (Rd \\ S)) = 0) can\nbe dealt with in exactly the same way by establishing the left-continuity of both sides\nof (2.14) at u = 0 in this situation (essentially via a time-reversal argument).\nUsing the notation from the proof of Proposition 2.10 and setting\nhu (w) := hnu (\u03c8), \u03bc(\u03c8)ig(\u03c8)p(\u03c8),\n\nw = (w1 , . . . , wd\u22121 ),\n\n\u03c8 = \u03c8(w, u),\n\nwe have, for u \u2208 [0, u0],\nZ\nZ\nd\u22121\nhnu (x), \u03bc(x)ig(x)p(x)H (dx) = hu (w)H(w, u) Hd\u22121(dw).\n\n(2.19)\n\nSu\n\nAs noted after stating assumption (A.2), one has q \u2208 C 1 , and so nu (\u03c8(y, u)) is a continuous function of u, leading to\nh0+ (w) = hn(z(w)), \u03bc(z(w))ig(z(w))p(z(w)).\nSimilarly, as u \u2192\u0001 0+, H 2 (w, u) converges to the value of the determinant of the matrix\nh\u2202i z(w), \u2202j z(w)i i,j=1,...,d\u22121 . Now the dominated convergence theorem implies that (2.19)\nconverges to the right-hand side of (2.14) at u = 0.\nTo establish the desired right-continuity of the left-hand side of (2.14) we assume that\n(2.13) holds. Introduce the following point process \u03a6d on R+ \u00d7 Rd \u00d7 Rd :\n\u03a6d (*) :=\n\n\u221e\nX\n\n1{XTn \u2212 6= XTn }1{(Tn , XTn \u2212 , XTn ) \u2208 *}.\n\nn=1\n\n8\n\n\fLet u \u2208 [0, u0] and t \u2265 0. A continuous crossing of Su can only occur on a trajectory of X\nthat arrives at the surface from the inside of S(0,u) along an integral curve of \u03bc (cf. (2.13)).\nTherefore each such crossing of Su should be preceded by an entry to S[0,u) , either along a\ndrift line or by jump. Taking into account the possibility of having X0 \u2208 S[0,u) , we obtain\nthe bound\n\u0001\nNcu ([u, t + u]) \u2264 Nc ([0, t + u]) + \u03a6d [0, t + u] \u00d7 (Rd \\ S[0,u] ) \u00d7 S[0,u] + 1.\nTherefore\n\nZ\n\nt+u\n\ng(Xs )Ncu (ds)\n\n\u2264\n\nt+u\n\n(g(Xs ) + \u03b5(u))Nc (ds)\n\n0\n\u0002\n\u2217\n\nu\n\nwhere g \u2217 := supx g(x) and\n\nZ\n\n\u0001\n\u0003\n+ g \u03a6d [0, t + u] \u00d7 (Rd \\ S[0,u] ) \u00d7 S[0,u] + 1 ,\n\n\u03b5(u) := sup{|g(q(x, v)) \u2212 g(x)| : x \u2208 S, 0 \u2264 v \u2264 u} \u2192 0 as u \u2192 0+\n\n(2.20)\n\ndue to the uniform continuity of the mapping (x, u) 7\u2192 g(q(x, u)) on S \u00d7[0, u0 ], S denoting\nthe closure of S.\nNow taking expectations on both sides of the obtained inequality and using Campbell's\nformula (2.7) yields\nZ\nZ\n\u0001\nu\nt g(x)\u03bdc (dx) \u2264 (t + u) (g(x) + \u03b5(u))\u03bdc (dx) + g \u2217 (t + u)\u03c00 ((Rd \\ S[0,u] ) \u00d7 S[0,u] ) + 1 ,\nwhere we also used Campbell's theorem for \u03c00 (*) = E\u03a6d ([0, 1] \u00d7 *). After dividing by t\nand letting t \u2192 \u221e, we obtain\nZ\nZ\nu\ng(x)\u03bdc (dx) \u2264 g(x)\u03bdc (dx) + \u03b5(u)\u03bdc (S) + g \u2217 \u03c00 ((Rd \\ S[0,u] ) \u00d7 S[0,u] ).\nIn view of (2.20) and the fact that the assumption \u03c00 ((Rd \\ S) \u00d7 S) = 0 implies that\n\u03c00 ((Rd \\ S[0,u] ) \u00d7 S[0,u] ) \u2192 0 as u \u2192 0+, this leads to\nZ\nZ\nu\nlim sup g(x)\u03bdc (dx) \u2264 g(x)\u03bdc (dx).\nu\u21920+\n\nTo derive the converse inequality, we start with the observation that any continuous\ncrossing of S in [0, t] is followed either by a continuous crossing of Su or by a jump from\nS(0,u] to its complement within the time interval [0, t + u], so that\n\u0001\nNcu ([0, t + u]) \u2265 Nc ([0, t]) \u2212 \u03a6d [0, t + u] \u00d7 S(0,u] \u00d7 (Rd \\ S(0,u] ) \u2212 1.\nNext, similarly to our argument above, we obtain\nZ\nZ\nu\ng(x)\u03bdc (dx) \u2265 g(x)\u03bdc (dx) \u2212 \u03b5(u)\u03bdc (S) \u2212 g \u2217 \u03c00 (S(0,u] \u00d7 (Rd \\ S(0,u] )).\n\nSince limu\u21920+ S(0,u] = \u2205, it is clear that the continuity of \u03c00 implies now that\nZ\nZ\nu\nlim inf g(x)\u03bdc (dx) \u2265 g(x)\u03bdc (dx),\nu\u21920+\n\nwhich completes the proof of the theorem.\n9\n\n\f3\n\nExamples\n\nIn this section we will present two examples showing possible uses of our main result.\nExample 3.1. Consider a general queueing network model with d servers operating in\nstationary regime, with arrivals of customers (possibly in batches) to the network being\ngoverned by a stationary simple point process. Each customer, upon completion of its\nservice at node j \u2208 {1, . . . , d} of the network, proceeds to another node for further service\nor leaves the network, according to some routing mechanism. All the arrival, transition\nand departure times form a stationary point process N, and it is at these times that the\n(1)\n(d)\nstate of the process Xt = (Xt , . . . , Xt ) \u2208 Rd describing the residual workloads on the\nnodes can change by a jump. Between the events, the values of Xt decrease according to\nthe relation dtd Xt = \u03bc(Xt ) for some C 1 -function \u03bc : Rd \u2192 Rd\u2212 , so that the service rate at\nnode j can depend on the residual workload at the node and, moreover, it can even depend\non the workloads at other nodes i 6= j as well. To make this description compatible with\n(j)\nthe assumptions in Section 2, we allow Xt < 0 interpreting as the residual workload at\n(j)\nnode j at time t the value max{Xt , 0}, and let D := Rd .\nFor i \u2208 {1, . . . , d} let Si := {x = (x1 , . . . , xd ) \u2208 Rd : xi = 0}. Then the continuous\ncrossing of the surface Si corresponds to server i becoming idle. Let \u03bdi (B) denote the\nintensity of these crossings through a point in B \u2208 B(Rd ). Provided that the assumptions\nof Theorem 2.7 are satisfied, we obtain\nZ\nZ\n\u03bdi (B) = * * * 1B (xi ) |\u03bci (xi )| p(xi ) dx1 * * * dxi\u22121 dxi+1 * * * dxd ,\n(3.1)\nfor B \u2208 B(Rd ), where xi := (x1 , . . . , xi\u22121 , 0, xi+1 , . . . , xd ) and \u03bci is the ith component of\n\u03bc. The normalization of (3.1) yields the (Palm) distribution of the network at a typcial\ndeparture time from node i.\nNote that assumptions (A.1)\u2013(A.3) are rather mild and that Theorem 2.7 also requires \u03bci (x) < 0 for x \u2208 Si . In assumption (2.9) only the condition \u03c00 (Si \u00d7 (Rd \\ Si )) = 0\nis of relevance. This assumption says that if there is a jump at an instant when server i\nbecomes empty, then the workload of this server is not allowed to increase by this jump,\nneither by an internal transition (including feedback) nor by an external arrival. Again,\nthis is a rather weak assumption.\nS\nWe can also consider the \"composite surface\" S := i S(i) , where S(i) is the set of all\nx \u2208 Rd with xi = 0 and xj 6= 0 for j 6= i. (Under weak assumptions any continuous crossing of Si is also a continuous crossing of S(i) .) Theorem 2.7 provides the Palm distribution\nof the residual workloads at the time when one of the servers becomes idle while all the\nothers are still working. The probability of server i becoming idle given a typical instant\nwhen (exactly) one of the servers becomes idle is then given by \u03bdc (S(i) )/\u03bdc (S). We skip\nfurther details.\nExample 3.2. The classical stress release model in seismology (see e.g. [7] and references\nto earlier work therein) is a piecewise deterministic Markov process Xt representing the\nlevel of \"stress\" at a seismic fault at time t. The value Xt continuously increases at a\nlinear rate due to the tectonic loading of the fault and drops by random jumps when\nthe stress discharges by way of earthquakes that occur at random times whose intensity\nis given by \u03c8(Xt ) for some suitably chosen increasing risk function \u03c8 (e.g. \u03c8(x) = e\u03b2x\n10\n\n\ffor some \u03b2 > 0). Note that the remote measuring of stress levels at seismic faults is an\nextremely difficult problem, so the value Xt is usually not observable. All the information\non the process one can have access to is contained in the times, locations and magnitudes\nof jumps.\nA more interesting multinode analog of the model was discussed in [5], where it was\ndemonstrated, in particular, that already a two-node stress release network can reproduce\nthe famous Omori's law for the intensity of earthquake aftershocks.\nIn the multinode model, the values of the components of the random process Xt =\n(1)\n(d)\n(Xt , . . . , Xt ) \u2208 Rd represent the time t stress levels at individual seismic faults j \u2208\n{1, . . . , d} constituting a local fault system. Between jumps, the dynamics of the process\nare given by dtd Xt = \u03bc for a constant vector \u03bc \u2208 Rd , Note that one can have \u03bcj < 0 which\ncorresponds to tectonic unloading of stress at node j (of course, we can consider a more\ngeneral model with a variable \u03bc as well; similar remarks apply to all the other elements\nof the model construction). Jumps (\"seismic events\") occurrence at node j is driven by\na Markovian random mechanism with the probability of a jump occurring at the node in\nthe infinitesimal time interval dt given by \u03c8j (Xt\u2212 )dt for a given risk function \u03c8j (x).\nWhen the nth seismic event occurs at node j (say, at time Tj,n ), the value of stress at\nthe node changes by a random quantity \u03bej,n, n = 1, 2, . . . , which may be assumed to be\ni.i.d. random variables. Moreover, the stress levels at other nodes can also change at that\n(i)\n(i)\ninstance: for a given constant transfer matrix (rij ) \u2208 Rd\u00d7d , one has XTj,n = XTj,n \u2212 +rij \u03bej,n,\ni 6= j (for more detail, see [5]).\nOne of the main problems one hopes to be able to solve in mathematical seismology\nis to give advanced earthquake warnings. Within the framework of the multinode stress\nrelease model, P\nthat warning would have to be given at the time when the cumulative\n(j)\njump intensity dj=1 \u03c8(Xt ) exceeds a given threshold u > 0. That is, we are looking at\n\b\nP\ncontinuous crossings of the surface S := x : dj=1 \u03c8(xj ) = u by our process Xt . Our\nmain result allows to find the distribution of Xt at the (typical) time of such crossing and\nhence, for example, to derive the probability for a given fault to trigger the forthcoming\nseismic event.\nAcknowledgements. This research was supported by a grant of the German Science\nFoundation (DFG) and the ARC Centre of Excellence for Mathematics and Statistics of\nComplex Systems (MASCOS).\n\nReferences\n[1] Adler, R.J. and Taylor, J.E. (2007). Random Fields and Geometry. Springer,\nNew York.\n[2] Aza\u0131\u0308s, J.-M. and Wschebor, M. (2009). Level Sets and Extrema of Random\nProcesses and Fields. Wiley, Hoboken, NJ.\n[3] Baccelli, F. and Br\u00e9maud, P. (1994). Elements of Queueing Theory. Springer,\nBerlin.\n[4] Bar-David, I. and Nemirovsky, A. (1972). Level crossings of nondifferentiable\nshot processes. IEEE Trans. Inform. Theory, 18, 27-34.\n11\n\n\f[5] Borovkov, K. and Bebbington, M.S. (2003). A stochastic two-node stress transfer model reproducing Omori's law. Pure and Applied Geophysics, 160, 1429\u20131445.\n[6] Borovkov, K.A. and Last, G. (2008). On level crossings for a general class of\npiecewise-deterministic Markov processes. Advances in Applied Probability 40, 815\u2013\n834\n[7] Borovkov, K. and Vere-Jones, D. (2000). Explicit formulae for stationary distributions of stress release processes. Journal of Applied Probability 37, 2000, 315-321.\n[8] Hartman, P. (2002). Ordinary Differential Equations. 2nd edn, SIAM, Philadelphia.\n[9] Leadbetter, M.R. and Spaniolo, G.V. (2004). Reflections on Rice's formulae\nfor level crossings-history, extensions and use. ANZ J. Stat. 46, 173\u2013180.\n[10] Rice, S.O. (1944). Mathematical analysis of random noise. Bell System Tech. J. 24,\n46\u2013156.\n[11] Rychlik, I.(2000). On some reliability applications of Rice's formula for the intensity\nof level crossings. Extremes, 3, 331\u2013348.\n[12] Z\u00e4hle, U. (1984). A general Rice formula, Palm measures, and horizontal-window\nconditioning for random fields. Stochastic Process. Appl. 17, 265-283.\n\n12\n\n\f"}