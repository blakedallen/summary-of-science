{"id": "http://arxiv.org/abs/1011.1528v1", "guidislink": true, "updated": "2010-11-05T23:55:23Z", "updated_parsed": [2010, 11, 5, 23, 55, 23, 4, 309, 0], "published": "2010-11-05T23:55:23Z", "published_parsed": [2010, 11, 5, 23, 55, 23, 4, 309, 0], "title": "On twin and anti-twin words in the support of the free Lie algebra", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.1411%2C1011.5033%2C1011.2931%2C1011.3808%2C1011.1258%2C1011.6421%2C1011.5755%2C1011.0056%2C1011.2826%2C1011.0472%2C1011.5429%2C1011.5053%2C1011.0470%2C1011.3729%2C1011.1764%2C1011.5581%2C1011.1706%2C1011.5198%2C1011.4447%2C1011.5620%2C1011.6225%2C1011.5424%2C1011.1373%2C1011.1528%2C1011.4005%2C1011.0498%2C1011.0739%2C1011.2447%2C1011.4812%2C1011.0531%2C1011.4166%2C1011.4281%2C1011.0479%2C1011.3775%2C1011.3539%2C1011.1700%2C1011.6132%2C1011.2292%2C1011.5067%2C1011.3868%2C1011.0243%2C1011.4936%2C1011.1559%2C1011.3180%2C1011.6568%2C1011.1472%2C1011.1616%2C1011.0286%2C1011.6621%2C1011.4904%2C1011.3945%2C1011.0699%2C1011.1938%2C1011.0837%2C1011.3052%2C1011.4995%2C1011.2964%2C1011.3416%2C1011.5908%2C1011.0637%2C1011.3694%2C1011.6233%2C1011.3643%2C1011.0383%2C1011.6435%2C1011.3351%2C1011.2818%2C1011.4955%2C1011.2263%2C1011.5930%2C1011.6330%2C1011.3514%2C1011.3630%2C1011.4062%2C1011.0556%2C1011.2590%2C1011.3592%2C1011.4108%2C1011.1498%2C1011.6367%2C1011.5654%2C1011.0337%2C1011.5516%2C1011.3182%2C1011.1702%2C1011.6528%2C1011.6502%2C1011.2665%2C1011.0477%2C1011.3759%2C1011.2029%2C1011.5939%2C1011.2991%2C1011.3536%2C1011.3014%2C1011.1723%2C1011.2414%2C1011.3966%2C1011.5667%2C1011.2974%2C1011.5352&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On twin and anti-twin words in the support of the free Lie algebra"}, "summary": "Let $L_{K}(A)$ be the free Lie algebra on a finite alphabet $A$ over a\ncommutative ring $K$ with unity. For a word $u$ in the free monoid $A^{*}$ let\n$\\tilde{u}$ denote its reversal. Two words in $A^{*}$ are called twin (resp.\nanti-twin) if they appear with equal (resp. opposite) coefficients in each Lie\npolynomial. Let $l$ denote the left-normed Lie bracketing and $\\lambda$ be its\nadjoint map with respect to the canonical scalar product on the corresponding\nfree associative algebra. Studying the kernel of $\\lambda$ and using several\ntechniques from combinatorics on words and the shuffle algebra, we show that\nwhen $K$ is of characteristic zero two words $u$ and $v$ of common length $n$\nthat lie in the support of ${\\mathcal L}_{K}(A)$ - i.e., they are neither\npowers $a^{n}$ of letters $a \\in A$ with exponent $n > 1$ nor palindromes of\neven length - are twin (resp. anti-twin) if and only if $u = v$ or $u =\n\\tilde{v}$ and $n$ is odd (resp. $u = \\tilde{v}$ and $n$ is even).", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1011.1411%2C1011.5033%2C1011.2931%2C1011.3808%2C1011.1258%2C1011.6421%2C1011.5755%2C1011.0056%2C1011.2826%2C1011.0472%2C1011.5429%2C1011.5053%2C1011.0470%2C1011.3729%2C1011.1764%2C1011.5581%2C1011.1706%2C1011.5198%2C1011.4447%2C1011.5620%2C1011.6225%2C1011.5424%2C1011.1373%2C1011.1528%2C1011.4005%2C1011.0498%2C1011.0739%2C1011.2447%2C1011.4812%2C1011.0531%2C1011.4166%2C1011.4281%2C1011.0479%2C1011.3775%2C1011.3539%2C1011.1700%2C1011.6132%2C1011.2292%2C1011.5067%2C1011.3868%2C1011.0243%2C1011.4936%2C1011.1559%2C1011.3180%2C1011.6568%2C1011.1472%2C1011.1616%2C1011.0286%2C1011.6621%2C1011.4904%2C1011.3945%2C1011.0699%2C1011.1938%2C1011.0837%2C1011.3052%2C1011.4995%2C1011.2964%2C1011.3416%2C1011.5908%2C1011.0637%2C1011.3694%2C1011.6233%2C1011.3643%2C1011.0383%2C1011.6435%2C1011.3351%2C1011.2818%2C1011.4955%2C1011.2263%2C1011.5930%2C1011.6330%2C1011.3514%2C1011.3630%2C1011.4062%2C1011.0556%2C1011.2590%2C1011.3592%2C1011.4108%2C1011.1498%2C1011.6367%2C1011.5654%2C1011.0337%2C1011.5516%2C1011.3182%2C1011.1702%2C1011.6528%2C1011.6502%2C1011.2665%2C1011.0477%2C1011.3759%2C1011.2029%2C1011.5939%2C1011.2991%2C1011.3536%2C1011.3014%2C1011.1723%2C1011.2414%2C1011.3966%2C1011.5667%2C1011.2974%2C1011.5352&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let $L_{K}(A)$ be the free Lie algebra on a finite alphabet $A$ over a\ncommutative ring $K$ with unity. For a word $u$ in the free monoid $A^{*}$ let\n$\\tilde{u}$ denote its reversal. Two words in $A^{*}$ are called twin (resp.\nanti-twin) if they appear with equal (resp. opposite) coefficients in each Lie\npolynomial. Let $l$ denote the left-normed Lie bracketing and $\\lambda$ be its\nadjoint map with respect to the canonical scalar product on the corresponding\nfree associative algebra. Studying the kernel of $\\lambda$ and using several\ntechniques from combinatorics on words and the shuffle algebra, we show that\nwhen $K$ is of characteristic zero two words $u$ and $v$ of common length $n$\nthat lie in the support of ${\\mathcal L}_{K}(A)$ - i.e., they are neither\npowers $a^{n}$ of letters $a \\in A$ with exponent $n > 1$ nor palindromes of\neven length - are twin (resp. anti-twin) if and only if $u = v$ or $u =\n\\tilde{v}$ and $n$ is odd (resp. $u = \\tilde{v}$ and $n$ is even)."}, "authors": ["Ioannis C. Michos"], "author_detail": {"name": "Ioannis C. Michos"}, "author": "Ioannis C. Michos", "arxiv_comment": "24 pages (10pt) LaTeX file", "links": [{"href": "http://arxiv.org/abs/1011.1528v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1011.1528v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "17B01 (Primary), 68R15, 05E10 (Secondary)", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1011.1528v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1011.1528v1", "journal_reference": null, "doi": null, "fulltext": "On twin and anti-twin words in the support of the\nfree Lie algebra\nIoannis C. Michos\n\n\u2217\n\nDepartment of Mathematics, University of Ioannina,\n\narXiv:1011.1528v1 [math.CO] 5 Nov 2010\n\nGR-451 10, Ioannina, Greece\n\nAbstract\nLet LK (A) be the free Lie algebra on a finite alphabet A over a commutative ring K with unity.\nFor a word u in the free monoid A\u2217 let \u0169 denote its reversal. Two words in A\u2217 are called twin\n(resp. anti-twin) if they appear with equal (resp. opposite) coefficients in each Lie polynomial.\nLet l denote the left-normed Lie bracketing and \u03bb be its adjoint map with respect to the canonical\nscalar product on the free associative algebra KhAi. Studying the kernel of \u03bb and using several\ntechniques from combinatorics on words and the shuffle algebra (KhAi, +, ), we show that when\nK is of characteristic zero two words u and v of common length n that lie in the support of LK (A) i.e., they are neither powers an of letters a \u2208 A with exponent n > 1 nor palindromes of even length\n- are twin (resp. anti-twin) if and only if u = v or u = \u1e7d and n is odd (resp. u = \u1e7d and n is even).\n\n\u0001\n\nKeywords Free Lie algebras * Combinatorics on words * Shuffle algebra.\n\n1\n\nIntroduction\n\nLet A be a finite alphabet, A\u2217 be the free monoid on A, K be a commutative ring with unity and KhAi\nbe the free associative algebra on A over K. The elements of KhAi are polynomials on non-commuting\nvariables from A and coefficients from K. Given two polynomials P, Q \u2208 KhAi, their Lie bracket is\ndefined as [P, Q] = P Q \u2212 QP . In this way KhAi is given a Lie structure. It can be proved (see e.g.,\n[9, Theorem 0.5]) that the free Lie algebra LK (A) on A over K is equal to the Lie subalgebra of KhAi\ngenerated by A. Its elements will be called Lie polynomials. When K is the ring Z of rational integers,\nLK (A) is also known as the free Lie ring. The support of LK (A) is the subset of A\u2217 consisting of those\nwords that appear (with a nonzero coefficient) in some Lie polynomial. A pair of words (u, v) is called\ntwin (resp. anti-twin) if both words appear with equal (resp. opposite) coefficients in each Lie polynomial\nover K.\nLet m be a positive integer with m > 1 and Zm be the ring Z/(m) of integers mod m. M.-P.\nSch\u00fctzenberger had posed the following problems (see [9, \u00a71.6.1]; the last two were pointed to us in a\nprivate communication with G. Duchamp):\nProblem 1.1. Determine the support of the free Lie ring LZ (A).\nProblem 1.2. Determine the support of LZm (A).\nProblem 1.3. Determine all the twin and anti-twin pairs of words with respect to LZ (A).\nProblem 1.4. Determine all the twin and anti-twin pairs of words with respect to LZm (A).\nG. Duchamp and J.-Y. Thibon gave a complete answer to Problem 1.1 in [3] and proved that the\ncomplement of the support of LZ (A) in A\u2217 consists either of powers an of a letter a, with exponent\nn > 1, or palindromes (i.e., words u equal to their reversal \u0169) of even length. This result was extended\nin [2] - under certain conditions - to traces, i.e., partially commutative words and the corresponding free\npartially commutative Lie algebra (also known as graph Lie algebra).\nIn this article we continue the work carried out in [6] and answer Problem 1.3 by the following result.\n\u2217 E-mail\n\naddress: imichos@uoi.gr\n\n1\n\n\fTheorem 1.5. Two words u and v of common length n that lie in the support of the free Lie algebra\nover a ring K of characteristic zero, i.e., which are neither powers an of letters a \u2208 A with exponent\nn > 1 nor palindromes of even length, are twin (resp. anti-twin) if and only if u = v or u = \u1e7d and n is\nodd (resp. u = \u1e7d and n is even).\nThis had been already conjectured in [6]. There we had related Problems 1.1 up to 1.4 with the\nnotion of the adjoint endomorphism l\u2217 - denoted by \u03bb here, for brevity - of the left-normed (left to right)\nLie bracketing l in LK (A) with respect to the canonical scalar product on KhAi. Our starting point was\nthe simple idea that a word w does not lie in the support of LK (A) if and only if \u03bb(w) = 0 and a pair\n(u, v) of words is twin (resp. anti-twin) if and only if \u03bb(u) = \u03bb(v) (respectively \u03bb(u) = \u2212 \u03bb(v)). In view\nof these, to prove Theorem 1.5 it is enough to prove the following result, which had been stated as a\nconjecture [6, Conjecture 2.9].\nTheorem 1.6. Let \u03bb be the adjoint endomorphism of the left-normed Lie bracketing of the free Lie\nalgebra over a ring K of characteristic zero with respect to the canonical scalar product on KhAi and let\nu, v be words of common length n such that both \u03bb(u) and \u03bb(v) are non-zero. Then\n(i) \u03bb(u) = \u03bb(v) if and only if u = v or n is odd and u = \u1e7d.\n(ii) \u03bb(u) = \u2212\u03bb(v) if and only if n is even and u = \u1e7d.\nAs we had pointed out in [6, \u00a74] Problems 1.1 up to 1.4 may be restated as particular combinatorial\nquestions on the group ring KSn of the symmetric group Sn on n letters. The main idea is to view\na word w of length n on a fixed sub-alphabet B = {a1 , a2 , . . . , ar } of A as an ordered set partition of\n[n] = {1, 2, . . . , n} denoted by {w} = (I1 (w), I2 (w), . . . , Ir (w)), where for each k the set Ik (w) consists\nof the positions of [n] in which the letter ak occurs in w. If \u03bc = (\u03bc1 , \u03bc2 , . . . , \u03bcr ) is the multi-degree of\nw then {w} is just a \u03bc-tabloid, where \u03bc may be, without loss of generality, assumed an integer partition\nof n. The role of the reversal w\u0303 of w is then played by the tabloid \u03c4n * {w}, where \u03c4n is the involution\nk\nY\n(i, n \u2212 i + 1) of Sn with k = \u230an/2\u230b. Viewing each permutation as a word in n distinct letters, the\n\ni=1\n\nleft-normed multi-linear Lie bracketing ln = l(x1 x2 * * * xn ) and its adjoint \u03bbn = \u03bb(x1 x2 * * * xn ) can be\nviewed as elements of the group ring KSn ; the first one is known as the Dynkin operator. The right\npermutation action of \u03bbn on words is then equivalent to the left natural action of ln on tabloids; in\nparticular w * \u03bbn = 0 if and only if ln * {w} = 0. In this way all results and problems on words translate\nto the corresponding ones on tabloids. Theorem 1.6, in particular, has the following equivalent form.\nTheorem 1.7. Let \u03bc be a partition of n, ln be the Dynkin operator of the free Lie algebra over a ring\nK of characteristic zero and t1 , t2 be \u03bc-tabloids with both ln * t1 and ln * t2 different from zero. If \u03c4n\nn\n\u230aY\n2\u230b\ndenotes the involution\n(i, n \u2212 i + 1) of the symmetric group Sn then\ni=1\n\n(i) ln * t1 = ln * t2 if and only if t1 = t2 or n is odd and t1 = \u03c4n * t2 .\n(ii) ln * t1 = \u2212 ln * t2 if and only if n is even and t1 = \u03c4n * t2 .\nOur main objective is to prove Theorem 1.6. Studying the way \u03bb is affected by literal morphisms\nfrom an arbitrary finite alphabet to a two lettered one, we had also shown [6, Reduction Theorem 2.10]\nthat it suffices to work over an alphabet of two letters, so, without loss of generality, we may assume\nthat A = {a, b}.\nThe paper is organized as follows.\nIn \u00a72 we set up notation and the necessary background on combinatorics on words and free Lie\nalgebras. We then recall the main ideas of the work in [6]. The most important is the study of ker \u03bb\nwhich immediately connects Problems 1.1 up to 1.4 with the shuffle algebra. More precisely, ker \u03bb is\n\u22a5\nequal to the orthogonal complement LK (A) , which, when K is a commutative Q-algebra, is also equal,\nby a result originally due to R. Ree [8], to the K-span of proper shuffles (shuffles where both words are\nnon empty). The extra tool which had not been considered in [6] and plays a crucial role here is the\nfact that the map that sends an arbitrary polynomial to its right or left residual by a Lie polynomial is\na derivation in the shuffle algebra.\n2\n\n\fIn \u00a73 we present all the necessary results for calculating \u03bb(w). This is done recursively in two ways.\nOne may be viewed as a generalization, in terms of polynomials, of the Pascal triangle and leads to\nthe calculation of two certain arithmetic invariants of the polynomial \u03bb(w), namely the non-negative\nintegers e(w) and d(w). The other one is in terms of all factors u of w of fixed multi-degree and the\nshuffle product of words. The equation \u03bb(w) = \u00b1 \u03bb(w\u2032 ), after factoring out a common term of a certain\nform, finally leads us to a certain equation in the shuffle algebra. Rearranging its terms by collecting\nall non proper shuffles on the one side and all proper shuffles on the other, we immediately know that\nthe term consisting of non proper shuffles lies in ker \u03bb. This allows us to build some sort of inductive\nargument for the proof of Theorem 1.6. If all shuffles are proper we may first have to act on the left or\non the right by a suitable Lie polynomial.\nThe remainder of the paper deals directly with the proof of Theorem 1.6 where the above ideas will\nbe put in use. We argue inductively on the length of the corresponding words. This is done in a case by\ncase analysis. There are three main cases to study: (1) w = aub, w\u2032 = avb; (2) w = aub, w\u2032 = ava; and\n(3) w = aua, w\u2032 = ava. For case (1), which is dealt in \u00a74, we need nothing more but the definition of\nthe adjoint map \u03bb and the 1st and 2nd Theorem of Lyndon and Sch\u00fctzenberger. We deal with case (2)\nin \u00a76. It turns out that Case (3) further breaks up in four particular subcases, which are presented in\n\u00a75, 7, 8 and 9, respectively. These are glued together in \u00a710, which is the final touch of the proof.\n\n2\n\nPreliminaries\n\nWe start with some preliminaries on combinatorics on words (the standard reference is [5, \u00a71]). Let\nA = {a1 , a2 , . . . , aq } be a finite alphabet totally ordered by a1 < a2 < * * * < aq and A\u2217 denote the free\nmonoid on A. An element w of A\u2217 is a word w = x1 x2 * * * xn , i.e., a finite sequence of letters from A.\nIts length, denoted by |w|, is the number n of the letters in it. The empty word, denoted by \u01eb, is the\nempty sequence with length |\u01eb| = 0. The set of all non-empty words over A is denoted by A+ . If a \u2208 A\nand w \u2208 A\u2217 the number of occurrences of the letter a in w is denoted by |w|a . The set of distinct letters\nthat occur in a word w is denoted by alph(w). The multi-degree \u03b1(w) of w may be defined as the vector\n\u03b1(w) = (|w|a1 , |w|a2 , . . . , |w|aq ). The binary operation in A\u2217 is the concatenation product; if x, y \u2208 A\u2217\nthe product xy is the word which is constructed by concatenating x with y. A factor of a word w is a\nword u such that w = sut for some s, t \u2208 A\u2217 . It is called a right factor if t = \u01eb and is called proper if\nu 6= w. Left factors of a word w are defined in a similar manner. A word w \u2208 A+ is called primitive if it\ncan not be written in the form w = un for some u \u2208 A+ and n > 1. Two words x, y are conjugate if there\nexist words u, v such that x = uv and y = vu, i.e., they are cyclic shifts of one another. The reversal w\ne\nof a given word w = x1 x2 * * * xn is defined as w\ne = xn * * * x2 x1 . A word is called palindrome if w\ne = w.\nOur main tools from combinatorics on words will be the following two fundamental results due to\nLyndon and Sch\u00fctzenberger (see [5, \u00a71.3]).\nLemma 2.1 (1st Theorem of Lyndon and Sch\u00fctzenberger). Let x, y \u2208 A+ and z \u2208 A\u2217 . Then xz = zy\nd\nif and only if there exist u, v \u2208 A\u2217 and an integer d \u2265 0 such that x = uv, y = vu and z = u(vu) .\nLemma 2.2 (2nd Theorem of Lyndon and Sch\u00fctzenberger). Let x, y \u2208 A+ . Then xy = yx if and only\nif there exist z \u2208 A+ and integers m, n > 0 such that x = z m and y = z n .\nThe lexicographic order is a total order on A+ , also denoted by <, which is defined in the following\nway: For u, v \u2208 A+ we say that u < v if either v = uw for some w \u2208 A+ or if there exist x, y, z \u2208 A\u2217 and\na, b \u2208 A with a < b such that u = xay and v = xbz.\nA word w \u2208 A+ is called Lyndon (see [5, \u00a75.1]) if it is strictly smaller than any of its proper\nright factors with respect to the lexicographic order. We denote the set of all Lyndon words on A by\nLynd = Lynd(A). The standard factorization of a word w \u2208 Lynd \\ A is the unique pair (l, m) such that\nw = lm, where l, m \u2208 Lynd, l < m and m is of maximal length.\nP\nEach polynomial P \u2208 KhAi is written in the form P =\nw\u2208A\u2217 (P, w) w, where (P, w) denotes\nthe coefficient of the word w in P . Its support supp(P ) is the set of all w \u2208 A\u2217 with (P, w) 6= 0.\nP is called homogeneous of degree n (resp. multi-homogeneous of multi-degree (\u03b11 , \u03b12 , . . . , \u03b1q )) if each\nw \u2208 supp(P ) is of length n (resp. of multi-degree (\u03b11 , \u03b12 , . . . , \u03b1q )). The palindrome Pe of P is defined as\nP\nPe = w\u2208A\u2217 (P, w) w\u0303.\n3\n\n\fThe support of LK (A) is the subset SK (A) of A\u2217 defined as\nSK (A) = {w \u2208 A\u2217 : \u2203P \u2208 LK (A) with (P, w) 6= 0}.\n\n(2.1)\n\nIts complement in A\u2217 , i.e., the set of all words which do not appear in Lie polynomials over K, will be\ndenoted by VK (A). Two words u and v are called twin (respectively anti-twin) if (P, u) = (P, v) (resp.\n(P, u) = \u2212(P, v)) for each P \u2208 LK (A).\nThe set KhAi becomes a non-commutative associative algebra with unit equal to 1 = 1 \u01eb under the\nusual concatenation product defined as\nX\n(P Q, w) =\n(P, u)(Q, v).\n(2.2)\nw=uv\n\nGiven two polynomials P, Q \u2208 KhAi there is a canonical scalar product defined as\nX\n(P, Q) =\n(P, w)(Q, w),\n\n(2.3)\n\nw\u2208A \u2217\n\nin the sense that it is the unique scalar product on KhAi for which A\u2217 is an orthonormal basis.\nThe set KhAi becomes also a commutative associative algebra with unit 1 under the shuffle product\nthat is initially defined for words as \u01eb\nw = w\n\u01eb = w, if at least one of them is the empty word,\nand recursively as\n(bv \u2032 ) = a(u\u2032\n(bv \u2032 )) + b((au\u2032 )\nv \u2032 ),\n(2.4)\n(au\u2032 )\n\n\u0001\n\n\u0001\n\u0001\n\n\u0001\n\n\u0001\n\nif u = au\u2032 and v = bv \u2032 with a, b \u2208 A and u\u2032 , v \u2032 \u2208 A\u2217 (see [9, (1.4.2)]). It is then extended linearly to the\nwhole of KhAi by the formula\nX\nQ =\nv.\n(2.5)\n(P, u)(Q, v) u\nP\n\n\u0001\n\n\u0001\n\nu,v\u2208A\u2217\n\nIt is easily checked, initially for words, that\n\nThe shuffle product u\n\ng\ne Pe\nP\nQ = Q\n\n\u0001\n\nQ = Pe\nand P^\n\n\u0001 Q.e\n\n(2.6)\n\n\u0001 v of two words u and v is called proper if u, v \u2208 A\n\n+\n\n.\n\nThe right and the left residual of a polynomial P by another polynomial Q, denoted respectively by\nP \u2704 Q and Q \u2701 P , are the polynomials defined by the formulae\n(P \u2704 Q, w) = (P, Qw)\n\nand (Q \u2701 P, w) = (P, wQ),\n\n(2.7)\n\nfor each w \u2208 A\u2217 . The term right and left residual comes from the easily checked identities uv \u2704 u = v\nand u \u2701 vu = v, for each u, v \u2208 A\u2217 . For a fixed Q \u2208 KhAi the maps P 7\u2192 P \u2704 Q and P 7\u2192 Q \u2701 P\nare easily checked to be K-linear. Furthermore one can also check that P \u2704 (QR) = (P \u2704 Q) \u2704 R\nand P \u2704 1 = P . This shows that the right residual \u2704 is a right action of the algebra KhAi on itself.\nSimilarly one can also verify that (RQ) \u2701 P = R \u2701 (Q \u2701 P ) and 1 \u2701 P = P , so that the left residual\n\u2701 is a left action of the algebra KhAi on itself. The following result, which we first saw in an explicit\nform in [7], is crucial to our work.\nProposition 2.3. ([7, Lemma 2.1]) The right and the left residual by a Lie polynomial are derivations\nof the shuffle algebra, i.e., if P and Q are polynomials in KhAi and R is a Lie polynomial then we have\n\n\u0001\n\nQ) \u2704 R = (P \u2704 R)\n(P\nQ) = (R \u2701 P )\nR \u2701 (P\n\n\u0001\n\n\u0001 Q + P \u0001 (Q \u2704 R);\n\u0001 Q + P \u0001 (R \u2701 Q).\n\nProof. It suffices to show these identities when R is a homogeneous Lie polynomial of degree n. The\ncase n = 1 follows directly from (2.4) (cf. [9, p. 26]). For the induction step we set R = [R\u2032 , a], where\na \u2208 A and R\u2032 is a homogeneous Lie polynomial of degree n. Then the result follows since the right and\nthe left residual are respectively a right and a left action of KhAi on itself.\n4\n\n\fWe will also need the following two technical results.\nLemma 2.4. Let m, n \u2208 N. Then\na\n\nm\n\n\u0001 ba\n\nn\n\n=\n\n\u0013\nm \u0012\nX\nn+i\ni\n\ni=0\n\nam\u2212i ban+i .\n\nProof. By an easy induction on n.\nLemma 2.5. Let K be a commutative ring with unity and P be a non zero polynomial of multi-degree\n(n, m) in Kha, bi, where n, m \u2265 1. There exist unique non-negative integers d = d(P ) and e = e(P ) with\nd \u2264 e and unique polynomials Pd , . . . , Pe , with Pd 6= 0 and Pe 6= 0, such that P is written in the form\nP = Pd bad + * * * + Pe bae .\nProof. Let 0 6= P =\n\nX\n\nku u \u2208 Kha, bi. For each u \u2208 supp(P ) there exists a unique non negative\n\nu\u2208A+\ni\n\ninteger i such that u = vba . Using the notion of the left residual we get v = bai \u2701 u. Consider the finite\nset I = {i \u2265 0 : \u2203 u \u2208 supp(P ) with u = vbai }. For a fixed i \u2208 I define\nXi = {u \u2208 supp(P ) : \u2203 v \u2208\nS\n{a, b}\u2217 with u = vbai }. Clearly supp(P ) is equal to the disjoint union i\u2208I Xi . Then we obtain\nX X\nX\n\u0001\nku u =\nP =\nku (bai \u2701 u) bai .\nu\u2208supp(P )\n\nOur result follows if we choose Pi =\n\nX\n\ni\u2208I u\u2208Xi\n\nku (bai \u2701 u), d = min I and e = max I.\n\nu\u2208Xi\n\nIf we interchange the role of the letters a and b, the polynomial P can also be written uniquely in\nan analogous form. To distinguish the invariants d(P ) and e(P ) in this case from the default one of\nLemma 2.5 we note them as db (P ) and eb (P ). Now suppose that a word w lies in the support of the free\nLie algebra, i.e., \u03bb(w) 6= 0. In view of Lemma 2.5 we define d(w) = d(\u03bb(w)) and e(w) = e(\u03bb(w)).\nThe left-normed Lie bracketing of a word is the Lie polynomial defined recursively as\nl(\u01eb) = 0 ,\n\nl(a) = a ,\n\nand\n\nl(ua) = [l(u) , a] ,\n\n(2.8)\n\nfor each a \u2208 A and u \u2208 A+ . One can extend l linearly to KhAi and construct a linear map, denoted also\nby l, which maps KhAi onto the free Lie algebra LK (A), since the set {l(u) : u \u2208 A\u2217 } is a well known\nK-linear generating set of LK (A) (see e.g. [9, \u00a70.4.1]).\nWith any word w \u2208 Lynd, we associate its bracketed form, denoted by [w], which is a Lie polynomial\ndefined recursively as follows:\n(\na,\nif w = a, a \u2208 A;\n[w] =\n(2.9)\n[[l], [m]], if (l, m) is the standard factorization of w \u2208 Lynd \\ A .\nIt is well known (e.g., see [5, \u00a75.3]) that the set {[l] : l \u2208 Lynd} is a K-basis of LK (A) with the\ntriangular property\nX\n[l] = l +\naw w,\n(2.10)\nw\u2208A\u2217\n\nwhere aw \u2208 K, |w| = |l| and w > l.\nThe adjoint endomorphism l\u2217 of the left-normed Lie bracketing l, which will be denoted by \u03bb for\nbrevity, is then defined by the relation\n(\u03bb(u), v) = (l(v), u),\n\n(2.11)\n\nfor any words u, v. The image of \u03bb on a word of A \u2217 can also be effectively defined recursively by the\nrelations\n\u03bb(\u01eb) = 0 ,\n\u03bb(a) = a ,\nand\n\u03bb(aub) = \u03bb(au) b \u2212 \u03bb(ub) a ,\n(2.12)\n5\n\n\fwhere a, b \u2208 A and u \u2208 A\u2217 (cf. [5, Problem 5.3.2]). The proof goes by induction on the length of the\ngiven word, just as in the case of the adjoint endomorphism of the right-normed Lie bracketing (discussed\nin detail in [9, pp. 32 - 33]).\nOne can also extend \u03bb linearly to the whole of KhAi and construct a linear endomorphism of KhAi,\ndenoted also by \u03bb.\nProposition 2.6. ([6, Proposition 2.5]) Let K be a commutative ring with unity and l1 , l2 , . . . , lr be all\nthe Lyndon words of length n on the alphabet A. Then the set {\u03bb(l1 ), \u03bb(l2 ), . . . , \u03bb(lr )} is a K-basis of the\nimage under \u03bb of the n-th homogeneous component of KhAi.\nBy a straightforward induction on |w| we also have the following.\nLemma 2.7. ([6, Lemma 2.1]) Let w\u0303 denote the reversal of the word w. Then\n\u03bb(w\u0303) = (\u22121)|w|+1 \u03bb(w) .\nWhat is of crucial importance for Problems 1.1 up to 1.4 is the kernel ker \u03bb of \u03bb. Let P, Q \u2208 KhAi.\nWe say that P \u2261 Q if P \u2212 Q \u2208 ker \u03bb. We also define P \u223c Q if there exist k1 , k2 \u2208 K \u2217 = K \\ {0} such\n\u22a5\nthat k1 P \u2261 k2 Q. Let LK (A) denote the orthogonal complement of LK (A) with respect to the scalar\nproduct (2.3) in KhAi. Then for an arbitrary commutative ring K with unity the following hold.\nLemma 2.8. ([6, Lemmas 2.2 & 2.3])\n(i) ker \u03bb = LK (A)\u22a5 = VK (A).\n(ii) Two words u and v are twin (resp. anti-twin) with respect to LK (A) if and only if u \u2261 v (resp.\nu \u2261 \u2212 v).\nIn view of Lemma 2.8 (i), when K is of characteristic zero the notation u \u2261 0 means that u is either\na power an of a letter a \u2208 A with n > 1 or a palindrome of even length.\nThe following result, originally due to Ree [8], is crucial to our work.\nProposition 2.9. ([9, Theorem 3.1 (iv)], [5, Problem 5.3.4 ]) Let Q denote the field of rational numbers\nand assume that K is a commutative Q-algebra. Then a polynomial P \u2208 KhAi with zero constant term\nlies in LK (A)\u22a5 if and only if it is a K-linear combination of proper shuffles.\nIn view of Problems 1.1 up to 1.4 Sch\u00fctzenberger considered, for a given word w of length n, the\nunique non-negative generator \u03b3(w) of the ideal {(P, w) : P \u2208 LZ (A)} of Z (see [9, \u00a71.6.1]). He also\nposed the problem of determining the set of all words w with \u03b3(w) = 1. By (2.10) it follows that Lyndon\nwords have this property. We will show later on that there are other families of words with \u03b3(w) = 1 or\n\u03b3(w) odd; it turns out that this will be another important tool for Problem 1.3. The calculation of \u03b3(w)\nfor a given word w has been given by the following result.\nProposition 2.10. ([6, Theorem 2.6]) Let w be a word in A+ and \u03bb be the adjoint endomorphism of\nthe left-normed Lie bracketing l of the free Lie ring on A. If \u03bb(w) = 0 then \u03b3(w) = 0; otherwise it is\nequal to the greatest common divisor of the coefficients that appear in the monomials of \u03bb(w).\n\n3\n\nCalculation of \u03bb\n\nOur starting point is the following result for words of multi-degree (k, 1) with k \u2265 0.\nLemma 3.1. ([6, Lemma 2.8]) Let k and l be non-negative integers which are not both equal to zero.\nThen\n\u0012\n\u0012\n\u0013\n\u0013\nk k+l\nk k+l\n{bak+l \u2212 abak+l\u22121 }.\n\u03bb(bak+l ) = (\u22121)\n\u03bb(ak bal ) = (\u22121)\nk\nk\nUsing the shuffle product of words the polynomial \u03bb(w) can be calculated recursively in terms of all\nfactors u of fixed length r \u2265 1 of w.\n6\n\n\fProposition 3.2. ([6, Proposition 3.1]) Let w be a word and r be a positive integer with r \u2264 |w|.\nConsider the set of all factors u of length r of w. Then\nX\n\u03bb(u) (\u22121)|s| {s\u0303\n\u03bb(w) =\nt} .\n\n\u0001\n\nw=sut\n|u|=r\n\nThe case where the factors u of the word w are letters (i.e., we are at the bottom level r = 1) seems\nto be known in a different setting in the literature (see [4, Lemma 2.1], cf. [1, Ex. 4.6.5 (2), p.126]) even\nfor the broader class of free partially commutative Lie algebras.\nDecomposing further the factors u up to multi-degree we obtain\nX\nX\nt} .\n(3.1)\n\u03bb(w) =\n\u03bb(u) (\u22121)|s| {s\u0303\n\n\u0001\n\nw=sut\n|u|=r\n\n\u03b1(u)=(k1 ,k2 ,...,kq )\nk1 +k2 +***+kq =r\n\nDealing now with the equation w \u2261 \u00b1 w\u2032 or more generally with the equation w \u223c w\u2032 , we obtain\nthe following result.\nProposition 3.3. Suppose that w and w\u2032 are two words of given multi-degree (m1 , m2 , . . . , mq ) on an\nalphabet with q letters such that \u03b7 \u03bb(w) = \u03b7 \u2032 \u03bb(w\u2032 ), for some \u03b7, \u03b7 \u2032 \u2208 Z. Then for all factors of a fixed\nmulti-degree (k1 , k2 , . . . , kq ) we obtain\nX\nX\n\u2032\n\u03b7\nt} = \u03b7 \u2032\nt\u2032 } .\n(3.2)\n\u03bb(u) (\u22121)|s| {s\u0303\n\u03bb(u\u2032 ) (\u22121)|s | {se\u2032\n\n\u0001\n\n\u0001\n\nw\u2032 =s\u2032 u\u2032 t\u2032\n\u03b1(u\u2032 )=(k1 ,k2 ,...,kq )\n\nw=sut\n\u03b1(u)=(k1 ,k2 ,...,kq )\n\n\u0001\n\nProof. The polynomials \u03bb(u) and s\u0303\nt are multi-homogeneous, so in view of (3.1), a typical monomial\nthat appears in \u03bb(w) is of the form \u03b7x,y x * y, where x is a word of multi-degree (d1 , d2 , . . . , dq ) appearing\nt and \u03b7x,y \u2208 Z.\nin \u03bb(u), y is a word of multi-degree (m1 \u2212 d1 , m2 \u2212 d2 , . . . , mq \u2212 dq ) appearing in s\u0303\n\u2032\nSimilarly a typical monomial in \u03bb(w\u2032 ) is of the form \u03b7x,y x\u2032 * y \u2032 , where x\u2032 is a word of multi-degree\n(e1 , e2 , . . . , eq ) appearing in \u03bb(u\u2032 ), y is a word of multi-degree (m1 \u2212 e1 , m2 \u2212 e2 , . . . , mq \u2212 eq ) appearing\n\u2032\n\u2032\nin s\u0303\u2032\nt\u2032 and \u03b7x,y \u2208 Z. Since |u| = |u\u2032 |, the only possible way that the terms \u03b7x,y x * y and \u03b7x,y x\u2032 * y \u2032\ncancel each other out in the equality \u03bb(w) = \u00b1 \u03bb(w\u2032 ) is that \u03b1(x) = \u03b1(x\u2032 ) and \u03b1(y) = \u03b1(y \u2032 ). Thus we\nmust have di = ei , for each i = 1, 2, . . . , q. Then for factors of a fixed multi-degree the result follows.\n\n\u0001\n\n\u0001\n\nSuppose now that our given words w, w\u2032 are over a two lettered alphabet A = {a, b}. Fix a multidegree (k, l) and consider all factors u and u\u2032 of w and w\u2032 respectively with \u03b1(u) = \u03b1(u\u2032 ) = (k, l).\nIf at least one of k, l is equal to 1 - i.e., one of the letters a, b appears once - or k = l = 2 then the\ncorresponding terms \u03bb(ak b), \u03bb(bl a) and \u03bb(a2 b2 ) will factor out of (3.2). This is due to Lemma 3.1 and\nthe easily checked equality \u03bb(abab) = \u22122\u03bb(a2 b2 ) = 2\u03bb(b2 a2 ) = \u2212\u03bb(baba), respectively. In this way we\nobtain an equality in the shuffle algebra that looks like\nX\ni\n\n\u03b7i (\u22121)|si | {sei\n\n\u0001t} =\ni\n\nX\ni\n\n\u2032\n\n\u2032\n\n\u2032\n\u2032\n\u03b7i (\u22121)|si | {sei\n\n\u0001 t },\n\u2032\n\ni\n\n(3.3)\n\nfor some integer coefficients \u03b7i and \u03b7i . From this point and on we either use Proposition 2.9 directly or\nin more difficult situations where all shuffles are proper we act on the left or on the right accordingly by\nsuitable Lie polynomials using Proposition 2.3.\nThe following result is a recursive formula for the calculation of \u03bb(w) which is strongly related to the\nPascal triangle.\nProposition 3.4. Let k, l be non negative integers. Then\n\u03bb(ak bubal )\n\n=\n\n(\u22121)k+1\n\n\u0013\nl \u0012\nX\nk+i\n\u03bb(ubal\u2212i ) bak+i\ni\ni=0\n\n7\n\n+\n\nk\nX\nj=0\n\n(\u22121)j\n\n\u0012\n\u0013\nl+j\n\u03bb(ak\u2212j bu) bal+j .\nj\n\n\fProof. This result is essentially the same as [6, Proposition 5.4]; it had been stated there in a commutative\nalgebra setting using the notion of Pascal descent polynomials. For completeness, we give a proof.\nWithout loss of generality we may assume that k \u2264 l. The case where k = l = 0 follows trivially as\nit is equivalent to \u03bb(bub) = \u03bb(bu)b \u2212 \u03bb(ub)b. The case k = 0 < l is written as\n\u03bb(bubal ) = \u2212\n\nl\nX\n\n\u03bb(ubal\u2212i ) bai + \u03bb(bu)bal ,\n\n(3.4)\n\ni=0\n\nand follows by an immediate induction on l.\nSuppose that 0 < k \u2264 l. Then the induction is a bit more tedious and is done on k + l = m.\nFor m = 2, i.e., k = l = 1 the result follows trivially. Suppose that it holds for all pairs (k \u2032 , l\u2032 ) with\n1 \u2264 k \u2032 \u2264 l\u2032 and k \u2032 + l\u2032 \u2264 m \u2212 1. In particular, it holds for the pairs (k \u2212 1, l) and (k, l \u2212 1). We will\nshow that it will also hold for the pair (k, l) with 1 \u2264 k \u2264 l and k + l = m. For brevity let w = ak bubal .\n\u03bb(w)\n\n= \u03bb(ak bubal\u22121 ) a \u2212 \u03bb(ak\u22121 bubal ) a\n\u0012\n\u0013\n\u0013\nk\nl\u22121 \u0012\nX\nX\nl\u22121+j\nk+i\n\u03bb(ak\u2212j bu) bal\u22121+j+1\n(\u22121)j\n\u03bb(ubal\u22121\u2212i ) bak+i+1 +\n= (\u22121)k+1\nj\ni\nj=0\ni=0\n\u2212(\u22121)k\u22121+1\n\n\u0012\n\u0013\n\u0013\nk\u22121\nl \u0012\nX\nX\nl+j\nk\u22121+i\n\u03bb(ak\u22121\u2212j bu) bal+j+1\n(\u22121)j\n\u03bb(ubal\u2212i ) bak\u22121+i+1 \u2212\nj\ni\nj=0\ni=0\n\n\u0013\n\u0013\nl \u0012\nl\u22121 \u0012\no\nnX\nX\nk\u22121+i\nk+i\n\u03bb(ubal\u2212i ) bak+i\n\u03bb(ubal\u22121\u2212i ) bak+i+1 +\ni\ni\ni=0\ni=0\n\u0012\n\u0013\n\u0012\n\u0013\nk\u22121\nk\nX\nX\nl+j\nl\u22121+j\n\u03bb(ak\u22121\u2212j bu) bal+j+1\n(\u22121)j+1\n\u03bb(ak\u2212j bu) bal+j +\n(\u22121)j\n+\nj\nj\nj=0\nj=0\n\n= (\u22121)k+1\n\n\u0013 \u0012\n\u0013\n\u0012\n\u0013\nl h\u0012\no\nnX\nk+i\u22121\nk\u22121+i i\nk\u22121+0\n+\n\u03bb(ubal\u2212i ) bak+i +\n\u03bb(ubal\u22120 ) bak+0\ni\u22121\ni\n0\ni=1\n\u0012\n\u0013\nk\nh\u0012l \u2212 1 + j \u0013 \u0012l + j \u2212 1\u0013i\no\nnX\nl\u22121+0\n+\n(\u22121)j\n\u03bb(ak\u22120 bu) bal+0\n\u03bb(ak\u2212j bu) bal+j + (\u22121)0\n+\nj\u22121\nj\n0\nj=1\n\n= (\u22121)k+1\n\n\u0012\n\u0013\n\u0012\n\u0013\no\nk+i\nk+0\n\u03bb(ubal\u2212i ) bak+i +\n\u03bb(ubal\u22120 ) bak+0\ni\n0\ni=1\n\u0012\n\u0012\n\u0013\n\u0013\nk\no\n\bX\nk\u2212j\nl+j\n0 l+0\nj l+j\n\u03bb(ak\u22120 bu) bal+0\n\u03bb(a bu) ba\n+ (\u22121)\n(\u22121)\n+\n0\nj\nj=1\n\n= (\u22121)k+1\n\n= (\u22121)k+1\n\nl\n\bX\n\n\u0013\nl \u0012\nX\nk+i\n\u03bb(ubal\u2212i ) bak+i\ni\ni=0\n\n+\n\nk\nX\nj=0\n\n(\u22121)j\n\n\u0012\n\u0013\nl+j\n\u03bb(ak\u2212j bu) bal+j ,\nj\n\nas required.\nCorollary 3.5. Suppose that k \u2264 l. Then\n\u03bb(ak bubal ) = Pk+l bak+l + Pk+l\u22121 bak+l\u22121 + * * * + Pk+1 bak+1 + Pk bak ,\n\nPk+l\n\nPk+l\u22121\n\n=\n\n=\n\n\u0012\n\u0013\n\uf8f1\n\uf8f2(\u22121)k k + l {\u03bb(bu) \u2212 \u03bb(ub)}, if bub 6\u2261 0\nk\n\uf8f3\n0,\nif bub \u2261 0;\n\uf8f1\n\u0012\n\u0013\nn\u0012k + l \u2212 1\u0013\no\nk+l\u22121\n\uf8f4\nk\u22121\n\uf8f4\n\u03bb(uba)\n+\n\u03bb(abu) ,\n(\u22121)\n\uf8f4\n\uf8f4\n\uf8f4\nl\u0013\n\u22121\nl\n\uf8f4\n\u0012\n\uf8f2\nk\u22121 k + l\n\u03bb(abu),\n(\u22121)\n\uf8f4\nk\n\uf8f4\n\u0012\n\u0012\n\u0013\n\uf8f4\nn k + l \u2212 1\u0013\n\uf8f4\nk+l\u22121 o\n\uf8f4\nk\u22121\n\uf8f4\n\u2212\n(\u22121)\n\u03bb(abu),\n\uf8f3\nl\nl\u22121\n8\n\nwhere\n\n(3.5)\n\nif bub 6\u2261 0\nif u = bm , m odd,\nif bub = ss\u0303, s \u2208 A\u2217 ;\n\n(3.6)\n\n\fPk+1\nPk\n\n=\n=\n\n(\n\n(\n\n(\u22121)k+1 (k + 1) \u03bb(ubal\u22121 ),\n(k + 1) {(\u22121)k+1 \u03bb(ubak\u22121 ) \u2212 \u03bb(ak\u22121 bu)},\n(\u22121)k+1 \u03bb(ubal ),\n(\u22121)k+1 \u03bb(ubak ) + \u03bb(ak bu),\n\nif k < l\nif k = l;\n\n(3.7)\n\nif k < l\nif k = l.\n\n(3.8)\n\nProof. It follows as an immediate consequence of Proposition 3.4.\nCorollary 3.6. Let k and l be non negative integers with k \u2264 l and k, l not both equal to zero. If ak bubal\nis a word which is not(a palindrome of even length then\nk + l,\nif bub 6\u2261 0\ne(ak bubal ) =\nk + l \u2212 1, if bub \u2261 0;\n\nd(ak bubal )\n\n\uf8f1\n\uf8f4\n\uf8f4k,\n\uf8f4\n\uf8f2k + 1,\n=\n\uf8f4k,\n\uf8f4\n\uf8f4\n\uf8f3\n\u2265 k + 1,\n\nif\nif\nif\nif\n\nk\nk\nk\nk\n\n<l\n<l\n=l\n=l\n\nand\nand\nand\nand\n\nubal 6\u2261 0\nubal \u2261 0\nk+1\n(\u22121)\nubak + ak bu 6\u2261 0\nk+1\n(\u22121)\nubak + ak bu \u2261 0.\n\nProof. It follows directly from Corollary 3.5.\nm\n\nLemma 3.7. Let k \u2265 1 and m \u2265 0. Then \u03b3(b(a2k b2 ) ) = 1.\nProof. We argue by induction on m. For m = 0 it is trivial to check that \u03b3(b) = 1. For the inducm+1\nm+1\nm\nm+1\ntion step we get \u03bb(b(a2k b2 )\n) = \u2212\u03bb((a2k b2 )\n)b, since b(a2k b2 ) a2k b \u2261 0. Then \u03bb((a2k b2 )\n)=\n2k 2 m 2k\n2k\u22121 2 2k 2 m\n2k 2 m 2k\n\u03bb((a b ) a b)b \u2212 \u03bb(a\nb (a b ) )a. It is enough to show that \u03b3((a b ) a b) = 1. By Lemma 2.7\nand (3.4) we obtain\n2k\u22121\nX\n\u0001\nm\u22121 2 2k\u2212i \u0001 i\nm\u0001\nm\nba .\n\u03bb a2k (b2 a2k )\nb a\n\u03bb b(a2k b2 ) a2k = \u03bb b(a2k b2 ) a2k \u2212\n\n(3.9)\n\ni=0\n\n\u0001\nm\nm\nBy our induction hypothesis \u03b3((b2 a2k ) b) = 1, therefore it clearly follows that \u03b3 b(a2k b2 ) a2k = 1, as\nrequired.\nm\n\nLemma 3.8. Let m \u2265 0 and k \u2265 2. Then \u03b3((ba2 ba2k ) b) is odd.\nProof. For m = 0 this holds as \u03b3(b) = 1. Let m = 1. Collecting all factors of ba2 ba2k b of multi-degree\n(2k, 2) we observe that the only term that appears in (3.1) is \u03bb(ba2 ba2k\u22122 ) * a2 b, so it suffices to show\nthat \u03b3(ba2 ba2k\u22122 ) is odd. If k > 2 then a2k\u22122 ba2 b \u2208 Lynd, hence \u03b3(ba2 ba2k\u22122 ) = 1. On the other\nhand, if k = 2 we obtain \u03bb(ba2 ba2 ) = \u2212 \u03bb(a2 ba) {b a} + \u03bb(aba2 ) ab = \u2212 \u03bb(a2 ba) (2ab + ba) =\n\u22123\u03bb(ba3 ) (2ab + ba), hence by Lemma 3.1 we get \u03b3(ba2 ba2 ) = 3.\nm\u22121\nLet now m \u2265 2. Arguing by induction on m, we assume that \u03b3((ba2 ba2k )\nb) is\n\u0001 odd. Using (3.1)\nm\nwe collect all factors of (ba2 ba2k ) b of multi-degree (m \u2212 1)(2k + 2), 2(m \u2212 1) + 1 . All such factors\ncontribute\nm\u22121\n\u03bb((ba2 ba2k )\nb) * {a2 ba2k b \u2212 a2 b a2k b + a2k ba2 b},\n(3.10)\n\n\u0001\n\n\u0001\n\n\u0001\n\nhence we have to show that the non zero coefficients of the polynomial P = a2 ba2k b \u2212 a2 b a2k b +\na2k ba2 b can not all be even. It is enough to check this on its reversal Pe and furthermore on Pe \u2704 b. By\n2k\n2k 2\n2\ne\nba2k \u2212 a2k ba2 + a2 ba\n(2.6) and Proposition\u0001 2.3 we get\n\u0001 . By Lemma 2.4\n\u0001 P \u2704 b = a ba \u2212 a\n2+1\n2k\n2\n2k\u22121 3\n2k\n2k\u22121 3\n2\na\nba , a\nba = 1 = 3, an odd number, whereas a\nba , a\nba = 0, since k \u2265 2.\n2k\u22121 3\ne\nHence (P \u2704 b, a\nba ) = \u22123 and the proof is completed.\n\n\u0001\n\n\u0001\n\n9\n\n\u0001\n\n\u0001\n\n\f4\n\nThe case aub \u2261 \u00b1 avb.\n\nFor the plus case our objective is to show that u = v, whereas in the minus case we must get a\ncontradiction. Starting from the equality \u03bb(aub) = \u00b1 \u03bb(avb) and using (2.12) we obtain\n\u0001\n\u0001\n\u03bb(au) \u2213 \u03bb(av) b = \u03bb(ub) \u2213 \u03bb(vb) a.\n(4.1)\nIt follows that\n\nau \u2261 \u00b1 av\n\nand\n\nub \u2261 \u00b1vb .\n\n(4.2)\n\nClearly aub 6\u2261 0, hence we can not have au \u2261 ub \u2261 0. Set |u| = |v| = r.\nA. aub \u2261 avb. Suppose that r is odd. Assume that au 6\u2261 0. Then |au| = |av| = r + 1 and r + 1\nis even, so by (4.2) (with the plus sign) and our induction hypothesis we get au = av, hence u = v as\nrequired. If au \u2261 0 then we necessarily have ub 6\u2261 0 and reobtain u = v.\nLet now r be even. Assume that au \u2261 0. Then r + 1 is odd, so in view of (4.2) our induction\nhypothesis yields au = av = ar+1 , so that u = v = ar . Similarly, if ub \u2261 0 we obtain u = v = br .\nTo conclude this case suppose that both au 6\u2261 0 and ub 6\u2261 0. By our induction hypothesis we obtain\n(\nau = av or au = \u1e7da\n(4.3)\nub = vb or ub = b\u1e7d.\nIf at least one of the equalities au = av or ub = vb holds we immediately get u = v. Therefore, the only\nnon trivial subcase in (4.3) is the combination\nau = \u1e7da\n\nand\n\nub = b\u1e7d .\n\n(4.4)\n\nThen we obtain\naub = (au)b = (\u1e7da)b = \u1e7dab\n\n(4.5)\n\n= a(ub) = a(b\u1e7d) = ab\u1e7d.\n\n(4.6)\n\nIt follows that ab\u1e7d = \u1e7dab, i.e., the words ab and \u1e7d commute, hence by Lemma 2.2 they are both powers\nn\nn\nof the same word. Since ab is primitive we get \u1e7d = (ab) , hence v = (ba) for some n \u2265 1. In view of\nn\nn\u22121\nn\u22121\nn\n(4.4) we get au = (ab) a = ab(ab)\na. It follows that u = b(ab)\na = (ba) and therefore u = v,\nas required.\nB. aub \u2261 \u2212 avb. Suppose that r is even. Without loss of generality we may assume that au 6\u2261 0.\nThen we can not have au \u2261 \u2212 av due to our induction hypothesis.\nSuppose that r is odd. If both au 6\u2261 0 and ub 6\u2261 0 then by (4.2) (with the minus sign) and our\nn\ninduction hypothesis we reobtain (4.4). Following the lines of Case A we reobtain \u1e7d = (ab) for some\nn \u2265 1. Then |v| = 2n which contradicts our assumption that r is odd.\nSuppose finally that, without loss of generality, au 6\u2261 0 and ub \u2261 0. On the one hand (4.2) and our\ninduction hypothesis yield au = \u1e7da, and on the other both ub and vb are palindromes of even length.\nThen there exists s \u2208 A\u2217 such that u = sa, v = s\u0303a, sab = bas\u0303 and s\u0303ab = bas. Combining all these we\nobtain\nsabab = (sab)ab = (bas\u0303)ab = ba(s\u0303ab) = ba(bas) = babas.\n(4.7)\nIt follows that (baba)s = s(abab), so by Lemma 2.1 there exist p, q \u2208 A\u2217 such that baba = pq, abab = qp\nn\nand s = p(abab) for some integer n \u2265 0. There are two possibilities for the factor p; either p = b or\np = bab. In both cases |s| - and consequently |sab| - is an odd positive integer, contradicting the fact\nthat ub is a palindrome of even length.\n\n5\n\nThe case ak bubal \u2261 \u00b1 ak bvbal 6\u2261 0.\n\nLet w1 = ak bubal , w2 = ak bvbal and |u| = |v| = r. Multiplying both sides of (3.5) by b we obtain\nbub \u2261 \u00b1bvb.\n10\n\n(5.1)\n\n\fSuppose that k = l. Then since w1 , w2 6\u2261 0, we either get u = v = br with r odd, or bub, bvb 6\u2261 0. In\nthe former case w1 \u2261 w2 immediately yields u = v, hence w1 = w2 , as required. On the other hand\nw1 \u2261 \u2212 w2 yields 2 w1 \u2261 0, a contradiction. For the latter, if w1 \u2261 w2 and r is odd then our induction\nhypothesis implies u = v, thus w1 = w2 , whereas if r is even we might also get v = \u0169, thus w2 = w\nf1 . On\nthe other hand, when w1 \u2261 \u2212 w2 we necessarily get r even and v = \u0169 reobtaining w2 = w\nf1 , as required.\nSuppose that k 6= l. Without loss of generality we may assume that k < l. Then (3.8) and (3.7)\nrespectively yield\nubal\n\n\u2261\n\n\u00b1vbal\n\n(5.2)\n\nl\u22121\n\n\u2261\n\n\u00b1vbal\u22121 .\n\n(5.3)\n\nuba\n\nSuppose that bub \u2261 0 \u2261 bvb. If r is odd then u = v = br , so that if w1 \u2261 w2 we get the trivial solution\nw1 = w2 , whereas if w1 \u2261 \u2212 w2 we get 2 w1 \u2261 0, a contradiction.\nIf r is even we have u = ss\u0303 and v = tt\u0303 for s, t \u2208 A\u2217 . Consider the case w1 \u2261 w2 . If l is odd then\n|ss\u0303bal | is even, so, in view of our induction hypothesis, (5.2) (with the plus sign) yields u = v. The same\nresult follows similarly by (5.3) when l is odd. For the case w1 \u2261 \u2212 w2 we work in the same manner. If\nl is odd (resp. even) then |ss\u0303bal\u22121 | (resp. |ss\u0303bal |) is odd, so (5.3) (resp. (5.2)) with the minus sign and\nour induction hypothesis yield a contradiction.\nSuppose that bub 6\u2261 0 and bvb 6\u2261 0. Let w1 \u2261 w2 . If r is even then (5.1) reads bub \u2261 bvb, so our\ninduction hypothesis yields u = v. If r is odd we might have v = \u0169. If l is odd then |ubal | is also odd\nand (5.2) reads ubal \u2261 \u0169bal . Our induction hypothesis then implies that u = \u0169 directly or it yields\nd\nal bu = ubal . In the latter case Lemma 2.1 gives u = al (bal ) , for some d \u2265 0, so that we reobtain u = \u0169.\nIf l is even we end up with the same result working similarly with (5.3).\nFinally let w1 \u2261 \u2212 w2 . Then (5.1) reads bub \u2261 \u2212 bvb, so our induction hypothesis implies that r\nis necessarily even and v = \u0169. If l is even then |ubal | is odd, so that (5.2), which reads ubal \u2261 \u2212 \u0169bal\nand our induction hypothesis yield a contradiction. Similarly we get a contradiction with (5.3) (with the\nminus sign) when l is odd.\n\n6\n\nThe case aub \u2261 \u00b1 ava.\n\nBy definition \u03bb(aub) = \u00b1 \u03bb(ava), hence by (2.12) it follows that\n\u0001\n\u03bb(au)b \u2212 \u03bb(ub)a = \u00b1 \u03bb(av)a \u2212 \u03bb(va)a .\n\n(6.1)\n\nThen we necessarily obtain \u03bb(au) = 0, so either u = an , for some n \u2265 1, or |u|b \u2265 1 and au is a\npalindrome of even length.\nk n+1\u2212k\nIn the former case aub = an+1 b \u0012and ava\n, for some integer k such that 1 \u2264 k \u2264 n. By\n\u0013 = a ba\nk n+1\nn+1\n\u03bb(ba\n) and by Lemma 2.7 \u03bb(an+1 b) = (\u22121)n+3 \u03bb(ban+1 ),\nLemma 3.1 we get \u03bb(ava) = (\u22121)\nk\n\u0012\n\u0013\nn+1\nso that we finally obtain\n= \u00b11, a clear contradiction, since k 6= 0 and k 6= n + 1.\nk\nLet us now suppose that au \u2261 0 and |u|b \u2265 1, i.e.,\nak bss\u0303bak b \u2261 \u00b1 al btbam ,\n\u2217\n\n(6.2)\n\nfor s, t \u2208 A , k, l and m positive integers with l \u2264 m, without loss of generality.\nFirst consider the case |t|a = 0. Counting the number of occurrences of the letter a in (6.2) we get\n2k + 2 |s|a = l + m, so that l + m \u2265 2k. By Corollary 3.6 we have e(ak bss\u0303bak b) = k, since bss\u0303bak b 6\u2261 0\nand e(al btbam ) = l + m \u2212 1, since btb \u2261 0. Then (6.2) yields k = l + m \u2212 1, so that k + 1 \u2265 2k\nand k = 1. It follows that l = m = 1, bs = bn and t = b2n+1 , for some positive integer n, so that (6.2)\nbecomes\nab2n ab \u2261 \u00b1 ab2n+1 a.\n(6.3)\n\u0012\n\u0013\n2n + 1\n\u03bb(ab2n+1 )a = \u2212(2n + 1)\u03bb(ab2n+1 )a, and\nOn the one hand \u03bb(ab2n ab) = \u2212\u03bb(b2n ab)a = \u2212(\u22121)2n\n2n\n\u0001\non the other \u03bb(ab2n+1 a) = \u03bb(ab2n+1 ) \u2212 \u03bb(b2n+1 a) a = 2\u03bb(ab2n+1 )a. It follows that 2n + 1 = \u00b12, a clear\ncontradiction.\n11\n\n\fTherefore, we may assume that |t|a \u2265 1. Applying Corollary 3.6 in (6.2) we get l + m = k, since |t|b\nis odd. It follows that k \u2265 2.\nOur first claim is that l = 1. Indeed, if l > 1 we apply Proposition 3.3 for factors of multi-degree (1, 1)\non (6.2). Then working modulo ker \u03bb Lemma 2.8 and Proposition 2.9 imply that the only contribution\nwill come from the left hand side and it will yield ak\u22121 bss\u0303bak \u2261 0, a contradiction.\nNext we claim that k = 2. Suppose that k > 2, i.e., consider the situation\nak bss\u0303bak\u22121 ab \u2261 \u00b1 ab tbak\u22121 .\n\n(6.4)\n\nApplying Proposition 3.3 for factors of multi-degree (1, 1) again we finally obtain\n\u2212 ak\u22121 bss\u0303bak \u2261 \u00b1tbak\u22121 .\n\n(6.5)\n\nBoth words in (6.5) are of odd length so the + case, in view of our induction hypothesis, yields a\ncontradiction. For the \u2212 case our induction hypothesis implies that either tbak\u22121 = ak\u22121 bss\u0303bak or\ntbak\u22121 = ak bss\u0303bak\u22121 . The former clearly can not hold, whereas the latter yields t = ak bss\u0303. Thus going\nback to (6.4) we must exclude the case where\nak bss\u0303bak b \u2261 \u2212 abak bss\u0303bak\u22121 ,\n\nk > 2.\n\n(6.6)\n\nk\nk\nk\nk\nk\nk\nObserve\u0012that\n\u0013 a bss\u0303ba b \u2261 ba bss\u0303ba . We clearly have ba bss\u0303b 6\u2261 0, therefore by (3.5) we get \u03bb(ba bss\u0303b) =\n1 k\n\u03bb(bak bss\u0303b). It follows that k = 1, which contradicts the fact that k > 2.\n\u2212(\u22121)\n1\n\n6.1\n\nThe case a2 bss\u0303ba2 b \u2261 \u00b1 abtba.\n\nSuppose that t = ayb, for some y \u2208 A\u2217 (the case t = bya is dealt similarly), i.e., consider the equation\na2 bss\u0303ba2 b \u2261 \u00b1 abay b2 a .\n\n(6.7)\n\nApplying Proposition 3.3 for all factors of multi-degree (1, 2) and then working modulo ker \u03bb we finally\nobtain abay \u2261 0, which contradicts the fact that |y|b is even.\nWe proceed in the same manner with the case t = byb, i.e.,\na2 bss\u0303ba2 b \u2261 \u00b1 ab2 y b2 a\n\n(6.8)\n\nand get yb2 a + \u1ef9b2 a \u2261 0, as we have no contribution from the left hand side of (6.8). Both these words\nare of even length and since |y|b is odd in this case, they are 6\u2261 0. Then our induction hypothesis yields\nn\nab2 y = yb2 a. By Lemma 2.1 there exist u, v \u2208 A\u2217 such that ab2 = uv, b2 a = vu and y = u(b2 a) , for\nn\nsome n \u2265 0. It follows that u = a and v = b2 , so that y = a(b2 a) . But then |y|b = 2n, which contradicts\nthe fact that |y|b is odd.\nWe may therefore assume that\na2 bss\u0303ba2 b \u2261 \u00b1 abayaba.\n(6.9)\nSuppose that s = \u01eb, i.e., a2 b2 a2 b \u2261 \u00b1 abababa. Then b2 a2 b \u2261 \u2213 2 babab. Since \u03b3(b2 a2 b) = 1 by\nLemma 3.7, this can not hold as it would imply that 2 | 1, a contradiction.\nSuppose that s = bx, for some x \u2208 A\u2217 , i.e., a2 b2 xx\u0303b2 a2 b \u2261 \u00b1 abayaba. It follows that b2 xx\u0303b2 a2 b \u2261\n\u2213 2 bayab. Since |y|b is odd aya 6\u2261 0, so by Corollary 3.6 eb (bayab) = 2. It follows that eb (b2 xx\u0303b2 a2 b) = 2\nand this is possible only if xx\u0303b2 a2 \u2261 0, i.e., the word xx\u0303b2 a2 is a palindrome of even length. Thus a2 b2 xx\u0303 =\nn\nn+2\nxx\u0303b2 a2 and by Lemma 2.1 we get xx\u0303 = a2 (b2 a2 ) , for some n \u2265 0. Then we obtain (b2 a2 )\nb \u2261\n\u0001\nn+2\n2 2\n\u2213 2 bayab. By Lemma 3.7 we have \u03b3 (b a )\nb = 1, hence we reobtain the contradiction 2 | 1.\nWe may therefore suppose that s = ak bx, for some x \u2208 A\u2217 , so it remains to check the validity of\na2 bak bxx\u0303bak ba2 b \u2261 \u00b1 abal bybam ba ,\n\n(6.10)\n\nwhere k, l, m \u2265 1 and l \u2264 m without loss of generality.\nSuppose first that |y|a = 0, i.e., byb = b2n+1 for n \u2265 1. We obtain bak bxx\u0303bak ba2 b \u2261 \u2213 2 bal b2n+1 am b\nand consequently ak bxx\u0303bak ba2 \u2261 \u2213 2 al b2n+1 am . By Corollary 3.6 e(al b2n+1 am ) = l + m \u2212 1 and\n12\n\n\fe(ak bxx\u0303bak ba2 ) = k + 2, since clearly bxx\u0303bak b 6\u2261 0. It follows that k + 2 = l + m \u2212 1, i.e., l + m = k + 3.\nOn the other hand, counting occurrences of the letter a we obtain 2k + 2|x|a + 2 = l + m. It follows\nthat k = 1 and |x|a = 0, so that bxx\u0303b = b2n and ab2n aba2 \u2261 \u2213 2 al b2n+1 am , where l + m = 4 and\n1 \u2264 l \u0001\u2264 m. Then by Corollary 3.5, and in particular (3.5) and (3.6), there exists q \u2208 Z such that\n\u2212 1+2\nb2n ab \u2261 \u00b1 2q ab2n+1 . By Lemma 3.1 it follows that \u22123(2n + 1)ab2n+1 \u2261 \u00b1 2q ab2n+1 which is a\n1\ncontradiction since it would mean that 2 | 3(2n + 1).\nTherefore we may suppose that |y|a \u2265 1. Since |y|b is odd Corollary 3.6 now yields\nk + 2 = l + m.\n6.1.1\n\n(6.11)\n\nThe case l = 1.\n\nBy (6.11) we have m = k + 1, i.e., we consider the equation\na2 bak bxx\u0303bak ba2 b \u2261 \u00b1 abab ybak+1 ba.\n\n(6.12)\n\nWe apply Proposition 3.3 with factors u of multi-degree (2, 2). Since \u03bb(abab) = \u22122\u03bb(a2 b2 ) = \u03bb(baba)\nthe term \u03bb(a2 b2 ) will appear as a common factor and therefore may be canceled. Furthermore, the only\ncontribution modulo ker \u03bb will come from the right hand side in (6.12) since ba2 b \u2261 0 and it will finally\nlead to ybak+1 ba \u2261 0, which contradicts the fact that |y|b is odd.\n6.1.2\n\nThe case l = 2 and k = 2.\n\nBy (6.11) we also get m = 2, hence we are dealing with the equation\na2 ba2 bxx\u0303ba2 ba2 b \u2261 \u00b1 aba2 byba2 ba.\n\n(6.13)\n\nWe apply Proposition 3.3 with factors u of multi-degree (4, 1). Then the term \u03bb(a4 b) will appear as a\ncommon factor and therefore may be canceled. Furthermore, the only contribution modulo ker \u03bb will\ncome from the left hand side and will yield bxx\u0303ba2 ba2 b \u2261 0, i.e., xx\u0303ba2 ba2 \u2261 0. Therefore we obtain\na2 ba2 bxx\u0303 = xx\u0303ba2 ba2 , so by Lemma 2.1 there exist words u, v \u2208 A\u2217 such that a2 ba2 b = uv, ba2 ba2 = vu\nn\nand xx\u0303 = u(ba2 ba2 ) , for some n \u2265 0. Two possibilities arise; either u = a2 ba2 and v = b or u = a2\nand v = ba2 b. The former one can not occur since xx\u0303 would be of odd length. The latter one yields\nn\nxx\u0303 = a2 (ba2 ba2 ) , which is indeed a palindrome of even length. Therefore the word on the left hand side\n2n+4\n2n+5\nof (6.13) is in fact equal to a2 (ba2 )\nb = (a2 b)\n, where n \u2265 0. Then (6.13) may be read as\n2n+3\n\na2 b (a2 b)\n\na2 b \u2261 \u00b1 aba abyba aba .\n\nApplying Proposition 3.3 with factors u of multi-degree (2, 1) we finally obtain\n\u0010\n\u0011\n\u0001\n2n+4\n2n+4\n(a2 b)\n+ (ba2 )\n\u2261 \u2213 2 abyba2 ba + ab\u1ef9ba2 ba .\n\n(6.14)\n\n(6.15)\n\nThe left hand side of (6.15) is equal to zero, hence it follows that abyba2 ba \u2261 \u2212 ab\u1ef9ba2 ba.\nSuppose that abyba2 ba 6\u2261 0. Then since both words are of even length our induction hypothesis\nyields abyba2 ba = aba2 byba, thus yba2 = a2 by. By Lemma 2.1 there exist words u, v \u2208 A\u2217 such\nn\nthat a2 b = uv, ba2 = vu and y = u(ba2 ) , for some n \u2265 0. Then we necessarily have u = a2 and\nd\nv = b so that y = a2 (ba2 ) , for some d \u2265 0. Going back to (6.14) we see that d = 2n + 1. But\n2n+1\n2n+3\nthen abyba2 ba = aba2 (ba2 )\nba2 ba = a(ba2 )\nba and the latter is a palindrome of even length\ncontradicting our assumption that abyba2 ba 6\u2261 0.\nWe are thus left with the case abyba2 ba \u2261 0 \u2261 ab\u1ef9ba2 ba. Then both yba2 and \u1ef9ba2 are palindromes\nof even length, i.e., yba2 = a2 b\u1ef9 and \u1ef9ba2 = a2 by. But then on the one hand a2 b\u1ef9ba2 = (a2 b\u1ef9)ba2 =\n(yba2 )ba2 = yba2 ba2 and on the other a2 b\u1ef9ba2 = a2 b(\u1ef9ba2 ) = a2 b(a2 by) = a2 ba2 by. It follows that\na2 ba2 by = yba2 ba2 so once more by Lemma 2.1 there exist u, v \u2208 A\u2217 such that a2 ba2 b = uv, ba2 ba2 = vu\nd\nand y = u(ba2 ba2 ) , for some d \u2265 0. This time the only possibility is u = a2 ba2 and v = b since we\nd\ndemand that |y|b is odd. So we obtain y = a2 ba2 (ba2 ba2 ) , hence y is a palindrome of odd length.\n2n+5\n2n+4\n2n+4\nThen clearly d = n and (6.14) becomes (a2 b)\n\u2261 \u00b1 a(ba2 )\nba, which in turn yields (ba2 )\nb \u2261\n2n+4\n2n+4\n2\n2\n\u2213 2 (ba )\nb. In any case it follows that (ba )\nb \u2261 0, which can not hold since the corresponding\nlength is odd.\n13\n\n\f6.1.3\n\nThe case l \u2265 2 and k > 2.\n\nHere we are checking upon the equation\na2 bak bxx\u0303bak ba2 b \u2261 \u00b1 abal bybam ba.\n\n(6.16)\n\nWe apply Proposition 3.3 with factors u of multi-degree (k + 2, 1). The term \u03bb(bak+2 ) will appear as a\ncommon factor and therefore may be canceled. Due to (6.11) we get k +2 > l+1 and k +2 > m+1, hence\nthe only contribution modulo ker \u03bb will come from the left hand side and will yield bxx\u0303bak ba2 b \u2261 0. It\nfollows that the word xx\u0303bak ba2 is a palindrome of even length, therefore k must be even and k \u2265 4. We\nobtain a2 bak bxx\u0303 = xx\u0303bak ba2 , so by Lemma 2.1 there exist u, v \u2208 A\u2217 such that a2 bak b = uv, bak ba2 = vu\nn\nand xx\u0303 = u(bak ba2 ) , for some n \u2265 0. Since |u|b must be even we obtain u = a2 , v = bak b and\nn\nxx\u0303 = a2 (bak ba2 ) . Then (6.16) becomes\nn+2\n\na2 (bak ba2 )\nn+2\n\nwhich further yields (bak ba2 )\n\nb \u2261 \u00b1 abal bybam ba,\n\n(6.17)\n\nb \u2261 \u2213 2 bal bybam b. Passing to reversals by Lemma 2.7 we get\nn+2\n\n(ba2 bak )\n\nb \u2261 \u2213 2 bamb\u1ef9bal b.\n\n(6.18)\n\nn+2 \u0001\nIt follows that \u03b3 (ba2 bak )\nb = 2 \u03b3(bam b\u1ef9bal b). But the latter contradicts Lemma 3.8 which states\n\u0001\n2 k n+2\nthat \u03b3 (ba ba )\nb is odd.\n\nThe case ak bxx\u0303bak+1 \u2261 \u00b1 ak bybak .\n\n7\n\nSet w1 = ak bxx\u0303bak+1 and w2 = ak bybak . We assume, for the sake of contradiction, that w1 \u223c w2 .\nRecall that this means that there exist \u03b71 , \u03b72 \u2208 Z\u2217 such that \u03b71 w1 \u2261 \u03b72 w2 . In certain cases we will\nbe able to show that this is impossible; in certain others we will only reach our original goal, i.e., that\nw1 6\u2261 \u00b1 w2 . The reason for aiming for the impossibility of the more difficult equation w1 \u223c w2 , will be\nrevealed later on in \u00a78.\nLet us first deal with the case |x|b = 0. Then there exists l \u2265 0 such that\nak b a2l bak+1 \u2261 \u00b1 ak b a2l+1 bak .\n\n(7.1)\n\nWe apply Proposition 3.3 with factors u of multi-degree (k, 1)\u0001 and modulo ker\n\u0001 \u03bb we finally obtain\nk+2l+1\na2l bak+1 \u2261 \u00b1 2 a2l+1 bak . Then by Lemma 3.1 we obtain k+2l+1\n=\n\u2213\n2\n, which in turn yields\nk+1\nk\n2l + 1 = \u2213 2(k + 1), a contradiction.\nNote that in general the equation ak ba2l bak+1 \u223c ak ba2l+1 bak might hold. For example if k = l = 1,\nby Proposition 3.4 one can show that \u03bb(aba2 ba2 ) = 3 \u03bb(ba3 )ba2 + 6 \u03bb(ba4 )ba, whereas \u03bb(aba3 ba) =\n\u22124 \u03bb(ba3 )ba2 \u2212 8 \u03bb(ba4 )ba. It follows that 4 aba2 ba2 \u2261 \u2212 3 aba3 ba.\nIn the rest of the section we deal with the case |x|b \u2265 1.\n\n7.1\n\nThe case y = btb.\n\nWe may write x = al bs for some s \u2208 A\u2217 and l \u2265 0, i.e., we are dealing with the equation\n\u03b71 ak bal bss\u0303b al bak+1 \u2261 \u03b72 ak b2 tb2 ak .\n\n(7.2)\n\nApplying Proposition 3.3 for factors of multi-degree (k + l + 1, 1) we finally obtain bss\u0303bal bak \u2261 0, a\ncontradiction.\n\n14\n\n\fThe case x = al bs,\n\n7.2\n\ny = am btban .\n\nWe are dealing with the comparison \u03b71 ak bal bss\u0303bal bak+1 \u2261 \u03b72 ak bam btban bak , where l, m, n \u2265 1 and\nm \u2264 n without loss of generality. By Proposition 3.3 for factors of multi-degree (0, 1) - i.e., factoring\nout the letter b - we obtain\n\uf8fc\n\uf8f1\n\uf8f1\n\uf8fc\n\uf8f4\n\uf8f4\nam btban bak\n+ ak\n+ ak\nal bss\u0303bal bak+1\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nm+1 m k\n\uf8f4\n\uf8f4\nl+1 l k\nn k \uf8f4\nl k+1 \uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n+\n(\u22121)\na\nba\ntba\nba\nss\u0303ba\nba\n+\n(\u22121)\na\nba\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n\uf8fd\n\uf8fd\n\uf8f2\n.\n.\n..\n..\n\u03b71\n.\n(7.3)\n= \u03b72\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nn+1\nl\nn\nk\nm\nk\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nl\nk\nl\nk+1\n\uf8f4\n\uf8f4\n\uf8f4\na ba \uf8f4\n+ (\u22121)\nt\u0303ba ba\na ba\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 + (\u22121)l ss\u0303bal bak\n\uf8f4\n\uf8fe\n\uf8f4\n\uf8fe\n\uf8f3\nn\nm\nk\n\u2212 a bss\u0303ba ba\nak+1\nak\n+ a bt\u0303ba ba\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\u0001\n\n\u0001\n\u0001\n\nLet u = am btban . Since |u| is odd we know that \u03bb(u) = \u03bb(\u0169) 6= 0, therefore there exists a non zero\ninteger r and a Lie polynomial P such that (P, u) = (P, \u0169) = r. We act by \u22b2 P on both sides of (7.3)\nusing Proposition 2.3. On the first and the last line of the right hand side in (7.3) we obtain\n(ak\n\n\u0001 uba ) \u22b2 P\nk\n\n= (ak\n\n\u0001 \u0169ba ) \u22b2 P\nk\n\n= r (ak\n\n\u0001 ba ).\nk\n\nThe words u and al bss\u0303bal b have the same length but not the same multi-degree since |al bss\u0303bal b|a =\n|u|a \u2212 1. It follows that (P, al bss\u0303bal b) = 0, therefore, there is no contribution from the action \u22b2 P to the\nfirst and the last line of the left hand side in (7.3). Set (P, ss\u0303bal bal+1 ) = r1 , (P, tban bam ) = r2 and\n(P, t\u0303bam ban ) = r3 and set eij to be equal to 1, when i \u2265 j, and 0 otherwise. Then the action of P on\nthe second and on the penultimate line in both sides of (7.3) is given by the equations\n\uf8f1 l k\nss\u0303bal bak+1 ) \u22b2 P = ekl r1 (al bak\nak\u2212l ),\n(a ba\n\uf8f4\n\uf8f4\n\uf8f2\nl+1\nl k\nl k\nk\u2212l\u22121\n(ss\u0303ba ba\na ba ) \u22b2 P = ek r1 (a\nal bak+1 ),\n(7.4)\nm k\nn k\nm\nm k\nk\u2212m\n(a ba\ntba ba ) \u22b2 P = ek r2 (a ba\na\n),\n\uf8f4\n\uf8f4\n\uf8f3\n(t\u0303bam ban\nan bak ) \u22b2 P = ekn r3 (ak\u2212n\nan bak ).\n\n\u0001\n\n\u0001\n\u0001\n\u0001\n\u0001\n\n\u0001\n\u0001\n\u0001\n\nCollecting all terms from both sides we obtain\n\n\u03b71\n\n(\n\n(\u22121)l+1 ekl r1 (al bak\n(\u22121)l ekl+1 r1 (ak\u2212l\u22121\n\n\u0001 a )+\n\u0001 a ba )\nk\u2212l\nl\n\nk+1\n\n)\n\n\uf8f1\n\uf8f4\n\uf8f2\n\n\u0001\n\n2r (ak\nb ak ) +\nm+1 m\nm k\n= \u03b72\nak\u2212m ) +\n(\u22121)\nek r2 (a ba\n\uf8f4\nn+1 n\n\uf8f3\nk\u2212n\nan bak )\n(\u22121)\nek r3 (a\n\n\u0001\n\u0001\n\n\uf8fc\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8fe\n\n.\n\n(7.5)\n\nNow observe that all words appearing in the shuffle products in (7.5) begin with the letter a, except\nfrom the word ba2k in the term (ak\nbak ).\u0012 Thus\n\u0013 if we act by \u22b2 b on both sides of (7.5) we obtain\n2k\nk\nk\n2\u03b72 r (a\na ) = 0. Since \u03b72 , r 6= 0 we get\n= 0, a contradiction.\nk\n\n\u0001\n\n7.3\n\nThe case x = al bs,\n\n\u0001\n\ny = am btb.\n\nSuppose that there exist \u03b71 , \u03b72 \u2208 Z\u2217 such that\n\u03b71 ak bal bss\u0303bal bak+1 \u2261 \u03b72 ak bam btb2 ak .\nBy (3.5) and (3.6) we obtain\n\u0012 \u0013\n\u0012\n\u0013\n\u0012 \u0013\n2k\n2k\n2k\nk\u22121\n\u03bb(bam btb2 ).\n\u03b71 (\u22121)\n{\n\u2212\n} \u03bb(abal bss\u0303bal ) b = \u03b72\nk\nk+1\nk\n\n(7.6)\n\n(7.7)\n\nLet P and Q denote respectively the left and the right hand side of (7.7). Observe that eb (P ) = 1,\nwhereas eb (Q) \u2265 2, a contradiction.\n\n15\n\n\f7.4\n\ny = al btbam ,\n\nThe case x = bs,\n\nl \u2264 m.\n\nWe begin by examining the validity of the general equation\n\u03b71 ak b b |ss\u0303b2{z\nak+1} \u2261 \u03b72 ak bal btbam bak ,\n\n(7.8)\n\nwhen \u03b71 , \u03b72 are non zero integers. We apply Proposition 3.3 for all factors of multi-degree (0, 1) and\nfactoring out the letter b we obtain\n\n\u03b71\n\n\uf8f1\n+ ak\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nk\n\uf8f4\n\uf8f2 \u2212 ba\n\n\u0001 bss\u0303b a\n\u0001 ss\u0303b a\n\n2 k+1\n2 k+1\n\n..\n.\n\n\uf8f4\n\uf8f4\n\uf8f4\n2 k\n\uf8f4\n\uf8f4\n\uf8f3 + ss\u0303b 2a k\n\u2212 bss\u0303b a\n\n\u0001 ba\n\u0001a\n\nk+1\nk+1\n\n\u0001\n\n\uf8f1\nal btbam bak\n+ ak\n\uf8f4\n\uf8f4\n\uf8f4\nl+1 l k\n\uf8f4\ntbam bak\n\uf8f4\n\uf8f2 + (\u22121) a ba\n..\n= \u03b72\n.\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4 + (\u22121)m+1 t\u0303bal bak\n\uf8f4\nam bak\n\uf8f4\n\uf8f4\n\uf8f3\n\uf8fe\nm\nl k\nak\n+ a bt\u0303ba ba\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fd\n\n\u0001\n\n\u0001\n\u0001\n\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fe\n\n.\n\n(7.9)\n\nWe act by [ak b] \u2704 on (7.9) using Proposition 2.3. In view of Proposition 2.9, working modulo ker \u03bb we\nfinally obtain ss\u0303b2 ak+1 \u2261 0. Thus k must be odd and ss\u0303b2 ak+1 must be a palindrome, i.e., ak+1 b2 ss\u0303 =\nd\nss\u0303b2 ak+1 and Lemma 2.1 then yields ss\u0303 = ak+1 (b2 ak+1 ) , for some d \u2265 0.\nSuppose that l < m. Then (7.8) becomes\nd\n\n\u03b71 ak b2 ak+1 (b2 ak+1 ) b2 ak+1 \u2261 \u03b72 ak bal btb am bak .\n\n(7.10)\n\nApplying Proposition 3.3 for all factors of multi-degree (k + m, 1) on (7.10) and then working modulo\nker \u03bb with Proposition 2.9, we finally obtain bt\u0303bal bak \u2261 0, which is clearly impossible.\nNow suppose that 1 < l = m. Then (7.8) is written as\nd\n\n\u03b71 ak b2 ak+1 (b2 ak+1 ) b2 ak+1 \u2261 \u03b72 ak bal btb al bak .\n\n(7.11)\n\nOnce more we apply Proposition 3.3 for all factors of multi-degree (k + l, 1) on (7.11). This time\nworking modulo ker \u03bb we get btbal bak + bt\u0303bal bak \u2261 0. Set |btbal bak | = r. Since btbal bak 6\u2261 0 our\ninduction hypothesis yields an immediate contradiction when r is odd, whereas when r is even it gives\nbtbal bak = ak bal btb, which also clearly can not hold.\nIt remains to check the case l = m = 1. From this point and on we return to our initial objective,\ni.e., we consider the equation\nd\n\nak b2 ak+1 (b2 ak+1 ) b2 ak+1 \u2261 \u00b1 ak babtbabak ,\n\n(7.12)\n\nwhere d \u2265 0 and k is an odd positive integer. By (3.8) we obtain\nd\n\n\u03bb(bak+1 (b2 ak+1 ) b2 ak+1 ) = \u00b1 { \u03bb(abtbabak ) + \u03bb(ak babtba) } .\n\n(7.13)\n\nUsing (3.4) and (3.5) to extract the largest powers of a from the right we obtain\nd\n\n\u03bb(bak+1 (b2 ak+1 ) b2 ) = \u2213 (k + 1) {\u03bb(btbab) + \u03bb(babtb) } .\nd\n\n(7.14)\nd+1 \u0001\n\nd+1\n\nSince bak+1 (b2 ak+1 ) b2 = b(ak+1 b2 )\nand k is odd Lemma 3.7 yields \u03b3 b(ak+1 b2 )\n(7.14) implies that (k + 1) | 1, a contradiction.\nAt this point one should mention that there might exist \u03b71 and \u03b72 \u2208 Z\u2217 such that\n\n= 1. But then\n\nd\n\n\u03b71 ak b2 ak+1 (b2 ak+1 ) b2 ak+1 \u2261 \u03b72 ak babtbabak .\nIndeed, for k = 1 and d = 0 one can show that 16 ab2 a2 b2 a2 \u2261 ababababa using Proposition 3.4.\n\n16\n\n(7.15)\n\n\f7.5\n7.5.1\n\nThe case x = bs,\n\ny = al btb.\n\nThe case |s|a = 0.\n\nIt means that s = bm , for some m \u2265 0. Counting the occurrences of the letter a in this particular case\nwe necessarily get l = 1, so that t = b2m and we have to check the validity of the equation\n\u03b71 ak b2m+4 ak+1 \u2261 \u03b72 ak bab2m+3 ak .\n(7.16)\n\u0001\n2m+3 k\n2m+2\nk\n2m+3 k+1\na +b\naba . Equating polynomial coefficients of b\nBy (3.8) we obtain \u03b71 b\na\n\u2261 \u03b72 ab\nand passing to reversals we obtain\n\u03b71 ak+1 b2m+2 \u2261 \u03b72 ak bab2m+1 .\n\n(7.17)\n\nUnless k = 1 and m = 0, both words in (7.17) are distinct Lyndon words so (7.17) contradicts Proposition 2.6. If k = 1 and m = 0 the word abab on the right hand side is not Lyndon. Since abab \u2261 \u22122a2 b2\n(7.17) in that particular case yields \u03b71 = \u22122\u03b72 , so that (7.16) becomes\n\u2212 2 ab b3 a2 \u2261 ab ab2 ba .\n\n(7.18)\n\nWe apply Proposition 3.3 for factors of multi-degree (1, 1) on (7.18). Factoring out the term \u03bb(ab) and\nworking modulo ker \u03bb we get \u22122 b3 a2 \u2261 ab3 a + b2 aba. Factoring out the letter a we get \u22122 b3a \u2261\n2 ab3 + b2 ab, which in turn yields b2 ab \u2261 0, a contradiction.\n7.5.2\n\nThe case |s|a \u2265 1.\n\nWe deal with the equation\n\u03b71 ak b2 ss\u0303b2 ak+1 \u2261 \u03b72 ak bal btb2 ak .\n\n(7.19)\n\nSuppose that l > 1. Then applying Proposition 3.3 for factors of multi-degree (k + l, 1) on (7.19) and\nworking modulo ker \u03bb we finally get btb2 ak \u2261 0, a clear contradiction.\nSuppose now that l = 1. From this point and on we check the validity of\nak b bss\u0303b2 ak+1 \u2261 \u00b1 ak b abtb bak .\n\n(7.20)\n\nWe apply Proposition 3.3 for factors of multi-degree (k, 1) on (7.20). Factoring out the polynomial\n\u03bb(ak b) and working modulo ker \u03bb with Proposition 2.9 we obtain\n\u0001\n(7.21)\nbss\u0303b2 ak+1 \u2261 \u00b1 abtb2 ak + bt\u0303babak .\n\nFrom this we immediately obtain\n\nss\u0303b2 ak+1 \u2261 \u00b1 t\u0303babak .\n\n(7.22)\n\nbss\u0303b2 \u2261 \u2213 (k + 1) btb2 .\n\n(7.23)\n\nBy (3.5) we also get\nA. k even. Both words in (7.22) have odd length so our induction hypothesis immediately discards\nthe minus case. For the plus case it yields ss\u0303b2 ak+1 = ak babt. It is not then hard to check that s = ak babp\nand t = pp\u0303babak b2 ak+1 , for some p \u2208 A\u2217 . Then\n(7.23) becomes bak babpp\u0303babak b2 \u223c bpp\u0303baba\u0001k b2 ak+1 b2 .\n\u0001\nk\nk 2\nBy Corollary 3.6 we get eb ba babpp\u0303baba b = 2, so we must also have eb bpp\u0303babak b2 ak+1 b2 = 2. This\ncan only be achieved if pp\u0303babak b2 ak+1 \u2261 0. It follows that ak+1 b2 ak babpp\u0303 = pp\u0303babak b2 ak+1 , hence by\nLemma 2.1 the words ak+1 b2 ak bab and babak b2 ak+1 must be conjugate, which is easily checked to be\nimpossible.\nB. k odd. Suppose that ss\u0303b2 ak+1 , t\u0303babak 6\u2261 0. This time (7.22) with the plus sign is immediately\ndiscarded by our induction hypothesis since ss\u0303b2 ak+1 = t\u0303babak clearly can not hold. For the minus sign\nin (7.22) we respectively obtain ss\u0303b2 ak+1 = ak babt and we argue entirely as in the case where k is even.\nFinally let us consider the case where ss\u0303b2 ak+1 \u2261 0 \u2261 t\u0303babak . Then t = pp\u0303babak , for some p \u2208 A\u2217\nd\nand by Lemma 2.1 ss\u0303 = ak+1 (b2 ak+1 ) , for some d \u2265 0, so that (7.23) becomes\nd\n\n\u03bb(bak+1 (b2 ak+1 ) b2 ) = \u2213 (k + 1) \u03bb(bpp\u0303babak b2 ) ,\nd+1 \u0001\nBy Lemma 3.7 \u03b3 b(ak+1 b2 )\n= 1, so that we must have (k + 1) | 1, a contradiction.\nThe following result follows from our global analysis of \u00a77.\n17\n\n(7.24)\n\n\fLemma 7.1. Suppose that ak bxx\u0303bak+1 \u223c ak bybak , with |x|b \u2265 1. Then x = bs and y = abp, where\np = uba or p = vb for some s, u, v \u2208 A\u2217 .\nProof. The only cases where our hypotheses might hold are either when x = bs and y = abtba or x = bs\nand y = abtb, studied in \u00a77.4 and \u00a77.5 respectively.\n\n8\n8.1\n\nThe case ak balbxx\u0303bal \u2261 \u00b1 ak+1 bybal\u22121, k + 1 < l \u2212 1 .\nThe case |x|b \u2265 1.\n\nWe necessarily have |y|b > 1 and |y|b odd. By (3.8) we obtain\nybal\u22121 \u2261 \u00b1 (k + 1) al bxx\u0303bal\u22121 .\n\n(8.1)\n\nSuppose that y = bt, for some t \u2208 A+ . Then we necessarily have tbal\u22121 \u2261 0, which is contrary to the\nfact that |y|b is odd.\nIf y = am bt, for some m \u2265 1 and t \u2208 A+ (8.1) becomes\nam btbal\u22121 \u2261 \u00b1 (k + 1) al bxx\u0303bal\u22121 .\n\n(8.2)\n\nA. btb 6\u2261 0. By Corollary 3.6 e(am btbal\u22121 ) = m + l \u2212 1 and e(al bxx\u0303bal\u22121 ) = 2l \u2212 2. Thus we get\nm = l \u2212 1 and we have\nal\u22121 bxx\u0303bal \u223c al\u22121 btbal\u22121 ,\n(8.3)\nwhere |x|b \u2265 1. By Lemma 7.1 then we obtain x = bs and t = abp, where either p = uba or p = vb, for\nsome u, v \u2208 A\u2217 . Then we need to check if\nak bal b2 ss\u0303b2 al \u2261 \u00b1 ak+1 bal\u22121 babpbal\u22121 .\n\n(8.4)\n\nApplying Proposition 3.3 for factors of multi-degree (k + l, 1) we get\nb2 ss\u0303b2 al \u223c ba bpbal\u22121 .\n\n(8.5)\n\nApplying Proposition 3.3 for factors of multi-degree (1, 1) and working modulo ker \u03bb we finally obtain\nbpbal\u22121 \u2261 0, which is a clear contradiction.\nB. btb \u2261 0. Going back to (8.2) we get m = l by Corollary 3.6. Since |t|b is even we distinguish\nbetween the following two cases.\nIf t = b2n , for some n \u2265 1 then |x|a = 0 and (8.2) becomes al b2n+2 al\u22121 \u2261 \u00b1 (k + 1) al b2n+2 al\u22121 ,\nwhich in any case yields al b2n+2 al\u22121 \u2261 0, a contradiction.\nNow suppose that t = z z\u0303 for some z \u2208 A+ with |z|a \u2265 1. If z = bu, for some u \u2208 A+ we need to\ncheck if\nk+1 l 2\nl\u22121\n.\n(8.6)\nak bal bxx\u0303bal \u2261 \u00b1 a\nba\n{z b u\u0169} b ba\n|\nWe apply Proposition 3.3 for all factors of multi-degree (0, 1) and factoring out the letter b we obtain\n\n\u0001\n\n\uf8f1\n+ ak\nal bxx\u0303bal\n\uf8f4\n\uf8f4\n\uf8f4\nl\nk\n\uf8f2 \u00b1 a ba\nxx\u0303bal\n..\n\uf8f4\n.\n\uf8f4\n\uf8f4\n\uf8f3\nal\n\u2213 xx\u0303bal bak\n\n\u0001\n\n\u0001\n\n\u0001\n\n\uf8f1\nal b2 u\u0169b2 al\u22121\n\u2212 ak+1\n\uf8f4\n\uf8f4\nl\nk+1\n\uf8f4\n\uf8f4\n\u2213 a ba\nbu\u0169b2 al\u22121\n\uf8f4\n\uf8f4\nl\nk+1\n\uf8f4\n\uf8f2 \u00b1 ba ba\nu\u0169b2 al\u22121\n..\n= \u00b1\n\uf8f4\n\uf8f4\n.\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fe\n\uf8f4\n2 l k+1\n\uf8f4\nbal\u22121\n\u2213\nu\u0169b\na\nba\n\uf8f4\n\uf8f3\n\u00b1 bu\u0169b2 al bak+1\nal\u22121\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fd\n\n\u0001\n\u0001\n\n\u0001\n\u0001\n\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fe\n\n.\n\n(8.7)\n\nThen we act by [al\u22121 b] \u2704 on (8.7) using Proposition 2.3. Then working modulo ker \u03bb we finally obtain\nu\u0169b2 al bak+1 \u2261 0, which is a contradiction since the number of occurrences of the letter b in it is odd.\n\n18\n\n\fIf z = an bu, for some n \u2265 1 and u \u2208 A\u2217 we need to check whether\nak bal bxx\u0303bal \u2261 \u00b1 ak+1 bal ban bu\u0169ban bal\u22121 .\n\n(8.8)\n\nIt follows that al bxx\u0303 \u223c al ban bu\u0169ban , hence we get x = an bs, for some s \u2208 A\u2217 so that we actually\ncompare\nak bal ban bss\u0303b an bal \u2261 \u00b1 ak+1 bal ban bu\u0169ban bal\u22121 .\n(8.9)\nWe distinguish between three cases.\n(1) n < k+1. Then k+l+1 is strictly larger than n+l, k+l and n+l\u22121. We then apply Proposition 3.3\non (8.9) for all factors of multi-degree (k + l + 1, 1) and we finally get ban bu\u0169ban bal\u22121 \u2261 0, which is\nagain impossible.\n(2) n > k + 1. Then n + l is strictly larger than k + l, k + l + 1 and n + l \u2212 1. In this case we apply\nProposition 3.3 for all factors of multi-degree (n + l, 1) on (8.9) and get bss\u0303ban bal bak \u2261 0, another\ncontradiction.\n(3) n = k + 1. Proposition 3.3 for factors of multi-degree (n + l, 1) will yield\nbss\u0303bak+1 bal bak \u2261 \u00b1 bak+1 bu\u0169bak+1 bal\u22121 .\n\n(8.10)\n\nSince both words clearly lie in the support of the free Lie algebra our induction hypothesis implies that\nthey are either equal or one is the reversal of the other. The former can not hold since k < l \u2212 1 and the\nlatter is clearly impossible.\n\n8.2\n\nThe case |x|b = 0.\n\nWe have to consider the equation\nak bal ba2m bal \u2261 \u00b1 ak+1 bap baq bal\u22121 ,\n\n(8.11)\n\nwhere m, p, q \u2265 0 and p + q = l + 2m. By (3.7) and (3.8) we have\n(k + 1) al ba2m bal\u22121 \u2261 \u2213 ap baq bal\u22121 .\n\n(8.12)\n\nBy Corollary 3.6 it follows that e(al ba2m bal\u22121 ) = 2l \u2212 2 and e(ap baq bal\u22121 ) is either equal to p + l \u2212 1,\nwhen q is odd; or to p + l \u2212 2, if q is even. We respectively obtain p = l \u2212 1 or p = l. The latter clearly\ncan not hold since (8.12) would yield al ba2m bal\u22121 \u2261 0. Therefore we are left with the case p = l \u2212 1,\ni.e.,\nak bal ba2m bal \u2261 \u00b1 ak+1 bal\u22121 ba2m+1 bal\u22121 , k + 1 < l \u2212 1.\n(8.13)\n\u0001\nk k+l\u0001\nk+1\nk+l\nl\u22121 2m+1\nBy (3.5) it follows that (\u22121)\nbal ba2m b \u2261 \u00b1 (\u22121)\nba\nb, which in turn yields\nk\nk+1 ba\nk k+l\u0001\n1 1+1\u0001 l 2m\nk+1 k+l \u0001\n1 1+1\u0001 l\u22121 2m+1\n(\u22121)\n(\u22121)\na\nba\n\u2261\n\u00b1\n(\u22121)\n(\u22121)\na\nba\n.\nBy\nLemma (3.1) then we\nk\n1\nk+1\n1\nfinally obtain\n\u0012\n\u0013\u0012\n\u0013\n\u0012\n\u0013\u0012\n\u0013\nk + l l + 2m\nk+l\nl + 2m\n= \u00b1\n.\n(8.14)\nk\nl\nk+1\nl\u22121\nThe minus sign in (8.14) - which respectively corresponds to the minus in (8.13) and the plus in (8.12) is clearly impossible. Calculating the binomial coefficients we are finally left with the equation\n(k + 1)(2m + 1) = l2 ,\n\n(8.15)\n\nwhich is feasible under our assumptions, e.g., take k = 3, l = 6 and m = 4.\nEquation (8.12) with the minus sign and for p = l \u2212 1 becomes\n(k + 1) al ba2m bal\u22121 \u2261 \u2212 al\u22121 ba2m+1 bal\u22121 .\nl\n\n(8.16)\n\nl\n\nBy (3.8) we obtain (\u22121) (k + 1) a2m bal = \u2212 2 (\u22121) a2m+1 bal\u22121 . By Lemma 3.1 then it follows that\n\u0012\n\u0013\n\u0012\n\u0013\nl + 2m\nl + 2m\n(k + 1)\n= 2\n,\n(8.17)\nl\nl\u22121\nwhich finally yields\n(k + 1)(2m + 1) = 2 l.\n2\n\n(8.18)\n\nFrom (8.15) and (8.18) we get l = 2l, i.e., l = 2, which contradicts our assumption that k + 1 < l \u2212 1.\n\n19\n\n\f9\n9.1\n\nThe case ak bak+2bxx\u0303bak+2 \u2261 \u00b1 ak+1 bybak+1 .\nThe case |x|b = 0.\n\nThen |y|b = 1, i.e., we consider the comparison\nak bak+2 ba2l bak+2 \u2261 \u00b1 ak+1 bap baq bak+1 ,\n\n(9.1)\n\nwhere l, p \u2265 0 and p + q = k + 2l + 2. Applying Proposition 3.3 for factors of multi-degree (0, 1) on (9.1)\nwe factor out the letter b and we obtain\n\uf8fc\n\uf8f1\n\uf8fc\n\uf8f1\nk+1 k+1\n\uf8f4\nap baq bak+1 \uf8f4\na\nak+2 ba2l bak+2 \uf8fd\n\uf8fd\n\uf8f2 + (\u22121)\n\uf8f2 + (\u22121)k ak\nk+2 k\n2l k+2\nk+p\np\nk+1\nq\nk+1\n.\n(9.2)\n=\n\u00b1\n\u2212 a ba\na ba\na ba\na ba\n+ (\u22121)\n\uf8f4\n\uf8fe\n\uf8f4\n\uf8f3\n2l k+2 k\nk+2\n\uf8fe\n\uf8f3\nq\np\nk+1\nk+1\n+ a ba ba\na\n\u2212 a ba ba\na\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\u0001\n\nSuppose that p 6= k + 1 and p 6= 2l + 1. Then acting by [ap+k+1 b] \u2704 on (9.2) we finally get aq bak+1 \u2261 0,\na contradiction. Therefore we may assume, without loss of generality, that p = k + 1, i.e.,\nak bak+2 ba2l bak+2 \u2261 \u00b1 ak+1 bak+1 ba2l+1 bak+1 .\nBy successive applications of (3.5) we obtain\n\u0012\n\u0013\u0012\n\u0013\n\u0012\n\u0013\u0012\n\u0013\n2k + 2\nk + 2l + 2\n2k + 2\nk + 2l + 2\n= \u00b1\n.\nk\nk+2\nk+1\nk+1\n\n(9.3)\n\n(9.4)\n2\n\nThis is clearly impossible for the minus sign. For the plus one it is equivalent to having (k + 2) =\n(k + 1) (2l + 1). But this is also a contradiction because if k is even (resp. odd) the left hand side is also\neven (resp. odd) but the right hand side is odd (resp. even).\n\n9.2\n\nThe case |x|b \u2265 1.\n\nThen |y|b > 1 and |y|b is odd. By (3.8) and (3.7) we obtain\nk\n\n\u03bb(ak+1 by) + (\u22121) \u03bb(ybak+1 ) = \u00b1 (k + 1) \u03bb(ak+2 bxx\u0303bak+1 ).\n\n(9.5)\n\nIf y = aub for some u \u2208 A\u2217 , it follows that ak+1 bau \u2261 0, which contradicts the assumption that |y|b is\nodd. Similarly we deal with the case where y = bua.\nSuppose that y = bub, for some u \u2208 A+ and let P and Q denote respectively the left and the right\nhand side in (9.5). Then e(P ) \u2264 k + 1, whereas e(Q) = 2k + 2 and we reach a contradiction.\nIn the sequel we suppose that y starts and ends with the letter a, i.e., y = al btbam for some t \u2208 A\u2217\nand l, m \u2265 1, where without loss of generality l \u2264 m.\nSuppose that x starts with b, i.e., x = bn\u22121 z for n \u2265 2 and z \u2208 A\u2217 . Then we have\nak bak+2 bn z z\u0303bn ak+2 \u2261 \u00b1 ak+1 bal btbam bak+1 .\n\n(9.6)\n\nObserve that bak+2 bn z z\u0303bn \u223c bal btbam b. Since |t|b is odd a\u0001l btbam 6\u2261 0, therefore by Corollary 3.6 we\nget eb (bal btbam b) = 2. On the other hand, eb bak+2 bn z z\u0303bn \u2265 n; the equality holds in the case where\nak+2 bn z z\u0303 \u2261 0. It follows that n = 2, k is even and ak+2 b2 z z\u0303 = z z\u0303b2 ak+2 . By Lemma 2.1 we then obtain\nd\nz z\u0303 = ak+2 (b2 ak+2 ) , for some d \u2265 0, so that (9.6) becomes\nak bak+2 (b2 ak+2 )\nBy (3.5) we get\n\nIt follows that\n\n\u0012\n\nd+1 2 k+2\n\n\u2261 \u00b1 ak+1 bal btbam bak+1 .\n\nb a\n\n\u0013\n\u0012\n\u0013\n2k + 2\n2k + 2\nk+2 2 k+2 d+1 2\nba (b a\n) b \u2261 \u2213\nbal btbam b,\nk\nk+1\nd+2 \u0001\n\n(k + 1) \u03b3 b(ak+2 b2 )\n\n= (k + 2) \u03b3(bal btbam b).\n\n20\n\n(9.7)\n\n(9.8)\n\n(9.9)\n\n\fd+2 \u0001\n\nSince k is even Lemma 3.7 yields \u03b3 b(ak+2 b2 )\n\n= 1. But then (k + 2) | (k + 1), a contradiction.\n\nWe are therefore left with the case where x = an bs, for some n \u2265 1, i.e.,\nak bak+2 ban bss\u0303ban bak+2 \u2261 \u00b1 ak+1 bal btbam bak+1 ,\n\n(9.10)\n\nwhere l \u2264 m, without loss of generality. Since |t|b is odd am btban 6\u2261 0. Then (9.10) implies that\nak+2 ban bss\u0303ban \u223c al btbam .\n\n(9.11)\n\n\u0001\nn\n\nClearly e ak+2 ban bss\u0303ba = k + n + 2. We have to distinguish between two cases.\nA. |t|a = 0. Then e(al btbam ) = l + m \u2212 1, so that k + n + 2 = l + m \u2212 1. On the other hand, counting\noccurrences of the letter a in (9.11) we get k + 2n + 2 + 2|s|a = l + m. It follows that n + 2|s|a = 1 which\nclearly implies that n = 1 and |s|a = 0. Then (9.11) reads\nab b2q\u22121 abak+2 \u223c al b2q+1 am ,\n\n(9.12)\n\nfor some q \u2265 1 (for q = 0 we fall back to the case where |x|b = 0). If l > 1, then applying Proposition 3.3\nfor factors of multi-degree (1, 1) we finally get b2q\u22121 abak+2 \u2261 0, a contradiction. Thus we must have\nl = 1, i.e.,\nab b2q\u22121 abak+2 \u223c ab b2q ak+3 .\n(9.13)\nFactoring out \u03bb(ab) once more by Proposition 3.3 we get ak+2 bab2q\u22121 \u223c ak+3 b2q . But the latter is a\ncontradiction since ak+2 bab2q\u22121 and ak+3 b2q are distinct Lyndon words and due to Proposition 2.6 the\npolynomials \u03bb(ak+2 bab2q\u22121 ) and \u03bb(ak+3 b2q ) are linearly independent in KhAi.\nB. |t|a \u2265 1. In that case (9.11) yields\nk + n + 2 = l + m.\n\n(9.14)\n\nEquation (9.5) then becomes\n\u03bb(ak+1 bal btbam ) + (\u22121)k \u03bb(al btbam bak+1 ) = \u00b1 (k + 1) \u03bb(ak+2 ban bss\u0303ban bak+1 ).\n\n(9.15)\n\nLet P and Q denote respectively the left and the right hand side of (9.15). By Corollary 3.6 it is clear\nthat e(Q) = 2k + 2 and e(P ) \u2264 k + m + 1. It follows that 2k + 2 \u2264 k + m + 1, i.e., k + 1 \u2264 m.\nLemma 9.1. With k, l, m, n as above we claim that l = m = k + 1 and n = k.\nProof. First we show that l = k + 1. Suppose that k + 1 < l. Using (9.14) it is easy then to check that\nk + n + 2 is strictly larger than 2k + 2, k + l + 1 and k + m + 1. This permits us to apply Proposition 3.3 on\n(9.10) for factors of multi-degree (k + n + 2, 1), and finally obtain the contradiction bss\u0303ban bak+2 bak \u2261 0.\nTherefore we necessarily have\nl \u2264 k + 1 \u2264 m.\n(9.16)\nNow suppose that l < k + 1. Then clearly l < m and since |t|b is odd we get tbam bak+1 6\u2261 0 and therefore\nd(P ) = l in (9.15). On the other hand, d(Q) = k + 1, so we obtain k + 1 = l, a contradiction.\nNow we are ready to show that m = k + 1. Since l = k + 1 (9.14) yields m = n + 1, so we must show\nthat k = n. Equation (9.15) then reads\nk\n\n\u03bb(ak+1 bak+1 btban+1 ) + (\u22121) \u03bb(ak+1 btban+1 bak+1 ) = \u00b1 (k + 1) \u03bb(ak+2 ban bss\u0303ban bak+1 ).\n\n(9.17)\n\nSuppose, for the sake of contradiction, that k < n - it is enough to discard this case in view of (9.16).\nThen we would necessarily have ak+1 bt \u2261 0. Indeed, if not, Corollary 3.6 would yield e(P ) = k + n + 2.\nOn the other hand 2k+2 = e(Q), so we would get\u0001k = n, a contradiction. Thus we must have t = pp\u0303bak+1\nfor some p \u2208 A\u2217 and e ak+1 bak+1 bpp\u0303bak+1 ban+1 = k\u0001+ n + 1.\nIf n > k + 1 then since e ak+1 bpp\u0303bak+1 ban+1 bak+1 \u2264 2k + 2, we obtain e(P ) = k + n + 1. This must\nalso be equal to e(Q) = 2k + 2, so that n = k + 1, a contradiction.\nTherefore we may assume that n = k + 1, so that (9.10) becomes\nak bak+2 bak+1 bss\u0303b ak+1 bak+2 \u2261 \u00b1 ak+1 bak+1 bpp\u0303bak+1 b ak+2 bak+1 .\n21\n\n(9.18)\n\n\fWe apply Proposition 3.3 for factors of multi-degree (2k + 3, 1) on (9.18) and finally obtain\nbss\u0303bak+1 bak+2 bak \u2261 \u2213 bak+1 bpp\u0303bak+1 bak+1 ,\n\n(9.19)\n\nsince ak+1 bak+2 \u2261 \u2212 ak+2 bak+1 . Clearly both words in (9.19) lie in the support of the free Lie algebra.\nThen our induction hypothesis yields an immediate contradiction or it implies either bss\u0303bak+1 bak+2 bak =\nbak+1 bpp\u0303bak+1 bak+1 , or bss\u0303bak+1 bak+2 bak = ak+1 bak+1 pp\u0303bak+1 b. It is evident that both equalities can\nnot hold.\nIn view of Lemma 9.1 equation (9.10) finally becomes\nak bak+2 bak bss\u0303bak bak+2 \u2261 \u00b1 ak+1 bak+1 btbak+1 bak+1 .\n\n(9.20)\n\nWe apply Proposition 3.3 for factors of multi-degree (0, 1) on (9.20) and obtain\n\uf8f1\n\uf8fc\n\uf8f1\nk+2 k\nk\nk+2\nk\n\uf8f4\n\uf8f4\n\uf8f4\na\nba\nbss\u0303ba\nba\nak+1 btbak+1 bak+1\n\u2212ak+1\n+a\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nk+1 k+2 k\nk+1 k+1 k+1\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nak bss\u0303bak bak+2 \uf8f4\ntbak+1 bak+1\na\nba\na\nba\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 +(\u22121)\n\uf8fd\n\uf8f2 +(\u22121)\n..\n..\n=\u00b1\n.\n.\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nk+1 k+1\nk k+2 k\nk k+2\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\nt\u0303ba\nba\n\u2212\nss\u0303ba\nba\nba\na\nba\nak+1 bak+1\n\u2212\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n\uf8fe\n\uf8f3\nk\nak+2\nak+1\n+(\u22121) ak bss\u0303bak bak+2 bak\n+(\u22121)k+1 ak+1 bt\u0303bak+1 bak+1\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\u0001\n\n\uf8fc\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fd\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8fe\n\n. (9.21)\n\nFor the moment, let P be an arbitrary fixed Lie polynomial. Consider the integer coefficients of\nthe words in P that are marked in (9.21) by boxes. More precisely let \u03b71 = (P, ak bss\u0303bak bak+2 ),\np = (P, ss\u0303bak bak+2 bak ), \u03b72 = (P, ak+1 btbak+1 ), q = (P, tbak+1 bak+1 ) and r = (P, t\u0303bak+1 bak+1 ).\nWhen k is even (resp. odd) the common length of these words is odd (resp. even), therefore we get\n(P, ak+2 bak bss\u0303bak ) = (\u22121)k \u03b71 and (P, ak+1 bt\u0303bak+1 ) = (\u22121)k \u03b72 . If we act by P \u2704 on (9.21) then by\nProposition 2.3 we obtain\n(\n\u0002\n\u0003 )\n\u001b\n\u001a\n\u22122\u03b72 (ak+1 bak+1 ) +\n(\u22121)k \u03b71 ak bak+2 + ak+2 bak\n. (9.22)\n=\u00b1\n(\u22121)k+1 q(ak+1 bak+1 ) \u2212 r(ak+1 bak+1 )\n+ (\u22121)k+1 \u03b71 (ak+2 bak ) \u2212 p(ak bak+2 )\n\n\u0001\n\n\u0001\n\n\u0001\n\nUsing Lemma 2.4 we equate the coefficients of ba2k+2 in (9.22) and obtain the equation\n\u0012\n\u0013\n\u0012\n\u0013\n2k + 2\n2k + 2\nk\n.\n= \u2213 2\u03b72\n2(\u22121) \u03b71\nk+1\nk\n\n(9.23)\n\nSince ak bss\u0303bak bak+2 6\u2261 0 there exists a Lie polynomial P such that \u03b71 6= 0. Consider the coefficient\n(P, ak+1 btbak+1 ) of this particular polynomial. If (P, ak+1 btbak+1 ) = 0, i.e., \u03b72 = 0, then (9.23) yields a\ncontradiction. Thus we may assume that \u03b72 6= 0.\nSuppose that k \u2265 3. Collecting all coefficients of a2 ba2k in (9.22) by Lemma 2.4 we obtain\n\u0012\n\u0013\n\u0012 \u0013o\nn\u0012 2k \u0013\n2k\n2k\nk\n.\n(9.24)\n+\n= \u2213 2\u03b72\n(\u22121) \u03b71\nk\u22121\nk\u22122\nk\nHaving assured that \u03b71 , \u03b72 6= 0 we may divide (9.23) and (9.24) by parts and we obtain\n\u0012\n\u0013\n\u0012\n\u0013\n2k + 2\n2k + 2\nk\nk+1\n\u0012\n\u0013\n\u0012 \u0013 = \u0012\n\u0013.\n2k\n2k\n2k\n+\n2\nk\u22122\nk\nk\u22121\n\n(9.25)\n\nIt is easy to check, using the factorial definition of binomial coefficients, that (9.25) yields the absurd\n2k(k + 1) = (k \u2212 1)k + (k + 1)(k + 2).\nSuppose that k = 1. Our objective is to show that ss\u0303baba3 ba \u2261 0, which clearly leads to a contradiction. To do this we need to show that (P, ss\u0303baba3 ba) = 0, for any Lie polynomial P , which in this\ncase is equivalent to showing that p = 0. By (9.23) we get\n\u2212 4 \u03b71 = \u2213 6 \u03b72 .\n22\n\n(9.26)\n\n\fGoing back to (9.22) and collecting the coefficients of aba3 by Lemma 2.4 we get\n\u2212 4 \u03b71 \u2212 p = \u2213 6 \u03b72 .\n\n(9.27)\n\nBy (9.26) and (9.27) it follows that p = 0, as required.\nLet us finally deal with the case k = 2. Using Lemma 2.4 we collect all coefficients of the term a2 ba4\nfrom the shuffle products a2\nba4 , a3\nba3 and a4\nba2 and we get\n\n\u0001\n\n\u0001\n\n\u0001\n\n7 \u03b71 \u2212 p = \u2213 8 \u03b72 .\n\n(9.28)\n\nOn the other hand, by (9.24) we have 15 \u03b71 = \u2213 20 \u03b72 . Then from (9.28) it follows that p = \u03b71 . This\nimplies that for each Lie polynomial P we have (P, ss\u0303ba2 ba4 ba2 ) = (P, a4 ba2 bss\u0303ba2 ), i.e.,\nss\u0303ba2 ba4 ba2 \u2261 a4 ba2 bss\u0303ba2 .\n\n(9.29)\n\nSince both words have odd length our induction hypothesis implies that either ss\u0303ba2 ba4 ba2 = a2 bss\u0303ba2 ba4 ,\nwhich clearly can not hold, or ss\u0303ba2 ba4 ba2 = a4 ba2 bss\u0303ba2 . The latter yields a4 ba2 bss\u0303 = ss\u0303ba2 ba4 . By\nn\nLemma 2.1 then there exist u, v \u2208 A\u2217 such that a4 ba2 b = uv, ba2 ba4 = vu and ss\u0303 = u(ba2 ba4 ) , for\n4\n2\nsome n \u2265 0. Since v must start and finish with the letter b we either have u = a and v = ba b, or\nu = a4 ba2 and v = b. The latter implies that ss\u0303 is a palindrome of odd length, a contradiction. The\nd\nformer yields ss\u0303 = a4 (ba2 ba4 ) , d \u2265 0, so that (9.20) becomes\nd\n\na2 ba4 (ba2 ba4 ) b a2 ba4 \u2261 \u00b1 a3 ba3 btb a3 ba3 ,\n\nn \u2265 1.\n\n(9.30)\n\nBy successive applications of (3.5) we obtain\n\nIt follows that\n\n\u0012 \u00132\n\u0012 \u00132\n6\n6\n2 4 d\n(ba ba ) b \u2261 \u00b1\nbtb .\n2\n3\n\n(9.31)\n\n\u0012 \u00132\n\u0012 \u00132\n6\n6\n2 4 d\n\u03b3((ba ba ) b) =\n\u03b3(btb) ,\n2\n3\n\n(9.32)\n\nd\n\nwhich yields 9 \u03b3((ba2 ba4 ) b) = 16 \u03b3(btb). In view of Lemma 3.8 the left hand side is equal to an odd\npositive integer, so 16 can not divide it and we reach a contradiction.\n\n10\n\nProof of Theorem 1.6.\n\nLet w1 \u2261 \u00b1 w2 . In view of our analysis in \u00a74 and \u00a76 we may suppose that w1 = ak bubal and w2 =\nam bvban , where, without loss of generality, we have k \u2264 l and m \u2264 n.\nA. bub, bvb 6\u2261 0. We may assume that k \u2264 m, otherwise we interchange w1 and w2 . By Corollary 3.6 we have e(w1 ) = k + l and e(w2 ) = m + n, hence k + l = m + n. If k = m this implies that l = n,\nand our result follows from \u00a75.\nIf k < m we let m = k + r and n = l \u2212 r for some positive integer r. By Corollary 3.6 we have\nd(w1 ) = k, if ubal 6\u2261 0 and d(w1 ) = k + 1, otherwise. On the other hand, d(w2 ) \u2265 k + r. It follows that\nr = 1 and ubal \u2261 0. If k + 1 < l \u2212 1 our result follows from \u00a78, whereas if k + 1 = l \u2212 1 it follows from\n\u00a79.\nB. bub \u2261 0 and bvb 6\u2261 0. By Corollary 3.6 we have e(w1 ) = k + l \u2212 1 and e(w2 ) = m + n, and\ntherefore k + l \u2212 1 = m + n.\n(1) If u = xx\u0303 for some x \u2208 A\u2217 we must have k < l. Since xx\u0303bal 6\u2261 0 we get d(w1 ) = k. Our first\nclaim is that m = k. If m < n we have vban 6\u2261 0 since |v|b is even, so we get d(w2 ) = m and thus\nm = k. If m = n Corollary 3.6 implies that d(w2 ) \u2265 m. It follows that k \u2265 m. On the other hand, we\nhave 2m = k + l \u2212 1 \u2265 2k, since l \u2212 1 \u2265 k, which implies that m \u2265 k. Therefore, in any case, we have\nk = m. This implies that n = l \u2212 1. If k = l \u2212 1 our result follows from the analysis in \u00a77. If k < l \u2212 1\nequations (3.8) and (3.7) respectively yield xx\u0303bal \u2261 \u00b1 vbal\u22121 and xx\u0303bal\u22121 \u2261 \u00b1 vbal\u22122 . But these can\n23\n\n\fnot hold simultaneously. Indeed, suppose that xx\u0303bal \u2261 vbal\u22121 . By our induction hypothesis, since both\nwords are not even palindromes, their common length must be odd, hence l must be even. But then\nthe equality xx\u0303bal\u22121 \u2261 vbal\u22122 is impossible because the corresponding common length is even. For the\nminus sign we use similar arguments.\n(2) Suppose that bub = u2d+3 , for some d \u2265 0. Since k + l \u2212 1 = m + n we get |v|a = 1. Suppose that\nk < l and m < n. If vban 6\u2261 0 Corollary 3.6 yields d(w1 ) = k and d(w2 ) = m, therefore we get k = m,\nso that n = l \u2212 1. It also implies that b2d+2 al \u2261 \u00b1 vbal\u22121 , which is impossible due to our induction\nhypothesis. If vban \u2261 0 then we have v = an bss\u0303, for some s \u2208 A\u2217 and since |v|a = 1 we obtain n = 1\ncontradicting 1 \u2264 m < n.\nm+1\nSuppose that k < l and m = n. If (\u22121)\nvbam + am bv\u0012 6\u2261 0 Corollary\n3.6 yields \u0012d(w\u0013\n2 ) = m.\n\u0013\n2k + 1\n2k\n2d+2\nThus k = m and l = k + 1. By (3.5) and (3.6) then we have\n\u03bb(ab\n)b = \u2213\n\u03bb(bvb).\nk\nk\nSince ab2d+2 is a Lyndon word we have \u03b3(ab2d+2 ) = 1, so we get (k + 1)\u03b3(bvb) = (2k + 1) which yields\nm+1\nk + 1 | 2k + 1, a contradiction. If, on the other hand, (\u22121)\nvbam + am bv \u2261 0 we get d(w2 ) \u2265 m + 1.\nSince d(w1 ) = k we get k \u2265 m + 1. Then we get 2k \u2265 2m + 2 = k + l + 1. It follows that k \u2265 l + 1,\nwhich contradicts k < l.\nSuppose finally that k = l. Since 2k \u2212 1 = m + n we necessarily get m < n. Corollary 3.6 then implies\nk+1 2d+2 k\nthat d(w1 ) = k since (\u22121)\nb\na + ak b2d+2 6\u2261 0 because the latter is equivalent to 2 ak b2d+2 6\u2261 0.\nn\nIf vba 6\u2261 0 then d(w2 ) = m. It follows that m = k and hence n = k \u2212 1, which contradicts the fact that\nm < n. On the other hand, if vban \u2261 0 there exists a word s \u2208 A\u2217 such that vban = an bss\u0303ban . Since\n|v|a = 1 we must have |s|a = 0 and n = 1. But the latter contradicts our assumption 1 \u2264 m < n.\nC. bub \u2261 0 \u2261 bvb. If u = xx\u0303 and v = y \u1ef9 for some x, y \u2208 A\u2217 then we necessarily have k < l\nand m < n. Since xx\u0303bal 6\u2261 0 and y \u1ef9ban 6\u2261 0 Corollary 3.6 implies that d(w1 ) = k, d(w2 ) = m and\ne(w1 ) = k + l \u2212 1, e(w2 ) = m + n \u2212 1. Thus k = m and l = n. Thus we are dealing with the equation\nak bxx\u0303bal \u2261 \u00b1 ak by \u1ef9bal which has already been considered in \u00a75.\n\u0012\n\u0013\nk+l\nFinally, if bub = bvb = b2d+3 , for some d \u2265 0 then k+l = m+n. By (3.6) we also get\nab2d+2 \u2261\nk\n\u0012\n\u0013\nm+n\n\u00b1\nab2d+2 . The minus case is immediately dispatched. For the plus case we either get m = k\nm\nor m = l which respectively implies either that w1 = w2 or w1 = w\nf2 , as required.\n\nReferences\n[1] Duchamp, G., Krob, D.: Combinatorics in Trace Monoids II. In: Diekert, V., Rozenberg, G. (eds.)\nThe book of traces, pp. 83-129. World Scientific (1995)\n[2] Duchamp, G., Laugerotte, \u00c9., Luque, J.-G.: On the support of graph Lie algebras. Theoret. Comput.\nSci. 273, 283-294 (2002)\n[3] Duchamp, G., Thibon, J.-Y.: Le support de l'alg\u00e8bre de Lie libre. Discrete Math. 76, 123-132 (1989)\n[4] Katsura, M., Kobayashi, Y.: The shuffle algebra and its derivations. Theoret. Comput. Sci. 115,\n359-369 (1993)\n[5] Lothaire, M.: Combinatorics on Words. Encyclopedia of Mathematics and its Applications, vol. 17,\nAddison-Wesley, Reading (1983)\n[6] Michos, I.: On the support of the free Lie algebra: the Sch\u00fctzenberger problems. Discrete Math.\nand Theor. Comput. Science 12(3), 1-28 (2010)\n[7] Minh, H.N., Petitot, M.: Lyndon words, polylogarithms and the Riemann \u03b6 function. Discrete Math.\n217 273-292 (2000)\n[8] Ree, R.: Lie elements and algebra associated with shuffles. Ann. Math. 68 210-220 (1958)\n[9] Reutenauer, C.: Free Lie Algebras. London Mathematical Society Monographs. New Series, vol. 7.\nOxford Science Publications, The Clarendon Press, Oxford University Press, London (1993)\n\n24\n\n\f"}