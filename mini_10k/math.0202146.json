{"id": "http://arxiv.org/abs/math/0202146v1", "guidislink": true, "updated": "2002-02-15T15:46:51Z", "updated_parsed": [2002, 2, 15, 15, 46, 51, 4, 46, 0], "published": "2002-02-15T15:46:51Z", "published_parsed": [2002, 2, 15, 15, 46, 51, 4, 46, 0], "title": "Traffic Flow on a Road Network", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0601358%2Cmath%2F0601142%2Cmath%2F0601607%2Cmath%2F0601212%2Cmath%2F0601254%2Cmath%2F0601457%2Cmath%2F0601269%2Cmath%2F0601427%2Cmath%2F0601377%2Cmath%2F0601028%2Cmath%2F0601161%2Cmath%2F0601522%2Cmath%2F0601073%2Cmath%2F0601324%2Cmath%2F0601595%2Cmath%2F0601175%2Cmath%2F0601496%2Cmath%2F0601714%2Cmath%2F0601086%2Cmath%2F0202172%2Cmath%2F0202017%2Cmath%2F0202058%2Cmath%2F0202189%2Cmath%2F0202240%2Cmath%2F0202083%2Cmath%2F0202269%2Cmath%2F0202066%2Cmath%2F0202023%2Cmath%2F0202190%2Cmath%2F0202250%2Cmath%2F0202116%2Cmath%2F0202284%2Cmath%2F0202230%2Cmath%2F0202164%2Cmath%2F0202300%2Cmath%2F0202260%2Cmath%2F0202238%2Cmath%2F0202195%2Cmath%2F0202152%2Cmath%2F0202085%2Cmath%2F0202110%2Cmath%2F0202051%2Cmath%2F0202154%2Cmath%2F0202130%2Cmath%2F0202211%2Cmath%2F0202150%2Cmath%2F0202104%2Cmath%2F0202004%2Cmath%2F0202022%2Cmath%2F0202153%2Cmath%2F0202295%2Cmath%2F0202120%2Cmath%2F0202139%2Cmath%2F0202220%2Cmath%2F0202042%2Cmath%2F0202045%2Cmath%2F0202299%2Cmath%2F0202278%2Cmath%2F0202001%2Cmath%2F0202270%2Cmath%2F0202182%2Cmath%2F0202219%2Cmath%2F0202237%2Cmath%2F0202202%2Cmath%2F0202258%2Cmath%2F0202092%2Cmath%2F0202206%2Cmath%2F0202311%2Cmath%2F0202218%2Cmath%2F0202121%2Cmath%2F0202123%2Cmath%2F0202226%2Cmath%2F0202304%2Cmath%2F0202213%2Cmath%2F0202169%2Cmath%2F0202294%2Cmath%2F0202301%2Cmath%2F0202192%2Cmath%2F0202256%2Cmath%2F0202029%2Cmath%2F0202277%2Cmath%2F0202204%2Cmath%2F0202041%2Cmath%2F0202137%2Cmath%2F0202248%2Cmath%2F0202161%2Cmath%2F0202146%2Cmath%2F0202013%2Cmath%2F0202209%2Cmath%2F0202014%2Cmath%2F0202138%2Cmath%2F0202166%2Cmath%2F0202222%2Cmath%2F0202223%2Cmath%2F0202129%2Cmath%2F0202054%2Cmath%2F0202028%2Cmath%2F0202228%2Cmath%2F0202050%2Cmath%2F0202179%2Cmath%2F0202272&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Traffic Flow on a Road Network"}, "summary": "This paper is concerned with a fluidodynamic model for traffic flow. More\nprecisely, we consider a single conservation law, deduced from conservation of\nthe number of cars, defined on a road network that is a collection of roads\nwith junctions. The evolution problem is underdetermined at junctions, hence we\nchoose to have some fixed rules for the distribution of traffic plus an\noptimization criteria for the flux. We prove existence, uniqueness and\nstability of solutions to the Cauchy problem.\n  Our method is based on wave front tracking approach, (B), and works also for\nboundary data and time dependent coefficients of traffic distribution at\njunctions, so including traffic lights.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0601358%2Cmath%2F0601142%2Cmath%2F0601607%2Cmath%2F0601212%2Cmath%2F0601254%2Cmath%2F0601457%2Cmath%2F0601269%2Cmath%2F0601427%2Cmath%2F0601377%2Cmath%2F0601028%2Cmath%2F0601161%2Cmath%2F0601522%2Cmath%2F0601073%2Cmath%2F0601324%2Cmath%2F0601595%2Cmath%2F0601175%2Cmath%2F0601496%2Cmath%2F0601714%2Cmath%2F0601086%2Cmath%2F0202172%2Cmath%2F0202017%2Cmath%2F0202058%2Cmath%2F0202189%2Cmath%2F0202240%2Cmath%2F0202083%2Cmath%2F0202269%2Cmath%2F0202066%2Cmath%2F0202023%2Cmath%2F0202190%2Cmath%2F0202250%2Cmath%2F0202116%2Cmath%2F0202284%2Cmath%2F0202230%2Cmath%2F0202164%2Cmath%2F0202300%2Cmath%2F0202260%2Cmath%2F0202238%2Cmath%2F0202195%2Cmath%2F0202152%2Cmath%2F0202085%2Cmath%2F0202110%2Cmath%2F0202051%2Cmath%2F0202154%2Cmath%2F0202130%2Cmath%2F0202211%2Cmath%2F0202150%2Cmath%2F0202104%2Cmath%2F0202004%2Cmath%2F0202022%2Cmath%2F0202153%2Cmath%2F0202295%2Cmath%2F0202120%2Cmath%2F0202139%2Cmath%2F0202220%2Cmath%2F0202042%2Cmath%2F0202045%2Cmath%2F0202299%2Cmath%2F0202278%2Cmath%2F0202001%2Cmath%2F0202270%2Cmath%2F0202182%2Cmath%2F0202219%2Cmath%2F0202237%2Cmath%2F0202202%2Cmath%2F0202258%2Cmath%2F0202092%2Cmath%2F0202206%2Cmath%2F0202311%2Cmath%2F0202218%2Cmath%2F0202121%2Cmath%2F0202123%2Cmath%2F0202226%2Cmath%2F0202304%2Cmath%2F0202213%2Cmath%2F0202169%2Cmath%2F0202294%2Cmath%2F0202301%2Cmath%2F0202192%2Cmath%2F0202256%2Cmath%2F0202029%2Cmath%2F0202277%2Cmath%2F0202204%2Cmath%2F0202041%2Cmath%2F0202137%2Cmath%2F0202248%2Cmath%2F0202161%2Cmath%2F0202146%2Cmath%2F0202013%2Cmath%2F0202209%2Cmath%2F0202014%2Cmath%2F0202138%2Cmath%2F0202166%2Cmath%2F0202222%2Cmath%2F0202223%2Cmath%2F0202129%2Cmath%2F0202054%2Cmath%2F0202028%2Cmath%2F0202228%2Cmath%2F0202050%2Cmath%2F0202179%2Cmath%2F0202272&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "This paper is concerned with a fluidodynamic model for traffic flow. More\nprecisely, we consider a single conservation law, deduced from conservation of\nthe number of cars, defined on a road network that is a collection of roads\nwith junctions. The evolution problem is underdetermined at junctions, hence we\nchoose to have some fixed rules for the distribution of traffic plus an\noptimization criteria for the flux. We prove existence, uniqueness and\nstability of solutions to the Cauchy problem.\n  Our method is based on wave front tracking approach, (B), and works also for\nboundary data and time dependent coefficients of traffic distribution at\njunctions, so including traffic lights."}, "authors": ["G. M. Coclite", "B. Piccoli"], "author_detail": {"name": "B. Piccoli"}, "author": "B. Piccoli", "arxiv_comment": "26 pages, 5 figures", "links": [{"href": "http://arxiv.org/abs/math/0202146v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0202146v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AP", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0202146v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0202146v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0202146v1 [math.AP] 15 Feb 2002\n\nTraffic Flow on a Road Network\nGiuseppe Maria Coclite\n\n\u2217\n\nBenedetto Piccoli\n\n\u2020\n\nFebruary 2002\nAbstract\nThis paper is concerned with a fluidodynamic model for traffic flow. More precisely, we\nconsider a single conservation law, deduced from conservation of the number of cars,\ndefined on a road network that is a collection of roads with junctions. The evolution\nproblem is underdetermined at junctions, hence we choose to have some fixed rules for\nthe distribution of traffic plus an optimization criteria for the flux. We prove existence,\nuniqueness and stability of solutions to the Cauchy problem.\nOur method is based on wave front tracking approach, see [6], and works also for\nboundary data and time dependent coefficients of traffic distribution at junctions, so\nincluding traffic lights.\n\nKey Words: scalar conservation laws, traffic flow.\n\nRef. S.I.S.S.A. 13/2002/M\n\n\u2217 SISSA-ISAS,\n\u2020 Istituto\n\nvia Beirut 2-4, 34014 - Trieste, Italy; E-mail: coclite@sissa.it.\nper le Applicazioni del Calcolo \"M. Picone\", Viale del Policlinico 137, 00161 - Roma, Italy;\n\nE-mail: piccoli@iac.rm.cnr.it\n\n\f\f1\n\nIntroduction\n\nThis paper deals with a fluidodynamic model of heavy traffic on a road network. More\nprecisely, we consider the conservation law formulation proposed by Lighthill and Whitham\n[12] and Richards [13]. This nonlinear framework is based simply on the conservation of cars\nand is described by the equation:\n\u03c1t + f (\u03c1)x = 0,\n\n(1.1)\n\nwhere \u03c1 = \u03c1(t, x) \u2208 [0, \u03c1max ], (t, x) \u2208 IR2 , is the density of cars, v(t, x) is the velocity and\nf (\u03c1) = v \u03c1 is the flux. This model is appropriate to reveal shocks formation as it is natural\nfor conservation laws, whose solutions may develop discontinuities in finite time even for\nsmooth initial data, [6]. In most cases one assumes that v is a function of \u03c1 only and that\nthe corresponding flux is a concave function. We make the same assumption, moreover we\nlet f have a unique maximum \u03c3 \u2208]0, \u03c1max [ and for notational simplicity assume \u03c1max = 1.\nHere we deal with a network of roads, as in [11]. This means that we have a finite number\nof roads modeled by intervals [ai , bi ] (with one of the two endpoints possibly infinite) that\nmeet at some junctions. For endpoints that do not touch a junction (and are not infinite),\nwe assume to have a given boundary data and solve the corresponding boundary problem,\nas in [1, 2, 3, 5]. The key role is played by junctions at which the system is underdetermined\neven after prescribing the conservation of cars, that can be written as the Rankine-Hugoniot\nrelation:\n\nn\nX\n\nf (\u03c1i (t, bi )) =\n\nn+m\nX\n\nf (\u03c1j (t, aj )),\n\n(1.2)\n\nj=n+1\n\ni=1\n\nwhere \u03c1i , i = 1, . . . , n, are the car densities on incoming roads, while \u03c1j , j = n + 1, . . . , n + m,\nare the car densities on outgoing roads. In [11], the Riemann problem, that is the problem\nwith constant initial data on each road, is solved maximizing a concave function of the fluxes\nand it is proved existence of weak solutions for Cauchy problems with suitable initial data of\nbounded variation. In this paper we assume that:\n(A) there are some prescribed preferences of drivers, that is the traffic from incoming roads\nis distributed on outgoing roads according to fixed coefficients;\n(B) respecting (A), drivers choose so as to maximize fluxes.\nTo deal with rule (A), we fix a matrix\n.\nA = {\u03b1ji }j=n+1,...n+m, i=1,...,n \u2208 IRm\u00d7n ,\nsuch that\n\u03b1ji 6= \u03b1 ,\nji\u2032\n\n0 < \u03b1jn < 1,\n\nn+m\nX\n\nj=n+1\n\n1\n\n\u03b1ji = 1,\n\n(1.3)\n\n\f2\n\nG. M. Coclite and B. Piccoli\n\nfor each i\u2032 6= i = 1, ..., n and j = n+1, ..., n+m, where \u03b1ji is the percentage of drivers arriving\nfrom the i\u2212th incoming road that take the j\u2212th outgoing road. Notice that with only the\nrule (A) Riemann problems are still underdetermined. This choice represents a situation\nin which drivers have a final destination, hence distribute on outgoing roads according to a\nfixed law, but maximize the flux whenever possible. We are able to solve uniquely Riemann\nproblems and, in case of simple junctions with two incoming and outgoing roads, to generate\na Lipschitz semigroup, defined on L1 , whose trajectories are weak solutions and respect rules\n(A) and (B) in case of bounded variation (the same conditions are not meaningful if the\nsolution is only L1 ). Our main technique is the use of a front tracking algorithm and suitable\napproximations and functionals to control the total variation. We refer the reader to [6] for\nthe general theory of conservation laws and for a discussion of wave front tracking algorithms.\nThe main difficulty in solving systems of conservation laws is the control of the total\nvariation, see [6]. It is easy to see that for a single conservation law the total variation is\ndecreasing, however in our case it may increase due to interaction of waves with junctions.\nThe problem is quite delicate, as shown in Appendix B, where an example is given of a single\nwave of arbitrarily small strength (variation) that, interacting with a junction, generates\nwaves whose strengths are bounded away from zero. Hence we can not expect any bound on\nthe total variation of the solution in term of the total variation of the initial data, as it is\nthe case for systems. This arbitrarily large magnification of total variation is possible only if\nwaves crossing the value \u03c3 interact with junctions at which the boundary data of the roads\nare bad, that is in [0, \u03c3] for incoming roads and in [\u03c3, 1] for outgoing roads. We thus have\nfirst to deal with special data of bounded variation that have a finite number of crossing of\nthe value \u03c3. The sum of the number of these crossing plus the number of bad boundary data\nis proved to be decreasing along front tracking approximate solutions.\nHowever, this is not enough since the variation can still increase due to interactions with\njunctions (and there is no bound on the number of interactions). The conserved quantity\nis the total variation of the flux. We prove this fact for junctions with only two incoming\nroads and two outgoing ones, and show in Appendix A that the conclusion does not hold\nfor for junctions with three (or more) incoming and outgoing roads. Unfortunately the total\nvariation of the flux is not equivalent to the total variation of \u03c1, since f \u2032 (\u03c3) = 0. We thus\nhave to approximate the flux with one having never vanishing derivative and a corner at \u03c3,\nand then pass to the limit.\nOur techniques are quite flexible, so we can deal with time dependent coefficients for\nthe rule (A). In particular we can model traffic lights and also in this case the control of\ntotal variation is extremely delicate. An arbitrarily small change in the coefficients can\nproduce waves whose strength is bounded away from zero. Still it is possible to consider\n\n\f3\n\nTraffic Flow on a Road Network\n\nperiodic coefficients, a case of particular interest for applications. We can also deal with\nroads with different fluxes: this can be treated in the same way with the necessary notational\nmodifications.\nThere is an interesting ongoing discussion on hydrodynamic modelization for heavy traffic\nflow. In particular some models using systems of two conservation laws have been proposed,\nsee [4, 9, 10]. We do no treat this aspect.\nThe paper is organized as follows. in Section 2 we give the definition of weak entrtopic\nsolution and following (A) and (B) we introduce an admissibility condition. In Section 3 we\nprove the existence and uniqueness of admissible solutions for the Riemann Problem in a\njunction, then using this we describe the construction of the approximants for the Cauchy\nProblem (see Section 4). In section 5 we prove the monotonicity of the number of big waves\nfor piecewise constant solutions. Assuming that f \u2032 is bounded away from 0 and that there\nare at most two incoming and outcoming roads in each junction we prove the monotonicity\nof the total variation of the flux (see Section 6) and existence, uniqueness and stability of\nadmissible solutions for the Cauchy Problem with suitable BV initial data. Using these\nresults we show the existence of a unique Lipschitz semigroup of solutions defined on L1 (see\nSection 8) also in the case in which f is smooth. In Section 9 we describe what happens\nwhen there are traffic lights and time dependent coefficients. In Appendix A we show with an\nexample that the total variation of the flux can increase when there are three incoming and\nthree outcoming roads in a junction. Finally, in Appendix B we show that the interaction of\na small wave with a junction can produce a uniformly big wave.\n\n2\n\nBasic Definitions\n\nWe consider a network of roads, that is a modeled by a finite collection of intervals Ii =\n[ai , bi ] \u2282 IR, i = 1, . . . , N , possibly with either ai = \u2212\u221e or bi = +\u221e, on which we consider\nthe equation (1.1). Hence the datum is given by a finite collection of functions \u03c1i defined on\n[0, +\u221e[\u00d7Ii .\nOn each road Ii we want \u03c1i to be a weak entropic solution, that is for \u03c6 : Ii \u2192 IR smooth\nwith compact support on ]0, +\u221e[\u00d7]ai , bi [\nZ\n\n+\u221e\n0\n\nZ\n\nbi\n\nai\n\n\u0010 \u2202\u03c6\n\u2202\u03c6 \u0011\ndxdt = 0,\n\u03c1i\n+ f (\u03c1i )\n\u2202t\n\u2202x\n\n(2.4)\n\nand for every k \u2208 IR and \u03c6\u0303 : Ii \u2192 IR smooth, positive with compact support on ]0, +\u221e[\u00d7]ai , bi [\nZ\n\n+\u221e\n0\n\nZ\n\nbi\n\nai\n\n\u0010\n\n|\u03c1i \u2212 k|\n\n\u2202 \u03c6\u0303 \u0011\n\u2202 \u03c6\u0303\ndxdt \u2265 0,\n+ sgn (\u03c1i \u2212 k)(f (\u03c1i ) \u2212 f (k))\n\u2202t\n\u2202x\n\n(2.5)\n\n\f4\n\nG. M. Coclite and B. Piccoli\n\nIt is well known that for any initial data in L\u221e , defined on the whole IR, there exists a\nunique weak entropic solution depending in a Lipschitz continuous way from the initial data\nin L1loc .\nWe assume that the roads are connected by some junctions. Each junction J is given by\na finite number of incoming roads and a finite number of outgoing roads, thus we identify\nJ with ((i1 , . . . , in ), (j1 , . . . , jm )) where the first n\u2013tuple indicates the set of incoming roads\nand the second m\u2013tuple indicates the set of outgoing roads. We assume that each road can\nbe incoming road at most for one junction and outgoing at most for one junction.\nHence the complete model is given by a couple (I, J ), where I = {Ii : i = 1, . . . , N } is\nthe collection of roads and J the collection of junctions.\nFix a junction J with incoming roads, say I1 , . . . , In , and outgoing roads, say In+1 , . . . , In+m .\nA weak solution at the junction J is a collection of functions \u03c1i : [0, +\u221e[\u00d7Ii \u2192 IR, i =\n1, . . . , n + m, such that\nn+m\nX \u0012 Z +\u221e\nl=0\n\n0\n\nZ\n\nbl\n\nal\n\n\u0011\n\u0010 \u2202\u03c6\n\u2202\u03c6l \u0011\nl\ndxdt = 0\n+ f (\u03c1l )\n\u03c1l\n\u2202t\n\u2202x\n\n(2.6)\n\nfor each \u03c61 , ..., \u03c6n+m smooth having compact support in ]0, +\u221e[\u00d7IR, that are also smooth\nacross the junction,i.e.\n\u03c6i (*, bi ) = \u03c6j (*, aj ),\n\n\u2202\u03c6i\n\u2202\u03c6j\n(*, bi ) =\n(*, aj ),\n\u2202x\n\u2202x\n\ni = 1, ..., n, j = n + 1, ..., n + m.\n\nRemark 2.1 Let \u03c1 = (\u03c11 , . . . , \u03c1n+m ) be a solution of (1.1) such that each x \u2192 \u03c1i (t, x) has\nbounded variation. We can deduce that it satisfies the Rankine-Hugoniot Condition in the\njunction J, namely\nn\nX\n\nf (\u03c1i (t, bi )) =\n\ni=1\n\nfor each t > 0.\n\nn+m\nX\n\nf (\u03c1j (t, aj )),\n\n(2.7)\n\nj=n+1\n\nRemark 2.2 The assumption \u03b1ji 6= \u03b1ji\u2032 in (1.3)is needed in order to have uniqueness of solutions to Riemann problems, see Section 3. However, this condition can be relaxed requiring,\nfor example, that if \u03b1ji = \u03b1ji\u2032 then the fluxes from road i and i\u2032 coincide.\nThe rules (A) and (B) can be given explicitly only for solutions with bounded variation\nat each time as in next definition.\nDefinition 2.1 Let \u03c1 = (\u03c11 , . . . , \u03c1n+m ) be such that \u03c1i (t, *) is of bounded variation. Then \u03c1\nis an admissible weak solution of (1.1) related to the matrix A satisfying (1.3) at the junction\nJ if and only if following properties hold:\n\n\fTraffic Flow on a Road Network\n\n5\n\n(i) \u03c1 is a weak solution at the junction;\n(ii) f (\u03c1j (*, aj +)) =\n\nn\nP\n\n\u03b1ji f (\u03c1i (*, bi \u2212)), for each j = n + 1, ..., n + m;\n\ni=1\n\n(iii)\n\nn\nP\n\nf (\u03c1i (*, bi \u2212)) +\n\ni=1\n\nn+m\nP\n\nf (\u03c1j (*, aj +)) is maximum subject to (ii).\n\nj=n+1\n\nFor every road Ii = [ai , bi ], if ai > \u2212\u221e and Ii is not the outgoing of any junction, or bi < +\u221e\nand Ii is not the incoming road of any function, then a boundary data \u03c8i : [0, +\u221e[\u2192 IR is\ngiven. In this case we ask \u03c1i to satisfy \u03c1i (t, ai ) = \u03c8i (t) (or \u03c1i (t, bi ) = \u03c8i (t)) in the sense of\n[5].\nOur aim is to solve the Cauchy problem on [0, +\u221e[ for a given initial and boundary data\nas in next definition.\nDefinition 2.2 Given \u03c1\u0304i : Ii \u2192 IR and possibly \u03c8i : [0, +\u221e[\u2192 IR, functions of L\u221e , a\ncollection of functions \u03c1 = (\u03c11 , . . . , \u03c1N ) with \u03c1i : [0, +\u221e[\u00d7Ii \u2192 IR continuous as functions\nfrom [0, +\u221e[ into L1loc , is an admissible solution if \u03c1i is a weak entropic solution to (1.1) on\nIi , \u03c1i (0, x) = \u03c1\u0304i (x) a.e., \u03c1i (t, bi ) = \u03c8i (t) in the sense of [5], finally such that at each junction\n\u03c1 is a weak solution and is an admissible weak solution in case of bounded variation.\nThe treatment of boundary data in the sense of [5] can be done in the same way as in [1, 2, 3],\nthus we treat the case without boundary data. All the stated results hold also for the case\nwith boundary data with the obvious modifications.\nOn the flux f we make the following assumption\n(F ) f : [0, 1] \u2192 IR is smooth, strictly concave (i.e. f \u2032\u2032 \u2264 \u2212c < 0 for some c > 0),\nf (0) = f (1) = 0, |f \u2032 (x)| \u2264 C < +\u221e and there exists \u03c3 \u2208]0, 1[ such that f \u2032 (\u03c3) = 0 (that\nis \u03c3 is a strict maximum).\n\n3\n\nThe Riemann Problem\n\nIn this section we study Riemann problems. For a scalar conservation law a Riemann problem\nis a Cauchy problem for an initial data of Heaviside type, that is piecewise constant with\nonly one discontinuity. The solutions of these problems are the building blocks to construct\nsolutions to the Cauchy problem via wave front tracking. These solutions are formed by\ncontinuous waves called rarefactions and traveling discontinuities called shocks. The speed\nof waves are related to the values of f \u2032 (\u03c1).\nAnalogously, we call Riemann problem for the road network the Cauchy problem corresponding to an initial data that is piecewise constant on each road. The solutions on each\n\n\f6\n\nG. M. Coclite and B. Piccoli\n\nroad Ii can be constructed in the same way as for the scalar conservation law, hence it suffices\nto describe the solution at junctions. Because of finite propagation speed, it is enough to\nstudy the Riemann Problem for a single junction.\nAs explained in the Introduction, we first have to treat the case of fluxes with nonvanishing\nderivative, hence we assume that\n(F 1) f : [0, 1] \u2192 IR is continuous, strictly concave, f (0) = f (1) = 0 and there exists \u03c3 \u2208]0, 1[\nsuch that f is smooth on [0, \u03c3[ and on ]\u03c3, 1] and\n0 < c \u2264 |f \u2032 (x)| \u2264 C < +\u221e,\n\n(3.8)\n\nfor each x \u2208 [0, \u03c3[\u222a]\u03c3, 1].\nConsider a junction J in which there are n roads with incoming traffic and m roads with\noutgoing traffic. For simplicity we indicate by\n(t, x) \u2208 IR+ \u00d7 Ii 7\u2192 \u03c1i (t, x) \u2208 [0, 1],\n\ni = 1, ..., n\n\n(3.9)\n\nthe densities of the cars on the road with incoming traffic and\n(t, x) \u2208 IR+ \u00d7 Ij 7\u2192 \u03c1j (t, x) \u2208 [0, 1],\n\nj = n + 1, ..., n + m\n\nthose on the roads with outgoing traffic.\n1\n\nn+1\n\nn+2\n2\n\n3\n\nn\n\nn+m\n\nfigure 1\nWe need some more notation:\nDefinition 3.1 Let \u03c4 : [0, 1] \u2192 [0, 1], \u03c4 (\u03c3) = \u03c3, be the map satisfying the following\n\u03c4 (\u03c1) 6= \u03c1,\n\nf (\u03c4 (\u03c1)) = f (\u03c1),\n\nfor each \u03c1 6= \u03c3.\nClearly \u03c4 is well defined and satisfies\n0 \u2264 \u03c1 \u2264 \u03c3 \u21d0\u21d2 \u03c3 \u2264 \u03c4 (\u03c1) \u2264 1,\n\n\u03c3 \u2264 \u03c1 \u2264 1 \u21d0\u21d2 0 \u2264 \u03c4 (\u03c1) \u2264 \u03c3.\n\nThe main result of this section is the following Theorem.\n\n(3.10)\n\n\f7\n\nTraffic Flow on a Road Network\n\nTheorem 3.1 Let f : [0, 1] \u2192 IR satisfy (F 1) and \u03c11,0 , ..., \u03c1n+m,0 \u2208 [0, 1] be constants.\nThere exists an unique admissible weak solution, in the sense of Definition 2.1, \u03c1 = \u03c11 , ..., \u03c1n+m\nof (1.1) at the junction J such that\n\u03c11 (0, *) \u2261 \u03c11,0 , ......, \u03c1n+m (0, *) \u2261 \u03c1n+m,0 .\nMoreover, there exist a unique (n + m)\u2212tuple (\u03c1\u03021 , ..., \u03c1\u0302n+m ) \u2208 [0, 1]n+m such that\n\u03c1\u0302i \u2208\n\n(\n\n{\u03c1i,0 }\u222a]\u03c4 (\u03c1i,0 )1] if 0 \u2264 \u03c1i,0 \u2264 \u03c3,\n\ni = 1, ..., n\n\nif \u03c3 \u2264 \u03c1i,0 \u2264 1,\n\n[\u03c3, 1]\n\n(3.11)\n\nand\n\u03c1\u0302j \u2208\n\n(\n\n[0, \u03c3]\n\nif 0 \u2264 \u03c1j,0 \u2264 \u03c3,\n\n{\u03c1j,0 } \u222a [0, \u03c4 (\u03c1j,0 )[\n\nif \u03c3 \u2264 \u03c1j,0 \u2264 1,\n\nj = n + 1, ..., n + m.\n\n(3.12)\n\nFixed i \u2208 {1, ..., n}, if \u03c1i,0 \u2264 \u03c1\u0302i there results\n\u03c1i (t, x) =\n\n(\n\nf (\u03c1\u0302i )\u2212f (\u03c1i,0 )\nt,\n\u03c1\u0302i \u2212\u03c1i,0\n\n\u03c1i,0\n\nif x \u2264\n\n\u03c1\u0302i\n\notherwise,\n\n(3.13)\n\nand if \u03c1\u0302i < \u03c1i,0\n\uf8f1\n\uf8f4\n\uf8f4\n\uf8f2 \u03c1i,0\u0001\n\u22121\n\u03c1i (t, x) =\nf\u2032\n\uf8f4\n\uf8f4\n\uf8f3 \u03c1\u0302\ni\n\nif x \u2264 f \u2032 (\u03c1i,0 )t,\n\u0001\nx\nt\n\nif f \u2032 (\u03c1i,0 )t \u2264 x \u2264 f \u2032 (\u03c1\u0302i )t,\n\n(3.14)\n\n\u2032\n\nif x > f (\u03c1\u0302i )t.\n\nOtherwise, fixed j \u2208 {n + 1, ..., n + m}, if \u03c1j,0 \u2264 \u03c1\u0302j there results\n\uf8f1\n\uf8f4\nif x \u2264 f \u2032 (\u03c1\u0302j )t,\n\uf8f4\n\uf8f2 \u03c1\u0302j \u0001\n\u0001\n\u22121 x\n\u03c1j (t, x) =\nf\u2032\nif f \u2032 (\u03c1\u0302j )t \u2264 x \u2264 f \u2032 (\u03c1j,0 )t,\nt\n\uf8f4\n\uf8f4\n\uf8f3 \u03c1\nif x > f \u2032 (\u03c1 )t,\nj,0\n\n(3.15)\n\nj,0\n\nand if \u03c1\u0302j < \u03c1j,0\n\n\u03c1j (t, x) =\n\n(\n\nf (\u03c1j,0 )\u2212f (\u03c1\u0302j )\nt,\n\u03c1\u0302i \u2212\u03c1i,0\n\n\u03c1\u0302j\n\nif x \u2264\n\n\u03c1j,0\n\notherwise.\n\nProof. Define the map\nE : (\u03b31 , ..., \u03b3n ) \u2208 IRn 7\u2212\u2192\n\nn\nX\n\n\u03b3i\n\ni=1\n\nand the sets\n.\n\u03a9i =\n\n(\n\n[0, f (\u03c1i,0 )]\n\nif 0 \u2264 \u03c1i,0 \u2264 \u03c3,\n\n[0, f (\u03c3)]\n\nif \u03c3 \u2264 \u03c1i,0 \u2264 1,\n\ni = 1, ..., n,\n\n(3.16)\n\n\u0001\n\n\f8\n\nG. M. Coclite and B. Piccoli\n\n.\n\u03a9j =\n\n(\n\nif 0 \u2264 \u03c1j,0 \u2264 \u03c3,\n\n[0, f (\u03c3)]\n\n[0, f (\u03c1j,0 )] if \u03c3 \u2264 \u03c1j,0 \u2264 1,\n\nj = n + 1, ..., n + m,\n\no\nn\n.\n\u03a9 = (\u03b31 , ..., \u03b3n ) \u2208 \u03a91 \u00d7 .... \u00d7 \u03a9n A * (\u03b31 , ..., \u03b3n )T \u2208 \u03a9n+1 \u00d7 .... \u00d7 \u03a9n+m .\n\nSince E is linear, the set \u03a9 is closed, convex and not empty. By (1.3) there exists a unique\nvector (\u03b3\u03021 , ..., \u03b3\u0302n ) \u2208 \u03a9 such that\nE(\u03b3\u03021 , ..., \u03b3\u0302n ) =\n\nmax\n\n(\u03b31 ,...,\u03b3n )\u2208\u03a9\n\nE(\u03b31 , ..., \u03b3n ).\n\nFix i \u2208 {1, ..., n}, let \u03c1\u0302i \u2208 [0, 1] be such that\n(\n{\u03c1i,0 }\u222a]\u03c4 (\u03c1i,0 )1] if 0 \u2264 \u03c1i,0 \u2264 \u03c3,\nf (\u03c1\u0302i ) = \u03b3\u0302i , \u03c1\u0302i \u2208\n[\u03c3, 1]\nif \u03c3 \u2264 \u03c1i,0 \u2264 1.\nBy (F 1), \u03c1\u0302i exists and is unique. Let\nn\n\n. X\n\u03b1ji \u03b3\u0302i ,\n\u03b3\u0302j =\n\nj = n + 1, ..., n + m\n\ni=1\n\nand \u03c1\u0302j \u2208 [0, 1] be such that\nf (\u03c1\u0302j ) = \u03b3\u0302j ,\n\n\u03c1\u0302j \u2208\n\n(\n\n[0, \u03c3]\n\nif 0 \u2264 \u03c1j,0 \u2264 \u03c3,\n\n{\u03c1j,0 } \u222a [0, \u03c4 (\u03c1j,0 )[ if \u03c3 \u2264 \u03c1j,0 \u2264 1.\n\nSince (\u03b3\u03021 , ..., \u03b3\u0302n ) \u2208 \u03a9, \u03c1\u0302j exists and is unique. Solving the Riemann Problem (see [6, Chapter\n6]) on each road, the thesis is proved.\n\n4\n\n\u2737\n\nThe Wave Front Tracking Algorithm\n\nOnce the solution to a Riemann problem is provided, we are able to construct piecewise\nconstant approximations via wave-front tracking. The construction is very similar to that\nfor scalar conservation law, see [6], hence we only briefly describe it.\nLet \u03c10 be a piecewise constant map defined on the road network. We want to construct\na solution of (1.1) with initial condition \u03c1(0, *) \u2261 \u03c10 . We begin by solving the Riemann\nProblems on each road in correspondence of the jumps of \u03c10 and the Riemann Problems at\njunctions determined by the values of \u03c10 (see Theorem 3.1). We split each rarefaction wave\ninto a rarefaction fan formed by rarefaction shocks, that are discontinuities traveling with\nthe Rankine-Hugoniot speed. We always split rarefaction waves inserting the value \u03c3 (if it is\nin the range of the rarefaction), in order to control the number of big waves defined in next\nSection.\n\n\f9\n\nTraffic Flow on a Road Network\n\nWhen a wave interacts with another one we simply solve the new Riemann Problem, if\notherwise it reaches a junction then we solve the Riemann Problem at the junction. Since\nthe wave speed is bounded there are finitely many waves on the network at each time t \u2265 0.\nWe call the obtained function a wave front tracking approximate solution. Given a general\ninitial data, we approximate it by a sequence of piecewise constant functions and construct\nthe corresponding approximate solutions. If they converge in L1loc , then the limit is a weak\nentropic solution on each road, see [6] for a proof.\n\n5\n\nEstimates on the Number of Big Waves\n\nIn this Section we consider big waves, that are the waves crossing the value \u03c3. For these\nwaves the variation of f (\u03c1) is not comparable to the variation in \u03c1, more precisely the former\ncan vanish while the second is different from zero. Since only the variation of f (\u03c1) happens\nto be conserved we need to control the number of big waves.\nLet \u03c1 a piecewise constant map defined on the network and J a junction with n roads\nwith incoming traffic and m roads with outgoing traffic as in Section 3. Define the set\n\b\n. \b\n\u03a6J (\u03c1) = i \u2208 {1, ..., n} \u03c1i (bi \u2212) \u2208 [0, \u03c3] \u222a j \u2208 {n + 1, ..., n + m} \u03c1j (aj +) \u2208 [\u03c3, 1] .\n\nFor each road Ii we denote by {x\u03b1 \u2208 Ii : \u03b1 \u2208 Ai } and by {(\u03c1(x\u03b1 \u2212), \u03c1(x\u03b1 +)) : \u03b1 \u2208 Ai } the\nset of discontinuity points and the set of discontinuities, respectively, of the map \u03c1i on the\nroad Ii . We define\n\u0001\n\u0001\n. \b\nGi (\u03c1) = (\u03c1(x\u03b1 \u2212), \u03c1(x\u03b1 +)) \u03b1 \u2208 Ai , sgn \u03c1k (x\u03b1 \u2212) \u2212 \u03c3 * sgn \u03c1k (x\u03b1 +) \u2212 \u03c3 \u2264 0},\n\nwith the agreement sgn (0) = 0, and the functional\n\nN\n\u0001\n\u0001 X\n. X\n# Gi (\u03c1) ,\nN (\u03c1) =\n# \u03a6J (\u03c1) +\nJ\u2208J\n\ni=1\n\nwhere # indicates the cardinality of a set.\nThe main result of this section is the following.\nLemma 5.1 Let f : [0, 1] \u2192 IR satisfy (F 1) and \u03c1 be a piecewise constant wave front tracking\napproximate solution of (1.1) on the net. Then the map\n\ndoes not increase.\n\n\u0001\nt > 0 7\u2212\u2192 N \u03c1(t, *)\n\n\f10\n\nG. M. Coclite and B. Piccoli\n\nProof. We begin considering a single junction J with n roads with incoming traffic and\nm roads with outgoing traffic and an equilibrium configuration (\u03c11,0 , ..., \u03c1n+m,0 ) \u2208 [0, 1]n+m ,\nnamely the solution of the Riemann Problem in the junction with that initial data is constant.\nSuppose that a wave on one road arrives to the junction at time t\u0304 and there is no other wave\n\u0001\n\u0001\non the roads, then we claim that N \u03c1(t\u0304\u2212, *) = N \u03c1(t\u0304+, *) . Assume that the wave is on an\n\nincoming road, for example the first one and let (\u03c11 , \u03c11,0 ) be the values on the left and right\nside of the wave respectively. Since the wave is approaching the junction, its speed is positive\nand so 0 \u2264 \u03c11 \u2264 \u03c3, moreover since it is the unique wave\n\u0001\nGi \u03c1(t\u0304\u2212, *) = \u2205,\n\ni = 2, ..., n + m.\n\nLet (\u03c1\u03021 , ..., \u03c1\u0302n+m ) be the solution to the Riemann Problem with initial data (\u03c11 , \u03c12,0 ..., \u03c1n+m,0 )\n(see Theorem 3.1), there results\n\u03c1\u03021 \u2208 {\u03c11 } \u222a [\u03c3, 1]\n\u03c1\u0302i \u2208 {\u03c1i,0 } \u222a [\u03c3, 1],\n\u03c1\u0302j \u2208 {\u03c1j,0 } \u222a [0, \u03c3],\n\ni = 2, ..., n\nj = n + 1, ..., n + m.\n\nIn the following we study the change of the functional N due to the presence of new waves.\nIf a new rarefaction is produced then it can not cross the value \u03c3, otherwise there would\nbe rarefaction shocks with positive and negative velocity at the same time. Hence each\nfunctional Gi can not be bigger than one after the interaction. By abuse of notation, we\nindicate the whole rarefaction fan as a single wave for notational simplicity.\n\u0001\nSo, fixed i \u2208 {2, ..., n}, if i 6\u2208 \u03a6J \u03c1(t\u0304\u2212, *) , then\n\u0001\ni 6\u2208 \u03a6J \u03c1(t\u0304+, *) ,\n\n\u0001\nand if i \u2208 \u03a6J \u03c1(t\u0304\u2212, *) we have\n\n\u0001\n(\u03c1i,0 , \u03c1\u0302i ) 6\u2208 Gi \u03c1(t\u0304+, *) ,\n\n\u0001\n\u0001\n\u03c1\u0302i = \u03c1i,0 =\u21d2 i \u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c1i,0 , \u03c1\u0302i ) 6\u2208 Gi \u03c1(t\u0304+, *) ,\n\n\u0001\n\u0001\n\u03c3 \u2264 \u03c1\u0302i \u2264 1 =\u21d2 i 6\u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c1i,0 , \u03c1\u0302i ) \u2208 Gi \u03c1(t\u0304+, *) .\n\u0001\nOn the other hand, fixed j \u2208 {n + 1, ..., n + m}, if j 6\u2208 \u03a6J \u03c1(t\u0304\u2212, *) , then\n\u0001\nj 6\u2208 \u03a6J \u03c1(t\u0304+, *) ,\n\n\u0001\nand if j \u2208 \u03a6J \u03c1(t\u0304\u2212, *) we have\n\n\u0001\n(\u03c1\u0302j , \u03c1j,0 ) 6\u2208 Gj \u03c1(t\u0304+, *) ,\n\n\u0001\n\u0001\n\u03c1\u0302j = \u03c1j,0 =\u21d2 j \u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c1\u0302j , \u03c1j,0 ) 6\u2208 Gj \u03c1(t\u0304+, *) ,\n\n\u0001\n\u0001\n0 \u2264 \u03c1\u0302j \u2264 \u03c3 =\u21d2 j 6\u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c1\u0302j , \u03c1j,0 ) \u2208 Gj \u03c1(t\u0304+, *) .\n\n\f11\n\nTraffic Flow on a Road Network\n\nHence the contribution to N due to roads Ii , i = 2, . . . , n + m, does not increase. Let us now\ntreat the waves on the first road.\nNotice that if \u03c11,0 = \u03c3 then \u03c11 6= \u03c3 hence\n\u0001\n1 \u2208 \u03a6J \u03c1(t\u0304\u2212, *) ,\n\n\u0001\n(\u03c11 , \u03c11,0 ) \u2208 G1 \u03c1(t\u0304\u2212, *)\n\nand N can not increase. The same conclusion holds if 0 \u2264 \u03c11,0 < \u03c3 and \u03c11 = \u03c3.\nNow, if 0 \u2264 \u03c11,0 < \u03c3 and \u03c11 6= \u03c3, then there results\n\u0001\n1 \u2208 \u03a6J \u03c1(t\u0304\u2212, *) ,\n\nand\n\n\u0001\n(\u03c11 , \u03c11,0 ) \u2208\n/ G1 \u03c1(t\u0304\u2212, *)\n\n\u0001\n\u0001\n\u03c1\u03021 = \u03c11 =\u21d2 1 \u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c11 , \u03c1\u03021 ) 6\u2208 G1 \u03c1(t\u0304+, *) ,\n\n\u0001\n\u0001\n\u03c1\u03021 6= \u03c11 =\u21d2 \u03c3 < \u03c1\u03021 \u2264 1 =\u21d2 1 6\u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c11 , \u03c1\u03021 ) \u2208 G1 \u03c1(t\u0304+, *) .\n\nIf \u03c3 < \u03c11,0 \u2264 1 and \u03c11 = \u03c3 we have\n\n\u0001\n1 6\u2208 \u03a6J \u03c1(t\u0304\u2212, *) ,\n\nand\n\n\u0001\n(\u03c11 , \u03c11,0 ) \u2208 G1 \u03c1(t\u0304\u2212, *)\n\n\u0001\n\u0001\n\u03c1\u03021 = \u03c11 = \u03c3 =\u21d2 1 \u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c11 , \u03c1\u03021 ) 6\u2208 G1 \u03c1(t\u0304+, *) ,\n\u0001\n\u0001\n\u03c3 < \u03c1\u03021 \u2264 1 =\u21d2 1 6\u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c11 , \u03c1\u03021 ) \u2208 G1 \u03c1(t\u0304+, *) .\n\nFinally, if \u03c3 < \u03c11,0 \u2264 1 then \u03c11 6= \u03c3, \u03c1\u03021 6= \u03c3, and we have\n\u0001\n1 6\u2208 \u03a6J \u03c1(t\u0304\u2212, *) ,\n\nhence\n\n\u0001\n(\u03c11 , \u03c11,0 ) \u2208 G1 \u03c1(t\u0304\u2212, *) ,\n\n\u0001\n\u0001\n\u03c1\u03021 = \u03c11 =\u21d2 1 \u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c11 , \u03c1\u03021 ) 6\u2208 G1 \u03c1(t\u0304+, *) ,\n\nWe conclude\n\n\u0001\n\u0001\n\u03c3 < \u03c1\u03021 \u2264 1 =\u21d2 1 6\u2208 \u03a6J \u03c1(t\u0304+, *) , (\u03c11 , \u03c1\u03021 ) \u2208 G1 \u03c1(t\u0304+, *) .\n\u0001\n\u0001\nN \u03c1(t\u0304+, *) = N \u03c1(t\u0304\u2212, *) .\n\nThe conclusion can be obtained in the same way if the wave is arriving to the junction\nfrom another road. Moreover, when two waves interact on the same road then there is a\ncancellation or gluing of waves and it is easy to check that N is constant or decreases. The\nproof is concluded.\n\n\u2737\n\n\f12\n\n6\n\nG. M. Coclite and B. Piccoli\n\nEstimates on Flux Variation\nThis Section is dedicated to the estimation of the total variation of the flux along a\n\nsolution. We assume that every junction has at most two incoming roads and two outgoing\nones. This hypothesis is crucial, because, as shown in the Appendix A, the presence of more\ncomplicate junctions provokes increase of the total variation of the flux.\nLemma 6.1 Let f : [0, 1] \u2192 IR satisfy (F 1). Consider a network (I, J ) in which each\njunction has at most two incoming road and two outgoing ones. Let \u03c1 be a piecewise constant\nwave front tracking approximate solution.Then the map\n\u0001\nt > 0 7\u2192 Tot.Var. f (\u03c1(t, *)) ,\n\nis not increasing.\n\nProof. First of all we consider a single junction J with n \u2264 2 roads with incoming traffic\nand m \u2264 2 roads with outgoing traffic as in Section 3. It suffices to study the case n = m = 2,\nthe other ones are simpler. Let (\u03c11,0 , ..., \u03c14,0 ) be an equilibrium configuration in the junction\nJ. Assume that a wave comes to the junction at the time t\u0304, we claim that\n\u0001\n\u0001\nTot.Var. f (\u03c1(t\u0304+, *)) = Tot.Var. f (\u03c1(t\u0304\u2212, *)) .\n\n(6.17)\n\nWe begin assuming that the wave is on an incoming road, for example the first one, and that\nit is given by the values (\u03c11 , \u03c11,0 ). Let us define the incoming flux\n.\nf (y) =\n\n(\n\n.\n(y) =\n\n(\n\nin\n\nf (y)\n\nif 0 \u2264 y \u2264 \u03c3,\n\nf (\u03c3)\n\nif \u03c3 \u2264 y \u2264 1,\n\nf (\u03c3)\n\nif 0 \u2264 y \u2264 \u03c3,\n\nf (y)\n\nif \u03c3 \u2264 y \u2264 1.\n\n(6.18)\n\nand the outgoing flux\nf\n\nout\n\n(6.19)\n\nClearly, since the wave on the first road has positive velocity, we have\n0 \u2264 \u03c11 \u2264 \u03c3,\n\nf (\u03c11 ) < f out (\u03c11,0 ).\n\n(6.20)\n\nLet (\u03c1\u03021 , ..., \u03c1\u03024 ) the solution of the Riemann Problem in the junction J with initial data\n\u0001\n(\u03c11 , ..., \u03c14,0 ) (see Theorem 3.1). By definition f (\u03c11,0 ), f (\u03c12,0 ) is the maximum of the map\n\nE on the domain\n\no\nn\n.\n\u03a90 = (\u03b31 , \u03b32 ) \u2208 \u03a91,0 \u00d7 \u03a92,0 A * (\u03b31 , \u03b32 )T \u2208 \u03a93,0 \u00d7 \u03a94,0 ,\n\n\f13\n\nTraffic Flow on a Road Network\n\n\u0001\nand f (\u03c1\u03021 ), f (\u03c1\u03022 ) is the maximum of the map E on the domain\no\nn\n.\n\u03a9\u0302 = (\u03b31 , \u03b32 ) \u2208 \u03a91 \u00d7 \u03a92,0 A * (\u03b31 , \u03b32 )T \u2208 \u03a93,0 \u00d7 \u03a94,0 ,\nwhere\n\n\u03a9j,0\nand ,by (6.20),\n\n.\n=\n\n(\n\n[0, f in (\u03c1j,0 )]\n\nif j = 1, 2,\n\nout\n\nif j = 3, 4,\n\n[0, f\n\n(\u03c1j,0 )]\n\n.\n\u03a91 = [0, f in (\u03c11 )] = [0, f (\u03c11 )].\n\nIt is also clear that\n\u0001\nf (\u03c11,0 ), f (\u03c12,0 ) \u2208 \u2202\u03a90 ,\n\nTo simplify the notations, define\n\n.\n\u03b11 = \u03b131 ,\n\n\u0001\nf (\u03c1\u03021,0 ), f (\u03c1\u03022,0 ) \u2208 \u2202 \u03a9\u0302.\n.\n\u03b12 = \u03b132\n\nthen, by (1.3),\n1 \u2212 \u03b11 = \u03b141 ,\n\n1 \u2212 \u03b12 = \u03b142\n\nWe distinguish two cases. First we suppose that\nf (\u03c11 ) < f (\u03c11,0 ),\n\n(6.21)\n\n(equality can not happen in the previous equation because the wave would have velocity\nzero). Then there results \u03a9\u0302 \u2282 \u03a90 , hence\nf (\u03c1\u03021 ) \u2264 f (\u03c11 ) < f (\u03c11,0 ),\n\nf (\u03c1\u03021 ) + f (\u03c1\u03022 ) \u2264 f (\u03c11,0 ) + f (\u03c12,0 ),\n\n(6.22)\n\nwhere the first inequality is due to the fact that the wave (\u03c11 , \u03c1\u03021 ) has negative velocity. We\nclaim that\nf (\u03c12,0 ) \u2264 f (\u03c1\u03022 ),\n\n(6.23)\n\nand\nf (\u03c1\u03023 ) \u2264 f (\u03c13,0 ),\nf (\u03c1\u03024 ) \u2264 f (\u03c14,0 ).\n(6.24)\n\u0001\n\u0001\nThe points f (\u03c11,0 ), f (\u03c12,0 ) , f (\u03c1\u03021,0 ), f (\u03c1\u03022,0 ) are on the boundaries of \u03a90 , \u03a9\u0302 respectively,\nwhere E is maximum, hence they are on one of the curves\n\u03b11 \u03b31 + \u03b12 \u03b32 = f out (\u03c13,0 ),\n\n(1 \u2212 \u03b11 )\u03b31 + (1 \u2212 \u03b12 )\u03b32 = f out (\u03c14,0 ),\n\n\u03b32 = f in (\u03c12,0 ).\n\nUsing (6.21), we immediately get (6.23). Let us assume that the two points are on the same\ncurve, the general case being similar, for example on\n\u03b11 \u03b31 + \u03b12 \u03b32 = f out (\u03c13,0 ).\n\n\f14\n\nG. M. Coclite and B. Piccoli\n\nFrom (6.21) it follows that the map E is increasing on the curve\n\u0010\n\u03b11 \u0011\n\u03b31 ,\n\u03b31 7\u2192 \u03b31 , f out (\u03c13,0 ) \u2212\n\u03b12\n\u0001\notherwise we contradict the maximality of E at f (\u03c11,0 ), f (\u03c12,0 ) . Thus \u03b11 < \u03b12 , \u03c1\u03021 = \u03c11 ,\n\nand\n\nf (\u03c1\u03021 ) = f (\u03c11 ),\n\nf (\u03c1\u03023 ) = f (\u03c13,0 ) = f out (\u03c13,0 ).\n\nOn the other hand, by (6.22) and (6.23), we have\nf (\u03c1\u03024 ) = (1 \u2212 \u03b11 )f (\u03c1\u03021 ) + (1 \u2212 \u03b12 )f (\u03c1\u03022 ) \u2264\n\u0001\n\u2264 (1 \u2212 \u03b11 ) f (\u03c11,0 ) + f (\u03c12,0 ) \u2212 f (\u03c1\u03022 ) + (1 \u2212 \u03b12 )f (\u03c1\u03022 ) =\n\u0001\n\u0001\n= (1 \u2212 \u03b11 ) f (\u03c11,0 ) + f (\u03c12,0 ) + \u03b11 \u2212 \u03b12 f (\u03c1\u03022 ) \u2264\n\u0001\n\u0001\n\u2264 (1 \u2212 \u03b11 ) f (\u03c11,0 ) + f (\u03c12,0 ) + \u03b11 \u2212 \u03b12 f (\u03c12,0 ) = f (\u03c14,0 ).\n\nUsing the Rankine Hogoniot Condition (2.7) in the junction (6.22), (6.23) and (6.24), we get\n\u0001\nTot.Var. f (\u03c1(t\u0304+, *)) = |f (\u03c1\u03021 )\u2212f (\u03c11 )|+|f (\u03c1\u03022 )\u2212f (\u03c12,0 )|+|f (\u03c1\u03023 )\u2212f (\u03c13,0 )|+|f (\u03c1\u03024 )\u2212f (\u03c14,0 )| =\n\u0001\n\u0001\n\u0001\n= f (\u03c1\u03022 ) \u2212 f (\u03c12,0 ) + f (\u03c13,0 ) \u2212 f (\u03c1\u03023 ) + f (\u03c14,0 ) \u2212 f (\u03c1\u03024 ) =\n\u0001\n= f (\u03c11,0 ) \u2212 f (\u03c1\u03021 ) = f (\u03c11,0 ) \u2212 f (\u03c11 ) = Tot.Var. f (\u03c1(t\u0304\u2212, *)) .\n\nSuppose now that\n\nf (\u03c11,0 ) < f (\u03c11 ),\nthen \u03a90 \u2282 \u03a9\u0302 and using the previous arguments\nf (\u03c1\u03021 ) = f (\u03c11 ),\n\nf (\u03c1\u03022 ) \u2264 f (\u03c12,0 ),\n\nf (\u03c13,0 ) \u2264 f (\u03c1\u03023 ),\n\nf (\u03c14,0 ) \u2264 f (\u03c1\u03024 ).\n\nBy the Rankine Hogonot Condition in the junction (see (2.7)), we have\n\u0001\nTot.Var. f (\u03c1(t\u0304+, *)) = |f (\u03c1\u03021 )\u2212f (\u03c11 )|+|f (\u03c1\u03022 )\u2212f (\u03c12,0 )|+|f (\u03c1\u03023 )\u2212f (\u03c13,0 )|+|f (\u03c1\u03024 )\u2212f (\u03c14,0 )| =\n\u0001\n\u0001\n\u0001\n= f (\u03c12,0 ) \u2212 f (\u03c1\u03022 ) + f (\u03c1\u03023 ) \u2212 f (\u03c13,0 ) + f (\u03c1\u03024 ) \u2212 f (\u03c14,0 )) =\n\u0001\n\u0001\n= f (\u03c1\u03021 ) \u2212 f (\u03c11,0 )) + = f (\u03c11 ) \u2212 f (\u03c11,0 ) = Tot.Var. f (\u03c1(t\u0304\u2212, *)) .\n\nIn the general case we have only to observe that the total variation of \u03c1 does not increase\non the roads (see [6, Chapter 6]) and when a wave approaches a junction we can use the\nprevious argument, so the proof is concluded.\n\n\u2737\n\n\f15\n\nTraffic Flow on a Road Network\n\n7\n\nSolutions with a finite number of Big Waves\nIn this section we prove existence and stability of solutions with a finite number of big\n\nwaves.\nDefinition 7.1 We call Dn the set of all maps \u03c1\u0304 : \u222ai Ii 7\u2192 IR defined on the network with\nbounded variation such that there exists a sequence {\u03c1\u0304\u03bd } of piecewise constant maps satisfying\nTot.Var.(\u03c1\u0304\u03bd ) \u2264 Tot.Var.(\u03c1\u0304),\n\nN (\u03c1\u0304\u03bd ) \u2264 n,\n\n(7.25)\n\nfor each \u03bd \u2208 IN and\n\u03c1\u0304\u03bd \u2212\u2192 \u03c1\u0304\n\nin L1 .\n\n(7.26)\n\nNotice that if \u03c1\u0304 \u2208 Dn then\nTot.Var.(\u03c1\u0304) \u2264\n\n1\nf\u2032\n\nL\u221e\n\n\u0001\nTot.Var. f (\u03c1\u0304) + n.\n\n(7.27)\n\nThe existence of solutions with values in the domain Dn is ensured by next Theorem.\nTheorem 7.1 Let f : [0, 1] \u2192 IR satisfying (F 1). Consider a road network (I, J ) in which\nall junctions have at most two incoming roads and two outgoing ones. Given n \u2208 IN and \u03c1\u0304 \u2208\nDn , there exists an admissible solution \u03c1 in the sense of Definition 2.2 such that \u03c1(0, *) = \u03c1\u0304,\nand \u03c1(t, *) \u2208 Dn , for each t \u2265 0.\nProof. Let {\u03c1\u0304\u03bd } \u2282 Dn be a sequence of piecewise constant maps such that\n\u03c1\u0304\u03bd \u2212\u2192 \u03c1\u0304 in L1 ,\n\nTot.Var.(\u03c1\u0304\u03bd ) \u2264 Tot.Var.(\u03c1\u0304),\n\nand \u03c1\u03bd the wave front tracking approximate solutions such that \u03c1\u03bd (0, *) = \u03c1\u0304\u03bd . By Lemma 5.1\nwe have\n\u03c1\u03bd (t, *) \u2208 Dn ,\n\nt \u2265 0, \u03bd \u2208 IN\n\nand, by (7.27) and Lemma 6.1,\nTot.Var.(\u03c1\u03bd (t, *)) \u2264\n\u2264\n\n1\nf\u2032\n\nL\u221e\n\n1\nf\u2032\n\nL\n\n\u0001\nTot.Var.\nf\n(\u03c1\n(t,\n*))\n+n\u2264\n\u03bd\n\u221e\n\n\u0001\nTot.Var. f (\u03c1\u0304\u03bd ) + n \u2264\n\n1\nf\u2032\n\nL\u221e\n\n* kf \u2032 kL\u221e Tot.Var.(\u03c1\u0304) + n.\n\nSince the wave speeds are bounded, the maps \u03c1\u03bd are uniformly Lipschitz continuous from\n[0, +\u221e[ into L1loc for the L1 norm on every compact set, and are obviously uniformly bounded.\nThen by Helly Theorem (see [6, Theorem 2.4]), \u03c1\u03bd converge to some continuous map \u03c1 \u2208\nL1loc ([0, +\u221e[\u00d7 \u222ai Ii , IR) such that, up to redefining \u03c1 on a set of zero measure, \u03c1(t, *) has\n\n\f16\n\nG. M. Coclite and B. Piccoli\n\nbounded variation. Since for every t we can obtain \u03c1(t, *) as limits of \u03c1\u03bd (tn , *) for some\ntn \u2192 t, we get \u03c1(t, *) \u2208 Dn for every t \u2265 0.\nIt is a standard argument, see [6], to prove that \u03c1 solves the conservation law on the road\nnetwork. Moreover, \u03c1(t, *) \u2208 BV and one can easily check the other properties to guarantee\nthat \u03c1 is an admissible solution. The proof is concluded.\n\n\u2737\n\nRegarding stability of solutions we have:\nTheorem 7.2 Let f : [0, 1] \u2192 IR satisfy (F 1). Consider a network in which all junctions\nhave at most two incoming roads and two outgoing ones. Let n \u2208 IN , \u03c1 and \u03c1\u0303 be admissible\nsolutions such that\n\u03c1(t, *), \u03c1\u0303(t, *) \u2208 Dn \u2229 L1 ,\n\nt \u2265 0.\n\nThere results\nk\u03c1(t, *) \u2212 \u03c1\u0303(t, *)kL1 \u2264 k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 ,\nfor each t \u2265 0.\nWe begin proving a lemma.\nLemma 7.1 Let f : [0, 1] \u2192 IR satisfy (F 1) and J be a junction with two incoming roads\nand two outgoing ones as in Section 3. Let \u03c11 , \u03c11,0 , ..., \u03c14,0 \u2208 [0, 1], \u03be \u2208 IR and x\u0304 < b1 be such\nthat\nx\u0304 + \u03be < b1 ,\n\n\u03c11 \u2208\n\n(\n\n[0, \u03c3] \\ {\u03c11,0 }\n\nif 0 \u2264 \u03c11,0 \u2264 \u03c3,\n\n[0, \u03c4 (\u03c11,0 )]\n\nif \u03c3 \u2264 \u03c11,0 \u2264 1.\n\nLet \u03c1 and \u03c1\u03be be the wave front tracking approximate solutions of (1.1) on J such that\n\u03c11 (0, *) = \u03c11 * \u03c7]\u2212\u221e,x\u0304] + \u03c11,0 * \u03c7]x\u0304,b1 ] ,\n\n\u03c1\u03be1 (0, *) = \u03c11 * \u03c7]\u2212\u221e,x\u0304+\u03be] + \u03c11,0 * \u03c7]x\u0304+\u03be,b1 ] ,\n\n\u03c1i (0, *) \u2261 \u03c1\u03bei (0, *) \u2261 \u03c1i,0 ,\n\ni = 2, 3, 4.\n\nThere results\nk\u03c1\u03be1 (t, *) \u2212 \u03c11 (t, *)kL1 \u2264 |\u03be| * |\u03c11,0 \u2212 \u03c11 | = k\u03c1\u03be1 (0, *) \u2212 \u03c11 (0, *)kL1 ,\nfor each t \u2265 0.\nProof. We begin assuming that (\u03c11,0 , ..., \u03c14,0 ) is an equilibrium configuration. By possibly\nchanging the notations, we can assume that \u03be > 0. Since we approximate the rarefaction\nfronts with many small shocks we have only to study the case in which the Riemann Problem\n(\u03c11 , \u03c11,0 ) on the first road and the one (\u03c11,0 , ..., \u03c14,0 ) in the junction generate only shocks.\nLet (\u03c1\u03021 , ..., \u03c1\u03024 ) be the solution of the Riemann Problem with initial data (\u03c11 , \u03c12,0 ..., \u03c14,0 ) (see\n\n\f17\n\nTraffic Flow on a Road Network\n\nTheorem 3.1) and \u03bb1,0 , \u03bb\u03021 , \u03bb\u03022 , \u03bb\u03023 , \u03bb\u03024 the velocities of the shocks generated by the Riemann\nProblems (\u03c11 , \u03c11,0 ), (\u03c11 , \u03c1\u03021 ), (\u03c12 , \u03c1\u03022 ), (\u03c1\u03023 , \u03c13,0 ), (\u03c1\u03024 , \u03c14,0 ) respectively.\nb1 \u2212 x\u0304 \u2212 \u03be\nby the first part of the proof of Lemma 6.1 and the Rankine Hugoniot\n\u03bb1,0\nConditions on the roads (see [6, Lemma 4.2]) we have\nIf t \u2265\n\nk\u03c1\u03be1 (t, *)\n\n=\n\n=\n\n\u2212 \u03c11 (t, *)k\n\nL1\n\n4\n\u0011\nX\n|\u03be| \u0010\n|\u03c1i,0 \u2212 \u03c1\u0302i | * |\u03bb\u0302i | =\n|\u03c11 \u2212 \u03c1\u03021 | * |\u03bb\u03021 | +\n=\n|\u03bb1,0 |\ni=2\n\n4\n\u0011\nX\n\u0001\n|\u03be|\n|\u03be| \u0010\n|f (\u03c1i,0 ) \u2212 f (\u03c1\u0302i )| =\n|f (\u03c11 ) \u2212 f (\u03c1\u03021 )| +\nTot.Var. f (\u03c1(t, *)) =\n|\u03bb1,0 |\n|\u03bb1,0 |\ni=2\n\n\u0001\n|\u03be|\n|\u03be|\nTot.Var. f (\u03c1(0, *)) =\nf (\u03c11 )\u2212 f (\u03c11,0 ) = |\u03be|*|\u03c11 \u2212 \u03c11,0 | = k\u03c1\u03be1 (0, *)\u2212 \u03c11 (0, *)kL1 .\n|\u03bb1,0 |\n|\u03bb1,0 |\n\nIn the case in which (\u03c11,0 , ..., \u03c14,0 ) is not an equilibrium configuration we have only to\n\nrecall that the L1 \u2212distance between the solutions decreases on each roads (see of [6, Corollary\n6.1]) and use the same arguments.\nThis concludes the proof.\n\n\u2737\n\nProof of Theorem 7.2. Let \u03c1k and \u03c1\u0303k be front tracking approximate solutions such that\nk\u03c1k (0, *) \u2212 \u03c1(0, *)kL1 \u2264\n\n1\n,\nk\n\nTot.Var.(\u03c1k (0, *)) \u2264 Tot.Var.(\u03c1(0, *)),\n\nk\u03c1\u0303k (0, *) \u2212 \u03c1\u0303(0, *)kL1 \u2264\n\n1\n,\nk\n\nk \u2208 IN ,\n\nTot.Var.(\u03c1\u0303k (0, *)) \u2264 Tot.Var.(\u03c1\u0303(0, *)),\n\nk \u2208 IN .\n\nNow consider finitely many wave front tracking approximate solutions \u03c1k,0 , ..., \u03c1k,N\n\u03c1k,0 \u2261 \u03c1k ,\n\n\u03c1k,N \u2261 \u03c1\u0303k\n\nwhere \u03c1k,h is obtained by \u03c1k,h\u22121 shifting and rescaling only one jump as in [7] and [8].\nPrecisely denoting\n\u03c1k,h\u22121\n(0, *) =\ni\n\nN\n\u22121\nX\n\n\u03b1l * \u03c7[\u03b2l ,\u03b2l+1 [ ,\n\nl=0\n\nthere exist \u03bb, \u03be \u2208 IR and l\u0304 \u2208 {1, ..., N \u2212 1} such that\n\u03c1k,h\ni (0, *) =\n\nl\u0304\u22122\nX\n\n\u03b1l * \u03c7[\u03b2l ,\u03b2l+1 [ + \u03b1l\u0304\u22121 * \u03c7[\u03b2l\u0304\u22121 ,\u03b2l\u0304 +\u03be[ + \u03bb * \u03c7[\u03b2l\u0304 +\u03be,\u03b2l\u0304+1 [ +\n\nl=0\n\nN\n+1\nX\n\nl=l\u0304+1\n\nwith\n\u03b2l\u0304 \u2212 \u03b2l\u0304\u22121 \u2264 \u03be \u2264 \u03b2l\u0304+1 \u2212 \u03b2l\u0304 ,\n\n\u03b1l * \u03c7[\u03b2l ,\u03b2l+1 [ ,\n\n\f18\n\nG. M. Coclite and B. Piccoli\n\nfor each i = 1, ..., N . In this way we have\nN\nX\n\nk\u03c1k,h (0, *) \u2212 \u03c1k,h+1 (0, *)kL1 = k\u03c1k (0, *) \u2212 \u03c1\u0303k (0, *)kL1 .\n\n(7.28)\n\nh=1\n\nSince the distance between solutions decreases on each road (see [6, Corollary 6.1]) and by\nthe previous lemma, we have\nk\u03c1k,h (t, *) \u2212 \u03c1k,h+1 (t, *)kL1 \u2264 k\u03c1k,h (0, *) \u2212 \u03c1k,h+1 (0, *)kL1 .\nSo, by (7.28),\nk\u03c1k (t, *) \u2212 \u03c1\u0303k (t, *)kL1 \u2264\n\nN\nX\n\nk\u03c1k,h (t, *) \u2212 \u03c1k,h+1 (t, *)kL1 \u2264\n\nh=1\n\n\u2264\n\nN\nX\n\nk\u03c1k,h (0, *) \u2212 \u03c1k,h+1 (0, *)kL1 = k\u03c1k (0, *) \u2212 \u03c1\u0303k (0, *)kL1 .\n\nh=1\n\nMoreover there exists a decreasing sequence {kn } \u2282 IN such that \u03c1kn \u2192 \u03c1 and \u03c1\u0303kn \u2192 \u03c1\u0303 in\nL1 as kn \u2192 +\u221e. Hence\nk\u03c1(t, *) \u2212 \u03c1\u0303(t, *)kL1 \u2264 k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 ,\nas to be proved.\n\n8\n\n\u2737\n\nExistence and Stability of Solutions in L1\n\nLet us first consider the case in which (F 1) holds true.\nTheorem 8.1 Let f : [0, 1] \u2192 IR satisfy (F 1). Consider a road network in which each\njunction has at most two incoming roads and two outgoing ones. Let \u03c1\u0304 be an initial data\nin L1loc and fix T > 0. Then there exists a unique admissible solution \u03c1 defined on [0, T ],\nobtained as limit of wave front tracking approximate solutions such that \u03c1(0, *) = \u03c1\u0304. Moreover\nif \u03c1\u0304 \u2208 L1 then \u03c1(t, *) \u2208 L1 .\nIf \u03c1 and \u03c1\u0303 are admissible solutions obtained as limit of wave front tracking approximate\nsolutions such that \u03c1(t, *), \u03c1\u0303(t, *) \u2208 L1 , for every t \u2265 0, then for each t \u2265 0\nk\u03c1(t, *) \u2212 \u03c1\u0303(t, *)kL1 \u2264 k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 .\n\n(8.29)\n\nProof. We begin proving the existence of a solution for \u03c1\u0304 \u2208 L1 . There exists {\u03c1\u0304n } sequence\nof piecewise constant maps defined on the network such that\n\u03c1\u0304n \u2208 Dn \u2229 L1 ,\n\n\u03c1\u0304n \u2212\u2192 \u03c1\u0304\n\nin L1 .\n\n(8.30)\n\n\f19\n\nTraffic Flow on a Road Network\n\nLet \u03c1n be the wave front tracking approximate solutions with \u03c1n (0, *) = \u03c1\u0304n . Fix n < m, by\nLemma 5.1, there results \u03c1n (t, *) \u2208 Dn \u2282 Dm , \u03c1m (t, *) \u2208 Dm and by Theorem 7.2,\nk\u03c1n (t, *) \u2212 \u03c1m (t, *)kL1 \u2264 k\u03c1\u0304n \u2212 \u03c1\u0304m kL1 .\n\u0001\nHence {\u03c1n (t, *)} is a Cauchy sequence in L1 [0, T ] \u00d7 IR, IR . Then there exists \u03c1 such that\n\u0001\n\u03c1n (t, *) \u2212\u2192 \u03c1(t, *) in L1 [0, T ] \u00d7 IR, IR . It is easy to check that \u03c1 is as admissible solution.\n\nThe case of L1loc can be obtained by localization.\n\nNow we prove (8.29). Let {\u03c1n }, {\u03c1\u0303n } be sequences of wave front tracking approximate\n\u0001\nsolutions such that \u03c1n (t, *), \u03c1\u0303n (t, *) \u2208 Dn \u2229 L1 and \u03c1n \u2212\u2192 \u03c1, \u03c1\u0303n \u2212\u2192 \u03c1\u0303 in L1 [0, T ] \u00d7 IR, IR .\nBy Theorem 7.2, we have\n\nk\u03c1n (t, *) \u2212 \u03c1\u0303n (t, *)kL1 \u2264 k\u03c1n (0, *) \u2212 \u03c1\u0303n (0, *)kL1 .\nTherefore (8.29) is proved and uniqueness holds true.\n\n\u2737\n\nWe now relax the assumption (F 1), namely we suppose that f satisfies (F ).\nLet {f\u03bd } be a sequence of maps satisfying (F 1) such that\nf\u03bd (\u03c3) = max f\u03bd (\u03c1),\n\u03c1\u2208[0,1]\n\n\u03bd \u2208 IN\n\n(8.31)\n\nand\nf\u03bd \u2212\u2192 f in L\u221e ([0, 1]) and f\u03bd \u2032 \u2212\u2192 f \u2032 in L\u221e ([0, 1]).\n\n(8.32)\n\nMoreover let \u03c1\u0304 be an initial data in L1loc . We know that there exists a unique \u03c1\u03bd = \u03c1\u03bd (t, x)\nadmissible solution to the Cauchy Problem on the network (see Theorem 8.1) obtained as\nlimit of front tracking approximate solutions for\n\u03c1t + f\u03bd (\u03c1)x = 0,\n\n\u03c1(0, *) \u2261 \u03c1\u0304,\n\n\u03bd \u2208 IN .\n\n(8.33)\n\nTheorem 8.2 Let f : [0, 1] \u2192 IR satisfy (F ). Consider a road network in which all the\njunction have at most two incoming roads and two outgoing ones. Let \u03c1\u0304 be an initial data in\nL1loc and fix T > 0. Then there exists a unique admissible solution \u03c1 defined on [0, T ], with\n\u03c1(0, *) = \u03c1\u0304, obtained as limit of solutions to (8.33). The limit does not depend on the choice\nof the functions f\u03bd and if \u03c1\u0304 \u2208 L1 then \u03c1(t, *) \u2208 L1 .\nIf \u03c1 and \u03c1\u0303 are such admissible solutions and satisfy \u03c1(t, *), \u03c1\u0303(t, *) \u2208 L1 , for every t \u2265 0,\nthen\nk\u03c1(t, *) \u2212 \u03c1\u0303(t, *)kL1 \u2264 k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 .\nThe Theorem can be proved exactly as Theorem 8.1 from next Lemmas.\n\n(8.34)\n\n\f20\n\nG. M. Coclite and B. Piccoli\n\nLemma 8.1 Let f : [0, 1] \u2192 IR satisfy (F ). Consider a road network in which all junctions\nhave at most two incoming roads and two outgoing ones. Let \u03c1\u0304 be an initial data in Dn \u2229 L1\nand fix T > 0. Then there exists a unique admissible solution \u03c1 defined on [0, T ], with\n\u03c1(0, *) = \u03c1\u0304, obtained as limit of solutions to (8.33). The limit does not depend on the choice\nof the functions f\u03bd and and \u03c1(t, *) \u2208 L1 .\nProof. Let {f\u03bd } be a sequence of maps satisfying (F 1), (8.31) and (8.32) and \u03c1\u03bd be the\nadmissible solutions for the Cauchy problems associated to f\u03bd . By Theorem 7.1 we have\n\u03c1\u03bd (t, *) \u2208 Dn ,\n\n\u03bd \u2208 IN ,\n\n0 \u2264 t \u2264 T.\n\n(8.35)\n\nMoreover there results\nk\u03c1\u03bd (t, *) \u2212 \u03c1\u03bc (t, *)kL1 \u2264 C * kf\u03bd \u2032 \u2212 f\u03bc \u2032 kL\u221e * Tot.Var.(\u03c1\u0304),\n\n(8.36)\n\nwhere C depends only on f . By (8.32), {\u03c1\u03bd } is a Cauchy sequence in L1 , then there exists\n\u03c1 \u2208 L1 such that \u03c1\u03bd \u2192 \u03c1 in L1 . Moreover, \u03c1 is an admissible solution and satisfies \u03c1(0, *) \u2261 \u03c1\u0304.\nFrom (8.36) we have that \u03c1 does not depend on the choice of {f\u03bd }, so we are done.\n\n\u2737\n\nLemma 8.2 Let f : [0, 1] \u2192 IR satisfy (F ). Consider a road network in which all junctions\nhave at most two incoming roads and two outgoing ones. Fix T > 0 and let \u03c1\u0303, \u03c1 be admissible\nsolutions in L1 , obtained as limit of solutions to (8.33), defined on [0, T ]. If \u03c1(0, *), \u03c1\u0303(0, *) \u2208\nDn , then\nk\u03c1(t, *) \u2212 \u03c1\u0303(t, *)kL1 \u2264 k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 ,\nfor each 0 \u2264 t \u2264 T .\nProof. Let {f\u03bd } be a sequence of maps satisfying (F 1), (8.31) and (8.32) and \u03c1\u03bd be the\nadmissible solutions associated to f\u03bd such that\n\u03c1\u03bd (0, *) \u2261 \u03c1(0, *),\n\n\u03c1\u0303\u03bd (0, *) \u2261 \u03c1\u0303(0, *).\n\n(8.37)\n\nBy Lemma 8.1, we have \u03c1\u03bd \u2192 \u03c1 and \u03c1\u0303\u03bd \u2192 \u03c1\u0303 in L1 . By Theorem 8.1 and (8.37), for each\n0 \u2264 t \u2264 T and \u03bd \u2208 IN , there results\nk\u03c1(t, *) \u2212 \u03c1\u0303(t, *)kL1 \u2264 k\u03c1(t, *) \u2212 \u03c1\u03bd (t, *)kL1 + k\u03c1\u03bd (t, *) \u2212 \u03c1\u0303\u03bd (t, *)kL1 + k\u03c1\u0303(t, *) \u2212 \u03c1\u0303\u03bd (t, *)kL1 \u2264\n\u2264 k\u03c1(t, *) \u2212 \u03c1\u03bd (t, *)kL1 + k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 + k\u03c1\u0303(t, *) \u2212 \u03c1\u0303\u03bd (t, *)kL1 \u2212\u2192 k\u03c1(0, *) \u2212 \u03c1\u0303(0, *)kL1 .\nSo the proof is concluded.\n\n\u2737\n\n\f21\n\nTraffic Flow on a Road Network\n\n9\n\nTime Dependent Traffic\nIn this section we consider a model of traffic including cross lights and time dependent\n\ntraffic. The latter means that the choice of drivers at junctions depends on the period of the\nday, so during the morning the traffic flows towards some direction and during afternoon it\nmay change towards another direction. This means that the matrix A depends on time t (see\nSection 3).\nConsider a single junction as in Section 3 with two incoming roads and two outgoing ones.\nLet \u03b11 = \u03b11 (t), \u03b12 = \u03b12 (t) be two piecewise constant periodic functions such that\n\u03b11 (t) 6= \u03b12 (t),\n\n(9.38)\n\nfor each t \u2265 0. Moreover let \u03c71 = \u03c71 (t), \u03c72 = \u03c72 (t) be piecewise constant periodic maps such\nthat\n\u03c71 (t) + \u03c72 (t) = 1,\n\n\u03c7i (t) \u2208 {0, 1},\n\ni = 1, 2\n\nfor each t \u2265 0. The two maps represent traffic lights, the value 0 corresponding to red light\nand the value 1 to green light.\n\u0001\nDefinition 9.1 Consider \u03c1 = \u03c1(t, x1 , ..., x4 ) = \u03c11 (t, x1 ), ..., \u03c14 (t, x4 ) with bounded varia-\n\ntion. We say that \u03c1 is a solution at the junction J if it satisfies (i), (ii), (iv) of Definition\n2.1 and the following property holds:\n(v) f (\u03c13 (t, a3 +)) = \u03b11 (t)\u03c71 (t)f (\u03c11 (t, b1 \u2212)) + \u03b12 (t)\u03c72 (t)f (\u03c12 (t, b2 \u2212)) and\n\u0001\n\u0001\nf (\u03c14 (t, a4 +)) = 1 \u2212 \u03b11 (t) \u03c71 (t)f (\u03c11 (t, b1 +)) + 1 \u2212 \u03b12 (t) \u03c72 (t)f (\u03c12 (t, b2 +)) for each\nt > 0.\n\nAssume that at time t\u0304 one of the maps \u03b11 (*), \u03b12 (*), \u03c71 (*), \u03c72 (*) jumps, then we have to\nsolve a new Riemann Problem in the junction hence four waves are generated and\n\u0001\n\u0001\nN \u03c1(t\u0304+, *) \u2264 N \u03c1(t\u0304\u2212, *) ,\n\n\u0001\n\u0001\nTot.Var. f (\u03c1(t\u0304+, *)) \u2264 Tot.Var. f (\u03c1(t\u0304\u2212, *)) + 4f (\u03c3).\n\u0001\nThen the map N \u03c1(t, *) is still non increasing while\n\n(9.39)\n(9.40)\n\n\u0001\n\u0001\nTot.Var. f (\u03c1(t2 , *)) \u2264 Tot.Var. f (\u03c1(t1 , *)) + 4f (\u03c3)\u03a6(t1 , t2 ),\n\nfor each 0 < t1 \u2264 t2 , where\n\n\u0011\n\u0010 \b\n\b\n. X\n# tl |t1 < tl \u2264 t2 , \u03c7i jumps in tl + # tl |t1 < tl \u2264 t2 , \u03b1i jumps in tl .\n\u03a6(t1 , t2 ) =\ni=1,2\n\n\f22\n\nG. M. Coclite and B. Piccoli\n\nTherefore, for fixed T > 0, we have uniform bounds of the total variation on the interval\n[0, T ], and using arguments as in the previous sections we obtain existence and stability for\nthe Cauchy Problem. However, the total variation of f (\u03c1) does not depend continuously\non the total variation of the maps \u03b11 (*), \u03b12 (*). Indeed consider a single junction with two\nincoming roads and two outgoing ones without traffic lights, i.e. \u03c7i \u2261 1, and let\n(\n(\n\u03b21 if 0 \u2264 t \u2264 t\u0304,\n\u03b22 if 0 \u2264 t \u2264 t\u0304,\n\u03b11 (t) =\n, \u03b12 (t) =\n,\n\u03b22 if t\u0304 \u2264 t \u2264 T ,\n\u03b21 if t\u0304 \u2264 t \u2264 T ,\nwhere 0 < \u03b22 < \u03b21 <\n\n1\n2\n\nand 0 < t\u0304 < T . Consider the initial data (\u03c11,0 , \u03c12,0 , \u03c13,0 , \u03c14,0 ), where\n\nf (\u03c11,0 ) = f (\u03c14,0 ) = f (\u03c3),\n\nf (\u03c12,0 ) = f (\u03c13,0 ) =\n\n\u03b21\nf (\u03c3).\n1 \u2212 \u03b22\n\nThis is an equilibrium configuration for the choice \u03b1i = \u03b2i , i = 1, 2, hence the solution of the\nRiemann Problem is identically equal to the initial data for 0 \u2264 t \u2264 t\u0304. At time t = t\u0304 we have\nto solve a new Riemann Problem. Let (\u03c1\u03021 , \u03c1\u03022 , \u03c1\u03023 , \u03c1\u03024 ) its solution, there results (see figure 2)\nf (\u03c1\u03022 ) = f (\u03c1\u03024 ) = f (\u03c3),\n\nf (\u03c1\u03021 ) = f (\u03c1\u03023 ) =\n\n\u03b22\nf (\u03c3).\n1 \u2212 \u03b21\n\n\u03b32\n(1 \u2212 \u03b2 ) \u03b3 + (1 \u2212 \u03b2 ) \u03b3 = f( \u03c3 )\n\nf( \u03c3 )\n\n1\n\n1\n\n2\n\n2\n\n(1 \u2212 \u03b2 ) \u03b3 + (1 \u2212 \u03b2 ) \u03b3 = f( \u03c3 )\n2\n\n1\n\n1\n\n\u03b3\n\nf( \u03c3 )\n\n2\n\n1\n\nfigure 2\nNow, if \u03b21 \u2192 \u03b22 , then\n\nbut\n\n\u0001\nTot.Var. \u03b11 ; [0, T ] \u2212\u2192 0,\n\n\u0001\nf (\u03c11,0 ), f (\u03c12,0 ) \u2212\u2192\n\n\u0012\nf (\u03c3),\n\n\u0013\n\u03b22\nf (\u03c3) ,\n1 \u2212 \u03b22\n\n\u0001\nTot.Var. \u03b12 ; [0, T ] \u2212\u2192 0,\n\u0001\nf (\u03c1\u03021 ), f (\u03c1\u03022 ) \u2212\u2192\n\nhence Tot.Var.(f (\u03c1); [0, T ]) is bounded away from zero.\n\n\u0012\n\n\u0013\n\u03b22\nf (\u03c3), f (\u03c3) ,\n1 \u2212 \u03b22\n\n\f23\n\nTraffic Flow on a Road Network\n\nA\n\nAppendix: Total Variation of the Fluxes\nIn this section we show an example in which the total variation of the flux increases due\n\nto interactions of waves with junctions.\nConsider a single junction with three incoming roads and three outgoing ones, the matrix\n\uf8eb1 1 1\uf8f6\n2\n\n. \uf8ec\nA = \uf8ed 13\n1\n6\n\n2\n1\n2\n\n0\n\n\u03c1\n\n3\n1\n2\n1\n6\n\n(A.41)\n\n\uf8f7\n\uf8f8\n\u03c1\n\n6,0\n\n1\n\n\u03c1\n\n\u03c1\n\n5,0\n\n1,0\n\n\u03c1\n\n\u03c1\n2,0\n\n4,0\n\n\u03c1\n\n3,0\n\nfigure 3\nand constants \u03c11 , \u03c11,0 , ..., \u03c16,0 \u2208 [0, 1] such that\n\u03c11,0 = \u03c13,0 = \u03c14,0 = \u03c15,0 = \u03c3, \u03c3 < \u03c12,0 < 1, 0 < \u03c16,0 , \u03c11 < \u03c3, f (\u03c12,0 ) =\n\n1\n1\n, f (\u03c16,0 ) = .\n3\n3\n\nAssume that f (\u03c3) = 1, then (\u03c11,0 , ..., \u03c16,0 ) is an equilibrium configuration and \u03c1 given by\n(\n\u03c11,0 if x1 \u2264 x \u2264 b1 ,\n\u03c11 (0, x) =\n\u03c1i (0, *) \u2261 \u03c1i,0 , i = 2, ..., 6,\n\u03c11\nif x < x1 ,\nis a solution. Moreover the plane\n\n1\n1\n\u03b31 + \u03b33 = 1\n6\n6\n\u0001\ndoes not intersect the cube [0, 1]3 and the point f (\u03c11,0 ), ..., f (\u03c16,0 ) is on the intersection of\nthe planes\n\n1\n1\n1\n1\n1\n1\n\u03b31 + \u03b32 + \u03b33 = 1,\n\u03b31 + \u03b32 + \u03b33 = 1,\n2\n2\n3\n3\n2\n2\nthat is the line described by the map\n\u0011\n\u0010\n5\n\u03b31 7\u2192 \u03b31 , 2 \u2212 \u03b31 , \u03b31 .\n3\n\n(A.42)\n\nAt some time say t\u0304 the wave (\u03c11 , \u03c11,0 ) interacts with the junction. Let (\u03c1\u03021 , ...., \u03c1\u03026 ) be the\n\nsolution of the Riemann Problem at the junction for the data (\u03c11 , \u03c12,0 , ..., \u03c16,0 ). Since the\n\n\f24\n\nG. M. Coclite and B. Piccoli\n\n\u0001\nmap E increases on the line described by (A.42), the point f (\u03c1\u03021 ), ...., f (\u03c1\u03026 ) is on the curve\n(A.42) and\n\n5\n1\nf (\u03c1\u03021 ) = f (\u03c1\u03023 ) = f (\u03c11 ), f (\u03c1\u03022 ) = 2 \u2212 f (\u03c11 ), f (\u03c1\u03024 ) = f (\u03c1\u03025 ) = f (\u03c3), f (\u03c1\u03026 ) = f (\u03c11 ).\n3\n3\nWe get\n\u0001\nTot.Var. f (\u03c1(t\u0304\u2212, *)) = 1 \u2212 f (\u03c11 ),\n\nwhile\n\n\u0001\n\u0001\n\u0001\nTot.Var. f (\u03c1(t\u0304+, *)) = 4 1 \u2212 f (\u03c11 ) > Tot.Var. f (\u03c1(t\u0304\u2212, *)) .\n\nB\n\nAppendix: Total Variation of the Densities\nConsider a junction J with two incoming roads and two outgoing ones that we param-\n\neterize with the intervals ] \u2212 \u221e, b1 ], ] \u2212 \u221e, b2 ], [a3 , +\u221e[, [a4 , +\u221e[ respectively. Fix the\nconstants \u03b11 , \u03b12 such that 0 < \u03b11 < \u03b12 < 1/2 and set\n\u03b13,1 = \u03b11 ,\n\n\u03b13,2 = \u03b12 ,\n\n\u03b14,1 = 1 \u2212 \u03b11 ,\n\n\u03b13,2 = 1 \u2212 \u03b12 .\n\n\u03c1\n4,0\n\n\u03c1\n1\n\n\u03c1\n\n\u03c1\n\n1,0\n\n3,0\n\n\u03c1\n2,0\n\nfigure 4\nDefine a solution \u03c1 by\n(\n\u03c11,0 if x1 \u2264 x \u2264 b1 ,\n\u03c11 (0, x) =\n\u03c11\nif x < x1 ,\n\n\u03c12 (0, x) = \u03c12,0 ,\n\n\u03c13 (0, x) = \u03c13,0 ,\n\n\u03c14 (0, x) = \u03c14,0 ,\n(B.43)\n\nwhere \u03c11 , \u03c11,0 , \u03c12,0 , \u03c13,0 , \u03c14,0 are constants such that\n\u03c3 \u2264 \u03c12,0 , \u03c13,0 \u2264 1,\nf (\u03c11,0 ) = f (\u03c14,0 ) = f (\u03c3),\n\n0 \u2264 \u03c11 \u2264 \u03c3,\n\n\u03c11,0 = \u03c14,0 = \u03c3,\n\nf (\u03c12,0 ) = f (\u03c13,0 ) =\n\n\u03b11\nf (\u03c3),\n1 \u2212 \u03b12\n\n(B.44)\n\n\f25\n\nTraffic Flow on a Road Network\n\nso (\u03c11,0 , \u03c12,0 , \u03c13,0 , \u03c14,0 ) is an equilibrium configuration.\nAfter some time the wave (\u03c11 , \u03c11,0 ) interacts with the junction. Let (\u03c1\u03021 , \u03c1\u03022 , \u03c1\u03023 , \u03c1\u03024 ) be\nthe solution of the Riemann Problem in the junction for the data (\u03c11 , \u03c12,0 , \u03c13,0 , \u03c14,0 ). By\n(B.43) and (B.44) there results\nf (\u03c1\u03021 ) = f (\u03c11 ),\nf (\u03c1\u03023 ) =\n\nf (\u03c1\u03022 ) =\n\nf (\u03c3) \u2212 (1 \u2212 \u03b11 )f (\u03c11 )\n,\n1 \u2212 \u03b12\n\n\u03b11 \u2212 \u03b12\n\u03b12\nf (\u03c11 ) +\nf (\u03c3),\n1 \u2212 \u03b12\n1 \u2212 \u03b12\n\nf (\u03c1\u03024 ) = f (\u03c3)\n\nand\n0 \u2264 \u03c1\u03023 \u2264 \u03c3 \u2264 \u03c1\u03022 \u2264 1.\n\n\u03b1 1 \u03b3 1 + \u03b1 2\u03b3 2=\n\n\u03b32\n\n(B.45)\n\nf( \u03c1\n\n3,0\n\n)\n\nf( \u03c3 )\n(1 \u2212 \u03b11 ) \u03b31 + (1 \u2212 \u03b1 2) \u03b3 2= f( \u03c3 )\n\nf( \u03c1 )\n1\n\nf( \u03c3 )\n\n\u03b3\n\n1\n\nfigure 5\nTherefore if \u03c11 \u2192 \u03c11,0 = \u03c3 then\nf (\u03c1\u03023 ) \u2212\u2192\n\n\u03b11\nf (\u03c3) = f (\u03c13,0 ),\n1 \u2212 \u03b12\n\nand by (B.45), (B.44) we have \u03c1\u03023 \u2192 \u03c4 (\u03c13,0 ). Therefore we are able to create on the third\nroad a wave with strength bounded away from zero using an arbitrarily small wave on the\nfirst one.\n\nAcknowledgements\nThe authors would like to thank Prof. Rinaldo M. Colombo for useful discussions.\n\n\f26\n\nG. M. Coclite and B. Piccoli\n\nReferences\n[1] D. Amadori, Initial-boundary value problems for systems of conservation laws, NoDEA,\n4 (1997), pp. 1-42.\n[2] D. Amadori and R. M. Colombo, Continuous dependence for 2x2 conservation laws\nwith boundary, J. Differential Equations, 138 (1997), pp. 229-266.\n[3] F. Ancona and A. Marson, Scalar non - linear conservation laws with integrable\nboundary data, Nonlinear Analysis, 35 (1999), pp. 687-710.\n[4] A. Aw and M. Rascle, Resurrection of \"Second Order\" Models of traffic flow?, SIAM\nJ. App. Math. 60 (2000), pp. 916-938.\n[5] C. Bardos and A. Y. Le Roux and J. C. Nedelec, First Order Quasilinear Equations with Boundary Conditions, Commun. Partial Differential Equations 4 (1979),\npp. 1017-1034.\n[6] A. Bressan, Hyperbolic Systems of Conservation Laws - The One-dimensional Cauchy\nProblem, Oxford Univ. Press, 2000.\n[7] A. Bressan and G. Crasta and B. Piccoli, Well Posedness of the Cauchy Problem\nfor n \u00d7 n, Amer. Math. Soc. Memoir, 694 (2000).\n[8] A. Bressan and A. Marson, A Variational Calculus for Discontinuous Solutions of\nSystems of Consevation Laws, Comm. Part. Diff. Equat., 20 (1995), pp. 1491-1552.\n[9] R. M. Colombo, Hyperbolic Phase Transitions in Traffic Flow, submitted.\n[10] J. M. Greenberg, Extension and Amplifications of a Traffic Model of Aw and Rascle,\nSIAM Jour. Appl. Math., (2001) pp. 729-745.\n[11] H. Holden and N. H. Risebro, A Mathematical Model of Traffic Flow on a Network\nof Unidirectional Roads, SIAM J. Math. Anal., 26 (1995), pp. 999-1017.\n[12] M. J. Lighthill and G. B. Witham, On kinetic waves. II. Theory of Traffic Flows\non Long Crowded Roads, Proc. Roy. Soc. London Ser. A, 229 (1955), pp. 317-345.\n[13] P. I. Richards, Shock Waves on the Highway, Oper. Res., 4 (1956), pp. 42-51.\n\n\f"}