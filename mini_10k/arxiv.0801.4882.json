{"id": "http://arxiv.org/abs/0801.4882v2", "guidislink": true, "updated": "2008-07-17T12:27:26Z", "updated_parsed": [2008, 7, 17, 12, 27, 26, 3, 199, 0], "published": "2008-01-31T14:32:43Z", "published_parsed": [2008, 1, 31, 14, 32, 43, 3, 31, 0], "title": "The Semi Classical Maupertuis-Jacobi Correspondance for Quasi-Periodic\n  Hamiltonian Flows", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.2925%2C0801.0366%2C0801.2858%2C0801.1781%2C0801.3338%2C0801.2263%2C0801.0095%2C0801.1155%2C0801.4357%2C0801.0604%2C0801.0452%2C0801.1242%2C0801.0885%2C0801.4750%2C0801.1897%2C0801.2168%2C0801.3690%2C0801.1033%2C0801.2483%2C0801.4766%2C0801.4314%2C0801.2221%2C0801.2554%2C0801.3171%2C0801.1575%2C0801.2997%2C0801.0273%2C0801.3348%2C0801.0040%2C0801.4217%2C0801.2717%2C0801.2033%2C0801.0394%2C0801.4127%2C0801.0050%2C0801.3865%2C0801.4602%2C0801.2918%2C0801.1441%2C0801.2363%2C0801.3814%2C0801.4855%2C0801.1392%2C0801.2626%2C0801.0511%2C0801.4756%2C0801.1819%2C0801.4042%2C0801.3699%2C0801.3252%2C0801.4957%2C0801.3679%2C0801.3847%2C0801.4882%2C0801.0157%2C0801.3854%2C0801.3413%2C0801.2782%2C0801.1784%2C0801.1936%2C0801.0185%2C0801.4135%2C0801.2924%2C0801.4954%2C0801.1488%2C0801.3868%2C0801.1386%2C0801.0865%2C0801.2875%2C0801.0285%2C0801.4103%2C0801.2348%2C0801.1680%2C0801.2092%2C0801.2677%2C0801.0932%2C0801.0254%2C0801.3839%2C0801.0840%2C0801.4017%2C0801.1344%2C0801.1685%2C0801.4115%2C0801.3801%2C0801.0310%2C0801.3563%2C0801.0461%2C0801.4231%2C0801.1195%2C0801.3121%2C0801.3309%2C0801.3997%2C0801.2203%2C0801.0760%2C0801.0410%2C0801.4485%2C0801.2517%2C0801.3906%2C0801.4951%2C0801.1097%2C0801.1855&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Semi Classical Maupertuis-Jacobi Correspondance for Quasi-Periodic\n  Hamiltonian Flows"}, "summary": "We extend to the semi-classical setting the Maupertuis-Jacobi correspondance\nfor a pair of hamiltonians $(H(x,hD_x), {\\cal H}(x,hD_x)$. If ${\\cal H}(p,x)$\nis completely integrable, or has merely has invariant diohantine torus\n$\\Lambda$ in energy surface ${\\cal E}$, then we can construct a family of\nquasi-modes for $H(x,hD_x)$ at the corresponding energy $E$. This applies in\nparticular to the theory of water-waves in shallow water, and determines\ntrapped modes by an island, from the knowledge of Liouville metrics.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.2925%2C0801.0366%2C0801.2858%2C0801.1781%2C0801.3338%2C0801.2263%2C0801.0095%2C0801.1155%2C0801.4357%2C0801.0604%2C0801.0452%2C0801.1242%2C0801.0885%2C0801.4750%2C0801.1897%2C0801.2168%2C0801.3690%2C0801.1033%2C0801.2483%2C0801.4766%2C0801.4314%2C0801.2221%2C0801.2554%2C0801.3171%2C0801.1575%2C0801.2997%2C0801.0273%2C0801.3348%2C0801.0040%2C0801.4217%2C0801.2717%2C0801.2033%2C0801.0394%2C0801.4127%2C0801.0050%2C0801.3865%2C0801.4602%2C0801.2918%2C0801.1441%2C0801.2363%2C0801.3814%2C0801.4855%2C0801.1392%2C0801.2626%2C0801.0511%2C0801.4756%2C0801.1819%2C0801.4042%2C0801.3699%2C0801.3252%2C0801.4957%2C0801.3679%2C0801.3847%2C0801.4882%2C0801.0157%2C0801.3854%2C0801.3413%2C0801.2782%2C0801.1784%2C0801.1936%2C0801.0185%2C0801.4135%2C0801.2924%2C0801.4954%2C0801.1488%2C0801.3868%2C0801.1386%2C0801.0865%2C0801.2875%2C0801.0285%2C0801.4103%2C0801.2348%2C0801.1680%2C0801.2092%2C0801.2677%2C0801.0932%2C0801.0254%2C0801.3839%2C0801.0840%2C0801.4017%2C0801.1344%2C0801.1685%2C0801.4115%2C0801.3801%2C0801.0310%2C0801.3563%2C0801.0461%2C0801.4231%2C0801.1195%2C0801.3121%2C0801.3309%2C0801.3997%2C0801.2203%2C0801.0760%2C0801.0410%2C0801.4485%2C0801.2517%2C0801.3906%2C0801.4951%2C0801.1097%2C0801.1855&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We extend to the semi-classical setting the Maupertuis-Jacobi correspondance\nfor a pair of hamiltonians $(H(x,hD_x), {\\cal H}(x,hD_x)$. If ${\\cal H}(p,x)$\nis completely integrable, or has merely has invariant diohantine torus\n$\\Lambda$ in energy surface ${\\cal E}$, then we can construct a family of\nquasi-modes for $H(x,hD_x)$ at the corresponding energy $E$. This applies in\nparticular to the theory of water-waves in shallow water, and determines\ntrapped modes by an island, from the knowledge of Liouville metrics."}, "authors": ["Sergey Dobrokhotov", "Michel Rouleux"], "author_detail": {"name": "Michel Rouleux"}, "author": "Michel Rouleux", "arxiv_comment": "~40 pages", "links": [{"href": "http://arxiv.org/abs/0801.4882v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0801.4882v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0801.4882v2", "affiliation": "CPT", "arxiv_url": "http://arxiv.org/abs/0801.4882v2", "journal_reference": null, "doi": null, "fulltext": "THE SEMI CLASSICAL MAUPERTUIS-JACOBI CORRESPONDANCE\nFOR QUASI-PERIODIC HAMILTONIAN FLOWS\nSergey DOBROKHOTOV\n\n(\u2217)\n\n& Michel ROULEUX\n\n(\u2217\u2217)\n\n(\u2217)\n\narXiv:0801.4882v2 [math-ph] 17 Jul 2008\n\nInstitute for Problems in Mechanics of Russian Academy of Sciences\nProsp. Vernadskogo 101-1, Moscow, 119526, Russia, dobr@ipmnet.ru\n\n(\u2217\u2217)\n\nCentre de Physique Th\u00e9orique and Universit\u00e9 du Sud Toulon-Var, UMR 6207\nCampus de Luminy, Case 907, 13288 Marseille Cedex 9, France, rouleux@cpt.univ-mrs.fr\nAbstract: We extend to the semi-classical setting the Maupertuis-Jacobi correspondance\nfor a pair of hamiltonians (H(x, hDx ), H(x, hDx ). If H(p, x) is completely integrable, or has\n\nmerely an invariant diohantine torus \u039b in energy surface E, then we can construct a family of\nquasi-modes for H(x, hDx ) at the corresponding energy E. This applies in particular to the\ntheory of water-waves in shallow water, and determines trapped modes by an island, from\nthe knowledge of Liouville metrics.\nKeywords: Maupertuis principle, quasi-periodic hamiltoniana flows, invariant tori, Birkhoff\nnormal form, Liouville metrics, Maslov theory, shallow water waves.\n1. Introduction.\nLet M be a d dimensional Riemannian manifold, with metric tensor ds2 =\n\nX\n\ngij (x)\n\n1\u2264i,j\u2264d\n\ndxi \u2297dxj and consider a particle of unit mass moving along geodesics of M with kinetic energy\n\u0001\nds 2\nT = 12 d\u03c4\n. Suppose we are now given a potential V (x). There is a relation between the\ngeodesic flow and the Hamiltonian flow parametrized by t \u2208 R, for Hamiltonian H(p, x) =\nX\n1\ng ij (x)pi pj + V (x) on the energy surface E. To find the dependence (P (t), X(t)) on\n2\n1\u2264i,j\u2264d\n\nthe new time t one has to solve the equation dt = (2(E \u2212 V ))\u22121/2 ds which we call Maupertuis\nprinciple (see [Ar2]). Then the particle moves along the geodesic flow on M relative to the\nmetric d\u03c1 = (E\u2212V )1/2 ds, and we say that both flows (and metrics) are conformally equivalent.\n\nWe shall consider in this paper the following stronger variant. Maupertuis Jacobi corX\n1\nrespondance for the pair (H, H), H(p, x) = 2(E\u2212V\ng ij (x)pi pj , ensuring that both\n)\n1\u2264i,j\u2264d\n\nsystems have the same trajectories (P (t), X(t)) and (X (\u03c4 ), P(\u03c4 )) at energies (E, 1), is given\nby d\u03c4 = (E \u2212 V )dt. This principle was used for instance by T.Levi-Cevita in relation with\nKepler problem, cf. [Ts], [HieGrDoRa] and references therein ; see also [EasMat] for the\n\ncase of projective equivalence of metric connexions. Among interesting situations of application of Maupertuis-Jacobi correspondance is the case, when the functions (X (\u03c4 ), P(\u03c4 )) are\n1\n\n\f\u03c4 -quasiperiodic : (P(\u03c4 ), X (\u03c4 )) = (P(\u03c9\u03c4 + \u03c60 )), X (\u03c9\u03c4 + \u03c60 )). Here \u03c9 is a vector of periods\nand (P(\u03c4 ), X (\u03c4 )) are 2\u03c0-periodic functions with respect to each phase.\n\nThis occurs when H is completely integrable, and \u039b are compact, connected leaves of\n\nmaximal dimension d (i.e. lagrangian) in the fibration of T \u2217 M by the momentum map m,\nthat we assume to be non singular at \u039b = \u039b0 . Then Arnold-Mineur-Liouville theorem states\n[Ar2] that in a suitable action-angle coordinate system, \u039b are diffeomorphic to the torus\nTd = Rd /2\u03c0Zd , and parametrized by the action variables I \u2208 Rd+ . The non-criticality of m\nimplies that all components Ij of I are non zero in a neighborhood of \u039b0 .\nIn general the new hamiltonian H has no reason to be integrable. Nevertheless, in a\nneighborhood of \u039b0 , there are action-angle coordinates (J, \u03c6) giving a full family of tori \u039bJ\nwhich are almost invariant for the hamiltonian vector field XH . Under some diophantine condition, it it possible to improve these tori, so that they become invariant within an arbitrary\naccuracy.\nThis is actually the case, for using a generalization of Birkhoff transformations (better\nknown near a stationary point of XH , ) in the symplectic coordinates given by DarbouxWeinstein theorem, H can be brought to a normal form, we call the Birkhoff normal form\n(BNF). This was carried out by M.Hitrik, J.Sj\u00f6strand and S.Vu-Ngoc [HiSjVu].\nAn alternative, and more pragmatic way to our opinion, was devised in [BeDoMa], and\nconsists in providing directly suitable action-angle coordinates (J, \u03c6), without resorting to\nDarboux-Weinstein theorem. We believe it has the advantage of being easily implemented\nnumerically in some concrete applications.\nOnce the classical Hamiltonian is taken to BNF, we may address the problem of finding\nquasi-modes supported on the \u039bJ , with a suitable accuracy. A necessary condition for \u039bJ is\nto satisfy Maslov quantization condition. A similar problem arises in an attempt of quantizing the so-called KAM tori. Quoting J.J. Duistermaat [Du1,p.231], while slightly changing\nnotations :\n\". . . there is no reason why the tori on which [Maslov quantization condition] holds for\nsome h > 0 should persist. For most [invariant embedded lagrangian manifolds \u03b9 : \u039b \u2192 T \u2217 M ]\none can expect that h 7\u2192 h1 * \u03b8 [the cohomology class of the closed 1-form \u03b9\u2217 (pdx)] is dense in\n\nH 1 (\u039b; R)/H 1 (\u039b; Z). Extracting a subsequence h1 = \u03c4nk , from \u03c4n = \u03c40 + n\u03c30 , n \u2208 Z [which\nensures Maslov quantization condition to hold], such that \u03c4n * \u03b8 converges to \u2212\u03b1/4 [Maslov\n\nclass] in H 1 (\u039b; R)/H 1 (\u039b; Z), one can still obtain some asymptotic estimates for the spectrum\nof H but in general the convergence of \u03c4n *\u03b8 to \u2212\u03b1/4 is expected to be slow and the asymptotic\nestimates for the spectrum are correspondingly weak.\"\nThis observation was made more precise by Y.Colin de Verdi\u00e8re [CdV,Prop.7.5] : namely,\nif H (\u039b; R) is of dimension 2 (i.e. for a 2-d torus \u039b), then the extraction above can be made,\n1\n\n2\n\n\fprovided \u03b8, expressed in a basis of entire classes, is irrational.\nA different point of vue consists in selecting among the family \u039bJ suitable tori on which\nMaslov quantization condition holds, i.e. a sequence J = Jk (h), k \u2208 Z, |k|h \u2264 h\u03b4 . This allows\nto produce an almost \"full\" (or \"density 1\") spectral sequence for H, in some suitable sense.\nThe first route, followed in [HiSjVu], consists, through h-Pseudo Differential Calculus,\nin quantizing the BNF microlocally near the \u039bJ , and this can be achieved for corrections to\nall orders in h. (See also [CdV1], [Laz], [Po], and [Vu] for the case of a family of d commuting\nh-PDO. )\nThis is a rather remarkable result, since quantization of manifolds is in general impossible\nbeyond first order. It relies essentially on the fact, observed a long time ago by Colin de\nVerdi\u00e8re [CdV], and used later by G.Popov [Po], that the action of H on semi-densities on tori\nverifying Maslov quantization condition, reduces to the action of another h-PDO, obtained\nby conjugating H by a Fourier Integral Operator (FIO) quantizing the BNF, to microlocally\ndefined functions on the flat torus Td . These functions satisfy Floquet periodicity condition :\n(0.3)\n\nu(x \u2212 \u03bd) = e2i\u03c0hI+\u03b1h/4,\u03bdi/h u(x),\n\n\u03bd \u2208 Z2\n\nHere I = (I1 , * * * , Id ) are the classical actions parametrizing the torus \u039b (stated otherwise, I\n\nis a representant of Liouville class \u03b8 in H 1 (\u039b; R)), so that u(x \u2212 \u03bd) = u(x) for all integer \u03bd\nwhenever \u03b8/h + \u03b1/4 = 0 mod Z2 .\nHere we have chosen another route, consisting simply in using the almost invariant\ntori \u039bJ to construct quasi-modes for operator H(x, hDx ) near energy 0. This can be done\n\nby adjusting the new action variable J so to satisfy Maslov quantization condition, and\nsolving the transport equations for H to first order along \u039bJ . We believe again that these\nconstructions are simpler from a pragmatic point of view, especially when H assumes the form\nH = \u2212h2 \u2206+V . In more complex situations however where (see Section 4.d) we have to resort\nto FIO's implementing the change of variables that takes our operator to the normal form,\npassing for instance from a general conformal metric to a model one, but the constructions\nare very similar.\nWe could also include isotropic tori, corresponding to the gaps in the foliation of the\nenergy surface by lagrangean manifolds when the system is no longer integrable, or consider\ncritical points of the moment map, which leads to introduce so-called harmonic oscillator\ncoordinates (in the elliptic case).\nThe paper goes as follows. In Sect.1 we recall from [BeDoMa] the construction of actionangle coordinates in the neighborhood of a torus \u039b invariant for the hamiltonian flow XH ,\n\u2032\n\nleading to existence of a family of tori \u039bJ ,N in the neighborhood of \u039b which, if \u039b is diophantine, are quasi-invariant over arbitrarily long times. Thus we get a variant of BNF.\n3\n\n\f\u2032\n\nIn Sect.2 we quantize some of these \u039bJ ,N , so that they satisfy Bohr-Sommerfeld-Maslov\nquantization condition, and support quasi-modes for H with a suitable accuracy.\nIn Sect.3 we apply these considerations to semi-classical Jacobi-Maupertuis correspondance : assuming that H is completely integrable, or simply has an invariant torus \u039b in some\n\nenergy surface, we show how to construct quasi-modes for H. We show that the frequencies\n\u03c9\ne (resp. \u03c9) of the quasi-invariant flows for H (resp. H) are simply related by \u03c9 = hgie\n\u03c9. This\nimplies partial isospectrality of both hamiltonians.\n\nIn Sect.4 we give various applications of construction of action-angle variables, and exam-\n\nples for semi-classical Jacobi-Maupertuis correspondance, including the shallow-water waves\ntheory. Namely we show how to select profiles of the basin, corresponding to a family of\nLiouville 2-D integrable metrics, which give raise to trapped modes of a given wavelength.\nThis could be easily implemented on a computer program, and consists actually in the main\n\"practical\" result of that paper.\nIn Appendix, we give a short account for Maslov theory and WKB constructions as\nneeded in the main text.\nAcknowledgments: One of us (M.R.) thanks Ch.Duval, J.Sj\u00f6strand and D.H\u00e4fner for useful\nremarks. We also acknowledge a grant from the R\u00e9gion Provence-Alpes-C\u00f4te d'Azur in 2007,\nwhich enabled to spend some fruitful and enjoyable time in both institutions.\n1. Action-angle variables for a family of almost invariant tori.\nFirst we recall the main result of [BeDoMa]. Consider a smooth Lagrangian torus \u039b0 =\n\u0001d\n{(p, x) = (P 0 (\u03c6), X 0 (\u03c6)), \u03c6 = (\u03c61 , * * * , \u03c6d ) \u2208 Td }, Td = R/2\u03c0Z embedded in T \u2217 Rd , and\nlet I 0 = (I10 , * * * , Id0 ),\n(1.1)\n\nIj0\n\n1\n=\n2\u03c0\n\nI\n\nP 0 dX 0\n\n\u03b3j0\n\nbe the corresponding actions computed along the basis of cycles (\u03b310 , * * * , \u03b3d0 ) on \u039b0 . We denote\n\nby Y 0 (\u03c6) the 2d vector function t (P 0 , X 0 ). Although it is possible to take degeneracies into\naccount, we shall assume here that the moment map is non singular near \u039b0 , i.e. Ij0 6= 0 for\n\nall j.\n\nWe may also assume that \u039b0 belongs to a l-parameter family of tori \u039bs , s varying in an\nopen set of Rl , 1 \u2264 l \u2264 d. This is the case, by Arnold-Liouville-Mineur theorem, if these\ntori arise from an integrable, or semi-integrable Hamiltonian system. If l = 1 we can think\nof s = E as the energy of the system, but more generally, the family can be parametrized\n(possibly after renumbering variables, ) by the first l action variables (I1 , * * * , Il ). However,\n4\n\n\ftori of the family \u039bs are not necessarily preserved by the transformations below, so to avoid\ntechnical difficulties we shall here take simply l = 0, and consider a single torus \u039b0 .\nIntroduce the 2d \u00d7 d matrix Y\u03c60 with columns (Y\u03c601 , * * * , Y\u03c60d ), and the d \u00d7 d symmetric\nmatrix M = \u2212(t Y\u03c60 Y\u03c60 )\u22121 (we denote often partial derivatives by a subscript. ) Let also J\n!\n0 \u2212Idd\nbe the standard symplectic matrix J =\n, where Idd is the d \u00d7 d unit matrix.\nIdd\n0\nWe put\n(1.2)\n\nY\n\nJ\n\n=\n\n\u0012\n\nP J (\u03c6)\nX J (\u03c6)\n\n\u0013\n\n= J Y\u03c60 M\n\nThe 2d \u00d7 d matrices Y\u03c60 and Y J satisfy the conditions\n(1.4)\n\nt\n\nY\u03c60 J Y\u03c60 = 0,\n\nt\n\nY J J Y\u03c60 = \u2212Idd ,\n\nt\n\nY J J Y J = 0,\n\nthe last two being implied by (1.2) and the first one, which precisely express that \u039b0 is a\nLagrangian torus. This is proved in Appendix of [BeDoMa] by a direct computation.\nIn the notation Y J , index J refers to new action variables we are constructing below, for\nwhich Y J enjoys the same symplectic properties as\nmatrices are periodic with respect to \u03c6 \u2208 Td .\n\n\u2202Y\n\u2202Ij\n\nfor an integrable system. All these\n\nNow we introduce precisely the new action-angle coordinates (J, \u03c6) \u2208 neigh(I 0 , Rd ) \u00d7\n\u0001d\n\u0001\nP (J,\u03c6)\nR/2\u03c0Z , so that y \u2032 = Y (J, \u03c6) = X(J,\u03c6)\nare canonical coordinates defined in a neighbor-\n\nhood of \u039b0 . As is shown in [BeDoMa] this can be achieved by taking\n(1.5)\n\nY (J, \u03c6) = Y 0 (\u03c6) + Y J (\u03c6)G(J, \u03c6)\n\nwhere the real d-vector G = t (G1 , * * * , Gd ) is obtained by solving the system of the quadratic\nequations :\n(1.6)j\n\n1\nGj \u2212 hG, t Y J J Y\u03c6Jj Gi = \u03b9j , j = 1, 2, . . . , d\n2\n\nwith data \u03b9 = (\u03b91 , * * * , \u03b9d ) = J \u2212 I 0 . We fix the root of this equation by the requirement\nG(J, \u03c6) = \u03b9 + O(\u03b92 ) as \u03b9 \u2192 0. Equations (1.6) can be solved with the help of a fixed\n\npoint theorem, and G depends smoothly and periodically in \u03c6, analytically in J (or \u03b9). For\ncompleteness we recall the following :\nLemma 1.1 [BeDoMa]: Coordinates y \u2032 = (p\u2032 , x\u2032 ) = y + O(\u03b9) are symplectic, i.e. they verify\n(1.7)\n\nhy\u03c6\u2032 j , J y\u03c6\u2032 k i = hyJ\u2032 j , J yJ\u2032 k i = 0,\n\nhyJ\u2032 j , J y\u03c6\u2032 k i = \u2212\u03b4jk ,\n5\n\nj = 1, . . . , d\n\n\fProof: Consider first hyJ\u2032 j , J yJ\u2032 k i. Differentiating (1.5) w.r.t. J and making use of the last\nrelation (1.4) we find hyJ\u2032 j , J yJ\u2032 k i = hGJj , t Y J J Y J GJk i = 0.\n\nConsider next Ajk = hyJ\u2032 j , J y\u03c6\u2032 k i. Differentiating (1.5) w.r.t. \u03c6k and Jj , then making\nuse of the second relation (1.4) in the form t Y J J Y\u03c60k = \u2212ek , ek being the k:th unit vector of\nRd , and of the last relation (1.4), we find\nAjk = \u2212GkJj + hGJj , t Y J J Y\u03c6Jk Gi\nThen differentiating (1.6)j w.r.t. Jk , and making use of the relation t Y J J Y\u03c6Jj = \u2212t Y\u03c6Jj J Y J\nwhich follows from the last equation (1.4), gives Ajk = \u2212\u03b4jk as stated.\nAt last, consider Bkj = hy\u03c6\u2032 k , J y\u03c6\u2032 j i, which by (1.5) again gives\n(1.8)\n\nBkj = hJ Y\u03c60j + J Y\u03c6Jj G + J Y J G\u03c6j , Y\u03c60k + Y\u03c6Jk G + Y J G\u03c6k i\n\nDifferentiating (1.6)j w.r.t. \u03c6k , then (1.6)k w.r.t. to \u03c6j , and forming the difference, the\nmixed derivatives Y\u03c6Jk \u03c6j cancel out, which gives :\n1\n1\n\u2212Gj\u03c6k + Gk\u03c6j + hG\u03c6k , t Y J J Y\u03c6Jj Gi \u2212 hG\u03c6j , t Y J J Y\u03c6Jk Gi+\n2\n2\n\u0001\n\u0001\n1\n1\nhG, t Y\u03c6Jk J Y\u03c6Jj \u2212 t Y\u03c6Jj J Y\u03c6Jk Gi + hG, t Y J J Y\u03c6Jj G\u03c6k \u2212 Y\u03c6Jk G\u03c6j i = 0\n2\n2\n\nWe have t Y\u03c6Jk J Y\u03c6Jj \u2212 t Y\u03c6Jj J Y\u03c6Jk = 2t Y\u03c6Jk J Y\u03c6Jj , and hG, t Y J J Y\u03c6Jj G\u03c6k i = hG\u03c6k , t Y J J Y\u03c6Jj Gi,\nso\n\n\u2212Gj\u03c6k + Gk\u03c6j + hG\u03c6k , t Y J J Y\u03c6Jj Gi \u2212 hG\u03c6j , t Y J J Y\u03c6Jk Gi + hG, t Y\u03c6Jk J Y\u03c6Jj Gi = 0\nReplacing the term hG, t Y\u03c6Jk J Y\u03c6Jj Gi in (1.8) by its expression, we see that hG\u03c6j , t Y J J Y\u03c6Jk Gi\ncancels out with ht Y\u03c6Jk J Y J G\u03c6j , Gi, hG\u03c6k , t Y J J Y\u03c6Jj Gi cancels out with ht Y J J Y\u03c6Jj G, G\u03c6k i,\nwhile ht Y J J Y J G\u03c6j , G\u03c6k i = hJ Y\u03c60j , Y\u03c60k i = 0 by (1.4). So (1.8) simplifies into\nBkj = Gj\u03c6k \u2212 Gk\u03c6j + hJ Y\u03c6Jj G, Y\u03c60k i + hJ Y J G\u03c6j , Y\u03c60k i + ht Y\u03c6Jk J Y\u03c60j , Gi + ht Y J J Y\u03c60j , G\u03c6k i\nand because again of t Y J J Y\u03c60k = \u2212ek , Bkj = 0. The Lemma is proved. \u2663.\n\nIn other words, the transformation \u03ba : (J, \u03c6) 7\u2192 y \u2032 = \u03ba(J, \u03c6) is canonical. This yields a\nd-parameter family of tori \u039bJ , by choosing J = I 0 + \u03b9= Const., and \u039bJ = \u039b0 + O(\u03b9) in the\n\nC \u221e topology.\nRemark: Actually we know, by Darboux-Weinstein theorem (see [BaWe,Corollary 4.20]) that\n\nif \u039b \u2282 T \u2217 Rd is a lagrangian submanifold, then a tubular neighborhood of \u039b in T \u2217 Rd is\nsymplectomorphic to a neighborhood of the zero section Z \u2248 \u039b in T \u2217 \u039b, by a map which is\n6\n\n\fthe identity on \u039b. The construction above specializes and provides a simple proof to DarbouxWeinstein theorem in the case where \u039b is a torus given by J = I 0 in action-angle coordinates,\nso that neighborhoods of Z in T \u2217 \u039b can be identified with neigh(I 0 ; Rd+ )\u00d7Td . In other words,\ngiven the lagrangian immersion \u03b9 : \u039b \u2192 T \u2217 M , we have constructed a symplectic immersion\nI of a neighborhood of Z into T \u2217 M , such that I = \u03b9 \u25e6 \u03c0\u039b on Z, where \u03c0\u039b : T \u2217 \u039b \u2192 \u039b is the\n\nnatural projection.\n\nWe still denote by \u03b3j the basic cycles on \u039bJ , which are obtained by a continuous deformation of those on \u039b, because of the nondegeneracy condition. So we have\nI\n1\np\u2032 dx\u2032\n(1.10)\nJj =\n2\u03c0 \u03b3j\nAssume now that \u039b0 is an integral manifold for Hamiltonian H(p, x), i.e. p = P 0 (\u03c6+\u03c9t), x =\nX 0 (\u03c6 + \u03c9t) is a quasi-periodic solution of the hamiltonian system (\u1e57, \u1e8b) = XH (p, x) on \u039b0\nwith rationally independent frequencies \u03c9, we try to construct a normal form for H near\n\u039b0 . Here notation XH (p, x) stands for the Hamiltonian vector field of H(p, x). By a Taylor\nexpansion in coordinates y \u2032 as above, we have :\n(1.11)\n\u0001\nH \u25e6 \u03ba(J, \u03c6) = H Y 0 (\u03c6) + Y J (\u03c6)G(J, \u03c6) = H(Y 0 (\u03c6)) + hH \u2032 (Y 0 (\u03c6)), Y J (\u03c6)G(J, \u03c6)i + O(\u03b92 )\n\u2202\nwith H \u2032 (Y 0 (\u03c6)) = \u2212J \u1e8f = \u2212J h\u03c9, \u2202\u03c6\niY 0 (\u03c6). So\n\nhH \u2032 (Y 0 (\u03c6)), Y J (\u03c6)G(J, \u03c6)i =\n\nX\n\n\u03c9j Yj0 (\u03c6)YmJ (\u03c6)Gm (J, \u03c6)\n\nj,m\n\nwhich by (1.4) and the relation G(J, \u03c6) = \u03b9 + O(\u03b92 ) gives\n(1.12)\n\nH(y \u2032 ) = H0 + h\u03c9, \u03b9i + O(\u03b92 ),\n\nH0 = H\n\n\u039b0\n\nso the \u039bJ are invariant at first order in \u03b9 under the flow of H \u25e6 \u03ba.\nAssuming further a diophantine condition on \u03c9, we can extend this normal form as\nfollows, using a finite order KAM procedure. We look for a generating function S(J \u2032 , \u03c6)\nsuch that J = \u2202\u03c6 S(J \u2032 , \u03c6), \u03c6\u2032 = \u2202J \u2032 S(J \u2032 , \u03c6), where J \u2032 = I 0 + \u03b9\u2032 . We find that S(J \u2032 , \u03c6) =\nhJ \u2032 , \u03c6i + \u03a6(\u03b9\u2032 , \u03c6) is defined as a Fourier series in \u03c6 \u2208 Td , with vanishing zero mode, and\ncoefficients \u03a6k (\u03b9\u2032 ) = O(\u03b9\u20322 ). Push Taylor expansion (1.11) to next order in \u03b9 = \u03b9\u2032 + \u2202\u03c6 \u03a6(\u03b9\u2032 , \u03c6),\nwe find after averaging over \u03c6 the quadratic terms in \u03b9\u2032\n(1.13)\n\nH(P (J, \u03c6), X(J, \u03c6)) = H0 + h\u03c9, \u03b9i + A(\u03b9\u2032 ) + B(\u03b9\u2032 , \u03c6) + h\u03c9, \u2202\u03c6 \u03a6(\u03b9\u2032 , \u03c6)i + O(\u03b9\u20323 )\n\nwhere A(\u03b9\u2032 ), B(\u03b9\u2032 , \u03c6) = O(\u03b9\u20322 ) are given smooth functions defined in a neighborhood of \u039b0 ,\nand hB(\u03b9\u2032 , *)i = 0 (average over Td . ) Since \u03c9 is diophantine, and B(\u03b9\u2032 , \u03c6) smooth in \u03c6, we\n7\n\n\fcan determine the quadratic part of \u03a6 in \u03b9\u2032 by solving B(\u03b9\u2032 , \u03c6) + h\u03c9, \u2202\u03c6 \u03a6(\u03b9\u2032 , \u03c6)i = 0 up to\nO(\u03b9\u20323 ) terms. This process easily carries out at any given order, yielding the following :\nTheorem 1.2 [BeDoMa]: Let H be as above, and assume the frequency vector \u03c9 satisfies\na diophantine condition. Then for any N = 1, 2, * * *, there is a smooth canonical map \u03baN :\n\n(J \u2032 , \u03c6\u2032 ) 7\u2192 (J, \u03c6) defined for J \u2032 in a neighborhood of I and \u03c6\u2032 \u2208 Td , and a polynomial HN (\u03b9\u2032 )\nof degree N , with HN (\u03b9\u2032 ) = H0 + h\u03c9, \u03b9\u2032 i + O(\u03b9\u20322 ), H0 = h\u03c9, Ii such that\n\n(1.15)\n\nH \u25e6 \u03ba \u25e6 \u03baN (J \u2032 , \u03c6\u2032 ) = HN (\u03b9\u2032 ) + O(\u03b9\u2032N+1 )\n\nThis is precisely a Birkhoff normal form for H in a neighborhood of \u039b0 (see also\n[HiSjVu]. ) Assuming analyticity on H, these estimates could certainly be sharpened to\n\u2032\u2212\u03b2\ngive a remainder O(e\u2212\u03b9 /C ) as in Nekhoroshev theorem, 0 < \u03b2 < 1 being related to the\ndiophantine condition, and C > 0 (see e.g. [Po2]. )\nTo conclude this Section, we make a few remarks concerning quantization in action-angle\nvariables, following [BeDoMa]. Recall [BaWe, Definition 5.33] that a linear map \u03c1 from the\nspace C \u221e (T \u2217 M ) of smooth functions, to the algebra A generated by self-adjoint operators\non some complex Hilbert space H, and endowed with the Lie algebra structure defined by\n[A, B]h = hi (AB \u2212 BA), is called a quantization provided it satisfies so-called Dirac axioms :\n\n(1) \u03c1(1) = Id, (2) \u03c1({f, g}) = [\u03c1(f ), \u03c1(g)]h, (3) for some complete set of functions f1 , * * * , fn\nin involution, the operators \u03c1(f1 ), * * * , \u03c1(fn ) form a complete commuting set. We know this\n\nset of axioms is in general too stringent, in the sense that a quantization of all classical\nobservables doesn't exist, although the symbolic calculus of h-Fourier integral operators, or\n\nMaslov canonical operators, provides a fairly good approximation of this classical-quantum\ncorrespondence.\nQuantization deformation occurs already in the simple case of a completely integrable\nhamiltonian system on T \u2217 M , with hamiltonian H(p, x), which admits a family of lagrangian\ntori \u039bI . Namely, trying to quantize the corresponding action-angle variables (I, \u03c6), considered\nb \u03c1(\u03c6) = \u03c6\nas classical observables, in a neighborhood of the \u039bI 's, we require that \u03c1(I) = I,\nb\nwould satisfy\n(1.17)\n\n[Ibj , Ibk ] = 0,\n\n[\u03c6\nbj , Ibk ]h = \u03b4jk ,\n\n[\u03c6\nbj , \u03c6\nbk ]h = 0\n\nb\nand moreover, that the semi-classical hamiltonian H(x,\nhDx ) associated with H(x, p) via\nb\nusual Weyl h-quantization, would be a function of (\u03c6,\nb I). The naive answer would consist in\nchoosing \u03c6\nb as multiplication by \u03c6, and Ib = hD\u03c6 . But then if we try to recover the canonical\nb pbk = Pk (\u03c6,\nb by symbolic calculus, it turns out that the canonical\noperators x\nbj = Xj (\u03c6,\nb I),\nb I)\ncommutation relations [b\npk , x\nbj ]h = \u03b4jk are only satisfied modulo O(h). (This can be easily\n8\n\n\f\u221a\n\u221a\nchecked also when H is the harmonic oscillator, and x = I cos \u03c6, x = I sin \u03c6, H(p, x) =\np2 + x2 = I. ) Therefore one should in general also include quantum corrections and seek\nb + hX (1) (\u03c6,\nb + * * *. This in turn affects the full\nfor canonical variables as x\nbj = Xj (\u03c6,\nb I)\nb I)\nj\n\nsymbol of hamiltonian H, expressed in action-angle variables, by a quantity O(h2 ), and\nH(p, x, h) = H0 (I) + h2 H1 (I, \u03c6) + * * * depends again on angle-variables. But introducing\n\n\u03b5 = h2 as another small parameter, we can apply a KAM procedure, under some nonresonance condition, to replace (I, \u03c6) by new symplectic coordinates (I \u2032 , \u03c6\u2032 ) and thus get rid\ne 1 (I) + * * *. See\nof angle dependance in the O(h2 ) term, which yields H(p, x, h) = H0 (I) + h2 H\n\n[CdV2], [Vu] for the case of commuting h-PDO's.\n\nFor a quasi-integrable system, we can combine the BNF (at the level of principal symbol)\n\nwith the procedure above.\nIn our case however, mostly because we content with the principal and subprincipal\nsymbol of H, we have no real need to recover the canonical variables (p, x) from (I, \u03c6), or\n(J, \u03c6), nor to quantize action-angle variables.\n\n2. WKB solutions along perturbed tori.\nIn this section, we carry out WKB constructions associated to the family of perturbed\ntori \u039bJ . We start from tori \u039bJ on which H verifies (1.12), and then extend the argument for\ntori obtained as in Theorem 1.2, which are closer to be invariant by the hamiltonian flow.\nWe use essentially known results on geometry of tori that we have recalled in Appendix.\na) Action integrals.\nWe first compute the action integrals on the lagrangian tori \u039bJ \u2282 T \u2217 M , constructed\nfrom \u039b with J = I + \u03b9, in terms of the action-angle variables (J, \u03c6). We denote by F the set\nof focal points, that projects onto the caustics C (see Appendix A.)\n\nTo start with, consider a, b \u2208 M be away from C. Assume y = (p(b), b) \u2208 \u039b is not a\n0\nI\nfocal point, i.e. \u2202X\n\u2202\u03c6 |\u03c6=\u03c6I (b) is not singular ; here \u03c6 (b) is the angle-coordinate of b on \u039b. For\nJ \u2208 neigh(I), let \u03b9J : Td \u2192 T \u2217 M be the lagrangian embedding with image \u039bJ (the context\nprevents from confusing the map \u03b9J with the action variables \u03b9), d\u03c6J = \u03b9\u2217J (pdx) the 1-form\nparametrizing \u039bJ near b, and \u03c6J (x) the angle-coordinate of x \u2208 neigh(b) on \u039bJ .\n\nLet \u03b3 \u2282 \u039b have its x-projection contained in the domain of definition of the \u03c6J . We want\nR\nR\nto compare \u03b3 pdx with \u03b3 \u2032 p\u2032 dx\u2032 on \u03b3 \u2032 \u2282 \u039bJ , where y \u2032 = (p\u2032 , x\u2032 ) = Y (J, \u03c6) are symplectic\ncoordinates as in (1.5), the x-projection of these paths joining a to b. So \u03b3 and \u03b3 \u2032 are\n\nparametrized by \u03c6, the action variable being held constant. Along \u03b3, x = X 0 (\u03c6), p = P 0 (\u03c6),\nwhile along \u03b3 \u2032 , x\u2032 = X 0 (\u03c6) + X J (\u03c6)\u03b9 + O(\u03b92 ), and p\u2032 = P 0 (\u03c6) + P J (\u03c6)\u03b9 + O(\u03b92 ), with X J (\u03c6)\n9\n\n\fand P J (\u03c6) as in (1.2). Substituting these values into\nZ\n\nZ\n\nR\n\n\u03b3\u2032\n\np\u2032 dx\u2032 we get\n\nZ\n\ndhP 0 (\u03c6), X J (\u03c6)\u03b9i\nhP (\u03c6), dX (\u03c6)i +\np dx =\n\u2032\n\u2032\n\u03b3\n\u03b3\nZ\nhP J (\u03c6)\u03b9, dX 0 (\u03c6)i \u2212 hdP 0 (\u03c6), X J (\u03c6)\u03b9i + O(\u03b92 )\n+\n\n(2.1)\n\n\u2032\n\n\u2032\n\n\u03b3\u2032\n\n0\n\n0\n\n\u03b3\u2032\n\nWe choose the origin of angular coordinates such that \u03c6J (a) = 0. Because \u039bJ is lagrangian,\nR \u2032 \u2032\np dx only depends on the end-points of \u03b3 \u2032 . We have\n\u03b3\u2032\nZ\n\n(2.2)\n\n\u03c6J (b)\n\n\u03b3\u2032\n\ndhP 0 (\u03c6), X J (\u03c6)\u03b9i = hP 0 (\u03c6), X J (\u03c6)\u03b9i|0\n\nR\nNext we want to replace the path \u03b3 \u2032 in \u03b3 \u2032 hP 0 (\u03c6), dX 0 (\u03c6)i by \u03b3, which we complete into a\n1-cycle in the \u03c6-space as \u03b3 \u2032 = \u03b3 \u2032\u2032\u2032 + \u03b3 + \u03b3 \u2032\u2032 , with \u03b3 \u2032\u2032\u2032 between 0 and \u03c6I (a), \u03b3 \u2032\u2032 between \u03c6I (b)\nand \u03c6J (b). By Stokes' formula and since dP 0 (\u03c6) \u2227 dX 0 (\u03c6) = 0 :\nZ\nZ\nZ\nZ\n\u0001 0\n0\n0\n+\n+\nhP (\u03c6), dX 0 (\u03c6)i\nhP (\u03c6), dX (\u03c6)i =\n(2.3)\n\u03b3\u2032\n\n\u03b3\n\n\u03b3 \u2032\u2032\n\n\u03b3 \u2032\u2032\u2032\n\nWe express the fact that b = X(\u03c6J (b)) = X 0 (\u03c6I (b)) as\n(2.4)\n\nh\n\nZ\n\n1\n\n0\n\n\u2202X 0\n(\u03c6(s))ds, \u03c6J (b) \u2212 \u03c6I (b)i = \u2212X J (\u03c6J (b))G(J, \u03c6J (b))\n\u2202\u03c6\n\nwhere \u03c6(s) = \u03c6I (b)+s(\u03c6J (b)\u2212\u03c6I (b)) is a straight line. By continuity, \u03c6(s) \u2192 \u03c6I (b) uniformly\n0\n\nI\non s \u2208 [0, 1] as \u03b9 \u2192 0. Since b is not a focal point on \u039b, \u2202X\n\u2202\u03c6 (\u03c6 (b)) is not singular, and the\nR 1 \u2202X 0\nsame holds for 0 \u2202\u03c6 (\u03c6(s))ds when \u03b9 is small enough, so (2.4) gives \u03c6J (b) \u2212 \u03c6I (b) = O(\u03b9).\nR1 0\nR1\n0\n\u2202X 0\nP (\u03c6(t))dt \u2212\n(\u03c6(s))ds\n\u2212\n(\u03c6(t))\n=\nO(\u03b9)\nuniformly\non\nt\n\u2208\n[0,\n1]\nand\nUsing also 0 \u2202X\n\u2202\u03c6\n\u2202\u03c6\n0\n0\nJ\nP (\u03c6 (b)) = O(\u03b9) we find\nZ\nhP 0 (\u03c6), dX 0 (\u03c6)i + hP 0 (\u03c6), X J (\u03c6)\u03b9i|\u03c6=\u03c6J (b) = O(\u03b92 )\n\u03b3 \u2032\u2032\n\nThe same holds for the contribution of \u03b3 \u2032\u2032\u2032 since we may always assume, a being fixed, that\nit is not a focal point, so these estimates shows with (2.2) that\nZ\nZ\nZ\n\u0001 0\n0\nJ\n+\nhP (\u03c6), dX 0 (\u03c6)i = O(\u03b92 )\ndhP (\u03c6), X (\u03c6)\u03b9i +\n(2.5)\n\u03b3\u2032\n\n\u03b3 \u2032\u2032\u2032\n\n\u03b3 \u2032\u2032\n\nOn the other hand, using the canonical relations (1.7) for coordinates y \u2032 , and the estimate\n\nG(J, \u03c6) = \u03b9 + O(\u03b92 ) in C 1 -topology, one readily verifies that\nhP J (\u03c6)\u03b9, dX 0 (\u03c6)i \u2212 hdP 0 (\u03c6), X J (\u03c6)\u03b9i = h\u03b9 + O(\u03b92 ), d\u03c6i\n10\n\n\fIntegrating this 1-form along \u03b3 \u2032 , where \u03b9 is constant, and inserting in (2.1) together with (2.5)\nwe have :\nZ\nZ\n\u2032\n\u2032\n(2.6)\np dx =\npdx + h\u03c6J (b) \u2212 \u03c6J (a), \u03b9i + O(\u03b92 )\n\u03b3\u2032\n\n\u03b3\n\nMore generally, for N = 2, 3 * * *, \u03baN as in Theorem 1.2 and J \u2032 \u2208 neigh(I), consider the\n\u2032\n\n\u2032\n\nlagrangian embedding \u03b9J \u2032 ,N = \u03b9 \u25e6 \u03baN : Td \u2192 T \u2217 M , with image \u039bJ ,N . Let again d\u03c6J ,N =\n\u2032\n\u03b9\u2217J \u2032 ,N (pdx) parametrize \u039bJ ,N near b. Using the estimates \u03c6\u2032 = \u03c6 + O(\u03b9\u20322 ), J = J \u2032 + O(\u03b9\u20322 ),\n\u2032\none can readily extend (2.6) to the tori \u039bJ ,N , so we get :\nProposition 2.1: Let a be away from the caustics of \u039b and y = (p(b), b) \u2208 \u039b is not a focal\npoint, and assume a and b can be joined by a path \u03b3 \u2282 \u039b contained in the domain where \u039b\nis projectable (i.e. the x-projection of \u03b3 is contained in the domain of definition of \u03c6I , where\nthe 1-form d\u03c6I = \u03b9\u2217I (pdx) is a local parametrisation of \u039b. ) Then for any N = 1, 2, * * *, and \u03b9\u2032\n\u2032\nsmall enough, for all tori \u039bJ ,N as above, we have :\n(2.7)\n\n\u03c6J\n\n\u2032\n\n,N\n\n(b) \u2212 \u03c6J\n\n\u2032\n\n,N\n\n(a) = \u03c6I (b) \u2212 \u03c6I (a) + h\u03c6J\n\n\u2032\n\n,N\n\n(b) \u2212 \u03c6J\n\n\u2032\n\n,N\n\n(a), \u03b9\u2032 i + O(\u03b9\u20322 )\n\nNote that (2.7) can be written at the infinitesimal level as \u03b9\u2217J \u2032 ,N (pdx) = \u03b9\u2217I (pdx) + \u03b9\u2032 d\u03c6 +\nO(\u03b9\u20322 ).\n\nNext we consider the case where y = (p(b), b) \u2208 \u039b is a focal point, but y \u2208\n/ F0 [which\n\u2202P 0\nd\nwe recall from Appendix A], so that \u2202\u03c6 |\u03c6=\u03c6I (b) , (i.e. d\u03c0p : \u039b \u2192 Rp ) is non singular.\nR\nFor small \u03b9, the \"alternate\" action is now e\n\u2212xdp and the new generating function d\u03c8 I =\n\u03b3\n\u03b9\u2217I (\u2212xdp). At points y where d\u03c0xI and d\u03c0pI are non singular (i.e. where \u039bI is bi-projectable)\n\u03c8 I and \u03c6I are related by Legendre transformation \u03c6I (x) = h\u2212p, \u2207\u03c8 I (p)i + \u03c8 I (p)|p=p(x) , so\n\n\u03c6I = \u03c8 I + \u03b9\u2217I (xp), up to a constant. We pick again a away from the caustics, and write\ny = (\u03b2, x(\u03b2)), (p(a), a) = (\u03b1, x(\u03b1)). For sufficiently small \u03b9 this holds for the neighborhing\n\ntori \u039bJ and also for the \u039bJ\n\n\u2032\n\n,N\n\n.\n\nR\nR\nSo we need just repeat the former argument, comparing e\n\u2212x\u2032 dp\u2032 with e\n\u2212xdp, where\n\u03b3\u2032\n\u03b3\n\u2032\nthe first integral is computed along a path \u03b3\ne joining (the lift of) \u03b1 with \u03b2 on \u039bJ , and the\nsecond one along a path \u03b3\ne joining \u03b1 with \u03b2 on \u039b, and contained in the domain of definition\nI\nof \u03c8 . Thus we get :\n\nProposition 2.2: Assume y = (p(b), b) = (\u03b2, x(\u03b2)) \u2208 \u039b is a focal point, but y \u2208\n/ F0 . If\na and b can be joined by a path contained in the domain of definition of \u03c8 I , then for any\n\u2032\nN = 1, 2, * * *, and \u03b9\u2032 small enough, for all tori \u039bJ ,N as above we have :\n(2.8)\n\n\u03c8J\n\n\u2032\n\n,N\n\n(\u03b2) \u2212 \u03c8 J\n\n\u2032\n\n,N\n\n(\u03b1) = \u03c8 I (\u03b2) \u2212 \u03c8 I (\u03b1) + h\u03c6J\n11\n\n\u2032\n\n,N\n\n(b) \u2212 \u03c6J\n\n\u2032\n\n,N\n\n(a), \u03b9\u2032 i + O(\u03b9\u20322 )\n\n\fwith notations as in Proposition 2.1, and where d\u03c8 J\n\u2032\nametrizing \u039bJ ,N near b.\n\n\u2032\n\n,N\n\n= \u03b9\u2217J \u2032 ,N (\u2212xdp) is the 1-form par-\n\nNote also that (2.8) can be written at the infinitesimal level as \u03b9\u2217J \u2032 ,N (\u2212xdp) = \u03b9\u2217I (\u2212xdp)+\n\u03b9\u2032 d\u03c6 + O(\u03b9\u20322 ).\nThen we consider the general case, to take in account the possible exceptional set F0\n\ndefined in Appendix A so we assume that d\u03c0|\u039b (y) is of rank k \u2264 d \u2212 1. So \u039b can be\nparametrized by a Morse function S(x, \u03b8) defined near \u03b9\u22121\nI (y), and by the discussion leading\nto (b.27), we may assume S(x, \u03b8) is of the form T (x1 , p2 ) + hx2 , p2 i and \u039b = \u039bT .\nTake a base point A = (\u03b12 , a1 ) \u2208 Rk \u00d7 Rd\u2212k that we identify with its lift through\n\n\u03c0\ne : \u039b \u2192 Rd , (p, x) 7\u2192 (p2 , x1 ) with A \u2208 \u039bT , we assume that A is non singular. The variable\npoint near y, with the same abuse of notations is now B = (\u03b22 , b1 ) \u2208 \u039bT . We deform \u039b into\n\n\u039bJ , and the generating function T to T J . We shall always work in the domains where T J\nare well defined, and drop the subscript T J from \u039bJT J . So let \u03b3 \u2282 \u039b be a path between (the\nlift of) A and B, \u03b3 = \u03b31 + \u03b32 such that p2 = \u03b22 along \u03b31 , and x1 = a1 along \u03b32 . Using (b.27),\nR\nR x \u2202T\nR\nR p \u2202T\nwe find \u03b31 p1 dx1 = 1 \u2202x\n(x1 , p2 )dx1 |p2 =\u03b22 and \u03b32 \u2212x2 dp2 = 2 \u2202p\n(x1 , p2 )dp2 |x1 =a1 , so\n1\n2\n(2.10)\n\n(T (x1 , p2 ) +\n\nhx2 , p2 i)|B\nA\n\n=\n\nZ\n\np1 dx1 +\n\n\u03b31\n\nZ\n\n\u03b32\n\n\u2212x2 dp2\n\nIn the same way, we let \u03b3 \u2032 \u2282 \u039bJ be a path between A and B, \u03b3 \u2032 = \u03b31\u2032 + \u03b32\u2032 such that p2 = \u03b22\nalong \u03b31\u2032 , and x1 = a1 along \u03b32\u2032 , so denoting T \u2032 for T J we have :\nZ\nZ\n\u2032\n\u2032\n\u2032 B\n\u2032\n\u2032\n\u2032 \u2032\n\u2212x\u20322 dp\u20322\np1 dx1 +\n(2.11)\nT (x1 , p2 ) + hx2 , p2 i|A =\n\u03b31\u2032\n\n\u03b32\u2032\n\nWe parametrize \u039bI and \u039bJ by \u03c6, so that x = (x1 , x2 ) = X 0 (\u03c6) = (X10 (\u03c6), (X20(\u03c6)), along\n\u03b3, and x\u2032 = (x\u20321 , x\u20322 ) = X(\u03c6) = (X1 (\u03c6), (X2 (\u03c6)), along \u03b3 \u2032 , where as above, X(\u03c6) = X 0 (\u03c6) +\nX J (\u03c6)\u03b9+O(\u03b92 ), and P (\u03c6) = P 0 (\u03c6)+P J (\u03c6)\u03b9+O(\u03b92 ). Possibly after renumbering the variables\n\u03c6, we may assume that we have a partition of the coordinates \u03c6 = (\u03c61 , \u03c62 ) adapted to the\n\u2202X 0\n\n\u2202P 0\n\nprojection \u03c0\ne : \u039b \u2192 Rk \u00d7 Rd\u2212k , i.e. such that \u2202\u03c611 and \u2202\u03c622 are non singular. Then the\nargument of Propositions 2.1 and 2.2 carries over to the present situation, working separately\n\non \u03b31 and \u03b31\u2032 with the x1 and x\u20321 coordinates, then on \u03b32 and \u03b32\u2032 with the p2 and p\u20322 coordinates.\nSo we proved the following generalization of Propositions 2.1 and 2.2 :\nProposition 2.3: Assume y = (p(b), b) \u2208 \u039b is a general focal point, let \u039b = \u039bI is\nparametrized as in (b.27), and pick a non singular poiint A \u2208 \u039b near y. Then for \u03b9 small\nenough and B near y,\n(2.12)\n\n\u0001\n\u0001B\nI\nJ\nJ\n2\nT J (x\u20321 , p\u20322 ) + hx\u20322 , p\u20322 i |B\nA = T (x1 , p2 ) + hx2 , p2 i |A + h\u03c6 (b) \u2212 \u03c6 (a), \u03b9i + O(\u03b9 )\n12\n\n\fHere d(T J (x\u20321 , p\u20322 ) + hx\u20322 , p\u20322 i) = \u03b9\u2217J (\u2212xdp) = \u03b9\u2217J (pdx) is the 1-form parametrizing \u039bJ near B\nwhere it is bi-projectable, and \u03c6J (B) \u2208 Td the angle coordinate of B. More generally, let\n\u2032\n\nN = 2, 3, * * *, and \u03b9\u2032 small enough, for all tori \u039bJ ,N as above we have with obvious notations :\n(2.13)\n\u0001\n\u0001B\n\u2032\n\u2032\nI\nJ \u2032 ,N\nT J ,N (x\u20321 , p\u20322 ) + hx\u20322 , p\u20322 i |B\n(b) \u2212 \u03c6J ,N (a), \u03b9\u2032 i + O(\u03b9\u20322 )\nA = T (x1 , p2 ) + hx2 , p2 i |A + h\u03c6\nb) WKB solutions.\nThe constructions are recalled for completeness in Appendix A in case of a Schr\u00f6dinger\n\noperator \u2212h2 \u2206+V (x), but the result holds for more general h-PDO. The local WKB solution\nnear point x0 \u2208 M depends again on the structure of \u039b above x0 .\n\nFirst we describe locally the quasi-mode associated with \u039bI in term of (P 0 (\u03c6), X 0 (\u03c6)).\n\nIn the simplest case described in Proposition 2.1, i.e. where \u039b is projectable, the phase\nfunction restricted to \u039b equals \u03c6I (\u03c6), it verifies P 0 (\u03c6) = \u2207\u03c6I (\u03c6) and solves Hamilton-Jacobi\nequation H(\u2207\u03c6I (\u03c6), X 0 (\u03c6)) = H0 = E. Recall from (b.4) that the solution to the transport\n0\n\n\u22121/2\nequation verifies a0 (x; E)|x=X 0 (\u03c6) = Const. | det \u2202X\n.\n\u2202\u03c6 |\nRx\nDenote for short by\npdx\nR xa solution of Hamilton-Jacobi equation with data on \u039b,\ni(\npdx)/h\nand let u(x; E, h) = a0 (x; E)e\n. Then u solves (H(x, hDx ) \u2212 E)u = O(h2 ). Here\nH(x, hDx ) denotes any \"reasonable\" h-quantization of H(p, x), e.g. Weyl quantization ; note\n\nthat as usual, we first quantize the variables (p, x), then restrict to the torus. Moreover\n0\n\u22121/2 i\u03c6I (X 0 (\u03c6))/h\ne\n.\nu(x; E, h)|x=X 0 (\u03c6) = Const. | det \u2202X\n\u2202\u03c6 |\nFor N = 2, 3 * * * let us then consider, for small \u03b9\u2032\n\n(2.15)\n\n\u2032\n\nu(x; \u03b9 , h)|x=X(J \u2032 ,\u03c6\u2032 )\n\n\u2202X(J \u2032 , \u03c6\u2032 ) \u22121/2 i\u03c6J \u2032 ,N\n|\ne\n= Const. | det\n\u2202\u03c6\u2032\n\n\u0001\n\nX(J \u2032 ,\u03c6\u2032 ) /h\n\nClearly, u(x; \u03b9\u2032 , h)|x=X(J \u2032 ,\u03c6\u2032 ) is a lagrangian distribution supported on \u039bJ\n\n\u2032\n\n,N\n\n, \u03c6\u2032 \u2208 Td\n\n, and\n\n\u0002\n\u0003\nH(x, hDx )u(x; \u03b9\u2032 , h) |x=X(J \u2032 ,\u03c6\u2032 )\n\nRx\n\u0002\n\u0003\nis obtained by restricting H(x, hDx ) a0 (x; E)ei( pdx)/h to x = X(J \u2032 , \u03c6\u2032 ), and p = P (J \u2032 , \u03c6\u2032 ).\nLet also EN = HN (\u03b9\u2032 ). At the level of the eikonal equation we have by (1.15)\n(2.16)\n\n(H(p, x) \u2212 EN )|y=(P (J \u2032 ,\u03c6\u2032 ),X(J \u2032 ,\u03c6\u2032 )) = O(\u03b9\u2032N+1 )\n\nNow we consider the transport equation and compute, according to (b.3), (b.4)\n(2.17)\n\nLXH |\n\n\u2032\n\u039bJ ,N\n\n(a0 (x, E)|dx|1/2) = LXH |\n13\n\n\u2032\n\u039bJ ,N\n\n(|d\u03c6|1/2 )\n\n\fHere LXH denotes the Lie derivative of Hamilton vector field XH acting on half-densities,\n\u2032\nXH is no longer tangent to \u039bJ ,N , but it follows again from (1.15) that LXH |\u039bJ,N (|d\u03c6|1/2 ) =\nO(\u03b9\u2032N+1 ). So if we choose N such that \u03b9\u2032N+1 = O(h2 ), we get\n\u0002\n\n(2.18)\n\n\u0003\n(H(x, hDx ) \u2212 EN )u(x; \u03b9\u2032 , h) |x=X(J \u2032 ,\u03c6\u2032 ) = O(h2 )\n\nNow we turn to the case described in Proposition 2.2, i.e. near a focal point y0 = (p0 , x0 )\nwhere \u039b is \u03c0p -projectable. The phase function restricted to \u039b equals \u03c8 I (\u03c6), it verifies X 0 (\u03c6) =\n\u2207\u03c8 I (\u03c6) and solves Hamilton-Jacobi equation H(\u2207\u03c8 I (\u03c6), P 0 (\u03c6)) = H0 = E. The quasi-\n\nmode restricted to \u039b near x0 is then given by (b.5), with phase \u03c8 I , and principal symbol\n0\nb0 (p, E) = C| det \u2202P\n|\u22121/2 that verifies (b.15).\n\u2202\u03c6\nSo for N = 2, 3, * * *, and \u03b9\u2032 small enough, let \u03c7 \u2208 C0\u221e is a cut-off equal to 1 near the\nangle-coordinate of p0 , substitute as above (P (J \u2032 , \u03c6\u2032 ), X(J \u2032 , \u03c6\u2032 )) for (p, x) in (b.5), and define\n\n(2.19)\n\u2032\n\nv(x; \u03b9 , h)|x=X(J \u2032 ,\u03c6\u2032 ) = (2\u03c0h)\n\n\u2212d/2\n\nZ\n\ni hx,P (J \u2032 ,\u03b8)i+\u03c8 J\n\ne\n\n\u2032 ,N\n\n\u0001\n\n(P (J \u2032 ,\u03b8)) /h\n\nTd\n\n\u03c7(\u03b8)| det\n\n\u2202P (J \u2032 , \u03b8) 1/2\n| d\u03b8\n\u2202\u03b8\n\nFollowing the proof of Theorem b.1 leading to (b.15) we see that v(x; \u03b9\u2032 , h)|x=X(J \u2032 ,\u03c6\u2032 ) also\nverifies (2.18), with the same energy EN = HN (\u03b9\u2032 ) that depends only on \u039bJ\n\n\u2032\n\n,N\n\n.\n\nAt last, we can consider the general focal point y0 described in Proposition 2.3, and\nuse the general representation of the quasi-mode supported on \u039b in a neighborhood of x0\nR\ngiven by (b.17), i.e. w(x; E, h) = (2\u03c0h)\u2212d/2 eiS(x,\u03b8)/h a(x, \u03b8, E, h)dx, where we have chosen\nthe number of phase variables equal to d. It is suitable to express w(x; E, h) in the mixed\nrepresentation described after Theorem b.1, so take (x1 , p2 ) as local coordinates on \u039b, \u03c6 =\n\u03c6(x1 , p2 ). For the unperturbed torus \u039b, we have\n\n(2.20)\n\nZ\n\neihx2 ,p2 i/h\nw(x, h)|x=X(\u03c6) = (2\u03c0h)\nZ y\n\u00d7 exp[i( hP, dXi \u2212 hP2 (x1 , p2 ), X2 (x1 , p2 )i)/h]\n\u2212d/2\n\ny=(P (x1 ,p2 ),X(x1 ,p2 ))\n\n\u0001\n\u2202(X1 (\u03c6), P2 (\u03c6)) \u22121/2\n|\ndp2\n\u00d7 \u03c7 \u03c6(x1 , p2 ) | det\n\u2202\u03c6\n\nThen we argue as before, replacing (I, \u03c6) by (J \u2032 , \u03c6\u2032 ) in (2.20), and verify it satisfies (2.18)\nwhen \u03b9\u2032N+1 = O(h2 ). To get a quasi-mode we need to glue different lagrangian distributions\n\nexpressed locally as u, v, w and take care of Maslov indices as is explained in Appendix\nC. There we notice that the embedding (\u039b, \u03b9) is topologically stable if we exclude some\nexceptional lagrangian singularities in \u039b, and so Maslov indices for the \u039bJ\nsame.\n14\n\n\u2032\n\n,N\n\nremain the\n\n\fOn the other hand, Propositions 2.1-3 and implicit functions theorem show that, given\n\u03b4 > 0, it is indeed possible to \"match\" \u03b9\u2032 with values of the actions and Maslov indices \u03b1 along\nthe fondamental cycles as in (1.10) so to satisfy Maslov quantization condition h1 *J \u2032 +\u03b1/4 = 0\n\u2032\nmod H 1 (\u039b; Z) = H 1 (\u039bJ ,N ; Z), for a sequence J \u2032 = Jk\u2032 (h). So let us summarize our main\nresult in the\nTheorem 2.4: Let (\u039b, \u03b9) as before such that \u039b is invariant under the Hamiltonian flow\nof H and this flow has diophantine frequencies \u03c9, H|\u039b = H0 = E. Assume \u039b is free\nof exceptional lagrangian singularities so that H 1 (\u039b; R) is stable under small perturba\u2032\n\ntions. Let also \u03b4 > 0. Then there is a sequence of tori \u039bJ ,N , for J \u2032 = Jk\u2032 (h) satisfying\n|k|h \u2264 h\u03b4 , such that H has quasi-modes (uk (x, h), Ek (h)), |Ek (h) \u2212 E| = O(h\u03b4 ), in the sense\n\n(H(x, hDx ) \u2212 Ek (h))uk (x, h) = O(h2 ). Morover, these quasi-modes are of maximal density,\nin a h\u03b4 -neighborhood of \u039b.\nRemark 2.5: In the case H contains a subprincipal symbol and equation (b.29) holds, the subprincipal form makes sense on \u039b, only when it is invariant by XH . But again, the diophantine\ncondition and our special action-angle variables allow to extend these constructions to the\ncase where XH is no longer tangent to \u039b, provided we solve (b.29) as in (b.31) instead of\n(b.25), and modify Maslov quantization condition as in (c.4).\n3. Jacobi-Maupertuis correspondance.\n\nWe will apply the constructions above to Hamiltonian H(p, x) = p2 + V (x) near energy\nE = 0, where V (x) = \u2212E/g(x). The \"reference Hamiltonian\" H = g(x)p2 denotes an\n(covariant) metric on T \u2217 M , for which \u039b \u2282 {H = E} is an integral lagrangian torus with\n\nirrationnal frequencies \u03c9\ne . The Hamilton vector fields are related by XH = g(x)XH , so that\nif \u03c4 parametrizes the integral curves of XH and t (the new time) those of XH , we have the\nrelation dt = g(X 0 (\u03c4 ))d\u03c4 . This is Maupertuis-Jacobi correspondance.\n\na) Construction of quasi-modes.\nFirst we show that, assuming a diophantine condition on \u03c9\ne , the flow on \u039b for H is\n\u0001\nagain quasi-periodic. Expand g \u2208 C \u221e as a Fourier series on \u039b \u2248 Rd /2\u03c0Zd , g X 0 (\u03c6) =\nX\nhgi +\ncn ein\u03c6 , cn rapidly decreasing, we have :\nn\u2208Zd \\0\n\nProposition 3.1: Assume a diophantine condition on \u03c9\ne . Then Maupertuis-Jacobi corre-\n\nspondance induces a reparametrization of \u039b by\n\n\u03a6 : \u03c60 7\u2192 \u03c6 = \u03a6(\u03c60 ) = \u03c60 + \u03c9\ne f (\u03c60 )\n\nwhere f is a smooth, scalar periodic function with hf i = 0. The motion on \u039b induced by this\nreparametrization is quasi-periodic with frequency vector \u03c9 = \u03c9\ne /hgi, and (for simplicity we\n15\n\n\fdenoted g \u25e6 X 0 by g) :\n(3.1)\n\ndet\n\n\u2202\u03a6\nhgi\n(\u03c60 ) =\n\u2202\u03c60\ng\n\nProof: Integrating dt = g(e\n\u03c9 \u03c4 + \u03c60 )d\u03c4 we get\nt = t0 + hgi\u03c4 + F (e\n\u03c9 \u03c4 + \u03c60 ) \u2212 F (\u03c60 )\nwhere F is obtained by integrating g term by term, and t0 is an arbitrary constant. We\nhave hF i = 0, and F is again smooth due to the diophantine condition. Choose t0 = F (\u03c60 ),\n\nand change variable z = \u03c4 \u2212 t/hgi. With the new frequency \u03c9 = \u03c9\ne /hgi, the latter equation\nrewrites as\n(3.2)\n\nh(z, \u03c8t ) = z + F (\u03c8t + \u03c9\ne z)/hgi = 0\n\nwhere we have set \u03c8t = \u03c60 + \u03c9t. Equation (3.1) holds when z = z0 = \u2212t0 /hgi, \u03c8t =\n\n\u03c8t0 = \u03c60 + \u03c9t0 , and moreover \u2202h\ne z)/hgi > 0. So implicit function theorem\n\u2202z = g(\u03c8t + \u03c9\nshows that the solution to (3.2) is of the form z = f (\u03c8t ), \u03c8t \u2208 \u039b, where f is periodic and\n\nhf i = 0. So far we have shown that Maupertuis-Jacobi correspondance can be written as\n\u03c60 + \u03c9\ne \u03c4 = \u03c60 + \u03c9t + \u03c9f (\u03c60 + \u03c9t). To get the Proposition, it suffices to observe that the\ntrajectory t 7\u2192 \u03c60 + \u03c9t is everywhere dense in \u039b, since \u03c9 is again irrationnal, and moreover\n\u2202\n\u2202\u03c6 (\u03c6\n\n+\u03c9\ne f (\u03c6) = I + \u03c9\ne f \u2032 (\u03c6) is of maximal rank, because\n\n\u0001 hgi\ndet I + \u03c9\ne f \u2032 (\u03c6) =\ng\n\nwhich brings the proof to an end. \u2663\n\nNote that \u03c9 and \u03c9\ne are simultanously diophantine. We can now construct quasi-modes\nfor H supported near \u039b using the procedure set up in Sect.2. On \u039b, Maupertuis-Jacobi\ncorrespondance will only induce by (3.2) a change in the densities, namely\n(3.3)\n\ndet\n\n\u2202P 0\nhgi\n\u2202X 0\nhgi\n\u2202P 0\n\u2202X 0\n, det\n=\ndet\n=\ndet\n\u2202\u03c6\ng\n\u2202\u03c60\n\u2202\u03c6\ng\n\u2202\u03c60\n\nand also in the mixed representation.\n\u2032\n\u22121\nOn neighboring tori \u039bJ ,N , we have (J \u2032 , \u03c6\u2032 ) = \u03ba\u22121\nN (J, \u03c6) = \u03baN (J, \u03a6(\u03c60 )), so that we can\nstill consider \u03c6\u2032 , for given J, as a function of \u03c60 alone. Let us summarize our result so far in\nthe :\nTheorem 3.2: Let H = g(x)p2 be a (not necessarily integrable) covariant metric on T \u2217 M\nhave an invariant torus \u039b with H|\u039b = E, and I be the actions as in (1.1). Assume that\n16\n\n\fon \u039b the Hamiltonian flow of H has diophantine frequencies \u03c9\ne , and morerover \u039b is free of\n1\nexceptional lagrangian singularities so that H (\u039b; R) is stable under small perturbations.\n\nOn the other hand let H(p, x) = p2 + V (x), where V (x) = \u2212E/g(x), be the hamiltonian\non T \u2217 M given by Maupertuis-Jacobi correspondaance. Let also \u03b4 > 0. Then there is a\n\u2032\nsequence of tori \u039bJ , for J \u2032 = Jk\u2032 (h) satisfying |k|h \u2264 h\u03b4 , such that H near energy E = 0\n\u2032\n\nhas quasi-modes (uk (x, h), Ek (h)), |Ek (h) \u2212 E| = O(h\u03b4 ), supported on \u039bJ ,N , in the sense\n(H(x, hDx ) \u2212 Ek (h))uk (x, h) = O(h2 ). Morover, these quasi-modes are of maximal density,\n\nin a h\u03b4 -neighborhood of \u039b. The quasi-eigenfunctions u(x, \u03b9\u2032 , h) = uk (x, h) can be expressed\nin term of \"Maslov canonical operator\", with the help of formulas (2.15), (2.19), (2.20). In\nparticular where \u039b is projectable, we have :\n(3.4)\n\u2202X(J \u2032 , \u03c6\u2032 ) \u22121/2 i\u03c6J \u2032 ,N\n|\ne\nu(x; \u03b9\u2032 , h)|x=X(J \u2032 ,\u03c6\u2032 ) = Const. | det\n\u2202\u03c6\u2032\n\u2032\n\n\u0001\n\nX(J \u2032 ,\u03c6\u2032 ) /h\n\n|(J \u2032 ,\u03c6\u2032 )=\u03ba\u22121 (J,\u03a6(\u03c60 ))\nN\n\n\u2032\n\n,\u03c6 ) \u22121/2\nwhere \u03c60 \u2208 Td . So the half-density | det \u2202X(J\n|\n, for given J \u2032 , can be written as a\n\u2202\u03c6\u2032\nfunction of \u03c60 alone.\n\nInstead of H(x, hDx ) = \u2212\u22062 +V (x) we may consider a h-PDO with symbol H(p, x; h) =\n\np2 + V (x) + hH1 (p, x) + * * *. The introduction of a sub-principal symbol can be handled\n\u2032\n,\u03c6\u2032 ) \u22121/2\n|\nby a factor\nsimilarly, due to Remark 2.5. It modifies | det \u2202X(J\n\u2032\n\u2202\u03c6\nexp[\u2212iG(\u03c6\u2032 )]|(J \u2032 ,\u03c6\u2032 )=\u03ba\u22121 (J,\u03a6(\u03c60 ))\nN\n\nas in (b.31), and Maslov index by the vector h\u03c3H i|\u039bJ \u2032 ,N (1, * * * , 1) as in (c.4).\n\nMore generally, this procedure may be applied whenever Maupertuis-Jacobi correspondance relates the flows of two classical Hamiltonians H and H on a lagrangian manifold \u039b,\nH not necessarily of the form p2 \u2212 1/g(x), as is the case for the shallow water waves disper-\n\nsion relation of Sect.4.d. Actually, all what we need is to construct an oscillating principal\n\u2032\nsymbol for lagrangian distributions microlocalized on the family \u039bJ ,N , and this can be done\n\nfollowing the standard procedure we recall in Appendix b.\nb) Remarks on isospectrality.\nThere naturally arises the question of comparing the quasi-modes microlocalized near\n\u039b of the Schr\u00f6dinger operator H = \u2212h2 \u2206 \u2212 E/g(x), as given in Theorem 3.2, with those\n\nof the Laplacian H(x, hDx )hDx g(x)hDx on M , in other words : does Jacobi-Maupertuis\ncorrespondance imply (partial) isospectrality ? Theorem 3.2 gives all quasi-modes of H\n\nsupported in a microlocal neighborhood of an invariant torus \u039b for H. Here we address the\nconverse problem, i.e. how to construct quasi-modes for the Laplace operator associated with\nH (that we may write in a symmetric form as H(x, hD) = hhDx , g(x)hDx i see e.g. [Mat], )\nwith quasi-eigenvalues close to the Ek (h) ?\n17\n\n\fWe shall assume here that H = g(x)p2 is integrable, so that in global action-angle\nvariables, H = H(I) = he\n\u03c9 (I), Ii, where I are as in (1.1), and \u03c9\ne (I) = \u2202H\n\u2202I . Choose I = I0\n\nas a base point for the action-angle coordinates (J \u2032 , \u03c6\u2032 ) we have constructed so far for H,\nand consider H(J \u2032 ) = he\n\u03c9 (J \u2032 ), J \u2032 i. Under some generic non degeneracy condition, the integral\nmanifolds of H(J \u2032 ) are close to those of H(I), for small enough \u03b9\u2032 . By definition, the action\ne J \u2032 (integral manifolds for H) verify (1.1), and the \u039b\ne J \u2032 are\nintegrals on the lagrangian tori \u039b\n\u2032\ne J \u2032 6= \u039bJ \u2032 ,N if\nclose enough to the \u039bJ ,N (integral manifolds for H), although in general \u039b\nR\nR\n\u03b9\u2032 6= 0. It is still possible to compare the action pdx along \u039b with the action pdx along\ne J \u2032 as in Propositions 2.1-3. We can also extend the WKB constructions leading to Theorem\n\u039b\n2.4 in the case of the Schr\u00f6dinger operator H to the Laplace operator H(x, hD), and the fact\ne J \u2032 makes them easier. To get Maslov quantization condition on \u039b\neJ\u2032\nthat XH is tangent to \u039b\nit suffices to choose J \u2032 = Jek\u2032 (h) (instead of J \u2032 = Jk\u2032 (h)). Since Jek\u2032 (h) = Jk\u2032 (h)(1 + O(h)), this\n\ngives easily the required (approximate) isospectrality result.\n4. Some applications\n\nWe start by examining the simple case of a conformal, radially symmetric metric. Then\nboth geodesic flow and hamiltonian flow (with potential) are integrable, and the constructions\nabove are not truly necessary, but this can help to understand more complicated situations,\nwhich we consider next. Finally we study the Hamiltonian associated with the dispersion\nrelation that arises in the shallow water waves theory.\na) Radial potential and related Zeeman effect.\nThe metric in cotangent space T \u2217 R2 we consider is given by H(p, x) = p2 g(|x|). In polar\n2\ncoordinates x = (r, \u03b8) with dual variables p = (\u03c1, \u03c8), the kinetic energy reads p2 = \u03c12 + \u03c8r2\nand Hamilton equations take the form\n\u1e59 = 2\u03c1g(r),\n(4.1)\n\u03b8\u0307 = 2\u03c8\n\ng(r)\n,\nr2\n\n\u03c1\u0307 = \u2212g \u2032 (r) \u03c12 +\n\u03c8\u0307 = 0\n\ng(r)\n\u03c82 \u0001\n+ 2 3 \u03c82\n2\nr\nr\n\n(Because of the radial symmetry, this is equivalent to consider the Hamiltonian with potential.) This example is of course well known (see [Ze], [HiSjVu] and references therein) but we\nwant here to give an explicit parametrization for (r, \u03b8) in action-angle variables, from which\nwe deduce the configuration of caustics. We assume the energy surface \u03a3E\n(4.2)\n\ng(r) \u03c12 +\n\n\u03c82 \u0001\n=E\nr2\n\nto be compact, and look for the lagrangian foliation of \u03a3E . The last equation (4.1) shows that\n2\u0001\n\u03c8 = \u03c80 is a constant of the motion, so the moment map is of the form m = g(r) \u03c12 + \u03c8r2 , \u03c8).\n18\n\n\fLet us find the actions variables and the fundamental frequencies \u03c9 = (\u03c91 , \u03c92 ) on the torus\n\u039b = {m = (E, \u03c80 )}. We have\n(4.3)\n\nhP, dXi = \u03c1dr + \u03c8d\u03b8\n\n0)\nAssume there is r0 > 0 such that \u03c802 g(r\n= E. Then C = {r = r0 } is a caustic of \u039b\nr02\n(turning surface) and for r = r0 , \u03c1 = 0. For a general Morse function g(r), there are\n\nseveral turning surfaces, delimiting annuli of radius r1 < * * * < rn in the x-space. Choose\nan annulus D = {r1 < r < r2 } in the classically allowed region, and call \u039b the connected\n\ncomponent of the integral manifold lying above D. As a first fundamental cycle \u03b31 in \u039b, we\ntake r = r0 , (r0 = r1 or r2 ), \u03c8 = \u03c80 . Integrating (4.3) along \u03b31 , we find the first action\nR\n1\nhP, dxi = \u03c80 (angular momentum). Let \u03b32 the second fundamental cycle\nvariable I1 = 2\u03c0\n\u03b31\nbe given by \u03b8 = \u03b80 , r1 \u2264 r \u2264 r2 , this yields Clairaut integral\nZ\nZ r2\nZ r2\n1\n1\nE\n\u03c802 \u00011/2\nI2 =\nhP, dxi =\n\u03c1dr =\n\u2212 2\ndr\n2\u03c0 \u03b32\n2\u03c0 r1\ng(r)\nr\nr1\nSubstituting \u03c80 = I1 , since the turning points r1 , r2 depend also on I1 , we find that I2 is of the\n\nform I2 = f (I1 ) where f is a smooth function (recall that E is held fixed.) The hamiltonian\nreduces to H(I1 , f (I1 )) = E, and differentiating this relation we get the rotation (or winding)\nnumber\n\n\u03c91\n\u2202I H\n(\u03c80 ) = 1 = \u2212f \u2032 (I1 )\n\u03c92\n\u2202I2 H\n\nNext we notice that the 2 first equations (4.1) relative to the (r, \u03c1)-projection of motion are\ndecoupled from the other equations for the \u03b8-projection. So integrating these and using that\n\u039b is a torus of periods 2\u03c0, we find that\n(4.4)\n\nr = r(\u03c92 t + \u03c602 ),\n\n\u03c1 = \u03c1(\u03c92 t + \u03c602 )\n\nfor some constant \u03c602 . Now we use the third equation (4.1) which can be integrated as\nR t g(r)\ng(r)\n0\n0\n\u03b8(t) = 2\u03c80\nr2 |r=r(\u03c92 s+\u03c62 ) ds. We expand r2 as a Fourier series in \u03c92 s+\u03c62 , and integrate\nterm by term, which gives\n(4.5)\n\ne 2 t + \u03c60 ) + \u03c91 t + \u03c60\n\u03b8 = \u03b8(\u03c9\n2\n1\n\nHere \u03c601 is a constant, and \u03c91 = 2\u03c80 h g(r)\ni, the 0:th order Fourier coefficient, (h*i denotes the\nr2\n\ntime average over [0, 2\u03c0].)\nWe look now at the caustic and determine the focal points. Note that because of con-\n\nservation of momentum, to any x inside the annulus, correspond exactly 2 values of p. We\nhave\n!\n!\n\u2202\u03c1\n\u2202r\n\u2202e\n\u03b8\n\u2212r sin \u03b8\n\u2202P\n\u2202X\n\u2202\u03c62 cos \u03b8 \u2212 r sin \u03b8 \u2202\u03c62\n\u2202\u03c62 cos \u03c8 0\n=\n, B=\n=\nC=\n\u2202\u03c1\n\u2202e\n\u03b8\n\u2202r\n\u2202\u03c6\n\u2202\u03c6\nsin\n\u03b8\n+\nr\ncos\n\u03b8\nr\ncos\n\u03b8\n0\n\u2202\u03c62\n\u2202\u03c62\n\u2202\u03c62 sin \u03c8\n19\n\n\f\u2202\n\u2202\nd\n= \u03c91 \u2202\u03c6\n+ \u03c92 \u2202\u03c6\non the torus \u039b, we recover the fact that\nFrom (4.1) and the relation dt\n1\n2\n\u2202r\n= 0, i.e. \u03c1 = 0. Moreover, the condition that (C, B) is\nthe focal points are given by \u2202\u03c6\n2\n\u2202\u03c1\neverywhere of rank 2 (see Leemma a.1 ) yields \u2202\u03c6\n6= 0 when \u03c1 = 0. The caustic r = r0\n2\nconsists here only in points of F0 , and the degeneracy is due to the radial symmetry of the\nmetric. A particular case, with zero angular momentum, was studied in [O-de-AlHa].\n\nRemark: It is known that due to the positive homogeneity of H with respect to the action\nvariables, Euler formula gives \u03c91 I1 + \u03c92 I2 = E (see [Ze]). Let us give another simple proof of\nthis. Considering the Lagrangian formulation associated with H, we see that the energy of\nthe (unit mass) particle moving along the geodesic flow is\nZ\nE = \u2212 h\u1e8b, pidt\nR\nwhere \u2212 denotes limT \u2192\u221e\n\n1\nT\n\nRT\n0\n\n. Substituting \u1e8b = h\u03c9, \u2202\u03c6 ix, we get E =\n\nX\nj\n\nZ\n\u2202x\n\u03c9j \u2212 h\n, pidt.\n\u2202\u03c6j\n\nNow if the frequencies are rationnally independent we can replace the time average by the\naverage over angles variables, so that by the definition of Ij :\nE=\n\nX\n\n\u03c9j (2\u03c0)\n\nj\n\n\u2212d\n\nZ\n\nTd\n\nh\n\nX\n\u2202x\nx, pid\u03c6 =\n\u03c9j I j\n\u2202\u03c6j\nj\n\nConsider now Maupertuis-Jacobi correspondance allowing to switch from H to the hamil-\n\n1\ntonian H = p2 \u2212 g(r)\n. As a semiclassical example, we consider the Schr\u00f6dinger operator with\npotential \u2212u(r) :\nh2 \u2202 2\nh2 \u2202 \u2202\nr\n\u2212 2 2 \u2212 u(r)\nH =\u2212\nr \u2202r \u2202r\nr \u2202\u03b8\n\u221a\nWe separate variables expanding as a Fourier series in \u03b8, and rescale by r, which leads\n\u22022\nto a family of 1-d semi-classical channel operators of the form Hn = \u2212h2 \u2202r\n2 + Vn (r) with\n2\n\n\u2212 u(r). Thus the angular momenta are given by \u03c8 =\neffective potential Vn (r) = h2 n +1/4\nr2\n2\n1/2\n\u03c8n = h(n + 1/4) , and the turning surfaces r = r0 at energy E by r 2 (E + u(r)) = \u03c802 . So\n\nbecause of the centrifugal barrier, the energy shell for Hn can have a bounded component\n0 < r1 \u2264 r \u2264 r2 in configuration space, and another unbounded component r \u2265 r3 (consider\ne.g. u(r) = 1/r + r > 0 and E = 0. ) A torus \u039b corresponding to the angular momentum \u03c8n\nin the compact component of the energy surface, carries a quasi-mode for suitable E = E(h),\nand E(h) turns in general into a resonance for hamiltonian H, whose imaginary part has to\nbe computed.\nA famous example is given by the dynamics in R3 of an electron in a Coulomb potential\n\u22121/r , and interacting with a small, constant magnetic field of strenght B (the constructions\n20\n\n\fabove should be extended to the 3-D case). In suitable units, and cylindrical coordinates\n(\u03c1, \u03b8, z), with dual variables (p\u03c1 , p\u03b8 , pz ) the Hamiltonian takes the form :\nH = p2\u03c1 + p2z +\n\np2\u03b8 \u0001\n+ B\u03c12 \u2212 (\u03c12 + z 2 )\u22121/2\n\u03c12\n\nThe Coulomb singularity can be removed by introducing Jacobi or \"parabolic\" coordinates,\nsee e.g. [Ts]. The Rayleigh-Schr\u00f6dinger series for resonances near E = 1/4 is Borel summable\nand can be computed perturbatively around B = 0 (Zeeman effect). This (non semiclassical)\nproblem has been completely solved in [HeSj], and lies far beyond the scope of our analysis.\nNevertheless, we would like to point out that resonances arise from connecting real tori (one\nof them is actually a cylinder, and lies over an annulus of the form \u03a9 = {r3 < \u03c1 < +\u221e}, )\nthrough tunnel cycles in the classically forbidden region, see [DoSh] for a related problem.\nb) The Kerr-Newman space time.\nWe give another example of a metric for which we can find some invariant (degenerate) tori and reparametrize the natural phase space variables with action-angle variables by\nthe procedure above. Namely, consider the geodesic flow associated with a simplified KerrNewman metric (see e.g. [Ch], or [H\u00e4] and references therein, ) for which the black-hole\nangular momentum per unit mass is a = 0 (Reissner-Nordstr\u00f6m space-time), M its mass and\nQ its charge. The Hamiltonian reads :\nH=\n\n\u0001\n\u03c6\u22172\n1 r4 \u03c4 2\n2\n\u22172\n\u2212\n\u2212\n\u2206\u03c1\n\u2212\n\u03b8\n2\n2r 2 \u2206\nsin \u03b8\n\nThe variables (t, \u03c4, r, \u03c1, \u03b8, \u03b8 \u2217, \u03c6, \u03c6\u2217 ) \u2208 T \u2217 R1+3 are denoted collectively by (P, X), and \u2206 =\n\u2206(r) = r 2 \u2212 2M r + Q2 , is a second order polynomial with constant coefficients having 2 real\nand positive roots r1 < r2 . The region r1 \u2264 r \u2264 r2 is called Boyer-Lindquist block BII . The\nequations of motion are of the form\nr2\n\u2206\n\u2202H\n\u03c4, \u03c4\u0307 = 0, \u1e59 = \u2212 2 \u03c1, \u03c1\u0307 = \u2212\n\u2206\nr\n\u2202r\n\u2217\n\u22172\n1\n\u03b8\n1\n\u03c6\n\u03b8\u0307 = \u2212 2 , \u03b8\u0307 \u2217 = 2 \u2202\u03b8 2 , \u03c6\u0307 = \u2212 2 2 \u03c6\u2217 ,\nr\n2r\nsin \u03b8\nr sin \u03b8\n\u1e6b =\n\n(4.7)\n\n\u03c6\u0307\u2217 = 0\n\nIt is known that there are 4 integrals of motion, given by\np = 2H, E = \u03c4, L = \u2212\u03c6\u2217 , K = \u03b8 \u22172 +\n\nL2\nr4 \u03c4 2\n\u2212 \u2206\u03c12 \u2212 pr 2\n=\n\u2206\nsin2 \u03b8\n\nThe energy surface is of course non bounded, but has some bounded connected components\nin the space-like region t = t0 , \u03c4 = 0, we can call \"unphysical\". The moment map restricted\n21\n\n\fto \u03c4 = 0 is of the form m = p, L, K). Let us find the actions variables and the fundamental\nfrequencies \u03c9 = (\u03c91 , \u03c92 , \u03c93 ) on the corresponding torus \u039b. We have hP, dXi = \u03c4 dt + \u03c1dr +\n\n\u03b8 \u2217 d\u03b8 + \u03c6\u2217 d\u03c6.\nAs a first fundamental cycle \u03b31 in \u039b, we take r = r0 \u2208 {r1 , r2 }), \u03c6\u2217 = \u2212L. Integrating\n\n(4.7) along \u03b31 , we find that d\u03c6 and d\u03b8 are related by d\u03c6 =\nvariable takes the form :\n1\nI1 =\n2\u03c0\n\nZ\n\nK\nhP, dXi =\n2\u03c0\n\u03b31\n\nZ\n\n0\n\n2\u03c0\n\nK\u2212\n\n\u03c6\u2217\nd\u03b8\n\u03b8\u2217 sin2 \u03b8\n\nso the first action\n\nL2 \u0001\u22121/2\nd\u03b8\nsin2 \u03b8\n\n\u221a\nwhich makes sense only if L = 0. So the dimension of \u039b is 2, and I1 = K.\nLet \u03b32 the second fundamental cycle be given by \u03b8 = \u03b80 , r1 \u2264 r \u2264 r2 , this yields another\nClairaut type integral\n\n1\nI2 =\n2\u03c0\n\nZ\n\n1\nhP, dXi =\n2\u03c0\n\u03b32\n\nZ\n\nr2\n\nr1\n\n1\n\u03c1dr =\n2\u03c0\n\nZ\n\nr2\nr1\n\nK + pr 2 \u00011/2\ndr\n\u2212\u2206\n\nwhere we have made use of E = 0.\nThe last components of the degenerate (3+1)-torus in t = t0 is then I3 =\n\n1\n2\u03c0\n\nR 2\u03c0\n0\n\n\u03c6\u2217 d\u03c6 =\n\n0, and \u03c93 is undefined. It is then clear from the Hamilton equations (4.7) that the description\nabove of the motion for the geodesic flow with a radial metric extends to this case without\nchange. In particular, formulae corresponding to (4.4) and (4.5) hold. We shall not investigate\nfurther the case of degenerate tori (see [BeDoMa] for a general discussion.) Other \"solvable\nmodels\" are considered in [DuFoNo,Chap.7].\nc) Liouville metrics.\nThese metric have been extensively studied ([Fo], [BNe], [Se], [Mat], . . . ) for their nice\nproperty of being square integrable, in the sense that the geodesic flow has another quadratic\nintegral, i.e. a quadratic polynomial in p.\nWe call Liouville metric on a domain \u03a9 \u2282 R2 a conformal metric given in T \u2217 \u03a9 by the\n\nhamiltonian H(x, p) = g(x)p2 with a quadratic (in momentum) second integral.\nWe call model Liouville metric on \u03a9 the Liouville metric where\n(4.8)\n\ng(x) = u(x1 ) + v(x2 )\n\n\u0001\u22121\n\nIt is straightforward to check that, besides H(x, p) = E, an additional integral of the motion\nis given by\n(4.9)\n\nf (p, x) =\n\nv(x2 )p21 \u2212 u(x1 )p22\n=F\nu(x1 ) + v(x2 )\n22\n\n\fA classical result of Birkhoff (see [Fo,p.291]) says that in certain appropriate coordinates any 2-D Riemannian metric whose geodesic flow has a additional integral quadratic in\nmomenta is (locally) a model Liouville metric.\nAn interesting case is when g is globally of the form (4.8) on \u03a9. Thus the hamiltonian\nsystem decouples completely into two 1-d hamiltonians with a potential p21 = u(x1 )E +F, p22 =\nv(x2 )E \u2212 F , and moment map m = (E, F ). The corresponding semiclassical Schr\u00f6dinger\n\noperator is also completely integrable, in the sense that the spectral problem reduces in\nfinding the joint spectrum of 2 commuting 1-D Schr\u00f6dinger operators, see e.g. [KMS] for a\nstudy of the spectra of Laplace-Beltrami operators on a Liouville surface, and also [DoSh] for\ntunneling effects.\nMoreover, square integrable conformal metrics when \u03a9 is an annulus, are globally, conformally equivalent to model Liouville metrics in the following sense :\nProposition 4.1 [Mat]: Let H(x, p) = g(x)p2 be a smooth conformal square integrable\nmetric on a compact domain \u03a9 of the x-plane diffeomorphic to an annulus, and \u039b \u2282 T \u2217 \u03a9 be\n\nan integral lagrangian manifold for the hamiltonian flow such that \u03c0 : \u039b \u2192 \u03a9 is surjective\n(\u039b has no \"holes\", i.e. there is no forbidden region above \u03a9. ) Then there exists a bijective\ne (depending on \u039b) where \u03a9\ne is an annulus of the x-plane, and such\nconformal map \u03b1 : \u03a9 \u2192 \u03a9\nthat the image of H through \u03b1 becomes a model Liouville metric.\n\nOne can also compute action integrals I and corresponding frequencies \u03c9 as in Part a).\nIn particular we have the relation \u03c91 I1 + \u03c92 I2 = 2E. At the level of operators, we use Weyl\nh-quantization of the form H(x, hD) = hDx g(x)hDx , so that the diffeomorphism \u03b1 takes\ne hD) = hD|\u2207\u03b1|2 g \u25e6 \u03b1(y)hD.\nH(x, hD), denoting by y the new space coordinates, to H(y,\n\nThis operator is of special interest in the theory of surface water waves captured by coasts\nand bottom relief irregularities.\n\nConsider now the following semiclassical \"Maupertuis problem\" : let H(x, p) = g(x)p2\nand \u039b \u2282 T \u2217 \u03a9 be as in Proposition 4.1, with H|\u039b = 1. Let H = \u2212h2 \u2206\u22121/g(x), and A = A(x)\n\nbe the unitary Fourier Integral Operator (FIO) on L2 (\u03a9) implementing \u03b1 (suitably extended\ne = A\u2217 HA is a self-adjoint h-PDO on L2 (\u03a9,\ne |\u2207\u03b1|2 dy) with\nto the whole space). Then H\ne 0 (y, p) = p2 \u2212 1/e\ne\nprincipal symbol H\ng (y) (here e\ng = g \u25e6 \u03b1 is the model Liouville metric on \u03a9\n\ngiven in Proposition 4.1. ) There is no sub-principal symbol. Moreover, \u039b is an invariant\ne\nlagrangian manifold for XH\ne . So we may apply Theorem 3.2 to construct quasi-modes for H.\nIn the following subsection we shall introduce another Maupertuis correspondance for this\ngeodesic flow.\nd) The shallow water waves.\nLet \u03a9 \u2282 R2 (the \"basin\") be the complement of a bounded set (the \"island\"), so that\n23\n\n\f\u03a9 is diffeomorphic to an (unbounded) annulus. In the shallow water waves theory [DoZh]\none constructs a h-PDO with symbol L(p, x; h) = L0 (p, x) + hL1 (p, x) + * * *. The principal\n\nsymbol of L (dispersion relation) on T \u2217 \u03a9 reads :\n\nL0 (p, x) = |p|(1 + \u03bcp2 ) tanh(D(x)|p|)\n\n(4.10)\n\nwhere D is a smooth positive function, describing the depth of the basin, and \u03bc > 0 a small\nparameter. Quasi-modes of L represent the waves trapped by the island. By a MaupertuisJacobi correspondance, we shall construct trapped modes for L at energy E from lagrangian\ntori of Liouville metrics as above, by choosing the depth profile in an appropriate way. Since\nLiouville metrics are actually generic among metrics with a quadratic second integral [BeN],\nthis result could be of practical interest.\nFor simplicity we shall assume \u03bc = 0, but it is not hard to see that our constructions\nmay be carried out perturbatively, due to implicit functions theorem, for \u03bc > 0 small enough.\nNote that, if D(x) is positively homogeneous of degree 1, then integrability of L0 (p, x) =\n|p| tanh(D(x)|p|) at energy 1 implies integrability at all energies E > 0 (make the symplectic\nchange of coordinates (x\u2032 , p\u2032 ) = (Ex, E \u22121 p). ) In general case however, L0 (x, p) has no reason\nfor being integrable at any energy E, but finding suitable profiles that give raise to invariant\ntori can be achieved by the following Maupertuis correspondance.\nNamely, multiply relation L0 (p, x) = E (for \u03bc = 0) by D(x), and set z = |p|D(x),\n\u03c6(z ) = z tanh z. We denote by \u03c8 : R+ \u2192 R+ the inverse of \u03c6(z 2 ), which is a smooth\n2\n\nincreasing function, so that (4.10) can be rewritten as\n(4.11)\n\nH(x, p) = g(x, E)p2 = 1,\n\ng(x, E) =\n\nD2 (x)\n\u03c8(ED(x))\n\nWe have the elementary :\nLemma 4.2: On the energy surface H(x, p) = 1, the Hamilton vector fields XL0 and XH\n\n\u03c8(ED(x))\nare related by XH = D(x)\u03c8\n\u2032 (ED(x)) XH , and this induces a reparametrization of the integral\ncurves of XH (X(t), P (t)) given by Maupertuis-Jacobi correspondance\n\n(4.12)\n\ndt =\n\n\u03c8(ED(x))\nd\u03c4\nD(x)\u03c8 \u2032 (ED(x))\n\nSo we need look for depth profiles D(x) (depending also on E, ) for which g(x, E)p2\nD2\nis integrable. Clearly the function G : R+ \u2192 [0, 1[ defined by G(D) = \u03c8(D)\nis a smooth\nincreasing function, satisfying G(D) = D(1 \u2212 31 D + * * *) as D \u2192 0, and limD\u2192\u221e G(D) = 1,\nso the depth profile D(x) = D(x, E) can be chosen as the solution of g(x, E) = g(x) =\n24\n\n\fE \u22122 G(ED(x, E)), where g(x) is one of the square integrable metrics given in Proposition\n4.1.\nNow if the geodesic flow H(x, p) = g(x, E)p2 is integrable and admits invariant tori, the\nprocedure set up in Sect.3 can be extended to construct quasi-modes for Weyl h-quantization\nLw (x, hD) of hamiltonian L(x, p; h), for which eigenfunctions, or quasi-modes, describe again\ntrapped waves near energy E. Note however that L is a h-PDO of more general type than\na Schr\u00f6dinger operator, but all our constructions, and in particular the results of Appendix,\napply to this setting, as we pointed out after Theorem 3.2. Thus we can state our main result\nas :\nTheorem 4.3: Consider the h-PDO with symbol L(p, x; h) = L0 (p, x) + hL1 (p, x) + * * *\n\nwith L0 as in (4.10) defined on an open set \u03a9 \u2282 R2 diffeomorphic to an annulus. For all\nE > 0, and all smooth Liouville metric H(x, p) = g(x, E)p2 on T \u2217 \u03a9, there exists a \"depth\nprofile\" D(x) = D(x, E) on \u03a9, such that the pair of Hamiltonians (L0 , H) have the same\n\ntrajectories at energies (E, 1), both parametrizations being related by (4.12). In particular,\nH(x, p) being integrable, (L0 , H) have a common family of lagrangian tori \u039b for energies\n\n(E, 1), and Theorem 3.2 allows to construct a sequence of quasi-modes for L(x, hDx ; h) near\nenergy E.\nAppendix : Regular WKB constructions and Maslov theory\n\nIn this Section we recall some well known facts about semi-classical quantization by\nstandard Maslov theory ; we refer to [Ar1,2], [So], [CdV1], [H\u00f61,2], [Laz], [Le], [Li], [Du1,2],\n[GuSt], [Iv], [We], [MeSj], [BaWe], [DoZh], [deG]. . . for more details. In Part A we give a\nrather superficial account for singularities of a lagrangian manifold diffeomorphic to a torus,\nand paramerized globally by angle variables \u03c6 \u2208 Td (essentially when d = 2) ; then we\n\nderive a simple formula for Maslov index. In Part B we recall some known facts about WKB\ntheory, when the tangent space to the lagrangian manifold contains XH , as a preliminary\n\nstep to Sect.3 for the perturbative case. In Part C we combine these results to get BohrSommerefeld-Maslov quantization condition.\nA. Maslov index and singularities for a lagrangian immersion of the torus.\nLet M be a smooth Riemannian manifold, (we shall think essentially of M = Rd or the\nflat torus M = Td in the case of the geodesic flow on a Liouville surface, ) and \u03b9 : Td \u2192 T \u2217 M\na smooth lagrangian immersion, we parametrize \u039b = \u03b9(T2 ) by p = P (\u03c6), x = X(\u03c6). To\ncomply with usual notations, we identify already Td with its image through \u03b9, so that the\nLagrangian immersion reads now \u03b9 : \u039b \u2192 T \u2217 M .\n\nWe begin with a short description of lagrangian immersions. Contrary to local lagrangian singularities, the global geometry of lagrangian tori, especially those arising from\n25\n\n\fintegrable systems is not so commonly discussed (see however [O-de-AlHa], [DoZh] and references therein. ) We call focal point a point y \u2208 \u039b where \u03c0\u2217 : T \u039b \u2192 T M is singular,\n\nand caustics the projection C of the set of focal points onto M . We introduce the jacobian\n\u2202X\nmatrices B = \u2202P\n\u2202\u03c6 and C = \u2202\u03c6 , and recall the following standard result (see e.g. [DoZh])\nLemma a.1: With the notations above, we have :\n1) the matrix (B, C) is of rank d.\n2) the matrices t CB, BC \u22121 and CB \u22121 are symmetric (whenever well defined, otherwise\nreplace e.g. B \u22121 by det(B)B \u22121 . )\n3) C \u00b1 iB is non degenerate.\nProof: The 2 first statements easily follow from the definition of a Lagrangian manifold, and\n\u0001\nthe 3:rd one from computing the hermitian scalar product \u03be|(t BC \u2212 t CB)\u03be when \u03be belongs\nto the kernel of C \u00b1 iB. \u2663\n\nTaking variations, we see that tangent vectors (\u03b4X, \u03b4P ) \u2208 T \u039b are given by \u03b4P = B(y)\u03b4\u03c6,\n\n\u03b4X = C(y)\u03b4\u03c6, so \u03b4P = BC \u22121 (y)\u03b4X when Ty \u039b is transverse to the fiber, or \u03b4X = CB \u22121 (y)\u03b4P\nwhen Ty \u039b is transverse to the zero section of T \u2217 M . So \u03c6\u2032\u2032 (x) = BC \u22121 (y), when \u039b is\nparametrized by the 1-form d\u03c6 = \u03b9\u2217 (pdx), while \u03c8 \u2032\u2032 (p) = CB \u22121 (y), when \u039b is parametrized\nby the 1-form d\u03c8 = \u03b9\u2217 (\u2212xdp).\nFor simplicity restrict now to the 2-d case, and let y be a focal point. By property 1) of\nthe Lemma, either B(y) is of maximal rank, or both C(y) and B(y) are of rank 1.\n\nIn the first case, either C(y) is of rank 1 (which, under some transversality condition, is\nthe generic case, and corresponds to the simple fold A2 , ) and \u039b near y intersects (tangentially)\nthe fiber V M (the vertical space of T \u2217 M ) along a line, so C is of codimension 1, or \u039b is tangent\n\nto the fiber of T \u2217 M at y, and we call y an umbilic. The set of umbilics denoted by F1 is\ngenerically discrete, and thus does not contribute to Maslov index.\nIn the second case there are \u03bb, \u03bc \u2208 R \\ 0 such that\n\n\u2202X\n\u2202\u03c62\n\n\u2202X\n= \u03bb \u2202\u03c6\nand\n1\n\n\u2202P\n\u2202\u03c62\n\n\u2202P\n= \u03bc \u2202\u03c6\nat y.\n1\n\nIdentifying the off-diagonal terms of t BC, which is symmetric by property 2) of the Lemma,\n\u2202P\n\u2202X\n\u22a5 \u2202\u03c6\n(in the sense of the euclidean structure on T \u2217 M , since\nwe find that either \u03bb = \u03bc or \u2202\u03c6\n1\n1\n\nM is flat. ) But \u03bb 6= \u03bc since otherwise the complex matrices C \u00b1 iB would be degenerate,\n\u2202X\n\u2202X\nand \u2202\u03c6\nare colinear, and orthogonal to\nwhich violates property 3) of the Lemma. So \u2202\u03c6\n1\n2\n\u2202P\n\u2202P\nboth \u2202\u03c61 and \u2202\u03c62 .\nWe call y a cusp. The corresponding lagrangian singularity is generically the Whitney\ncrease A3 , and we denote the set of cusps by F0 .\n\nAssume now \u039b \u2282 \u03a3E where \u03a3E is a level set for an Hamiltonian of the form H =\n\u2202P\n\u2202X\np + V (x). Differentiating, we get 2hP, \u2202\u03c6\ni + h\u2207V, \u2202\u03c6\ni = 0 on \u039b at y, j = 1, 2, and since\nj\nj\n2\n\n\u03bb 6= \u03bc, these relations imply\n\n\u2202X\n\u2202\u03c6j\n\n\u22a5 \u2207V (X) and P \u22a5\n26\n\n\u2202P\n\u2202\u03c6j ,\n\nj = 1, 2. So if both C(y) and B(y)\n\n\fare of rank 1, the vectors P ,\n\u2202P\n\u2202\u03c62 .\n\n\u2202X\n\u2202\u03c61\n\nand\n\n\u2202X\n\u2202\u03c62\n\nare colinear, and all orthogonal to \u2207V ,\n\n\u2202P\n\u2202\u03c61\n\nand\n\nGenerically (i.e. without additionnal symmetries) the set F0 of such focal points y is\ndiscrete, or even empty, and like umbilics, do not contribute to Maslov index. The same\nargument applies if H = p2 g(x) (geodesic flow) or H = (p1 \u2212 x2 )2 + (p2 + x1 )2 + V (x). See\n\nhowever Sect.4 for the case of rotational symmetry.\n\nExample a.1: The harmonic oscillator H = p2 + V0 (x), V0 (x) = \u03c912 x21 + \u03c922 x22 . Although\nstandard action-angle variables are singular at energy E = 0, they are often best suited for\ndescribing the singularities at caustics. For all E > 0, there are 4 (hyperbolic) umbilics,\nlocated at the vertices of the caustics (a rectangle). For small energies E > 0, these umbilics\nare stable under perturbations of the form V (x) = V0 (x) + O(|x|3 ).\n\nExample a.2: The magnetic hamiltonian in R2 of the form HA = (p\u2212A(x))2 +V (x) (written in\n\nthe minimal coupling setting) with V as above, and A(x) = O(|x|2 ) near x = 0. Then umbilics\n(when A(x) \u2261 0) metamorphose into cusps, and singularities are precisely Whitney creases,\n\nsee [KaRo]. For more general magnetic hamiltonians in T \u2217 M , M = R3 , it is convenient\nto change the minimal coupling formulation, and introduce the non-degenerate (magnetic)\n2-form \u03c3B = \u03c3 \u2212 B(x) with B(x) = dA(x), which makes of T \u2217 M a new symplectic manifold.\nX\nWhen V (x) =\nVj (xj ), for smooth potentials Vj (xj ), it is easy to see that Ij = (pj \u2212\nj\n\n2\n\nAj (x)) + Vj (xj ) Poisson commute for \u03c3B , and thus can be chosen as action-variables.\n\nExample a.3: A radially symmetric metric H = g(|x|)p2 on an annulus 0 < r1 \u2264 r \u2264 r2 . In\ngeneral, the whole caustics lies in F0 (see again Sect.4). (This emphasizes the peculiarity of\n\nthe harmonic oscillator among integrable systems. )\n\nExample a.4: The geodesic flow on an ellipsoid is conformally equivalent, in the upper-half\nspace, to a Liouville metric H = g(x)p2 on a rectangle R =]0, T1 [\u00d7]0, T2 [. There are 4 umbilics\ngoing to the vertices of R, and the induced metric near an umbilic takes the form, in local\ncoordinates 1/g(x) = G(x21 ) \u2212 G(\u2212x22 ) = (x21 + x22 )A(x21 \u2212 x22 , 2x1 x2 ), where A(0, 0) > 0 (see\n[CdVVu,Sect.3] and references therein. )\nNow we can pass to Maslov theory and consider first the linear situation. Recall the real\nphase space T \u2217 Rd , in addition with its symplectic and euclidean structures, is endowed with\nthe complex structure J (p, x) = (\u2212x, p), ; we identify T \u2217 Rd with Cd and its zero section\nRdp \u2295 0 with the totally real subspace Rdp .\n\nLet L(2d) be the lagrangian grassmannian of T \u2217 Rd , we know that U (d) (the unitary\ngroup on Cd ) preserves all these structures and acts transitively on L(2d). We can identify\n\nL(2d) with U (d)/O(d), O(d) (the orthogonal group on Rd ) being the stabilizer of a given\nRd \u2248 \u039b \u2208 L(2d) under the action of U (d). Equivalently, if \u039b = U1 (Rd ) = U2 (Rd ) (with\n27\n\n\fthe identification above of the zero section, ) Uj \u2208 U (d), then U2 = U1 O, O \u2208 O(d). Since\ndet2 O = 1, det2 U1 = det2 U2 only depends on \u039b. The map det2 : U (d) \u2192 S1 induces\n\na fibration L(2d) \u2192 S1 , with 1-connected fiber SU (d)/SO(d), giving an isomorphism of\nfundamental groups : \u03c01 (L(2d)) \u2248 \u03c01 (S1 ) \u2248 Z. Passing to homology and dualizing, we obtain\na natural homomorphism : H 1 (S1 ; Z) \u2192 H 1 (L(2d); Z). The image \u03bc = \u03bcd of the canonical\ngenerator of H 1 (S1 ; Z) under this map is called the universal Maslov class. Explicitely, along\nthe path S1 \u2192 L(2d), t 7\u2192 \u039bt = Ut (Rd ), Ut \u2208 U (d), we have\n(a.3)\n\nd\u03bc(\u039bt ) = d\u03bct =\n\n1\nd(arg det Ut2 )\n2\u03c0\n\nConsider now the symplectic vector bundle \u03c0 : T \u2217 M \u2192 M over a manifold M , with a\nlagrangian subbundle \u039b \u2192 T \u2217 M . In general, the automorphism group of T \u2217 M does not act\n\ntransitively on the lagrangian subbundles, but a pair of transverse lagrangian subbundles can\nbe related as follows. Let \u03b9 : \u039b \u2192 T \u2217 M be a lagrangian immersion, then the symplectic\n\nvector bundle \u03b9\u2217 T (T \u2217 M ) over \u039b has 2 lagrangian subbundles L = \u03b9\u2217 T \u039b and L2 = \u03b9\u2217 V M (the\n\"vertical\" subbundle). The same consideration holds when replacing L2 by the zero-section L1\nof T \u2217 M . Maslov class \u03b1 = \u03bc\u039b,\u03b9 of (\u039b, \u03b9) is defined as \u03bc\u03b9,\u039b = \u03bc(L, L2 ) \u2208 H 1 (\u039b; Z), which is the\npull-back of the universal Maslov class \u03bc by Gauss map G : \u039b \u2192 L(2d), y 7\u2192 G(y) = \u03b9\u2217 Ty \u039b.\nFor y \u2208 \u039b, let U(y) be the unitary transform generating the lagrangian plane Ty \u039b.\n\nPossibly after changing d\u03bct into \u2212d\u03bct in (a.3) it is clear that, at least for d = 1, U 2 (y) is\ngiven globally by Cayley transformation\n(a.4)\n\nU 2 (y) = (C + iB)(C \u2212 iB)\u22121 (y),\n\nd=1\n\nExample a.5: In case \u039b is the product of d circles p2j + x2j = Ej parametrized by (pj , xj ) =\np\np\n( Ej sin \u03c6j , Ej cos \u03c6j ), (a.3) and (a.4) give by integration Maslov index \u03b1 = \u03bc(L, L2 ) =\n(2, * * * , 2).\nWe still show below how (a.4) holds \"at the infinitesimal level\" and allows to compute\nthe jump of Maslov index \u03bc(L, L2 ) \u2208 H 1 (\u039b, R) passing a caustics. See also [Ma2], [DoZh] for\n\nanother and more explicit derivation of \u03bc(L, L2 ).\nMoreover, from the discussion after Lemma a.1, the RHS of (a.4) equals (I +iBC \u22121 )(I \u2212\niBC \u22121 )\u22121 (y) when \u039b is transverse at y to L2 , and \u2212(I \u2212 iCB \u22121 )(I + iCB \u22121 )\u22121 (y) when \u039b is\ntransverse at y to L1 . Thus, because BC \u22121 (y) and CB \u22121 (y) are symmetric, except perhaps\non an exceptional set which we identified with F0 in the 2-d case, the RHS of (a.4) is well\ndefined as a unitary matrix acting on lagrangian planes, i.e. the fibers of T \u039b. So we are in the\nsituation of [H\u00f62,p.156], up to the sign in front of \u2212(I \u2212 iCB \u22121 )(I + iCB \u22121 )\u22121 (y), which we\n\nmay ignore if d is even (since only det U 2 (y) matters), or if we forget about orientation. So we\nwrite U 2 (y) = (I + iBC \u22121 )(I \u2212 iBC \u22121 )\u22121 (y) (resp. U 2 (y) = (I \u2212 iCB \u22121 )(I + iCB \u22121 )\u22121 (y).\n28\n\n\fFollowing [So] (see also [GuSt]) we shall identify these unitary matrices with the lagrangian planes on which they act, and introduce also the covering space Tf\u039b of T \u039b by\nadding a new (angular) variable \u03b8 which stands for arg det U. So in Te\u039b we have the freedom\ne t )0\u2264t\u22641 which are not tangent to \u039b,\nto consider a path of \"fictitious\" lagrangean planes (L\nexcept for t = 0, 1. A similar argument, consisting in interpolating between C + i \u03b5 B and\nC \u2212 i \u03b5 B, was used in [DoZh]. Now we argue as in [H\u00f62], and to start with, restrict to the\ncase where Cy0 has codimension 1 in \u039b and B(y) is of maximal rank d near y0 .\n\u0001\nConsider first a path \u03b31 (t), \u03b3\u03071 (t) \u2208 T \u039b, \u2212\u01eb0 \u2264 t \u2264 \u01eb0 , with \u03b3\u03071 (t) \u2208 T\u03b31 (t) \u039b = \u03c4 (t), and\nsuch that \u03b3\u03071 (0) belongs to the fiber. So in the terminology of [GuSt,p.120], \u03c4 (\u2212\u01eb0 ) and \u03c4 (\u01eb0 ),\n\nlie in different components of the projective lines LL2 (corresponding to the fiber L2 ) and\n\u0001\nLL2 (corresponding to the zero-section L1 ). We lift the path (\u03b31 , \u03b3\u03071 ) in Tf\u039b as (e\n\u03b31 , \u0117\n\u03b3 1 ). Then\nalong this path, B(y)|y=\u03b31 (t) is always invertible, and U 2 (y) = (I \u2212 iCB \u22121 )(I + iCB \u22121 )\u22121 (y).\nQ\nThe square of the determinant of Ut is j (1 \u2212 i\u03b2j (t))(1 + i\u03b2j (t))\u22121 where \u03b2j (t) are the real\neigenvalues of CB \u22121 . Since arg(1 \u2212 i\u03b2j (t)) = \u2212 arg(1 + i\u03b2j (t)) (we choose arg z so that it\nX\nR\n1\narg(1 \u2212 i\u03b2j (\u01eb0 )) \u2212 arg(1 \u2212 i\u03b2j (\u2212\u01eb0 )).\nd\u03bc\n=\nvanishes for z > 0) we get e\nt\n\u03c0\n\u03b31\nj\n\nChoose next a path (e\n\u03b32 (t), \u0117\n\u03b3 2 (t)) \u2208 Tf\u039b, with \u03b8 between arg det U(\u03b3(\u01eb0 )) and arg det\nU(\u03b3(\u2212\u01eb0 )), and whose projection starts at \u03c4 (\u01eb0 ) and ends at \u03c4 (\u2212\u01eb0 ). We use instead Ut2 (y) =\nQ\n(I +iBC \u22121 )(I \u2212iBC \u22121 )\u22121 (y). The square of the determinant of Ut is now j (1+i/\u03b2j (t))(1\u2212\nX\nR\narg(1 + i/\u03b2j (1)) \u2212 arg(1 \u2212 i/\u03b2j (0)). Since for real \u03b2 6= 0,\ni/\u03b2j (t))\u22121 , and e\n\u03bc = \u03c01\n\u03b32 t\nj\n\narg(1 \u2212 i\u03b2) \u2212 arg(1 + i/\u03b2)) = \u2212\u03c0/2 if \u03b2 > 0, = \u03c0/2 if \u03b2 < 0, we find :\nZ\nZ\nI\n\u0001\n\u0001\n1\n+\nd\u03bct =\nd\u03bct = sgn(BC \u22121 )(\u01eb0 ) \u2212 sgn(BC \u22121 )(\u2212\u01eb0 )\n2\ne\n\u03b31\ne\n\u03b32\nHere\n\nH\n\ndenotes the integral over the loop \u03b3\ne=\u03b3\ne1 \u2228 \u03b3\ne2 in Tf\u039b, and we have used that for t 6= 0,\n\nBC \u22121 and CB \u22121 are well defined and sgn BC \u22121 = \u2212 sgn CB \u22121 . This gives the required\nformula\n(a.6)\n\nhe\n\u03b3 , \u03b1i =\n\n\u0001\n1\nsgn(BC \u22121 )(\u01eb0 ) \u2212 sgn(BC \u22121 )(\u2212\u01eb0 )\n2\n\nWhen F0 is a discrete set it doesn't contribute to Maslov index, so formula (a.6) gives\n\ngenerically the jump of Maslov index passing a caustic. But in some cases as the radial\nsymmetric potentials in d = 2 considered in Sect.4, there are caustic sets where both B(y)\n\nand C(y) have rank 1, and the constructions above fail. The argument of [DoZh] covers most\nof these exceptional cases, but we can still adapt this one as follows.\nActually, since we can construct a subbundle transversal to both L2 = \u03b9\u2217 V M and L =\n\u03b9\u2217 T \u039b, we know that near any y0 = (p0 , x0 ) \u2208 \u039b, there is a local diffeomorphism \u03c7 (in the\n29\n\n\fvariable x alone), such that \u039b is parametrized by a non-degenerate phase function of the type\nS(p, x) = hp, xi + H(p), i.e. \u039b = {(p, x) : dp S(p, x) = 0, p \u2208 neigh(p0 )}. Moreover, H \u2032\u2032 (p) is\n\nsymmetric and invertible.\n\nExample a.6: Let \u039b \u2282 T \u2217 R be the circle y 2 +\u03b7 2 = 1, after the symplectic change of coordinates\ny = \u03c7(x) = ex \u2212 1, \u03b7 = t (\u03c7\u2032 (x))\u22121 \u03be = e\u2212x \u03be near (y, \u03b7) = (0, 1), \u039b rewrites as x = \u03be \u2212 1 +\n5\n6 (\u03be\n\n\u2212 1)3 + O((\u03be \u2212 1)4 ).\n\nWhen \u039b is of the form (P (\u03c6), X(\u03c6)), \u03c6 \u2208 T2 , one can locally use p as local coordinates,\n\u0001\u22121\nand make a symplectic transformation of the form (p, x) 7\u2192 (p+ (H \u2032\u2032 (p)\nx, x). The tangent\n\u0001\n\u22121\nspace to \u039b is of the form (\u03b4p \u2212 H \u2032\u2032 (p)\n\u03b4x, \u03b4x) so we are reduced to replace (C, B) above\n\u0001\u22121\n\u2032\u2032\nby (C, B \u2212 H (p)\nC)|p=P (\u03c6) , and so BC \u22121 by BC \u22121 \u2212 (H \u2032\u2032 )\u22121 . By (a.6)\nhe\n\u03b3 , \u03b1i =\n\n\u0001\n1\nsgn(BC \u22121 \u2212 (H \u2032\u2032 )\u22121 )(\u01eb0 ) \u2212 sgn(BC \u22121 \u2212 (H \u2032\u2032 )\u22121 )(\u2212\u01eb0 )\n2\n\nand as in [H\u00f62] this formula rewrites\n\u0012\n\u0013\n\u0012\n\u0013\n\u0001\n1\n\u2212H \u2032\u2032 (\u2212\u01eb0 )\nId\n\u2212H \u2032\u2032 (\u01eb0 )\nId\n(a.7)\nhe\n\u03b3 , \u03b1i = sgn\n\u2212 sgn\n\u22121\n\u22121\nId\n\u2212BC (\u2212\u01eb0 )\nId\n\u2212BC (\u01eb0 )\n2\n\nThis formula remains valid by continuity even if H \u2032\u2032 fails to be invertible, provided the\nmatrices are non singular, i.e. so long Ty(\u00b1\u01eb0 ) \u039b is tranverse to the fiber and zero-section of\nT \u2217M .\nB. The oscillating principal symbol and invariant densities.\nHere we review the construction of the principal symbol of asymptotic eigenfunctions\nof H, microlocalized on the invariant lagrangian manifold \u039b, parametrized (globally) by\n(p, x) = (P (\u03c6), X(\u03c6)), \u03c6 \u2208 Td . For a comprehensive treatment, in the framework of Fourier\n\nIntegral Operators calculus, we refer for instance the reader to the first Chapter of the book\n[Iv] by V.Ivrii which, together with the Lecture Notes [BaWe] by S.Bates and A.Weinstein,\nwe took as a first guide to this exposition. See also [DoZh].\nSo let H(x, hDx ) be the semi-classical quantization of H(p, x), \u03b9 : \u039b \u2192 T \u2217 M a lagrangian\nimmersion in H(p, x) = E ; we look for an approximate solution mod O(h2 ) of H(x, hDx )u =\n\nE(h)u with E(h) = E + O(h). For simplicity, we shall explicit the computations by assuming\nH(p, x) = p2 + V (x) so that H(x, hDx ) = \u2212h2 \u2206 + V (x) is a Schr\u00f6dinger operator, but\n\neverything carries over to more general h-PDO, as in the case of linear water waves with\ndispersion relation given by (4.10). For the moment however, we shall assume that H has no\nsub-principal symbol.\nNear x0 \u2208\n/ C, we try a solution of simple WKB type, of the form u(x, h) = a0 (x, E, h)\nRx\ni\u03c6(x)/h\ne\n, where \u03c6 solves Hamilton-Jacobi equation H(x, \u2207\u03c6(x)) = E, i.e. \u03c6(x) = x0 pdx, or\n30\n\n\fd\u03c6 = \u03b9\u2217 (pdx). This can be done so long \u039b is projectable. To determine a(x, h) = a0 (x, E) +\nha1 (x, E) + * * * we begin with the first transport equation\nX\n\n(b.2)\n\nj\n\n1\n\u03c6\u2032j (x)\u2202xj a0 (x, E) + \u2206\u03c6(x)a0 (x, E) = 0\n2\n\nwhich expresses that a20 \u03c0x\u2217 (XH ) (the x-projection of the Hamiltonian vector field of H) is\ndivergence-free for the canonical density |dx| on Rd , but which we write more invariantly as\nLXH |\u039b (a0 (x, E)|dx|1/2) = 0\n\n(b.3)\n\nHere LXH |\u039b denotes the Lie derivative acting on half-densities. As XH is tangent to \u039b, and\nthe Lie derivative invariant under diffeomorphism, this equation is satisfied iff the pull-back of\na0 (x, E)|dx|1/2 via the projection \u03c0 is invariant under the flow of XH . When the hamiltonian\nflow is quasi-periodic on \u039b, and y = (p, x) = (P 0 (\u03c6), X 0 (\u03c6)) it is readily seen that the\nsolutions of (b.3) are of the form\n(b.4)\n\na0 (x, E) = Const. | det\n\n\u2202X 0 \u22121/2\n|\n\u2202\u03c6\n\nNext we analyze the situation near a focal point y, and begin with the other extreme, i.e.\nrank d\u03c0p (y) = d. Near y, \u039b has a simple fold and the caustic is a line ; if d = 2, then\ny\u2208\n/ F0 where F0 was defined in (a.2). We make a h-Fourier transform, which takes formally\ne \u2212hDp ) = p2 + V (\u2212hDp ). The action is now \u03c8(p) =\nH(x, hDx ) = \u2212h2 \u2206 + V (x) to H(p,\nRp\n\u2212xdp, i.e. d\u03c8 = \u03b9\u2217 (\u2212xdp), and solves Hamilton-Jacobi equation p2 + V (\u2212\u2207\u03c8(p)) = E.\nSo we look for u(x, h) of the form\nZ\n\u2212d/2\nei(xp+\u03c8(p))/h b(p, E, h)dp\n(b.5)\nI(b, \u03c8)(x, h) = (2\u03c0h)\nand formally (H(x, hDx ) \u2212 E)u(x, h) =\n\nR\n\nei(xp+\u03c8(p))/h (p2 + V (x))b(p, E, h)dp. Using Ha-\n\nmilton-Jacobi equation, Taylor formula gives\np2 + V (x) \u2212 E =\n\n(b.6)\n\nX\n\n\u03bbj (x, p, E)(xj + \u2202pj \u03c8(p))\n\nj\n\nwhere \u03bbj (x, p, E) are smooth functions near x+\u2202p \u03c8(p) = 0, and because we work near a simple\nfold, we can assume, possibly after a rearrangement of coordinates, that \u03bb1 |x+\u2202p \u03c8(p)=0 6= 0.\nWe look for a symbol b(p, E, h) = b0 (p, E) + hb1 (p, E) + * * * such that there are amplitudes\n(j)\n\n(j)\n\na(j) (x, p, E, h) = a0 (x, p, E) + ha1 (x, p, E) + * * * verifying\n(b.7)\n\nei(xp+\u03c8(p))/h (p2 + V (x) \u2212 E)b(p, E, h) =\n31\n\nX\nj\n\nhDpj ei(xp+\u03c8(p))/h a(j) (x, p, E, h)\n\n\u0001\n\n\fAt zeroth and first order in h, we find respectively\n(p2 + V (x) \u2212 E)b0 (p, E) =\n(b.8)\n2\n\n(p + V (x) \u2212 E)b1 (p, E) =\n\nX\n\n(j)\n\n(xj + \u2202pj \u03c8(p))a0 (x, p, E)\n\nj\n\nX\n\n(xj +\n\n(j)\n\u2202pj \u03c8(p))a1 (x, p, E) +\n\nj\n\n(j)\n\n1 \u2202a0\ni \u2202pj\n\n(j)\n\nThe first equation (b.8) yields a0 (x, p, E) = b0 (p, E)\u03bbj (x, p, E) and the second one can be\nsolved iff\n(b.9)\n\nX\n\n\u03bbj (\u2212\u2202p \u03c8(p), p)\n\nj\n\n\u2202\u03bbj\n\u2202b0\n(p) +\n(\u2212\u2202p \u03c8(p), p)b0(p) = 0\n\u2202pj\n\u2202pj\n\nwhere we have dropped parameter E from the notations. Taking derivative of (b.6) with\nrespect to xk yields\n(b.10)\n\n\u2202xk V (x) =\n\nX\n\n\u2202xk \u03bbj (x, p, E)(xj + \u2202pj \u03c8(p)) + \u03bbk (x, p, E)\n\nj\n\nand evaluating at x + \u2202p (\u03c8) = 0,\n(b.11)\n\n\u03bbk (\u2212\u2202p \u03c8, p) = \u2202xk V (\u2212\u2202p \u03c8)\n\nWe differentiate again (b.10) with respect to xl , and evaluate at x + \u2202\u03c8 (p) = 0, so we get :\n(b.13)\n\n\u2202xk \u03bbl (\u2212\u2202p \u03c8, p) + \u2202xl \u03bbk (\u2212\u2202p \u03c8, p) =\n\n\u2202 2V\n(\u2212\u2202p \u03c8)\n\u2202xk \u2202xl\n\nAt last, we take derivative of (b.10) with respect to pl , and evaluate at k = l, x + \u2202p (\u03c8) = 0,\nto obtain :\nX\n\u2202 2\u03c8\n\u2202xk \u03bbj (\u2212\u2202p \u03c8, p)\n0 = \u2202pk \u03bbk (\u2212\u2202p \u03c8, p) +\n(p)\n\u2202pk \u2202pj\nj\nso summing over k and using (b.13) gives\n0 = \u2202pk \u03bbk (\u2212\u2202p \u03c8, p) +\n\nX \u2202 2\u03c8\n\u22022V\n(p)\n(\u2212\u2202p \u03c8)\n\u2202pk \u2202pj\n\u2202xk \u2202xj\nj,k\n\nwhich we insert into (b.9) and using (b.11) we get again :\n(b.14)\n\n\u0002X \u2202 2 \u03c8\n\u2202b0\n1 X \u2202 2\u03c8 \u2202 2V \u0003\n\u2202 2V\n1 X \u2202V\nb0 (p) = 0\n(\u2212\u2202p \u03c8)\n(p) \u2212\n+\n2 j \u2202xj\n\u2202pj\n\u2202pk \u2202pj \u2202xk \u2202xj\n2\n\u2202p2k \u2202x2k\nk\n\nj<k\n\n32\n\n\fThis can be compared with (b.2) and again be written in an invariant form as\n(b.15)\n\nLXH |\u039b (b0 (p, E)|dp|1/2) = 0\n\n\u2202V\n(x0 ) 6= 0, this transport equation can be solved with arbitrary initial condition at p =\nSince \u2202x\n1\np0 . Again, since XH is tangent to \u039b, and the Lie derivative invariant under diffeomorphism,\nthis equation holds iff the pullback of b0 (p, E)|dp|1/2 via the projection \u03c0p is invariant under\n\nthe flow of XH . (Here, given a lagrangian immersion \u03b9 : \u039b \u2192 T \u2217 M , identifying locally T \u2217 M\nwith Rd(x,p) , we denote by \u03c0p the projection on Rdp . )\nOnce we have determined b0 (p, E), we can solve the first equation (b.8), and so (b.7)\nholds up to first order terms in h. Introducing a cutoff in (b.5) around p0 , and integrating\n(b.7) over p in the neighborhood of p0 , we find (H(x, hDx ) \u2212 E)u(x, E, h) = O(h2 ).\nNow we pass to the general situation where rank d\u03c0x (y0 ) \u2264 d \u2212 1 and d\u03c0p (y0 ) \u2264 d \u2212 1.\n\nThen \u039b can have a more complicated singularity, e.g. a Whitney crease at y0 \u2208 F0 when\nd = 2, or a critical point of the moment map (which we have excluded in our special problem,\nbut occurs when looking for instance at the critical energy of an harmonic oscillator, see\ne.g. [KaRo], or more general critical points [Vu], [CdVVu], . . . . ) From now on we drop for\nsimplicity energy parameter E, and remember that everything could depend on one or several\nparameters.\nRecall from the discussion before Example a.6 that \u039b can be parametrized nar y0 by a\nnon-degenerate phase function S(p, x) = hp, xi+H(p). More generally \u039b can be parametrized\nby a Morse function. By this we mean a smooth function S(x, \u03b8), defined near (x0 , \u03b80 ) \u2208\n\nRd \u00d7Rl (for some l which is not necessarily the number d of phase variables, but we can choose\nl \u2264 d) with p0 = dS(x0 , \u03b80 ), d(x,\u03b8) S(x0 , \u03b80 ) 6= 0, and dS\u03b8\u2032 1 * * * , dS\u03b8\u2032 l linearly independant on\nthe critical set CS = {(x, \u03b8) \u2208 Rd \u00d7 Rl : d\u03b8 S = 0}, such that the lagrangian immersions\n\u03b9 : \u039b \u2192 T \u2217 M and \u03b9S : CS \u2192 T \u2217 M , (x, \u03b8) 7\u2192 (x, dx S(x, \u03b8)) have the same image near (x0 , p0 ),\nwhich we identify naturally with \u039b. We set \u03a3S = {(x, dx S(x, \u03b8)) : (x, \u03b8) \u2208 CS } \u2282 \u039b. Such a\n\nphase S(x, \u03b8) satisfies det d2(x,\u03b8) S 6= 0, and we set d2(x,\u03b8) S(x, \u03b8) = S \u2032\u2032 (x, \u03b8) (all derivatives). For\nan amplitude with compact support a(x, \u03b8, h), we define as in (b.5) the lagrangian distribution\nZ\n\u2212l/2\neiS(x,\u03b8)/h a(x, \u03b8, h)d\u03b8\n(b.17)\nI(a, S)(x, h) = (2\u03c0h)\nand consider the h-Fourier transformation\nFh I(a, S)(\u03be, h) = (2\u03c0h)\n\n\u2212(d+l)/2\n\nZ Z\n\nei(S(x,\u03b8)\u2212x\u03be)/h a(x, \u03b8, h)dxd\u03b8\n\nFor \u03be near p0 we may expand Fh I(a, S)(\u03be, h) by stationary phase, since the critical point\n(x(\u03be), \u03b8(\u03be)), with (x(\u03be0 ), \u03b8(\u03be0 )) = (x0 , \u03b80 ) is non degenerate. The critical value equals\n(b.18)\n\n\u03a6S (\u03be) = S(x(\u03be), \u03b8(\u03be)) \u2212 x(\u03be)\u03be\n33\n\n\fand we find :\n(b.19)\n\nFh I(a, S)(\u03be, h) = ei\u03a6S (\u03be)/h | det S \u2032\u2032 |\u22121/2 ei\u03c0(sgn S\n\n\u2032\u2032\n\n)/4\n\na0 (x(\u03be), \u03b8(\u03be)) + O(h)\n\n\u0001\n\nIt is also well known that Fh I(a, S)(\u03be, h) does only depends on \u039b near (x0 , p0 ) and not on\ne\ne \u03b8)\nthe particular choice of S realizing the embedding \u03b9 : \u039b \u2192 T \u2217 M . More precisely, if S(x,\ne 0 , \u03b8e0 ), there exists an amplitude\nis another phase function as above, such that p0 = dx S(x\n\ne\ne\na(x, \u03b8, h) such that formally (i.e. microlocally near (x0 , p0 ), ) I(a, S)(x, h) = I(e\na, S)(x,\nh).\nThe convenient framework to express this invariance is described in term of the frequency set,\nsee [GuSt], [Iv], . . . but we can (roughly) understand this by thinking of an equality between\n\nasymptotic sums in h, or even at the first order in h. See e.g. [BaWe,Theorem 4.18] for a\nproof of equivalence among the Morse family ; from this follows actually Darboux-Weinstein\nTheorem, that we recalled in Sect.1. We also call S(x, \u03b8) a non-degenerate phase function in\nthe sense of H\u00f6rmander.\nChoose \u03be = (\u03be1 , * * * , \u03bed ) as local coordinates on \u039b and define a half density in the local\n\u221a\ncharts (CS , \u03b9S ) near (x0 , p0 ) by \u03b4S = | det S \u2032\u2032 |\u22121/2 |d\u03be|1/2 . We notice that if I(a, S)(x, h) \u2261\ne\nI(e\na, S)(x,\nh) microlocally near (x0 , p0 ), then\nq\np\n\u2032\u2032\n\u2032\u2032\ni\u03a6 (\u03be)/h\n(b.22)\ne Se\ne\na0 x(\u03be), \u03b8(\u03be) \u03b4Se = ei\u03a6S (\u03be)/h a0 ei\u03c0(sgn S \u2212sgn Se )/4 \u03b4S\n\nLet \u039bS = \u03b9S (CS ) \u2282 \u039b be the image of the chart (CS , \u03b9S ). The (oscillating) principal symbol\nof u in \u039bS is then defined as\n(b.23)\n\nei\u03a6S (\u03be)/h A0 (\u03be) = ei\u03a6S (\u03be)/h ei\u03c0 sgn S\n\n\u2032\u2032\n\n/4\n\na0 x(\u03be), \u03b8(\u03be)\n\n\u0001p\n\n\u03b4S\n\nTo determine the principal symbol a0 (x(\u03be), \u03b8(\u03be)), we proceed essentially as above, computing\nH(x, hDx ) u(x, h) by inverse Fourier transform. So if the lagrangian distribution u has\n(oscillating) principal symbol ei\u03a6S (\u03be)/h A0 (\u03be), then H(x, hDx ))u(x, h), which can be computed\nas in (b.14), has (oscillating) principal symbol ei\u03a6S (\u03be)/h 1i LXH |\u039b A0 (\u03be). (See [DuH\u00f6] for the\ncase of a classical PDO, and also [Iv] that takes care of specific details relative to the semiclassical framework. ) To have H(x, hDx )u(x, h) = 0 mod O(h2 ), it suffices to solve\n\n(b.25)\n\n1\nei\u03a6S (\u03be)/h LXH |\u039b A0 (\u03be)|d\u03be|1/2 = 0\ni\n\nand still in the case where \u039b is an integral manifold of H, this equation is satisfied whenever\nthe pullback of the half-density A0 (\u03be) in the chart (CS , \u03b9S ) is invariant under the flow of XH .\nLet us summarize our review in the :\nTheorem b.1: Let \u039b as above be an integral manifold of H(p, x) in energy surface H(p, x) =\nE. Assume H(p, x) = p2 + V (x) so that H(x, hDx ) = \u2212h2 \u2206 + V (x), or else H(x, hDx , h)\n34\n\n\fis the h-Weyl quantization of a symbol of the form H(x, p, h) = H(p, x) + h2 H(p, x) (i.e.\nwithout subprincipal symbol H1 (p, x). ) Then near any y0 = (p0 , x0 ) \u2208 \u039b there is a local chart\n\u221a\n(CS , \u03b9S ) and a half density \u03b4S as above such that the lagrangian distribution u in (b.17) with\n(oscillating) principal part ei\u03a6S (\u03be)/h A0 (\u03be) given by (b.23) solves (H(x, hDx , h) \u2212 E)u(x, h) =\nO(h2 ).\nIn particular, let y \u2208 \u039b be such that rank d\u03c0|\u039b (y) = k \u2264 d \u2212 1 is locally constant,\n\nthen because \u039b is lagrangian, there is a partition of variables (possibly after renumerotation\nof coordinates) x = (x1 , x2 ) \u2208 Rk \u00d7 Rd\u2212k , and p = (p1 , p2 ) \u2208 Rk \u00d7 Rd\u2212k , such that rank\nde\n\u03c0 = d, where \u03c0\ne : \u039b \u2192 Rd , (x, p) 7\u2192 (x1 , p2 ). Then it is well known that u(x, h) in (b.17) can\n\nbe rewritten in the same form with \u03b8 replaced by p2 and S\u25e6\u03b9\u22121 \u25e6e\n\u03c0 (x1 , p2 ) = T (x1 , p2 )+hx2 , p2 i.\nIn particular, near y,\n(b.27)\n\n\u039b = \u039bT = {(x, p) : x2 = \u2212\n\n\u2202T\n\u2202T\n(x1 , p2 ), p1 =\n(x1 , p2 )}\n\u2202p2\n\u2202x1\n\nand the number l of phase variables can be reduced to d \u2212 k. We interprete T (x1 , p2 ) as a\npartial Legendre transformation of \u03c6(x) or \u03c8(p). See [Iv,Prop.1.2.5], [DoZh], . . . If we content\ncomputing Maslov indices, one could restrain to such phase functions as we shall explain\nbelow.\nNow we want to extend the previous procedure to more general h-PDO's, in particular\nfor (Weyl quantization of) H(x, hDx , h) = H0 (x, hDx ) + hH1 (x, hDx ) + * * *, in this case\n\u03c3H (x, p) = H1 (x, p) is called the sub-principal symbol of H. Of course, we need not assume\nthe particular form \u2212h2 \u2206 + V (x) for H0 . When H(x, hDx , h) is the Weyl quantization of\nsymbol H(x, p) = H0 (x, p)+hH1 (x, p)+* * *, then \u03c3H (x, p) = H1 (x, p), and there are formulas\n\nrelating subprincipal symbols for different quantizations, see e.g. [Iv]. Note that the subprincipal symbol, together with the principal symbol, are invariantly defined.\n\nNow if u is a lagrangian distribution as above, then in the chart (CS , \u03b9S ), the distribution\nH(x, hDx , h)u(x, h) has (oscillating) principal symbol\nei\u03a6S (\u03be)/h\nand again equation\n(b.29)\n\n1\nL\ni XH0\n\n\u039b\n\n\u0001\n1\nLXH0 |\u039b + \u03c3H (x(\u03be), p(\u03be) A0 (\u03be)\ni\n\u0001\n+ \u03c3H (x(\u03be), p(\u03be)) A0 (\u03be)|d\u03be|1/2 = 0\n\ncan be solved along the integral curves of XH0 |\u039b . Where \u039b is projectable on M , we can take\nx as local coordinates on \u039b, and this equation takes the form\n\u0001\n1 X \u2202H0\n\u2202 2\n|\u039b\nA0 (x) + \u03c3H |\u039b A20 (x) = 0\n2i j \u2202pj \u2202xj\n35\n\n\fbut near a simple fold, it can be computed as in (b.14), and more generally using the procedure\nleading to Theorem b.1. This gives on \u039b :\n(b.30)\n\n\u0002\n\u2202\u03be \u22121/2\n|\nexp \u2212i\nA0 (\u03be) = Const. | det\n\u2202\u03c6\n\nZ\n\nt\n\n\u03c3H (p(\u03be)x(\u03be))ds\n\n\u0003\n\nAssume now that \u039b is a torus with quasi-periodic flow of frequencies \u03c9 satisfying some\ndiophantine condition we give (b.30) a simpler form. Namely expand \u03c3H (p(\u03be), x(\u03be))\u25e6(\u03c9s+\u03c6)\nRt\nas a Fourier series, and integrate term by term which gives\n\u03c3H (p(\u03be), x(\u03be)) \u25e6 (\u03c9s + \u03c6)ds =\nh\u03c3H it + G(\u03c6), where G is a smooth periodic function on the torus, satisfying hGi = 0, and\nh\u03c3H i, again, is the spatial average of \u03c3H over \u039b. Of course, this is also the time average over\nthe almost periodic orbit. In (b.30) we can factor out the periodic part, which is the same\n\nas the solution of (b.25), multiplied by e\u2212iG(\u03c6) . This will give the invariant density (since its\nLiouville class is zero. ) The other factor, e\u2212ih\u03c3H it is multivalued. So far we rewrite (b.30) as\n(b.31)\n\nA0 (\u03be(\u03c9t + \u03c6)) = Const. | det\n\n\u2202\u03be \u22121/2\n|\nexp[\u2212iG(\u03c9t + \u03c6)] exp[\u2212ih\u03c3H it]\n\u2202\u03c6\n\nThis expression is computed along the integral curves of XH0 ; of course it assumes a particularly simple form when \u03c3H i = 0.\nC. Maslov quantization condition for a lagragian immersion of the torus.\nAt last we investigate the global properties of the lagrangian distribution u(x, h) we have\nso far constructed locally. Choose \u03be = (\u03be1 , * * * , \u03bed ) as local coordinates on \u039b and define a half\ndensity in the local charts (CS , \u03b9S ) near (p0 , x0 ) by \u03b4S = | det S \u2032\u2032 |\u22121 |d\u03be|. We notice that if\ne\nI(a, S)(x, h) = I(e\na, S)(x,\nh) microlocally near (p0 , x0 ), then\ni\u03a6 (\u03be)/h\n\nS\ne e\n\n(c.1)\n\ne\na0\n\nq\n\n\u03b4Se = ei\u03a6S (\u03be)/h a0\n\np\n\n\u03b4S ei\u03c0(sgn S\n\n\u2032\u2032\n\ne\u2032\u2032 )/4\n\u2212sgn S\n\nLet \u039bS = \u03b9S (CS ) be the image of the chart (CS , \u03b9S ). We denote by \u03a91/2 the bundle of half\u0001\n\u2032\u2032\n\u2032\u2032\ndensities on \u039b with transition functions exp i\u03c0 sgn S(x,\u03b8),(x,\u03b8)\n\u2212 sgn S(x\n\u2032 ,\u03b8),(x\u2032 ,\u03b8) /4 for change\nof coordinates x 7\u2192 x\u2032 in \u039bS . We denote also by L Maslov bundle on \u039b with transition\nfunctions exp i\u03c0(sgn S \u2032\u2032 \u2212 sgn Se\u2032\u2032 )/4 for changes of function S in \u039bS \u2229 \u039bSe. With I(a, S) we\nassociate the section of \u03a91/2 \u2297 L of the form\nei\u03a6S (\u03be)/h A0 (\u03be) = ei\u03a6S (\u03be)/h ei\u03c0 sgn S\n\n(c.2)\n\n\u2032\u2032\n\n/4\n\na0 x(\u03be), \u03b8(\u03be)\n\n\u0001p\n\n\u03b4S\n\nby a partition of unity subordinated to the covering of \u039b by the local charts \u039bS .\nMaslov canonical operator is defined as the inverse Fourier transform which to any section\nA(\u03be, h) of \u03a91/2 \u2297 L as in (c.2), assigns a lagrangian distribution u(x, h). We call\n\ni\u03a6S (\u03be)/h\n\ne\n\n36\n\n\fei\u03a6S (\u03be)/h A(\u03be, h) the (oscillating) principal symbol of u. The interesting case is when \u039b is\na compact manifold. Namely, if the open sets \u039bS cover \u039b, then the functions \u03a6S,Se(\u03be) =\ne 0 , \u03b8 \u2032 ), for \u03b9S (x0 , \u03b80 ) = \u03b9 (x0 , \u03b8 \u2032 ) = (x0 , p0 ) \u2208 \u039bS \u2229 \u039b , are\n\u03a6S (\u03be) \u2212 \u03a6Se(\u03be) = S(x0 , \u03b80 ) \u2212 S(x\n0\n0\ne\ne\nS\nS\nnecessarily constant on \u039bS \u2229 \u039bSe, defining an element \u03a6 \u2208 H 1 (\u039b; R). Actually, by De Rham\nisomorphism, \u03a6 \u2248 \u03b9\u2217 (pdx). In the same way, if the covering \u039bS is sufficiently smooth, the\n\u2032\u2032\n\u2032\u2032\ntransition functions \u03c3S,Se = ei\u03c0(sgn S \u2212sgn Se )/4 are constant on \u039bS \u2229 \u039bSe, defining an element\n\u03b1 \u2208 H 1 (\u039b; Z), and \u03b1 = \u03bc(L, L2 ) is Maslov class of (\u039b, \u03b9). Of course, these transition functions\nare nothing but those we computed in Part B. Maslov quantization condition expresses the\nfact that\n(\u03a6S (\u03be) \u2212 \u03a6Se(\u03be))/h \u2261 \u03c0(sgn S \u2032\u2032 \u2212 sgn Se\u2032\u2032 )/4 mod 2\u03c0 on \u039bS \u2229 \u039bSe\n\nwhich we write as a condition on \u03a91/2 \u2297 L :\n\n\u03a6/(2\u03c0h) + \u03b1/4 = 0 mod H 1 (\u039b; Z)\n\n(c.3)\n\nThe values of h satisfying (c.3) are generally of the form h1 = an + b, n \u2208 Z, and Maslov\nindex \u03b1 = (2, * * * , 2) for a torus. Global topological properties of 2-d tori are considered in\n[O-de-AlHa]. In particular, we can have \u03b1 = (2, 0) in 2-d.\nAt last, we point out how to correct Maslov quantization condition when H has a subprincipal symbol, and the frequencies of the torus are diophantine. In (b.31) e\u2212ih\u03c3H it is\nmultivalued, and contributes to Maslov condition by a constant term. So in case of a subprincipal symbol, we need to modify (c.3) as :\n(c.4)\n\n\u03a6/(2\u03c0h) + \u03b1/4 + h\u03c3H i(1, * * * , 1) = 0 mod H 1 (\u039b; Z)\n\nThis situation is of course well-known, and related to the sub-principal form for an integrable\nsystem (see [Vu] and references therein. )\nReferences\n[Ar] V.Arnold 1. On a characteristic class entering into conditions of quantization. Funct.\nAnal. Appl. 1, p.1-13, 1967. 2. M\u00e9thodes math\u00e9matiques de la M\u00e9canique classique.\nEditions Mir, Moscou, 1976. 3. Geometrical methods in the theory of ordinary differential\nequations. Springer, 1983.\n[Au] M. Audin. Les syst\u00e8mes hamiltoniens et leur int\u00e9grabilit\u00e9. Soc. Math de France, Cours\nSp\u00e9cialis\u00e9s (8), 2001.\n[BNe] I.Babenko, N.Nekhoroshev. On complex structures on 2-d tori admitting metrics with\nnontrivial quadratic integral. Math. Notes, 58(5) p.1129-1135, 1995.\n37\n\n\f[BaWe] S.Bates, A.Weinstein. Lectures on the geometry of quantization. Berkeley Math.\nLect. Notes 88, American Math. Soc. 1997.\n[BeDoMa] V.Belov, S.Dobrokhotov, V.Maksimov. Explicit formulas for generalized actionangle variables in a neighborhood of an isotropic torus and their applications. Theor. Math.\nPhys., 135(3),p.765-791, 2003.\n[Ch] S.Chandrasekhar. The mathematical theory of black holes. International Series of\nMonographs on Physics, 69. The Clarendon Press, Oxford University Press, New York, 1983.\n[CdV] Y.Colin de Verdi\u00e8re, 1. Modes et quasi-modes sur les vari\u00e9t\u00e9s riemanniennes. Inventiones Math. 43, p.15-52, 1977. 2. M\u00e9thode de moyennisation en M\u00e9canique semi-classsique.\nJourn\u00e9es Equations aux D\u00e9riv\u00e9es partielles, Expos\u00e9 No 5, Saint Jean de Monts, 1996.\n[CdVVu] Y.Colin de Verdi\u00e8re, S.Vu Ngoc. Singular Bohr-Sommerfeld rules for 2-d integrable\nsystems. Annales Scient. Ecole Normale Sup\u00e9rieure, 2003.\n[deG] M.de Gosson. Symplectic Geometry and Quantum Mechanics. Operator Theory Advances and Applications, Birkh\u00e4user, 2006.\n[DoZh] S.Dobrokhotov, A.Shafarevich. \"Momentum\" tunneling between tori and the splitting\nof eigenvalues of the Laplace-Beltrami operator on Liouville surfaces. Math. Phys. Anal.\nGeometry 2, p.141-177, 1999.\n[DoZh] S.Dobrokhotov, P.Zhevandrov. Asymptotic expansions and the Maslov canonical\noperator in the linear theory of water waves I. Russian J. Math. Phys. Vol.10 (1), p.1-31,\n2003.\n[DuFoNo] B. Dubrovin, A.Fomenko, S.Novikov. Modern Geometry-Methods and applications. Vol. I, II, III. Springer, 1985.\n[Dui] J.J. Duistermaat. 1. Oscillatory integrals, Lagrange immersions and unfolding of\nsingularities. Comm. Pure Appl. Math. 27, p.207-281, 1974. 2. Fourier Integral Operators,\nBirkh\u00e4user, Boston, 1995. 3. On the Morse index in variational calculus. Adv. Math. 21,\np.173-195, 1976.\n[EasMat] M.Eastwood, V.M.Matveev. Metric connexions in projective geometry. Preprint.\n[FedMas] M.V.Fedoriuk, V.P.Maslov. Semi-classical approximation in Quantum Mechanics.\nD.Reidel, 1981.\n[Fo] A.Fomenko. Integrability and non-integrability in Geometry and Mechanics. Kluwer\nAcad. Publ. 1988.\n[GuSt] V.Guillemin, S.Sternberg. Geometric asymptotics. American Math. Soc. Surveys,\n14, Providence, Rhode Island, 1977.\n[H\u00e4] D.H\u00e4fner. Creation of fermions by rotating black holes. Preprint arXiv:math.AP/061\n2501v1\n[HeSj] B. Helffer, J. Sj\u00f6strand. R\u00e9sonances en limite semi-classique. Bull. Soc. Math. France\n38\n\n\f114(3), M\u00e9moire No 24/25, 1986.\n[HieGrDoRa] J.Hietarinta, B.Grammaticos, D.Dorizzi, A.Ramani. Phys. Rev. Lett. V.53,\n1707, 1984.\n[HiSjVu] M.Hitrik, J.Sj\u00f6strand, S.Vu-Ngoc. Diophantine tori and spectral asymptotics for\nnon-self adjoint operators.\n[H\u00f6] L.H\u00f6rmander 1. The Analysis of Linear Partial Differential Operators, III. SpringerVerlag, Berlin, 1985. 2. Fourier Integral Operators I. Acta Math. 127, p.79-183, 1971.\n[Iv] V.Ivrii. Microlocal analysis and precise spectral asymptotics. Springer-Verlag, Berlin,\n1998.\n[KaRo] N.Kaidi, M.Rouleux. Quasi-invariant tori and semi-excited states for Schr\u00f6dinger\noperators I. Asymptotics. Comm. Part. Diff. Eq. 27, p.1695-1750, 2002.\n[KMS] D.V.Kosygin, A.A.Minasov, Ya.G.Sinai, Statistical properties of the spectra of the\nLaplace-Beltrami operators on Liouville surfaces, Russ. Math. Surv. Vol. 48, no. 4, p. 1-142,\n1993.\n[Laz] V.Lazutkin. KAM theory and semi-classical approximation to eigenfunctions. Springer,\n1993.\n[Le] J.Leray. Analyse lagrangiennne et M\u00e9canique Quantique. S\u00e9minaire EDP Coll\u00e8ge de\nFrance, 1976-77.\n[Li] R.G. Littlejohn. Semiclassical trace formulas. J. Math. Phys. 31(12), p.2952-2977, 1990.\n[Ma] V.P.Maslov. 1. Th\u00e9orie des perturbations et m\u00e9thodes asymptotiques. Dunod, Paris,\n1972. 2. Operational Methods. Moscow: Mir Publ. 1973.\n[Mat] V.S.Matveev. The asymptotic eigenfunctions of the operator \u2207D(x, y)\u2207 corresponding\nto Liouville metrics and waves on water captured by bottom irregularities. Math. Notes,\n64(3), p.357-363, 1998.\n[MatTo] V.S.Matveev, A.Topalov. 1. Quantum integrability... Math. Zeitschrift, 238(4),\np.833-860, 2001. 2. Geometric equivalence... Geom. Dedicata, 96, p.91-115, 2003.\n[MeSj] A.Melin, J.Sj\u00f6strand. Fourier integral operators with complex valued phase functions.\nSpringer Lect. Notes in Math. 459, p.120-223, 1974.\n[Mi] H.Mineur. R\u00e9duction des syst\u00e8mes m\u00e9caniques . . . J. Math. Pures Appl., 15, p.385-389,\n1936.\n[O-de-AlHa] A.M. Ozorio de Almeida, J. H. Hannay. Geometry of 2-d tori in phase space :\nprojections, sections and the Wigner function. Ann. Phys. 138, p.115-154, 1982\n[Po] G.Popov. Invariant tori, effective stability, and quasi-modes with exponentially small\nerror terms. 1. Birkhoff normal forms, Ann. Henri Poincar\u00e9 1, p.223-248, 2000. 2. Quantum\nBirkhoff normal forms, Ann. Henri Poincar\u00e9 1, p.249-279, 2000.\n[Se] E.Selivanova. Orbital isomorphisms of Liouville systems on a 2-d torus. Mat. Sbornik\n39\n\n\f186(10), p.141-160, 1995.\n[So] J.M.Souriau, Construction explicite de l'indice de Maslov. Applications, in: Group\ntheoretical methods in Physics, Nijmegen. Lect. Notes in Physics 50, Springer, 1976.\n[Ts] A.Tsiganov. The Maupertuis principle and canonical transformations of the extended\nphase space. J. Nonlinear Math. Phys. 8(1), p.157-182, 2001.\n[Vu] S.Vu Ngoc. Bohr-Sommerfeld conditions for integrable systems with critical manifolds\nof focus-focus type. Comm. Pure Appl. Math.,53(2), p.143-217, 2000.\n[We] A.Weinstein. 1. On Maslov quantization condition, in: Fourier Integral Operators\nand Partial Differential Equations. J.Chazarain, ed. Lecture Notes in Math. 469, Springer,\np.361-372, 1974. 2. Symplectic manifolds and their lagrangian submanifolds, Adv. Math. 6,\np.329-346, 1971.\n[Ze] S.Zelditch. The inverse spectral problem for surfaces of revolution. J. Differential Geom.\n49, p.207-264, 1998.\n\n40\n\n\f"}