{"id": "http://arxiv.org/abs/hep-ph/0407117v3", "guidislink": true, "updated": "2005-07-14T15:49:27Z", "updated_parsed": [2005, 7, 14, 15, 49, 27, 3, 195, 0], "published": "2004-07-09T15:47:00Z", "published_parsed": [2004, 7, 9, 15, 47, 0, 4, 191, 0], "title": "Statistical hadronization and hadronic microcanonical ensemble II", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=hep-ph%2F0607064%2Chep-ph%2F0607294%2Chep-ph%2F0607202%2Chep-ph%2F0607010%2Chep-ph%2F0607026%2Chep-ph%2F0607232%2Chep-ph%2F0607099%2Chep-ph%2F0607207%2Chep-ph%2F0607182%2Chep-ph%2F0607011%2Chep-ph%2F0607218%2Chep-ph%2F0607019%2Chep-ph%2F0607200%2Chep-ph%2F0607032%2Chep-ph%2F0607121%2Chep-ph%2F0607142%2Chep-ph%2F0607181%2Chep-ph%2F0607176%2Chep-ph%2F0607006%2Chep-ph%2F0607311%2Chep-ph%2F0607039%2Chep-ph%2F0607175%2Chep-ph%2F0607340%2Chep-ph%2F0607302%2Chep-ph%2F0607236%2Chep-ph%2F0607073%2Chep-ph%2F0607003%2Chep-ph%2F0407260%2Chep-ph%2F0407041%2Chep-ph%2F0407312%2Chep-ph%2F0407347%2Chep-ph%2F0407068%2Chep-ph%2F0407363%2Chep-ph%2F0407325%2Chep-ph%2F0407253%2Chep-ph%2F0407333%2Chep-ph%2F0407354%2Chep-ph%2F0407209%2Chep-ph%2F0407280%2Chep-ph%2F0407094%2Chep-ph%2F0407369%2Chep-ph%2F0407020%2Chep-ph%2F0407066%2Chep-ph%2F0407083%2Chep-ph%2F0407071%2Chep-ph%2F0407026%2Chep-ph%2F0407109%2Chep-ph%2F0407231%2Chep-ph%2F0407133%2Chep-ph%2F0407117%2Chep-ph%2F0407352%2Chep-ph%2F0407221%2Chep-ph%2F0407153%2Chep-ph%2F0407170%2Chep-ph%2F0407275%2Chep-ph%2F0407234%2Chep-ph%2F0407298%2Chep-ph%2F0407160%2Chep-ph%2F0407322%2Chep-ph%2F0407050%2Chep-ph%2F0407065%2Chep-ph%2F0407035%2Chep-ph%2F0407250%2Chep-ph%2F0407158%2Chep-ph%2F0407193%2Chep-ph%2F0407156%2Chep-ph%2F0407355%2Chep-ph%2F0407236%2Chep-ph%2F0407087%2Chep-ph%2F0407123%2Chep-ph%2F0407288%2Chep-ph%2F0407077%2Chep-ph%2F0407267%2Chep-ph%2F0407142%2Chep-ph%2F0407180%2Chep-ph%2F0407165%2Chep-ph%2F0407336%2Chep-ph%2F0407371%2Chep-ph%2F0407059%2Chep-ph%2F0407296%2Chep-ph%2F0407149%2Chep-ph%2F0407358%2Chep-ph%2F0407076%2Chep-ph%2F0407226%2Chep-ph%2F0407056%2Chep-ph%2F0407139%2Chep-ph%2F0407150%2Chep-ph%2F0407085%2Chep-ph%2F0407282%2Chep-ph%2F0407154%2Chep-ph%2F0407188%2Chep-ph%2F0407302%2Chep-ph%2F0407018%2Chep-ph%2F0407306%2Chep-ph%2F0407033%2Chep-ph%2F0407161%2Chep-ph%2F0407039%2Chep-ph%2F0407121%2Chep-ph%2F0407348%2Chep-ph%2F0407084%2Chep-ph%2F0407196&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Statistical hadronization and hadronic microcanonical ensemble II"}, "summary": "We present a Monte-Carlo calculation of the microcanonical ensemble of the of\nthe ideal hadron-resonance gas including all known states up to a mass of about\n1.8 GeV and full quantum statistics. The microcanonical average multiplicities\nof the various hadron species are found to converge to the canonical ones for\nmoderately low values of the total energy, around 8 GeV, thus bearing out\nprevious analyses of hadronic multiplicities in the canonical ensemble. The\nmain numerical computing method is an importance sampling Monte-Carlo algorithm\nusing the product of Poisson distributions to generate multi-hadronic channels.\nIt is shown that the use of this multi-Poisson distribution allows an efficient\nand fast computation of averages, which can be further improved in the limit of\nvery large clusters. We have also studied the fitness of a previously proposed\ncomputing method, based on the Metropolis Monte-Carlo algorithm, for event\ngeneration in the statistical hadronization model. We find that the use of the\nmulti-Poisson distribution as proposal matrix dramatically improves the\ncomputation performance. However, due to the correlation of subsequent samples,\nthis method proves to be generally less robust and effective than the\nimportance sampling method.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=hep-ph%2F0607064%2Chep-ph%2F0607294%2Chep-ph%2F0607202%2Chep-ph%2F0607010%2Chep-ph%2F0607026%2Chep-ph%2F0607232%2Chep-ph%2F0607099%2Chep-ph%2F0607207%2Chep-ph%2F0607182%2Chep-ph%2F0607011%2Chep-ph%2F0607218%2Chep-ph%2F0607019%2Chep-ph%2F0607200%2Chep-ph%2F0607032%2Chep-ph%2F0607121%2Chep-ph%2F0607142%2Chep-ph%2F0607181%2Chep-ph%2F0607176%2Chep-ph%2F0607006%2Chep-ph%2F0607311%2Chep-ph%2F0607039%2Chep-ph%2F0607175%2Chep-ph%2F0607340%2Chep-ph%2F0607302%2Chep-ph%2F0607236%2Chep-ph%2F0607073%2Chep-ph%2F0607003%2Chep-ph%2F0407260%2Chep-ph%2F0407041%2Chep-ph%2F0407312%2Chep-ph%2F0407347%2Chep-ph%2F0407068%2Chep-ph%2F0407363%2Chep-ph%2F0407325%2Chep-ph%2F0407253%2Chep-ph%2F0407333%2Chep-ph%2F0407354%2Chep-ph%2F0407209%2Chep-ph%2F0407280%2Chep-ph%2F0407094%2Chep-ph%2F0407369%2Chep-ph%2F0407020%2Chep-ph%2F0407066%2Chep-ph%2F0407083%2Chep-ph%2F0407071%2Chep-ph%2F0407026%2Chep-ph%2F0407109%2Chep-ph%2F0407231%2Chep-ph%2F0407133%2Chep-ph%2F0407117%2Chep-ph%2F0407352%2Chep-ph%2F0407221%2Chep-ph%2F0407153%2Chep-ph%2F0407170%2Chep-ph%2F0407275%2Chep-ph%2F0407234%2Chep-ph%2F0407298%2Chep-ph%2F0407160%2Chep-ph%2F0407322%2Chep-ph%2F0407050%2Chep-ph%2F0407065%2Chep-ph%2F0407035%2Chep-ph%2F0407250%2Chep-ph%2F0407158%2Chep-ph%2F0407193%2Chep-ph%2F0407156%2Chep-ph%2F0407355%2Chep-ph%2F0407236%2Chep-ph%2F0407087%2Chep-ph%2F0407123%2Chep-ph%2F0407288%2Chep-ph%2F0407077%2Chep-ph%2F0407267%2Chep-ph%2F0407142%2Chep-ph%2F0407180%2Chep-ph%2F0407165%2Chep-ph%2F0407336%2Chep-ph%2F0407371%2Chep-ph%2F0407059%2Chep-ph%2F0407296%2Chep-ph%2F0407149%2Chep-ph%2F0407358%2Chep-ph%2F0407076%2Chep-ph%2F0407226%2Chep-ph%2F0407056%2Chep-ph%2F0407139%2Chep-ph%2F0407150%2Chep-ph%2F0407085%2Chep-ph%2F0407282%2Chep-ph%2F0407154%2Chep-ph%2F0407188%2Chep-ph%2F0407302%2Chep-ph%2F0407018%2Chep-ph%2F0407306%2Chep-ph%2F0407033%2Chep-ph%2F0407161%2Chep-ph%2F0407039%2Chep-ph%2F0407121%2Chep-ph%2F0407348%2Chep-ph%2F0407084%2Chep-ph%2F0407196&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a Monte-Carlo calculation of the microcanonical ensemble of the of\nthe ideal hadron-resonance gas including all known states up to a mass of about\n1.8 GeV and full quantum statistics. The microcanonical average multiplicities\nof the various hadron species are found to converge to the canonical ones for\nmoderately low values of the total energy, around 8 GeV, thus bearing out\nprevious analyses of hadronic multiplicities in the canonical ensemble. The\nmain numerical computing method is an importance sampling Monte-Carlo algorithm\nusing the product of Poisson distributions to generate multi-hadronic channels.\nIt is shown that the use of this multi-Poisson distribution allows an efficient\nand fast computation of averages, which can be further improved in the limit of\nvery large clusters. We have also studied the fitness of a previously proposed\ncomputing method, based on the Metropolis Monte-Carlo algorithm, for event\ngeneration in the statistical hadronization model. We find that the use of the\nmulti-Poisson distribution as proposal matrix dramatically improves the\ncomputation performance. However, due to the correlation of subsequent samples,\nthis method proves to be generally less robust and effective than the\nimportance sampling method."}, "authors": ["F. Becattini", "L. Ferroni"], "author_detail": {"name": "L. Ferroni"}, "author": "L. Ferroni", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1140/epjc/s2004-02027-8", "rel": "related", "type": "text/html"}, {"title": "doi", "href": "http://dx.doi.org/10.1140/epjc/s10052-010-1243-4", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/hep-ph/0407117v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/hep-ph/0407117v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "23 pages, 21 figures, style files attached. Published version, minor\n  corrections", "arxiv_primary_category": {"term": "hep-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "hep-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/hep-ph/0407117v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/hep-ph/0407117v3", "journal_reference": "Eur.Phys.J.C38:225-246,2004; Erratum-ibid.66:341,2010", "doi": "10.1140/epjc/s2004-02027-8 10.1140/epjc/s10052-010-1243-4", "fulltext": "Statistical hadronization and hadronic microcanonical ensemble\nII\n\narXiv:hep-ph/0407117v3 14 Jul 2005\n\nF. Becattini1 and L. Ferroni1\nUniversit\u00e0 di Firenze and INFN Sezione di Firenze\n\nAbstract. We present a Monte-Carlo calculation of the microcanonical ensemble of the of the ideal hadronresonance gas including all known states up to a mass of about 1.8 GeV and full quantum statistics.\nThe microcanonical average multiplicities of the various hadron species are found to converge to the\ncanonical ones for moderately low values of the total energy, around 8 GeV, thus bearing out previous\nanalyses of hadronic multiplicities in the canonical ensemble. The main numerical computing method is\nan importance sampling Monte-Carlo algorithm using the product of Poisson distributions to generate\nmulti-hadronic channels. It is shown that the use of this multi-Poisson distribution allows an efficient and\nfast computation of averages, which can be further improved in the limit of very large clusters. We have\nalso studied the fitness of a previously proposed computing method, based on the Metropolis Monte-Carlo\nalgorithm, for event generation in the statistical hadronization model. We find that the use of the multiPoisson distribution as proposal matrix dramatically improves the computation performance. However,\ndue to the correlation of subsequent samples, this method proves to be generally less robust and effective\nthan the importance sampling method.\nPACS. PACS-key discribing text of that key \u2013 PACS-key discribing text of that key\n\n1 Introduction\n\nhadronization model and test observables which cannot be calculated analytically.\n2.\nThe\nassessment of the validity of previous calculations\nThe basic assumption of the statistical hadronization model\nin the canonical ensemble, especially in the analysis of\n(SHM) is that, as a consequence of a dynamical QCDaverage multiplicities in high energy elementary collidriven process, the final stage of a high energy collision\nsions [4,5,6].\ngives rise to the formation a set of colourless massive\nextended objects, defined as clusters (or fireballs). They\nThe first point is quite clear: if we could compute\nare assumed to produce hadrons in a purely statistical microcanonical averages numerically in a practical way,\nmanner, namely all multihadronic states within the clus- we would be able to make predictions on many observter volume and compatible with its quantum numbers are ables within the basic framework of the statistical model\nequally likely. The set of equiprobable states with fixed without invoking further assumptions or approximations\nfour-momentum and internal charges (abelian or not) is which are needed to obtain analytical expressions. Furterwhat is usually called the microcanonical ensemble 1 . In- more, the availability of a Monte-Carlo integration algoteractions between stable hadrons are mostly taken into rithm opens the way to event generators with hadronizaaccount by the inclusion of all resonances as independent tion stage modelled by SHM. The second point is somestates [1], which is the reason of the usual expression, in how related to the first. Indeed, in previous work within\nthe SHM, of ideal hadron-resonance gas [2].\nSHM, specific assumptions were invoked in order to alThe special motivations for a detailed study of the mi- low the use of the canonical ensemble, which is far easier\ncrocanonical ensemble of the ideal hadron-resonance gas to handle with regard to both analytical and numerical\nhave been extensively discussed in the first paper [3]. They calculations. It is then necessary to verify whether it was\ncan be shortly summarized as:\nsound to calculate multiplicities in the canonical ensemble\nby comparing them to those in the microcanonical ensem1. The need of a tool to hadronize final-state clusters\nble with the same values of total mass and volume.\nin particle and heavy ion collisions in the statistical\nThe microcanonical formalism for the hadron gas and\n1\nThe full microcanonical ensemble should in principle in- the relation between microcanonical and canonical ensemclude angular momentum and parity conservation. In this bles have been developed in the first paper [3]. In this\nwork, as well as in previous literature, angular momentum and paper we will focus on the numerical analysis; we will disparity are disregarded and the resulting set of states are still cuss the main computational issues and we will describe\ndefined as microcanonical ensemble.\ntwo algorithms to sample the microcanonical hadron gas\n\n\f2\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nphase space. As has been mentioned above, we will inspect the differences between microcanonical and canonical averages. In this first study, we will only deal with\nobservables pertaining to particle multiplicities, leaving\nthe analysis of momentum spectra to further works.\nThe microcanonical ensemble of the hadron gas has\nbeen investigated numerically by K. Werner and J. Aichelin [7] by using a Monte-Carlo method based on Metropolis algorithm. Results on specific observables have recently\nbeen published [8] in a hadron gas model including fundamental multiplets (two meson nonets and baryon octet\nplus decaplet). In comparison with these previous works,\nwe will show calculations for the full hadron gas including all known species (more than 250) up to a mass of\nabout 1.8 GeV and, particularly, we will introduce a new\nupdating rule for Metropolis algorithm leading to a dramatic improvement of its performance in terms of computing time. Moreover, we propose a different Monte-Carlo\ncomputing method, based on the importance sampling of\nmulti-hadronic channel space, which proves to be more\neffective than Metropolis algorithm for the calculation of\naverages.\nThe paper is organized as follows: the basic microcanonical formalism is summarized in Sect. 2; the numerical method to compute the phase space volumes for a given\nmulti-hadronic channel is discussed in Sect. 3; in Sect. 4\nwe describe the importance sampling method which is well\nsuited to compute averages in the microcanonical ensemble of the ideal hadron-resonance gas; in Sect. 5 we show\nthe comparison between microcanonical and canonical averages; in Sect. 6 and 7 the Metropolis algorithm is studied\nin detail; finally, conclusions are summarized in Sect. 8.\n\n2 Microcanonical partition function\nIn principle, any average on a given statistical mechanics ensemble could be calculated from the partition function. The microcanonical partition function of the hadron\ngas is best defined [3] as the sum over all multihadronic\nstates localized within the cluster |hV i constrained with\nfour-momentum and abelian (i.e. additive) charge conservation:\nX\n(1)\nhhV |\u03b4 4 (P \u2212 Pop )\u03b4Q,Qop |hV i\n\u03a9=\nhV\n\nwhere Q = (Q1 , . . . , QM ) is a vector of M integer abelian\ncharges (electric, baryon number, strangeness etc.), P the\nfour-momentum of the cluster and Pop , Qop the relevant\noperators. Provided that relativistic quantum field effects\nare neglected and the volume of the cluster is large enough\nto allow the approximation of finite-volume Fourier integrals with Dirac deltas, it can be proved [3] that \u03a9 can be\nwritten as a multiple integral:\nZ\nZ +\u03c0\n1\n4\n\u0131P *y\nd ye\ndM \u03c6 e\u0131Q*\u03c6\n\u03a9=\n(2\u03c0)4+M\n\u2212\u03c0\ni\nh X (2J + 1)VZ\nj\n3\n\u2212\u0131pj *y\u2212\u0131qj *\u03c6 \u00b11\n(2)\nd\np\nlog(1\n\u00b1\ne\n)\n\u00d7 exp\n(2\u03c0)3\nj\n\nwhere qj is the vector of the abelian charges for the j th\nhadron species, Jj its spin, V the volume of the cluster; the\nupper sign applies to fermions, the lower to bosons. The integral (2) is more easily calculable in the rest frame of the\ncluster where P = (M, 0). Unfortunately, an analytical\nsolution with no charge constraint (the so-called grandmicrocanonical partition function) is known only in two\nlimiting cases: non-relativistic and ultra-relativistic (i.e.\nwith all particle masses set to zero). The full relativistic\ncase has been attacked with several kinds of expansions\n[9] but none of them proved to be fully satisfactory as\nthe achieved accuracy in the estimation of different kinds\nof averages could vary from some percent to a factor 10.\nTherefore, a numerical integration of Eq. (2) is needed.\nThe most suitable method is to decompose \u03a9 into the\nsum of the phase space volumes with fixed particle multiplicities for each species:\n\u03a9=\n\nX\n\n{Nj }\n\n(3)\n\n\u03a9{Nj } \u03b4Q,P j Nj qj\n\n{Nj } being a vector of K integer numbers (N1 , . . . , NK ),\ni.e. the multiplicities of all of the K hadronic species. The\nset of integers {Nj } is also defined as a channel because it\ncharacterizes a specific decay channel of the cluster. The\ngeneral phase space volume \u03a9{Nj } for the channel {Nj }\nobtained from can be written as a cluster decomposition.\nLet j be the integer index running over all hadron species,\nand {hnj } a partition (relevant to the species j) of Nj in\nthe multiplicity representation, i.e. a set of integers such\nPN\nPN\nthat Nj = njj=1 nj hnj ; let Hj = njj=1 hnj and let clj\nbe the cyclic permutations of the first nlj integers deterPHj\nnlj = Nj . Provided\nmined by the partition, with lj =1\nthat relativistic quantum field effects are neglected (which\nis possible if the cluster linear size is greater than pion\nCompton wavelength, 1.4 fm), the phase space volume for\nfixed multiplicities reads [3]:\n\u03a9{Nj } =\n\u00d7\n\nZ\n\nd3 p1 . . . d3 pN \u03b4 4 (P \u2212 Pf )\n\nHj\nY X (\u22131)Nj +Hj (2Jj + 1)Hj Y\nFnlj\nQNj\nhn j\nhnj !\nj {hnj }\nlj =1\nnj =1 nj\n\n(4)\n\nwhere Pf is the sum of all particle four-momenta. The\nfactors Fnlj in the equation above are Fourier integrals\nover the cluster region with proper volume V :\nn\n\nFnlj =\n\nlj\nY\n\nilj\n\n1\n(2\u03c0)3\n=1\n\nZ\n\nd3 x e\n\n\u0131x*(pil \u2212pcl\nj\n\nj\n\n(il ) )\nj\n\n(5)\n\nV\n\nand the p's are the particle momenta. For sufficiently large\nV , the integral in Eq. (5) tends to a product of Dirac delta\ndistribution and, if we use this limit in Eq. (4), we arrive\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nat this expression of \u03a9{Nj } :\n\"\nY X\n(\u22131)Nj +Hj Q\n\u03a9{Nj } =\nj {hnj }\n\nZ\nHj\nhY\nV (2Jj + 1)\nd3 p\u2032lj\n(2\u03c0)3\nlj =1\n\n1\n\nNj\nnj =1\n\n#\ni\n\n4hnj\n\nnj\n\nhnj !\n\n\u03b4 4 (P \u2212\n\nHj\nX\n\np\u2032lj ) (6)\n\nj,lj =1\n\nwhere, for a set of partitions {hn1 }, . . . , {hnK } for each\nof the hadron species, the four-momenta p\u2032lj are those of\nlumps of particles of the same species j (Hj in number)\nwith mass nj mj and spin Jj .\nFor sufficiently large volumes, the leading term in Eq.\nc\n(6), henceforth defined as \u03a9{N\n, is that with the maximal\nj}\npower of V , i.e. with Hj = Nj \u2200j. This term corresponds\nto the partitions {hnj } = (Nj , 0, . . .) \u2200j, namely to one\nparticle per lump, and reads:\nc\n\u03a9{N\n=\nj}\nN\nX\nY V Nj (2Jj + 1)Nj Z\n3\n3\n4\nd p1 . . . d pN \u03b4 (P \u2212\npi )(7)\n=\n(2\u03c0)3Nj Nj !\ni=1\nj\n\nP\nwhere N = j Nj . This is indeed the phase space volume in the classical Boltzmann statistics. Therefore, the\nterms beyond the leading one (7) in the expansions (4)\nand (6) account for the quantum statistics effects. The\nvery same expression (7) holds as the leading term of the\nmore general cluster decomposition (4). In fact, the cyclic\npermutations clj corresponding to the partition {hnj } =\n(Nj , 0, . . .) are identities, thus implying, according to Eq.\n(5):\nNj\nY\nV Nj\nFnlj =\n(8)\n(2\u03c0)3Nj\n\nAs has been mentioned in the introduction, in this paper we are mainly interested in the calculation of quantities relevant to particle multiplicities and not to their\nmomenta, namely their kinematical state. The average of\nan observable O depending on particle multiplicities in the\nmicrocanonical ensemble can then be written as:\nP\nP\n{Nj } O({Nj })\u03a9{Nj } \u03b4Q, j Nj qj\nP\n(10)\nhOi =\nP\n{Nj } \u03a9{Nj } \u03b4Q, j Nj qj\n\nAltogether, what we need to calculate in order to evaluate\nan average (10) are integrals like (6) and (7). The description of a suitable numerical technique to do that is the\nsubject of next section.\n\n3 Numerical calculation of the phase space\nvolume\nIn order to calculate efficiently and quickly the phase space\nvolume for fixed multiplicities \u03a9{Nj } in Eq. (6), we have\nadopted a Monte-Carlo integration method proposed by\nCerulus and Hagedorn in the 60's [9,10] and later employed by Werner and Aichelin [7]. The method is described in detail in ref. [7]. As we made only slight modifications, we just sketch it here; a more detailed description\nis given in Appendix A. As has already been mentioned,\nevery term in the cluster decomposition (6) is an integral\nof the kind (7) and can be calculated by the same numerical method.\nThe calculation is carried out in the cluster's rest frame,\nwhere P = (M, 0) and V is the proper volume. The integral (7) is first written as the product:\nV N T 3N \u22124 Y (2Jj + 1)Nj\n\u03a6(M, m1 , . . . , mN )\n(2\u03c0)3N\nNj !\nj\n\nc\n\u03a9{N\n=\nj}\n\nlj =1\n\nIn the present work, we have used the approximated expression (6) of Eq. (4) to evaluate the phase space volume\nfor fixed multiplicities. For the considered cluster masses\nand volumes (see later on) this approximation is satisfactory for most observables, taking into account that the\nleading term (7) of the cluster decomposition is the same\nin both Eq. (4) and (6) and that subleading terms give at\nmost a 10% correction to the leading term.\nA nice feature of the cluster decomposition (6) is that\nevery term of the expansion is an integral just like the\nclassical phase space volume (7) with lumps replacing particles. Specifically, the Eq. (6) can be rewritten as:\n\"\n#\nY (\u22131)Nj +Hj\nX\nc\n\u03a9{Nj } =\n\u03a9{H\n(9)\nQ Nj\nj}\n4hnj\nn\nj\n{hn1 },...,{hnK }\nnj =1 j\nQN\nNote that the factor njj=1 hnj ! has been absorbed in\nc\n\u03a9{H\nas it takes into account the identity of the lumps.\nj}\nThis form of the cluster decomposition shows that in actual numerical calculations all of the terms can be computed with the same routine.\n\n3\n\n(11)\nwhere T = M \u2212 i=1 mi is the available total kinetic\nenergy for the N particles (or lumps), and \u03a6 is an adimensional kinematic integral:\nPN\n\n\u03a6=\n\n1\nT 3N \u22124\n\nZ\n\nd3 p1 . . . d3 pN \u03b4 4 (P \u2212\n\nN\nX\n\npi )\n\n(12)\n\ni=1\n\nAfter a sequence of variable changes, the function \u03a6 is\nrewritten as an integral of an adimensional function \u03a5 of\nN \u2212 1 variables ri \u2208 [0, 1] (see Appendix A):\n\u03a6=\n\nZ\n\n0\n\n1\n\ndr1 . . .\n\nZ\n\n1\n\ndrN \u22121 \u03a5 (r1 , . . . , rN \u22121 )\n\n(13)\n\n0\n\nwhich can be estimated through Monte-Carlo integration\nas:\nNS\n. 1 X\n(k)\n(k)\n\u03a5 (r1 , . . . , rN \u22121 )\n(14)\n\u03a6=\nNS\nk=1\n\n(k)\n\nwhere ri are random numbers uniformely distributed in\nthe interval [0, 1] and NS is the number of samples.\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\ndN/d\u03a9\n\n600\n500\n\n\u03c00\u03c00\u03c0+\u03c0Resolution=4.7%\n\n\u03c00\u03c00\u03c0+\u03c0+\u03c0-\u03c0Resolution=4.8%\n\n\u03b7\u03b7\u03b7\u03b7\nResolution=2.7%\n\nCPU time (sec.)\n\n4\n\n400\n300\n200\n\nQuantum statistics\nClassical statistics\n\n10\n\n1\n\n100\n\ndN/d\u03a9\n\n0\n600\n500\n\n\u03c0\u03c0\u03c0\u03c0\nResolution=4.8%\n0 0 + -\n\n\u03c0 \u03c0 \u03c0 \u03c0 \u03c0\u03c0\nResolution=5.3%\n0 0 + + - -\n\n\u03b7\u03b7\u03b7\u03b7\nResolution=2.9%\n\n10\n\n-1\n\n400\n\n10\n\n300\n\n-2\n\n200\n100\n\n10\n\n0\n2500\n\n3000\n\n3500 800\n2\nx 10\n\n1000\n\n1200\n3\nx 10\n\n6000\n\n7000\n\n-3\n\n4\n\n\u03a9\n\n6\n\n8\n\n10\n\n12\n\n14\n\n16\n\n18\n\n20\n\nN\n\nFig. 1. Distribution of \u03a9{Nj } values computed with a numerical Monte-Carlo integration based on 1000 random samples, along with gaussian fits, for a cluster of 4 GeV mass\nand 0.4 GeV/fm3 energy density. Three channels are shown:\n(a) \u03c0 0 , \u03c0 0 , \u03c0 + , \u03c0 \u2212 ; (b) \u03c0 0 , \u03c0 0 , \u03c0 + , \u03c0 + , \u03c0 \u2212 , \u03c0 \u2212 ; (c) \u03b7, \u03b7, \u03b7, \u03b7. Top\nplots refer to the full quantum statistics calculation while those\nbelow to the classical statistics approximation.\n\nFig. 2. CPU time needed to calculate the phase space volume of a channel with N neutral pions in a cluster with mass\nN (m\u03c00 + 500 MeV) and energy density 0.4 GeV/fm3 . The full\ndots refer to classical statistics and the hollow dots to full quantum statistics; lines are drawn to guide the eye. The CPU time\nhas been normalized to a Pentium IV processor with 2 GHz\nclock rate.\n\nIn order to calculate the full cluster decomposition of\nthe phase space volume, in Eq. (9), the above calculation\nis repeated for all of the terms. To reduce the number of\ncalls to the random number generation subroutine, one\ncan take advantage of rewriting Eq. (9) as:\n#\n\"\nY (\u22131)Nj +Hj (2Jj + 1)Hj\nX\n\u03a9{Nj } =\nQNj\n4hnj\nhnj !\nj\n{hn1 },...,{hnK }\nnj =1 nj\n\ntained by repeating 10000 times the calculation of \u03a9{Nj }\nfor three different channels in a cluster with 4 GeV mass\nand 0.4 GeV/fm3 energy density. 2 The plots on the top\nrow refer to the \u03a9{Nj } value calculated in full quantum\nstatistics, according to Eq. (6), and those on the bottom\nrow in classical statistics, i.e. retaining only the leading\nterm (7). It can be seen that the central values in full quantum statistics are higher than their classical approximations, as expected for channels involving identical bosons.\nThe calculation in full quantum statistics with the exact\nexpression (4) for finite volume yields results very close to\nthose obtained with the approximated one (6). The spread\nin value of the statistical error (see resolutions quoted in\nfig. 1) is owing to the different multiplicities and masses\nof the particles in the channels. However, this spread is\nfairly small and stays well below an order of magnitude\nso that, in fact, a fixed number of Monte-Carlo samples\nNS is appropriate to calculate most \u03a9{Nj } 's with a given\naccuracy independently of particle content.\n\n\u00d7\n\nV H T 3H\u22124\n\u03a6(M, \u03bc1 , . . . , \u03bcH )\n(2\u03c0)3H\n\n(15)\n\nwhere \u03bci are meant to be the masses\nPof the lumps defined\nby the partitions {hnj } and H = j Hj . Since H \u2264 N ,\nthe first H \u2212 1 random numbers, out of N \u2212 1 extracted,\ncan be used to estimate the \u03a6 integral, according to Eq.\n(14), for each term in Eq. (15).\nFor NS = 1000 random samples, the accuracy of the\nMonte-Carlo integration is satisfactory for all channels\nand turns out to be of the order of some percent. This\nmay not be sufficient if one is interested in accurate calculations of single channel rates themselves, but is very\ngood for the estimate of other, more inclusive, averages\nsuch as mean multiplicities, multiplicity distributions etc.,\nin which the errors on different channels add incoherently\n(see Eq. (10)) and the relative statistical error is therefore\ngreatly reduced with respect to that on the single term\n\u03a9{Nj } . In fig. 1 we show the gaussian distributions ob-\n\n2\n\nHenceforth energy density must be understood as that in\nthe cluster's rest frame, that is the ratio between mass and\nproper volume M/V . The standard value of 0.4 GeV/fm3 has\nbeen chosen and used throughout this paper as it corresponds,\nin the thermodynamical limit, to the energy density of a hadron\ngas at a temperature of about 160 MeV, which has been determined in previous analyses of particle production in high\nenergy collisions [11].\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n4 Importance sampling of microcanonical\nensemble\nAs has been discussed previously, our goal is to develop a\nfast and accurate numerical method to calculate averages\nlike (10) in the microcanonical ensemble. Being able to effectively calculate \u03a9{Nj } for any channel, a brute force option is to do it for all of them. However, this method is not\nappropriate for a system like the hadron gas, because the\nactual number of channels is huge. Indeed, with 271 lightflavoured hadrons and resonances (those included in the\nlatest Particle Data Book issue [12]), the number of channels allowed by energy-momentum conservation is enormous and it increases almost exponentially with cluster\nmass (see fig. 3), involving an unacceptably large computing time. For instance, the CPU time needed to compute\n\u03a9{Nj } for all of the 23 millions of channels of a cluster with\n4 GeV mass is around 400 hours. Charge constraints can\nindeed reduce significantly the number of allowed channels, yet not enough. Therefore, the calculation of the\nphase space volume of all allowed channels is possible only\nfor very light clusters, in practice lighter than \u2248 2 GeV.\nHence, if a method based on the exhaustive exploration\nof the channel space is not affordable, one has to resort\nto Monte-Carlo methods, whereby the channel space is\nrandomly sampled.\nAn estimate of the average (10) can be made by means\nof the so-called importance sampling method. The idea of\nthis method is to sample the channel space (i.e. the set of\nintegers Nj , one for each hadron species) not uniformely,\nrather according to an auxiliary distribution \u03a0{Nj } which\nmust be suitable to being sampled very efficiently to keep\ncomputing time low, and, at the same time, as similar as\npossible to the distribution \u03a9{Nj } . The latter requirement\nis dictated by the fact that \u03a9{Nj } is sizeable over a very\nsmall portion of the whole channel space. Hence, if random configurations were generated uniformely, for almost\n3\nAll CPU times quoted throughout are referred to a personal\ncomputer with Pentium IV processor working at 2 GHz clock\nrate, with rated SPECint=426 and SPECfp=304\n\n10 10\n10 9\n10 8\n\nNumber of channels\n\nThe actual CPU time3 needed for the calculation of\n\u03a9{Nj } with 1000 random samples is reasonably small. This\nis shown in fig. 2 for channels with N neutral pions in a\ncluster with mass N (m\u03c00 + 500 MeV) and energy density\n0.4 GeV/fm3 . In a full quantum statistics calculation, including lumps up to 5 particles, the CPU time is much\nlarger because of the extra terms in the cluster decomposition. The time needed to calculate the integral (7) increases almost exponentially with the number of particles\nN at low N , whereas at N = 11 it features a drop due to\na switch in the numerical method (see Appendix A) and\nflattens out thereafter. In quantum statistics, even at high\nN , there are many phase space integrals in the cluster decomposition to be calculated with the same method as for\nthe classical terms at low N , thus the CPU time steadily\nincreases, though not as steeply as for the classical term\nalone.\n\n5\n\n10 7\n10 6\n10 5\n10 4\n10 3\n10 2\n1\n\n2\n\n3\n\n4\n\n5\n\nM (GeV)\nFig. 3. Number of allowed channels as a function of cluster\nmass in a hadron gas with 271 species and free charges.\n\nall of them \u03a9{Nj } would have a negligible value, thus a\nhuge number of samples would be required to achieve a\ngood accuracy. On the other hand, if samples are drawn\naccording to a distribution similar to \u03a9{Nj } , little time is\nwasted to explore unimportant regions and the estimation\nof the average (10) is more accurate. A crucial requirement\nfor \u03a0{Nj } is not to be vanishing or far smaller than \u03a9{Nj }\nanywhere in its domain in order not to exclude some good\nregions from being sampled, thereby biasing the calculated\naverages in a finite statistics calculation.\nRewriting Eq. (10) as:\nP\n\n{Nj }\n\nhOi =\n\nP\n\nO({Nj })\n{Nj }\n\n\u03a9{Nj }\n\u03a0{Nj } \u03b4Q,P j Nj qj\n\u03a0{Nj }\n\n\u03a9{Nj }\n\u03a0{Nj } \u03b4Q,P j Nj qj\n\u03a0{Nj }\n\n(16)\n\nmakes it apparent that a Monte-Carlo estimate of hOi is:\n(k)\n\n.\nhOi =\n\nPM\n\n(k)\n)\nk=1 O({Nj }\n\n(k)\n\n\u03a0{Nj }\n\n(k)\n\nPM\n\nk=1\n\n(k)\n\n\u03a9{Nj }\n\n\u03a9{Nj }\n\n(17)\n\n(k)\n\n\u03a0{Nj }\n\nwhere {Nj } are samples of the channel space extracted\naccording to thePdistribution \u03a0 and fulfilling the charge\nconstraint Q = j Nj qj .\nProvided that M is large enough so that the distributions of both numerator and denominator in Eq. (17) are\ngaussians (hence the conditions of validity of the central\n\n\f6\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nlimit thoerem are met), the statistical error \u03c3hOi on the\naverage hOi can be estimated as (see Appendix B):\n#\n(\"\n!\n2\n\u03a9\n1\n{N\n}\n2\nj\n2\nE\u03a0 O 2 2\n\u2212 hOi \u03a9 2\n=\n\u03c3hOi\nM \u03a92\n\u03a0{Nj }\n#\n!\n\"\n2\n\u03a9{N\n2\nj}\n2\n\u2212\u03a9\n+ hOi E\u03a0\n2\n\u03a0{N\nj}\n\"\n!\n#)\n2\n\u03a9{N\nj}\n\u2212 2hOi E\u03a0 O 2\n\u2212 hOi\u03a9 2\n(18)\n\u03a0{Nj }\nwhere E\u03a0 stands for the expectation value relevant to the\n\u03a0 distribution. If \u03a9{Nj } = \u03a0{Nj } , the above expression\nreduces to the familiar form:\n\u0011\n1 \u0010 2\n2\n2\n(19)\nhO i \u2212 hOi\n=\n\u03c3hOi\nM\nThe estimator (17) has a bias unless \u03a9{Nj } = \u03a0{Nj } and\nthis confirms the necessity to find a distribution as similar\nas possible to \u03a9{Nj } . However, the bias, whose general\nexpression is derived in Appendix B, scales with 1/M and,\ntherefore, for large M , can be neglected\nwith respect to\n\u221a\nthe statistical error scaling with 1/ M .\nA possible option for \u03a0{Nj } is the product of K (as\nmany as particle species) Poisson distributions:\n\u03a0{Nj } =\n\nK\nY\n\nj=1\n\nN\n\nexp[\u2212\u03bdj ]\n\n\u03bdj j\nNj !\n\n(20)\n\nwhich will be henceforth referred to as the multi-Poisson\ndistribution or MPD. This distribution can indeed be sampled very efficiently and it is the actual multi-species multiplicity distribution in the grand-canonical ensemble, in\nthe limit of Boltzmann statistics. Although this distribution is not the limit of \u03a9{Nj } in the thermodynamic limit,\ni.e. for large mass and volume of the clusters [13] (see\nnext section), the similarity between MPD and the corresponding microcanonical distribution should be sufficient\nto effectively remove the region of the channel space where\n\u03a9{Nj } is practically vanishing. The mean values of the\nMPD are free parameters to be set in order to maximize\nthe similarity between MPD and \u03a9{Nj } . The most sensible choice is to enforce as mean values the mean hadronic\nmultiplicities calculated in the grand-canonical ensemble\nwith volume and mean energy equal to the volume and\nmass of the cluster. Indeed, unlike the higher order moments, the mean multiplicities, or first order moments of\nthe multi-species distribution, in the microcanonical ensemble converge to the corresponding values in the grandcanonical ensemble in the thermodynamical limit, as it\nwill be shown later on. These can be calculated, in the\nBoltzmann statistics by a well known formula:\n\u0010m \u0011Y\n(2Jj + 1)V 2\nq\nj\n(21)\n\u03bbi ji\nmj T K 2\n\u03bdj =\n2\n2\u03c0\nT\ni\nwhere V is the cluster's volume, T is the temperature\nand \u03bbi the fugacity corresponding to the charge Qi . Temperature and fugacities are determined by enforcing the\n\ngrand-canonical mean energy and charges to be equal to\nthe actual mass M and charges Q of the cluster:\nY q\n\u2202 X\n\u03bbi ji\nzj (T )\nM = T2\n\u2202T j\ni\nY q\nX\nji\n(22)\n\u03bbi\nqj zj (T )\nQ=\nj\n\ni\n\nwith\n\n\u0010m \u0011\n(2Jj + 1)V 2\nj\n(23)\nm\nT\nK\n2\nj\n2\u03c0 2\nT\nThe (22) are just the saddle-point equations for the asymptotic expansion of the microcanonical partition function,\nshowing that the microcanonical ensemble can be approximated by the grand-canonical ensemble for large masses\nand volumes [3].\nIt should be stressed that the (21) is just a particular choice of the \u03bdj 's in Eq. (20), which is by no means\ncompelling. The only purpose and merit of the \u03bdj 's is to\nmake the multiplicity distribution \u03a0{Nj } in Eq. (20) as\nclose as possible to \u03a9{Nj } to speed up the computation.\nIf a choice different from Eq. (21) can do a better job,\nthis could and should be retained. For the same reason,\nit makes little sense to use the precise canonical expressions of the \u03bdj 's corrected for quantum statistics, because\nat the energy density we are interested in, this is just a\ncorrection. Altogether, the means in Eq. (21) turn out to\nbe satisfactory for most practical purposes.\nIf cluster charges are unconstrained, only the first of\nthe equations (22) is needed and fugacities can be dropped\n(i.e. they are taken to be 1) from Eq. (21). On the other\nhand, if cluster charges are fixed, among all configurations\ndrawn from MPD, only those fulfilling charge conservation\nshould be retained and considered for microcanonical average calculations in Eq. (17). This preselection of random\nsamples significantly affects the overall efficiency of the algorithm, because the acceptance rate of samples extracted\nfrom MPD becomes small, and it is increasingly smaller\nfor larger clusters. The acceptance rate can be improved\nby resorting to a conditional probability decomposition\ntechnique, described in the next section.\nSummarizing, the procedure to estimate hOi in the importance sampling method for a given cluster is as follows:\nzj (T ) =\n\n1. calculate T and \u03bdj 's according to Eqs. (22),(23) and\n(21),;\n2. sample the MPD (20) some large number of times and\nfor each sample {Nj } compute numerically the integral \u03a9{Nj } by the method described in Sect. 3 with a\nsuitable number of Monte-Carlo extractions NS ;\n3. calculate the sums in Eq. (17) and estimate the statistical error according to Eq. (18).\nAn improvement in the accuracy of the estimation of hOi\ncan be obtained by drawing random samples in an extended space instead of calculating \u03a9{Nj } for each channel at each step. The idea is to perform the Monte-Carlo\nimportance sampling in the variables:\nX\nNj (24)\n{N1 , . . . , NK |r1 , . . . , rN \u22121 }\nwith N =\nj\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nat the same time, instead of calculating \u03a9{Nj } separately\nfor each extracted sample in {Nj }. We first note that Eq.\n(15) can be further rewritten as, by using Eq. (13):\n#\n\"\nY (\u22131)Nj +Hj (2Jj + 1)Hj\nX\n\u03a9{Nj } =\nQ Nj\n4hnj\nhnj !\nj\n{hn1 },...,{hnK }\nnj =1 nj\nZ 1\nZ 1\nV H T 3H\u22124\n\u00d7\ndr1 . . .\ndrH\u22121\n\u03a5 (r1 , . . . , rH\u22121 )\n(2\u03c0)3H\n0\n0\nZ 1\nZ 1\nX\n=\ndr1 . . .\ndrN \u22121\n0\n\n0\n\n{hn1 },...,{hnK }\n\n\"\n\n#\nY (\u22131)Nj +Hj (2Jj + 1)Hj V H T 3H\u22124\n\u03a5 (r1 , . . . , rH\u22121 )\nQ Nj\n4hnj\n(2\u03c0)3H\n!\nh\nn\nj\nn\nj\nnj =1 j\nZ 1\nZ 1\n\u2261\ndr1 . . .\ndrN \u22121 \u03a8 ({Nj }|{ri })\n(25)\n0\n\n0\n\nbeing {ri } \u2261 (r1 , . . . , rN \u22121 ). In practice, each term in the\nR1\nR1\nsum has been multiplied by 1 = 0 drH . . . 0 drN \u22121 , with\nH \u2264 N and, doing so, we have been able to take out\nthe integration on the ri 's. The Monte-Carlo estimate of\n\u03a9{Nj } as expressed by the last integral in Eq. (25) can\nthen be written as:\nNS\n. 1 X\n(k)\n(k)\n\u03a8 (r1 , . . . , rN \u22121 )\n\u03a9{Nj } =\nNS\n\n(26)\n\nk=1\n\n(k)\n\nwhere ri are random numbers uniformely distributed in\nthe interval [0, 1]. Likewise, looking at Eqs. (10) and (25),\nthe estimator of the mean value of the observable O in\nthis extended sampling space can be rewritten as:\n\n.\nhOi =\n\nPM \u2032\n\nk=1 O({Nj }\n\n(k)\n\n)\n\n\u03a8 ({Nj }\n\n(k)\n\n|{ri }(k) )\n\n(k)\n\u03a0{Nj }\n\nPM \u2032 \u03a8 ({Nj }(k) |{ri }(k) )\nk=1\n\n(27)\n\n(k)\n\n\u03a0{Nj }\n\nFor a fixed number of calls to the random number generator, this method optimizes the accuracy because most\nof them are spent to calculate \u03a9{Nj } for most probable\nchannels, i.e. those for which an improvement in accuracy\nis more rewarding,whereas, in the previous method, \u03a9{Nj }\nwas calculated with a fixed number of random samples NS\nregardless of its size. More specifically, if in the previous\napproach NS \u00d7 M computation of the function \u03a8 in Eq.\n(25) were performed, about the same CPU time is needed\nto calculate M \u2032 = NS \u00d7 M random samples in Eq. (27),\nbut with a sizeable reduction of the statistical error on\nhOi.\nIn our calculation, resonances whose width exceeds 1\nMeV are handled as particles with a distributed mass.\nFor each random sample, the function \u03a8 in Eq. (25) is\ncalculated by randomly drawing masses from a relativistic\nBreit-Wigner distribution for each resonance:\n1\nBW (m )dm \u221d\ndm2\n(m2 \u2212 m20 )2 + \u0393 2 m20\n2\n\n2\n\n(28)\n\n7\n\nThe mass range is symmetric around the central value m0\nwith half-width min{2\u0393, mcut } where mcut is the minimal\nmass allowed by the known decay channels of the resonance. If the sum of the extracted masses of particles and\nresonances exceeds the cluster mass, the function \u03a8 is set\nto zero.\n\n5 Comparison between microcanonical and\ncanonical ensemble\nThe importance sampling method with MPD provides a\nsuitable technique to calculate averages in the microcanonical ensemble. In this section we will mainly show numerical results on the difference between averages in the microcanonical and canonical ensemble.\nWe have calculated average multiplicities in a hadron\ngas including 271 light-flavoured hadron species up to a\nmass of about 1.8 GeV quoted in the 2002 Particle Data\nBook issue [12], for completely neutral clusters (Q = 0)\nand pp-like clusters, i.e. with net electric charge Q = 2, net\nbaryon number B = 2 and vanishing net strangeness. The\nenergy density in the rest frame of the cluster M/V has\nbeen set to 0.4 GeV/fm3 , corresponding, in the thermodynamical limit at vanishing chemical potentials, to the\ntemperature value of about 160 MeV found in analyses of\nparticle multiplicities in high energy collisions [11]. No extra strangeness suppression factor has been used here, as\nwe are just interested in a comparison between calculated\nmultiplicities in two different ensembles.\nWhilst the energy density was kept fixed, the mass has\nbeen varied from 2 to 14 GeV for neutral cluster and from\n4 to 14 GeV for pp-like clusters in steps of 2 MeV. For each\nmass, 107 random samples fulfilling charge conservation\n(i.e. passing charge preselection) have been drawn from\nthe MPD.\nIn order to improve the performance of the algorithm\nand decrease the rejection rate at the preselection stage,\nwe have implemented a multi-step extraction procedure\ntaking advantage of well known properties of the Poisson distribution. Instead of extracting all particle multiplicities independently from Poisson distributions, we extracted first the number of baryons NB and antibaryons\nNB\u0304 from two Poisson distributions, with means equal to\nthe sums of all baryon and antibaryon means respectively,\nand accept the event only if NB \u2212 NB\u0304 = B. Indeed, denoting by \u03c0j a single-species Poisson distribution, the MPD\nconstrained with charge conservation can be written as:\nK\nY\n\nj=1\n\n=\n\nY\n\n\u03c0j (Nj ) \u03b4P j Nj qj ,Q =\n\u03c0j (Nj )\n\nbar\n\nY\n\n\u03c0j (Nj )\n\nantibar\n\nY\n\n\u03c0j (Nj ) \u03b4P j Nj qj ,Q\n\nmesons\n\n= \u03c0B (NB )\u03c0B\u0304 (NB\u0304 )P (N1 , N2 , . . . |NB )P (N1\u0304 , N2\u0304 , . . . |NB\u0304 )\nY\n\u00d7\n(29)\n\u03c0(Nj ) \u03b4NB \u2212NB\u0304 ,B \u03b4P j Nj Sj ,S \u03b4P j Nj Qj ,Q\nmesons\n\nQ\nHere the probability distribution bar \u03c0(Nj ) of having\ngiven baryon multiplicities has been decomposed into the\n\n\f8\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n\u2206%\n\nproduct of a Poisson distribution \u03c0B for the overall baryon\nmultiplicity NB and the conditional probability P (N1 , N2 , . . . |NB )\n30\nof having the same set of baryon multiplicities provided\nthat their sum is NB ; similarly for antibaryons. The P\ndistribution is actually a multinomial distribution:\n25\nP (N1 , N2 , . . . |NB ) \u221d NB !\n\nY \u03bdjNj\nj\n\nNj !\n\n(30)\n\nwhere \u03bdj are given by Eq. (21). Once all baryon and antibaryon multiplicities have been extracted according to\nthe multinomial distributions, which can be sampled as\nquickly as Poisson's, the same procedure is carried out for\nstrange mesons. Since strange and antistrange mesons are\nindependent of the previous baryon extraction, the number of strange mesons NS and antistrange mesons NS\u0304 are\nextracted according to a Poisson distribution subject to\nthe requirement that NS \u2212 NS\u0304 = S \u2212 SB , where SB is\nthe net overall strangeness carried by the previously extracted baryons. If NS and NS\u0304 fulfill the above condition,\nstrange and antistrange meson multiplicities are extracted\nfrom a multinomial distribution, otherwise the event is rejected and the whole extraction procedure gets back to the\nvery beginning, i.e. by randomly sampling baryon and antibaryon numbers. Likewise, the number of charged nonstrange mesons and their antiparticles is extracted and,\nprovided that charge conservation is fulfilled, their individual multiplicities are determined. Finally, the multiplicities of completely neutral mesons, which do not affect\nthe total charges, are extracted. The advantage of this\nmethod over that based on straight multi-Poisson sampling can be more easily understood in terms of rejection\nrate. In fact, the number of rejected channels {Nj } out of\nthose sampled because of the charge constraints, should\nbe the same in both methods as they are drawn from the\nsame distribution, i.e. the MPD. Nevertheless, in the latter multi-step method, a single rejection of a channel on\naverage does not require K (as many as hadron species)\nextraction from a Poisson distribution: it may well occur\nat the first stage of baryon number conservation, with only\none extraction from a Poisson distribution or later, with\na number of sampled Poisson or multinomial distribution\nwhich is still less than K. The actual gain in CPU time\nmay be dramatic, especially for high mass clusters, where\nthe number of allowed channels is huge. For instance, for\na pp-like cluster of 14 GeV, we have estimated a ratio of\n0.025 between the average CPU time needed to extract a\nchannel with proper charges in the multi-step improved\nmethod and in the original method.\nAltogether, the actual CPU time needed to generate\n107 accepted samples (i.e. the statistics relevant to the\nplots in figs. 4,5) of multi- hadronic channels and calculate\naverage multiplicities in the importance sampling method\nfor a neutral 4 GeV cluster at 0.4 GeV/fm3 energy density\nis about 4.6 102 sec, i.e. less than 8 minutes.\nThe canonical average multiplicities to be compared\nwith the microcanonical ones have been calculated by determining first the temperature corresponding to the sad-\n\n4GeV\n8GeV\n12GeV\n\n20\n15\n10\n5\n0\n-5\n\u03c0\n\n0\n\n\u00b1\n\n\u03c0\n\n\u00b1\n\nK\n\n0\n\nK\n\n\u03b7\n\n\u03c1\n\n0\n\n\u00b1\n\n\u03c1\n\n\u03c9\n\n*\u00b1\n\nK\n\n*0\n\nK\n\n\u03b7'\n\n\u03c6\n\nFig. 4. Relative difference between microcanonical and canonical average primary multiplicities of mesons (hNj imicro \u2212\nhNj ican )/hNj ican for completely neutral clusters with mass 4,\n8, 12 GeV . The error bars indicate the statistical error of\nthe importance sampling Monte-Carlo computation. Connecting lines are drawn to guide to eye.\n\ndle point equation [3]:\nM \u2212 T2\n\n\u2202\nlog Z(Q, T ) = 0\n\u2202T\n\n(31)\n\nwhere\nZ +\u03c0\nh X (2J + 1)V\n1\nj\n3\n\u0131Q*\u03c6\nd\n\u03c6\ne\nexp\nZ(Q, T ) =\n3\n(2\u03c0) \u2212\u03c0\n(2\u03c0)3\nj\nZ\ni\n\u221a 2 2\n\u00d7 d3 p log(1 \u00b1 e\u2212 p +mj /T \u2212\u0131qj *\u03c6 )\u00b11 (32)\nis the canonical partition function; as usual, the upper\nsign applies to fermions, the lower to bosons. Then, multiplicities have been calculated according to the known\nexpression in the canonical ensemble [5]:\nhNj i =\n\u221e\n\u0010 nm \u0011 Z(Q \u2212 nq )\nX\n(2Jj + 1)V 2\nj\nm\nT\nK\n(33)\n=\n(\u22131)n+1\n2\nj\n2n\n2\u03c0\nT\nZ(Q)\nn=1\nwhere terms in the series beyond n = 1 account for quantum statistics effects and are in fact important only for\npions at the usually found temperature values of 160180 MeV. As for the microcanonical ensemble, resonances\nwhose width exceeds 1 MeV have been considered as free\nhadrons with a mass distributed according to a relativistic\nBreit-Wigner distribution.\n\n\f\u2206%\n\n\u2206%\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n20\n\n9\n\n60\n40\n\n0\n\n20\n\n-20\n\n0\n-20\n\n-40\n-40\n-60\n\n4GeV\n\n-60\n\n8GeV\n12GeV\n\n-80\n\n-80\n\np n \u039b \u03a3 \u03a3 \u03a3 \u2206 \u2206 \u2206 \u2206 \u039e \u039e \u03a3 \u03a3 \u03a3 \u039e \u039e \u03a9\n+\n\n0\n\n-\n\n++ +\n\n0\n\n-\n\n0\n\n-\n\n*+ *0 *-\n\n*0 *-\n\n-\n\n40\n\np n \u039b \u03a3+ \u03a30 \u03a3- \u2206++\u2206+ \u22060 \u2206- \u039e0 \u039e- \u03a3*+\u03a3*0\u03a3*- \u039e*0\u039e*- \u03a9-\n\nFig. 7. Relative difference between microcanonical and canonical average primary multiplicities of baryons (hNj imicro \u2212\nhNj ican )/hNj ican for pp-like clusters with mass 4, 8, 12 GeV.\nThe error bars indicate the statistical error of the importance sampling Monte-Carlo computation. Connecting lines\nare drawn to guide to eye.\n\n\u2206%\n\n\u2206%\n\nFig. 5. Relative difference between microcanonical and canonical average primary multiplicities of baryons (hNj imicro \u2212\nhNj ican )/hNj ican for completely neutral clusters with mass 4,\n8, 12 GeV. The error bars indicate the statistical error of the\nimportance sampling Monte-Carlo computation. Connecting\nlines are drawn to guide to eye.\n\n4GeV\n8GeV\n12GeV\n\n60\n40\n\n20\n20\n0\n\n0\n\n-20\n-20\n-40\n-60\n\n-40\n\n4GeV\n8GeV\n\n-80\n\n12GeV\n\n-60\n\n6GeV\n8GeV\n12GeV\n\n-100\n0 \u20130\n\n*+ *0 \u2013 *0\n\n\u03c0 \u03c0 \u03c0 K K K K \u03b7 \u03c1 \u03c1 \u03c1 \u03c9 K K K K \u03b7' \u03c6\n0\n\n-\n\n+\n\n-\n\n+\n\n0\n\n-\n\n+\n\n*-\n\nFig. 6. Relative difference between microcanonical and canonical average primary multiplicities of mesons (hNj imicro \u2212\nhNj ican )/hNj ican for pp-like clusters with mass 4, 8, 12 GeV.\nThe error bars indicate the statistical error of the importance sampling Monte-Carlo computation. Connecting lines\nare drawn to guide to eye.\n\np n \u039b \u03a3+ \u03a30 \u03a3- \u2206++\u2206+ \u22060 \u2206- \u039e0 \u039e- \u03a3*+\u03a3*0\u03a3*- \u039e*0\u039e*- \u03a9-\n\nFig. 8. Relative difference between microcanonical and canonical average primary multiplicities of antibaryons (hNj imicro \u2212\nhNj ican )/hNj ican for pp-like clusters with mass 4, 8, 12 GeV.\nThe error bars indicate the statistical error of the importance sampling Monte-Carlo computation. Connecting lines\nare drawn to guide to eye.\n\n\f\u2206%\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n\u2206%\n\n10\n\n10\n0\n\n\u03c0\n-10\n\n0\n\np\n\n35\n30\n\n\u3008\u03c00\u3009\n\n25\n\nAll hadrons\n\n20\n\nOnly \u03c0\n\n0\n\n15\n10\n-60\n\n5\n\n\u03a9\n\n0\n\n-80\n0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9\n\n\u03c1 (GeV/fm )\n3\n\nFig. 9. Relative difference between microcanonical and canonical average primary multiplicities of \u03c0 0 , p and \u03a9 (hNj imicro \u2212\nhNj ican )/hNj ican for a neutral cluster with mass of 6 GeV as\na function of energy density. The error bars indicate the statistical error of the importance sampling Monte-Carlo computation. Connecting lines are drawn to guide to eye.\n\nThe relative difference between microcanonical and canonical average for hadrons belonging to basic SU(3) multiplets and three different cluster masses are shown in figs.\n4,5,6,7 and 8. At a mass of 4 GeV, the deviation is significant and shows a considerable variation as a function of\nthe species. In neutral clusters, mesons and baryons feature a different behaviour: whilst microcanonical multiplicities of mesons are higher than the corresponding multiplicity in the canonical ensemble, those of baryons are\nlower. In pp-like cluster, on the other hand, the general\nbehaviour is not as simple; different mesons show different signs of the difference and there are even oscillations\nof it going from low to high mass clusters. On the other\nhand, it is evident that already at 8 GeV of mass, where\nthe total primary multiplicity of particles is around 8 (see\ntable 2), all differences between the microcanonical and\ncanonical ensemble do not generally exceed 20% and further shrink to about 10% at 12 GeV. Furthermore, these\ndifferences depend only weakly on the energy density, as\nshown in fig. 9. We can conclude that, as a rule of thumb,\nthe canonical ensemble is a good approximation of the\nmicrocanonical one for masses & 8 GeV at energy densities between 0.1 and 0.9 GeV/fm3 with quantum numbers\nnot greater than that of an elementary colliding system.\nProvided that the further assumption of the equivalence\nbetween the actual set of clusters and an equivalent global\ncluster (EGC) holds [6], this result justifies the use of the\ncanonical ensemble in the analysis of particle multiplicities in pp, e+ e\u2212 and other high energy collisions. Indeed,\n\n-5\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\nM (GeV)\n\nFig. 10. Relative difference between microcanonical and\ncanonical average primary multiplicities of \u03c0 0 (hNj imicro \u2212\nhNj ican )/hNj ican a completely neutral cluster and in a pion\ngas as a function of cluster mass at an energy density of 0.4\nGeV/fm3 . The error bars indicate the statistical error of the\nimportance sampling Monte-Carlo computation. Connecting\nlines are drawn to guide to eye.\n\nthe mean masses of the EGC corresponding to the actually fitted temperatures and volumes, shown in table 1,\nturn out to be sufficiently large\n\u221a for most collisions,+ with\n+\nthe\nlikely\nexception\nof\nK\np\nat\ns = 11.5 GeV and e e\u2212 at\n\u221a\ns\u221a\n= 14 GeV where the mean mass is lower than 7 GeV.\nAt s & 20 GeV, the mean mass is larger than 8 GeV,\nimplying that the canonical ensemble is a good approximation.\nThe quick convergence of microcanonical average multiplicities to canonical ones in a hadron gas is favoured\nby the large number of available degrees of freedom. From\na mathematical point of view, a large number of degrees\nof freedom makes the saddle point expansion converging\nfaster. In physical terms, there are more ways to conserve\nenergy and momentum in a system with a larger number of particle species, so that fulfilling these constraints\nbecome less important earlier than in a system with few\ndegrees of freedom. This is demonstrated in fig. 10 where\nthe relative difference between neutral pion multiplicity\nin microcanonical and canonical ensemble is shown for a\ncompletely neutral pion gas and for a full hadron-gas as a\nfunction of cluster mass.\nThe microcanonical average multiplicities of most hadrons, to a good approximation, increase linearly as a function of cluster mass, for fixed energy density, starting from\nM \u2243 3 GeV. On the other hand, particles with large\ncharge content (such as \u03a9) show a stronger dependence\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n11\n\nTable 1. Fitted parameters temperature, volume and extra strangeness suppression parameter (\u03b3S or the mean value of\nproduced strange quark pairs out of the vacuum hss\u0304i) in elementary collisions in the canonical analysis of hadron abundances.\nThe canonical fit assumes the equivalence, as far as particle multiplicities are concerned, between the set of actual clusters and\none global cluster [6] whose resulting mean mass is quoted in the last column. Note that e+ e\u2212 \u2192 cc\u0304 and e+ e\u2212 \u2192 bb\u0304 events,\nwhere heavy flavoured hadrons are emitted, have been excluded to estimate hM i in e+ e\u2212 collisions.\n\u221a\n\n\u3008n\u3009\n\nCollision\nK+ p\nK+ p\n\u03c0+ p\npp\npp\ne+ e\u2212\ne+ e\u2212\ne+ e\u2212\ne+ e\u2212\ne+ e\u2212\ne+ e\u2212\npp\u0304\npp\u0304\npp\u0304\n\ns (GeV)\n11.5\n21.7\n21.7\n17.2\n27.4\n14\n22\n29\n35\n43\n91.25\n200\n546\n900\n\nReference\n[6]\n[6]\n[6]\n[14]\n[6]\n[6]\n[6]\n[6]\n[6]\n[6]\n[11]\n[11]\n[11]\n[11]\n\nT (MeV)\n176.9\u00b12.6\n175.8\u00b15.6\n170.5\u00b15.2\n187.2\u00b16.1\n162.4\u00b15.6\n167.3\u00b16.5\n172.5\u00b16.7\n159.0\u00b12.6\n158.7\u00b13.4\n162.5\u00b18.1\n159.4\u00b10.8\n175\u00b111\n167\u00b111\n167.6\u00b19.0\n\nQ=0\nB=0\n14\nS=0\n12\n\n\u03b3S or hss\u0304i\nhss\u0304i= 0.347\u00b10.020\nhss\u0304i= 0.578\u00b10.056\nhss\u0304i= 0.734\u00b10.049\nhss\u0304i= 0.381\u00b10.021\nhss\u0304i= 0.653\u00b10.017\n\u03b3S = 0.795\u00b10.088\n\u03b3S = 0.767\u00b10.094\n\u03b3S = 0.710\u00b10.047\n\u03b3S = 0.746\u00b10.040\n\u03b3S = 0.768\u00b10.065\n\u03b3S = 0.664\u00b10.014\n\u03b3S = 0.491\u00b10.044\n\u03b3S = 0.526\u00b10.044\n\u03b3S = 0.533\u00b10.054\n\n10\n\nP ({Nj }) =\n\n8\n\n\u00d7\n\n6\n4\n\n\"\n\nY X\n\n1\nZ(Q)\nNj +Hj\n\n(\u22131)\n\nj {hnj }\n\nNj\nY\n\nhn\n\nzj(njj )\nhn j\n\nnj =1 nj\n\nhnj !\n\n#\n\n\u03b4Q,P j Nj qj (34)\n\nwhere {hnj }, as usual, denote partitions and:\n\n2\n0\n\nhM i (GeV)\n6.51\n8.47\n8.23\n7.74\n9.67\n6.08\n8.12\n9.28\n9.54\n9.99\n16.0\n21.6\n28.7\n34.8\n\ntermined by taking \u03b4N,P j Nj as observable in Eqs. (10),(16)\nand performing an importance sampling Monte-Carlo calculation. The multiplicity distribution in the canonical ensemble has been determined by the same method, that is\nextracting particle numbers from the MPD and weighing each event fulfilling charge conservation with the ratio\nbetween the actual multi-species multiplicity distribution\nand the MPD. The former reads (see Appendix C):\n\n\u3008h\u3009\n0\n\u3008\u03c0 \u3009 \u00d7 5\n\u3008p\u3009 \u00d7 75\n\u3008\u03a9\u3009 \u00d7 2500\n\n16\n\nV (fm3 )\n8.12\u00b10.83\n12.0\u00b12.4\n16.7\u00b13.1\n6.79\u00b11.6\n25.5\u00b11.8\n15.9\u00b14.1\n15.9\u00b14.8\n33.1\u00b14.0\n33.7\u00b15.2\n29.0\u00b19.2\n52.4\u00b12.2\n35\u00b114\n65\u00b127\n\u2243 77\n\nzj(nj ) =\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\nM (GeV)\n\nFig. 11. Microcanonical average primary multiplicities of \u03c0 0 ,\np, \u03a9 and of all hadron species (h) in a completely neutral\ncluster as a function of cluster mass at an energy density of\n0.4 GeV/fm3 . The error bars indicate the statistical error of\nthe importance sampling Monte-Carlo computation. Lines are\ndrawn to guide to eye.\n\non mass, as shown in fig. 11, over the mass range appropriate for microcanonical and canonical calculations.\nWe have also compared the overall primary multiplicity distributions in the two ensembles. The multiplicity\ndistribution in the microcanonical ensemble has been de-\n\n(2Jj + 1)V\n(2\u03c0)3\n\nZ\n\nd3 p e\u2212nj\n\n\u221a\n\np2 +m2j /T\n\n(35)\n\nFor T \u2248 160 MeV, only the leading poissonian terms in\nthe distribution (34) corresponding to {hnj } = (N, 0, . . .)\ncan be retained for all particles except pions.\nThe comparison between the multiplicity distributions\nare shown in figs. 12 and 13 for neutral and pp-like clusters respectively. It can be seen that the mean values tend\nto get closer as mass increases, whilst the dispersion is\nlower in the microcanonical than in the canonical ensemble, where the distribution is almost poissonian. This remarkable effect on particle number fluctuation is owing to\nthe overall energy-momentum constraint causing a global\ncorrelation in particle production. The ratio of the dispersion to the square root of the mean (i.e. the dispersion\nof a Poisson distribution) tends to a factor 1/2 in the\nthermodynamical limit (see fig. 14), thus showing that\n\n\f1\n\n10\n10\n10\n10\n10\n10\n10\n10\n\n\u3008N\u3009=2.43\nD=0.63\nM=2 GeV\n\n-1\n\n\u3008N\u3009=10.67\nD=1.59\nM=10 GeV\n\n-2\n-3\n\nP(N)\n\n10\n10\n10\n10\n10\n10\n\nQ=0\nB=0\nS=0\n\n0.4\n\n-4\n\n\u3008N\u3009=6.53\nD=1.24\nM=6 GeV\n\n-1\n\n\u3008N\u3009=14.84\nD=1.89\nM=14 GeV\n\n-2\n\n0.5\n\n0.45\n\n-3\n\nQ=2\nB=2\nS=0\n\n0.4\n\n-4\n\n0\n\n5\n\n10\n\n15\n\n0\n\n10\n\n20\n\n30\n\n-1\n\n\u3008N\u3009=3,87\nD=0.81\nM=4 GeV\n\n\u3008N\u3009=10.35\nD=1.49\nM=10 GeV\n\n\u3008N\u3009=6.04\nD=1.08\nM=6 GeV\n\n\u3008N\u3009=14.60\nD=1.82\nM=14 GeV\n\n-2\n-3\n-4\n-1\n-2\n-3\n-4\n\n0\n\n5\n\n10\n\n15\n\n0\n\n10\n\n20\n\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n\nM(GeV)\n\nN\n\n1\n\n10\n\n0.5\n\n0.45\n\nFig. 12. Comparison between microcanonical (solid) and\ncanonical (dashed) overall primary multiplicities distribution\nin neutral clusters of four different masses at an energy density of 0.4 GeV/fm3 .\n\n10\n\nD/\u221a\u3008N\u3009\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nD/\u221a\u3008N\u3009\n\nP(N)\n\n12\n\n30\n\nN\n\nFig. 13. Comparison between microcanonical (solid) and\ncanonical (dashed) overall primary multiplicities distribution\nin a pp-like cluster of four different masses at an energy density of 0.4 GeV/fm3 .\n\nFig. 14. Ratio between the dispersion of the microcanonical\nmultiplicity distribution and the square root of its mean in\nneutral (top) and pp-like (bottom) clusters as a function of\nmass at an energy density of 0.4 GeV/fm3 . Lines are drawn to\nguide the eye.\n\nmicrocanonical ensemble is not equivalent to the grandcanonical ensemble with respect to particle number fluctuations. We are not currently aware of a simple reason of\nthis fact.\nBecause of the persistence of the shape difference between multiplicity distributions in the two ensembles, the\nnumber of channels sampled with the MPD whose weight\nis much larger than their corresponding microcanonical\none increases with total mean multiplicity, hence with\ncluster's mass (at fixed energy density). This is the reason of the slightly increasing statistical error on average\nmultiplicities and multiplicity distributions for increasing\ncluster mass seen in figs. 4,5,6,7,8,12,13. One could remedy this and speed up microcanonical calculations for very\nlarge clusters by changing the sampling distribution. For\ninstance, instead of using a MPD to sample individual\nspecies numbers, the total number of particles can be first\ndrawn from a gaussian distribution with variance 1/4 of\nthe sum of all hadron primary multiplicities as estimated\nin the canonical ensemble; then, the number of baryons\nNB , strange mesons NS , charged non-strange mesons NQ ,\nneutral mesons N0 and their respective number of antiparticles could be sampled from a multinomial distribution:\nP = N!\n\n7\nY\n\u03beiNi\nNi !\ni=1\n\n(36)\n\nwhere i = B, B\u0304, S, S\u0304, Q, Q\u0304, 0 and \u03bei are the sums of all \u03bdj\nfunctions in Eq. (21) of particles belonging to the same\nclass i. Finally, once the multiplicities of each class Ni\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nfulfilling conservation laws have been extracted, individual\nparticle multiplicities could be determined for each class\nin turn by using again multinomial distributions.\nTable 2. Mean multiplicity hN i and dispersion D of the microcanonical and canonical multiplicity distribution for neutral\nand pp-like clusters as a function of the mass. Also quoted the\ncorresponding temperature in the canonical ensemble obtained\nfrom Eq. (31).\nNeutral cluster\nM (GeV)\n2\n4\n6\n8\n10\n12\n14\n\nMicrocanonical\nhN i\nD\n2.43\n0.63\n4.45\n1.01\n6.53\n1.24\n8.61\n1.43\n10.67 1.59\n12.76 1.75\n14.84 1.89\n\nCanonical\nhN i\nD\n1.96\n1.74\n4.08\n2.45\n6.17\n2.93\n8.27\n3.29\n10.38 3.58\n12.46 3.90\n14.56 4.15\n\nT (MeV)\n175.3\n169.3\n166.3\n164.6\n163.5\n162.8\n162.2\n\npp-like cluster\nM (GeV)\n4\n6\n8\n10\n12\n14\n\nMicrocanonical\nhN i\nD\n3.87\n0.81\n6.04\n1.08\n8.20\n1.30\n10.35 1.49\n12.48 1.66\n14.60 1.82\n\nCanonical\nhN i\nD\n3.63\n1.33\n5.76\n2.05\n7.90\n2.59\n10.04 3.02\n12.17 3.40\n14.27 3.73\n\nT (MeV)\n142.1\n152.5\n156.1\n157.8\n158.7\n159.2\n\n6 The Metropolis algorithm\nThe importance sampling method allows to calculate averages like (10) in single Monte-Carlo runs quite straightforwardly and can be used as an event generator if events\nare reweighted, as we have seen, by a factor \u03a9{Nj } /\u03a0{Nj } .\nIf one needs to sample \u03a9{Nj } directly without reweighting\nthe events, different methods should be considered. A first\npossibility is a rejection method, but it can be soon realized that it is unfit for the problem we are dealing with.\nIn fact, for this method to be effective, one needs a covering function F ({Nj }) (i.e. a function of the channel such\nthat F ({Nj }) > \u03a9{Nj } \u2200{Nj } which can be sampled very\nefficiently and as close as possible to the \u03a9{Nj } . Such a\nfunction is hard to find because \u03a9{Nj } is not smooth in its\ndomain; strong variations of the phase space volume may\noccur by changing just one particle. We have seen that the\nMPD is likely to be similar to our target distribution, but\nin order to be a covering function, it should be rescaled by\na factor c such that c\u03a0{Nj } > \u03a9{Nj } \u2200{Nj }. However, to\nestimate c, one ought to evaluate \u03a9{Nj } for all channels\nand this is just what cannot be afforded. A general method\nto sample complex multi-dimensional distributions is the\nMetropolis algorithm [15], which has been applied to the\nspecific problem of numerical calculations of the multi-\n\n13\n\nhadronic microcanonical ensemble by Werner and Aichelin [7]. In this work, we will show that this method can be\nfurther improved in speed and accuracy and, at the same\ntime, that great care is needed in handling it, especially\nwhen assessing the equilibrium conditions.\nThe Metropolis algorithm prescribes the implementation of a random walk in the channel space on the basis of\nacceptance or rejection of proposed transitions from the\ncurrent position. After some number of steps, the probability of visiting a given point is proportional to the target distribution; otherwise stated, the points in the random walk are actual samples of the the target distribution\n(in our case \u03a9{Nj } ) and they can be stored as generated\nevents. We will now discuss more in detail how this comes\nabout. In a general random walk, the probability Pm (t) of\nvisiting a state m (i.e. a channel or multi-hadronic configuration) at the tth step evolves according to the master\nequation:\nX\nPm (t+1)\u2212Pm(t) =\nPn (t)w(n \u2192 m)\u2212Pm (t)w(m \u2192 n)\nn\n\n(37)\nwhere w(n \u2192 m) is the probability of transition from the\nstate n to the state m. At the equilibrium:\nPm (t + 1) = Pm (t)\n\n\u2200m\n\n(38)\n\nThis occurs if (a sufficient but not necessary condition):\nPn (t)w(n \u2192 m) = Pm (t)w(m \u2192 n)\n\n\u2200n, m\n\n(39)\n\nIf we want the probabilities Pm to be proportional to\na given target distribution f (m), so that the number of\ntimes the state m is visited from some step t onwards is\nproportional to f (m), we have to enforce the condition:\nf (m)\nw(n \u2192 m)\n=\n.\nw(m \u2192 n)\nf (n)\n\n(40)\n\nProvided that the above equation is fulfilled, the choice\nof a set of transition probabilities w (a so-called updating\nrule), is free. The only requirement is that every point can\nbe reached from any point in a finite number of steps with\nnon-vanishing probability (ergodicity condition), otherwise\nthere would be unaccessible regions even though f 6= 0\ntherein. Although any choice of the w's is in principle allowed, some are worthier. Indeed, the transition probabilities w govern the dynamical behaviour of the random walk\nand, particularly, how fast the system gets to the equilibrium condition (38) after a transient. This is owing to the\nfact that, in general, the random walk starts from states\nwhich are not random samples of the target distribution,\nso that Pm (0) 6= f (m). A good choice of the w's will keep\nthe relaxation time Trel , defined as the number of steps\nneeded to get sufficiently close to the equilibrium value,\nto a minimum, thereby making event generation faster.\nIn general, the transition probability can be decomposed into a proposal probability T (proposal matrix), i.e.\nthe probability of considering a given transition, and the\nconditional probability A of accepting it once it has been\nproposed. In symbols:\nw(n \u2192 m) = T (n \u2192 m)A(n \u2192 m) .\n\n\f14\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nStarting from a non-equilibrium situation, a physical system reaches equilibrium earlier if transition probabilities\nare larger. Likewise, in the Metropolis algorithm, the relaxation time is little if w(n \u2192 m) are large; in other\nwords, if w(n \u2192 n) is small taking into account the normalization condition:\nX\nw(n \u2192 m) = 1\n(41)\nm\n\nFor the transition probabilities to states different from the\ncurrent state to be large, the acceptance matrix should be\nas large as possible for m 6= n once the proposal matrix\nis known. There is indeed an optimal choice for A which\nreads:\n)\n(\nf (m)T (m \u2192 n)\n.\n(42)\nA(n \u2192 m) = min 1,\nf (n)T (n \u2192 m)\nThis choice maximizes w(n \u2192 m) if n 6= m [16] and fulfills the condition (40). The next problem is choose a good\nproposal matrix. The issue is discussed in detail in ref. [16]\nand the conclusion is that T (n \u2192 m) \u2243 f (m), i.e. the proposal matrix should be an easy-to-sample distribution as\nclose as possible to the target distribution f (m). This can\nbe easily understood by taking the limiting case (which,\nif possible, would make the Metropolis algorithm unnecessary):\nT (n \u2192 m) = f (m)\n(43)\n\nIn this case, the relaxation time would be zero: the starting point, as well as all other points in the random walk,\nwould be sampled from the target distribution itself and\nany transition would be accepted because A(n \u2192 m) =\n1 according to Eqs. (42) and (43). While the condition\n(43) cannot be obtained in practice (Metropolis algorithm\nwould be unnecessary in that case), one can try to get\nas close as possible to it. From what we have seen in\nSect. 4 about importance sampling, it can be argued that\nthe MPD in Eq. (20) would be a good proposal matrix\nand could also be used to pick the starting point in the\nMetropolis random walk. We will see the benefits of the\nuse of the MPD more in detail in the next section.\nA drawback of the Metropolis algorithm is that, unlike in the importance sampling method, different samples\n(i.e. steps in the random walk) are not independent. This\ncan be easily understood reminding that proposed transitions may be rejected, so that a point may appear several\ntimes in a row in the random walk. Hence, there is a finite positive statistical correlation between the values of\nphysical observables at different steps and this gives rise\nto an increase of the overall uncertainty in the estimate of\naverages with respect to the case of independent samples.\nThe fact that different events are correlated may render\nthe use of Metropolis algorithm not appropriate in some\napplications. However, in the problem of high energy collision event simulation, where one has to hadronize many\nclusters with different masses in each event, this is not an\nissue; in this case, a single Metropolis random walk must\nbe run for each cluster, and only one sample, representative of its microcanonical ensemble, drawn after equilibrium has been reached.\n\nThe Metropolis algorithm can be used to estimate the\naverage of an observable like (10) in the microcanonical\nensemble of a single cluster by taking a sufficiently large\nnumber of steps (i.e. \u226b Trel ) in one random walk and\ncalculating:\nPM\nO(k)\n.\n(44)\nhOi = k=1\nM\nwhere M is the total number of steps and O(k) the actual\nvalue of the observable O at k th step. A nice feature of\nthe Metropolis algorithm is that, unlike in the importance\nsampling method, there is no need of overall normalization\nwhen estimating hOi (compare Eq. (44) with Eq. (17)). On\nthe other hand, as already emphasized, the values of O at\ndifferent steps are correlated. The statistical error on hOi\nin Eq. (44) can be estimated as (see Appendix D):\ns\n2\nhO2 i \u2212 hOi + 2R\n(45)\n\u03c3hOi =\nM\nwhere R is the integral of the autocorrelation function\nA, defined here as the difference between the expectation\nvalue of the product of the observable value at the steps\nk and k + h and its average hOi2\nA(h) \u2261 E(O(k) O(k+h) ) \u2212 hOi2\n\n(46)\n\nIf the starting point is random, the autocorrelation function is independent of k and gives information about how\ncorrelated are distant steps, namely how long the system\nkeeps memory of its past steps. As already mentioned,\nthis correlation between different steps arises from the finite probability of rejecting transitions and vanishes only\nif all proposed transitions are accepted, i.e. if Eq. (43) is\nfulfilled. Therefore, the autocorrelation function is always\npositive and vanishes only if different steps are independent. Moreover, the statistical error (45) is larger than\nin the case of uncorrelated samples, where it reaches its\nminimum. The number of steps needed to reduce A(h) to\n2\nsome small fraction of hOi is defined as autocorrelation\ntime Tauto . Thus, in order to minimize the statistical error\non hOi in Eq. (45), one should keep the autocorrelation\ntime as little as possible.\nThe autocorrelation function and time depend only on\nthe updating rule, whilst the relaxation time Trel also depends on how the initial state is chosen. In principle, the\nrelaxation time might be zero while the autocorrelation\ntime is not. When using the MPD both as proposal matrix\nand to generate the starting point, these two quantities are\ntightly related.\nThe autocorrelation function can be estimated during\nthe Metropolis random walk by the sum:\n!2\nPM\u2212Tauto (k) (k+h)\nM\nX\nO O\n1\n.\n(k)\nk=1\n(47)\n\u2212 2\nO\nA(h) =\nM \u2212 Tauto\nM\nk=1\n\nand it is shown in fig. 15 for a cluster of 4 GeV with\nupdating rule based on the MPD.\nNow the question arises whether the Metropolis algorithm leads to more or less accurate computations of\n\n\fP7\n\nA(h)\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n1\n\n15\n\n0.28\n\n\u2191\n\n0.8\n0.6\n0.26\n\n0.4\n0.2\n0\n\n0.24\n\n50\n\n100\n\n150\n\n200\n\n250\n\n300\n\n350\n\nh\nFig. 15. Autocorrelation function for the total primary multiplicity for a neutral cluster of 4 GeV mass at an energy density\nof 0.4 GeV/fm3 .\n\nmean values than the importance sampling method, for\ngiven computing resources and using the same distribution \u03a0{Nj } as proposal matrix and sampling distribution\nrespectively. This is studied in more detail in Subsect. 7.4.\n\n7 Study of the Metropolis algorithm\nWe have studied the capability of the Metropolis algorithm as an event generator for the statistical model of\nhadronization and as a computing tool for the hadron gas\nmicrocanonical ensemble. As has been discussed in the\nprevious section, the benchmark for this algorithm is the\nnumber of steps needed to reach equilibrium, or relaxation\ntime Trel , which must be kept to a minimum so as to draw\nsamples of the target distribution as quickly as possible.\nLikewise, the autocorrelation time Tauto must be small in\norder to minimize the statistical error (45) on the estimate\nof mean values in single random walks. As has been mentioned at the end of previous section, these two quantities\nare tightly related in our MPD-based scheme, so we can\nconfine ourselves to study Trel .\nThe relaxation time in principle depends on the physical observable (average multiplicities, multiplicity distribution etc.) and it is not easy to estimate in advance.\nHence, in practice, it must be determined a posteriori\nby analyzing the convergence to equilibrium for the observable of interest. For instance, if we ought to calculate\nthe overall multiplicity distribution Pn , we would have to\nstudy the height of the nth bin, for all n's, as a function\nof the step. The height of the nth bin at the k th step, that\nis Pn(k) , can be estimated by repeating the Metropolis\nrandom walk many times and averaging:\nL\n\nPn(k) =\n\n1X\n\u03b4n,ni(k)\nL i=1\n\n(48)\n\nwhere ni(k) is the actual multiplicity in the ith random\nwalk at the step k.\n\n0.22\n\n0.2\n0\n\n10 20 30 40 50 60 70 80 90 100\n\nStep\n\nFig. 16. Step hystogram showing the convergence to equilibrium of the probability P7 of a channel with 7 primary hadrons\nas a function of the step in a set of 500000 Metropolis random\nwalks for a neutral cluster of 6 GeV with energy density of 0.4\nGeV/fm3 . The horizontal solid line indicates the P7 value estimated with the importance sampling method and the dashed\nband its relevant statistical uncertainty. The arrow points to\nthe equilibrium point determined through the WOSSR test\n(see text).\n\nEstablishing when a stable value of the examined observable is attained can be done by studying its average\nover many Metropolis random walks, like (48) as a function of the step, i.e. forming a hystogram (the step hystogram, see fig. 16) with Metropolis step numbers as bins\nand the average of the observable (e.g. multiplicity) as\nbin content. In all considered cases, the step hystogram\nshows the same general behaviour, namely a tendency to\nan equilibrium value after, possibly, a strong initial oscillation and followed, sometimes, by very mild damped\noscillations. Step hystograms show fluctuations around an\napparent equilibrium value at some scale, as it can be\nseen in figs. 16,17. The fluctuation pattern is determined\nby the interplay of finite statistics and possible dynamical oscillations governed by the master equation (37). The\namplitude of statistical fluctuations is a function of the\nupdating rule.\nBecause of these facts, providing a good quantitative\nassessment of where stability is achieved is not straightforward. Were the statistics of Metropolis random walks\ninfinite, the criterium for stability would be fully deterministic, that is based on the relative difference between\nasymptotic value (the true microcanonical average) and\nactual value from a given step onwards. On the other hand,\nwe can only deal with finite statistics, so the estimation\nof a stability point (thence Trel ) for a given observable\n\n\f16\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\ncan be done statistically, thus it will be affected by some\nuncertainty.\nThe statistical method we have chosen in order to assess the convergence to equilibrium is based on a nonparametric statistical test, the Wilcoxon one sample signed\nrank test (WOSSR), that we will shortly describe in the\nfollowing. The WOSSR test is a non-parametric test, i.e.\nit does not require the knowledge of the statistical distribution of the sample, and the hypothesis under test (the\nnull hypothesis) is that a set of M independent random\nsamples {x1 , . . . , xM } has a given median Xm . The only\nrequirement is that their distribution is symmetric. The\ntest procedure consists in sorting the absolute values of\nthe differences di = xi \u2212 Xm \u2200i and giving them a rank,\nnamely 1 to the largest, 2 to the second largest and so\non. If Xm is a good median, the sum of the ranks of the\npositive differences is expected to be close to the sum of\nthe ranks of negative differences. The test statistic is just\nthe sum W of the ranks of the positive differences and the\ntest result is good when W is close to half the sum of the\nfirst M integers, that is M (M + 1)/4.\nWe have used this method to study the convergence to\nequilibrium in the Metropolis algorithm taking as random\nsamples a subset of M running bins (from the k th to the\n(k +M )th ) in the step hystogram of the multiplicity distribution Pn(k) (see fig. 16). In fact, if equilibrium is reached\nin the Metropolis random walk (as it is apparent in the\nrightmost part of the hystogram in fig. 16), Pn(k) is expected to evenly fluctuate around the asymptotic equilibrium value, whereas a net drift towards this value appears\nwhen out of equilibrium (i.e. in the leftmost part of fig. 16).\nTherefore, provided that the distribution of fluctuations is\nsymmetric at equilibrium, the asymptotic value is likely to\nbe a good median for sets of Pn(k) with k = 1, . . . , M in\nthe equilibrium region and not in the drifting region. Accordingly, the WOSSR test will yield a good confidence\nlevel in the former case and a very small one in the latter.\nThe true asymptotic value is not known in practice and\nmust be estimated from the step hystogram itself. A good\nchoice is the arithmetic mean of a set of hystogram contents in the rightmost region, where stability is apparently\nreached.\nThe non-parametric WOSSR test carried out on a set\nof M running bins in the step hystogram seems suitable\nfor our problem. In fact, we do not know the statistical\ndistribution of the random variable O(k) (i.e. the examined observable) at each step for a given number L of random walks. On the other hand, it is reasonable to assume\nthat it is symmetric at equilibrium around the asymptotic value which is one of the requirement of the WOSSR\ntest. However, this test also requires the independence of\nsamples, which is not the case here because subsequent\nsteps in Metropolis random walks are indeed correlated,\nas has been emphasized. Thus, the results of WOSSR test\nin this context should be taken with much care and could\nbe misleading if M \u226a Tauto . If a large fluctuation from\nequilibrium value occurs at some point, its persistency in\nsign is fed by the positive correlations of adjacent points\nand this will drive the test to failure even if equilibrium\n\nwas actually achieved. Conversely, it is quite unlikely that\nthe test yields a positive answer on a sufficiently large\nset of running bins if equilibrium is not achieved, unless\ntwo accidentally large fluctuations of equal time size arise.\nTherefore, albeit not appropriate in principle, the WOSSR\ntest with M \u223c Tauto provides a fairly good indication of\nequilibrium.\nIn order to actually define an equilibrium point, and\nthereby a relaxation time Trel , we first calculate the arithmetic mean of the rightmost 50 (which is of the same order\nas of Tauto ) bin contents, which is taken as median Xm to\nbe fed in the test. The WOSSR test is then performed on\nsubsets of M = 10 running bins in the step hystogram\ntaking as starting bin the leftmost and moving rightward\nby one bin at a time. The test is regarded as successful\nif it yields a confidence level of at least 0.05 for a median\ndiffering from the previously defined Xm at most by 0.5%.\nIf the test is successful for 10 starting bins in a row, the\nfirst of those ten is taken to be the equilibrium point. Little variation of the equilibrium point is found by changing\nthe number of running bins from 5 to 20.\nHenceforth, we will use the observable overall multiplicity and WOSSR test to point out some important features of the Metropolis algorithm.\n7.1 Dependence on the integration method\nIt has been shown in Sect. 4 that the importance sampling\nintegration method benefits from drawing samples in the\nextended space of the variables:\nX\nNj (49)\n{N1 , . . . , NK |r1 , . . . , rN \u22121 }\nwith N =\nj\n\ninstead of calculating the integral in the r's for each channel {Nj } in Eq. (25) with a fixed (say 1000) number of\nMonte-Carlo samples. One could try to apply the same\nidea to the Metropolis algorithm: instead of making a random walk in the space of channels {Nj } and evaluating the\nweight of the channel at each step by performing a MonteCarlo integration of \u03a9{Nj } in Eq. (25), samples can be\ndrawn in the extended space of the above variables and\nevaluating the integrand function \u03a8 only one time at each\nstep, thus saving CPU time. However, the relaxation time\nTrel will be different in these two cases and most likely\nlonger in the extended space sampling case. This can be\neasily understood if the single \u03a8 evaluation is regarded\nas the extreme approximation of the integral in the r's in\nEq. (25) with NS = 1. This is shown indeed in fig. 17:\nthe convergence to the equilibrium speeds up if the number of samples used to estimate the integral in Eq. (25)\nincreases. A serious drawback of the extended space sampling, i.e. with NS = 1, is that the relaxation time may\nbecome so long that many bins of the multiplicity distribution look like having reached their stable asymptotic value\neven when they actually still slowly drift towards it. We\nhave checked this for the case shown in fig. 17 by pushing\nthe Metropolis random walk to 10000 steps, much beyond\nthe scale of the step hystogram. It has been found that\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nP2\n\nP6\n\n0.054\nNS=1\nNS=2\nNS=10\nNS=50\n\n0.052\n\n17\n\n0.65\n\n0.625\n0.6\n0.575\n0.55\n\n0.05\n\n0.525\n0\n\n1000\n\n2000\n\n3000\n\n4000\n\n5000\n\nStep\nP2\n\n0.048\n0.66\n0.64\n\n0.046\n\n0.62\n\n0.044\n0\n\n0.6\n\n20 40 60 80 100 120 140 160 180 200\n\nStep\n\nFig. 17. Step hystogram showing the convergence to equilibrium of the probability P6 of a channel with 6 primary hadrons\nas a function of the step in a set of 500000 Metropolis random\nwalks for different numbers of samples NS in the Monte-Carlo\nintegration of the phase space volume of each channel \u03a9{Nj }\nin Eq. (25). The horizontal solid line indicates the P6 value estimated with the importance sampling method and the dashed\nband its relevant statistical uncertainty. Cluster mass is 8 GeV,\nenergy density 0.4 GeV/fm3 and charges are free.\n\neven at such large number of steps, the asymptotic value,\ncalculated independently with the importance sampling\nmethod, is not attained, though the WOSSR test yields\na positive response, under most circumstances. This finding indicates that the use of Metropolis algorithm requires\nmore care than expected. At least a comparison between\nthe apparent asymptotic stable values with different number of samplings or a cross-check with independent calculations is necessary.\n7.2 Dependence on the updating rule\nIn order to show the effectiveness of the updating rule\nbased on randomly sampling the MPD, as discussed in\nSect. 4, we have compared it with a simpler updating rule\nbased on milder changes of the current configuration. This\nrule is as follows:\n1. Three probabilities \u03b70 , \u03b7+ and \u03b7\u2212 are chosen such that\n\u03b70 + \u03b7+ + \u03b7\u2212 = 1.\n2. A random extraction (0, +, \u2212) is made according to\nthe probability distribution defined by the \u03b7's.\n3. Depending on whether the outcome is 0, +, \u2212 the overall number of particles in the configuration is kept, is\nincreased by 1 unit or decreased by 1 unit respectively.\nIn the first case, a randomly chosen particle in the current configuration is replaced with one having a mass\n\n0.58\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\nStep\nFig. 18. Step hystogram showing the convergence to equilibrium of the probability P2 of channels with 2 hadrons as\na function of the step in a set of 100000 Metropolis random\nwalks for the updating rule based on the MPD (bottom) and\non a simpler method described in the text (top). Solid lines\nindicate the true value obtained by computing the phase space\nvolume of all of the channels. The cluster mass is 2 GeV, the\nenergy density 0.4 GeV/fm3 and charges are free. The number\nof samples used in the numerical integration of Eq. (25) was\nNS = 1000. For this comparison, resonances have been kept at\na fixed mass and quantum statistics terms in \u03a9{Nj } have been\nneglected.\n\njust above or below. In the second case, a new particle\nis randomly chosen among all possible species. In the\nthird case, a randomly chosen particle of the current\nconfiguration is removed.\n\nFor this updating rule, the proposal matrix T (m \u2192 n)\nhas been determined and optimal acceptance matrix set\naccordingly (see Eq. (42)).\nIndeed, this rule involves a slowing down of the convergence to equilibrium because the fraction of rejected\ntransitions is much higher than in the MPD-based updating rule. This is apparent in fig. 18 where the relevant step hystograms are shown for the multiplicity distribution bin with 2 particles for a 2 GeV mass cluster.\nWhilst in the MPD-based updating rule the equilibrium\nis achieved within few tens of steps, in the above rule stability is not achieved even after 3000 steps. Similar differences are found for heavier clusters. Therefore, the MPDbased updating rule is much more efficient with regard to\ncomputing time.\n\n\fTrel\n\n18\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nMetropolis calculations, the same modification of the sampling distribution put forward at the end of Sect. 4 to reduce statistical error in the importance sampling, could\nbe carried over here so as to speed up the convergence to\nequilibrium.\n\n250\n\nneutral cluster\n\n225\n\npp-like cluster\n200\n175\n\n7.4 Comparison with the importance sampling method\n\n150\n\nThe performances of importance sampling method and\nMetropolis algorithm have been compared by studying\nthe statistical error on the calculation of averages of several observables with the same computing resources. For a\nneutral cluster with 4 GeV mass and 0.4 GeV/fm3 energy\ndensity, we have calculated the total average multiplicity\nand the primary multiplicity distribution 100 times, each\ntime taking 100000 steps in both methods. As the sampled distribution at each step is the MPD in both cases,\nthe used CPU time is approximately the same. The function \u03a8 in Eq. (25) has been sampled one time per channel\nin both methods.\nAs an example, we show in fig. 20 the results obtained\nfor the estimate of the probability P5 of channels with 5\nprimary hadrons. It can be seen that the Metropolis algorithm gives rise to a broader statistical distribution of\nthe estimated values with respect to the importance sampling method. Moreover, the distribution is not gaussian\nand it is slightly asymmetric with also few cases of outranging estimates. On the other hand, the distributions\nfor the total average multiplicity look quite similar in the\ntwo methods. It is worth pointing out that the a priori\nstatistical error estimate obtained by using Eq. (18) for\nthe importance sampling method is about 0.008, in good\nagreement with the found RMS of 0.0087 quoted in fig.\n20.\nWe have not investigated in much detail the sources\nof such a different statistical resolution, but we surmise\nthat the ultimate reason of a larger error in Metropolis\nalgorithm is the extra call to the random number generator which, at each step, is possibly needed to accept\nor reject a proposed transition. Ultimately, this is an additional source of fluctuations in the Metropolis random\nwalk which is absent in the importance sampling method\nwhere each extracted configuration is simply reweighted.\nAltogether, the importance sampling method seems to be\nbetter performing to calculate averages in the microcanonical ensemble.\n\n125\n100\n75\n50\n25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\nM (GeV)\nFig. 19. Relaxation times in a Metropolis random walk (see\ntext for the definition) as a function of mass and charges of the\ncluster. Energy density is kept fixed at 0.4 GeV/fm3 . Lines are\ndrawn to guide the eye.\n\n7.3 Dependence on the cluster mass and charge\nWe have studied the dependence of Trel on the cluster\nmass and charges, at constant energy density, by applying the WOSSR tests to step hystograms of multiplicity\ndistribution Pn in different bins. For each mass and set of\ncharges we have taken the highest Trel among the bins for\nwhich Pn > 10\u22123 , as the relaxation time for that cluster.\nThis study has been carried out for completely neutral and\npp-like clusters; energy density has been kept constant at\n0.4 GeV/fm3 . For each cluster 500000 Metropolis random\nwalks (100000 for M = 10 GeV) have been performed up\nto 300 steps. The relaxation times are shown in fig. 19.\nThis just defined relaxation time shows an initial increase as a function of the cluster mass and drops thereafter going from 8 to 10 GeV. For the present, we do not\nhave a complete understanding of this behaviour. An increase as a function of the mass is expected because the\nnumber of channels sampled from the MPD whose weight\nis much larger than their correspoding microcanonical one\nincreases owing to the persistence of the shape difference\nbetween multiplicity distributions in the canonical and microcanonical ensemble (see figs. 12,13), as already mentioned in Sect. 5. The drop, as well as the observed difference between neutral and pp-like cluster, in the region\n8-10 GeV might be a genuine effect due to a local minimal\ndistance between MPD and microcanonical distributions\nor an artefact of the cut on probability at 10\u22123 . What it\nis important to remark is that the relaxation times are\nnot larger than O(100) in the region where microcanonical calculations are necessary. In order to further improve\n\n8 Conclusions\nWe have calculated averages in the microcanonical ensemble of the ideal hadron-resonance gas including all lightflavoured known resonances up to a mass of about 1.8\nGeV. We have found that microcanonical average multiplicities of different hadron species differ by less than\n10% from the corresponding canonical average (i.e. calculated by introducing a temperature) for clusters with\nrelatively low mass, around 8 GeV, and energy density of\n0.4 GeV/fm3 . This confirms and extends previous findings\n\n\fN/0.0024\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n14\n\nMetropolis\n\nHowever, the present study indicates that there is still\nroom for a further improvement of the efficiency of both\nexamined methods. An efficient way of calculating microcanonical ensemble opens the way to test the statistical\nhadronization model at low energy and with respect to\nmany more observables than those considered as yet.\n\nRMS=0.014\n\n12\n\n19\n\n10\n8\n6\n\nAcknowledgements\n\n4\n2\n0\n14\n\nImportance Sampling\nRMS=0.0087\n\n12\n10\n8\n6\n\nWe are grateful to J. Aichelin, T. Gabbriellini, M. Gorenstein, A. Ker\u00e4nen, K. Werner for useful discussions. This\nwork has been carried out within the INFN research project\nFI31.\n\nAppendix\n\n4\n2\n0\n0.24\n\nA Calculation of the phase space integrals\n0.26\n\n0.28\n\n0.3\n\n0.32\n\n0.34\n\n0.36\n\nP5\n\nFig. 20. Statistical distribution of the Monte-Carlo estimates\nof the probability P5 of channels with 5 primary hadrons, for\na neutral cluster with 4 GeV mass and 0.4 GeV/fm3 energy\ndensity.\n\n[8] obtained with a restricted sample of hadron species.\nHowever, multiplicity distributions in the two ensembles\nshow a clear difference in shape which seem to persist in\nthe thermodynamical limit. Particularly, the dispersion of\nthe total multiplicity distribution is, to a great accuracy,\n1/2 of the Poisson dispersion in the large volume limit;\npresently, we do not have any simple explanation of this\nfact and whether this is linked to our special choice of the\nenergy density.\nA major point of this study is concerned with the numerical methods developed to calculate microcanonical\naverages: an importance sampling method, which has been\nproposed and used in this work for the first time; and a\npreviously proposed Metropolis algorithm [7], whose performances have been improved by using as proposal matrix Poisson distributions with mean values set as those of\nthe grand-canonical ensemble. They have been also employed as sampled distributions in the importance sampling method.\nThe Metropolis algorithm is capable to provide single\nsamples of the microcanonical ensemble with unit weight\nand it is thus a suitable tool for event generation. Yet,\nit was proved to be less accurate than the importance\nsampling method for the calculation of averages for single clusters. Moreover, the Metropolis algorithm used for\nevent generation requires much care, particularly a preliminary study of how fast the equilibrium condition is\nachieved. The convergence to equilibrium may depend on\nthe observable to be analyzed and, more worrying, on the\nspecific integration methods to evaluate the microcanonical weights of the channels.\n\nHere we summarize a method to calculate phase space\nintegrals due to Hagedorn [9]. An analytical calculation of\n\u03a6 in Eq. (12) can be carried out for two or three particles\nwhilst for more particles the expressions get rapidly so\ncomplicated that a numerical computation is much more\nsuitable.\nFor two particles:\n4\u03c0p\u2217 \u01eb1 \u01eb2\n(A.1)\nT2 M\np\nwhere mi 's are the masses, \u01ebi = p\u22172 + m2i the energies,\nM the cluster's mass, T the total available kinetic energy\nand:\n\u0014\n\u0015 21\n1\n1\n2\n2\n2\n2\n2 2\n\u2217\n. (A.2)\nM \u2212 2(m1 + m2 ) + 2 (m1 \u2212 m2 )\np =\n2\nM\n\u03a6(M, m1 , m2 ) =\n\nFor N > 2 a function W of the momenta p1 , . . . , pN is\nintroduced:\nZ hY\nN\nN\ni\nX\n(4\u03c0)N\n\u01ebi ) W (p1 , . . . , pN )\ndpi p2i \u03b4(M \u2212\n\u03a6 = 3N \u22124\nT\ni=1\ni=1\n(A.3)\nThe function W reads:\n\u0015\nZ \u0014Y\nN\nN\nX\n1\n3\npi p\u0302i ) (A.4)\nW (p1 , . . . , pN ) =\n\u03b4\n(\nd\u03a9\ni\n(4\u03c0)N\ni=1\ni=1\nwhere p\u0302i = pi /pi , and can be calculated explicitely:\n1\nW (p1 , . . . , pN ) = \u2212 N +1\n2\n\u03c0(N \u2212 3)!p1 . . . pN\nX\nX\n\u0001N \u22123\n(A.5)\n\u03c3i pi\n\u00d7\n\u03c31 . . . \u03c3N\n{\u03c31 ...\u03c3N }\nP\n\u03c3j pj \u22650\n\ni\n\nwhere \u03c3 can be either +1 or \u22121. This expansion involves\na large number of terms even at relatively small N , so it is\n\n\f20\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nmore advantegeous under some circumstances, to calculate\nW differently. In fact, one can set in Eq. (A.4):\nN\nX\npi p\u0302i ) =\n\u03b43(\ni=1\n\n1\n(2\u03c0)3\n\nZ\n\nN\nX\n\u0003\n\u0002\npi p\u0302i * u (A.6)\nd3 u exp \u2212 \u0131\ni=1\n\nwhich leads to [7]:\nW (p1 , . . . , pN ) =\n\n1\n2\u03c0 2\n\nZ\n\n\u221e\n\ndu u2\n\n0\n\nN\nY\nsin(pi u)\n\ni=1\n\npi u\n\n(A.7)\n\nSetting now y = u\u03bc, where \u03bc is an arbitrary energy scale,\nto make integration variable adimensional:\n1\nW (p1 , . . . , pN ) =\n2\u03c0 2 \u03bc3\n=\n\n1\n2\u03c0 2 \u03bc3\n\nZ\n\n0\n\nZ\n\n0\n\n\u221e\n\ndy y 2\n\nN\nY\nsin[(pi /\u03bc)y]\n(pi /\u03bc)y\ni=1\n\u0011\n\u0010\np\n\n1\n\ndx\n\nx\ni\nN\n(1 \u2212 x)N \u22124 Y sin \u03bc 1\u2212x\nxN \u22122\npi /\u03bc\ni=1\n\n(A.8)\n\nwhere the last expression has been obtained by using the\nvariable transformation y = x/(1 \u2212 x). The last integral\ncan be calculated numerically provided that the number\nof particles is at least of the order of 10, otherwise the integrand function features strong oscillations which make\nmost numerical integration methods failing. In this case,\nit is compelling to calculate W by means of its full expansion (A.5). However, the CPU time needed to sum all of\nthe terms rapidly grows with N , so that for N > 10 it is\ndefinitely preferrable to switch to the numerical computation of the integral (A.8) (see also fig. 2). The arbitrary\nscale \u03bc can be set so as to obtain a good resolution in\nthe numerical computation of W and we have found that\n\u03bc = 1 GeV is an appropriate choice for most cases at the\nenergy densities we have been dealing with; if the number\nof momenta larger than 100 MeV is \u2264 10, we set \u03bc = 100\nMeV.\nIn order to minimize the CPU time spent to calculate W by using its full expansion (A.5) we have optimizedPthe loop over all combinations {\u03c31 , . . . , \u03c3N } such\nthat\n\u03c3j pj > 0 by considering only those which are relevant. The momenta p1 , . . . , pN are first sorted such that\np1 > p2 > . . . > pH and all possible N -uples made of +1\nor \u22121 are arranged in a multi-level tree structure shown\nin fig. 21 for the special case N = 4. If, for some N -uple\nP\nat some level H\nj=1 \u03c3j pj \u2264 0, the same is true for all N uples branching from it because of momentum sorting and\nof the tree structure, which is such that moving upwards\none level a change in sign (+ \u2192 \u2212) occurs. Note that\nreplica N -uples in fig. 21 are just meant to show the tree\nstructure, though they are in fact not considered in the\nactual loop.\nThe phase space integral in Eq. (A.3) is now transformed by means of a sequence of changes of integration\nvariable [7] pi \u2192 ti \u2192 si \u2192 xi \u2192 zi \u2192 ri . If ti denote the\nparticle kinetic energies and T the total available kinetic\n\nFig. 21. Tree diagram to calculate W with (A.5) for 4 particles.\n\nenergy:\np\ni = 1, . . . , N\npi = ti (ti + 2mi )\nti = si \u2212 si\u22121\ni = 1, . . . , N with s0 = 0 and sn = T\nsi\ni = 1, . . . , N \u2212 1\nxi =\nT\nxi\nzi =\ni = 1, . . . , N \u2212 1 with xN \u2261 1\nxi+1\nri = zii\n\ni = 1, . . . , N \u2212 1\n\n(A.9)\n\nAs a result of this sequence of transformations, the Dirac\ndelta of energy conservation in Eq. (A.3) is integrated\naway and the phase space integral reads:\nZ 1\nZ 1\ndrN \u22121 \u03a5 (r1 , . . . , rN \u22121 )\n(A.10)\ndr1 . . .\n\u03a6=\n0\n\n0\n\nwhere:\nN\n(4\u03c0)N T 3\u22122N Y\npi \u01ebi W (p1 , . . . , pN )\n(N \u2212 1)! i=1\n(A.11)\nand p1 , . . . , pN are to be calculated by going along the\ntransformations (A.9) for a given set (r1 , . . . , rN ). In the\nform (A.10) \u03a6 can be easily calculated by means of Monte\nCarlo integration.\n\n\u03a5 (r1 , . . . , rN \u22121 ) =\n\nB Error estimates for importance sampling\nWe have defined the best estimate of the mean value of the\nobservable O in Eq. (17). This estimator can be viewed as\na random variable because the channels {Nj } are random\nvariables whose distribution is \u03a0 in Eq. (20). Let us introduce the random variables \u03a9, O and \u03a0 taking values\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\n\u03a9{Nj } , O({Nj }) and \u03a0{Nj } respectively for a particular\nchannel {Nj }. The following relations involving expectation values hold:\n\u0012 \u0013\nX \u03a9{Nj }\n\u03a9\n=\n\u03a0{Nj } = \u03a9\nE\u03a0\n\u03a0\n\u03a0{Nj }\n{Nj }\n\u0013\n\u0012\nX\n\u03a9{Nj }\n\u03a9\nO({Nj })\n=\n\u03a0{Nj } = \u03a9hOi (B.1)\nE\u03a0 O\n\u03a0\n\u03a0{Nj }\n{Nj }\n\nwhere Eqs. (3) and (10) have been used. We can now write\nthe estimator random variable hOi from Eq. (17) as:\nPM\n\nk=1\n\nhOi =\n\n\u03a9k\n\u03a0k\n\u03a9k\n\u03a0k\n\nOk\n\nPM\n\nk=1\n\n(B.2)\n\nIf the number of events M is large enough the numerator and denominator in the right hand side are gaussianly distributed according to the central limit theorem\nand the variance \u03c3 2 (hOi) can be calculated by using the\nerror propagation formula:\n\u03c3 2 (hOi) = \u03c3 2 (N)\n\nThe estimator (17) is a biased one. This can be proved\nwriting Eq. (B.2) as hOi = N/D and:\n\u0012 \u0013\n\u0012 \u0013\n1\nN\n= E\u03a0 (N)E\u03a0\n+ cov(N, 1/D)\nE\u03a0\nD\nD\n\u0014\n\u0015\n1\ncov(N, D)\n\u03c3 2 (D)\n\u2243 E\u03a0 (N)\n\u2212\n(B.8)\n+\n3\nE\u03a0 (D) E\u03a0 (D)\nE\u03a0 (D)2\nusing the definition of covariance and expanding the function 1/D around its mean value. The bias B of the estimator (B.2) can then be written as:\n\u0012 \u0013\nN\n\u2212 hOi\nB \u2261 E\u03a0 (hOi) \u2212 hOi = E\u03a0\nD\n\u0012 2\u0013\n\u0012\n\u0014\n\u0013\u0015\n1\n\u03a92\n\u03a9\n\u2243\nO\nhOiE\n\u2212\nE\n(B.9)\n\u03a0\n\u03a0\nM \u03a92\n\u03a02\n\u03a02\nby using Eqs. (B.8),(B.6),(B.4).\nEstimates of the bias (B.9) and the variance (B.7) can\nbe obtained by replacing in Eq. (B.7) the expectation values with arithmetic means:\nE\u03a0 \u2192\n\n2\n\nN\nN\n1\n+ \u03c3 2 (D) 4 \u2212 2cov(N, D) 3 (B.3)\nD2\nD\nD\n\nwhere N and D are the numerator and the denominator in\nEq. (B.2), and N and D their expectation values E\u03a0 (N)\nand E\u03a0 (D) respectively. Because of Eq. (B.1):\nN \u2261 E\u03a0 (N) = M \u03a9hOi\n\nD \u2261 E\u03a0 (D) = M \u03a9\n\n(B.4)\n\nThus, by using Eq. (B.4) and the general variance definitions:\n2\n\n2\n\n\u03c3(x) = E(x ) \u2212 E(x)\ncov(x, y) = E(xy) \u2212 E(x)E(y)\n\n(B.5)\n\nwe obtain:\n\u0012\n\u0015\n\u0014\n\u0013\n2\n1\n1\n2\u03a9\n2 2\nO\nE\n\u2212\nhOi\n\u03a9\n=\n\u03a0\nD2\nM \u03a92\n\u03a02\n\u0012\n\u0015\n\u0014\n\u0013\nN2\n\u03a92\nhOi2\n2\n\u03c3 2 (D) 4 =\nE\n\u2212\n\u03a9\n\u03a0\nD\nM \u03a92\n\u03a02\n\u0012\n\u0015\n\u0014\n\u0013\n\u03a92\nhOi\nN\n2\nO\n(B.6)\nE\n\u2212\nhOi\u03a9\ncov(N, D) 3 =\n\u03a0\nD\nM \u03a92\n\u03a02\n\n21\n\nM\n1 X\nM\n\n(B.10)\n\nk=1\n\nwhile hOi can be estimated through Eq. (17) and the best\nestimate of \u03a9 is, according to Eq. (B.1):\n\u03a9 = E\u03a0\n\n(k)\n\u0012 \u0013\nM\n\u03a9 . 1 X \u03a9{Nj }\n=\n(k)\n\u03a0\nM\nk=1 \u03a0{Nj }\n\n(B.11)\n\nThe estimator (17) could be corrected for the bias by subtracting the estimate of (B.9). However, the bias (B.9) is\nproportional to 1/M unlike the statistical error \u03c3hOi de\u221a\ncreasing like 1/ M and, thus, becomes negligible with\nrespect to the statistical error for a large number of samplings.\n\n\u03c3 2 (N)\n\nTherefore Eq. (B.3) can be rewritten as:\n(\u0014\n\u0012\n\u0015\n\u0013\n2\n1\n2\n2\u03a9\n2 2\n\u03c3 (hOi) =\nE\u03a0 O 2 \u2212 hOi \u03a9\nM \u03a92\n\u03a0\n\u0015\n\u0012 2\u0013\n\u0014\n\u03a9\n2\n2\n\u2212\u03a9\n+ hOi E\u03a0\n\u03a02\n\u0015)\n\u0012\n\u0013\n\u0014\n\u03a92\n2\n(B.7)\n\u2212 2hOi E\u03a0 O 2 \u2212 hOi\u03a9\n\u03a0\nwhich is essentially the Eq. (18).\n\nC Multiplicity distribution in the canonical\nensemble\nThe multi-species multiplicity distribution in the canonical ensemble with internal abelian charges Q, can be\nobtained from the generating function associated to the\ncanonical partition function Z(Q). The probability of a\nsingle state in the canonical ensemble reads:\nPstate =\n\n1\ne\u2212Estate /T \u03b4Qstate ,Q\nZ(Q)\n\n(C.1)\n\nand the generating function:\nG(\u03bb1 , . . . , \u03bbK ) =\n\nK\nX\nY\n1\nN\n\u03bbj j state\ne\u2212Estate /T \u03b4Qstate ,Q\nZ(Q) states\nj=1\n\n(C.2)\n\n\f22\n\nF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nwhere K is the number of hadron species and Nj state the\nnumber of hadrons of species j in the state. The generating function can be worked out by Fourier expanding the\nKronecker delta in Eq. (C.1) [5,6]:\n\u0014\nZ \u03c0\n1\n1\nM\n\u0131Q*\u03c6\nd \u03c6e\nexp\nG(\u03bb1 , . . . , \u03bbK ) =\nZ(Q) (2\u03c0)M \u2212\u03c0\n\u0015\nZ\nK\n\u221a\nX\n(2Jj + 1)V\n\u2212 p2 +m2j /T \u2212\u0131qj *\u03c6 \u00b11\n3\n)\nd p log(1 \u00b1 \u03bbj e\n(2\u03c0)3\nj=1\n\n(C.3)\n\nwhere the upper sign applies to fermions, the lower to\nbosons.\nAccording to Eqs. (C.1) and (C.2), the probability of\na given n-tuple of hadrons {Nj }, that is the multi-species\nmultiplicity distribution, can be obtained by integrating\nthe generating function over the unitary circle in the complex \u03bbj planes:\n\u0014Y\nK\n\nP ({Nj }) =\n\nj=1\n\n1\n2\u03c0\u0131\n\nI\n\nd\u03bbj\nNj\n\n\u03bbj\n\n\u0015\n\nn\nz\n\u03bb j\nnj +1 j(nj ) j\n\n(\u22131)\n\nnj\n\nnj =1\n\n=\n\n\u221e\nY\n\nexp (\u22131)\n\nnj =1\n\n=\n\nn\nz\n\u03bb j\nnj +1 j(nj ) j\n\n\"\n\n\u221e\n\u221e\nY\nX\n\nnj\n\n(\u22131)\n\nnj =1 hnj =0\n\n=\n\n\u221e\nX\n\n\u221e\nY\n\nhn1 =0 nj =1\n\n..\n.\n\n(\u22131)\n\nP\n\nnj\n\nhn j\n\nY zj(njj )\nnj\n\nhn j\n\nnj\n\n(C.7)\n\nhnj !\n\nwhere {hnj } indicates the set of partitions (in the multiplicity\nof the integers Nj , i.e. integers such\nPrepresentation)\n\u221e\nthat nj =1 nj hnj = Nj . The nj and hj indices actually\nP\nrun from 1 to Nj . Defining nj hnj = Hj and restoring\nthe Kronecker delta, one can rewrite Eq. (C.5) by using\nthe expression of derivatives in Eq. (C.7) as:\nP ({Nj }) =\n\u00d7\n\n\"\n\nK X\nY\n\n1\nZ(Q)\nhn\n\n(\u22131)Nj +Hj\n\nY zj(njj )\nnj\n\nj=1 {hnj }\n\nhn j\n\nnj\n\nhnj !\n\n#\n\n\u03b4Q,P j Nj qj (C.8)\n\ne\n\n\u2212nj \u0131qj *\u03c6\n\n#\n\nhn\nnj j hnj !\n\nhn j\n\nnj\n\ne\u2212nj hnj \u0131qj *\u03c6\n\n\u03c3 2 (hOi) = E(hOi2 ) \u2212 hOi2 = E \uf8f0\n\nPM\n\n(k)\nk=1 O\nM\n\n!2 \uf8f9\n\uf8fb \u2212 hOi2\n\n(D.1)\n\nThence:\nPM\n\n(k)\nk=1 O\nM\n\n!2 \uf8f9\n\n\uf8fb=\n\nM\n1 X\n2 X\nE(O(k)2 ) + 2\nE(O(k) O(i) )\n2\nM\nM\nk=1\nk<i\nX\n2\n1\nE(O2 ) + 2\n=\nE(O(k) O(i) )\nM\nM\nk<i\n\n=\n\nnj hnj\n\nzj(njj ) \u03bbj\n\n\uf8ee\n\n=\n\nnj hnj\n\nzj(njj ) \u03bbj\n\nAn estimator of the mean value of the observable O in a\nM -steps Metropolis random walk has been defined in Eq.\n(44). As well as for the importance sampling method, this\nestimator can be viewed as a random variable hOi and so\nthe values of the observables at each step O(k) . Therefore:\n\nE\uf8f0\n\ne\u2212nj \u0131qj *\u03c6 \uf8fb\n\nhn\n\n(\u22131)(nj +1)hnj\n\nNj +\n\n{hnj }\n\n\uf8ee\n\n\uf8f9\n\nhn\n\n(nj +1)hnj\n\nNj ! e\n\nX\n\nD Error estimates for Metropolis algorithm\n\nwhere zj(n) is as in Eq. (35). Now the exponential in Eq.\n(C.5) is expanded:\n\nexp \uf8f0\n\nhn\n\n\u2212Nj \u0131qj *\u03c6\n\n(C.4)\n\n(C.5)\n\n\u221e\nX\n\nnj =1 nj hnj = Nj . Therefore, the last series in Eq. (C.6)\ngives rise to:\n\nwhich is Eq. (34).\nG(\u03bb1 , . . . , \u03bbK )\n\nPlugging Eq. (C.3) in the (C.4) and using the residual\ntheorem, one obtains:\nZ \u03c0\n1 1\ndM \u03c6 e\u0131Q*\u03c6\nP ({Nj }) =\nZ (2\u03c0)M \u2212\u03c0\n\u0014X\n\u0015\nn\n\u221e\nK\nY\nz\n\u03bb j \u2212nj \u0131qj *\u03c6\n1 \u2202 Nj\nnj +1 j(nj ) j\nexp\n(\u22131)\ne\nj\nNj ! \u2202\u03bbN\nnj\nnj =1\nj=1\nj\n\u03bb=0\n\n\uf8ee\n\nP\u221e\n\ne\u2212nj hnj \u0131qj *\u03c6\n\nhnj !\n\nhnK =0\n\n(C.6)\nTaking the derivatives of the latter expression with respect to the \u03bbj 's in \u03bbj = 0 according to Eq. (C.5), one\nis left with non vanishing terms in the above equation if\n\nM M\u2212k\n2 X X\n1\nE(O2 ) + 2\nA(l) + hOi2\nM\nM\n\n(D.2)\n\nk=1 l=1\n\nwhere A is the autocorrelation function. We can then\nwrite:\n\uf8ee\n!2 \uf8f9\nPM\n(k)\nk=1 O\n\uf8fb=\nE\uf8f0\nM\n=\n\nM M\u2212k\nE(O2 ) M \u2212 1\n2 XX\n+\nhOi2 + 2\nA(l) (D.3)\nM\nM\nM\nk=1 l=1\n\n\fF. Becattini, L. Ferroni: Statistical hadronization and hadronic microcanonical ensemble II\n\nIf M \u226b Tauto , we can approximate the inner sum in Eq.\n(D.3) with the integral of the autocorrelation function R\ndefined as:\n\u221e\nX\nA(l)\n(D.4)\nR=\nl=1\n\nand rewrite an approximate expression for Eq. (D.3) as:\n\uf8ee\n!2 \uf8f9\nPM\n(k)\n2\nk=1 O\n\uf8fb \u2243 E(O ) + M \u2212 1 hOi2 +2 R (D.5)\nE\uf8f0\nM\nM\nM\nM\n\nTherefore, Eq. (D.1) becomes:\n\u03c3 2 (hOi) =\n\nhO2 i \u2212 hOi2 + 2R\nM\n\n(D.6)\n\nwhich proves Eq. (45).\n\nReferences\n1. J. Bernstein, R. Dashen, S. Ma, Phys. Rev. 187 (1969) 1.\n2. R. Hagedorn, CERN lectures Thermodynamics of strong\ninteractions (1970); R. Hagedorn, CERN-TH 7190/94, in\nHot Hadronic Matter (1994) 13.\n3. F. Becattini, L. Ferroni, Eur. Phys. J. C 35 (2004) 243.\n4. F. Becattini, Z. Phys. C 69 (1996) 485.\n5. F. Becattini, U. Heinz, Z. Phys. C 76 (1997) 269.\n6. F. Becattini, G. Passaleva, Eur. Phys. J. C 23 (2002) 551.\n7. K. Werner, J. Aichelin, Phys. Rev. C 52 (1995) 1584.\n8. F. M. Liu et al., Phys. Rev. C 69 (2004) 054002.\n9. F. Cerulus and R. Hagedorn, Suppl. N. Cim. IX, serie X,\nvol. 2 (1958) 646.\n10. F. Cerulus and R. Hagedorn, Suppl. N. Cim. IX, serie X,\nvol. 2 (1958) 659.\n11. F. Becattini, Nucl. Phys. A 702 (2002) 336 and references\ntherein.\n12. K. Hagiwara et al., Phys. Rev. D 66 (2002) 010001.\n13. V. V. Begun et al., nucl-th 0404056; M. Gorenstein and O.\nS. Zozulya, private communication.\n14. F. Becattini, M. Gazdzicki, A. Keranen, J. Manninen, R.\nStock, Phys. Rev. C 69 (2004) 024905.\n15. N. Metropolis et al., J. Chem. Phys. 21 (1953) 1087.\n16. C. J. Umrigar in Quantum Monte-Carlo Methods in\nPhysics and Chemistry p. 129, eds. M. P. Nightingale\nand C.J.Umrigar, NATO ASI Series, Series C, Vol C-525,\nKluwer Academic Publishers, Boston, 1999; C. J. Umrigar,\nPhys. Rev. Lett. 71 408 (1993).\n\n23\n\n\f"}