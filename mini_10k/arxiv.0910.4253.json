{"id": "http://arxiv.org/abs/0910.4253v2", "guidislink": true, "updated": "2010-01-22T14:47:46Z", "updated_parsed": [2010, 1, 22, 14, 47, 46, 4, 22, 0], "published": "2009-10-22T17:18:15Z", "published_parsed": [2009, 10, 22, 17, 18, 15, 3, 295, 0], "title": "Mean-field methods in evolutionary duplication-innovation-loss models\n  for the genome-level repertoire of protein domains", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0910.0194%2C0910.1726%2C0910.4694%2C0910.1870%2C0910.3130%2C0910.2296%2C0910.5584%2C0910.2806%2C0910.1760%2C0910.4822%2C0910.5282%2C0910.1737%2C0910.1465%2C0910.0046%2C0910.5919%2C0910.4956%2C0910.2392%2C0910.2259%2C0910.3188%2C0910.4253%2C0910.3524%2C0910.0485%2C0910.4682%2C0910.4277%2C0910.1843%2C0910.5103%2C0910.4578%2C0910.0986%2C0910.4423%2C0910.5656%2C0910.1027%2C0910.1062%2C0910.3490%2C0910.5034%2C0910.0991%2C0910.5595%2C0910.0169%2C0910.3968%2C0910.3209%2C0910.5745%2C0910.0175%2C0910.1319%2C0910.2247%2C0910.5284%2C0910.0227%2C0910.0209%2C0910.0446%2C0910.2277%2C0910.1089%2C0910.1154%2C0910.3607%2C0910.0694%2C0910.3046%2C0910.3745%2C0910.5231%2C0910.1094%2C0910.2406%2C0910.4376%2C0910.2792%2C0910.1532%2C0910.4276%2C0910.3040%2C0910.2520%2C0910.2582%2C0910.4111%2C0910.4479%2C0910.4334%2C0910.3433%2C0910.4142%2C0910.1897%2C0910.3165%2C0910.2749%2C0910.1847%2C0910.1110%2C0910.4191%2C0910.5725%2C0910.0939%2C0910.4315%2C0910.5604%2C0910.0120%2C0910.2312%2C0910.5451%2C0910.5360%2C0910.2012%2C0910.4945%2C0910.4294%2C0910.0613%2C0910.0615%2C0910.2642%2C0910.3977%2C0910.5632%2C0910.4851%2C0910.1012%2C0910.0255%2C0910.4216%2C0910.4403%2C0910.3168%2C0910.3865%2C0910.1463%2C0910.3047%2C0910.0507&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Mean-field methods in evolutionary duplication-innovation-loss models\n  for the genome-level repertoire of protein domains"}, "summary": "We present a combined mean-field and simulation approach to different models\ndescribing the dynamics of classes formed by elements that can appear,\ndisappear or copy themselves. These models, related to a paradigm\nduplication-innovation model known as Chinese Restaurant Process, are devised\nto reproduce the scaling behavior observed in the genome-wide repertoire of\nprotein domains of all known species. In view of these data, we discuss the\nqualitative and quantitative differences of the alternative model formulations,\nfocusing in particular on the roles of element loss and of the specificity of\nempirical domain classes.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0910.0194%2C0910.1726%2C0910.4694%2C0910.1870%2C0910.3130%2C0910.2296%2C0910.5584%2C0910.2806%2C0910.1760%2C0910.4822%2C0910.5282%2C0910.1737%2C0910.1465%2C0910.0046%2C0910.5919%2C0910.4956%2C0910.2392%2C0910.2259%2C0910.3188%2C0910.4253%2C0910.3524%2C0910.0485%2C0910.4682%2C0910.4277%2C0910.1843%2C0910.5103%2C0910.4578%2C0910.0986%2C0910.4423%2C0910.5656%2C0910.1027%2C0910.1062%2C0910.3490%2C0910.5034%2C0910.0991%2C0910.5595%2C0910.0169%2C0910.3968%2C0910.3209%2C0910.5745%2C0910.0175%2C0910.1319%2C0910.2247%2C0910.5284%2C0910.0227%2C0910.0209%2C0910.0446%2C0910.2277%2C0910.1089%2C0910.1154%2C0910.3607%2C0910.0694%2C0910.3046%2C0910.3745%2C0910.5231%2C0910.1094%2C0910.2406%2C0910.4376%2C0910.2792%2C0910.1532%2C0910.4276%2C0910.3040%2C0910.2520%2C0910.2582%2C0910.4111%2C0910.4479%2C0910.4334%2C0910.3433%2C0910.4142%2C0910.1897%2C0910.3165%2C0910.2749%2C0910.1847%2C0910.1110%2C0910.4191%2C0910.5725%2C0910.0939%2C0910.4315%2C0910.5604%2C0910.0120%2C0910.2312%2C0910.5451%2C0910.5360%2C0910.2012%2C0910.4945%2C0910.4294%2C0910.0613%2C0910.0615%2C0910.2642%2C0910.3977%2C0910.5632%2C0910.4851%2C0910.1012%2C0910.0255%2C0910.4216%2C0910.4403%2C0910.3168%2C0910.3865%2C0910.1463%2C0910.3047%2C0910.0507&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a combined mean-field and simulation approach to different models\ndescribing the dynamics of classes formed by elements that can appear,\ndisappear or copy themselves. These models, related to a paradigm\nduplication-innovation model known as Chinese Restaurant Process, are devised\nto reproduce the scaling behavior observed in the genome-wide repertoire of\nprotein domains of all known species. In view of these data, we discuss the\nqualitative and quantitative differences of the alternative model formulations,\nfocusing in particular on the roles of element loss and of the specificity of\nempirical domain classes."}, "authors": ["A. Angelini", "A. Amato", "G. Bianconi", "B. Bassetti", "M. Cosentino Lagomarsino"], "author_detail": {"name": "M. Cosentino Lagomarsino"}, "author": "M. Cosentino Lagomarsino", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevE.81.021919", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0910.4253v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0910.4253v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "10 Figures, 2 Tables", "arxiv_primary_category": {"term": "q-bio.GN", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-bio.GN", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-bio.QM", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0910.4253v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0910.4253v2", "journal_reference": null, "doi": "10.1103/PhysRevE.81.021919", "fulltext": "Mean-field methods in evolutionary duplication-innovation-loss models for the\ngenome-level repertoire of protein domains\nA. Angelini,1 A. Amato,1 G. Bianconi,2 B. Bassetti,1 and M. Cosentino Lagomarsino1\n1\n\nUniversit\u00e0 degli Studi di Milano, Dip. Fisica. Via Celoria 16, 20133 Milano, Italy\n2\n\nPhysics Department, Northeastern University, 111 Forsyth St.,\n111 Dana Research Center, Boston 02115, MA, USA\n(Dated: November 15, 2018)\n\nWe present a combined mean-field and simulation approach to different models describing the dy-\n\narXiv:0910.4253v2 [q-bio.GN] 22 Jan 2010\n\nnamics of classes formed by elements that can appear, disappear or copy themselves. These models,\nrelated to a paradigm duplication-innovation model known as Chinese Restaurant Process, are devised to reproduce the scaling behavior observed in the genome-wide repertoire of protein domains\nof all known species. In view of these data, we discuss the qualitative and quantitative differences\nof the alternative model formulations, focusing in particular on the roles of element loss and of the\nspecificity of empirical domain classes.\n\nI.\n\nINTRODUCTION\n\nUnderstanding the complexity of genomes and the drives that shape them is a fundamental problem\nof contemporary biology [1], which poses a number of challenges to contemporary statistical mechanics.\nConsidering this problem from a large-scale viewpoint, the basic observables to account for are the distributions of the different \"functional components\" (such as genes, introns, non-coding RNA, etc.) encoded\nby sequenced genomes of varying size.\nWhen these genome-wide data are parametrized by measures of \"genome size\" (such as the number of\nbases or the number of genes in a genome), there are important emerging \"scaling laws\" both for the classes\nof evolutionary related genes [2\u20134], the functional categories of genes [5, 6] and some non-coding parts of\ngenomes [7]. These scaling laws are the signs of universal invariants in the processes and constraints that\ngave rise to the genomes as they can be observed today. A current challenge is the understanding of these\nlaws using physical modeling concepts and the comparison of the models to the available whole-genome\ndata. This effort can help disentangle neutral from selective effects [8, 9].\nHere we consider the statistical features of the set of proteins expressed by a genome, or proteome. A\nconvenient level of analysis is a description of the proteome in terms of structural protein domains [10].\nDomains are modular \"topologies\", or sub-shapes, forming proteins [11]. A domain determines a set of potential biochemical or biophysical functions and interactions for a protein, such as binding to other proteins\n\n\f2\nor DNA and participation in well-defined classes of biochemical reactions [6, 10]. Despite the practically\nunlimited number of possible protein sequences, the repertoire of basic topologies for domains seems to be\nrelatively small [12]. With a loose parallel, domains could be seen as an \"alphabet\" of basic elements of the\nprotein universe. Understanding the usage of domains across organisms is as important and challenging as\ndecoding an unknown language.\nThe content of a genome is determined primarily by its evolutionary history, in which neutral processes\nand natural selection play interdependent roles. In particular, the coding parts of genomes evolve by some\nwell-defined basic \"moves\": gene loss, gene duplication, horizontal gene transfer (the transfer of genetic\nmaterial between unrelated species), and gene genesis (the de novo origin of genes). Since domains are\nmodular evolutionary building blocks for proteins, they are coupled to the dynamics followed by genes.\nIn particular, a new domain topology can emerge by genesis or horizontal transfer, and new domains of\nexisting domain topologies can emerge by duplication or be lost. Finally, topologies can be completely lost\nby a genome if the last domain that carries them is lost (see Fig. 1).\nLarge-scale data concerning structural domains are available from bioinformatic databases, and can be\nanalyzed at the genome level. These coarse-grained data structures can be represented as sets of \"domain\nclasses\" (the sets of all realizations of the same domain topology in proteins), populated by domain realizations. In particular, much attention has been drawn by the intriguing discovery that the population\nof domain classes have power-law distributions [13\u201317]: the number F (j, n) of domain classes having j\nmembers follows the power-law \u223c 1/j z , where the exponent z typically lies between 1 and 2. An interesting thread of modeling work ascribes the emergence of power-laws to a generic preferential-attachment\nprinciple due to gene duplication. Growth models are formulated as nonstationary, duplication-innovation\nmodels [13, 18, 19] and as stationary birth-death-innovation models [14, 20\u201322].\nIntriguingly, as we have recently shown [23], the domain content of genomes also exhibits scaling laws\nas a function of the total number of domains n, indicating that even evolutionarily distant genomes show\ncommon trends where the relevant parameter is their size.\n(i) The number of domain classes (or distinct hits of the same domain) concentrates around a master\ncurve F (n) that appears to be markedly sublinear with size, perhaps saturating.\n(ii) The fitted exponent of the power-law-like distribution F (j, n) of domain classes having j members,\nin a proteome of size n decreases with genome size. In other words, there is evidence for a cutoff\nthat increases linearly with n.\n(iii) The occurrence of fold topologies across genomes is highly inhomogeneous - some domain superfamilies are found in all genomes, some rare, with a sigmoid-like drop between these two cate-\n\n\f3\ngories [35].\nWe recently reported the above collective trends, and showed how the scaling laws in the data could be\nreproduced using universal parameters with non-stationary duplication-innovation models. Our results indicate that the basic evolutionary moves themselves can determine the observed scaling behavior of domain\ncontent, a priori of more specific biological trends.\nThis modeling approach, while similar in formulation to that of previous investigators [13] who did not\nconsider these scaling laws, has important modifications, mostly related to the scaling with n of the relative\nprobability of adding a domain belonging to a new class and duplicating an existing one. To reproduce the\nobserved trends, newly added domain classes cannot be treated as independent random variables, but are\nconditioned by the preexisting proteome structure.\nIn this paper, we give a detailed account of this modeling approach, considering different variants of\nduplication-innovation-loss models for protein domains, and relate them to available results in the mathematical and physical literature. In particular, we will focus on mean-field approaches for the models and\ncomparison with direct simulation, and we will show how they can be generally used to obtain the main\nqualitative and quantitative trends.\nThe first part of the paper is devoted to the minimal model formulation, which only includes duplication\nand innovation moves for domains, and relates to the so-called Chinese Restaurant Process (CRP) of the\nmathematical literature [24, 25]. We will review the main known results for this model, derive analytically\nsolvable mean-field equations, and show how they compare to the available rigorous results and the finite\nsize behavior.\nThe rest of the paper is devoted to biologically motivated variants of the main model related to two\nmain features: including the role of loss of domains, which is a frequently reported event, and breaking the\nexchange symmetry of domain classes, which is unrealistic, as specific protein domains perform different\nbiological functions. For these variants, we will present mean-field and simulations results, and characterize\ntheir phenomenology in relation with empirical data. In particular, while in general for these variants the\nrigorous mathematical results existing for the CRP break down, we will show how the use of simple meanfield methods proves to be a robust tool for accessing the qualitative phenomenology.\n\n\f4\nII.\n\nGENERIC FEATURES OF THE MODEL\n\nThe model represents a proteome through its repertoire of domains. Domains having the same topology\nare collected in domain classes (Fig. 1). Thus the relevant data structures are partitions of elements (domains) into classes. The basic observables considered are the following: n, the total number of domains,\nf (n), a random variable indicating the number of classes (distinct domain topologies) at size n, a random\nvariable ki , the population of class i, ni , the size at birth of class i, and f (j, n): the number of domain\nclasses having j members. We will generally indicate mean values by capitalized letters (e.g. F (n) is the\nmean value of f (n), Ki the mean value of ki , etc.).\nThe model is conceived as a stochastic process based on the elementary moves available to a genome\n(Fig. 1) of adding and losing domains, associated to relative probabilities: pO , the probability to duplicate\nan old domain (modeling gene duplication), pN , the probability to add a new domain class with one member\n(which describes domain innovation, for example by horizontal transfer), and pL , a loss probability (which\nwe will initially disregard, and consider in a second step). Iteratively, either a domain is added or it is lost\nwith the prescribed probabilities.\nAn important feature of the duplication move is the (null) hypothesis that duplication of a domain has\nuniform probability along the genome, and thus it is more probable to pick a domain of a larger class. This\nis a common feature with previous models [13]. This hypothesis creates a \"preferential attachment\" [26]\nprinciple, stating the fact that duplication is more likely in a larger domain class, which, in this model as in\nprevious ones, is responsible for the emergence of power-law distributions.\nIn mathematical terms, if the duplication probability is split as the sum of per-class probabilities piO ,\nthis hypothesis requires that piO \u221d ki , where ki is the population of class i, i.e. the probability of finding a\ndomain of a particular class and duplicating it is proportional to the number of members of that class.\nIt is important to notice that in this model, while n can be used as an arbitrary measure of time, the ratio\nof the time-scales of duplication and innovation is not arbitrary, and is set by the ratio pN /pO . In the model\nof Gerstein and coworkers, this is taken as a constant, as the innovation move considered to be statistically\nindependent from the genome content. In particular, both probabilities are considered to be constant. This\nchoice has two problems. First, it cannot give the observed sublinear scaling of F (n). Indeed, if the\nprobability of adding a new domain is constant with n, so will be the rate of addition, implying that this\nquantity will increase on average linearly with genome size. Moreover, the same model gives power-law\ndistributions for the classes with exponent larger than two, in contrast with most of the available data.\nPrevious investigators did not consider the fact that genomes cluster around a common curve [23], and\nthought of each of them as coming from an independent stochastic process with different parameters [13].\n\n\f5\n\nCoarse-grained view of a proteome:\nn domains\n\nF domain\nclasses\n\n3\n\n2\n\n3\n\n2\n\n1\n\n2\n\ni.Duplication of an existing domain\n\nii.Innovation, genesis or transfer of a domain\nPossible moves:\niii.Loss of an existing domain\n\nFIG. 1: (Color online) Scheme of the generic features of the duplication-innovation-loss model. Top: The sequences\nof proteins coded by a genome can be broken down into domains, represented by colored boxes. All the boxes of\nthe same color, representing domains with the same topology are collected in the same domain class. Bottom: basic\nmoves. Elements of a class can be duplicated or lost, and new classes can be formed with prescribed probabilities.\n\nFurthermore, choosing constant pN implies that for larger genomes the influx of new domain families is\nheavily dominant on the flux of duplicated domains.\nAs noted by Durrett and Schweinsberg [19], constant pN makes sense only if one thinks that new fold\ntopologies emerge from an internal \"nucleation-like\" process with constant rate, rather than from an external\nflux. This process could be pictured as the genesis of new topologies from sequence mutation. Empirically,\nwhile genesis events are reported [27] and must occur, it is clear that domain topologies are very stable, and\nthe exploration of sequence space is not free, but conditioned by a number of additional important factors,\nincluding chromosomal position and expression patterns of genes, and their role in biological networks [28].\nMoreover, in prokaryotes, it is known that a large contribution to the innovation of coding genomes is\nprovided by horizontal gene transfer [27], the exchange of genetic material between species, which can\nbe reasonably represented in a model as an external flux, as opposed to the internal nucleation process\nrepresenting genesis.\nFor eukaryotes, horizontal gene transfer is less important, and there can be multiple relevant innovation\n\n\f6\nprocesses including exonization, loss of exons, alternative start sites changing the protein. We have not\nattempted to model the detailed processes leading to innovation, and because of their higher complexity in\neukaryotes, we prefer to compare the model to the prokaryote data set alone. However, we can point out that\nin principle the same model has good agreement with the set of prokaryotes and eukaryotes together [23].\nIn eukaryotes, the change in number of classes with respect to size change is generally small, but seems to\nhave a trend that \"glues\" quite well with prokaryotes (and in particular, innovation decreases with size).\nMotivated by the sublinear scaling of the number of domain classes, and taking into account in an\neffective way the role of processes that condition the addition of new domain topologies, we consider\nstatistically dependent moves. On general grounds, if a genome is a complex system where sub-components\ninteract in clusters and non-locally, domain topologies as well have to be coordinated with other parts of the\nsystem, so that it is reasonable that evolutionary moves are conditioned by what is already present, and that\nthe actual number of domain topologies need not to be trivially an extensive quantity.\nThe simplest way to implement this choice is to concentrate on the innovation process. Let us consider\nthe indicator \u03be(n), taking value 1 if a new domain class is born at size n, and value 0 otherwise. The\nnumber of classes at size n will be f (n) =\n\nP\n\nj\u2264n \u03be(j).\n\nIf the random variables \u03be(n) are independent and\n\nidentically distributed, i.e. p(\u03be(n) = 1) = pN =constant, f (n) follows a Bernoulli distribution whose mean\nvalue is linear in n. Moreover,\n\nf (n)\nn\n\nwill be increasingly concentrated with increasing n on the deterministic\n\nvalue pN . If vice versa the random variables \u03be(n) are statistically dependent or also simply not identically\ndistributed, the mean value may not be linear in n, and the concentration phenomenon may not occur.\nBoth features, dependence and lack of concentration, are important. The former is necessary to obtain\nthe observed sublinear behavior, the latter might create an intrinsic \"diversity\" in the genome ensemble,\nindependently on the finite size of observed genomes (however, the currently available data are insufficient\nto establish this empirically).\n\nIII.\n\nSIMPLEST FORMULATION: CHINESE RESTAURANT PROCESS\n\nWe investigate this process using analytical asymptotic equations and simulations. We start by considering only growth moves, by duplication and innovation, postponing the inclusion of domain loss in the\nmodel. We will see that the resulting model contains the basic qualitative phenomenology of the scaling\nlaws and can thus be regarded as the paradigmatic case. One can arrive at the defining equations with different arguments. A simple way is to assume that domain duplication is a rare event, described by a Poisson\ndistribution with characteristic time \u03c4 , during which there is a flux of external or new domain topologies\n\u03b8\n\u03c4.\n\nThen pN =\n\n\u03b8\nn+\u03b8 .\n\nIn this case the variables \u03be(n) are independent but not identically distributed. It is\n\n\f7\nimmediate to verify that f (n) has mean value given by\n\nPn\n\n\u03b8\nj=1 \u03b8+j\n\nand thus grows as \u223c \u03b8 log n. The same\n\nresult can be obtained by thinking of domain addition as a dependent move, conditioned on n, f (n) or both.\nIt is possible to consider different intermediate scenarios where the pool of old domain classes is in\ncompetition with the universe explorable by the new classes. The simplest scheme, which turns out to be\nquite general, can be obtained by choosing the conditional probability that a new class is born (\u03be(n+1) = 1)\ngiven the fact that f (n) = f at size n\npN =\n\n\u03b8 + \u03b1f\n,\nn+\u03b8\n\n(1)\n\npO =\n\nn \u2212 \u03b1f\n,\nn+\u03b8\n\n(2)\n\nhence\n\nwhere \u03b8 \u2265 0 and \u03b1 \u2208 [0, 1].\nConsidering per-class duplication probability, one can choose the following expression, that asymptotically establishes the preferential attachment principle:\n\npiO =\n\nki \u2212 \u03b1\n.\nn+\u03b8\n\n(3)\n\nHere, \u03b8 represents a characteristic number of domain classes needed for the preferential attachment principle\nto set in, and defines the behavior of f (n) for small n ( n \u2192 0). \u03b1 is the most important parameter, which\nsets the scaling of the duplication/innovation ratio. Intuitively, the smaller \u03b1, the more the growth of f is\ndepressed with growing n, and since pN is asymptotically proportional to the class density f /n it is harder\nto add a new domain class in a larger, or more heavily populated genome. As we will see, this implies\npN /pO \u2192 0 as n \u2192 \u221e, corresponding to an increasingly subdominant influx of new fold classes at larger\nsizes. This choice reproduces the sublinear behavior for the number of classes and the other scaling laws\ndescribed in properties (i-iii).\nThis kind of model has previously been explored in statistics under the name of Pitman-Yor, or Chinese\nRestaurant Process (CRP) [24, 25, 29, 30], where it is known as one of the paradigmatic processes that generate partitions of elements into classes that are symmetric by swapping, or \"exchangeable\". This process\nis used in Bayesian inference and clustering problems [31]. In the Chinese restaurant (with table sharing)\nparallel, individual domains correspond to customers and tables are domain classes. A domain belonging\nto a given class is a customer sitting at the corresponding table. In a duplication event, a new customer is\n\n\f8\nseated at a table with a preferential attachment principle, and in an innovation event, a new table is added.\n\nMean-field theory for the CRP\n\nA simple mean-field treatment of the CRP allows to access its scaling behavior. Rigorous results for\nthe probability distribution of the fold usage vector {k1 , ..., kF }, for f (n) = F , are in good agreement\nwith mean-field predictions. It is important to note that for this stochastic process, the usual large-deviation\ntheorems do not hold, so that large-n limit values of quantities such as\n\nf (n)\nF (n)\n\ndo not converge to numbers,\n\nbut rather to random variables [24]. Despite of this non-self-average property, it is possible to understand\nthe scaling of the averages Ki and F (of ki and f respectively) at large n, writing simple \"mean-field\"\nequations, for continuous n. Note that rigorously the mean value Ki (n) is still a random variable, function\nof the (stochastic) birth time ni of class i.\nFrom the definition of the model, we obtain\nKi (n) \u2212 \u03b1\nn+\u03b8\n\n(4)\n\n\u03b1F (n) + \u03b8\n.\nn+\u03b8\n\n(5)\n\n\u2202n Ki (n) =\n\n\u2202n F (n) =\n\nThese equations have to be solved with initial conditions Ki (ni ) = 1, and F (1) = 1. Hence, for \u03b1 6= 0,\none has\nKi (n) = (1 \u2212 \u03b1)\n\nn+\u03b8\n+\u03b8 ,\nni + \u03b8\n\n(6)\n\nand\n1\nn+\u03b8\nF (n) =\n(\u03b1 + \u03b8)\n\u03b1\n\u03b8\n\u0014\n\n\u0012\n\n\u0013\u03b1\n\n\u0015\n\n\u2212 \u03b8 \u223c n\u03b1 ,\n\n(7)\n\nwhile, for \u03b1 = 0,\nF (n) = \u03b8 log(n + \u03b8) \u223c log(n) .\n\n(8)\n\nThese results imply that the expected asymptotic scaling of F (n) is sublinear, in agreement with observation\n(i).\nThe mean-field solution can be used to compute the asymptotic of P (j, n) = F (j, n)/F (n), following\n\n\f9\nthe same line of reasoning used by Barabasi and Albert for the preferential attachment model [26]. This\nworks as follows. From the solution, j > Ki (n) implies ni > n\u2217 , with n\u2217 =\n\n(1\u2212\u03b1)n\u2212\u03b8(j\u22121)\n,\nj\u2212\u03b1\n\nso that the\n\ncumulative distribution can be estimated by the ratio of the (average) number of domain classes born before\nsize n\u2217 and the number of classes born before size n, P (Ki (n) > j) = F (n\u2217 )/F (n). P (j, n) can be\nobtained by derivation of this function. For n, j \u2192 \u221e, and j/n small, we find\nP (j, n) \u223c j \u2212(1+\u03b1) ,\n\n(9)\n\nfor \u03b1 6= 0, and\nP (j, n) \u223c\n\n\u03b8\n,\nj\n\n(10)\n\nfor \u03b1 = 0. The above formulas indicate that the average asymptotic behavior of the distribution of domain\nclass populations is a power law with exponent between 1 and 2, in agreement with observation (ii). In\ncontrast, the behavior of the model of Gerstein and coworkers [13, 18, 19] can be found in this framework\nby taking improperly \u03b1 = 1, that is for constant pN , pO . It gives a linearly increasing F (n) and a powerlaw distribution with asymptotic exponent 2 for the domain classes. Note that the phenomenology of the\nBarabasi-Albert preferential attachment scheme [26] is reproduced by a CRP-like model where at each step\na new domain class (corresponding to the new network node) with on average m members (the edges of the\nnode) is introduced, and at the same time m domains are duplicated (the edges connecting old nodes to the\nnewly introduced one).\nIt is possible to obtain the same results through a different route compared to the above reasoning, by\nwriting the hierarchy of mean-field equations for F (j, n), using a master equation-like approach. Similarly\nas what happens for the Zero-Range process [32], these equations contain source and sink terms governing\nthe population dynamics of classes. Duplications create a flux from classes with j \u2212 1 to classes with j\nmembers, while only F (1, n) has a source term coming from the innovation move:\n\n\uf8f1\n\uf8f4\n\uf8f4\n\u2202n F (n) =\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 \u2202n F (1, n) =\n\uf8f4\n\uf8f4\n\u2202n F (2, n) =\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n***\n\n\u03b1 F (n) +\u03b8\nn+\u03b8\n\u03b1 F (n) +\u03b8\n(1,n)\n\u2212 (1 \u2212 \u03b1) Fn+\u03b8\nn+\u03b8\n(2,n)\n(1,n)\n(1 \u2212 \u03b1) Fn+\u03b8\n\u2212 (2 \u2212 \u03b1) Fn+\u03b8\n\n.\n\n(11)\n\n***\n\nWe consider the limit of large n, and use the ansatz F (j, n) = \u03c7j F (n). This ansatz can be justified\n\n\f10\n\n400\n\nj=1\nj=2\nj=3\nj=4\n\nF(j,n)\n\nF(j,n)\n\n300\n\n200\n\n300\n\nj=1\nj=2\nj=3\nj=4\n\n200\n\n100\n100\n0\n0\n\n200\n\n400\n\n600\n\n0\n0\n\n800\n\n500\n\nF(n)\n(a)\n\n300\n\n(b)\n\n400\n\nj=1\nj=2\nj=3\nj=4\n\nF(j,n)\n\nF(j,n)\n\n400\n\n200\n100\n0\n0\n\n1000\n\nF(n)\n\n300\n\nj=1\nj=2\nj=3\nj=4\n\n200\n100\n\n500\n\n1000\n\n0\n0\n\n500\n\nF(n)\n\n1000\n\nF(n)\n\n(c)\n\n(d)\n\nFIG. 2: (Color online) The classes with j members form a finite constant fraction of the total number of classes.\nF (j, n) (the number of classes with j members) is plotted versus F (n) for different values of j in empirical data (a)\nand simulations of the CRP (\u03b1 = 0.32, \u03b8 = 50) without (b) and with domain loss (\u03b4 = 0.2) in model with uniform\nloss (c) and weighted loss (d). In the plots from simulations, the lines in lighter colors represent 10 different realizations, while the points with error bars are the mean value over them. The figure shows that adding domain loss to the\nmodel has no qualitative consequences in the behavior of the domain class histograms.\n\nempirically and by simulations, as shown in Fig. 2, which compares this feature in empirical data and in\nsimulations of different variants of the model.\nWe have\n\uf8f1\n\uf8f4\n\uf8f4\n\u2202n F (n) =\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u03b1\u03c71 =\n\uf8f4\n\uf8f4\n\uf8f2\n\n\u03b1\u03c72 =\n\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n\n\u03b1 F (n)\nn\n\n\u03b1 \u2212 (1 \u2212 \u03b1)\u03c71\n(1 \u2212 \u03b1)\u03c71 \u2212 (2 \u2212 \u03b1)\u03c72\n\n***\n\u03b1\u03c7j =\n\n(j \u2212 1 \u2212 \u03b1)\u03c7j\u22121 \u2212 (j \u2212 \u03b1)\u03c7j\n\n,\n\n(12)\n\n\f11\ngiving\n\uf8f1\n\uf8f4\n\uf8f4\n\u03c71 =\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 2 \u03c72 =\n\n\u03b1\n(1 \u2212 \u03b1) \u03c71\n\n.\n\n(13)\n\n\uf8f4\n\uf8f4\n***\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 j \u03c7 = (j \u2212 1 \u2212 \u03b1) \u03c7\nj\nj\u22121\n\nThe solution of these equations is\n\n\u03c7j =\n\nj\u22121\nY\n\n(l \u2212 \u03b1)\n\nl=1\n\n\u03b1\n\u0393(j \u2212 1)\n1\n\u03b1=\n* (j \u2212 1)(1\u2212\u03b1) *\n,\n\u0393(j + 1)\n\u0393(1 \u2212 \u03b1)\n\u0393(j + 1)\n\n(14)\n\nwhich can be estimated as\n\u03c7j = \u03b1\n\n1\n\u0393(1 \u2212 \u03b1)\n\n\u0014 \u00151+\u03b1\n\n1\nj\n\n,\n\n(15)\n\ngiving the result for the scaling of F (j, n) and its prefactor.\n\nIV.\n\nDIRECT SIMULATION OF THE CRP AND FINITE-SIZE EFFECTS\n\nGoing beyond scaling, the probability distributions generated by a CRP contain large finite-size effects\nthat are relevant for the experimental genome sizes. In this section we analyze the finite size effect affecting\nthe distribution over the domain classes, obtained performing direct numerical simulations of different CRP\nrealizations. The simulations allow to measure F (n), and F (j, n) for finite sizes, and in particular for values\nof n that are comparable to those of observed genomes shown in Fig. 3.\nThe normalized distribution of the number of classes with j domains over a genome of length n reaches\nthe theoretical distribution suggested by our model only in the asymptotic limit\nF (j, n)\nF (n)\n\nn\u2192\u221e\n\n\u2212\u2192\n\np\u03b1 (j) =\n\n\u03b1\u0393(j \u2212 \u03b1)\n.\n\u0393(1 \u2212 \u03b1)\u0393(j + 1)\n\n(16)\n\nIt is possible to obtain more information by studying the ratio of the asymptotic distribution and the distribution obtained from the CRP simulation as shown in Fig. 4(a). The plot shows that there is a value m\u2217 (n),\ndepending on the size n of the genome, beyond which the distribution is not anymore consistent with p\u03b1 (j)\nbut shows exponential decay and large fluctuations.\nIn order to obtain a quantitative estimate of the deviation from scaling generating the cutoff, we define\nan order parameter as follows. Using data obtained from the simulation as in Fig. 4(a), we find the mean of\n\n\f12\nthe first 30 points of the plotted function and then compute the standard deviation \u03c3 by analyzing windows\nof K points together. The cutoff is defined when \u03c3 > \u03b4, where \u03b4 is a parameter. The result of this procedure\ncan be seen in Fig. 4(b). The cutoff shows a linear dependence from the genome length n. To make sure\nthe procedure does not depend too much on the number of iterations NI used to obtain the mean value of\nF (j, n), we performed it for different values of NI . As can be expected (Fig.4(c)), more statistics is needed\nfor probing the cutoff trend in those regions where the probability density function is very small. Were it\nnecessary to obtain from the distribution over domains n an estimate of parameters for the underlying CRP,\none could decide to consider only data with j < jcutoff . At the scales that are relevant for empirical data,\nfinite-size corrections are substantial. Indeed, the asymptotic behavior is typically reached for sizes of the\norder of n \u223c 106 , where the predictions of the mean-field theory are confirmed. Comparing the histogram\nof domain occurrence for the mean-field solution of the model, simulations and data, it becomes evident\nthat the intrinsic cutoff set by n causes the observed drift in the fitted exponent of the empirical distribution\nvisible in Fig. 3. This means that the common behavior of the slopes followed by the population of domain\nclasses for genomes of similar sizes can be ascribed to finite-size effects of a common underlying stochastic\n\n1000\n\n1.6\n\nFitted \u03b1\n\nCumulative F(j,n)\n\nprocess.\n\n100\n\n1.2\n\n10\n\n1\n\n0.8\n1\n\n10\n(a)\n\nj\n\n100\n\n0\n\n4000\n\n8000\n\nGenome size n\n(b)\n\nFIG. 3: (Color online) (a) Cumulative distributions for prokaryotes (data from the SUPERFAMILY database). Each\nis the cumulative histogram of domains in classes for a single genome. (b) Fitted exponent of F (j, n) from empirical\ndata of all prokaryotes, plotted as a function of n.\n\nBeyond the linear cutoff, the behavior of the distribution becomes realization-dependent due to the\nbreaking of self-average [33]. The relevant parameter to disentangle the realization-dependence is f . Highf realizations have different tails of the distribution from low-f ones, giving rise to the large fluctuations\nobserved in Fig. 4(a). Thus, while the mean-field approach is successful in predicting the asymptotic scaling\nof the distribution F (j, n), it does not capture the finite-size effects which can be observed in single realization of the CRP process with finite n and f . Beyond mean-field is possible to obtain more information\n\n\f13\n\nF(j,n) / F(n) p\u03b1(j)\n\n1\nn=10000\n1\nn=340000\n1\nn=670000\n1\n\n100\n\n10000\n\nj\n\n(a)\n\nCRP (0.1 , 200) / \u03b4 = 10 / \u03c3 = 1\n\n100\n\nj cutoff\n\njcutoff\n\n30\n\nIteration\n50\n100\n200\n\n50\n\n10\n0\n\n4000\n\nn\n\n8000\n\n(b)\n\n0\n\n4000\n\nn\n\n8000\n\n(c)\n\nFIG. 4: (Color online) (a) Ratio of finite-size and asymptotic value for the distribution of domain classes population\nF (j, n) taken from 500 realizations of a CRP with \u03b1 = 0.32 and \u03b8 = 50. The three plots corresponds to different\nvalue of n. (b) Linear n-dependency for the cutoff in a CRP. The parameters in the plot are \u03b1 = 0.1 and \u03b8 = 200. A\nsimilar trend can be observed for other values of the parameters. (c) Cutoff trends obtained from a CRP with \u03b1 = 0.44\nand \u03b8 = 60 and a different number of iterations. The procedure has parameters K = 10 and \u03b4 = 0.5.\n\nby considering the sum of all CRP trajectories conditioned to reaching configurations with given n and f .\nThis enables a statistical-mechanical derivation of the normalized distribution of the number of domains\nwith f classes over a genome of length (number of domains) n. Since the focus here is on the mean-field\napproach, the calculation is described in a parallel work [33].\n\nV.\n\nOCCURRENCE OF DOMAIN CLASSES AND CRP REALIZATIONS\n\nThe above model does not describe evolutionary time in generations. Conversely, it reproduces random\nensembles of different genomes generated one from the other with the basic moves of duplication, innovation (and loss, see below). It considers only events that are observed at a given n, independently on when or\nwhy they happened in physical or biological time. Genomes from the same realization can be thought of as\na trivial tree of life, where each value of n gives a new specie. In the case including domain deletions, more\n\n\f14\ngenomes of the same history can have the same size. In contrast, independent realizations are completely\nunrelated.\nThe scaling laws in F (n) and F (j, n) hold for the typical realization, indicating that the scaling laws\noriginate from the basic evolutionary moves and not from the fact that the species stem from a common\ntree with intertwined paths due to common evolutionary history. For example, two completely unrelated\nrealizations will reach similar values of F at the same value of n.\nThe data confirm this fact: phylogenetically distant bacteria with similar sizes have very similar number\nand population distribution of domain classes (see Fig. 8).\nWhile the scaling laws are found independently on the realization of the Chinese restaurant model, the\nuneven occurrence of domain classes can be seen as strongly dependent on common evolutionary history.\nAveraging over independent realizations, the prediction of the CRP is that the frequency of occurrence of\nany domain class would be equal, as no class is assigned a specific label. In the Chinese restaurant metaphor,\nthe customers only choose the tables on the basis of their population, and all the tables are equal for any\nother feature.\nIn order to capture this behavior with the model, one can consider the statistics of domain topology\noccurrence of a single realization, which is an extremely crude, but comparatively more realistic description\nof common ancestry. In other words, in this case, the classes that appear first are obviously more common\namong the genomes, and the qualitative phenomenology is restored, without the need of any adjustment in\n\nAverage Occurrence\n\nthe model definition (Fig. 5).\n\n1\n\nSampled \u03b1 = 0.5, \u03b8 = 80\nUniform \u03b1 = 0.5, \u03b8 = 80\nSampled \u03b1 = 0, \u03b8 = 200\nUniform \u03b1 = 0, \u03b8 = 200\nEmpirical\n\n0.5\n\n0\n\n500\n\n1000\n\n1500\n\nDomain Class\nFIG. 5: (Color online) Single realization averages reproduce qualitatively empirical topology occurrence (the fraction\nof genomes where the given domain topology is found, normalized by the total number of genomes). Domain topology\nranked occurrence in typical realizations of the CRP with different parameters (symbols), compared to the empirical\ndata for bacteria (continuous line). The simulated data were obtained considering the occurrence curve for 500\nrealizations of the process for all sizes from n = 300 to n = 8000 (\"uniform\"), i.e. the range of sizes observed in the\ndata, or directly for the set of empirical sizes of the genomes (\"sampled\").\n\n\f15\nVI.\n\nDOMAIN LOSS\n\nLoss of genes, and thus of domains, is reported to occur frequently in genomes. We will discuss now\nvariants of the model considering the introduction of a domain deletion, or loss rate. The question we ask is\nwhether the introduction of domain loss, which we consider mainly as a perturbation, affects the qualitative\nbehavior of the model, for example by generating different scaling behavior or phase transitions. We will see\nthat the answer to all these questions is mostly negative even for non-infinitesimal perturbations, provided\nthe loss rate is constant and does not scale itself with F and n. The main exception to this behavior is found\nwhen the loss probability of a domain depends on its own class size.\nWe introduce domain loss through a new parameter \u03b4, which defines a loss probability pL in two a\npriori different ways. (1) We can distribute this probability equally among domains, so that the per-class\nloss probability is piL = \u03b4 kni . Consequently, the duplication and innovation probabilities pO and pN are\nrescaled by a factor (1 \u2212 \u03b4). (2) We can also weigh the loss probability of a domain on its own class size,\nin the same way as domains are duplicated in the standard CRP, so we obtain a per-class loss move with\ni \u2212\u03b1\nprobability piL = \u03b4 kn+\u03b8\n, giving a total pL = \u03b4 n\u2212\u03b1F\nn+\u03b8 and the rescaling of pO and pN . We will see that model\n\n(1) and (2) are not equivalent.\nOn technical grounds, the introduction of domain loss makes the stochastic process entirely different:\nn is now a random variable, and all the observables that depend on it (e.g. F (n)) are stochastic functions\nof this variable. Another parameter, t, describes the iterations of the model. Operatively, we tackle the\ntwo models with the usual mean-field approach, writing equations for n and F of the kind \u2202t n = Q(n, F ),\nR (n,F )\n\u2202t F = R(n, F ), and hence obtain the behavior as a function of n by considering \u2202n F = Q\n(n,F ) . The exact\n\nmeaning of these equations is not straightforward. For example F (n) should represent the average on all\nhistories passing by n, but the differential equation strictly describes only the dependence of the observable\nfrom the actual value of the random variable n. Nevertheless, the predictions of this mean-field approach\nagree well with the results of simulations, indicating that these complications typically do not affect the\nbehavior of the means. We will consider situations where, on average, genomes are not shrinking.\nConsidering model (1), we can write the mean-field equations as\n\u2202t F (t) = (1 \u2212 \u03b4)\n\n\u03b1F (t) + \u03b8\nF (1, n)\n\u2212\u03b4\nn+\u03b8\nn\n\n(17)\n\nKi (t)\nKi (t) \u2212 \u03b1\n\u2212\u03b4\n,\nn+\u03b8\nn\n\n(18)\n\n\u2202t Ki (t) = (1 \u2212 \u03b4)\n\n\f16\nwhere the sink term for F derives from domain loss in classes with a single element, quantified by F (1, n).\nSince time does not count genome size, one has to consider the evolution of n with time t, given in this case\nby \u2202t n = 1 \u2212 2\u03b4. In order to solve these expressions, we use the ansatz F (1, n) = \u03c71 F (n), and considering\nthe limit in large n. The ansatz is verified by simulations and holds also for empirical data, as previously\nshown (Fig. 2). The first equation reads:\n\n\u2202n F (n)\n1 (1 \u2212 \u03b4)\u03b1 \u2212 \u03b4\u03c71\n=\nF (n)\nn\n1 \u2212 2\u03b4\n\u0014\n\n\u0015\n\n.\n\n(19)\n\nThe above equation gives the conventional scaling for F (n) and K(n) with \u03b1 replaced by \u03b1R =\n(1\u2212\u03b4)\u03b1\u2212\u03b4\u03c71\n,\n1\u22122\u03b4\n\nthe correction resulting from the measured value of \u03c71 . By the use of computer simulations\n\nwe notice that the \u03c71 coefficient tends to \u03b1 for infinite-size genomes (Fig. 6(a), 6(b), and 6(c)), so that\nthe asymptotic trend of the equally distributed domain loss is identical to that of the standard CRP. This\nbehavior is independent from the chosen \u03b4 < 1/2, as the asymptotic regime depends only on the growth of\nF (n), governed by \u03b1.\nWhen we analyze the domain distribution of finite-size genomes, we obtain the conventional results: the\npower-law depends on the genome size, but not on the value of \u03b4 (Fig. 6(b) and 6(d)). This is explained\nconsidering the fact we are comparing runs with fixed genome size, thus with different number of moves,\nand we do not consider genomes that lose all their own domains. In fact biologically one cannot trace the\nnumber of moves needed to reach a specific genome, but essentially we can observe only genomes in their\nactual state.\nMore precise results can be obtained by the use of the mean field \"master equation\" approach sketched\nabove. Using the same ansatz F (j, n) = \u03c7j F (n), we obtain the following hierarchy of equations for \u03c7j\n[B + \u03b4j + (1 \u2212 \u03b4)(j \u2212 \u03b1)]\u03c7j = (1 \u2212 \u03b4)(j \u2212 1 \u2212 \u03b1)\u03c7j\u22121 + \u03b4(j + 1)\u03c7j+1 ,\n\n(20)\n\nwith B = (1 \u2212 \u03b4)\u03b1 \u2212 \u03b4\u03c71 . It is possible to estimate the solution of this system by taking a continuum limit\nas\nB\u03c7(x) + (1 \u2212 \u03b4)\u2202x [(x \u2212 a)\u03c7(x)] \u2212 \u03b4\u2202x \u03c7(x) = 0 ,\n\n(21)\n\nwhich can be solved giving\n\u03c7(x) \u223c\n\n\u0014 \u00151+Z\n1\n\nx\n\n,\n\n(22)\n\n\f17\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\u03b4 = 0.00\n\u03b4 = 0.05\n\u03b4 = 0.10\n\u03b4 = 0.15\n\u03b4 = 0.20\n\u03b4 = 0.25\n\u03b4 = 0.30\n\u03b4 = 0.35\n\n0.4\n0.2\n0\n0\n\n\u03b1R\n\n1\n\n\u03c71\n\n1\n\n0.2\n\n0.4\n\n\u03b1\n\n0.6\n\n0.8\n\n\u03b4 = 0.00\n\u03b4 = 0.05\n\u03b4 = 0.10\n\u03b4 = 0.15\n\u03b4 = 0.20\n\u03b4 = 0.25\n\u03b4 = 0.30\n\u03b4 = 0.35\n\n0.4\n0.2\n0\n0\n\n1\n\n0.2\n\n0.4\n\n(a)\n\n\u03b1\n\n0.6\n\n0.8\n\n1\n\n(b)\n\n100\n\n8\n\u03b1 = 0.05\n\u03b1 = 0.10\n\u03b1 = 0.15\n\u03b1 = 0.20\n\n7\n6\n\n80\n\n5\n\n\u03b8R\n\n\u03b1R / \u03b1\n\n60\n\n4\n\n40\n\n3\n2\n\nSimulation\n\u03b8 = 75\n\n20\n\n1\n0 4\n10\n\n10\n\n5\n\n10\n\n6\n\nn\n\n10\n\n7\n\n10\n\n8\n\n0\n\n0\n\n0.1\n\n(c)\n\n0.2\n\n0.3\n\n\u03b4\n\n0.4\n\n(d)\n\nFIG. 6: (Color online) A model with uniform domain loss (model (1)) does not lead to a change of qualitative behavior\nwith respect to absence of domain loss. We estimated \u03c71 from simulations with a linear fit of the measured (linear)\nF (1, n). The measured coefficient \u03c71 (a) approaches with the parameter \u03b1, hence the observed scaling exponent\n\u03b1R , measured from the simulated F (n) agrees very well with the imposed \u03b1. (b) This trend is weaker for smaller \u03b1\nbut can be regarded as a finite size effect, as the agreement improves (c) for increasing n. The plot in (c) refers to\n\u03b8 = 75, \u03b4 = 0.35. Finally (d), the same phenomenology holds for \u03b1 = 0, where the observed parameter \u03b8R extracted\nfrom the behavior of F (n) in simulations agrees well with \u03b8.\n\nwith Z =\nP\n\nj\n\nB\n1\u22122\u03b4 .\n\nWe also find F (n) = nZ , which is consistent with the constraint\n\nP\n\nj\n\nj\u03c7j =\n\nn\nF (n)\n\nsince\n\nj\u03c7j \u223c n1\u2212Z . It is then clear that the introduction of domain loss is equivalent to a rescaling of the\n\nparameter \u03b1 to \u03b1R = Z(\u03b1, \u03b4), but in our case, Z(\u03b1, \u03b4) = \u03b1 asymptotically.\nThe case \u03b1 = 0 has to be treated separately, but the behavior is similar (Fig. 6(d)).\nA similar procedure is applicable to model (2). In this case, however, the dependence of the effective\ndeath rate from n can bring to an interesting change in the phenomenology, where \u03b4 can select the observed\nexponent \u03b1R and also determine a regime of linear growth for F (n).\nTo understand this point we can consider the mean-field evolution of F (n). This is determined asymptotically by the balance of a growth term pN \u223c \u03b1F/n and a loss term pL \u223c \u03b4F (1, n)(1 \u2212 \u03b1)/n. With the\n\n\f18\n0.9\n\n0.5\n\n1\n\n0.4\n0.3\n\n0.4\n0.2\n0.2\n\n0.4\n\n\u03b1\n\n0.6\n\n0.8\n\n\u03b4\n\n\u03b1R\n\n\u03b4 = 0.00\n\u03b4 = 0.05\n\u03b4 = 0.10\n\u03b4 = 0.15\n\u03b4 = 0.20\n\u03b4 = 0.25\n\u03b4 = 0.30\n\u03b4 = 0.35\n\n0.6\n\n0.2\n\nF(n) ~ n\nF(n) ~ log(n)\n\n0.8\n\n0\n0\n\n~n\n0.995\n~n\nMean-field\n\n\u03b1R\n\nF(n) ~ n\n\n0.1\n\u03b1\n\nF(n) ~ n\n\n0\n\n1\n\n0\n\n0.2\n\n0.4\n\n\u03b1\n\n(a)\n\n0.6\n\n0.8\n\n1\n\n(b)\n\nFIG. 7: (Color online) In a model with weighted domain loss (model (2)), the loss probability can trigger a transition\nbetween two different scaling behaviors for F (n). (a) behavior of observed exponent \u03b1R versus \u03b1 in simulations. The\nexponent saturates to unity at a critical value that is lower than one. The dashed lines are mean-field predictions in\nthe ansatz of F (n) sublinear in n. (b) \"Phase-diagram\" for the behavior of \u03b1R for different values of \u03b1 and \u03b4. The\ndashed line is a mean-field estimate of the transition point to \u03b1R = 1, while circles and diamonds are the \u03b1R = .9\nand \u03b1R = .995 lines from simulations at n = 106 .\n\nusual ansatz this gives an asymptotic evolution equation of the kind\n\u2202n F (n) = F (n)\n\n\u03b1 \u2212 \u03b4(1 \u2212 \u03b1)\u03c71\n,\n(1 \u2212 2\u03b4)n + 2\u03b4\u03b1F (n)\n\n(23)\n\nwith the usual definitions. Simulations confirm the ansatz F (1, n) = \u03c71 F (n) for this second model, which\nwe will use in the mean-field reasoning. If F (n) is intensive, i.e. asymptotically of order inferior to n, the\nterm 2\u03b4\u03b1F can be neglected and this equation gives the scaling law F \u223c n\u03b1R , with \u03b1R =\n\n\u03b1\u2212\u03c71 \u03b4(1\u2212\u03b1)\n.\n1\u22122\u03b4\n\nHowever, this equation has solution also if F is order n, i.e. \u03b1R = 1, and the term 2\u03b4\u03b1F in Eq. (23) cannot\nbe neglected. In this case \u03b1 and \u03b4 determine the prefactor of the scaling law F \u223c n.\nThus, there are two self-consistent mean-field asymptotic solutions, and we expect a transition between\nthe two distinct behaviors. The existence of this transition is confirmed by simulations (Fig. 7(a)): at fixed\n\u03b4, \u03b1R saturates to \u03b1R ' 1 for larger values of this parameter. The transition point can be understood in\nmean-field as the intersection of the two solutions \u03b1R = 1 and \u03b1R =\n\n\u03b1\u2212\u03c71 \u03b4(1\u2212\u03b1)\n1\u22122\u03b4\n\nat varying \u03b4, and gives\n\nrise to a two-parameter \"phase-diagram\" separating the linear from the sublinear scaling of F (n) with n, as\nshown in Fig. 7(b).\nIn conclusion, the mean-field approach is effective in exploring the effects of domain loss, which, under\nsome general hypotheses, does not disrupt the basic phenomenology of the duplication-innovation model.\nSpecifically, there appear to be no qualitative changes introduced by a finite uniform loss rate, as long as this\nrate is constant with n. A loss rate that is weighted as the innovation rate, instead, can induce an interesting\ntransition from sublinear to linear scaling.\n\n\f19\nThinking about the empirical system, no direct quantitative estimates are currently available regarding\nthe domain loss rate as a function of genome size or number of classes. For this reason, it currently appears\ndifficult to make a definite choice for this ingredient in the model.\n\nVII.\n\nMODELS WITH DOMAIN CLASS SPECIFICITY\n\nIn the previous sections we analyzed models that make no distinction between domain topologies, but\nthe latter are selected for duplication moves only on the basis of their population.\nIt is then clear that they can reproduce the observed qualitative trends for the domain classes and their\ndistributions with one common set of parameters for all genomes. One further question is to estimate the\nquantitative values of these parameters for the data. While the empirical slope of F (n) could be seen as\nmore compatible with a model having \u03b1 = 0, as its slope decays faster than a power law for large values of\nn, the slopes of the power-law distribution of domain classes P (j, n) and their cutoff as a function of n is\nin closer agreement to a CRP with \u03b1 between 0.5 and 0.7 [23].\nWe will now discuss a CRP variant that is able to distinguish domain classes based on a priori information, thus breaking the symmetry of the model by exchange of tables.\nThis is equivalent to the introduction of differently colored \"tablecloths\" labeling the tables, that are\ndeterminant in the choice for one table or the other.\nThose table colors can be set by any observable of interest. In our analysis, we considered the empirical\noccurrence of a domain topology as a label. Indeed, the occurrence of a given domain class is determined by\nits biological function. For example, as expected, all the \"core\" biological functions such as translation of\nproteins and DNA replication are performed by highly occurring domain topologies, since this machinery\nmust be present in each genome. Accordingly, these universal classes performing core functions have to\nappear preferentially earlier on in a model realization. This variant of the model is important for producing\ninformed null models for the analysis of the empirical data, and, as we will see, shows the best agreement\nwith respect to the scaling laws.\nWe will introduce the variant with class specificity by coupling the CRP model to a simple genetic\nalgorithm able to select between innovation moves that choose different classes. Let us first introduce some\nnotation to parametrize domain class occurrence. We define the matrices \u03c3ik where:\n\n\u03c3ig :=\n\n\uf8f1\n\uf8f4\n\uf8f21\n\ndomain i found in genome g\n\n\uf8f4\n\uf8f3 \u22121 domain i not found in genome g\n\n(24)\n\n\f20\n\nn~1600\n\nn~1500\n\nbl, lj, ls, ni, pg, pp,\nsd, sp, tg, ts, x1\n\nlv, oc, p0, x2\n\n100\n\n1\n\nF(j,n)\n\nn~1800\n\nn~1900\n\na9, c5, lx,\ns4, s5, sz\n\n100\n\ncd, ch, jk,\nso, ti, tr, ws\n\n1\nn~3921\n\nn~4050\n\nec, ew, rr\n\nb0, bx, rx,\nvb, vp, x5\n\n100\n\n1\n1\n\n10\n\n1\n\n10\n\nj\nFIG. 8: (Color online) Comparison of F (j, n) from the SUPERFAMILY Database with mean-field predictions and\nsimulations of the model with class specificity. Comparison between n\u2212dependence of powerlaw fit (lines in blue)\nand universality of the two parameters from our model. Two letters identify each genome, whose full name can be\nfound in Appendix (Table B.1). Simulations (lines in gray) from our model use the same values \u03b1 = 0.75 and \u03b8 = 32.\n\nIt is possible to consider the mean taken along the matrix columns,\n1 X g,emp\nemp E\n\u03c3i\n= g\n\u03c3\n,\nN g i\n\nD\n\n(25)\n\nwhere the label \"emp\" means that this value is obtained from empirical data (Fig. 5).\nGenerically, a genetic algorithm requires a representation of the space of solution \u03a9 and a function f (\u03c9)\nthat tests the quality of the solution computed. In our case, the former is simply the genome obtained from\n\n\f21\nthe a CRP step, parametrized by \u03c3ik . The latter is defined as\nY\n\nF(g) =\n\n\u0010\n\nD\n\nemp E\u0011\n\nexp \u03c3i \u03c3i\n\nX\n\n= exp\n\nemp\n\n\u03c3i < \u03c3i\n\n!\n\n>\n\n.\n\n(26)\n\ni\n\ni\n\nThe value of the above scoring function taken over simulated genomes measures how much the set of\ndomain classes they possess agrees with experimental data (in this case on occurrence) and enables to\ncompare different \"virtual\" CRP moves.\n0\n\n00\n\nWe consider the case of two virtual genomes g and g generated through standard CRP steps, for\nsimplicity without domain loss, from an initial size n and genome g(n).\nNote that in this variant, since the empirical domain topologies are a finite set, domain classes are also\nfinite. As a consequence, tables with a given tablecloth are extracted without replacement, affecting the\npool of available colors. As we will see, this is an important requirement to obtain agreement with the data,\nas it determines the saturation of the function F (n) also for large values of \u03b1. We will discuss the role of\nan infinite pool in the following subsection.\nAlso, as anticipated, domain classes have different \"color\", or in mathematical terms the exchangeability\nof the process is lost. Classes are drawn from the set of the residual ones with uniform probability. Genomes\n0\n\n00\n\ng and g are compared through the function F and the highest score one will be the genome g(n + 1) so\n0\n\n00\n\nthat g(n + 1) = argmax(F(g ), F(g )).\nIn these conditions, the rigorous results present in the literature for the CRP cease to be valid. It is still\npossible, however, to analyze the behavior of this variant by the mean-field approach adopted here, and to\ncompare with simulations. Since the selection rule chooses strictly the maximum, it is essentially able to\nemp\ndistinguish the sign of h\u03c3i\ni only. For this reason, it is sufficient to account for the positivity (which we\nlabel by \"+\") and negativity (\"-\") of this function for a given domain index i. This means that, with the\nsimplification of two virtual moves only, the model introduces only one extra effective parameter, i.e. the\nratio of the \"universal\" (positive F) to the \"contextual\" (negative F) domain classes.\nIn order to write the mean-field equations for this model variant, we first have to classify all the possible\n0\n\n00\n\noutcomes of the virtual CRP moves. The genomes g and g proposed by the CRP proliferation step can\nhave the same (labeled by \"1\"), higher (\"1+ \") or lower (\"1\u2212 \") score than their parent, depending on pO ,\npN and by the probabilities to draw a universal or contextual domain family, p+ and p\u2212 respectively. Using\nthese labels, the scheme of the possible states and their outcome in the selection step is given in Table I.\nFrom the Table I, it is straightforward to derive the modified duplication and innovation probabilities p\u0302O\n\n\f22\n0\n\n00\n\nproliferation (g , g ) probability selection\n(1, 1)\np2O\nold\n(1, 1\u2212 )\n2 pO pN p\u2212\nold\n(1, 1+ )\n2 pO pN p+ new+\n(1+ , 1+ )\np2N p2+\nnew+\n2\n(1+ , 1\u2212 )\n2 pN p\u2212 p+ new+\n(1\u2212 , 1\u2212 )\np2N p2\u2212\nnewTABLE I: Compound probabilities of picking up a new domain or an old domain with positive or negative cost\nfunction.\n\nand p\u0302N of the complete algorithmic iteration:\np\u0302O = pO (pO + 2 pN p\u2212 )\n\n(27)\n\np\u0302N = pN (pN + 2 pO p+ ) = pN + + pN \u2212 ,\n\n(28)\n\nwhere pN + = pN p+ (2 \u2212 pN p+ ) and pN \u2212 = p2N (1 \u2212 p+ )2 are the probabilities that the new domain is\ndrawn from the universal or contextual families respectively.\nWe now write the macroscopic evolution equation for the number of domain families by the usual proemp\ncedure. Calling K + (n) and K \u2212 (n) the number of domain classes that have positive or negative h\u03c3i\ni\nand are not represented in g(n),\n\n\uf8f1\n\uf8f4\n\uf8f4\n\u2202n F (n) =\n\uf8f4\n\uf8f4\n\uf8f2\n\np\u0302N\n\n\u2202n K + (n) = \u2212p\u0302N +\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 \u2202 K \u2212 (n) = \u2212p\u0302\nn\nN\u2212\n\n.\n\n(29)\n\nNow, p+ = K + /(K \u2212 + K + ) = K + /(D \u2212 F (n)), so that we can rewrite\n\n\uf8f1\n\uf8f4\n\uf8f4\n\u2202n F (n) =\n\uf8f4\n\uf8f4\n\uf8f2\n\n\u2202n K + (n) =\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 \u2202 K \u2212 (n) =\nn\n\n\u03b1F (n)+\u03b8\n2K + (n) n\u2212\u03b1F (n)\n+ D\u2212F\nn+\u03b8\n(n) ( n+\u03b8 )\nh\ni\n+\n\u03b1F (n)+\u03b8 K + (n)\n(n)+\u03b8\nK (t)\n\u2212( \u03b1Fn+\u03b8\n) D\u2212F\n(n) 2 \u2212 ( n+\u03b8 ) D\u2212F (n)\n(n)+\u03b8 2 K + (n) 2\n\u2212( \u03b1Fn+\u03b8\n) ( D\u2212F (n) )\n(n)+\u03b8\n( \u03b1Fn+\u03b8\n)\n\nh\n\nThe above equations have the following consistency properties\n\ni\n\n.\n\n(30)\n\n\f23\n\u0010\n\n\u0011\n\n\u2022 \u2202n K + + K \u2212 + F = 0, hence K + + K \u2212 + F = D\n\n\u2200n.\n\n\u2022 \u2202n F \u2264 1, hence F (n) \u2264 n.\n\u2022 \u2202n F \u2265 0, \u2202n K + \u2265 0 and \u2202n (F + K + ) \u2265 0 so that F grows faster than K + decreases.\nChoosing the initial conditions from empirical data n0 , F (n0 ), size and number of domain classes of the\nsmallest genome, we have, since F (n0 ) < n0 and \u03b1 \u2264 1,\n\u03b1F (n0 ) + \u03b8\n<1 .\nn0 + \u03b8\n\n(31)\n\nIt is simple to verify that under this condition the system always has solutions that relax to a finite value\nF\u221e < D. Indeed, after the time n\u2217 where K + (n\u2217) = 0, the equations reduce to \u2202n K + = 0, K \u2212 = D \u2212 F\nand\n\u0012\n\n\u2202n F (n) =\n\n\u03b1F (n) + \u03b8\nn+\u03b8\n\n\u00132\n\n,\n\n(32)\n\nimmediately giving our result. It is important to notice that this result depends on the fact the empirical\nreservoir of domains is finite (and thus on the biological hypothesis that the full pool of available domain\ntopologies is). Indeed, in presence of an infinite reservoir of domain classes, F (n) does not relax to a finite\nvalue. In this case, similarly as in the case of non uniform loss, there is a transition from linear to sublinear\nscaling piloted by the parameters p+ and \u03b1. If 2p+ \u03b1 < 1, F \u223c n2p+ \u03b1 , while if 2p+ \u03b1 > 1, F \u223c n.\nNumerical solutions of Eq. (30) give the same behavior for F (n) as the direct simulations (Fig. 9). In\nparticular, while this function grows as a power law for small genome sizes, it saturates at the relevant\nscale, giving good agreement with the data (Fig. 10). The internal laws of domain usage of this model\nwere obtained from direct simulations only, and give a good quantitative agreement with the data (Fig. 10).\nFinally, Fig. 9 also shows that, for large values of \u03b1 (above 0.7) this function reaches a maximum at sizes\nbetween 2000 and 4000. This is also where most of the empirical genomes are found, indicating that this\nrange of genome sizes may allow the optimal usage of universal and contextual domain families.\n\nVIII.\n\nCONCLUSIONS\n\nWe presented from a statistical physics viewpoint a class of duplication-innovation-loss stochastic processes able to describe the probability distributions and scaling laws observed in genomic data sets for\nprotein structural domains with few effective parameters. These models are different declinations of the basic paradigm set by the Chinese restaurant process which, though much explored in the statistical literature,\n\n\f24\n2000\n\u03b1 = 0, \u03b8 = 200\n\u03b1 = 0.3, \u03b8 = 70\n\u03b1 = 0.55, \u03b8 = 70\n\u03b1 = 0.75, \u03b8 = 70\n\n2500\n\n2000\n\n1000\n\n100\n100\n\n1000\n\n10000\n\n1000\n500\n\n1500\n\n1000\n\n\u03b1 = 0, \u03b8 = 200\n\u03b1 = 0.3, \u03b8 = 70\n\u03b1 = 0.55, \u03b8 = 70\n\u03b1 = 0.75, \u03b8 = 70\n\n1500\n\nF(n)\n\nCost Function F\n\n3000\n\n0\n\n5000\n\n10000 15000 20000\nn\n\n0\n\n0\n\n5000\n\n10000\nn\n\n15000\n\n20000\n\nFIG. 9: (Color online) Numerical solutions of the mean-field equations of the CRP model with selection of specific\ndomain classes. Left panel: score function F(n) for different values of \u03b1. Right panel: F (n) plotted in linear and\nlogarithmic (inset) scales.\n\nF(n)\n\n800\n600\nCRP with selection\nProkaryotes\n\n400\n200\n0\n\n2000\n\n4000\n\nn\n\n6000\n\nFIG. 10: (Color online) Comparison of the CRP with class specificity with experimental data. CRP parameters are\n\u03b1 = 0.75 e \u03b8 = 0.32. Number of domain classes versus the length n of genome. Simulations were performed for\nn < 10000 taking data at each interval of 1000 units in size, and considering 5 realizations at each step.\n\nremains relatively unexplored by the physics community, despite of its rich and peculiar phenomenology,\nwhich could make it useful in multiple applications.\nOur focus has been to present the basic phenomenology of different variants of the model connected to\npossibly relevant aspects of the evolutionary dynamics of protein domains, prominently domain duplication,\ninnovation, loss, and the specificity of domain classes. In doing this, we have shown how a mean-field\napproach, despite of its simplicity, can be extremely powerful in the analysis of the qualitative behavior of\nthis class of models. More subtle aspects of these models might be approached by simulations and refined\nstatistical mechanics methods, directly accessing the sum on all different paths.\nFor the standard CRP, we have shown how the scaling laws in the number and in the slope of the observed power-law distributions of domain classes are qualitatively reproduced, by the typical or the average\nrealization. The salient ingredient for this feature is that this model can include the correct relative scaling\nof innovation to duplication moves, which can be generated by statistical dependence of innovation, or by\nthe fact that the process of domain birth does not give rise to identically distributed random variables at\n\n\f25\ndifferent sizes.\nThe mean-field results can be obtained in two independent ways: with dynamic equations for the population and number of domain classes, or, similarly as for the Zero-range process [32], by considering the\nevolution of the number of classes with a given population. The latter \"master equation\" approach gives\naccess to the full histogram of domain class population. The scaling of the slope of the domain class\ndistributions can be understood as a finite-size effect on these histograms. We have also shown how the\nuneven occurrence of domain classes can be explained by the CRP provided one considers the statistics of\noccurrence in a single realization. This can be interpreted as the fact that genomes are related by common\nevolutionary paths.\nThis phenomenology is extremely robust to the introduction of finite domain loss probabilities that do\nnot scale with n or F . For uniform domain loss, the full mean-field equations are still accessible analytically,\nand point to the effect of domain loss as a simple effective rescaling of the model parameters. The presence\nof a loss rate that scales with size, instead, can trigger a transition from sublinear to linear scaling in the\nnumber of distinct classes.\nFinally, we have discussed the case of models that introduce the specificity of domain classes, and thus\nexplicitly breaks the symmetry between them, as expected for the biological case. Such variants can be very\nuseful in more detailed statistical investigations (e.g. as a null model) and to define inference problems on\nthe available bioinformatic data.\nFor example, a preferential duplication of conserved proteins has been reported in eukaryotes [34], and\ncould be tested against a duplication-innovation-loss model where a \"conservation index\" characterizes\nspecificity.\nHere, we have shown how a CRP variant with specificity can be formulated as a genetic algorithm where\ndifferent CRP virtual moves are selected on the basis of an informed scoring function, defined on the basis\nof further empirical observables related to domain classes (such as function, correlated occurrence, etc.)\nIn our case, we have shown how such a variant, weighting the virtual moves according to the observed\noccurrence of the finite pool of domain classes has very good quantitative agreement with the available\ndata.\nThe future perspective on this systems and models are abundant, both for the application of the models to\nthe genomics of protein domains, where the most promising ways seems to be the use in specific inference\nproblems on species with known evolutionary histories, and in other problems of statistical physics and\ncomplex systems, for example to develop new growth models for complex networks where the nodes can\nevolve with similar moves. One prominent example is the case of protein-protein interaction networks,\ngraphs where the nodes follow a dynamics that is coupled to those of protein domains, while the edges can\n\n\f26\nbe inherited by duplication, lost, or rewired by mutation and natural selection.\n\nAcknowledgments\n\nGB acknowledges financial support from the project IST STREP GENNETEC contract No. 034952.\n\n[1] D. Tautz and M. Lassig, Trends Genet 20, 344 (2004).\n[2] M. A. Huynen and E. van Nimwegen, Mol Biol Evol 15, 583 (1998).\n[3] J. S. Mattick, Nat Rev Genet 5, 316 (2004).\n[4] S. Maslov, S. Krishna, T. Y. Pang, and K. Sneppen, Proc Natl Acad Sci U S A 106, 9743 (2009).\n[5] E. van Nimwegen, Trends Genet 19, 479 (2003).\n[6] S. Itzkovitz, T. Tlusty, and U. Alon, BMC Genomics 7, 239 (2006).\n[7] M. Lynch and J. S. Conery, Science 302, 1401 (2003).\n[8] E. P. Rocha, Current opinion in microbiology 11, 454 (2008).\n[9] E. V. Koonin, The international journal of biochemistry & cell biology 41, 298 (2009).\n[10] C. A. Orengo and J. M. Thornton, Annu Rev Biochem 74, 867 (2005).\n[11] C. Branden and J. Tooze, Introduction to Protein Structure (Garland, New York, 1999).\n[12] E. V. Koonin, Y. I. Wolf, and G. P. Karev, Nature 420, 218 (2002).\n[13] J. Qian, N. M. Luscombe, and M. Gerstein, J Mol Biol 313, 673 (2001).\n[14] G. P. Karev, Y. I. Wolf, A. Y. Rzhetsky, F. S. Berezovskaya, and E. V. Koonin, BMC Evol Biol 2, 18 (2002).\n[15] V. A. Kuznetsov, in Computational and Statistical Approaches to Genomics, edited by W. Zhang and I. Shmulevich (Kluwer, Boston, 2002), p. 125.\n[16] S. Abeln and C. M. Deane, Proteins 60, 690 (2005).\n[17] N. V. Dokholyan, B. Shakhnovich, and E. I. Shakhnovich, Proc Natl Acad Sci U S A 99, 14132 (2002).\n[18] M. Kamal, N. Luscombe, J. Qian, and M. Gerstein, in Power Laws, Scale-Free Networks and Genome Biology,\nedited by E. Koonin, Y. Wolf, and G. Karev (Spinger, New York, 2006), pp. 165\u2013193.\n[19] R. Durrett and J. Schweinsberg, Ann. Probab. 33, 2094 (2005).\n[20] G. P. Karev, Y. I. Wolf, and E. V. Koonin, Bioinformatics 19, 1889 (2003).\n[21] G. P. Karev, Y. I. Wolf, F. S. Berezovskaya, and E. V. Koonin, BMC Evol Biol 4, 32 (2004).\n[22] G. P. Karev, F. S. Berezovskaya, and E. V. Koonin, Bioinformatics 21 Suppl 3, iii12 (2005).\n[23] M. Cosentino Lagomarsino, A. L. Sellerio, P. D. Heijning, and B. Bassetti, Genome Biol 10, R12 (2009).\n[24] J. Pitman, in Notes for St. Flour Summer School (2002).\n[25] J. Pitman and M. Yor, The two-parameter poisson-dirichlet distribution derived from a stable subordinator\n(1997).\n[26] A. L. Barabasi and R. Albert, Science 286, 509 (1999).\n\n\f27\n[27] V. Kunin and C. A. Ouzounis, Genome Res 13, 1589 (2003).\n[28] C. Pal, B. Papp, and M. J. Lercher, Nat Rev Genet 7, 337 (2006).\n[29] D. Aldous, in Saint-Flour Summer School XIII - 1983 (Springer, Berlin, 1985).\n[30] J. Kingman, J. Roy. Statist. Soc. B 37, 1 (1975).\n[31] Z. S. Qin, Bioinformatics 22, 1988 (2006).\n[32] M. Evans and T. Hanney, J. Phys. A 38, R195 (2005).\n[33] B. Bassetti, M. Zarei, M. Cosentino Lagomarsino, and G. Bianconi, arXiv:0905.4666 (2009).\n[34] J. C. Davis and D. A. Petrov, PLoS Biol 2, e55 (2004).\n[35] See ref. [23], these trends are also visible from Fig. 10, 3, 4, and 5 of this work.\n\n\f28\nAppendix A: Data and methods\n\nAll the data considered here were extracted from the SUPERFAMILY database version 1.69 and 1.73.\nWe considered domains at the superfamily level, although similar results hold for folds and families. A\ngenome \"size\" n was defined as the number of domain hits for each genome. The main data structures\nconsidered were the number of domain classes and the histograms of domain class population. We also\nconsidered the ranked occurrence of a given domain class across genomes.\nThe different variants of the duplication-innovation-loss model were simulated directly using a C++ code\nand compared with the mean-field results and the empirical data. The variant with class specificity couples\nthe CRP model to a simple genetic algorithm selecting innovation moves that choose distinct classes, on the\nbasis of their empirical occurrence. For all the variants, we derived and solved the mean-field equations for\nthe evolution of the main observables, and described alternative approaches for their solution.\nThe finite-size behavior of a CRP was studied comparing the finite-size histograms obtained from direct\nsimulations with the asymptotic limit of the exact analytical result (formula 16) [24], and defining a cutoff\nas the class-size where the deviation was larger than an arbitrary threshold. The cutoff was studied as a\nfunction of n. For the CRP variants with specificity and domain loss only the mean-field solution given here\nis available for the same analysis. The exponent of the empirical domain class distributions for genomes\nwith different size was estimated from a power-law fit of the cumulative histograms, keeping into account\nthe finite-size cutoff.\n\n\f29\nAppendix B: List of Bacteria Used in the Analysis of Fig. 8\n\nAbbreviation\n\nFull Name\n\na9\nb0\nb1\nbl\nbx\nc5\ncd\nch\nec\new\njk\nlj\nls\nlv\nlx\nni\noc\np0\npg\npp\nrr\nrx\ns4\ns5\nsd\nso\nsp\nsz\ntg\nti\ntr\nts\nvb\nvp\nws\nx1\nx2\nx5\n\nStreptococcus agalactiae A9\nBacillus anthracis Sterne\nBaumannia cicadellinicola Hc\nBifidobacterium longum NCC2705\nBacillus cereus ATCC 10987\nChlorobium chlorochromatii CaD\nCorynebacterium diphtheriae NCTC 13129\nChlorobium tepidum TLS\nEscherichia coli K12\nEscherichia coli W3110\nCorynebacterium jeikeium K411\nLactobacillus johnsonii NCC 533\nLactobacillus sakei ssp. sakei 23K\nLactobacillus salivarius ssp. salivarius UCC118\nLeifsonia xyli ssp. xyli CTCB07\nNeisseria gonorrhoeae FA 1090\nProchlorococcus marinus NATL2A\nCandidatus Protochlamydia amoebophila UWE25\nPorphyromonas gingivalis W83\nStreptococcus pyogenes MGAS2096\nRhodopseudomonas palustris BisB5\nRhodoferax ferrireducens T118\nStreptococcus agalactiae 2603V/R\nStreptococcus agalactiae NEM316\nStreptococcus thermophilus LMG 18311\nSynechococcus sp. CC9605\nStreptococcus pyogenes MGAS10394\nSynechococcus sp. CC9902\nStreptococcus pyogenes MGAS10750\nThiomicrospira denitrificans ATCC 33889\nThermus thermophilus HB8\nStreptococcus pyogenes MGAS10270\nVibrio vulnificus YJ016\nVibrio parahaemolyticus RIMD 2210633\nWolinella succinogenes DSM 1740\nStreptococcus thermophilus CNRZ1066\nStreptococcus pyogenes M1 GAS\nBacillus cereus E33L\n\nTABLE B.1: Abbreviations used for the genomes in Fig. 8.\n\n\f"}